000100 IDENTIFICATION DIVISION.                                         00010000
000200 PROGRAM-ID.         PEKRP080.                                    00020000
000300 AUTHOR.             KARI SUTTON.                                 00030000
000400 INSTALLATION.       KOHLS DEPARTMENT STORES.                     00040000
000500 DATE-WRITTEN.       DECEMBER 1997.                               00050000
000600 DATE-COMPILED.                                                   00060000
000700******************************************************************00070000
000800* THIS PROGRAM PRODUCES A MARKDOWN / MARKUP REPORT BY DEPT.,     *00080000
000900* MARKDOWN/MARKUP TYPE, AND REASON CODE.                         *00090000
001000*                                                                *00100000
001100* THIS REPORT RUNS ONCE EVERY WEEK, AND AT MONTH END.  THERE ARE *00110000
001200* PLANS FOR AN ONLINE REQUEST SCREEN, BUT THESE HAVE BEEN PUT ON *00120000
001300* HOLD FOR NOW.                                                  *00130000
001400******************************************************************00140000
001500* 03/10/98  - KARI SUTTON - WR 5408                              *00150000
001600* ADDED BUYER NUMBER TO THE REPORT HEADING LINE, SO INFOPAC CAN  *00160000
001700* SECTION THE REPORT BY BUYER NUMBER.  THIS CHANGE WAS REQUESTED *00170000
001800* SO IT WOULD BE SIMILAR TO MERCHANDISE LEDGER.                  *00180000
001900*                                                                *00190000
002000* ALSO MODIFIED QUERIES USING TMDSEAR TO USE THE CURRENT DATE    *00200000
002100* INSTEAD OF THE PERIOD ENDING DATE IN THE WHERE CLAUSE.  THIS   *00210000
002200* WAS DONE BECAUSE MBS DOES NOT KEEP HISTORY ON THEIR TABLES.    *00220000
002300* FOR EXAMPLE, IF A BUYER NUMBER CHANGED, THE OLD BUYER NUMBER   *00230000
002400* IS DELETED FROM THE TABLE.  IF THIS REPORT WAS REQUESTED FOR   *00240000
002500* A TIME PERIOD WHEN THE OLD BUYER HAD THE DEPARTMENT, THE       *00250000
002600* DATA WOULD NOT SHOW UP ON THE REPORT, BECAUSE THE DEPARTMENT   *00260000
002700* WOULD NOT BE FOUND ON THE TMDSEAR TABLE FOR THAT TIME PERIOD.  *00270000
002800******************************************************************00280000
002900* 05/05/98  - KARI SUTTON - WR 5408                              *00290000
003000* ADDED CODE TO CREATE THE SEASONAL MARKDOWN REPORT.  INCREASED  *00300000
003100* THE SIZE OF THE REPORT AMOUNT FIELDS TO HANDLE THE SEASONAL    *00310000
003200* AMOUNTS.                                                       *00320000
003300******************************************************************00330000
003400* 05/14/98  - KARI SUTTON - WR 5408                              *00340000
003500* PARAGRAPH C310-POPULATE-HEADING-LINE3 WAS BEING PERFORMED IN   *00350000
003600* THE WRONG PLACE, CAUSING THE END OF MONTH REPORT TO HAVE THE   *00360000
003700* INCORRECT MONTH IN THE HEADING.                                *00370000
003800******************************************************************00380000
003900* 01/27/99 - TCM -  WR NO. 6041                                  *00390000
004000*    - REMOVE NO LONGER REFERENCED CODE                          *00400000
004100*    - DELETE HARD CODED CENTURY CALCULATION                     *00410000
004200******************************************************************00420000
003900* 01/10/00 - JIM ARENDT WR NO. PM00336970                        *00430000
004000*    - CHANGED ALL ILB0ABNO TO ILBOABN0.                         *00440000
004200******************************************************************00450000
      * 01/14/02 - JACK KRAMER   IR  PM00442963                        *00460000
      *    - CHANGED ALL WKMUMD-TOT-MU-MD-AMT TO PV-TOT-MU-MD-AMT-CSR. *00470000
      *                  S9(09)V9(02)         TO S9(11)9(02)            00480000
      *      SQLCODE -304 ON CURSOR FETCH.                              00490000
      ******************************************************************00500000
      * 10/27/05 - TODD MICHALEK IR  WR28048                           *00510000
      *    - RECOMPILED THE PROGRAM WITH NEW MARKDOWN CODE             *00520000
      *      DESCRIPTIONS (IN PEWS049):                                *00530000
      *      025 - INTERIM CLEARANCE                                   *00540000
      *      026 - FINAL CLEARANCE                                     *00550000
      *      189 - MOS-SALVAGE                                         *00560000
      ******************************************************************00570001
W39372* W39372  08-02-2012 RONNA MCDONALD - RECOMPILE TO PULL IN NEW   *00580001
W39372*                                     REASON CODE  765 DEFINED   *00590001
W39372*                                     IN PEWS049                 *00600001
      ******************************************************************00610000
205464*CHG0205464  08-16-2018 JIM ARENDT  - RECOMPILE TO PULL IN NEW *  00620009
205464*                                     REASON CODE  710 DEFINED   *00630009
205464*                                     IN PEWS049                 *00640009
205464******************************************************************00650009
004300 ENVIRONMENT DIVISION.                                            00660000
004400 CONFIGURATION SECTION.                                           00670000
004500 SOURCE-COMPUTER.    IBM-3090.                                    00680000
004600 OBJECT-COMPUTER.    IBM-3090.                                    00690000
004700 INPUT-OUTPUT SECTION.                                            00700000
004800 FILE-CONTROL.                                                    00710000
004900                                                                  00720000
005000     SELECT CONTROL-FILE              ASSIGN TO INP01.            00730000
005100     SELECT REPORT-FILE               ASSIGN TO RPT01.            00740000
005200                                                                  00750000
005300******************************************************************00760000
005400 DATA DIVISION.                                                   00770000
005500******************************************************************00780000
005600                                                                  00790000
005700 FILE SECTION.                                                    00800000
005800                                                                  00810000
005900 FD  CONTROL-FILE                                                 00820000
006000     RECORDING MODE IS F                                          00830000
006100     BLOCK CONTAINS 0 RECORDS                                     00840000
006200     LABEL RECORDS ARE OMITTED.                                   00850000
006300                                                                  00860000
006400 01  CONTROL-RECORD                   PIC X(80).                  00870000
006500                                                                  00880000
006600 FD  REPORT-FILE                                                  00890000
006700     RECORDING MODE IS F                                          00900000
006800     BLOCK CONTAINS 0 RECORDS                                     00910000
006900     LABEL RECORDS ARE OMITTED.                                   00920000
007000                                                                  00930000
007100 01  REPORT-RECORD                    PIC X(200).                 00940000
007200                                                                  00950000
007300 WORKING-STORAGE SECTION.                                         00960000
007400                                                                  00970000
007500 01  ABEND-CODE                       PIC S9(04)    VALUE +0 COMP.00980000
007600                                                                  00990000
007700******************************************************************01000000
007800*    CR-CONTROL RECORD                                           *01010000
007900******************************************************************01020000
008000 01  CR-CONTROL-RECORD.                                           01030000
008100     05  CR-CALENDAR-TYPE             PIC  X(02)   VALUE SPACES.  01040000
008200     05  FILLER                       PIC  X(01)   VALUE SPACES.  01050000
008300     05  CR-PERIOD-END-DATE.                                      01060000
008400         10  CR-PERIOD-END-DTE-CC     PIC  X(02)   VALUE SPACES.  01070000
008500         10  CR-PERIOD-END-DTE-YY     PIC  X(02)   VALUE SPACES.  01080000
008600         10  FILLER                   PIC  X(01)   VALUE SPACES.  01090000
008700         10  CR-PERIOD-END-DTE-MM     PIC  X(02)   VALUE SPACES.  01100000
008800         10  FILLER                   PIC  X(01)   VALUE SPACES.  01110000
008900         10  CR-PERIOD-END-DTE-DD     PIC  X(02)   VALUE SPACES.  01120000
009000     05  FILLER                       PIC  X(01)   VALUE SPACES.  01130000
009100     05  CR-TYPE-OF-BATCH-RUN         PIC  X(01)   VALUE SPACES.  01140000
009200         88  CR-VALID-BATCH                        VALUE 'W' 'M'  01150000
009300                                                         'S'.     01160000
009400         88  CR-END-OF-WEEK                        VALUE 'W'.     01170000
009500         88  CR-END-OF-MONTH                       VALUE 'M'.     01180000
009600         88  CR-CUMULATIVE-SEASON                  VALUE 'S'.     01190000
009700     05  FILLER                       PIC  X(01)   VALUE SPACES.  01200000
009800     05  CR-YEAR                      PIC  X(04)   VALUE SPACES.  01210000
009900     05  FILLER                       PIC  X(01)   VALUE SPACES.  01220000
010000     05  CR-DEPT                      PIC  X(03)   VALUE SPACES.  01230000
010100     05  FILLER                       PIC  X(01)   VALUE SPACES.  01240000
010200     05  CR-SEASON                    PIC  X(01)   VALUE SPACES.  01250000
010300         88  CR-VALID-SEASON                       VALUE '1' '2'. 01260000
010400         88  CR-SPRING                             VALUE '1'.     01270000
010500         88  CR-FALL                               VALUE '2'.     01280000
010600     05  FILLER                       PIC  X(01)   VALUE SPACES.  01290000
010700     05  CR-FISCAL-MONTH              PIC  X(02)   VALUE SPACES.  01300000
010800     05  FILLER                       PIC  X(51)   VALUE SPACES.  01310000
010900                                                                  01320000
011000******************************************************************01330000
011100*    DK-DB2 KEYS                                                 *01340000
011200******************************************************************01350000
011300 01  DK-DB2-KEYS.                                                 01360000
011400     05  DK-START-OF-SEASON        PIC  X(02)  VALUE SPACES.      01370000
011500     05  DK-END-OF-SEASON          PIC  X(02)  VALUE SPACES.      01380000
011600     05  DK-SEASONAL-DEPT-LOW      PIC  X(03)  VALUE SPACES.      01390000
011700     05  DK-SEASONAL-DEPT-HIGH     PIC  X(03)  VALUE SPACES.      01400000
011800                                                                  01410000
011900******************************************************************01420000
012000*    PC-PROGRAM CONSTANTS                                        *01430000
012100******************************************************************01440000
012200 01  PC-PROGRAM-CONSTANTS.                                        01450000
012300     05  PC-PROGRAM-NAME             PIC  X(08) VALUE 'PEKRP080'. 01460000
012400     05  PC-WEEKLY-JOB               PIC  X(08) VALUE 'PEK155'.   01470000
012500     05  PC-MONTHLY-JOB              PIC  X(08) VALUE 'PEK555'.   01480000
012600     05  PC-ONE                      PIC  9(01) VALUE 1.          01490000
012700     05  PC-TWO                      PIC  9(01) VALUE 2.          01500000
012800     05  PC-THREE                    PIC  9(01) VALUE 3.          01510000
012900     05  PC-FOUR                     PIC  9(01) VALUE 4.          01520000
013000     05  PC-PRICE-CHG-LITERAL        PIC  X(10) VALUE             01530000
013100         'PRICE CHGS'.                                            01540000
013200     05  PC-WEEK-LITERAL             PIC  X(02) VALUE 'WK'.       01550000
013300     05  PC-HYPHEN-LITERAL           PIC  X(03) VALUE ' - '.      01560000
013400     05  PC-MAX-RETRIES              PIC S9(04) VALUE +3          01570000
013500                                                COMP.             01580000
013600     05  PC-HEADER-LINE-COUNT        PIC S9(03) VALUE +9          01590000
013700                                                COMP.             01600000
013800     05  PC-MAX-LINES-PER-PAGE       PIC S9(03) VALUE +80         01610000
013900                                                COMP.             01620000
014000     05  PC-DAYS-TO-INCREMENT        PIC  9(04) VALUE 7.          01630000
014100     05  PC-DEPARTMENT-NOT-FOUND     PIC  X(25) VALUE             01640000
014200         'DEPARTMENT NOT FOUND     '.                             01650000
014300     05  PC-BUYER-NOT-FOUND          PIC  X(18) VALUE             01660000
014400         'BUYER NOT FOUND   '.                                    01670000
014500     05  PC-DMM-NOT-FOUND            PIC  X(18) VALUE             01680000
014600         'DMM NOT FOUND     '.                                    01690000
014700     05  PC-GMM-NOT-FOUND            PIC  X(18) VALUE             01700000
014800         'GMM NOT FOUND     '.                                    01710000
014900     05  PC-DATABASE-CONFLICT        PIC  X(31) VALUE             01720000
015000         'DATABASE CONFLICT              '.                       01730000
015100     05  PC-BUYER                    PIC  X(12) VALUE             01740000
015200         'BUYER       '.                                          01750000
015300     05  PC-INSTORE                  PIC  X(12) VALUE             01760000
015400         'STORE       '.                                          01770000
015500     05  PC-PROMO                    PIC  X(12) VALUE             01780000
015600         'PROMO       '.                                          01790000
015700     05  PC-REGISTER                 PIC  X(12) VALUE             01800000
015800         'REGISTER    '.                                          01810000
015900     05  PC-UNMATCHED                PIC  X(12) VALUE             01820000
016000         'UNMATCHED   '.                                          01830000
016100     05  PC-MKDN                     PIC  X(15) VALUE             01840000
016200         'MARKDOWN       '.                                       01850000
016300     05  PC-MKDN-CAN                 PIC  X(15) VALUE             01860000
016400         'MARKDOWN/CANCEL'.                                       01870000
016500     05  PC-MKUP                     PIC  X(15) VALUE             01880000
016600         'MARKUP         '.                                       01890000
016700     05  PC-MKUP-CAN                 PIC  X(15) VALUE             01900000
016800         'MARKUP/CANCEL  '.                                       01910000
016900     05  PC-MARKDOWN-TOTAL           PIC  X(10) VALUE             01920000
017000         'MARKDOWNS '.                                            01930000
017100     05  PC-MARKUP-TOTAL             PIC  X(10) VALUE             01940000
017200         'MARKUPS   '.                                            01950000
017300     05  PC-NET-TOTAL                PIC  X(10) VALUE             01960000
017400         'NET TOTAL '.                                            01970000
017500     05  PC-SEASONAL-DEPT-LOW        PIC  X(03) VALUE '000'.      01980000
017600     05  PC-SEASONAL-DEPT-HIGH       PIC  X(03) VALUE '999'.      01990000
017700                                                                  02000000
017800******************************************************************02010000
017900*    RESPROGRAM VARIABLES                                        *02020000
018000******************************************************************02030000
018100 01  PV-PROGRAM-VARIABLES.                                        02040000
018200     05  PV-PARAGRAPH-NAME            PIC  X(30)     VALUE SPACES.02050000
018300     05  PV-DB2-OPERATION-ATTEMPTED   PIC  X(30)     VALUE SPACES.02060000
018400     05  PV-DB2-TABLE-NAME-1          PIC  X(12)     VALUE SPACES.02070000
018500     05  PV-DB2-TABLE-NAME-2          PIC  X(12)     VALUE SPACES.02080000
018600     05  PV-SUB                       PIC S9(04)     VALUE +0     02090000
018700                                                     COMP SYNC.   02100000
018800     05  PV-CALC-SEASON-MONTH         PIC S9(04)     VALUE +0     02110000
018900                                                     COMP SYNC.   02120000
019000     05  PV-PERIOD-END-DATE           PIC  X(10)     VALUE SPACES.02130000
019100                                                                  02140000
019200     05  PV-DPG56-FISCAL-PERIOD-NBR   PIC  9(02)     VALUE ZEROES.02150000
019300     05  PV-DPG56-FISCAL-PERIOD-WEEK  PIC  9(02)     VALUE ZEROES.02160000
019400                                                                  02170000
019500                                                                  02180000
019600                                                                  02190000
019700     05  PV-FSCL-YEAR                 PIC  9(04)     VALUE ZEROES.02200000
019800     05  PV-FSCL-WK-NUMERIC           PIC  9(02)     VALUE ZEROES.02210000
019900     05  PV-FSCL-WK-ALPHA             PIC  X(02)     VALUE SPACES.02220000
020000     05  PV-FSCL-MN-NUMERIC           PIC  9(02)     VALUE ZEROES.02230000
020100     05  PV-FSCL-MN-ALPHA             PIC  X(02)     VALUE SPACES.02240000
020200     05  PV-ERROR-LITERAL.                                        02250000
020300         10  FILLER                PIC  X(13) VALUE               02260000
020400                               '**  RETURNED '.                   02270000
020500         10  PV-ERROR-IND          PIC  X(16) VALUE ' '.          02280000
020600             88  PV-WARNING          VALUE  'WARNING ERROR. *'.   02290000
020700             88  PV-SEVERE           VALUE  'SEVERE ERROR.  *'.   02300000
020800     05  PV-SELECT-COUNTER            PIC S9(04)     VALUE +0     02310000
020900                                                     COMP SYNC.   02320000
021000     05  PV-FISCAL-PERIOD-WEEK        PIC  9(02)     VALUE ZEROES.02330000
021100     05  PV-HOLD-DEPT-NBR             PIC  X(03)     VALUE SPACES.02340000
021200     05  PV-HOLD-ORGN-CDE             PIC  X(01)     VALUE SPACE. 02350000
021300         88  PV-HOLD-ORGN-BUYER                      VALUE '1'.   02360000
021400         88  PV-HOLD-ORGN-INSTORE                    VALUE '2'.   02370000
021500         88  PV-HOLD-ORGN-PROMO                      VALUE '3'.   02380000
021600         88  PV-HOLD-ORGN-REGISTER                   VALUE '4'.   02390000
021700         88  PV-HOLD-ORGN-UNMATCHED                  VALUE '5'.   02400000
021800     05  PV-HOLD-PRIC-CHG-TYP-CDE     PIC  X(01)     VALUE SPACE. 02410000
021900         88  PV-HOLD-PRIC-CHG-MKDN                   VALUE '1'.   02420000
022000         88  PV-HOLD-PRIC-CHG-MKDN-CAN               VALUE '2'.   02430000
022100         88  PV-HOLD-PRIC-CHG-MKUP                   VALUE '3'.   02440000
022200         88  PV-HOLD-PRIC-CHG-MKUP-CAN               VALUE '4'.   02450000
022300     05  PV-HOLD-RSN-CDE              PIC  X(03)     VALUE SPACES.02460000
022400     05  PV-HOLD-DMA-NBR              PIC  X(02)     VALUE SPACES.02470000
022500     05  PV-HOLD-GMA-NBR              PIC  X(02)     VALUE SPACES.02480000
022600     05  PV-TRUNCATE-NAME             PIC  X(15)     VALUE SPACES.02490000
022700     05  PV-RPT-SUMM-LEVEL            PIC  X(24)     VALUE SPACES.02500000
022800     05  PV-SYSTEM-ORIGIN             PIC  X(12)     VALUE SPACES.02510000
022900     05  PV-MKDN-MKUP-TYP-CDE         PIC  X(15)     VALUE SPACES.02520000
023000     05  PV-PERCENT-OF-TOT-WEEK       PIC S9(03)V9(8)             02530000
023100                                                     VALUE ZEROES.02540000
023200     05  PV-ROUNDED-PERCENT           PIC S9(03)V9(1)             02550000
023300                                                     VALUE ZEROES.02560000
023400     05  PV-TOT-MU-MD-AMT-CSR         PIC S9(11)V9(2)             02570000
023500                                                     VALUE ZEROES 02580000
023600                                                     COMP-3.      02590000
023700     05  PV-TOT-MU-MD-AMT             PIC S9(10)V9(2)             02600000
023800                                                     VALUE ZEROES 02610000
023900                                                     COMP-3.      02620000
024000     05  PV-SUM-ORGN-TYPE-TABLE         OCCURS 06 TIMES.          02630000
024100         10  PV-SUM-BY-ORGN-TYP       PIC S9(10)V9(2)             02640000
024200                                                     VALUE ZEROES 02650000
024300                                                     COMP-3.      02660000
024400     05  PV-SUM-BY-ORGN-TYP-TOTAL     PIC S9(12)V9(2)             02670000
024500                                                     VALUE ZEROES 02680000
024600                                                     COMP-3.      02690000
024700     05  PV-SUM-ORGN-TABLE              OCCURS 06 TIMES.          02700000
024800         10  PV-SUM-BY-ORGN           PIC S9(12)V9(2)             02710000
024900                                                     VALUE ZEROES 02720000
025000                                                     COMP-3.      02730000
025100     05  PV-SUM-BY-ORGN-TOTAL         PIC S9(12)V9(2)             02740000
025200                                                     VALUE ZEROES 02750000
025300                                                     COMP-3.      02760000
025400     05  PV-SUM-DEPT-TABLE              OCCURS 06 TIMES.          02770000
025500         10  PV-SUM-BY-DEPT           PIC S9(12)V9(2)             02780000
025600                                                     VALUE ZEROES 02790000
025700                                                     COMP-3.      02800000
025800     05  PV-SUM-BY-DEPT-TOTAL         PIC S9(12)V9(2)             02810000
025900                                                     VALUE ZEROES 02820000
026000                                                     COMP-3.      02830000
026100     05  PV-SUM-DMM-TABLE               OCCURS 06 TIMES.          02840000
026200         10  PV-SUM-BY-DMM            PIC S9(12)V9(2)             02850000
026300                                                     VALUE ZEROES 02860000
026400                                                     COMP-3.      02870000
026500     05  PV-SUM-BY-DMM-TOTAL          PIC S9(12)V9(2)             02880000
026600                                                     VALUE ZEROES 02890000
026700                                                     COMP-3.      02900000
026800     05  PV-SUM-GMM-TABLE               OCCURS 06 TIMES.          02910000
026900         10  PV-SUM-BY-GMM            PIC S9(12)V9(2)             02920000
027000                                                     VALUE ZEROES 02930000
027100                                                     COMP-3.      02940000
027200     05  PV-SUM-BY-GMM-TOTAL          PIC S9(12)V9(2)             02950000
027300                                                     VALUE ZEROES 02960000
027400                                                     COMP-3.      02970000
027500     05  PV-SUM-CORP-TABLE              OCCURS 06 TIMES.          02980000
027600         10  PV-SUM-BY-CORP           PIC S9(12)V9(2)             02990000
027700                                                     VALUE ZEROES 03000000
027800                                                     COMP-3.      03010000
027900     05  PV-SUM-BY-CORP-TOTAL         PIC S9(12)V9(2)             03020000
028000                                                     VALUE ZEROES 03030000
028100                                                     COMP-3.      03040000
028200     05  PV-SUM-BY-RSN-CDE-TOTAL      PIC S9(12)V9(2)             03050000
028300                                                     VALUE ZEROES 03060000
028400                                                     COMP-3.      03070000
028500     05  PV-PERCENTAGE.                                           03080000
028600         10  PV-PERCENT               PIC  ZZ9.9     VALUE ZEROES.03090000
028700         10  FILLER                   PIC  X(01)     VALUE '%'.   03100000
028800     05  PV-FISCAL-WEEK-NBR           PIC  9(02)     VALUE ZERO.  03110000
028900     05  PV-MKDN-MKUP-PERIOD-AMT      PIC  ZZZ,ZZZ,ZZ9.99-        03120000
029000                                                     VALUE ZERO.  03130000
029100     05  PV-MKDN-MKUP-PERIOD-TOT-AMT  PIC  ZZZ,ZZZ,ZZZ,ZZ9.99-    03140000
029200                                                     VALUE ZERO.  03150000
029300     05  PV-MKDN-TYPE-TOT-PER-AMT     PIC  ZZZ,ZZZ,ZZZ,ZZ9.99-    03160000
029400                                                     VALUE ZERO.  03170000
029500     05  PV-START-OF-WEEK-DATE        PIC   X(10)    VALUE SPACES.03180000
029600     05  PV-CURRENT-DATE.                                         03190000
029700         10  PV-CURRENT-YEAR         PIC  9(02) VALUE ZERO.       03200000
029800         10  PV-CURRENT-MONTH        PIC  9(02) VALUE ZERO.       03210000
029900         10  PV-CURRENT-DAY          PIC  9(02) VALUE ZERO.       03220000
030000     05  PV-CURRENT-TIME.                                         03230000
030100         10  PV-CURRENT-HOUR         PIC  9(02) VALUE ZERO.       03240000
030200         10  PV-CURRENT-MINUTE       PIC  9(02) VALUE ZERO.       03250000
030300         10  FILLER                  PIC  9(04) VALUE ZERO.       03260000
030400                                                                  03270000
030500                                                                  03280000
030600******************************************************************03290000
030700*    PS-PROGRAM SWITCHES                                         *03300000
030800******************************************************************03310000
030900 01  PS-PROGRAM-SWITCHES.                                         03320000
031000     05  PS-END-OF-CONTROL-FILE-SW      PIC  X(01)   VALUE 'N'.   03330000
031100         88  PS-END-OF-CONTROL-FILE                  VALUE 'Y'.   03340000
031200     05  PS-REPORT-LEVEL-SW             PIC  X(01)   VALUE 'N'.   03350000
031300         88  PS-DEPT-LEVEL-REPORT                    VALUE 'N'.   03360000
031400         88  PS-SUMMARY-LEVEL-REPORT                 VALUE 'Y'.   03370000
031500     05  PS-SUMMARY-LEVEL-SW            PIC  X(01)   VALUE 'D'.   03380000
031600         88  PS-DMM-SUMMARY-LVL                      VALUE 'D'.   03390000
031700         88  PS-GMM-SUMMARY-LVL                      VALUE 'G'.   03400000
031800         88  PS-CORP-SUMMARY-LVL                     VALUE 'C'.   03410000
031900     05  PS-END-OF-SEASON-CSR-SW        PIC  X(01)   VALUE 'N'.   03420000
032000         88  PS-END-OF-SEASON-CSR                    VALUE 'Y'.   03430000
032100     05  PS-END-OF-WEEKLY-CSR-SW        PIC  X(01)   VALUE 'N'.   03440000
032200         88  PS-END-OF-WEEKLY-CSR                    VALUE 'Y'.   03450000
032300     05  PS-END-OF-DMM-CSR-SW           PIC  X(01)   VALUE 'N'.   03460000
032400         88  PS-END-OF-DMM-CSR                       VALUE 'Y'.   03470000
032500     05  PS-END-OF-GMM-CSR-SW           PIC  X(01)   VALUE 'N'.   03480000
032600         88  PS-END-OF-GMM-CSR                       VALUE 'Y'.   03490000
032700     05  PS-END-OF-CORP-CSR-SW          PIC  X(01)   VALUE 'N'.   03500000
032800         88  PS-END-OF-CORP-CSR                      VALUE 'Y'.   03510000
032900                                                                  03520000
033000******************************************************************03530000
033100*    PA-PROGRAM ACCUMULATORS                                     *03540000
033200******************************************************************03550000
033300 01  PA-PROGRAM-ACCUMULATORS.                                     03560000
033400     05  PA-REPORT-RECORDS-WRITTEN      PIC S9(11)   COMP-3       03570000
033500                                                     VALUE ZEROES.03580000
033600     05  PA-LINE-COUNTER                PIC S9(11)   COMP-3       03590000
033700                                                     VALUE ZEROES.03600000
033800     05  PA-PAGE-COUNTER                PIC S9(11)   COMP-3       03610000
033900                                                     VALUE ZEROES.03620000
034000                                                                  03630000
034100******************************************************************03640000
034200*    STANDARD HEADER FOR 200 COLUMN REPORT                       *03650000
034300*    THIS COPYBOOK WAS COPIED IN AND MODIFIED TO INCLUDE THE     *03660000
034400*    JOB NUMBER IN THE REPORT HEADING.                           *03670000
034500******************************************************************03680000
034600*    COPY DPWS200O.                                               03690000
034700 01  DP200O-STANDRD-HEADER-200-COLS.                              03700000
034800     05  DP200O-LASER-NEW-PAGE-INDICATR    PIC X(02) VALUE SPACE. 03710000
034900     05  DP200O-RUN-DATE.                                         03720000
035000         10  DP200O-RUN-MONTH              PIC 9(02) VALUE ZERO.  03730000
035100         10  FILLER                        PIC X(01) VALUE '/'.   03740000
035200         10  DP200O-RUN-DAY                PIC 9(02) VALUE ZERO.  03750000
035300         10  FILLER                        PIC X(01) VALUE '/'.   03760000
035400         10  DP200O-RUN-YEAR               PIC 9(02) VALUE ZERO.  03770000
035500     05  FILLER                            PIC X(02) VALUE SPACE. 03780000
035600     05  DP200O-RUN-TIME.                                         03790000
035700         10  DP200O-RUN-HOUR               PIC 9(02) VALUE ZERO.  03800000
035800         10  FILLER                        PIC X(01) VALUE ':'.   03810000
035900         10  DP200O-RUN-MINUTE             PIC 9(02) VALUE ZERO.  03820000
036000     05  FILLER                            PIC X(61) VALUE SPACE. 03830000
036100     05  FILLER                            PIC X(45)              03840000
036200         VALUE 'K O H L S   D E P A R T M E N T   S T O R E S'.   03850000
036300     05  FILLER                            PIC X(47) VALUE SPACE. 03860000
036400     05  DP200O-JOB-NUMBER                 PIC X(06) VALUE SPACE. 03870000
036500     05  FILLER                            PIC X(02) VALUE SPACE. 03880000
036600     05  DP200O-PROGRAM-NAME               PIC X(08) VALUE SPACE. 03890000
036700     05  FILLER                            PIC X(01) VALUE '-'.   03900000
036800     05  DP200O-REPORT-NUMBER              PIC 9(01) VALUE ZERO.  03910000
036900     05  FILLER                            PIC X(02) VALUE SPACE. 03920000
037000     05  FILLER                            PIC X(05) VALUE 'PAGE'.03930000
037100     05  DP200O-PAGE-NUMBER                PIC ZZZZ9 VALUE ZERO.  03940000
037200                                                                  03950000
037300 01  DP200O-CNFDL-HDR-200-COLS.                                   03960000
037400     05  FILLER                            PIC X(73) VALUE SPACE. 03970000
037500     05  DP200O-CNFDL-MSG-54-COLS.                                03980000
037600         10  FILLER                        PIC X(05)              03990000
037700                                                   VALUE '**** '. 04000000
037800         10  DP200O-CNFDL-MSG-44-COLS      PIC X(44) VALUE        04010000
037900                  'CONFIDENTIAL - NOT TO BE COPIED OR DISCLOSED'. 04020000
038000         10  FILLER                        PIC X(05)              04030000
038100                                                   VALUE ' ****'. 04040000
038200     05  FILLER                            PIC X(73) VALUE SPACE. 04050000
038300                                                                  04060000
038400                                                                  04070000
038500******************************************************************04080000
038600*    PERM CONSTANTS                                              *04090000
038700******************************************************************04100000
038800     COPY PEWS049.                                                04110000
038900                                                                  04120000
039000 01  REPORT-TITLE-LINE.                                           04130000
039100     05  FILLER                         PIC  X(79)   VALUE SPACES.04140000
039200     05  RPT-TITLE-LINE-VALUE           PIC  X(42)   VALUE SPACES.04150000
039300     05  FILLER                         PIC  X(79)   VALUE SPACES.04160000
039400                                                                  04170000
039500 01  REPORT-TITLE-LINE-VALUES.                                    04180000
039600     05  RPT-TL-WEEKLY.                                           04190000
039700         10  FILLER                     PIC  X(04)   VALUE SPACES.04200000
039800         10  FILLER                     PIC  X(33)   VALUE        04210000
039900             'MARKDOWN / MARKUP ANALYSIS REPORT'.                 04220000
040000         10  FILLER                     PIC  X(05)   VALUE SPACES.04230000
040100     05  RPT-TL-SEASONAL                PIC  X(42)   VALUE        04240000
040200         'SEASONAL MARKDOWN / MARKUP ANALYSIS REPORT'.            04250000
040300                                                                  04260000
040400 01  REPORT-TITLE-LINE2.                                          04270000
040500     05  FILLER                         PIC  X(85)   VALUE SPACES.04280000
040600     05  RPT-TITLE-LINE2-VALUE          PIC  X(31)   VALUE SPACES.04290000
040700     05  FILLER                         PIC  X(84)   VALUE SPACES.04300000
040800                                                                  04310000
040900 01  REPORT-TITLE-LINE2-VALUES.                                   04320000
041000     05  RPT-TL2-WEEKLY.                                          04330000
041100         10  FILLER                     PIC  X(04)   VALUE SPACES.04340000
041200         10  FILLER                     PIC  X(16)   VALUE        04350000
041300             'FOR WEEK ENDING '.                                  04360000
041400         10  RPT-TL2-WEEKLY-MM          PIC  X(02)   VALUE SPACES.04370000
041500         10  FILLER                     PIC  X(01)   VALUE '/'.   04380000
041600         10  RPT-TL2-WEEKLY-DD          PIC  X(02)   VALUE SPACES.04390000
041700         10  FILLER                     PIC  X(01)   VALUE '/'.   04400000
041800         10  RPT-TL2-WEEKLY-YY          PIC  X(02)   VALUE SPACES.04410000
041900         10  FILLER                     PIC  X(03)   VALUE SPACES.04420000
042000     05  RPT-TL2-END-OF-MONTH.                                    04430000
042100         10  FILLER                     PIC  X(17)   VALUE        04440000
042200             'FOR THE MONTH OF '.                                 04450000
042300         10  RPT-TL2-MONTH-YEAR         PIC  X(14)   VALUE SPACES.04460000
042400     05  RPT-TL2-SEASON.                                          04470000
042500         10  FILLER                     PIC  X(08)   VALUE SPACES.04480000
042600         10  FILLER                     PIC  X(06).               04490000
042700             88  RPT-TL2-SEASON-SPRING               VALUE        04500000
042800                 'SPRING'.                                        04510000
042900             88  RPT-TL2-SEASON-FALL                 VALUE        04520000
043000                 '  FALL'.                                        04530000
043100         10  FILLER                     PIC  X(01)   VALUE SPACES.04540000
043200         10  RPT-TL2-SEASON-CCYY        PIC  X(04)   VALUE SPACES.04550000
043300         10  FILLER                     PIC  X(08)   VALUE SPACES.04560000
043400                                                                  04570000
043500 01  REPORT-HEADING-LINE1.                                        04580000
043600     05  RPT-HL1-GMM-LITERAL            PIC  X(04)   VALUE SPACES.04590000
043700     05  FILLER                         PIC  X(02)   VALUE SPACES.04600000
043800     05  RPT-HL1-GMM-NUMBER             PIC  X(02)   VALUE SPACES.04610000
043900     05  RPT-HL1-GMM-FILLER             PIC  X(01)   VALUE SPACES.04620000
044000     05  RPT-HL1-GMM-NAME               PIC  X(15)   VALUE SPACES.04630000
044100     05  FILLER                         PIC  X(02)   VALUE SPACES.04640000
044200     05  RPT-HL1-DMM-LITERAL            PIC  X(04)   VALUE SPACES.04650000
044300     05  FILLER                         PIC  X(02)   VALUE SPACES.04660000
044400     05  RPT-HL1-DMM-NUMBER             PIC  X(02)   VALUE SPACES.04670000
044500     05  FILLER                         PIC  X(01)   VALUE SPACES.04680000
044600     05  RPT-HL1-DMM-NAME               PIC  X(15)   VALUE SPACES.04690000
044700     05  FILLER                         PIC  X(02)   VALUE SPACES.04700000
044800     05  RPT-HL1-BUYER-LITERAL          PIC  X(06)   VALUE SPACES.04710000
044900     05  FILLER                         PIC  X(02)   VALUE SPACES.04720000
045000     05  RPT-HL1-BUYER-NUMBER           PIC  X(03)   VALUE SPACES.04730000
045100     05  RPT-HL1-BUYER-FILLER           PIC  X(01)   VALUE SPACES.04740000
045200     05  RPT-HL1-BUYER-NAME             PIC  X(18)   VALUE SPACES.04750000
045300     05  FILLER                         PIC  X(118)  VALUE SPACES.04760000
045400                                                                  04770000
045500 01  REPORT-HEADING-LINE2.                                        04780000
045600     05  FILLER                         PIC  X(05)   VALUE        04790000
045700         'DEPT:'.                                                 04800000
045800     05  FILLER                         PIC  X(02)   VALUE SPACES.04810000
045900     05  RPT-HL2-DEPT-NBR               PIC  X(03)   VALUE SPACES.04820000
046000     05  FILLER                         PIC  X(01)   VALUE SPACES.04830000
046100     05  RPT-HL2-DEPT-DESC              PIC  X(25)   VALUE SPACES.04840000
046200     05  FILLER                         PIC  X(164)  VALUE SPACES.04850000
046300                                                                  04860000
046400 01  REPORT-HEADING-LINE3.                                        04870000
046500     05  FILLER                         PIC  X(38)   VALUE SPACES.04880000
046600     05  RPT-HL3-FSCL-WK-LIT1           PIC  X(02)   VALUE SPACES.04890000
046700     05  FILLER                         PIC  X(01)   VALUE SPACES.04900000
046800     05  RPT-HL3-FSCL-WK-NBR1           PIC  X(02)   VALUE SPACES.04910000
046900     05  RPT-HL3-FSCL-HYPHEN1           PIC  X(03)   VALUE SPACES.04920000
047000     05  RPT-HL3-FSCL-MONTH-ABBR1       PIC  X(03)   VALUE SPACES.04930000
047100     05  FILLER                         PIC  X(01)   VALUE SPACES.04940000
047200     05  RPT-HL3-FSCL-START-WK1         PIC  X(02)   VALUE SPACES.04950000
047300     05  FILLER                         PIC  X(10)   VALUE SPACES.04960000
047400*                                                                 04970000
047500     05  RPT-HL3-FSCL-WK-LIT2           PIC  X(02)   VALUE SPACES.04980000
047600     05  FILLER                         PIC  X(01)   VALUE SPACES.04990000
047700     05  RPT-HL3-FSCL-WK-NBR2           PIC  X(02)   VALUE SPACES.05000000
047800     05  RPT-HL3-FSCL-HYPHEN2           PIC  X(03)   VALUE SPACES.05010000
047900     05  RPT-HL3-FSCL-MONTH-ABBR2       PIC  X(03)   VALUE SPACES.05020000
048000     05  FILLER                         PIC  X(01)   VALUE SPACES.05030000
048100     05  RPT-HL3-FSCL-START-WK2         PIC  X(02)   VALUE SPACES.05040000
048200     05  FILLER                         PIC  X(10)   VALUE SPACES.05050000
048300*                                                                 05060000
048400     05  RPT-HL3-FSCL-WK-LIT3           PIC  X(02)   VALUE SPACES.05070000
048500     05  FILLER                         PIC  X(01)   VALUE SPACES.05080000
048600     05  RPT-HL3-FSCL-WK-NBR3           PIC  X(02)   VALUE SPACES.05090000
048700     05  RPT-HL3-FSCL-HYPHEN3           PIC  X(03)   VALUE SPACES.05100000
048800     05  RPT-HL3-FSCL-MONTH-ABBR3       PIC  X(03)   VALUE SPACES.05110000
048900     05  FILLER                         PIC  X(01)   VALUE SPACES.05120000
049000     05  RPT-HL3-FSCL-START-WK3         PIC  X(02)   VALUE SPACES.05130000
049100     05  FILLER                         PIC  X(10)   VALUE SPACES.05140000
049200*                                                                 05150000
049300     05  RPT-HL3-FSCL-WK-LIT4           PIC  X(02)   VALUE SPACES.05160000
049400     05  FILLER                         PIC  X(01)   VALUE SPACES.05170000
049500     05  RPT-HL3-FSCL-WK-NBR4           PIC  X(02)   VALUE SPACES.05180000
049600     05  RPT-HL3-FSCL-HYPHEN4           PIC  X(03)   VALUE SPACES.05190000
049700     05  RPT-HL3-FSCL-MONTH-ABBR4       PIC  X(03)   VALUE SPACES.05200000
049800     05  FILLER                         PIC  X(01)   VALUE SPACES.05210000
049900     05  RPT-HL3-FSCL-START-WK4         PIC  X(02)   VALUE SPACES.05220000
050000     05  FILLER                         PIC  X(10)   VALUE SPACES.05230000
050100*                                                                 05240000
050200     05  RPT-HL3-FSCL-WK-LIT5           PIC  X(02)   VALUE SPACES.05250000
050300     05  FILLER                         PIC  X(01)   VALUE SPACES.05260000
050400     05  RPT-HL3-FSCL-WK-NBR5           PIC  X(02)   VALUE SPACES.05270000
050500     05  RPT-HL3-FSCL-HYPHEN5           PIC  X(03)   VALUE SPACES.05280000
050600     05  RPT-HL3-FSCL-MONTH-ABBR5       PIC  X(03)   VALUE SPACES.05290000
050700     05  FILLER                         PIC  X(01)   VALUE SPACES.05300000
050800     05  RPT-HL3-FSCL-START-WK5         PIC  X(02)   VALUE SPACES.05310000
050900     05  FILLER                         PIC  X(10)   VALUE SPACES.05320000
051000*                                                                 05330000
051100     05  FILLER                         PIC  X(29)   VALUE SPACES.05340000
051200     05  FILLER                         PIC  X(05)   VALUE        05350000
051300         'TOTAL'.                                                 05360000
051400     05  FILLER                         PIC  X(08)   VALUE SPACES.05370000
051500                                                                  05380000
051600 01  REPORT-SEASONAL-HEADING-LINE3.                               05390000
051700     05  FILLER                         PIC  X(38)   VALUE SPACES.05400000
051800     05  FILLER                         PIC  X(05)   VALUE SPACES.05410000
051900     05  RPT-SEASON-HL3-MONTH1          PIC  X(09)   VALUE SPACES.05420000
052000     05  FILLER                         PIC  X(10)   VALUE SPACES.05430000
052100*                                                                 05440000
052200     05  FILLER                         PIC  X(05)   VALUE SPACES.05450000
052300     05  RPT-SEASON-HL3-MONTH2          PIC  X(09)   VALUE SPACES.05460000
052400     05  FILLER                         PIC  X(10)   VALUE SPACES.05470000
052500*                                                                 05480000
052600     05  FILLER                         PIC  X(05)   VALUE SPACES.05490000
052700     05  RPT-SEASON-HL3-MONTH3          PIC  X(09)   VALUE SPACES.05500000
052800     05  FILLER                         PIC  X(10)   VALUE SPACES.05510000
052900*                                                                 05520000
053000     05  FILLER                         PIC  X(05)   VALUE SPACES.05530000
053100     05  RPT-SEASON-HL3-MONTH4          PIC  X(09)   VALUE SPACES.05540000
053200     05  FILLER                         PIC  X(10)   VALUE SPACES.05550000
053300*                                                                 05560000
053400     05  FILLER                         PIC  X(05)   VALUE SPACES.05570000
053500     05  RPT-SEASON-HL3-MONTH5          PIC  X(09)   VALUE SPACES.05580000
053600     05  FILLER                         PIC  X(10)   VALUE SPACES.05590000
053700*                                                                 05600000
053800     05  FILLER                         PIC  X(05)   VALUE SPACES.05610000
053900     05  RPT-SEASON-HL3-MONTH6          PIC  X(09)   VALUE SPACES.05620000
054000     05  FILLER                         PIC  X(10)   VALUE SPACES.05630000
054100*                                                                 05640000
054200     05  FILLER                         PIC  X(05)   VALUE SPACES.05650000
054300     05  FILLER                         PIC  X(05)   VALUE        05660000
054400         'TOTAL'.                                                 05670000
054500     05  FILLER                         PIC  X(08)   VALUE SPACES.05680000
054600                                                                  05690000
054700 01  REPORT-HEADING-ORGN-TYP-LINE.                                05700000
054800     05  RPT-HOTL-SYSTEM-ORIGIN         PIC  X(27)   VALUE SPACES.05710000
054900     05  FILLER                         PIC  X(173)  VALUE SPACES.05720000
055000                                                                  05730000
055100 01  REPORT-DETAIL-LINE.                                          05740000
055200     05  FILLER                         PIC  X(02)   VALUE SPACES.05750000
055300     05  RPT-REASON-CODE                PIC  X(03).               05760000
055400     05  FILLER                         PIC  X(01)   VALUE SPACES.05770000
055500     05  RPT-REASON-CODE-DESC           PIC  X(22).               05780000
055600     05  FILLER                         PIC  X(02)   VALUE SPACES.05790000
055700     05  RPT-MKDN-MKUP-PERIOD-1-AMT     PIC  X(15)   VALUE SPACES.05800000
055800     05  FILLER                         PIC  X(01)   VALUE SPACES.05810000
055900     05  RPT-MKDN-MKUP-PERIOD-1-PCT     PIC  X(06)   VALUE SPACES.05820000
056000     05  FILLER                         PIC  X(02)   VALUE SPACES.05830000
056100     05  RPT-MKDN-MKUP-PERIOD-2-AMT     PIC  X(15)   VALUE SPACES.05840000
056200     05  FILLER                         PIC  X(01)   VALUE SPACES.05850000
056300     05  RPT-MKDN-MKUP-PERIOD-2-PCT     PIC  X(06)   VALUE SPACES.05860000
056400     05  FILLER                         PIC  X(02)   VALUE SPACES.05870000
056500     05  RPT-MKDN-MKUP-PERIOD-3-AMT     PIC  X(15)   VALUE SPACES.05880000
056600     05  FILLER                         PIC  X(01)   VALUE SPACES.05890000
056700     05  RPT-MKDN-MKUP-PERIOD-3-PCT     PIC  X(06)   VALUE SPACES.05900000
056800     05  FILLER                         PIC  X(02)   VALUE SPACES.05910000
056900     05  RPT-MKDN-MKUP-PERIOD-4-AMT     PIC  X(15)   VALUE SPACES.05920000
057000     05  FILLER                         PIC  X(01)   VALUE SPACES.05930000
057100     05  RPT-MKDN-MKUP-PERIOD-4-PCT     PIC  X(06)   VALUE SPACES.05940000
057200     05  FILLER                         PIC  X(02)   VALUE SPACES.05950000
057300     05  RPT-MKDN-MKUP-PERIOD-5-AMT     PIC  X(15)   VALUE SPACES.05960000
057400     05  FILLER                         PIC  X(01)   VALUE SPACES.05970000
057500     05  RPT-MKDN-MKUP-PERIOD-5-PCT     PIC  X(06)   VALUE SPACES.05980000
057600     05  FILLER                         PIC  X(02)   VALUE SPACES.05990000
057700     05  RPT-MKDN-MKUP-PERIOD-6-AMT     PIC  X(15)   VALUE SPACES.06000000
057800     05  FILLER                         PIC  X(01)   VALUE SPACES.06010000
057900     05  RPT-MKDN-MKUP-PERIOD-6-PCT     PIC  X(06)   VALUE SPACES.06020000
058000     05  FILLER                         PIC  X(02)   VALUE SPACES.06030000
058100     05  RPT-MKDN-MKUP-PERIOD-TOT-AMT   PIC  X(19)   VALUE SPACES.06040000
058200     05  FILLER                         PIC  X(01)   VALUE SPACES.06050000
058300     05  RPT-MKDN-MKUP-PERIOD-TOT-PCT   PIC  X(06)   VALUE SPACES.06060000
058400                                                                  06070000
058500 01  REPORT-MKDN-TYPE-TOTAL-LINE.                                 06080000
058600     05  FILLER                         PIC  X(06)   VALUE SPACES.06090000
058700     05  FILLER                         PIC  X(05)   VALUE        06100000
058800         'TOTAL'.                                                 06110000
058900     05  FILLER                         PIC  X(15)   VALUE SPACES.06120000
059000     05  RPT-MKDN-TYPE-TOT-PER-1-AMT    PIC  X(19)   VALUE SPACES.06130000
059100     05  FILLER                         PIC  X(05)   VALUE SPACES.06140000
059200     05  RPT-MKDN-TYPE-TOT-PER-2-AMT    PIC  X(19)   VALUE SPACES.06150000
059300     05  FILLER                         PIC  X(05)   VALUE SPACES.06160000
059400     05  RPT-MKDN-TYPE-TOT-PER-3-AMT    PIC  X(19)   VALUE SPACES.06170000
059500     05  FILLER                         PIC  X(05)   VALUE SPACES.06180000
059600     05  RPT-MKDN-TYPE-TOT-PER-4-AMT    PIC  X(19)   VALUE SPACES.06190000
059700     05  FILLER                         PIC  X(05)   VALUE SPACES.06200000
059800     05  RPT-MKDN-TYPE-TOT-PER-5-AMT    PIC  X(19)   VALUE SPACES.06210000
059900     05  FILLER                         PIC  X(05)   VALUE SPACES.06220000
060000     05  RPT-MKDN-TYPE-TOT-PER-6-AMT    PIC  X(19)   VALUE SPACES.06230000
060100     05  FILLER                         PIC  X(09)   VALUE SPACES.06240000
060200     05  RPT-MKDN-TYPE-TOT-PER-AMOUNT   PIC  X(19)   VALUE SPACES.06250000
060300     05  FILLER                         PIC  X(07)   VALUE SPACES.06260000
060400                                                                  06270000
060500 01  REPORT-ORIGIN-TOTAL-LINE.                                    06280000
060600     05  FILLER                         PIC  X(05)   VALUE        06290000
060700         'TOTAL'.                                                 06300000
060800     05  FILLER                         PIC  X(01)   VALUE SPACE. 06310000
060900     05  RPT-ORIGIN-PRICE-CHG           PIC  X(19)   VALUE SPACES.06320000
061000     05  FILLER                         PIC  X(01)   VALUE SPACES.06330000
061100     05  RPT-ORIGIN-TOT-PER-1-AMT       PIC  X(19)   VALUE SPACES.06340000
061200     05  FILLER                         PIC  X(05)   VALUE SPACES.06350000
061300     05  RPT-ORIGIN-TOT-PER-2-AMT       PIC  X(19)   VALUE SPACES.06360000
061400     05  FILLER                         PIC  X(05)   VALUE SPACES.06370000
061500     05  RPT-ORIGIN-TOT-PER-3-AMT       PIC  X(19)   VALUE SPACES.06380000
061600     05  FILLER                         PIC  X(05)   VALUE SPACES.06390000
061700     05  RPT-ORIGIN-TOT-PER-4-AMT       PIC  X(19)   VALUE SPACES.06400000
061800     05  FILLER                         PIC  X(05)   VALUE SPACES.06410000
061900     05  RPT-ORIGIN-TOT-PER-5-AMT       PIC  X(19)   VALUE SPACES.06420000
062000     05  FILLER                         PIC  X(05)   VALUE SPACES.06430000
062100     05  RPT-ORIGIN-TOT-PER-6-AMT       PIC  X(19)   VALUE SPACES.06440000
062200     05  FILLER                         PIC  X(09)   VALUE SPACES.06450000
062300     05  RPT-ORIGIN-TOT-PER-AMOUNT      PIC  X(19)   VALUE SPACES.06460000
062400     05  FILLER                         PIC  X(07)   VALUE SPACES.06470000
062500                                                                  06480000
062600 01  REPORT-DEPT-HEADING-TOT-LINE.                                06490000
062700     05  FILLER                         PIC  X(06)   VALUE        06500000
062800         'DEPT. '.                                                06510000
062900     05  FILLER                         PIC  X(01)   VALUE SPACES.06520000
063000     05  RPT-DEPT-TL-DEPT-NBR           PIC  X(03)   VALUE SPACES.06530000
063100     05  FILLER                         PIC  X(01)   VALUE SPACES.06540000
063200     05  FILLER                         PIC  X(07)   VALUE        06550000
063300         'TOTALS:'.                                               06560000
063400     05  FILLER                         PIC  X(182)  VALUE SPACES.06570000
063500                                                                  06580000
063600 01  REPORT-DEPT-TOTAL-LINE.                                      06590000
063700     05  RPT-DEPT-TOT-DESC              PIC  X(10)   VALUE SPACES.06600000
063800     05  FILLER                         PIC  X(16)   VALUE SPACES.06610000
063900     05  RPT-DEPT-TOT-PER-1-AMT         PIC  X(19)   VALUE SPACES.06620000
064000     05  FILLER                         PIC  X(05)   VALUE SPACES.06630000
064100     05  RPT-DEPT-TOT-PER-2-AMT         PIC  X(19)   VALUE SPACES.06640000
064200     05  FILLER                         PIC  X(05)   VALUE SPACES.06650000
064300     05  RPT-DEPT-TOT-PER-3-AMT         PIC  X(19)   VALUE SPACES.06660000
064400     05  FILLER                         PIC  X(05)   VALUE SPACES.06670000
064500     05  RPT-DEPT-TOT-PER-4-AMT         PIC  X(19)   VALUE SPACES.06680000
064600     05  FILLER                         PIC  X(05)   VALUE SPACES.06690000
064700     05  RPT-DEPT-TOT-PER-5-AMT         PIC  X(19)   VALUE SPACES.06700000
064800     05  FILLER                         PIC  X(05)   VALUE SPACES.06710000
064900     05  RPT-DEPT-TOT-PER-6-AMT         PIC  X(19)   VALUE SPACES.06720000
065000     05  FILLER                         PIC  X(09)   VALUE SPACES.06730000
065100     05  RPT-DEPT-TOT-PER-AMOUNT        PIC  X(19)   VALUE SPACES.06740000
065200     05  FILLER                         PIC  X(07)   VALUE SPACES.06750000
065300                                                                  06760000
065400 01  REPORT-SUMM-HEADING-TOT-LINE.                                06770000
065500     05  RPT-SUMM-TOT-LEVEL             PIC  X(30)   VALUE SPACES.06780000
065600     05  FILLER                         PIC  X(170)  VALUE SPACES.06790000
065700                                                                  06800000
065800 01  REPORT-SUMMARY-TOT-LINE.                                     06810000
065900     05  RPT-SUMM-TOT-DESC              PIC  X(10)   VALUE SPACES.06820000
066000     05  FILLER                         PIC  X(16)   VALUE SPACES.06830000
066100     05  RPT-SUMM-TOT-PER-1-AMT         PIC  X(19)   VALUE SPACES.06840000
066200     05  FILLER                         PIC  X(05)   VALUE SPACES.06850000
066300     05  RPT-SUMM-TOT-PER-2-AMT         PIC  X(19)   VALUE SPACES.06860000
066400     05  FILLER                         PIC  X(05)   VALUE SPACES.06870000
066500     05  RPT-SUMM-TOT-PER-3-AMT         PIC  X(19)   VALUE SPACES.06880000
066600     05  FILLER                         PIC  X(05)   VALUE SPACES.06890000
066700     05  RPT-SUMM-TOT-PER-4-AMT         PIC  X(19)   VALUE SPACES.06900000
066800     05  FILLER                         PIC  X(05)   VALUE SPACES.06910000
066900     05  RPT-SUMM-TOT-PER-5-AMT         PIC  X(19)   VALUE SPACES.06920000
067000     05  FILLER                         PIC  X(05)   VALUE SPACES.06930000
067100     05  RPT-SUMM-TOT-PER-6-AMT         PIC  X(19)   VALUE SPACES.06940000
067200     05  FILLER                         PIC  X(09)   VALUE SPACES.06950000
067300     05  RPT-SUMM-TOT-PER-AMOUNT        PIC  X(19)   VALUE SPACES.06960000
067400     05  FILLER                         PIC  X(07)   VALUE SPACES.06970000
067500                                                                  06980000
067600 01  REPORT-BLANK-LINE                  PIC  X(200)  VALUE SPACES.06990000
067700                                                                  07000000
067800 01  REPORT-UNDERLINE                   PIC  X(200)  VALUE        07010000
067900     ALL '_'.                                                     07020000
068000                                                                  07030000
068100 01  REPORT-ENDING-LINE.                                          07040000
068200     05  FILLER                         PIC  X(90)   VALUE SPACES.07050000
068300     05  FILLER                         PIC  X(19)   VALUE        07060000
068400         '***END OF REPORT***'.                                   07070000
068500     05  FILLER                         PIC  X(91)   VALUE SPACES.07080000
068600                                                                  07090000
068700******************************************************************07100000
068800*    DATE ROUTINE COPY MEMBERS                                   *07110000
068900******************************************************************07120000
069000     COPY DPWS500.                                                07130000
069100******************************************************************07140000
069200*    VARIABLES REQUIRED FOR THE FORMAT SQLCA ROUTINE DPPD004     *07150000
069300******************************************************************07160000
069400     COPY DPWS004.                                                07170000
069500******************************************************************07180000
069600*    PE-DEPARTMENT MARKUP/MARKDOWN TABLE                         *07190000
069700******************************************************************07200000
069800     EXEC SQL                                                     07210000
069900         INCLUDE TWKMUMD                                          07220000
070000     END-EXEC.                                                    07230000
070100******************************************************************07240000
070200*    MB-MERCHANDISE AREA TABLE                                   *07250000
070300******************************************************************07260000
070400     EXEC SQL                                                     07270000
070500         INCLUDE TMDSEAR                                          07280000
070600     END-EXEC.                                                    07290000
070700******************************************************************07300000
070800*    MB-RESPONSIBILITY AREA TABLE                                *07310000
070900******************************************************************07320000
071000     EXEC SQL                                                     07330000
071100         INCLUDE TRSPBAR                                          07340000
071200     END-EXEC.                                                    07350000
071300******************************************************************07360000
071400*    STANDARD LAYOUT FOR THE SQL COMMUNCATIONS AREA              *07370000
071500******************************************************************07380000
071600     EXEC SQL                                                     07390000
071700         INCLUDE SQLCA                                            07400000
071800     END-EXEC.                                                    07410000
071900                                                                  07420000
072000     COPY SQLCA2.                                                 07430000
072100                                                                  07440000
072200******************************************************************07450000
072300*    WEEKLY_CSR  SUMS THE MARKUP/MARKDOWN AMOUNT BY WEEK IN      *07460000
072400*                THE FISCAL MONTH AT A DEPARTMENT LEVEL.         *07470000
072500******************************************************************07480000
072600                                                                  07490000
072700     EXEC SQL                                                     07500000
072800          DECLARE WEEKLY_CSR CURSOR                               07510000
072900          FOR SELECT                                              07520000
073000                FSCL_MN                                           07530000
073100              , FSCL_YR                                           07540000
073200              , DEPT_NBR                                          07550000
073300              , FSCL_WK                                           07560000
073400              , ORGN_CDE                                          07570000
073500              , PRIC_CHG_TYP_CDE                                  07580000
073600              , RSN_CDE                                           07590000
073700              , SUM(TOT_MU_MD_AMT)                                07600000
073800          FROM                                                    07610000
073900                TWKMUMD                                           07620000
074000          WHERE                                                   07630000
074100                FSCL_MN        = :WKMUMD-FSCL-MN                  07640000
074200            AND FSCL_YR        = :WKMUMD-FSCL-YR                  07650000
074300            AND FSCL_WK       <= :WKMUMD-FSCL-WK                  07660000
074400          GROUP BY                                                07670000
074500                FSCL_YR                                           07680000
074600              , FSCL_MN                                           07690000
074700              , DEPT_NBR                                          07700000
074800              , FSCL_WK                                           07710000
074900              , ORGN_CDE                                          07720000
075000              , PRIC_CHG_TYP_CDE                                  07730000
075100              , RSN_CDE                                           07740000
075200          ORDER BY                                                07750000
075300                FSCL_YR                                           07760000
075400              , FSCL_MN                                           07770000
075500              , DEPT_NBR                                          07780000
075600              , ORGN_CDE                                          07790000
075700              , PRIC_CHG_TYP_CDE                                  07800000
075800              , RSN_CDE                                           07810000
075900              , FSCL_WK ASC                                       07820000
076000     END-EXEC.                                                    07830000
076100                                                                  07840000
076200******************************************************************07850000
076300*    SEASON_CSR SUMS THE MARKUP/MARKDOWN AMOUNT BY MONTH FOR     *07860000
076400*               THE CHOSEN FISCAL SEASON (SPRING OR FALL)        *07870000
076500*               AT A DEPARTMENT LEVEL.                           *07880000
076600******************************************************************07890000
076700                                                                  07900000
076800     EXEC SQL                                                     07910000
076900          DECLARE SEASON_CSR CURSOR                               07920000
077000          FOR SELECT                                              07930000
077100                FSCL_MN                                           07940000
077200              , FSCL_YR                                           07950000
077300              , DEPT_NBR                                          07960000
077400              , ORGN_CDE                                          07970000
077500              , PRIC_CHG_TYP_CDE                                  07980000
077600              , RSN_CDE                                           07990000
077700              , SUM(TOT_MU_MD_AMT)                                08000000
077800          FROM                                                    08010000
077900                TWKMUMD                                           08020000
078000          WHERE                                                   08030000
078100                (FSCL_MN  BETWEEN :DK-START-OF-SEASON             08040000
078200                              AND :DK-END-OF-SEASON)              08050000
078300            AND FSCL_YR         = :WKMUMD-FSCL-YR                 08060000
078400            AND (DEPT_NBR BETWEEN :DK-SEASONAL-DEPT-LOW           08070000
078500                              AND :DK-SEASONAL-DEPT-HIGH)         08080000
078600          GROUP BY                                                08090000
078700                FSCL_YR                                           08100000
078800              , FSCL_MN                                           08110000
078900              , DEPT_NBR                                          08120000
079000              , ORGN_CDE                                          08130000
079100              , PRIC_CHG_TYP_CDE                                  08140000
079200              , RSN_CDE                                           08150000
079300          ORDER BY                                                08160000
079400                FSCL_YR                                           08170000
079500              , DEPT_NBR                                          08180000
079600              , ORGN_CDE                                          08190000
079700              , PRIC_CHG_TYP_CDE                                  08200000
079800              , RSN_CDE                                           08210000
079900              , FSCL_MN                                           08220000
080000     END-EXEC.                                                    08230000
080100                                                                  08240000
080200******************************************************************08250000
080300*    DMM_CSR     SUMS THE MARKUP/MARKDOWN AMOUNT BY WEEK IN      *08260000
080400*                THE FISCAL MONTH AT A DMM LEVEL.                *08270000
080500******************************************************************08280000
080600                                                                  08290000
080700     EXEC SQL                                                     08300000
080800          DECLARE DMM_CSR CURSOR                                  08310000
080900          FOR SELECT                                              08320000
081000                A.GMA_NBR                                         08330000
081100              , A.DMA_NBR                                         08340000
081200              , M.FSCL_WK                                         08350000
081300              , M.ORGN_CDE                                        08360000
081400              , M.PRIC_CHG_TYP_CDE                                08370000
081500              , M.RSN_CDE                                         08380000
081600              , SUM(M.TOT_MU_MD_AMT)                              08390000
081700          FROM                                                    08400000
081800                TMDSEAR A                                         08410000
081900              , TWKMUMD M                                         08420000
082000          WHERE                                                   08430000
082100                A.OPERCO_NBR   = '03'                             08440000
082200            AND A.MDSELV_CDE   = 'DPT'                            08450000
082300            AND A.DEPT_NBR     = M.DEPT_NBR                       08460000
082400            AND (CURRENT DATE                                     08470000
082500                               BETWEEN A.STRT_DTE AND A.END_DTE)  08480000
082600            AND M.FSCL_MN      = :WKMUMD-FSCL-MN                  08490000
082700            AND M.FSCL_YR      = :WKMUMD-FSCL-YR                  08500000
082800            AND M.FSCL_WK     <= :WKMUMD-FSCL-WK                  08510000
082900          GROUP BY                                                08520000
083000                A.GMA_NBR                                         08530000
083100              , A.DMA_NBR                                         08540000
083200              , M.FSCL_WK                                         08550000
083300              , M.ORGN_CDE                                        08560000
083400              , M.PRIC_CHG_TYP_CDE                                08570000
083500              , M.RSN_CDE                                         08580000
083600          ORDER BY                                                08590000
083700                A.GMA_NBR                                         08600000
083800              , A.DMA_NBR                                         08610000
083900              , M.ORGN_CDE                                        08620000
084000              , M.PRIC_CHG_TYP_CDE                                08630000
084100              , M.RSN_CDE                                         08640000
084200              , M.FSCL_WK                                         08650000
084300     END-EXEC.                                                    08660000
084400                                                                  08670000
084500******************************************************************08680000
084600*    DMM_SEASON_CSR  SUMS THE MARKUP/MARKDOWN AMOUNT BY MONTH    *08690000
084700*                    FOR THE FISCAL SEASON AT A DMM LEVEL.       *08700000
084800******************************************************************08710000
084900                                                                  08720000
085000     EXEC SQL                                                     08730000
085100          DECLARE DMM_SEASON_CSR CURSOR                           08740000
085200          FOR SELECT                                              08750000
085300                A.GMA_NBR                                         08760000
085400              , A.DMA_NBR                                         08770000
085500              , M.FSCL_MN                                         08780000
085600              , M.ORGN_CDE                                        08790000
085700              , M.PRIC_CHG_TYP_CDE                                08800000
085800              , M.RSN_CDE                                         08810000
085900              , SUM(M.TOT_MU_MD_AMT)                              08820000
086000          FROM                                                    08830000
086100                TMDSEAR A                                         08840000
086200              , TWKMUMD M                                         08850000
086300          WHERE                                                   08860000
086400                A.OPERCO_NBR   = '03'                             08870000
086500            AND A.MDSELV_CDE   = 'DPT'                            08880000
086600            AND A.DEPT_NBR     = M.DEPT_NBR                       08890000
086700            AND (CURRENT DATE                                     08900000
086800                               BETWEEN A.STRT_DTE AND A.END_DTE)  08910000
086900            AND (M.FSCL_MN     BETWEEN :DK-START-OF-SEASON        08920000
087000                                   AND :DK-END-OF-SEASON)         08930000
087100            AND M.FSCL_YR      = :WKMUMD-FSCL-YR                  08940000
087200          GROUP BY                                                08950000
087300                A.GMA_NBR                                         08960000
087400              , A.DMA_NBR                                         08970000
087500              , M.FSCL_MN                                         08980000
087600              , M.ORGN_CDE                                        08990000
087700              , M.PRIC_CHG_TYP_CDE                                09000000
087800              , M.RSN_CDE                                         09010000
087900          ORDER BY                                                09020000
088000                A.GMA_NBR                                         09030000
088100              , A.DMA_NBR                                         09040000
088200              , M.ORGN_CDE                                        09050000
088300              , M.PRIC_CHG_TYP_CDE                                09060000
088400              , M.RSN_CDE                                         09070000
088500              , M.FSCL_MN                                         09080000
088600     END-EXEC.                                                    09090000
088700                                                                  09100000
088800******************************************************************09110000
088900*    GMM_CSR     SUMS THE MARKUP/MARKDOWN AMOUNT BY WEEK IN      *09120000
089000*                THE FISCAL MONTH AT A GMM LEVEL.                *09130000
089100******************************************************************09140000
089200                                                                  09150000
089300     EXEC SQL                                                     09160000
089400          DECLARE GMM_CSR CURSOR                                  09170000
089500          FOR SELECT                                              09180000
089600                A.GMA_NBR                                         09190000
089700              , M.FSCL_WK                                         09200000
089800              , M.ORGN_CDE                                        09210000
089900              , M.PRIC_CHG_TYP_CDE                                09220000
090000              , M.RSN_CDE                                         09230000
090100              , SUM(M.TOT_MU_MD_AMT)                              09240000
090200          FROM                                                    09250000
090300                TMDSEAR A                                         09260000
090400              , TWKMUMD M                                         09270000
090500          WHERE                                                   09280000
090600                A.OPERCO_NBR   = '03'                             09290000
090700            AND A.MDSELV_CDE   = 'DPT'                            09300000
090800            AND A.DEPT_NBR     = M.DEPT_NBR                       09310000
090900            AND (CURRENT DATE                                     09320000
091000                               BETWEEN A.STRT_DTE AND A.END_DTE)  09330000
091100            AND M.FSCL_MN      = :WKMUMD-FSCL-MN                  09340000
091200            AND M.FSCL_YR      = :WKMUMD-FSCL-YR                  09350000
091300            AND M.FSCL_WK     <= :WKMUMD-FSCL-WK                  09360000
091400          GROUP BY                                                09370000
091500                A.GMA_NBR                                         09380000
091600              , M.FSCL_WK                                         09390000
091700              , M.ORGN_CDE                                        09400000
091800              , M.PRIC_CHG_TYP_CDE                                09410000
091900              , M.RSN_CDE                                         09420000
092000          ORDER BY                                                09430000
092100                A.GMA_NBR                                         09440000
092200              , M.ORGN_CDE                                        09450000
092300              , M.PRIC_CHG_TYP_CDE                                09460000
092400              , M.RSN_CDE                                         09470000
092500              , M.FSCL_WK                                         09480000
092600     END-EXEC.                                                    09490000
092700                                                                  09500000
092800******************************************************************09510000
092900*    GMM_SEASON_CSR  SUMS THE MARKUP/MARKDOWN AMOUNT BY MONTH    *09520000
093000*                    FOR THE FISCAL SEASON AT A GMM LEVEL.       *09530000
093100******************************************************************09540000
093200                                                                  09550000
093300     EXEC SQL                                                     09560000
093400          DECLARE GMM_SEASON_CSR CURSOR                           09570000
093500          FOR SELECT                                              09580000
093600                A.GMA_NBR                                         09590000
093700              , M.FSCL_MN                                         09600000
093800              , M.ORGN_CDE                                        09610000
093900              , M.PRIC_CHG_TYP_CDE                                09620000
094000              , M.RSN_CDE                                         09630000
094100              , SUM(M.TOT_MU_MD_AMT)                              09640000
094200          FROM                                                    09650000
094300                TMDSEAR A                                         09660000
094400              , TWKMUMD M                                         09670000
094500          WHERE                                                   09680000
094600                A.OPERCO_NBR   = '03'                             09690000
094700            AND A.MDSELV_CDE   = 'DPT'                            09700000
094800            AND A.DEPT_NBR     = M.DEPT_NBR                       09710000
094900            AND (CURRENT DATE                                     09720000
095000                               BETWEEN A.STRT_DTE AND A.END_DTE)  09730000
095100            AND (M.FSCL_MN     BETWEEN :DK-START-OF-SEASON        09740000
095200                                   AND :DK-END-OF-SEASON)         09750000
095300            AND M.FSCL_YR      = :WKMUMD-FSCL-YR                  09760000
095400          GROUP BY                                                09770000
095500                A.GMA_NBR                                         09780000
095600              , M.FSCL_MN                                         09790000
095700              , M.ORGN_CDE                                        09800000
095800              , M.PRIC_CHG_TYP_CDE                                09810000
095900              , M.RSN_CDE                                         09820000
096000          ORDER BY                                                09830000
096100                A.GMA_NBR                                         09840000
096200              , M.ORGN_CDE                                        09850000
096300              , M.PRIC_CHG_TYP_CDE                                09860000
096400              , M.RSN_CDE                                         09870000
096500              , M.FSCL_MN                                         09880000
096600     END-EXEC.                                                    09890000
096700                                                                  09900000
096800******************************************************************09910000
096900*    CORP_CSR    SUMS THE MARKUP/MARKDOWN AMOUNT BY WEEK IN      *09920000
097000*                THE FISCAL MONTH AT A CORPORATE LEVEL.          *09930000
097100******************************************************************09940000
097200                                                                  09950000
097300     EXEC SQL                                                     09960000
097400          DECLARE CORP_CSR CURSOR                                 09970000
097500          FOR SELECT                                              09980000
097600                M.FSCL_WK                                         09990000
097700              , M.ORGN_CDE                                        10000000
097800              , M.PRIC_CHG_TYP_CDE                                10010000
097900              , M.RSN_CDE                                         10020000
098000              , SUM(M.TOT_MU_MD_AMT)                              10030000
098100          FROM                                                    10040000
098200                TMDSEAR A                                         10050000
098300              , TWKMUMD M                                         10060000
098400          WHERE                                                   10070000
098500                A.OPERCO_NBR   = '03'                             10080000
098600            AND A.MDSELV_CDE   = 'DPT'                            10090000
098700            AND A.DEPT_NBR     = M.DEPT_NBR                       10100000
098800            AND (CURRENT DATE                                     10110000
098900                               BETWEEN A.STRT_DTE AND A.END_DTE)  10120000
099000            AND M.FSCL_MN      = :WKMUMD-FSCL-MN                  10130000
099100            AND M.FSCL_YR      = :WKMUMD-FSCL-YR                  10140000
099200            AND M.FSCL_WK     <= :WKMUMD-FSCL-WK                  10150000
099300          GROUP BY                                                10160000
099400                M.FSCL_WK                                         10170000
099500              , M.ORGN_CDE                                        10180000
099600              , M.PRIC_CHG_TYP_CDE                                10190000
099700              , M.RSN_CDE                                         10200000
099800          ORDER BY                                                10210000
099900                M.ORGN_CDE                                        10220000
100000              , M.PRIC_CHG_TYP_CDE                                10230000
100100              , M.RSN_CDE                                         10240000
100200              , M.FSCL_WK                                         10250000
100300     END-EXEC.                                                    10260000
100400                                                                  10270000
100500******************************************************************10280000
100600*    CORP_SEASON_CSR  SUMS THE MARKUP/MARKDOWN AMOUNT BY MONTH   *10290000
100700*                     FOR THE FISCAL SEASON AT THE CORPORATE     *10300000
100800*                     LEVEL.                                     *10310000
100900******************************************************************10320000
101000                                                                  10330000
101100     EXEC SQL                                                     10340000
101200          DECLARE CORP_SEASON_CSR CURSOR                          10350000
101300          FOR SELECT                                              10360000
101400                M.FSCL_MN                                         10370000
101500              , M.ORGN_CDE                                        10380000
101600              , M.PRIC_CHG_TYP_CDE                                10390000
101700              , M.RSN_CDE                                         10400000
101800              , SUM(M.TOT_MU_MD_AMT)                              10410000
101900          FROM                                                    10420000
102000                TMDSEAR A                                         10430000
102100              , TWKMUMD M                                         10440000
102200          WHERE                                                   10450000
102300                A.OPERCO_NBR   = '03'                             10460000
102400            AND A.MDSELV_CDE   = 'DPT'                            10470000
102500            AND A.DEPT_NBR     = M.DEPT_NBR                       10480000
102600            AND (CURRENT DATE                                     10490000
102700                               BETWEEN A.STRT_DTE AND A.END_DTE)  10500000
102800            AND (M.FSCL_MN     BETWEEN :DK-START-OF-SEASON        10510000
102900                                   AND :DK-END-OF-SEASON)         10520000
103000            AND M.FSCL_YR      = :WKMUMD-FSCL-YR                  10530000
103100          GROUP BY                                                10540000
103200                M.FSCL_MN                                         10550000
103300              , M.ORGN_CDE                                        10560000
103400              , M.PRIC_CHG_TYP_CDE                                10570000
103500              , M.RSN_CDE                                         10580000
103600          ORDER BY                                                10590000
103700                M.ORGN_CDE                                        10600000
103800              , M.PRIC_CHG_TYP_CDE                                10610000
103900              , M.RSN_CDE                                         10620000
104000              , M.FSCL_MN                                         10630000
104100     END-EXEC.                                                    10640000
104200                                                                  10650000
104300 PROCEDURE DIVISION.                                              10660000
104400                                                                  10670000
104500 A100-MAINLINE.                                                   10680000
104600                                                                  10690000
104700     PERFORM B100-INITIALIZE.                                     10700000
104800                                                                  10710000
104900     PERFORM B200-PROCESS-REPORT                                  10720000
105000         UNTIL PS-END-OF-WEEKLY-CSR                               10730000
105100            OR PS-END-OF-SEASON-CSR.                              10740000
105200                                                                  10750000
105300     IF CR-VALID-SEASON                                           10760000
105400         PERFORM C175-CLOSE-SEASON-CSR                            10770000
105500     ELSE                                                         10780000
105600         PERFORM C275-CLOSE-WEEKLY-CSR                            10790000
105700     END-IF.                                                      10800000
105800                                                                  10810000
105900     PERFORM C200-PRINT-DETAIL.                                   10820000
106000     PERFORM D300-PRINT-ORGN-TYPE-TOT-LINE.                       10830000
106100     PERFORM D400-PRINT-ORGN-TOT-LINE.                            10840000
106200     PERFORM D500-PRINT-DEPT-TOT-LINE.                            10850000
106300                                                                  10860000
106400     IF CR-VALID-BATCH                                            10870000
106500         SET PS-SUMMARY-LEVEL-REPORT TO TRUE                      10880000
106600                                                                  10890000
106700         SET PS-DMM-SUMMARY-LVL      TO TRUE                      10900000
106800         PERFORM B300-DMM-INITIALIZE                              10910000
106900         PERFORM B400-PROCESS-DMM-SUMMARY                         10920000
107000             UNTIL PS-END-OF-DMM-CSR                              10930000
107100         PERFORM B330-CLOSE-DMM-CSR                               10940000
107200         PERFORM C200-PRINT-DETAIL                                10950000
107300         PERFORM D300-PRINT-ORGN-TYPE-TOT-LINE                    10960000
107400         PERFORM D400-PRINT-ORGN-TOT-LINE                         10970000
107500         PERFORM D600-PRINT-DMM-TOT-LINE                          10980000
107600                                                                  10990000
107700         SET PS-GMM-SUMMARY-LVL      TO TRUE                      11000000
107800         PERFORM B500-GMM-INITIALIZE                              11010000
107900         PERFORM B600-PROCESS-GMM-SUMMARY                         11020000
108000             UNTIL PS-END-OF-GMM-CSR                              11030000
108100         PERFORM B530-CLOSE-GMM-CSR                               11040000
108200         PERFORM C200-PRINT-DETAIL                                11050000
108300         PERFORM D300-PRINT-ORGN-TYPE-TOT-LINE                    11060000
108400         PERFORM D400-PRINT-ORGN-TOT-LINE                         11070000
108500         PERFORM D600-PRINT-GMM-TOT-LINE                          11080000
108600                                                                  11090000
108700         SET PS-CORP-SUMMARY-LVL     TO TRUE                      11100000
108800         PERFORM B700-CORP-INITIALIZE                             11110000
108900         PERFORM B800-PROCESS-CORP-SUMMARY                        11120000
109000             UNTIL PS-END-OF-CORP-CSR                             11130000
109100         PERFORM B730-CLOSE-CORP-CSR                              11140000
109200         PERFORM C200-PRINT-DETAIL                                11150000
109300         PERFORM D300-PRINT-ORGN-TYPE-TOT-LINE                    11160000
109400         PERFORM D400-PRINT-ORGN-TOT-LINE                         11170000
109500         PERFORM D600-PRINT-CORP-TOT-LINE                         11180000
109600                                                                  11190000
109700     END-IF.                                                      11200000
109800                                                                  11210000
109900     PERFORM B900-EOJ-ROUTINE.                                    11220000
110000                                                                  11230000
110100     GOBACK.                                                      11240000
110200                                                                  11250000
110300******************************************************************11260000
110400*     B100-INITIALIZE                                            *11270000
110500* ==> PROCESSES:                                                 *11280000
110600*     - READS THE CONTROL FILE RECORD                            *11290000
110700*     - ACCEPTS THE CURRENT DATE AND TIME FOR THE REPORT HEADING *11300000
110800*     - READS THE FIRST RECORD FROM THE AUDIT REPORT FILE        *11310000
110900* ==> PERFORMED FROM:  A100-MAINLINE                             *11320000
111000******************************************************************11330000
111100 B100-INITIALIZE.                                                 11340000
111200                                                                  11350000
111300     OPEN INPUT CONTROL-FILE.                                     11360000
111400     OPEN OUTPUT REPORT-FILE.                                     11370000
111500                                                                  11380000
111600     READ CONTROL-FILE INTO CR-CONTROL-RECORD                     11390000
111700         AT END                                                   11400000
111800             SET PS-END-OF-CONTROL-FILE TO TRUE.                  11410000
111900                                                                  11420000
112000     IF PS-END-OF-CONTROL-FILE                                    11430000
112100         DISPLAY ' '                                              11440000
112200         DISPLAY '** ABEND     **'                                11450000
112300         DISPLAY '** PROGRAM   **  = ' PC-PROGRAM-NAME            11460000
112400         DISPLAY '** PARAGRAPH **  = B100-INITIALIZE      '       11470000
112500         DISPLAY '** CONTROL FILE IS EMPTY  '                     11480000
112600         DISPLAY ' '                                              11490000
112700         MOVE +4002 TO ABEND-CODE                                 11500000
112800         CALL 'ILBOABN0' USING ABEND-CODE                         11510000
112900     ELSE                                                         11520000
113000         PERFORM  Z815-DISPLAY-CONTROLS                           11530000
113100     END-IF.                                                      11540000
113200                                                                  11550000
113300     MOVE CR-PERIOD-END-DATE       TO PV-PERIOD-END-DATE.         11560000
113400                                                                  11570000
113500     ACCEPT PV-CURRENT-DATE      FROM DATE.                       11580000
113600     MOVE PV-CURRENT-YEAR          TO DP200O-RUN-YEAR.            11590000
113700     MOVE PV-CURRENT-MONTH         TO DP200O-RUN-MONTH.           11600000
113800     MOVE PV-CURRENT-DAY           TO DP200O-RUN-DAY.             11610000
113900                                                                  11620000
114000     ACCEPT PV-CURRENT-TIME      FROM TIME.                       11630000
114100     MOVE PV-CURRENT-HOUR          TO DP200O-RUN-HOUR.            11640000
114200     MOVE PV-CURRENT-MINUTE        TO DP200O-RUN-MINUTE.          11650000
114300                                                                  11660000
114400     MOVE PC-PROGRAM-NAME          TO DP200O-PROGRAM-NAME.        11670000
114500                                                                  11680000
114600     EVALUATE TRUE                                                11690000
114700         WHEN CR-END-OF-WEEK                                      11700000
114800             MOVE PC-ONE           TO DP200O-REPORT-NUMBER        11710000
114900             MOVE PC-WEEKLY-JOB    TO DP200O-JOB-NUMBER           11720000
115000         WHEN CR-END-OF-MONTH                                     11730000
115100             MOVE PC-TWO           TO DP200O-REPORT-NUMBER        11740000
115200             MOVE PC-MONTHLY-JOB   TO DP200O-JOB-NUMBER           11750000
115300         WHEN CR-CUMULATIVE-SEASON                                11760000
115400             MOVE PC-THREE         TO DP200O-REPORT-NUMBER        11770000
115500             MOVE PC-MONTHLY-JOB   TO DP200O-JOB-NUMBER           11780000
115600     END-EVALUATE.                                                11790000
115700                                                                  11800000
115800     PERFORM Z800-GET-MONTH.                                      11810000
115900                                                                  11820000
116000     IF CR-VALID-SEASON                                           11830000
116100         PERFORM C100-OPEN-SEASON-CSR                             11840000
116200         PERFORM C150-FETCH-SEASON-CSR                            11850000
116300     ELSE                                                         11860000
116400         PERFORM C200-OPEN-WEEKLY-CSR                             11870000
116500         PERFORM C250-FETCH-WEEKLY-CSR                            11880000
116600     END-IF.                                                      11890000
116700                                                                  11900000
116800     PERFORM C300-INIT-REPORT-TITLES.                             11910000
116900     MOVE 'GMM:'                   TO RPT-HL1-GMM-LITERAL.        11920000
117000     MOVE 'DMM:'                   TO RPT-HL1-DMM-LITERAL.        11930000
117100     MOVE 'BUYER:'                 TO RPT-HL1-BUYER-LITERAL.      11940000
117200     PERFORM C400-GET-DEPT-INFORMATION.                           11950000
117300                                                                  11960000
117400     IF PS-END-OF-WEEKLY-CSR OR PS-END-OF-SEASON-CSR              11970000
117500         ADD PC-ONE                TO PA-PAGE-COUNTER             11980000
117600         MOVE PA-PAGE-COUNTER      TO DP200O-PAGE-NUMBER          11990000
117700                                                                  12000000
117800         WRITE REPORT-RECORD                                      12010000
117900             FROM DP200O-STANDRD-HEADER-200-COLS                  12020000
118000             AFTER ADVANCING PAGE                                 12030000
118100                                                                  12040000
118200         INITIALIZE DP200O-LASER-NEW-PAGE-INDICATR                12050000
118300                                                                  12060000
118400         WRITE REPORT-RECORD                                      12070000
118500             FROM REPORT-TITLE-LINE                               12080000
118600             AFTER ADVANCING 1 LINE                               12090000
118700                                                                  12100000
118800         WRITE REPORT-RECORD                                      12110000
118900             FROM REPORT-TITLE-LINE2                              12120000
119000             AFTER ADVANCING 1 LINE                               12130000
119100                                                                  12140000
119200     ELSE                                                         12150000
119300         MOVE WKMUMD-DEPT-NBR     TO PV-HOLD-DEPT-NBR             12160000
119400         MOVE WKMUMD-ORGN-CDE     TO PV-HOLD-ORGN-CDE             12170000
119500         MOVE WKMUMD-PRIC-CHG-TYP-CDE                             12180000
119600                                  TO PV-HOLD-PRIC-CHG-TYP-CDE     12190000
119700         MOVE WKMUMD-RSN-CDE      TO PV-HOLD-RSN-CDE              12200000
119800         PERFORM D100-PROCESS-PAGE-BREAK                          12210000
119900         PERFORM E100-PRINT-ORGN-TYP-LINE                         12220000
120000                                                                  12230000
120100         PERFORM D200-DETERMINE-ORGN-TYP-SUM                      12240000
120200                                                                  12250000
120300         MOVE PE049-MKDN-RPT-RSN-VALUE-TABLE                      12260000
120400                                   TO PE049-MKDN-RPT-RSN-TABLE    12270000
120500                                                                  12280000
120600     END-IF.                                                      12290000
120700                                                                  12300000
120800******************************************************************12310000
120900*     B200-PROCESS-REPORT                                        *12320000
121000* ==> PROCESSES:                                                 *12330000
121100*     - WRITES A LINE TO THE REPORT FOR EACH RECORD IN THE AUDIT *12340000
121200*       REPORT FILE.                                             *12350000
121300*     - TAKES CARE OF BREAKING BY STORE NUMBER                   *12360000
121400* ==> PERFORMED FROM:  A100-MAINLINE                             *12370000
121500******************************************************************12380000
121600 B200-PROCESS-REPORT.                                             12390000
121700                                                                  12400000
121800     IF WKMUMD-DEPT-NBR = PV-HOLD-DEPT-NBR                        12410000
121900        IF WKMUMD-ORGN-CDE = PV-HOLD-ORGN-CDE                     12420000
122000           IF WKMUMD-PRIC-CHG-TYP-CDE = PV-HOLD-PRIC-CHG-TYP-CDE  12430000
122100               IF WKMUMD-RSN-CDE = PV-HOLD-RSN-CDE                12440000
122200                   CONTINUE                                       12450000
122300               ELSE                                               12460000
122400                   PERFORM C200-PRINT-DETAIL                      12470000
122500                   MOVE WKMUMD-RSN-CDE                            12480000
122600                                   TO PV-HOLD-RSN-CDE             12490000
122700               END-IF                                             12500000
122800           ELSE                                                   12510000
122900               PERFORM C200-PRINT-DETAIL                          12520000
123000               PERFORM D300-PRINT-ORGN-TYPE-TOT-LINE              12530000
123100               MOVE WKMUMD-PRIC-CHG-TYP-CDE                       12540000
123200                                   TO PV-HOLD-PRIC-CHG-TYP-CDE    12550000
123300               MOVE WKMUMD-RSN-CDE                                12560000
123400                                   TO PV-HOLD-RSN-CDE             12570000
123500               PERFORM E100-PRINT-ORGN-TYP-LINE                   12580000
123600               PERFORM D200-DETERMINE-ORGN-TYP-SUM                12590000
123700           END-IF                                                 12600000
123800        ELSE                                                      12610000
123900            PERFORM C200-PRINT-DETAIL                             12620000
124000            PERFORM D300-PRINT-ORGN-TYPE-TOT-LINE                 12630000
124100            PERFORM D400-PRINT-ORGN-TOT-LINE                      12640000
124200            MOVE WKMUMD-ORGN-CDE   TO PV-HOLD-ORGN-CDE            12650000
124300            MOVE WKMUMD-PRIC-CHG-TYP-CDE                          12660000
124400                                   TO PV-HOLD-PRIC-CHG-TYP-CDE    12670000
124500            MOVE WKMUMD-RSN-CDE    TO PV-HOLD-RSN-CDE             12680000
124600            PERFORM E100-PRINT-ORGN-TYP-LINE                      12690000
124700            PERFORM D200-DETERMINE-ORGN-TYP-SUM                   12700000
124800        END-IF                                                    12710000
124900     ELSE                                                         12720000
125000         PERFORM C200-PRINT-DETAIL                                12730000
125100         PERFORM D300-PRINT-ORGN-TYPE-TOT-LINE                    12740000
125200         PERFORM D400-PRINT-ORGN-TOT-LINE                         12750000
125300         PERFORM D500-PRINT-DEPT-TOT-LINE                         12760000
125400         PERFORM C400-GET-DEPT-INFORMATION                        12770000
125500         MOVE WKMUMD-DEPT-NBR      TO PV-HOLD-DEPT-NBR            12780000
125600         MOVE WKMUMD-ORGN-CDE      TO PV-HOLD-ORGN-CDE            12790000
125700         MOVE WKMUMD-PRIC-CHG-TYP-CDE                             12800000
125800                                   TO PV-HOLD-PRIC-CHG-TYP-CDE    12810000
125900         MOVE WKMUMD-RSN-CDE       TO PV-HOLD-RSN-CDE             12820000
126000         PERFORM D100-PROCESS-PAGE-BREAK                          12830000
126100         PERFORM E100-PRINT-ORGN-TYP-LINE                         12840000
126200         PERFORM D200-DETERMINE-ORGN-TYP-SUM                      12850000
126300     END-IF.                                                      12860000
126400                                                                  12870000
126500     IF CR-VALID-SEASON                                           12880000
126600         PERFORM B210-POPULATE-AMTS-FOR-SEASON                    12890000
126700     ELSE                                                         12900000
126800         PERFORM B220-POPULATE-AMTS-FOR-WEEK                      12910000
126900     END-IF.                                                      12920000
127000     ADD PV-TOT-MU-MD-AMT-CSR      TO PV-SUM-BY-RSN-CDE-TOTAL.    12930000
127100                                                                  12940000
127200     IF CR-VALID-SEASON                                           12950000
127300         PERFORM C150-FETCH-SEASON-CSR                            12960000
127400     ELSE                                                         12970000
127500         PERFORM C250-FETCH-WEEKLY-CSR                            12980000
127600     END-IF.                                                      12990000
127700                                                                  13000000
127800******************************************************************13010000
127900*     B210-POPULATE-AMTS-FOR-SEASON                              *13020000
128000* ==> PROCESSES:                                                 *13030000
128100* ==> PERFORMED FROM:  B200-PROCESS-REPORT                       *13040000
128200******************************************************************13050000
128300 B210-POPULATE-AMTS-FOR-SEASON.                                   13060000
128400                                                                  13070000
128500     EVALUATE TRUE                                                13080000
128600         WHEN WKMUMD-FSCL-MN = '01' OR '07'                       13090000
128700             MOVE PV-TOT-MU-MD-AMT-CSR                            13100000
128800                                   TO PV-MKDN-MKUP-PERIOD-AMT     13110000
128900             MOVE PV-MKDN-MKUP-PERIOD-AMT                         13120000
129000                                   TO RPT-MKDN-MKUP-PERIOD-1-AMT  13130000
129100             IF PV-SUM-BY-ORGN-TYP (1) = ZERO                     13140000
129200                 MOVE ZERO         TO PV-PERCENT                  13150000
129300                 MOVE PV-PERCENTAGE                               13160000
129400                                   TO RPT-MKDN-MKUP-PERIOD-1-PCT  13170000
129500             ELSE                                                 13180000
129600                 COMPUTE PV-PERCENT-OF-TOT-WEEK =                 13190000
129700                  (PV-TOT-MU-MD-AMT-CSR / PV-SUM-BY-ORGN-TYP (1)) 13200000
129800                    * 100                                         13210000
129900                 MULTIPLY PV-PERCENT-OF-TOT-WEEK BY 1             13220000
130000                     GIVING PV-ROUNDED-PERCENT ROUNDED            13230000
130100                 MOVE PV-ROUNDED-PERCENT   TO PV-PERCENT          13240000
130200                 MOVE PV-PERCENTAGE                               13250000
130300                                   TO RPT-MKDN-MKUP-PERIOD-1-PCT  13260000
130400             END-IF                                               13270000
130500         WHEN WKMUMD-FSCL-MN = '02' OR '08'                       13280000
130600             MOVE PV-TOT-MU-MD-AMT-CSR                            13290000
130700                                   TO PV-MKDN-MKUP-PERIOD-AMT     13300000
130800             MOVE PV-MKDN-MKUP-PERIOD-AMT                         13310000
130900                                   TO RPT-MKDN-MKUP-PERIOD-2-AMT  13320000
131000             IF PV-SUM-BY-ORGN-TYP (2) = ZERO                     13330000
131100                 MOVE ZERO         TO PV-PERCENT                  13340000
131200                 MOVE PV-PERCENTAGE                               13350000
131300                                   TO RPT-MKDN-MKUP-PERIOD-2-PCT  13360000
131400             ELSE                                                 13370000
131500                 COMPUTE PV-PERCENT-OF-TOT-WEEK =                 13380000
131600                  (PV-TOT-MU-MD-AMT-CSR / PV-SUM-BY-ORGN-TYP (2)) 13390000
131700                    * 100                                         13400000
131800                 MULTIPLY PV-PERCENT-OF-TOT-WEEK BY 1             13410000
131900                     GIVING PV-ROUNDED-PERCENT ROUNDED            13420000
132000                 MOVE PV-ROUNDED-PERCENT   TO PV-PERCENT          13430000
132100                 MOVE PV-PERCENTAGE                               13440000
132200                                   TO RPT-MKDN-MKUP-PERIOD-2-PCT  13450000
132300             END-IF                                               13460000
132400             IF RPT-MKDN-MKUP-PERIOD-1-AMT = SPACES               13470000
132500                 MOVE ZERO         TO PV-MKDN-MKUP-PERIOD-AMT     13480000
132600                 MOVE PV-MKDN-MKUP-PERIOD-AMT                     13490000
132700                                   TO RPT-MKDN-MKUP-PERIOD-1-AMT  13500000
132800                 MOVE ZERO         TO PV-PERCENT                  13510000
132900                 MOVE PV-PERCENTAGE                               13520000
133000                                   TO RPT-MKDN-MKUP-PERIOD-1-PCT  13530000
133100             END-IF                                               13540000
133200         WHEN WKMUMD-FSCL-MN = '03' OR '09'                       13550000
133300             MOVE PV-TOT-MU-MD-AMT-CSR                            13560000
133400                                   TO PV-MKDN-MKUP-PERIOD-AMT     13570000
133500             MOVE PV-MKDN-MKUP-PERIOD-AMT                         13580000
133600                                   TO RPT-MKDN-MKUP-PERIOD-3-AMT  13590000
133700             IF PV-SUM-BY-ORGN-TYP (3) = ZERO                     13600000
133800                 MOVE ZERO         TO PV-PERCENT                  13610000
133900                 MOVE PV-PERCENTAGE                               13620000
134000                                   TO RPT-MKDN-MKUP-PERIOD-3-PCT  13630000
134100             ELSE                                                 13640000
134200                 COMPUTE PV-PERCENT-OF-TOT-WEEK =                 13650000
134300                  (PV-TOT-MU-MD-AMT-CSR / PV-SUM-BY-ORGN-TYP (3)) 13660000
134400                    * 100                                         13670000
134500                 MULTIPLY PV-PERCENT-OF-TOT-WEEK BY 1             13680000
134600                     GIVING PV-ROUNDED-PERCENT ROUNDED            13690000
134700                 MOVE PV-ROUNDED-PERCENT   TO PV-PERCENT          13700000
134800                 MOVE PV-PERCENTAGE                               13710000
134900                                   TO RPT-MKDN-MKUP-PERIOD-3-PCT  13720000
135000             END-IF                                               13730000
135100             IF RPT-MKDN-MKUP-PERIOD-2-AMT = SPACES               13740000
135200                 MOVE ZERO         TO PV-MKDN-MKUP-PERIOD-AMT     13750000
135300                 MOVE PV-MKDN-MKUP-PERIOD-AMT                     13760000
135400                                   TO RPT-MKDN-MKUP-PERIOD-2-AMT  13770000
135500                 MOVE ZERO         TO PV-PERCENT                  13780000
135600                 MOVE PV-PERCENTAGE                               13790000
135700                                   TO RPT-MKDN-MKUP-PERIOD-2-PCT  13800000
135800             END-IF                                               13810000
135900         WHEN WKMUMD-FSCL-MN = '04' OR '10'                       13820000
136000             MOVE PV-TOT-MU-MD-AMT-CSR                            13830000
136100                                   TO PV-MKDN-MKUP-PERIOD-AMT     13840000
136200             MOVE PV-MKDN-MKUP-PERIOD-AMT                         13850000
136300                                   TO RPT-MKDN-MKUP-PERIOD-4-AMT  13860000
136400             IF PV-SUM-BY-ORGN-TYP (4) = ZERO                     13870000
136500                 MOVE ZERO         TO PV-PERCENT                  13880000
136600                 MOVE PV-PERCENTAGE                               13890000
136700                                   TO RPT-MKDN-MKUP-PERIOD-4-PCT  13900000
136800             ELSE                                                 13910000
136900                 COMPUTE PV-PERCENT-OF-TOT-WEEK =                 13920000
137000                  (PV-TOT-MU-MD-AMT-CSR / PV-SUM-BY-ORGN-TYP (4)) 13930000
137100                    * 100                                         13940000
137200                 MULTIPLY PV-PERCENT-OF-TOT-WEEK BY 1             13950000
137300                     GIVING PV-ROUNDED-PERCENT ROUNDED            13960000
137400                 MOVE PV-ROUNDED-PERCENT   TO PV-PERCENT          13970000
137500                 MOVE PV-PERCENTAGE                               13980000
137600                                   TO RPT-MKDN-MKUP-PERIOD-4-PCT  13990000
137700             END-IF                                               14000000
137800             IF RPT-MKDN-MKUP-PERIOD-3-AMT = SPACES               14010000
137900                 MOVE ZERO         TO PV-MKDN-MKUP-PERIOD-AMT     14020000
138000                 MOVE PV-MKDN-MKUP-PERIOD-AMT                     14030000
138100                                   TO RPT-MKDN-MKUP-PERIOD-3-AMT  14040000
138200                 MOVE ZERO         TO PV-PERCENT                  14050000
138300                 MOVE PV-PERCENTAGE                               14060000
138400                                   TO RPT-MKDN-MKUP-PERIOD-3-PCT  14070000
138500             END-IF                                               14080000
138600         WHEN WKMUMD-FSCL-MN = '05' OR '11'                       14090000
138700             MOVE PV-TOT-MU-MD-AMT-CSR                            14100000
138800                                   TO PV-MKDN-MKUP-PERIOD-AMT     14110000
138900             MOVE PV-MKDN-MKUP-PERIOD-AMT                         14120000
139000                                   TO RPT-MKDN-MKUP-PERIOD-5-AMT  14130000
139100             IF PV-SUM-BY-ORGN-TYP (5) = ZERO                     14140000
139200                 MOVE ZERO         TO PV-PERCENT                  14150000
139300                 MOVE PV-PERCENTAGE                               14160000
139400                                   TO RPT-MKDN-MKUP-PERIOD-5-PCT  14170000
139500             ELSE                                                 14180000
139600                 COMPUTE PV-PERCENT-OF-TOT-WEEK =                 14190000
139700                  (PV-TOT-MU-MD-AMT-CSR / PV-SUM-BY-ORGN-TYP (5)) 14200000
139800                    * 100                                         14210000
139900                 MULTIPLY PV-PERCENT-OF-TOT-WEEK BY 1             14220000
140000                     GIVING PV-ROUNDED-PERCENT ROUNDED            14230000
140100                 MOVE PV-ROUNDED-PERCENT   TO PV-PERCENT          14240000
140200                 MOVE PV-PERCENTAGE                               14250000
140300                                   TO RPT-MKDN-MKUP-PERIOD-5-PCT  14260000
140400             END-IF                                               14270000
140500             IF RPT-MKDN-MKUP-PERIOD-4-AMT = SPACES               14280000
140600                 MOVE ZERO         TO PV-MKDN-MKUP-PERIOD-AMT     14290000
140700                 MOVE PV-MKDN-MKUP-PERIOD-AMT                     14300000
140800                                   TO RPT-MKDN-MKUP-PERIOD-4-AMT  14310000
140900                 MOVE ZERO         TO PV-PERCENT                  14320000
141000                 MOVE PV-PERCENTAGE                               14330000
141100                                   TO RPT-MKDN-MKUP-PERIOD-4-PCT  14340000
141200             END-IF                                               14350000
141300         WHEN WKMUMD-FSCL-MN = '06' OR '12'                       14360000
141400             MOVE PV-TOT-MU-MD-AMT-CSR                            14370000
141500                                   TO PV-MKDN-MKUP-PERIOD-AMT     14380000
141600             MOVE PV-MKDN-MKUP-PERIOD-AMT                         14390000
141700                                   TO RPT-MKDN-MKUP-PERIOD-6-AMT  14400000
141800             IF PV-SUM-BY-ORGN-TYP (6) = ZERO                     14410000
141900                 MOVE ZERO         TO PV-PERCENT                  14420000
142000                 MOVE PV-PERCENTAGE                               14430000
142100                                   TO RPT-MKDN-MKUP-PERIOD-6-PCT  14440000
142200             ELSE                                                 14450000
142300                 COMPUTE PV-PERCENT-OF-TOT-WEEK =                 14460000
142400                  (PV-TOT-MU-MD-AMT-CSR / PV-SUM-BY-ORGN-TYP (6)) 14470000
142500                    * 100                                         14480000
142600                 MULTIPLY PV-PERCENT-OF-TOT-WEEK BY 1             14490000
142700                     GIVING PV-ROUNDED-PERCENT ROUNDED            14500000
142800                 MOVE PV-ROUNDED-PERCENT   TO PV-PERCENT          14510000
142900                 MOVE PV-PERCENTAGE                               14520000
143000                                   TO RPT-MKDN-MKUP-PERIOD-6-PCT  14530000
143100             END-IF                                               14540000
143200             IF RPT-MKDN-MKUP-PERIOD-5-AMT = SPACES               14550000
143300                 MOVE ZERO         TO PV-MKDN-MKUP-PERIOD-AMT     14560000
143400                 MOVE PV-MKDN-MKUP-PERIOD-AMT                     14570000
143500                                   TO RPT-MKDN-MKUP-PERIOD-5-AMT  14580000
143600                 MOVE ZERO         TO PV-PERCENT                  14590000
143700                 MOVE PV-PERCENTAGE                               14600000
143800                                   TO RPT-MKDN-MKUP-PERIOD-5-PCT  14610000
143900             END-IF                                               14620000
144000     END-EVALUATE.                                                14630000
144100                                                                  14640000
144200******************************************************************14650000
144300*     B220-POPULATE-AMTS-FOR-WEEK                                *14660000
144400* ==> PROCESSES:                                                 *14670000
144500* ==> PERFORMED FROM:  B200-PROCESS-REPORT                       *14680000
144600******************************************************************14690000
144700 B220-POPULATE-AMTS-FOR-WEEK.                                     14700000
144800                                                                  14710000
144900     EVALUATE WKMUMD-FSCL-WK                                      14720000
145000         WHEN '01'                                                14730000
145100             MOVE PV-TOT-MU-MD-AMT-CSR                            14740000
145200                                   TO PV-MKDN-MKUP-PERIOD-AMT     14750000
145300             MOVE PV-MKDN-MKUP-PERIOD-AMT                         14760000
145400                                   TO RPT-MKDN-MKUP-PERIOD-1-AMT  14770000
145500             IF PV-SUM-BY-ORGN-TYP (1) = ZERO                     14780000
145600                 MOVE ZERO         TO PV-PERCENT                  14790000
145700                 MOVE PV-PERCENTAGE                               14800000
145800                                   TO RPT-MKDN-MKUP-PERIOD-1-PCT  14810000
145900             ELSE                                                 14820000
146000                 COMPUTE PV-PERCENT-OF-TOT-WEEK =                 14830000
146100                  (PV-TOT-MU-MD-AMT-CSR / PV-SUM-BY-ORGN-TYP (1)) 14840000
146200                    * 100                                         14850000
146300                 MULTIPLY PV-PERCENT-OF-TOT-WEEK BY 1             14860000
146400                     GIVING PV-ROUNDED-PERCENT ROUNDED            14870000
146500                 MOVE PV-ROUNDED-PERCENT   TO PV-PERCENT          14880000
146600                 MOVE PV-PERCENTAGE                               14890000
146700                                   TO RPT-MKDN-MKUP-PERIOD-1-PCT  14900000
146800             END-IF                                               14910000
146900         WHEN '02'                                                14920000
147000             MOVE PV-TOT-MU-MD-AMT-CSR                            14930000
147100                                   TO PV-MKDN-MKUP-PERIOD-AMT     14940000
147200             MOVE PV-MKDN-MKUP-PERIOD-AMT                         14950000
147300                                   TO RPT-MKDN-MKUP-PERIOD-2-AMT  14960000
147400             IF PV-SUM-BY-ORGN-TYP (2) = ZERO                     14970000
147500                 MOVE ZERO         TO PV-PERCENT                  14980000
147600                 MOVE PV-PERCENTAGE                               14990000
147700                                   TO RPT-MKDN-MKUP-PERIOD-2-PCT  15000000
147800             ELSE                                                 15010000
147900                 COMPUTE PV-PERCENT-OF-TOT-WEEK =                 15020000
148000                  (PV-TOT-MU-MD-AMT-CSR / PV-SUM-BY-ORGN-TYP (2)) 15030000
148100                    * 100                                         15040000
148200                 MULTIPLY PV-PERCENT-OF-TOT-WEEK BY 1             15050000
148300                     GIVING PV-ROUNDED-PERCENT ROUNDED            15060000
148400                 MOVE PV-ROUNDED-PERCENT   TO PV-PERCENT          15070000
148500                 MOVE PV-PERCENTAGE                               15080000
148600                                   TO RPT-MKDN-MKUP-PERIOD-2-PCT  15090000
148700             END-IF                                               15100000
148800             IF RPT-MKDN-MKUP-PERIOD-1-AMT = SPACES               15110000
148900                 MOVE ZERO         TO PV-MKDN-MKUP-PERIOD-AMT     15120000
149000                 MOVE PV-MKDN-MKUP-PERIOD-AMT                     15130000
149100                                   TO RPT-MKDN-MKUP-PERIOD-1-AMT  15140000
149200                 MOVE ZERO         TO PV-PERCENT                  15150000
149300                 MOVE PV-PERCENTAGE                               15160000
149400                                   TO RPT-MKDN-MKUP-PERIOD-1-PCT  15170000
149500             END-IF                                               15180000
149600         WHEN '03'                                                15190000
149700             MOVE PV-TOT-MU-MD-AMT-CSR                            15200000
149800                                   TO PV-MKDN-MKUP-PERIOD-AMT     15210000
149900             MOVE PV-MKDN-MKUP-PERIOD-AMT                         15220000
150000                                   TO RPT-MKDN-MKUP-PERIOD-3-AMT  15230000
150100             IF PV-SUM-BY-ORGN-TYP (3) = ZERO                     15240000
150200                 MOVE ZERO         TO PV-PERCENT                  15250000
150300                 MOVE PV-PERCENTAGE                               15260000
150400                                   TO RPT-MKDN-MKUP-PERIOD-3-PCT  15270000
150500             ELSE                                                 15280000
150600                 COMPUTE PV-PERCENT-OF-TOT-WEEK =                 15290000
150700                  (PV-TOT-MU-MD-AMT-CSR / PV-SUM-BY-ORGN-TYP (3)) 15300000
150800                    * 100                                         15310000
150900                 MULTIPLY PV-PERCENT-OF-TOT-WEEK BY 1             15320000
151000                     GIVING PV-ROUNDED-PERCENT ROUNDED            15330000
151100                 MOVE PV-ROUNDED-PERCENT   TO PV-PERCENT          15340000
151200                 MOVE PV-PERCENTAGE                               15350000
151300                                   TO RPT-MKDN-MKUP-PERIOD-3-PCT  15360000
151400             END-IF                                               15370000
151500             IF RPT-MKDN-MKUP-PERIOD-2-AMT = SPACES               15380000
151600                 MOVE ZERO         TO PV-MKDN-MKUP-PERIOD-AMT     15390000
151700                 MOVE PV-MKDN-MKUP-PERIOD-AMT                     15400000
151800                                   TO RPT-MKDN-MKUP-PERIOD-2-AMT  15410000
151900                 MOVE ZERO         TO PV-PERCENT                  15420000
152000                 MOVE PV-PERCENTAGE                               15430000
152100                                   TO RPT-MKDN-MKUP-PERIOD-2-PCT  15440000
152200             END-IF                                               15450000
152300         WHEN '04'                                                15460000
152400             MOVE PV-TOT-MU-MD-AMT-CSR                            15470000
152500                                   TO PV-MKDN-MKUP-PERIOD-AMT     15480000
152600             MOVE PV-MKDN-MKUP-PERIOD-AMT                         15490000
152700                                   TO RPT-MKDN-MKUP-PERIOD-4-AMT  15500000
152800             IF PV-SUM-BY-ORGN-TYP (4) = ZERO                     15510000
152900                 MOVE ZERO         TO PV-PERCENT                  15520000
153000                 MOVE PV-PERCENTAGE                               15530000
153100                                   TO RPT-MKDN-MKUP-PERIOD-4-PCT  15540000
153200             ELSE                                                 15550000
153300                 COMPUTE PV-PERCENT-OF-TOT-WEEK =                 15560000
153400                  (PV-TOT-MU-MD-AMT-CSR / PV-SUM-BY-ORGN-TYP (4)) 15570000
153500                    * 100                                         15580000
153600                 MULTIPLY PV-PERCENT-OF-TOT-WEEK BY 1             15590000
153700                     GIVING PV-ROUNDED-PERCENT ROUNDED            15600000
153800                 MOVE PV-ROUNDED-PERCENT   TO PV-PERCENT          15610000
153900                 MOVE PV-PERCENTAGE                               15620000
154000                                   TO RPT-MKDN-MKUP-PERIOD-4-PCT  15630000
154100             END-IF                                               15640000
154200             IF RPT-MKDN-MKUP-PERIOD-3-AMT = SPACES               15650000
154300                 MOVE ZERO         TO PV-MKDN-MKUP-PERIOD-AMT     15660000
154400                 MOVE PV-MKDN-MKUP-PERIOD-AMT                     15670000
154500                                   TO RPT-MKDN-MKUP-PERIOD-3-AMT  15680000
154600                 MOVE ZERO         TO PV-PERCENT                  15690000
154700                 MOVE PV-PERCENTAGE                               15700000
154800                                   TO RPT-MKDN-MKUP-PERIOD-3-PCT  15710000
154900             END-IF                                               15720000
155000         WHEN '05'                                                15730000
155100             MOVE PV-TOT-MU-MD-AMT-CSR                            15740000
155200                                   TO PV-MKDN-MKUP-PERIOD-AMT     15750000
155300             MOVE PV-MKDN-MKUP-PERIOD-AMT                         15760000
155400                                   TO RPT-MKDN-MKUP-PERIOD-5-AMT  15770000
155500             IF PV-SUM-BY-ORGN-TYP (5) = ZERO                     15780000
155600                 MOVE ZERO         TO PV-PERCENT                  15790000
155700                 MOVE PV-PERCENTAGE                               15800000
155800                                   TO RPT-MKDN-MKUP-PERIOD-5-PCT  15810000
155900             ELSE                                                 15820000
156000                 COMPUTE PV-PERCENT-OF-TOT-WEEK =                 15830000
156100                  (PV-TOT-MU-MD-AMT-CSR / PV-SUM-BY-ORGN-TYP (5)) 15840000
156200                    * 100                                         15850000
156300                 MULTIPLY PV-PERCENT-OF-TOT-WEEK BY 1             15860000
156400                     GIVING PV-ROUNDED-PERCENT ROUNDED            15870000
156500                 MOVE PV-ROUNDED-PERCENT   TO PV-PERCENT          15880000
156600                 MOVE PV-PERCENTAGE                               15890000
156700                                   TO RPT-MKDN-MKUP-PERIOD-5-PCT  15900000
156800             END-IF                                               15910000
156900             IF RPT-MKDN-MKUP-PERIOD-4-AMT = SPACES               15920000
157000                 MOVE ZERO         TO PV-MKDN-MKUP-PERIOD-AMT     15930000
157100                 MOVE PV-MKDN-MKUP-PERIOD-AMT                     15940000
157200                                   TO RPT-MKDN-MKUP-PERIOD-4-AMT  15950000
157300                 MOVE ZERO         TO PV-PERCENT                  15960000
157400                 MOVE PV-PERCENTAGE                               15970000
157500                                   TO RPT-MKDN-MKUP-PERIOD-4-PCT  15980000
157600             END-IF                                               15990000
157700     END-EVALUATE.                                                16000000
157800                                                                  16010000
157900******************************************************************16020000
158000*     B300-DMM-INITIALIZE                                        *16030000
158100* ==> PROCESSES:                                                 *16040000
158200*     -                                                          *16050000
158300* ==> PERFORMED FROM:  A100-MAINLINE                             *16060000
158400******************************************************************16070000
158500 B300-DMM-INITIALIZE.                                             16080000
158600                                                                  16090000
158700     PERFORM B310-OPEN-DMM-CSR.                                   16100000
158800     PERFORM B320-FETCH-DMM-CSR.                                  16110000
158900                                                                  16120000
159000     IF PS-END-OF-DMM-CSR                                         16130000
159100         ADD PC-ONE                TO PA-PAGE-COUNTER             16140000
159200         MOVE PA-PAGE-COUNTER      TO DP200O-PAGE-NUMBER          16150000
159300                                                                  16160000
159400         WRITE REPORT-RECORD                                      16170000
159500             FROM DP200O-STANDRD-HEADER-200-COLS                  16180000
159600             AFTER ADVANCING PAGE                                 16190000
159700                                                                  16200000
159800         INITIALIZE DP200O-LASER-NEW-PAGE-INDICATR                16210000
159900                                                                  16220000
160000         WRITE REPORT-RECORD                                      16230000
160100             FROM REPORT-TITLE-LINE                               16240000
160200             AFTER ADVANCING 1 LINE                               16250000
160300                                                                  16260000
160400         WRITE REPORT-RECORD                                      16270000
160500             FROM REPORT-TITLE-LINE2                              16280000
160600             AFTER ADVANCING 1 LINE                               16290000
160700                                                                  16300000
160800     ELSE                                                         16310000
160900         MOVE MDSEAR-GMA-NBR      TO PV-HOLD-GMA-NBR              16320000
161000         MOVE MDSEAR-DMA-NBR      TO PV-HOLD-DMA-NBR              16330000
161100         MOVE WKMUMD-ORGN-CDE     TO PV-HOLD-ORGN-CDE             16340000
161200         MOVE WKMUMD-PRIC-CHG-TYP-CDE                             16350000
161300                                  TO PV-HOLD-PRIC-CHG-TYP-CDE     16360000
161400         MOVE WKMUMD-RSN-CDE      TO PV-HOLD-RSN-CDE              16370000
161500                                                                  16380000
161600         PERFORM C410-SELECT-GMM-NAME                             16390000
161700         PERFORM C420-SELECT-DMM-NAME                             16400000
161800         MOVE SPACES              TO RPT-HL1-BUYER-LITERAL        16410000
161900                                     RPT-HL1-BUYER-NUMBER         16420000
162000                                     RPT-HL1-BUYER-NAME           16430000
162100                                                                  16440000
162200         PERFORM D100-PROCESS-PAGE-BREAK                          16450000
162300         PERFORM E100-PRINT-ORGN-TYP-LINE                         16460000
162400         MOVE ZEROES              TO PV-SUM-BY-ORGN-TYP-TOTAL     16470000
162500         IF CR-VALID-SEASON                                       16480000
162600             PERFORM E400-GET-DMM-ORGN-TYP-MNTH-SUM               16490000
162700                 VARYING PV-SUB                                   16500000
162800                 FROM 1 BY 1                                      16510000
162900                 UNTIL (PV-SUB > 6)                               16520000
163000                    OR (PV-SUB > PV-CALC-SEASON-MONTH)            16530000
163100         ELSE                                                     16540000
163200             PERFORM E100-GET-DMM-ORGN-TYP-WKLY-SUM               16550000
163300                 VARYING PV-SUB                                   16560000
163400                 FROM 1 BY 1                                      16570000
163500                 UNTIL PV-SUB > PV-FISCAL-PERIOD-WEEK             16580000
163600         END-IF                                                   16590000
163700     END-IF.                                                      16600000
163800                                                                  16610000
163900******************************************************************16620000
164000*     B310-OPEN-DMM-CSR                                          *16630000
164100* ==> PROCESSES:                                                 *16640000
164200*     - OPENS THE DMM CURSOR                                     *16650000
164300* ==> PERFORMED FROM: B100-INITIALIZE                            *16660000
164400******************************************************************16670000
164500 B310-OPEN-DMM-CSR.                                               16680000
164600                                                                  16690000
164800     IF CR-VALID-SEASON                                           16700000
164900         IF CR-CUMULATIVE-SEASON                                  16710000
165000             MOVE PV-FSCL-YEAR     TO WKMUMD-FSCL-YR              16720000
165100         ELSE                                                     16730000
165200             MOVE CR-YEAR          TO WKMUMD-FSCL-YR              16740000
165300         END-IF                                                   16750000
165400     ELSE                                                         16760000
165500         MOVE PV-FSCL-YEAR         TO WKMUMD-FSCL-YR              16770000
165600     END-IF.                                                      16780000
165700     MOVE PV-DPG56-FISCAL-PERIOD-NBR                              16790000
165800                               TO WKMUMD-FSCL-MN.                 16800000
165900     MOVE PV-DPG56-FISCAL-PERIOD-WEEK                             16810000
166000                               TO WKMUMD-FSCL-WK.                 16820000
166200                                                                  16830000
166300     IF CR-VALID-SEASON                                           16840000
166400         EXEC SQL                                                 16850000
166500             OPEN DMM_SEASON_CSR                                  16860000
166600         END-EXEC                                                 16870000
166700     ELSE                                                         16880000
166800         EXEC SQL                                                 16890000
166900             OPEN DMM_CSR                                         16900000
167000         END-EXEC                                                 16910000
167100     END-IF.                                                      16920000
167200                                                                  16930000
167300     EVALUATE TRUE                                                16940000
167400         WHEN SQLCODE = +0                                        16950000
167500             CONTINUE                                             16960000
167600         WHEN OTHER                                               16970000
167700             MOVE 'B310-OPEN-DMM-CSR             '                16980000
167800                               TO PV-PARAGRAPH-NAME               16990000
167900             MOVE 'OPEN DMM CURSOR ON TWKMUMD    '                17000000
168000                               TO PV-DB2-OPERATION-ATTEMPTED      17010000
168100             PERFORM Z900-SQL-ABEND                               17020000
168200     END-EVALUATE.                                                17030000
168300                                                                  17040000
168400******************************************************************17050000
168500*     C320-FETCH-DMM-CSR                                         *17060000
168600* ==> PROCESSES:                                                 *17070000
168700*     - FETCHES A ROW FROM THE WEEKLY CURSOR                     *17080000
168800* ==> PERFORMED FROM: B100-INITIALIZE                            *17090000
168900*                     B200-PROCESS-AD-ITEMS                      *17100000
169000******************************************************************17110000
169100 B320-FETCH-DMM-CSR.                                              17120000
169200                                                                  17130000
169300     IF CR-VALID-SEASON                                           17140000
169400         EXEC SQL                                                 17150000
169500             FETCH  DMM_SEASON_CSR                                17160000
169600              INTO  :MDSEAR-GMA-NBR                               17170000
169700                  , :MDSEAR-DMA-NBR                               17180000
169800                  , :WKMUMD-FSCL-MN                               17190000
169900                  , :WKMUMD-ORGN-CDE                              17200000
170000                  , :WKMUMD-PRIC-CHG-TYP-CDE                      17210000
170100                  , :WKMUMD-RSN-CDE                               17220000
170200                  , :PV-TOT-MU-MD-AMT-CSR                         17230000
170300         END-EXEC                                                 17240000
170400     ELSE                                                         17250000
170500         EXEC SQL                                                 17260000
170600             FETCH  DMM_CSR                                       17270000
170700              INTO  :MDSEAR-GMA-NBR                               17280000
170800                  , :MDSEAR-DMA-NBR                               17290000
170900                  , :WKMUMD-FSCL-WK                               17300000
171000                  , :WKMUMD-ORGN-CDE                              17310000
171100                  , :WKMUMD-PRIC-CHG-TYP-CDE                      17320000
171200                  , :WKMUMD-RSN-CDE                               17330000
171300                  , :PV-TOT-MU-MD-AMT-CSR                         17340000
171400         END-EXEC                                                 17350000
171500     END-IF.                                                      17360000
171600                                                                  17370000
171700     EVALUATE TRUE                                                17380000
171800         WHEN SQLCODE = +0                                        17390000
171900             CONTINUE                                             17400000
172000         WHEN SQLCODE = +100                                      17410000
172100             SET PS-END-OF-DMM-CSR                                17420000
172200                               TO TRUE                            17430000
172300         WHEN OTHER                                               17440000
172400             MOVE 'B320-FETCH-DMM-CSR            '                17450000
172500                               TO PV-PARAGRAPH-NAME               17460000
172600             MOVE 'FETCH DMM CURSOR ON TWKMUMD   '                17470000
172700                               TO PV-DB2-OPERATION-ATTEMPTED      17480000
172800             PERFORM Z900-SQL-ABEND                               17490000
172900     END-EVALUATE.                                                17500000
173000                                                                  17510000
173100******************************************************************17520000
173200*     B330-CLOSE-DMM-CSR                                         *17530000
173300* ==> PROCESSES:                                                 *17540000
173400*     - CLOSES THE DMM CURSOR                                    *17550000
173500* ==> PERFORMED FROM: B100-INITIALIZE                            *17560000
173600******************************************************************17570000
173700 B330-CLOSE-DMM-CSR.                                              17580000
173800                                                                  17590000
173900     IF CR-VALID-SEASON                                           17600000
174000         EXEC SQL                                                 17610000
174100             CLOSE DMM_SEASON_CSR                                 17620000
174200         END-EXEC                                                 17630000
174300     ELSE                                                         17640000
174400         EXEC SQL                                                 17650000
174500             CLOSE DMM_CSR                                        17660000
174600         END-EXEC                                                 17670000
174700     END-IF.                                                      17680000
174800                                                                  17690000
174900     EVALUATE TRUE                                                17700000
175000         WHEN SQLCODE = +0                                        17710000
175100             CONTINUE                                             17720000
175200         WHEN OTHER                                               17730000
175300             MOVE 'B330-CLOSE-DMM-CSR            '                17740000
175400                               TO PV-PARAGRAPH-NAME               17750000
175500             MOVE 'CLOSE DMM CURSOR ON TWKMUMD   '                17760000
175600                               TO PV-DB2-OPERATION-ATTEMPTED      17770000
175700             PERFORM Z900-SQL-ABEND                               17780000
175800     END-EVALUATE.                                                17790000
175900                                                                  17800000
176000******************************************************************17810000
176100*     B400-PROCESS-DMM-SUMMARY                                   *17820000
176200* ==> PROCESSES:                                                 *17830000
176300* ==> PERFORMED FROM:  A100-MAINLINE                             *17840000
176400******************************************************************17850000
176500 B400-PROCESS-DMM-SUMMARY.                                        17860000
176600                                                                  17870000
176700     IF MDSEAR-DMA-NBR = PV-HOLD-DMA-NBR                          17880000
176800        IF WKMUMD-ORGN-CDE = PV-HOLD-ORGN-CDE                     17890000
176900           IF WKMUMD-PRIC-CHG-TYP-CDE = PV-HOLD-PRIC-CHG-TYP-CDE  17900000
177000               IF WKMUMD-RSN-CDE = PV-HOLD-RSN-CDE                17910000
177100                   CONTINUE                                       17920000
177200               ELSE                                               17930000
177300                   PERFORM C200-PRINT-DETAIL                      17940000
177400                   MOVE WKMUMD-RSN-CDE                            17950000
177500                                   TO PV-HOLD-RSN-CDE             17960000
177600               END-IF                                             17970000
177700           ELSE                                                   17980000
177800               PERFORM C200-PRINT-DETAIL                          17990000
177900               PERFORM D300-PRINT-ORGN-TYPE-TOT-LINE              18000000
178000               MOVE WKMUMD-PRIC-CHG-TYP-CDE                       18010000
178100                                   TO PV-HOLD-PRIC-CHG-TYP-CDE    18020000
178200               MOVE WKMUMD-RSN-CDE                                18030000
178300                                   TO PV-HOLD-RSN-CDE             18040000
178400               PERFORM E100-PRINT-ORGN-TYP-LINE                   18050000
178500               IF CR-VALID-SEASON                                 18060000
178600                   PERFORM E400-GET-DMM-ORGN-TYP-MNTH-SUM         18070000
178700                       VARYING PV-SUB                             18080000
178800                       FROM 1 BY 1                                18090000
178900                       UNTIL (PV-SUB > 6)                         18100000
179000                          OR (PV-SUB > PV-CALC-SEASON-MONTH)      18110000
179100               ELSE                                               18120000
179200                   PERFORM E100-GET-DMM-ORGN-TYP-WKLY-SUM         18130000
179300                       VARYING PV-SUB                             18140000
179400                       FROM 1 BY 1                                18150000
179500                       UNTIL PV-SUB > PV-FISCAL-PERIOD-WEEK       18160000
179600               END-IF                                             18170000
179700           END-IF                                                 18180000
179800        ELSE                                                      18190000
179900            PERFORM C200-PRINT-DETAIL                             18200000
180000            PERFORM D300-PRINT-ORGN-TYPE-TOT-LINE                 18210000
180100            PERFORM D400-PRINT-ORGN-TOT-LINE                      18220000
180200            MOVE WKMUMD-ORGN-CDE   TO PV-HOLD-ORGN-CDE            18230000
180300            MOVE WKMUMD-PRIC-CHG-TYP-CDE                          18240000
180400                                   TO PV-HOLD-PRIC-CHG-TYP-CDE    18250000
180500            MOVE WKMUMD-RSN-CDE    TO PV-HOLD-RSN-CDE             18260000
180600            PERFORM E100-PRINT-ORGN-TYP-LINE                      18270000
180700            IF CR-VALID-SEASON                                    18280000
180800                PERFORM E400-GET-DMM-ORGN-TYP-MNTH-SUM            18290000
180900                    VARYING PV-SUB                                18300000
181000                    FROM 1 BY 1                                   18310000
181100                    UNTIL (PV-SUB > 6)                            18320000
181200                       OR (PV-SUB > PV-CALC-SEASON-MONTH)         18330000
181300            ELSE                                                  18340000
181400                PERFORM E100-GET-DMM-ORGN-TYP-WKLY-SUM            18350000
181500                    VARYING PV-SUB                                18360000
181600                    FROM 1 BY 1                                   18370000
181700                    UNTIL PV-SUB > PV-FISCAL-PERIOD-WEEK          18380000
181800            END-IF                                                18390000
181900        END-IF                                                    18400000
182000     ELSE                                                         18410000
182100         PERFORM C200-PRINT-DETAIL                                18420000
182200         PERFORM D300-PRINT-ORGN-TYPE-TOT-LINE                    18430000
182300         PERFORM D400-PRINT-ORGN-TOT-LINE                         18440000
182400         PERFORM D600-PRINT-DMM-TOT-LINE                          18450000
182500         PERFORM C410-SELECT-GMM-NAME                             18460000
182600         PERFORM C420-SELECT-DMM-NAME                             18470000
182700         MOVE MDSEAR-GMA-NBR       TO PV-HOLD-GMA-NBR             18480000
182800         MOVE MDSEAR-DMA-NBR       TO PV-HOLD-DMA-NBR             18490000
182900         MOVE WKMUMD-DEPT-NBR      TO PV-HOLD-DEPT-NBR            18500000
183000         MOVE WKMUMD-ORGN-CDE      TO PV-HOLD-ORGN-CDE            18510000
183100         MOVE WKMUMD-PRIC-CHG-TYP-CDE                             18520000
183200                                   TO PV-HOLD-PRIC-CHG-TYP-CDE    18530000
183300         MOVE WKMUMD-RSN-CDE       TO PV-HOLD-RSN-CDE             18540000
183400         PERFORM D100-PROCESS-PAGE-BREAK                          18550000
183500         PERFORM E100-PRINT-ORGN-TYP-LINE                         18560000
183600         IF CR-VALID-SEASON                                       18570000
183700             PERFORM E400-GET-DMM-ORGN-TYP-MNTH-SUM               18580000
183800                 VARYING PV-SUB                                   18590000
183900                 FROM 1 BY 1                                      18600000
184000                 UNTIL (PV-SUB > 6)                               18610000
184100                    OR (PV-SUB > PV-CALC-SEASON-MONTH)            18620000
184200         ELSE                                                     18630000
184300             PERFORM E100-GET-DMM-ORGN-TYP-WKLY-SUM               18640000
184400                 VARYING PV-SUB                                   18650000
184500                 FROM 1 BY 1                                      18660000
184600                 UNTIL PV-SUB > PV-FISCAL-PERIOD-WEEK             18670000
184700         END-IF                                                   18680000
184800     END-IF.                                                      18690000
184900                                                                  18700000
185000     IF CR-VALID-SEASON                                           18710000
185100         PERFORM B210-POPULATE-AMTS-FOR-SEASON                    18720000
185200     ELSE                                                         18730000
185300         PERFORM B220-POPULATE-AMTS-FOR-WEEK                      18740000
185400     END-IF.                                                      18750000
185500     ADD PV-TOT-MU-MD-AMT-CSR      TO PV-SUM-BY-RSN-CDE-TOTAL.    18760000
185600                                                                  18770000
185700     PERFORM B320-FETCH-DMM-CSR.                                  18780000
185800                                                                  18790000
185900******************************************************************18800000
186000*     B500-GMM-INITIALIZE                                        *18810000
186100* ==> PROCESSES:                                                 *18820000
186200*     -                                                          *18830000
186300* ==> PERFORMED FROM:  A100-MAINLINE                             *18840000
186400******************************************************************18850000
186500 B500-GMM-INITIALIZE.                                             18860000
186600                                                                  18870000
186700     PERFORM B510-OPEN-GMM-CSR.                                   18880000
186800     PERFORM B520-FETCH-GMM-CSR.                                  18890000
186900                                                                  18900000
187000     IF PS-END-OF-GMM-CSR                                         18910000
187100         ADD PC-ONE                TO PA-PAGE-COUNTER             18920000
187200         MOVE PA-PAGE-COUNTER      TO DP200O-PAGE-NUMBER          18930000
187300                                                                  18940000
187400         WRITE REPORT-RECORD                                      18950000
187500             FROM DP200O-STANDRD-HEADER-200-COLS                  18960000
187600             AFTER ADVANCING PAGE                                 18970000
187700                                                                  18980000
187800         INITIALIZE DP200O-LASER-NEW-PAGE-INDICATR                18990000
187900                                                                  19000000
188000         WRITE REPORT-RECORD                                      19010000
188100             FROM REPORT-TITLE-LINE                               19020000
188200             AFTER ADVANCING 1 LINE                               19030000
188300                                                                  19040000
188400         WRITE REPORT-RECORD                                      19050000
188500             FROM REPORT-TITLE-LINE2                              19060000
188600             AFTER ADVANCING 1 LINE                               19070000
188700                                                                  19080000
188800     ELSE                                                         19090000
188900         MOVE MDSEAR-GMA-NBR      TO PV-HOLD-GMA-NBR              19100000
189000         MOVE WKMUMD-ORGN-CDE     TO PV-HOLD-ORGN-CDE             19110000
189100         MOVE WKMUMD-PRIC-CHG-TYP-CDE                             19120000
189200                                  TO PV-HOLD-PRIC-CHG-TYP-CDE     19130000
189300         MOVE WKMUMD-RSN-CDE      TO PV-HOLD-RSN-CDE              19140000
189400                                                                  19150000
189500         PERFORM C410-SELECT-GMM-NAME                             19160000
189600         MOVE SPACES              TO RPT-HL1-DMM-LITERAL          19170000
189700                                     RPT-HL1-DMM-NUMBER           19180000
189800                                     RPT-HL1-DMM-NAME             19190000
189900                                     RPT-HL1-BUYER-LITERAL        19200000
190000                                     RPT-HL1-BUYER-NUMBER         19210000
190100                                     RPT-HL1-BUYER-NAME           19220000
190200                                                                  19230000
190300         PERFORM D100-PROCESS-PAGE-BREAK                          19240000
190400         PERFORM E100-PRINT-ORGN-TYP-LINE                         19250000
190500         MOVE ZEROES              TO PV-SUM-BY-ORGN-TYP-TOTAL     19260000
190600         IF CR-VALID-SEASON                                       19270000
190700             PERFORM E500-GET-GMM-ORGN-TYP-MNTH-SUM               19280000
190800                 VARYING PV-SUB                                   19290000
190900                 FROM 1 BY 1                                      19300000
191000                 UNTIL (PV-SUB > 6)                               19310000
191100                    OR (PV-SUB > PV-CALC-SEASON-MONTH)            19320000
191200         ELSE                                                     19330000
191300             PERFORM E200-GET-GMM-ORGN-TYP-WKLY-SUM               19340000
191400                 VARYING PV-SUB                                   19350000
191500                 FROM 1 BY 1                                      19360000
191600                 UNTIL PV-SUB > PV-FISCAL-PERIOD-WEEK             19370000
191700         END-IF                                                   19380000
191800     END-IF.                                                      19390000
191900                                                                  19400000
192000******************************************************************19410000
192100*     B510-OPEN-GMM-CSR                                          *19420000
192200* ==> PROCESSES:                                                 *19430000
192300*     - OPENS THE GMM CURSOR                                     *19440000
192400* ==> PERFORMED FROM: B100-INITIALIZE                            *19450000
192500******************************************************************19460000
192600 B510-OPEN-GMM-CSR.                                               19470000
192700                                                                  19480000
192800     IF CR-VALID-SEASON                                           19490000
192900         IF CR-CUMULATIVE-SEASON                                  19500000
193000             MOVE PV-FSCL-YEAR TO WKMUMD-FSCL-YR                  19510000
193100         ELSE                                                     19520000
193200             MOVE CR-YEAR      TO WKMUMD-FSCL-YR                  19530000
193300         END-IF                                                   19540000
193400     ELSE                                                         19550000
193500         MOVE PV-FSCL-YEAR     TO WKMUMD-FSCL-YR                  19560000
193600     END-IF.                                                      19570000
192700                                                                  19580000
193700     MOVE PV-DPG56-FISCAL-PERIOD-NBR                              19590000
193800                               TO WKMUMD-FSCL-MN.                 19600000
193900     MOVE PV-DPG56-FISCAL-PERIOD-WEEK                             19610000
194000                               TO WKMUMD-FSCL-WK.                 19620000
194100                                                                  19630000
194200     IF CR-VALID-SEASON                                           19640000
194300         EXEC SQL                                                 19650000
194400             OPEN GMM_SEASON_CSR                                  19660000
194500         END-EXEC                                                 19670000
194600     ELSE                                                         19680000
194700         EXEC SQL                                                 19690000
194800             OPEN GMM_CSR                                         19700000
194900         END-EXEC                                                 19710000
195000     END-IF.                                                      19720000
195100                                                                  19730000
195200     EVALUATE TRUE                                                19740000
195300         WHEN SQLCODE = +0                                        19750000
195400             CONTINUE                                             19760000
195500         WHEN OTHER                                               19770000
195600             MOVE 'B510-OPEN-GMM-CSR             '                19780000
195700                               TO PV-PARAGRAPH-NAME               19790000
195800             MOVE 'OPEN GMM CURSOR ON TWKMUMD    '                19800000
195900                               TO PV-DB2-OPERATION-ATTEMPTED      19810000
196000             PERFORM Z900-SQL-ABEND                               19820000
196100     END-EVALUATE.                                                19830000
196200                                                                  19840000
196300******************************************************************19850000
196400*     C520-FETCH-GMM-CSR                                         *19860000
196500* ==> PROCESSES:                                                 *19870000
196600*     - FETCHES A ROW FROM THE WEEKLY CURSOR                     *19880000
196700* ==> PERFORMED FROM: B100-INITIALIZE                            *19890000
196800*                     B200-PROCESS-AD-ITEMS                      *19900000
196900******************************************************************19910000
197000 B520-FETCH-GMM-CSR.                                              19920000
197100                                                                  19930000
197200     IF CR-VALID-SEASON                                           19940000
197300         EXEC SQL                                                 19950000
197400             FETCH  GMM_SEASON_CSR                                19960000
197500              INTO  :MDSEAR-GMA-NBR                               19970000
197600                  , :WKMUMD-FSCL-MN                               19980000
197700                  , :WKMUMD-ORGN-CDE                              19990000
197800                  , :WKMUMD-PRIC-CHG-TYP-CDE                      20000000
197900                  , :WKMUMD-RSN-CDE                               20010000
198000                  , :PV-TOT-MU-MD-AMT-CSR                         20020000
198100         END-EXEC                                                 20030000
198200     ELSE                                                         20040000
198300         EXEC SQL                                                 20050000
198400             FETCH  GMM_CSR                                       20060000
198500              INTO  :MDSEAR-GMA-NBR                               20070000
198600                  , :WKMUMD-FSCL-WK                               20080000
198700                  , :WKMUMD-ORGN-CDE                              20090000
198800                  , :WKMUMD-PRIC-CHG-TYP-CDE                      20100000
198900                  , :WKMUMD-RSN-CDE                               20110000
199000                  , :PV-TOT-MU-MD-AMT-CSR                         20120000
199100         END-EXEC                                                 20130000
199200     END-IF.                                                      20140000
199300                                                                  20150000
199400     EVALUATE TRUE                                                20160000
199500         WHEN SQLCODE = +0                                        20170000
199600             CONTINUE                                             20180000
199700         WHEN SQLCODE = +100                                      20190000
199800             SET PS-END-OF-GMM-CSR                                20200000
199900                               TO TRUE                            20210000
200000         WHEN OTHER                                               20220000
200100             MOVE 'B520-FETCH-GMM-CSR            '                20230000
200200                               TO PV-PARAGRAPH-NAME               20240000
200300             MOVE 'FETCH GMM CURSOR ON TWKMUMD   '                20250000
200400                               TO PV-DB2-OPERATION-ATTEMPTED      20260000
200500             PERFORM Z900-SQL-ABEND                               20270000
200600     END-EVALUATE.                                                20280000
200700                                                                  20290000
200800******************************************************************20300000
200900*     B530-CLOSE-GMM-CSR                                         *20310000
201000* ==> PROCESSES:                                                 *20320000
201100*     - CLOSES THE GMM CURSOR                                    *20330000
201200* ==> PERFORMED FROM: B100-INITIALIZE                            *20340000
201300******************************************************************20350000
201400 B530-CLOSE-GMM-CSR.                                              20360000
201500                                                                  20370000
201600     IF CR-VALID-SEASON                                           20380000
201700         EXEC SQL                                                 20390000
201800             CLOSE GMM_SEASON_CSR                                 20400000
201900         END-EXEC                                                 20410000
202000     ELSE                                                         20420000
202100         EXEC SQL                                                 20430000
202200             CLOSE GMM_CSR                                        20440000
202300         END-EXEC                                                 20450000
202400     END-IF.                                                      20460000
202500                                                                  20470000
202600     EVALUATE TRUE                                                20480000
202700         WHEN SQLCODE = +0                                        20490000
202800             CONTINUE                                             20500000
202900         WHEN OTHER                                               20510000
203000             MOVE 'B530-CLOSE-GMM-CSR            '                20520000
203100                               TO PV-PARAGRAPH-NAME               20530000
203200             MOVE 'CLOSE GMM CURSOR ON TWKMUMD   '                20540000
203300                               TO PV-DB2-OPERATION-ATTEMPTED      20550000
203400             PERFORM Z900-SQL-ABEND                               20560000
203500     END-EVALUATE.                                                20570000
203600                                                                  20580000
203700******************************************************************20590000
203800*     B600-PROCESS-GMM-SUMMARY                                   *20600000
203900* ==> PROCESSES:                                                 *20610000
204000* ==> PERFORMED FROM:  A100-MAINLINE                             *20620000
204100******************************************************************20630000
204200 B600-PROCESS-GMM-SUMMARY.                                        20640000
204300                                                                  20650000
204400     IF MDSEAR-GMA-NBR = PV-HOLD-GMA-NBR                          20660000
204500        IF WKMUMD-ORGN-CDE = PV-HOLD-ORGN-CDE                     20670000
204600           IF WKMUMD-PRIC-CHG-TYP-CDE = PV-HOLD-PRIC-CHG-TYP-CDE  20680000
204700               IF WKMUMD-RSN-CDE = PV-HOLD-RSN-CDE                20690000
204800                   CONTINUE                                       20700000
204900               ELSE                                               20710000
205000                   PERFORM C200-PRINT-DETAIL                      20720000
205100                   MOVE WKMUMD-RSN-CDE                            20730000
205200                                   TO PV-HOLD-RSN-CDE             20740000
205300               END-IF                                             20750000
205400           ELSE                                                   20760000
205500               PERFORM C200-PRINT-DETAIL                          20770000
205600               PERFORM D300-PRINT-ORGN-TYPE-TOT-LINE              20780000
205700               MOVE WKMUMD-PRIC-CHG-TYP-CDE                       20790000
205800                                   TO PV-HOLD-PRIC-CHG-TYP-CDE    20800000
205900               MOVE WKMUMD-RSN-CDE                                20810000
206000                                   TO PV-HOLD-RSN-CDE             20820000
206100               PERFORM E100-PRINT-ORGN-TYP-LINE                   20830000
206200               IF CR-VALID-SEASON                                 20840000
206300                   PERFORM E500-GET-GMM-ORGN-TYP-MNTH-SUM         20850000
206400                       VARYING PV-SUB                             20860000
206500                       FROM 1 BY 1                                20870000
206600                       UNTIL (PV-SUB > 6)                         20880000
206700                          OR (PV-SUB > PV-CALC-SEASON-MONTH)      20890000
206800               ELSE                                               20900000
206900                   PERFORM E200-GET-GMM-ORGN-TYP-WKLY-SUM         20910000
207000                       VARYING PV-SUB                             20920000
207100                       FROM 1 BY 1                                20930000
207200                       UNTIL PV-SUB > PV-FISCAL-PERIOD-WEEK       20940000
207300               END-IF                                             20950000
207400           END-IF                                                 20960000
207500        ELSE                                                      20970000
207600            PERFORM C200-PRINT-DETAIL                             20980000
207700            PERFORM D300-PRINT-ORGN-TYPE-TOT-LINE                 20990000
207800            PERFORM D400-PRINT-ORGN-TOT-LINE                      21000000
207900            MOVE WKMUMD-ORGN-CDE   TO PV-HOLD-ORGN-CDE            21010000
208000            MOVE WKMUMD-PRIC-CHG-TYP-CDE                          21020000
208100                                   TO PV-HOLD-PRIC-CHG-TYP-CDE    21030000
208200            MOVE WKMUMD-RSN-CDE    TO PV-HOLD-RSN-CDE             21040000
208300            PERFORM E100-PRINT-ORGN-TYP-LINE                      21050000
208400            IF CR-VALID-SEASON                                    21060000
208500                PERFORM E500-GET-GMM-ORGN-TYP-MNTH-SUM            21070000
208600                    VARYING PV-SUB                                21080000
208700                    FROM 1 BY 1                                   21090000
208800                    UNTIL (PV-SUB > 6)                            21100000
208900                       OR (PV-SUB > PV-CALC-SEASON-MONTH)         21110000
209000            ELSE                                                  21120000
209100                PERFORM E200-GET-GMM-ORGN-TYP-WKLY-SUM            21130000
209200                    VARYING PV-SUB                                21140000
209300                    FROM 1 BY 1                                   21150000
209400                    UNTIL PV-SUB > PV-FISCAL-PERIOD-WEEK          21160000
209500            END-IF                                                21170000
209600        END-IF                                                    21180000
209700     ELSE                                                         21190000
209800         PERFORM C200-PRINT-DETAIL                                21200000
209900         PERFORM D300-PRINT-ORGN-TYPE-TOT-LINE                    21210000
210000         PERFORM D400-PRINT-ORGN-TOT-LINE                         21220000
210100         PERFORM D600-PRINT-GMM-TOT-LINE                          21230000
210200         PERFORM C410-SELECT-GMM-NAME                             21240000
210300         MOVE MDSEAR-GMA-NBR       TO PV-HOLD-GMA-NBR             21250000
210400         MOVE WKMUMD-DEPT-NBR      TO PV-HOLD-DEPT-NBR            21260000
210500         MOVE WKMUMD-ORGN-CDE      TO PV-HOLD-ORGN-CDE            21270000
210600         MOVE WKMUMD-PRIC-CHG-TYP-CDE                             21280000
210700                                   TO PV-HOLD-PRIC-CHG-TYP-CDE    21290000
210800         MOVE WKMUMD-RSN-CDE       TO PV-HOLD-RSN-CDE             21300000
210900         PERFORM D100-PROCESS-PAGE-BREAK                          21310000
211000         PERFORM E100-PRINT-ORGN-TYP-LINE                         21320000
211100         IF CR-VALID-SEASON                                       21330000
211200             PERFORM E500-GET-GMM-ORGN-TYP-MNTH-SUM               21340000
211300                 VARYING PV-SUB                                   21350000
211400                 FROM 1 BY 1                                      21360000
211500                 UNTIL (PV-SUB > 6)                               21370000
211600                    OR (PV-SUB > PV-CALC-SEASON-MONTH)            21380000
211700         ELSE                                                     21390000
211800             PERFORM E200-GET-GMM-ORGN-TYP-WKLY-SUM               21400000
211900                 VARYING PV-SUB                                   21410000
212000                 FROM 1 BY 1                                      21420000
212100                 UNTIL PV-SUB > PV-FISCAL-PERIOD-WEEK             21430000
212200         END-IF                                                   21440000
212300     END-IF.                                                      21450000
212400                                                                  21460000
212500     IF CR-VALID-SEASON                                           21470000
212600         PERFORM B210-POPULATE-AMTS-FOR-SEASON                    21480000
212700     ELSE                                                         21490000
212800         PERFORM B220-POPULATE-AMTS-FOR-WEEK                      21500000
212900     END-IF.                                                      21510000
213000     ADD PV-TOT-MU-MD-AMT-CSR      TO PV-SUM-BY-RSN-CDE-TOTAL.    21520000
213100                                                                  21530000
213200     PERFORM B520-FETCH-GMM-CSR.                                  21540000
213300                                                                  21550000
213400******************************************************************21560000
213500*     B700-CORP-INITIALIZE                                       *21570000
213600* ==> PROCESSES:                                                 *21580000
213700*     -                                                          *21590000
213800* ==> PERFORMED FROM:  A100-MAINLINE                             *21600000
213900******************************************************************21610000
214000 B700-CORP-INITIALIZE.                                            21620000
214100                                                                  21630000
214200     PERFORM B710-OPEN-CORP-CSR.                                  21640000
214300     PERFORM B720-FETCH-CORP-CSR.                                 21650000
214400                                                                  21660000
214500     IF PS-END-OF-CORP-CSR                                        21670000
214600         ADD PC-ONE                TO PA-PAGE-COUNTER             21680000
214700         MOVE PA-PAGE-COUNTER      TO DP200O-PAGE-NUMBER          21690000
214800                                                                  21700000
214900         WRITE REPORT-RECORD                                      21710000
215000             FROM DP200O-STANDRD-HEADER-200-COLS                  21720000
215100             AFTER ADVANCING PAGE                                 21730000
215200                                                                  21740000
215300         INITIALIZE DP200O-LASER-NEW-PAGE-INDICATR                21750000
215400                                                                  21760000
215500         WRITE REPORT-RECORD                                      21770000
215600             FROM REPORT-TITLE-LINE                               21780000
215700             AFTER ADVANCING 1 LINE                               21790000
215800                                                                  21800000
215900         WRITE REPORT-RECORD                                      21810000
216000             FROM REPORT-TITLE-LINE2                              21820000
216100             AFTER ADVANCING 1 LINE                               21830000
216200                                                                  21840000
216300     ELSE                                                         21850000
216400         MOVE WKMUMD-ORGN-CDE     TO PV-HOLD-ORGN-CDE             21860000
216500         MOVE WKMUMD-PRIC-CHG-TYP-CDE                             21870000
216600                                  TO PV-HOLD-PRIC-CHG-TYP-CDE     21880000
216700         MOVE WKMUMD-RSN-CDE      TO PV-HOLD-RSN-CDE              21890000
216800                                                                  21900000
216900         MOVE 'CO'                 TO RPT-HL1-GMM-NUMBER          21910000
217000         MOVE 'R'                  TO RPT-HL1-GMM-FILLER          21920000
217100         MOVE 'PORATE SUMMARY '    TO RPT-HL1-GMM-NAME            21930000
217200         MOVE SPACES               TO RPT-HL1-GMM-LITERAL         21940000
217300                                      RPT-HL1-DMM-LITERAL         21950000
217400                                      RPT-HL1-DMM-NUMBER          21960000
217500                                      RPT-HL1-DMM-NAME            21970000
217600                                      RPT-HL1-BUYER-LITERAL       21980000
217700                                      RPT-HL1-BUYER-NUMBER        21990000
217800                                      RPT-HL1-BUYER-NAME          22000000
217900                                                                  22010000
218000         PERFORM D100-PROCESS-PAGE-BREAK                          22020000
218100         PERFORM E100-PRINT-ORGN-TYP-LINE                         22030000
218200         MOVE ZEROES              TO PV-SUM-BY-ORGN-TYP-TOTAL     22040000
218300         IF CR-VALID-SEASON                                       22050000
218400             PERFORM E600-GET-CRP-ORGN-TYP-MNTH-SUM               22060000
218500                 VARYING PV-SUB                                   22070000
218600                 FROM 1 BY 1                                      22080000
218700                 UNTIL (PV-SUB > 6)                               22090000
218800                    OR (PV-SUB > PV-CALC-SEASON-MONTH)            22100000
218900         ELSE                                                     22110000
219000             PERFORM E300-GET-CRP-ORGN-TYP-WKLY-SUM               22120000
219100                 VARYING PV-SUB                                   22130000
219200                 FROM 1 BY 1                                      22140000
219300                 UNTIL PV-SUB > PV-FISCAL-PERIOD-WEEK             22150000
219400         END-IF                                                   22160000
219500     END-IF.                                                      22170000
219600                                                                  22180000
219700******************************************************************22190000
219800*     B710-OPEN-CORP-CSR                                         *22200000
219900* ==> PROCESSES:                                                 *22210000
220000*     - OPENS THE CORP CURSOR                                    *22220000
220100* ==> PERFORMED FROM: B100-INITIALIZE                            *22230000
220200******************************************************************22240000
220300 B710-OPEN-CORP-CSR.                                              22250000
220400                                                                  22260000
220500     IF CR-VALID-SEASON                                           22270000
220600         IF CR-CUMULATIVE-SEASON                                  22280000
220700             MOVE PV-FSCL-YEAR TO WKMUMD-FSCL-YR                  22290000
220800         ELSE                                                     22300000
220900             MOVE CR-YEAR      TO WKMUMD-FSCL-YR                  22310000
221000         END-IF                                                   22320000
221100     ELSE                                                         22330000
221200         MOVE PV-FSCL-YEAR     TO WKMUMD-FSCL-YR                  22340000
221300     END-IF.                                                      22350000
220400                                                                  22360000
221400     MOVE PV-DPG56-FISCAL-PERIOD-NBR                              22370000
221500                               TO WKMUMD-FSCL-MN.                 22380000
221600     MOVE PV-DPG56-FISCAL-PERIOD-WEEK                             22390000
221700                               TO WKMUMD-FSCL-WK.                 22400000
221800                                                                  22410000
221900     IF CR-VALID-SEASON                                           22420000
222000         EXEC SQL                                                 22430000
222100             OPEN CORP_SEASON_CSR                                 22440000
222200         END-EXEC                                                 22450000
222300     ELSE                                                         22460000
222400         EXEC SQL                                                 22470000
222500             OPEN CORP_CSR                                        22480000
222600         END-EXEC                                                 22490000
222700     END-IF.                                                      22500000
222800                                                                  22510000
222900     EVALUATE TRUE                                                22520000
223000         WHEN SQLCODE = +0                                        22530000
223100             CONTINUE                                             22540000
223200         WHEN OTHER                                               22550000
223300             MOVE 'B710-OPEN-CORP-CSR            '                22560000
223400                               TO PV-PARAGRAPH-NAME               22570000
223500             MOVE 'OPEN CORP CURSOR ON TWKMUMD   '                22580000
223600                               TO PV-DB2-OPERATION-ATTEMPTED      22590000
223700             PERFORM Z900-SQL-ABEND                               22600000
223800     END-EVALUATE.                                                22610000
223900                                                                  22620000
224000******************************************************************22630000
224100*     B720-FETCH-CORP-CSR                                        *22640000
224200* ==> PROCESSES:                                                 *22650000
224300*     - FETCHES A ROW FROM THE WEEKLY CURSOR                     *22660000
224400* ==> PERFORMED FROM: B100-INITIALIZE                            *22670000
224500*                     B200-PROCESS-AD-ITEMS                      *22680000
224600******************************************************************22690000
224700 B720-FETCH-CORP-CSR.                                             22700000
224800                                                                  22710000
224900     IF CR-VALID-SEASON                                           22720000
225000         EXEC SQL                                                 22730000
225100             FETCH  CORP_SEASON_CSR                               22740000
225200              INTO  :WKMUMD-FSCL-MN                               22750000
225300                  , :WKMUMD-ORGN-CDE                              22760000
225400                  , :WKMUMD-PRIC-CHG-TYP-CDE                      22770000
225500                  , :WKMUMD-RSN-CDE                               22780000
225600                  , :PV-TOT-MU-MD-AMT-CSR                         22790000
225700         END-EXEC                                                 22800000
225800     ELSE                                                         22810000
225900         EXEC SQL                                                 22820000
226000             FETCH  CORP_CSR                                      22830000
226100              INTO  :WKMUMD-FSCL-WK                               22840000
226200                  , :WKMUMD-ORGN-CDE                              22850000
226300                  , :WKMUMD-PRIC-CHG-TYP-CDE                      22860000
226400                  , :WKMUMD-RSN-CDE                               22870000
226500                  , :PV-TOT-MU-MD-AMT-CSR                         22880000
226600         END-EXEC                                                 22890000
226700     END-IF.                                                      22900000
226800                                                                  22910000
226900     EVALUATE TRUE                                                22920000
227000         WHEN SQLCODE = +0                                        22930000
227100             CONTINUE                                             22940000
227200         WHEN SQLCODE = +100                                      22950000
227300             SET PS-END-OF-CORP-CSR                               22960000
227400                               TO TRUE                            22970000
227500         WHEN OTHER                                               22980000
227600             MOVE 'B720-FETCH-CORP-CSR           '                22990000
227700                               TO PV-PARAGRAPH-NAME               23000000
227800             MOVE 'FETCH CORP CURSOR ON TWKMUMD  '                23010000
227900                               TO PV-DB2-OPERATION-ATTEMPTED      23020000
228000             PERFORM Z900-SQL-ABEND                               23030000
228100     END-EVALUATE.                                                23040000
228200                                                                  23050000
228300******************************************************************23060000
228400*     B730-CLOSE-CORP-CSR                                        *23070000
228500* ==> PROCESSES:                                                 *23080000
228600*     - CLOSES THE CORP CURSOR                                   *23090000
228700* ==> PERFORMED FROM: B100-INITIALIZE                            *23100000
228800******************************************************************23110000
228900 B730-CLOSE-CORP-CSR.                                             23120000
229000                                                                  23130000
229100     IF CR-VALID-SEASON                                           23140000
229200         EXEC SQL                                                 23150000
229300             CLOSE CORP_SEASON_CSR                                23160000
229400         END-EXEC                                                 23170000
229500     ELSE                                                         23180000
229600         EXEC SQL                                                 23190000
229700             CLOSE CORP_CSR                                       23200000
229800         END-EXEC                                                 23210000
229900     END-IF.                                                      23220000
230000                                                                  23230000
230100     EVALUATE TRUE                                                23240000
230200         WHEN SQLCODE = +0                                        23250000
230300             CONTINUE                                             23260000
230400         WHEN OTHER                                               23270000
230500             MOVE 'B730-CLOSE-CORP-CSR           '                23280000
230600                               TO PV-PARAGRAPH-NAME               23290000
230700             MOVE 'CLOSE CORP CURSOR ON TWKMUMD  '                23300000
230800                               TO PV-DB2-OPERATION-ATTEMPTED      23310000
230900             PERFORM Z900-SQL-ABEND                               23320000
231000     END-EVALUATE.                                                23330000
231100                                                                  23340000
231200******************************************************************23350000
231300*     B800-PROCESS-CORP-SUMMARY                                  *23360000
231400* ==> PROCESSES:                                                 *23370000
231500* ==> PERFORMED FROM:  A100-MAINLINE                             *23380000
231600******************************************************************23390000
231700 B800-PROCESS-CORP-SUMMARY.                                       23400000
231800                                                                  23410000
231900     IF WKMUMD-ORGN-CDE = PV-HOLD-ORGN-CDE                        23420000
232000        IF WKMUMD-PRIC-CHG-TYP-CDE = PV-HOLD-PRIC-CHG-TYP-CDE     23430000
232100            IF WKMUMD-RSN-CDE = PV-HOLD-RSN-CDE                   23440000
232200                CONTINUE                                          23450000
232300            ELSE                                                  23460000
232400                PERFORM C200-PRINT-DETAIL                         23470000
232500                MOVE WKMUMD-RSN-CDE                               23480000
232600                                TO PV-HOLD-RSN-CDE                23490000
232700            END-IF                                                23500000
232800        ELSE                                                      23510000
232900            PERFORM C200-PRINT-DETAIL                             23520000
233000            PERFORM D300-PRINT-ORGN-TYPE-TOT-LINE                 23530000
233100            MOVE WKMUMD-PRIC-CHG-TYP-CDE                          23540000
233200                                TO PV-HOLD-PRIC-CHG-TYP-CDE       23550000
233300            MOVE WKMUMD-RSN-CDE                                   23560000
233400                                TO PV-HOLD-RSN-CDE                23570000
233500            PERFORM E100-PRINT-ORGN-TYP-LINE                      23580000
233600            IF CR-VALID-SEASON                                    23590000
233700                PERFORM E600-GET-CRP-ORGN-TYP-MNTH-SUM            23600000
233800                    VARYING PV-SUB                                23610000
233900                    FROM 1 BY 1                                   23620000
234000                    UNTIL (PV-SUB > 6)                            23630000
234100                       OR (PV-SUB > PV-CALC-SEASON-MONTH)         23640000
234200            ELSE                                                  23650000
234300                PERFORM E300-GET-CRP-ORGN-TYP-WKLY-SUM            23660000
234400                    VARYING PV-SUB                                23670000
234500                    FROM 1 BY 1                                   23680000
234600                    UNTIL PV-SUB > PV-FISCAL-PERIOD-WEEK          23690000
234700            END-IF                                                23700000
234800        END-IF                                                    23710000
234900     ELSE                                                         23720000
235000         PERFORM C200-PRINT-DETAIL                                23730000
235100         PERFORM D300-PRINT-ORGN-TYPE-TOT-LINE                    23740000
235200         PERFORM D400-PRINT-ORGN-TOT-LINE                         23750000
235300         MOVE WKMUMD-ORGN-CDE   TO PV-HOLD-ORGN-CDE               23760000
235400         MOVE WKMUMD-PRIC-CHG-TYP-CDE                             23770000
235500                                TO PV-HOLD-PRIC-CHG-TYP-CDE       23780000
235600         MOVE WKMUMD-RSN-CDE    TO PV-HOLD-RSN-CDE                23790000
235700         PERFORM E100-PRINT-ORGN-TYP-LINE                         23800000
235800         IF CR-VALID-SEASON                                       23810000
235900             PERFORM E600-GET-CRP-ORGN-TYP-MNTH-SUM               23820000
236000                 VARYING PV-SUB                                   23830000
236100                 FROM 1 BY 1                                      23840000
236200                 UNTIL (PV-SUB > 6)                               23850000
236300                    OR (PV-SUB > PV-CALC-SEASON-MONTH)            23860000
236400         ELSE                                                     23870000
236500             PERFORM E300-GET-CRP-ORGN-TYP-WKLY-SUM               23880000
236600                 VARYING PV-SUB                                   23890000
236700                 FROM 1 BY 1                                      23900000
236800                 UNTIL PV-SUB > PV-FISCAL-PERIOD-WEEK             23910000
236900         END-IF                                                   23920000
237000     END-IF.                                                      23930000
237100                                                                  23940000
237200     IF CR-VALID-SEASON                                           23950000
237300         PERFORM B210-POPULATE-AMTS-FOR-SEASON                    23960000
237400     ELSE                                                         23970000
237500         PERFORM B220-POPULATE-AMTS-FOR-WEEK                      23980000
237600     END-IF.                                                      23990000
237700     ADD PV-TOT-MU-MD-AMT-CSR      TO PV-SUM-BY-RSN-CDE-TOTAL.    24000000
237800                                                                  24010000
237900     PERFORM B720-FETCH-CORP-CSR.                                 24020000
238000                                                                  24030000
238100******************************************************************24040000
238200*     B900-EOJ-ROUTINE                                           *24050000
238300* ==> PROCESSES:                                                 *24060000
238400*     - WRITES AN END OF REPORT LINE TO THE REPORT               *24070000
238500*     - CLOSES THE FILES                                         *24080000
238600*     - DISPLAYS THE NUMBER OF RECORDS READ AND WRITTEN          *24090000
238700* ==> PERFORMED FROM:  A100-MAINLINE                             *24100000
238800******************************************************************24110000
238900 B900-EOJ-ROUTINE.                                                24120000
239000                                                                  24130000
239100     ADD PC-TWO  TO PA-LINE-COUNTER.                              24140000
239200                                                                  24150000
239300     IF PA-LINE-COUNTER >= PC-MAX-LINES-PER-PAGE                  24160000
239400         PERFORM D100-PROCESS-PAGE-BREAK                          24170000
239500     END-IF.                                                      24180000
239600                                                                  24190000
239700     WRITE REPORT-RECORD                                          24200000
239800         FROM REPORT-ENDING-LINE                                  24210000
239900         AFTER ADVANCING 2 LINES.                                 24220000
240000                                                                  24230000
240100     CLOSE REPORT-FILE.                                           24240000
240200                                                                  24250000
240300     DISPLAY ' '.                                                 24260000
240400     DISPLAY 'MESSAGES FOR PROGRAM ' PC-PROGRAM-NAME.             24270000
240500     DISPLAY 'NUMBER OF REPORT RECORDS WRITTEN:  '                24280000
240600         PA-REPORT-RECORDS-WRITTEN.                               24290000
240700     DISPLAY ' '.                                                 24300000
240800                                                                  24310000
240900******************************************************************24320000
241000*     C100-OPEN-SEASON-CSR                                       *24330000
241100* ==> PROCESSES:                                                 *24340000
241200*     - OPENS THE SEASON CURSOR                                  *24350000
241300* ==> PERFORMED FROM: B100-INITIALIZE                            *24360000
241400******************************************************************24370000
241500 C100-OPEN-SEASON-CSR.                                            24380000
241600                                                                  24390000
241700     IF CR-VALID-BATCH                                            24400000
241800         MOVE PV-FSCL-YEAR     TO WKMUMD-FSCL-YR                  24410000
241900     ELSE                                                         24420000
242000         MOVE CR-YEAR          TO WKMUMD-FSCL-YR                  24430000
242100     END-IF.                                                      24440000
242200                                                                  24450000
242300     IF CR-DEPT = SPACES                                          24460000
242400         MOVE PC-SEASONAL-DEPT-LOW                                24470000
242500                               TO DK-SEASONAL-DEPT-LOW            24480000
242600         MOVE PC-SEASONAL-DEPT-HIGH                               24490000
242700                               TO DK-SEASONAL-DEPT-HIGH           24500000
242800     ELSE                                                         24510000
242900         MOVE CR-DEPT          TO DK-SEASONAL-DEPT-LOW            24520000
243000                                  DK-SEASONAL-DEPT-HIGH           24530000
243100     END-IF.                                                      24540000
243200                                                                  24550000
243300     IF CR-SPRING                                                 24560000
243400         MOVE 01               TO DK-START-OF-SEASON              24570000
243500     ELSE                                                         24580000
243600         MOVE 07               TO DK-START-OF-SEASON              24590000
243700     END-IF.                                                      24600000
243800     MOVE PV-DPG56-FISCAL-PERIOD-NBR                              24610000
243900                               TO DK-END-OF-SEASON.               24620000
244000                                                                  24630000
244100     EXEC SQL                                                     24640000
244200         OPEN SEASON_CSR                                          24650000
244300     END-EXEC.                                                    24660000
244400                                                                  24670000
244500     EVALUATE TRUE                                                24680000
244600         WHEN SQLCODE = +0                                        24690000
244700             CONTINUE                                             24700000
244800         WHEN OTHER                                               24710000
244900             MOVE 'C100-OPEN-SEASON-CSR          '                24720000
245000                               TO PV-PARAGRAPH-NAME               24730000
245100             MOVE 'OPEN SEASON CURSOR ON TWKMUMD '                24740000
245200                               TO PV-DB2-OPERATION-ATTEMPTED      24750000
245300             PERFORM Z900-SQL-ABEND                               24760000
245400     END-EVALUATE.                                                24770000
245500                                                                  24780000
245600******************************************************************24790000
245700*     C150-FETCH-SEASON-CSR                                      *24800000
245800* ==> PROCESSES:                                                 *24810000
245900*     - FETCHES A ROW FROM THE SEASON CURSOR                     *24820000
246000* ==> PERFORMED FROM: B100-INITIALIZE                            *24830000
246100*                     B200-PROCESS-AD-ITEMS                      *24840000
246200******************************************************************24850000
246300 C150-FETCH-SEASON-CSR.                                           24860000
246400                                                                  24870000
246500     EXEC SQL                                                     24880000
246600         FETCH  SEASON_CSR                                        24890000
246700          INTO  :WKMUMD-FSCL-MN                                   24900000
246800              , :WKMUMD-FSCL-YR                                   24910000
246900              , :WKMUMD-DEPT-NBR                                  24920000
247000              , :WKMUMD-ORGN-CDE                                  24930000
247100              , :WKMUMD-PRIC-CHG-TYP-CDE                          24940000
247200              , :WKMUMD-RSN-CDE                                   24950000
247300              , :PV-TOT-MU-MD-AMT-CSR                             24960000
247400     END-EXEC.                                                    24970000
247500                                                                  24980000
247600     EVALUATE TRUE                                                24990000
247700         WHEN SQLCODE = +0                                        25000000
247800             CONTINUE                                             25010000
247900         WHEN SQLCODE = +100                                      25020000
248000             SET PS-END-OF-SEASON-CSR                             25030000
248100                               TO TRUE                            25040000
248200         WHEN OTHER                                               25050000
248300             MOVE 'C150-FETCH-SEASON-CSR         '                25060000
248400                               TO PV-PARAGRAPH-NAME               25070000
248500             MOVE 'FETCH SEASON CSR ON TWKMUMD   '                25080000
248600                               TO PV-DB2-OPERATION-ATTEMPTED      25090000
248700             PERFORM Z900-SQL-ABEND                               25100000
248800     END-EVALUATE.                                                25110000
248900                                                                  25120000
249000******************************************************************25130000
249100*     C175-CLOSE-SEASON-CSR                                      *25140000
249200* ==> PROCESSES:                                                 *25150000
249300*     - CLOSES THE SEASON CURSOR                                 *25160000
249400* ==> PERFORMED FROM: B100-INITIALIZE                            *25170000
249500******************************************************************25180000
249600 C175-CLOSE-SEASON-CSR.                                           25190000
249700                                                                  25200000
249800     EXEC SQL                                                     25210000
249900         CLOSE SEASON_CSR                                         25220000
250000     END-EXEC.                                                    25230000
250100                                                                  25240000
250200     EVALUATE TRUE                                                25250000
250300         WHEN SQLCODE = +0                                        25260000
250400             CONTINUE                                             25270000
250500         WHEN OTHER                                               25280000
250600             MOVE 'C175-CLOSE-SEASON-CSR         '                25290000
250700                               TO PV-PARAGRAPH-NAME               25300000
250800             MOVE 'CLOSE SEASON CURSOR ON TWKMUMD'                25310000
250900                               TO PV-DB2-OPERATION-ATTEMPTED      25320000
251000             PERFORM Z900-SQL-ABEND                               25330000
251100     END-EVALUATE.                                                25340000
251300                                                                  25350000
251400******************************************************************25360000
251500*     C200-OPEN-WEEKLY-CSR                                       *25370000
251600* ==> PROCESSES:                                                 *25380000
251700*     - OPENS THE WEEKLY CURSOR                                  *25390000
251800* ==> PERFORMED FROM: B100-INITIALIZE                            *25400000
251900******************************************************************25410000
252000 C200-OPEN-WEEKLY-CSR.                                            25420000
252100                                                                  25430000
252200     MOVE PV-FSCL-YEAR         TO WKMUMD-FSCL-YR.                 25440000
252300     MOVE PV-DPG56-FISCAL-PERIOD-NBR                              25450000
252400                               TO WKMUMD-FSCL-MN.                 25460000
252500     MOVE PV-DPG56-FISCAL-PERIOD-WEEK                             25470000
252600                               TO WKMUMD-FSCL-WK.                 25480000
252700                                                                  25490000
252800     EXEC SQL                                                     25500000
252900         OPEN WEEKLY_CSR                                          25510000
253000     END-EXEC.                                                    25520000
253100                                                                  25530000
253200     EVALUATE TRUE                                                25540000
253300         WHEN SQLCODE = +0                                        25550000
253400             CONTINUE                                             25560000
253500         WHEN OTHER                                               25570000
253600             MOVE 'C200-OPEN-WEEKLY-CSR          '                25580000
253700                               TO PV-PARAGRAPH-NAME               25590000
253800             MOVE 'OPEN WEEKLY CURSOR ON TWKMUMD '                25600000
253900                               TO PV-DB2-OPERATION-ATTEMPTED      25610000
254000             PERFORM Z900-SQL-ABEND                               25620000
254100     END-EVALUATE.                                                25630000
254200                                                                  25640000
254300******************************************************************25650000
254400*     C250-FETCH-WEEKLY-CSR                                      *25660000
254500* ==> PROCESSES:                                                 *25670000
254600*     - FETCHES A ROW FROM THE WEEKLY CURSOR                     *25680000
254700* ==> PERFORMED FROM: B100-INITIALIZE                            *25690000
254800*                     B200-PROCESS-AD-ITEMS                      *25700000
254900******************************************************************25710000
255000 C250-FETCH-WEEKLY-CSR.                                           25720000
255100                                                                  25730000
255200     EXEC SQL                                                     25740000
255300         FETCH  WEEKLY_CSR                                        25750000
255400          INTO  :WKMUMD-FSCL-MN                                   25760000
255500              , :WKMUMD-FSCL-YR                                   25770000
255600              , :WKMUMD-DEPT-NBR                                  25780000
255700              , :WKMUMD-FSCL-WK                                   25790000
255800              , :WKMUMD-ORGN-CDE                                  25800000
255900              , :WKMUMD-PRIC-CHG-TYP-CDE                          25810000
256000              , :WKMUMD-RSN-CDE                                   25820000
256100              , :PV-TOT-MU-MD-AMT-CSR                             25830000
256200     END-EXEC.                                                    25840000
256300                                                                  25850000
256400     EVALUATE TRUE                                                25860000
256500         WHEN SQLCODE = +0                                        25870000
256600             CONTINUE                                             25880000
256700         WHEN SQLCODE = +100                                      25890000
256800             SET PS-END-OF-WEEKLY-CSR                             25900000
256900                               TO TRUE                            25910000
257000         WHEN OTHER                                               25920000
257100             MOVE 'C250-FETCH-WEEKLY-CSR         '                25930000
257200                               TO PV-PARAGRAPH-NAME               25940000
257300             MOVE 'FETCH WEEKLY CSR ON TWKMUMD   '                25950000
257400                               TO PV-DB2-OPERATION-ATTEMPTED      25960000
257500             PERFORM Z900-SQL-ABEND                               25970000
257600     END-EVALUATE.                                                25980000
257700                                                                  25990000
257800******************************************************************26000000
257900*     C275-CLOSE-WEEKLY-CSR                                      *26010000
258000* ==> PROCESSES:                                                 *26020000
258100*     - CLOSES THE WEEKLY CURSOR                                 *26030000
258200* ==> PERFORMED FROM: B100-INITIALIZE                            *26040000
258300******************************************************************26050000
258400 C275-CLOSE-WEEKLY-CSR.                                           26060000
258500                                                                  26070000
258600     EXEC SQL                                                     26080000
258700         CLOSE WEEKLY_CSR                                         26090000
258800     END-EXEC.                                                    26100000
258900                                                                  26110000
259000     EVALUATE TRUE                                                26120000
259100         WHEN SQLCODE = +0                                        26130000
259200             CONTINUE                                             26140000
259300         WHEN OTHER                                               26150000
259400             MOVE 'C275-CLOSE-WEEKLY-CSR         '                26160000
259500                               TO PV-PARAGRAPH-NAME               26170000
259600             MOVE 'CLOSE WEEKLY CURSOR ON TWKMUMD'                26180000
259700                               TO PV-DB2-OPERATION-ATTEMPTED      26190000
259800             PERFORM Z900-SQL-ABEND                               26200000
259900     END-EVALUATE.                                                26210000
260000                                                                  26220000
260100******************************************************************26230000
260200*     C200-PRINT-DETAIL                                          *26240000
260300* ==> PROCESSES:                                                 *26250000
260400*     - WRITES THE DETAIL LINES FOR THE REPORT                   *26260000
260500* ==> PERFORMED FROM:  B200-WRITE-REPORT                         *26270000
260600******************************************************************26280000
260700 C200-PRINT-DETAIL.                                               26290000
260800                                                                  26300000
260900     ADD PC-ONE                    TO PA-LINE-COUNTER.            26310000
261000     IF PA-LINE-COUNTER >= PC-MAX-LINES-PER-PAGE                  26320000
261100         PERFORM D100-PROCESS-PAGE-BREAK                          26330000
261200         PERFORM E100-PRINT-ORGN-TYP-LINE                         26340000
261300         ADD PC-ONE                TO PA-LINE-COUNTER             26350000
261400     END-IF.                                                      26360000
261500                                                                  26370000
261600     MOVE PV-HOLD-RSN-CDE          TO RPT-REASON-CODE.            26380000
261700     PERFORM C210-FIND-REASON-CODE-DESC.                          26390000
261800                                                                  26400000
261900     IF CR-VALID-SEASON                                           26410000
262000         PERFORM C220-POPULATE-DETAIL-AMTS                        26420000
262100             VARYING PV-SUB                                       26430000
262200             FROM 1 BY 1                                          26440000
262300             UNTIL (PV-SUB > 6)                                   26450000
262400                OR (PV-SUB > PV-CALC-SEASON-MONTH)                26460000
262500     ELSE                                                         26470000
262600         PERFORM C220-POPULATE-DETAIL-AMTS                        26480000
262700             VARYING PV-SUB                                       26490000
262800             FROM 1 BY 1                                          26500000
262900             UNTIL PV-SUB > PV-FISCAL-PERIOD-WEEK                 26510000
263000     END-IF.                                                      26520000
263100                                                                  26530000
263200     IF PV-SUM-BY-ORGN-TYP-TOTAL = ZERO                           26540000
263300         MOVE ZERO                 TO PV-MKDN-MKUP-PERIOD-TOT-AMT 26550000
263400         MOVE PV-MKDN-MKUP-PERIOD-TOT-AMT                         26560000
263500                                   TO RPT-MKDN-MKUP-PERIOD-TOT-AMT26570000
263600         MOVE ZERO                 TO PV-PERCENT                  26580000
263700         MOVE PV-PERCENTAGE        TO RPT-MKDN-MKUP-PERIOD-TOT-PCT26590000
263800     ELSE                                                         26600000
263900         MOVE PV-SUM-BY-RSN-CDE-TOTAL                             26610000
264000                                   TO PV-MKDN-MKUP-PERIOD-TOT-AMT 26620000
264100         MOVE PV-MKDN-MKUP-PERIOD-TOT-AMT                         26630000
264200                                   TO RPT-MKDN-MKUP-PERIOD-TOT-AMT26640000
264300         COMPUTE PV-PERCENT-OF-TOT-WEEK =                         26650000
264400              (PV-SUM-BY-RSN-CDE-TOTAL / PV-SUM-BY-ORGN-TYP-TOTAL 26660000
264500                  * 100)                                          26670000
264600         MULTIPLY PV-PERCENT-OF-TOT-WEEK BY 1                     26680000
264700             GIVING PV-ROUNDED-PERCENT ROUNDED                    26690000
264800         MOVE PV-ROUNDED-PERCENT   TO PV-PERCENT                  26700000
264900         MOVE PV-PERCENTAGE        TO                             26710000
265000                                     RPT-MKDN-MKUP-PERIOD-TOT-PCT 26720000
265100     END-IF.                                                      26730000
265200                                                                  26740000
265300     WRITE REPORT-RECORD                                          26750000
265400         FROM REPORT-DETAIL-LINE                                  26760000
265500         AFTER ADVANCING 1 LINE.                                  26770000
265600                                                                  26780000
265700     ADD PC-ONE  TO PA-REPORT-RECORDS-WRITTEN.                    26790000
265800     MOVE ZEROES TO PV-SUM-BY-RSN-CDE-TOTAL                       26800000
265900                    PV-PERCENT-OF-TOT-WEEK                        26810000
266000                    PV-ROUNDED-PERCENT.                           26820000
266100     MOVE ZEROES TO PV-PERCENT.                                   26830000
266200     INITIALIZE REPORT-DETAIL-LINE.                               26840000
266300                                                                  26850000
266400******************************************************************26860000
266500*     C210-FIND-REASON-CODE-DESC.                                *26870000
266600* ==> PROCESSES:                                                 *26880000
266700*     -                                                          *26890000
266800* ==> PERFORMED FROM:  C200-PRINT-DETAIL                         *26900000
266900******************************************************************26910000
267000 C210-FIND-REASON-CODE-DESC.                                      26920000
267100                                                                  26930000
267200     SET PE049-RSN-CDE-IDX         TO 1.                          26940000
267300     SEARCH PE049-RSN-CODE-DESC-TABLE                             26950000
267400         AT END                                                   26960000
267500             SET PE049-RSN-CDE-IDX TO 1                           26970000
267600             MOVE PE049-RPT-RSN-CODE-DESC (PE049-RSN-CDE-IDX)     26980000
267700                                   TO RPT-REASON-CODE-DESC        26990000
267800         WHEN PE049-RPT-RSN-CODE (PE049-RSN-CDE-IDX)              27000000
267900                                    = RPT-REASON-CODE             27010000
268000             MOVE PE049-RPT-RSN-CODE-DESC (PE049-RSN-CDE-IDX)     27020000
268100                                   TO RPT-REASON-CODE-DESC        27030000
268200     END-SEARCH.                                                  27040000
268300                                                                  27050000
268400******************************************************************27060000
268500*     C220-POPULATE-DETAIL-AMTS                                  *27070000
268600* ==> PROCESSES:                                                 *27080000
268700*     - POPULATES THE AMOUNTS ON THE DETAIL LINE                 *27090000
268800* ==> PERFORMED FROM:  B200-WRITE-REPORT                         *27100000
268900******************************************************************27110000
269000 C220-POPULATE-DETAIL-AMTS.                                       27120000
269100                                                                  27130000
269200     EVALUATE PV-SUB                                              27140000
269300         WHEN 1                                                   27150000
269400             IF RPT-MKDN-MKUP-PERIOD-1-AMT = SPACES               27160000
269500                 MOVE ZERO TO PV-MKDN-MKUP-PERIOD-AMT             27170000
269600                 MOVE PV-MKDN-MKUP-PERIOD-AMT                     27180000
269700                           TO RPT-MKDN-MKUP-PERIOD-1-AMT          27190000
269800                 MOVE ZERO TO PV-PERCENT                          27200000
269900                 MOVE PV-PERCENTAGE                               27210000
270000                           TO RPT-MKDN-MKUP-PERIOD-1-PCT          27220000
270100             END-IF                                               27230000
270200         WHEN 2                                                   27240000
270300             IF RPT-MKDN-MKUP-PERIOD-2-AMT = SPACES               27250000
270400                 MOVE ZERO TO PV-MKDN-MKUP-PERIOD-AMT             27260000
270500                 MOVE PV-MKDN-MKUP-PERIOD-AMT                     27270000
270600                           TO RPT-MKDN-MKUP-PERIOD-2-AMT          27280000
270700                 MOVE ZERO TO PV-PERCENT                          27290000
270800                 MOVE PV-PERCENTAGE                               27300000
270900                           TO RPT-MKDN-MKUP-PERIOD-2-PCT          27310000
271000             END-IF                                               27320000
271100         WHEN 3                                                   27330000
271200             IF RPT-MKDN-MKUP-PERIOD-3-AMT = SPACES               27340000
271300                 MOVE ZERO TO PV-MKDN-MKUP-PERIOD-AMT             27350000
271400                 MOVE PV-MKDN-MKUP-PERIOD-AMT                     27360000
271500                           TO RPT-MKDN-MKUP-PERIOD-3-AMT          27370000
271600                 MOVE ZERO TO PV-PERCENT                          27380000
271700                 MOVE PV-PERCENTAGE                               27390000
271800                           TO RPT-MKDN-MKUP-PERIOD-3-PCT          27400000
271900             END-IF                                               27410000
272000         WHEN 4                                                   27420000
272100             IF RPT-MKDN-MKUP-PERIOD-4-AMT = SPACES               27430000
272200                 MOVE ZERO TO PV-MKDN-MKUP-PERIOD-AMT             27440000
272300                 MOVE PV-MKDN-MKUP-PERIOD-AMT                     27450000
272400                           TO RPT-MKDN-MKUP-PERIOD-4-AMT          27460000
272500                 MOVE ZERO TO PV-PERCENT                          27470000
272600                 MOVE PV-PERCENTAGE                               27480000
272700                           TO RPT-MKDN-MKUP-PERIOD-4-PCT          27490000
272800             END-IF                                               27500000
272900         WHEN 5                                                   27510000
273000             IF RPT-MKDN-MKUP-PERIOD-5-AMT = SPACES               27520000
273100                 MOVE ZERO TO PV-MKDN-MKUP-PERIOD-AMT             27530000
273200                 MOVE PV-MKDN-MKUP-PERIOD-AMT                     27540000
273300                           TO RPT-MKDN-MKUP-PERIOD-5-AMT          27550000
273400                 MOVE ZERO TO PV-PERCENT                          27560000
273500                 MOVE PV-PERCENTAGE                               27570000
273600                           TO RPT-MKDN-MKUP-PERIOD-5-PCT          27580000
273700             END-IF                                               27590000
273800         WHEN 6                                                   27600000
273900             IF RPT-MKDN-MKUP-PERIOD-6-AMT = SPACES               27610000
274000                 MOVE ZERO TO PV-MKDN-MKUP-PERIOD-AMT             27620000
274100                 MOVE PV-MKDN-MKUP-PERIOD-AMT                     27630000
274200                           TO RPT-MKDN-MKUP-PERIOD-6-AMT          27640000
274300                 MOVE ZERO TO PV-PERCENT                          27650000
274400                 MOVE PV-PERCENTAGE                               27660000
274500                           TO RPT-MKDN-MKUP-PERIOD-6-PCT          27670000
274600             END-IF                                               27680000
274700     END-EVALUATE.                                                27690000
274800                                                                  27700000
274900******************************************************************27710000
275000*     C300-INIT-REPORT-TITLES.                                   *27720000
275100* ==> PROCESSES:                                                 *27730000
275200*     - INITIALIZES THE REPORT HEADINGS WITH THE APPROPRIATE     *27740000
275300*       VALUES                                                   *27750000
275400* ==> PERFORMED FROM:  B100-INITIALIZE                           *27760000
275500******************************************************************27770000
275600 C300-INIT-REPORT-TITLES.                                         27780000
275700                                                                  27790000
275800     IF CR-VALID-SEASON                                           27800000
275900         MOVE RPT-TL-SEASONAL      TO RPT-TITLE-LINE-VALUE        27810000
276000         IF CR-SPRING                                             27820000
276100             SET RPT-TL2-SEASON-SPRING                            27830000
276200                                   TO TRUE                        27840000
276300         ELSE                                                     27850000
276400             SET RPT-TL2-SEASON-FALL                              27860000
276500                                   TO TRUE                        27870000
276600         END-IF                                                   27880000
276700         IF CR-CUMULATIVE-SEASON                                  27890000
276800             MOVE PV-FSCL-YEAR     TO RPT-TL2-SEASON-CCYY         27900000
276900         ELSE                                                     27910000
277000             MOVE CR-YEAR          TO RPT-TL2-SEASON-CCYY         27920000
277100         END-IF                                                   27930000
277200         MOVE RPT-TL2-SEASON       TO RPT-TITLE-LINE2-VALUE       27940000
277300         PERFORM C320-POPULATE-SEASONAL-HL3                       27950000
277400     ELSE                                                         27960000
277500         MOVE RPT-TL-WEEKLY        TO RPT-TITLE-LINE-VALUE        27970000
277600         PERFORM C310-POPULATE-HEADING-LINE3                      27980000
277700         IF CR-END-OF-WEEK                                        27990000
277800             MOVE CR-PERIOD-END-DTE-MM                            28000000
277900                                   TO RPT-TL2-WEEKLY-MM           28010000
278000             MOVE CR-PERIOD-END-DTE-DD                            28020000
278100                                   TO RPT-TL2-WEEKLY-DD           28030000
278200             MOVE CR-PERIOD-END-DTE-YY                            28040000
278300                                   TO RPT-TL2-WEEKLY-YY           28050000
278400             MOVE RPT-TL2-WEEKLY   TO RPT-TITLE-LINE2-VALUE       28060000
278500         ELSE                                                     28070000
278600             STRING DPG55-ALPHA-MONTH                             28080000
278700                    DELIMITED BY SPACE                            28090000
278800                    ' '                                           28100000
278900                    PV-FSCL-YEAR                                  28110000
279000                    DELIMITED BY SIZE INTO RPT-TL2-MONTH-YEAR     28120000
279100                                                                  28130000
279200             MOVE RPT-TL2-END-OF-MONTH                            28140000
279300                                   TO RPT-TITLE-LINE2-VALUE       28150000
279400                                                                  28160000
279500         END-IF                                                   28170000
279600     END-IF.                                                      28180000
279700                                                                  28190000
279800******************************************************************28200000
279900*     C310-POPULATE-HEADING-LINE3                                *28210000
280000* ==> PROCESSES:                                                 *28220000
280100*     - POPULATES HEADING LINE 3 FOR THE WEEKLY AND MONTHLY      *28230000
280200*       VERSION OF THE REPORT                                    *28240000
280300*       - THE LINE WITH THE FISCAL WEEK NUMBER AND THE BEGINNING *28250000
280400*         OF THE WEEK                                            *28260000
280500* ==> PERFORMED FROM:  C300-INIT-REPORT-TITLES                   *28270000
280600******************************************************************28280000
280700 C310-POPULATE-HEADING-LINE3.                                     28290000
280800                                                                  28300000
280900     INITIALIZE REPORT-HEADING-LINE3.                             28310000
281000                                                                  28320000
281100     EVALUATE PV-FISCAL-PERIOD-WEEK                               28330000
281200         WHEN 01                                                  28340000
281300             MOVE PC-WEEK-LITERAL   TO RPT-HL3-FSCL-WK-LIT1       28350000
281400             MOVE DPG56-FISCAL-WEEK-NBR                           28360000
281500                                    TO RPT-HL3-FSCL-WK-NBR1       28370000
281600             MOVE PC-HYPHEN-LITERAL TO RPT-HL3-FSCL-HYPHEN1       28380000
281700         WHEN 02                                                  28390000
281800             MOVE PC-WEEK-LITERAL   TO RPT-HL3-FSCL-WK-LIT1       28400000
281900                                       RPT-HL3-FSCL-WK-LIT2       28410000
282000                                                                  28420000
282100             COMPUTE PV-FISCAL-WEEK-NBR =                         28430000
282200                                    DPG56-FISCAL-WEEK-NBR - 1     28440000
282300             MOVE PV-FISCAL-WEEK-NBR                              28450000
282400                                    TO RPT-HL3-FSCL-WK-NBR1       28460000
282500                                                                  28470000
282600             MOVE DPG56-FISCAL-WEEK-NBR                           28480000
282700                                    TO RPT-HL3-FSCL-WK-NBR2       28490000
282800                                                                  28500000
282900             MOVE PC-HYPHEN-LITERAL TO RPT-HL3-FSCL-HYPHEN1       28510000
283000                                       RPT-HL3-FSCL-HYPHEN2       28520000
283100         WHEN 03                                                  28530000
283200             MOVE PC-WEEK-LITERAL   TO RPT-HL3-FSCL-WK-LIT1       28540000
283300                                       RPT-HL3-FSCL-WK-LIT2       28550000
283400                                       RPT-HL3-FSCL-WK-LIT3       28560000
283500                                                                  28570000
283600             COMPUTE PV-FISCAL-WEEK-NBR =                         28580000
283700                                    DPG56-FISCAL-WEEK-NBR - 2     28590000
283800             MOVE PV-FISCAL-WEEK-NBR                              28600000
283900                                    TO RPT-HL3-FSCL-WK-NBR1       28610000
284000                                                                  28620000
284100             COMPUTE PV-FISCAL-WEEK-NBR =                         28630000
284200                                    DPG56-FISCAL-WEEK-NBR - 1     28640000
284300             MOVE PV-FISCAL-WEEK-NBR                              28650000
284400                                    TO RPT-HL3-FSCL-WK-NBR2       28660000
284500                                                                  28670000
284600             MOVE DPG56-FISCAL-WEEK-NBR                           28680000
284700                                    TO RPT-HL3-FSCL-WK-NBR3       28690000
284800                                                                  28700000
284900             MOVE PC-HYPHEN-LITERAL TO RPT-HL3-FSCL-HYPHEN1       28710000
285000                                       RPT-HL3-FSCL-HYPHEN2       28720000
285100                                       RPT-HL3-FSCL-HYPHEN3       28730000
285200             MOVE DPG55-ALPHA-MONTH-ABBR3                         28740000
285300                                    TO RPT-HL3-FSCL-MONTH-ABBR1   28750000
285400                                       RPT-HL3-FSCL-MONTH-ABBR2   28760000
285500                                       RPT-HL3-FSCL-MONTH-ABBR3   28770000
285600         WHEN 04                                                  28780000
285700             MOVE PC-WEEK-LITERAL   TO RPT-HL3-FSCL-WK-LIT1       28790000
285800                                       RPT-HL3-FSCL-WK-LIT2       28800000
285900                                       RPT-HL3-FSCL-WK-LIT3       28810000
286000                                       RPT-HL3-FSCL-WK-LIT4       28820000
286100                                                                  28830000
286200             COMPUTE PV-FISCAL-WEEK-NBR =                         28840000
286300                                    DPG56-FISCAL-WEEK-NBR - 3     28850000
286400             MOVE PV-FISCAL-WEEK-NBR                              28860000
286500                                    TO RPT-HL3-FSCL-WK-NBR1       28870000
286600                                                                  28880000
286700             COMPUTE PV-FISCAL-WEEK-NBR =                         28890000
286800                                    DPG56-FISCAL-WEEK-NBR - 2     28900000
286900             MOVE PV-FISCAL-WEEK-NBR                              28910000
287000                                    TO RPT-HL3-FSCL-WK-NBR2       28920000
287100                                                                  28930000
287200             COMPUTE PV-FISCAL-WEEK-NBR =                         28940000
287300                                    DPG56-FISCAL-WEEK-NBR - 1     28950000
287400             MOVE PV-FISCAL-WEEK-NBR                              28960000
287500                                    TO RPT-HL3-FSCL-WK-NBR3       28970000
287600                                                                  28980000
287700             MOVE DPG56-FISCAL-WEEK-NBR                           28990000
287800                                    TO RPT-HL3-FSCL-WK-NBR4       29000000
287900                                                                  29010000
288000             MOVE PC-HYPHEN-LITERAL TO RPT-HL3-FSCL-HYPHEN1       29020000
288100                                       RPT-HL3-FSCL-HYPHEN2       29030000
288200                                       RPT-HL3-FSCL-HYPHEN3       29040000
288300                                       RPT-HL3-FSCL-HYPHEN4       29050000
288400             MOVE DPG55-ALPHA-MONTH-ABBR3                         29060000
288500                                    TO RPT-HL3-FSCL-MONTH-ABBR1   29070000
288600                                       RPT-HL3-FSCL-MONTH-ABBR2   29080000
288700                                       RPT-HL3-FSCL-MONTH-ABBR3   29090000
288800                                       RPT-HL3-FSCL-MONTH-ABBR4   29100000
288900                                                                  29110000
289000         WHEN 05                                                  29120000
289100             MOVE PC-WEEK-LITERAL   TO RPT-HL3-FSCL-WK-LIT1       29130000
289200                                       RPT-HL3-FSCL-WK-LIT2       29140000
289300                                       RPT-HL3-FSCL-WK-LIT3       29150000
289400                                       RPT-HL3-FSCL-WK-LIT4       29160000
289500                                       RPT-HL3-FSCL-WK-LIT5       29170000
289600                                                                  29180000
289700             COMPUTE PV-FISCAL-WEEK-NBR =                         29190000
289800                                    DPG56-FISCAL-WEEK-NBR - 4     29200000
289900             MOVE PV-FISCAL-WEEK-NBR                              29210000
290000                                    TO RPT-HL3-FSCL-WK-NBR1       29220000
290100                                                                  29230000
290200             COMPUTE PV-FISCAL-WEEK-NBR =                         29240000
290300                                    DPG56-FISCAL-WEEK-NBR - 3     29250000
290400             MOVE PV-FISCAL-WEEK-NBR                              29260000
290500                                    TO RPT-HL3-FSCL-WK-NBR2       29270000
290600                                                                  29280000
290700             COMPUTE PV-FISCAL-WEEK-NBR =                         29290000
290800                                    DPG56-FISCAL-WEEK-NBR - 2     29300000
290900             MOVE PV-FISCAL-WEEK-NBR                              29310000
291000                                    TO RPT-HL3-FSCL-WK-NBR3       29320000
291100                                                                  29330000
291200             COMPUTE PV-FISCAL-WEEK-NBR =                         29340000
291300                                    DPG56-FISCAL-WEEK-NBR - 1     29350000
291400             MOVE PV-FISCAL-WEEK-NBR                              29360000
291500                                    TO RPT-HL3-FSCL-WK-NBR4       29370000
291600                                                                  29380000
291700             MOVE DPG56-FISCAL-WEEK-NBR                           29390000
291800                                    TO RPT-HL3-FSCL-WK-NBR5       29400000
291900                                                                  29410000
292000             MOVE PC-HYPHEN-LITERAL TO RPT-HL3-FSCL-HYPHEN1       29420000
292100                                       RPT-HL3-FSCL-HYPHEN2       29430000
292200                                       RPT-HL3-FSCL-HYPHEN3       29440000
292300                                       RPT-HL3-FSCL-HYPHEN4       29450000
292400                                       RPT-HL3-FSCL-HYPHEN5       29460000
292500             MOVE DPG55-ALPHA-MONTH-ABBR3                         29470000
292600                                    TO RPT-HL3-FSCL-MONTH-ABBR1   29480000
292700                                       RPT-HL3-FSCL-MONTH-ABBR2   29490000
292800                                       RPT-HL3-FSCL-MONTH-ABBR3   29500000
292900                                       RPT-HL3-FSCL-MONTH-ABBR4   29510000
293000                                       RPT-HL3-FSCL-MONTH-ABBR5   29520000
293100     END-EVALUATE.                                                29530000
293200                                                                  29540000
293300**** TAKES THE FIRST DAY OF THE FISCAL PERIOD (MONTH)             29550000
293400**** AND CALLS THE CALENDAR ROUTINE TO GET THE MONTH NAME/        29560000
293500**** ABBREVIATION                                                 29570000
293600                                                                  29580000
293700     MOVE DPG56-FIRST-FP-DB2-ISO-FMT-DY                           29590000
293800                                     TO RPT-HL3-FSCL-START-WK1.   29600000
293900                                                                  29610000
294000     SET DPG51-ACTUAL-CALENDAR-ONLY  TO TRUE.                     29620000
294100     SET DPG51-DO-NOT-INCR-DECR-DATE TO TRUE.                     29630000
294200                                                                  29640000
294300     MOVE DPG56-FIRST-FP-DB2-ISO-FMT TO DPG52-LK-DATE-INPUT.      29650000
294400     SET DPG52-LK-DTE-ISO-FMT        TO TRUE.                     29660000
294500     INITIALIZE DPG53.                                            29670000
294600                                                                  29680000
294700     MOVE 'C310-POPULATE-HEADING-LINE3 (A)'                       29690000
294800                                     TO  PV-PARAGRAPH-NAME.       29700000
294900     PERFORM  Z810-DATE-ROUTINE-CALL.                             29710000
295000                                                                  29720000
295100     MOVE DPG55-ALPHA-MONTH-ABBR3    TO RPT-HL3-FSCL-MONTH-ABBR1. 29730000
295200     MOVE DPG55-DB2-ISO-DATE-FMT     TO PV-START-OF-WEEK-DATE.    29740000
295300                                                                  29750000
295400**** USING THE PV-START-OF-WEEK-DATE ABOVE, THE REST OF THE       29760000
295500**** WEEKLY STARTING DATES ARE CALCULATED BELOW BY ADDING 7 DAYS  29770000
295600**** TO EACH CONSECUTIVE DATE                                     29780000
295700                                                                  29790000
295800     PERFORM                                                      29800000
295900         VARYING PV-SUB                                           29810000
296000         FROM 2 BY 1                                              29820000
296100         UNTIL PV-SUB > PV-FISCAL-PERIOD-WEEK                     29830000
296200                                                                  29840000
296300         SET DPG51-ACTUAL-CALENDAR-ONLY  TO TRUE                  29850000
296400         SET DPG51-INCREMENT-DATE        TO TRUE                  29860000
296500         MOVE PC-DAYS-TO-INCREMENT       TO DPG51-INCR-DECR-DAYS-929870000
296600                                                                  29880000
296700         MOVE PV-START-OF-WEEK-DATE      TO DPG52-LK-DATE-INPUT   29890000
296800         SET DPG52-LK-DTE-ISO-FMT        TO TRUE                  29900000
296900         INITIALIZE DPG53                                         29910000
297000                                                                  29920000
297100         MOVE 'C310-POPULATE-HEADING-LINE3 (B)'                   29930000
297200                                         TO  PV-PARAGRAPH-NAME    29940000
297300         PERFORM  Z810-DATE-ROUTINE-CALL                          29950000
297400                                                                  29960000
297500         EVALUATE PV-SUB                                          29970000
297600             WHEN 2                                               29980000
297700                 MOVE DPG55-ALPHA-MONTH-ABBR3                     29990000
297800                                    TO RPT-HL3-FSCL-MONTH-ABBR2   30000000
297900                 MOVE DPG55-DB2-ISO-DATE-FMT-DY                   30010000
298000                                    TO RPT-HL3-FSCL-START-WK2     30020000
298100             WHEN 3                                               30030000
298200                 MOVE DPG55-ALPHA-MONTH-ABBR3                     30040000
298300                                    TO RPT-HL3-FSCL-MONTH-ABBR3   30050000
298400                 MOVE DPG55-DB2-ISO-DATE-FMT-DY                   30060000
298500                                    TO RPT-HL3-FSCL-START-WK3     30070000
298600             WHEN 4                                               30080000
298700                 MOVE DPG55-ALPHA-MONTH-ABBR3                     30090000
298800                                    TO RPT-HL3-FSCL-MONTH-ABBR4   30100000
298900                 MOVE DPG55-DB2-ISO-DATE-FMT-DY                   30110000
299000                                    TO RPT-HL3-FSCL-START-WK4     30120000
299100             WHEN 5                                               30130000
299200                 MOVE DPG55-ALPHA-MONTH-ABBR3                     30140000
299300                                    TO RPT-HL3-FSCL-MONTH-ABBR5   30150000
299400                 MOVE DPG55-DB2-ISO-DATE-FMT-DY                   30160000
299500                                    TO RPT-HL3-FSCL-START-WK5     30170000
299600         END-EVALUATE                                             30180000
299700                                                                  30190000
299800         MOVE DPG55-DB2-ISO-DATE-FMT  TO PV-START-OF-WEEK-DATE    30200000
299900     END-PERFORM.                                                 30210000
300000                                                                  30220000
300100******************************************************************30230000
300200*     C320-POPULATE-SEASONAL-HL3.                                *30240000
300300* ==> PROCESSES:                                                 *30250000
300400*     - POPULATES HEADING LINE 3 FOR THE WEEKLY AND MONTHLY      *30260000
300500*       VERSION OF THE REPORT                                    *30270000
300600*       - THE LINE WITH THE FISCAL WEEK NUMBER AND THE BEGINNING *30280000
300700*         OF THE WEEK                                            *30290000
300800* ==> PERFORMED FROM:  C300-INIT-REPORT-TITLES                   *30300000
300900******************************************************************30310000
301000 C320-POPULATE-SEASONAL-HL3.                                      30320000
301100                                                                  30330000
301200     INITIALIZE REPORT-SEASONAL-HEADING-LINE3.                    30340000
301300                                                                  30350000
301400     EVALUATE PV-DPG56-FISCAL-PERIOD-NBR                          30360000
301500         WHEN 01                                                  30370000
301600             MOVE 'FEBRUARY ' TO RPT-SEASON-HL3-MONTH1            30380000
301700         WHEN 02                                                  30390000
301800             MOVE 'FEBRUARY ' TO RPT-SEASON-HL3-MONTH1            30400000
301900             MOVE 'MARCH    ' TO RPT-SEASON-HL3-MONTH2            30410000
302000         WHEN 03                                                  30420000
302100             MOVE 'FEBRUARY ' TO RPT-SEASON-HL3-MONTH1            30430000
302200             MOVE 'MARCH    ' TO RPT-SEASON-HL3-MONTH2            30440000
302300             MOVE 'APRIL    ' TO RPT-SEASON-HL3-MONTH3            30450000
302400         WHEN 04                                                  30460000
302500             MOVE 'FEBRUARY ' TO RPT-SEASON-HL3-MONTH1            30470000
302600             MOVE 'MARCH    ' TO RPT-SEASON-HL3-MONTH2            30480000
302700             MOVE 'APRIL    ' TO RPT-SEASON-HL3-MONTH3            30490000
302800             MOVE 'MAY      ' TO RPT-SEASON-HL3-MONTH4            30500000
302900         WHEN 05                                                  30510000
303000             MOVE 'FEBRUARY ' TO RPT-SEASON-HL3-MONTH1            30520000
303100             MOVE 'MARCH    ' TO RPT-SEASON-HL3-MONTH2            30530000
303200             MOVE 'APRIL    ' TO RPT-SEASON-HL3-MONTH3            30540000
303300             MOVE 'MAY      ' TO RPT-SEASON-HL3-MONTH4            30550000
303400             MOVE 'JUNE     ' TO RPT-SEASON-HL3-MONTH5            30560000
303500         WHEN 06                                                  30570000
303600             MOVE 'FEBRUARY ' TO RPT-SEASON-HL3-MONTH1            30580000
303700             MOVE 'MARCH    ' TO RPT-SEASON-HL3-MONTH2            30590000
303800             MOVE 'APRIL    ' TO RPT-SEASON-HL3-MONTH3            30600000
303900             MOVE 'MAY      ' TO RPT-SEASON-HL3-MONTH4            30610000
304000             MOVE 'JUNE     ' TO RPT-SEASON-HL3-MONTH5            30620000
304100             MOVE 'JULY     ' TO RPT-SEASON-HL3-MONTH6            30630000
304200         WHEN 07                                                  30640000
304300             MOVE 'AUGUST   ' TO RPT-SEASON-HL3-MONTH1            30650000
304400         WHEN 08                                                  30660000
304500             MOVE 'AUGUST   ' TO RPT-SEASON-HL3-MONTH1            30670000
304600             MOVE 'SEPTEMBER' TO RPT-SEASON-HL3-MONTH2            30680000
304700         WHEN 09                                                  30690000
304800             MOVE 'AUGUST   ' TO RPT-SEASON-HL3-MONTH1            30700000
304900             MOVE 'SEPTEMBER' TO RPT-SEASON-HL3-MONTH2            30710000
305000             MOVE 'OCTOBER  ' TO RPT-SEASON-HL3-MONTH3            30720000
305100         WHEN 10                                                  30730000
305200             MOVE 'AUGUST   ' TO RPT-SEASON-HL3-MONTH1            30740000
305300             MOVE 'SEPTEMBER' TO RPT-SEASON-HL3-MONTH2            30750000
305400             MOVE 'OCTOBER  ' TO RPT-SEASON-HL3-MONTH3            30760000
305500             MOVE 'NOVEMBER ' TO RPT-SEASON-HL3-MONTH4            30770000
305600         WHEN 11                                                  30780000
305700             MOVE 'AUGUST   ' TO RPT-SEASON-HL3-MONTH1            30790000
305800             MOVE 'SEPTEMBER' TO RPT-SEASON-HL3-MONTH2            30800000
305900             MOVE 'OCTOBER  ' TO RPT-SEASON-HL3-MONTH3            30810000
306000             MOVE 'NOVEMBER ' TO RPT-SEASON-HL3-MONTH4            30820000
306100             MOVE 'DECEMBER ' TO RPT-SEASON-HL3-MONTH5            30830000
306200         WHEN 12                                                  30840000
306300             MOVE 'AUGUST   ' TO RPT-SEASON-HL3-MONTH1            30850000
306400             MOVE 'SEPTEMBER' TO RPT-SEASON-HL3-MONTH2            30860000
306500             MOVE 'OCTOBER  ' TO RPT-SEASON-HL3-MONTH3            30870000
306600             MOVE 'NOVEMBER ' TO RPT-SEASON-HL3-MONTH4            30880000
306700             MOVE 'DECEMBER ' TO RPT-SEASON-HL3-MONTH5            30890000
306800             MOVE 'JANUARY  ' TO RPT-SEASON-HL3-MONTH6            30900000
306900     END-EVALUATE.                                                30910000
307000                                                                  30920000
307100******************************************************************30930000
307200*     C400-GET-DEPT-INFORMATION                                  *30940000
307300* ==> PROCESSES:                                                 *30950000
307400*     -                                                          *30960000
307500* ==> PERFORMED FROM:  B100-INITIALIZE                           *30970000
307600******************************************************************30980000
307700 C400-GET-DEPT-INFORMATION.                                       30990000
307800                                                                  31000000
307900     PERFORM                                                      31010000
308000         WITH TEST AFTER                                          31020000
308100         VARYING PV-SELECT-COUNTER                                31030000
308200         FROM 1 BY 1                                              31040000
308300         UNTIL (PV-SELECT-COUNTER > PC-MAX-RETRIES OR             31050000
308400                SQLCODE = ZERO OR                                 31060000
308500                SQLCODE = +100)                                   31070000
308600                                                                  31080000
308700         EXEC SQL                                                 31090000
308800             SELECT GMA_NBR                                       31100000
308900                  , DMA_NBR                                       31110000
309000                  , MDSEAR_DKEY                                   31120000
309100                  , MDSEAR_DESC                                   31130000
309200                  , BYR_NBR                                       31140000
309300               INTO :MDSEAR-GMA-NBR                               31150000
309400                   ,:MDSEAR-DMA-NBR                               31160000
309500                   ,:MDSEAR-DKEY                                  31170000
309600                   ,:MDSEAR-DESC                                  31180000
309700                   ,:MDSEAR-BYR-NBR                               31190000
309800               FROM TMDSEAR                                       31200000
309900              WHERE OPERCO_NBR = '03'                             31210000
310000                AND DEPT_NBR   = :WKMUMD-DEPT-NBR                 31220000
310100                AND MDSELV_CDE = 'DPT'                            31230000
310200                AND (:PV-PERIOD-END-DATE                          31240000
310300                                  BETWEEN STRT_DTE AND END_DTE)   31250000
310400         END-EXEC                                                 31260000
310500                                                                  31270000
310600         EVALUATE TRUE                                            31280000
310700             WHEN SQLCODE = ZERO                                  31290000
310800                 MOVE WKMUMD-DEPT-NBR                             31300000
310900                                   TO RPT-HL2-DEPT-NBR            31310000
311000                 MOVE MDSEAR-DESC  TO RPT-HL2-DEPT-DESC           31320000
311100                 PERFORM C410-SELECT-GMM-NAME                     31330000
311200                 PERFORM C420-SELECT-DMM-NAME                     31340000
311300                 PERFORM C430-SELECT-BUYER-NAME                   31350000
311400                                                                  31360000
311500             WHEN SQLCODE = +100                                  31370000
311600                 MOVE WKMUMD-DEPT-NBR                             31380000
311700                                   TO RPT-HL2-DEPT-NBR            31390000
311800                 MOVE PC-DEPARTMENT-NOT-FOUND                     31400000
311900                                   TO RPT-HL2-DEPT-DESC           31410000
312000                 MOVE SPACES       TO RPT-HL1-GMM-NUMBER          31420000
312100                                      RPT-HL1-GMM-NAME            31430000
312200                                      RPT-HL1-DMM-NUMBER          31440000
312300                                      RPT-HL1-DMM-NAME            31450000
312400                                      RPT-HL1-BUYER-NUMBER        31460000
312500                                      RPT-HL1-BUYER-NAME          31470000
312600                                                                  31480000
312700             WHEN SQLCODE = -904                                  31490000
312800             WHEN SQLCODE = -911                                  31500000
312900                 CONTINUE                                         31510000
313000                                                                  31520000
313100             WHEN OTHER                                           31530000
313200                 MOVE 'C400-GET-DEPT-INFORMATION'                 31540000
313300                                  TO PV-PARAGRAPH-NAME            31550000
313400                 MOVE 'TMDSEAR'   TO PV-DB2-TABLE-NAME-1          31560000
313500                 MOVE 'SELECT DEPARTMENT INFORMATION'             31570000
313600                                  TO PV-DB2-OPERATION-ATTEMPTED   31580000
313700                 DISPLAY 'MDSE DPT NBR:  ' WKMUMD-DEPT-NBR        31590000
313800                 PERFORM Z900-SQL-ABEND                           31600000
313900         END-EVALUATE                                             31610000
314000     END-PERFORM.                                                 31620000
314100                                                                  31630000
314200     IF PV-SELECT-COUNTER > PC-MAX-RETRIES                        31640000
314300         MOVE PC-DATABASE-CONFLICT TO RPT-HL2-DEPT-DESC           31650000
314400         MOVE SPACES               TO RPT-HL1-GMM-NUMBER          31660000
314500                                      RPT-HL1-GMM-NAME            31670000
314600                                      RPT-HL1-DMM-NUMBER          31680000
314700                                      RPT-HL1-DMM-NAME            31690000
314800                                      RPT-HL1-BUYER-NUMBER        31700000
314900                                      RPT-HL1-BUYER-NAME          31710000
315000     END-IF.                                                      31720000
315100                                                                  31730000
315200******************************************************************31740000
315300*     C410-SELECT-GMM-NAME                                       *31750000
315400* ==> PROCESSES:                                                 *31760000
315500*     -                                                          *31770000
315600* ==> PERFORMED FROM:                                            *31780000
315700******************************************************************31790000
315800 C410-SELECT-GMM-NAME.                                            31800000
315900                                                                  31810000
316000     PERFORM                                                      31820000
316100         WITH TEST AFTER                                          31830000
316200         VARYING PV-SELECT-COUNTER                                31840000
316300         FROM 1 BY 1                                              31850000
316400         UNTIL (PV-SELECT-COUNTER > PC-MAX-RETRIES OR             31860000
316500                SQLCODE = ZERO OR                                 31870000
316600                SQLCODE = +100)                                   31880000
316700                                                                  31890000
316800         EXEC SQL                                                 31900000
316900             SELECT C.WORKER_LAST_NAME                            31910000
317000               INTO :RSPBAR-WORKER-LAST-NAME                      31920000
317100               FROM TMDSEAR A                                     31930000
317200                  , TRSPBAR C                                     31940000
317300              WHERE A.OPERCO_NBR = '03'                           31950000
317400                AND A.GMA_NBR    = :MDSEAR-GMA-NBR                31960000
317500                AND A.MDSELV_CDE = 'GMA'                          31970000
317600                AND A.MDSEAR_DKEY = C.MDSEAR_DKEY                 31980000
317700                AND C.RSPLVL_CDE  = 'GMM'                         31990000
317800                AND (:PV-PERIOD-END-DATE                          32000000
317900                                  BETWEEN A.STRT_DTE              32010000
318000                                      AND A.END_DTE)              32020000
318100                AND (:PV-PERIOD-END-DATE                          32030000
318200                                  BETWEEN C.WORKER_STRT_DTE       32040000
318300                                      AND C.WORKER_END_DTE)       32050000
318400         END-EXEC                                                 32060000
318500                                                                  32070000
318600         EVALUATE TRUE                                            32080000
318700             WHEN SQLCODE = ZERO                                  32090000
318800                 MOVE MDSEAR-GMA-NBR                              32100000
318900                                   TO RPT-HL1-GMM-NUMBER          32110000
319000                 MOVE RSPBAR-WORKER-LAST-NAME                     32120000
319100                                   TO RPT-HL1-GMM-NAME            32130000
319200             WHEN SQLCODE = +100                                  32140000
319300                 MOVE SPACES       TO RPT-HL1-GMM-NUMBER          32150000
319400                 MOVE PC-GMM-NOT-FOUND                            32160000
319500                                   TO RPT-HL1-GMM-NAME            32170000
319600             WHEN SQLCODE = -904                                  32180000
319700             WHEN SQLCODE = -911                                  32190000
319800                 CONTINUE                                         32200000
319900                                                                  32210000
320000             WHEN OTHER                                           32220000
320100                 MOVE 'C410-SELECT-GMM-NAME'                      32230000
320200                                  TO PV-PARAGRAPH-NAME            32240000
320300                 MOVE 'TMDSEAR'   TO PV-DB2-TABLE-NAME-1          32250000
320400                 MOVE 'TRSPBAR'   TO PV-DB2-TABLE-NAME-2          32260000
320500                 MOVE 'SELECT GMM NAME'                           32270000
320600                                  TO PV-DB2-OPERATION-ATTEMPTED   32280000
320700                 PERFORM Z900-SQL-ABEND                           32290000
320800         END-EVALUATE                                             32300000
320900     END-PERFORM.                                                 32310000
321000                                                                  32320000
321100     IF PV-SELECT-COUNTER > PC-MAX-RETRIES                        32330000
321200         MOVE MDSEAR-GMA-NBR     TO RPT-HL1-GMM-NUMBER            32340000
321300         MOVE PC-DATABASE-CONFLICT                                32350000
321400                                 TO RPT-HL1-GMM-NAME              32360000
321500     END-IF.                                                      32370000
321600                                                                  32380000
321700******************************************************************32390000
321800*     C420-SELECT-DMM-NAME                                       *32400000
321900* ==> PROCESSES:                                                 *32410000
322000*     -                                                          *32420000
322100* ==> PERFORMED FROM:                                            *32430000
322200******************************************************************32440000
322300 C420-SELECT-DMM-NAME.                                            32450000
322400                                                                  32460000
322500     PERFORM                                                      32470000
322600         WITH TEST AFTER                                          32480000
322700         VARYING PV-SELECT-COUNTER                                32490000
322800         FROM 1 BY 1                                              32500000
322900         UNTIL (PV-SELECT-COUNTER > PC-MAX-RETRIES OR             32510000
323000                SQLCODE = ZERO OR                                 32520000
323100                SQLCODE = +100)                                   32530000
323200                                                                  32540000
323300         EXEC SQL                                                 32550000
323400             SELECT C.WORKER_LAST_NAME                            32560000
323500               INTO :RSPBAR-WORKER-LAST-NAME                      32570000
323600               FROM TMDSEAR A                                     32580000
323700                  , TRSPBAR C                                     32590000
323800              WHERE A.OPERCO_NBR  = '03'                          32600000
323900                AND A.DMA_NBR     = :MDSEAR-DMA-NBR               32610000
324000                AND A.MDSELV_CDE  = 'DMA'                         32620000
324100                AND A.MDSEAR_DKEY = C.MDSEAR_DKEY                 32630000
324200                AND C.RSPLVL_CDE  = 'DMM'                         32640000
324300                AND (:PV-PERIOD-END-DATE                          32650000
324400                                  BETWEEN A.STRT_DTE              32660000
324500                                      AND A.END_DTE)              32670000
324600                AND (:PV-PERIOD-END-DATE                          32680000
324700                                  BETWEEN C.WORKER_STRT_DTE       32690000
324800                                      AND C.WORKER_END_DTE)       32700000
324900         END-EXEC                                                 32710000
325000                                                                  32720000
325100         EVALUATE TRUE                                            32730000
325200             WHEN SQLCODE = ZERO                                  32740000
325300                 MOVE MDSEAR-DMA-NBR                              32750000
325400                                   TO RPT-HL1-DMM-NUMBER          32760000
325500                 MOVE RSPBAR-WORKER-LAST-NAME                     32770000
325600                                   TO RPT-HL1-DMM-NAME            32780000
325700                                                                  32790000
325800             WHEN SQLCODE = +100                                  32800000
325900                 MOVE SPACES       TO RPT-HL1-DMM-NUMBER          32810000
326000                 MOVE PC-DMM-NOT-FOUND                            32820000
326100                                   TO RPT-HL1-DMM-NAME            32830000
326200                                                                  32840000
326300             WHEN SQLCODE = -904                                  32850000
326400             WHEN SQLCODE = -911                                  32860000
326500                 CONTINUE                                         32870000
326600                                                                  32880000
326700             WHEN OTHER                                           32890000
326800                 MOVE 'C420-SELECT-DMM-NAME'                      32900000
326900                                  TO PV-PARAGRAPH-NAME            32910000
327000                 MOVE 'TMDSEAR'   TO PV-DB2-TABLE-NAME-1          32920000
327100                 MOVE 'TRSPBAR'   TO PV-DB2-TABLE-NAME-2          32930000
327200                 MOVE 'SELECT DMM NAME'                           32940000
327300                                  TO PV-DB2-OPERATION-ATTEMPTED   32950000
327400                 PERFORM Z900-SQL-ABEND                           32960000
327500         END-EVALUATE                                             32970000
327600     END-PERFORM.                                                 32980000
327700                                                                  32990000
327800     IF PV-SELECT-COUNTER > PC-MAX-RETRIES                        33000000
327900         MOVE MDSEAR-DMA-NBR       TO RPT-HL1-DMM-NUMBER          33010000
328000         MOVE PC-DATABASE-CONFLICT TO RPT-HL1-DMM-NAME            33020000
328100     END-IF.                                                      33030000
328200                                                                  33040000
328300******************************************************************33050000
328400*     C430-SELECT-BUYER-NAME                                     *33060000
328500* ==> PROCESSES:                                                 *33070000
328600*     -                                                          *33080000
328700* ==> PERFORMED FROM:                                            *33090000
328800******************************************************************33100000
328900 C430-SELECT-BUYER-NAME.                                          33110000
329000                                                                  33120000
329100     PERFORM                                                      33130000
329200         WITH TEST AFTER                                          33140000
329300         VARYING PV-SELECT-COUNTER                                33150000
329400         FROM 1 BY 1                                              33160000
329500         UNTIL (PV-SELECT-COUNTER > PC-MAX-RETRIES OR             33170000
329600                SQLCODE = ZERO OR                                 33180000
329700                SQLCODE = +100)                                   33190000
329800                                                                  33200000
329900         EXEC SQL                                                 33210000
330000             SELECT WORKER_LAST_NAME                              33220000
330100               INTO :RSPBAR-WORKER-LAST-NAME                      33230000
330200               FROM TRSPBAR                                       33240000
330300              WHERE MDSEAR_DKEY = :MDSEAR-DKEY                    33250000
330400                AND RSPLVL_CDE  = 'BYR'                           33260000
330500                AND (:PV-PERIOD-END-DATE                          33270000
330600                                  BETWEEN WORKER_STRT_DTE         33280000
330700                                      AND WORKER_END_DTE)         33290000
330800         END-EXEC                                                 33300000
330900                                                                  33310000
331000         EVALUATE TRUE                                            33320000
331100             WHEN SQLCODE = ZERO                                  33330000
331200                 MOVE MDSEAR-BYR-NBR                              33340000
331300                                   TO RPT-HL1-BUYER-NUMBER        33350000
331400                 MOVE RSPBAR-WORKER-LAST-NAME                     33360000
331500                                   TO RPT-HL1-BUYER-NAME          33370000
331600                                                                  33380000
331700             WHEN SQLCODE = +100                                  33390000
331800                 MOVE SPACES       TO RPT-HL1-BUYER-NUMBER        33400000
331900                 MOVE PC-BUYER-NOT-FOUND                          33410000
332000                                   TO RPT-HL1-BUYER-NAME          33420000
332100                                                                  33430000
332200             WHEN SQLCODE = -904                                  33440000
332300             WHEN SQLCODE = -911                                  33450000
332400                 CONTINUE                                         33460000
332500                                                                  33470000
332600             WHEN OTHER                                           33480000
332700                 MOVE 'C430-SELECT-BUYER-NAME'                    33490000
332800                                   TO PV-PARAGRAPH-NAME           33500000
332900                 MOVE 'TRSPBAR'    TO PV-DB2-TABLE-NAME-1         33510000
333000                 MOVE 'SELECT BUYER NAME'                         33520000
333100                                  TO PV-DB2-OPERATION-ATTEMPTED   33530000
333200                 PERFORM Z900-SQL-ABEND                           33540000
333300         END-EVALUATE                                             33550000
333400     END-PERFORM.                                                 33560000
333500                                                                  33570000
333600     IF PV-SELECT-COUNTER > PC-MAX-RETRIES                        33580000
333700         MOVE MDSEAR-BYR-NBR       TO RPT-HL1-BUYER-NUMBER        33590000
333800         MOVE PC-DATABASE-CONFLICT TO RPT-HL1-BUYER-NAME          33600000
333900     END-IF.                                                      33610000
334000                                                                  33620000
334100******************************************************************33630000
334200*     D100-PROCESS-PAGE-BREAK.                                   *33640000
334300* ==> PROCESSES:                                                 *33650000
334400*     - ADVANCES TO A NEW PAGE AND WRITES THE REPORT HEADINGS    *33660000
334500* ==> PERFORMED FROM:  B100-INITIALIZE                           *33670000
334600*                      B900-EOJ-ROUTINE                          *33680000
334700*                      C200-PRINT-DETAIL                         *33690000
334800******************************************************************33700000
334900 D100-PROCESS-PAGE-BREAK.                                         33710000
335000                                                                  33720000
335100     ADD PC-ONE                TO PA-PAGE-COUNTER.                33730000
335200     MOVE PA-PAGE-COUNTER      TO DP200O-PAGE-NUMBER.             33740000
335300                                                                  33750000
335400     WRITE REPORT-RECORD                                          33760000
335500         FROM DP200O-STANDRD-HEADER-200-COLS                      33770000
335600         AFTER ADVANCING PAGE.                                    33780000
335700     INITIALIZE DP200O-LASER-NEW-PAGE-INDICATR.                   33790000
335800                                                                  33800000
335900     WRITE REPORT-RECORD                                          33810000
336000         FROM REPORT-TITLE-LINE                                   33820000
336100         AFTER ADVANCING 1 LINE.                                  33830000
336200                                                                  33840000
336300     WRITE REPORT-RECORD                                          33850000
336400         FROM REPORT-TITLE-LINE2                                  33860000
336500         AFTER ADVANCING 1 LINE.                                  33870000
336600                                                                  33880000
336700     WRITE REPORT-RECORD                                          33890000
336800         FROM REPORT-HEADING-LINE1                                33900000
336900         AFTER ADVANCING 2 LINES.                                 33910000
337000                                                                  33920000
337100     IF PS-DEPT-LEVEL-REPORT                                      33930000
337200         WRITE REPORT-RECORD                                      33940000
337300             FROM REPORT-HEADING-LINE2                            33950000
337400             AFTER ADVANCING 1 LINE                               33960000
337500     ELSE                                                         33970000
337600         WRITE REPORT-RECORD                                      33980000
337700             FROM REPORT-BLANK-LINE                               33990000
337800             AFTER ADVANCING 1 LINE                               34000000
337900     END-IF.                                                      34010000
338000                                                                  34020000
338100     IF CR-VALID-SEASON                                           34030000
338200         WRITE REPORT-RECORD                                      34040000
338300             FROM REPORT-SEASONAL-HEADING-LINE3                   34050000
338400             AFTER ADVANCING 3 LINES                              34060000
338500     ELSE                                                         34070000
338600         WRITE REPORT-RECORD                                      34080000
338700             FROM REPORT-HEADING-LINE3                            34090000
338800             AFTER ADVANCING 3 LINES                              34100000
338900     END-IF.                                                      34110000
339000                                                                  34120000
339100     WRITE REPORT-RECORD                                          34130000
339200         FROM REPORT-BLANK-LINE                                   34140000
339300         AFTER ADVANCING 1 LINE.                                  34150000
339400                                                                  34160000
339500     MOVE PC-HEADER-LINE-COUNT TO PA-LINE-COUNTER.                34170000
339600                                                                  34180000
339700******************************************************************34190000
339800*     D200-DETERMING-ORGN-TYP-SUM                                *34200000
339900* ==> PROCESSES:                                                 *34210000
340000*     - DETERMINE WHETHER TO GET THE WEEKLY OR MONTHLY SUM FOR   *34220000
340100*       THE SYSTEM ORIGIN AND TYPE OF MARKDOWN.                  *34230000
340200* ==> PERFORMED FROM:  B100-INITIALIZE                           *34240000
340300******************************************************************34250000
340400 D200-DETERMINE-ORGN-TYP-SUM.                                     34260000
340500                                                                  34270000
340600     IF CR-VALID-SEASON                                           34280000
340700         PERFORM D210-GET-ORGN-TYP-MTHLY-SUM                      34290000
340800             VARYING PV-SUB                                       34300000
340900             FROM 1 BY 1                                          34310000
341000             UNTIL (PV-SUB > 6)                                   34320000
341100                OR (PV-SUB > PV-CALC-SEASON-MONTH)                34330000
341200     ELSE                                                         34340000
341300         PERFORM D220-GET-ORGN-TYP-WEEKLY-SUM                     34350000
341400             VARYING PV-SUB                                       34360000
341500             FROM 1 BY 1                                          34370000
341600             UNTIL PV-SUB > PV-FISCAL-PERIOD-WEEK                 34380000
341700     END-IF.                                                      34390000
341800                                                                  34400000
341900******************************************************************34410000
342000*     D210-GET-ORGN-TYP-MTHLY-SUM                                *34420000
342100* ==> PROCESSES:                                                 *34430000
342200*     - SELECT THE SUM FOR THE FISCAL MONTH BY SYSTEM ORIGIN AND *34440000
342300*       TYPE OF MARKDOWN.                                        *34450000
342400* ==> PERFORMED FROM:  B100-INITIALIZE                           *34460000
342500******************************************************************34470000
342600 D210-GET-ORGN-TYP-MTHLY-SUM.                                     34480000
342700                                                                  34490000
342800     MOVE PV-SUB               TO PV-FSCL-MN-NUMERIC.             34500000
342900                                                                  34510000
343000     IF CR-FALL                                                   34520000
343100         ADD 6                 TO PV-FSCL-MN-NUMERIC              34530000
343200     END-IF.                                                      34540000
343300                                                                  34550000
343400     MOVE PV-FSCL-MN-NUMERIC   TO PV-FSCL-MN-ALPHA.               34560000
343500                                                                  34570000
343600     EXEC SQL                                                     34580000
343700         SELECT SUM(TOT_MU_MD_AMT)                                34590000
343800           INTO :PV-TOT-MU-MD-AMT                                 34600000
343900           FROM                                                   34610000
344000                TWKMUMD                                           34620000
344100          WHERE                                                   34630000
344200                FSCL_MN          = :PV-FSCL-MN-ALPHA              34640000
344300            AND FSCL_YR          = :WKMUMD-FSCL-YR                34650000
344400            AND DEPT_NBR         = :WKMUMD-DEPT-NBR               34660000
344500            AND ORGN_CDE         = :WKMUMD-ORGN-CDE               34670000
344600            AND PRIC_CHG_TYP_CDE = :WKMUMD-PRIC-CHG-TYP-CDE       34680000
344700     END-EXEC.                                                    34690000
344800                                                                  34700000
344900     EVALUATE TRUE                                                34710000
345000         WHEN SQLCODE = +0                                        34720000
345100             MOVE PV-TOT-MU-MD-AMT                                34730000
345200                               TO PV-SUM-BY-ORGN-TYP (PV-SUB)     34740000
345300             ADD PV-SUM-BY-ORGN-TYP (PV-SUB)                      34750000
345400                               TO PV-SUM-BY-ORGN-TYP-TOTAL        34760000
345500                                                                  34770000
345600         WHEN SQLCODE = -305                                      34780000
345700             MOVE ZERO         TO PV-SUM-BY-ORGN-TYP (PV-SUB)     34790000
345800                                                                  34800000
345900         WHEN OTHER                                               34810000
346000             MOVE 'D210-GET-ORGN-TYP-MTHLY-SUM   '                34820000
346100                               TO PV-PARAGRAPH-NAME               34830000
346200             MOVE 'SELECT SUM BY ORIGIN/MKDNUP TYP'               34840000
346300                               TO PV-DB2-OPERATION-ATTEMPTED      34850000
346400             PERFORM Z900-SQL-ABEND                               34860000
346500     END-EVALUATE.                                                34870000
346600                                                                  34880000
346700******************************************************************34890000
346800*     D220-GET-ORGN-TYP-WEEKLY-SUM                               *34900000
346900* ==> PROCESSES:                                                 *34910000
347000*     - SELECT THE SUM FOR THE FISCAL WEEK BY SYSTEM ORIGIN AND  *34920000
347100*       TYPE OF MARKDOWN.                                        *34930000
347200* ==> PERFORMED FROM:  B100-INITIALIZE                           *34940000
347300******************************************************************34950000
347400 D220-GET-ORGN-TYP-WEEKLY-SUM.                                    34960000
347500                                                                  34970000
347600     MOVE PV-SUB               TO PV-FSCL-WK-NUMERIC.             34980000
347700     MOVE PV-FSCL-WK-NUMERIC   TO PV-FSCL-WK-ALPHA.               34990000
347800                                                                  35000000
347900     EXEC SQL                                                     35010000
348000         SELECT SUM(TOT_MU_MD_AMT)                                35020000
348100           INTO :PV-TOT-MU-MD-AMT                                 35030000
348200           FROM                                                   35040000
348300                TWKMUMD                                           35050000
348400          WHERE                                                   35060000
348500                FSCL_MN          = :WKMUMD-FSCL-MN                35070000
348600            AND FSCL_YR          = :WKMUMD-FSCL-YR                35080000
348700            AND DEPT_NBR         = :WKMUMD-DEPT-NBR               35090000
348800            AND FSCL_WK          = :PV-FSCL-WK-ALPHA              35100000
348900            AND ORGN_CDE         = :WKMUMD-ORGN-CDE               35110000
349000            AND PRIC_CHG_TYP_CDE = :WKMUMD-PRIC-CHG-TYP-CDE       35120000
349100     END-EXEC.                                                    35130000
349200                                                                  35140000
349300     EVALUATE TRUE                                                35150000
349400         WHEN SQLCODE = +0                                        35160000
349500             MOVE PV-TOT-MU-MD-AMT                                35170000
349600                               TO PV-SUM-BY-ORGN-TYP (PV-SUB)     35180000
349700             ADD PV-SUM-BY-ORGN-TYP (PV-SUB)                      35190000
349800                               TO PV-SUM-BY-ORGN-TYP-TOTAL        35200000
349900                                                                  35210000
350000         WHEN SQLCODE = -305                                      35220000
350100             MOVE ZERO         TO PV-SUM-BY-ORGN-TYP (PV-SUB)     35230000
350200                                                                  35240000
350300         WHEN OTHER                                               35250000
350400             MOVE 'D220-GET-ORGN-TYP-WEEKLY-SUM  '                35260000
350500                               TO PV-PARAGRAPH-NAME               35270000
350600             MOVE 'SELECT SUM BY ORIGIN/MKDNUP TYP'               35280000
350700                               TO PV-DB2-OPERATION-ATTEMPTED      35290000
350800             PERFORM Z900-SQL-ABEND                               35300000
350900     END-EVALUATE.                                                35310000
351000                                                                  35320000
351100******************************************************************35330000
351200*     D300-PRINT-ORGN-TYPE-TOT-LINE.                             *35340000
351300* ==> PROCESSES:                                                 *35350000
351400* ==> PERFORMED FROM:                                            *35360000
351500*                                                                *35370000
351600******************************************************************35380000
351700 D300-PRINT-ORGN-TYPE-TOT-LINE.                                   35390000
351800                                                                  35400000
351900     ADD PC-THREE              TO PA-LINE-COUNTER.                35410000
352000     IF PA-LINE-COUNTER >= PC-MAX-LINES-PER-PAGE                  35420000
352100         PERFORM D100-PROCESS-PAGE-BREAK                          35430000
352200         PERFORM E100-PRINT-ORGN-TYP-LINE                         35440000
352300         ADD PC-THREE          TO PA-LINE-COUNTER                 35450000
352400     END-IF.                                                      35460000
352500                                                                  35470000
352600     MOVE SPACES               TO RPT-MKDN-TYPE-TOT-PER-1-AMT     35480000
352700                                  RPT-MKDN-TYPE-TOT-PER-2-AMT     35490000
352800                                  RPT-MKDN-TYPE-TOT-PER-3-AMT     35500000
352900                                  RPT-MKDN-TYPE-TOT-PER-4-AMT     35510000
353000                                  RPT-MKDN-TYPE-TOT-PER-5-AMT     35520000
353100                                  RPT-MKDN-TYPE-TOT-PER-6-AMT     35530000
353200                                  RPT-MKDN-TYPE-TOT-PER-AMOUNT.   35540000
353300                                                                  35550000
353400     IF CR-VALID-SEASON                                           35560000
353500         PERFORM D310-FILL-ORGN-TYPE-TOT-AMTS                     35570000
353600             VARYING PV-SUB                                       35580000
353700             FROM 1 BY 1                                          35590000
353800             UNTIL (PV-SUB > 6)                                   35600000
353900                OR (PV-SUB > PV-CALC-SEASON-MONTH)                35610000
354000     ELSE                                                         35620000
354100         PERFORM D310-FILL-ORGN-TYPE-TOT-AMTS                     35630000
354200             VARYING PV-SUB                                       35640000
354300             FROM 1 BY 1                                          35650000
354400             UNTIL PV-SUB > PV-FISCAL-PERIOD-WEEK                 35660000
354500     END-IF.                                                      35670000
354600                                                                  35680000
354700     MOVE PV-SUM-BY-ORGN-TYP-TOTAL                                35690000
354800                               TO PV-MKDN-TYPE-TOT-PER-AMT.       35700000
354900     MOVE PV-MKDN-TYPE-TOT-PER-AMT                                35710000
355000                               TO RPT-MKDN-TYPE-TOT-PER-AMOUNT.   35720000
355100                                                                  35730000
355200     WRITE REPORT-RECORD                                          35740000
355300         FROM REPORT-MKDN-TYPE-TOTAL-LINE                         35750000
355400         AFTER ADVANCING 2 LINES.                                 35760000
355500                                                                  35770000
355600     WRITE REPORT-RECORD                                          35780000
355700         FROM REPORT-UNDERLINE                                    35790000
355800         AFTER ADVANCING 1 LINE.                                  35800000
355900                                                                  35810000
356000     MOVE ZEROES  TO PV-SUM-BY-ORGN-TYP-TOTAL.                    35820000
356100                                                                  35830000
356200******************************************************************35840000
356300*     D310-FILL-ORGN-TYPE-TOT-AMTS                               *35850000
356400* ==> PROCESSES:                                                 *35860000
356500* ==> PERFORMED FROM:                                            *35870000
356600*                                                                *35880000
356700******************************************************************35890000
356800 D310-FILL-ORGN-TYPE-TOT-AMTS.                                    35900000
356900                                                                  35910000
357000     EVALUATE PV-SUB                                              35920000
357100         WHEN 1                                                   35930000
357200             MOVE PV-SUM-BY-ORGN-TYP (PV-SUB)                     35940000
357300                       TO PV-MKDN-TYPE-TOT-PER-AMT                35950000
357400             MOVE PV-MKDN-TYPE-TOT-PER-AMT                        35960000
357500                       TO RPT-MKDN-TYPE-TOT-PER-1-AMT             35970000
357600         WHEN 2                                                   35980000
357700             MOVE PV-SUM-BY-ORGN-TYP (PV-SUB)                     35990000
357800                       TO PV-MKDN-TYPE-TOT-PER-AMT                36000000
357900             MOVE PV-MKDN-TYPE-TOT-PER-AMT                        36010000
358000                       TO RPT-MKDN-TYPE-TOT-PER-2-AMT             36020000
358100         WHEN 3                                                   36030000
358200             MOVE PV-SUM-BY-ORGN-TYP (PV-SUB)                     36040000
358300                       TO PV-MKDN-TYPE-TOT-PER-AMT                36050000
358400             MOVE PV-MKDN-TYPE-TOT-PER-AMT                        36060000
358500                       TO RPT-MKDN-TYPE-TOT-PER-3-AMT             36070000
358600         WHEN 4                                                   36080000
358700             MOVE PV-SUM-BY-ORGN-TYP (PV-SUB)                     36090000
358800                       TO PV-MKDN-TYPE-TOT-PER-AMT                36100000
358900             MOVE PV-MKDN-TYPE-TOT-PER-AMT                        36110000
359000                       TO RPT-MKDN-TYPE-TOT-PER-4-AMT             36120000
359100         WHEN 5                                                   36130000
359200             MOVE PV-SUM-BY-ORGN-TYP (PV-SUB)                     36140000
359300                       TO PV-MKDN-TYPE-TOT-PER-AMT                36150000
359400             MOVE PV-MKDN-TYPE-TOT-PER-AMT                        36160000
359500                       TO RPT-MKDN-TYPE-TOT-PER-5-AMT             36170000
359600         WHEN 6                                                   36180000
359700             MOVE PV-SUM-BY-ORGN-TYP (PV-SUB)                     36190000
359800                       TO PV-MKDN-TYPE-TOT-PER-AMT                36200000
359900             MOVE PV-MKDN-TYPE-TOT-PER-AMT                        36210000
360000                       TO RPT-MKDN-TYPE-TOT-PER-6-AMT             36220000
360100     END-EVALUATE.                                                36230000
360200                                                                  36240000
360300******************************************************************36250000
360400*     D400-PRINT-ORGN-TOT-LINE                                   *36260000
360500* ==> PROCESSES:                                                 *36270000
360600* ==> PERFORMED FROM:                                            *36280000
360700*                                                                *36290000
360800******************************************************************36300000
360900 D400-PRINT-ORGN-TOT-LINE.                                        36310000
361000                                                                  36320000
361100     ADD PC-FOUR               TO PA-LINE-COUNTER.                36330000
361200     IF PA-LINE-COUNTER >= PC-MAX-LINES-PER-PAGE                  36340000
361300         PERFORM D100-PROCESS-PAGE-BREAK                          36350000
361400         ADD PC-FOUR           TO PA-LINE-COUNTER                 36360000
361500     END-IF.                                                      36370000
361600                                                                  36380000
361700     INITIALIZE REPORT-ORIGIN-TOTAL-LINE.                         36390000
361800                                                                  36400000
361900     STRING PV-SYSTEM-ORIGIN                                      36410000
362000         DELIMITED BY SPACE                                       36420000
362100         ' '                                                      36430000
362200         PC-PRICE-CHG-LITERAL                                     36440000
362300         DELIMITED BY SIZE                                        36450000
362400         INTO RPT-ORIGIN-PRICE-CHG.                               36460000
362500                                                                  36470000
362600     MOVE ZEROES               TO PV-TOT-MU-MD-AMT.               36480000
362700                                                                  36490000
362800     PERFORM D405-DETERMINE-ORGN-AMT.                             36500000
362900                                                                  36510000
363000     IF CR-VALID-SEASON                                           36520000
363100         PERFORM D490-FILL-ORGN-TOT-AMTS                          36530000
363200            VARYING PV-SUB                                        36540000
363300            FROM 1 BY 1                                           36550000
363400            UNTIL (PV-SUB > 6)                                    36560000
363500               OR (PV-SUB > PV-CALC-SEASON-MONTH)                 36570000
363600     ELSE                                                         36580000
363700         PERFORM D490-FILL-ORGN-TOT-AMTS                          36590000
363800            VARYING PV-SUB                                        36600000
363900            FROM 1 BY 1                                           36610000
364000            UNTIL PV-SUB > PV-FISCAL-PERIOD-WEEK                  36620000
364100     END-IF.                                                      36630000
364200                                                                  36640000
364300     MOVE PV-SUM-BY-ORGN-TOTAL TO PV-MKDN-TYPE-TOT-PER-AMT.       36650000
364400     MOVE PV-MKDN-TYPE-TOT-PER-AMT                                36660000
364500                               TO RPT-ORIGIN-TOT-PER-AMOUNT.      36670000
364600                                                                  36680000
364700     WRITE REPORT-RECORD                                          36690000
364800         FROM REPORT-ORIGIN-TOTAL-LINE                            36700000
364900         AFTER ADVANCING 2 LINES.                                 36710000
365000                                                                  36720000
365100     WRITE REPORT-RECORD                                          36730000
365200         FROM REPORT-UNDERLINE                                    36740000
365300         AFTER ADVANCING 1 LINE.                                  36750000
365400                                                                  36760000
365500     WRITE REPORT-RECORD                                          36770000
365600         FROM REPORT-BLANK-LINE                                   36780000
365700         AFTER ADVANCING 1 LINE.                                  36790000
365800                                                                  36800000
365900     MOVE ZEROES  TO PV-SUM-BY-ORGN-TOTAL.                        36810000
366000                                                                  36820000
366100******************************************************************36830000
366200*     D405-DETERMINE-ORGN-AMT                                    *36840000
366300* ==> PROCESSES:                                                 *36850000
366400* ==> PERFORMED FROM:                                            *36860000
366500*                                                                *36870000
366600******************************************************************36880000
366700 D405-DETERMINE-ORGN-AMT.                                         36890000
366800                                                                  36900000
366900     IF CR-VALID-SEASON                                           36910000
367000         IF PS-DEPT-LEVEL-REPORT                                  36920000
367100             PERFORM D450-GET-ORGN-MONTHLY-SUM                    36930000
367200                 VARYING PV-SUB                                   36940000
367300                 FROM 1 BY 1                                      36950000
367400                 UNTIL (PV-SUB > 6)                               36960000
367500                    OR (PV-SUB > PV-CALC-SEASON-MONTH)            36970000
367600         ELSE                                                     36980000
367700             EVALUATE TRUE                                        36990000
367800                 WHEN PS-DMM-SUMMARY-LVL                          37000000
367900                     PERFORM D460-GET-DMM-ORGN-MONTHLY-SUM        37010000
368000                         VARYING PV-SUB                           37020000
368100                         FROM 1 BY 1                              37030000
368200                         UNTIL (PV-SUB > 6)                       37040000
368300                            OR (PV-SUB > PV-CALC-SEASON-MONTH)    37050000
368400                 WHEN PS-GMM-SUMMARY-LVL                          37060000
368500                     PERFORM D470-GET-GMM-ORGN-MONTHLY-SUM        37070000
368600                         VARYING PV-SUB                           37080000
368700                         FROM 1 BY 1                              37090000
368800                         UNTIL (PV-SUB > 6)                       37100000
368900                            OR (PV-SUB > PV-CALC-SEASON-MONTH)    37110000
369000                 WHEN PS-CORP-SUMMARY-LVL                         37120000
369100                     PERFORM D480-GET-CORP-ORGN-MONTHLY-SUM       37130000
369200                         VARYING PV-SUB                           37140000
369300                         FROM 1 BY 1                              37150000
369400                         UNTIL (PV-SUB > 6)                       37160000
369500                            OR (PV-SUB > PV-CALC-SEASON-MONTH)    37170000
369600             END-EVALUATE                                         37180000
369700         END-IF                                                   37190000
369800     ELSE                                                         37200000
369900         IF PS-DEPT-LEVEL-REPORT                                  37210000
370000             PERFORM D410-GET-ORGN-WEEKLY-SUM                     37220000
370100                 VARYING PV-SUB                                   37230000
370200                 FROM 1 BY 1                                      37240000
370300                 UNTIL PV-SUB > PV-FISCAL-PERIOD-WEEK             37250000
370400         ELSE                                                     37260000
370500             EVALUATE TRUE                                        37270000
370600                 WHEN PS-DMM-SUMMARY-LVL                          37280000
370700                     PERFORM D420-GET-DMM-ORGN-WEEKLY-SUM         37290000
370800                         VARYING PV-SUB                           37300000
370900                         FROM 1 BY 1                              37310000
371000                         UNTIL PV-SUB > PV-FISCAL-PERIOD-WEEK     37320000
371100                 WHEN PS-GMM-SUMMARY-LVL                          37330000
371200                     PERFORM D430-GET-GMM-ORGN-WEEKLY-SUM         37340000
371300                         VARYING PV-SUB                           37350000
371400                         FROM 1 BY 1                              37360000
371500                         UNTIL PV-SUB > PV-FISCAL-PERIOD-WEEK     37370000
371600                 WHEN PS-CORP-SUMMARY-LVL                         37380000
371700                     PERFORM D440-GET-CORP-ORGN-WEEKLY-SUM        37390000
371800                         VARYING PV-SUB                           37400000
371900                         FROM 1 BY 1                              37410000
372000                         UNTIL PV-SUB > PV-FISCAL-PERIOD-WEEK     37420000
372100             END-EVALUATE                                         37430000
372200         END-IF                                                   37440000
372300     END-IF.                                                      37450000
372400                                                                  37460000
372500******************************************************************37470000
372600*     D410-GET-ORGN-WEEKLY-SUM                                   *37480000
372700* ==> PROCESSES:                                                 *37490000
372800*     - SELECT THE SUM FOR THE FISCAL WEEK BY SYSTEM ORIGIN      *37500000
372900* ==> PERFORMED FROM:                                            *37510000
373000******************************************************************37520000
373100 D410-GET-ORGN-WEEKLY-SUM.                                        37530000
373200                                                                  37540000
373300     MOVE PV-SUB               TO PV-FSCL-WK-NUMERIC.             37550000
373400     MOVE PV-FSCL-WK-NUMERIC   TO PV-FSCL-WK-ALPHA.               37560000
373500                                                                  37570000
373600     EXEC SQL                                                     37580000
373700         SELECT SUM(TOT_MU_MD_AMT)                                37590000
373800           INTO :PV-TOT-MU-MD-AMT                                 37600000
373900           FROM                                                   37610000
374000                TWKMUMD                                           37620000
374100          WHERE                                                   37630000
374200                FSCL_MN          = :WKMUMD-FSCL-MN                37640000
374300            AND FSCL_YR          = :WKMUMD-FSCL-YR                37650000
374400            AND DEPT_NBR         = :PV-HOLD-DEPT-NBR              37660000
374500            AND FSCL_WK          = :PV-FSCL-WK-ALPHA              37670000
374600            AND ORGN_CDE         = :PV-HOLD-ORGN-CDE              37680000
374700     END-EXEC.                                                    37690000
374800                                                                  37700000
374900     EVALUATE TRUE                                                37710000
375000         WHEN SQLCODE = +0                                        37720000
375100             MOVE PV-TOT-MU-MD-AMT                                37730000
375200                               TO PV-SUM-BY-ORGN (PV-SUB)         37740000
375300             ADD PV-SUM-BY-ORGN (PV-SUB)                          37750000
375400                               TO PV-SUM-BY-ORGN-TOTAL            37760000
375500             MOVE ZEROES       TO PV-TOT-MU-MD-AMT                37770000
375600                                                                  37780000
375700         WHEN SQLCODE = -305                                      37790000
375800             MOVE ZERO         TO PV-SUM-BY-ORGN (PV-SUB)         37800000
375900                                                                  37810000
376000         WHEN OTHER                                               37820000
376100             MOVE 'D410-GET-ORGN-WEEKLY-SUM  '                    37830000
376200                               TO PV-PARAGRAPH-NAME               37840000
376300             MOVE 'SELECT SUM BY ORIGIN           '               37850000
376400                               TO PV-DB2-OPERATION-ATTEMPTED      37860000
376500             PERFORM Z900-SQL-ABEND                               37870000
376600     END-EVALUATE.                                                37880000
376700                                                                  37890000
376800******************************************************************37900000
376900*     D420-GET-DMM-ORGN-WEEKLY-SUM                               *37910000
377000* ==> PROCESSES:                                                 *37920000
377100*     - SELECT THE SUM FOR THE FISCAL WEEK BY SYSTEM ORIGIN      *37930000
377200*       AT THE DMM LEVEL                                         *37940000
377300* ==> PERFORMED FROM:                                            *37950000
377400******************************************************************37960000
377500 D420-GET-DMM-ORGN-WEEKLY-SUM.                                    37970000
377600                                                                  37980000
377700     MOVE PV-SUB               TO PV-FSCL-WK-NUMERIC.             37990000
377800     MOVE PV-FSCL-WK-NUMERIC   TO PV-FSCL-WK-ALPHA.               38000000
377900                                                                  38010000
378000     EXEC SQL                                                     38020000
378100         SELECT SUM(TOT_MU_MD_AMT)                                38030000
378200           INTO :PV-TOT-MU-MD-AMT                                 38040000
378300           FROM                                                   38050000
378400                TMDSEAR A                                         38060000
378500              , TWKMUMD M                                         38070000
378600          WHERE                                                   38080000
378700                A.OPERCO_NBR       = '03'                         38090000
378800            AND A.GMA_NBR          = :PV-HOLD-GMA-NBR             38100000
378900            AND A.DMA_NBR          = :PV-HOLD-DMA-NBR             38110000
379000            AND A.MDSELV_CDE       = 'DPT'                        38120000
379100            AND A.DEPT_NBR         = M.DEPT_NBR                   38130000
379200            AND (CURRENT DATE                                     38140000
379300                                 BETWEEN A.STRT_DTE AND A.END_DTE)38150000
379400            AND FSCL_MN          = :WKMUMD-FSCL-MN                38160000
379500            AND FSCL_YR          = :WKMUMD-FSCL-YR                38170000
379600            AND FSCL_WK          = :PV-FSCL-WK-ALPHA              38180000
379700            AND ORGN_CDE         = :PV-HOLD-ORGN-CDE              38190000
379800     END-EXEC.                                                    38200000
379900                                                                  38210000
380000     EVALUATE TRUE                                                38220000
380100         WHEN SQLCODE = +0                                        38230000
380200             MOVE PV-TOT-MU-MD-AMT                                38240000
380300                               TO PV-SUM-BY-ORGN (PV-SUB)         38250000
380400             ADD PV-SUM-BY-ORGN (PV-SUB)                          38260000
380500                               TO PV-SUM-BY-ORGN-TOTAL            38270000
380600             MOVE ZEROES       TO PV-TOT-MU-MD-AMT                38280000
380700                                                                  38290000
380800         WHEN SQLCODE = -305                                      38300000
380900             MOVE ZERO         TO PV-SUM-BY-ORGN (PV-SUB)         38310000
381000                                                                  38320000
381100         WHEN OTHER                                               38330000
381200             MOVE 'D420-GET-DMM-ORGN-WEEKLY-SUM'                  38340000
381300                               TO PV-PARAGRAPH-NAME               38350000
381400             MOVE 'SELECT SUM BY ORIGIN AT DMM LVL'               38360000
381500                               TO PV-DB2-OPERATION-ATTEMPTED      38370000
381600             PERFORM Z900-SQL-ABEND                               38380000
381700     END-EVALUATE.                                                38390000
381800                                                                  38400000
381900******************************************************************38410000
382000*     D430-GET-GMM-ORGN-WEEKLY-SUM                               *38420000
382100* ==> PROCESSES:                                                 *38430000
382200*     - SELECT THE SUM FOR THE FISCAL WEEK BY SYSTEM ORIGIN      *38440000
382300*       AT THE GMM LEVEL                                         *38450000
382400* ==> PERFORMED FROM:                                            *38460000
382500******************************************************************38470000
382600 D430-GET-GMM-ORGN-WEEKLY-SUM.                                    38480000
382700                                                                  38490000
382800     MOVE PV-SUB               TO PV-FSCL-WK-NUMERIC.             38500000
382900     MOVE PV-FSCL-WK-NUMERIC   TO PV-FSCL-WK-ALPHA.               38510000
383000                                                                  38520000
383100     EXEC SQL                                                     38530000
383200         SELECT SUM(TOT_MU_MD_AMT)                                38540000
383300           INTO :PV-TOT-MU-MD-AMT                                 38550000
383400           FROM                                                   38560000
383500                TMDSEAR A                                         38570000
383600              , TWKMUMD M                                         38580000
383700          WHERE                                                   38590000
383800                A.OPERCO_NBR       = '03'                         38600000
383900            AND A.GMA_NBR          = :PV-HOLD-GMA-NBR             38610000
384000            AND A.MDSELV_CDE       = 'DPT'                        38620000
384100            AND A.DEPT_NBR         = M.DEPT_NBR                   38630000
384200            AND (CURRENT DATE                                     38640000
384300                                 BETWEEN A.STRT_DTE AND A.END_DTE)38650000
384400            AND FSCL_MN          = :WKMUMD-FSCL-MN                38660000
384500            AND FSCL_YR          = :WKMUMD-FSCL-YR                38670000
384600            AND FSCL_WK          = :PV-FSCL-WK-ALPHA              38680000
384700            AND ORGN_CDE         = :PV-HOLD-ORGN-CDE              38690000
384800     END-EXEC.                                                    38700000
384900                                                                  38710000
385000     EVALUATE TRUE                                                38720000
385100         WHEN SQLCODE = +0                                        38730000
385200             MOVE PV-TOT-MU-MD-AMT                                38740000
385300                               TO PV-SUM-BY-ORGN (PV-SUB)         38750000
385400             ADD PV-SUM-BY-ORGN (PV-SUB)                          38760000
385500                               TO PV-SUM-BY-ORGN-TOTAL            38770000
385600             MOVE ZEROES       TO PV-TOT-MU-MD-AMT                38780000
385700                                                                  38790000
385800         WHEN SQLCODE = -305                                      38800000
385900             MOVE ZERO         TO PV-SUM-BY-ORGN (PV-SUB)         38810000
386000                                                                  38820000
386100         WHEN OTHER                                               38830000
386200             MOVE 'D430-GET-GMM-ORGN-WEEKLY-SUM'                  38840000
386300                               TO PV-PARAGRAPH-NAME               38850000
386400             MOVE 'SELECT SUM BY ORIGIN AT GMM LVL'               38860000
386500                               TO PV-DB2-OPERATION-ATTEMPTED      38870000
386600             PERFORM Z900-SQL-ABEND                               38880000
386700     END-EVALUATE.                                                38890000
386800                                                                  38900000
386900******************************************************************38910000
387000*     D440-GET-CORP-ORGN-WEEKLY-SUM                              *38920000
387100* ==> PROCESSES:                                                 *38930000
387200*     - SELECT THE SUM FOR THE FISCAL WEEK BY SYSTEM ORIGIN      *38940000
387300*       AT THE CORPORATE LEVEL                                   *38950000
387400* ==> PERFORMED FROM:                                            *38960000
387500******************************************************************38970000
387600 D440-GET-CORP-ORGN-WEEKLY-SUM.                                   38980000
387700                                                                  38990000
387800     MOVE PV-SUB               TO PV-FSCL-WK-NUMERIC.             39000000
387900     MOVE PV-FSCL-WK-NUMERIC   TO PV-FSCL-WK-ALPHA.               39010000
388000                                                                  39020000
388100     EXEC SQL                                                     39030000
388200         SELECT SUM(TOT_MU_MD_AMT)                                39040000
388300           INTO :PV-TOT-MU-MD-AMT                                 39050000
388400           FROM                                                   39060000
388500                TMDSEAR A                                         39070000
388600              , TWKMUMD M                                         39080000
388700          WHERE                                                   39090000
388800                A.OPERCO_NBR       = '03'                         39100000
388900            AND A.MDSELV_CDE       = 'DPT'                        39110000
389000            AND A.DEPT_NBR         = M.DEPT_NBR                   39120000
389100            AND (CURRENT DATE                                     39130000
389200                                 BETWEEN A.STRT_DTE AND A.END_DTE)39140000
389300            AND FSCL_MN          = :WKMUMD-FSCL-MN                39150000
389400            AND FSCL_YR          = :WKMUMD-FSCL-YR                39160000
389500            AND FSCL_WK          = :PV-FSCL-WK-ALPHA              39170000
389600            AND ORGN_CDE         = :PV-HOLD-ORGN-CDE              39180000
389700     END-EXEC.                                                    39190000
389800                                                                  39200000
389900     EVALUATE TRUE                                                39210000
390000         WHEN SQLCODE = +0                                        39220000
390100             MOVE PV-TOT-MU-MD-AMT                                39230000
390200                               TO PV-SUM-BY-ORGN (PV-SUB)         39240000
390300             ADD PV-SUM-BY-ORGN (PV-SUB)                          39250000
390400                               TO PV-SUM-BY-ORGN-TOTAL            39260000
390500             MOVE ZEROES       TO PV-TOT-MU-MD-AMT                39270000
390600                                                                  39280000
390700         WHEN SQLCODE = -305                                      39290000
390800             MOVE ZERO         TO PV-SUM-BY-ORGN (PV-SUB)         39300000
390900                                                                  39310000
391000         WHEN OTHER                                               39320000
391100             MOVE 'D440-GET-CORP-ORGN-WEEKLY-SUM'                 39330000
391200                               TO PV-PARAGRAPH-NAME               39340000
391300             MOVE 'SELECT SUM BY ORIGIN AT CORP LVL'              39350000
391400                               TO PV-DB2-OPERATION-ATTEMPTED      39360000
391500             PERFORM Z900-SQL-ABEND                               39370000
391600     END-EVALUATE.                                                39380000
391700                                                                  39390000
391800******************************************************************39400000
391900*     D450-GET-ORGN-MONTHLY-SUM                                  *39410000
392000* ==> PROCESSES:                                                 *39420000
392100*     - SELECT THE SUM FOR THE FISCAL MONTH BY SYSTEM ORIGIN     *39430000
392200* ==> PERFORMED FROM:                                            *39440000
392300******************************************************************39450000
392400 D450-GET-ORGN-MONTHLY-SUM.                                       39460000
392500                                                                  39470000
392600     MOVE PV-SUB               TO PV-FSCL-MN-NUMERIC.             39480000
392700                                                                  39490000
392800     IF CR-FALL                                                   39500000
392900         ADD 6                 TO PV-FSCL-MN-NUMERIC              39510000
393000     END-IF.                                                      39520000
393100                                                                  39530000
393200     MOVE PV-FSCL-MN-NUMERIC   TO PV-FSCL-MN-ALPHA.               39540000
393300                                                                  39550000
393400     EXEC SQL                                                     39560000
393500         SELECT SUM(TOT_MU_MD_AMT)                                39570000
393600           INTO :PV-TOT-MU-MD-AMT                                 39580000
393700           FROM                                                   39590000
393800                TWKMUMD                                           39600000
393900          WHERE                                                   39610000
394000                FSCL_MN          = :PV-FSCL-MN-ALPHA              39620000
394100            AND FSCL_YR          = :WKMUMD-FSCL-YR                39630000
394200            AND DEPT_NBR         = :PV-HOLD-DEPT-NBR              39640000
394300            AND ORGN_CDE         = :PV-HOLD-ORGN-CDE              39650000
394400     END-EXEC.                                                    39660000
394500                                                                  39670000
394600     EVALUATE TRUE                                                39680000
394700         WHEN SQLCODE = +0                                        39690000
394800             MOVE PV-TOT-MU-MD-AMT                                39700000
394900                               TO PV-SUM-BY-ORGN (PV-SUB)         39710000
395000             ADD PV-SUM-BY-ORGN (PV-SUB)                          39720000
395100                               TO PV-SUM-BY-ORGN-TOTAL            39730000
395200             MOVE ZEROES       TO PV-TOT-MU-MD-AMT                39740000
395300                                                                  39750000
395400         WHEN SQLCODE = -305                                      39760000
395500             MOVE ZERO         TO PV-SUM-BY-ORGN (PV-SUB)         39770000
395600                                                                  39780000
395700         WHEN OTHER                                               39790000
395800             MOVE 'D450-GET-ORGN-MONTHLY-SUM '                    39800000
395900                               TO PV-PARAGRAPH-NAME               39810000
396000             MOVE 'SELECT SUM BY ORIGIN - MONTHLY '               39820000
396100                               TO PV-DB2-OPERATION-ATTEMPTED      39830000
396200             PERFORM Z900-SQL-ABEND                               39840000
396300     END-EVALUATE.                                                39850000
396400                                                                  39860000
396500******************************************************************39870000
396600*     D460-GET-DMM-ORGN-MONTHLY-SUM                              *39880000
396700* ==> PROCESSES:                                                 *39890000
396800*     - SELECT THE SUM FOR THE FISCAL MONTH BY SYSTEM ORIGIN     *39900000
396900*       AT THE DMM LEVEL                                         *39910000
397000* ==> PERFORMED FROM:                                            *39920000
397100******************************************************************39930000
397200 D460-GET-DMM-ORGN-MONTHLY-SUM.                                   39940000
397300                                                                  39950000
397400     MOVE PV-SUB               TO PV-FSCL-MN-NUMERIC.             39960000
397500                                                                  39970000
397600     IF CR-FALL                                                   39980000
397700         ADD 6                 TO PV-FSCL-MN-NUMERIC              39990000
397800     END-IF.                                                      40000000
397900                                                                  40010000
398000     MOVE PV-FSCL-MN-NUMERIC   TO PV-FSCL-MN-ALPHA.               40020000
398100                                                                  40030000
398200     EXEC SQL                                                     40040000
398300         SELECT SUM(TOT_MU_MD_AMT)                                40050000
398400           INTO :PV-TOT-MU-MD-AMT                                 40060000
398500           FROM                                                   40070000
398600                TMDSEAR A                                         40080000
398700              , TWKMUMD M                                         40090000
398800          WHERE                                                   40100000
398900                A.OPERCO_NBR       = '03'                         40110000
399000            AND A.GMA_NBR          = :PV-HOLD-GMA-NBR             40120000
399100            AND A.DMA_NBR          = :PV-HOLD-DMA-NBR             40130000
399200            AND A.MDSELV_CDE       = 'DPT'                        40140000
399300            AND A.DEPT_NBR         = M.DEPT_NBR                   40150000
399400            AND (CURRENT DATE                                     40160000
399500                                 BETWEEN A.STRT_DTE AND A.END_DTE)40170000
399600            AND FSCL_MN          = :PV-FSCL-MN-ALPHA              40180000
399700            AND FSCL_YR          = :WKMUMD-FSCL-YR                40190000
399800            AND ORGN_CDE         = :PV-HOLD-ORGN-CDE              40200000
399900     END-EXEC.                                                    40210000
400000                                                                  40220000
400100     EVALUATE TRUE                                                40230000
400200         WHEN SQLCODE = +0                                        40240000
400300             MOVE PV-TOT-MU-MD-AMT                                40250000
400400                               TO PV-SUM-BY-ORGN (PV-SUB)         40260000
400500             ADD PV-SUM-BY-ORGN (PV-SUB)                          40270000
400600                               TO PV-SUM-BY-ORGN-TOTAL            40280000
400700             MOVE ZEROES       TO PV-TOT-MU-MD-AMT                40290000
400800                                                                  40300000
400900         WHEN SQLCODE = -305                                      40310000
401000             MOVE ZERO         TO PV-SUM-BY-ORGN (PV-SUB)         40320000
401100                                                                  40330000
401200         WHEN OTHER                                               40340000
401300             MOVE 'D460-GET-DMM-ORGN-MONTHLY-SUM'                 40350000
401400                               TO PV-PARAGRAPH-NAME               40360000
401500             MOVE 'SELECT SUM BY ORIGIN AT DMM LVL'               40370000
401600                               TO PV-DB2-OPERATION-ATTEMPTED      40380000
401700             PERFORM Z900-SQL-ABEND                               40390000
401800     END-EVALUATE.                                                40400000
401900                                                                  40410000
402000******************************************************************40420000
402100*     D470-GET-GMM-ORGN-MONTHLY-SUM                              *40430000
402200* ==> PROCESSES:                                                 *40440000
402300*     - SELECT THE SUM FOR THE FISCAL MONTH BY SYSTEM ORIGIN     *40450000
402400*       AT THE GMM LEVEL                                         *40460000
402500* ==> PERFORMED FROM:                                            *40470000
402600******************************************************************40480000
402700 D470-GET-GMM-ORGN-MONTHLY-SUM.                                   40490000
402800                                                                  40500000
402900     MOVE PV-SUB               TO PV-FSCL-MN-NUMERIC.             40510000
403000                                                                  40520000
403100     IF CR-FALL                                                   40530000
403200         ADD 6                 TO PV-FSCL-MN-NUMERIC              40540000
403300     END-IF.                                                      40550000
403400                                                                  40560000
403500     MOVE PV-FSCL-MN-NUMERIC   TO PV-FSCL-MN-ALPHA.               40570000
403600                                                                  40580000
403700     EXEC SQL                                                     40590000
403800         SELECT SUM(TOT_MU_MD_AMT)                                40600000
403900           INTO :PV-TOT-MU-MD-AMT                                 40610000
404000           FROM                                                   40620000
404100                TMDSEAR A                                         40630000
404200              , TWKMUMD M                                         40640000
404300          WHERE                                                   40650000
404400                A.OPERCO_NBR       = '03'                         40660000
404500            AND A.GMA_NBR          = :PV-HOLD-GMA-NBR             40670000
404600            AND A.MDSELV_CDE       = 'DPT'                        40680000
404700            AND A.DEPT_NBR         = M.DEPT_NBR                   40690000
404800            AND (CURRENT DATE                                     40700000
404900                                 BETWEEN A.STRT_DTE AND A.END_DTE)40710000
405000            AND FSCL_MN          = :PV-FSCL-MN-ALPHA              40720000
405100            AND FSCL_YR          = :WKMUMD-FSCL-YR                40730000
405200            AND ORGN_CDE         = :PV-HOLD-ORGN-CDE              40740000
405300     END-EXEC.                                                    40750000
405400                                                                  40760000
405500     EVALUATE TRUE                                                40770000
405600         WHEN SQLCODE = +0                                        40780000
405700             MOVE PV-TOT-MU-MD-AMT                                40790000
405800                               TO PV-SUM-BY-ORGN (PV-SUB)         40800000
405900             ADD PV-SUM-BY-ORGN (PV-SUB)                          40810000
406000                               TO PV-SUM-BY-ORGN-TOTAL            40820000
406100             MOVE ZEROES       TO PV-TOT-MU-MD-AMT                40830000
406200                                                                  40840000
406300         WHEN SQLCODE = -305                                      40850000
406400             MOVE ZERO         TO PV-SUM-BY-ORGN (PV-SUB)         40860000
406500                                                                  40870000
406600         WHEN OTHER                                               40880000
406700             MOVE 'D470-GET-GMM-ORGN-MONTHLY-SUM'                 40890000
406800                               TO PV-PARAGRAPH-NAME               40900000
406900             MOVE 'SELECT SUM BY ORIGIN AT GMM LVL'               40910000
407000                               TO PV-DB2-OPERATION-ATTEMPTED      40920000
407100             PERFORM Z900-SQL-ABEND                               40930000
407200     END-EVALUATE.                                                40940000
407300                                                                  40950000
407400******************************************************************40960000
407500*     D480-GET-CORP-ORGN-MONTHLY-SUM                             *40970000
407600* ==> PROCESSES:                                                 *40980000
407700*     - SELECT THE SUM FOR THE FISCAL MONTH BY SYSTEM ORIGIN     *40990000
407800*       AT THE CORPORATE LEVEL                                   *41000000
407900* ==> PERFORMED FROM:                                            *41010000
408000******************************************************************41020000
408100 D480-GET-CORP-ORGN-MONTHLY-SUM.                                  41030000
408200                                                                  41040000
408300     MOVE PV-SUB               TO PV-FSCL-MN-NUMERIC.             41050000
408400                                                                  41060000
408500     IF CR-FALL                                                   41070000
408600         ADD 6                 TO PV-FSCL-MN-NUMERIC              41080000
408700     END-IF.                                                      41090000
408800                                                                  41100000
408900     MOVE PV-FSCL-MN-NUMERIC   TO PV-FSCL-MN-ALPHA.               41110000
409000                                                                  41120000
409100     EXEC SQL                                                     41130000
409200         SELECT SUM(TOT_MU_MD_AMT)                                41140000
409300           INTO :PV-TOT-MU-MD-AMT                                 41150000
409400           FROM                                                   41160000
409500                TMDSEAR A                                         41170000
409600              , TWKMUMD M                                         41180000
409700          WHERE                                                   41190000
409800                A.OPERCO_NBR       = '03'                         41200000
409900            AND A.MDSELV_CDE       = 'DPT'                        41210000
410000            AND A.DEPT_NBR         = M.DEPT_NBR                   41220000
410100            AND (CURRENT DATE                                     41230000
410200                                 BETWEEN A.STRT_DTE AND A.END_DTE)41240000
410300            AND FSCL_MN          = :PV-FSCL-MN-ALPHA              41250000
410400            AND FSCL_YR          = :WKMUMD-FSCL-YR                41260000
410500            AND ORGN_CDE         = :PV-HOLD-ORGN-CDE              41270000
410600     END-EXEC.                                                    41280000
410700                                                                  41290000
410800     EVALUATE TRUE                                                41300000
410900         WHEN SQLCODE = +0                                        41310000
411000             MOVE PV-TOT-MU-MD-AMT                                41320000
411100                               TO PV-SUM-BY-ORGN (PV-SUB)         41330000
411200             ADD PV-SUM-BY-ORGN (PV-SUB)                          41340000
411300                               TO PV-SUM-BY-ORGN-TOTAL            41350000
411400             MOVE ZEROES       TO PV-TOT-MU-MD-AMT                41360000
411500                                                                  41370000
411600         WHEN SQLCODE = -305                                      41380000
411700             MOVE ZERO         TO PV-SUM-BY-ORGN (PV-SUB)         41390000
411800                                                                  41400000
411900         WHEN OTHER                                               41410000
412000             MOVE 'D480-GET-CORP-ORGN-MONTHLY-SUM'                41420000
412100                               TO PV-PARAGRAPH-NAME               41430000
412200             MOVE 'SELECT SUM BY ORIGIN AT CORP LVL'              41440000
412300                               TO PV-DB2-OPERATION-ATTEMPTED      41450000
412400             PERFORM Z900-SQL-ABEND                               41460000
412500     END-EVALUATE.                                                41470000
412600                                                                  41480000
412700******************************************************************41490000
412800*     D490-FILL-ORGN-TOT-AMTS                                    *41500000
412900* ==> PROCESSES:                                                 *41510000
413000* ==> PERFORMED FROM:                                            *41520000
413100*                                                                *41530000
413200******************************************************************41540000
413300 D490-FILL-ORGN-TOT-AMTS.                                         41550000
413400                                                                  41560000
413500     EVALUATE PV-SUB                                              41570000
413600         WHEN 01                                                  41580000
413700             MOVE PV-SUM-BY-ORGN (PV-SUB)                         41590000
413800                        TO PV-MKDN-TYPE-TOT-PER-AMT               41600000
413900             MOVE PV-MKDN-TYPE-TOT-PER-AMT                        41610000
414000                        TO RPT-ORIGIN-TOT-PER-1-AMT               41620000
414100         WHEN 02                                                  41630000
414200             MOVE PV-SUM-BY-ORGN (PV-SUB)                         41640000
414300                        TO PV-MKDN-TYPE-TOT-PER-AMT               41650000
414400             MOVE PV-MKDN-TYPE-TOT-PER-AMT                        41660000
414500                        TO RPT-ORIGIN-TOT-PER-2-AMT               41670000
414600         WHEN 03                                                  41680000
414700             MOVE PV-SUM-BY-ORGN (PV-SUB)                         41690000
414800                        TO PV-MKDN-TYPE-TOT-PER-AMT               41700000
414900             MOVE PV-MKDN-TYPE-TOT-PER-AMT                        41710000
415000                        TO RPT-ORIGIN-TOT-PER-3-AMT               41720000
415100         WHEN 04                                                  41730000
415200             MOVE PV-SUM-BY-ORGN (PV-SUB)                         41740000
415300                        TO PV-MKDN-TYPE-TOT-PER-AMT               41750000
415400             MOVE PV-MKDN-TYPE-TOT-PER-AMT                        41760000
415500                        TO RPT-ORIGIN-TOT-PER-4-AMT               41770000
415600         WHEN 05                                                  41780000
415700             MOVE PV-SUM-BY-ORGN (PV-SUB)                         41790000
415800                        TO PV-MKDN-TYPE-TOT-PER-AMT               41800000
415900             MOVE PV-MKDN-TYPE-TOT-PER-AMT                        41810000
416000                        TO RPT-ORIGIN-TOT-PER-5-AMT               41820000
416100         WHEN 06                                                  41830000
416200             MOVE PV-SUM-BY-ORGN (PV-SUB)                         41840000
416300                        TO PV-MKDN-TYPE-TOT-PER-AMT               41850000
416400             MOVE PV-MKDN-TYPE-TOT-PER-AMT                        41860000
416500                        TO RPT-ORIGIN-TOT-PER-6-AMT               41870000
416600     END-EVALUATE.                                                41880000
416700                                                                  41890000
416800******************************************************************41900000
416900*     D500-PRINT-DEPT-TOT-LINE                                   *41910000
417000* ==> PROCESSES:                                                 *41920000
417100* ==> PERFORMED FROM:                                            *41930000
417200*                                                                *41940000
417300******************************************************************41950000
417400 D500-PRINT-DEPT-TOT-LINE.                                        41960000
417500                                                                  41970000
417600     ADD +7                 TO PA-LINE-COUNTER.                   41980000
417700     IF PA-LINE-COUNTER >= PC-MAX-LINES-PER-PAGE                  41990000
417800         PERFORM D100-PROCESS-PAGE-BREAK                          42000000
417900         ADD PC-THREE       TO PA-LINE-COUNTER                    42010000
418000     END-IF.                                                      42020000
418100                                                                  42030000
418200     MOVE PV-HOLD-DEPT-NBR     TO RPT-DEPT-TL-DEPT-NBR.           42040000
418300                                                                  42050000
418400     WRITE REPORT-RECORD                                          42060000
418500         FROM REPORT-DEPT-HEADING-TOT-LINE                        42070000
418600         AFTER ADVANCING 2 LINES.                                 42080000
418700                                                                  42090000
418800**** SUM ONLY THE DEPARTMENT MARKDOWNS AND MARKDOWN/CANCELLATIONS 42100000
418900                                                                  42110000
419000     MOVE ZEROES               TO PV-TOT-MU-MD-AMT.               42120000
419100                                                                  42130000
419200     IF CR-VALID-SEASON                                           42140000
419300         PERFORM D560-GET-DEPT-MKDN-MONTHLY-SUM                   42150000
419400             VARYING PV-SUB                                       42160000
419500             FROM 1 BY 1                                          42170000
419600             UNTIL (PV-SUB > 6)                                   42180000
419700                OR (PV-SUB > PV-CALC-SEASON-MONTH)                42190000
419800                                                                  42200000
419900         PERFORM D540-POPULATE-DEPT-TOTAL-AMTS                    42210000
420000             VARYING PV-SUB                                       42220000
420100             FROM 1 BY 1                                          42230000
420200             UNTIL (PV-SUB > 6)                                   42240000
420300                OR (PV-SUB > PV-CALC-SEASON-MONTH)                42250000
420400     ELSE                                                         42260000
420500         PERFORM D510-GET-DEPT-MKDN-WEEKLY-SUM                    42270000
420600             VARYING PV-SUB                                       42280000
420700             FROM 1 BY 1                                          42290000
420800             UNTIL PV-SUB > PV-FISCAL-PERIOD-WEEK                 42300000
420900                                                                  42310000
421000         PERFORM D540-POPULATE-DEPT-TOTAL-AMTS                    42320000
421100             VARYING PV-SUB                                       42330000
421200             FROM 1 BY 1                                          42340000
421300             UNTIL PV-SUB > PV-FISCAL-PERIOD-WEEK                 42350000
421400     END-IF.                                                      42360000
421500                                                                  42370000
421600     MOVE PC-MARKDOWN-TOTAL    TO RPT-DEPT-TOT-DESC.              42380000
421700     PERFORM D550-WRITE-DEPT-TOTAL-LINE.                          42390000
421800                                                                  42400000
421900**** SUM ONLY THE DEPARTMENT MARKUPS AND MARKUP/CANCELLATIONS     42410000
422000                                                                  42420000
422100     MOVE ZEROES               TO PV-TOT-MU-MD-AMT.               42430000
422200                                                                  42440000
422300     IF CR-VALID-SEASON                                           42450000
422400         PERFORM D570-GET-DEPT-MKUP-MONTHLY-SUM                   42460000
422500             VARYING PV-SUB                                       42470000
422600             FROM 1 BY 1                                          42480000
422700             UNTIL (PV-SUB > 6)                                   42490000
422800                OR (PV-SUB > PV-CALC-SEASON-MONTH)                42500000
422900                                                                  42510000
423000         PERFORM D540-POPULATE-DEPT-TOTAL-AMTS                    42520000
423100             VARYING PV-SUB                                       42530000
423200             FROM 1 BY 1                                          42540000
423300             UNTIL (PV-SUB > 6)                                   42550000
423400                OR (PV-SUB > PV-CALC-SEASON-MONTH)                42560000
423500     ELSE                                                         42570000
423600         PERFORM D520-GET-DEPT-MKUP-WEEKLY-SUM                    42580000
423700             VARYING PV-SUB                                       42590000
423800             FROM 1 BY 1                                          42600000
423900             UNTIL PV-SUB > PV-FISCAL-PERIOD-WEEK                 42610000
424000                                                                  42620000
424100         PERFORM D540-POPULATE-DEPT-TOTAL-AMTS                    42630000
424200             VARYING PV-SUB                                       42640000
424300             FROM 1 BY 1                                          42650000
424400             UNTIL PV-SUB > PV-FISCAL-PERIOD-WEEK                 42660000
424500     END-IF.                                                      42670000
424600                                                                  42680000
424700     MOVE PC-MARKUP-TOTAL      TO RPT-DEPT-TOT-DESC.              42690000
424800     PERFORM D550-WRITE-DEPT-TOTAL-LINE.                          42700000
424900                                                                  42710000
425000**** SUM THE ENTIRE DEPARTMENT, MARKDOWNS AND MARKUPS             42720000
425100                                                                  42730000
425200     MOVE ZEROES               TO PV-TOT-MU-MD-AMT.               42740000
425300                                                                  42750000
425400     IF CR-VALID-SEASON                                           42760000
425500         PERFORM D580-GET-DEPT-MONTHLY-SUM                        42770000
425600             VARYING PV-SUB                                       42780000
425700             FROM 1 BY 1                                          42790000
425800             UNTIL (PV-SUB > 6)                                   42800000
425900                OR (PV-SUB > PV-CALC-SEASON-MONTH)                42810000
426000                                                                  42820000
426100         PERFORM D540-POPULATE-DEPT-TOTAL-AMTS                    42830000
426200             VARYING PV-SUB                                       42840000
426300             FROM 1 BY 1                                          42850000
426400             UNTIL (PV-SUB > 6)                                   42860000
426500                OR (PV-SUB > PV-CALC-SEASON-MONTH)                42870000
426600     ELSE                                                         42880000
426700         PERFORM D530-GET-DEPT-WEEKLY-SUM                         42890000
426800             VARYING PV-SUB                                       42900000
426900             FROM 1 BY 1                                          42910000
427000             UNTIL PV-SUB > PV-FISCAL-PERIOD-WEEK                 42920000
427100                                                                  42930000
427200         PERFORM D540-POPULATE-DEPT-TOTAL-AMTS                    42940000
427300             VARYING PV-SUB                                       42950000
427400             FROM 1 BY 1                                          42960000
427500             UNTIL PV-SUB > PV-FISCAL-PERIOD-WEEK                 42970000
427600     END-IF.                                                      42980000
427700                                                                  42990000
427800     MOVE PC-NET-TOTAL         TO RPT-DEPT-TOT-DESC.              43000000
427900     PERFORM D550-WRITE-DEPT-TOTAL-LINE.                          43010000
428000                                                                  43020000
428100     WRITE REPORT-RECORD                                          43030000
428200         FROM REPORT-UNDERLINE                                    43040000
428300         AFTER ADVANCING 1 LINE.                                  43050000
428400                                                                  43060000
428500******************************************************************43070000
428600*     D510-GET-DEPT-MKDN-WEEKLY-SUM                              *43080000
428700* ==> PROCESSES:                                                 *43090000
428800*     - SELECT THE SUM FOR THE FISCAL WEEK BY DEPARTMENT         *43100000
428900* ==> PERFORMED FROM:                                            *43110000
429000******************************************************************43120000
429100 D510-GET-DEPT-MKDN-WEEKLY-SUM.                                   43130000
429200                                                                  43140000
429300     MOVE PV-SUB               TO PV-FSCL-WK-NUMERIC.             43150000
429400     MOVE PV-FSCL-WK-NUMERIC   TO PV-FSCL-WK-ALPHA.               43160000
429500                                                                  43170000
429600     EXEC SQL                                                     43180000
429700         SELECT SUM(TOT_MU_MD_AMT)                                43190000
429800           INTO :PV-TOT-MU-MD-AMT                                 43200000
429900           FROM                                                   43210000
430000                TWKMUMD                                           43220000
430100          WHERE                                                   43230000
430200                FSCL_MN          = :WKMUMD-FSCL-MN                43240000
430300            AND FSCL_YR          = :WKMUMD-FSCL-YR                43250000
430400            AND DEPT_NBR         = :PV-HOLD-DEPT-NBR              43260000
430500            AND FSCL_WK          = :PV-FSCL-WK-ALPHA              43270000
430600            AND PRIC_CHG_TYP_CDE IN ('1','2')                     43280000
430700     END-EXEC.                                                    43290000
430800                                                                  43300000
430900     EVALUATE TRUE                                                43310000
431000         WHEN SQLCODE = +0                                        43320000
431100             MOVE PV-TOT-MU-MD-AMT                                43330000
431200                               TO PV-SUM-BY-DEPT (PV-SUB)         43340000
431300             ADD PV-SUM-BY-DEPT (PV-SUB)                          43350000
431400                               TO PV-SUM-BY-DEPT-TOTAL            43360000
431500             MOVE ZEROES       TO PV-TOT-MU-MD-AMT                43370000
431600                                                                  43380000
431700         WHEN SQLCODE = -305                                      43390000
431800             MOVE ZERO         TO PV-SUM-BY-DEPT (PV-SUB)         43400000
431900                                                                  43410000
432000         WHEN OTHER                                               43420000
432100             MOVE 'D510-GET-DEPT-MKDN-WEEKLY-SUM'                 43430000
432200                               TO PV-PARAGRAPH-NAME               43440000
432300             MOVE 'SELECT DEPT SUM - MKDNS ONLY   '               43450000
432400                               TO PV-DB2-OPERATION-ATTEMPTED      43460000
432500             PERFORM Z900-SQL-ABEND                               43470000
432600     END-EVALUATE.                                                43480000
432700                                                                  43490000
432800******************************************************************43500000
432900*     D520-GET-DEPT-MKUP-WEEKLY-SUM                              *43510000
433000* ==> PROCESSES:                                                 *43520000
433100*     - SELECT THE SUM FOR THE FISCAL WEEK BY DEPARTMENT         *43530000
433200* ==> PERFORMED FROM:                                            *43540000
433300******************************************************************43550000
433400 D520-GET-DEPT-MKUP-WEEKLY-SUM.                                   43560000
433500                                                                  43570000
433600     MOVE PV-SUB               TO PV-FSCL-WK-NUMERIC.             43580000
433700     MOVE PV-FSCL-WK-NUMERIC   TO PV-FSCL-WK-ALPHA.               43590000
433800                                                                  43600000
433900     EXEC SQL                                                     43610000
434000         SELECT SUM(TOT_MU_MD_AMT)                                43620000
434100           INTO :PV-TOT-MU-MD-AMT                                 43630000
434200           FROM                                                   43640000
434300                TWKMUMD                                           43650000
434400          WHERE                                                   43660000
434500                FSCL_MN          = :WKMUMD-FSCL-MN                43670000
434600            AND FSCL_YR          = :WKMUMD-FSCL-YR                43680000
434700            AND DEPT_NBR         = :PV-HOLD-DEPT-NBR              43690000
434800            AND FSCL_WK          = :PV-FSCL-WK-ALPHA              43700000
434900            AND PRIC_CHG_TYP_CDE IN ('3','4')                     43710000
435000     END-EXEC.                                                    43720000
435100                                                                  43730000
435200     EVALUATE TRUE                                                43740000
435300         WHEN SQLCODE = +0                                        43750000
435400             MOVE PV-TOT-MU-MD-AMT                                43760000
435500                               TO PV-SUM-BY-DEPT (PV-SUB)         43770000
435600             ADD PV-SUM-BY-DEPT (PV-SUB)                          43780000
435700                               TO PV-SUM-BY-DEPT-TOTAL            43790000
435800             MOVE ZEROES       TO PV-TOT-MU-MD-AMT                43800000
435900                                                                  43810000
436000         WHEN SQLCODE = -305                                      43820000
436100             MOVE ZERO         TO PV-SUM-BY-DEPT (PV-SUB)         43830000
436200                                                                  43840000
436300         WHEN OTHER                                               43850000
436400             MOVE 'D520-GET-DEPT-MKUP-WEEKLY-SUM'                 43860000
436500                               TO PV-PARAGRAPH-NAME               43870000
436600             MOVE 'SELECT DEPT SUM - MKUPS ONLY   '               43880000
436700                               TO PV-DB2-OPERATION-ATTEMPTED      43890000
436800             PERFORM Z900-SQL-ABEND                               43900000
436900     END-EVALUATE.                                                43910000
437000                                                                  43920000
437100******************************************************************43930000
437200*     D530-GET-DEPT-WEEKLY-SUM                                   *43940000
437300* ==> PROCESSES:                                                 *43950000
437400*     - SELECT THE SUM FOR THE FISCAL WEEK BY DEPARTMENT         *43960000
437500* ==> PERFORMED FROM:                                            *43970000
437600******************************************************************43980000
437700 D530-GET-DEPT-WEEKLY-SUM.                                        43990000
437800                                                                  44000000
437900     MOVE PV-SUB               TO PV-FSCL-WK-NUMERIC.             44010000
438000     MOVE PV-FSCL-WK-NUMERIC   TO PV-FSCL-WK-ALPHA.               44020000
438100                                                                  44030000
438200     EXEC SQL                                                     44040000
438300         SELECT SUM(TOT_MU_MD_AMT)                                44050000
438400           INTO :PV-TOT-MU-MD-AMT                                 44060000
438500           FROM                                                   44070000
438600                TWKMUMD                                           44080000
438700          WHERE                                                   44090000
438800                FSCL_MN          = :WKMUMD-FSCL-MN                44100000
438900            AND FSCL_YR          = :WKMUMD-FSCL-YR                44110000
439000            AND DEPT_NBR         = :PV-HOLD-DEPT-NBR              44120000
439100            AND FSCL_WK          = :PV-FSCL-WK-ALPHA              44130000
439200     END-EXEC.                                                    44140000
439300                                                                  44150000
439400     EVALUATE TRUE                                                44160000
439500         WHEN SQLCODE = +0                                        44170000
439600             MOVE PV-TOT-MU-MD-AMT                                44180000
439700                               TO PV-SUM-BY-DEPT (PV-SUB)         44190000
439800             ADD PV-SUM-BY-DEPT (PV-SUB)                          44200000
439900                               TO PV-SUM-BY-DEPT-TOTAL            44210000
440000             MOVE ZEROES       TO PV-TOT-MU-MD-AMT                44220000
440100                                                                  44230000
440200         WHEN SQLCODE = -305                                      44240000
440300             MOVE ZERO         TO PV-SUM-BY-DEPT (PV-SUB)         44250000
440400                                                                  44260000
440500         WHEN OTHER                                               44270000
440600             MOVE 'D530-GET-DEPT-WEEKLY-SUM  '                    44280000
440700                               TO PV-PARAGRAPH-NAME               44290000
440800             MOVE 'SELECT SUM BY DEPARTMENT       '               44300000
440900                               TO PV-DB2-OPERATION-ATTEMPTED      44310000
441000             PERFORM Z900-SQL-ABEND                               44320000
441100     END-EVALUATE.                                                44330000
441200                                                                  44340000
441300******************************************************************44350000
441400*     D540-POPULATE-DEPT-TOTAL-AMTS                              *44360000
441500* ==> PROCESSES:                                                 *44370000
441600*     - POPULATE THE REPORT DEPARTMENT TOTAL LINE                *44380000
441700* ==> PERFORMED FROM:                                            *44390000
441800******************************************************************44400000
441900 D540-POPULATE-DEPT-TOTAL-AMTS.                                   44410000
442000                                                                  44420000
442100     EVALUATE PV-SUB                                              44430000
442200         WHEN 01                                                  44440000
442300             MOVE PV-SUM-BY-DEPT (PV-SUB)                         44450000
442400                        TO PV-MKDN-TYPE-TOT-PER-AMT               44460000
442500             MOVE PV-MKDN-TYPE-TOT-PER-AMT                        44470000
442600                        TO RPT-DEPT-TOT-PER-1-AMT                 44480000
442700         WHEN 02                                                  44490000
442800             MOVE PV-SUM-BY-DEPT (PV-SUB)                         44500000
442900                        TO PV-MKDN-TYPE-TOT-PER-AMT               44510000
443000             MOVE PV-MKDN-TYPE-TOT-PER-AMT                        44520000
443100                        TO RPT-DEPT-TOT-PER-2-AMT                 44530000
443200         WHEN 03                                                  44540000
443300             MOVE PV-SUM-BY-DEPT (PV-SUB)                         44550000
443400                        TO PV-MKDN-TYPE-TOT-PER-AMT               44560000
443500             MOVE PV-MKDN-TYPE-TOT-PER-AMT                        44570000
443600                        TO RPT-DEPT-TOT-PER-3-AMT                 44580000
443700         WHEN 04                                                  44590000
443800             MOVE PV-SUM-BY-DEPT (PV-SUB)                         44600000
443900                        TO PV-MKDN-TYPE-TOT-PER-AMT               44610000
444000             MOVE PV-MKDN-TYPE-TOT-PER-AMT                        44620000
444100                        TO RPT-DEPT-TOT-PER-4-AMT                 44630000
444200         WHEN 05                                                  44640000
444300             MOVE PV-SUM-BY-DEPT (PV-SUB)                         44650000
444400                        TO PV-MKDN-TYPE-TOT-PER-AMT               44660000
444500             MOVE PV-MKDN-TYPE-TOT-PER-AMT                        44670000
444600                        TO RPT-DEPT-TOT-PER-5-AMT                 44680000
444700         WHEN 06                                                  44690000
444800             MOVE PV-SUM-BY-DEPT (PV-SUB)                         44700000
444900                        TO PV-MKDN-TYPE-TOT-PER-AMT               44710000
445000             MOVE PV-MKDN-TYPE-TOT-PER-AMT                        44720000
445100                        TO RPT-DEPT-TOT-PER-6-AMT                 44730000
445200     END-EVALUATE.                                                44740000
445300                                                                  44750000
445400******************************************************************44760000
445500*     D550-WRITE-DEPT-TOTAL-LINE                                 *44770000
445600* ==> PROCESSES:                                                 *44780000
445700* ==> PERFORMED FROM:                                            *44790000
445800*                                                                *44800000
445900******************************************************************44810000
446000 D550-WRITE-DEPT-TOTAL-LINE.                                      44820000
446100                                                                  44830000
446200     MOVE PV-SUM-BY-DEPT-TOTAL TO PV-MKDN-TYPE-TOT-PER-AMT.       44840000
446300     MOVE PV-MKDN-TYPE-TOT-PER-AMT                                44850000
446400                               TO RPT-DEPT-TOT-PER-AMOUNT.        44860000
446500                                                                  44870000
446600     WRITE REPORT-RECORD                                          44880000
446700         FROM REPORT-DEPT-TOTAL-LINE                              44890000
446800         AFTER ADVANCING 1 LINE.                                  44900000
446900                                                                  44910000
447000     MOVE ZEROES  TO PV-SUM-BY-DEPT-TOTAL.                        44920000
447100                                                                  44930000
447200     INITIALIZE REPORT-DEPT-TOTAL-LINE.                           44940000
447300                                                                  44950000
447400******************************************************************44960000
447500*     D560-GET-DEPT-MKDN-MONTHLY-SUM                             *44970000
447600* ==> PROCESSES:                                                 *44980000
447700*     - SELECT THE SUM FOR THE FISCAL WEEK BY DEPARTMENT         *44990000
447800* ==> PERFORMED FROM:                                            *45000000
447900******************************************************************45010000
448000 D560-GET-DEPT-MKDN-MONTHLY-SUM.                                  45020000
448100                                                                  45030000
448200     MOVE PV-SUB               TO PV-FSCL-MN-NUMERIC.             45040000
448300                                                                  45050000
448400     IF CR-FALL                                                   45060000
448500         ADD 6                 TO PV-FSCL-MN-NUMERIC              45070000
448600     END-IF.                                                      45080000
448700                                                                  45090000
448800     MOVE PV-FSCL-MN-NUMERIC   TO PV-FSCL-MN-ALPHA.               45100000
448900                                                                  45110000
449000     EXEC SQL                                                     45120000
449100         SELECT SUM(TOT_MU_MD_AMT)                                45130000
449200           INTO :PV-TOT-MU-MD-AMT                                 45140000
449300           FROM                                                   45150000
449400                TWKMUMD                                           45160000
449500          WHERE                                                   45170000
449600                FSCL_MN          = :PV-FSCL-MN-ALPHA              45180000
449700            AND FSCL_YR          = :WKMUMD-FSCL-YR                45190000
449800            AND DEPT_NBR         = :PV-HOLD-DEPT-NBR              45200000
449900            AND PRIC_CHG_TYP_CDE IN ('1','2')                     45210000
450000     END-EXEC.                                                    45220000
450100                                                                  45230000
450200     EVALUATE TRUE                                                45240000
450300         WHEN SQLCODE = +0                                        45250000
450400             MOVE PV-TOT-MU-MD-AMT                                45260000
450500                               TO PV-SUM-BY-DEPT (PV-SUB)         45270000
450600             ADD PV-SUM-BY-DEPT (PV-SUB)                          45280000
450700                               TO PV-SUM-BY-DEPT-TOTAL            45290000
450800             MOVE ZEROES       TO PV-TOT-MU-MD-AMT                45300000
450900                                                                  45310000
451000         WHEN SQLCODE = -305                                      45320000
451100             MOVE ZERO         TO PV-SUM-BY-DEPT (PV-SUB)         45330000
451200                                                                  45340000
451300         WHEN OTHER                                               45350000
451400             MOVE 'D560-GET-DEPT-MKDN-MONTHLY-SUM'                45360000
451500                               TO PV-PARAGRAPH-NAME               45370000
451600             MOVE 'SELECT DEPT SUM - MKDNS ONLY   '               45380000
451700                               TO PV-DB2-OPERATION-ATTEMPTED      45390000
451800             PERFORM Z900-SQL-ABEND                               45400000
451900     END-EVALUATE.                                                45410000
452000                                                                  45420000
452100******************************************************************45430000
452200*     D570-GET-DEPT-MKUP-MONTHLY-SUM                             *45440000
452300* ==> PROCESSES:                                                 *45450000
452400*     - SELECT THE SUM FOR THE FISCAL MONTH BY DEPARTMENT        *45460000
452500* ==> PERFORMED FROM:                                            *45470000
452600******************************************************************45480000
452700 D570-GET-DEPT-MKUP-MONTHLY-SUM.                                  45490000
452800                                                                  45500000
452900     MOVE PV-SUB               TO PV-FSCL-MN-NUMERIC.             45510000
453000                                                                  45520000
453100     IF CR-FALL                                                   45530000
453200         ADD 6                 TO PV-FSCL-MN-NUMERIC              45540000
453300     END-IF.                                                      45550000
453400                                                                  45560000
453500     MOVE PV-FSCL-MN-NUMERIC   TO PV-FSCL-MN-ALPHA.               45570000
453600                                                                  45580000
453700     EXEC SQL                                                     45590000
453800         SELECT SUM(TOT_MU_MD_AMT)                                45600000
453900           INTO :PV-TOT-MU-MD-AMT                                 45610000
454000           FROM                                                   45620000
454100                TWKMUMD                                           45630000
454200          WHERE                                                   45640000
454300                FSCL_MN          = :PV-FSCL-MN-ALPHA              45650000
454400            AND FSCL_YR          = :WKMUMD-FSCL-YR                45660000
454500            AND DEPT_NBR         = :PV-HOLD-DEPT-NBR              45670000
454600            AND PRIC_CHG_TYP_CDE IN ('3','4')                     45680000
454700     END-EXEC.                                                    45690000
454800                                                                  45700000
454900     EVALUATE TRUE                                                45710000
455000         WHEN SQLCODE = +0                                        45720000
455100             MOVE PV-TOT-MU-MD-AMT                                45730000
455200                               TO PV-SUM-BY-DEPT (PV-SUB)         45740000
455300             ADD PV-SUM-BY-DEPT (PV-SUB)                          45750000
455400                               TO PV-SUM-BY-DEPT-TOTAL            45760000
455500             MOVE ZEROES       TO PV-TOT-MU-MD-AMT                45770000
455600                                                                  45780000
455700         WHEN SQLCODE = -305                                      45790000
455800             MOVE ZERO         TO PV-SUM-BY-DEPT (PV-SUB)         45800000
455900                                                                  45810000
456000         WHEN OTHER                                               45820000
456100             MOVE 'D570-GET-DEPT-MKUP-MONTHLY-SUM'                45830000
456200                               TO PV-PARAGRAPH-NAME               45840000
456300             MOVE 'SELECT DEPT SUM - MKUPS ONLY   '               45850000
456400                               TO PV-DB2-OPERATION-ATTEMPTED      45860000
456500             PERFORM Z900-SQL-ABEND                               45870000
456600     END-EVALUATE.                                                45880000
456700                                                                  45890000
456800******************************************************************45900000
456900*     D580-GET-DEPT-MONTHLY-SUM                                  *45910000
457000* ==> PROCESSES:                                                 *45920000
457100*     - SELECT THE SUM FOR THE FISCAL MONTH BY DEPARTMENT        *45930000
457200* ==> PERFORMED FROM:                                            *45940000
457300******************************************************************45950000
457400 D580-GET-DEPT-MONTHLY-SUM.                                       45960000
457500                                                                  45970000
457600     MOVE PV-SUB               TO PV-FSCL-MN-NUMERIC.             45980000
457700                                                                  45990000
457800     IF CR-FALL                                                   46000000
457900         ADD 6                 TO PV-FSCL-MN-NUMERIC              46010000
458000     END-IF.                                                      46020000
458100                                                                  46030000
458200     MOVE PV-FSCL-MN-NUMERIC   TO PV-FSCL-MN-ALPHA.               46040000
458300                                                                  46050000
458400     EXEC SQL                                                     46060000
458500         SELECT SUM(TOT_MU_MD_AMT)                                46070000
458600           INTO :PV-TOT-MU-MD-AMT                                 46080000
458700           FROM                                                   46090000
458800                TWKMUMD                                           46100000
458900          WHERE                                                   46110000
459000                FSCL_MN          = :PV-FSCL-MN-ALPHA              46120000
459100            AND FSCL_YR          = :WKMUMD-FSCL-YR                46130000
459200            AND DEPT_NBR         = :PV-HOLD-DEPT-NBR              46140000
459300     END-EXEC.                                                    46150000
459400                                                                  46160000
459500     EVALUATE TRUE                                                46170000
459600         WHEN SQLCODE = +0                                        46180000
459700             MOVE PV-TOT-MU-MD-AMT                                46190000
459800                               TO PV-SUM-BY-DEPT (PV-SUB)         46200000
459900             ADD PV-SUM-BY-DEPT (PV-SUB)                          46210000
460000                               TO PV-SUM-BY-DEPT-TOTAL            46220000
460100             MOVE ZEROES       TO PV-TOT-MU-MD-AMT                46230000
460200                                                                  46240000
460300         WHEN SQLCODE = -305                                      46250000
460400             MOVE ZERO         TO PV-SUM-BY-DEPT (PV-SUB)         46260000
460500                                                                  46270000
460600         WHEN OTHER                                               46280000
460700             MOVE 'D580-GET-DEPT-MONTHLY-SUM '                    46290000
460800                               TO PV-PARAGRAPH-NAME               46300000
460900             MOVE 'SELECT SUM BY DEPARTMENT       '               46310000
461000                               TO PV-DB2-OPERATION-ATTEMPTED      46320000
461100             PERFORM Z900-SQL-ABEND                               46330000
461200     END-EVALUATE.                                                46340000
461300                                                                  46350000
461400******************************************************************46360000
461500*     D600-PRINT-DMM-TOT-LINE                                    *46370000
461600* ==> PROCESSES:                                                 *46380000
461700* ==> PERFORMED FROM:                                            *46390000
461800*                                                                *46400000
461900******************************************************************46410000
462000 D600-PRINT-DMM-TOT-LINE.                                         46420000
462100                                                                  46430000
462200     ADD +7                 TO PA-LINE-COUNTER.                   46440000
462300     IF PA-LINE-COUNTER >= PC-MAX-LINES-PER-PAGE                  46450000
462400         PERFORM D100-PROCESS-PAGE-BREAK                          46460000
462500         ADD PC-THREE       TO PA-LINE-COUNTER                    46470000
462600     END-IF.                                                      46480000
462700                                                                  46490000
462800     INITIALIZE REPORT-SUMM-HEADING-TOT-LINE.                     46500000
462900     MOVE SPACES               TO PV-RPT-SUMM-LEVEL.              46510000
463000                                                                  46520000
463100     MOVE RPT-HL1-DMM-NAME     TO PV-TRUNCATE-NAME.               46530000
463200                                                                  46540000
463300     STRING PV-TRUNCATE-NAME                                      46550000
463400            DELIMITED BY SPACE                                    46560000
463500            ' '                                                   46570000
463600            'TOTALS: '                                            46580000
463700            DELIMITED BY SIZE INTO PV-RPT-SUMM-LEVEL.             46590000
463800                                                                  46600000
463900     STRING 'DMM '                                                46610000
464000            PV-RPT-SUMM-LEVEL                                     46620000
464100            DELIMITED BY SIZE INTO RPT-SUMM-TOT-LEVEL.            46630000
464200                                                                  46640000
464300     WRITE REPORT-RECORD                                          46650000
464400         FROM REPORT-SUMM-HEADING-TOT-LINE                        46660000
464500         AFTER ADVANCING 2 LINES.                                 46670000
464600                                                                  46680000
464700**** SUM ONLY THE DMM MARKDOWNS AND MARKDOWN/CANCELLATIONS        46690000
464800                                                                  46700000
464900     MOVE ZEROES               TO PV-TOT-MU-MD-AMT.               46710000
465000                                                                  46720000
465100     IF CR-VALID-SEASON                                           46730000
465200         PERFORM D660-GET-DMM-MKDN-MONTHLY-SUM                    46740000
465300             VARYING PV-SUB                                       46750000
465400             FROM 1 BY 1                                          46760000
465500             UNTIL (PV-SUB > 6)                                   46770000
465600                OR (PV-SUB > PV-CALC-SEASON-MONTH)                46780000
465700                                                                  46790000
465800         PERFORM D640-POPULATE-DMM-TOTAL-AMTS                     46800000
465900             VARYING PV-SUB                                       46810000
466000             FROM 1 BY 1                                          46820000
466100             UNTIL (PV-SUB > 6)                                   46830000
466200                OR (PV-SUB > PV-CALC-SEASON-MONTH)                46840000
466300     ELSE                                                         46850000
466400         PERFORM D610-GET-DMM-MKDN-WEEKLY-SUM                     46860000
466500             VARYING PV-SUB                                       46870000
466600             FROM 1 BY 1                                          46880000
466700             UNTIL PV-SUB > PV-FISCAL-PERIOD-WEEK                 46890000
466800                                                                  46900000
466900         PERFORM D640-POPULATE-DMM-TOTAL-AMTS                     46910000
467000             VARYING PV-SUB                                       46920000
467100             FROM 1 BY 1                                          46930000
467200             UNTIL PV-SUB > PV-FISCAL-PERIOD-WEEK                 46940000
467300     END-IF.                                                      46950000
467400                                                                  46960000
467500     MOVE PC-MARKDOWN-TOTAL    TO RPT-SUMM-TOT-DESC.              46970000
467600     PERFORM D650-WRITE-DMM-TOTAL-LINE.                           46980000
467700                                                                  46990000
467800**** SUM ONLY THE DMM MARKUPS AND MARKUP/CANCELLATIONS            47000000
467900                                                                  47010000
468000     MOVE ZEROES               TO PV-TOT-MU-MD-AMT.               47020000
468100                                                                  47030000
468200     IF CR-VALID-SEASON                                           47040000
468300         PERFORM D670-GET-DMM-MKUP-MONTHLY-SUM                    47050000
468400             VARYING PV-SUB                                       47060000
468500             FROM 1 BY 1                                          47070000
468600             UNTIL (PV-SUB > 6)                                   47080000
468700                OR (PV-SUB > PV-CALC-SEASON-MONTH)                47090000
468800                                                                  47100000
468900         PERFORM D640-POPULATE-DMM-TOTAL-AMTS                     47110000
469000             VARYING PV-SUB                                       47120000
469100             FROM 1 BY 1                                          47130000
469200             UNTIL (PV-SUB > 6)                                   47140000
469300                OR (PV-SUB > PV-CALC-SEASON-MONTH)                47150000
469400     ELSE                                                         47160000
469500         PERFORM D620-GET-DMM-MKUP-WEEKLY-SUM                     47170000
469600             VARYING PV-SUB                                       47180000
469700             FROM 1 BY 1                                          47190000
469800             UNTIL PV-SUB > PV-FISCAL-PERIOD-WEEK                 47200000
469900                                                                  47210000
470000         PERFORM D640-POPULATE-DMM-TOTAL-AMTS                     47220000
470100             VARYING PV-SUB                                       47230000
470200             FROM 1 BY 1                                          47240000
470300             UNTIL PV-SUB > PV-FISCAL-PERIOD-WEEK                 47250000
470400     END-IF.                                                      47260000
470500                                                                  47270000
470600     MOVE PC-MARKUP-TOTAL      TO RPT-SUMM-TOT-DESC.              47280000
470700     PERFORM D650-WRITE-DMM-TOTAL-LINE.                           47290000
470800                                                                  47300000
470900**** SUM ALL THE MARKDOWNS AND MARKUPS FOR THE DMM                47310000
471000                                                                  47320000
471100     MOVE ZEROES               TO PV-TOT-MU-MD-AMT.               47330000
471200                                                                  47340000
471300     IF CR-VALID-SEASON                                           47350000
471400         PERFORM D680-GET-DMM-MONTHLY-SUM                         47360000
471500             VARYING PV-SUB                                       47370000
471600             FROM 1 BY 1                                          47380000
471700             UNTIL (PV-SUB > 6)                                   47390000
471800                OR (PV-SUB > PV-CALC-SEASON-MONTH)                47400000
471900                                                                  47410000
472000         PERFORM D640-POPULATE-DMM-TOTAL-AMTS                     47420000
472100             VARYING PV-SUB                                       47430000
472200             FROM 1 BY 1                                          47440000
472300             UNTIL (PV-SUB > 6)                                   47450000
472400                OR (PV-SUB > PV-CALC-SEASON-MONTH)                47460000
472500     ELSE                                                         47470000
472600         PERFORM D630-GET-DMM-WEEKLY-SUM                          47480000
472700             VARYING PV-SUB                                       47490000
472800             FROM 1 BY 1                                          47500000
472900             UNTIL PV-SUB > PV-FISCAL-PERIOD-WEEK                 47510000
473000                                                                  47520000
473100         PERFORM D640-POPULATE-DMM-TOTAL-AMTS                     47530000
473200             VARYING PV-SUB                                       47540000
473300             FROM 1 BY 1                                          47550000
473400             UNTIL PV-SUB > PV-FISCAL-PERIOD-WEEK                 47560000
473500     END-IF.                                                      47570000
473600                                                                  47580000
473700     MOVE PC-NET-TOTAL         TO RPT-SUMM-TOT-DESC.              47590000
473800     PERFORM D650-WRITE-DMM-TOTAL-LINE.                           47600000
473900                                                                  47610000
474000     WRITE REPORT-RECORD                                          47620000
474100         FROM REPORT-UNDERLINE                                    47630000
474200         AFTER ADVANCING 1 LINE.                                  47640000
474300                                                                  47650000
474400******************************************************************47660000
474500*     D610-GET-DMM-MKDN-WEEKLY-SUM                               *47670000
474600* ==> PROCESSES:                                                 *47680000
474700*     - SELECT THE SUM FOR THE FISCAL WEEK BY DMM                *47690000
474800* ==> PERFORMED FROM:                                            *47700000
474900******************************************************************47710000
475000 D610-GET-DMM-MKDN-WEEKLY-SUM.                                    47720000
475100                                                                  47730000
475200     MOVE PV-SUB               TO PV-FSCL-WK-NUMERIC.             47740000
475300     MOVE PV-FSCL-WK-NUMERIC   TO PV-FSCL-WK-ALPHA.               47750000
475400                                                                  47760000
475500     EXEC SQL                                                     47770000
475600         SELECT SUM(TOT_MU_MD_AMT)                                47780000
475700           INTO :PV-TOT-MU-MD-AMT                                 47790000
475800           FROM                                                   47800000
475900                TMDSEAR A                                         47810000
476000              , TWKMUMD M                                         47820000
476100          WHERE                                                   47830000
476200                A.OPERCO_NBR       = '03'                         47840000
476300            AND A.GMA_NBR          = :PV-HOLD-GMA-NBR             47850000
476400            AND A.DMA_NBR          = :PV-HOLD-DMA-NBR             47860000
476500            AND A.MDSELV_CDE       = 'DPT'                        47870000
476600            AND A.DEPT_NBR         = M.DEPT_NBR                   47880000
476700            AND (CURRENT DATE                                     47890000
476800                                 BETWEEN A.STRT_DTE AND A.END_DTE)47900000
476900            AND M.FSCL_MN          = :WKMUMD-FSCL-MN              47910000
477000            AND M.FSCL_YR          = :WKMUMD-FSCL-YR              47920000
477100            AND M.FSCL_WK          = :PV-FSCL-WK-ALPHA            47930000
477200            AND M.PRIC_CHG_TYP_CDE IN ('1','2')                   47940000
477300     END-EXEC.                                                    47950000
477400                                                                  47960000
477500     EVALUATE TRUE                                                47970000
477600         WHEN SQLCODE = +0                                        47980000
477700             MOVE PV-TOT-MU-MD-AMT                                47990000
477800                               TO PV-SUM-BY-DMM (PV-SUB)          48000000
477900             ADD PV-SUM-BY-DMM (PV-SUB)                           48010000
478000                               TO PV-SUM-BY-DMM-TOTAL             48020000
478100             MOVE ZEROES       TO PV-TOT-MU-MD-AMT                48030000
478200                                                                  48040000
478300         WHEN SQLCODE = -305                                      48050000
478400             MOVE ZERO         TO PV-SUM-BY-DMM (PV-SUB)          48060000
478500                                                                  48070000
478600         WHEN OTHER                                               48080000
478700             MOVE 'D610-GET-DMM-MKDN-WEEKLY-SUM'                  48090000
478800                               TO PV-PARAGRAPH-NAME               48100000
478900             MOVE 'SELECT WKLY SUM FOR DMM - MKDNS'               48110000
479000                               TO PV-DB2-OPERATION-ATTEMPTED      48120000
479100             PERFORM Z900-SQL-ABEND                               48130000
479200     END-EVALUATE.                                                48140000
479300                                                                  48150000
479400******************************************************************48160000
479500*     D620-GET-DMM-MKUP-WEEKLY-SUM                               *48170000
479600* ==> PROCESSES:                                                 *48180000
479700*     - SELECT THE SUM FOR THE FISCAL WEEK BY DMM                *48190000
479800* ==> PERFORMED FROM:                                            *48200000
479900******************************************************************48210000
480000 D620-GET-DMM-MKUP-WEEKLY-SUM.                                    48220000
480100                                                                  48230000
480200     MOVE PV-SUB               TO PV-FSCL-WK-NUMERIC.             48240000
480300     MOVE PV-FSCL-WK-NUMERIC   TO PV-FSCL-WK-ALPHA.               48250000
480400                                                                  48260000
480500     EXEC SQL                                                     48270000
480600         SELECT SUM(TOT_MU_MD_AMT)                                48280000
480700           INTO :PV-TOT-MU-MD-AMT                                 48290000
480800           FROM                                                   48300000
480900                TMDSEAR A                                         48310000
481000              , TWKMUMD M                                         48320000
481100          WHERE                                                   48330000
481200                A.OPERCO_NBR       = '03'                         48340000
481300            AND A.GMA_NBR          = :PV-HOLD-GMA-NBR             48350000
481400            AND A.DMA_NBR          = :PV-HOLD-DMA-NBR             48360000
481500            AND A.MDSELV_CDE       = 'DPT'                        48370000
481600            AND A.DEPT_NBR         = M.DEPT_NBR                   48380000
481700            AND (CURRENT DATE                                     48390000
481800                                 BETWEEN A.STRT_DTE AND A.END_DTE)48400000
481900            AND M.FSCL_MN          = :WKMUMD-FSCL-MN              48410000
482000            AND M.FSCL_YR          = :WKMUMD-FSCL-YR              48420000
482100            AND M.FSCL_WK          = :PV-FSCL-WK-ALPHA            48430000
482200            AND M.PRIC_CHG_TYP_CDE IN ('3','4')                   48440000
482300     END-EXEC.                                                    48450000
482400                                                                  48460000
482500     EVALUATE TRUE                                                48470000
482600         WHEN SQLCODE = +0                                        48480000
482700             MOVE PV-TOT-MU-MD-AMT                                48490000
482800                               TO PV-SUM-BY-DMM (PV-SUB)          48500000
482900             ADD PV-SUM-BY-DMM (PV-SUB)                           48510000
483000                               TO PV-SUM-BY-DMM-TOTAL             48520000
483100             MOVE ZEROES       TO PV-TOT-MU-MD-AMT                48530000
483200                                                                  48540000
483300         WHEN SQLCODE = -305                                      48550000
483400             MOVE ZERO         TO PV-SUM-BY-DMM (PV-SUB)          48560000
483500                                                                  48570000
483600         WHEN OTHER                                               48580000
483700             MOVE 'D620-GET-DMM-MKUP-WEEKLY-SUM'                  48590000
483800                               TO PV-PARAGRAPH-NAME               48600000
483900             MOVE 'SELECT WKLY SUM FOR DMM - MKUPS'               48610000
484000                               TO PV-DB2-OPERATION-ATTEMPTED      48620000
484100             PERFORM Z900-SQL-ABEND                               48630000
484200     END-EVALUATE.                                                48640000
484300                                                                  48650000
484400******************************************************************48660000
484500*     D630-GET-DMM-WEEKLY-SUM                                    *48670000
484600* ==> PROCESSES:                                                 *48680000
484700*     - SELECT THE SUM FOR THE FISCAL WEEK BY DMM                *48690000
484800* ==> PERFORMED FROM:                                            *48700000
484900******************************************************************48710000
485000 D630-GET-DMM-WEEKLY-SUM.                                         48720000
485100                                                                  48730000
485200     MOVE PV-SUB               TO PV-FSCL-WK-NUMERIC.             48740000
485300     MOVE PV-FSCL-WK-NUMERIC   TO PV-FSCL-WK-ALPHA.               48750000
485400                                                                  48760000
485500     EXEC SQL                                                     48770000
485600         SELECT SUM(TOT_MU_MD_AMT)                                48780000
485700           INTO :PV-TOT-MU-MD-AMT                                 48790000
485800           FROM                                                   48800000
485900                TMDSEAR A                                         48810000
486000              , TWKMUMD M                                         48820000
486100          WHERE                                                   48830000
486200                A.OPERCO_NBR       = '03'                         48840000
486300            AND A.GMA_NBR          = :PV-HOLD-GMA-NBR             48850000
486400            AND A.DMA_NBR          = :PV-HOLD-DMA-NBR             48860000
486500            AND A.MDSELV_CDE       = 'DPT'                        48870000
486600            AND A.DEPT_NBR         = M.DEPT_NBR                   48880000
486700            AND (CURRENT DATE                                     48890000
486800                                 BETWEEN A.STRT_DTE AND A.END_DTE)48900000
486900            AND M.FSCL_MN          = :WKMUMD-FSCL-MN              48910000
487000            AND M.FSCL_YR          = :WKMUMD-FSCL-YR              48920000
487100            AND M.FSCL_WK          = :PV-FSCL-WK-ALPHA            48930000
487200     END-EXEC.                                                    48940000
487300                                                                  48950000
487400     EVALUATE TRUE                                                48960000
487500         WHEN SQLCODE = +0                                        48970000
487600             MOVE PV-TOT-MU-MD-AMT                                48980000
487700                               TO PV-SUM-BY-DMM (PV-SUB)          48990000
487800             ADD PV-SUM-BY-DMM (PV-SUB)                           49000000
487900                               TO PV-SUM-BY-DMM-TOTAL             49010000
488000             MOVE ZEROES       TO PV-TOT-MU-MD-AMT                49020000
488100                                                                  49030000
488200         WHEN SQLCODE = -305                                      49040000
488300             MOVE ZERO         TO PV-SUM-BY-DMM (PV-SUB)          49050000
488400                                                                  49060000
488500         WHEN OTHER                                               49070000
488600             MOVE 'D630-GET-DMM-WEEKLY-SUM   '                    49080000
488700                               TO PV-PARAGRAPH-NAME               49090000
488800             MOVE 'SELECT WEEKLY SUM AT DMM LEVEL '               49100000
488900                               TO PV-DB2-OPERATION-ATTEMPTED      49110000
489000             PERFORM Z900-SQL-ABEND                               49120000
489100     END-EVALUATE.                                                49130000
489200                                                                  49140000
489300******************************************************************49150000
489400*     D640-POPULATE-DMM-TOTAL-AMTS.                              *49160000
489500* ==> PROCESSES:                                                 *49170000
489600* ==> PERFORMED FROM:                                            *49180000
489700*                                                                *49190000
489800******************************************************************49200000
489900 D640-POPULATE-DMM-TOTAL-AMTS.                                    49210000
490000                                                                  49220000
490100     EVALUATE PV-SUB                                              49230000
490200         WHEN 01                                                  49240000
490300             MOVE PV-SUM-BY-DMM (PV-SUB)                          49250000
490400                        TO PV-MKDN-TYPE-TOT-PER-AMT               49260000
490500             MOVE PV-MKDN-TYPE-TOT-PER-AMT                        49270000
490600                        TO RPT-SUMM-TOT-PER-1-AMT                 49280000
490700         WHEN 02                                                  49290000
490800             MOVE PV-SUM-BY-DMM (PV-SUB)                          49300000
490900                        TO PV-MKDN-TYPE-TOT-PER-AMT               49310000
491000             MOVE PV-MKDN-TYPE-TOT-PER-AMT                        49320000
491100                        TO RPT-SUMM-TOT-PER-2-AMT                 49330000
491200         WHEN 03                                                  49340000
491300             MOVE PV-SUM-BY-DMM (PV-SUB)                          49350000
491400                        TO PV-MKDN-TYPE-TOT-PER-AMT               49360000
491500             MOVE PV-MKDN-TYPE-TOT-PER-AMT                        49370000
491600                        TO RPT-SUMM-TOT-PER-3-AMT                 49380000
491700         WHEN 04                                                  49390000
491800             MOVE PV-SUM-BY-DMM (PV-SUB)                          49400000
491900                        TO PV-MKDN-TYPE-TOT-PER-AMT               49410000
492000             MOVE PV-MKDN-TYPE-TOT-PER-AMT                        49420000
492100                        TO RPT-SUMM-TOT-PER-4-AMT                 49430000
492200         WHEN 05                                                  49440000
492300             MOVE PV-SUM-BY-DMM (PV-SUB)                          49450000
492400                        TO PV-MKDN-TYPE-TOT-PER-AMT               49460000
492500             MOVE PV-MKDN-TYPE-TOT-PER-AMT                        49470000
492600                        TO RPT-SUMM-TOT-PER-5-AMT                 49480000
492700         WHEN 06                                                  49490000
492800             MOVE PV-SUM-BY-DMM (PV-SUB)                          49500000
492900                        TO PV-MKDN-TYPE-TOT-PER-AMT               49510000
493000             MOVE PV-MKDN-TYPE-TOT-PER-AMT                        49520000
493100                        TO RPT-SUMM-TOT-PER-6-AMT                 49530000
493200     END-EVALUATE.                                                49540000
493300                                                                  49550000
493400******************************************************************49560000
493500*     D650-WRITE-DMM-TOTAL-LINE                                  *49570000
493600* ==> PROCESSES:                                                 *49580000
493700* ==> PERFORMED FROM:                                            *49590000
493800*                                                                *49600000
493900******************************************************************49610000
494000 D650-WRITE-DMM-TOTAL-LINE.                                       49620000
494100                                                                  49630000
494200     MOVE PV-SUM-BY-DMM-TOTAL  TO PV-MKDN-TYPE-TOT-PER-AMT.       49640000
494300     MOVE PV-MKDN-TYPE-TOT-PER-AMT                                49650000
494400                               TO RPT-SUMM-TOT-PER-AMOUNT.        49660000
494500                                                                  49670000
494600     WRITE REPORT-RECORD                                          49680000
494700         FROM REPORT-SUMMARY-TOT-LINE                             49690000
494800         AFTER ADVANCING 1 LINE.                                  49700000
494900                                                                  49710000
495000     MOVE ZEROES  TO PV-SUM-BY-DMM-TOTAL.                         49720000
495100                                                                  49730000
495200     INITIALIZE REPORT-SUMMARY-TOT-LINE.                          49740000
495300                                                                  49750000
495400******************************************************************49760000
495500*     D660-GET-DMM-MKDN-MONTHLY-SUM                              *49770000
495600* ==> PROCESSES:                                                 *49780000
495700* ==> PERFORMED FROM:                                            *49790000
495800*                                                                *49800000
495900******************************************************************49810000
496000 D660-GET-DMM-MKDN-MONTHLY-SUM.                                   49820000
496100                                                                  49830000
496200     MOVE PV-SUB               TO PV-FSCL-MN-NUMERIC.             49840000
496300                                                                  49850000
496400     IF CR-FALL                                                   49860000
496500         ADD 6                 TO PV-FSCL-MN-NUMERIC              49870000
496600     END-IF.                                                      49880000
496700                                                                  49890000
496800     MOVE PV-FSCL-MN-NUMERIC   TO PV-FSCL-MN-ALPHA.               49900000
496900                                                                  49910000
497000     EXEC SQL                                                     49920000
497100         SELECT SUM(TOT_MU_MD_AMT)                                49930000
497200           INTO :PV-TOT-MU-MD-AMT                                 49940000
497300           FROM                                                   49950000
497400                TMDSEAR A                                         49960000
497500              , TWKMUMD M                                         49970000
497600          WHERE                                                   49980000
497700                A.OPERCO_NBR       = '03'                         49990000
497800            AND A.GMA_NBR          = :PV-HOLD-GMA-NBR             50000000
497900            AND A.DMA_NBR          = :PV-HOLD-DMA-NBR             50010000
498000            AND A.MDSELV_CDE       = 'DPT'                        50020000
498100            AND A.DEPT_NBR         = M.DEPT_NBR                   50030000
498200            AND (CURRENT DATE                                     50040000
498300                                 BETWEEN A.STRT_DTE AND A.END_DTE)50050000
498400            AND M.FSCL_MN          = :PV-FSCL-MN-ALPHA            50060000
498500            AND M.FSCL_YR          = :WKMUMD-FSCL-YR              50070000
498600            AND M.PRIC_CHG_TYP_CDE IN ('1','2')                   50080000
498700     END-EXEC.                                                    50090000
498800                                                                  50100000
498900     EVALUATE TRUE                                                50110000
499000         WHEN SQLCODE = +0                                        50120000
499100             MOVE PV-TOT-MU-MD-AMT                                50130000
499200                               TO PV-SUM-BY-DMM (PV-SUB)          50140000
499300             ADD PV-SUM-BY-DMM (PV-SUB)                           50150000
499400                               TO PV-SUM-BY-DMM-TOTAL             50160000
499500             MOVE ZEROES       TO PV-TOT-MU-MD-AMT                50170000
499600                                                                  50180000
499700         WHEN SQLCODE = -305                                      50190000
499800             MOVE ZERO         TO PV-SUM-BY-DMM (PV-SUB)          50200000
499900                                                                  50210000
500000         WHEN OTHER                                               50220000
500100             MOVE 'D660-GET-DMM-MKDN-MONTHLY-SUM'                 50230000
500200                               TO PV-PARAGRAPH-NAME               50240000
500300             MOVE 'SELECT WKLY SUM FOR DMM - MKDNS'               50250000
500400                               TO PV-DB2-OPERATION-ATTEMPTED      50260000
500500             PERFORM Z900-SQL-ABEND                               50270000
500600     END-EVALUATE.                                                50280000
500700                                                                  50290000
500800******************************************************************50300000
500900*     D670-GET-DMM-MKUP-MONTHLY-SUM                              *50310000
501000* ==> PROCESSES:                                                 *50320000
501100*     - SELECT THE SUM FOR THE FISCAL MONTH BY DMM               *50330000
501200* ==> PERFORMED FROM:                                            *50340000
501300******************************************************************50350000
501400 D670-GET-DMM-MKUP-MONTHLY-SUM.                                   50360000
501500                                                                  50370000
501600     MOVE PV-SUB               TO PV-FSCL-MN-NUMERIC.             50380000
501700                                                                  50390000
501800     IF CR-FALL                                                   50400000
501900         ADD 6                 TO PV-FSCL-MN-NUMERIC              50410000
502000     END-IF.                                                      50420000
502100                                                                  50430000
502200     MOVE PV-FSCL-MN-NUMERIC   TO PV-FSCL-MN-ALPHA.               50440000
502300                                                                  50450000
502400     EXEC SQL                                                     50460000
502500         SELECT SUM(TOT_MU_MD_AMT)                                50470000
502600           INTO :PV-TOT-MU-MD-AMT                                 50480000
502700           FROM                                                   50490000
502800                TMDSEAR A                                         50500000
502900              , TWKMUMD M                                         50510000
503000          WHERE                                                   50520000
503100                A.OPERCO_NBR       = '03'                         50530000
503200            AND A.GMA_NBR          = :PV-HOLD-GMA-NBR             50540000
503300            AND A.DMA_NBR          = :PV-HOLD-DMA-NBR             50550000
503400            AND A.MDSELV_CDE       = 'DPT'                        50560000
503500            AND A.DEPT_NBR         = M.DEPT_NBR                   50570000
503600            AND (CURRENT DATE                                     50580000
503700                                 BETWEEN A.STRT_DTE AND A.END_DTE)50590000
503800            AND M.FSCL_MN          = :PV-FSCL-MN-ALPHA            50600000
503900            AND M.FSCL_YR          = :WKMUMD-FSCL-YR              50610000
504000            AND M.PRIC_CHG_TYP_CDE IN ('3','4')                   50620000
504100     END-EXEC.                                                    50630000
504200                                                                  50640000
504300     EVALUATE TRUE                                                50650000
504400         WHEN SQLCODE = +0                                        50660000
504500             MOVE PV-TOT-MU-MD-AMT                                50670000
504600                               TO PV-SUM-BY-DMM (PV-SUB)          50680000
504700             ADD PV-SUM-BY-DMM (PV-SUB)                           50690000
504800                               TO PV-SUM-BY-DMM-TOTAL             50700000
504900             MOVE ZEROES       TO PV-TOT-MU-MD-AMT                50710000
505000                                                                  50720000
505100         WHEN SQLCODE = -305                                      50730000
505200             MOVE ZERO         TO PV-SUM-BY-DMM (PV-SUB)          50740000
505300                                                                  50750000
505400         WHEN OTHER                                               50760000
505500             MOVE 'D670-GET-DMM-MKUP-MONTHLY-SUM'                 50770000
505600                               TO PV-PARAGRAPH-NAME               50780000
505700             MOVE 'SELECT WKLY SUM FOR DMM - MKUPS'               50790000
505800                               TO PV-DB2-OPERATION-ATTEMPTED      50800000
505900             PERFORM Z900-SQL-ABEND                               50810000
506000     END-EVALUATE.                                                50820000
506100                                                                  50830000
506200******************************************************************50840000
506300*     D680-GET-DMM-MONTHLY-SUM                                   *50850000
506400* ==> PROCESSES:                                                 *50860000
506500*     - SELECT THE SUM FOR THE FISCAL MONTH BY DMM               *50870000
506600* ==> PERFORMED FROM:                                            *50880000
506700******************************************************************50890000
506800 D680-GET-DMM-MONTHLY-SUM.                                        50900000
506900                                                                  50910000
507000     MOVE PV-SUB               TO PV-FSCL-MN-NUMERIC.             50920000
507100                                                                  50930000
507200     IF CR-FALL                                                   50940000
507300         ADD 6                 TO PV-FSCL-MN-NUMERIC              50950000
507400     END-IF.                                                      50960000
507500                                                                  50970000
507600     MOVE PV-FSCL-MN-NUMERIC   TO PV-FSCL-MN-ALPHA.               50980000
507700                                                                  50990000
507800     EXEC SQL                                                     51000000
507900         SELECT SUM(TOT_MU_MD_AMT)                                51010000
508000           INTO :PV-TOT-MU-MD-AMT                                 51020000
508100           FROM                                                   51030000
508200                TMDSEAR A                                         51040000
508300              , TWKMUMD M                                         51050000
508400          WHERE                                                   51060000
508500                A.OPERCO_NBR       = '03'                         51070000
508600            AND A.GMA_NBR          = :PV-HOLD-GMA-NBR             51080000
508700            AND A.DMA_NBR          = :PV-HOLD-DMA-NBR             51090000
508800            AND A.MDSELV_CDE       = 'DPT'                        51100000
508900            AND A.DEPT_NBR         = M.DEPT_NBR                   51110000
509000            AND (CURRENT DATE                                     51120000
509100                                 BETWEEN A.STRT_DTE AND A.END_DTE)51130000
509200            AND M.FSCL_MN          = :PV-FSCL-MN-ALPHA            51140000
509300            AND M.FSCL_YR          = :WKMUMD-FSCL-YR              51150000
509400     END-EXEC.                                                    51160000
509500                                                                  51170000
509600     EVALUATE TRUE                                                51180000
509700         WHEN SQLCODE = +0                                        51190000
509800             MOVE PV-TOT-MU-MD-AMT                                51200000
509900                               TO PV-SUM-BY-DMM (PV-SUB)          51210000
510000             ADD PV-SUM-BY-DMM (PV-SUB)                           51220000
510100                               TO PV-SUM-BY-DMM-TOTAL             51230000
510200             MOVE ZEROES       TO PV-TOT-MU-MD-AMT                51240000
510300                                                                  51250000
510400         WHEN SQLCODE = -305                                      51260000
510500             MOVE ZERO         TO PV-SUM-BY-DMM (PV-SUB)          51270000
510600                                                                  51280000
510700         WHEN OTHER                                               51290000
510800             MOVE 'D680-GET-DMM-MONTHLY-SUM  '                    51300000
510900                               TO PV-PARAGRAPH-NAME               51310000
511000             MOVE 'SELECT WEEKLY SUM AT DMM LEVEL '               51320000
511100                               TO PV-DB2-OPERATION-ATTEMPTED      51330000
511200             PERFORM Z900-SQL-ABEND                               51340000
511300     END-EVALUATE.                                                51350000
511400                                                                  51360000
511500******************************************************************51370000
511600*     D600-PRINT-GMM-TOT-LINE                                    *51380000
511700* ==> PROCESSES:                                                 *51390000
511800* ==> PERFORMED FROM:                                            *51400000
511900*                                                                *51410000
512000******************************************************************51420000
512100 D600-PRINT-GMM-TOT-LINE.                                         51430000
512200                                                                  51440000
512300     ADD +7                 TO PA-LINE-COUNTER.                   51450000
512400     IF PA-LINE-COUNTER >= PC-MAX-LINES-PER-PAGE                  51460000
512500         PERFORM D100-PROCESS-PAGE-BREAK                          51470000
512600         ADD PC-THREE       TO PA-LINE-COUNTER                    51480000
512700     END-IF.                                                      51490000
512800                                                                  51500000
512900     INITIALIZE REPORT-SUMM-HEADING-TOT-LINE.                     51510000
513000     MOVE SPACES               TO PV-RPT-SUMM-LEVEL.              51520000
513100                                                                  51530000
513200     MOVE RPT-HL1-GMM-NAME     TO PV-TRUNCATE-NAME.               51540000
513300                                                                  51550000
513400     STRING PV-TRUNCATE-NAME                                      51560000
513500            DELIMITED BY SPACE                                    51570000
513600            ' '                                                   51580000
513700            'TOTALS: '                                            51590000
513800            DELIMITED BY SIZE INTO PV-RPT-SUMM-LEVEL.             51600000
513900                                                                  51610000
514000     STRING 'GMM '                                                51620000
514100            PV-RPT-SUMM-LEVEL                                     51630000
514200            DELIMITED BY SIZE INTO RPT-SUMM-TOT-LEVEL.            51640000
514300                                                                  51650000
514400     WRITE REPORT-RECORD                                          51660000
514500         FROM REPORT-SUMM-HEADING-TOT-LINE                        51670000
514600         AFTER ADVANCING 2 LINES.                                 51680000
514700                                                                  51690000
514800**** SUM ONLY THE GMM MARKDOWNS AND MARKDOWN/CANCELLATIONS        51700000
514900                                                                  51710000
515000     MOVE ZEROES               TO PV-TOT-MU-MD-AMT.               51720000
515100                                                                  51730000
515200     IF CR-VALID-SEASON                                           51740000
515300         PERFORM D660-GET-GMM-MKDN-MONTHLY-SUM                    51750000
515400             VARYING PV-SUB                                       51760000
515500             FROM 1 BY 1                                          51770000
515600             UNTIL (PV-SUB > 6)                                   51780000
515700                OR (PV-SUB > PV-CALC-SEASON-MONTH)                51790000
515800                                                                  51800000
515900         PERFORM D640-POPULATE-GMM-TOTAL-AMTS                     51810000
516000             VARYING PV-SUB                                       51820000
516100             FROM 1 BY 1                                          51830000
516200             UNTIL (PV-SUB > 6)                                   51840000
516300                OR (PV-SUB > PV-CALC-SEASON-MONTH)                51850000
516400     ELSE                                                         51860000
516500         PERFORM D610-GET-GMM-MKDN-WEEKLY-SUM                     51870000
516600             VARYING PV-SUB                                       51880000
516700             FROM 1 BY 1                                          51890000
516800             UNTIL PV-SUB > PV-FISCAL-PERIOD-WEEK                 51900000
516900                                                                  51910000
517000         PERFORM D640-POPULATE-GMM-TOTAL-AMTS                     51920000
517100             VARYING PV-SUB                                       51930000
517200             FROM 1 BY 1                                          51940000
517300             UNTIL PV-SUB > PV-FISCAL-PERIOD-WEEK                 51950000
517400     END-IF.                                                      51960000
517500                                                                  51970000
517600     MOVE PC-MARKDOWN-TOTAL    TO RPT-SUMM-TOT-DESC.              51980000
517700     PERFORM D650-WRITE-GMM-TOTAL-LINE.                           51990000
517800                                                                  52000000
517900**** SUM ONLY THE GMM MARKUPS AND MARKUP/CANCELLATIONS            52010000
518000                                                                  52020000
518100     MOVE ZEROES               TO PV-TOT-MU-MD-AMT.               52030000
518200                                                                  52040000
518300     IF CR-VALID-SEASON                                           52050000
518400         PERFORM D670-GET-GMM-MKUP-MONTHLY-SUM                    52060000
518500             VARYING PV-SUB                                       52070000
518600             FROM 1 BY 1                                          52080000
518700             UNTIL (PV-SUB > 6)                                   52090000
518800                OR (PV-SUB > PV-CALC-SEASON-MONTH)                52100000
518900                                                                  52110000
519000         PERFORM D640-POPULATE-GMM-TOTAL-AMTS                     52120000
519100             VARYING PV-SUB                                       52130000
519200             FROM 1 BY 1                                          52140000
519300             UNTIL (PV-SUB > 6)                                   52150000
519400                OR (PV-SUB > PV-CALC-SEASON-MONTH)                52160000
519500     ELSE                                                         52170000
519600         PERFORM D620-GET-GMM-MKUP-WEEKLY-SUM                     52180000
519700             VARYING PV-SUB                                       52190000
519800             FROM 1 BY 1                                          52200000
519900             UNTIL PV-SUB > PV-FISCAL-PERIOD-WEEK                 52210000
520000                                                                  52220000
520100         PERFORM D640-POPULATE-GMM-TOTAL-AMTS                     52230000
520200             VARYING PV-SUB                                       52240000
520300             FROM 1 BY 1                                          52250000
520400             UNTIL PV-SUB > PV-FISCAL-PERIOD-WEEK                 52260000
520500     END-IF.                                                      52270000
520600                                                                  52280000
520700     MOVE PC-MARKUP-TOTAL      TO RPT-SUMM-TOT-DESC.              52290000
520800     PERFORM D650-WRITE-GMM-TOTAL-LINE.                           52300000
520900                                                                  52310000
521000**** SUM ALL THE MARKDOWNS AND MARKUPS FOR THE GMM                52320000
521100                                                                  52330000
521200     MOVE ZEROES               TO PV-TOT-MU-MD-AMT.               52340000
521300                                                                  52350000
521400     IF CR-VALID-SEASON                                           52360000
521500         PERFORM D680-GET-GMM-MONTHLY-SUM                         52370000
521600             VARYING PV-SUB                                       52380000
521700             FROM 1 BY 1                                          52390000
521800             UNTIL (PV-SUB > 6)                                   52400000
521900                OR (PV-SUB > PV-CALC-SEASON-MONTH)                52410000
522000                                                                  52420000
522100         PERFORM D640-POPULATE-GMM-TOTAL-AMTS                     52430000
522200             VARYING PV-SUB                                       52440000
522300             FROM 1 BY 1                                          52450000
522400             UNTIL (PV-SUB > 6)                                   52460000
522500                OR (PV-SUB > PV-CALC-SEASON-MONTH)                52470000
522600     ELSE                                                         52480000
522700         PERFORM D630-GET-GMM-WEEKLY-SUM                          52490000
522800             VARYING PV-SUB                                       52500000
522900             FROM 1 BY 1                                          52510000
523000             UNTIL PV-SUB > PV-FISCAL-PERIOD-WEEK                 52520000
523100                                                                  52530000
523200         PERFORM D640-POPULATE-GMM-TOTAL-AMTS                     52540000
523300             VARYING PV-SUB                                       52550000
523400             FROM 1 BY 1                                          52560000
523500             UNTIL PV-SUB > PV-FISCAL-PERIOD-WEEK                 52570000
523600     END-IF.                                                      52580000
523700                                                                  52590000
523800     MOVE PC-NET-TOTAL         TO RPT-SUMM-TOT-DESC.              52600000
523900     PERFORM D650-WRITE-GMM-TOTAL-LINE.                           52610000
524000                                                                  52620000
524100     WRITE REPORT-RECORD                                          52630000
524200         FROM REPORT-UNDERLINE                                    52640000
524300         AFTER ADVANCING 1 LINE.                                  52650000
524400                                                                  52660000
524500******************************************************************52670000
524600*     D610-GET-GMM-MKDN-WEEKLY-SUM                               *52680000
524700* ==> PROCESSES:                                                 *52690000
524800*     - SELECT THE SUM FOR THE FISCAL WEEK BY DMM                *52700000
524900* ==> PERFORMED FROM:                                            *52710000
525000******************************************************************52720000
525100 D610-GET-GMM-MKDN-WEEKLY-SUM.                                    52730000
525200                                                                  52740000
525300     MOVE PV-SUB               TO PV-FSCL-WK-NUMERIC.             52750000
525400     MOVE PV-FSCL-WK-NUMERIC   TO PV-FSCL-WK-ALPHA.               52760000
525500                                                                  52770000
525600     EXEC SQL                                                     52780000
525700         SELECT SUM(TOT_MU_MD_AMT)                                52790000
525800           INTO :PV-TOT-MU-MD-AMT                                 52800000
525900           FROM                                                   52810000
526000                TMDSEAR A                                         52820000
526100              , TWKMUMD M                                         52830000
526200          WHERE                                                   52840000
526300                A.OPERCO_NBR       = '03'                         52850000
526400            AND A.GMA_NBR          = :PV-HOLD-GMA-NBR             52860000
526500            AND A.MDSELV_CDE       = 'DPT'                        52870000
526600            AND A.DEPT_NBR         = M.DEPT_NBR                   52880000
526700            AND (CURRENT DATE                                     52890000
526800                                 BETWEEN A.STRT_DTE AND A.END_DTE)52900000
526900            AND M.FSCL_MN          = :WKMUMD-FSCL-MN              52910000
527000            AND M.FSCL_YR          = :WKMUMD-FSCL-YR              52920000
527100            AND M.FSCL_WK          = :PV-FSCL-WK-ALPHA            52930000
527200            AND M.PRIC_CHG_TYP_CDE IN ('1','2')                   52940000
527300     END-EXEC.                                                    52950000
527400                                                                  52960000
527500     EVALUATE TRUE                                                52970000
527600         WHEN SQLCODE = +0                                        52980000
527700             MOVE PV-TOT-MU-MD-AMT                                52990000
527800                               TO PV-SUM-BY-GMM (PV-SUB)          53000000
527900             ADD PV-SUM-BY-GMM (PV-SUB)                           53010000
528000                               TO PV-SUM-BY-GMM-TOTAL             53020000
528100             MOVE ZEROES       TO PV-TOT-MU-MD-AMT                53030000
528200                                                                  53040000
528300         WHEN SQLCODE = -305                                      53050000
528400             MOVE ZERO         TO PV-SUM-BY-GMM (PV-SUB)          53060000
528500                                                                  53070000
528600         WHEN OTHER                                               53080000
528700             MOVE 'D610-GET-GMM-MKDN-WEEKLY-SUM'                  53090000
528800                               TO PV-PARAGRAPH-NAME               53100000
528900             MOVE 'SELECT WKLY SUM FOR GMM - MKDNS'               53110000
529000                               TO PV-DB2-OPERATION-ATTEMPTED      53120000
529100             PERFORM Z900-SQL-ABEND                               53130000
529200     END-EVALUATE.                                                53140000
529300                                                                  53150000
529400******************************************************************53160000
529500*     D620-GET-GMM-MKUP-WEEKLY-SUM                               *53170000
529600* ==> PROCESSES:                                                 *53180000
529700*     - SELECT THE SUM FOR THE FISCAL WEEK BY DMM                *53190000
529800* ==> PERFORMED FROM:                                            *53200000
529900******************************************************************53210000
530000 D620-GET-GMM-MKUP-WEEKLY-SUM.                                    53220000
530100                                                                  53230000
530200     MOVE PV-SUB               TO PV-FSCL-WK-NUMERIC.             53240000
530300     MOVE PV-FSCL-WK-NUMERIC   TO PV-FSCL-WK-ALPHA.               53250000
530400                                                                  53260000
530500     EXEC SQL                                                     53270000
530600         SELECT SUM(TOT_MU_MD_AMT)                                53280000
530700           INTO :PV-TOT-MU-MD-AMT                                 53290000
530800           FROM                                                   53300000
530900                TMDSEAR A                                         53310000
531000              , TWKMUMD M                                         53320000
531100          WHERE                                                   53330000
531200                A.OPERCO_NBR       = '03'                         53340000
531300            AND A.GMA_NBR          = :PV-HOLD-GMA-NBR             53350000
531400            AND A.MDSELV_CDE       = 'DPT'                        53360000
531500            AND A.DEPT_NBR         = M.DEPT_NBR                   53370000
531600            AND (CURRENT DATE                                     53380000
531700                                 BETWEEN A.STRT_DTE AND A.END_DTE)53390000
531800            AND M.FSCL_MN          = :WKMUMD-FSCL-MN              53400000
531900            AND M.FSCL_YR          = :WKMUMD-FSCL-YR              53410000
532000            AND M.FSCL_WK          = :PV-FSCL-WK-ALPHA            53420000
532100            AND M.PRIC_CHG_TYP_CDE IN ('3','4')                   53430000
532200     END-EXEC.                                                    53440000
532300                                                                  53450000
532400     EVALUATE TRUE                                                53460000
532500         WHEN SQLCODE = +0                                        53470000
532600             MOVE PV-TOT-MU-MD-AMT                                53480000
532700                               TO PV-SUM-BY-GMM (PV-SUB)          53490000
532800             ADD PV-SUM-BY-GMM (PV-SUB)                           53500000
532900                               TO PV-SUM-BY-GMM-TOTAL             53510000
533000             MOVE ZEROES       TO PV-TOT-MU-MD-AMT                53520000
533100                                                                  53530000
533200         WHEN SQLCODE = -305                                      53540000
533300             MOVE ZERO         TO PV-SUM-BY-GMM (PV-SUB)          53550000
533400                                                                  53560000
533500         WHEN OTHER                                               53570000
533600             MOVE 'D620-GET-GMM-MKUP-WEEKLY-SUM'                  53580000
533700                               TO PV-PARAGRAPH-NAME               53590000
533800             MOVE 'SELECT WKLY SUM FOR GMM - MKUPS'               53600000
533900                               TO PV-DB2-OPERATION-ATTEMPTED      53610000
534000             PERFORM Z900-SQL-ABEND                               53620000
534100     END-EVALUATE.                                                53630000
534200                                                                  53640000
534300******************************************************************53650000
534400*     D630-GET-GMM-WEEKLY-SUM                                    *53660000
534500* ==> PROCESSES:                                                 *53670000
534600*     - SELECT THE SUM FOR THE FISCAL WEEK BY DMM                *53680000
534700* ==> PERFORMED FROM:                                            *53690000
534800******************************************************************53700000
534900 D630-GET-GMM-WEEKLY-SUM.                                         53710000
535000                                                                  53720000
535100     MOVE PV-SUB               TO PV-FSCL-WK-NUMERIC.             53730000
535200     MOVE PV-FSCL-WK-NUMERIC   TO PV-FSCL-WK-ALPHA.               53740000
535300                                                                  53750000
535400     EXEC SQL                                                     53760000
535500         SELECT SUM(TOT_MU_MD_AMT)                                53770000
535600           INTO :PV-TOT-MU-MD-AMT                                 53780000
535700           FROM                                                   53790000
535800                TMDSEAR A                                         53800000
535900              , TWKMUMD M                                         53810000
536000          WHERE                                                   53820000
536100                A.OPERCO_NBR       = '03'                         53830000
536200            AND A.GMA_NBR          = :PV-HOLD-GMA-NBR             53840000
536300            AND A.MDSELV_CDE       = 'DPT'                        53850000
536400            AND A.DEPT_NBR         = M.DEPT_NBR                   53860000
536500            AND (CURRENT DATE                                     53870000
536600                                 BETWEEN A.STRT_DTE AND A.END_DTE)53880000
536700            AND M.FSCL_MN          = :WKMUMD-FSCL-MN              53890000
536800            AND M.FSCL_YR          = :WKMUMD-FSCL-YR              53900000
536900            AND M.FSCL_WK          = :PV-FSCL-WK-ALPHA            53910000
537000     END-EXEC.                                                    53920000
537100                                                                  53930000
537200     EVALUATE TRUE                                                53940000
537300         WHEN SQLCODE = +0                                        53950000
537400             MOVE PV-TOT-MU-MD-AMT                                53960000
537500                               TO PV-SUM-BY-GMM (PV-SUB)          53970000
537600             ADD PV-SUM-BY-GMM (PV-SUB)                           53980000
537700                               TO PV-SUM-BY-GMM-TOTAL             53990000
537800             MOVE ZEROES       TO PV-TOT-MU-MD-AMT                54000000
537900                                                                  54010000
538000         WHEN SQLCODE = -305                                      54020000
538100             MOVE ZERO         TO PV-SUM-BY-GMM (PV-SUB)          54030000
538200                                                                  54040000
538300         WHEN OTHER                                               54050000
538400             MOVE 'D630-GET-GMM-WEEKLY-SUM   '                    54060000
538500                               TO PV-PARAGRAPH-NAME               54070000
538600             MOVE 'SELECT WEEKLY SUM AT GMM LEVEL '               54080000
538700                               TO PV-DB2-OPERATION-ATTEMPTED      54090000
538800             PERFORM Z900-SQL-ABEND                               54100000
538900     END-EVALUATE.                                                54110000
539000                                                                  54120000
539100******************************************************************54130000
539200*     D640-POPULATE-GMM-TOTAL-AMTS                               *54140000
539300* ==> PROCESSES:                                                 *54150000
539400* ==> PERFORMED FROM:                                            *54160000
539500*                                                                *54170000
539600******************************************************************54180000
539700 D640-POPULATE-GMM-TOTAL-AMTS.                                    54190000
539800                                                                  54200000
539900     EVALUATE PV-SUB                                              54210000
540000         WHEN 01                                                  54220000
540100             MOVE PV-SUM-BY-GMM (PV-SUB)                          54230000
540200                        TO PV-MKDN-TYPE-TOT-PER-AMT               54240000
540300             MOVE PV-MKDN-TYPE-TOT-PER-AMT                        54250000
540400                        TO RPT-SUMM-TOT-PER-1-AMT                 54260000
540500         WHEN 02                                                  54270000
540600             MOVE PV-SUM-BY-GMM (PV-SUB)                          54280000
540700                        TO PV-MKDN-TYPE-TOT-PER-AMT               54290000
540800             MOVE PV-MKDN-TYPE-TOT-PER-AMT                        54300000
540900                        TO RPT-SUMM-TOT-PER-2-AMT                 54310000
541000         WHEN 03                                                  54320000
541100             MOVE PV-SUM-BY-GMM (PV-SUB)                          54330000
541200                        TO PV-MKDN-TYPE-TOT-PER-AMT               54340000
541300             MOVE PV-MKDN-TYPE-TOT-PER-AMT                        54350000
541400                        TO RPT-SUMM-TOT-PER-3-AMT                 54360000
541500         WHEN 04                                                  54370000
541600             MOVE PV-SUM-BY-GMM (PV-SUB)                          54380000
541700                        TO PV-MKDN-TYPE-TOT-PER-AMT               54390000
541800             MOVE PV-MKDN-TYPE-TOT-PER-AMT                        54400000
541900                        TO RPT-SUMM-TOT-PER-4-AMT                 54410000
542000         WHEN 05                                                  54420000
542100             MOVE PV-SUM-BY-GMM (PV-SUB)                          54430000
542200                        TO PV-MKDN-TYPE-TOT-PER-AMT               54440000
542300             MOVE PV-MKDN-TYPE-TOT-PER-AMT                        54450000
542400                        TO RPT-SUMM-TOT-PER-5-AMT                 54460000
542500         WHEN 06                                                  54470000
542600             MOVE PV-SUM-BY-GMM (PV-SUB)                          54480000
542700                        TO PV-MKDN-TYPE-TOT-PER-AMT               54490000
542800             MOVE PV-MKDN-TYPE-TOT-PER-AMT                        54500000
542900                        TO RPT-SUMM-TOT-PER-6-AMT                 54510000
543000     END-EVALUATE.                                                54520000
543100                                                                  54530000
543200******************************************************************54540000
543300*     D650-WRITE-GMM-TOTAL-LINE                                  *54550000
543400* ==> PROCESSES:                                                 *54560000
543500* ==> PERFORMED FROM:                                            *54570000
543600*                                                                *54580000
543700******************************************************************54590000
543800 D650-WRITE-GMM-TOTAL-LINE.                                       54600000
543900                                                                  54610000
544000     MOVE PV-SUM-BY-GMM-TOTAL  TO PV-MKDN-TYPE-TOT-PER-AMT.       54620000
544100     MOVE PV-MKDN-TYPE-TOT-PER-AMT                                54630000
544200                               TO RPT-SUMM-TOT-PER-AMOUNT.        54640000
544300                                                                  54650000
544400     WRITE REPORT-RECORD                                          54660000
544500         FROM REPORT-SUMMARY-TOT-LINE                             54670000
544600         AFTER ADVANCING 1 LINE.                                  54680000
544700                                                                  54690000
544800     MOVE ZEROES  TO PV-SUM-BY-GMM-TOTAL.                         54700000
544900                                                                  54710000
545000     INITIALIZE REPORT-SUMMARY-TOT-LINE.                          54720000
545100                                                                  54730000
545200******************************************************************54740000
545300*     D660-GET-GMM-MKDN-MONTHLY-SUM                              *54750000
545400* ==> PROCESSES:                                                 *54760000
545500*     - SELECT THE SUM FOR THE FISCAL MONTH BY GMM               *54770000
545600* ==> PERFORMED FROM:                                            *54780000
545700******************************************************************54790000
545800 D660-GET-GMM-MKDN-MONTHLY-SUM.                                   54800000
545900                                                                  54810000
546000     MOVE PV-SUB               TO PV-FSCL-MN-NUMERIC.             54820000
546100                                                                  54830000
546200     IF CR-FALL                                                   54840000
546300         ADD 6                 TO PV-FSCL-MN-NUMERIC              54850000
546400     END-IF.                                                      54860000
546500                                                                  54870000
546600     MOVE PV-FSCL-MN-NUMERIC   TO PV-FSCL-MN-ALPHA.               54880000
546700                                                                  54890000
546800     EXEC SQL                                                     54900000
546900         SELECT SUM(TOT_MU_MD_AMT)                                54910000
547000           INTO :PV-TOT-MU-MD-AMT                                 54920000
547100           FROM                                                   54930000
547200                TMDSEAR A                                         54940000
547300              , TWKMUMD M                                         54950000
547400          WHERE                                                   54960000
547500                A.OPERCO_NBR       = '03'                         54970000
547600            AND A.GMA_NBR          = :PV-HOLD-GMA-NBR             54980000
547700            AND A.MDSELV_CDE       = 'DPT'                        54990000
547800            AND A.DEPT_NBR         = M.DEPT_NBR                   55000000
547900            AND (CURRENT DATE                                     55010000
548000                                 BETWEEN A.STRT_DTE AND A.END_DTE)55020000
548100            AND M.FSCL_MN          = :PV-FSCL-MN-ALPHA            55030000
548200            AND M.FSCL_YR          = :WKMUMD-FSCL-YR              55040000
548300            AND M.PRIC_CHG_TYP_CDE IN ('1','2')                   55050000
548400     END-EXEC.                                                    55060000
548500                                                                  55070000
548600     EVALUATE TRUE                                                55080000
548700         WHEN SQLCODE = +0                                        55090000
548800             MOVE PV-TOT-MU-MD-AMT                                55100000
548900                               TO PV-SUM-BY-GMM (PV-SUB)          55110000
549000             ADD PV-SUM-BY-GMM (PV-SUB)                           55120000
549100                               TO PV-SUM-BY-GMM-TOTAL             55130000
549200             MOVE ZEROES       TO PV-TOT-MU-MD-AMT                55140000
549300                                                                  55150000
549400         WHEN SQLCODE = -305                                      55160000
549500             MOVE ZERO         TO PV-SUM-BY-GMM (PV-SUB)          55170000
549600                                                                  55180000
549700         WHEN OTHER                                               55190000
549800             MOVE 'D660-GET-GMM-MKDN-MONTHLY-SUM'                 55200000
549900                               TO PV-PARAGRAPH-NAME               55210000
550000             MOVE 'SELECT MNTHLY SUM FOR GMM - MKDNS'             55220000
550100                               TO PV-DB2-OPERATION-ATTEMPTED      55230000
550200             PERFORM Z900-SQL-ABEND                               55240000
550300     END-EVALUATE.                                                55250000
550400                                                                  55260000
550500******************************************************************55270000
550600*     D670-GET-GMM-MKUP-MONTHLY-SUM                              *55280000
550700* ==> PROCESSES:                                                 *55290000
550800*     - SELECT THE SUM FOR THE FISCAL MONTH BY GMM               *55300000
550900* ==> PERFORMED FROM:                                            *55310000
551000******************************************************************55320000
551100 D670-GET-GMM-MKUP-MONTHLY-SUM.                                   55330000
551200                                                                  55340000
551300     MOVE PV-SUB               TO PV-FSCL-MN-NUMERIC.             55350000
551400                                                                  55360000
551500     IF CR-FALL                                                   55370000
551600         ADD 6                 TO PV-FSCL-MN-NUMERIC              55380000
551700     END-IF.                                                      55390000
551800                                                                  55400000
551900     MOVE PV-FSCL-MN-NUMERIC   TO PV-FSCL-MN-ALPHA.               55410000
552000                                                                  55420000
552100     EXEC SQL                                                     55430000
552200         SELECT SUM(TOT_MU_MD_AMT)                                55440000
552300           INTO :PV-TOT-MU-MD-AMT                                 55450000
552400           FROM                                                   55460000
552500                TMDSEAR A                                         55470000
552600              , TWKMUMD M                                         55480000
552700          WHERE                                                   55490000
552800                A.OPERCO_NBR       = '03'                         55500000
552900            AND A.GMA_NBR          = :PV-HOLD-GMA-NBR             55510000
553000            AND A.MDSELV_CDE       = 'DPT'                        55520000
553100            AND A.DEPT_NBR         = M.DEPT_NBR                   55530000
553200            AND (CURRENT DATE                                     55540000
553300                                 BETWEEN A.STRT_DTE AND A.END_DTE)55550000
553400            AND M.FSCL_MN          = :PV-FSCL-MN-ALPHA            55560000
553500            AND M.FSCL_YR          = :WKMUMD-FSCL-YR              55570000
553600            AND M.PRIC_CHG_TYP_CDE IN ('3','4')                   55580000
553700     END-EXEC.                                                    55590000
553800                                                                  55600000
553900     EVALUATE TRUE                                                55610000
554000         WHEN SQLCODE = +0                                        55620000
554100             MOVE PV-TOT-MU-MD-AMT                                55630000
554200                               TO PV-SUM-BY-GMM (PV-SUB)          55640000
554300             ADD PV-SUM-BY-GMM (PV-SUB)                           55650000
554400                               TO PV-SUM-BY-GMM-TOTAL             55660000
554500             MOVE ZEROES       TO PV-TOT-MU-MD-AMT                55670000
554600                                                                  55680000
554700         WHEN SQLCODE = -305                                      55690000
554800             MOVE ZERO         TO PV-SUM-BY-GMM (PV-SUB)          55700000
554900                                                                  55710000
555000         WHEN OTHER                                               55720000
555100             MOVE 'D670-GET-GMM-MKUP-MONTHLY-SUM'                 55730000
555200                               TO PV-PARAGRAPH-NAME               55740000
555300             MOVE 'SELECT MTHLY SUM FOR GMM - MKUPS'              55750000
555400                               TO PV-DB2-OPERATION-ATTEMPTED      55760000
555500             PERFORM Z900-SQL-ABEND                               55770000
555600     END-EVALUATE.                                                55780000
555700                                                                  55790000
555800******************************************************************55800000
555900*     D680-GET-GMM-MONTHLY-SUM                                   *55810000
556000* ==> PROCESSES:                                                 *55820000
556100*     - SELECT THE SUM FOR THE FISCAL MONTH BY GMM               *55830000
556200* ==> PERFORMED FROM:                                            *55840000
556300******************************************************************55850000
556400 D680-GET-GMM-MONTHLY-SUM.                                        55860000
556500                                                                  55870000
556600     MOVE PV-SUB               TO PV-FSCL-MN-NUMERIC.             55880000
556700     MOVE PV-FSCL-MN-NUMERIC   TO PV-FSCL-MN-ALPHA.               55890000
556800                                                                  55900000
556900     EXEC SQL                                                     55910000
557000         SELECT SUM(TOT_MU_MD_AMT)                                55920000
557100           INTO :PV-TOT-MU-MD-AMT                                 55930000
557200           FROM                                                   55940000
557300                TMDSEAR A                                         55950000
557400              , TWKMUMD M                                         55960000
557500          WHERE                                                   55970000
557600                A.OPERCO_NBR       = '03'                         55980000
557700            AND A.GMA_NBR          = :PV-HOLD-GMA-NBR             55990000
557800            AND A.MDSELV_CDE       = 'DPT'                        56000000
557900            AND A.DEPT_NBR         = M.DEPT_NBR                   56010000
558000            AND (CURRENT DATE                                     56020000
558100                                 BETWEEN A.STRT_DTE AND A.END_DTE)56030000
558200            AND M.FSCL_MN          = :PV-FSCL-MN-ALPHA            56040000
558300            AND M.FSCL_YR          = :WKMUMD-FSCL-YR              56050000
558400     END-EXEC.                                                    56060000
558500                                                                  56070000
558600     EVALUATE TRUE                                                56080000
558700         WHEN SQLCODE = +0                                        56090000
558800             MOVE PV-TOT-MU-MD-AMT                                56100000
558900                               TO PV-SUM-BY-GMM (PV-SUB)          56110000
559000             ADD PV-SUM-BY-GMM (PV-SUB)                           56120000
559100                               TO PV-SUM-BY-GMM-TOTAL             56130000
559200             MOVE ZEROES       TO PV-TOT-MU-MD-AMT                56140000
559300                                                                  56150000
559400         WHEN SQLCODE = -305                                      56160000
559500             MOVE ZERO         TO PV-SUM-BY-GMM (PV-SUB)          56170000
559600                                                                  56180000
559700         WHEN OTHER                                               56190000
559800             MOVE 'D680-GET-GMM-MONTHLY-SUM  '                    56200000
559900                               TO PV-PARAGRAPH-NAME               56210000
560000             MOVE 'SELECT MONTHLY SUM AT GMM LEVEL'               56220000
560100                               TO PV-DB2-OPERATION-ATTEMPTED      56230000
560200             PERFORM Z900-SQL-ABEND                               56240000
560300     END-EVALUATE.                                                56250000
560400                                                                  56260000
560500******************************************************************56270000
560600*     D600-PRINT-CORP-TOT-LINE                                   *56280000
560700* ==> PROCESSES:                                                 *56290000
560800* ==> PERFORMED FROM:                                            *56300000
560900*                                                                *56310000
561000******************************************************************56320000
561100 D600-PRINT-CORP-TOT-LINE.                                        56330000
561200                                                                  56340000
561300     ADD +7                 TO PA-LINE-COUNTER.                   56350000
561400     IF PA-LINE-COUNTER >= PC-MAX-LINES-PER-PAGE                  56360000
561500         PERFORM D100-PROCESS-PAGE-BREAK                          56370000
561600         ADD PC-THREE       TO PA-LINE-COUNTER                    56380000
561700     END-IF.                                                      56390000
561800                                                                  56400000
561900                                                                  56410000
562000     INITIALIZE REPORT-SUMM-HEADING-TOT-LINE.                     56420000
562100     STRING 'CORPORATE'                                           56430000
562200            ' '                                                   56440000
562300            'TOTALS: '                                            56450000
562400            DELIMITED BY SIZE INTO RPT-SUMM-TOT-LEVEL.            56460000
562500                                                                  56470000
562600     WRITE REPORT-RECORD                                          56480000
562700         FROM REPORT-SUMM-HEADING-TOT-LINE                        56490000
562800         AFTER ADVANCING 2 LINES.                                 56500000
562900                                                                  56510000
563000**** SUM ONLY THE CORP MARKDOWNS AND MARKDOWN/CANCELLATIONS       56520000
563100                                                                  56530000
563200     MOVE ZEROES               TO PV-TOT-MU-MD-AMT.               56540000
563300                                                                  56550000
563400     IF CR-VALID-SEASON                                           56560000
563500         PERFORM D660-GET-CORP-MKDN-MONTHLY-SUM                   56570000
563600             VARYING PV-SUB                                       56580000
563700             FROM 1 BY 1                                          56590000
563800             UNTIL (PV-SUB > 6)                                   56600000
563900                OR (PV-SUB > PV-CALC-SEASON-MONTH)                56610000
564000                                                                  56620000
564100         PERFORM D640-POPULATE-CORP-TOTAL-AMTS                    56630000
564200             VARYING PV-SUB                                       56640000
564300             FROM 1 BY 1                                          56650000
564400             UNTIL (PV-SUB > 6)                                   56660000
564500                OR (PV-SUB > PV-CALC-SEASON-MONTH)                56670000
564600     ELSE                                                         56680000
564700         PERFORM D610-GET-CORP-MKDN-WEEKLY-SUM                    56690000
564800             VARYING PV-SUB                                       56700000
564900             FROM 1 BY 1                                          56710000
565000             UNTIL PV-SUB > PV-FISCAL-PERIOD-WEEK                 56720000
565100                                                                  56730000
565200         PERFORM D640-POPULATE-CORP-TOTAL-AMTS                    56740000
565300             VARYING PV-SUB                                       56750000
565400             FROM 1 BY 1                                          56760000
565500             UNTIL PV-SUB > PV-FISCAL-PERIOD-WEEK                 56770000
565600     END-IF.                                                      56780000
565700                                                                  56790000
565800     MOVE PC-MARKDOWN-TOTAL    TO RPT-SUMM-TOT-DESC.              56800000
565900     PERFORM D650-WRITE-CORP-TOTAL-LINE.                          56810000
566000                                                                  56820000
566100**** SUM ONLY THE CORP MARKUPS AND MARKUP/CANCELLATIONS           56830000
566200                                                                  56840000
566300     MOVE ZEROES               TO PV-TOT-MU-MD-AMT.               56850000
566400                                                                  56860000
566500     IF CR-VALID-SEASON                                           56870000
566600         PERFORM D670-GET-CORP-MKUP-MONTHLY-SUM                   56880000
566700             VARYING PV-SUB                                       56890000
566800             FROM 1 BY 1                                          56900000
566900             UNTIL (PV-SUB > 6)                                   56910000
567000                OR (PV-SUB > PV-CALC-SEASON-MONTH)                56920000
567100                                                                  56930000
567200         PERFORM D640-POPULATE-CORP-TOTAL-AMTS                    56940000
567300             VARYING PV-SUB                                       56950000
567400             FROM 1 BY 1                                          56960000
567500             UNTIL (PV-SUB > 6)                                   56970000
567600                OR (PV-SUB > PV-CALC-SEASON-MONTH)                56980000
567700     ELSE                                                         56990000
567800         PERFORM D620-GET-CORP-MKUP-WEEKLY-SUM                    57000000
567900             VARYING PV-SUB                                       57010000
568000             FROM 1 BY 1                                          57020000
568100             UNTIL PV-SUB > PV-FISCAL-PERIOD-WEEK                 57030000
568200                                                                  57040000
568300         PERFORM D640-POPULATE-CORP-TOTAL-AMTS                    57050000
568400             VARYING PV-SUB                                       57060000
568500             FROM 1 BY 1                                          57070000
568600             UNTIL PV-SUB > PV-FISCAL-PERIOD-WEEK                 57080000
568700     END-IF.                                                      57090000
568800                                                                  57100000
568900     MOVE PC-MARKUP-TOTAL      TO RPT-SUMM-TOT-DESC.              57110000
569000     PERFORM D650-WRITE-CORP-TOTAL-LINE.                          57120000
569100                                                                  57130000
569200**** SUM ALL THE MARKDOWNS AND MARKUPS FOR THE CORP               57140000
569300                                                                  57150000
569400     MOVE ZEROES               TO PV-TOT-MU-MD-AMT.               57160000
569500                                                                  57170000
569600     IF CR-VALID-SEASON                                           57180000
569700         PERFORM D680-GET-CORP-MONTHLY-SUM                        57190000
569800             VARYING PV-SUB                                       57200000
569900             FROM 1 BY 1                                          57210000
570000             UNTIL (PV-SUB > 6)                                   57220000
570100                OR (PV-SUB > PV-CALC-SEASON-MONTH)                57230000
570200                                                                  57240000
570300         PERFORM D640-POPULATE-CORP-TOTAL-AMTS                    57250000
570400             VARYING PV-SUB                                       57260000
570500             FROM 1 BY 1                                          57270000
570600             UNTIL (PV-SUB > 6)                                   57280000
570700                OR (PV-SUB > PV-CALC-SEASON-MONTH)                57290000
570800     ELSE                                                         57300000
570900         PERFORM D630-GET-CORP-WEEKLY-SUM                         57310000
571000             VARYING PV-SUB                                       57320000
571100             FROM 1 BY 1                                          57330000
571200             UNTIL PV-SUB > PV-FISCAL-PERIOD-WEEK                 57340000
571300                                                                  57350000
571400         PERFORM D640-POPULATE-CORP-TOTAL-AMTS                    57360000
571500             VARYING PV-SUB                                       57370000
571600             FROM 1 BY 1                                          57380000
571700             UNTIL PV-SUB > PV-FISCAL-PERIOD-WEEK                 57390000
571800     END-IF.                                                      57400000
571900                                                                  57410000
572000     MOVE PC-NET-TOTAL         TO RPT-SUMM-TOT-DESC.              57420000
572100     PERFORM D650-WRITE-CORP-TOTAL-LINE.                          57430000
572200                                                                  57440000
572300     WRITE REPORT-RECORD                                          57450000
572400         FROM REPORT-UNDERLINE                                    57460000
572500         AFTER ADVANCING 1 LINE.                                  57470000
572600                                                                  57480000
572700******************************************************************57490000
572800*     D610-GET-CORP-MKDN-WEEKLY-SUM                              *57500000
572900* ==> PROCESSES:                                                 *57510000
573000*     - SELECT THE SUM FOR THE FISCAL WEEK BY DMM                *57520000
573100* ==> PERFORMED FROM:                                            *57530000
573200******************************************************************57540000
573300 D610-GET-CORP-MKDN-WEEKLY-SUM.                                   57550000
573400                                                                  57560000
573500     MOVE PV-SUB               TO PV-FSCL-WK-NUMERIC.             57570000
573600     MOVE PV-FSCL-WK-NUMERIC   TO PV-FSCL-WK-ALPHA.               57580000
573700                                                                  57590000
573800     EXEC SQL                                                     57600000
573900         SELECT SUM(TOT_MU_MD_AMT)                                57610000
574000           INTO :PV-TOT-MU-MD-AMT                                 57620000
574100           FROM                                                   57630000
574200                TMDSEAR A                                         57640000
574300              , TWKMUMD M                                         57650000
574400          WHERE                                                   57660000
574500                A.OPERCO_NBR       = '03'                         57670000
574600            AND A.MDSELV_CDE       = 'DPT'                        57680000
574700            AND A.DEPT_NBR         = M.DEPT_NBR                   57690000
574800            AND (CURRENT DATE                                     57700000
574900                                 BETWEEN A.STRT_DTE AND A.END_DTE)57710000
575000            AND M.FSCL_MN          = :WKMUMD-FSCL-MN              57720000
575100            AND M.FSCL_YR          = :WKMUMD-FSCL-YR              57730000
575200            AND M.FSCL_WK          = :PV-FSCL-WK-ALPHA            57740000
575300            AND M.PRIC_CHG_TYP_CDE IN ('1','2')                   57750000
575400     END-EXEC.                                                    57760000
575500                                                                  57770000
575600     EVALUATE TRUE                                                57780000
575700         WHEN SQLCODE = +0                                        57790000
575800             MOVE PV-TOT-MU-MD-AMT                                57800000
575900                               TO PV-SUM-BY-CORP (PV-SUB)         57810000
576000             ADD PV-SUM-BY-CORP (PV-SUB)                          57820000
576100                               TO PV-SUM-BY-CORP-TOTAL            57830000
576200             MOVE ZEROES       TO PV-TOT-MU-MD-AMT                57840000
576300                                                                  57850000
576400         WHEN SQLCODE = -305                                      57860000
576500             MOVE ZERO         TO PV-SUM-BY-CORP (PV-SUB)         57870000
576600                                                                  57880000
576700         WHEN OTHER                                               57890000
576800             MOVE 'D610-GET-CORP-MKDN-WEEKLY-SUM'                 57900000
576900                               TO PV-PARAGRAPH-NAME               57910000
577000             MOVE 'SELECT WKLY SUM FOR CORP- MKDNS'               57920000
577100                               TO PV-DB2-OPERATION-ATTEMPTED      57930000
577200             PERFORM Z900-SQL-ABEND                               57940000
577300     END-EVALUATE.                                                57950000
577400                                                                  57960000
577500******************************************************************57970000
577600*     D620-GET-CORP-MKUP-WEEKLY-SUM                              *57980000
577700* ==> PROCESSES:                                                 *57990000
577800*     - SELECT THE SUM FOR THE FISCAL WEEK BY DMM                *58000000
577900* ==> PERFORMED FROM:                                            *58010000
578000******************************************************************58020000
578100 D620-GET-CORP-MKUP-WEEKLY-SUM.                                   58030000
578200                                                                  58040000
578300     MOVE PV-SUB               TO PV-FSCL-WK-NUMERIC.             58050000
578400     MOVE PV-FSCL-WK-NUMERIC   TO PV-FSCL-WK-ALPHA.               58060000
578500                                                                  58070000
578600     EXEC SQL                                                     58080000
578700         SELECT SUM(TOT_MU_MD_AMT)                                58090000
578800           INTO :PV-TOT-MU-MD-AMT                                 58100000
578900           FROM                                                   58110000
579000                TMDSEAR A                                         58120000
579100              , TWKMUMD M                                         58130000
579200          WHERE                                                   58140000
579300                A.OPERCO_NBR       = '03'                         58150000
579400            AND A.MDSELV_CDE       = 'DPT'                        58160000
579500            AND A.DEPT_NBR         = M.DEPT_NBR                   58170000
579600            AND (CURRENT DATE                                     58180000
579700                                 BETWEEN A.STRT_DTE AND A.END_DTE)58190000
579800            AND M.FSCL_MN          = :WKMUMD-FSCL-MN              58200000
579900            AND M.FSCL_YR          = :WKMUMD-FSCL-YR              58210000
580000            AND M.FSCL_WK          = :PV-FSCL-WK-ALPHA            58220000
580100            AND M.PRIC_CHG_TYP_CDE IN ('3','4')                   58230000
580200     END-EXEC.                                                    58240000
580300                                                                  58250000
580400     EVALUATE TRUE                                                58260000
580500         WHEN SQLCODE = +0                                        58270000
580600             MOVE PV-TOT-MU-MD-AMT                                58280000
580700                               TO PV-SUM-BY-CORP (PV-SUB)         58290000
580800             ADD PV-SUM-BY-CORP (PV-SUB)                          58300000
580900                               TO PV-SUM-BY-CORP-TOTAL            58310000
581000             MOVE ZEROES       TO PV-TOT-MU-MD-AMT                58320000
581100                                                                  58330000
581200         WHEN SQLCODE = -305                                      58340000
581300             MOVE ZERO         TO PV-SUM-BY-CORP (PV-SUB)         58350000
581400                                                                  58360000
581500         WHEN OTHER                                               58370000
581600             MOVE 'D620-GET-CORP-MKUP-WEEKLY-SUM'                 58380000
581700                               TO PV-PARAGRAPH-NAME               58390000
581800             MOVE 'SELECT WKLY SUM FOR CORP - MKUPS'              58400000
581900                               TO PV-DB2-OPERATION-ATTEMPTED      58410000
582000             PERFORM Z900-SQL-ABEND                               58420000
582100     END-EVALUATE.                                                58430000
582200                                                                  58440000
582300******************************************************************58450000
582400*     D630-GET-CORP-WEEKLY-SUM                                   *58460000
582500* ==> PROCESSES:                                                 *58470000
582600*     - SELECT THE SUM FOR THE FISCAL WEEK BY DMM                *58480000
582700* ==> PERFORMED FROM:                                            *58490000
582800******************************************************************58500000
582900 D630-GET-CORP-WEEKLY-SUM.                                        58510000
583000                                                                  58520000
583100     MOVE PV-SUB               TO PV-FSCL-WK-NUMERIC.             58530000
583200     MOVE PV-FSCL-WK-NUMERIC   TO PV-FSCL-WK-ALPHA.               58540000
583300                                                                  58550000
583400     EXEC SQL                                                     58560000
583500         SELECT SUM(TOT_MU_MD_AMT)                                58570000
583600           INTO :PV-TOT-MU-MD-AMT                                 58580000
583700           FROM                                                   58590000
583800                TMDSEAR A                                         58600000
583900              , TWKMUMD M                                         58610000
584000          WHERE                                                   58620000
584100                A.OPERCO_NBR       = '03'                         58630000
584200            AND A.MDSELV_CDE       = 'DPT'                        58640000
584300            AND A.DEPT_NBR         = M.DEPT_NBR                   58650000
584400            AND (CURRENT DATE                                     58660000
584500                                 BETWEEN A.STRT_DTE AND A.END_DTE)58670000
584600            AND M.FSCL_MN          = :WKMUMD-FSCL-MN              58680000
584700            AND M.FSCL_YR          = :WKMUMD-FSCL-YR              58690000
584800            AND M.FSCL_WK          = :PV-FSCL-WK-ALPHA            58700000
584900     END-EXEC.                                                    58710000
585000                                                                  58720000
585100     EVALUATE TRUE                                                58730000
585200         WHEN SQLCODE = +0                                        58740000
585300             MOVE PV-TOT-MU-MD-AMT                                58750000
585400                               TO PV-SUM-BY-CORP (PV-SUB)         58760000
585500             ADD PV-SUM-BY-CORP (PV-SUB)                          58770000
585600                               TO PV-SUM-BY-CORP-TOTAL            58780000
585700             MOVE ZEROES       TO PV-TOT-MU-MD-AMT                58790000
585800                                                                  58800000
585900         WHEN SQLCODE = -305                                      58810000
586000             MOVE ZERO         TO PV-SUM-BY-CORP (PV-SUB)         58820000
586100                                                                  58830000
586200         WHEN OTHER                                               58840000
586300             MOVE 'D630-GET-CORP-WEEKLY-SUM   '                   58850000
586400                               TO PV-PARAGRAPH-NAME               58860000
586500             MOVE 'SELECT WEEKLY SUM AT CORP LEVEL'               58870000
586600                               TO PV-DB2-OPERATION-ATTEMPTED      58880000
586700             PERFORM Z900-SQL-ABEND                               58890000
586800     END-EVALUATE.                                                58900000
586900                                                                  58910000
587000******************************************************************58920000
587100*     D640-POPULATE-CORP-TOTAL-AMTS                              *58930000
587200* ==> PROCESSES:                                                 *58940000
587300*     -                                                          *58950000
587400* ==> PERFORMED FROM:                                            *58960000
587500******************************************************************58970000
587600 D640-POPULATE-CORP-TOTAL-AMTS.                                   58980000
587700                                                                  58990000
587800     EVALUATE PV-SUB                                              59000000
587900         WHEN 01                                                  59010000
588000             MOVE PV-SUM-BY-CORP (PV-SUB)                         59020000
588100                        TO PV-MKDN-TYPE-TOT-PER-AMT               59030000
588200             MOVE PV-MKDN-TYPE-TOT-PER-AMT                        59040000
588300                        TO RPT-SUMM-TOT-PER-1-AMT                 59050000
588400         WHEN 02                                                  59060000
588500             MOVE PV-SUM-BY-CORP (PV-SUB)                         59070000
588600                        TO PV-MKDN-TYPE-TOT-PER-AMT               59080000
588700             MOVE PV-MKDN-TYPE-TOT-PER-AMT                        59090000
588800                        TO RPT-SUMM-TOT-PER-2-AMT                 59100000
588900         WHEN 03                                                  59110000
589000             MOVE PV-SUM-BY-CORP (PV-SUB)                         59120000
589100                        TO PV-MKDN-TYPE-TOT-PER-AMT               59130000
589200             MOVE PV-MKDN-TYPE-TOT-PER-AMT                        59140000
589300                        TO RPT-SUMM-TOT-PER-3-AMT                 59150000
589400         WHEN 04                                                  59160000
589500             MOVE PV-SUM-BY-CORP (PV-SUB)                         59170000
589600                        TO PV-MKDN-TYPE-TOT-PER-AMT               59180000
589700             MOVE PV-MKDN-TYPE-TOT-PER-AMT                        59190000
589800                        TO RPT-SUMM-TOT-PER-4-AMT                 59200000
589900         WHEN 05                                                  59210000
590000             MOVE PV-SUM-BY-CORP (PV-SUB)                         59220000
590100                        TO PV-MKDN-TYPE-TOT-PER-AMT               59230000
590200             MOVE PV-MKDN-TYPE-TOT-PER-AMT                        59240000
590300                        TO RPT-SUMM-TOT-PER-5-AMT                 59250000
590400         WHEN 06                                                  59260000
590500             MOVE PV-SUM-BY-CORP (PV-SUB)                         59270000
590600                        TO PV-MKDN-TYPE-TOT-PER-AMT               59280000
590700             MOVE PV-MKDN-TYPE-TOT-PER-AMT                        59290000
590800                        TO RPT-SUMM-TOT-PER-6-AMT                 59300000
590900     END-EVALUATE.                                                59310000
591000                                                                  59320000
591100******************************************************************59330000
591200*     D650-WRITE-CORP-TOTAL-LINE                                 *59340000
591300* ==> PROCESSES:                                                 *59350000
591400*     -                                                          *59360000
591500* ==> PERFORMED FROM:                                            *59370000
591600******************************************************************59380000
591700 D650-WRITE-CORP-TOTAL-LINE.                                      59390000
591800                                                                  59400000
591900     MOVE PV-SUM-BY-CORP-TOTAL TO PV-MKDN-TYPE-TOT-PER-AMT.       59410000
592000     MOVE PV-MKDN-TYPE-TOT-PER-AMT                                59420000
592100                               TO RPT-SUMM-TOT-PER-AMOUNT.        59430000
592200                                                                  59440000
592300     WRITE REPORT-RECORD                                          59450000
592400         FROM REPORT-SUMMARY-TOT-LINE                             59460000
592500         AFTER ADVANCING 1 LINE.                                  59470000
592600                                                                  59480000
592700     MOVE ZEROES  TO PV-SUM-BY-CORP-TOTAL.                        59490000
592800                                                                  59500000
592900     INITIALIZE REPORT-SUMMARY-TOT-LINE.                          59510000
593000                                                                  59520000
593100******************************************************************59530000
593200*     D660-GET-CORP-MKDN-MONTHLY-SUM                             *59540000
593300* ==> PROCESSES:                                                 *59550000
593400*     - SELECT THE SUM FOR THE FISCAL MONTH FOR THE CORPORATION  *59560000
593500* ==> PERFORMED FROM:                                            *59570000
593600******************************************************************59580000
593700 D660-GET-CORP-MKDN-MONTHLY-SUM.                                  59590000
593800                                                                  59600000
593900     MOVE PV-SUB               TO PV-FSCL-MN-NUMERIC.             59610000
594000                                                                  59620000
594100     IF CR-FALL                                                   59630000
594200         ADD 6                 TO PV-FSCL-MN-NUMERIC              59640000
594300     END-IF.                                                      59650000
594400                                                                  59660000
594500     MOVE PV-FSCL-MN-NUMERIC   TO PV-FSCL-MN-ALPHA.               59670000
594600                                                                  59680000
594700     EXEC SQL                                                     59690000
594800         SELECT SUM(TOT_MU_MD_AMT)                                59700000
594900           INTO :PV-TOT-MU-MD-AMT                                 59710000
595000           FROM                                                   59720000
595100                TMDSEAR A                                         59730000
595200              , TWKMUMD M                                         59740000
595300          WHERE                                                   59750000
595400                A.OPERCO_NBR       = '03'                         59760000
595500            AND A.MDSELV_CDE       = 'DPT'                        59770000
595600            AND A.DEPT_NBR         = M.DEPT_NBR                   59780000
595700            AND (CURRENT DATE                                     59790000
595800                                 BETWEEN A.STRT_DTE AND A.END_DTE)59800000
595900            AND M.FSCL_MN          = :PV-FSCL-MN-ALPHA            59810000
596000            AND M.FSCL_YR          = :WKMUMD-FSCL-YR              59820000
596100            AND M.PRIC_CHG_TYP_CDE IN ('1','2')                   59830000
596200     END-EXEC.                                                    59840000
596300                                                                  59850000
596400     EVALUATE TRUE                                                59860000
596500         WHEN SQLCODE = +0                                        59870000
596600             MOVE PV-TOT-MU-MD-AMT                                59880000
596700                               TO PV-SUM-BY-CORP (PV-SUB)         59890000
596800             ADD PV-SUM-BY-CORP (PV-SUB)                          59900000
596900                               TO PV-SUM-BY-CORP-TOTAL            59910000
597000             MOVE ZEROES       TO PV-TOT-MU-MD-AMT                59920000
597100                                                                  59930000
597200         WHEN SQLCODE = -305                                      59940000
597300             MOVE ZERO         TO PV-SUM-BY-CORP (PV-SUB)         59950000
597400                                                                  59960000
597500         WHEN OTHER                                               59970000
597600             MOVE 'D660-GET-CORP-MKDN-MONTHLY-SUM'                59980000
597700                               TO PV-PARAGRAPH-NAME               59990000
597800             MOVE 'SELECT MNTHLY SUM FOR CORP-MKDNS'              60000000
597900                               TO PV-DB2-OPERATION-ATTEMPTED      60010000
598000             PERFORM Z900-SQL-ABEND                               60020000
598100     END-EVALUATE.                                                60030000
598200                                                                  60040000
598300******************************************************************60050000
598400*     D670-GET-CORP-MKUP-MONTHLY-SUM                             *60060000
598500* ==> PROCESSES:                                                 *60070000
598600*     - SELECT THE SUM FOR THE FISCAL MONTH FOR THE CORPORATION  *60080000
598700* ==> PERFORMED FROM:                                            *60090000
598800******************************************************************60100000
598900 D670-GET-CORP-MKUP-MONTHLY-SUM.                                  60110000
599000                                                                  60120000
599100     MOVE PV-SUB               TO PV-FSCL-MN-NUMERIC.             60130000
599200                                                                  60140000
599300     IF CR-FALL                                                   60150000
599400         ADD 6                 TO PV-FSCL-MN-NUMERIC              60160000
599500     END-IF.                                                      60170000
599600                                                                  60180000
599700     MOVE PV-FSCL-MN-NUMERIC   TO PV-FSCL-MN-ALPHA.               60190000
599800                                                                  60200000
599900     EXEC SQL                                                     60210000
600000         SELECT SUM(TOT_MU_MD_AMT)                                60220000
600100           INTO :PV-TOT-MU-MD-AMT                                 60230000
600200           FROM                                                   60240000
600300                TMDSEAR A                                         60250000
600400              , TWKMUMD M                                         60260000
600500          WHERE                                                   60270000
600600                A.OPERCO_NBR       = '03'                         60280000
600700            AND A.MDSELV_CDE       = 'DPT'                        60290000
600800            AND A.DEPT_NBR         = M.DEPT_NBR                   60300000
600900            AND (CURRENT DATE                                     60310000
601000                                 BETWEEN A.STRT_DTE AND A.END_DTE)60320000
601100            AND M.FSCL_MN          = :PV-FSCL-MN-ALPHA            60330000
601200            AND M.FSCL_YR          = :WKMUMD-FSCL-YR              60340000
601300            AND M.PRIC_CHG_TYP_CDE IN ('3','4')                   60350000
601400     END-EXEC.                                                    60360000
601500                                                                  60370000
601600     EVALUATE TRUE                                                60380000
601700         WHEN SQLCODE = +0                                        60390000
601800             MOVE PV-TOT-MU-MD-AMT                                60400000
601900                               TO PV-SUM-BY-CORP (PV-SUB)         60410000
602000             ADD PV-SUM-BY-CORP (PV-SUB)                          60420000
602100                               TO PV-SUM-BY-CORP-TOTAL            60430000
602200             MOVE ZEROES       TO PV-TOT-MU-MD-AMT                60440000
602300                                                                  60450000
602400         WHEN SQLCODE = -305                                      60460000
602500             MOVE ZERO         TO PV-SUM-BY-CORP (PV-SUB)         60470000
602600                                                                  60480000
602700         WHEN OTHER                                               60490000
602800             MOVE 'D670-GET-CORP-MKUP-MONTHLY-SUM'                60500000
602900                               TO PV-PARAGRAPH-NAME               60510000
603000             MOVE 'SELECT MNTHLY SUM FOR CORP-MKUPS'              60520000
603100                               TO PV-DB2-OPERATION-ATTEMPTED      60530000
603200             PERFORM Z900-SQL-ABEND                               60540000
603300     END-EVALUATE.                                                60550000
603400                                                                  60560000
603500******************************************************************60570000
603600*     D680-GET-CORP-MONTHLY-SUM                                  *60580000
603700* ==> PROCESSES:                                                 *60590000
603800*     - SELECT THE SUM FOR THE FISCAL MONTH FOR THE CORPORATION  *60600000
603900* ==> PERFORMED FROM:                                            *60610000
604000******************************************************************60620000
604100 D680-GET-CORP-MONTHLY-SUM.                                       60630000
604200                                                                  60640000
604300     MOVE PV-SUB               TO PV-FSCL-MN-NUMERIC.             60650000
604400                                                                  60660000
604500     IF CR-FALL                                                   60670000
604600         ADD 6                 TO PV-FSCL-MN-NUMERIC              60680000
604700     END-IF.                                                      60690000
604800                                                                  60700000
604900     MOVE PV-FSCL-MN-NUMERIC   TO PV-FSCL-MN-ALPHA.               60710000
605000                                                                  60720000
605100     EXEC SQL                                                     60730000
605200         SELECT SUM(TOT_MU_MD_AMT)                                60740000
605300           INTO :PV-TOT-MU-MD-AMT                                 60750000
605400           FROM                                                   60760000
605500                TMDSEAR A                                         60770000
605600              , TWKMUMD M                                         60780000
605700          WHERE                                                   60790000
605800                A.OPERCO_NBR       = '03'                         60800000
605900            AND A.MDSELV_CDE       = 'DPT'                        60810000
606000            AND A.DEPT_NBR         = M.DEPT_NBR                   60820000
606100            AND (CURRENT DATE                                     60830000
606200                                 BETWEEN A.STRT_DTE AND A.END_DTE)60840000
606300            AND M.FSCL_MN          = :PV-FSCL-MN-ALPHA            60850000
606400            AND M.FSCL_YR          = :WKMUMD-FSCL-YR              60860000
606500     END-EXEC.                                                    60870000
606600                                                                  60880000
606700     EVALUATE TRUE                                                60890000
606800         WHEN SQLCODE = +0                                        60900000
606900             MOVE PV-TOT-MU-MD-AMT                                60910000
607000                               TO PV-SUM-BY-CORP (PV-SUB)         60920000
607100             ADD PV-SUM-BY-CORP (PV-SUB)                          60930000
607200                               TO PV-SUM-BY-CORP-TOTAL            60940000
607300             MOVE ZEROES       TO PV-TOT-MU-MD-AMT                60950000
607400                                                                  60960000
607500         WHEN SQLCODE = -305                                      60970000
607600             MOVE ZERO         TO PV-SUM-BY-CORP (PV-SUB)         60980000
607700                                                                  60990000
607800         WHEN OTHER                                               61000000
607900             MOVE 'D680-GET-CORP-MONTHLY-SUM  '                   61010000
608000                               TO PV-PARAGRAPH-NAME               61020000
608100             MOVE 'SELECT MONTHLY SUM - CORP LEVEL'               61030000
608200                               TO PV-DB2-OPERATION-ATTEMPTED      61040000
608300             PERFORM Z900-SQL-ABEND                               61050000
608400     END-EVALUATE.                                                61060000
608500                                                                  61070000
608600******************************************************************61080000
608700*     E100-PRINT-ORGN-TYP-LINE                                   *61090000
608800* ==> PROCESSES:                                                 *61100000
608900*     - WRITES THE HEADING THAT SPECIFIES THE ORIGIN AND TYPE    *61110000
609000*       OF MARKDOWN                                              *61120000
609100* ==> PERFORMED FROM:  B200-WRITE-REPORT                         *61130000
609200*                      D100-PROCESS-PAGE-BREAK                   *61140000
609300******************************************************************61150000
609400 E100-PRINT-ORGN-TYP-LINE.                                        61160000
609500                                                                  61170000
609600     ADD PC-TWO             TO PA-LINE-COUNTER.                   61180000
609700     IF PA-LINE-COUNTER >= PC-MAX-LINES-PER-PAGE                  61190000
609800         PERFORM D100-PROCESS-PAGE-BREAK                          61200000
609900         ADD PC-TWO         TO PA-LINE-COUNTER                    61210000
610000     END-IF.                                                      61220000
610100                                                                  61230000
610200     INITIALIZE REPORT-HEADING-ORGN-TYP-LINE.                     61240000
610300                                                                  61250000
610400     MOVE SPACES            TO PV-SYSTEM-ORIGIN                   61260000
610500                               PV-MKDN-MKUP-TYP-CDE.              61270000
610600                                                                  61280000
610700     EVALUATE TRUE                                                61290000
610800         WHEN PV-HOLD-ORGN-BUYER                                  61300000
610900             MOVE PC-BUYER  TO PV-SYSTEM-ORIGIN                   61310000
611000         WHEN PV-HOLD-ORGN-INSTORE                                61320000
611100             MOVE PC-INSTORE                                      61330000
611200                            TO PV-SYSTEM-ORIGIN                   61340000
611300         WHEN PV-HOLD-ORGN-PROMO                                  61350000
611400             MOVE PC-PROMO  TO PV-SYSTEM-ORIGIN                   61360000
611500         WHEN PV-HOLD-ORGN-REGISTER                               61370000
611600             MOVE PC-REGISTER                                     61380000
611700                            TO PV-SYSTEM-ORIGIN                   61390000
611800         WHEN PV-HOLD-ORGN-UNMATCHED                              61400000
611900             MOVE PC-UNMATCHED                                    61410000
612000                            TO PV-SYSTEM-ORIGIN                   61420000
612100     END-EVALUATE.                                                61430000
612200                                                                  61440000
612300     EVALUATE TRUE                                                61450000
612400         WHEN PV-HOLD-PRIC-CHG-MKDN                               61460000
612500             MOVE PC-MKDN   TO PV-MKDN-MKUP-TYP-CDE               61470000
612600         WHEN PV-HOLD-PRIC-CHG-MKDN-CAN                           61480000
612700             MOVE PC-MKDN-CAN                                     61490000
612800                            TO PV-MKDN-MKUP-TYP-CDE               61500000
612900         WHEN PV-HOLD-PRIC-CHG-MKUP                               61510000
613000             MOVE PC-MKUP   TO PV-MKDN-MKUP-TYP-CDE               61520000
613100         WHEN PV-HOLD-PRIC-CHG-MKUP-CAN                           61530000
613200             MOVE PC-MKUP-CAN                                     61540000
613300                            TO PV-MKDN-MKUP-TYP-CDE               61550000
613400     END-EVALUATE.                                                61560000
613500                                                                  61570000
613600     STRING PV-SYSTEM-ORIGIN                                      61580000
613700         DELIMITED BY SPACE                                       61590000
613800         ' '                                                      61600000
613900         PV-MKDN-MKUP-TYP-CDE                                     61610000
614000         DELIMITED BY SIZE                                        61620000
614100         INTO RPT-HOTL-SYSTEM-ORIGIN.                             61630000
614200                                                                  61640000
614300     WRITE REPORT-RECORD                                          61650000
614400         FROM REPORT-HEADING-ORGN-TYP-LINE                        61660000
614500         AFTER ADVANCING 2 LINES.                                 61670000
614600                                                                  61680000
614700******************************************************************61690000
614800*     E100-GET-DMM-ORGN-TYP-WKLY-SUM                             *61700000
614900* ==> PROCESSES:                                                 *61710000
615000*     - SELECT THE SUM FOR THE FISCAL WEEK BY SYSTEM ORIGIN AND  *61720000
615100*       TYPE OF MARKDOWN AT THE DMM LEVEL                        *61730000
615200* ==> PERFORMED FROM:  B100-INITIALIZE                           *61740000
615300******************************************************************61750000
615400 E100-GET-DMM-ORGN-TYP-WKLY-SUM.                                  61760000
615500                                                                  61770000
615600     MOVE PV-SUB               TO PV-FSCL-WK-NUMERIC.             61780000
615700     MOVE PV-FSCL-WK-NUMERIC   TO PV-FSCL-WK-ALPHA.               61790000
615800                                                                  61800000
615900     EXEC SQL                                                     61810000
616000         SELECT SUM(TOT_MU_MD_AMT)                                61820000
616100           INTO :PV-TOT-MU-MD-AMT                                 61830000
616200           FROM                                                   61840000
616300                TMDSEAR A                                         61850000
616400              , TWKMUMD M                                         61860000
616500          WHERE                                                   61870000
616600                A.OPERCO_NBR       = '03'                         61880000
616700            AND A.GMA_NBR          = :MDSEAR-GMA-NBR              61890000
616800            AND A.DMA_NBR          = :MDSEAR-DMA-NBR              61900000
616900            AND A.MDSELV_CDE       = 'DPT'                        61910000
617000            AND A.DEPT_NBR         = M.DEPT_NBR                   61920000
617100            AND (CURRENT DATE                                     61930000
617200                                 BETWEEN A.STRT_DTE AND A.END_DTE)61940000
617300            AND M.FSCL_MN          = :WKMUMD-FSCL-MN              61950000
617400            AND M.FSCL_YR          = :WKMUMD-FSCL-YR              61960000
617500            AND M.FSCL_WK          = :PV-FSCL-WK-ALPHA            61970000
617600            AND M.ORGN_CDE         = :WKMUMD-ORGN-CDE             61980000
617700            AND M.PRIC_CHG_TYP_CDE = :WKMUMD-PRIC-CHG-TYP-CDE     61990000
617800     END-EXEC.                                                    62000000
617900                                                                  62010000
618000     EVALUATE TRUE                                                62020000
618100         WHEN SQLCODE = +0                                        62030000
618200             MOVE PV-TOT-MU-MD-AMT                                62040000
618300                               TO PV-SUM-BY-ORGN-TYP (PV-SUB)     62050000
618400             ADD PV-SUM-BY-ORGN-TYP (PV-SUB)                      62060000
618500                               TO PV-SUM-BY-ORGN-TYP-TOTAL        62070000
618600                                                                  62080000
618700         WHEN SQLCODE = -305                                      62090000
618800             MOVE ZERO         TO PV-SUM-BY-ORGN-TYP (PV-SUB)     62100000
618900                                                                  62110000
619000         WHEN OTHER                                               62120000
619100             MOVE 'E100-GET-DMM-ORGN-TYP-WKLY-SUM'                62130000
619200                               TO PV-PARAGRAPH-NAME               62140000
619300             MOVE 'SELECT SUM BY ORIGIN/MKDNUP TYP'               62150000
619400                               TO PV-DB2-OPERATION-ATTEMPTED      62160000
619500             PERFORM Z900-SQL-ABEND                               62170000
619600     END-EVALUATE.                                                62180000
619700                                                                  62190000
619800******************************************************************62200000
619900*     E200-GET-GMM-ORGN-TYP-WKLY-SUM                             *62210000
620000* ==> PROCESSES:                                                 *62220000
620100*     - SELECT THE SUM FOR THE FISCAL WEEK BY SYSTEM ORIGIN AND  *62230000
620200*       TYPE OF MARKDOWN AT THE GMM LEVEL                        *62240000
620300* ==> PERFORMED FROM:  B100-INITIALIZE                           *62250000
620400******************************************************************62260000
620500 E200-GET-GMM-ORGN-TYP-WKLY-SUM.                                  62270000
620600                                                                  62280000
620700     MOVE PV-SUB               TO PV-FSCL-WK-NUMERIC.             62290000
620800     MOVE PV-FSCL-WK-NUMERIC   TO PV-FSCL-WK-ALPHA.               62300000
620900                                                                  62310000
621000     EXEC SQL                                                     62320000
621100         SELECT SUM(TOT_MU_MD_AMT)                                62330000
621200           INTO :PV-TOT-MU-MD-AMT                                 62340000
621300           FROM                                                   62350000
621400                TMDSEAR A                                         62360000
621500              , TWKMUMD M                                         62370000
621600          WHERE                                                   62380000
621700                A.OPERCO_NBR       = '03'                         62390000
621800            AND A.GMA_NBR          = :MDSEAR-GMA-NBR              62400000
621900            AND A.MDSELV_CDE       = 'DPT'                        62410000
622000            AND A.DEPT_NBR         = M.DEPT_NBR                   62420000
622100            AND (CURRENT DATE                                     62430000
622200                                 BETWEEN A.STRT_DTE AND A.END_DTE)62440000
622300            AND M.FSCL_MN          = :WKMUMD-FSCL-MN              62450000
622400            AND M.FSCL_YR          = :WKMUMD-FSCL-YR              62460000
622500            AND M.FSCL_WK          = :PV-FSCL-WK-ALPHA            62470000
622600            AND M.ORGN_CDE         = :WKMUMD-ORGN-CDE             62480000
622700            AND M.PRIC_CHG_TYP_CDE = :WKMUMD-PRIC-CHG-TYP-CDE     62490000
622800     END-EXEC.                                                    62500000
622900                                                                  62510000
623000     EVALUATE TRUE                                                62520000
623100         WHEN SQLCODE = +0                                        62530000
623200             MOVE PV-TOT-MU-MD-AMT                                62540000
623300                               TO PV-SUM-BY-ORGN-TYP (PV-SUB)     62550000
623400             ADD PV-SUM-BY-ORGN-TYP (PV-SUB)                      62560000
623500                               TO PV-SUM-BY-ORGN-TYP-TOTAL        62570000
623600                                                                  62580000
623700         WHEN SQLCODE = -305                                      62590000
623800             MOVE ZERO         TO PV-SUM-BY-ORGN-TYP (PV-SUB)     62600000
623900                                                                  62610000
624000         WHEN OTHER                                               62620000
624100             MOVE 'E200-GET-GMM-ORGN-TYP-WKLY-SUM'                62630000
624200                               TO PV-PARAGRAPH-NAME               62640000
624300             MOVE 'SELECT SUM BY ORIGIN/MKDNUP TYP'               62650000
624400                               TO PV-DB2-OPERATION-ATTEMPTED      62660000
624500             PERFORM Z900-SQL-ABEND                               62670000
624600     END-EVALUATE.                                                62680000
624700                                                                  62690000
624800******************************************************************62700000
624900*     E300-GET-CRP-ORGN-TYP-WKLY-SUM                             *62710000
625000* ==> PROCESSES:                                                 *62720000
625100*     - SELECT THE SUM FOR THE FISCAL WEEK BY SYSTEM ORIGIN AND  *62730000
625200*       TYPE OF MARKDOWN AT THE CORPORATE LEVEL                  *62740000
625300* ==> PERFORMED FROM:  B100-INITIALIZE                           *62750000
625400******************************************************************62760000
625500 E300-GET-CRP-ORGN-TYP-WKLY-SUM.                                  62770000
625600                                                                  62780000
625700     MOVE PV-SUB               TO PV-FSCL-WK-NUMERIC.             62790000
625800     MOVE PV-FSCL-WK-NUMERIC   TO PV-FSCL-WK-ALPHA.               62800000
625900                                                                  62810000
626000     EXEC SQL                                                     62820000
626100         SELECT SUM(TOT_MU_MD_AMT)                                62830000
626200           INTO :PV-TOT-MU-MD-AMT                                 62840000
626300           FROM                                                   62850000
626400                TMDSEAR A                                         62860000
626500              , TWKMUMD M                                         62870000
626600          WHERE                                                   62880000
626700                A.OPERCO_NBR       = '03'                         62890000
626800            AND A.MDSELV_CDE       = 'DPT'                        62900000
626900            AND A.DEPT_NBR         = M.DEPT_NBR                   62910000
627000            AND (CURRENT DATE                                     62920000
627100                                 BETWEEN A.STRT_DTE AND A.END_DTE)62930000
627200            AND M.FSCL_MN          = :WKMUMD-FSCL-MN              62940000
627300            AND M.FSCL_YR          = :WKMUMD-FSCL-YR              62950000
627400            AND M.FSCL_WK          = :PV-FSCL-WK-ALPHA            62960000
627500            AND M.ORGN_CDE         = :WKMUMD-ORGN-CDE             62970000
627600            AND M.PRIC_CHG_TYP_CDE = :WKMUMD-PRIC-CHG-TYP-CDE     62980000
627700     END-EXEC.                                                    62990000
627800                                                                  63000000
627900     EVALUATE TRUE                                                63010000
628000         WHEN SQLCODE = +0                                        63020000
628100             MOVE PV-TOT-MU-MD-AMT                                63030000
628200                               TO PV-SUM-BY-ORGN-TYP (PV-SUB)     63040000
628300             ADD PV-SUM-BY-ORGN-TYP (PV-SUB)                      63050000
628400                               TO PV-SUM-BY-ORGN-TYP-TOTAL        63060000
628500                                                                  63070000
628600         WHEN SQLCODE = -305                                      63080000
628700             MOVE ZERO         TO PV-SUM-BY-ORGN-TYP (PV-SUB)     63090000
628800                                                                  63100000
628900         WHEN OTHER                                               63110000
629000             MOVE 'E300-GET-CRP-ORGN-TYP-WKLY-SUM'                63120000
629100                               TO PV-PARAGRAPH-NAME               63130000
629200             MOVE 'SELECT SUM BY ORIGIN/MKDNUP TYP'               63140000
629300                               TO PV-DB2-OPERATION-ATTEMPTED      63150000
629400             PERFORM Z900-SQL-ABEND                               63160000
629500     END-EVALUATE.                                                63170000
629600                                                                  63180000
629700******************************************************************63190000
629800*     E400-GET-DMM-ORGN-TYP-MNTH-SUM                             *63200000
629900* ==> PROCESSES:                                                 *63210000
630000*     - SELECT THE SUM FOR THE FISCAL MONTH BY SYSTEM ORIGIN AND *63220000
630100*       TYPE OF MARKDOWN AT THE DMM LEVEL                        *63230000
630200* ==> PERFORMED FROM:  B100-INITIALIZE                           *63240000
630300******************************************************************63250000
630400 E400-GET-DMM-ORGN-TYP-MNTH-SUM.                                  63260000
630500                                                                  63270000
630600     MOVE PV-SUB               TO PV-FSCL-MN-NUMERIC.             63280000
630700                                                                  63290000
630800     IF CR-FALL                                                   63300000
630900         ADD 6                 TO PV-FSCL-MN-NUMERIC              63310000
631000     END-IF.                                                      63320000
631100                                                                  63330000
631200     MOVE PV-FSCL-MN-NUMERIC   TO PV-FSCL-MN-ALPHA.               63340000
631300                                                                  63350000
631400     EXEC SQL                                                     63360000
631500         SELECT SUM(TOT_MU_MD_AMT)                                63370000
631600           INTO :PV-TOT-MU-MD-AMT                                 63380000
631700           FROM                                                   63390000
631800                TMDSEAR A                                         63400000
631900              , TWKMUMD M                                         63410000
632000          WHERE                                                   63420000
632100                A.OPERCO_NBR       = '03'                         63430000
632200            AND A.GMA_NBR          = :MDSEAR-GMA-NBR              63440000
632300            AND A.DMA_NBR          = :MDSEAR-DMA-NBR              63450000
632400            AND A.MDSELV_CDE       = 'DPT'                        63460000
632500            AND A.DEPT_NBR         = M.DEPT_NBR                   63470000
632600            AND (CURRENT DATE                                     63480000
632700                                 BETWEEN A.STRT_DTE AND A.END_DTE)63490000
632800            AND M.FSCL_MN          = :PV-FSCL-MN-ALPHA            63500000
632900            AND M.FSCL_YR          = :WKMUMD-FSCL-YR              63510000
633000            AND M.ORGN_CDE         = :WKMUMD-ORGN-CDE             63520000
633100            AND M.PRIC_CHG_TYP_CDE = :WKMUMD-PRIC-CHG-TYP-CDE     63530000
633200     END-EXEC.                                                    63540000
633300                                                                  63550000
633400     EVALUATE TRUE                                                63560000
633500         WHEN SQLCODE = +0                                        63570000
633600             MOVE PV-TOT-MU-MD-AMT                                63580000
633700                               TO PV-SUM-BY-ORGN-TYP (PV-SUB)     63590000
633800             ADD PV-SUM-BY-ORGN-TYP (PV-SUB)                      63600000
633900                               TO PV-SUM-BY-ORGN-TYP-TOTAL        63610000
634000                                                                  63620000
634100         WHEN SQLCODE = -305                                      63630000
634200             MOVE ZERO         TO PV-SUM-BY-ORGN-TYP (PV-SUB)     63640000
634300                                                                  63650000
634400         WHEN OTHER                                               63660000
634500             MOVE 'E400-GET-DMM-ORGN-TYP-MNTH-SUM'                63670000
634600                               TO PV-PARAGRAPH-NAME               63680000
634700             MOVE 'SELECT SUM BY ORIGIN/MKDNUP TYP'               63690000
634800                               TO PV-DB2-OPERATION-ATTEMPTED      63700000
634900             PERFORM Z900-SQL-ABEND                               63710000
635000     END-EVALUATE.                                                63720000
635100                                                                  63730000
635200******************************************************************63740000
635300*     E500-GET-GMM-ORGN-TYP-MNTH-SUM                             *63750000
635400* ==> PROCESSES:                                                 *63760000
635500*     - SELECT THE SUM FOR THE FISCAL MONTH BY SYSTEMM ORIGIN AND*63770000
635600*       TYPE OF MARKDOWN AT THE GMM LEVEL                        *63780000
635700* ==> PERFORMED FROM:  B100-INITIALIZE                           *63790000
635800******************************************************************63800000
635900 E500-GET-GMM-ORGN-TYP-MNTH-SUM.                                  63810000
636000                                                                  63820000
636100     MOVE PV-SUB               TO PV-FSCL-MN-NUMERIC.             63830000
636200                                                                  63840000
636300     IF CR-FALL                                                   63850000
636400         ADD 6                 TO PV-FSCL-MN-NUMERIC              63860000
636500     END-IF.                                                      63870000
636600                                                                  63880000
636700     MOVE PV-FSCL-MN-NUMERIC   TO PV-FSCL-MN-ALPHA.               63890000
636800                                                                  63900000
636900     EXEC SQL                                                     63910000
637000         SELECT SUM(TOT_MU_MD_AMT)                                63920000
637100           INTO :PV-TOT-MU-MD-AMT                                 63930000
637200           FROM                                                   63940000
637300                TMDSEAR A                                         63950000
637400              , TWKMUMD M                                         63960000
637500          WHERE                                                   63970000
637600                A.OPERCO_NBR       = '03'                         63980000
637700            AND A.GMA_NBR          = :MDSEAR-GMA-NBR              63990000
637800            AND A.MDSELV_CDE       = 'DPT'                        64000000
637900            AND A.DEPT_NBR         = M.DEPT_NBR                   64010000
638000            AND (CURRENT DATE                                     64020000
638100                                 BETWEEN A.STRT_DTE AND A.END_DTE)64030000
638200            AND M.FSCL_MN          = :PV-FSCL-MN-ALPHA            64040000
638300            AND M.FSCL_YR          = :WKMUMD-FSCL-YR              64050000
638400            AND M.ORGN_CDE         = :WKMUMD-ORGN-CDE             64060000
638500            AND M.PRIC_CHG_TYP_CDE = :WKMUMD-PRIC-CHG-TYP-CDE     64070000
638600     END-EXEC.                                                    64080000
638700                                                                  64090000
638800     EVALUATE TRUE                                                64100000
638900         WHEN SQLCODE = +0                                        64110000
639000             MOVE PV-TOT-MU-MD-AMT                                64120000
639100                               TO PV-SUM-BY-ORGN-TYP (PV-SUB)     64130000
639200             ADD PV-SUM-BY-ORGN-TYP (PV-SUB)                      64140000
639300                               TO PV-SUM-BY-ORGN-TYP-TOTAL        64150000
639400                                                                  64160000
639500         WHEN SQLCODE = -305                                      64170000
639600             MOVE ZERO         TO PV-SUM-BY-ORGN-TYP (PV-SUB)     64180000
639700                                                                  64190000
639800         WHEN OTHER                                               64200000
639900             MOVE 'E500-GET-GMM-ORGN-TYP-MNTH-SUM'                64210000
640000                               TO PV-PARAGRAPH-NAME               64220000
640100             MOVE 'SELECT SUM BY ORIGIN/MKDNUP TYP'               64230000
640200                               TO PV-DB2-OPERATION-ATTEMPTED      64240000
640300             PERFORM Z900-SQL-ABEND                               64250000
640400     END-EVALUATE.                                                64260000
640500                                                                  64270000
640600******************************************************************64280000
640700*     E600-GET-CRP-ORGN-TYP-MNTH-SUM                             *64290000
640800* ==> PROCESSES:                                                 *64300000
640900*     - SELECT THE SUM FOR THE FISCAL MONTH BY SYSTEM ORIGIN AND *64310000
641000*       TYPE OF MARKDOWN AT THE CORPORATE LEVEL                  *64320000
641100* ==> PERFORMED FROM:  B100-INITIALIZE                           *64330000
641200******************************************************************64340000
641300 E600-GET-CRP-ORGN-TYP-MNTH-SUM.                                  64350000
641400                                                                  64360000
641500     MOVE PV-SUB               TO PV-FSCL-MN-NUMERIC.             64370000
641600                                                                  64380000
641700     IF CR-FALL                                                   64390000
641800         ADD 6                 TO PV-FSCL-MN-NUMERIC              64400000
641900     END-IF.                                                      64410000
642000                                                                  64420000
642100     MOVE PV-FSCL-MN-NUMERIC   TO PV-FSCL-MN-ALPHA.               64430000
642200                                                                  64440000
642300     EXEC SQL                                                     64450000
642400         SELECT SUM(TOT_MU_MD_AMT)                                64460000
642500           INTO :PV-TOT-MU-MD-AMT                                 64470000
642600           FROM                                                   64480000
642700                TMDSEAR A                                         64490000
642800              , TWKMUMD M                                         64500000
642900          WHERE                                                   64510000
643000                A.OPERCO_NBR       = '03'                         64520000
643100            AND A.MDSELV_CDE       = 'DPT'                        64530000
643200            AND A.DEPT_NBR         = M.DEPT_NBR                   64540000
643300            AND (CURRENT DATE                                     64550000
643400                                 BETWEEN A.STRT_DTE AND A.END_DTE)64560000
643500            AND M.FSCL_MN          = :PV-FSCL-MN-ALPHA            64570000
643600            AND M.FSCL_YR          = :WKMUMD-FSCL-YR              64580000
643700            AND M.ORGN_CDE         = :WKMUMD-ORGN-CDE             64590000
643800            AND M.PRIC_CHG_TYP_CDE = :WKMUMD-PRIC-CHG-TYP-CDE     64600000
643900     END-EXEC.                                                    64610000
644000                                                                  64620000
644100     EVALUATE TRUE                                                64630000
644200         WHEN SQLCODE = +0                                        64640000
644300             MOVE PV-TOT-MU-MD-AMT                                64650000
644400                               TO PV-SUM-BY-ORGN-TYP (PV-SUB)     64660000
644500             ADD PV-SUM-BY-ORGN-TYP (PV-SUB)                      64670000
644600                               TO PV-SUM-BY-ORGN-TYP-TOTAL        64680000
644700                                                                  64690000
644800         WHEN SQLCODE = -305                                      64700000
644900             MOVE ZERO         TO PV-SUM-BY-ORGN-TYP (PV-SUB)     64710000
645000                                                                  64720000
645100         WHEN OTHER                                               64730000
645200             MOVE 'E600-GET-CRP-ORGN-TYP-MNTH-SUM'                64740000
645300                               TO PV-PARAGRAPH-NAME               64750000
645400             MOVE 'SELECT SUM BY ORIGIN/MKDNUP TYP'               64760000
645500                               TO PV-DB2-OPERATION-ATTEMPTED      64770000
645600             PERFORM Z900-SQL-ABEND                               64780000
645700     END-EVALUATE.                                                64790000
645800                                                                  64800000
645900******************************************************************64810000
646000*     Z800-GET-MONTH                                             *64820000
646100* ==> PROCESSES:                                                 *64830000
646200*     -CALLS THE CALENDAR ROUTINE TO RETRIEVE THE FISCAL MONTH   *64840000
646300*     -POPULATES REPORT-HEADING-LINE3                            *64850000
646400* ==> PERFORMED FROM:                                            *64860000
646500******************************************************************64870000
646600 Z800-GET-MONTH.                                                  64880000
646700                                                                  64890000
646800**** USE THE CALENDAR ROUTINE TO GET THE FISCAL YEAR, MONTH, AND  64900000
646900**** WEEK OF THE PERIOD ENDING DATE.                              64910000
647000                                                                  64920000
647100     INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              64930000
647200     MOVE CR-CALENDAR-TYPE          TO DPG51-CALENDAR-TYPE.       64940000
647300     SET DPG51-DO-NOT-INCR-DECR-DATE TO TRUE.                     64950000
647400                                                                  64960000
647500     MOVE PV-PERIOD-END-DATE        TO DPG52-LK-DATE-INPUT.       64970000
647600     SET DPG52-LK-DTE-ISO-FMT       TO TRUE.                      64980000
647700                                                                  64990000
647800     MOVE 'Z800-GET-MONTH (B100-INIT) (C)' TO  PV-PARAGRAPH-NAME. 65000000
647900     PERFORM  Z810-DATE-ROUTINE-CALL.                             65010000
648000                                                                  65020000
648100                                                                  65030000
648200     MOVE DPG56-FISCAL-PERIOD-NBR                                 65040000
648300                                TO PV-DPG56-FISCAL-PERIOD-NBR.    65050000
648400     MOVE DPG56-FISCAL-PERIOD-WEEK                                65060000
648500                                TO PV-DPG56-FISCAL-PERIOD-WEEK.   65070000
648600     MOVE DPG56-FISCAL-YEAR-CCYY                                  65080000
648700                                TO PV-FSCL-YEAR.                  65090000
648800     MOVE DPG56-FISCAL-PERIOD-WEEK  TO PV-FISCAL-PERIOD-WEEK.     65100000
648900                                                                  65110000
649000     IF CR-CUMULATIVE-SEASON                                      65120000
649100         IF DPG56-SPRING-SEASON                                   65130000
649200             SET CR-SPRING TO TRUE                                65140000
649300         ELSE                                                     65150000
649400             SET CR-FALL   TO TRUE                                65160000
649500         END-IF                                                   65170000
649600         IF PV-DPG56-FISCAL-PERIOD-NBR > 6                        65180000
649700             COMPUTE PV-CALC-SEASON-MONTH =                       65190000
649800                 PV-DPG56-FISCAL-PERIOD-NBR - 6                   65200000
649900         ELSE                                                     65210000
650000             MOVE PV-DPG56-FISCAL-PERIOD-NBR                      65220000
650100                               TO PV-CALC-SEASON-MONTH            65230000
650200         END-IF                                                   65240000
650300         DISPLAY 'SEASON SET BY PROGRAM:  ' CR-SEASON             65250000
650400     END-IF.                                                      65260000
650500                                                                  65270000
650600     DISPLAY ' '.                                                 65280000
650700     DISPLAY ' '.                                                 65290000
650800     DISPLAY  PV-PARAGRAPH-NAME.                                  65300000
650900     DISPLAY '* DATE CALL PARMLISTS DISPLAYED ON NEXT 2 LINES. *'.65310000
651000     DISPLAY '* DPG51: ' DPG51.                                   65320000
651100     DISPLAY '* DPG52: ' DPG52.                                   65330000
651200     DISPLAY  ' ================================================'.65340000
651300     DISPLAY  '    DPG56-CURR-FISCAL-SEASON:  '                   65350000
651400                                      DPG56-CURR-FISCAL-SEASON.   65360000
651500     DISPLAY  '        PV-CALC-SEASON-MONTH:  '                   65370000
651600                                      PV-CALC-SEASON-MONTH.       65380000
651700     DISPLAY  '  PV-DPG56-FISCAL-PERIOD-NBR:    '                 65390000
651800                                      PV-DPG56-FISCAL-PERIOD-NBR. 65400000
651900     DISPLAY  ' PV-DPG56-FISCAL-PERIOD-WEEK:    '                 65410000
652000                                      PV-DPG56-FISCAL-PERIOD-WEEK.65420000
652100     DISPLAY  '       PV-FISCAL-PERIOD-WEEK:    '                 65430000
652200                                      PV-FISCAL-PERIOD-WEEK.      65440000
652300     DISPLAY  '                PV-FSCL-YEAR:  '    PV-FSCL-YEAR.  65450000
652400     DISPLAY  '  DPG54-RETURN-FLAGS . . . '.                      65460000
652500     DISPLAY  '      DPG54-CALENDAR-TYPE-IND:   '                 65470000
652600                                      DPG54-CALENDAR-TYPE-IND.    65480000
652700     DISPLAY  '      DPG54-DATE-VALID-IND:      '                 65490000
652800                                      DPG54-DATE-VALID-IND.       65500000
652900     DISPLAY  '      DPG54-CMPR-DATE-VALID-IND: '                 65510000
653000                                      DPG54-CMPR-DATE-VALID-IND.  65520000
653100     DISPLAY  '      DPG54-INCR-DECR-IND:       '                 65530000
653200                                      DPG54-INCR-DECR-IND.        65540000
653300     DISPLAY  '      DPG54-ERROR-IND:           '                 65550000
653400                                      DPG54-ERROR-IND.            65560000
653500     DISPLAY  '  DPG54-ERROR-MESSAGE:             '               65570000
653600                                      DPG54-ERROR-MESSAGE.        65580000
653700     DISPLAY  ' ================================================'.65590000
653800     PERFORM  Z815-DISPLAY-CONTROLS.                              65600000
653900     DISPLAY ' '.                                                 65610000
654000                                                                  65620000
654100******************************************************************65630000
654200*     Z810-DATE-ROUTINE-CALL.                                    *65640000
654300******************************************************************65650000
654400 Z810-DATE-ROUTINE-CALL.                                          65660000
654500                                                                  65670000
654600     CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51                65680000
654700                                             DPG52                65690000
654800                                             DPG53                65700000
654900                                             DPG54                65710000
655000                                             DPG55                65720000
655100                                             DPG56.               65730000
655200     EVALUATE TRUE                                                65740000
655300         WHEN DPG54-NO-ERROR                                      65750000
655400             CONTINUE                                             65760000
655500         WHEN DPG54-WARNING-ERROR                                 65770000
655600             SET PV-WARNING TO TRUE                               65780000
655700             PERFORM Z811-DATE-ROUTINE-ERROR                      65790000
655800             DISPLAY                                              65800000
655900              '* PLEASE INVESTIGATE FURTHER.                   *' 65810000
656000                                                                  65820000
656100         WHEN DPG54-SEVERE-ERROR                                  65830000
656200         WHEN DPG54-DATE-INVALID                                  65840000
656300* -------------------------------------------------------------- *65850000
656400* *      EXAMINE THE "SEVERE ERROR" RESPONSE FROM THE DATE RTN.* *65860000
656500* *      THESE CONDITIONS ARE *NOT* MUTUALLY EXCLUSIVE;        * *65870000
656600* *      EACH CONDITION IS DESCRIBED BY A SEPARATE INDICATOR.  * *65880000
656700* ---------------------------------------------------------------*65890000
656800             IF  DPG54-CALENDAR-TYPE-INVALID                      65900000
656900                  DISPLAY '** DPG54-CALENDAR-TYPE-INVALID'        65910000
657000             END-IF                                               65920000
657100                                                                  65930000
657200             IF  DPG54-DATE-INVALID                               65940000
657300                  DISPLAY '** DPG54-DATE-INVALID'                 65950000
657400             END-IF                                               65960000
657500                                                                  65970000
657600             IF  DPG54-INCR-DECR-INVALID                          65980000
657700                  DISPLAY '** DPG54-INCR-DECR-INVALID'            65990000
657800             END-IF                                               66000000
657900                                                                  66010000
658000             DISPLAY ' '                                          66020000
658100             DISPLAY '** ABEND     **'                            66030000
658200             SET PV-SEVERE  TO TRUE                               66040000
658300             PERFORM Z811-DATE-ROUTINE-ERROR                      66050000
658400             MOVE +4019 TO ABEND-CODE                             66060000
658500             CALL 'ILBOABN0' USING ABEND-CODE                     66070000
658600     END-EVALUATE.                                                66080000
658700                                                                  66090000
658800******************************************************************66100000
658900*     Z811-DATE-ROUTINE-CALL.                                    *66110000
659000******************************************************************66120000
659100 Z811-DATE-ROUTINE-ERROR.                                         66130000
659200     DISPLAY '** PROGRAM   **  = ' PC-PROGRAM-NAME.               66140000
659300     DISPLAY '** PARAGRAPH **  = ' PV-PARAGRAPH-NAME.             66150000
659400     DISPLAY '** BAD CALL TO CALENDAR MODULE '                    66160000
659500                 DP500-KOHLS-CALENDAR-ROUTINE.                    66170000
659600     DISPLAY  PV-ERROR-LITERAL.                                   66180000
659700     DISPLAY '* ERROR MESSAGE FROM CALLED MODULE ON NEXT LINE.*'. 66190000
659800     DISPLAY DPG54-ERROR-MESSAGE.                                 66200000
659900     DISPLAY '* CALLING PARMLISTS DISPLAYED ON NEXT 2 LINES.  *'. 66210000
660000     DISPLAY '* DPG51 : ' DPG51.                                  66220000
660100     DISPLAY '* DPG52 : ' DPG52.                                  66230000
660200                                                                  66240000
660300                                                                  66250000
660400******************************************************************66260000
660500*     Z815-DISPLAY-CONTROLS.                                      66270000
660600******************************************************************66280000
660700 Z815-DISPLAY-CONTROLS.                                           66290000
660800     DISPLAY ' '.                                                 66300000
660900     DISPLAY 'CONTROLS FOR PROGRAM ' PC-PROGRAM-NAME ': '.        66310000
661000     DISPLAY ' '.                                                 66320000
661100     DISPLAY ' CALENDAR TYPE:  ' CR-CALENDAR-TYPE.                66330000
661200     DISPLAY 'PERIOD END DTE:  ' CR-PERIOD-END-DATE.              66340000
661300     DISPLAY '   TYPE OF RUN:  ' CR-TYPE-OF-BATCH-RUN.            66350000
661400     DISPLAY '          YEAR:  ' CR-YEAR.                         66360000
661500     DISPLAY '          DEPT:  ' CR-DEPT.                         66370000
661600     DISPLAY '        SEASON:  ' CR-SEASON.                       66380000
661700     DISPLAY '  FISCAL MONTH:  ' CR-FISCAL-MONTH.                 66390000
661800     DISPLAY ' '.                                                 66400000
661900                                                                  66410000
662000                                                                  66420000
662100******************************************************************66430000
662200*     Z900-SQL-ABEND                                             *66440000
662300* ==> PROCESSES:                                                 *66450000
662400*     -PERFORMS ABEND PROCESSING FOR SQL ERRORS.                 *66460000
662500* ==> PERFORMED FROM:                                            *66470000
662600******************************************************************66480000
662700 Z900-SQL-ABEND.                                                  66490000
662800                                                                  66500000
662900     DISPLAY 'Z900-SQL-ABEND'.                                    66510000
663000     DISPLAY '**  ABEND     **'.                                  66520000
663100     DISPLAY '**  PROGRAM   ** = ' PC-PROGRAM-NAME.               66530000
663200     DISPLAY '**  PARAGRAPH ** = ' PV-PARAGRAPH-NAME.             66540000
663300     DISPLAY '**  OPERATION ** = ' PV-DB2-OPERATION-ATTEMPTED.    66550000
663400                                                                  66560000
663500******************************************************************66570000
663600* THIS COPY BOOK MEMBER CONTAINS THE PROCEDURE DIVISION STATE-   *66580000
663700* MENTS THAT ARE REQUIRED TO UTILIZE THE DB2 ABEND MODULE        *66590000
663800* 'DSNTIAR' AND CONVERT THE SQLCA INFORMATION INTO A READABLE    *66600000
663900* FORMAT.                                                        *66610000
664000******************************************************************66620000
664100     COPY DPPD004.                                                66630000
664200                                                                  66640000
664300     MOVE +4013 TO ABEND-CODE.                                    66650000
664400     CALL 'ILBOABN0' USING ABEND-CODE.                            66660000
