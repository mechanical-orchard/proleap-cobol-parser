000100******************************************************************00010099
000200 IDENTIFICATION DIVISION.                                         00020099
000300******************************************************************00030099
000400                                                                  00040099
000500 PROGRAM-ID.             VLKUT051.                                00050099
000600 AUTHOR.                 PAUL JORGENSEN                           00060099
000700 INSTALLATION.           KOHLS.                                   00070099
000800 DATE-WRITTEN            MARCH 2009                               00080099
000900 DATE-COMPILED.                                                   00090099
001000                                                                  00100099
001100******************************************************************00110099
001200*  THIS PROGRAM WILL GIVE A QUERY ON HOW MANY PO'S THAT HAVE A    00120099
001300*  SEASONAL SET CODE IN TSEASET WITH PO_RCPT_RPTG_IND SET TO 'Y'. 00130099
001310*  IT STARTED OUT AS A REPORT WHICH IS WHY THERE ARE REPORT       00140099
001320*  STYLE DATA NAMES. THEN IT WAS CONVERTED TO DATA FILE OUTPUT.   00150099
001330*                                                                 00160099
001340***************************************************************** 00170099
001350*                                                               * 00180099
AV0524*  CHANGED 06/03/21 BY ANIL VEDURUPARTHI                        * 00190099
AV0524*   WR# CHG0257543 : MODIFIED PROGRAM MAIN CURSOR FOR BETTER    * 00200099
AV0524*                    PERFORMANCE                                * 00210099
AV0524*                                                               * 00220099
001400******************************************************************00230099
001500 ENVIRONMENT DIVISION.                                            00240099
001600******************************************************************00250099
001700                                                                  00260099
001800 CONFIGURATION SECTION.                                           00270099
001900                                                                  00280099
002000 SOURCE-COMPUTER.        IBM-3090.                                00290099
002100 OBJECT-COMPUTER.        IBM-3090.                                00300099
002200                                                                  00310099
002300 INPUT-OUTPUT SECTION.                                            00320099
002400                                                                  00330099
002500 FILE-CONTROL.                                                    00340099
002600                                                                  00350099
002700     SELECT DI-OUTPUT-FILE                                        00360099
002800         ASSIGN TO OUT01.                                         00370099
002900                                                                  00380099
003000******************************************************************00390099
003100 DATA DIVISION.                                                   00400099
003200******************************************************************00410099
003300                                                                  00420099
003400 FILE SECTION.                                                    00430099
003500                                                                  00440099
003600 FD  DI-OUTPUT-FILE                                               00450099
003700     RECORDING MODE IS F                                          00460099
003800     LABEL RECORDS ARE STANDARD                                   00470099
003900     BLOCK CONTAINS 0 RECORDS.                                    00480099
004000                                                                  00490099
004100 01  DI-OUTPUT-RECORD                    PIC  X(300).             00500099
004200                                                                  00510099
004300******************************************************************00520099
004400 WORKING-STORAGE SECTION.                                         00530099
004500******************************************************************00540099
004600                                                                  00550099
004700*                                                                 00560099
004800*  STANDARD REPORT HEADER FOR A 200 COLUMN REPORT.                00570099
004900*                                                                 00580099
005000     COPY DPWS200O.                                               00590099
005100*                                                                 00600099
005200*  WORK AREA FOR FISCAL CALENDAR ROUTINE.                         00610099
005300*                                                                 00620099
005400     COPY DPWS500.                                                00630099
005500                                                                  00640099
005600                                                                  00650099
005700 01  ABEND-CODE                          PIC S9(04) VALUE +0      00660099
005800                                                     COMP SYNC.   00670099
005900                                                                  00680099
006000*                                                                 00690099
006100*  WORK AREA FOR SQL ERROR ROUTINE 'DSNTIAR'                      00700099
006200*                                                                 00710099
006300     COPY DPWS004.                                                00720099
006400                                                                  00730099
006500                                                                  00740099
006600 01  DH2-DETAIL-HEADING.                                          00750099
006700*    05  FILER                           PIC  X(06)  VALUE        00760099
006800*        'SEASET'.                                                00770099
006900*    05  FILLER                          PIC  X(01)  VALUE ' '.   00780099
007000     05  FILLER                          PIC  X(06)  VALUE        00790099
007100         'SEASET'.                                                00800099
007200     05  FILLER                          PIC  X(01)  VALUE ' '.   00810099
007300     05  FILLER                          PIC  X(09)  VALUE SPACES.00820099
007400     05  FILLER                          PIC  X(01)  VALUE ' '.   00830099
007500     05  FILLER                          PIC  X(30)  VALUE SPACES.00840099
007600     05  FILLER                          PIC  X(01)  VALUE ' '.   00850099
007700     05  FILLER                          PIC  X(04)  VALUE SPACES.00860099
007800     05  FILLER                          PIC  X(01)  VALUE ' '.   00870099
007900     05  FILLER                          PIC  X(10)  VALUE SPACES.00880099
007910     05  FILLER                          PIC  X(01)  VALUE ' '.   00890099
007920     05  FILLER                          PIC  X(10)  VALUE SPACES.00900099
007930     05  FILLER                          PIC  X(01)  VALUE ' '.   00910099
007940     05  FILLER                          PIC  X(10)  VALUE SPACES.00920099
007950     05  FILLER                          PIC  X(01)  VALUE ' '.   00930099
007960     05  FILLER                          PIC  X(09)  VALUE        00940099
007970         '    TOTAL'.                                             00950099
007980     05  FILLER                          PIC  X(01)  VALUE ' '.   00960099
007990     05  FILLER                          PIC  X(02)  VALUE SPACES.00970099
008000                                                                  00980099
008100 01  DH2-DETAIL-HEADING-D2.                                       00990099
008200*    05  FILER                           PIC  X(06)  VALUE        01000099
008300*        ' YEAR '.                                                01010099
008400*    05  FILLER                          PIC  X(01)  VALUE ' '.   01020099
008500     05  FILLER                          PIC  X(06)  VALUE        01030099
008600         ' NAME '.                                                01040099
008700     05  FILLER                          PIC  X(01)  VALUE ' '.   01050099
008800     05  FILLER                          PIC  X(09)  VALUE        01060099
008900         '   PO NBR'.                                             01070099
009000     05  FILLER                          PIC  X(01)  VALUE ' '.   01080099
009100     05  FILLER                          PIC  X(30)  VALUE        01090099
009200         'VENDOR                        '.                        01100099
009300     05  FILLER                          PIC  X(01)  VALUE ' '.   01110099
009400     05  FILLER                          PIC  X(04)  VALUE        01120099
009500         'DEPT'.                                                  01130099
009600     05  FILLER                          PIC  X(01)  VALUE ' '.   01140099
009700     05  FILLER                          PIC  X(10)  VALUE        01150099
009800         '   SHIP   '.                                            01160099
009900     05  FILLER                          PIC  X(01)  VALUE ' '.   01170099
010000     05  FILLER                          PIC  X(10)  VALUE        01180099
010100         '  CANCEL  '.                                            01190099
010200     05  FILLER                          PIC  X(01)  VALUE ' '.   01200099
010300     05  FILLER                          PIC  X(10)  VALUE        01210099
010400         'EXT CANCEL'.                                            01220099
010500     05  FILLER                          PIC  X(01)  VALUE ' '.   01230099
010600     05  FILLER                          PIC  X(09)  VALUE        01240099
010700         '    UNITS'.                                             01250099
010800     05  FILLER                          PIC  X(01)  VALUE ' '.   01260099
010900     05  FILLER                          PIC  X(04)  VALUE        01270099
011000         'TYPE'.                                                  01280099
011100                                                                  01290099
011200 01  DL-DETAIL-LINE.                                              01300099
011300*    05  DL-SEASET-YR                    PIC  X(06).              01310099
011400*    05  FILLER                          PIC  X(01)  VALUE ' '.   01320099
011500     05  DL-SEASET                       PIC  X(06).              01330099
011600     05  FILLER                          PIC  X(01)  VALUE ' '.   01340099
011700     05  DL-PO-NUMBER                    PIC  X(09).              01350099
011800     05  FILLER                          PIC  X(01)  VALUE ' '.   01360099
011900     05  DL-VENDOR-NAME                  PIC  X(30).              01370099
012000     05  FILLER                          PIC  X(01)  VALUE ' '.   01380099
012100     05  DL-DEPT-NBR                     PIC  X(04).              01390099
012200     05  FILLER                          PIC  X(01)  VALUE ' '.   01400099
012300     05  DL-SHIP-DATE                    PIC  X(10).              01410099
012400     05  FILLER                          PIC  X(01)  VALUE ' '.   01420099
012500     05  DL-CANCEL-DATE                  PIC  X(10).              01430099
012600     05  FILLER                          PIC  X(01)  VALUE ' '.   01440099
012700     05  DL-EXT-CANCEL-DATE              PIC  X(10).              01450099
012800     05  FILLER                          PIC  X(01)  VALUE ' '.   01460099
012900     05  DL-TOTAL-UNITS                  PIC  X(09).              01470099
013000     05  FILLER                          PIC  X(01)  VALUE ' '.   01480099
013100     05  DL-PO-TYP-CDE                   PIC  X(02).              01490099
013200                                                                  01500099
013300 01  BLANK-LINE.                                                  01510099
013400*    05  FILER                           PIC  X(06)  VALUE SPACES.01520099
013500*    05  FILLER                          PIC  X(01)  VALUE ' '.   01530099
013600     05  FILLER                          PIC  X(06)  VALUE SPACES.01540099
013700     05  FILLER                          PIC  X(01)  VALUE ' '.   01550099
013800     05  FILLER                          PIC  X(09)  VALUE SPACES.01560099
013900     05  FILLER                          PIC  X(01)  VALUE ' '.   01570099
014000     05  FILLER                          PIC  X(30)  VALUE SPACES.01580099
014100     05  FILLER                          PIC  X(01)  VALUE ' '.   01590099
014200     05  FILLER                          PIC  X(04)  VALUE SPACES.01600099
014300     05  FILLER                          PIC  X(01)  VALUE ' '.   01610099
014400     05  FILLER                          PIC  X(10)  VALUE SPACES.01620099
014500     05  FILLER                          PIC  X(01)  VALUE ' '.   01630099
014600     05  FILLER                          PIC  X(10)  VALUE SPACES.01640099
014700     05  FILLER                          PIC  X(01)  VALUE ' '.   01650099
014800     05  FILLER                          PIC  X(10)  VALUE SPACES.01660099
014900     05  FILLER                          PIC  X(01)  VALUE ' '.   01670099
015000     05  FILLER                          PIC  X(09)  VALUE SPACES.01680099
015100     05  FILLER                          PIC  X(01)  VALUE ' '.   01690099
015200     05  FILLER                          PIC  X(02)  VALUE SPACES.01700099
015300                                                                  01710099
015400 01  ER-EMPTY-REPORT-LINE.                                        01720099
015500     05  FILLER                          PIC  X(56)  VALUE SPACE. 01730099
015600     05  FILLER                          PIC  X(25)  VALUE        01740099
015700         '******* NO DATA *********'.                             01750099
015800     05  FILLER                          PIC  X(87)  VALUE SPACE. 01760099
015900                                                                  01770099
016000 01  PC-CONSTANTS.                                                01780099
016100     05  PC-COMMIT-INTEVLAL              PIC  9(02)  VALUE 10.    01790099
016200     05  PC-UNDERSCORE-11                PIC  X(11)  VALUE        01800099
016300                                                     ALL '_'.     01810099
016400     05  PC-MAX-REPORT-LINES             PIC S9(04)  VALUE +65    01820099
016500                                                     COMP SYNC.   01830099
016600     05  PC-ROW-NOT-FOUND                PIC S9(04)  VALUE +100   01840099
016700                                                     COMP SYNC.   01850099
016800     05  PC-KOHLS-OPERATING-COMPANY      PIC  X(02)  VALUE '03'.  01860099
016900     05  PC-CURRENT-PROGRAM-NAME         PIC  X(08)  VALUE        01870099
017000         'VLKUT051'.                                              01880099
017100     05  PC-CURRENT-JOB-NAME             PIC  X(08)  VALUE        01890099
017200         'VLK???  '.                                              01900099
017300     05  PC-DPKUT500                     PIC  X(10)  VALUE        01910099
017400         'DPKUT500  '.                                            01920099
017500     05 PC-PGM-DPKUT039                  PIC  X(08)               01930099
017600                                         VALUE 'DPKUT039'.        01940099
017700     05 PC-MFALLS-DC-NBR                 PIC S9(04)  VALUE +85.   01950099
017800     05 PC-FINDLEY-DC-NBR                PIC S9(04)  VALUE +810.  01960099
017900     05 PC-WIN-DC-NBR                    PIC S9(04)  VALUE +830.  01970099
018000     05 PC-BLSP-DC-NBR                   PIC S9(04)  VALUE +840.  01980099
018010     05 PC-SPACE                         PIC  X(01)  VALUE ' '.   01990099
AV0524     05 WS-DETAIL-CNT                    PIC S9(04)  VALUE +0     01991099
AV0524                                                      COMP SYNC.  01992099
AV0524     05 WS-RPT-FETCH-CNT                 PIC S9(04)  VALUE +0     02000099
AV0524                                                      COMP SYNC.  02001099
AV0524     05 WS-SST-FETCH-CNT                 PIC S9(04)  VALUE +0     02010099
AV0524                                                      COMP SYNC.  02011099
AV0524     05 WS-SEASET-SHRT-NM                PIC  X(05).              02020099
AV0524     05 WS-SEASET-YR                     PIC  X(04).              02030099
018100                                                                  02040099
018200 01  PS-PROGRAM-SWITCHES.                                         02050099
018300     05  PS-COUNT-CURSOR-IND             PIC  X(01)  VALUE 'N'.   02060099
018400         88  PS-COUNT-CURSOR-OPENED                  VALUE 'Y'.   02070099
018500         88  PS-COUNT-CURSOR-CLOSED                  VALUE 'N'.   02080099
AV0524                                                                  02090099
AV0524     05  PS-PRINT-HEADER-IND             PIC  X(01)  VALUE 'N'.   02100099
AV0524         88  PS-PRINT-HEADER-YES                     VALUE 'Y'.   02110099
AV0524         88  PS-PRINT-HEADER-NO                      VALUE 'N'.   02120099
AV0524                                                                  02130099
AV0524     05  PS-PRINT-BLANK-LINE             PIC  X(01)  VALUE 'N'.   02140099
AV0524         88  PS-PRINT-BLANK-LINE-YES                 VALUE 'Y'.   02150099
AV0524         88  PS-PRINT-BLANK-LINE-NO                  VALUE 'N'.   02160099
AV0524                                                                  02170099
AV0524     05  PS-END-OF-SST-CURSOR-IND        PIC  X(01)  VALUE 'N'.   02180099
AV0524         88  PS-END-OF-SST-CURSOR                    VALUE 'Y'.   02190099
AV0524         88  PS-NOT-END-OF-SST-CURSOR                VALUE 'N'.   02200099
018700     05  PS-CHANGE-STATUS-IND            PIC  X(01)  VALUE 'N'.   02210099
018800         88  PS-STATUS-IND-CHANGED                   VALUE 'Y'.   02220099
018900         88  PS-STATUS-IND-NOT-CHANGED               VALUE 'N'.   02230099
019000                                                                  02240099
019100     05  PS-END-OF-COUNT-CURSOR-IND      PIC  X(01)  VALUE 'N'.   02250099
019200         88  PS-END-OF-COUNT-CURSOR                  VALUE 'Y'.   02260099
019300         88  PS-NOT-END-OF-COUNT-CURSOR              VALUE 'N'.   02270099
019400                                                                  02280099
019500     05  PS-VENDOR-BREAK-IND             PIC  X(01)  VALUE 'N'.   02290099
019600         88  PS-VENDOR-BREAK                         VALUE 'Y'.   02300099
019700         88  PS-NO-VENDOR-BREAK                      VALUE 'N'.   02310099
019800                                                                  02320099
019900     05  PS-END-OF-RPT-CURSOR-IND        PIC  X(01)  VALUE 'N'.   02330099
020000         88  PS-END-OF-RPT-CURSOR                    VALUE 'Y'.   02340099
020100         88  PS-NOT-END-OF-RPT-CURSOR                VALUE 'N'.   02350099
020200                                                                  02360099
020300     05  PS-END-OF-TOT-CURSOR-IND        PIC  X(01)  VALUE 'N'.   02370099
020400         88  PS-END-OF-TOT-CURSOR                    VALUE 'Y'.   02380099
020500         88  PS-NOT-END-OF-TOT-CURSOR                VALUE 'N'.   02390099
020600                                                                  02400099
020700     05  PS-NO-DATA-IND                  PIC  X(01)  VALUE 'N'.   02410099
020800         88  PS-NO-DATA                              VALUE 'Y'.   02420099
020900                                                                  02430099
021000     05  PS-SUMMARY-RPT-IND              PIC  X(01)  VALUE 'N'.   02440099
021100         88  PS-SUMMARY-RPT                          VALUE 'Y'.   02450099
021200         88  PS-NOT-A-SUMMARY-RPT                    VALUE 'N'.   02460099
021300                                                                  02470099
021400 01  PV-PROGRAM-VARIABLES.                                        02480099
021500     05  PV-PRINT-QTY                    PIC  ZZZ,ZZZ,ZZ9.        02490099
021600                                                                  02500099
021700     05  PV-CURR-TMST                    PIC  X(26)  VALUE SPACES.02510099
021800     05  PV-COMMIT-TMST                  PIC  X(26)  VALUE SPACES.02520099
021900     05  PV-VND-UPDT-COUNT               PIC S9(04)  VALUE +0     02530099
022000                                                     COMP SYNC.   02540099
022100     05  PV-PAGE-COUNT                   PIC S9(04)  VALUE +0     02550099
022200                                                     COMP SYNC.   02560099
022300     05  PV-LINE-COUNT                   PIC S9(04)  VALUE +0     02570099
022400                                                     COMP SYNC.   02580099
022500     05  PV-LINES-AHEAD                  PIC S9(04)  VALUE +0     02590099
022600                                                     COMP SYNC.   02600099
022700                                                                  02610099
022800     05  PV-HOLD-SEASET-YR              PIC  X(04).               02620099
022900     05  PV-HOLD-SEASET                 PIC  X(05).               02630099
023000     05  PV-HOLD-PO-NBR                 PIC S9(09) COMP.          02640099
023100     05  PV-HOLD-REC-SEQ-NBR            PIC S9(09) COMP.          02650099
023200     05  PV-HOLD-STATUS-CDE             PIC  X(02).               02660099
023300     05  PV-HOLD-ENROUTE                PIC  X(07).               02670099
023400     05  PV-HOLD-ENT-NAME-DESC          PIC X(30).                02680099
023500     05  PV-HOLD-DEPT-NBR               PIC X(04).                02690099
023600     05  PV-HOLD-DONT-SHIP-BEF-DTE      PIC X(10).                02700099
023700     05  PV-HOLD-CAN-IFNOT-SHIP-DTE     PIC X(10).                02710099
023800     05  PV-HOLD-EXT-CAN-DTE            PIC X(10).                02720099
023900     05  PV-HOLD-PO-TYP-CDE             PIC X(02).                02730099
024000     05  PV-HOLD-TOT-UNT-QTY            PIC S9(09) COMP.          02740099
024100                                                                  02750099
024200     05  PV-TEMP-TOT-UNT-QTY            PIC ZZZZZZZZ9.            02760099
024300     05  PV-TEMP-OPER-UNT-ID            PIC S9(04) COMP.          02770099
024400     05  PV-HOLD-ARRIVAL-DTE            PIC X(10)  VALUE SPACES.  02780099
024500     05  PV-HOLD-ARRIVAL-TIM            PIC X(15)  VALUE SPACES.  02790099
024600     05  PV-REC-ARRIVAL-DTE             PIC X(10)  VALUE SPACES.  02800099
024700     05  PV-REC-ARRIVAL-TIM             PIC X(15)  VALUE SPACES.  02810099
024800                                                                  02820099
024900     05  PV-CURR-DATE-CCYYMMDD          PIC  X(10).               02830099
025000     05  PV-CURR-DATE.                                            02840099
025100         10  PV-CURR-CENTURY             PIC  9(02).              02850099
025200         10  PV-CURR-YEAR                PIC  9(02).              02860099
025300         10  FILLER                      PIC  X(01) VALUE '-'.    02870099
025400         10  PV-CURR-MONTH               PIC  9(02).              02880099
025500         10  FILLER                      PIC  X(01) VALUE '-'.    02890099
025600         10  PV-CURR-DAY                 PIC  9(02).              02900099
025700     05  PV-CURRENT-TIME                 PIC  X(10).              02910099
025800     05  PV-CURR-TIME.                                            02920099
025900         10  PV-CURR-HOUR                PIC  9(02).              02930099
026000         10  FILLER                      PIC  X(01) VALUE '-'.    02940099
026100         10  PV-CURR-MIN                 PIC  9(02).              02950099
026200         10  FILLER                      PIC  X(01) VALUE '-'.    02960099
026300         10  PV-CURR-SEC                 PIC  9(02).              02970099
026400                                                                  02980099
026500     05  PV-PARAGRAPH-NAME               PIC  X(30)  VALUE SPACE. 02990099
026600     05  PV-DB2-OPERATION-ATTEMPTED      PIC  X(30)  VALUE SPACE. 03000099
026700     05  PV-DB2-OPER-UNT-ID              PIC  X(03).              03010099
026800     05  PV-BEGIN-DATE.                                           03020099
026900         10  PV-BEGIN-CCYY               PIC  9(04).              03030099
027000         10  FILLER                      PIC  X(01).              03040099
027100         10  PV-BEGIN-MM                 PIC  9(02).              03050099
027200         10  FILLER                      PIC  X(01).              03060099
027300         10  PV-BEGIN-DD                 PIC  9(02).              03070099
027400     05  PV-END-DATE.                                             03080099
027500         10  PV-END-CCYY                 PIC  9(04).              03090099
027600         10  FILLER                      PIC  X(01).              03100099
027700         10  PV-END-MM                   PIC  9(02).              03110099
027800         10  FILLER                      PIC  X(01).              03120099
027900         10  PV-END-DD                   PIC  9(02).              03130099
028000                                                                  03140099
028100     05  PV-CHAR-COUNT                   PIC S9(02)  VALUE +0     03150099
028200                                                     COMP SYNC.   03160099
028100     05  PV-DISP-DET-C                   PIC  ZZ,ZZZ,ZZ9.         03161099
028100     05  PV-DISP-RPT-C                   PIC  ZZ,ZZZ,ZZ9.         05220599
028100     05  PV-DISP-SST-C                   PIC  ZZ,ZZZ,ZZ9.         05220699
028300                                                                  05220799
028400 01  SD-SYSTEM-DATE-YYMMDD.                                       05220899
028500     05  SD-SYSTEM-YEAR                  PIC  9(02)  VALUE ZEROS. 05220999
028600     05  SD-SYSTEM-MONTH                 PIC  9(02)  VALUE ZEROS. 05221099
028700     05  SD-SYSTEM-DAY                   PIC  9(02)  VALUE ZEROS. 05221199
028800                                                                  05221299
028900 01  ST-SYSTEM-TIME.                                              05221399
029000     05  ST-SYSTEM-HOUR                  PIC  9(02)  VALUE ZEROS. 05221499
029100     05  ST-SYSTEM-MINUTE                PIC  9(02)  VALUE ZEROS. 05221599
029200                                                                  05221699
029300 01  CC-CONTROL-CARD.                                             05221799
029400     05  CC-REPORT-TYPE                  PIC  X(03)  VALUE SPACE. 05221899
029500     05  CC-BEGIN-DATE                   PIC  X(10)  VALUE SPACE. 05221999
029600         88 CC-DEFAULT-BEGIN-DATE        VALUE 'YYYY-MM-DD'.      05222099
029700     05  FILLER REDEFINES CC-BEGIN-DATE.                          05222199
029800         10  CC-BEGIN-CENTURY            PIC  9(02).              05222299
029900         10  CC-BEGIN-YEAR               PIC  9(02).              05222399
030000         10  FILLER                      PIC  X(01).              05222499
030100         10  CC-BEGIN-MONTH              PIC  9(02).              05222599
030200         10  FILLER                      PIC  X(01).              05222699
030300         10  CC-BEGIN-DAY                PIC  9(02).              05222799
030400     05  CC-END-DATE                     PIC  X(10)  VALUE SPACE. 05222899
030500         88 CC-DEFAULT-END-DATE          VALUE 'YYYY-MM-DD'.      05222999
030600     05  FILLER REDEFINES CC-END-DATE.                            05223099
030700         10  CC-END-CENTURY              PIC  9(02).              05223199
030800         10  CC-END-YEAR                 PIC  9(02).              05223299
030900         10  FILLER                      PIC  X(01).              05223399
031000         10  CC-END-MONTH                PIC  9(02).              05223499
031100         10  FILLER                      PIC  X(01).              05223599
031200         10  CC-END-DAY                  PIC  9(02).              05223699
031300                                                                  05223799
031400*                                                                 05223899
031500******************************************************************05223999
031600*  WORK FIELDS FOR THE MBS SUBROUTINE                             05224099
031700******************************************************************05224199
031800     COPY DPWS003.                                                05224299
031900*                                                                 05224399
032000******************************************************************05224499
032100*  DB2 COMMUNICATION AREA.                                        05224599
032200******************************************************************05224699
032300     EXEC SQL                                                     05224799
032400          INCLUDE SQLCA                                           05224899
032500     END-EXEC.                                                    05224999
032600*                                                                 05225099
032700*---------------------------------------------------------------* 05225199
032800*    SEASONAL SET TABLE                                         * 05225299
032900*---------------------------------------------------------------* 05225399
033000     EXEC SQL                                                     05225499
033100          INCLUDE TSEASET                                         05225599
033200     END-EXEC.                                                    05225699
033300*                                                                 05225799
033400******************************************************************05225899
033500*  COBOL DELCARATION FOR THE RECEIPTS TABLE                       05225999
033600******************************************************************05226099
033700     EXEC SQL                                                     05226199
033800          INCLUDE TRECEIV                                         05226299
033900     END-EXEC.                                                    05226399
034000*                                                                 05226499
034100******************************************************************05226599
034200*  COBOL DELCARATION FOR THE PURCHASE ORDER TABLE                 05226699
034300******************************************************************05226799
034400     EXEC SQL                                                     05226899
034500          INCLUDE TENTNME                                         05226999
034600     END-EXEC.                                                    05227099
034700*                                                                 05227199
034800******************************************************************05227299
034900*  COBOL DELCARATION FOR THE PURCHASE ORDER TABLE                 05227399
035000******************************************************************05227499
035100     EXEC SQL                                                     05227599
035200          INCLUDE TPLNSHP                                         05227699
035300     END-EXEC.                                                    05227799
035400*                                                                 05227899
035500*                                                                 05227999
035600******************************************************************05228099
035700*  COBOL DELCARATION FOR THE PURCHASE ORDER TABLE                 05228199
035800******************************************************************05228299
035900     EXEC SQL                                                     05228399
036000          INCLUDE TPURCHS                                         05228499
036100     END-EXEC.                                                    05228599
036200*                                                                 05228699
036300*                                                                 05228799
036400******************************************************************05228899
036500*  COBOL DELCARATION FOR THE PURCHASE ORDER ITEM TABLE            05228999
036600******************************************************************05229099
036700     EXEC SQL                                                     05229199
036800          INCLUDE TPURITM                                         05229299
036900     END-EXEC.                                                    05229399
037000*                                                                 05229499
037100*                                                                 05229599
037200*                                                                 05229699
037300******************************************************************05229799
037400*  COBOL DELCARATION FOR THE RECEIVING ITEM                       05229899
037500******************************************************************05229999
037600     EXEC SQL                                                     05230099
037700          INCLUDE TRECITM                                         05230199
037800     END-EXEC.                                                    05230299
037900*                                                                 05230399
038000*   DB2 COMMUNICATIONS AREA2                                      05230499
038100*                                                                 05230599
038200     COPY SQLCA2.                                                 05230699
038300 EJECT                                                            05230799
038400                                                                  05230899
038500*                                                                 05230999
038600*                                                                 05231099
038700******************************************************************05231199
038800*  COBOL CURSOR DELCARATION FOR THE VERIFIED RPT PO''S            05231299
038900******************************************************************05231399
039000     EXEC SQL                                                     05231499
AV0524     DECLARE RPT_CURSOR1 CURSOR FOR                               05231599
AV0524         SELECT A.PO_NBR                                          05231699
039400               ,A.PO_TYP_CDE                                      05231799
039500               ,A.TOT_UNT_QTY                                     05231899
039600               ,A.DEPT_NBR                                        05231999
039700               ,A.VER_NBR                                         05232099
039800               ,A.SEASET_YR                                       05232199
039900               ,A.SEASET_SHRT_NM                                  05232299
040000               ,B.DONT_SHIP_BEF_DTE                               05232399
040100               ,B.CAN_IFNOT_SHIP_DTE                              05232499
040200               ,B.EXT_CAN_DTE                                     05232599
040300               ,C.ENT_NAME_DESC                                   05232699
040400         FROM  TPURCHS A                                          05232799
040500              ,TPLNSHP B                                          05232899
040600              ,TENTNME C                                          05232999
AV0524         WHERE A.SEASET_SHRT_NM         = :WS-SEASET-SHRT-NM      05233099
AV0524               AND A.SEASET_YR          = :WS-SEASET-YR           05233199
041200               AND A.STATUS_CDE        <> 'CA'                    05233299
041300               AND A.VER_STATUS_CDE     = 'A'                     05233399
041400               AND B.PO_NBR             = A.PO_NBR                05233499
041500               AND B.VER_STATUS_CDE     = 'A'                     05233599
041600               AND C.ENT_ID             = A.ENT_ID                05233699
041700               AND C.TYPE_CDE           = '01'                    05233799
041800               AND A.PO_NBR NOT IN                                05233899
041900               (SELECT D.ORD_NBR FROM TRECEIV D                   05233999
042000                WHERE D.ORD_NBR = A.PO_NBR                        05234099
042100                  AND D.VER_STATUS_CDE   = 'A'                    05234199
042200                  AND D.STATUS_CDE       IN ('CM','IP','VE'))     05234299
043500         ORDER BY                                                 05234399
043600                 A.SEASET_YR                                      05234499
043700                ,A.SEASET_SHRT_NM                                 05234599
043800                ,A.PO_NBR                                         05234699
AV0524               WITH UR                                            05234799
043900     END-EXEC.                                                    05234899
044000                                                                  05234999
AV0524     EXEC SQL                                                     05235099
AV0524        DECLARE SST_CSR CURSOR FOR                                05235199
AV0524            SELECT SEASET_YR                                      05235299
AV0524                  ,SEASET_SHRT_NM                                 05235399
AV0524              FROM TSEASET                                        05235499
AV0524             WHERE SEASET_STAT_CDE   = 'A'                        05235599
AV0524              AND  PO_RCPT_RPTG_IND  = 'Y'                        05235699
AV0524          ORDER BY SEASET_YR                                      05235799
AV0524                  ,SEASET_SHRT_NM                                 05235899
AV0524     END-EXEC.                                                    05235999
044100*                                                                 05236099
044200                                                                  05236199
044300* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 05236299
044400 PROCEDURE DIVISION.                                              05236399
044500* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 05236499
044600                                                                  05236599
044700******************************************************************05236699
044800*  0000-MAINLINE - CONTROLS THE MAIN PROCESSING OF THE PROGRAM    05236799
044900******************************************************************05236899
045000 0000-PROGRAM-MAINLINE.                                           05236999
045100                                                                  05237099
045200     PERFORM 1000-INITIALIZE.                                     05237199
045300                                                                  05237299
AV0524     PERFORM 6500-OPEN-SST-CURSOR.                                05237399
AV0524     PERFORM 6700-FETCH-SST-CURSOR.                               05237499
045300                                                                  05237599
AV0524     IF PS-END-OF-SST-CURSOR                                      05237699
075900         PERFORM 6900-CLOSE-SST-CURSOR                            05237799
075900         PERFORM 8900-EMPTY-VENDOR-RPT                            05237899
076000     ELSE                                                         05237999
AV0524         PERFORM 6600-PROCESS-SST-CURSOR                          05238099
AV0524           UNTIL PS-END-OF-SST-CURSOR                             05238199
AV0524                                                                  05238299
AV0524         IF WS-RPT-FETCH-CNT = ZERO                               05238399
AV0524            PERFORM 8900-EMPTY-VENDOR-RPT                         05238499
AV0524         END-IF                                                   05238599
076200     END-IF.                                                      05238699
AV0524     MOVE WS-RPT-FETCH-CNT  TO PV-DISP-RPT-C.                     05238799
AV0524     MOVE WS-SST-FETCH-CNT  TO PV-DISP-SST-C.                     05238899
AV0524     MOVE WS-DETAIL-CNT     TO PV-DISP-DET-C.                     05238999
045900                                                                  05239099
AV0524     DISPLAY '******* VLKUT051 COUNTS *******'.                   05239199
AV0524     DISPLAY ' REPORT CURSOR TPURCHS COUNT: ' PV-DISP-RPT-C.      05239299
AV0524     DISPLAY ' DRIVER CURSOR SEASET  COUNT: ' PV-DISP-SST-C.      05239399
AV0524     DISPLAY ' DETAIL RECORDS WRITE  COUNT: ' PV-DISP-DET-C.      05239499
AV0524     DISPLAY '******* END OF VLKUT051 *******'.                   05239599
046000     CLOSE DI-OUTPUT-FILE.                                        05239699
046100     STOP RUN.                                                    05239799
046200                                                                  05239899
046300 1000-INITIALIZE.                                                 05239999
046400                                                                  05240099
046500*    ACCEPT CC-CONTROL-CARD FROM SYSIN.                           05240199
046600                                                                  05240299
046700*    DISPLAY 'CONTROL CARD = ' CC-CONTROL-CARD.                   05240399
046800                                                                  05240499
046900     PERFORM 1050-GET-DATES.                                      05240599
047000                                                                  05240699
047100     PERFORM 1060-PREPARE-FOR-REPORT.                             05240799
047200                                                                  05240899
047300     MOVE SD-SYSTEM-YEAR         TO DP200O-RUN-YEAR.              05240999
047400     MOVE SD-SYSTEM-MONTH        TO DP200O-RUN-MONTH.             05241099
047500     MOVE SD-SYSTEM-DAY          TO DP200O-RUN-DAY.               05241199
047600                                                                  05241299
047700     MOVE ST-SYSTEM-HOUR         TO DP200O-RUN-HOUR.              05241399
047800     MOVE ST-SYSTEM-MINUTE       TO DP200O-RUN-MINUTE.            05241499
047900                                                                  05241599
048000     MOVE PC-MAX-REPORT-LINES    TO PV-LINE-COUNT.                05241699
048100     MOVE +0                     TO PV-PAGE-COUNT.                05241799
048200                                                                  05241899
048300     INITIALIZE DL-DETAIL-LINE.                                   05241999
048400                                                                  05242099
048500     OPEN OUTPUT DI-OUTPUT-FILE.                                  05242199
048600                                                                  05243099
AV0524*    PERFORM 7000-OPEN-MAIN-RPT-CURSOR.                           05250099
AV0524*    PERFORM 7200-FETCH-MAIN-RPT-CURSOR.                          05260099
048900                                                                  05270099
049000******************************************************************05280099
049100*  1050-GET-DATES - GETS CURRENT-DATE AND CURRENT DATE +1 YEAR    05290099
049200*  FROM DB2.                                                      05300099
049300******************************************************************05310099
049400 1050-GET-DATES.                                                  05320099
049500                                                                  05330099
049600     EXEC SQL                                                     05340099
049700         SET :PV-CURR-DATE-CCYYMMDD = CURRENT DATE                05350099
049800     END-EXEC.                                                    05360099
049900                                                                  05370099
050000     EXEC SQL                                                     05380099
050100         SET :PV-CURRENT-TIME = CURRENT TIME                      05390099
050200     END-EXEC.                                                    05400099
050300                                                                  05410099
050400     EVALUATE TRUE                                                05420099
050500         WHEN SQLCODE = ZERO                                      05430099
050600             MOVE PV-CURR-DATE-CCYYMMDD TO PV-CURR-DATE           05440099
050700             MOVE PV-CURR-YEAR       TO SD-SYSTEM-YEAR            05450099
050800             MOVE PV-CURR-MONTH      TO SD-SYSTEM-MONTH           05460099
050900             MOVE PV-CURR-DAY        TO SD-SYSTEM-DAY             05470099
051000             MOVE PV-CURRENT-TIME    TO PV-CURR-TIME              05480099
051100             MOVE PV-CURR-HOUR       TO ST-SYSTEM-HOUR            05490099
051200             MOVE PV-CURR-MIN        TO ST-SYSTEM-MINUTE          05500099
051300         WHEN OTHER                                               05510099
051400              MOVE '1050-GET-DATES'                               05520099
051500                               TO  PV-PARAGRAPH-NAME              05530099
051600              MOVE 'SET REPORT DATES FROM CURRENT DATE'           05540099
051700                               TO  PV-DB2-OPERATION-ATTEMPTED     05550099
051800              PERFORM 9100-SQL-ABEND                              05560099
051900     END-EVALUATE.                                                05570099
052000                                                                  05580099
052100******************************************************************05590099
052200* 1060-PREPARE-FOR-REPORT:                                        05600099
052300*   SET UP DATES AND REPORT FIELDS TO PRODUCE THE REPORT.         05610099
052400******************************************************************05620099
052500 1060-PREPARE-FOR-REPORT.                                         05630099
052600                                                                  05640099
052700     MOVE 'VLKUT051'         TO DP200O-PROGRAM-NAME.              05650099
052800     MOVE 1                  TO DP200O-REPORT-NUMBER.             05660099
052900     DISPLAY '**** ...CREATING THE INACTIVE COMBINED SETS FILE'.  05670099
053000                                                                  05680099
053100*                                                                 05690099
053200******************************************************************05700099
053300* 2000-CREATE-REPORT.                                             05710099
053400* PROCESS:  THIS PARAGRAPH CREATE THE REPORT                      05720099
053500******************************************************************05730099
053600 2000-CREATE-REPORT.                                              05740099
053700                                                                  05750099
053800     MOVE PURCHS-SEASET-YR        TO PV-HOLD-SEASET-YR            05760099
053900     MOVE PURCHS-SEASET-SHRT-NM   TO PV-HOLD-SEASET.              05770099
054000     MOVE PURCHS-PO-NBR           TO PV-HOLD-PO-NBR.              05780099
054100     MOVE RECEIV-STATUS-CDE       TO PV-HOLD-STATUS-CDE.          05790099
054200     MOVE RECEIV-REC-SEQ-NBR      TO PV-HOLD-REC-SEQ-NBR.         05800099
054300     MOVE ENTNME-ENT-NAME-DESC    TO PV-HOLD-ENT-NAME-DESC.       05810099
054301*                                                                 05820099
054302*** DMH BEGIN - 1/25/16                                           05830099
054303*** REMOVE SPECIAL CHARACTERS FROM THE ENT-NAME FIELD             05840099
054304*                                                                 05850099
054305     MOVE SPACE TO  PC-SPACE.                                     05860099
054306     INSPECT PV-HOLD-ENT-NAME-DESC REPLACING ALL                  05870099
054307         ','   BY PC-SPACE.                                       05880099
054308     INSPECT PV-HOLD-ENT-NAME-DESC REPLACING ALL                  05890099
054309         '/'   BY PC-SPACE.                                       05900099
054310     INSPECT PV-HOLD-ENT-NAME-DESC REPLACING ALL                  05910099
054311         '<'   BY PC-SPACE.                                       05920099
054312     INSPECT PV-HOLD-ENT-NAME-DESC REPLACING ALL                  05930099
054313         '>'   BY PC-SPACE.                                       05940099
054314     INSPECT PV-HOLD-ENT-NAME-DESC REPLACING ALL                  05950099
054315         '*'   BY PC-SPACE.                                       05960099
054316     INSPECT PV-HOLD-ENT-NAME-DESC REPLACING ALL                  05970099
054317         '-'   BY PC-SPACE.                                       05980099
054318     INSPECT PV-HOLD-ENT-NAME-DESC REPLACING ALL                  05990099
054319         QUOTE BY PC-SPACE.                                       06000099
054320     INSPECT PV-HOLD-ENT-NAME-DESC REPLACING ALL                  06010099
054321         '!'   BY PC-SPACE.                                       06020099
054322     INSPECT PV-HOLD-ENT-NAME-DESC REPLACING ALL                  06030099
054323         '.'   BY PC-SPACE.                                       06040099
054324*                                                                 06050099
054325*** DMH END - 1/25/16                                             06060099
054326*                                                                 06070099
054330                                                                  06080099
054400     MOVE PURCHS-DEPT-NBR         TO PV-HOLD-DEPT-NBR.            06090099
054500     MOVE PLNSHP-DONT-SHIP-BEF-DTE                                06100099
054600                                  TO PV-HOLD-DONT-SHIP-BEF-DTE.   06110099
054700     MOVE PLNSHP-CAN-IFNOT-SHIP-DTE                               06120099
054800                                  TO PV-HOLD-CAN-IFNOT-SHIP-DTE.  06130099
054900     MOVE PLNSHP-EXT-CAN-DTE      TO PV-HOLD-EXT-CAN-DTE          06140099
055000     MOVE PURCHS-PO-TYP-CDE       TO PV-HOLD-PO-TYP-CDE           06150099
055100     MOVE PURCHS-TOT-UNT-QTY      TO PV-HOLD-TOT-UNT-QTY.         06160099
055200     MOVE PV-REC-ARRIVAL-DTE      TO PV-HOLD-ARRIVAL-DTE.         06170099
055300     MOVE PV-REC-ARRIVAL-TIM      TO PV-HOLD-ARRIVAL-TIM.         06180099
055400                                                                  06190099
AV0524     IF PS-PRINT-HEADER-NO                                        06200099
AV0524        PERFORM 8400-WRITE-COLUMN-HEADING                         06210099
AV0524        PERFORM 8500-WRITE-BLANK-LINE                             06220099
AV0524        SET PS-PRINT-HEADER-YES TO TRUE                           06230099
AV0524     END-IF.                                                      06240099
055700                                                                  06250099
055800     PERFORM UNTIL PS-END-OF-RPT-CURSOR                           06260099
055900         IF PURCHS-PO-NBR       = PV-HOLD-PO-NBR                  06270099
056000               PERFORM 2300-MOVE-DETAIL-LINES                     06280099
056100         ELSE                                                     06290099
056200            PERFORM 2300-MOVE-DETAIL-LINES                        06300099
056300            PERFORM 2500-PRINT-RPT-LINES                          06310099
056400            MOVE 'N'                 TO PS-CHANGE-STATUS-IND      06320099
056500         END-IF                                                   06330099
056600         PERFORM 7200-FETCH-MAIN-RPT-CURSOR                       06340099
056700     END-PERFORM.                                                 06350099
056800                                                                  06360099
056900     PERFORM 2300-MOVE-DETAIL-LINES.                              06370099
057000     PERFORM 2500-PRINT-RPT-LINES.                                06380099
AV0524     PERFORM 7100-CLOSE-MAIN-RPT-CURSOR.                          06390099
057200                                                                  06400099
057300 2500-PRINT-RPT-LINES.                                            06410099
057400*                                                                 06420099
057500     IF  PS-STATUS-IND-CHANGED                                    06430099
057600*        MOVE SPACES               TO DL-PO-NUMBER                06440099
057700*                                     DL-VENDOR-NAME              06450099
057800*                                     DL-DEPT-NBR                 06460099
057900*                                     DL-SHIP-DATE                06470099
058000*                                     DL-CANCEL-DATE              06480099
058100*                                     DL-EXT-CANCEL-DATE          06490099
058200         MOVE '        0'          TO DL-TOTAL-UNITS.             06500099
058300                                                                  06510099
058400     PERFORM 8000-WRITE-DETAIL-LINE.                              06520099
058500                                                                  06530099
058600     MOVE PURCHS-SEASET-YR         TO PV-HOLD-SEASET-YR           06540099
058700     MOVE PURCHS-SEASET-SHRT-NM    TO PV-HOLD-SEASET.             06550099
058800     MOVE PURCHS-PO-NBR            TO PV-HOLD-PO-NBR.             06560099
058900     MOVE ENTNME-ENT-NAME-DESC     TO PV-HOLD-ENT-NAME-DESC.      06570099
058910*                                                                 06580099
058920*** DMH BEGIN - 1/25/16                                           06590099
058930*** REMOVE SPECIAL CHARACTERS FROM THE ENT-NAME FIELD             06600099
058940*                                                                 06610099
058950     MOVE SPACE TO  PC-SPACE.                                     06620099
058960     INSPECT PV-HOLD-ENT-NAME-DESC REPLACING ALL                  06630099
058970         ','   BY PC-SPACE.                                       06640099
058980     INSPECT PV-HOLD-ENT-NAME-DESC REPLACING ALL                  06650099
058990         '/'   BY PC-SPACE.                                       06660099
058991     INSPECT PV-HOLD-ENT-NAME-DESC REPLACING ALL                  06670099
058992         '<'   BY PC-SPACE.                                       06680099
058993     INSPECT PV-HOLD-ENT-NAME-DESC REPLACING ALL                  06690099
058994         '>'   BY PC-SPACE.                                       06700099
058995     INSPECT PV-HOLD-ENT-NAME-DESC REPLACING ALL                  06710099
058996         '*'   BY PC-SPACE.                                       06720099
058997     INSPECT PV-HOLD-ENT-NAME-DESC REPLACING ALL                  06730099
058998         '-'   BY PC-SPACE.                                       06740099
058999     INSPECT PV-HOLD-ENT-NAME-DESC REPLACING ALL                  06750099
059000         QUOTE BY PC-SPACE.                                       06760099
059001     INSPECT PV-HOLD-ENT-NAME-DESC REPLACING ALL                  06770099
059002         '!'   BY PC-SPACE.                                       06780099
059003     INSPECT PV-HOLD-ENT-NAME-DESC REPLACING ALL                  06790099
059004         '.'   BY PC-SPACE.                                       06800099
059005*                                                                 06810099
059006*** DMH END - 1/25/16                                             06820099
059007*                                                                 06830099
059010     MOVE PURCHS-DEPT-NBR          TO PV-HOLD-DEPT-NBR.           06840099
059100     MOVE PLNSHP-DONT-SHIP-BEF-DTE TO PV-HOLD-DONT-SHIP-BEF-DTE.  06850099
059200     MOVE PLNSHP-CAN-IFNOT-SHIP-DTE                               06860099
059300                                  TO PV-HOLD-CAN-IFNOT-SHIP-DTE.  06870099
059400     MOVE PLNSHP-EXT-CAN-DTE      TO PV-HOLD-EXT-CAN-DTE          06880099
059500     MOVE PURCHS-TOT-UNT-QTY      TO PV-HOLD-TOT-UNT-QTY.         06890099
059600     MOVE PURCHS-PO-TYP-CDE       TO PV-HOLD-PO-TYP-CDE.          06900099
059700     MOVE '        0'             TO DL-TOTAL-UNITS.              06910099
059800                                                                  06920099
059900******************************************************************06930099
060000*2300-MOVE-DETAIL-LINES.                                          06940099
060100* PROCESS:  MOVE THE NEEDED DETAIL LINES FOR THE REPORT.          06950099
060200******************************************************************06960099
060300 2300-MOVE-DETAIL-LINES.                                          06970099
060400                                                                  06980099
060500*    MOVE PV-HOLD-SEASET-YR   TO DL-SEASET-YR                     06990099
060600     MOVE PV-HOLD-SEASET      TO DL-SEASET                        07000099
060700     MOVE PV-HOLD-PO-NBR      TO DL-PO-NUMBER                     07010099
060800     MOVE PV-HOLD-ENT-NAME-DESC                                   07020099
060900                              TO DL-VENDOR-NAME                   07030099
061000     MOVE PV-HOLD-DEPT-NBR    TO DL-DEPT-NBR                      07040099
061100     MOVE PV-HOLD-DONT-SHIP-BEF-DTE                               07050099
061200                              TO DL-SHIP-DATE                     07060099
061300     MOVE PV-HOLD-CAN-IFNOT-SHIP-DTE                              07070099
061400                              TO DL-CANCEL-DATE                   07080099
061500     IF PV-HOLD-EXT-CAN-DTE = '0001-01-01'                        07090099
061600         MOVE SPACES          TO DL-EXT-CANCEL-DATE               07100099
061700     ELSE                                                         07110099
061800         MOVE PV-HOLD-EXT-CAN-DTE                                 07120099
061900                              TO DL-EXT-CANCEL-DATE               07130099
062000     END-IF                                                       07140099
062100     MOVE PV-HOLD-TOT-UNT-QTY                                     07150099
062200                             TO PV-TEMP-TOT-UNT-QTY               07160099
062300     MOVE PV-TEMP-TOT-UNT-QTY                                     07170099
062400                             TO DL-TOTAL-UNITS.                   07180099
062500     MOVE PV-HOLD-PO-TYP-CDE TO DL-PO-TYP-CDE.                    07190099
062600                                                                  07200099
AV0524******************************************************************07210099
AV0524* 6500-OPEN-SST-CURSOR.                                          *07220099
AV0524*  THIS PROCEDURE WILL OPEN THE SST CURSOR                       *07230099
AV0524******************************************************************07240099
AV0524 6500-OPEN-SST-CURSOR.                                            07250099
AV0524*                                                                 07260099
AV0524     EXEC SQL                                                     07270099
AV0524          OPEN SST_CSR                                            07280099
AV0524     END-EXEC                                                     07290099
AV0524*                                                                 07300099
AV0524     EVALUATE TRUE                                                07310099
AV0524         WHEN SQLCODE = ZERO                                      07320099
AV0524              SET PS-NOT-END-OF-SST-CURSOR                        07330099
AV0524                               TO  TRUE                           07340099
AV0524*                                                                 07350099
AV0524         WHEN SQLWARN0 NOT EQUAL SPACE                            07360099
AV0524         WHEN SQLCODE NOT EQUAL ZERO                              07370099
AV0524              MOVE '6500-OPEN-SST-CURSOR'                         07380099
AV0524                               TO  PV-PARAGRAPH-NAME              07390099
AV0524              MOVE 'OPEN SST_CSR'                                 07400099
AV0524                               TO  PV-DB2-OPERATION-ATTEMPTED     07410099
AV0524              PERFORM 9100-SQL-ABEND                              07420099
AV0524     END-EVALUATE.                                                07430099
AV0524                                                                  07440099
AV0524******************************************************************07450099
AV0524*6600-PROCESS-SST-CURSOR.                                         07460099
AV0524******************************************************************07470099
AV0524 6600-PROCESS-SST-CURSOR.                                         07480099
AV0524     MOVE SEASET-SEASET-YR      TO WS-SEASET-YR.                  07490099
AV0524     MOVE SEASET-SEASET-SHRT-NM TO WS-SEASET-SHRT-NM.             07500099
AV0524     PERFORM 7000-OPEN-MAIN-RPT-CURSOR.                           07510099
AV0524     PERFORM 7200-FETCH-MAIN-RPT-CURSOR.                          07520099
AV0524*    IF PS-PRINT-BLANK-LINE-NO                                    07530099
AV0524*       SET PS-PRINT-BLANK-LINE-YES TO TRUE                       07540099
AV0524*    ELSE                                                         07550099
AV0524*       IF NOT PS-END-OF-RPT-CURSOR                               07560099
AV0524*          PERFORM 8500-WRITE-BLANK-LINE                          07570099
AV0524*          PERFORM 8500-WRITE-BLANK-LINE                          07580099
AV0524*          PERFORM 8500-WRITE-BLANK-LINE                          07590099
AV0524*       END-IF                                                    07600099
AV0524*    END-IF.                                                      07610099
AV0524     IF PS-END-OF-RPT-CURSOR                                      07620099
AV0524        PERFORM 7100-CLOSE-MAIN-RPT-CURSOR                        07630099
AV0524     ELSE                                                         07640099
AV0524        PERFORM 2000-CREATE-REPORT                                07650099
AV0524     END-IF                                                       07660099
AV0524     PERFORM 6700-FETCH-SST-CURSOR.                               07670099
AV0524                                                                  07680099
AV0524                                                                  07690099
AV0524                                                                  07700099
AV0524******************************************************************07710099
AV0524* 6700-FETCH-SST-CURSOR.                                         *07720099
AV0524*  THIS PROCEDURE WILL FETCH THE DATA OF SST CURSOR              *07730099
AV0524******************************************************************07740099
AV0524*                                                                 07750099
AV0524 6700-FETCH-SST-CURSOR.                                           07760099
AV0524*                                                                 07770099
AV0524     EXEC SQL                                                     07780099
AV0524          FETCH SST_CSR                                           07790099
AV0524          INTO                                                    07800099
AV0524                :SEASET-SEASET-YR                                 07810099
AV0524               ,:SEASET-SEASET-SHRT-NM                            07820099
AV0524     END-EXEC                                                     07830099
AV0524                                                                  07840099
AV0524     EVALUATE TRUE                                                07850099
AV0524         WHEN SQLCODE = ZERO                                      07860099
AV0524              ADD 01 TO WS-SST-FETCH-CNT                          07870099
AV0524              MOVE SEASET-SEASET-YR TO WS-SEASET-YR               07880099
AV0524              MOVE SEASET-SEASET-SHRT-NM TO WS-SEASET-SHRT-NM     07890099
AV0524                                                                  07900099
AV0524         WHEN SQLCODE = PC-ROW-NOT-FOUND                          07910099
AV0524              SET PS-END-OF-SST-CURSOR                            07920099
AV0524                           TO  TRUE                               07930099
AV0524                                                                  07940099
AV0524         WHEN SQLWARN0 NOT EQUAL SPACE                            07950099
AV0524         WHEN SQLCODE NOT EQUAL ZERO                              07960099
AV0524              MOVE '6700-FETCH-SST-CURSOR'                        07970099
AV0524                               TO  PV-PARAGRAPH-NAME              07980099
AV0524              MOVE 'FETCH SST_CSR'                                07990099
AV0524                               TO  PV-DB2-OPERATION-ATTEMPTED     08000099
AV0524              PERFORM 9100-SQL-ABEND                              08010099
AV0524     END-EVALUATE.                                                08020099
AV0524******************************************************************08030099
AV0524* 6900-CLOSE-SST-CURSOR.                                         *08040099
AV0524*  THIS PROCEDURE WILL CLOSE THE SST CURSOR                      *08050099
AV0524******************************************************************08060099
AV0524 6900-CLOSE-SST-CURSOR.                                           08070099
AV0524*                                                                 08080099
AV0524     EXEC SQL                                                     08090099
AV0524          CLOSE SST_CSR                                           08100099
AV0524     END-EXEC                                                     08110099
AV0524*                                                                 08120099
AV0524     EVALUATE TRUE                                                08130099
AV0524         WHEN SQLWARN0 NOT EQUAL SPACE                            08140099
AV0524         WHEN SQLCODE NOT EQUAL ZERO                              08150099
AV0524              MOVE '6900-CLOSE-SST-CURSOR'                        08160099
AV0524                               TO  PV-PARAGRAPH-NAME              08170099
AV0524              MOVE 'CLOSE SST_CSR'                                08180099
AV0524                               TO  PV-DB2-OPERATION-ATTEMPTED     08190099
AV0524              PERFORM 9100-SQL-ABEND                              08200099
AV0524     END-EVALUATE.                                                08210099
062700 7000-OPEN-MAIN-RPT-CURSOR.                                       08220099
062800                                                                  08230099
062900     EXEC SQL                                                     08240099
063000          OPEN RPT_CURSOR1                                        08250099
063100     END-EXEC                                                     08260099
063200                                                                  08270099
063300     EVALUATE TRUE                                                08280099
063400         WHEN SQLCODE = ZERO                                      08290099
063500              SET PS-NOT-END-OF-RPT-CURSOR                        08300099
063600                               TO  TRUE                           08310099
063700                                                                  08320099
063800         WHEN SQLWARN0 NOT EQUAL SPACE                            08330099
063900         WHEN SQLCODE NOT EQUAL ZERO                              08340099
064000              MOVE '7000-OPEN-RPT-CURSOR'                         08350099
064100                               TO  PV-PARAGRAPH-NAME              08360099
064200              MOVE 'OPEN RPT_CURSOR1'                             08370099
064300                               TO  PV-DB2-OPERATION-ATTEMPTED     08380099
064400              PERFORM 9100-SQL-ABEND                              08390099
064500     END-EVALUATE.                                                08400099
064600                                                                  08410099
064700 7100-CLOSE-MAIN-RPT-CURSOR.                                      08420099
064800                                                                  08430099
064900     EXEC SQL                                                     08440099
065000          CLOSE RPT_CURSOR1                                       08450099
065100     END-EXEC                                                     08460099
065200                                                                  08470099
065300     EVALUATE TRUE                                                08480099
065400         WHEN SQLWARN0 NOT EQUAL SPACE                            08490099
065500         WHEN SQLCODE NOT EQUAL ZERO                              08500099
0V5600              MOVE '7100-CLOSE-MAIN-RPT-CURSOR'                   08510099
065700                               TO  PV-PARAGRAPH-NAME              08520099
065800              MOVE 'CLOSE RPT_CURSOR1'                            08530099
065900                               TO  PV-DB2-OPERATION-ATTEMPTED     08540099
066000              PERFORM 9100-SQL-ABEND                              08550099
066100     END-EVALUATE.                                                08560099
066200                                                                  08570099
066300 7200-FETCH-MAIN-RPT-CURSOR.                                      08580099
066400                                                                  08590099
066500     EXEC SQL                                                     08600099
066600          FETCH RPT_CURSOR1                                       08610099
066700          INTO                                                    08620099
066800                :PURCHS-PO-NBR                                    08630099
066900               ,:PURCHS-PO-TYP-CDE                                08640099
067000               ,:PURCHS-TOT-UNT-QTY                               08650099
067100               ,:PURCHS-DEPT-NBR                                  08660099
067200               ,:PURCHS-VER-NBR                                   08670099
067300               ,:PURCHS-SEASET-YR                                 08680099
067400               ,:PURCHS-SEASET-SHRT-NM                            08690099
067500               ,:PLNSHP-DONT-SHIP-BEF-DTE                         08700099
067600               ,:PLNSHP-CAN-IFNOT-SHIP-DTE                        08710099
067700               ,:PLNSHP-EXT-CAN-DTE                               08720099
067800               ,:ENTNME-ENT-NAME-DESC                             08730099
067900               ,:RECEIV-STATUS-CDE                                08740099
068000               ,:RECEIV-FCLTY-ID                                  08750099
068100               ,:RECEIV-REC-SEQ-NBR                               08760099
068200               ,:PV-REC-ARRIVAL-DTE                               08770099
068300               ,:PV-REC-ARRIVAL-TIM                               08780099
068400     END-EXEC                                                     08790099
068500                                                                  08800099
068600     EVALUATE TRUE                                                08810099
068700         WHEN SQLCODE = ZERO                                      08820099
AV0524              ADD 01 TO WS-RPT-FETCH-CNT                          08830099
068900                                                                  08840099
069000         WHEN SQLCODE = PC-ROW-NOT-FOUND                          08850099
069100              SET PS-END-OF-RPT-CURSOR                            08860099
069200                               TO  TRUE                           08870099
069300                                                                  08880099
069400         WHEN SQLWARN0 NOT EQUAL SPACE                            08890099
069500         WHEN SQLCODE NOT EQUAL ZERO                              08900099
069600              MOVE '7200-FETCH-RPT-CURSOR'                        08910099
069700                               TO  PV-PARAGRAPH-NAME              08920099
069800              MOVE 'FETCH RPT_CURSOR1'                            08930099
069900                               TO  PV-DB2-OPERATION-ATTEMPTED     08940099
070000              PERFORM 9100-SQL-ABEND                              08950099
070100     END-EVALUATE.                                                08960099
070200                                                                  08970099
070300                                                                  08980099
070400*                                                                 08990099
070500******************************************************************09000099
070600* 8000-WRITE-DETAIL-LINE - CHECKS IF THE PAGE SIZE HAS BEEN EX-   09010099
070700* CEEDED.  IF SO, THE HEADING LINES ARE WRITTEN AND THE LINE COUNT09020099
070800* INITIALIZED.  THE DETAIL LINE IS THEN WRITTEN.                  09030099
070900******************************************************************09040099
071000 8000-WRITE-DETAIL-LINE.                                          09050099
071100                                                                  09060099
071200                                                                  09070099
071300     WRITE DI-OUTPUT-RECORD                                       09080099
071400       FROM DL-DETAIL-LINE.                                       09090099
071500                                                                  09100099
AV0524     ADD +1                        TO WS-DETAIL-CNT.              09101099
071600     ADD +2                        TO PV-LINE-COUNT.              09110099
071700                                                                  09120099
071800 8400-WRITE-COLUMN-HEADING.                                       09130099
071900                                                                  09140099
072000     WRITE DI-OUTPUT-RECORD                                       09150099
072100        FROM DH2-DETAIL-HEADING.                                  09160099
072200                                                                  09170099
072300     WRITE DI-OUTPUT-RECORD                                       09180099
072400        FROM DH2-DETAIL-HEADING-D2.                               09190099
072500                                                                  09200099
072600     PERFORM 8500-WRITE-BLANK-LINE.                               09210099
072700                                                                  09220099
072800     MOVE +8      TO PV-LINE-COUNT.                               09230099
072900                                                                  09240099
073000******************************************************************09250099
073100* 8500-WRITE-BLANK-LINE - CENTRAL LOCATION FOR THIS CODE.         09260099
073200******************************************************************09270099
073300 8500-WRITE-BLANK-LINE.                                           09280099
073400                                                                  09290099
073500     WRITE DI-OUTPUT-RECORD                                       09300099
073600         FROM BLANK-LINE.                                         09310099
073700                                                                  09320099
073800******************************************************************09330099
073900* 8900-EMPTY-VENDOR-RPT - IF THERE WAS NO DATA THAT SATISFIED THE 09340099
074000* SELECTION CRITERIA                                              09350099
074100******************************************************************09360099
074200 8900-EMPTY-VENDOR-RPT.                                           09370099
074300                                                                  09380099
074400*    PERFORM 8400-WRITE-COLUMN-HEADING.                           09390099
074500                                                                  09400099
074600*    WRITE DI-OUTPUT-REPORT-LINE                                  09410099
074700*        FROM ER-EMPTY-REPORT-LINE                                09420099
074800*        AFTER ADVANCING 1 LINES.                                 09430099
074900     DISPLAY ER-EMPTY-REPORT-LINE.                                09440099
075000                                                                  09450099
075100******************************************************************09460099
075200* 9100-SQL-ABEND - PERFORMS THE ABEND FOR THE PROGRAM IN THE      09470099
075300* EVENT THAT AN SQL ERROR OR WARNING CODE OCCURS.                 09480099
075400******************************************************************09490099
075500 9100-SQL-ABEND.                                                  09500099
075600     DISPLAY '** ABEND     **'.                                   09510099
075700     DISPLAY '** PROGRAM   ** = VLKUT051'.                        09520099
075800     DISPLAY '** PARAGRAPH ** = ' PV-PARAGRAPH-NAME.              09530099
075900     DISPLAY '** OPERATION ** = ' PV-DB2-OPERATION-ATTEMPTED.     09540099
076000                                                                  09550099
076100******************************************************************09560099
076200* THIS COPY BOOK MEMBER CONTAINS THE PROCEDURE DIVISION STATE-    09570099
076300* MENTS THAT ARE REQUIRED TO UTILIZE THE DB2 ABEND MODULE         09580099
076400* 'DSNTIAR' AND CONVERT THE SQLCA INFORMATION INTO A READABLE     09590099
076500* FORMAT.                                                         09600099
076600******************************************************************09610099
076700     COPY DPPD004.                                                09620099
076800                                                                  09630099
076900     MOVE +4013 TO ABEND-CODE.                                    09640099
077000     CALL 'ILBOABN0' USING ABEND-CODE.                            09650099
