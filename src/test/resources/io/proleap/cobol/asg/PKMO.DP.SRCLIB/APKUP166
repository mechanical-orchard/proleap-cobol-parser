000100 IDENTIFICATION DIVISION.                                         00010000
000200 PROGRAM-ID.    APKUP166.                                         00020000
000300 AUTHOR.        ANIL BEDEKAR.                                     00030000
000400 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00040000
000500 DATE-WRITTEN.  JULY 2011.                                        00050000
000600                                                                  00060000
000700***************************************************************** 00070000
000800*  RELOAD THE FINANCIAL DOMAIN LOCATION TABLES.                 * 00080000
000900*                                                               * 00090000
001000*  THIS IS A DAILY PROGRAM THAT RELOADS THE XFT_LOC AND         * 00100000
001100*  XFT_LOC_ATTR TABLES FROM A FLAT FILE. THE FLAT FILE IS       * 00110000
001200*  AN EXTRACT OF THE ORACLE OUT LOCATION TABLE, "OUTLOC",       * 00120000
001300*  PROVIDED BY RETEK(RMS).                                      * 00130000
001400*                                                               * 00140000
001500*  PROGRAM COPIED FROM XFKUP003, THEN COPIED FROM XFKUP134.     * 00150000
001500*  IF THIS PROGRAM CHANGES, THE ORIGINAL PROGRAM MAY ALSO NEED  * 00151000
001600*  TO CHANGE.                                                   * 00160000
001700***************************************************************** 00170000
001800*  CHANGE LOG:                                                  * 00180000
001900*                                                               * 00190000
002000*  DATE  07/27/2011                                             * 00200000
002100*      CHANGE MADE: INITIAL PROGRAM                             * 00210000
002200*      MADE BY: ANIL BEDEKAR            WR/IR  #: WR37038       * 00220000
002300*                                                               * 00230000
002400***************************************************************** 00240000
002500 ENVIRONMENT DIVISION.                                            00250000
002600                                                                  00260000
002700 CONFIGURATION SECTION.                                           00270000
002800 SOURCE-COMPUTER.       IBM-3090.                                 00280000
002900 OBJECT-COMPUTER.       IBM-3090.                                 00290000
003000                                                                  00300000
003100 INPUT-OUTPUT SECTION.                                            00310000
003200                                                                  00320000
003300 FILE-CONTROL.                                                    00330000
003400     SELECT OUTLOC-FILE               ASSIGN TO INP01.            00340000
003500                                                                  00350000
003600 DATA DIVISION.                                                   00360000
003700                                                                  00370000
003800 FILE SECTION.                                                    00380000
003900                                                                  00390000
004000 FD  OUTLOC-FILE                                                  00400000
004100     RECORDING MODE IS F                                          00410000
004200     BLOCK CONTAINS 0 RECORDS                                     00420000
004300     LABEL RECORDS ARE STANDARD.                                  00430000
004400                                                                  00440000
004500 01  OUTLOC-RECORD                    PIC X(195).                 00450000
004600                                                                  00460000
004700                                                                  00470000
004800 WORKING-STORAGE SECTION.                                         00480000
004900                                                                  00490000
005000 01  PC-PROGRAM-CONSTANTS.                                        00500000
005100     05  PC-PGM-NAME           PIC X(08)  VALUE 'APKUP166'.       00510000
005200     05  PC-DEFAULT-DATE       PIC X(10)  VALUE '9999-09-09'.     00520000
005300                                                                  00530000
005400 01  PS-PROGRAM-SWITCHES.                                         00540000
005500     05  PS-END-OF-OUTLOC-FILE-SW     PIC X(01)      VALUE 'N'.   00550000
005600         88  PS-NOT-END-OF-OUTLOC-FILE               VALUE 'N'.   00560000
005700         88  PS-END-OF-OUTLOC-FILE                   VALUE 'Y'.   00570000
005800                                                                  00580000
005900 01  WS-WORKING-STORAGE.                                          00590000
006000     05  WS-CURRENT-DATE              PIC  X(10)  VALUE SPACES.   00600000
006100     05  WS-CURRENT-TIME              PIC  X(08)  VALUE SPACES.   00610000
006200                                                                  00620000
006300 01  WS-PROGRAM-COUNTERS.                                         00630000
006400     05  WS-IN-OUTLOC-COUNT           PIC  9(05)  VALUE ZEROS.    00640000
006500     05  WS-INSERT-XFT-LOC            PIC  9(05)  VALUE ZEROS.    00650000
006600     05  WS-INSERT-LOC-ATTR           PIC  9(05)  VALUE ZEROS.    00660000
006700     05  WS-SKIPPED-LOCATION          PIC  9(05)  VALUE ZEROS.    00670000
006800                                                                  00680000
006900*---------------------------------------------------------------* 00690000
007000* RECORD LAYOUT FOR INPUT LOCATION FILE                         * 00700000
007100*---------------------------------------------------------------* 00710000
007200     COPY HORD007.                                                00720000
007300                                                                  00730000
007400*---------------------------------------------------------------* 00740000
007500*    STANDARD DB2 ERROR HANDLING AREA                           * 00750000
007600*---------------------------------------------------------------* 00760000
007700     COPY DPWS004.                                                00770000
007800                                                                  00780000
007900*---------------------------------------------------------------* 00790000
008000*    DCLGEN FOR THE STORE LOCATION TABLE, XFT_LOC               * 00800000
008100*---------------------------------------------------------------* 00810000
008200     EXEC SQL                                                     00820000
008300         INCLUDE XFT00017                                         00830000
008400     END-EXEC.                                                    00840000
008500                                                                  00850000
008600*---------------------------------------------------------------* 00860000
008700*    DCLGEN FOR THE LOCATION ATTRIBUTE TABLE, XFT_LOC_ATTR      * 00870000
008800*---------------------------------------------------------------* 00880000
008900     EXEC SQL                                                     00890000
009000         INCLUDE XFT00019                                         00900000
009100     END-EXEC.                                                    00910000
009200                                                                  00920000
009300*----------------------------------------------------------------*00930000
009400*    STANDARD DB2 COMMUNICATIONS AREA                            *00940000
009500*----------------------------------------------------------------*00950000
009600     EXEC SQL                                                     00960000
009700         INCLUDE SQLCA                                            00970000
009800     END-EXEC.                                                    00980000
009900                                                                  00990000
010000****************************************************************  01000000
010100* WORKING STORAGE FOR ABEND PROCESSING                            01010000
010200****************************************************************  01020000
010300                                                                  01030000
010400 01  ABEND-CODE                PIC S9(04)  VALUE ZEROS COMP SYNC. 01040000
010500     88  AC-DB2-ERROR                        VALUE +4013.         01050000
010600                                                                  01060000
010700 01  ABEND-AREAS.                                                 01070000
010800     05  AA-ABEND-LIT          PIC  X(40)  VALUE                  01080000
010900             '*****       ABEND'.                                 01090000
011000     05  AA-PROGRAM-LIT        PIC  X(40)  VALUE                  01100000
011100             '*****   PROGRAM: APKUP166'.                         01110000
011200     05  AA-PARAGRAPH-LIT.                                        01120000
011300         10  FILLER            PIC  X(17)  VALUE                  01130000
011400             '***** PARAGRAPH: '.                                 01140000
011500         10  AA-PARAGRAPH-NAME PIC  X(35)  VALUE SPACES.          01150000
011600     05  AA-MESSAGE-LINE.                                         01160000
011700         10  FILLER            PIC  X(06)  VALUE '*****'.         01170000
011800         10  AA-MESSAGE        PIC  X(127) VALUE SPACES.          01180000
011900         10  FILLER REDEFINES AA-MESSAGE.                         01190000
012000             15 AA-MESSAGE-1   PIC  X(45).                        01200000
012100             15 AA-MESSAGE-2   PIC  X(45).                        01210000
012200             15 AA-MESSAGE-3   PIC  X(37).                        01220000
012300     05  AA-DB2-ERROR-LIT      PIC  X(40)  VALUE                  01230000
012400             '*****    DB2 ERROR'.                                01240000
012500     05  AA-DB2-OPERATION-LIT.                                    01250000
012600         10  FILLER            PIC  X(17)  VALUE                  01260000
012700             '***** OPERATION: '.                                 01270000
012800         10  AA-DB2-OPERATION.                                    01280000
012900             15  AA-DB2-OP-1   PIC  X(25)  VALUE SPACES.          01290000
013000             15  AA-DB2-OP-2   PIC  X(25)  VALUE SPACES.          01300000
013100     05  AA-DB2-TABLE-LIT.                                        01310000
013200         10  FILLER            PIC  X(14)  VALUE                  01320000
013300             '***** TABLES: '.                                    01330000
013400         10  AA-DB2-TABLE-1    PIC  X(18)  VALUE SPACES.          01340000
013500         10  AA-DB2-TABLE-2    PIC  X(18)  VALUE SPACES.          01350000
013600         10  AA-DB2-TABLE-3    PIC  X(18)  VALUE SPACES.          01360000
013700                                                                  01370000
013800 PROCEDURE DIVISION.                                              01380000
013900                                                                  01390000
014000 A100-MAINLINE-ROUTINE.                                           01400000
014100                                                                  01410000
014200     PERFORM B100-INITIALIZATION.                                 01420000
014300                                                                  01430000
014400     PERFORM B200-PROCESS-LOCATIONS                               01440000
014500       UNTIL PS-END-OF-OUTLOC-FILE.                               01450000
014600                                                                  01460000
014700     PERFORM C200-CREATE-DISTRICTS.                               01470000
014800                                                                  01480000
014900     PERFORM Z900-END-OF-JOB.                                     01490000
015000                                                                  01500000
015100     GOBACK.                                                      01510000
015200                                                                  01520000
015300*************************************************************     01530000
015400** INITIALIZATION ROUTINE                                         01540000
015500*************************************************************     01550000
015600 B100-INITIALIZATION.                                             01560000
015700                                                                  01570000
015800     DISPLAY '***** BEGIN PROGRAM: ' PC-PGM-NAME ' *****'.        01580000
015900     EXEC SQL                                                     01590000
016000          SELECT CURRENT DATE                                     01600000
016100                ,CURRENT TIME                                     01610000
016200            INTO :WS-CURRENT-DATE                                 01620000
016300                ,:WS-CURRENT-TIME                                 01630000
016400            FROM SYSIBM.SYSDUMMY1                                 01640000
016500     END-EXEC.                                                    01650000
016600                                                                  01660000
016700     EVALUATE TRUE                                                01670000
016800       WHEN SQLCODE NOT = ZERO                                    01680000
016900         MOVE 'B100-INITIALIZATION  '    TO AA-PARAGRAPH-NAME     01690000
017000         MOVE 'SELECT'                   TO AA-DB2-OPERATION      01700000
017100         MOVE 'SYSDUMMY1  '              TO AA-DB2-TABLE-1        01710000
017200         PERFORM Z999-DB2-ABEND                                   01720000
017300     END-EVALUATE.                                                01730000
017400                                                                  01740000
017500     DISPLAY 'DATE: ' WS-CURRENT-DATE '    '                      01750000
017600             'TIME: ' WS-CURRENT-TIME.                            01760000
017700     DISPLAY ' '.                                                 01770000
017800                                                                  01780000
017900     OPEN INPUT  OUTLOC-FILE.                                     01790000
018000                                                                  01800000
018100     PERFORM R100-READ-OUTLOC-FILE.                               01810000
018200                                                                  01820000
018300*************************************************************     01830000
018400** THIS ROUTINE PROCESS EACH LOCATION WITH TYPE CODE 'HQ'         01840000
018500*************************************************************     01850000
018600 B200-PROCESS-LOCATIONS.                                          01860000
018700                                                                  01870000
018800     IF HO007-OTLC-TYPE = 'HQ' OR 'DA' OR 'DE' OR 'ND'            01880000
018900        PERFORM C100-DOMAIN-LOCATIONS                             01890000
019000        IF HO007-OUTLC-ID-2-5 = 90                                01900000
019100           DISPLAY '***** CREATING LOCATION 900 FROM 90'          01910000
019200           MOVE 900         TO XFT00017-LOC-NBR                   01920000
019300                               XFT00019-LOC-NBR                   01930000
019400           MOVE '0900'      TO XFT00019-LOCATION                  01940000
019500           PERFORM I100-INSERT-XFT-LOC                            01950000
019600           PERFORM I200-INSERT-XFT-LOC-ATTR                       01960000
019700        END-IF                                                    01970000
019800     ELSE                                                         01980000
019900        ADD 1 TO WS-SKIPPED-LOCATION                              01990000
020000     END-IF.                                                      02000000
020100                                                                  02010000
020200     PERFORM R100-READ-OUTLOC-FILE.                               02020000
020300                                                                  02030000
020400*************************************************************     02040000
020500** THIS ROUTINE POPULATES THE FIELDS FOR THE LOCATION             02050000
020600** DOMAIN TABLES.                                                 02060000
020700*************************************************************     02070000
020800 C100-DOMAIN-LOCATIONS.                                           02080000
020900                                                                  02090000
021000     INITIALIZE DCLXFT00017.                                      02100000
021100     INITIALIZE DCLXFT00019.                                      02110000
021200                                                                  02120000
021300     MOVE HO007-OUTLC-ID-2-5       TO XFT00017-LOC-NBR            02130000
021400                                      XFT00019-LOC-NBR.           02140000
021500     MOVE 0                        TO XFT00017-REPLT-STR-NBR.     02150000
021600     MOVE 0                        TO XFT00017-DIST-NBR.          02160000
021700     MOVE HO007-OTLC-TYPE          TO XFT00017-LOC-TYP-CDE.       02170000
021800     MOVE HO007-OTLC-DESC          TO XFT00017-LOC-NM.            02180000
021900     MOVE HO007-OTLC-LOC-5-ABBR-NM TO XFT00017-LOC-5-ABBR-NM.     02190000
022000     MOVE HO007-OTLC-LNE-1-ADDR    TO XFT00017-LNE-1-ADDR.        02200000
022100     MOVE HO007-OTLC-LNE-2-ADDR    TO XFT00017-LNE-2-ADDR.        02210000
022200     MOVE HO007-OTLC-CTY-NM        TO XFT00017-CTY-NM.            02220000
022300     MOVE HO007-OTLC-ST-CDE        TO XFT00017-ST-CDE.            02230000
022400     MOVE HO007-OTLC-LOC-5-ABBR-NM TO XFT00017-LOC-10-ABBR-NM.    02240000
022500     MOVE SPACES                   TO XFT00017-E-BUS-IND.         02250000
022600                                                                  02260000
022700     MOVE 'SHARE'                  TO XFT00019-SETID.             02270000
022800     MOVE SPACES                   TO XFT00019-DEPTID.            02280000
022900     MOVE HO007-OUTLC-CHAR(2:4)    TO XFT00019-LOCATION.          02290000
023000                                                                  02300000
023100     IF HO007-OTLC-TYPE = 'HQ'                                    02310000
023200        MOVE '9'                   TO XFT00019-KC-ACCT-TYP-CDE    02320000
023300     ELSE                                                         02330000
023400        MOVE '0'                   TO XFT00019-KC-ACCT-TYP-CDE    02340000
023500     END-IF.                                                      02350000
023600                                                                  02360000
023700*    FORMAT ZIP CODE                                              02370000
023800     IF HO007-OTLC-ZIP-10-CDE(1:5) NUMERIC                        02380000
023900        MOVE HO007-OTLC-ZIP-10-CDE(1:5)                           02390000
024000                                  TO XFT00017-ZIP-10-CDE(1:5)     02400000
024100        IF HO007-OTLC-ZIP-10-CDE(6:4) NUMERIC                     02410000
024200           IF HO007-OTLC-ZIP-10-CDE(6:4) = '0000'                 02420000
024300              MOVE SPACES         TO XFT00017-ZIP-10-CDE(6:5)     02430000
024400           ELSE                                                   02440000
024500              MOVE '-'            TO XFT00017-ZIP-10-CDE(6:1)     02450000
024600              MOVE HO007-OTLC-ZIP-10-CDE(6:4)                     02460000
024700                                  TO XFT00017-ZIP-10-CDE(7:4)     02470000
024800           END-IF                                                 02480000
024900        ELSE                                                      02490000
025000           MOVE HO007-OTLC-ZIP-10-CDE                             02500000
025100                                  TO XFT00017-ZIP-10-CDE          02510000
025200        END-IF                                                    02520000
025300     ELSE                                                         02530000
025400        MOVE HO007-OTLC-ZIP-10-CDE TO XFT00017-ZIP-10-CDE         02540000
025500     END-IF.                                                      02550000
025600                                                                  02560000
025700     IF HO007-OTLC-OPN-DTE = SPACES                               02570000
025800        MOVE WS-CURRENT-DATE         TO XFT00017-OPN-DTE          02580000
025900                                        XFT00017-GRND-OPN-DTE     02590000
026000        DISPLAY '*********** LOC NBR = ' HO007-OUTLC-ID-2-5       02600000
026100        DISPLAY '***** HO007-OTLC-OPN-DTE = SPACES'               02610000
026200        DISPLAY '***** DEFAULTING OPEN DATE TO '                  02620000
026300                WS-CURRENT-DATE                                   02630000
026400     ELSE                                                         02640000
026500        MOVE HO007-OTLC-OPN-DTE      TO XFT00017-OPN-DTE          02650000
026600                                        XFT00017-GRND-OPN-DTE     02660000
026700     END-IF.                                                      02670000
026800                                                                  02680000
026900     IF HO007-OTLC-CLO-DTE = SPACES                               02690000
027000        MOVE PC-DEFAULT-DATE         TO XFT00017-CLO-DTE          02700000
027100     ELSE                                                         02710000
027200        MOVE HO007-OTLC-CLO-DTE      TO XFT00017-CLO-DTE          02720000
027300     END-IF.                                                      02730000
027400                                                                  02740000
027500     IF HO007-LOC-FINCL-CLO-DTE = SPACES                          02750000
027600        MOVE PC-DEFAULT-DATE         TO XFT00017-FINCL-CLO-DTE    02760000
027700     ELSE                                                         02770000
027800        MOVE HO007-LOC-CLOSE-DATE    TO XFT00017-FINCL-CLO-DTE    02780000
027900     END-IF.                                                      02790000
028000                                                                  02800000
028100     MOVE PC-DEFAULT-DATE            TO XFT00017-SEA-SLS-INCL-DTE.02810000
028200     MOVE 0                        TO XFT00017-TOT-SLG-SQ-FTG-QTY.02820000
028300     MOVE 0                        TO XFT00017-TOT-SQ-FTG-QTY.    02830000
028400                                                                  02840000
028500     PERFORM I100-INSERT-XFT-LOC.                                 02850000
028600     PERFORM I200-INSERT-XFT-LOC-ATTR.                            02860000
028700                                                                  02870000
028800*************************************************************     02880000
028900** THIS IS FOR PAYROLL MAPPING TO THE GENERAL LEDGER.             02890000
029000*************************************************************     02900000
029100** THESE DISTRICTS ARE DEFAULTS TO HANDLE THE DISTRICT            02910000
029200** ASSOCIATES FOR REPORTING PURPOSES SINCE IN THE HRMS            02920000
029300** SYSTEM THE DEPARTMENT NUMBERS START WITH 9998 FOR HOURLY       02930000
029400** DISTRICT ASSOCIATES AND 9999 FOR THE EXECUTIVE DISTRICT        02940000
029500** ASSOCIATES. PER DAN MILLER                                     02950000
029600*************************************************************     02960000
029700 C200-CREATE-DISTRICTS.                                           02970000
029800     INITIALIZE DCLXFT00017.                                      02980000
029900     INITIALIZE DCLXFT00019.                                      02990000
030000                                                                  03000000
030100**   GENERAL FIELD FOR DISTRICT 9998 AND 9999                     03010000
030200     MOVE 0                        TO XFT00017-REPLT-STR-NBR.     03020000
030300     MOVE 0                        TO XFT00017-DIST-NBR.          03030000
030400     MOVE 'DT'                     TO XFT00017-LOC-TYP-CDE.       03040000
030500     MOVE 'DIST'                   TO XFT00017-LOC-5-ABBR-NM.     03050000
030600     MOVE SPACES                   TO XFT00017-LNE-1-ADDR         03060000
030700                                      XFT00017-LNE-2-ADDR         03070000
030800                                      XFT00017-CTY-NM             03080000
030900                                      XFT00017-ST-CDE             03090000
031000                                      XFT00017-ZIP-10-CDE.        03100000
031100     MOVE '1962-01-01'             TO XFT00017-OPN-DTE            03110000
031200                                      XFT00017-GRND-OPN-DTE.      03120000
031300     MOVE PC-DEFAULT-DATE          TO XFT00017-CLO-DTE.           03130000
031400     MOVE 'DISTRICT'               TO XFT00017-LOC-10-ABBR-NM.    03140000
031500     MOVE PC-DEFAULT-DATE          TO XFT00017-FINCL-CLO-DTE.     03150000
031600     MOVE SPACES                   TO XFT00017-E-BUS-IND.         03160000
031700     MOVE PC-DEFAULT-DATE          TO XFT00017-SEA-SLS-INCL-DTE.  03170000
031800     MOVE 0                      TO XFT00017-TOT-SLG-SQ-FTG-QTY.  03180000
031900     MOVE 0                      TO XFT00017-TOT-SQ-FTG-QTY.      03190000
032000                                                                  03200000
032100                                                                  03210000
032200     MOVE 'SHARE'                  TO XFT00019-SETID.             03220000
032300     MOVE SPACES                   TO XFT00019-DEPTID.            03230000
032400     MOVE '9'                      TO XFT00019-KC-ACCT-TYP-CDE.   03240000
032500                                                                  03250000
032600**   SPECIFIC FOR DISTRICT 9998                                   03260000
032700     MOVE 9998                     TO XFT00017-LOC-NBR            03270000
032800                                      XFT00019-LOC-NBR.           03280000
032900     MOVE 'DISTRICT 9998'          TO XFT00017-LOC-NM.            03290000
033000     MOVE '9998'                   TO XFT00019-LOCATION.          03300000
033100     DISPLAY '***** CREATING DISTRICT LOCATION 9998 FOR HRMS'     03310000
033200                                                                  03320000
033300**   INSERTS FOR DISTRICT 9998                                    03330000
033400     PERFORM I100-INSERT-XFT-LOC                                  03340000
033500     PERFORM I200-INSERT-XFT-LOC-ATTR                             03350000
033600                                                                  03360000
033700**   SPECIFIC FOR DISTRICT 9999                                   03370000
033800     MOVE 9999                     TO XFT00017-LOC-NBR            03380000
033900                                      XFT00019-LOC-NBR.           03390000
034000     MOVE 'DISTRICT 9999'          TO XFT00017-LOC-NM.            03400000
034100     MOVE '9999'                   TO XFT00019-LOCATION.          03410000
034200     DISPLAY '***** CREATING DISTRICT LOCATION 9999 FOR HRMS'     03420000
034300                                                                  03430000
034400**   INSERTS FOR DISTRICT 9999                                    03440000
034500     PERFORM I100-INSERT-XFT-LOC                                  03450000
034600     PERFORM I200-INSERT-XFT-LOC-ATTR.                            03460000
034700                                                                  03470000
034800**************************************************************    03480000
034900** THIS ROUTINE INSERTS A ROW INTO THE XFT_LOC TABLE              03490000
035000** FOR EACH LOCATION TYPE 'HQ'                                    03500000
035100**************************************************************    03510000
035200 I100-INSERT-XFT-LOC.                                             03520000
035300                                                                  03530000
035400      EXEC SQL                                                    03540000
035500         INSERT INTO XFT_LOC                                      03550000
035600             (LOC_NBR                                             03560000
035700             ,REPLT_STR_NBR                                       03570000
035800             ,DIST_NBR                                            03580000
035900             ,LOC_TYP_CDE                                         03590000
036000             ,LOC_NM                                              03600000
036100             ,LOC_5_ABBR_NM                                       03610000
036200             ,LNE_1_ADDR                                          03620000
036300             ,LNE_2_ADDR                                          03630000
036400             ,CTY_NM                                              03640000
036500             ,ST_CDE                                              03650000
036600             ,ZIP_10_CDE                                          03660000
036700             ,OPN_DTE                                             03670000
036800             ,CLO_DTE                                             03680000
036900             ,LOC_10_ABBR_NM                                      03690000
037000             ,FINCL_CLO_DTE                                       03700000
037100             ,E_BUS_IND                                           03710000
037200             ,GRND_OPN_DTE                                        03720000
037300             ,SEA_SLS_INCL_DTE                                    03730000
037400             ,TOT_SLG_SQ_FTG_QTY                                  03740000
037500             ,TOT_SQ_FTG_QTY                                      03750000
037600             )                                                    03760000
037700         VALUES                                                   03770000
037800            (:XFT00017-LOC-NBR                                    03780000
037900            ,:XFT00017-REPLT-STR-NBR                              03790000
038000            ,:XFT00017-DIST-NBR                                   03800000
038100            ,:XFT00017-LOC-TYP-CDE                                03810000
038200            ,:XFT00017-LOC-NM                                     03820000
038300            ,:XFT00017-LOC-5-ABBR-NM                              03830000
038400            ,:XFT00017-LNE-1-ADDR                                 03840000
038500            ,:XFT00017-LNE-2-ADDR                                 03850000
038600            ,:XFT00017-CTY-NM                                     03860000
038700            ,:XFT00017-ST-CDE                                     03870000
038800            ,:XFT00017-ZIP-10-CDE                                 03880000
038900            ,:XFT00017-OPN-DTE                                    03890000
039000            ,:XFT00017-CLO-DTE                                    03900000
039100            ,:XFT00017-LOC-10-ABBR-NM                             03910000
039200            ,:XFT00017-FINCL-CLO-DTE                              03920000
039300            ,:XFT00017-E-BUS-IND                                  03930000
039400            ,:XFT00017-GRND-OPN-DTE                               03940000
039500            ,:XFT00017-SEA-SLS-INCL-DTE                           03950000
039600            ,:XFT00017-TOT-SLG-SQ-FTG-QTY                         03960000
039700            ,:XFT00017-TOT-SQ-FTG-QTY                             03970000
039800            )                                                     03980000
039900      END-EXEC.                                                   03990000
040000                                                                  04000000
040100     EVALUATE TRUE                                                04010000
040200       WHEN SQLCODE = ZERO                                        04020000
040300         ADD 1 TO WS-INSERT-XFT-LOC                               04030000
040400       WHEN SQLCODE NOT = ZERO                                    04040000
040500         DISPLAY 'LOCATION NUMBER: '      XFT00017-LOC-NBR        04050000
040600         MOVE 'I100-INSERT-XFT-LOC '      TO AA-PARAGRAPH-NAME    04060000
040700         MOVE 'INSERT'                    TO AA-DB2-OPERATION     04070000
040800         MOVE 'XFT_LOC '                  TO AA-DB2-TABLE-1       04080000
040900         PERFORM Z999-DB2-ABEND                                   04090000
041000     END-EVALUATE.                                                04100000
041100                                                                  04110000
041200**************************************************************    04120000
041300** THIS ROUTINE INSERTS A ROW INTO THE XFT_LOC_ATTR TABLE         04130000
041400** FOR EACH LOCATION TYPE 'HQ'                                    04140000
041500**************************************************************    04150000
041600 I200-INSERT-XFT-LOC-ATTR.                                        04160000
041700                                                                  04170000
041800      EXEC SQL                                                    04180000
041900         INSERT INTO XFT_LOC_ATTR                                 04190000
042000               (LOC_NBR                                           04200000
042100               ,SETID                                             04210000
042200               ,DEPTID                                            04220000
042300               ,LOCATION                                          04230000
042400               ,KC_ACCT_TYP_CDE                                   04240000
042500               )                                                  04250000
042600         VALUES                                                   04260000
042700               (:XFT00019-LOC-NBR                                 04270000
042800               ,:XFT00019-SETID                                   04280000
042900               ,:XFT00019-DEPTID                                  04290000
043000               ,:XFT00019-LOCATION                                04300000
043100               ,:XFT00019-KC-ACCT-TYP-CDE                         04310000
043200               )                                                  04320000
043300      END-EXEC.                                                   04330000
043400                                                                  04340000
043500     EVALUATE TRUE                                                04350000
043600       WHEN SQLCODE = ZERO                                        04360000
043700         ADD 1 TO WS-INSERT-LOC-ATTR                              04370000
043800       WHEN SQLCODE NOT = ZERO                                    04380000
043900         DISPLAY 'LOCATION NUMBER: '      XFT00019-LOC-NBR        04390000
044000         MOVE 'I200-INSERT-XFT-LOC-ATTR'  TO AA-PARAGRAPH-NAME    04400000
044100         MOVE 'INSERT'                    TO AA-DB2-OPERATION     04410000
044200         MOVE 'XFT_LOC_ATTR'           TO AA-DB2-TABLE-1          04420000
044300         PERFORM Z999-DB2-ABEND                                   04430000
044400     END-EVALUATE.                                                04440000
044500                                                                  04450000
044600**************************************************************    04460000
044700** THIS ROUTINE READS THE OUTLOC FILE                             04470000
044800**************************************************************    04480000
044900 R100-READ-OUTLOC-FILE.                                           04490000
045000                                                                  04500000
045100     READ OUTLOC-FILE INTO HORD007-RECORD                         04510000
045200        AT END                                                    04520000
045300           SET PS-END-OF-OUTLOC-FILE TO TRUE                      04530000
045400        NOT AT END                                                04540000
045500           ADD 1 TO WS-IN-OUTLOC-COUNT                            04550000
045600     END-READ.                                                    04560000
045700                                                                  04570000
045800                                                                  04580000
045900*************************************************************     04590000
046000** END OF PROGRAM PROCESSING                                      04600000
046100*************************************************************     04610000
046200 Z900-END-OF-JOB.                                                 04620000
046300                                                                  04630000
046400     CLOSE OUTLOC-FILE.                                           04640000
046500                                                                  04650000
046600     DISPLAY ' '.                                                 04660000
046700     DISPLAY '******** PROGRAM COUNTERS: ********'.               04670000
046800     DISPLAY 'IN OUTLOC REC:    ' WS-IN-OUTLOC-COUNT              04680000
046900     DISPLAY ' '.                                                 04690000
047000     DISPLAY 'INSERTS XFT LOC :  ' WS-INSERT-XFT-LOC              04700000
047100     DISPLAY 'INSERTS LOC ATTR:  ' WS-INSERT-LOC-ATTR             04710000
047200     DISPLAY ' '.                                                 04720000
047300     DISPLAY 'SKIPPED LOCATIONS: ' WS-SKIPPED-LOCATION            04730000
047400     DISPLAY '****** END PROGRAM ' PC-PGM-NAME ' *******'.        04740000
047500                                                                  04750000
047600*************************************************************     04760000
047700*     DB2 ABEND ROUTINE                                           04770000
047800*************************************************************     04780000
047900 Z999-DB2-ABEND.                                                  04790000
048000                                                                  04800000
048100     DISPLAY AA-ABEND-LIT.                                        04810000
048200     DISPLAY AA-DB2-ERROR-LIT.                                    04820000
048300     DISPLAY AA-PROGRAM-LIT.                                      04830000
048400     DISPLAY AA-PARAGRAPH-LIT.                                    04840000
048500     DISPLAY AA-DB2-OPERATION-LIT.                                04850000
048600     DISPLAY AA-DB2-TABLE-LIT.                                    04860000
048700     SET AC-DB2-ERROR TO TRUE.                                    04870000
048800                                                                  04880000
048900     COPY DPPD004.                                                04890000
049000                                                                  04900000
049100     CALL 'ILBOABN0' USING ABEND-CODE.                            04910000
049200                                                                  04920000
