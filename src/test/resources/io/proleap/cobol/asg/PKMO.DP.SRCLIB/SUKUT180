000100******************************************************************        
000200 IDENTIFICATION DIVISION.                                                 
000300******************************************************************        
000400                                                                          
000500 PROGRAM-ID.    SUKUT180.                                                 
000600 AUTHOR.        DENISE HAHN                                               
000700 INSTALLATION.  KOHLS.                                                    
000800 DATE-WRITTEN   MAY, 2016.                                                
000900 DATE-COMPILED.                                                           
001000                                                                          
001100******************************************************************        
001110*                                                                         
001120*  READS EXTRACT FILE (EXPLAINED BELOW) AND ACCUMULATES QUANTITIES        
001121*  BY DC/STORE/TRIP TO BE USED IN PROGRAM SUKUT?                          
001130*                                                                         
001200*  THIS PROGRAM READS THE EXTRACT FILE CONTAINING THE SHIPPED             
001300*  CARTONS FOR A GIVEN DATE RANGE.  CREATE BY SUKUT176                    
001301*                                                                         
001302*  EXTRACT FILE IS THEN PROCESSED BY SUKUT177 TO GET THE FOLLOWING        
001304*  FOR EACH TRIP - GET THE TRIP CONTENTS                                  
001305*      - SML#'S FROM SUT_OTBND_CART (OTBND_TRIP_ID)                       
001306*      - P2L CARTON - DETERMINE - OPEN/CLOSE TMST                         
001307*        TIMES CONVERTED TO CENTRAL TIME BASED ON PARM                    
001308*        TIMEZN - DIFFERENCE BETWEEN DC AND CENTRAL TIME                  
001309*      - CHECK WHEN THE CARTON WAS ATTACHED TO THE TRAILER                
001310*      - CHECK IF SCANNED ON OR DIVERTED TO THE TRAILER                   
001311*      - CHECK IF CARTON WAS PART OF A MASTER CONTAINER                   
001314*                                                                         
001315*  SUKUT178 WILL GET THE CARTON CONTENTS AND RECEIVER INFORMATION         
001316*                                                                         
001317*  SUKUT180 WILL CALCULATE THE TIMES BETWEEN EACH STATUS                  
001318*                                                                         
001319*  INPUT FILE IS IN SURD117 FORMAT                                        
001320*  OUTPUT FILE IS IN SURD123 FORMAT                                       
001400******************************************************************        
001500                                                                          
001600******************************************************************        
001700 ENVIRONMENT DIVISION.                                                    
001800******************************************************************        
001900                                                                          
002000 CONFIGURATION SECTION.                                                   
002100                                                                          
002200 SOURCE-COMPUTER.        IBM-3090.                                        
002300 OBJECT-COMPUTER.        IBM-3090.                                        
002400                                                                          
002500 INPUT-OUTPUT SECTION.                                                    
002600                                                                          
002700 FILE-CONTROL.                                                            
002800                                                                          
003300     SELECT INPUT-FILE                                                    
003400            ASSIGN TO INP01.                                              
003401                                                                          
003402     SELECT OUTPUT-FILE                                                   
003403            ASSIGN TO OUT01.                                              
003404                                                                          
003408     SELECT COMMA-DELIMITED-FILE                                          
003409            ASSIGN TO OUT02.                                              
003410                                                                          
003411     SELECT ERROR-FILE                                                    
003412            ASSIGN TO OUT03.                                              
003413                                                                          
003420                                                                          
003500******************************************************************        
003600 DATA DIVISION.                                                           
003700******************************************************************        
003800                                                                          
003900 FILE SECTION.                                                            
003910                                                                          
004000 FD  INPUT-FILE                                                           
004100     RECORDING MODE IS F                                                  
004200     LABEL RECORDS ARE STANDARD                                           
004400     BLOCK CONTAINS 0 RECORDS.                                            
004600 01  INPUT-RECORD               PIC X(550).                               
004700                                                                          
004800 FD  OUTPUT-FILE                                                          
004900     RECORDING MODE IS F                                                  
005000     LABEL RECORDS ARE STANDARD                                           
005100     BLOCK CONTAINS 0 RECORDS.                                            
005300 01  OUTPUT-RECORD              PIC X(600).                               
005470                                                                          
005471 FD  COMMA-DELIMITED-FILE                                                 
005472     RECORDING MODE IS F                                                  
005473     LABEL RECORDS ARE STANDARD                                           
005474     BLOCK CONTAINS 0 RECORDS.                                            
005475 01  COMMA-RECORD               PIC X(1150).                              
005476                                                                          
005477 FD  ERROR-FILE                                                           
005478     RECORDING MODE IS F                                                  
005479     LABEL RECORDS ARE STANDARD                                           
005480     BLOCK CONTAINS 0 RECORDS.                                            
005481 01  ERROR-RECORD               PIC X(550).                               
005482                                                                          
005490                                                                          
005600******************************************************************        
005700 WORKING-STORAGE SECTION.                                                 
005800******************************************************************        
005801                                                                          
005830                                                                          
005840 01  DB2-KEYS.                                                            
005841     05  DK-TRIP-ID                         PIC S9(09)  COMP.             
005842     05  DK-SML-SRC                         PIC  X(03).                   
005844                                                                          
005845 01  PROGRAM-VARIABLES.                                                   
005846     05  PV-PARAGRAPH-NAME                  PIC  X(40).                   
005847     05  PV-DB2-OPERATION-ATTEMPTED         PIC  X(40).                   
005848*                                                                         
005849     05  PV-MESSAGE-1                       PIC  X(100).                  
005850     05  PV-MESSAGE-2                       PIC  X(100).                  
005851     05  PV-SQLCODE                         PIC  -999.                    
005852     05  PV-DISP-TRIP-ID                    PIC  Z(09).                   
005853     05  PV-SRC-CART-CNT                    PIC S9(09) COMP.              
005854     05  PV-TRIP-CART-CNT                   PIC S9(09) COMP.              
005860     05  PV-MASTER-CNT                      PIC S9(09) COMP.              
005870     05  PV-TRIP-TOTAL-CARTONS              PIC S9(09) COMP.              
006036*                                                                         
006039     05  PV-PREV-TRIP-ID                    PIC S9(09) COMP.              
006040     05  PV-PREV-CRE-SRC                    PIC  X(03).                   
006041     05  PV-DISP-OPER                       PIC  Z(04).                   
006042     05  PV-DISP-DEST-OPER                  PIC  Z(04).                   
006043     05  PV-DISP-TRIP                       PIC  Z(09).                   
006044     05  PV-DISP-STORE                      PIC  Z(04).                   
006045     05  PV-DISP-SML                        PIC  Z(18).                   
006046     05  PV-PREV-SML-SRC-CDE                PIC  X(03).                   
006047*                                                                         
006048     05  PV-DISPLAY-COUNT                   PIC  ZZZ,ZZZ,ZZZ.             
006049     05  PV-INPUT-COUNTER                   PIC  9(09).                   
006050     05  PV-INPUT-BREAK                     PIC  9(09).                   
006051     05  PV-WRITE-COUNTER                   PIC  9(09).                   
006052     05  PV-ERROR-COUNTER                   PIC  9(09).                   
006053                                                                          
006054*                                                                         
006055* MASTER CONTAINER ACCUMULATORS                                           
006056*                                                                         
006058     05  PV-MST-PRC-TO-P2L-PKD-MIN-TOT      PIC  S9(16) COMP.             
006060     05  PV-MSTR-CRE-TO-OTBND-MIN           PIC  S9(16) COMP.             
006061     05  PV-MSTR-CRE-TO-TCLOS-MIN           PIC  S9(16) COMP.             
006062     05  PV-MSTR-CRE-TO-SHIP-MIN            PIC  S9(16) COMP.             
006063     05  PV-MSTR-FIRST-TO-OTBND-MIN         PIC  S9(16) COMP.             
006064     05  PV-MSTR-FIRST-TO-TCLOS-MIN         PIC  S9(16) COMP.             
006065     05  PV-MSTR-FIRST-TO-SHIP-MIN          PIC  S9(16) COMP.             
006066     05  PV-MSTR-LAST-TO-OTBND-MIN          PIC  S9(16) COMP.             
006067     05  PV-MSTR-LAST-TO-TCLOS-MIN          PIC  S9(16) COMP.             
006068     05  PV-MSTR-LAST-TO-SHIP-MIN           PIC  S9(16) COMP.             
006069     05  PV-MSTR-ARRIVE-TO-MSTR-MIN         PIC  S9(16) COMP.             
006072     05  PV-MSTR-PRC-TO-MSTR-MIN            PIC  S9(16) COMP.             
006073     05  PV-MSTR-ON-OTBND-TO-CLOS-MIN       PIC  S9(16) COMP.             
006074     05  PV-MSTR-ON-OTBND-TO-SHIP-MIN       PIC  S9(16) COMP.             
006076                                                                          
006079     05  PV-MSTR-CRE-TO-OTBND-CNT           PIC  S9(16) COMP.             
006080     05  PV-MSTR-CRE-TO-TCLOS-CNT           PIC  S9(16) COMP.             
006081     05  PV-MSTR-CRE-TO-SHIP-CNT            PIC  S9(16) COMP.             
006082     05  PV-MSTR-FIRST-TO-OTBND-CNT         PIC  S9(16) COMP.             
006083     05  PV-MSTR-FIRST-TO-TCLOS-CNT         PIC  S9(16) COMP.             
006084     05  PV-MSTR-FIRST-TO-SHIP-CNT          PIC  S9(16) COMP.             
006085     05  PV-MSTR-LAST-TO-OTBND-CNT          PIC  S9(16) COMP.             
006086     05  PV-MSTR-LAST-TO-TCLOS-CNT          PIC  S9(16) COMP.             
006087     05  PV-MSTR-LAST-TO-SHIP-CNT           PIC  S9(16) COMP.             
006088     05  PV-MSTR-ARRIVE-TO-MSTR-CNT         PIC  S9(16) COMP.             
006089     05  PV-MSTR-PRC-TO-MSTR-CNT            PIC  S9(16) COMP.             
006090     05  PV-MSTR-ON-OTBND-TO-CLOS-CNT       PIC  S9(16) COMP.             
006091     05  PV-MSTR-ON-OTBND-TO-SHIP-CNT       PIC  S9(16) COMP.             
006092                                                                          
006093     05  PV-TRIP-OPEN-TO-CLOSE-MIN          PIC  S9(16) COMP.             
006094     05  PV-TRIP-CLOSE-TO-SHIP-MIN          PIC  S9(16) COMP.             
006095     05  PV-TRIP-OPEN-TO-SHIP-MIN           PIC  S9(16) COMP.             
006096*                                                                         
006097 01  ABEND-CODE                      PIC S9(04)    VALUE +0               
006098                                                   COMP SYNC.             
006099 01  PROGRAM-SWITCHES.                                                    
006100     05  PS-EOF-INPUT-SW                    PIC X(01) VALUE 'N'.          
006101         88  PS-EOF-INPUT                             VALUE 'Y'.          
006110         88  PS-EOF-INPUT-NO                          VALUE 'N'.          
006200                                                                          
006280*-----------------------------------------------------------------        
006290* INPUT FILE LAYOUT                                                       
006300*-----------------------------------------------------------------        
006400     COPY SURD117.                                                        
006500                                                                          
006600*-----------------------------------------------------------------        
006700* OUTPUT FILE LAYOUT                                                      
006800*-----------------------------------------------------------------        
006900     COPY SURD123.                                                        
007000                                                                          
007100*-----------------------------------------------------------------        
007200* COMMA DELIMITED OUTPUT FILE LAYOUT                                      
007210*-----------------------------------------------------------------        
007220     COPY SURD128.                                                        
007280                                                                          
007305*-----------------------------------------------------------------        
007306* SUT_OTBND_CART - OUTBOUND CARTON                                        
007307*-----------------------------------------------------------------        
007308     EXEC SQL                                                             
007309          INCLUDE SUT00024                                                
007310     END-EXEC.                                                            
007311                                                                          
007312*-----------------------------------------------------------------        
007313* SUT_OTBND_LOC  - OUTBOUND CARTON LOCATION                               
007314*-----------------------------------------------------------------        
007315     EXEC SQL                                                             
007316          INCLUDE SUT00027                                                
007317     END-EXEC.                                                            
007318                                                                          
007319*-----------------------------------------------------------------        
007320* TSUCRDV - CARTON DIVERT                                                 
007321*-----------------------------------------------------------------        
007322     EXEC SQL                                                             
007323          INCLUDE TSUCRDV                                                 
007324     END-EXEC.                                                            
007325                                                                          
007326*-----------------------------------------------------------------        
007327* TSUCDOT - CONVEYOR DIVERT CUTOFF                                        
007328*-----------------------------------------------------------------        
007329     EXEC SQL                                                             
007330          INCLUDE TSUCDOT                                                 
007331     END-EXEC.                                                            
007332                                                                          
007347*-----------------------------------------------------------------        
007348*                                                                         
007349*-----------------------------------------------------------------        
007350     EXEC SQL                                                             
007351          INCLUDE SQLCA                                                   
007352     END-EXEC.                                                            
007353                                                                          
007360                                                                          
007400*-----------------------------------------------------------------        
007500*  DB2 FORMATTED MESSAGE AREA                                             
007510*-----------------------------------------------------------------        
007700     COPY DPWS004.                                                        
007800                                                                          
018300                                                                          
018400                                                                          
018600 PROCEDURE DIVISION.                                                      
018801                                                                          
018810*-----------------------------------------------------------------        
018820*                                                                         
018840*-----------------------------------------------------------------        
018900 0000-PROGRAM-MAINLINE.                                                   
019400                                                                          
019500     PERFORM 1000-INITIALIZE.                                             
019510                                                                          
019520     DISPLAY '********************************************'               
019521             '************'.                                              
019522     PERFORM 4000-CALC-TRIP-COUNTS.                                       
019523*                                                                         
019524     MOVE SU117-OPER-UNT-ID TO  PV-DISP-OPER                              
019525     MOVE SU117-STORE-DEST  TO  PV-DISP-STORE                             
019526     MOVE SU117-TRIP-ID     TO  PV-DISP-TRIP                              
019527     DISPLAY '   OPER:' PV-DISP-OPER                                      
019528             '  STORE:' PV-DISP-STORE                                     
019529             '   TRIP:' PV-DISP-TRIP                                      
019600     IF  PS-EOF-INPUT-NO                                                  
019700         PERFORM 2000-PROCESS-FILE                                        
019800           UNTIL PS-EOF-INPUT                                             
019900     END-IF.                                                              
019908*                                                                         
019909     MOVE PV-PREV-SML-SRC-CDE  TO DK-SML-SRC.                             
019910     PERFORM 4020-GET-SOURCE-CARTONS.                                     
019911     PERFORM 8100-WRITE-OUTPUT-RECORD.                                    
019914     MOVE 1  TO  SU123-TOTAL-TRIPS.                                       
019915     PERFORM 8110-WRITE-MASTER.                                           
019916     PERFORM 3000-INITIALIZE-OUTPUT.                                      
019917     PERFORM 3010-INITIALIZE-MASTER.                                      
019920                                                                          
020000     PERFORM 9000-EOJ-ROUTINE.                                            
020113                                                                          
020131     DISPLAY '********************************************'               
020132             '************'.                                              
020140                                                                          
020200     STOP RUN.                                                            
020300                                                                          
020310                                                                          
020320*-----------------------------------------------------------------        
020330*  DO FIRST TIME PROGRAM INITIALIZATION TASKS.                            
020340*    -- OPEN INPUT FILE                                                   
020341*    -- OPEN OUTPUT FILE                                                  
020350*    -- INITIAL READ OF INPUT                                             
020361*    -- IF EMPTY FILE  - JOB FINISHES - NOTHING TO REPORT                 
020370*-----------------------------------------------------------------        
020400 1000-INITIALIZE.                                                         
021100                                                                          
021500     OPEN INPUT  INPUT-FILE                                               
021510          OUTPUT OUTPUT-FILE                                              
021520          OUTPUT COMMA-DELIMITED-FILE                                     
021530          OUTPUT ERROR-FILE.                                              
021600                                                                          
021700     PERFORM 8000-READ-INPUT-REC.                                         
021710                                                                          
021720     MOVE SU117-TRIP-ID        TO PV-PREV-TRIP-ID.                        
021721     MOVE SU117-SML-SRC-CDE    TO PV-PREV-SML-SRC-CDE.                    
021722     MOVE SU117-OPER-UNT-ID    TO SU123-OPER-UNT-ID.                      
021723     MOVE SU117-STORE-DEST     TO SU123-STORE-DEST.                       
021724     MOVE SU117-TRIP-ID        TO SU123-TRIP-ID.                          
021725     MOVE SU117-SML-SRC-CDE    TO SU123-SML-SRC-CDE.                      
021730     MOVE SU117-TRIP-OPEN-TO-CLOSE-MIN                                    
021731                               TO SU123-TRIP-OPEN-TO-CLOSE-MIN.           
021732     MOVE SU117-TRIP-CLOSE-TO-SHIP-MIN                                    
021733                               TO SU123-TRIP-CLOSE-TO-SHIP-MIN.           
021734     MOVE SU117-TRIP-OPEN-TO-SHIP-MIN                                     
021735                               TO SU123-TRIP-OPEN-TO-SHIP-MIN.            
021740                                                                          
021750     EVALUATE TRUE                                                        
021760         WHEN SU123-SML-SRC-CDE = 'ASN'                                   
021770              SET  SU123-RPT-SEQ-01  TO  TRUE                             
021780         WHEN SU123-SML-SRC-CDE = 'CPS'                                   
021790              SET  SU123-RPT-SEQ-02  TO  TRUE                             
021800         WHEN SU123-SML-SRC-CDE = 'SMO'                                   
021900              SET  SU123-RPT-SEQ-03  TO  TRUE                             
022000         WHEN SU123-SML-SRC-CDE = 'JWL'                                   
022001              SET  SU123-RPT-SEQ-04  TO  TRUE                             
022002         WHEN SU123-SML-SRC-CDE = 'P2L'                                   
022003              SET  SU123-RPT-SEQ-05  TO  TRUE                             
022004         WHEN SU123-SML-SRC-CDE = 'MST'                                   
022005              SET  SU123-RPT-SEQ-06  TO  TRUE                             
022006         WHEN SU123-SML-SRC-CDE = 'RDM'                                   
022007              SET  SU123-RPT-SEQ-07  TO  TRUE                             
022008         WHEN SU123-SML-SRC-CDE = '3WD'                                   
022009              SET  SU123-RPT-SEQ-08  TO  TRUE                             
022010         WHEN OTHER                                                       
022011              SET  SU123-RPT-SEQ-OTHER  TO  TRUE                          
022012     END-EVALUATE.                                                        
022013                                                                          
022014     IF  PS-EOF-INPUT                                                     
022015         MOVE 4095  TO  ABEND-CODE                                        
022016     END-IF.                                                              
022017                                                                          
022020                                                                          
025449*-----------------------------------------------------------------        
025450*  LOOP THROUGH THE RESULTS TABLE.                                        
025451*  FORMAT THE OUTPUT RECORD.  WRITE THE RECORDS THAT MEET CRITERIA.       
025452*-----------------------------------------------------------------        
025460 2000-PROCESS-FILE.                                                       
026000                                                                          
026001     IF  SU117-TRIP-ID  =  PV-PREV-TRIP-ID                                
026002         IF  SU117-SML-SRC-CDE  =  PV-PREV-SML-SRC-CDE                    
026003             PERFORM 2010-ACCUM-TRIP-SRC                                  
026027         ELSE                                                             
026028             MOVE PV-PREV-SML-SRC-CDE  TO DK-SML-SRC                      
026029             PERFORM 4020-GET-SOURCE-CARTONS                              
026032             PERFORM 8100-WRITE-OUTPUT-RECORD                             
026033             PERFORM 3000-INITIALIZE-OUTPUT                               
026034             MOVE SU117-TRIP-ID        TO PV-PREV-TRIP-ID                 
026035             MOVE SU117-SML-SRC-CDE    TO PV-PREV-SML-SRC-CDE             
026036             MOVE SU117-OPER-UNT-ID    TO SU123-OPER-UNT-ID               
026037             MOVE SU117-STORE-DEST     TO SU123-STORE-DEST                
026038             MOVE SU117-TRIP-ID        TO SU123-TRIP-ID                   
026039             MOVE SU117-SML-SRC-CDE    TO SU123-SML-SRC-CDE               
026047                                                                          
026048             EVALUATE TRUE                                                
026049                 WHEN SU123-SML-SRC-CDE = 'ASN'                           
026050                      SET  SU123-RPT-SEQ-01  TO  TRUE                     
026051                 WHEN SU123-SML-SRC-CDE = 'CPS'                           
026052                      SET  SU123-RPT-SEQ-02  TO  TRUE                     
026053                 WHEN SU123-SML-SRC-CDE = 'SMO'                           
026054                      SET  SU123-RPT-SEQ-03  TO  TRUE                     
026055                 WHEN SU123-SML-SRC-CDE = 'JWL'                           
026056                      SET  SU123-RPT-SEQ-04  TO  TRUE                     
026057                 WHEN SU123-SML-SRC-CDE = 'P2L'                           
026058                      SET  SU123-RPT-SEQ-05  TO  TRUE                     
026059                 WHEN SU123-SML-SRC-CDE = 'MST'                           
026060                      SET  SU123-RPT-SEQ-06  TO  TRUE                     
026061                 WHEN SU123-SML-SRC-CDE = 'RDM'                           
026062                      SET  SU123-RPT-SEQ-07  TO  TRUE                     
026063                 WHEN SU123-SML-SRC-CDE = '3WD'                           
026064                      SET  SU123-RPT-SEQ-08  TO  TRUE                     
026065                 WHEN OTHER                                               
026066                      SET  SU123-RPT-SEQ-OTHER  TO  TRUE                  
026067             END-EVALUATE                                                 
026068                                                                          
026069             MOVE SU117-TRIP-OPEN-TO-CLOSE-MIN                            
026070                               TO SU123-TRIP-OPEN-TO-CLOSE-MIN            
026071                                  PV-TRIP-OPEN-TO-CLOSE-MIN               
026072             MOVE SU117-TRIP-CLOSE-TO-SHIP-MIN                            
026073                               TO SU123-TRIP-CLOSE-TO-SHIP-MIN            
026074                                  PV-TRIP-CLOSE-TO-SHIP-MIN               
026075             MOVE SU117-TRIP-OPEN-TO-SHIP-MIN                             
026076                               TO SU123-TRIP-OPEN-TO-SHIP-MIN             
026077                                  PV-TRIP-OPEN-TO-SHIP-MIN                
026078             PERFORM 2010-ACCUM-TRIP-SRC                                  
026079     ELSE                                                                 
026080         MOVE PV-PREV-SML-SRC-CDE  TO DK-SML-SRC                          
026081         PERFORM 4020-GET-SOURCE-CARTONS                                  
026082         PERFORM 8100-WRITE-OUTPUT-RECORD                                 
026083         MOVE 1  TO  SU123-TOTAL-TRIPS                                    
026084         PERFORM 8110-WRITE-MASTER                                        
026085         PERFORM 3000-INITIALIZE-OUTPUT                                   
026086         PERFORM 3010-INITIALIZE-MASTER                                   
026087         MOVE SU117-TRIP-ID        TO PV-PREV-TRIP-ID                     
026088         MOVE SU117-SML-SRC-CDE    TO PV-PREV-SML-SRC-CDE                 
026089         MOVE SU117-OPER-UNT-ID    TO SU123-OPER-UNT-ID                   
026090         MOVE SU117-STORE-DEST     TO SU123-STORE-DEST                    
026091         MOVE SU117-TRIP-ID        TO SU123-TRIP-ID                       
026092         MOVE SU117-SML-SRC-CDE    TO SU123-SML-SRC-CDE                   
026093*                                                                         
026094         MOVE SU117-OPER-UNT-ID TO  PV-DISP-OPER                          
026095         MOVE SU117-STORE-DEST  TO  PV-DISP-STORE                         
026096         MOVE SU117-TRIP-ID     TO  PV-DISP-TRIP                          
026097         DISPLAY '   OPER:' PV-DISP-OPER                                  
026098                 '  STORE:' PV-DISP-STORE                                 
026099                 '   TRIP:' PV-DISP-TRIP                                  
026100*                                                                         
026101         PERFORM 4000-CALC-TRIP-COUNTS                                    
026102                                                                          
026103         EVALUATE TRUE                                                    
026104             WHEN SU123-SML-SRC-CDE = 'ASN'                               
026105                  SET  SU123-RPT-SEQ-01  TO  TRUE                         
026106             WHEN SU123-SML-SRC-CDE = 'CPS'                               
026107                  SET  SU123-RPT-SEQ-02  TO  TRUE                         
026108             WHEN SU123-SML-SRC-CDE = 'SMO'                               
026109                  SET  SU123-RPT-SEQ-03  TO  TRUE                         
026110             WHEN SU123-SML-SRC-CDE = 'JWL'                               
026111                  SET  SU123-RPT-SEQ-04  TO  TRUE                         
026112             WHEN SU123-SML-SRC-CDE = 'P2L'                               
026113                  SET  SU123-RPT-SEQ-05  TO  TRUE                         
026114             WHEN SU123-SML-SRC-CDE = 'MST'                               
026115                  SET  SU123-RPT-SEQ-06  TO  TRUE                         
026116             WHEN SU123-SML-SRC-CDE = 'RDM'                               
026117                  SET  SU123-RPT-SEQ-07  TO  TRUE                         
026118             WHEN SU123-SML-SRC-CDE = '3WD'                               
026119                  SET  SU123-RPT-SEQ-08  TO  TRUE                         
026120             WHEN OTHER                                                   
026121                  SET  SU123-RPT-SEQ-OTHER  TO  TRUE                      
026122         END-EVALUATE                                                     
026123                                                                          
026124         MOVE SU117-TRIP-OPEN-TO-CLOSE-MIN                                
026125                               TO SU123-TRIP-OPEN-TO-CLOSE-MIN            
026126         MOVE SU117-TRIP-CLOSE-TO-SHIP-MIN                                
026127                               TO SU123-TRIP-CLOSE-TO-SHIP-MIN            
026128         MOVE SU117-TRIP-OPEN-TO-SHIP-MIN                                 
026129                               TO SU123-TRIP-OPEN-TO-SHIP-MIN             
026130         PERFORM 2010-ACCUM-TRIP-SRC                                      
026131     END-IF.                                                              
026132                                                                          
026140     PERFORM 8000-READ-INPUT-REC.                                         
026200                                                                          
026565                                                                          
026566*-----------------------------------------------------------------        
026567*  ACCUMULATE MINUTES FOR TRIP - BY CARTON SOURCE                         
026568*-----------------------------------------------------------------        
026569 2010-ACCUM-TRIP-SRC.                                                     
026570                                                                          
026571     ADD  1  TO SU123-INPUT-RECORD-COUNT.                                 
026572*                                                                         
026575     IF  SU117-ARRIVE-TO-PRC-MIN NOT = ZERO                               
026576         ADD SU117-ARRIVE-TO-PRC-MIN                                      
026599                             TO SU123-ARRIVE-TO-PRC-MIN                   
026600         ADD 1               TO SU123-ARRIVE-TO-PRC-CNT                   
026601     END-IF.                                                              
026602                                                                          
026603     IF  SU117-ARRIVE-TO-P2L-PKD-MIN NOT = ZERO                           
026604         ADD SU117-ARRIVE-TO-P2L-PKD-MIN                                  
026605                             TO SU123-ARRIVE-TO-P2L-PKD-MIN               
026606         ADD 1               TO SU123-ARRIVE-TO-P2L-PKD-CNT               
026607     END-IF.                                                              
026608                                                                          
026609     IF  SU117-PRC-TO-P2L-PKD-MIN NOT = ZERO                              
026610         ADD SU117-PRC-TO-P2L-PKD-MIN                                     
026611                             TO SU123-PRC-TO-P2L-PKD-MIN                  
026612         ADD 1               TO SU123-PRC-TO-P2L-PKD-CNT                  
026613     END-IF.                                                              
026614                                                                          
026615     IF  SU117-P2L-PKD-TO-CLOSE-MIN NOT = ZERO                            
026616         ADD SU117-P2L-PKD-TO-CLOSE-MIN                                   
026617                             TO SU123-P2L-PKD-TO-CLOSE-MIN                
026618         ADD 1               TO SU123-P2L-PKD-TO-CLOSE-CNT                
026619     END-IF.                                                              
026620                                                                          
026621     IF  SU117-P2L-OPEN-TO-CLOSE-MIN NOT = ZERO                           
026622         ADD SU117-P2L-OPEN-TO-CLOSE-MIN                                  
026623                             TO SU123-P2L-OPEN-TO-CLOSE-MIN               
026624         ADD  1              TO SU123-P2L-OPEN-TO-CLOSE-CNT               
026625     END-IF.                                                              
026626                                                                          
026627     IF  SU117-P2L-OPEN-TO-OTBND-MIN NOT = ZERO                           
026628         ADD SU117-P2L-OPEN-TO-OTBND-MIN                                  
026629                             TO SU123-P2L-OPEN-TO-OTBND-MIN               
026630         ADD  1              TO SU123-P2L-OPEN-TO-OTBND-CNT               
026631     END-IF.                                                              
026632                                                                          
026633* P2L CARTON DIVERTED BEFORE IT WAS SYSTEMICALLY CLOSED                   
026634                                                                          
026635     IF  SU117-P2L-CLOSE-TO-OTBND-MIN NOT = ZERO                          
026636                                                                          
026637         IF  SU117-P2L-CLOSE-TO-OTBND-MIN  <  ZERO                        
026638               PERFORM 8120-WRITE-P2L-CLOSE-AFT-DVRT                      
026640               MOVE ZERO  TO SU117-P2L-CLOSE-TO-OTBND-MIN                 
026641               ADD  1     TO SU123-P2L-CLOSE-TO-OTBND-CNT                 
026642               MOVE 1     TO SU123-P2L-CLOSE-TO-OTBND-MIN                 
026643         END-IF                                                           
026644                                                                          
026645         ADD SU117-P2L-CLOSE-TO-OTBND-MIN                                 
026646                             TO SU123-P2L-CLOSE-TO-OTBND-MIN              
026647         ADD  1              TO SU123-P2L-CLOSE-TO-OTBND-CNT              
026648     END-IF.                                                              
026649                                                                          
026650     IF  SU117-ARRIVE-TO-OTBND-MIN NOT = ZERO                             
026651         ADD SU117-ARRIVE-TO-OTBND-MIN                                    
026652                             TO SU123-ARRIVE-TO-OTBND-MIN                 
026653         ADD 1               TO SU123-ARRIVE-TO-OTBND-CNT                 
026654     END-IF.                                                              
026655                                                                          
026656     IF  SU117-PRC-TO-OTBND-MIN NOT = ZERO                                
026657         ADD SU117-PRC-TO-OTBND-MIN                                       
026658                             TO SU123-PRC-TO-OTBND-MIN                    
026659         ADD 1               TO SU123-PRC-TO-OTBND-CNT                    
026660     END-IF.                                                              
026661                                                                          
026662     IF  SU117-ARRIVE-TO-TCLOS-MIN NOT = ZERO                             
026663         ADD SU117-ARRIVE-TO-TCLOS-MIN                                    
026664                             TO SU123-ARRIVE-TO-TCLOS-MIN                 
026665         ADD 1               TO SU123-ARRIVE-TO-TCLOS-CNT                 
026666     END-IF.                                                              
026667                                                                          
026668     IF  SU117-ARRIVE-TO-SHIP-MIN NOT = ZERO                              
026669         ADD SU117-ARRIVE-TO-SHIP-MIN                                     
026670                             TO SU123-ARRIVE-TO-SHIP-MIN                  
026671         ADD 1               TO SU123-ARRIVE-TO-SHIP-CNT                  
026672     END-IF.                                                              
026673                                                                          
026674     IF  SU117-P2L-OPEN-TO-TCLOS-MIN NOT = ZERO                           
026675         ADD SU117-P2L-OPEN-TO-TCLOS-MIN                                  
026676                             TO SU123-P2L-OPEN-TO-TCLOS-MIN               
026677         ADD 1               TO SU123-P2L-OPEN-TO-TCLOS-CNT               
026678     END-IF.                                                              
026679                                                                          
026680     IF  SU117-P2L-OPEN-TO-SHIP-MIN NOT = ZERO                            
026681         ADD SU117-P2L-OPEN-TO-SHIP-MIN                                   
026682                             TO SU123-P2L-OPEN-TO-SHIP-MIN                
026683         ADD 1               TO SU123-P2L-OPEN-TO-SHIP-CNT                
026684     END-IF.                                                              
026685                                                                          
026686     IF  SU117-P2L-CLOSE-TO-TCLOS-MIN NOT = ZERO                          
026687         ADD SU117-P2L-CLOSE-TO-TCLOS-MIN                                 
026688                             TO SU123-P2L-CLOSE-TO-TCLOS-MIN              
026689         ADD 1               TO SU123-P2L-CLOSE-TO-TCLOS-CNT              
026690     END-IF.                                                              
026691                                                                          
026692     IF  SU117-P2L-CLOSE-TO-SHIP-MIN NOT = ZERO                           
026693         ADD SU117-P2L-CLOSE-TO-SHIP-MIN                                  
026694                             TO SU123-P2L-CLOSE-TO-SHIP-MIN               
026695         ADD 1               TO SU123-P2L-CLOSE-TO-SHIP-CNT               
026696     END-IF.                                                              
026700                                                                          
026704     IF  SU117-ARRIVE-TO-MSTR-MIN NOT = ZERO                              
026705         ADD SU117-ARRIVE-TO-MSTR-MIN                                     
026706                             TO SU123-ARRIVE-TO-MSTR-MIN                  
026707         ADD 1               TO SU123-ARRIVE-TO-MSTR-CNT                  
026708* REPORT MASTER #7                                                        
026709         ADD SU117-ARRIVE-TO-MSTR-MIN                                     
026710                             TO PV-MSTR-ARRIVE-TO-MSTR-MIN                
026711         ADD 1               TO PV-MSTR-ARRIVE-TO-MSTR-CNT                
026713     END-IF.                                                              
026714                                                                          
026715     IF  SU117-PRC-TO-MSTR-MIN NOT = ZERO                                 
026716         ADD SU117-PRC-TO-MSTR-MIN                                        
026717                             TO SU123-PRC-TO-MSTR-MIN                     
026718         ADD 1               TO SU123-PRC-TO-MSTR-CNT                     
026719* REPORT MASTER #6                                                        
026720         ADD SU117-PRC-TO-MSTR-MIN                                        
026721                             TO PV-MSTR-PRC-TO-MSTR-MIN                   
026722         ADD 1               TO PV-MSTR-PRC-TO-MSTR-CNT                   
026724     END-IF.                                                              
026725                                                                          
026726     IF  SU117-MSTR-CRE-TO-OTBND-MIN NOT = ZERO                           
026727         ADD SU117-MSTR-CRE-TO-OTBND-MIN                                  
026728                             TO SU123-MSTR-CRE-TO-OTBND-MIN               
026729         ADD 1               TO SU123-MSTR-CRE-TO-OTBND-CNT               
026730* REPORT MASTER #9                                                        
026731         ADD SU117-MSTR-CRE-TO-OTBND-MIN                                  
026732                             TO PV-MSTR-CRE-TO-OTBND-MIN                  
026733         ADD 1               TO PV-MSTR-CRE-TO-OTBND-CNT                  
026735     END-IF.                                                              
026736                                                                          
026737     IF  SU117-MSTR-CRE-TO-TCLOS-MIN NOT = ZERO                           
026738         ADD SU117-MSTR-CRE-TO-TCLOS-MIN                                  
026739                             TO SU123-MSTR-CRE-TO-TCLOS-MIN               
026740         ADD 1               TO SU123-MSTR-CRE-TO-TCLOS-CNT               
026741* REPORT MASTER #15                                                       
026742         ADD SU117-MSTR-CRE-TO-TCLOS-MIN                                  
026743                             TO PV-MSTR-CRE-TO-TCLOS-MIN                  
026744         ADD 1               TO PV-MSTR-CRE-TO-TCLOS-CNT                  
026746     END-IF.                                                              
026747                                                                          
026748     IF  SU117-MSTR-CRE-TO-SHIP-MIN NOT = ZERO                            
026749         ADD SU117-MSTR-CRE-TO-SHIP-MIN                                   
026750                             TO SU123-MSTR-CRE-TO-SHIP-MIN                
026751         ADD 1               TO SU123-MSTR-CRE-TO-SHIP-CNT                
026752* REPORT MASTER #16                                                       
026753         ADD SU117-MSTR-CRE-TO-SHIP-MIN                                   
026754                             TO PV-MSTR-CRE-TO-SHIP-MIN                   
026755         ADD 1               TO PV-MSTR-CRE-TO-SHIP-CNT                   
026757     END-IF.                                                              
026758                                                                          
026759     IF  SU117-MSTR-FIRST-TO-OTBND-MIN NOT = ZERO                         
026760         ADD SU117-MSTR-FIRST-TO-OTBND-MIN                                
026761                             TO SU123-MSTR-FIRST-TO-OTBND-MIN             
026762         ADD 1               TO SU123-MSTR-FIRST-TO-OTBND-CNT             
026763* REPORT MASTER #8                                                        
026764         ADD SU117-MSTR-FIRST-TO-OTBND-MIN                                
026765                             TO PV-MSTR-FIRST-TO-OTBND-MIN                
026766         ADD 1               TO PV-MSTR-FIRST-TO-OTBND-CNT                
026768     END-IF.                                                              
026769                                                                          
026770     IF  SU117-MSTR-FIRST-TO-TCLOS-MIN NOT = ZERO                         
026771         ADD SU117-MSTR-FIRST-TO-TCLOS-MIN                                
026772                             TO SU123-MSTR-FIRST-TO-TCLOS-MIN             
026773         ADD 1               TO SU123-MSTR-FIRST-TO-TCLOS-CNT             
026774         ADD SU117-MSTR-FIRST-TO-TCLOS-MIN                                
026775                             TO PV-MSTR-FIRST-TO-TCLOS-MIN                
026776         ADD 1               TO PV-MSTR-FIRST-TO-TCLOS-CNT                
026779     END-IF.                                                              
026780                                                                          
026781     IF  SU117-MSTR-FIRST-TO-SHIP-MIN NOT = ZERO                          
026782         ADD SU117-MSTR-FIRST-TO-SHIP-MIN                                 
026783                             TO SU123-MSTR-FIRST-TO-SHIP-MIN              
026784         ADD 1               TO SU123-MSTR-FIRST-TO-SHIP-CNT              
026785         ADD SU117-MSTR-FIRST-TO-SHIP-MIN                                 
026786                             TO PV-MSTR-FIRST-TO-SHIP-MIN                 
026787         ADD 1               TO PV-MSTR-FIRST-TO-SHIP-CNT                 
026790     END-IF.                                                              
026791                                                                          
026792     IF  SU117-MSTR-LAST-TO-OTBND-MIN NOT = ZERO                          
026793         ADD SU117-MSTR-LAST-TO-OTBND-MIN                                 
026794                             TO SU123-MSTR-LAST-TO-OTBND-MIN              
026795         ADD 1               TO SU123-MSTR-LAST-TO-OTBND-CNT              
026796         ADD SU117-MSTR-LAST-TO-OTBND-MIN                                 
026797                             TO PV-MSTR-LAST-TO-OTBND-MIN                 
026798         ADD 1               TO PV-MSTR-LAST-TO-OTBND-CNT                 
026801     END-IF.                                                              
026802                                                                          
026803     IF  SU117-MSTR-LAST-TO-TCLOS-MIN NOT = ZERO                          
026804         ADD SU117-MSTR-LAST-TO-TCLOS-MIN                                 
026805                             TO SU123-MSTR-LAST-TO-TCLOS-MIN              
026806         ADD 1               TO SU123-MSTR-LAST-TO-TCLOS-CNT              
026807         ADD SU117-MSTR-LAST-TO-TCLOS-MIN                                 
026808                             TO PV-MSTR-LAST-TO-TCLOS-MIN                 
026809         ADD 1               TO PV-MSTR-LAST-TO-TCLOS-CNT                 
026812                                                                          
026813     END-IF.                                                              
026814                                                                          
026815     IF  SU117-MSTR-LAST-TO-SHIP-MIN NOT = ZERO                           
026816         ADD SU117-MSTR-LAST-TO-SHIP-MIN                                  
026817                             TO SU123-MSTR-LAST-TO-SHIP-MIN               
026818         ADD 1               TO SU123-MSTR-LAST-TO-SHIP-CNT               
026819         ADD SU117-MSTR-LAST-TO-SHIP-MIN                                  
026820                             TO PV-MSTR-LAST-TO-SHIP-MIN                  
026821         ADD 1               TO PV-MSTR-LAST-TO-SHIP-CNT                  
026824     END-IF.                                                              
026825                                                                          
026827         ADD SU117-ON-OTBND-TO-CLOS-MIN                                   
026828                             TO SU123-ON-OTBND-TO-CLOS-MIN                
026829         ADD 1               TO SU123-ON-OTBND-TO-CLOS-CNT.               
026830         IF  SU117-MSTR-SML-NBR  >  0                                     
026831             ADD SU117-ON-OTBND-TO-CLOS-MIN                               
026832                             TO PV-MSTR-ON-OTBND-TO-CLOS-MIN              
026833             ADD 1           TO PV-MSTR-ON-OTBND-TO-CLOS-CNT              
026834         END-IF.                                                          
026836                                                                          
026838         ADD SU117-ON-OTBND-TO-SHIP-MIN                                   
026839                             TO SU123-ON-OTBND-TO-SHIP-MIN                
026840         ADD 1               TO SU123-ON-OTBND-TO-SHIP-CNT.               
026841         IF  SU117-MSTR-SML-NBR  >  0                                     
026842             ADD SU117-ON-OTBND-TO-SHIP-MIN                               
026843                             TO PV-MSTR-ON-OTBND-TO-SHIP-MIN              
026844             ADD 1           TO PV-MSTR-ON-OTBND-TO-SHIP-CNT              
026845         END-IF.                                                          
026847                                                                          
026848                                                                          
026849*-----------------------------------------------------------------        
026850*                                                                         
026851*-----------------------------------------------------------------        
026852 3000-INITIALIZE-OUTPUT.                                                  
026853                                                                          
026854     MOVE  SPACES  TO  SU123-SML-SRC-CDE.                                 
026855                                                                          
026856     MOVE  ZEROES  TO  SU123-OPER-UNT-ID                                  
026857                       SU123-STORE-DEST                                   
026858                        SU123-TRIP-ID                                     
026859                        SU123-TRIP-OPEN-TO-CLOSE-MIN                      
026860                        SU123-TRIP-CLOSE-TO-SHIP-MIN                      
026861                        SU123-TRIP-OPEN-TO-SHIP-MIN                       
026862                        SU123-INPUT-RECORD-COUNT                          
026863                        SU123-ARRIVE-TO-PRC-MIN                           
026864                        SU123-ARRIVE-TO-P2L-PKD-MIN                       
026865                        SU123-PRC-TO-P2L-PKD-MIN                          
026866                        SU123-P2L-PKD-TO-CLOSE-MIN                        
026867                        SU123-P2L-OPEN-TO-CLOSE-MIN                       
026868                        SU123-P2L-OPEN-TO-OTBND-MIN                       
026869                        SU123-P2L-CLOSE-TO-OTBND-MIN                      
026870                        SU123-ARRIVE-TO-OTBND-MIN                         
026871                        SU123-PRC-TO-OTBND-MIN                            
026872                        SU123-ARRIVE-TO-TCLOS-MIN                         
026873                        SU123-ARRIVE-TO-SHIP-MIN                          
026874                        SU123-P2L-OPEN-TO-TCLOS-MIN                       
026875                        SU123-P2L-OPEN-TO-SHIP-MIN                        
026876                        SU123-P2L-CLOSE-TO-TCLOS-MIN                      
026877                        SU123-P2L-CLOSE-TO-SHIP-MIN                       
026878                        SU123-ARRIVE-TO-MSTR-MIN                          
026879                        SU123-PRC-TO-MSTR-MIN                             
026880                        SU123-MSTR-CRE-TO-OTBND-MIN                       
026881                        SU123-MSTR-CRE-TO-TCLOS-MIN                       
026882                        SU123-MSTR-CRE-TO-SHIP-MIN                        
026883                        SU123-MSTR-FIRST-TO-OTBND-MIN                     
026884                        SU123-MSTR-FIRST-TO-TCLOS-MIN                     
026885                        SU123-MSTR-FIRST-TO-SHIP-MIN                      
026886                        SU123-MSTR-LAST-TO-OTBND-MIN                      
026887                        SU123-MSTR-LAST-TO-TCLOS-MIN                      
026888                        SU123-MSTR-LAST-TO-SHIP-MIN                       
026889                        SU123-ON-OTBND-TO-CLOS-MIN                        
026890                        SU123-ON-OTBND-TO-SHIP-MIN                        
026891                        SU123-ARRIVE-TO-PRC-CNT                           
026892                        SU123-ARRIVE-TO-P2L-PKD-CNT                       
026893                        SU123-PRC-TO-P2L-PKD-CNT                          
026894                        SU123-P2L-PKD-TO-CLOSE-CNT                        
026895                        SU123-P2L-OPEN-TO-OTBND-CNT                       
026896                        SU123-P2L-OPEN-TO-CLOSE-CNT                       
026897                        SU123-P2L-CLOSE-TO-OTBND-CNT                      
026898                        SU123-ARRIVE-TO-OTBND-CNT                         
026899                        SU123-PRC-TO-OTBND-CNT                            
026900                        SU123-ARRIVE-TO-TCLOS-CNT                         
026901                        SU123-ARRIVE-TO-SHIP-CNT                          
026902                        SU123-P2L-OPEN-TO-TCLOS-CNT                       
026903                        SU123-P2L-OPEN-TO-SHIP-CNT                        
026904                        SU123-P2L-CLOSE-TO-TCLOS-CNT                      
026905                        SU123-P2L-CLOSE-TO-SHIP-CNT                       
026906                        SU123-ARRIVE-TO-MSTR-CNT                          
026907                        SU123-PRC-TO-MSTR-CNT                             
026908                        SU123-MSTR-CRE-TO-OTBND-CNT                       
026909                        SU123-MSTR-CRE-TO-TCLOS-CNT                       
026910                        SU123-MSTR-CRE-TO-SHIP-CNT                        
026911                        SU123-MSTR-FIRST-TO-OTBND-CNT                     
026912                        SU123-MSTR-FIRST-TO-TCLOS-CNT                     
026913                        SU123-MSTR-FIRST-TO-SHIP-CNT                      
026914                        SU123-MSTR-LAST-TO-OTBND-CNT                      
026915                        SU123-MSTR-LAST-TO-TCLOS-CNT                      
026916                        SU123-MSTR-LAST-TO-SHIP-CNT                       
026920                        SU123-ON-OTBND-TO-CLOS-CNT                        
026930                        SU123-ON-OTBND-TO-SHIP-CNT.                       
026950                                                                          
026951                                                                          
026960*-----------------------------------------------------------------        
026970*                                                                         
026980*-----------------------------------------------------------------        
026990 3010-INITIALIZE-MASTER.                                                  
026991                                                                          
026995     MOVE  ZEROES  TO  PV-MSTR-ARRIVE-TO-MSTR-MIN                         
026996                       PV-MSTR-PRC-TO-MSTR-MIN                            
026997                       PV-MSTR-CRE-TO-OTBND-MIN                           
026998                       PV-MSTR-CRE-TO-TCLOS-MIN                           
026999                       PV-MSTR-CRE-TO-SHIP-MIN                            
027000                       PV-MSTR-FIRST-TO-OTBND-MIN                         
027010                       PV-MSTR-FIRST-TO-TCLOS-MIN                         
027020                       PV-MSTR-FIRST-TO-SHIP-MIN                          
027030                       PV-MSTR-LAST-TO-OTBND-MIN                          
027040                       PV-MSTR-LAST-TO-TCLOS-MIN                          
027050                       PV-MSTR-LAST-TO-SHIP-MIN                           
027071                       PV-MSTR-ON-OTBND-TO-CLOS-MIN                       
027072                       PV-MSTR-ON-OTBND-TO-SHIP-MIN                       
027073                       PV-MSTR-ARRIVE-TO-MSTR-CNT                         
027080                       PV-MSTR-PRC-TO-MSTR-CNT                            
027090                       PV-MSTR-CRE-TO-OTBND-CNT                           
027091                       PV-MSTR-CRE-TO-TCLOS-CNT                           
027092                       PV-MSTR-CRE-TO-SHIP-CNT                            
027122                       PV-MSTR-FIRST-TO-OTBND-CNT                         
027123                       PV-MSTR-FIRST-TO-TCLOS-CNT                         
027124                       PV-MSTR-FIRST-TO-SHIP-CNT                          
027125                       PV-MSTR-LAST-TO-OTBND-CNT                          
027126                       PV-MSTR-LAST-TO-TCLOS-CNT                          
027130                       PV-MSTR-LAST-TO-SHIP-CNT                           
027140                       PV-MSTR-ON-OTBND-TO-CLOS-CNT                       
027150                       PV-MSTR-ON-OTBND-TO-SHIP-CNT.                      
027200                                                                          
027210                                                                          
027220*-----------------------------------------------------------------        
027230*  CALCULATE:                                                             
027231*          - NUMBER OF CARTONS ON THE TRIP                                
027232*          - NUMBER OF CARTONS ON THE TRIP - PER SOURCE                   
027233* DMH 8/18/16                                                             
027240*-----------------------------------------------------------------        
027300 4000-CALC-TRIP-COUNTS.                                                   
027301     MOVE  PV-PREV-TRIP-ID       TO  DK-TRIP-ID                           
027310     MOVE  PV-PREV-SML-SRC-CDE   TO  DK-SML-SRC                           
027400                                                                          
027410     PERFORM 4010-GET-TRIP-CARTONS.                                       
027411     PERFORM 4030-COUNT-MASTER.                                           
027420     PERFORM 4020-GET-SOURCE-CARTONS.                                     
027421                                                                          
027422     ADD  PV-TRIP-CART-CNT                                                
027423      TO  PV-MASTER-CNT                                                   
027424     GIVING PV-TRIP-TOTAL-CARTONS                                         
027425     MOVE PV-TRIP-TOTAL-CARTONS  TO  SU123-TRIP-CARTONS.                  
027426                                                                          
027429     MOVE ZEROES                 TO  SU123-TOTAL-TRIPS.                   
027430                                                                          
027431                                                                          
027432                                                                          
027433*-----------------------------------------------------------------        
027434*                                                                         
027435* DMH 8/18/16                                                             
027436*-----------------------------------------------------------------        
027437 4010-GET-TRIP-CARTONS.                                                   
027438                                                                          
027439     EXEC SQL                                                             
027441         SELECT COUNT(DISTINCT(T1.SML))                                   
027442           INTO :PV-TRIP-CART-CNT                                         
027444           FROM                                                           
027445               (                                                          
027446                SELECT DISTINCT(G.SHIPT_UNT_ID) AS SML                    
027447                 FROM SUT_OTBND_LOC E                                     
027448                    , SUT_OTBND_CART G                                    
027449                WHERE E.OTBND_TRIP_ID      = :DK-TRIP-ID                  
027450                  AND E.SCN_CDE            = 'SHON'                       
027451                  AND E.ACTV_CDE           = 'A'                          
027452                  AND E.SHIPT_UNT_ID       = G.SHIPT_UNT_ID               
027453                  AND NOT G.CART_SRC_CDE   = 'XFR'                        
027454                  AND G.ACTV_IND           = 'Y'                          
027455                                                                          
027456                UNION                                                     
027457                                                                          
027458               SELECT DISTINCT(AA.SHIPT_UNT_ID) AS SML                    
027459                 FROM SUT_OTBND_CART AA                                   
027460                    , TSUCRDV CC                                          
027461                    , TSUCDOT DD                                          
027462                WHERE DD.OTBND_TRIP_ID     = :DK-TRIP-ID                  
027463                  AND DD.OPER_UNT_ID       =  CC.OPER_UNT_ID              
027464                  AND DD.DOOR_ID           =  CC.DOOR_ID                  
027465                  AND DD.STRT_DIVERT_TMST <=  CC.DIVERT_TMST              
027466                  AND DD.END_DIVERT_TMST  >=  CC.DIVERT_TMST              
027467                  AND CC.ACTV_CDE          = 'A'                          
027468                  AND CC.SHIPT_UNT_ID      =  AA.SHIPT_UNT_ID             
027469                  AND NOT AA.CART_SRC_CDE  = 'XFR'                        
027470                  AND AA.ACTV_IND          = 'Y'                          
027480               )  AS T1                                                   
027489           WITH UR                                                        
027490                                                                          
027491     END-EXEC.                                                            
027492                                                                          
027493     EVALUATE TRUE                                                        
027494         WHEN SQLCODE = ZERO                                              
027495              CONTINUE                                                    
027496         WHEN SQLCODE = +100                                              
027497              MOVE  ZEROES  TO  PV-TRIP-CART-CNT                          
027498              MOVE SQLCODE              TO PV-SQLCODE                     
027499              MOVE DK-TRIP-ID           TO PV-DISP-TRIP-ID                
027500*                                                                         
027501              STRING '4010-'                                              
027502                     ' SQL:'   PV-SQLCODE                                 
027503                     ' TRIP:'  PV-DISP-TRIP-ID                            
027504                               DELIMITED BY SIZE                          
027505                          INTO PV-MESSAGE-1                               
027506                                                                          
027507             DISPLAY PV-MESSAGE-1                                         
027508                                                                          
027509                                                                          
027510         WHEN SQLWARN0 NOT = SPACES                                       
027511         WHEN SQLCODE < ZERO                                              
027512         WHEN SQLCODE > ZERO                                              
027513              MOVE SQLCODE              TO PV-SQLCODE                     
027514              MOVE DK-TRIP-ID           TO PV-DISP-TRIP-ID                
027515*                                                                         
027516              STRING '4010-'                                              
027517                     ' SQL:'   PV-SQLCODE                                 
027518                     ' TRIP:'  PV-DISP-TRIP-ID                            
027519                               DELIMITED BY SIZE                          
027520                          INTO PV-MESSAGE-1                               
027521                                                                          
027522             DISPLAY PV-MESSAGE-1                                         
027523                                                                          
027524             MOVE '4010-GET-TRIP-CARTONS      '                           
027525                                 TO PV-PARAGRAPH-NAME                     
027526             MOVE 'SELECT FIRST TIME TRIP OPENED  '                       
027527                                 TO PV-DB2-OPERATION-ATTEMPTED            
027528             PERFORM 9100-SQL-ABEND                                       
027529     END-EVALUATE.                                                        
027530                                                                          
027531                                                                          
027532*-----------------------------------------------------------------        
027533*                                                                         
027534* DMH 8/18/16                                                             
027535*-----------------------------------------------------------------        
027536 4020-GET-SOURCE-CARTONS.                                                 
027537                                                                          
027538     EXEC SQL                                                             
027553                                                                          
027554         SELECT COUNT(DISTINCT(T1.SML))                                   
027555           INTO :PV-SRC-CART-CNT                                          
027556           FROM                                                           
027557               (                                                          
027558                SELECT DISTINCT(G.SHIPT_UNT_ID) AS SML                    
027559                 FROM SUT_OTBND_LOC E                                     
027560                    , SUT_OTBND_CART G                                    
027561                WHERE E.OTBND_TRIP_ID      = :DK-TRIP-ID                  
027562                  AND E.SCN_CDE            = 'SHON'                       
027563                  AND E.ACTV_CDE           = 'A'                          
027564                  AND E.SHIPT_UNT_ID       =  G.SHIPT_UNT_ID              
027565                  AND G.CART_SRC_CDE       = :DK-SML-SRC                  
027566                  AND G.ACTV_IND           = 'Y'                          
027567                                                                          
027568                UNION                                                     
027569                                                                          
027570               SELECT DISTINCT(AA.SHIPT_UNT_ID) AS SML                    
027571                 FROM SUT_OTBND_CART AA                                   
027572                    , TSUCRDV CC                                          
027573                    , TSUCDOT DD                                          
027574                WHERE DD.OTBND_TRIP_ID     = :DK-TRIP-ID                  
027575                  AND DD.OPER_UNT_ID       =  CC.OPER_UNT_ID              
027576                  AND DD.DOOR_ID           =  CC.DOOR_ID                  
027577                  AND DD.STRT_DIVERT_TMST <=  CC.DIVERT_TMST              
027578                  AND DD.END_DIVERT_TMST  >=  CC.DIVERT_TMST              
027579                  AND CC.ACTV_CDE          = 'A'                          
027580                  AND CC.SHIPT_UNT_ID      =  AA.SHIPT_UNT_ID             
027581                  AND AA.CART_SRC_CDE      = :DK-SML-SRC                  
027582                  AND AA.ACTV_IND          = 'Y'                          
027583               )  AS T1                                                   
027584           WITH UR                                                        
027585     END-EXEC.                                                            
027586                                                                          
027587     EVALUATE TRUE                                                        
027588         WHEN SQLCODE = ZERO                                              
027589              MOVE PV-SRC-CART-CNT  TO  SU123-TRIP-SRC-CARTONS            
027590                                                                          
027591         WHEN SQLCODE = +100                                              
027592              MOVE  ZEROES       TO  PV-SRC-CART-CNT                      
027593              MOVE SQLCODE       TO  PV-SQLCODE                           
027594              MOVE DK-TRIP-ID    TO  PV-DISP-TRIP-ID                      
027595*                                                                         
027596              STRING '4010-'                                              
027597                     ' SQL:'   PV-SQLCODE                                 
027598                     ' TRIP:'  PV-DISP-TRIP-ID                            
027599                     ' SRC:'   DK-SML-SRC                                 
027600                               DELIMITED BY SIZE                          
027601                          INTO PV-MESSAGE-1                               
027602                                                                          
027603             DISPLAY PV-MESSAGE-1                                         
027604                                                                          
027605                                                                          
027606         WHEN SQLWARN0 NOT = SPACES                                       
027607         WHEN SQLCODE < ZERO                                              
027608         WHEN SQLCODE > ZERO                                              
027609              MOVE  ZEROES       TO  PV-SRC-CART-CNT                      
027610              MOVE SQLCODE       TO  PV-SQLCODE                           
027611              MOVE DK-TRIP-ID    TO  PV-DISP-TRIP-ID                      
027612*                                                                         
027613              STRING '4020-'                                              
027614                     ' SQL:'   PV-SQLCODE                                 
027615                     ' TRIP:'  PV-DISP-TRIP-ID                            
027616                     ' SRC:'   DK-SML-SRC                                 
027617                               DELIMITED BY SIZE                          
027618                          INTO PV-MESSAGE-1                               
027619                                                                          
027620             DISPLAY PV-MESSAGE-1                                         
027621                                                                          
027622             MOVE '4020-GET-SOURCE-CARTONS    '                           
027623                                 TO PV-PARAGRAPH-NAME                     
027624             MOVE 'SELECT FIRST TIME TRIP OPENED  '                       
027625                                 TO PV-DB2-OPERATION-ATTEMPTED            
027626             PERFORM 9100-SQL-ABEND                                       
027627     END-EVALUATE.                                                        
027628                                                                          
027629     MOVE DK-TRIP-ID    TO  PV-DISP-TRIP-ID                               
027630*                                                                         
027631     STRING ' SUKUT180-4020-'                                             
027633            ' TRIP:'  PV-DISP-TRIP-ID                                     
027634            ' SRC:'   DK-SML-SRC                                          
027635            ' PREV:'  PV-PREV-SML-SRC-CDE                                 
027636                      DELIMITED BY SIZE                                   
027637                 INTO PV-MESSAGE-1.                                       
027638     DISPLAY  PV-MESSAGE-1.                                               
027639                                                                          
027640                                                                          
027641*-----------------------------------------------------------------        
027642*                                                                         
027643* DMH 8/18/16                                                             
027650*-----------------------------------------------------------------        
027700 4030-COUNT-MASTER.                                                       
027701                                                                          
027710     EXEC SQL                                                             
027720         SELECT COUNT(DISTINCT(T1.SML))                                   
027721           INTO :PV-MASTER-CNT                                            
027722           FROM                                                           
027730               (                                                          
027740                SELECT DISTINCT(G.SHIPT_UNT_ID) AS SML                    
027750                 FROM SUT_OTBND_LOC E                                     
027780                    , SUT_OTBND_CART G                                    
027790                WHERE E.OTBND_TRIP_ID        = :DK-TRIP-ID                
027797                   AND E.SCN_CDE             = 'SHON'                     
027798                   AND E.ACTV_CDE            = 'I'                        
027799                   AND E.SHIPT_UNT_ID        = G.SHIPT_UNT_ID             
027800                   AND G.CART_SRC_CDE        = 'MST'                      
027810                   AND G.ACTV_IND            = 'N'                        
027835                                                                          
027836                UNION                                                     
027837                                                                          
027838                SELECT DISTINCT(AA.SHIPT_UNT_ID) AS SML                   
027839                  FROM SUT_OTBND_CART AA                                  
027840                     , TSUCRDV CC                                         
027841                     , TSUCDOT DD                                         
027844                 WHERE DD.OTBND_TRIP_ID     = :DK-TRIP-ID                 
027845                   AND DD.OPER_UNT_ID       =  CC.OPER_UNT_ID             
027846                   AND DD.DOOR_ID           =  CC.DOOR_ID                 
027847                   AND DD.STRT_DIVERT_TMST <=  CC.DIVERT_TMST             
027848                   AND DD.END_DIVERT_TMST  >=  CC.DIVERT_TMST             
027849                   AND CC.ACTV_CDE          = 'I'                         
027850                   AND CC.SHIPT_UNT_ID      =  AA.SHIPT_UNT_ID            
027851                   AND AA.CART_SRC_CDE      = 'MST'                       
027852                   AND AA.ACTV_IND          = 'N'                         
027862               )  AS T1                                                   
027877           WITH UR                                                        
027878                                                                          
027879     END-EXEC.                                                            
027904                                                                          
027905     EVALUATE TRUE                                                        
027906         WHEN SQLCODE = ZERO                                              
027907              CONTINUE                                                    
027908         WHEN SQLCODE = +100                                              
027909              MOVE  ZEROES              TO PV-MASTER-CNT                  
027910              MOVE SQLCODE              TO PV-SQLCODE                     
027911              MOVE DK-TRIP-ID           TO PV-DISP-TRIP-ID                
027912*                                                                         
027913              STRING '4030-'                                              
027914                     ' SQL:'   PV-SQLCODE                                 
027915                     ' TRIP:'  PV-DISP-TRIP-ID                            
027916                               DELIMITED BY SIZE                          
027917                          INTO PV-MESSAGE-1                               
027918                                                                          
027919             DISPLAY PV-MESSAGE-1                                         
027920                                                                          
027921                                                                          
027922         WHEN SQLWARN0 NOT = SPACES                                       
027923         WHEN SQLCODE < ZERO                                              
027924         WHEN SQLCODE > ZERO                                              
027925              MOVE SQLCODE              TO PV-SQLCODE                     
027926              MOVE DK-TRIP-ID           TO PV-DISP-TRIP-ID                
027927*                                                                         
027928              STRING '4030-'                                              
027929                     ' SQL:'   PV-SQLCODE                                 
027930                     ' TRIP:'  PV-DISP-TRIP-ID                            
027931                               DELIMITED BY SIZE                          
027932                          INTO PV-MESSAGE-1                               
027933                                                                          
027934             DISPLAY PV-MESSAGE-1                                         
027935                                                                          
027936             MOVE '4030-COUNT-MASTER          '                           
027937                                 TO PV-PARAGRAPH-NAME                     
027938             MOVE 'COUNT MASTERS ON TRAILER       '                       
027939                                 TO PV-DB2-OPERATION-ATTEMPTED            
027940             PERFORM 9100-SQL-ABEND                                       
027941     END-EVALUATE.                                                        
027950                                                                          
028000                                                                          
034297*-----------------------------------------------------------------        
034298*  READ INPUT FILE                                                        
034299*-----------------------------------------------------------------        
034300 8000-READ-INPUT-REC.                                                     
034301                                                                          
034302     READ INPUT-FILE       INTO                                           
034303           SU117-EXTRACT-RECORD                                           
034304     AT END                                                               
034305         SET PS-EOF-INPUT             TO TRUE                             
034306         DISPLAY ' SUKUT180'                                              
034307                 'END OF INPUT FILE'                                      
034308         DISPLAY SPACES                                                   
034309     NOT AT END                                                           
034310         ADD  1                 TO  PV-INPUT-COUNTER                      
034311                                    PV-INPUT-BREAK                        
034312         IF  PV-INPUT-BREAK  >  500000                                    
034313             MOVE SU117-OPER-UNT-ID TO  PV-DISP-OPER                      
034314             MOVE SU117-STORE-DEST  TO  PV-DISP-STORE                     
034315             MOVE SU117-TRIP-ID     TO  PV-DISP-TRIP                      
034317             MOVE SU117-SML-NBR     TO  PV-DISP-SML                       
034318             MOVE PV-INPUT-COUNTER  TO  PV-DISPLAY-COUNT                  
034319             DISPLAY ' SUKUT180'                                          
034320                     '  OPER:'  PV-DISP-OPER                              
034321                     '  STORE:' PV-DISP-STORE                             
034322                     '  TRIP:'  PV-DISP-TRIP                              
034323                     '  SML:'   PV-DISP-SML                               
034324                     '  CNT:'   PV-DISPLAY-COUNT                          
034325             MOVE ZEROES            TO  PV-INPUT-BREAK                    
034326        END-IF                                                            
034327     END-READ.                                                            
034328                                                                          
034329*-----------------------------------------------------------------        
034330*  WRITE CREATE SOURCE SUMMARY RECORD                                     
034331*-----------------------------------------------------------------        
034340 8100-WRITE-OUTPUT-RECORD.                                                
034400                                                                          
034600     WRITE OUTPUT-RECORD                                                  
034700      FROM SU123-EXTRACT-RECORD.                                          
034800     ADD +1 TO PV-WRITE-COUNTER.                                          
034900                                                                          
035690     PERFORM 8110-WRITE-COMMA-RECORD.                                     
035700                                                                          
035701*-----------------------------------------------------------------        
035702*  WRITE MASTER CONTAINER SUMMARY RECORD                                  
035703*                                                                         
035704* MASTER CREATE & ARRIVE ARE THE SAME                                     
035705*-----------------------------------------------------------------        
035706 8110-WRITE-MASTER.                                                       
035707                                                                          
035708     MOVE  'MST'   TO  SU123-SML-SRC-CDE.                                 
035709     SET  SU123-RPT-SEQ-06   TO  TRUE.                                    
035710                                                                          
035715***  MOVE  ZEROES  TO  SU123-INPUT-RECORD-COUNT                           
035716     MOVE  ZEROES  TO  SU123-ARRIVE-TO-PRC-MIN                            
035717                       SU123-ARRIVE-TO-P2L-PKD-MIN                        
035718                       SU123-PRC-TO-P2L-PKD-MIN                           
035719                       SU123-P2L-PKD-TO-CLOSE-MIN                         
035720                       SU123-P2L-OPEN-TO-CLOSE-MIN                        
035721                       SU123-P2L-CLOSE-TO-OTBND-MIN                       
035722                       SU123-ARRIVE-TO-OTBND-MIN                          
035723                       SU123-PRC-TO-OTBND-MIN                             
035724                       SU123-ARRIVE-TO-TCLOS-MIN                          
035725                       SU123-ARRIVE-TO-SHIP-MIN                           
035726                       SU123-P2L-OPEN-TO-TCLOS-MIN                        
035727                       SU123-P2L-OPEN-TO-SHIP-MIN                         
035728                       SU123-P2L-CLOSE-TO-TCLOS-MIN                       
035729                       SU123-P2L-CLOSE-TO-SHIP-MIN                        
035730                       SU123-ARRIVE-TO-PRC-CNT                            
035731                       SU123-ARRIVE-TO-P2L-PKD-CNT                        
035732                       SU123-PRC-TO-P2L-PKD-CNT                           
035733                       SU123-P2L-PKD-TO-CLOSE-CNT                         
035734                       SU123-P2L-OPEN-TO-CLOSE-CNT                        
035735                       SU123-P2L-CLOSE-TO-OTBND-CNT                       
035736                       SU123-ARRIVE-TO-OTBND-CNT                          
035737                       SU123-PRC-TO-OTBND-CNT                             
035738                       SU123-ARRIVE-TO-TCLOS-CNT                          
035739                       SU123-ARRIVE-TO-SHIP-CNT                           
035740                       SU123-P2L-OPEN-TO-TCLOS-CNT                        
035741                       SU123-P2L-OPEN-TO-SHIP-CNT                         
035742                       SU123-P2L-CLOSE-TO-TCLOS-CNT                       
035743                       SU123-P2L-CLOSE-TO-SHIP-CNT                        
035744                                                                          
035767                                                                          
035768     MOVE  PV-MSTR-ARRIVE-TO-MSTR-MIN                                     
035769                   TO  SU123-ARRIVE-TO-MSTR-MIN                           
035770                                                                          
035771     MOVE  PV-MSTR-PRC-TO-MSTR-MIN                                        
035772                   TO  SU123-PRC-TO-MSTR-MIN                              
035773                                                                          
035775     MOVE  PV-MSTR-CRE-TO-OTBND-MIN                                       
035776                   TO  SU123-MSTR-CRE-TO-OTBND-MIN                        
035777                                                                          
035782     MOVE  PV-MSTR-CRE-TO-TCLOS-MIN                                       
035783                   TO  SU123-MSTR-CRE-TO-TCLOS-MIN                        
035784                                                                          
035785     MOVE  PV-MSTR-CRE-TO-SHIP-MIN                                        
035786                   TO  SU123-MSTR-CRE-TO-SHIP-MIN                         
035787                                                                          
035788     MOVE  PV-MSTR-FIRST-TO-OTBND-MIN                                     
035789                   TO  SU123-MSTR-FIRST-TO-OTBND-MIN                      
035790                                                                          
035791     MOVE  PV-MSTR-FIRST-TO-TCLOS-MIN                                     
035792                   TO  SU123-MSTR-FIRST-TO-TCLOS-MIN                      
035793                                                                          
035794     MOVE  PV-MSTR-FIRST-TO-SHIP-MIN                                      
035795                   TO  SU123-MSTR-FIRST-TO-SHIP-MIN                       
035796                                                                          
035797     MOVE  PV-MSTR-LAST-TO-OTBND-MIN                                      
035798                   TO  SU123-MSTR-LAST-TO-OTBND-MIN                       
035799                                                                          
035800     MOVE  PV-MSTR-LAST-TO-TCLOS-MIN                                      
035801                   TO  SU123-MSTR-LAST-TO-TCLOS-MIN                       
035802                                                                          
035803     MOVE  PV-MSTR-LAST-TO-SHIP-MIN                                       
035804                   TO  SU123-MSTR-LAST-TO-SHIP-MIN                        
035810                                                                          
035812                                                                          
035813     MOVE  PV-MSTR-ARRIVE-TO-MSTR-CNT                                     
035814                   TO  SU123-ARRIVE-TO-MSTR-CNT                           
035815                                                                          
035816     MOVE  PV-MSTR-PRC-TO-MSTR-CNT                                        
035817                   TO  SU123-PRC-TO-MSTR-CNT                              
035818                                                                          
035821     MOVE  PV-MSTR-CRE-TO-OTBND-CNT                                       
035822                   TO  SU123-MSTR-CRE-TO-OTBND-CNT                        
035823                                                                          
035828     MOVE  PV-MSTR-CRE-TO-TCLOS-CNT                                       
035829                   TO  SU123-MSTR-CRE-TO-TCLOS-CNT                        
035830                                                                          
035831     MOVE  PV-MSTR-CRE-TO-SHIP-CNT                                        
035832                   TO  SU123-MSTR-CRE-TO-SHIP-CNT                         
035833                                                                          
035834     MOVE  PV-MSTR-FIRST-TO-OTBND-CNT                                     
035835                   TO  SU123-MSTR-FIRST-TO-OTBND-CNT                      
035836                                                                          
035837     MOVE  PV-MSTR-FIRST-TO-TCLOS-CNT                                     
035838                   TO  SU123-MSTR-FIRST-TO-TCLOS-CNT                      
035839                                                                          
035840     MOVE  PV-MSTR-FIRST-TO-SHIP-CNT                                      
035841                   TO  SU123-MSTR-FIRST-TO-SHIP-CNT                       
035842                                                                          
035843     MOVE  PV-MSTR-LAST-TO-OTBND-CNT                                      
035844                   TO  SU123-MSTR-LAST-TO-OTBND-CNT                       
035845                                                                          
035846     MOVE  PV-MSTR-LAST-TO-TCLOS-CNT                                      
035847                   TO  SU123-MSTR-LAST-TO-TCLOS-CNT                       
035848                                                                          
035849     MOVE  PV-MSTR-LAST-TO-SHIP-CNT                                       
035850                   TO  SU123-MSTR-LAST-TO-SHIP-CNT                        
035851                                                                          
035852*                                                                         
035853* MASTER CREATE & ARRIVE ARE THE SAME                                     
035854     MOVE  PV-MSTR-CRE-TO-OTBND-CNT                                       
035855                   TO  SU123-ARRIVE-TO-OTBND-CNT.                         
035856     MOVE  PV-MSTR-CRE-TO-OTBND-MIN                                       
035857                   TO  SU123-ARRIVE-TO-OTBND-MIN.                         
035858     MOVE  PV-MSTR-ON-OTBND-TO-CLOS-MIN                                   
035859                   TO  SU123-ON-OTBND-TO-CLOS-MIN.                        
035860     MOVE  PV-MSTR-ON-OTBND-TO-CLOS-CNT                                   
035861                   TO  SU123-ON-OTBND-TO-CLOS-CNT.                        
035862     MOVE  PV-MSTR-ON-OTBND-TO-SHIP-MIN                                   
035863                   TO  SU123-ON-OTBND-TO-SHIP-MIN.                        
035864     MOVE  PV-MSTR-ON-OTBND-TO-SHIP-CNT                                   
035865                   TO  SU123-ON-OTBND-TO-SHIP-CNT.                        
035866*                                                                         
035867     MOVE PV-TRIP-OPEN-TO-CLOSE-MIN                                       
035868                   TO  SU123-TRIP-OPEN-TO-CLOSE-MIN.                      
035869     MOVE PV-TRIP-CLOSE-TO-SHIP-MIN                                       
035870                   TO  SU123-TRIP-CLOSE-TO-SHIP-MIN.                      
035871     MOVE PV-TRIP-OPEN-TO-SHIP-MIN                                        
035872                   TO  SU123-TRIP-OPEN-TO-SHIP-MIN.                       
035873*                                                                         
035874*** DMH 8/18/16                                                           
035875*                                                                         
035876     MOVE PV-TRIP-TOTAL-CARTONS                                           
035877                   TO  SU123-TRIP-CARTONS.                                
035878     MOVE PV-MASTER-CNT                                                   
035879                   TO  SU123-TRIP-SRC-CARTONS.                            
035882*                                                                         
035883     WRITE OUTPUT-RECORD                                                  
035884      FROM SU123-EXTRACT-RECORD.                                          
035885     ADD +1 TO PV-WRITE-COUNTER.                                          
035886                                                                          
035887     PERFORM 8110-WRITE-COMMA-RECORD.                                     
035888                                                                          
035889                                                                          
035890*-----------------------------------------------------------------        
035891*  WRITE COMMA DELIMITED DETAIL RECORD                                    
035892*-----------------------------------------------------------------        
035893 8110-WRITE-COMMA-RECORD.                                                 
035894                                                                          
035895     MOVE SU123-OPER-UNT-ID  TO  SU128-OPER-UNT-ID.                       
035896     MOVE SU123-STORE-DEST   TO  SU128-STORE-DEST.                        
035897     MOVE SU123-TRIP-ID      TO  SU128-TRIP-ID.                           
035898     MOVE SU123-SML-SRC-CDE  TO  SU128-SML-SRC-CDE.                       
035899     MOVE SU123-REPORT-SORT-SEQ TO  SU128-REPORT-SORT-SEQ.                
035900*                                                                         
035901     MOVE SU123-TRIP-OPEN-TO-CLOSE-MIN                                    
035902                             TO  SU128-TRIP-OPEN-TO-CLOSE-MIN             
035903     MOVE SU123-TRIP-CLOSE-TO-SHIP-MIN                                    
035904                             TO  SU128-TRIP-CLOSE-TO-SHIP-MIN             
035905     MOVE SU123-TRIP-OPEN-TO-SHIP-MIN                                     
035906                             TO  SU128-TRIP-OPEN-TO-SHIP-MIN              
035907*                                                                         
035908     MOVE SU123-INPUT-RECORD-COUNT                                        
035909                             TO  SU128-INPUT-RECORD-COUNT                 
035910*                                                                         
035911     MOVE SU123-ARRIVE-TO-PRC-MIN                                         
035912                             TO  SU128-ARRIVE-TO-PRC-MIN                  
035913     MOVE SU123-ARRIVE-TO-P2L-PKD-MIN                                     
035914                             TO  SU128-ARRIVE-TO-P2L-PKD-MIN              
035915     MOVE SU123-PRC-TO-P2L-PKD-MIN                                        
035916                             TO  SU128-PRC-TO-P2L-PKD-MIN                 
035917     MOVE SU123-P2L-PKD-TO-CLOSE-MIN                                      
035918                             TO  SU128-P2L-PKD-TO-CLOSE-MIN               
035919     MOVE SU123-P2L-OPEN-TO-CLOSE-MIN                                     
035920                             TO  SU128-P2L-OPEN-TO-CLOSE-MIN              
035921     MOVE SU123-P2L-OPEN-TO-OTBND-MIN                                     
035922                             TO  SU128-P2L-OPEN-TO-OTBND-MIN              
035923     MOVE SU123-P2L-CLOSE-TO-OTBND-MIN                                    
035924                             TO  SU128-P2L-CLOSE-TO-OTBND-MIN             
035925     MOVE SU123-ARRIVE-TO-OTBND-MIN                                       
035926                             TO  SU128-ARRIVE-TO-OTBND-MIN                
035927     MOVE SU123-PRC-TO-OTBND-MIN                                          
035928                             TO  SU128-PRC-TO-OTBND-MIN                   
035929     MOVE SU123-ARRIVE-TO-TCLOS-MIN                                       
035930                             TO  SU128-ARRIVE-TO-TCLOS-MIN                
035931     MOVE SU123-ARRIVE-TO-SHIP-MIN                                        
035932                             TO  SU128-ARRIVE-TO-SHIP-MIN                 
035933     MOVE SU123-P2L-OPEN-TO-TCLOS-MIN                                     
035934                             TO  SU128-P2L-OPEN-TO-TCLOS-MIN              
035935     MOVE SU123-P2L-OPEN-TO-SHIP-MIN                                      
035936                             TO  SU128-P2L-OPEN-TO-SHIP-MIN               
035937     MOVE SU123-P2L-CLOSE-TO-TCLOS-MIN                                    
035938                             TO  SU128-P2L-CLOSE-TO-TCLOS-MIN             
035939     MOVE SU123-P2L-CLOSE-TO-SHIP-MIN                                     
035940                             TO  SU128-P2L-CLOSE-TO-SHIP-MIN              
035941     MOVE SU123-ARRIVE-TO-MSTR-MIN                                        
035942                             TO  SU128-ARRIVE-TO-MSTR-MIN                 
035943     MOVE SU123-PRC-TO-MSTR-MIN                                           
035944                             TO  SU128-PRC-TO-MSTR-MIN                    
035945     MOVE SU123-MSTR-CRE-TO-OTBND-MIN                                     
035946                             TO  SU128-MSTR-CRE-TO-OTBND-MIN              
035947     MOVE SU123-MSTR-CRE-TO-TCLOS-MIN                                     
035948                             TO  SU128-MSTR-CRE-TO-TCLOS-MIN              
035949     MOVE SU123-MSTR-CRE-TO-SHIP-MIN                                      
035950                             TO  SU128-MSTR-CRE-TO-SHIP-MIN               
035951     MOVE SU123-MSTR-FIRST-TO-OTBND-MIN                                   
035952                             TO  SU128-MSTR-FIRST-TO-OTBND-MIN            
035953     MOVE SU123-MSTR-FIRST-TO-TCLOS-MIN                                   
035954                             TO  SU128-MSTR-FIRST-TO-TCLOS-MIN            
035955     MOVE SU123-MSTR-FIRST-TO-SHIP-MIN                                    
035956                             TO  SU128-MSTR-FIRST-TO-SHIP-MIN             
035957     MOVE SU123-MSTR-LAST-TO-OTBND-MIN                                    
035958                             TO  SU128-MSTR-LAST-TO-OTBND-MIN             
035959     MOVE SU123-MSTR-LAST-TO-TCLOS-MIN                                    
035960                             TO  SU128-MSTR-LAST-TO-TCLOS-MIN             
035961     MOVE SU123-MSTR-LAST-TO-SHIP-MIN                                     
035962                             TO  SU128-MSTR-LAST-TO-SHIP-MIN              
035963     MOVE SU123-ON-OTBND-TO-CLOS-MIN                                      
035964                             TO  SU128-ON-OTBND-TO-CLOS-MIN               
035965     MOVE SU123-ON-OTBND-TO-SHIP-MIN                                      
035966                             TO  SU128-ON-OTBND-TO-SHIP-MIN               
035967*                                                                         
035968* INPUT RECORD COUNT                                                      
035969*                                                                         
035970     MOVE SU123-ARRIVE-TO-PRC-CNT                                         
035971                             TO  SU128-ARRIVE-TO-PRC-CNT                  
035972     MOVE SU123-ARRIVE-TO-P2L-PKD-CNT                                     
035973                             TO  SU128-ARRIVE-TO-P2L-PKD-CNT              
035974     MOVE SU123-PRC-TO-P2L-PKD-CNT                                        
035975                             TO  SU128-PRC-TO-P2L-PKD-CNT                 
035976     MOVE SU123-P2L-PKD-TO-CLOSE-CNT                                      
035977                             TO  SU128-P2L-PKD-TO-CLOSE-CNT               
035978     MOVE SU123-P2L-OPEN-TO-CLOSE-CNT                                     
035979                             TO  SU128-P2L-OPEN-TO-CLOSE-CNT              
035980     MOVE SU123-P2L-OPEN-TO-OTBND-CNT                                     
035981                             TO  SU128-P2L-OPEN-TO-OTBND-CNT              
035982     MOVE SU123-P2L-CLOSE-TO-OTBND-CNT                                    
035983                             TO  SU128-P2L-CLOSE-TO-OTBND-CNT             
035984     MOVE SU123-ARRIVE-TO-OTBND-CNT                                       
035985                             TO  SU128-ARRIVE-TO-OTBND-CNT                
035986     MOVE SU123-PRC-TO-OTBND-CNT                                          
035987                             TO  SU128-PRC-TO-OTBND-CNT                   
035988     MOVE SU123-ARRIVE-TO-TCLOS-CNT                                       
035989                             TO  SU128-ARRIVE-TO-TCLOS-CNT                
035990     MOVE SU123-ARRIVE-TO-SHIP-CNT                                        
035991                             TO  SU128-ARRIVE-TO-SHIP-CNT                 
035992     MOVE SU123-P2L-OPEN-TO-TCLOS-CNT                                     
035993                             TO  SU128-P2L-OPEN-TO-TCLOS-CNT              
035994     MOVE SU123-P2L-OPEN-TO-SHIP-CNT                                      
035995                             TO   SU128-P2L-OPEN-TO-SHIP-CNT              
035996     MOVE SU123-P2L-CLOSE-TO-TCLOS-CNT                                    
035997                             TO  SU128-P2L-CLOSE-TO-TCLOS-CNT             
035998     MOVE SU123-P2L-CLOSE-TO-SHIP-CNT                                     
035999                             TO  SU128-P2L-CLOSE-TO-SHIP-CNT              
036000     MOVE SU123-ARRIVE-TO-MSTR-CNT                                        
036001                             TO  SU128-ARRIVE-TO-MSTR-CNT                 
036002     MOVE SU123-PRC-TO-MSTR-CNT                                           
036003                             TO  SU128-PRC-TO-MSTR-CNT                    
036004     MOVE SU123-MSTR-CRE-TO-OTBND-CNT                                     
036005                             TO  SU128-MSTR-CRE-TO-OTBND-CNT              
036006     MOVE SU123-MSTR-CRE-TO-TCLOS-CNT                                     
036007                             TO  SU128-MSTR-CRE-TO-TCLOS-CNT              
036008     MOVE SU123-MSTR-CRE-TO-SHIP-CNT                                      
036009                             TO  SU128-MSTR-CRE-TO-SHIP-CNT               
036010     MOVE SU123-MSTR-FIRST-TO-OTBND-CNT                                   
036011                             TO  SU128-MSTR-FIRST-TO-OTBND-CNT            
036012     MOVE SU123-MSTR-FIRST-TO-TCLOS-CNT                                   
036013                             TO  SU128-MSTR-FIRST-TO-TCLOS-CNT            
036014     MOVE SU123-MSTR-FIRST-TO-SHIP-CNT                                    
036015                             TO  SU128-MSTR-FIRST-TO-SHIP-CNT             
036016     MOVE SU123-MSTR-LAST-TO-OTBND-CNT                                    
036017                             TO  SU128-MSTR-LAST-TO-OTBND-CNT             
036018     MOVE SU123-MSTR-LAST-TO-TCLOS-CNT                                    
036019                             TO  SU128-MSTR-LAST-TO-TCLOS-CNT             
036020     MOVE SU123-MSTR-LAST-TO-SHIP-CNT                                     
036021                             TO  SU128-MSTR-LAST-TO-SHIP-CNT              
036022     MOVE SU123-ON-OTBND-TO-CLOS-CNT                                      
036023                             TO  SU128-ON-OTBND-TO-CLOS-CNT               
036024     MOVE SU123-ON-OTBND-TO-SHIP-CNT                                      
036025                             TO  SU128-ON-OTBND-TO-SHIP-CNT               
036026*                                                                         
036027***DMH 8/18/16                                                            
036028*                                                                         
036029     MOVE SU123-TRIP-CARTONS                                              
036030                             TO  SU128-TRIP-CARTONS                       
036031     MOVE SU123-TRIP-SRC-CARTONS                                          
036032                             TO  SU128-TRIP-SRC-CARTONS                   
036033     MOVE SU123-TOTAL-TRIPS                                               
036034                             TO  SU128-TOTAL-TRIPS                        
036035                                                                          
036036     MOVE ','                      TO SU128-COMMA-001                     
036037                                      SU128-COMMA-002                     
036038                                      SU128-COMMA-003                     
036039                                      SU128-COMMA-004                     
036040                                      SU128-COMMA-005                     
036041                                      SU128-COMMA-006                     
036042                                      SU128-COMMA-007                     
036043                                      SU128-COMMA-008                     
036044                                      SU128-COMMA-009                     
036045                                      SU128-COMMA-010                     
036046                                      SU128-COMMA-011                     
036047                                      SU128-COMMA-012                     
036048                                      SU128-COMMA-013                     
036049                                      SU128-COMMA-014                     
036050                                      SU128-COMMA-015                     
036051                                      SU128-COMMA-016                     
036052                                      SU128-COMMA-017                     
036053                                      SU128-COMMA-018                     
036054                                      SU128-COMMA-019                     
036055                                      SU128-COMMA-020                     
036056                                      SU128-COMMA-021                     
036057                                      SU128-COMMA-022                     
036058                                      SU128-COMMA-023                     
036059                                      SU128-COMMA-024                     
036060                                      SU128-COMMA-025                     
036061                                      SU128-COMMA-026                     
036062                                      SU128-COMMA-027                     
036063                                      SU128-COMMA-028                     
036064                                      SU128-COMMA-029                     
036065                                      SU128-COMMA-030                     
036066                                      SU128-COMMA-031                     
036067                                      SU128-COMMA-032                     
036068                                      SU128-COMMA-033                     
036069                                      SU128-COMMA-034                     
036070                                      SU128-COMMA-035                     
036071                                      SU128-COMMA-036                     
036072                                      SU128-COMMA-037                     
036073                                      SU128-COMMA-038                     
036074                                      SU128-COMMA-039                     
036075                                      SU128-COMMA-040                     
036076                                      SU128-COMMA-041                     
036077                                      SU128-COMMA-042                     
036078                                      SU128-COMMA-043                     
036079                                      SU128-COMMA-044                     
036080                                      SU128-COMMA-045                     
036081                                      SU128-COMMA-046                     
036082                                      SU128-COMMA-047                     
036083                                      SU128-COMMA-048                     
036084                                      SU128-COMMA-049                     
036085                                      SU128-COMMA-050                     
036086                                      SU128-COMMA-051                     
036087                                      SU128-COMMA-052                     
036088                                      SU128-COMMA-053                     
036089                                      SU128-COMMA-054                     
036090                                      SU128-COMMA-055                     
036091                                      SU128-COMMA-056                     
036092                                      SU128-COMMA-057                     
036093                                      SU128-COMMA-058                     
036094                                      SU128-COMMA-059                     
036095                                      SU128-COMMA-060                     
036096                                      SU128-COMMA-061                     
036097                                      SU128-COMMA-062                     
036098                                      SU128-COMMA-063                     
036099                                      SU128-COMMA-064                     
036100                                      SU128-COMMA-065                     
036101                                      SU128-COMMA-066                     
036102                                      SU128-COMMA-067                     
036103                                      SU128-COMMA-068.                    
036104*                                                                         
036105     WRITE COMMA-RECORD                                                   
036106      FROM SU128-EXTRACT-RECORD.                                          
036107                                                                          
036108                                                                          
036109*-----------------------------------------------------------------        
036110*  ERROR FILE - P2L CARTONS CLOSED AFTER DIVERTED CAUSED NEGATIVE         
036111*-----------------------------------------------------------------        
036112 8120-WRITE-P2L-CLOSE-AFT-DVRT.                                           
036113*                                                                         
036114     WRITE ERROR-RECORD                                                   
036115      FROM SU117-EXTRACT-RECORD.                                          
036116     ADD +1 TO PV-ERROR-COUNTER.                                          
036117                                                                          
036118                                                                          
036119*-----------------------------------------------------------------        
036120*  CLOSE OUTPUT FILE.  CLOSE THE CURSOR.                                  
036121*-----------------------------------------------------------------        
036130 9000-EOJ-ROUTINE.                                                        
036200                                                                          
036300     CLOSE INPUT-FILE                                                     
036310           OUTPUT-FILE                                                    
036320           COMMA-DELIMITED-FILE                                           
036330           ERROR-FILE.                                                    
036400                                                                          
036410     DISPLAY SPACES.                                                      
036420     DISPLAY ' SUKUT180 '.                                                
036500     MOVE PV-INPUT-COUNTER  TO PV-DISPLAY-COUNT.                          
036601     DISPLAY 'TOTAL INPUT:   ' PV-DISPLAY-COUNT.                          
036610     MOVE PV-WRITE-COUNTER  TO PV-DISPLAY-COUNT.                          
036620     DISPLAY 'TOTAL OUTPUT:  ' PV-DISPLAY-COUNT.                          
036621     MOVE PV-ERROR-COUNTER  TO PV-DISPLAY-COUNT.                          
036622     DISPLAY 'TOTAL ERROR:   ' PV-DISPLAY-COUNT.                          
036630     DISPLAY SPACES.                                                      
036700                                                                          
040200                                                                          
040300*-----------------------------------------------------------------        
040400*  PERFORMS THE ABEND FOR THE PROGRAM IN THE EVENT THAT AN SQL            
040500*  ERROR OR WARNING CODE OCCURS.                                          
040600*-----------------------------------------------------------------        
040700 9100-SQL-ABEND.                                                          
040800     DISPLAY '9100-SQL-ABEND'.                                            
040900     DISPLAY '** ABEND     **'.                                           
041000     DISPLAY '** PROGRAM   ** =  SUKUT180'.                               
041100     DISPLAY '** PARAGRAPH ** = ' PV-PARAGRAPH-NAME.                      
041200     DISPLAY '** OPERATION ** = ' PV-DB2-OPERATION-ATTEMPTED.             
041300                                                                          
041400******************************************************************        
041500* THIS COPY BOOK MEMBER CONTAINS THE PROCEDURE DIVISION STATE-            
041600* MENTS THAT ARE REQUIRED TO UTILIZE THE DB2 ABEND MODULE                 
041700* 'DSNTIAR' AND CONVERT THE SQLCA INFORMATION INTO A READABLE             
041800* FORMAT.                                                                 
041900******************************************************************        
042000     COPY DPPD004.                                                        
042100                                                                          
042200     MOVE +4013                  TO ABEND-CODE.                           
