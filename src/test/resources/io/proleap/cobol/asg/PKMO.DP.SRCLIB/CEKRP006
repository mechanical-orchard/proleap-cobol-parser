000100***************************************************************** 00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300***************************************************************** 00030000
000400                                                                  00040000
000500 PROGRAM-ID.             CEKRP006.                                00050000
000600 AUTHOR.                 LYNN MCADAMS.                            00060000
000700 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00070000
000800 DATE-WRITTEN            DECEMBER, 1999                           00080000
000900 DATE-COMPILED.                                                   00090000
001000***************************************************************** 00100000
001100*                                                                 00110000
001200***************************************************************** 00120000
001300*                                                               * 00130000
001400*  THIS PROGRAM WILL PRINT THE COMPLETED CENTRAL STOCK PULL     * 00140000
001500*  ITEM REQUESTS REPORT.  THE REPORT WILL BREAK ON CS LOCATION  * 00150000
001600*  AND SUB TOTAL DISTRIBUTED UNITS AND DISTRIBUTED RETAIL.      * 00160000
001700*                                                               * 00170000
001800*  INPUT FOR THIS PROGRAM IS CREATED OUT OF CEKUT007.           * 00180000
001900***************************************************************** 00190000
002000*                                                                 00200000
002100***************************************************************** 00210000
002200 ENVIRONMENT DIVISION.                                            00220000
002300***************************************************************** 00230000
002400                                                                  00240000
002500 CONFIGURATION SECTION.                                           00250000
002600                                                                  00260000
002700 SOURCE-COMPUTER.        IBM-3090.                                00270000
002800 OBJECT-COMPUTER.        IBM-3090.                                00280000
002900                                                                  00290000
003000 INPUT-OUTPUT SECTION.                                            00300000
003100                                                                  00310000
003200 FILE-CONTROL.                                                    00320000
003300*                                                                 00330000
003400     SELECT CE-FILE                                               00340000
003500         ASSIGN TO INP01.                                         00350000
003600                                                                  00360000
003700     SELECT CE-REPORT-FILE                                        00370000
003800         ASSIGN TO RPT01.                                         00380000
003900                                                                  00390000
004000*                                                                 00400000
004100***************************************************************** 00410000
004200 DATA DIVISION.                                                   00420000
004300***************************************************************** 00430000
004400*                                                                 00440000
004500 FILE SECTION.                                                    00450000
004600*                                                                 00460000
004700 FD  CE-FILE                                                      00470000
004800     RECORDING MODE IS F                                          00480000
004900     BLOCK CONTAINS 0 RECORDS                                     00490000
005000     RECORD CONTAINS 130 CHARACTERS                               00500000
005100     LABEL RECORDS ARE STANDARD                                   00510000
005200     DATA RECORD IS CE-RECORD.                                    00520000
005300 01  CE-RECORD                       PIC X(130).                  00530000
005400                                                                  00540000
005500 FD  CE-REPORT-FILE                                               00550000
005600     RECORDING MODE IS F                                          00560000
005700     BLOCK CONTAINS 0  RECORDS                                    00570000
005800     RECORD CONTAINS 132 CHARACTERS                               00580000
005900     LABEL RECORDS ARE OMITTED                                    00590000
006000     DATA RECORD IS CE-REPORT-RECORD.                             00600000
006100 01  CE-REPORT-RECORD                PIC X(132).                  00610000
006200*                                                                 00620000
006300*                                                                 00630000
006400 WORKING-STORAGE SECTION.                                         00640000
006500*                                                                 00650000
006600 01 WS-CALC-FIELDS.                                               00660000
006700    05  WS-RECORDS-READ-QTY          PIC S9(07)    COMP-3         00670000
006800                                                   VALUE ZEROS.   00680000
006900    05  WS-RECORDS-WRITE-QTY         PIC S9(07)    COMP-3         00690000
007000                                                   VALUE ZEROS.   00700000
007100*                                                                 00710000
007200 01  PROGRAM-SWITCHES.                                            00720000
007300     05  PS-END-OF-FILE-SW           PIC X(03)     VALUE 'N'.     00730000
007400         88  PS-END-OF-FILE                        VALUE 'Y'.     00740000
007500     05  PS-FIRST-TIME-SW                PIC X(01) VALUE 'N'.     00750000
007600         88  PS-FIRST-TIME-YES                     VALUE 'Y'.     00760000
007700         88  PS-FIRST-TIME-NO                      VALUE 'N'.     00770000
007800     05  PS-END-OF-CURSOR-SW         PIC X(03)     VALUE 'N'.     00780000
007900         88 PS-END-OF-CURSOR                       VALUE 'Y'.     00790000
008000         88 PS-NOT-END-OF-CURSOR                   VALUE 'N'.     00800000
008100     05  PS-END-OF-TABLE-SW          PIC X(03)     VALUE 'N'.     00810000
008200         88 PS-END-OF-TABLE                        VALUE 'Y'.     00820000
008300         88 PS-NOT-END-OF-TABLE                    VALUE 'N'.     00830000
008400*                                                                 00840000
008700*                                                                 00850000
008800 01  PC-CONSTANTS.                                                00860000
008900     05  PC-1                        PIC S9(03)    VALUE +1       00870000
009000                                                   COMP-3.        00880000
009100     05  PC-2                        PIC S9(03)    VALUE +2       00890000
009200                                                   COMP-3.        00900000
009300     05  PC-9                        PIC S9(03)    VALUE +9       00910000
009400                                                   COMP-3.        00920000
009500     05  PC-10                       PIC S9(03)    VALUE +10      00930000
009600                                                   COMP-3.        00940000
009700     05  PC-55                       PIC S9(03)    VALUE +55      00950000
009800                                                   COMP-3.        00960000
009900     05  PC-60                       PIC S9(03)    VALUE +60      00970000
010000                                                   COMP-3.        00980000
010100     05  PC-PROGRAM-NAME             PIC  X(08)    VALUE          00990000
010200         'CEKRP006'.                                              01000000
010300     05  PC-REPORT-NBR               PIC  9(01)    VALUE 1.       01010000
010400*                                                                 01020000
010500 01 PC-PROGRAM-VARIABLES.                                         01030000
010600     05  PV-LINE-COUNT               PIC S9(03)    VALUE ZERO     01040000
010700                                                   COMP-3.        01050000
010800     05  PV-PAGE-COUNT               PIC S9(04)    VALUE ZERO     01060000
010900                                                   COMP-3.        01070000
011000     05  PV-ABEND-CODE               PIC S9(04)    VALUE ZERO     01080000
011100                                                   COMP SYNC.     01090000
011200     05  PV-ABEND-PARA-NAME          PIC X(30)     VALUE SPACES.  01100000
011300     05  PV-DB2-OPERATION-MSG-1      PIC X(60)     VALUE SPACES.  01110000
011400     05  PV-DB2-OPERATION-MSG-2      PIC X(60)     VALUE SPACES.  01120000
011500     05  PV-DB2-TABLE-NAME           PIC X(12)     VALUE SPACES.  01130000
011600     05  PV-SQLCODE                  PIC Z(8)9-.                  01140000
011700                                                                  01150000
011800     05  PV-SAVE-FIELDS.                                          01160000
011900         10  PV-SAVE-LOC             PIC 9(04)     VALUE ZEROS.   01170000
012000* SKU CHANGED FROM X(10) TO 9(08)            ** WR # 230ZZ      * 01180000
012100*        10  PV-PREV-SKU             PIC X(10)     VALUE SPACES.  01190000
012200         10  PV-PREV-SKU             PIC 9(08)     VALUE ZEROS.   01200000
012300* CHANGES ENDS HERE.                         ** WR # 230ZZ      * 01210000
012400                                                                  01220000
012500     05  PV-REPORT-FIELDS.                                        01230000
012600         10  PV-STORE-NMBR           PIC 9(04)     VALUE ZEROS.   01240000
013000         10  PV-RPT-DC-STORE-NAME    PIC X(25)     VALUE SPACES.  01250000
013100         10  PV-RPT-DIST-UNITS       PIC 9(09)     VALUE ZEROS.   01260000
013200         10  PV-RPT-DIST-RETAIL      PIC 9(07)V99  VALUE ZEROS.   01270000
013300                                                                  01280000
013400     05  PV-REPORT-TOTALS.                                        01290000
013500         10  PV-TOTAL-DIST-UNITS     PIC 9(09)     VALUE ZEROS.   01300000
013600         10  PV-TOTAL-DIST-RETAIL    PIC 9(07)V99  VALUE ZEROS.   01310000
013700                                                                  01320000
013800     05  PV-SUMMARY-TOTALS.                                       01330000
013900         10  PV-ST-SKU-TOT           PIC S9(09)    VALUE ZEROS.   01340000
014000         10  PV-ST-UNITS             PIC S9(09)    VALUE ZEROS.   01350000
014100         10  PV-ST-RETAIL            PIC S9(09)V99 VALUE ZEROS.   01360000
014200                                                                  01370000
014300     05  PV-DATE-DDMMYY.                                          01380000
014400         10  PV-DATE-DD              PIC  X(02).                  01390000
014500         10  PV-DATE-SLASH-1         PIC  X(01).                  01400000
014600         10  PV-DATE-MM              PIC  X(02).                  01410000
014700         10  PV-DATE-SLASH-2         PIC  X(01).                  01420000
014800         10  PV-DATE-YY              PIC  X(04).                  01430000
014900     05  PV-TODAYS-DATE.                                          01440000
015000         10  PV-TODAYS-DATE-YY       PIC  9(02)    VALUE ZEROS.   01450000
015100         10  PV-TODAYS-DATE-MM       PIC  9(02)    VALUE ZEROS.   01460000
015200         10  PV-TODAYS-DATE-DD       PIC  9(02)    VALUE ZEROS.   01470000
015300     05  PV-TODAYS-TIME.                                          01480000
015400         10  PV-TODAYS-TIME-HH       PIC  9(02)    VALUE ZEROS.   01490000
015500         10  PV-TODAYS-TIME-MM       PIC  9(02)    VALUE ZEROS.   01500000
015600         10  PV-TODAYS-TIME-SS       PIC  9(02)    VALUE ZEROS.   01510000
015700         10  FILLER                  PIC  9(02)    VALUE ZEROS.   01520000
015800     05  PV-FORMAT-DATE.                                          01530000
015900         10  PV-FORMAT-DATE-MM       PIC  X(02)    VALUE SPACES.  01540000
016000         10  FILLER                  PIC  X(01)    VALUE '/'.     01550000
016100         10  PV-FORMAT-DATE-DD       PIC  X(02)    VALUE SPACES.  01560000
016200         10  FILLER                  PIC  X(01)    VALUE '/'.     01570000
016300         10  PV-FORMAT-DATE-YYYY     PIC  X(04)    VALUE SPACES.  01580000
016400                                                                  01590000
016500 01  CORPORATE-SUMMARY-TABLE.                                     01600000
016600     05  SUMMARY-TABLE  OCCURS 2500 TIMES INDEXED BY CS-IDX.      01610001
016700         10  SUMMARY-CSLOC-NBR       PIC  9(04).                  01620000
016800         10  SUMMARY-CSLOC-NAME      PIC  X(25).                  01630000
016900         10  SUMMARY-SKU-CNT         PIC  9(09).                  01640000
017000         10  SUMMARY-DIST-UNITS      PIC  9(09).                  01650000
017100         10  SUMMARY-DIST-RETAIL     PIC  9(09)V99.               01660000
017200         10  SUMMARY-LOC-TYPE-CDE    PIC  X(02).                  01670000
017300                                                                  01680000
017400*   RECORD LAYOUT FOR INPUT FILE                                  01690000
017500     COPY CERD013.                                                01700000
017600                                                                  01710000
017610*   RECORD LAYOUT FOR CALLING XLKUT071                            01720000
017620     COPY XLWS071.                                                01730000
017630                                                                  01740000
017700                                                                  01750000
017900******************************************************************01760000
018000*  WORK FIELDS FOR PRINTING A 132 CHARACTER REPORT.               01770000
018100******************************************************************01780000
018200     COPY DPWS132O.                                               01790000
018300*                                                                 01800000
018400 01  WS-BATCH-PROC-DATE.                                          01810000
018500     05  WS-BATCH-PROC-CC            PIC X(02)     VALUE SPACES.  01820000
018600     05  WS-BATCH-PROC-YY            PIC X(02)     VALUE SPACES.  01830000
018700     05  FILLER                      PIC X(01)     VALUE SPACES.  01840000
018800     05  WS-BATCH-PROC-MM            PIC X(02)     VALUE SPACES.  01850000
018900     05  FILLER                      PIC X(01)     VALUE SPACES.  01860000
019000     05  WS-BATCH-PROC-DD            PIC X(02)     VALUE SPACES.  01870000
019100*                                                                 01880000
019200*                                                                 01890000
019300 01  HEADING-LINE1.                                               01900000
019400     05  FILLER                  PIC  X(39)    VALUE SPACES.      01910000
019500     05  FILLER                  PIC  X(47)    VALUE              01920000
019600         'COMPLETED CENTRAL STOCK PULL ITEM REQUESTS FOR '.       01930000
019700     05  HL1-BTCH-PRC-DTE.                                        01940000
019800         10  HL1-BATCH-PROC-MM   PIC  X(02)    VALUE SPACES.      01950000
019900         10  FILLER              PIC  X(01)    VALUE '/'.         01960000
020000         10  HL1-BATCH-PROC-DD   PIC  X(02)    VALUE SPACES.      01970000
020100         10  FILLER              PIC  X(01)    VALUE '/'.         01980000
020200         10  HL1-BATCH-PROC-CC   PIC  X(02)    VALUE SPACES.      01990000
020300         10  HL1-BATCH-PROC-YY   PIC  X(02)    VALUE SPACES.      02000000
020400         10  FILLER              PIC  X(36)    VALUE SPACES.      02010000
020500*                                                                 02020000
020600 01  HEADING-LINE2.                                               02030000
020700     05  FILLER                  PIC  X(53)    VALUE SPACES.      02040000
020800     05  FILLER                  PIC  X(15)    VALUE              02050000
020900         'BATCH NUMBER:  '.                                       02060000
021000     05  HL2-BATCH-NMBR          PIC  9(04)    VALUE ZEROS.       02070000
021100     05  FILLER                  PIC  X(60)    VALUE SPACES.      02080000
021200*                                                                 02090000
021300 01  HEADING-LINE3.                                               02100000
021400     05  FILLER                  PIC  X(01)    VALUE SPACES.      02110000
021500     05  FILLER                  PIC  X(14)    VALUE              02120000
021600         'CS LOCATION:  '.                                        02130000
021700     05  HL3-DC-STORE-NMBR       PIC  ZZ99     VALUE ZEROS.       02140000
021800     05  FILLER                  PIC  X(01)    VALUE SPACES.      02150000
021900     05  HL3-DC-STORE-NAME       PIC  X(25)    VALUE SPACES.      02160000
022000     05  FILLER                  PIC  X(87)    VALUE SPACES.      02170000
022100                                                                  02180000
022200 01  HEADING-LINE4.                                               02190000
022300     05  FILLER                  PIC  X(01)    VALUE SPACES.      02200000
022400     05  FILLER                  PIC  X(10)    VALUE              02210000
022500         'SKU NUMBER'.                                            02220000
022600     05  FILLER                  PIC  X(12)    VALUE SPACES.      02230000
022700     05  FILLER                  PIC  X(15)    VALUE              02240000
022800         'SKU DESCRIPTION'.                                       02250000
022900     05  FILLER                  PIC  X(12)    VALUE SPACES.      02260000
023000     05  FILLER                  PIC  X(11)    VALUE              02270000
023100         'DISTRIBUTED'.                                           02280000
023200     05  FILLER                  PIC  X(08)    VALUE SPACES.      02290000
023300     05  FILLER                  PIC  X(04)    VALUE              02300000
023400         'PULL'.                                                  02310000
023500     05  FILLER                  PIC  X(09)    VALUE SPACES.      02320000
023600     05  FILLER                  PIC  X(04)    VALUE              02330000
023700         'LINE'.                                                  02340000
023800     05  FILLER                  PIC  X(08)    VALUE SPACES.      02350000
023900     05  FILLER                  PIC  X(11)    VALUE              02360000
024000         'DISTRIBUTED'.                                           02370000
024100     05  FILLER                  PIC  X(07)    VALUE SPACES.      02380000
024200     05  FILLER                  PIC  X(11)    VALUE              02390000
024300         'DISTRIBUTED'.                                           02400000
024400     05  FILLER                  PIC  X(09)    VALUE SPACES.      02410000
024500                                                                  02420000
024600 01  HEADING-LINE5.                                               02430000
024700     05  FILLER                  PIC  X(54)    VALUE SPACES.      02440000
024800     05  FILLER                  PIC  X(04)    VALUE              02450000
024900         'DATE'.                                                  02460000
025000     05  FILLER                  PIC  X(10)    VALUE SPACES.      02470000
025100     05  FILLER                  PIC  X(06)    VALUE              02480000
025200         'NUMBER'.                                                02490000
025300     05  FILLER                  PIC  X(07)    VALUE SPACES.      02500000
025400     05  FILLER                  PIC  X(06)    VALUE              02510000
025500         'NUMBER'.                                                02520000
025600     05  FILLER                  PIC  X(10)    VALUE SPACES.      02530000
025700     05  FILLER                  PIC  X(05)    VALUE              02540000
025800         'UNITS'.                                                 02550000
025900     05  FILLER                  PIC  X(12)    VALUE SPACES.      02560000
026000     05  FILLER                  PIC  X(06)    VALUE              02570000
026100         'RETAIL'.                                                02580000
026200     05  FILLER                  PIC  X(12)    VALUE SPACES.      02590000
026300                                                                  02600000
026400 01  HEADING-LINE6.                                               02610000
026500     05  FILLER                  PIC  X(01)    VALUE SPACES.      02620000
026600     05  FILLER                  PIC  X(10)    VALUE              02630000
026700         '----------'.                                            02640000
026800     05  FILLER                  PIC  X(07)    VALUE SPACES.      02650000
026900     05  FILLER                  PIC  X(25)    VALUE              02660000
027000         '-------------------------'.                             02670000
027100     05  FILLER                  PIC  X(07)    VALUE SPACES.      02680000
027200     05  FILLER                  PIC  X(11)    VALUE              02690000
027300         '-----------'.                                           02700000
027400     05  FILLER                  PIC  X(06)    VALUE SPACES.      02710000
027500     05  FILLER                  PIC  X(08)    VALUE              02720000
027600         '--------'.                                              02730000
027700     05  FILLER                  PIC  X(06)    VALUE SPACES.      02740000
027800     05  FILLER                  PIC  X(06)    VALUE              02750000
027900         '------'.                                                02760000
028000     05  FILLER                  PIC  X(07)    VALUE SPACES.      02770000
028100     05  FILLER                  PIC  X(11)    VALUE              02780000
028200         '-----------'.                                           02790000
028300     05  FILLER                  PIC  X(07)    VALUE SPACES.      02800000
028400     05  FILLER                  PIC  X(11)    VALUE              02810000
028500         '-----------'.                                           02820000
028600     05  FILLER                  PIC  X(09)    VALUE SPACES.      02830000
028700*                                                                 02840000
028800******************************************************************02850000
028900*    THESE LINES WILL BE USED FOR THE SUMMARY REPORT.            *02860000
029000******************************************************************02870000
029100 01  HEADING-LINE7.                                               02880000
029200     05  FILLER                  PIC  X(01)    VALUE SPACES.      02890000
029300     05  FILLER                  PIC  X(31)    VALUE              02900000
029400         'CS LOCATION:  CORPORATE SUMMARY'.                       02910000
029500     05  FILLER                  PIC  X(100)   VALUE SPACES.      02920000
029600*                                                                 02930000
029700 01  HEADING-LINE8.                                               02940000
029800     05  FILLER                  PIC  X(04)    VALUE SPACES.      02950000
029900     05  FILLER                  PIC  X(11)    VALUE              02960000
030000         'CS LOCATION'.                                           02970000
030100     05  FILLER                  PIC  X(32)    VALUE SPACES.      02980000
030200     05  FILLER                  PIC  X(09)    VALUE              02990000
030300         'NUMBER OF'.                                             03000000
030400     05  FILLER                  PIC  X(07)    VALUE SPACES.      03010000
030500     05  FILLER                  PIC  X(11)    VALUE              03020000
030600         'DISTRIBUTED'.                                           03030000
030700     05  FILLER                  PIC  X(06)    VALUE SPACES.      03040000
030800     05  FILLER                  PIC  X(11)    VALUE              03050000
030900         'DISTRIBUTED'.                                           03060000
031000     05  FILLER                  PIC  X(41)    VALUE SPACES.      03070000
031100*                                                                 03080000
031200 01  HEADING-LINE9.                                               03090000
031300     05  FILLER                  PIC  X(49)    VALUE SPACES.      03100000
031400     05  FILLER                  PIC  X(03)    VALUE              03110000
031500         'SKU'.                                                   03120000
031600     05  FILLER                  PIC  X(01)    VALUE              03130000
031700         "'".                                                     03140000
031800     05  FILLER                  PIC  X(01)    VALUE              03150000
031900         'S'.                                                     03160000
032000     05  FILLER                  PIC  X(12)    VALUE SPACES.      03170000
032100     05  FILLER                  PIC  X(05)    VALUE              03180000
032200         'UNITS'.                                                 03190000
032300     05  FILLER                  PIC  X(12)    VALUE SPACES.      03200000
032400     05  FILLER                  PIC  X(06)    VALUE              03210000
032500         'RETAIL'.                                                03220000
032600     05  FILLER                  PIC  X(43)    VALUE SPACES.      03230000
032700*                                                                 03240000
032800 01  REPORT-DETAIL-LINE.                                          03250000
032900     05  FILLER                  PIC  X(03)    VALUE SPACES.      03260000
033000*   COMMENTED DEPT, CLASS, SKU FIELDS AND DECLARED WR # 230ZZ   * 03270000
033100*   SKU AS X(08).                                                 03280000
033200*    05  DL1-SKU-DEPT            PIC  X(03)    VALUE SPACES.      03290000
033300*    05  FILLER                  PIC  X(01)    VALUE              03300000
033400*        '-'.                                                     03310000
033500*    05  DL1-SKU-CLASS           PIC  X(02)    VALUE SPACES.      03320000
033600*    05  FILLER                  PIC  X(01)    VALUE              03330000
033700*        '-'.                                                     03340000
033800*    05  DL1-SKU-SEQ             PIC  X(03)    VALUE SPACES.      03350000
033900     05  DL1-SKU                 PIC  X(08)    VALUE SPACES.      03360000
034000*   CHANGES ENDS HERE.                               WR # 230ZZ * 03370000
034100     05  FILLER                  PIC  X(07)    VALUE SPACES.      03380000
034200     05  DL1-SKU-DESCRIPTION     PIC  X(25)    VALUE SPACES.      03390000
034300     05  FILLER                  PIC  X(07)    VALUE SPACES.      03400000
034400     05  DL1-DIST-DATE-MM        PIC  9(02)    VALUE ZEROS.       03410000
034500     05  FILLER                  PIC  X(01)    VALUE              03420000
034600         '/'.                                                     03430000
034700     05  DL1-DIST-DATE-DD        PIC  9(02)    VALUE ZEROS.       03440000
034800     05  FILLER                  PIC  X(01)    VALUE              03450000
034900         '/'.                                                     03460000
035000     05  DL1-DIST-DATE-CC        PIC  9(02)    VALUE ZEROS.       03470000
035100     05  DL1-DIST-DATE-YY        PIC  9(02)    VALUE ZEROS.       03480000
035200     05  FILLER                  PIC  X(07)    VALUE SPACES.      03490000
035300     05  DL1-PULL-NBR            PIC  9(08)    VALUE ZEROS.       03500000
035400     05  FILLER                  PIC  X(07)    VALUE SPACES.      03510000
035500     05  DL1-PULL-LNE-NBR        PIC  9(04)    VALUE ZEROS.       03520000
035600     05  FILLER                  PIC  X(08)    VALUE SPACES.      03530000
035700     05  DL1-DIST-UNITS          PIC  ZZZ,ZZZ,ZZ9                 03540000
035800         VALUE ZEROS.                                             03550000
035900     05  FILLER                  PIC  X(07)    VALUE SPACES.      03560000
036000     05  DL1-DIST-RETAIL         PIC  Z,ZZZ,ZZZ.99                03570000
036100         VALUE ZEROS.                                             03580000
036200     05  FILLER                  PIC  X(13)    VALUE SPACES.      03590000
036300*                                                                 03600000
036400 01  REPORT-TOTALS-LINE.                                          03610000
036500     05  FILLER                  PIC  X(67)    VALUE SPACES.      03620000
036600     05  FILLER                  PIC  X(27)    VALUE              03630000
036700         'CS LOCATION TOTALS:        '.                           03640000
036800     05  TL1-TOTAL-DIST-UNITS    PIC  ZZZ,ZZZ,ZZ9                 03650000
036900         VALUE ZEROS.                                             03660000
037000     05  FILLER                  PIC  X(07)    VALUE SPACES.      03670000
037100     05  TL1-TOTAL-DIST-RETAIL   PIC  Z,ZZZ,ZZZ.99                03680000
037200         VALUE ZEROS.                                             03690000
037300     05  FILLER                  PIC  X(13)    VALUE SPACES.      03700000
037400*                                                                 03710000
037500 01  SUMMARY-DETAIL-LINE.                                         03720000
037600     05  FILLER                  PIC  X(06)    VALUE SPACES.      03730000
037700     05  DL2-DC-STORE-NMBR       PIC  ZZ99     VALUE ZEROS.       03740000
037800     05  FILLER                  PIC  X(02)    VALUE SPACES.      03750000
037900     05  DL2-DC-STORE-NAME       PIC  X(25)    VALUE SPACES.      03760000
038000     05  FILLER                  PIC  X(13)    VALUE SPACES.      03770000
038100     05  DL2-SKU-CNT             PIC  ZZ9      VALUE ZEROS.       03780000
038200     05  FILLER                  PIC  X(10)    VALUE SPACES.      03790000
038300     05  DL2-DIST-UNITS          PIC  ZZZ,ZZZ,ZZ9                 03800000
038400         VALUE ZEROS.                                             03810000
038500     05  FILLER                  PIC  X(05)    VALUE SPACES.      03820000
038600     05  DL2-DIST-RETAIL         PIC  Z,ZZZ,ZZZ.99                03830000
038700         VALUE ZEROS.                                             03840000
038800     05  FILLER                  PIC  X(46)    VALUE SPACES.      03850000
038900                                                                  03860000
039000 01  SUMMARY-TOTALS-LINE.                                         03870000
039100     05  FILLER                  PIC  X(28)    VALUE SPACES.      03880000
039200     05  FILLER                  PIC  X(22)    VALUE              03890000
039300         'CORPORATE TOTALS:     '.                                03900000
039400     05  TL2-SKU-CNT             PIC  ZZ9      VALUE ZEROS.       03910000
039500     05  FILLER                  PIC  X(10)    VALUE SPACES.      03920000
039600     05  TL2-TOTAL-DIST-UNITS    PIC  ZZZ,ZZZ,ZZ9                 03930000
039700         VALUE ZEROS.                                             03940000
039800     05  FILLER                  PIC  X(05)    VALUE SPACES.      03950000
039900     05  TL2-TOTAL-DIST-RETAIL   PIC  Z,ZZZ,ZZZ.99                03960000
040000         VALUE ZEROS.                                             03970000
040100     05  FILLER                  PIC  X(46)    VALUE SPACES.      03980000
040200                                                                  03990000
040300 01  BL-BLANK-LINE                   PIC X(132)    VALUE SPACES.  04000000
040400                                                                  04010000
040500 01  MISCELLANEOUS-LINES.                                         04020000
040600     05  END-OF-REPORT-LINE.                                      04030000
040700         10  FILLER                  PIC  X(44)    VALUE SPACES.  04040000
040800         10  FILLER                  PIC  X(45)    VALUE          04050000
040900             '*******   E N D   O F   R E P O R T   *******'.     04060000
041000         10  FILLER                  PIC  X(43)    VALUE SPACES.  04070000
041100     05  NO-DATA-TO-REPORT-LINE.                                  04080000
041200         10  FILLER                  PIC  X(40)    VALUE SPACES.  04090000
041300         10  FILLER                  PIC  X(52)    VALUE          04100000
041400         '*******  N O   D A T A   T O   R E P O R T   *******'.  04110000
041500         10  FILLER                  PIC  X(40)    VALUE SPACES.  04120000
041600*                                                                 04130000
041700*  DB2 AREA FOR XLT_LOC (STORE TABLE - XLT00010)                  04140000
041800                                                                  04150000
041900     EXEC SQL                                                     04160000
042000          INCLUDE XLT00010                                        04170000
042100     END-EXEC.                                                    04180000
042200                                                                  04190000
042300*** DB2 MESSAGE AREAS ****                                        04200000
042400     COPY DPWS004.                                                04210000
042500*                                                                 04220000
042600*                                                                 04230000
042700*    DB2 AREA FOR COMMUNICATIONS                                  04240000
042800                                                                  04250000
042900     EXEC SQL                                                     04260000
043000          INCLUDE SQLCA                                           04270000
043100     END-EXEC.                                                    04280000
043200                                                                  04290000
043300*    DB2 AREA FOR COMMUNICATIONS AREA2                            04300000
043400                                                                  04310000
043500     COPY SQLCA2.                                                 04320000
043600                                                                  04330000
043700     EXEC SQL                                                     04340000
043800         DECLARE CS_CSR CURSOR FOR                                04350000
043900             SELECT LOC_NBR                                       04360000
044000                  , LOC_NM                                        04370000
044100                  , LOC_TYP_CDE                                   04380000
044200               FROM XLT_LOC                                       04390000
044300              WHERE LOC_TYP_CDE IN ('DS', 'CS')                   04400000
044400              ORDER BY 1                                          04410000
044500     END-EXEC.                                                    04420000
044600                                                                  04430000
044700******************************************************************04440000
044800 PROCEDURE DIVISION.                                              04450000
044900******************************************************************04460000
045000*                                                                 04470000
045100******************************************************************04480000
045200**  THIS IS THE MAIN DRIVER FOR THE PROGRAM.                    **04490000
045300******************************************************************04500000
045400 0000-MAINLINE-PROCESSING.                                        04510000
045500     PERFORM 1000-INITIALIZE.                                     04520000
045600*                                                                 04530000
045700     IF  PS-END-OF-FILE                                           04540000
045800         NEXT SENTENCE                                            04550000
045900     ELSE                                                         04560000
046000         SET PS-FIRST-TIME-NO TO TRUE                             04570000
046100         PERFORM 2000-MAIN-PROCESS                                04580000
046200           UNTIL  PS-END-OF-FILE                                  04590000
046300     END-IF.                                                      04600000
046400*                                                                 04610000
046500*                                                                 04620000
046600     PERFORM 9000-END-PROCESS.                                    04630000
046700*                                                                 04640000
046800     DISPLAY 'NUMBER OF RECORDS READ IS:     '                    04650000
046900         WS-RECORDS-READ-QTY.                                     04660000
047000     DISPLAY 'NUMBER OF RECORDS WRITTEN IS:  '                    04670000
047100         WS-RECORDS-WRITE-QTY.                                    04680000
047200*                                                                 04690000
047300     STOP RUN.                                                    04700000
047400*                                                                 04710000
047500*                                                                 04720000
047600******************************************************************04730000
047700**  PERFORM THE INITIAL PROCESSING FOR THE PROGRAM. **            04740000
047800******************************************************************04750000
047900 1000-INITIALIZE.                                                 04760000
048000     OPEN INPUT  CE-FILE                                          04770000
048100          OUTPUT CE-REPORT-FILE.                                  04780000
048200                                                                  04790000
048300     ACCEPT PV-TODAYS-DATE FROM DATE.                             04800000
048400     ACCEPT PV-TODAYS-TIME FROM TIME.                             04810000
048500*                                                                 04820000
048600     PERFORM 1200-INITIALIZE-HEADINGS.                            04830000
048700                                                                  04840000
048800*READ FIRST INPUT RECORD.                                         04850000
048900     PERFORM 7000-READ-EXTRACT.                                   04860000
049000     SET PS-FIRST-TIME-YES TO TRUE.                               04870000
049100     PERFORM 6999-PRINT-REPORT-HEADINGS.                          04880000
049200     MOVE CE013-DC-STORE-NMBR TO PV-SAVE-LOC.                     04890000
049300*                                                                 04900000
049400     PERFORM 1010-INITIALIZE-SUMMARY-TABLE.                       04910000
049500     PERFORM 1020-LOAD-SUMMARY-TABLE.                             04920000
049600*                                                                 04930000
049700*                                                                 04940000
049800******************************************************************04950000
049900*   INITIALIZE SUMMARY TABLE.                                    *04960000
050000******************************************************************04970000
050100 1010-INITIALIZE-SUMMARY-TABLE.                                   04980000
050200                                                                  04990000
050300     INITIALIZE CORPORATE-SUMMARY-TABLE.                          05000000
050400*                                                                 05010000
050500******************************************************************05020000
050600*   LOAD SUMMARY TABLE.                                          *05030000
050700******************************************************************05040000
050800 1020-LOAD-SUMMARY-TABLE.                                         05050000
050900     EXEC SQL                                                     05060000
051000         OPEN CS_CSR                                              05070000
051100     END-EXEC.                                                    05080000
051200                                                                  05090000
051300     EVALUATE TRUE                                                05100000
051400         WHEN SQLCODE = ZERO                                      05110000
051500             CONTINUE                                             05120000
051600         WHEN OTHER                                               05130000
051610             MOVE SQLCODE TO PV-SQLCODE                           05140000
051700             MOVE '1020-LOAD-SUMMARY-TABLE' TO PV-ABEND-PARA-NAME 05150000
051800             STRING 'SQL ERROR OPENING CURSOR - '                 05160000
051810                     PV-SQLCODE                                   05170000
051820                     DELIMITED BY SIZE                            05180000
051900                     INTO PV-DB2-OPERATION-MSG-1                  05190000
052000             PERFORM 9998-SQL-ABEND                               05200000
052100     END-EVALUATE.                                                05210000
052200                                                                  05220000
052300     PERFORM 1030-FETCH-CURSOR.                                   05230000
052400                                                                  05240000
052500     PERFORM VARYING CS-IDX FROM 1 BY 1                           05250000
052600         UNTIL CS-IDX > 999 OR PS-END-OF-CURSOR                   05260000
052700         MOVE XLT00010-LOC-NBR    TO SUMMARY-CSLOC-NBR (CS-IDX)   05270000
052800         MOVE XLT00010-LOC-NM     TO SUMMARY-CSLOC-NAME (CS-IDX)  05280000
052900         MOVE XLT00010-LOC-TYP-CDE TO                             05290000
052910                               SUMMARY-LOC-TYPE-CDE (CS-IDX)      05291000
053000                                                                  05292000
053100         PERFORM 1030-FETCH-CURSOR                                05293000
053200     END-PERFORM.                                                 05294000
053300                                                                  05295000
053400     EXEC SQL                                                     05296000
053500         CLOSE CS_CSR                                             05297000
053600     END-EXEC.                                                    05298000
053700                                                                  05299000
053800     EVALUATE TRUE                                                05300000
053900         WHEN SQLCODE = ZERO                                      05310000
054000             CONTINUE                                             05320000
054100         WHEN OTHER                                               05330000
054110             MOVE SQLCODE TO PV-SQLCODE                           05340000
054200             MOVE '1020-LOAD-SUMMARY-TABLE' TO PV-ABEND-PARA-NAME 05350000
054401             STRING 'SQL ERROR CLOSING CURSOR - '                 05360000
054410                     PV-SQLCODE                                   05370000
054420                     DELIMITED BY SIZE                            05380000
054430                     INTO PV-DB2-OPERATION-MSG-1                  05390000
054500             PERFORM 9998-SQL-ABEND                               05400000
054600     END-EVALUATE.                                                05410000
054700                                                                  05420000
054800*                                                                 05430000
054900 1030-FETCH-CURSOR.                                               05440000
055000     EXEC SQL                                                     05450000
055100         FETCH CS_CSR                                             05460000
055200          INTO :XLT00010-LOC-NBR                                  05470000
055300             , :XLT00010-LOC-NM                                   05480000
055400             , :XLT00010-LOC-TYP-CDE                              05490000
055500     END-EXEC.                                                    05500000
055600                                                                  05510000
055700     EVALUATE TRUE                                                05520000
055800         WHEN SQLCODE = ZERO                                      05530000
055900             CONTINUE                                             05540000
056000         WHEN SQLCODE = +100                                      05550000
056100             SET PS-END-OF-CURSOR TO TRUE                         05560000
056200         WHEN OTHER                                               05570000
056210             MOVE SQLCODE TO PV-SQLCODE                           05580000
056300             MOVE '1030-FETCH-CURSOR' TO PV-ABEND-PARA-NAME       05590000
056510             STRING 'SQL ERROR FETCHING DATA - '                  05600000
056520                     PV-SQLCODE                                   05610000
056530                     DELIMITED BY SIZE                            05620000
056540                     INTO PV-DB2-OPERATION-MSG-1                  05630000
056600             PERFORM 9998-SQL-ABEND                               05640000
056700     END-EVALUATE.                                                05650000
056800*                                                                 05660000
056900*                                                                 05670000
057000******************************************************************05680000
057100*   INITIALIZE REPORT HEADINGS.                                  *05690000
057200******************************************************************05700000
057300 1200-INITIALIZE-HEADINGS.                                        05710000
057400     MOVE PV-TODAYS-DATE-YY      TO DP132O-RUN-YEAR.              05720000
057500     MOVE PV-TODAYS-DATE-MM      TO DP132O-RUN-MONTH.             05730000
057600     MOVE PV-TODAYS-DATE-DD      TO DP132O-RUN-DAY.               05740000
057700     MOVE PV-TODAYS-TIME-HH      TO DP132O-RUN-HOUR.              05750000
057800     MOVE PV-TODAYS-TIME-MM      TO DP132O-RUN-MINUTE.            05760000
057900     MOVE PC-PROGRAM-NAME        TO DP132O-PROGRAM-NAME.          05770000
058000     MOVE PC-1                   TO DP132O-REPORT-NUMBER.         05780000
058100*                                                                 05790000
058200*                                                                 05800000
058300******************************************************************05810000
058400*  THIS IS THE MAIN CONTROLLING PARAGRAPH FOR PROCESSING THE     *05820000
058500*  COMPLETED CENTRAL STOCK PULL ITEM REQUESTS REPORT.            *05830000
058600******************************************************************05840000
058700 2000-MAIN-PROCESS.                                               05850000
058800     IF PV-SAVE-LOC = CE013-DC-STORE-NMBR                         05860000
058900        CONTINUE                                                  05870000
059000     ELSE                                                         05880000
059100        MOVE PV-SAVE-LOC TO HL3-DC-STORE-NMBR                     05890000
059200        ADD  1                       TO PV-PAGE-COUNT             05900000
059300        MOVE PV-PAGE-COUNT           TO DP132O-PAGE-NUMBER        05910000
059400        PERFORM 6850-PRINT-REPORT-TOTALS                          05920000
059500        MOVE CE013-DC-STORE-NMBR TO PV-SAVE-LOC                   05930000
059600        PERFORM 6999-PRINT-REPORT-HEADINGS                        05940000
059700     END-IF.                                                      05950000
059800                                                                  05960000
059900     PERFORM 3000-PROCESS-DETAIL-RECORD.                          05970000
060000                                                                  05980000
060100*READ NEXT INPUT RECORD.                                          05990000
060200     ADD  +1                    TO WS-RECORDS-WRITE-QTY.          06000000
060300     PERFORM 7000-READ-EXTRACT.                                   06010000
060400     ADD  +1                    TO WS-RECORDS-READ-QTY.           06020000
060500*                                                                 06030000
060600*                                                                 06040000
060700 3000-PROCESS-DETAIL-RECORD.                                      06050000
060800*   FOLLOWING MOVE STATEMENTS ARE COMMENTED.   ** WR # 230ZZ  *   06060000
060900*                                                                 06070000
061000*    MOVE CE013-DEPT             TO DL1-SKU-DEPT.                 06080000
061100*    MOVE CE013-CLASS            TO DL1-SKU-CLASS.                06090000
061200*    MOVE CE013-SEQ              TO DL1-SKU-SEQ.                  06100000
061300     MOVE CE013-SKU-NBR          TO DL1-SKU.                      06110000
061400*   CHANGES ENDS HERE.                         ** WR # 230ZZ  *   06120000
061500     MOVE CE013-SKU-DESCRIPTION  TO DL1-SKU-DESCRIPTION.          06130000
061600     MOVE CE013-FILLED-DATE-MMDDCCYY-MM                           06140000
061700                     TO DL1-DIST-DATE-MM.                         06150000
061800     MOVE CE013-FILLED-DATE-MMDDCCYY-DD                           06160000
061900                     TO DL1-DIST-DATE-DD.                         06170000
062000     MOVE CE013-FILLED-DATE-MMDDCCYY-CC                           06180000
062100                     TO DL1-DIST-DATE-CC.                         06190000
062200     MOVE CE013-FILLED-DATE-MMDDCCYY-YY                           06200000
062300                     TO DL1-DIST-DATE-YY.                         06210000
062400     MOVE CE013-PULL-NBR         TO DL1-PULL-NBR.                 06220000
062500     MOVE CE013-PULL-LNE-NBR     TO DL1-PULL-LNE-NBR.             06230000
062600*                                                                 06240000
062700     MOVE CE013-TOTAL-QTY        TO DL1-DIST-UNITS.               06250000
062800     MOVE CE013-TOTAL-QTY        TO PV-RPT-DIST-UNITS.            06260000
062900     ADD CE013-TOTAL-QTY         TO PV-ST-UNITS.                  06270000
063000     ADD PV-RPT-DIST-UNITS       TO PV-TOTAL-DIST-UNITS.          06280000
063100     MOVE ZEROS                  TO PV-RPT-DIST-UNITS.            06290000
063200*                                                                 06300000
063300     MOVE CE013-DISTR-RETAIL     TO DL1-DIST-RETAIL.              06310000
063400     MOVE CE013-DISTR-RETAIL     TO PV-RPT-DIST-RETAIL.           06320000
063500     ADD CE013-DISTR-RETAIL      TO PV-ST-RETAIL.                 06330000
063600     ADD PV-RPT-DIST-RETAIL      TO PV-TOTAL-DIST-RETAIL.         06340000
063700     MOVE ZEROS                  TO PV-RPT-DIST-RETAIL.           06350000
063800*                                                                 06360000
063900     PERFORM 5000-SEARCH-SUMMARY-TABLE.                           06370000
064000     PERFORM 6000-PRINT-REPORT-DETAIL.                            06380000
064100*                                                                 06390000
064200*                                                                 06400000
064300 5000-SEARCH-SUMMARY-TABLE.                                       06410000
064400     SET CS-IDX TO 1.                                             06420000
064500     SEARCH SUMMARY-TABLE                                         06430000
064600         VARYING CS-IDX                                           06440000
064700              AT END SET PS-END-OF-TABLE TO TRUE                  06450000
064800         WHEN SUMMARY-CSLOC-NBR (CS-IDX) = CE013-DC-STORE-NMBR    06460000
064900              ADD CE013-TOTAL-QTY                                 06470000
065000                                TO SUMMARY-DIST-UNITS (CS-IDX)    06480000
065100              ADD CE013-DISTR-RETAIL                              06490000
065200                                TO SUMMARY-DIST-RETAIL (CS-IDX)   06500000
065300              ADD 1             TO SUMMARY-SKU-CNT (CS-IDX)       06510000
065400         END-SEARCH.                                              06520000
065500*                                                                 06530000
065600*                                                                 06540000
065700******************************************************************06550000
065800*     WRITES THE DETAIL LINE INFO FOR THE MAIN REPORT.           *06560000
065900******************************************************************06570000
066000 6000-PRINT-REPORT-DETAIL.                                        06580000
066100         IF  PV-LINE-COUNT > PC-55                                06590000
066200             PERFORM 6999-PRINT-REPORT-HEADINGS                   06600000
066300         END-IF.                                                  06610000
066400                                                                  06620000
066500         WRITE CE-REPORT-RECORD                                   06630000
066600           FROM REPORT-DETAIL-LINE                                06640000
066700             AFTER ADVANCING 1 LINE                               06650000
066800         ADD PC-1            TO PV-LINE-COUNT.                    06660000
066900         INITIALIZE REPORT-DETAIL-LINE.                           06670000
067000*                                                                 06680000
067100*                                                                 06690000
067200******************************************************************06700000
067300*     PRINTS THE TOTALS LINES FOR THE MAIN REPORT.               *06710000
067400******************************************************************06720000
067500 6850-PRINT-REPORT-TOTALS.                                        06730000
067600                                                                  06740000
067700     MOVE PV-TOTAL-DIST-UNITS    TO TL1-TOTAL-DIST-UNITS.         06750000
067800     MOVE PV-TOTAL-DIST-RETAIL   TO TL1-TOTAL-DIST-RETAIL.        06760000
067900     MOVE TL1-TOTAL-DIST-UNITS   TO PV-ST-UNITS.                  06770000
068000     MOVE TL1-TOTAL-DIST-RETAIL  TO PV-ST-RETAIL.                 06780000
068100     MOVE ZEROS                  TO PV-ST-UNITS.                  06790000
068200     MOVE ZEROS                  TO PV-ST-RETAIL.                 06800000
068300                                                                  06810000
068400     WRITE CE-REPORT-RECORD                                       06820000
068500       FROM BL-BLANK-LINE                                         06830000
068600         AFTER ADVANCING 2 LINES.                                 06840000
068700*                                                                 06850000
068800     WRITE CE-REPORT-RECORD                                       06860000
068900       FROM REPORT-TOTALS-LINE                                    06870000
069000         AFTER ADVANCING 2 LINES.                                 06880000
069100*                                                                 06890000
069200     WRITE CE-REPORT-RECORD                                       06900000
069300       FROM BL-BLANK-LINE                                         06910000
069400         AFTER ADVANCING 2 LINES.                                 06920000
069500*                                                                 06930000
069600     IF PS-END-OF-FILE AND                                        06940000
069700        PS-FIRST-TIME-YES                                         06950000
069800           PERFORM 6900-NO-DETAIL                                 06960000
069900     END-IF.                                                      06970000
070000                                                                  06980000
070100     WRITE CE-REPORT-RECORD                                       06990000
070200       FROM END-OF-REPORT-LINE                                    07000000
070300         AFTER ADVANCING 3 LINES.                                 07010000
070400*                                                                 07020000
070500     WRITE CE-REPORT-RECORD                                       07030000
070600       FROM BL-BLANK-LINE                                         07040000
070700         AFTER ADVANCING 2 LINES.                                 07050000
070800*                                                                 07060000
070900*                                                                 07070000
071000     MOVE ZEROS TO PV-TOTAL-DIST-UNITS.                           07080000
071100     MOVE ZEROS TO PV-TOTAL-DIST-RETAIL.                          07090000
071200*                                                                 07100000
071300*                                                                 07110000
071400******************************************************************07120000
071500*  PRINTS REPORT HEADINGS FOR THE CORPORATE SUMMARY.             *07130000
071600******************************************************************07140000
071700 6875-PRINT-SUMMARY.                                              07150000
071800     MOVE PC-1                    TO DP132O-REPORT-NUMBER.        07160000
071900     ADD  1                       TO PV-PAGE-COUNT.               07170000
072000     MOVE PV-PAGE-COUNT           TO DP132O-PAGE-NUMBER.          07180000
072100                                                                  07190000
072200     WRITE CE-REPORT-RECORD                                       07200000
072300       FROM DP132O-STANDRD-HEADER-132-COLS                        07210000
072400         AFTER ADVANCING PAGE.                                    07220000
072500                                                                  07230000
072600     WRITE CE-REPORT-RECORD                                       07240000
072700       FROM HEADING-LINE1                                         07250000
072800         AFTER ADVANCING 2 LINES.                                 07260000
072900                                                                  07270000
073000     WRITE CE-REPORT-RECORD                                       07280000
073100       FROM HEADING-LINE2                                         07290000
073200         AFTER ADVANCING 1 LINE.                                  07300000
073300                                                                  07310000
073400     WRITE CE-REPORT-RECORD                                       07320000
073500       FROM BL-BLANK-LINE                                         07330000
073600         AFTER ADVANCING 1 LINE.                                  07340000
073700                                                                  07350000
073800     WRITE CE-REPORT-RECORD                                       07360000
073900       FROM HEADING-LINE7                                         07370000
074000         AFTER ADVANCING 1 LINE.                                  07380000
074100                                                                  07390000
074200     WRITE CE-REPORT-RECORD                                       07400000
074300       FROM BL-BLANK-LINE                                         07410000
074400         AFTER ADVANCING 1 LINE.                                  07420000
074500                                                                  07430000
074600     WRITE CE-REPORT-RECORD                                       07440000
074700       FROM HEADING-LINE8                                         07450000
074800         AFTER ADVANCING 1 LINE.                                  07460000
074900                                                                  07470000
075000     WRITE CE-REPORT-RECORD                                       07480000
075100       FROM HEADING-LINE9.                                        07490000
075200                                                                  07500000
075300     WRITE CE-REPORT-RECORD                                       07510000
075400       FROM BL-BLANK-LINE                                         07520000
075500         AFTER ADVANCING 1 LINE.                                  07530000
075600                                                                  07540000
075700     MOVE PC-10           TO PV-LINE-COUNT.                       07550000
075800*                                                                 07560000
075900** GET INFO FROM TABLE                                            07570000
076000     PERFORM 6880-PRINT-SUMM-DETAIL                               07580000
076100         VARYING CS-IDX FROM 1 BY 1                               07590000
076200         UNTIL SUMMARY-CSLOC-NBR (CS-IDX) = ZEROS .               07600000
076300                                                                  07610000
076400     MOVE PV-ST-SKU-TOT          TO TL2-SKU-CNT.                  07620000
076500     MOVE PV-ST-UNITS            TO TL2-TOTAL-DIST-UNITS.         07630000
076600     MOVE PV-ST-RETAIL           TO TL2-TOTAL-DIST-RETAIL.        07640000
076700                                                                  07650000
076800     WRITE CE-REPORT-RECORD                                       07660000
076900       FROM BL-BLANK-LINE                                         07670000
077000         AFTER ADVANCING 2 LINES.                                 07680000
077100*                                                                 07690000
077200     WRITE CE-REPORT-RECORD                                       07700000
077300       FROM SUMMARY-TOTALS-LINE                                   07710000
077400         AFTER ADVANCING 2 LINES.                                 07720000
077500*                                                                 07730000
077600*                                                                 07740000
077700******************************************************************07750000
077800*  PRINTS THE SUMMARY DETAIL LINES.                              *07760000
077900******************************************************************07770000
078000 6880-PRINT-SUMM-DETAIL.                                          07780000
078100                                                                  07790000
078200     IF  SUMMARY-LOC-TYPE-CDE (CS-IDX) = 'CS'                     07800000
078300         MOVE SUMMARY-CSLOC-NBR (CS-IDX) TO                       07810000
078400              DL2-DC-STORE-NMBR                                   07820000
078500         MOVE SUMMARY-CSLOC-NAME (CS-IDX) TO                      07830000
078600              DL2-DC-STORE-NAME                                   07840000
078700         MOVE SUMMARY-SKU-CNT (CS-IDX) TO                         07850000
078800              DL2-SKU-CNT                                         07860000
078900         MOVE SUMMARY-DIST-UNITS (CS-IDX) TO                      07870000
079000              DL2-DIST-UNITS                                      07880000
079100         MOVE SUMMARY-DIST-RETAIL (CS-IDX) TO                     07890000
079200              DL2-DIST-RETAIL                                     07900000
079300         ADD  SUMMARY-SKU-CNT    (CS-IDX) TO                      07910000
079400              PV-ST-SKU-TOT                                       07920000
079500         ADD  SUMMARY-DIST-UNITS (CS-IDX) TO                      07930000
079600              PV-ST-UNITS                                         07940000
079700         ADD  SUMMARY-DIST-RETAIL (CS-IDX) TO                     07950000
079800              PV-ST-RETAIL                                        07960000
079900         WRITE CE-REPORT-RECORD FROM SUMMARY-DETAIL-LINE          07970000
080000             AFTER ADVANCING 1 LINE                               07980000
080100     ELSE                                                         07990000
080200         IF  SUMMARY-LOC-TYPE-CDE (CS-IDX) = 'DS'                 08000000
080300         AND SUMMARY-SKU-CNT (CS-IDX)      > 0                    08010000
080400             MOVE SUMMARY-CSLOC-NBR (CS-IDX) TO                   08020000
080500                  DL2-DC-STORE-NMBR                               08030000
080600             MOVE SUMMARY-CSLOC-NAME (CS-IDX) TO                  08040000
080700                  DL2-DC-STORE-NAME                               08050000
080800             MOVE SUMMARY-SKU-CNT (CS-IDX) TO                     08060000
080900                  DL2-SKU-CNT                                     08070000
081000             MOVE SUMMARY-DIST-UNITS (CS-IDX) TO                  08080000
081100                  DL2-DIST-UNITS                                  08090000
081200             MOVE SUMMARY-DIST-RETAIL (CS-IDX) TO                 08100000
081300                  DL2-DIST-RETAIL                                 08110000
081400             ADD  SUMMARY-SKU-CNT    (CS-IDX) TO                  08120000
081500                  PV-ST-SKU-TOT                                   08130000
081600             ADD  SUMMARY-DIST-UNITS (CS-IDX) TO                  08140000
081700                  PV-ST-UNITS                                     08150000
081800             ADD  SUMMARY-DIST-RETAIL (CS-IDX) TO                 08160000
081900                  PV-ST-RETAIL                                    08170000
082000             WRITE CE-REPORT-RECORD FROM SUMMARY-DETAIL-LINE      08180000
082100                 AFTER ADVANCING 1 LINE                           08190000
082200         END-IF                                                   08200000
082300     END-IF.                                                      08210000
082400*                                                                 08220000
082500*                                                                 08230000
082600******************************************************************08240000
082700*  PRINTS NO DETAIL LINE AND END OF REPORT LINES.                *08250000
082800******************************************************************08260000
082900 6900-NO-DETAIL.                                                  08270000
083000     WRITE CE-REPORT-RECORD                                       08280000
083100       FROM NO-DATA-TO-REPORT-LINE                                08290000
083200         AFTER ADVANCING 3 LINES.                                 08300000
083300*                                                                 08310000
083400*                                                                 08320000
083500******************************************************************08330000
083600*  PRINTS REPORT HEADINGS FOR THE MAIN REPORT.                   *08340000
083700******************************************************************08350000
083800 6999-PRINT-REPORT-HEADINGS.                                      08360000
083900                                                                  08370000
084000     PERFORM 7200-GET-STORE-INFORMATION.                          08380000
084100                                                                  08390000
084200     ADD  1                       TO PV-PAGE-COUNT.               08400000
084300     MOVE PV-PAGE-COUNT           TO DP132O-PAGE-NUMBER.          08410000
084400*                                                                 08420000
084500     WRITE CE-REPORT-RECORD                                       08430000
084600       FROM DP132O-STANDRD-HEADER-132-COLS                        08440000
084700         AFTER ADVANCING PAGE.                                    08450000
084800*                                                                 08460000
084900     MOVE CE013-BTCH-PRC-DTE      TO WS-BATCH-PROC-DATE.          08470000
085000     MOVE WS-BATCH-PROC-MM        TO HL1-BATCH-PROC-MM.           08480000
085100     MOVE WS-BATCH-PROC-DD        TO HL1-BATCH-PROC-DD.           08490000
085200     MOVE WS-BATCH-PROC-CC        TO HL1-BATCH-PROC-CC.           08500000
085300     MOVE WS-BATCH-PROC-YY        TO HL1-BATCH-PROC-YY.           08510000
085400*                                                                 08520000
085500     MOVE CE013-BATCH-NMBR       TO HL2-BATCH-NMBR.               08530000
085600     MOVE PV-SAVE-LOC            TO HL3-DC-STORE-NMBR.            08540000
085700     MOVE PV-RPT-DC-STORE-NAME   TO HL3-DC-STORE-NAME.            08550000
085800     MOVE CE013-SKU-NBR          TO PV-PREV-SKU.                  08560000
085900                                                                  08570000
086000     MOVE CE013-DC-STORE-NMBR     TO HL3-DC-STORE-NMBR.           08580000
086100     MOVE PV-RPT-DC-STORE-NAME    TO HL3-DC-STORE-NAME.           08590000
086200*                                                                 08600000
086300     WRITE CE-REPORT-RECORD                                       08610000
086400       FROM HEADING-LINE1                                         08620000
086500         AFTER ADVANCING 2 LINES.                                 08630000
086600*                                                                 08640000
086700     WRITE CE-REPORT-RECORD                                       08650000
086800       FROM HEADING-LINE2                                         08660000
086900         AFTER ADVANCING 1 LINE.                                  08670000
087000*                                                                 08680000
087100     WRITE CE-REPORT-RECORD                                       08690000
087200       FROM BL-BLANK-LINE                                         08700000
087300         AFTER ADVANCING 1 LINE.                                  08710000
087400*                                                                 08720000
087500     WRITE CE-REPORT-RECORD                                       08730000
087600       FROM HEADING-LINE3                                         08740000
087700         AFTER ADVANCING 1 LINE.                                  08750000
087800*                                                                 08760000
087900     WRITE CE-REPORT-RECORD                                       08770000
088000       FROM BL-BLANK-LINE                                         08780000
088100         AFTER ADVANCING 1 LINE.                                  08790000
088200*                                                                 08800000
088300     WRITE CE-REPORT-RECORD                                       08810000
088400       FROM HEADING-LINE4                                         08820000
088500         AFTER ADVANCING 1 LINE.                                  08830000
088600*                                                                 08840000
088700     WRITE CE-REPORT-RECORD                                       08850000
088800       FROM HEADING-LINE5.                                        08860000
088900*                                                                 08870000
089000     WRITE CE-REPORT-RECORD                                       08880000
089100       FROM HEADING-LINE6.                                        08890000
089200*                                                                 08900000
089300     MOVE SPACES TO CE-REPORT-RECORD.                             08910000
089400     WRITE CE-REPORT-RECORD                                       08920000
089500         AFTER ADVANCING 1 LINE.                                  08930000
089600*                                                                 08940000
089700     MOVE PC-10           TO PV-LINE-COUNT.                       08950000
089800*                                                                 08960000
089900*                                                                 08970000
090000 7000-READ-EXTRACT.                                               08980000
090100     READ CE-FILE INTO CE013-CENTRAL-STK-RPT-RECORD               08990000
090200        AT END                                                    09000000
090300           SET PS-END-OF-FILE TO TRUE                             09010000
090400     END-READ.                                                    09020000
090500*                                                                 09030000
090600*                                                                 09040000
092910                                                                  09050000
092920****************************************************************  09060000
092930*    THIS PARAGRAPH RETRIEVES THE STORE INFORMATION.           *  09070000
092940*                                                              *  09080000
092960****************************************************************  09090000
092970 7200-GET-STORE-INFORMATION.                                      09100000
092971                                                                  09110000
092972     INITIALIZE XL071-COMMAREA-REC.                               09120000
092973     MOVE CE013-DC-STORE-NMBR TO XL071-LOCATION-NUMBER.           09130000
092980                                                                  09140000
092990     CALL XL071-LOCATION-MODULE USING                             09150000
092993                                XL071-COMMAREA-REC.               09160000
092994                                                                  09170000
092995     EVALUATE TRUE                                                09180000
092996         WHEN XL071-NO-ERRORS                                     09190000
092998              MOVE XL071-LOC-NM TO PV-RPT-DC-STORE-NAME           09200000
092999                                                                  09210000
093000         WHEN XL071-LOC-NOT-FOUND                                 09220000
093001              MOVE SPACES TO PV-RPT-DC-STORE-NAME                 09230000
093002                                                                  09240000
093003         WHEN XL071-DC-ASGMT-NOT-FND                              09250000
093004              MOVE SPACES TO PV-RPT-DC-STORE-NAME                 09260000
093005              DISPLAY '7200 - DC ASGMT NOT FOUND '                09270000
093006                       XL071-LOCATION-NUMBER                      09280000
093007                                                                  09290000
093008         WHEN OTHER                                               09300000
093009              MOVE '7200-GET-STORE-INFO' TO PV-ABEND-PARA-NAME    09300100
093010              STRING 'SQL ERROR CALLING XLKUT071 - '              09300200
093011                      XL071-SQLCODE                               09300300
093012                     ' -'                                         09300400
093013                      XL071-RETURN-CODE                           09300500
093014                     ' -'                                         09300600
093015                      XL071-LOCATION-NUMBER                       09300700
093016                      DELIMITED BY SIZE                           09300800
093017                      INTO PV-DB2-OPERATION-MSG-1                 09300900
093018              MOVE XL071-SQLCODE TO PV-SQLCODE                    09301000
093019              PERFORM 9998-SQL-ABEND                              09302000
093029                                                                  09302100
093030     END-EVALUATE.                                                09302200
093031                                                                  09302300
093100******************************************************************09302400
093200*     CLOSE FILES.                                              **09302500
093300******************************************************************09302600
093400 9000-END-PROCESS.                                                09302700
093500     PERFORM 6850-PRINT-REPORT-TOTALS.                            09302800
093600     PERFORM 6875-PRINT-SUMMARY.                                  09302900
093700*                                                                 09303000
093800     WRITE CE-REPORT-RECORD                                       09304000
093900       FROM BL-BLANK-LINE                                         09305000
094000         AFTER ADVANCING 2 LINES.                                 09306000
094100*                                                                 09307000
094200     IF PS-END-OF-FILE AND                                        09308000
094300        PS-FIRST-TIME-YES                                         09309000
094400           PERFORM 6900-NO-DETAIL                                 09310000
094500     END-IF.                                                      09320000
094600                                                                  09330000
094700     WRITE CE-REPORT-RECORD                                       09340000
094800       FROM END-OF-REPORT-LINE                                    09350000
094900         AFTER ADVANCING 3 LINES.                                 09360000
095000                                                                  09370000
095100     WRITE CE-REPORT-RECORD                                       09380000
095200       FROM BL-BLANK-LINE                                         09390000
095300         AFTER ADVANCING 2 LINES.                                 09400000
095400                                                                  09410000
095500     CLOSE CE-FILE                                                09420000
095600           CE-REPORT-FILE.                                        09430000
095700*                                                                 09440000
095800*                                                                 09450000
095900******************************************************************09460000
096000*     SQL ERROR PROCESSING                                      **09470000
096100******************************************************************09480000
096200 9998-SQL-ABEND.                                                  09490000
096300     MOVE SQLCODE     TO PV-SQLCODE.                              09500000
096400     DISPLAY '** ABEND           ** = SQLABEND'.                  09510000
096500     DISPLAY '** PROGRAM         ** = ' PC-PROGRAM-NAME.          09520000
096600     DISPLAY '** PARAGRAPH       ** = ' PV-ABEND-PARA-NAME        09530000
096700     DISPLAY '** TABLE AFFECTED  ** = ' PV-DB2-TABLE-NAME.        09540000
096800     DISPLAY '** OPERATION       ** = ' PV-DB2-OPERATION-MSG-1.   09550000
096900     DISPLAY '**                 ** = ' PV-DB2-OPERATION-MSG-2.   09560000
097000     DISPLAY '** SQLCODE         ** = ' PV-SQLCODE.               09570000
097100     COPY DPPD004.                                                09580000
097200                                                                  09590000
097300     MOVE +4013                  TO PV-ABEND-CODE.                09600000
097400     CALL 'ILBOABN0'   USING PV-ABEND-CODE.                       09610000
097500*                                                                 09620000
097600*                                                                 09630000
