000100******************************************************************00010099
000200 IDENTIFICATION DIVISION.                                         00020099
000300******************************************************************00030099
000400                                                                  00040099
000500 PROGRAM-ID.             SUKRP011.                                00050099
000600 AUTHOR.                 MICHAEL WALTERS.                         00060099
000700 INSTALLATION.           KOHLS.                                   00070099
000800 DATE-WRITTEN            OCTOBER, 1997.                           00080099
000900 DATE-COMPILED.                                                   00090099
001000                                                                  00100099
001100******************************************************************00110099
001200*       THIS PROGRAM WILL PRINT THE VENDOR AUDIT DETAIL REPORT    00120099
001300*  FROM THE VENDOR ACCURACY CARTON AUDIT SYSTEM                   00130099
001400******************************************************************00140099
001500*  CHANGED 10/05/09 BY SAURABH DUDDALWAR                        * 00150099
001600*   CHANGES ARE DONE TO HANDLE DATA CONTENTION ERRORS IN THE    * 00160099
001700*            PROGRAM WHILE REPORT GENERATION.                   * 00170099
001800***************************************************************** 00180099
001900* 02/04/14 DW BEG                                                 00190099
002000* 02/04/2014 DAVE WELLER CHG0068598 TKID: TKMA602                 00200099
002100*            CHANGES FOR RFID AUDIT PROJECT. See PGMDOC for       00210099
002200*            details.                                             00220099
002300* 02/04/14 DW END                                                 00230099
002400******************************************************************00240099
002500* 03/20/2014 JIM ARENDT  CHG0077565                               00250099
002600*            CHANGED PROGRAM HEADINGS AND DATA FIELDS IN SUKRP009,00260099
002700*            SUKRP010, SUKRP011 AND SUKRP012 SO THAT THEY ARE     00270099
002800*            CONSISTENT ACROSS THE 4 REPORTS.  ADDED CALLS TO     00280099
002900*            DETERMINE IF THE AUDIT IS A COMBO.                   00290099
003000******************************************************************00300099
003100* 03/28/2014 JIM ARENDT  CHG0078145                               00310099
003200*            CHANGED PROGRAM TO RESOLVE ERROR COUNT TOTALS.       00320099
003300******************************************************************00330099
003400* 04/01/2014 JIM ARENDT  CHG0079586                               00340099
003500*            ADDED NEW 3200- PARAGRAPH TO OPEN NEW CURSOR         00350099
003600*            (RFID_CURSOR) TO RETRIEVE THE RFID EXCEPTIONS WHICH  00360099
003700*            IS USED TO DETERMINE THE "TOTAL ERRORS" COUNT IN THE 00370099
003800*            HEADING.  ALSO, ADDED NEW PARAGRAPH 3300- TO RETRIEVE00380099
003900*            THE QA EXCEPTIONS COUNT.                             00390099
004000******************************************************************00400099
004100* 04/22/2014 JIM ARENDT  CHG0080352                               00410099
004200*            ADDED NEW PARAGRAPH 3400-RETRIEVE-UNIT-COUNT TO      00420099
004300*            RETRIEVE THE NUMBER OF UNITS IN ERROR FOR QC AUDITS. 00430099
004400******************************************************************00440099
004500* 04/28/2014 JIM ARENDT  CHG0080734                               00450099
004600*             ADDED PARA 3185-CHECK-FOR-RFID-DEPT TO CHECK IF     00460099
004700*             PO IS FOR DEPT WE'RE PROCESSING IS RFID. PERFORM    00470099
004800*             OF THIS PARA WAS ADDED TO PARA 3170-CHECK-COMBO.    00480099
004900******************************************************************00490099
004910*  CHANGED 07/28/22 BY DENISE HAHN                               *00491099
004920*              TO ALLOW REPORT TO BE SENT TO A FILE INSTEAD OF   *00492099
004930*              ACTUALLY PRINTING THE REPORT                      *00493099
004940*              ADDED A 3 "RPT" FILE THAT WILL ACTUALLY BE THE    *00494099
004950*              REPORT SENT TO A FLAT FILE.                       *00495099
004960******************************************************************00496099
004910*  CHANGED 02/14/23 BY jean kurk                 chg0281369      *00497099
004920*              remove copybook for upc check digit routine       *00498099
004960******************************************************************00499399
005000 ENVIRONMENT DIVISION.                                            00500099
005100******************************************************************00510099
005200                                                                  00520099
005300 CONFIGURATION SECTION.                                           00530099
005400                                                                  00540099
005500 SOURCE-COMPUTER.        IBM-3090.                                00550099
005600 OBJECT-COMPUTER.        IBM-3090.                                00560099
005700                                                                  00570099
005800 INPUT-OUTPUT SECTION.                                            00580099
005900                                                                  00590099
006000 FILE-CONTROL.                                                    00600099
006100                                                                  00610099
006200     SELECT OS-VENDOR-OVER-SHORT-FILE                             00620099
006300         ASSIGN TO INP01.                                         00630099
006400                                                                  00640099
006500     SELECT TE-VENDOR-TOTAL-ERROR-FILE                            00650099
006600         ASSIGN TO INP02.                                         00660099
006700                                                                  00670099
006800     SELECT OS-RECEIVER-TOTAL-ERROR-FILE                          00680099
006900         ASSIGN TO INP03.                                         00690099
007000                                                                  00700099
007100     SELECT OS-SKUTOT-OVER-SHORT-FILE                             00710099
007200         ASSIGN TO INP04.                                         00720099
007300                                                                  00730099
007400     SELECT VA-VND-AUDIT-DETAIL-RPT                               00740099
007500         ASSIGN TO RPT01.                                         00750099
007600                                                                  00760099
007700     SELECT VA-VND-AUDIT-DETAIL-RPT-LOG                           00770099
007800         ASSIGN TO RPT02.                                         00780099
007900                                                                  00790099
007910     SELECT VA-AUDIT-DETAIL-RPT-FLAT-FILE                         00791099
007920         ASSIGN TO RPT03.                                         00792099
007930                                                                  00793099
008100     SELECT CARDIN-AUDIT-NBR-FILE                                 00810099
008200         ASSIGN TO CARDIN.                                        00820099
008400                                                                  00840099
008500******************************************************************00850099
008600 DATA DIVISION.                                                   00860099
008700******************************************************************00870099
008800                                                                  00880099
008900 FILE SECTION.                                                    00890099
009000                                                                  00900099
009200 FD  CARDIN-AUDIT-NBR-FILE                                        00920099
009300     LABEL RECORDS ARE STANDARD                                   00930099
009400     RECORDING MODE IS F                                          00940099
009500     BLOCK CONTAINS 0 RECORDS                                     00950099
009600     RECORD CONTAINS 80 CHARACTERS.                               00960099
009700 01  CC-RECORD                       PIC X(80).                   00970099
009900                                                                  00990099
010000                                                                  01000099
010100 FD  OS-VENDOR-OVER-SHORT-FILE                                    01010099
010200     RECORDING MODE IS F                                          01020099
010300     LABEL RECORDS ARE STANDARD                                   01030099
010400     BLOCK CONTAINS 0 RECORDS.                                    01040099
010500                                                                  01050099
010600 01  OS-VENDOR-OVER-SHORT-RECORD         PIC  X(200).             01060099
010700                                                                  01070099
010800 FD  TE-VENDOR-TOTAL-ERROR-FILE                                   01080099
010900     RECORDING MODE IS F                                          01090099
011000     LABEL RECORDS ARE STANDARD                                   01100099
011100     BLOCK CONTAINS 0 RECORDS.                                    01110099
011200                                                                  01120099
011300 01  TE-VENDOR-TOTAL-ERROR-RECORD        PIC  X(200).             01130099
011400                                                                  01140099
011500 FD  OS-RECEIVER-TOTAL-ERROR-FILE                                 01150099
011600     RECORDING MODE IS F                                          01160099
011700     LABEL RECORDS ARE STANDARD                                   01170099
011800     BLOCK CONTAINS 0 RECORDS.                                    01180099
011900                                                                  01190099
012000 01  OS-RECEIVER-TOTAL-ERROR-RECORD      PIC  X(200).             01200099
012100                                                                  01210099
012200 FD  OS-SKUTOT-OVER-SHORT-FILE                                    01220099
012300     RECORDING MODE IS F                                          01230099
012400     LABEL RECORDS ARE STANDARD                                   01240099
012500     BLOCK CONTAINS 0 RECORDS.                                    01250099
012600                                                                  01260099
012700 01  OS-SKUTOT-OVER-SHORT-RECORD         PIC  X(200).             01270099
012800                                                                  01280099
012900 FD  VA-VND-AUDIT-DETAIL-RPT                                      01290099
013000     RECORDING MODE IS F                                          01300099
013100     LABEL RECORDS ARE STANDARD                                   01310099
013200     BLOCK CONTAINS 0 RECORDS.                                    01320099
013300                                                                  01330099
013400 01  VA-VND-AUDIT-DETAIL-LINE            PIC  X(132).             01340099
013500                                                                  01350099
013600 FD  VA-VND-AUDIT-DETAIL-RPT-LOG                                  01360099
013700     RECORDING MODE IS F                                          01370099
013800     LABEL RECORDS ARE STANDARD                                   01380099
013900     BLOCK CONTAINS 0 RECORDS.                                    01390099
014000                                                                  01400099
014100 01  VA-VND-AUDIT-DETAIL-LINE-LOG        PIC  X(132).             01410099
014200                                                                  01420099
014210 FD  VA-AUDIT-DETAIL-RPT-FLAT-FILE                                01421099
014220     RECORDING MODE IS F                                          01422099
014230     LABEL RECORDS ARE STANDARD                                   01423099
014240     BLOCK CONTAINS 0 RECORDS.                                    01424099
014250                                                                  01425099
014260 01  VA-VND-AUDIT-DETAIL-LINE-FLAT       PIC  X(132).             01426099
014270                                                                  01427099
014300******************************************************************01430099
014400 WORKING-STORAGE SECTION.                                         01440099
014500******************************************************************01450099
014600                                                                  01460099
014700*    XL DOMAIN LOCATION MODULE                                    01470099
014800     COPY XLWS071.                                                01480099
014810                                                                  01481099
014900* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 01490099
015000*  STANDARD REPORT HEADER FOR A 132 COLUMN REPORT.                01500099
015100* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 01510099
015200     COPY DPWS132O.                                               01520099
015300                                                                  01530099
015400* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 01540099
015500*  COPYBOOK MEMBER OF PRINTER LINE COMMANDS TO BE USED WITH     * 01550099
015600*  PRINTEK PRINTERS                                             * 01560099
015700* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 01570099
015800     COPY DSWS004.                                                01580099
015900                                                                  01590099
016000* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 01600099
016100*  WORK AREA FOR SQL ERROR ROUTINE 'DSNTIAR'                      01610099
016200* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 01620099
016300     COPY DPWS004.                                                01630099
016400                                                                  01640099
016500******************************************************************01650099
016600*  NUMERIC EDIT ROUTINE COMMAREA                                  01660099
016700******************************************************************01670099
016800     COPY DPWS010I.                                               01680099
016900                                                                  01690099
017000                                                                  01700099
017100* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 01710099
017200*  COPYBOOK FOR XLKUT001.                         WR # 21361    * 01720099
017300* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 01730099
017400     COPY XLWS001.                                                01740099
017500******************************************************************01750099
017600*  CHANGES MADE FOR WR # 21361 ENDS HERE                         *01760099
017700******************************************************************01770099
017800                                                                  01780099
017900 01  ABEND-CODE                          PIC S9(04) VALUE +0      01790099
018000                                                     COMP SYNC.   01800099
018100******************************************************************01810099
018200*     PAGE HEADINGS        PAGE HEADINGS         PAGE HEADING    *01820099
018300******************************************************************01830099
018400 01  PH2-PAGE-HEADING-2.                                          01840099
018500     05  FILLER                          PIC  X(52)  VALUE SPACE. 01850099
018600     05  FILLER                          PIC  X(28)  VALUE        01860099
018700         'VENDOR ACCURACY CARTON AUDIT'.                          01870099
018800     05  FILLER                          PIC  X(52)  VALUE SPACE. 01880099
018900                                                                  01890099
019000 01  PH3-PAGE-HEADING-3.                                          01900099
019100     05  FILLER                          PIC  X(56)  VALUE SPACE. 01910099
019200     05  FILLER                          PIC  X(20)  VALUE        01920099
019300         'VENDOR AUDIT DETAIL'.                                   01930099
019400     05  FILLER                          PIC  X(56)  VALUE SPACE. 01940099
019500                                                                  01950099
019600******************************************************************01960099
019700 01  AH1-AUDIT-HEADING-1.                                         01970099
019800     05  FILLER                          PIC  X(02)  VALUE SPACE. 01980099
020000     05  FILLER                          PIC  X(16)  VALUE        02000099
020100         'AUDIT CONTROL #:'.                                      02010099
020200     05  FILLER                          PIC  X(01)  VALUE SPACE. 02020099
020300     05  AH1-AUD-CNTL-NBR                PIC  9(09)  VALUE ZERO.  02030099
020400     05  FILLER                          PIC  X(22)  VALUE SPACE. 02040099
020600     05  FILLER                          PIC  X(14)  VALUE        02060099
020700         'AUDIT STATUS.:'.                                        02070099
020800     05  FILLER                          PIC  X(02)  VALUE SPACE. 02080099
020900     05  AH1-AUDIT-STATUS                PIC  X(10)  VALUE SPACE. 02090099
021000     05  FILLER                          PIC  X(17)  VALUE SPACE. 02100099
021200     05  FILLER                          PIC  X(17)  VALUE        02120099
021300         'FACILITY........:'.                                     02130099
021400     05  AH1-OPER-UNT-ID                 PIC  ZZZ9   VALUE ZERO.  02140099
021500     05  FILLER                          PIC  X(01)  VALUE '-'.   02150099
021600     05  AH1-FACILITY-DESC               PIC  X(17)  VALUE SPACE. 02160099
021700                                                                  02170099
021800***************************************************************** 02180099
021900 01  AH2-AUDIT-HEADING-2.                                         02190099
022000     05  FILLER                          PIC  X(02)  VALUE SPACE. 02200099
022200     05  FILLER                          PIC  X(16)  VALUE        02220099
022300         'VENDOR NAME....:'.                                      02230099
022400     05  FILLER                          PIC  X(01)  VALUE SPACE. 02240099
022500     05  AH2-VENDOR-NAME                 PIC  X(30)  VALUE SPACE. 02250099
022600     05  FILLER                          PIC  X(01)  VALUE SPACE. 02260099
022800     05  FILLER                          PIC  X(14)  VALUE        02280099
022900         'DEPT.........:'.                                        02290099
023000     05  FILLER                          PIC  X(02)  VALUE SPACE. 02300099
023100     05  AH2-DEPT                        PIC  X(03)  VALUE SPACE. 02310099
023200     05  FILLER                          PIC  X(63)  VALUE SPACE. 02320099
023300                                                                  02330099
023400***************************************************************** 02340099
023500 01  AH3-AUDIT-HEADING-3.                                         02350099
023600     05  FILLER                          PIC  X(02)  VALUE SPACE. 02360099
023800     05  FILLER                          PIC  X(16)  VALUE        02380099
023900         'PO/RECEIVER....:'.                                      02390099
024000     05  FILLER                          PIC  X(01)  VALUE SPACE. 02400099
024100     05  AH3-PO                          PIC  Z(07)9 VALUE ZERO.  02410099
024200     05  FILLER                          PIC  X(01)  VALUE '-'.   02420099
024300     05  AH3-RECEIVER                    PIC  999    VALUE ZERO.  02430099
024400     05  FILLER                          PIC  X(19)  VALUE SPACE. 02440099
024600     05  FILLER                          PIC  X(14)  VALUE        02460099
024700         'PBS INDICATOR:'.                                        02470099
024800     05  FILLER                          PIC  X(02)  VALUE SPACE. 02480099
024900     05  AH3-PBS-IND                     PIC  X(01)  VALUE SPACE. 02490099
025000     05  FILLER                          PIC  X(26)  VALUE SPACE. 02500099
025200     05  FILLER                          PIC  X(17)  VALUE        02520099
025300         'UNITS TRNSCRIBED:'.                                     02530099
025400     05  FILLER                          PIC  X(04)  VALUE SPACE. 02540099
025500     05  AH3-TOT-UNITS-TRNSCRIBED        PIC Z,ZZZ,ZZ9 VALUE ZERO.02550099
025600     05  FILLER                          PIC  X(09)  VALUE SPACE. 02560099
025700                                                                  02570099
025800***************************************************************** 02580099
025900 01  AH4-AUDIT-HEADING-4.                                         02590099
026000     05  FILLER                          PIC  X(02)  VALUE SPACE. 02600099
026200     05  FILLER                          PIC  X(16)  VALUE        02620099
026300         'AUDIT TYPE.....:'.                                      02630099
026400     05  FILLER                          PIC  X(01)  VALUE SPACE. 02640099
026500     05  AH4-AUDIT-TYPE                  PIC  X(10)  VALUE SPACE. 02650099
026600     05  FILLER                          PIC  X(21)  VALUE SPACE. 02660099
026800     05  FILLER                          PIC  X(14)  VALUE        02680099
026900         'NEW STORE IND:'.                                        02690099
027000     05  FILLER                          PIC  X(02)  VALUE SPACE. 02700099
027100     05  AH4-NEW-STR-IND                 PIC  X(01)  VALUE SPACE. 02710099
027200     05  FILLER                          PIC  X(26)  VALUE SPACE. 02720099
027400     05  FILLER                          PIC  X(17)  VALUE        02740099
027500         'CARTONS AUDITED.:'.                                     02750099
027600     05  FILLER                          PIC  X(04)  VALUE SPACE. 02760099
027700     05  AH4-TOT-CTNS-AUDITED            PIC Z,ZZZ,ZZ9 VALUE ZERO.02770099
027800     05  FILLER                          PIC  X(09)  VALUE SPACE. 02780099
027900                                                                  02790099
028000***************************************************************** 02800099
028100 01  AH5-AUDIT-HEADING-5.                                         02810099
028200     05  FILLER                          PIC  X(02)  VALUE SPACE. 02820099
028400     05  FILLER                          PIC  X(16)  VALUE        02840099
028500         'RECEIPT DATE...:'.                                      02850099
028600     05  FILLER                          PIC  X(01)  VALUE SPACE. 02860099
028700     05  AH5-RECEIPT-DATE                PIC  X(10)  VALUE SPACE. 02870099
028800     05  FILLER                          PIC  X(103) VALUE SPACE. 02880099
028900                                                                  02890099
029000***************************************************************** 02900099
029100 01  AH6-AUDIT-HEADING-6.                                         02910099
029200     05  FILLER                          PIC  X(93)  VALUE SPACE. 02920099
029400     05  FILLER                          PIC  X(17)  VALUE        02940099
029500         'UNITS AUDITED...:'.                                     02950099
029600     05  FILLER                          PIC  X(04)  VALUE SPACE. 02960099
029700     05  AH6-TOT-UNITS-AUDITED           PIC Z,ZZZ,ZZ9 VALUE ZERO.02970099
029800     05  FILLER                          PIC  X(09)  VALUE SPACE. 02980099
029900                                                                  02990099
030000***************************************************************** 03000099
030100 01  AH7-AUDIT-HEADING-7.                                         03010099
030200     05  FILLER                          PIC  X(02)  VALUE SPACE. 03020099
030400     05  FILLER                          PIC  X(16)  VALUE        03040099
030500         'AUDIT CATEGORY.:'.                                      03050099
030600     05  FILLER                          PIC  X(01)  VALUE SPACE. 03060099
030700     05  AH7-AUDIT-CATEGORY              PIC  X(09)  VALUE SPACE. 03070099
030800     05  FILLER                          PIC  X(65)  VALUE SPACE. 03080099
031000     05  FILLER                          PIC  X(17)  VALUE        03100099
031100         'UNITS IN ERROR..:'.                                     03110099
031200     05  FILLER                          PIC  X(04)  VALUE SPACE. 03120099
031300     05  AH7-UNITS-IN-ERROR              PIC Z,ZZZ,ZZ9 VALUE ZERO.03130099
031310     05  FILLER                          PIC  X(09)  VALUE SPACE. 03131099
031400                                                                  03140099
031500***************************************************************** 03150099
031600 01  AH8-AUDIT-HEADING-8.                                         03160099
031700     05  FILLER                          PIC  X(02)  VALUE SPACE. 03170099
031900     05  FILLER                          PIC  X(16)  VALUE        03190099
032000         'AUDIT..........:'.                                      03200099
032100     05  FILLER                          PIC  X(01)  VALUE SPACE. 03210099
032200     05  AH8-AUDIT-TYPE                  PIC  X(08)  VALUE SPACE. 03220099
032300         88 AH8-PROMPTED-AUDIT           VALUE 'PROMPTED'.        03230099
032400         88 AH8-MANUAL-AUDIT             VALUE 'MANUAL  '.        03240099
032500     05  FILLER                          PIC  X(66)  VALUE SPACE. 03250099
032700     05  FILLER                          PIC  X(17)  VALUE        03270099
032800         'TOTAL ERRORS....:'.                                     03280099
032900     05  FILLER                          PIC  X(04)  VALUE SPACE. 03290099
033000     05  AH8-TOT-ERRORS                  PIC Z,ZZZ,ZZ9 VALUE ZERO.03300099
033100     05  FILLER                          PIC  X(09)  VALUE SPACE. 03310099
033200                                                                  03320099
033300***************************************************************** 03330099
033400 01  AH9-AUDIT-HEADING-9.                                         03340099
033500     05  FILLER                          PIC  X(02)  VALUE SPACE. 03350099
033700     05  FILLER                          PIC  X(16)  VALUE        03370099
033800         'DESIGNATION....:'.                                      03380099
033900     05  FILLER                          PIC  X(01)  VALUE SPACE. 03390099
034000     05  AH9-COMBO-IND                   PIC  X(05)  VALUE SPACE. 03400099
034100         88 AH9-COMBO                    VALUE 'COMBO'.           03410099
034200         88 AH9-NOT-COMBO                VALUE '     '.           03420099
034300     05  FILLER                          PIC  X(69)  VALUE SPACE. 03430099
034500     05  FILLER                          PIC  X(17)  VALUE        03450099
034600         'ERROR RATIO.....:'.                                     03460099
034700     05  FILLER                          PIC  X(07)  VALUE SPACE. 03470099
034800     05  AH9-ERROR-RATIO                 PIC ZZ9.99  VALUE ZERO.  03480099
034900     05  AH9-PERCENT                     PIC  X(01)  VALUE '%'.   03490099
034910     05  FILLER                          PIC  X(08)  VALUE SPACE. 03491099
035000                                                                  03500099
035100******************************************************************03510099
035200*     DETAIL HEADINGS      DETAIL HEADINGS       DETAIL HEADINGS *03520099
035300******************************************************************03530099
035400******************************************************************03540099
035500 01  DH1-DETAIL-HEADING-1.                                        03550099
035600     05  FILLER                          PIC  X(26)  VALUE SPACE. 03560099
035700     05  FILLER                          PIC  X(42)  VALUE        03570099
035800         '----- P U R C H A S E  O R D E R  L I N E '.            03580099
035900     05  FILLER                          PIC  X(42)  VALUE        03590099
036000         ' D E T A I L ----  ----- E R R O R  I N F '.            03600099
036100     05  FILLER                          PIC  X(22)  VALUE        03610099
036200         'O R M A T I O N ------'.                                03620099
036300                                                                  03630099
036400                                                                  03640099
036500******************************************************************03650099
036600 01  DH2-DETAIL-HEADING-2.                                        03660099
036700     05  FILLER                          PIC  X(03)  VALUE        03670099
036800         'STR'.                                                   03680099
036900     05  FILLER                          PIC  X(01)  VALUE SPACES.03690099
037000     05  FILLER                          PIC  X(21)  VALUE        03700099
037100         '                     '.                                 03710099
037200     05  FILLER                          PIC  X(01)  VALUE SPACES.03720099
037300     05  FILLER                          PIC  X(15)  VALUE        03730099
037400         '               '.                                       03740099
037500     05  FILLER                          PIC  X(01)  VALUE SPACES.03750099
037600     05  FILLER                          PIC  X(10)  VALUE        03760099
037700         '          '.                                            03770099
037800     05  FILLER                          PIC  X(01)  VALUE SPACES.03780099
037900     05  FILLER                          PIC  X(10)  VALUE        03790099
038000         '          '.                                            03800099
038100     05  FILLER                          PIC  X(01)  VALUE SPACES.03810099
038200     05  FILLER                          PIC  X(10)  VALUE        03820099
038300         '          '.                                            03830099
038400     05  FILLER                          PIC  X(01)  VALUE SPACES.03840099
038500     05  FILLER                          PIC  X(10)  VALUE        03850099
038600         '          '.                                            03860099
038700     05  FILLER                          PIC  X(02)  VALUE SPACES.03870099
038800     05  FILLER                          PIC  X(15)  VALUE        03880099
038900         '               '.                                       03890099
039000     05  FILLER                          PIC  X(01)  VALUE SPACES.03900099
039100     05  FILLER                          PIC  X(04)  VALUE        03910099
039200         '    '.                                                  03920099
039300     05  FILLER                          PIC  X(01)  VALUE SPACES.03930099
039400     05  FILLER                          PIC  X(04)  VALUE        03940099
039500         '    '.                                                  03950099
039600     05  FILLER                          PIC  X(01)  VALUE SPACES.03960099
039700     05  FILLER                          PIC  X(08)  VALUE        03970099
039800         'RECEIVED'.                                              03980099
039900     05  FILLER                          PIC  X(04)  VALUE SPACES.03990099
040000     05  FILLER                          PIC  X(07)  VALUE        04000099
040100         'ORDERED'.                                               04010099
040200                                                                  04020099
040300******************************************************************04030099
040400******************************************************************04040099
040500*  CHANGED THE DETAIL-HEADING-3 STRUCTURE TO DISPLAY 'CL SKU'    *04050099
040600*  INSTEAD OF 'DEPT CL SKU' AND CHANGED FILLER ACCORDINGLY.      *04060099
040700*                                          WR # 21361            *04070099
040800******************************************************************04080099
040900 01  DH3-DETAIL-HEADING-3.                                        04090099
041000     05  FILLER                          PIC  X(03)  VALUE        04100099
041100         'NBR'.                                                   04110099
041200     05  FILLER                          PIC  X(01)  VALUE SPACES.04120099
041300     05  FILLER                          PIC  X(21)  VALUE        04130099
041400         'SERIAL SHIP CODE     '.                                 04140099
041500     05  FILLER                          PIC  X(01)  VALUE SPACES.04150099
041600     05  FILLER                          PIC  X(11)  VALUE        04160099
041700         'CL SKU'.                                                04170099
041800     05  FILLER                          PIC  X(01)  VALUE SPACES.04180099
041900     05  FILLER                          PIC  X(15)  VALUE        04190099
042000         'UPC            '.                                       04200099
042100     05  FILLER                          PIC  X(01)  VALUE SPACES.04210099
042200     05  FILLER                          PIC  X(10)  VALUE        04220099
042300         'STYLE NBR '.                                            04230099
042400     05  FILLER                          PIC  X(01)  VALUE SPACES.04240099
042500     05  FILLER                          PIC  X(10)  VALUE        04250099
042600         'COLOR     '.                                            04260099
042700     05  FILLER                          PIC  X(01)  VALUE SPACES.04270099
042800     05  FILLER                          PIC  X(10)  VALUE        04280099
042900         'SIZE      '.                                            04290099
043000     05  FILLER                          PIC  X(01)  VALUE SPACES.04300099
043100     05  FILLER                          PIC  X(15)  VALUE        04310099
043200         'DESCRIPTION    '.                                       04320099
043300     05  FILLER                          PIC  X(01)  VALUE SPACES.04330099
043400     05  FILLER                          PIC  X(04)  VALUE        04340099
043500         ' QTY'.                                                  04350099
043600     05  FILLER                          PIC  X(01)  VALUE SPACES.04360099
043700     05  FILLER                          PIC  X(04)  VALUE        04370099
043800         'TYP '.                                                  04380099
043900     05  FILLER                          PIC  X(01)  VALUE SPACES.04390099
044000     05  FILLER                          PIC  X(08)  VALUE        04400099
044100         '   AS   '.                                              04410099
044200     05  FILLER                          PIC  X(03)  VALUE SPACES.04420099
044300     05  FILLER                          PIC  X(08)  VALUE        04430099
044400         '   AS   '.                                              04440099
044800                                                                  04480099
044900******************************************************************04490099
045000 01  DL-DETAIL-LINE.                                              04500099
045100     05  DL-STR-NBR                      PIC  ZZ9.                04510099
045200     05  DL-STR-NBR-X REDEFINES                                   04520099
045300         DL-STR-NBR                      PIC  X(03).              04530099
045400     05  FILLER                          PIC  X(01)  VALUE SPACES.04540099
045500     05  DL-SHIP-UNIT-ID.                                         04550099
045600         10 DL-SHIP-UNIT-ID-1            PIC  9.                  04560099
045700         10 FILLER                       PIC  X      VALUE ' '.   04570099
045800         10 DL-SHIP-UNIT-ID-2-8          PIC  9(07).              04580099
045900         10 FILLER                       PIC  X      VALUE ' '.   04590099
046000         10 DL-SHIP-UNIT-ID-9-17         PIC  9(09).              04600099
046100         10 FILLER                       PIC  X      VALUE ' '.   04610099
046200         10 DL-SHIP-UNIT-ID-18           PIC  9.                  04620099
046300     05  FILLER                          PIC  X(01)  VALUE SPACES.04630099
046800     05  DL-SKU-NBR.                                              04680099
046900         10  DL-SKU-NBR-CLASS            PIC  X(02).              04690099
047000         10  FILLER                      PIC  X      VALUE SPACES.04700099
047100         10  DL-SKU-NBR-8DGT             PIC  X(08).              04710099
047200     05  FILLER                          PIC  X(01)  VALUE SPACES.04720099
047600     05  DL-UPC-INFORMATION.                                      04760099
047700         10 DL-UPC-NBR                   PIC  9(15).              04770099
047800         10 DL-UPC-NBR-X REDEFINES                                04780099
047900            DL-UPC-NBR                   PIC  X(15).              04790099
048000     05  FILLER                          PIC  X(01)  VALUE SPACES.04800099
048100     05  DL-STYLE-NBR                    PIC  X(10).              04810099
048200     05  FILLER                          PIC  X(01)  VALUE SPACES.04820099
048300     05  DL-COLOR                        PIC  X(10).              04830099
048400     05  FILLER                          PIC  X(01)  VALUE SPACES.04840099
048500     05  DL-SIZE                         PIC  X(10).              04850099
048600     05  FILLER                          PIC  X(01)  VALUE SPACE. 04860099
048700     05  DL-ERROR-DESC                   PIC  X(15).              04870099
048800     05  FILLER                          PIC  X(01)  VALUE SPACES.04880099
048900     05  DL-ERROR-QTY                    PIC  ZZZ9.               04890099
049000     05  FILLER                          PIC  X(01)  VALUE SPACES.04900099
049100     05  DL-ERROR-TYPE                   PIC  X(04).              04910099
049200     05  FILLER                          PIC  X(01)  VALUE SPACES.04920099
049300     05  DL-RECEIVED-AS-TEXT             PIC  X(09).              04930099
049400     05  FILLER                          PIC  X(01)  VALUE SPACES.04940099
049500     05  DL-ORDERED-AS-TEXT              PIC  X(09).              04950099
049600     05  DL-ORDERED-AS-TEXT-9 REDEFINES                           04960099
049700         DL-ORDERED-AS-TEXT              PIC  9(09).              04970099
049800                                                                  04980099
049900******************************************************************04990099
050000*     TOTAL FOOTERS        TOTAL FOOTERS         TOTAL FOOTERS   *05000099
050100******************************************************************05010099
050200******************************************************************05020099
050300 01  FH-FOOTER-HEADING-LINE.                                      05030099
050400     05  FILLER                          PIC  X(37) VALUE         05040099
050500         '----------- ERROR SUMMARY -----------'.                 05050099
050510     05  FILLER                          PIC  X(95)  VALUE SPACE. 05051099
050600                                                                  05060099
050700******************************************************************05070099
050800 01  FD-FOOTER-DETAIL-LINE.                                       05080099
050900     05  FD-FOOTER-DETAIL-DESC           PIC  X(25).              05090099
051000     05  FILLER                          PIC  X(01)  VALUE SPACE. 05100099
051100     05  FD-FOOTER-DETAIL-QTY            PIC  ZZ,ZZ9.             05110099
051200     05  FD-FOOTER-DETAIL-QTY-X REDEFINES                         05120099
051300         FD-FOOTER-DETAIL-QTY            PIC  X(06).              05130099
051310     05  FILLER                          PIC  X(100) VALUE SPACE. 05131099
051400                                                                  05140099
051500******************************************************************05150099
051600*     RECEIVER OVER/SHORT MESSAGE                                *05160099
051700******************************************************************05170099
051800 01  RM-RECEIVER-MESSAGE-LINE-1.                                  05180099
051900     05  FILLER                          PIC  X(32) VALUE ALL '*'.05190099
052000     05  FILLER                          PIC  X(38) VALUE         05200099
052100         '  RECEIVER LEVEL OVER/SHORTAGE EXISTS '.                05210099
052200     05  FILLER                          PIC  X(22) VALUE         05220099
052300         'FOR THIS PO/RECEIVER  '.                                05230099
052400     05  FILLER                          PIC  X(32) VALUE ALL '*'.05240099
052410     05  FILLER                          PIC  X(08) VALUE SPACE.  05241099
052500                                                                  05250099
052600 01  RM-RECEIVER-MESSAGE-LINE-2.                                  05260099
052700     05  FILLER                          PIC X(124) VALUE ALL '*'.05270099
052810     05  FILLER                          PIC  X(08) VALUE SPACE.  05281099
052820                                                                  05282099
052900 01  BLANK-LINE.                                                  05290099
053000     05  FILLER                          PIC  X(132) VALUE SPACE. 05300099
053100                                                                  05310099
053200                                                                  05320099
053300 01  END-OF-REPORT-LINE.                                          05330099
053400     05  FILLER                          PIC  X(54)  VALUE SPACE. 05340099
053500     05  FILLER                          PIC  X(25)  VALUE        05350099
053600         '***** END OF REPORT *****'.                             05360099
053700     05  FILLER                          PIC  X(53)  VALUE SPACE. 05370099
053800                                                                  05380099
054200 01  RE-REPORT-ERROR-1.                                           05420099
054300     05  FILLER                  PIC  X(07)  VALUE ' AUDIT:'.     05430099
054400     05  RE-AUD-CNTL-NBR         PIC  9(09)  VALUE ZERO.          05440099
054500     05  FILLER                  PIC  X(03)  VALUE SPACE.         05450099
054600     05  FILLER                  PIC  X(08)  VALUE 'PO-RCVR:'.    05460099
054700     05  RE-PO                   PIC  9(08)  VALUE ZERO.          05470099
054800     05  FILLER                  PIC  X(01)  VALUE '-'.           05480099
054900     05  RE-RCVR                 PIC  9(04)  VALUE ZERO.          05490099
055000     05  FILLER                  PIC  X(05)  VALUE SPACE.         05500099
055100     05  FILLER                  PIC  X(53)  VALUE                05510099
055200         '**** RECEIVER DOES NOT EXIST - PLEASE TRANSCRIBE ****'. 05520099
055300     05  FILLER                          PIC  X(34)  VALUE SPACE. 05530099
055700                                                                  05570099
055800 01  NO-DATA-LINE.                                                05580099
055900     05  FILLER                          PIC  X(49)  VALUE SPACE. 05590099
056000     05  FILLER                          PIC  X(35)  VALUE        05600099
056100         '********* NO DATA TO REPORT *******'.                   05610099
056200     05  FILLER                          PIC  X(48)  VALUE SPACE. 05620099
056300                                                                  05630099
056800                                                                  05680099
056900 01  DK-DB2-KEY-VALUE.                                            05690099
057000     05  DK-OPER-UNT-ID                  PIC S9(04) COMP.         05700099
057100     05  DK-STORE-NBR                    PIC S9(04) COMP.         05710099
057200     05  DK-SHIPT-UNT-ID                 PIC S9(18) COMP-3.       05720099
057300     05  DK-AUD-CNTL-NBR                 PIC S9(09) COMP.         05730099
057400     05  DK-UPC-NBR                      PIC S9(15) COMP-3.       05740099
057500     05  DK-PO-NBR                       PIC S9(09) COMP.         05750099
057600     05  DK-REC-SEQ-NBR                  PIC S9(09) COMP.         05760099
057700     05  DK-DEPT-NBR                     PIC S9(04) COMP-3.       05770099
057710     05  DK-SKU-NBR                      PIC S9(8)V COMP-3.       05771099
057800                                                                  05780099
058300 01  PA-PROGRAM-ACCUMULATORS.                                     05830099
058400     05  PA-PIC-ERROR-SUMMARY-TABLE.                              05840099
058500       07 FILLER OCCURS 25 TIMES.                                 05850099
058600         10 PA-PIC-ERROR-DESC.                                    05860099
058700             15 FILLER                 PIC   X(05) VALUE SPACES.  05870099
058800             15 PA-PIC-ERROR           PIC   X(15).               05880099
058900         10 PA-PIC-ERROR-QTY           PIC  S9(04) COMP.          05890099
059000                                                                  05900099
059100     05  PA-TIC-ERROR-SUMMARY-TABLE.                              05910099
059200       07 FILLER OCCURS 25 TIMES.                                 05920099
059300         10 PA-TIC-ERROR-DESC.                                    05930099
059400             15 FILLER                 PIC   X(05) VALUE SPACES.  05940099
059500             15 PA-TIC-ERROR           PIC   X(15).               05950099
059600         10 PA-TIC-ERROR-QTY           PIC  S9(04) COMP.          05960099
059700                                                                  05970099
059900     05  PA-RFID-ERROR-SUMMARY-TABLE.                             05990099
060000       07 FILLER OCCURS 25 TIMES.                                 06000099
060100         10 PA-RFID-ERROR-DESC.                                   06010099
060200             15 FILLER                 PIC   X(05) VALUE SPACES.  06020099
060300             15 PA-RFID-ERROR          PIC   X(15).               06030099
060400         10 PA-RFID-ERROR-QTY          PIC  S9(04) COMP.          06040099
060600                                                                  06060099
060700                                                                  06070099
060800 01  PC-CONSTANTS.                                                06080099
060900     05  PC-MAX-REPORT-LINES             PIC S9(04)  VALUE +60    06090099
061000                                                     COMP SYNC.   06100099
061100     05  PC-BLANK-LINE                   PIC X(132) VALUE SPACES. 06110099
061200     05  PC-ZERO                         PIC  9(01)  VALUE 0.     06120099
061300     05  PC-ONE                          PIC  9(01)  VALUE 1.     06130099
061400     05  PC-TWO                          PIC  9(01)  VALUE 2.     06140099
061500     05  PC-THREE                        PIC  9(01)  VALUE 3.     06150099
061600     05  PC-FOUR                         PIC  9(01)  VALUE 4.     06160099
061700     05  PC-EIGHT                        PIC  9(01)  VALUE 8.     06170099
061800     05  PC-NINE                         PIC  9(01)  VALUE 9.     06180099
061900     05  PC-E                            PIC  X(01)  VALUE 'E'.   06190099
062000     05  PC-R                            PIC  X(01)  VALUE 'R'.   06200099
062100     05  PC-VA                           PIC  X(02)  VALUE 'VA'.  06210099
062200     05  PC-KOHLS-OPERATING-COMPANY      PIC  X(02)  VALUE '03'.  06220099
062300     05  PC-NINES-TIMESTAMP              PIC  X(26)  VALUE        06230099
062400         '9999-09-09-09.09.09.999999'.                            06240099
062500     05  PC-CURRENT-PROGRAM-NAME         PIC  X(08)  VALUE        06250099
062600         'SUKRP011'.                                              06260099
062700     05  PC-CURRENT-JOB-NAME             PIC  X(08)  VALUE        06270099
062800         'SUK905  '.                                              06280099
063000     05  PC-RFID-VILNS.                                           06300099
063100         10  PC-RFID-UPC-MISPCK          PIC S9(4)   COMP         06310099
063200                                                     VALUE 38.    06320099
063300         10  PC-RFID-TKT-CLR             PIC S9(4)   COMP         06330099
063400                                                     VALUE 39.    06340099
063500         10  PC-RFID-TKT-SIZE            PIC S9(4)   COMP         06350099
063600                                                     VALUE 40.    06360099
063700         10  PC-RFID-TKT-STYLE           PIC S9(4)   COMP         06370099
063800                                                     VALUE 41.    06380099
063900         10  PC-RFID-NO-TICKET           PIC S9(4)   COMP         06390099
064000                                                     VALUE 42.    06400099
064200                                                                  06420099
064300 01  PC-EXCEPTIONS.                                               06430099
064400     05  PC-STYLE-SUB                    PIC S9(04)  VALUE +09.   06440099
064500     05  PC-UPC-MISDIRECT                PIC S9(04)  VALUE +12.   06450099
064600     05  PC-WRONG-TICKET-DEPT            PIC S9(04)  VALUE +13.   06460099
064700     05  PC-WRONG-TICKET-RETAIL          PIC S9(04)  VALUE +14.   06470099
064800     05  PC-WRONG-TICKET-COLOR           PIC S9(04)  VALUE +15.   06480099
064900     05  PC-WRONG-TICKET-SIZE            PIC S9(04)  VALUE +16.   06490099
065000     05  PC-WRONG-MDSE-LBL-RETAIL        PIC S9(04)  VALUE +17.   06500099
065100     05  PC-WRONG-MDSE-LBL-COLOR         PIC S9(04)  VALUE +18.   06510099
065200     05  PC-WRONG-MDSE-LBL-SIZE          PIC S9(04)  VALUE +19.   06520099
065300     05  PC-WRONG-TICKET-MAJ-CLS         PIC S9(04)  VALUE +21.   06530099
065400     05  PC-WRONG-TICKET-SUB-CLS         PIC S9(04)  VALUE +22.   06540099
065500     05  PC-WRONG-TICKET-STYLE           PIC S9(4)   VALUE +24.   06550099
065600     05  PC-WRONG-MDSE-LBL-STYLE         PIC S9(4)   VALUE +25.   06560099
065700     05  PC-WRONG-MDSE-TKT-OK            PIC S9(4)   VALUE +26.   06570099
065800     05  PC-WRONG-TKT-MDSE-OK            PIC S9(4)   VALUE +27.   06580099
065900     05  PC-NO-MDSE-TAG                  PIC S9(4)   VALUE +28.   06590099
066100     05  PC-WRG-TAGS-NO-EPC              PIC S9(4)   VALUE +38.   06610099
066200     05  PC-WRG-RFD-TGS-CLR              PIC S9(4)   VALUE +39.   06620099
066300     05  PC-WRG-RFD-TGS-SIZ              PIC S9(4)   VALUE +40.   06630099
066400     05  PC-WRG-RFD-TGS-STL              PIC S9(4)   VALUE +41.   06640099
066500     05  PC-VA-NO-EPC-LOGO               PIC S9(4)   VALUE +42.   06650099
066700                                                                  06670099
066800 01  CC-CONTROL-CARD.                                             06680099
066900     05  CC-PRINTER-ID                PIC  X(08)  VALUE SPACES.   06690099
066910         88 CC-FLAT-FILE                          VALUE 'FILE'.   06691099
067000     05  CC-PRTR-CNTL-IND             PIC  X(01)  VALUE SPACE.    06700099
067100     05  CC-TRACK-NBR                 PIC  9(01)  VALUE ZERO.     06710099
067110*                                                                 06711099
067120     05  CC-CNTL-CARD-OPER            PIC  9(04)  VALUE ZEROES.   06712099
067130     05  CC-CNTL-CARD-USERID          PIC  X(08)  VALUE SPACES.   06713099
067140     05  CC-CNTL-CARD-AUD-NBR         PIC  9(09)  VALUE ZEROES.   06714099
067150     05  FILLER                       PIC  X(47)  VALUE SPACES.   06715099
067200                                                                  06720099
067300 01  CC-CARDIN.                                                   06730099
067400     05  CC-AUDIT-CNTL-NBR           PIC 9(09).                   06740099
067500     05  CC-CARTON-ID                PIC 9(18).                   06750099
067600     05  CC-SYSTEM-MANUAL-AUDIT      PIC X(01).                   06760099
067700         88  CC-SYSTEM-GENERATED-AUDIT    VALUE 'S'.              06770099
067800         88  CC-MANUAL-GENERATED-AUDIT    VALUE 'M'.              06780099
067900     05  CC-RFID-QC-AUDIT-IND        PIC X(01).                   06790099
068000         88  CC-RFID-AUDIT                VALUE 'R'.              06800099
068100         88  CC-QC-AUDIT                  VALUE 'S'.              06810099
068200     05  CC-RFID-QC-AUD-CMB-IND      PIC X(01).                   06820099
068300         88  CC-RFID-AUD-ONLY             VALUE 'R'.              06830099
068400         88  CC-QC-AUD-ONLY               VALUE 'S'.              06840099
068500         88  CC-QC-AND-RFID-AUD           VALUE 'B'.              06850099
068900     05  CC-BRCDE-IND                 PIC  X(01)  VALUE SPACE.    06890099
069000     05  CC-PRTR-CUT-IND              PIC  X(01)  VALUE SPACE.    06900099
069100                                                                  06910099
069200 01  PS-PROGRAM-SWITCHES.                                         06920099
069400     05  PS-END-OF-CARDIN-SW             PIC  X(01)  VALUE 'N'.   06940099
069500         88  PS-END-OF-CARDIN-FILE                   VALUE 'Y'.   06950099
069600         88  PS-NOT-END-OF-CARDIN-FILE               VALUE 'N'.   06960099
069700     05  PS-MANUAL-COMBO-SW              PIC  X(01)  VALUE 'N'.   06970099
069800         88  PS-MANUAL-COMBO-AUDIT                   VALUE 'Y'.   06980099
069900         88  PS-NOT-MANUAL-COMBO-AUDIT               VALUE 'N'.   06990099
070100     05  PS-DATA-IND                     PIC  X(01)  VALUE 'N'.   07010099
070200         88  PS-DATA                                 VALUE 'Y'.   07020099
070300         88  PS-NO-DATA                              VALUE 'N'.   07030099
070400     05  PS-SIZE-FOUND-IND               PIC  X(01)  VALUE 'N'.   07040099
070500         88  PS-SIZE-FOUND                           VALUE 'Y'.   07050099
070600         88  PS-SIZE-NOT-FOUND                       VALUE 'N'.   07060099
070700     05  PS-STYLE-FOUND-IND              PIC  X(01)  VALUE 'N'.   07070099
070800         88  PS-STYLE-FOUND                          VALUE 'Y'.   07080099
070900         88  PS-STYLE-NOT-FOUND                      VALUE 'N'.   07090099
071000     05  PS-UPC-FOUND-IND                PIC  X(01)  VALUE 'N'.   07100099
071100         88  PS-UPC-FOUND                            VALUE 'Y'.   07110099
071200         88  PS-UPC-NOT-FOUND                        VALUE 'N'.   07120099
071300     05  PS-SKU-MATCH-IND                PIC  X(01)  VALUE 'N'.   07130099
071400         88  PS-SKU-MATCH                            VALUE 'Y'.   07140099
071500         88  PS-SKU-NOT-MATCH                        VALUE 'N'.   07150099
071600         88  PS-SKU-SEARCH-PROCESS                   VALUE 'S'.   07160099
071700     05  PS-PRINT-SKU-ORD-SW             PIC  X(01)  VALUE 'Y'.   07170099
071800         88  PS-PRINT-SKU-ORD                        VALUE 'Y'.   07180099
071900         88  PS-DO-NOT-PRINT-SKU-ORD                 VALUE 'N'.   07190099
072000     05  PS-EOF-VND-OVER-SHORT-IND       PIC  X(01)  VALUE 'N'.   07200099
072100         88  PS-EOF-VND-OVER-SHORT                   VALUE 'Y'.   07210099
072200         88  PS-NOT-EOF-VND-OVER-SHORT               VALUE 'N'.   07220099
072300     05  PS-EOF-RCVR-TOTAL-ERROR-IND     PIC  X(01)  VALUE 'N'.   07230099
072400         88  PS-EOF-RCVR-TOTAL-ERROR                 VALUE 'Y'.   07240099
072500         88  PS-NOT-EOF-RCVR-TOTAL-ERROR             VALUE 'N'.   07250099
072600     05  PS-EOF-SKU-TOTAL-FILE-IND       PIC  X(01)  VALUE 'N'.   07260099
072700         88  PS-EOF-SKU-TOTAL-FILE                   VALUE 'Y'.   07270099
072800         88  PS-NOT-EOF-SKU-TOTAL-FILE               VALUE 'N'.   07280099
072900     05  PS-RCVR-OVER-SHORT-IND          PIC  X(01)  VALUE 'N'.   07290099
073000         88  PS-RCVR-OVER-SHORT-FOUND                VALUE 'Y'.   07300099
073100         88  PS-NO-RCVR-OVER-SHORT                   VALUE 'N'.   07310099
073200     05  PS-EOF-VND-TOT-ERR-FILE-IND PIC X(01) VALUE 'N'.         07320099
073300         88  PS-EOF-VND-TOT-ERR-FILE                 VALUE 'Y'.   07330099
073400         88  PS-NOT-EOF-VND-TOT-ERR-FILE             VALUE 'N'.   07340099
073500     05  PS-EOC-EXCEPTION-CURSOR-IND     PIC  X(01)  VALUE 'N'.   07350099
073600         88  PS-EOC-EXCEPTION-CURSOR                 VALUE 'Y'.   07360099
073700         88  PS-NOT-EOC-EXCEPTION-CURSOR             VALUE 'N'.   07370099
073900     05  PS-EOC-QC-ERR-CSR-IND           PIC  X(01)  VALUE 'N'.   07390099
074000         88  PS-EOC-QC-ERR-CSR                       VALUE 'Y'.   07400099
074100         88  PS-NOT-EOC-QC-ERR-CSR                   VALUE 'N'.   07410099
074200     05  PS-EOC-RFID-ERR-CSR-LT42-IND    PIC X(01)   VALUE 'N'.   07420099
074300         88  PS-EOC-RFID-ERR-CSR-LT42                VALUE 'Y'.   07430099
074400         88  PS-NOT-EOC-RFID-ERR-CSR-LT42            VALUE 'N'.   07440099
074500     05  PS-EOC-RFID-ERR-CSR-EQ42-IND    PIC  X(01)  VALUE 'N'.   07450099
074600         88  PS-EOC-RFID-ERR-CSR-EQ42                VALUE 'Y'.   07460099
074700         88  PS-NOT-EOC-RFID-ERR-CSR-EQ42            VALUE 'N'.   07470099
074800     05  PS-PO-EXCEPTION-SW              PIC  X(01)  VALUE SPACE. 07480099
074900         88 PS-PO-EXCEPTION                          VALUE 'Y'.   07490099
075000         88 PS-NO-PO-EXCEPTION                       VALUE 'N'.   07500099
075100     05  PS-VENDOR-RFID-AGRMNT-SW        PIC  X(01)  VALUE SPACE. 07510099
075200         88 PS-VENDOR-TAGGING                        VALUE 'T'.   07520099
075300         88 PS-VENDOR-COMPLIANT                      VALUE 'C'.   07530099
075400         88 PS-VENDOR-NOT-TAGGING                    VALUE 'N'.   07540099
075500     05  PS-END-OF-RFID-CURSOR-IND       PIC  X(01)  VALUE 'N'.   07550099
075600         88  PS-END-OF-RFID-CURSOR                   VALUE 'Y'.   07560099
075700         88  PS-NOT-END-OF-RFID-CURSOR               VALUE 'N'.   07570099
076000     05  PS-RFID-DEPT-IND                PIC  X(01)  VALUE 'N'.   07600099
076100         88  PS-RFID-DEPT-YES                        VALUE 'Y'.   07610099
076200         88  PS-RFID-DEPT-NO                         VALUE 'N'.   07620099
076400                                                                  07640099
076500 01  PV-PROGRAM-VARIABLES.                                        07650099
076600     05  PV-DISPLAY-DEST                 PIC  9(4).               07660099
076610     05  PV-DISPLAY-SKU                  PIC  9(8).               07661099
076700     05  PV-ERROR-DESC                   PIC  X(15).              07670099
076800         88 PV-VND-OVER          VALUE 'VENDOR OVER    '.         07680099
076900         88 PV-VND-OVER-MISPCK   VALUE 'VND OVER/MISPCK'.         07690099
077000         88 PV-VND-SHORT         VALUE 'VENDOR SHORT   '.         07700099
077100         88 PV-RCVR-OVER         VALUE 'RCVR OVER      '.         07710099
077200         88 PV-RCVR-SHORT        VALUE 'RCVR SHORT     '.         07720099
077300         88 PV-NO-BARCODE        VALUE 'NO BARCODE     '.         07730099
077400         88 PV-DMG-BARCODE       VALUE 'DMG BARCODE    '.         07740099
077500         88 PV-NO-UPC            VALUE 'NO UPC         '.         07750099
077600         88 PV-UPC-NOT-IN-SYS    VALUE 'UPC NOT IN SYS '.         07760099
077700         88 PV-SKU-NOT-IN-SYS    VALUE 'SKU NOT IN SYST'.         07770099
077800         88 PV-NO-TKT-ON-MDSE    VALUE 'NO TKT ON MDSE '.         07780099
077900         88 PV-STYLE-SUB         VALUE 'STYLE SUB      '.         07790099
078000         88 PV-NO-DC-OTR         VALUE 'NO DC OTR      '.         07800099
078100         88 PV-NO-ALLOC          VALUE 'NO ALLOC       '.         07810099
078200         88 PV-UPC-MISPACK       VALUE 'UPC MISPACK    '.         07820099
078300         88 PV-WRG-TKT-DPT       VALUE 'WRG TKT - DPT  '.         07830099
078400         88 PV-WRG-TKT-RTL       VALUE 'WRG TKT - RTL  '.         07840099
078500         88 PV-WRG-TKT-CLR       VALUE 'WRG TKT - CLR  '.         07850099
078600         88 PV-WRG-TKT-SIZE      VALUE 'WRG TKT - SIZE '.         07860099
078700         88 PV-WRG-MDSE-RTL      VALUE 'WRG MDSE - RTL '.         07870099
078800         88 PV-WRG-MDSE-CLR      VALUE 'WRG MDSE - CLR '.         07880099
078900         88 PV-WRG-MDSE-SIZE     VALUE 'WRG MDSE - SIZE'.         07890099
079000         88 PV-DMG-MDSE          VALUE 'DMG MDSE       '.         07900099
079100         88 PV-WRG-TKT-CLASS     VALUE 'WRG TKT - CLASS'.         07910099
079200         88 PV-WRG-TKT-SKU       VALUE 'WRG TKT - SKU  '.         07920099
079300         88 PV-SIZE-STRIP-ERR    VALUE 'SIZE STRIP ERR '.         07930099
079400         88 PV-WRG-TKT-STYLE     VALUE 'WRG TKT - STYLE'.         07940099
079500         88 PV-WRG-MDSE-STYLE    VALUE 'WRG MDSE- STYLE'.         07950099
079600         88 PV-WRG-BOX-ID        VALUE 'WRG BOX ID     '.         07960099
079700         88 PV-WRG-TKT-OK-MDSE   VALUE 'WRG TKT/MDSE OK'.         07970099
079800         88 PV-NO-MDSE-TAG       VALUE 'NO MDSE TAG    '.         07980099
079900                                                                  07990099
080000         88 PV-TICKETING-ERROR   VALUE 'NO BARCODE     ',         08000099
080100                                       'DMG BARCODE    ',         08010099
080200                                       'NO UPC         ',         08020099
080300                                       'UPC NOT IN SYS ',         08030099
080400                                       'SKU NOT IN SYST',         08040099
080500                                       'NO TKT ON MDSE ',         08050099
080600                                       'WRG TKT - DPT  ',         08060099
080700                                       'WRG TKT - RTL  ',         08070099
080800                                       'WRG TKT - CLR  ',         08080099
080900                                       'WRG TKT - SIZE ',         08090099
081000                                       'WRG MDSE - RTL ',         08100099
081100                                       'WRG MDSE - CLR ',         08110099
081200                                       'WRG MDSE - SIZE',         08120099
081300                                       'WRG TKT - CLASS',         08130099
081400                                       'WRG TKT - SKU  ',         08140099
081500                                       'WRG TKT - STYLE',         08150099
081600                                       'WRG MDSE- STYLE',         08160099
081700                                       'VA No Tick     ',         08170099
081800                                       'VA Dam Barcode ',         08180099
081900                                       'VA Wrg UPC     ',         08190099
082000                                       'VA WRG UPC     ',         08200099
082100                                       'NO MDSE TAG    ',         08210099
082200                                       'WRG TKT/MDSE OK',         08220099
082300                                       'WRG BOX ID     ',         08230099
082400                                       'SIZE STRIP ERR '.         08240099
082500                                                                  08250099
082600         88 PV-PICKING-ERROR     VALUE 'STYLE SUB      ',         08260099
082700                                       'NO DC OTR      ',         08270099
082800                                       'NO ALLOC       ',         08280099
082900                                       'DMG MDSE       ',         08290099
083000                                       'VENDOR OVER    ',         08300099
083100                                       'VND OVER/MISPCK',         08310099
083200                                       'VENDOR SHORT   ',         08320099
083300                                       'RCVR OVER      ',         08330099
083400                                       'RCVR SHORT     '.         08340099
083500                                                                  08350099
083600         88 PV-RFID-ERROR        VALUE 'WRG TAGS-NO EPC',         08360099
083700                                       'WRG RFD TGS-STL',         08370099
083800                                       'WRG RFD TGS-SIZ',         08380099
083900                                       'WRG RFD TGS-CLR',         08390099
084000                                       'VA NO RF TAGS  ',         08400099
084200                                       'RFID UPC MISPCK',         08420099
084400                                       'VA NO EPC LOGO '.         08440099
084600                                                                  08460099
084700     05  PV-HEADING-TOT-ERRORS           PIC S9(04) COMP.         08470099
084800     05  PV-HEADING-UNITS-IN-ERROR       PIC S9(04) COMP.         08480099
084900     05  PV-ERROR-QTY                    PIC S9(04) COMP.         08490099
085000     05  PV-TOTAL-ERROR-QTY              PIC S9(04) COMP.         08500099
085100     05  PV-ERROR-IDX                    PIC S9(04) COMP.         08510099
085200     05  PV-DISP-COMP                    PIC ZZZZZ,ZZ9.           08520099
085300     05  PV-DISP-DEC                     PIC ZZ,ZZ9.99.           08530099
085400     05  PV-HOLD-QTY-AUD                 PIC S9(09)    COMP-3     08540099
085500                                                       VALUE ZERO.08550099
085600     05  PV-HOLD-QTY-EXP                 PIC S9(09)    COMP-3     08560099
085700                                                       VALUE ZERO.08570099
085800     05  PV-OVER-QTY                     PIC S9(09)    COMP-3     08580099
085900                                                       VALUE ZERO.08590099
086000     05  PV-SHORT-QTY                    PIC S9(09)    COMP-3     08600099
086100                                                       VALUE ZERO.08610099
086200     05  PV-COUNT                        PIC S9(04)  COMP.        08620099
086300     05  PV-DB2-CARTON-COUNT             PIC S9(09) COMP.         08630099
086400     05  PV-DB2-UNIT-COUNT               PIC S9(09) COMP.         08640099
086600     05  PV-HOLD-TMST                    PIC  X(26) VALUE SPACES. 08660099
086700     05  PV-HEADER-CURSOR-COUNT          PIC S9(09) COMP.         08670099
086800     05  PV-RFID-TGD-COUNT               PIC S9(09) COMP.         08680099
086900     05  PV-SCND-UNT-COUNT               PIC S9(09) COMP.         08690099
087000     05  PV-DL-EXCEPTION-COUNT           PIC S9(09) COMP.         08700099
087100     05  PV-HL-TOTAL-ERRORS              PIC S9(09) COMP.         08710099
087200     05  PV-HL-TOTAL-UNITS-AUDITED       PIC S9(09) COMP.         08720099
087300     05  PV-HL-UNITS-IN-ERROR            PIC S9(09) COMP.         08730099
087400     05  PV-RFID-TOT-ERRORS              PIC S9(09) COMP.         08740099
087600     05  PV-RF-ERRORS                    PIC S9(09) COMP.         08760099
087700     05  PV-QC-ERRORS                    PIC S9(09) COMP.         08770099
087800     05  PV-RFID-COUNT                   PIC S9(09) VALUE +0      08780099
087900                                                    COMP.         08790099
088000     05  PV-DB2-COUNT                    PIC S9(09) VALUE +0      08800099
088100                                                    COMP.         08810099
088200     05  PV-SCAN-COUNT                   PIC S9(09) VALUE +0      08820099
088300                                                    COMP.         08830099
088400     05  PV-AUDIT-NOT-TAGGED-RFID        PIC S9(09) VALUE ZERO    08840099
088500                                                    COMP.         08850099
088700     05  PV-SCND-UNT-QTY                 PIC S9(09) COMP.         08870099
088800     05  PV-TOT-UNITS-DIFF               PIC S9(09) COMP.         08880099
088900     05  PV-TOT-UNITS-AUDITED            PIC S9(09) COMP.         08890099
089000     05  PV-RFID-UNITS-IN-ERROR          PIC S9(09) COMP.         08900099
089100     05  PV-DB2-RFID-EXCP-COUNT          PIC S9(09) COMP.         08910099
089200     05  PV-ERROR-IDX-COUNT              PIC S9(09) VALUE ZERO.   08920099
089400     05  PV-DB2-EXCEPTION-COUNT          PIC S9(09) COMP.         08940099
089500     05  PV-DB2-DATE                     PIC  X(10).              08950099
089600     05  PV-CURRENT-DATE.                                         08960099
089700         10  PV-CURRENT-DATE-CCYY        PIC  X(04).              08970099
089800         10  FILLER                      PIC  X(01).              08980099
089900         10  PV-CURRENT-DATE-MM          PIC  X(02).              08990099
090000         10  FILLER                      PIC  X(01).              09000099
090100         10  PV-CURRENT-DATE-DD          PIC  X(02).              09010099
090200     05  PV-DB2-TIME                     PIC  X(08).              09020099
090300     05  PV-CURRENT-TIME.                                         09030099
090400         10  PV-CURRENT-TIME-HH          PIC  X(02).              09040099
090500         10  FILLER                      PIC  X(01).              09050099
090600         10  PV-CURRENT-TIME-MM          PIC  X(02).              09060099
090700         10  FILLER                      PIC  X(01).              09070099
090800         10  PV-CURRENT-TIME-SS          PIC  X(02).              09080099
090900     05  PV-ERROR-RATIO                  PIC S9(3)V9(4) COMP.     09090099
091000     05  PV-MIN-CARTONS                  PIC S9(09)  VALUE ZERO   09100099
091100                                                     COMP.        09110099
091200     05  PV-CARTONS-LEFT                 PIC S9(09)  VALUE ZERO   09120099
091300                                                     COMP.        09130099
091400     05  PV-OPER-UNT-ID                  PIC  9(03).              09140099
091500     05  PV-HOLD-STR                     PIC S9(04)  VALUE ZERO   09150099
091600                                                     COMP.        09160099
091700     05  PV-HOLD-AUD-CNTL-NBR            PIC S9(09)  VALUE ZERO   09170099
091800                                                     COMP.        09180099
091900     05  PV-HOLD-PO-NBR                  PIC S9(09)  VALUE ZERO   09190099
092000                                                     COMP.        09200099
092100     05  PV-HOLD-REC-SEQ-NBR             PIC S9(09)  VALUE ZERO   09210099
092200                                                     COMP.        09220099
092300     05  PV-HOLD-UPC-NBR                 PIC S9(15)  VALUE ZERO   09230099
092400                                                     COMP-3.      09240099
092900     05  PV-HOLD-SKU-NBR.                                         09290099
093000         10  PV-HOLD-SKU-CL              PIC  X(02)  VALUE SPACES.09300099
093100         10  PV-HOLD-SKU-NMBR            PIC  9(08)  VALUE ZEROES.09310099
093500     05  PV-HOLD-SHIPT-UNT-ID            PIC  9(18).              09350099
093600     05  FILLER REDEFINES PV-HOLD-SHIPT-UNT-ID.                   09360099
093700         10 PV-HOLD-SHIPT-UNIT-ID-1      PIC  9.                  09370099
093800         10 PV-HOLD-SHIPT-UNIT-ID-2-8    PIC  9(07).              09380099
093900         10 PV-HOLD-SHIPT-UNIT-ID-9-17   PIC  9(09).              09390099
094000         10 PV-HOLD-SHIPT-UNIT-ID-18     PIC  9.                  09400099
094100     05  PV-SKU-DEPT-NBR                 PIC  9(03)  VALUE ZEROES.09410099
094200     05  PV-HOLD-UID                     PIC  X(07)  VALUE SPACES.09420099
094300     05  PV-HOUR-COUNT                   PIC S9(09)  VALUE ZERO   09430099
094400                                                     COMP.        09440099
094500     05  PV-VENDOR-NAME                  PIC  X(19)  VALUE SPACES.09450099
094600     05  PV-DAY-COUNT                    PIC S9(09)  VALUE ZERO   09460099
094700                                                     COMP.        09470099
094800     05  PV-MINUTE-COUNT                 PIC S9(09)  VALUE ZERO   09480099
094900                                                     COMP.        09490099
095000     05  PV-RECEIPT-DATE                 PIC  X(10)  VALUE SPACES.09500099
095100     05  PV-UNITS-TRNSCRBD               PIC S9(09)  VALUE ZERO   09510099
095200                                                     COMP.        09520099
095300     05  PV-AUDIT-CARTON-COUNT           PIC S9(09)  VALUE ZERO   09530099
095400                                                     COMP.        09540099
095500     05  PV-AUDIT-UNIT-COUNT             PIC S9(09)  VALUE ZERO   09550099
095600                                                     COMP.        09560099
095700     05  PV-DURATION-TOTAL               PIC S9(09)  VALUE +0     09570099
095800                                                     COMP.        09580099
095900     05  PV-DURATION-HOURS               PIC S9(09)  VALUE +0     09590099
096000                                                     COMP.        09600099
096100     05  PV-DURATION-MINUTES             PIC S9(09)  VALUE +0     09610099
096200                                                     COMP.        09620099
096300     05  PV-TIMESTAMP.                                            09630099
096400         10 PV-TIMESTAMP-DATE            PIC  X(10)  VALUE SPACES.09640099
096500         10 FILLER                       PIC  X(01)  VALUE SPACES.09650099
096600         10 PV-TIMESTAMP-TIME            PIC  X(08)  VALUE SPACES.09660099
096700         10 FILLER                       PIC  X(07)  VALUE SPACES.09670099
096800     05  PV-CURR-TMST                    PIC  X(26)  VALUE SPACES.09680099
096900     05  PV-CURR-DEPT                    PIC  X(03)  VALUE SPACES.09690099
097000     05  PV-PREV-DEPT                    PIC  X(03)  VALUE SPACES.09700099
097100     05  PV-FIELD-NAME                   PIC  X(30)  VALUE SPACES.09710099
097200     05  PV-COMMIT-TMST                  PIC  X(26)  VALUE SPACES.09720099
097300     05  PV-SORT-RETURN              PIC  9(02)      VALUE ZERO.  09730099
097400     05  PV-DETAIL-PAGE-COUNT            PIC S9(04)  VALUE +0     09740099
097500                                                     COMP SYNC.   09750099
097600     05  PV-DETAIL-LINE-COUNT            PIC S9(04)  VALUE +0     09760099
097700                                                     COMP SYNC.   09770099
097800     05  PV-SUM-LINE-COUNT               PIC S9(04)  VALUE +0     09780099
097900                                                     COMP SYNC.   09790099
098000     05  PV-DETAIL-LINE-ADVANCE          PIC S9(04)  VALUE +0     09800099
098100                                                     COMP SYNC.   09810099
098200     05  PV-ADVANCE-COUNT                PIC S9(04)  VALUE +0     09820099
098300                                                     COMP SYNC.   09830099
098400     05  PV-TOTAL-APPROVED-DOLLARS       PIC S9(09)V9(02)         09840099
098500                                                     VALUE +0     09850099
098600                                                     COMP-3.      09860099
098700     05  PV-TOTAL-DECLINED-DOLLARS       PIC S9(09)V9(02)         09870099
098800                                                     VALUE +0     09880099
098900                                                     COMP-3.      09890099
099000     05  PV-TOTAL-APPROVED-REFERRALS     PIC  9(09)  VALUE ZEROS  09900099
099100                                                     COMP-3.      09910099
099200     05  PV-TOTAL-DECLINED-REFERRALS     PIC  9(09)  VALUE ZEROS  09920099
099300                                                     COMP-3.      09930099
099400     05  PV-DOLLARS                      PIC  9(04)V9(02)         09940099
099500                                                     VALUE ZEROS. 09950099
099600                                                                  09960099
099700     05  PV-PARAGRAPH-NAME               PIC  X(30)  VALUE SPACE. 09970099
099710     05  PV-UNION-TYPE                   PIC  X(01).              09971099
099800     05  PV-DB2-OPERATION-ATTEMPTED      PIC  X(30)  VALUE SPACE. 09980099
099900     05  PV-DB2-OPER-UNT-ID              PIC  X(03).              09990099
100000     05  PV-DB2-CURR-TIMESTAMP           PIC  X(26).              10000099
100100     05  PV-CURR-TIMESTAMP.                                       10010099
100200         10  PV-CURR-DATE.                                        10020099
100300             15  PV-CURR-CC              PIC  X(02).              10030099
100400             15  PV-CURR-YY              PIC  X(02).              10040099
100500             15  FILLER                  PIC  X.                  10050099
100600             15  PV-CURR-MM              PIC  X(02).              10060099
100700             15  FILLER                  PIC  X.                  10070099
100800             15  PV-CURR-DD              PIC  X(02).              10080099
100900         10  FILLER                      PIC  X(01).              10090099
101000         10  PV-CURR-TIME.                                        10100099
101100             15  PV-CURR-HH              PIC  X(02).              10110099
101200             15  FILLER                  PIC  X.                  10120099
101300             15  PV-CURR-MIN             PIC  X(02).              10130099
101400             15  FILLER                  PIC  X.                  10140099
101500             15  PV-CURR-SS              PIC  X(02).              10150099
101600         10  FILLER                      PIC  X(07).              10160099
101700     05  PV-WORK-DATE.                                            10170099
101800         10  PV-WORK-MONTH               PIC  9(02).              10180099
101900         10  FILLER                      PIC  X(01) VALUE '/'.    10190099
102000         10  PV-WORK-DAY                 PIC  9(02).              10200099
102100         10  FILLER                      PIC  X(01) VALUE '/'.    10210099
102200         10  PV-WORK-YEAR                PIC  9(02).              10220099
102300     05  PV-AUDIT-TYPE                   PIC  X(02)  VALUE SPACE. 10230099
102400         88  PV-100-AUDIT-CHECK          VALUE '01'.              10240099
102500         88  PV-SPOT-AUDIT-CHECK         VALUE '02'.              10250099
102600         88  PV-REWORK-AUDIT-CHECK       VALUE '03'.              10260099
102700     05  PV-AUDIT-STATUS                 PIC  X(02)  VALUE SPACE. 10270099
102800         88  PV-AUDIT-INPROCESS          VALUE 'IP'.              10280099
102900         88  PV-AUDIT-COMPLETE           VALUE 'CM'.              10290099
103000         88  PV-AUDIT-POSTPONE           VALUE 'PP'.              10300099
103100                                                                  10310099
103700     05  PV-OS-FILE-HOLD-KEY.                                     10370099
103800         10  PV-OSF-AUD-CNTL-NBR         PIC  9(09)  VALUE ZERO.  10380099
103900         10  PV-OSF-PO-NBR               PIC  9(09)  VALUE ZERO.  10390099
104000         10  PV-OSF-REC-SEQ-NBR          PIC  9(09)  VALUE ZERO.  10400099
104100         10  PV-OSF-SHIPT-UNT-ID         PIC  9(18)  VALUE ZERO.  10410099
104200         10  PV-OSF-SKU-DEPT-NBR         PIC  9(03)  VALUE ZERO.  10420099
104300         10  PV-OSF-SKU-CL-NBR           PIC  9(02)  VALUE ZERO.  10430099
104400         10  PV-OSF-SKU-NBR              PIC  9(08)  VALUE ZERO.  10440099
104410                                                                  10441099
104500     05  PV-OS-SKU-FILE-HOLD-KEY.                                 10450099
104600         10  PV-OSS-AUD-CNTL-NBR         PIC  9(09)  VALUE ZERO.  10460099
104700         10  PV-OSS-PO-NBR               PIC  9(09)  VALUE ZERO.  10470099
104800         10  PV-OSS-REC-SEQ-NBR          PIC  9(09)  VALUE ZERO.  10480099
104900         10  PV-OSS-SHIPT-UNT-ID         PIC  9(18)  VALUE ZERO.  10490099
105000         10  PV-OSS-SKU-DEPT-NBR         PIC  9(03)  VALUE ZERO.  10500099
105100         10  PV-OSS-SKU-CL-NBR           PIC  9(02)  VALUE ZERO.  10510099
105200         10  PV-OSS-SKU-NBR              PIC  9(08)  VALUE ZERO.  10520099
105600                                                                  10560099
105700*                                                                 10570099
106300******************************************************************10630099
106400*  RECORD LAYOUT FOR THE TOTAL ERRORS FILE                        10640099
106500******************************************************************10650099
106600 01  TE-FILE.                                                     10660099
106700     COPY SURD003.                                                10670099
106800*                                                                 10680099
106900******************************************************************10690099
107000*  RECORD LAYOUT FOR THE VENDOR OVER/SHORT FILE                   10700099
107100******************************************************************10710099
107200 01  OS-FILE.                                                     10720099
107300     COPY SURD003.                                                10730099
107400*                                                                 10740099
107500******************************************************************10750099
107600*  RECORD LAYOUT FOR THE SKU TOTAL OVER/SHORT FILE                10760099
107700******************************************************************10770099
107800 01  OS-SKU-FILE.                                                 10780099
107900     COPY SURD003.                                                10790099
108000*                                                                 10800099
108100******************************************************************10810099
108200*  RECORD LAYOUT FOR THE RECEIVER OVER/SHORT FILE                 10820099
108300******************************************************************10830099
108400 01  OS-RECEIVER-FILE.                                            10840099
108500     COPY SURD004.                                                10850099
108600                                                                  10860099
108700******************************************************************10870099
108800*  DB2 COMMUNICATION AREA.                                        10880099
108900******************************************************************10890099
109000     EXEC SQL                                                     10900099
109100          INCLUDE SQLCA                                           10910099
109200     END-EXEC.                                                    10920099
109300*                                                                 10930099
109400*                                                                 10940099
109500******************************************************************10950099
109600*  DB2 TABLE COBOL WORKING STORAGE AREA FOR THE SHIPPING UNIT     10960099
109700*  AUDIT EXCEPTION TABLE (TSUEXCP)                                10970099
109800******************************************************************10980099
109900     EXEC SQL                                                     10990099
110000          INCLUDE TSUEXCP                                         11000099
110100     END-EXEC.                                                    11010099
110200*                                                                 11020099
110300*                                                                 11030099
111100******************************************************************11110099
111200*  DB2 TABLE COBOL WORKING STORAGE AREA FOR THE VIOLATION REASON  11120099
111300*  CODE TABLE (TVILNCD)                                           11130099
111400******************************************************************11140099
111500     EXEC SQL                                                     11150099
111600          INCLUDE TVILNCD                                         11160099
111700     END-EXEC.                                                    11170099
111800*                                                                 11180099
111900*                                                                 11190099
112000******************************************************************11200099
112100*  DB2 TABLE COBOL WORKING STORAGE AREA FOR THE SHIPPING UNIT     11210099
112200*  AUDIT TABLE (TSUAUPC)                                          11220099
112300******************************************************************11230099
112400     EXEC SQL                                                     11240099
112500          INCLUDE TSUAUPC                                         11250099
112600     END-EXEC.                                                    11260099
112700*                                                                 11270099
112800     EXEC SQL                                                     11280099
112900          INCLUDE TSUATRN                                         11290099
113000     END-EXEC.                                                    11300099
113100*                                                                 11310099
113200*                                                                 11320099
113300******************************************************************11330099
113400*  DB2 TABLE COBOL WORKING STORAGE AREA FOR THE SHIPPING UNIT     11340099
113500*  AUDIT TABLE (TSUNAUD)                                          11350099
113600******************************************************************11360099
113700     EXEC SQL                                                     11370099
113800          INCLUDE TSUNAUD                                         11380099
113900     END-EXEC.                                                    11390099
114000*                                                                 11400099
114100******************************************************************11410099
114200*  DB2 TABLE COBOL WORKING STORAGE AREA FOR THE PURCHASE ORDER    11420099
114300*  ITEM TABLE (TPURITM)                                           11430099
114400******************************************************************11440099
114500     EXEC SQL                                                     11450099
114600          INCLUDE TPURITM                                         11460099
114700     END-EXEC.                                                    11470099
114800/                                                                 11480099
114900******************************************************************11490099
115000*  DB2 TABLE COBOL WORKING STORAGE AREA FOR THE COMPANY CONTROL   11500099
115100*  TABLE (TCOCNTL)                                                11510099
115200******************************************************************11520099
115300     EXEC SQL                                                     11530099
115400          INCLUDE TCOCNTL                                         11540099
115500     END-EXEC.                                                    11550099
115600*                                                                 11560099
115700*                                                                 11570099
115800******************************************************************11580099
115900*  DB2 TABLE COBOL WORKING STORAGE AREA FOR THE PURCHASE ORDER    11590099
116000*  HEADER TABLE (TPURCHS)                                         11600099
116100******************************************************************11610099
116200     EXEC SQL                                                     11620099
116300          INCLUDE TPURCHS                                         11630099
116400     END-EXEC.                                                    11640099
116500*                                                                 11650099
116600*                                                                 11660099
116700******************************************************************11670099
116800*  DB2 TABLE COBOL WORKING STORAGE AREA FOR THE EXTERNAL ENTERPRIS11680099
116900*  NAME TABLE (TENTNME)                                           11690099
117000******************************************************************11700099
117100     EXEC SQL                                                     11710099
117200          INCLUDE TENTNME                                         11720099
117300     END-EXEC.                                                    11730099
117400*                                                                 11740099
117500*                                                                 11750099
117600******************************************************************11760099
117700*  DB2 TABLE COBOL WORKING STORAGE AREA FOR THE RECEIVING TABLE   11770099
117800******************************************************************11780099
117900     EXEC SQL                                                     11790099
118000          INCLUDE TRECEIV                                         11800099
118100     END-EXEC.                                                    11810099
118200                                                                  11820099
118300*                                                                 11830099
118400******************************************************************11840099
118500*  DB2 TABLE COBOL WORKING STORAGE AREA FOR THE RECEIVING TABLE   11850099
118600******************************************************************11860099
118700     EXEC SQL                                                     11870099
118800          INCLUDE TRECDIS                                         11880099
118900     END-EXEC.                                                    11890099
119000                                                                  11900099
119200*----------------------------------------------------------------*11920099
119300*    DB2 DCLGEN FOR THE VENDOR PO AUDIT REQUEST TABLE             11930099
119400*    (SUT_PO_AUD_REQ)                                             11940099
119500*----------------------------------------------------------------*11950099
119600     EXEC SQL                                                     11960099
119700          INCLUDE SUT00015                                        11970099
119800     END-EXEC.                                                    11980099
119900                                                                  11990099
120000*----------------------------------------------------------------*12000099
120100*    DB2 DCLGEN FOR THE VENDOR PO AUDIT EXCEPTION TABLE           12010099
120200*    (SUT_PO_AUD_EXC)                                             12020099
120300*----------------------------------------------------------------*12030099
120400     EXEC SQL                                                     12040099
120500          INCLUDE SUT00014                                        12050099
120600     END-EXEC.                                                    12060099
120700                                                                  12070099
120800*----------------------------------------------------------------*12080099
120900*    DB2 DCLGEN FOR THE VENDOR AGREEMENT TABLE                    12090099
121000*    (TVNDAGR)                                                    12100099
121100*----------------------------------------------------------------*12110099
121200     EXEC SQL                                                     12120099
121300          INCLUDE TVNDAGR                                         12130099
121400     END-EXEC.                                                    12140099
121600                                                                  12160099
121800*----------------------------------------------------------------*12180099
121900*    DB2 DCLGEN FOR THE RF VERIFICATION TABLE                     12190099
122000*    RIT_RFID_VRFN                                                12200099
122100*----------------------------------------------------------------*12210099
122200     EXEC SQL                                                     12220099
122300          INCLUDE RIT00000                                        12230099
122400     END-EXEC.                                                    12240099
122600                                                                  12260099
122700******************************************************************12270099
122800*   DB2 COMMUNICATIONS AREA2                                      12280099
122900******************************************************************12290099
123000     COPY SQLCA2.                                                 12300099
123100 EJECT                                                            12310099
123200                                                                  12320099
128200     EXEC SQL                                                     12820099
128300         DECLARE QC_ERR_CSR CURSOR                                12830099
128400         FOR SELECT                                               12840099
128500                 A.VILN_GP_SEQ_NBR                                12850099
128600               , B.VILN_CDE_SHRT_DESC                             12860099
128700               , A.OVRRID_SYS_DAT_TXT                             12870099
128800               , SUM(SCND_UNT_QTY)                                12880099
128900               , SUM(RFID_TGD_QTY)                                12890099
129000         FROM                                                     12900099
129100                 TSUEXCP A                                        12910099
129200              ,  TVILNCD B                                        12920099
129300              ,  TSUAUPC C                                        12930099
129400         WHERE                                                    12940099
129500             A.AUD_CNTL_NBR       = :DK-AUD-CNTL-NBR              12950099
129600         AND A.SHIPT_UNT_ID       = :DK-SHIPT-UNT-ID              12960099
129700         AND A.UPC_NBR            = :DK-UPC-NBR                   12970099
129800         AND A.AUD_CNTL_NBR       =  C.AUD_CNTL_NBR               12980099
129900         AND A.SHIPT_UNT_ID       =  C.SHIPT_UNT_ID               12990099
130000         AND A.UPC_NBR            =  C.UPC_NBR                    13000099
130100         AND A.SCN_TMST           =  C.SCN_TMST                   13010099
130200         AND A.VILN_GP_CDE        =  :PC-VA                       13020099
130300         AND C.SCN_TYP_CDE        <> :PC-E                        13030099
130400         AND A.VILN_GP_SEQ_NBR    NOT IN (38, 39, 40, 41, 42)     13040099
130500         AND A.VILN_GP_SEQ_NBR    = B.VILN_GP_SEQ_NBR             13050099
130600         AND A.VILN_GP_CDE        = B.VILN_GP_CDE                 13060099
130700         GROUP BY                                                 13070099
130800                 A.VILN_GP_SEQ_NBR                                13080099
130900               , B.VILN_CDE_SHRT_DESC                             13090099
131000               , A.OVRRID_SYS_DAT_TXT                             13100099
131100         ORDER BY                                                 13110099
131200                 A.VILN_GP_SEQ_NBR                                13120099
131300               , B.VILN_CDE_SHRT_DESC                             13130099
131400               , A.OVRRID_SYS_DAT_TXT                             13140099
131500     END-EXEC.                                                    13150099
131600                                                                  13160099
131700     EXEC SQL                                                     13170099
131800         DECLARE RFID_ERR_CSR_LT42 CURSOR                         13180099
131900         FOR SELECT                                               13190099
132000                 A.VILN_GP_SEQ_NBR                                13200099
132100               , B.VILN_CDE_SHRT_DESC                             13210099
132200               , A.OVRRID_SYS_DAT_TXT                             13220099
132300               , SUM(SCND_UNT_QTY)                                13230099
132400               , SUM(RFID_TGD_QTY)                                13240099
132500         FROM                                                     13250099
132600                 TSUEXCP A                                        13260099
132700              ,  TVILNCD B                                        13270099
132800              ,  TSUAUPC C                                        13280099
132900         WHERE                                                    13290099
133000             A.AUD_CNTL_NBR       = :DK-AUD-CNTL-NBR              13300099
133100         AND A.SHIPT_UNT_ID       = :DK-SHIPT-UNT-ID              13310099
133200         AND A.UPC_NBR            = :DK-UPC-NBR                   13320099
133300         AND A.AUD_CNTL_NBR       =  C.AUD_CNTL_NBR               13330099
133400         AND A.SHIPT_UNT_ID       =  C.SHIPT_UNT_ID               13340099
133500         AND A.UPC_NBR            =  C.UPC_NBR                    13350099
133600         AND A.SCN_TMST           =  C.SCN_TMST                   13360099
133700         AND A.VILN_GP_CDE        =  :PC-VA                       13370099
133800         AND C.SCN_TYP_CDE        <> :PC-E                        13380099
133900         AND A.VILN_GP_SEQ_NBR    IN (38, 39, 40, 41)             13390099
134000         AND A.VILN_GP_SEQ_NBR    = B.VILN_GP_SEQ_NBR             13400099
134100         AND A.VILN_GP_CDE        = B.VILN_GP_CDE                 13410099
134200         GROUP BY                                                 13420099
134300                 A.VILN_GP_SEQ_NBR                                13430099
134400               , B.VILN_CDE_SHRT_DESC                             13440099
134500               , A.OVRRID_SYS_DAT_TXT                             13450099
134600         ORDER BY                                                 13460099
134700                 A.VILN_GP_SEQ_NBR                                13470099
134800               , B.VILN_CDE_SHRT_DESC                             13480099
134900               , A.OVRRID_SYS_DAT_TXT                             13490099
135000     END-EXEC.                                                    13500099
135100                                                                  13510099
135200     EXEC SQL                                                     13520099
135300         DECLARE RFID_ERR_CSR_EQ42 CURSOR                         13530099
135400         FOR SELECT                                               13540099
135500                 A.VILN_GP_SEQ_NBR                                13550099
135600               , B.VILN_CDE_SHRT_DESC                             13560099
135700               , A.OVRRID_SYS_DAT_TXT                             13570099
135800               , SUM(SCND_UNT_QTY)                                13580099
135900               , SUM(RFID_TGD_QTY)                                13590099
136000         FROM                                                     13600099
136100                 TSUEXCP A                                        13610099
136200              ,  TVILNCD B                                        13620099
136300              ,  TSUAUPC C                                        13630099
136400         WHERE                                                    13640099
136500             A.AUD_CNTL_NBR       = :DK-AUD-CNTL-NBR              13650099
136600         AND A.SHIPT_UNT_ID       = :DK-SHIPT-UNT-ID              13660099
136700         AND A.UPC_NBR            = :DK-UPC-NBR                   13670099
136800         AND A.AUD_CNTL_NBR       =  C.AUD_CNTL_NBR               13680099
136900         AND A.SHIPT_UNT_ID       =  C.SHIPT_UNT_ID               13690099
137000         AND A.UPC_NBR            =  C.UPC_NBR                    13700099
137100         AND A.SCN_TMST           =  C.SCN_TMST                   13710099
137200         AND A.VILN_GP_CDE        =  :PC-VA                       13720099
137300         AND C.SCN_TYP_CDE        =  :PC-E                        13730099
137400         AND A.VILN_GP_SEQ_NBR    =  42                           13740099
137500         AND A.VILN_GP_SEQ_NBR    = B.VILN_GP_SEQ_NBR             13750099
137600         AND A.VILN_GP_CDE        = B.VILN_GP_CDE                 13760099
137700         GROUP BY                                                 13770099
137800                 A.VILN_GP_SEQ_NBR                                13780099
137900               , B.VILN_CDE_SHRT_DESC                             13790099
138000               , A.OVRRID_SYS_DAT_TXT                             13800099
138100         ORDER BY                                                 13810099
138200                 A.VILN_GP_SEQ_NBR                                13820099
138300               , B.VILN_CDE_SHRT_DESC                             13830099
138400               , A.OVRRID_SYS_DAT_TXT                             13840099
138500     END-EXEC.                                                    13850099
138700                                                                  13870099
138800******************************************************************13880099
138900*   DB2 CURSOR DECLARATION - HEADER CURSOR TO SELECT ALL THE      13890099
139000*   AUDIT HEADER INFORMATION                                      13900099
139100******************************************************************13910099
139500                                                                  13950099
139600     EXEC SQL                                                     13960099
139700         DECLARE HEADER_CURSOR CURSOR                             13970099
139800         FOR SELECT                                               13980099
139900                A.OPER_UNT_ID                                     13990099
140000              , A.AUD_STAT_CDE                                    14000099
140100              , A.AUD_TYP_CDE                                     14010099
140200              , COUNT(DISTINCT B.SHIPT_UNT_ID)                    14020099
140300              , SUM(SCND_UNT_QTY)                                 14030099
140500              , SUM(B.RFID_TGD_QTY)                               14050099
140700              , CURRENT DATE                                      14070099
140800              , CURRENT TIME                                      14080099
140900         FROM                                                     14090099
141000               TSUNAUD A                                          14100099
141100            ,  TSUAUPC B                                          14110099
141200            ,  TSUATRN C                                          14120099
141300            ,  TSUEXCP E                                          14130099
141400         WHERE                                                    14140099
141500               A.AUD_CNTL_NBR = :DK-AUD-CNTL-NBR                  14150099
141600           AND A.AUD_CNTL_NBR = B.AUD_CNTL_NBR                    14160099
141700           AND A.AUD_CNTL_NBR = C.AUD_CNTL_NBR                    14170099
141800           AND B.SHIPT_UNT_ID = C.SHIPT_UNT_ID                    14180099
141900           AND C.TRN_NBR      = :DK-PO-NBR                        14190099
142000           AND C.REC_SEQ_NBR  = :DK-REC-SEQ-NBR                   14200099
142100           AND E.AUD_CNTL_NBR = B.AUD_CNTL_NBR                    14210099
142200           AND E.SHIPT_UNT_ID = B.SHIPT_UNT_ID                    14220099
142300           AND E.UPC_NBR      = B.UPC_NBR                         14230099
142400           AND E.SCN_TMST     = B.SCN_TMST                        14240099
142600           AND E.VILN_GP_CDE  = :PC-VA                            14260099
142700           AND ((B.SCN_TYP_CDE     <> :PC-E                       14270099
142800           AND  E.VILN_GP_SEQ_NBR  <> 42)                         14280099
142900            OR (B.SCN_TYP_CDE      =  :PC-E                       14290099
143000           AND  E.VILN_GP_SEQ_NBR  =  42))                        14300099
143200         GROUP BY                                                 14320099
143300                A.OPER_UNT_ID                                     14330099
143400              , A.AUD_STAT_CDE                                    14340099
143500              , A.AUD_TYP_CDE                                     14350099
143600         UNION                                                    14360099
143700         SELECT                                                   14370099
143800                A.OPER_UNT_ID                                     14380099
143900              , A.AUD_STAT_CDE                                    14390099
144000              , A.AUD_TYP_CDE                                     14400099
144100              , COUNT(DISTINCT B.SHIPT_UNT_ID)                    14410099
144200              , SUM(SCND_UNT_QTY)                                 14420099
144300              , SUM(B.RFID_TGD_QTY)                               14430099
144400              , CURRENT DATE                                      14440099
144500              , CURRENT TIME                                      14450099
144600         FROM                                                     14460099
144700               TSUNAUD A                                          14470099
144800            ,  TSUAUPC B                                          14480099
144900            ,  TSUATRN C                                          14490099
145000            ,  TSUEXCP E                                          14500099
145100         WHERE                                                    14510099
145200               A.AUD_CNTL_NBR = :DK-AUD-CNTL-NBR                  14520099
145300           AND A.AUD_CNTL_NBR = B.AUD_CNTL_NBR                    14530099
145400           AND A.AUD_CNTL_NBR = C.AUD_CNTL_NBR                    14540099
145500           AND B.SHIPT_UNT_ID = C.SHIPT_UNT_ID                    14550099
145600           AND C.TRN_NBR      = :DK-PO-NBR                        14560099
145700           AND C.REC_SEQ_NBR  = :DK-REC-SEQ-NBR                   14570099
145900           AND B.SCN_TYP_CDE <> :PC-E                             14590099
146100           AND E.AUD_CNTL_NBR = B.AUD_CNTL_NBR                    14610099
146200           AND E.SHIPT_UNT_ID = B.SHIPT_UNT_ID                    14620099
146300           AND E.UPC_NBR      = B.UPC_NBR                         14630099
146400           AND E.SCN_TMST     = B.SCN_TMST                        14640099
146500           AND E.VILN_GP_CDE  = :PC-VA                            14650099
146600           AND E.VILN_GP_SEQ_NBR NOT IN (38, 39, 40, 41, 42)      14660099
146700         GROUP BY                                                 14670099
146800                A.OPER_UNT_ID                                     14680099
146900              , A.AUD_STAT_CDE                                    14690099
147000              , A.AUD_TYP_CDE                                     14700099
147100     END-EXEC.                                                    14710099
147200                                                                  14720099
147300                                                                  14730099
147400******************************************************************14740099
147500*   DB2 CURSOR DECLARATION - UPC CURSOR TO SELECT ALL THE UPC     14750099
147600*   DETAIL INFORMATION                                            14760099
147700******************************************************************14770099
148200     EXEC SQL                                                     14820099
148300         DECLARE UPC_CURSOR CURSOR                                14830099
148400         FOR SELECT                                               14840099
148500               A.SKU_NBR                                          14850099
148600            ,  A.ITM_DESC                                         14860099
148700            ,  A.VND_STYL_DESC                                    14870099
148800            ,  A.UPC_CLOR_DESC                                    14880099
148900            ,  A.UPC_SIZE_DESC                                    14890099
149000            ,  A.UPC_RTL_AMT                                      14900099
149100         FROM                                                     14910099
149200               TSUAUPC A                                          14920099
149300         WHERE                                                    14930099
149400               A.AUD_CNTL_NBR       = :DK-AUD-CNTL-NBR            14940099
149500           AND A.SHIPT_UNT_ID       = :DK-SHIPT-UNT-ID            14950099
149600           AND A.UPC_NBR            = :DK-UPC-NBR                 14960099
149700           AND A.SCN_TYP_CDE      <>  :PC-E                       14970099
149800         GROUP BY                                                 14980099
149900               A.SKU_NBR                                          14990099
150000            ,  A.ITM_DESC                                         15000099
150100            ,  A.VND_STYL_DESC                                    15010099
150200            ,  A.UPC_CLOR_DESC                                    15020099
150300            ,  A.UPC_SIZE_DESC                                    15030099
150400            ,  A.UPC_RTL_AMT                                      15040099
150500     END-EXEC.                                                    15050099
150600                                                                  15060099
150800***************************************************************** 15080099
150900*    DECLARE RFID CURSOR -- THIS CURSOR WILL RETRIEVE ALL THE     15090099
151000*    RFID EXCEPTIONS FOR A CERTAIN AUDIT/RCVR/STORE               15100099
151100***************************************************************** 15110099
151200     EXEC SQL                                                     15120099
151300         DECLARE RFID_CURSOR CURSOR FOR                           15130099
151400           SELECT C.UPC_NBR                                       15140099
151500                , C.SCN_TMST                                      15150099
151600                , C.VILN_GP_SEQ_NBR                               15160099
151700                , SUM(SCND_UNT_QTY)                               15170099
151800                , SUM(RFID_TGD_QTY)                               15180099
151900             FROM TSUATRN A                                       15190099
152000                , TSUAUPC B                                       15200099
152100                , TSUEXCP C                                       15210099
152200            WHERE A.AUD_CNTL_NBR     = :DK-AUD-CNTL-NBR           15220099
152300              AND A.TRN_NBR          = :DK-PO-NBR                 15230099
152400              AND A.REC_SEQ_NBR      = :DK-REC-SEQ-NBR            15240099
152500              AND A.AUD_CNTL_NBR     = B.AUD_CNTL_NBR             15250099
152600              AND A.SHIPT_UNT_ID     = B.SHIPT_UNT_ID             15260099
152700              AND B.AUD_CNTL_NBR     = C.AUD_CNTL_NBR             15270099
152800              AND B.SHIPT_UNT_ID     = C.SHIPT_UNT_ID             15280099
152900              AND B.UPC_NBR          = C.UPC_NBR                  15290099
153000              AND B.SCN_TMST         = C.SCN_TMST                 15300099
153100              AND C.SCN_TMST         >= A.UNT_AUD_STRT_TMST       15310099
153200              AND B.SCN_TYP_CDE      <> :PC-E                     15320099
153300              AND C.VILN_GP_SEQ_NBR IN  (                         15330099
153400                 :PC-RFID-UPC-MISPCK                              15340099
153500                ,:PC-RFID-TKT-CLR                                 15350099
153600                ,:PC-RFID-TKT-SIZE                                15360099
153700                ,:PC-RFID-TKT-STYLE)                              15370099
153800           GROUP BY C.VILN_GP_SEQ_NBR                             15380099
153900                ,  C.UPC_NBR                                      15390099
154000                ,  C.SCN_TMST                                     15400099
154100                                                                  15410099
154200        UNION                                                     15420099
154300                                                                  15430099
154400        (SELECT  C.UPC_NBR                                        15440099
154500              ,  C.SCN_TMST                                       15450099
154600              ,  C.VILN_GP_SEQ_NBR                                15460099
154700              ,  SUM(SCND_UNT_QTY)                                15470099
154800              ,  SUM(RFID_TGD_QTY)                                15480099
154900         FROM   TSUATRN A                                         15490099
155000             ,  TSUAUPC B                                         15500099
155100             ,  TSUEXCP C                                         15510099
155200         WHERE                                                    15520099
155300             A.AUD_CNTL_NBR     = :DK-AUD-CNTL-NBR                15530099
155400         AND A.TRN_NBR          = :DK-PO-NBR                      15540099
155500         AND A.REC_SEQ_NBR      = :DK-REC-SEQ-NBR                 15550099
155600         AND A.AUD_CNTL_NBR     = B.AUD_CNTL_NBR                  15560099
155700         AND A.SHIPT_UNT_ID     = B.SHIPT_UNT_ID                  15570099
155800         AND B.AUD_CNTL_NBR     = C.AUD_CNTL_NBR                  15580099
155900         AND B.SHIPT_UNT_ID     = C.SHIPT_UNT_ID                  15590099
156000         AND B.UPC_NBR          = C.UPC_NBR                       15600099
156100         AND B.SCN_TMST         = C.SCN_TMST                      15610099
156200         AND C.SCN_TMST         >= A.UNT_AUD_STRT_TMST            15620099
156300         AND B.SCN_TYP_CDE      = :PC-E                           15630099
156400         AND C.VILN_GP_SEQ_NBR  = :PC-RFID-NO-TICKET              15640099
156500        GROUP BY C.VILN_GP_SEQ_NBR                                15650099
156600              ,  C.UPC_NBR                                        15660099
156700              ,  C.SCN_TMST                                       15670099
156800          )                                                       15680099
156900     END-EXEC.                                                    15690099
157000                                                                  15700099
157400                                                                  15740099
157900* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 15790099
158000 PROCEDURE DIVISION.                                              15800099
158100* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 15810099
158200                                                                  15820099
158300******************************************************************15830099
158400*  0000-MAINLINE - CONTROLS THE MAIN PROCESSING OF THE PROGRAM    15840099
158500******************************************************************15850099
158600 0000-PROGRAM-MAINLINE.                                           15860099
158700                                                                  15870099
158800     ACCEPT CC-CONTROL-CARD FROM SYSIN.                           15880099
158900     DISPLAY '   '.                                               15890099
158901     DISPLAY 'SUKRP011 - START'.                                  15890199
158910     DISPLAY '   '.                                               15891099
159000     DISPLAY 'CONTROL CARD = ' CC-CONTROL-CARD.                   15900099
159100                                                                  15910099
159200     PERFORM 0500-CHECK-FOR-MANUAL-COMBO.                         15920099
159300     IF PS-MANUAL-COMBO-AUDIT                                     15930099
159400                                                                  15940099
159500         DISPLAY 'MANUAL COMBO QC PROCESSING'                     15950099
159600         PERFORM 1000-INITIALIZE                                  15960099
159700                                                                  15970099
159800         PERFORM 2000-CREATE-REPORT                               15980099
159900             UNTIL PS-EOF-VND-OVER-SHORT                          15990099
160000                                                                  16000099
160100         PERFORM 9000-EOJ-ROUTINE                                 16010099
160200         SET CC-RFID-AUDIT      TO TRUE                           16020099
160300         SET CC-RFID-AUD-ONLY   TO TRUE                           16030099
160400         MOVE ZERO              TO PV-HOLD-STR                    16040099
160500                                   PV-HOLD-SHIPT-UNT-ID           16050099
160600                                   PV-HOLD-UPC-NBR                16060099
160700         MOVE '00000000'        TO PV-HOLD-SKU-NMBR               16070099
160800         MOVE +0                TO PV-DETAIL-PAGE-COUNT           16080099
160900         MOVE +0                TO PV-DETAIL-LINE-COUNT           16090099
161000         DISPLAY 'MANUAL COMBO RFID PROCESSING SET'               16100099
161100         INITIALIZE PA-RFID-ERROR-SUMMARY-TABLE                   16110099
161200     END-IF.                                                      16120099
161300                                                                  16130099
161400     PERFORM 1000-INITIALIZE.                                     16140099
161500                                                                  16150099
161600     PERFORM 2000-CREATE-REPORT                                   16160099
161700         UNTIL PS-EOF-VND-OVER-SHORT.                             16170099
161800                                                                  16180099
161900     PERFORM 9000-EOJ-ROUTINE.                                    16190099
162000     CLOSE       CARDIN-AUDIT-NBR-FILE                            16200099
162100                 VA-VND-AUDIT-DETAIL-RPT                          16210099
162200                 VA-VND-AUDIT-DETAIL-RPT-LOG                      16220099
162210                 VA-AUDIT-DETAIL-RPT-FLAT-FILE.                   16221099
162300                                                                  16230099
162400     STOP RUN.                                                    16240099
162600                                                                  16260099
162700                                                                  16270099
162800******************************************************************16280099
162900*  0500-CHECK-FOR-MANUAL-COMBO.                                   16290099
163000*       - ACCEPTS, EDITS, AND DISPLAYS THE CONTROL CARD.          16300099
163100******************************************************************16310099
163700 0500-CHECK-FOR-MANUAL-COMBO.                                     16370099
163800                                                                  16380099
163900     OPEN INPUT  CARDIN-AUDIT-NBR-FILE                            16390099
164000          OUTPUT VA-VND-AUDIT-DETAIL-RPT                          16400099
164100                 VA-VND-AUDIT-DETAIL-RPT-LOG                      16410099
164110                 VA-AUDIT-DETAIL-RPT-FLAT-FILE.                   16411099
164200                                                                  16420099
164300     PERFORM 7000-READ-CARDIN-FILE.                               16430099
164400                                                                  16440099
164500     DISPLAY 'CC-CARDIN: ' CC-CARDIN                              16450099
164600                                                                  16460099
164700     IF PS-END-OF-CARDIN-FILE                                     16470099
164800         DISPLAY '** SUKRP011 ABEND **'                           16480099
164900         DISPLAY '** CARDIN (AUDIT NUMBER) FILE IS EMPTY **'      16490099
165000         MOVE +4019                  TO ABEND-CODE                16500099
165100         CALL 'ILBOABN0' USING ABEND-CODE                         16510099
165200     END-IF.                                                      16520099
165300                                                                  16530099
165400     IF CC-MANUAL-GENERATED-AUDIT AND CC-QC-AND-RFID-AUD          16540099
165500         DISPLAY 'MANUAL COMBO AUDIT'                             16550099
165600         SET PS-MANUAL-COMBO-AUDIT      TO TRUE                   16560099
165700         SET CC-QC-AUDIT                TO TRUE                   16570099
165800         SET CC-QC-AUD-ONLY             TO TRUE                   16580099
165900     END-IF.                                                      16590099
166100                                                                  16610099
166200******************************************************************16620099
166300*  1000-INITIALIZE                                                16630099
166400*       - ACCEPTS, EDITS, AND DISPLAYS THE CONTROL CARD.          16640099
166500*       - OPEN ALL INPUT/OUTPUT FILES                             16650099
166600*       - SELECT ALL HEADER INFORMATION                           16660099
166700******************************************************************16670099
167200 1000-INITIALIZE.                                                 16720099
167300                                                                  16730099
167400     INITIALIZE PA-PROGRAM-ACCUMULATORS.                          16740099
167500     INITIALIZE PS-EOF-SKU-TOTAL-FILE-IND                         16750099
167600                PS-EOF-VND-TOT-ERR-FILE-IND                       16760099
167700                PS-DATA-IND                                       16770099
167800                PS-EOF-VND-OVER-SHORT-IND                         16780099
167900                PS-EOF-RCVR-TOTAL-ERROR-IND                       16790099
168000                PS-EOF-SKU-TOTAL-FILE-IND                         16800099
168100                PS-EOF-VND-TOT-ERR-FILE-IND.                      16810099
168200                                                                  16820099
168300                                                                  16830099
168400     OPEN INPUT  OS-VENDOR-OVER-SHORT-FILE                        16840099
168500                 OS-RECEIVER-TOTAL-ERROR-FILE                     16850099
168600                 TE-VENDOR-TOTAL-ERROR-FILE                       16860099
168700                 OS-SKUTOT-OVER-SHORT-FILE.                       16870099
168800                                                                  16880099
168900     SET PS-NOT-EOF-RCVR-TOTAL-ERROR    TO TRUE.                  16890099
169000     SET PS-NOT-EOF-VND-OVER-SHORT      TO TRUE.                  16900099
169100     SET PS-NOT-EOF-VND-TOT-ERR-FILE    TO TRUE.                  16910099
169200     SET PS-NOT-EOF-SKU-TOTAL-FILE      TO TRUE.                  16920099
169201                                                                  16920199
169210     MOVE SPACES  TO  VA-VND-AUDIT-DETAIL-LINE-FLAT.              16921099
169300                                                                  16930099
169400     PERFORM 8000-READ-VND-OVER-SHORT-FILE.                       16940099
169500                                                                  16950099
169600     PERFORM 8001-READ-VND-TOT-ERR-FILE.                          16960099
169700                                                                  16970099
169800     PERFORM 8003-READ-RCVR-TOT-ERR-FILE.                         16980099
169900                                                                  16990099
170000     PERFORM 8004-READ-SKU-TOTAL-FILE.                            17000099
170100                                                                  17010099
170200*    IF THERE IS NO DATA, PRINT NO DATA MESSAGE TO THE REPORT,    17020099
170300*    OTHERWISE SET-UP THE PAGE HEADINGS                           17030099
170400     IF PS-EOF-VND-OVER-SHORT                                     17040099
170500         SET PS-NO-DATA                  TO TRUE                  17050099
170600         DISPLAY '*******  NO DATA TO REPORT IN SUKRP011 ******'  17060099
170700     ELSE                                                         17070099
170800         SET PS-DATA                     TO TRUE                  17080099
170900                                                                  17090099
171000*        IF THIS IS A PRINTEK PRINTER, LOAD THE FORM              17100099
171100         IF CC-PRTR-CNTL-IND = 'P'                                17110099
171200             MOVE CC-TRACK-NBR           TO DS004-PLC-LF-FORM-NBR 17120099
171300             MOVE DS004-PES-8LPI         TO DS004-PLC-LF-LPI      17130099
171400                                                                  17140099
171711             IF  CC-FLAT-FILE                                     17171199
171731                 CONTINUE                                         17173199
171740             ELSE                                                 17174099
171741                 WRITE VA-VND-AUDIT-DETAIL-LINE                   17174199
171742                  FROM DS004-PLC-LOAD-FORM                        17174299
171743                 AFTER ADVANCING 1 LINE                           17174399
171744             END-IF                                               17174499
171750                                                                  17175099
171800         END-IF                                                   17180099
171900         MOVE SU003-AUD-CNTL-NBR OF OS-FILE                       17190099
172000                                 TO PV-HOLD-AUD-CNTL-NBR          17200099
172100                                    DK-AUD-CNTL-NBR               17210099
172200         MOVE SU003-PO-NBR       OF OS-FILE                       17220099
172300                                 TO PV-HOLD-PO-NBR                17230099
172400         MOVE SU003-REC-SEQ-NBR  OF OS-FILE                       17240099
172500                                 TO PV-HOLD-REC-SEQ-NBR           17250099
172600*        PRINT THE PAGE HEADINGS                                  17260099
172700         MOVE SU003-SKU-DEPT-NBR OF OS-FILE                       17270099
172800                                 TO AH2-DEPT                      17280099
172900                                    PV-SKU-DEPT-NBR               17290099
173000         MOVE PV-SKU-DEPT-NBR    TO DK-DEPT-NBR                   17300099
173100         PERFORM 1100-SET-UP-HEADER                               17310099
173200         PERFORM 3000-PRINT-PAGE-HEADING                          17320099
173300     END-IF.                                                      17330099
173400                                                                  17340099
173800                                                                  17380099
173900******************************************************************17390099
174000*  1100-SET-UP-HEADER                                             17400099
174100*       - SELECTS ALL THE AUDIT LEVEL INFORMATION.                17410099
174200*       - MOVES ALL INFO TO THE HEADER FIELDS                     17420099
174300******************************************************************17430099
174400 1100-SET-UP-HEADER.                                              17440099
174500                                                                  17450099
174600     MOVE SU003-AUD-CNTL-NBR OF OS-FILE TO AH1-AUD-CNTL-NBR       17460099
174700                                           DK-AUD-CNTL-NBR.       17470099
174800                                                                  17480099
174900     MOVE SU003-PO-NBR       OF OS-FILE TO AH3-PO                 17490099
175000                                           DK-PO-NBR.             17500099
175100                                                                  17510099
175200     MOVE SU003-AUD-OPER-UNT-ID OF OS-FILE TO DK-STORE-NBR.       17520099
175201                                                                  17520199
175210     MOVE SU003-SKU-NMBR        OF OS-FILE TO DK-SKU-NBR          17521099
175220                                              PV-DISPLAY-SKU.     17522099
175300                                                                  17530099
175400     PERFORM 1300-SELECT-AUDIT-TYPE.                              17540099
175500                                                                  17550099
175600     PERFORM 3170-CHECK-COMBO.                                    17560099
175700                                                                  17570099
175800     MOVE SU003-REC-SEQ-NBR  OF OS-FILE TO AH3-RECEIVER           17580099
175900                                           DK-REC-SEQ-NBR.        17590099
176000                                                                  17600099
176100     IF DK-REC-SEQ-NBR > 0                                        17610099
176200         PERFORM 1110-GET-RECEIVER-INFO                           17620099
176300         MOVE ENTNME-ENT-NAME-DESC      TO AH2-VENDOR-NAME        17630099
176400         MOVE RECEIV-PACK-BY-ST-IND     TO AH3-PBS-IND            17640099
176500         MOVE PV-RECEIPT-DATE           TO AH5-RECEIPT-DATE       17650099
176600         MOVE PURCHS-NEW-STR-PO-IND     TO AH4-NEW-STR-IND        17660099
176700                                                                  17670099
176800     ELSE                                                         17680099
176900         MOVE SPACES                    TO AH2-VENDOR-NAME        17690099
177000                                           AH3-PBS-IND            17700099
177100                                           AH5-RECEIPT-DATE       17710099
177200                                           AH4-NEW-STR-IND        17720099
177300     END-IF.                                                      17730099
177400                                                                  17740099
177500     MOVE PC-CURRENT-PROGRAM-NAME       TO DP132O-PROGRAM-NAME.   17750099
177600     MOVE 1                    TO DP132O-REPORT-NUMBER.           17760099
177700                                                                  17770099
177800     MOVE 0                         TO PV-HEADER-CURSOR-COUNT.    17780099
177900     PERFORM 1130-SELECT-AUDIT-INFO.                              17790099
178000     IF PV-HEADER-CURSOR-COUNT = 0                                17800099
178100         PERFORM 1190-GET-HEADER-INFO                             17810099
178200     END-IF.                                                      17820099
178300     MOVE PV-CURRENT-DATE-CCYY          TO DP132O-RUN-YEAR.       17830099
178400     MOVE PV-CURRENT-DATE-MM            TO DP132O-RUN-MONTH.      17840099
178500     MOVE PV-CURRENT-DATE-DD            TO DP132O-RUN-DAY.        17850099
178600                                                                  17860099
178700     MOVE PV-CURRENT-TIME-HH            TO DP132O-RUN-HOUR.       17870099
178800     MOVE PV-CURRENT-TIME-MM            TO DP132O-RUN-MINUTE.     17880099
178900                                                                  17890099
179000     MOVE SUNAUD-OPER-UNT-ID            TO AH1-OPER-UNT-ID        17900099
179100                                           PV-OPER-UNT-ID         17910099
179200                                           DK-OPER-UNT-ID.        17920099
179300                                                                  17930099
179400     PERFORM 1120-GET-FCLTY-DESC.                                 17940099
179500     MOVE SUNAUD-AUD-STAT-CDE            TO PV-AUDIT-STATUS.      17950099
179600     MOVE SUNAUD-AUD-TYP-CDE             TO PV-AUDIT-TYPE.        17960099
179700                                                                  17970099
179800     EVALUATE TRUE                                                17980099
179900         WHEN  PV-100-AUDIT-CHECK                                 17990099
180000             MOVE '100% CHECK'           TO AH4-AUDIT-TYPE        18000099
180100         WHEN  PV-SPOT-AUDIT-CHECK                                18010099
180200             MOVE 'SPOT CHECK'           TO AH4-AUDIT-TYPE        18020099
180300         WHEN  PV-REWORK-AUDIT-CHECK                              18030099
180400             MOVE 'REWORK    '           TO AH4-AUDIT-TYPE        18040099
180500     END-EVALUATE.                                                18050099
180600                                                                  18060099
180700     EVALUATE TRUE                                                18070099
180800       WHEN  PV-AUDIT-INPROCESS                                   18080099
180900             MOVE 'IN PROCESS'          TO AH1-AUDIT-STATUS       18090099
181000       WHEN  PV-AUDIT-COMPLETE                                    18100099
181100             MOVE 'COMPLETE  '          TO AH1-AUDIT-STATUS       18110099
181200       WHEN  PV-AUDIT-POSTPONE                                    18120099
181300             MOVE 'POSTPONED '          TO AH1-AUDIT-STATUS       18130099
181400     END-EVALUATE.                                                18140099
181500                                                                  18150099
181700     IF CC-RFID-AUDIT                                             18170099
181800         MOVE 'RFID'                    TO AH7-AUDIT-CATEGORY     18180099
181900     ELSE                                                         18190099
182000         MOVE 'QC  '                    TO AH7-AUDIT-CATEGORY     18200099
182100     END-IF.                                                      18210099
182200                                                                  18220099
182400                                                                  18240099
182500     MOVE ZEROS                        TO PV-AUDIT-CARTON-COUNT.  18250099
182600     MOVE ZEROS                        TO PV-TOT-UNITS-AUDITED.   18260099
182700     MOVE ZEROS                        TO PV-SCND-UNT-QTY.        18270099
183100                                                                  18310099
183200     PERFORM 1150-GET-ERROR-QTYS.                                 18320099
183300                                                                  18330099
183500     IF CC-RFID-AUD-ONLY                                          18350099
183600     OR (CC-SYSTEM-GENERATED-AUDIT                                18360099
183700         AND CC-RFID-AUDIT                                        18370099
183800         AND CC-QC-AND-RFID-AUD)                                  18380099
184100         PERFORM 1160-GET-UNITS-AUDITED                           18410099
184200         MOVE PV-AUDIT-CARTON-COUNT TO AH4-TOT-CTNS-AUDITED       18420099
184300         MOVE PV-SCND-UNT-QTY       TO AH6-TOT-UNITS-AUDITED      18430099
184400         MOVE ZERO  TO PV-HL-UNITS-IN-ERROR                       18440099
184500                       PV-HL-TOTAL-ERRORS                         18450099
184600         PERFORM 3200-CHECK-RFID-ERRORS                           18460099
185000         MOVE PV-HL-TOTAL-ERRORS    TO AH8-TOT-ERRORS             18500099
185300         MOVE PV-HL-UNITS-IN-ERROR  TO AH7-UNITS-IN-ERROR         18530099
185400     ELSE                                                         18540099
185500         PERFORM 1160-GET-UNITS-AUDITED                           18550099
185600         MOVE PV-AUDIT-CARTON-COUNT TO AH4-TOT-CTNS-AUDITED       18560099
185700         MOVE PV-SCND-UNT-QTY       TO AH6-TOT-UNITS-AUDITED      18570099
185800         PERFORM 3300-CHECK-QC-ERRORS                             18580099
185900         PERFORM 3400-RETRIEVE-UNIT-COUNT                         18590099
186200         MOVE PV-HL-TOTAL-ERRORS        TO AH8-TOT-ERRORS         18620099
186400         MOVE PV-HL-UNITS-IN-ERROR      TO AH7-UNITS-IN-ERROR     18640099
186600     END-IF.                                                      18660099
186700                                                                  18670099
186800     IF DK-REC-SEQ-NBR > 0                                        18680099
186900         PERFORM 1140-SELECT-UNITS-TRNSCRBD                       18690099
187000         MOVE PV-UNITS-TRNSCRBD    TO AH3-TOT-UNITS-TRNSCRIBED    18700099
187100     ELSE                                                         18710099
187200         MOVE 0                    TO AH3-TOT-UNITS-TRNSCRIBED    18720099
187300     END-IF.                                                      18730099
187400                                                                  18740099
187500     IF PV-SPOT-AUDIT-CHECK                                       18750099
187600         IF PV-TOT-UNITS-AUDITED > 0                              18760099
187700             COMPUTE PV-ERROR-RATIO =                             18770099
187800                 (PV-HEADING-UNITS-IN-ERROR  /                    18780099
187900                  PV-TOT-UNITS-AUDITED) * 100                     18790099
188000         ELSE                                                     18800099
188100             IF SU003-UNT-ERR-CNT-COMBO OF TE-FILE > 0            18810099
188200                 MOVE 100          TO PV-ERROR-RATIO              18820099
188300             ELSE                                                 18830099
188400                 MOVE 0            TO PV-ERROR-RATIO              18840099
188500             END-IF                                               18850099
188600       END-IF                                                     18860099
188700     ELSE                                                         18870099
188800         IF PV-UNITS-TRNSCRBD > 0                                 18880099
188900             COMPUTE PV-ERROR-RATIO =                             18890099
189000                 (PV-HEADING-UNITS-IN-ERROR /                     18900099
189100                  PV-UNITS-TRNSCRBD)   * 100                      18910099
189200         ELSE                                                     18920099
189300             IF SU003-UNT-ERR-CNT-COMBO OF OS-FILE > 0            18930099
189400                 MOVE 100          TO PV-ERROR-RATIO              18940099
189500             ELSE                                                 18950099
189600                 MOVE 0            TO PV-ERROR-RATIO              18960099
189700             END-IF                                               18970099
189800         END-IF                                                   18980099
189900     END-IF.                                                      18990099
190000                                                                  19000099
190200     IF CC-RFID-AUDIT                                             19020099
190300         IF PV-TOT-UNITS-AUDITED > 0                              19030099
190400             COMPUTE PV-ERROR-RATIO =                             19040099
190500                 (PV-HL-UNITS-IN-ERROR /                          19050099
190600                  PV-TOT-UNITS-AUDITED) * 100                     19060099
190700         ELSE                                                     19070099
190800             MOVE 0            TO PV-ERROR-RATIO                  19080099
190900         END-IF                                                   19090099
191000     END-IF                                                       19100099
191200                                                                  19120099
191300     MOVE PV-ERROR-RATIO           TO AH9-ERROR-RATIO.            19130099
191400                                                                  19140099
191500                                                                  19150099
191600******************************************************************19160099
191700* 1110-GET-RECEIVER-INFO                                          19170099
191800*    THIS PARAGRAPH WILL SELECT THE HEADER INFORMATION FROM THE   19180099
191900*    RECEIVER TABLES.                                             19190099
192000******************************************************************19200099
192100 1110-GET-RECEIVER-INFO.                                          19210099
192200                                                                  19220099
192300     EXEC SQL                                                     19230099
192400         SELECT                                                   19240099
192500               CHAR (DATE (A.REC_TMST), USA)                      19250099
192600             , A.PACK_BY_ST_IND                                   19260099
192700             , B.NEW_STR_PO_IND                                   19270099
192800             , C.ENT_NAME_DESC                                    19280099
192900         INTO                                                     19290099
193000               :PV-RECEIPT-DATE                                   19300099
193100             , :RECEIV-PACK-BY-ST-IND                             19310099
193200             , :PURCHS-NEW-STR-PO-IND                             19320099
193300             , :ENTNME-ENT-NAME-DESC                              19330099
193400         FROM                                                     19340099
193500               TRECEIV A                                          19350099
193600             , TPURCHS B                                          19360099
193700             , TENTNME C                                          19370099
193800         WHERE                                                    19380099
193900               A.ORD_NBR        = :DK-PO-NBR                      19390099
194000           AND A.REC_SEQ_NBR    = :DK-REC-SEQ-NBR                 19400099
194100           AND A.ORD_NBR        = B.PO_NBR                        19410099
194200           AND B.VER_STATUS_CDE = 'A'                             19420099
194300           AND B.ENT_ID         = C.ENT_ID                        19430099
194400           AND C.TYPE_CDE       = '01'                            19440099
194500     END-EXEC.                                                    19450099
194600                                                                  19460099
194700     EVALUATE TRUE                                                19470099
194800         WHEN SQLCODE = ZERO                                      19480099
194900              CONTINUE                                            19490099
195000                                                                  19500099
195300         WHEN SQLCODE = +100                                      19530099
195400              MOVE SU003-AUD-CNTL-NBR  OF OS-FILE                 19540099
195500                                       TO  RE-AUD-CNTL-NBR        19550099
195600              MOVE SU003-PO-NBR        OF OS-FILE                 19560099
195700                                       TO  RE-PO                  19570099
195800              MOVE SU003-REC-SEQ-NBR   OF OS-FILE                 19580099
195900                                       TO  RE-RCVR                19590099
196000                                                                  19600099
196302              IF  CC-FLAT-FILE                                    19630299
196310                  MOVE SPACES TO  VA-VND-AUDIT-DETAIL-LINE-FLAT   19631099
196311                  WRITE VA-VND-AUDIT-DETAIL-LINE-FLAT             19631199
196320                   FROM RE-REPORT-ERROR-1                         19632099
196330              ELSE                                                19633099
196331                  WRITE VA-VND-AUDIT-DETAIL-LINE                  19633199
196332                   FROM RE-REPORT-ERROR-1                         19633299
196333                  AFTER ADVANCING 1 LINES                         19633399
196334                                                                  19633499
196335                  WRITE VA-VND-AUDIT-DETAIL-LINE-LOG              19633599
196336                   FROM RE-REPORT-ERROR-1                         19633699
196337                   AFTER ADVANCING 1 LINES                        19633799
196338              END-IF                                              19633899
196900                                                                  19690099
197000         WHEN SQLWARN0 NOT EQUAL SPACE                            19700099
197100         WHEN SQLCODE NOT EQUAL ZERO                              19710099
197200              DISPLAY 'PO NBR: ' DK-PO-NBR                        19720099
197300              DISPLAY 'REC SEQ NBR: ' DK-REC-SEQ-NBR              19730099
197400              MOVE '1110-GET-RECEIVER-INFO'                       19740099
197500                               TO  PV-PARAGRAPH-NAME              19750099
197600              MOVE 'SELECT RECIVER INFORMATION'                   19760099
197700                               TO  PV-DB2-OPERATION-ATTEMPTED     19770099
197800              PERFORM 9999-SQL-ABEND                              19780099
197900     END-EVALUATE.                                                19790099
198000                                                                  19800099
198100                                                                  19810099
198200******************************************************************19820099
198300* 1120-GET-FCLTY-DESC                                             19830099
198400*    THIS PARAGRAPH WILL SELECT THE FACLITY DESC                  19840099
198500******************************************************************19850099
198600 1120-GET-FCLTY-DESC.                                             19860099
198700                                                                  19870099
198800     INITIALIZE XL071-COMMAREA-REC.                               19880099
198900     MOVE DK-OPER-UNT-ID        TO XL071-LOCATION-NUMBER          19890099
199000                                                                  19900099
199100     CALL XL071-LOCATION-MODULE USING XL071-COMMAREA-REC.         19910099
199200                                                                  19920099
199300     EVALUATE TRUE                                                19930099
199400     WHEN XL071-NO-ERRORS                                         19940099
199500         MOVE XL071-LOC-NM          TO AH1-FACILITY-DESC          19950099
199600     WHEN XL071-LOC-NOT-FOUND                                     19960099
199700     WHEN XL071-DC-ASGMT-NOT-FND                                  19970099
199800         MOVE 'UNKNOWN'             TO AH1-FACILITY-DESC          19980099
199900     WHEN XL071-BAD-DB2-RETURN                                    19990099
200000         DISPLAY '1120-GET-FCLTY-DESC'                            20000099
200100         DISPLAY 'CALL LOCATION MOD '                             20010099
200200         DISPLAY 'XLT00010'                                       20020099
200300         DISPLAY 'OPER UNT ID ' DK-OPER-UNT-ID                    20030099
200400         MOVE XL071-SQLCA             TO SQLCA                    20040099
200500         MOVE '1110-GET-FCLTY-DESC'   TO PV-PARAGRAPH-NAME        20050099
200600         MOVE 'CALL TO XLKUT071'     TO PV-DB2-OPERATION-ATTEMPTED20060099
200700         PERFORM 9999-SQL-ABEND                                   20070099
200800     END-EVALUATE.                                                20080099
200900/                                                                 20090099
201000******************************************************************20100099
201100* 1130-SELECT-AUDIT-INFO                                          20110099
201200*    THIS PARAGRAPH WILL SELECT ALL THE HEADER INFORMATION FOR    20120099
201300*    THE REPORT                                                   20130099
201400******************************************************************20140099
201500 1130-SELECT-AUDIT-INFO.                                          20150099
201600                                                                  20160099
201700     EXEC SQL                                                     20170099
201800         OPEN HEADER_CURSOR                                       20180099
201900     END-EXEC                                                     20190099
202000                                                                  20200099
202100     EVALUATE TRUE                                                20210099
202200         WHEN SQLCODE = ZERO                                      20220099
202300             CONTINUE                                             20230099
202400         WHEN OTHER                                               20240099
202500              MOVE '1130-SELECT-AUDIT-INFO.'                      20250099
202600                               TO  PV-PARAGRAPH-NAME              20260099
202700              MOVE 'OPEN OF HEADER_CURSOR'                        20270099
202800                               TO  PV-DB2-OPERATION-ATTEMPTED     20280099
202900              PERFORM 9999-SQL-ABEND                              20290099
203000     END-EVALUATE.                                                20300099
203100                                                                  20310099
203200                                                                  20320099
203300     EXEC SQL                                                     20330099
203400         FETCH HEADER_CURSOR                                      20340099
203500         INTO                                                     20350099
203600                :SUNAUD-OPER-UNT-ID                               20360099
203700              , :SUNAUD-AUD-STAT-CDE                              20370099
203800              , :SUNAUD-AUD-TYP-CDE                               20380099
203900              , :PV-DB2-CARTON-COUNT                              20390099
204000              , :PV-SCND-UNT-COUNT                                20400099
204100              , :PV-RFID-TGD-COUNT                                20410099
204200              , :PV-DB2-DATE                                      20420099
204300              , :PV-DB2-TIME                                      20430099
204400     END-EXEC                                                     20440099
204500                                                                  20450099
204600     EVALUATE TRUE                                                20460099
204700         WHEN SQLCODE = ZERO                                      20470099
204800             MOVE PV-DB2-DATE     TO PV-CURRENT-DATE              20480099
204900             MOVE PV-DB2-TIME     TO PV-CURRENT-TIME              20490099
205000             ADD 1                TO PV-HEADER-CURSOR-COUNT       20500099
205100         WHEN SQLCODE = +100                                      20510099
205200              MOVE ZERO   TO SUNAUD-OPER-UNT-ID                   20520099
205300                             PV-DB2-CARTON-COUNT                  20530099
205400                             PV-SCND-UNT-COUNT                    20540099
205500                             PV-RFID-TGD-COUNT                    20550099
205600                             PV-DB2-DATE                          20560099
205700                             PV-DB2-TIME                          20570099
205800              MOVE SPACES TO SUNAUD-AUD-STAT-CDE                  20580099
205900                             SUNAUD-AUD-TYP-CDE                   20590099
206000         WHEN OTHER                                               20600099
206100              MOVE '1130-SELECT-AUDIT-INFO.'                      20610099
206200                               TO  PV-PARAGRAPH-NAME              20620099
206300              MOVE 'FETCH OF HEADER_CURSOR'                       20630099
206400                               TO  PV-DB2-OPERATION-ATTEMPTED     20640099
206500              DISPLAY 'AUD NBR '   DK-AUD-CNTL-NBR                20650099
206600              DISPLAY 'PO NUMBER ' DK-PO-NBR                      20660099
206700              DISPLAY 'REC SEQ NBR ' DK-REC-SEQ-NBR               20670099
206800              PERFORM 9999-SQL-ABEND                              20680099
206900     END-EVALUATE.                                                20690099
207000                                                                  20700099
207100     EXEC SQL                                                     20710099
207200         CLOSE HEADER_CURSOR                                      20720099
207300     END-EXEC                                                     20730099
207400                                                                  20740099
207500     EVALUATE TRUE                                                20750099
207600         WHEN SQLCODE = ZERO                                      20760099
207700             CONTINUE                                             20770099
207800         WHEN OTHER                                               20780099
207900              MOVE '1130-SELECT-AUDIT-INFO.'                      20790099
208000                               TO  PV-PARAGRAPH-NAME              20800099
208100              MOVE 'CLOSE OF HEADER_CURSOR'                       20810099
208200                               TO  PV-DB2-OPERATION-ATTEMPTED     20820099
208300              PERFORM 9999-SQL-ABEND                              20830099
208400     END-EVALUATE.                                                20840099
208500                                                                  20850099
208600                                                                  20860099
208700******************************************************************20870099
208800*  1140-SELECT-UNITS-TRNSCRBD.                                    20880099
208900******************************************************************20890099
209000 1140-SELECT-UNITS-TRNSCRBD.                                      20900099
209100                                                                  20910099
209200     EXEC SQL                                                     20920099
209300         SELECT                                                   20930099
209400               SUM(EXPTED_ITM_QTY)                                20940099
209500         INTO                                                     20950099
209600               :PV-UNITS-TRNSCRBD                                 20960099
209700         FROM                                                     20970099
209800               TRECDIS A                                          20980099
209900         WHERE                                                    20990099
210000               A.ORD_NBR        = :DK-PO-NBR                      21000099
210100           AND A.REC_SEQ_NBR    = :DK-REC-SEQ-NBR                 21010099
210300     END-EXEC.                                                    21030099
210400                                                                  21040099
210500     EVALUATE TRUE                                                21050099
210600         WHEN SQLCODE = ZERO                                      21060099
210700              CONTINUE                                            21070099
210800         WHEN SQLCODE = +100                                      21080099
210900         WHEN SQLCODE = -305                                      21090099
211000               MOVE ZEROES TO PV-UNITS-TRNSCRBD                   21100099
211100         WHEN SQLWARN0 NOT EQUAL SPACE                            21110099
211200         WHEN SQLCODE NOT EQUAL ZERO                              21120099
211300              MOVE '1140-SELECT-UNITS-TRNSCRBD.'                  21130099
211400                               TO  PV-PARAGRAPH-NAME              21140099
211500              MOVE 'SELECT RECDIS INFORMATION'                    21150099
211600                               TO  PV-DB2-OPERATION-ATTEMPTED     21160099
211700              DISPLAY 'PO NBR ' DK-PO-NBR                         21170099
211800              DISPLAY 'REC SEQ NBR ' DK-REC-SEQ-NBR               21180099
211900              PERFORM 9999-SQL-ABEND                              21190099
212000     END-EVALUATE.                                                21200099
212100                                                                  21210099
212200                                                                  21220099
212300******************************************************************21230099
212400*  1150-GET-ERROR-QTYS.                                           21240099
212500*  THE TWO ERROR FILES HAVE BEEN SORT/SUMMED UP TO THE AUDIT/     21250099
212600*  PO/RECEIVER LEVEL.  THIS PARAGRAPH WILL READ THE RECIEVER      21260099
212700*  AND VENDOR OVER/SHORT TOTAL FILES TO GET THE TOTAL NUMBER OF   21270099
212800*  ERRORS AND UNITS IN ERROR FOR THE HEADING.                     21280099
212900******************************************************************21290099
213000 1150-GET-ERROR-QTYS.                                             21300099
213100                                                                  21310099
213200     INITIALIZE     PV-HEADING-TOT-ERRORS                         21320099
213300                    PV-HEADING-UNITS-IN-ERROR                     21330099
213400                    PV-ERROR-QTY.                                 21340099
213500                                                                  21350099
213600     SET PS-NO-RCVR-OVER-SHORT    TO TRUE.                        21360099
213700                                                                  21370099
213800*  THE RECEIVER FILE IS PROCESSED FIRST TO CREATE THE RECEIVER    21380099
213900*  OVER/SHORT BUCKETS FOR THE SUMMARY SECTION.  THIS FILE IS      21390099
214000*  ALSO SUMMED BY SKU SINCE THERE COULD BE MULTIPLE OVER/SHORT    21400099
214100*  ERRORS FOR MULTIPLE SKUS.                                      21410099
214110                                                                  21411099
214200     PERFORM UNTIL                                                21420099
214300        SU004-AUD-CNTL-NBR > SU003-AUD-CNTL-NBR OF OS-FILE        21430099
214400     OR SU004-PO-NBR       > SU003-PO-NBR       OF OS-FILE        21440099
214500     OR SU004-REC-SEQ-NBR  > SU003-REC-SEQ-NBR  OF OS-FILE        21450099
214600     OR PS-EOF-RCVR-TOTAL-ERROR                                   21460099
214700         IF  SU004-AUD-CNTL-NBR = SU003-AUD-CNTL-NBR OF OS-FILE   21470099
214800         AND SU004-PO-NBR       = SU003-PO-NBR       OF OS-FILE   21480099
214900         AND SU004-REC-SEQ-NBR  = SU003-REC-SEQ-NBR  OF OS-FILE   21490099
214910                                                                  21491099
215000*            FOR EACH SKU OF EACH STORE OF THIS RECEIVER, ADD UP  21500099
215100*            THE TOTALS                                           21510099
215110                                                                  21511099
215200             IF SU004-QTY-AUD = SU004-QTY-RECV                    21520099
215300                CONTINUE                                          21530099
215400             ELSE                                                 21540099
215500                 IF SU004-QTY-AUD > SU004-QTY-RECV                21550099
215600                    MOVE 'RCVR OVER      ' TO PV-ERROR-DESC       21560099
215700                 ELSE                                             21570099
215800                    MOVE 'RCVR SHORT     ' TO PV-ERROR-DESC       21580099
215900                 END-IF                                           21590099
216000             END-IF                                               21600099
216200             MOVE SU004-TOT-ERR-QTY TO PV-ERROR-QTY               21620099
216500             IF PV-ERROR-QTY > 0                                  21650099
216600                 SET PS-RCVR-OVER-SHORT-FOUND   TO TRUE           21660099
216700                 PERFORM 4200-ACCUM-SUM-TABLES                    21670099
216800             END-IF                                               21680099
216900         END-IF                                                   21690099
217000                                                                  21700099
217100         PERFORM 8003-READ-RCVR-TOT-ERR-FILE                      21710099
217200     END-PERFORM.                                                 21720099
217300                                                                  21730099
217400*    PROCESS ALL THE VENDOR OVER/SHORT RECORDS FOR THIS RECEIVER  21740099
217410                                                                  21741099
217500     PERFORM UNTIL                                                21750099
217600        SU003-AUD-CNTL-NBR OF TE-FILE >                           21760099
217700        SU003-AUD-CNTL-NBR OF OS-FILE                             21770099
217800        AND CC-QC-AUDIT                                           21780099
217900     OR SU003-PO-NBR       OF TE-FILE >                           21790099
218000        SU003-PO-NBR       OF OS-FILE                             21800099
218100     OR SU003-REC-SEQ-NBR  OF TE-FILE >                           21810099
218200        SU003-REC-SEQ-NBR  OF OS-FILE                             21820099
218300     OR PS-EOF-VND-TOT-ERR-FILE                                   21830099
218310                                                                  21831099
218400*        FOR EACH RECORD OF THIS RECEIVER, ADD UP THE TOTALS      21840099
218410                                                                  21841099
218500         IF  SU003-AUD-CNTL-NBR OF TE-FILE =                      21850099
218600             SU003-AUD-CNTL-NBR OF OS-FILE                        21860099
218700         AND SU003-PO-NBR       OF TE-FILE =                      21870099
218800             SU003-PO-NBR       OF OS-FILE                        21880099
218900         AND SU003-REC-SEQ-NBR  OF TE-FILE =                      21890099
219000             SU003-REC-SEQ-NBR  OF OS-FILE                        21900099
219100             ADD SU003-TOT-ERR-QTY OF TE-FILE                     21910099
219200                                   TO PV-HEADING-TOT-ERRORS       21920099
219300             ADD SU003-UNT-ERR-CNT-COMBO OF TE-FILE               21930099
219400                                   TO PV-HEADING-UNITS-IN-ERROR   21940099
219500         END-IF                                                   21950099
219600                                                                  21960099
219700         PERFORM 8001-READ-VND-TOT-ERR-FILE                       21970099
219800     END-PERFORM.                                                 21980099
219900                                                                  21990099
220000******************************************************************22000099
220100*  1160-GET-UNITS-AUDITED.                                        22010099
220200******************************************************************22020099
220300 1160-GET-UNITS-AUDITED.                                          22030099
220400                                                                  22040099
220500     EXEC SQL                                                     22050099
220600         SELECT                                                   22060099
220700               COUNT(DISTINCT A.SHIPT_UNT_ID)                     22070099
220800             , SUM(SCND_UNT_QTY)                                  22080099
220900         INTO                                                     22090099
221000               :PV-AUDIT-CARTON-COUNT                             22100099
221100             , :PV-SCND-UNT-QTY                                   22110099
221200         FROM                                                     22120099
221300               TSUAUPC A                                          22130099
221400           ,   TSUATRN B                                          22140099
221500         WHERE                                                    22150099
221600               A.AUD_CNTL_NBR   = :DK-AUD-CNTL-NBR                22160099
221700           AND A.SCN_TYP_CDE    <> :PC-E                          22170099
221800           AND A.AUD_CNTL_NBR   = B.AUD_CNTL_NBR                  22180099
221900           AND A.SHIPT_UNT_ID   = B.SHIPT_UNT_ID                  22190099
222000           AND B.TRN_NBR      = :DK-PO-NBR                        22200099
222100           AND B.REC_SEQ_NBR  = :DK-REC-SEQ-NBR                   22210099
222200     END-EXEC.                                                    22220099
222300                                                                  22230099
222400     EVALUATE TRUE                                                22240099
222500         WHEN SQLCODE = ZERO                                      22250099
222600              MOVE PV-SCND-UNT-QTY                                22260099
222700                               TO PV-TOT-UNITS-AUDITED            22270099
222800                                                                  22280099
222900         WHEN SQLCODE = +100                                      22290099
223000         WHEN SQLCODE = -305                                      22300099
223100              MOVE ZEROES      TO PV-SCND-UNT-QTY                 22310099
223200                                  PV-TOT-UNITS-AUDITED            22320099
223300                                  PV-AUDIT-CARTON-COUNT           22330099
223400                                                                  22340099
223500         WHEN SQLWARN0 NOT EQUAL SPACE                            22350099
223600         WHEN SQLCODE NOT EQUAL ZERO                              22360099
223700              MOVE '1160-GET-UNITS-AUDITED'                       22370099
223800                               TO  PV-PARAGRAPH-NAME              22380099
223900              MOVE 'SELECT TSUAUPC INFORMATION'                   22390099
224000                               TO  PV-DB2-OPERATION-ATTEMPTED     22400099
224100              DISPLAY 'AUD CNTL NBR ' DK-AUD-CNTL-NBR             22410099
224200              DISPLAY 'PO NBR '       DK-PO-NBR                   22420099
224300              DISPLAY 'SEQ NBR '      DK-REC-SEQ-NBR              22430099
224400              PERFORM 9999-SQL-ABEND                              22440099
224500     END-EVALUATE.                                                22450099
224600                                                                  22460099
237700******************************************************************23770099
237800*  1172-GET-QC-ERRORS.                                            23780099
237900******************************************************************23790099
238000 1172-GET-QC-ERRORS.                                              23800099
238100                                                                  23810099
238200     EXEC SQL                                                     23820099
238300         SELECT COUNT(*)                                          23830099
238400           INTO :PV-QC-ERRORS                                     23840099
238500           FROM TSUEXCP A                                         23850099
238600               ,TVILNCD B                                         23860099
238700          WHERE A.AUD_CNTL_NBR    = :DK-AUD-CNTL-NBR              23870099
238800            AND A.VILN_GP_CDE     = :PC-VA                        23880099
238900            AND A.VILN_GP_CDE     = B.VILN_GP_CDE                 23890099
239000            AND B.VILN_CTG_CDE   <> :PC-R                         23900099
239100            AND A.VILN_GP_SEQ_NBR = B.VILN_GP_SEQ_NBR             23910099
239200     END-EXEC.                                                    23920099
239300                                                                  23930099
239400     EVALUATE TRUE                                                23940099
239500         WHEN SQLCODE = ZERO                                      23950099
239600              MOVE PV-QC-ERRORS  TO PV-HL-TOTAL-ERRORS            23960099
239700                                                                  23970099
239800         WHEN SQLCODE = +100                                      23980099
239900         WHEN SQLCODE = -305                                      23990099
240000               MOVE ZEROES       TO PV-HL-TOTAL-ERRORS            24000099
240100                                                                  24010099
240200         WHEN SQLWARN0 NOT EQUAL SPACE                            24020099
240300         WHEN SQLCODE NOT EQUAL ZERO                              24030099
240400              MOVE '1172-GET-QC-ERRORS'                           24040099
240500                                 TO PV-PARAGRAPH-NAME             24050099
240600              MOVE 'SELECT QC TOT ERRORS INFORMATION'             24060099
240700                                 TO PV-DB2-OPERATION-ATTEMPTED    24070099
240800              DISPLAY 'AUD CNTL NBR ' DK-AUD-CNTL-NBR             24080099
240900              PERFORM 9999-SQL-ABEND                              24090099
241000     END-EVALUATE.                                                24100099
241100                                                                  24110099
241200******************************************************************24120099
241300*  1172-GET-RFID42-TOT-ERRORS.                                    24130099
241400******************************************************************24140099
241500 1172-GET-RFID42-TOT-ERRORS.                                      24150099
241600                                                                  24160099
241700     EXEC SQL                                                     24170099
241800         SELECT SUM(B.SCND_UNT_QTY - B.RFID_TGD_QTY)              24180099
241900         INTO  :PV-RFID-TOT-ERRORS                                24190099
242000         FROM (SELECT                                             24200099
242100                   A.AUD_CNTL_NBR                                 24210099
242200                 , A.SHIPT_UNT_ID                                 24220099
242300                 , A.UPC_NBR                                      24230099
242400                 , A.SCN_TMST                                     24240099
242500                 FROM TSUEXCP A                                   24250099
242600                WHERE A.AUD_CNTL_NBR = :DK-AUD-CNTL-NBR           24260099
242700                  AND VILN_GP_SEQ_NBR = 42) C                     24270099
242800            ,  TSUAUPC B                                          24280099
242900            ,  TSUATRN D                                          24290099
243000         WHERE B.AUD_CNTL_NBR       =  :DK-AUD-CNTL-NBR           24300099
243100           AND C.AUD_CNTL_NBR       =  B.AUD_CNTL_NBR             24310099
243200           AND C.SHIPT_UNT_ID       =  B.SHIPT_UNT_ID             24320099
243300           AND C.UPC_NBR            =  B.UPC_NBR                  24330099
243400           AND D.AUD_CNTL_NBR       =  B.AUD_CNTL_NBR             24340099
243500           AND D.SHIPT_UNT_ID       =  B.SHIPT_UNT_ID             24350099
243600           AND C.SCN_TMST           =  B.SCN_TMST                 24360099
243700           AND C.SCN_TMST          >=  D.UNT_AUD_STRT_TMST        24370099
243800     END-EXEC.                                                    24380099
243900                                                                  24390099
244000     EVALUATE TRUE                                                24400099
244100         WHEN SQLCODE = ZERO                                      24410099
244200             ADD PV-RFID-TOT-ERRORS     TO PV-HL-TOTAL-ERRORS     24420099
244300                                                                  24430099
244400         WHEN SQLCODE = +100                                      24440099
244500         WHEN SQLCODE = -305                                      24450099
244600             MOVE ZEROS                 TO PV-RFID-TOT-ERRORS     24460099
244700                                                                  24470099
244800         WHEN SQLWARN0 NOT EQUAL SPACE                            24480099
244900         WHEN SQLCODE NOT EQUAL ZERO                              24490099
245000              MOVE '1172-GET-RFID42-TOT-ERRORS'                   24500099
245100                               TO  PV-PARAGRAPH-NAME              24510099
245200              MOVE 'SELECT RFID UNITS IN ERR INFORMATION'         24520099
245300                               TO  PV-DB2-OPERATION-ATTEMPTED     24530099
245400              DISPLAY 'AUD CNTL NBR ' DK-AUD-CNTL-NBR             24540099
245500              PERFORM 9999-SQL-ABEND                              24550099
245600     END-EVALUATE.                                                24560099
245700                                                                  24570099
245800******************************************************************24580099
245900*  1180-GET-RFID-UNITS-IN-ERROR.                                  24590099
246000******************************************************************24600099
246100 1180-GET-RFID-UNITS-IN-ERROR.                                    24610099
246200                                                                  24620099
246300     EXEC SQL                                                     24630099
246400         SELECT SUM(B.RFID_TGD_QTY)                               24640099
246500         INTO                                                     24650099
246600               :PV-RFID-UNITS-IN-ERROR                            24660099
246700         FROM (SELECT DISTINCT                                    24670099
246800                   A.AUD_CNTL_NBR                                 24680099
246900                 , A.SHIPT_UNT_ID                                 24690099
247000                 , A.UPC_NBR                                      24700099
247100                 , A.SCN_TMST                                     24710099
247200                 FROM TSUEXCP A                                   24720099
247300                WHERE A.AUD_CNTL_NBR = :DK-AUD-CNTL-NBR           24730099
247400                  AND VILN_GP_SEQ_NBR IN (38, 39, 40, 41)) C      24740099
247500            ,  TSUAUPC B                                          24750099
247600            ,  TSUATRN D                                          24760099
247700         WHERE                                                    24770099
247800               B.AUD_CNTL_NBR       =  :DK-AUD-CNTL-NBR           24780099
247900           AND C.AUD_CNTL_NBR       =  B.AUD_CNTL_NBR             24790099
248000           AND C.SHIPT_UNT_ID       =  B.SHIPT_UNT_ID             24800099
248100           AND C.UPC_NBR            =  B.UPC_NBR                  24810099
248200           AND D.AUD_CNTL_NBR       =  B.AUD_CNTL_NBR             24820099
248300           AND D.SHIPT_UNT_ID       =  B.SHIPT_UNT_ID             24830099
248400           AND C.SCN_TMST           =  B.SCN_TMST                 24840099
248500           AND C.SCN_TMST          >=  D.UNT_AUD_STRT_TMST        24850099
248600     END-EXEC.                                                    24860099
248700                                                                  24870099
248800     EVALUATE TRUE                                                24880099
248900         WHEN SQLCODE = ZERO                                      24890099
249000              ADD PV-RFID-UNITS-IN-ERROR TO PV-HL-UNITS-IN-ERROR  24900099
249100                                                                  24910099
249200         WHEN SQLCODE = +100                                      24920099
249300         WHEN SQLCODE = -305                                      24930099
249400               MOVE ZEROES               TO PV-HL-UNITS-IN-ERROR  24940099
249500                                                                  24950099
249600         WHEN SQLWARN0 NOT EQUAL SPACE                            24960099
249700         WHEN SQLCODE NOT EQUAL ZERO                              24970099
249800              MOVE '1180-GET-RFID-UNITS-IN-ERROR'                 24980099
249900                               TO  PV-PARAGRAPH-NAME              24990099
250000              MOVE 'SELECT RFID UNITS IN ERR INFORMATION'         25000099
250100                               TO  PV-DB2-OPERATION-ATTEMPTED     25010099
250200              DISPLAY 'AUD CNTL NBR ' DK-AUD-CNTL-NBR             25020099
250300              PERFORM 9999-SQL-ABEND                              25030099
250400     END-EVALUATE.                                                25040099
250500                                                                  25050099
250600******************************************************************25060099
250700*  1181-GET-RFID42-UNITS-IN-ERROR.                                25070099
250800******************************************************************25080099
250900 1181-GET-RFID42-UNITS-IN-ERROR.                                  25090099
251000                                                                  25100099
251100     EXEC SQL                                                     25110099
251200         SELECT SUM(B.SCND_UNT_QTY - B.RFID_TGD_QTY)              25120099
251300         INTO                                                     25130099
251400               :PV-RFID-UNITS-IN-ERROR                            25140099
251500         FROM (SELECT DISTINCT                                    25150099
251600                   A.AUD_CNTL_NBR                                 25160099
251700                 , A.SHIPT_UNT_ID                                 25170099
251800                 , A.UPC_NBR                                      25180099
251900                 , A.SCN_TMST                                     25190099
252000                 FROM TSUEXCP A                                   25200099
252100                WHERE A.AUD_CNTL_NBR = :DK-AUD-CNTL-NBR           25210099
252200                  AND VILN_GP_SEQ_NBR = 42) C                     25220099
252300            ,  TSUAUPC B                                          25230099
252400            ,  TSUATRN D                                          25240099
252500         WHERE                                                    25250099
252600               B.AUD_CNTL_NBR       =  :DK-AUD-CNTL-NBR           25260099
252700           AND C.AUD_CNTL_NBR       =  B.AUD_CNTL_NBR             25270099
252800           AND C.SHIPT_UNT_ID       =  B.SHIPT_UNT_ID             25280099
252900           AND C.UPC_NBR            =  B.UPC_NBR                  25290099
253000           AND D.AUD_CNTL_NBR       =  B.AUD_CNTL_NBR             25300099
253100           AND D.SHIPT_UNT_ID       =  B.SHIPT_UNT_ID             25310099
253200           AND C.SCN_TMST           =  B.SCN_TMST                 25320099
253300           AND C.SCN_TMST          >=  D.UNT_AUD_STRT_TMST        25330099
253400     END-EXEC.                                                    25340099
253500                                                                  25350099
253600     EVALUATE TRUE                                                25360099
253700         WHEN SQLCODE = ZERO                                      25370099
253800             ADD  PV-RFID-UNITS-IN-ERROR TO PV-HL-UNITS-IN-ERROR  25380099
253900         WHEN SQLCODE = +100                                      25390099
254000         WHEN SQLCODE = -305                                      25400099
254100               MOVE ZEROES               TO PV-RFID-UNITS-IN-ERROR25410099
254200         WHEN SQLWARN0 NOT EQUAL SPACE                            25420099
254300         WHEN SQLCODE NOT EQUAL ZERO                              25430099
254400              MOVE '1181-GET-RFID42-UNITS-IN-ERROR'               25440099
254500                               TO  PV-PARAGRAPH-NAME              25450099
254600              MOVE 'SELECT RFID UNITS IN ERR INFORMATION'         25460099
254700                               TO  PV-DB2-OPERATION-ATTEMPTED     25470099
254800              DISPLAY 'AUD CNTL NBR ' DK-AUD-CNTL-NBR             25480099
254900              PERFORM 9999-SQL-ABEND                              25490099
255000     END-EVALUATE.                                                25500099
255100                                                                  25510099
255200******************************************************************25520099
255300*  1190-GET-HEADER-INFO.                                          25530099
255400******************************************************************25540099
255500 1190-GET-HEADER-INFO.                                            25550099
255600                                                                  25560099
255700     EXEC SQL                                                     25570099
255800         SELECT                                                   25580099
255900                A.OPER_UNT_ID                                     25590099
256000              , A.AUD_STAT_CDE                                    25600099
256100              , A.AUD_TYP_CDE                                     25610099
256200              , CURRENT DATE                                      25620099
256300              , CURRENT TIME                                      25630099
256400         INTO                                                     25640099
256500                :SUNAUD-OPER-UNT-ID                               25650099
256600              , :SUNAUD-AUD-STAT-CDE                              25660099
256700              , :SUNAUD-AUD-TYP-CDE                               25670099
256800              , :PV-DB2-DATE                                      25680099
256900              , :PV-DB2-TIME                                      25690099
257000         FROM                                                     25700099
257100               TSUNAUD A                                          25710099
257200         WHERE                                                    25720099
257300               A.AUD_CNTL_NBR = :DK-AUD-CNTL-NBR                  25730099
257400         GROUP BY                                                 25740099
257500                A.OPER_UNT_ID                                     25750099
257600              , A.AUD_STAT_CDE                                    25760099
257700              , A.AUD_TYP_CDE                                     25770099
257800         WITH UR                                                  25780099
257900     END-EXEC.                                                    25790099
258000                                                                  25800099
258100     EVALUATE TRUE                                                25810099
258200         WHEN SQLCODE = ZERO                                      25820099
258300             MOVE PV-DB2-DATE     TO PV-CURRENT-DATE              25830099
258400             MOVE PV-DB2-TIME     TO PV-CURRENT-TIME              25840099
258500         WHEN SQLCODE = +100                                      25850099
258600              MOVE ZERO           TO SUNAUD-OPER-UNT-ID           25860099
258700              MOVE SPACES         TO SUNAUD-AUD-STAT-CDE          25870099
258800              MOVE SPACES         TO SUNAUD-AUD-TYP-CDE           25880099
258900              MOVE PV-DB2-DATE    TO PV-CURRENT-DATE              25890099
259000              MOVE PV-DB2-TIME    TO PV-CURRENT-TIME              25900099
259100         WHEN SQLWARN0 NOT EQUAL SPACE                            25910099
259200         WHEN SQLCODE NOT EQUAL ZERO                              25920099
259300              MOVE '1190-GET-HEADER-INFO'                         25930099
259400                               TO  PV-PARAGRAPH-NAME              25940099
259500              MOVE 'SELECT FROM TSUNAUD'                          25950099
259600                               TO  PV-DB2-OPERATION-ATTEMPTED     25960099
259700              DISPLAY 'AUD CNTL NBR ' DK-AUD-CNTL-NBR             25970099
259800              PERFORM 9999-SQL-ABEND                              25980099
259900     END-EVALUATE.                                                25990099
260000                                                                  26000099
260100                                                                  26010099
260200******************************************************************26020099
260300* 1300-SELECT-AUDIT-TYPE                                          26030099
260400*    THIS PARAGRAPH WILL SELECT FROM SUT_PO_AUD_REQ TO CHECK IF   26040099
260500*    THE AUDIT IS PROMPTED OR MANUAL                              26050099
260600******************************************************************26060099
260700 1300-SELECT-AUDIT-TYPE.                                          26070099
260800                                                                  26080099
260900     INITIALIZE DCLSUT00015.                                      26090099
261000                                                                  26100099
261100     EXEC SQL                                                     26110099
261200         SELECT PKGNG_TYP_CDE                                     26120099
261300               ,VALUE(RWRK_AUD_CNTL_NBR,0)                        26130099
261400         INTO  :SUT00015-PKGNG-TYP-CDE                            26140099
261500              ,:SUT00015-RWRK-AUD-CNTL-NBR                        26150099
261600         FROM   SUT_PO_AUD_REQ                                    26160099
261700         WHERE  AUD_CNTL_NBR   = :DK-AUD-CNTL-NBR                 26170099
261800     END-EXEC.                                                    26180099
261900                                                                  26190099
262000     EVALUATE TRUE                                                26200099
262100       WHEN SQLCODE = ZERO                                        26210099
262200            SET AH8-PROMPTED-AUDIT TO TRUE                        26220099
262300                                                                  26230099
262400       WHEN SQLCODE = +100                                        26240099
262500            SET AH8-MANUAL-AUDIT   TO TRUE                        26250099
262600                                                                  26260099
262700       WHEN OTHER                                                 26270099
262800            DISPLAY 'AUDIT NUMBER ' DK-AUD-CNTL-NBR               26280099
262900            MOVE '1300-SELECT-AUDIT-TYPE'                         26290099
263000                                   TO  PV-PARAGRAPH-NAME          26300099
263100            MOVE 'SELECT OF SUT_PO_AUD_REQ'                       26310099
263200                                   TO PV-DB2-OPERATION-ATTEMPTED  26320099
263300            PERFORM 9999-SQL-ABEND                                26330099
263400     END-EVALUATE.                                                26340099
263500                                                                  26350099
263600                                                                  26360099
263700******************************************************************26370099
263800* 2000-CREATE-REPORT -- CREATE THE AUDIT SUMMARY REPORT FOR A     26380099
263900*    PARTICULAR RECEIVER -- THIS PARAGRAPH WILL REPEAT UNTIL THE  26390099
264000*    END OF THE EXTRACT FILE                                      26400099
264100*                                                                 26410099
264200*    -GET THE RECEIVER LEVEL INFO AND START A NEW PAGE PRINTING   26420099
264300*     THE RECEIVER INFORMATION                                    26430099
264400*    -SPIN THROUGH THE PICKING ERRORS FIRST, PRINTING DETAIL LINES26440099
264500*     OR ACCUMULATING COUNT OF SKUS WITH NO ERRORS.               26450099
264600*    -THEN SPIN THORUGH THE TICKETING ERRORS DOING THE SAME THING 26460099
264700*    -AFTER ALL DETAIL, CALCULATE THE ERROR RATIO'S, AND DISPLAY  26470099
264800*     THE SKU LIST                                                26480099
264900******************************************************************26490099
265000 2000-CREATE-REPORT.                                              26500099
265100                                                                  26510099
265200*    FOR EACH NEW AUDIT NUMBER OR RECEIVER NUMBER, CHECK THE      26520099
265300*    RECEIVER OVER/SHORT FILE IF THE RECEIVER OVER/SHORT MESSAGE  26530099
265400*    NEEDS TO BE PRINTED.  THEN RE-RETRIEVE AND PRINT THE         26540099
265500*    HEADER INFORMATION FOR THE NEW AUDIT/RECIEVER                26550099
265510                                                                  26551099
265600     IF  SU003-AUD-CNTL-NBR  OF OS-FILE  = PV-HOLD-AUD-CNTL-NBR   26560099
265700     AND SU003-PO-NBR        OF OS-FILE  = PV-HOLD-PO-NBR         26570099
265800     AND SU003-REC-SEQ-NBR   OF OS-FILE  = PV-HOLD-REC-SEQ-NBR    26580099
265900         CONTINUE                                                 26590099
266000     ELSE                                                         26600099
266100         PERFORM 8100-END-OF-RECEIVER-LOGIC                       26610099
266200         MOVE ZEROS              TO PV-HOLD-SHIPT-UNT-ID          26620099
266300                                    PV-HOLD-STR                   26630099
266400         MOVE SU003-AUD-CNTL-NBR OF OS-FILE                       26640099
266500                                 TO PV-HOLD-AUD-CNTL-NBR          26650099
266600                                    DK-AUD-CNTL-NBR               26660099
266700         MOVE SU003-PO-NBR       OF OS-FILE                       26670099
266800                                 TO PV-HOLD-PO-NBR                26680099
266900         MOVE SU003-REC-SEQ-NBR  OF OS-FILE                       26690099
267000                                 TO PV-HOLD-REC-SEQ-NBR           26700099
267100         INITIALIZE PA-PIC-ERROR-SUMMARY-TABLE                    26710099
267200                    PA-TIC-ERROR-SUMMARY-TABLE                    26720099
267300                    PA-RFID-ERROR-SUMMARY-TABLE                   26730099
267310                                                                  26731099
267400*        PRINT THE PAGE HEADINGS                                  26740099
267410                                                                  26741099
267500         PERFORM 1100-SET-UP-HEADER                               26750099
267600         PERFORM 3000-PRINT-PAGE-HEADING                          26760099
267700     END-IF.                                                      26770099
267800                                                                  26780099
267900     IF CC-QC-AUDIT                                               26790099
267910                                                                  26791099
268000*    FOR EACH ITEM ON THE OVER/SHORT FILE, FILL IN ALL THE INFO,  26800099
268100*    AND PRINT A LINE IF THERE IS AN OVER/SHORT                   26810099
268110                                                                  26811099
268200       IF SU003-QTY-EXP OF OS-FILE  = SU003-QTY-AUD OF OS-FILE    26820099
268300         CONTINUE                                                 26830099
268400       ELSE                                                       26840099
268500         PERFORM 2100-FILL-IN-DETAIL-LINE                         26850099
268510                                                                  26851099
268600*        SET-UP A SHORTAGE                                        26860099
268610                                                                  26861099
268700         DISPLAY 'SU003-QTY-EXP OF OS-FILE: '                     26870099
268800             SU003-QTY-EXP OF OS-FILE                             26880099
268900         DISPLAY 'SU003-QTY-AUD OF OS-FILE: '                     26890099
269000             SU003-QTY-AUD OF OS-FILE                             26900099
269100         IF SU003-QTY-EXP OF OS-FILE > SU003-QTY-AUD OF OS-FILE   26910099
269200             MOVE 'VENDOR SHORT   '   TO DL-ERROR-DESC            26920099
269300                                         PV-ERROR-DESC            26930099
269400             COMPUTE PV-ERROR-QTY =                               26940099
269500                 SU003-QTY-EXP OF OS-FILE -                       26950099
269600                 SU003-QTY-AUD OF OS-FILE                         26960099
269700             MOVE PV-ERROR-QTY TO DL-ERROR-QTY                    26970099
269800             COMPUTE PV-SHORT-QTY =                               26980099
269900                 SU003-QTY-EXP OF OS-FILE -                       26990099
270000                 SU003-QTY-AUD OF OS-FILE                         27000099
270010                                                                  27001099
270100*        SET-UP AN OVERAGE                                        27010099
270110                                                                  27011099
270200         ELSE                                                     27020099
270300             IF SU003-QTY-EXP OF OS-FILE = 0                      27030099
270400                 MOVE 'VND OVER/MISPCK'   TO DL-ERROR-DESC        27040099
270500                                             PV-ERROR-DESC        27050099
270600             ELSE                                                 27060099
270700                 MOVE 'VENDOR OVER    '   TO DL-ERROR-DESC        27070099
270800                                             PV-ERROR-DESC        27080099
270900             END-IF                                               27090099
271000             COMPUTE PV-ERROR-QTY =                               27100099
271100                     SU003-QTY-AUD OF OS-FILE -                   27110099
271200                     SU003-QTY-EXP OF OS-FILE                     27120099
271300             MOVE PV-ERROR-QTY to DL-ERROR-QTY                    27130099
271400             COMPUTE PV-OVER-QTY  =                               27140099
271500                 SU003-QTY-EXP OF OS-FILE -                       27150099
271600                 SU003-QTY-AUD OF OS-FILE                         27160099
271700         END-IF                                                   27170099
271800                                                                  27180099
271900         IF  SU003-SKU-DEPT-NBR OF OS-FILE = '000'                27190099
272000             MOVE SU003-QTY-AUD OF OS-FILE                        27200099
272100                                      TO PV-HOLD-QTY-AUD          27210099
272200             MOVE SU003-QTY-EXP OF OS-FILE                        27220099
272300                                      TO PV-HOLD-QTY-EXP          27230099
272400         ELSE                                                     27240099
272500             PERFORM 2050-FIND-SKU                                27250099
272600         END-IF                                                   27260099
272700                                                                  27270099
272800         IF  PS-PRINT-SKU-ORD                                     27280099
272900                     OR SU003-SKU-DEPT-NBR OF OS-FILE = ZERO      27290099
273000             MOVE PV-HOLD-QTY-AUD         TO PV-DISP-COMP         27300099
273100             MOVE PV-DISP-COMP            TO DL-RECEIVED-AS-TEXT  27310099
273200             MOVE PV-HOLD-QTY-EXP         TO PV-DISP-COMP         27320099
273300             MOVE PV-DISP-COMP            TO DL-ORDERED-AS-TEXT   27330099
273400             SET  PS-DO-NOT-PRINT-SKU-ORD TO TRUE                 27340099
273500*  DRS                                                            27350099
273700             IF AH2-DEPT        = ZERO                            27370099
273800                 IF PV-SHORT-QTY > ZERO                           27380099
273900                    MOVE PV-SHORT-QTY        TO PV-DISP-COMP      27390099
274000                    MOVE PV-DISP-COMP        TO DL-ORDERED-AS-TEXT27400099
274100                 ELSE                                             27410099
274200                    MOVE PV-OVER-QTY         TO PV-DISP-COMP      27420099
274300                    MOVE PV-DISP-COMP        TO DL-ORDERED-AS-TEXT27430099
274400                 END-IF                                           27440099
274500             END-IF                                               27450099
274600*  DRS                                                            27460099
274700         ELSE                                                     27470099
274800             IF DL-STYLE-NBR = 'NOT FOUND' AND                    27480099
274900                DL-COLOR = 'NOT FOUND' AND                        27490099
275000                DL-SIZE = 'NOT FOUND'                             27500099
275100                     IF PV-SHORT-QTY > ZERO                       27510099
275200                        MOVE PV-SHORT-QTY    TO PV-DISP-COMP      27520099
275300                        MOVE PV-DISP-COMP    TO DL-ORDERED-AS-TEXT27530099
275400                     ELSE                                         27540099
275500                        MOVE PV-OVER-QTY     TO PV-DISP-COMP      27550099
275600                        MOVE PV-DISP-COMP    TO DL-ORDERED-AS-TEXT27560099
275700                     END-IF                                       27570099
275800             ELSE                                                 27580099
275900                 MOVE SPACES              TO DL-RECEIVED-AS-TEXT  27590099
276000                 MOVE SPACES              TO DL-ORDERED-AS-TEXT   27600099
276100             END-IF                                               27610099
276200         END-IF                                                   27620099
276300                                                                  27630099
276400         IF  DL-ERROR-DESC = 'VND OVER/MISPCK'                    27640099
276500         AND PV-HOLD-QTY-EXP > 0                                  27650099
276600             MOVE 'VENDOR OVER    '   TO DL-ERROR-DESC            27660099
276700                                         PV-ERROR-DESC            27670099
276800         END-IF                                                   27680099
276900                                                                  27690099
277000         IF PV-ERROR-QTY < 0                                      27700099
277100             COMPUTE PV-ERROR-QTY = PV-ERROR-QTY * -1             27710099
277200         END-IF                                                   27720099
277300         IF PV-ERROR-QTY > 0                                      27730099
277400             MOVE 'UNT'           TO DL-ERROR-TYPE                27740099
277500             PERFORM 4200-ACCUM-SUM-TABLES                        27750099
277600                                                                  27760099
277700             PERFORM 8002-WRITE-DETAIL-LINE                       27770099
277800         END-IF                                                   27780099
277900       END-IF                                                     27790099
278000     END-IF.                                                      27800099
278100                                                                  27810099
278200     PERFORM 4000-CHECK-EXCEPTIONS.                               27820099
278300                                                                  27830099
278400     PERFORM 8000-READ-VND-OVER-SHORT-FILE.                       27840099
278500                                                                  27850099
278600                                                                  27860099
278700******************************************************************27870099
278800* 2050-FIND-SKU                                                   27880099
278900*  THIS PARAGRAPH WILL ATTEMPT TO GET THE AUDITED AND EXPECTED    27890099
279000*  QUANTITY FOR THE SKU FOR THE ASSOCIATED UPC BEING PROCESSED    27900099
279100*  FROM THE DRIVER FILE.                                          27910099
279200******************************************************************27920099
279700 2050-FIND-SKU.                                                   27970099
279800                                                                  27980099
279900     IF  PS-EOF-SKU-TOTAL-FILE                                    27990099
280000         MOVE SU003-QTY-AUD  OF OS-FILE                           28000099
280100                                  TO PV-HOLD-QTY-AUD              28010099
280200         MOVE SU003-QTY-EXP  OF OS-FILE                           28020099
280300                                  TO PV-HOLD-QTY-EXP              28030099
280400     ELSE                                                         28040099
280500         IF  SU003-AUD-CNTL-NBR  OF OS-FILE  =                    28050099
280600             SU003-AUD-CNTL-NBR  OF OS-SKU-FILE                   28060099
280700         AND SU003-PO-NBR        OF OS-FILE  =                    28070099
280800             SU003-PO-NBR        OF OS-SKU-FILE                   28080099
280900         AND SU003-REC-SEQ-NBR   OF OS-FILE  =                    28090099
281000             SU003-REC-SEQ-NBR   OF OS-SKU-FILE                   28100099
281100         AND SU003-SHIPT-UNT-ID  OF OS-FILE  =                    28110099
281200             SU003-SHIPT-UNT-ID  OF OS-SKU-FILE                   28120099
281300         AND SU003-SKU-NBR       OF OS-FILE  =                    28130099
281400             SU003-SKU-NBR       OF OS-SKU-FILE                   28140099
281500             MOVE SU003-QTY-AUD  OF OS-SKU-FILE                   28150099
281600                                      TO PV-HOLD-QTY-AUD          28160099
281700             MOVE SU003-QTY-EXP  OF OS-SKU-FILE                   28170099
281800                                      TO PV-HOLD-QTY-EXP          28180099
281900         ELSE                                                     28190099
282000             SET PS-SKU-SEARCH-PROCESS TO TRUE                    28200099
282100             MOVE SU003-AUD-CNTL-NBR  OF OS-FILE                  28210099
282200               TO PV-OSF-AUD-CNTL-NBR                             28220099
282300             MOVE SU003-PO-NBR        OF OS-FILE                  28230099
282400               TO PV-OSF-PO-NBR                                   28240099
282500             MOVE SU003-REC-SEQ-NBR   OF OS-FILE                  28250099
282600               TO PV-OSF-REC-SEQ-NBR                              28260099
282700             MOVE SU003-SHIPT-UNT-ID  OF OS-FILE                  28270099
282800               TO PV-OSF-SHIPT-UNT-ID                             28280099
282900             MOVE SU003-SKU-DEPT-NBR  OF OS-FILE                  28290099
283000               TO PV-OSF-SKU-DEPT-NBR                             28300099
283100             MOVE SU003-SKU-CL-NBR    OF OS-FILE                  28310099
283200               TO PV-OSF-SKU-CL-NBR                               28320099
283300             MOVE SU003-SKU-NMBR      OF OS-FILE                  28330099
283400               TO PV-OSF-SKU-NBR                                  28340099
283500             PERFORM 2060-PROCESS-SKU-TOT-FILE                    28350099
283600                 UNTIL PS-SKU-MATCH.                              28360099
283700                                                                  28370099
284100                                                                  28410099
284200******************************************************************28420099
284300* 2060-PROCESS-SKU-TOT-FILE                                       28430099
284400*  CONTROL THE READ OF THE SKU TOTAL FILE UNTIL END OF FILE, A    28440099
284500*  MATCH IS FOUND OR NO MATCH IS FOUND.                           28450099
284600******************************************************************28460099
285100 2060-PROCESS-SKU-TOT-FILE.                                       28510099
285200                                                                  28520099
285300*    DISPLAY 'OS FILE KEY: ' PV-OS-FILE-HOLD-KEY.                 28530099
285400*    DISPLAY 'OS SKU KEY : ' PV-OS-SKU-FILE-HOLD-KEY.             28540099
285500                                                                  28550099
285600     PERFORM 8004-READ-SKU-TOTAL-FILE.                            28560099
285700                                                                  28570099
285800     IF  PS-EOF-SKU-TOTAL-FILE                                    28580099
285900         MOVE SU003-QTY-AUD  OF OS-FILE                           28590099
286000                                  TO PV-HOLD-QTY-AUD              28600099
286100         MOVE SU003-QTY-EXP  OF OS-FILE                           28610099
286200                                  TO PV-HOLD-QTY-EXP              28620099
286300         SET PS-SKU-MATCH         TO TRUE                         28630099
286400     ELSE                                                         28640099
286500         MOVE SU003-AUD-CNTL-NBR  OF OS-SKU-FILE                  28650099
286600           TO PV-OSS-AUD-CNTL-NBR                                 28660099
286700         MOVE SU003-PO-NBR        OF OS-SKU-FILE                  28670099
286800           TO PV-OSS-PO-NBR                                       28680099
286900         MOVE SU003-REC-SEQ-NBR   OF OS-SKU-FILE                  28690099
287000           TO PV-OSS-REC-SEQ-NBR                                  28700099
287100         MOVE SU003-SHIPT-UNT-ID  OF OS-SKU-FILE                  28710099
287200           TO PV-OSS-SHIPT-UNT-ID                                 28720099
287300         MOVE SU003-SKU-DEPT-NBR  OF OS-SKU-FILE                  28730099
287400           TO PV-OSS-SKU-DEPT-NBR                                 28740099
287500         MOVE SU003-SKU-CL-NBR    OF OS-SKU-FILE                  28750099
287600           TO PV-OSS-SKU-CL-NBR                                   28760099
287700         MOVE SU003-SKU-NMBR      OF OS-FILE                      28770099
287800           TO PV-OSS-SKU-NBR.                                     28780099
287900                                                                  28790099
288400     IF  PS-SKU-MATCH                                             28840099
288500         NEXT SENTENCE                                            28850099
288600     ELSE                                                         28860099
288700                                                                  28870099
288800         IF  PV-OS-FILE-HOLD-KEY = PV-OS-SKU-FILE-HOLD-KEY        28880099
289100             MOVE SU003-QTY-AUD  OF OS-FILE                       28910099
289200                                      TO PV-HOLD-QTY-AUD          28920099
289500             MOVE SU003-QTY-EXP  OF OS-FILE                       28950099
289600                                      TO PV-HOLD-QTY-EXP          28960099
289700             SET PS-SKU-MATCH         TO TRUE                     28970099
289800         ELSE                                                     28980099
289900             IF  PV-OS-FILE-HOLD-KEY < PV-OS-SKU-FILE-HOLD-KEY    28990099
290000                 MOVE SU003-QTY-AUD  OF OS-FILE                   29000099
290100                                          TO PV-HOLD-QTY-AUD      29010099
290200                 MOVE SU003-QTY-EXP  OF OS-FILE                   29020099
290300                                          TO PV-HOLD-QTY-EXP      29030099
290400                 SET PS-SKU-MATCH         TO TRUE                 29040099
290500             ELSE                                                 29050099
290600                 NEXT SENTENCE.                                   29060099
290700                                                                  29070099
290800                                                                  29080099
290900******************************************************************29090099
291000* 2100-FILL-IN-DETAIL-LINE                                        29100099
291100*  MOVE THE APPROPRIATE FILE FIELDS TO THE DETAIL LINE -- FETCH   29110099
291200*  ANY OTHER DATA FROM DB2 AND MOVE TO THE DETAIL LINE.           29120099
291300******************************************************************29130099
291400 2100-FILL-IN-DETAIL-LINE.                                        29140099
291500                                                                  29150099
291600     IF SU003-DEST-OPER-UNT-ID OF OS-FILE =                       29160099
291700                                         PV-HOLD-STR              29170099
291800         MOVE SPACES                  TO DL-STR-NBR-X             29180099
291900     ELSE                                                         29190099
292000         MOVE SU003-DEST-OPER-UNT-ID OF OS-FILE                   29200099
292100                                      TO PV-HOLD-STR              29210099
292200                                         DL-STR-NBR               29220099
292300         MOVE +2                      TO PV-DETAIL-LINE-ADVANCE   29230099
292400     END-IF.                                                      29240099
292500                                                                  29250099
292600                                                                  29260099
292700     IF SU003-SHIPT-UNT-ID  OF OS-FILE  = PV-HOLD-SHIPT-UNT-ID    29270099
292800         MOVE SPACES                  TO DL-SHIP-UNIT-ID          29280099
292900     ELSE                                                         29290099
292910                                                                  29291099
293000*        SET THE HOLD VARIABLE FOR THE UPC SO THE UPC INFO WILL   29300099
293100*        PRINT - ALSO DONE FOR THE SKU NUMBER                     29310099
293110                                                                  29311099
293200         MOVE 0                       TO PV-HOLD-UPC-NBR          29320099
293300         MOVE '00000000'              TO PV-HOLD-SKU-NMBR         29330099
293400         SET PS-PRINT-SKU-ORD TO TRUE                             29340099
293500         MOVE SU003-SHIPT-UNT-ID OF OS-FILE                       29350099
293600                                      TO PV-HOLD-SHIPT-UNT-ID     29360099
293700                                         DK-SHIPT-UNT-ID          29370099
293800         MOVE PV-HOLD-SHIPT-UNIT-ID-1 TO DL-SHIP-UNIT-ID-1        29380099
293900         MOVE PV-HOLD-SHIPT-UNIT-ID-2-8                           29390099
294000                                      TO DL-SHIP-UNIT-ID-2-8      29400099
294100         MOVE PV-HOLD-SHIPT-UNIT-ID-9-17                          29410099
294200                                      TO DL-SHIP-UNIT-ID-9-17     29420099
294300         MOVE PV-HOLD-SHIPT-UNIT-ID-18                            29430099
294400                                      TO DL-SHIP-UNIT-ID-18       29440099
294500         MOVE +2                      TO PV-DETAIL-LINE-ADVANCE   29450099
294600     END-IF.                                                      29460099
294700                                                                  29470099
294800******************************************************************29480099
294900*   REMOVED MOVE STATEMENT FOR DEPT AND REPLACED THE MOVE STATE- *29490099
295000*   MENT FOR SEQ NBR WITH SKU NBR. ALSO REPLACED SU003-SKU-SEQ-  *29500099
295100*   -NBR WITH SU003-SKU-NMBR AND DL-SKU-NBR-SEQ WITH DL-SKU-NBR- *29510099
295200*   8DGT AND PV-HOLD-SKU-SEQ WITH PV-HOLD-SKU-NMBR.              *29520099
295300*   REPLACE PERFORM 2300-GET-UPC-INFO-FROM-VSM STATEMENT WITH    *29530099
295400*   PERFORM 2300-CALL-XLKUT-DOMAIN-PGM. ALSO REPLACE UPC-CSTM-   *29540099
295500*   CLOR-DESC WITH XL001-CSTM-CLOR-DESC, VNDSTL-VS-NBR WITH      *29550099
295600*   XL001-VS-NBR AND SIZE-KOHLS-DESC WITH XL001-SIZE-DESC.       *29560099
295700*                                              WR # 21361        *29570099
295800******************************************************************29580099
295900     IF SU003-SKU-NBR OF OS-FILE = PV-HOLD-SKU-NBR                29590099
296100         MOVE SPACES                  TO DL-SKU-NBR-CLASS         29610099
296200                                         DL-SKU-NBR-8DGT          29620099
296300     ELSE                                                         29630099
296400         MOVE SU003-SKU-CL-NBR OF OS-FILE                         29640099
296500                                      TO DL-SKU-NBR-CLASS         29650099
296600                                         PV-HOLD-SKU-CL           29660099
296700         MOVE SU003-SKU-NMBR   OF OS-FILE                         29670099
296800                                      TO DL-SKU-NBR-8DGT          29680099
296900                                         PV-HOLD-SKU-NMBR         29690099
297000         SET PS-PRINT-SKU-ORD TO TRUE                             29700099
297100     END-IF.                                                      29710099
297200*                                                                 29720099
297300     IF SU003-UPC OF OS-FILE = PV-HOLD-UPC-NBR                    29730099
297400     AND PV-HOLD-UPC-NBR > 0                                      29740099
297500         MOVE SPACES                  TO DL-UPC-INFORMATION       29750099
297600         MOVE SPACES                  TO DL-SKU-NBR-CLASS         29760099
297700                                         DL-SKU-NBR-8DGT          29770099
297800     ELSE                                                         29780099
298102         IF  CC-FLAT-FILE                                         29810299
298103             continue                                             29810399
298130         ELSE                                                     29813099
298131             WRITE VA-VND-AUDIT-DETAIL-LINE                       29813199
298132              FROM PC-BLANK-LINE                                  29813299
298133             AFTER ADVANCING 1 LINES                              29813399
298134         END-IF                                                   29813499
298140                                                                  29814099
298200         ADD +1 TO PV-DETAIL-LINE-COUNT                           29820099
298300         MOVE SU003-UPC OF OS-FILE    TO DL-UPC-NBR               29830099
298400                                         DK-UPC-NBR               29840099
298500                                         PV-HOLD-UPC-NBR          29850099
298510                                                                  29851099
298600*        IF SOMETHING WAS AUDITED, GET THE UPC INFO FROM THE      29860099
298700*        AUDIT TABLES, OTHERWISE GET THEM FROM VSM                29870099
298710                                                                  29871099
298800         IF SU003-QTY-AUD OF OS-FILE > 0                          29880099
298900             PERFORM 2210-GET-UPC-INFO-FROM-AUDIT                 29890099
299000             MOVE SUAUPC-UPC-CLOR-DESC    TO DL-COLOR             29900099
299100             MOVE SUAUPC-VND-STYL-DESC    TO DL-STYLE-NBR         29910099
299200             MOVE SUAUPC-UPC-SIZE-DESC    TO DL-SIZE              29920099
299300             PERFORM 2300-CALL-XLKUT-DOMAIN-PGM                   29930099
299400         ELSE                                                     29940099
299500             PERFORM 2300-CALL-XLKUT-DOMAIN-PGM                   29950099
299600             MOVE XL001-CSTM-CLOR-DESC    TO DL-COLOR             29960099
299700             MOVE XL001-VS-NBR            TO DL-STYLE-NBR         29970099
299800             MOVE XL001-SIZE-DESC         TO DL-SIZE              29980099
299900         END-IF                                                   29990099
300000                                                                  30000099
300100     END-IF.                                                      30010099
300200                                                                  30020099
300300******************************************************************30030099
300400*  CHANGES MADE FOR WR # 21361 ENDS HERE                         *30040099
300500******************************************************************30050099
300600                                                                  30060099
300700******************************************************************30070099
300800*  2210-GET-UPC-INFO-FROM-AUDIT.                                  30080099
300900*  SELECT THE COLOR CODE FROM THE UPC TABLE                       30090099
301000******************************************************************30100099
301100 2210-GET-UPC-INFO-FROM-AUDIT.                                    30110099
301200                                                                  30120099
301300     INITIALIZE DCLTSUAUPC.                                       30130099
301400                                                                  30140099
301500     EXEC SQL                                                     30150099
301600         OPEN UPC_CURSOR                                          30160099
301700     END-EXEC.                                                    30170099
301800                                                                  30180099
301900     EVALUATE TRUE                                                30190099
302000         WHEN SQLCODE = ZERO                                      30200099
302100              CONTINUE                                            30210099
302200         WHEN SQLWARN0 NOT EQUAL SPACE                            30220099
302300         WHEN SQLCODE NOT EQUAL ZERO                              30230099
302400              DISPLAY 'AUD CNTL NBR '  SUAUPC-AUD-CNTL-NBR        30240099
302500              DISPLAY 'SHIPT UNT ID '  SUAUPC-SHIPT-UNT-ID        30250099
302600              DISPLAY 'UPC NBR: '      SUAUPC-UPC-NBR             30260099
302700              MOVE '2210-GET-UPC-INFO-FROM-AUDIT'                 30270099
302800                               TO  PV-PARAGRAPH-NAME              30280099
302900              MOVE 'OPEN UPC_CURSOR'                              30290099
303000                               TO  PV-DB2-OPERATION-ATTEMPTED     30300099
303100              PERFORM 9999-SQL-ABEND                              30310099
303200     END-EVALUATE.                                                30320099
303300                                                                  30330099
303800     EXEC SQL                                                     30380099
303900         FETCH UPC_CURSOR                                         30390099
304000         INTO                                                     30400099
304100               :SUAUPC-SKU-NBR                                    30410099
304200             , :SUAUPC-ITM-DESC                                   30420099
304300             , :SUAUPC-VND-STYL-DESC                              30430099
304400             , :SUAUPC-UPC-CLOR-DESC                              30440099
304500             , :SUAUPC-UPC-SIZE-DESC                              30450099
304600             , :SUAUPC-UPC-RTL-AMT                                30460099
304700     END-EXEC.                                                    30470099
304800                                                                  30480099
304900     EVALUATE TRUE                                                30490099
305000         WHEN SQLCODE = ZERO                                      30500099
305100              CONTINUE                                            30510099
305200         WHEN SQLCODE = +100                                      30520099
305300              MOVE ZEROES TO SUAUPC-SKU-NBR                       30530099
305400              MOVE SPACES TO SUAUPC-ITM-DESC                      30540099
305500                             SUAUPC-VND-STYL-DESC                 30550099
305600                             SUAUPC-UPC-CLOR-DESC                 30560099
305700                             SUAUPC-UPC-SIZE-DESC                 30570099
305800              MOVE ZEROES TO SUAUPC-UPC-RTL-AMT                   30580099
305900         WHEN SQLWARN0 NOT EQUAL SPACE                            30590099
306000         WHEN SQLCODE NOT EQUAL ZERO                              30600099
306100              DISPLAY 'AUD CNTL NBR '  SUAUPC-AUD-CNTL-NBR        30610099
306200              DISPLAY 'SHIPT UNT ID '  SUAUPC-SHIPT-UNT-ID        30620099
306300              DISPLAY 'UPC NBR: '      SUAUPC-UPC-NBR             30630099
306400              MOVE '2210-GET-UPC-INFO-FROM-AUDIT'                 30640099
306500                               TO  PV-PARAGRAPH-NAME              30650099
306600              MOVE 'FETCH UPC_CURSOR'                             30660099
306700                               TO  PV-DB2-OPERATION-ATTEMPTED     30670099
306800              PERFORM 9999-SQL-ABEND                              30680099
306900     END-EVALUATE.                                                30690099
307400                                                                  30740099
307500     EXEC SQL                                                     30750099
307600         CLOSE UPC_CURSOR                                         30760099
307700     END-EXEC.                                                    30770099
307800                                                                  30780099
307900     EVALUATE TRUE                                                30790099
308000         WHEN SQLCODE = ZERO                                      30800099
308100              CONTINUE                                            30810099
308200         WHEN SQLWARN0 NOT EQUAL SPACE                            30820099
308300         WHEN SQLCODE NOT EQUAL ZERO                              30830099
308400              DISPLAY 'AUD CNTL NBR '  DK-AUD-CNTL-NBR            30840099
308500              DISPLAY 'SHIPT UNT ID '  DK-SHIPT-UNT-ID            30850099
308600              DISPLAY 'UPC NBR: '      DK-UPC-NBR                 30860099
308700              MOVE '2210-GET-UPC-INFO-FROM-AUDIT'                 30870099
308800                               TO  PV-PARAGRAPH-NAME              30880099
308900              MOVE 'CLOSE UPC_CURSOR'                             30890099
309000                               TO  PV-DB2-OPERATION-ATTEMPTED     30900099
309100              PERFORM 9999-SQL-ABEND                              30910099
309200     END-EVALUATE.                                                30920099
309300                                                                  30930099
309400******************************************************************30940099
309500*  2300-CALL-XLKUT-DOMAIN-PGM.                                    30950099
309600*  ADDED NEW PARAGRAPH TO FETCH VALUES FROM XLKUT001 USING UPC   *30960099
309700*  NBR AS KEY. AND TO REPLACE THE 2300-GET-UPC-INFO-FROM-VSM     *30970099
309800*  PARAGRAPH. ALSO DELETED 2310-GET-COLOR, 2320-GET-SIZE AND     *30980099
309900*  2330-GET-VENDOR-STYLE PARAGRAPHS.               WR # 21361    *30990099
310000******************************************************************31000099
310100 2300-CALL-XLKUT-DOMAIN-PGM.                                      31010099
310200                                                                  31020099
310300     INITIALIZE XL001-ITEM-COMMAREA.                              31030099
310400                                                                  31040099
310500     MOVE DK-UPC-NBR             TO XL001-KEY-UPC-NBR.            31050099
310600     SET  XL001-BY-UPC-NBR       TO TRUE.                         31060099
310700     SET  XL001-SELECT-UPC                                        31070099
310800          XL001-SELECT-SKU                                        31080099
310900          XL001-SELECT-VND-STYL  TO TRUE.                         31090099
311000                                                                  31100099
311100     CALL XL001-VSM-PGM USING XL001-ITEM-COMMAREA.                31110099
311200                                                                  31120099
311300     MOVE XL001-UPC-SQLCODE      TO SQLCODE.                      31130099
311400                                                                  31140099
311500     EVALUATE TRUE                                                31150099
311600         WHEN XL001-UPC-SQLCODE = ZEROES                          31160099
311700              PERFORM 2310-INTERROGATE-SKU-SQLCODE                31170099
311800         WHEN XL001-UPC-NOT-FOUND                                 31180099
311900              CONTINUE                                            31190099
312000         WHEN XL001-UPC-CONTENTION                                31200099
312100              DISPLAY 'UPC NBR: '                                 31210099
312200                       XL001-KEY-UPC-NBR                          31220099
312300              MOVE '2300-CALL-XLKUT-DOMAIN-PGM.'                  31230099
312400                               TO  PV-PARAGRAPH-NAME              31240099
312500              MOVE 'SELECT FROM XLV_UPC'                          31250099
312600                               TO  PV-DB2-OPERATION-ATTEMPTED     31260099
312700              PERFORM 9999-SQL-ABEND                              31270099
312800         WHEN OTHER                                               31280099
312900              DISPLAY 'UPC NBR: '                                 31290099
313000                       XL001-KEY-UPC-NBR                          31300099
313100              MOVE '2300-CALL-XLKUT-DOMAIN-PGM.'                  31310099
313200                               TO  PV-PARAGRAPH-NAME              31320099
313300              MOVE 'SELECT FROM XLV_UPC'                          31330099
313400                               TO  PV-DB2-OPERATION-ATTEMPTED     31340099
313500              PERFORM 9999-SQL-ABEND                              31350099
313600     END-EVALUATE.                                                31360099
313700                                                                  31370099
313800******************************************************************31380099
313900* 2310-INTERROGATE-SKU-SQLCODE.                                  *31390099
314000* ADDED THIS NEW PARAGRAPH TO CHECK THE RETURN CODE FROM XLV_SKU *31400099
314100* VIEW.                                      WR # 21361          *31410099
314200******************************************************************31420099
314300 2310-INTERROGATE-SKU-SQLCODE.                                    31430099
314400                                                                  31440099
314500     MOVE XL001-SKU-SQLCODE      TO SQLCODE.                      31450099
314600                                                                  31460099
314700     EVALUATE TRUE                                                31470099
314800         WHEN XL001-SKU-SQLCODE = ZEROES                          31480099
314900              PERFORM 2320-INTERROGATE-VND-SQLCODE                31490099
315000         WHEN XL001-SKU-NOT-FOUND                                 31500099
315100              MOVE 'NOT FOUND' TO XL001-CSTM-CLOR-DESC            31510099
315200                                  XL001-SIZE-DESC                 31520099
315300         WHEN XL001-SKU-CONTENTION                                31530099
315400              DISPLAY 'COLOR DESC: ' XL001-CSTM-CLOR-DESC         31540099
315500              DISPLAY 'SIZE  DESC: ' XL001-SIZE-DESC              31550099
315600              MOVE '2310-INTERROGATE-SKU-SQLCODE.'                31560099
315700                               TO  PV-PARAGRAPH-NAME              31570099
315800              MOVE 'SELECT FROM XLV_SKU'                          31580099
315900                               TO  PV-DB2-OPERATION-ATTEMPTED     31590099
316000              PERFORM 9999-SQL-ABEND                              31600099
316100         WHEN OTHER                                               31610099
316200              DISPLAY 'COLOR DESC: ' XL001-CSTM-CLOR-DESC         31620099
316300              DISPLAY 'SIZE  DESC: ' XL001-SIZE-DESC              31630099
316400              MOVE '2310-INTERROGATE-SKU-SQLCODE.'                31640099
316500                               TO  PV-PARAGRAPH-NAME              31650099
316600              MOVE 'SELECT FROM XLV_SKU'                          31660099
316700                               TO  PV-DB2-OPERATION-ATTEMPTED     31670099
316800              PERFORM 9999-SQL-ABEND                              31680099
316900     END-EVALUATE.                                                31690099
317000                                                                  31700099
317100******************************************************************31710099
317200* 2320-INTERROGATE-VND-SQLCODE.                                  *31720099
317300* ADDED THIS NEW PARAGRAPH TO CHECK THE RETURN CODE FROM XLV_VND_*31730099
317400* STYL VIEW.                                 WR # 21361          *31740099
317500******************************************************************31750099
317600 2320-INTERROGATE-VND-SQLCODE.                                    31760099
317700                                                                  31770099
317800     MOVE XL001-VND-STYL-SQLCODE    TO SQLCODE.                   31780099
317900                                                                  31790099
318000     EVALUATE TRUE                                                31800099
318100         WHEN XL001-VND-STYL-SQLCODE = ZEROES                     31810099
318200              CONTINUE                                            31820099
318300         WHEN XL001-VND-STYL-NOT-FOUND                            31830099
318400              MOVE 'NOT FOUND' TO XL001-VS-NBR                    31840099
318500         WHEN XL001-VND-STYL-CONTENTION                           31850099
318600              DISPLAY 'VND STYL NBR: ' XL001-VS-NBR               31860099
318700              DISPLAY 'DEPT NBR: ' XL001-DEPT-NBR-3CH             31870099
318800              DISPLAY 'SUB CL NBR: ' XL001-SUB-CL-NBR-2CH         31880099
318900              MOVE '2320-INTERROGATE-VND-SQLCODE.'                31890099
319000                               TO  PV-PARAGRAPH-NAME              31900099
319100              MOVE 'SELECT FROM XLV_VND_STYL'                     31910099
319200                               TO  PV-DB2-OPERATION-ATTEMPTED     31920099
319300              PERFORM 9999-SQL-ABEND                              31930099
319400         WHEN OTHER                                               31940099
319500              DISPLAY 'VND STYL NBR: ' XL001-VS-NBR               31950099
319600              DISPLAY 'DEPT NBR: ' XL001-DEPT-NBR-3CH             31960099
319700              DISPLAY 'SUB CL NBR: ' XL001-SUB-CL-NBR-2CH         31970099
319800              MOVE '2320-INTERROGATE-VND-SQLCODE.'                31980099
319900                               TO  PV-PARAGRAPH-NAME              31990099
320000              MOVE 'SELECT FROM XLV_VND_STYL'                     32000099
320100                               TO  PV-DB2-OPERATION-ATTEMPTED     32010099
320200              PERFORM 9999-SQL-ABEND                              32020099
320300     END-EVALUATE.                                                32030099
320400                                                                  32040099
320800******************************************************************32080099
320900*  3000-PRINT-PAGE-HEADING --  CREATES THE PAGE HEADING           32090099
321000*  FOR THE REPORT AT A BREAK IN RECEIVER                          32100099
321100*     - PRINT THE PAGE HEADING                                    32110099
321200*     - SETUP/PRINT THE RECEIVER HEADING                          32120099
321300******************************************************************32130099
321400 3000-PRINT-PAGE-HEADING.                                         32140099
321500                                                                  32150099
321600     ADD +1                    TO PV-DETAIL-PAGE-COUNT.           32160099
321700     MOVE +20                  TO PV-DETAIL-LINE-COUNT.           32170099
321800     MOVE PV-DETAIL-PAGE-COUNT TO DP132O-PAGE-NUMBER.             32180099
321900                                                                  32190099
322202     IF  CC-FLAT-FILE                                             32220299
322212                                                                  32221299
322213         MOVE SPACES TO  VA-VND-AUDIT-DETAIL-LINE-FLAT            32221399
322214         WRITE VA-VND-AUDIT-DETAIL-LINE-FLAT                      32221499
322216                                                                  32221699
322217         MOVE SPACES TO  VA-VND-AUDIT-DETAIL-LINE-FLAT            32221799
322218         WRITE VA-VND-AUDIT-DETAIL-LINE-FLAT                      32221899
322220          FROM DP132O-STANDRD-HEADER-132-COLS                     32222099
322221*                                                                 32222199
322222***  11-10-2022 BEGIN - dMH                                       32222299
322223*                                                                 32222399
322224         AFTER ADVANCING PAGE                                     32222499
322225*                                                                 32222599
322226***  11-10-2022 END   - DMH                                       32222699
322227*                                                                 32222799
322230     ELSE                                                         32223099
322231         WRITE VA-VND-AUDIT-DETAIL-LINE                           32223199
322232          FROM DP132O-STANDRD-HEADER-132-COLS                     32223299
322233         AFTER ADVANCING PAGE                                     32223399
322234                                                                  32223499
322235         WRITE VA-VND-AUDIT-DETAIL-LINE-LOG                       32223599
322236          FROM DP132O-STANDRD-HEADER-132-COLS                     32223699
322237         AFTER ADVANCING PAGe                                     32223799
322238     END-IF.                                                      32223899
322600                                                                  32260099
322700*    "VENDOR ACCURACY CARTON AUDIT"                               32270099
323001                                                                  32300199
323002     IF  CC-FLAT-FILE                                             32300299
323006                                                                  32300699
323007         MOVE SPACES  TO VA-VND-AUDIT-DETAIL-LINE-FLAT            32300799
323010         WRITE VA-VND-AUDIT-DETAIL-LINE-FLAT                      32301099
323020             FROM PH2-PAGE-HEADING-2                              32302099
323030     ELSE                                                         32303099
323031         WRITE VA-VND-AUDIT-DETAIL-LINE                           32303199
323032             FROM PH2-PAGE-HEADING-2                              32303299
323033             AFTER ADVANCING 2 LINES                              32303399
323034                                                                  32303499
323035         WRITE VA-VND-AUDIT-DETAIL-LINE-LOG                       32303599
323036          FROM PH2-PAGE-HEADING-2                                 32303699
323037         AFTER ADVANCING 2 LINES                                  32303799
323038     END-IF.                                                      32303899
323400                                                                  32340099
323500*    "VENDOR AUDIT DETAIL"                                        32350099
323801                                                                  32380199
323802     IF  CC-FLAT-FILE                                             32380299
323803         MOVE SPACES  TO VA-VND-AUDIT-DETAIL-LINE-FLAT            32380399
323810         WRITE VA-VND-AUDIT-DETAIL-LINE-FLAT                      32381099
323820          FROM PH3-PAGE-HEADING-3                                 32382099
323830     ELSE                                                         32383099
323831         WRITE VA-VND-AUDIT-DETAIL-LINE                           32383199
323832          FROM PH3-PAGE-HEADING-3                                 32383299
323833         AFTER ADVANCING 1 LINES                                  32383399
323834                                                                  32383499
323835         WRITE VA-VND-AUDIT-DETAIL-LINE-LOG                       32383599
323836          FROM PH3-PAGE-HEADING-3                                 32383699
323837         AFTER ADVANCING 1 LINES                                  32383799
323838     END-IF.                                                      32383899
324200                                                                  32420099
324300*    "AUDIT CNTL NBR - AUDIT STATUS - FACILITY/DESC               32430099
324601                                                                  32460199
324602     IF  CC-FLAT-FILE                                             32460299
324607         MOVE SPACES  TO VA-VND-AUDIT-DETAIL-LINE-FLAT            32460799
324610         WRITE VA-VND-AUDIT-DETAIL-LINE-FLAT                      32461099
324611         WRITE VA-VND-AUDIT-DETAIL-LINE-FLAT                      32461199
324620          FROM AH1-AUDIT-HEADING-1                                32462099
324630     ELSE                                                         32463099
324631         WRITE VA-VND-AUDIT-DETAIL-LINE                           32463199
324632          FROM AH1-AUDIT-HEADING-1                                32463299
324633         AFTER ADVANCING 2 LINES                                  32463399
324634                                                                  32463499
324635         WRITE VA-VND-AUDIT-DETAIL-LINE-LOG                       32463599
324636          FROM AH1-AUDIT-HEADING-1                                32463699
324637         AFTER ADVANCING 2 LINES                                  32463799
324638     END-IF.                                                      32463899
325000                                                                  32500099
325100*    "VENDOR - DEPT "                                             32510099
325401                                                                  32540199
325402     IF  CC-FLAT-FILE                                             32540299
325413         MOVE SPACES  TO VA-VND-AUDIT-DETAIL-LINE-FLAT            32541399
325414         WRITE VA-VND-AUDIT-DETAIL-LINE-FLAT                      32541499
325420          FROM AH2-AUDIT-HEADING-2                                32542099
325430     ELSE                                                         32543099
325431         WRITE VA-VND-AUDIT-DETAIL-LINE                           32543199
325432          FROM AH2-AUDIT-HEADING-2                                32543299
325433         AFTER ADVANCING 1 LINES                                  32543399
325434                                                                  32543499
325435         WRITE VA-VND-AUDIT-DETAIL-LINE-LOG                       32543599
325436          FROM AH2-AUDIT-HEADING-2                                32543699
325437         AFTER ADVANCING 1 LINES                                  32543799
325438     END-IF.                                                      32543899
325800                                                                  32580099
325900*    "PO/RECV - PBS INDICATOR - UNITS TRANSCRIBED"                32590099
326201                                                                  32620199
326202     IF  CC-FLAT-FILE                                             32620299
326211         WRITE VA-VND-AUDIT-DETAIL-LINE-FLAT                      32621199
326220          FROM AH3-AUDIT-HEADING-3                                32622099
326230     ELSE                                                         32623099
326231         WRITE VA-VND-AUDIT-DETAIL-LINE                           32623199
326232          FROM AH3-AUDIT-HEADING-3                                32623299
326233         AFTER ADVANCING 1 LINES                                  32623399
326234                                                                  32623499
326235         WRITE VA-VND-AUDIT-DETAIL-LINE-LOG                       32623599
326236          FROM AH3-AUDIT-HEADING-3                                32623699
326237         AFTER ADVANCING 1 LINES                                  32623799
326238     END-IF.                                                      32623899
326600                                                                  32660099
326700*    "AUDIT TYPE - NEW STORE INDICATOR - CARTONS AUDITED "        32670099
327001                                                                  32700199
327002     IF  CC-FLAT-FILE                                             32700299
327010         WRITE VA-VND-AUDIT-DETAIL-LINE-FLAT                      32701099
327020          FROM AH4-AUDIT-HEADING-4                                32702099
327030     ELSE                                                         32703099
327031         WRITE VA-VND-AUDIT-DETAIL-LINE                           32703199
327032          FROM AH4-AUDIT-HEADING-4                                32703299
327033         AFTER ADVANCING 1 LINES                                  32703399
327034                                                                  32703499
327035         WRITE VA-VND-AUDIT-DETAIL-LINE-LOG                       32703599
327036          FROM AH4-AUDIT-HEADING-4                                32703699
327037         AFTER ADVANCING 1 LINES                                  32703799
327038     END-IF.                                                      32703899
327400                                                                  32740099
327500*    "RECEIPT DATE"                                               32750099
327801                                                                  32780199
327802     IF  CC-FLAT-FILE                                             32780299
327811         WRITE VA-VND-AUDIT-DETAIL-LINE-FLAT                      32781199
327820          FROM AH5-AUDIT-HEADING-5                                32782099
327821     ELSE                                                         32782199
327822         WRITE VA-VND-AUDIT-DETAIL-LINE                           32782299
327823          FROM AH5-AUDIT-HEADING-5                                32782399
327824         AFTER ADVANCING 1 LINES                                  32782499
327825                                                                  32782599
327826         WRITE VA-VND-AUDIT-DETAIL-LINE-LOG                       32782699
327827          FROM AH5-AUDIT-HEADING-5                                32782799
327828         AFTER ADVANCING 1 LINES                                  32782899
327829     END-IF.                                                      32782999
328200                                                                  32820099
328300*    "UNITS AUDITED"                                              32830099
328601                                                                  32860199
328602     IF  CC-FLAT-FILE                                             32860299
328611         WRITE VA-VND-AUDIT-DETAIL-LINE-FLAT                      32861199
328620          FROM AH6-AUDIT-HEADING-6                                32862099
328621     ELSE                                                         32862199
328622         WRITE VA-VND-AUDIT-DETAIL-LINE                           32862299
328623          FROM AH6-AUDIT-HEADING-6                                32862399
328624         AFTER ADVANCING 1 LINES                                  32862499
328625                                                                  32862599
328626         WRITE VA-VND-AUDIT-DETAIL-LINE-LOG                       32862699
328627          FROM AH6-AUDIT-HEADING-6                                32862799
328628         AFTER ADVANCING 1 LINES                                  32862899
328629     END-IF.                                                      32862999
329000                                                                  32900099
329100*    "AUDIT CATEGORY - UNITS IN ERROR"                            32910099
329401                                                                  32940199
329402     IF  CC-FLAT-FILE                                             32940299
329411         WRITE VA-VND-AUDIT-DETAIL-LINE-FLAT                      32941199
329420          FROM AH7-AUDIT-HEADING-7                                32942099
329421     ELSE                                                         32942199
329422         WRITE VA-VND-AUDIT-DETAIL-LINE                           32942299
329423          FROM AH7-AUDIT-HEADING-7                                32942399
329424         AFTER ADVANCING 1 LINES                                  32942499
329425                                                                  32942599
329426         WRITE VA-VND-AUDIT-DETAIL-LINE-LOG                       32942699
329427          FROM AH7-AUDIT-HEADING-7                                32942799
329428         AFTER ADVANCING 1 LINES                                  32942899
329429     END-IF.                                                      32942999
329800                                                                  32980099
329900*    "AUDIT - TOTAL ERRORS"                                       32990099
330201                                                                  33020199
330202     IF  CC-FLAT-FILE                                             33020299
330210         WRITE VA-VND-AUDIT-DETAIL-LINE-FLAT                      33021099
330220          FROM AH8-AUDIT-HEADING-8                                33022099
330221     ELSE                                                         33022199
330222         WRITE VA-VND-AUDIT-DETAIL-LINE                           33022299
330223          FROM AH8-AUDIT-HEADING-8                                33022399
330224         AFTER ADVANCING 1 LINES                                  33022499
330225                                                                  33022599
330226         WRITE VA-VND-AUDIT-DETAIL-LINE-LOG                       33022699
330227          FROM AH8-AUDIT-HEADING-8                                33022799
330228         AFTER ADVANCING 1 LINES                                  33022899
330229     END-IF.                                                      33022999
330600                                                                  33060099
330700*    "DESIGNATION - ERROR RATIO"                                  33070099
331001                                                                  33100199
331002     IF  CC-FLAT-FILE                                             33100299
331011         WRITE VA-VND-AUDIT-DETAIL-LINE-FLAT                      33101199
331020          FROM AH9-AUDIT-HEADING-9                                33102099
331021     ELSE                                                         33102199
331022         WRITE VA-VND-AUDIT-DETAIL-LINE                           33102299
331023          FROM AH9-AUDIT-HEADING-9                                33102399
331024         AFTER ADVANCING 1 LINES                                  33102499
331025                                                                  33102599
331026         WRITE VA-VND-AUDIT-DETAIL-LINE-LOG                       33102699
331027          FROM AH9-AUDIT-HEADING-9                                33102799
331028         AFTER ADVANCING 1 LINES                                  33102899
331029     END-IF.                                                      33102999
331400                                                                  33140099
331500*    "PURCHS ORDER LINE DETAIL--ERROR INFORMATION"                33150099
331801                                                                  33180199
331802     IF  CC-FLAT-FILE                                             33180299
331806                                                                  33180699
331807         MOVE SPACES  TO VA-VND-AUDIT-DETAIL-LINE-FLAT            33180799
331808         WRITE VA-VND-AUDIT-DETAIL-LINE-FLAT                      33180899
331810                                                                  33181099
331811         MOVE SPACES  TO VA-VND-AUDIT-DETAIL-LINE-FLAT            33181199
331812         WRITE VA-VND-AUDIT-DETAIL-LINE-FLAT                      33181299
331820          FROM DH1-DETAIL-HEADING-1                               33182099
331821     ELSE                                                         33182199
331822         WRITE VA-VND-AUDIT-DETAIL-LINE                           33182299
331823          FROM DH1-DETAIL-HEADING-1                               33182399
331824         AFTER ADVANCING 3 LINES                                  33182499
331825                                                                  33182599
331826         WRITE VA-VND-AUDIT-DETAIL-LINE-LOG                       33182699
331827          FROM DH1-DETAIL-HEADING-1                               33182799
331828         AFTER ADVANCING 3 LINES                                  33182899
331829     END-IF.                                                      33182999
331830                                                                  33183099
332200                                                                  33220099
332300*    "STR --- RECEIVED -- ORDERED"                                33230099
332601                                                                  33260199
332602     IF  CC-FLAT-FILE                                             33260299
332611         WRITE VA-VND-AUDIT-DETAIL-LINE-FLAT                      33261199
332620          FROM DH2-DETAIL-HEADING-2                               33262099
332621     ELSE                                                         33262199
332622         WRITE VA-VND-AUDIT-DETAIL-LINE                           33262299
332623          FROM DH2-DETAIL-HEADING-2                               33262399
332624         AFTER ADVANCING 1 LINEs                                  33262499
332625                                                                  33262599
332626         WRITE VA-VND-AUDIT-DETAIL-LINE-LOG                       33262699
332627          FROM DH2-DETAIL-HEADING-2                               33262799
332628         AFTER ADVANCING 1 LINES                                  33262899
332629     END-IF.                                                      33262999
333000                                                                  33300099
333100*    "NBR - SERIAL SHIP CODE -- UPC -- ETC"                       33310099
333401                                                                  33340199
333402     IF  CC-FLAT-FILE                                             33340299
333403         MOVE SPACES  TO VA-VND-AUDIT-DETAIL-LINE-FLAT            33340399
333410         WRITE VA-VND-AUDIT-DETAIL-LINE-FLAT                      33341099
333420          FROM DH3-DETAIL-HEADING-3                               33342099
333421     ELSE                                                         33342199
333422         WRITE VA-VND-AUDIT-DETAIL-LINE                           33342299
333423          FROM DH3-DETAIL-HEADING-3                               33342399
333424         AFTER ADVANCING 1 LINES                                  33342499
333425                                                                  33342599
333426         WRITE VA-VND-AUDIT-DETAIL-LINE-LOG                       33342699
333427          FROM DH3-DETAIL-HEADING-3                               33342799
333428         AFTER ADVANCING 1 LINES                                  33342899
333429     END-IF.                                                      33342999
333800                                                                  33380099
333900     MOVE +2 TO PV-DETAIL-LINE-ADVANCE.                           33390099
334000                                                                  33400099
334100                                                                  33410099
334300******************************************************************33430099
334400* 3170-CHECK-COMBO                                                33440099
334500*    THIS PARAGRAPH WILL CHECK IF THE AUDIT WAS PART OF A COMBO   33450099
334600*    AUDIT OR NOT.                                                33460099
334700******************************************************************33470099
334800 3170-CHECK-COMBO.                                                33480099
334900                                                                  33490099
335000     IF AH8-PROMPTED-AUDIT                                        33500099
335010                                                                  33501099
335100*       SYSTEM GENERATED AUDIT                                    33510099
335110                                                                  33511099
335200        IF SUT00015-PKGNG-TYP-CDE = 'RF'                          33520099
335210                                                                  33521099
335300*          RFID AUDIT                                             33530099
335310                                                                  33531099
335400           INITIALIZE PV-COUNT                                    33540099
335500           PERFORM 3180-CHECK-REWORK-AUD                          33550099
335600           IF PV-COUNT > 0                                        33560099
335610                                                                  33561099
335700*             AUDIT FOUND IN RWRK_AUD_CNTL_NBR OF OTHER AUDIT     33570099
335710                                                                  33571099
335800              SET AH9-COMBO     TO TRUE                           33580099
335900           ELSE                                                   33590099
335910                                                                  33591099
336000*             AUDIT NOT FOUND IN RWRK_AUD_CNTL_NBR OF OTHER AUDIT 33600099
336010                                                                  33601099
336100              SET AH9-NOT-COMBO TO TRUE                           33610099
336200           END-IF                                                 33620099
336300        ELSE                                                      33630099
336310                                                                  33631099
336400*          QC AUDIT                                               33640099
336410                                                                  33641099
336500           IF SUT00015-RWRK-AUD-CNTL-NBR > 0                      33650099
336510                                                                  33651099
336600*             PART OF COMBO                                       33660099
336610                                                                  33661099
336700              SET AH9-COMBO     TO TRUE                           33670099
336800           ELSE                                                   33680099
336810                                                                  33681099
336900*             NOT PART OF COMBO                                   33690099
336910                                                                  33691099
337000              SET AH9-NOT-COMBO TO TRUE                           33700099
337100           END-IF                                                 33710099
337200        END-IF                                                    33720099
337300     ELSE                                                         33730099
337310                                                                  33731099
337400*      MANUAL AUDIT                                               33740099
337410                                                                  33741099
337500        PERFORM 3190-CHECK-PO-EXCEPTION                           33750099
337600        PERFORM 3195-CHECK-VENDOR-TAGGING                         33760099
337700        IF PS-VENDOR-TAGGING                                      33770099
337800        OR PS-VENDOR-COMPLIANT                                    33780099
337900          PERFORM 3185-CHECK-FOR-RFID-DEPT                        33790099
338000        END-IF                                                    33800099
338100        IF PS-PO-EXCEPTION                                        33810099
338110                                                                  33811099
338200*         THERE ARE PO EXCEPTIONS DEFINED FOR PO/DC               33820099
338210                                                                  33821099
338300           EVALUATE SUT00014-AUD-TYP-CDE                          33830099
338400             WHEN 'Q'                                             33840099
338500             WHEN 'R'                                             33850099
338510                                                                  33851099
338600*                 QC/RF ONLY EXCEPTION DEFINED                    33860099
338610                                                                  33861099
338700                  SET AH9-NOT-COMBO    TO TRUE                    33870099
338800             WHEN 'A'                                             33880099
338810                                                                  33881099
338900*                 100% EXCEPTION DEFINED                          33890099
338910                                                                  33891099
339000                  IF (PS-VENDOR-TAGGING                           33900099
339100                  OR  PS-VENDOR-COMPLIANT) AND PS-RFID-DEPT-YES   33910099
339110                                                                  33911099
339200*                    VENDOR IS RFID TAGGING OR COMPLIANT          33920099
339210                                                                  33921099
339300                     SET AH9-COMBO     TO TRUE                    33930099
339400                  ELSE                                            33940099
339410                                                                  33941099
339500*                    VENDOR IS NOT RFID TAGGING OR COMPLIANT      33950099
339510                                                                  33951099
339600                     SET AH9-NOT-COMBO TO TRUE                    33960099
339700                  END-IF                                          33970099
339800             WHEN 'N'                                             33980099
339810                                                                  33981099
339900*                 NONE EXCEPTION DEFINED                          33990099
339910                                                                  33991099
340000                  IF  PS-VENDOR-TAGGING                           34000099
340100                  AND PS-RFID-DEPT-YES                            34010099
340110                                                                  34011099
340200*                    VENDOR IS RFID TAGGING                       34020099
340210                                                                  34021099
340300                     SET AH9-COMBO     TO TRUE                    34030099
340400                  ELSE                                            34040099
340410                                                                  34041099
340500*                    VENDOR IS NOT RFID TAGGING                   34050099
340510                                                                  34051099
340600                     SET AH9-NOT-COMBO TO TRUE                    34060099
340700                  END-IF                                          34070099
340800           END-EVALUATE                                           34080099
340900        ELSE                                                      34090099
340910                                                                  34091099
341000*          THERE ARE NO PO EXCEPTIONS DEFINED FOR PO/DC           34100099
341010                                                                  34101099
341100           IF  PS-VENDOR-TAGGING                                  34110099
341200           AND PS-RFID-DEPT-YES                                   34120099
341210                                                                  34121099
341300*             VENDOR IS RFID TAGGING                              34130099
341310                                                                  34131099
341400              SET AH9-COMBO         TO TRUE                       34140099
341500           ELSE                                                   34150099
341510                                                                  34151099
341600*             VENDOR IS NOT RFID TAGGING                          34160099
341610                                                                  34161099
341700              SET AH9-NOT-COMBO     TO TRUE                       34170099
341800           END-IF                                                 34180099
341900        END-IF                                                    34190099
342000     END-IF.                                                      34200099
342100                                                                  34210099
342200******************************************************************34220099
342300* 3180-CHECK-REWORK-AUD.                                          34230099
342400*    THIS PARAGRAPH WILL CHECK IF THE RFID AUDIT IS PRESENT IN THE34240099
342500*    REWORK AUDIT CONTROL NUMBER FOR ANY OTHER AUDIT. IF SO, IT   34250099
342600*    WILL BE A COMBO.                                             34260099
342700******************************************************************34270099
342800 3180-CHECK-REWORK-AUD.                                           34280099
342900                                                                  34290099
343000     EXEC SQL                                                     34300099
343100         SELECT VALUE(COUNT(*), 0)                                34310099
343200           INTO :PV-COUNT                                         34320099
343300           FROM SUT_PO_AUD_REQ                                    34330099
343400          WHERE RWRK_AUD_CNTL_NBR = :DK-AUD-CNTL-NBR              34340099
343500     END-EXEC.                                                    34350099
343600                                                                  34360099
343700     EVALUATE TRUE                                                34370099
343800         WHEN SQLCODE = ZERO                                      34380099
343900         WHEN SQLCODE = +100                                      34390099
344000         WHEN SQLCODE = -811                                      34400099
344100              CONTINUE                                            34410099
344200                                                                  34420099
344300         WHEN SQLWARN0 NOT = SPACES                               34430099
344400         WHEN SQLCODE < +0                                        34440099
344500         WHEN SQLCODE > ZERO                                      34450099
344600            DISPLAY 'AUDIT NUMBER ' DK-AUD-CNTL-NBR               34460099
344700            MOVE '3180-CHECK-REWORK-AUD'                          34470099
344800                                   TO  PV-PARAGRAPH-NAME          34480099
344900            MOVE 'SELECT OF SUT_PO_AUD_REQ'                       34490099
345000                                   TO PV-DB2-OPERATION-ATTEMPTED  34500099
345100            DISPLAY 'DK-AUD-CNTL-NBR=' DK-AUD-CNTL-NBR            34510099
345200            PERFORM 9999-SQL-ABEND                                34520099
345300     END-EVALUATE.                                                34530099
345400                                                                  34540099
345600******************************************************************34560099
345700 3185-CHECK-FOR-RFID-DEPT.                                        34570099
345800                                                                  34580099
345900     EXEC SQL                                                     34590099
346000          SELECT 'Y'                                              34600099
346100            INTO :PS-RFID-DEPT-IND                                34610099
346200            FROM RIT_RFID_VRFN                                    34620099
346300           WHERE RFID_LVL_CDE = 'STRDPT'                          34630099
346400             AND DEPT_NBR     = :DK-DEPT-NBR                      34640099
346500             AND (CURRENT TIMESTAMP BETWEEN EFF_STRT_TMST         34650099
346600                                        AND EFF_END_TMST)         34660099
346700           FETCH FIRST ROW ONLY                                   34670099
346800     END-EXEC.                                                    34680099
346900                                                                  34690099
347000     EVALUATE TRUE                                                34700099
347100         WHEN SQLCODE = +0                                        34710099
347200         WHEN SQLCODE = -811                                      34720099
347300             SET PS-RFID-DEPT-YES TO TRUE                         34730099
347400                                                                  34740099
347500         WHEN SQLCODE = +100                                      34750099
347600             SET PS-RFID-DEPT-NO  TO TRUE                         34760099
347700                                                                  34770099
347800         WHEN SQLWARN0 NOT = SPACES                               34780099
347900         WHEN SQLCODE NOT EQUAL ZERO                              34790099
348000             MOVE '3185-CHECK-FOR-RFID-DEPT'                      34800099
348100                             TO PV-PARAGRAPH-NAME                 34810099
348200             MOVE 'CHECK FOR RFID DEPT'                           34820099
348300                             TO PV-DB2-OPERATION-ATTEMPTED        34830099
348400             DISPLAY ' DEPT-NBR= ' DK-DEPT-NBR                    34840099
348500            PERFORM 9999-SQL-ABEND                                34850099
348600     END-EVALUATE.                                                34860099
348800                                                                  34880099
348900******************************************************************34890099
349000 3190-CHECK-PO-EXCEPTION.                                         34900099
349600                                                                  34960099
349700     EXEC SQL                                                     34970099
349701       SELECT X.SQL_ID                                            34970199
349702            , X.AUD_TYP_CDE                                       34970299
349703            , X.PO_LNE_NBR                                        34970399
349704            , X.PO_PREPK_ID                                       34970499
349705         INTO     :PV-UNION-TYPE                                  34970599
349706                , :SUT00014-AUD-TYP-CDE                           34970699
349707                , :PURITM-PO-LNE-NBR                              34970799
349708                , :PURITM-PO-PREPK-ID                             34970899
349709         FROM                                                     34970999
349711        (SELECT 'A' as SQL_ID                                     34971199
349720                  , C.AUD_TYP_CDE                                 34972099
349730                  , 0 AS PO_LNE_NBR                               34973099
349740                  , B.PO_PREPK_ID                                 34974099
349750           FROM  TPURCHS A                                        34975099
349760               , TPURITM B                                        34976099
349770               , SUT_PO_AUD_EXC C                                 34977099
349780           WHERE A.PO_NBR = :DK-PO-NBR                            34978099
349790             AND A.VER_STATUS_CDE = 'A'                           34979099
349791             AND A.PKGNG_CDE = 'M'                                34979199
349792             AND B.PO_NBR = A.PO_NBR                              34979299
349793             AND B.VER_STATUS_CDE = 'A'                           34979399
349794             AND B.RMS_PO_SKU_NBR = :DK-SKU-NBR                   34979499
349795             AND B.PO_PREPK_ID > 0                                34979599
349796             AND C.PO_NBR = A.PO_NBR                              34979699
349797             AND C.PO_PREPK_ID = B.PO_PREPK_ID                    34979799
349798             AND C.OPER_UNT_ID = :DK-STORE-NBR                    34979899
349799           UNION ALL                                              34979999
349800             SELECT 'B' as SQL_ID                                 34980099
349801               , C.AUD_TYP_CDE                                    34980199
349802               , B.PO_LNE_NBR                                     34980299
349803               , 0 AS PO_PREPK_ID                                 34980399
349808           FROM  TPURCHS A                                        34980899
349809               , TPURITM B                                        34980999
349810               , SUT_PO_AUD_EXC C                                 34981099
349811           WHERE A.PO_NBR = :DK-PO-NBR                            34981199
349812             AND A.VER_STATUS_CDE = 'A'                           34981299
349813             AND NOT A.PKGNG_CDE = 'M'                            34981399
349814             AND B.PO_NBR = A.PO_NBR                              34981499
349815             AND B.VER_STATUS_CDE = 'A'                           34981599
349816             AND B.RMS_PO_SKU_NBR = :DK-SKU-NBR                   34981699
349817             AND C.PO_NBR = A.PO_NBR                              34981799
349818             AND C.PO_LNE_NBR = B.PO_LNE_NBR                      34981899
349819             AND C.OPER_UNT_ID = :DK-STORE-NBR                    34981999
349820           UNION ALL                                              34982099
349821             SELECT 'C'  as SQL_ID                                34982199
349822                 , C.AUD_TYP_CDE                                  34982299
349823                 , 0 AS PO_LNE_NBR                                34982399
349824                 , 0 AS PO_PREPK_ID                               34982499
349829             FROM TPURCHS A                                       34982999
349830             ,    SUT_PO_AUD_EXC C                                34983099
349831             WHERE A.PO_NBR = :DK-PO-NBR                          34983199
349832               AND A.VER_STATUS_CDE = 'A'                         34983299
349833               AND C.PO_NBR = A.PO_NBR                            34983399
349834               AND C.PO_LNE_NBR = 0                               34983499
349835               AND C.PO_PREPK_ID = 0                              34983599
349836               AND C.OPER_UNT_ID = :DK-STORE-NBR                  34983699
349837         ORDER BY 1, 2, 3, 4                                      34983799
349840        FETCH FIRST 1 ROW ONLY ) AS X                             34984099
350400     END-EXEC.                                                    35040099
350500                                                                  35050099
350600     EVALUATE SQLCODE                                             35060099
350700         WHEN +0                                                  35070099
350800             SET PS-PO-EXCEPTION    TO TRUE                       35080099
351000         WHEN +100                                                35100099
351100             SET PS-NO-PO-EXCEPTION TO TRUE                       35110099
351200                                                                  35120099
351300         WHEN OTHER                                               35130099
351400            DISPLAY DK-AUD-CNTL-NBR                               35140099
351500            MOVE '3190-CHECK-PO-EXCEPTION'                        35150099
351600                                   TO  PV-PARAGRAPH-NAME          35160099
351700            MOVE 'SELECT OF SUT_PO_AUD_EXC'                       35170099
351800                                   TO PV-DB2-OPERATION-ATTEMPTED  35180099
351900            DISPLAY 'SUT00014-PO-NBR=     ' SUT00014-PO-NBR       35190099
352000            DISPLAY 'SUT00014-PO-LNE-NBR= ' SUT00014-PO-LNE-NBR   35200099
352100            DISPLAY 'SUT00014-OPER-UNT-ID=' SUT00014-OPER-UNT-ID  35210099
352200            PERFORM 9999-SQL-ABEND                                35220099
352300     END-EVALUATE.                                                35230099
352400                                                                  35240099
352500******************************************************************35250099
352600 3195-CHECK-VENDOR-TAGGING.                                       35260099
352700                                                                  35270099
352800     INITIALIZE DCLTPURCHS                                        35280099
352900                DCLTVNDAGR.                                       35290099
353000                                                                  35300099
353100     MOVE DK-PO-NBR       TO PURCHS-PO-NBR.                       35310099
353200                                                                  35320099
353300     EXEC SQL                                                     35330099
353400         SELECT  DEPT_NBR                                         35340099
353500                ,ENT_ID                                           35350099
353600           INTO :PURCHS-DEPT-NBR                                  35360099
353700               ,:PURCHS-ENT-ID                                    35370099
353800           FROM TPURCHS                                           35380099
353900          WHERE PO_NBR = :PURCHS-PO-NBR                           35390099
354000            AND VER_STATUS_CDE = 'A'                              35400099
354100     END-EXEC.                                                    35410099
354200                                                                  35420099
354300     EVALUATE SQLCODE                                             35430099
354400        WHEN +0                                                   35440099
354500             MOVE PURCHS-DEPT-NBR TO VNDAGR-DEPT-NBR              35450099
354600             MOVE PURCHS-ENT-ID   TO VNDAGR-ENT-ID                35460099
354700             EXEC SQL                                             35470099
354800                  SELECT TYP_CDE                                  35480099
354900                    INTO :VNDAGR-TYP-CDE                          35490099
355000                    FROM TVNDAGR                                  35500099
355100                   WHERE ENT_ID          = :VNDAGR-ENT-ID         35510099
355200                     AND DEPT_NBR        = :VNDAGR-DEPT-NBR       35520099
355300                     AND AGRMT_TYP_ID    = '4'                    35530099
355400                     AND TYP_CDE         IN (11,12)               35540099
355500                     AND EFFECTIVE_DATE <= CURRENT DATE           35550099
355600                     AND EXPIRATION_DATE > CURRENT DATE           35560099
355700                   ORDER BY TYP_CDE                               35570099
355800                   FETCH FIRST 1 ROW ONLY                         35580099
355900             END-EXEC                                             35590099
356000                                                                  35600099
356100             EVALUATE SQLCODE                                     35610099
356200                WHEN +0                                           35620099
356300                     IF VNDAGR-TYP-CDE = 11                       35630099
356400                        SET PS-VENDOR-TAGGING     TO TRUE         35640099
356500                     ELSE                                         35650099
356600                        SET PS-VENDOR-COMPLIANT   TO TRUE         35660099
356700                     END-IF                                       35670099
356800                                                                  35680099
356900                WHEN +100                                         35690099
357000                     SET PS-VENDOR-NOT-TAGGING    TO TRUE         35700099
357100                                                                  35710099
357200                WHEN OTHER                                        35720099
357300                     DISPLAY 'AUDIT NBR= ' DK-AUD-CNTL-NBR        35730099
357400                     DISPLAY 'PO NBR = '   PURCHS-PO-NBR          35740099
357500                     DISPLAY 'DEPT NBR= '  VNDAGR-DEPT-NBR        35750099
357600                     DISPLAY 'ENT ID= '    VNDAGR-ENT-ID          35760099
357700                     MOVE '3195-CHECK-VENDOR-TAGGING'             35770099
357800                                    TO  PV-PARAGRAPH-NAME         35780099
357900                     MOVE 'SELECT OF TVNDAGR'                     35790099
358000                                    TO PV-DB2-OPERATION-ATTEMPTED 35800099
358100                     PERFORM 9999-SQL-ABEND                       35810099
358200             END-EVALUATE                                         35820099
358300                                                                  35830099
358400        WHEN +100                                                 35840099
358500             SET PS-VENDOR-NOT-TAGGING TO TRUE                    35850099
358600                                                                  35860099
358700        WHEN OTHER                                                35870099
358800            DISPLAY DK-AUD-CNTL-NBR                               35880099
358900            MOVE '3195-CHECK-VENDOR-TAGGING'                      35890099
359000                                   TO PV-PARAGRAPH-NAME           35900099
359100            MOVE 'SELECT OF TPURCHS'                              35910099
359200                                   TO PV-DB2-OPERATION-ATTEMPTED  35920099
359300            DISPLAY 'PURCHS-PO-NBR=' PURCHS-PO-NBR                35930099
359400            PERFORM 9999-SQL-ABEND                                35940099
359500     END-EVALUATE.                                                35950099
359600                                                                  35960099
359700******************************************************************35970099
359800* 3200-CHECK-RFID-ERRORS.                                        *35980099
359900******************************************************************35990099
360000 3200-CHECK-RFID-ERRORS.                                          36000099
360100                                                                  36010099
360200     INITIALIZE PV-HOLD-TMST.                                     36020099
360300     PERFORM 3210-OPEN-RFID-CURSOR.                               36030099
360400                                                                  36040099
360500     PERFORM 3220-FETCH-RFID-CURSOR.                              36050099
360600                                                                  36060099
360700     PERFORM UNTIL PS-END-OF-RFID-CURSOR                          36070099
360800         EVALUATE SUEXCP-VILN-GP-SEQ-NBR                          36080099
360810                                                                  36081099
360900*         ADD THE QUANTITY TO THE TOTAL ERROR BUCKET              36090099
360910                                                                  36091099
361000           WHEN PC-RFID-UPC-MISPCK                                36100099
361100               COMPUTE PV-HL-TOTAL-ERRORS =                       36110099
361200                       PV-HL-TOTAL-ERRORS + 1                     36120099
361300                                                                  36130099
361400           WHEN PC-RFID-TKT-CLR                                   36140099
361500               COMPUTE PV-HL-TOTAL-ERRORS =                       36150099
361600                       PV-HL-TOTAL-ERRORS + PV-RFID-COUNT         36160099
361700               ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR    36170099
361800               END-COMPUTE                                        36180099
361900                                                                  36190099
362000           WHEN PC-RFID-TKT-SIZE                                  36200099
362100               COMPUTE PV-HL-TOTAL-ERRORS =                       36210099
362200                       PV-HL-TOTAL-ERRORS + PV-RFID-COUNT         36220099
362300               ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR    36230099
362400               END-COMPUTE                                        36240099
362500                                                                  36250099
362600           WHEN PC-RFID-TKT-STYLE                                 36260099
362700               COMPUTE PV-HL-TOTAL-ERRORS =                       36270099
362800                       PV-HL-TOTAL-ERRORS + PV-RFID-COUNT         36280099
362900               ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR    36290099
363000               END-COMPUTE                                        36300099
363100                                                                  36310099
363200           WHEN PC-RFID-NO-TICKET                                 36320099
363300               COMPUTE PV-DB2-COUNT =                             36330099
363400                       PV-DB2-COUNT - PV-RFID-COUNT               36340099
363500               ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR    36350099
363600               END-COMPUTE                                        36360099
363700               COMPUTE PV-HL-TOTAL-ERRORS =                       36370099
363800                       PV-HL-TOTAL-ERRORS + PV-DB2-COUNT          36380099
363900               ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR    36390099
364000               END-COMPUTE                                        36400099
364100                                                                  36410099
364200         END-EVALUATE                                             36420099
364300                                                                  36430099
364400         IF SUEXCP-SCN-TMST NOT EQUAL PV-HOLD-TMST                36440099
364500            EVALUATE SUEXCP-VILN-GP-SEQ-NBR                       36450099
364510                                                                  36451099
364600*           ADD THE QUANTITY TO THE UNITS IN ERROR BUCKET         36460099
364610                                                                  36461099
364700             WHEN PC-RFID-NO-TICKET                               36470099
364800                  ADD PV-DB2-COUNT   TO PV-HL-UNITS-IN-ERROR      36480099
364900                                                                  36490099
365300             WHEN OTHER                                           36530099
365400                  ADD PV-RFID-COUNT  TO PV-HL-UNITS-IN-ERROR      36540099
365500            END-EVALUATE                                          36550099
365600            MOVE SUEXCP-SCN-TMST     TO PV-HOLD-TMST              36560099
365700         END-IF                                                   36570099
365800                                                                  36580099
365900         PERFORM 3220-FETCH-RFID-CURSOR                           36590099
366000                                                                  36600099
366100     END-PERFORM.                                                 36610099
366200                                                                  36620099
366300     PERFORM 3225-CLOSE-RFID-CURSOR.                              36630099
366400                                                                  36640099
366500******************************************************************36650099
366600* 3210-OPEN-RFID-CURSOR.                                         *36660099
366700*  THIS PROCEDURE WILL OPEN THE RFID CURSOR.                     *36670099
366800******************************************************************36680099
366900 3210-OPEN-RFID-CURSOR.                                           36690099
367000                                                                  36700099
367100     EXEC SQL                                                     36710099
367200          OPEN RFID_CURSOR                                        36720099
367300     END-EXEC.                                                    36730099
367400                                                                  36740099
367500     EVALUATE TRUE                                                36750099
367600         WHEN SQLCODE = ZERO                                      36760099
367700              SET PS-NOT-END-OF-RFID-CURSOR TO TRUE               36770099
367800                                                                  36780099
367900         WHEN SQLWARN0 NOT EQUAL SPACE                            36790099
368000         WHEN SQLCODE NOT EQUAL ZERO                              36800099
368100              MOVE '3210-OPEN-RFID-CURSOR'                        36810099
368200                                    TO PV-PARAGRAPH-NAME          36820099
368300              MOVE 'OPEN RFID_CURSOR'                             36830099
368400                                    TO PV-DB2-OPERATION-ATTEMPTED 36840099
368500              DISPLAY 'AUD CNTL NBR: ' DK-AUD-CNTL-NBR            36850099
368600              DISPLAY 'PO NBR:       ' DK-PO-NBR                  36860099
368700              DISPLAY 'REC SEQ NBR:  ' DK-REC-SEQ-NBR             36870099
368800              PERFORM 9999-SQL-ABEND                              36880099
368900     END-EVALUATE.                                                36890099
369000                                                                  36900099
369100******************************************************************36910099
369200* 3220-FETCH-RFID-CURSOR                                         *36920099
369300*  THIS PROCEDURE WILL FETCH THE RFID-CURSOR.                    *36930099
369400******************************************************************36940099
369500 3220-FETCH-RFID-CURSOR.                                          36950099
369600                                                                  36960099
369700     EXEC SQL                                                     36970099
369800          FETCH RFID_CURSOR                                       36980099
369900           INTO  :SUEXCP-UPC-NBR                                  36990099
370000               , :SUEXCP-SCN-TMST                                 37000099
370100               , :SUEXCP-VILN-GP-SEQ-NBR                          37010099
370200               , :PV-DB2-COUNT                                    37020099
370300               , :PV-RFID-COUNT                                   37030099
370400     END-EXEC.                                                    37040099
370500                                                                  37050099
370600     EVALUATE TRUE                                                37060099
370700         WHEN SQLCODE = ZERO                                      37070099
370800              CONTINUE                                            37080099
370900                                                                  37090099
371000         WHEN SQLCODE = +100                                      37100099
371100         WHEN SQLCODE = -305                                      37110099
371200              SET PS-END-OF-RFID-CURSOR TO TRUE                   37120099
371300                                                                  37130099
371400         WHEN SQLWARN0 NOT EQUAL SPACE                            37140099
371500         WHEN SQLCODE NOT EQUAL ZERO                              37150099
371600              MOVE '3220-FETCH-RFID-CURSOR'                       37160099
371700                                    TO PV-PARAGRAPH-NAME          37170099
371800              MOVE 'FETCH RFID_CURSOR'                            37180099
371900                                    TO PV-DB2-OPERATION-ATTEMPTED 37190099
372000              DISPLAY 'AUD CNTL NBR: ' DK-AUD-CNTL-NBR            37200099
372100              DISPLAY 'PO NBR:       ' DK-PO-NBR                  37210099
372200              DISPLAY 'REC SEQ NBR:  ' DK-REC-SEQ-NBR             37220099
372300              PERFORM 9999-SQL-ABEND                              37230099
372400     END-EVALUATE.                                                37240099
372500                                                                  37250099
372600******************************************************************37260099
372700* 3225-CLOSE-RFID-CURSOR                                         *37270099
372800*  THIS PROCEDURE WILL CLOSE THE RFID_CURSOR.                    *37280099
372900******************************************************************37290099
373000 3225-CLOSE-RFID-CURSOR.                                          37300099
373100                                                                  37310099
373200     EXEC SQL                                                     37320099
373300         CLOSE RFID_CURSOR                                        37330099
373400     END-EXEC.                                                    37340099
373500                                                                  37350099
373600     EVALUATE TRUE                                                37360099
373700         WHEN SQLWARN0 NOT EQUAL SPACE                            37370099
373800         WHEN SQLCODE NOT EQUAL ZERO                              37380099
373900              MOVE '3225-CLOSE-RFID-CURSOR'                       37390099
374000                               TO  PV-PARAGRAPH-NAME              37400099
374100              MOVE 'CLOSE RFID_CURSOR'                            37410099
374200                               TO  PV-DB2-OPERATION-ATTEMPTED     37420099
374300              PERFORM 9999-SQL-ABEND                              37430099
374400     END-EVALUATE.                                                37440099
374500                                                                  37450099
374600******************************************************************37460099
374700* 3300-CHECK-QC-ERRORS.                                          *37470099
374800*  THIS PROCEDURE WILL GET ALL THE UNITS WITH A QC EXCEPTION     *37480099
374900*  AND ADD THE QUANTITY TO THE APPROPRIATE BUCKET ON THE OUTPUT  *37490099
375000*  FILE.                                                         *37500099
375100******************************************************************37510099
375200 3300-CHECK-QC-ERRORS.                                            37520099
375300                                                                  37530099
375400     EXEC SQL                                                     37540099
375500        SELECT SUM(SCND_UNT_QTY)                                  37550099
375600          INTO :PV-SCAN-COUNT                                     37560099
375700          FROM TSUEXCP A                                          37570099
375800             , TVILNCD B                                          37580099
375900             , TSUAUPC C                                          37590099
376000         WHERE A.AUD_CNTL_NBR     = :DK-AUD-CNTL-NBR              37600099
376100           AND A.AUD_CNTL_NBR     =  C.AUD_CNTL_NBR               37610099
376200           AND A.SHIPT_UNT_ID     =  C.SHIPT_UNT_ID               37620099
376300           AND A.UPC_NBR          =  C.UPC_NBR                    37630099
376400           AND A.SCN_TMST         =  C.SCN_TMST                   37640099
376500           AND A.VILN_GP_CDE      = :PC-VA                        37650099
376600           AND B.VILN_CTG_CDE    <> :PC-R                         37660099
376700           AND A.VILN_GP_SEQ_NBR  = B.VILN_GP_SEQ_NBR             37670099
376800           AND A.VILN_GP_CDE      = B.VILN_GP_CDE                 37680099
376900     END-EXEC.                                                    37690099
377000                                                                  37700099
377100     EVALUATE TRUE                                                37710099
377200         WHEN SQLCODE = ZERO                                      37720099
377300              COMPUTE PV-HL-TOTAL-ERRORS =                        37730099
377400                      PV-HL-TOTAL-ERRORS + PV-SCAN-COUNT          37740099
377500                                                                  37750099
377600         WHEN SQLCODE = +100                                      37760099
377700         WHEN SQLCODE = -305                                      37770099
377800              MOVE ZEROES              TO PV-HL-TOTAL-ERRORS      37780099
377900                                                                  37790099
378000         WHEN SQLWARN0 NOT EQUAL SPACE                            37800099
378100         WHEN SQLCODE NOT EQUAL ZERO                              37810099
378200              MOVE '3300-CHECK-QC-ERRORS'                         37820099
378300                                       TO PV-PARAGRAPH-NAME       37830099
378400              MOVE 'SELECT QC ERROR'   TO                         37840099
378500                                       PV-DB2-OPERATION-ATTEMPTED 37850099
378600              DISPLAY 'AUD CNTL NBR: ' DK-AUD-CNTL-NBR            37860099
378700              PERFORM 9999-SQL-ABEND                              37870099
378800     END-EVALUATE.                                                37880099
378900                                                                  37890099
379000                                                                  37900099
379100******************************************************************37910099
379200* 3400-RETRIEVE-UNIT-COUNT.                                      *37920099
379300*  FOR A QC AUDIT RETRIEVE THE COUNT OF THE UNITS IN ERROR.      *37930099
379400******************************************************************37940099
379500 3400-RETRIEVE-UNIT-COUNT.                                        37950099
379600                                                                  37960099
379700     EXEC SQL                                                     37970099
379800        SELECT SUM(SCND_UNT_QTY)                                  37980099
379900          INTO :PV-DB2-UNIT-COUNT                                 37990099
380000          FROM TSUEXCP A                                          38000099
380100             , TVILNCD B                                          38010099
380200             , TSUAUPC C                                          38020099
380300         WHERE A.AUD_CNTL_NBR     = :DK-AUD-CNTL-NBR              38030099
380400           AND A.AUD_CNTL_NBR     =  C.AUD_CNTL_NBR               38040099
380500           AND A.SHIPT_UNT_ID     =  C.SHIPT_UNT_ID               38050099
380600           AND A.UPC_NBR          =  C.UPC_NBR                    38060099
380700           AND A.SCN_TMST         =  C.SCN_TMST                   38070099
380800           AND A.VILN_GP_CDE      = :PC-VA                        38080099
380900           AND C.SCN_TYP_CDE      = :PC-E                         38090099
381000           AND B.VILN_CTG_CDE    <> :PC-R                         38100099
381100           AND A.VILN_GP_SEQ_NBR  = B.VILN_GP_SEQ_NBR             38110099
381200           AND A.VILN_GP_CDE      = B.VILN_GP_CDE                 38120099
381300     END-EXEC.                                                    38130099
381400                                                                  38140099
381500     EVALUATE TRUE                                                38150099
381600         WHEN SQLCODE = ZERO                                      38160099
381700              MOVE PV-DB2-UNIT-COUNT   TO PV-HL-UNITS-IN-ERROR    38170099
381800                                                                  38180099
381900         WHEN SQLCODE = +100                                      38190099
382000         WHEN SQLCODE = -305                                      38200099
382100              MOVE ZEROES              TO PV-HL-UNITS-IN-ERROR    38210099
382200                                                                  38220099
382300         WHEN SQLWARN0 NOT EQUAL SPACE                            38230099
382400         WHEN SQLCODE NOT EQUAL ZERO                              38240099
382500              MOVE '3400-RETRIEVE-UNIT-COUNT'                     38250099
382600                                       TO PV-PARAGRAPH-NAME       38260099
382700              MOVE 'UNIT COUNT ERROR'  TO                         38270099
382800                                       PV-DB2-OPERATION-ATTEMPTED 38280099
382900              DISPLAY 'AUD CNTL NBR: ' DK-AUD-CNTL-NBR            38290099
383000              PERFORM 9999-SQL-ABEND                              38300099
383100     END-EVALUATE.                                                38310099
383200                                                                  38320099
383300                                                                  38330099
383400******************************************************************38340099
383500* 4000-CHECK-EXCEPTIONS. -- READ THE EXCEPTION TABLE TO DETERMINE 38350099
383600* IF ANY OTHER EXCEPTIONS OCCURRED FOR THIS ITEM.                 38360099
383700******************************************************************38370099
383800 4000-CHECK-EXCEPTIONS.                                           38380099
383900                                                                  38390099
384000     MOVE SU003-AUD-CNTL-NBR OF OS-FILE                           38400099
384100                                      TO DK-AUD-CNTL-NBR.         38410099
384200     MOVE SU003-SHIPT-UNT-ID OF OS-FILE                           38420099
384300                                      TO DK-SHIPT-UNT-ID.         38430099
384400     MOVE SU003-UPC          OF OS-FILE                           38440099
384500                                      TO DK-UPC-NBR.              38450099
384600                                                                  38460099
384700                                                                  38470099
384800***                                                               38480099
384900* USE QC-ERR-CSR FOR FOLLOWING COMBINATIONS OF                    38490099
385000* CC-SYSTEM-MANUAL-AUDIT          S/M                             38500099
385100*  CC-RFID-QC-AUDIT-IND           R/S                             38510099
385200*   CC-RFID-QC-AUD-CMB-IND        R/S/B                           38520099
385300* **S WHERE '*' REPRESENTS ANY POSSIBLE VALUE                     38530099
385400* SSB                                                             38540099
385500***                                                               38550099
385600     IF CC-QC-AUD-ONLY                                            38560099
385700             OR (CC-SYSTEM-GENERATED-AUDIT                        38570099
385800                 AND CC-QC-AUDIT                                  38580099
385900                 AND CC-QC-AND-RFID-AUD)                          38590099
386000         PERFORM 4011-OPEN-QC-ERR-CSR                             38600099
386100         PERFORM 4012-FETCH-QC-ERR-CSR                            38610099
386200                                                                  38620099
386300         PERFORM UNTIL PS-EOC-QC-ERR-CSR                          38630099
386400             IF SUEXCP-VILN-GP-SEQ-NBR = PC-UPC-MISDIRECT         38640099
386500                 CONTINUE                                         38650099
386600             ELSE                                                 38660099
386700                 PERFORM 4100-WRITE-EXCEPTIONS                    38670099
386800             END-IF                                               38680099
386900             PERFORM 4012-FETCH-QC-ERR-CSR                        38690099
387000         END-PERFORM                                              38700099
387100                                                                  38710099
387200         PERFORM 4013-CLOSE-QC-ERR-CSR                            38720099
387300     END-IF.                                                      38730099
387400                                                                  38740099
387500***                                                               38750099
387600* USE RFID-ERR-CSR-LT42 FOR FOLLOWING COMBINATIONS OF             38760099
387700* CC-SYSTEM-MANUAL-AUDIT          S/M                             38770099
387800*  CC-RFID-QC-AUDIT-IND           R/S                             38780099
387900*   CC-RFID-QC-AUD-CMB-IND        R/S/B                           38790099
388000* **R WHERE '*' REPRESENTS ANY POSSIBLE VALUE                     38800099
388100* SRB                                                             38810099
388200***                                                               38820099
388300     IF CC-RFID-AUD-ONLY                                          38830099
388400         OR (CC-SYSTEM-GENERATED-AUDIT                            38840099
388500             AND CC-RFID-AUDIT                                    38850099
388600             AND CC-QC-AND-RFID-AUD)                              38860099
388700         PERFORM 4021-OPEN-RFID-ERR-CSR-LT42                      38870099
388800         PERFORM 4022-FETCH-RFID-ERR-CSR-LT42                     38880099
388900                                                                  38890099
389000         PERFORM UNTIL PS-EOC-RFID-ERR-CSR-LT42                   38900099
389100             IF SUEXCP-VILN-GP-SEQ-NBR = PC-UPC-MISDIRECT         38910099
389200                 CONTINUE                                         38920099
389300             ELSE                                                 38930099
389400                 PERFORM 4100-WRITE-EXCEPTIONS                    38940099
389500             END-IF                                               38950099
389600             PERFORM 4022-FETCH-RFID-ERR-CSR-LT42                 38960099
389700         END-PERFORM                                              38970099
389800                                                                  38980099
389900         PERFORM 4023-CLOSE-RFID-ERR-CSR-LT42                     38990099
390000     END-IF.                                                      39000099
390100                                                                  39010099
390200***                                                               39020099
390300* USE RFID-ERR-CSR-EQ42 FOR FOLLOWING COMBINATIONS OF             39030099
390400* CC-SYSTEM-MANUAL-AUDIT          S/M                             39040099
390500*  CC-RFID-QC-AUDIT-IND           R/S                             39050099
390600*   CC-RFID-QC-AUD-CMB-IND        R/S/B                           39060099
390700* **R WHERE '*' REPRESENTS ANY POSSIBLE VALUE                     39070099
390800* SRB                                                             39080099
390900***                                                               39090099
391000     IF CC-RFID-AUD-ONLY                                          39100099
391100             OR (CC-SYSTEM-GENERATED-AUDIT                        39110099
391200                 AND CC-RFID-AUDIT                                39120099
391300                 AND CC-QC-AND-RFID-AUD)                          39130099
391400         PERFORM 4031-OPEN-RFID-ERR-CSR-EQ42                      39140099
391500         PERFORM 4032-FETCH-RFID-ERR-CSR-EQ42                     39150099
391600                                                                  39160099
391700         PERFORM UNTIL PS-EOC-RFID-ERR-CSR-EQ42                   39170099
391800             IF SUEXCP-VILN-GP-SEQ-NBR = PC-UPC-MISDIRECT         39180099
391900                 CONTINUE                                         39190099
392000             ELSE                                                 39200099
392100                 PERFORM 4100-WRITE-EXCEPTIONS                    39210099
392200             END-IF                                               39220099
392300             PERFORM 4032-FETCH-RFID-ERR-CSR-EQ42                 39230099
392400         END-PERFORM                                              39240099
392500                                                                  39250099
392600         PERFORM 4033-CLOSE-RFID-ERR-CSR-EQ42                     39260099
392700     END-IF.                                                      39270099
392800                                                                  39280099
392900                                                                  39290099
402800******************************************************************40280099
402900* 4011-OPEN-QC-ERR-CSR                                           *40290099
403000******************************************************************40300099
403100 4011-OPEN-QC-ERR-CSR.                                            40310099
403200                                                                  40320099
403300     EXEC SQL                                                     40330099
403400         OPEN QC_ERR_CSR                                          40340099
403500     END-EXEC.                                                    40350099
403600                                                                  40360099
403700     EVALUATE TRUE                                                40370099
403800         WHEN SQLCODE = ZERO                                      40380099
403900             SET PS-NOT-EOC-QC-ERR-CSR TO TRUE                    40390099
404000                                                                  40400099
404100         WHEN SQLWARN0 NOT EQUAL SPACE                            40410099
404200         WHEN SQLCODE NOT EQUAL ZERO                              40420099
404300             DISPLAY 'AUDIT CNTL NBR:  '                          40430099
404400                                     DK-AUD-CNTL-NBR              40440099
404500             DISPLAY 'SHIPT UNT ID:    '                          40450099
404600                                     DK-SHIPT-UNT-ID              40460099
404700             DISPLAY 'UPC NBR:         '                          40470099
404800                                     DK-UPC-NBR                   40480099
404900             MOVE '4011-OPEN-QC-ERR-CSR'                          40490099
405000                               TO  PV-PARAGRAPH-NAME              40500099
405100             MOVE 'OPEN QC_ERR_CSR'                               40510099
405200                               TO  PV-DB2-OPERATION-ATTEMPTED     40520099
405300              PERFORM 9999-SQL-ABEND                              40530099
405400     END-EVALUATE.                                                40540099
405500                                                                  40550099
405600******************************************************************40560099
405700* 4012-FETCH-QC-ERR-CSR                                          *40570099
405800*  FETCH THE NEXT OCCURANCE OF THE EXCEPTION_CURSOR              *40580099
405900******************************************************************40590099
406000 4012-FETCH-QC-ERR-CSR.                                           40600099
406100                                                                  40610099
406200     EXEC SQL                                                     40620099
406300         FETCH QC_ERR_CSR                                         40630099
406400         INTO    :SUEXCP-VILN-GP-SEQ-NBR                          40640099
406500               , :VILNCD-VILN-CDE-SHRT-DESC                       40650099
406600               , :SUEXCP-OVRRID-SYS-DAT-TXT                       40660099
406700               , :PV-DB2-EXCEPTION-COUNT                          40670099
406800               , :PV-DB2-RFID-EXCP-COUNT                          40680099
406900     END-EXEC.                                                    40690099
407000                                                                  40700099
407100     EVALUATE TRUE                                                40710099
407200         WHEN SQLCODE = ZERO                                      40720099
407300           IF PV-DB2-EXCEPTION-COUNT < 0                          40730099
407400             COMPUTE PV-DB2-EXCEPTION-COUNT =                     40740099
407500                 PV-DB2-EXCEPTION-COUNT * -1                      40750099
407600           END-IF                                                 40760099
407700           MOVE PV-DB2-EXCEPTION-COUNT   TO PV-DL-EXCEPTION-COUNT 40770099
407800                                                                  40780099
407900         WHEN SQLCODE = +100                                      40790099
408000             MOVE ZEROS                  TO PV-DL-EXCEPTION-COUNT 40800099
408100             SET PS-EOC-QC-ERR-CSR       TO TRUE                  40810099
408200                                                                  40820099
408300         WHEN SQLWARN0 NOT EQUAL SPACE                            40830099
408400         WHEN SQLCODE NOT EQUAL ZERO                              40840099
408500             DISPLAY 'AUDIT CNTL NBR:  '                          40850099
408600                                     DK-AUD-CNTL-NBR              40860099
408700             DISPLAY 'SHIPT UNT ID:    '                          40870099
408800                                     DK-SHIPT-UNT-ID              40880099
408900             DISPLAY 'UPC NBR:         '                          40890099
409000                                     DK-UPC-NBR                   40900099
409100             MOVE '4012-FETCH-QC-ERR-CSR'                         40910099
409200                               TO  PV-PARAGRAPH-NAME              40920099
409300             MOVE 'FETCH QC_ERR_CSR'                              40930099
409400                               TO  PV-DB2-OPERATION-ATTEMPTED     40940099
409500             PERFORM 9999-SQL-ABEND                               40950099
409600     END-EVALUATE.                                                40960099
409700                                                                  40970099
409800******************************************************************40980099
409900* 4013-CLOSE-QC-ERR-CSR                                          *40990099
410000******************************************************************41000099
410100 4013-CLOSE-QC-ERR-CSR.                                           41010099
410200                                                                  41020099
410300     EXEC SQL                                                     41030099
410400         CLOSE QC_ERR_CSR                                         41040099
410500     END-EXEC.                                                    41050099
410600                                                                  41060099
410700     EVALUATE TRUE                                                41070099
410800         WHEN SQLCODE = ZERO                                      41080099
410900             CONTINUE                                             41090099
411000                                                                  41100099
411100         WHEN SQLWARN0 NOT EQUAL SPACE                            41110099
411200         WHEN SQLCODE NOT EQUAL ZERO                              41120099
411300             DISPLAY 'AUDIT CNTL NBR:  '                          41130099
411400                                     DK-AUD-CNTL-NBR              41140099
411500             DISPLAY 'SHIPT UNT ID:    '                          41150099
411600                                     DK-SHIPT-UNT-ID              41160099
411700             DISPLAY 'UPC NBR:         '                          41170099
411800                                     DK-UPC-NBR                   41180099
411900             MOVE '4013-CLOSE-QC-ERR-CSR'                         41190099
412000                               TO  PV-PARAGRAPH-NAME              41200099
412100             MOVE 'CLOSE QC_ERR_CSR'                              41210099
412200                               TO  PV-DB2-OPERATION-ATTEMPTED     41220099
412300             PERFORM 9999-SQL-ABEND                               41230099
412400     END-EVALUATE.                                                41240099
412500                                                                  41250099
412600******************************************************************41260099
412700* 4021-OPEN-RFID-ERR-CSR-LT42                                    *41270099
412800******************************************************************41280099
412900 4021-OPEN-RFID-ERR-CSR-LT42.                                     41290099
413000                                                                  41300099
413100     EXEC SQL                                                     41310099
413200         OPEN RFID_ERR_CSR_LT42                                   41320099
413300     END-EXEC.                                                    41330099
413400                                                                  41340099
413500     EVALUATE TRUE                                                41350099
413600         WHEN SQLCODE = ZERO                                      41360099
413700             SET PS-NOT-EOC-RFID-ERR-CSR-LT42 TO TRUE             41370099
413800                                                                  41380099
413900         WHEN SQLWARN0 NOT EQUAL SPACE                            41390099
414000         WHEN SQLCODE NOT EQUAL ZERO                              41400099
414100             DISPLAY 'AUDIT CNTL NBR:  '                          41410099
414200                                     DK-AUD-CNTL-NBR              41420099
414300             DISPLAY 'SHIPT UNT ID:    '                          41430099
414400                                     DK-SHIPT-UNT-ID              41440099
414500             DISPLAY 'UPC NBR:         '                          41450099
414600                                     DK-UPC-NBR                   41460099
414700             MOVE '4021-OPEN-RFID-ERR-CSR-LT42'                   41470099
414800                               TO  PV-PARAGRAPH-NAME              41480099
414900             MOVE 'OPEN RFID_ERR_CSR_LT42'                        41490099
415000                               TO  PV-DB2-OPERATION-ATTEMPTED     41500099
415100              PERFORM 9999-SQL-ABEND                              41510099
415200     END-EVALUATE.                                                41520099
415300                                                                  41530099
415400******************************************************************41540099
415500* 4022-FETCH-RFID-ERR-CSR-LT42                                   *41550099
415600******************************************************************41560099
415700 4022-FETCH-RFID-ERR-CSR-LT42.                                    41570099
415800                                                                  41580099
415900     EXEC SQL                                                     41590099
416000         FETCH RFID_ERR_CSR_LT42                                  41600099
416100         INTO    :SUEXCP-VILN-GP-SEQ-NBR                          41610099
416200               , :VILNCD-VILN-CDE-SHRT-DESC                       41620099
416300               , :SUEXCP-OVRRID-SYS-DAT-TXT                       41630099
416400               , :PV-DB2-EXCEPTION-COUNT                          41640099
416500               , :PV-DB2-RFID-EXCP-COUNT                          41650099
416600     END-EXEC.                                                    41660099
416700                                                                  41670099
416800     EVALUATE TRUE                                                41680099
416900         WHEN SQLCODE = ZERO                                      41690099
417600             IF SUEXCP-VILN-GP-SEQ-NBR = 38                       41760099
417700                MOVE 1              TO PV-DL-EXCEPTION-COUNT      41770099
417800             ELSE                                                 41780099
417900               IF PV-DB2-RFID-EXCP-COUNT > 0                      41790099
418000                  MOVE PV-DB2-RFID-EXCP-COUNT                     41800099
418100                                    TO PV-DL-EXCEPTION-COUNT      41810099
418200               ELSE                                               41820099
418300                 IF PV-DB2-EXCEPTION-COUNT > 0                    41830099
418400                    MOVE PV-DB2-EXCEPTION-COUNT                   41840099
418500                                    TO PV-DL-EXCEPTION-COUNT      41850099
418600                 ELSE                                             41860099
418700                    MOVE ZERO       TO PV-DL-EXCEPTION-COUNT      41870099
418800                 END-IF                                           41880099
418900               END-IF                                             41890099
419000             END-IF                                               41900099
419100                                                                  41910099
419200         WHEN SQLCODE = +100                                      41920099
419300             SET PS-EOC-RFID-ERR-CSR-LT42 TO TRUE                 41930099
419400                                                                  41940099
419500         WHEN SQLWARN0 NOT EQUAL SPACE                            41950099
419600         WHEN SQLCODE NOT EQUAL ZERO                              41960099
419700             DISPLAY 'AUDIT CNTL NBR:  '                          41970099
419800                                     DK-AUD-CNTL-NBR              41980099
419900             DISPLAY 'SHIPT UNT ID:    '                          41990099
420000                                     DK-SHIPT-UNT-ID              42000099
420100             DISPLAY 'UPC NBR:         '                          42010099
420200                                     DK-UPC-NBR                   42020099
420300             MOVE '4022-FETCH-RFID-ERR-CSR-LT42'                  42030099
420400                               TO  PV-PARAGRAPH-NAME              42040099
420500             MOVE 'FETCH RFID_ERR_CSR_LT42'                       42050099
420600                               TO  PV-DB2-OPERATION-ATTEMPTED     42060099
420700             PERFORM 9999-SQL-ABEND                               42070099
420800     END-EVALUATE.                                                42080099
420900                                                                  42090099
421000******************************************************************42100099
421100* 4023-CLOSE-RFID-ERR-CSR-LT42                                   *42110099
421200******************************************************************42120099
421300 4023-CLOSE-RFID-ERR-CSR-LT42.                                    42130099
421400                                                                  42140099
421500     EXEC SQL                                                     42150099
421600         CLOSE RFID_ERR_CSR_LT42                                  42160099
421700     END-EXEC.                                                    42170099
421800                                                                  42180099
421900     EVALUATE TRUE                                                42190099
422000         WHEN SQLCODE = ZERO                                      42200099
422100             CONTINUE                                             42210099
422200                                                                  42220099
422300         WHEN SQLWARN0 NOT EQUAL SPACE                            42230099
422400         WHEN SQLCODE NOT EQUAL ZERO                              42240099
422500             DISPLAY 'AUDIT CNTL NBR:  '                          42250099
422600                                     DK-AUD-CNTL-NBR              42260099
422700             DISPLAY 'SHIPT UNT ID:    '                          42270099
422800                                     DK-SHIPT-UNT-ID              42280099
422900             DISPLAY 'UPC NBR:         '                          42290099
423000                                     DK-UPC-NBR                   42300099
423100             MOVE '4023-CLOSE-RFID-ERR-CSR-LT42'                  42310099
423200                               TO  PV-PARAGRAPH-NAME              42320099
423300             MOVE 'CLOSE RFID_ERR_CSR_LT42'                       42330099
423400                               TO  PV-DB2-OPERATION-ATTEMPTED     42340099
423500             PERFORM 9999-SQL-ABEND                               42350099
423600     END-EVALUATE.                                                42360099
423700                                                                  42370099
423800******************************************************************42380099
423900* 4031-OPEN-RFID-ERR-CSR-EQ42                                    *42390099
424000******************************************************************42400099
424100 4031-OPEN-RFID-ERR-CSR-EQ42.                                     42410099
424200                                                                  42420099
424300     EXEC SQL                                                     42430099
424400         OPEN RFID_ERR_CSR_EQ42                                   42440099
424500     END-EXEC.                                                    42450099
424600                                                                  42460099
424700     EVALUATE TRUE                                                42470099
424800         WHEN SQLCODE = ZERO                                      42480099
424900             SET PS-NOT-EOC-RFID-ERR-CSR-EQ42 TO TRUE             42490099
425000                                                                  42500099
425100         WHEN SQLWARN0 NOT EQUAL SPACE                            42510099
425200         WHEN SQLCODE NOT EQUAL ZERO                              42520099
425300             DISPLAY 'AUDIT CNTL NBR:  '                          42530099
425400                                     DK-AUD-CNTL-NBR              42540099
425500             DISPLAY 'SHIPT UNT ID:    '                          42550099
425600                                     DK-SHIPT-UNT-ID              42560099
425700             DISPLAY 'UPC NBR:         '                          42570099
425800                                     DK-UPC-NBR                   42580099
425900             MOVE '4031-OPEN-RFID-ERR-CSR-EQ42'                   42590099
426000                               TO  PV-PARAGRAPH-NAME              42600099
426100             MOVE 'OPEN RFID_ERR_CSR_EQ42'                        42610099
426200                               TO  PV-DB2-OPERATION-ATTEMPTED     42620099
426300              PERFORM 9999-SQL-ABEND                              42630099
426400     END-EVALUATE.                                                42640099
426500                                                                  42650099
426600******************************************************************42660099
426700* 4032-FETCH-RFID-ERR-CSR-EQ42                                   *42670099
426800******************************************************************42680099
426900 4032-FETCH-RFID-ERR-CSR-EQ42.                                    42690099
427000                                                                  42700099
427100     EXEC SQL                                                     42710099
427200         FETCH RFID_ERR_CSR_EQ42                                  42720099
427300         INTO    :SUEXCP-VILN-GP-SEQ-NBR                          42730099
427400               , :VILNCD-VILN-CDE-SHRT-DESC                       42740099
427500               , :SUEXCP-OVRRID-SYS-DAT-TXT                       42750099
427600               , :PV-DB2-EXCEPTION-COUNT                          42760099
427700               , :PV-DB2-RFID-EXCP-COUNT                          42770099
427800     END-EXEC.                                                    42780099
427900                                                                  42790099
428000     EVALUATE TRUE                                                42800099
428100         WHEN SQLCODE = ZERO                                      42810099
428200             COMPUTE PV-DL-EXCEPTION-COUNT =                      42820099
428300                 PV-DB2-EXCEPTION-COUNT - PV-DB2-RFID-EXCP-COUNT  42830099
428400             IF PV-DL-EXCEPTION-COUNT < 0                         42840099
428500                 COMPUTE PV-DL-EXCEPTION-COUNT =                  42850099
428600                     PV-DL-EXCEPTION-COUNT * -1                   42860099
428700             END-IF                                               42870099
428800                                                                  42880099
428900         WHEN SQLCODE = +100                                      42890099
429000             SET PS-EOC-RFID-ERR-CSR-EQ42    TO TRUE              42900099
429100                                                                  42910099
429200         WHEN SQLWARN0 NOT EQUAL SPACE                            42920099
429300         WHEN SQLCODE NOT EQUAL ZERO                              42930099
429400             DISPLAY 'AUDIT CNTL NBR:  '                          42940099
429500                                     DK-AUD-CNTL-NBR              42950099
429600             DISPLAY 'SHIPT UNT ID:    '                          42960099
429700                                     DK-SHIPT-UNT-ID              42970099
429800             DISPLAY 'UPC NBR:         '                          42980099
429900                                     DK-UPC-NBR                   42990099
430000             MOVE '4032-FETCH-RFID-ERR-CSR-EQ42'                  43000099
430100                               TO  PV-PARAGRAPH-NAME              43010099
430200             MOVE 'FETCH RFID_ERR_CSR_EQ42'                       43020099
430300                               TO  PV-DB2-OPERATION-ATTEMPTED     43030099
430400             PERFORM 9999-SQL-ABEND                               43040099
430500     END-EVALUATE.                                                43050099
430600                                                                  43060099
430700******************************************************************43070099
430800* 4033-CLOSE-RFID-ERR-CSR-EQ42                                   *43080099
430900******************************************************************43090099
431000 4033-CLOSE-RFID-ERR-CSR-EQ42.                                    43100099
431100                                                                  43110099
431200     EXEC SQL                                                     43120099
431300         CLOSE RFID_ERR_CSR_EQ42                                  43130099
431400     END-EXEC.                                                    43140099
431500                                                                  43150099
431600     EVALUATE TRUE                                                43160099
431700         WHEN SQLCODE = ZERO                                      43170099
431800             CONTINUE                                             43180099
431900                                                                  43190099
432000         WHEN SQLWARN0 NOT EQUAL SPACE                            43200099
432100         WHEN SQLCODE NOT EQUAL ZERO                              43210099
432200             DISPLAY 'AUDIT CNTL NBR:  '                          43220099
432300                                     DK-AUD-CNTL-NBR              43230099
432400             DISPLAY 'SHIPT UNT ID:    '                          43240099
432500                                     DK-SHIPT-UNT-ID              43250099
432600             DISPLAY 'UPC NBR:         '                          43260099
432700                                     DK-UPC-NBR                   43270099
432800             MOVE '4033-CLOSE-RFID-ERR-CSR-EQ42'                  43280099
432900                               TO  PV-PARAGRAPH-NAME              43290099
433000             MOVE 'CLOSE RFID_ERR_CSR_EQ42'                       43300099
433100                               TO  PV-DB2-OPERATION-ATTEMPTED     43310099
433200             PERFORM 9999-SQL-ABEND                               43320099
433300     END-EVALUATE.                                                43330099
433500                                                                  43350099
433600******************************************************************43360099
433700* 4100-WRITE-EXCEPTIONS                                          *43370099
433800*  FOR EACH EXCEPTION FETCHED FROM THE CURSOR, WRITE A DETAIL    *43380099
433900*  LINE                                                          *43390099
434000******************************************************************43400099
434100 4100-WRITE-EXCEPTIONS.                                           43410099
434200                                                                  43420099
434300     PERFORM 2100-FILL-IN-DETAIL-LINE.                            43430099
434400                                                                  43440099
434500     MOVE VILNCD-VILN-CDE-SHRT-DESC   TO DL-ERROR-DESC            43450099
434600                                         PV-ERROR-DESC.           43460099
434700     MOVE PV-DL-EXCEPTION-COUNT       TO DL-ERROR-QTY             43470099
434800                                         PV-ERROR-QTY.            43480099
434900                                                                  43490099
435000     EVALUATE SUEXCP-VILN-GP-SEQ-NBR                              43500099
435100                                                                  43510099
435200       WHEN PC-STYLE-SUB                                          43520099
435300       WHEN PC-WRONG-TICKET-STYLE                                 43530099
435400       WHEN PC-WRONG-TICKET-STYLE                                 43540099
435500       WHEN PC-WRONG-MDSE-LBL-STYLE                               43550099
435600           MOVE SUEXCP-OVRRID-SYS-DAT-TXT                         43560099
435700                                      TO DL-RECEIVED-AS-TEXT      43570099
435800           MOVE 'STY'                 TO DL-ERROR-TYPE            43580099
435900           MOVE SUAUPC-VND-STYL-DESC  TO DL-ORDERED-AS-TEXT       43590099
436000                                                                  43600099
436100       WHEN PC-WRONG-TICKET-DEPT                                  43610099
436200           MOVE SUEXCP-OVRRID-SYS-DAT-TXT                         43620099
436300                                      TO DL-RECEIVED-AS-TEXT      43630099
436400           MOVE 'DPT'                 TO DL-ERROR-TYPE            43640099
436500           MOVE XL001-DEPT-NBR-3CH    TO DL-ORDERED-AS-TEXT       43650099
436600                                                                  43660099
436700       WHEN PC-WRONG-TICKET-RETAIL                                43670099
436800       WHEN PC-WRONG-MDSE-LBL-RETAIL                              43680099
436900           MOVE SUEXCP-OVRRID-SYS-DAT-TXT                         43690099
437000                                      TO DL-RECEIVED-AS-TEXT      43700099
437100           MOVE 'RTL'                 TO DL-ERROR-TYPE            43710099
437200           MOVE SUAUPC-UPC-RTL-AMT    TO PV-DISP-DEC              43720099
437300           MOVE PV-DISP-DEC           TO DL-ORDERED-AS-TEXT       43730099
437400                                                                  43740099
437500       WHEN PC-WRONG-TICKET-COLOR                                 43750099
437600       WHEN PC-WRONG-MDSE-LBL-COLOR                               43760099
437700           MOVE SUEXCP-OVRRID-SYS-DAT-TXT                         43770099
437800                                      TO DL-RECEIVED-AS-TEXT      43780099
437900           MOVE 'CLR'                 TO DL-ERROR-TYPE            43790099
438000           MOVE SUAUPC-UPC-CLOR-DESC  TO DL-ORDERED-AS-TEXT       43800099
438100                                                                  43810099
438200       WHEN PC-WRONG-TICKET-SIZE                                  43820099
438300       WHEN PC-WRONG-MDSE-LBL-SIZE                                43830099
438400           MOVE SUEXCP-OVRRID-SYS-DAT-TXT                         43840099
438500                                      TO DL-RECEIVED-AS-TEXT      43850099
438600           MOVE 'SZE'                 TO DL-ERROR-TYPE            43860099
438700           MOVE SUAUPC-UPC-SIZE-DESC  TO DL-ORDERED-AS-TEXT       43870099
438800                                                                  43880099
438900       WHEN PC-WRONG-TICKET-MAJ-CLS                               43890099
439000           MOVE SUEXCP-OVRRID-SYS-DAT-TXT                         43900099
439100                                      TO DL-RECEIVED-AS-TEXT      43910099
439200           MOVE 'MCLS'                TO DL-ERROR-TYPE            43920099
439300           MOVE XL001-MAJ-CL-NBR-2CH  TO DL-ORDERED-AS-TEXT       43930099
439400                                                                  43940099
439500       WHEN PC-WRONG-TICKET-SUB-CLS                               43950099
439600           MOVE SUEXCP-OVRRID-SYS-DAT-TXT                         43960099
439700                                      TO DL-RECEIVED-AS-TEXT      43970099
439800           MOVE 'SCLS'                TO DL-ERROR-TYPE            43980099
439900           MOVE XL001-SUB-CL-NBR-2CH  TO DL-ORDERED-AS-TEXT       43990099
440000       WHEN PC-WRONG-MDSE-TKT-OK                                  44000099
440100       WHEN PC-WRONG-TKT-MDSE-OK                                  44010099
440200       WHEN PC-WRG-TAGS-NO-EPC                                    44020099
440300           MOVE SPACES                TO DL-RECEIVED-AS-TEXT      44030099
440400           MOVE 'UNT'                 TO DL-ERROR-TYPE            44040099
440500           MOVE SPACES                TO DL-ORDERED-AS-TEXT       44050099
440600       WHEN PC-WRG-RFD-TGS-CLR                                    44060099
440700           MOVE SUEXCP-OVRRID-SYS-DAT-TXT                         44070099
440800                                      TO DL-RECEIVED-AS-TEXT      44080099
440900           MOVE 'CLR'                 TO DL-ERROR-TYPE            44090099
441000           MOVE SUAUPC-UPC-CLOR-DESC  TO DL-ORDERED-AS-TEXT       44100099
441100       WHEN PC-WRG-RFD-TGS-SIZ                                    44110099
441200           MOVE SUEXCP-OVRRID-SYS-DAT-TXT                         44120099
441300                                      TO DL-RECEIVED-AS-TEXT      44130099
441400           MOVE 'SZE'                 TO DL-ERROR-TYPE            44140099
441500           MOVE SUAUPC-UPC-SIZE-DESC  TO DL-ORDERED-AS-TEXT       44150099
441600       WHEN PC-WRG-RFD-TGS-STL                                    44160099
441700           MOVE SUEXCP-OVRRID-SYS-DAT-TXT                         44170099
441800                                      TO DL-RECEIVED-AS-TEXT      44180099
441900           MOVE 'STL'                 TO DL-ERROR-TYPE            44190099
442000           MOVE SUAUPC-VND-STYL-DESC  TO DL-ORDERED-AS-TEXT       44200099
442100       WHEN PC-VA-NO-EPC-LOGO                                     44210099
442200           MOVE SPACES                TO DL-RECEIVED-AS-TEXT      44220099
442300           MOVE 'UNT'                 TO DL-ERROR-TYPE            44230099
442400           MOVE SPACES                TO DL-ORDERED-AS-TEXT       44240099
442500                                                                  44250099
442600       WHEN OTHER                                                 44260099
442700           MOVE SPACES                TO DL-RECEIVED-AS-TEXT      44270099
442800                                         DL-ERROR-TYPE            44280099
442900                                         DL-ORDERED-AS-TEXT       44290099
443000                                                                  44300099
443100     END-EVALUATE.                                                44310099
443200                                                                  44320099
443300     IF PV-ERROR-QTY > 0                                          44330099
443400         PERFORM 8002-WRITE-DETAIL-LINE                           44340099
443500                                                                  44350099
443600         PERFORM 4200-ACCUM-SUM-TABLES                            44360099
443700     END-IF.                                                      44370099
443800                                                                  44380099
443900                                                                  44390099
444000******************************************************************44400099
444100* 4200-ACCUM-SUM-TABLES  --  ADD THE QUANTITY TO THE ACCUMULATOR  44410099
444200* SUMMARY TABLES.                                                 44420099
444300******************************************************************44430099
444400 4200-ACCUM-SUM-TABLES.                                           44440099
444500                                                                  44450099
444600     IF PV-PICKING-ERROR                                          44460099
444700         PERFORM VARYING PV-ERROR-IDX FROM 1 BY 1                 44470099
444800         UNTIL PA-PIC-ERROR (PV-ERROR-IDX) = SPACES               44480099
444900            OR PA-PIC-ERROR (PV-ERROR-IDX) = PV-ERROR-DESC        44490099
445000            OR PV-ERROR-IDX > 25                                  44500099
445100         END-PERFORM                                              44510099
445200                                                                  44520099
445300         IF PA-PIC-ERROR (PV-ERROR-IDX) = PV-ERROR-DESC           44530099
445400             ADD PV-ERROR-QTY                                     44540099
445500                              TO PA-PIC-ERROR-QTY (PV-ERROR-IDX)  44550099
445600         ELSE                                                     44560099
445700             IF PA-PIC-ERROR (PV-ERROR-IDX) = SPACES              44570099
445800                 MOVE PV-ERROR-DESC                               44580099
445900                              TO PA-PIC-ERROR (PV-ERROR-IDX)      44590099
446000                 MOVE PV-ERROR-QTY                                44600099
446100                              TO PA-PIC-ERROR-QTY (PV-ERROR-IDX)  44610099
446200             ELSE                                                 44620099
446300                 DISPLAY '** ABEND                             **'44630099
446400                 DISPLAY '** PROGRAM   = SUKRP011              **'44640099
446500                 DISPLAY '** PARAGRAPH = 4200-ACCUM-SUM-TABLES **'44650099
446600                 DISPLAY '** SUMMARY TABLE OVERFLOW ERROR      **'44660099
446700                 DISPLAY '** PICKING ERROR TABLE SET AT 25 --  **'44670099
446800                 DISPLAY '** MUST BE INCREASED                 **'44680099
446900                 MOVE +4004 TO ABEND-CODE                         44690099
447000                 CALL 'ILBOABN0' USING ABEND-CODE                 44700099
447100             END-IF                                               44710099
447200         END-IF                                                   44720099
447300     END-IF.                                                      44730099
447400                                                                  44740099
447500     IF PV-TICKETING-ERROR                                        44750099
447600         PERFORM VARYING PV-ERROR-IDX FROM 1 BY 1                 44760099
447700         UNTIL PA-TIC-ERROR (PV-ERROR-IDX) = SPACES               44770099
447800            OR PA-TIC-ERROR (PV-ERROR-IDX) = PV-ERROR-DESC        44780099
447900            OR PV-ERROR-IDX > 25                                  44790099
448000         END-PERFORM                                              44800099
448100                                                                  44810099
448200         IF PA-TIC-ERROR (PV-ERROR-IDX) = PV-ERROR-DESC           44820099
448300             ADD PV-ERROR-QTY                                     44830099
448400                              TO PA-TIC-ERROR-QTY (PV-ERROR-IDX)  44840099
448500         ELSE                                                     44850099
448600             IF PA-TIC-ERROR (PV-ERROR-IDX) = SPACES              44860099
448700                 MOVE PV-ERROR-DESC                               44870099
448800                              TO PA-TIC-ERROR (PV-ERROR-IDX)      44880099
448900                 MOVE PV-ERROR-QTY                                44890099
449000                              TO PA-TIC-ERROR-QTY (PV-ERROR-IDX)  44900099
449100             ELSE                                                 44910099
449200                 DISPLAY '** ABEND                             **'44920099
449300                 DISPLAY '** PROGRAM   = SUKRP011              **'44930099
449400                 DISPLAY '** PARAGRAPH = 4200-ACCUM-SUM-TABLES **'44940099
449500                 DISPLAY '** SUMMARY TABLE OVERFLOW ERROR      **'44950099
449600                 DISPLAY '** TICKETING ERROR TABLE SET AT 25 - **'44960099
449700                 DISPLAY '** MUST BE INCREASED                 **'44970099
449800                 MOVE +4004 TO ABEND-CODE                         44980099
449900                 CALL 'ILBOABN0' USING ABEND-CODE                 44990099
450000             END-IF                                               45000099
450100         END-IF                                                   45010099
450200     END-IF.                                                      45020099
450300                                                                  45030099
450500     IF PV-RFID-ERROR                                             45050099
450600         PERFORM VARYING PV-ERROR-IDX FROM 1 BY 1                 45060099
450700         UNTIL PA-RFID-ERROR (PV-ERROR-IDX) = SPACES              45070099
450800            OR PA-RFID-ERROR (PV-ERROR-IDX) = PV-ERROR-DESC       45080099
450900            OR PV-ERROR-IDX > 25                                  45090099
451000         END-PERFORM                                              45100099
451100                                                                  45110099
451200         IF PA-RFID-ERROR (PV-ERROR-IDX) = PV-ERROR-DESC          45120099
451300             ADD PV-ERROR-QTY                                     45130099
451400                              TO PA-RFID-ERROR-QTY (PV-ERROR-IDX) 45140099
451500         ELSE                                                     45150099
451600             IF PA-RFID-ERROR (PV-ERROR-IDX) = SPACES             45160099
451700                 MOVE PV-ERROR-DESC                               45170099
451800                              TO PA-RFID-ERROR (PV-ERROR-IDX)     45180099
451900                 MOVE PV-ERROR-QTY                                45190099
452000                              TO PA-RFID-ERROR-QTY (PV-ERROR-IDX) 45200099
452100             ELSE                                                 45210099
452200                 DISPLAY '** ABEND                             **'45220099
452300                 DISPLAY '** PROGRAM   = SUKRP011              **'45230099
452400                 DISPLAY '** PARAGRAPH = 4200-ACCUM-SUM-TABLES **'45240099
452500                 DISPLAY '** SUMMARY TABLE OVERFLOW ERROR      **'45250099
452600                 DISPLAY '** RFID ERROR TABLE SET AT 25 -      **'45260099
452700                 DISPLAY '** MUST BE INCREASED                 **'45270099
452800                 MOVE +4004 TO ABEND-CODE                         45280099
452900                 CALL 'ILBOABN0' USING ABEND-CODE                 45290099
453000             END-IF                                               45300099
453100         END-IF                                                   45310099
453300     END-IF.                                                      45330099
453400                                                                  45340099
456000******************************************************************45600099
456100 7000-READ-CARDIN-FILE.                                           45610099
456200                                                                  45620099
456300     READ CARDIN-AUDIT-NBR-FILE INTO CC-CARDIN                    45630099
456400        AT END                                                    45640099
456500           SET PS-END-OF-CARDIN-FILE TO TRUE.                     45650099
456600                                                                  45660099
456700     IF PS-END-OF-CARDIN-FILE                                     45670099
456800         CONTINUE                                                 45680099
456900     ELSE                                                         45690099
457000         DISPLAY 'AUDIT NBR IS : ' CC-AUDIT-CNTL-NBR              45700099
457100         DISPLAY 'CARTON ID IS : ' CC-CARTON-ID                   45710099
457200         PERFORM 7100-VALIDATE-CONTROL-CARD                       45720099
457300     END-IF.                                                      45730099
457400                                                                  45740099
457500******************************************************************45750099
457600* 7100-VALIDATE-CONTROL-CARD - VERIFIES THAT THE AUDIT CONTROL    45760099
457700* NUMBER AND THE SHIPPING UNIT ID ARE BOTH NUMBERIC               45770099
457800******************************************************************45780099
457900 7100-VALIDATE-CONTROL-CARD.                                      45790099
458000                                                                  45800099
458100*NUMERIC EDIT OF AUDIT CONTROL NBR                                45810099
458110                                                                  45811099
458200     MOVE CC-AUDIT-CNTL-NBR          TO DP010I-UNEDITED-FIELD.    45820099
458300     MOVE +9                         TO DP010I-MAXIMUM-DIGITS.    45830099
458400     MOVE 0                          TO DP010I-MAXIMUM-DECIMALS.  45840099
458500     SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE.                     45850099
458600     CALL DP010I-NUMERIC-EDIT-ROUTINE                             45860099
458700         USING DP010I-NUMERIC-EDIT-AREA.                          45870099
458800                                                                  45880099
458900     IF DP010I-NO-ERROR-DETECTED                                  45890099
459000         MOVE DP010I-NUMERIC-FIELD  TO DK-AUD-CNTL-NBR            45900099
459100     ELSE                                                         45910099
459200         DISPLAY '** SUKRP011 ABEND **'                           45920099
459300         DISPLAY '** AUDIT NUMBER IS NOT NUMERIC **'              45930099
459400         MOVE +4019                  TO ABEND-CODE                45940099
459500         CALL 'ILBOABN0' USING ABEND-CODE                         45950099
459600     END-IF.                                                      45960099
459700                                                                  45970099
462500                                                                  46250099
462600     MOVE CC-CARTON-ID           TO DK-SHIPT-UNT-ID.              46260099
463500                                                                  46350099
463600******************************************************************46360099
463700* 8000-READ-OVER-SHORT-FILE - READS THE NEXT RECORD FROM THE AUDIT46370099
463800* SUMMARY EXTRACT FILE.                                           46380099
463900******************************************************************46390099
464000 8000-READ-VND-OVER-SHORT-FILE.                                   46400099
464100                                                                  46410099
464200     READ OS-VENDOR-OVER-SHORT-FILE                               46420099
464300         INTO SU003-EXTRACT-RECORD OF OS-FILE                     46430099
464400     AT END                                                       46440099
464500         SET PS-EOF-VND-OVER-SHORT     TO TRUE                    46450099
464600     END-READ.                                                    46460099
464700                                                                  46470099
464800* MOVE THE DEPARTMENT NUMBER TO THE HEADING VARIABLE              46480099
464810                                                                  46481099
464900     IF PS-NOT-EOF-VND-OVER-SHORT                                 46490099
465000        MOVE SU003-SKU-DEPT-NBR OF OS-FILE TO AH2-DEPT            46500099
465100     END-IF.                                                      46510099
465200                                                                  46520099
465300******************************************************************46530099
465400* 8001-READ-VND-TOT-ERR-FILE  READS THE NEXT RECORD FROM THE TOTAL46540099
465500* ERROR EXTRACT FILE.                                             46550099
465600******************************************************************46560099
465700 8001-READ-VND-TOT-ERR-FILE.                                      46570099
465800                                                                  46580099
465900     READ TE-VENDOR-TOTAL-ERROR-FILE                              46590099
466000         INTO SU003-EXTRACT-RECORD OF TE-FILE                     46600099
466100     AT END                                                       46610099
466200         SET PS-EOF-VND-TOT-ERR-FILE TO TRUE                      46620099
466300     END-READ.                                                    46630099
466400                                                                  46640099
466500                                                                  46650099
466600******************************************************************46660099
466700* 8002-WRITE-DETAIL-LINE                                          46670099
466800******************************************************************46680099
466900 8002-WRITE-DETAIL-LINE.                                          46690099
467000                                                                  46700099
467100     IF PV-DETAIL-LINE-COUNT > PC-MAX-REPORT-LINES                46710099
467200         PERFORM 3000-PRINT-PAGE-HEADING                          46720099
467300     END-IF.                                                      46730099
467400                                                                  46740099
467702     IF  CC-FLAT-FILE                                             46770299
467706                                                                  46770699
467707         MOVE SPACES  TO VA-VND-AUDIT-DETAIL-LINE-FLAT            46770799
467710         WRITE VA-VND-AUDIT-DETAIL-LINE-FLAT                      46771099
467720          FROM DL-DETAIL-LINE                                     46772099
467731     ELSE                                                         46773199
467732         WRITE VA-VND-AUDIT-DETAIL-LINE                           46773299
467733          FROM DL-DETAIL-LINE                                     46773399
467734         AFTER ADVANCING PV-DETAIL-LINE-ADVANCE LINES             46773499
467735                                                                  46773599
467736         WRITE VA-VND-AUDIT-DETAIL-LINE-LOG                       46773699
467737          FROM DL-DETAIL-LINE                                     46773799
467738         AFTER ADVANCING PV-DETAIL-LINE-ADVANCE LINES             46773899
467739     END-IF.                                                      46773999
468100                                                                  46810099
468200     ADD PV-DETAIL-LINE-ADVANCE TO PV-DETAIL-LINE-COUNT.          46820099
468300                                                                  46830099
468400     MOVE +1 TO PV-DETAIL-LINE-ADVANCE.                           46840099
468500                                                                  46850099
468600                                                                  46860099
468700******************************************************************46870099
468800* 8003-READ-RCVR-TOT-ERR-FILE    READ THE NEXT RECORD FROM THE    46880099
468900* RECIEVER OVER/SHORT FILE/.                                      46890099
469000******************************************************************46900099
469100 8003-READ-RCVR-TOT-ERR-FILE.                                     46910099
469200                                                                  46920099
469300     READ OS-RECEIVER-TOTAL-ERROR-FILE                            46930099
469400         INTO SU004-EXTRACT-RECORD                                46940099
469500     AT END                                                       46950099
469600         SET PS-EOF-RCVR-TOTAL-ERROR   TO TRUE                    46960099
469700     END-READ.                                                    46970099
469800                                                                  46980099
469900                                                                  46990099
470000******************************************************************47000099
470100* 8004-READ-SKU-TOTAL-FILE       READ THE NEXT RECORD FROM THE    47010099
470200* SKU TOTAL FILE.                                                 47020099
470300******************************************************************47030099
470400 8004-READ-SKU-TOTAL-FILE.                                        47040099
470500                                                                  47050099
470600     READ OS-SKUTOT-OVER-SHORT-FILE                               47060099
470700         INTO SU003-EXTRACT-RECORD OF OS-SKU-FILE                 47070099
470800     AT END                                                       47080099
470900         SET PS-EOF-SKU-TOTAL-FILE     TO TRUE                    47090099
471000     END-READ.                                                    47100099
471100                                                                  47110099
471200                                                                  47120099
471300******************************************************************47130099
471400* 8100-END-OF-RECEIVER-LOGIC.                                     47140099
471500*  THIS PARAGRAPH WILL PRNT THE ERROR SUMMARY SECTION, AND PRINT  47150099
471600*  THE RECEIVER OVER/SHORT MESSAGE IF NEEDED                      47160099
471700******************************************************************47170099
471800 8100-END-OF-RECEIVER-LOGIC.                                      47180099
471900     PERFORM 8200-PRINT-ERROR-SUMMARY.                            47190099
472000                                                                  47200099
472100     IF PS-RCVR-OVER-SHORT-FOUND                                  47210099
472200         PERFORM 8500-PRINT-RCVR-MSG                              47220099
472300     END-IF.                                                      47230099
472400                                                                  47240099
472500                                                                  47250099
472600******************************************************************47260099
472700* 8200-PRINT-ERROR-SUMMARY.                                       47270099
472800*  THIS PARAGRAPH WILL PRNT THE ERROR SUMMARY SECTION             47280099
472900******************************************************************47290099
473000 8200-PRINT-ERROR-SUMMARY.                                        47300099
473100                                                                  47310099
473200     INITIALIZE PV-TOTAL-ERROR-QTY.                               47320099
473300                                                                  47330099
473400*    FIRST DETERMINE IF THE SUMMARY SECTION WILL FIT ON THE PAGE  47340099
473410                                                                  47341099
473500     MOVE +11                TO PV-SUM-LINE-COUNT.                47350099
473600                                                                  47360099
473700     PERFORM VARYING PV-ERROR-IDX FROM 1 BY 1                     47370099
473800     UNTIL PA-PIC-ERROR (PV-ERROR-IDX) = SPACES                   47380099
473900        OR PV-ERROR-IDX > 25                                      47390099
474000        ADD +1 TO PV-SUM-LINE-COUNT                               47400099
474100     END-PERFORM.                                                 47410099
474200                                                                  47420099
474300     PERFORM VARYING PV-ERROR-IDX FROM 1 BY 1                     47430099
474400     UNTIL PA-TIC-ERROR (PV-ERROR-IDX) = SPACES                   47440099
474500        OR PV-ERROR-IDX > 25                                      47450099
474600        ADD +1 TO PV-SUM-LINE-COUNT                               47460099
474700     END-PERFORM.                                                 47470099
474800                                                                  47480099
474900     IF (PV-DETAIL-LINE-COUNT +                                   47490099
475000         PV-SUM-LINE-COUNT )  > PC-MAX-REPORT-LINES               47500099
475100         PERFORM 3000-PRINT-PAGE-HEADING                          47510099
475200     END-IF.                                                      47520099
475300                                                                  47530099
475400     ADD PV-SUM-LINE-COUNT     TO PV-DETAIL-LINE-COUNT            47540099
475500                                                                  47550099
475600*    WRITE THE ERROR SUMMARY HEADING LINE                         47560099
475610                                                                  47561099
475902     IF  CC-FLAT-FILE                                             47590299
475911         MOVE SPACES  TO VA-VND-AUDIT-DETAIL-LINE-FLAT            47591199
475912         WRITE VA-VND-AUDIT-DETAIL-LINE-FLAT                      47591299
475920          FROM FH-FOOTER-HEADING-LINE                             47592099
475931     ELSE                                                         47593199
475932         WRITE VA-VND-AUDIT-DETAIL-LINE                           47593299
475933          FROM FH-FOOTER-HEADING-LINE                             47593399
475934         AFTER ADVANCING 3 LINES                                  47593499
475935                                                                  47593599
475936         WRITE VA-VND-AUDIT-DETAIL-LINE-LOG                       47593699
475937          FROM FH-FOOTER-HEADING-LINE                             47593799
475938         AFTER ADVANCING 3 LINES                                  47593899
475939     END-IF.                                                      47593999
476300                                                                  47630099
476400*    WRITE THE PICKING ERROR HEADING LINE                         47640099
476410                                                                  47641099
476500     IF CC-QC-AUDIT                                               47650099
476600         MOVE 'PICKING ERRORS'        TO FD-FOOTER-DETAIL-DESC    47660099
476700         MOVE SPACES                  TO FD-FOOTER-DETAIL-QTY-X   47670099
477001                                                                  47700199
477002         IF  CC-FLAT-FILE                                         47700299
477007             MOVE SPACES  TO VA-VND-AUDIT-DETAIL-LINE-FLAT        47700799
477010             WRITE VA-VND-AUDIT-DETAIL-LINE-FLAT                  47701099
477020              FROM FD-FOOTER-DETAIL-LINE                          47702099
477031         else                                                     47703199
477032             WRITE VA-VND-AUDIT-DETAIL-LINE                       47703299
477033              FROM FD-FOOTER-DETAIL-LINE                          47703399
477034             AFTER ADVANCING 2 LINES                              47703499
477035                                                                  47703599
477036             WRITE VA-VND-AUDIT-DETAIL-LINE-LOG                   47703699
477037              FROM FD-FOOTER-DETAIL-LINE                          47703799
477038             AFTER ADVANCING 2 LINES                              47703899
477039         end-if                                                   47703999
477400                                                                  47740099
477702         IF  CC-FLAT-FILE                                         47770299
477703             continue                                             47770399
477731         else                                                     47773199
477732             WRITE VA-VND-AUDIT-DETAIL-LINE                       47773299
477733              FROM BLANK-LINE                                     47773399
477734             AFTER ADVANCING 1 LINE                               47773499
477735                                                                  47773599
477736             WRITE VA-VND-AUDIT-DETAIL-LINE-LOG                   47773699
477737              FROM BLANK-LINE                                     47773799
477738             AFTER ADVANCING 1 LINE                               47773899
477739         end-if                                                   47773999
478100                                                                  47810099
478200*    WRITE THE PICKING ERRORS                                     47820099
478210                                                                  47821099
478300         PERFORM VARYING PV-ERROR-IDX FROM 1 BY 1                 47830099
478400         UNTIL PA-PIC-ERROR (PV-ERROR-IDX) = SPACES               47840099
478500            OR PV-ERROR-IDX > 25                                  47850099
478600             MOVE PA-PIC-ERROR-DESC (PV-ERROR-IDX)                47860099
478700                                      TO FD-FOOTER-DETAIL-DESC    47870099
478800             MOVE PA-PIC-ERROR-QTY (PV-ERROR-IDX)                 47880099
478900                                      TO FD-FOOTER-DETAIL-QTY     47890099
479000             ADD  PA-PIC-ERROR-QTY (PV-ERROR-IDX)                 47900099
479100                                      TO PV-TOTAL-ERROR-QTY       47910099
479401                                                                  47940199
479402             IF  CC-FLAT-FILE                                     47940299
479403                 MOVE SPACES  TO VA-VND-AUDIT-DETAIL-LINE-FLAT    47940399
479410                 WRITE VA-VND-AUDIT-DETAIL-LINE-FLAT              47941099
479420                  FROM FD-FOOTER-DETAIL-LINE                      47942099
479421             else                                                 47942199
479422                 WRITE VA-VND-AUDIT-DETAIL-LINE                   47942299
479423                  FROM FD-FOOTER-DETAIL-LINE                      47942399
479424                 AFTER ADVANCING 1 LINE                           47942499
479425                                                                  47942599
479426                 WRITE VA-VND-AUDIT-DETAIL-LINE-LOG               47942699
479427                  FROM FD-FOOTER-DETAIL-LINE                      47942799
479428                 AFTER ADVANCING 1 LINE                           47942899
479429             end-if                                               47942999
479430                                                                  47943099
479800         END-PERFORM                                              47980099
479900                                                                  47990099
480000                                                                  48000099
480100*    WRITE THE TICKETING ERROR HEADING LINE                       48010099
480110                                                                  48011099
480200         MOVE 'TICKETING ERRORS'      TO FD-FOOTER-DETAIL-DESC    48020099
480300         MOVE SPACES                  TO FD-FOOTER-DETAIL-QTY-X   48030099
480601                                                                  48060199
480602         IF  CC-FLAT-FILE                                         48060299
480607             MOVE SPACES  TO VA-VND-AUDIT-DETAIL-LINE-FLAT        48060799
480610             WRITE VA-VND-AUDIT-DETAIL-LINE-FLAT                  48061099
480620              FROM FD-FOOTER-DETAIL-LINE                          48062099
480631         else                                                     48063199
480632             WRITE VA-VND-AUDIT-DETAIL-LINE                       48063299
480633              FROM FD-FOOTER-DETAIL-LINE                          48063399
480634             AFTER ADVANCING 2 LINES                              48063499
480635                                                                  48063599
480636             WRITE VA-VND-AUDIT-DETAIL-LINE-LOG                   48063699
480637              FROM FD-FOOTER-DETAIL-LINE                          48063799
480638             AFTER ADVANCING 2 LINES                              48063899
480639         end-if                                                   48063999
481000                                                                  48100099
481302         IF  CC-FLAT-FILE                                         48130299
481303             continue                                             48130399
481321         ELSE                                                     48132199
481322             WRITE VA-VND-AUDIT-DETAIL-LINE                       48132299
481323              FROM BLANK-LINE                                     48132399
481324             AFTER ADVANCING 1 LINE                               48132499
481325                                                                  48132599
481326             WRITE VA-VND-AUDIT-DETAIL-LINE-LOG                   48132699
481327              FROM BLANK-LINE                                     48132799
481328             AFTER ADVANCING 1 LINE                               48132899
481329         END-IF                                                   48132999
481700                                                                  48170099
481800*    WRITE THE TICKETING ERRORS                                   48180099
481810                                                                  48181099
481900         PERFORM VARYING PV-ERROR-IDX FROM 1 BY 1                 48190099
482000         UNTIL PA-TIC-ERROR (PV-ERROR-IDX) = SPACES               48200099
482100            OR PV-ERROR-IDX > 25                                  48210099
482200             MOVE PA-TIC-ERROR-DESC (PV-ERROR-IDX)                48220099
482300                                      TO FD-FOOTER-DETAIL-DESC    48230099
482400             MOVE PA-TIC-ERROR-QTY (PV-ERROR-IDX)                 48240099
482500                                      TO FD-FOOTER-DETAIL-QTY     48250099
482600             ADD  PA-TIC-ERROR-QTY (PV-ERROR-IDX)                 48260099
482700                                      TO PV-TOTAL-ERROR-QTY       48270099
483001                                                                  48300199
483002             IF  CC-FLAT-FILE                                     48300299
483003                 MOVE SPACES  TO VA-VND-AUDIT-DETAIL-LINE-FLAT    48300399
483010                 WRITE VA-VND-AUDIT-DETAIL-LINE-FLAT              48301099
483020                  FROM FD-FOOTER-DETAIL-LINE                      48302099
483021             ELSE                                                 48302199
483022                 WRITE VA-VND-AUDIT-DETAIL-LINE                   48302299
483023                  FROM FD-FOOTER-DETAIL-LINE                      48302399
483024                 AFTER ADVANCING 1 LINE                           48302499
483025                                                                  48302599
483026                 WRITE VA-VND-AUDIT-DETAIL-LINE-LOG               48302699
483027                  FROM FD-FOOTER-DETAIL-LINE                      48302799
483028                 AFTER ADVANCING 1 LINE                           48302899
483029             END-IF                                               48302999
483030                                                                  48303099
483400         END-PERFORM                                              48340099
483500     END-IF.                                                      48350099
483600                                                                  48360099
483800*    WRITE THE RFID ERROR HEADING LINE                            48380099
483810                                                                  48381099
483900     IF CC-RFID-AUDIT                                             48390099
484000         MOVE 'RFID ERRORS'           TO FD-FOOTER-DETAIL-DESC    48400099
484100         MOVE SPACES                  TO FD-FOOTER-DETAIL-QTY-X   48410099
484401                                                                  48440199
484402         IF  CC-FLAT-FILE                                         48440299
484412             MOVE SPACES  TO VA-VND-AUDIT-DETAIL-LINE-FLAT        48441299
484413             WRITE VA-VND-AUDIT-DETAIL-LINE-FLAT                  48441399
484420              FROM FD-FOOTER-DETAIL-LINE                          48442099
484431         else                                                     48443199
484432             WRITE VA-VND-AUDIT-DETAIL-LINE                       48443299
484433              FROM FD-FOOTER-DETAIL-LINE                          48443399
484434             AFTER ADVANCING 2 LINES                              48443499
484435                                                                  48443599
484436             WRITE VA-VND-AUDIT-DETAIL-LINE-LOG                   48443699
484437              FROM FD-FOOTER-DETAIL-LINE                          48443799
484438             AFTER ADVANCING 2 LINES                              48443899
484439         end-if                                                   48443999
484800                                                                  48480099
485102         IF  CC-FLAT-FILE                                         48510299
485103             MOVE SPACES  TO VA-VND-AUDIT-DETAIL-LINE-FLAT        48510399
485110             WRITE VA-VND-AUDIT-DETAIL-LINE-FLAT                  48511099
485121         else                                                     48512199
485122             WRITE VA-VND-AUDIT-DETAIL-LINE                       48512299
485123              FROM BLANK-LINE                                     48512399
485124             AFTER ADVANCING 1 LINE                               48512499
485125                                                                  48512599
485126             WRITE VA-VND-AUDIT-DETAIL-LINE-LOG                   48512699
485127              FROM BLANK-LINE                                     48512799
485128             AFTER ADVANCING 1 LINE                               48512899
485129         end-if                                                   48512999
485500                                                                  48550099
485600*    WRITE THE RFID ERRORS                                        48560099
485610                                                                  48561099
485700         PERFORM VARYING PV-ERROR-IDX FROM 1 BY 1                 48570099
485800         UNTIL PA-RFID-ERROR (PV-ERROR-IDX) = SPACES              48580099
485900            OR PV-ERROR-IDX > 25                                  48590099
486000             MOVE PV-ERROR-IDX TO PV-ERROR-IDX-COUNT              48600099
486100             MOVE PA-RFID-ERROR-DESC (PV-ERROR-IDX)               48610099
486200                                      TO FD-FOOTER-DETAIL-DESC    48620099
486300             MOVE PA-RFID-ERROR-QTY (PV-ERROR-IDX)                48630099
486400                                      TO FD-FOOTER-DETAIL-QTY     48640099
486500             ADD  PA-RFID-ERROR-QTY (PV-ERROR-IDX)                48650099
486600                                      TO PV-TOTAL-ERROR-QTY       48660099
486901                                                                  48690199
486902             IF  CC-FLAT-FILE                                     48690299
486903                 MOVE SPACES  TO VA-VND-AUDIT-DETAIL-LINE-FLAT    48690399
486910                 WRITE VA-VND-AUDIT-DETAIL-LINE-FLAT              48691099
486920                  FROM FD-FOOTER-DETAIL-LINE                      48692099
486921             else                                                 48692199
486922                 WRITE VA-VND-AUDIT-DETAIL-LINE                   48692299
486923                  FROM FD-FOOTER-DETAIL-LINE                      48692399
486924                 AFTER ADVANCING 1 LINE                           48692499
486925                                                                  48692599
486926                 WRITE VA-VND-AUDIT-DETAIL-LINE-LOG               48692699
486927                  FROM FD-FOOTER-DETAIL-LINE                      48692799
486928                 AFTER ADVANCING 1 LINE                           48692899
486929             end-if                                               48692999
486930                                                                  48693099
487300         END-PERFORM                                              48730099
487400     END-IF.                                                      48740099
487600                                                                  48760099
487700*    WRITE THE TOTAL ERROR SUMMARY FOOTER LINE                    48770099
487710                                                                  48771099
487800     MOVE 'TOTAL ERRORS    '          TO FD-FOOTER-DETAIL-DESC    48780099
487900     DISPLAY 'PV-TOTAL-ERROR-QTY: ' PV-TOTAL-ERROR-QTY            48790099
488000     MOVE PV-TOTAL-ERROR-QTY          TO FD-FOOTER-DETAIL-QTY     48800099
488301                                                                  48830199
488302     IF  CC-FLAT-FILE                                             48830299
488312         MOVE SPACES  TO VA-VND-AUDIT-DETAIL-LINE-FLAT            48831299
488313         WRITE VA-VND-AUDIT-DETAIL-LINE-FLAT                      48831399
488320          FROM FD-FOOTER-DETAIL-LINE                              48832099
488331     else                                                         48833199
488332         WRITE VA-VND-AUDIT-DETAIL-LINE                           48833299
488333          FROM FD-FOOTER-DETAIL-LINE                              48833399
488334          AFTER ADVANCING 2 LINES                                 48833499
488335                                                                  48833599
488336         WRITE VA-VND-AUDIT-DETAIL-LINE-LOG                       48833699
488337          FROM FD-FOOTER-DETAIL-LINE                              48833799
488338         AFTER ADVANCING 2 LINES                                  48833899
488339     end-if.                                                      48833999
488700                                                                  48870099
488800                                                                  48880099
488900******************************************************************48890099
489000* 8500-PRINT-RCVR-MSG                                             48900099
489100******************************************************************48910099
489200 8500-PRINT-RCVR-MSG.                                             48920099
489300                                                                  48930099
489400     IF PV-DETAIL-LINE-COUNT + 3 > PC-MAX-REPORT-LINES            48940099
489500         PERFORM 3000-PRINT-PAGE-HEADING                          48950099
489600     END-IF.                                                      48960099
489700                                                                  48970099
490002     IF  CC-FLAT-FILE                                             49000299
490003         MOVE SPACES  TO VA-VND-AUDIT-DETAIL-LINE-FLAT            49000399
490010         WRITE VA-VND-AUDIT-DETAIL-LINE-FLAT                      49001099
490020          FROM RM-RECEIVER-MESSAGE-LINE-2                         49002099
490030     else                                                         49003099
490031         WRITE VA-VND-AUDIT-DETAIL-LINE                           49003199
490032          FROM RM-RECEIVER-MESSAGE-LINE-2                         49003299
490033         AFTER ADVANCING 1 LINE                                   49003399
490034                                                                  49003499
490035         WRITE VA-VND-AUDIT-DETAIL-LINE-LOG                       49003599
490036          FROM RM-RECEIVER-MESSAGE-LINE-2                         49003699
490037         AFTER ADVANCING 1 LINE                                   49003799
490038     end-if.                                                      49003899
490400                                                                  49040099
490702      IF  CC-FLAT-FILE                                            49070299
490710         WRITE VA-VND-AUDIT-DETAIL-LINE                           49071099
490720          FROM RM-RECEIVER-MESSAGE-LINE-1                         49072099
490721      else                                                        49072199
490722         WRITE VA-VND-AUDIT-DETAIL-LINE                           49072299
490723          FROM RM-RECEIVER-MESSAGE-LINE-1                         49072399
490724         AFTER ADVANCING 1 LINE                                   49072499
490725                                                                  49072599
490726         WRITE VA-VND-AUDIT-DETAIL-LINE-LOG                       49072699
490727          FROM RM-RECEIVER-MESSAGE-LINE-1                         49072799
490728         AFTER ADVANCING 1 LINE                                   49072899
490729      end-if.                                                     49072999
491100                                                                  49110099
491402     IF  CC-FLAT-FILE                                             49140299
491403         MOVE SPACES  TO VA-VND-AUDIT-DETAIL-LINE-FLAT            49140399
491410         WRITE VA-VND-AUDIT-DETAIL-LINE-FLAT                      49141099
491420          FROM RM-RECEIVER-MESSAGE-LINE-2                         49142099
491421     else                                                         49142199
491422         WRITE VA-VND-AUDIT-DETAIL-LINE                           49142299
491423          FROM RM-RECEIVER-MESSAGE-LINE-2                         49142399
491424         AFTER ADVANCING 1 LINE                                   49142499
491425                                                                  49142599
491426         WRITE VA-VND-AUDIT-DETAIL-LINE-LOG                       49142699
491427          FROM RM-RECEIVER-MESSAGE-LINE-2                         49142799
491428         AFTER ADVANCING 1 LINE                                   49142899
491429     end-if.                                                      49142999
491800                                                                  49180099
491900     ADD +3 TO PV-DETAIL-LINE-COUNT.                              49190099
492000                                                                  49200099
492100     MOVE 1 TO RETURN-CODE.                                       49210099
492200                                                                  49220099
492300                                                                  49230099
492400******************************************************************49240099
492500* 9000-EOJ-ROUTINE - PRINTS A GRAND TOTAL, AND CLOSES THE DRIVER  49250099
492600* CURSOR AND THE REPORT FILE.                                     49260099
492700******************************************************************49270099
492800 9000-EOJ-ROUTINE.                                                49280099
492900                                                                  49290099
493000     IF PS-DATA                                                   49300099
493100         PERFORM 8100-END-OF-RECEIVER-LOGIC                       49310099
493200                                                                  49320099
493502         IF  CC-FLAT-FILE                                         49350299
493510             move spaces to VA-VND-AUDIT-DETAIL-LINE-FLAT         49351099
493511             WRITE VA-VND-AUDIT-DETAIL-LINE-FLAT                  49351199
493520              FROM END-OF-REPORT-LINE                             49352099
493521             MOVE 4051 TO RETURN-CODE                             49352199
493522          else                                                    49352299
493523             WRITE VA-VND-AUDIT-DETAIL-LINE                       49352399
493524              FROM END-OF-REPORT-LINE                             49352499
493525             AFTER ADVANCING 1 LINES                              49352599
493526                                                                  49352699
493527             WRITE VA-VND-AUDIT-DETAIL-LINE-LOG                   49352799
493528              FROM END-OF-REPORT-LINE                             49352899
493529             AFTER ADVANCING 1 LINES                              49352999
493530          end-if                                                  49353099
493900                                                                  49390099
494000*        IF THIS IS A PRINTEK PRINTER, CUT THE PAPER              49400099
494100                                                                  49410099
494200         IF CC-PRTR-CUT-IND = 'Y'                                 49420099
494300             WRITE VA-VND-AUDIT-DETAIL-LINE                       49430099
494400              FROM DS004-PLC-CUT-FORM                             49440099
494500             AFTER ADVANCING 1 LINE                               49450099
494600         END-IF                                                   49460099
494700     END-IF.                                                      49470099
494800                                                                  49480099
494801     DISPLAY ' '.                                                 49480199
494810     DISPLAY 'SUKRP011 - END  '.                                  49481099
494820     DISPLAY ' '.                                                 49482099
494830                                                                  49483099
494900     CLOSE       OS-VENDOR-OVER-SHORT-FILE                        49490099
495000                 OS-RECEIVER-TOTAL-ERROR-FILE                     49500099
495100                 TE-VENDOR-TOTAL-ERROR-FILE                       49510099
495200                 OS-SKUTOT-OVER-SHORT-FILE.                       49520099
495300                                                                  49530099
495400******************************************************************49540099
495500* 9100-FIELD-OVERFLOW-ERROR - IF ON OF THE ACCUMULATOR FIELDS    *49550099
495600* ROLLS OVER (IE THE NUMBER IS TOO BIG TO FIT) THIS PARAGRAPH    *49560099
495700* WILL ABEND THE PROGRAM                                         *49570099
495800******************************************************************49580099
495900 9100-FIELD-OVERFLOW-ERROR.                                       49590099
496000                                                                  49600099
496100     DISPLAY '** ABEND     **'.                                   49610099
496200     DISPLAY '** PROGRAM   ** = SUKRP011'.                        49620099
496300     DISPLAY '** PROGRAM ACCUMULATOR OVERFLOW ERROR **'.          49630099
496400     DISPLAY '** THE DATA CREATES A TOTALS VALUE LARGER THAN '.   49640099
496500     DISPLAY '** THE FIELD SET-UP TO HANDLE IT.  INCREASE THE'.   49650099
496600     DISPLAY '** THE FOLLOWING FIELD WAS TOO SMALL: '.            49660099
496700     DISPLAY PV-FIELD-NAME.                                       49670099
496800                                                                  49680099
496900     MOVE +4004 TO ABEND-CODE.                                    49690099
497000     CALL 'ILBOABN0' USING ABEND-CODE.                            49700099
497100                                                                  49710099
497200******************************************************************49720099
497300* 9999-SQL-ABEND - PERFORMS THE ABEND FOR THE PROGRAM IN THE *    49730099
497400* EVENT THAT AN SQL ERROR OR WARNING CODE OCCURS. *               49740099
497500******************************************************************49750099
497510 9999-SQL-ABEND.                                                  49751099
497600                                                                  49760099
497900     IF SQLCODE                  = -904 OR -911 OR -913           49790099
498000        MOVE +4050               TO RETURN-CODE                   49800099
498100        STOP RUN                                                  49810099
498200     ELSE                                                         49820099
498300        PERFORM 9998-ABEND-PROGRAM                                49830099
498400     END-IF.                                                      49840099
498600                                                                  49860099
498700                                                                  49870099
498800******************************************************************49880099
498900 9998-ABEND-PROGRAM.                                              49890099
499000     DISPLAY '** PROGRAM    ** = SUKRP011'.                       49900099
499100     DISPLAY '** PARAGRAPH  ** = ' PV-PARAGRAPH-NAME.             49910099
499200     DISPLAY '** OPERATION  ** = ' PV-DB2-OPERATION-ATTEMPTED.    49920099
499300                                                                  49930099
499400******************************************************************49940099
499500* THIS COPY BOOK MEMBER CONTAINS THE PROCEDURE DIVISION STATE-   *49950099
499600* MENTS THAT ARE REQUIRED TO UTILIZE THE DB2 ABEND MODULE        *49960099
499700* 'DSNTIAR' AND CONVERT THE SQLCA INFORMATION INTO A READABLE    *49970099
499800* FORMAT.                                                        *49980099
499900******************************************************************49990099
500000     COPY DPPD004.                                                50000099
500100                                                                  50010099
500200     MOVE +4013 TO ABEND-CODE.                                    50020099
500300     CALL 'ILBOABN0' USING ABEND-CODE.                            50030099
