000100*-----------------------*                                         00010099
000200 IDENTIFICATION DIVISION.                                         00020026
000300*-----------------------*                                         00030026
000400 PROGRAM-ID.    SUKCS551.                                         00040026
000500 AUTHOR.        LYNN MCADAMS.                                     00050026
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060026
000700 DATE-WRITTEN.  FEBRUARY, 2000.                                   00070026
000800 DATE-COMPILED.                                                   00080026
000900                                                                  00090026
001000*---------------------------------------------------------------* 00100026
001100*    S551 - TRAILER LIST PROGRAM.                               * 00110026
001200*                                                               * 00120026
001300*    THIS PROGRAM CREATES A SCREEN THAT WILL LIST ALL TRAILERS  * 00130099
001400*    FOR A GIVEN DC THAT ARE IN THE STATUS THAT WAS SUPPLIED    * 00140099
001500*    ON THE CRIT SPEC.  UP TO FIVE STATUS CODES CAN BE          * 00150099
001600*    SELECTED TO REPORT ON.  THIS SCREEN IS ACCESSED FROM THE   * 00160099
001700*    CRIT SPEC (F17).                                           * 00170099
001800*----------------------------------------------------------------*00180099
001810*    CHANGES                                                     *00181099
001820*    MADE BY: CHERI PARMLEY                                      *00182099
001830*    DATE:    09/24/2014                                         *00183099
001840*                                                                *00184099
001850*    CHANGES THRU OUT THE PROGRAM TO INCREASE THE SIZE OF PO#    *00185099
001860*    FROM 7 DIGITS TO 8 DIGITS. TAGGED WITH *CLP 09/24/2014      *00186099
001890*----------------------------------------------------------------*00189099
001891*    CHANGES                                                     *00189199
001892*    MADE BY: SHRIRAM(COGNIZANT)                                 *00189299
001893*    DATE:    09/24/2014                                         *00189399
001894*    ADDED A CONDITION IN THE CURSOR TRAILER-CSR AS PER THE      *00189499
001895*    CHANGE PROVIDED BY THE DBA TEAM TO IMPROVE PERFORMANCE      *00189599
001896*    CHG0146873                                                  *00189699
001897*----------------------------------------------------------------*00189799
001898*    CHANGES                                                     *00189899
001899*    MADE BY: SRINATH(COGNIZANT)                                 *00189999
001900*    DATE:    03/23/2017                                         *00190099
001901*    SQL IN PARA 4340-SELECT-EXP-SCAN-CNT WAS NOT RETURNING      *00190199
001902*    ACCURATE COUNT. CHANGES TAGGED WITH 'IN4007'. CHG0165056    *00190299
001903*----------------------------------------------------------------*00190399
263968* CHANGED 11/15/2021    BY JIM HUNTER      WR: CHG0263968         00190599
263968* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00190699
263968* MAKING THE CALL DYNAMIC VS STATIC.                              00190799
001130*                                                                 00190899
001110* CHANGED 01/09/2023    BY JEAN KURK       WR: CHG0278099         00190999
001120* CHANGE CALL OF DPKCS030 TO BE DYNAMIC                           00191099
263968*---------------------------------------------------------------* 00191199
001910*                                                                 00192099
002000 ENVIRONMENT DIVISION.                                            00200026
002100                                                                  00210026
002200 DATA DIVISION.                                                   00220026
002300                                                                  00230026
002400 WORKING-STORAGE SECTION.                                         00240026
002500                                                                  00250026
002600 01  DK-DB2-KEYS.                                                 00260026
002700     05  DK-OPER-UNT-ID                 PIC S9(04) COMP VALUE +0. 00270026
002800     05  DK-FCLTY-ID                    PIC S9(04) COMP VALUE +0. 00280055
002900     05  DK-SCAC-ID                     PIC  X(04).               00290099
003000     05  DK-VEH-NBR                     PIC  X(10).               00300099
003100     05  DK-TRIP-ID                     PIC S9(09) COMP VALUE +0. 00310099
003200     05  DK-PO-NBR                      PIC S9(09) COMP VALUE +0. 00320099
003300     05  DK-REC-SEQ-NBR                 PIC S9(09) COMP VALUE +0. 00330099
003400                                                                  00340026
003500 01  PC-PROGRAM-CONSTANTS.                                        00350026
003600     05  PC-CURRENT-MAP-NAME            PIC  X(08)  VALUE         00360026
003700                                                    'SUK551  '.   00370026
003800     05  PC-CURRENT-MAPSET-NAME         PIC  X(08)  VALUE         00380026
003900                                                    'SUKM551 '.   00390026
004000     05  PC-CURRENT-PROGRAM-NAME        PIC  X(08)  VALUE         00400026
004100                                                    'SUKCS551'.   00410026
004200     05  PC-LIST-QUEUE-SEQ              PIC  9(01)  VALUE 1.      00420026
004300     05  PC-SEL-QUEUE-SEQ               PIC  9(01)  VALUE 2.      00430026
004400     05  PC-CRIT-SPEC-FORMAT            PIC  X(01)  VALUE '1'.    00440026
004500     05  PC-LIST-FORMAT                 PIC  X(01)  VALUE '2'.    00450060
004600     05  PC-ITEMS-PER-PANEL             PIC S9(04)  VALUE +10     00460099
004700                                                    COMP SYNC.    00470026
004800     05  PC-MAX-ITEMS                   PIC S9(09) VALUE +1000000 00480083
004900                                                    COMP-3.       00490083
005000     05  PC-MAX-BLOCKS-IN-ARRAY         PIC S9(04)  VALUE +2      00500026
005100                                                    COMP SYNC.    00510026
005200     05  PC-MSG-NUMBER-LENGTH           PIC S9(04)  VALUE +5      00520083
005300                                                    COMP SYNC.    00530026
005400     05  PC-MAX-RETRIES                 PIC S9(03)  VALUE 3       00540083
005500                                                    COMP-3.       00550083
005600     05  PC-INQ                         PIC  X(03)  VALUE 'INQ'.  00560026
005700     05  PC-UPD                         PIC  X(03)  VALUE 'UPD'.  00570026
005800     05  PC-DEL                         PIC  X(03)  VALUE 'DEL'.  00580026
005900     05  PC-ERR                         PIC  X(03)  VALUE 'ERR'.  00590026
006000     05  PC-NEW                         PIC  X(02)  VALUE 'NW'.   00600060
006100     05  PC-SLASH                       PIC  X(01)  VALUE '/'.    00610099
006200     05  PC-COLON                       PIC  X(01)  VALUE ':'.    00620099
006300     05  PC-ZERO                        PIC  S9(04) VALUE ZERO    00630060
006400                                                    COMP.         00640060
006500     05  PC-01                     PIC  X(02)  VALUE '01'.        00650060
006600     05  PC-A                      PIC  X(01)  VALUE 'A'.         00660099
006700*                                                                 00670099
006800*                                                                 00680099
006900*----------------------------------------------------------------*00690060
007000*  DESCRIPTION CONSTANTS                                         *00700060
007100*----------------------------------------------------------------*00710060
007200*                                                                 00720060
007300*----------------------------------------------------------------*00730060
007400*  SYSTEM MESSAGES                                               *00740060
007500*----------------------------------------------------------------*00750060
007600*   00005 = INVALID VALUE                                        *00760060
007700*   00007 = REQUIRED ENTRY                                       *00770099
007800*   00008 = MUST BE NUMERIC                                      *00780060
007900*   00050 - NO LIST ITEMS WERE FOUND FOR THE CRITERIA SPECIFIED  *00790060
008000*   00051 - NO END OF RANGE HAS BEEN SPECIFIED                   *00800060
008100*   00052 - END OF RANGE PRECEDES START OF RANGE                 *00810060
008200*   00053 - NO START OF RANGE HAS BEEN SPECIFIED                 *00820060
008300*   00054 - ONLY ONE START OF RANGE INDICATOR MAY BE SPECIFIED   *00830060
008400*   00055 - ONLY ONE END OF RANGE INDICATOR MAY BE SPECIFIED     *00840060
008500*   00057 - A LIST ITEM MUST BE SELECTED FOR THIS FUNCTION       *00850060
008600*   00069 - TOP OF LIST                                          *00860060
008700*   00070 - BOTTOM OF LIST                                       *00870060
008800*   00101 - VALUE MUST BE > ZERO AND  < 1,000,000                *00880060
008900*   00551 - WAIT 15 SECONDS;RETRY FUNCTION AGAIN; IF UNSUCCESSFUL*00890060
009000*   00279 - MORE ITEMS TO DISPLAY                                *00900060
009100*   00984 - DATABASE IS BUSY, TRY AGAIN IN A FEW MINUTES         *00910060
009200*   02227 = APPLICATION UNAVAILABLE AT THIS TIME                 *00920060
009300*   02234 = PRINT REQUEST HAS BEEN COMPLETED FOR SELECTED LIME(S)*00930060
009400*   02238 = PRINT PROBLEM, TRY AGAIN - LINES UP TO THIS POINT    *00940060
009500*   02245 = CANNOT UPDATE ACTUAL UNITS - PULL LINE ITEM HAS BEEN *00950060
009600*   02252 = UPDATE REQUEST HAS BEEN COMPLETED FOR SELECTED LINE(S*00960060
009700*   02307 - YOU DO NOT HAVE AUTHORITY TO CANCEL/UNCANCEL          00970099
009800*   02308 - YOU DO NOT HAVE AUTHORITY TO CONFIRM/UNCONFIRM DISTRIB00980099
009900*   99901 = INVALID COMMAND WAS ENTERED                          *00990060
010000*----------------------------------------------------------------*01000060
010100     05  PC-TSYMSG-NUMBERS.                                       01010026
010200         10  PC-TSYMSG-00005            PIC  9(05)  VALUE 00005.  01020026
010300         10  PC-TSYMSG-00007            PIC  9(05)  VALUE 00007.  01030099
010400         10  PC-TSYMSG-00008            PIC  9(05)  VALUE 00008.  01040026
010500         10  PC-TSYMSG-00050            PIC  9(05)  VALUE 00050.  01050026
010600         10  PC-TSYMSG-00051            PIC  9(05)  VALUE 00051.  01060026
010700         10  PC-TSYMSG-00052            PIC  9(05)  VALUE 00052.  01070026
010800         10  PC-TSYMSG-00053            PIC  9(05)  VALUE 00053.  01080026
010900         10  PC-TSYMSG-00054            PIC  9(05)  VALUE 00054.  01090026
011000         10  PC-TSYMSG-00055            PIC  9(05)  VALUE 00055.  01100026
011100         10  PC-TSYMSG-00057            PIC  9(05)  VALUE 00057.  01110026
011200         10  PC-TSYMSG-00069            PIC  9(05)  VALUE 00069.  01120026
011300         10  PC-TSYMSG-00070            PIC  9(05)  VALUE 00070.  01130026
011400         10  PC-TSYMSG-00101            PIC  9(05)  VALUE 00101.  01140026
011500         10  PC-TSYMSG-00279            PIC  9(05)  VALUE 00279.  01150026
011600         10  PC-TSYMSG-00551            PIC  9(05)  VALUE 00551.  01160060
011700         10  PC-TSYMSG-00743            PIC  9(05)  VALUE 00743.  01170099
011800         10  PC-TSYMSG-00746            PIC  9(05)  VALUE 00746.  01180060
011900         10  PC-TSYMSG-01563            PIC  9(05)  VALUE 01563.  01190060
012000         10  PC-TSYMSG-00984            PIC  9(05)  VALUE 00984.  01200060
012100         10  PC-TSYMSG-02227            PIC  9(05)  VALUE 02227.  01210060
012200         10  PC-TSYMSG-02234            PIC  9(05)  VALUE 02234.  01220060
012300         10  PC-TSYMSG-02238            PIC  9(05)  VALUE 02238.  01230060
012400         10  PC-TSYMSG-02245            PIC  9(05)  VALUE 02245.  01240060
012500         10  PC-TSYMSG-02252            PIC  9(05)  VALUE 02252.  01250060
012600         10  PC-TSYMSG-02307            PIC  9(05)  VALUE 02307.  01260099
012700         10  PC-TSYMSG-02308            PIC  9(05)  VALUE 02308.  01270099
012800         10  PC-TSYMSG-99901            PIC  9(05)  VALUE 99901.  01280060
012900                                                                  01290060
013000 01  PS-PROGRAM-SWITCHES.                                         01300060
013100     05  PS-ERROR-SW                    PIC  X(01)  VALUE 'Y'.    01310060
013200         88  PS-NO-ERROR                            VALUE 'Y'.    01320060
013300         88  PS-ERROR                               VALUE 'N'.    01330060
013400*                                                                 01340099
013500     05  PS-BLOCK-ERROR-SW              PIC  X(01)  VALUE 'Y'.    01350099
013600         88  PS-NO-BLOCK-ERROR                      VALUE 'Y'.    01360099
013700         88  PS-BLOCK-ERROR                         VALUE 'N'.    01370099
013800*                                                                 01380099
013900     05  PS-COMMAREA-SW                 PIC  X(01)  VALUE 'N'.    01390060
014000         88  PS-COMMAREA-VALID                      VALUE 'Y'.    01400060
014100         88  PS-COMMAREA-NOT-VALID                  VALUE 'N'.    01410060
014200*                                                                 01420099
014300     05  PS-EO-TRAILER-CSR-SW           PIC  X(01)  VALUE  'N'.   01430099
014400         88  PS-EO-TRAILER-CSR                      VALUE  'Y'.   01440099
014500         88  PS-NOT-EO-TRAILER-CSR                  VALUE  'N'.   01450099
014600*                                                                 01460099
014700     05  PS-EO-CARTON-CSR-SW            PIC  X(01)  VALUE  'N'.   01470099
014800         88  PS-EO-CARTON-CSR                       VALUE  'Y'.   01480099
014900         88  PS-NOT-EO-CARTON-CSR                   VALUE  'N'.   01490099
015000*                                                                 01500099
015100     05  PS-EO-FREEASTRY-CSR-SW         PIC  X(01)  VALUE  'N'.   01510099
015200         88  PS-EO-FREEASTRY-CSR                    VALUE  'Y'.   01520099
015300         88  PS-NOT-EO-FREEASTRY-CSR                VALUE  'N'.   01530099
015400*                                                                 01540099
015500     05  PS-FREE-ASTRAY-IND             PIC  X(01)  VALUE  'N'.   01550099
015600         88  PS-FREE-ASTRAY-EXISTS                  VALUE  'Y'.   01560099
015700         88  PS-FREE-ASTRAY-NOT-EXISTS              VALUE  'N'.   01570099
015800*                                                                 01580099
015900     05  PS-CARTON-CSR-SW               PIC  X(01)  VALUE  'N'.   01590099
016000         88  PS-CARTON-CSR-FIRST                    VALUE  'Y'.   01600099
016100         88  PS-NOT-CARTON-CSR-FIRST                VALUE  'N'.   01610099
016200*                                                                 01620099
016300     05  PS-EO-PO-LNE-CSR-SW            PIC  X(01)  VALUE  'N'.   01630099
016400         88  PS-EO-PO-LNE-CSR                       VALUE  'Y'.   01640099
016500         88  PS-NOT-EO-PO-LNE-CSR                   VALUE  'N'.   01650099
016600*                                                                 01660099
016700 01  DN-DB2-NULL-INDICATORS.                                      01670099
016800     05  DN-VEH-NBR                   PIC S9(04) COMP VALUE +0.   01680099
016900*                                                                 01690099
017000 01  PV-PROGRAM-VARIABLES.                                        01700099
017010     05  PV-CICS-MSG-AREA-3             PIC  X(100) VALUE SPACE.  01701099
017020                                                                  01702099
017100     05  PV-CICS-RESPONSE               PIC S9(08)  VALUE ZEROS   01710099
017200                                        COMP SYNC.                01720099
017300     05  PV-SUB                         PIC S9(04)  VALUE +0      01730099
017400                                                    COMP SYNC.    01740099
017500     05  PV-REMAINDER                   PIC S9(04)  VALUE +0      01750099
017600                                                    COMP SYNC.    01760099
017700     05  PV-READ-COUNT                  PIC S9(09)  VALUE +0      01770099
017800                                                    COMP-3.       01780099
017900     05  PV-ORIGINAL-BLOCK              PIC S9(04)  VALUE +0      01790099
018000                                                    COMP SYNC.    01800099
018100     05  PV-ITEMS-HOLD                  PIC S9(03)  COMP-3.       01810099
018200     05  PV-ITEMS-DIFF                  PIC S9(03)  COMP-3.       01820099
018300     05  PV-ITEMS-PROCESSED             PIC S9(09)  VALUE +0      01830099
018400                                                    COMP-3.       01840099
018500     05  PV-HOLD-SELECTED-ITEMS         PIC S9(09)  VALUE +0      01850099
018600                                                    COMP-3.       01860099
018700     05  PV-ITEM-IN-USE                 PIC S9(09)  VALUE +0      01870099
018800                                                    COMP-3.       01880099
018900     05  PV-TOP-ITEM                    PIC S9(09)  VALUE +0      01890099
019000                                                    COMP-3.       01900099
019100     05  PV-BOTTOM-ITEM                 PIC S9(09)  VALUE +0      01910099
019200                                                    COMP-3.       01920099
019300     05  PV-TEMP-BLOCK-NUMBER           PIC S9(09)  VALUE +0      01930099
019400                                                    COMP-3.       01940099
019500     05  PV-BLOCK-NUMBER                PIC S9(04)  VALUE +0      01950099
019600                                                    COMP SYNC.    01960099
019700     05  PV-CICS-RESP                   PIC S9(04)  VALUE +0      01970099
019800                                                    COMP SYNC.    01980099
019900     05  PV-ITEM                        PIC S9(04)  VALUE +0      01990099
020000                                                    COMP SYNC.    02000099
020100     05  PV-SEL-QUEUE-ITEM              PIC S9(04)  VALUE +0      02010099
020200                                                    COMP SYNC.    02020099
020300     05  PV-SAVE-ITEM                   PIC S9(04)  VALUE +0      02030099
020400                                                    COMP SYNC.    02040099
020500     05  PV-HIGHEST-BLOCK-WRITTEN       PIC S9(04)  VALUE +0      02050099
020600                                                    COMP SYNC.    02060099
020700     05  PV-LIST-ITEM-NUMBER            PIC S9(04)  VALUE +0      02070099
020800                                                    COMP SYNC.    02080099
020900     05  PV-FIRST-BLOCK-IN-ARRAY        PIC S9(04)  VALUE +0      02090099
021000                                                    COMP SYNC.    02100099
021100     05  PV-NEXT-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      02110099
021200                                                    COMP SYNC.    02120099
021300     05  PV-PREV-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      02130099
021400                                                    COMP SYNC.    02140099
021500     05  PV-FIRST-BLOCK-IN-RANGE        PIC S9(04)  VALUE +0      02150099
021600                                                    COMP SYNC.    02160099
021700     05  PV-LAST-BLOCK-IN-RANGE         PIC S9(04)  VALUE +0      02170099
021800                                                    COMP SYNC.    02180099
021900     05  PV-START-OF-SELECTED-RANGE     PIC S9(04)  VALUE +0      02190099
022000                                                    COMP SYNC.    02200099
022100     05  PV-END-OF-SELECTED-RANGE       PIC S9(04)  VALUE +0      02210099
022200                                                    COMP SYNC.    02220099
022300     05  PV-RETRY-COUNTER               PIC S9(04)  VALUE +0      02230099
022400                                                    COMP SYNC.    02240099
022500     05  PV-SOFT-ABORT-MSG.                                       02250099
022600         10  FILLER            PIC X(12) VALUE ' SUKCS551 - '.    02260099
022700         10  FILLER            PIC X(09) VALUE 'SQLCODE: '.       02270099
022800         10  PV-SOFT-SQLCODE   PIC ZZZZZZZZ9-.                    02280099
022900         10  FILLER            PIC X(12) VALUE ' PARAGRAPH: '.    02290099
023000         10  PV-SOFT-PARAGRAPH PIC X(30).                         02300099
023100     05  PV-COMMAREA-LENGTH              PIC S9(04)  VALUE +0     02310099
023200                                                     COMP SYNC.   02320099
023300     05  PV-CICS-MSG-AREA                PIC  X(80)  VALUE SPACE. 02330099
023400     05  PV-CICS-MSG-AREA2               PIC  X(100) VALUE SPACE. 02340099
023500     05  PV-CICS-MSG-HOLD.                                        02350099
023600         10  FILLER                      PIC  X(01)  VALUE SPACE. 02360099
023700         10  PV-CICS-MSG-DATA            PIC  X(79)  VALUE SPACE. 02370099
023800     05  PV-CICS-MSG-HOLD2.                                       02380099
023900         10  FILLER                      PIC  X(01)  VALUE SPACE. 02390099
024000         10  PV-CICS-MSG-DATA2           PIC  X(99)  VALUE SPACE. 02400099
024100*                                                                 02410099
024200     05  PV-TMST                        PIC X(26)   VALUE SPACES. 02420099
024300     05  PV-TMST-R REDEFINES  PV-TMST.                            02430099
024400         10   PV-TMST-CC                PIC X(02).                02440099
024500         10   PV-TMST-YY                PIC X(02).                02450099
024600         10   FILLER                    PIC X(01).                02460099
024700         10   PV-TMST-MM                PIC X(02).                02470099
024800         10   FILLER                    PIC X(01).                02480099
024900         10   PV-TMST-DD                PIC X(02).                02490099
025000         10   FILLER                    PIC X(01).                02500099
025100         10   PV-TMST-HRS               PIC X(02).                02510099
025200         10   FILLER                    PIC X(01).                02520099
025300         10   PV-TMST-MIN               PIC X(02).                02530099
025400         10   FILLER                    PIC X(01).                02540099
025500         10   PV-TMST-SEC               PIC X(02).                02550099
025600         10   FILLER                    PIC X(07).                02560099
025700     05  PV-DATE-TIME                   PIC X(26)   VALUE SPACES. 02570099
025800     05  PV-DATE-TIME-DISPLAY REDEFINES PV-DATE-TIME.             02580099
025900         10   PV-DISPLAY-MM             PIC X(02).                02590099
026000         10   PV-SLASH-1                PIC X(01).                02600099
026100         10   PV-DISPLAY-DD             PIC X(02).                02610099
026200         10   PV-SLASH-2                PIC X(01).                02620099
026300         10   PV-DISPLAY-YY             PIC X(02).                02630099
026400         10   PV-SPACE                  PIC X(01).                02640099
026500         10   PV-DISPLAY-HRS            PIC X(02).                02650099
026600         10   PV-COLON                  PIC X(01).                02660099
026700         10   PV-DISPLAY-MIN            PIC X(02).                02670099
026800         10   FILLER                    PIC X(12).                02680099
026900*                                                                 02690099
027000     05  PV-PO-LABEL        PIC X(20)                             02700099
027100          VALUE 'PO/RCVR INQUIRED ON:'.                           02710099
027200     05  PV-PO-RECEIVER.                                          02720099
027210*CLP 09/24/2014                                                   02721099
027300         10  PV-PO-NBR      PIC 9(08).                            02730099
027400         10  FILLER         PIC X(01)  VALUE '-'.                 02740099
027500         10  PV-RECEIVER    PIC 9(03).                            02750099
027600     05  PV-OPER-UNT-ID                  PIC  S9(04) COMP.        02760099
027700     05  PV-FCLTY-ID                     PIC  S9(04) COMP.        02770099
027800     05  PV-SCAC-CDE                     PIC  X(04).              02780099
027900     05  PV-VEH-NBR                      PIC  X(10).              02790099
028000     05  PV-TRIP-ID                      PIC  S9(09) COMP.        02800099
028100     05  PV-DISPLAY-TRIP-ID              PIC  S9(09) VALUE ZEROS. 02810099
028200     05  PV-DISPLAY-PO-NBR               PIC  S9(09) VALUE ZEROS. 02820099
028300     05  PV-ORD-NBR                      PIC  S9(09) COMP.        02830099
028400     05  PV-DISPLAY-ORD-NBR              PIC  S9(09) VALUE ZEROS. 02840099
028500     05  PV-REC-SEQ-NBR                  PIC  S9(09) COMP.        02850099
028600     05  PV-DISPLAY-REC-SEQ-NBR          PIC  S9(09) VALUE ZEROS. 02860099
028700     05  PV-SHIPT-UNT-ID                 PIC  S9(18) COMP-3.      02870099
028800     05  PV-DISPLAY-SHIPT-ID             PIC S9(18) VALUE ZEROS.  02880099
028900     05  PV-EXP-CARTON-CNT               PIC S9(05) VALUE ZEROS   02890099
029000                                                    COMP.         02900099
029100     05  PV-ACT-CARTON-CNT               PIC S9(05) VALUE ZEROS   02910099
029200                                                    COMP.         02920099
029300     05  PV-EXP-SCANNED-CNT              PIC S9(05) VALUE ZEROS   02930099
029400                                                    COMP.         02940099
029500     05  PV-DISPLAY-EXPECTED-CNT         PIC S9(05) VALUE ZEROS.  02950099
029600     05  PV-ACT-SCANNED-CNT              PIC S9(05) VALUE ZEROS   02960099
029700                                                    COMP.         02970099
029800     05  PV-PERCENT-SCANNED              PIC  9(03)V99.           02980099
029900     05  PV-PERCENT-EDITED.                                       02990099
030000         10  PV-PERCENT                  PIC  Z(03).99.           03000099
030100         10  FILLER                      PIC  X(01) VALUE '%'.    03010099
030200     05  PV-DIVIDEND                     PIC  9(03)V9999.         03020099
030300     05  PV-FREE-ASTRAY-CNT              PIC  9(07).              03030099
030400*                                                                 03040099
030500     05  PV-FREE-ASTY-EXISTS             PIC  X(01) VALUE 'Y'.    03050099
030600     05  PV-FREE-ASTY-NOT-EXISTS         PIC  X(01) VALUE 'N'.    03060099
030700     05  PV-TRAILER-UNIT-CNT             PIC  9(10).              03070099
030800     05  PV-VERIFY-ITM-QTY               PIC S9(09) COMP.         03080099
030900     05  PV-AP-VERIFY-ITM-QTY            PIC S9(09) COMP.         03090099
031000*                                                                 03100099
031100     05  PC-TYPE1                        PIC X(02)  VALUE SPACES. 03110099
031200         88   PC-TYPE1-ARRIVED                      VALUE 'AR'.   03120099
031300         88   PC-TYPE1-SPACES                       VALUE SPACES. 03130099
031700*                                                                 03170099
031800     05  PC-TYPE2                        PIC X(02)  VALUE SPACES. 03180099
031900         88   PC-TYPE2-BEG-UNLOAD                   VALUE 'UG'.   03190099
032000         88   PC-TYPE2-SPACES                       VALUE SPACES. 03200099
032100*                                                                 03210099
032400     05  PC-TYPE3                        PIC X(02)  VALUE SPACES. 03240099
032500         88   PC-TYPE3-UNLOADED                     VALUE 'UN'.   03250099
032600         88   PC-TYPE3-SPACES                       VALUE SPACES. 03260099
033000*                                                                 03300099
033100     05  PC-TYPE4                        PIC X(02)  VALUE SPACES. 03310099
033200         88   PC-TYPE4-ENROUTE                      VALUE 'EN'.   03320099
033300         88   PC-TYPE4-SPACES                       VALUE SPACES. 03330099
033700*                                                                 03370099
033800     05  PC-TYPE5                        PIC X(02)  VALUE SPACES. 03380099
033900         88   PC-TYPE5-DEPARTED                     VALUE 'DP'.   03390099
034000         88   PC-TYPE5-SPACES                       VALUE SPACES. 03400099
034400*                                                                 03440099
034500     05  PV-SEL-TERM-ID                  PIC  X(04).              03450099
034600     05  PV-SEL-TASK-NUMBER              PIC  9(05).              03460099
034700     05  PV-SEL-SEQ                      PIC  9(01).              03470099
034800*                                                                 03480099
034900*---------------------------------------------------------------* 03490099
035000*   THIS IS THE LAYOUT FOR THE LIST ITEMS TEMP STORAGE QUEUE.   * 03500099
035100*   THIS MUST BE THE EXACT SAME FORMAT AS BLOCK IN THE          * 03510099
035200*   APPLICATION-SPECIFIC COMMAREA.                              * 03520099
035300*   ALL LQW LEVEL 10'S MUST MATCH ASC LEVEL 30'S.               * 03530099
035400*---------------------------------------------------------------* 03540099
035500 01  LQW-LIST-QUEUE-WORK-AREA.                                    03550099
035600     05  LQW-BLOCK-MODIFIED             PIC  X(01)  VALUE SPACE.  03560099
035700     05  LQW-ITEM-ENTRIES               OCCURS 10 TIMES           03570099
035800                                        INDEXED BY LQW-IDX.       03580099
035900         10  LQW-LIST-ITEM-NUMBER       PIC S9(09)  COMP-3.       03590099
036000         10  LQW-TEMP-SELECTED-SW       PIC  X(01).               03600099
036100         10  LQW-SELECTED-SW            PIC  X(01).               03610099
036200             88  LQW-SELECT                         VALUE 'S'.    03620099
036300             88  LQW-DESELECT                       VALUE ' '.    03630099
036400*                                                                 03640099
036500         10  LQW-ACTION                 PIC  X(03).               03650099
036600         10  LQW-SCAC-CDE               PIC  X(04).               03660099
036700         10  LQW-VEH-NBR                PIC  X(10).               03670099
036800         10  LQW-DATE-TIME              PIC  X(14).               03680099
036900         10  LQW-LINE-STATUS-CDE        PIC  X(02).               03690099
037000             88  LQW-LN-STATUS-AR       VALUE 'AR'.               03700099
037100             88  LQW-LN-STATUS-UG       VALUE 'UG'.               03710099
037200             88  LQW-LN-STATUS-UN       VALUE 'UN'.               03720099
037300             88  LQW-LN-STATUS-EN       VALUE 'EN'.               03730099
037400             88  LQW-LN-STATUS-DP       VALUE 'DP'.               03740099
037500         10  LQW-EXP-CARTON-CNT         PIC  9(05).               03750099
037600         10  LQW-ACT-CARTON-CNT         PIC  9(05).               03760099
037700         10  LQW-LN-TRIP-ID             PIC  9(09).               03770099
037800         10  LQW-EXP-SCANNED-CNT        PIC  9(05).               03780099
037900         10  LQW-ACT-SCANNED-CNT        PIC  9(05).               03790099
038000         10  LQW-PERCENT-SCND           PIC  X(05).               03800099
038100         10  LQW-FREE-ASTRAY            PIC  X(01).               03810099
038200         10  LQW-TOTAL-UNITS            PIC  9(07).               03820099
038300*                                                                 03830099
038400*                                                                 03840099
038500*---------------------------------------------------------------* 03850099
038600*  SELECTION QUEUE LAYOUT                                       * 03860099
038700*---------------------------------------------------------------* 03870099
038800     COPY SUWS004.                                                03880099
038900                                                                  03890099
039000*JPL------------------------------------------------------------* 03900099
039100*  RECORD LAYOUT FOR THE YARD SELECTION TEMP STORAGE QUEUE.     * 03910099
039200*---------------------------------------------------------------* 03920099
039300     COPY TRWS006.                                                03930099
039400                                                                  03940099
039500*---------------------------------------------------------------* 03950099
039600*    MAP LAYOUT                                                 * 03960099
039700*---------------------------------------------------------------* 03970099
039800*                                                                 03980099
039900     COPY SUKM551.                                                03990099
040000*                                                                 04000099
040100*DEFINITIONS MATCH SUKM551 MAPSET                                 04010099
040200 01  MR-OCCURS-LAYOUT                   REDEFINES  SUK551O.       04020099
040210*CLP 09/24/2014                                                   04021099
040300     05  FILLER                         PIC X(211).               04030099
040400     05  MR-SCROLL-AREA                 OCCURS 10 TIMES.          04040099
040500         10  MR-SELECTL                 PIC S9(04) COMP.          04050099
040600         10  MR-SELECTA                 PIC  X(01).               04060099
040700         10  MR-SELECTC                 PIC  X(01).               04070099
040800         10  MR-SELECTH                 PIC  X(01).               04080099
040900         10  MR-SELECTI                 PIC  X(01).               04090099
041000                                                                  04100099
041100         10  MR-ACTIONL                 PIC S9(04) COMP.          04110099
041200         10  MR-ACTIONA                 PIC  X(01).               04120099
041300         10  MR-ACTIONC                 PIC  X(01).               04130099
041400         10  MR-ACTIONH                 PIC  X(01).               04140099
041500         10  MR-ACTION                  PIC  X(03).               04150099
041600                                                                  04160099
041700         10  MR-SCACL                   PIC S9(04) COMP.          04170099
041800         10  MR-SCACA                   PIC  X(01).               04180099
041900         10  MR-SCACC                   PIC  X(01).               04190099
042000         10  MR-SCACH                   PIC  X(01).               04200099
042100         10  MR-SCAC                    PIC  X(04).               04210099
042200                                                                  04220099
042300         10  MR-TRAILERL                PIC S9(04) COMP.          04230099
042400         10  MR-TRAILERA                PIC  X(01).               04240099
042500         10  MR-TRAILERC                PIC  X(01).               04250099
042600         10  MR-TRAILERH                PIC  X(01).               04260099
042700         10  MR-TRAILER                 PIC  X(10).               04270099
042800                                                                  04280099
042900         10  MR-DATE-TIMEL              PIC S9(04) COMP.          04290099
043000         10  MR-DATE-TIMEA              PIC  X(01).               04300099
043100         10  MR-DATE-TIMEC              PIC  X(01).               04310099
043200         10  MR-DATE-TIMEH              PIC  X(01).               04320099
043300         10  MR-DATE-TIME               PIC  X(14).               04330099
043400                                                                  04340099
043500         10  MR-STATUSL                 PIC S9(04) COMP.          04350099
043600         10  MR-STATUSA                 PIC  X(01).               04360099
043700         10  MR-STATUSC                 PIC  X(01).               04370099
043800         10  MR-STATUSH                 PIC  X(01).               04380099
043900         10  MR-STATUS                  PIC  X(02).               04390099
044000                                                                  04400099
044100         10  MR-EXP-CARTON-CNTL         PIC S9(04) COMP.          04410099
044200         10  MR-EXP-CARTON-CNTA         PIC  X(01).               04420099
044300         10  MR-EXP-CARTON-CNTC         PIC  X(01).               04430099
044400         10  MR-EXP-CARTON-CNTH         PIC  X(01).               04440099
044500         10  MR-EXP-CARTON-CNT-X.                                 04450099
044600             15  MR-EXP-CARTON-CNT      PIC ZZZZ9.                04460099
044700                                                                  04470099
044800         10  MR-ACT-CARTON-CNTL         PIC S9(04) COMP.          04480099
044900         10  MR-ACT-CARTON-CNTA         PIC  X(01).               04490099
045000         10  MR-ACT-CARTON-CNTC         PIC  X(01).               04500099
045100         10  MR-ACT-CARTON-CNTH         PIC  X(01).               04510099
045200         10  MR-ACT-CARTON-CNT-X.                                 04520099
045300             15  MR-ACT-CARTON-CNT      PIC ZZZZ9.                04530099
045400                                                                  04540099
045500         10  MR-EXP-SCANNED-CNTL        PIC S9(04) COMP.          04550099
045600         10  MR-EXP-SCANNED-CNTA        PIC  X(01).               04560099
045700         10  MR-EXP-SCANNED-CNTC        PIC  X(01).               04570099
045800         10  MR-EXP-SCANNED-CNTH        PIC  X(01).               04580099
045900         10  MR-EXP-SCANNED-CNT-X.                                04590099
046000             15  MR-EXP-SCANNED-CNT     PIC ZZZZ9.                04600099
046100                                                                  04610099
046200         10  MR-ACT-SCANNED-CNTL        PIC S9(04) COMP.          04620099
046300         10  MR-ACT-SCANNED-CNTA        PIC  X(01).               04630099
046400         10  MR-ACT-SCANNED-CNTC        PIC  X(01).               04640099
046500         10  MR-ACT-SCANNED-CNTH        PIC  X(01).               04650099
046600         10  MR-ACT-SCANNED-CNT-X.                                04660099
046700             15  MR-ACT-SCANNED-CNT     PIC ZZZZ9.                04670099
046800                                                                  04680099
046900         10  MR-PERCENT-SCNDL           PIC S9(04) COMP.          04690099
047000         10  MR-PERCENT-SCNDA           PIC  X(01).               04700099
047100         10  MR-PERCENT-SCNDC           PIC  X(01).               04710099
047200         10  MR-PERCENT-SCNDH           PIC  X(01).               04720099
047300         10  MR-PERCENT-SCND-X.                                   04730099
047400             15  MR-PERCENT-SCND        PIC  X(05).               04740099
047500                                                                  04750099
047600         10  MR-FREE-ASTRAYL            PIC S9(04) COMP.          04760099
047700         10  MR-FREE-ASTRAYA            PIC  X(01).               04770099
047800         10  MR-FREE-ASTRAYC            PIC  X(01).               04780099
047900         10  MR-FREE-ASTRAYH            PIC  X(01).               04790099
048000         10  MR-FREE-ASTRAY-X.                                    04800099
048100             15  MR-FREE-ASTRAY         PIC X.                    04810099
048200                                                                  04820099
048300         10  MR-TOTAL-UNITSL            PIC S9(04) COMP.          04830099
048400         10  MR-TOTAL-UNITSA            PIC  X(01).               04840099
048500         10  MR-TOTAL-UNITSC            PIC  X(01).               04850099
048600         10  MR-TOTAL-UNITSH            PIC  X(01).               04860099
048700         10  MR-TOTAL-UNITS-X.                                    04870099
048800             15  MR-TOTAL-UNITS         PIC ZZZZZZ9.              04880099
048900     05  FILLER                         PIC X(12).                04890099
049000*                                                                 04900099
049100*---------------------------------------------------------------* 04910099
049200*    ATTRIBUTE SETTINGS COPYBOOK.                               * 04920099
049300*---------------------------------------------------------------* 04930099
049400                                                                  04940099
049500     COPY DPWS015.                                                04950099
049600                                                                  04960099
049700*---------------------------------------------------------------* 04970099
049800*    FUNCTION KEYS COPYBOOK.                                    * 04980099
049900*---------------------------------------------------------------* 04990099
050100     COPY DPWS016.                                                05010099
050200                                                                  05020099
050300*----------------------------------------------------------------*05030099
050400**  SECURITY SUBROUTINE PARAMETERS                                05040099
050500*----------------------------------------------------------------*05050099
050700     COPY DPWS008.                                                05070099
050800                                                                  05080099
050900*---------------------------------------------------------------* 05090099
051000*    NUMERIC EDIT LAYOUT.                                       * 05100099
051100*---------------------------------------------------------------* 05110099
051300     COPY DPWS010I.                                               05130099
051400                                                                  05140099
051500*---------------------------------------------------------------* 05150099
051600*    PARAMETERS FOR CALLING CICS ARCHITECTURE API               * 05160099
051700*---------------------------------------------------------------* 05170099
051900     COPY DPWS030.                                                05190099
051900     COPY DPWS930.                                                05191099
052000                                                                  05200099
052100*---------------------------------------------------------------* 05210099
052200*    STANDARD COMMAREA.                                         * 05220099
052300*---------------------------------------------------------------* 05230099
052500     COPY DPWS020.                                                05250099
052600     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                05260099
052700                                                                  05270099
052800*---------------------------------------------------------------* 05280099
052900* INTER-APPLICATION COMMAREA.                                   * 05290099
053000*   SUWS002 - IS THE INPUT LAYOUT WHEN COMING FROM THE CRIT.    * 05300099
053100*             SPEC SCREEN.                                      * 05310099
053200*   SUWS003 - IS THE OUTPUT LAYOUT THAT WILL BE PASSED FROM     * 05320099
053300*             THIS LIST PROGRAMMING FOR A LOCAL-GO FUNCTION.    * 05330099
053400*---------------------------------------------------------------* 05340099
053600         10  INTER-APPL-COMM-AREA       PIC X(200).               05360099
053700     COPY SUWS002.                                                05370099
053800     COPY SUWS003.                                                05380099
053900*JPL                                                              05390099
054000     COPY RCWS015.                                                05400099
054100*---------------------------------------------------------------* 05410099
054200*  THIS IS THE APPLICATION-SPECIFIC COMMAREA.                   * 05420099
054300*  ASC LEVEL 30'S MUST MATCH LQW LEVEL 10'S.                    * 05430099
054400*---------------------------------------------------------------* 05440099
054500         10  ASC-SPECIFIC-COMMAREA.                               05450099
054600             15  ASC-OPER-UNT-ID          PIC S9(04) COMP.        05460099
054700             15  ASC-FCLTY-ID             PIC S9(04) COMP.        05470099
054800             15  ASC-FCLTY-NME            PIC X(25).              05480099
054900             15  ASC-SCAC                 PIC X(04).              05490099
055000             15  ASC-TRLR-NBR             PIC X(10).              05500099
055100             15  ASC-STATUS-AR            PIC X(02).              05510099
055200                 88  ASC-SELECT-ARRIVED           VALUE 'AR'.     05520099
055300             15  ASC-STATUS-UG            PIC X(02).              05530099
055400                 88  ASC-SELECT-UNLOADING         VALUE 'UG'.     05540099
055500             15  ASC-STATUS-UN            PIC X(02).              05550099
055600                 88  ASC-SELECT-UNLOADED          VALUE 'UN'.     05560099
055700             15  ASC-STATUS-EN            PIC X(02).              05570099
055800                 88  ASC-SELECT-ENROUTE           VALUE 'EN'.     05580099
055900             15  ASC-STATUS-DP            PIC X(02).              05590099
056000                 88  ASC-SELECT-DEPARTED          VALUE 'DP'.     05600099
056100             15  ASC-TRIP-ID              PIC S9(09) COMP.        05610099
056200             15  ASC-PO-RECEIVER.                                 05620099
056210*CLP 09/24/2014                                                   05621099
056300                 20  ASC-PO-NBR           PIC 9(08).              05630099
056400                 20  FILLER               PIC X(01).              05640099
056500                 20  ASC-RECEIVER         PIC 9(03).              05650099
056600             15  ASC-SHIPT-UNT-ID         PIC S9(18)V COMP-3.     05660099
056700                                                                  05670099
056800             15  ASC-TOT-EXP-CRT       PIC S9(05) COMP.           05680099
056900             15  ASC-TOT-ACT-CRT       PIC S9(05) COMP.           05690099
057000             15  ASC-TOT-EXP-SCN       PIC S9(05) COMP.           05700099
057100             15  ASC-TOT-ACT-SCN       PIC S9(05) COMP.           05710099
057200             15  ASC-TOT-FRE-AST       PIC 9(04).                 05720099
057300             15  ASC-TOT-UNITS         PIC 9(08).                 05730099
057400*                                                                 05740099
057500             15  ASC-SELECTED-STATUS-CDE     PIC  X(02).          05750099
057600                 88  ASC-SELECT-VALID        VALUE 'AR' 'UG' 'UN' 05760099
057700                                                   'EN' 'DP' ' '. 05770099
057800                 88  ASC-STATUS-ENTERED      VALUE 'AR' 'UG' 'UN' 05780099
057900                                                   'EN' 'DP'.     05790099
058000                 88  ASC-SELECT-ALL               VALUE ' A'.     05800099
058100             15  ASC-BLK-SUB                  PIC S9(04) COMP     05810099
058200                                                         SYNC.    05820099
058300             15  ASC-ITEM-SUB                 PIC S9(04) COMP     05830099
058400                                                         SYNC.    05840099
058500             15  ASC-NUMBER-OF-ITEMS-READ     PIC S9(09) COMP-3.  05850099
058600             15  ASC-NUMBER-OF-SELECTED-ITEMS PIC S9(09) COMP-3.  05860099
058700             15  ASC-ITEMS-DISPLAYED          PIC S9(03) COMP-3.  05870099
058800             15  ASC-ITEM-AT-TOP-OF-PANEL     PIC S9(09) COMP-3.  05880099
058900             15  ASC-ITEM-AT-BOT-OF-PANEL     PIC S9(09) COMP-3.  05890099
059000             15  ASC-HIGHEST-BLOCK-WRITTEN    PIC S9(04) COMP     05900099
059100                                                         SYNC.    05910099
059200             15  ASC-START-OF-SELECTED-RANGE  PIC S9(09) COMP-3.  05920099
059300             15  ASC-END-OF-SELECTED-RANGE    PIC S9(09) COMP-3.  05930099
059400             15  ASC-ITEMS-LEFT-INDICATOR     PIC  X(01).         05940099
059500                 88  ASC-ITEMS-LEFT-ON-DB          VALUE 'Y'.     05950099
059600                 88  ASC-NO-ITEMS-LEFT-ON-DB       VALUE 'N'.     05960099
059700             15  ASC-TEMP-QUEUE-UPDATE-SW     PIC  X(01).         05970099
059800                 88  ASC-UPDATE-TSQ                VALUE 'Y'.     05980099
059900                 88  ASC-NO-TSQ-UPDATE             VALUE ' '.     05990099
060000             15  ASC-LIST-QUEUE-NAME.                             06000099
060100                 20  ASC-LIST-TERM-ID         PIC  X(04).         06010099
060200                 20  ASC-LIST-TASK-NUMBER     PIC S9(05) COMP-3.  06020099
060300                 20  ASC-LIST-SEQ             PIC  9(01).         06030099
060400             15  ASC-SEL-QUEUE-NAME.                              06040099
060500                 20  ASC-SEL-TERM-ID          PIC  X(04).         06050099
060600                 20  ASC-SEL-TASK-NUMBER      PIC S9(05) COMP-3.  06060099
060700                 20  ASC-SEL-SEQ              PIC  9(01).         06070099
060800             15  ASC-SEL-QUEUE-NAME-ORIG.                         06080099
060900                 20  ASC-SEL-TERM-ID-ORIG     PIC  X(04).         06090099
061000                 20  ASC-SEL-TASK-NUMBER-ORIG PIC S9(05) COMP-3.  06100099
061100                 20  ASC-SEL-SEQ-ORIG         PIC  9(01).         06110099
061200             15  ASC-START-ITEM-REQUEST.                          06120099
061300                 20  ASC-START-ITEM-REQUEST-N PIC  9(05).         06130099
061400             15  ASC-CURSOR-SW                PIC  X(02).         06140099
061500                 88  ASC-NO-CURSOR                   VALUE 'Z '.  06150099
061600                 88  ASC-TRAILER-CURSOR              VALUE 'A '.  06160099
061700                 88  ASC-SCAC-TRAILER-CURSOR         VALUE 'B '.  06170099
061800                 88  ASC-SCAC-CURSOR                 VALUE 'C '.  06180099
061900                 88  ASC-TRIP-ID-CURSOR              VALUE 'D '.  06190099
062000                 88  ASC-PO-REC-CURSOR               VALUE 'E '.  06200099
062100                 88  ASC-PO-CURSOR                   VALUE 'F '.  06210099
062200             15  ASC-USE-SELECTION-QUEUE-IND  PIC  X(1).          06220099
062300                 88  ASC-USE-SELECTION-QUEUE           VALUE 'Y'. 06230099
062400             15  ASC-NUMBER-OF-TS-ITEMS       PIC S9(09) COMP-3.  06240099
062500*JPL                                                              06250099
062600             15  ASC-FUNC02-RETURN-FLAG       PIC  X(1).          06260099
062700                 88  ASC-FUNC02-RETURN-NO   VALUE 'N'.            06270099
062800                 88  ASC-FUNC02-RETURN-YES  VALUE 'Y'.            06280099
062900                                                                  06290099
063000             15  ASC-BLOCK-ENTRIES OCCURS 2 TIMES.                06300099
063100                 20  ASC-BLOCK-MODIFIED-SW          PIC X(01).    06310099
063200                     88  ASC-BLOCK-NOT-MODIFIED     VALUE 'N'.    06320099
063300                     88  ASC-BLOCK-MODIFIED         VALUE 'Y'.    06330099
063400                                                                  06340099
063500                 20  ASC-ITEM-ARRAY.                              06350099
063600                     25  ASC-ITEM-ENTRIES OCCURS 10 TIMES.        06360099
063700                         30  ASC-LIST-ITEM-NUMBER                 06370099
063800                                        PIC S9(09)  COMP-3.       06380099
063900                         30  ASC-TEMP-SELECTED-SW PIC X(01).      06390099
064000                             88  ASC-VALID-SELECT   VALUE ' '     06400099
064100                                                          'S'     06410099
064200                                                          'B'     06420099
064300                                                          'E'.    06430099
064400                             88  ASC-TEMP-NO-SELECT VALUE ' '.    06440099
064500                             88  ASC-TEMP-SELECT    VALUE 'S'.    06450099
064600                             88  ASC-TEMP-BEGIN     VALUE 'B'.    06460099
064700                             88  ASC-TEMP-END       VALUE 'E'.    06470099
064800                         30  ASC-SELECTED-SW        PIC X(01).    06480099
064900                             88  ASC-NO-SELECT      VALUE ' '.    06490099
065000                             88  ASC-SELECT         VALUE 'S'.    06500099
065100                             88  ASC-BEGIN          VALUE 'B'.    06510099
065200                             88  ASC-END            VALUE 'E'.    06520099
065300                         30  ASC-ACTION             PIC X(03).    06530099
065400                         30  ASC-SCAC-CDE           PIC X(04).    06540099
065500                         30  ASC-VEH-NBR            PIC X(10).    06550099
065600                         30  ASC-DATE-TIME          PIC X(14).    06560099
065700                         30  ASC-LN-STATUS          PIC X(02).    06570099
065800                             88  ASC-LN-STATUS-AR   VALUE 'AR'.   06580099
065900                             88  ASC-LN-STATUS-UG   VALUE 'UG'.   06590099
066000                             88  ASC-LN-STATUS-UN   VALUE 'UN'.   06600099
066100                             88  ASC-LN-STATUS-EN   VALUE 'EN'.   06610099
066200                             88  ASC-LN-STATUS-DP   VALUE 'DP'.   06620099
066300                         30  ASC-EXP-CARTON-CNT     PIC 9(05).    06630099
066400                         30  ASC-ACT-CARTON-CNT     PIC 9(05).    06640099
066500                         30  ASC-LN-TRIP-ID         PIC 9(09).    06650099
066600                         30  ASC-EXP-SCANNED-CNT    PIC 9(05).    06660099
066700                         30  ASC-ACT-SCANNED-CNT    PIC 9(05).    06670099
066800                         30  ASC-PERCENT-SCND       PIC X(05).    06680099
066900                         30  ASC-FREE-ASTRAY        PIC X(01).    06690099
067000                         30  ASC-TOTAL-UNITS        PIC 9(07).    06700099
067100******************************************************************06710099
067200                                                                  06720099
067400*---------------------------------------------------------------* 06740099
067500*    ABEND PROCESSING COPYBOOK.                                 * 06750099
067600*---------------------------------------------------------------* 06760099
067800     COPY DPWS013.                                                06780099
067900*                                                                 06790099
068000*---------------------------------------------------------------* 06800099
068100*    DB2 AREA FOR THE VEHICLE TRIP TABLE                        * 06810099
068200*---------------------------------------------------------------* 06820099
068300     EXEC SQL                                                     06830099
068400          INCLUDE TVHTRIP                                         06840099
068500     END-EXEC.                                                    06850099
068600                                                                  06860099
068610*---------------------------------------------------------------* 06861099
068620*    DB2 AREA FOR THE INBOUND SHIP UNIT TABLE                   * 06862099
068630*---------------------------------------------------------------* 06863099
068640     EXEC SQL                                                     06864099
068650          INCLUDE TSHPUNT                                         06865099
068660     END-EXEC.                                                    06866099
068670                                                                  06867099
068700*                                                                 06870099
068800*---------------------------------------------------------------* 06880099
068900*    DB2 AREA FOR THE VEHICLE TRIP STATUS TABLE                 * 06890099
069000*---------------------------------------------------------------* 06900099
069100     EXEC SQL                                                     06910099
069200          INCLUDE TTRIPST                                         06920099
069300     END-EXEC.                                                    06930099
069400                                                                  06940099
069500*                                                                 06950099
069600*---------------------------------------------------------------* 06960099
069700*    DB2 AREA FOR THE TRIP STATUS CODE TABLE                    * 06970099
069800*---------------------------------------------------------------* 06980099
069900     EXEC SQL                                                     06990099
070000          INCLUDE TTRSTYP                                         07000099
070100     END-EXEC.                                                    07010099
070200                                                                  07020099
070300*                                                                 07030099
070400*---------------------------------------------------------------* 07040099
070500*    DB2 AREA FOR THE VEHICLE TABLE                             * 07050099
070600*---------------------------------------------------------------* 07060099
070700     EXEC SQL                                                     07070099
070800          INCLUDE TVEHICL                                         07080099
070900     END-EXEC.                                                    07090099
071000                                                                  07100099
071100*                                                                 07110099
071200*---------------------------------------------------------------* 07120099
071300*    DB2 AREA FOR THE SHIPMENT TABLE                            * 07130099
071400*---------------------------------------------------------------* 07140099
071500     EXEC SQL                                                     07150099
071600          INCLUDE TSHIPMT                                         07160099
071700     END-EXEC.                                                    07170099
071800                                                                  07180099
071900*                                                                 07190099
072000*---------------------------------------------------------------* 07200099
072100*    DB2 AREA FOR THE PO SHIPMENT TABLE                         * 07210099
072200*---------------------------------------------------------------* 07220099
072300     EXEC SQL                                                     07230099
072400          INCLUDE TSHPTPO                                         07240099
072500     END-EXEC.                                                    07250099
072600                                                                  07260099
072700*                                                                 07270099
072800*---------------------------------------------------------------* 07280099
072900*    DB2 AREA FOR THE PACKING SLIP TABLE                        * 07290099
073000*---------------------------------------------------------------* 07300099
073100     EXEC SQL                                                     07310099
073200          INCLUDE TPKSLIP                                         07320099
073300     END-EXEC.                                                    07330099
073400                                                                  07340099
073500*                                                                 07350099
073600*---------------------------------------------------------------* 07360099
073700*    DB2 AREA FOR THE PACKSLIP/SHIPMENT UNIT ASSOCIATION TABLE *  07370099
073800*---------------------------------------------------------------* 07380099
073900     EXEC SQL                                                     07390099
074000          INCLUDE TINPKSU                                         07400099
074100     END-EXEC.                                                    07410099
074200                                                                  07420099
074300*                                                                 07430099
074400*---------------------------------------------------------------* 07440099
074500*    DB2 AREA FOR THE SHIPMENT UNIT LOCATION TABLE              * 07450099
074600*---------------------------------------------------------------* 07460099
074700     EXEC SQL                                                     07470099
074800          INCLUDE TSHUNLO                                         07480099
074900     END-EXEC.                                                    07490099
075000                                                                  07500099
075100*                                                                 07510099
075200*---------------------------------------------------------------* 07520099
075300*    DB2 AREA FOR THE RECEIVER TABLE                            * 07530099
075400*---------------------------------------------------------------* 07540099
075500     EXEC SQL                                                     07550099
075600          INCLUDE TRECEIV                                         07560099
075700     END-EXEC.                                                    07570099
075800                                                                  07580099
075900*                                                                 07590099
076000*---------------------------------------------------------------* 07600099
076100*    DB2 AREA FOR THE RECEIPT ITEM TABLE                        * 07610099
076200*---------------------------------------------------------------* 07620099
076300     EXEC SQL                                                     07630099
076400          INCLUDE TRECITM                                         07640099
076500     END-EXEC.                                                    07650099
076600                                                                  07660099
076700*---------------------------------------------------------------* 07670099
076800*    DB2 AREA FOR THE RECEIPT STORE DISTRIBUTION TABLE          * 07680099
076900*---------------------------------------------------------------* 07690099
077000     EXEC SQL                                                     07700099
077100          INCLUDE TRECDIS                                         07710099
077200     END-EXEC.                                                    07720099
077300                                                                  07730099
077400*                                                                 07740099
077500*---------------------------------------------------------------* 07750099
077600*    DB2 AREA FOR COMMUNICATIONS                                * 07760099
077700*---------------------------------------------------------------* 07770099
077800     EXEC SQL                                                     07780099
077900          INCLUDE SQLCA                                           07790099
078000     END-EXEC.                                                    07800099
078100                                                                  07810099
078200*---------------------------------------------------------------* 07820099
078300*  CURSOR TO SELECT ALL TRAILERS WHEN A SPECIFIC OPER UNIT ID   * 07830099
078400*  AND FACILITY ID ENTERED                                      * 07840099
078500*---------------------------------------------------------------* 07850099
078600     EXEC SQL                                                     07860099
078700          DECLARE TRAILER-CSR CURSOR FOR                          07870099
078800          SELECT A.TRIP_ID                                        07880099
078900                ,A.OWNER_SCAC_ID                                  07890099
079000                ,A.VEH_NBR                                        07900099
079100                ,B.TRIP_STATUS_CDE                                07910099
079200                ,C.PRTY_CDE                                       07920099
079300                ,MAX(G.REC_TMST)                                  07930099
079400          FROM   TVHTRIP A                                        07940099
079500                ,TTRIPST B                                        07950099
079600                ,TTRSTYP C                                        07960099
079800                ,TSHIPMT E                                        07980099
079900                ,TSHPTPO F                                        07990099
080000                ,TRECEIV G                                        08000099
080100          WHERE A.TRIP_ID             = B.TRIP_ID                 08010099
080200            AND B.TRIP_STATUS_CDE     = C.TRIP_STATUS_CDE         08020099
080400            AND (C.TRIP_STATUS_CDE       IN (:PC-TYPE1,           08040099
080500                                            :PC-TYPE2,            08050099
080600                                            :PC-TYPE3,            08060099
080700                                            :PC-TYPE4,            08070099
080800                                            :PC-TYPE5)            08080099
080810                 OR 0 = 1)                                        08081099
080900            AND B.OPER_UNT_ID         = :DK-OPER-UNT-ID           08090099
080920            AND C.TRIP_STATUS_CDE     = C.TRIP_STATUS_CDE         08092099
081000            AND C.PRTY_CDE            =                           08100099
081100                (SELECT MAX(CC.PRTY_CDE)                          08110099
081200                   FROM TTRIPST BB                                08120099
081300                      , TTRSTYP CC                                08130099
081400                  WHERE BB.TRIP_ID         = A.TRIP_ID            08140099
081500                    AND BB.TRIP_STATUS_CDE = CC.TRIP_STATUS_CDE)  08150099
081600            AND A.TRIP_ID         = E.TRIP_ID                     08160099
081700            AND E.SHIPT_ID        = F.SHIPT_ID                    08170099
081800            AND F.PO_NBR          = G.ORD_NBR                     08180099
081900            AND F.REC_SEQ_NBR     = G.REC_SEQ_NBR                 08190099
081910            AND F.REC_SEQ_NBR     = F.REC_SEQ_NBR                 08191099
082000          GROUP BY A.TRIP_ID                                      08200099
082100                 , A.OWNER_SCAC_ID                                08210099
082200                 , A.VEH_NBR                                      08220099
082300                 , B.TRIP_STATUS_CDE                              08230099
082400                 , C.PRTY_CDE                                     08240099
082500          ORDER BY 5,6,2,3                                        08250099
082510         WITH UR                                                  08251099
082600     END-EXEC.                                                    08260099
082700                                                                  08270099
082800*---------------------------------------------------------------* 08280099
082900*  CURSOR TO SELECT TRAILERS WHEN SPECIFIC SCAC AND TRAILER     * 08290099
083000*  ENTERED                                                      * 08300099
083100*---------------------------------------------------------------* 08310099
083200     EXEC SQL                                                     08320099
083300          DECLARE SCAC-TRAILER-CSR CURSOR FOR                     08330099
083400          SELECT A.TRIP_ID                                        08340099
083500                ,A.OWNER_SCAC_ID                                  08350099
083600                ,A.VEH_NBR                                        08360099
083700                ,B.TRIP_STATUS_CDE                                08370099
083800                ,C.PRTY_CDE                                       08380099
083900                ,MAX(G.REC_TMST)                                  08390099
084000          FROM   TVHTRIP A                                        08400099
084100                ,TTRIPST B                                        08410099
084200                ,TTRSTYP C                                        08420099
084400                ,TSHIPMT E                                        08440099
084500                ,TSHPTPO F                                        08450099
084600                ,TRECEIV G                                        08460099
084700          WHERE A.TRIP_ID             = B.TRIP_ID                 08470099
084800            AND B.TRIP_STATUS_CDE     = C.TRIP_STATUS_CDE         08480099
085000            AND C.TRIP_STATUS_CDE       IN (:PC-TYPE1,            08500099
085100                                            :PC-TYPE2,            08510099
085200                                            :PC-TYPE3,            08520099
085300                                            :PC-TYPE4,            08530099
085400                                            :PC-TYPE5)            08540099
085500            AND B.OPER_UNT_ID         = :DK-OPER-UNT-ID           08550099
085600            AND C.PRTY_CDE            =                           08560099
085700                (SELECT MAX(CC.PRTY_CDE)                          08570099
085800                   FROM TTRIPST BB                                08580099
085900                      , TTRSTYP CC                                08590099
086000                  WHERE BB.TRIP_ID         = A.TRIP_ID            08600099
086100                    AND BB.TRIP_STATUS_CDE = CC.TRIP_STATUS_CDE)  08610099
086200            AND A.TRIP_ID         = E.TRIP_ID                     08620099
086300            AND E.SHIPT_ID        = F.SHIPT_ID                    08630099
086400            AND F.PO_NBR          = G.ORD_NBR                     08640099
086500            AND F.REC_SEQ_NBR     = G.REC_SEQ_NBR                 08650099
086600            AND A.OWNER_SCAC_ID   = :DK-SCAC-ID                   08660099
086700            AND A.VEH_NBR         = :DK-VEH-NBR                   08670099
086800          GROUP BY A.TRIP_ID                                      08680099
086900                 , A.OWNER_SCAC_ID                                08690099
087000                 , A.VEH_NBR                                      08700099
087100                 , B.TRIP_STATUS_CDE                              08710099
087200                 , C.PRTY_CDE                                     08720099
087300          ORDER BY 5,6,2,3                                        08730099
087310         WITH UR                                                  08731099
087400     END-EXEC.                                                    08740099
087500                                                                  08750099
087600*---------------------------------------------------------------* 08760099
087700*  CURSOR TO SELECT TRAILERS WHEN SPECIFIC SCAC ENTERED         * 08770099
087800*---------------------------------------------------------------* 08780099
087900     EXEC SQL                                                     08790099
088000          DECLARE SCAC-CSR CURSOR FOR                             08800099
088100          SELECT A.TRIP_ID                                        08810099
088200                ,A.OWNER_SCAC_ID                                  08820099
088300                ,A.VEH_NBR                                        08830099
088400                ,B.TRIP_STATUS_CDE                                08840099
088500                ,C.PRTY_CDE                                       08850099
088600                ,MAX(G.REC_TMST)                                  08860099
088700          FROM   TVHTRIP A                                        08870099
088800                ,TTRIPST B                                        08880099
088900                ,TTRSTYP C                                        08890099
089100                ,TSHIPMT E                                        08910099
089200                ,TSHPTPO F                                        08920099
089300                ,TRECEIV G                                        08930099
089400          WHERE A.TRIP_ID             = B.TRIP_ID                 08940099
089500            AND B.TRIP_STATUS_CDE     = C.TRIP_STATUS_CDE         08950099
089700            AND C.TRIP_STATUS_CDE       IN (:PC-TYPE1,            08970099
089800                                            :PC-TYPE2,            08980099
089900                                            :PC-TYPE3,            08990099
090000                                            :PC-TYPE4,            09000099
090100                                            :PC-TYPE5)            09010099
090200            AND B.OPER_UNT_ID         = :DK-OPER-UNT-ID           09020099
090300            AND C.PRTY_CDE            =                           09030099
090400                (SELECT MAX(CC.PRTY_CDE)                          09040099
090500                   FROM TTRIPST BB                                09050099
090600                      , TTRSTYP CC                                09060099
090700                  WHERE BB.TRIP_ID         = A.TRIP_ID            09070099
090800                    AND BB.TRIP_STATUS_CDE = CC.TRIP_STATUS_CDE)  09080099
090900            AND A.TRIP_ID         = E.TRIP_ID                     09090099
091000            AND E.SHIPT_ID        = F.SHIPT_ID                    09100099
091100            AND F.PO_NBR          = G.ORD_NBR                     09110099
091200            AND F.REC_SEQ_NBR     = G.REC_SEQ_NBR                 09120099
091300            AND A.OWNER_SCAC_ID   = :DK-SCAC-ID                   09130099
091400          GROUP BY A.TRIP_ID                                      09140099
091500                 , A.OWNER_SCAC_ID                                09150099
091600                 , A.VEH_NBR                                      09160099
091700                 , B.TRIP_STATUS_CDE                              09170099
091800                 , C.PRTY_CDE                                     09180099
091900          ORDER BY 5,6,2,3                                        09190099
091910         WITH UR                                                  09191099
092000     END-EXEC.                                                    09200099
092100                                                                  09210099
092200*---------------------------------------------------------------* 09220099
092300*  CURSOR TO SELECT TRAILERS WHEN SPECIFIC TRIP ID ENTERED      * 09230099
092400*---------------------------------------------------------------* 09240099
092500     EXEC SQL                                                     09250099
092600          DECLARE TRIP-ID-CSR CURSOR FOR                          09260099
092700          SELECT A.TRIP_ID                                        09270099
092800                ,A.OWNER_SCAC_ID                                  09280099
092900                ,A.VEH_NBR                                        09290099
093000                ,B.TRIP_STATUS_CDE                                09300099
093100                ,MAX(G.REC_TMST)                                  09310099
093200           FROM TVHTRIP A                                         09320099
093300               ,TTRIPST B                                         09330099
093400               ,TTRSTYP C                                         09340099
093600               ,TSHIPMT E                                         09360099
093700               ,TSHPTPO F                                         09370099
093800               ,TRECEIV G                                         09380099
093900          WHERE A.TRIP_ID          = :DK-TRIP-ID                  09390099
094000            AND B.OPER_UNT_ID      = :DK-OPER-UNT-ID              09400099
094100            AND A.TRIP_ID          = B.TRIP_ID                    09410099
094200            AND B.TRIP_STATUS_CDE  = C.TRIP_STATUS_CDE            09420099
094400            AND A.TRIP_ID          = E.TRIP_ID                    09440099
094500            AND E.SHIPT_ID         = F.SHIPT_ID                   09450099
094600            AND C.PRTY_CDE         =                              09460099
094700                (SELECT MAX(CC.PRTY_CDE)                          09470099
094800                   FROM TTRIPST BB                                09480099
094900                       ,TTRSTYP CC                                09490099
095000                  WHERE BB.TRIP_ID         = A.TRIP_ID            09500099
095100                    AND BB.TRIP_STATUS_CDE = CC.TRIP_STATUS_CDE)  09510099
095200            AND F.PO_NBR          = G.ORD_NBR                     09520099
095300            AND F.REC_SEQ_NBR     = G.REC_SEQ_NBR                 09530099
095400          GROUP BY A.TRIP_ID                                      09540099
095500                  ,A.OWNER_SCAC_ID                                09550099
095600                  ,A.VEH_NBR                                      09560099
095700                  ,B.TRIP_STATUS_CDE                              09570099
095710         WITH UR                                                  09571099
095800     END-EXEC.                                                    09580099
095900                                                                  09590099
096000*---------------------------------------------------------------* 09600099
096100*  CURSOR TO SELECT TRAILERS WHEN SPECIFIC PO NUMBER AND        * 09610099
096200*  REC SEQ NUMBER ENTERED                                       * 09620099
096300*---------------------------------------------------------------* 09630099
096400     EXEC SQL                                                     09640099
096500          DECLARE PO-REC-CSR CURSOR FOR                           09650099
096600          SELECT F.PO_NBR                                         09660099
096700                ,F.REC_SEQ_NBR                                    09670099
096800                ,A.TRIP_ID                                        09680099
096900                ,A.OWNER_SCAC_ID                                  09690099
097000                ,A.VEH_NBR                                        09700099
097100                ,B.TRIP_STATUS_CDE                                09710099
097200                ,MAX(G.REC_TMST)                                  09720099
097300           FROM TVHTRIP A                                         09730099
097400               ,TTRIPST B                                         09740099
097500               ,TTRSTYP C                                         09750099
097700               ,TSHIPMT E                                         09770099
097800               ,TSHPTPO F                                         09780099
097900               ,TRECEIV G                                         09790099
098000          WHERE F.PO_NBR           = :DK-PO-NBR                   09800099
098100            AND F.REC_SEQ_NBR      = :DK-REC-SEQ-NBR              09810099
098200            AND B.OPER_UNT_ID      = :DK-OPER-UNT-ID              09820099
098300            AND A.TRIP_ID          = B.TRIP_ID                    09830099
098400            AND B.TRIP_STATUS_CDE  = C.TRIP_STATUS_CDE            09840099
098600            AND A.TRIP_ID          = E.TRIP_ID                    09860099
098700            AND E.SHIPT_ID         = F.SHIPT_ID                   09870099
098800            AND C.PRTY_CDE         =                              09880099
098900                (SELECT MAX(CC.PRTY_CDE)                          09890099
099000                   FROM TTRIPST BB                                09900099
099100                       ,TTRSTYP CC                                09910099
099200                  WHERE BB.TRIP_ID         = A.TRIP_ID            09920099
099300                    AND BB.TRIP_STATUS_CDE = CC.TRIP_STATUS_CDE)  09930099
099400            AND F.PO_NBR          = G.ORD_NBR                     09940099
099500            AND F.REC_SEQ_NBR     = G.REC_SEQ_NBR                 09950099
099600          GROUP BY F.PO_NBR                                       09960099
099700                  ,F.REC_SEQ_NBR                                  09970099
099800                  ,A.TRIP_ID                                      09980099
099900                  ,A.OWNER_SCAC_ID                                09990099
100000                  ,A.VEH_NBR                                      10000099
100100                  ,B.TRIP_STATUS_CDE                              10010099
100110         WITH UR                                                  10011099
100200     END-EXEC.                                                    10020099
100300                                                                  10030099
100400*---------------------------------------------------------------* 10040099
100500*  CURSOR TO SELECT TRAILERS WHEN SPECIFIC PO NUMBER ENTERED    * 10050099
100600*---------------------------------------------------------------* 10060099
100700     EXEC SQL                                                     10070099
100800          DECLARE PO-CSR CURSOR FOR                               10080099
100900          SELECT F.PO_NBR                                         10090099
101000                ,A.TRIP_ID                                        10100099
101100                ,A.OWNER_SCAC_ID                                  10110099
101200                ,A.VEH_NBR                                        10120099
101300                ,B.TRIP_STATUS_CDE                                10130099
101400                ,MAX(G.REC_TMST)                                  10140099
101500           FROM TVHTRIP A                                         10150099
101600               ,TTRIPST B                                         10160099
101700               ,TTRSTYP C                                         10170099
101900               ,TSHIPMT E                                         10190099
102000               ,TSHPTPO F                                         10200099
102100               ,TRECEIV G                                         10210099
102200          WHERE F.PO_NBR           = :DK-PO-NBR                   10220099
102300            AND B.OPER_UNT_ID      = :DK-OPER-UNT-ID              10230099
102400            AND A.TRIP_ID          = B.TRIP_ID                    10240099
102500            AND B.TRIP_STATUS_CDE  = C.TRIP_STATUS_CDE            10250099
102700            AND A.TRIP_ID          = E.TRIP_ID                    10270099
102800            AND E.SHIPT_ID         = F.SHIPT_ID                   10280099
102900            AND C.PRTY_CDE         =                              10290099
103000                (SELECT MAX(CC.PRTY_CDE)                          10300099
103100                   FROM TTRIPST BB                                10310099
103200                       ,TTRSTYP CC                                10320099
103300                  WHERE BB.TRIP_ID         = A.TRIP_ID            10330099
103400                    AND BB.TRIP_STATUS_CDE = CC.TRIP_STATUS_CDE)  10340099
103500            AND F.PO_NBR          = G.ORD_NBR                     10350099
103600            AND F.REC_SEQ_NBR     = G.REC_SEQ_NBR                 10360099
103700          GROUP BY F.PO_NBR                                       10370099
103800                  ,A.TRIP_ID                                      10380099
103900                  ,A.OWNER_SCAC_ID                                10390099
104000                  ,A.VEH_NBR                                      10400099
104100                  ,B.TRIP_STATUS_CDE                              10410099
104110         WITH UR                                                  10411099
104200     END-EXEC.                                                    10420099
104300*---------------------------------------------------------------* 10430099
104400*  CURSOR TO SELECT FREE ASTRAYS                                * 10440099
104500*---------------------------------------------------------------* 10450099
104600     EXEC SQL                                                     10460099
104700          DECLARE FREE-ASTRAY-CSR CURSOR FOR                      10470099
104800          SELECT SHIPT_UNT_ID                                     10480099
104900          FROM   TSHUNLO                                          10490099
105000          WHERE TRIP_ID               = :VHTRIP-TRIP-ID           10500099
105011          AND   SCN_LOC_ID           IN ('RECV','WRCV')           10501199
105020          AND   ACTV_CDE              = 'A'                       10502099
105100          WITH UR                                                 10510099
105200     END-EXEC.                                                    10520099
105300                                                                  10530099
105400*---------------------------------------------------------------* 10540099
105500*  CURSOR TO FIND OUT WHAT TRIP-ID THE CARTON WAS EXPECTED ON   * 10550099
105600*---------------------------------------------------------------* 10560099
105700     EXEC SQL                                                     10570099
105800          DECLARE CARTON-CSR CURSOR FOR                           10580099
105900          SELECT DISTINCT                                         10590099
106000              D.TRIP_ID                                           10600099
106100            , B.REC_SEQ_NBR                                       10610099
106200          FROM   TINPKSU A                                        10620099
106300            ,    TPKSLIP B                                        10630099
106400            ,    TSHPTPO C                                        10640099
106500            ,    TSHIPMT D                                        10650099
106600          WHERE A.SHIPT_UNT_ID        = :SHUNLO-SHIPT-UNT-ID      10660099
106700            AND A.PO_NBR              = B.PO_NBR                  10670099
106800            AND A.SEQ_NBR             = B.SEQ_NBR                 10680099
106900            AND B.PO_NBR              = C.PO_NBR                  10690099
107000            AND B.REC_SEQ_NBR         = C.REC_SEQ_NBR             10700099
107100            AND B.VER_STAT_CDE        = :PC-A                     10710099
107200            AND D.SHIPT_ID            = C.SHIPT_ID                10720099
107210            WITH UR                                               10721099
107300     END-EXEC.                                                    10730099
107400                                                                  10740099
107500*---------------------------------------------------------------* 10750099
107600*  CURSOR TO GET TOTAL NUMBER OF UNITS ON TRAILER.              * 10760099
107700*---------------------------------------------------------------* 10770099
107800     EXEC SQL                                                     10780099
107900          DECLARE PO-LNE-CSR CURSOR FOR                           10790099
108000          SELECT D.ORD_NBR                                        10800099
108100               , D.REC_SEQ_NBR                                    10810099
108200               , D.ORD_LNE_NBR                                    10820099
108300               , D.STATUS_CDE                                     10830099
108400               , D.PKSL_ITM_QTY                                   10840099
108500               , D.DTL_CK_ITM_QTY                                 10850099
108600          FROM   TSHIPMT A                                        10860099
108700            ,    TSHPTPO B                                        10870099
108800            ,    TRECEIV C                                        10880099
108900            ,    TRECITM D                                        10890099
109000          WHERE A.TRIP_ID             = :VHTRIP-TRIP-ID           10900099
109100            AND A.SHIPT_ID            = B.SHIPT_ID                10910099
109200            AND B.PO_NBR              = C.ORD_NBR                 10920099
109300            AND B.REC_SEQ_NBR         = C.REC_SEQ_NBR             10930099
109400            AND B.PO_NBR              = D.ORD_NBR                 10940099
109500            AND B.REC_SEQ_NBR         = D.REC_SEQ_NBR             10950099
109600            AND D.VER_STATUS_CDE      = 'A'                       10960099
109700          ORDER BY 1,2,3                                          10970099
109710          WITH UR                                                 10971099
109800     END-EXEC.                                                    10980099
109900                                                                  10990099
110000***************************************************************   11000099
110100*                                                                 11010099
110200 LINKAGE SECTION.                                                 11020099
110300                                                                  11030099
110400 01  DFHCOMMAREA.                                                 11040099
110500     05  FILLER                         OCCURS  1 TO 4072 TIMES   11050099
110600                                        DEPENDING ON EIBCALEN.    11060099
110700         10  FILLER                     PIC X.                    11070099
110800                                                                  11080099
110900 EJECT                                                            11090099
111000 PROCEDURE DIVISION.                                              11100099
111100*---------------------------------------------------------------* 11110099
111200*   THIS MODULE IS THE HIGHEST PROCESSING LEVEL IN THE PROGRAM. * 11120099
111300*   FIRST, CALL THE CICS ARCHITECTURE API, PERFORM THE PROGRAM  * 11130099
111400*   PROCESSING AND THEN CALL THE CICS ARCHITECTURE API TO EXIT. * 11140099
111500*---------------------------------------------------------------* 11150099
111600*                                                                 11160099
111700 0000-MAIN-MODULE.                                                11170099
111800     INITIALIZE DP030-CICS-API-FIELDS.                            11180099
111900     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       11190099
112000     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          11200099
112100     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         11210099
112200     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       11220099
112300     MOVE LENGTH OF SUK551I        TO DP030-MAP-LENGTH (1).       11230099
112400     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     11240099
112500     PERFORM 0001-CALL-CICS-ARCH-API.                             11250099
112600*                                                                 11260099
112700     PERFORM 1000-CONTROL-PROCESSING                              11270099
112800                                                                  11280099
112900     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     11290099
113000     PERFORM 0001-CALL-CICS-ARCH-API.                             11300099
113100                                                                  11310099
113200*---------------------------------------------------------------* 11320099
113300*   THIS PARAGRAPH CALLS THE CICS ARCHITECTURE API SUBROUTINE   * 11330099
113400*   AND WILL ABEND IF ANY ERRORS OCCURRED IN THAT CALL.         * 11340099
113500*---------------------------------------------------------------* 11350099
113600*                                                                 11360099
113700 0001-CALL-CICS-ARCH-API.                                         11370099
113800*    CALL 'DPKCS030' USING DFHEIBLK                               11380099
113800     CALL DP930-CICS-ARCH-API USING DFHEIBLK                      11381099
113900                           DFHCOMMAREA                            11390099
114000                           DP030-CICS-API-FIELDS                  11400099
114100                           DP020-STANDARD-COMMAREA                11410099
114200                           SUK551I.                               11420099
114300*                                                                 11430099
114400     IF DP030-RC-CALL-SUCCESSFUL                                  11440099
114500         CONTINUE                                                 11450099
114600     ELSE                                                         11460099
114700         SET DP013-NO-ROLLBACK                                    11470099
114800             DP013-XCTL-DISPLAY-RESTART                           11480099
114900             DP013-CICS-ABEND      TO TRUE                        11490099
115000         MOVE '0001-CALL-CICS-ARCH-API'                           11500099
115100                                   TO DP013-PARAGRAPH             11510099
115200*        MOVE 'CALL TO DPKCS030 NOT SUCCESSFUL, RETURN-CODE ON NEX11520099
115300*             'T LINE'             TO DP013-MESSAGE-TEXT (2)      11530099
115200         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O11531099
115300-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      11532099
115400         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      11540099
115500         PERFORM DP013-0000-PROCESS-ABEND                         11550099
115600     END-IF.                                                      11560099
115700                                                                  11570099
115800*----------------------------------------------------------------*11580099
115900* PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT      *11590099
116000* COURSE OF ACTION IS FOR THIS TRANSACTION.                      *11600099
116100*                                                                *11610099
116200* NOTE:  PV-TOP-ITEM IS THE ITEM THAT IS REQUESTED TO BE AT THE  *11620099
116300*  TOP OF THE PANEL.  MOVING ASC-ITEM-AT-TOP-OF-PANEL TO THIS    *11630099
116400*  MEANS THAT POSITION WITHIN THE LIST WILL NOT CHANGE -- THIS   *11640099
116500*  IS THE DEFAULT WHICH WILL BE OVERRIDDEN BY SCROLLING ACTIONS. *11650099
116600*----------------------------------------------------------------*11660099
116700*                                                                 11670099
116800 1000-CONTROL-PROCESSING.                                         11680099
116900     EVALUATE TRUE                                                11690099
117000         WHEN DP020-NEXT-ACT-INITIAL                              11700099
117010                                                                  11701099
117100             INITIALIZE ASC-SPECIFIC-COMMAREA                     11710099
117200             MOVE EIBTRMID         TO ASC-LIST-TERM-ID            11720099
117300                                      ASC-SEL-TERM-ID             11730099
117400                                      ASC-SEL-TERM-ID-ORIG        11740099
117500             MOVE DP020-SRC-TASK-NUMBER                           11750099
117600                                   TO ASC-LIST-TASK-NUMBER        11760099
117700                                      ASC-SEL-TASK-NUMBER         11770099
117800                                      ASC-SEL-TASK-NUMBER-ORIG    11780099
117900             MOVE PC-LIST-QUEUE-SEQ                               11790099
118000                                   TO ASC-LIST-SEQ                11800099
118100             MOVE PC-SEL-QUEUE-SEQ TO ASC-SEL-SEQ                 11810099
118200                                      ASC-SEL-SEQ-ORIG            11820099
118300             PERFORM 1100-PROCESS-INTER-APPL-COMM                 11830099
118400                                                                  11840099
118500             PERFORM 4000-BUILD-INITIAL-PANEL                     11850099
118600                                                                  11860099
118700         WHEN DP020-NEXT-ACT-READ-MAP                             11870099
118710                                                                  11871099
118800             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        11880099
118900                                   TO PV-TOP-ITEM                 11890099
119000             PERFORM 2000-PROCESS-PANEL                           11900099
119100                                                                  11910099
119200         WHEN DP020-NEXT-ACT-RETURN                               11920099
119210                                                                  11921099
119300             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        11930099
119400                                   TO PV-TOP-ITEM                 11940099
119500             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    11950099
119600             PERFORM 6000-REFRESH-PANEL-FROM-TEMP                 11960099
119700             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 11970099
119800                                                                  11980099
119900         WHEN OTHER                                               11990099
120000             SET DP013-LOGIC-ABEND TO TRUE                        12000099
120100             SET DP013-NO-ROLLBACK TO TRUE                        12010099
120200             MOVE '1000-CONTROL-PROCESSING'                       12020099
120300                                   TO DP013-PARAGRAPH             12030099
120400             MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'    12040099
120500                                   TO DP013-MESSAGE-TEXT(1)       12050099
120600             PERFORM DP013-0000-PROCESS-ABEND                     12060099
120700     END-EVALUATE.                                                12070099
120800                                                                  12080099
120900 EJECT                                                            12090099
121000*                                                                 12100099
121100*                                                                 12110099
121200*----------------------------------------------------------------*12120099
121300* DETERMINE IF DATA WAS PASSED THROUGH INTER-APPL COMMAREA OR    *12130099
121400* IF THERE IS DATA TO BE USED IN THE NAV-KEY FIELD.              *12140099
121500*----------------------------------------------------------------*12150099
121600 1100-PROCESS-INTER-APPL-COMM.                                    12160099
121700     SET PS-COMMAREA-VALID         TO TRUE.                       12170099
121800     MOVE SPACE                    TO ASC-START-ITEM-REQUEST.     12180099
121900                                                                  12190099
122000******COPYBOOK FIELDS GET MOVED TO ASC FIELDS NOT IN ITEM ARRAY.  12200099
122100     IF  DP020-INT-APPL-FORMAT-IND = PC-CRIT-SPEC-FORMAT          12210099
122200         MOVE SU002-OPER-UNT-ID      TO ASC-OPER-UNT-ID           12220099
122300         MOVE SU002-FCLTY-ID         TO ASC-FCLTY-ID              12230099
122400         MOVE SU002-FCLTY-NME        TO ASC-FCLTY-NME             12240099
122500         MOVE SU002-SCAC             TO ASC-SCAC                  12250099
122600         MOVE SU002-TRLR-NBR         TO ASC-TRLR-NBR              12260099
122700         MOVE SU002-STATUS-AR        TO ASC-STATUS-AR             12270099
122800         MOVE SU002-STATUS-UG        TO ASC-STATUS-UG             12280099
122900         MOVE SU002-STATUS-UN        TO ASC-STATUS-UN             12290099
123000         MOVE SU002-STATUS-EN        TO ASC-STATUS-EN             12300099
123100         MOVE SU002-STATUS-DP        TO ASC-STATUS-DP             12310099
123200         MOVE SU002-TRIP-ID          TO ASC-TRIP-ID               12320099
123300         MOVE SU002-PO-NBR           TO ASC-PO-NBR                12330099
123400         MOVE SU002-REC-SEQ-NBR      TO ASC-RECEIVER              12340099
123500         MOVE SU002-SHIPT-UNT-ID     TO ASC-SHIPT-UNT-ID          12350099
123600     ELSE                                                         12360099
123700         MOVE SU003-OPER-UNT-ID      TO ASC-OPER-UNT-ID           12370099
123800         MOVE SU003-FCLTY-ID         TO ASC-FCLTY-ID              12380099
123900         MOVE SU003-FCLTY-NME        TO ASC-FCLTY-NME             12390099
124000         MOVE SU003-SCAC-CDE         TO ASC-SCAC                  12400099
124100         MOVE SU003-TRLR-NBR         TO ASC-TRLR-NBR              12410099
124200         MOVE SU003-STATUS-AR        TO ASC-STATUS-AR             12420099
124300         MOVE SU003-STATUS-UG        TO ASC-STATUS-UG             12430099
124400         MOVE SU003-STATUS-UN        TO ASC-STATUS-UN             12440099
124500         MOVE SU003-STATUS-EN        TO ASC-STATUS-EN             12450099
124600         MOVE SU003-STATUS-DP        TO ASC-STATUS-DP             12460099
124700         MOVE SU003-TRIP-ID          TO ASC-TRIP-ID               12470099
124800         MOVE SU003-PO-NBR           TO ASC-PO-NBR                12480099
124900         MOVE SU003-REC-SEQ-NBR      TO ASC-RECEIVER              12490099
125000         MOVE SU003-SHIPT-UNT-ID     TO ASC-SHIPT-UNT-ID          12500099
125100     END-IF.                                                      12510099
125200*                                                                 12520099
125300*                                                                 12530099
125400*----------------------------------------------------------------*12540099
125500* DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITING OF THE DATA    *12550099
125600* ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *12560099
125700* USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *12570099
125800* OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *12580099
125900* FUNCTION KEYS CAN GET THIS FAR.                                *12590099
126000*----------------------------------------------------------------*12600099
126100*                                                                 12610099
126200 2000-PROCESS-PANEL.                                              12620099
126300     EVALUATE TRUE                                                12630099
126400         WHEN DP020-SRC-AID = DP016-CLEAR                         12640099
126500             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    12650099
126600             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   12660099
126700             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 12670099
126800                                                                  12680099
126900         WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    12690099
127000             PERFORM 2050-DELETE-LIST-QUEUE                       12700099
127100*INITIALIZE COLUMN TOTALS                                         12710099
127200             MOVE ZEROS TO ASC-TOT-EXP-CRT                        12720099
127300             MOVE ZEROS TO ASC-TOT-ACT-CRT                        12730099
127400             MOVE ZEROS TO ASC-TOT-EXP-SCN                        12740099
127500             MOVE ZEROS TO ASC-TOT-ACT-SCN                        12750099
127600             MOVE ZEROS TO ASC-TOT-FRE-AST                        12760099
127700             MOVE ZEROS TO ASC-TOT-UNITS                          12770099
127800             PERFORM 4000-BUILD-INITIAL-PANEL                     12780099
127900                                                                  12790099
128000         WHEN DP020-FK-DESELECT(DP020-SRC-AID)                    12800099
128100             PERFORM 2140-DESELECT-ALL-ITEMS                      12810099
128200             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 12820099
128300                                                                  12830099
128400         WHEN DP020-FK-SELECT-ALL (DP020-SRC-AID)                 12840099
128500              PERFORM 2150-SELECT-ALL-ITEMS                       12850099
128600              PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                12860099
128700                                                                  12870099
128800         WHEN OTHER                                               12880099
128900             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 12890099
129000             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   12900099
129100                                                                  12910099
129200             IF  PS-NO-ERROR                                      12920099
129300                 SET DP030-CONTINUE-GO                            12930099
129400                                 TO TRUE                          12940099
129500                 PERFORM 2100-CHECK-FUNCTION-KEY                  12950099
129600             ELSE                                                 12960099
129700                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             12970099
129800                 SET DP030-OVERRIDE-GO                            12980099
129900                                 TO TRUE                          12990099
130000             END-IF                                               13000099
130100     END-EVALUATE.                                                13010099
130200 EJECT                                                            13020099
130300*                                                                 13030099
130400*                                                                 13040099
130500*----------------------------------------------------------------*13050099
130600*  DELETE THE LIST ITEMS TEMP STORAGE QUEUE.                     *13060099
130700*----------------------------------------------------------------*13070099
130800*                                                                 13080099
130900 2050-DELETE-LIST-QUEUE.                                          13090099
131000     EXEC CICS                                                    13100099
131100         DELETEQ TS                                               13110099
131200           QUEUE (ASC-LIST-QUEUE-NAME)                            13120099
131300            RESP (PV-CICS-RESP)                                   13130099
131400     END-EXEC.                                                    13140099
131500                                                                  13150099
131600     IF (PV-CICS-RESP = DFHRESP(NORMAL)) OR                       13160099
131700        (PV-CICS-RESP = DFHRESP(QIDERR))                          13170099
131800         CONTINUE                                                 13180099
131900     ELSE                                                         13190099
132000         SET DP013-CICS-ABEND      TO TRUE                        13200099
132100         SET DP013-NO-ROLLBACK     TO TRUE                        13210099
132200                                                                  13220099
132300         MOVE '2050-DELETE-LIST-QUEUE'                            13230099
132400                                   TO DP013-PARAGRAPH             13240099
132500         MOVE 'ERROR TRYING TO DELETE LIST TEMP STORAGE QUEUE'    13250099
132600                                   TO DP013-MESSAGE-TEXT (1)      13260099
132700         PERFORM DP013-0000-PROCESS-ABEND                         13270099
132800     END-IF.                                                      13280099
132900                                                                  13290099
133000     MOVE +0                       TO ASC-HIGHEST-BLOCK-WRITTEN.  13300099
133100 EJECT                                                            13310099
133200*                                                                 13320099
133300*                                                                 13330099
133400*----------------------------------------------------------------*13340099
133500* ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED FIRST.*13350099
133600* NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED FROM THE  *13360099
133700* CICS ARCHITECTURE API.                                         *13370099
133800*----------------------------------------------------------------*13380099
133900 2100-CHECK-FUNCTION-KEY.                                         13390099
133991                                                                  13399199
134000*******************************************                       13400099
134100* F23 - PORCVLST          (LOCAL-FUNC-01)                         13410099
134200*******************************************                       13420099
134300*                                                                 13430099
134400     EVALUATE TRUE                                                13440099
134500*                                                                 13450099
134600* F23 - PO RECEIVER LIST (LOCAL-FUNC-01)                          13460099
134700*                                                                 13470099
134800         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              13480099
134801                                                                  13480199
134900             IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO              13490099
135000                 INITIALIZE SU003-INTER-APPL-COMMAREA             13500099
135100                 MOVE ASC-NUMBER-OF-SELECTED-ITEMS                13510099
135200                                TO SU003-NUMBER-OF-SELECTED-ITEMS 13520099
135300                 MOVE ASC-OPER-UNT-ID                             13530099
135400                                TO SU003-OPER-UNT-ID              13540099
135500                 MOVE ASC-FCLTY-ID                                13550099
135600                                TO SU003-FCLTY-ID                 13560099
135700                 MOVE ASC-FCLTY-NME                               13570099
135800                                TO SU003-FCLTY-NME                13580099
135900                 MOVE ASC-SCAC                                    13590099
136000                                TO SU003-SCAC-CDE                 13600099
136100                 MOVE ASC-TRLR-NBR                                13610099
136200                                TO SU003-TRLR-NBR                 13620099
136300                 MOVE ASC-STATUS-AR                               13630099
136400                                TO SU003-STATUS-AR                13640099
136500                 MOVE ASC-STATUS-UG                               13650099
136600                                TO SU003-STATUS-UG                13660099
136700                 MOVE ASC-STATUS-UN                               13670099
136800                                TO SU003-STATUS-UN                13680099
136900                 MOVE ASC-TRIP-ID                                 13690099
137000                                TO SU003-TRIP-ID                  13700099
137100                 PERFORM 5000-PREPARE-SEL-QUEUE                   13710099
137200             ELSE                                                 13720099
137300                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             13730099
137400                 SET DP030-OVERRIDE-GO                            13740099
137500                                   TO TRUE                        13750099
137600                 MOVE PC-TSYMSG-00057                             13760099
137700                                   TO DP020-MSG-NUMBER            13770099
137800                 SET DP020-MSG-WARNING                            13780099
137900                                   TO TRUE                        13790099
138000             END-IF                                               13800099
138100                                                                  13810099
138110* F23 - RECEIVER CHECK IN LIST  (LOCAL-FUNC-03)                   13811099
138120*                                                                 13812099
138130         WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)              13813099
138131                                                                  13813199
138143             IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO              13814399
138150                 INITIALIZE SU003-INTER-APPL-COMMAREA             13815099
138160                 MOVE ASC-NUMBER-OF-SELECTED-ITEMS                13816099
138170                                TO SU003-NUMBER-OF-SELECTED-ITEMS 13817099
138180                 MOVE ASC-OPER-UNT-ID                             13818099
138190                                TO SU003-OPER-UNT-ID              13819099
138191                 MOVE ASC-FCLTY-ID                                13819199
138192                                TO SU003-FCLTY-ID                 13819299
138193                 MOVE ASC-FCLTY-NME                               13819399
138194                                TO SU003-FCLTY-NME                13819499
138195                 MOVE ASC-SCAC                                    13819599
138196                                TO SU003-SCAC-CDE                 13819699
138197                 MOVE ASC-TRLR-NBR                                13819799
138198                                TO SU003-TRLR-NBR                 13819899
138199                 MOVE ASC-STATUS-AR                               13819999
138200                                TO SU003-STATUS-AR                13820099
138201                 MOVE ASC-STATUS-UG                               13820199
138202                                TO SU003-STATUS-UG                13820299
138203                 MOVE ASC-STATUS-UN                               13820399
138204                                TO SU003-STATUS-UN                13820499
138205                 MOVE ASC-TRIP-ID                                 13820599
138206                                TO SU003-TRIP-ID                  13820699
138207                 PERFORM 5000-PREPARE-SEL-QUEUE                   13820799
138208             ELSE                                                 13820899
138209                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             13820999
138210                 SET DP030-OVERRIDE-GO                            13821099
138211                                   TO TRUE                        13821199
138212                 MOVE PC-TSYMSG-00057                             13821299
138213                                   TO DP020-MSG-NUMBER            13821399
138214                 SET DP020-MSG-WARNING                            13821499
138215                                   TO TRUE                        13821599
138216             END-IF                                               13821699
138217                                                                  13821799
138220* F18=RCBYTRLR (RCKCS225)                                         13822099
138300         WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              13830099
138310                                                                  13831099
138400             IF ASC-NUMBER-OF-SELECTED-ITEMS > ZERO               13840099
138500                 INITIALIZE RC015-INTER-APPL-COMMAREA             13850099
138600                 MOVE ASC-NUMBER-OF-SELECTED-ITEMS                13860099
138700                   TO RC015-NUMBER-OF-SELECTED-ITEMS              13870099
138800                 MOVE ASC-OPER-UNT-ID      TO RC015-OPER-UNT-ID   13880099
138900                 MOVE ASC-FCLTY-ID         TO RC015-FCLTY-ID      13890099
139000                 PERFORM 5000-PREPARE-SEL-QUEUE                   13900099
139100                 SET ASC-FUNC02-RETURN-YES TO TRUE                13910099
139200             ELSE                                                 13920099
139300                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             13930099
139400                 SET DP030-OVERRIDE-GO     TO TRUE                13940099
139500                 MOVE PC-TSYMSG-00057      TO DP020-MSG-NUMBER    13950099
139600                 SET DP020-MSG-WARNING     TO TRUE                13960099
139700             END-IF                                               13970099
139800*                                                                 13980099
139900* F6 - FIRST PAGE (AUTOMATICALLY GOES BACK TO PAGE 1)             13990099
140000*                                                                 14000099
140100         WHEN DP020-FK-FIRST-PAGE(DP020-SRC-AID)                  14010099
140200             MOVE +1               TO PV-TOP-ITEM                 14020099
140300             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 14030099
140400*                                                                 14040099
140500* F7 - PREVIOUS PAGE                                              14050099
140600*                                                                 14060099
140700         WHEN DP020-FK-PREV-PAGE(DP020-SRC-AID)                   14070099
140800             PERFORM 2110-BROWSE-BACKWARD                         14080099
140900             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 14090099
141000*                                                                 14100099
141100* F8 - NEXT PAGE                                                  14110099
141200*                                                                 14120099
141300         WHEN DP020-FK-NEXT-PAGE(DP020-SRC-AID)                   14130099
141400             PERFORM 2120-BROWSE-FORWARD                          14140099
141500             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 14150099
141600*                                                                 14160099
141700* ENTER KEY                                                       14170099
141800*                                                                 14180099
141900         WHEN DP020-SRC-AID = DP016-ENTER                         14190099
142000             PERFORM 2130-CHECK-FOR-JUMP-BROWSE                   14200099
142100             IF  PS-ERROR                                         14210099
142200                 CONTINUE                                         14220099
142300             ELSE                                                 14230099
142400                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             14240099
142500             END-IF                                               14250099
142600                                                                  14260099
142700         WHEN OTHER                                               14270099
142800             SET DP013-NO-ROLLBACK                                14280099
142900                 DP013-XCTL-DISPLAY-RESTART                       14290099
143000                 DP013-CICS-ABEND  TO TRUE                        14300099
143100             MOVE '2100-CHECK-FUNCTION-KEY'                       14310099
143200                                   TO DP013-PARAGRAPH             14320099
143300             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      14330099
143400                                   TO DP013-MESSAGE-TEXT (1)      14340099
143500             PERFORM DP013-0000-PROCESS-ABEND                     14350099
143600     END-EVALUATE.                                                14360099
143700*                                                                 14370099
143800*                                                                 14380099
143900*----------------------------------------------------------------*14390099
144000*    IF THE USER HITS THE PAGE BACKWARD KEY, COMPUTE THE TOP     *14400099
144100*    ITEM NUMBER FOR THE NEW PAGE.  IF IT IS ABOVE THE TOP,      *14410099
144200*    SET THE TOP ITEM NUMBER TO +1 AND DISPLAY THE TOP OF LIST   *14420099
144300*    MESSAGE.                                                    *14430099
144400*----------------------------------------------------------------*14440099
144500*                                                                 14450099
144600 2110-BROWSE-BACKWARD.                                            14460099
144700     SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-AT-TOP-OF-PANEL    14470099
144800         GIVING PV-TOP-ITEM.                                      14480099
144900                                                                  14490099
145000     IF  ((PV-TOP-ITEM < +1)                                      14500099
145100       OR (PV-TOP-ITEM = +1))                                     14510099
145200         MOVE +1                   TO PV-TOP-ITEM                 14520099
145300*        -- TOP OF LIST --                                        14530099
145400         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            14540099
145500         SET DP020-MSG-INFORMATIONAL                              14550099
145600                                   TO TRUE                        14560099
145700     END-IF.                                                      14570099
145800 EJECT                                                            14580099
145900*                                                                 14590099
146000*                                                                 14600099
146100*----------------------------------------------------------------*14610099
146200*    IF THE USER HITS THE PAGE FORWARD KEY, COMPUTE THE TOP      *14620099
146300*    ITEM NUMBER FOR THE NEW PAGE.  IF THE USER ATTEMPTS TO GO   *14630099
146400*    PAST THE END, ISSUE THE BOTTOM OF LIST MESSAGE.             *14640099
146500*----------------------------------------------------------------*14650099
146600*                                                                 14660099
146700 2120-BROWSE-FORWARD.                                             14670099
146800     ADD PC-ITEMS-PER-PANEL ASC-ITEM-AT-TOP-OF-PANEL              14680099
146900         GIVING PV-TOP-ITEM.                                      14690099
147000                                                                  14700099
147100     IF  PV-TOP-ITEM > ASC-NUMBER-OF-ITEMS-READ                   14710099
147200         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            14720099
147300                                   TO PV-TOP-ITEM                 14730099
147400*        -- BOTTOM OF LIST --                                     14740099
147500         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            14750099
147600         SET DP020-MSG-INFORMATIONAL                              14760099
147700                                   TO TRUE                        14770099
147800     ELSE                                                         14780099
147900         COMPUTE PV-BOTTOM-ITEM =                                 14790099
148000             PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1                 14800099
148100         IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ            14810099
148200*            -- BOTTOM OF LIST --                                 14820099
148300             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            14830099
148400             SET DP020-MSG-INFORMATIONAL                          14840099
148500                                   TO TRUE                        14850099
148600         END-IF                                                   14860099
148700     END-IF.                                                      14870099
148800 EJECT                                                            14880099
148900*                                                                 14890099
149000*                                                                 14900099
149100*----------------------------------------------------------------*14910099
149200*    THE USER CAN CHANGE THE CURRENT BEGINNING LIST NUMBER SO    *14920099
149300*    THAT THE TRANSACTION WILL JUMP TO THAT POINT IN THE LIST.   *14930099
149400*    THIS IS A FASTER WAY TO GET TO A CERTAIN POINT IN THE LIST  *14940099
149500*    RATHER THAN HITTING NEXT-PAGE TO GET TO THAT POINT.         *14950099
149600*    THE NEW LIST NUMBER ENTERED IS EDITED TO MAKE SURE THAT     *14960099
149700*    IT IS NUMERIC AND FALLS BETWEEN A SPECIFIED RANGE.          *14970099
149800*----------------------------------------------------------------*14980099
149900*                                                                 14990099
150000 2130-CHECK-FOR-JUMP-BROWSE.                                      15000099
150100     SET PS-NO-ERROR               TO TRUE.                       15010099
150200     IF (ASC-START-ITEM-REQUEST = SPACE)                          15020099
150300         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            15030099
150400                                   TO PV-TOP-ITEM                 15040099
150500     ELSE                                                         15050099
150600         MOVE ASC-START-ITEM-REQUEST                              15060099
150700                                   TO DP010I-UNEDITED-FIELD       15070099
150800         MOVE PC-MSG-NUMBER-LENGTH TO DP010I-MAXIMUM-DIGITS       15080099
150900         MOVE +0                   TO DP010I-MAXIMUM-DECIMALS     15090099
151000         SET DP010I-NEGATIVE-NOT-ALLOWED                          15100099
151100                                   TO TRUE                        15110099
263968         CALL DP010I-NUMERIC-EDIT-ROUTINE                         15121099
263968              USING DP010I-NUMERIC-EDIT-AREA                      15122099
151300                                                                  15130099
151400         IF  NOT DP010I-ERROR-DETECTED                            15140099
151500             MOVE DP010I-NUMERIC-FIELD                            15150099
151600                                   TO ASC-START-ITEM-REQUEST-N    15160099
151700             IF  ASC-START-ITEM-REQUEST-N > ZERO                  15170099
151800                 IF  ASC-START-ITEM-REQUEST-N >                   15180099
151900                                          ASC-NUMBER-OF-ITEMS-READ15190099
152000                     MOVE SPACE TO ASC-START-ITEM-REQUEST         15200099
152100                     COMPUTE PV-TOP-ITEM =                        15210099
152200                             ASC-NUMBER-OF-ITEMS-READ             15220099
152300                             - PC-ITEMS-PER-PANEL + 1             15230099
152400                     IF  PV-TOP-ITEM < +1                         15240099
152500                         MOVE +1   TO PV-TOP-ITEM                 15250099
152600                         MOVE PC-TSYMSG-00070                     15260099
152700                                   TO DP020-MSG-NUMBER            15270099
152800                         SET DP020-MSG-INFORMATIONAL              15280099
152900                                   TO TRUE                        15290099
153000                     END-IF                                       15300099
153100                 ELSE                                             15310099
153200                     MOVE ASC-START-ITEM-REQUEST-N                15320099
153300                                   TO PV-TOP-ITEM                 15330099
153400                     MOVE SPACE    TO ASC-START-ITEM-REQUEST      15340099
153500                     COMPUTE PV-BOTTOM-ITEM =                     15350099
153600                         PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1     15360099
153700                     IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ15370099
153800*                        -- BOTTOM OF LIST --                     15380099
153900                         MOVE PC-TSYMSG-00070                     15390099
154000                                   TO DP020-MSG-NUMBER            15400099
154100                         SET DP020-MSG-INFORMATIONAL              15410099
154200                                   TO TRUE                        15420099
154300                     END-IF                                       15430099
154400                 END-IF                                           15440099
154500             ELSE                                                 15450099
154600*                --- VALUE OUT OF RANGE ----                      15460099
154700                 MOVE PC-TSYMSG-00101                             15470099
154800                                   TO DP020-MSG-NUMBER            15480099
154900                 MOVE -1           TO ASTRTITL                    15490099
155000                 SET DP030-SET-CURSOR-APPL-1                      15500099
155100                                   TO TRUE                        15510099
155200                 MOVE DP015-REVERSE                               15520099
155300                                   TO ASTRTITH                    15530099
155400                 MOVE DP015-RED    TO ASTRTITC                    15540099
155500                 MOVE DP015-UNP-NUM-BRT-MDT                       15550099
155600                                   TO ASTRTITA                    15560099
155700                 SET DP020-MSG-FATAL                              15570099
155800                                   TO TRUE                        15580099
155900                 SET PS-ERROR      TO TRUE                        15590099
156000             END-IF                                               15600099
156100                                                                  15610099
156200         ELSE                                                     15620099
156300             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            15630099
156400             MOVE -1               TO ASTRTITL                    15640099
156500             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  15650099
156600             MOVE DP015-REVERSE    TO ASTRTITH                    15660099
156700             MOVE DP015-RED        TO ASTRTITC                    15670099
156800             MOVE DP015-UNP-NUM-BRT-MDT                           15680099
156900                                   TO ASTRTITA                    15690099
157000             SET DP020-MSG-FATAL   TO TRUE                        15700099
157100             SET PS-ERROR          TO TRUE                        15710099
157200         END-IF                                                   15720099
157300     END-IF.                                                      15730099
157400 EJECT                                                            15740099
157500*                                                                 15750099
157600*                                                                 15760099
157700*----------------------------------------------------------------*15770099
157800*    IF THE USER HITS THE DESELECT KEY, CLEAR THE SELECTION      *15780099
157900*    SWITCH FOR ALL ITEMS THAT WERE PREVIOUSLY SELECTED.         *15790099
158000*    (F9)                                                        *15800099
158100*----------------------------------------------------------------*15810099
158200*                                                                 15820099
158300 2140-DESELECT-ALL-ITEMS.                                         15830099
158400     MOVE +1                       TO ASC-BLK-SUB.                15840099
158500                                                                  15850099
158600     PERFORM 2141-CLEAR-SELECTED-INDS                             15860099
158700         VARYING ASC-ITEM-SUB                                     15870099
158800         FROM 1 BY 1                                              15880099
158900         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 15890099
159000                                                                  15900099
159100     ADD +1                        TO ASC-BLK-SUB.                15910099
159200                                                                  15920099
159300     PERFORM 2141-CLEAR-SELECTED-INDS                             15930099
159400         VARYING ASC-ITEM-SUB                                     15940099
159500         FROM 1 BY 1                                              15950099
159600         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 15960099
159700                                                                  15970099
159800     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               15980099
159900                                   TO PV-LIST-ITEM-NUMBER.        15990099
160000                                                                  16000099
160100     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            16010099
160200         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    16020099
160300                                                                  16030099
160400     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     16040099
160500        (ASC-HIGHEST-BLOCK-WRITTEN > PC-MAX-BLOCKS-IN-ARRAY)      16050099
160600         MOVE +1                   TO ASC-BLK-SUB                 16060099
160700                                                                  16070099
160800         PERFORM 5100-WRITE-TEMP-STORAGE                          16080099
160900                                                                  16090099
161000         MOVE +1                   TO PV-BLOCK-NUMBER             16100099
161100                                                                  16110099
161200         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         16120099
161300             PV-FIRST-BLOCK-IN-ARRAY - 1                          16130099
161400                                                                  16140099
161500         PERFORM                                                  16150099
161600             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       16160099
161700                                                                  16170099
161800             PERFORM 4410-READ-TEMP-STORAGE                       16180099
161900                                                                  16190099
162000             PERFORM 2141-CLEAR-SELECTED-INDS                     16200099
162100                 VARYING ASC-ITEM-SUB FROM 1 BY 1                 16210099
162200                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          16220099
162300                                                                  16230099
162400             PERFORM 5100-WRITE-TEMP-STORAGE                      16240099
162500                                                                  16250099
162600             ADD +1                TO PV-BLOCK-NUMBER             16260099
162700                                                                  16270099
162800         END-PERFORM                                              16280099
162900                                                                  16290099
163000         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         16300099
163100             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     16310099
163200                                                                  16320099
163300         PERFORM                                                  16330099
163400             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       16340099
163500                   ASC-HIGHEST-BLOCK-WRITTEN                      16350099
163600                                                                  16360099
163700             MOVE PV-NEXT-BLOCK-IN-ARRAY                          16370099
163800                                   TO PV-BLOCK-NUMBER             16380099
163900                                                                  16390099
164000             PERFORM 4410-READ-TEMP-STORAGE                       16400099
164100                                                                  16410099
164200             PERFORM 2141-CLEAR-SELECTED-INDS                     16420099
164300                 VARYING ASC-ITEM-SUB                             16430099
164400                 FROM 1 BY 1                                      16440099
164500                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          16450099
164600                                                                  16460099
164700             PERFORM 5100-WRITE-TEMP-STORAGE                      16470099
164800                                                                  16480099
164900             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      16490099
165000                                                                  16500099
165100         END-PERFORM                                              16510099
165200                                                                  16520099
165300         MOVE PV-FIRST-BLOCK-IN-ARRAY                             16530099
165400                                   TO PV-BLOCK-NUMBER             16540099
165500                                                                  16550099
165600         PERFORM 4410-READ-TEMP-STORAGE                           16560099
165700     END-IF.                                                      16570099
165800                                                                  16580099
165900                                                                  16590099
166000     MOVE +0                      TO ASC-NUMBER-OF-SELECTED-ITEMS.16600099
166100     MOVE +0                      TO ASC-START-OF-SELECTED-RANGE. 16610099
166200     MOVE +0                      TO ASC-END-OF-SELECTED-RANGE.   16620099
166300                                                                  16630099
166400     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        16640099
166500                                                                  16650099
166600 EJECT                                                            16660099
166700*                                                                 16670099
166800*                                                                 16680099
166900*----------------------------------------------------------------*16690099
167000*    MARK EACH ITEM AS BEING NOT SELECTED.                       *16700099
167100*----------------------------------------------------------------*16710099
167200*                                                                 16720099
167300 2141-CLEAR-SELECTED-INDS.                                        16730099
167400     IF  ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB ASC-ITEM-SUB)          16740099
167500             NOT EQUAL ZERO                                       16750099
167600         IF  NOT ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          16760099
167700             SET ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          16770099
167800                 ASC-TEMP-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)    16780099
167900                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  16790099
168000                                   TO TRUE                        16800099
168100         END-IF                                                   16810099
168200     END-IF.                                                      16820099
168300                                                                  16830099
168400 EJECT                                                            16840099
168500*                                                                 16850099
168600*                                                                 16860099
168700*----------------------------------------------------------------*16870099
168800*  IF THE USER HITS THE SELECT-ALL KEY, SET THE SELECTIO SWITCH  *16880099
168900*  FOR ALL ITEMS (F21).                                          *16890099
169000*----------------------------------------------------------------*16900099
169200 2150-SELECT-ALL-ITEMS.                                           16920099
169300     MOVE +1                       TO ASC-BLK-SUB.                16930099
169400                                                                  16940099
169500     PERFORM 2151-SET-SELECTED-INDS                               16950099
169600         VARYING ASC-ITEM-SUB                                     16960099
169700         FROM 1 BY 1                                              16970099
169800         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 16980099
169900                                                                  16990099
170000     ADD +1                        TO ASC-BLK-SUB.                17000099
170100                                                                  17010099
170200     PERFORM 2151-SET-SELECTED-INDS                               17020099
170300         VARYING ASC-ITEM-SUB                                     17030099
170400         FROM 1 BY 1                                              17040099
170500         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 17050099
170600                                                                  17060099
170700     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               17070099
170800                                   TO PV-LIST-ITEM-NUMBER.        17080099
170900                                                                  17090099
171000     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            17100099
171100         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    17110099
171200                                                                  17120099
171210* 5/28/2004 - BEGIN - DMH                                         17121099
171220     IF  PV-FIRST-BLOCK-IN-ARRAY  = +1                            17122099
171230         MOVE +1                   TO ASC-BLK-SUB                 17123099
171240                                                                  17124099
171250         PERFORM 5100-WRITE-TEMP-STORAGE                          17125099
171260         MOVE +2                   TO ASC-BLK-SUB                 17126099
171270         PERFORM 5100-WRITE-TEMP-STORAGE                          17127099
171280         MOVE +1                   TO ASC-BLK-SUB                 17128099
171290         MOVE +1                   TO PV-BLOCK-NUMBER             17129099
171291     END-IF.                                                      17129199
171292* 5/28/2004 - END - DMH                                           17129299
171293                                                                  17129399
171300     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     17130099
171400        (ASC-HIGHEST-BLOCK-WRITTEN >   PC-MAX-BLOCKS-IN-ARRAY)    17140099
171500         MOVE +1                   TO ASC-BLK-SUB                 17150099
171600                                                                  17160099
171700         PERFORM 5100-WRITE-TEMP-STORAGE                          17170099
171710         MOVE +2                   TO ASC-BLK-SUB                 17171099
171720         PERFORM 5100-WRITE-TEMP-STORAGE                          17172099
171730         MOVE +1                   TO ASC-BLK-SUB                 17173099
171740         MOVE +1                   TO PV-BLOCK-NUMBER             17174099
171800                                                                  17180099
172100         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         17210099
172110             PV-FIRST-BLOCK-IN-ARRAY - 1                          17211099
172120                                                                  17212099
172130         PERFORM                                                  17213099
172140             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       17214099
172150                                                                  17215099
172160             PERFORM 4410-READ-TEMP-STORAGE                       17216099
172170                                                                  17217099
172180             PERFORM 2151-SET-SELECTED-INDS                       17218099
172190                 VARYING ASC-ITEM-SUB                             17219099
172191                 FROM 1 BY 1                                      17219199
172192                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          17219299
172193                                                                  17219399
172194             PERFORM 5100-WRITE-TEMP-STORAGE                      17219499
172195                                                                  17219599
172196             ADD +1                TO PV-BLOCK-NUMBER             17219699
172197                                                                  17219799
172198         END-PERFORM                                              17219899
172199                                                                  17219999
172200         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         17220099
172201             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     17220199
172202                                                                  17220299
172203         PERFORM                                                  17220399
172204             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       17220499
172205                   ASC-HIGHEST-BLOCK-WRITTEN                      17220599
172206                                                                  17220699
172207             MOVE PV-NEXT-BLOCK-IN-ARRAY                          17220799
172208                                   TO PV-BLOCK-NUMBER             17220899
172209                                                                  17220999
172210             PERFORM 4410-READ-TEMP-STORAGE                       17221099
172211                                                                  17221199
172212             PERFORM 2151-SET-SELECTED-INDS                       17221299
172213                 VARYING ASC-ITEM-SUB                             17221399
172214                 FROM 1 BY 1                                      17221499
172215                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          17221599
172216                                                                  17221699
172217             PERFORM 5100-WRITE-TEMP-STORAGE                      17221799
172218                                                                  17221899
172219             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      17221999
172220                                                                  17222099
172221         END-PERFORM                                              17222199
172222                                                                  17222299
172223         MOVE PV-FIRST-BLOCK-IN-ARRAY                             17222399
172224                                   TO PV-BLOCK-NUMBER             17222499
172225                                                                  17222599
172226         PERFORM 4410-READ-TEMP-STORAGE                           17222699
172227     END-IF.                                                      17222799
172228                                                                  17222899
172229                                                                  17222999
172230     MOVE ASC-NUMBER-OF-ITEMS-READ TO                             17223099
172231                       ASC-NUMBER-OF-SELECTED-ITEMS.              17223199
172232                                                                  17223299
178200     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        17820099
178300                                                                  17830099
178600*                                                                 17860099
178700*----------------------------------------------------------------*17870099
178800*    MARK EACH ITEM AS BEING SELECTED.                           *17880099
178900*----------------------------------------------------------------*17890099
179000*                                                                 17900099
179100 2151-SET-SELECTED-INDS.                                          17910099
179200                                                                  17920099
179300     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           17930099
179400             NOT EQUAL ZERO                                       17940099
179500         IF  NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             17950099
179600             SET ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             17960099
179700                 ASC-TEMP-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)        17970099
179800                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  17980099
179900                                   TO TRUE                        17990099
180000         END-IF                                                   18000099
180100     END-IF.                                                      18010099
180200                                                                  18020099
180500*                                                                 18050099
180600*----------------------------------------------------------------*18060099
180700*  MOVE ALL OF THE FIELDS THAT WERE ENTERED / CHANGED ON THE     *18070099
180800*  SCREEN INTO THE COMMAREA.  ALL EDITING IS DONE IN THE COMM.   *18080099
180900*----------------------------------------------------------------*18090099
181000 2200-MOVE-SCREEN-TO-COMMAREA.                                    18100099
181100     MOVE PV-TOP-ITEM              TO PV-ITEM-IN-USE.             18110099
181200     MOVE +1                       TO PV-SUB.                     18120099
181300                                                                  18130099
181400     PERFORM 3100-SET-SUBSCRIPTS.                                 18140099
181500                                                                  18150099
181600     IF  ASTRTITL > ZERO                                          18160099
181700         MOVE ASTRTITI             TO ASC-START-ITEM-REQUEST      18170099
181800     ELSE                                                         18180099
181900         IF  ASTRTITF = DP015-ERASE-EOF                           18190099
182000             INITIALIZE ASC-START-ITEM-REQUEST                    18200099
182100         END-IF                                                   18210099
182200     END-IF.                                                      18220099
182300                                                                  18230099
182400     PERFORM 2210-MOVE-LINES-TO-COMMAREA                          18240099
182500         VARYING PV-SUB                                           18250099
182600         FROM 1 BY 1                                              18260099
182700         UNTIL PV-SUB > ASC-ITEMS-DISPLAYED.                      18270099
182800*                                                                 18280099
182900*                                                                 18290099
183000*----------------------------------------------------------------*18300099
183100*  MOVE THE ENTERABLE FIELDS ON EACH LIST LINE INTO THE COMMAREA *18310099
183200*----------------------------------------------------------------*18320099
183300 2210-MOVE-LINES-TO-COMMAREA.                                     18330099
183400     IF  MR-SELECTL (PV-SUB) > ZERO                               18340099
183500         SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE             18350099
183600         MOVE MR-SELECTI (PV-SUB)  TO ASC-TEMP-SELECTED-SW        18360099
183800                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      18380099
183900     ELSE                                                         18390099
184000         IF  MR-SELECTA (PV-SUB) = DP015-ERASE-EOF                18400099
184100                 SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE     18410099
184200                 MOVE SPACE        TO ASC-TEMP-SELECTED-SW        18420099
184300                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      18430099
184400         END-IF                                                   18440099
184500     END-IF.                                                      18450099
184600                                                                  18460099
184700     ADD +1                        TO ASC-ITEM-SUB.               18470099
184800     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        18480099
184810         IF  ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                     18481099
184820             COMPUTE PV-BLOCK-NUMBER  =                           18482099
184830                1 + ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) /         18483099
184840                    PC-ITEMS-PER-PANEL                            18484099
184850             PERFORM 5105-REWRITE-ASC-LISTQ                       18485099
184860         END-IF                                                   18486099
184900         ADD +1                    TO ASC-BLK-SUB                 18490099
185000         MOVE +1                   TO ASC-ITEM-SUB                18500099
185010     ELSE                                                         18501099
185020     IF  PV-SUB = ASC-ITEMS-DISPLAYED                             18502099
185030         IF  ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                     18503099
185040             COMPUTE PV-BLOCK-NUMBER  =                           18504099
185050                1 + ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) /         18505099
185060                    PC-ITEMS-PER-PANEL                            18506099
185070             PERFORM 5105-REWRITE-ASC-LISTQ                       18507099
185080         END-IF                                                   18508099
185100     END-IF.                                                      18510099
185300                                                                  18530099
185400*----------------------------------------------------------------*18540099
185500*  EDIT ALL OF THE DATA ON THE SCREEN AS IT RESIDES IN THE       *18550099
185600*  COMMAREA (EDITING IS NOT DONE AGAINST THE SCREEN DIRECTLY).   *18560099
185700*----------------------------------------------------------------*18570099
185800 3000-EDIT-DATA-IN-COMMAREA.                                      18580099
185900     SET PS-NO-ERROR               TO TRUE.                       18590099
186000     PERFORM 3200-RESET-ATTRIBUTES.                               18600099
186100     MOVE ASC-ITEMS-DISPLAYED      TO PV-SUB.                     18610099
186200                                                                  18620099
186300**                                                                18630099
186400* CALCULATE THE POSITION OF THE LAST ITEM DISPLAYED.              18640099
186500* EDITING IS DONE FROM THE BOTTOM UP.                             18650099
186600**                                                                18660099
186700     COMPUTE PV-ITEM-IN-USE = PV-TOP-ITEM +                       18670099
186800         ASC-ITEMS-DISPLAYED - 1.                                 18680099
186900     PERFORM 3100-SET-SUBSCRIPTS.                                 18690099
187000                                                                  18700099
187100     IF  PS-NO-ERROR                                              18710099
187200         PERFORM 3005-EDIT-COMMAREA-BLOCKS                        18720099
187300     END-IF.                                                      18730099
187400                                                                  18740099
187500     IF  PS-NO-ERROR                                              18750099
187600         PERFORM 3400-CHECK-RANGE-SEQUENCE                        18760099
187700     END-IF.                                                      18770099
187800*                                                                 18780099
187900     IF  ((PS-NO-ERROR)                                           18790099
188000       AND (ASC-START-OF-SELECTED-RANGE > ZERO)                   18800099
188100       AND (ASC-END-OF-SELECTED-RANGE > ZERO))                    18810099
188200             PERFORM 3500-MARK-RANGE-AS-SELECTED                  18820099
188300     END-IF.                                                      18830099
188400*                                                                 18840099
188500*                                                                 18850099
188600*----------------------------------------------------------------*18860099
188700*   3005-EDIT-COMMAREA-BLOCKS                                    *18870099
188800*----------------------------------------------------------------*18880099
188900 3005-EDIT-COMMAREA-BLOCKS.                                       18890099
189000     MOVE +1                       TO PV-BLOCK-NUMBER.            18900099
189100     MOVE +1                       TO ASC-BLK-SUB.                18910099
189200     MOVE PC-ITEMS-PER-PANEL       TO ASC-ITEM-SUB.               18920099
189300                                                                  18930099
189400     COMPUTE PV-BLOCK-NUMBER  =                                   18940099
189500        1 + ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) /                 18950099
189600            PC-ITEMS-PER-PANEL.                                   18960099
189700                                                                  18970099
189800     MOVE  PV-BLOCK-NUMBER         TO PV-ORIGINAL-BLOCK.          18980099
189900                                                                  18990099
190000     PERFORM                                                      19000099
190100       UNTIL PV-BLOCK-NUMBER > ASC-HIGHEST-BLOCK-WRITTEN          19010099
190200          OR PS-ERROR                                             19020099
190300          OR PS-BLOCK-ERROR                                       19030099
190400                                                                  19040099
190500             COMPUTE PV-ITEMS-HOLD  =                             19050099
190600                     ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) +        19060099
190700                     PC-ITEMS-PER-PANEL - 1                       19070099
190800                                                                  19080099
190900             IF  PV-ITEMS-HOLD  >  ASC-NUMBER-OF-ITEMS-READ       19090099
191000                 SUBTRACT  ASC-NUMBER-OF-ITEMS-READ               19100099
191100                     FROM  PV-ITEMS-HOLD                          19110099
191200                   GIVING  PV-ITEMS-DIFF                          19120099
191300                 SUBTRACT  PV-ITEMS-DIFF                          19130099
191400                     FROM  PC-ITEMS-PER-PANEL                     19140099
191500                   GIVING  PV-ITEMS-HOLD                          19150099
191600                     MOVE  PV-ITEMS-HOLD  TO  PV-SUB              19160099
191700                                              ASC-ITEM-SUB        19170099
191800                                              ASC-ITEMS-DISPLAYED 19180099
191900             ELSE                                                 19190099
192000                 MOVE ASC-ITEMS-DISPLAYED  TO PV-SUB              19200099
192100                 MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB        19210099
192200             END-IF                                               19220099
192300                                                                  19230099
192400             PERFORM 3300-EDIT-SELECTIONS                         19240099
192500                     VARYING PV-SUB                               19250099
192600                        FROM PV-SUB BY -1                         19260099
192700                       UNTIL PV-SUB < +1                          19270099
192800                                                                  19280099
192900             MOVE +1               TO ASC-BLK-SUB                 19290099
193000                                                                  19300099
193100             PERFORM 5105-REWRITE-ASC-LISTQ                       19310099
193200                                                                  19320099
193300             MOVE +1                TO ASC-BLK-SUB                19330099
193400                                                                  19340099
193500             IF  PS-BLOCK-ERROR                                   19350099
193600                 SET  PS-ERROR     TO TRUE                        19360099
193700                 MOVE ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB 1)        19370099
193800                                   TO PV-TOP-ITEM                 19380099
193900             ELSE                                                 19390099
194000                 ADD  +1           TO PV-BLOCK-NUMBER             19400099
194100                 IF  PV-BLOCK-NUMBER >                            19410099
194200                     ASC-HIGHEST-BLOCK-WRITTEN                    19420099
194300                     MOVE +2       TO ASC-BLK-SUB                 19430099
194400                     PERFORM 4410-READ-TEMP-STORAGE               19440099
194500                     MOVE +1       TO ASC-BLK-SUB                 19450099
194600                 ELSE                                             19460099
194700                     PERFORM 4410-READ-TEMP-STORAGE               19470099
194800                     ADD  +1        TO PV-BLOCK-NUMBER            19480099
194900                     MOVE +2        TO ASC-BLK-SUB                19490099
195000                     PERFORM 4410-READ-TEMP-STORAGE               19500099
195100                     SUBTRACT +1  FROM PV-BLOCK-NUMBER            19510099
195200                     MOVE +1        TO ASC-BLK-SUB                19520099
195300                 END-IF                                           19530099
195400             END-IF                                               19540099
195500     END-PERFORM.                                                 19550099
195600                                                                  19560099
195700     IF  PV-ORIGINAL-BLOCK  = +1    OR                            19570099
195800         PS-ERROR                   OR                            19580099
195900         PS-BLOCK-ERROR                                           19590099
196000         CONTINUE                                                 19600099
196100     ELSE                                                         19610099
196200         MOVE +1                 TO PV-BLOCK-NUMBER               19620099
196300         MOVE +1                 TO ASC-BLK-SUB                   19630099
196400         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  19640099
196500         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEMS-DISPLAYED           19650099
196600         PERFORM 4410-READ-TEMP-STORAGE                           19660099
196700                                                                  19670099
196800         PERFORM                                                  19680099
196900           UNTIL PV-BLOCK-NUMBER = PV-ORIGINAL-BLOCK              19690099
197000              OR PS-ERROR                                         19700099
197100              OR PS-BLOCK-ERROR                                   19710099
197200                                                                  19720099
197300                 COMPUTE PV-ITEMS-HOLD  =                         19730099
197400                         ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) +    19740099
197500                         PC-ITEMS-PER-PANEL - 1                   19750099
197600                                                                  19760099
197700                 IF  PV-ITEMS-HOLD > ASC-NUMBER-OF-ITEMS-READ     19770099
197800                     SUBTRACT  ASC-NUMBER-OF-ITEMS-READ           19780099
197900                         FROM  PV-ITEMS-HOLD                      19790099
198000                       GIVING  PV-ITEMS-DIFF                      19800099
198100                     SUBTRACT  PV-ITEMS-DIFF                      19810099
198200                         FROM  PC-ITEMS-PER-PANEL                 19820099
198300                       GIVING  PV-ITEMS-HOLD                      19830099
198400                         MOVE  PV-ITEMS-HOLD TO PV-SUB            19840099
198500                                                ASC-ITEM-SUB      19850099
198600                                               ASC-ITEMS-DISPLAYED19860099
198700                 ELSE                                             19870099
198800                     MOVE ASC-ITEMS-DISPLAYED  TO PV-SUB          19880099
198900                     MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB    19890099
199000                 END-IF                                           19900099
199100                                                                  19910099
199200                 PERFORM 3300-EDIT-SELECTIONS                     19920099
199300                         VARYING PV-SUB                           19930099
199400                            FROM PV-SUB BY -1                     19940099
199500                           UNTIL PV-SUB < +1                      19950099
199600                                                                  19960099
199700                 MOVE +1               TO ASC-BLK-SUB             19970099
199800                                                                  19980099
199900                 PERFORM 5105-REWRITE-ASC-LISTQ                   19990099
200000                                                                  20000099
200100                 MOVE +1                TO ASC-BLK-SUB            20010099
200200                                                                  20020099
200300                 IF  PS-BLOCK-ERROR                               20030099
200400                     SET  PS-ERROR     TO TRUE                    20040099
200500                     MOVE ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB 1)    20050099
200600                                       TO PV-TOP-ITEM             20060099
200700                 ELSE                                             20070099
200800                     ADD  +1            TO PV-BLOCK-NUMBER        20080099
200900                     IF  PV-BLOCK-NUMBER = PV-ORIGINAL-BLOCK      20090099
201000                         MOVE +2        TO ASC-BLK-SUB            20100099
201100                         PERFORM 4410-READ-TEMP-STORAGE           20110099
201200                         MOVE +1        TO ASC-BLK-SUB            20120099
201300                     ELSE                                         20130099
201400                         PERFORM 4410-READ-TEMP-STORAGE           20140099
201500                         ADD  +1        TO PV-BLOCK-NUMBER        20150099
201600                         MOVE +2        TO ASC-BLK-SUB            20160099
201700                         PERFORM 4410-READ-TEMP-STORAGE           20170099
201800                         SUBTRACT +1  FROM PV-BLOCK-NUMBER        20180099
201900                         MOVE +1        TO ASC-BLK-SUB            20190099
202000                     END-IF                                       20200099
202100                 END-IF                                           20210099
202200     END-PERFORM.                                                 20220099
202300*                                                                 20230099
202400*                                                                 20240099
202500*----------------------------------------------------------------*20250099
202600*    DETERMINE THE VALUE OF THE ITEM SUBSCRIPT BASED ON THE ITEM *20260099
202700*    CURRENTLY IN USE AND THE FIRST ITEM IN THE ARRAY.  THIS WILL*20270099
202800*    POSITION US IN THE 1ST BLOCK OF THE ARRAY.                  *20280099
202900*                                                                *20290099
203000*    IF THE ITEM SUBSCRIPT EXCEEDS THE MAXIMUM NUMBER OF ITEMS   *20300099
203100*    IN A BLOCK, RECALCULATE THE SUBSCRIPT BY SUBTRACTING OUT    *20310099
203200*    THE MAXIMUM NUMBER OF ITEMS.  THIS WILL CORRECTLY POSITION  *20320099
203300*    US IN THE 2ND BLOCK OF THE ARRAY.                           *20330099
203400*----------------------------------------------------------------*20340099
203500*                                                                 20350099
203600 3100-SET-SUBSCRIPTS.                                             20360099
203700     COMPUTE ASC-ITEM-SUB =                                       20370099
203800         (PV-ITEM-IN-USE - ASC-LIST-ITEM-NUMBER(1 1)) + 1.        20380099
203900                                                                  20390099
204000     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         20400099
204100         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            20410099
204200                                                                  20420099
204300         MOVE PC-MAX-BLOCKS-IN-ARRAY TO ASC-BLK-SUB               20430099
204400     ELSE                                                         20440099
204500         MOVE +1                     TO ASC-BLK-SUB               20450099
204600     END-IF.                                                      20460099
204700*                                                                 20470099
204800*                                                                 20480099
204900*----------------------------------------------------------------*20490099
205000*  RESET THE ATTRIBUTES OF ALL ENTERABLE FIELDS ON THE MAP.      *20500099
205100*----------------------------------------------------------------*20510099
205200 3200-RESET-ATTRIBUTES.                                           20520099
205300     MOVE DP015-UNP-ALP-NOR-OFF    TO ASTRTITA.                   20530099
205400     MOVE DP015-GREEN              TO ASTRTITC.                   20540099
205500     MOVE DP015-UNDERLINE          TO ASTRTITH.                   20550099
205600                                                                  20560099
205700     PERFORM                                                      20570099
205800         VARYING PV-SUB                                           20580099
205900         FROM 1 BY 1                                              20590099
206000         UNTIL PV-SUB > PC-ITEMS-PER-PANEL                        20600099
206100         MOVE DP015-UNP-ALP-NOR-OFF                               20610099
206200                                   TO MR-SELECTA (PV-SUB)         20620099
206300         MOVE DP015-GREEN          TO MR-SELECTC (PV-SUB)         20630099
206400         MOVE DP015-UNDERLINE      TO MR-SELECTH (PV-SUB)         20640099
206500         MOVE DP015-HL-OFF         TO MR-SCACH (PV-SUB)           20650099
206600         MOVE DP015-BLUE           TO MR-SCACC (PV-SUB)           20660099
206700     END-PERFORM.                                                 20670099
206800*                                                                 20680099
206900*                                                                 20690099
207000*----------------------------------------------------------------*20700099
207100*  EDIT THE SELECTIONS MADE.  NOTE THAT THE 'SELECTED-SW' IS     *20710099
207200*  WHAT WAS PREVIOUSLY CHECKED AND CORRECT 'TEMP-SELECTED-SW'    *20720099
207300*  IS WHAT HAS JUST BEEN ENTERED AND HAS NOT BEEN EDITTED OR     *20730099
207400*  WAS ENTERED EARLIER, BUT DID NOT PASS THE EDITS.              *20740099
207500*----------------------------------------------------------------*20750099
207600*                                                                 20760099
207700 3300-EDIT-SELECTIONS.                                            20770099
207800     EVALUATE TRUE                                                20780099
207900         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     20790099
208000             = ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)         20800099
208100                 CONTINUE                                         20810099
208200                                                                  20820099
208300         WHEN ASC-TEMP-SELECT  (ASC-BLK-SUB ASC-ITEM-SUB)         20830099
208400             IF  NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)        20840099
208500                 ADD +1            TO ASC-NUMBER-OF-SELECTED-ITEMS20850099
208600                 MOVE ASC-TEMP-SELECTED-SW                        20860099
208700                                     (ASC-BLK-SUB ASC-ITEM-SUB)   20870099
208800                                   TO ASC-SELECTED-SW             20880099
208900                                     (ASC-BLK-SUB ASC-ITEM-SUB)   20890099
209000             END-IF                                               20900099
209100                                                                  20910099
209200         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     20920099
209300                 = SPACE                                          20930099
209400                                                                  20940099
209500             EVALUATE TRUE                                        20950099
209600                 WHEN ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)       20960099
209700                     SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS20970099
209800                     MOVE SPACE    TO ASC-SELECTED-SW             20980099
209900                                     (ASC-BLK-SUB ASC-ITEM-SUB)   20990099
210000                                                                  21000099
210100                 WHEN ASC-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)        21010099
210200                     MOVE ZERO     TO ASC-START-OF-SELECTED-RANGE 21020099
210300                     MOVE SPACE    TO ASC-SELECTED-SW             21030099
210400                                     (ASC-BLK-SUB ASC-ITEM-SUB)   21040099
210500                                                                  21050099
210600                 WHEN ASC-END (ASC-BLK-SUB ASC-ITEM-SUB)          21060099
210700                     MOVE ZERO     TO ASC-END-OF-SELECTED-RANGE   21070099
210800                     MOVE SPACE    TO ASC-SELECTED-SW             21080099
210900                                     (ASC-BLK-SUB ASC-ITEM-SUB)   21090099
211000             END-EVALUATE                                         21100099
211100                                                                  21110099
211200         WHEN ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)           21120099
211300             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            21130099
211400                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    21140099
211500             END-IF                                               21150099
211600             PERFORM 3310-EDIT-RANGE                              21160099
211700                                                                  21170099
211800         WHEN ASC-TEMP-END (ASC-BLK-SUB ASC-ITEM-SUB)             21180099
211900             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            21190099
212000                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    21200099
212100             END-IF                                               21210099
212200             PERFORM 3310-EDIT-RANGE                              21220099
212300                                                                  21230099
212400         WHEN OTHER                                               21240099
212500             MOVE PC-TSYMSG-00005  TO DP020-MSG-NUMBER            21250099
212600             SET DP020-MSG-FATAL   TO TRUE                        21260099
212700             MOVE -1               TO MR-SELECTL (PV-SUB)         21270099
212800             SET DP030-SET-CURSOR-APPL-1                          21280099
212900                                   TO TRUE                        21290099
213000             MOVE DP015-RED        TO MR-SELECTC (PV-SUB)         21300099
213100             MOVE DP015-REVERSE    TO MR-SELECTH (PV-SUB)         21310099
213200             SET PS-ERROR          TO TRUE                        21320099
213300             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            21330099
213400                 SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS     21340099
213500                 MOVE SPACE        TO ASC-SELECTED-SW             21350099
213600                                     (ASC-BLK-SUB ASC-ITEM-SUB)   21360099
213700             END-IF                                               21370099
213800     END-EVALUATE.                                                21380099
213900                                                                  21390099
214000                                                                  21400099
214100     SUBTRACT +1                   FROM PV-ITEM-IN-USE.           21410099
214200     SUBTRACT +1                   FROM ASC-ITEM-SUB.             21420099
214300                                                                  21430099
214400     IF  ASC-ITEM-SUB < 1                                         21440099
214500         SUBTRACT +1 FROM ASC-BLK-SUB                             21450099
214600         MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB                21460099
214700     END-IF.                                                      21470099
214800*                                                                 21480099
214900*                                                                 21490099
215000*----------------------------------------------------------------*21500099
215100*  IF A BEGINNING AND END OF RANGE WAS ENTERED TO SELECT A       *21510099
215200*  RANGE OF LINES, MAKE SURE THERE IS ONLY 1 BEGINNING AND 1     *21520099
215300*  ENDING AND MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN) *21530099
215400*  THE ENDING.                                                   *21540099
215500*----------------------------------------------------------------*21550099
215600*                                                                 21560099
215700 3310-EDIT-RANGE.                                                 21570099
215800     IF  ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)                21580099
215900         IF  ASC-START-OF-SELECTED-RANGE = ZERO                   21590099
216000             MOVE ASC-TEMP-SELECTED-SW  (ASC-BLK-SUB ASC-ITEM-SUB)21600099
216100                                   TO ASC-SELECTED-SW             21610099
216200                                        (ASC-BLK-SUB ASC-ITEM-SUB)21620099
216300             MOVE PV-ITEM-IN-USE   TO ASC-START-OF-SELECTED-RANGE 21630099
216400         ELSE                                                     21640099
216500             IF  ASC-START-OF-SELECTED-RANGE = PV-ITEM-IN-USE     21650099
216600                 CONTINUE                                         21660099
216700             ELSE                                                 21670099
216800*                -- ONLY ONE BEGINNING-OF-RANGE-ALLOWED --        21680099
216900                 MOVE PC-TSYMSG-00054                             21690099
217000                                       TO DP020-MSG-NUMBER        21700099
217100                 MOVE -1               TO ASTRTITL                21710099
217200                 SET DP020-MSG-FATAL                              21720099
217300                     DP030-SET-CURSOR-APPL-1                      21730099
217400                     PS-ERROR          TO TRUE                    21740099
217500             END-IF                                               21750099
217600         END-IF                                                   21760099
217700     ELSE                                                         21770099
217800         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     21780099
217900             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 21790099
218000                                   TO ASC-SELECTED-SW             21800099
218100                                     (ASC-BLK-SUB ASC-ITEM-SUB)   21810099
218200             MOVE PV-ITEM-IN-USE   TO ASC-END-OF-SELECTED-RANGE   21820099
218300         ELSE                                                     21830099
218400             IF  ASC-END-OF-SELECTED-RANGE = PV-ITEM-IN-USE       21840099
218500                 CONTINUE                                         21850099
218600             ELSE                                                 21860099
218700*                -- ONLY ONE END-OF-RANGE ALLOWED --              21870099
218800                 MOVE PC-TSYMSG-00055                             21880099
218900                                        TO DP020-MSG-NUMBER       21890099
219000                 MOVE -1                TO ASTRTITL               21900099
219100                 SET DP020-MSG-FATAL                              21910099
219200                     DP030-SET-CURSOR-APPL-1                      21920099
219300                     PS-ERROR           TO TRUE                   21930099
219400             END-IF                                               21940099
219500         END-IF                                                   21950099
219600     END-IF.                                                      21960099
219700*                                                                 21970099
219800*                                                                 21980099
219900*----------------------------------------------------------------*21990099
220000*  IF BOTH A BEGINNING AND END OF RANGE HAVE BEEN SPECIFIED,     *22000099
220100*  MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN) THE END.   *22010099
220200*----------------------------------------------------------------*22020099
220300*                                                                 22030099
220400 3400-CHECK-RANGE-SEQUENCE.                                       22040099
220500     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       22050099
220600       AND  ASC-END-OF-SELECTED-RANGE > ZERO                      22060099
220700       AND  ASC-START-OF-SELECTED-RANGE >                         22070099
220800                                         ASC-END-OF-SELECTED-RANGE22080099
220900*        -- END-OF-RANGE BEFORE BEGINNING-OF-RANGE                22090099
221000         MOVE PC-TSYMSG-00052      TO DP020-MSG-NUMBER            22100099
221100         SET DP020-MSG-FATAL       TO TRUE                        22110099
221200         SET PS-ERROR              TO TRUE                        22120099
221300         PERFORM 3410-POSITION-AT-ERROR                           22130099
221400     END-IF.                                                      22140099
221500*                                                                 22150099
221600*                                                                 22160099
221700*----------------------------------------------------------------*22170099
221800*  BECAUSE RANGES CAN SPAN ACROSS MULTIPLE PAGES, A SEPARATE     *22180099
221900*  PARAGRAPH (THIS ONE) IS NEEDED TO DETERMINE WHERE THE CURSOR  *22190099
222000*  SHOULD BE POSITIONED ON A RANGE ERROR.                        *22200099
222100*----------------------------------------------------------------*22210099
222200*                                                                 22220099
222300 3410-POSITION-AT-ERROR.                                          22230099
222400     SET DP030-SET-CURSOR-APPL-1                                  22240099
222500                                   TO TRUE.                       22250099
222600     MOVE -1                       TO ASTRTITL                    22260099
222700     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 22270099
222800                    - PV-TOP-ITEM + 1.                            22280099
222900     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      22290099
223000         CONTINUE                                                 22300099
223100     END-IF.                                                      22310099
223200*                                                                 22320099
223300     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   22330099
223400                    - PV-TOP-ITEM + 1.                            22340099
223500     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      22350099
223600         CONTINUE                                                 22360099
223700     END-IF.                                                      22370099
223800 EJECT                                                            22380099
223900*                                                                 22390099
224000*                                                                 22400099
224100*----------------------------------------------------------------*22410099
224200*    WHENEVER THE USER SELECTS AN ITEM AS THE BEGINNING RANGE    *22420099
224300*    AND ONE AS THE ENDING RANGE, MARK THESE ITEMS AS WELL AS    *22430099
224400*    THOSE THAT FALL IN THE RANGE AS BEING SELECTED.             *22440099
224500*----------------------------------------------------------------*22450099
224600*                                                                 22460099
224700 3500-MARK-RANGE-AS-SELECTED.                                     22470099
224800     MOVE +1                       TO ASC-BLK-SUB.                22480099
224900                                                                  22490099
225000     PERFORM 3510-MARK-SELECTED-INDS                              22500099
225100         VARYING ASC-ITEM-SUB                                     22510099
225200         FROM 1 BY 1                                              22520099
225300         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 22530099
225400                                                                  22540099
225500     ADD +1                        TO ASC-BLK-SUB.                22550099
225600                                                                  22560099
225700     PERFORM 3510-MARK-SELECTED-INDS                              22570099
225800         VARYING ASC-ITEM-SUB                                     22580099
225900         FROM 1 BY 1                                              22590099
226000         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 22600099
226100                                                                  22610099
226200     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               22620099
226300                                   TO PV-LIST-ITEM-NUMBER.        22630099
226400                                                                  22640099
226500     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            22650099
226600         1 + ((PV-LIST-ITEM-NUMBER - 1) /                         22660099
226700               PC-ITEMS-PER-PANEL).                               22670099
226800                                                                  22680099
226900     MOVE ASC-START-OF-SELECTED-RANGE                             22690099
227000                                   TO PV-START-OF-SELECTED-RANGE. 22700099
227100                                                                  22710099
227200     COMPUTE PV-FIRST-BLOCK-IN-RANGE =                            22720099
227300         1 + ((PV-START-OF-SELECTED-RANGE - 1) /                  22730099
227400               PC-ITEMS-PER-PANEL).                               22740099
227500                                                                  22750099
227600     MOVE ASC-END-OF-SELECTED-RANGE                               22760099
227700                                   TO PV-END-OF-SELECTED-RANGE.   22770099
227800                                                                  22780099
227900     COMPUTE PV-LAST-BLOCK-IN-RANGE =                             22790099
228000         1 + ((PV-END-OF-SELECTED-RANGE - 1) /                    22800099
228100               PC-ITEMS-PER-PANEL).                               22810099
228200                                                                  22820099
228300     COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                             22830099
228400         PV-FIRST-BLOCK-IN-ARRAY + 1.                             22840099
228500                                                                  22850099
228600     IF (PV-FIRST-BLOCK-IN-RANGE < PV-FIRST-BLOCK-IN-ARRAY) OR    22860099
228700        (PV-LAST-BLOCK-IN-RANGE  > PV-NEXT-BLOCK-IN-ARRAY)        22870099
228800         MOVE +1                   TO ASC-BLK-SUB                 22880099
228900         PERFORM 5100-WRITE-TEMP-STORAGE                          22890099
229000         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         22900099
229100             PV-FIRST-BLOCK-IN-ARRAY - 1                          22910099
229200                                                                  22920099
229300         PERFORM                                                  22930099
229400             UNTIL PV-FIRST-BLOCK-IN-RANGE >                      22940099
229500                   PV-PREV-BLOCK-IN-ARRAY                         22950099
229600             MOVE PV-FIRST-BLOCK-IN-RANGE                         22960099
229700                                   TO PV-BLOCK-NUMBER             22970099
229800             PERFORM 4410-READ-TEMP-STORAGE                       22980099
229900             PERFORM 3510-MARK-SELECTED-INDS                      22990099
230000                 VARYING ASC-ITEM-SUB                             23000099
230100                 FROM 1 BY 1                                      23010099
230200                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          23020099
230300             PERFORM 5100-WRITE-TEMP-STORAGE                      23030099
230400             ADD +1                TO PV-FIRST-BLOCK-IN-RANGE     23040099
230500         END-PERFORM                                              23050099
230600                                                                  23060099
230700         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         23070099
230800             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     23080099
230900         PERFORM                                                  23090099
231000             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       23100099
231100                   PV-LAST-BLOCK-IN-RANGE                         23110099
231200             MOVE PV-NEXT-BLOCK-IN-ARRAY                          23120099
231300                                   TO PV-BLOCK-NUMBER             23130099
231400             PERFORM 4410-READ-TEMP-STORAGE                       23140099
231500             PERFORM 3510-MARK-SELECTED-INDS                      23150099
231600                 VARYING ASC-ITEM-SUB                             23160099
231700                 FROM 1 BY 1                                      23170099
231800                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          23180099
231900             PERFORM 5100-WRITE-TEMP-STORAGE                      23190099
232000             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      23200099
232100         END-PERFORM                                              23210099
232200                                                                  23220099
232300         MOVE PV-FIRST-BLOCK-IN-ARRAY                             23230099
232400                                   TO PV-BLOCK-NUMBER             23240099
232500         PERFORM 4410-READ-TEMP-STORAGE                           23250099
232600     END-IF.                                                      23260099
232700                                                                  23270099
232800     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE 23280099
232900                                      ASC-END-OF-SELECTED-RANGE.  23290099
233000                                                                  23300099
233100 EJECT                                                            23310099
233200*                                                                 23320099
233300*                                                                 23330099
233400*----------------------------------------------------------------*23340099
233500* SET THE SELECTION INDICATOR TO 'S' WITHIN THE RANGE.           *23350099
233600*----------------------------------------------------------------*23360099
233700*                                                                 23370099
233800 3510-MARK-SELECTED-INDS.                                         23380099
233900     IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB) >         23390099
234000         ASC-START-OF-SELECTED-RANGE)                             23400099
234100     OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB) =         23410099
234200         ASC-START-OF-SELECTED-RANGE)                             23420099
234300                                                                  23430099
234400         IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB) <     23440099
234500             ASC-END-OF-SELECTED-RANGE)                           23450099
234600         OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB) =     23460099
234700             ASC-END-OF-SELECTED-RANGE)                           23470099
234800                                                                  23480099
234900             IF NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          23490099
235000                 SET ASC-SELECT     (ASC-BLK-SUB  ASC-ITEM-SUB)   23500099
235100                     ASC-TEMP-SELECT(ASC-BLK-SUB  ASC-ITEM-SUB)   23510099
235200                                   TO TRUE                        23520099
235300                 SET ASC-BLOCK-MODIFIED(ASC-BLK-SUB)              23530099
235400                                   TO TRUE                        23540099
235500                 ADD +1            TO ASC-NUMBER-OF-SELECTED-ITEMS23550099
235600             END-IF                                               23560099
235700         END-IF                                                   23570099
235800     END-IF.                                                      23580099
235900 EJECT                                                            23590099
236000*                                                                 23600099
236100*                                                                 23610099
236200*----------------------------------------------------------------*23620099
236300*    INITIALIZE BOTH BLOCKS IN THE ARRAY.                        *23630099
236400*    INITIALIZE ALL COUNTERS AND FLAGS.                          *23640099
236500*    READ THE DATA BASE FOR THE 1ST TIME AND FILL UP THE ARRAY.  *23650099
236600*    DISPLAY THE PANEL TO USER.                                  *23660099
236700*----------------------------------------------------------------*23670099
236800 4000-BUILD-INITIAL-PANEL.                                        23680099
236900     INITIALIZE ASC-BLOCK-ENTRIES (1)                             23690099
237000                ASC-BLOCK-ENTRIES (2).                            23700099
237100                                                                  23710099
237200     MOVE +1                       TO ASC-BLK-SUB.                23720099
237300                                                                  23730099
237400     SET ASC-ITEMS-LEFT-ON-DB      TO TRUE.                       23740099
237500                                                                  23750099
237600     MOVE +0                       TO ASC-ITEM-SUB                23760099
237700                                      ASC-NUMBER-OF-ITEMS-READ    23770099
237800                                      ASC-NUMBER-OF-SELECTED-ITEMS23780099
237900                                      ASC-HIGHEST-BLOCK-WRITTEN   23790099
238000                                      ASC-START-OF-SELECTED-RANGE 23800099
238100                                      ASC-END-OF-SELECTED-RANGE   23810099
238200                                      ASC-ITEM-AT-TOP-OF-PANEL.   23820099
238300                                                                  23830099
238400     PERFORM 4100-PREPARE-CURSOR.                                 23840099
238500*                                                                 23850099
238600     IF PC-TYPE5 = 'DP'                                           23860099
238700        MOVE 'ET' TO PC-TYPE5                                     23870099
238800     END-IF.                                                      23880099
238900                                                                  23890099
239000     PERFORM 4010-OPEN-CURSOR.                                    23900099
239100                                                                  23910099
239200     PERFORM 4300-READ-ITEMS-FROM-DB.                             23920099
239300                                                                  23930099
239400     PERFORM 4020-CLOSE-CURSOR.                                   23940099
239500                                                                  23950099
239600     MOVE +1                   TO  PV-TOP-ITEM.                   23960099
239700     IF  ASC-NUMBER-OF-ITEMS-READ = ZERO                          23970099
239800         SET DP020-NEXT-ACT-APPL-ERROR TO TRUE                    23980099
239900         SET DP020-MSG-FATAL   TO  TRUE                           23990099
240000         MOVE PC-TSYMSG-00050  TO  DP020-MSG-NUMBER               24000099
240100     ELSE                                                         24010099
240200         MOVE -1               TO MR-SELECTL (1)                  24020099
240300         SET DP030-SET-CURSOR-APPL-1                              24030099
240400                               TO TRUE                            24040099
240500         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                     24050099
240600     END-IF.                                                      24060099
240700 EJECT                                                            24070099
240800*                                                                 24080099
240900*                                                                 24090099
241000*----------------------------------------------------------------*24100099
241100* OPEN CURSORS THAT BUILD PANELS WITH INCOMING DATA.             *24110099
241200*----------------------------------------------------------------*24120099
241300 4010-OPEN-CURSOR.                                                24130099
241400     PERFORM                                                      24140099
241500         WITH TEST AFTER                                          24150099
241600         VARYING PV-RETRY-COUNTER                                 24160099
241700         FROM 1 BY 1                                              24170099
241800         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               24180099
241900                   OR (SQLCODE = ZERO))                           24190099
242000                                                                  24200099
242100         EVALUATE TRUE                                            24210099
242200             WHEN ASC-TRAILER-CURSOR                              24220099
242300                  MOVE 'CURSOR:  TRAILER-CURSOR'                  24230099
242400                                 TO DP013-MESSAGE-TEXT (2)        24240099
242500                  EXEC SQL                                        24250099
242600                       OPEN TRAILER-CSR                           24260099
242700                  END-EXEC                                        24270099
242800                                                                  24280099
242900             WHEN ASC-SCAC-TRAILER-CURSOR                         24290099
243000                  MOVE 'CURSOR:  SCAC-TRAILER-CURSOR'             24300099
243100                                 TO DP013-MESSAGE-TEXT (2)        24310099
243200                  EXEC SQL                                        24320099
243300                       OPEN SCAC-TRAILER-CSR                      24330099
243400                  END-EXEC                                        24340099
243500                                                                  24350099
243600             WHEN ASC-SCAC-CURSOR                                 24360099
243700                  MOVE 'CURSOR:  SCAC-CURSOR'                     24370099
243800                                 TO DP013-MESSAGE-TEXT (2)        24380099
243900                  EXEC SQL                                        24390099
244000                       OPEN SCAC-CSR                              24400099
244100                  END-EXEC                                        24410099
244200                                                                  24420099
244300             WHEN ASC-TRIP-ID-CURSOR                              24430099
244400                  MOVE 'CURSOR:  TRIP-ID-CURSOR'                  24440099
244500                                 TO DP013-MESSAGE-TEXT (2)        24450099
244600                  EXEC SQL                                        24460099
244700                       OPEN TRIP-ID-CSR                           24470099
244800                  END-EXEC                                        24480099
244900                                                                  24490099
245000             WHEN ASC-PO-REC-CURSOR                               24500099
245100                  MOVE 'CURSOR:  PO-REC-CURSOR'                   24510099
245200                                 TO DP013-MESSAGE-TEXT (2)        24520099
245300                  EXEC SQL                                        24530099
245400                       OPEN PO-REC-CSR                            24540099
245500                  END-EXEC                                        24550099
245600                                                                  24560099
245700             WHEN ASC-PO-CURSOR                                   24570099
245800                  MOVE 'CURSOR:  PO-CURSOR'                       24580099
245900                                 TO DP013-MESSAGE-TEXT (2)        24590099
246000                  EXEC SQL                                        24600099
246100                       OPEN PO-CSR                                24610099
246200                  END-EXEC                                        24620099
246300         END-EVALUATE                                             24630099
246400                                                                  24640099
246500         EVALUATE TRUE                                            24650099
246600             WHEN SQLCODE = ZERO                                  24660099
246700             WHEN SQLCODE = -904                                  24670099
246800             WHEN SQLCODE = -913                                  24680099
246900                  CONTINUE                                        24690099
247000             WHEN SQLWARN0 NOT = SPACES                           24700099
247100             WHEN SQLCODE  < ZERO                                 24710099
247200             WHEN SQLCODE  > ZERO                                 24720099
247300                  MOVE '4010-OPEN-CURSOR'                         24730099
247400                                   TO DP013-PARAGRAPH             24740099
247500                  MOVE 'OPEN MESSAGE CURSOR - '                   24750099
247600                                   TO DP013-MESSAGE-TEXT (1)      24760099
247700                  MOVE SQLCA       TO DP013-SQLCA                 24770099
247800                  MOVE 'TVHTRIP'   TO DP013-DB2-TABLE-NAME (1)    24780099
247900                  MOVE 'TTRIPST'   TO DP013-DB2-TABLE-NAME (2)    24790099
248000                  MOVE 'TTRSTYP'   TO DP013-DB2-TABLE-NAME (3)    24800099
248100                  MOVE 'TVEHICL'   TO DP013-DB2-TABLE-NAME (4)    24810099
248200                  MOVE 'TSHIPMT'   TO DP013-DB2-TABLE-NAME (5)    24820099
248300                  SET DP013-DB2-ABEND                             24830099
248400                      DP013-XCTL-DISPLAY-RESTART TO TRUE          24840099
248500                  PERFORM DP013-0000-PROCESS-ABEND                24850099
248600         END-EVALUATE                                             24860099
248700     END-PERFORM.                                                 24870099
248800                                                                  24880099
248900     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        24890099
249000         MOVE '4010-OPEN-CURSOR' TO DP013-PARAGRAPH               24900099
249100         MOVE 'MAX RETRIES EXCEEDED ATTEMPTING TO OPEN CSR'       24910099
249200                                   TO DP013-MESSAGE-TEXT (1)      24920099
249300         MOVE SQLCA                TO DP013-SQLCA                 24930099
249400         MOVE 'TVHTRIP'   TO DP013-DB2-TABLE-NAME (1)             24940099
249500         MOVE 'TTRIPST'   TO DP013-DB2-TABLE-NAME (2)             24950099
249600         MOVE 'TTRSTYP'   TO DP013-DB2-TABLE-NAME (3)             24960099
249700         MOVE 'TVEHICL'   TO DP013-DB2-TABLE-NAME (4)             24970099
249800         MOVE 'TSHIPMT'   TO DP013-DB2-TABLE-NAME (5)             24980099
249900         SET DP013-DB2-ABEND                                      24990099
250000             DP013-XCTL-DISPLAY-RESTART TO TRUE                   25000099
250100         PERFORM DP013-0000-PROCESS-ABEND                         25010099
250200     END-IF.                                                      25020099
250300 EJECT                                                            25030099
250400*                                                                 25040099
250500*                                                                 25050099
250600*----------------------------------------------------------------*25060099
250700* CLOSE CURSORS THAT BUILD PANELS WITH INCOMING DATA.            *25070099
250800*----------------------------------------------------------------*25080099
250900 4020-CLOSE-CURSOR.                                               25090099
251000     EVALUATE TRUE                                                25100099
251100         WHEN ASC-TRAILER-CURSOR                                  25110099
251200             EXEC SQL                                             25120099
251300                  CLOSE TRAILER-CSR                               25130099
251400             END-EXEC                                             25140099
251500                                                                  25150099
251600        WHEN ASC-SCAC-TRAILER-CURSOR                              25160099
251700             EXEC SQL                                             25170099
251800                  CLOSE SCAC-TRAILER-CSR                          25180099
251900             END-EXEC                                             25190099
252000                                                                  25200099
252100        WHEN ASC-SCAC-CURSOR                                      25210099
252200             EXEC SQL                                             25220099
252300                  CLOSE SCAC-CSR                                  25230099
252400             END-EXEC                                             25240099
252500                                                                  25250099
252600        WHEN ASC-TRIP-ID-CURSOR                                   25260099
252700             EXEC SQL                                             25270099
252800                  CLOSE TRIP-ID-CSR                               25280099
252900             END-EXEC                                             25290099
253000                                                                  25300099
253100        WHEN ASC-PO-REC-CURSOR                                    25310099
253200             EXEC SQL                                             25320099
253300                  CLOSE PO-REC-CSR                                25330099
253400             END-EXEC                                             25340099
253500                                                                  25350099
253600        WHEN ASC-PO-CURSOR                                        25360099
253700             EXEC SQL                                             25370099
253800                  CLOSE PO-CSR                                    25380099
253900             END-EXEC                                             25390099
254000     END-EVALUATE.                                                25400099
254100                                                                  25410099
254200     EVALUATE TRUE                                                25420099
254300         WHEN SQLCODE = ZERO                                      25430099
254400              CONTINUE                                            25440099
254500         WHEN SQLWARN0 NOT = SPACES                               25450099
254600         WHEN SQLCODE  < ZERO                                     25460099
254700         WHEN SQLCODE  > ZERO                                     25470099
254800              MOVE '4020-CLOSE-CURSOR'                            25480099
254900                                   TO DP013-PARAGRAPH             25490099
255000              MOVE 'CLOSE MESSAGE CURSOR'                         25500099
255100                                   TO DP013-MESSAGE-TEXT (1)      25510099
255200              MOVE SQLCA           TO DP013-SQLCA                 25520099
255300              MOVE 'TVHTRIP'   TO DP013-DB2-TABLE-NAME (1)        25530099
255400              MOVE 'TTRIPST'   TO DP013-DB2-TABLE-NAME (2)        25540099
255500              MOVE 'TTRSTYP'   TO DP013-DB2-TABLE-NAME (3)        25550099
255600              MOVE 'TVEHICL'   TO DP013-DB2-TABLE-NAME (4)        25560099
255700              MOVE 'TSHIPMT'   TO DP013-DB2-TABLE-NAME (5)        25570099
255800              SET DP013-DB2-ABEND                                 25580099
255900                  DP013-XCTL-DISPLAY-RESTART                      25590099
256000                                   TO TRUE                        25600099
256100              PERFORM DP013-0000-PROCESS-ABEND                    25610099
256200     END-EVALUATE.                                                25620099
256300 EJECT                                                            25630099
256400*                                                                 25640099
256500*                                                                 25650099
256600*----------------------------------------------------------------*25660099
256700* OPEN THE FREE ASTRAY CURSOR.                                   *25670099
256800*----------------------------------------------------------------*25680099
256900 4030-OPEN-FREE-ASTRAY-CURSOR.                                    25690099
257000     PERFORM                                                      25700099
257100         WITH TEST AFTER                                          25710099
257200         VARYING PV-RETRY-COUNTER                                 25720099
257300         FROM 1 BY 1                                              25730099
257400         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               25740099
257500                   OR (SQLCODE = ZERO))                           25750099
257600                                                                  25760099
257700                EXEC SQL                                          25770099
257800                     OPEN FREE-ASTRAY-CSR                         25780099
257900                END-EXEC                                          25790099
258000                                                                  25800099
258100         EVALUATE TRUE                                            25810099
258200             WHEN SQLCODE = ZERO                                  25820099
258300             WHEN SQLCODE = -904                                  25830099
258400             WHEN SQLCODE = -913                                  25840099
258500                  CONTINUE                                        25850099
258600             WHEN SQLWARN0 NOT = SPACES                           25860099
258700             WHEN SQLCODE  < ZERO                                 25870099
258800             WHEN SQLCODE  > ZERO                                 25880099
258900                  MOVE '4030-OPEN-FREE-ASTRAY-CURSOR'             25890099
259000                                   TO DP013-PARAGRAPH             25900099
259100                  MOVE 'OPEN TRAILER CURSOR - '                   25910099
259200                                   TO DP013-MESSAGE-TEXT (1)      25920099
259300                  MOVE SQLCA       TO DP013-SQLCA                 25930099
259400                  MOVE 'TVHTRIP'   TO DP013-DB2-TABLE-NAME (1)    25940099
259500                  MOVE 'TTRIPST'   TO DP013-DB2-TABLE-NAME (2)    25950099
259600                  MOVE 'TTRSTYP'   TO DP013-DB2-TABLE-NAME (3)    25960099
259700                  MOVE 'TVEHICL'   TO DP013-DB2-TABLE-NAME (4)    25970099
259800                  MOVE 'TSHIPMT'   TO DP013-DB2-TABLE-NAME (5)    25980099
259900                  SET DP013-DB2-ABEND                             25990099
260000                      DP013-XCTL-DISPLAY-RESTART TO TRUE          26000099
260100                  PERFORM DP013-0000-PROCESS-ABEND                26010099
260200         END-EVALUATE                                             26020099
260300     END-PERFORM.                                                 26030099
260400                                                                  26040099
260500     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        26050099
260600         MOVE '4030-OPEN-FREE-ASTRAY-CURSOR' TO DP013-PARAGRAPH   26060099
260700         MOVE 'MAX RETRIES EXCEEDED ATTEMPTING TO OPEN CSR'       26070099
260800                                   TO DP013-MESSAGE-TEXT (1)      26080099
260900         MOVE SQLCA                TO DP013-SQLCA                 26090099
261000         MOVE 'TVHTRIP'   TO DP013-DB2-TABLE-NAME (1)             26100099
261100         MOVE 'TTRIPST'   TO DP013-DB2-TABLE-NAME (2)             26110099
261200         MOVE 'TTRSTYP'   TO DP013-DB2-TABLE-NAME (3)             26120099
261300         MOVE 'TVEHICL'   TO DP013-DB2-TABLE-NAME (4)             26130099
261400         MOVE 'TSHIPMT'   TO DP013-DB2-TABLE-NAME (5)             26140099
261500         SET DP013-DB2-ABEND                                      26150099
261600             DP013-XCTL-DISPLAY-RESTART TO TRUE                   26160099
261700         PERFORM DP013-0000-PROCESS-ABEND                         26170099
261800     END-IF.                                                      26180099
261900 EJECT                                                            26190099
262000*                                                                 26200099
262100*                                                                 26210099
262200*----------------------------------------------------------------*26220099
262300* CLOSE THE FREE ASTRAY CURSOR.                                  *26230099
262400*----------------------------------------------------------------*26240099
262500 4040-CLOSE-FREE-ASTRAY-CURSOR.                                   26250099
262600         EXEC SQL                                                 26260099
262700              CLOSE FREE-ASTRAY-CSR                               26270099
262800         END-EXEC                                                 26280099
262900                                                                  26290099
263000     EVALUATE TRUE                                                26300099
263100         WHEN SQLCODE = ZERO                                      26310099
263200              CONTINUE                                            26320099
263300         WHEN SQLWARN0 NOT = SPACES                               26330099
263400         WHEN SQLCODE  < ZERO                                     26340099
263500         WHEN SQLCODE  > ZERO                                     26350099
263600              MOVE '4020-CLOSE-CURSOR'                            26360099
263700                                   TO DP013-PARAGRAPH             26370099
263800              MOVE 'CLOSE MESSAGE CURSOR'                         26380099
263900                                   TO DP013-MESSAGE-TEXT (1)      26390099
264000              MOVE SQLCA           TO DP013-SQLCA                 26400099
264100              MOVE 'TVHTRIP'   TO DP013-DB2-TABLE-NAME (1)        26410099
264200              MOVE 'TTRIPST'   TO DP013-DB2-TABLE-NAME (2)        26420099
264300              MOVE 'TTRSTYP'   TO DP013-DB2-TABLE-NAME (3)        26430099
264400              MOVE 'TVEHICL'   TO DP013-DB2-TABLE-NAME (4)        26440099
264500              MOVE 'TSHIPMT'   TO DP013-DB2-TABLE-NAME (5)        26450099
264600              SET DP013-DB2-ABEND                                 26460099
264700                  DP013-XCTL-DISPLAY-RESTART                      26470099
264800                                   TO TRUE                        26480099
264900              PERFORM DP013-0000-PROCESS-ABEND                    26490099
265000     END-EVALUATE.                                                26500099
265100 EJECT                                                            26510099
265200*                                                                 26520099
265300*                                                                 26530099
265400*----------------------------------------------------------------*26540099
265500* OPEN THE CARTON CURSOR.                                        *26550099
265600*----------------------------------------------------------------*26560099
265700 4050-OPEN-CARTON-CURSOR.                                         26570099
265800     PERFORM                                                      26580099
265900         WITH TEST AFTER                                          26590099
266000         VARYING PV-RETRY-COUNTER                                 26600099
266100         FROM 1 BY 1                                              26610099
266200         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               26620099
266300                   OR (SQLCODE = ZERO))                           26630099
266400                                                                  26640099
266500                EXEC SQL                                          26650099
266600                     OPEN CARTON-CSR                              26660099
266700                END-EXEC                                          26670099
266800                                                                  26680099
266900         EVALUATE TRUE                                            26690099
267000             WHEN SQLCODE = ZERO                                  26700099
267100             WHEN SQLCODE = -904                                  26710099
267200             WHEN SQLCODE = -913                                  26720099
267300                  CONTINUE                                        26730099
267400             WHEN SQLWARN0 NOT = SPACES                           26740099
267500             WHEN SQLCODE  < ZERO                                 26750099
267600             WHEN SQLCODE  > ZERO                                 26760099
267700                  MOVE '4050-OPEN-CARTON-CURSOR'                  26770099
267800                                   TO DP013-PARAGRAPH             26780099
267900                  MOVE 'OPEN CARTON CURSOR - '                    26790099
268000                                   TO DP013-MESSAGE-TEXT (1)      26800099
268100                  MOVE SQLCA       TO DP013-SQLCA                 26810099
268200                  MOVE 'TINPKSU'   TO DP013-DB2-TABLE-NAME (1)    26820099
268300                  MOVE 'TPKSLIP'   TO DP013-DB2-TABLE-NAME (2)    26830099
268400                  MOVE 'TSHPTPO'   TO DP013-DB2-TABLE-NAME (3)    26840099
268500                  MOVE 'TSHIPMT'   TO DP013-DB2-TABLE-NAME (4)    26850099
268600                  SET DP013-DB2-ABEND                             26860099
268700                      DP013-XCTL-DISPLAY-RESTART TO TRUE          26870099
268800                  PERFORM DP013-0000-PROCESS-ABEND                26880099
268900         END-EVALUATE                                             26890099
269000     END-PERFORM.                                                 26900099
269100                                                                  26910099
269200     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        26920099
269300         MOVE '4050-OPEN-CARTON-CURSOR' TO DP013-PARAGRAPH        26930099
269400         MOVE 'MAX RETRIES EXCEEDED ATTEMPTING TO OPEN CSR'       26940099
269500                                   TO DP013-MESSAGE-TEXT (1)      26950099
269600         MOVE SQLCA                TO DP013-SQLCA                 26960099
269700         MOVE 'TINPKSU'   TO DP013-DB2-TABLE-NAME (1)             26970099
269800         MOVE 'TPKSLIP'   TO DP013-DB2-TABLE-NAME (2)             26980099
269900         MOVE 'TSHPTPO'   TO DP013-DB2-TABLE-NAME (3)             26990099
270000         MOVE 'TSHIPMT'   TO DP013-DB2-TABLE-NAME (4)             27000099
270100         SET DP013-DB2-ABEND                                      27010099
270200             DP013-XCTL-DISPLAY-RESTART TO TRUE                   27020099
270300         PERFORM DP013-0000-PROCESS-ABEND                         27030099
270400     END-IF.                                                      27040099
270500 EJECT                                                            27050099
270600*                                                                 27060099
270700*                                                                 27070099
270800*----------------------------------------------------------------*27080099
270900* CLOSE THE CARTON CURSOR.                                       *27090099
271000*----------------------------------------------------------------*27100099
271100 4060-CLOSE-CARTON-CURSOR.                                        27110099
271200         EXEC SQL                                                 27120099
271300              CLOSE CARTON-CSR                                    27130099
271400         END-EXEC                                                 27140099
271500                                                                  27150099
271600     EVALUATE TRUE                                                27160099
271700         WHEN SQLCODE = ZERO                                      27170099
271800              CONTINUE                                            27180099
271900         WHEN SQLWARN0 NOT = SPACES                               27190099
272000         WHEN SQLCODE  < ZERO                                     27200099
272100         WHEN SQLCODE  > ZERO                                     27210099
272200              MOVE '4060-CLOSE-CARTON-CURSOR'                     27220099
272300                                   TO DP013-PARAGRAPH             27230099
272400              MOVE 'CLOSE CARTON CURSOR'                          27240099
272500                                   TO DP013-MESSAGE-TEXT (1)      27250099
272600              MOVE SQLCA           TO DP013-SQLCA                 27260099
272700              MOVE 'TINPKSU'   TO DP013-DB2-TABLE-NAME (1)        27270099
272800              MOVE 'TPKSLIP'   TO DP013-DB2-TABLE-NAME (2)        27280099
272900              MOVE 'TSHPTPO'   TO DP013-DB2-TABLE-NAME (3)        27290099
273000              MOVE 'TSHIPMT'   TO DP013-DB2-TABLE-NAME (4)        27300099
273100              SET DP013-DB2-ABEND                                 27310099
273200                  DP013-XCTL-DISPLAY-RESTART                      27320099
273300                                   TO TRUE                        27330099
273400              PERFORM DP013-0000-PROCESS-ABEND                    27340099
273500     END-EVALUATE.                                                27350099
273600 EJECT                                                            27360099
273700*                                                                 27370099
273800*                                                                 27380099
273900*----------------------------------------------------------------*27390099
274000* OPEN THE PO LNE CURSOR.                                        *27400099
274100*----------------------------------------------------------------*27410099
274200 4070-OPEN-PO-LNE-CURSOR.                                         27420099
274300     PERFORM                                                      27430099
274400         WITH TEST AFTER                                          27440099
274500         VARYING PV-RETRY-COUNTER                                 27450099
274600         FROM 1 BY 1                                              27460099
274700         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               27470099
274800                   OR (SQLCODE = ZERO))                           27480099
274900                                                                  27490099
275000                EXEC SQL                                          27500099
275100                     OPEN PO-LNE-CSR                              27510099
275200                END-EXEC                                          27520099
275300                                                                  27530099
275400         EVALUATE TRUE                                            27540099
275500             WHEN SQLCODE = ZERO                                  27550099
275600             WHEN SQLCODE = -904                                  27560099
275700             WHEN SQLCODE = -913                                  27570099
275800                  CONTINUE                                        27580099
275900             WHEN SQLWARN0 NOT = SPACES                           27590099
276000             WHEN SQLCODE  < ZERO                                 27600099
276100             WHEN SQLCODE  > ZERO                                 27610099
276200                  MOVE '4070-OPEN-PO-LNE-CURSOR'                  27620099
276300                                   TO DP013-PARAGRAPH             27630099
276400                  MOVE 'OPEN PO LNE CURSOR - '                    27640099
276500                                   TO DP013-MESSAGE-TEXT (1)      27650099
276600                  MOVE SQLCA       TO DP013-SQLCA                 27660099
276700                  MOVE 'TSHIPMT'   TO DP013-DB2-TABLE-NAME (1)    27670099
276800                  MOVE 'TSHPTPO'   TO DP013-DB2-TABLE-NAME (2)    27680099
276900                  MOVE 'TRECEIV'   TO DP013-DB2-TABLE-NAME (3)    27690099
277000                  MOVE 'TRECITM'   TO DP013-DB2-TABLE-NAME (4)    27700099
277100                  SET DP013-DB2-ABEND                             27710099
277200                      DP013-XCTL-DISPLAY-RESTART TO TRUE          27720099
277300                  PERFORM DP013-0000-PROCESS-ABEND                27730099
277400         END-EVALUATE                                             27740099
277500     END-PERFORM.                                                 27750099
277600                                                                  27760099
277700     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        27770099
277800         MOVE '4070-OPEN-PO-LNE-CURSOR' TO DP013-PARAGRAPH        27780099
277900         MOVE 'MAX RETRIES EXCEEDED ATTEMPTING TO OPEN CSR'       27790099
278000                                   TO DP013-MESSAGE-TEXT (1)      27800099
278100         MOVE SQLCA                TO DP013-SQLCA                 27810099
278200         MOVE 'TSHIPMT'   TO DP013-DB2-TABLE-NAME (1)             27820099
278300         MOVE 'TSHPTPO'   TO DP013-DB2-TABLE-NAME (2)             27830099
278400         MOVE 'TRECEIV'   TO DP013-DB2-TABLE-NAME (3)             27840099
278500         MOVE 'TRECITM'   TO DP013-DB2-TABLE-NAME (4)             27850099
278600         SET DP013-DB2-ABEND                                      27860099
278700             DP013-XCTL-DISPLAY-RESTART TO TRUE                   27870099
278800         PERFORM DP013-0000-PROCESS-ABEND                         27880099
278900     END-IF.                                                      27890099
279000 EJECT                                                            27900099
279100*                                                                 27910099
279200*                                                                 27920099
279300*----------------------------------------------------------------*27930099
279400* CLOSE THE PO LNE CURSOR.                                       *27940099
279500*----------------------------------------------------------------*27950099
279600 4080-CLOSE-PO-LNE-CURSOR.                                        27960099
279700         EXEC SQL                                                 27970099
279800              CLOSE PO-LNE-CSR                                    27980099
279900         END-EXEC                                                 27990099
280000                                                                  28000099
280100     EVALUATE TRUE                                                28010099
280200         WHEN SQLCODE = ZERO                                      28020099
280300              CONTINUE                                            28030099
280400         WHEN SQLWARN0 NOT = SPACES                               28040099
280500         WHEN SQLCODE  < ZERO                                     28050099
280600         WHEN SQLCODE  > ZERO                                     28060099
280700              MOVE '4080-CLOSE-PO-LNE-CURSOR'                     28070099
280800                                   TO DP013-PARAGRAPH             28080099
280900              MOVE 'CLOSE PO LNE CURSOR'                          28090099
281000                                   TO DP013-MESSAGE-TEXT (1)      28100099
281100              MOVE SQLCA           TO DP013-SQLCA                 28110099
281200              MOVE 'TSHIPMT'   TO DP013-DB2-TABLE-NAME (1)        28120099
281300              MOVE 'TSHPTPO'   TO DP013-DB2-TABLE-NAME (2)        28130099
281400              MOVE 'TRECEIV'   TO DP013-DB2-TABLE-NAME (3)        28140099
281500              MOVE 'TRECITM'   TO DP013-DB2-TABLE-NAME (4)        28150099
281600              SET DP013-DB2-ABEND                                 28160099
281700                  DP013-XCTL-DISPLAY-RESTART                      28170099
281800                                   TO TRUE                        28180099
281900              PERFORM DP013-0000-PROCESS-ABEND                    28190099
282000     END-EVALUATE.                                                28200099
282100 EJECT                                                            28210099
282200*                                                                 28220099
282300*                                                                 28230099
282400*----------------------------------------------------------------*28240099
282500*    SET UP THE HOST VARIABLES.                                  *28250099
282600*    PERFORM THIS PARA WHEN MULTIPLE CURSORS.                    *28260099
282700*----------------------------------------------------------------*28270099
282800 4100-PREPARE-CURSOR.                                             28280099
282900     SET ASC-NO-CURSOR                  TO TRUE.                  28290099
283000                                                                  28300099
283100     MOVE ASC-OPER-UNT-ID               TO DK-OPER-UNT-ID.        28310099
283200     MOVE ASC-FCLTY-ID                  TO DK-FCLTY-ID.           28320099
283300     MOVE ASC-SCAC                      TO DK-SCAC-ID.            28330099
283400     MOVE ASC-TRLR-NBR                  TO DK-VEH-NBR.            28340099
283500     MOVE ASC-TRIP-ID                   TO DK-TRIP-ID.            28350099
283600     MOVE ASC-PO-NBR                    TO DK-PO-NBR.             28360099
283700     MOVE ASC-RECEIVER                  TO DK-REC-SEQ-NBR.        28370099
283800                                                                  28380099
283900     MOVE ASC-STATUS-AR                 TO PC-TYPE1.              28390099
284000     MOVE ASC-STATUS-UG                 TO PC-TYPE2.              28400099
284100     MOVE ASC-STATUS-UN                 TO PC-TYPE3.              28410099
284200     MOVE ASC-STATUS-EN                 TO PC-TYPE4.              28420099
284300     MOVE ASC-STATUS-DP                 TO PC-TYPE5.              28430099
284400*                                                                 28440099
284500     IF ASC-SCAC GREATER THAN SPACES AND                          28450099
284600        ASC-TRLR-NBR GREATER THAN SPACES                          28460099
284700            SET ASC-SCAC-TRAILER-CURSOR TO TRUE                   28470099
284800     ELSE                                                         28480099
284900     IF ASC-SCAC GREATER THAN SPACES AND                          28490099
285000        ASC-TRIP-ID GREATER THAN ZEROS                            28500099
285100            SET ASC-TRIP-ID-CURSOR TO TRUE                        28510099
285200     ELSE                                                         28520099
285300     IF ASC-SCAC GREATER THAN SPACES                              28530099
285400            SET ASC-SCAC-CURSOR TO TRUE                           28540099
285500     ELSE                                                         28550099
285600     IF ASC-TRIP-ID GREATER THAN ZEROS                            28560099
285700            SET ASC-TRIP-ID-CURSOR TO TRUE                        28570099
285800     ELSE                                                         28580099
285900     IF ASC-PO-NBR GREATER THAN ZEROS AND                         28590099
286000        ASC-RECEIVER GREATER THAN ZEROS                           28600099
286100            SET ASC-PO-REC-CURSOR TO TRUE                         28610099
286200     ELSE                                                         28620099
286300     IF ASC-PO-NBR GREATER THAN ZEROS                             28630099
286400            SET ASC-PO-CURSOR TO TRUE                             28640099
286500     ELSE                                                         28650099
286600        SET ASC-TRAILER-CURSOR TO TRUE                            28660099
286700     END-IF                                                       28670099
286800*                                                                 28680099
286900*IF ARRIVED STATUS SELECTED                                       28690099
287000     IF  ASC-SELECT-ARRIVED                                       28700099
287500                   SET  PC-TYPE1-ARRIVED       TO TRUE            28750099
288000     ELSE                                                         28800099
288010         SET PC-TYPE1-SPACES TO TRUE                              28801099
288020     END-IF.                                                      28802099
288100*IF UNLOADING STATUS SELECTED:                                    28810099
288200     IF  ASC-SELECT-UNLOADING                                     28820099
288400                   SET  PC-TYPE2-BEG-UNLOAD    TO TRUE            28840099
288900     ELSE                                                         28890099
288910         SET PC-TYPE2-SPACES TO TRUE                              28891099
288920     END-IF.                                                      28892099
289000*IF UNLOADED        SELECTED:                                     28900099
289100     IF  ASC-SELECT-UNLOADED                                      28910099
289300                   SET  PC-TYPE3-UNLOADED     TO TRUE             28930099
289800     ELSE                                                         28980099
289810         SET PC-TYPE3-SPACES TO TRUE                              28981099
289820     END-IF.                                                      28982099
289900*IF ENROUTE  STATUS SELECTED:                                     28990099
290000     IF  ASC-SELECT-ENROUTE                                       29000099
290200                   SET  PC-TYPE4-ENROUTE      TO TRUE             29020099
290700     ELSE                                                         29070099
290710         SET PC-TYPE4-SPACES TO TRUE                              29071099
290720     END-IF.                                                      29072099
290800*IF DEPARTED SELECTED:                                            29080099
290900     IF  ASC-SELECT-DEPARTED                                      29090099
291100                   SET  PC-TYPE5-DEPARTED      TO TRUE            29110099
291200     ELSE                                                         29120099
291300         SET PC-TYPE5-SPACES TO TRUE                              29130099
302100     END-IF.                                                      30210099
302600*                                                                 30260099
302700*----------------------------------------------------------------*30270099
302800*    READ THE ITEMS FROM THE DATA BASE AND MOVE THEM INTO THE    *30280099
302900*    BLOCKS IN THE ARRAY.  WHENEVER BOTH BLOCKS BECOME FULL,     *30290099
303000*    WRITE OUT THE 1ST BLOCK TO TEMPORARY STORAGE, MOVE THE 2ND  *30300099
303100*    BLOCK IN THE ARRAY TO THE 1ST BLOCK, AND INITIALIZE THE     *30310099
303200*    2ND BLOCK MAKING IT AVAILABLE TO BE USED.                   *30320099
303300*                                                                *30330099
303400*    DUE TO THE SIZE OF THE TABLE, AND THE ORDER IN WHICH THE    *30340099
303500*    ROWS ARE SORTED, THE ENTIRE TABLE IS READ INTO THE PROGRAM  *30350099
303600*    UPON INITIALIZATION.                                        *30360099
303700*----------------------------------------------------------------*30370099
303800 4300-READ-ITEMS-FROM-DB.                                         30380099
303900     PERFORM                                                      30390099
304000         VARYING PV-READ-COUNT                                    30400099
304100         FROM 1 BY 1                                              30410099
304200         UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                    30420099
304300            OR (ASC-NO-ITEMS-LEFT-ON-DB))                         30430099
304400******************************************************************30440099
304500                                                                  30450099
304600     PERFORM 4310-FETCH-CURSOR                                    30460099
304700                                                                  30470099
304800         IF  ASC-ITEMS-LEFT-ON-DB                                 30480099
304900             IF  ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                30490099
305000                 ADD +1            TO ASC-ITEM-SUB                30500099
305100             ELSE                                                 30510099
305200                 ADD +1            TO ASC-BLK-SUB                 30520099
305300                 MOVE +1           TO ASC-ITEM-SUB                30530099
305400                                                                  30540099
305500                 IF  ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY         30550099
305600                     MOVE +1       TO ASC-BLK-SUB                 30560099
305700                     SET ASC-BLOCK-MODIFIED (1)                   30570099
305800                                   TO TRUE                        30580099
305900                     PERFORM 5100-WRITE-TEMP-STORAGE              30590099
306000                     MOVE ASC-BLOCK-ENTRIES                       30600099
306100                               (PC-MAX-BLOCKS-IN-ARRAY)           30610099
306200                                TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB) 30620099
306300                     ADD +1        TO ASC-BLK-SUB                 30630099
306400                     INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)   30640099
306500                     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)      30650099
306600                                   TO TRUE                        30660099
306700                 END-IF                                           30670099
306800             END-IF                                               30680099
306900             ADD +1                TO ASC-NUMBER-OF-ITEMS-READ    30690099
307000             MOVE ASC-NUMBER-OF-ITEMS-READ                        30700099
307100                                   TO ASC-LIST-ITEM-NUMBER        30710099
307200                                      (ASC-BLK-SUB ASC-ITEM-SUB)  30720099
307300******************************************************************30730099
307400*GET EXPECTED CARTON CNT                                          30740099
307500         PERFORM 4320-SELECT-EXP-CARTON-CNT                       30750099
307600                                                                  30760099
307700*GET ACTUAL CARTON CNT                                            30770099
307800         PERFORM 4330-SELECT-ACT-CARTON-CNT                       30780099
307900                                                                  30790099
308000*GET EXPECTED SCAN CNT                                            30800099
308100         PERFORM 4340-SELECT-EXP-SCAN-CNT                         30810099
308200                                                                  30820099
308300*GET ACTUAL SCAN CNT                                              30830099
308400         PERFORM 4350-SELECT-ACT-SCAN-CNT                         30840099
308500                                                                  30850099
308600*CALC PERCENT SCANNED                                             30860099
308700         PERFORM 4360-CALC-PERCENT-SCANNED                        30870099
308800                                                                  30880099
308900*GET FREE ASTRAYS                                                 30890099
309000         SET PS-NOT-EO-FREEASTRY-CSR TO TRUE                      30900099
309100                                                                  30910099
309200         PERFORM 4030-OPEN-FREE-ASTRAY-CURSOR                     30920099
309300                                                                  30930099
309400         PERFORM 4370-FETCH-FREE-ASTRAY-CURSOR                    30940099
309500                 UNTIL PS-EO-FREEASTRY-CSR                        30950099
309600                                                                  30960099
309700         PERFORM 4040-CLOSE-FREE-ASTRAY-CURSOR                    30970099
309800                                                                  30980099
309900*GET TOTAL UNITS                                                  30990099
310000         PERFORM 4070-OPEN-PO-LNE-CURSOR                          31000099
310100                                                                  31010099
310200         PERFORM 4380-FETCH-PO-LNE-CURSOR                         31020099
310300                                                                  31030099
310400         SET PS-NOT-EO-PO-LNE-CSR TO TRUE                         31040099
310500                                                                  31050099
310600         PERFORM 4380-FETCH-PO-LNE-CURSOR                         31060099
310700             UNTIL PS-EO-PO-LNE-CSR                               31070099
310800                                                                  31080099
310900         PERFORM 4080-CLOSE-PO-LNE-CURSOR                         31090099
311000                                                                  31100099
311100*                                                                 31110099
311200******************************************************************31120099
311300             MOVE SPACES           TO ASC-ACTION                  31130099
311400                                      (ASC-BLK-SUB ASC-ITEM-SUB)  31140099
311500             MOVE VHTRIP-OWNER-SCAC-ID                            31150099
311600                              TO  ASC-SCAC-CDE                    31160099
311700                                       (ASC-BLK-SUB ASC-ITEM-SUB) 31170099
311800             MOVE VHTRIP-VEH-NBR                                  31180099
311900                              TO  ASC-VEH-NBR                     31190099
312000                                       (ASC-BLK-SUB ASC-ITEM-SUB) 31200099
312100             MOVE PV-DATE-TIME-DISPLAY                            31210099
312200                              TO  ASC-DATE-TIME                   31220099
312300                                       (ASC-BLK-SUB ASC-ITEM-SUB) 31230099
312400             MOVE TRIPST-TRIP-STATUS-CDE                          31240099
312500                              TO  ASC-LN-STATUS                   31250099
312600                                       (ASC-BLK-SUB ASC-ITEM-SUB) 31260099
312700*FOR EXPECTED CARTON COUNT                                        31270099
312800             MOVE PV-EXP-CARTON-CNT                               31280099
312900                              TO  ASC-EXP-CARTON-CNT              31290099
313000                                       (ASC-BLK-SUB ASC-ITEM-SUB) 31300099
313100             ADD PV-EXP-CARTON-CNT                                31310099
313200                              TO ASC-TOT-EXP-CRT                  31320099
313300*FOR ACTUAL CARTON COUNT                                          31330099
313400             MOVE PV-ACT-CARTON-CNT                               31340099
313500                              TO  ASC-ACT-CARTON-CNT              31350099
313600                                       (ASC-BLK-SUB ASC-ITEM-SUB) 31360099
313700             ADD PV-ACT-CARTON-CNT                                31370099
313800                              TO ASC-TOT-ACT-CRT                  31380099
313900*FOR EXPECTED SCAN COUNT                                          31390099
314000             MOVE PV-EXP-SCANNED-CNT                              31400099
314100                              TO  ASC-EXP-SCANNED-CNT             31410099
314200                                       (ASC-BLK-SUB ASC-ITEM-SUB) 31420099
314300             ADD PV-EXP-SCANNED-CNT                               31430099
314400                              TO ASC-TOT-EXP-SCN                  31440099
314500*FOR ACTUAL SCAN COUNT                                            31450099
314600             MOVE PV-ACT-SCANNED-CNT                              31460099
314700                              TO  ASC-ACT-SCANNED-CNT             31470099
314800                                       (ASC-BLK-SUB ASC-ITEM-SUB) 31480099
314900             ADD PV-ACT-SCANNED-CNT                               31490099
315000                              TO ASC-TOT-ACT-SCN                  31500099
315100*FOR PERCENT SCANNED                                              31510099
315200             MOVE PV-PERCENT-SCANNED TO PV-PERCENT                31520099
315300             MOVE PV-PERCENT-EDITED                               31530099
315400                              TO  ASC-PERCENT-SCND                31540099
315500                                       (ASC-BLK-SUB ASC-ITEM-SUB) 31550099
315600*FOR FREE ASTRAY CARTONS                                          31560099
315700             IF PS-FREE-ASTRAY-EXISTS                             31570099
315800                   MOVE PV-FREE-ASTY-EXISTS                       31580099
315900                              TO  ASC-FREE-ASTRAY                 31590099
316000                                       (ASC-BLK-SUB ASC-ITEM-SUB) 31600099
316100                   SET PS-FREE-ASTRAY-NOT-EXISTS TO TRUE          31610099
316200             ELSE                                                 31620099
316300                   MOVE PV-FREE-ASTY-NOT-EXISTS                   31630099
316400                                    TO  ASC-FREE-ASTRAY           31640099
316500                                       (ASC-BLK-SUB ASC-ITEM-SUB) 31650099
316600             END-IF                                               31660099
316700             ADD PV-FREE-ASTRAY-CNT                               31670099
316800                              TO ASC-TOT-FRE-AST                  31680099
316900*FOR TOTAL UNITS                                                  31690099
317000             MOVE PV-TRAILER-UNIT-CNT                             31700099
317100                              TO  ASC-TOTAL-UNITS                 31710099
317200                                       (ASC-BLK-SUB ASC-ITEM-SUB) 31720099
317300             ADD PV-TRAILER-UNIT-CNT                              31730099
317400                              TO ASC-TOT-UNITS                    31740099
317500                                                                  31750099
317600*FOR USE IN PASSING FIELD TO S552                                 31760099
317700             MOVE VHTRIP-TRIP-ID                                  31770099
317800                              TO ASC-LN-TRIP-ID                   31780099
317900                                       (ASC-BLK-SUB ASC-ITEM-SUB) 31790099
318000                                                                  31800099
318100*INITIALIZE COUNTERS                                              31810099
318200             MOVE ZEROS TO PV-EXP-CARTON-CNT                      31820099
318300             MOVE ZEROS TO PV-EXP-SCANNED-CNT                     31830099
318400             MOVE ZEROS TO PV-ACT-SCANNED-CNT                     31840099
318500             MOVE ZEROS TO PV-PERCENT-SCANNED                     31850099
318600             MOVE ZEROS TO PV-FREE-ASTRAY-CNT                     31860099
318700             MOVE ZEROS TO PV-TRAILER-UNIT-CNT                    31870099
318800         END-IF                                                   31880099
318900     END-PERFORM.                                                 31890099
319000******************************************************************31900099
319100     IF  ASC-NUMBER-OF-ITEMS-READ > ZERO                          31910099
319200         MOVE +1                   TO ASC-BLK-SUB                 31920099
319300         PERFORM 5100-WRITE-TEMP-STORAGE                          31930099
319400         ADD +1                    TO ASC-BLK-SUB                 31940099
319500         PERFORM 5100-WRITE-TEMP-STORAGE                          31950099
319600                                                                  31960099
319700         MOVE 1                    TO ASC-BLK-SUB                 31970099
319800                                      PV-BLOCK-NUMBER             31980099
319900         PERFORM 4410-READ-TEMP-STORAGE                           31990099
320000         IF  ASC-HIGHEST-BLOCK-WRITTEN GREATER THAN 1             32000099
320100             MOVE 2                TO ASC-BLK-SUB                 32010099
320200                                      PV-BLOCK-NUMBER             32020099
320300             PERFORM 4410-READ-TEMP-STORAGE                       32030099
320400         END-IF                                                   32040099
320500     END-IF.                                                      32050099
320600*                                                                 32060099
320700*                                                                 32070099
320800*----------------------------------------------------------------*32080099
320900*    FETCH CURSORS THAT BUILD PANELS WITH INCOMING DATA.         *32090099
321000*----------------------------------------------------------------*32100099
321100 4310-FETCH-CURSOR.                                               32110099
321200     EVALUATE TRUE                                                32120099
321300         WHEN ASC-TRAILER-CURSOR                                  32130099
321400              EXEC SQL                                            32140099
321500                   FETCH TRAILER-CSR                              32150099
321600                    INTO :VHTRIP-TRIP-ID                          32160099
321700                        ,:VHTRIP-OWNER-SCAC-ID                    32170099
321800                        ,:VHTRIP-VEH-NBR :DN-VEH-NBR              32180099
321900                        ,:TRIPST-TRIP-STATUS-CDE                  32190099
322000                        ,:TRSTYP-PRTY-CDE                         32200099
322100                        ,:RECEIV-REC-TMST                         32210099
322200              END-EXEC                                            32220099
322300                                                                  32230099
322400         WHEN ASC-SCAC-TRAILER-CURSOR                             32240099
322500              EXEC SQL                                            32250099
322600                   FETCH SCAC-TRAILER-CSR                         32260099
322700                    INTO :VHTRIP-TRIP-ID                          32270099
322800                        ,:VHTRIP-OWNER-SCAC-ID                    32280099
322900                        ,:VHTRIP-VEH-NBR :DN-VEH-NBR              32290099
323000                        ,:TRIPST-TRIP-STATUS-CDE                  32300099
323100                        ,:TRSTYP-PRTY-CDE                         32310099
323200                        ,:RECEIV-REC-TMST                         32320099
323300              END-EXEC                                            32330099
323400                                                                  32340099
323500         WHEN ASC-SCAC-CURSOR                                     32350099
323600              EXEC SQL                                            32360099
323700                   FETCH SCAC-CSR                                 32370099
323800                    INTO :VHTRIP-TRIP-ID                          32380099
323900                        ,:VHTRIP-OWNER-SCAC-ID                    32390099
324000                        ,:VHTRIP-VEH-NBR :DN-VEH-NBR              32400099
324100                        ,:TRIPST-TRIP-STATUS-CDE                  32410099
324200                        ,:TRSTYP-PRTY-CDE                         32420099
324300                        ,:RECEIV-REC-TMST                         32430099
324400              END-EXEC                                            32440099
324500                                                                  32450099
324600         WHEN ASC-TRIP-ID-CURSOR                                  32460099
324700              EXEC SQL                                            32470099
324800                   FETCH TRIP-ID-CSR                              32480099
324900                    INTO :VHTRIP-TRIP-ID                          32490099
325000                        ,:VHTRIP-OWNER-SCAC-ID                    32500099
325100                        ,:VHTRIP-VEH-NBR :DN-VEH-NBR              32510099
325200                        ,:TRIPST-TRIP-STATUS-CDE                  32520099
325300                        ,:RECEIV-REC-TMST                         32530099
325400              END-EXEC                                            32540099
325500                                                                  32550099
325600         WHEN ASC-PO-REC-CURSOR                                   32560099
325700              EXEC SQL                                            32570099
325800                   FETCH PO-REC-CSR                               32580099
325900                    INTO :SHPTPO-PO-NBR                           32590099
326000                        ,:SHPTPO-REC-SEQ-NBR                      32600099
326100                        ,:VHTRIP-TRIP-ID                          32610099
326200                        ,:VHTRIP-OWNER-SCAC-ID                    32620099
326300                        ,:VHTRIP-VEH-NBR :DN-VEH-NBR              32630099
326400                        ,:TRIPST-TRIP-STATUS-CDE                  32640099
326500                        ,:RECEIV-REC-TMST                         32650099
326600              END-EXEC                                            32660099
326700                                                                  32670099
326800         WHEN ASC-PO-CURSOR                                       32680099
326900              EXEC SQL                                            32690099
327000                   FETCH PO-CSR                                   32700099
327100                    INTO :SHPTPO-PO-NBR                           32710099
327200                        ,:VHTRIP-TRIP-ID                          32720099
327300                        ,:VHTRIP-OWNER-SCAC-ID                    32730099
327400                        ,:VHTRIP-VEH-NBR :DN-VEH-NBR              32740099
327500                        ,:TRIPST-TRIP-STATUS-CDE                  32750099
327600                        ,:RECEIV-REC-TMST                         32760099
327700              END-EXEC                                            32770099
327800     END-EVALUATE.                                                32780099
327900                                                                  32790099
328000     EVALUATE TRUE                                                32800099
328100         WHEN SQLCODE = ZERO                                      32810099
328200              IF DN-VEH-NBR = -1                                  32820099
328300                 MOVE SPACES       TO VHTRIP-VEH-NBR              32830099
328400              END-IF                                              32840099
328500              MOVE RECEIV-REC-TMST TO PV-TMST-R                   32850099
328600              MOVE PV-TMST-YY      TO PV-DISPLAY-YY               32860099
328700              MOVE PC-SLASH        TO PV-SLASH-1                  32870099
328800              MOVE PV-TMST-MM      TO PV-DISPLAY-MM               32880099
328900              MOVE PC-SLASH        TO PV-SLASH-2                  32890099
329000              MOVE PV-TMST-DD      TO PV-DISPLAY-DD               32900099
329100              MOVE PV-TMST-HRS     TO PV-DISPLAY-HRS              32910099
329200              MOVE PC-COLON        TO PV-COLON                    32920099
329300              MOVE PV-TMST-MIN     TO PV-DISPLAY-MIN              32930099
329400         WHEN SQLCODE = +100                                      32940099
329500              MOVE SPACES          TO PV-TMST-R                   32950099
329600              MOVE SPACES          TO PV-DISPLAY-YY               32960099
329700              MOVE SPACES          TO PV-SLASH-1                  32970099
329800              MOVE SPACES          TO PV-DISPLAY-MM               32980099
329900              MOVE SPACES          TO PV-SLASH-2                  32990099
330000              MOVE SPACES          TO PV-DISPLAY-DD               33000099
330100              MOVE SPACES          TO PV-DISPLAY-HRS              33010099
330200              MOVE SPACES          TO PV-COLON                    33020099
330300              MOVE SPACES          TO PV-DISPLAY-MIN              33030099
330400         WHEN SQLWARN0 NOT = SPACE                                33040099
330500         WHEN SQLCODE NOT = ZERO                                  33050099
330600              MOVE '4310-FETCH-CURSOR'                            33060099
330700                                   TO DP013-PARAGRAPH             33070099
330800              MOVE 'FETCH MESSAGE CURSOR'                         33080099
330900                                   TO DP013-MESSAGE-TEXT (1)      33090099
331000              MOVE SQLCA           TO DP013-SQLCA                 33100099
331100              SET DP013-DB2-ABEND  TO TRUE                        33110099
331200              PERFORM DP013-0000-PROCESS-ABEND                    33120099
331300     END-EVALUATE.                                                33130099
331400                                                                  33140099
331500     IF  SQLCODE EQUAL +100                                       33150099
331600         SET ASC-NO-ITEMS-LEFT-ON-DB                              33160099
331700                                   TO TRUE                        33170099
331800     END-IF.                                                      33180099
331900*                                                                 33190099
332000*                                                                 33200099
332100*----------------------------------------------------------------*33210099
332200*    GET THE EXPECTED CARTON COUNT FOR EACH TRAILER              *33220099
332300*----------------------------------------------------------------*33230099
332400 4320-SELECT-EXP-CARTON-CNT.                                      33240099
332500         EXEC SQL                                                 33250099
332610            SELECT  SUM(B.EXPTED_CART_CNT)                        33261099
332700              INTO :PV-EXP-CARTON-CNT                             33270099
332800              FROM  TSHIPMT A                                     33280099
332900                  , TSHPTPO B                                     33290099
333100          WHERE A.TRIP_ID     = :VHTRIP-TRIP-ID                   33310099
333200            AND A.SHIPT_ID    = B.SHIPT_ID                        33320099
333300           WITH UR                                                33330099
333500         END-EXEC                                                 33350099
333600                                                                  33360099
333700         EVALUATE TRUE                                            33370099
333800             WHEN SQLCODE = +0                                    33380099
333900             WHEN SQLCODE = +100                                  33390099
334000             WHEN SQLCODE = -305                                  33400099
334100             WHEN SQLCODE = -904                                  33410099
334200             WHEN SQLCODE = -913                                  33420099
334300                 CONTINUE                                         33430099
334400             WHEN SQLWARN0 NOT = SPACE                            33440099
334500             WHEN SQLCODE  < ZERO                                 33450099
334600             WHEN SQLCODE  > ZERO                                 33460099
334700                 MOVE SQLCODE                   TO PV-SOFT-SQLCODE33470099
334800                 MOVE '4320-SELECT-EXP-CARTON-CNT'                33480099
334900                                         TO PV-SOFT-PARAGRAPH     33490099
335000                 MOVE PV-SOFT-ABORT-MSG                           33500099
335100                                         TO PV-CICS-MSG-AREA2     33510099
335200                 MOVE VHTRIP-TRIP-ID   TO  PV-DISPLAY-TRIP-ID     33520099
335300                 MOVE SHPTPO-SHIPT-ID                             33530099
335400                                       TO  PV-DISPLAY-SHIPT-ID    33540099
335500                 MOVE RECEIV-ORD-NBR                              33550099
335600                                       TO  PV-DISPLAY-ORD-NBR     33560099
335700                 MOVE SHPTPO-PO-NBR                               33570099
335800                                       TO  PV-DISPLAY-PO-NBR      33580099
335900                 MOVE RECEIV-REC-SEQ-NBR                          33590099
336000                                       TO  PV-DISPLAY-REC-SEQ-NBR 33600099
336100                 STRING ' EXPECTED SCAN CNT-'    DELIMITED BY SIZE33610099
336200                          PV-DISPLAY-EXPECTED-CNT                 33620099
336300                                                 DELIMITED BY SIZE33630099
336400                        ' VHTRIP TRIP ID-'       DELIMITED BY SIZE33640099
336500                          PV-DISPLAY-TRIP-ID     DELIMITED BY SIZE33650099
336600                        ' SHPTPO SHIPT ID-'      DELIMITED BY SIZE33660099
336700                          PV-DISPLAY-SHIPT-ID    DELIMITED BY SIZE33670099
336800                        ' SHPTPO PO NBR-'        DELIMITED BY SIZE33680099
336900                          PV-DISPLAY-PO-NBR      DELIMITED BY SIZE33690099
337000                        ' RECEIV ORD NBR-'       DELIMITED BY SIZE33700099
337100                          PV-DISPLAY-ORD-NBR     DELIMITED BY SIZE33710099
337200                        ' RECEIV REC SEQ NBR-'   DELIMITED BY SIZE33720099
337300                          PV-DISPLAY-REC-SEQ-NBR DELIMITED BY SIZE33730099
337400                                  INTO DP013-MESSAGE-TEXT (2)     33740099
337500                 MOVE SQLCA         TO DP013-SQLCA                33750099
337600                 SET DP013-DB2-ABEND                              33760099
337700                     DP013-XCTL-DISPLAY-RESTART                   33770099
337800                                 TO TRUE                          33780099
337900                 PERFORM DP013-0000-PROCESS-ABEND                 33790099
338000         END-EVALUATE.                                            33800099
338100*                                                                 33810099
338200*                                                                 33820099
338300*----------------------------------------------------------------*33830099
338400*    GET THE ACTUAL CARTON COUNT FOR EACH TRAILER                *33840099
338500*----------------------------------------------------------------*33850099
338600 4330-SELECT-ACT-CARTON-CNT.                                      33860099
338700         EXEC SQL                                                 33870099
338800            SELECT  SUM(C.ACTL_CART_CNT)                          33880099
338900              INTO :PV-ACT-CARTON-CNT                             33890099
339000              FROM  TSHIPMT A                                     33900099
339100                  , TSHPTPO B                                     33910099
339200                  , TRECEIV C                                     33920099
339300          WHERE A.TRIP_ID     = :VHTRIP-TRIP-ID                   33930099
339400            AND A.SHIPT_ID    = B.SHIPT_ID                        33940099
339500            AND B.PO_NBR      = C.ORD_NBR                         33950099
339600            AND B.REC_SEQ_NBR = C.REC_SEQ_NBR                     33960099
339610           WITH UR                                                33961099
339700         END-EXEC                                                 33970099
339800                                                                  33980099
339900         EVALUATE TRUE                                            33990099
340000             WHEN SQLCODE = +0                                    34000099
340100             WHEN SQLCODE = +100                                  34010099
340200             WHEN SQLCODE = -305                                  34020099
340300             WHEN SQLCODE = -904                                  34030099
340400             WHEN SQLCODE = -913                                  34040099
340500                 CONTINUE                                         34050099
340600             WHEN SQLWARN0 NOT = SPACE                            34060099
340700             WHEN SQLCODE  < ZERO                                 34070099
340800             WHEN SQLCODE  > ZERO                                 34080099
340900                 MOVE SQLCODE                   TO PV-SOFT-SQLCODE34090099
341000                 MOVE '4330-SELECT-ACT-CARTON-CNT'                34100099
341100                                         TO PV-SOFT-PARAGRAPH     34110099
341200                 MOVE PV-SOFT-ABORT-MSG                           34120099
341300                                         TO PV-CICS-MSG-AREA2     34130099
341400                 MOVE VHTRIP-TRIP-ID   TO  PV-DISPLAY-TRIP-ID     34140099
341500                 MOVE SHPTPO-SHIPT-ID                             34150099
341600                                       TO  PV-DISPLAY-SHIPT-ID    34160099
341700                 MOVE RECEIV-ORD-NBR                              34170099
341800                                       TO  PV-DISPLAY-ORD-NBR     34180099
341900                 MOVE SHPTPO-PO-NBR                               34190099
342000                                       TO  PV-DISPLAY-PO-NBR      34200099
342100                 MOVE RECEIV-REC-SEQ-NBR                          34210099
342200                                       TO  PV-DISPLAY-REC-SEQ-NBR 34220099
342300                 STRING ' EXPECTED SCAN CNT-'    DELIMITED BY SIZE34230099
342400                          PV-DISPLAY-EXPECTED-CNT                 34240099
342500                                                 DELIMITED BY SIZE34250099
342600                        ' VHTRIP TRIP ID-'       DELIMITED BY SIZE34260099
342700                          PV-DISPLAY-TRIP-ID     DELIMITED BY SIZE34270099
342800                        ' SHPTPO SHIPT ID-'      DELIMITED BY SIZE34280099
342900                          PV-DISPLAY-SHIPT-ID    DELIMITED BY SIZE34290099
343000                        ' SHPTPO PO NBR-'        DELIMITED BY SIZE34300099
343100                          PV-DISPLAY-PO-NBR      DELIMITED BY SIZE34310099
343200                        ' RECEIV ORD NBR-'       DELIMITED BY SIZE34320099
343300                          PV-DISPLAY-ORD-NBR     DELIMITED BY SIZE34330099
343400                        ' RECEIV REC SEQ NBR-'   DELIMITED BY SIZE34340099
343500                          PV-DISPLAY-REC-SEQ-NBR DELIMITED BY SIZE34350099
343600                                  INTO DP013-MESSAGE-TEXT (2)     34360099
343700                 MOVE SQLCA         TO DP013-SQLCA                34370099
343800                 SET DP013-DB2-ABEND                              34380099
343900                     DP013-XCTL-DISPLAY-RESTART                   34390099
344000                                 TO TRUE                          34400099
344100                 PERFORM DP013-0000-PROCESS-ABEND                 34410099
344200         END-EVALUATE.                                            34420099
344300*                                                                 34430099
344400*                                                                 34440099
344500*----------------------------------------------------------------*34450099
344600*    GET THE EXPECTED SCANNED CARTON COUNT FOR EACH TRAILER      *34460099
344700*----------------------------------------------------------------*34470099
344800 4340-SELECT-EXP-SCAN-CNT.                                        34480099
344900         EXEC SQL                                                 34490099
345000            SELECT  COUNT(*)                                      34500099
345100              INTO :PV-EXP-SCANNED-CNT                            34510099
345200              FROM  TSHIPMT A                                     34520099
345300                   ,TSHPTPO B                                     34530099
345400                   ,TPKSLIP C                                     34540099
345500                   ,TINPKSU D                                     34550099
345510                   ,TSHPUNT E                                     34551099
345520                   ,TRECEIV F                                     34552099
345600          WHERE A.TRIP_ID        = :VHTRIP-TRIP-ID                34560099
345700            AND A.SHIPT_ID       = B.SHIPT_ID                     34570099
345800            AND B.PO_NBR         = C.PO_NBR                       34580099
345900            AND B.REC_SEQ_NBR    = C.REC_SEQ_NBR                  34590099
346000            AND B.PO_NBR         = D.PO_NBR                       34600099
346100            AND C.VER_STAT_CDE   = 'A'                            34610099
346200            AND D.SEQ_NBR        = C.SEQ_NBR                      34620099
346201            AND E.SHIPT_UNT_ID   = D.SHIPT_UNT_ID                 34620199
346202            AND E.ACTV_IND       = 'A'                            34620299
346203            AND F.ORD_NBR        = B.PO_NBR                       34620399
346204            AND F.REC_SEQ_NBR    = B.REC_SEQ_NBR                  34620499
346205            AND F.VER_STATUS_CDE = 'A'                            34620599
346210           WITH UR                                                34621099
346300         END-EXEC                                                 34630099
346400                                                                  34640099
346500         EVALUATE TRUE                                            34650099
346600             WHEN SQLCODE = +0                                    34660099
346700             WHEN SQLCODE = +100                                  34670099
346800             WHEN SQLCODE = -305                                  34680099
346900             WHEN SQLCODE = -904                                  34690099
347000             WHEN SQLCODE = -913                                  34700099
347100                 CONTINUE                                         34710099
347200             WHEN SQLWARN0 NOT = SPACE                            34720099
347300             WHEN SQLCODE  < ZERO                                 34730099
347400             WHEN SQLCODE  > ZERO                                 34740099
347500                 MOVE '4340-SELECT-EXP-SCAN-CNT'                  34750099
347600                                 TO DP013-PARAGRAPH               34760099
347700                 MOVE 'SELECT EXPECTED SCAN COUNT'                34770099
347800                                 TO DP013-MESSAGE-TEXT (1)        34780099
347900                 MOVE SQLCA      TO DP013-SQLCA                   34790099
348000                 MOVE 'TSHIPMT'  TO DP013-DB2-TABLE-NAME (1)      34800099
348100                 MOVE 'TSHPTPO'  TO DP013-DB2-TABLE-NAME (2)      34810099
348200                 MOVE 'TPKSLIP'  TO DP013-DB2-TABLE-NAME (3)      34820099
348300                 MOVE 'TINPKSU'  TO DP013-DB2-TABLE-NAME (4)      34830099
348400                 SET DP013-DB2-ABEND                              34840099
348500                     DP013-XCTL-DISPLAY-RESTART                   34850099
348600                                 TO TRUE                          34860099
348700                 PERFORM DP013-0000-PROCESS-ABEND                 34870099
348800         END-EVALUATE.                                            34880099
348900*                                                                 34890099
349000*                                                                 34900099
349100*----------------------------------------------------------------*34910099
349200*    GET THE ACTUAL SCANNED CARTON COUNT FOR EACH TRAILER        *34920099
349300*----------------------------------------------------------------*34930099
349400 4350-SELECT-ACT-SCAN-CNT.                                        34940099
349500         EXEC SQL                                                 34950099
349600            SELECT  COUNT(*)                                      34960099
349700              INTO :PV-ACT-SCANNED-CNT                            34970099
349800              FROM  TSHUNLO                                       34980099
349900          WHERE TRIP_ID     = :VHTRIP-TRIP-ID                     34990099
349910* DMH       AND SCN_LOC_ID  = 'RECV'                              34991099
349911            AND SCN_LOC_ID IN ('RECV','WRCV')                     34991199
349920            AND   ACTV_CDE  = 'A'                                 34992099
349930           WITH UR                                                34993099
350000         END-EXEC                                                 35000099
350100                                                                  35010099
350200         EVALUATE TRUE                                            35020099
350300             WHEN SQLCODE = +0                                    35030099
350400             WHEN SQLCODE = +100                                  35040099
350500             WHEN SQLCODE = -305                                  35050099
350600             WHEN SQLCODE = -904                                  35060099
350700             WHEN SQLCODE = -913                                  35070099
350800                 CONTINUE                                         35080099
350900             WHEN SQLWARN0 NOT = SPACE                            35090099
351000             WHEN SQLCODE  < ZERO                                 35100099
351100             WHEN SQLCODE  > ZERO                                 35110099
351200                 MOVE '4350-SELECT-ACT-SCAN-CNT'                  35120099
351300                                 TO DP013-PARAGRAPH               35130099
351400                 MOVE 'SELECT ACTUAL COUNT   '                    35140099
351500                                 TO DP013-MESSAGE-TEXT (1)        35150099
351600                 MOVE SQLCA      TO DP013-SQLCA                   35160099
351700                 MOVE 'TSHUNLO'  TO DP013-DB2-TABLE-NAME (1)      35170099
351800                 SET DP013-DB2-ABEND                              35180099
351900                     DP013-XCTL-DISPLAY-RESTART                   35190099
352000                                 TO TRUE                          35200099
352100                 PERFORM DP013-0000-PROCESS-ABEND                 35210099
352200         END-EVALUATE.                                            35220099
352300*                                                                 35230099
352400*                                                                 35240099
352500*----------------------------------------------------------------*35250099
352600*    CALCULATE PERCENT COMPLETE                                  *35260099
352700*----------------------------------------------------------------*35270099
352800 4360-CALC-PERCENT-SCANNED.                                       35280099
352900     IF PV-EXP-SCANNED-CNT > ZERO                                 35290099
353000         DIVIDE PV-ACT-SCANNED-CNT BY PV-EXP-SCANNED-CNT          35300099
353100             GIVING PV-DIVIDEND ROUNDED                           35310099
353200         MULTIPLY PV-DIVIDEND BY 100                              35320099
353300             GIVING PV-PERCENT-SCANNED                            35330099
353400     ELSE                                                         35340099
353500         MOVE ZEROES  TO  PV-DIVIDEND                             35350099
353600                          PV-PERCENT-SCANNED                      35360099
353700     END-IF.                                                      35370099
353800*                                                                 35380099
353900*                                                                 35390099
354000*----------------------------------------------------------------*35400099
354100*    DETERMINE IF ANY FREE-ASTRAYS EXIST ON THE TRAILER          *35410099
354200*----------------------------------------------------------------*35420099
354300 4370-FETCH-FREE-ASTRAY-CURSOR.                                   35430099
354400        EXEC SQL                                                  35440099
354500             FETCH FREE-ASTRAY-CSR                                35450099
354600              INTO :SHUNLO-SHIPT-UNT-ID                           35460099
354700        END-EXEC                                                  35470099
354800                                                                  35480099
354900     EVALUATE TRUE                                                35490099
355000         WHEN SQLCODE = ZERO                                      35500099
355100              PERFORM 4050-OPEN-CARTON-CURSOR                     35510099
355200                                                                  35520099
355300              SET PS-CARTON-CSR-FIRST                             35530099
355400                  PS-NOT-EO-CARTON-CSR TO TRUE                    35540099
355500                                                                  35550099
355600              PERFORM 4375-FETCH-CARTON-CURSOR                    35560099
355700                  UNTIL PS-EO-CARTON-CSR                          35570099
355800                                                                  35580099
355900              PERFORM 4060-CLOSE-CARTON-CURSOR                    35590099
356000         WHEN SQLCODE = +100                                      35600099
356100              SET PS-EO-FREEASTRY-CSR TO TRUE                     35610099
356200         WHEN SQLWARN0 NOT = SPACE                                35620099
356300         WHEN SQLCODE  < ZERO                                     35630099
356400         WHEN SQLCODE  > ZERO                                     35640099
356500              MOVE '4370-FETCH-FREE-ASTRAY-CURSOR'                35650099
356600                                   TO DP013-PARAGRAPH             35660099
356700              MOVE 'FETCH FREE ASTRAY CURSOR'                     35670099
356800                                   TO DP013-MESSAGE-TEXT (1)      35680099
356900              MOVE SQLCA           TO DP013-SQLCA                 35690099
357000              SET DP013-DB2-ABEND  TO TRUE                        35700099
357100              PERFORM DP013-0000-PROCESS-ABEND                    35710099
357200     END-EVALUATE.                                                35720099
357300*                                                                 35730099
357400*                                                                 35740099
357500*----------------------------------------------------------------*35750099
357600*    BASED ON THE SHIPPING UNIT, WILL GET WHAT TRIP ID THE       *35760099
357700*    CARTON WAS EXPECTED TO BE ON                                *35770099
357800*----------------------------------------------------------------*35780099
357900 4375-FETCH-CARTON-CURSOR.                                        35790099
358000        EXEC SQL                                                  35800099
358100             FETCH CARTON-CSR                                     35810099
358200              INTO :SHIPMT-TRIP-ID                                35820099
358300                  ,:PKSLIP-REC-SEQ-NBR                            35830099
358400        END-EXEC                                                  35840099
358500                                                                  35850099
358600     EVALUATE TRUE                                                35860099
358700         WHEN SQLCODE = ZERO                                      35870099
358800              IF SHIPMT-TRIP-ID NOT = VHTRIP-TRIP-ID              35880099
358900                 ADD +1 TO PV-FREE-ASTRAY-CNT                     35890099
359000*LMM                                                              35900099
359100                 SET PS-FREE-ASTRAY-EXISTS TO TRUE                35910099
359200                 SET PS-EO-CARTON-CSR TO TRUE                     35920099
359300              END-IF                                              35930099
359400              SET PS-NOT-CARTON-CSR-FIRST TO TRUE                 35940099
359500         WHEN SQLCODE = +100                                      35950099
359600              IF PS-CARTON-CSR-FIRST                              35960099
359700                 ADD +1 TO PV-FREE-ASTRAY-CNT                     35970099
359800                 SET PS-FREE-ASTRAY-EXISTS TO TRUE                35980099
359900              END-IF                                              35990099
360000              SET PS-EO-CARTON-CSR                                36000099
360100                  PS-NOT-CARTON-CSR-FIRST TO TRUE                 36010099
360200         WHEN SQLWARN0 NOT = SPACE                                36020099
360300         WHEN SQLCODE  < ZERO                                     36030099
360400         WHEN SQLCODE  > ZERO                                     36040099
360500              MOVE '4375-FETCH-CARTON-CURSOR'                     36050099
360600                                   TO DP013-PARAGRAPH             36060099
360700              MOVE 'FETCH CARTON CURSOR'                          36070099
360800                                   TO DP013-MESSAGE-TEXT (1)      36080099
360900              MOVE SQLCA           TO DP013-SQLCA                 36090099
361000              SET DP013-DB2-ABEND  TO TRUE                        36100099
361100              PERFORM DP013-0000-PROCESS-ABEND                    36110099
361200     END-EVALUATE.                                                36120099
361300*                                                                 36130099
361400*                                                                 36140099
361500*----------------------------------------------------------------*36150099
361600*    GET THE TOTAL NUMBER OF UNITS ON THE TRAILER                *36160099
361700*----------------------------------------------------------------*36170099
361800 4380-FETCH-PO-LNE-CURSOR.                                        36180099
361900        EXEC SQL                                                  36190099
362000             FETCH PO-LNE-CSR                                     36200099
362100              INTO :RECITM-ORD-NBR                                36210099
362200                  ,:RECITM-REC-SEQ-NBR                            36220099
362300                  ,:RECITM-ORD-LNE-NBR                            36230099
362400                  ,:RECITM-STATUS-CDE                             36240099
362500                  ,:RECITM-PKSL-ITM-QTY                           36250099
362600                  ,:RECITM-DTL-CK-ITM-QTY                         36260099
362700        END-EXEC                                                  36270099
362800                                                                  36280099
362900     EVALUATE TRUE                                                36290099
363000         WHEN SQLCODE = ZERO                                      36300099
363100             PERFORM 4390-SUM-TOTAL-UNITS                         36310099
363200         WHEN SQLCODE = +100                                      36320099
363300             SET PS-EO-PO-LNE-CSR TO TRUE                         36330099
363400         WHEN SQLWARN0 NOT = SPACE                                36340099
363500         WHEN SQLCODE  < ZERO                                     36350099
363600         WHEN SQLCODE  > ZERO                                     36360099
363700              MOVE '4380-FETCH-PO-LNE-CURSOR'                     36370099
363800                                   TO DP013-PARAGRAPH             36380099
363900              MOVE 'FETCH PO LNE CURSOR'                          36390099
364000                                   TO DP013-MESSAGE-TEXT (1)      36400099
364100              MOVE SQLCA           TO DP013-SQLCA                 36410099
364200              SET DP013-DB2-ABEND  TO TRUE                        36420099
364300              PERFORM DP013-0000-PROCESS-ABEND                    36430099
364400     END-EVALUATE.                                                36440099
364500*                                                                 36450099
364600*                                                                 36460099
364700*----------------------------------------------------------------*36470099
364800*    CHECK IF RECEIPT DISTRIBUTIONS EXIST FOR EACH PO/RCVR/LINE  *36480099
364900*    TO GET NUMBER OF TOTAL UNITS ON A TRAILER                   *36490099
365000*----------------------------------------------------------------*36500099
365100 4390-SUM-TOTAL-UNITS.                                            36510099
365200     EXEC SQL                                                     36520099
365300     SELECT  SUM(VERIFY_ITM_QTY)                                  36530099
365400            ,SUM(AP_VERIFY_ITM_QTY)                               36540099
365500      INTO   :PV-VERIFY-ITM-QTY                                   36550099
365600            ,:PV-AP-VERIFY-ITM-QTY                                36560099
365700           FROM  TRECDIS                                          36570099
365800           WHERE ORD_NBR         = :RECITM-ORD-NBR                36580099
365900                 AND REC_SEQ_NBR = :RECITM-REC-SEQ-NBR            36590099
366000                 AND ORD_LNE_NBR = :RECITM-ORD-LNE-NBR            36600099
366010            WITH UR                                               36601099
366100     END-EXEC.                                                    36610099
366200                                                                  36620099
366300     EVALUATE TRUE                                                36630099
366400         WHEN SQLCODE = ZERO                                      36640099
366500             IF RECITM-STATUS-CDE = 'VE'                          36650099
366600                ADD PV-AP-VERIFY-ITM-QTY TO PV-TRAILER-UNIT-CNT   36660099
366700             ELSE                                                 36670099
366800                ADD PV-VERIFY-ITM-QTY TO PV-TRAILER-UNIT-CNT      36680099
366900             END-IF                                               36690099
367000         WHEN SQLCODE = +100                                      36700099
367100         WHEN SQLCODE = -305                                      36710099
367200             IF RECITM-DTL-CK-ITM-QTY > 0                         36720099
367300                ADD RECITM-DTL-CK-ITM-QTY TO PV-TRAILER-UNIT-CNT  36730099
367400             ELSE                                                 36740099
367500                ADD RECITM-PKSL-ITM-QTY TO PV-TRAILER-UNIT-CNT    36750099
367600             END-IF                                               36760099
367700         WHEN SQLWARN0 NOT = SPACE                                36770099
367800         WHEN SQLCODE <  ZERO                                     36780099
367900         WHEN SQLCODE >  ZERO                                     36790099
368000              MOVE '4390-SUM-TOTAL-UNITS'                         36800099
368100                                   TO DP013-PARAGRAPH             36810099
368200              MOVE 'SUM TOTAL UNITS'                              36820099
368300                                   TO DP013-MESSAGE-TEXT (1)      36830099
368400              MOVE SQLCA           TO DP013-SQLCA                 36840099
368500              SET DP013-DB2-ABEND  TO TRUE                        36850099
368600              PERFORM DP013-0000-PROCESS-ABEND                    36860099
368700     END-EVALUATE.                                                36870099
368800*                                                                 36880099
368900*                                                                 36890099
369000*----------------------------------------------------------------*36900099
369100* IF USER ENTERED A SCAC, TRAILER ON CRIT SPEC, GET TRIP ID      *36910099
369200* AND CURRENT STATUS FOR THE SCAC, TRAILER THAT WAS ENTERED.     *36920099
369300*----------------------------------------------------------------*36930099
369400 4395-GET-TRIP-ID.                                                36940099
369500     PERFORM                                                      36950099
369600         WITH TEST AFTER                                          36960099
369700         VARYING PV-RETRY-COUNTER                                 36970099
369800         FROM 1 BY 1                                              36980099
369900         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               36990099
370000             OR (SQLCODE = +0)                                    37000099
370100             OR (SQLCODE = +100)                                  37010099
370200             OR (SQLCODE = -305))                                 37020099
370300                                                                  37030099
370400         EXEC SQL                                                 37040099
370500              SELECT DISTINCT                                     37050099
370600                     B.STATUS_DTE                                 37060099
370700                   , B.TRIP_ID                                    37070099
370800                INTO :TRIPST-STATUS-DTE                           37080099
370900                   , :TRIPST-TRIP-ID                              37090099
371000              FROM   TVHTRIP A                                    37100099
371100                    ,TTRIPST B                                    37110099
371200                    ,TVEHICL C                                    37120099
371300              WHERE A.OWNER_SCAC_ID = :DK-SCAC-ID                 37130099
371400                AND A.VEH_NBR       = :DK-VEH-NBR                 37140099
371500                AND B.OPER_UNT_ID   = :DK-OPER-UNT-ID             37150099
371600                AND B.FCLTY_ID      = :DK-FCLTY-ID                37160099
371700                AND A.TRIP_ID = B.TRIP_ID                         37170099
371800                AND B.TRIP_ID = C.CURR_TRIP_ID                    37180099
371900                AND B.STATUS_DTE =                                37190099
372000                      (SELECT MAX(D.STATUS_DTE)                   37200099
372100                         FROM TTRIPST D                           37210099
372200                        WHERE D.TRIP_ID       = A.TRIP_ID)        37220099
372210              WITH UR                                             37221099
372300         END-EXEC                                                 37230099
372400                                                                  37240099
372500         EVALUATE TRUE                                            37250099
372600             WHEN SQLCODE = +0                                    37260099
372700                  MOVE TRIPST-TRIP-ID TO ASC-TRIP-ID              37270099
372800                                                                  37280099
372900             WHEN SQLCODE = -305                                  37290099
373000             WHEN SQLCODE = +100                                  37300099
373100             WHEN SQLCODE = -904                                  37310099
373200             WHEN SQLCODE = -913                                  37320099
373300                  CONTINUE                                        37330099
373400                                                                  37340099
373500             WHEN SQLWARN0 NOT = SPACES                           37350099
373600             WHEN SQLCODE < +0                                    37360099
373700             WHEN SQLCODE > +0                                    37370099
373800                  MOVE '4395-GET-TRIP-ID'                         37380099
373900                                  TO DP013-PARAGRAPH              37390099
374000                  MOVE 'UNSUCCESSFUL SELECT ON TVHTRIP'           37400099
374100                                  TO DP013-MESSAGE-TEXT (1)       37410099
374200                  MOVE SQLCA      TO DP013-SQLCA                  37420099
374300                  MOVE 'TVHTRIP ' TO DP013-DB2-TABLE-NAME (1)     37430099
374400                  MOVE 'TTRIPST ' TO DP013-DB2-TABLE-NAME (2)     37440099
374500                  MOVE 'TVEHICL ' TO DP013-DB2-TABLE-NAME (3)     37450099
374600                  SET DP013-DB2-ABEND                             37460099
374700                      DP013-XCTL-DISPLAY-RESTART                  37470099
374800                                  TO TRUE                         37480099
374900                  PERFORM DP013-0000-PROCESS-ABEND                37490099
375000         END-EVALUATE                                             37500099
375100     END-PERFORM.                                                 37510099
375200                                                                  37520099
375300     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    37530099
375400         SQLCODE NOT = +0                                         37540099
375500         MOVE '4395-GET-TRIP-ID'                                  37550099
375600                                  TO DP013-PARAGRAPH              37560099
375700         MOVE 'MAX RETRIES EXCEEDED ON SELECT TVHTRIP'            37570099
375800                                  TO DP013-MESSAGE-TEXT (1)       37580099
375900         MOVE SQLCA               TO DP013-SQLCA                  37590099
376000         MOVE 'TVHTRIP '          TO DP013-DB2-TABLE-NAME (1)     37600099
376100         MOVE 'TTRIPST '          TO DP013-DB2-TABLE-NAME (2)     37610099
376200         MOVE 'TVEHICL '          TO DP013-DB2-TABLE-NAME (3)     37620099
376300         SET DP013-DB2-ABEND                                      37630099
376400             DP013-XCTL-DISPLAY-RESTART                           37640099
376500                                  TO TRUE                         37650099
376600         PERFORM DP013-0000-PROCESS-ABEND                         37660099
376700     END-IF.                                                      37670099
376800*                                                                 37680099
376900*                                                                 37690099
377000*----------------------------------------------------------------*37700099
377100* MOVE THE DISPLAYED FIELDS FROM THE COMMAREA TO THE SCREEN.     *37710099
377200*----------------------------------------------------------------*37720099
377300 4400-MOVE-COMMAREA-TO-SCREEN.                                    37730099
377400     IF  (((PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (1 1))             37740099
377500         AND (PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (2 1)))          37750099
377600         OR  (PV-TOP-ITEM < ASC-LIST-ITEM-NUMBER (1 1)))          37760099
377700             MOVE +1               TO ASC-BLK-SUB                 37770099
377800             PERFORM 5100-WRITE-TEMP-STORAGE                      37780099
377900             ADD +1                TO ASC-BLK-SUB                 37790099
378000             PERFORM 5100-WRITE-TEMP-STORAGE                      37800099
378100             DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL             37810099
378200                 GIVING PV-BLOCK-NUMBER                           37820099
378300                 REMAINDER PV-REMAINDER                           37830099
378400             IF  PV-REMAINDER > ZERO                              37840099
378500                 ADD +1            TO PV-BLOCK-NUMBER             37850099
378600             END-IF                                               37860099
378700             MOVE +1               TO ASC-BLK-SUB                 37870099
378800             PERFORM 4410-READ-TEMP-STORAGE                       37880099
378900             ADD +1                TO ASC-BLK-SUB                 37890099
379000                                      PV-BLOCK-NUMBER             37900099
379100             PERFORM 4410-READ-TEMP-STORAGE                       37910099
379200     END-IF.                                                      37920099
379300                                                                  37930099
379400     MOVE +1                       TO ASC-BLK-SUB.                37940099
379500                                                                  37950099
379600     COMPUTE ASC-ITEM-SUB =                                       37960099
379700         ((PV-TOP-ITEM - ASC-LIST-ITEM-NUMBER (1 1))              37970099
379800         + PC-ITEMS-PER-PANEL).                                   37980099
379900                                                                  37990099
380000     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        38000099
380100         ADD +1                    TO ASC-BLK-SUB                 38010099
380200         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            38020099
380300     END-IF.                                                      38030099
380400                                                                  38040099
380500     COMPUTE ASC-ITEM-AT-BOT-OF-PANEL =                           38050099
380600         ((PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1).                38060099
380700                                                                  38070099
380800     PERFORM 4430-CHECK-FOR-BEGIN-AND-END.                        38080099
380900     PERFORM 4420-FORMAT-LIST-LINES                               38090099
381000         VARYING PV-SUB                                           38100099
381100         FROM PC-ITEMS-PER-PANEL BY -1                            38110099
381200         UNTIL PV-SUB < +1.                                       38120099
381300                                                                  38130099
381400     COMPUTE ASC-ITEMS-DISPLAYED =                                38140099
381500         ((ASC-ITEM-AT-BOT-OF-PANEL - PV-TOP-ITEM) + 1).          38150099
381600                                                                  38160099
381700     MOVE PV-TOP-ITEM              TO ASC-ITEM-AT-TOP-OF-PANEL    38170099
381800                                      ASTRTITO.                   38180099
381900                                                                  38190099
382000     MOVE ASC-ITEM-AT-BOT-OF-PANEL TO AENDITO.                    38200099
382100     MOVE ASC-NUMBER-OF-ITEMS-READ TO ATOTITO.                    38210099
382200     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            38220099
382300                                   TO ASELITO.                    38230099
382400                                                                  38240099
382500     MOVE ASC-OPER-UNT-ID          TO AOPERO.                     38250099
382600     MOVE ASC-FCLTY-ID             TO AFCLTYO.                    38260099
382700     MOVE ASC-FCLTY-NME            TO ANAMEO.                     38270099
382800                                                                  38280099
382900         EVALUATE TRUE                                            38290099
383000             WHEN ASC-PO-CURSOR                                   38300099
383100               MOVE PV-PO-LABEL              TO APOLBLO           38310099
383200               MOVE ASC-PO-NBR               TO PV-PO-NBR         38320099
383300               MOVE PV-PO-NBR                TO APORCVRO          38330099
383400                                                                  38340099
383500             WHEN ASC-PO-REC-CURSOR                               38350099
383600               MOVE PV-PO-LABEL              TO APOLBLO           38360099
383700               MOVE ASC-PO-NBR               TO PV-PO-NBR         38370099
383800               MOVE ASC-RECEIVER             TO PV-RECEIVER       38380099
383900               MOVE PV-PO-RECEIVER           TO APORCVRO          38390099
384000         END-EVALUATE.                                            38400099
384100                                                                  38410099
384200     MOVE ASC-TOT-EXP-CRT                    TO ATOTECRTO.        38420099
384300     MOVE ASC-TOT-ACT-CRT                    TO ATOTACRTO.        38430099
384400     MOVE ASC-TOT-EXP-SCN                    TO ATOTESCNO.        38440099
384500     MOVE ASC-TOT-ACT-SCN                    TO ATOTASCNO.        38450099
384600     MOVE ASC-TOT-FRE-AST                    TO ATOTFREEO.        38460099
384700     MOVE ASC-TOT-UNITS                      TO ATOTUNTSO.        38470099
384800*                                                                 38480099
384900     IF  DP020-MSG-NUMBER-X = SPACE                               38490099
385000         IF  ASC-ITEM-AT-BOT-OF-PANEL < ASC-NUMBER-OF-ITEMS-READ  38500099
385100*            --- MORE ITEMS TO DISPLAY ----                       38510099
385200             MOVE PC-TSYMSG-00279  TO DP020-MSG-NUMBER            38520099
385300             SET DP020-MSG-INFORMATIONAL TO TRUE                  38530099
385400         END-IF                                                   38540099
385500     END-IF.                                                      38550099
385600*                                                                 38560099
385700*                                                                 38570099
385800*----------------------------------------------------------------*38580099
385900*    READ A BLOCK FROM TEMPORARY STORAGE INTO THE ARRAY.         *38590099
386000*----------------------------------------------------------------*38600099
386100*                                                                 38610099
386200 4410-READ-TEMP-STORAGE.                                          38620099
386300     EXEC CICS                                                    38630099
386400         READQ TS                                                 38640099
386500             QUEUE (ASC-LIST-QUEUE-NAME)                          38650099
386600             INTO  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               38660099
386700             ITEM  (PV-BLOCK-NUMBER)                              38670099
386800             RESP  (PV-CICS-RESP)                                 38680099
386900     END-EXEC.                                                    38690099
387000                                                                  38700099
387100     IF  ((PV-CICS-RESP = DFHRESP (NORMAL))                       38710099
387200       OR (PV-CICS-RESP = DFHRESP (ITEMERR)))                     38720099
387300         CONTINUE                                                 38730099
387400     ELSE                                                         38740099
387500         SET DP013-CICS-ABEND      TO TRUE                        38750099
387600         SET DP013-NO-ROLLBACK     TO TRUE                        38760099
387700         MOVE '4410-READ-TEMP-STORAGE'                            38770099
387800                                   TO DP013-PARAGRAPH             38780099
387900         MOVE 'ERROR TRYING TO READ FROM TEMP STORAGE QUEUE'      38790099
388000                                   TO DP013-MESSAGE-TEXT(1)       38800099
388100         PERFORM DP013-0000-PROCESS-ABEND                         38810099
388200     END-IF.                                                      38820099
388300                                                                  38830099
388400     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             38840099
388500                                                                  38850099
388600     IF  PV-CICS-RESP = DFHRESP (ITEMERR)                         38860099
388700         INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)               38870099
388800     END-IF.                                                      38880099
389100*                                                                 38910099
389200*----------------------------------------------------------------*38920099
389300*    PROCESS THE ITEMS IN THE ARRAY AND MOVE THEM TO THE MAP.    *38930099
389400*----------------------------------------------------------------*38940099
389500 4420-FORMAT-LIST-LINES.                                          38950099
389600     IF  ASC-ITEM-AT-BOT-OF-PANEL > ASC-NUMBER-OF-ITEMS-READ      38960099
389700         SUBTRACT +1 FROM ASC-ITEM-AT-BOT-OF-PANEL                38970099
389800         MOVE DP015-ASK-DRK-OFF  TO MR-SELECTA (PV-SUB)           38980099
389900         MOVE DP015-HL-OFF       TO MR-SELECTH (PV-SUB)           38990099
390000         MOVE SPACES             TO MR-SELECTI (PV-SUB)           39000099
390100                                    MR-ACTION (PV-SUB)            39010099
390200                                    MR-SCAC (PV-SUB)              39020099
390300                                    MR-TRAILER (PV-SUB)           39030099
390400                                    MR-DATE-TIME (PV-SUB)         39040099
390500                                    MR-STATUS (PV-SUB)            39050099
390600                                    MR-EXP-CARTON-CNT-X (PV-SUB)  39060099
390700                                    MR-ACT-CARTON-CNT-X (PV-SUB)  39070099
390800                                    MR-EXP-SCANNED-CNT-X (PV-SUB) 39080099
390900                                    MR-ACT-SCANNED-CNT-X (PV-SUB) 39090099
391000                                    MR-PERCENT-SCND-X (PV-SUB)    39100099
391100                                    MR-FREE-ASTRAY-X (PV-SUB)     39110099
391200                                    MR-TOTAL-UNITS-X (PV-SUB)     39120099
391300     ELSE                                                         39130099
391400         IF  ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      39140099
391500                                                   > SPACE        39150099
391600             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 39160099
391700                                 TO MR-SELECTI (PV-SUB)           39170099
391800         ELSE                                                     39180099
391900             MOVE ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      39190099
392000                                 TO MR-SELECTI (PV-SUB)           39200099
392100         END-IF                                                   39210099
392200*                                                                 39220099
392300         IF  DP030-SET-CURSOR-TRAILER                             39230099
392400             IF  ((ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)39240099
392500                 > SPACE)                                         39250099
392600               OR (PV-SUB = 1))                                   39260099
392700                SET DP030-SET-CURSOR-APPL-1 TO TRUE               39270099
392800                MOVE -1            TO MR-SELECTL (PV-SUB)         39280099
392900             END-IF                                               39290099
393000         END-IF                                                   39300099
393100                                                                  39310099
393200******MOVE LIST ITEMS TO SCREEN                                   39320099
393300             MOVE ASC-ACTION (ASC-BLK-SUB ASC-ITEM-SUB)           39330099
393400                                 TO MR-ACTION (PV-SUB)            39340099
393500             MOVE ASC-SCAC-CDE (ASC-BLK-SUB ASC-ITEM-SUB)         39350099
393600                                 TO MR-SCAC (PV-SUB)              39360099
393700             MOVE ASC-VEH-NBR (ASC-BLK-SUB ASC-ITEM-SUB)          39370099
393800                                 TO MR-TRAILER (PV-SUB)           39380099
393900             MOVE ASC-DATE-TIME (ASC-BLK-SUB ASC-ITEM-SUB)        39390099
394000                                 TO MR-DATE-TIME (PV-SUB)         39400099
394100             MOVE ASC-LN-STATUS (ASC-BLK-SUB ASC-ITEM-SUB)        39410099
394200                                 TO MR-STATUS (PV-SUB)            39420099
394300             MOVE ASC-EXP-CARTON-CNT (ASC-BLK-SUB ASC-ITEM-SUB)   39430099
394400                                 TO MR-EXP-CARTON-CNT (PV-SUB)    39440099
394500             MOVE ASC-ACT-CARTON-CNT (ASC-BLK-SUB ASC-ITEM-SUB)   39450099
394600                                 TO MR-ACT-CARTON-CNT (PV-SUB)    39460099
394700             MOVE ASC-EXP-SCANNED-CNT (ASC-BLK-SUB ASC-ITEM-SUB)  39470099
394800                                 TO MR-EXP-SCANNED-CNT (PV-SUB)   39480099
394900             MOVE ASC-ACT-SCANNED-CNT (ASC-BLK-SUB ASC-ITEM-SUB)  39490099
395000                                 TO MR-ACT-SCANNED-CNT (PV-SUB)   39500099
395100             MOVE ASC-PERCENT-SCND (ASC-BLK-SUB ASC-ITEM-SUB)     39510099
395200                                 TO MR-PERCENT-SCND (PV-SUB)      39520099
395300             MOVE ASC-FREE-ASTRAY (ASC-BLK-SUB ASC-ITEM-SUB)      39530099
395400                                 TO MR-FREE-ASTRAY (PV-SUB)       39540099
395500             MOVE ASC-TOTAL-UNITS (ASC-BLK-SUB ASC-ITEM-SUB)      39550099
395600                                 TO MR-TOTAL-UNITS (PV-SUB)       39560099
395700     END-IF.                                                      39570099
395800                                                                  39580099
395900     SUBTRACT +1 FROM ASC-ITEM-SUB.                               39590099
396000                                                                  39600099
396100     IF  ASC-ITEM-SUB < + 1                                       39610099
396200         MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB                39620099
396300         MOVE +1                   TO ASC-BLK-SUB                 39630099
396400     END-IF.                                                      39640099
396500*                                                                 39650099
396600*                                                                 39660099
396700*----------------------------------------------------------------*39670099
396800*  IF A BEGINNING OF RANGE WAS SPECIFIED, MAKE SURE AN END OF    *39680099
396900*  RANGE WAS SPECIFIED AND VICE-VERSA.  IF ONE IS MISSING,       *39690099
397000*  ISSUE A WARNING.                                              *39700099
397100*----------------------------------------------------------------*39710099
397200*                                                                 39720099
397300 4430-CHECK-FOR-BEGIN-AND-END.                                    39730099
397400     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       39740099
397500         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     39750099
397600*            -- NO END-OF-RANGE SPECFIED ---                      39760099
397700             MOVE PC-TSYMSG-00051  TO DP020-MSG-NUMBER            39770099
397800             SET DP020-MSG-WARNING TO TRUE                        39780099
397900             PERFORM 4431-POSITION-AT-WARNING                     39790099
398000         END-IF                                                   39800099
398100     ELSE                                                         39810099
398200         IF  ASC-END-OF-SELECTED-RANGE > ZERO                     39820099
398300*            -- NO BEGINNING-OF-RANGE SPECFIED ---                39830099
398400             MOVE PC-TSYMSG-00053  TO DP020-MSG-NUMBER            39840099
398500             SET DP020-MSG-WARNING TO TRUE                        39850099
398600             PERFORM 4431-POSITION-AT-WARNING                     39860099
398700         END-IF                                                   39870099
398800     END-IF.                                                      39880099
398900*                                                                 39890099
399000*                                                                 39900099
399100*----------------------------------------------------------------*39910099
399200*  ONCE IT HAS BEEN DETERMINED THAT A WARNING IS TO BE ISSUED,   *39920099
399300*  DETERMINE IF EITHER THE BEGINNING OF RANGE OR END OF RANGE    *39930099
399400*  IS ON THE CURRENT SCREEN.  IF IT IS, HIGHLIGHT IT AND         *39940099
399500*  POSITION THE CURSOR THERE.                                    *39950099
399600*----------------------------------------------------------------*39960099
399700*                                                                 39970099
399800 4431-POSITION-AT-WARNING.                                        39980099
399900     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 39990099
400000                    - PV-TOP-ITEM + 1.                            40000099
400100                                                                  40010099
400200     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      40020099
400300         CONTINUE                                                 40030099
400400     ELSE                                                         40040099
400500         SET DP030-SET-CURSOR-APPL-1                              40050099
400600                                   TO TRUE                        40060099
400700         MOVE -1                   TO MR-SELECTL (PV-SUB)         40070099
400800         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         40080099
400900         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         40090099
401000     END-IF.                                                      40100099
401100                                                                  40110099
401200     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   40120099
401300                     - PV-TOP-ITEM + 1.                           40130099
401400     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      40140099
401500         CONTINUE                                                 40150099
401600     ELSE                                                         40160099
401700         SET DP030-SET-CURSOR-APPL-1                              40170099
401800                                   TO TRUE                        40180099
401900         MOVE -1                   TO MR-SELECTL (PV-SUB)         40190099
402000         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         40200099
402100         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         40210099
402200     END-IF.                                                      40220099
402300*                                                                 40230099
402400*                                                                 40240099
402500*----------------------------------------------------------------*40250099
402600* PREPARE THE SELECTED ITEMS TEMP STORAGE QUEUE.  MOVE ALL SEL-  *40260099
402700* ECTED ITEMS FROM THE LIST TEMP STORAGE QUEUE TO THE LAYOUT     *40270099
402800* FOR THE SELECTED ITEMS QUEUE.                                  *40280099
402900*                                                                *40290099
403000* FIRST, DELETE THE SELECTION QUEUE, NEXT LOAD THE SELECTION     *40300099
403100* QUEUE RECORD.  FINALLY, WRITE THE SELECTION QUEUE ITEM WHEN    *40310099
403200* THE ARRAY IS FULL.                                             *40320099
403300*----------------------------------------------------------------*40330099
403400*                                                                 40340099
403500 5000-PREPARE-SEL-QUEUE.                                          40350099
403600     MOVE +1                   TO  ASC-BLK-SUB.                   40360099
403700     PERFORM 5100-WRITE-TEMP-STORAGE.                             40370099
403800     ADD +1                    TO  ASC-BLK-SUB.                   40380099
403900     PERFORM 5100-WRITE-TEMP-STORAGE.                             40390099
404000                                                                  40400099
404110     EVALUATE TRUE                                                40411099
404200       WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)                40420099
404300         MOVE ASC-SEL-QUEUE-NAME TO RC015-SEL-QUEUE-NAME          40430099
404400                                                                  40440099
404410       WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)                40441099
404420       WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)                40442099
404500         MOVE ASC-SEL-QUEUE-NAME-ORIG TO SU003-SEL-QUEUE-NAME     40450099
404610     END-EVALUATE.                                                40461099
404620                                                                  40462099
404800                                                                  40480099
404810     PERFORM 6010-DELETE-SEL-QUEUE                                40481099
404900     SET ASC-UPDATE-TSQ        TO  TRUE                           40490099
405000                                                                  40500099
405100     EVALUATE TRUE                                                40510099
405200       WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)                40520099
405300         SET TR006-IDX         TO  1                              40530099
405400         MOVE ZERO             TO RC015-NUMBER-OF-TS-ITEMS        40540099
405500         INITIALIZE TR006-SELECTED-ITEM-ARRAY                     40550099
405510                                                                  40551099
405600       WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)                40560099
405610       WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)                40561099
405700         SET SU004-IDX         TO  1                              40570099
405800         MOVE ZERO             TO SU003-NUMBER-OF-TS-ITEMS        40580099
405900         INITIALIZE SU004-SELECTED-ITEM-ARRAY                     40590099
406000     END-EVALUATE.                                                40600099
406100                                                                  40610099
406200     EVALUATE TRUE                                                40620099
406300       WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)                40630099
406400         PERFORM 5300-FILL-SEL-QUEUE-RECORD                       40640099
406500           VARYING PV-ITEM FROM 1 BY 1                            40650099
406600             UNTIL PV-ITEM > ASC-HIGHEST-BLOCK-WRITTEN            40660099
406700       WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)                40670099
406710       WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)                40671099
406800         PERFORM 5200-FILL-SEL-QUEUE-RECORD                       40680099
406900           VARYING PV-ITEM FROM 1 BY 1                            40690099
407000             UNTIL PV-ITEM > ASC-HIGHEST-BLOCK-WRITTEN            40700099
407100     END-EVALUATE.                                                40710099
407300                                                                  40730099
407310     EVALUATE TRUE                                                40731099
407400       WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)                40740099
407500         IF TR006-IDX > 1                                         40750099
407600             PERFORM 5305-WRITE-SEL-QUEUE                         40760099
407700             ADD +1 TO RC015-NUMBER-OF-TS-ITEMS                   40770099
407800         END-IF                                                   40780099
407900     WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)                  40790099
407910     WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)                  40791099
408000         IF SU004-IDX > 1                                         40800099
408100             PERFORM 5205-WRITE-SEL-QUEUE                         40810099
408200             ADD +1 TO SU003-NUMBER-OF-TS-ITEMS                   40820099
408300         END-IF                                                   40830099
408400     END-EVALUATE.                                                40840099
408500 EJECT                                                            40850099
408600*                                                                 40860099
408700*                                                                 40870099
408800*----------------------------------------------------------------*40880099
408900*    WRITE A NEW BLOCK FROM THE ARRAY TO TEMPORARY STORAGE.      *40890099
409000*    REWRITE AN EXISITING BLOCK ONLY IF IT HAS BEEN MODIFIED.    *40900099
409100*----------------------------------------------------------------*40910099
409200*                                                                 40920099
409300 5100-WRITE-TEMP-STORAGE.                                         40930099
409400     MOVE ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1)                     40940099
409500                                   TO PV-LIST-ITEM-NUMBER.        40950099
409600     COMPUTE PV-BLOCK-NUMBER =                                    40960099
409700         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    40970099
409800                                                                  40980099
409900     IF (PV-BLOCK-NUMBER < ASC-HIGHEST-BLOCK-WRITTEN)             40990099
410000     OR (PV-BLOCK-NUMBER = ASC-HIGHEST-BLOCK-WRITTEN)             41000099
410100         IF  ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                      41010099
410200             PERFORM 5105-REWRITE-ASC-LISTQ                       41020099
410300         END-IF                                                   41030099
410400     ELSE                                                         41040099
410500         COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                       41050099
410600         ASC-HIGHEST-BLOCK-WRITTEN + 1                            41060099
410700         PERFORM 5110-WRITE-ASC-LISTQ                             41070099
410800         ADD +1                    TO ASC-HIGHEST-BLOCK-WRITTEN   41080099
410900     END-IF.                                                      41090099
411000                                                                  41100099
411100     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             41110099
411300*                                                                 41130099
411400*----------------------------------------------------------------*41140099
411500*  REWRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-     *41150099
411600*  SPECIFIC COMMAREA.                                            *41160099
411700*----------------------------------------------------------------*41170099
411900 5105-REWRITE-ASC-LISTQ.                                          41190099
412000     EXEC CICS                                                    41200099
412100         WRITEQ TS                                                41210099
412200             QUEUE (ASC-LIST-QUEUE-NAME)                          41220099
412300             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               41230099
412400             ITEM  (PV-BLOCK-NUMBER)                              41240099
412500             REWRITE                                              41250099
412600             RESP  (PV-CICS-RESP)                                 41260099
412700     END-EXEC.                                                    41270099
412800                                                                  41280099
412900     IF  PV-CICS-RESP = DFHRESP(NORMAL)                           41290099
413000         CONTINUE                                                 41300099
413100     ELSE                                                         41310099
413200         SET DP013-CICS-ABEND      TO TRUE                        41320099
413300         SET DP013-NO-ROLLBACK     TO TRUE                        41330099
413400         MOVE '5105-REWRITE-ASC-LISTQ' TO DP013-PARAGRAPH         41340099
413500         MOVE 'ATTEMPTING TO REWRITE LIST TEMP STORAGE QUEUE'     41350099
413600                                   TO DP013-MESSAGE-TEXT(1)       41360099
413700         PERFORM DP013-0000-PROCESS-ABEND                         41370099
413800     END-IF.                                                      41380099
413900*                                                                 41390099
414100*----------------------------------------------------------------*41410099
414200*  WRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-       *41420099
414300*  SPECIFIC COMMAREA.                                            *41430099
414400*----------------------------------------------------------------*41440099
414600 5110-WRITE-ASC-LISTQ.                                            41460099
414700     EXEC CICS                                                    41470099
414800         WRITEQ TS                                                41480099
414900             QUEUE (ASC-LIST-QUEUE-NAME)                          41490099
415000             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               41500099
415100             ITEM  (PV-BLOCK-NUMBER)                              41510099
415200             RESP  (PV-CICS-RESP)                                 41520099
415300     END-EXEC.                                                    41530099
415400                                                                  41540099
415500     IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                      41550099
415600         SET DP013-CICS-ABEND      TO TRUE                        41560099
415700         SET DP013-NO-ROLLBACK     TO TRUE                        41570099
415800         MOVE '5110-WRITE-ASC-LISTQ'                              41580099
415900                                   TO DP013-PARAGRAPH             41590099
416000         MOVE 'ATTEMPTING TO WRITE LIST TEMP STORAGE QUEUE'       41600099
416100                                   TO DP013-MESSAGE-TEXT(1)       41610099
416200         PERFORM DP013-0000-PROCESS-ABEND                         41620099
416300     END-IF.                                                      41630099
416400*                                                                 41640099
416500*                                                                 41650099
416600*----------------------------------------------------------------*41660099
416700* READ A LIST QUEUE RECORD AND MOVE THE KEYS OF SELECTED OBJECTS *41670099
416800* TO THE SELECTED ITEMS TEMP STORAGE QUEUE RECORD.               *41680099
416900* MOVE THE KEY OF THE SELECTED LIST ITEM THAT WILL BE PASSED     *41690099
417000* TO THE DESTINATION APPLICATION.                                *41700099
417100*----------------------------------------------------------------*41710099
417200*                                                                 41720099
417300 5200-FILL-SEL-QUEUE-RECORD.                                      41730099
417500     PERFORM 6112-READ-LIST-QUEUE.                                41750099
417600                                                                  41760099
417700     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       41770099
417800         PERFORM                                                  41780099
417900         VARYING LQW-IDX                                          41790099
418000         FROM 1 BY 1                                              41800099
418100         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            41810099
418200           OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO          41820099
418300                                                                  41830099
418400             IF  LQW-SELECT (LQW-IDX)                             41840099
418500                 MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)              41850099
418600                                   TO SU004-ITEM (SU004-IDX)      41860099
418700                 MOVE SPACE        TO SU004-ACTION-SW (SU004-IDX) 41870099
418800*                                                                 41880099
418900                 MOVE LQW-SCAC-CDE (LQW-IDX)                      41890099
419000                                   TO SU004-SCAC-CDE              41900099
419100                                      (SU004-IDX)                 41910099
419200                                                                  41920099
419300                 MOVE LQW-VEH-NBR (LQW-IDX)                       41930099
419400                                   TO SU004-VEH-NBR               41940099
419500                                      (SU004-IDX)                 41950099
419600                                                                  41960099
419700                 MOVE LQW-LN-TRIP-ID (LQW-IDX)                    41970099
419800                                   TO SU004-TRIP-ID               41980099
419900                                      (SU004-IDX)                 41990099
420000*                                                                 42000099
420080                                                                  42008099
420100                 SET SU004-IDX UP BY 1                            42010099
420200                 IF  SU004-IDX > SU004-MAX-ITEMS                  42020099
420300                     PERFORM 5205-WRITE-SEL-QUEUE                 42030099
420400                     ADD +1        TO SU003-NUMBER-OF-TS-ITEMS    42040099
420500                     INITIALIZE SU004-SELECTED-ITEM-ARRAY         42050099
420600                     SET SU004-IDX TO  1                          42060099
420700                 END-IF                                           42070099
420800             END-IF                                               42080099
420900         END-PERFORM                                              42090099
421000     END-IF.                                                      42100099
421100*                                                                 42110099
421200*                                                                 42120099
421300*----------------------------------------------------------------*42130099
421400*    WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE.                *42140099
421500*----------------------------------------------------------------*42150099
421600*                                                                 42160099
421700 5205-WRITE-SEL-QUEUE.                                            42170099
421740                                                                  42174099
421800     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            42180099
421900                                   TO SU004-SELECTED-ITEMS.       42190099
422000                                                                  42200099
422100     EXEC CICS                                                    42210099
422200          WRITEQ TS                                               42220099
422300              QUEUE (ASC-SEL-QUEUE-NAME-ORIG)                     42230099
422400              FROM  (SU004-DC-SELECT-RECORD)                      42240099
422500              ITEM  (PV-SEL-QUEUE-ITEM)                           42250099
422600              RESP  (PV-CICS-RESP)                                42260099
422700     END-EXEC.                                                    42270099
422800                                                                  42280099
422900     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          42290099
423000         CONTINUE                                                 42300099
423100     ELSE                                                         42310099
423200         SET DP013-CICS-ABEND      TO TRUE                        42320099
423300         SET DP013-NO-ROLLBACK     TO TRUE                        42330099
423400         MOVE '5205-WRITE-SEL-QUEUE'                              42340099
423500                                   TO DP013-PARAGRAPH             42350099
423600         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          42360099
423700                                   TO DP013-MESSAGE-TEXT(1)       42370099
423800         PERFORM DP013-0000-PROCESS-ABEND                         42380099
423900     END-IF.                                                      42390099
424000                                                                  42400099
424100*JPL-------------------------------------------------------------*42410099
424200 5300-FILL-SEL-QUEUE-RECORD.                                      42420099
424300                                                                  42430099
424400     PERFORM 6112-READ-LIST-QUEUE.                                42440099
424500                                                                  42450099
424600     IF PV-CICS-RESP EQUAL DFHRESP(NORMAL)                        42460099
424700         PERFORM                                                  42470099
424800           VARYING LQW-IDX FROM 1 BY 1                            42480099
424900             UNTIL LQW-IDX > PC-ITEMS-PER-PANEL                   42490099
425000                OR LQW-LIST-ITEM-NUMBER (LQW-IDX) = ZERO          42500099
425100                                                                  42510099
425200             IF LQW-SELECT (LQW-IDX)                              42520099
425300                 MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)              42530099
425400                            TO TR006-ITEM (TR006-IDX)             42540099
425500                 MOVE SPACE TO TR006-ACTION-SW (TR006-IDX)        42550099
425600                 MOVE LQW-SCAC-CDE (LQW-IDX)                      42560099
425700                            TO TR006-OWNER-SCAC-ID (TR006-IDX)    42570099
425800                 MOVE LQW-LN-TRIP-ID (LQW-IDX)                    42580099
425900                            TO TR006-TRIP-ID (TR006-IDX)          42590099
426000                 MOVE LQW-VEH-NBR (LQW-IDX)                       42600099
426100                            TO TR006-VEH-NBR (TR006-IDX)          42610099
426200                 MOVE ASC-OPER-UNT-ID                             42620099
426300                            TO TR006-OPER-UNT-ID (TR006-IDX)      42630099
426400                 MOVE ASC-FCLTY-ID                                42640099
426500                            TO TR006-FCLTY-ID (TR006-IDX)         42650099
426600                                                                  42660099
426700                 SET TR006-IDX UP BY 1                            42670099
426800                 IF TR006-IDX > TR006-MAX-ITEMS                   42680099
426900                     PERFORM 5305-WRITE-SEL-QUEUE                 42690099
427000                     ADD +1  TO RC015-NUMBER-OF-TS-ITEMS          42700099
427100                     INITIALIZE TR006-SELECTED-ITEM-ARRAY         42710099
427200                     SET TR006-IDX TO 1                           42720099
427300                 END-IF                                           42730099
427400             END-IF                                               42740099
427500         END-PERFORM                                              42750099
427600     END-IF.                                                      42760099
427700                                                                  42770099
427800*JPL-------------------------------------------------------------*42780099
427900*    WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE.                *42790099
428000*----------------------------------------------------------------*42800099
428100 5305-WRITE-SEL-QUEUE.                                            42810099
428200                                                                  42820099
428300     MOVE ASC-NUMBER-OF-SELECTED-ITEMS TO TR006-SELECTED-ITEMS.   42830099
428400                                                                  42840099
428500     EXEC CICS                                                    42850099
428600          WRITEQ TS                                               42860099
428700              QUEUE (ASC-SEL-QUEUE-NAME)                          42870099
428800              FROM  (TR006-DOCK-SCHEDULE-REC)                     42880099
428900              ITEM  (PV-SEL-QUEUE-ITEM)                           42890099
429000              RESP  (PV-CICS-RESP)                                42900099
429100     END-EXEC.                                                    42910099
429200                                                                  42920099
429300     IF PV-CICS-RESP = DFHRESP (NORMAL)                           42930099
429400         CONTINUE                                                 42940099
429500     ELSE                                                         42950099
429600         SET DP013-CICS-ABEND        TO TRUE                      42960099
429700         SET DP013-NO-ROLLBACK       TO TRUE                      42970099
429800         MOVE '5305-WRITE-SEL-QUEUE' TO DP013-PARAGRAPH           42980099
429900         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          42990099
430000                                     TO DP013-MESSAGE-TEXT(1)     43000099
430100         PERFORM DP013-0000-PROCESS-ABEND                         43010099
430200     END-IF.                                                      43020099
430300                                                                  43030099
430400******************************************************************43040099
430500** WHEN RETURNING TO THIS TRANSACTION FROM ANOTHER TRANSACTION, **43050099
430600** SETUP THE ARRAY AS IT WAS WHEN WE HAD LEFT PREVIOUSLY.  EDIT **43060099
430700** THE SELECTIONS MADE AT THAT TIME AND DISPLAY THE PANEL TO    **43070099
430800** THE USER.                                                    **43080099
430900******************************************************************43090099
431000*                                                                 43100099
431100 6000-REFRESH-PANEL-FROM-TEMP.                                    43110099
431110                                                                  43111099
431193                                                                  43119399
431200     IF  ASC-UPDATE-TSQ AND ASC-NUMBER-OF-SELECTED-ITEMS > 0      43120099
431300         SET ASC-NO-TSQ-UPDATE TO TRUE                            43130099
431400         MOVE ZERO                 TO PV-SAVE-ITEM                43140099
431500                                      PV-SEL-QUEUE-ITEM           43150099
431600         MOVE ASC-NUMBER-OF-SELECTED-ITEMS                        43160099
431700                                   TO PV-HOLD-SELECTED-ITEMS      43170099
431800         MOVE +1                   TO PV-ITEMS-PROCESSED          43180099
431900*JPL                                                              43190099
432000         IF ASC-FUNC02-RETURN-YES                                 43200099
432100             PERFORM 6200-UPDATE-TSQ                              43210099
432200               UNTIL PV-ITEMS-PROCESSED > PV-HOLD-SELECTED-ITEMS  43220099
432300         ELSE                                                     43230099
432400             PERFORM 6100-UPDATE-TSQ                              43240099
432500               UNTIL PV-ITEMS-PROCESSED > PV-HOLD-SELECTED-ITEMS  43250099
432600         END-IF                                                   43260099
432700*JPL                                                              43270099
432800         SET ASC-FUNC02-RETURN-NO TO TRUE                         43280099
432900                                                                  43290099
433000*        PERFORM 6010-DELETE-SEL-QUEUE                            43300099
433100         INITIALIZE ASC-BLOCK-ENTRIES (1)                         43310099
433200                    ASC-BLOCK-ENTRIES (2)                         43320099
433300     END-IF.                                                      43330099
433400                                                                  43340099
433500*----------------------------------------------------------------*43350099
433600*    DELETE THE SELECTED ITEMS TEMP STORAGE QUEUE.               *43360099
433700*----------------------------------------------------------------*43370099
433800*                                                                 43380099
433900 6010-DELETE-SEL-QUEUE.                                           43390099
434000     EXEC CICS                                                    43400099
434100         DELETEQ TS                                               43410099
434200             QUEUE (ASC-SEL-QUEUE-NAME-ORIG)                      43420099
434300             RESP  (PV-CICS-RESP)                                 43430099
434400     END-EXEC.                                                    43440099
434500                                                                  43450099
434600     IF ((PV-CICS-RESP = DFHRESP(NORMAL)) OR                      43460099
434700         (PV-CICS-RESP = DFHRESP(QIDERR)))                        43470099
434800         CONTINUE                                                 43480099
434900     ELSE                                                         43490099
435000         SET DP013-CICS-ABEND      TO TRUE                        43500099
435100         SET DP013-NO-ROLLBACK     TO TRUE                        43510099
435200         MOVE '6010-DELETE-SEL-QUEUE'                             43520099
435300                                   TO DP013-PARAGRAPH             43530099
435400         MOVE 'ERROR TRYING TO DELETE SELECTION TS QUEUE'         43540099
435500                                   TO DP013-MESSAGE-TEXT (1)      43550099
435600         PERFORM DP013-0000-PROCESS-ABEND                         43560099
435700     END-IF.                                                      43570099
435800*                                                                 43580099
436000*----------------------------------------------------------------*43600099
436100*    INCREMENT THE TSQ ITEM NUMBER AND READ THE LIST QUEUE.      *43610099
436200*    LOOP THROUGH THE LIST QUEUE TO OBTAIN THE LINE ITEM NUMBER  *43620099
436300*    TO BE USED TO UPDATE (DESELECT) THE CORRECT LINE ITEM IN    *43630099
436400*    THE TEMP QUEUE.                                             *43640099
436500*----------------------------------------------------------------*43650099
436600*                                                                 43660099
436710 6100-UPDATE-TSQ.                                                 43671099
436720                                                                  43672099
436800     ADD 1  TO  PV-SEL-QUEUE-ITEM.                                43680099
436900     PERFORM 6105-READ-SEL-QUEUE                                  43690099
436910                                                                  43691099
437000     PERFORM                                                      43700099
437100         VARYING SU004-IDX                                        43710099
437200         FROM 1 BY 1                                              43720099
437300         UNTIL ((PV-ITEMS-PROCESSED >                             43730099
437400                              PV-HOLD-SELECTED-ITEMS)             43740099
437500         OR (SU004-IDX GREATER THAN SU004-MAX-ITEMS))             43750099
437600         IF  SU004-ACTION-SW (SU004-IDX) > SPACE                  43760099
437700             PERFORM 6110-PROCESS-ITEMS                           43770099
437800         END-IF                                                   43780099
437900         ADD +1                TO PV-ITEMS-PROCESSED              43790099
438000     END-PERFORM.                                                 43800099
438100     PERFORM 6111-WRITE-LIST-QUEUE.                               43810099
438200*                                                                 43820099
438300*                                                                 43830099
438400*----------------------------------------------------------------*43840099
438500*    READ THE LIST QUEUE RECORD.                                 *43850099
438600*----------------------------------------------------------------*43860099
438700*                                                                 43870099
438800 6105-READ-SEL-QUEUE.                                             43880099
438900     EXEC CICS                                                    43890099
439000          READQ TS                                                43900099
439100              QUEUE (ASC-SEL-QUEUE-NAME-ORIG)                     43910099
439200              INTO  (SU004-DC-SELECT-RECORD)                      43920099
439300              ITEM  (PV-SEL-QUEUE-ITEM)                           43930099
439400              RESP  (PV-CICS-RESP)                                43940099
439500     END-EXEC.                                                    43950099
439600*                                                                 43960099
439700     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          43970099
439800         CONTINUE                                                 43980099
439900     ELSE                                                         43990099
440000         SET DP013-CICS-ABEND      TO  TRUE                       44000099
440100         SET DP013-NO-ROLLBACK     TO  TRUE                       44010099
440200         MOVE '6105-READ-SEL-QUEUE'                               44020099
440300                                   TO  DP013-PARAGRAPH            44030099
440400         MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           44040099
440500                                   TO  DP013-MESSAGE-TEXT(1)      44050099
440600                                                                  44060099
440700         MOVE ASC-SEL-TERM-ID      TO PV-SEL-TERM-ID              44070099
440800         MOVE ASC-SEL-TASK-NUMBER  TO PV-SEL-TASK-NUMBER          44080099
440900         MOVE ASC-SEL-SEQ          TO PV-SEL-SEQ                  44090099
441000         STRING ' QUEUE TERM ID-'     DELIMITED BY SIZE           44100099
441100                 PV-SEL-TERM-ID       DELIMITED BY SIZE           44110099
441200                ' QUEUE TASK-'        DELIMITED BY SIZE           44120099
441300                 PV-SEL-TASK-NUMBER   DELIMITED BY SIZE           44130099
441400                ' QUEUE SEQ-'         DELIMITED BY SIZE           44140099
441500                 PV-SEL-SEQ           DELIMITED BY SIZE           44150099
441600                                 INTO  DP013-MESSAGE-TEXT(2)      44160099
441700         PERFORM DP013-0000-PROCESS-ABEND                         44170099
441800     END-IF.                                                      44180099
441900 EJECT                                                            44190099
442000*                                                                 44200099
442200*----------------------------------------------------------------*44220099
442300*    CALCULATE THE TEMP QUEUE ITEM THAT MUST BE READ AND READ IT.*44230099
442400*    REWRITE THE CURRENT TEMP QUEUE ITEM IF NECESSARY.  CALCULATE*44240099
442500*    THE LINE ITEM OCCURENCE AND UPDATE (DESELECT) IT.           *44250099
442600*----------------------------------------------------------------*44260099
442800 6110-PROCESS-ITEMS.                                              44280099
442900                                                                  44290099
443000     COMPUTE PV-ITEM = 1 + ((SU004-ITEM (SU004-IDX) - 1)          44300099
443100                     / PC-ITEMS-PER-PANEL).                       44310099
443200                                                                  44320099
443300     IF  PV-ITEM NOT EQUAL PV-SAVE-ITEM                           44330099
443400         IF  PV-SAVE-ITEM NOT EQUAL ZERO                          44340099
443500             PERFORM 6111-WRITE-LIST-QUEUE                        44350099
443600         END-IF                                                   44360099
443700         MOVE PV-ITEM          TO PV-SAVE-ITEM                    44370099
443800                                                                  44380099
443900         PERFORM 6112-READ-LIST-QUEUE                             44390099
444000         IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)               44400099
444100             CONTINUE                                             44410099
444200         END-IF                                                   44420099
444300     END-IF.                                                      44430099
444400                                                                  44440099
444500     COMPUTE PV-SUB = (SU004-ITEM (SU004-IDX)                     44450099
444600                    - LQW-LIST-ITEM-NUMBER (1)) + 1.              44460099
444700     SET LQW-DESELECT (PV-SUB) TO    TRUE                         44470099
444800     MOVE LQW-SELECTED-SW (PV-SUB)                                44480099
444900                               TO LQW-TEMP-SELECTED-SW (PV-SUB).  44490099
445000     EVALUATE TRUE                                                44500099
445100         WHEN SU004-INQ (SU004-IDX)                               44510099
445200              MOVE PC-INQ      TO LQW-ACTION (PV-SUB)             44520099
445300                                                                  44530099
445400         WHEN SU004-UPD (SU004-IDX)                               44540099
445500              MOVE PC-UPD      TO LQW-ACTION (PV-SUB)             44550099
445600                                                                  44560099
445700         WHEN SU004-DEL (SU004-IDX)                               44570099
445800              MOVE PC-DEL      TO LQW-ACTION (PV-SUB)             44580099
445900                                                                  44590099
446000         WHEN SU004-ERR (SU004-IDX)                               44600099
446100              MOVE PC-ERR      TO LQW-ACTION (PV-SUB)             44610099
446200     END-EVALUATE.                                                44620099
446300                                                                  44630099
446400     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                44640099
446500*                                                                 44650099
446600*                                                                 44660099
446700*----------------------------------------------------------------*44670099
446800*    WRITE THE TS QUEUE RECORD JUST UPDATED IN S550.             *44680099
446900*----------------------------------------------------------------*44690099
447000*                                                                 44700099
447100 6111-WRITE-LIST-QUEUE.                                           44710099
447200     EXEC CICS                                                    44720099
447300         WRITEQ TS                                                44730099
447400             QUEUE (ASC-LIST-QUEUE-NAME)                          44740099
447500             FROM  (LQW-LIST-QUEUE-WORK-AREA)                     44750099
447600             ITEM  (PV-SAVE-ITEM)                                 44760099
447700             REWRITE                                              44770099
447800             RESP  (PV-CICS-RESP)                                 44780099
447900     END-EXEC.                                                    44790099
448000*                                                                 44800099
448100     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          44810099
448200         CONTINUE                                                 44820099
448300     ELSE                                                         44830099
448400         SET DP013-CICS-ABEND  TO  TRUE                           44840099
448500         SET DP013-NO-ROLLBACK TO  TRUE                           44850099
448600         MOVE '6111-WRITE-LIST-QUEUE'                             44860099
448700                               TO  DP013-PARAGRAPH                44870099
448800         MOVE 'ATTEMPTING TO WRITE LIST QUEUE'                    44880099
448900                               TO  DP013-MESSAGE-TEXT(1)          44890099
449000         PERFORM DP013-0000-PROCESS-ABEND                         44900099
449100     END-IF.                                                      44910099
449200                                                                  44920099
449500*                                                                 44950099
449600*----------------------------------------------------------------*44960099
449700*    READ THE TEMPORARY STORAGE QUEUE INTO A TEMPORARY WORK AREA.*44970099
449800*----------------------------------------------------------------*44980099
449900*                                                                 44990099
450000 6112-READ-LIST-QUEUE.                                            45000099
450100     EXEC CICS                                                    45010099
450200         READQ TS                                                 45020099
450300             QUEUE (ASC-LIST-QUEUE-NAME)                          45030099
450400             INTO  (LQW-LIST-QUEUE-WORK-AREA)                     45040099
450500             ITEM  (PV-ITEM)                                      45050099
450600             RESP  (PV-CICS-RESP)                                 45060099
450700     END-EXEC.                                                    45070099
450800                                                                  45080099
450900     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          45090099
451000         CONTINUE                                                 45100099
451100     ELSE                                                         45110099
451200         SET DP013-CICS-ABEND      TO TRUE                        45120099
451300         SET DP013-NO-ROLLBACK     TO TRUE                        45130099
451400         MOVE '6112-READ-LIST-QUEUE'                              45140099
451500                                   TO DP013-PARAGRAPH             45150099
451600         MOVE 'ATTEMPTING TO READ LIST QUEUE'                     45160099
451700                                   TO DP013-MESSAGE-TEXT(1)       45170099
451800         PERFORM DP013-0000-PROCESS-ABEND                         45180099
451900     END-IF.                                                      45190099
452000*                                                                 45200099
452100*JPL-------------------------------------------------------------*45210099
452200 6200-UPDATE-TSQ.                                                 45220099
452300                                                                  45230099
452400     ADD 1 TO PV-SEL-QUEUE-ITEM.                                  45240099
452500     PERFORM 6205-READ-SEL-QUEUE.                                 45250099
452600                                                                  45260099
452700     PERFORM                                                      45270099
452800       VARYING TR006-IDX FROM 1 BY 1                              45280099
452900         UNTIL ((PV-ITEMS-PROCESSED > PV-HOLD-SELECTED-ITEMS)     45290099
453000            OR (TR006-IDX > TR006-MAX-ITEMS))                     45300099
453100                                                                  45310099
453200         IF TR006-ACTION-SW (TR006-IDX) > SPACE                   45320099
453300             PERFORM 6210-PROCESS-ITEMS                           45330099
453400         END-IF                                                   45340099
453500                                                                  45350099
453600         ADD +1 TO PV-ITEMS-PROCESSED                             45360099
453700     END-PERFORM.                                                 45370099
453800                                                                  45380099
453900     PERFORM 6111-WRITE-LIST-QUEUE.                               45390099
454000                                                                  45400099
454100*----------------------------------------------------------------*45410099
454200*    READ THE LIST QUEUE RECORD.                                 *45420099
454300*JPL-------------------------------------------------------------*45430099
454400 6205-READ-SEL-QUEUE.                                             45440099
454500                                                                  45450099
454600     EXEC CICS                                                    45460099
454700          READQ TS                                                45470099
454800              QUEUE (ASC-SEL-QUEUE-NAME-ORIG)                     45480099
454900              INTO  (TR006-DOCK-SCHEDULE-REC)                     45490099
455000              ITEM  (PV-SEL-QUEUE-ITEM)                           45500099
455100              RESP  (PV-CICS-RESP)                                45510099
455200     END-EXEC.                                                    45520099
455300                                                                  45530099
455400     IF PV-CICS-RESP = DFHRESP (NORMAL)                           45540099
455500         CONTINUE                                                 45550099
455600     ELSE                                                         45560099
455700         SET DP013-CICS-ABEND       TO  TRUE                      45570099
455800         SET DP013-NO-ROLLBACK      TO  TRUE                      45580099
455900         MOVE '6205-READ-SEL-QUEUE' TO  DP013-PARAGRAPH           45590099
456000         MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           45600099
456100                                    TO  DP013-MESSAGE-TEXT(1)     45610099
456200                                                                  45620099
456300         MOVE ASC-SEL-TERM-ID       TO PV-SEL-TERM-ID             45630099
456400         MOVE ASC-SEL-TASK-NUMBER   TO PV-SEL-TASK-NUMBER         45640099
456500         MOVE ASC-SEL-SEQ           TO PV-SEL-SEQ                 45650099
456600         STRING ' QUEUE TERM ID-'   DELIMITED BY SIZE             45660099
456700                 PV-SEL-TERM-ID     DELIMITED BY SIZE             45670099
456800                ' QUEUE TASK-'      DELIMITED BY SIZE             45680099
456900                 PV-SEL-TASK-NUMBER DELIMITED BY SIZE             45690099
457000                ' QUEUE SEQ-'       DELIMITED BY SIZE             45700099
457100                 PV-SEL-SEQ         DELIMITED BY SIZE             45710099
457200                                    INTO DP013-MESSAGE-TEXT(2)    45720099
457300         PERFORM DP013-0000-PROCESS-ABEND                         45730099
457400     END-IF.                                                      45740099
457500                                                                  45750099
457600*----------------------------------------------------------------*45760099
457700*    CALCULATE THE TEMP QUEUE ITEM THAT MUST BE READ AND READ IT.*45770099
457800*    REWRITE THE CURRENT TEMP QUEUE ITEM IF NECESSARY.  CALCULATE*45780099
457900*    THE LINE ITEM OCCURENCE AND UPDATE (DESELECT) IT.           *45790099
458000*JPL-------------------------------------------------------------*45800099
458100 6210-PROCESS-ITEMS.                                              45810099
458200                                                                  45820099
458300     COMPUTE PV-ITEM = 1 + ((TR006-ITEM (TR006-IDX) - 1)          45830099
458400                     / PC-ITEMS-PER-PANEL).                       45840099
458500                                                                  45850099
458600     IF PV-ITEM NOT EQUAL PV-SAVE-ITEM                            45860099
458700         IF PV-SAVE-ITEM NOT EQUAL ZERO                           45870099
458800             PERFORM 6111-WRITE-LIST-QUEUE                        45880099
458900         END-IF                                                   45890099
459000                                                                  45900099
459100         MOVE PV-ITEM TO PV-SAVE-ITEM                             45910099
459200                                                                  45920099
459300         PERFORM 6112-READ-LIST-QUEUE                             45930099
459400                                                                  45940099
459500         IF PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)                45950099
459600             CONTINUE                                             45960099
459700         END-IF                                                   45970099
459800     END-IF.                                                      45980099
459900                                                                  45990099
460000     COMPUTE PV-SUB = (TR006-ITEM (TR006-IDX)                     46000099
460100                    - LQW-LIST-ITEM-NUMBER (1)) + 1.              46010099
460200                                                                  46020099
460300     SET LQW-DESELECT (PV-SUB) TO TRUE                            46030099
460400     MOVE LQW-SELECTED-SW (PV-SUB)                                46040099
460500                               TO LQW-TEMP-SELECTED-SW (PV-SUB).  46050099
460600                                                                  46060099
460700     EVALUATE TRUE                                                46070099
460800         WHEN TR006-INQ (TR006-IDX)                               46080099
460900              MOVE PC-INQ      TO LQW-ACTION (PV-SUB)             46090099
461000                                                                  46100099
461100         WHEN TR006-UPD (TR006-IDX)                               46110099
461200              MOVE PC-UPD      TO LQW-ACTION (PV-SUB)             46120099
461300                                                                  46130099
461400         WHEN TR006-DEL (TR006-IDX)                               46140099
461500              MOVE PC-DEL      TO LQW-ACTION (PV-SUB)             46150099
461600                                                                  46160099
461700         WHEN TR006-ERR (TR006-IDX)                               46170099
461800              MOVE PC-ERR      TO LQW-ACTION (PV-SUB)             46180099
461900     END-EVALUATE.                                                46190099
462000                                                                  46200099
462100     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                46210099
462200                                                                  46220099
462201*---------------------------------------------------------------  46220199
462202*9999-WRITE-CSSL.                                                 46220299
462203*    MOVE LENGTH OF PV-CICS-MSG-AREA-3                            46220399
462260*      TO PV-COMMAREA-LENGTH                                      46226099
462270*    EXEC CICS                                                    46227099
462280*         WRITEQ TD                                               46228099
462290*          QUEUE  ('CSSL')                                        46229099
462291*           FROM  (PV-CICS-MSG-AREA-3)                            46229199
462292*         LENGTH  (PV-COMMAREA-LENGTH)                            46229299
462293*           RESP  (PV-CICS-RESP)                                  46229399
462294*    END-EXEC.                                                    46229499
462295*                                                                 46229599
462300*                                                                 46230099
462400*----------------------------------------------------------------*46240099
462500*    ABEND PROCESSOR MODULE                                      *46250099
462600*----------------------------------------------------------------*46260099
462700     COPY DPPD013.                                                46270099
462800*----------------------------------------------------------------*46280099
462900*----------------------------------------------------------------*46290099
