000100 IDENTIFICATION DIVISION.                                         00010000
000200 PROGRAM-ID.    MLKUT618.                                         00020013
000300 AUTHOR.        JOHN SELWITSCHKA.                                 00030000
000400 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00040000
000500 DATE-WRITTEN.  01-16-07.                                         00050000
000600 DATE-COMPILED.                                                   00060000
000700******************************************************************00070000
000800*                                                                 00080000
000900* MLKUT618 - CREATE THE DATA INTEGRITY EXTRACT FILE FOR           00090013
001000*            MLT_WKLY_SUM (WEEK/DEPT/MAJ_CL LEVEL)                00100000
001010*                                                                 00101000
001014* THIS PROGRAM WILL TAKE THE SORTED MLT_WKLY_SUM FILE AND FORMAT  00101400
001015* THE DATA TO DATA INTEGRITY EXTRACT COPYBOOK MLRD141 AND CREATE  00101513
001016* A DATA INTEGRITY EXTRACT FILE.                                  00101613
001070*                                                                 00107000
001080*CHANGE HISTORY:                                                  00108000
001090* WR/PROJ DATE       PGMR        DESCRIPTION OF CHANGES           00109000
001100* ------- ---------- ----------- -------------------------------- 00110000
001200* WR28582 01-16-2007 JOHN SELWITSCHKA                             00120000
001200*                                NEW PROGRAM                      00121000
001300******************************************************************00130000
001400                                                                  00140000
001500 ENVIRONMENT DIVISION.                                            00150000
001600 CONFIGURATION SECTION.                                           00160000
001700 SOURCE-COMPUTER.        IBM-3090.                                00170000
001800 OBJECT-COMPUTER.        IBM-3090.                                00180000
001900 INPUT-OUTPUT SECTION.                                            00190000
002000 FILE-CONTROL.                                                    00200000
002100                                                                  00210000
002200     SELECT DATA-INTEGRITY-CTL-FILE                               00220000
002300         ASSIGN TO INP01.                                         00230000
002400                                                                  00240000
002500     SELECT DATA-INTEGRITY-EXTR-FILE                              00250000
002600         ASSIGN TO OUT01.                                         00260000
002700                                                                  00270000
002800 DATA DIVISION.                                                   00280000
002900 FILE SECTION.                                                    00290000
003000                                                                  00300000
003100 FD  DATA-INTEGRITY-CTL-FILE                                      00310000
003200     LABEL RECORDS ARE STANDARD                                   00320000
003300     RECORDING MODE IS F                                          00330000
003400     BLOCK CONTAINS 0 RECORDS.                                    00340000
003500 01  DATA-INTEGRITY-CTL-REC      PIC X(349).                      00350000
003600                                                                  00360000
003700 FD  DATA-INTEGRITY-EXTR-FILE                                     00370000
003800     RECORDING MODE IS F                                          00380000
003900     LABEL RECORDS ARE STANDARD                                   00390000
004000     BLOCK CONTAINS 0 RECORDS.                                    00400000
004100                                                                  00410000
004200 01  DATA-INTEGRITY-EXTR-REC     PIC X(204).                      00420009
004300                                                                  00430000
004400******************************************************************00440000
004500 WORKING-STORAGE SECTION.                                         00450000
004600******************************************************************00460000
004700                                                                  00470000
004800 01  PS-PROGRAM-SWITCHES.                                         00480000
004810     05  PS-END-OF-INPUT-SW      PIC X       VALUE 'N'.           00481000
004820         88  PS-END-OF-INPUT                 VALUE 'Y'.           00482000
004830         88  PS-END-OF-INPUT-NO              VALUE 'N'.           00483000
004900     05  PS-MLT00005-DONE        PIC X       VALUE 'N'.           00490000
005000         88  PS-MLT00005-IS-DONE             VALUE 'Y'.           00500000
005100         88  PS-MLT00005-IS-NOT-DONE         VALUE 'N'.           00510000
005200                                                                  00520000
005300 01  PV-PROGRAM-VARIABLES.                                        00530000
005400     05  PV-OPN-MONTH-FIRST-WEEK PIC X(10).                       00540000
005500     05  PV-DEPT-NBR             PIC 9(03)  VALUE ZEROS.          00550000
005600     05  PV-MAJ-CL-NBR           PIC 9(02)  VALUE ZEROS.          00560000
005700     05  PV-SUB-CL-NBR           PIC 9(02)  VALUE ZEROS.          00570000
005800     05  PV-LOC-NBR              PIC 9(04)  VALUE ZEROS.          00580000
005900     05  PV-FSCL-DTE             PIC X(10).                       00590000
005910     05  PV-FSCL-MN-END-DTE      PIC X(10).                       00591001
006000     05  PV-FSCL-MN-NBR          PIC X(02).                       00600001
006100     05  PV-PARTN-NBR            PIC S9(4)V COMP.                 00610000
006200                                                                  00620000
006210     05  PV-DKEY-NBR.                                             00621000
006230         10  PV-DKEY-WK-NBR      PIC X(02).                       00623000
006240         10  PV-DKEY-MN-NBR      PIC X(02).                       00624000
006250         10  FILLER              PIC X(11).                       00625000
006260                                                                  00626000
006300 01  PA-PROGRAM-ACCUMULATORS.                                     00630000
006301     05  PA-INPUT-FILES           PIC S9(13) VALUE ZEROS.         00630100
006310     05  PA-MLT00005-ROWS-FETCHED PIC S9(13) VALUE ZEROS.         00631000
006320     05  PA-TDTATTR-ROWS-SELECTED PIC S9(13) VALUE ZEROS.         00632000
006330     05  PA-OUTPUT-RECS-WRITTEN   PIC S9(13) VALUE ZEROS.         00633000
006340                                                                  00634000
006350 01  PC-PROGRAM-CONSTANTS.                                        00635000
006360     05  PC-MAX-TBL-ROWS         PIC S9(03)  VALUE +120.          00636000
006360     05  PC-Y                    PIC X       VALUE 'Y'.           00636100
006370                                                                  00637000
006380 01  TABLE-FOR-MONTH-DATA.                                        00638000
006390     05  TABLE-WEEKEND-ENTRIES   OCCURS 450 TIMES                 00639000
006400                                 INDEXED BY MTH-IDX.              00640000
006410         10  TBL-FSCL-DTE        PIC X(10).                       00641000
006420         10  TBL-MONTHEND-DTE    PIC X(10).                       00642000
006430         10  TBL-MONTHEND-NBR    PIC X(02).                       00643000
006440                                                                  00644000
006450 01  CD-COUNTER-DISPLAY.                                          00645000
006460     05  CD-COUNT-HOLD1          PIC Z,ZZZ,ZZZ,ZZZ,ZZ9.           00646000
006470                                                                  00647000
006480 01 ABEND-AREAS.                                                  00648000
006490     05 ABEND-CODE               PIC S9(04)  VALUE ZEROS          00649000
006500                                             COMP SYNC.           00650000
006600         88  AC-BAD-DATA                     VALUE +4003.         00660000
006700         88  AC-DB2-ERROR                    VALUE +4013.         00670000
006800     05  AA-ABEND-LIT            PIC X(40)   VALUE                00680000
006900             '*****       ABEND'.                                 00690000
007000     05  AA-PROGRAM-LIT          PIC X(40)   VALUE                00700000
007100             '*****   PROGRAM: MLKUT618'.                         00710013
007200     05  AA-PARAGRAPH-LIT.                                        00720000
007300         10  FILLER              PIC X(17)   VALUE                00730000
007400             '***** PARAGRAPH: '.                                 00740000
007500         10  AA-PARAGRAPH-NAME   PIC X(35)   VALUE SPACES.        00750000
007600     05  AA-MESSAGE-LINE.                                         00760000
007700         10  FILLER              PIC X(06)   VALUE '*****'.       00770000
007800         10  AA-MESSAGE          PIC X(127)  VALUE SPACES.        00780000
007900     05  AA-DB2-ERROR-LIT        PIC X(40)   VALUE                00790000
008000             '*****    DB2 ERROR'.                                00800000
008100     05  AA-DB2-OPERATION-LIT.                                    00810000
008200         10  FILLER              PIC X(17)   VALUE                00820000
008300             '***** OPERATION: '.                                 00830000
008400         10  AA-DB2-OPERATION.                                    00840000
008500             15  AA-DB2-OP-1     PIC X(25)   VALUE SPACES.        00850000
008600             15  AA-DB2-OP-2     PIC X(25)   VALUE SPACES.        00860000
008700     05  AA-DB2-TABLE-1          PIC X(08)   VALUE SPACES.        00870000
008800     05  AA-DB2-TABLE-2          PIC X(08)   VALUE SPACES.        00880000
008900     05  AA-DB2-TABLE-3          PIC X(08)   VALUE SPACES.        00890000
009000     05  AA-DB2-TABLE-4          PIC X(08)   VALUE SPACES.        00900000
009100                                                                  00910000
009200 EJECT                                                            00920000
009300                                                                  00930000
009400*** DATA INTEGRITY CONTROL CARD                                   00940000
009500     COPY MLRD110.                                                00950000
009600                                                                  00960000
009800*** DATA INTEGRITY MLT_WKLY_SUM EXTRACT FILE                      00980000
009900     COPY MLRD141.                                                00990013
010000                                                                  01000000
010100 EJECT                                                            01010000
010200                                                                  01020000
010300******************************************************************01030000
010400*  DB2 ERROR MESSAGES FORMAT AREA.                                01040000
010500******************************************************************01050000
010600     COPY DPWS004.                                                01060000
010700                                                                  01070000
010800******************************************************************01080000
010900*  DB2 ERRORS                                                     01090000
011000******************************************************************01100000
011100     COPY SQLCA2.                                                 01110000
011200                                                                  01120000
011300******************************************************************01130000
011400*  DB2 COMMUNICATION AREA                                         01140000
011500******************************************************************01150000
011600     EXEC SQL                                                     01160000
011700          INCLUDE SQLCA                                           01170000
011800     END-EXEC.                                                    01180000
011900                                                                  01190000
012000******************************************************************01200000
012100*  M/L DETAIL TABLE - PARTITION BALANCING TABLE                   01210000
012200******************************************************************01220000
012300     EXEC SQL                                                     01230000
012400         INCLUDE MLT00002                                         01240000
012410     END-EXEC.                                                    01241000
012420*                                                                 01242000
012430******************************************************************01243000
012440*  M/L DETAIL TABLE - PARTITION CONTROL TABLE                     01244000
012450******************************************************************01245000
012460     EXEC SQL                                                     01246000
012470         INCLUDE MLT00003                                         01247000
012480     END-EXEC.                                                    01248000
012490*                                                                 01249000
012500******************************************************************01250000
012600*  DB2 MLT_WKLY_SUM TABLE LAYOUT                                  01260000
012700******************************************************************01270000
012800     EXEC SQL                                                     01280000
012900          INCLUDE MLT00005                                        01290000
013000     END-EXEC.                                                    01300000
013100*                                                                 01310000
013200******************************************************************01320000
013210*  DB2 TDTATTR TABLE LAYOUT                                       01321000
013220******************************************************************01322000
013230     EXEC SQL                                                     01323000
013231          INCLUDE TDTATTR                                         01323100
013232     END-EXEC.                                                    01323200
013233                                                                  01323300
015710 EJECT                                                            01571000
015730******************************************************************01573000
015740 PROCEDURE DIVISION.                                              01574000
015750******************************************************************01575000
015760                                                                  01576000
015770******************************************************************01577000
015780 0000-MAINLINE-MLKUT618.                                          01578013
015790******************************************************************01579000
015800*                                                                 01580000
015900     PERFORM 1000-INITIALIZATION.                                 01590000
016000                                                                  01600000
016100     PERFORM 2000-MAIN-PROCESS.                                   01610000
016200                                                                  01620000
016300     PERFORM 8000-EOJ.                                            01630000
016400                                                                  01640000
016500     STOP RUN.                                                    01650000
016600                                                                  01660000
016700 EJECT                                                            01670000
016800                                                                  01680000
016900******************************************************************01690000
017000 1000-INITIALIZATION.                                             01700000
017100******************************************************************01710000
017200*                                                                 01720000
017300     OPEN INPUT  DATA-INTEGRITY-CTL-FILE.                         01730015
017400     OPEN OUTPUT DATA-INTEGRITY-EXTR-FILE.                        01740000
017500                                                                  01750000
017600     PERFORM 4000-READ-INPUT-FILE.                                01760000
017700                                                                  01770000
018800     INITIALIZE PA-PROGRAM-ACCUMULATORS.                          01880000
018900     INITIALIZE PV-PROGRAM-VARIABLES.                             01890000
019000     INITIALIZE TABLE-FOR-MONTH-DATA.                             01900000
019100                                                                  01910000
019210*                                                                 01921000
019220 EJECT                                                            01922000
019230                                                                  01923000
019240******************************************************************01924000
019250 2000-MAIN-PROCESS.                                               01925000
019260******************************************************************01926000
019270*                                                                 01927000
019500     PERFORM                                                      01950000
019600       UNTIL PS-END-OF-INPUT                                      01960000
019700*        PERFORM 2100-GET-MONTH-DATA                              01970007
019800         PERFORM 5000-WRITE-EXTRACT                               01980000
019900         PERFORM 4000-READ-INPUT-FILE                             01990000
020000         ADD  1           TO PA-INPUT-FILES                       02000000
020100     END-PERFORM.                                                 02010000
020300                                                                  02030000
020400 EJECT                                                            02040000
020500                                                                  02050000
020600******************************************************************02060000
020700 2100-GET-MONTH-DATA.                                             02070000
020800******************************************************************02080000
020900                                                                  02090000
021000     SET MTH-IDX                 TO 1.                            02100000
021100     SEARCH TABLE-WEEKEND-ENTRIES                                 02110000
021200         AT END                                                   02120000
021210             PERFORM 7400-SELECT-TDTATTR                          02121000
021220             ADD 1               TO PA-TDTATTR-ROWS-SELECTED      02122000
021230             MOVE MLT00005-FSCL-WK-END-DTE                        02123000
021240                                 TO PV-FSCL-DTE                   02124000
021241             MOVE DTATTR-FSCL-MN-END-DTE                          02124100
021242                                 TO PV-FSCL-MN-END-DTE            02124200
021250             MOVE DTATTR-FSCL-MN-NBR                              02125000
021260                                 TO PV-FSCL-MN-NBR                02126000
021270             IF PA-TDTATTR-ROWS-SELECTED > PC-MAX-TBL-ROWS        02127000
021280                 CONTINUE                                         02128000
021290             ELSE                                                 02129000
021300                 SET MTH-IDX     TO PA-TDTATTR-ROWS-SELECTED      02130000
021303                 MOVE MLT00005-FSCL-WK-END-DTE                    02130300
021304                                 TO TBL-FSCL-DTE     (MTH-IDX)    02130400
021305                 MOVE DTATTR-FSCL-MN-END-DTE                      02130500
021306                                 TO TBL-MONTHEND-DTE (MTH-IDX)    02130600
021307                 MOVE DTATTR-FSCL-MN-NBR                          02130700
021308                                 TO TBL-MONTHEND-NBR (MTH-IDX)    02130800
021309             END-IF                                               02130900
021311         WHEN TBL-FSCL-DTE  (MTH-IDX) = MLT00005-FSCL-WK-END-DTE  02131100
021312             MOVE TBL-MONTHEND-DTE (MTH-IDX)                      02131200
021313                                 TO PV-FSCL-MN-END-DTE            02131300
021314             MOVE TBL-MONTHEND-NBR (MTH-IDX)                      02131400
021315                                 TO PV-FSCL-MN-NBR                02131500
021316     END-SEARCH.                                                  02131600
021317                                                                  02131700
021318 EJECT                                                            02131800
021319                                                                  02131900
021320******************************************************************02132000
021321 4000-READ-INPUT-FILE.                                            02132100
021322******************************************************************02132200
021323*                                                                 02132300
021330     READ DATA-INTEGRITY-CTL-FILE                                 02133000
021340       INTO DCLMLT00005                                           02134000
021350         AT END                                                   02135000
021360             SET PS-END-OF-INPUT    TO TRUE.                      02136000
021700                                                                  02170000
022000******************************************************************02200000
022100 5000-WRITE-EXTRACT.                                              02210000
022200******************************************************************02220000
022300*                                                                 02230000
022400*    MOVE PV-FSCL-MN-END-DTE       TO ML141-FSCL-MN-END-DTE.      02240013
022500*    MOVE PV-FSCL-MN-NBR           TO ML141-FSCL-MN-NBR.          02250013
022400     MOVE MLT00005-FSCL-WK-END-DTE TO ML141-FSCL-WK-END-DTE.      02251013
022600     MOVE MLT00005-DEPT-NBR        TO PV-DEPT-NBR.                02260000
022700     MOVE PV-DEPT-NBR              TO ML141-DEPT-NBR.             02270013
022800     MOVE MLT00005-MAJ-CL-NBR      TO PV-MAJ-CL-NBR.              02280000
022900     MOVE PV-MAJ-CL-NBR            TO ML141-MAJ-CL-NBR.           02290013
023000*    MOVE MLT00005-SUB-CL-NBR      TO PV-SUB-CL-NBR.              02300001
023100*    MOVE PV-SUB-CL-NBR            TO ML141-SUB-CL-NBR.           02310013
023200*    MOVE MLT00005-LOC-NBR         TO PV-LOC-NBR.                 02320001
023300*    MOVE PV-LOC-NBR               TO ML141-STR-NBR.              02330013
023400                                                                  02340000
023500     COMPUTE ML141-SLS-RTL-AMT  = MLT00005-SLS-REG-RTL-AMT        02350013
023600                                + MLT00005-SLS-PROMO-RTL-AMT      02360000
023700                                + MLT00005-SLS-PROCLR-RTL-AMT     02370000
023800                                + MLT00005-SLS-CLR-RTL-AMT        02380000
023900                                + MLT00005-SLS-OTH-RTL-AMT.       02390000
           MOVE MLT00005-MKDN-PLU-RTL-AMT TO ML141-MKDN-PLU-RTL-AMT.    02404113
           MOVE MLT00005-MKDN-PROMO-RTL-AMT                             02404303
                                          TO ML141-MKDN-PROMO-RTL-AMT.  02404413
           MOVE MLT00005-MKDN-RGST-RTL-AMT                              02404503
                                          TO ML141-MKDN-RGST-RTL-AMT.   02404613
           MOVE MLT00005-MKDN-GLDST-RTL-AMT                             02404803
                                          TO ML141-MKDN-GLDST-RTL-AMT.  02404913
           MOVE MLT00005-MKDN-UMTCH-RTL-AMT                             02405103
                                          TO ML141-MKDN-UMTCH-RTL-AMT.  02405213
           MOVE MLT00005-MKDN-BYR-RTL-AMT TO ML141-MKDN-BYR-RTL-AMT.    02405413
           MOVE MLT00005-MKDN-STR-RTL-AMT TO ML141-MKDN-STR-RTL-AMT.    02405613
           MOVE MLT00005-MKDN-PRPT-RTL-AMT                              02405803
                                          TO ML141-MKDN-PRPT-RTL-AMT.   02405913
           MOVE MLT00005-MKDN-OTH-RTL-AMT TO ML141-MKDN-OTH-RTL-AMT.    02406013
024050     MOVE MLT00005-MKUP-RTL-AMT     TO ML141-MKUP-RTL-AMT.        02406213
024060     MOVE MLT00005-XFER-IN-RTL-AMT  TO ML141-XFER-IN-RTL-AMT.     02406313
024070     MOVE MLT00005-XFER-OUT-RTL-AMT TO ML141-XFER-OUT-RTL-AMT.    02407013
024080     MOVE MLT00005-RCPT-RTL-AMT     TO ML141-RCPT-RTL-AMT.        02408013
024090     MOVE MLT00005-RCPT-NET-COST-AMT                              02409000
024100                                    TO ML141-RCPT-NET-COST-AMT.   02410013
024200     MOVE MLT00005-PADJ-RTL-AMT     TO ML141-PADJ-RTL-AMT.        02420013
           MOVE MLT00005-PADJ-FRGT-COST-AMT                             02421003
                                          TO ML141-PADJ-FRGT-COST-AMT.  02421113
           MOVE MLT00005-PADJ-RTV-COST-AMT                              02422003
                                          TO ML141-PADJ-RTV-COST-AMT.   02422113
           MOVE MLT00005-PADJ-RTV-RTL-AMT TO ML141-PADJ-RTV-RTL-AMT.    02423013
           MOVE MLT00005-PADJ-DA-COST-AMT TO ML141-PADJ-DA-COST-AMT.    02424013
           MOVE MLT00005-PADJ-DA-RTL-AMT  TO ML141-PADJ-DA-RTL-AMT.     02425013
024300     MOVE MLT00005-PADJ-NET-COST-AMT                              02430000
024400                                    TO ML141-PADJ-NET-COST-AMT.   02440013
           MOVE MLT00005-PADJ-OTH-COST-AMT                              02441005
                                          TO ML141-PADJ-OTH-COST-AMT.   02441113
           MOVE MLT00005-PADJ-OTH-RTL-AMT TO ML141-PADJ-OTH-RTL-AMT.    02442013
024500     MOVE MLT00005-INV-ADJ-RTL-AMT  TO ML141-INV-ADJ-RTL-AMT.     02450013
024600     MOVE MLT00005-SHNK-RTL-AMT     TO ML141-SHNK-RTL-AMT.        02460013
024700     MOVE MLT00005-END-INV-RTL-AMT                                02470017
024700                                    TO ML141-END-INV-RTL-AMT.     02470117
024701                                                                  02470500
024900     WRITE DATA-INTEGRITY-EXTR-REC                                02490000
025000         FROM ML141-DATA-INTEGRITY-EXTR-REC.                      02500013
025100     ADD 1                         TO PA-OUTPUT-RECS-WRITTEN.     02510000
025200                                                                  02520000
025300 EJECT                                                            02530000
025400                                                                  02540000
031200******************************************************************03120000
031300 7400-SELECT-TDTATTR.                                             03130000
031400******************************************************************03140000
031500*                                                                 03150000
031610     MOVE MLT00005-FSCL-WK-END-DTE TO PV-FSCL-DTE.                03161000
031700                                                                  03170000
031800     EXEC SQL                                                     03180000
031900         SELECT DISTINCT                                          03190000
031910                FSCL_MN_NBR                                       03191000
032000               ,FSCL_MN_END_DTE                                   03200000
032100               ,FSCL_WK_NBR                                       03210000
032200               ,FSCL_WK_END_DTE                                   03220000
032300         INTO  :DTATTR-FSCL-MN-NBR                                03230000
032400              ,:DTATTR-FSCL-MN-END-DTE                            03240000
032410              ,:DTATTR-FSCL-WK-NBR                                03241000
032420              ,:DTATTR-FSCL-WK-END-DTE                            03242000
032430         FROM  MLT_PARTN_CNTL A                                   03243000
032440               ,TDTATTR B                                         03244000
032450         WHERE A.FSCL_DTE = :PV-FSCL-DTE                          03245000
032451           AND A.FSCL_DTE = B.KY_DTE                              03245100
032470           AND A.TBL_TM_LVL_CDE = 'W'                             03247000
032500         WITH UR                                                  03250000
032501     END-EXEC.                                                    03250100
032502                                                                  03250200
032503     EVALUATE TRUE                                                03250300
032504         WHEN SQLCODE = 0                                         03250400
032505             CONTINUE                                             03250500
032506         WHEN OTHER                                               03250600
032507             MOVE '7400-SELECT-TDTATTR'                           03250700
032508                                 TO AA-PARAGRAPH-NAME             03250800
032509             MOVE 'TDTATTR ROW NOT FOUND'                         03250900
032510                                 TO AA-MESSAGE                    03251000
032511             MOVE 'SELECT'       TO AA-DB2-OPERATION              03251100
032512             PERFORM Z998-SQL-ERROR                               03251200
032513     END-EVALUATE.                                                03251300
032514                                                                  03251400
032515 EJECT                                                            03251500
032516                                                                  03251600
032517******************************************************************03251700
032518 8000-EOJ.                                                        03251800
032519******************************************************************03251900
032520*                                                                 03252000
032530     DISPLAY ' '.                                                 03253000
032540     DISPLAY '  PROGRAM MLKUT618 PROCESSING SUMMARY'.             03254013
032550     DISPLAY '  -----------------------------------'.             03255000
032560     DISPLAY ' '.                                                 03256000
032570*                                                                 03257000
032700     MOVE PA-OUTPUT-RECS-WRITTEN TO CD-COUNT-HOLD1.               03270000
032800     DISPLAY 'EXTRACT RECORDS WRITTEN =   ' CD-COUNT-HOLD1.       03280000
032900*                                                                 03290000
033000     DISPLAY ' '.                                                 03300000
033100                                                                  03310000
033200     CLOSE DATA-INTEGRITY-CTL-FILE.                               03320000
033300     CLOSE DATA-INTEGRITY-EXTR-FILE.                              03330000
033400                                                                  03340000
033500 EJECT                                                            03350000
033600                                                                  03360000
033700******************************************************************03370000
033800 Z990-COMMON-ABEND-ROUTINE.                                       03380000
033900******************************************************************03390000
034000*                                                                 03400000
034100     DISPLAY AA-ABEND-LIT.                                        03410000
034200     DISPLAY AA-PROGRAM-LIT.                                      03420000
034300     DISPLAY AA-PARAGRAPH-LIT.                                    03430000
034400     DISPLAY AA-MESSAGE-LINE.                                     03440000
034500     DISPLAY ABEND-CODE.                                          03450000
034600                                                                  03460000
034700     CALL 'ILBOABN0' USING ABEND-CODE.                            03470000
034800                                                                  03480000
034900 EJECT                                                            03490000
035000                                                                  03500000
035100******************************************************************03510000
035200 Z998-SQL-ERROR.                                                  03520000
035300******************************************************************03530000
035400*                                                                 03540000
035500     CLOSE DATA-INTEGRITY-CTL-FILE                                03550000
035600           DATA-INTEGRITY-EXTR-FILE.                              03560000
035700                                                                  03570000
035800     DISPLAY AA-ABEND-LIT.                                        03580000
035900     DISPLAY AA-DB2-ERROR-LIT.                                    03590000
036000     DISPLAY AA-PROGRAM-LIT.                                      03600000
036100     DISPLAY AA-PARAGRAPH-LIT.                                    03610000
036200     DISPLAY AA-MESSAGE-LINE.                                     03620000
036300     DISPLAY AA-DB2-OPERATION-LIT.                                03630000
036400     SET AC-DB2-ERROR TO TRUE.                                    03640000
036500     MOVE +4013                  TO ABEND-CODE.                   03650000
036600                                                                  03660000
036700     COPY DPPD004.                                                03670000
036800     CALL 'ILBOABN0' USING ABEND-CODE.                            03680000
036900                                                                  03690000
