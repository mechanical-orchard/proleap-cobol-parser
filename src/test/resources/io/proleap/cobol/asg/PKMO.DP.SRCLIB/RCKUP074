000100***************************************************************** 00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300***************************************************************** 00030000
000400                                                                  00040000
000500 PROGRAM-ID.      RCKUP074.                                       00050000
000600 AUTHOR.          DENISE HAHN.                                    00060000
000700 DATE-WRITTEN.    FEBRUARY 2022.                                  00070000
000800                                                                  00080000
000900*---------------------------------------------------------------* 00090000
001000* THIS PROGRAM READS AN INPUT FILE.                               00100000
001100* THE FILE WILL CONTAIN OPER-PO-RCVR FOR 3WD VE RCVRS             00110000
001200*                                                                 00120000
001300* UPDATE PCT_SUM_VRFD - 1 UPDATE PER  OPER-DATE                   00130026
001400***************************************************************** 00140001
003200*---------------------------------------------------------------* 00320001
003300 ENVIRONMENT DIVISION.                                            00330001
003400 CONFIGURATION SECTION.                                           00340001
003500                                                                  00350001
003600 SOURCE-COMPUTER. IBM-3090.                                       00360001
003700 OBJECT-COMPUTER. IBM-3090.                                       00370001
003800                                                                  00380001
003900 INPUT-OUTPUT SECTION.                                            00390001
004000 FILE-CONTROL.                                                    00400001
004100                                                                  00410001
004120     SELECT INPUT-FILE                                            00412002
004130         ASSIGN TO INP01.                                         00413002
004140                                                                  00414002
004200 DATA DIVISION.                                                   00420001
004400 FILE SECTION.                                                    00440001
004410                                                                  00441002
004420 FD  INPUT-FILE                                                   00442002
004430     RECORDING MODE IS F                                          00443002
004440     LABEL RECORDS ARE STANDARD                                   00444002
004450     BLOCK CONTAINS 0 RECORDS.                                    00445002
004460                                                                  00446002
004470 01  INPUT-RECORD                       PIC  X(125).              00447002
004480                                                                  00448002
004600                                                                  00460001
004700 WORKING-STORAGE SECTION.                                         00470001
004800                                                                  00480001
004900 01  ABEND-CODE                  PIC S9(04)     VALUE +0  COMP.   00490001
005000                                                                  00500001
005100 01  PROGRAM-CONSTANTS.                                           00510001
005200     05  PC-MAX-RETRIES          PIC S9(04)     VALUE +3          00520001
005300                                                COMP SYNC.        00530001
006600                                                                  00660001
006610*----------------------------------------------------------------*00661004
006620* DK - DB2 KEYS                                                   00662004
006630*----------------------------------------------------------------*00663004
006640 01  DB2-KEYS.                                                    00664004
006650     05  DK-PO-NBR                    PIC  S9(9) COMP.            00665004
006660     05  DK-RCVR-SEQ-NBR              PIC  S9(9) COMP.            00666004
006670                                                                  00667004
006680                                                                  00668004
006700*----------------------------------------------------------------*00670004
006800* PV - PROGRAM VARIABLES                                          00680002
006900*----------------------------------------------------------------*00690004
007000 01  PROGRAM-VARIABLES.                                           00700001
007200     05  PV-PARAGRAPH-NAME            PIC  X(30)   VALUE SPACE.   00720001
007300     05  PV-DB2-OPER-ATTEMPTED        PIC  X(30)   VALUE SPACE.   00730001
007400     05  PV-DISP-SQL                  PIC -999     VALUE ZERO.    00740006
007401     05  PV-DISP-OPER                 PIC  ZZZ9    VALUE ZERO.    00740106
007402     05  PV-DISP-PO                   PIC  Z(09)   VALUE ZERO.    00740206
007403     05  PV-DISP-RCVR                 PIC  ZZZ9    VALUE ZERO.    00740306
007404                                                                  00740406
007410     05  PV-PREV-CURR-OPER            PIC S9(4)      COMP.        00741006
007411     05  PV-PREV-PO-NBR               PIC S9(9)      COMP.        00741106
007412                                                                  00741206
007413     05  PV-CSR-CURR-OPER             PIC S9(4)      COMP.        00741306
007420     05  PV-CSR-PO                    PIC S9(9)      COMP.        00742003
007430     05  PV-CSR-RCVR                  PIC S9(9)      COMP.        00743003
007440     05  PV-CSR-VE-DATE               PIC  X(10).                 00744003
007441     05  PV-CSR-ACTL-CART-CNT         PIC S9(4)      COMP.        00744103
007450     05  PV-CSR-PO-LINE               PIC S9(4)      COMP.        00745003
007460     05  PV-CSR-UNT-RTL-PR-AMT        PIC S9(6)V9(2) COMP-3.      00746003
007470     05  PV-CSR-SUM-AP-VE-QTY         PIC S9(09)     COMP.        00747003
007471     05  PV-CSR-EXTD-RTL              PIC S9(9)V9(2) COMP-3.      00747106
007472                                                                  00747203
007473     05  PV-PO-RCVR-LINE-UNIT-QTY     PIC S9(09)     COMP.        00747303
007474     05  PV-PO-RCVR-LINE-CART-QTY     PIC S9(09)     COMP.        00747403
007475     05  PV-PO-RCVR-LINE-VRFD-QTY     PIC S9(09)     COMP.        00747503
007476     05  PV-PO-RCVR-LINE-EXTD-RTL     PIC S9(9)V9(2) COMP-3.      00747603
007480                                                                  00748003
007490     05  PV-PO-RCVR-UNIT-QTY          PIC S9(09)     COMP.        00749003
007491     05  PV-PO-RCVR-CART-QTY          PIC S9(09)     COMP.        00749103
007492     05  PV-PO-RCVR-VRFD-QTY          PIC S9(09)     COMP.        00749203
007493     05  PV-PO-RCVR-EXTD-RTL          PIC S9(9)V9(2) COMP-3.      00749303
007494                                                                  00749403
007495     05  PV-SUM-UNIT-QTY              PIC S9(09)     COMP.        00749503
007496     05  PV-SUM-CART-QTY              PIC S9(09)     COMP.        00749603
007497     05  PV-SUM-VRFD-QTY              PIC S9(09)     COMP.        00749703
007498     05  PV-SUM-EXTD-RTL              PIC S9(9)V9(2) COMP-3.      00749803
007499                                                                  00749903
007500     05  PV-READ-COUNT                PIC  9(9).                  00750003
007501     05  PV-INSERT-COUNT              PIC  9(9).                  00750103
007502     05  PV-UPDATE-COUNT              PIC  9(9).                  00750222
007503     05  PV-DISP-COUNT                PIC  ZZZ,ZZZ,ZZ9.           00750322
007504                                                                  00750422
007505     05  PV-DISP-INS-OPER             PIC  ZZZ9.                  00750522
007506     05  PV-DISP-INS-SHFT             PIC  ZZZ9.                  00750622
007507     05  PV-DISP-INS-UNT-VE           PIC  ZZZ,ZZZ,ZZ9.           00750722
007508     05  PV-DISP-INS-CART-QTY         PIC  ZZZ,ZZZ,ZZ9.           00750822
007509     05  PV-DISP-INS-PO-QTY           PIC  ZZZ,ZZZ,ZZ9.           00750922
007510     05  PV-DISP-INS-EXTD-RTL         PIC  ZZZ,ZZZ,ZZ9.99.        00751022
007512                                                                  00751203
007520                                                                  00752003
007600******************************************************************00760001
007700* PS - PROGRAM SWITCHES                                           00770002
007800******************************************************************00780001
007900 01  PROGRAM-SWITCHES.                                            00790001
008000     05  PS-END-OF-FILE-SW              PIC X   VALUE 'N'.        00800002
008100         88  PS-END-OF-FILE                     VALUE 'Y'.        00810002
008200         88  PS-END-OF-FILE-NO                  VALUE 'N'.        00820002
008300     05  PS-EOF-CSR-SW                  PIC X   VALUE 'N'.        00830003
008400         88  PS-EOF-CSR                         VALUE 'Y'.        00840003
008500         88  PS-EOF-CSR-NO                      VALUE 'N'.        00850003
008600                                                                  00860001
008700******************************************************************00870002
008800* PC - PROGRAM CONSTANTS                                          00880002
008900******************************************************************00890002
009400 01  PC-PROGRAM-CONSTANTS.                                        00940001
009500     05  PC-CURRENT-PROGRAM-NAME      PIC X(08)      VALUE        00950001
009600         'RCKUP074'.                                              00960001
009900                                                                  00990001
010000******************************************************************01000001
010100*    STANDARD DB2 ERROR HANDLING AREA                            *01010001
010200******************************************************************01020001
010300     COPY DPWS004.                                                01030001
010400                                                                  01040001
010500                                                                  01050001
010600******************************************************************01060001
010700*  COMMUNICATIONS AREA FOR DB2                                    01070001
010800******************************************************************01080001
010900     EXEC SQL                                                     01090001
011000          INCLUDE SQLCA                                           01100001
011100     END-EXEC.                                                    01110001
011200                                                                  01120001
011300******************************************************************01130001
011400*  SQL COMMUNICATIONS WORK AREA                                  *01140001
011500******************************************************************01150001
011600     COPY SQLCA2.                                                 01160001
011700                                                                  01170001
011800*---------------------------------------------------------------- 01180003
011900*    RECEIVER                                                   * 01190003
012000*---------------------------------------------------------------- 01200003
012100     EXEC SQL                                                     01210001
012200          INCLUDE TRECEIV                                         01220003
012300     END-EXEC.                                                    01230001
012400                                                                  01240001
012401*---------------------------------------------------------------- 01240103
012402*    RECEIVER ITEM                                              * 01240203
012403*---------------------------------------------------------------- 01240303
012404     EXEC SQL                                                     01240403
012405          INCLUDE TRECITM                                         01240503
012406     END-EXEC.                                                    01240603
012407                                                                  01240703
012408*---------------------------------------------------------------- 01240803
012409*    RECEIVER ITEM DISTRIBUTION                                 * 01240903
012410*---------------------------------------------------------------- 01241003
012411     EXEC SQL                                                     01241103
012412          INCLUDE TRECDIS                                         01241203
012413     END-EXEC.                                                    01241303
012414                                                                  01241403
012415*---------------------------------------------------------------- 01241503
012416*    PURCHASE ORDER                                             * 01241603
012417*---------------------------------------------------------------- 01241703
012418     EXEC SQL                                                     01241803
012419          INCLUDE TPURCHS                                         01241903
012420     END-EXEC.                                                    01242003
012421                                                                  01242103
012422*---------------------------------------------------------------- 01242203
012423*    PURCHASE ORDER ITEM                                        * 01242303
012424*---------------------------------------------------------------- 01242403
012425     EXEC SQL                                                     01242503
012426          INCLUDE TPURITM                                         01242603
012427     END-EXEC.                                                    01242703
012428                                                                  01242803
012429*---------------------------------------------------------------* 01242903
012430*    PCT_SUM_VRFD                                               * 01243001
012431*---------------------------------------------------------------* 01243103
012440     EXEC SQL                                                     01244001
012450          INCLUDE PCT00006                                        01245001
012460     END-EXEC.                                                    01246001
012470                                                                  01247001
012471*---------------------------------------------------------------* 01247103
012472*    PO-RCVR DETAIL CURSOR                                      * 01247203
012473*---------------------------------------------------------------* 01247303
012480     EXEC SQL                                                     01248003
012490       DECLARE PO-RCVR-DTL-CSR CURSOR FOR                         01249003
012491        SELECT A.CURR_OPER_UNT_ID                                 01249103
012492             , A.ORD_NBR                                          01249203
012493             , A.REC_SEQ_NBR                                      01249303
012494             , DATE(A.VERFYD_TMST)                                01249403
012495             , A.ACTL_CART_CNT                                    01249503
012496             , B.ORD_LNE_NBR                                      01249603
012497             , E.UNT_RTL_PR_AMT                                   01249703
012498             , SUM(C.AP_VERIFY_ITM_QTY)                           01249803
012499          FROM TRECEIV A                                          01249903
012500             , TRECITM B                                          01250003
012501             , TRECDIS C                                          01250103
012502             , TPURCHS D                                          01250203
012503             , TPURITM E                                          01250303
012504        WHERE A.ORD_NBR        = :DK-PO-NBR                       01250403
012505          AND A.REC_SEQ_NBR    = :DK-RCVR-SEQ-NBR                 01250503
012506          AND A.VER_STATUS_CDE = 'A'                              01250603
012507          AND A.ORD_NBR        =  B.ORD_NBR                       01250703
012508          AND A.REC_SEQ_NBR    =  B.REC_SEQ_NBR                   01250803
012509          AND B.VER_STATUS_CDE = 'A'                              01250903
012510          AND B.ORD_NBR        =  C.ORD_NBR                       01251003
012511          AND B.REC_SEQ_NBR    =  C.REC_SEQ_NBR                   01251103
012512          AND B.ORD_LNE_NBR    =  C.ORD_LNE_NBR                   01251203
012514          AND A.ORD_NBR        =  D.PO_NBR                        01251403
012515          AND D.VER_STATUS_CDE = 'A'                              01251503
012516          AND D.PO_NBR         =  E.PO_NBR                        01251603
012517          AND E.VER_STATUS_CDE = 'A'                              01251703
012518          AND B.ORD_LNE_NBR    =  E.PO_LNE_NBR                    01251803
012519        GROUP BY A.CURR_OPER_UNT_ID                               01251903
012520               , A.ORD_NBR                                        01252003
012521               , A.REC_SEQ_NBR                                    01252103
012522               , DATE(A.VERFYD_TMST)                              01252203
012523               , A.ACTL_CART_CNT                                  01252303
012524               , B.ORD_LNE_NBR                                    01252403
012525               , E.UNT_RTL_PR_AMT                                 01252503
013500           WITH UR                                                01350003
013600     END-EXEC.                                                    01360003
013700                                                                  01370003
014000                                                                  01400003
014100******************************************************************01410003
014200*  LAYOUT FOR INPUT FILE                                          01420003
014300******************************************************************01430003
014400     COPY RCRD095.                                                01440003
014500                                                                  01450003
017100*---------------------------------------------------------------* 01710003
017200 PROCEDURE DIVISION.                                              01720003
017300*---------------------------------------------------------------* 01730003
017400                                                                  01740003
017500 1000-MAINLINE.                                                   01750003
017600                                                                  01760003
017610     DISPLAY ' RCKUP074 - START '                                 01761003
017620     DISPLAY ' '.                                                 01762009
017621                                                                  01762103
017622     OPEN INPUT INPUT-FILE.                                       01762206
017623                                                                  01762303
017624     MOVE ZEROES  TO  PV-PO-RCVR-LINE-UNIT-QTY                    01762403
017625                      PV-PO-RCVR-LINE-CART-QTY                    01762503
017626                      PV-PO-RCVR-LINE-VRFD-QTY                    01762603
017627                      PV-PO-RCVR-LINE-EXTD-RTL                    01762710
017628                                                                  01762803
017629                      PV-PO-RCVR-UNIT-QTY                         01762911
017630                      PV-PO-RCVR-CART-QTY                         01763011
017631                      PV-PO-RCVR-VRFD-QTY                         01763111
017632                      PV-PO-RCVR-EXTD-RTL                         01763211
017633                                                                  01763311
017634                      PV-SUM-UNIT-QTY                             01763411
017635                      PV-SUM-VRFD-QTY                             01763511
017636                      PV-SUM-CART-QTY                             01763611
017637                      PV-SUM-EXTD-RTL.                            01763711
017638                                                                  01763811
017639     PERFORM 7000-READ-INPUT.                                     01763911
017640                                                                  01764011
017641     IF PS-END-OF-FILE                                            01764111
017642         CONTINUE                                                 01764211
017643     ELSE                                                         01764311
017644         MOVE RC095-CURR-OPER-UNT TO PV-PREV-CURR-OPER            01764411
017650         MOVE RC095-PO-NBR        TO PV-PREV-PO-NBR               01765010
017651     END-IF.                                                      01765110
017660                                                                  01766010
017900     PERFORM 2000-PROCESS-INPUT-RECORDS                           01790003
018000       UNTIL PS-END-OF-FILE.                                      01800003
018100                                                                  01810003
018101     IF  PV-READ-COUNT > 0                                        01810112
018102         ADD PV-PO-RCVR-UNIT-QTY  TO  PV-SUM-UNIT-QTY             01810220
018103         ADD PV-PO-RCVR-CART-QTY  TO  PV-SUM-CART-QTY             01810320
018104         ADD PV-PO-RCVR-VRFD-QTY  TO  PV-SUM-VRFD-QTY             01810420
018105         ADD PV-PO-RCVR-EXTD-RTL  TO  PV-SUM-EXTD-RTL             01810520
018106                                                                  01810620
018107         PERFORM 4000-INSERT-VE-UNITS                             01810720
018108     END-IF.                                                      01810812
018109                                                                  01810912
018110     MOVE PV-READ-COUNT   TO  PV-DISP-COUNT.                      01811012
018111     DISPLAY 'RECORDS READ: ' PV-DISP-COUNT.                      01811103
018112                                                                  01811203
018113     MOVE PV-INSERT-COUNT TO  PV-DISP-COUNT.                      01811303
018120     DISPLAY 'INSERTS:      ' PV-DISP-COUNT.                      01812003
018130                                                                  01813003
018131     MOVE PV-UPDATE-COUNT TO  PV-DISP-COUNT.                      01813122
018132     DISPLAY 'UPDATES:      ' PV-DISP-COUNT.                      01813222
018133                                                                  01813322
018140     CLOSE INPUT-FILE.                                            01814003
018150                                                                  01815003
018400     GOBACK.                                                      01840003
018500                                                                  01850003
018600*----------------------------------------------------------------*01860003
019600*                                                                *01960003
020100*----------------------------------------------------------------*02010003
020200 2000-PROCESS-INPUT-RECORDS.                                      02020003
020300                                                                  02030003
020310     IF  RC095-CURR-OPER-UNT NOT =  PV-PREV-CURR-OPER             02031016
020311         PERFORM 4000-INSERT-VE-UNITS                             02031115
020312         MOVE RC095-CURR-OPER-UNT TO PV-PREV-CURR-OPER            02031215
020313         MOVE RC095-PO-NBR        TO PV-PREV-PO-NBR               02031315
020314                                                                  02031415
020315         MOVE ZEROES              TO PV-SUM-UNIT-QTY              02031515
020316                                     PV-SUM-VRFD-QTY              02031615
020317                                     PV-SUM-CART-QTY              02031715
020318                                     PV-SUM-EXTD-RTL              02031815
020319     ELSE                                                         02031915
020320     IF  RC095-CURR-OPER-UNT  =  PV-PREV-CURR-OPER  AND           02032015
020321         RC095-PO-NBR         =  PV-PREV-PO-NBR                   02032106
020322         CONTINUE                                                 02032203
020323     ELSE                                                         02032303
020324                                                                  02032415
020343         ADD PV-PO-RCVR-UNIT-QTY  TO  PV-SUM-UNIT-QTY             02034315
020344         ADD PV-PO-RCVR-CART-QTY  TO  PV-SUM-CART-QTY             02034415
020345         ADD PV-PO-RCVR-VRFD-QTY  TO  PV-SUM-VRFD-QTY             02034515
020346         ADD PV-PO-RCVR-EXTD-RTL  TO  PV-SUM-EXTD-RTL             02034615
020347                                                                  02034715
020348         MOVE ZEROES              TO  PV-PO-RCVR-UNIT-QTY         02034815
020349                                      PV-PO-RCVR-CART-QTY         02034915
020350                                      PV-PO-RCVR-VRFD-QTY         02035015
020351                                      PV-PO-RCVR-EXTD-RTL         02035115
020352                                                                  02035215
020353     END-IF                                                       02035315
020354     END-IF.                                                      02035415
020355                                                                  02035503
020356     MOVE RC095-PO-NBR        TO  DK-PO-NBR                       02035603
020360     MOVE RC095-REC-SEQ-NBR   TO  DK-RCVR-SEQ-NBR                 02036003
020400     PERFORM 3000-SELECT-VE-UNITS.                                02040003
020500                                                                  02050003
022410     PERFORM 7000-READ-INPUT.                                     02241003
022500                                                                  02250003
022600                                                                  02260003
025202*----------------------------------------------------------------*02520203
025203*                                                                *02520303
025204*----------------------------------------------------------------*02520403
025210 3000-SELECT-VE-UNITS.                                            02521003
025212                                                                  02521203
025213     SET PS-EOF-CSR-NO          TO  TRUE.                         02521303
025214     MOVE RC095-PO-NBR          TO  DK-PO-NBR.                    02521403
025215     MOVE RC095-REC-SEQ-NBR     TO  DK-RCVR-SEQ-NBR.              02521503
025216                                                                  02521603
025217     PERFORM 6000-OPEN-CSR.                                       02521703
025218     PERFORM 6100-FETCH-CSR.                                      02521803
025219     PERFORM 3100-PROCESS-CSR                                     02521903
025220       UNTIL PS-EOF-CSR.                                          02522003
025221     PERFORM  6200-CLOSE-CSR.                                     02522103
025222                                                                  02522212
025223     ADD  1                       TO  PV-PO-RCVR-LINE-VRFD-QTY    02522324
025224*** TEST ONLY BEGIN                                               02522412
025225     MOVE PV-CSR-CURR-OPER           TO PV-DISP-INS-OPER.         02522512
025226     MOVE 1                          TO PV-DISP-INS-SHFT.         02522612
025227     MOVE PV-PO-RCVR-LINE-UNIT-QTY   TO PV-DISP-INS-UNT-VE.       02522712
025228     MOVE PV-PO-RCVR-LINE-CART-QTY   TO PV-DISP-INS-CART-QTY.     02522812
025229     MOVE PV-PO-RCVR-LINE-VRFD-QTY   TO PV-DISP-INS-PO-QTY.       02522912
025230     MOVE PV-PO-RCVR-LINE-EXTD-RTL   TO PV-DISP-INS-EXTD-RTL.     02523012
025231                                                                  02523112
025232     DISPLAY 'RCVR TOTALS:     '                                  02523215
025233             'DATE:'  PV-CSR-VE-DATE                              02523313
025234             ' OPER:' PV-DISP-INS-OPER                            02523413
025235             ' SHFT:' PV-DISP-INS-SHFT                            02523513
025236             ' UNTS:' PV-DISP-INS-UNT-VE                          02523613
025237             ' CART:' PV-DISP-INS-CART-QTY                        02523713
025238             ' PO:'   PV-DISP-INS-PO-QTY                          02523813
025239             ' RTL:'  PV-DISP-INS-EXTD-RTL.                       02523913
025240*** TEST ONLY BEGIN                                               02524013
025241                                                                  02524113
025242     ADD PV-PO-RCVR-LINE-UNIT-QTY TO PV-PO-RCVR-UNIT-QTY          02524213
025243     ADD PV-PO-RCVR-LINE-VRFD-QTY TO PV-PO-RCVR-VRFD-QTY          02524313
025244     ADD PV-PO-RCVR-LINE-CART-QTY TO PV-PO-RCVR-CART-QTY          02524413
025245     ADD PV-PO-RCVR-LINE-EXTD-RTL TO PV-PO-RCVR-EXTD-RTL          02524513
025246                                                                  02524613
025247     MOVE ZEROES TO  PV-PO-RCVR-LINE-UNIT-QTY                     02524713
025248                     PV-PO-RCVR-LINE-VRFD-QTY                     02524813
025249                     PV-PO-RCVR-LINE-CART-QTY                     02524913
025250                     PV-PO-RCVR-LINE-EXTD-RTL.                    02525013
025251                                                                  02525113
025252                                                                  02525213
025253 3100-PROCESS-CSR.                                                02525313
025254                                                                  02525413
025255     ADD  PV-CSR-SUM-AP-VE-QTY    TO  PV-PO-RCVR-LINE-UNIT-QTY    02525513
025257                                                                  02525713
025258     MOVE PV-CSR-ACTL-CART-CNT    TO  PV-PO-RCVR-LINE-CART-QTY    02525813
025259                                                                  02525913
025260     MULTIPLY PV-CSR-SUM-AP-VE-QTY                                02526013
025261           BY PV-CSR-UNT-RTL-PR-AMT                               02526127
025262       GIVING PV-CSR-EXTD-RTL.                                    02526213
025263                                                                  02526313
025264     ADD  PV-CSR-EXTD-RTL         TO  PV-PO-RCVR-LINE-EXTD-RTL.   02526413
025265                                                                  02526513
025270     PERFORM 6100-FETCH-CSR.                                      02527003
025287                                                                  02528703
025288                                                                  02528803
025289*----------------------------------------------------------------*02528903
025290*                                                                *02529003
025291*----------------------------------------------------------------*02529103
025292 4000-INSERT-VE-UNITS.                                            02529203
025294                                                                  02529403
025295     MOVE PV-PREV-CURR-OPER       TO PCT00006-OPER-UNT-ID         02529503
025296     MOVE 1                       TO PCT00006-SHFT-NBR            02529603
025297     MOVE PV-SUM-UNIT-QTY         TO PCT00006-UNT-VRFD-QTY        02529703
025298     MOVE PV-SUM-CART-QTY         TO PCT00006-CART-VRFD-QTY       02529803
025299     MOVE PV-SUM-VRFD-QTY         TO PCT00006-PO-RCVR-VRFD-QTY    02529903
025300     MOVE PV-SUM-EXTD-RTL         TO PCT00006-EXTD-RTL-VRFD-AMT   02530003
025301                                                                  02530103
025302*** TEST ONLY BEGIN                                               02530203
025303     MOVE PCT00006-OPER-UNT-ID       TO PV-DISP-INS-OPER.         02530303
025304     MOVE PCT00006-SHFT-NBR          TO PV-DISP-INS-SHFT.         02530403
025305     MOVE PCT00006-UNT-VRFD-QTY      TO PV-DISP-INS-UNT-VE.       02530503
025306     MOVE PCT00006-CART-VRFD-QTY     TO PV-DISP-INS-CART-QTY.     02530603
025307     MOVE PCT00006-PO-RCVR-VRFD-QTY  TO PV-DISP-INS-PO-QTY.       02530703
025308     MOVE PCT00006-EXTD-RTL-VRFD-AMT TO PV-DISP-INS-EXTD-RTL.     02530803
025309                                                                  02530903
025310     DISPLAY ' '                                                  02531013
025311     DISPLAY 'OPER TOTALS:     '                                  02531115
025312             'DATE:'  PV-CSR-VE-DATE                              02531213
025313             ' OPER:' PV-DISP-INS-OPER                            02531313
025314             ' SHFT:' PV-DISP-INS-SHFT                            02531413
025315             ' UNTS:' PV-DISP-INS-UNT-VE                          02531513
025316             ' CART:' PV-DISP-INS-CART-QTY                        02531613
025317             ' PO:'   PV-DISP-INS-PO-QTY                          02531713
025318             ' RTL:'  PV-DISP-INS-EXTD-RTL.                       02531813
025319     DISPLAY ' '.                                                 02531914
025320*** TEST ONLY END                                                 02532013
025321                                                                  02532113
025322                                                                  02532221
025323     EXEC SQL                                                     02532321
025324        INSERT INTO PCT_SUM_VRFD                                  02532421
025325               (BUS_DTE                                           02532521
025326             ,  OPER_UNT_ID                                       02532621
025327             ,  SHFT_NBR                                          02532721
025328             ,  UNT_VRFD_QTY                                      02532821
025329             ,  CART_VRFD_QTY                                     02532921
025330             ,  PO_RCVR_VRFD_QTY                                  02533021
025331             ,  EXTD_RTL_VRFD_AMT)                                02533121
025332        VALUES (:PV-CSR-VE-DATE                                   02533221
025333             ,  :PCT00006-OPER-UNT-ID                             02533321
025334             ,  :PCT00006-SHFT-NBR                                02533421
025335             ,  :PCT00006-UNT-VRFD-QTY                            02533521
025336             ,  :PCT00006-CART-VRFD-QTY                           02533621
025337             ,  :PCT00006-PO-RCVR-VRFD-QTY                        02533721
025338             ,  :PCT00006-EXTD-RTL-VRFD-AMT)                      02533821
025339     END-EXEC.                                                    02533921
025340                                                                  02534021
025341     EVALUATE TRUE                                                02534121
025342         WHEN SQLCODE = ZERO                                      02534221
025343              ADD 1  TO  PV-INSERT-COUNT                          02534321
025344                                                                  02534421
025345         WHEN SQLCODE = -803                                      02534525
025346              PERFORM 4100-UPDATE-VE-UNITS                        02534622
025348                                                                  02534822
025349         WHEN SQLWARN0 NOT = SPACES                               02534921
025350         WHEN SQLCODE NOT EQUAL ZERO                              02535021
025351              MOVE PCT00006-OPER-UNT-ID TO PV-DISP-OPER           02535121
025352              MOVE DK-PO-NBR            TO PV-DISP-PO             02535221
025353              MOVE DK-RCVR-SEQ-NBR      TO PV-DISP-RCVR           02535321
025354              MOVE SQLCODE              TO PV-DISP-SQL            02535421
025355                                                                  02535521
025356              DISPLAY '4000-INSERT-VE-UNITS      '                02535621
025357              DISPLAY PV-DISP-OPER '-'                            02535721
025358                      PV-DISP-PO   '-'                            02535821
025359                      PV-DISP-RCVR '   -   '                      02535921
025360                      PV-CSR-VE-DATE                              02536021
025361              DISPLAY 'SQL:  '            PV-DISP-SQL             02536121
025362                                                                  02536221
025363              DISPLAY 'TABLES:  PCT_SUM_VRFD'                     02536321
025370              PERFORM 9100-SQL-ABEND                              02537021
025377     END-EVALUATE.                                                02537721
025381                                                                  02538103
025382                                                                  02538203
025383*----------------------------------------------------------------*02538322
025384*                                                                *02538422
025385*----------------------------------------------------------------*02538522
025386 4100-UPDATE-VE-UNITS.                                            02538622
025387                                                                  02538722
025388     MOVE PV-PREV-CURR-OPER       TO PCT00006-OPER-UNT-ID         02538822
025389     MOVE 1                       TO PCT00006-SHFT-NBR            02538922
025390     MOVE PV-SUM-UNIT-QTY         TO PCT00006-UNT-VRFD-QTY        02539022
025391     MOVE PV-SUM-CART-QTY         TO PCT00006-CART-VRFD-QTY       02539122
025392     MOVE PV-SUM-VRFD-QTY         TO PCT00006-PO-RCVR-VRFD-QTY    02539222
025393     MOVE PV-SUM-EXTD-RTL         TO PCT00006-EXTD-RTL-VRFD-AMT   02539322
025394                                                                  02539422
025395     DISPLAY 'QUANTITIES UPDATED'.                                02539522
025396                                                                  02539622
025416     EXEC SQL                                                     02541622
025417        UPDATE PCT_SUM_VRFD                                       02541722
025421           SET  UNT_VRFD_QTY = UNT_VRFD_QTY +                     02542122
025422                               :PCT00006-UNT-VRFD-QTY             02542222
025423             ,  CART_VRFD_QTY = CART_VRFD_QTY +                   02542322
025424                               :PCT00006-CART-VRFD-QTY            02542422
025425             ,  PO_RCVR_VRFD_QTY = PO_RCVR_VRFD_QTY +             02542522
025426                               :PCT00006-PO-RCVR-VRFD-QTY         02542622
025427             ,  EXTD_RTL_VRFD_AMT = EXTD_RTL_VRFD_AMT +           02542722
025428                               :PCT00006-EXTD-RTL-VRFD-AMT        02542822
025429         WHERE  BUS_DTE     = :PV-CSR-VE-DATE                     02542922
025430           AND  OPER_UNT_ID = :PCT00006-OPER-UNT-ID               02543022
025431           AND  SHFT_NBR    = :PCT00006-SHFT-NBR                  02543122
025436     END-EXEC.                                                    02543622
025437                                                                  02543722
025438     EVALUATE TRUE                                                02543822
025439         WHEN SQLCODE = ZERO                                      02543922
025440              ADD 1  TO  PV-UPDATE-COUNT                          02544022
025441                                                                  02544122
025442         WHEN SQLWARN0 NOT = SPACES                               02544222
025443         WHEN SQLCODE NOT EQUAL ZERO                              02544322
025444              MOVE PCT00006-OPER-UNT-ID TO PV-DISP-OPER           02544422
025445              MOVE DK-PO-NBR            TO PV-DISP-PO             02544522
025446              MOVE DK-RCVR-SEQ-NBR      TO PV-DISP-RCVR           02544622
025447              MOVE SQLCODE              TO PV-DISP-SQL            02544722
025448                                                                  02544822
025449              DISPLAY '4100-UPDATE-VE-UNITS      '                02544922
025450              DISPLAY PV-DISP-OPER '-'                            02545022
025451                      PV-DISP-PO   '-'                            02545122
025452                      PV-DISP-RCVR '   -   '                      02545222
025453                      PV-CSR-VE-DATE                              02545322
025454              DISPLAY 'SQL:  '            PV-DISP-SQL             02545422
025455                                                                  02545522
025456              DISPLAY 'TABLES:  PCT_SUM_VRFD'                     02545622
025457              PERFORM 9100-SQL-ABEND                              02545722
025458     END-EVALUATE.                                                02545822
025459                                                                  02545922
025460                                                                  02546022
025461*----------------------------------------------------------------*02546103
025462*                                                                *02546203
025463*----------------------------------------------------------------*02546303
025464 6000-OPEN-CSR.                                                   02546403
025465                                                                  02546503
025466     EXEC SQL                                                     02546603
025467          OPEN PO-RCVR-DTL-CSR                                    02546703
025468     END-EXEC.                                                    02546803
025469                                                                  02546903
025470     EVALUATE TRUE                                                02547003
025471         WHEN SQLCODE = ZERO                                      02547103
025472              CONTINUE                                            02547203
025473         WHEN SQLWARN0 NOT = SPACES                               02547303
025474         WHEN SQLCODE  < ZERO                                     02547403
025475         WHEN SQLCODE  > ZERO                                     02547503
025476              MOVE DK-PO-NBR           TO PV-DISP-PO              02547603
025477              MOVE DK-RCVR-SEQ-NBR     TO PV-DISP-RCVR            02547703
025478              MOVE SQLCODE             TO PV-DISP-SQL             02547803
025479                                                                  02547903
025480              DISPLAY '6000-OPEN-CSR             '                02548003
025481              DISPLAY PV-DISP-PO '-'                              02548103
025482                      PV-DISP-RCVR                                02548203
025483              DISPLAY 'SQL: '             PV-DISP-SQL             02548304
025484                                                                  02548403
025485              DISPLAY 'TABLES:  TRECEIV'                          02548503
025486              DISPLAY '         TRECITM'                          02548603
025487              DISPLAY '         TRECDIS'                          02548703
025488              DISPLAY '         TPURCHS'                          02548803
025489              DISPLAY '         TPURITM'                          02548903
025490             PERFORM 9100-SQL-ABEND                               02549003
025491     END-EVALUATE.                                                02549103
025492                                                                  02549203
025493                                                                  02549303
025494*----------------------------------------------------------------*02549403
025495*                                                                *02549503
025496*----------------------------------------------------------------*02549603
025497 6100-FETCH-CSR.                                                  02549703
025498                                                                  02549803
025499     EXEC SQL                                                     02549903
025500          FETCH PO-RCVR-DTL-CSR                                   02550003
025501           INTO :PV-CSR-CURR-OPER                                 02550103
025502              , :PV-CSR-PO                                        02550203
025503              , :PV-CSR-RCVR                                      02550303
025504              , :PV-CSR-VE-DATE                                   02550403
025505              , :PV-CSR-ACTL-CART-CNT                             02550503
025506              , :PV-CSR-PO-LINE                                   02550603
025507              , :PV-CSR-UNT-RTL-PR-AMT                            02550703
025508              , :PV-CSR-SUM-AP-VE-QTY                             02550803
025509     END-EXEC.                                                    02550903
025510                                                                  02551003
025511     EVALUATE TRUE                                                02551103
025512         WHEN SQLCODE = ZERO                                      02551203
025513              CONTINUE                                            02551303
025514         WHEN SQLCODE = +100                                      02551403
025515             SET PS-EOF-CSR            TO TRUE                    02551503
025516                                                                  02551603
025517         WHEN SQLWARN0 NOT = SPACES                               02551703
025518         WHEN SQLCODE  < ZERO                                     02551803
025519         WHEN SQLCODE  > ZERO                                     02551903
025520              MOVE DK-PO-NBR           TO PV-DISP-PO              02552003
025521              MOVE DK-RCVR-SEQ-NBR     TO PV-DISP-RCVR            02552103
025522              MOVE SQLCODE             TO PV-DISP-SQL             02552203
025523                                                                  02552303
025524              DISPLAY '6100-FETCH-CSR            '                02552403
025525              DISPLAY PV-DISP-PO '-'                              02552503
025526                      PV-DISP-RCVR                                02552603
025527              DISPLAY 'SQL: '             PV-DISP-SQL             02552704
025528                                                                  02552803
025529              DISPLAY 'TABLES:  TRECEIV'                          02552903
025530              DISPLAY '         TRECITM'                          02553003
025531              DISPLAY '         TRECDIS'                          02553103
025532              DISPLAY '         TPURCHS'                          02553203
025533              DISPLAY '         TPURITM'                          02553303
025534             PERFORM 9100-SQL-ABEND                               02553403
025535     END-EVALUATE.                                                02553503
025536                                                                  02553603
025537                                                                  02553703
025538*----------------------------------------------------------------*02553803
025539*                                                                *02553903
025540*----------------------------------------------------------------*02554003
025541 6200-CLOSE-CSR.                                                  02554103
025542                                                                  02554203
025543     EXEC SQL                                                     02554303
025544          CLOSE PO-RCVR-DTL-CSR                                   02554403
025545     END-EXEC.                                                    02554503
025546                                                                  02554603
025547     EVALUATE TRUE                                                02554703
025548         WHEN SQLCODE = ZERO                                      02554803
025549              CONTINUE                                            02554903
025550         WHEN SQLWARN0 NOT = SPACES                               02555003
025551         WHEN SQLCODE  < ZERO                                     02555103
025552         WHEN SQLCODE  > ZERO                                     02555203
025553              MOVE DK-PO-NBR           TO PV-DISP-PO              02555303
025554              MOVE DK-RCVR-SEQ-NBR     TO PV-DISP-RCVR            02555403
025555              MOVE SQLCODE             TO PV-DISP-SQL             02555503
025556                                                                  02555603
025557              DISPLAY '6200-CLOSE-CSR            '                02555703
025558              DISPLAY PV-DISP-PO '-'                              02555803
025559                      PV-DISP-RCVR                                02555903
025560              DISPLAY 'SQL: '             PV-DISP-SQL             02556004
025561                                                                  02556103
025562              DISPLAY 'TABLES:  TRECEIV'                          02556203
025563              DISPLAY '         TRECITM'                          02556303
025564              DISPLAY '         TRECDIS'                          02556403
025565              DISPLAY '         TPURCHS'                          02556503
025566              DISPLAY '         TPURITM'                          02556603
025567             PERFORM 9100-SQL-ABEND                               02556703
025568     END-EVALUATE.                                                02556803
025569                                                                  02556903
025570                                                                  02557003
025571*----------------------------------------------------------------*02557103
025572*                                                                *02557203
025573*----------------------------------------------------------------*02557303
025574 7000-READ-INPUT.                                                 02557403
025575                                                                  02557503
025576     READ INPUT-FILE       INTO                                   02557603
025577           RC095-TRKG-REC                                         02557703
025578     AT END                                                       02557803
025579         SET PS-END-OF-FILE           TO TRUE                     02557903
025580         DISPLAY ' '                                              02558003
025581         DISPLAY ' RCKUP074 - END OF INPUT FILE'                  02558103
025582         DISPLAY ' '                                              02558206
025583     NOT AT END                                                   02558303
025584         ADD  1                 TO  PV-READ-COUNT                 02558412
025585         DISPLAY ' '                                              02558513
025586         DISPLAY RC095-CURR-OPER-UNT '-'                          02558613
025587                 RC095-PO-NBR        '-'                          02558713
025588                 RC095-REC-SEQ-NBR.                               02558813
025589                                                                  02558913
025590                                                                  02559013
044100*-----------------------------------------------------------------04410003
044200*  PERFORMS THE ABEND FOR THE PROGRAM IN THE EVENT THAT AN SQL    04420003
044300*  ERROR OR WARNING CODE OCCURS.                                  04430003
044400*-----------------------------------------------------------------04440003
044500 9100-SQL-ABEND.                                                  04450003
044520                                                                  04452008
044600     DISPLAY '9100-SQL-ABEND'.                                    04460003
044700     DISPLAY '** ABEND     **'.                                   04470003
044800     DISPLAY '** PROGRAM   ** =  RCKUP074'.                       04480003
044900     DISPLAY '** PARAGRAPH ** = ' PV-PARAGRAPH-NAME.              04490003
045100                                                                  04510003
045200******************************************************************04520003
045300* THIS COPY BOOK MEMBER CONTAINS THE PROCEDURE DIVISION STATE-    04530003
045400* MENTS THAT ARE REQUIRED TO UTILIZE THE DB2 ABEND MODULE         04540003
045500* 'DSNTIAR' AND CONVERT THE SQLCA INFORMATION INTO A READABLE     04550003
045600* FORMAT.                                                         04560003
045700******************************************************************04570003
045800     COPY DPPD004.                                                04580003
045900                                                                  04590003
046000     MOVE +4013                  TO ABEND-CODE.                   04600003
046100     CALL 'ILBOABN0' USING ABEND-CODE.                            04610003
046200                                                                  04620003
