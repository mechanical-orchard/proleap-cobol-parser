000100 TITLE 'TRAILER STATUS UPDATE'.                                   00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300 PROGRAM-ID.    SUKCS568.                                         00030000
000400 AUTHOR.        DENNIS STEFFEN.                                   00040000
000500 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00050000
000600 DATE-WRITTEN.  SPRING 2002.                                      00060000
000700 DATE-COMPILED.                                                   00070000
000800******************************************************************00080002
000900* I M P O R T A N T --- WHEN COMPILING THIS PROGRAM THE MQ SERIES 00090000
001000* SWITCH ON THE 2ND COMPILE SCREEN NEEDS TO BE SET TO 'Y'.        00100000
001100* THIS PROGRAM USES MQSERIES.                                     00110000
001130*                                                                 00111012
001110* CHANGED 01/09/2023    BY JEAN KURK       WR: CHG0278099         00112012
001120* CHANGE CALL OF DPKCS030 TO BE DYNAMIC                           00113012
001200******************************************************************00120000
001300                                                                  00130000
001400 DATA DIVISION.                                                   00140000
001500 WORKING-STORAGE SECTION.                                         00150000
001600                                                                  00160000
001700 01  DK-DB2-KEYS.                                                 00170000
001800     05  DK-TRIP-ID                   PIC S9(09) COMP VALUE ZERO. 00180000
001900     05  DK-STR-NBR                   PIC S9(04) COMP VALUE ZERO. 00190000
002000                                                                  00200000
002100 01  PC-PROGRAM-CONSTANTS.                                        00210000
002200     05  PC-INTER-APPL-CODES.                                     00220000
002300         10  PC-INTER-APPL-CRIT-SPEC                              00230000
002400                                  PIC  X(01)  VALUE '1'.          00240000
002500         10  PC-INTER-APPL-LIST   PIC  X(01)  VALUE '2'.          00250000
002600     05  PC-CURRENT-MAP-NAME      PIC  X(08)  VALUE  'SU568A  '.  00260000
002700     05  PC-CURRENT-MAPSET-NAME   PIC  X(08)  VALUE  'SUKM568 '.  00270000
002800     05  PC-CURRENT-PROGRAM-NAME  PIC  X(08)  VALUE  'SUKCS568'.  00280000
002900     05  PC-STOTBNDUPD            PIC  X(10)  VALUE  'STOTBNDUPD'.00290000
003000     05  PC-ITEMS-PER-PANEL       PIC S9(04)  VALUE +10           00300000
003100                                              COMP SYNC.          00310000
003200     05  PC-MAX-RETRIES           PIC S9(04)  VALUE  +3           00320000
003300                                              COMP.               00330000
003400     05  PC-MAX-LOCK-RETRIES      PIC S9(04)  VALUE  +3           00340000
003500                                              COMP.               00350000
003600     05  PC-MAX-MSG-VAR           PIC S9(04)  VALUE +1            00360000
003700                                              COMP.               00370000
003800     05  PC-UPD-VSAM              PIC  X(01)  VALUE 'Y'.          00380000
003900     05  PC-MSG-VAR-SYMBOLIC      PIC  X(04)  VALUE '&VAR'.       00390000
004000     05  PC-INQ                    PIC  X(03)  VALUE 'INQ'.       00400000
004100     05  PC-UPD                    PIC  X(03)  VALUE 'UPD'.       00410000
004200     05  PC-DEL                    PIC  X(03)  VALUE 'DEL'.       00420000
004300     05  PC-ERR                    PIC  X(03)  VALUE 'ERR'.       00430000
004400     05  PC-NEW                    PIC  X(02)  VALUE 'NW'.        00440000
004500     05  PC-SLASH                  PIC  X(01)  VALUE '/'.         00450000
004600     05  PC-ZERO                   PIC S9(04)  VALUE ZEROES.      00460000
004700     05  PC-DC                    PIC  X(02)  VALUE  'DC'.        00470000
004800     05  PC-DS                    PIC  X(02)  VALUE  'DS'.        00480000
004900     05  PC-SO                    PIC  X(02)  VALUE  'SO'.        00490000
005000     05  PC-N                     PIC  X(01)  VALUE  'N'.         00500000
005100     05  PC-PICKING               PIC  X(01)  VALUE 'P'.          00510000
005200     05  PC-TICKET                PIC  X(01)  VALUE 'T'.          00520000
005300     05  PC-PACKING               PIC  X(01)  VALUE 'A'.          00530000
005400     05  PC-MAX-DATE              PIC  X(10)  VALUE '9999-09-09'. 00540000
005500     05  PC-DUMMY-DATE            PIC  X(10)  VALUE '09-09-9999'. 00550000
005600     05  PC-BULK-CSPK              PIC  X(10)  VALUE              00560000
005700                                    'BULK/CSEPK'.                 00570000
005800     05  PC-PRE-PACK               PIC  X(10)  VALUE              00580000
005900                                    'PRE-PACK  '.                 00590000
006000     05  PC-PBS                    PIC  X(10)  VALUE              00600000
006100                                    'PBS       '.                 00610000
006200     05  PC-MANUAL                 PIC  X(06)  VALUE 'MANUAL'.    00620000
006300     05  PC-SYSTEM                 PIC  X(06)  VALUE 'SYSTEM'.    00630000
006400     05  PC-REWORK                 PIC  X(06)  VALUE 'REWORK'.    00640000
006500     05  PC-SPOT                   PIC  X(06)  VALUE 'SPOT  '.    00650000
006600     05  PC-100-PCNT               PIC  X(06)  VALUE '100 % '.    00660000
006700     05  PC-PASS                   PIC  X(10)  VALUE              00670000
006800                                    'PASS      '.                 00680000
006900     05  PC-FAIL                   PIC  X(10)  VALUE              00690000
007000                                    'FAIL      '.                 00700000
007100     05  PC-IN-PROCESS             PIC  X(10)  VALUE              00710000
007200                                    'IN PROCESS'.                 00720000
007300     05  PC-PROMPT                 PIC  X(10)  VALUE              00730000
007400                                    'PROMPT    '.                 00740000
007500     05  PC-NOT-NEEDED             PIC  X(10)  VALUE              00750000
007600                                    'NOT NEEDED'.                 00760000
007700     05  PC-ALL                    PIC  X(10)  VALUE              00770000
007800                                    'ALL       '.                 00780000
007900     05  PC-DEFAULT-TMST           PIC  X(26)  VALUE              00790000
008000                                  '9999-09-09-09.09.09.999999'.   00800000
008100     05  PC-MQPUT-RETRY-COUNTER      PIC 9(3)  VALUE ZERO.        00810000
008200                                                                  00820000
008300******************************************************************00830000
008400*   SYSTEM MESSAGES                                              *00840000
008500******************************************************************00850000
008600* 00007 - REQUIRED ENTRY                                          00860000
008700* 00008 - MUST BE NUMERIC                                         00870000
008800* 00057 - A LIST ITEM MUST BE SELECTED FOR THIS FUNCTION          00880000
008900* 00059 - UPDATE(S) SUCCESSFUL                                    00890000
009000* 00069 - TOP OF LIST                                             00900000
009100* 00070 - BOTTOM OF LIST                                          00910000
009200* 00095 - APPLICATION SYSTEM DOES NOT EXIST                       00920000
009300* 00148 - DATA DOES NOT EXIST                                     00930000
009400* 00223 - PREVIOUS OBJECT HAS BEEN ADDED                          00940000
009500* 00224 - OBJECT ON PREVIOUS SCREEN WAS SUCCESSFULLY ADDED        00950000
009600* 00388 - ONLY ONE REPLACEABLE SYMBOLIC VARIABLE (&VAR) CAN BE EN 00960000
009700* 02482 - MESSAGE NUMBER ALREADY EXISTS                           00970000
009800* 02488 - MESSAGE NUMBER OVERRIDE MUST BE GREATER THAN OR EQUAL T 00980000
009900* 02612 - YOU DO NOT HAVE AUTHORITY TO UPDATE                     00990000
009901* 02969 - YOU DO NOT HAVE AUTHORITY TO UPDATE                     00990103
009910* 03796 - utilize bluetooth rcvg app to update trailer status     00991003
010000******************************************************************01000000
010100     05  PC-TSYMSG-NUMBERS.                                       01010000
010200         10  PC-TSYMSG-00004      PIC  9(05)  VALUE  00004.       01020000
010300         10  PC-TSYMSG-00005      PIC  9(05)  VALUE  00005.       01030000
010400         10  PC-TSYMSG-00007      PIC  9(05)  VALUE  00007.       01040000
010500         10  PC-TSYMSG-00008      PIC  9(05)  VALUE  00008.       01050000
010600         10  PC-TSYMSG-00016      PIC  9(05)  VALUE  00016.       01060000
010700         10  PC-TSYMSG-00057      PIC  9(05)  VALUE  00057.       01070000
010800         10  PC-TSYMSG-00059      PIC  9(05)  VALUE  00059.       01080000
010900         10  PC-TSYMSG-00068      PIC  9(05)  VALUE  00068.       01090000
011000         10  PC-TSYMSG-00069      PIC  9(05)  VALUE  00069.       01100000
011100         10  PC-TSYMSG-00070      PIC  9(05)  VALUE  00070.       01110000
011200         10  PC-TSYMSG-00095      PIC  9(05)  VALUE  00095.       01120000
011300         10  PC-TSYMSG-00148      PIC  9(05)  VALUE  00148.       01130000
011400         10  PC-TSYMSG-00223      PIC  9(05)  VALUE  00223.       01140000
011500         10  PC-TSYMSG-00224      PIC  9(05)  VALUE  00224.       01150000
011600         10  PC-TSYMSG-00388      PIC  9(05)  VALUE  00388.       01160000
011700         10  PC-TSYMSG-00551      PIC  9(05)  VALUE  00551.       01170000
011800         10  PC-TSYMSG-02185      PIC  9(05)  VALUE  02185.       01180000
011900         10  PC-TSYMSG-02482      PIC  9(05)  VALUE  02482.       01190000
012000         10  PC-TSYMSG-02488      PIC  9(05)  VALUE  02488.       01200000
012100         10  PC-TSYMSG-02612      PIC  9(05)  VALUE  02612.       01210000
012200         10  PC-TSYMSG-02816      PIC  9(05)  VALUE  02816.       01220000
012300         10  PC-TSYMSG-02925      PIC  9(05)  VALUE  02925.       01230000
012400         10  PC-TSYMSG-02969      PIC  9(05)  VALUE  02969.       01240002
012500         10  PC-TSYMSG-03340      PIC  9(05)  VALUE  03340.       01250000
012510         10  PC-TSYMSG-03796      PIC  9(05)  VALUE  03796.       01251003
012600                                                                  01260000
012700 01  PS-PROGRAM-SWITCHES.                                         01270000
012800     05  PS-ERROR-SW              PIC X(01)   VALUE 'N'.          01280000
012900         88  PS-ERROR                         VALUE 'Y'.          01290000
013000         88  PS-NO-ERROR                      VALUE 'N'.          01300000
013100     05  PS-ACCESS-SW             PIC  X(01)  VALUE 'N'.          01310000
013200         88  PS-ACCESS-ALLOWED                VALUE 'Y'.          01320000
013300         88  PS-ACCESS-NOT-ALLOWED            VALUE 'N'.          01330000
013400* ADDED 8/1/11 DMH                                                01340000
013500     05  PS-PROCESS-MQ            PIC X(01)   VALUE 'N'.          01350000
013600         88  PROCESS-MQ-NO                    VALUE 'N'.          01360000
013700         88  PROCESS-MQ                       VALUE 'Y'.          01370000
013800     05  PS-SEND-MANIFEST-TO-MLS-SW   PIC X(01)   VALUE 'N'.      01380000
013900         88  PS-SEND-MANIFEST-TO-MLS-YES          VALUE 'Y'.      01390000
014000         88  PS-SEND-MANIFEST-TO-MLS-NO           VALUE 'N'.      01400000
014100* ADDED 3/4/16 CLP                                                01410000
014200     05  PS-SEND-MANIFEST-TO-OMS-SW   PIC X(01)   VALUE 'N'.      01420000
014300         88  PS-SEND-MANIFEST-TO-OMS-YES          VALUE 'Y'.      01430000
014400         88  PS-SEND-MANIFEST-TO-OMS-NO           VALUE 'N'.      01440000
014500     05  PS-MQPUT-SUCCESSFUL-IND     PIC X(01) VALUE SPACES.      01450000
014600         88  PS-MQPUT-SUCCESSFUL               VALUE 'Y'.         01460000
014700     05  PS-STORE-SCANNING-SW         PIC X(01)   VALUE 'N'.      01470000
014800         88  PS-ALL-STORES                        VALUE 'A'.      01480000
014900         88  PS-SOME-STORES                       VALUE 'S'.      01490000
015000         88  PS-NO-STORES                         VALUE 'N'.      01500000
015100                                                                  01510000
015200 01  PV-PROGRAM-VARIABLES.                                        01520000
015300     05  PV-PROGRAM-FUNCTION      PIC  X(08)  VALUE SPACES.       01530000
015400     05  PV-CICS-RESPONSE         PIC S9(04)  VALUE +0            01540000
015500                                              COMP SYNC.          01550000
015600     05  PV-RETRY-COUNTER         PIC S9(04)  VALUE +0            01560000
015700                                              COMP SYNC.          01570000
015800     05  PV-LOCK-RETRY-COUNTER    PIC S9(04)  VALUE +0            01580000
015900                                              COMP SYNC.          01590000
016000     05  PV-MSG-VAR-CNT           PIC S9(04)  VALUE +0            01600000
016100                                              COMP SYNC.          01610000
016200     05  PV-CICS-RESP             PIC S9(04)  VALUE +0            01620000
016300                                              COMP SYNC.          01630000
016400     05  PV-ITEM                  PIC S9(04)  VALUE +0            01640000
016500                                              COMP SYNC.          01650000
016600     05  PV-SUB                   PIC S9(04)  VALUE +0            01660000
016700                                              COMP SYNC.          01670000
016800     05  PV-SEL-QUEUE-ITEM        PIC S9(04)  VALUE +0            01680000
016900                                              COMP SYNC.          01690000
017000     05  PV-SAVE-ITEM             PIC S9(04)  VALUE +0            01700000
017100                                              COMP SYNC.          01710000
017200     05  PV-ITEMS-PROCESSED       PIC S9(09)  VALUE +0            01720000
017300                                              COMP-3.             01730000
017400     05  PV-HOLD-SELECTED-ITEMS   PIC S9(09)  VALUE +0            01740000
017500                                              COMP-3.             01750000
017600     05  PV-DB2-ERROR-COUNT       PIC S9(09)  COMP.               01760000
017700     05  PV-PICK-ERRORS           PIC S9(09)  COMP.               01770000
017800     05  PV-PACK-ERRORS           PIC S9(09)  COMP.               01780000
017900     05  PV-TICKET-ERRORS         PIC S9(09)  COMP.               01790000
018000     05  PV-TOTAL-ERRORS          PIC S9(09)  COMP.               01800000
018100     05  PV-DISPLAY-AUDIT-CNTL-NBR       PIC S9(09).              01810000
018200     05  PV-DEPT-NBR-X.                                           01820000
018300         10  PV-DEPT-NBR                PIC 9(03).                01830000
018400     05  PV-DATE.                                                 01840000
018500         10  PV-DATE-MM                 PIC 9(02).                01850000
018600         10  FILLER                     PIC X(1)  VALUE '-'.      01860000
018700         10  PV-DATE-DD                 PIC 9(02).                01870000
018800         10  FILLER                     PIC X(1)  VALUE '-'.      01880000
018900         10  PV-DATE-YY                 PIC 9(04).                01890000
019000                                                                  01900000
019100     05  PV-TIME.                                                 01910000
019200         10  PV-TIME-HH                 PIC 9(02).                01920000
019300         10  FILLER                     PIC X(1)  VALUE ':'.      01930000
019400         10  PV-TIME-MM                 PIC 9(02).                01940000
019500                                                                  01950000
019600     05  PV-PO-RECEIVER.                                          01960000
019700         10  PV-PO                      PIC ZZZZZZZZ9.            01970000
019800         10  FILLER                     PIC X(1)  VALUE '-'.      01980000
019900         10  PV-RECEIVER                PIC 9(03).                01990000
020000                                                                  02000000
020100     05  PV-AUDIT-TYPE                  PIC X(06) VALUE SPACES.   02010000
020200     05  PV-AUDIT-DURATION            PIC S9(9) COMP-3 VALUE ZERO.02020000
020300     05  PV-CARTON-DURATION           PIC S9(9) COMP-3 VALUE ZERO.02030000
020400     05  PV-DISPLAY-DURATION.                                     02040000
020500         10  FILLER                   PIC  X(6) VALUE 'HOURS:'.   02050000
020600         10  PV-DISPLAY-HOURS         PIC  Z(5) VALUE ZERO.       02060000
020700         10  FILLER                   PIC  X(7) VALUE '  MIN: '.  02070000
020800         10  PV-DISPLAY-MIN           PIC  Z(2) VALUE ZERO.       02080000
020900*ADDED 3/4/16 CLP                                                 02090000
021000     05  PV-MQ-HANDLE-CNT            PIC 9(05) VALUE ZEROES.      02100000
021100     05  PV-MQ-HANDLE-NOT-REP        PIC 9(05) VALUE ZEROES.      02110000
021200     05  PV-XML-BANNER               PIC X(39) VALUE              02120000
021300         '<?xml version="1.0" encoding="UTF-8" ?>'.               02130000
021400     05  PV-SHIPPED-TMST-OUT         PIC X(19).                   02140000
021500     05  PV-SHIPPED-TMST-OUT-R       REDEFINES                    02150000
021600         PV-SHIPPED-TMST-OUT.                                     02160000
021700         10  PV-SHIPPED-DATE         PIC X(10).                   02170000
021800         10  PV-T                    PIC X(01).                   02180000
021900         10  PV-SHIPPED-TIME         PIC X(08).                   02190000
022000                                                                  02200000
022100     05  PV-SHIPPED-TMST             PIC X(26).                   02210000
022200     05  PV-SHIPPED-TMST-DATE-HHMM   REDEFINES                    02220000
022300         PV-SHIPPED-TMST.                                         02230000
022400         10  PV-SHIPPED-CCYY         PIC X(04).                   02240000
022500         10  FILLER                  PIC X(01).                   02250000
022600         10  PV-SHIPPED-MM           PIC X(02).                   02260000
022700         10  FILLER                  PIC X(01).                   02270000
022800         10  PV-SHIPPED-DD           PIC X(02).                   02280000
022900         10  FILLER                  PIC X(01).                   02290000
023000         10  PV-SHIPPED-HH           PIC X(02).                   02300000
023100         10  FILLER                  PIC X(01).                   02310000
023200         10  PV-SHIPPED-MN           PIC X(02).                   02320000
023300         10  FILLER                  PIC X(01).                   02330000
023400         10  PV-SHIPPED-SC           PIC X(02).                   02340000
023500         10  FILLER                  PIC X(07).                   02350000
023600     05  PV-RETRY-COUNTER            PIC S9(4) VALUE +0 COMP SYNC.02360000
023700     05  PV-PARAGRAPH                PIC X(48) VALUE SPACES.      02370000
023800     05  PV-MSG-LENGTH2              PIC S9(9) BINARY.            02380000
023900     05  PV-DC-NBR                   PIC 9(04).                   02390000
024000     05  PV-MSG-LENGTH-DISPLAY       PIC S9(9).                   02400000
024100     05  PV-MSGBUFFER.                                            02410000
024200         10  PV-MSGBUFFER-banner     PIC X(39) VALUE SPACES.      02420000
024300         10  PV-MSGBUFFER-data       PIC X(999999) VALUE SPACES.  02430000
024400     05  PV-ABEND-CODE               PIC S9(4) VALUE +0 COMP SYNC.02440000
024500     05  PV-STR-NBR                  PIC S9(4) VALUE ZERO.        02450000
024600     05  PV-CODE-ERROR1.                                          02460000
024700         10  FILLER                  PIC  X(27) VALUE             02470000
024800             'VALID VALUES ARE A, E AND N'.                       02480000
024900     05  PV-CODE-ERROR2.                                          02490000
025000         10  FILLER                  PIC  X(17) VALUE             02500000
025100             'QUERY RETURNED - '.                                 02510000
025200         10  PV-INCORRECT-CODE       PIC  X(02) VALUE SPACES.     02520000
025210                                                                  02521005
025220     05  pv-disp-trip                PIC  9(09) VALUE zeroes.     02522004
025230     05  pv-disp-ship-date.                                       02523005
025240         10  pv-disp-mm              pic  x(02).                  02524005
025250         10  pv-disp-slash1          pic  x(01).                  02525005
025260         10  pv-disp-dd              pic  x(02).                  02526005
025270         10  pv-disp-slash2          pic  x(01).                  02527005
025280         10  pv-disp-yyyy            pic  x(04).                  02528005
025290                                                                  02529005
025300                                                                  02530000
025400******************************************************************02540000
025500**  THIS IS THE LAYOUT FOR THE LIST ITEMS TEMP STORAGE QUEUE.   **02550000
025600**  THIS MUST BE THE EXACT SAME FORMAT A BLOCK IN THE           **02560000
025700**  APPLICATION-SPECIFIC COMMAREA.                              **02570000
025800******************************************************************02580000
025900 01  LQW-LIST-QUEUE-WORK-AREA.                                    02590000
026000     05  LQW-BLOCK-MODIFIED             PIC  X(01)  VALUE SPACE.  02600000
026100     05  LQW-ITEM-ENTRIES               OCCURS 10 TIMES           02610000
026200                                        INDEXED BY LQW-IDX.       02620000
026300         10  LQW-LIST-ITEM-NUMBER       PIC S9(09)  COMP-3.       02630000
026400         10  LQW-TEMP-SELECTED-SW       PIC  X(01).               02640000
026500         10  LQW-SELECTED-SW            PIC  X(01).               02650000
026600             88  LQW-SELECT                         VALUE 'S'.    02660000
026700             88  LQW-DESELECT                       VALUE ' '.    02670000
026800         10  LQW-ACTION                 PIC  X(03).               02680000
026900             88  LQW-DEL                            VALUE 'DEL'.  02690000
027000             88  LQW-INQ                            VALUE 'INQ'.  02700000
027100             88  LQW-UPD                            VALUE 'UPD'.  02710000
027200             88  LQW-ERR                            VALUE 'ERR'.  02720000
027300             88  LQW-PRT                            VALUE 'PRT'.  02730000
027400         10  LQW-PO-LINE                PIC  9(04).               02740000
027500         10  LQW-MERCH-CLASS            PIC  X(02).               02750000
027600         10  LQW-SEQUENCE               PIC  9(08).               02760000
027700         10  LQW-SKU-DESC               PIC  X(20).               02770000
027800         10  LQW-UPC                    PIC  9(15).               02780000
027900         10  LQW-SHIPD-QTY              PIC  Z(05).               02790000
028000*LMM                                                              02800000
028100         10  LQW-PREPK-RATIO            PIC  Z(05).               02810000
028200*                                                                 02820000
028300*----------------------------------------------------------------*02830000
028400*    CALLING PARAMETERS FOR LOCKING MODULE DPKCS044              *02840000
028500*----------------------------------------------------------------*02850000
028600                                                                  02860000
028700     COPY DPWS044.                                                02870000
028800                                                                  02880000
028900*----------------------------------------------------------------*02890000
029000**  SECURITY SUBROUTINE PARAMETERS                                02900000
029100*----------------------------------------------------------------*02910000
029200     COPY DPWS008.                                                02920000
029300                                                                  02930000
029400****************************************************************  02940000
029500*      M Q   S E R I E S    W O R K I N G   S T O R A G E         02950000
029600*                   M  Q    C O P Y B O O K S                     02960000
029700* ADDED MQ - 8/1/11 DMH - FOR mls PROJECT                         02970000
029800****************************************************************  02980000
029900 01  MQM-OBJECT-DESCRIPTOR.                                       02990000
030000     COPY CMQODV.                                                 03000000
030100                                                                  03010000
030200 01  MQM-MESSAGE-DESCRIPTOR.                                      03020000
030300     COPY CMQMDV.                                                 03030000
030400                                                                  03040000
030500 01  MQM-GET-MESSAGE-OPTIONS.                                     03050000
030600     COPY CMQGMOV.                                                03060000
030700                                                                  03070000
030800 01  MQM-PUT-MESSAGE-OPTIONS.                                     03080000
030900     COPY CMQPMOV.                                                03090000
031000                                                                  03100000
031100 01  MQM-CONSTANTS.                                               03110000
031200     COPY CMQV.                                                   03120000
031300                                                                  03130000
031400     COPY ISWS002.                                                03140000
031500                                                                  03150000
031600****************************************************************  03160000
031700*  MQ SERIES CONSTANTS FOR CALLING MODULES SUCH AS PUT AND        03170000
031800*  OPEN, CONNECT, DISCONNECT. (CICS PARMS)                        03180000
031900****************************************************************  03190000
032000 01  PC-MQCONN                   PIC X(8)  VALUE 'CSQCCONN'.      03200000
032100 01  PC-MQOPEN                   PIC X(8)  VALUE 'CSQCOPEN'.      03210000
032200 01  PC-MQINQ                    PIC X(8)  VALUE 'CSQCINQ'.       03220000
032300 01  PC-MQGET                    PIC X(8)  VALUE 'CSQCGET'.       03230000
032400 01  PC-MQPUT                    PIC X(8)  VALUE 'CSQCPUT'.       03240000
032500 01  PC-MQCLOSE                  PIC X(8)  VALUE 'CSQCCLOS'.      03250000
032600 01  PC-MQCOMM                   PIC X(8)  VALUE 'CSQCCOMM'.      03260000
032700 01  PC-MQDISC                   PIC X(8)  VALUE 'CSQCDISC'.      03270000
032800 01  PC-MQBACK                   PIC X(8)  VALUE 'CSQCBACK'.      03280000
032900 01  PC-MQCHECK                  PIC X(8)  VALUE 'MQR2C'.         03290000
033000                                                                  03300000
033100 01  MQ-WORKING-STORAGE.                                          03310000
033200     05  PC-QMGR-NAME                 PIC X(4)  VALUE SPACES.     03320000
033300         88  PC-PROD-QMGR-NAME                  VALUE 'QKSP'.     03330000
033400         88  PC-ACCEPT-QMGR-NAME                VALUE 'QKSQ'.     03340000
033500         88  PC-TEST-QMGR-NAME                  VALUE 'QKST'.     03350000
033600     05  PC-RESPONSE-QNAME            PIC X(30) VALUE SPACES.     03360000
033700     05  PC-WAIT-15-SECS              PIC S9(9) VALUE 15000.      03370000
033800     05  PC-WAIT-6-SECS               PIC S9(9) VALUE 6000.       03380000
033900     05  PC-DELAY-INTERVAL.                                       03390000
034000         10  FILLER                   PIC X(2)  VALUE SPACES.     03400000
034100         10  PC-DELAY-TIME            PIC 9(8)  VALUE 1500.       03410000
034200****************************************************************  03420000
034300*  QUEUE HANDLES                                                  03430000
034400****************************************************************  03440000
034500 01  PV-MQ-PROGRAM-VARIABLES.                                     03450000
034600     05  PV-QM-NAME              PIC X(48).                       03460000
034700     05  PV-HCONN                PIC S9(9) BINARY VALUE 0.        03470000
034800     05  PV-OPEN-OPTIONS         PIC S9(9) BINARY.                03480000
034900     05  PV-HANDLE               PIC S9(9) BINARY VALUE 0.        03490000
035000     05  PV-COMPLETION-CODE      PIC S9(9) BINARY.                03500000
035100     05  PV-REASON               PIC S9(9) BINARY.                03510000
035200     05  PV-ERROR-MESSAGE        PIC X(48) VALUE SPACES.          03520000
035300     05  PV-CON-REASON           PIC S9(9) BINARY.                03530000
035400     05  PV-MSG-LENGTH           PIC S9(9) BINARY VALUE +60.      03540000
035500     05  PV-DATA-LENGTH          PIC S9(9) BINARY.                03550000
035600     05  PV-REASON-TEXT          PIC X(30) VALUE SPACES.          03560000
035700     05  PV-ACTION               PIC X(60)        VALUE SPACES.   03570000
035800     05  PV-INTRGTN-TYP-CDE      PIC X(10) VALUE SPACES.          03580000
035900     05  PV-APPL-FUNC-DESCE      PIC X(10) VALUE SPACES.          03590000
036000     05  PV-MSG                  PIC X(60) VALUE SPACES.          03600000
036100***************************************************************** 03610000
036200*    PROGRAM VARIABLES FOR QUEUE MANAGER AND QUEUE NAMES.         03620000
036300***************************************************************** 03630000
036400 01  PV-Q-MANAGER-VARIABLES.                                      03640000
036500     05  PV-QMGR-NAME                 PIC X(48).                  03650000
036600     05  PV-QUE-NAME                  PIC X(48).                  03660000
036700     05  PV-HANDLE-XXX           PIC S9(9) BINARY VALUE 0.        03670000
036800     05  PV-QMGR-NAME-PUTAWY          PIC X(48).                  03680000
036900     05  PV-QUE-NAME-PUTAWY           PIC X(48).                  03690000
037000     05  PV-HANDLE-PUTAWY        PIC S9(9) BINARY VALUE 0.        03700000
037100     05  PV-QMGR-NAME-ERROR           PIC X(48).                  03710000
037200     05  PV-QUE-NAME-ERROR            PIC X(48).                  03720000
037300     05  PV-HANDLE-ERROR         PIC S9(9) BINARY VALUE 0.        03730000
037400                                                                  03740000
037500***************************************************************** 03750000
037600*    DB2 VIEW DECLARATION - WSV_PRVDR_QUE                         03760000
037700* ADDED 8/1/11 DMH FOR MLS PROJECT                                03770000
037800***************************************************************** 03780000
037900     EXEC SQL                                                     03790000
038000          INCLUDE WSV00005                                        03800000
038100     END-EXEC.                                                    03810000
038200                                                                  03820000
038300***************************************************************** 03830000
038400*   DB2 TABLE DECLARATION - WST_INTGRTN_TYP                       03840000
038500***************************************************************** 03850000
038600     EXEC SQL                                                     03860000
038700          INCLUDE WST00008                                        03870000
038800     END-EXEC.                                                    03880000
038900                                                                  03890000
039000***************************************************************** 03900000
039100*   DB2 TABLE DECLARATION - WST_ATTR_DEFN                         03910000
039200***************************************************************** 03920000
039300     EXEC SQL                                                     03930000
039400          INCLUDE WST00009                                        03940000
039500     END-EXEC.                                                    03950000
039600                                                                  03960000
039700***************************************************************** 03970000
039800*   DB2 TABLE DECLARATION - WST_ATTR_ELEM                         03980000
039900***************************************************************** 03990000
040000     EXEC SQL                                                     04000000
040100          INCLUDE WST00010                                        04010000
040200     END-EXEC.                                                    04020000
040300                                                                  04030000
040400*----------------------------------------------------------------*04040000
040500*    THE CALLING PARAMETER LIST (DPWS010) FOR THE NUMERIC EDIT   *04050000
040600*    SUB-ROUTINE (DPKUT100).                                     *04060000
040700*----------------------------------------------------------------*04070000
040800     COPY DPWS010I.                                               04080000
040900                                                                  04090000
041000**--------------------------------------------------------------**04100000
041100** THE LAYOUT FOR THE TEMPORARY STORAGE QUEUE CONTAINING        **04110000
041200** SELECTED LIST ITEMS TO BE PROCESSED BY THIS PROGRAM.         **04120000
041300**--------------------------------------------------------------**04130000
041400     COPY SUWS013.                                                04140000
041500                                                                  04150000
041600* RECORD LAYOUT FOR MQ RECORD FOR OMS                             04160000
041700* ADDED 3/4/16 CLP                                                04170000
041800                                                                  04180000
041900 01  TrailerManifest.                                             04190000
042000      05  StatusCode                   PIC X(02) VALUE SPACES.    04200000
042100      05  ShipmentTS                   PIC X(19) VALUE SPACES.    04210000
042200      05  Store                        PIC 9(04) VALUE ZERO.      04220000
042300* Changed to spaces 6/24/16 CLP                                   04230000
042400      05  OutboundTripId               PIC X(09) VALUE SPACES.    04240000
042500                                                                  04250000
042600 01  PV-XML                      PIC X(1000)     VALUE SPACES.    04260000
042700 01  PV-HOLD-MSGBUFFER.                                           04270000
042800     05  PV-MSGBUFFER-CHAR OCCURS   1000 TIMES                    04280000
042900                                     PIC X(01).                   04290000
043000                                                                  04300000
043100 01  PV-DISPLAY                  PIC X(132)      VALUE SPACES.    04310000
043200 01  XML-LENGTH                  PIC 9(9)    COMP.                04320000
043300                                                                  04330000
043400     COPY ISWS007.                                                04340000
043500     COPY ISWS008.                                                04350000
043600     COPY ISWS009.                                                04360000
043700                                                                  04370000
043800* RECORD LAYOUT FOR mq RECORD FOR mls WORK REQUEST                04380000
043900* ADDED 8/1/11 DMH FOR MLS PROJECT                                04390000
044000     COPY SURD102.                                                04400000
044100                                                                  04410000
044200     COPY SUKM568.                                                04420000
044300                                                                  04430000
044400     COPY DPWS015.                                                04440000
044500                                                                  04450000
044600     COPY DPWS016.                                                04460000
044700                                                                  04470000
044700* Parameters for calling CICS architecture API                    04471012
044800     COPY DPWS030.                                                04480000
044800     COPY DPWS930.                                                04481012
044900                                                                  04490000
045000     COPY DPWS020.                                                04500000
045100     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                04510000
045200                                                                  04520000
045300         10  INTER-APPL-COMM-AREA PIC X(200).                     04530000
045400     COPY SUWS011.                                                04540000
045500                                                                  04550000
045600     COPY SUWS012.                                                04560000
045700         10  ASC-SPECIFIC-COMMAREA.                               04570000
045800             15  ASC-INT-APPL-FORMAT-IND    PIC  X(01).           04580000
045900             15  ASC-CONFIRM-SEAL-SW       PIC X(01).             04590000
046000                 88  ASC-SEAL-NULL            VALUE SPACE.        04600000
046100                 88  ASC-SEAL-PENDING         VALUE 'P'.          04610000
046200                 88  ASC-SEAL-CONFIRMED       VALUE 'Y'.          04620000
046300             15  ASC-CONFIRM-UPDATE-SW     PIC X(01).             04630000
046400                 88  ASC-UPDATE-NULL          VALUE SPACE.        04640000
046500                 88  ASC-UPDATE-PENDING       VALUE 'P'.          04650000
046600                 88  ASC-UPDATE-CONFIRMED     VALUE 'Y'.          04660000
046700                                                                  04670000
046800             15  ASC-TRIP-OCRNC-ID          PIC S9(09) COMP.      04680000
046900             15  ASC-TRLR-SRL-NBR           PIC  9(09).           04690000
047000             15  ASC-STR-NBR                PIC S9(04) COMP.      04700000
047100             15  ASC-STR-NAME               PIC X(25).            04710000
047200             15  ASC-SCAC                   PIC  X(04).           04720000
047300             15  ASC-TRLR-ID                PIC  X(12).           04730000
047400             15  ASC-TRIP-ID                PIC  9(09).           04740000
047500             15  ASC-TRIP-STAT-CDE          PIC  X(02).           04750000
047600             15  ASC-TRIP-STAT-DESC         PIC  X(30).           04760000
047700             15  ASC-NEW-TRIP-STAT-CDE      PIC  X(02).           04770000
047800             15  ASC-TRLR-SEAL-ID           PIC  X(20).           04780000
047900             15  ASC-NEW-TRLR-SEAL-ID       PIC  X(20).           04790000
048000             15  ASC-STAT-DATE              PIC  X(10).           04800000
048100             15  ASC-CAPCTY-PCT             PIC  9(03).           04810000
048200             15  ASC-JWLRY-IND              PIC  X(01).           04820000
048300             15  ASC-AD-MDSE-IND            PIC  X(01).           04830000
048400             15  ASC-CARTON-CNT             PIC S9(09) COMP.      04840000
048500             15  ASC-UNIT-COUNT             PIC S9(09) COMP.      04850000
048600*                                                                 04860000
048700             15  ASC-SUMMARY-TMST           PIC  X(26).           04870000
048800             15  ASC-SUMMARY-DATE           PIC  X(10).           04880000
048900             15  ASC-DEPT-NBR               PIC  9(04).           04890000
049000             15  ASC-CLASS-NBR              PIC  9(04).           04900000
049001                                                                  04900105
049010             15  asc-trip-ship-tmst         PIC  X(26).           04901008
049020             15  asc-trip-ship-tmst-r redefines                   04902009
049021                                      asc-trip-ship-tmst.         04902109
049022                 20  asc-trip-ship-yyyy     pic  x(04).           04902209
049023                 20  filler                 pic  x(01).           04902309
049030                 20  asc-trip-ship-mm       pic  x(02).           04903009
049031                 20  filler                 pic  x(01).           04903109
049032                 20  asc-trip-ship-dd       pic  x(02).           04903209
049040                 20  filler                 pic  x(16).           04904009
049100                                                                  04910000
049110                                                                  04911005
049200             15  ASC-USE-SELECTION-QUEUE-IND                      04920000
049300                                           PIC  X(01).            04930000
049400                 88  ASC-USE-SELECTION-QUEUE           VALUE 'Y'. 04940000
049500             15  ASC-SEL-QUEUE-NAME        PIC  X(08).            04950000
049600             15  ASC-NUMBER-OF-TS-ITEMS    PIC S9(05)  COMP-3.    04960000
049700             15  ASC-NUMBER-OF-SELECTED-ITEMS                     04970000
049800                                           PIC S9(09)  COMP-3.    04980000
049900             15  ASC-SEL-SUB               PIC S9(04)  COMP.      04990000
050000             15  ASC-SEL-ITEM              PIC S9(04)  COMP.      05000000
050100             15  ASC-TEMP-QUEUE-UPDATE-SW     PIC  X(01).         05010000
050200                 88  ASC-UPDATE-TSQ                VALUE 'Y'.     05020000
050300                 88  ASC-NO-TSQ-UPDATE             VALUE ' '.     05030000
050400             15  ASC-LIST-QUEUE-NAME.                             05040000
050500                 20  ASC-LIST-TERM-ID         PIC  X(04).         05050000
050600                 20  ASC-LIST-TASK-NUMBER     PIC S9(05) COMP-3.  05060000
050700                 20  ASC-LIST-SEQ             PIC  9(01).         05070000
050800             15  ASC-BLOCK-ENTRIES OCCURS 2 TIMES.                05080000
050900                 20  ASC-BLOCK-MODIFIED-SW    PIC  X(01).         05090010
051000                     88  ASC-BLOCK-NOT-MODIFIED    VALUE 'N'.     05100010
051100                     88  ASC-BLOCK-MODIFIED        VALUE 'Y'.     05110010
051220             15  FILLER                       PIC  X(2466).       05122005
051300/                                                                 05130000
051400     COPY DPWS013.                                                05140000
051500                                                                  05150000
051600     EXEC SQL                                                     05160000
051700         INCLUDE TSUOBTR                                          05170000
051800     END-EXEC.                                                    05180000
051900                                                                  05190000
052000     EXEC SQL                                                     05200000
052100         INCLUDE TSUOBTS                                          05210000
052200     END-EXEC.                                                    05220000
052300                                                                  05230000
052400     EXEC SQL                                                     05240000
052500         INCLUDE TSUOBSC                                          05250000
052600     END-EXEC.                                                    05260000
052700                                                                  05270000
052800*                                                                 05280000
052900*** XLT_LOC   ADDED 8/1/11 DMH                                    05290000
053000*                                                                 05300000
053100     EXEC SQL                                                     05310000
053200          INCLUDE XLT00010                                        05320000
053300     END-EXEC.                                                    05330000
053400                                                                  05340000
053500*                                                                 05350000
053600*** SUT_TRIP_WRKR_AUD                                             05360000
053700*                                                                 05370000
053800     EXEC SQL                                                     05380000
053900         INCLUDE SUT00006                                         05390000
054000     END-EXEC.                                                    05400000
054100*                                                                 05410000
054200*** TKRPRPM   ADDED 8/1/11 DMH                                    05420000
054300*                                                                 05430000
054400     EXEC SQL                                                     05440000
054500         INCLUDE TKRPRPM                                          05450000
054600     END-EXEC.                                                    05460000
054700/                                                                 05470000
054800     EXEC SQL                                                     05480000
054900          INCLUDE SQLCA                                           05490000
055000     END-EXEC.                                                    05500000
055100                                                                  05510000
055200 LINKAGE SECTION.                                                 05520000
055300                                                                  05530000
055400 01  DFHCOMMAREA.                                                 05540000
055500     05  FILLER                         OCCURS  1 TO 4072 TIMES   05550000
055600                                        DEPENDING ON EIBCALEN.    05560000
055700         10  FILLER                     PIC  X(01).               05570000
055800                                                                  05580000
055900                                                                  05590000
056000 PROCEDURE DIVISION.                                              05600000
056100***************************************************************** 05610000
056200** THIS MODULE CONTROLS THE OVERALL PROCESSING IN THE PROGRAM. ** 05620000
056300** THE SETUP AND PERFORM OF PARAGRAPH 0001-CALL-CICS-ARCH-API  ** 05630000
056400** MUST BE THE FIRST CODE EXECUTED IN THIS PROGRAM.            ** 05640000
056500**                                                             ** 05650000
056600** THE SECOND OR 'EXIT' PERFORM OF THIS PARAGRAPH MUST BE THE  ** 05660000
056700** LAST CODE EXECUTED ON EACH ITERATION OF THIS PROGRAM.       ** 05670000
056800***************************************************************** 05680000
056900 0000-MAIN-MODULE.                                                05690000
057000     INITIALIZE DP030-CICS-API-FIELDS.                            05700000
057100     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       05710000
057200     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          05720000
057300     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         05730000
057400     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       05740000
057500     MOVE LENGTH OF SU568AI        TO DP030-MAP-LENGTH (1).       05750000
057600     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     05760000
057700     PERFORM 0001-CALL-CICS-ARCH-API.                             05770000
057800                                                                  05780000
057900     PERFORM 1000-CONTROL-PROCESSING                              05790000
058000                                                                  05800000
058100     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     05810000
058200     PERFORM 0001-CALL-CICS-ARCH-API.                             05820000
058300                                                                  05830000
058400 0001-CALL-CICS-ARCH-API.                                         05840000
058500*    CALL 'DPKCS030' USING DFHEIBLK                               05850012
058500     CALL DP930-CICS-ARCH-API USING DFHEIBLK                      05851012
058600                           DFHCOMMAREA                            05860000
058700                           DP030-CICS-API-FIELDS                  05870000
058800                           DP020-STANDARD-COMMAREA                05880000
058900                           SU568AI.                               05890000
059000                                                                  05900000
059100     IF  DP030-RC-CALL-SUCCESSFUL                                 05910000
059200         CONTINUE                                                 05920000
059300     ELSE                                                         05930000
059400         SET DP013-NO-ROLLBACK                                    05940000
059500             DP013-XCTL-DISPLAY-RESTART                           05950000
059600             DP013-CICS-ABEND      TO TRUE                        05960000
059700         MOVE 'BEFORE 0000-MAIN-MODULE'                           05970000
059800                                   TO DP013-PARAGRAPH             05980000
059900*        MOVE 'CALL TO DPKCS030 NOT SUCCESSFUL, RETURN-CODE ON NEX05990012
060000*             'T LINE'             TO DP013-MESSAGE-TEXT (2)      06000012
059900         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL. RETURN-CODE O06001012
060000-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      06002012
060100         MOVE DP030-RETURN-CODE                                   06010000
060200                                   TO DP013-MESSAGE-TEXT (3)      06020000
060300         PERFORM DP013-0000-PROCESS-ABEND                         06030000
060400     END-IF.                                                      06040000
060500                                                                  06050000
060600*----------------------------------------------------------------*06060000
060700*    PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT   *06070000
060800*    COURSE OF ACTION IS FOR THIS TRANSACTION.                   *06080000
060900*----------------------------------------------------------------*06090000
061000                                                                  06100000
061100 1000-CONTROL-PROCESSING.                                         06110000
061200                                                                  06120000
061300     EVALUATE TRUE                                                06130000
061400         WHEN DP020-NEXT-ACT-INITIAL                              06140000
061500             PERFORM 1100-FIND-OBJECT-KEYS                        06150000
061600             IF  PS-ERROR                                         06160000
061700                 CONTINUE                                         06170000
061800             ELSE                                                 06180000
061900                 PERFORM 3200-RESET-ATTRIBUTES                    06190000
062000                 PERFORM 4000-BUILD-INITIAL-PANEL                 06200000
062100                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             06210000
062200             END-IF                                               06220000
062300                                                                  06230000
062400         WHEN DP020-NEXT-ACT-READ-MAP                             06240000
062500             PERFORM 2000-PROCESS-PANEL                           06250000
062600                                                                  06260000
062700         WHEN DP020-NEXT-ACT-RETURN                               06270000
062800             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   06280000
062900             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 06290000
063000                                                                  06300000
063100         WHEN OTHER                                               06310000
063200             SET DP013-LOGIC-ABEND                                06320000
063300                 DP013-NO-ROLLBACK TO TRUE                        06330000
063400             MOVE '1000-CONTROL-PROCESSING'                       06340000
063500                                   TO DP013-PARAGRAPH             06350000
063600             MOVE 'INVALID NEXT ACTIVITY RETURNED TO APPL PGM:'   06360000
063700                                   TO DP013-MESSAGE-TEXT(1)       06370000
063800             MOVE DP020-NEXT-APPL-ACTIVITY                        06380000
063900                                   TO DP013-MESSAGE-TEXT(2)       06390000
064000             PERFORM DP013-0000-PROCESS-ABEND                     06400000
064100     END-EVALUATE.                                                06410000
064200                                                                  06420000
064300******************************************************************06430000
064400** DETERMINE THE KEY OF THE OBJECT TO BE UPDATED BASED ON THE   **06440000
064500** INTER-APPLICATION FORMAT CODE.                               **06450000
064600******************************************************************06460000
064700 1100-FIND-OBJECT-KEYS.                                           06470000
064800     INITIALIZE ASC-SPECIFIC-COMMAREA.                            06480000
064900     MOVE DP020-INT-APPL-FORMAT-IND                               06490000
065000                                   TO ASC-INT-APPL-FORMAT-IND.    06500000
065100     EVALUATE DP020-INT-APPL-FORMAT-IND                           06510000
065200                                                                  06520000
065300         WHEN PC-INTER-APPL-LIST                                  06530000
065400             SET ASC-USE-SELECTION-QUEUE TO TRUE                  06540000
065500             MOVE SU012-NUMBER-OF-SELECTED-ITEMS                  06550000
065600                                   TO ASC-NUMBER-OF-SELECTED-ITEMS06560000
065700             MOVE SU012-NUMBER-OF-TS-ITEMS                        06570000
065800                                   TO ASC-NUMBER-OF-TS-ITEMS      06580000
065900             MOVE SU012-SEL-QUEUE-NAME                            06590000
066000                                   TO ASC-SEL-QUEUE-NAME          06600000
066100             MOVE SU012-STR-NBR   TO ASC-STR-NBR                  06610000
066200             MOVE SU012-STR-NAME  TO ASC-STR-NAME                 06620000
066300             PERFORM 1120-PREPARE-LIST-ENTRY                      06630000
066400                                                                  06640000
066500         WHEN OTHER                                               06650000
066600             MOVE PC-TSYMSG-00148                                 06660000
066700                               TO DP020-MSG-NUMBER                06670000
066800             SET DP020-MSG-FATAL                                  06680000
066900                 DP020-NEXT-ACT-APPL-ERROR                        06690000
067000                               TO TRUE                            06700000
067100     END-EVALUATE.                                                06710000
067200*----------------------------------------------------------------*06720000
067300* ENTRY IS FROM A LIST.  GET THE MESSAGE NUMBER FROM THE TEMP    *06730000
067400* STORAGE QUEUE PASSED FROM THE LIST.                            *06740000
067500*----------------------------------------------------------------*06750000
067600 1120-PREPARE-LIST-ENTRY.                                         06760000
067700     MOVE SU013-MAX-ITEMS          TO ASC-SEL-SUB.                06770000
067800     MOVE ZERO                     TO ASC-SEL-ITEM.               06780000
067900     PERFORM 2110-GET-NEXT-MESSAGE.                               06790000
067910     PERFORM 2510-get-trip-ship-tmst.                             06791005
068000*----------------------------------------------------------------*06800000
068100*    PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT   *06810000
068200*    COURSE OF ACTION IS FOR THIS TRANSACTION.                   *06820000
068300*----------------------------------------------------------------*06830000
068400                                                                  06840000
068500                                                                  06850000
068600*----------------------------------------------------------------*06860000
068700* FURTHER DETERMINE PROCESSING PATH BASED ON FUNCTION KEY ACTIONS*06870000
068800* SPECIFIC FUNCTION KEYS LISTED HERE ARE ACTED UPON REGARDLESS OF*06880000
068900* EDITS.                                                         *06890000
069000*----------------------------------------------------------------*06900000
069100 2000-PROCESS-PANEL.                                              06910000
069200                                                                  06920000
069300     EVALUATE TRUE                                                06930000
069400                                                                  06940000
069500         WHEN DP020-SRC-AID = DP016-CLEAR                         06950000
069600             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 06960000
069700             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   06970000
069800                                                                  06980000
069900         WHEN DP020-FK-REFRESH(DP020-SRC-AID)                     06990000
070000*            INITIALIZE ASC-SPECIFIC-COMMAREA                     07000000
070100             PERFORM 3200-RESET-ATTRIBUTES                        07010000
070200             PERFORM 4000-BUILD-INITIAL-PANEL                     07020000
070300             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 07030000
070400                                                                  07040000
070500         WHEN DP020-FK-NEXT-SELECTION (DP020-SRC-AID)             07050000
070600             IF  ASC-USE-SELECTION-QUEUE                          07060000
070700                 PERFORM 2110-GET-NEXT-MESSAGE                    07070000
070710                 PERFORM 2510-get-trip-ship-tmst                  07071005
070800                 PERFORM 3200-RESET-ATTRIBUTES                    07080000
070900                 PERFORM 4000-BUILD-INITIAL-PANEL                 07090000
071000                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             07100000
071100             ELSE                                                 07110000
071200*                --- BOTTOM OF LIST ---                           07120000
071300                 MOVE PC-TSYMSG-00070                             07130000
071400                                   TO DP020-MSG-NUMBER            07140000
071500                 SET DP020-MSG-INFORMATIONAL                      07150000
071600                     PS-ERROR      TO TRUE                        07160000
071700             END-IF                                               07170000
071800                                                                  07180000
071900         WHEN DP020-FK-PREV-SELECTION (DP020-SRC-AID)             07190000
072000             IF  ASC-USE-SELECTION-QUEUE                          07200000
072100                 PERFORM 2120-GET-PREV-MESSAGE                    07210000
072110                 PERFORM 2510-get-trip-ship-tmst                  07211005
072200*                MOVE ASC-AUDIT-NBR-N         TO DK-AUDIT-NBR     07220000
072300                 PERFORM 3200-RESET-ATTRIBUTES                    07230000
072400                 PERFORM 4000-BUILD-INITIAL-PANEL                 07240000
072500                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             07250000
072600             ELSE                                                 07260000
072700*                --- TOP OF LIST ---                              07270000
072800                 MOVE PC-TSYMSG-00069                             07280000
072900                                   TO DP020-MSG-NUMBER            07290000
073000                 SET DP020-MSG-INFORMATIONAL                      07300000
073100                                   TO TRUE                        07310000
073200             END-IF                                               07320000
073300                                                                  07330000
073400         WHEN OTHER                                               07340000
073500             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 07350000
073600             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   07360000
073700             IF  PS-NO-ERROR                                      07370000
073800                 PERFORM 2100-CHECK-FUNCTION-KEY                  07380000
073900             END-IF                                               07390000
074000             IF  PS-NO-ERROR                                      07400000
074100                 PERFORM 3200-RESET-ATTRIBUTES                    07410000
074200                 PERFORM 4000-BUILD-INITIAL-PANEL                 07420000
074300                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             07430000
074400                 SET DP030-CONTINUE-GO TO TRUE                    07440000
074500             ELSE                                                 07450000
074600                 SET DP030-OVERRIDE-GO TO TRUE                    07460000
074700             END-IF                                               07470000
074800     END-EVALUATE.                                                07480000
074900                                                                  07490000
075000                                                                  07500000
075100******************************************************************07510000
075200** ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED     **07520000
075300** FIRST.  NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED **07530000
075400** FROM THE CICS ARCHITECTURE API.                              **07540000
075500******************************************************************07550000
075600 2100-CHECK-FUNCTION-KEY.                                         07560000
075700                                                                  07570000
075800     EVALUATE TRUE                                                07580000
075900         WHEN DP020-FK-CONFIRM (DP020-SRC-AID)                    07590000
076000                                                                  07600000
076100             EVALUATE TRUE                                        07610000
076200                 WHEN ASC-SEAL-PENDING                            07620000
076300                     SET ASC-SEAL-CONFIRMED TO TRUE               07630000
076400                                                                  07640000
076500                     PERFORM 7000-SELECT-TSUOBTS                  07650000
076600                     IF SUOBTS-TRIP-STAT-CDE =                    07660000
076700                                        ASC-NEW-TRIP-STAT-CDE     07670000
076800                          MOVE PC-TSYMSG-03340                    07680000
076900                                           TO DP020-MSG-NUMBER    07690000
077000                          MOVE SUOBTS-TRIP-STAT-CDE               07700000
077100                                           TO DP020-MSG-TEXT      07710000
077200                          SET DP020-MSG-FATAL                     07720000
077300*                               DP020-NEXT-ACT-ERROR              07730000
077400                                PS-ERROR       TO TRUE            07740000
077500                          MOVE DP015-RED       TO ACRSTATC        07750000
077600                     ELSE                                         07760000
077700                          PERFORM 7100-INSERT-TSUOBTS             07770000
077800                          PERFORM 7031-CHECK-SEND-TO-MLS          07780000
077900                          IF  PS-SEND-MANIFEST-TO-MLS-YES         07790000
078000                              PERFORM 8000-MQ-PROCESSING          07800000
078100                          END-IF                                  07810000
078200                     END-IF                                       07820000
078300                     PERFORM 7200-INSERT-WRKR-AUD                 07830000
078400                                                                  07840000
078500                     IF PS-NO-ERROR                               07850000
078600                         SET ASC-SEAL-NULL                        07860000
078700                             ASC-UPDATE-NULL TO TRUE              07870000
078800                         SET DP020-MSG-INFORMATIONAL              07880000
078900                                       TO TRUE                    07890000
079000                         MOVE PC-TSYMSG-00059  TO DP020-MSG-NUMBER07900000
079100                         PERFORM 9100-READ-SEL-QUEUE              07910000
079200                         SET SU013-UPD (ASC-SEL-SUB)              07920000
079300                                       TO TRUE                    07930000
079400                         PERFORM 9200-REWRITE-LIST-QUEUE          07940000
079500                     END-IF                                       07950000
079600                                                                  07960000
079700                 WHEN ASC-UPDATE-PENDING                          07970000
079800                     SET ASC-UPDATE-CONFIRMED TO TRUE             07980000
079900                     IF ASC-NEW-TRIP-STAT-CDE = 'SO'              07990000
080000                         PERFORM 2101-CHECK-SEAL                  08000000
080100                     END-IF                                       08010000
080200                                                                  08020000
080300                     IF PS-NO-ERROR                               08030000
080400                         PERFORM 7000-SELECT-TSUOBTS              08040000
080500                         IF SUOBTS-TRIP-STAT-CDE =                08050000
080600                                            ASC-NEW-TRIP-STAT-CDE 08060000
080700                              MOVE PC-TSYMSG-03340                08070000
080800                                               TO DP020-MSG-NUMBER08080000
080900                              MOVE SUOBTS-TRIP-STAT-CDE           08090000
081000                                               TO DP020-MSG-TEXT  08100000
081100                              SET DP020-MSG-FATAL                 08110000
081200*                                   DP020-NEXT-ACT-ERROR          08120000
081300                                    PS-ERROR       TO TRUE        08130000
081400                              MOVE DP015-RED       TO ACRSTATC    08140000
081500                         ELSE                                     08150000
081600                            PERFORM 7100-INSERT-TSUOBTS           08160000
081700                            PERFORM 7030-CHECK-SEND-TO-MLS        08170000
081800                            IF  PS-SEND-MANIFEST-TO-MLS-YES       08180000
081900                                PERFORM 8000-MQ-PROCESSING        08190000
082000                            END-IF                                08200000
082100*ADDED 3/4/16 CLP           WRITE TO OMS WHEN UNLOADED AT STORE   08210000
082200                            IF ASC-NEW-TRIP-STAT-CDE = 'SU'       08220000
082300                                PERFORM 7040-CHECK-SEND-TO-OMS    08230000
082400                                IF  PS-SEND-MANIFEST-TO-OMS-YES   08240000
082500                                    PERFORM 8001-MQ-PROCESSING    08250000
082600                                END-IF                            08260000
082700                            END-IF                                08270000
082800                         END-IF                                   08280000
082900                         PERFORM 7200-INSERT-WRKR-AUD             08290000
083000                                                                  08300000
083100                         IF PS-NO-ERROR                           08310000
083200                             SET ASC-SEAL-NULL                    08320000
083300                                 ASC-UPDATE-NULL                  08330000
083400                                 DP020-MSG-INFORMATIONAL          08340000
083500                                               TO TRUE            08350000
083600                                 MOVE PC-TSYMSG-00059             08360000
083700                                               TO DP020-MSG-NUMBER08370000
083800                             PERFORM 9100-READ-SEL-QUEUE          08380000
083900                             SET SU013-UPD (ASC-SEL-SUB)          08390000
084000                                          TO TRUE                 08400000
084100                             PERFORM 9200-REWRITE-LIST-QUEUE      08410000
084200                         END-IF                                   08420000
084300                     END-IF                                       08430000
084400                                                                  08440000
084500                 WHEN OTHER                                       08450000
084600                     MOVE PC-TSYMSG-00016     TO DP020-MSG-NUMBER 08460000
084700                     SET DP020-MSG-FATAL                          08470000
084800                         DP030-SET-CURSOR-APPL-1                  08480000
084900                         PS-ERROR          TO TRUE                08490000
085000                     MOVE -1               TO ANWSTATL            08500000
085100             END-EVALUATE                                         08510000
085200                                                                  08520000
085300         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              08530000
085400                                                                  08540000
085500             INITIALIZE WST00010-ATTR-ELEM-NBR                    08550000
085600             PERFORM 7000-SELECT-TSUOBTS                          08560000
085700             IF SUOBTS-TRIP-STAT-CDE = PC-DS OR PC-SO             08570000
085800                PERFORM 2300-CHECK-IF-STORE-SCAN                  08580000
085900                IF PS-SOME-STORES                                 08590000
086000                   PERFORM 2510-get-trip-ship-tmst                08600004
086010                   PERFORM 2500-CHECK-STOTBND-SCAN                08601004
086100                END-IF                                            08610000
086200             END-IF                                               08620000
086300                                                                  08630000
086400             IF (SUOBTS-TRIP-STAT-CDE = PC-DS OR PC-SO )          08640002
086500             AND (PS-ALL-STORES                                   08650000
086600              OR  WST00010-ATTR-ELEM-NBR = ASC-STR-NBR)           08660000
086700                MOVE 'SUTRLRUP'  TO DP008-FUNCTION-NAME           08670000
086800                PERFORM 2105-RACF-ACCESS                          08680000
086900                IF PS-ACCESS-NOT-ALLOWED                          08690000
087000                   SET  PS-ERROR                                  08700000
087100                        DP020-MSG-FATAL TO TRUE                   08710000
087110*                                                                 08711003
087120* dmh - 6/29/17 begin                                             08712003
087121                   if (PS-ALL-STORES or                           08712103
087122                       WST00010-ATTR-ELEM-NBR = ASC-STR-NBR)      08712203
087123                       MOVE PC-TSYMSG-03796 TO DP020-MSG-NUMBER   08712303
087124                   else                                           08712403
087130* dmh - 6/29/17 end                                               08713003
087140*                                                                 08714003
087200                       MOVE PC-TSYMSG-02969 TO DP020-MSG-NUMBER   08720003
087210                   end-if                                         08721003
087300                   MOVE -1              TO ANWSTATL               08730000
087400                   SET  DP030-SET-CURSOR-APPL-1 TO TRUE           08740000
087500                   PERFORM 4400-MOVE-COMMAREA-TO-SCREEN           08750000
087600                END-IF                                            08760000
087700                                                                  08770000
087800                IF PS-NO-ERROR                                    08780000
087900                   SET ASC-UPDATE-PENDING   TO TRUE               08790000
088000                   MOVE PC-TSYMSG-00004     TO DP020-MSG-NUMBER   08800000
088100                   SET DP020-MSG-FATAL                            08810000
088200                       DP030-SET-CURSOR-APPL-1                    08820000
088300                       PS-ERROR          TO TRUE                  08830000
088400                   MOVE -1               TO ANWSTATL              08840000
088500                END-IF                                            08850000
088600                                                                  08860000
088700             ELSE                                                 08870000
088800                MOVE 'TRLRUPD '  TO DP008-FUNCTION-NAME           08880000
088900                PERFORM 2105-RACF-ACCESS                          08890000
089000                IF PS-ACCESS-NOT-ALLOWED                          08900000
089100                   SET  PS-ERROR                                  08910000
089200                        DP020-MSG-FATAL TO TRUE                   08920000
089300                   MOVE PC-TSYMSG-02612 TO DP020-MSG-NUMBER       08930000
089400                   MOVE -1              TO ANWSTATL               08940000
089500                   SET  DP030-SET-CURSOR-APPL-1 TO TRUE           08950000
089600                   PERFORM 4400-MOVE-COMMAREA-TO-SCREEN           08960000
089700               END-IF                                             08970000
089800                                                                  08980000
089900               IF  PS-NO-ERROR                                    08990000
090000                   SET ASC-UPDATE-PENDING    TO TRUE              09000000
090100                   MOVE PC-TSYMSG-00004     TO DP020-MSG-NUMBER   09010000
090200                   SET DP020-MSG-FATAL                            09020000
090300                       DP030-SET-CURSOR-APPL-1                    09030000
090400                       PS-ERROR          TO TRUE                  09040000
090500                   MOVE -1               TO ANWSTATL              09050000
090600               END-IF                                             09060000
090700             END-IF                                               09070000
090800                                                                  09080000
090900         WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              09090000
091000             INITIALIZE SU011-INTER-APPL-COMMAREA                 09100000
091100                                                                  09110000
091200             MOVE ASC-STR-NBR             TO SU011-STR-NBR        09120000
091300             MOVE ASC-TRLR-SRL-NBR        TO SU011-TRLR-SRL-NBR   09130000
091400             MOVE ASC-TRIP-STAT-DESC      TO SU011-TRLR-STATUS    09140000
091500             MOVE ASC-TRLR-ID             TO SU011-TRAILER-ID     09150000
091600             MOVE ASC-SCAC                TO SU011-SCAC           09160000
091700                                                                  09170000
091800         WHEN DP020-SRC-AID = DP016-ENTER                         09180000
091900             CONTINUE                                             09190000
092000                                                                  09200000
092100         WHEN OTHER                                               09210000
092200             SET DP013-NO-ROLLBACK                                09220000
092300                 DP013-XCTL-DISPLAY-RESTART                       09230000
092400                 DP013-CICS-ABEND  TO TRUE                        09240000
092500             MOVE '2100-CHECK-FUNCTION-KEY'                       09250000
092600                                   TO DP013-PARAGRAPH             09260000
092700             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      09270000
092800                                   TO DP013-MESSAGE-TEXT (1)      09280000
092900             PERFORM DP013-0000-PROCESS-ABEND                     09290000
093000     END-EVALUATE.                                                09300000
093100                                                                  09310000
093200 2101-CHECK-SEAL.                                                 09320000
093300     PERFORM 7010-SELECT-SEAL-ID                                  09330000
093400     IF SUOBTS-TRLR-SEAL-ID NOT = ASC-NEW-TRLR-SEAL-ID            09340000
093500         SET ASC-SEAL-PENDING      TO TRUE                        09350000
093600         MOVE PC-TSYMSG-02925      TO DP020-MSG-NUMBER            09360000
093700         SET DP020-MSG-FATAL                                      09370000
093800             DP030-SET-CURSOR-APPL-1                              09380000
093900             PS-ERROR          TO TRUE                            09390000
094000         MOVE DP015-RED        TO ASEALC                          09400000
094100         MOVE -1               TO ASEALL                          09410000
094200     END-IF.                                                      09420000
094300                                                                  09430000
094400 2105-RACF-ACCESS.                                                09440000
094500                                                                  09450000
094600      SET DP008-RSRC-TYPE-FUNC           TO TRUE                  09460000
094700      SET DP008-ACCESS-TYPE-USE          TO TRUE                  09470000
094800                                                                  09480000
094900      EXEC CICS                                                   09490000
095000         LINK PROGRAM (DP008-SECURITY-SUBROUTINE)                 09500000
095100              COMMAREA (DP008-SECURITY-COMMAREA)                  09510000
095200              LENGTH (DP008-SECURITY-COMMAREA-LENGTH)             09520000
095300      END-EXEC                                                    09530000
095400                                                                  09540000
095500      IF DP008-CALL-SUCCESSFUL                                    09550000
095600         IF DP008-ACCESS-ALLOWED                                  09560000
095700             SET PS-ACCESS-ALLOWED TO TRUE                        09570000
095800         ELSE                                                     09580000
095900             SET PS-ACCESS-NOT-ALLOWED TO TRUE                    09590000
096000         END-IF                                                   09600000
096100     ELSE                                                         09610000
096200         MOVE '2105-RACF-ACCESS'                                  09620000
096300                               TO DP013-PARAGRAPH                 09630000
096400          MOVE 'UNABLE TO ACCESS CICS'                            09640000
096500                               TO DP013-MESSAGE-TEXT (1)          09650000
096600          MOVE SQLCA                 TO DP013-SQLCA               09660000
096700          SET DP013-DB2-ABEND                                     09670000
096800              DP013-XCTL-DISPLAY-RESTART                          09680000
096900                               TO TRUE                            09690000
097000          PERFORM DP013-0000-PROCESS-ABEND                        09700000
097100      END-IF.                                                     09710000
097200                                                                  09720000
097300                                                                  09730000
097400 2110-GET-NEXT-MESSAGE.                                           09740000
097500     ADD +1                        TO ASC-SEL-SUB.                09750000
097600     IF  ASC-SEL-SUB > SU013-MAX-ITEMS                            09760000
097700         ADD +1                    TO ASC-SEL-ITEM                09770000
097800         MOVE +1                   TO ASC-SEL-SUB                 09780000
097900     END-IF.                                                      09790000
098000     IF  ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                09800000
098100         PERFORM 9100-READ-SEL-QUEUE                              09810000
098200         IF  SU013-ITEM (ASC-SEL-SUB) > ZERO                      09820000
098300             MOVE SU013-TRIP-OCRNC-ID (ASC-SEL-SUB)               09830000
098400                                   TO ASC-TRIP-OCRNC-ID           09840000
098500             MOVE SU013-TRLR-SRL-NBR (ASC-SEL-SUB)                09850000
098600                                   TO ASC-TRLR-SRL-NBR            09860000
098700             MOVE SU013-SCAC (ASC-SEL-SUB)                        09870000
098800                                   TO ASC-SCAC                    09880000
098900             MOVE SU013-TRLR-ID (ASC-SEL-SUB)                     09890000
099000                                   TO ASC-TRLR-ID                 09900000
099100             MOVE SU013-TRIP-ID (ASC-SEL-SUB)                     09910000
099200                                   TO ASC-TRIP-ID                 09920000
099300             MOVE SU013-TRIP-STAT-CDE (ASC-SEL-SUB)               09930000
099400                                   TO ASC-TRIP-STAT-CDE           09940000
099500*                                     ASC-NEW-TRIP-STAT-CDE       09950000
099600             MOVE SU013-TRIP-STAT-DESC-LONG (ASC-SEL-SUB)         09960000
099700                                   TO ASC-TRIP-STAT-DESC          09970000
099800*dmh 7/7/17  STRING SU013-STAT-DATE (ASC-SEL-SUB) (1:6)           09980005
099900*dmh 7/7/17   '20'                                                09990005
100000*dmh 7/7/17   SU013-STAT-DATE (ASC-SEL-SUB) (7:2)                 10000005
100100*dmh 7/7/17   DELIMITED BY SIZE  INTO ASC-STAT-DATE               10010005
100200             MOVE SU013-CAPCTY-PCT (ASC-SEL-SUB)                  10020000
100300                                   TO ASC-CAPCTY-PCT              10030000
100400             MOVE SU013-JWLRY-IND  (ASC-SEL-SUB)                  10040000
100500                                   TO ASC-JWLRY-IND               10050000
100600             MOVE SU013-AD-MDSE-IND (ASC-SEL-SUB)                 10060000
100700                                   TO ASC-AD-MDSE-IND             10070000
100800             MOVE SU013-CARTON-CNT (ASC-SEL-SUB)                  10080000
100900                                   TO ASC-CARTON-CNT              10090000
101000             MOVE SU013-UNIT-COUNT (ASC-SEL-SUB)                  10100000
101100                                   TO ASC-UNIT-COUNT              10110000
101200             MOVE SU013-SUMMARY-DATE (ASC-SEL-SUB)                10120000
101300                                   TO ASC-SUMMARY-DATE            10130000
101400             MOVE SU013-DEPT-NBR (ASC-SEL-SUB)                    10140000
101500                                   TO ASC-DEPT-NBR                10150000
101600             MOVE SU013-CLASS-NBR (ASC-SEL-SUB)                   10160000
101700                                   TO ASC-CLASS-NBR               10170000
101800                                                                  10180000
101900                                                                  10190000
102000             SET SU013-INQ (ASC-SEL-SUB)                          10200000
102100                                   TO TRUE                        10210000
102200             PERFORM 9200-REWRITE-LIST-QUEUE                      10220000
102300         ELSE                                                     10230000
102400             SUBTRACT +1 FROM ASC-SEL-SUB                         10240000
102500*            --- BOTTOM OF LIST ---                               10250000
102600             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            10260000
102700             SET DP020-MSG-INFORMATIONAL                          10270000
102800                                   TO TRUE                        10280000
102900         END-IF                                                   10290000
103000     ELSE                                                         10300000
103100         SUBTRACT +1 FROM ASC-SEL-ITEM                            10310000
103200         MOVE SU013-MAX-ITEMS      TO ASC-SEL-SUB                 10320000
103300         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            10330000
103400         SET DP020-MSG-INFORMATIONAL                              10340000
103500                                   TO TRUE                        10350000
103600     END-IF.                                                      10360000
103700*----------------------------------------------------------------*10370000
103800* MOVE DATA ENTERED ON THE SCREEN INTO THEIR RESPECTIVE FIELDS IN*10380000
103900* THE APPLICATION-SPECIFIC COMMAREA.  ALL EDITS ARE DONE IN THE  *10390000
104000* APPLICATION-SPECIFIC COMMAREA, NOT ON THE SCREEN.              *10400000
104100*----------------------------------------------------------------*10410000
104200                                                                  10420000
104300******************************************************************10430000
104400** GET THE MESSAGE NUMBER (KEY) OF THE PREVIOUS SELECTED        **10440000
104500** OBJECT FROM THE SELECTED-ITEMS TEMP. STORAGE QUEUE.          **10450000
104600******************************************************************10460000
104700 2120-GET-PREV-MESSAGE.                                           10470000
104800     SUBTRACT +1 FROM ASC-SEL-SUB.                                10480000
104900     IF  ASC-SEL-SUB < +1                                         10490000
105000         SUBTRACT +1 FROM ASC-SEL-ITEM                            10500000
105100         MOVE SU013-MAX-ITEMS      TO ASC-SEL-SUB                 10510000
105200     END-IF.                                                      10520000
105300*                                                                 10530000
105400     IF  ASC-SEL-ITEM > ZERO                                      10540000
105500         PERFORM 9100-READ-SEL-QUEUE                              10550000
105600             MOVE SU013-TRIP-OCRNC-ID (ASC-SEL-SUB)               10560000
105700                                   TO ASC-TRIP-OCRNC-ID           10570000
105800             MOVE SU013-TRLR-SRL-NBR (ASC-SEL-SUB)                10580000
105900                                   TO ASC-TRLR-SRL-NBR            10590000
106000             MOVE SU013-SCAC (ASC-SEL-SUB)                        10600000
106100                                   TO ASC-SCAC                    10610000
106200             MOVE SU013-TRLR-ID (ASC-SEL-SUB)                     10620000
106300                                   TO ASC-TRLR-ID                 10630000
106400             MOVE SU013-TRIP-ID (ASC-SEL-SUB)                     10640000
106500                                   TO ASC-TRIP-ID                 10650000
106600             MOVE SU013-TRIP-STAT-CDE (ASC-SEL-SUB)               10660000
106700                                   TO ASC-TRIP-STAT-CDE           10670000
106800             MOVE SU013-TRIP-STAT-DESC-LONG (ASC-SEL-SUB)         10680000
106900                                   TO ASC-TRIP-STAT-DESC          10690000
107000*dmh 7/7/17  STRING SU013-STAT-DATE (ASC-SEL-SUB) (1:6)           10700005
107100*dmh 7/7/17   '20'                                                10710005
107200*dmh 7/7/17   SU013-STAT-DATE (ASC-SEL-SUB) (7:2)                 10720005
107300*dmh 7/7/17   DELIMITED BY SIZE  INTO ASC-STAT-DATE               10730005
107400             MOVE SU013-CAPCTY-PCT (ASC-SEL-SUB)                  10740000
107500                                   TO ASC-CAPCTY-PCT              10750000
107600             MOVE SU013-JWLRY-IND  (ASC-SEL-SUB)                  10760000
107700                                   TO ASC-JWLRY-IND               10770000
107800             MOVE SU013-AD-MDSE-IND (ASC-SEL-SUB)                 10780000
107900                                   TO ASC-AD-MDSE-IND             10790000
108000             MOVE SU013-CARTON-CNT (ASC-SEL-SUB)                  10800000
108100                                   TO ASC-CARTON-CNT              10810000
108200             MOVE SU013-UNIT-COUNT (ASC-SEL-SUB)                  10820000
108300                                   TO ASC-UNIT-COUNT              10830000
108400             MOVE SU013-SUMMARY-DATE (ASC-SEL-SUB)                10840000
108500                                   TO ASC-SUMMARY-DATE            10850000
108600             MOVE SU013-DEPT-NBR (ASC-SEL-SUB)                    10860000
108700                                   TO ASC-DEPT-NBR                10870000
108800             MOVE SU013-CLASS-NBR (ASC-SEL-SUB)                   10880000
108900                                   TO ASC-CLASS-NBR               10890000
109000                                                                  10900000
109100     ELSE                                                         10910000
109200         MOVE +1                   TO ASC-SEL-ITEM                10920000
109300                                      ASC-SEL-SUB                 10930000
109400*        --- TOP OF LIST ---                                      10940000
109500         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            10950000
109600         SET DP020-MSG-INFORMATIONAL                              10960000
109700                                   TO TRUE                        10970000
109800     END-IF.                                                      10980000
109900/                                                                 10990000
110000 2200-MOVE-SCREEN-TO-COMMAREA.                                    11000000
110100                                                                  11010000
110200     IF  ASEALL > ZERO                                            11020000
110300         MOVE ASEALI              TO ASC-NEW-TRLR-SEAL-ID         11030000
110400     ELSE                                                         11040000
110500         IF ASEALF = DP015-ERASE-EOF                              11050000
110600             MOVE SPACE            TO ASC-NEW-TRLR-SEAL-ID        11060000
110700         END-IF                                                   11070000
110800     END-IF.                                                      11080000
110900                                                                  11090000
111000     IF  ANWSTATL > ZERO                                          11100000
111100         MOVE ANWSTATI              TO ASC-NEW-TRIP-STAT-CDE      11110000
111200     ELSE                                                         11120000
111300         IF ANWSTATF = DP015-ERASE-EOF                            11130000
111400             MOVE SPACE            TO ASC-NEW-TRIP-STAT-CDE       11140000
111500         END-IF                                                   11150000
111600     END-IF.                                                      11160000
111700                                                                  11170000
111800******************************************************************11180000
111900 2300-CHECK-IF-STORE-SCAN.                                        11190000
112000                                                                  11200000
112100     PERFORM 2400-CHECK-SCANNING-PARM.                            11210000
112200     EVALUATE TRUE                                                11220000
112300         WHEN KRPRPM-FUNC-TXT  = 'A'                              11230000
112400              SET PS-ALL-STORES  TO TRUE                          11240000
112500                                                                  11250000
112600         WHEN KRPRPM-FUNC-TXT  = 'E'                              11260000
112700              SET PS-SOME-STORES TO TRUE                          11270000
112800                                                                  11280000
112900         WHEN KRPRPM-FUNC-TXT  = 'N'                              11290000
113000              SET PS-NO-STORES   TO TRUE                          11300000
113100                                                                  11310000
113200         WHEN OTHER                                               11320000
113300              MOVE '2300-CHECK-IF-STORE-SCAN'                     11330000
113400                               TO DP013-PARAGRAPH                 11340000
113500              MOVE 'CHECK PARM TABLE FOR SECURITY LEVEL'          11350000
113600                               TO DP013-MESSAGE-TEXT (1)          11360000
113700              MOVE PV-CODE-ERROR1                                 11370000
113800                               TO DP013-MESSAGE-TEXT (2)          11380000
113900              MOVE KRPRPM-FUNC-TXT                                11390000
114000                               TO PV-INCORRECT-CODE               11400000
114100              MOVE PV-CODE-ERROR2                                 11410000
114200                               TO DP013-MESSAGE-TEXT (3)          11420000
114300              MOVE 'TKRPRPM'   TO DP013-DB2-TABLE-NAME (1)        11430000
114400              MOVE SQLCA       TO DP013-SQLCA                     11440000
114500              SET DP013-DB2-ABEND                                 11450000
114600                               TO TRUE                            11460000
114700              PERFORM DP013-0000-PROCESS-ABEND                    11470000
114800     END-EVALUATE.                                                11480000
114900                                                                  11490000
115000******************************************************************11500000
115100* THIS PARM IS USED TO INDICATE IF THE PROCESS TO RELIEVE STORE * 11510000
115200* EXPECTED BASED ON THE CARTON SCANS FROM STORES IS BEING USED, * 11520000
115300* AND IF IT IS BEING USED, IS IT BEING DONE AT ALL STORES('A'), * 11530000
115400* CERTAIN STORES('E') OR NO STORES('N').                        * 11540000
115500******************************************************************11550000
115600 2400-CHECK-SCANNING-PARM.                                        11560000
115700                                                                  11570000
115800     EXEC SQL                                                     11580000
115900         SELECT FUNC_TXT                                          11590000
116000           INTO :KRPRPM-FUNC-TXT                                  11600000
116100           FROM TKRPRPM                                           11610000
116200          WHERE LOC_ID            =  90                           11620000
116300            AND INTFC_SYS_CDE     = 'KHL'                         11630000
116400            AND FUNC_PRC_STAT_CDE = 'AC'                          11640000
116500            AND SYS_PRC_FUNC_CDE  = 'STRSCN'                      11650000
116600         WITH UR                                                  11660000
116700     END-EXEC.                                                    11670000
116800                                                                  11680000
116900     EVALUATE TRUE                                                11690000
117000         WHEN SQLCODE = ZERO                                      11700000
117100              CONTINUE                                            11710000
117200                                                                  11720000
117300         WHEN SQLCODE = +100                                      11730000
117400              MOVE 'E'         TO KRPRPM-FUNC-TXT                 11740000
117500                                                                  11750000
117600         WHEN SQLCODE = -904                                      11760000
117700         WHEN SQLCODE = -911                                      11770000
117800         WHEN SQLCODE = -913                                      11780000
117900              DISPLAY '2400-CHECK-SCANNING-PARM'                  11790000
118000              PERFORM 9900-SOFT-ABORT                             11800000
118100                                                                  11810000
118200         WHEN SQLWARN0 NOT = SPACE                                11820000
118300         WHEN SQLCODE NOT = ZERO                                  11830000
118400              MOVE '2400-CHECK-SCANNING-PARM'                     11840000
118500                               TO DP013-PARAGRAPH                 11850000
118600              MOVE 'CHECK IF THIS IS A SCANNING STORE'            11860000
118700                               TO DP013-MESSAGE-TEXT (1)          11870000
118800              MOVE 'TKRPRPM'   TO DP013-DB2-TABLE-NAME (1)        11880000
118900              MOVE SQLCA       TO DP013-SQLCA                     11890000
119000              SET DP013-DB2-ABEND                                 11900000
119100                               TO TRUE                            11910000
119200              PERFORM DP013-0000-PROCESS-ABEND                    11920000
119300     END-EVALUATE.                                                11930000
119400                                                                  11940000
119500****************************************************************  11950000
119600* CHECK IF THIS IS A SCANNING STORE.                              11960000
119700****************************************************************  11970000
119800 2500-CHECK-STOTBND-SCAN.                                         11980000
119900                                                                  11990000
120000     MOVE ASC-STR-NBR     TO DK-STR-NBR.                          12000000
120100                                                                  12010000
120200     EXEC SQL                                                     12020000
120300         SELECT C.ATTR_ELEM_NBR                                   12030000
120400           INTO :WST00010-ATTR-ELEM-NBR                           12040000
120500           FROM WST_INTGRTN_TYP   A                               12050000
120600              , WST_ATTR_DEFN     B                               12060000
120700              , WST_ATTR_ELEM     C                               12070000
120800              , WST_ATTR_ELEM     D                               12080000
120900          WHERE C.ATTR_ELEM_NBR      = :DK-STR-NBR                12090000
121000            AND A.INTGRTN_TYP_CDE    = :PC-STOTBNDUPD             12100000
121100            AND A.INTGRTN_TYP_CDE    = B.INTGRTN_TYP_CDE          12110000
121200            AND B.ATTR_DEFN_SEQ_NBR  = 1                          12120000
121300            AND B.INTGRTN_TYP_CDE    = C.INTGRTN_TYP_CDE          12130000
121400            AND C.ATTR_DEFN_SEQ_NBR  = 1                          12140000
121500            AND B.INTGRTN_TYP_CDE    = D.INTGRTN_TYP_CDE          12150000
121600            AND D.ATTR_DEFN_SEQ_NBR  = 2                          12160000
121700            AND C.INTGRTN_TYP_CDE    = D.INTGRTN_TYP_CDE          12170000
121800            AND C.ATTR_ELEM_SEQ_NBR  = D.ATTR_ELEM_SEQ_NBR        12180000
121900            AND D.ATTR_ELEM_TMST    <= :asc-TRIP-SHIP-TMST        12190005
122000     END-EXEC.                                                    12200004
122100                                                                  12210000
122200     EVALUATE TRUE                                                12220000
122300         WHEN SQLCODE = ZERO                                      12230000
122400              CONTINUE                                            12240000
122500                                                                  12250000
122600         WHEN SQLCODE = +100                                      12260000
122700              MOVE ZERO            TO WST00010-ATTR-ELEM-NBR      12270000
122800                                                                  12280000
122900         WHEN SQLCODE = -904                                      12290000
123000         WHEN SQLCODE = -911                                      12300000
123100         WHEN SQLCODE = -913                                      12310000
123200              PERFORM 9900-SOFT-ABORT                             12320000
123300                                                                  12330000
123400         WHEN SQLWARN0 NOT = SPACE                                12340000
123500         WHEN SQLCODE  NOT = ZERO                                 12350000
123600              MOVE '2500-CHECK-STOTBND-SCAN'                      12360000
123700                                   TO DP013-PARAGRAPH             12370000
123800              MOVE 'SELECT '       TO DP013-MESSAGE-TEXT (1)      12380000
123900              MOVE DK-STR-NBR      TO PV-STR-NBR                  12390000
124000              MOVE PV-STR-NBR      TO DP013-MESSAGE-TEXT (2)      12400000
124100              MOVE asc-trip-ship-tmst                             12410005
124200                                   TO DP013-MESSAGE-TEXT (3)      12420000
124300              MOVE 'WST_INTGRTN_TYP'                              12430000
124400                                   TO DP013-DB2-TABLE-NAME (1)    12440000
124500              MOVE 'WST_ATTR_DEFN' TO DP013-DB2-TABLE-NAME (2)    12450000
124600              MOVE 'WST_ATTR_ELEM' TO DP013-DB2-TABLE-NAME (3)    12460000
124700              MOVE SQLCA           TO DP013-SQLCA                 12470000
124800              SET DP013-DB2-ABEND  TO TRUE                        12480000
124900              PERFORM DP013-0000-PROCESS-ABEND                    12490000
125000     END-EVALUATE.                                                12500000
125100                                                                  12510004
125110                                                                  12511004
125111****************************************************************  12511104
125112* select the date that the trip was shipped                       12511204
125113* dmh added - 7/7/2017                                            12511304
125114****************************************************************  12511404
125115 2510-get-trip-ship-tmst.                                         12511504
125116     MOVE ASC-TRIP-ID                 TO DK-TRIP-ID               12511604
125117                                                                  12511704
125118     EXEC SQL                                                     12511804
125119         SELECT  OTBND_STAT_TMST                                  12511904
125137           INTO :asc-trip-ship-tmst                               12513705
125156           FROM  TSUOBTS                                          12515604
125158          where  OTBND_TRIP_ID       = :DK-TRIP-ID                12515804
125159            and  trip_stat_cde       = 'DS'                       12515904
125163     END-EXEC.                                                    12516304
125164                                                                  12516404
125165     EVALUATE TRUE                                                12516504
125166         WHEN SQLCODE = ZERO                                      12516604
125167              CONTINUE                                            12516704
125168         WHEN SQLCODE = -904                                      12516804
125169         WHEN SQLCODE = -911                                      12516904
125170         WHEN SQLCODE = -913                                      12517004
125171             PERFORM 9900-SOFT-ABORT                              12517104
125172         WHEN SQLWARN0 NOT = SPACE                                12517204
125173         WHEN SQLCODE NOT = ZERO                                  12517304
125174              move dk-trip-id  to  pv-disp-trip                   12517404
125175              MOVE '2510-get-trip-ship-tmst'                      12517504
125176                               TO DP013-PARAGRAPH                 12517604
125177              MOVE 'SELECT TSUOBTS'                               12517704
125178                               TO DP013-MESSAGE-TEXT (1)          12517804
125179              move  pv-disp-trip to DP013-MESSAGE-TEXT (2)        12517904
125180              MOVE SQLCA       TO DP013-SQLCA                     12518004
125181              SET DP013-DB2-ABEND                                 12518104
125182                               TO TRUE                            12518204
125183              PERFORM DP013-0000-PROCESS-ABEND                    12518304
125184     END-EVALUATE.                                                12518404
125185                                                                  12518504
125190                                                                  12519004
125200*----------------------------------------------------------------*12520000
125300* PERFORM EDITS ON EACH FIELD ENTERED BY THE USER.  IF AN ERROR  *12530000
125400* IS FOUND THE CURSOR IS POSITIONED AT THAT FIELD AND AN         *12540000
125500* APPROPRIATE ERROR MESSAGE IS DISPLAYED.                        *12550000
125600*----------------------------------------------------------------*12560000
125700                                                                  12570000
125800 3000-EDIT-DATA-IN-COMMAREA.                                      12580000
125900     PERFORM 3200-RESET-ATTRIBUTES.                               12590000
126000*                                                                 12600000
126100*** DMH - BEGIN - 4/7/06                                          12610000
126200*                                                                 12620000
126300     PERFORM 7000-SELECT-TSUOBTS                                  12630000
126400     IF  SUOBTS-TRIP-STAT-CDE = ASC-TRIP-STAT-CDE                 12640000
126500         CONTINUE                                                 12650000
126600     ELSE                                                         12660000
126700         MOVE PC-TSYMSG-03340              TO DP020-MSG-NUMBER    12670000
126800         MOVE SUOBTS-TRIP-STAT-CDE         TO DP020-MSG-TEXT      12680000
126900         SET DP020-MSG-FATAL                                      12690000
127000             PS-ERROR                      TO TRUE                12700000
127100             MOVE DP015-RED       TO ACRSTATC                     12710000
127200     END-IF.                                                      12720000
127300*                                                                 12730000
127400*** DMH - END - 4/7/06                                            12740000
127500*                                                                 12750000
127600     IF PS-NO-ERROR                                               12760000
127700         PERFORM 3001-EDIT-STATUS                                 12770000
127800     END-IF.                                                      12780000
127900                                                                  12790000
128000     IF PS-NO-ERROR                                               12800000
128100         PERFORM 3002-EDIT-REQUIRED-FIELDS                        12810000
128200     END-IF.                                                      12820000
128300                                                                  12830000
128400     IF PS-NO-ERROR                                               12840000
128500         PERFORM 3003-EDIT-STATUS                                 12850000
128600     END-IF.                                                      12860000
128700                                                                  12870000
128800                                                                  12880000
128900 3001-EDIT-STATUS.                                                12890000
129000     IF ASC-TRIP-STAT-CDE = 'DS' OR 'SO'                          12900000
129100         CONTINUE                                                 12910000
129200     ELSE                                                         12920000
129300         MOVE PC-TSYMSG-02816  TO DP020-MSG-NUMBER                12930000
129400         SET DP020-MSG-FATAL                                      12940000
129500*            DP020-NEXT-ACT-ERROR                                 12950000
129600             PS-ERROR          TO TRUE                            12960000
129700         MOVE DP015-RED        TO ACRSTATC                        12970000
129800     END-IF.                                                      12980000
129900                                                                  12990000
130000 3002-EDIT-REQUIRED-FIELDS.                                       13000000
130100     EVALUATE TRUE                                                13010000
130200     WHEN ASC-NEW-TRIP-STAT-CDE = SPACES                          13020000
130300             MOVE PC-TSYMSG-00007  TO DP020-MSG-NUMBER            13030000
130400             SET DP020-MSG-FATAL                                  13040000
130500*                DP020-NEXT-ACT-ERROR                             13050000
130600                 DP030-SET-CURSOR-APPL-1                          13060000
130700                 PS-ERROR          TO TRUE                        13070000
130800             MOVE DP015-RED        TO ANWSTATC                    13080000
130900             MOVE -1               TO ANWSTATL                    13090000
131000     WHEN ASC-NEW-TRIP-STAT-CDE = 'SO'                            13100000
131100         IF ASC-NEW-TRLR-SEAL-ID = SPACES                         13110000
131200             MOVE PC-TSYMSG-00007  TO DP020-MSG-NUMBER            13120000
131300             SET DP020-MSG-FATAL                                  13130000
131400*                DP020-NEXT-ACT-ERROR                             13140000
131500                 DP030-SET-CURSOR-APPL-1                          13150000
131600                 PS-ERROR          TO TRUE                        13160000
131700             MOVE DP015-RED        TO ASEALC                      13170000
131800             MOVE -1               TO ASEALL                      13180000
131900         END-IF                                                   13190000
132000     END-EVALUATE.                                                13200000
132100                                                                  13210000
132200 3003-EDIT-STATUS.                                                13220000
132300     EVALUATE TRUE                                                13230000
132400     WHEN ASC-NEW-TRIP-STAT-CDE = SPACES                          13240000
132500         MOVE PC-TSYMSG-00007  TO DP020-MSG-NUMBER                13250000
132600         SET DP020-MSG-FATAL                                      13260000
132700             DP030-SET-CURSOR-APPL-1                              13270000
132800             PS-ERROR              TO TRUE                        13280000
132900         MOVE DP015-RED            TO ANWSTATC                    13290000
133000         MOVE -1                   TO ANWSTATL                    13300000
133100     WHEN ASC-NEW-TRIP-STAT-CDE = 'SO'                            13310000
133200         IF ASC-TRIP-STAT-CDE = 'DS'                              13320000
133300             CONTINUE                                             13330000
133400         ELSE                                                     13340000
133500             MOVE PC-TSYMSG-02816  TO DP020-MSG-NUMBER            13350000
133600             SET DP020-MSG-FATAL                                  13360000
133700                 DP030-SET-CURSOR-APPL-1                          13370000
133800                 PS-ERROR          TO TRUE                        13380000
133900             MOVE DP015-RED        TO ANWSTATC                    13390000
134000             MOVE -1               TO ANWSTATL                    13400000
134100         END-IF                                                   13410000
134200     WHEN ASC-NEW-TRIP-STAT-CDE = 'SU'                            13420000
134300         IF ASC-TRIP-STAT-CDE = 'SO'                              13430000
134400             CONTINUE                                             13440000
134500         ELSE                                                     13450000
134600             MOVE PC-TSYMSG-02816  TO DP020-MSG-NUMBER            13460000
134700             SET DP020-MSG-FATAL                                  13470000
134800                 DP030-SET-CURSOR-APPL-1                          13480000
134900                 PS-ERROR          TO TRUE                        13490000
135000             MOVE DP015-RED        TO ANWSTATC                    13500000
135100             MOVE -1               TO ANWSTATL                    13510000
135200         END-IF                                                   13520000
135300     WHEN OTHER                                                   13530000
135400         MOVE PC-TSYMSG-00005  TO DP020-MSG-NUMBER                13540000
135500         SET DP020-MSG-FATAL                                      13550000
135600             DP030-SET-CURSOR-APPL-1                              13560000
135700             PS-ERROR          TO TRUE                            13570000
135800         MOVE DP015-RED        TO ANWSTATC                        13580000
135900         MOVE -1               TO ANWSTATL                        13590000
136000     END-EVALUATE.                                                13600000
136100                                                                  13610000
136200                                                                  13620000
136300 3200-RESET-ATTRIBUTES.                                           13630000
136400     MOVE DP015-UNP-ALP-NOR-OFF    TO ASEALA                      13640000
136500                                      ANWSTATA                    13650000
136600     MOVE DP015-GREEN              TO ASEALC                      13660000
136700                                      ANWSTATC.                   13670000
136800     MOVE DP015-UNDERLINE          TO ASEALH                      13680000
136900                                      ANWSTATH.                   13690000
137000     IF ASC-TRIP-STAT-CDE = 'SO'                                  13700000
137100         MOVE DP015-ASK-NOR-OFF    TO ASEALA                      13710000
137200         MOVE DP015-BLUE           TO ASEALC                      13720000
137300         MOVE DP015-HL-OFF         TO ASEALH                      13730000
137400         MOVE DP015-ASK-DRK-OFF    TO ASEALTTA                    13740000
137500     END-IF.                                                      13750000
137600/                                                                 13760000
137700*----------------------------------------------------------------*13770000
137800* GET THE NEXT AVAILABLE MESSAGE NUMBER, MOVE IT TO THE SCREEN   *13780000
137900* AND POSITION THE CURSOR FOR THE INITIAL PANEL.                 *13790000
138000*----------------------------------------------------------------*13800000
138100                                                                  13810000
138200 4000-BUILD-INITIAL-PANEL.                                        13820000
138300                                                                  13830000
138400     SET DP030-SET-CURSOR-APPL-1                                  13840000
138500         PS-NO-ERROR             TO TRUE.                         13850000
138600                                                                  13860000
138700     PERFORM 7020-SELECT-STATUS.                                  13870000
138800                                                                  13880000
138900*    MOVE -1                     TO ANWSTATL                      13890000
139000                                                                  13900000
139100     MOVE SUOBSC-TRIP-STAT-DESC  TO ASC-TRIP-STAT-DESC.           13910000
139200     MOVE SUOBTS-TRIP-STAT-CDE   TO ASC-TRIP-STAT-CDE.            13920000
139300     EVALUATE TRUE                                                13930000
139400         WHEN ASC-TRIP-STAT-CDE = 'DS'                            13940000
139500             MOVE 'SO'           TO ANWSTATO                      13950000
139600                                    ASC-NEW-TRIP-STAT-CDE         13960000
139700             MOVE -1             TO ASEALL                        13970000
139800         WHEN ASC-TRIP-STAT-CDE = 'SO'                            13980000
139900             MOVE 'SU'           TO ANWSTATO                      13990000
140000                                    ASC-NEW-TRIP-STAT-CDE         14000000
140100             MOVE -1             TO ANWSTATL                      14010000
140200         WHEN OTHER                                               14020000
140300             MOVE -1             TO ANWSTATL                      14030000
140400     END-EVALUATE.                                                14040000
140500                                                                  14050000
140600*----------------------------------------------------------------*14060000
140700*    RESTORE THE DATA ON THE SCREEN FROM THE COMM AREA.          *14070000
140800*----------------------------------------------------------------*14080000
140900                                                                  14090000
141000 4400-MOVE-COMMAREA-TO-SCREEN.                                    14100000
141100                                                                  14110000
141200     MOVE SU012-STR-NBR               TO ASTOREO                  14120000
141300     MOVE SU012-STR-NAME              TO ASTNMEO                  14130000
141310                                                                  14131005
141320     move asc-trip-ship-mm            to pv-disp-mm               14132005
141330     move '/'                         to pv-disp-slash1.          14133005
141340     move asc-trip-ship-dd            to pv-disp-dd.              14134005
141350     move '/'                         to pv-disp-slash2.          14135005
141360     move asc-trip-ship-yyyy          to pv-disp-yyyy.            14136005
141370                                                                  14137005
141400     MOVE pv-disp-ship-date           TO ASHPDTEO                 14140005
141500     MOVE ASC-TRLR-SRL-NBR            TO ASERIALO                 14150000
141600     MOVE ASC-SCAC                    TO ASCACO                   14160000
141700     MOVE ASC-TRLR-ID                 TO ATRLRO                   14170000
141800     MOVE ASC-TRIP-STAT-DESC          TO ACRSTATO.                14180000
141900                                                                  14190000
142000*----------------------------------------------------------------*14200000
142100* APPLY THE CHANGES TO THE MESSAGE TO THE DB2 TABLE.             *14210000
142200*----------------------------------------------------------------*14220000
142300                                                                  14230000
142400*----------------------------------------------------------------*14240000
142500* RECORD IN THE SELECTION TEMP STORAGE QUEUE THE FACT THAT THIS  *14250000
142600* OBJECT WAS UDPATED.                                            *14260000
142700*----------------------------------------------------------------*14270000
142800 5200-UPDATE-SELECTION-QUEUE.                                     14280000
142900     PERFORM 9100-READ-SEL-QUEUE.                                 14290000
143000     SET SU013-UPD (ASC-SEL-SUB) TO TRUE.                         14300000
143100     PERFORM 9200-REWRITE-LIST-QUEUE.                             14310000
143200******************************************************************14320000
143300** WHEN RETURNING TO THIS TRANSACTION FROM ANOTHER TRANSACTION, **14330000
143400** SETUP THE ARRAY AS IT WAS WHEN WE HAD LEFT PREVIOUSLY.  EDIT **14340000
143500** THE SELECTIONS MADE AT THAT TIME AND DISPLAY THE PANEL TO    **14350000
143600** THE USER.                                                    **14360000
143700******************************************************************14370000
143800 6000-REFRESH-PANEL-FROM-TEMP.                                    14380000
143900     IF  ASC-UPDATE-TSQ                                           14390000
144000         SET ASC-NO-TSQ-UPDATE TO TRUE                            14400000
144100         MOVE ZERO                 TO PV-SAVE-ITEM                14410000
144200                                      PV-SEL-QUEUE-ITEM           14420000
144300         MOVE ASC-NUMBER-OF-SELECTED-ITEMS                        14430000
144400                                   TO PV-HOLD-SELECTED-ITEMS      14440000
144500         MOVE +1                   TO PV-ITEMS-PROCESSED          14450000
144600         PERFORM 6100-UPDATE-TSQ                                  14460000
144700             UNTIL PV-ITEMS-PROCESSED >                           14470000
144800                                     PV-HOLD-SELECTED-ITEMS       14480000
144900         INITIALIZE ASC-BLOCK-ENTRIES (1)                         14490000
145000                    ASC-BLOCK-ENTRIES (2)                         14500000
145100     END-IF.                                                      14510000
145200                                                                  14520000
145300*----------------------------------------------------------------*14530000
145400*    DELETE THE SELECTED ITEMS TEMP STORAGE QUEUE.               *14540000
145500*----------------------------------------------------------------*14550000
145600 6010-DELETE-SEL-QUEUE.                                           14560000
145700                                                                  14570000
145800     EXEC CICS                                                    14580000
145900         DELETEQ TS                                               14590000
146000             QUEUE (ASC-SEL-QUEUE-NAME)                           14600000
146100             RESP  (PV-CICS-RESP)                                 14610000
146200     END-EXEC.                                                    14620000
146300*                                                                 14630000
146400     IF ((PV-CICS-RESP = DFHRESP(NORMAL)) OR                      14640000
146500        (PV-CICS-RESP = DFHRESP(QIDERR)))                         14650000
146600         CONTINUE                                                 14660000
146700     ELSE                                                         14670000
146800         SET DP013-CICS-ABEND TO TRUE                             14680000
146900         SET DP013-NO-ROLLBACK TO TRUE                            14690000
147000         MOVE '6010-DELETE-SEL-QUEUE'                             14700000
147100                        TO DP013-PARAGRAPH                        14710000
147200         MOVE 'ERROR TRYING TO DELETE SELECTION TS QUEUE'         14720000
147300                        TO DP013-MESSAGE-TEXT (1)                 14730000
147400         PERFORM DP013-0000-PROCESS-ABEND                         14740000
147500     END-IF.                                                      14750000
147600                                                                  14760000
147700*----------------------------------------------------------------*14770000
147800*    INCREMENT THE TSQ ITEM NUMBER AND READ THE LIST QUEUE.      *14780000
147900*    LOOP THROUGH THE LIST QUEUE TO OBTAIN THE LINE ITEM NUMBER  *14790000
148000*    TO BE USED TO UPDATE (DESELECT) THE CORRECT LINE ITEM IN    *14800000
148100*    THE TEMP QUEUE.                                             *14810000
148200*----------------------------------------------------------------*14820000
148300                                                                  14830000
148400 6100-UPDATE-TSQ.                                                 14840000
148500                                                                  14850000
148600     ADD 1                     TO  PV-SEL-QUEUE-ITEM.             14860000
148700     PERFORM 6105-READ-SEL-QUEUE.                                 14870000
148800     PERFORM                                                      14880000
148900         VARYING SU013-IDX                                        14890000
149000         FROM 1 BY 1                                              14900000
149100         UNTIL ((PV-ITEMS-PROCESSED >                             14910000
149200                              PV-HOLD-SELECTED-ITEMS)             14920000
149300         OR (SU013-IDX GREATER THAN SU013-MAX-ITEMS))             14930000
149400         IF  SU013-ACTION-SW (SU013-IDX) > SPACE                  14940000
149500             PERFORM 6110-PROCESS-ITEMS                           14950000
149600         END-IF                                                   14960000
149700         ADD +1                TO PV-ITEMS-PROCESSED              14970000
149800     END-PERFORM.                                                 14980000
149900     PERFORM 6111-WRITE-LIST-QUEUE.                               14990000
150000*----------------------------------------------------------------*15000000
150100*    READ THE LIST QUEUE RECORD.                                 *15010000
150200*----------------------------------------------------------------*15020000
150300                                                                  15030000
150400 6105-READ-SEL-QUEUE.                                             15040000
150500                                                                  15050000
150600     EXEC CICS                                                    15060000
150700          READQ TS                                                15070000
150800              QUEUE (ASC-SEL-QUEUE-NAME)                          15080000
150900              INTO  (SU013-SELECT-RECORD)                         15090000
151000              ITEM  (PV-SEL-QUEUE-ITEM)                           15100000
151100              RESP  (PV-CICS-RESP)                                15110000
151200     END-EXEC.                                                    15120000
151300*                                                                 15130000
151400     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          15140000
151500         CONTINUE                                                 15150000
151600     ELSE                                                         15160000
151700         SET DP013-CICS-ABEND      TO  TRUE                       15170000
151800         SET DP013-NO-ROLLBACK     TO  TRUE                       15180000
151900         MOVE '6105-READ-SEL-QUEUE'                               15190000
152000                                   TO  DP013-PARAGRAPH            15200000
152100         MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           15210000
152200                                   TO  DP013-MESSAGE-TEXT(1)      15220000
152300         PERFORM DP013-0000-PROCESS-ABEND                         15230000
152400     END-IF.                                                      15240000
152500 EJECT                                                            15250000
152600*----------------------------------------------------------------*15260000
152700*    CALCULATE THE TEMP QUEUE ITEM THAT MUST BE READ AND READ IT.*15270000
152800*    REWRITE THE CURRENT TEMP QUEUE ITEM IF NECESSARY.  CALCULATE*15280000
152900*    THE LINE ITEM OCCURENCE AND UPDATE (DESELECT) IT.           *15290000
153000*----------------------------------------------------------------*15300000
153100                                                                  15310000
153200 6110-PROCESS-ITEMS.                                              15320000
153300                                                                  15330000
153400     COMPUTE PV-ITEM = 1 + ((SU013-ITEM (SU013-IDX) - 1)          15340000
153500                     / PC-ITEMS-PER-PANEL).                       15350000
153600                                                                  15360000
153700     IF  PV-ITEM NOT EQUAL PV-SAVE-ITEM                           15370000
153800         IF  PV-SAVE-ITEM NOT EQUAL ZERO                          15380000
153900             PERFORM 6111-WRITE-LIST-QUEUE                        15390000
154000         END-IF                                                   15400000
154100         MOVE PV-ITEM          TO PV-SAVE-ITEM                    15410000
154200                                                                  15420000
154300         PERFORM 6112-READ-LIST-QUEUE                             15430000
154400         IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)               15440000
154500             CONTINUE                                             15450000
154600         END-IF                                                   15460000
154700     END-IF.                                                      15470000
154800                                                                  15480000
154900     COMPUTE PV-SUB = (SU013-ITEM (SU013-IDX)                     15490000
155000                    - LQW-LIST-ITEM-NUMBER (1)) + 1.              15500000
155100     SET LQW-DESELECT (PV-SUB)             TO  TRUE.              15510000
155200     MOVE LQW-SELECTED-SW (PV-SUB)                                15520000
155300                               TO LQW-TEMP-SELECTED-SW (PV-SUB).  15530000
155400     EVALUATE TRUE                                                15540000
155500         WHEN SU013-INQ (SU013-IDX)                               15550000
155600              MOVE PC-INQ      TO LQW-ACTION (PV-SUB)             15560000
155700                                                                  15570000
155800         WHEN SU013-UPD (SU013-IDX)                               15580000
155900              MOVE PC-UPD      TO LQW-ACTION (PV-SUB)             15590000
156000                                                                  15600000
156100         WHEN SU013-DEL (SU013-IDX)                               15610000
156200              MOVE PC-DEL      TO LQW-ACTION (PV-SUB)             15620000
156300                                                                  15630000
156400         WHEN SU013-ERR (SU013-IDX)                               15640000
156500              MOVE PC-ERR      TO LQW-ACTION (PV-SUB)             15650000
156600     END-EVALUATE.                                                15660000
156700                                                                  15670000
156800     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                15680000
156900                                                                  15690000
157000*----------------------------------------------------------------*15700000
157100*    WRITE THE TS QUEUE RECORD JUST UPDATED IN C600.             *15710000
157200*----------------------------------------------------------------*15720000
157300                                                                  15730000
157400 6111-WRITE-LIST-QUEUE.                                           15740000
157500                                                                  15750000
157600     EXEC CICS                                                    15760000
157700         WRITEQ TS                                                15770000
157800             QUEUE (ASC-LIST-QUEUE-NAME)                          15780000
157900             FROM  (LQW-LIST-QUEUE-WORK-AREA)                     15790000
158000             ITEM  (PV-SAVE-ITEM)                                 15800000
158100             REWRITE                                              15810000
158200             RESP  (PV-CICS-RESP)                                 15820000
158300     END-EXEC.                                                    15830000
158400*                                                                 15840000
158500     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          15850000
158600         CONTINUE                                                 15860000
158700     ELSE                                                         15870000
158800         SET DP013-CICS-ABEND  TO  TRUE                           15880000
158900         SET DP013-NO-ROLLBACK TO  TRUE                           15890000
159000         MOVE '6111-WRITE-LIST-QUEUE'                             15900000
159100                               TO  DP013-PARAGRAPH                15910000
159200         MOVE 'ATTEMPTING TO REWRITE LIST QUEUE'                  15920000
159300                               TO  DP013-MESSAGE-TEXT(1)          15930000
159400         PERFORM DP013-0000-PROCESS-ABEND                         15940000
159500     END-IF.                                                      15950000
159600                                                                  15960000
159700 EJECT                                                            15970000
159800*----------------------------------------------------------------*15980000
159900*    READ THE TEMPORARY STORAGE QUEUE INTO A TEMPORARY WORK AREA.*15990000
160000*----------------------------------------------------------------*16000000
160100                                                                  16010000
160200 6112-READ-LIST-QUEUE.                                            16020000
160300                                                                  16030000
160400     EXEC CICS                                                    16040000
160500         READQ TS                                                 16050000
160600             QUEUE (ASC-LIST-QUEUE-NAME)                          16060000
160700             INTO  (LQW-LIST-QUEUE-WORK-AREA)                     16070000
160800             ITEM  (PV-ITEM)                                      16080000
160900             RESP  (PV-CICS-RESP)                                 16090000
161000     END-EXEC.                                                    16100000
161100*                                                                 16110000
161200     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          16120000
161300         CONTINUE                                                 16130000
161400     ELSE                                                         16140000
161500         SET DP013-CICS-ABEND        TO TRUE                      16150000
161600         SET DP013-NO-ROLLBACK       TO TRUE                      16160000
161700         MOVE '6112-READ-LIST-QUEUE' TO DP013-PARAGRAPH           16170000
161800         MOVE 'ATTEMPTING TO READQ LIST QUEUE'                    16180000
161900                                     TO DP013-MESSAGE-TEXT(1)     16190000
162000         PERFORM DP013-0000-PROCESS-ABEND                         16200000
162100     END-IF.                                                      16210000
162200                                                                  16220000
162300 7000-SELECT-TSUOBTS.                                             16230000
162400                                                                  16240000
162500     MOVE ASC-TRIP-ID                 TO DK-TRIP-ID               16250000
162600                                                                  16260000
162700     EXEC SQL                                                     16270000
162800         SELECT                                                   16280000
162900             BTS.OTBND_TRIP_ID                                    16290000
163000         ,   BTS.OTBND_STAT_TMST                                  16300000
163100         ,   BTS.TRIP_STAT_CDE                                    16310000
163200         ,   BTS.STAT_OPER_UNT_ID                                 16320000
163300         ,   BTS.OTBND_STAT_USR_ID                                16330000
163400         ,   BTS.DOOR_ID                                          16340000
163500         ,   BTS.TRLR_SEAL_ID                                     16350000
163600         ,   BTS.SHIP_SCAC_CDE                                    16360000
163700         ,   BTS.SHIP_DRV_LAST_NM                                 16370000
163800         ,   BTS.SHIP_DRV_FRST_NM                                 16380000
163900         ,   BTS.SHIP_DRV_ID                                      16390000
164000         ,   BTS.TRLR_PRKG_LOC_DESC                               16400000
164100         ,   BTS.TRLR_PRKG_SLOT_NBR                               16410000
164200         ,   BTS.FINCL_POST_TMST                                  16420000
164300         ,   BTS.CPCTY_PCT                                        16430000
164400         ,   BTS.UNUSD_PLLT_QTY                                   16440000
164500         ,   BTS.LOD_BR_QTY                                       16450000
164600                                                                  16460000
164700         INTO                                                     16470000
164800             :SUOBTS-OTBND-TRIP-ID                                16480000
164900         ,   :SUOBTS-OTBND-STAT-TMST                              16490000
165000         ,   :SUOBTS-TRIP-STAT-CDE                                16500000
165100         ,   :SUOBTS-STAT-OPER-UNT-ID                             16510000
165200         ,   :SUOBTS-OTBND-STAT-USR-ID                            16520000
165300         ,   :SUOBTS-DOOR-ID                                      16530000
165400         ,   :SUOBTS-TRLR-SEAL-ID                                 16540000
165500         ,   :SUOBTS-SHIP-SCAC-CDE                                16550000
165600         ,   :SUOBTS-SHIP-DRV-LAST-NM                             16560000
165700         ,   :SUOBTS-SHIP-DRV-FRST-NM                             16570000
165800         ,   :SUOBTS-SHIP-DRV-ID                                  16580000
165900         ,   :SUOBTS-TRLR-PRKG-LOC-DESC                           16590000
166000         ,   :SUOBTS-TRLR-PRKG-SLOT-NBR                           16600000
166100         ,   :SUOBTS-FINCL-POST-TMST                              16610000
166200         ,   :SUOBTS-CPCTY-PCT                                    16620000
166300         ,   :SUOBTS-UNUSD-PLLT-QTY                               16630000
166400         ,   :SUOBTS-LOD-BR-QTY                                   16640000
166500                                                                  16650000
166600         FROM TSUOBTS BTS                                         16660000
166700         WHERE                                                    16670000
166800             BTS.OTBND_TRIP_ID           = :DK-TRIP-ID            16680000
166900         AND BTS.OTBND_STAT_TMST IN                               16690000
167000             (SELECT  MAX(BTS1.OTBND_STAT_TMST)                   16700000
167100                   FROM  TSUOBTS BTS1                             16710000
167200              WHERE  BTS1.OTBND_TRIP_ID = BTS.OTBND_TRIP_ID)      16720000
167300     END-EXEC.                                                    16730000
167400                                                                  16740000
167500     EVALUATE TRUE                                                16750000
167600         WHEN SQLCODE = ZERO                                      16760000
167700              CONTINUE                                            16770000
167800         WHEN SQLCODE = -904                                      16780000
167900         WHEN SQLCODE = -911                                      16790000
168000         WHEN SQLCODE = -913                                      16800000
168100             PERFORM 9900-SOFT-ABORT                              16810000
168200         WHEN SQLWARN0 NOT = SPACE                                16820000
168300         WHEN SQLCODE NOT = ZERO                                  16830000
168400              MOVE '7000-SELECT-TSUOBTS'                          16840000
168500                               TO DP013-PARAGRAPH                 16850000
168600              MOVE 'SELECT TSUOBTS'                               16860000
168700                               TO DP013-MESSAGE-TEXT (1)          16870000
168800              MOVE SQLCA       TO DP013-SQLCA                     16880000
168900              SET DP013-DB2-ABEND                                 16890000
169000                               TO TRUE                            16900000
169100              PERFORM DP013-0000-PROCESS-ABEND                    16910000
169200     END-EVALUATE.                                                16920000
169300                                                                  16930000
169400                                                                  16940000
169500 7010-SELECT-SEAL-ID.                                             16950000
169600                                                                  16960000
169700     MOVE ASC-TRIP-ID                 TO DK-TRIP-ID               16970000
169800                                                                  16980000
169900     EXEC SQL                                                     16990000
170000         SELECT                                                   17000000
170100             BTS.TRLR_SEAL_ID                                     17010000
170200         INTO                                                     17020000
170300             :SUOBTS-TRLR-SEAL-ID                                 17030000
170400         FROM TSUOBTS BTS                                         17040000
170500         WHERE                                                    17050000
170600             BTS.OTBND_TRIP_ID           = :DK-TRIP-ID            17060000
170700         AND BTS.TRIP_STAT_CDE           = 'DC'                   17070000
170800         AND BTS.OTBND_STAT_TMST IN                               17080000
170900             (SELECT  MAX(BTS1.OTBND_STAT_TMST)                   17090000
171000                   FROM  TSUOBTS BTS1                             17100000
171100              WHERE  BTS1.OTBND_TRIP_ID = BTS.OTBND_TRIP_ID       17110000
171200                 AND BTS1.TRIP_STAT_CDE           = 'DC' )        17120000
171300                                                                  17130000
171400     END-EXEC.                                                    17140000
171500                                                                  17150000
171600     EVALUATE TRUE                                                17160000
171700         WHEN SQLCODE = ZERO                                      17170000
171800              CONTINUE                                            17180000
171900         WHEN SQLCODE = -904                                      17190000
172000         WHEN SQLCODE = -911                                      17200000
172100         WHEN SQLCODE = -913                                      17210000
172200             PERFORM 9900-SOFT-ABORT                              17220000
172300         WHEN SQLWARN0 NOT = SPACE                                17230000
172400         WHEN SQLCODE NOT = ZERO                                  17240000
172500              MOVE '7010-SELECT-SEAL-ID'                          17250000
172600                               TO DP013-PARAGRAPH                 17260000
172700              MOVE 'SELECT CURRENT SEAL ID'                       17270000
172800                               TO DP013-MESSAGE-TEXT (1)          17280000
172900              MOVE SQLCA       TO DP013-SQLCA                     17290000
173000              SET DP013-DB2-ABEND                                 17300000
173100                               TO TRUE                            17310000
173200              PERFORM DP013-0000-PROCESS-ABEND                    17320000
173300     END-EVALUATE.                                                17330000
173400                                                                  17340000
173500                                                                  17350000
173600 7020-SELECT-STATUS.                                              17360000
173700                                                                  17370000
173800     MOVE ASC-TRIP-ID                 TO DK-TRIP-ID               17380000
173900                                                                  17390000
174000     EXEC SQL                                                     17400000
174100         SELECT                                                   17410000
174200             BTS.TRIP_STAT_CDE                                    17420000
174300         ,   BSC.TRIP_STAT_DESC                                   17430000
174400                                                                  17440000
174500         INTO                                                     17450000
174600             :SUOBTS-TRIP-STAT-CDE                                17460000
174700         ,   :SUOBSC-TRIP-STAT-DESC                               17470000
174800                                                                  17480000
174900         FROM TSUOBTS BTS                                         17490000
175000            , TSUOBSC BSC                                         17500000
175100         WHERE                                                    17510000
175200             BTS.TRIP_STAT_CDE           = BSC.TRIP_STAT_CDE      17520000
175300         AND BTS.OTBND_TRIP_ID           = :DK-TRIP-ID            17530000
175400         AND BTS.OTBND_STAT_TMST IN                               17540000
175500             (SELECT  MAX(BTS1.OTBND_STAT_TMST)                   17550000
175600                   FROM  TSUOBTS BTS1                             17560000
175700              WHERE  BTS1.OTBND_TRIP_ID = BTS.OTBND_TRIP_ID)      17570000
175800                                                                  17580000
175900     END-EXEC.                                                    17590000
176000                                                                  17600000
176100     EVALUATE TRUE                                                17610000
176200         WHEN SQLCODE = ZERO                                      17620000
176300              CONTINUE                                            17630000
176400         WHEN SQLCODE = -904                                      17640000
176500         WHEN SQLCODE = -911                                      17650000
176600         WHEN SQLCODE = -913                                      17660000
176700             PERFORM 9900-SOFT-ABORT                              17670000
176800         WHEN SQLWARN0 NOT = SPACE                                17680000
176900         WHEN SQLCODE NOT = ZERO                                  17690000
177000              MOVE '7020-SELECT-STATUS'                           17700000
177100                               TO DP013-PARAGRAPH                 17710000
177200              MOVE 'SELECT CURRENT TRIP STATUS'                   17720000
177300                               TO DP013-MESSAGE-TEXT (1)          17730000
177400              MOVE SQLCA       TO DP013-SQLCA                     17740000
177500              SET DP013-DB2-ABEND                                 17750000
177600                               TO TRUE                            17760000
177700              PERFORM DP013-0000-PROCESS-ABEND                    17770000
177800     END-EVALUATE.                                                17780000
177900                                                                  17790000
178000******************************************************************17800000
178100* clp- made 2 para's 7030- and 7031- so the display will determine17810000
178200* where it oringinated from                                       17820000
178300******************************************************************17830000
178400* CHECK IF WE ARE SENDING TRAILER OPEN RECORD TO MLS SYSTEM.     *17840000
178500* MERCHANDISE LOCATION SYSTEM.                                   *17850000
178600* ADDED 8/1/11                                                   *17860000
178700******************************************************************17870000
178800 7030-CHECK-SEND-TO-MLS.                                          17880000
178900                                                                  17890000
179000     EXEC SQL                                                     17900000
179100         SELECT FUNC_TXT                                          17910000
179200           INTO :KRPRPM-FUNC-TXT                                  17920000
179300           FROM TKRPRPM                                           17930000
179400          WHERE LOC_ID            =  90                           17940000
179500            AND INTFC_SYS_CDE     = 'KHL'                         17950000
179600            AND FUNC_PRC_STAT_CDE = 'AC'                          17960000
179700            AND SYS_PRC_FUNC_CDE  = 'MLSMFS'                      17970000
179800            AND FUNC_BEG_TMST    <=  CURRENT TIMESTAMP            17980000
179900            AND FUNC_END_TMST    >=  CURRENT TIMESTAMP            17990000
180000         WITH UR                                                  18000000
180100     END-EXEC.                                                    18010000
180200                                                                  18020000
180300     EVALUATE TRUE                                                18030000
180400         WHEN SQLCODE = ZERO                                      18040000
180500              IF  KRPRPM-FUNC-TXT  = 'Y'                          18050000
180600                  SET PS-SEND-MANIFEST-TO-MLS-YES TO TRUE         18060000
180700                  DISPLAY 'SUKCS568 - 7030- '                     18070000
180800                          'SEND TRAILER MANIFEST TO MLS '         18080000
180900                  SUOBTS-OTBND-TRIP-ID ' ' ASC-NEW-TRIP-STAT-CDE  18090000
181000              ELSE                                                18100000
181100                  SET PS-SEND-MANIFEST-TO-MLS-NO  TO TRUE         18110000
181200                  DISPLAY 'SUKCS568 - 7030- '                     18120000
181300                          'DONT SEND TRAILER MANIFEST TO MLS '    18130000
181400                  SUOBTS-OTBND-TRIP-ID ' ' ASC-NEW-TRIP-STAT-CDE  18140000
181500              END-IF                                              18150000
181600                                                                  18160000
181700         WHEN SQLCODE = -904                                      18170000
181800         WHEN SQLCODE = -911                                      18180000
181900         WHEN SQLCODE = -913                                      18190000
182000              SET PS-SEND-MANIFEST-TO-MLS-NO  TO TRUE             18200000
182100              DISPLAY '7030-DONT SEND TRAILER MANIFEST TO MLS'    18210000
182200                SUOBTS-OTBND-TRIP-ID ' ' ASC-NEW-TRIP-STAT-CDE    18220000
182300              PERFORM 9900-SOFT-ABORT                             18230000
182400                                                                  18240000
182500         WHEN SQLWARN0 NOT = SPACE                                18250000
182600         WHEN SQLCODE NOT = ZERO                                  18260000
182700              SET PS-SEND-MANIFEST-TO-MLS-NO  TO TRUE             18270000
182800              MOVE '7030-CHECK-SEND-TO-MLS'                       18280000
182900                               TO DP013-PARAGRAPH                 18290000
183000              MOVE 'CHECK IF SENDING DATA TO MLS QUEUE'           18300000
183100                               TO DP013-MESSAGE-TEXT (1)          18310000
183200              MOVE SQLCA       TO DP013-SQLCA                     18320000
183300              SET DP013-DB2-ABEND                                 18330000
183400                               TO TRUE                            18340000
183500              PERFORM DP013-0000-PROCESS-ABEND                    18350000
183600     END-EVALUATE.                                                18360000
183700                                                                  18370000
183800******************************************************************18380000
183900* CHECK IF WE ARE SENDING TRAILER OPEN RECORD TO MLS SYSTEM.     *18390000
184000* MERCHANDISE LOCATION SYSTEM.                                   *18400000
184100* ADDED 8/1/11                                                   *18410000
184200******************************************************************18420000
184300 7031-CHECK-SEND-TO-MLS.                                          18430000
184400                                                                  18440000
184500     EXEC SQL                                                     18450000
184600         SELECT FUNC_TXT                                          18460000
184700           INTO :KRPRPM-FUNC-TXT                                  18470000
184800           FROM TKRPRPM                                           18480000
184900          WHERE LOC_ID            =  90                           18490000
185000            AND INTFC_SYS_CDE     = 'KHL'                         18500000
185100            AND FUNC_PRC_STAT_CDE = 'AC'                          18510000
185200            AND SYS_PRC_FUNC_CDE  = 'MLSMFS'                      18520000
185300            AND FUNC_BEG_TMST    <=  CURRENT TIMESTAMP            18530000
185400            AND FUNC_END_TMST    >=  CURRENT TIMESTAMP            18540000
185500         WITH UR                                                  18550000
185600     END-EXEC.                                                    18560000
185700                                                                  18570000
185800     EVALUATE TRUE                                                18580000
185900         WHEN SQLCODE = ZERO                                      18590000
186000              IF  KRPRPM-FUNC-TXT  = 'Y'                          18600000
186100                  SET PS-SEND-MANIFEST-TO-MLS-YES TO TRUE         18610000
186200                  DISPLAY 'SUKCS568 - 7031- '                     18620000
186300                          'SEND TRAILER MANIFEST TO MLS '         18630000
186400                  SUOBTS-OTBND-TRIP-ID ' ' ASC-NEW-TRIP-STAT-CDE  18640000
186500              ELSE                                                18650000
186600                  SET PS-SEND-MANIFEST-TO-MLS-NO  TO TRUE         18660000
186700                  DISPLAY 'SUKCS568 - 7031- '                     18670000
186800                          'DONT SEND TRAILER MANIFEST TO MLS '    18680000
186900                  SUOBTS-OTBND-TRIP-ID ' ' ASC-NEW-TRIP-STAT-CDE  18690000
187000              END-IF                                              18700000
187100                                                                  18710000
187200         WHEN SQLCODE = -904                                      18720000
187300         WHEN SQLCODE = -911                                      18730000
187400         WHEN SQLCODE = -913                                      18740000
187500              SET PS-SEND-MANIFEST-TO-MLS-NO  TO TRUE             18750000
187600              DISPLAY '7031-DONT SEND TRAILER MANIFEST TO MLS'    18760000
187700                SUOBTS-OTBND-TRIP-ID ' ' ASC-NEW-TRIP-STAT-CDE    18770000
187800              PERFORM 9900-SOFT-ABORT                             18780000
187900                                                                  18790000
188000         WHEN SQLWARN0 NOT = SPACE                                18800000
188100         WHEN SQLCODE NOT = ZERO                                  18810000
188200              SET PS-SEND-MANIFEST-TO-MLS-NO  TO TRUE             18820000
188300              MOVE '7031-CHECK-SEND-TO-MLS'                       18830000
188400                               TO DP013-PARAGRAPH                 18840000
188500              MOVE 'CHECK IF SENDING DATA TO MLS QUEUE'           18850000
188600                               TO DP013-MESSAGE-TEXT (1)          18860000
188700              MOVE SQLCA       TO DP013-SQLCA                     18870000
188800              SET DP013-DB2-ABEND                                 18880000
188900                               TO TRUE                            18890000
189000              PERFORM DP013-0000-PROCESS-ABEND                    18900000
189100     END-EVALUATE.                                                18910000
189200                                                                  18920000
189300******************************************************************18930000
189400* CHECK IF WE ARE SENDING TRAILER OPEN RECORD TO OMS SYSTEM.     *18940000
189500* ORDER MANAGEMENT SYSTEM.                                       *18950000
189600* ADDED 3/4/16 CLP                                               *18960000
189700******************************************************************18970000
189800 7040-CHECK-SEND-TO-OMS.                                          18980000
189900                                                                  18990000
190000     EXEC SQL                                                     19000000
190100         SELECT FUNC_TXT                                          19010000
190200           INTO :KRPRPM-FUNC-TXT                                  19020000
190300           FROM TKRPRPM                                           19030000
190400          WHERE LOC_ID            =  90                           19040000
190500            AND INTFC_SYS_CDE     = 'KHL'                         19050000
190600            AND FUNC_PRC_STAT_CDE = 'AC'                          19060000
190700            AND SYS_PRC_FUNC_CDE  = 'OMSMFS'                      19070000
190800            AND FUNC_BEG_TMST    <=  CURRENT TIMESTAMP            19080000
190900            AND FUNC_END_TMST    >=  CURRENT TIMESTAMP            19090000
191000         WITH UR                                                  19100000
191100     END-EXEC.                                                    19110000
191200                                                                  19120000
191300     EVALUATE TRUE                                                19130000
191400         WHEN SQLCODE = ZERO                                      19140000
191500              IF  KRPRPM-FUNC-TXT  = 'Y'                          19150000
191600                  SET PS-SEND-MANIFEST-TO-OMS-YES TO TRUE         19160000
191700                  DISPLAY 'SUKCS568 - 7040- '                     19170000
191800                          'SEND TRAILER MANIFEST TO OMS '         19180000
191900                  SUOBTS-OTBND-TRIP-ID ' ' ASC-NEW-TRIP-STAT-CDE  19190000
192000              ELSE                                                19200000
192100                  SET PS-SEND-MANIFEST-TO-MLS-NO  TO TRUE         19210000
192200                  DISPLAY 'SUKCS568 - 7040- '                     19220000
192300                          'DONT SEND TRAILER MANIFEST TO OMS '    19230000
192400                  SUOBTS-OTBND-TRIP-ID ' ' ASC-NEW-TRIP-STAT-CDE  19240000
192500              END-IF                                              19250000
192600                                                                  19260000
192700         WHEN SQLCODE = -904                                      19270000
192800         WHEN SQLCODE = -911                                      19280000
192900         WHEN SQLCODE = -913                                      19290000
193000              SET PS-SEND-MANIFEST-TO-MLS-NO  TO TRUE             19300000
193100              DISPLAY '7040-DONT SEND TRAILER MANIFEST TO OMS '   19310000
193200                SUOBTS-OTBND-TRIP-ID ' ' ASC-NEW-TRIP-STAT-CDE    19320000
193300              PERFORM 9900-SOFT-ABORT                             19330000
193400                                                                  19340000
193500         WHEN SQLWARN0 NOT = SPACE                                19350000
193600         WHEN SQLCODE NOT = ZERO                                  19360000
193700              SET PS-SEND-MANIFEST-TO-MLS-NO  TO TRUE             19370000
193800              MOVE '7040-CHECK-SEND-TO-OMS'                       19380000
193900                               TO DP013-PARAGRAPH                 19390000
194000              MOVE 'CHECK IF SENDING DATA TO OMS QUEUE'           19400000
194100                               TO DP013-MESSAGE-TEXT (1)          19410000
194200              MOVE SQLCA       TO DP013-SQLCA                     19420000
194300              SET DP013-DB2-ABEND                                 19430000
194400                               TO TRUE                            19440000
194500              PERFORM DP013-0000-PROCESS-ABEND                    19450000
194600     END-EVALUATE.                                                19460000
194700                                                                  19470000
194800 7100-INSERT-TSUOBTS.                                             19480000
194900                                                                  19490000
195000     EXEC SQL                                                     19500000
195100       INSERT INTO TSUOBTS                                        19510000
195200           ( OTBND_TRIP_ID                                        19520000
195300            ,OTBND_STAT_TMST                                      19530000
195400            ,TRIP_STAT_CDE                                        19540000
195500            ,STAT_OPER_UNT_ID                                     19550000
195600            ,OTBND_STAT_USR_ID                                    19560000
195700            ,DOOR_ID                                              19570000
195800            ,TRLR_SEAL_ID                                         19580000
195900            ,SHIP_SCAC_CDE                                        19590000
196000            ,SHIP_DRV_LAST_NM                                     19600000
196100            ,SHIP_DRV_FRST_NM                                     19610000
196200            ,SHIP_DRV_ID                                          19620000
196300            ,TRLR_PRKG_LOC_DESC                                   19630000
196400            ,TRLR_PRKG_SLOT_NBR                                   19640000
196500            ,FINCL_POST_TMST                                      19650000
196600            ,CPCTY_PCT                                            19660000
196700            ,UNUSD_PLLT_QTY                                       19670000
196800            ,LOD_BR_QTY                                           19680000
196900           )                                                      19690000
197000       VALUES                                                     19700000
197100         (                                                        19710000
197200             :SUOBTS-OTBND-TRIP-ID                                19720000
197300         ,   CURRENT TIMESTAMP                                    19730000
197400         ,   :ASC-NEW-TRIP-STAT-CDE                               19740000
197500         ,   :ASC-STR-NBR                                         19750000
197600         ,   :DP020-USERID                                        19760000
197700         ,   :SUOBTS-DOOR-ID                                      19770000
197800         ,   :ASC-NEW-TRLR-SEAL-ID                                19780000
197900         ,   :SUOBTS-SHIP-SCAC-CDE                                19790000
198000         ,   :SUOBTS-SHIP-DRV-LAST-NM                             19800000
198100         ,   :SUOBTS-SHIP-DRV-FRST-NM                             19810000
198200         ,   :SUOBTS-SHIP-DRV-ID                                  19820000
198300         ,   :SUOBTS-TRLR-PRKG-LOC-DESC                           19830000
198400         ,   :SUOBTS-TRLR-PRKG-SLOT-NBR                           19840000
198500         ,   :PC-DEFAULT-TMST                                     19850000
198600         ,   :SUOBTS-CPCTY-PCT                                    19860000
198700         ,   :SUOBTS-UNUSD-PLLT-QTY                               19870000
198800         ,   :SUOBTS-LOD-BR-QTY                                   19880000
198900         )                                                        19890000
199000     END-EXEC.                                                    19900000
199100                                                                  19910000
199200     EVALUATE TRUE                                                19920000
199300         WHEN SQLCODE = ZERO                                      19930000
199400              CONTINUE                                            19940000
199500         WHEN SQLCODE = -904                                      19950000
199600         WHEN SQLCODE = -911                                      19960000
199700         WHEN SQLCODE = -913                                      19970000
199800             PERFORM 9900-SOFT-ABORT                              19980000
199900         WHEN SQLWARN0 NOT = SPACE                                19990000
200000         WHEN SQLCODE NOT = ZERO                                  20000000
200100              MOVE '7100-INSERT-STATUS'                           20010000
200200                               TO DP013-PARAGRAPH                 20020000
200300              MOVE 'INSERT NEW TRIP STATUS ROW'                   20030000
200400                               TO DP013-MESSAGE-TEXT (1)          20040000
200500              MOVE SQLCA       TO DP013-SQLCA                     20050000
200600              SET DP013-DB2-ABEND                                 20060000
200700                               TO TRUE                            20070000
200800              PERFORM DP013-0000-PROCESS-ABEND                    20080000
200900     END-EVALUATE.                                                20090000
201000                                                                  20100000
201100                                                                  20110000
201200 7200-INSERT-WRKR-AUD.                                            20120000
201300                                                                  20130000
201400     MOVE  ASC-TRIP-ID    TO  SUT00006-OTBND-TRIP-ID              20140000
201500     IF  ASC-NEW-TRIP-STAT-CDE  =  'SO'                           20150000
201600         MOVE 'SUKC568A'  TO  PV-PROGRAM-FUNCTION                 20160000
201700     ELSE                                                         20170000
201800         MOVE 'SUKC568B'  TO  PV-PROGRAM-FUNCTION                 20180000
201900     END-IF.                                                      20190000
202000                                                                  20200000
202100     EXEC SQL                                                     20210000
202200         INSERT INTO SUT_TRIP_WRKR_AUD                            20220000
202300             (                                                    20230000
202400               OTBND_TRIP_ID                                      20240000
202500             , USR_ID                                             20250000
202600             , CRE_TMST                                           20260000
202700             , CRE_BY_PGM_NM                                      20270000
202800                 )                                                20280000
202900                                                                  20290000
203000             VALUES                                               20300000
203100                                                                  20310000
203200                 (                                                20320000
203300                 :SUT00006-OTBND-TRIP-ID                          20330000
203400             ,   :DP020-USERID                                    20340000
203500             ,   CURRENT TIMESTAMP                                20350000
203600             ,   :PV-PROGRAM-FUNCTION                             20360000
203700                 )                                                20370000
203800     END-EXEC.                                                    20380000
203900                                                                  20390000
204000     EVALUATE TRUE                                                20400000
204100         WHEN SQLCODE = ZERO                                      20410000
204200              CONTINUE                                            20420000
204300         WHEN SQLCODE = -904                                      20430000
204400         WHEN SQLCODE = -911                                      20440000
204500         WHEN SQLCODE = -913                                      20450000
204600             PERFORM 9900-SOFT-ABORT                              20460000
204700         WHEN SQLWARN0 NOT = SPACE                                20470000
204800         WHEN SQLCODE NOT = ZERO                                  20480000
204900              MOVE '7200-INSERT-WRKR-AUD'                         20490000
205000                               TO DP013-PARAGRAPH                 20500000
205100              MOVE 'INSERT INSERT WORKER AUDIT ROW'               20510000
205200                               TO DP013-MESSAGE-TEXT (1)          20520000
205300              MOVE SQLCA       TO DP013-SQLCA                     20530000
205400              SET DP013-DB2-ABEND                                 20540000
205500                               TO TRUE                            20550000
205600              PERFORM DP013-0000-PROCESS-ABEND                    20560000
205700     END-EVALUATE.                                                20570000
205800                                                                  20580000
205900******************************************************************20590000
206000*                                                                 20600000
206100******************************************************************20610000
206200 7300-MOVE-FOR-XML.                                               20620000
206300                                                                  20630000
206400     INITIALIZE PV-SHIPPED-TMST-OUT.                              20640000
206500     MOVE SUOBTS-OTBND-STAT-TMST TO PV-SHIPPED-TMST.              20650000
206600     MOVE PV-SHIPPED-TMST(1:10) TO PV-SHIPPED-DATE.               20660000
206700     MOVE PV-SHIPPED-HH         TO PV-SHIPPED-TIME(1:2).          20670000
206800     MOVE ':'                   TO PV-SHIPPED-TIME(3:1)           20680000
206900                                   PV-SHIPPED-TIME(6:1).          20690000
207000     MOVE 'T'                   TO PV-T.                          20700000
207100     MOVE PV-SHIPPED-MN         TO PV-SHIPPED-TIME(4:2).          20710000
207200     MOVE PV-SHIPPED-SC         TO PV-SHIPPED-TIME(7:2).          20720000
207300     MOVE PV-SHIPPED-TMST-OUT    TO ShipmentTS.                   20730000
207400     MOVE SUOBTS-OTBND-TRIP-ID   TO OutboundTripId.               20740000
207500     MOVE ASC-NEW-TRIP-STAT-CDE  TO StatusCode.                   20750000
207600     MOVE ASC-STR-NBR            TO Store.                        20760000
207700                                                                  20770000
207800****************************************************************  20780000
207900* CREATE XML                                                      20790000
208000****************************************************************  20800000
208100 7400-CREATE-MSGS.                                                20810000
208200                                                                  20820000
208300     PERFORM 7500-GENERATE-XML.                                   20830000
208400                                                                  20840000
208500     MOVE PV-XML-BANNER              TO PV-MSGBUFFER-banner.      20850000
208600     MOVE PV-XML(1:XML-LENGTH)       TO PV-MSGBUFFER-data.        20860000
208700*****display 'start of xml message from sukcs568'.                20870000
208800*****display pv-msgbuffer-banner.                                 20880000
208900*****display pv-msgbuffer-data.                                   20890000
209000     COMPUTE PV-MSG-LENGTH2 = XML-LENGTH                          20900000
209100                           + LENGTH OF PV-XML-BANNER.             20910000
209200*****DISPLAY ' PV-MSG-LENGTH2 = ' PV-MSG-LENGTH2                  20920000
209300     MOVE PV-MSG-LENGTH2 TO PV-MSG-LENGTH-DISPLAY.                20930000
209400     INITIALIZE PS-MQPUT-SUCCESSFUL-IND                           20940000
209500                PC-MQPUT-RETRY-COUNTER.                           20950000
209600                                                                  20960000
209700**************************************OMS**********************   20970000
209800 7500-GENERATE-XML.                                               20980000
209900                                                                  20990000
210000     MOVE SPACES TO PV-XML.                                       21000000
210100     XML GENERATE PV-XML                                          21010000
210200         FROM TrailerManifest                                     21020000
210300         COUNT IN XML-LENGTH                                      21030000
210400         WITH ATTRIBUTES                                          21040000
210500         ON EXCEPTION                                             21050000
210600             DISPLAY TrailerManifest ' PV=' PV-XML                21060000
210700             PERFORM 7600-XML-ERROR                               21070000
210800         NOT ON EXCEPTION                                         21080000
210900             CONTINUE                                             21090000
211000     END-XML.                                                     21100000
211100                                                                  21110000
211200***************************************************************   21120000
211300 7600-XML-ERROR.                                                  21130000
211400                                                                  21140000
211500     PERFORM 9000-EXPLAIN-XML-RESPONSE                            21150000
211600     PERFORM  VARYING XML-LINE-IDX FROM 1 BY 1                    21160000
211700                UNTIL XML-LINE-IDX > XML-RESPONSE-LINES           21170000
211800*        DISPLAY XML-MSG(XML-LINE-IDX)                            21180000
211900     END-PERFORM.                                                 21190000
212000     SET DP013-CICS-ABEND TO TRUE                                 21200000
212100     SET DP013-NO-ROLLBACK TO TRUE                                21210000
212200     MOVE '7600-XML-ERROR'                                        21220000
212300                     TO DP013-PARAGRAPH                           21230000
212400     MOVE 'ERROR TRYING TO DELETE SELECTION TS QUEUE'             21240000
212500                    TO DP013-MESSAGE-TEXT (1)                     21250000
212600     PERFORM DP013-0000-PROCESS-ABEND.                            21260000
212700                                                                  21270000
212800     COPY ISPD007.                                                21280000
212900     COPY ISPD008.                                                21290000
213000     COPY ISPD009.                                                21300000
213100                                                                  21310000
213200                                                                  21320000
213300***************************************************************** 21330000
213400 8000-MQ-PROCESSING.                                              21340000
213500***************************MLS*********************************** 21350000
213600                                                                  21360000
213700* MQ PROCESSING                                                   21370000
213800       SET PROCESS-MQ-NO TO TRUE.                                 21380000
213900       PERFORM 8100-SELECT-XLTLOC.                                21390000
214000       IF PROCESS-MQ                                              21400000
214100           PERFORM 8200-GET-INPUT-QUEUE-INFO                      21410000
214200           PERFORM 8300-MQSERIES-CONNECT                          21420000
214300           PERFORM 8400-MQSERIES-OPEN                             21430000
214400           PERFORM 8500-PUT-MQ-MESG-ON-QUEUE                      21440000
214500           PERFORM 8600-MQ-CLOSE-QUEUE                            21450000
214600           PERFORM 8700-MQ-DISCONNECT.                            21460000
214700                                                                  21470000
214800*                                                                 21480000
214900***************************************************************** 21490000
215000 8001-MQ-PROCESSING.                                              21500000
215100***************************OMS*********************************** 21510000
215200                                                                  21520000
215300* MQ PROCESSING                                                   21530000
215400       IF PROCESS-MQ                                              21540000
215500           PERFORM 7300-MOVE-FOR-XML                              21550000
215600           PERFORM 7400-CREATE-MSGS                               21560000
215700           PERFORM 8201-GET-INPUT-QUEUE-INFO                      21570000
215800           PERFORM 8300-MQSERIES-CONNECT                          21580000
215900           PERFORM 8400-MQSERIES-OPEN                             21590000
216000           PERFORM 8501-PUT-MQ-MESG-ON-QUEUE                      21600000
216100           PERFORM 8600-MQ-CLOSE-QUEUE                            21610000
216200           PERFORM 8700-MQ-DISCONNECT.                            21620000
216300                                                                  21630000
216400***************************************************************** 21640000
216500 8100-SELECT-XLTLOC.                                              21650000
216600***************************************************************** 21660000
216700                                                                  21670000
216800* ONLY CREATE MQ MESSAGE IF A STORE ('DS') AND NOT EDI            21680000
216900                                                                  21690000
217000         EXEC SQL                                                 21700000
217100            SELECT  LOC_NBR                                       21710000
217200              INTO :XLT00010-LOC-NBR                              21720000
217300              FROM  XLT_LOC                                       21730000
217400             WHERE  LOC_NBR = :ASC-STR-NBR                        21740000
217500               AND  LOC_TYP_CDE = 'DS'                            21750000
217600               AND  E_BUS_IND = 'N'                               21760000
217700         END-EXEC.                                                21770000
217800                                                                  21780000
217900         EVALUATE TRUE                                            21790000
218000             WHEN SQLCODE = +0                                    21800000
218100                 SET PROCESS-MQ TO TRUE                           21810000
218200             WHEN SQLCODE = +100                                  21820000
218300                 SET PROCESS-MQ-NO TO TRUE                        21830000
218400                                                                  21840000
218500             WHEN SQLWARN0 NOT = SPACES                           21850000
218600             WHEN SQLCODE < +0                                    21860000
218700             WHEN SQLCODE > +0                                    21870000
218800                 MOVE '8100-SELECT-XLTLOC'                        21880000
218900                                 TO DP013-PARAGRAPH               21890000
219000                 MOVE 'CHECK FOR STORE'                           21900000
219100                                 TO DP013-MESSAGE-TEXT (1)        21910000
219200                 MOVE SQLCA      TO DP013-SQLCA                   21920000
219300                 MOVE 'XLT_LOC'  TO DP013-DB2-TABLE-NAME (1)      21930000
219400                 SET DP013-DB2-ABEND                              21940000
219500                                 TO TRUE                          21950000
219600                 SET DP013-XCTL-DISPLAY-RESTART                   21960000
219700                                 TO TRUE                          21970000
219800                 PERFORM DP013-0000-PROCESS-ABEND                 21980000
219900         END-EVALUATE.                                            21990000
220000                                                                  22000000
220100***************************************************************** 22010000
220200 8200-GET-INPUT-QUEUE-INFO.                                       22020000
220300***************************************************************** 22030000
220400                                                                  22040000
220500*SELECT  QUEUE MANAGER AND INPUT QUEUE NAME                       22050000
220600                                                                  22060000
220700       INITIALIZE DCLWSV00005.                                    22070000
220800       MOVE 'QUEUE'  TO WSV00005-APPL-FUNC-DESC.                  22080000
220900       MOVE 'MLSMFSTQ'    TO WSV00005-INTGRTN-TYP-CDE.            22090000
221000                                                                  22100000
221100       EXEC SQL                                                   22110000
221200           SELECT                                                 22120000
221300                 LCL_QUE_MGR                                      22130000
221400                ,RMT_QUE_MGR                                      22140000
221500                ,QUE_NM                                           22150000
221600           INTO                                                   22160000
221700                :WSV00005-LCL-QUE-MGR                             22170000
221800               ,:WSV00005-RMT-QUE-MGR                             22180000
221900               ,:WSV00005-QUE-NM                                  22190000
222000           FROM  WSV_PRVDR_QUE                                    22200000
222100          WHERE  APPL_FUNC_DESC  = :WSV00005-APPL-FUNC-DESC       22210000
222200            AND  INTGRTN_TYP_CDE = :WSV00005-INTGRTN-TYP-CDE      22220000
222300       END-EXEC.                                                  22230000
222400                                                                  22240000
222500       EVALUATE TRUE                                              22250000
222600           WHEN SQLCODE = +0                                      22260000
222700               INITIALIZE PV-QMGR-NAME                            22270000
222800               MOVE WSV00005-LCL-QUE-MGR-TEXT  TO PV-QMGR-NAME    22280000
222900               INITIALIZE PV-QUE-NAME                             22290000
223000               MOVE WSV00005-QUE-NM-TEXT       TO PV-QUE-NAME     22300000
223100           WHEN SQLCODE = +100                                    22310000
223200           WHEN SQLWARN0 NOT = SPACES                             22320000
223300           WHEN SQLCODE  NOT = ZERO                               22330000
223400              MOVE '8200-GET-INPUT-QUEUE-INFO'                    22340000
223500                               TO DP013-PARAGRAPH                 22350000
223600              MOVE 'SELECT QUEUE NAME FROM WSV-PRVDR-QUE'         22360000
223700                               TO DP013-MESSAGE-TEXT (1)          22370000
223800              MOVE SQLCA       TO DP013-SQLCA                     22380000
223900              SET DP013-DB2-ABEND                                 22390000
224000                               TO TRUE                            22400000
224100              PERFORM DP013-0000-PROCESS-ABEND                    22410000
224200       END-EVALUATE.                                              22420000
224300                                                                  22430000
224400***************************************************************** 22440000
224500 8201-GET-INPUT-QUEUE-INFO.                                       22450000
224600***************************************************************** 22460000
224700                                                                  22470000
224800*SELECT  QUEUE MANAGER AND INPUT QUEUE NAME                       22480000
224900                                                                  22490000
225000       INITIALIZE DCLWSV00005.                                    22500000
225100       MOVE 'QUEUE'  TO WSV00005-APPL-FUNC-DESC.                  22510000
225200       MOVE 'OMSMFSTQ'    TO WSV00005-INTGRTN-TYP-CDE.            22520000
225300                                                                  22530000
225400       EXEC SQL                                                   22540000
225500           SELECT                                                 22550000
225600                 LCL_QUE_MGR                                      22560000
225700                ,RMT_QUE_MGR                                      22570000
225800                ,QUE_NM                                           22580000
225900           INTO                                                   22590000
226000                :WSV00005-LCL-QUE-MGR                             22600000
226100               ,:WSV00005-RMT-QUE-MGR                             22610000
226200               ,:WSV00005-QUE-NM                                  22620000
226300           FROM  WSV_PRVDR_QUE                                    22630000
226400          WHERE  APPL_FUNC_DESC  = :WSV00005-APPL-FUNC-DESC       22640000
226500            AND  INTGRTN_TYP_CDE = :WSV00005-INTGRTN-TYP-CDE      22650000
226600       END-EXEC.                                                  22660000
226700                                                                  22670000
226800       EVALUATE TRUE                                              22680000
226900           WHEN SQLCODE = +0                                      22690000
227000               INITIALIZE PV-QMGR-NAME                            22700000
227100               MOVE WSV00005-LCL-QUE-MGR-TEXT  TO PV-QMGR-NAME    22710000
227200               INITIALIZE PV-QUE-NAME                             22720000
227300               MOVE WSV00005-QUE-NM-TEXT       TO PV-QUE-NAME     22730000
227400           WHEN SQLCODE = +100                                    22740000
227500           WHEN SQLWARN0 NOT = SPACES                             22750000
227600           WHEN SQLCODE  NOT = ZERO                               22760000
227700              MOVE '8201-GET-INPUT-QUEUE-INFO'                    22770000
227800                               TO DP013-PARAGRAPH                 22780000
227900              MOVE 'SELECT QUEUE NAME FROM WSV-PRVDR-QUE'         22790000
228000                               TO DP013-MESSAGE-TEXT (1)          22800000
228100              MOVE SQLCA       TO DP013-SQLCA                     22810000
228200              SET DP013-DB2-ABEND                                 22820000
228300                               TO TRUE                            22830000
228400              PERFORM DP013-0000-PROCESS-ABEND                    22840000
228500       END-EVALUATE.                                              22850000
228600                                                                  22860000
228700******************************************************************22870000
228800* CONNECT TO XXX QUEUE MANAGER.                                   22880000
228900******************************************************************22890000
229000 8300-MQSERIES-CONNECT.                                           22900000
229100                                                                  22910000
229200     CALL PC-MQCONN USING PV-QMGR-NAME                            22920000
229300                          PV-HCONN                                22930000
229400                          PV-COMPLETION-CODE                      22940000
229500                          PV-REASON.                              22950000
229600                                                                  22960000
229700                                                                  22970000
229800*    IF CONNECTION FAILED THEN DISPLAY ERROR MESSAGE              22980000
229900*    AND EXIT                                                     22990000
230000                                                                  23000000
230100     MOVE PV-REASON TO PV-CON-REASON.                             23010000
230200     IF PV-COMPLETION-CODE = MQCC-OK THEN                         23020000
230300         CONTINUE                                                 23030000
230400     ELSE                                                         23040000
230500         MOVE '8300-MQSERIES-CONNECT'                             23050000
230600                               TO DP013-PARAGRAPH                 23060000
230700         MOVE 'CONNECT TO MQ QUEUE'                               23070000
230800                               TO DP013-MESSAgE-TEXT (1)          23080000
230900         SET DP013-OTHER-ABEND                                    23090000
231000                               TO TRUE                            23100000
231100         PERFORM DP013-0000-PROCESS-ABEND                         23110000
231200     END-IF.                                                      23120000
231300***************************************************************** 23130000
231400*** OPEN THE ITEM QUEUE FOR PUTS TO WS-PRVDR-QUE                  23140000
231500***************************************************************** 23150000
231600 8400-MQSERIES-OPEN.                                              23160000
231700                                                                  23170000
231800     INITIALIZE PV-QMGR-NAME.                                     23180000
231900     MOVE WSV00005-RMT-QUE-MGR-TEXT  TO PV-QMGR-NAME              23190000
232000                                                                  23200000
232100     COMPUTE PV-OPEN-OPTIONS        = MQOO-OUTPUT                 23210000
232200                                    + MQOO-SET-IDENTITY-CONTEXT   23220000
232300                                    + MQOO-FAIL-IF-QUIESCING.     23230000
232400                                                                  23240000
232500                                                                  23250000
232600                                                                  23260000
232700     MOVE MQOT-Q                   TO MQOD-OBJECTTYPE.            23270000
232800     MOVE PV-QMGR-NAME             TO MQOD-OBJECTQMGRNAME.        23280000
232900     MOVE PV-QUE-NAME              TO MQOD-OBJECTNAME.            23290000
233000                                                                  23300000
233100     CALL PC-MQOPEN USING PV-HCONN                                23310000
233200                          MQM-OBJECT-DESCRIPTOR                   23320000
233300                          PV-OPEN-OPTIONS                         23330000
233400                          PV-HANDLE                               23340000
233500                          PV-COMPLETION-CODE                      23350000
233600                          PV-REASON.                              23360000
233700                                                                  23370000
233800                                                                  23380000
233900*    IF OPEN FAILED THEN DISPLAY ERROR MESSAGE AND EXIT.          23390000
234000                                                                  23400000
234100     IF PV-COMPLETION-CODE = MQCC-OK THEN                         23410000
234200         CONTINUE                                                 23420000
234300     ELSE                                                         23430000
234400         MOVE '8400-MQSERIES-OPEN'                                23440000
234500                               TO DP013-PARAGRAPH                 23450000
234600         MOVE 'OPEN MQ QUEUE'                                     23460000
234700                               TO DP013-MESSAgE-TEXT (1)          23470000
234800         SET DP013-OTHER-ABEND                                    23480000
234900                               TO TRUE                            23490000
235000         PERFORM DP013-0000-PROCESS-ABEND                         23500000
235100      END-IF.                                                     23510000
235200                                                                  23520000
235300***************************************************************** 23530000
235400* PUT THE OUTGOING MQ MESSAGE ON QUEUE                            23540000
235500***************************************************************** 23550000
235600 8500-PUT-MQ-MESG-ON-QUEUE.                                       23560000
235700                                                                  23570000
235800*SET OPTIONS.                                                     23580000
235900     MOVE MQFMT-STRING     TO MQMD-FORMAT.                        23590000
236000     MOVE MQPER-PERSISTENT TO MQMD-PERSISTENCE.                   23600000
236100     COMPUTE MQPMO-OPTIONS  =  MQPMO-SYNCPOINT +                  23610000
236200                               MQPMO-SET-IDENTITY-CONTEXT.        23620000
236300                                                                  23630000
236400*THE MSG LENGTH FOR THE TRANSACTION IS SET IN WORKING STORAGE.    23640000
236500                                                                  23650000
236600     INITIALIZE SU102-EXTRACT-RECORD.                             23660000
236700     MOVE   SUOBTS-OTBND-TRIP-ID      TO SU102-OTBND-TRIP-ID.     23670000
236800     MOVE   SUOBTS-OTBND-STAT-TMST    TO SU102-SHIPPED-TMST.      23680000
236900     MOVE   ASC-NEW-TRIP-STAT-CDE     TO SU102-TRIP-STAT-CDE.     23690000
237000     MOVE   ASC-STR-NBR               TO SU102-DEST-LOC-NBR.      23700000
237100     MOVE SU102-EXTRACT-RECORD        TO PV-MSG.                  23710000
237200                                                                  23720000
237300                                                                  23730000
237400*PUT MSG.                                                         23740000
237500     CALL PC-MQPUT USING PV-HCONN                                 23750000
237600                         PV-HANDLE                                23760000
237700                         MQM-MESSAGE-DESCRIPTOR                   23770000
237800                         MQM-PUT-MESSAGE-OPTIONS                  23780000
237900                         PV-MSG-LENGTH                            23790000
238000                         PV-MSG                                   23800000
238100                         PV-COMPLETION-CODE                       23810000
238200                         PV-REASON.                               23820000
238300                                                                  23830000
238400*IF PUT FAILED THEN DISPLAY ERROR MESSAGE                         23840000
238500*AND BREAK OUT OF LOOP                                            23850000
238600     IF (PV-COMPLETION-CODE NOT = MQCC-OK)                        23860000
238700         MOVE '8500-PUT-MQ-MESG-ON-QUEUE'                         23870000
238800                               TO DP013-PARAGRAPH                 23880000
238900         MOVE 'PUT MESSAGE ON MQ QUEUE'                           23890000
239000                               TO DP013-MESSAGE-TEXT (1)          23900000
239100         SET DP013-OTHER-ABEND                                    23910000
239200                               TO TRUE                            23920000
239300         PERFORM DP013-0000-PROCESS-ABEND                         23930000
239400     END-IF.                                                      23940000
239500                                                                  23950000
239600***************************************************************** 23960000
239700* PUT THE OUTGOING MQ MESSAGE ON QUEUE - OMS                      23970000
239800***************************************************************** 23980000
239900 8501-PUT-MQ-MESG-ON-QUEUE.                                       23990000
240000                                                                  24000000
240100*SET OPTIONS.                                                     24010000
240200     MOVE MQFMT-STRING     TO MQMD-FORMAT.                        24020000
240300     MOVE MQPER-PERSISTENT TO MQMD-PERSISTENCE.                   24030000
240400     COMPUTE MQPMO-OPTIONS  =  MQPMO-SYNCPOINT +                  24040000
240500                               MQPMO-SET-IDENTITY-CONTEXT.        24050000
240600                                                                  24060000
240700*PUT MSG.                                                         24070000
240800     CALL PC-MQPUT USING PV-HCONN                                 24080000
240900                         PV-HANDLE                                24090000
241000                         MQM-MESSAGE-DESCRIPTOR                   24100000
241100                         MQM-PUT-MESSAGE-OPTIONS                  24110000
241200                         PV-MSG-LENGTH2                           24120000
241300                         PV-MSGBUFFER                             24130000
241400                         PV-COMPLETION-CODE                       24140000
241500                         PV-REASON.                               24150000
241600                                                                  24160000
241700*IF PUT FAILED THEN DISPLAY ERROR MESSAGE                         24170000
241800*AND BREAK OUT OF LOOP                                            24180000
241900     IF (PV-COMPLETION-CODE NOT = MQCC-OK)                        24190000
242000         DISPLAY 'SUKCS568 - '                                    24200000
242100            'ISSUE WITH THE PUT TO QUEUE  '                       24210000
242200             SUOBTS-OTBND-TRIP-ID ' ' ASC-NEW-TRIP-STAT-CDE       24220000
242300         MOVE '8501-PUT-MQ-MESG-ON-QUEUE'                         24230000
242400                               TO DP013-PARAGRAPH                 24240000
242500         MOVE 'PUT MESSAGE ON MQ QUEUE'                           24250000
242600                               TO DP013-MESSAGE-TEXT (1)          24260000
242700         SET DP013-OTHER-ABEND                                    24270000
242800                               TO TRUE                            24280000
242900         PERFORM DP013-0000-PROCESS-ABEND                         24290000
243000     END-IF.                                                      24300000
243100                                                                  24310000
243200***************************************************************** 24320000
243300* MQ SERIES CLOSE QUEUE FOR THE xxx TRANSACTIONS.                 24330000
243400***************************************************************** 24340000
243500 8600-MQ-CLOSE-QUEUE.                                             24350000
243600                                                                  24360000
243700     MOVE PV-QUE-NAME               TO MQOD-OBJECTNAME.           24370000
243800     MOVE PV-QMGR-NAME              TO MQOD-OBJECTQMGRNAME.       24380000
243900                                                                  24390000
244000     CALL PC-MQCLOSE USING PV-HCONN                               24400000
244100                           PV-HANDLE                              24410000
244200                           MQCO-NONE                              24420000
244300                           PV-COMPLETION-CODE                     24430000
244400                           PV-REASON.                             24440000
244500                                                                  24450000
244600*    IF MQ CLOSE FAILED THEN DISPLAY ERROR MESSAGE                24460000
244700*    AND EXIT                                                     24470000
244800                                                                  24480000
244900     IF PV-COMPLETION-CODE = MQCC-OK THEN                         24490000
245000         CONTINUE                                                 24500000
245100     ELSE                                                         24510000
245200         MOVE '8600-MQ-CLOSE-QUEUE'                               24520000
245300                               TO DP013-PARAGRAPH                 24530000
245400         MOVE 'CLOSE MQ QUEUE'                                    24540000
245500                               TO DP013-MESSAGE-TEXT (1)          24550000
245600         SET DP013-OTHER-ABEND                                    24560000
245700                               TO TRUE                            24570000
245800         PERFORM DP013-0000-PROCESS-ABEND                         24580000
245900     END-IF.                                                      24590000
246000                                                                  24600000
246100***************************************************************** 24610000
246200* DISCONNECT FROM QUEUE MANAGER.                                  24620000
246300***************************************************************** 24630000
246400 8700-MQ-DISCONNECT.                                              24640000
246500                                                                  24650000
246600     IF PV-CON-REASON NOT = MQRC-ALREADY-CONNECTED                24660000
246700         CALL PC-MQDISC USING PV-HCONN                            24670000
246800                              PV-COMPLETION-CODE                  24680000
246900                              PV-REASON.                          24690000
247000                                                                  24700000
247100*    IF MQ DISCONNECT FAILED THEN DISPLAY ERROR MESSAGE           24710000
247200*    AND EXIT                                                     24720000
247300                                                                  24730000
247400     IF PV-COMPLETION-CODE = MQCC-OK THEN                         24740000
247500         CONTINUE                                                 24750000
247600     ELSE                                                         24760000
247700         MOVE '8700-MQ-DISCONNECT'                                24770000
247800                               TO DP013-PARAGRAPH                 24780000
247900         MOVE 'DISCONNECT FROM MQ QUEUE'                          24790000
248000                               TO DP013-MESSAGE-TEXT (1)          24800000
248100         SET DP013-OTHER-ABEND                                    24810000
248200                               TO TRUE                            24820000
248300         PERFORM DP013-0000-PROCESS-ABEND                         24830000
248400     END-IF.                                                      24840000
248500                                                                  24850000
248600                                                                  24860000
248700*----------------------------------------------------------------*24870000
248800* READ AN ITEM FROM THE SELECTED ITEMS TEMP STORAGE QUEUE.       *24880000
248900*----------------------------------------------------------------*24890000
249000                                                                  24900000
249100 9100-READ-SEL-QUEUE.                                             24910000
249200     EXEC CICS                                                    24920000
249300         READQ TS                                                 24930000
249400             QUEUE (ASC-SEL-QUEUE-NAME)                           24940000
249500             INTO  (SU013-SELECT-RECORD)                          24950000
249600             ITEM  (ASC-SEL-ITEM)                                 24960000
249700             RESP  (PV-CICS-RESPONSE)                             24970000
249800     END-EXEC.                                                    24980000
249900                                                                  24990000
250000     IF  PV-CICS-RESPONSE EQUAL DFHRESP(NORMAL)                   25000000
250100         CONTINUE                                                 25010000
250200     ELSE                                                         25020000
250300         SET DP013-LOGIC-ABEND                                    25030000
250400             DP013-NO-ROLLBACK     TO TRUE                        25040000
250500         MOVE '9100-READ-SEL-QUEUE'                               25050000
250600                                   TO DP013-PARAGRAPH             25060000
250700         MOVE 'ATTEMPTING TO READ THE LIST SELECTIONS TS QUEUE'   25070000
250800                                   TO DP013-MESSAGE-TEXT (1)      25080000
250900         PERFORM DP013-0000-PROCESS-ABEND                         25090000
251000     END-IF.                                                      25100000
251100*----------------------------------------------------------------*25110000
251200* UPDATE AN ITEM IN THE SELECTED ITEMS TEMP STORAGE QUEUE.       *25120000
251300*----------------------------------------------------------------*25130000
251400 9200-REWRITE-LIST-QUEUE.                                         25140000
251500     EXEC CICS                                                    25150000
251600          WRITEQ TS                                               25160000
251700              QUEUE  (ASC-SEL-QUEUE-NAME)                         25170000
251800              FROM   (SU013-SELECT-RECORD)                        25180000
251900              ITEM   (ASC-SEL-ITEM)                               25190000
252000              RESP   (PV-CICS-RESPONSE)                           25200000
252100              REWRITE                                             25210000
252200     END-EXEC.                                                    25220000
252300                                                                  25230000
252400     IF  PV-CICS-RESPONSE NOT EQUAL DFHRESP(NORMAL)               25240000
252500         SET DP013-CICS-ABEND                                     25250000
252600             DP013-NO-ROLLBACK     TO TRUE                        25260000
252700         MOVE '9200-REWRITE-LIST-QUEUE'                           25270000
252800                                   TO DP013-PARAGRAPH             25280000
252900         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   25290000
253000                                   TO DP013-MESSAGE-TEXT (1)      25300000
253100         PERFORM DP013-0000-PROCESS-ABEND                         25310000
253200     END-IF.                                                      25320000
253300                                                                  25330000
253400 9900-SOFT-ABORT.                                                 25340000
253500     SET PS-ERROR         TO TRUE.                                25350000
253600     SET DP020-MSG-FATAL  TO TRUE.                                25360000
253700     MOVE 'THROUGH SOFT-ABORT PARA'                               25370000
253800                            TO DP013-MESSAGE-TEXT (1)             25380000
253900     MOVE PC-TSYMSG-00551 TO DP020-MSG-NUMBER.                    25390000
254000*    IF PS-NO-NEXT-SCREEN                                         25400000
254100         SET DP020-NEXT-ACT-APPL-ERROR TO TRUE                    25410000
254200*    END-IF.                                                      25420000
254300                                                                  25430000
254400     MOVE 'PROGRAM EXIT CALL' TO DP013-MESSAGE-TEXT (1).          25440000
254500     PERFORM 0001-CALL-CICS-ARCH-API.                             25450000
254600                                                                  25460000
254700*----------------------------------------------------------------*25470000
254800*    ABEND PROCESSOR MODULE                                      *25480000
254900*----------------------------------------------------------------*25490000
255000                                                                  25500000
255100     COPY DPPD013.                                                25510000
255200                                                                  25520000
255300*----------------------------------------------------------------*25530000
255400*    LINK TO CICS OBJECT LOCKING MODULE                          *25540000
255500*----------------------------------------------------------------*25550000
255600                                                                  25560000
255700     COPY DPPD044.                                                25570000
255800                                                                  25580000
