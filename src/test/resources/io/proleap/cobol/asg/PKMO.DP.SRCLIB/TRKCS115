000100 IDENTIFICATION DIVISION.                                         00010006
000200 PROGRAM-ID.    TRKCS115.                                         00020006
000300 AUTHOR.        TOM RUSKA. G&R.                                   00030006
000400 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00040006
000500 DATE-WRITTEN.  01-04-94.                                         00050006
000600 DATE-COMPILED.                                                   00060006
000700                                                                  00070006
000800*---------------------------------------------------------------* 00080006
000900*    TRANID      - Y115                                         * 00090006
001000*    TYPE        - CICS ARCHITECTURE MAINTENANCE - DB2          * 00100006
001100*    DESCRIPTION - MAINTAIN SHIPMENTS                           * 00110006
001200*    MAPSET      - TRKM115                                      * 00120006
001300*                                                               * 00130006
001400*    THIS PROGRAM WILL SETUP AND MAINTAIN THE CONTENTS OF A     * 00140006
001500*    TRAILER.                                                   * 00150006
001600*                                                               * 00160006
001700*---------------------------------------------------------------* 00170006
001800*    CHANGED 12-08-2011 CHRISTINE TWIEHAUS WR40574              * 00180006
001900*            ADDED ENTRY OF CAN (CARR-AUTH-ID)                  * 00190006
002000*---------------------------------------------------------------* 00200006
273427* CHANGED 08/16/2022    BY BARB SCHULTZ    WR: CHG0273427       * 00201020
273427* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE   * 00202020
273427* MAKING THE CALL DYNAMIC VS STATIC.                            * 00203020
002000*---------------------------------------------------------------* 00204017
CICS  * CHANGED 11/21/2022    BY JIM HUNTER      WR: CHG0278495         00205021
CICS  * ADD COPYBOOK DPWS930 AND MAKE THE CICS ARCHITECTURE CALL        00206021
CICS  * DYNAMIC INSTEAD OF STATIC BY CALLING DP930-CICS-ARCH-API.       00207021
CICS  *-----------------------------------------------------------------00208021
002100                                                                  00210006
002200 ENVIRONMENT DIVISION.                                            00220006
002300 DATA DIVISION.                                                   00230006
002400                                                                  00240006
002500/                                                                 00250006
002600 WORKING-STORAGE SECTION.                                         00260006
002700                                                                  00270006
002800 01  DN-NULL-INDICATORS.                                          00280006
002900     05  DN-VEH-NBR                   PIC S9(4) COMP VALUE +0.    00290006
003000     05  DN-TRIP-ID                   PIC S9(4) COMP VALUE +0.    00300006
003100     05  DN-TRIP-TRIP-ID              PIC S9(4) COMP VALUE +0.    00310006
003200     05  DN-CURR-TRIP-ID              PIC S9(4) COMP VALUE +0.    00320006
003300     05  DN-SHIP-EST-AR-TMST          PIC S9(4) COMP VALUE +0.    00330006
003400     05  DN-TRIP-EST-AR-TMST          PIC S9(4) COMP VALUE +0.    00340006
003500                                                                  00350006
003600 01  DK-DB2-KEYS.                                                 00360006
003700     05  DK-OPER-UNT-ID               PIC S9(04) VALUE +0         00370006
003800                                                 COMP.            00380006
003900     05  DK-FCLTY-ID                  PIC S9(04) VALUE +0         00390006
004000                                                 COMP.            00400006
004100     05  DK-OWNER-SCAC-ID             PIC  X(04) VALUE SPACES.    00410006
004200     05  DK-PRO-SCAC-ID               PIC  X(04) VALUE SPACES.    00420006
004300     05  DK-VEH-NBR                   PIC  X(10) VALUE SPACES.    00430006
004400     05  DK-SHIPT-STATUS-CDE          PIC  X(02) VALUE SPACES.    00440006
004500     05  DK-PKG-TYP-CDE               PIC  X(03) VALUE SPACES.    00450006
004600     05  DK-TRIP-ID                   PIC S9(09) VALUE +0         00460006
004700                                                 COMP.            00470006
004800     05  DK-SHIPT-ID                  PIC S9(09) VALUE +0         00480006
004900                                                 COMP.            00490006
005000     05  DK-PRO-NBR                   PIC X(22)  VALUE SPACES.    00500006
005100     05  DK-BOL-NBR                   PIC X(30)  VALUE SPACES.    00510006
005200     05  DK-MANIFEST-NBR              PIC X(16)  VALUE SPACES.    00520006
005300     05  DK-CONTNR-ID                 PIC X(12)  VALUE SPACES.    00530006
005400                                                                  00540006
005500 01  PC-PROGRAM-CONSTANTS.                                        00550006
005600     05  PC-CURRENT-MAP-NAME            PIC  X(08)  VALUE         00560006
005700                                                    'TR115A  '.   00570006
005800     05  PC-CURRENT-MAPSET-NAME         PIC  X(08)  VALUE         00580006
005900                                                    'TRKM115 '.   00590006
006000     05  PC-APPL-MAP                    PIC S9(04)  VALUE  +1     00600006
006100                                                    COMP.         00610006
006200     05  PC-CURRENT-PROGRAM-NAME        PIC  X(08)  VALUE         00620006
006300                                                    'TRKCS115'.   00630006
006400     05  PC-RANDNBR-PGM                 PIC X(08)   VALUE         00640006
006500                                                    'DPKUT902'.   00650015
006800     05  PC-DPKUT500-PGM                PIC X(08)   VALUE         00680006
006900                                                    'DPKUT500'.   00690006
007000     05  PC-DEFAULT-DATE                PIC X(10)    VALUE        00700006
007100                                                    '0001-01-01'. 00710006
007200     05  PC-DEFAULT-TIME                PIC X(08)    VALUE        00720006
007300                                                    '00.00.00'.   00730006
007400     05  PC-INTER-APPL-CODES.                                     00740006
007500         10  PC-INTER-APPL-MAINT-ADD    PIC  X(01)  VALUE '1'.    00750006
007600         10  PC-INTER-APPL-CRIT-ADD     PIC  X(01)  VALUE '2'.    00760006
007700         10  PC-INTER-APPL-UPDATE       PIC  X(01)  VALUE '3'.    00770006
007800         10  PC-INTER-APPL-DELETE       PIC  X(01)  VALUE '4'.    00780006
007900         10  PC-INTER-APPL-LIST-ADD     PIC  X(01)  VALUE '7'.    00790006
008000         10  PC-INTER-APPL-SUSPND-UPDT  PIC  X(01)  VALUE '8'.    00800006
008100                                                                  00810006
008200     05  PC-MAX-RETRIES                 PIC S9(03)  VALUE +3      00820006
008300                                                    COMP-3.       00830006
008400                                                                  00840006
008500     05  PC-TSYMSG-NUMBERS.                                       00850006
008600         10  PC-TSYMSG-00004            PIC  9(05)  VALUE  00004. 00860006
008700         10  PC-TSYMSG-00005            PIC  9(05)  VALUE  00005. 00870006
008800         10  PC-TSYMSG-00007            PIC  9(05)  VALUE  00007. 00880006
008900         10  PC-TSYMSG-00008            PIC  9(05)  VALUE  00008. 00890006
009000         10  PC-TSYMSG-00009            PIC  9(05)  VALUE  00009. 00900006
009100         10  PC-TSYMSG-00016            PIC  9(05)  VALUE  00016. 00910006
009200         10  PC-TSYMSG-00034            PIC  9(05)  VALUE  00034. 00920006
009300         10  PC-TSYMSG-00046            PIC  9(05)  VALUE  00046. 00930006
009400         10  PC-TSYMSG-00057            PIC  9(05)  VALUE  00057. 00940006
009500         10  PC-TSYMSG-00059            PIC  9(05)  VALUE  00059. 00950006
009600         10  PC-TSYMSG-00069            PIC  9(05)  VALUE  00069. 00960006
009700         10  PC-TSYMSG-00070            PIC  9(05)  VALUE  00070. 00970006
009800         10  PC-TSYMSG-00112            PIC  9(05)  VALUE  00112. 00980006
009900         10  PC-TSYMSG-00115            PIC  9(05)  VALUE  00115. 00990006
010000         10  PC-TSYMSG-00116            PIC  9(05)  VALUE  00116. 01000006
010100         10  PC-TSYMSG-00117            PIC  9(05)  VALUE  00117. 01010006
010200         10  PC-TSYMSG-00146            PIC  9(05)  VALUE  00146. 01020006
010300         10  PC-TSYMSG-00148            PIC  9(05)  VALUE  00148. 01030006
010400         10  PC-TSYMSG-00158            PIC  9(05)  VALUE  00158. 01040006
010500         10  PC-TSYMSG-00308            PIC  9(05)  VALUE  00308. 01050006
010600         10  PC-TSYMSG-00644            PIC  9(05)  VALUE  00644. 01060006
010700         10  PC-TSYMSG-00646            PIC  9(05)  VALUE  00646. 01070006
010800         10  PC-TSYMSG-00647            PIC  9(05)  VALUE  00647. 01080006
010900         10  PC-TSYMSG-00648            PIC  9(05)  VALUE  00648. 01090006
011000         10  PC-TSYMSG-00650            PIC  9(05)  VALUE  00650. 01100006
011100         10  PC-TSYMSG-00651            PIC  9(05)  VALUE  00651. 01110006
011200         10  PC-TSYMSG-00715            PIC  9(05)  VALUE  00715. 01120006
011300         10  PC-TSYMSG-00743            PIC  9(05)  VALUE  00743. 01130006
011400         10  PC-TSYMSG-00752            PIC  9(05)  VALUE  00752. 01140006
011500         10  PC-TSYMSG-00770            PIC  9(05)  VALUE  00770. 01150006
011600         10  PC-TSYMSG-00803            PIC  9(05)  VALUE  00803. 01160006
011700         10  PC-TSYMSG-01319            PIC  9(05)  VALUE  01319. 01170006
011800         10  PC-TSYMSG-01802            PIC  9(05)  VALUE  01802. 01180006
011900         10  PC-TSYMSG-03332            PIC  9(05)  VALUE  03332. 01190006
012000         10  PC-TSYMSG-03373            PIC  9(05)  VALUE  03373. 01200006
012010         10  PC-TSYMSG-03803            PIC  9(05)  VALUE  03803. 01201011
012100     05  PC-24                          PIC  9(02)  VALUE 24.     01210006
012200     05  PC-59                          PIC  9(02)  VALUE 59.     01220006
012300                                                                  01230006
012400 01  PS-PROGRAM-SWITCHES.                                         01240006
012500     05  PS-ERROR-SW                    PIC  X(01)  VALUE 'Y'.    01250006
012600         88  PS-NO-ERROR                            VALUE 'Y'.    01260006
012700         88  PS-ERROR                               VALUE 'N'.    01270006
012800     05  PS-COMMAREA-SW                 PIC  X(01)  VALUE 'N'.    01280006
012900         88  PS-COMMAREA-VALID                      VALUE 'Y'.    01290006
013000         88  PS-COMMAREA-NOT-VALID                  VALUE 'N'.    01300006
013100     05  PS-DONE-SW                     PIC  X(01)  VALUE 'N'.    01310006
013200         88  PS-DONE                                VALUE 'Y'.    01320006
013300         88  PS-NOT-DONE                            VALUE 'N'.    01330006
013400     05  PS-ETA-TIME-SW                 PIC  X(01)  VALUE 'N'.    01340006
013500         88  PS-ETA-TIME-NOT-VALID                  VALUE 'N'.    01350006
013600         88  PS-ETA-TIME-VALID                      VALUE 'Y'.    01360006
013700     05  PS-ETA-DATE-SW                 PIC  X(01)  VALUE 'N'.    01370006
013800         88  PS-ETA-DATE-VALID                      VALUE 'Y'.    01380006
013900         88  PS-ETA-DATE-NOT-VALID                  VALUE 'N'.    01390006
014000     05  PS-UPDATE-TIMPORL-SW           PIC  X(01)  VALUE 'N'.    01400006
014100         88  PS-UPDATE-TIMPORL                      VALUE 'Y'.    01410006
014200         88  PS-DONT-UPDATE-TIMPORL                 VALUE 'N'.    01420006
014300     05  PS-SHPTPO-CURSOR-SW            PIC  X(01)  VALUE 'N'.    01430006
014400         88  PS-NO-MORE-SHPTPO                      VALUE 'Y'.    01440006
014500                                                                  01450006
014600 01  PV-PROGRAM-VARIABLES.                                        01460006
014700     05  PV-CICS-RESPONSE               PIC S9(04)  VALUE +0      01470006
014800                                                    COMP SYNC.    01480006
014900     05  PV-RETRY-COUNTER               PIC S9(04)  VALUE +0      01490006
015000                                                    COMP SYNC.    01500006
015100     05  PV-DB2-COUNT                   PIC S9(09)  VALUE +0      01510006
015200                                                    COMP-3.       01520006
015300     05  PV-VHTRIP-COUNT                PIC S9(09)  VALUE +0      01530006
015400                                                    COMP-3.       01540006
015500     05  PV-ABSTIME                     PIC S9(15)  COMP.         01550006
015600     05  PV-CURRENT-TIME                PIC  9(06).               01560006
015700     05  PV-CURRENT-DATE                PIC  9(06).               01570006
015800     05  PV-SAVE-TRIP-ID                PIC S9(09)  VALUE +0      01580006
015900                                                    COMP.         01590006
016000     05  PV-NEXT-TRIP-ID                PIC S9(09)  VALUE +0      01600006
016100                                                    COMP.         01610006
016200     05  PV-CURR-TRIP-ID                PIC S9(09)  VALUE +0      01620006
016300                                                    COMP.         01630006
016400     05  PV-EST-DATE-TIME.                                        01640006
016500         10  PV-EST-DATE                PIC X(10).                01650006
016600         10  FILLER                     PIC X(01).                01660006
016700         10  PV-EST-TIME                PIC X(08).                01670006
016800         10  FILLER                     PIC X(07).                01680006
016900                                                                  01690006
017000*---------------------------------------------------------------* 01700006
017100*  RECORD LAYOUT FOR THE LIST SELECTION TEMP STORAGE QUEUE.     * 01710006
017200*---------------------------------------------------------------* 01720006
017300                                                                  01730006
017400     COPY TRWS006.                                                01740006
017500                                                                  01750006
017600/                                                                 01760006
017700*---------------------------------------------------------------* 01770006
017800*    MAP LAYOUT                                                 * 01780006
017900*---------------------------------------------------------------* 01790006
018000                                                                  01800006
018100     COPY TRKM115.                                                01810006
018200                                                                  01820006
018300/                                                                 01830006
018400*---------------------------------------------------------------* 01840006
018500*    ATTRIBUTE SETTINGS COPYBOOK.                               * 01850006
018600*---------------------------------------------------------------* 01860006
018700                                                                  01870006
018800     COPY DPWS015.                                                01880006
018900                                                                  01890006
019000*---------------------------------------------------------------* 01900006
019100*    FUNCTION KEYS COPYBOOK.                                    * 01910006
019200*---------------------------------------------------------------* 01920006
019300                                                                  01930006
019400     COPY DPWS016.                                                01940006
019500                                                                  01950006
019600*---------------------------------------------------------------* 01960006
019700*    NUMERIC EDIT LAYOUT.                                       * 01970006
019800*---------------------------------------------------------------* 01980006
019900                                                                  01990006
020000     COPY DPWS010I.                                               02000006
020100                                                                  02010006
020200/                                                                 02020006
020300*----------------------------------------------------------------*02030006
020400*  COPYBOOK FOR RANDOM NUMBER GENERATOR DPKUT902                 *02040015
020500*----------------------------------------------------------------*02050006
020600     COPY DPWS902.                                                02060015
020700                                                                  02070006
020800                                                                  02080006
020900*  WORK AREA PASSED IN CALL TO RCKUT023                           02090006
021000*                                                                 02100006
021100     COPY RCWS023.                                                02110006
021200/                                                                 02120006
021300*---------------------------------------------------------------* 02130006
CICS  *    PARAMETERS FOR CALLING THE CICS ARCHITECTURE API.          * 02140021
021500*---------------------------------------------------------------* 02150006
021600                                                                  02160006
021700     COPY DPWS030.                                                02170006
CICS       COPY DPWS930.                                                02180021
021900/                                                                 02190006
022000*---------------------------------------------------------------* 02200006
022100*    STANDARD COMMAREA.                                         * 02210006
022200*---------------------------------------------------------------* 02220006
022300                                                                  02230006
022400     COPY DPWS020.                                                02240006
022500     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                02250006
022600                                                                  02260006
022700         10  INTER-APPL-COMM-AREA       PIC X(200).               02270006
022800     COPY TRWS005.                                                02280006
022900     COPY TRWS007.                                                02290006
023000*---------------------------------------------------------------* 02300006
023100*  THIS IS THE APPLICATION-SPECIFIC COMMAREA.                   * 02310006
023200*---------------------------------------------------------------* 02320006
023300         10  ASC-SPECIFIC-COMMAREA.                               02330006
023400             15  ASC-INT-APPL-FORMAT-IND           PIC X(01).     02340006
023500             15  ASC-ACTION-SW                     PIC X(03).     02350006
023600                 88  ASC-ADD-PENDING               VALUE 'ADD'.   02360006
023700                 88  ASC-DELETE-PENDING            VALUE 'DEL'.   02370006
023800                 88  ASC-UPDATE-PENDING            VALUE 'UPD'.   02380006
023900             15  ASC-DELETE-SUCCESSFUL-SW          PIC X(01).     02390006
024000                 88  ASC-DELETE-SUCCESSFUL         VALUE 'Y'.     02400006
024100             15  ASC-ADD-SUCCESSFUL-SW             PIC X(01).     02410006
024200                 88  ASC-ADD-NOT-SUCCESSFUL        VALUE ' '.     02420006
024300                 88  ASC-ADD-SUCCESSFUL            VALUE 'Y'.     02430006
024400             15  ASC-SHIPMENT-TYPE-SW              PIC X(01).     02440006
024500                 88  ASC-ADD-OPEN-SHIPMENT         VALUE 'O'.     02450006
024600                 88  ASC-ADD-SHIPMENT              VALUE 'S'.     02460006
024700             15  ASC-LOCAL-01-SW                   PIC X(01).     02470006
024800                 88  ASC-LOCAL-01-NEED-CONFIRM     VALUE 'Y'.     02480006
024900                 88  ASC-LOCAL-01-NO-NEED-CONFIRM  VALUE 'N'.     02490006
025000             15  ASC-LOCAL-02-SW                   PIC X(01).     02500006
025100                 88  ASC-LOCAL-02-NEED-CONFIRM     VALUE 'Y'.     02510006
025200                 88  ASC-LOCAL-02-NO-NEED-CONFIRM  VALUE 'N'.     02520006
025300             15  ASC-FIELDS-CHANGED-SW             PIC X(01).     02530006
025400                 88  ASC-FIELDS-CHANGED            VALUE 'Y'.     02540006
025500             15  ASC-VEHICLE-SETUP-PREV-SW         PIC X(01).     02550006
025600                 88  ASC-VEHICLE-NULL-TRIP         VALUE 'L'.     02560006
025700                 88  ASC-VEHICLE-SETUP-PREV        VALUE 'Y'.     02570006
025800             15  ASC-SUSPND-UPDATE-SW              PIC X(01).     02580006
025900                 88  ASC-SUSPND-UPDATE-YES         VALUE 'Y'.     02590006
026000                 88  ASC-SUSPND-UPDATE-NO          VALUE 'N'.     02600006
026100             15  ASC-KEY-FIELDS.                                  02610006
026200                 20  ASC-KEY-DEST-OPER-UNT-ID      PIC X(04).     02620006
026300                 20  ASC-KEY-DEST-OPER-UNT-ID-N    REDEFINES      02630006
026400                     ASC-KEY-DEST-OPER-UNT-ID      PIC 9(04).     02640006
026500                 20  ASC-KEY-DEST-FCLTY-ID         PIC X(04).     02650006
026600                 20  ASC-KEY-DEST-FCLTY-ID-N       REDEFINES      02660006
026700                     ASC-KEY-DEST-FCLTY-ID         PIC 9(04).     02670006
026800                 20  ASC-KEY-OWNER-SCAC-ID         PIC X(04).     02680006
026900                 20  ASC-KEY-VEH-NBR               PIC X(10).     02690006
027000                 20  ASC-KEY-MANIFEST-NBR          PIC X(15).     02700006
027100                 20  ASC-KEY-PRO-SCAC-ID           PIC X(04).     02710006
027200                 20  ASC-KEY-PRO-NBR               PIC X(22).     02720006
027300                 20  ASC-KEY-COMP-PRO-NBR          PIC X(22).     02730006
027400                 20  ASC-KEY-COMP-BOL-NBR          PIC X(30).     02740006
027500                 20  ASC-KEY-BOL-NBR               PIC X(30).     02750006
027600                 20  ASC-KEY-TRIP-ID               PIC S9(9) COMP.02760006
027700                 20  ASC-KEY-SHIPT-ID              PIC S9(9) COMP.02770006
027800                 20  ASC-KEY-VEH-TYP-CDE           PIC X(02).     02780006
027900                 20  ASC-KEY-CONTNR-ID             PIC X(12).     02790006
028000                 20  ASC-PRO-NBR                   PIC X(22).     02800006
028100                 20  ASC-BOL-NBR                   PIC X(30).     02810006
028200*    CLT 12-08-2011 START WR40574                                 02820006
028300                 20  ASC-CAN                       PIC X(30).     02830006
028400*    CLT 12-08-2011 END   WR40574                                 02840006
028500             15  ASC-SCREEN-FIELDS.                               02850006
028600                 20  ASC-DEST-FCLTY-NME     PIC X(24).            02860006
028700                 20  ASC-OWNER-SCAC-ID-DESC PIC X(25).            02870006
028800                 20  ASC-PRO-SCAC-ID-DESC   PIC X(25).            02880006
028900                 20  ASC-SHIPT-STATUS-CDE   PIC X(02).            02890006
029000                 20  ASC-SHIPT-STATUS-DESC  PIC X(25).            02900006
029100                 20  ASC-PKG-TYP-CDE        PIC X(03).            02910006
029200                 20  ASC-PKG-TYP-CDE-DESC   PIC X(25).            02920006
029300                 20  ASC-PKG-QTY            PIC X(04).            02930006
029400                 20  ASC-PKG-QTY-N REDEFINES                      02940006
029500                     ASC-PKG-QTY            PIC 9(04).            02950006
029600                 20  ASC-GROSS-WGHT         PIC X(05).            02960006
029700                 20  ASC-GROSS-WGHT-N REDEFINES                   02970006
029800                     ASC-GROSS-WGHT         PIC 9(05).            02980006
029900                 20  ASC-PLT-QTY            PIC X(03).            02990006
030000                 20  ASC-PLT-QTY-N REDEFINES                      03000006
030100                     ASC-PLT-QTY            PIC 9(03).            03010006
030200                 20  ASC-FRGT-CHRG          PIC X(09).            03020006
030300                 20  ASC-FRGT-CHRG-N        PIC 9(06)V99.         03030006
030400                 20  ASC-FRGT-TERM          PIC X(01).            03040006
030500                 20  ASC-FRGT-TERM-DESC     PIC X(10).            03050006
030600                 20  ASC-ETA-DTE.                                 03060006
030700                     35  ASC-ETA-DTE-CCYY.                        03070006
030800                         40  ASC-ETA-DTE-CC     PIC X(02).        03080006
030900                         40  ASC-ETA-DTE-YY     PIC X(02).        03090006
031000                     35  FILLER-1               PIC X(01).        03100006
031100                     35  ASC-ETA-DTE-MM         PIC X(02).        03110006
031200                     35  FILLER-2               PIC X(01).        03120006
031300                     35  ASC-ETA-DTE-DD         PIC X(02).        03130006
031400                 20  FILLER REDEFINES ASC-ETA-DTE.                03140006
031500                     35  FILLER                 PIC X(02).        03150006
031600                     35  ASC-ETA-YY-MM-DD       PIC X(08).        03160006
031700                 20  ASC-ETA-TIME.                                03170006
031800                     35  ASC-ETA-TIME-HH        PIC X(02).        03180006
031900                     35  ASC-ETA-TIME-HH-N REDEFINES              03190006
032000                         ASC-ETA-TIME-HH        PIC 9(02).        03200006
032100                     35  FILLER-3               PIC X(01).        03210006
032200                     35  ASC-ETA-TIME-MM        PIC X(02).        03220006
032300                     35  ASC-ETA-TIME-MM-N REDEFINES              03230006
032400                         ASC-ETA-TIME-MM        PIC 9(02).        03240006
032500                     35  FILLER-4               PIC X(01).        03250006
032600                     35  ASC-ETA-TIME-SS        PIC X(02).        03260006
032700             15  ASC-SCREEN-FIELDS-OLD.                           03270006
032800                 20  ASC-PRO-SCAC-ID-OLD      PIC X(04).          03280006
032900                 20  ASC-PRO-NBR-OLD          PIC X(22).          03290006
033000                 20  ASC-BOL-NBR-OLD          PIC X(30).          03300006
033100                 20  ASC-SHIPT-STATUS-CDE-OLD PIC X(02).          03310006
033200                 20  ASC-PKG-TYP-CDE-OLD    PIC X(03).            03320006
033300                 20  ASC-PKG-QTY-N-OLD      PIC 9(04).            03330006
033400                 20  ASC-GROSS-WGHT-N-OLD   PIC 9(05).            03340006
033500                 20  ASC-PLT-QTY-N-OLD      PIC 9(03).            03350006
033600                 20  ASC-FRGT-CHRG-N-OLD    PIC 9(06)V99.         03360006
033700                 20  ASC-FRGT-TERM-OLD      PIC X(01).            03370006
033800                 20  ASC-ETA-DTE-OLD.                             03380006
033900                     35  ASC-ETA-DTE-CCYY-OLD   PIC X(04).        03390006
034000                     35  FILLER-5               PIC X(01).        03400006
034100                     35  ASC-ETA-DTE-MM-OLD     PIC X(02).        03410006
034200                     35  FILLER-6               PIC X(01).        03420006
034300                     35  ASC-ETA-DTE-DD-OLD     PIC X(02).        03430006
034400                 20  ASC-ETA-TIME-OLD           PIC X(08).        03440006
034410*    CLT 12-08-2011 START WR40574                                 03441006
034430                 20  ASC-CAN-OLD                   PIC X(30).     03443006
034440*    CLT 12-08-2011 END   WR40574                                 03444006
034500             15  ASC-TRIP-STATUS-CDE        PIC X(02).            03450006
034600             15  ASC-SHIPT-PRTY-CDE         PIC X(02).            03460006
034700             15  ASC-USE-SELECTION-QUEUE-IND                      03470006
034800                                        PIC  X(01).               03480006
034900                 88  ASC-USE-SELECTION-QUEUE        VALUE 'Y'.    03490006
035000             15  ASC-SEL-QUEUE-NAME     PIC  X(08).               03500006
035100             15  ASC-NUMBER-OF-TS-ITEMS PIC S9(05)  COMP-3.       03510006
035200             15  ASC-NUMBER-OF-SELECTED-ITEMS                     03520006
035300                                        PIC S9(09)  COMP-3.       03530006
035400             15  ASC-SEL-SUB            PIC S9(04)  COMP.         03540006
035500             15  ASC-SEL-ITEM           PIC S9(04)  COMP.         03550006
035600                                                                  03560006
035700/                                                                 03570006
035800*---------------------------------------------------------------* 03580006
035900*    ABEND PROCESSING COPYBOOK.                                 * 03590006
036000*---------------------------------------------------------------* 03600006
036100                                                                  03610006
036200     COPY DPWS013.                                                03620006
036300                                                                  03630006
036400/                                                                 03640006
036500*----------------------------------------------------------------*03650006
036600*  WORK AREA PASSED IN CALL TO DPKUT500                          *03660006
036700*----------------------------------------------------------------*03670006
036800     COPY DPWS500.                                                03680006
036900                                                                  03690006
037000/                                                                 03700006
037100*---------------------------------------------------------------* 03710006
037200*    DB2 AREA FOR THE FACILITY TABLE                            * 03720006
037300*---------------------------------------------------------------* 03730006
037400     EXEC SQL                                                     03740006
037500          INCLUDE TFACLTY                                         03750006
037600     END-EXEC.                                                    03760006
037700                                                                  03770006
037800/                                                                 03780006
037900*---------------------------------------------------------------* 03790006
038000*    DB2 AREA FOR THE IMPORTS CONTAINER TABLE                   * 03800006
038100*---------------------------------------------------------------* 03810006
038200     EXEC SQL                                                     03820006
038300          INCLUDE TIMCNTK                                         03830006
038400     END-EXEC.                                                    03840006
038500/                                                                 03850006
038600*---------------------------------------------------------------* 03860006
038700*    DB2 AREA FOR THE SHIPMENT STATUS CODE TABLE                * 03870006
038800*---------------------------------------------------------------* 03880006
038900     EXEC SQL                                                     03890006
039000          INCLUDE TSHSTYP                                         03900006
039100     END-EXEC.                                                    03910006
039200                                                                  03920006
039300/                                                                 03930006
039400*---------------------------------------------------------------* 03940006
039500*    DB2 AREA FOR THE SHIPMENT TABLE                            * 03950006
039600*---------------------------------------------------------------* 03960006
039700     EXEC SQL                                                     03970006
039800          INCLUDE TSHIPMT                                         03980006
039900     END-EXEC.                                                    03990006
040000                                                                  04000006
040100/                                                                 04010006
040200*---------------------------------------------------------------* 04020006
040300*    DB2 AREA FOR THE SHIPMENT AUDIT TABLE                      * 04030006
040400*---------------------------------------------------------------* 04040006
040500     EXEC SQL                                                     04050006
040600          INCLUDE TAUSHIP                                         04060006
040700     END-EXEC.                                                    04070006
040800                                                                  04080006
040900/                                                                 04090006
041000*---------------------------------------------------------------* 04100006
041100*    DB2 AREA FOR THE SHIPMENT STATUS TABLE                     * 04110006
041200*---------------------------------------------------------------* 04120006
041300     EXEC SQL                                                     04130006
041400          INCLUDE TSHIPST                                         04140006
041500     END-EXEC.                                                    04150006
041600                                                                  04160006
041700/                                                                 04170006
041800*---------------------------------------------------------------* 04180006
041900*    DB2 AREA FOR SHIPMENT PO TABLE                             * 04190006
042000*---------------------------------------------------------------* 04200006
042100     EXEC SQL                                                     04210006
042200          INCLUDE TSHPTPO                                         04220006
042300     END-EXEC.                                                    04230006
042400                                                                  04240006
042500/                                                                 04250006
042600*---------------------------------------------------------------* 04260006
042700*    DB2 AREA FOR THE EXTERNAL ENTERPRISE TABLE                 * 04270006
042800*---------------------------------------------------------------* 04280006
042900     EXEC SQL                                                     04290006
043000          INCLUDE TEXTENT                                         04300006
043100     END-EXEC.                                                    04310006
043200                                                                  04320006
043300/                                                                 04330006
043400*---------------------------------------------------------------* 04340006
043500*    DB2 AREA FOR THE IMPORT PO RELEASE TABLE                   * 04350006
043600*---------------------------------------------------------------* 04360006
043700     EXEC SQL                                                     04370006
043800          INCLUDE TIMPORL                                         04380006
043900     END-EXEC.                                                    04390006
044000                                                                  04400006
044100/                                                                 04410006
044200*---------------------------------------------------------------* 04420006
044300*    DB2 AREA FOR THE EXTERNAL ENTERPRISE NAME TABLE            * 04430006
044400*---------------------------------------------------------------* 04440006
044500     EXEC SQL                                                     04450006
044600          INCLUDE TENTNME                                         04460006
044700     END-EXEC.                                                    04470006
044800                                                                  04480006
044900/                                                                 04490006
045000*---------------------------------------------------------------* 04500006
045100*    DB2 AREA FOR THE VEHICLE TABLE                             * 04510006
045200*---------------------------------------------------------------* 04520006
045300     EXEC SQL                                                     04530006
045400          INCLUDE TVEHICL                                         04540006
045500     END-EXEC.                                                    04550006
045600                                                                  04560006
045700/                                                                 04570006
045800*---------------------------------------------------------------* 04580006
045900*    DB2 AREA FOR THE VEHICLE TRIP TABLE                        * 04590006
046000*---------------------------------------------------------------* 04600006
046100     EXEC SQL                                                     04610006
046200          INCLUDE TVHTRIP                                         04620006
046300     END-EXEC.                                                    04630006
046400                                                                  04640006
046500/                                                                 04650006
046600*---------------------------------------------------------------* 04660006
046700*    DB2 AREA FOR TRIP AUDIT TABLE                              * 04670006
046800*---------------------------------------------------------------* 04680006
046900     EXEC SQL                                                     04690006
047000          INCLUDE TAUTRIP                                         04700006
047100     END-EXEC.                                                    04710006
047200                                                                  04720006
047300/                                                                 04730006
047400*---------------------------------------------------------------* 04740006
047500*    DB2 AREA FOR THE TRIP STATUS TABLE                         * 04750006
047600*---------------------------------------------------------------* 04760006
047700     EXEC SQL                                                     04770006
047800          INCLUDE TTRIPST                                         04780006
047900     END-EXEC.                                                    04790006
048000                                                                  04800006
048100/                                                                 04810006
048200*---------------------------------------------------------------* 04820006
048300*    DB2 AREA FOR THE TRIP STATUS CODE TABLE                    * 04830006
048400*---------------------------------------------------------------* 04840006
048500     EXEC SQL                                                     04850006
048600          INCLUDE TTRSTYP                                         04860006
048700     END-EXEC.                                                    04870006
048800                                                                  04880006
048900/                                                                 04890006
049000*---------------------------------------------------------------* 04900006
049100*    DB2 AREA FOR THE SHIPMENT PACKAGE TYPE TABLE               * 04910006
049200*---------------------------------------------------------------* 04920006
049300     EXEC SQL                                                     04930006
049400          INCLUDE TPKGTYP                                         04940006
049500     END-EXEC.                                                    04950006
049600/                                                                 04960006
049700*                                                                 04970006
049800*  CURSOR DECLARATION FOR SHIPMENT PO INFO.                       04980006
049900*                                                                 04990006
050000     EXEC SQL                                                     05000006
050100          DECLARE SHPTPO_CUR CURSOR FOR                           05010006
050200           SELECT SP.PO_NBR                                       05020006
050300             FROM TSHIPMT   S                                     05030006
050400                , TSHPTPO   SP                                    05040006
050500                , TIMPORL   IM                                    05050006
050600             WHERE SP.SHIPT_ID   = :DK-SHIPT-ID                   05060006
050700               AND SP.SHIPT_ID   =   S.SHIPT_ID                   05070006
050800               AND SP.PO_NBR     =  IM.PO_NBR                     05080006
050900               AND IM.VER_STATUS_CDE   = 'A'                      05090006
051000               AND IM.DCONSLR_RLSE_CDE = 'S'                      05100006
051100     END-EXEC.                                                    05110006
051200*                                                                 05120006
051300/                                                                 05130006
051400*---------------------------------------------------------------* 05140006
051500*    DB2 AREA FOR COMMUNICATIONS                                * 05150006
051600*---------------------------------------------------------------* 05160006
051700     EXEC SQL                                                     05170006
051800          INCLUDE SQLCA                                           05180006
051900     END-EXEC.                                                    05190006
052000                                                                  05200006
052100/                                                                 05210006
052200 LINKAGE SECTION.                                                 05220006
052300                                                                  05230006
052400 01  DFHCOMMAREA.                                                 05240006
052500     05  FILLER                         OCCURS  1 TO 4072 TIMES   05250006
052600                                        DEPENDING ON EIBCALEN.    05260006
052700         10  FILLER                     PIC X.                    05270006
052800                                                                  05280006
052900/                                                                 05290006
053000 PROCEDURE DIVISION.                                              05300006
053100*---------------------------------------------------------------* 05310006
053200*   THIS MODULE IS THE HIGHEST PROCESSING LEVEL IN THE PROGRAM. * 05320006
053300*   FIRST, CALL THE CICS ARCHITECTURE API, PERFORM THE PROGRAM  * 05330006
053400*   PROCESSING AND THEN CALL THE CICS ARCHITECTURE API TO EXIT. * 05340006
053500*---------------------------------------------------------------* 05350006
053600 0000-MAIN-MODULE.                                                05360006
053700                                                                  05370006
053800     INITIALIZE DP030-CICS-API-FIELDS.                            05380006
053900                                                                  05390006
054000     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       05400006
054100     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          05410006
054200     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         05420006
054300                                                                  05430006
054400     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       05440006
054500                                                                  05450006
054600     MOVE LENGTH OF TR115AI        TO DP030-MAP-LENGTH (1).       05460006
054700     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     05470006
054800                                                                  05480006
054900     PERFORM 0001-CALL-CICS-ARCH-API.                             05490006
055000     PERFORM 1000-CONTROL-PROCESSING                              05500006
055100                                                                  05510006
055200     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     05520006
055300     PERFORM 0001-CALL-CICS-ARCH-API.                             05530006
055400                                                                  05540006
055500*---------------------------------------------------------------* 05550006
055600*   THIS PARAGRAPH CALLS THE CICS ARCHITECTURE API SUBROUTINE   * 05560006
055700*   AND WILL ABEND IF ANY ERRORS OCCURRED IN THAT CALL.         * 05570006
055800*---------------------------------------------------------------* 05580006
055900 0001-CALL-CICS-ARCH-API.                                         05590006
CICS       CALL DP930-CICS-ARCH-API USING DFHEIBLK                      05600021
056100                                    DFHCOMMAREA                   05610021
056200                                    DP030-CICS-API-FIELDS         05620021
056300                                    DP020-STANDARD-COMMAREA       05630021
056400                                    TR115AI.                      05640021
056500                                                                  05650006
056600     IF  DP030-RC-CALL-SUCCESSFUL                                 05660006
056700         CONTINUE                                                 05670006
056800     ELSE                                                         05680006
056900         SET DP013-NO-ROLLBACK                                    05690006
057000             DP013-XCTL-DISPLAY-RESTART                           05700006
057100             DP013-CICS-ABEND      TO TRUE                        05710006
057200         MOVE '0001-CALL-CICS-ARCH-API'                           05720006
057300                                   TO DP013-PARAGRAPH             05730006
CICS           MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O05740021
CICS  -             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      05750021
057600         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      05760006
057700         PERFORM DP013-0000-PROCESS-ABEND                         05770006
057800     END-IF.                                                      05780006
057900                                                                  05790006
058000*----------------------------------------------------------------*05800006
058100* PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT      *05810006
058200* COURSE OF ACTION IS FOR THIS TRANSACTION.                      *05820006
058300*----------------------------------------------------------------*05830006
058400                                                                  05840006
058500 1000-CONTROL-PROCESSING.                                         05850006
058600                                                                  05860006
058700     EVALUATE TRUE                                                05870006
058800         WHEN DP020-NEXT-ACT-INITIAL                              05880006
058900              PERFORM 1100-FIND-OBJECT-KEYS                       05890006
059000              IF  PS-ERROR                                        05900006
059100                  CONTINUE                                        05910006
059200              ELSE                                                05920006
059300                  PERFORM 4000-BUILD-INITIAL-PANEL                05930006
059400                  PERFORM 3200-RESET-ATTRIBUTES                   05940006
059500                  PERFORM 3500-SAVE-SCREEN-FIELDS                 05950006
059600                  IF  SQLCODE = +100                              05960006
059700                  AND NOT ASC-ADD-PENDING                         05970006
059800                      SET DP020-NEXT-ACT-APPL-ERROR               05980006
059900                                     TO TRUE                      05990006
060000                      MOVE PC-TSYMSG-00148                        06000006
060100                                     TO DP020-MSG-NUMBER          06010006
060200                      SET DP020-MSG-INFORMATIONAL                 06020006
060300                                     TO TRUE                      06030006
060400                  ELSE                                            06040006
060500                      IF  ASC-DELETE-PENDING                      06050006
060600                          MOVE PC-TSYMSG-00004                    06060006
060700                                     TO DP020-MSG-NUMBER          06070006
060800                          SET DP020-MSG-INFORMATIONAL             06080006
060900                                     TO TRUE                      06090006
061000                      END-IF                                      06100006
061100                  END-IF                                          06110006
061200              END-IF                                              06120006
061300                                                                  06130006
061400         WHEN DP020-NEXT-ACT-READ-MAP                             06140006
061500             PERFORM 2000-PROCESS-PANEL                           06150006
061600                                                                  06160006
061700         WHEN DP020-NEXT-ACT-RETURN                               06170006
061800             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 06180006
061900             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   06190006
062000                                                                  06200006
062100         WHEN OTHER                                               06210006
062200             SET DP013-LOGIC-ABEND TO TRUE                        06220006
062300             SET DP013-NO-ROLLBACK TO TRUE                        06230006
062400             MOVE '1000-CONTROL-PROCESSING'                       06240006
062500                                   TO DP013-PARAGRAPH             06250006
062600             MOVE 'INVALID NEXT ACTIVITY RETURNED TO APPL PGM:'   06260006
062700                                   TO DP013-MESSAGE-TEXT(1)       06270006
062800             MOVE DP020-NEXT-APPL-ACTIVITY                        06280006
062900                                   TO DP013-MESSAGE-TEXT(2)       06290006
063000             PERFORM DP013-0000-PROCESS-ABEND                     06300006
063100     END-EVALUATE.                                                06310006
063200                                                                  06320006
063300/                                                                 06330006
063400*----------------------------------------------------------------*06340006
063500*  DETERMINE THE KEY OF THE OBJECT TO BE UPDATED BASED ON THE    *06350006
063600*  INTER-APPLICATION FORMAT CODE.                                *06360006
063700*----------------------------------------------------------------*06370006
063800 1100-FIND-OBJECT-KEYS.                                           06380006
063900                                                                  06390006
064000     INITIALIZE ASC-SPECIFIC-COMMAREA.                            06400006
064100                                                                  06410006
064200     MOVE DP020-INT-APPL-FORMAT-IND                               06420006
064300                                 TO ASC-INT-APPL-FORMAT-IND.      06430006
064400                                                                  06440006
064500     EVALUATE DP020-INT-APPL-FORMAT-IND                           06450006
064600                                                                  06460006
064700         WHEN PC-INTER-APPL-CRIT-ADD                              06470006
064800         WHEN PC-INTER-APPL-MAINT-ADD                             06480006
064900             IF  TR005-DEST-OPER-UNT-ID = ZEROES                  06490006
065000                 MOVE PC-TSYMSG-00007  TO DP020-MSG-NUMBER        06500006
065100                 SET DP020-MSG-FATAL                              06510006
065200                     DP020-NEXT-ACT-APPL-ERROR                    06520006
065300                     PS-ERROR          TO TRUE                    06530006
065400             ELSE                                                 06540006
065500             IF  TR005-DELIVERY-SCAC-CDE = SPACES                 06550006
065600                 MOVE PC-TSYMSG-00644  TO DP020-MSG-NUMBER        06560006
065700                 SET DP020-MSG-FATAL                              06570006
065800                     DP020-NEXT-ACT-APPL-ERROR                    06580006
065900                     PS-ERROR          TO TRUE                    06590006
066000             ELSE                                                 06600006
066100                 MOVE TR005-DEST-OPER-UNT-ID                      06610006
066200                                     TO ASC-KEY-DEST-OPER-UNT-ID  06620006
066300                 MOVE TR005-DEST-FCLTY-ID                         06630006
066400                                     TO ASC-KEY-DEST-FCLTY-ID     06640006
066500                 MOVE TR005-DELIVERY-SCAC-CDE                     06650006
066600                                     TO ASC-KEY-OWNER-SCAC-ID     06660006
066700                                        ASC-KEY-PRO-SCAC-ID       06670006
066800                 MOVE TR005-TRLR-NBR TO ASC-KEY-VEH-NBR           06680006
066900                 MOVE TR005-MANIFEST-NBR                          06690006
067000                                     TO ASC-KEY-MANIFEST-NBR      06700006
067100                 MOVE TR005-TRIP-ID                               06710006
067200                                 TO ASC-KEY-TRIP-ID               06720006
067300                 SET ASC-ADD-PENDING TO TRUE                      06730006
067400             END-IF                                               06740006
067500             END-IF                                               06750006
067600                                                                  06760006
067700         WHEN PC-INTER-APPL-LIST-ADD                              06770006
067800             IF TR007-TRIP-ID = ZERO                              06780006
067900                MOVE PC-TSYMSG-00803                              06790006
068000                                 TO DP020-MSG-NUMBER              06800006
068100                 SET DP020-MSG-WARNING                            06810006
068200                     DP020-NEXT-ACT-APPL-ERROR                    06820006
068300                     PS-ERROR    TO TRUE                          06830006
068400             ELSE                                                 06840006
068500               IF  TR007-NUMBER-OF-SELECTED-ITEMS = ZERO          06850006
068600                   MOVE TR007-OPER-UNT-ID                         06860006
068700                                   TO ASC-KEY-DEST-OPER-UNT-ID    06870006
068800                   MOVE TR007-FCLTY-ID                            06880006
068900                                   TO ASC-KEY-DEST-FCLTY-ID       06890006
069000                   MOVE TR007-OWNER-SCAC-ID                       06900006
069100                                   TO ASC-KEY-OWNER-SCAC-ID       06910006
069200                                      ASC-KEY-PRO-SCAC-ID         06920006
069300                   MOVE TR007-VEH-NBR                             06930006
069400                                   TO ASC-KEY-VEH-NBR             06940006
069500                   MOVE TR007-MANIFEST-NBR                        06950006
069600                                   TO ASC-KEY-MANIFEST-NBR        06960006
069700                   MOVE TR007-TRIP-ID                             06970006
069800                                   TO ASC-KEY-TRIP-ID             06980006
069900                                            DK-TRIP-ID            06990006
070000                   PERFORM 1150-CHECK-SPLT-XMIT-IND               07000006
070100                   IF PS-NO-ERROR                                 07010006
070200                       SET ASC-ADD-PENDING                        07020006
070300                           ASC-ADD-SHIPMENT                       07030006
070400                                   TO TRUE                        07040006
070500                   END-IF                                         07050006
070600               ELSE                                               07060006
070700                   MOVE PC-TSYMSG-00146                           07070006
070800                                   TO DP020-MSG-NUMBER            07080006
070900                   SET DP020-MSG-WARNING                          07090006
071000                       DP020-NEXT-ACT-APPL-ERROR                  07100006
071100                       PS-ERROR    TO TRUE                        07110006
071200               END-IF                                             07120006
071300             END-IF                                               07130006
071400                                                                  07140006
071500         WHEN PC-INTER-APPL-UPDATE                                07150006
071600             IF  TR007-NUMBER-OF-SELECTED-ITEMS = ZERO            07160006
071700                 MOVE PC-TSYMSG-00057                             07170006
071800                                 TO DP020-MSG-NUMBER              07180006
071900                 SET DP020-MSG-WARNING                            07190006
072000                     DP020-NEXT-ACT-APPL-ERROR                    07200006
072100                     PS-ERROR                                     07210006
072200                                 TO TRUE                          07220006
072300             ELSE                                                 07230006
072400                 SET ASC-UPDATE-PENDING                           07240006
072500                                 TO TRUE                          07250006
072600                 SET ASC-USE-SELECTION-QUEUE                      07260006
072700                                 TO TRUE                          07270006
072800                 MOVE TR007-NUMBER-OF-SELECTED-ITEMS              07280006
072900                                 TO ASC-NUMBER-OF-SELECTED-ITEMS  07290006
073000                 MOVE TR007-NUMBER-OF-TS-ITEMS                    07300006
073100                                 TO ASC-NUMBER-OF-TS-ITEMS        07310006
073200                 MOVE TR007-SEL-QUEUE-NAME                        07320006
073300                                 TO ASC-SEL-QUEUE-NAME            07330006
073400                 PERFORM 1120-PREPARE-LIST-ENTRY                  07340006
073500             END-IF                                               07350006
073600                                                                  07360006
073700         WHEN PC-INTER-APPL-SUSPND-UPDT                           07370006
073800             IF  TR007-NUMBER-OF-SELECTED-ITEMS = ZERO            07380006
073900                 MOVE PC-TSYMSG-00057                             07390006
074000                                 TO DP020-MSG-NUMBER              07400006
074100                 SET DP020-MSG-WARNING                            07410006
074200                     DP020-NEXT-ACT-APPL-ERROR                    07420006
074300                     PS-ERROR                                     07430006
074400                                 TO TRUE                          07440006
074500                                                                  07450006
074600             ELSE                                                 07460006
074700                 SET ASC-UPDATE-PENDING                           07470006
074800                                 TO TRUE                          07480006
074900                 SET ASC-USE-SELECTION-QUEUE                      07490006
075000                                 TO TRUE                          07500006
075100                 MOVE TR007-NUMBER-OF-SELECTED-ITEMS              07510006
075200                                 TO ASC-NUMBER-OF-SELECTED-ITEMS  07520006
075300                 MOVE TR007-NUMBER-OF-TS-ITEMS                    07530006
075400                                 TO ASC-NUMBER-OF-TS-ITEMS        07540006
075500                 MOVE TR007-SEL-QUEUE-NAME                        07550006
075600                                 TO ASC-SEL-QUEUE-NAME            07560006
075700                 PERFORM 1120-PREPARE-LIST-ENTRY                  07570006
075800                 MOVE ASC-KEY-TRIP-ID  TO  DK-TRIP-ID             07580006
075900                 MOVE ASC-KEY-SHIPT-ID TO  DK-SHIPT-ID            07590006
076000                 PERFORM 3040-CHECK-TRIP-STATUS                   07600006
076100                 PERFORM 4100-SELECT-TSHIPMT                      07610006
076200                    IF ASC-TRIP-STATUS-CDE  = 'ET' AND            07620006
076300                       ASC-KEY-PRO-NBR   NOT = SPACES             07630006
076400                       MOVE PC-TSYMSG-03373                       07640006
076500                                  TO DP020-MSG-NUMBER             07650006
076600                       SET DP020-MSG-WARNING                      07660006
076700                           DP020-NEXT-ACT-APPL-ERROR              07670006
076800                           PS-ERROR                               07680006
076900                                  TO TRUE                         07690006
077000                    END-IF                                        07700006
077100                    IF ASC-TRIP-STATUS-CDE  = 'ET' AND            07710006
077200                       ASC-KEY-PRO-NBR   = SPACES                 07720006
077300                          SET ASC-SUSPND-UPDATE-YES               07730006
077400                                      TO TRUE                     07740006
077500                    END-IF                                        07750006
077600           END-IF                                                 07760006
077700                                                                  07770006
077800         WHEN PC-INTER-APPL-DELETE                                07780006
077900             IF  TR007-NUMBER-OF-SELECTED-ITEMS = ZERO            07790006
078000                 MOVE PC-TSYMSG-00057                             07800006
078100                                 TO DP020-MSG-NUMBER              07810006
078200                 SET DP020-MSG-WARNING                            07820006
078300                     DP020-NEXT-ACT-APPL-ERROR                    07830006
078400                                 TO TRUE                          07840006
078500             ELSE                                                 07850006
078600                 SET ASC-DELETE-PENDING                           07860006
078700                                 TO TRUE                          07870006
078800                 SET ASC-USE-SELECTION-QUEUE                      07880006
078900                                 TO TRUE                          07890006
079000                 MOVE TR007-NUMBER-OF-SELECTED-ITEMS              07900006
079100                                 TO ASC-NUMBER-OF-SELECTED-ITEMS  07910006
079200                 MOVE TR007-NUMBER-OF-TS-ITEMS                    07920006
079300                                 TO ASC-NUMBER-OF-TS-ITEMS        07930006
079400                 MOVE TR007-SEL-QUEUE-NAME                        07940006
079500                                 TO ASC-SEL-QUEUE-NAME            07950006
079600                 PERFORM 1120-PREPARE-LIST-ENTRY                  07960006
079700             END-IF                                               07970006
079800                                                                  07980006
079900         WHEN OTHER                                               07990006
080000             MOVE PC-TSYMSG-00148 TO DP020-MSG-NUMBER             08000006
080100             SET DP020-MSG-FATAL                                  08010006
080200                 DP020-NEXT-ACT-APPL-ERROR                        08020006
080300                 PS-ERROR        TO TRUE                          08030006
080400     END-EVALUATE.                                                08040006
080500                                                                  08050006
080600/                                                                 08060006
080700*----------------------------------------------------------------*08070006
080800* ENTRY IS FROM A LIST.  GET THE FORMAT NUMBER FROM THE TEMP     *08080006
080900* STORAGE QUEUE PASSED FROM THE LIST.                            *08090006
081000*----------------------------------------------------------------*08100006
081100 1120-PREPARE-LIST-ENTRY.                                         08110006
081200                                                                  08120006
081300     MOVE TR006-MAX-ITEMS          TO ASC-SEL-SUB.                08130006
081400     MOVE ZERO                     TO ASC-SEL-ITEM.               08140006
081500     PERFORM 2110-GET-NEXT-RECORD.                                08150006
081600                                                                  08160006
081700/                                                                 08170006
081800 1150-CHECK-SPLT-XMIT-IND.                                        08180006
081900     EXEC SQL                                                     08190006
082000         SELECT A.SPLT_XMIT_IND                                   08200006
082100         INTO :VHTRIP-SPLT-XMIT-IND                               08210006
082200         FROM   TVHTRIP A                                         08220006
082300          WHERE                                                   08230006
082400                 A.TRIP_ID                 = :DK-TRIP-ID          08240006
082500     END-EXEC                                                     08250006
082600                                                                  08260006
082700         EVALUATE TRUE                                            08270006
082800             WHEN SQLCODE = ZERO                                  08280006
082900                 IF VHTRIP-SPLT-XMIT-IND = SPACE                  08290006
083000                     CONTINUE                                     08300006
083100                 ELSE                                             08310006
083200                     MOVE PC-TSYMSG-01319 TO DP020-MSG-NUMBER     08320006
083300                     SET DP020-MSG-FATAL                          08330006
083400                         DP020-NEXT-ACT-APPL-ERROR                08340006
083500                         PS-ERROR        TO TRUE                  08350006
083600                 END-IF                                           08360006
083700             WHEN SQLCODE = +100                                  08370006
083800                 MOVE PC-TSYMSG-00743 TO DP020-MSG-NUMBER         08380006
083900                 SET DP020-MSG-FATAL                              08390006
084000                     DP020-NEXT-ACT-APPL-ERROR                    08400006
084100                     PS-ERROR        TO TRUE                      08410006
084200             WHEN SQLCODE = -904                                  08420006
084300             WHEN SQLCODE = -913                                  08430006
084400                 CONTINUE                                         08440006
084500                                                                  08450006
084600             WHEN SQLWARN0 NOT = SPACES                           08460006
084700             WHEN SQLCODE < +0                                    08470006
084800             WHEN SQLCODE > +0                                    08480006
084900                 MOVE '1150-CHECK-SPLT-XMIT-IND'                  08490006
085000                                   TO DP013-PARAGRAPH             08500006
085100                 MOVE 'CHECKING XMIT-IND'                         08510006
085200                                   TO DP013-MESSAGE-TEXT(1)       08520006
085300                 MOVE SQLCA        TO DP013-SQLCA                 08530006
085400                 MOVE 'TVHTRIP'    TO DP013-DB2-TABLE-NAME (1)    08540006
085500                 SET DP013-DB2-ABEND                              08550006
085600                     DP013-XCTL-DISPLAY-RESTART TO TRUE           08560006
085700                 PERFORM DP013-0000-PROCESS-ABEND                 08570006
085800     END-EVALUATE.                                                08580006
085900/                                                                 08590006
086000*----------------------------------------------------------------*08600006
086100* DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA   *08610006
086200* ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *08620006
086300* USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *08630006
086400* OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *08640006
086500* FUNCTION KEYS CAN GET THIS FAR.                                *08650006
086600*----------------------------------------------------------------*08660006
086700                                                                  08670006
086800 2000-PROCESS-PANEL.                                              08680006
086900                                                                  08690006
087000     EVALUATE TRUE                                                08700006
087100         WHEN DP020-FK-CONFIRM (DP020-SRC-AID)                    08710006
087200             IF ASC-LOCAL-01-NEED-CONFIRM                         08720006
087300             OR ASC-LOCAL-02-NEED-CONFIRM                         08730006
087400                 PERFORM 2100-CHECK-FUNCTION-KEY                  08740006
087500             ELSE                                                 08750006
087600                 IF  ASC-DELETE-SUCCESSFUL                        08760006
087700                     MOVE PC-TSYMSG-00116                         08770006
087800                                       TO DP020-MSG-NUMBER        08780006
087900                     SET DP020-MSG-FATAL                          08790006
088000                         PS-ERROR      TO TRUE                    08800006
088100                     PERFORM 3200-RESET-ATTRIBUTES                08810006
088200                 ELSE                                             08820006
088300                     SET DP030-CONTINUE-GO                        08830006
088400                                       TO TRUE                    08840006
088500                     PERFORM 7000-DELETE-SHIPMENT                 08850006
088600                 END-IF                                           08860006
088700            END-IF                                                08870006
088800                                                                  08880006
088900         WHEN DP020-SRC-AID = DP016-CLEAR                         08890006
089000             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   08900006
089100             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 08910006
089200                                                                  08920006
089300         WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    08930006
089400             SET DP030-DONT-ERASE                                 08940006
089500                 DP030-SEND-DATAONLY (PC-APPL-MAP)                08950006
089600                               TO TRUE                            08960006
089700             PERFORM 4000-BUILD-INITIAL-PANEL                     08970006
089800             PERFORM 3200-RESET-ATTRIBUTES                        08980006
089900             PERFORM 3500-SAVE-SCREEN-FIELDS                      08990006
090000                                                                  09000006
090100         WHEN DP020-FK-NEXT-SELECTION (DP020-SRC-AID)             09010006
090200             IF  ASC-USE-SELECTION-QUEUE                          09020006
090300                 PERFORM 2110-GET-NEXT-RECORD                     09030006
090400                 PERFORM 4000-BUILD-INITIAL-PANEL                 09040006
090500                 PERFORM 3200-RESET-ATTRIBUTES                    09050006
090600             ELSE                                                 09060006
090700*                --- BOTTOM OF LIST ---                           09070006
090800                 MOVE PC-TSYMSG-00070                             09080006
090900                                   TO DP020-MSG-NUMBER            09090006
091000                 SET DP020-MSG-INFORMATIONAL                      09100006
091100                                   TO TRUE                        09110006
091200             END-IF                                               09120006
091300                                                                  09130006
091400         WHEN DP020-FK-PREV-SELECTION (DP020-SRC-AID)             09140006
091500             IF  ASC-USE-SELECTION-QUEUE                          09150006
091600                 PERFORM 2120-GET-PREV-RECORD                     09160006
091700                 PERFORM 4000-BUILD-INITIAL-PANEL                 09170006
091800                 PERFORM 3200-RESET-ATTRIBUTES                    09180006
091900             ELSE                                                 09190006
092000*                --- TOP OF LIST ---                              09200006
092100                 MOVE PC-TSYMSG-00069                             09210006
092200                                   TO DP020-MSG-NUMBER            09220006
092300                 SET DP020-MSG-INFORMATIONAL                      09230006
092400                                   TO TRUE                        09240006
092500             END-IF                                               09250006
092600                                                                  09260006
092700         WHEN OTHER                                               09270006
092800             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 09280006
092900             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   09290006
093000             IF  PS-NO-ERROR                                      09300006
093100                 SET DP030-CONTINUE-GO                            09310006
093200                                   TO TRUE                        09320006
093300                 PERFORM 2100-CHECK-FUNCTION-KEY                  09330006
093400             ELSE                                                 09340006
093500                 SET DP030-OVERRIDE-GO                            09350006
093600                                   TO TRUE                        09360006
093700             END-IF                                               09370006
093800     END-EVALUATE.                                                09380006
093900                                                                  09390006
094000/                                                                 09400006
094100*----------------------------------------------------------------*09410006
094200* ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED FIRST.*09420006
094300* NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED FROM THE  *09430006
094400* CICS ARCHITECTURE API.                                         *09440006
094500*----------------------------------------------------------------*09450006
094600 2100-CHECK-FUNCTION-KEY.                                         09460006
094700                                                                  09470006
094800     EVALUATE TRUE                                                09480006
094900         WHEN DP020-SRC-AID = DP016-ENTER                         09490006
095000             CONTINUE                                             09500006
095100                                                                  09510006
095200         WHEN DP020-FK-CONFIRM (DP020-SRC-AID)                    09520006
095300             IF ASC-LOCAL-01-NEED-CONFIRM                         09530006
095400                 SET DP030-CONTINUE-GO TO TRUE                    09540006
095500                 PERFORM 5000-ADD-SHIPMENT                        09550006
095600                 MOVE DP015-UNP-ALP-NOR-OFF                       09560006
095700                                       TO APROA                   09570006
095800                 MOVE DP015-GREEN      TO APROC                   09580006
095900                 MOVE DP015-UNDERLINE  TO APROH                   09590006
096000                 MOVE -1               TO APROL                   09600006
096100                 MOVE PC-TSYMSG-00034   TO DP020-MSG-NUMBER       09610006
096200                 SET DP020-MSG-INFORMATIONAL TO TRUE              09620006
096300             END-IF                                               09630006
096400             IF ASC-LOCAL-02-NEED-CONFIRM                         09640006
096500                 SET DP030-CONTINUE-GO TO TRUE                    09650006
096600                 PERFORM 6000-UPDATE-SHIPMENT                     09660006
096700                 MOVE DP015-UNP-ALP-NOR-OFF                       09670006
096800                                       TO APROA                   09680006
096900                 MOVE DP015-GREEN      TO APROC                   09690006
097000                 MOVE DP015-UNDERLINE  TO APROH                   09700006
097100                 MOVE -1               TO APROL                   09710006
097200                 MOVE PC-TSYMSG-00059   TO DP020-MSG-NUMBER       09720006
097300                 SET DP020-MSG-INFORMATIONAL TO TRUE              09730006
097400             END-IF                                               09740006
097500                                                                  09750006
097600         WHEN DP020-FK-LOCAL-GOTO (DP020-SRC-AID)                 09760006
097700             MOVE ASC-KEY-DEST-OPER-UNT-ID                        09770006
097800                                 TO TR005-OPER-UNT-ID             09780006
097900             MOVE ASC-KEY-DEST-FCLTY-ID                           09790006
098000                                 TO TR005-FCLTY-ID                09800006
098100             MOVE ASC-KEY-OWNER-SCAC-ID                           09810006
098200                                 TO TR005-DELIVERY-SCAC-CDE       09820006
098300             MOVE ASC-KEY-VEH-NBR                                 09830006
098400                                 TO TR005-TRLR-NBR                09840006
098500             MOVE ASC-KEY-MANIFEST-NBR                            09850006
098600                                 TO TR005-MANIFEST-NBR            09860006
098700             MOVE ASC-KEY-PRO-SCAC-ID                             09870006
098800                                 TO TR005-PRO-NBR-SCAC-CDE        09880006
098900             MOVE ASC-KEY-PRO-NBR                                 09890006
099000                                 TO TR005-PRO-NBR                 09900006
099100             MOVE ASC-KEY-TRIP-ID                                 09910006
099200                                 TO TR005-TRIP-ID                 09920006
099300             MOVE ASC-KEY-SHIPT-ID                                09930006
099400                                 TO TR005-SHIPT-ID                09940006
099500                                                                  09950006
099600         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              09960006
099700             SET ASC-LOCAL-01-NO-NEED-CONFIRM TO TRUE             09970006
099800             IF (ASC-KEY-VEH-TYP-CDE = 'VS' OR 'AV')              09980006
099900                MOVE ASC-KEY-PRO-NBR TO DK-CONTNR-ID              09990006
100000                PERFORM 5001-CHECK-TIMCNTK                        10000006
100100                IF SQLCODE = +100                                 10010006
100200                    SET DP030-OVERRIDE-GO TO TRUE                 10020006
100300                    SET ASC-LOCAL-01-NEED-CONFIRM TO TRUE         10030006
100400                    MOVE PC-TSYMSG-01802   TO DP020-MSG-NUMBER    10040006
100500                    SET DP020-MSG-INFORMATIONAL                   10050006
100600                        PS-ERROR          TO TRUE                 10060006
100700                    MOVE DP015-UNP-ALP-BRT-OFF                    10070006
100800                                          TO APROA                10080006
100900                    MOVE DP015-RED        TO APROC                10090006
101000                    MOVE DP015-REVERSE    TO APROH                10100006
101100                    SET DP030-SET-CURSOR-APPL-1                   10110006
101200                                          TO TRUE                 10120006
101300                 ELSE                                             10130006
101400                     SET DP030-CONTINUE-GO TO TRUE                10140006
101500                     PERFORM 5000-ADD-SHIPMENT                    10150006
101600                     MOVE DP015-UNP-ALP-NOR-OFF                   10160006
101700                                           TO APROA               10170006
101800                     MOVE DP015-GREEN      TO APROC               10180006
101900                     MOVE DP015-UNDERLINE  TO APROH               10190006
102000                     MOVE -1               TO APROL               10200006
102100                     MOVE PC-TSYMSG-00034   TO DP020-MSG-NUMBER   10210006
102200                     SET DP020-MSG-INFORMATIONAL TO TRUE          10220006
102300                 END-IF                                           10230006
102400             ELSE                                                 10240006
102500                 SET DP030-CONTINUE-GO TO TRUE                    10250006
102600                 PERFORM 5000-ADD-SHIPMENT                        10260006
102700                 MOVE DP015-UNP-ALP-NOR-OFF                       10270006
102800                                       TO APROA                   10280006
102900                 MOVE DP015-GREEN      TO APROC                   10290006
103000                 MOVE DP015-UNDERLINE  TO APROH                   10300006
103100                 MOVE -1               TO APROL                   10310006
103200                 MOVE PC-TSYMSG-00034   TO DP020-MSG-NUMBER       10320006
103300                 SET DP020-MSG-INFORMATIONAL TO TRUE              10330006
103400             END-IF                                               10340006
103500                                                                  10350006
103600         WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              10360006
103700            PERFORM 3600-CHECK-IF-FIELDS-CHANGED                  10370006
103800            IF  ASC-FIELDS-CHANGED                                10380006
103900                 SET ASC-LOCAL-02-NO-NEED-CONFIRM TO TRUE         10390006
104000                 MOVE ASC-KEY-PRO-NBR TO DK-CONTNR-ID             10400006
104100              IF (ASC-KEY-VEH-TYP-CDE = 'VS' OR 'AV')             10410006
104200                 PERFORM 5001-CHECK-TIMCNTK                       10420006
104300                 IF SQLCODE = +100                                10430006
104400                     SET DP030-OVERRIDE-GO TO TRUE                10440006
104500                     SET ASC-LOCAL-02-NEED-CONFIRM TO TRUE        10450006
104600                     MOVE PC-TSYMSG-01802      TO DP020-MSG-NUMBER10460006
104700                     SET DP020-MSG-INFORMATIONAL                  10470006
104800                         PS-ERROR          TO TRUE                10480006
104900                     MOVE DP015-UNP-ALP-BRT-OFF                   10490006
105000                                           TO APROA               10500006
105100                     MOVE DP015-RED        TO APROC               10510006
105200                     MOVE DP015-REVERSE    TO APROH               10520006
105300                     SET DP030-SET-CURSOR-APPL-1                  10530006
105400                                           TO TRUE                10540006
105500                 ELSE                                             10550006
105600                     SET DP030-CONTINUE-GO TO TRUE                10560006
105700                     PERFORM 6000-UPDATE-SHIPMENT                 10570006
105800                     MOVE DP015-UNP-ALP-NOR-OFF                   10580006
105900                                           TO APROA               10590006
106000                     MOVE DP015-GREEN      TO APROC               10600006
106100                     MOVE DP015-UNDERLINE  TO APROH               10610006
106200                     MOVE -1               TO APROL               10620006
106300                     MOVE PC-TSYMSG-00059   TO DP020-MSG-NUMBER   10630006
106400                     SET DP020-MSG-INFORMATIONAL TO TRUE          10640006
106500                 END-IF                                           10650006
106600              ELSE                                                10660006
106700                  SET DP030-CONTINUE-GO TO TRUE                   10670006
106800                  PERFORM 6000-UPDATE-SHIPMENT                    10680006
106900                  MOVE DP015-UNP-ALP-NOR-OFF                      10690006
107000                                        TO APROA                  10700006
107100                  MOVE DP015-GREEN      TO APROC                  10710006
107200                  MOVE DP015-UNDERLINE  TO APROH                  10720006
107300                  MOVE -1               TO APROL                  10730006
107400                  MOVE PC-TSYMSG-00059   TO DP020-MSG-NUMBER      10740006
107500                  SET DP020-MSG-INFORMATIONAL TO TRUE             10750006
107600              END-IF                                              10760006
107700           ELSE                                                   10770006
107800               MOVE PC-TSYMSG-00046                               10780006
107900                                 TO DP020-MSG-NUMBER              10790006
108000               SET DP020-MSG-INFORMATIONAL                        10800006
108100                                 TO TRUE                          10810006
108200           END-IF                                                 10820006
108300                                                                  10830006
108400         WHEN OTHER                                               10840006
108500             SET DP013-NO-ROLLBACK                                10850006
108600                 DP013-XCTL-DISPLAY-RESTART                       10860006
108700                 DP013-CICS-ABEND  TO TRUE                        10870006
108800             MOVE '2100-CHECK-FUNCTION-KEY'                       10880006
108900                                   TO DP013-PARAGRAPH             10890006
109000             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      10900006
109100                                   TO DP013-MESSAGE-TEXT (1)      10910006
109200             PERFORM DP013-0000-PROCESS-ABEND                     10920006
109300     END-EVALUATE.                                                10930006
109400                                                                  10940006
109500/                                                                 10950006
109600 2110-GET-NEXT-RECORD.                                            10960006
109700                                                                  10970006
109800     ADD +1                        TO ASC-SEL-SUB.                10980006
109900     IF  ASC-SEL-SUB > TR006-MAX-ITEMS                            10990006
110000         ADD +1                    TO ASC-SEL-ITEM                11000006
110100         MOVE +1                   TO ASC-SEL-SUB                 11010006
110200     END-IF.                                                      11020006
110300                                                                  11030006
110400     IF  ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                11040006
110500         IF  ASC-DELETE-PENDING                                   11050006
110600             MOVE PC-TSYMSG-00004  TO DP020-MSG-NUMBER            11060006
110700             SET DP020-MSG-INFORMATIONAL                          11070006
110800                                   TO TRUE                        11080006
110900             IF  ASC-DELETE-SUCCESSFUL                            11090006
111000                 MOVE SPACES       TO ASC-DELETE-SUCCESSFUL-SW    11100006
111100             END-IF                                               11110006
111200         END-IF                                                   11120006
111300         PERFORM 9100-READ-SEL-QUEUE                              11130006
111400         IF  TR006-ITEM (ASC-SEL-SUB) > ZERO                      11140006
111500             MOVE TR006-OPER-UNT-ID (ASC-SEL-SUB)                 11150006
111600                                   TO ASC-KEY-DEST-OPER-UNT-ID    11160006
111700             MOVE TR006-FCLTY-ID (ASC-SEL-SUB)                    11170006
111800                                   TO ASC-KEY-DEST-FCLTY-ID       11180006
111900             MOVE TR006-OWNER-SCAC-ID (ASC-SEL-SUB)               11190006
112000                                   TO ASC-KEY-OWNER-SCAC-ID       11200006
112100             MOVE TR006-VEH-NBR (ASC-SEL-SUB)                     11210006
112200                                   TO ASC-KEY-VEH-NBR             11220006
112300             MOVE TR006-MANIFEST-NBR (ASC-SEL-SUB)                11230006
112400                                   TO ASC-KEY-MANIFEST-NBR        11240006
112500             MOVE TR006-PRO-SCAC-ID (ASC-SEL-SUB)                 11250006
112600                                   TO ASC-KEY-PRO-SCAC-ID         11260006
112700             MOVE TR006-PRO-NBR (ASC-SEL-SUB)                     11270006
112800                                   TO ASC-KEY-PRO-NBR             11280006
112900             MOVE TR006-TRIP-ID (ASC-SEL-SUB)                     11290006
113000                                   TO ASC-KEY-TRIP-ID             11300006
113100             MOVE TR006-SHIPT-ID (ASC-SEL-SUB)                    11310006
113200                                   TO ASC-KEY-SHIPT-ID            11320006
113300             SET TR006-INQ (ASC-SEL-SUB)                          11330006
113400                                   TO TRUE                        11340006
113500             PERFORM 9200-REWRITE-LIST-QUEUE                      11350006
113600         ELSE                                                     11360006
113700             SUBTRACT +1 FROM ASC-SEL-SUB                         11370006
113800*            --- BOTTOM OF LIST ---                               11380006
113900             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            11390006
114000             SET DP020-MSG-INFORMATIONAL                          11400006
114100                                   TO TRUE                        11410006
114200         END-IF                                                   11420006
114300     ELSE                                                         11430006
114400         SUBTRACT +1 FROM ASC-SEL-ITEM                            11440006
114500         MOVE TR006-MAX-ITEMS      TO ASC-SEL-SUB                 11450006
114600         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            11460006
114700         SET DP020-MSG-INFORMATIONAL                              11470006
114800                                   TO TRUE                        11480006
114900     END-IF.                                                      11490006
115000                                                                  11500006
115100/                                                                 11510006
115200 2120-GET-PREV-RECORD.                                            11520006
115300                                                                  11530006
115400     SUBTRACT +1 FROM ASC-SEL-SUB.                                11540006
115500     IF  ASC-SEL-SUB < +1                                         11550006
115600         SUBTRACT +1 FROM ASC-SEL-ITEM                            11560006
115700         MOVE TR006-MAX-ITEMS      TO ASC-SEL-SUB                 11570006
115800     END-IF.                                                      11580006
115900                                                                  11590006
116000     IF  ASC-SEL-ITEM > ZERO                                      11600006
116100         IF  ASC-DELETE-PENDING                                   11610006
116200             MOVE PC-TSYMSG-00004  TO DP020-MSG-NUMBER            11620006
116300             SET DP020-MSG-INFORMATIONAL                          11630006
116400                                   TO TRUE                        11640006
116500             IF  ASC-DELETE-SUCCESSFUL                            11650006
116600                 MOVE SPACES       TO ASC-DELETE-SUCCESSFUL-SW    11660006
116700             END-IF                                               11670006
116800         END-IF                                                   11680006
116900         PERFORM 9100-READ-SEL-QUEUE                              11690006
117000         MOVE TR006-OPER-UNT-ID (ASC-SEL-SUB)                     11700006
117100                                   TO ASC-KEY-DEST-OPER-UNT-ID    11710006
117200         MOVE TR006-FCLTY-ID (ASC-SEL-SUB)                        11720006
117300                                   TO ASC-KEY-DEST-FCLTY-ID       11730006
117400         MOVE TR006-OWNER-SCAC-ID (ASC-SEL-SUB)                   11740006
117500                                   TO ASC-KEY-OWNER-SCAC-ID       11750006
117600         MOVE TR006-VEH-NBR (ASC-SEL-SUB)                         11760006
117700                                   TO ASC-KEY-VEH-NBR             11770006
117800         MOVE TR006-MANIFEST-NBR (ASC-SEL-SUB)                    11780006
117900                                   TO ASC-KEY-MANIFEST-NBR        11790006
118000         MOVE TR006-PRO-SCAC-ID (ASC-SEL-SUB)                     11800006
118100                                   TO ASC-KEY-PRO-SCAC-ID         11810006
118200         MOVE TR006-PRO-NBR (ASC-SEL-SUB)                         11820006
118300                                   TO ASC-KEY-PRO-NBR             11830006
118400         MOVE TR006-TRIP-ID (ASC-SEL-SUB)                         11840006
118500                                   TO ASC-KEY-TRIP-ID             11850006
118600         MOVE TR006-SHIPT-ID (ASC-SEL-SUB)                        11860006
118700                                   TO ASC-KEY-SHIPT-ID            11870006
118800     ELSE                                                         11880006
118900         MOVE +1                   TO ASC-SEL-ITEM                11890006
119000                                      ASC-SEL-SUB                 11900006
119100*        --- TOP OF LIST ---                                      11910006
119200         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            11920006
119300         SET DP020-MSG-INFORMATIONAL                              11930006
119400                                   TO TRUE                        11940006
119500     END-IF.                                                      11950006
119600                                                                  11960006
119700/                                                                 11970006
119800*----------------------------------------------------------------*11980006
119900*  MOVE ALL OF THE FIELDS THAT WERE ENTERED / CHANGED ON THE     *11990006
120000*  SCREEN INTO THE COMMAREA.  ALL EDITTING IS DONE IN THE COMM.  *12000006
120100*----------------------------------------------------------------*12010006
120200 2200-MOVE-SCREEN-TO-COMMAREA.                                    12020006
120300                                                                  12030006
120400     IF  ADOPERL > ZERO                                           12040006
120500         MOVE ADOPERI            TO ASC-KEY-DEST-OPER-UNT-ID      12050006
120600     ELSE                                                         12060006
120700         IF  ADOPERF = DP015-ERASE-EOF                            12070006
120800             MOVE SPACES         TO ASC-KEY-DEST-OPER-UNT-ID      12080006
120900         END-IF                                                   12090006
121000     END-IF.                                                      12100006
121100                                                                  12110006
121200     IF  ADFIDL > ZERO                                            12120006
121300         MOVE ADFIDI             TO ASC-KEY-DEST-FCLTY-ID         12130006
121400     ELSE                                                         12140006
121500         IF  ADFIDF = DP015-ERASE-EOF                             12150006
121600             MOVE SPACES         TO ASC-KEY-DEST-FCLTY-ID         12160006
121700         END-IF                                                   12170006
121800     END-IF.                                                      12180006
121900                                                                  12190006
122000     IF  AMANL > ZERO                                             12200006
122100         MOVE AMANI              TO ASC-KEY-MANIFEST-NBR          12210006
122200     ELSE                                                         12220006
122300         IF  AMANF = DP015-ERASE-EOF                              12230006
122400             MOVE SPACES         TO ASC-KEY-MANIFEST-NBR          12240006
122500         END-IF                                                   12250006
122600     END-IF.                                                      12260006
122700                                                                  12270006
122800     IF  APSCACL > ZERO                                           12280006
122900         MOVE APSCACI            TO ASC-KEY-PRO-SCAC-ID           12290006
123000     ELSE                                                         12300006
123100         IF  APSCACF = DP015-ERASE-EOF                            12310006
123200             MOVE SPACES         TO ASC-KEY-PRO-SCAC-ID           12320006
123300                                    ASC-PRO-SCAC-ID-DESC          12330006
123400                                    APSCACDO                      12340006
123500         END-IF                                                   12350006
123600     END-IF.                                                      12360006
123700                                                                  12370006
123800     IF  APROL > ZERO                                             12380006
123900         MOVE APROI              TO ASC-KEY-PRO-NBR               12390006
124000     ELSE                                                         12400006
124100         IF  APROF = DP015-ERASE-EOF                              12410006
124200             MOVE SPACES         TO ASC-KEY-PRO-NBR               12420006
124300         END-IF                                                   12430006
124400     END-IF.                                                      12440006
124500                                                                  12450006
124600     IF  ABOLL > ZERO                                             12460006
124700         MOVE ABOLI              TO ASC-KEY-BOL-NBR               12470006
124800     ELSE                                                         12480006
124900         IF  ABOLF = DP015-ERASE-EOF                              12490006
125000             MOVE SPACES         TO ASC-KEY-BOL-NBR               12500006
125100         END-IF                                                   12510006
125200     END-IF.                                                      12520006
125300                                                                  12530006
125400*    CLT 12-08-2011 START WR40574                                 12540006
125500     IF  ACANL > ZERO                                             12550006
125600         MOVE ACANI              TO ASC-CAN                       12560006
125700     ELSE                                                         12570006
125800         IF  ACANF = DP015-ERASE-EOF                              12580006
125900             MOVE SPACES         TO ASC-CAN                       12590006
126000         END-IF                                                   12600006
126100     END-IF.                                                      12610006
126200*    CLT 12-08-2011 END   WR40574                                 12620006
126300                                                                  12630006
126400     IF  ASTATL > ZERO                                            12640006
126500         MOVE ASTATI             TO ASC-SHIPT-STATUS-CDE          12650006
126600     ELSE                                                         12660006
126700         IF  ASTATF = DP015-ERASE-EOF                             12670006
126800             MOVE SPACES         TO ASC-SHIPT-STATUS-CDE          12680006
126900                                    ASC-SHIPT-STATUS-DESC         12690006
127000                                    ASTATDO                       12700006
127100         END-IF                                                   12710006
127200     END-IF.                                                      12720006
127300                                                                  12730006
127400     IF  AETAMML > ZERO                                           12740006
127500         MOVE AETAMMI             TO ASC-ETA-DTE-MM               12750006
127600     ELSE                                                         12760006
127700         IF  AETAMMF = DP015-ERASE-EOF                            12770006
127800             MOVE SPACE           TO ASC-ETA-DTE-MM               12780006
127900         END-IF                                                   12790006
128000     END-IF.                                                      12800006
128100                                                                  12810006
128200     IF  AETADDL > ZERO                                           12820006
128300         MOVE AETADDI             TO ASC-ETA-DTE-DD               12830006
128400     ELSE                                                         12840006
128500         IF  AETADDF = DP015-ERASE-EOF                            12850006
128600             MOVE SPACE           TO ASC-ETA-DTE-DD               12860006
128700         END-IF                                                   12870006
128800     END-IF.                                                      12880006
128900                                                                  12890006
129000     IF  AETAYYL > ZERO                                           12900006
129100         MOVE AETAYYI             TO ASC-ETA-DTE-CCYY             12910006
129200     ELSE                                                         12920006
129300         IF  AETAYYF = DP015-ERASE-EOF                            12930006
129400             MOVE SPACE           TO ASC-ETA-DTE-CCYY             12940006
129500         END-IF                                                   12950006
129600     END-IF.                                                      12960006
129700                                                                  12970006
129800     IF  AETAHHL > ZERO                                           12980006
129900         MOVE AETAHHI             TO ASC-ETA-TIME-HH              12990006
130000     ELSE                                                         13000006
130100         IF  AETAHHF = DP015-ERASE-EOF                            13010006
130200             MOVE SPACE           TO ASC-ETA-TIME-HH              13020006
130300         END-IF                                                   13030006
130400     END-IF.                                                      13040006
130500                                                                  13050006
130600     IF  AETAMNL > ZERO                                           13060006
130700         MOVE AETAMNI             TO ASC-ETA-TIME-MM              13070006
130800     ELSE                                                         13080006
130900         IF  AETAMNF = DP015-ERASE-EOF                            13090006
131000             MOVE SPACE           TO ASC-ETA-TIME-MM              13100006
131100         END-IF                                                   13110006
131200     END-IF.                                                      13120006
131300     IF  ATYPEL > ZERO                                            13130006
131400         MOVE ATYPEI             TO ASC-PKG-TYP-CDE               13140006
131500     ELSE                                                         13150006
131600         IF  ATYPEF = DP015-ERASE-EOF                             13160006
131700             MOVE SPACES         TO ASC-PKG-TYP-CDE               13170006
131800                                    ASC-PKG-TYP-CDE-DESC          13180006
131900                                    ATYPEDO                       13190006
132000         END-IF                                                   13200006
132100     END-IF.                                                      13210006
132200                                                                  13220006
132300     IF  AQTYL > ZERO                                             13230006
132400         MOVE AQTYI              TO ASC-PKG-QTY                   13240006
132500     ELSE                                                         13250006
132600         IF  AQTYF = DP015-ERASE-EOF                              13260006
132700             MOVE SPACES         TO ASC-PKG-QTY                   13270006
132800         END-IF                                                   13280006
132900     END-IF.                                                      13290006
133000                                                                  13300006
133100     IF  AWGHTL > ZERO                                            13310006
133200         MOVE AWGHTI             TO ASC-GROSS-WGHT                13320006
133300     ELSE                                                         13330006
133400         IF  AWGHTF = DP015-ERASE-EOF                             13340006
133500             MOVE SPACES         TO ASC-GROSS-WGHT                13350006
133600         END-IF                                                   13360006
133700     END-IF.                                                      13370006
133800                                                                  13380006
133900     IF  APLTL > ZERO                                             13390006
134000         MOVE APLTI              TO ASC-PLT-QTY                   13400006
134100     ELSE                                                         13410006
134200         IF  APLTF = DP015-ERASE-EOF                              13420006
134300             MOVE SPACES         TO ASC-PLT-QTY                   13430006
134400         END-IF                                                   13440006
134500     END-IF.                                                      13450006
134600                                                                  13460006
134700     IF  ACHRGL > ZERO                                            13470006
134800         MOVE ACHRGI             TO ASC-FRGT-CHRG                 13480006
134900     ELSE                                                         13490006
135000         IF  ACHRGF = DP015-ERASE-EOF                             13500006
135100             MOVE SPACES         TO ASC-FRGT-CHRG                 13510006
135200             MOVE ZEROES         TO ASC-FRGT-CHRG-N               13520006
135300         END-IF                                                   13530006
135400     END-IF.                                                      13540006
135500                                                                  13550006
135600     IF  ATERML > ZERO                                            13560006
135700         MOVE ATERMI             TO ASC-FRGT-TERM                 13570006
135800     ELSE                                                         13580006
135900         IF  ATERMF = DP015-ERASE-EOF                             13590006
136000             MOVE SPACES         TO ASC-FRGT-TERM                 13600006
136100                                    ASC-FRGT-TERM-DESC            13610006
136200         END-IF                                                   13620006
136300     END-IF.                                                      13630006
136400                                                                  13640006
136500/                                                                 13650006
136600*----------------------------------------------------------------*13660006
136700*  EDIT ALL OF THE DATA ON THE SCREEN AS IT RESIDES IN THE       *13670006
136800*  COMMAREA (EDITTING IS NOT DONE AGAINST THE SCREEN DIRECTLY).  *13680006
136900*----------------------------------------------------------------*13690006
137000 3000-EDIT-DATA-IN-COMMAREA.                                      13700006
137100                                                                  13710006
137200     PERFORM 3200-RESET-ATTRIBUTES.                               13720006
137300                                                                  13730006
137400     IF  ASC-FRGT-TERM = ' ' OR 'C' OR 'P' OR 'F'                 13740006
137500         EVALUATE ASC-FRGT-TERM                                   13750006
137600           WHEN 'C'                                               13760006
137700             MOVE 'COLLECT'        TO ASC-FRGT-TERM-DESC          13770006
137800           WHEN 'P'                                               13780006
137900             MOVE 'PREPAID'        TO ASC-FRGT-TERM-DESC          13790006
138000           WHEN 'F'                                               13800006
138100             MOVE 'FREEASTRAY'     TO ASC-FRGT-TERM-DESC          13810006
138200         END-EVALUATE                                             13820006
138300     ELSE                                                         13830006
138400         SET PS-ERROR              TO TRUE                        13840006
138500         SET DP020-MSG-FATAL       TO TRUE                        13850006
138600         MOVE PC-TSYMSG-00005      TO DP020-MSG-NUMBER            13860006
138700         MOVE DP015-UNP-ALP-BRT-OFF                               13870006
138800                                   TO ATERMA                      13880006
138900         MOVE DP015-RED            TO ATERMC                      13890006
139000         MOVE DP015-REVERSE        TO ATERMH                      13900006
139100         MOVE -1                   TO ATERML                      13910006
139200         SET DP030-SET-CURSOR-APPL-1                              13920006
139300                                   TO TRUE                        13930006
139400     END-IF.                                                      13940006
139500                                                                  13950006
139600     IF  PS-NO-ERROR                                              13960006
139700     AND ASC-FRGT-CHRG > SPACES                                   13970006
139800         MOVE ASC-FRGT-CHRG      TO DP010I-UNEDITED-FIELD         13980006
139900         MOVE 6                  TO DP010I-MAXIMUM-DIGITS         13990006
140000         MOVE 2                  TO DP010I-MAXIMUM-DECIMALS       14000006
140100         SET DP010I-NEGATIVE-NOT-ALLOWED                          14010006
140200                                 TO TRUE                          14020006
273427         CALL DP010I-NUMERIC-EDIT-ROUTINE                         14031020
273427              USING DP010I-NUMERIC-EDIT-AREA                      14032020
140400         IF  DP010I-ERROR-DETECTED                                14040006
140500             SET PS-ERROR                                         14050006
140600                 DP020-MSG-FATAL TO TRUE                          14060006
140700             MOVE PC-TSYMSG-00008                                 14070006
140800                                 TO DP020-MSG-NUMBER              14080006
140900             MOVE DP015-UNP-ALP-BRT-OFF                           14090006
141000                                 TO ACHRGA                        14100006
141100             MOVE DP015-RED      TO ACHRGC                        14110006
141200             MOVE DP015-REVERSE  TO ACHRGH                        14120006
141300             MOVE -1             TO ACHRGL                        14130006
141400             SET DP030-SET-CURSOR-APPL-1                          14140006
141500                                 TO TRUE                          14150006
141600         ELSE                                                     14160006
141700             MOVE DP010I-NUMERIC-FIELD                            14170006
141800                                 TO ASC-FRGT-CHRG-N               14180006
141900             MOVE ASC-FRGT-CHRG-N                                 14190006
142000                                 TO ACHRGO                        14200006
142100             MOVE ACHRGO         TO ASC-FRGT-CHRG                 14210006
142200         END-IF                                                   14220006
142300     END-IF.                                                      14230006
142400                                                                  14240006
142500     IF  PS-NO-ERROR                                              14250006
142600     AND ASC-PLT-QTY > SPACES                                     14260006
142700         MOVE ASC-PLT-QTY        TO DP010I-UNEDITED-FIELD         14270006
142800         MOVE LENGTH OF ASC-PLT-QTY                               14280006
142900                                 TO DP010I-MAXIMUM-DIGITS         14290006
143000         MOVE ZERO               TO DP010I-MAXIMUM-DECIMALS       14300006
143100         SET DP010I-NEGATIVE-NOT-ALLOWED                          14310006
143200                                 TO TRUE                          14320006
273427         CALL DP010I-NUMERIC-EDIT-ROUTINE                         14331020
273427              USING DP010I-NUMERIC-EDIT-AREA                      14332020
143400         IF  DP010I-ERROR-DETECTED                                14340006
143500             SET PS-ERROR                                         14350006
143600                 DP020-MSG-FATAL TO TRUE                          14360006
143700             MOVE PC-TSYMSG-00008                                 14370006
143800                                 TO DP020-MSG-NUMBER              14380006
143900             MOVE DP015-UNP-ALP-BRT-OFF                           14390006
144000                                 TO APLTA                         14400006
144100             MOVE DP015-RED      TO APLTC                         14410006
144200             MOVE DP015-REVERSE  TO APLTH                         14420006
144300             MOVE -1             TO APLTL                         14430006
144400             SET DP030-SET-CURSOR-APPL-1                          14440006
144500                                 TO TRUE                          14450006
144600         ELSE                                                     14460006
144700             MOVE DP010I-NUMERIC-FIELD                            14470006
144800                                 TO ASC-PLT-QTY-N                 14480006
144900         END-IF                                                   14490006
145000     END-IF.                                                      14500006
145100                                                                  14510006
145200     IF  PS-NO-ERROR                                              14520006
145300     AND ASC-GROSS-WGHT > SPACES                                  14530006
145400         MOVE ASC-GROSS-WGHT     TO DP010I-UNEDITED-FIELD         14540006
145500         MOVE LENGTH OF ASC-GROSS-WGHT                            14550006
145600                                 TO DP010I-MAXIMUM-DIGITS         14560006
145700         MOVE ZERO               TO DP010I-MAXIMUM-DECIMALS       14570006
145800         SET DP010I-NEGATIVE-NOT-ALLOWED                          14580006
145900                                 TO TRUE                          14590006
273427         CALL DP010I-NUMERIC-EDIT-ROUTINE                         14601020
273427              USING DP010I-NUMERIC-EDIT-AREA                      14602020
146100         IF  DP010I-ERROR-DETECTED                                14610006
146200             SET PS-ERROR                                         14620006
146300                 DP020-MSG-FATAL TO TRUE                          14630006
146400             MOVE PC-TSYMSG-00008                                 14640006
146500                                 TO DP020-MSG-NUMBER              14650006
146600             MOVE DP015-UNP-ALP-BRT-OFF                           14660006
146700                                 TO AWGHTA                        14670006
146800             MOVE DP015-RED      TO AWGHTC                        14680006
146900             MOVE DP015-REVERSE  TO AWGHTH                        14690006
147000             MOVE -1             TO AWGHTL                        14700006
147100             SET DP030-SET-CURSOR-APPL-1                          14710006
147200                                 TO TRUE                          14720006
147300         ELSE                                                     14730006
147400             MOVE DP010I-NUMERIC-FIELD                            14740006
147500                                 TO ASC-GROSS-WGHT-N              14750006
147600         END-IF                                                   14760006
147700     END-IF.                                                      14770006
147800                                                                  14780006
147900     IF  PS-NO-ERROR                                              14790006
148000     AND ASC-PKG-QTY > SPACES                                     14800006
148100         MOVE ASC-PKG-QTY        TO DP010I-UNEDITED-FIELD         14810006
148200         MOVE LENGTH OF ASC-PKG-QTY                               14820006
148300                                 TO DP010I-MAXIMUM-DIGITS         14830006
148400         MOVE ZERO               TO DP010I-MAXIMUM-DECIMALS       14840006
148500         SET DP010I-NEGATIVE-NOT-ALLOWED                          14850006
148600                                 TO TRUE                          14860006
273427         CALL DP010I-NUMERIC-EDIT-ROUTINE                         14871020
273427              USING DP010I-NUMERIC-EDIT-AREA                      14872020
148800         IF  DP010I-ERROR-DETECTED                                14880006
148900             SET PS-ERROR                                         14890006
149000                 DP020-MSG-FATAL TO TRUE                          14900006
149100             MOVE PC-TSYMSG-00008                                 14910006
149200                                 TO DP020-MSG-NUMBER              14920006
149300             MOVE DP015-UNP-ALP-BRT-OFF                           14930006
149400                                 TO AQTYA                         14940006
149500             MOVE DP015-RED      TO AQTYC                         14950006
149600             MOVE DP015-REVERSE  TO AQTYH                         14960006
149700             MOVE -1             TO AQTYL                         14970006
149800             SET DP030-SET-CURSOR-APPL-1                          14980006
149900                                 TO TRUE                          14990006
150000         ELSE                                                     15000006
150100             MOVE DP010I-NUMERIC-FIELD                            15010006
150200                                 TO ASC-PKG-QTY-N                 15020006
150300         END-IF                                                   15030006
150400     END-IF.                                                      15040006
150500                                                                  15050006
150600     IF  ASC-PKG-TYP-CDE = SPACES                                 15060006
150700         SET PS-ERROR            TO TRUE                          15070006
150800         SET DP020-MSG-FATAL     TO TRUE                          15080006
150900         MOVE PC-TSYMSG-00007    TO DP020-MSG-NUMBER              15090006
151000         MOVE DP015-UNP-ALP-BRT-OFF                               15100006
151100                                 TO ATYPEA                        15110006
151200         MOVE DP015-RED          TO ATYPEC                        15120006
151300         MOVE DP015-REVERSE      TO ATYPEH                        15130006
151400         MOVE -1                 TO ATYPEL                        15140006
151500         SET DP030-SET-CURSOR-APPL-1                              15150006
151600                                 TO TRUE                          15160006
151700     ELSE                                                         15170006
151800         MOVE ASC-PKG-TYP-CDE    TO DK-PKG-TYP-CDE                15180006
151900         PERFORM 3030-VALIDATE-PKG-TYP-CDE                        15190006
152000         IF  SQLCODE = +100                                       15200006
152100             SET PS-ERROR              TO TRUE                    15210006
152200             SET DP020-MSG-FATAL       TO TRUE                    15220006
152300             MOVE PC-TSYMSG-00005      TO DP020-MSG-NUMBER        15230006
152400             MOVE DP015-UNP-ALP-BRT-OFF                           15240006
152500                                       TO ATYPEA                  15250006
152600             MOVE DP015-RED            TO ATYPEC                  15260006
152700             MOVE DP015-REVERSE        TO ATYPEH                  15270006
152800             MOVE -1                   TO ATYPEL                  15280006
152900             SET DP030-SET-CURSOR-APPL-1                          15290006
153000                                       TO TRUE                    15300006
153100         ELSE                                                     15310006
153200             MOVE PKGTYP-DESC          TO ASC-PKG-TYP-CDE-DESC    15320006
153300                                          ATYPEDO                 15330006
153400         END-IF                                                   15340006
153500     END-IF.                                                      15350006
153600                                                                  15360006
153700     IF  ASC-ETA-DTE-MM > SPACES                                  15370006
153800     OR  ASC-ETA-DTE-DD > SPACES                                  15380006
153900     OR  ASC-ETA-DTE-CCYY > SPACES                                15390006
154000         STRING ASC-ETA-DTE-MM                 DELIMITED BY SIZE  15400006
154100                ASC-ETA-DTE-DD                 DELIMITED BY SIZE  15410006
154200                ASC-ETA-DTE-CCYY(3:2)          DELIMITED BY SIZE  15420006
154300                               INTO DPG52-LK-DATE-INPUT           15430006
154400        INITIALIZE DPG51                                          15440006
154500        SET DPG51-ACTUAL-CALENDAR-ONLY                            15450006
154600            DPG51-DO-NOT-INCR-DECR-DATE                           15460006
154700            DPG52-LK-DTE-GREG    TO TRUE                          15470006
154800        CALL PC-DPKUT500-PGM                                      15480006
154900                        USING DPG51 DPG52 DPG53 DPG54 DPG55 DPG56 15490006
155000        IF (DPG54-DATE-INVALID                                    15500006
155100        OR  DPG54-SEVERE-ERROR)                                   15510006
155200            SET PS-ERROR                                          15520006
155300                DP020-MSG-FATAL   TO TRUE                         15530006
155400            MOVE PC-TSYMSG-00009  TO DP020-MSG-NUMBER             15540006
155500            MOVE DP015-UNP-ALP-BRT-MDT                            15550006
155600                                  TO AETAMMA                      15560006
155700                                     AETADDA                      15570006
155800                                     AETAYYA                      15580006
155900            MOVE DP015-RED        TO AETAMMC                      15590006
156000                                     AETADDC                      15600006
156100                                     AETAYYC                      15610006
156200            MOVE DP015-REVERSE    TO AETAMMH                      15620006
156300                                     AETADDH                      15630006
156400                                     AETAYYH                      15640006
156500            MOVE -1               TO AETAMML                      15650006
156600            SET DP030-SET-CURSOR-APPL-1                           15660006
156700                                  TO TRUE                         15670006
156800        ELSE                                                      15680006
156900            MOVE DPG55-DB2-ISO-DATE-FMT                           15690006
157000                                  TO ASC-ETA-DTE                  15700006
157100            SET PS-ETA-DATE-VALID TO TRUE                         15710006
157200        END-IF                                                    15720006
157300     ELSE                                                         15730006
157400        IF ASC-ETA-DTE-OLD > SPACES                               15740006
157500*           SET DP020-MSG-INFORMATIONAL                           15750006
157600*                                 TO TRUE                         15760006
157700            MOVE PC-TSYMSG-00715  TO DP020-MSG-NUMBER             15770006
157800            MOVE ASC-ETA-DTE-MM   TO AETAMMO                      15780006
157900            MOVE ASC-ETA-DTE-DD   TO AETADDO                      15790006
158000            MOVE ASC-ETA-DTE-CCYY TO AETAYYO                      15800006
158100        END-IF                                                    15810006
158200     END-IF.                                                      15820006
158300                                                                  15830006
158400     IF ASC-ETA-TIME-MM = SPACES AND                              15840006
158500        ASC-ETA-TIME-HH = SPACES                                  15850006
158600         MOVE '00' TO ASC-ETA-TIME-MM                             15860006
158700                      AETAMNO                                     15870006
158800         MOVE '00' TO ASC-ETA-TIME-HH                             15880006
158900                      AETAHHO                                     15890006
159000         SET PS-ETA-TIME-VALID TO TRUE                            15900006
159100     END-IF.                                                      15910006
159200                                                                  15920006
159300     IF PS-ETA-DATE-VALID AND                                     15930006
159400        ASC-ETA-TIME-HH = SPACES                                  15940006
159500         SET PS-ERROR              TO TRUE                        15950006
159600         SET DP020-MSG-FATAL       TO TRUE                        15960006
159700         MOVE PC-TSYMSG-00007      TO DP020-MSG-NUMBER            15970006
159800         MOVE DP015-UNP-NUM-BRT-OFF                               15980006
159900                                   TO AETAHHA                     15990006
160000         MOVE DP015-RED            TO AETAHHC                     16000006
160100         MOVE DP015-REVERSE        TO AETAHHH                     16010006
160200         MOVE -1                   TO AETAHHL                     16020006
160300         SET DP030-SET-CURSOR-APPL-1                              16030006
160400             PS-ETA-TIME-NOT-VALID TO TRUE.                       16040006
160500                                                                  16050006
160600     IF ASC-ETA-TIME-HH = SPACES OR                               16060006
160700        ASC-ETA-TIME-HH = '00'                                    16070006
160800         CONTINUE                                                 16080006
160900     ELSE                                                         16090006
161000         MOVE ASC-ETA-TIME-HH      TO DP010I-UNEDITED-FIELD       16100006
161100         MOVE LENGTH OF ASC-ETA-TIME-HH TO DP010I-MAXIMUM-DIGITS  16110006
161200         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     16120006
161300         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  16130006
273427         CALL DP010I-NUMERIC-EDIT-ROUTINE                         16141020
273427              USING DP010I-NUMERIC-EDIT-AREA                      16142020
161500         IF  DP010I-ERROR-DETECTED                                16150006
161600             SET PS-ERROR                                         16160006
161700                 DP020-MSG-FATAL   TO TRUE                        16170006
161800             MOVE PC-TSYMSG-00008      TO DP020-MSG-NUMBER        16180006
161900             MOVE DP015-UNP-NUM-BRT-OFF                           16190006
162000                                       TO AETAHHA                 16200006
162100             MOVE DP015-RED            TO AETAHHC                 16210006
162200             MOVE DP015-REVERSE        TO AETAHHH                 16220006
162300             MOVE -1                   TO AETAHHL                 16230006
162400             SET DP030-SET-CURSOR-APPL-1                          16240006
162500                 PS-ETA-TIME-NOT-VALID TO TRUE                    16250006
162600         ELSE                                                     16260006
162700             IF DP010I-NUMERIC-FIELD > PC-24                      16270006
162800                 SET PS-ERROR              TO TRUE                16280006
162900                 SET DP020-MSG-FATAL       TO TRUE                16290006
163000                 MOVE PC-TSYMSG-00005      TO DP020-MSG-NUMBER    16300006
163100                 MOVE DP015-UNP-NUM-BRT-OFF                       16310006
163200                                           TO AETAHHA             16320006
163300                 MOVE DP015-RED            TO AETAHHC             16330006
163400                 MOVE DP015-REVERSE        TO AETAHHH             16340006
163500                 MOVE -1                   TO AETAHHL             16350006
163600                 SET DP030-SET-CURSOR-APPL-1                      16360006
163700                     PS-ETA-TIME-NOT-VALID TO TRUE                16370006
163800             ELSE                                                 16380006
163900                 SET PS-ETA-TIME-VALID TO TRUE                    16390006
164000                 MOVE DP010I-NUMERIC-FIELD TO ASC-ETA-TIME-HH-N   16400006
164100                 MOVE ASC-ETA-TIME-HH  TO AETAHHO.                16410006
164200                                                                  16420006
164300     IF PS-ETA-DATE-VALID AND                                     16430006
164400        ASC-ETA-TIME-MM = SPACES                                  16440006
164500         IF PS-ETA-TIME-VALID                                     16450006
164600             MOVE '00' TO ASC-ETA-TIME-MM                         16460006
164700                          AETAMNO                                 16470006
164800             SET PS-ETA-TIME-VALID TO TRUE                        16480006
164900         ELSE                                                     16490006
165000             SET PS-ERROR              TO TRUE                    16500006
165100             SET DP020-MSG-FATAL       TO TRUE                    16510006
165200             MOVE PC-TSYMSG-00007      TO DP020-MSG-NUMBER        16520006
165300             MOVE DP015-UNP-NUM-BRT-OFF                           16530006
165400                                       TO AETAMNA                 16540006
165500             MOVE DP015-RED            TO AETAMNC                 16550006
165600             MOVE DP015-REVERSE        TO AETAMNH                 16560006
165700             MOVE -1                   TO AETAMNL                 16570006
165800             SET DP030-SET-CURSOR-APPL-1                          16580006
165900                 PS-ETA-TIME-NOT-VALID TO TRUE                    16590006
166000         END-IF                                                   16600006
166100     END-IF.                                                      16610006
166200                                                                  16620006
166300     IF ASC-ETA-TIME-MM = SPACES OR                               16630006
166400        ASC-ETA-TIME-MM = '00'                                    16640006
166500         CONTINUE                                                 16650006
166600     ELSE                                                         16660006
166700         MOVE ASC-ETA-TIME-MM      TO DP010I-UNEDITED-FIELD       16670006
166800         MOVE LENGTH OF ASC-ETA-TIME-MM TO DP010I-MAXIMUM-DIGITS  16680006
166900         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     16690006
167000         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  16700006
273427         CALL DP010I-NUMERIC-EDIT-ROUTINE                         16711020
273427              USING DP010I-NUMERIC-EDIT-AREA                      16712020
167200         IF  DP010I-ERROR-DETECTED                                16720006
167300             SET PS-ERROR                                         16730006
167400                 DP020-MSG-FATAL   TO TRUE                        16740006
167500             MOVE PC-TSYMSG-00008      TO DP020-MSG-NUMBER        16750006
167600             MOVE DP015-UNP-NUM-BRT-OFF                           16760006
167700                                       TO AETAMNA                 16770006
167800             MOVE DP015-RED            TO AETAMNC                 16780006
167900             MOVE DP015-REVERSE        TO AETAMNH                 16790006
168000             MOVE -1                   TO AETAMNL                 16800006
168100             SET DP030-SET-CURSOR-APPL-1                          16810006
168200                 PS-ETA-TIME-NOT-VALID TO TRUE                    16820006
168300         ELSE                                                     16830006
168400             IF DP010I-NUMERIC-FIELD > PC-59                      16840006
168500                 SET PS-ERROR              TO TRUE                16850006
168600                 SET DP020-MSG-FATAL       TO TRUE                16860006
168700                 MOVE PC-TSYMSG-00005      TO DP020-MSG-NUMBER    16870006
168800                 MOVE DP015-UNP-NUM-BRT-OFF                       16880006
168900                                           TO AETAMNA             16890006
169000                 MOVE DP015-RED            TO AETAMNC             16900006
169100                 MOVE DP015-REVERSE        TO AETAMNH             16910006
169200                 MOVE -1                   TO AETAMNL             16920006
169300                 SET DP030-SET-CURSOR-APPL-1                      16930006
169400                     PS-ETA-TIME-NOT-VALID TO TRUE                16940006
169500             ELSE                                                 16950006
169600                 SET PS-ETA-TIME-VALID TO TRUE                    16960006
169700                 MOVE DP010I-NUMERIC-FIELD TO ASC-ETA-TIME-MM-N   16970006
169800                 MOVE ASC-ETA-TIME-MM  TO AETAMNO.                16980006
169900                                                                  16990006
170000     IF  ASC-ETA-DTE-MM = SPACES AND                              17000006
170100         ASC-ETA-DTE-DD = SPACES AND                              17010006
170200         ASC-ETA-DTE-CCYY = SPACES                                17020006
170300         IF PS-ETA-TIME-VALID                                     17030006
170400             SET PS-ERROR              TO TRUE                    17040006
170500             SET DP020-MSG-FATAL       TO TRUE                    17050006
170600             MOVE PC-TSYMSG-00752      TO DP020-MSG-NUMBER        17060006
170700             MOVE DP015-UNP-NUM-BRT-OFF                           17070006
170800                                       TO AETAHHA                 17080006
170900             MOVE DP015-RED            TO AETAHHC                 17090006
171000             MOVE DP015-REVERSE        TO AETAHHH                 17100006
171100             MOVE -1                   TO AETAHHL                 17110006
171200             SET DP030-SET-CURSOR-APPL-1                          17120006
171300                                       TO TRUE                    17130006
171400             MOVE DP015-UNP-NUM-BRT-OFF                           17140006
171500                                       TO AETAMNA                 17150006
171600             MOVE DP015-RED            TO AETAMNC                 17160006
171700             MOVE DP015-REVERSE        TO AETAMNH.                17170006
171800                                                                  17180006
171900     IF  ASC-SHIPT-STATUS-CDE = SPACES                            17190006
172000         SET PS-ERROR            TO TRUE                          17200006
172100         SET DP020-MSG-FATAL     TO TRUE                          17210006
172200         MOVE PC-TSYMSG-00007    TO DP020-MSG-NUMBER              17220006
172300         MOVE DP015-UNP-ALP-BRT-OFF                               17230006
172400                                 TO ASTATA                        17240006
172500         MOVE DP015-RED          TO ASTATC                        17250006
172600         MOVE DP015-REVERSE      TO ASTATH                        17260006
172700         MOVE -1                 TO ASTATL                        17270006
172800         SET DP030-SET-CURSOR-APPL-1                              17280006
172900                                 TO TRUE                          17290006
173000     ELSE                                                         17300006
173100         MOVE ASC-SHIPT-STATUS-CDE                                17310006
173200                             TO DK-SHIPT-STATUS-CDE               17320006
173300         PERFORM 4330-GET-SHIPT-STATUS-DESC                       17330006
173400         MOVE SHSTYP-DESC    TO ASC-SHIPT-STATUS-DESC             17340006
173500                                ASTATDO                           17350006
173600         MOVE SHSTYP-PRTY-CDE TO ASC-SHIPT-PRTY-CDE               17360006
173700     END-IF.                                                      17370006
173800                                                                  17380006
173900     IF  ASC-ADD-SHIPMENT                                         17390006
174000     OR  ASC-UPDATE-PENDING                                       17400006
174100         MOVE ASC-KEY-TRIP-ID      TO DK-TRIP-ID                  17410006
174200         MOVE ASC-SHIPT-STATUS-CDE TO DK-SHIPT-STATUS-CDE         17420006
174300         PERFORM 3040-CHECK-TRIP-STATUS                           17430006
174400         IF  ASC-UPDATE-PENDING                                   17440006
174500         AND ASC-TRIP-STATUS-CDE NOT = ASC-SHIPT-STATUS-CDE       17450006
174600             SET PS-ERROR         TO TRUE                         17460006
174700             SET DP020-MSG-FATAL  TO TRUE                         17470006
174800             MOVE PC-TSYMSG-00648 TO DP020-MSG-NUMBER             17480006
174900             MOVE DP015-UNP-ALP-BRT-OFF                           17490006
175000                                  TO ASTATA                       17500006
175100             MOVE DP015-RED       TO ASTATC                       17510006
175200             MOVE DP015-REVERSE   TO ASTATH                       17520006
175300             MOVE -1              TO ASTATL                       17530006
175400             SET DP030-SET-CURSOR-APPL-1                          17540006
175500                                  TO TRUE                         17550006
175600         END-IF                                                   17560006
175700     END-IF.                                                      17570006
175800                                                                  17580006
175900         MOVE ASC-KEY-OWNER-SCAC-ID                               17590006
176000                                 TO DK-OWNER-SCAC-ID              17600006
176100         PERFORM 4310-GET-ENT-NAME-DESC                           17610006
176200         MOVE ENTNME-ENT-NAME-DESC TO ASC-OWNER-SCAC-ID-DESC      17620006
176300                                      ASCACDO                     17630006
176400** SLH  09/12/07 BEGIN                                            17640006
176500     IF ASC-SUSPND-UPDATE-YES                                     17650006
176600        CONTINUE                                                  17660006
176700     ELSE                                                         17670006
176800       IF  ASC-KEY-VEH-NBR > SPACES                               17680006
176900           MOVE ASC-KEY-VEH-NBR  TO DK-VEH-NBR                    17690006
177000           PERFORM 4300-VALIDATE-TRAILER                          17700006
177100           IF SQLCODE = +0 AND                                    17710006
177200               ASC-VEHICLE-NULL-TRIP                              17720006
177300               SET PS-ERROR                                       17730006
177400                  DP020-MSG-FATAL         TO TRUE                 17740006
177500              MOVE PC-TSYMSG-00770        TO DP020-MSG-NUMBER     17750006
177600              MOVE DP015-RED              TO ATRLRC               17760006
177700              MOVE DP015-REVERSE          TO ATRLRH               17770006
177800              SET DP030-SET-CURSOR-TRAILER                        17780006
177900                                          TO TRUE                 17790006
178000           END-IF                                                 17800006
178100       END-IF                                                     17810006
178200     END-IF.                                                      17820006
178300                                                                  17830006
178400** SLH  09/12/07  END                                             17840006
178500     IF  ASC-ADD-PENDING OR ASC-UPDATE-PENDING                    17850006
178600         IF (ASC-KEY-VEH-TYP-CDE = 'VS' OR 'AV') AND              17860006
178700            ASC-KEY-PRO-NBR = SPACES                              17870006
178800         SET PS-ERROR                                             17880006
178900             DP020-MSG-FATAL     TO TRUE                          17890006
179000         MOVE PC-TSYMSG-00007    TO DP020-MSG-NUMBER              17900006
179100         MOVE DP015-UNP-ALP-BRT-OFF                               17910006
179200                                 TO APROA                         17920006
179300         MOVE DP015-RED          TO APROC                         17930006
179400         MOVE DP015-REVERSE      TO APROH                         17940006
179500         MOVE -1                 TO APROL                         17950006
179600         SET DP030-SET-CURSOR-APPL-1                              17960006
179700                                 TO TRUE                          17970006
179800         ELSE                                                     17980006
179900            IF (ASC-KEY-VEH-TYP-CDE = 'VS' OR 'AV') AND           17990006
180000                ASC-KEY-PRO-NBR (13:4) NOT = SPACES               18000006
180100                 SET PS-ERROR                                     18010006
180200                     DP020-MSG-FATAL     TO TRUE                  18020006
180300                 MOVE PC-TSYMSG-03332    TO DP020-MSG-NUMBER      18030006
180400                 MOVE DP015-UNP-ALP-BRT-OFF                       18040006
180500                                         TO APROA                 18050006
180600                 MOVE DP015-RED          TO APROC                 18060006
180700                 MOVE DP015-REVERSE      TO APROH                 18070006
180800                 MOVE -1                 TO APROL                 18080006
180900                 SET DP030-SET-CURSOR-APPL-1                      18090006
181000                                         TO TRUE                  18100006
181100            END-IF                                                18110006
181200         END-IF                                                   18120006
181300     END-IF.                                                      18130006
181400                                                                  18140006
181500     IF  ASC-ADD-PENDING                                          18150006
181600     AND ASC-KEY-BOL-NBR = SPACES                                 18160006
181700     AND ASC-KEY-PRO-NBR = SPACES                                 18170006
181800         SET PS-ERROR                                             18180006
181900             DP020-MSG-FATAL     TO TRUE                          18190006
182000         MOVE PC-TSYMSG-00308    TO DP020-MSG-NUMBER              18200006
182100         MOVE DP015-UNP-ALP-BRT-OFF                               18210006
182200                                 TO ABOLA                         18220006
182300                                    APROA                         18230006
182400         MOVE DP015-RED          TO ABOLC                         18240006
182500                                    APROC                         18250006
182600         MOVE DP015-REVERSE      TO ABOLH                         18260006
182700                                    APROH                         18270006
182800         MOVE -1                 TO APROL                         18280006
182900         SET DP030-SET-CURSOR-APPL-1                              18290006
183000                                 TO TRUE                          18300006
183100     END-IF.                                                      18310006
183200                                                                  18320006
183300     IF ASC-KEY-PRO-NBR > SPACES OR                               18330006
183400        ASC-KEY-BOL-NBR > SPACES                                  18340006
183500         IF ASC-KEY-PRO-NBR = SPACES                              18350006
183600             MOVE 'ZZZZZZZZZZZZZZZZZZZZZZ' TO ASC-PRO-NBR         18360006
183700         ELSE                                                     18370006
183800             MOVE ASC-KEY-PRO-NBR        TO RC023-FREIGHT-BILL    18380006
183900                                            ASC-KEY-COMP-PRO-NBR  18390006
184000             CALL RC023-FB-BOL-VEH-FORMAT                         18400006
184100                                 USING RC023-FORMAT-DATA-AREA     18410006
184200             MOVE RC023-FREIGHT-BILL     TO ASC-PRO-NBR           18420006
184300                                                                  18430006
184400         END-IF                                                   18440006
184500         IF ASC-KEY-BOL-NBR = SPACES                              18450006
184600             MOVE 'ZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZ' TO ASC-BOL-NBR 18460006
184700         ELSE                                                     18470006
184800             MOVE ASC-KEY-BOL-NBR        TO RC023-BILL-OF-LADING  18480006
184900                                            ASC-KEY-COMP-BOL-NBR  18490006
185000             CALL RC023-FB-BOL-VEH-FORMAT                         18500006
185100                                 USING RC023-FORMAT-DATA-AREA     18510006
185200             MOVE RC023-BILL-OF-LADING   TO ASC-BOL-NBR           18520006
185300         END-IF                                                   18530006
185400         PERFORM 3050-VALIDATE-SHIPMENT                           18540006
185500         IF ASC-BOL-NBR = 'ZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZ'        18550006
185600             MOVE SPACES TO ASC-BOL-NBR                           18560006
185700         END-IF                                                   18570006
185800         IF ASC-PRO-NBR = 'ZZZZZZZZZZZZZZZZZZZZZZ'                18580006
185900             MOVE SPACES TO ASC-PRO-NBR                           18590006
186000         END-IF                                                   18600006
186100         IF SQLCODE = +0                                          18610006
186200             SET DP020-MSG-WARNING   TO TRUE                      18620006
186300             MOVE PC-TSYMSG-00117    TO DP020-MSG-NUMBER          18630006
186400         END-IF                                                   18640006
186500     END-IF.                                                      18650006
186600                                                                  18660006
186700     IF  ASC-ADD-PENDING                                          18670006
186800     AND ASC-KEY-PRO-SCAC-ID = SPACES                             18680006
186900         SET PS-ERROR                                             18690006
187000             DP020-MSG-FATAL     TO TRUE                          18700006
187100         MOVE PC-TSYMSG-00007    TO DP020-MSG-NUMBER              18710006
187200         MOVE DP015-UNP-ALP-BRT-OFF                               18720006
187300                                 TO APSCACA                       18730006
187400         MOVE DP015-RED          TO APSCACC                       18740006
187500         MOVE DP015-REVERSE      TO APSCACH                       18750006
187600         MOVE -1                 TO APSCACL                       18760006
187700         SET DP030-SET-CURSOR-APPL-1                              18770006
187800                                 TO TRUE                          18780006
187900     END-IF.                                                      18790006
188000                                                                  18800006
188100     IF  ASC-KEY-PRO-SCAC-ID > SPACES                             18810006
188200     AND PS-NO-ERROR                                              18820006
188300         MOVE ASC-KEY-PRO-SCAC-ID                                 18830006
188400                                 TO DK-OWNER-SCAC-ID              18840006
188500         PERFORM 4310-GET-ENT-NAME-DESC                           18850006
188600         IF  SQLCODE = +100                                       18860006
188700             SET PS-ERROR                                         18870006
188800                 DP020-MSG-FATAL     TO TRUE                      18880006
188900             MOVE PC-TSYMSG-00005    TO DP020-MSG-NUMBER          18890006
189000             MOVE DP015-UNP-ALP-BRT-OFF                           18900006
189100                                     TO APSCACA                   18910006
189200             MOVE DP015-RED          TO APSCACC                   18920006
189300             MOVE DP015-REVERSE      TO APSCACH                   18930006
189400             MOVE -1                 TO APSCACL                   18940006
189500             SET DP030-SET-CURSOR-APPL-1                          18950006
189600                                     TO TRUE                      18960006
189700         ELSE                                                     18970006
189800             MOVE ENTNME-ENT-NAME-DESC                            18980006
189900                                     TO ASC-PRO-SCAC-ID-DESC      18990006
190000                                        APSCACDO                  19000006
190100         END-IF                                                   19010006
190200     END-IF.                                                      19020006
190300                                                                  19030006
190400     IF  ASC-ADD-PENDING                                          19040006
190500         IF  ASC-KEY-VEH-NBR = SPACES                             19050006
190600             SET ASC-ADD-OPEN-SHIPMENT                            19060006
190700                                     TO TRUE                      19070006
190800         ELSE                                                     19080006
190900             SET ASC-ADD-SHIPMENT                                 19090006
191000                                     TO TRUE                      19100006
191100         END-IF                                                   19110006
191200     END-IF.                                                      19120006
191300                                                                  19130006
191400     IF  ASC-ADD-PENDING                                          19140006
191500     AND ASC-KEY-DEST-OPER-UNT-ID = (SPACES OR ZEROES)            19150006
191600         SET PS-ERROR                                             19160006
191700             DP020-MSG-FATAL     TO TRUE                          19170006
191800         MOVE PC-TSYMSG-00007    TO DP020-MSG-NUMBER              19180006
191900         MOVE DP015-UNP-ALP-BRT-OFF                               19190006
192000                                 TO ADOPERA                       19200006
192100         MOVE DP015-RED          TO ADOPERC                       19210006
192200         MOVE DP015-REVERSE      TO ADOPERH                       19220006
192300         MOVE -1                 TO ADOPERL                       19230006
192400         SET DP030-SET-CURSOR-APPL-1                              19240006
192500                                 TO TRUE                          19250006
192600     END-IF.                                                      19260006
192700                                                                  19270006
192800     IF  PS-NO-ERROR                                              19280006
192900     AND ASC-KEY-DEST-OPER-UNT-ID > (SPACES OR ZEROES)            19290006
193000         MOVE ASC-KEY-DEST-OPER-UNT-ID                            19300006
193100                                 TO DP010I-UNEDITED-FIELD         19310006
193200         MOVE LENGTH OF ASC-KEY-DEST-OPER-UNT-ID                  19320006
193300                                 TO DP010I-MAXIMUM-DIGITS         19330006
193400         MOVE ZERO               TO DP010I-MAXIMUM-DECIMALS       19340006
193500         SET DP010I-NEGATIVE-NOT-ALLOWED                          19350006
193600                                 TO TRUE                          19360006
273427         CALL DP010I-NUMERIC-EDIT-ROUTINE                         19371020
273427              USING DP010I-NUMERIC-EDIT-AREA                      19372020
193800         IF  DP010I-ERROR-DETECTED                                19380006
193900             SET PS-ERROR                                         19390006
194000                 DP020-MSG-FATAL TO TRUE                          19400006
194100             MOVE PC-TSYMSG-00008                                 19410006
194200                                 TO DP020-MSG-NUMBER              19420006
194300             MOVE DP015-UNP-ALP-BRT-OFF                           19430006
194400                                 TO ADOPERA                       19440006
194500             MOVE DP015-RED      TO ADOPERC                       19450006
194600             MOVE DP015-REVERSE  TO ADOPERH                       19460006
194700             MOVE -1             TO ADOPERL                       19470006
194800             SET DP030-SET-CURSOR-APPL-1                          19480006
194900                                 TO TRUE                          19490006
195000         ELSE                                                     19500006
195100             MOVE DP010I-NUMERIC-FIELD                            19510006
195200                                 TO ASC-KEY-DEST-OPER-UNT-ID-N    19520006
195300                                    DK-OPER-UNT-ID                19530006
195400             MOVE ASC-KEY-DEST-OPER-UNT-ID                        19540006
195500                                 TO ADOPERO                       19550006
195600         END-IF                                                   19560006
195700     END-IF.                                                      19570006
195800                                                                  19580006
195900     IF  PS-NO-ERROR                                              19590006
196000     AND ASC-KEY-DEST-OPER-UNT-ID > (SPACES OR ZEROES)            19600006
196100         PERFORM 3010-VALIDATE-OPER-UNT-ID                        19610006
196200         IF  SQLCODE = +100                                       19620006
196300             SET PS-ERROR                                         19630006
196400                 DP020-MSG-FATAL     TO TRUE                      19640006
196500             MOVE PC-TSYMSG-00005    TO DP020-MSG-NUMBER          19650006
196600             MOVE DP015-UNP-ALP-BRT-OFF                           19660006
196700                                     TO ADOPERA                   19670006
196800             MOVE DP015-RED          TO ADOPERC                   19680006
196900             MOVE DP015-REVERSE      TO ADOPERH                   19690006
197000             MOVE -1                 TO ADOPERL                   19700006
197100             SET DP030-SET-CURSOR-APPL-1                          19710006
197200                                     TO TRUE                      19720006
197300         END-IF                                                   19730006
197400     END-IF.                                                      19740006
197500                                                                  19750006
197600     IF  PS-NO-ERROR                                              19760006
197700         MOVE ASC-KEY-DEST-FCLTY-ID                               19770006
197800                                 TO DP010I-UNEDITED-FIELD         19780006
197900         MOVE LENGTH OF ASC-KEY-DEST-FCLTY-ID                     19790006
198000                                 TO DP010I-MAXIMUM-DIGITS         19800006
198100         MOVE ZERO               TO DP010I-MAXIMUM-DECIMALS       19810006
198200         SET DP010I-NEGATIVE-NOT-ALLOWED                          19820006
198300                                 TO TRUE                          19830006
273427         CALL DP010I-NUMERIC-EDIT-ROUTINE                         19841020
273427              USING DP010I-NUMERIC-EDIT-AREA                      19842020
198500         IF  DP010I-ERROR-DETECTED                                19850006
198600             SET PS-ERROR                                         19860006
198700                 DP020-MSG-FATAL TO TRUE                          19870006
198800             MOVE PC-TSYMSG-00008                                 19880006
198900                                 TO DP020-MSG-NUMBER              19890006
199000             MOVE DP015-UNP-ALP-BRT-OFF                           19900006
199100                                 TO ADFIDA                        19910006
199200             MOVE DP015-RED      TO ADFIDC                        19920006
199300             MOVE DP015-REVERSE  TO ADFIDH                        19930006
199400             MOVE -1             TO ADFIDL                        19940006
199500             SET DP030-SET-CURSOR-APPL-1                          19950006
199600                                 TO TRUE                          19960006
199700         ELSE                                                     19970006
199800             MOVE DP010I-NUMERIC-FIELD                            19980006
199900                                 TO ASC-KEY-DEST-FCLTY-ID-N       19990006
200000                                    DK-FCLTY-ID                   20000006
200100             MOVE ASC-KEY-DEST-FCLTY-ID                           20010006
200200                                 TO ADFIDO                        20020006
200300             MOVE ASC-KEY-DEST-OPER-UNT-ID                        20030006
200400                                 TO DK-OPER-UNT-ID                20040006
200500             PERFORM 3020-VALIDATE-FCLTY-ID                       20050006
200600             IF  SQLCODE = +100                                   20060006
200700                 SET PS-ERROR                                     20070006
200800                     DP020-MSG-FATAL     TO TRUE                  20080006
200900                 MOVE PC-TSYMSG-00005    TO DP020-MSG-NUMBER      20090006
201000                 MOVE DP015-UNP-ALP-BRT-OFF                       20100006
201100                                         TO ADFIDA                20110006
201200                 MOVE DP015-RED          TO ADFIDC                20120006
201300                 MOVE DP015-REVERSE      TO ADFIDH                20130006
201400                 MOVE -1                 TO ADFIDL                20140006
201500                 SET DP030-SET-CURSOR-APPL-1                      20150006
201600                                         TO TRUE                  20160006
201700             ELSE                                                 20170006
201800                 MOVE FACLTY-FCLTY-NME   TO ASC-DEST-FCLTY-NME    20180006
201900                                            ADFIDDO               20190006
202000             END-IF                                               20200006
202100         END-IF                                                   20210006
202200     END-IF.                                                      20220006
202300                                                                  20230006
202400                                                                  20240006
202500     IF  PS-NO-ERROR                                              20250006
202600         IF  ASC-SHIPT-STATUS-CDE                                 20260006
202700                        = ('AR' OR 'EN' OR 'LD' OR 'UN' OR 'ET')  20270006
202800                                                                  20280006
202900             MOVE ASC-SHIPT-STATUS-CDE                            20290006
203000                                 TO DK-SHIPT-STATUS-CDE           20300006
203100             PERFORM 4330-GET-SHIPT-STATUS-DESC                   20310006
203200             MOVE SHSTYP-DESC    TO ASC-SHIPT-STATUS-DESC         20320006
203300                                    ASTATDO                       20330006
203400         ELSE                                                     20340006
203500             SET PS-ERROR         TO TRUE                         20350006
203600             SET DP020-MSG-FATAL  TO TRUE                         20360006
203700             MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER             20370006
203800             MOVE DP015-UNP-ALP-BRT-OFF                           20380006
203900                                  TO ASTATA                       20390006
204000             MOVE DP015-RED       TO ASTATC                       20400006
204100             MOVE DP015-REVERSE   TO ASTATH                       20410006
204200             MOVE -1              TO ASTATL                       20420006
204300             SET DP030-SET-CURSOR-APPL-1                          20430006
204400                                  TO TRUE                         20440006
204500         END-IF                                                   20450006
204600     END-IF.                                                      20460006
204700                                                                  20470006
204800     IF  PS-NO-ERROR                                              20480006
204900         EVALUATE TRUE                                            20490006
205000             WHEN ASC-ADD-PENDING                                 20500006
205100                 MOVE -1           TO APROL                       20510006
205200                 SET DP030-SET-CURSOR-APPL-1                      20520006
205300                                   TO TRUE                        20530006
205400             WHEN ASC-UPDATE-PENDING                              20540006
205500                 MOVE -1           TO ASTATL                      20550006
205600                 SET DP030-SET-CURSOR-APPL-1                      20560006
205700                                   TO TRUE                        20570006
205800             WHEN ASC-DELETE-PENDING                              20580006
205900                 SET DP030-SET-CURSOR-TRAILER                     20590006
206000                                   TO TRUE                        20600006
206100         END-EVALUATE                                             20610006
206200     END-IF.                                                      20620006
206300                                                                  20630006
206400/                                                                 20640006
206500*----------------------------------------------------------------*20650006
206600*  CHECK THE OPER UNIT TABLE TO VERIFY THE OPER UNIT             *20660006
206700*  ENTERED ON THE MAP IS VALID.                                  *20670006
206800*----------------------------------------------------------------*20680006
206900                                                                  20690006
207000 3010-VALIDATE-OPER-UNT-ID.                                       20700006
207100                                                                  20710006
207200     PERFORM                                                      20720006
207300         WITH TEST AFTER                                          20730006
207400         VARYING PV-RETRY-COUNTER                                 20740006
207500         FROM 1 BY 1                                              20750006
207600         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               20760006
207700                   OR (SQLCODE = +0)                              20770006
207800                   OR (SQLCODE = +100)                            20780006
207900                   OR (SQLCODE = -811))                           20790006
208000                                                                  20800006
208100         EXEC SQL                                                 20810006
208200            SELECT  OPER_UNT_ID                                   20820006
208300              INTO :FACLTY-OPER-UNT-ID                            20830006
208400              FROM  TFACLTY                                       20840006
208500             WHERE  OPER_UNT_ID = :DK-OPER-UNT-ID                 20850006
208600         END-EXEC                                                 20860006
208700                                                                  20870006
208800         EVALUATE TRUE                                            20880006
208900             WHEN SQLCODE = +0                                    20890006
209000             WHEN SQLCODE = +100                                  20900006
209100             WHEN SQLCODE = -811                                  20910006
209200             WHEN SQLCODE = -904                                  20920006
209300             WHEN SQLCODE = -913                                  20930006
209400                 CONTINUE                                         20940006
209500                                                                  20950006
209600             WHEN SQLWARN0 NOT = SPACES                           20960006
209700             WHEN SQLCODE < +0                                    20970006
209800             WHEN SQLCODE > +0                                    20980006
209900                 MOVE '3010-VALIDATE-OPER-UNT-ID'                 20990006
210000                                 TO DP013-PARAGRAPH               21000006
210100                 MOVE 'SELECT OPER UNIT'                          21010006
210200                                 TO DP013-MESSAGE-TEXT (1)        21020006
210300                 MOVE SQLCA      TO DP013-SQLCA                   21030006
210400                 MOVE 'TFACLTY'  TO DP013-DB2-TABLE-NAME (1)      21040006
210500                 SET DP013-DB2-ABEND                              21050006
210600                                 TO TRUE                          21060006
210700                 SET DP013-XCTL-DISPLAY-RESTART                   21070006
210800                                 TO TRUE                          21080006
210900                 PERFORM DP013-0000-PROCESS-ABEND                 21090006
211000         END-EVALUATE                                             21100006
211100     END-PERFORM.                                                 21110006
211200                                                                  21120006
211300     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        21130006
211400         MOVE '3010-VALIDATE-OPER-UNT-ID'                         21140006
211500                                 TO DP013-PARAGRAPH               21150006
211600         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     21160006
211700                                 TO DP013-MESSAGE-TEXT (1)        21170006
211800         MOVE 'OPER UNIT     '   TO DP013-MESSAGE-TEXT (2)        21180006
211900         MOVE SQLCA              TO DP013-SQLCA                   21190006
212000         MOVE 'TFACLTY'          TO DP013-DB2-TABLE-NAME (1)      21200006
212100         SET DP013-DB2-ABEND     TO TRUE                          21210006
212200         SET DP013-XCTL-DISPLAY-RESTART                           21220006
212300                                 TO TRUE                          21230006
212400         PERFORM DP013-0000-PROCESS-ABEND                         21240006
212500     END-IF.                                                      21250006
212600                                                                  21260006
212700/                                                                 21270006
212800*----------------------------------------------------------------*21280006
212900*  CHECK THE FACILITY TABLE TO VERIFY THAT THE FACILITY          *21290006
213000*  ENTERED ON THE MAP IS VALID.                                  *21300006
213100*----------------------------------------------------------------*21310006
213200                                                                  21320006
213300 3020-VALIDATE-FCLTY-ID.                                          21330006
213400                                                                  21340006
213500     PERFORM                                                      21350006
213600         WITH TEST AFTER                                          21360006
213700         VARYING PV-RETRY-COUNTER                                 21370006
213800         FROM 1 BY 1                                              21380006
213900         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               21390006
214000                   OR (SQLCODE = +0)                              21400006
214100                   OR (SQLCODE = +100))                           21410006
214200                                                                  21420006
214300         EXEC SQL                                                 21430006
214400            SELECT  FCLTY_ID                                      21440006
214500                   ,FCLTY_NME                                     21450006
214600              INTO :FACLTY-FCLTY-ID                               21460006
214700                  ,:FACLTY-FCLTY-NME                              21470006
214800              FROM  TFACLTY                                       21480006
214900             WHERE  OPER_UNT_ID = :DK-OPER-UNT-ID                 21490006
215000               AND  FCLTY_ID    = :DK-FCLTY-ID                    21500006
215100         END-EXEC                                                 21510006
215200                                                                  21520006
215300         EVALUATE TRUE                                            21530006
215400             WHEN SQLCODE = +0                                    21540006
215500             WHEN SQLCODE = +100                                  21550006
215600             WHEN SQLCODE = -904                                  21560006
215700             WHEN SQLCODE = -913                                  21570006
215800                 CONTINUE                                         21580006
215900                                                                  21590006
216000             WHEN SQLWARN0 NOT = SPACES                           21600006
216100             WHEN SQLCODE < +0                                    21610006
216200             WHEN SQLCODE > +0                                    21620006
216300                 MOVE '3020-VALIDATE-FCLTY-ID'                    21630006
216400                                 TO DP013-PARAGRAPH               21640006
216500                 MOVE 'SELECT FACILITY ID '                       21650006
216600                                 TO DP013-MESSAGE-TEXT (1)        21660006
216700                 MOVE SQLCA      TO DP013-SQLCA                   21670006
216800                 MOVE 'TFACLTY'  TO DP013-DB2-TABLE-NAME (1)      21680006
216900                 SET DP013-DB2-ABEND                              21690006
217000                                 TO TRUE                          21700006
217100                 SET DP013-XCTL-DISPLAY-RESTART                   21710006
217200                                 TO TRUE                          21720006
217300                 PERFORM DP013-0000-PROCESS-ABEND                 21730006
217400         END-EVALUATE                                             21740006
217500     END-PERFORM.                                                 21750006
217600                                                                  21760006
217700     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        21770006
217800         MOVE '3020-VALIDATE-FCLTY-ID'                            21780006
217900                                 TO DP013-PARAGRAPH               21790006
218000         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     21800006
218100                                 TO DP013-MESSAGE-TEXT (1)        21810006
218200         MOVE 'FACILITY ID   '   TO DP013-MESSAGE-TEXT (2)        21820006
218300         MOVE SQLCA              TO DP013-SQLCA                   21830006
218400         MOVE 'TFACLTY'          TO DP013-DB2-TABLE-NAME (1)      21840006
218500         SET DP013-DB2-ABEND     TO TRUE                          21850006
218600         SET DP013-XCTL-DISPLAY-RESTART                           21860006
218700                                 TO TRUE                          21870006
218800         PERFORM DP013-0000-PROCESS-ABEND                         21880006
218900     END-IF.                                                      21890006
219000                                                                  21900006
219100/                                                                 21910006
219200*----------------------------------------------------------------*21920006
219300*  CHECK THE PACKAGE TYPE CODE TABLE TO VERIFY THE PACKAGE TYPE  *21930006
219400*  ENTERED IS VALID.                                             *21940006
219500*----------------------------------------------------------------*21950006
219600                                                                  21960006
219700 3030-VALIDATE-PKG-TYP-CDE.                                       21970006
219800                                                                  21980006
219900     PERFORM                                                      21990006
220000         WITH TEST AFTER                                          22000006
220100         VARYING PV-RETRY-COUNTER                                 22010006
220200         FROM 1 BY 1                                              22020006
220300         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               22030006
220400                   OR (SQLCODE = +0)                              22040006
220500                   OR (SQLCODE = +100))                           22050006
220600                                                                  22060006
220700         EXEC SQL                                                 22070006
220800            SELECT  PKG_TYP_CDE                                   22080006
220900                   ,DESC                                          22090006
221000              INTO :PKGTYP-PKG-TYP-CDE                            22100006
221100                  ,:PKGTYP-DESC                                   22110006
221200              FROM  TPKGTYP                                       22120006
221300             WHERE  PKG_TYP_CDE = :DK-PKG-TYP-CDE                 22130006
221400         END-EXEC                                                 22140006
221500                                                                  22150006
221600         EVALUATE TRUE                                            22160006
221700             WHEN SQLCODE = +0                                    22170006
221800             WHEN SQLCODE = +100                                  22180006
221900             WHEN SQLCODE = -904                                  22190006
222000             WHEN SQLCODE = -913                                  22200006
222100                 CONTINUE                                         22210006
222200                                                                  22220006
222300             WHEN SQLWARN0 NOT = SPACES                           22230006
222400             WHEN SQLCODE < +0                                    22240006
222500             WHEN SQLCODE > +0                                    22250006
222600                 MOVE '3030-VALIDATE-PKG-TYP-CDE'                 22260006
222700                                 TO DP013-PARAGRAPH               22270006
222800                 MOVE 'SELECT PACKAGE TYPE CODE'                  22280006
222900                                 TO DP013-MESSAGE-TEXT (1)        22290006
223000                 MOVE SQLCA      TO DP013-SQLCA                   22300006
223100                 MOVE 'TPKGTYP'  TO DP013-DB2-TABLE-NAME (1)      22310006
223200                 SET DP013-DB2-ABEND                              22320006
223300                                 TO TRUE                          22330006
223400                 SET DP013-XCTL-DISPLAY-RESTART                   22340006
223500                                 TO TRUE                          22350006
223600                 PERFORM DP013-0000-PROCESS-ABEND                 22360006
223700         END-EVALUATE                                             22370006
223800     END-PERFORM.                                                 22380006
223900                                                                  22390006
224000     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        22400006
224100         MOVE '3030-VALIDATE-PKG-TYP-CDE'                         22410006
224200                                 TO DP013-PARAGRAPH               22420006
224300         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     22430006
224400                                 TO DP013-MESSAGE-TEXT (1)        22440006
224500         MOVE 'PACKAGE TYPE CODE  '                               22450006
224600                                 TO DP013-MESSAGE-TEXT (2)        22460006
224700         MOVE SQLCA              TO DP013-SQLCA                   22470006
224800         MOVE 'TPKGTYP'          TO DP013-DB2-TABLE-NAME (1)      22480006
224900         SET DP013-DB2-ABEND     TO TRUE                          22490006
225000         SET DP013-XCTL-DISPLAY-RESTART                           22500006
225100                                 TO TRUE                          22510006
225200         PERFORM DP013-0000-PROCESS-ABEND                         22520006
225300     END-IF.                                                      22530006
225400                                                                  22540006
225500/                                                                 22550006
225600*----------------------------------------------------------------*22560006
225700*  CHECK THE SHIPMENT STATUS TO ENSURE IT DOES NOT CONFLICT WITH *22570006
225800*  THE TRIP STATUS.                                              *22580006
225900*----------------------------------------------------------------*22590006
226000                                                                  22600006
226100 3040-CHECK-TRIP-STATUS.                                          22610006
226200                                                                  22620006
226300     PERFORM                                                      22630006
226400         WITH TEST AFTER                                          22640006
226500         VARYING PV-RETRY-COUNTER                                 22650006
226600         FROM 1 BY 1                                              22660006
226700         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               22670006
226800                   OR (SQLCODE = +0)                              22680006
226900                   OR (SQLCODE = +100))                           22690006
227000                                                                  22700006
227100         EXEC SQL                                                 22710006
227200           SELECT B.TRIP_STATUS_CDE                               22720006
227300           INTO  :TRIPST-TRIP-STATUS-CDE                          22730006
227400           FROM   TVHTRIP A                                       22740006
227500                 ,TTRIPST B                                       22750006
227600                 ,TTRSTYP C                                       22760006
227700           WHERE  A.TRIP_ID          = :DK-TRIP-ID                22770006
227800             AND  B.TRIP_STATUS_CDE NOT IN ('DE')                 22780006
227900             AND  C.PRTY_CDE =                                    22790006
228000                  (SELECT MAX(E.PRTY_CDE)                         22800006
228100                     FROM TTRIPST D                               22810006
228200                         ,TTRSTYP E                               22820006
228300                    WHERE D.TRIP_ID         = A.TRIP_ID           22830006
228400                      AND D.TRIP_STATUS_CDE = E.TRIP_STATUS_CDE)  22840006
228500             AND  A.TRIP_ID         = B.TRIP_ID                   22850006
228600             AND  B.TRIP_STATUS_CDE = C.TRIP_STATUS_CDE           22860006
228700         END-EXEC                                                 22870006
228800                                                                  22880006
228900         EVALUATE TRUE                                            22890006
229000             WHEN SQLCODE = +0                                    22900006
229100                 MOVE TRIPST-TRIP-STATUS-CDE                      22910006
229200                                   TO ASC-TRIP-STATUS-CDE         22920006
229300                                                                  22930006
229400             WHEN SQLCODE = +100                                  22940006
229500             WHEN SQLCODE = -904                                  22950006
229600             WHEN SQLCODE = -913                                  22960006
229700                 CONTINUE                                         22970006
229800                                                                  22980006
229900             WHEN SQLWARN0 NOT = SPACES                           22990006
230000             WHEN SQLCODE < ZERO                                  23000006
230100             WHEN SQLCODE > ZERO                                  23010006
230200                 MOVE '3040-CHECK-TRIP-STATUS'                    23020006
230300                                   TO DP013-PARAGRAPH             23030006
230400                 MOVE 'SELECT TRIP STATUS'                        23040006
230500                                   TO DP013-MESSAGE-TEXT (1)      23050006
230600                 MOVE SQLCA        TO DP013-SQLCA                 23060006
230700                 MOVE 'TVHTRIP'    TO DP013-DB2-TABLE-NAME (1)    23070006
230800                 MOVE 'TTRIPST'    TO DP013-DB2-TABLE-NAME (2)    23080006
230900                 MOVE 'TTRSTYP'    TO DP013-DB2-TABLE-NAME (3)    23090006
231000                 SET DP013-DB2-ABEND                              23100006
231100                     DP013-XCTL-DISPLAY-RESTART                   23110006
231200                                   TO TRUE                        23120006
231300                 PERFORM DP013-0000-PROCESS-ABEND                 23130006
231400         END-EVALUATE                                             23140006
231500     END-PERFORM.                                                 23150006
231600                                                                  23160006
231700     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        23170006
231800         MOVE '3040-CHECK-TRIP-STATUS'                            23180006
231900                                   TO DP013-PARAGRAPH             23190006
232000         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     23200006
232100                                   TO DP013-MESSAGE-TEXT (1)      23210006
232200         MOVE 'TRIP STATUS     '   TO DP013-MESSAGE-TEXT (2)      23220006
232300         MOVE SQLCA                TO DP013-SQLCA                 23230006
232400         MOVE 'TVHTRIP'            TO DP013-DB2-TABLE-NAME (1)    23240006
232500         MOVE 'TTRIPST'            TO DP013-DB2-TABLE-NAME (2)    23250006
232600         MOVE 'TTRSTYP'            TO DP013-DB2-TABLE-NAME (3)    23260006
232700         SET DP013-DB2-ABEND                                      23270006
232800             DP013-XCTL-DISPLAY-RESTART                           23280006
232900                                   TO TRUE                        23290006
233000         PERFORM DP013-0000-PROCESS-ABEND                         23300006
233100     END-IF.                                                      23310006
233200                                                                  23320006
233300*----------------------------------------------------------------*23330006
233400* VALIDATE SHIPMENT INFO                                         *23340006
233500*----------------------------------------------------------------*23350006
233600 3050-VALIDATE-SHIPMENT.                                          23360006
233700                                                                  23370006
233710*    CLT 12-08-2011 WR40574 ADDED CARR-AUTH-ID BELOW              23371006
233800     PERFORM                                                      23380006
233900         WITH TEST AFTER                                          23390006
234000         VARYING PV-RETRY-COUNTER                                 23400006
234100         FROM 1 BY 1                                              23410006
234200         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               23420006
234300            OR (SQLCODE = +0)                                     23430006
234400            OR (SQLCODE = +100)                                   23440012
234410            OR (SQLCODE = -811))                                  23441012
234500                                                                  23450006
234600         EXEC SQL                                                 23460006
234700           SELECT DISTINCT                                        23470006
234800                  A.PRO_NBR                                       23480006
234900                 ,A.BOL_NBR                                       23490006
235000                 ,A.PRO_SCAC_ID                                   23500006
235010                 ,A.CARR_AUTH_ID                                  23501006
235100           INTO  :SHIPMT-PRO-NBR                                  23510006
235200                ,:SHIPMT-BOL-NBR                                  23520006
235300                ,:SHIPMT-PRO-SCAC-ID                              23530006
235310                ,:SHIPMT-CARR-AUTH-ID                             23531006
235400           FROM   TSHIPMT A                                       23540006
235500                 ,TSHIPST B                                       23550006
235600           WHERE  A.PRO_NBR           = :ASC-PRO-NBR              23560006
235700             AND  A.BOL_NBR           = :ASC-BOL-NBR              23570006
235800             AND  A.PRO_SCAC_ID       = :DK-PRO-SCAC-ID           23580006
235900             AND  B.SHIPT_STATUS_CDE NOT IN ('DE')                23590006
236000             AND  A.SHIPT_ID         = B.SHIPT_ID                 23600006
236100         END-EXEC                                                 23610006
236200                                                                  23620006
236300         EVALUATE TRUE                                            23630006
236400             WHEN SQLCODE = +0                                    23640006
236500             WHEN SQLCODE = +100                                  23650006
236600             WHEN SQLCODE = -904                                  23660006
236700             WHEN SQLCODE = -913                                  23670006
236800                 CONTINUE                                         23680006
236900                                                                  23690006
236901* DMH - 11/15/17 END                                              23690111
236902             WHEN SQLCODE = -811                                  23690211
236910                 SET PS-ERROR         TO TRUE                     23691011
236920                 SET DP020-MSG-FATAL  TO TRUE                     23692011
236930                 MOVE PC-TSYMSG-03803 TO DP020-MSG-NUMBER         23693011
236940                 MOVE DP015-UNP-ALP-BRT-OFF                       23694011
236950                                      TO APSCACA                  23695013
236960                 MOVE DP015-RED       TO APSCACC                  23696013
236961                                         APROC                    23696113
236962                                         ABOLC                    23696213
236970                 MOVE DP015-REVERSE   TO APSCACH                  23697013
236971                                         APROH                    23697114
236972                                         ABOLH                    23697214
236980                 MOVE -1              TO APSCACL                  23698013
236990                 SET DP030-SET-CURSOR-APPL-1                      23699011
236991                                      TO TRUE                     23699111
236992* DMH - 11/15/17 END                                              23699211
236993                                                                  23699311
237000             WHEN SQLWARN0 NOT = SPACES                           23700006
237100             WHEN SQLCODE < ZERO                                  23710006
237200             WHEN SQLCODE > ZERO                                  23720006
237300                 MOVE '3050-VALIDATE-SHIPMENT'                    23730006
237400                                   TO DP013-PARAGRAPH             23740006
237500                 MOVE 'SELECT ON TSHIPMT'                         23750006
237600                                   TO DP013-MESSAGE-TEXT (1)      23760006
237700                 MOVE SQLCA        TO DP013-SQLCA                 23770006
237800                 MOVE 'TSHIPMT'    TO DP013-DB2-TABLE-NAME (1)    23780006
237900                 MOVE 'TSHIPST'    TO DP013-DB2-TABLE-NAME (2)    23790006
238000                 SET DP013-DB2-ABEND                              23800006
238100                     DP013-XCTL-DISPLAY-RESTART                   23810006
238200                                   TO TRUE                        23820006
238300                 PERFORM DP013-0000-PROCESS-ABEND                 23830006
238400         END-EVALUATE                                             23840006
238500     END-PERFORM.                                                 23850006
238600                                                                  23860006
238700     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        23870006
238800         MOVE '3050-VALIDATE-SHIPMENT'                            23880006
238900                                   TO DP013-PARAGRAPH             23890006
239000         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     23900006
239100                                   TO DP013-MESSAGE-TEXT (1)      23910006
239200         MOVE 'A SHIPMENT ROW  '   TO DP013-MESSAGE-TEXT (2)      23920006
239300         MOVE SQLCA                TO DP013-SQLCA                 23930006
239400         MOVE 'TSHIPMT'            TO DP013-DB2-TABLE-NAME (1)    23940006
239500         MOVE 'TSHIPST'            TO DP013-DB2-TABLE-NAME (2)    23950006
239600         SET DP013-DB2-ABEND                                      23960006
239700             DP013-XCTL-DISPLAY-RESTART                           23970006
239800                                   TO TRUE                        23980006
239900         PERFORM DP013-0000-PROCESS-ABEND                         23990006
240000     END-IF.                                                      24000006
240100                                                                  24010006
240200/                                                                 24020006
240300*----------------------------------------------------------------*24030006
240400*  RESET THE ATTRIBUTES OF ALL ENTERABLE FIELDS ON THE MAP.      *24040006
240500*----------------------------------------------------------------*24050006
240600                                                                  24060006
240700 3200-RESET-ATTRIBUTES.                                           24070006
240800                                                                  24080006
240900     IF  ASC-ADD-PENDING                                          24090006
241000         MOVE DP015-UNP-ALP-NOR-OFF TO APSCACA                    24100006
241100                                       APROA                      24110006
241200                                       ABOLA                      24120006
241300                                       ATYPEA                     24130006
241400                                       AQTYA                      24140006
241500                                       AWGHTA                     24150006
241600                                       APLTA                      24160006
241700                                       ACHRGA                     24170006
241800                                       ATERMA                     24180006
241900                                       AETAMMA                    24190006
242000                                       AETADDA                    24200006
242100                                       AETAYYA                    24210006
242200                                       AETAHHA                    24220006
242300                                       AETAMNA                    24230006
242400         MOVE DP015-PRO-NOR-OFF     TO ASTATA                     24240006
242500         MOVE DP015-GREEN           TO                            24250006
242600                                       APSCACC                    24260006
242700                                       APROC                      24270006
242800                                       ABOLC                      24280006
242900                                       ATYPEC                     24290006
243000                                       AQTYC                      24300006
243100                                       AWGHTC                     24310006
243200                                       APLTC                      24320006
243300                                       ACHRGC                     24330006
243400                                       ATERMC                     24340006
243500                                       AETAMMC                    24350006
243600                                       AETADDC                    24360006
243700                                       AETAYYC                    24370006
243800                                       AETAHHC                    24380006
243900                                       AETAMNC                    24390006
244000         MOVE DP015-BLUE            TO ASTATC                     24400006
244100         MOVE DP015-UNDERLINE       TO                            24410006
244200                                       APSCACH                    24420006
244300                                       APROH                      24430006
244400                                       ABOLH                      24440006
244500*                                      ASTATH                     24450006
244600                                       ATYPEH                     24460006
244700                                       AQTYH                      24470006
244800                                       AWGHTH                     24480006
244900                                       APLTH                      24490006
245000                                       ACHRGH                     24500006
245100                                       ATERMH                     24510006
245200                                       AETAMMH                    24520006
245300                                       AETADDH                    24530006
245400                                       AETAYYH                    24540006
245500                                       AETAHHH                    24550006
245600                                       AETAMNH                    24560006
245700         IF ASC-ADD-SHIPMENT                                      24570006
245800             MOVE DP015-PRO-NOR-OFF TO ADOPERA                    24580006
245900                                       ADFIDA                     24590006
246000                                       AMANA                      24600006
246100             MOVE DP015-BLUE        TO ADOPERC                    24610006
246200                                       ADFIDC                     24620006
246300                                       AMANC                      24630006
246400         ELSE                                                     24640006
246500             MOVE DP015-UNP-ALP-NOR-OFF                           24650006
246600                                    TO ADOPERA                    24660006
246700                                       ADFIDA                     24670006
246800                                       AMANA                      24680006
246900             MOVE DP015-GREEN       TO ADOPERC                    24690006
247000                                       ADFIDC                     24700006
247100                                       AMANC                      24710006
247200             MOVE DP015-UNDERLINE   TO ADOPERH                    24720006
247300                                       ADFIDH                     24730006
247400                                       AMANH                      24740006
247500         END-IF                                                   24750006
247600     ELSE                                                         24760006
247700     IF  ASC-UPDATE-PENDING                                       24770006
247800       IF  ASC-SUSPND-UPDATE-YES                                  24780006
247900         MOVE DP015-PRO-NOR-OFF     TO ADOPERA                    24790006
248000                                       ADFIDA                     24800006
248100                                       AMANA                      24810006
248200                                       APSCACA                    24820006
248300*                                      APROA                      24830006
248400                                       ABOLA                      24840006
248500                                       ASTATA                     24850006
248600                                       ATYPEA                     24860006
248700                                       AQTYA                      24870006
248800                                       AWGHTA                     24880006
248900                                       APLTA                      24890006
249000                                       ACHRGA                     24900006
249100                                       ATERMA                     24910006
249200                                       AETAMMA                    24920006
249300                                       AETADDA                    24930006
249400                                       AETAYYA                    24940006
249500                                       AETAHHA                    24950006
249600                                       AETAMNA                    24960006
249700         MOVE DP015-BLUE            TO ADOPERC                    24970006
249800                                       ADFIDC                     24980006
249900                                       AMANC                      24990006
250000                                       APSCACC                    25000006
250100*                                      APROC                      25010006
250200                                       ABOLC                      25020006
250300                                       ASTATC                     25030006
250400                                       ATYPEC                     25040006
250500                                       AQTYC                      25050006
250600                                       AWGHTC                     25060006
250700                                       APLTC                      25070006
250800                                       ACHRGC                     25080006
250900                                       ATERMC                     25090006
251000                                       AETAMMC                    25100006
251100                                       AETADDC                    25110006
251200                                       AETAYYC                    25120006
251300                                       AETAHHC                    25130006
251400                                       AETAMNC                    25140006
251500         MOVE DP015-HL-OFF          TO ADOPERH                    25150006
251600                                       ADFIDH                     25160006
251700                                       AMANH                      25170006
251800                                       APSCACH                    25180006
251900*                                      APROH                      25190006
252000                                       ABOLH                      25200006
252100                                       ASTATH                     25210006
252200                                       ATYPEH                     25220006
252300                                       AQTYH                      25230006
252400                                       AWGHTH                     25240006
252500                                       APLTH                      25250006
252600                                       ACHRGH                     25260006
252700                                       ATERMH                     25270006
252800                                       AETAMMH                    25280006
252900                                       AETADDH                    25290006
253000                                       AETAYYH                    25300006
253100                                       AETAHHH                    25310006
253200                                       AETAMNH                    25320006
253300       ELSE                                                       25330006
253400         MOVE DP015-PRO-NOR-OFF     TO ADOPERA                    25340006
253500                                       ADFIDA                     25350006
253600                                       AMANA                      25360006
253700         MOVE DP015-UNP-ALP-NOR-OFF TO ASTATA                     25370006
253800                                       APSCACA                    25380006
253900                                       APROA                      25390006
254000                                       ABOLA                      25400006
254100                                       ATYPEA                     25410006
254200                                       AQTYA                      25420006
254300                                       AWGHTA                     25430006
254400                                       APLTA                      25440006
254500                                       ACHRGA                     25450006
254600                                       ATERMA                     25460006
254700                                       AETAMMA                    25470006
254800                                       AETADDA                    25480006
254900                                       AETAYYA                    25490006
255000                                       AETAHHA                    25500006
255100                                       AETAMNA                    25510006
255200         MOVE DP015-BLUE            TO ADOPERC                    25520006
255300                                       ADFIDC                     25530006
255400                                       AMANC                      25540006
255500         MOVE DP015-GREEN           TO ASTATC                     25550006
255600                                       APSCACC                    25560006
255700                                       APROC                      25570006
255800                                       ABOLC                      25580006
255900                                       ATYPEC                     25590006
256000                                       AQTYC                      25600006
256100                                       AWGHTC                     25610006
256200                                       APLTC                      25620006
256300                                       ACHRGC                     25630006
256400                                       ATERMC                     25640006
256500                                       AETAMMC                    25650006
256600                                       AETADDC                    25660006
256700                                       AETAYYC                    25670006
256800                                       AETAHHC                    25680006
256900                                       AETAMNC                    25690006
257000         MOVE DP015-HL-OFF          TO ADOPERH                    25700006
257100                                       ADFIDH                     25710006
257200                                       AMANH                      25720006
257300         MOVE DP015-UNDERLINE       TO ASTATH                     25730006
257400                                       APSCACH                    25740006
257500                                       APROH                      25750006
257600                                       ABOLH                      25760006
257700                                       ATYPEH                     25770006
257800                                       AQTYH                      25780006
257900                                       AWGHTH                     25790006
258000                                       APLTH                      25800006
258100                                       ACHRGH                     25810006
258200                                       ATERMH                     25820006
258300                                       AETAMMH                    25830006
258400                                       AETADDH                    25840006
258500                                       AETAYYH                    25850006
258600                                       AETAHHH                    25860006
258700                                       AETAMNH                    25870006
258800       END-IF                                                     25880006
258900     ELSE                                                         25890006
259000     IF  ASC-DELETE-PENDING                                       25900006
259100         MOVE DP015-PRO-NOR-OFF     TO ADOPERA                    25910006
259200                                       ADFIDA                     25920006
259300                                       AMANA                      25930006
259400                                       APSCACA                    25940006
259500                                       APROA                      25950006
259600                                       ABOLA                      25960006
259700                                       ASTATA                     25970006
259800                                       ATYPEA                     25980006
259900                                       AQTYA                      25990006
260000                                       AWGHTA                     26000006
260100                                       APLTA                      26010006
260200                                       ACHRGA                     26020006
260300                                       ATERMA                     26030006
260400                                       AETAMMA                    26040006
260500                                       AETADDA                    26050006
260600                                       AETAYYA                    26060006
260700                                       AETAHHA                    26070006
260800                                       AETAMNA                    26080006
260900         MOVE DP015-BLUE            TO ADOPERC                    26090006
261000                                       ADFIDC                     26100006
261100                                       AMANC                      26110006
261200                                       APSCACC                    26120006
261300                                       APROC                      26130006
261400                                       ABOLC                      26140006
261500                                       ASTATC                     26150006
261600                                       ATYPEC                     26160006
261700                                       AQTYC                      26170006
261800                                       AWGHTC                     26180006
261900                                       APLTC                      26190006
262000                                       ACHRGC                     26200006
262100                                       ATERMC                     26210006
262200                                       AETAMMC                    26220006
262300                                       AETADDC                    26230006
262400                                       AETAYYC                    26240006
262500                                       AETAHHC                    26250006
262600                                       AETAMNC                    26260006
262700         MOVE DP015-HL-OFF          TO ADOPERH                    26270006
262800                                       ADFIDH                     26280006
262900                                       AMANH                      26290006
263000                                       APSCACH                    26300006
263100                                       APROH                      26310006
263200                                       ABOLH                      26320006
263300                                       ASTATH                     26330006
263400                                       ATYPEH                     26340006
263500                                       AQTYH                      26350006
263600                                       AWGHTH                     26360006
263700                                       APLTH                      26370006
263800                                       ACHRGH                     26380006
263900                                       ATERMH                     26390006
264000                                       AETAMMH                    26400006
264100                                       AETADDH                    26410006
264200                                       AETAYYH                    26420006
264300                                       AETAHHH                    26430006
264400                                       AETAMNH.                   26440006
264500                                                                  26450006
264600/                                                                 26460006
264700*----------------------------------------------------------------*26470006
264800*    SAVE SCREEN FIELDS FOR LATER COMPARISONS                    *26480006
264900*----------------------------------------------------------------*26490006
265000                                                                  26500006
265100 3500-SAVE-SCREEN-FIELDS.                                         26510006
265200                                                                  26520006
265300     MOVE ASC-SHIPT-STATUS-CDE   TO ASC-SHIPT-STATUS-CDE-OLD.     26530006
265400     MOVE ASC-PKG-TYP-CDE        TO ASC-PKG-TYP-CDE-OLD.          26540006
265500     MOVE ASC-PKG-QTY-N          TO ASC-PKG-QTY-N-OLD.            26550006
265600     MOVE ASC-GROSS-WGHT-N       TO ASC-GROSS-WGHT-N-OLD.         26560006
265700     MOVE ASC-PLT-QTY-N          TO ASC-PLT-QTY-N-OLD.            26570006
265800     MOVE ASC-FRGT-CHRG-N        TO ASC-FRGT-CHRG-N-OLD.          26580006
265900     MOVE ASC-FRGT-TERM          TO ASC-FRGT-TERM-OLD.            26590006
266000     MOVE ASC-ETA-DTE            TO ASC-ETA-DTE-OLD.              26600008
266100     MOVE ASC-KEY-PRO-SCAC-ID    TO ASC-PRO-SCAC-ID-OLD.          26610006
266200     MOVE ASC-KEY-PRO-NBR        TO ASC-PRO-NBR-OLD.              26620006
266300     MOVE ASC-KEY-BOL-NBR        TO ASC-BOL-NBR-OLD.              26630006
266310*    CLT 12-08-2011 START WR40574                                 26631006
266320     MOVE ASC-CAN                TO ASC-CAN-OLD.                  26632006
266330*    CLT 12-08-2011 END   WR40574                                 26633006
266400                                                                  26640006
266500/                                                                 26650006
266600*----------------------------------------------------------------*26660006
266700*  CHECK TO SEE IF ANY FIELDS CHANGED.                           *26670006
266800*----------------------------------------------------------------*26680006
266900                                                                  26690006
267000 3600-CHECK-IF-FIELDS-CHANGED.                                    26700006
267100                                                                  26710006
267200     MOVE 'N'                    TO ASC-FIELDS-CHANGED-SW.        26720006
267300                                                                  26730006
267400     IF  ASC-SHIPT-STATUS-CDE = ASC-SHIPT-STATUS-CDE-OLD          26740006
267500     AND ASC-PKG-TYP-CDE      = ASC-PKG-TYP-CDE-OLD               26750006
267600     AND ASC-PKG-QTY-N        = ASC-PKG-QTY-N-OLD                 26760006
267700     AND ASC-GROSS-WGHT-N     = ASC-GROSS-WGHT-N-OLD              26770006
267800     AND ASC-PLT-QTY-N        = ASC-PLT-QTY-N-OLD                 26780006
267900     AND ASC-FRGT-CHRG-N      = ASC-FRGT-CHRG-N-OLD               26790006
268000     AND ASC-FRGT-TERM        = ASC-FRGT-TERM-OLD                 26800006
268100     AND ASC-KEY-PRO-SCAC-ID  = ASC-PRO-SCAC-ID-OLD               26810006
268200     AND ASC-KEY-PRO-NBR      = ASC-PRO-NBR-OLD                   26820006
268300     AND ASC-KEY-BOL-NBR      = ASC-BOL-NBR-OLD                   26830006
268301*    CLT 12-08-2011 START WR40574                                 26830106
268310     AND ASC-CAN              = ASC-CAN-OLD                       26831006
268320*    CLT 12-08-2011 END   WR40574                                 26832006
268400     AND ASC-ETA-DTE          = ASC-ETA-DTE-OLD                   26840006
268500     AND ASC-ETA-TIME         = ASC-ETA-TIME-OLD                  26850006
268600         CONTINUE                                                 26860006
268700     ELSE                                                         26870006
268800         SET ASC-FIELDS-CHANGED  TO TRUE                          26880006
268900     END-IF.                                                      26890006
269000                                                                  26900006
269100/                                                                 26910006
269200*----------------------------------------------------------------*26920006
269300*    VALIDATE THE QUEUE WAS PASSED AND DISPLAY FOR THE FIRST     *26930006
269400*    ENTRY.                                                      *26940006
269500*----------------------------------------------------------------*26950006
269600                                                                  26960006
269700 4000-BUILD-INITIAL-PANEL.                                        26970006
269800                                                                  26980006
269900     INITIALIZE DCLTSHIPMT                                        26990006
270000                ASC-SCREEN-FIELDS.                                27000006
270100                                                                  27010006
270200     MOVE ASC-KEY-DEST-OPER-UNT-ID TO DK-OPER-UNT-ID.             27020006
270300     MOVE ASC-KEY-DEST-FCLTY-ID    TO DK-FCLTY-ID.                27030006
270400     MOVE ASC-KEY-OWNER-SCAC-ID    TO DK-OWNER-SCAC-ID.           27040006
270500     MOVE ASC-KEY-VEH-NBR          TO DK-VEH-NBR.                 27050006
270600     MOVE ASC-KEY-MANIFEST-NBR     TO DK-MANIFEST-NBR.            27060006
270700     MOVE ASC-KEY-SHIPT-ID         TO DK-SHIPT-ID.                27070006
270800     MOVE ASC-KEY-TRIP-ID          TO DK-TRIP-ID.                 27080006
270900                                                                  27090006
271000     IF  ASC-ADD-PENDING                                          27100006
271100         EXEC CICS ASKTIME                                        27110006
271200              ABSTIME (PV-ABSTIME)                                27120006
271300         END-EXEC                                                 27130006
271400         EXEC CICS FORMATTIME                                     27140006
271500              ABSTIME (PV-ABSTIME)                                27150006
271600              DATESEP ('-') YYMMDD  (ASC-ETA-YY-MM-DD)            27160006
271700              TIME (ASC-ETA-TIME) TIMESEP                         27170006
271800         END-EXEC                                                 27180006
271900         IF ASC-ETA-DTE-YY > 60                                   27190006
272000             MOVE '19'             TO ASC-ETA-DTE-CC              27200006
272100         ELSE                                                     27210006
272200             MOVE '20'             TO ASC-ETA-DTE-CC              27220006
272300         END-IF                                                   27230006
272400                                                                  27240006
272500         MOVE ASC-ETA-DTE          TO ASC-ETA-DTE-OLD             27250006
272600         MOVE ASC-ETA-TIME         TO ASC-ETA-TIME-OLD            27260006
272700     END-IF.                                                      27270006
272800                                                                  27280006
272900     PERFORM 4200-SELECT-TFACLTY.                                 27290006
273000     MOVE FACLTY-FCLTY-NME       TO ASC-DEST-FCLTY-NME.           27300006
273100                                                                  27310006
273200     PERFORM 4120-SELECT-TVHTRIP.                                 27320006
273300     IF  SQLCODE = +0                                             27330006
273400         IF  DN-TRIP-EST-AR-TMST = -1                             27340006
273500             CONTINUE                                             27350006
273600         ELSE                                                     27360006
273700             MOVE VHTRIP-EST-AR-TMST                              27370006
273800                                TO PV-EST-DATE-TIME               27380006
273900             MOVE PV-EST-DATE   TO ASC-ETA-DTE                    27390006
274000             MOVE PV-EST-TIME   TO ASC-ETA-TIME                   27400006
274100         END-IF                                                   27410006
274200         MOVE TRIPST-TRIP-STATUS-CDE                              27420006
274300                                TO ASC-SHIPT-STATUS-CDE           27430006
274400     ELSE                                                         27440006
274500         SET ASC-ADD-OPEN-SHIPMENT                                27450006
274600                                TO TRUE                           27460006
274700     END-IF.                                                      27470006
274800                                                                  27480006
274900     PERFORM 4100-SELECT-TSHIPMT.                                 27490006
275000                                                                  27500006
275100     IF  SQLCODE = +0                                             27510006
275200         MOVE ASC-KEY-OWNER-SCAC-ID                               27520006
275300                                 TO DK-OWNER-SCAC-ID              27530006
275400         PERFORM 4310-GET-ENT-NAME-DESC                           27540006
275500         MOVE ENTNME-ENT-NAME-DESC                                27550006
275600                                 TO ASC-OWNER-SCAC-ID-DESC        27560006
275700         MOVE ASC-KEY-PRO-SCAC-ID                                 27570006
275800                                 TO DK-OWNER-SCAC-ID              27580006
275900         PERFORM 4310-GET-ENT-NAME-DESC                           27590006
276000         MOVE ENTNME-ENT-NAME-DESC                                27600006
276100                                 TO ASC-PRO-SCAC-ID-DESC          27610006
276200         MOVE ASC-PKG-TYP-CDE    TO DK-PKG-TYP-CDE                27620006
276300         PERFORM 4320-GET-PKG-TYP-DESC                            27630006
276400         MOVE PKGTYP-DESC        TO ASC-PKG-TYP-CDE-DESC          27640006
276500         IF  SHSTYP-PRTY-CDE < '10'                               27650006
276600         OR  SHSTYP-PRTY-CDE > '20' AND < '49'                    27660006
276700             MOVE 'EN'           TO ASC-SHIPT-STATUS-CDE          27670006
276800         ELSE                                                     27680006
276900             IF  SHSTYP-PRTY-CDE = '49'                           27690006
277000                 MOVE 'AR'       TO ASC-SHIPT-STATUS-CDE          27700006
277100             END-IF                                               27710006
277200         END-IF                                                   27720006
277300         MOVE ASC-SHIPT-STATUS-CDE                                27730006
277400                                 TO DK-SHIPT-STATUS-CDE           27740006
277500         PERFORM 4330-GET-SHIPT-STATUS-DESC                       27750006
277600         MOVE SHSTYP-DESC        TO ASC-SHIPT-STATUS-DESC         27760006
277700         EVALUATE ASC-FRGT-TERM                                   27770006
277800           WHEN 'C'                                               27780006
277900             MOVE 'COLLECT'      TO ASC-FRGT-TERM-DESC            27790006
278000           WHEN 'P'                                               27800006
278100             MOVE 'PREPAID'      TO ASC-FRGT-TERM-DESC            27810006
278200           WHEN 'F'                                               27820006
278300             MOVE 'FREEASTRAY'   TO ASC-FRGT-TERM-DESC            27830006
278400         END-EVALUATE                                             27840006
278500     END-IF.                                                      27850006
278600                                                                  27860006
278700     IF  ASC-ADD-PENDING                                          27870006
278800         MOVE 'CTN'              TO ASC-PKG-TYP-CDE               27880006
278900         IF  ASC-ADD-OPEN-SHIPMENT                                27890006
279000             MOVE 'EN'           TO ASC-SHIPT-STATUS-CDE          27900006
279100         END-IF                                                   27910006
279200     END-IF.                                                      27920006
279300                                                                  27930006
279400     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        27940006
279500                                                                  27950006
279600/                                                                 27960006
279700*----------------------------------------------------------------*27970006
279800* SELECT A SHIPMENT                                              *27980006
279900*----------------------------------------------------------------*27990006
280000 4100-SELECT-TSHIPMT.                                             28000006
280100* CLT 12-08-2011 WR40574 CARR-AUTH-ID ADDED BELOW                 28010006
280200     PERFORM                                                      28020006
280300         WITH TEST AFTER                                          28030006
280400         VARYING PV-RETRY-COUNTER                                 28040006
280500         FROM 1 BY 1                                              28050006
280600         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               28060006
280700            OR (SQLCODE = +0)                                     28070006
280800            OR (SQLCODE = +100))                                  28080006
280900                                                                  28090006
281000         EXEC SQL                                                 28100006
281100           SELECT A.TRIP_ID                                       28110006
281200                 ,A.PRO_SCAC_ID                                   28120006
281300                 ,A.PRO_NBR                                       28130006
281400                 ,A.BOL_NBR                                       28140006
281500                 ,A.PKG_TYP_CDE                                   28150006
281600                 ,A.EXPTED_PKG_QTY                                28160006
281700                 ,A.EXPTED_GRO_WGHT                               28170006
281800                 ,A.EXPTED_PLT_QTY                                28180006
281900                 ,A.FRGT_CHG_AMT                                  28190006
282000                 ,A.FRGT_TERMS_CDE                                28200006
282100                 ,A.EST_AR_TMST                                   28210006
282200                 ,A.CARR_CART_CT                                  28220006
282300                 ,A.VEND_CART_CT                                  28230006
282400                 ,B.SHIPT_STATUS_CDE                              28240006
282500                 ,C.PRTY_CDE                                      28250006
282510                 ,A.CARR_AUTH_ID                                  28251006
282600           INTO  :SHIPMT-TRIP-ID                                  28260006
282700                ,:SHIPMT-PRO-SCAC-ID                              28270006
282800                ,:SHIPMT-PRO-NBR                                  28280006
282900                ,:SHIPMT-BOL-NBR                                  28290006
283000                ,:SHIPMT-PKG-TYP-CDE                              28300006
283100                ,:SHIPMT-EXPTED-PKG-QTY                           28310006
283200                ,:SHIPMT-EXPTED-GRO-WGHT                          28320006
283300                ,:SHIPMT-EXPTED-PLT-QTY                           28330006
283400                ,:SHIPMT-FRGT-CHG-AMT                             28340006
283500                ,:SHIPMT-FRGT-TERMS-CDE                           28350006
283600                ,:SHIPMT-EST-AR-TMST                              28360006
283700                     :DN-SHIP-EST-AR-TMST                         28370006
283800                ,:SHIPMT-CARR-CART-CT                             28380006
283900                ,:SHIPMT-VEND-CART-CT                             28390006
284000                ,:SHIPST-SHIPT-STATUS-CDE                         28400006
284100                ,:SHSTYP-PRTY-CDE                                 28410006
284110                ,:SHIPMT-CARR-AUTH-ID                             28411006
284200           FROM   TSHIPMT A                                       28420006
284300                 ,TSHIPST B                                       28430006
284400                 ,TSHSTYP C                                       28440006
284500           WHERE  A.SHIPT_ID          = :DK-SHIPT-ID              28450006
284600             AND  B.SHIPT_STATUS_CDE NOT IN ('DE')                28460006
284700             AND  C.PRTY_CDE =                                    28470006
284800                  (SELECT MAX(E.PRTY_CDE)                         28480006
284900                   FROM TSHIPST D, TSHSTYP E                      28490006
285000                   WHERE D.SHIPT_ID = A.SHIPT_ID                  28500006
285100                     AND D.SHIPT_STATUS_CDE = E.SHIPT_STATUS_CDE) 28510006
285200             AND  A.SHIPT_ID         = B.SHIPT_ID                 28520006
285300             AND  B.SHIPT_STATUS_CDE = C.SHIPT_STATUS_CDE         28530006
285400         END-EXEC                                                 28540006
285500                                                                  28550006
285600         EVALUATE TRUE                                            28560006
285700             WHEN SQLCODE = +0                                    28570006
285800                  MOVE SHIPMT-TRIP-ID                             28580006
285900                                 TO ASC-KEY-TRIP-ID               28590006
286000                  MOVE SHIPMT-PRO-SCAC-ID                         28600006
286100                                 TO ASC-KEY-PRO-SCAC-ID           28610006
286200                  MOVE SHIPMT-PRO-NBR                             28620006
286300                                 TO ASC-KEY-PRO-NBR               28630006
286400                  MOVE SHIPMT-COMPLETE-PRO-NBR                    28640006
286500                                 TO ASC-KEY-COMP-PRO-NBR          28650006
286600                  MOVE SHIPMT-BOL-NBR                             28660006
286700                                 TO ASC-KEY-BOL-NBR               28670006
286710* CLT 12-08-2011 WR40574 START                                    28671006
286720                  MOVE SHIPMT-CARR-AUTH-ID                        28672006
286730                                 TO ASC-CAN                       28673007
286740* CLT 12-08-2011 WR40574 END                                      28674006
286800                  MOVE SHIPMT-COMPLETE-BOL-NBR                    28680006
286900                                 TO ASC-KEY-COMP-BOL-NBR          28690006
287000                  MOVE SHIPMT-PKG-TYP-CDE                         28700006
287100                                 TO ASC-PKG-TYP-CDE               28710006
287200                  IF SHIPMT-EXPTED-PKG-QTY > 0                    28720006
287300                      MOVE SHIPMT-EXPTED-PKG-QTY                  28730006
287400                                 TO ASC-PKG-QTY-N                 28740006
287500                  ELSE                                            28750006
287600                      IF SHIPMT-CARR-CART-CT > 0                  28760006
287700                          MOVE SHIPMT-CARR-CART-CT                28770006
287800                                     TO ASC-PKG-QTY-N             28780006
287900                      ELSE                                        28790006
288000                          MOVE SHIPMT-VEND-CART-CT                28800006
288100                                     TO ASC-PKG-QTY-N             28810006
288200                      END-IF                                      28820006
288300                  END-IF                                          28830006
288400                  MOVE SHIPMT-EXPTED-GRO-WGHT                     28840006
288500                                 TO ASC-GROSS-WGHT-N              28850006
288600                  MOVE SHIPMT-EXPTED-PLT-QTY                      28860006
288700                                 TO ASC-PLT-QTY-N                 28870006
288800                  MOVE SHIPMT-FRGT-CHG-AMT                        28880006
288900                                 TO ASC-FRGT-CHRG-N               28890006
289000                  MOVE SHIPMT-FRGT-TERMS-CDE                      28900006
289100                                 TO ASC-FRGT-TERM                 28910006
289200                  MOVE SHIPST-SHIPT-STATUS-CDE                    28920006
289300                                 TO ASC-SHIPT-STATUS-CDE          28930006
289400                 IF  DN-SHIP-EST-AR-TMST = -1                     28940006
289500                     IF  DN-TRIP-EST-AR-TMST = -1                 28950006
289600                        MOVE SPACES  TO PV-EST-DATE-TIME          28960006
289700                     ELSE                                         28970006
289800                         MOVE VHTRIP-EST-AR-TMST                  28980006
289900                                    TO PV-EST-DATE-TIME           28990006
290000                     END-IF                                       29000006
290100                 ELSE                                             29010006
290200                     MOVE SHIPMT-EST-AR-TMST                      29020006
290300                                  TO PV-EST-DATE-TIME             29030006
290400                 END-IF                                           29040006
290500                 MOVE PV-EST-DATE TO ASC-ETA-DTE                  29050006
290600                 MOVE PV-EST-TIME TO ASC-ETA-TIME                 29060006
290700                                                                  29070006
290800             WHEN SQLCODE = +100                                  29080006
290900             WHEN SQLCODE = -904                                  29090006
291000             WHEN SQLCODE = -913                                  29100006
291100                 CONTINUE                                         29110006
291200                                                                  29120006
291300             WHEN SQLWARN0 NOT = SPACES                           29130006
291400             WHEN SQLCODE < ZERO                                  29140006
291500             WHEN SQLCODE > ZERO                                  29150006
291600                 MOVE '4100-SELECT-TSHIPMT'                       29160006
291700                                   TO DP013-PARAGRAPH             29170006
291800                 MOVE 'SELECT ON TSHIPMT'                         29180006
291900                                   TO DP013-MESSAGE-TEXT (1)      29190006
292000                 MOVE SQLCA        TO DP013-SQLCA                 29200006
292100                 MOVE 'TSHIPMT'    TO DP013-DB2-TABLE-NAME (1)    29210006
292200                 MOVE 'TSHIPST'    TO DP013-DB2-TABLE-NAME (2)    29220006
292300                 SET DP013-DB2-ABEND                              29230006
292400                     DP013-XCTL-DISPLAY-RESTART                   29240006
292500                                   TO TRUE                        29250006
292600                 PERFORM DP013-0000-PROCESS-ABEND                 29260006
292700         END-EVALUATE                                             29270006
292800     END-PERFORM.                                                 29280006
292900                                                                  29290006
293000     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        29300006
293100         MOVE '4100-SELECT-TSHIPMT'                               29310006
293200                                   TO DP013-PARAGRAPH             29320006
293300         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     29330006
293400                                   TO DP013-MESSAGE-TEXT (1)      29340006
293500         MOVE 'A SHIPMENT ROW  '   TO DP013-MESSAGE-TEXT (2)      29350006
293600         MOVE SQLCA                TO DP013-SQLCA                 29360006
293700         MOVE 'TSHIPMT'            TO DP013-DB2-TABLE-NAME (1)    29370006
293800         MOVE 'TSHIPST'            TO DP013-DB2-TABLE-NAME (2)    29380006
293900         SET DP013-DB2-ABEND                                      29390006
294000             DP013-XCTL-DISPLAY-RESTART                           29400006
294100                                   TO TRUE                        29410006
294200         PERFORM DP013-0000-PROCESS-ABEND                         29420006
294300     END-IF.                                                      29430006
294400                                                                  29440006
294500/                                                                 29450006
294600*----------------------------------------------------------------*29460006
294700* SELECT THE MOST RECENT TRIP MADE BY A VEHICLE                  *29470006
294800*----------------------------------------------------------------*29480006
294900 4120-SELECT-TVHTRIP.                                             29490006
295000                                                                  29500006
295100     PERFORM                                                      29510006
295200         WITH TEST AFTER                                          29520006
295300         VARYING PV-RETRY-COUNTER                                 29530006
295400         FROM 1 BY 1                                              29540006
295500         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               29550006
295600            OR (SQLCODE = +0)                                     29560006
295700            OR (SQLCODE = +100))                                  29570006
295800                                                                  29580006
295900         EXEC SQL                                                 29590006
296000           SELECT A.EST_AR_TMST                                   29600006
296100                 ,B.TRIP_STATUS_CDE                               29610006
296200           INTO  :VHTRIP-EST-AR-TMST                              29620006
296300                   :DN-TRIP-EST-AR-TMST                           29630006
296400                ,:TRIPST-TRIP-STATUS-CDE                          29640006
296500           FROM   TVHTRIP A                                       29650006
296600                 ,TTRIPST B                                       29660006
296700                 ,TTRSTYP C                                       29670006
296800           WHERE  A.TRIP_ID          = :DK-TRIP-ID                29680006
296900             AND  B.TRIP_STATUS_CDE NOT IN ('DE')                 29690006
297000             AND  C.PRTY_CDE =                                    29700006
297100                  (SELECT MAX(E.PRTY_CDE)                         29710006
297200                     FROM TTRIPST D                               29720006
297300                         ,TTRSTYP E                               29730006
297400                    WHERE D.TRIP_ID         = A.TRIP_ID           29740006
297500                      AND D.TRIP_STATUS_CDE = E.TRIP_STATUS_CDE)  29750006
297600             AND  A.TRIP_ID         = B.TRIP_ID                   29760006
297700             AND  B.TRIP_STATUS_CDE = C.TRIP_STATUS_CDE           29770006
297800         END-EXEC                                                 29780006
297900                                                                  29790006
298000         EVALUATE TRUE                                            29800006
298100             WHEN SQLCODE = +0                                    29810006
298200             WHEN SQLCODE = +100                                  29820006
298300             WHEN SQLCODE = -904                                  29830006
298400             WHEN SQLCODE = -913                                  29840006
298500                 CONTINUE                                         29850006
298600                                                                  29860006
298700             WHEN SQLWARN0 NOT = SPACES                           29870006
298800             WHEN SQLCODE < ZERO                                  29880006
298900             WHEN SQLCODE > ZERO                                  29890006
299000                 MOVE '4120-SELECT-TVHTRIP'                       29900006
299100                                   TO DP013-PARAGRAPH             29910006
299200                 MOVE 'SELECT TRIP INFO  '                        29920006
299300                                   TO DP013-MESSAGE-TEXT (1)      29930006
299400                 MOVE SQLCA        TO DP013-SQLCA                 29940006
299500                 MOVE 'TVHTRIP'    TO DP013-DB2-TABLE-NAME (1)    29950006
299600                 MOVE 'TTRIPST'    TO DP013-DB2-TABLE-NAME (2)    29960006
299700                 SET DP013-DB2-ABEND                              29970006
299800                     DP013-XCTL-DISPLAY-RESTART                   29980006
299900                                   TO TRUE                        29990006
300000                 PERFORM DP013-0000-PROCESS-ABEND                 30000006
300100         END-EVALUATE                                             30010006
300200     END-PERFORM.                                                 30020006
300300                                                                  30030006
300400     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        30040006
300500         MOVE '4120-SELECT-TVHTRIP'                               30050006
300600                                   TO DP013-PARAGRAPH             30060006
300700         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     30070006
300800                                   TO DP013-MESSAGE-TEXT (1)      30080006
300900         MOVE 'TRIP INFO       '   TO DP013-MESSAGE-TEXT (2)      30090006
301000         MOVE SQLCA                TO DP013-SQLCA                 30100006
301100         MOVE 'TVHTRIP'            TO DP013-DB2-TABLE-NAME (1)    30110006
301200         MOVE 'TTRIPST'            TO DP013-DB2-TABLE-NAME (2)    30120006
301300         SET DP013-DB2-ABEND                                      30130006
301400             DP013-XCTL-DISPLAY-RESTART                           30140006
301500                                   TO TRUE                        30150006
301600         PERFORM DP013-0000-PROCESS-ABEND                         30160006
301700     END-IF.                                                      30170006
301800                                                                  30180006
301900/                                                                 30190006
302000*----------------------------------------------------------------*30200006
302100*    GET FACILITY NAME                                           *30210006
302200*----------------------------------------------------------------*30220006
302300                                                                  30230006
302400 4200-SELECT-TFACLTY.                                             30240006
302500                                                                  30250006
302600     PERFORM                                                      30260006
302700         WITH TEST AFTER                                          30270006
302800         VARYING PV-RETRY-COUNTER                                 30280006
302900         FROM 1 BY 1                                              30290006
303000         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               30300006
303100            OR  (SQLCODE = +100)                                  30310006
303200            OR  (SQLCODE = +0))                                   30320006
303300                                                                  30330006
303400         EXEC SQL                                                 30340006
303500             SELECT  FCLTY_NME                                    30350006
303600               INTO :FACLTY-FCLTY-NME                             30360006
303700              FROM  TFACLTY                                       30370006
303800             WHERE  OPER_UNT_ID = :DK-OPER-UNT-ID                 30380006
303900               AND  FCLTY_ID    = :DK-FCLTY-ID                    30390006
304000         END-EXEC                                                 30400006
304100                                                                  30410006
304200         EVALUATE TRUE                                            30420006
304300             WHEN SQLCODE = +0                                    30430006
304400             WHEN SQLCODE = +100                                  30440006
304500             WHEN SQLCODE = -904                                  30450006
304600             WHEN SQLCODE = -913                                  30460006
304700                  CONTINUE                                        30470006
304800                                                                  30480006
304900             WHEN SQLWARN0 NOT = SPACE                            30490006
305000             WHEN SQLCODE < +0                                    30500006
305100             WHEN SQLCODE > +0                                    30510006
305200                  MOVE '4200-SELECT-TFACLTY'                      30520006
305300                                   TO DP013-PARAGRAPH             30530006
305400                  MOVE 'SELECT ON TFACLTY'                        30540006
305500                                   TO DP013-MESSAGE-TEXT (1)      30550006
305600                  MOVE SQLCA       TO DP013-SQLCA                 30560006
305700                  MOVE 'TFACLTY'   TO DP013-DB2-TABLE-NAME (1)    30570006
305800                  SET DP013-DB2-ABEND                             30580006
305900                      DP013-XCTL-DISPLAY-RESTART                  30590006
306000                                   TO TRUE                        30600006
306100                  PERFORM DP013-0000-PROCESS-ABEND                30610006
306200         END-EVALUATE                                             30620006
306300     END-PERFORM.                                                 30630006
306400                                                                  30640006
306500     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        30650006
306600         MOVE '4200-SELECT-TFACLTY'                               30660006
306700                                   TO DP013-PARAGRAPH             30670006
306800         MOVE 'MAX RETRIES EXCEEDED FOR SELECT'                   30680006
306900                                   TO DP013-MESSAGE-TEXT (1)      30690006
307000         MOVE 'ON TABLE TFACLTY '  TO DP013-MESSAGE-TEXT (2)      30700006
307100         MOVE SQLCA                TO DP013-SQLCA                 30710006
307200         SET DP013-DB2-ABEND                                      30720006
307300             DP013-XCTL-DISPLAY-RESTART                           30730006
307400                                   TO TRUE                        30740006
307500         PERFORM DP013-0000-PROCESS-ABEND                         30750006
307600     END-IF.                                                      30760006
307700                                                                  30770006
307800/                                                                 30780006
307900*----------------------------------------------------------------*30790006
308000*    VALIDATE THE TRAILER                                        *30800006
308100*----------------------------------------------------------------*30810006
308200 4300-VALIDATE-TRAILER.                                           30820006
308300                                                                  30830006
308400     PERFORM                                                      30840006
308500         WITH TEST AFTER                                          30850006
308600         VARYING PV-RETRY-COUNTER                                 30860006
308700         FROM 1 BY 1                                              30870006
308800         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               30880006
308900             OR (SQLCODE = +0)                                    30890006
309000             OR (SQLCODE = +100))                                 30900006
309100                                                                  30910006
309200         EXEC SQL                                                 30920006
309300              SELECT CURR_TRIP_ID                                 30930006
309400                   , VEH_TYP_CDE                                  30940006
309500                INTO :VEHICL-CURR-TRIP-ID                         30950006
309600                        :DN-CURR-TRIP-ID                          30960006
309700                   , :VEHICL-VEH-TYP-CDE                          30970006
309800                FROM TVEHICL                                      30980006
309900               WHERE OWNER_SCAC_ID = :DK-OWNER-SCAC-ID            30990006
310000                 AND VEH_NBR       = :DK-VEH-NBR                  31000006
310100         END-EXEC                                                 31010006
310200                                                                  31020006
310300         EVALUATE TRUE                                            31030006
310400             WHEN SQLCODE = +0                                    31040006
310500                  IF ASC-SHIPT-STATUS-CDE = 'ET'                  31050006
310600                     SET ASC-VEHICLE-SETUP-PREV  TO TRUE          31060006
310700                  ELSE                                            31070006
310800                     IF  DN-CURR-TRIP-ID = -1                     31080006
310900                        SET ASC-VEHICLE-NULL-TRIP                 31090006
311000                                     TO TRUE                      31100006
311100                     ELSE                                         31110006
311200                        SET ASC-VEHICLE-SETUP-PREV                31120006
311300                                     TO TRUE                      31130006
311400                     END-IF                                       31140006
311500                  END-IF                                          31150006
311600                  MOVE VEHICL-VEH-TYP-CDE TO ASC-KEY-VEH-TYP-CDE  31160006
311700             WHEN SQLCODE = +100                                  31170006
311800             WHEN SQLCODE = -904                                  31180006
311900             WHEN SQLCODE = -913                                  31190006
312000                  CONTINUE                                        31200006
312100                                                                  31210006
312200             WHEN SQLWARN0 NOT = SPACES                           31220006
312300             WHEN SQLCODE < +0                                    31230006
312400             WHEN SQLCODE > +0                                    31240006
312500                  MOVE '4300-VALIDATE-TRAILER'                    31250006
312600                                  TO DP013-PARAGRAPH              31260006
312700                  MOVE 'UNSUCCESSFUL SELECT ON TVEHICL TABLE'     31270006
312800                                  TO DP013-MESSAGE-TEXT (1)       31280006
312900                  MOVE SQLCA      TO DP013-SQLCA                  31290006
313000                  MOVE 'TVEHICL ' TO DP013-DB2-TABLE-NAME (1)     31300006
313100                  SET DP013-DB2-ABEND                             31310006
313200                      DP013-XCTL-DISPLAY-RESTART                  31320006
313300                                  TO TRUE                         31330006
313400                  PERFORM DP013-0000-PROCESS-ABEND                31340006
313500         END-EVALUATE                                             31350006
313600     END-PERFORM.                                                 31360006
313700                                                                  31370006
313800     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        31380006
313900         MOVE '4300-VALIDATE-TRAILER'                             31390006
314000                                  TO DP013-PARAGRAPH              31400006
314100         MOVE 'MAX RETRIES EXCEEDED '                             31410006
314200                                  TO DP013-MESSAGE-TEXT (1)       31420006
314300         MOVE SQLCA               TO DP013-SQLCA                  31430006
314400         MOVE 'TEXTENT'           TO DP013-DB2-TABLE-NAME (1)     31440006
314500         MOVE 'TENTNME'           TO DP013-DB2-TABLE-NAME (2)     31450006
314600         SET DP013-DB2-ABEND                                      31460006
314700             DP013-XCTL-DISPLAY-RESTART                           31470006
314800                                  TO TRUE                         31480006
314900         PERFORM DP013-0000-PROCESS-ABEND                         31490006
315000     END-IF.                                                      31500006
315100                                                                  31510006
315200                                                                  31520006
315300/                                                                 31530006
315400*----------------------------------------------------------------*31540006
315500*    GET THE ENTERPRISE NAME DESC                                *31550006
315600*----------------------------------------------------------------*31560006
315610*    CLT 12-08-2011 WR40574 ADDED WITH UT      BELOW              31561010
315700 4310-GET-ENT-NAME-DESC.                                          31570006
315800                                                                  31580006
315900     PERFORM                                                      31590006
316000         WITH TEST AFTER                                          31600006
316100         VARYING PV-RETRY-COUNTER                                 31610006
316200         FROM 1 BY 1                                              31620006
316300         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               31630006
316400             OR (SQLCODE = +0)                                    31640006
316500             OR (SQLCODE = +100))                                 31650006
316600                                                                  31660006
316700         EXEC SQL                                                 31670006
316800              SELECT ENT_NAME_DESC                                31680006
316900                INTO :ENTNME-ENT-NAME-DESC                        31690006
317000                FROM TEXTENT A                                    31700006
317100                    ,TENTNME B                                    31710006
317200               WHERE A.SCAC_CDE    = :DK-OWNER-SCAC-ID            31720006
317300                 AND A.CARRIER_IND = 'Y'                          31730006
317400                 AND B.TYPE_CDE    = '01'                         31740006
317500                 AND A.ENT_ID = B.ENT_ID                          31750006
317510               WITH UR                                            31751010
317600         END-EXEC                                                 31760006
317700                                                                  31770006
317800         EVALUATE TRUE                                            31780006
317900             WHEN SQLCODE = +0                                    31790006
318000             WHEN SQLCODE = +100                                  31800006
318100             WHEN SQLCODE = -904                                  31810006
318200             WHEN SQLCODE = -913                                  31820006
318300                  CONTINUE                                        31830006
318400                                                                  31840006
318500             WHEN SQLWARN0 NOT = SPACES                           31850006
318600             WHEN SQLCODE < +0                                    31860006
318700             WHEN SQLCODE > +0                                    31870006
318800                  MOVE '4310-GET-ENT-NAME-DESC'                   31880006
318900                                  TO DP013-PARAGRAPH              31890006
319000                  MOVE 'UNSUCCESSFUL SELECT ON TENTNME TABLE'     31900006
319100                                  TO DP013-MESSAGE-TEXT (1)       31910006
319200                  MOVE SQLCA      TO DP013-SQLCA                  31920006
319300                  MOVE 'TEXTENT ' TO DP013-DB2-TABLE-NAME (1)     31930006
319400                  MOVE 'TENTNME ' TO DP013-DB2-TABLE-NAME (2)     31940006
319500                  SET DP013-DB2-ABEND                             31950006
319600                      DP013-XCTL-DISPLAY-RESTART                  31960006
319700                                  TO TRUE                         31970006
319800                  PERFORM DP013-0000-PROCESS-ABEND                31980006
319900         END-EVALUATE                                             31990006
320000     END-PERFORM.                                                 32000006
320100                                                                  32010006
320200     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        32020006
320300         MOVE '4310-GET-ENT-NAME-DESC'                            32030006
320400                                  TO DP013-PARAGRAPH              32040006
320500         MOVE 'MAX RETRIES EXCEEDED ON SELECT TENTNME TABLE'      32050006
320600                                  TO DP013-MESSAGE-TEXT (1)       32060006
320700         MOVE SQLCA               TO DP013-SQLCA                  32070006
320800         MOVE 'TEXTENT'           TO DP013-DB2-TABLE-NAME (1)     32080006
320900         MOVE 'TENTNME'           TO DP013-DB2-TABLE-NAME (2)     32090006
321000         SET DP013-DB2-ABEND                                      32100006
321100             DP013-XCTL-DISPLAY-RESTART                           32110006
321200                                  TO TRUE                         32120006
321300         PERFORM DP013-0000-PROCESS-ABEND                         32130006
321400     END-IF.                                                      32140006
321500                                                                  32150006
321600/                                                                 32160006
321700*----------------------------------------------------------------*32170006
321800*    GET THE SHIPMENT STATUS CODE DESCRIPTION                    *32180006
321900*----------------------------------------------------------------*32190006
322000                                                                  32200006
322100 4330-GET-SHIPT-STATUS-DESC.                                      32210006
322200                                                                  32220006
322300     PERFORM                                                      32230006
322400         WITH TEST AFTER                                          32240006
322500         VARYING PV-RETRY-COUNTER                                 32250006
322600         FROM 1 BY 1                                              32260006
322700         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               32270006
322800            OR  (SQLCODE = +100)                                  32280006
322900            OR  (SQLCODE = +0))                                   32290006
323000                                                                  32300006
323100         EXEC SQL                                                 32310006
323200             SELECT  DESC                                         32320006
323300                    ,PRTY_CDE                                     32330006
323400              INTO  :SHSTYP-DESC                                  32340006
323500                   ,:SHSTYP-PRTY-CDE                              32350006
323600              FROM  TSHSTYP                                       32360006
323700             WHERE  SHIPT_STATUS_CDE = :DK-SHIPT-STATUS-CDE       32370006
323800         END-EXEC                                                 32380006
323900                                                                  32390006
324000         EVALUATE TRUE                                            32400006
324100             WHEN SQLCODE = +0                                    32410006
324200             WHEN SQLCODE = +100                                  32420006
324300             WHEN SQLCODE = -904                                  32430006
324400             WHEN SQLCODE = -913                                  32440006
324500                  CONTINUE                                        32450006
324600                                                                  32460006
324700             WHEN SQLWARN0 NOT = SPACE                            32470006
324800             WHEN SQLCODE < +0                                    32480006
324900             WHEN SQLCODE > +0                                    32490006
325000                  MOVE '4330-GET-VEHICLE-STATUS-DESC'             32500006
325100                                   TO DP013-PARAGRAPH             32510006
325200                  MOVE 'SELECT ON TSHSTYP'                        32520006
325300                                   TO DP013-MESSAGE-TEXT (1)      32530006
325400                  MOVE SQLCA       TO DP013-SQLCA                 32540006
325500                  MOVE 'TSHSTYP'   TO DP013-DB2-TABLE-NAME (1)    32550006
325600                  SET DP013-DB2-ABEND                             32560006
325700                      DP013-XCTL-DISPLAY-RESTART                  32570006
325800                                   TO TRUE                        32580006
325900                  PERFORM DP013-0000-PROCESS-ABEND                32590006
326000         END-EVALUATE                                             32600006
326100     END-PERFORM.                                                 32610006
326200                                                                  32620006
326300     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        32630006
326400         MOVE '4330-GET-VEHICLE-STATUS-DESC'                      32640006
326500                                   TO DP013-PARAGRAPH             32650006
326600         MOVE 'MAX RETRIES EXCEEDED FOR SELECT'                   32660006
326700                                   TO DP013-MESSAGE-TEXT (1)      32670006
326800         MOVE 'ON TABLE TSHSTYP '  TO DP013-MESSAGE-TEXT (2)      32680006
326900         MOVE SQLCA                TO DP013-SQLCA                 32690006
327000         SET DP013-DB2-ABEND                                      32700006
327100             DP013-XCTL-DISPLAY-RESTART                           32710006
327200                                   TO TRUE                        32720006
327300         PERFORM DP013-0000-PROCESS-ABEND                         32730006
327400     END-IF.                                                      32740006
327500                                                                  32750006
327600/                                                                 32760006
327700*----------------------------------------------------------------*32770006
327800*    GET THE PACKAGE TYPE DESCRIPTION                            *32780006
327900*----------------------------------------------------------------*32790006
328000                                                                  32800006
328100 4320-GET-PKG-TYP-DESC.                                           32810006
328200                                                                  32820006
328300     PERFORM                                                      32830006
328400         WITH TEST AFTER                                          32840006
328500         VARYING PV-RETRY-COUNTER                                 32850006
328600         FROM 1 BY 1                                              32860006
328700         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               32870006
328800            OR  (SQLCODE = +100)                                  32880006
328900            OR  (SQLCODE = +0))                                   32890006
329000                                                                  32900006
329100         EXEC SQL                                                 32910006
329200             SELECT  DESC                                         32920006
329300              INTO  :PKGTYP-DESC                                  32930006
329400              FROM  TPKGTYP                                       32940006
329500             WHERE  PKG_TYP_CDE = :DK-PKG-TYP-CDE                 32950006
329600         END-EXEC                                                 32960006
329700                                                                  32970006
329800         EVALUATE TRUE                                            32980006
329900             WHEN SQLCODE = +0                                    32990006
330000             WHEN SQLCODE = +100                                  33000006
330100             WHEN SQLCODE = -904                                  33010006
330200             WHEN SQLCODE = -913                                  33020006
330300                  CONTINUE                                        33030006
330400                                                                  33040006
330500             WHEN SQLWARN0 NOT = SPACE                            33050006
330600             WHEN SQLCODE < +0                                    33060006
330700             WHEN SQLCODE > +0                                    33070006
330800                  MOVE '4320-GET-PKG-TYP-DESC'                    33080006
330900                                   TO DP013-PARAGRAPH             33090006
331000                  MOVE 'SELECT ON TPKGTYP'                        33100006
331100                                   TO DP013-MESSAGE-TEXT (1)      33110006
331200                  MOVE SQLCA       TO DP013-SQLCA                 33120006
331300                  MOVE 'TPKGTYP'   TO DP013-DB2-TABLE-NAME (1)    33130006
331400                  SET DP013-DB2-ABEND                             33140006
331500                      DP013-XCTL-DISPLAY-RESTART                  33150006
331600                                   TO TRUE                        33160006
331700                  PERFORM DP013-0000-PROCESS-ABEND                33170006
331800         END-EVALUATE                                             33180006
331900     END-PERFORM.                                                 33190006
332000                                                                  33200006
332100     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        33210006
332200         MOVE '4320-GET-PKG-TYP-DESC'                             33220006
332300                                   TO DP013-PARAGRAPH             33230006
332400         MOVE 'MAX RETRIES EXCEEDED FOR SELECT'                   33240006
332500                                   TO DP013-MESSAGE-TEXT (1)      33250006
332600         MOVE 'ON TABLE TPKGTYP '  TO DP013-MESSAGE-TEXT (2)      33260006
332700         MOVE SQLCA                TO DP013-SQLCA                 33270006
332800         SET DP013-DB2-ABEND                                      33280006
332900             DP013-XCTL-DISPLAY-RESTART                           33290006
333000                                   TO TRUE                        33300006
333100         PERFORM DP013-0000-PROCESS-ABEND                         33310006
333200     END-IF.                                                      33320006
333300                                                                  33330006
333400/                                                                 33340006
333500*----------------------------------------------------------------*33350006
333600* MOVE THE DISPLAYED FIELDS FROM THE COMMAREA TO THE SCREEN.     *33360006
333700*----------------------------------------------------------------*33370006
333800                                                                  33380006
333900 4400-MOVE-COMMAREA-TO-SCREEN.                                    33390006
334000                                                                  33400006
334100     MOVE ASC-KEY-DEST-OPER-UNT-ID-N                              33410006
334200                                   TO ADOPERO.                    33420006
334300     MOVE ASC-KEY-DEST-FCLTY-ID-N  TO ADFIDO.                     33430006
334400     MOVE ASC-DEST-FCLTY-NME       TO ADFIDDO.                    33440006
334500     MOVE ASC-KEY-OWNER-SCAC-ID    TO ASCACO.                     33450006
334600     MOVE ASC-OWNER-SCAC-ID-DESC   TO ASCACDO.                    33460006
334700     MOVE ASC-KEY-VEH-NBR          TO ATRLRO.                     33470006
334800     MOVE ASC-KEY-MANIFEST-NBR     TO AMANO.                      33480006
334900     MOVE ASC-KEY-PRO-SCAC-ID      TO APSCACO.                    33490006
335000     MOVE ASC-PRO-SCAC-ID-DESC     TO APSCACDO.                   33500006
335100     MOVE ASC-KEY-PRO-NBR          TO APROO.                      33510006
335200     MOVE ASC-KEY-BOL-NBR          TO ABOLO.                      33520006
335300     MOVE ASC-SHIPT-STATUS-CDE     TO ASTATO.                     33530006
335400     MOVE ASC-SHIPT-STATUS-DESC    TO ASTATDO.                    33540006
335500     MOVE ASC-PKG-TYP-CDE          TO ATYPEO.                     33550006
335600     MOVE ASC-PKG-TYP-CDE-DESC     TO ATYPEDO.                    33560006
335700     MOVE ASC-PKG-QTY-N            TO AQTYO.                      33570006
335800     MOVE ASC-GROSS-WGHT-N         TO AWGHTO.                     33580006
335900     MOVE ASC-PLT-QTY-N            TO APLTO.                      33590006
336000     MOVE ASC-FRGT-CHRG-N          TO ACHRGO.                     33600006
336100     MOVE ASC-FRGT-TERM            TO ATERMO.                     33610006
336200     MOVE ASC-FRGT-TERM-DESC       TO ATERMDO.                    33620006
336300     MOVE ASC-ETA-DTE-MM           TO AETAMMO.                    33630006
336400     MOVE ASC-ETA-DTE-DD           TO AETADDO.                    33640006
336500     MOVE ASC-ETA-DTE-CCYY         TO AETAYYO.                    33650006
336600     MOVE ASC-ETA-TIME-HH          TO AETAHHO.                    33660006
336700     MOVE ASC-ETA-TIME-MM          TO AETAMNO.                    33670006
336710* CLT 12-08-2011 WR40574 START                                    33671006
336720     MOVE ASC-CAN                  TO ACANO.                      33672006
336730* CLT 12-08-2011 WR40574 END                                      33673006
336800                                                                  33680006
336900     IF  ASC-ADD-PENDING                                          33690006
337000         SET DP030-SET-CURSOR-APPL-1                              33700006
337100                                   TO TRUE                        33710006
337200         MOVE -1                   TO APROL                       33720006
337300     ELSE                                                         33730006
337400         IF  ASC-UPDATE-PENDING                                   33740006
337500             MOVE -1               TO ASTATL                      33750006
337600             SET DP030-SET-CURSOR-APPL-1                          33760006
337700                                   TO TRUE                        33770006
337800         END-IF                                                   33780006
337900            IF  ASC-SUSPND-UPDATE-YES                             33790006
338000                SET DP030-SET-CURSOR-APPL-1                       33800006
338100                                          TO TRUE                 33810006
338200                MOVE -1                   TO APROL                33820006
338300            END-IF                                                33830006
338400     END-IF.                                                      33840006
338500                                                                  33850006
338600/                                                                 33860006
338700*----------------------------------------------------------------*33870006
338800* ADD A SHIPMENT                                                 *33880006
338900*----------------------------------------------------------------*33890006
339000 5000-ADD-SHIPMENT.                                               33900006
339100                                                                  33910006
339200     INITIALIZE DCLTSHIPMT                                        33920006
339300                DCLTSHIPST.                                       33930006
339400                                                                  33940006
339500     IF  ASC-ADD-OPEN-SHIPMENT                                    33950006
339600         PERFORM 5050-GET-RANDOM-NUMBER                           33960006
339700         PERFORM 7600-READ-DUPL-TVHTRIP                           33970006
339800             WITH TEST AFTER                                      33980006
339900             UNTIL PV-VHTRIP-COUNT = 0                            33990006
340000         MOVE DP902-RANDOM-NUMBER                                 34000015
340100                                 TO SHIPMT-TRIP-ID                34010006
340200                                    VHTRIP-TRIP-ID                34020006
340300                                    VHTRIP-REF-TRIP-ID            34030006
340400         MOVE +1                 TO DN-TRIP-ID                    34040006
340500                                    DN-TRIP-TRIP-ID               34050006
340600         MOVE ASC-KEY-OWNER-SCAC-ID                               34060006
340700                                 TO DK-OWNER-SCAC-ID              34070006
340800         MOVE ZERO               TO DK-VEH-NBR                    34080006
340900         MOVE 'CE'               TO VHTRIP-CRT-SRC-CDE            34090006
341000         MOVE ASC-KEY-MANIFEST-NBR                                34100006
341100                                 TO VHTRIP-MANIFEST-NBR           34110006
341200         MOVE ZERO               TO VHTRIP-PLND-TRIP-SEQ          34120006
341300                                                                  34130006
341400         MOVE +1                 TO DN-VEH-NBR                    34140006
341500         PERFORM 5300-INSERT-TVHTRIP                              34150006
341600         PERFORM 5400-AUDIT-TVHTRIP                               34160006
341700     ELSE                                                         34170006
341800         MOVE ASC-KEY-TRIP-ID    TO SHIPMT-TRIP-ID                34180006
341900         MOVE +1                 TO DN-TRIP-ID                    34190006
342000     END-IF.                                                      34200006
342100                                                                  34210006
342200     PERFORM 5050-GET-RANDOM-NUMBER.                              34220006
342300     MOVE DP902-RANDOM-NUMBER    TO SHIPMT-SHIPT-ID               34230015
342400                                    ASC-KEY-SHIPT-ID.             34240006
342500                                                                  34250006
342600     MOVE 'CE'                   TO SHIPMT-CRT-SRC-CDE.           34260006
342700     MOVE ASC-KEY-PRO-SCAC-ID    TO SHIPMT-PRO-SCAC-ID.           34270006
342800     MOVE ASC-PRO-NBR            TO SHIPMT-PRO-NBR.               34280006
342900     MOVE ASC-KEY-COMP-PRO-NBR   TO SHIPMT-COMPLETE-PRO-NBR.      34290006
343000     MOVE ASC-BOL-NBR            TO SHIPMT-BOL-NBR.               34300006
343010* CLT 12-08-2011 WR40574 START                                    34301006
343020     MOVE ASC-CAN                TO SHIPMT-CARR-AUTH-ID.          34302006
343030* CLT 12-08-2011 WR40574 END                                      34303006
343100     MOVE ASC-KEY-COMP-BOL-NBR   TO SHIPMT-COMPLETE-BOL-NBR.      34310006
343200     MOVE ASC-GROSS-WGHT-N       TO SHIPMT-EXPTED-GRO-WGHT.       34320006
343300     MOVE +1                     TO SHIPMT-SHIPT-TYP-CDE.         34330006
343400     MOVE ASC-PKG-TYP-CDE        TO SHIPMT-PKG-TYP-CDE.           34340006
343500     MOVE ASC-PKG-QTY-N          TO SHIPMT-EXPTED-PKG-QTY.        34350006
343600     MOVE ASC-FRGT-CHRG-N        TO SHIPMT-FRGT-CHG-AMT.          34360006
343700     MOVE ASC-FRGT-TERM          TO SHIPMT-FRGT-TERMS-CDE.        34370006
343800     MOVE ASC-PLT-QTY-N          TO SHIPMT-EXPTED-PLT-QTY.        34380006
343900     MOVE '0001-01-01'           TO SHIPMT-VEND-SHIP-DTE.         34390006
344000     IF  ASC-ETA-DTE  = SPACES                                    34400006
344100     AND ASC-ETA-TIME = SPACES                                    34410006
344200         MOVE -1                 TO DN-SHIP-EST-AR-TMST           34420006
344300     ELSE                                                         34430006
344400         STRING  ASC-ETA-DTE-CC                                   34440006
344500                 ASC-ETA-DTE-YY                                   34450006
344600                 '-'                                              34460006
344700                 ASC-ETA-DTE-MM                                   34470006
344800                 '-'                                              34480006
344900                 ASC-ETA-DTE-DD                                   34490006
345000                 '-'                                              34500006
345100                 ASC-ETA-TIME-HH                                  34510006
345200                 '.'                                              34520006
345300                 ASC-ETA-TIME-MM                                  34530006
345400                 '.00.000000'                                     34540006
345500                 DELIMITED BY SIZE                                34550006
345600                 INTO SHIPMT-EST-AR-TMST                          34560006
345700         MOVE +1                 TO DN-SHIP-EST-AR-TMST           34570006
345800     END-IF.                                                      34580006
345900                                                                  34590006
346000     MOVE ASC-KEY-PRO-SCAC-ID    TO DK-PRO-SCAC-ID.               34600006
346100     MOVE ASC-KEY-PRO-NBR        TO ASC-PRO-NBR.                  34610006
346200     MOVE ASC-KEY-BOL-NBR        TO ASC-BOL-NBR.                  34620006
346300     PERFORM 5110-CHECK-DUPL-SHIPMENT.                            34630006
346400     IF  SQLCODE = +0 OR                                          34640006
346500         SQLCODE = -811                                           34650006
346600         SET PS-ERROR           TO TRUE                           34660006
346700         SET DP020-MSG-FATAL    TO TRUE                           34670006
346800         MOVE PC-TSYMSG-00117   TO DP020-MSG-NUMBER               34680006
346900         MOVE DP015-UNP-ALP-BRT-OFF                               34690006
347000                                TO APSCACA                        34700006
347100                                   APROA                          34710006
347200                                   ABOLA                          34720006
347300         MOVE DP015-RED         TO APSCACC                        34730006
347400                                   APROC                          34740006
347500                                   ABOLC                          34750006
347600         MOVE DP015-REVERSE     TO APSCACH                        34760006
347700                                   APROH                          34770006
347800                                   ABOLH                          34780006
347900         MOVE -1                TO APSCACL                        34790006
348000         SET DP030-SET-CURSOR-APPL-1                              34800006
348100                                TO TRUE                           34810006
348200     ELSE                                                         34820006
348300         PERFORM 5100-INSERT-TSHIPMT                              34830006
348400         IF  SQLCODE = +0                                         34840006
348500             MOVE SHIPMT-SHIPT-ID   TO SHIPST-SHIPT-ID            34850006
348600                                       DK-SHIPT-ID                34860006
348700             PERFORM 8000-AUDIT-TSHIPMT                           34870006
348800             MOVE ASC-SHIPT-STATUS-CDE                            34880006
348900                                    TO SHIPST-SHIPT-STATUS-CDE    34890006
349000             IF (ASC-KEY-VEH-TYP-CDE = 'VS' OR 'AV') AND          34900006
349100                        SHIPST-CITY-NAME = SPACES OR LOW-VALUES   34910006
349200                 MOVE 'PORT OF ENTRY'                             34920006
349300                                 TO SHIPST-CITY-NAME              34930006
349400             END-IF                                               34940006
349500             PERFORM 6120-INSERT-TSHIPST                          34950006
349600             MOVE PC-TSYMSG-00034   TO DP020-MSG-NUMBER           34960006
349700             SET DP020-MSG-INFORMATIONAL                          34970006
349800                 ASC-ADD-SUCCESSFUL TO TRUE                       34980006
349900             IF  ASC-USE-SELECTION-QUEUE                          34990006
350000                 PERFORM 5200-UPDATE-SELECTION-QUEUE              35000006
350100             END-IF                                               35010006
350200         END-IF                                                   35020006
350300     END-IF.                                                      35030006
350400                                                                  35040006
350500*----------------------------------------------------------------*35050006
350600* CHECK IF TIMCNTK EXISTS.                                       *35060006
350700*----------------------------------------------------------------*35070006
350800 5001-CHECK-TIMCNTK.                                              35080006
350900                                                                  35090006
351000     PERFORM                                                      35100006
351100         WITH TEST AFTER                                          35110006
351200         VARYING PV-RETRY-COUNTER                                 35120006
351300         FROM 1 BY 1                                              35130006
351400         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               35140006
351500             OR (SQLCODE = +0)                                    35150006
351600             OR (SQLCODE = -811)                                  35160006
351700             OR (SQLCODE = +100))                                 35170006
351800                                                                  35180006
351900         EXEC SQL                                                 35190006
352000             SELECT  A.CONTNR_ID                                  35200006
352100              INTO   :IMCNTK-CONTNR-ID                            35210006
352200           FROM   TIMCNTK A                                       35220006
352300           WHERE  A.CONTNR_ID = :DK-CONTNR-ID                     35230006
352400         END-EXEC                                                 35240006
352500                                                                  35250006
352600         EVALUATE TRUE                                            35260006
352700             WHEN SQLCODE = +0                                    35270006
352800             WHEN SQLCODE = +100                                  35280006
352900             WHEN SQLCODE = -811                                  35290006
353000             WHEN SQLCODE = -904                                  35300006
353100             WHEN SQLCODE = -913                                  35310006
353200                 CONTINUE                                         35320006
353300                                                                  35330006
353400             WHEN SQLWARN0 NOT = SPACES                           35340006
353500             WHEN SQLCODE < +0                                    35350006
353600             WHEN SQLCODE > +0                                    35360006
353700                 MOVE '5001-CHECK-TIMCNTK      '                  35370006
353800                                   TO DP013-PARAGRAPH             35380006
353900                 MOVE 'SELECT A TIMCNTK ROW   '                   35390006
354000                                   TO DP013-MESSAGE-TEXT(1)       35400006
354100                 MOVE SQLCA        TO DP013-SQLCA                 35410006
354200                 MOVE 'TIMCNTK'    TO DP013-DB2-TABLE-NAME (1)    35420006
354300                 SET DP013-DB2-ABEND                              35430006
354400                     DP013-XCTL-DISPLAY-RESTART TO TRUE           35440006
354500                 PERFORM DP013-0000-PROCESS-ABEND                 35450006
354600         END-EVALUATE                                             35460006
354700     END-PERFORM.                                                 35470006
354800                                                                  35480006
354900     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        35490006
355000         MOVE '5001-CHECK-TIMCNTK      '                          35500006
355100                                   TO DP013-PARAGRAPH             35510006
355200         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              35520006
355300                                   TO DP013-MESSAGE-TEXT (1)      35530006
355400         MOVE 'TO SELECT A TIMCNTK ROW'                           35540006
355500                                   TO DP013-MESSAGE-TEXT (2)      35550006
355600         MOVE SQLCA                TO DP013-SQLCA                 35560006
355700         MOVE 'TIMCNTK'            TO DP013-DB2-TABLE-NAME (1)    35570006
355800         SET DP013-DB2-ABEND                                      35580006
355900             DP013-XCTL-DISPLAY-RESTART                           35590006
356000                                   TO TRUE                        35600006
356100         PERFORM DP013-0000-PROCESS-ABEND                         35610006
356200     END-IF.                                                      35620006
356300                                                                  35630006
356400                                                                  35640006
356500/                                                                 35650006
356600*----------------------------------------------------------------*35660006
356700*  RETREIVE A RANDMON NUMBER                                     *35670006
356800*----------------------------------------------------------------*35680006
356900 5050-GET-RANDOM-NUMBER.                                          35690006
357000     INITIALIZE DP902-RANDNBR-ROUTINE-FIELDS.                     35700015
357100                                                                  35710006
358400     CALL PC-RANDNBR-PGM USING DFHEIBLK                           35840016
358410                               DFHCOMMAREA                        35841016
358420                               DP902-RANDNBR-ROUTINE-FIELDS.      35842016
358500                                                                  35850006
358600     IF  DP902-SUCCESSFUL                                         35860015
358700         NEXT SENTENCE                                            35870006
358800     ELSE                                                         35880006
358900         MOVE '5000-ADD-SHIPMENT'  TO DP013-PARAGRAPH             35890006
359000         MOVE 'CALL TO DPKUT902 FAILED'                           35900015
359100                                   TO DP013-MESSAGE-TEXT(1)       35910006
359200         SET DP013-XCTL-DISPLAY-RESTART                           35920006
359300                                   TO TRUE                        35930006
359400         PERFORM DP013-0000-PROCESS-ABEND                         35940006
359500     END-IF.                                                      35950006
359600/                                                                 35960006
359700*----------------------------------------------------------------*35970006
359800*  INSERT A ROW ON THE TSHIPMT TABLE                             *35980006
359900*----------------------------------------------------------------*35990006
360000 5100-INSERT-TSHIPMT.                                             36000006
360100                                                                  36010006
360110* CLT 12-08-2011 WR40574 CARR-AUTH-ID ADDED BELOW                 36011006
360200     PERFORM                                                      36020006
360300         WITH TEST AFTER                                          36030006
360400         VARYING PV-RETRY-COUNTER                                 36040006
360500         FROM 1 BY 1                                              36050006
360600         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               36060006
360700             OR (SQLCODE = +0)                                    36070006
360800             OR (SQLCODE = -803))                                 36080006
360900                                                                  36090006
361000         EXEC SQL                                                 36100006
361100             INSERT  INTO TSHIPMT                                 36110006
361200                    (TRIP_ID                                      36120006
361300                    ,SHIPT_ID                                     36130006
361400                    ,CRT_SRC_CDE                                  36140006
361500                    ,LAST_UPD_DTE                                 36150006
361600                    ,LAST_UPD_TME                                 36160006
361700                    ,LAST_UPD_UID                                 36170006
361800                    ,PRO_SCAC_ID                                  36180006
361900                    ,PRO_NBR                                      36190006
362000                    ,BOL_NBR                                      36200006
362100                    ,SHIPPER_NME                                  36210006
362200                    ,SHIPT_TYP_CDE                                36220006
362300                    ,EXPTED_GRO_WGHT                              36230006
362400                    ,PKG_TYP_CDE                                  36240006
362500                    ,EXPTED_PKG_QTY                               36250006
362600                    ,FRGT_CHG_AMT                                 36260006
362700                    ,FRGT_TERMS_CDE                               36270006
362800                    ,EXPTED_PLT_QTY                               36280006
362900                    ,VEND_SHIP_DTE                                36290006
363000                    ,EST_AR_TMST                                  36300006
363100                    ,LAST_UPD_PGM_ID                              36310006
363200                    ,CRE_USER_ID                                  36320006
363300                    ,CARR_LAST_UPD_DTE                            36330006
363400                    ,CARR_LAST_UPD_TIME                           36340006
363500                    ,VEND_LAST_UPD_DTE                            36350006
363600                    ,VEND_LAST_UPD_TIME                           36360006
363700                    ,AUTH_DTE                                     36370006
363800                    ,CONFIRM_DTE                                  36380006
363900                    ,CONFIRM_TIME                                 36390006
364000                    ,COMPLETE_PRO_NBR                             36400006
364100                    ,COMPLETE_BOL_NBR                             36410006
364200                    ,PROCESSED_DTE                                36420006
364210                    ,CARR_AUTH_ID)                                36421006
364300            VALUES  (:SHIPMT-TRIP-ID                              36430006
364400                        :DN-TRIP-ID                               36440006
364500                    ,:SHIPMT-SHIPT-ID                             36450006
364600                    ,:SHIPMT-CRT-SRC-CDE                          36460006
364700                    ,CURRENT DATE                                 36470006
364800                    ,CURRENT TIME                                 36480006
364900                    ,:DP020-USERID                                36490006
365000                    ,:SHIPMT-PRO-SCAC-ID                          36500006
365100                    ,:SHIPMT-PRO-NBR                              36510006
365200                    ,:SHIPMT-BOL-NBR                              36520006
365300                    ,:SHIPMT-SHIPPER-NME                          36530006
365400                    ,:SHIPMT-SHIPT-TYP-CDE                        36540006
365500                    ,:SHIPMT-EXPTED-GRO-WGHT                      36550006
365600                    ,:SHIPMT-PKG-TYP-CDE                          36560006
365700                    ,:SHIPMT-EXPTED-PKG-QTY                       36570006
365800                    ,:SHIPMT-FRGT-CHG-AMT                         36580006
365900                    ,:SHIPMT-FRGT-TERMS-CDE                       36590006
366000                    ,:SHIPMT-EXPTED-PLT-QTY                       36600006
366100                    ,:SHIPMT-VEND-SHIP-DTE                        36610006
366200                    ,:SHIPMT-EST-AR-TMST                          36620006
366300                        :DN-SHIP-EST-AR-TMST                      36630006
366400                    ,:PC-CURRENT-PROGRAM-NAME                     36640006
366500                    ,:DP020-USERID                                36650006
366600                    ,:PC-DEFAULT-DATE                             36660006
366700                    ,:PC-DEFAULT-TIME                             36670006
366800                    ,:PC-DEFAULT-DATE                             36680006
366900                    ,:PC-DEFAULT-TIME                             36690006
367000                    ,:PC-DEFAULT-DATE                             36700006
367100                    ,:PC-DEFAULT-DATE                             36710006
367200                    ,:PC-DEFAULT-TIME                             36720006
367300                    ,:SHIPMT-COMPLETE-PRO-NBR                     36730006
367400                    ,:SHIPMT-COMPLETE-BOL-NBR                     36740006
367500                    ,:PC-DEFAULT-DATE                             36750006
367510                    ,:SHIPMT-CARR-AUTH-ID)                        36751006
367600         END-EXEC                                                 36760006
367700                                                                  36770006
367800         EVALUATE TRUE                                            36780006
367900             WHEN SQLCODE = +0                                    36790006
368000                 CONTINUE                                         36800006
368100                                                                  36810006
368200             WHEN SQLCODE = -803                                  36820006
368300                 SET PS-ERROR           TO TRUE                   36830006
368400                 SET DP020-MSG-FATAL    TO TRUE                   36840006
368500                 MOVE PC-TSYMSG-00117   TO DP020-MSG-NUMBER       36850006
368600                 MOVE DP015-UNP-ALP-BRT-OFF                       36860006
368700                                        TO APSCACA                36870006
368800                                           APROA                  36880006
368900                                           ABOLA                  36890006
369000                 MOVE DP015-RED         TO APSCACC                36900006
369100                                           APROC                  36910006
369200                                           ABOLC                  36920006
369300                 MOVE DP015-REVERSE     TO APSCACH                36930006
369400                                           APROH                  36940006
369500                                           ABOLH                  36950006
369600                 MOVE -1                TO APSCACL                36960006
369700                 SET DP030-SET-CURSOR-APPL-1                      36970006
369800                                        TO TRUE                   36980006
369900                                                                  36990006
370000             WHEN SQLCODE = -904                                  37000006
370100             WHEN SQLCODE = -913                                  37010006
370200                 CONTINUE                                         37020006
370300                                                                  37030006
370400             WHEN SQLWARN0 NOT = SPACES                           37040006
370500             WHEN SQLCODE < +0                                    37050006
370600             WHEN SQLCODE > +0                                    37060006
370700                 MOVE '5100-INSERT-TSHIPMT'                       37070006
370800                                   TO DP013-PARAGRAPH             37080006
370900                 MOVE 'INSERT A ROW ON TSHIPMT'                   37090006
371000                                   TO DP013-MESSAGE-TEXT(1)       37100006
371100                 MOVE SQLCA        TO DP013-SQLCA                 37110006
371200                 MOVE 'TSHIPMT'    TO DP013-DB2-TABLE-NAME (1)    37120006
371300                 SET DP013-DB2-ABEND                              37130006
371400                     DP013-XCTL-DISPLAY-RESTART TO TRUE           37140006
371500                 PERFORM DP013-0000-PROCESS-ABEND                 37150006
371600         END-EVALUATE                                             37160006
371700     END-PERFORM.                                                 37170006
371800                                                                  37180006
371900     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        37190006
372000         MOVE '5100-INSERT-TSHIPMT'                               37200006
372100                                   TO DP013-PARAGRAPH             37210006
372200         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              37220006
372300                                   TO DP013-MESSAGE-TEXT (1)      37230006
372400         MOVE 'TO INSERT A TSHIPMT ROW'                           37240006
372500                                   TO DP013-MESSAGE-TEXT (2)      37250006
372600         MOVE SQLCA                TO DP013-SQLCA                 37260006
372700         MOVE 'TSHIPMT'            TO DP013-DB2-TABLE-NAME (1)    37270006
372800         SET DP013-DB2-ABEND                                      37280006
372900             DP013-XCTL-DISPLAY-RESTART                           37290006
373000                                   TO TRUE                        37300006
373100         PERFORM DP013-0000-PROCESS-ABEND                         37310006
373200     END-IF.                                                      37320006
373300                                                                  37330006
373400/                                                                 37340006
373500 5110-CHECK-DUPL-SHIPMENT.                                        37350006
373600                                                                  37360006
373700     PERFORM                                                      37370006
373800         WITH TEST AFTER                                          37380006
373900         VARYING PV-RETRY-COUNTER                                 37390006
374000         FROM 1 BY 1                                              37400006
374100         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               37410006
374200             OR (SQLCODE = +0)                                    37420006
374300             OR (SQLCODE = -811)                                  37430006
374400             OR (SQLCODE = +100))                                 37440006
374500                                                                  37450006
374600         EXEC SQL                                                 37460006
374700             SELECT  A.SHIPT_ID                                   37470006
374800              INTO   :SHIPMT-SHIPT-ID                             37480006
374900           FROM   TSHIPMT A                                       37490006
375000                 ,TSHIPST B                                       37500006
375100                 ,TSHSTYP C                                       37510006
375200           WHERE  A.PRO_SCAC_ID       = :DK-PRO-SCAC-ID           37520006
375300             AND  A.PRO_NBR           = :ASC-PRO-NBR              37530006
375400             AND  A.BOL_NBR           = :ASC-BOL-NBR              37540006
375500             AND  B.SHIPT_STATUS_CDE NOT IN ('DE','ET')           37550006
375600             AND  C.PRTY_CDE =                                    37560006
375700                  (SELECT MAX(E.PRTY_CDE)                         37570006
375800                     FROM TSHIPST D                               37580006
375900                         ,TSHSTYP E                               37590006
376000                    WHERE D.SHIPT_ID         = A.SHIPT_ID         37600006
376100                      AND D.SHIPT_STATUS_CDE = E.SHIPT_STATUS_CDE)37610006
376200             AND  A.SHIPT_ID         = B.SHIPT_ID                 37620006
376300             AND  B.SHIPT_STATUS_CDE = C.SHIPT_STATUS_CDE         37630006
376400         END-EXEC                                                 37640006
376500                                                                  37650006
376600         EVALUATE TRUE                                            37660006
376700             WHEN SQLCODE = +0                                    37670006
376800             WHEN SQLCODE = +100                                  37680006
376900             WHEN SQLCODE = -811                                  37690006
377000             WHEN SQLCODE = -904                                  37700006
377100             WHEN SQLCODE = -913                                  37710006
377200                 CONTINUE                                         37720006
377300                                                                  37730006
377400             WHEN SQLWARN0 NOT = SPACES                           37740006
377500             WHEN SQLCODE < +0                                    37750006
377600             WHEN SQLCODE > +0                                    37760006
377700                 MOVE '5110-CHECK-DUPL-SHIPMENT'                  37770006
377800                                   TO DP013-PARAGRAPH             37780006
377900                 MOVE 'SELECT A TSHIPMT ROW   '                   37790006
378000                                   TO DP013-MESSAGE-TEXT(1)       37800006
378100                 MOVE SQLCA        TO DP013-SQLCA                 37810006
378200                 MOVE 'TSHIPMT'    TO DP013-DB2-TABLE-NAME (1)    37820006
378300                 MOVE 'TSHIPST'    TO DP013-DB2-TABLE-NAME (2)    37830006
378400                 MOVE 'TSHSTYP'    TO DP013-DB2-TABLE-NAME (3)    37840006
378500                 SET DP013-DB2-ABEND                              37850006
378600                     DP013-XCTL-DISPLAY-RESTART TO TRUE           37860006
378700                 PERFORM DP013-0000-PROCESS-ABEND                 37870006
378800         END-EVALUATE                                             37880006
378900     END-PERFORM.                                                 37890006
379000                                                                  37900006
379100     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        37910006
379200         MOVE '5110-CHECK-DUPL-SHIPMENT'                          37920006
379300                                   TO DP013-PARAGRAPH             37930006
379400         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              37940006
379500                                   TO DP013-MESSAGE-TEXT (1)      37950006
379600         MOVE 'TO SELECT A TSHIPMT ROW'                           37960006
379700                                   TO DP013-MESSAGE-TEXT (2)      37970006
379800         MOVE SQLCA                TO DP013-SQLCA                 37980006
379900         MOVE 'TSHIPMT'            TO DP013-DB2-TABLE-NAME (1)    37990006
380000         MOVE 'TSHIPST'            TO DP013-DB2-TABLE-NAME (2)    38000006
380100         MOVE 'TSHSTYP'            TO DP013-DB2-TABLE-NAME (3)    38010006
380200         SET DP013-DB2-ABEND                                      38020006
380300             DP013-XCTL-DISPLAY-RESTART                           38030006
380400                                   TO TRUE                        38040006
380500         PERFORM DP013-0000-PROCESS-ABEND                         38050006
380600     END-IF.                                                      38060006
380700                                                                  38070006
380800/                                                                 38080006
380900*----------------------------------------------------------------*38090006
381000* RECORD IN THE SELECTION TEMP STORAGE QUEUE THE FACT THAT THIS  *38100006
381100* OBJECT WAS UPDATED.                                            *38110006
381200*----------------------------------------------------------------*38120006
381300                                                                  38130006
381400 5200-UPDATE-SELECTION-QUEUE.                                     38140006
381500                                                                  38150006
381600     PERFORM 9100-READ-SEL-QUEUE.                                 38160006
381700                                                                  38170006
381800     IF  ASC-DELETE-SUCCESSFUL                                    38180006
381900         SET TR006-DEL (ASC-SEL-SUB)                              38190006
382000                                   TO TRUE                        38200006
382100     ELSE                                                         38210006
382200         SET TR006-UPD (ASC-SEL-SUB)                              38220006
382300                                   TO TRUE                        38230006
382400     END-IF.                                                      38240006
382500                                                                  38250006
382600     PERFORM 9200-REWRITE-LIST-QUEUE.                             38260006
382700                                                                  38270006
382800/                                                                 38280006
382900*----------------------------------------------------------------*38290006
383000*  INSERT A ROW ON THE VEHICLE TRIP TABLE                        *38300006
383100*----------------------------------------------------------------*38310006
383200 5300-INSERT-TVHTRIP.                                             38320006
383300                                                                  38330006
383400     PERFORM                                                      38340006
383500         WITH TEST AFTER                                          38350006
383600         VARYING PV-RETRY-COUNTER                                 38360006
383700         FROM 1 BY 1                                              38370006
383800         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               38380006
383900             OR (SQLCODE = +0))                                   38390006
384000                                                                  38400006
384100         EXEC SQL                                                 38410006
384200             INSERT  INTO TVHTRIP                                 38420006
384300                    (OWNER_SCAC_ID                                38430006
384400                    ,VEH_NBR                                      38440006
384500                    ,TRIP_ID                                      38450006
384600                    ,TRIP_BEG_DTE                                 38460006
384700                    ,TRIP_BEG_TME                                 38470006
384800                    ,CRT_SRC_CDE                                  38480006
384900                    ,LAST_UPD_DTE                                 38490006
385000                    ,LAST_UPD_TME                                 38500006
385100                    ,LAST_UPD_UID                                 38510006
385200                    ,MANIFEST_NBR                                 38520006
385300                    ,PLND_TRIP_SEQ                                38530006
385400                    ,REF_TRIP_ID                                  38540006
385500                    ,SPLT_XMIT_IND                                38550006
385600                    ,SPLT_XMIT_DTE                                38560006
385700                    ,SPLT_XMIT_TM )                               38570006
385800            VALUES  (:DK-OWNER-SCAC-ID                            38580006
385900                    ,:DK-VEH-NBR                                  38590006
386000                       :DN-VEH-NBR                                38600006
386100                    ,:VHTRIP-TRIP-ID                              38610006
386200                    ,CURRENT DATE                                 38620006
386300                    ,CURRENT TIME                                 38630006
386400                    ,:VHTRIP-CRT-SRC-CDE                          38640006
386500                    ,CURRENT DATE                                 38650006
386600                    ,CURRENT TIME                                 38660006
386700                    ,:DP020-USERID                                38670006
386800                    ,:VHTRIP-MANIFEST-NBR                         38680006
386900                    ,:VHTRIP-PLND-TRIP-SEQ                        38690006
387000                    ,:VHTRIP-REF-TRIP-ID                          38700006
387100                    ,:VHTRIP-SPLT-XMIT-IND                        38710006
387200                    ,:PC-DEFAULT-DATE                             38720006
387300                    ,:PC-DEFAULT-TIME)                            38730006
387400         END-EXEC                                                 38740006
387500                                                                  38750006
387600         EVALUATE TRUE                                            38760006
387700             WHEN SQLCODE = +0                                    38770006
387800             WHEN SQLCODE = -904                                  38780006
387900             WHEN SQLCODE = -913                                  38790006
388000                 CONTINUE                                         38800006
388100                                                                  38810006
388200             WHEN SQLWARN0 NOT = SPACES                           38820006
388300             WHEN SQLCODE < +0                                    38830006
388400             WHEN SQLCODE > +0                                    38840006
388500                 MOVE '5300-INSERT-TVHTRIP'                       38850006
388600                                   TO DP013-PARAGRAPH             38860006
388700                 MOVE 'INSERT A ROW ON TVHTRIP'                   38870006
388800                                   TO DP013-MESSAGE-TEXT(1)       38880006
388900                 MOVE SQLCA        TO DP013-SQLCA                 38890006
389000                 MOVE 'TVHTRIP'    TO DP013-DB2-TABLE-NAME (1)    38900006
389100                 SET DP013-DB2-ABEND                              38910006
389200                     DP013-XCTL-DISPLAY-RESTART TO TRUE           38920006
389300                 PERFORM DP013-0000-PROCESS-ABEND                 38930006
389400         END-EVALUATE                                             38940006
389500     END-PERFORM.                                                 38950006
389600                                                                  38960006
389700     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        38970006
389800         MOVE '5300-INSERT-TVHTRIP'                               38980006
389900                                   TO DP013-PARAGRAPH             38990006
390000         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              39000006
390100                                   TO DP013-MESSAGE-TEXT (1)      39010006
390200         MOVE 'TO INSERT A TVHTRIP ROW'                           39020006
390300                                   TO DP013-MESSAGE-TEXT (2)      39030006
390400         MOVE SQLCA                TO DP013-SQLCA                 39040006
390500         MOVE 'TVHTRIP'            TO DP013-DB2-TABLE-NAME (1)    39050006
390600         SET DP013-DB2-ABEND                                      39060006
390700             DP013-XCTL-DISPLAY-RESTART                           39070006
390800                                   TO TRUE                        39080006
390900         PERFORM DP013-0000-PROCESS-ABEND                         39090006
391000     END-IF.                                                      39100006
391100                                                                  39110006
391200/                                                                 39120006
391300*----------------------------------------------------------------*39130006
391400*  TAKE A SNAPSHOT OF THE AFTER  IMAGE OF TVHTRIP AND WRITE      *39140006
391500*  TO THE AUDIT TABLE.                                           *39150006
391600*----------------------------------------------------------------*39160006
391700 5400-AUDIT-TVHTRIP.                                              39170006
391800                                                                  39180006
391900     INITIALIZE DCLTAUTRIP.                                       39190006
392000                                                                  39200006
392100     PERFORM                                                      39210006
392200         WITH TEST AFTER                                          39220006
392300         VARYING PV-RETRY-COUNTER                                 39230006
392400         FROM 1 BY 1                                              39240006
392500         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               39250006
392600             OR (SQLCODE = +0))                                   39260006
392700                                                                  39270006
392800         EXEC SQL                                                 39280006
392900             SELECT  OWNER_SCAC_ID                                39290006
393000                    ,VEH_NBR                                      39300006
393100                    ,TRIP_ID                                      39310006
393200                    ,TRIP_BEG_DTE                                 39320006
393300                    ,TRIP_BEG_TME                                 39330006
393400                    ,CRT_SRC_CDE                                  39340006
393500                    ,LAST_UPD_DTE                                 39350006
393600                    ,LAST_UPD_TME                                 39360006
393700                    ,LAST_UPD_UID                                 39370006
393800                    ,MANIFEST_NBR                                 39380006
393900                    ,PLND_TRIP_SEQ                                39390006
394000                    ,PLND_ACTVY_CDE                               39400006
394100                    ,REF_TRIP_ID                                  39410006
394200                    ,SPLT_XMIT_IND                                39420006
394300                    ,SPLT_XMIT_DTE                                39430006
394400                    ,SPLT_XMIT_TM                                 39440006
394500            INTO     :VHTRIP-OWNER-SCAC-ID                        39450006
394600                    ,:VHTRIP-VEH-NBR                              39460006
394700                       :DN-VEH-NBR                                39470006
394800                    ,:VHTRIP-TRIP-ID                              39480006
394900                    ,:VHTRIP-TRIP-BEG-DTE                         39490006
395000                    ,:VHTRIP-TRIP-BEG-TME                         39500006
395100                    ,:VHTRIP-CRT-SRC-CDE                          39510006
395200                    ,:VHTRIP-LAST-UPD-DTE                         39520006
395300                    ,:VHTRIP-LAST-UPD-TME                         39530006
395400                    ,:VHTRIP-LAST-UPD-UID                         39540006
395500                    ,:VHTRIP-MANIFEST-NBR                         39550006
395600                    ,:VHTRIP-PLND-TRIP-SEQ                        39560006
395700                    ,:VHTRIP-PLND-ACTVY-CDE                       39570006
395800                    ,:VHTRIP-REF-TRIP-ID                          39580006
395900                    ,:VHTRIP-SPLT-XMIT-IND                        39590006
396000                    ,:VHTRIP-SPLT-XMIT-DTE                        39600006
396100                    ,:VHTRIP-SPLT-XMIT-TM                         39610006
396200           FROM   TVHTRIP                                         39620006
396300           WHERE  TRIP_ID       = :VHTRIP-TRIP-ID                 39630006
396400         END-EXEC                                                 39640006
396500                                                                  39650006
396600         EVALUATE TRUE                                            39660006
396700             WHEN SQLCODE = +0                                    39670006
396800             WHEN SQLCODE = -904                                  39680006
396900             WHEN SQLCODE = -913                                  39690006
397000                 CONTINUE                                         39700006
397100                                                                  39710006
397200             WHEN SQLWARN0 NOT = SPACES                           39720006
397300             WHEN SQLCODE < +0                                    39730006
397400             WHEN SQLCODE > +0                                    39740006
397500                 MOVE '5400-AUDIT-TVHTRIP'                        39750006
397600                                   TO DP013-PARAGRAPH             39760006
397700                 MOVE 'SELECT A ROW ON TVHTRIP'                   39770006
397800                                   TO DP013-MESSAGE-TEXT(1)       39780006
397900                 MOVE SQLCA        TO DP013-SQLCA                 39790006
398000                 MOVE 'TVHTRIP'    TO DP013-DB2-TABLE-NAME (1)    39800006
398100                 SET DP013-DB2-ABEND                              39810006
398200                     DP013-XCTL-DISPLAY-RESTART TO TRUE           39820006
398300                 PERFORM DP013-0000-PROCESS-ABEND                 39830006
398400         END-EVALUATE                                             39840006
398500     END-PERFORM.                                                 39850006
398600                                                                  39860006
398700     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        39870006
398800         MOVE '5400-AUDIT-TVHTRIP'                                39880006
398900                                   TO DP013-PARAGRAPH             39890006
399000         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              39900006
399100                                   TO DP013-MESSAGE-TEXT (1)      39910006
399200         MOVE 'TO SELECT A TVHTRIP ROW'                           39920006
399300                                   TO DP013-MESSAGE-TEXT (2)      39930006
399400         MOVE SQLCA                TO DP013-SQLCA                 39940006
399500         MOVE 'TVHTRIP'            TO DP013-DB2-TABLE-NAME (1)    39950006
399600         SET DP013-DB2-ABEND                                      39960006
399700             DP013-XCTL-DISPLAY-RESTART                           39970006
399800                                   TO TRUE                        39980006
399900         PERFORM DP013-0000-PROCESS-ABEND                         39990006
400000     END-IF.                                                      40000006
400100                                                                  40010006
400200     MOVE 'CE'                     TO VHTRIP-CRT-SRC-CDE.         40020006
400300                                                                  40030006
400400     PERFORM                                                      40040006
400500         WITH TEST AFTER                                          40050006
400600         VARYING PV-RETRY-COUNTER                                 40060006
400700         FROM 1 BY 1                                              40070006
400800         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               40080006
400900             OR (SQLCODE = +0))                                   40090006
401000                                                                  40100006
401100         EXEC SQL                                                 40110006
401200             INSERT  INTO TAUTRIP                                 40120006
401300                    (OWNER_SCAC_ID                                40130006
401400                    ,VEH_NBR                                      40140006
401500                    ,TRIP_ID                                      40150006
401600                    ,TRIP_BEG_DTE                                 40160006
401700                    ,TRIP_BEG_TME                                 40170006
401800                    ,CRT_SRC_CDE                                  40180006
401900                    ,LAST_UPD_DTE                                 40190006
402000                    ,LAST_UPD_TME                                 40200006
402100                    ,LAST_UPD_UID                                 40210006
402200                    ,MANIFEST_NBR                                 40220006
402300                    ,PLND_TRIP_SEQ                                40230006
402400                    ,PLND_ACTVY_CDE                               40240006
402500                    ,REF_TRIP_ID                                  40250006
402600                    ,AUD_STATUS_CDE                               40260006
402700                    ,SPLT_XMIT_IND                                40270006
402800                    ,SPLT_XMIT_DTE                                40280006
402900                    ,SPLT_XMIT_TM )                               40290006
403000            VALUES  (:VHTRIP-OWNER-SCAC-ID                        40300006
403100                    ,:VHTRIP-VEH-NBR                              40310006
403200                       :DN-VEH-NBR                                40320006
403300                    ,:VHTRIP-TRIP-ID                              40330006
403400                    ,:VHTRIP-TRIP-BEG-DTE                         40340006
403500                    ,:VHTRIP-TRIP-BEG-TME                         40350006
403600                    ,:VHTRIP-CRT-SRC-CDE                          40360006
403700                    ,:VHTRIP-LAST-UPD-DTE                         40370006
403800                    ,:VHTRIP-LAST-UPD-TME                         40380006
403900                    ,:VHTRIP-LAST-UPD-UID                         40390006
404000                    ,:VHTRIP-MANIFEST-NBR                         40400006
404100                    ,:VHTRIP-PLND-TRIP-SEQ                        40410006
404200                    ,:VHTRIP-PLND-ACTVY-CDE                       40420006
404300                    ,:VHTRIP-REF-TRIP-ID                          40430006
404400                    ,:ASC-TRIP-STATUS-CDE                         40440006
404500                    ,:VHTRIP-SPLT-XMIT-IND                        40450006
404600                    ,:VHTRIP-SPLT-XMIT-DTE                        40460006
404700                    ,:VHTRIP-SPLT-XMIT-TM )                       40470006
404800         END-EXEC                                                 40480006
404900                                                                  40490006
405000         EVALUATE TRUE                                            40500006
405100             WHEN SQLCODE = +0                                    40510006
405200             WHEN SQLCODE = -904                                  40520006
405300             WHEN SQLCODE = -913                                  40530006
405400                 CONTINUE                                         40540006
405500                                                                  40550006
405600             WHEN SQLWARN0 NOT = SPACES                           40560006
405700             WHEN SQLCODE < +0                                    40570006
405800             WHEN SQLCODE > +0                                    40580006
405900                 MOVE '5400-AUDIT-TVHTRIP'                        40590006
406000                                   TO DP013-PARAGRAPH             40600006
406100                 MOVE 'INSERT A ROW ON TAUTRIP'                   40610006
406200                                   TO DP013-MESSAGE-TEXT(1)       40620006
406300                 MOVE SQLCA        TO DP013-SQLCA                 40630006
406400                 MOVE 'TAUTRIP'    TO DP013-DB2-TABLE-NAME (1)    40640006
406500                 SET DP013-DB2-ABEND                              40650006
406600                     DP013-XCTL-DISPLAY-RESTART TO TRUE           40660006
406700                 PERFORM DP013-0000-PROCESS-ABEND                 40670006
406800         END-EVALUATE                                             40680006
406900     END-PERFORM.                                                 40690006
407000                                                                  40700006
407100     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        40710006
407200         MOVE '5400-AUDIT-TVHTRIP'                                40720006
407300                                   TO DP013-PARAGRAPH             40730006
407400         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              40740006
407500                                   TO DP013-MESSAGE-TEXT (1)      40750006
407600         MOVE 'TO INSERT A TAUTRIP ROW'                           40760006
407700                                   TO DP013-MESSAGE-TEXT (2)      40770006
407800         MOVE SQLCA                TO DP013-SQLCA                 40780006
407900         MOVE 'TAUTRIP'            TO DP013-DB2-TABLE-NAME (1)    40790006
408000         SET DP013-DB2-ABEND                                      40800006
408100             DP013-XCTL-DISPLAY-RESTART                           40810006
408200                                   TO TRUE                        40820006
408300         PERFORM DP013-0000-PROCESS-ABEND                         40830006
408400     END-IF.                                                      40840006
408500                                                                  40850006
408600/                                                                 40860006
408700*----------------------------------------------------------------*40870006
408800* APPLY CHANGES TO A SHIPMENT                                    *40880006
408900*----------------------------------------------------------------*40890006
409000 6000-UPDATE-SHIPMENT.                                            40900006
409100                                                                  40910006
409200     MOVE ASC-KEY-SHIPT-ID       TO DK-SHIPT-ID.                  40920006
409300                                                                  40930006
409400     IF  ASC-PKG-TYP-CDE  = ASC-PKG-TYP-CDE-OLD                   40940006
409500     AND ASC-PKG-QTY-N    = ASC-PKG-QTY-N-OLD                     40950006
409600     AND ASC-GROSS-WGHT-N = ASC-GROSS-WGHT-N-OLD                  40960006
409700     AND ASC-PLT-QTY-N    = ASC-PLT-QTY-N-OLD                     40970006
409800     AND ASC-FRGT-CHRG-N  = ASC-FRGT-CHRG-N-OLD                   40980006
409900     AND ASC-FRGT-TERM    = ASC-FRGT-TERM-OLD                     40990006
410000     AND ASC-KEY-PRO-SCAC-ID  = ASC-PRO-SCAC-ID-OLD               41000006
410100     AND ASC-KEY-PRO-NBR      = ASC-PRO-NBR-OLD                   41010006
410200     AND ASC-KEY-BOL-NBR      = ASC-BOL-NBR-OLD                   41020006
410300     AND ASC-ETA-DTE          = ASC-ETA-DTE-OLD                   41030006
410400     AND ASC-ETA-TIME         = ASC-ETA-TIME-OLD                  41040006
410410* CLT 12-08-2011 WR40574 START                                    41041006
410420     AND ASC-CAN              = ASC-CAN-OLD                       41042006
410430* CLT 12-08-2011 WR40574 END                                      41043006
410500         CONTINUE                                                 41050006
410600     ELSE                                                         41060006
410700         MOVE ASC-PKG-TYP-CDE    TO SHIPMT-PKG-TYP-CDE            41070006
410800         MOVE ASC-PKG-QTY-N      TO SHIPMT-EXPTED-PKG-QTY         41080006
410900         MOVE ASC-GROSS-WGHT-N   TO SHIPMT-EXPTED-GRO-WGHT        41090006
411000         MOVE ASC-PLT-QTY-N      TO SHIPMT-EXPTED-PLT-QTY         41100006
411100         MOVE ASC-FRGT-CHRG-N    TO SHIPMT-FRGT-CHG-AMT           41110006
411200         MOVE ASC-FRGT-TERM      TO SHIPMT-FRGT-TERMS-CDE         41120006
411300         MOVE ASC-KEY-PRO-SCAC-ID TO  SHIPMT-PRO-SCAC-ID          41130006
411400         MOVE ASC-KEY-PRO-NBR    TO   SHIPMT-PRO-NBR              41140006
411500         MOVE ASC-KEY-BOL-NBR    TO   SHIPMT-BOL-NBR              41150006
411600         MOVE ASC-KEY-COMP-PRO-NBR   TO SHIPMT-COMPLETE-PRO-NBR   41160006
411700         MOVE ASC-KEY-COMP-BOL-NBR   TO SHIPMT-COMPLETE-BOL-NBR   41170006
411710* CLT 12-08-2011 WR40574 START                                    41171006
411720         MOVE ASC-CAN                TO SHIPMT-CARR-AUTH-ID       41172006
411730* CLT 12-08-2011 WR40574 END                                      41173006
411800         IF  ASC-ETA-DTE  = SPACES                                41180006
411900         AND ASC-ETA-TIME = SPACES                                41190006
412000             MOVE -1             TO DN-SHIP-EST-AR-TMST           41200006
412100         ELSE                                                     41210006
412200             STRING  ASC-ETA-DTE-CC                               41220006
412300                     ASC-ETA-DTE-YY                               41230006
412400                     '-'                                          41240006
412500                     ASC-ETA-DTE-MM                               41250006
412600                     '-'                                          41260006
412700                     ASC-ETA-DTE-DD                               41270006
412800                     '-'                                          41280006
412900                     ASC-ETA-TIME-HH                              41290006
413000                     '.'                                          41300006
413100                     ASC-ETA-TIME-MM                              41310006
413200                     '.00.000000'                                 41320006
413300                     DELIMITED BY SIZE                            41330006
413400                     INTO SHIPMT-EST-AR-TMST                      41340006
413500             MOVE +1             TO DN-SHIP-EST-AR-TMST           41350006
413600         END-IF                                                   41360006
413700         PERFORM 6100-UPDATE-TSHIPMT                              41370006
413800         PERFORM 8000-AUDIT-TSHIPMT                               41380006
413900     END-IF.                                                      41390006
414000                                                                  41400006
414100*    IF  ASC-SHIPT-STATUS-CDE = ASC-SHIPT-STATUS-CDE-OLD          41410006
414200*        CONTINUE                                                 41420006
414300*    ELSE                                                         41430006
414400*        PERFORM 6110-SELECT-TSHIPST                              41440006
414500*        MOVE ASC-SHIPT-STATUS-CDE                                41450006
414600*                                TO SHIPST-SHIPT-STATUS-CDE       41460006
414700*        PERFORM 6120-INSERT-TSHIPST                              41470006
414800*    END-IF.                                                      41480006
414900                                                                  41490006
415000     MOVE PC-TSYMSG-00059        TO DP020-MSG-NUMBER.             41500006
415100     SET DP020-MSG-INFORMATIONAL TO TRUE.                         41510006
415200                                                                  41520006
415300     IF  ASC-USE-SELECTION-QUEUE                                  41530006
415400         PERFORM 5200-UPDATE-SELECTION-QUEUE                      41540006
415500     END-IF.                                                      41550006
415600                                                                  41560006
415700     PERFORM 3500-SAVE-SCREEN-FIELDS.                             41570006
415800                                                                  41580006
415900/                                                                 41590006
416000*----------------------------------------------------------------*41600006
416100*  UPDATE THE SHIPMENT ROW                                       *41610006
416200*----------------------------------------------------------------*41620006
416300 6100-UPDATE-TSHIPMT.                                             41630006
416400                                                                  41640006
416410* CLT 12-08-2011 WR40574 ADDED CARR-AUTH-ID BELOW                 41641006
416500     PERFORM                                                      41650006
416600         WITH TEST AFTER                                          41660006
416700         VARYING PV-RETRY-COUNTER                                 41670006
416800         FROM 1 BY 1                                              41680006
416900         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               41690006
417000             OR (SQLCODE = +0))                                   41700006
417100                                                                  41710006
417200         EXEC SQL                                                 41720006
417300           UPDATE TSHIPMT                                         41730006
417400              SET LAST_UPD_DTE     = CURRENT DATE                 41740006
417500                 ,LAST_UPD_TME     = CURRENT TIME                 41750006
417600                 ,LAST_UPD_UID     = :DP020-USERID                41760006
417700                 ,PRO_SCAC_ID      = :SHIPMT-PRO-SCAC-ID          41770006
417800                 ,PRO_NBR          = :ASC-PRO-NBR                 41780006
417900                 ,BOL_NBR          = :ASC-BOL-NBR                 41790006
418000                 ,PKG_TYP_CDE      = :SHIPMT-PKG-TYP-CDE          41800006
418100                 ,EXPTED_PKG_QTY   = :SHIPMT-EXPTED-PKG-QTY       41810006
418200                 ,EXPTED_GRO_WGHT  = :SHIPMT-EXPTED-GRO-WGHT      41820006
418300                 ,EXPTED_PLT_QTY   = :SHIPMT-EXPTED-PLT-QTY       41830006
418400                 ,FRGT_CHG_AMT     = :SHIPMT-FRGT-CHG-AMT         41840006
418500                 ,FRGT_TERMS_CDE   = :SHIPMT-FRGT-TERMS-CDE       41850006
418600                 ,EST_AR_TMST      = :SHIPMT-EST-AR-TMST          41860006
418700                                        :DN-SHIP-EST-AR-TMST      41870006
418800                 ,COMPLETE_PRO_NBR = :SHIPMT-COMPLETE-PRO-NBR     41880006
418900                 ,COMPLETE_BOL_NBR = :SHIPMT-COMPLETE-BOL-NBR     41890006
418910                 ,CARR_AUTH_ID     = :SHIPMT-CARR-AUTH-ID         41891006
419000           WHERE  SHIPT_ID = :DK-SHIPT-ID                         41900006
419100         END-EXEC                                                 41910006
419200                                                                  41920006
419300         EVALUATE TRUE                                            41930006
419400             WHEN SQLCODE = +0                                    41940006
419500             WHEN SQLCODE = -904                                  41950006
419600             WHEN SQLCODE = -913                                  41960006
419700                 CONTINUE                                         41970006
419800                                                                  41980006
419900             WHEN SQLWARN0 NOT = SPACES                           41990006
420000             WHEN SQLCODE < +0                                    42000006
420100             WHEN SQLCODE > +0                                    42010006
420200                 MOVE '6100-UPDATE-TSHIPMT'                       42020006
420300                                   TO DP013-PARAGRAPH             42030006
420400                 MOVE 'UPDATE INFO ON TSHIPMT     '               42040006
420500                                   TO DP013-MESSAGE-TEXT(1)       42050006
420600                 MOVE SQLCA        TO DP013-SQLCA                 42060006
420700                 MOVE 'TSHIPMT'    TO DP013-DB2-TABLE-NAME (1)    42070006
420800                 SET DP013-DB2-ABEND                              42080006
420900                     DP013-XCTL-DISPLAY-RESTART TO TRUE           42090006
421000                 PERFORM DP013-0000-PROCESS-ABEND                 42100006
421100         END-EVALUATE                                             42110006
421200     END-PERFORM.                                                 42120006
421300                                                                  42130006
421400     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        42140006
421500         MOVE '6100-UPDATE-TSHIPMT'                               42150006
421600                                   TO DP013-PARAGRAPH             42160006
421700         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              42170006
421800                                   TO DP013-MESSAGE-TEXT (1)      42180006
421900         MOVE 'TO UPDATE A TSHIPMT ROW'                           42190006
422000                                   TO DP013-MESSAGE-TEXT (2)      42200006
422100         MOVE SQLCA                TO DP013-SQLCA                 42210006
422200         MOVE 'TSHIPMT'            TO DP013-DB2-TABLE-NAME (1)    42220006
422300         SET DP013-DB2-ABEND                                      42230006
422400             DP013-XCTL-DISPLAY-RESTART                           42240006
422500                                   TO TRUE                        42250006
422600         PERFORM DP013-0000-PROCESS-ABEND                         42260006
422700     END-IF.                                                      42270006
422800                                                                  42280006
422900/                                                                 42290006
423000*----------------------------------------------------------------*42300006
423100*  SELECT LATEST SHIPMENT STATUS ROW                             *42310006
423200*----------------------------------------------------------------*42320006
423300 6110-SELECT-TSHIPST.                                             42330006
423400                                                                  42340006
423500     PERFORM                                                      42350006
423600         WITH TEST AFTER                                          42360006
423700         VARYING PV-RETRY-COUNTER                                 42370006
423800         FROM 1 BY 1                                              42380006
423900         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               42390006
424000             OR (SQLCODE = +0))                                   42400006
424100                                                                  42410006
424200         EXEC SQL                                                 42420006
424300             SELECT  A.SHIPT_ID                                   42430006
424400                    ,A.SHIPT_STATUS_CDE                           42440006
424500                    ,A.STATUS_DTE                                 42450006
424600                    ,A.STATUS_TME                                 42460006
424700                    ,A.STATUS_UID                                 42470006
424800                    ,A.DELAY_RSN_CDE                              42480006
424900                    ,CARR_STATUS_CDE                              42490006
425000                    ,TIME_ZONE_CDE                                42500006
425100                    ,CITY_NAME                                    42510006
425200                    ,STATE_CDE                                    42520006
425300             INTO    :SHIPST-SHIPT-ID                             42530006
425400                    ,:SHIPST-SHIPT-STATUS-CDE                     42540006
425500                    ,:SHIPST-STATUS-DTE                           42550006
425600                    ,:SHIPST-STATUS-TME                           42560006
425700                    ,:SHIPST-STATUS-UID                           42570006
425800                    ,:SHIPST-DELAY-RSN-CDE                        42580006
425900                    ,:SHIPST-CARR-STATUS-CDE                      42590006
426000                    ,:SHIPST-TIME-ZONE-CDE                        42600006
426100                    ,:SHIPST-CITY-NAME                            42610006
426200                    ,:SHIPST-STATE-CDE                            42620006
426300           FROM   TSHIPST A                                       42630006
426400                 ,TSHSTYP B                                       42640006
426500           WHERE  A.SHIPT_ID   = :DK-SHIPT-ID                     42650006
426600             AND  B.PRTY_CDE =                                    42660006
426700                  (SELECT MAX(D.PRTY_CDE)                         42670006
426800                     FROM TSHIPST C                               42680006
426900                         ,TSHSTYP D                               42690006
427000                    WHERE C.SHIPT_ID         = A.SHIPT_ID         42700006
427100                      AND C.SHIPT_STATUS_CDE = D.SHIPT_STATUS_CDE)42710006
427200             AND  A.SHIPT_STATUS_CDE = B.SHIPT_STATUS_CDE         42720006
427300         END-EXEC                                                 42730006
427400                                                                  42740006
427500         EVALUATE TRUE                                            42750006
427600             WHEN SQLCODE = +0                                    42760006
427700             WHEN SQLCODE = -904                                  42770006
427800             WHEN SQLCODE = -913                                  42780006
427900                 CONTINUE                                         42790006
428000                                                                  42800006
428100             WHEN SQLWARN0 NOT = SPACES                           42810006
428200             WHEN SQLCODE < +0                                    42820006
428300             WHEN SQLCODE > +0                                    42830006
428400                 MOVE '6110-SELECT-TSHIPST'                       42840006
428500                                   TO DP013-PARAGRAPH             42850006
428600                 MOVE 'SELECT A TSHIPST ROW   '                   42860006
428700                                   TO DP013-MESSAGE-TEXT(1)       42870006
428800                 MOVE SQLCA        TO DP013-SQLCA                 42880006
428900                 MOVE 'TSHIPST'    TO DP013-DB2-TABLE-NAME (1)    42890006
429000                 SET DP013-DB2-ABEND                              42900006
429100                     DP013-XCTL-DISPLAY-RESTART TO TRUE           42910006
429200                 PERFORM DP013-0000-PROCESS-ABEND                 42920006
429300         END-EVALUATE                                             42930006
429400     END-PERFORM.                                                 42940006
429500                                                                  42950006
429600     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        42960006
429700         MOVE '6110-SELECT-TSHIPST'                               42970006
429800                                   TO DP013-PARAGRAPH             42980006
429900         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              42990006
430000                                   TO DP013-MESSAGE-TEXT (1)      43000006
430100         MOVE 'TO SELECT A TSHIPST ROW'                           43010006
430200                                   TO DP013-MESSAGE-TEXT (2)      43020006
430300         MOVE SQLCA                TO DP013-SQLCA                 43030006
430400         MOVE 'TSHIPST'            TO DP013-DB2-TABLE-NAME (1)    43040006
430500         SET DP013-DB2-ABEND                                      43050006
430600             DP013-XCTL-DISPLAY-RESTART                           43060006
430700                                   TO TRUE                        43070006
430800         PERFORM DP013-0000-PROCESS-ABEND                         43080006
430900     END-IF.                                                      43090006
431000                                                                  43100006
431100/                                                                 43110006
431200*----------------------------------------------------------------*43120006
431300*  INSERT A SHIPMENT STATUS ROW                                  *43130006
431400*----------------------------------------------------------------*43140006
431500 6120-INSERT-TSHIPST.                                             43150006
431600                                                                  43160006
431700     PERFORM                                                      43170006
431800         WITH TEST AFTER                                          43180006
431900         VARYING PV-RETRY-COUNTER                                 43190006
432000         FROM 1 BY 1                                              43200006
432100         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               43210006
432200             OR (SQLCODE = +0))                                   43220006
432300                                                                  43230006
432400         EXEC SQL                                                 43240006
432500             INSERT  INTO TSHIPST                                 43250006
432600                    (SHIPT_ID                                     43260006
432700                    ,SHIPT_STATUS_CDE                             43270006
432800                    ,STATUS_DTE                                   43280006
432900                    ,STATUS_TME                                   43290006
433000                    ,STATUS_UID                                   43300006
433100                    ,DELAY_RSN_CDE                                43310006
433200                    ,CARR_STATUS_CDE                              43320006
433300                    ,TIME_ZONE_CDE                                43330006
433400                    ,CITY_NAME                                    43340006
433500                    ,STATE_CDE )                                  43350006
433600            VALUES  (:SHIPST-SHIPT-ID                             43360006
433700                    ,:SHIPST-SHIPT-STATUS-CDE                     43370006
433800                    ,CURRENT DATE                                 43380006
433900                    ,CURRENT TIME                                 43390006
434000                    ,:DP020-USERID                                43400006
434100                    ,:SHIPST-DELAY-RSN-CDE                        43410006
434200                    ,:SHIPST-CARR-STATUS-CDE                      43420006
434300                    ,:SHIPST-TIME-ZONE-CDE                        43430006
434400                    ,:SHIPST-CITY-NAME                            43440006
434500                    ,:SHIPST-STATE-CDE )                          43450006
434600         END-EXEC                                                 43460006
434700                                                                  43470006
434800         EVALUATE TRUE                                            43480006
434900             WHEN SQLCODE = +0                                    43490006
435000             WHEN SQLCODE = -904                                  43500006
435100             WHEN SQLCODE = -913                                  43510006
435200                 CONTINUE                                         43520006
435300                                                                  43530006
435400             WHEN SQLWARN0 NOT = SPACES                           43540006
435500             WHEN SQLCODE < +0                                    43550006
435600             WHEN SQLCODE > +0                                    43560006
435700                 MOVE '6120-INSERT-TSHIPST'                       43570006
435800                                   TO DP013-PARAGRAPH             43580006
435900                 MOVE 'INSERT A ROW ON TSHIPST'                   43590006
436000                                   TO DP013-MESSAGE-TEXT(1)       43600006
436100                 MOVE SQLCA        TO DP013-SQLCA                 43610006
436200                 MOVE 'TSHIPST'    TO DP013-DB2-TABLE-NAME (1)    43620006
436300                 SET DP013-DB2-ABEND                              43630006
436400                     DP013-XCTL-DISPLAY-RESTART TO TRUE           43640006
436500                 PERFORM DP013-0000-PROCESS-ABEND                 43650006
436600         END-EVALUATE                                             43660006
436700     END-PERFORM.                                                 43670006
436800                                                                  43680006
436900     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        43690006
437000         MOVE '6120-INSERT-TSHIPST'                               43700006
437100                                   TO DP013-PARAGRAPH             43710006
437200         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              43720006
437300                                   TO DP013-MESSAGE-TEXT (1)      43730006
437400         MOVE 'TO INSERT A TSHIPST ROW'                           43740006
437500                                   TO DP013-MESSAGE-TEXT (2)      43750006
437600         MOVE SQLCA                TO DP013-SQLCA                 43760006
437700         MOVE 'TSHIPST'            TO DP013-DB2-TABLE-NAME (1)    43770006
437800         SET DP013-DB2-ABEND                                      43780006
437900             DP013-XCTL-DISPLAY-RESTART                           43790006
438000                                   TO TRUE                        43800006
438100         PERFORM DP013-0000-PROCESS-ABEND                         43810006
438200     END-IF.                                                      43820006
438300                                                                  43830006
438400/                                                                 43840006
438500*----------------------------------------------------------------*43850006
438600* DELETE A SHIPMENT                                              *43860006
438700*----------------------------------------------------------------*43870006
438800 7000-DELETE-SHIPMENT.                                            43880006
438900                                                                  43890006
439000     MOVE ASC-KEY-SHIPT-ID       TO DK-SHIPT-ID.                  43900006
439100                                                                  43910006
439200     PERFORM 6110-SELECT-TSHIPST.                                 43920006
439300                                                                  43930006
439400     MOVE 'DE'                   TO SHIPST-SHIPT-STATUS-CDE.      43940006
439500     PERFORM 6120-INSERT-TSHIPST.                                 43950006
439600                                                                  43960006
439700     MOVE ASC-KEY-SHIPT-ID TO DK-SHIPT-ID.                        43970006
439800     MOVE 'N' TO PS-SHPTPO-CURSOR-SW.                             43980006
439900     SET PS-DONT-UPDATE-TIMPORL TO TRUE.                          43990006
440000     PERFORM 7010-OPEN-SHPTPO-CUR.                                44000006
440100     PERFORM 7020-FETCH-SHPTPO-CUR.                               44010006
440200     PERFORM UNTIL PS-NO-MORE-SHPTPO                              44020006
440300             PERFORM 7040-SELECT-TSHPTPO                          44030006
440400             IF PS-UPDATE-TIMPORL                                 44040006
440500                PERFORM 7050-UPDATE-TIMPORL                       44050006
440600             END-IF                                               44060006
440700             PERFORM 7020-FETCH-SHPTPO-CUR                        44070006
440800     END-PERFORM.                                                 44080006
440900     PERFORM 7030-CLOSE-SHPTPO-CUR.                               44090006
441000                                                                  44100006
441100     MOVE PC-TSYMSG-00115        TO DP020-MSG-NUMBER.             44110006
441200     SET DP020-MSG-INFORMATIONAL                                  44120006
441300         ASC-DELETE-SUCCESSFUL   TO TRUE.                         44130006
441400                                                                  44140006
441500     IF  ASC-USE-SELECTION-QUEUE                                  44150006
441600         PERFORM 5200-UPDATE-SELECTION-QUEUE                      44160006
441700     END-IF.                                                      44170006
441800/                                                                 44180006
441900*----------------------------------------------------------------*44190006
442000* OPEN THE SHPTPO CURSOR                                         *44200006
442100*----------------------------------------------------------------*44210006
442200                                                                  44220006
442300 7010-OPEN-SHPTPO-CUR.                                            44230006
442400                                                                  44240006
442500     PERFORM                                                      44250006
442600         WITH TEST AFTER                                          44260006
442700         VARYING PV-RETRY-COUNTER                                 44270006
442800         FROM 1 BY 1                                              44280006
442900         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               44290006
443000            OR (SQLCODE = +0))                                    44300006
443100                                                                  44310006
443200         EXEC SQL                                                 44320006
443300              OPEN SHPTPO_CUR                                     44330006
443400         END-EXEC                                                 44340006
443500                                                                  44350006
443600         EVALUATE TRUE                                            44360006
443700             WHEN SQLCODE = +0                                    44370006
443800                  CONTINUE                                        44380006
443900             WHEN SQLCODE = -904                                  44390006
444000             WHEN SQLCODE = -913                                  44400006
444100                  CONTINUE                                        44410006
444200             WHEN SQLWARN0 NOT = SPACE                            44420006
444300             WHEN SQLCODE  NOT = +0                               44430006
444400                  MOVE '7010-OPEN-SHPTPO-CUR'                     44440006
444500                                   TO DP013-PARAGRAPH             44450006
444600                  MOVE 'OPEN SHPTPO CURSOR'                       44460006
444700                                   TO DP013-MESSAGE-TEXT (1)      44470006
444800                  MOVE DK-SHIPT-ID                                44480006
444900                                   TO DP013-MESSAGE-TEXT (2)      44490006
445000                  MOVE SQLCA       TO DP013-SQLCA                 44500006
445100                  MOVE 'TSHPTPO'   TO DP013-DB2-TABLE-NAME (1)    44510006
445200                  SET DP013-DB2-ABEND                             44520006
445300                                   TO TRUE                        44530006
445400                  PERFORM DP013-0000-PROCESS-ABEND                44540006
445500         END-EVALUATE                                             44550006
445600     END-PERFORM.                                                 44560006
445700                                                                  44570006
445800     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        44580006
445900             AND (SQLCODE NOT = +0)                               44590006
446000         MOVE '7010-OPEN-SHPTPO-CUR'                              44600006
446100                                   TO DP013-PARAGRAPH             44610006
446200         MOVE 'MAX RETRIES EXCEEDED FOR OPEN SHPTPO CURSOR'       44620006
446300                                   TO DP013-MESSAGE-TEXT (1)      44630006
446400         MOVE SQLCA                TO DP013-SQLCA                 44640006
446500         SET DP013-DB2-ABEND       TO TRUE                        44650006
446600         PERFORM DP013-0000-PROCESS-ABEND                         44660006
446700     END-IF.                                                      44670006
446800                                                                  44680006
446900/                                                                 44690006
447000*----------------------------------------------------------------*44700006
447100*    FETCH A SHPTPO ROW                                          *44710006
447200*----------------------------------------------------------------*44720006
447300                                                                  44730006
447400 7020-FETCH-SHPTPO-CUR.                                           44740006
447500                                                                  44750006
447600     EXEC SQL                                                     44760006
447700          FETCH SHPTPO_CUR                                        44770006
447800          INTO :SHPTPO-PO-NBR                                     44780006
447900     END-EXEC                                                     44790006
448000                                                                  44800006
448100     EVALUATE TRUE                                                44810006
448200         WHEN SQLCODE = +0                                        44820006
448300              CONTINUE                                            44830006
448400                                                                  44840006
448500         WHEN SQLCODE = +100                                      44850006
448600              SET PS-NO-MORE-SHPTPO TO TRUE                       44860006
448700                                                                  44870006
448800         WHEN SQLWARN0 NOT = SPACE                                44880006
448900         WHEN SQLCODE < +0                                        44890006
449000         WHEN SQLCODE > +0                                        44900006
449100              MOVE '7020-FETCH-SHPTPO-CUR'                        44910006
449200                                   TO DP013-PARAGRAPH             44920006
449300              MOVE 'FETCH SHPTPO CURSOR'                          44930006
449400                                   TO DP013-MESSAGE-TEXT (1)      44940006
449500              MOVE SHPTPO-SHIPT-ID TO DP013-MESSAGE-TEXT (2)      44950006
449600              MOVE SQLCA           TO DP013-SQLCA                 44960006
449700              MOVE 'TSHPTPO'       TO DP013-DB2-TABLE-NAME (1)    44970006
449800              SET DP013-DB2-ABEND  TO TRUE                        44980006
449900              PERFORM DP013-0000-PROCESS-ABEND                    44990006
450000     END-EVALUATE.                                                45000006
450100                                                                  45010006
450200/                                                                 45020006
450300*----------------------------------------------------------------*45030006
450400* CLOSE THE SHPTPO CURSOR                                        *45040006
450500*----------------------------------------------------------------*45050006
450600                                                                  45060006
450700 7030-CLOSE-SHPTPO-CUR.                                           45070006
450800                                                                  45080006
450900     EXEC SQL                                                     45090006
451000          CLOSE SHPTPO_CUR                                        45100006
451100     END-EXEC                                                     45110006
451200                                                                  45120006
451300     EVALUATE TRUE                                                45130006
451400         WHEN SQLCODE = +0                                        45140006
451500              CONTINUE                                            45150006
451600         WHEN SQLWARN0 NOT = SPACE                                45160006
451700         WHEN SQLCODE  NOT = +0                                   45170006
451800              MOVE '7030-CLOSE-SHPTPO-CUR'                        45180006
451900                                   TO DP013-PARAGRAPH             45190006
452000              MOVE 'CLOSE SHPTPO CURSOR'                          45200006
452100                                   TO DP013-MESSAGE-TEXT (1)      45210006
452200              MOVE SQLCA           TO DP013-SQLCA                 45220006
452300              MOVE 'TSHPTPO'       TO DP013-DB2-TABLE-NAME (1)    45230006
452400              SET DP013-DB2-ABEND  TO TRUE                        45240006
452500              PERFORM DP013-0000-PROCESS-ABEND                    45250006
452600     END-EVALUATE.                                                45260006
452700                                                                  45270006
452800/                                                                 45280006
452900 7040-SELECT-TSHPTPO.                                             45290006
453000                                                                  45300006
453100         EXEC SQL                                                 45310006
453200              SELECT  DISTINCT                                    45320006
453300                      PO_NBR                                      45330006
453400                INTO  :SHPTPO-PO-NBR                              45340006
453500                FROM  TSHPTPO SP                                  45350006
453600                    , TSHSTYP Y                                   45360006
453700                    , TSHIPST X                                   45370006
453800               WHERE  SP.SHIPT_ID = X.SHIPT_ID                    45380006
453900                 AND  SP.PO_NBR   =  :SHPTPO-PO-NBR               45390006
454000                 AND  Y.SHIPT_STATUS_CDE = X.SHIPT_STATUS_CDE     45400006
454100                 AND  Y.PRTY_CDE =                                45410006
454200                      (SELECT MAX(TY.PRTY_CDE)                    45420006
454300                         FROM   TSHIPST ST                        45430006
454400                              , TSHSTYP TY                        45440006
454500                        WHERE ST.SHIPT_ID = X.SHIPT_ID            45450006
454600                          AND ST.SHIPT_STATUS_CDE =               45460006
454700                              TY.SHIPT_STATUS_CDE)                45470006
454800                 AND  Y.PRTY_CDE < '95'                           45480006
454900         END-EXEC                                                 45490006
455000                                                                  45500006
455100         EVALUATE TRUE                                            45510006
455200             WHEN SQLCODE = +100                                  45520006
455300                  SET PS-UPDATE-TIMPORL TO TRUE                   45530006
455400                                                                  45540006
455500             WHEN SQLCODE = ZERO                                  45550006
455600             WHEN SQLCODE = -904                                  45560006
455700             WHEN SQLCODE = -913                                  45570006
455800                  SET PS-DONT-UPDATE-TIMPORL TO TRUE              45580006
455900                                                                  45590006
456000             WHEN SQLWARN0 NOT = SPACES                           45600006
456100             WHEN SQLCODE < +0                                    45610006
456200             WHEN SQLCODE > +0                                    45620006
456300                  MOVE '7040-SELECT-TSHPTPO'                      45630006
456400                                  TO DP013-PARAGRAPH              45640006
456500                  MOVE 'UNSUCCESSFUL SELECT ON TSHPTPO  '         45650006
456600                                  TO DP013-MESSAGE-TEXT (1)       45660006
456700                  MOVE SQLCA      TO DP013-SQLCA                  45670006
456800                  MOVE 'TSHPTPO ' TO DP013-DB2-TABLE-NAME (1)     45680006
456900                  SET DP013-DB2-ABEND                             45690006
457000                      DP013-XCTL-DISPLAY-RESTART                  45700006
457100                                  TO TRUE                         45710006
457200                  PERFORM DP013-0000-PROCESS-ABEND                45720006
457300         END-EVALUATE.                                            45730006
457400/                                                                 45740006
457500 7050-UPDATE-TIMPORL.                                             45750006
457600                                                                  45760006
457700     PERFORM                                                      45770006
457800         WITH TEST AFTER                                          45780006
457900         VARYING PV-RETRY-COUNTER                                 45790006
458000         FROM 1 BY 1                                              45800006
458100         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               45810006
458200             OR (SQLCODE = +0))                                   45820006
458300                                                                  45830006
458400         EXEC SQL                                                 45840006
458500           UPDATE TIMPORL                                         45850006
458600              SET DCONSLR_RLSE_CDE = 'N'                          45860006
458700                 ,DCONSLR_ACTL_DTE = CURRENT DATE                 45870006
458800                 ,DCONSLR_ACTL_TM  = CURRENT TIME                 45880006
458900                 ,LAST_UPD_TMST   = CURRENT TIMESTAMP             45890006
459000                 ,LAST_UPD_BY_UID = :DP020-USERID                 45900006
459100           WHERE  PO_NBR   = :SHPTPO-PO-NBR                       45910006
459200             AND  VER_STATUS_CDE = 'A'                            45920006
459300         END-EXEC                                                 45930006
459400                                                                  45940006
459500         EVALUATE TRUE                                            45950006
459600             WHEN SQLCODE = +0                                    45960006
459700             WHEN SQLCODE = -904                                  45970006
459800             WHEN SQLCODE = -913                                  45980006
459900                 CONTINUE                                         45990006
460000                                                                  46000006
460100             WHEN SQLWARN0 NOT = SPACES                           46010006
460200             WHEN SQLCODE < +0                                    46020006
460300             WHEN SQLCODE > +0                                    46030006
460400                 MOVE '7050-UPDATE-TIMPORL'                       46040006
460500                                   TO DP013-PARAGRAPH             46050006
460600                 MOVE 'UPDATE INFO ON TIMPORL     '               46060006
460700                                   TO DP013-MESSAGE-TEXT(1)       46070006
460800                 MOVE SQLCA        TO DP013-SQLCA                 46080006
460900                 MOVE 'TIMPORL'    TO DP013-DB2-TABLE-NAME (1)    46090006
461000                 SET DP013-DB2-ABEND                              46100006
461100                     DP013-XCTL-DISPLAY-RESTART TO TRUE           46110006
461200                 PERFORM DP013-0000-PROCESS-ABEND                 46120006
461300         END-EVALUATE                                             46130006
461400     END-PERFORM.                                                 46140006
461500                                                                  46150006
461600     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    46160006
461700         SQLCODE NOT = +0                                         46170006
461800         MOVE '7050-UPDATE-TIMPORL'                               46180006
461900                                   TO DP013-PARAGRAPH             46190006
462000         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              46200006
462100                                   TO DP013-MESSAGE-TEXT (1)      46210006
462200         MOVE 'TO UPDATE A TIMPORL ROW'                           46220006
462300                                   TO DP013-MESSAGE-TEXT (2)      46230006
462400         MOVE SQLCA                TO DP013-SQLCA                 46240006
462500         MOVE 'TIMPORL'            TO DP013-DB2-TABLE-NAME (1)    46250006
462600         SET DP013-DB2-ABEND                                      46260006
462700             DP013-XCTL-DISPLAY-RESTART                           46270006
462800                                   TO TRUE                        46280006
462900         PERFORM DP013-0000-PROCESS-ABEND                         46290006
463000     END-IF.                                                      46300006
463100/                                                                 46310006
463200                                                                  46320006
463300 7600-READ-DUPL-TVHTRIP.                                          46330006
463400                                                                  46340006
463500     MOVE DP902-RANDOM-NUMBER   TO PV-CURR-TRIP-ID.               46350015
463600                                                                  46360006
463700     PERFORM                                                      46370006
463800         WITH TEST AFTER                                          46380006
463900         VARYING PV-RETRY-COUNTER                                 46390006
464000         FROM 1 BY 1                                              46400006
464100         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               46410006
464200             OR (SQLCODE = +0))                                   46420006
464300                                                                  46430006
464400         EXEC SQL                                                 46440006
464500              SELECT COUNT(*)                                     46450006
464600               INTO :PV-VHTRIP-COUNT                              46460006
464700                FROM  TVHTRIP                                     46470006
464800               WHERE (TRIP_ID         = :PV-CURR-TRIP-ID)         46480006
464900         END-EXEC                                                 46490006
465000                                                                  46500006
465100         EVALUATE TRUE                                            46510006
465200             WHEN SQLCODE = +0                                    46520006
465300             WHEN SQLCODE = -904                                  46530006
465400             WHEN SQLCODE = -913                                  46540006
465500                 CONTINUE                                         46550006
465600                                                                  46560006
465700             WHEN SQLWARN0 NOT = SPACES                           46570006
465800             WHEN SQLCODE < +0                                    46580006
465900             WHEN SQLCODE > +0                                    46590006
466000                 MOVE '7600-READ-DUPL-TVHTRIP'                    46600006
466100                                   TO DP013-PARAGRAPH             46610006
466200                 MOVE 'GET COUNT OF TRIPS'                        46620006
466300                                   TO DP013-MESSAGE-TEXT(1)       46630006
466400                 MOVE SQLCA        TO DP013-SQLCA                 46640006
466500                 MOVE 'TVHTRIP'    TO DP013-DB2-TABLE-NAME (1)    46650006
466600                 SET DP013-DB2-ABEND                              46660006
466700                     DP013-XCTL-DISPLAY-RESTART TO TRUE           46670006
466800                 PERFORM DP013-0000-PROCESS-ABEND                 46680006
466900         END-EVALUATE                                             46690006
467000     END-PERFORM.                                                 46700006
467100                                                                  46710006
467200     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        46720006
467300         MOVE '7600-READ-DUPL-TVHTRIP'                            46730006
467400                                   TO DP013-PARAGRAPH             46740006
467500         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              46750006
467600                                   TO DP013-MESSAGE-TEXT (1)      46760006
467700         MOVE 'TO COUNT TVHTRIP ROWS'                             46770006
467800                                   TO DP013-MESSAGE-TEXT (2)      46780006
467900         MOVE SQLCA                TO DP013-SQLCA                 46790006
468000         MOVE 'TVHTRIP'            TO DP013-DB2-TABLE-NAME (1)    46800006
468100         SET DP013-DB2-ABEND                                      46810006
468200             DP013-XCTL-DISPLAY-RESTART                           46820006
468300                                   TO TRUE                        46830006
468400         PERFORM DP013-0000-PROCESS-ABEND                         46840006
468500     END-IF.                                                      46850006
468600     IF PV-VHTRIP-COUNT > 0                                       46860006
468700         PERFORM 5050-GET-RANDOM-NUMBER                           46870006
468800     END-IF.                                                      46880006
468900/                                                                 46890006
469000*----------------------------------------------------------------*46900006
469100*  TAKE A SNAPSHOT OF THE AFTER  IMAGE OF TSHIPMT AND WRITE      *46910006
469200*  TO THE AUDIT TABLE.                                           *46920006
469300*----------------------------------------------------------------*46930006
469400 8000-AUDIT-TSHIPMT.                                              46940006
469500                                                                  46950006
469600     INITIALIZE DCLTAUSHIP.                                       46960006
469700                                                                  46970006
469710* CLT 12-08-2011 WR40574 ADDED CARR-AUTH-ID BELOW                 46971006
469800     PERFORM                                                      46980006
469900         WITH TEST AFTER                                          46990006
470000         VARYING PV-RETRY-COUNTER                                 47000006
470100         FROM 1 BY 1                                              47010006
470200         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               47020006
470300             OR (SQLCODE = +0))                                   47030006
470400                                                                  47040006
470500         EXEC SQL                                                 47050006
470600             SELECT  TRIP_ID                                      47060006
470700                    ,SHIPT_ID                                     47070006
470800                    ,CRT_SRC_CDE                                  47080006
470900                    ,LAST_UPD_DTE                                 47090006
471000                    ,LAST_UPD_TME                                 47100006
471100                    ,LAST_UPD_UID                                 47110006
471200                    ,PRO_SCAC_ID                                  47120006
471300                    ,PRO_NBR                                      47130006
471400                    ,BOL_NBR                                      47140006
471500                    ,SHIPPER_NME                                  47150006
471600                    ,SHIPT_TYP_CDE                                47160006
471700                    ,EXPTED_GRO_WGHT                              47170006
471800                    ,PKG_TYP_CDE                                  47180006
471900                    ,EXPTED_PKG_QTY                               47190006
472000                    ,FRGT_CHG_AMT                                 47200006
472100                    ,FRGT_TERMS_CDE                               47210006
472200                    ,EXPTED_PLT_QTY                               47220006
472300                    ,VEND_SHIP_DTE                                47230006
472400                    ,EST_AR_TMST                                  47240006
472500                    ,ORIG_SCAC_ID                                 47250006
472600                    ,LAST_UPD_PGM_ID                              47260006
472700                    ,CRE_USER_ID                                  47270006
472800                    ,CARR_CART_CT                                 47280006
472900                    ,CARR_LAST_UPD_DTE                            47290006
473000                    ,CARR_LAST_UPD_TIME                           47300006
473100                    ,VEND_CART_CT                                 47310006
473200                    ,VEND_LAST_UPD_DTE                            47320006
473300                    ,VEND_LAST_UPD_TIME                           47330006
473400                    ,VEH_NBR                                      47340006
473500                    ,AUTH_NBR                                     47350006
473600                    ,AUTH_DTE                                     47360006
473700                    ,CONFIRM_DTE                                  47370006
473800                    ,CONFIRM_TIME                                 47380006
473900                    ,COMPLETE_PRO_NBR                             47390006
474000                    ,COMPLETE_BOL_NBR                             47400006
474100                    ,PROCESSED_DTE                                47410006
474200                    ,INVC_NBR                                     47420006
474210                    ,CARR_AUTH_ID                                 47421006
474300            INTO     :SHIPMT-TRIP-ID                              47430006
474400                       :DN-TRIP-ID                                47440006
474500                    ,:SHIPMT-SHIPT-ID                             47450006
474600                    ,:SHIPMT-CRT-SRC-CDE                          47460006
474700                    ,:SHIPMT-LAST-UPD-DTE                         47470006
474800                    ,:SHIPMT-LAST-UPD-TME                         47480006
474900                    ,:SHIPMT-LAST-UPD-UID                         47490006
475000                    ,:SHIPMT-PRO-SCAC-ID                          47500006
475100                    ,:SHIPMT-PRO-NBR                              47510006
475200                    ,:SHIPMT-BOL-NBR                              47520006
475300                    ,:SHIPMT-SHIPPER-NME                          47530006
475400                    ,:SHIPMT-SHIPT-TYP-CDE                        47540006
475500                    ,:SHIPMT-EXPTED-GRO-WGHT                      47550006
475600                    ,:SHIPMT-PKG-TYP-CDE                          47560006
475700                    ,:SHIPMT-EXPTED-PKG-QTY                       47570006
475800                    ,:SHIPMT-FRGT-CHG-AMT                         47580006
475900                    ,:SHIPMT-FRGT-TERMS-CDE                       47590006
476000                    ,:SHIPMT-EXPTED-PLT-QTY                       47600006
476100                    ,:SHIPMT-VEND-SHIP-DTE                        47610006
476200                    ,:SHIPMT-EST-AR-TMST                          47620006
476300                       :DN-SHIP-EST-AR-TMST                       47630006
476400                    ,:SHIPMT-ORIG-SCAC-ID                         47640006
476500                    ,:SHIPMT-LAST-UPD-PGM-ID                      47650006
476600                    ,:SHIPMT-CRE-USER-ID                          47660006
476700                    ,:SHIPMT-CARR-CART-CT                         47670006
476800                    ,:SHIPMT-CARR-LAST-UPD-DTE                    47680006
476900                    ,:SHIPMT-CARR-LAST-UPD-TIME                   47690006
477000                    ,:SHIPMT-VEND-CART-CT                         47700006
477100                    ,:SHIPMT-VEND-LAST-UPD-DTE                    47710006
477200                    ,:SHIPMT-VEND-LAST-UPD-TIME                   47720006
477300                    ,:SHIPMT-VEH-NBR                              47730006
477400                    ,:SHIPMT-AUTH-NBR                             47740006
477500                    ,:SHIPMT-AUTH-DTE                             47750006
477600                    ,:SHIPMT-CONFIRM-DTE                          47760006
477700                    ,:SHIPMT-CONFIRM-TIME                         47770006
477800                    ,:SHIPMT-COMPLETE-PRO-NBR                     47780006
477900                    ,:SHIPMT-COMPLETE-BOL-NBR                     47790006
478000                    ,:SHIPMT-PROCESSED-DTE                        47800006
478100                    ,:SHIPMT-INVC-NBR                             47810006
478110                    ,:SHIPMT-CARR-AUTH-ID                         47811006
478200           FROM   TSHIPMT                                         47820006
478300           WHERE  SHIPT_ID = :DK-SHIPT-ID                         47830006
478400         END-EXEC                                                 47840006
478500                                                                  47850006
478600         EVALUATE TRUE                                            47860006
478700             WHEN SQLCODE = +0                                    47870006
478800             WHEN SQLCODE = -904                                  47880006
478900             WHEN SQLCODE = -913                                  47890006
479000                 CONTINUE                                         47900006
479100                                                                  47910006
479200             WHEN SQLWARN0 NOT = SPACES                           47920006
479300             WHEN SQLCODE < +0                                    47930006
479400             WHEN SQLCODE > +0                                    47940006
479500                 MOVE '8000-AUDIT-TSHIPMT'                        47950006
479600                                   TO DP013-PARAGRAPH             47960006
479700                 MOVE 'SELECT A TSHIPMT ROW   '                   47970006
479800                                   TO DP013-MESSAGE-TEXT(1)       47980006
479900                 MOVE SQLCA        TO DP013-SQLCA                 47990006
480000                 MOVE 'TSHIPMT'    TO DP013-DB2-TABLE-NAME (1)    48000006
480100                 SET DP013-DB2-ABEND                              48010006
480200                     DP013-XCTL-DISPLAY-RESTART TO TRUE           48020006
480300                 PERFORM DP013-0000-PROCESS-ABEND                 48030006
480400         END-EVALUATE                                             48040006
480500     END-PERFORM.                                                 48050006
480600                                                                  48060006
480700     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        48070006
480800         MOVE '8000-AUDIT-TSHIPMT '                               48080006
480900                                   TO DP013-PARAGRAPH             48090006
481000         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              48100006
481100                                   TO DP013-MESSAGE-TEXT (1)      48110006
481200         MOVE 'TO SELECT A TSHIPMT ROW'                           48120006
481300                                   TO DP013-MESSAGE-TEXT (2)      48130006
481400         MOVE SQLCA                TO DP013-SQLCA                 48140006
481500         MOVE 'TSHIPMT'            TO DP013-DB2-TABLE-NAME (1)    48150006
481600         SET DP013-DB2-ABEND                                      48160006
481700             DP013-XCTL-DISPLAY-RESTART                           48170006
481800                                   TO TRUE                        48180006
481900         PERFORM DP013-0000-PROCESS-ABEND                         48190006
482000     END-IF.                                                      48200006
482100                                                                  48210006
482110* CLT 12-08-2011 WR40574 ADDED CARR-AUTH-ID BELOW                 48211006
482200     PERFORM                                                      48220006
482300         WITH TEST AFTER                                          48230006
482400         VARYING PV-RETRY-COUNTER                                 48240006
482500         FROM 1 BY 1                                              48250006
482600         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               48260006
482700             OR (SQLCODE = +0))                                   48270006
482800                                                                  48280006
482900         EXEC SQL                                                 48290006
483000             INSERT  INTO TAUSHIP                                 48300006
483100                    (TRIP_ID                                      48310006
483200                    ,SHIPT_ID                                     48320006
483300                    ,CRT_SRC_CDE                                  48330006
483400                    ,LAST_UPD_DTE                                 48340006
483500                    ,LAST_UPD_TME                                 48350006
483600                    ,LAST_UPD_UID                                 48360006
483700                    ,PRO_SCAC_ID                                  48370006
483800                    ,PRO_NBR                                      48380006
483900                    ,BOL_NBR                                      48390006
484000                    ,SHIPPER_NME                                  48400006
484100                    ,SHIPT_TYP_CDE                                48410006
484200                    ,EXPTED_GRO_WGHT                              48420006
484300                    ,PKG_TYP_CDE                                  48430006
484400                    ,EXPTED_PKG_QTY                               48440006
484500                    ,FRGT_CHG_AMT                                 48450006
484600                    ,FRGT_TERMS_CDE                               48460006
484700                    ,EST_AR_TMST                                  48470006
484800                    ,VEND_SHIP_DTE                                48480006
484900                    ,EXPTED_PLT_QTY                               48490006
485000                    ,ORIG_SCAC_ID                                 48500006
485100                    ,LAST_UPD_PGM_ID                              48510006
485200                    ,CRE_USER_ID                                  48520006
485300                    ,CARR_CART_CT                                 48530006
485400                    ,CARR_LAST_UPD_DTE                            48540006
485500                    ,CARR_LAST_UPD_TIME                           48550006
485600                    ,VEND_CART_CT                                 48560006
485700                    ,VEND_LAST_UPD_DTE                            48570006
485800                    ,VEND_LAST_UPD_TIME                           48580006
485900                    ,VEH_NBR                                      48590006
486000                    ,AUTH_NBR                                     48600006
486100                    ,AUTH_DTE                                     48610006
486200                    ,CONFIRM_DTE                                  48620006
486300                    ,CONFIRM_TIME                                 48630006
486400                    ,PROCESSED_DTE                                48640006
486500                    ,INVC_NBR                                     48650006
486600                    ,AUD_STATUS_CDE                               48660006
486610                    ,CARR_AUTH_ID  )                              48661006
486700            VALUES  (:SHIPMT-TRIP-ID                              48670006
486800                       :DN-TRIP-ID                                48680006
486900                    ,:SHIPMT-SHIPT-ID                             48690006
487000                    ,:SHIPMT-CRT-SRC-CDE                          48700006
487100                    ,:SHIPMT-LAST-UPD-DTE                         48710006
487200                    ,:SHIPMT-LAST-UPD-TME                         48720006
487300                    ,:SHIPMT-LAST-UPD-UID                         48730006
487400                    ,:SHIPMT-PRO-SCAC-ID                          48740006
487500                    ,:SHIPMT-COMPLETE-PRO-NBR                     48750006
487600                    ,:SHIPMT-COMPLETE-BOL-NBR                     48760006
487700                    ,:SHIPMT-SHIPPER-NME                          48770006
487800                    ,:SHIPMT-SHIPT-TYP-CDE                        48780006
487900                    ,:SHIPMT-EXPTED-GRO-WGHT                      48790006
488000                    ,:SHIPMT-PKG-TYP-CDE                          48800006
488100                    ,:SHIPMT-EXPTED-PKG-QTY                       48810006
488200                    ,:SHIPMT-FRGT-CHG-AMT                         48820006
488300                    ,:SHIPMT-FRGT-TERMS-CDE                       48830006
488400                    ,:SHIPMT-EST-AR-TMST                          48840006
488500                       :DN-SHIP-EST-AR-TMST                       48850006
488600                    ,:SHIPMT-VEND-SHIP-DTE                        48860006
488700                    ,:SHIPMT-EXPTED-PLT-QTY                       48870006
488800                    ,:SHIPMT-ORIG-SCAC-ID                         48880006
488900                    ,:SHIPMT-LAST-UPD-PGM-ID                      48890006
489000                    ,:SHIPMT-CRE-USER-ID                          48900006
489100                    ,:SHIPMT-CARR-CART-CT                         48910006
489200                    ,:SHIPMT-CARR-LAST-UPD-DTE                    48920006
489300                    ,:SHIPMT-CARR-LAST-UPD-TIME                   48930006
489400                    ,:SHIPMT-VEND-CART-CT                         48940006
489500                    ,:SHIPMT-VEND-LAST-UPD-DTE                    48950006
489600                    ,:SHIPMT-VEND-LAST-UPD-TIME                   48960006
489700                    ,:SHIPMT-VEH-NBR                              48970006
489800                    ,:SHIPMT-AUTH-NBR                             48980006
489900                    ,:SHIPMT-AUTH-DTE                             48990006
490000                    ,:SHIPMT-CONFIRM-DTE                          49000006
490100                    ,:SHIPMT-CONFIRM-TIME                         49010006
490200                    ,:SHIPMT-PROCESSED-DTE                        49020006
490300                    ,:SHIPMT-INVC-NBR                             49030006
490400                    ,:ASC-SHIPT-STATUS-CDE                        49040006
490410                    ,:SHIPMT-CARR-AUTH-ID  )                      49041006
490500         END-EXEC                                                 49050006
490600                                                                  49060006
490700         EVALUATE TRUE                                            49070006
490800             WHEN SQLCODE = +0                                    49080006
490900             WHEN SQLCODE = -904                                  49090006
491000             WHEN SQLCODE = -913                                  49100006
491100                 CONTINUE                                         49110006
491200                                                                  49120006
491300             WHEN SQLWARN0 NOT = SPACES                           49130006
491400             WHEN SQLCODE < +0                                    49140006
491500             WHEN SQLCODE > +0                                    49150006
491600                 MOVE '8000-AUDIT-TSHIPMT '                       49160006
491700                                   TO DP013-PARAGRAPH             49170006
491800                 MOVE 'INSERT A ROW ON TAUSHIP'                   49180006
491900                                   TO DP013-MESSAGE-TEXT(1)       49190006
492000                 MOVE SQLCA        TO DP013-SQLCA                 49200006
492100                 MOVE 'TAUSHIP'    TO DP013-DB2-TABLE-NAME (1)    49210006
492200                 SET DP013-DB2-ABEND                              49220006
492300                     DP013-XCTL-DISPLAY-RESTART TO TRUE           49230006
492400                 PERFORM DP013-0000-PROCESS-ABEND                 49240006
492500         END-EVALUATE                                             49250006
492600     END-PERFORM.                                                 49260006
492700                                                                  49270006
492800     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        49280006
492900         MOVE '8000-AUDIT-TSHIPMT'                                49290006
493000                                   TO DP013-PARAGRAPH             49300006
493100         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              49310006
493200                                   TO DP013-MESSAGE-TEXT (1)      49320006
493300         MOVE 'TO INSERT A TAUSHIP ROW'                           49330006
493400                                   TO DP013-MESSAGE-TEXT (2)      49340006
493500         MOVE SQLCA                TO DP013-SQLCA                 49350006
493600         MOVE 'TAUSHIP'            TO DP013-DB2-TABLE-NAME (1)    49360006
493700         SET DP013-DB2-ABEND                                      49370006
493800             DP013-XCTL-DISPLAY-RESTART                           49380006
493900                                   TO TRUE                        49390006
494000         PERFORM DP013-0000-PROCESS-ABEND                         49400006
494100     END-IF.                                                      49410006
494200                                                                  49420006
494300/                                                                 49430006
494400*----------------------------------------------------------------*49440006
494500* READ AN ITEM FROM THE SELECTED ITEMS TEMP STORAGE QUEUE.       *49450006
494600*----------------------------------------------------------------*49460006
494700                                                                  49470006
494800 9100-READ-SEL-QUEUE.                                             49480006
494900     EXEC CICS                                                    49490006
495000         READQ TS                                                 49500006
495100             QUEUE (ASC-SEL-QUEUE-NAME)                           49510006
495200             INTO  (TR006-DOCK-SCHEDULE-REC)                      49520006
495300             ITEM  (ASC-SEL-ITEM)                                 49530006
495400             RESP  (PV-CICS-RESPONSE)                             49540006
495500     END-EXEC.                                                    49550006
495600                                                                  49560006
495700     IF  PV-CICS-RESPONSE EQUAL DFHRESP(NORMAL)                   49570006
495800         CONTINUE                                                 49580006
495900     ELSE                                                         49590006
496000         SET DP013-LOGIC-ABEND                                    49600006
496100             DP013-NO-ROLLBACK     TO TRUE                        49610006
496200         MOVE '9100-READ-SEL-QUEUE'                               49620006
496300                                   TO DP013-PARAGRAPH             49630006
496400         MOVE 'ATTEMPTING TO READ THE LIST SELECTIONS TS QUEUE'   49640006
496500                                   TO DP013-MESSAGE-TEXT (1)      49650006
496600         PERFORM DP013-0000-PROCESS-ABEND                         49660006
496700     END-IF.                                                      49670006
496800                                                                  49680006
496900/                                                                 49690006
497000*----------------------------------------------------------------*49700006
497100* UPDATE AN ITEM IN THE SELECTED ITEMS TEMP STORAGE QUEUE.       *49710006
497200*----------------------------------------------------------------*49720006
497300 9200-REWRITE-LIST-QUEUE.                                         49730006
497400                                                                  49740006
497500     EXEC CICS                                                    49750006
497600          WRITEQ TS                                               49760006
497700              QUEUE  (ASC-SEL-QUEUE-NAME)                         49770006
497800              FROM   (TR006-DOCK-SCHEDULE-REC)                    49780006
497900              ITEM   (ASC-SEL-ITEM)                               49790006
498000              RESP   (PV-CICS-RESPONSE)                           49800006
498100              REWRITE                                             49810006
498200     END-EXEC.                                                    49820006
498300                                                                  49830006
498400     IF  PV-CICS-RESPONSE NOT EQUAL DFHRESP(NORMAL)               49840006
498500         SET DP013-CICS-ABEND                                     49850006
498600             DP013-NO-ROLLBACK     TO TRUE                        49860006
498700         MOVE '9200-REWRITE-LIST-QUEUE'                           49870006
498800                                   TO DP013-PARAGRAPH             49880006
498900         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   49890006
499000                                   TO DP013-MESSAGE-TEXT (1)      49900006
499100         PERFORM DP013-0000-PROCESS-ABEND                         49910006
499200     END-IF.                                                      49920006
499300                                                                  49930006
499400/                                                                 49940006
499500*----------------------------------------------------------------*49950006
499600*    ABEND PROCESSOR MODULE                                      *49960006
499700*----------------------------------------------------------------*49970006
499800                                                                  49980006
499900     COPY DPPD013.                                                49990006
