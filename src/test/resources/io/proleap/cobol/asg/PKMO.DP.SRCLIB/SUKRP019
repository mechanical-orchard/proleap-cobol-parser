000100***************************************************************** 00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300***************************************************************** 00030000
000400 PROGRAM-ID.             SUKRP019.                                00040031
000500 AUTHOR.                 JOE LAROSA.                              00050032
000600 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00060032
000700 DATE-WRITTEN            SEPTEMBER 1999.                          00070032
000800 DATE-COMPILED.                                                   00080032
000900***************************************************************** 00090032
001000*  THIS PROGRAM WILL CREATE THE WEEKLY SUMMARY REPORT OF CARTONS* 00100032
001100*  SCANNED.  THE PROGRAM READS AN INPUT FILE CREATED OUT OF     * 00110032
001200*  PGM SUKUT026 AND SORTED BY DC PRIOR TO BEING READ.           * 00120032
001300*  THIS REPORT PROGRAM WILL ACCUMULATE & REPORT COUNTS FOR A DC * 00130032
001400*  BY...   NUMBER OF CARTONS SCANNED                            * 00140000
001500*          NUMBER OF CARTONS SCANNED FOR RASCAL PRINTER         * 00150032
001600*          NUMBER OF CARTONS SCANNED FOR COMTEC PRINTER         * 00160000
001700*          NUMBER OF CARTONS SCANNED FOR 4X4 BATCH PRINTING     * 00170000
001800*          NUMBER OF CARTONS SCANNED FOR 4X4 CABLE PRINTER      * 00180000
001900*          NUMBER OF CARTONS SCANNED WITHOUT PRINTING LABEL     * 00190000
002000*          NUMBER OF PACK-BY-STORE CARTONS SCANNED              * 00200000
002100*          NUMBER OF BULK CARTONS SCANNED                       * 00210000
002200***************************************************************** 00220000
002300*  CHANGED MM/DD/YY BY XXXXXXXXXXX                              * 00230000
002400*   WR# XXXX XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX * 00240000
002500*                                                               * 00250000
002600***************************************************************** 00260000
002700***************************************************************** 00270000
002800 ENVIRONMENT DIVISION.                                            00280000
002900***************************************************************** 00290000
003000                                                                  00300000
003100 CONFIGURATION SECTION.                                           00310000
003200                                                                  00320000
003300 SOURCE-COMPUTER.        IBM-3090.                                00330000
003400 OBJECT-COMPUTER.        IBM-3090.                                00340000
003500                                                                  00350000
003600 INPUT-OUTPUT SECTION.                                            00360000
003700                                                                  00370000
003800 FILE-CONTROL.                                                    00380000
003900*                                                                 00390000
004000     SELECT DATE-FILE                                             00400000
004100         ASSIGN TO INP01.                                         00410000
004200*                                                                 00420000
004300     SELECT CARTON-EXTRACT-FILE                                   00430000
004400         ASSIGN TO INP02.                                         00440000
004500*                                                                 00450000
004600     SELECT WEEKLY-SUMMARY-RPT-FILE                               00460000
004700         ASSIGN TO RPT01.                                         00470000
004800*                                                                 00480000
004900***************************************************************** 00490000
005000 DATA DIVISION.                                                   00500000
005100***************************************************************** 00510000
005200 FILE SECTION.                                                    00520000
005300*                                                                 00530000
005400 FD  DATE-FILE                                                    00540000
005500     RECORDING MODE IS F                                          00550000
005600     LABEL RECORDS ARE STANDARD                                   00560000
005700     RECORD CONTAINS 80                                           00570000
005800     BLOCK CONTAINS 0 RECORDS                                     00580000
005900     DATA RECORD IS DATE-RECORD.                                  00590000
006000 01  DATE-RECORD                     PIC  X(80).                  00600000
006100*                                                                 00610000
006200 FD  CARTON-EXTRACT-FILE                                          00620000
006300     RECORDING MODE IS F                                          00630000
006400     LABEL RECORDS ARE STANDARD                                   00640000
006500     BLOCK CONTAINS 0 RECORDS                                     00650000
006600     RECORD CONTAINS 100 CHARACTERS.                              00660029
006700 01  CARTON-EXTRACT-RECORD           PIC  X(100).                 00670029
006800*                                                                 00680000
006900 FD  WEEKLY-SUMMARY-RPT-FILE                                      00690000
007000     RECORDING MODE IS F                                          00700000
007100     BLOCK CONTAINS 0  RECORDS.                                   00710000
007200 01  SUMMARY-RPT-RECORD              PIC  X(132).                 00720000
007300*                                                                 00730000
007400***************************************************************** 00740000
007500 WORKING-STORAGE SECTION.                                         00750000
007600*                                                                 00760000
007700 01  PA-PROGRAM-ACCUMULATORS.                                     00770000
007800     05  PA-DC-ACCUMULATORS.                                      00780000
008000         10  PA-DC-4X4-APPLY-CNT     PIC 9(09) VALUE ZEROES.      00800032
008100         10  PA-DC-4X4-BATCH-CNT     PIC 9(09) VALUE ZEROES.      00810000
008200         10  PA-DC-4X4-PEEL-CNT      PIC 9(09) VALUE ZEROES.      00820031
008300         10  PA-DC-TOT-LABEL-CNT     PIC 9(09) VALUE ZEROES.      00830000
008400         10  PA-DC-NO-LABEL-CNT      PIC 9(09) VALUE ZEROES.      00840000
008500         10  PA-DC-TOT-CHECKED-CNT   PIC 9(09) VALUE ZEROES.      00850000
008600         10  PA-DC-PBS-CHECKED-CNT   PIC 9(09) VALUE ZEROES.      00860000
008700         10  PA-DC-BULK-CHECKED-CNT  PIC 9(09) VALUE ZEROES.      00870000
008800     05  PA-TL-ACCUMULATORS.                                      00880000
009000         10  PA-TL-4X4-APPLY-CNT     PIC 9(09) VALUE ZEROES.      00900032
009100         10  PA-TL-4X4-BATCH-CNT     PIC 9(09) VALUE ZEROES.      00910000
009200         10  PA-TL-4X4-PEEL-CNT      PIC 9(09) VALUE ZEROES.      00920031
009300         10  PA-TL-TOT-LABEL-CNT     PIC 9(09) VALUE ZEROES.      00930000
009400         10  PA-TL-NO-LABEL-CNT      PIC 9(09) VALUE ZEROES.      00940000
009500         10  PA-TL-TOT-CHECKED-CNT   PIC 9(09) VALUE ZEROES.      00950000
009600         10  PA-TL-PBS-CHECKED-CNT   PIC 9(09) VALUE ZEROES.      00960000
009700         10  PA-TL-BULK-CHECKED-CNT  PIC 9(09) VALUE ZEROES.      00970000
009800*                                                                 00980000
009900 01  PROGRAM-SWITCHES.                                            00990000
010000     05  PS-END-OF-INPUT-FILE-SW     PIC X(01) VALUE 'N'.         01000000
010100         88  PS-END-OF-INPUT                   VALUE 'Y'.         01010000
010200         88  PS-NOT-END-OF-INPUT               VALUE 'N'.         01020000
010210     05  PS-VALID-DC-SW              PIC X(01) VALUE 'N'.         01021032
010220         88  PS-VALID-DC                       VALUE 'Y'.         01022032
010230         88  PS-NOT-VALID-DC                   VALUE 'N'.         01023032
010240     05  PS-START-UP-SW              PIC X(01) VALUE 'Y'.         01024034
010250         88  PS-START-UP                       VALUE 'Y'.         01025034
010260         88  PS-NOT-START-UP                   VALUE 'N'.         01026034
010300*                                                                 01030000
010400 01  PC-PROGRAM-CONSTANTS.                                        01040032
010500     05  PC-SUKRP019                 PIC X(08) VALUE              01050000
010600                                               'SUKRP019'.        01060028
010700     05  PC-REPORT-NBR               PIC X(02) VALUE '-1'.        01070000
010800*                                                                 01080000
010900 01  PV-PROGRAM-VARIABLES.                                        01090000
010910     05  PV-VALID-DC-NBR             PIC S9(4) VALUE 9999         01091032
010920                                               COMP.              01092032
011000     05  PV-PARAGRAPH-NAME           PIC X(30) VALUE SPACE.       01100028
011100     05  PV-PAGE-COUNT               PIC S9(4) VALUE ZERO         01110000
011200                                                   COMP-3.        01120000
011300     05  PV-LINE-COUNT               PIC S9(3) VALUE ZERO         01130000
011400                                                   COMP-3.        01140000
011500     05  PV-MAX-LINE-COUNT           PIC S9(3) VALUE +60          01150000
011600                                                   COMP-3.        01160000
011700     05  PV-OPER-UNT-ID              PIC S9(4) VALUE ZERO         01170033
011800                                                   COMP.          01180032
011900     05  PV-DISPLAY-OPER-UNIT-ID     PIC ZZZZ9 VALUE ZERO.        01190032
012100     05  PV-TODAYS-DATE.                                          01210000
012200         10  PV-TODAYS-DATE-YY       PIC 9(02) VALUE ZERO.        01220000
012300         10  PV-TODAYS-DATE-MM       PIC 9(02) VALUE ZERO.        01230000
012400         10  PV-TODAYS-DATE-DD       PIC 9(02) VALUE ZERO.        01240000
012500     05  PV-TODAYS-TIME.                                          01250000
012600         10  PV-TODAYS-TIME-HH       PIC 9(02) VALUE ZERO.        01260000
012700         10  PV-TODAYS-TIME-MM       PIC 9(02) VALUE ZERO.        01270000
012800         10  PV-TODAYS-TIME-SS       PIC 9(02) VALUE ZERO.        01280000
012900         10  FILLER                  PIC 9(02) VALUE ZERO.        01290000
013000*                                                                 01300000
013100 01  PV-DATE-RECORD.                                              01310000
013200     05  PV-DATE-START-MM             PIC X(02) VALUE SPACE.      01320000
013300     05  FILLER                       PIC X(01) VALUE '/'.        01330000
013400     05  PV-DATE-START-DD             PIC X(02) VALUE SPACE.      01340000
013500     05  FILLER                       PIC X(01) VALUE '/'.        01350000
013600     05  PV-DATE-START-CCYY           PIC X(04) VALUE SPACE.      01360000
013700     05  FILLER                       PIC X(01) VALUE SPACE.      01370000
013800     05  PV-DATE-END-MM               PIC X(02) VALUE SPACE.      01380000
013900     05  FILLER                       PIC X(01) VALUE '/'.        01390000
014000     05  PV-DATE-END-DD               PIC X(02) VALUE SPACE.      01400000
014100     05  FILLER                       PIC X(01) VALUE '/'.        01410000
014200     05  PV-DATE-END-CCYY             PIC X(04) VALUE SPACE.      01420000
014300     05  FILLER                       PIC X(01) VALUE SPACE.      01430000
014400     05  PV-DATE-FISCAL-PERIOD        PIC 9(02) VALUE ZEROES.     01440000
014500     05  FILLER                       PIC X(01) VALUE SPACE.      01450000
014600     05  PV-DATE-FISCAL-QUARTER       PIC 9(01) VALUE ZERO.       01460000
014700     05  FILLER                       PIC X(01) VALUE SPACE.      01470000
014800     05  PV-REQUEST                   PIC X(07) VALUE SPACES.     01480000
014900     05  FILLER                       PIC X(46) VALUE SPACES.     01490000
015000*                                                                 01500000
015100*                                                                 01510000
015200 01  DK-DB2-KEY-FIELDS.                                           01520000
015300     05  DK-LOC-NBR                  PIC S9(4)  VALUE ZERO        01530032
015310                                                 COMP.            01531032
015400*                                                                 01540000
015500 01  ABEND-CODE                      PIC S9(4)  VALUE +0          01550000
015600                                                 COMP SYNC.       01560028
015700*                                                                 01570000
015800******************************************************************01580000
015900* COPY BOOK FOR CARTON CHECK-IN EXTRACT.                          01590000
016000******************************************************************01600000
016100     COPY SURD007.                                                01610000
016200*                                                                 01620000
016300******************************************************************01630000
016400*  DB2 FORMATTED MESSAGE AREA                                     01640000
016500******************************************************************01650000
016600     COPY DPWS004.                                                01660000
016700*                                                                 01670000
016800******************************************************************01680000
016900*  WORK FIELDS FOR PRINTING A 132 CHARACTER REPORT.               01690000
017000******************************************************************01700000
017100     COPY DPWS132O.                                               01710000
017200*                                                                 01720000
017300 01  HEADING-LINES.                                               01730000
017400     05  HEADING-LINE-1.                                          01740000
017500         10  FILLER                  PIC  X(02)    VALUE SPACES.  01750000
017600         10  HL1-SPECIAL             PIC  X(45)    VALUE SPACES.  01760000
017700         10  FILLER                  PIC  X(38)    VALUE          01770000
017800             'UCC-128 CARTON CHECK-IN SUMMARY BY DC '.            01780000
017900         10  FILLER                  PIC  X(47)    VALUE SPACES.  01790000
018000*                                                                 01800000
018100     05  HEADING-LINE-2.                                          01810000
018200         10  FILLER                  PIC  X(45)    VALUE SPACES.  01820000
018300         10  FILLER                  PIC  X(15)    VALUE          01830000
018400             'TIME PERIOD OF '.                                   01840000
018500         10  HL2-DATE-FROM.                                       01850000
018600             15  HL2-DATE-FROM-MM    PIC  X(02)    VALUE SPACES.  01860000
018700             15  FILLER              PIC  X(01)    VALUE '-'.     01870000
018800             15  HL2-DATE-FROM-DD    PIC  X(02)    VALUE SPACES.  01880000
018900             15  FILLER              PIC  X(01)    VALUE '-'.     01890000
019000             15  HL2-DATE-FROM-CCYY  PIC  X(04)    VALUE SPACES.  01900000
019100         10  FILLER                  PIC  X(06)    VALUE          01910000
019200             ' THRU '.                                            01920000
019300         10  HL2-DATE-TO.                                         01930000
019400             15  HL2-DATE-TO-MM      PIC  X(02)    VALUE SPACES.  01940000
019500             15  FILLER              PIC  X(01)    VALUE '-'.     01950000
019600             15  HL2-DATE-TO-DD      PIC  X(02)    VALUE SPACES.  01960000
019700             15  FILLER              PIC  X(01)    VALUE '-'.     01970000
019800             15  HL2-DATE-TO-CCYY    PIC  X(04)    VALUE SPACES.  01980000
019900         10  FILLER                  PIC  X(46)    VALUE SPACES.  01990000
020000*                                                                 02000000
020100     05  HEADING-LINE-3.                                          02010000
020200         10  FILLER                  PIC  X(27)    VALUE SPACE.   02020036
020500         10  FILLER                  PIC  X(13)    VALUE          02050036
020600             '4X4 P&APPLY  '.                                     02060036
020700         10  FILLER                  PIC  X(12)    VALUE          02070000
020800             ' 4X4 BATCH  '.                                      02080000
020900         10  FILLER                  PIC  X(12)    VALUE          02090000
021000             ' 4X4 P&PEEL '.                                      02100030
021100         10  FILLER                  PIC  X(12)    VALUE          02110000
021200             '   TOTAL    '.                                      02120000
021300         10  FILLER                  PIC  X(12)    VALUE          02130000
021400             '    NO      '.                                      02140000
021500         10  FILLER                  PIC  X(12)    VALUE          02150000
021600             '   TOTAL    '.                                      02160000
021700         10  FILLER                  PIC  X(12)    VALUE          02170000
021800             'PACK-BY-STR '.                                      02180000
021900         10  FILLER                  PIC  X(12)    VALUE          02190000
022000             '   BULK     '.                                      02200000
022100         10  FILLER                  PIC  X(06)    VALUE SPACES.  02210000
022200*                                                                 02220000
022300     05  HEADING-LINE-4.                                          02230000
022400         10  FILLER                  PIC  X(30)    VALUE SPACE.   02240032
022700         10  FILLER                  PIC  X(12)    VALUE          02270000
022800             ' LABEL      '.                                      02280000
022900         10  FILLER                  PIC  X(12)    VALUE          02290000
023000             ' LABEL      '.                                      02300000
023100         10  FILLER                  PIC  X(12)    VALUE          02310000
023200             ' LABEL      '.                                      02320000
023300         10  FILLER                  PIC  X(12)    VALUE          02330000
023400             ' LABEL      '.                                      02340000
023500         10  FILLER                  PIC  X(12)    VALUE          02350000
023600             ' LABEL      '.                                      02360000
023700         10  FILLER                  PIC  X(12)    VALUE          02370000
023800             'CARTONS     '.                                      02380000
023900         10  FILLER                  PIC  X(12)    VALUE          02390000
024000             'CARTONS     '.                                      02400000
024100         10  FILLER                  PIC  X(12)    VALUE          02410000
024200             'CARTONS     '.                                      02420000
024300         10  FILLER                  PIC  X(06)    VALUE SPACES.  02430000
024400*                                                                 02440000
024500     05  HEADING-LINE-5.                                          02450000
024600         10  FILLER                  PIC  X(02)    VALUE SPACES.  02460000
024700         10  FILLER                  PIC  X(16)    VALUE          02470000
024800             'DC              '.                                  02480000
024900         10  FILLER                  PIC  X(12)    VALUE          02490000
025000             '            '.                                      02500032
025100         10  FILLER                  PIC  X(12)    VALUE          02510000
025200             ' COUNT      '.                                      02520000
025300         10  FILLER                  PIC  X(12)    VALUE          02530000
025400             ' COUNT      '.                                      02540000
025500         10  FILLER                  PIC  X(12)    VALUE          02550000
025600             ' COUNT      '.                                      02560000
025700         10  FILLER                  PIC  X(12)    VALUE          02570000
025800             ' COUNT      '.                                      02580000
025900         10  FILLER                  PIC  X(09)    VALUE          02590000
026000             ' COUNT   '.                                         02600000
026100         10  FILLER                  PIC  X(12)    VALUE          02610000
026200             ' CHECKED-IN '.                                      02620000
026300         10  FILLER                  PIC  X(12)    VALUE          02630000
026400             ' CHECKED-IN '.                                      02640000
026500         10  FILLER                  PIC  X(12)    VALUE          02650000
026600             ' CHECKED-IN '.                                      02660000
026700         10  FILLER                  PIC  X(09)    VALUE SPACES.  02670000
026800*                                                                 02680000
026900     05  HEADING-LINE-6.                                          02690000
026910         10  FILLER                  PIC  X(02)    VALUE SPACES.  02691036
026920         10  FILLER                  PIC  X(13)    VALUE          02692036
026930             '----------   '.                                     02693036
027300         10  FILLER                  PIC  X(12)    VALUE SPACES.  02730036
027500         10  FILLER                  PIC  X(12)    VALUE          02750000
027600             ' ---------  '.                                      02760000
027700         10  FILLER                  PIC  X(12)    VALUE          02770000
027800             ' ---------  '.                                      02780000
027900         10  FILLER                  PIC  X(12)    VALUE          02790000
028000             ' ---------  '.                                      02800000
028100         10  FILLER                  PIC  X(12)    VALUE          02810000
028200             ' ---------  '.                                      02820000
028300         10  FILLER                  PIC  X(12)    VALUE          02830000
028400             ' ---------  '.                                      02840000
028500         10  FILLER                  PIC  X(12)    VALUE          02850000
028600             ' ---------  '.                                      02860000
028700         10  FILLER                  PIC  X(12)    VALUE          02870000
028800             ' ---------  '.                                      02880000
028900         10  FILLER                  PIC  X(12)    VALUE          02890000
029000             ' ---------  '.                                      02900000
029100         10  FILLER                  PIC  X(09)    VALUE SPACES.  02910000
029200*                                                                 02920000
029300 01  DETAIL-LINES.                                                02930000
029400     05  DETAIL-LINE1.                                            02940000
029500         10  FILLER                 PIC  X(02)     VALUE SPACES.  02950000
029600         10  DL1-DC-NAME            PIC  X(10)     VALUE SPACES.  02960000
029700         10  FILLER                 PIC  X(16)     VALUE SPACES.  02970032
030000         10  DL1-4X4-APPLY-CNT      PIC  Z,ZZZ,ZZ9 VALUE ZEROES.  03000032
030100         10  FILLER                 PIC  X(03)     VALUE SPACES.  03010000
030200         10  DL1-4X4-BATCH-CNT      PIC  Z,ZZZ,ZZ9 VALUE ZEROES.  03020000
030300         10  FILLER                 PIC  X(03)     VALUE SPACES.  03030000
030400         10  DL1-4X4-PEEL-CNT       PIC  Z,ZZZ,ZZ9 VALUE ZEROES.  03040031
030500         10  FILLER                 PIC  X(03)     VALUE SPACES.  03050000
030600         10  DL1-TOT-LABEL-CNT      PIC  Z,ZZZ,ZZ9 VALUE ZEROES.  03060000
030700         10  FILLER                 PIC  X(03)     VALUE SPACES.  03070000
030800         10  DL1-NO-LABEL-CNT       PIC  Z,ZZZ,ZZ9 VALUE ZEROES.  03080000
030900         10  FILLER                 PIC  X(03)     VALUE SPACES.  03090000
031000         10  DL1-TOT-CHECKED-CNT    PIC  Z,ZZZ,ZZ9 VALUE ZEROES.  03100000
031100         10  FILLER                 PIC  X(03)     VALUE SPACES.  03110000
031200         10  DL1-PBS-CHECKED-CNT    PIC  Z,ZZZ,ZZ9 VALUE ZEROES.  03120000
031300         10  FILLER                 PIC  X(03)     VALUE SPACES.  03130000
031400         10  DL1-BULK-CHECKED-CNT   PIC  Z,ZZZ,ZZ9 VALUE ZEROES.  03140000
031500         10  FILLER                 PIC  X(11)     VALUE SPACES.  03150000
031600*                                                                 03160000
031700 01  TOTAL-LINES.                                                 03170000
031800     05  TOTAL-LINE1.                                             03180028
031900         10  FILLER                  PIC  X(02)    VALUE SPACES.  03190028
032000         10  FILLER                  PIC  X(13)    VALUE          03200028
032100             '             '.                                     03210028
032200         10  FILLER                  PIC  X(12)    VALUE SPACES.  03220036
032400         10  FILLER                  PIC  X(12)    VALUE          03240028
032500             ' =========  '.                                      03250028
032600         10  FILLER                  PIC  X(12)    VALUE          03260028
032700             ' =========  '.                                      03270028
032800         10  FILLER                  PIC  X(12)    VALUE          03280028
032900             ' =========  '.                                      03290028
033000         10  FILLER                  PIC  X(12)    VALUE          03300028
033100             ' =========  '.                                      03310028
033200         10  FILLER                  PIC  X(12)    VALUE          03320028
033300             ' =========  '.                                      03330028
033400         10  FILLER                  PIC  X(12)    VALUE          03340028
033500             ' =========  '.                                      03350028
033600         10  FILLER                  PIC  X(12)    VALUE          03360028
033700             ' =========  '.                                      03370028
033800         10  FILLER                  PIC  X(12)    VALUE          03380028
033900             ' =========  '.                                      03390028
034000         10  FILLER                  PIC  X(09)    VALUE SPACES.  03400028
034100     05  TOTAL-LINE2.                                             03410028
034200         10  FILLER                 PIC  X(15)     VALUE          03420032
034300             '  FINAL TOTAL  '.                                   03430032
034500         10  FILLER                 PIC  X(12)     VALUE SPACES.  03450032
034600         10  TL1-4X4-APPLY-CNT      PIC  ZZ,ZZZ,ZZ9 VALUE ZEROES. 03460032
034700         10  FILLER                 PIC  X(02)     VALUE SPACES.  03470032
034800         10  TL1-4X4-BATCH-CNT      PIC  ZZ,ZZZ,ZZ9 VALUE ZEROES. 03480032
034900         10  FILLER                 PIC  X(02)     VALUE SPACES.  03490032
035000         10  TL1-4X4-PEEL-CNT       PIC  ZZ,ZZZ,ZZ9 VALUE ZEROES. 03500032
035100         10  FILLER                 PIC  X(02)     VALUE SPACES.  03510032
035200         10  TL1-TOT-LABEL-CNT      PIC  ZZ,ZZZ,ZZ9 VALUE ZEROES. 03520032
035300         10  FILLER                 PIC  X(02)     VALUE SPACES.  03530032
035400         10  TL1-NO-LABEL-CNT       PIC  ZZ,ZZZ,ZZ9 VALUE ZEROES. 03540032
035500         10  FILLER                 PIC  X(02)     VALUE SPACES.  03550032
035600         10  TL1-TOT-CHECKED-CNT    PIC  ZZ,ZZZ,ZZ9 VALUE ZEROES. 03560032
035700         10  FILLER                 PIC  X(02)     VALUE SPACES.  03570032
035800         10  TL1-PBS-CHECKED-CNT    PIC  ZZ,ZZZ,ZZ9 VALUE ZEROES. 03580032
035900         10  FILLER                 PIC  X(02)     VALUE SPACES.  03590032
036000         10  TL1-BULK-CHECKED-CNT   PIC  ZZ,ZZZ,ZZ9 VALUE ZEROES. 03600032
036100         10  FILLER                 PIC  X(11)     VALUE SPACES.  03610000
036200*                                                                 03620000
036300 01  MISCELLANEOUS-LINES.                                         03630000
036400     05  BLANK-LINE.                                              03640000
036500         10  FILLER                  PIC  X(132)   VALUE SPACES.  03650000
036600     05  NO-DATA-LINE.                                            03660000
036700         10  FILLER                  PIC  X(42)    VALUE SPACES.  03670000
036800         10  FILLER                  PIC  X(47)    VALUE          03680000
036900             '**** NO INFORMATION EXISTS FOR THIS REPORT ****'.   03690000
037000         10  FILLER                  PIC  X(43)    VALUE SPACES.  03700000
037100     05  END-OF-REPORT-LINE.                                      03710000
037200         10  FILLER                  PIC  X(44)    VALUE          03720000
037300             '  ** END OF REPORT **                       '.      03730000
037400         10  FILLER                  PIC  X(44)    VALUE SPACES.  03740000
037500         10  FILLER                  PIC  X(44)    VALUE SPACES.  03750000
037600*                                                                 03760000
037700*                                                                 03770000
037800******************************************************************03780000
037900******************************************************************03790000
038000*  DCLGEN FOR THE LOGISTICS DOMAIN LOCATION MASTER TABLE          03800032
038100*                                                                 03810000
038200     EXEC SQL                                                     03820000
038300          INCLUDE XLT00010                                        03830032
038400     END-EXEC.                                                    03840000
038500*                                                                 03850000
038600***************************************************************** 03860000
038700*  DB2 COMMUNICATION AREA                                         03870000
038800*                                                                 03880000
038900     EXEC SQL                                                     03890000
039000         INCLUDE SQLCA                                            03900000
039100     END-EXEC.                                                    03910000
039200 EJECT                                                            03920000
039300*  DB2 COMMUNICATION AREA2                                        03930000
039400*                                                                 03940000
039500     COPY SQLCA2.                                                 03950000
039600                                                                  03960000
039700 EJECT                                                            03970000
039800                                                                  03980000
039900 PROCEDURE DIVISION.                                              03990000
040000*                                                                 04000000
040100 0000-MAINLINE-PROCESSING.                                        04010000
040200******************************************************************04020000
040300**  THIS IS THE MAIN DRIVER FOR THE PROGRAM.                      04030000
040400******************************************************************04040000
040500     DISPLAY '****** STARTING SUKRP019 ******'.                   04050000
040600*                                                                 04060000
040700*OPEN FILES.                                                      04070000
040800     OPEN INPUT DATE-FILE                                         04080000
040900                CARTON-EXTRACT-FILE                               04090000
041000          OUTPUT WEEKLY-SUMMARY-RPT-FILE.                         04100000
041100*                                                                 04110000
041200*PREPARE REPORT.                                                  04120000
041300     PERFORM 1000-INITIALIZATION.                                 04130000
041400*                                                                 04140000
041500*READ FIRST RECORD.                                               04150000
041600     SET PS-NOT-END-OF-INPUT TO TRUE.                             04160004
041610     PERFORM 3000-READ-EXTRACT-FILE.                              04161034
042100*                                                                 04210000
042200*PROCESS INPUT FILE.                                              04220000
042300     IF PS-END-OF-INPUT                                           04230004
042400         WRITE SUMMARY-RPT-RECORD                                 04240000
042500           FROM NO-DATA-LINE                                      04250000
042600             AFTER ADVANCING 2 LINES                              04260000
042700     ELSE                                                         04270028
042800         MOVE SU007-OPER-UNT-ID TO PV-OPER-UNT-ID                 04280028
042900         PERFORM 2000-PROCESS-INPUT                               04290000
043000             UNTIL PS-END-OF-INPUT.                               04300000
043100*                                                                 04310000
043200*FINISH REPORT.                                                   04320000
043300     WRITE SUMMARY-RPT-RECORD                                     04330000
043400       FROM END-OF-REPORT-LINE                                    04340000
043500         AFTER ADVANCING 2 LINES.                                 04350000
043600*                                                                 04360000
043700*CLOSE FILES.                                                     04370000
043800     CLOSE DATE-FILE                                              04380000
043900           CARTON-EXTRACT-FILE                                    04390000
044000           WEEKLY-SUMMARY-RPT-FILE.                               04400000
044100*                                                                 04410000
044200     GOBACK.                                                      04420000
044300*                                                                 04430000
044400 1000-INITIALIZATION.                                             04440000
044500******************************************************************04450000
044600**  PERFORM THE INITIAL PROCESSING FOR THE PROGRAM.               04460000
044700******************************************************************04470000
044800     INITIALIZE PA-PROGRAM-ACCUMULATORS.                          04480000
044900*                                                                 04490000
045000     ACCEPT PV-TODAYS-DATE                                        04500000
045100       FROM DATE.                                                 04510000
045200*                                                                 04520000
045300     ACCEPT PV-TODAYS-TIME                                        04530000
045400       FROM TIME.                                                 04540000
045500*                                                                 04550000
045600     MOVE PV-TODAYS-DATE-MM  TO DP132O-RUN-MONTH.                 04560000
045700     MOVE PV-TODAYS-DATE-DD  TO DP132O-RUN-DAY.                   04570000
045800     MOVE PV-TODAYS-DATE-YY  TO DP132O-RUN-YEAR.                  04580000
045900*                                                                 04590000
046000     MOVE PV-TODAYS-TIME-HH  TO DP132O-RUN-HOUR.                  04600000
046100     MOVE PV-TODAYS-TIME-MM  TO DP132O-RUN-MINUTE.                04610000
046200*                                                                 04620000
046300     MOVE PC-SUKRP019        TO DP132O-PROGRAM-NAME.              04630000
046400     MOVE PC-REPORT-NBR      TO DP132O-REPORT-NUMBER.             04640000
046500*                                                                 04650000
046600     MOVE +0                 TO PV-PAGE-COUNT.                    04660028
046700*                                                                 04670028
046800     READ DATE-FILE                                               04680004
046900       INTO PV-DATE-RECORD.                                       04690004
047000*                                                                 04700028
047100     MOVE PV-DATE-START-MM   TO HL2-DATE-FROM-MM.                 04710000
047200     MOVE PV-DATE-START-DD   TO HL2-DATE-FROM-DD.                 04720000
047300     MOVE PV-DATE-START-CCYY TO HL2-DATE-FROM-CCYY.               04730000
047400     MOVE PV-DATE-END-MM     TO HL2-DATE-TO-MM.                   04740000
047500     MOVE PV-DATE-END-DD     TO HL2-DATE-TO-DD.                   04750000
047600     MOVE PV-DATE-END-CCYY   TO HL2-DATE-TO-CCYY.                 04760000
047700*                                                                 04770028
047800     PERFORM 1500-PAGE-BREAK.                                     04780000
047900*                                                                 04790000
048000*                                                                 04800000
048100 1500-PAGE-BREAK.                                                 04810000
048200******************************************************************04820000
048300**  WRITES REPORT HEADER LINES FOR FIRST PAGE AND ANY SUBSEQUENT  04830000
048400**  PAGES (AS NEEDED).                                            04840000
048500******************************************************************04850000
048600     ADD +1                  TO PV-PAGE-COUNT.                    04860028
048700     MOVE PV-PAGE-COUNT      TO DP132O-PAGE-NUMBER.               04870028
048800*                                                                 04880028
048900     WRITE SUMMARY-RPT-RECORD                                     04890000
049000       FROM DP132O-STANDRD-HEADER-132-COLS                        04900000
049100         AFTER ADVANCING PAGE.                                    04910000
049200*                                                                 04920000
049300     IF PV-REQUEST = 'SPECIAL'                                    04930000
049400         MOVE '** SPECIAL REQUESTED RUN **' TO HL1-SPECIAL        04940000
049500     END-IF.                                                      04950028
049600     WRITE SUMMARY-RPT-RECORD                                     04960000
049700       FROM HEADING-LINE-1                                        04970000
049800         AFTER ADVANCING 2 LINES.                                 04980000
049900*                                                                 04990000
050000     WRITE SUMMARY-RPT-RECORD                                     05000000
050100       FROM HEADING-LINE-2                                        05010000
050200         AFTER ADVANCING 1 LINE.                                  05020000
050300*                                                                 05030000
050400     WRITE SUMMARY-RPT-RECORD                                     05040000
050500       FROM HEADING-LINE-3                                        05050000
050600         AFTER ADVANCING 2 LINES.                                 05060000
050700*                                                                 05070000
050800     WRITE SUMMARY-RPT-RECORD                                     05080000
050900       FROM HEADING-LINE-4                                        05090000
051000         AFTER ADVANCING 1 LINE.                                  05100000
051100*                                                                 05110000
051200     WRITE SUMMARY-RPT-RECORD                                     05120000
051300       FROM HEADING-LINE-5                                        05130000
051400         AFTER ADVANCING 1 LINE.                                  05140000
051500*                                                                 05150000
051600     WRITE SUMMARY-RPT-RECORD                                     05160000
051700       FROM HEADING-LINE-6                                        05170000
051800         AFTER ADVANCING 1 LINE.                                  05180000
051900*                                                                 05190000
052000     MOVE +11                TO PV-LINE-COUNT.                    05200028
052100*                                                                 05210000
052200 2000-PROCESS-INPUT.                                              05220000
052300******************************************************************05230000
052400**  READ CARTON-EXTRACT-FILE, ACCUMULATING COUNTS FOR A DC.       05240000
052500**  WHEN DC CHANGES, PRINT DETAIL LINE FOR THAT DC, RESET         05250000
052600**  ACCUMULATORS & BEGIN ACCUMULATING FOR NEW DC.  AT END, PRINT  05260000
052700**  LAST DC DETAIL LINE AND A TOTAL ACCUMULATED LINE FOR ALL DCS. 05270000
052800******************************************************************05280000
052900*                                                                 05290000
053000     IF SU007-OPER-UNT-ID NOT = PV-OPER-UNT-ID                    05300000
053010         MOVE PV-OPER-UNT-ID TO                                   05301032
053020              PV-DISPLAY-OPER-UNIT-ID                             05302032
053100         DISPLAY ' OPER-UNT-ID = ' PV-DISPLAY-OPER-UNIT-ID        05310032
053200         PERFORM 2100-PRINT-DETAIL-LINE                           05320000
053300         INITIALIZE PA-DC-ACCUMULATORS                            05330028
053400         MOVE SU007-OPER-UNT-ID TO PV-OPER-UNT-ID                 05340028
053500     END-IF.                                                      05350028
053600*                                                                 05360000
053700*ADD TO DC & TOTAL ACCUMULATORS.                                  05370000
053800     EVALUATE SU007-PRTR-TYP-CDE                                  05380028
053900     WHEN 'R'                                                     05390028
054100       ADD +1  TO PA-DC-4X4-APPLY-CNT                             05410032
054200                  PA-TL-4X4-APPLY-CNT                             05420032
054300                  PA-DC-TOT-LABEL-CNT                             05430000
054400                  PA-TL-TOT-LABEL-CNT                             05440000
054500                  PA-DC-TOT-CHECKED-CNT                           05450037
054600                  PA-TL-TOT-CHECKED-CNT                           05460037
054700       EVALUATE SU007-CRTN-TYP-CDE                                05470037
054800       WHEN 'B'                                                   05480037
054900         ADD +1  TO PA-DC-BULK-CHECKED-CNT                        05490037
054910                    PA-TL-BULK-CHECKED-CNT                        05491037
054920       WHEN 'P'                                                   05492037
054930         ADD +1  TO PA-DC-PBS-CHECKED-CNT                         05493037
054940                    PA-TL-PBS-CHECKED-CNT                         05494037
054950       WHEN OTHER                                                 05495037
054960         DISPLAY '*** UNKNOWN CARTON TYPE CODE ***'               05496037
054970         DISPLAY '  RCD=' SU007-EXTRACT-RECORD                    05497037
054980       END-EVALUATE                                               05498037
055000     WHEN 'B'                                                     05500028
055100       ADD +1  TO PA-DC-4X4-BATCH-CNT                             05510000
055200                  PA-TL-4X4-BATCH-CNT                             05520000
055300                  PA-DC-TOT-LABEL-CNT                             05530000
055400                  PA-TL-TOT-LABEL-CNT                             05540000
055410                  PA-DC-TOT-CHECKED-CNT                           05541037
055420                  PA-TL-TOT-CHECKED-CNT                           05542037
055430       EVALUATE SU007-CRTN-TYP-CDE                                05543037
055440       WHEN 'B'                                                   05544037
055450         ADD +1  TO PA-DC-BULK-CHECKED-CNT                        05545037
055460                    PA-TL-BULK-CHECKED-CNT                        05546037
055470       WHEN 'P'                                                   05547037
055480         ADD +1  TO PA-DC-PBS-CHECKED-CNT                         05548037
055490                    PA-TL-PBS-CHECKED-CNT                         05549037
055491       WHEN OTHER                                                 05549137
055492         DISPLAY '*** UNKNOWN CARTON TYPE CODE ***'               05549237
055493         DISPLAY '  RCD=' SU007-EXTRACT-RECORD                    05549337
055494       END-EVALUATE                                               05549437
055500     WHEN 'P'                                                     05550030
055600       ADD +1  TO PA-DC-4X4-PEEL-CNT                              05560031
055700                  PA-TL-4X4-PEEL-CNT                              05570031
055800                  PA-DC-TOT-LABEL-CNT                             05580000
055900                  PA-TL-TOT-LABEL-CNT                             05590000
055910                  PA-DC-TOT-CHECKED-CNT                           05591037
055920                  PA-TL-TOT-CHECKED-CNT                           05592037
055930       EVALUATE SU007-CRTN-TYP-CDE                                05593037
055940       WHEN 'B'                                                   05594037
055950         ADD +1  TO PA-DC-BULK-CHECKED-CNT                        05595037
055960                    PA-TL-BULK-CHECKED-CNT                        05596037
055970       WHEN 'P'                                                   05597037
055980         ADD +1  TO PA-DC-PBS-CHECKED-CNT                         05598037
055990                    PA-TL-PBS-CHECKED-CNT                         05599037
055991       WHEN OTHER                                                 05599137
055992         DISPLAY '*** UNKNOWN CARTON TYPE CODE ***'               05599237
055993         DISPLAY '  RCD=' SU007-EXTRACT-RECORD                    05599337
055994       END-EVALUATE                                               05599437
056000     WHEN 'N'                                                     05600028
056100     WHEN ' '                                                     05610028
056200       ADD +1  TO PA-DC-NO-LABEL-CNT                              05620000
056300                  PA-TL-NO-LABEL-CNT                              05630000
056310                  PA-DC-TOT-CHECKED-CNT                           05631037
056320                  PA-TL-TOT-CHECKED-CNT                           05632037
056330       EVALUATE SU007-CRTN-TYP-CDE                                05633037
056340       WHEN 'B'                                                   05634037
056350         ADD +1  TO PA-DC-BULK-CHECKED-CNT                        05635037
056360                    PA-TL-BULK-CHECKED-CNT                        05636037
056370       WHEN 'P'                                                   05637037
056380         ADD +1  TO PA-DC-PBS-CHECKED-CNT                         05638037
056390                    PA-TL-PBS-CHECKED-CNT                         05639037
056391       WHEN OTHER                                                 05639137
056392         DISPLAY '*** UNKNOWN CARTON TYPE CODE ***'               05639237
056393         DISPLAY '  RCD=' SU007-EXTRACT-RECORD                    05639337
056394       END-EVALUATE                                               05639437
056400     WHEN OTHER                                                   05640028
056500       DISPLAY '*** UNKNOWN PRINTER TYPE CODE ==> '               05650028
056600                                    SU007-PRTR-TYP-CDE            05660028
056700       DISPLAY '  RCD=' SU007-EXTRACT-RECORD                      05670028
056800     END-EVALUATE.                                                05680028
056900                                                                  05690028
058500     PERFORM 3000-READ-EXTRACT-FILE.                              05850034
058600                                                                  05860037
058700     IF PS-END-OF-INPUT                                           05870000
058800         PERFORM 2100-PRINT-DETAIL-LINE                           05880000
058900         PERFORM 2200-PRINT-TOTAL-LINES                           05890028
059000     END-IF.                                                      05900000
059100*                                                                 05910000
059200*                                                                 05920000
059300 2100-PRINT-DETAIL-LINE.                                          05930000
059400******************************************************************05940000
059500**  PRINT ACCUMULATED TOTALS FOR THE DC.  GET THE DC NAME FROM    05950000
059600**  THE LOCATION MASTER TABLE FOR DISPLAY ON PRINT LINE.          05960032
059700******************************************************************05970000
059800*                                                                 05980000
059810     MOVE PV-OPER-UNT-ID TO DK-LOC-NBR.                           05981034
059820     SET PS-VALID-DC TO TRUE.                                     05982034
059900     PERFORM 3200-GET-DC-NAME.                                    05990034
060000     IF  PS-VALID-DC                                              06000034
060200         MOVE XLT00010-LOC-10-ABBR-NM  TO DL1-DC-NAME             06020034
060400         MOVE PA-DC-4X4-APPLY-CNT      TO DL1-4X4-APPLY-CNT       06040034
060600         MOVE PA-DC-4X4-BATCH-CNT      TO DL1-4X4-BATCH-CNT       06060034
060700         MOVE PA-DC-4X4-PEEL-CNT       TO DL1-4X4-PEEL-CNT        06070034
060800         MOVE PA-DC-TOT-LABEL-CNT      TO DL1-TOT-LABEL-CNT       06080034
060900         MOVE PA-DC-NO-LABEL-CNT       TO DL1-NO-LABEL-CNT        06090034
061000         MOVE PA-DC-TOT-CHECKED-CNT    TO DL1-TOT-CHECKED-CNT     06100034
061100         MOVE PA-DC-PBS-CHECKED-CNT    TO DL1-PBS-CHECKED-CNT     06110034
061200         MOVE PA-DC-BULK-CHECKED-CNT   TO DL1-BULK-CHECKED-CNT    06120034
061400         ADD +1 TO PV-LINE-COUNT                                  06140034
061500         IF PV-LINE-COUNT > PV-MAX-LINE-COUNT                     06150034
061600             PERFORM 1500-PAGE-BREAK                              06160034
061700         END-IF                                                   06170034
061900         WRITE SUMMARY-RPT-RECORD                                 06190034
062000           FROM DETAIL-LINE1                                      06200034
062100             AFTER ADVANCING 1 LINE                               06210034
062110     ELSE                                                         06211034
062120         SUBTRACT PA-DC-4X4-APPLY-CNT    FROM                     06212034
062121                  PA-TL-4X4-APPLY-CNT                             06212135
062130         SUBTRACT PA-DC-4X4-BATCH-CNT    FROM                     06213034
062131                  PA-TL-4X4-BATCH-CNT                             06213134
062140         SUBTRACT PA-DC-4X4-PEEL-CNT     FROM                     06214034
062141                  PA-TL-4X4-PEEL-CNT                              06214134
062150         SUBTRACT PA-DC-TOT-LABEL-CNT    FROM                     06215034
062151                  PA-TL-TOT-LABEL-CNT                             06215134
062160         SUBTRACT PA-DC-NO-LABEL-CNT     FROM                     06216034
062161                  PA-TL-NO-LABEL-CNT                              06216134
062170         SUBTRACT PA-DC-TOT-CHECKED-CNT  FROM                     06217034
062171                  PA-TL-TOT-CHECKED-CNT                           06217134
062180         SUBTRACT PA-DC-PBS-CHECKED-CNT  FROM                     06218034
062181                  PA-TL-PBS-CHECKED-CNT                           06218134
062190         SUBTRACT PA-DC-BULK-CHECKED-CNT FROM                     06219034
062191                  PA-TL-BULK-CHECKED-CNT                          06219134
062192     END-IF.                                                      06219234
062200*                                                                 06220000
064800 2200-PRINT-TOTAL-LINES.                                          06480028
065300*                                                                 06530000
065400     MOVE PA-TL-4X4-APPLY-CNT    TO TL1-4X4-APPLY-CNT.            06540032
065600     MOVE PA-TL-4X4-BATCH-CNT    TO TL1-4X4-BATCH-CNT.            06560000
065700     MOVE PA-TL-4X4-PEEL-CNT     TO TL1-4X4-PEEL-CNT.             06570031
065800     MOVE PA-TL-TOT-LABEL-CNT    TO TL1-TOT-LABEL-CNT.            06580000
065900     MOVE PA-TL-NO-LABEL-CNT     TO TL1-NO-LABEL-CNT.             06590000
066000     MOVE PA-TL-TOT-CHECKED-CNT  TO TL1-TOT-CHECKED-CNT.          06600000
066100     MOVE PA-TL-PBS-CHECKED-CNT  TO TL1-PBS-CHECKED-CNT.          06610000
066200     MOVE PA-TL-BULK-CHECKED-CNT TO TL1-BULK-CHECKED-CNT.         06620000
066300*                                                                 06630000
066400     ADD +4 TO PV-LINE-COUNT.                                     06640028
066500     IF PV-LINE-COUNT > PV-MAX-LINE-COUNT                         06650028
066600         PERFORM 1500-PAGE-BREAK                                  06660000
066700     END-IF.                                                      06670028
066800*                                                                 06680000
066900     WRITE SUMMARY-RPT-RECORD                                     06690028
067000       FROM TOTAL-LINE1                                           06700028
067100         AFTER ADVANCING 2 LINES.                                 06710028
067200*                                                                 06720028
067300     WRITE SUMMARY-RPT-RECORD                                     06730028
067400       FROM TOTAL-LINE2                                           06740028
067500         AFTER ADVANCING 2 LINES.                                 06750028
067600*                                                                 06760028
067700*                                                                 06770000
067833                                                                  06783332
067840 3000-READ-EXTRACT-FILE.                                          06784032
067900******************************************************************06790000
068000*  READ A RECORD FROM THE AUDIT CARTON EXTRACT FILE.             *06800000
068100******************************************************************06810000
068200*                                                                 06820000
068300     READ CARTON-EXTRACT-FILE                                     06830004
068400       INTO SU007-EXTRACT-RECORD                                  06840004
068500         AT END                                                   06850000
068600           SET PS-END-OF-INPUT TO TRUE.                           06860000
068610                                                                  06861032
068680 3200-GET-DC-NAME.                                                06868034
068690******************************************************************06869032
068691**  PERFORM A SELECT AGAINST THE LOCATION MASTER TO DETERMINE IF  06869132
068692**  THE OPER UNIT FROM THE INPUT FILE IS FOR A DC.                06869232
068693******************************************************************06869332
068694     INITIALIZE DCLXLT00010.                                      06869432
068695*                                                                 06869532
068696     EXEC SQL                                                     06869632
068697       SELECT  LOC_10_ABBR_NM                                     06869732
068698         INTO  :XLT00010-LOC-10-ABBR-NM                           06869832
068699         FROM  XLT_LOC                                            06869932
068700        WHERE  LOC_NBR = :DK-LOC-NBR                              06870032
068701          AND  LOC_TYP_CDE = 'DC'                                 06870134
068702     END-EXEC.                                                    06870232
068703                                                                  06870332
068704     EVALUATE TRUE                                                06870432
068705       WHEN SQLCODE = ZEROS                                       06870532
068706         CONTINUE                                                 06870634
068708       WHEN SQLCODE = +100                                        06870832
068709         MOVE 'UNKNOWN' TO XLT00010-LOC-10-ABBR-NM                06870932
068710         SET PS-NOT-VALID-DC TO TRUE                              06871034
068711       WHEN OTHER                                                 06871132
068712         PERFORM Z999-SQL-ERROR                                   06871232
068713     END-EVALUATE.                                                06871332
068720*                                                                 06872000
068800*                                                                 06880000
068900 Z999-SQL-ERROR.                                                  06890000
069000******************************************************************06900000
069100*     SQL WARNING OR ERROR PROCESSING                            *06910000
069200******************************************************************06920000
069300*                                                                 06930000
069400     MOVE SQLCODE    TO SQLCODE2.                                 06940000
069500     MOVE SQLERRD(3) TO SQLERRD3.                                 06950000
069600     DISPLAY '** ABEND **       ** = SQLERROR'.                   06960000
069700     DISPLAY '** PROGRAM        ** = SUKRP019'.                   06970000
069800     DISPLAY '** SQLCODE        ** = ' SQLCODE2.                  06980000
069900     DISPLAY '** ROWS PROCESSED ** = ' SQLERRD3.                  06990000
070000     DISPLAY '** SQLERRM        ** = ' SQLERRM.                   07000000
070100     DISPLAY '** SQLERRMC       ** = ' SQLERRMC.                  07010000
070200*                                                                 07020000
070300******************************************************************07030000
070400* THIS COPY BOOK MEMBER CONTAINS THE PROCEDURE DIVISION STATE-    07040000
070500* MENTS THAT ARE REQUIRED TO UTILIZE THE DB2 ABEND MODULE         07050000
070600* 'DSNTIAR' AND CONVERT THE SQLCA INFORMATION INTO A READABLE     07060000
070700* FORMAT.                                                         07070000
070800******************************************************************07080000
070900     COPY DPPD004.                                                07090000
071000*                                                                 07100000
071100     MOVE +4003 TO  ABEND-CODE.                                   07110000
071200     CALL 'ILBOABN0' USING ABEND-CODE.                            07120000
071300*                                                                 07130004
071400******************************************************************07140000
071500******************************************************************07150000
