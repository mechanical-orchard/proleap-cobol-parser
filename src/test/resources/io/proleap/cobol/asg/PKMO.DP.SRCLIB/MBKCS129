00001 *************************                                         02/05/92
00002  IDENTIFICATION DIVISION.                                         MBKCS129
00003 *************************                                            LV026
00004  PROGRAM-ID.    MBKCS129.                                            CL**1
00005  AUTHOR.        MIKE FURLICK.                                        CL**1
00006  INSTALLATION.  KOHLS DEPARTMENT STORES.                             CL**1
00007  DATE-WRITTEN.  9-06-91.                                             CL**1
00008  DATE-COMPILED.                                                      CL**1
00009                                                                      CL**1
00010 *****************************************************************    CL**1
00011 *    R129 - RESPONSIBILITY LEVEL LIST                                CL**1
00012 *                                                                    CL**1
00013 *    THIS PROGRAM GENERATES A LIST OF THE RESPONSIBILITY LEVEL       CL**1
00014 *    CODES FROM TRSPLVL (RESPONSIBILITY LEVEL TABLE).                CL**1
00015 *                                                                    CL**1
00016 *    THE OPERATOR MAY INVOKE THE RESPONSIBILITY LEVEL UPDATE, ADD,   CL**1
00017 *    OR DELETE SCREEN BY PRESSING THE APPROPRIATE PFKEY.  AT         CL**1
00018 *    LEASE ONE ITEM MUST BE SELECTED TO PASS CONTROL EXCEPT FOR      CL**1
00019 *    THE ADD FUNCTION.                                               CL**1
00020 *                                                                    CL**1
00021 *****************************************************************    CL**1
262978* CHANGED 10/22/2021    BY JIM HUNTER      WR: CHG0262978                 
262978* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE             
262978* MAKING THE CALL DYNAMIC VS STATIC.                                      
262978******************************************************************        
00022                                                                      CL**1
00023 *                                                                    CL**1
00024 *                                                                    CL**1
00025 *                                                                    CL**1
00026  ENVIRONMENT DIVISION.                                               CL**1
00027 *                                                                    CL**1
00028 *                                                                    CL**1
00029 *                                                                    CL**1
00030  DATA DIVISION.                                                      CL**1
00031 *                                                                    CL**1
00032 *                                                                    CL**1
00033  WORKING-STORAGE SECTION.                                            CL**1
00034 *                                                                    CL**1
00035  01  PC-PROGRAM-CONSTANTS.                                           CL**1
00036      05  PC-NAVIGATOR-TRAN-ID           PIC X(04)    VALUE 'Z008'.   CL**1
00037      05  PC-MAXIMUM-COMMAREA-LENGTH     PIC S9(04)   VALUE +4072     CL**1
00038                                                      COMP SYNC.      CL**1
00039      05  PC-CURRENT-MAP-NAME            PIC X(08)    VALUE           CL**1
00040      'MB129A  '.                                                     CL**1
00041      05  PC-CURRENT-MAPSET-NAME         PIC X(08)    VALUE           CL**1
00042      'MBKM129 '.                                                     CL**1
00043      05  PC-CURRENT-PROGRAM-NAME        PIC X(08)    VALUE           CL**1
00044      'MBKCS129'.                                                     CL**1
00045      05  PC-BEGINNING                   PIC X(01)    VALUE 'B'.      CL**1
00046      05  PC-ENDING                      PIC X(01)    VALUE 'E'.      CL**1
00047      05  PC-SELECTED                    PIC X(01)    VALUE 'S'.      CL**1
00048      05  PC-ITEMS-PER-PANEL             PIC S9(04)   VALUE +14       CL*18
00049                                                      COMP SYNC.      CL**1
00050      05  PC-ITEMS-PER-BLOCK             PIC S9(04)   VALUE +28       CL**1
00051                                                      COMP SYNC.      CL**1
00052      05  PC-MAX-ITEMS-TO-BE-READ        PIC S9(04)   VALUE +100      CL**1
00053                                                      COMP SYNC.      CL**1
00054      05  PC-MAX-BLOCKS-IN-ARRAY         PIC S9(04)   VALUE +2        CL**1
00055                                                      COMP SYNC.      CL**1
00056      05  PC-MAX-RLEVELS                 PIC S9(03)   VALUE +200      CL**1
00057                                                      COMP-3.         CL**1
00058      05  PC-MAX-ITEMS                   PIC S9(09)   VALUE           CL**1
00059                                                      +1000000        CL**1
00060                                                      COMP-3.         CL**1
00061      05  PC-BLOCK-LENGTH                PIC S9(04)   VALUE +1314     CL**1
00062                                                      COMP SYNC.      CL**1
00063      05  PC-FIELD-LENGTH                PIC S9(04)   VALUE +5        CL**1
00064                                                      COMP SYNC.      CL**1
00065      05  PC-ERASE-EOF-COMP              PIC S9(04)   VALUE +128      CL**1
00066                                                      COMP SYNC.      CL**1
00067      05  FILLER REDEFINES PC-ERASE-EOF-COMP.                         CL**1
00068          10  FILLER                     PIC X(01).                   CL**1
00069          10  PC-ERASE-EOF               PIC X(01).                   CL**1
00070      05  PC-MAX-RETRIES                 PIC S9(3)    VALUE 3         CL**1
00071                                                      COMP-3.         CL**1
00072      05  PC-COMPANY                     PIC X(2)     VALUE '03'.     CL**1
00073 *                                                                    CL**1
00074  01  PC-TSYMSG-NUMBERS.                                              CL**1
00075      05  PC-TSYMSG-00005                PIC 9(5)    VALUE 00005.     CL**1
00076      05  PC-TSYMSG-00008                PIC 9(5)    VALUE 00008.     CL**1
00077      05  PC-TSYMSG-00045                PIC 9(5)    VALUE 00045.     CL**9
00078      05  PC-TSYMSG-00050                PIC 9(5)    VALUE 00050.     CL**9
00079      05  PC-TSYMSG-00051                PIC 9(5)    VALUE 00051.     CL**1
00080      05  PC-TSYMSG-00052                PIC 9(5)    VALUE 00052.     CL**1
00081      05  PC-TSYMSG-00053                PIC 9(5)    VALUE 00053.     CL**1
00082      05  PC-TSYMSG-00054                PIC 9(5)    VALUE 00054.     CL**1
00083      05  PC-TSYMSG-00055                PIC 9(5)    VALUE 00055.     CL**1
00084      05  PC-TSYMSG-00057                PIC 9(5)    VALUE 00057.     CL**1
00085      05  PC-TSYMSG-00069                PIC 9(5)    VALUE 00069.     CL**1
00086      05  PC-TSYMSG-00070                PIC 9(5)    VALUE 00070.     CL**1
00087      05  PC-TSYMSG-00101                PIC 9(5)    VALUE 00101.     CL**7
00088      05  PC-TSYMSG-00207                PIC 9(5)    VALUE 00207.     CL*22
00089 *                                                                    CL**1
00090  01  PM-PROGRAM-MESSAGES.                                            CL**1
00091      05  PM-PROGRAM-MESSAGE-9           PIC X(78)    VALUE           CL**1
00092      'ERROR TRYING TO REWRITE  TEMP STORAGE QUEUE - RESP '.          CL**1
00093      05  FILLER REDEFINES PM-PROGRAM-MESSAGE-9.                      CL**1
00094          10  FILLER                     PIC X(51).                   CL**1
00095          10  PM-RESP-9                  PIC Z(03)9-.                 CL**1
00096          10  FILLER                     PIC X(22).                   CL**1
00097      05  PM-PROGRAM-MESSAGE-10          PIC X(78)    VALUE           CL**1
00098      'ERROR TRYING TO WRITE TO TEMP STORAGE QUEUE - RESP '.          CL**1
00099      05  FILLER REDEFINES PM-PROGRAM-MESSAGE-10.                     CL**1
00100          10  FILLER                     PIC X(51).                   CL**1
00101          10  PM-RESP-10                 PIC Z(03)9-.                 CL**1
00102          10  FILLER                     PIC X(22).                   CL**1
00103      05  PM-PROGRAM-MESSAGE-11          PIC X(78)    VALUE           CL**1
00104      'LOGIC ERROR IN TRYING TO WRITE TO TEMP STORAGE QUEUE - BLOCK   CL**1
00105 -    '     '.                                                        CL**1
00106      05  FILLER REDEFINES PM-PROGRAM-MESSAGE-11.                     CL**1
00107          10  FILLER                     PIC X(61).                   CL**1
00108          10  PM-BLOCK-NUMBER            PIC Z(03)9-.                 CL**1
00109          10  FILLER                     PIC X(12).                   CL**1
00110      05  PM-PROGRAM-MESSAGE-12          PIC X(78)    VALUE           CL**1
00111      'INVALID NEXT APPLICATION ACTIVITY RECEIVED'.                   CL**1
00112      05  PM-PROGRAM-MESSAGE-14          PIC X(78)    VALUE           CL**1
00113      'REQUESTED VALUE MUST BE GREATER THAN 0 AND LESS THAN 1,000,0   CL**1
00114 -    '00'.                                                           CL**1
00115      05  PM-PROGRAM-MESSAGE-23          PIC X(78)    VALUE           CL**1
00116      'ERROR TRYING TO DELETE TEMP STORAGE QUEUE - RESP '.            CL**1
00117      05  FILLER REDEFINES PM-PROGRAM-MESSAGE-23.                     CL**1
00118          10  FILLER                     PIC X(49).                   CL**1
00119          10  PM-RESP-23                 PIC Z(03)9-.                 CL**1
00120          10  FILLER                     PIC X(24).                   CL**1
00121      05  PM-PROGRAM-MESSAGE-24          PIC X(78)    VALUE           CL**1
00122      'ERROR TRYING TO READ FROM TEMP STORAGE QUEUE - RESP '.         CL**1
00123      05  FILLER REDEFINES PM-PROGRAM-MESSAGE-24.                     CL**1
00124          10  FILLER                     PIC X(52).                   CL**1
00125          10  PM-RESP-24                 PIC Z(03)9-.                 CL**1
00126          10  FILLER                     PIC X(21).                   CL**1
00127      05  PM-PROGRAM-MESSAGE-26          PIC X(78)    VALUE           CL**1
00128      'CONVERSION ROUTINE ERROR'.                                     CL**1
00129      05  PM-PROGRAM-MESSAGE-28          PIC X(78)    VALUE           CL**1
00130      'ERROR OCCURRED DURING TS QUEUE PROCESSING'.                    CL**1
00131 *                                                                    CL**1
00132  01  PS-PROGRAM-SUBSCRIPTS.                                          CL**1
00133      05  PS-SUB                         PIC S9(04)   VALUE +0        CL**1
00134                                                      COMP SYNC.      CL**1
00135      05  PS-RL-SUB1                     PIC S9(04)   VALUE +0        CL**1
00136                                                      COMP SYNC.      CL**1
00137      05  PS-RL-SUB2                     PIC S9(04)   VALUE +0        CL**1
00138                                                      COMP SYNC.      CL**1
00139      05  PS-ITEM-SUB                    PIC S9(09)   VALUE +0        CL**1
00140                                                      COMP-3.         CL**1
00141                                                                      CL**1
00142  01  PS-PROGRAM-SWITCHES.                                            CL**1
00143      05  PS-MAP-SEND-TYPE               PIC X(01)    VALUE '1'.      CL**1
00144          88  PS-SEND-MAP-N-DATA-FRSET                VALUE '1'.      CL**1
00145          88  PS-SEND-MAP-N-DATA-FRSET-CPOSN          VALUE '2'.      CL**1
00146          88  PS-SEND-DATA-ONLY-FRSET                 VALUE '3'.      CL**1
00147          88  PS-SEND-DATA-ONLY                       VALUE '4'.      CL**1
00148          88  PS-SEND-DATA-ONLY-ERASEAUP              VALUE '5'.      CL**1
00149          88  PS-SEND-MAP-ONLY-FRSET                  VALUE '6'.      CL**1
00150      05  PS-ERROR-SW                    PIC X(01)    VALUE 'N'.      CL**1
00151          88  PS-ERROR                                VALUE 'Y'.      CL**1
00152          88  PS-NO-ERROR                             VALUE 'N'.      CL**1
00153      05  PS-INTER-APPL-VALID-SW         PIC X(01)    VALUE 'N'.      CL**1
00154          88  PS-INTER-APPL-VALID                     VALUE 'Y'.      CL**1
00155          88  PS-INTER-APPL-NOT-VALID                 VALUE 'N'.      CL**1
00156      05  PS-SAME-ITEMS-DISPLAYED-SW     PIC X(01)    VALUE 'N'.      CL**1
00157          88  PS-SAME-ITEMS-DISPLAYED                 VALUE 'Y'.      CL**1
00158          88  PS-DIFFERENT-ITEMS-DISPLAYED            VALUE 'N'.      CL**1
00159      05  PS-CURSOR-POSITIONED-SW        PIC X(01)    VALUE 'N'.      CL**1
00160          88  PS-CURSOR-POSITIONED                    VALUE 'Y'.      CL**1
00161          88  PS-CURSOR-NOT-POSITIONED                VALUE 'N'.      CL**1
00162      05  PS-VALID-SELECTIONS-SW         PIC X(01)    VALUE 'Y'.      CL**1
00163          88  PS-VALID-SELECTIONS                     VALUE 'Y'.      CL**1
00164          88  PS-INVALID-SELECTIONS                   VALUE 'N'.      CL**1
00165      05  PS-VALID-BEG-ITEM-SW           PIC X(01)    VALUE 'N'.      CL**1
00166          88  PS-VALID-BEG-ITEM                       VALUE 'Y'.      CL**1
00167          88  PS-INVALID-BEG-ITEM                     VALUE 'N'.      CL**1
00168      05  PS-TOP-ITEM-IN-ARRAY-SW        PIC X(01)    VALUE 'N'.      CL**1
00169          88  PS-TOP-ITEM-IN-ARRAY                    VALUE 'Y'.      CL**1
00170          88  PS-TOP-ITEM-NOT-IN-ARRAY                VALUE 'N'.      CL**1
00171      05  PS-BOTTOM-ITEM-IN-ARRAY-SW     PIC X(01)    VALUE 'N'.      CL**1
00172          88  PS-BOTTOM-ITEM-IN-ARRAY                 VALUE 'Y'.      CL**1
00173          88  PS-BOTTOM-ITEM-NOT-IN-ARRAY             VALUE 'N'.      CL**1
00174      05  PS-TOP-ITEM-IN-TEMP-SW         PIC X(01)    VALUE 'N'.      CL**1
00175          88  PS-TOP-ITEM-IN-TEMP                     VALUE 'Y'.      CL**1
00176          88  PS-TOP-ITEM-NOT-IN-TEMP                 VALUE 'N'.      CL**1
00177      05  PS-BOTTOM-ITEM-IN-TEMP-SW      PIC X(01)    VALUE 'N'.      CL**1
00178          88  PS-BOTTOM-ITEM-IN-TEMP                  VALUE 'Y'.      CL**1
00179          88  PS-BOTTOM-ITEM-NOT-IN-TEMP              VALUE 'N'.      CL**1
00180      05  PS-LAST-BLOCK-IN-ARRAY-SW      PIC X(01)    VALUE 'N'.      CL**1
00181          88  PS-LAST-BLOCK-IN-ARRAY                  VALUE 'Y'.      CL**1
00182          88  PS-LAST-BLOCK-NOT-IN-ARRAY              VALUE 'N'.      CL**1
00183      05  PS-SELECTION-FOUND-SW          PIC X(01)    VALUE 'N'.      CL**1
00184          88  PS-SELECTION-FOUND                      VALUE 'Y'.      CL**1
00185          88  PS-NO-SELECTION-FOUND                   VALUE 'N'.      CL**1
00186      05  PS-WARNING-SW                  PIC X(01)    VALUE 'N'.      CL**1
00187          88  PS-WARNING                              VALUE 'Y'.      CL**1
00188          88  PS-NO-WARNING                           VALUE 'N'.      CL**1
00189      05  PS-INFORMATIONAL-SW            PIC X(01)    VALUE 'N'.      CL**1
00190          88  PS-INFORMATIONAL                        VALUE 'Y'.      CL**1
00191          88  PS-NOT-INFORMATIONAL                    VALUE 'N'.      CL**1
00192      05  PS-PROCESSING-SW               PIC X(01)    VALUE 'N'.      CL**1
00193          88  PS-CONTINUE                             VALUE 'Y'.      CL*16
00194          88  PS-DONT-PROCESS                         VALUE 'N'.      CL*16
00195      05  PS-PROCESS-ITEM-SW             PIC X(01)    VALUE 'N'.      CL*11
00196          88  PS-END-OF-ITEMS                         VALUE 'Y'.      CL*16
00197          88  PS-NOT-END                              VALUE 'N'.      CL*16
00198      EJECT                                                           CL**1
00199  01  PV-PROGRAM-VARIABLES.                                           CL**1
00200      05  PV-CICS-RESPONSE               PIC S9(04)   VALUE +0        CL**1
00201                                                      COMP SYNC.      CL**1
00202      05  PV-HIGHEST-ITEM-TO-BE-READ     PIC S9(09)   VALUE +0        CL**1
00203                                                      COMP-3.         CL**1
00204      05  PV-ENDING-ITEM-ON-PANEL        PIC S9(09)   VALUE +0        CL**1
00205                                                      COMP-3.         CL**1
00206      05  PV-ITEM-IN-USE                 PIC S9(09)   VALUE +0        CL**1
00207                                                      COMP-3.         CL**1
00208      05  PV-TOP-ITEM                    PIC S9(09)   VALUE +0        CL**1
00209                                                      COMP-3.         CL**1
00210      05  PV-BOTTOM-ITEM                 PIC S9(09)   VALUE +0        CL**1
00211                                                      COMP-3.         CL**1
00212      05  PV-MAX-ITEMS-TO-BE-READ        PIC S9(09)   VALUE +0        CL**1
00213                                                      COMP-3.         CL**1
00214      05  PV-FIRST-ITEM-IN-ARRAY         PIC S9(09)   VALUE +0        CL**1
00215                                                      COMP-3.         CL**1
00216      05  PV-LAST-ITEM-IN-ARRAY          PIC S9(09)   VALUE +0        CL**1
00217                                                      COMP-3.         CL**1
00218      05  PV-LAST-ITEM-IN-TEMP           PIC S9(09)   VALUE +0        CL**1
00219                                                      COMP-3.         CL**1
00220      05  PV-BEGINNING-ITEM              PIC S9(09)   VALUE +0        CL**1
00221                                                      COMP-3.         CL**1
00222      05  PV-TEMP-BLOCK-NUMBER           PIC S9(09)   VALUE +0        CL**1
00223                                                      COMP-3.         CL**1
00224      05  PV-BLOCK-NUMBER                PIC S9(04)   VALUE +0        CL**1
00225                                                      COMP SYNC.      CL**1
00226      05  PV-RESP                        PIC S9(04)   VALUE +0        CL**1
00227                                                      COMP SYNC.      CL**1
00228      05  PV-ITEM                        PIC S9(04)   VALUE +0        CL**1
00229                                                      COMP SYNC.      CL**1
00230      05  PV-RL-ITEM                     PIC S9(04)   VALUE +0        CL*11
00231                                                      COMP SYNC.      CL**1
00232      05  PV-SAVE-ITEM                   PIC S9(04)   VALUE +0        CL*11
00233                                                      COMP SYNC.      CL*11
00234      05  PV-HIGHEST-BLOCK-WRITTEN       PIC S9(04)   VALUE +0        CL**1
00235                                                      COMP SYNC.      CL**1
00236      05  PV-LIST-ITEM-NUMBER            PIC S9(04)   VALUE +0        CL**1
00237                                                      COMP SYNC.      CL**1
00238      05  PV-FIRST-BLOCK-IN-ARRAY        PIC S9(04)   VALUE +0        CL**1
00239                                                      COMP SYNC.      CL**1
00240      05  PV-NEXT-BLOCK-IN-ARRAY         PIC S9(04)   VALUE +0        CL**1
00241                                                      COMP SYNC.      CL**1
00242      05  PV-PREV-BLOCK-IN-ARRAY         PIC S9(04)   VALUE +0        CL**1
00243                                                      COMP SYNC.      CL**1
00244      05  PV-FIRST-BLOCK-IN-RANGE        PIC S9(04)   VALUE +0        CL**1
00245                                                      COMP SYNC.      CL**1
00246      05  PV-LAST-BLOCK-IN-RANGE         PIC S9(04)   VALUE +0        CL**1
00247                                                      COMP SYNC.      CL**1
00248      05  PV-START-OF-SELECTED-RANGE     PIC S9(04)   VALUE +0        CL**1
00249                                                      COMP SYNC.      CL**1
00250      05  PV-END-OF-SELECTED-RANGE       PIC S9(04)   VALUE +0        CL**1
00251                                                      COMP SYNC.      CL**1
00252      05  PV-ITEMS-READ                  PIC S9(04)   VALUE +0        CL**6
00253                                                      COMP SYNC.      CL**6
00254      05  PV-MESSAGE                     PIC X(78)    VALUE SPACES.   CL**1
00255      05  PV-SQL-SUB                     PIC S9(4)    COMP.           CL**1
00256      05  PV-RETRY-COUNTER               PIC S9(3)    COMP-3.         CL**1
00257      05  PV-BEGITMI.                                                 CL**1
00258          10  PV-BEGITMI-N               PIC 9(5).                    CL**1
00259      05  PV-DISPLAY5                    PIC ZZZZ9.                   CL**1
00260      05  PV-RL-QUEUE-NAME.                                           CL**1
00261          10  PV-RL-TERM-ID              PIC X(4).                    CL**1
00262          10  PV-RL-TASK-NUMBER          PIC S9(7)    COMP-3.         CL**1
00263 *                                                                    CL**1
00264  01  PV-TEMP-WORK-AREA.                                              CL**1
00265      05  PV-BLOCK-MODIFIED              PIC X.                       CL**1
00266      05  PV-TW-ITEM-ENTRIES OCCURS 28 TIMES                          CL**1
00267                             INDEXED BY PV-TW-IDX.                    CL**1
00268          10  PV-TW-LIST-ITEM-NUMBER     PIC S9(9)    COMP-3.         CL**1
00269          10  PV-TW-SELECTED-SW          PIC X.                       CL**1
00270              88  PV-TW-SELECT                        VALUE 'S'.      CL**1
00271              88  PV-TW-DESELECT                      VALUE ' '.      CL*11
00272          10  PV-TW-RLEVEL               PIC X(3).                    CL**1
00273          10  PV-TW-DESC                 PIC X(25).                   CL**1
00274 *                                                                    CL**1
00275  EJECT                                                               CL**1
00276 *****************************************************************    CL**1
00277 *    STANDARD COMMAREA.                                              CL**1
00278 *****************************************************************    CL**1
00279                                                                      CL**1
00280      COPY DPWS020.                                                   CL*26
00281      05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                   CL**1
00282                                                                      CL**1
00283 *****************************************************************    CL**1
00284 *    INTER-APPLICATION COMMAREA.                                     CL**1
00285 *****************************************************************    CL**1
00286                                                                      CL**1
00287          10  INTER-APPL-COMM-AREA       PIC X(200).                  CL**1
00288      COPY MBWS005.                                                   CL*26
00289 *****************************************************************    CL**1
00290 *    SPECIFIC COMMMAREA FOR MBKCS129.                                CL**1
00291 *****************************************************************    CL**1
00292          10  MB129-SPECIFIC-COMMAREA.                                CL**1
00293              15  MB129-APPL-CURSOR-POSITION          PIC S9(04)      CL**1
00294                                                      COMP.           CL**1
00295              15  MB129-BLOCK-ENTRIES OCCURS 2 TIMES.                 CL**1
00296                  20  MB129-BLOCK-MODIFIED-SW         PIC X(01).      CL**1
00297                      88  MB129-BLOCK-NOT-MODIFIED    VALUE 'N'.      CL**1
00298                      88  MB129-BLOCK-MODIFIED        VALUE 'Y'.      CL**1
00299                  20  MB129-ITEM-ARRAY.                               CL**1
00300                      25  MB129-ITEM-ENTRIES OCCURS 28 TIMES.         CL**1
00301                          30  MB129-LIST-ITEM-NUMBER                  CL**1
00302                                                      PIC S9(09)      CL**1
00303                                                          COMP-3.     CL**1
00304                          30  MB129-SELECTED-SW       PIC X(01).      CL**1
00305                              88  MB129-NO-SELECT     VALUE ' '.      CL**1
00306                              88  MB129-SELECT        VALUE 'S'.      CL**1
00307                              88  MB129-BEGIN         VALUE 'B'.      CL**1
00308                              88  MB129-END           VALUE 'E'.      CL**1
00309                          30  MB129-RLEVEL            PIC X(3).       CL**1
00310                          30  MB129-DESC              PIC X(25).      CL**1
00311 *                                                                    CL**1
00312              15  MB129-BLK-SUB                       PIC S9(04)      CL**1
00313                                                          COMP        CL**1
00314                                                          SYNC.       CL**1
00315              15  MB129-ITEM-SUB                      PIC S9(04)      CL**1
00316                                                          COMP        CL**1
00317                                                          SYNC.       CL**1
00318              15  MB129-NUMBER-OF-ITEMS-READ          PIC S9(09)      CL**1
00319                                                          COMP-3.     CL**1
00320              15  MB129-NUMBER-OF-SELECTED-ITEMS      PIC S9(09)      CL**1
00321                                                          COMP-3.     CL**1
00322              15  MB129-ITEM-AT-TOP-OF-PANEL          PIC S9(09)      CL**1
00323                                                          COMP-3.     CL**1
00324              15  MB129-ITEM-AT-BOT-OF-PANEL          PIC S9(09)      CL**1
00325                                                          COMP-3.     CL**1
00326              15  MB129-HIGHEST-BLOCK-WRITTEN         PIC S9(04)      CL**1
00327                                                          COMP        CL**1
00328                                                          SYNC.       CL**1
00329              15  MB129-START-OF-SELECTED-RANGE       PIC S9(09)      CL**1
00330                                                          COMP-3.     CL**1
00331              15  MB129-END-OF-SELECTED-RANGE         PIC S9(09)      CL**1
00332                                                          COMP-3.     CL**1
00333              15  MB129-ITEMS-LEFT-INDICATOR          PIC X.          CL**1
00334                  88  MB129-ITEMS-LEFT-ON-DB            VALUE 'Y'.    CL**1
00335                  88  MB129-NO-ITEMS-LEFT-ON-DB         VALUE 'N'.    CL**1
00336              15  MB129-TEMP-QUEUE-UPDATE-SW          PIC X.          CL*11
00337                  88  MB129-UPDATE-TSQ                  VALUE 'Y'.    CL*16
00338                  88  MB129-DONT-UPDATE-TSQ             VALUE 'N'.    CL*16
00339              15  MB129-TEMP-QUEUE-NAME.                              CL**1
00340                  20  MB129-TERM-ID                   PIC X(4).       CL**1
00341                  20  MB129-TASK-NUMBER               PIC S9(7)       CL**1
00342                                                          COMP-3.     CL**1
00343              15  MB129-LAST-RLEVEL                   PIC X(3).       CL**1
00344              15  MB129-LIST-QUEUE-NAME               PIC X(8).       CL**1
00345              15  MB129-SAVE-INTER-APPL-COMMAREA      PIC X(200).     CL**1
00346 *                                                                    CL**1
00347      EJECT                                                           CL**1
00348 *****************************************************************    CL**1
00349 *    DEPARTMENT DISCOUNT QUEUE RECORD LAYOUT.                        CL**1
00350 *****************************************************************    CL**1
00351  01 RL-LIST-RECORD.                                                  CL**1
00352      COPY MBWS129.                                                   CL*26
00353                                                                      CL**1
00354 *                                                                    CL**1
00355      EJECT                                                           CL**1
00356 *****************************************************************    CL**1
00357 *    ABEND PROCESSING COPYBOOK.                                      CL**1
00358 *****************************************************************    CL**1
00359                                                                      CL**1
00360      COPY DPWS013.                                                   CL**1
00361                                                                      CL**1
00362      EJECT                                                           CL**1
00363 *****************************************************************    CL**1
00364 *    ATTRIBUTE SETTINGS COPYBOOK.                                    CL**1
00365 *****************************************************************    CL**1
00366                                                                      CL**1
00367      COPY DPWS015.                                                   CL**1
00368                                                                      CL**1
00369 *****************************************************************    CL**1
00370 *    CURRENT DATE AND TIME COPYBOOK.                                 CL**1
00371 *****************************************************************    CL**1
00372                                                                      CL**1
00373      COPY DPWS017.                                                   CL**1
00374                                                                      CL**1
00375 *****************************************************************    CL**1
00376 *    TOGGLE FUNCTION KEY LINES COPYBOOK.                             CL**1
00377 *****************************************************************    CL**1
00378                                                                      CL**1
00379      COPY DPWS009.                                                   CL**1
                                                                        MBKCS101
      *****************************************************************         
      *    SYSTEM MESSAGE FIELDS                                                
      *****************************************************************         
                                                                                
           COPY DPWS006.                                                        
                                                                                
00381 *****************************************************************    CL**1
00382 *    FUNCTION KEYS COPYBOOK.                                         CL**1
00383 *****************************************************************    CL**1
00384                                                                      CL**1
00385      COPY DPWS016.                                                   CL**1
00386                                                                      CL**1
00387 *****************************************************************    CL**1
00388 *    DPKUT045 COPYBOOK.                                              CL**1
00389 *****************************************************************    CL**1
00390                                                                      CL**1
00391      COPY DPWS045.                                                   CL**1
00392                                                                      CL**1
00393 *****************************************************************    CL**1
00394 *    NUMERIC EDIT LAYOUT.                                            CL**1
00395 *****************************************************************    CL**1
00396                                                                      CL**1
00397      COPY DPWS010I.                                                  CL**1
00398                                                                      CL**1
00399 *****************************************************************    CL**1
00400 *    MESSAGE RECORD LAYOUT                                           CL**1
00401 *****************************************************************    CL**1
00402                                                                      CL**1
00403      COPY DPRD507I.                                                  CL**1
00404                                                                      CL**1
00405 *****************************************************************    CL**1
00406 *    STANDARD ATTENTION IDENTIFIER LIST                              CL**1
00407 *****************************************************************    CL**1
00408                                                                      CL**1
00409      COPY DFHAID.                                                    CL**1
00410                                                                      CL**1
00411 *****************************************************************    CL**1
00412 *    STANDARD ATTRIBUTE AND PRINTER CONTROL CHARACTER LIST           CL**1
00413 *****************************************************************    CL**1
00414                                                                      CL**1
00415      COPY DFHBMSCA.                                                  CL**1
00416                                                                      CL**1
00417 *****************************************************************    CL**1
00418 *    MAP LAYOUT                                                      CL**1
00419 *****************************************************************    CL**1
00420                                                                      CL**1
00421      COPY MBKM129.                                                   CL**1
00422  01  MD-MAP-DATA-AREA  REDEFINES MB129AO PIC X(1200).                CL**1
00423 *                                                                    CL**1
00424  01  MBKM129-OCCURS-LAYOUT  REDEFINES  MD-MAP-DATA-AREA.             CL**2
00425      05  FILLER                PIC X(134).                           CL**1
00426      05  MBKM129-SCROLL-AREA OCCURS 14 TIMES.                        CL*18
00427          10  MBKM129-SELECTL   PIC S9(4) COMP.                       CL**1
00428          10  MBKM129-SELECTA   PIC X.                                CL**1
00429          10  MBKM129-SELECTC   PIC X.                                CL**1
00430          10  MBKM129-SELECTH   PIC X.                                CL**1
00431          10  MBKM129-SELECTI   PIC X.                                CL**1
00432 *                                                                    CL**1
00433          10  FILLER            PIC X(5).                             CL**1
00434          10  MBKM129-RLEVEL    PIC X(3).                             CL**1
00435 *                                                                    CL**1
00436          10  FILLER            PIC X(5).                             CL**1
00437          10  MBKM129-DESC      PIC X(25).                            CL**1
00438  EJECT                                                               CL**1
00439 *                                                                    CL**1
00440 *    DB2 AREA FOR TRSPLVL                                            CL**1
00441 *                                                                    CL**1
00442      EXEC SQL                                                        CL**1
00443           INCLUDE TRSPLVL                                            CL**1
00444      END-EXEC.                                                       CL**1
00445 *                                                                    CL**1
00446 *    DB2 AREA FOR COMMUNICATIONS                                     CL**1
00447 *                                                                    CL**1
00448      EXEC SQL                                                        CL**1
00449           INCLUDE SQLCA                                              CL**1
00450      END-EXEC.                                                       CL**1
00451 *                                                                    CL**1
00452 *    CURSOR DECLARE FOR TRSPLVL                                      CL**1
00453 *                                                                    CL**1
00454      EXEC SQL                                                        CL**1
00455           DECLARE RL-LIST CURSOR                                     CL**1
00456           FOR SELECT                                                 CL**1
00457               RSPLVL_CDE,                                            CL**1
00458               RSPLVL_DESC                                            CL**1
00459           FROM TRSPLVL                                               CL**1
00460               WHERE RSPLVL_CDE      >  :RSPLVL-CDE                   CL**1
00461           ORDER BY  RSPLVL_CDE                                       CL**1
00462      END-EXEC.                                                       CL**1
00463 *                                                                    CL**1
00464  EJECT                                                               CL**1
00465  LINKAGE SECTION.                                                    CL**1
00466                                                                      CL**1
00467  01  DFHCOMMAREA.                                                    CL**1
00468      05  FILLER                         OCCURS  1 TO 4072 TIMES      CL**1
00469                                         DEPENDING ON EIBCALEN.       CL**1
00470          10  FILLER                     PIC X.                       CL**1
00471                                                                      CL**1
00472 *                                                                    CL**1
00473 *                                                                    CL**1
00474 *                                                                    CL**1
00475  PROCEDURE DIVISION.                                                 CL**1
00476                                                                      CL**1
00477                                                                      CL**1
00478  A100-MAIN-MODULE.                                                   CL**1
00479                                                                      CL**1
00480 ******************************************************************   CL**1
00481 *    PROCESS THIS TRANSACTION IF THE COMMAREA IS VALID.              CL**1
00482 ******************************************************************   CL**1
00483                                                                      CL**1
00484      PERFORM DP015-0000-CHECK-COMMAREA.                              CL**1
00485                                                                      CL**1
00486      IF DP020-SRC-RETURN-W-TRAN-ID                                   CL**1
00487          PERFORM B100-CONTROL-PROCESSING                             CL**1
00488      END-IF.                                                         CL**1
00489                                                                      CL**1
00490      PERFORM DP003-0000-RETURN-TO-CICS.                              CL**1
00491  EJECT                                                               CL**1
00492 ******************************************************************   CL**1
00493 *    PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT       CL**1
00494 *    COURSE OF ACTION IS FOR THIS TRANSACTION.                       CL**1
00495 *                                                                    CL**1
00496 *    PERFORMED BY A100-MAIN-MODULE.                                  CL**1
00497 ******************************************************************   CL**1
00498 *                                                                    CL**1
00499  B100-CONTROL-PROCESSING.                                            CL**1
00500 *                                                                    CL**1
00501      SET PS-CONTINUE           TO  TRUE.                             CL*16
00502      MOVE LENGTH OF MB129-BLOCK-ENTRIES (1)                          CL**1
00503                                TO  PC-BLOCK-LENGTH.                  CL**1
00504      EVALUATE TRUE                                                   CL**1
00505          WHEN DP020-NEXT-ACT-INITIAL                                 CL**1
00506              INITIALIZE MB129-SPECIFIC-COMMAREA                      CL**1
00507              SET PS-CONTINUE                                         CL*16
00508                                TO  TRUE                              CL**1
00509              SET PS-SEND-MAP-N-DATA-FRSET                            CL**1
00510                                TO  TRUE                              CL**1
00511              SET DP020-NEXT-ACT-READ-MAP                             CL**1
00512                                TO  TRUE                              CL**1
00513              PERFORM D100-SETUP-INIT-PANEL                           CL**1
00514 *                                                                    CL**1
00515          WHEN DP020-NEXT-ACT-READ-MAP                                CL**1
00516              PERFORM C300-PROCESS-PANEL                              CL**1
00517 *                                                                    CL**1
00518          WHEN DP020-NEXT-ACT-RETURN                                  CL**1
00519              SET PS-SEND-MAP-N-DATA-FRSET                            CL**1
00520                                TO  TRUE                              CL**1
00521              PERFORM C400-REFRESH-PANEL-FROM-TEMP                    CL**1
00522 *                                                                    CL**1
00523          WHEN DP020-NEXT-ACT-ERROR                                   CL**1
00524              MOVE DP020-MSG-MESSAGE TO PV-MESSAGE                    CL**1
00525              IF DP020-NAV-MNEMONIC = SPACES                          CL**1
00526                  MOVE SPACES   TO  ANAVCMDO                          CL**1
00527                  MOVE DP015-UNDERLINE                                CL**1
00528                                TO  ANAVCMDH                          CL**1
00529                  MOVE DP015-GREEN                                    CL**1
00530                                TO  ANAVCMDC                          CL**1
00531              ELSE                                                    CL**1
00532                  MOVE DP015-REVERSE                                  CL**1
00533                                TO  ANAVCMDH                          CL**1
00534                  MOVE DP015-RED                                      CL**1
00535                                TO  ANAVCMDC                          CL**1
00536              END-IF                                                  CL**1
00537 *                                                                    CL**1
00538              PERFORM E100-EDIT-SELECTIONS                            CL**1
00539              MOVE -1           TO  ANAVCMDL                          CL**1
00540              MOVE PV-MESSAGE   TO  DP020-MSG-MESSAGE                 CL**1
00541                                                                      CL**1
00542              SET DP020-MSG-FATAL                                     CL**1
00543                                TO  TRUE                              CL**1
00544              SET PS-SEND-DATA-ONLY-FRSET                             CL**1
00545                                TO  TRUE                              CL**1
00546              SET PS-SAME-ITEMS-DISPLAYED                             CL**1
00547                                TO  TRUE                              CL**1
00548              SET PS-CURSOR-POSITIONED                                CL**1
00549                                TO  TRUE                              CL**1
00550              PERFORM G100-DISPLAY-PANEL                              CL**1
00551 *                                                                    CL**1
00552          WHEN OTHER                                                  CL**1
00553              SET DP013-LOGIC-ABEND TO TRUE                           CL**1
00554              SET DP013-NO-ROLLBACK TO TRUE                           CL**1
00555              MOVE 'B100-CONTROL-PROCESSING'                          CL**1
00556                                TO  DP013-PARAGRAPH                   CL**1
00557              MOVE PM-PROGRAM-MESSAGE-12                              CL**1
00558                                TO  DP013-MESSAGE-TEXT(1)             CL**1
00559              PERFORM DP013-0000-PROCESS-ABEND                        CL**1
00560      END-EVALUATE.                                                   CL**1
00561 *                                                                    CL**1
00562  EJECT                                                               CL**1
00563 ******************************************************************   CL**1
00564 *    RECEIVE THE MAP AND PERFORM THE APPROPRIATE PARAGRAPH BASED     CL**1
00565 *    ON WHAT FUNCTION KEY WAS SELECTED.                              CL**1
00566 *                                                                    CL**1
00567 *    PERFORMED BY B100-CONTROL-PROCESSING.                           CL**1
00568 ******************************************************************   CL**1
00569 *                                                                    CL**1
00570  C300-PROCESS-PANEL.                                                 CL**1
00571 *                                                                    CL**1
00572      PERFORM DP007-0000-GET-PANEL.                                   CL**1
00573      SET PS-SEND-DATA-ONLY-FRSET                                     CL**1
00574                                TO TRUE.                              CL**1
00575      EVALUATE TRUE                                                   CL**1
00576 *                                                                    CL**1
00577          WHEN DP020-SRC-AID = DP016-CLEAR                            CL**1
00578              SET PS-SEND-MAP-N-DATA-FRSET TO TRUE                    CL**1
00579              SET PS-SAME-ITEMS-DISPLAYED  TO TRUE                    CL**1
00580              MOVE PC-COMPANY   TO  AOPERCOO                          CL*10
00581              PERFORM E100-EDIT-SELECTIONS                            CL**1
00582              PERFORM G100-DISPLAY-PANEL                              CL**1
00583 *                                                                    CL**1
00584          WHEN DP020-SRC-AID = DP016-PF5                              CL**1
00585              MOVE SPACES       TO  ANAVCMDO                          CL*25
00586                                    ANAVKEYO                          CL*25
00587              PERFORM Z050-DELETE-TEMP-STORAGE                        CL**1
00588              PERFORM D100-SETUP-INIT-PANEL                           CL**1
00589 *                                                                    CL**1
00590          WHEN DP020-SRC-AID = DP016-PA2                              CL**1
00591              PERFORM DP009-0000-LOAD-FK-LINES                        CL**1
00592              PERFORM DP017-0000-GET-CURR-DATE-TIME                   CL**1
00593              SET PS-SEND-DATA-ONLY                                   CL**1
00594                                TO  TRUE                              CL**1
00595              MOVE -1           TO  ANAVCMDL                          CL**1
00596              PERFORM DP008-0000-WRITE-PANEL                          CL**1
00597 *                                                                    CL**1
00598          WHEN OTHER                                                  CL**1
00599              PERFORM D200-RECORD-SELECTIONS                          CL**1
00600              IF PS-VALID-SELECTIONS                                  CL**1
00601                  PERFORM D300-CHECK-FUNCTION-KEY                     CL**1
00602              ELSE                                                    CL**1
00603                  SET PS-SAME-ITEMS-DISPLAYED TO TRUE                 CL**1
00604                  PERFORM G100-DISPLAY-PANEL                          CL**1
00605              END-IF                                                  CL**1
00606      END-EVALUATE.                                                   CL**1
00607 *                                                                    CL**1
00608  EJECT                                                               CL**1
00609 ******************************************************************   CL**1
00610 *    WHEN RETURNING TO THIS TRANSACTION FROM ANOTHER TRANSACTION,    CL**1
00611 *    SETUP THE ARRAY AS IT WAS WHEN WE HAD LEFT PREVIOUSLY.          CL**1
00612 *    EDIT THE SELECTIONS MADE AT THAT TIME AND DISPLAY THE PANEL     CL**1
00613 *    TO THE USER.  ALSO, RESTORE THE REQUESTED UPC AND SKU NBRS.     CL**1
00614 *                                                                    CL**1
00615 *    PERFORMED BY B100-CONTROL-PROCESSING.                           CL**1
00616 ******************************************************************   CL**1
00617 *                                                                    CL**1
00618  C400-REFRESH-PANEL-FROM-TEMP.                                       CL**1
00619 *                                                                    CL**1
00620      IF  MB129-DONT-UPDATE-TSQ                                       CL*16
00621          MOVE MB129-SAVE-INTER-APPL-COMMAREA                         CL*11
00622                                TO  MB005-INTER-APPL-COMMAREA         CL*11
00623      ELSE                                                            CL*11
00624          MOVE ZERO             TO  PV-SAVE-ITEM                      CL*11
00625                                    PV-RL-ITEM                        CL*11
00626          SET PS-NOT-END        TO  TRUE                              CL*16
00627          PERFORM C500-UPDATE-TSQ                                     CL*11
00628                  UNTIL PS-END-OF-ITEMS                               CL*16
00629          PERFORM X900-DELETE-LIST-QUEUE                              CL*23
00630          MOVE SPACES           TO  MB005-LIST-QUEUE-NAME             CL*23
00631      END-IF.                                                         CL*11
00632 *                                                                    CL*11
00633      PERFORM D400-REFRESH-BLOCK-ARRAY.                               CL**1
00634      PERFORM E100-EDIT-SELECTIONS.                                   CL**1
00635 *                                                                    CL**1
00636      SET PS-DIFFERENT-ITEMS-DISPLAYED TO TRUE.                       CL**1
00637      MOVE MB129-LIST-QUEUE-NAME                                      CL**1
00638                                TO  MB005-LIST-QUEUE-NAME.            CL**1
00639 *                                                                    CL**1
00640      MOVE PC-COMPANY           TO  AOPERCOO.                         CL**5
00641      PERFORM G100-DISPLAY-PANEL.                                     CL**1
00642 *                                                                    CL*11
00643  EJECT                                                               CL*11
00644 *                                                                    CL*11
00645 ******************************************************************   CL*11
00646 *    INCREMENT THE TSQ ITEM NUMBER AND READ THE LIST QUEUE.          CL*11
00647 *    LOOP THROUGH THE LIST QUEUE TO OBTAIN THE LINE ITEM NUMBER      CL*11
00648 *    TO BE USED TO UPDATE (DESELECT) THE CORRECT LINE ITEM IN        CL*11
00649 *    THE TEMP QUEUE.                                                 CL*11
00650 *                                                                    CL*11
00651 *    PERFORMED BY C400                                               CL*11
00652 ******************************************************************   CL*11
00653 *                                                                    CL*11
00654  C500-UPDATE-TSQ.                                                    CL*11
00655 *                                                                    CL*11
00656      ADD 1                     TO  PV-RL-ITEM.                       CL*11
00657      PERFORM X600-READ-LIST-QUEUE.                                   CL*11
00658      IF  PV-RESP EQUAL DFHRESP(NORMAL)                               CL*11
00659          SET MBWS129-IDX       TO  1                                 CL*11
00660          PERFORM C600-PROCESS-ITEMS                                  CL*11
00661              UNTIL MBWS129-RLEVEL (MBWS129-IDX) EQUAL SPACES         CL*11
00662                OR  MBWS129-IDX GREATER THAN MBWS129-MAX-RLEVELS      CL*11
00663          PERFORM X550-WRITE-TS-QUEUE                                 CL*11
00664      ELSE                                                            CL*11
00665          SET PS-END-OF-ITEMS   TO  TRUE                              CL*17
00666      END-IF.                                                         CL*17
00667 *                                                                    CL*11
00668  EJECT                                                               CL*11
00669 *                                                                    CL*11
00670 ******************************************************************   CL*11
00671 *    CALCULATE THE TEMP QUEUE ITEM THAT MUST BE READ AND READ IT.    CL*11
00672 *    REWRITE THE CURRENT TEMP QUEUE ITEM IF NECESSARY.  CALCULATE    CL*11
00673 *    THE LINE ITEM OCCURENCE AND UPDATE (DESELECT) IT.               CL*11
00674 *                                                                    CL*11
00675 *    PERFORMED BY C500                                               CL*11
00676 ******************************************************************   CL*11
00677 *                                                                    CL*11
00678  C600-PROCESS-ITEMS.                                                 CL*11
00679 *                                                                    CL*11
00680      COMPUTE PV-ITEM = 1 + ((MBWS129-ITEM (MBWS129-IDX) - 1)         CL*11
00681                      / PC-ITEMS-PER-BLOCK).                          CL*11
00682 *                                                                    CL*11
00683      IF  PV-ITEM NOT EQUAL PV-SAVE-ITEM                              CL*11
00684          IF  PV-SAVE-ITEM NOT EQUAL ZERO                             CL*11
00685              PERFORM X550-WRITE-TS-QUEUE                             CL*11
00686          END-IF                                                      CL*11
00687          MOVE PV-ITEM          TO  PV-SAVE-ITEM                      CL*11
00688 *                                                                    CL*11
00689          PERFORM X300-READ-TS-QUEUE                                  CL*15
00690          IF  PV-RESP NOT EQUAL DFHRESP(NORMAL)                       CL*11
00691              SET PS-END-OF-ITEMS TO TRUE                             CL*16
00692          END-IF                                                      CL*11
00693      END-IF.                                                         CL*11
00694 *                                                                    CL*11
00695      IF  PS-NOT-END                                                  CL*16
00696          COMPUTE PS-SUB = (MBWS129-ITEM (MBWS129-IDX)                CL*11
00697                         - PV-TW-LIST-ITEM-NUMBER (1)) + 1            CL*11
00698          SET PV-TW-DESELECT (PS-SUB)                                 CL*11
00699                                TO  TRUE                              CL*11
00700          SUBTRACT 1          FROM  MB005-NUMBER-PROCESSED-ITEMS      CL*11
00701                                    MB129-NUMBER-OF-SELECTED-ITEMS    CL*11
00702          IF  MB005-NUMBER-PROCESSED-ITEMS EQUAL ZERO                 CL*11
00703              SET PS-END-OF-ITEMS TO TRUE                             CL*16
00704              SET MBWS129-IDX   TO  MBWS129-MAX-RLEVELS               CL*12
00705          END-IF                                                      CL*11
00706          SET MBWS129-IDX    UP BY  1                                 CL*11
00707      END-IF.                                                         CL*11
00708 *                                                                    CL*11
00709  EJECT                                                               CL**1
00710 *                                                                    CL**1
00711 ******************************************************************   CL**1
00712 *    INITIALIZE BOTH BLOCKS IN THE ARRAY.                            CL**1
00713 *    INITIALIZE ALL COUNTERS AND FLAGS.                              CL**1
00714 *    READ THE DATA BASE FOR THE 1ST TIME AND FILL UP THE ARRAY.      CL**1
00715 *    DISPLAY THE PANEL TO USER.                                      CL**1
00716 *                                                                    CL**1
00717 *    PERFORMED BY B100-CONTROL-PROCESSING.                           CL**1
00718 *    PERFORMED BY C300-PROCESS-PANEL.                                CL**1
00719 ******************************************************************   CL**1
00720 *                                                                    CL**1
00721  D100-SETUP-INIT-PANEL.                                              CL**1
00722 *                                                                    CL**1
00723      INITIALIZE                  MB129-BLOCK-ENTRIES (1).            CL**1
00724      INITIALIZE                  MB129-BLOCK-ENTRIES (2).            CL**1
00725      MOVE SPACES             TO  MB129-LIST-QUEUE-NAME.              CL**1
00726      MOVE +1                 TO  MB129-BLK-SUB.                      CL**1
00727      MOVE PC-ITEMS-PER-PANEL TO  PV-HIGHEST-ITEM-TO-BE-READ.         CL**1
00728      SET MB129-ITEMS-LEFT-ON-DB                                      CL**1
00729                              TO  TRUE.                               CL**1
00730 *                                                                    CL**1
00731      MOVE +0                 TO  MB129-ITEM-SUB                      CL**1
00732                                  MB129-NUMBER-OF-ITEMS-READ          CL**1
00733                                  MB129-NUMBER-OF-SELECTED-ITEMS      CL**1
00734                                  MB129-HIGHEST-BLOCK-WRITTEN         CL**1
00735                                  MB129-START-OF-SELECTED-RANGE       CL**1
00736                                  MB129-END-OF-SELECTED-RANGE.        CL**1
00737 *                                                                    CL**1
00738      MOVE SPACES             TO  MB129-LAST-RLEVEL.                  CL**1
00739      PERFORM L100-OPEN-CURSOR.                                       CL**1
00740 *                                                                    CL**1
00741      PERFORM H100-READ-ITEMS-FROM-DB.                                CL**1
00742      SET PS-DIFFERENT-ITEMS-DISPLAYED                                CL**1
00743                              TO  TRUE.                               CL**1
00744 *                                                                    CL**1
00745      MOVE +1                 TO  MB129-ITEM-AT-TOP-OF-PANEL.         CL**1
00746 *                                                                    CL**1
00747      MOVE PC-COMPANY           TO  AOPERCOO.                         CL**5
00748      PERFORM G100-DISPLAY-PANEL.                                     CL**1
00749 *                                                                    CL**1
00750  EJECT                                                               CL**1
00751 ******************************************************************   CL**1
00752 *    IF THE USER HIT THE DESELECT KEY, OR A KEY WHICH INVOLVES       CL**1
00753 *    LEAVING THIS TRANSACTION AND GOING TO ANOTHER, SET A FLAG       CL**1
00754 *    INDICATING THAT ALL SELECTIONS ARE VALID.  IF ANY OTHER KEY     CL**1
00755 *    IS HIT, MOVE THE SELECTIONS MADE TO THE COMMAREA, AND EDIT      CL**1
00756 *    THOSE SELECTIONS.                                               CL**1
00757 *                                                                    CL**1
00758 *    IF THE USER ENTERED SOMETHING IN THE COMMAND LINE OR HIT        CL**1
00759 *    AN INVALID FUNCTION KEY, DO NOT EDIT THE SELECTIONS.            CL**1
00760 *                                                                    CL**1
00761 *    PERFORMED BY C300-PROCESS-PANEL.                                CL**1
00762 ******************************************************************   CL**1
00763 *                                                                    CL**1
00764  D200-RECORD-SELECTIONS.                                             CL**1
00765 *                                                                    CL**1
00766      IF (DP020-FK-DESELECT(DP020-SRC-AID))   OR                      CL**1
00767         (DP020-FK-SELECT-ALL(DP020-SRC-AID)) OR                      CL**1
00768         (DP020-FK-GO-TO-TRAN(DP020-SRC-AID)) OR                      CL**1
00769         (DP020-FK-RETURN(DP020-SRC-AID))                             CL**1
00770          SET PS-VALID-SELECTIONS TO TRUE                             CL**1
00771      ELSE                                                            CL**1
00772 *                                                                    CL**1
00773          PERFORM E200-MOVE-SELECTS-TO-COMMAREA                       CL**1
00774          IF (DP020-SRC-AID          = DP016-ENTER) AND               CL**1
00775             (DP020-NAV-MNEMONIC NOT = SPACES)      AND               CL**1
00776             (DP020-NAV-MNEMONIC NOT = LOW-VALUES)                    CL**1
00777              SET PS-VALID-SELECTIONS TO TRUE                         CL**1
00778          ELSE                                                        CL**1
00779 *                                                                    CL**1
00780 *            IF (DP020-FK-FIRST-PAGE(DP020-SRC-AID)) OR              CL*21
00781 *               (DP020-FK-PREV-PAGE(DP020-SRC-AID))  OR              CL*21
00782 *               (DP020-FK-NEXT-PAGE(DP020-SRC-AID))  OR              CL*21
00783 *               (DP020-FK-EDIT-GOTO(DP020-SRC-AID))  OR              CL*21
00784 *               (DP020-SRC-AID = DP016-ENTER)                        CL*21
00785                  PERFORM E100-EDIT-SELECTIONS                        CL**1
00786 *            ELSE                                                    CL*21
00787 *                SET PS-VALID-SELECTIONS TO TRUE                     CL*25
00788 *            END-IF                                                  CL*21
00789          END-IF                                                      CL**1
00790      END-IF.                                                         CL**1
00791  EJECT                                                               CL**1
00792 ******************************************************************   CL**1
00793 *    PERFORM THE APPROPRIATE PARAGRAPH BASED ON WHICH FUNCTION       CL**1
00794 *    KEY HAD BEEN SELECTED BY THE USER.                              CL**1
00795 *                                                                    CL**1
00796 *    PERFORMED BY C300-PROCESS-PANEL.                                CL**1
00797 ******************************************************************   CL**1
00798 *                                                                    CL**1
00799  D300-CHECK-FUNCTION-KEY.                                            CL**1
00800 *                                                                    CL**1
00801      EVALUATE TRUE                                                   CL**1
00802 *                                                                    CL**1
00803          WHEN DP020-FK-GO-TO-TRAN(DP020-SRC-AID)                     CL**1
00804               SET MB129-DONT-UPDATE-TSQ                              CL*16
00805                                TO  TRUE                              CL*11
00806               PERFORM E300-NAVIGATE                                  CL**1
00807 *                                                                    CL**1
00808 *    FOR THE ADD FUNCTION (PF13) NO SELECTED ITEMS REQUIRED.         CL**1
00809 *                                                                    CL**1
00810          WHEN DP020-FK-EDIT-GOTO(DP020-SRC-AID)                      CL**1
00811            IF PS-CONTINUE                                            CL*16
00812               IF  DP020-SRC-AID = DP016-PF13                         CL**1
00813                   MOVE SPACES  TO  MB005-LIST-QUEUE-NAME             CL**1
00814                   SET MB129-DONT-UPDATE-TSQ                          CL*16
00815                                TO  TRUE                              CL*11
00816                   PERFORM E300-NAVIGATE                              CL**1
00817               ELSE                                                   CL**1
00818                   IF  MB129-NUMBER-OF-SELECTED-ITEMS > ZERO          CL**1
00819                       PERFORM X100-PREPARE-LIST-QUEUE                CL**1
00820                       IF  PS-CONTINUE                                CL*16
00821                           SET MB129-UPDATE-TSQ                       CL*16
00822                                TO  TRUE                              CL*11
00823                           PERFORM E300-NAVIGATE                      CL**1
00824                       ELSE                                           CL**1
00825 *                                                                    CL**1
00826                           SET DP013-LOGIC-ABEND TO TRUE              CL**1
00827                           SET DP013-NO-ROLLBACK TO TRUE              CL**1
00828                           MOVE 'D300-CHECK-FUNCTION-KEY'             CL**1
00829                                TO  DP013-PARAGRAPH                   CL**1
00830                           MOVE PM-PROGRAM-MESSAGE-28                 CL**1
00831                                TO  DP013-MESSAGE-TEXT(1)             CL**1
00832                           PERFORM DP013-0000-PROCESS-ABEND           CL**1
00833                       END-IF                                         CL**1
00834                   ELSE                                               CL**1
00835 *                                                                    CL**1
00836                       MOVE PC-TSYMSG-00057                           CL**1
00837                                TO  DP020-MSG-NUMBER                  CL**1
00838                       SET DP020-MSG-WARNING                          CL**1
00839                                TO TRUE                               CL**1
00840                       PERFORM G100-DISPLAY-PANEL                     CL**1
00841                   END-IF                                             CL**1
00842               END-IF                                                 CL*14
00843            ELSE                                                      CL*14
00844               PERFORM G100-DISPLAY-PANEL                             CL*14
00845            END-IF                                                    CL*14
00846 *                                                                    CL**1
00847          WHEN DP020-FK-RETURN(DP020-SRC-AID)                         CL**1
00848               PERFORM X900-DELETE-LIST-QUEUE                         CL**1
00849               PERFORM E300-NAVIGATE                                  CL**1
00850 *                                                                    CL**1
00851          WHEN DP020-FK-FIRST-PAGE(DP020-SRC-AID)                     CL**1
00852               PERFORM E400-DISPLAY-TOP-OF-LIST                       CL**1
00853 *                                                                    CL**1
00854          WHEN DP020-FK-PREV-PAGE(DP020-SRC-AID)                      CL**1
00855               PERFORM E500-BROWSE-BACKWARD                           CL**1
00856 *                                                                    CL**1
00857          WHEN DP020-FK-NEXT-PAGE(DP020-SRC-AID)                      CL**1
00858               PERFORM E600-BROWSE-FORWARD                            CL**1
00859 *                                                                    CL**1
00860          WHEN DP020-FK-DESELECT(DP020-SRC-AID)                       CL**1
00861               PERFORM E700-DESELECT-ALL-ITEMS                        CL**1
00862 *                                                                    CL**1
00863          WHEN DP020-FK-SELECT-ALL(DP020-SRC-AID)                     CL**1
00864               PERFORM E900-SELECT-ALL-ITEMS                          CL**1
00865 *                                                                    CL**1
00866          WHEN DP020-SRC-AID = DP016-ENTER                            CL**1
00867              IF (DP020-NAV-MNEMONIC = LOW-VALUES) OR                 CL**1
00868                 (DP020-NAV-MNEMONIC = SPACES)                        CL**1
00869                  PERFORM E800-CHECK-FOR-JUMP-BROWSE                  CL**1
00870              ELSE                                                    CL**1
00871                  SET MB129-DONT-UPDATE-TSQ                           CL*16
00872                                TO  TRUE                              CL*11
00873                  PERFORM E300-NAVIGATE                               CL**1
00874              END-IF                                                  CL**1
00875 *                                                                    CL**1
00876          WHEN OTHER                                                  CL**1
00877              MOVE PC-TSYMSG-00045                                    CL**9
00878                                TO  DP020-MSG-NUMBER                  CL**9
00879              SET DP020-MSG-FATAL                                     CL**9
00880                                TO  TRUE                              CL**9
00881              PERFORM G100-DISPLAY-PANEL                              CL**9
00882 *                                                                    CL**1
00883      END-EVALUATE.                                                   CL**1
00884  EJECT                                                               CL**1
00885 ******************************************************************   CL**1
00886 *    WHEN RETURNING TO THIS TRANSACTION FROM ANOTHER TRANSACTION,    CL**1
00887 *    READ TEMPORARY STORAGE FILLING IN BOTH BLOCKS IN THE ARRAY      CL**1
00888 *    WITH THE ITEMS THAT WERE AT THE TOP OF THE LIST WHEN WE         CL**1
00889 *    HAD LEFT PREVIOUSLY.                                            CL**1
00890 *                                                                    CL**1
00891 *    PERFORMED BY C400-REFRESH-PANEL-FROM-TEMP.                      CL**1
00892 ******************************************************************   CL**1
00893 *                                                                    CL**1
00894  D400-REFRESH-BLOCK-ARRAY.                                           CL**1
00895 *                                                                    CL**1
00896      COMPUTE PV-TEMP-BLOCK-NUMBER =                                  CL**1
00897          1 + ((MB129-LIST-ITEM-NUMBER(1 1) - 1) /                    CL**1
00898                PC-ITEMS-PER-BLOCK).                                  CL**1
00899                                                                      CL**1
00900      MOVE PV-TEMP-BLOCK-NUMBER TO PV-BLOCK-NUMBER.                   CL**1
00901      MOVE +1                   TO MB129-BLK-SUB.                     CL**1
00902                                                                      CL**1
00903      PERFORM Z100-READ-TEMP-STORAGE.                                 CL**1
00904                                                                      CL**1
00905      ADD +1 TO PV-BLOCK-NUMBER.                                      CL**1
00906                                                                      CL**1
00907      IF (PV-BLOCK-NUMBER < MB129-HIGHEST-BLOCK-WRITTEN) OR           CL**1
00908         (PV-BLOCK-NUMBER = MB129-HIGHEST-BLOCK-WRITTEN)              CL**1
00909          ADD +1 TO MB129-BLK-SUB                                     CL**1
00910                                                                      CL**1
00911          PERFORM Z100-READ-TEMP-STORAGE                              CL**1
00912      END-IF.                                                         CL**1
00913 *                                                                    CL**1
00914  EJECT                                                               CL**1
00915 ******************************************************************   CL**1
00916 *    EDIT EACH SELECTION ENTRY.  IF EACH ENTRY IS CONSIDERED         CL**1
00917 *    VALID, CHECK IF A BEGINNING AND ENDING ENTRY WAS ENTERED,       CL**1
00918 *    AND CHECK THE FOLLOWING.                                        CL**1
00919 *                                                                    CL**1
00920 *    1) IF THERE IS A BEGINNING RANGE, THERE MUST BE AN ENDING.      CL**1
00921 *    2) IF THERE IS A ENDING RANGE, THERE MUST BE AN BEGINNING.      CL**1
00922 *    3) BEGINNING RANGE MUST PRECEDE ENDING RANGE.                   CL**1
00923 *                                                                    CL**1
00924 *    IF A VALID BEGINNING AND ENDING RANGE HAVE BEEN SELECTED,       CL**1
00925 *    MARK ALL ITEMS IN THAT RANGE AS BEING SELECTED.                 CL**1
00926 *                                                                    CL**1
00927 *    PERFORMED BY B100-CONTROL-PROCESSING.                           CL**1
00928 *    PERFORMED BY C300-PROCESS-PANEL.                                CL**1
00929 *    PERFORMED BY C400-REFRESH-PANEL-FROM-TEMP.                      CL**1
00930 *    PERFORMED BY D200-RECORD-SELECTIONS.                            CL**1
00931 ******************************************************************   CL**1
00932 *                                                                    CL**1
00933  E100-EDIT-SELECTIONS.                                               CL**1
00934 *                                                                    CL**1
00935      SET PS-VALID-SELECTIONS TO TRUE.                                CL**1
00936                                                                      CL**1
00937      COMPUTE PV-ENDING-ITEM-ON-PANEL =                               CL**1
00938          (MB129-ITEM-AT-TOP-OF-PANEL + PC-ITEMS-PER-PANEL) - 1.      CL**1
00939      MOVE MB129-ITEM-AT-TOP-OF-PANEL                                 CL**1
00940                                TO  PV-ITEM-IN-USE.                   CL**1
00941      MOVE +1                   TO  PS-SUB.                           CL**1
00942 *                                                                    CL**1
00943      PERFORM F100-EDIT                                               CL**1
00944          UNTIL (PV-ITEM-IN-USE > PV-ENDING-ITEM-ON-PANEL)            CL**1
00945             OR (PV-ITEM-IN-USE > MB129-NUMBER-OF-ITEMS-READ).        CL**1
00946 *                                                                    CL**1
00947      IF  PS-VALID-SELECTIONS                                         CL**1
00948          IF  MB129-START-OF-SELECTED-RANGE GREATER ZERO              CL**1
00949              IF  MB129-END-OF-SELECTED-RANGE GREATER                 CL**1
00950                  MB129-START-OF-SELECTED-RANGE                       CL**1
00951                  PERFORM F200-MARK-RANGE-AS-SELECTED                 CL**1
00952              ELSE                                                    CL**1
00953 *                                                                    CL**1
00954                  IF  MB129-END-OF-SELECTED-RANGE = +0                CL**1
00955                      SET PS-CURSOR-POSITIONED                        CL**1
00956                                TO  TRUE                              CL**1
00957                      SET PS-WARNING                                  CL**1
00958                                TO  TRUE                              CL**1
00959                      MOVE PC-TSYMSG-00051                            CL**1
00960                                TO  DP020-MSG-NUMBER                  CL**1
00961                      IF  NOT DP020-NEXT-ACT-ERROR                    CL**1
00962                          SET DP020-MSG-WARNING TO TRUE               CL**1
00963                      END-IF                                          CL**1
00964                  ELSE                                                CL**1
00965 *                                                                    CL**1
00966                      SET PS-CURSOR-POSITIONED                        CL**1
00967                                TO  TRUE                              CL**1
00968                      SET PS-INVALID-SELECTIONS                       CL**1
00969                                TO  TRUE                              CL**1
00970                      SET DP020-MSG-FATAL                             CL**1
00971                                TO  TRUE                              CL**1
00972                      MOVE PC-TSYMSG-00052                            CL**1
00973                                TO  DP020-MSG-NUMBER                  CL**1
00974                      IF  NOT DP020-NEXT-ACT-ERROR                    CL**1
00975                          MOVE MB129-ITEM-AT-TOP-OF-PANEL             CL**1
00976                                TO  PV-ITEM-IN-USE                    CL**1
00977                          MOVE +1                                     CL**1
00978                                TO  PS-SUB                            CL**1
00979 *                                                                    CL**1
00980                          PERFORM                                     CL**1
00981                              UNTIL (PV-ITEM-IN-USE >                 CL**1
00982                                     PV-ENDING-ITEM-ON-PANEL)         CL**1
00983                                 OR (PV-ITEM-IN-USE >                 CL**1
00984                                     MB129-NUMBER-OF-ITEMS-READ)      CL**1
00985 *                                                                    CL**1
00986                              PERFORM K100-SET-SUBSCRIPTS             CL**1
00987                              IF (MB129-BEGIN(MB129-BLK-SUB           CL**1
00988                                              MB129-ITEM-SUB))        CL**1
00989                              OR (MB129-END(MB129-BLK-SUB             CL**1
00990                                            MB129-ITEM-SUB))          CL**1
00991                                  MOVE -1                             CL**1
00992                                     TO  MBKM129-SELECTL(PS-SUB)      CL*13
00993                                  MOVE PV-ENDING-ITEM-ON-PANEL        CL**1
00994                                     TO  PV-ITEM-IN-USE               CL**1
00995                              END-IF                                  CL**1
00996                              ADD +1 TO  PS-SUB                       CL**1
00997                              ADD +1 TO  PV-ITEM-IN-USE               CL**1
00998                          END-PERFORM                                 CL**1
00999 *                                                                    CL**1
01000                      END-IF                                          CL**1
01001                  END-IF                                              CL**1
01002              END-IF                                                  CL**1
01003          ELSE                                                        CL**1
01004 *                                                                    CL**1
01005              IF MB129-END-OF-SELECTED-RANGE > +0                     CL**1
01006                  SET PS-CURSOR-POSITIONED TO TRUE                    CL**1
01007                  SET PS-WARNING           TO TRUE                    CL**1
01008                  MOVE PC-TSYMSG-00053                                CL**1
01009                                TO  DP020-MSG-NUMBER                  CL**1
01010                  IF NOT DP020-NEXT-ACT-ERROR                         CL**1
01011                      SET DP020-MSG-WARNING TO TRUE                   CL**1
01012                  END-IF                                              CL**1
01013              END-IF                                                  CL**1
01014          END-IF                                                      CL**1
01015      END-IF.                                                         CL**1
01016 *                                                                    CL*13
01017      IF  DP020-MSG-SEVERITY-IND GREATER THAN SPACES                  CL*13
01018          SET PS-DONT-PROCESS   TO  TRUE                              CL*16
01019      END-IF.                                                         CL*13
01020 *                                                                    CL*13
01021  EJECT                                                               CL**1
01022 ******************************************************************   CL**1
01023 *    MOVE THE SELECTIONS MADE FROM THE CURRENT PAGE INTO             CL**1
01024 *    THE COMMAREA.                                                   CL**1
01025 *                                                                    CL**1
01026 *    PERFORMED BY D200-RECORD-SELECTIONS.                            CL**1
01027 ******************************************************************   CL**1
01028 *                                                                    CL**1
01029  E200-MOVE-SELECTS-TO-COMMAREA.                                      CL**1
01030 *                                                                    CL**1
01031      COMPUTE PV-ENDING-ITEM-ON-PANEL =                               CL**1
01032          (MB129-ITEM-AT-TOP-OF-PANEL + PC-ITEMS-PER-PANEL) - 1.      CL**1
01033                                                                      CL**1
01034      MOVE +1                         TO PS-SUB.                      CL**1
01035      MOVE MB129-ITEM-AT-TOP-OF-PANEL TO PV-ITEM-IN-USE.              CL**1
01036                                                                      CL**1
01037      PERFORM F300-CHECK-SELECTIONS                                   CL**1
01038          UNTIL PV-ITEM-IN-USE > PV-ENDING-ITEM-ON-PANEL.             CL**1
01039  EJECT                                                               CL**1
01040 ******************************************************************   CL**1
01041 *    IF THE USER HITS A KEY THAT REQUIRES US TO GO TO ANOTHER        CL**1
01042 *    TRANSACTION, WRITE OUT THE LAST 2 BLOCKS FROM THE ARRAY TO      CL**1
01043 *    TEMPORARY STORAGE, SET UP THE INTER APPLICATION COMMAREA,       CL**1
01044 *    AND START THE NAVIGATOR.                                        CL**1
01045 *                                                                    CL**1
01046 *    PERFORMED BY D300-CHECK-FUNCTION-KEY.                           CL**1
01047 ******************************************************************   CL**1
01048 *                                                                    CL**1
01049  E300-NAVIGATE.                                                      CL**1
01050 *                                                                    CL**1
01051      MOVE +1 TO MB129-BLK-SUB.                                       CL**1
01052      PERFORM Z150-WRITE-TEMP-STORAGE.                                CL**1
01053 *                                                                    CL**1
01054      ADD +1 TO MB129-BLK-SUB.                                        CL**1
01055      PERFORM Z150-WRITE-TEMP-STORAGE.                                CL**1
01056 *                                                                    CL**1
01057      MOVE MB005-INTER-APPL-COMMAREA                                  CL**1
01058                                TO  MB129-SAVE-INTER-APPL-COMMAREA.   CL**1
01059      SET DP020-MB-RESP-LEVEL-LIST                                    CL*20
01060                                TO  TRUE.                             CL*20
01061      PERFORM DP015-1000-START-NAVIGATOR.                             CL**1
01062  EJECT                                                               CL**1
01063 ******************************************************************   CL**1
01064 *    IF THE USER HITS THE 1ST PAGE KEY, COMPUTE THE TOP ITEM         CL**1
01065 *    NUMBER FOR THE NEW PAGE AND DETERMINE IF THIS ITEM              CL**1
01066 *    IS CURRENTLY IN THE ARRAY, OR IN TEMPORARY STORAGE OR NEEDS     CL**1
01067 *    TO BE READ.                                                     CL**1
01068 *                                                                    CL**1
01069 *    PERFORMED BY D300-CHECK-FUNCTION-KEY.                           CL**1
01070 ******************************************************************   CL**1
01071 *                                                                    CL**1
01072  E400-DISPLAY-TOP-OF-LIST.                                           CL**1
01073 *                                                                    CL**1
01074      IF  MB129-NUMBER-OF-ITEMS-READ > +0                             CL**1
01075          MOVE +1 TO PV-TOP-ITEM                                      CL**1
01076          PERFORM F500-BROWSE                                         CL**1
01077      ELSE                                                            CL**1
01078          SET PS-SAME-ITEMS-DISPLAYED TO TRUE                         CL**1
01079          PERFORM G100-DISPLAY-PANEL                                  CL**1
01080      END-IF.                                                         CL**1
01081  EJECT                                                               CL**1
01082 ******************************************************************   CL**1
01083 *    IF THE USER HITS THE PAGE BACKARD KEY, COMPUTE THE TOP          CL**1
01084 *    ITEM NUMBER FOR THE NEW PAGE AND DETERMINE IF THIS ITEM         CL**1
01085 *    IS CURRENTLY IN THE ARRAY, OR IN TEMPORARY STORAGE OR NEEDS     CL**1
01086 *    TO BE READ.                                                     CL**1
01087 *                                                                    CL**1
01088 *    PERFORMED BY D300-CHECK-FUNCTION-KEY.                           CL**1
01089 ******************************************************************   CL**1
01090 *                                                                    CL**1
01091  E500-BROWSE-BACKWARD.                                               CL**1
01092 *                                                                    CL**1
01093      IF  MB129-NUMBER-OF-ITEMS-READ > +0                             CL**1
01094          COMPUTE PV-TOP-ITEM =                                       CL**1
01095              MB129-ITEM-AT-TOP-OF-PANEL - PC-ITEMS-PER-PANEL         CL**1
01096          PERFORM F500-BROWSE                                         CL**1
01097      ELSE                                                            CL**1
01098          SET PS-SAME-ITEMS-DISPLAYED TO TRUE                         CL**1
01099          PERFORM G100-DISPLAY-PANEL                                  CL**1
01100      END-IF.                                                         CL**1
01101 *                                                                    CL**1
01102  EJECT                                                               CL**1
01103 ******************************************************************   CL**1
01104 *    IF THE USER HITS THE PAGE FORWARD KEY, COMPUTE THE TOP          CL**1
01105 *    ITEM NUMBER FOR THE NEW PAGE AND DETERMINE IF THIS ITEM         CL**1
01106 *    IS CURRENTLY IN THE ARRAY, OR IN TEMPORARY STORAGE OR NEEDS     CL**1
01107 *    TO BE READ.                                                     CL**1
01108 *                                                                    CL**1
01109 *    PERFORMED BY D300-CHECK-FUNCTION-KEY.                           CL**1
01110 ******************************************************************   CL**1
01111 *                                                                    CL**1
01112  E600-BROWSE-FORWARD.                                                CL**1
01113 *                                                                    CL**1
01114      IF  MB129-NUMBER-OF-ITEMS-READ > +0                             CL**1
01115          COMPUTE PV-TOP-ITEM =                                       CL**1
01116              MB129-ITEM-AT-TOP-OF-PANEL + PC-ITEMS-PER-PANEL         CL**1
01117          PERFORM F500-BROWSE                                         CL**1
01118      ELSE                                                            CL**1
01119          SET PS-SAME-ITEMS-DISPLAYED TO TRUE                         CL**1
01120          PERFORM G100-DISPLAY-PANEL                                  CL**1
01121      END-IF.                                                         CL**1
01122 *                                                                    CL**1
01123  EJECT                                                               CL**1
01124 ******************************************************************   CL**1
01125 *    IF THE USER HITS THE DESELECT KEY, CLEAR THE SELECTION          CL**1
01126 *    SWITCH FOR ALL ITEMS THAT WERE PREVIOUSLY SELECTED.             CL**1
01127 *                                                                    CL**1
01128 *    PERFORMED BY D300-CHECK-FUNCTION-KEY.                           CL**1
01129 ******************************************************************   CL**1
01130 *                                                                    CL**1
01131  E700-DESELECT-ALL-ITEMS.                                            CL**1
01132 *                                                                    CL**1
01133      IF  MB129-NUMBER-OF-ITEMS-READ > +0                             CL**1
01134          MOVE +1               TO  MB129-BLK-SUB                     CL**1
01135                                                                      CL**1
01136          PERFORM F600-CLEAR-SELECTED-INDS                            CL**1
01137              VARYING MB129-ITEM-SUB FROM 1 BY 1                      CL**1
01138              UNTIL MB129-ITEM-SUB > PC-ITEMS-PER-BLOCK               CL**1
01139                                                                      CL**1
01140          ADD +1                TO  MB129-BLK-SUB                     CL**1
01141                                                                      CL**1
01142          PERFORM F600-CLEAR-SELECTED-INDS                            CL**1
01143              VARYING MB129-ITEM-SUB FROM 1 BY 1                      CL**1
01144              UNTIL MB129-ITEM-SUB > PC-ITEMS-PER-BLOCK               CL**1
01145                                                                      CL**1
01146          MOVE MB129-LIST-ITEM-NUMBER(1 1) TO PV-LIST-ITEM-NUMBER     CL**1
01147                                                                      CL**1
01148          COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                           CL**1
01149              1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-BLOCK)    CL**1
01150                                                                      CL**1
01151          IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                    CL**1
01152             (MB129-HIGHEST-BLOCK-WRITTEN > PC-MAX-BLOCKS-IN-ARRAY)   CL**1
01153              MOVE +1 TO MB129-BLK-SUB                                CL**1
01154                                                                      CL**1
01155              PERFORM Z150-WRITE-TEMP-STORAGE                         CL**1
01156                                                                      CL**1
01157              MOVE +1 TO PV-BLOCK-NUMBER                              CL**1
01158                                                                      CL**1
01159              COMPUTE PV-PREV-BLOCK-IN-ARRAY =                        CL**1
01160                  PV-FIRST-BLOCK-IN-ARRAY - 1                         CL**1
01161                                                                      CL**1
01162              PERFORM                                                 CL**1
01163                  UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY      CL**1
01164                                                                      CL**1
01165                  PERFORM Z100-READ-TEMP-STORAGE                      CL**1
01166                                                                      CL**1
01167                  PERFORM F600-CLEAR-SELECTED-INDS                    CL**1
01168                      VARYING MB129-ITEM-SUB FROM 1 BY 1              CL**1
01169                      UNTIL MB129-ITEM-SUB > PC-ITEMS-PER-BLOCK       CL**1
01170                                                                      CL**1
01171                  PERFORM Z150-WRITE-TEMP-STORAGE                     CL**1
01172                                                                      CL**1
01173                  ADD +1 TO PV-BLOCK-NUMBER                           CL**1
01174                                                                      CL**1
01175              END-PERFORM                                             CL**1
01176                                                                      CL**1
01177              COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                        CL**1
01178                  PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY    CL**1
01179                                                                      CL**1
01180              PERFORM                                                 CL**1
01181                  UNTIL PV-NEXT-BLOCK-IN-ARRAY >                      CL**1
01182                        MB129-HIGHEST-BLOCK-WRITTEN                   CL**1
01183                                                                      CL**1
01184                  MOVE PV-NEXT-BLOCK-IN-ARRAY TO PV-BLOCK-NUMBER      CL**1
01185                                                                      CL**1
01186                  PERFORM Z100-READ-TEMP-STORAGE                      CL**1
01187                                                                      CL**1
01188                  PERFORM F600-CLEAR-SELECTED-INDS                    CL**1
01189                      VARYING MB129-ITEM-SUB FROM 1 BY 1              CL**1
01190                      UNTIL MB129-ITEM-SUB > PC-ITEMS-PER-BLOCK       CL**1
01191                                                                      CL**1
01192                  PERFORM Z150-WRITE-TEMP-STORAGE                     CL**1
01193                                                                      CL**1
01194                  ADD +1 TO PV-NEXT-BLOCK-IN-ARRAY                    CL**1
01195                                                                      CL**1
01196              END-PERFORM                                             CL**1
01197                                                                      CL**1
01198              MOVE PV-FIRST-BLOCK-IN-ARRAY TO PV-BLOCK-NUMBER         CL**1
01199                                                                      CL**1
01200              PERFORM Z100-READ-TEMP-STORAGE                          CL**1
01201          END-IF                                                      CL**1
01202                                                                      CL**1
01203      END-IF.                                                         CL**1
01204                                                                      CL**1
01205      MOVE +0 TO MB129-NUMBER-OF-SELECTED-ITEMS.                      CL**1
01206      MOVE +0 TO MB129-START-OF-SELECTED-RANGE.                       CL**1
01207      MOVE +0 TO MB129-END-OF-SELECTED-RANGE.                         CL**1
01208                                                                      CL**1
01209      SET PS-SAME-ITEMS-DISPLAYED TO TRUE.                            CL**1
01210                                                                      CL**1
01211      PERFORM G100-DISPLAY-PANEL.                                     CL**1
01212  EJECT                                                               CL**1
01213 ******************************************************************   CL**1
01214 *    THE USER CAN CHANGE THE CURRENT BEGINNING LIST NUMBER SO        CL**1
01215 *    THAT THE TRANSACTION WILL JUMP TO THAT POINT IN THE LIST.       CL**1
01216 *    THIS IS A FASTER WAY TO GET TO A CERTAIN POINT IN THE LIST      CL**1
01217 *    RATHER THAN HITTING PF8 TO PAGE FORWARD TO THAT POINT.          CL**1
01218 *    THE NEW LIST NUMBER ENTERED IS EDITED TO MAKE SURE THAT         CL**1
01219 *    IT IS NUMERIC AND FALLS BETWEEN A SPECIFIED RANGE.              CL**1
01220 *                                                                    CL**1
01221 *    PERFORMED BY D300-CHECK-FUNCTION-KEY.                           CL**1
01222 ******************************************************************   CL**1
01223 *                                                                    CL**1
01224  E800-CHECK-FOR-JUMP-BROWSE.                                         CL**1
01225 *                                                                    CL**1
01226      SET PS-VALID-BEG-ITEM TO TRUE.                                  CL**1
01227                                                                      CL**1
01228      IF (ABEGITMA                   = PC-ERASE-EOF) OR               CL**5
01229         (MB129-NUMBER-OF-ITEMS-READ = +0)                            CL**1
01230          SET PS-SAME-ITEMS-DISPLAYED TO TRUE                         CL**1
01231          PERFORM G100-DISPLAY-PANEL                                  CL**1
01232      ELSE                                                            CL**1
01233 *                                                                    CL**1
01234          MOVE ABEGITMI         TO  DP010I-UNEDITED-FIELD             CL**5
01235          MOVE PC-FIELD-LENGTH  TO  DP010I-MAXIMUM-DIGITS             CL**1
01236          MOVE +0               TO  DP010I-MAXIMUM-DECIMALS           CL**1
01237          SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                     CL**1
262978         CALL DP010I-NUMERIC-EDIT-ROUTINE                                 
262978              USING DP010I-NUMERIC-EDIT-AREA                              
01239 *                                                                    CL**1
01240          IF  NOT DP010I-ERROR-DETECTED                               CL**1
01241              MOVE DP010I-NUMERIC-FIELD                               CL**1
01242                                TO  PV-BEGITMI-N                      CL**1
01243              MOVE PV-BEGITMI-N TO  PV-BEGINNING-ITEM                 CL**1
01244 *                                                                    CL**1
01245              IF (PV-BEGINNING-ITEM >  0)          AND                CL**1
01246                 (PV-BEGINNING-ITEM <  PC-MAX-ITEMS)                  CL**1
01247                  MOVE PV-BEGINNING-ITEM TO PV-TOP-ITEM               CL**1
01248                                                                      CL**1
01249                  COMPUTE PV-MAX-ITEMS-TO-BE-READ =                   CL**1
01250                      ((MB129-NUMBER-OF-ITEMS-READ +                  CL**1
01251                        PC-MAX-ITEMS-TO-BE-READ)   -                  CL**1
01252                        PC-ITEMS-PER-PANEL)        + 1                CL**1
01253 *                                                                    CL**1
01254                  IF PV-TOP-ITEM > PV-MAX-ITEMS-TO-BE-READ            CL**1
01255                      MOVE PV-MAX-ITEMS-TO-BE-READ                    CL**1
01256                                TO  PV-TOP-ITEM                       CL**1
01257                      MOVE -1   TO  ABEGITML                          CL**5
01258 *                                                                    CL**1
01259                      IF MB129-NO-ITEMS-LEFT-ON-DB                    CL**1
01260                          MOVE PC-TSYMSG-00070                        CL*22
01261                                TO  DP020-MSG-NUMBER                  CL**1
01262                      ELSE                                            CL**1
01263                          MOVE PC-TSYMSG-00207                        CL*22
01264                                TO  DP020-MSG-NUMBER                  CL**1
01265                      END-IF                                          CL**1
01266 *                                                                    CL**1
01267                      SET PS-CURSOR-POSITIONED                        CL**1
01268                                TO  TRUE                              CL**1
01269                      SET DP020-MSG-INFORMATIONAL                     CL**1
01270                                TO  TRUE                              CL**1
01271                  END-IF                                              CL**1
01272                  PERFORM F500-BROWSE                                 CL**1
01273              ELSE                                                    CL**1
01274                  MOVE PC-TSYMSG-00101                                CL**6
01275                                TO  DP020-MSG-NUMBER                  CL**6
01276                  MOVE -1       TO  ABEGITML                          CL**5
01277                  MOVE DP015-REVERSE                                  CL**1
01278                                TO  ABEGITMH                          CL**5
01279                  MOVE DP015-RED                                      CL**1
01280                                TO  ABEGITMC                          CL**5
01281                  MOVE DP015-UNP-NUM-BRT-MDT                          CL**1
01282                                TO  ABEGITMA                          CL**5
01283                  SET PS-CURSOR-POSITIONED                            CL**1
01284                                TO  TRUE                              CL**1
01285                  SET DP020-MSG-FATAL                                 CL**1
01286                                TO  TRUE                              CL**1
01287                  SET PS-INVALID-BEG-ITEM                             CL**1
01288                                TO  TRUE                              CL**1
01289              END-IF                                                  CL**1
01290 *                                                                    CL**1
01291          ELSE                                                        CL**1
01292              MOVE PC-TSYMSG-00008                                    CL**1
01293                                TO  DP020-MSG-NUMBER                  CL**1
01294              MOVE -1           TO  ABEGITML                          CL**5
01295              MOVE DP015-REVERSE                                      CL**1
01296                                TO  ABEGITMH                          CL**5
01297              MOVE DP015-RED    TO  ABEGITMC                          CL**5
01298              MOVE DP015-UNP-NUM-BRT-MDT                              CL**1
01299                                TO  ABEGITMA                          CL**5
01300              SET PS-CURSOR-POSITIONED                                CL**1
01301                                TO  TRUE                              CL**1
01302              SET DP020-MSG-FATAL                                     CL**1
01303                                TO  TRUE                              CL**1
01304              SET PS-INVALID-BEG-ITEM                                 CL**1
01305                                TO  TRUE                              CL**1
01306          END-IF                                                      CL**1
01307      END-IF.                                                         CL**1
01308 *                                                                    CL**1
01309      IF  PS-INVALID-BEG-ITEM                                         CL**1
01310          SET PS-SAME-ITEMS-DISPLAYED TO TRUE                         CL**1
01311          PERFORM DP017-0000-GET-CURR-DATE-TIME                       CL**1
01312          PERFORM I200-FORMAT-LIST-LINES                              CL**1
01313          PERFORM I300-FORMAT-NR-SELECTED                             CL**1
01314          PERFORM DP005-0000-FORMAT-MSG-LINES                         CL**1
01315          PERFORM DP008-0000-WRITE-PANEL                              CL**1
01316      END-IF.                                                         CL**1
01317 *                                                                    CL**1
01318  EJECT                                                               CL**1
01319 ******************************************************************   CL**1
01320 *    IF THE USER HITS THE SELECT KEY, SET THE SELECTION SWITCH       CL**1
01321 *    FOR ALL ITEMS.                                                  CL**1
01322 *                                                                    CL**1
01323 *    PERFORMED BY D300-CHECK-FUNCTION-KEY.                           CL**1
01324 ******************************************************************   CL**1
01325 *                                                                    CL**1
01326  E900-SELECT-ALL-ITEMS.                                              CL**1
01327 *                                                                    CL**1
01328      IF  MB129-NUMBER-OF-ITEMS-READ > +0                             CL**1
01329          MOVE +1 TO MB129-BLK-SUB                                    CL**1
01330                                                                      CL**1
01331          PERFORM F700-SET-SELECTED-INDS                              CL**1
01332              VARYING MB129-ITEM-SUB FROM 1 BY 1                      CL**1
01333              UNTIL MB129-ITEM-SUB > PC-ITEMS-PER-BLOCK               CL**1
01334                                                                      CL**1
01335          ADD +1 TO MB129-BLK-SUB                                     CL**1
01336                                                                      CL**1
01337          PERFORM F700-SET-SELECTED-INDS                              CL**1
01338              VARYING MB129-ITEM-SUB FROM 1 BY 1                      CL**1
01339              UNTIL MB129-ITEM-SUB > PC-ITEMS-PER-BLOCK               CL**1
01340                                                                      CL**1
01341          MOVE MB129-LIST-ITEM-NUMBER(1 1) TO PV-LIST-ITEM-NUMBER     CL**1
01342                                                                      CL**1
01343          COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                           CL**1
01344              1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-BLOCK)    CL**1
01345                                                                      CL**1
01346          IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                    CL**1
01347             (MB129-HIGHEST-BLOCK-WRITTEN > PC-MAX-BLOCKS-IN-ARRAY)   CL**1
01348              MOVE +1 TO MB129-BLK-SUB                                CL**1
01349                                                                      CL**1
01350              PERFORM Z150-WRITE-TEMP-STORAGE                         CL**1
01351                                                                      CL**1
01352              MOVE +1 TO PV-BLOCK-NUMBER                              CL**1
01353                                                                      CL**1
01354              COMPUTE PV-PREV-BLOCK-IN-ARRAY =                        CL**1
01355                  PV-FIRST-BLOCK-IN-ARRAY - 1                         CL**1
01356                                                                      CL**1
01357              PERFORM                                                 CL**1
01358                  UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY      CL**1
01359                                                                      CL**1
01360                  PERFORM Z100-READ-TEMP-STORAGE                      CL**1
01361                                                                      CL**1
01362                  PERFORM F700-SET-SELECTED-INDS                      CL**1
01363                      VARYING MB129-ITEM-SUB FROM 1 BY 1              CL**1
01364                      UNTIL MB129-ITEM-SUB > PC-ITEMS-PER-BLOCK       CL**1
01365                                                                      CL**1
01366                  PERFORM Z150-WRITE-TEMP-STORAGE                     CL**1
01367                                                                      CL**1
01368                  ADD +1 TO PV-BLOCK-NUMBER                           CL**1
01369                                                                      CL**1
01370              END-PERFORM                                             CL**1
01371                                                                      CL**1
01372              COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                        CL**1
01373                  PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY    CL**1
01374                                                                      CL**1
01375              PERFORM                                                 CL**1
01376                  UNTIL PV-NEXT-BLOCK-IN-ARRAY >                      CL**1
01377                        MB129-HIGHEST-BLOCK-WRITTEN                   CL**1
01378                                                                      CL**1
01379                  MOVE PV-NEXT-BLOCK-IN-ARRAY TO PV-BLOCK-NUMBER      CL**1
01380                                                                      CL**1
01381                  PERFORM Z100-READ-TEMP-STORAGE                      CL**1
01382                                                                      CL**1
01383                  PERFORM F700-SET-SELECTED-INDS                      CL**1
01384                      VARYING MB129-ITEM-SUB FROM 1 BY 1              CL**1
01385                      UNTIL MB129-ITEM-SUB > PC-ITEMS-PER-BLOCK       CL**1
01386                                                                      CL**1
01387                  PERFORM Z150-WRITE-TEMP-STORAGE                     CL**1
01388                                                                      CL**1
01389                  ADD +1 TO PV-NEXT-BLOCK-IN-ARRAY                    CL**1
01390                                                                      CL**1
01391              END-PERFORM                                             CL**1
01392                                                                      CL**1
01393              MOVE PV-FIRST-BLOCK-IN-ARRAY TO PV-BLOCK-NUMBER         CL**1
01394                                                                      CL**1
01395              PERFORM Z100-READ-TEMP-STORAGE                          CL**1
01396          END-IF                                                      CL**1
01397                                                                      CL**1
01398      END-IF.                                                         CL**1
01399                                                                      CL**1
01400      MOVE MB129-NUMBER-OF-ITEMS-READ TO                              CL**1
01401                        MB129-NUMBER-OF-SELECTED-ITEMS.               CL**1
01402                                                                      CL**1
01403      SET PS-SAME-ITEMS-DISPLAYED TO TRUE.                            CL**1
01404                                                                      CL**1
01405      PERFORM G100-DISPLAY-PANEL.                                     CL**1
01406 *                                                                    CL**1
01407  EJECT                                                               CL**1
01408 ******************************************************************   CL**1
01409 *    EDIT THE SELECTION ENTRIES.                                     CL**1
01410 *                                                                    CL**1
01411 *    1) VALID ENTRIES ARE 'S' 'B' OR 'E'.                            CL**1
01412 *    2) THERE CAN ONLY BE 1 BEGINNING AND 1 ENDING RANGE.            CL**1
01413 *                                                                    CL**1
01414 *    PERFORMED BY E100-EDIT-SELECTIONS.                              CL**1
01415 ******************************************************************   CL**1
01416 *                                                                    CL**1
01417  F100-EDIT.                                                          CL**1
01418 *                                                                    CL**1
01419      PERFORM K100-SET-SUBSCRIPTS.                                    CL**1
01420                                                                      CL**1
01421      IF NOT (MB129-NO-SELECT(MB129-BLK-SUB MB129-ITEM-SUB)) AND      CL**1
01422         NOT (MB129-SELECT(MB129-BLK-SUB MB129-ITEM-SUB))             CL**1
01423 *                                                                    CL**1
01424          IF  MB129-BEGIN(MB129-BLK-SUB MB129-ITEM-SUB)               CL**1
01425              IF  MB129-START-OF-SELECTED-RANGE                       CL**1
01426                  NOT EQUAL PV-ITEM-IN-USE                            CL**1
01427 *                                                                    CL**1
01428                  IF  MB129-START-OF-SELECTED-RANGE = +0              CL**1
01429                      MOVE PV-ITEM-IN-USE                             CL**1
01430                                TO  MB129-START-OF-SELECTED-RANGE     CL**1
01431                  ELSE                                                CL**1
01432                      IF PS-VALID-SELECTIONS                          CL**1
01433                          MOVE PC-TSYMSG-00054                        CL**1
01434                                TO  DP020-MSG-NUMBER                  CL**1
01435                          IF  NOT DP020-NEXT-ACT-ERROR                CL**1
01436                              MOVE -1                                 CL**1
01437                                TO  MBKM129-SELECTL(PS-SUB)           CL**2
01438                          END-IF                                      CL**1
01439                      END-IF                                          CL**1
01440 *                                                                    CL**1
01441                      SET DP020-MSG-FATAL                             CL**1
01442                                TO  TRUE                              CL**1
01443                      SET PS-INVALID-SELECTIONS                       CL**1
01444                                TO  TRUE                              CL**1
01445                      SET PS-CURSOR-POSITIONED                        CL**1
01446                                TO  TRUE                              CL**1
01447                  END-IF                                              CL**1
01448              END-IF                                                  CL**1
01449          ELSE                                                        CL**1
01450 *                                                                    CL**1
01451              IF  MB129-END(MB129-BLK-SUB MB129-ITEM-SUB)             CL**1
01452                  IF  MB129-END-OF-SELECTED-RANGE                     CL**1
01453                      NOT EQUAL PV-ITEM-IN-USE                        CL**1
01454 *                                                                    CL**1
01455                      IF MB129-END-OF-SELECTED-RANGE = +0             CL**1
01456                          MOVE PV-ITEM-IN-USE                         CL**1
01457                                TO  MB129-END-OF-SELECTED-RANGE       CL**1
01458                      ELSE                                            CL**1
01459 *                                                                    CL**1
01460                          IF  PS-VALID-SELECTIONS                     CL**1
01461                              MOVE PC-TSYMSG-00055                    CL**1
01462                                TO  DP020-MSG-NUMBER                  CL**6
01463                                                                      CL**1
01464                              IF  NOT DP020-NEXT-ACT-ERROR            CL**1
01465                                  MOVE -1                             CL**1
01466                                     TO  MBKM129-SELECTL(PS-SUB)      CL**2
01467                              END-IF                                  CL**1
01468                          END-IF                                      CL**1
01469                          SET PS-INVALID-SELECTIONS                   CL**1
01470                                     TO  TRUE                         CL**1
01471                          SET PS-CURSOR-POSITIONED                    CL**1
01472                                     TO  TRUE                         CL**1
01473                          SET DP020-MSG-FATAL                         CL**1
01474                                     TO  TRUE                         CL**1
01475                      END-IF                                          CL**1
01476                  END-IF                                              CL**1
01477              ELSE                                                    CL**1
01478 *                                                                    CL**1
01479                  IF  PS-VALID-SELECTIONS                             CL**1
01480                      MOVE PC-TSYMSG-00005                            CL**1
01481                                TO  DP020-MSG-NUMBER                  CL**1
01482                      IF  NOT DP020-NEXT-ACT-ERROR                    CL**1
01483                          MOVE -1                                     CL**1
01484                                TO  MBKM129-SELECTL(PS-SUB)           CL**2
01485                      END-IF                                          CL**1
01486                  END-IF                                              CL**1
01487                  SET PS-INVALID-SELECTIONS                           CL**1
01488                                TO  TRUE                              CL**1
01489                  SET PS-CURSOR-POSITIONED                            CL**1
01490                                TO  TRUE                              CL**1
01491                  SET DP020-MSG-FATAL                                 CL**1
01492                                TO  TRUE                              CL**1
01493                  MOVE DP015-RED                                      CL**1
01494                                TO  MBKM129-SELECTC(PS-SUB)           CL**2
01495                  MOVE DP015-REVERSE                                  CL**1
01496                                TO  MBKM129-SELECTH(PS-SUB)           CL**8
01497              END-IF                                                  CL**1
01498          END-IF                                                      CL**1
01499      END-IF.                                                         CL**1
01500                                                                      CL**1
01501      ADD +1                    TO  PV-ITEM-IN-USE.                   CL**1
01502      ADD +1                    TO  PS-SUB.                           CL**1
01503  EJECT                                                               CL**1
01504 ******************************************************************   CL**1
01505 *    WHENEVER THE USER SELECTS AN ITEM AS THE BEGINNING RANGE        CL**1
01506 *    AND ONE AS THE ENDING RANGE, MARK THESE ITEMS AS WELL AS        CL**1
01507 *    THOSE THAT FALL IN THE RANGE AS BEING SELECTED.                 CL**1
01508 *                                                                    CL**1
01509 *    PERFORMED BY E100-EDIT-SELECTIONS.                              CL**1
01510 ******************************************************************   CL**1
01511 *                                                                    CL**1
01512  F200-MARK-RANGE-AS-SELECTED.                                        CL**1
01513 *                                                                    CL**1
01514      MOVE +1                   TO  MB129-BLK-SUB.                    CL**1
01515      PERFORM G200-MARK-SELECTED-INDS                                 CL**1
01516          VARYING MB129-ITEM-SUB FROM 1 BY 1                          CL**1
01517          UNTIL MB129-ITEM-SUB > PC-ITEMS-PER-BLOCK.                  CL**1
01518 *                                                                    CL**1
01519      ADD +1 TO MB129-BLK-SUB.                                        CL**1
01520      PERFORM G200-MARK-SELECTED-INDS                                 CL**1
01521          VARYING MB129-ITEM-SUB FROM 1 BY 1                          CL**1
01522          UNTIL MB129-ITEM-SUB > PC-ITEMS-PER-BLOCK.                  CL**1
01523 *                                                                    CL**1
01524      MOVE MB129-LIST-ITEM-NUMBER(1 1)                                CL**1
01525                                TO  PV-LIST-ITEM-NUMBER.              CL**1
01526      COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                               CL**1
01527          1 + ((PV-LIST-ITEM-NUMBER - 1) /                            CL**1
01528                PC-ITEMS-PER-BLOCK).                                  CL**1
01529 *                                                                    CL**1
01530      MOVE MB129-START-OF-SELECTED-RANGE                              CL**1
01531                                TO  PV-START-OF-SELECTED-RANGE.       CL**1
01532      COMPUTE PV-FIRST-BLOCK-IN-RANGE =                               CL**1
01533          1 + ((PV-START-OF-SELECTED-RANGE - 1) /                     CL**1
01534                PC-ITEMS-PER-BLOCK).                                  CL**1
01535 *                                                                    CL**1
01536      MOVE MB129-END-OF-SELECTED-RANGE                                CL**1
01537                                TO  PV-END-OF-SELECTED-RANGE.         CL**1
01538      COMPUTE PV-LAST-BLOCK-IN-RANGE =                                CL**1
01539          1 + ((PV-END-OF-SELECTED-RANGE - 1) /                       CL**1
01540                PC-ITEMS-PER-BLOCK).                                  CL**1
01541      COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                                CL**1
01542          PV-FIRST-BLOCK-IN-ARRAY + 1.                                CL**1
01543 *                                                                    CL**1
01544      IF (PV-FIRST-BLOCK-IN-RANGE < PV-FIRST-BLOCK-IN-ARRAY) OR       CL**1
01545         (PV-LAST-BLOCK-IN-RANGE  > PV-NEXT-BLOCK-IN-ARRAY)           CL**1
01546          MOVE +1               TO  MB129-BLK-SUB                     CL**1
01547          PERFORM Z150-WRITE-TEMP-STORAGE                             CL**1
01548          COMPUTE PV-PREV-BLOCK-IN-ARRAY =                            CL**1
01549              PV-FIRST-BLOCK-IN-ARRAY - 1                             CL**1
01550 *                                                                    CL**1
01551          PERFORM                                                     CL**1
01552              UNTIL PV-FIRST-BLOCK-IN-RANGE >                         CL**1
01553                    PV-PREV-BLOCK-IN-ARRAY                            CL**1
01554              MOVE PV-FIRST-BLOCK-IN-RANGE                            CL**1
01555                                TO  PV-BLOCK-NUMBER                   CL**1
01556              PERFORM Z100-READ-TEMP-STORAGE                          CL**1
01557              PERFORM G200-MARK-SELECTED-INDS                         CL**1
01558                  VARYING MB129-ITEM-SUB FROM 1 BY 1                  CL**1
01559                  UNTIL MB129-ITEM-SUB > PC-ITEMS-PER-BLOCK           CL**1
01560              PERFORM Z150-WRITE-TEMP-STORAGE                         CL**1
01561              ADD +1            TO PV-FIRST-BLOCK-IN-RANGE            CL**1
01562          END-PERFORM                                                 CL**1
01563 *                                                                    CL**1
01564          COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                            CL**1
01565              PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY        CL**1
01566          PERFORM                                                     CL**1
01567              UNTIL PV-NEXT-BLOCK-IN-ARRAY >                          CL**1
01568                    PV-LAST-BLOCK-IN-RANGE                            CL**1
01569              MOVE PV-NEXT-BLOCK-IN-ARRAY                             CL**1
01570                                TO  PV-BLOCK-NUMBER                   CL**1
01571              PERFORM Z100-READ-TEMP-STORAGE                          CL**1
01572              PERFORM G200-MARK-SELECTED-INDS                         CL**1
01573                  VARYING MB129-ITEM-SUB FROM 1 BY 1                  CL**1
01574                  UNTIL MB129-ITEM-SUB > PC-ITEMS-PER-BLOCK           CL**1
01575              PERFORM Z150-WRITE-TEMP-STORAGE                         CL**1
01576              ADD +1            TO  PV-NEXT-BLOCK-IN-ARRAY            CL**1
01577          END-PERFORM                                                 CL**1
01578 *                                                                    CL**1
01579          MOVE PV-FIRST-BLOCK-IN-ARRAY                                CL**1
01580                                TO  PV-BLOCK-NUMBER                   CL**1
01581          PERFORM Z100-READ-TEMP-STORAGE                              CL**1
01582      END-IF.                                                         CL**1
01583                                                                      CL**1
01584      MOVE +0                   TO  MB129-START-OF-SELECTED-RANGE     CL**1
01585                                    MB129-END-OF-SELECTED-RANGE.      CL**1
01586  EJECT                                                               CL**1
01587 ******************************************************************   CL**1
01588 *    CHECK EACH ENTRY TO DETERMINE IF THE SELECTION CRITERIA IN      CL**1
01589 *    THE MAP DIFFERS FROM THAT IN THE ARRAY.  IF THEY DO DIFFER,     CL**1
01590 *    AND THE ARRAY ENTRY SHOWS THAT THE ITEM WAS PREVIOUSLY          CL**1
01591 *    SELECTED, SUBTRACT 1 FROM THE SELECTED COUNTER.  IF THEY DO     CL**1
01592 *    DIFFER, AND THE ARRAY ENTRY SHOWS THAT THIS ITEM WAS MARKED     CL**1
01593 *    AS EITHER THE BEGINNING OR ENDING SELECTION POINT, ZERO OUT     CL**1
01594 *    THE STARTING RANGE AND/OR ENDING RANGE.  IF THE ENTRY ON        CL**1
01595 *    THE MAP SHOWS THAT THIS ITEM WAS SELECTED, ADD 1 TO THE         CL**1
01596 *    SELECTED COUNTER.                                               CL**1
01597 *                                                                    CL**1
01598 *    PERFORMED BY E200-MOVE-SELECTS-TO-COMMAREA.                     CL**1
01599 ******************************************************************   CL**1
01600 *                                                                    CL**1
01601  F300-CHECK-SELECTIONS.                                              CL**1
01602 *                                                                    CL**1
01603      IF (PV-ITEM-IN-USE < MB129-NUMBER-OF-ITEMS-READ) OR             CL**1
01604         (PV-ITEM-IN-USE = MB129-NUMBER-OF-ITEMS-READ)                CL**1
01605          PERFORM K100-SET-SUBSCRIPTS                                 CL**1
01606 *                                                                    CL**1
01607          IF  MB129-SELECTED-SW(MB129-BLK-SUB MB129-ITEM-SUB)         CL**1
01608              NOT EQUAL MBKM129-SELECTI(PS-SUB)                       CL**2
01609              SET MB129-BLOCK-MODIFIED(MB129-BLK-SUB)                 CL**1
01610                                TO  TRUE                              CL**1
01611              IF  MB129-SELECT(MB129-BLK-SUB MB129-ITEM-SUB)          CL**1
01612                  SUBTRACT +1 FROM MB129-NUMBER-OF-SELECTED-ITEMS     CL**1
01613              ELSE                                                    CL**1
01614 *                                                                    CL**1
01615                  IF  MB129-BEGIN(MB129-BLK-SUB MB129-ITEM-SUB)       CL**1
01616                      IF  MB129-LIST-ITEM-NUMBER(MB129-BLK-SUB        CL**1
01617                                                MB129-ITEM-SUB) =     CL**1
01618                          MB129-START-OF-SELECTED-RANGE               CL**1
01619                          MOVE +0                                     CL**1
01620                                TO  MB129-START-OF-SELECTED-RANGE     CL**1
01621                      END-IF                                          CL**1
01622                  ELSE                                                CL**1
01623 *                                                                    CL**1
01624                      IF  MB129-END(MB129-BLK-SUB MB129-ITEM-SUB)     CL**1
01625                          IF  MB129-LIST-ITEM-NUMBER                  CL**1
01626                                  (MB129-BLK-SUB MB129-ITEM-SUB)      CL**1
01627                          =  MB129-END-OF-SELECTED-RANGE              CL**1
01628                              MOVE +0                                 CL**1
01629                                TO MB129-END-OF-SELECTED-RANGE        CL**1
01630                          END-IF                                      CL**1
01631                      END-IF                                          CL**1
01632                  END-IF                                              CL**1
01633              END-IF                                                  CL**1
01634 *                                                                    CL**1
01635              IF MBKM129-SELECTI(PS-SUB) = PC-SELECTED                CL**2
01636                  ADD +1        TO MB129-NUMBER-OF-SELECTED-ITEMS     CL**1
01637              END-IF                                                  CL**1
01638 *                                                                    CL**1
01639              IF (MBKM129-SELECTA(PS-SUB) = PC-ERASE-EOF) OR          CL**2
01640                 (MBKM129-SELECTI(PS-SUB) = SPACES)                   CL**2
01641                  MOVE SPACES   TO                                    CL**1
01642                       MB129-SELECTED-SW(MB129-BLK-SUB                CL**1
01643                                         MB129-ITEM-SUB)              CL**1
01644              ELSE                                                    CL**1
01645                  MOVE MBKM129-SELECTI(PS-SUB) TO                     CL**2
01646                       MB129-SELECTED-SW(MB129-BLK-SUB                CL**1
01647                                         MB129-ITEM-SUB)              CL**1
01648              END-IF                                                  CL**1
01649          END-IF                                                      CL**1
01650      END-IF.                                                         CL**1
01651 *                                                                    CL**1
01652      ADD +1                    TO  PV-ITEM-IN-USE.                   CL**1
01653      ADD +1                    TO  PS-SUB.                           CL**1
01654 *                                                                    CL**1
01655  EJECT                                                               CL**1
01656 ******************************************************************   CL**1
01657 *    CALCULATE THE NEW TOP AND BOTTOM ITEM NUMBERS BASED ON WHERE    CL**1
01658 *    THE USER SPECIFIED TO GO ON THE LIST AND DETERMINE WHERE        CL**1
01659 *    THESE ITEMS CAN BE FOUND (I.E. ARRAY, TEMPORARY STORAGE).       CL**1
01660 *                                                                    CL**1
01661 *    PERFORMED BY E400-DISPLAY-TOP-OF-LIST.                          CL**1
01662 *    PERFORMED BY E500-BROWSE-BACKWARD.                              CL**1
01663 *    PERFORMED BY E600-BROWSE-FORWARD.                               CL**1
01664 *    PERFORMED BY E800-CHECK-FOR-JUMP-BROWSE.                        CL**1
01665 ******************************************************************   CL**1
01666 *                                                                    CL**1
01667  F500-BROWSE.                                                        CL**1
01668 *                                                                    CL**1
01669      IF  PV-TOP-ITEM < +1                                            CL**1
01670          MOVE +1               TO  PV-TOP-ITEM                       CL**1
01671          IF  PS-CURSOR-NOT-POSITIONED                                CL**1
01672              MOVE PC-TSYMSG-00069                                    CL**1
01673                                TO  DP020-MSG-NUMBER                  CL**1
01674              SET DP020-MSG-INFORMATIONAL                             CL**1
01675                                TO  TRUE                              CL**1
01676              SET PS-INFORMATIONAL                                    CL**1
01677                                TO  TRUE                              CL**1
01678              SET PS-CURSOR-POSITIONED                                CL**1
01679                                TO  TRUE                              CL**1
01680          END-IF                                                      CL**1
01681      END-IF.                                                         CL**1
01682 *                                                                    CL**1
01683      IF  MB129-NO-ITEMS-LEFT-ON-DB                                   CL**1
01684          IF  PV-TOP-ITEM > MB129-NUMBER-OF-ITEMS-READ                CL**1
01685              IF  DP020-SRC-AID EQUAL DP016-ENTER                     CL*24
01686                  MOVE MB129-NUMBER-OF-ITEMS-READ                     CL*24
01687                                TO  PV-TOP-ITEM                       CL**1
01688              ELSE                                                    CL*24
01689                  MOVE MB129-ITEM-AT-TOP-OF-PANEL                     CL*24
01690                                TO  PV-TOP-ITEM                       CL*24
01691              END-IF                                                  CL*24
01692 *                                                                    CL*24
01693              IF  PS-CURSOR-NOT-POSITIONED                            CL**1
01694                  MOVE -1       TO  ANAVCMDL                          CL**1
01695                  SET DP020-MSG-INFORMATIONAL                         CL**1
01696                                TO  TRUE                              CL**1
01697                  SET PS-CURSOR-POSITIONED                            CL**1
01698                                TO  TRUE                              CL**1
01699                  MOVE PC-TSYMSG-00070                                CL*22
01700                                TO  DP020-MSG-NUMBER                  CL**1
01701                  SET PS-INFORMATIONAL                                CL*22
01702                                TO  TRUE                              CL**1
01703              END-IF                                                  CL**1
01704          END-IF                                                      CL**1
01705      END-IF.                                                         CL**1
01706 *                                                                    CL**1
01707      COMPUTE PV-BOTTOM-ITEM =                                        CL**1
01708          (PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1.                     CL**1
01709                                                                      CL**1
01710      IF  MB129-NO-ITEMS-LEFT-ON-DB                                   CL**1
01711          IF  PV-BOTTOM-ITEM > MB129-NUMBER-OF-ITEMS-READ             CL**1
01712              MOVE MB129-NUMBER-OF-ITEMS-READ                         CL**1
01713                                TO  PV-BOTTOM-ITEM                    CL**1
01714              IF  PS-CURSOR-NOT-POSITIONED                            CL**1
01715                  IF  PV-TOP-ITEM NOT = +1                            CL**1
01716                      MOVE PC-TSYMSG-00070                            CL*22
01717                                TO  DP020-MSG-NUMBER                  CL**1
01718                      SET PS-INFORMATIONAL                            CL*22
01719                                TO  TRUE                              CL**1
01720                      SET DP020-MSG-INFORMATIONAL                     CL*22
01721                                TO  TRUE                              CL**1
01722                      SET PS-CURSOR-POSITIONED                        CL*22
01723                                TO  TRUE                              CL**1
01724                  END-IF                                              CL**1
01725              END-IF                                                  CL**1
01726          END-IF                                                      CL**1
01727      END-IF.                                                         CL**1
01728 *                                                                    CL**1
01729      PERFORM G300-DETERMINE-WHAT-IS-WHERE.                           CL**1
01730                                                                      CL**1
01731      IF  PS-TOP-ITEM-IN-ARRAY                                        CL**1
01732          IF  PS-BOTTOM-ITEM-NOT-IN-ARRAY                             CL**1
01733              IF  PS-BOTTOM-ITEM-IN-TEMP                              CL**1
01734                  PERFORM G500-SCROLL-FORWARD                         CL**1
01735              ELSE                                                    CL**1
01736                  IF  PS-LAST-BLOCK-NOT-IN-ARRAY                      CL**1
01737                      PERFORM G500-SCROLL-FORWARD                     CL**1
01738                  END-IF                                              CL**1
01739                  PERFORM G400-READ-ITEMS-INTO-ARRAY                  CL**1
01740              END-IF                                                  CL**1
01741          END-IF                                                      CL**1
01742      ELSE                                                            CL**1
01743 *                                                                    CL**1
01744          IF  PS-BOTTOM-ITEM-IN-ARRAY                                 CL**1
01745              PERFORM G600-SCROLL-BACKWARD                            CL**1
01746          ELSE                                                        CL**1
01747              IF  PS-TOP-ITEM-IN-TEMP                                 CL**1
01748                  PERFORM G700-GET-TOP-ITEMS-BLOCK                    CL**1
01749                  PERFORM G300-DETERMINE-WHAT-IS-WHERE                CL**1
01750                  IF  PS-BOTTOM-ITEM-NOT-IN-ARRAY                     CL**1
01751                      PERFORM G400-READ-ITEMS-INTO-ARRAY              CL**1
01752                  END-IF                                              CL**1
01753              ELSE                                                    CL**1
01754                  IF  PS-LAST-BLOCK-NOT-IN-ARRAY                      CL**1
01755                      PERFORM G800-GET-LAST-BLOCK-IN-TEMP             CL**1
01756                  END-IF                                              CL**1
01757                  PERFORM G400-READ-ITEMS-INTO-ARRAY                  CL**1
01758              END-IF                                                  CL**1
01759          END-IF                                                      CL**1
01760      END-IF.                                                         CL**1
01761 *                                                                    CL**1
01762      IF  PV-TOP-ITEM = MB129-ITEM-AT-TOP-OF-PANEL                    CL**1
01763          SET PS-SAME-ITEMS-DISPLAYED                                 CL**1
01764                                TO  TRUE                              CL**1
01765      ELSE                                                            CL**1
01766          SET PS-DIFFERENT-ITEMS-DISPLAYED                            CL**1
01767                                TO  TRUE                              CL**1
01768          MOVE PV-TOP-ITEM      TO  MB129-ITEM-AT-TOP-OF-PANEL        CL**1
01769      END-IF.                                                         CL**1
01770 *                                                                    CL**1
01771      PERFORM G100-DISPLAY-PANEL.                                     CL**1
01772 *                                                                    CL**1
01773  EJECT                                                               CL**1
01774 ******************************************************************   CL**1
01775 *    MARK EACH ITEM AS BEING NOT SELECTED.                           CL**1
01776 *                                                                    CL**1
01777 *    PERFORMED BY E700-DESELECT-ALL-ITEMS.                           CL**1
01778 ******************************************************************   CL**1
01779 *                                                                    CL**1
01780  F600-CLEAR-SELECTED-INDS.                                           CL**1
01781 *                                                                    CL**1
01782      IF  MB129-LIST-ITEM-NUMBER(MB129-BLK-SUB MB129-ITEM-SUB)        CL**1
01783              NOT EQUAL ZERO                                          CL**1
01784          IF  NOT MB129-NO-SELECT(MB129-BLK-SUB MB129-ITEM-SUB)       CL**1
01785              SET MB129-NO-SELECT(MB129-BLK-SUB MB129-ITEM-SUB)       CL**1
01786                                TO  TRUE                              CL**1
01787              SET MB129-BLOCK-MODIFIED(MB129-BLK-SUB)                 CL**1
01788                                TO  TRUE                              CL**1
01789          END-IF                                                      CL**1
01790      END-IF.                                                         CL**1
01791 *                                                                    CL**1
01792  EJECT                                                               CL**1
01793 ******************************************************************   CL**1
01794 *    MARK EACH ITEM AS BEING SELECTED.                               CL**1
01795 *                                                                    CL**1
01796 *    PERFORMED BY E900-SELECT-ALL-ITEMS.                             CL**1
01797 ******************************************************************   CL**1
01798 *                                                                    CL**1
01799  F700-SET-SELECTED-INDS.                                             CL**1
01800 *                                                                    CL**1
01801      IF  MB129-LIST-ITEM-NUMBER(MB129-BLK-SUB MB129-ITEM-SUB)        CL**1
01802              NOT EQUAL ZERO                                          CL**1
01803          IF  NOT MB129-SELECT(MB129-BLK-SUB MB129-ITEM-SUB)          CL**1
01804              SET MB129-SELECT(MB129-BLK-SUB MB129-ITEM-SUB)          CL**1
01805                                TO  TRUE                              CL**1
01806              SET MB129-BLOCK-MODIFIED(MB129-BLK-SUB)                 CL**1
01807                                TO  TRUE                              CL**1
01808          END-IF                                                      CL**1
01809      END-IF.                                                         CL**1
01810 *                                                                    CL**1
01811  EJECT                                                               CL**1
01812 ******************************************************************   CL**1
01813 *    FILL THE MAP WITH THE NECESSARY DATA AND WRITE IT OUT.          CL**1
01814 *                                                                    CL**1
01815 *    PERFORMED BY B100-CONTROL-PROCESSING.                           CL**1
01816 *    PERFORMED BY C300-PROCESS-PANEL.                                CL**1
01817 *    PERFORMED BY C400-REFRESH-PANEL-FROM-TEMP.                      CL**1
01818 *    PERFORMED BY D100-SETUP-INIT-PANEL.                             CL**1
01819 *    PERFORMED BY E400-DISPLAY-TOP-OF-LIST.                          CL**1
01820 *    PERFORMED BY E500-BROWSE-BACKWARD.                              CL**1
01821 *    PERFORMED BY E600-BROWSE-FORWARD.                               CL**1
01822 *    PERFORMED BY E700-DESELECT-ALL-ITEMS.                           CL**1
01823 *    PERFORMED BY E800-CHECK-FOR-JUMP-BROWSE.                        CL**1
01824 *    PERFORMED BY F500-BROWSE.                                       CL**1
01825 ******************************************************************   CL**1
01826 *                                                                    CL**1
01827  G100-DISPLAY-PANEL.                                                 CL**1
01828 *                                                                    CL**1
01829      PERFORM DP017-0000-GET-CURR-DATE-TIME.                          CL**1
01830      MOVE DP017-EDITED-TIME-HMS                                      CL**6
01831                                TO  ATIMEO.                           CL**6
01832                                                                      CL**1
01833      IF PS-SEND-MAP-N-DATA-FRSET                                     CL**1
01834          PERFORM DP002-0000-FORMAT-TITLE-LINES                       CL**1
01835          PERFORM DP009-0000-LOAD-FK-LINES                            CL**1
01836      END-IF.                                                         CL**1
01837                                                                      CL**1
01838      PERFORM H200-FORMAT-PANEL-BODY.                                 CL**1
01839 *                                                                    CL**1
01840      PERFORM DP005-0000-FORMAT-MSG-LINES.                            CL**1
01841                                                                      CL**1
01842      PERFORM DP008-0000-WRITE-PANEL.                                 CL**1
01843  EJECT                                                               CL**1
01844 ******************************************************************   CL**1
01845 *    MARK EACH ITEM THAT FALLS WITHIN THE BEGINNING AND ENDING       CL**1
01846 *    RANGE AS BEING SELECTED.                                        CL**1
01847 *                                                                    CL**1
01848 *    PERFORMED BY F200-MARK-RANGE-AS-SELECTED.                       CL**1
01849 ******************************************************************   CL**1
01850 *                                                                    CL**1
01851  G200-MARK-SELECTED-INDS.                                            CL**1
01852 *                                                                    CL**1
01853      IF (MB129-LIST-ITEM-NUMBER(MB129-BLK-SUB                        CL**1
01854                                 MB129-ITEM-SUB) >                    CL**1
01855          MB129-START-OF-SELECTED-RANGE)                              CL**1
01856      OR (MB129-LIST-ITEM-NUMBER(MB129-BLK-SUB                        CL**1
01857                                 MB129-ITEM-SUB) =                    CL**1
01858          MB129-START-OF-SELECTED-RANGE)                              CL**1
01859 *                                                                    CL**1
01860          IF (MB129-LIST-ITEM-NUMBER(MB129-BLK-SUB                    CL**1
01861                                     MB129-ITEM-SUB) <                CL**1
01862              MB129-END-OF-SELECTED-RANGE)                            CL**1
01863          OR (MB129-LIST-ITEM-NUMBER(MB129-BLK-SUB                    CL**1
01864                                     MB129-ITEM-SUB) =                CL**1
01865              MB129-END-OF-SELECTED-RANGE)                            CL**1
01866 *                                                                    CL**1
01867              IF NOT MB129-SELECT(MB129-BLK-SUB MB129-ITEM-SUB)       CL**1
01868                  SET MB129-SELECT(MB129-BLK-SUB                      CL**1
01869                                   MB129-ITEM-SUB)                    CL**1
01870                                TO  TRUE                              CL**1
01871                  SET MB129-BLOCK-MODIFIED(MB129-BLK-SUB)             CL**1
01872                                TO  TRUE                              CL**1
01873                  ADD +1        TO MB129-NUMBER-OF-SELECTED-ITEMS     CL**1
01874              END-IF                                                  CL**1
01875          END-IF                                                      CL**1
01876      END-IF.                                                         CL**1
01877  EJECT                                                               CL**1
01878 ******************************************************************   CL**1
01879 *    DETERMINE WHETHER THE TOP ITEM AND BOTTOM ITEM CAN BE FOUND     CL**1
01880 *    IN THE ARRAY, IN TEMPORARY STORAGE, OR NEITHER.                 CL**1
01881 *                                                                    CL**1
01882 *    PERFORMED BY F500-BROWSE.                                       CL**1
01883 ******************************************************************   CL**1
01884 *                                                                    CL**1
01885  G300-DETERMINE-WHAT-IS-WHERE.                                       CL**1
01886 *                                                                    CL**1
01887      MOVE MB129-LIST-ITEM-NUMBER(1 1)                                CL**1
01888                                TO  PV-FIRST-ITEM-IN-ARRAY.           CL**1
01889      COMPUTE PV-LAST-ITEM-IN-ARRAY =                                 CL**1
01890          (PV-FIRST-ITEM-IN-ARRAY +                                   CL**1
01891          (PC-MAX-BLOCKS-IN-ARRAY * PC-ITEMS-PER-BLOCK)) - 1.         CL**1
01892      IF  PV-LAST-ITEM-IN-ARRAY > MB129-NUMBER-OF-ITEMS-READ          CL**1
01893          MOVE MB129-NUMBER-OF-ITEMS-READ                             CL**1
01894                                TO  PV-LAST-ITEM-IN-ARRAY             CL**1
01895      END-IF.                                                         CL**1
01896 *                                                                    CL**1
01897      COMPUTE PV-LAST-ITEM-IN-TEMP =                                  CL**1
01898          MB129-HIGHEST-BLOCK-WRITTEN * PC-ITEMS-PER-BLOCK.           CL**1
01899      IF  PV-LAST-ITEM-IN-TEMP > MB129-NUMBER-OF-ITEMS-READ           CL**1
01900          MOVE MB129-NUMBER-OF-ITEMS-READ                             CL**1
01901                                TO  PV-LAST-ITEM-IN-TEMP              CL**1
01902      END-IF.                                                         CL**1
01903 *                                                                    CL**1
01904      IF (PV-TOP-ITEM > PV-FIRST-ITEM-IN-ARRAY)                       CL**1
01905      OR (PV-TOP-ITEM = PV-FIRST-ITEM-IN-ARRAY)                       CL**1
01906          IF (PV-TOP-ITEM < PV-LAST-ITEM-IN-ARRAY)                    CL**1
01907          OR (PV-TOP-ITEM = PV-LAST-ITEM-IN-ARRAY)                    CL**1
01908              SET PS-TOP-ITEM-IN-ARRAY                                CL**1
01909                                TO  TRUE                              CL**1
01910          ELSE                                                        CL**1
01911              SET PS-TOP-ITEM-NOT-IN-ARRAY                            CL**1
01912                                TO  TRUE                              CL**1
01913          END-IF                                                      CL**1
01914      ELSE                                                            CL**1
01915          SET PS-TOP-ITEM-NOT-IN-ARRAY                                CL**1
01916                                TO  TRUE                              CL**1
01917      END-IF.                                                         CL**1
01918 *                                                                    CL**1
01919      IF (PV-BOTTOM-ITEM > PV-FIRST-ITEM-IN-ARRAY)                    CL**1
01920      OR (PV-BOTTOM-ITEM = PV-FIRST-ITEM-IN-ARRAY)                    CL**1
01921          IF (PV-BOTTOM-ITEM < PV-LAST-ITEM-IN-ARRAY)                 CL**1
01922          OR (PV-BOTTOM-ITEM = PV-LAST-ITEM-IN-ARRAY)                 CL**1
01923              SET PS-BOTTOM-ITEM-IN-ARRAY                             CL**1
01924                                TO  TRUE                              CL**1
01925          ELSE                                                        CL**1
01926              SET PS-BOTTOM-ITEM-NOT-IN-ARRAY                         CL**1
01927                                TO  TRUE                              CL**1
01928          END-IF                                                      CL**1
01929      ELSE                                                            CL**1
01930          SET PS-BOTTOM-ITEM-NOT-IN-ARRAY                             CL**1
01931                                TO  TRUE                              CL**1
01932      END-IF.                                                         CL**1
01933 *                                                                    CL**1
01934      IF (PV-TOP-ITEM < PV-LAST-ITEM-IN-TEMP)                         CL**1
01935      OR (PV-TOP-ITEM = PV-LAST-ITEM-IN-TEMP)                         CL**1
01936          SET PS-TOP-ITEM-IN-TEMP                                     CL**1
01937                                TO  TRUE                              CL**1
01938      ELSE                                                            CL**1
01939          SET PS-TOP-ITEM-NOT-IN-TEMP                                 CL**1
01940                                TO  TRUE                              CL**1
01941      END-IF.                                                         CL**1
01942 *                                                                    CL**1
01943      IF (PV-BOTTOM-ITEM < PV-LAST-ITEM-IN-TEMP)                      CL**1
01944      OR (PV-BOTTOM-ITEM = PV-LAST-ITEM-IN-TEMP)                      CL**1
01945          SET PS-BOTTOM-ITEM-IN-TEMP                                  CL**1
01946                                TO  TRUE                              CL**1
01947      ELSE                                                            CL**1
01948          SET PS-BOTTOM-ITEM-NOT-IN-TEMP                              CL**1
01949                                TO  TRUE                              CL**1
01950      END-IF.                                                         CL**1
01951 *                                                                    CL**1
01952      IF PV-LAST-ITEM-IN-TEMP > PV-LAST-ITEM-IN-ARRAY                 CL**1
01953          SET PS-LAST-BLOCK-NOT-IN-ARRAY                              CL**1
01954                                TO  TRUE                              CL**1
01955      ELSE                                                            CL**1
01956          SET PS-LAST-BLOCK-IN-ARRAY                                  CL**1
01957                                TO  TRUE                              CL**1
01958      END-IF.                                                         CL**1
01959 *                                                                    CL**1
01960  EJECT                                                               CL**1
01961 ******************************************************************   CL**1
01962 *    DETERMINE THE SPOT IN THE ARRAY WHERE THE LAST ITEM FROM        CL**1
01963 *    THE DATA BASE WAS ADDED SO WE KNOW WHERE TO ADD THE NEW         CL**1
01964 *    ITEMS.  USE THE SAVED UPC KEY TO START THE BROWSE.  H600        CL**1
01965 *    MUST BE PERFORMED TO POSITION TO THE FIRST UPC TO PROCESS.      CL**1
01966 *                                                                    CL**1
01967 *    PERFORMED BY F500-BROWSE.                                       CL**1
01968 ******************************************************************   CL**1
01969 *                                                                    CL**1
01970  G400-READ-ITEMS-INTO-ARRAY.                                         CL**1
01971 *                                                                    CL**1
01972      COMPUTE PS-ITEM-SUB =                                           CL**1
01973          (MB129-NUMBER-OF-ITEMS-READ -                               CL**1
01974           MB129-LIST-ITEM-NUMBER(1 1)) + 1.                          CL**1
01975                                                                      CL**1
01976      MOVE PS-ITEM-SUB TO MB129-ITEM-SUB.                             CL**1
01977                                                                      CL**1
01978      IF  MB129-ITEM-SUB > PC-ITEMS-PER-BLOCK                         CL**1
01979          SUBTRACT PC-ITEMS-PER-BLOCK                                 CL**1
01980                              FROM  MB129-ITEM-SUB                    CL**1
01981          MOVE PC-MAX-BLOCKS-IN-ARRAY                                 CL**1
01982                                TO  MB129-BLK-SUB                     CL**1
01983      ELSE                                                            CL**1
01984          MOVE +1               TO  MB129-BLK-SUB                     CL**1
01985      END-IF.                                                         CL**1
01986 *                                                                    CL**1
01987      MOVE PV-BOTTOM-ITEM       TO  PV-HIGHEST-ITEM-TO-BE-READ.       CL**1
01988 *                                                                    CL**1
01989      PERFORM L100-OPEN-CURSOR.                                       CL**1
01990      PERFORM H100-READ-ITEMS-FROM-DB.                                CL**1
01991      IF  PV-ITEMS-READ EQUAL ZERO                                    CL**6
01992          MOVE MB129-ITEM-AT-TOP-OF-PANEL                             CL**6
01993                                TO  PV-TOP-ITEM                       CL**6
01994      END-IF.                                                         CL**6
01995 *                                                                    CL**1
01996      IF  MB129-NO-ITEMS-LEFT-ON-DB                                   CL**1
01997          IF  PV-TOP-ITEM > MB129-NUMBER-OF-ITEMS-READ                CL**1
01998              MOVE MB129-NUMBER-OF-ITEMS-READ                         CL**1
01999                                TO  PV-TOP-ITEM                       CL**1
02000          END-IF                                                      CL**1
02001          MOVE PC-TSYMSG-00070  TO  DP020-MSG-NUMBER                  CL*22
02002          SET DP020-MSG-INFORMATIONAL                                 CL*22
02003                                TO  TRUE                              CL**1
02004          SET PS-INFORMATIONAL  TO  TRUE                              CL*22
02005      END-IF.                                                         CL**1
02006 *                                                                    CL**1
02007  EJECT                                                               CL**1
02008 ******************************************************************   CL**1
02009 *    IF THE TOP ITEM WE NEED IS IN THE ARRAY, BUT THE BOTTOM         CL**1
02010 *    ITEM WE NEED IS IN TEMPORARY STORAGE OR HAS NOT BEEN READ       CL**1
02011 *    YET, WRITE OUT THE 1ST BLOCK IN THE ARRAY TO TEMPORARY          CL**1
02012 *    STORAGE.  MOVE THE 2ND BLOCK IN THE ARRAY TO THE 1ST BLOCK      CL**1
02013 *    AND READ THE BLOCK NEEDED INTO THE 2ND BLOCK OF THE ARRAY.      CL**1
02014 *    THE TOP ITEM WILL BE LOCATED IN THE 1ST BLOCK, AND THE          CL**1
02015 *    BOTTOM ITEM WILL EITHER BE LOCATED IN THE 2ND BLOCK OR          CL**1
02016 *    WILL BE PLACED IN THE 2ND BLOCK.                                CL**1
02017 *                                                                    CL**1
02018 *    PERFORMED BY F500-BROWSE.                                       CL**1
02019 ******************************************************************   CL**1
02020 *                                                                    CL**1
02021  G500-SCROLL-FORWARD.                                                CL**1
02022 *                                                                    CL**1
02023      MOVE +1                   TO  MB129-BLK-SUB.                    CL**1
02024      SET MB129-BLOCK-MODIFIED (1)                                    CL**1
02025                                TO  TRUE.                             CL**1
02026      PERFORM Z150-WRITE-TEMP-STORAGE.                                CL**1
02027 *                                                                    CL**1
02028      MOVE MB129-BLOCK-ENTRIES(PC-MAX-BLOCKS-IN-ARRAY) TO             CL**1
02029           MB129-BLOCK-ENTRIES(MB129-BLK-SUB).                        CL**1
02030 *                                                                    CL**1
02031      COMPUTE PV-TEMP-BLOCK-NUMBER =                                  CL**1
02032          1 + ((PV-BOTTOM-ITEM - 1) / PC-ITEMS-PER-BLOCK).            CL**1
02033 *                                                                    CL**1
02034      MOVE PV-TEMP-BLOCK-NUMBER TO  PV-BLOCK-NUMBER.                  CL**1
02035      ADD +1                    TO  MB129-BLK-SUB.                    CL**1
02036      PERFORM Z100-READ-TEMP-STORAGE.                                 CL**1
02037 *                                                                    CL**1
02038  EJECT                                                               CL**1
02039 ******************************************************************   CL**1
02040 *    IF TOP ITEM WE NEED IS NOT IN THE ARRAY, BUT THE BOTTOM         CL**1
02041 *    ITEM IS, WRITE BOTH BLOCKS TO TEMPORARY STORAGE.  MOVE          CL**1
02042 *    THE 1ST BLOCK IN THE ARRAY TO THE 2ND BLOCK OF THE ARRAY.       CL**1
02043 *    READ THE BLOCK THAT CONTAINS THE TOP ITEM INTO THE 1ST BLOCK    CL**1
02044 *    OF THE ARRAY.                                                   CL**1
02045 *                                                                    CL**1
02046 *    PERFORMED BY F500-BROWSE.                                       CL**1
02047 ******************************************************************   CL**1
02048 *                                                                    CL**1
02049  G600-SCROLL-BACKWARD.                                               CL**1
02050 *                                                                    CL**1
02051      MOVE +1                   TO  MB129-BLK-SUB.                    CL**1
02052      SET MB129-BLOCK-MODIFIED (1)                                    CL**1
02053                                TO  TRUE.                             CL**1
02054      PERFORM Z150-WRITE-TEMP-STORAGE.                                CL**1
02055 *                                                                    CL**1
02056      ADD +1 TO MB129-BLK-SUB.                                        CL**1
02057      SET MB129-BLOCK-MODIFIED (2)                                    CL**1
02058                                TO  TRUE.                             CL**1
02059      PERFORM Z150-WRITE-TEMP-STORAGE.                                CL**1
02060                                                                      CL**1
02061      MOVE +1                   TO  MB129-BLK-SUB.                    CL**1
02062      MOVE MB129-BLOCK-ENTRIES(MB129-BLK-SUB) TO                      CL**1
02063           MB129-BLOCK-ENTRIES(PC-MAX-BLOCKS-IN-ARRAY).               CL**1
02064 *                                                                    CL**1
02065      COMPUTE PV-TEMP-BLOCK-NUMBER =                                  CL**1
02066          1 + ((PV-TOP-ITEM - 1) / PC-ITEMS-PER-BLOCK).               CL**1
02067 *                                                                    CL**1
02068      MOVE PV-TEMP-BLOCK-NUMBER TO PV-BLOCK-NUMBER.                   CL**1
02069      PERFORM Z100-READ-TEMP-STORAGE.                                 CL**1
02070 *                                                                    CL**1
02071  EJECT                                                               CL**1
02072 ******************************************************************   CL**1
02073 *    IF BOTH THE TOP AND BOTTOM ITEMS WE NEED ARE NOT IN THE         CL**1
02074 *    ARRAY, BUT THE TOP ITEM IS IN TEMPORARY STORAGE, WRITE BOTH     CL**1
02075 *    BLOCKS IN THE ARRAY TO TEMPORARY STORAGE.  READ THE BLOCK       CL**1
02076 *    THAT CONTAINS THE TOP ITEM INTO THE 1ST BLOCK OF THE ARRAY.     CL**1
02077 *    IF THERE IS ANOTHER BLOCK IN TEMPORARY STORAGE FOLLOWING        CL**1
02078 *    THE ONE JUST READ, READ THAT ONE INTO THE 2ND BLOCK OF THE      CL**1
02079 *    ARRAY, OTHERWISE INITIALIZE THE 2ND BLOCK OF THE ARRAY.         CL**1
02080 *                                                                    CL**1
02081 *    PERFORMED BY F500-BROWSE.                                       CL**1
02082 ******************************************************************   CL**1
02083 *                                                                    CL**1
02084  G700-GET-TOP-ITEMS-BLOCK.                                           CL**1
02085 *                                                                    CL**1
02086      SET MB129-BLOCK-MODIFIED (1)                                    CL**1
02087                                TO  TRUE.                             CL**1
02088      MOVE +1                   TO  MB129-BLK-SUB.                    CL**1
02089      PERFORM Z150-WRITE-TEMP-STORAGE.                                CL**1
02090 *                                                                    CL**1
02091      SET MB129-BLOCK-MODIFIED (2)                                    CL**1
02092                                TO  TRUE.                             CL**1
02093      ADD +1                    TO  MB129-BLK-SUB.                    CL**1
02094      PERFORM Z150-WRITE-TEMP-STORAGE.                                CL**1
02095 *                                                                    CL**1
02096      COMPUTE PV-TEMP-BLOCK-NUMBER =                                  CL**1
02097          1 + ((PV-TOP-ITEM - 1) / PC-ITEMS-PER-BLOCK).               CL**1
02098 *                                                                    CL**1
02099      MOVE PV-TEMP-BLOCK-NUMBER TO  PV-BLOCK-NUMBER.                  CL**1
02100      MOVE +1                   TO  MB129-BLK-SUB.                    CL**1
02101 *                                                                    CL**1
02102      PERFORM Z100-READ-TEMP-STORAGE.                                 CL**1
02103                                                                      CL**1
02104      ADD +1                    TO  PV-BLOCK-NUMBER.                  CL**1
02105      ADD +1                    TO  MB129-BLK-SUB.                    CL**1
02106 *                                                                    CL**1
02107      IF (PV-BLOCK-NUMBER < MB129-HIGHEST-BLOCK-WRITTEN) OR           CL**1
02108         (PV-BLOCK-NUMBER = MB129-HIGHEST-BLOCK-WRITTEN)              CL**1
02109          PERFORM Z100-READ-TEMP-STORAGE                              CL**1
02110      ELSE                                                            CL**1
02111          PERFORM I100-INITIALIZE-BLOCK                               CL**1
02112      END-IF.                                                         CL**1
02113 *                                                                    CL**1
02114  EJECT                                                               CL**1
02115 ******************************************************************   CL**1
02116 *    IF BOTH THE TOP AND BOTTOM ITEMS WE NEED ARE NOT IN THE         CL**1
02117 *    ARRAY AND BOTH ITEMS ARE NOT IN TEMPORARY STORAGE (THE          CL**1
02118 *    ITEMS HAVE NOT BEEN READ FROM THE DATA BASE YET), AND THE       CL**1
02119 *    LAST ITEM READ FROM THE DATA BASE IS IN TEMPORARY STORAGE,      CL**1
02120 *    WRITE BOTH BLOCKS IN THE ARRAY TO TEMPORARY STORAGE.  READ      CL**1
02121 *    THE HIGHEST BLOCK IN TEMPORARY STORAGE INTO THE 1ST BLOCK       CL**1
02122 *    OF THE ARRAY, AND INITIALIZE THE 2ND BLOCK IN THE ARRAY.        CL**1
02123 *    THE 2ND BLOCK WILL BE USED FOR THE NEW ITEMS TO BE READ.        CL**1
02124 *    THE 1ST BLOCK WILL NOW CONTAIN THE ITEMS THAT WERE LAST         CL**1
02125 *    READ FROM THE DATA BASE.                                        CL**1
02126 *                                                                    CL**1
02127 *    PERFORMED BY F500-BROWSE.                                       CL**1
02128 ******************************************************************   CL**1
02129 *                                                                    CL**1
02130  G800-GET-LAST-BLOCK-IN-TEMP.                                        CL**1
02131 *                                                                    CL**1
02132      SET MB129-BLOCK-MODIFIED (1)                                    CL**1
02133                                TO  TRUE.                             CL**1
02134      MOVE +1                   TO  MB129-BLK-SUB.                    CL**1
02135      PERFORM Z150-WRITE-TEMP-STORAGE.                                CL**1
02136      SET MB129-BLOCK-MODIFIED (2)                                    CL**1
02137                                TO  TRUE.                             CL**1
02138      ADD +1                    TO  MB129-BLK-SUB.                    CL**1
02139      PERFORM Z150-WRITE-TEMP-STORAGE.                                CL**1
02140 *                                                                    CL**1
02141      MOVE MB129-HIGHEST-BLOCK-WRITTEN                                CL**1
02142                                TO  PV-BLOCK-NUMBER.                  CL**1
02143      MOVE +1                   TO  MB129-BLK-SUB.                    CL**1
02144      PERFORM Z100-READ-TEMP-STORAGE.                                 CL**1
02145 *                                                                    CL**1
02146      ADD +1                    TO  MB129-BLK-SUB.                    CL**1
02147      PERFORM I100-INITIALIZE-BLOCK.                                  CL**1
02148 *                                                                    CL**1
02149  EJECT                                                               CL**1
02150 ******************************************************************   CL**1
02151 *    READ THE ITEMS FROM THE DATA BASE AND MOVE THEM INTO THE        CL**1
02152 *    BLOCKS IN THE ARRAY.  WHENEVER BOTH BLOCKS BECOME FULL,         CL**1
02153 *    WRITE OUT THE 1ST BLOCK TO TEMPORARY STORAGE, MOVE THE 2ND      CL**1
02154 *    BLOCK IN THE ARRAY TO THE 1ST BLOCK, AND INITIALIZE THE         CL**1
02155 *    2ND BLOCK MAKING IT AVAILABLE TO BE USED.                       CL**1
02156 *                                                                    CL**1
02157 *    PERFORMED BY D100-SETUP-INIT-PANEL.                             CL**1
02158 *    PERFORMED BY G400-READ-ITEMS-INTO-ARRAY.                        CL**1
02159 ******************************************************************   CL**1
02160 *                                                                    CL**1
02161  H100-READ-ITEMS-FROM-DB.                                            CL**1
02162 *                                                                    CL**1
02163      PERFORM                                                         CL**1
02164          UNTIL (MB129-NO-ITEMS-LEFT-ON-DB)   OR                      CL**1
02165                (MB129-NUMBER-OF-ITEMS-READ =                         CL**1
02166                 PV-HIGHEST-ITEM-TO-BE-READ)                          CL**1
02167 *                                                                    CL**1
02168          IF MB129-ITEM-SUB < PC-ITEMS-PER-BLOCK                      CL**1
02169              ADD +1            TO  MB129-ITEM-SUB                    CL**1
02170          ELSE                                                        CL**1
02171              ADD +1            TO  MB129-BLK-SUB                     CL**1
02172              MOVE +1           TO  MB129-ITEM-SUB                    CL**1
02173 *                                                                    CL**1
02174              IF MB129-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY               CL**1
02175                  MOVE +1       TO  MB129-BLK-SUB                     CL**1
02176                  SET MB129-BLOCK-MODIFIED (1)                        CL**1
02177                                TO  TRUE                              CL**1
02178                  PERFORM Z150-WRITE-TEMP-STORAGE                     CL**1
02179                  MOVE MB129-BLOCK-ENTRIES(PC-MAX-BLOCKS-IN-ARRAY)    CL**1
02180                  TO   MB129-BLOCK-ENTRIES(MB129-BLK-SUB)             CL**1
02181                  ADD +1        TO  MB129-BLK-SUB                     CL**1
02182                  PERFORM I100-INITIALIZE-BLOCK                       CL**1
02183              END-IF                                                  CL**1
02184          END-IF                                                      CL**1
02185 *                                                                    CL**1
02186          PERFORM L200-FETCH                                          CL**1
02187          IF  MB129-ITEMS-LEFT-ON-DB                                  CL**1
02188              SET MB129-BLOCK-MODIFIED (MB129-BLK-SUB)                CL*19
02189                                TO  TRUE                              CL*19
02190              ADD 1             TO  MB129-NUMBER-OF-ITEMS-READ        CL**1
02191                                    PV-ITEMS-READ                     CL**6
02192              MOVE MB129-NUMBER-OF-ITEMS-READ                         CL**1
02193                                TO  MB129-LIST-ITEM-NUMBER            CL**1
02194                                        (MB129-BLK-SUB                CL**1
02195                                         MB129-ITEM-SUB)              CL**1
02196              MOVE RSPLVL-CDE   TO  MB129-RLEVEL                      CL**1
02197                                        (MB129-BLK-SUB                CL**1
02198                                         MB129-ITEM-SUB)              CL**1
02199              MOVE RSPLVL-DESC  TO  MB129-DESC                        CL**1
02200                                        (MB129-BLK-SUB                CL**1
02201                                         MB129-ITEM-SUB)              CL**1
02202          END-IF                                                      CL**1
02203      END-PERFORM.                                                    CL**1
02204 *                                                                    CL**1
02205      MOVE RSPLVL-CDE           TO  MB129-LAST-RLEVEL.                CL**1
02206 *                                                                    CL**1
02207  EJECT                                                               CL**1
02208 *                                                                    CL**1
02209 ******************************************************************   CL**1
02210 *    FORMAT THE MAP AND DETERMINE THE CURSOR POSITION.               CL**1
02211 *                                                                    CL**1
02212 *    PERFORMED BY G100-DISPLAY-PANEL.                                CL**1
02213 ******************************************************************   CL**1
02214 *                                                                    CL**1
02215  H200-FORMAT-PANEL-BODY.                                             CL**1
02216 *                                                                    CL**1
02217      PERFORM I700-FORMAT-FROM-TO-LINE.                               CL**1
02218      PERFORM I200-FORMAT-LIST-LINES.                                 CL**1
02219      PERFORM I300-FORMAT-NR-SELECTED.                                CL**1
02220                                                                      CL**1
02221      IF NOT DP020-NEXT-ACT-ERROR                                     CL**1
02222          PERFORM I800-SET-CURSOR-POSITION                            CL**1
02223      END-IF.                                                         CL**1
02224 *                                                                    CL**1
02225  EJECT                                                               CL**1
02226 ******************************************************************   CL**1
02227 *    INITIALIZE A BLOCK IN THE ARRAY.                                CL**1
02228 *                                                                    CL**1
02229 *    PERFORMED BY D100-SETUP-INIT-PANEL.                             CL**1
02230 *    PERFORMED BY G700-GET-TOP-ITEMS-BLOCK.                          CL**1
02231 *    PERFORMED BY G800-GET-LAST-BLOCK-IN-TEMP.                       CL**1
02232 *    PERFORMED BY H100-READ-ITEMS-FROM-DB.                           CL**1
02233 ******************************************************************   CL**1
02234 *                                                                    CL**1
02235  I100-INITIALIZE-BLOCK.                                              CL**1
02236 *                                                                    CL**1
02237      INITIALIZE  MB129-BLOCK-ENTRIES (MB129-BLK-SUB).                CL**1
02238      SET MB129-BLOCK-NOT-MODIFIED(MB129-BLK-SUB) TO TRUE.            CL**1
02239  EJECT                                                               CL**1
02240 ******************************************************************   CL**1
02241 *    PROCESS THE ITEMS IN THE ARRAY AND MOVE THEM TO THE MAP.        CL**1
02242 *                                                                    CL**1
02243 *    PERFORMED BY E800-CHECK-FOR-JUMP-BROWSE.                        CL**1
02244 *    PERFORMED BY H200-FORMAT-PANEL-BODY.                            CL**1
02245 ******************************************************************   CL**1
02246 *                                                                    CL**1
02247  I200-FORMAT-LIST-LINES.                                             CL**1
02248 *                                                                    CL**1
02249      COMPUTE PV-ENDING-ITEM-ON-PANEL =                               CL**1
02250          (MB129-ITEM-AT-TOP-OF-PANEL + PC-ITEMS-PER-PANEL) - 1.      CL**1
02251 *                                                                    CL**1
02252      MOVE MB129-ITEM-AT-TOP-OF-PANEL                                 CL**1
02253                                TO  PV-ITEM-IN-USE.                   CL**1
02254      MOVE +1                   TO  PS-SUB.                           CL**1
02255 *                                                                    CL**1
02256      PERFORM J100-PROCESS-ITEMS                                      CL**1
02257          UNTIL PV-ITEM-IN-USE > PV-ENDING-ITEM-ON-PANEL.             CL**1
02258 *                                                                    CL**1
02259  EJECT                                                               CL**1
02260 ******************************************************************   CL**1
02261 *    FORMAT THE FIELD WHICH WILL SHOW THE NUMBER OF ITEMS THAT       CL**1
02262 *    WERE SELECTED BY THE USER.                                      CL**1
02263 *                                                                    CL**1
02264 *    PERFORMED BY E800-CHECK-FOR-JUMP-BROWSE.                        CL**1
02265 *    PERFORMED BY H200-FORMAT-PANEL-BODY.                            CL**1
02266 ******************************************************************   CL**1
02267 *                                                                    CL**1
02268  I300-FORMAT-NR-SELECTED.                                            CL**1
02269 *                                                                    CL**1
02270      MOVE MB129-NUMBER-OF-SELECTED-ITEMS                             CL**1
02271                                TO  PV-DISPLAY5.                      CL**1
02272      MOVE PV-DISPLAY5          TO  TOTSELO.                          CL**1
02273  EJECT                                                               CL**1
02274 ******************************************************************   CL**1
02275 *    FORMAT THE LINE THAT WILL SHOW THE TOTAL NUMBER OF ITEMS WE     CL**1
02276 *    HAVE ON OUR LIST AND SHOW THE NUMBERS ASSOCIATED WITH THE       CL**1
02277 *    FIRST AND LAST ITEMS ON CURRENT PAGE.  THIS WILL HELP THE       CL**1
02278 *    USER DETERMINE HOW FAR THEY ARE INTO THE LIST.                  CL**1
02279 *                                                                    CL**1
02280 *    PERFORMED BY H200-FORMAT-PANEL-BODY.                            CL**1
02281 ******************************************************************   CL**1
02282 *                                                                    CL**1
02283  I700-FORMAT-FROM-TO-LINE.                                           CL**1
02284 *                                                                    CL**1
02285      MOVE MB129-ITEM-AT-TOP-OF-PANEL                                 CL**1
02286                                TO  PV-DISPLAY5.                      CL**1
02287      MOVE PV-DISPLAY5          TO  ABEGITMO.                         CL**5
02288 *                                                                    CL**1
02289      MOVE DP015-GREEN          TO  ABEGITMC.                         CL**5
02290      MOVE DP015-UNDERLINE      TO  ABEGITMH.                         CL**5
02291      MOVE DP015-UNP-NUM-BRT-MDT                                      CL**1
02292                                TO  ABEGITMA.                         CL**5
02293 *                                                                    CL**1
02294      COMPUTE PV-ENDING-ITEM-ON-PANEL =                               CL**1
02295          (MB129-ITEM-AT-TOP-OF-PANEL + PC-ITEMS-PER-PANEL) - 1.      CL**1
02296 *                                                                    CL**1
02297      IF PV-ENDING-ITEM-ON-PANEL < MB129-NUMBER-OF-ITEMS-READ         CL**1
02298          MOVE PV-ENDING-ITEM-ON-PANEL                                CL**1
02299                                TO  PV-DISPLAY5                       CL**1
02300      ELSE                                                            CL**1
02301          MOVE MB129-NUMBER-OF-ITEMS-READ                             CL**1
02302                                TO  PV-DISPLAY5                       CL**1
02303      END-IF.                                                         CL**1
02304      MOVE PV-DISPLAY5          TO  ATOITMO.                          CL**5
02305 *                                                                    CL**1
02306      MOVE MB129-NUMBER-OF-ITEMS-READ                                 CL**1
02307                                TO  PV-DISPLAY5.                      CL**1
02308      MOVE PV-DISPLAY5          TO  ATOTITMO.                         CL**5
02309 *                                                                    CL**1
02310  EJECT                                                               CL**1
02311 ******************************************************************   CL**1
02312 *    IF NO ITEMS WERE READ FROM THE DATA BASE, POINT THE CURSOR      CL**1
02313 *    TO THE COMMAND LINE, OTHERWISE POINT THE CURSOR TO ONE OF       CL**1
02314 *    THE SELECTION ENTRIES.                                          CL**1
02315 *                                                                    CL**1
02316 *    PERFORMED BY H200-FORMAT-PANEL-BODY.                            CL**1
02317 ******************************************************************   CL**1
02318 *                                                                    CL**1
02319  I800-SET-CURSOR-POSITION.                                           CL**1
02320 *                                                                    CL**1
02321      IF MB129-NUMBER-OF-ITEMS-READ = +0                              CL**1
02322          MOVE -1               TO  ANAVCMDL                          CL**1
02323          MOVE PC-TSYMSG-00050  TO  DP020-MSG-NUMBER                  CL**1
02324          SET DP020-MSG-WARNING TO  TRUE                              CL**1
02325      ELSE                                                            CL**1
02326 *                                                                    CL**1
02327          IF (PS-CURSOR-NOT-POSITIONED) OR                            CL**1
02328             (PS-WARNING)               OR                            CL**1
02329             (PS-INFORMATIONAL)                                       CL**1
02330              PERFORM J200-FIND-LAST-SELECTION                        CL**1
02331          END-IF                                                      CL**1
02332      END-IF.                                                         CL**1
02333 *                                                                    CL**1
02334  EJECT                                                               CL**1
02335 ******************************************************************   CL**1
02336 *    PROCESS EACH ITEM IN THE ARRAY AND MOVE IT TO THE MAP.          CL**1
02337 *    FILL THE MAP UNTIL WE HAVE REACHED THE MAXIMUM NUMBER OF        CL**1
02338 *    MAP ENTRIES.                                                    CL**1
02339 *                                                                    CL**1
02340 *    PERFORMED BY I200-FORMAT-LIST-LINES.                            CL**1
02341 ******************************************************************   CL**1
02342 *                                                                    CL**1
02343  J100-PROCESS-ITEMS.                                                 CL**1
02344 *                                                                    CL**1
02345      IF (PV-ITEM-IN-USE < MB129-NUMBER-OF-ITEMS-READ) OR             CL**1
02346         (PV-ITEM-IN-USE = MB129-NUMBER-OF-ITEMS-READ)                CL**1
02347          PERFORM K100-SET-SUBSCRIPTS                                 CL**1
02348          MOVE DP015-UNP-ALP-BRT-MDT                                  CL**1
02349                                TO  MBKM129-SELECTA(PS-SUB)           CL**2
02350 *                                                                    CL**1
02351          IF (MB129-SELECT(MB129-BLK-SUB MB129-ITEM-SUB))             CL**1
02352          OR (MB129-NO-SELECT(MB129-BLK-SUB MB129-ITEM-SUB))          CL**1
02353              MOVE DP015-UNDERLINE TO MBKM129-SELECTH(PS-SUB)         CL**8
02354              MOVE DP015-GREEN     TO MBKM129-SELECTC(PS-SUB)         CL**2
02355          ELSE                                                        CL**1
02356 *                                                                    CL**1
02357              IF (MB129-BEGIN(MB129-BLK-SUB MB129-ITEM-SUB))          CL**1
02358              OR (MB129-END(MB129-BLK-SUB MB129-ITEM-SUB))            CL**1
02359                  MOVE DP015-UNDERLINE   TO MBKM129-SELECTH(PS-SUB)   CL**8
02360                  MOVE DP015-GREEN       TO MBKM129-SELECTC(PS-SUB)   CL**2
02361                  IF (DP020-MSG-NUMBER  =    PC-TSYMSG-00051          CL**1
02362                                          OR PC-TSYMSG-00053          CL**1
02363                     )                                                CL**1
02364 *                    UNPAIRED RANGE CHARACTER, SET WARNING           CL**1
02365 *                    ATTRIBUTES FOR RANGE CHARACTER:                 CL**1
02366                      MOVE DP015-REVERSE TO MBKM129-SELECTH(PS-SUB)   CL**8
02367                      MOVE DP015-YELLOW  TO MBKM129-SELECTC(PS-SUB)   CL**2
02368                  END-IF                                              CL**1
02369 *                                                                    CL**1
02370                  IF (    DP020-MSG-NUMBER  = PC-TSYMSG-00054         CL**1
02371                      AND MB129-BEGIN( MB129-BLK-SUB                  CL**1
02372                                       MB129-ITEM-SUB   )             CL**1
02373                     )                                                CL**1
02374 *                    TWO OR MORE START-OF-RANGE CHARACTERS, SET      CL**1
02375 *                    ATTRIBUTES FOR START-OF-RANGE CHARACTERS:       CL**1
02376                      MOVE DP015-REVERSE TO MBKM129-SELECTH(PS-SUB)   CL**8
02377                      MOVE DP015-RED     TO MBKM129-SELECTC(PS-SUB)   CL**2
02378                  END-IF                                              CL**1
02379 *                                                                    CL**1
02380                  IF (    DP020-MSG-NUMBER  = PC-TSYMSG-00055         CL**1
02381                      AND MB129-END( MB129-BLK-SUB                    CL**1
02382                                     MB129-ITEM-SUB   )               CL**1
02383                     )                                                CL**1
02384 *                    TWO OR MORE END-OF-RANGE CHARACTERS, SET        CL**1
02385 *                    ATTRIBUTES FOR END-OF-RANGE CHARACTERS:         CL**1
02386                      MOVE DP015-REVERSE TO MBKM129-SELECTH(PS-SUB)   CL**8
02387                      MOVE DP015-RED     TO MBKM129-SELECTC(PS-SUB)   CL**2
02388                  END-IF                                              CL**1
02389 *                                                                    CL**1
02390                  IF  DP020-MSG-NUMBER  =  PC-TSYMSG-00052            CL**1
02391 *                    END-OF-RANGE PRECEDES START OF RANGE, SET       CL**1
02392 *                    ATTRIBUTES OF RANGE CHARACTERS:                 CL**1
02393                      MOVE DP015-REVERSE TO MBKM129-SELECTH(PS-SUB)   CL**8
02394                      MOVE DP015-RED     TO MBKM129-SELECTC(PS-SUB)   CL**2
02395                  END-IF                                              CL**1
02396              END-IF                                                  CL**1
02397                                                                      CL**1
02398          END-IF                                                      CL**1
02399                                                                      CL**1
02400          MOVE MB129-SELECTED-SW(MB129-BLK-SUB MB129-ITEM-SUB)        CL**1
02401                                TO  MBKM129-SELECTI(PS-SUB)           CL**2
02402 *                                                                    CL**1
02403          IF (PS-SEND-MAP-N-DATA-FRSET)                               CL**1
02404          OR (PS-DIFFERENT-ITEMS-DISPLAYED)                           CL**1
02405              MOVE MB129-RLEVEL      (MB129-BLK-SUB                   CL**1
02406                                      MB129-ITEM-SUB)                 CL**1
02407                                TO  MBKM129-RLEVEL      (PS-SUB)      CL**2
02408 *                                                                    CL**1
02409              MOVE MB129-DESC      (MB129-BLK-SUB                     CL**1
02410                                    MB129-ITEM-SUB)                   CL**1
02411                                TO  MBKM129-DESC        (PS-SUB)      CL**2
02412 *                                                                    CL**1
02413          END-IF                                                      CL**1
02414                                                                      CL**1
02415      ELSE                                                            CL**1
02416                                                                      CL**1
02417          IF (PS-SEND-MAP-N-DATA-FRSET)     OR                        CL**1
02418             (PS-DIFFERENT-ITEMS-DISPLAYED)                           CL**1
02419              MOVE SPACES       TO  MBKM129-RLEVEL      (PS-SUB)      CL**2
02420                                    MBKM129-DESC        (PS-SUB)      CL**2
02421                                    MBKM129-SELECTI     (PS-SUB)      CL**4
02422              MOVE DP015-ASK-DRK-OFF                                  CL**1
02423                                TO  MBKM129-SELECTA(PS-SUB)           CL**2
02424          END-IF                                                      CL**1
02425                                                                      CL**1
02426      END-IF.                                                         CL**1
02427                                                                      CL**1
02428      ADD +1 TO PV-ITEM-IN-USE.                                       CL**1
02429      ADD +1 TO PS-SUB.                                               CL**1
02430  EJECT                                                               CL**1
02431 ******************************************************************   CL**1
02432 *    FIND THE LAST SELECTION ENTRY IN THE MAP THAT IS NOT            CL**1
02433 *    SPACES OR LOW VALUES AND POINT THE CURSOR TO THIS ENTRY.        CL**1
02434 *    IF ALL ENTRIES ARE SPACES OR LOW VALUES, POINT THE CURSOR       CL**1
02435 *    TO THE 1ST SELECTION ENTRY IN THE MAP.                          CL**1
02436 *                                                                    CL**1
02437 *    PERFORMED BY I800-SET-CURSOR-POSITION.                          CL**1
02438 ******************************************************************   CL**1
02439 *                                                                    CL**1
02440  J200-FIND-LAST-SELECTION.                                           CL**1
02441 *                                                                    CL**1
02442      MOVE PC-ITEMS-PER-PANEL TO PS-SUB.                              CL**1
02443                                                                      CL**1
02444      SET PS-NO-SELECTION-FOUND TO TRUE.                              CL**1
02445                                                                      CL**1
02446      PERFORM                                                         CL**1
02447          UNTIL (PS-SUB = +1)                                         CL**1
02448             OR (PS-SELECTION-FOUND)                                  CL**1
02449 *                                                                    CL**1
02450          IF (MBKM129-SELECTI(PS-SUB) NOT EQUAL SPACES                CL**2
02451          AND MBKM129-SELECTI(PS-SUB) NOT EQUAL LOW-VALUE)            CL**2
02452              SET PS-SELECTION-FOUND                                  CL**1
02453                                TO  TRUE                              CL**1
02454          ELSE                                                        CL**1
02455              SUBTRACT +1     FROM  PS-SUB                            CL**1
02456          END-IF                                                      CL**1
02457      END-PERFORM.                                                    CL**1
02458                                                                      CL**1
02459      MOVE -1                 TO  MBKM129-SELECTL(PS-SUB).            CL**2
02460 *                                                                    CL**1
02461  EJECT                                                               CL**1
02462 ******************************************************************   CL**1
02463 *    DETERMINE THE VALUE OF THE ITEM SUBSCRIPT BASED ON THE ITEM     CL**1
02464 *    CURRENTLY IN USE AND THE FIRST ITEM IN THE ARRAY.  THIS WILL    CL**1
02465 *    POSITION US IN THE 1ST BLOCK OF THE ARRAY.                      CL**1
02466 *                                                                    CL**1
02467 *    IF THE ITEM SUBSCRIPT EXCEEDS THE MAXIMUM NUMBER OF ITEMS       CL**1
02468 *    IN A BLOCK, RECALCULATE THE SUBSCRIPT BY SUBTRACTING OUT        CL**1
02469 *    THE MAXIMUM NUMBER OF ITEMS.  THIS WILL CORRECTLY POSITION      CL**1
02470 *    US IN THE 2ND BLOCK OF THE ARRAY.                               CL**1
02471 *                                                                    CL**1
02472 *    PERFORMED BY E100-EDIT-SELECTIONS.                              CL**1
02473 *    PERFORMED BY F100-EDIT.                                         CL**1
02474 *    PERFORMED BY F300-CHECK-SELECTIONS.                             CL**1
02475 *    PERFORMED BY J100-PROCESS-ITEMS.                                CL**1
02476 ******************************************************************   CL**1
02477 *                                                                    CL**1
02478  K100-SET-SUBSCRIPTS.                                                CL**1
02479 *                                                                    CL**1
02480      COMPUTE PS-ITEM-SUB =                                           CL**1
02481          (PV-ITEM-IN-USE - MB129-LIST-ITEM-NUMBER(1 1)) + 1.         CL**1
02482                                                                      CL**1
02483      MOVE PS-ITEM-SUB TO MB129-ITEM-SUB.                             CL**1
02484                                                                      CL**1
02485      IF MB129-ITEM-SUB > PC-ITEMS-PER-BLOCK                          CL**1
02486          SUBTRACT PC-ITEMS-PER-BLOCK FROM MB129-ITEM-SUB             CL**1
02487                                                                      CL**1
02488          MOVE PC-MAX-BLOCKS-IN-ARRAY TO MB129-BLK-SUB                CL**1
02489      ELSE                                                            CL**1
02490          MOVE +1                     TO MB129-BLK-SUB                CL**1
02491      END-IF.                                                         CL**1
02492 *                                                                    CL**1
02493  EJECT                                                               CL**1
02494 ******************************************************************   CL**1
02495 *    OPEN THE BUSINESS GROUP LIST CURSOR.                            CL**1
02496 *                                                                    CL**1
02497 *    PERFORMED BY D100                                               CL**1
02498 ******************************************************************   CL**1
02499 *                                                                    CL**1
02500  L100-OPEN-CURSOR.                                                   CL**1
02501 *                                                                    CL**1
02502      MOVE MB129-LAST-RLEVEL                                          CL**1
02503                                TO  RSPLVL-CDE.                       CL**1
02504      PERFORM                                                         CL**1
02505          WITH TEST AFTER                                             CL**1
02506          VARYING PV-SQL-SUB                                          CL**1
02507          FROM 1 BY 1                                                 CL**1
02508          UNTIL PV-SQL-SUB GREATER THAN PC-MAX-RETRIES                CL**1
02509             OR SQLCODE = 0                                           CL**1
02510             OR SQLCODE = +100                                        CL**1
02511 *                                                                    CL**1
02512          EXEC SQL                                                    CL**1
02513               OPEN RL-LIST                                           CL**1
02514          END-EXEC                                                    CL**1
02515 *                                                                    CL**1
02516          EVALUATE TRUE                                               CL**1
02517              WHEN SQLCODE = -904                                     CL**1
02518              WHEN SQLCODE = -913                                     CL**1
02519              WHEN SQLCODE = ZERO                                     CL**1
02520              WHEN SQLCODE = +100                                     CL**1
02521                   CONTINUE                                           CL**1
02522              WHEN SQLWARN0 NOT EQUAL SPACE                           CL**1
02523              WHEN SQLCODE NOT EQUAL ZERO                             CL**1
02524                   MOVE 'L100-OPEN-CURSOR'                            CL**1
02525                                TO  DP013-PARAGRAPH                   CL**1
02526                   MOVE 'OPEN RL-LIST CURSOR'                         CL**1
02527                                TO  DP013-MESSAGE-TEXT (1)            CL**1
02528                   MOVE SQLCA   TO  DP013-SQLCA                       CL**1
02529                   SET DP013-DB2-ABEND                                CL**1
02530                                TO  TRUE                              CL**1
02531                   PERFORM DP013-0000-PROCESS-ABEND                   CL**1
02532          END-EVALUATE                                                CL**1
02533      END-PERFORM.                                                    CL**1
02534 *                                                                    CL**1
02535      IF  PV-SQL-SUB GREATER THAN PC-MAX-RETRIES                      CL**1
02536          MOVE 'L100-OPEN-CURSOR'                                     CL**1
02537                                TO  DP013-PARAGRAPH                   CL**1
02538          MOVE 'MAX RETRIES EXCEEDED FOR OPEN CURSOR'                 CL**1
02539                                TO  DP013-MESSAGE-TEXT (1)            CL**1
02540          MOVE SQLCA            TO  DP013-SQLCA                       CL**1
02541          SET DP013-DB2-ABEND   TO  TRUE                              CL**1
02542          PERFORM DP013-0000-PROCESS-ABEND                            CL**1
02543      END-IF.                                                         CL**1
02544 *                                                                    CL**1
02545  EJECT                                                               CL**1
02546 ******************************************************************   CL**1
02547 *    FETCH THE ROWS FROM TMDSEBG.                                    CL**1
02548 *                                                                    CL**1
02549 *    PERFORMED BY H100                                               CL**1
02550 ******************************************************************   CL**1
02551 *                                                                    CL**1
02552  L200-FETCH.                                                         CL**1
02553 *                                                                    CL**1
02554      PERFORM                                                         CL**1
02555          WITH TEST AFTER                                             CL**1
02556          VARYING PV-SQL-SUB                                          CL**1
02557          FROM 1 BY 1                                                 CL**1
02558          UNTIL PV-SQL-SUB GREATER THAN PC-MAX-RETRIES                CL**1
02559             OR SQLCODE = 0                                           CL**1
02560             OR SQLCODE = +100                                        CL**1
02561 *                                                                    CL**1
02562          EXEC SQL                                                    CL**1
02563               FETCH RL-LIST                                          CL**1
02564               INTO                                                   CL**1
02565                     :RSPLVL-CDE,                                     CL**1
02566                     :RSPLVL-DESC                                     CL**1
02567          END-EXEC                                                    CL**1
02568 *                                                                    CL**1
02569          EVALUATE TRUE                                               CL**1
02570              WHEN SQLCODE = -904                                     CL**1
02571              WHEN SQLCODE = -913                                     CL**1
02572              WHEN SQLCODE = ZERO                                     CL**1
02573              WHEN SQLCODE = +100                                     CL**1
02574                   CONTINUE                                           CL**1
02575              WHEN SQLWARN0 NOT EQUAL SPACE                           CL**1
02576              WHEN SQLCODE NOT EQUAL ZERO                             CL**1
02577                   MOVE 'L200-FETCH'                                  CL**1
02578                                TO  DP013-PARAGRAPH                   CL**1
02579                   MOVE 'FETCH RL-LIST CURSOR'                        CL**1
02580                                TO  DP013-MESSAGE-TEXT (1)            CL**1
02581                   MOVE SQLCA   TO  DP013-SQLCA                       CL**1
02582                   SET DP013-DB2-ABEND                                CL**1
02583                                TO  TRUE                              CL**1
02584                   PERFORM DP013-0000-PROCESS-ABEND                   CL**1
02585          END-EVALUATE                                                CL**1
02586      END-PERFORM.                                                    CL**1
02587 *                                                                    CL**1
02588      IF  PV-SQL-SUB GREATER THAN PC-MAX-RETRIES                      CL**1
02589          MOVE 'L200-FETCH'                                           CL**1
02590                                TO  DP013-PARAGRAPH                   CL**1
02591          MOVE 'MAX RETRIES EXCEEDED FOR FETCH CURSOR'                CL**1
02592                                TO  DP013-MESSAGE-TEXT (1)            CL**1
02593          MOVE SQLCA            TO  DP013-SQLCA                       CL**1
02594          SET DP013-DB2-ABEND   TO  TRUE                              CL**1
02595          PERFORM DP013-0000-PROCESS-ABEND                            CL**1
02596      END-IF.                                                         CL**1
02597 *                                                                    CL**1
02598      IF  SQLCODE EQUAL +100                                          CL**1
02599          SET MB129-NO-ITEMS-LEFT-ON-DB                               CL**1
02600                                TO  TRUE                              CL**1
02601      END-IF.                                                         CL**1
02602 *                                                                    CL**1
02603  EJECT                                                               CL**1
02604 ******************************************************************   CL**1
02605 *    PREPARE THE TEMPORARY STORAGE QUEUE.  MOVE ALL SELECTED         CL**1
02606 *    GROUPS FROM EITHER TEMP STORAGE OR THE ARRAY IN THE COMM        CL**1
02607 *    AREA TO THE LIST TS QUEUE RECORD(S).                            CL**1
02608 *                                                                    CL**1
02609 *    PERFORMED BY D300                                               CL**1
02610 ******************************************************************   CL**1
02611 *                                                                    CL**1
02612  X100-PREPARE-LIST-QUEUE.                                            CL**1
02613 *                                                                    CL**1
02614      MOVE +1                   TO  MB129-BLK-SUB.                    CL**1
02615      PERFORM Z150-WRITE-TEMP-STORAGE.                                CL**1
02616      ADD +1                    TO  MB129-BLK-SUB.                    CL**1
02617      PERFORM Z150-WRITE-TEMP-STORAGE.                                CL**1
02618 *                                                                    CL**1
02619      IF  MB129-HIGHEST-BLOCK-WRITTEN = ZERO                          CL**1
02620          MOVE EIBTRMID         TO  PV-RL-TERM-ID                     CL**1
02621          MOVE EIBTASKN         TO  PV-RL-TASK-NUMBER                 CL**1
02622      ELSE                                                            CL**1
02623          MOVE MB129-TERM-ID    TO  PV-RL-TERM-ID                     CL**1
02624          MOVE MB129-TASK-NUMBER                                      CL**1
02625                                TO  PV-RL-TASK-NUMBER                 CL**1
02626      END-IF.                                                         CL**1
02627      SUBTRACT 1              FROM  PV-RL-TASK-NUMBER.                CL**1
02628 *                                                                    CL**1
02629      MOVE PV-RL-QUEUE-NAME     TO  MB005-LIST-QUEUE-NAME             CL**1
02630                                    MB129-LIST-QUEUE-NAME.            CL**1
02631      MOVE LENGTH OF RL-LIST-RECORD                                   CL**1
02632                                TO  MB005-LIST-QUEUE-LENGTH.          CL**1
02633      PERFORM X900-DELETE-LIST-QUEUE.                                 CL**1
02634 *                                                                    CL**1
02635      SET MBWS129-IDX           TO  1.                                CL**1
02636      INITIALIZE RL-LIST-RECORD.                                      CL**1
02637      PERFORM X200-PROCESS-TS-QUEUE                                   CL**1
02638              VARYING PV-ITEM                                         CL**1
02639              FROM 1 BY 1                                             CL**1
02640              UNTIL PV-ITEM GREATER MB129-HIGHEST-BLOCK-WRITTEN.      CL**1
02641 *                                                                    CL**1
02642      PERFORM X500-WRITE-LIST-QUEUE.                                  CL**1
02643 *                                                                    CL**1
02644  EJECT                                                               CL**1
02645 ******************************************************************   CL**1
02646 *    READ A TS QUEUE RECORD, MOVE SELECTED RECORDS TO THE            CL**1
02647 *    BUSINESS GROUP LIST QUEUE RECORD.                               CL**1
02648 *                                                                    CL**1
02649 *    PERFORMED BY X100                                               CL**1
02650 ******************************************************************   CL**1
02651 *                                                                    CL**1
02652  X200-PROCESS-TS-QUEUE.                                              CL**1
02653 *                                                                    CL**1
02654      PERFORM X300-READ-TS-QUEUE.                                     CL*15
02655      IF  PV-RESP EQUAL DFHRESP(NORMAL)                               CL**1
02656          PERFORM                                                     CL**1
02657          VARYING PV-TW-IDX                                           CL**1
02658          FROM 1 BY 1                                                 CL**1
02659          UNTIL PV-TW-IDX GREATER THAN PC-ITEMS-PER-BLOCK             CL**1
02660            OR  PV-TW-LIST-ITEM-NUMBER (PV-TW-IDX) EQUAL ZERO         CL**1
02661 *                                                                    CL**1
02662              IF  PV-TW-SELECT (PV-TW-IDX)                            CL**1
02663                  MOVE PV-TW-RLEVEL      (PV-TW-IDX)                  CL**1
02664                                TO  MBWS129-RLEVEL (MBWS129-IDX)      CL**1
02665                                    MBWS129-LAST-RLEVEL               CL**1
02666                  MOVE PV-TW-LIST-ITEM-NUMBER  (PV-TW-IDX)            CL*11
02667                                TO  MBWS129-ITEM   (MBWS129-IDX)      CL*11
02668                  IF  MBWS129-IDX EQUAL 1                             CL**1
02669                      MOVE MBWS129-LAST-RLEVEL                        CL**1
02670                                TO  MBWS129-FIRST-RLEVEL              CL**1
02671                  END-IF                                              CL**1
02672                  SET MBWS129-IDX UP BY 1                             CL**1
02673                  IF  MBWS129-IDX GREATER PC-MAX-RLEVELS              CL**1
02674                      PERFORM X500-WRITE-LIST-QUEUE                   CL**1
02675                  END-IF                                              CL**1
02676              END-IF                                                  CL**1
02677 *                                                                    CL**1
02678          END-PERFORM                                                 CL**1
02679      END-IF.                                                         CL**1
02680 *                                                                    CL*11
02681  EJECT                                                               CL*11
02682 ******************************************************************   CL*11
02683 *    READ THE TEMPORARY STORAGE QUEUE.                               CL*11
02684 *                                                                    CL*11
02685 *    PERFORMED BY C500, X200                                         CL*11
02686 ******************************************************************   CL*11
02687 *                                                                    CL*11
02688  X300-READ-TS-QUEUE.                                                 CL*15
02689 *                                                                    CL*11
02690      EXEC CICS                                                       CL*11
02691          READQ TS                                                    CL*11
02692          QUEUE(MB129-TEMP-QUEUE-NAME)                                CL*11
02693          INTO(PV-TEMP-WORK-AREA)                                     CL*11
02694          LENGTH(PC-BLOCK-LENGTH)                                     CL*11
02695          ITEM(PV-ITEM)                                               CL*11
02696          RESP(PV-RESP)                                               CL*11
02697      END-EXEC.                                                       CL*11
02698 *                                                                    CL**1
02699  EJECT                                                               CL**1
02700 ******************************************************************   CL**1
02701 *    WRITE THE SKU LIST QUEUE RECORD.                                CL**1
02702 *                                                                    CL**1
02703 *    PERFORMED BY X100                                               CL**1
02704 ******************************************************************   CL**1
02705 *                                                                    CL**1
02706  X500-WRITE-LIST-QUEUE.                                              CL**1
02707 *                                                                    CL**1
02708      IF  MBWS129-IDX GREATER THAN 1                                  CL**1
02709          MOVE PC-MAX-RLEVELS   TO  MBWS129-MAX-RLEVELS               CL**1
02710          MOVE MB129-NUMBER-OF-SELECTED-ITEMS                         CL**1
02711                                TO  MBWS129-SELECTED-RLEVELS          CL**1
02712 *                                                                    CL**3
02713          IF  DP020-SRC-AID EQUAL DP016-PF15                          CL**3
02714              SET MBWS129-UPDATE  TO  TRUE                            CL**3
02715          ELSE                                                        CL**3
02716              SET MBWS129-DELETE  TO  TRUE                            CL**3
02717          END-IF                                                      CL**3
02718 *                                                                    CL**1
02719          EXEC CICS                                                   CL**1
02720               WRITEQ TS                                              CL**1
02721               QUEUE(MB005-LIST-QUEUE-NAME)                           CL**1
02722               FROM(RL-LIST-RECORD)                                   CL**1
02723               LENGTH(MB005-LIST-QUEUE-LENGTH)                        CL**1
02724               ITEM(PV-RL-ITEM)                                       CL*11
02725               RESP(PV-RESP)                                          CL**1
02726          END-EXEC                                                    CL**1
02727 *                                                                    CL**1
02728          IF  PV-RESP NOT EQUAL DFHRESP(NORMAL)                       CL**1
02729              SET PS-DONT-PROCESS                                     CL*16
02730                                TO  TRUE                              CL**1
02731          END-IF                                                      CL**1
02732 *                                                                    CL**1
02733          INITIALIZE RL-LIST-RECORD                                   CL**1
02734          SET MBWS129-IDX       TO  1                                 CL**1
02735      END-IF.                                                         CL**1
02736 *                                                                    CL*11
02737  EJECT                                                               CL*11
02738 ******************************************************************   CL*11
02739 *    WRITE THE TS QUEUE RECORD JUST UPDATED IN C600.                 CL*11
02740 *                                                                    CL*11
02741 *    PERFORMED BY C500, C600                                         CL*11
02742 ******************************************************************   CL*11
02743 *                                                                    CL*11
02744  X550-WRITE-TS-QUEUE.                                                CL*11
02745 *                                                                    CL*11
02746      EXEC CICS                                                       CL*11
02747          WRITEQ TS                                                   CL*11
02748          REWRITE                                                     CL*11
02749          QUEUE(MB129-TEMP-QUEUE-NAME)                                CL*11
02750          FROM(PV-TEMP-WORK-AREA)                                     CL*11
02751          LENGTH(PC-BLOCK-LENGTH)                                     CL*11
02752          ITEM(PV-SAVE-ITEM)                                          CL*11
02753          RESP(PV-RESP)                                               CL*11
02754      END-EXEC.                                                       CL*11
02755 *                                                                    CL*11
02756  EJECT                                                               CL*11
02757 ******************************************************************   CL*11
02758 *    READ THE LIST QUEUE RECORD.                                     CL*11
02759 *                                                                    CL*11
02760 *    PERFORMED BY C500                                               CL*11
02761 ******************************************************************   CL*11
02762 *                                                                    CL*11
02763  X600-READ-LIST-QUEUE.                                               CL*11
02764 *                                                                    CL*11
02765      EXEC CICS                                                       CL*11
02766           READQ TS                                                   CL*11
02767           QUEUE(MB005-LIST-QUEUE-NAME)                               CL*11
02768           INTO(RL-LIST-RECORD)                                       CL*11
02769           LENGTH(MB005-LIST-QUEUE-LENGTH)                            CL*11
02770           ITEM(PV-RL-ITEM)                                           CL*11
02771           RESP(PV-RESP)                                              CL*11
02772      END-EXEC.                                                       CL*11
02773 *                                                                    CL**1
02774  EJECT                                                               CL**1
02775 ******************************************************************   CL**1
02776 *    DELETE THE SKU LIST TEMP STORAGE QUEUE.                         CL**1
02777 *                                                                    CL**1
02778 *    PERFORMED BY X100                                               CL**1
02779 ******************************************************************   CL**1
02780 *                                                                    CL**1
02781  X900-DELETE-LIST-QUEUE.                                             CL**1
02782 *                                                                    CL**1
02783      EXEC CICS                                                       CL**1
02784          DELETEQ TS                                                  CL**1
02785          QUEUE(MB005-LIST-QUEUE-NAME)                                CL**1
02786          RESP(PV-RESP)                                               CL**1
02787      END-EXEC.                                                       CL**1
02788  EJECT                                                               CL**1
02789 *                                                                    CL**1
02790 ******************************************************************   CL**1
02791 *    DELETE THE TEMPORARY STORAGE QUEUE.                             CL**1
02792 *                                                                    CL**1
02793 *    PERFORMED BY C300-PROCESS-PANEL.                                CL**1
02794 ******************************************************************   CL**1
02795 *                                                                    CL**1
02796  Z050-DELETE-TEMP-STORAGE.                                           CL**1
02797 *                                                                    CL**1
02798      EXEC CICS                                                       CL**1
02799          DELETEQ TS                                                  CL**1
02800          QUEUE(MB129-TEMP-QUEUE-NAME)                                CL**1
02801          RESP(PV-RESP)                                               CL**1
02802      END-EXEC.                                                       CL**1
02803                                                                      CL**1
02804      IF (PV-RESP NOT = DFHRESP(NORMAL)) AND                          CL**1
02805         (PV-RESP NOT = DFHRESP(QIDERR))                              CL**1
02806          MOVE PV-RESP TO PM-RESP-23                                  CL**1
02807                                                                      CL**1
02808          SET DP013-LOGIC-ABEND TO TRUE                               CL**1
02809          SET DP013-NO-ROLLBACK TO TRUE                               CL**1
02810                                                                      CL**1
02811          MOVE 'Z050-DELETE-TEMP-STORAGE' TO DP013-PARAGRAPH          CL**1
02812          MOVE PM-PROGRAM-MESSAGE-23      TO DP013-MESSAGE-TEXT(1)    CL**1
02813                                                                      CL**1
02814          PERFORM DP013-0000-PROCESS-ABEND                            CL**1
02815      END-IF.                                                         CL**1
02816                                                                      CL**1
02817      MOVE +0 TO MB129-HIGHEST-BLOCK-WRITTEN.                         CL**1
02818  EJECT                                                               CL**1
02819 ******************************************************************   CL**1
02820 *    READ A BLOCK FROM TEMPORARY STORAGE INTO THE ARRAY.             CL**1
02821 *                                                                    CL**1
02822 *    PERFORMED BY D400-REFRESH-BLOCK-ARRAY.                          CL**1
02823 *    PERFORMED BY E700-DESELECT-ALL-ITEMS.                           CL**1
02824 *    PERFORMED BY F200-MARK-RANGE-AS-SELECTED.                       CL**1
02825 *    PERFORMED BY G500-SCROLL-FORWARD.                               CL**1
02826 *    PERFORMED BY G600-SCROLL-BACKWARD.                              CL**1
02827 *    PERFORMED BY G700-GET-TOP-ITEMS-BLOCK.                          CL**1
02828 *    PERFORMED BY G800-GET-LAST-BLOCK-IN-TEMP.                       CL**1
02829 ******************************************************************   CL**1
02830 *                                                                    CL**1
02831  Z100-READ-TEMP-STORAGE.                                             CL**1
02832 *                                                                    CL**1
02833      EXEC CICS                                                       CL**1
02834          READQ TS                                                    CL**1
02835          QUEUE(MB129-TEMP-QUEUE-NAME)                                CL**1
02836          INTO(MB129-BLOCK-ENTRIES(MB129-BLK-SUB))                    CL**1
02837          LENGTH(PC-BLOCK-LENGTH)                                     CL**1
02838          ITEM(PV-BLOCK-NUMBER)                                       CL**1
02839          RESP(PV-RESP)                                               CL**1
02840      END-EXEC.                                                       CL**1
02841 *                                                                    CL**1
02842      IF PV-RESP NOT = DFHRESP(NORMAL)                                CL**1
02843          MOVE PV-RESP          TO  PM-RESP-24                        CL**1
02844          EXEC CICS                                                   CL**1
02845               DELETEQ TS                                             CL**1
02846               QUEUE(MB129-TEMP-QUEUE-NAME)                           CL**1
02847               RESP(PV-RESP)                                          CL**1
02848          END-EXEC                                                    CL**1
02849          SET DP013-LOGIC-ABEND TO  TRUE                              CL**1
02850          SET DP013-NO-ROLLBACK TO  TRUE                              CL**1
02851          MOVE 'Z100-READ-TEMP-STORAGE'                               CL**1
02852                                TO  DP013-PARAGRAPH                   CL**1
02853          MOVE PM-PROGRAM-MESSAGE-24                                  CL**1
02854                                TO  DP013-MESSAGE-TEXT(1)             CL**1
02855          PERFORM DP013-0000-PROCESS-ABEND                            CL**1
02856      END-IF.                                                         CL**1
02857                                                                      CL**1
02858      SET MB129-BLOCK-NOT-MODIFIED(MB129-BLK-SUB) TO TRUE.            CL**1
02859  EJECT                                                               CL**1
02860 ******************************************************************   CL**1
02861 *    WRITE A NEW BLOCK FROM THE ARRAY TO TEMPORARY STORAGE.          CL**1
02862 *    REWRITE AN EXISITING BLOCK ONLY IF IT HAS BEEN MODIFIED.        CL**1
02863 *                                                                    CL**1
02864 *    PERFORMED BY E300-NAVIGATE.                                     CL**1
02865 *    PERFORMED BY E700-DESELECT-ALL-ITEMS.                           CL**1
02866 *    PERFORMED BY F200-MARK-RANGE-AS-SELECTED.                       CL**1
02867 *    PERFORMED BY G500-SCROLL-FORWARD.                               CL**1
02868 *    PERFORMED BY G600-SCROLL-BACKWARD.                              CL**1
02869 *    PERFORMED BY G700-GET-TOP-ITEMS-BLOCK.                          CL**1
02870 *    PERFORMED BY G800-GET-LAST-BLOCK-IN-TEMP.                       CL**1
02871 *    PERFORMED BY H100-READ-ITEMS-FROM-DB.                           CL**1
02872 ******************************************************************   CL**1
02873 *                                                                    CL**1
02874  Z150-WRITE-TEMP-STORAGE.                                            CL**1
02875 *                                                                    CL**1
02876      IF MB129-HIGHEST-BLOCK-WRITTEN = +0                             CL**1
02877          MOVE EIBTASKN         TO  DP020-SRC-TASK-NUMBER             CL**1
02878          MOVE EIBTASKN         TO  MB129-TASK-NUMBER                 CL**1
02879          MOVE EIBTRMID         TO  MB129-TERM-ID                     CL**1
02880      END-IF.                                                         CL**1
02881 *                                                                    CL**1
02882      MOVE MB129-LIST-ITEM-NUMBER(MB129-BLK-SUB 1)                    CL**1
02883                                TO  PV-LIST-ITEM-NUMBER.              CL**1
02884      COMPUTE PV-BLOCK-NUMBER =                                       CL**1
02885          1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-BLOCK).       CL**1
02886 *                                                                    CL**1
02887      IF (PV-BLOCK-NUMBER < MB129-HIGHEST-BLOCK-WRITTEN)              CL**1
02888      OR (PV-BLOCK-NUMBER = MB129-HIGHEST-BLOCK-WRITTEN)              CL**1
02889          IF  MB129-BLOCK-MODIFIED(MB129-BLK-SUB)                     CL**1
02890              EXEC CICS                                               CL**1
02891                  WRITEQ TS                                           CL**1
02892                  QUEUE(MB129-TEMP-QUEUE-NAME)                        CL**1
02893                  FROM(MB129-BLOCK-ENTRIES(MB129-BLK-SUB))            CL**1
02894                  LENGTH(PC-BLOCK-LENGTH)                             CL**1
02895                  ITEM(PV-BLOCK-NUMBER)                               CL**1
02896                  REWRITE                                             CL**1
02897                  RESP(PV-RESP)                                       CL**1
02898              END-EXEC                                                CL**1
02899 *                                                                    CL**1
02900              IF  PV-RESP NOT = DFHRESP(NORMAL)                       CL**1
02901                  MOVE PV-RESP  TO  PM-RESP-9                         CL**1
02902                  EXEC CICS                                           CL**1
02903                      DELETEQ TS                                      CL**1
02904                      QUEUE(MB129-TEMP-QUEUE-NAME)                    CL**1
02905                      RESP(PV-RESP)                                   CL**1
02906                  END-EXEC                                            CL**1
02907 *                                                                    CL**1
02908                  SET DP013-LOGIC-ABEND                               CL**1
02909                                TO  TRUE                              CL**1
02910                  SET DP013-NO-ROLLBACK                               CL**1
02911                                TO  TRUE                              CL**1
02912                  MOVE 'Z150-WRITE-TEMP-STORAGE'                      CL**1
02913                                TO  DP013-PARAGRAPH                   CL**1
02914                  MOVE PM-PROGRAM-MESSAGE-9                           CL**1
02915                                TO  DP013-MESSAGE-TEXT(1)             CL**1
02916                  PERFORM DP013-0000-PROCESS-ABEND                    CL**1
02917              END-IF                                                  CL**1
02918          END-IF                                                      CL**1
02919      ELSE                                                            CL**1
02920 *                                                                    CL**1
02921          COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                          CL**1
02922              MB129-HIGHEST-BLOCK-WRITTEN + 1                         CL**1
02923          IF  PV-BLOCK-NUMBER = PV-HIGHEST-BLOCK-WRITTEN              CL**1
02924              EXEC CICS                                               CL**1
02925                  WRITEQ TS                                           CL**1
02926                  QUEUE(MB129-TEMP-QUEUE-NAME)                        CL**1
02927                  FROM(MB129-BLOCK-ENTRIES(MB129-BLK-SUB))            CL**1
02928                  LENGTH(PC-BLOCK-LENGTH)                             CL**1
02929                  ITEM(PV-BLOCK-NUMBER)                               CL**1
02930                  RESP(PV-RESP)                                       CL**1
02931              END-EXEC                                                CL**1
02932 *                                                                    CL**1
02933              IF  PV-RESP NOT = DFHRESP(NORMAL)                       CL**1
02934                  MOVE PV-RESP  TO  PM-RESP-10                        CL**1
02935                  EXEC CICS                                           CL**1
02936                      DELETEQ TS                                      CL**1
02937                      QUEUE(MB129-TEMP-QUEUE-NAME)                    CL**1
02938                      RESP(PV-RESP)                                   CL**1
02939                  END-EXEC                                            CL**1
02940 *                                                                    CL**1
02941                  SET DP013-LOGIC-ABEND                               CL**1
02942                                TO  TRUE                              CL**1
02943                  SET DP013-NO-ROLLBACK                               CL**1
02944                                TO  TRUE                              CL**1
02945                  MOVE 'Z150-WRITE-TEMP-STORAGE'                      CL**1
02946                                TO  DP013-PARAGRAPH                   CL**1
02947                  MOVE PM-PROGRAM-MESSAGE-10                          CL**1
02948                                TO  DP013-MESSAGE-TEXT(1)             CL**1
02949                  PERFORM DP013-0000-PROCESS-ABEND                    CL**1
02950              END-IF                                                  CL**1
02951              ADD +1            TO  MB129-HIGHEST-BLOCK-WRITTEN       CL**1
02952          ELSE                                                        CL**1
02953              SET DP013-LOGIC-ABEND                                   CL**1
02954                                TO  TRUE                              CL**1
02955              SET DP013-NO-ROLLBACK                                   CL**1
02956                                TO  TRUE                              CL**1
02957              MOVE 'Z150-WRITE-TEMP-STORAGE'                          CL**1
02958                                TO  DP013-PARAGRAPH                   CL**1
02959              MOVE PV-BLOCK-NUMBER                                    CL**1
02960                                TO  PM-BLOCK-NUMBER                   CL**1
02961              MOVE PM-PROGRAM-MESSAGE-11                              CL**1
02962                                TO  DP013-MESSAGE-TEXT(1)             CL**1
02963              PERFORM DP013-0000-PROCESS-ABEND                        CL**1
02964          END-IF                                                      CL**1
02965      END-IF.                                                         CL**1
02966                                                                      CL**1
02967      SET MB129-BLOCK-NOT-MODIFIED(MB129-BLK-SUB) TO TRUE.            CL**1
02968 *                                                                    CL**1
02969  EJECT                                                               CL**1
02970 ******************************************************************   CL**1
02971 *    FILL IN SCREEN HEADER MODULE                                    CL**1
02972 ******************************************************************   CL**1
02973                                                                      CL**1
02974      COPY DPPD002.                                                   CL**1
02975  EJECT                                                               CL**1
02976 ******************************************************************   CL**1
02977 *    RETURN TO CICS MODULE                                           CL**1
02978 ******************************************************************   CL**1
02979                                                                      CL**1
02980      COPY DPPD003.                                                   CL**1
02981  EJECT                                                               CL**1
02982 ******************************************************************   CL**1
02983 *    FORMAT MESSAGE LINES MODULE                                     CL**1
02984 ******************************************************************   CL**1
02985                                                                      CL**1
02986      COPY DPPD005.                                                   CL**1
02987  EJECT                                                               CL**1
02988 ******************************************************************   CL**1
02989 *    GET PANEL MODULE                                                CL**1
02990 ******************************************************************   CL**1
02991                                                                      CL**1
02992      COPY DPPD007.                                                   CL**1
02993  EJECT                                                               CL**1
02994 ******************************************************************   CL**1
02995 *    WRITE PANEL MODULE                                              CL**1
02996 ******************************************************************   CL**1
02997                                                                      CL**1
02998      COPY DPPD008.                                                   CL**1
02999  EJECT                                                               CL**1
03000 ******************************************************************   CL**1
03001 *    TOGGLE THE FUNCTION KEY LINE MODULE                             CL**1
03002 ******************************************************************   CL**1
03003                                                                      CL**1
03004      COPY DPPD009.                                                   CL**1
03005  EJECT                                                               CL**1
03006 ******************************************************************   CL**1
03007 *    ABEND PROCESSOR MODULE                                          CL**1
03008 ******************************************************************   CL**1
03009                                                                      CL**1
03010      COPY DPPD013.                                                   CL**1
03011  EJECT                                                               CL**1
03012 ******************************************************************   CL**1
03013 *    CHECK COMMUNICATION AREA MODULE                                 CL**1
03014 ******************************************************************   CL**1
03015                                                                      CL**1
03016      COPY DPPD015.                                                   CL**1
03017  EJECT                                                               CL**1
03018 ******************************************************************   CL**1
03019 *    UPDATE TIME AND DATE MODULE                                     CL**1
03020 ******************************************************************   CL**1
03021                                                                      CL**1
03022      COPY DPPD017.                                                   CL**1
03023  EJECT                                                               CL**1
