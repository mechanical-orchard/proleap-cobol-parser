000100******************************************************************00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300******************************************************************00030000
000400                                                                  00040000
000500 PROGRAM-ID.             SUKUT015.                                00050000
000600 AUTHOR.                 MICHAEL WALTERS.                         00060000
000700 INSTALLATION.           KOHLS.                                   00070000
000800 DATE-WRITTEN            SEPTEMBER, 1997.                         00080000
000900 DATE-COMPILED.                                                   00090000
001000                                                                  00100000
001100******************************************************************00110000
001200*       THIS PROGRAM WILL CREATE THE AUDIT SUMMARY EXTRACT FILE   00120000
001300*  FOR THE UCC128 CARTON AUDITING SYSTEM -- FOR CASEPACK ORDERS.  00130000
001400******************************************************************00140000
001500***************************************************************** 00150000
001600*  CHANGED 10/05/09 BY SAURABH DUDDALWAR                        * 00160000
001700*   CHANGES ARE DONE TO HANDLE DATA CONTENTION ERRORS IN THE    * 00170000
001800*            PROGRAM WHILE REPORT GENERATION.                   * 00180000
      *  CHANGED 11/15/13 BY SHOBHIT BAIJAL                           * 00190000
      *   PR# 5148D  ADD A NEW RFID ERROR RECORD TO BE USED FOR RFID  * 00200000
      *            AUDIT REPORTING                                    * 00210000
      *  CHANGED 12/30/13 BY RAMYA SREEDHAREN                         * 00220000
      *   PR# 5148D  ADDED NEW LOGIC TO DISPLAY TOTAL UNITS AUDITED   * 00230000
      *              FOR RFID AUDIT                                   * 00240000
      *  CHANGED 01/09/14 BY RAMYA SREEDHAREN                         * 00250000
      *   PR# 5148D  ADDED NEW LOGIC FOR RFID-NO-TICKET ERRORS        * 00260000
      *              FOR RFID AUDIT                                   * 00270000
      *  CHANGED 03/21/14 BY SHOBHIT BAIJAL                           * 00280000
      *   PR# 5148D  ADDED NEW LOGIC FOR CALCULATING UPC MISPACK.     * 00290000
      *              USE RFID QTY IF NON ZERO ELSE SCANNED QTY.       * 00300000
      *  CHANGED 03/28/14 BY SHOBHIT BAIJAL                           * 00301000
      *   PR# 5148D  ADDED LOGIC FOR SUMMING UPC MISPACK SEPARATELY   * 00302000
      *              BASED ON THE LOGIC PUT IN ON 03/21.              * 00303000
      *  CHANGED 04/10/14 BY SHOBHIT BAIJAL                           * 00304000
      *   PR# 5148D  ADDED LOGIC FOR COUNTING RFID UPC MISPACK EVEN   * 00305000
      *              WHEN THE QUANTITIES ON DB ARE 0.                 * 00306000
001900***************************************************************** 00310000
002000                                                                  00320000
002100******************************************************************00330000
002200 ENVIRONMENT DIVISION.                                            00340000
002300******************************************************************00350000
002400                                                                  00360000
002500 CONFIGURATION SECTION.                                           00370000
002600                                                                  00380000
002700 SOURCE-COMPUTER.        IBM-3090.                                00390000
002800 OBJECT-COMPUTER.        IBM-3090.                                00400000
002900                                                                  00410000
003000 INPUT-OUTPUT SECTION.                                            00420000
003100                                                                  00430000
003200 FILE-CONTROL.                                                    00440000
003300                                                                  00450000
003400     SELECT OS-VND-OVER-SHORT-FILE                                00460000
003500         ASSIGN TO INP01.                                         00470000
003600                                                                  00480000
003700     SELECT OS-RCVR-OVER-SHORT-FILE                               00490000
003800         ASSIGN TO INP02.                                         00500000
003900                                                                  00510000
      *SB 11/19/13 - BEGIN PR#5148D                                     00520000
           SELECT CARDIN-AUDIT-NBR-FILE                                 00530000
               ASSIGN TO CARDIN.                                        00540000
      *SB 11/19/13 - END PR#5148D                                       00550000
                                                                        00560000
004000     SELECT AS-AUDIT-SUM-EXTRACT-FILE                             00570000
004100         ASSIGN TO OUT01.                                         00580000
004200                                                                  00590000
004300******************************************************************00600000
004400 DATA DIVISION.                                                   00610000
004500******************************************************************00620000
004600                                                                  00630000
004700 FILE SECTION.                                                    00640000
004800                                                                  00650000
004900 FD  OS-VND-OVER-SHORT-FILE                                       00660000
005000     RECORDING MODE IS F                                          00670000
005100     LABEL RECORDS ARE STANDARD                                   00680000
005200     BLOCK CONTAINS 0 RECORDS.                                    00690000
005300                                                                  00700000
005400 01  OS-VND-OVER-SHORT-RECORD            PIC  X(200).             00710000
005500                                                                  00720000
005600 FD  OS-RCVR-OVER-SHORT-FILE                                      00730000
005700     RECORDING MODE IS F                                          00740000
005800     LABEL RECORDS ARE STANDARD                                   00750000
005900     BLOCK CONTAINS 0 RECORDS.                                    00760000
006000                                                                  00770000
006100 01  OS-RCVR-OVER-SHORT-RECORD           PIC  X(200).             00780000
006200                                                                  00790000
      *SB 11/19/13 - BEGIN PR#5148D                                     00800000
       FD  CARDIN-AUDIT-NBR-FILE                                        00810000
           LABEL RECORDS ARE STANDARD                                   00820000
           RECORDING MODE IS F                                          00830000
           BLOCK CONTAINS 0 RECORDS                                     00840000
           RECORD CONTAINS 80 CHARACTERS.                               00850000
       01  CC-RECORD                           PIC X(80).               00860000
      *SB 11/19/13 - END PR#5148D                                       00870000
                                                                        00880000
006300 FD  AS-AUDIT-SUM-EXTRACT-FILE                                    00890000
006400     RECORDING MODE IS F                                          00900000
006500     LABEL RECORDS ARE STANDARD                                   00910000
006600     BLOCK CONTAINS 0 RECORDS.                                    00920000
006700                                                                  00930000
006800 01  AS-AUDIT-SUM-EXTRACT-REC          PIC  X(200).               00940000
006900                                                                  00950000
007000                                                                  00960000
007100******************************************************************00970000
007200 WORKING-STORAGE SECTION.                                         00980000
007300******************************************************************00990000
007400                                                                  01000000
007500* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 01010000
007600*  RECORD LAYOUT FOR THE VENDOR OVER/SHORT FILE                   01020000
007700* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 01030000
007800 01  SU003-COPYBOOK.                                              01040000
007900     COPY SURD003.                                                01050000
008000                                                                  01060000
008100* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 01070000
008200*  RECORD LAYOUT FOR THE RECEIVER OVER/SHORT FILE               * 01080000
008300* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 01090000
008400 01  SU004-COPYBOOK.                                              01100000
008500     COPY SURD004.                                                01110000
008600                                                                  01120000
      *SB 11/19/13 - BEGIN PR#5148D                                     01130000
008000* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 01140000
008100*  RECORD LAYOUT FOR THE REPORT EXTRACT FILE                    * 01150000
008200* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 01160000
       01  CC-CARDIN.                                                   01170000
           05  CC-AUDIT-CNTL-NBR           PIC 9(09).                   01180000
           05  CC-CARTON-ID                PIC 9(18).                   01190000
           05  CC-SYSTEM-MANUAL-AUDIT      PIC X(01).                   01200000
               88  CC-SYSTEM-GENERATED-AUDIT    VALUE 'S'.              01210000
               88  CC-MANUAL-GENERATED-AUDIT    VALUE 'M'.              01220000
           05  CC-RFID-QC-AUDIT-IND        PIC X(01).                   01230000
               88  CC-RFID-AUDIT                VALUE 'R'.              01240000
               88  CC-QC-AUDIT                  VALUE 'S'.              01250000
           05  CC-RFID-QC-AUD-CMB-IND      PIC X(01).                   01260000
               88  CC-RFID-AUD-ONLY             VALUE 'R'.              01270000
               88  CC-QC-AUD-ONLY               VALUE 'S'.              01280000
               88  CC-QC-AND-RFID-AUD           VALUE 'B'.              01290000
      *SB 11/19/13 - END PR#5148D                                       01300000
                                                                        01310000
008700* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 01320000
008800*  RECORD LAYOUT FOR THE REPORT EXTRACT FILE                    * 01330000
008900* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 01340000
009000     COPY SURD005.                                                01350000
009100                                                                  01360000
009200*----------------------------------------------------------------*01370000
009300*  COPYBOOK FOR LOGISTICS DOMAIN ITEM ACCESS MODULE  WR # 21361  *01380000
009400*----------------------------------------------------------------*01390000
009500     COPY XLWS001.                                                01400000
009600*----------------------------------------------------------------*01410000
009700* CHANGES MADE FOR WR # 21361 ENDS HERE.                         *01420000
009800*----------------------------------------------------------------*01430000
009900                                                                  01440000
010000* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 01450000
010100*  WORK AREA FOR SQL ERROR ROUTINE 'DSNTIAR'                      01460000
010200* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 01470000
010300     COPY DPWS004.                                                01480000
010400                                                                  01490000
010500 01  ABEND-CODE                          PIC S9(04) VALUE +0      01500000
010600                                                     COMP SYNC.   01510000
010700                                                                  01520000
010800 01  PC-CONSTANTS.                                                01530000
010900     05  PC-ZERO                         PIC  9(01)  VALUE 0.     01540000
011000     05  PC-ONE                          PIC  9(01)  VALUE 1.     01550000
011100     05  PC-TWO                          PIC  9(01)  VALUE 2.     01560000
011200     05  PC-THREE                        PIC  9(01)  VALUE 3.     01570000
011300     05  PC-FOUR                         PIC  9(01)  VALUE 4.     01580000
011400     05  PC-EIGHT                        PIC  9(01)  VALUE 8.     01590000
011500     05  PC-NINE                         PIC  9(01)  VALUE 9.     01600000
011600     05  PC-E                            PIC  X(01)  VALUE 'E'.   01610000
011700     05  PC-KOHLS-OPERATING-COMPANY      PIC  X(02)  VALUE '03'.  01620000
011800     05  PC-CURRENT-PROGRAM-NAME         PIC  X(08)  VALUE        01630000
011900         'SUKUT015'.                                              01640000
012000     05  PC-CURRENT-JOB-NAME             PIC  X(08)  VALUE        01650000
012100         'SUK905  '.                                              01660000
012200     05  PC-PICKING-VILNS.                                        01670000
012300         10  PC-STYLE-SUB-VILN           PIC S9(4)   COMP         01680000
012400                                                     VALUE 9.     01690000
012500         10  PC-NO-DC-OTR-VILN           PIC S9(4)   COMP         01700000
012600                                                     VALUE 10.    01710000
012700         10  PC-NO-PBS-ALLOC-VILN        PIC S9(4)   COMP         01720000
012800                                                     VALUE 11.    01730000
012900         10  PC-DMGD-MDSE-VILN           PIC S9(4)   COMP         01740000
013000                                                     VALUE 20.    01750000
013100     05  PC-TICKETING-VILNS.                                      01760000
013200         10  PC-NO-BARCODE-VILN          PIC S9(4)   COMP         01770000
013300                                                     VALUE 3.     01780000
013400         10  PC-DMGD-BARCODE-VILN        PIC S9(4)   COMP         01790000
013500                                                     VALUE 4.     01800000
013600         10  PC-NO-UPC-VILN              PIC S9(4)   COMP         01810000
013700                                                     VALUE 5.     01820000
013800         10  PC-UPC-NOT-FOUND-VILN       PIC S9(4)   COMP         01830000
013900                                                     VALUE 6.     01840000
014000         10  PC-SKU-NOT-FOUND-VILN       PIC S9(4)   COMP         01850000
014100                                                     VALUE 7.     01860000
014200         10  PC-NO-TAG-TICKET-VILN       PIC S9(4)   COMP         01870000
014300                                                     VALUE 8.     01880000
014400         10  PC-WRONG-DEPT-TKT-VILN      PIC S9(4)   COMP         01890000
014500                                                     VALUE 13.    01900000
014600         10  PC-WRONG-RETAIL-TKT-VILN    PIC S9(4)   COMP         01910000
014700                                                     VALUE 14.    01920000
014800         10  PC-WRONG-COLOR-TKT-VILN     PIC S9(4)   COMP         01930000
014900                                                     VALUE 15.    01940000
015000         10  PC-WRONG-SIZE-TKT-VILN      PIC S9(4)   COMP         01950000
015100                                                     VALUE 16.    01960000
015200         10  PC-WRONG-RETAIL-MDSE-VILN   PIC S9(4)   COMP         01970000
015300                                                     VALUE 17.    01980000
015400         10  PC-WRONG-COLOR-MDSE-VILN    PIC S9(4)   COMP         01990000
015500                                                     VALUE 18.    02000000
015600         10  PC-WRONG-SIZE-MDSE-VILN     PIC S9(4)   COMP         02010000
015700                                                     VALUE 19.    02020000
015800         10  PC-WRONG-CLASS-TKT-VILN     PIC S9(4)   COMP         02030000
015900                                                     VALUE 21.    02040000
016000         10  PC-WRONG-SKU-TKT-VILN       PIC S9(4)   COMP         02050000
016100                                                     VALUE 22.    02060000
016200         10  PC-SIZE-STRIP-MDSE-VILN     PIC S9(4)   COMP         02070000
016300                                                     VALUE 23.    02080000
016400         10  PC-WRONG-STYLE-TKT-VILN     PIC S9(4)   COMP         02090000
016500                                                     VALUE 24.    02100000
016600         10  PC-WRONG-STYLE-MDSE-VILN    PIC S9(4)   COMP         02110000
016700                                                     VALUE 25.    02120000
016800         10  PC-WRG-BOX-ID               PIC S9(4)   COMP         02130000
016900                                                     VALUE 26.    02140000
017000         10  PC-WRG-TKT-MDSE-OK-VILN     PIC S9(4)   COMP         02150000
017100                                                     VALUE 27.    02160000
017200         10  PC-NO-TAG-VILN              PIC S9(4)   COMP         02170000
017300                                                     VALUE 28.    02180000
      *SB 11/15/13 - BEGIN PR#5148D                                     02190000
013100     05  PC-RFID-VILNS.                                           02200000
013400         10  PC-RFID-UPC-MISPCK          PIC S9(4)   COMP         02210000
013500                                                     VALUE 38.    02220000
013400         10  PC-RFID-TKT-CLR             PIC S9(4)   COMP         02230000
013500                                                     VALUE 39.    02240000
013600         10  PC-RFID-TKT-SIZE            PIC S9(4)   COMP         02250000
013700                                                     VALUE 40.    02260000
013800         10  PC-RFID-TKT-STYLE           PIC S9(4)   COMP         02270000
013900                                                     VALUE 41.    02280000
014000         10  PC-RFID-NO-TICKET           PIC S9(4)   COMP         02290000
014100                                                     VALUE 42.    02300000
      *SB 11/15/13 - END PR#5148D                                       02310000
017400                                                                  02320000
017500 01  CK-CURRENT-KEY-AREA.                                         02330000
017600     05  CK-BUYER-NBR                    PIC  X(03)  VALUE SPACES.02340000
017700     05  CK-STATUS-CHG-DTE               PIC  X(10)  VALUE SPACES.02350000
017800     05  CK-DEPT-NBR                     PIC  X(03)  VALUE SPACES.02360000
017900     05  CK-VND-NBR                      PIC  X(09)  VALUE SPACES.02370000
018000     05  CK-DFCT-ORD-ID                  PIC  X(06)  VALUE SPACES.02380000
018100                                                                  02390000
018200 01  DA-DISPLAY-AREAS.                                            02400000
018300     05  DA-SORT-RECORD-COUNT            PIC  ZZZ,ZZZ,ZZ9         02410000
018400                                                     VALUE ZERO.  02420000
018500                                                                  02430000
018600 01  PS-PROGRAM-SWITCHES.                                         02440000
018700     05  PS-END-OF-TICKETING-CURSOR-IND  PIC  X(01)  VALUE 'N'.   02450000
018800         88  PS-END-OF-TICKETING-CURSOR              VALUE 'Y'.   02460000
018900         88  PS-NOT-END-OF-TICKETING-CURSOR          VALUE 'N'.   02470000
019000     05  PS-END-OF-PICKING-CURSOR-IND    PIC  X(01)  VALUE 'N'.   02480000
019100         88  PS-END-OF-PICKING-CURSOR                VALUE 'Y'.   02490000
019200         88  PS-NOT-END-OF-PICKING-CURSOR            VALUE 'N'.   02500000
      *SB 11/15/13 - BEGIN PR#5148D                                     02510000
019000     05  PS-END-OF-RFID-CURSOR-IND       PIC  X(01)  VALUE 'N'.   02520000
019100         88  PS-END-OF-RFID-CURSOR                   VALUE 'Y'.   02530000
019200         88  PS-NOT-END-OF-RFID-CURSOR               VALUE 'N'.   02540000
           05  PS-END-OF-CARDIN-SW             PIC  X(01)  VALUE 'N'.   02550000
               88  PS-END-OF-CARDIN-FILE                   VALUE 'Y'.   02560000
               88  PS-NOT-END-OF-CARDIN-FILE               VALUE 'N'.   02570000
      *SB 11/15/13 - END PR#5148D                                       02580000
019300     05  PS-EOF-VND-OVER-SHORT-IND       PIC  X(01)  VALUE 'N'.   02590000
019400         88  PS-EOF-VND-OVER-SHORT                   VALUE 'Y'.   02600000
019500         88  PS-NOT-EOF-VND-OVER-SHORT               VALUE 'N'.   02610000
019600     05  PS-EOF-RCVR-OVER-SHORT-IND      PIC  X(01)  VALUE 'N'.   02620000
019700         88  PS-EOF-RCVR-OVER-SHORT                  VALUE 'Y'.   02630000
019800         88  PS-NOT-EOF-RCVR-OVER-SHORT              VALUE 'N'.   02640000
019900     05  PS-CREATE-OVER-IND              PIC  X(01)  VALUE 'N'.   02650000
020000         88  PS-CREATE-OVER                          VALUE 'Y'.   02660000
020100         88  PS-DONT-CREATE-OVER                     VALUE 'N'.   02670000
020200     05  PS-USE-FILE-IND                 PIC  X(01)  VALUE 'V'.   02680000
020300         88  PS-USE-VND-OS-ONLY                      VALUE 'V'.   02690000
020400         88  PS-USE-RCVR-OS-ONLY                     VALUE 'R'.   02700000
020500         88  PS-USE-BOTH-FILES                       VALUE 'B'.   02710000
020600                                                                  02720000
020700*----------------------------------------------------------------*02730000
020800*  DK-SKU-NBR-DEPT,DK-SKU-NBR-CLASS AND DK-SKU-NBR-SEQ HAS BEEN  *02740000
020900*  REMOVED.                                          WR # 21361  *02750000
021000*----------------------------------------------------------------*02760000
021100 01  DK-DB2-KEY-VALUE.                                            02770000
021200     05  DK-AUD-CNTL-NBR                 PIC S9(09)  COMP.        02780000
021300     05  DK-PO-NBR                       PIC S9(09)  COMP.        02790000
021400     05  DK-REC-SEQ-NBR                  PIC S9(09)  COMP.        02800000
021500     05  DK-UPC-NBR                      PIC S9(15)V COMP-3.      02810000
021600     05  DK-SKU-NBR                      PIC  X(08).              02820000
021700     05  DK-SCAN-TMST                    PIC  X(26).              02830000
021700     05  DK-SKU-NUMBER                   PIC S9(08)V COMP-3.      02840000
021800*----------------------------------------------------------------*02850000
021900* CHANGES MADE FOR WR # 21361 ENDS HERE.                         *02860000
022000*----------------------------------------------------------------*02870000
022100                                                                  02880000
022200*----------------------------------------------------------------*02890000
022300*  PV-HOLD-SKU-NBR HAVE BEEN MOVED TO 05 LEVEL AND DECLARED AS   *02900000
022400*  9(08).                                          WR # 21361    *02910000
022500*----------------------------------------------------------------*02920000
022600 01  PV-PROGRAM-VARIABLES.                                        02930000
022700     05  PV-HOLD-AUD-CNTL-NBR            PIC S9(09)  COMP.        02940000
022800     05  PV-HOLD-PO-NBR                  PIC S9(09)  COMP.        02950000
022900     05  PV-HOLD-REC-SEQ-NBR             PIC S9(09)  COMP.        02960000
023000     05  PV-HOLD-UPC-NBR                 PIC S9(15)V COMP-3.      02970000
023100     05  PV-HOLD-SKU-DPT-NBR             PIC  X(03).              02980000
023200     05  PV-HOLD-SKU-CLASS-NBR           PIC  X(02).              02990000
023300     05  PV-HOLD-SKU-NBR                 PIC  9(08).              03000000
023310     05  PV-DISP-UPC                     PIC  Z(15).              03010000
023320     05  PV-DISP-AUD-CNTL-NBR            PIC  Z(10).              03020000
023330     05  PV-DISP-PO                      PIC  Z(08).              03030000
023340     05  PV-DISP-RCVR                    PIC  9(05).              03040000
023400*----------------------------------------------------------------*03050000
023500* CHANGES MADE FOR WR # 21361 ENDS HERE.                         *03060000
023600*----------------------------------------------------------------*03070000
023700     05  PV-DB2-COUNT                    PIC S9(09)  VALUE +0     03080000
023800                                                     COMP.        03090000
      *SB 01/09/14 - BEGIN PR#5148D                                     03100000
023700     05  PV-RFID-COUNT                   PIC S9(09)  VALUE +0     03110000
023800                                                     COMP.        03120000
      *SB 01/09/14 - END PR#5148D                                       03130000
823900     05  PV-HOLD-TMST                    PIC  X(26)  VALUE SPACES.03140000
024000     05  PV-CURR-TMST                    PIC  X(26)  VALUE SPACES.03150000
024100     05  PV-CURR-DEPT                    PIC  X(03)  VALUE SPACES.03160000
024200     05  PV-PREV-DEPT                    PIC  X(03)  VALUE SPACES.03170000
024300     05  PV-FIELD-NAME                   PIC  X(30)  VALUE SPACES.03180000
024400     05  PV-COMMIT-TMST                  PIC  X(26)  VALUE SPACES.03190000
024500     05  PV-SORT-RETURN                  PIC  9(02)  VALUE ZERO.  03200000
024600     05  PV-DISPLAY-COMP                 PIC  9(18).              03210000
024700     05  PV-UNITS-AUDITED                PIC S9(09) COMP.         03220000
024800     05  PV-DETAIL-PAGE-COUNT            PIC S9(04)  VALUE +0     03230000
024900                                                     COMP SYNC.   03240000
025000     05  PV-DETAIL-LINE-COUNT            PIC S9(04)  VALUE +0     03250000
025100                                                     COMP.        03260000
025200     05  PV-SUM-PAGE-COUNT               PIC S9(04)  VALUE +0     03270000
025300                                                     COMP.        03280000
025400     05  PV-SUM-LINE-COUNT               PIC S9(04)  VALUE +0     03290000
025500                                                     COMP.        03300000
025600     05  PV-ADVANCE-COUNT                PIC S9(04)  VALUE +0     03310000
025700                                                     COMP.        03320000
025800     05  PV-TOTAL-APPROVED-DOLLARS       PIC S9(09)V9(02)         03330000
025900                                                     VALUE +0     03340000
026000                                                     COMP-3.      03350000
026100     05  PV-TOTAL-DECLINED-DOLLARS       PIC S9(09)V9(02)         03360000
026200                                                     VALUE +0     03370000
026300                                                     COMP-3.      03380000
026400     05  PV-TOTAL-APPROVED-REFERRALS     PIC  9(09)  VALUE ZEROS  03390000
026500                                                     COMP-3.      03400000
026600     05  PV-TOTAL-DECLINED-REFERRALS     PIC  9(09)  VALUE ZEROS  03410000
026700                                                     COMP-3.      03420000
026800     05  PV-DOLLARS                      PIC  9(04)V9(02)         03430000
026900                                                     VALUE ZEROS. 03440000
027000                                                                  03450000
027100     05  PV-PARAGRAPH-NAME               PIC  X(30)  VALUE SPACE. 03460000
027200     05  PV-DB2-OPERATION-ATTEMPTED      PIC  X(30)  VALUE SPACE. 03470000
027300     05  PV-DB2-OPER-UNT-ID              PIC  X(03).              03480000
027400     05  PV-START-DATE.                                           03490000
027500         10  PV-START-MONTH              PIC  9(02).              03500000
027600         10  FILLER                      PIC  X(01) VALUE '/'.    03510000
027700         10  PV-START-DAY                PIC  9(02).              03520000
027800         10  FILLER                      PIC  X(01) VALUE '/'.    03530000
027900         10  PV-START-CENTURY            PIC  9(02).              03540000
028000         10  PV-START-YEAR               PIC  9(02).              03550000
028100     05  PV-END-DATE.                                             03560000
028200         10  PV-END-MONTH                PIC  9(02).              03570000
028300         10  FILLER                      PIC  X(01) VALUE '/'.    03580000
028400         10  PV-END-DAY                  PIC  9(02).              03590000
028500         10  FILLER                      PIC  X(01) VALUE '/'.    03600000
028600         10  PV-END-CENTURY              PIC  9(02).              03610000
028700         10  PV-END-YEAR                 PIC  9(02).              03620000
028800     05  PV-WORK-DATE.                                            03630000
028900         10  PV-WORK-MONTH               PIC  9(02).              03640000
029000         10  FILLER                      PIC  X(01) VALUE '/'.    03650000
029100         10  PV-WORK-DAY                 PIC  9(02).              03660000
029200         10  FILLER                      PIC  X(01) VALUE '/'.    03670000
029300         10  PV-WORK-YEAR                PIC  9(02).              03680000
029400     05  PV-AUDIT-TYPE                   PIC  X(02)  VALUE SPACE. 03690000
029500         88  PV-100-AUDIT-CHECK          VALUE '01'.              03700000
029600         88  PV-SPOT-AUDIT-CHECK         VALUE '02'.              03710000
029700         88  PV-REWORK-AUDIT-CHECK       VALUE '03'.              03720000
029800     05  PV-AUDIT-STATUS                 PIC  X(02)  VALUE SPACE. 03730000
029900         88  PV-AUDIT-INPROCESS          VALUE 'IP'.              03740000
030000         88  PV-AUDIT-COMPLETE           VALUE 'CM'.              03750000
030100         88  PV-AUDIT-POSTPONE           VALUE 'PP'.              03760000
030200     05  PV-TICKET-BUCKETS.                                       03770000
030300         10 PV-TICKET-DAMAGED-BARCODE    PIC S9(04) COMP          03780000
030400                                                    VALUE ZERO.   03790000
030500         10 PV-TICKET-NO-BARCODE         PIC S9(04) COMP          03800000
030600                                                    VALUE ZERO.   03810000
030700         10 PV-TICKET-NO-UPC             PIC S9(04) COMP          03820000
030800                                                    VALUE ZERO.   03830000
030900         10 PV-TICKET-WRONG-UPC          PIC S9(04) COMP          03840000
031000                                                    VALUE ZERO.   03850000
031100         10 PV-TICKET-WRONG-TICKET       PIC S9(04) COMP          03860000
031200                                                    VALUE ZERO.   03870000
031300         10 PV-TICKET-MISSING-TICKET     PIC S9(04) COMP          03880000
031400                                                    VALUE ZERO.   03890000
031500         10 PV-TICKET-WRONG-LABEL        PIC S9(04) COMP          03900000
031600                                                    VALUE ZERO.   03910000
031700         10 PV-TOT-TIC-ERR               PIC S9(04) COMP          03920000
031800                                                    VALUE ZERO.   03930000
031900         10 PV-TOT-UNITS-IN-TIC-ERR      PIC S9(04) COMP          03940000
032000                                                    VALUE ZERO.   03950000
      *SB 11/15/13 - BEGIN PR#5148D                                     03960000
030200     05  PV-RFID-BUCKETS.                                         03970000
030300         10 PV-RFID-TKT-NO-EPC           PIC S9(04) COMP          03980000
030400                                                    VALUE ZERO.   03990000
030500         10 PV-RFID-TKT-CLR              PIC S9(04) COMP          04000000
030600                                                    VALUE ZERO.   04010000
030700         10 PV-RFID-TKT-SIZE             PIC S9(04) COMP          04020000
030800                                                    VALUE ZERO.   04030000
030900         10 PV-RFID-TKT-STYLE            PIC S9(04) COMP          04040000
031000                                                    VALUE ZERO.   04050000
031100         10 PV-RFID-NO-TICKET            PIC S9(04) COMP          04060000
031200                                                    VALUE ZERO.   04070000
031700         10 PV-TOT-RFID-ERR              PIC S9(04) COMP          04080000
031800                                                    VALUE ZERO.   04090000
031900         10 PV-TOT-UNITS-IN-RFID-ERR     PIC S9(04) COMP          04100000
032400                                                    VALUE ZERO.   04110000
      *SB 11/15/13 - END PR#5148D                                       04120000
032100*----------------------------------------------------------------*04130000
032200* ADDED NEW VARIABLES                          ** WR # 21361     *04140000
032300*----------------------------------------------------------------*04150000
032400     05  PV-ABEND-PARAGRAPH          PIC  X(30)    VALUE SPACES.  04160000
032500     05  PV-ABEND-CODE               PIC S9(04)    VALUE ZERO     04170000
032600                                                   COMP SYNC.     04180000
032700     05  PV-ABEND.                                                04190000
032800         10  PV-ABEND-MESSAGE-TEXT   PIC  X(40)    VALUE SPACES.  04200000
032900         10  PV-SQLCODE              PIC  S9(9)    VALUE ZEROES.  04210000
033000         10  PV-DB2-VIEW-NAME        PIC  X(10)    VALUE SPACES.  04220000
033100*----------------------------------------------------------------*04230000
033200* CHANGES MADE FOR WR # 21361 ENDS HERE.                         *04240000
033300*----------------------------------------------------------------*04250000
033400                                                                  04260000
033500 01  SD-SYSTEM-DATE.                                              04270000
033600     05  SD-SYSTEM-YEAR                  PIC  9(02)  VALUE ZEROS. 04280000
033700     05  SD-SYSTEM-MONTH                 PIC  9(02)  VALUE ZEROS. 04290000
033800     05  SD-SYSTEM-DAY                   PIC  9(02)  VALUE ZEROS. 04300000
033900                                                                  04310000
034000*                                                                 04320000
034100******************************************************************04330000
034200*  DB2 COMMUNICATION AREA.                                        04340000
034300******************************************************************04350000
034400     EXEC SQL                                                     04360000
034500          INCLUDE SQLCA                                           04370000
034600     END-EXEC.                                                    04380000
034700*                                                                 04390000
034800*                                                                 04400000
034900******************************************************************04410000
035000*  DB2 TABLE COBOL WORKING STORAGE AREA FOR THE SHIPPING UNIT     04420000
035100*  AUDIT TRANSATIONS TABLE                                        04430000
035200******************************************************************04440000
035300     EXEC SQL                                                     04450000
035400          INCLUDE TSUATRN                                         04460000
035500     END-EXEC.                                                    04470000
035600*                                                                 04480000
035700*                                                                 04490000
035800******************************************************************04500000
035900*  DB2 TABLE COBOL WORKING STORAGE AREA FOR THE SHIPPING UNIT     04510000
036000*  AUDIT CONTENT TABLE                                            04520000
036100******************************************************************04530000
036200     EXEC SQL                                                     04540000
036300          INCLUDE TSUAUPC                                         04550000
036400     END-EXEC.                                                    04560000
036500*                                                                 04570000
036600*                                                                 04580000
036700******************************************************************04590000
036800*  DB2 TABLE COBOL WORKING STORAGE AREA FOR THE SHIPPING UNIT     04600000
036900*  AUDIT EXCEPTIONS TABLE                                         04610000
037000******************************************************************04620000
037100     EXEC SQL                                                     04630000
037200          INCLUDE TSUEXCP                                         04640000
037300     END-EXEC.                                                    04650000
037400                                                                  04660000
037500 EJECT                                                            04670000
037600******************************************************************04680000
037700*  DB2 TABLE COBOL WORKING STORAGE AREA                           04690000
037800******************************************************************04700000
037900* REMOVED DCLGEN OF TUPCSKU FOR WR # 21361                        04710000
038000                                                                  04720000
038100* REMOVED DCLGEN OF TSK FOR WR # 21361                            04730000
038200                                                                  04740000
038300***************************************************************** 04750000
038400******************************************************************04760000
038500*  DB2 TABLE COBOL WORKING STORAGE AREA                           04770000
038600******************************************************************04780000
038700     EXEC SQL                                                     04790000
038800          INCLUDE TRECDIS                                         04800000
038900     END-EXEC.                                                    04810000
039000                                                                  04820000
039100                                                                  04830000
039200******************************************************************04840000
039300*  DB2 TABLE COBOL WORKING STORAGE AREA                           04850000
039400******************************************************************04860000
039500     EXEC SQL                                                     04870000
039600          INCLUDE TPURITM                                         04880000
039700     END-EXEC.                                                    04890000
039800                                                                  04900000
039900******************************************************************04910000
040000*  DB2 TABLE COBOL WORKING STORAGE AREA                           04920000
040100******************************************************************04930000
040200     EXEC SQL                                                     04940000
040300          INCLUDE TPURCHS                                         04950000
040400     END-EXEC.                                                    04960000
040500                                                                  04970000
040600***************************************************************** 04980000
040700*    DECLARE PICKING CURSOR -- THIS CURSOR WILL RETRIEVE ALL      04990000
040800*    THE PICKING EXCEPTIONS FOR A CERTAIN AUDIT/RECEIVER/UPC      05000000
040900***************************************************************** 05010000
041000     EXEC SQL                                                     05020000
041100         DECLARE PICKING_CURSOR CURSOR FOR                        05030000
041200         SELECT                                                   05040000
041300                 C.SCN_TMST                                       05050000
041400              ,  C.VILN_GP_SEQ_NBR                                05060000
      *VSH 02/01/14 - BEGIN PR#5148D                                    05070000
038900*             ,  COUNT(*)                                         05080000
038900              ,  SUM(B.SCND_UNT_QTY)                              05090000
      *VSH 02/01/14 - END PR#5148D                                      05100000
041600         FROM                                                     05110000
041700                TSUATRN A                                         05120000
041800             ,  TSUAUPC B                                         05130000
041900             ,  TSUEXCP C                                         05140000
042000         WHERE                                                    05150000
042100             A.AUD_CNTL_NBR     = :DK-AUD-CNTL-NBR                05160000
042200         AND B.UPC_NBR          = :DK-UPC-NBR                     05170000
042300         AND A.TRN_NBR          = :DK-PO-NBR                      05180000
042400         AND A.REC_SEQ_NBR      = :DK-REC-SEQ-NBR                 05190000
042500         AND A.AUD_CNTL_NBR     = B.AUD_CNTL_NBR                  05200000
042600         AND A.SHIPT_UNT_ID     = B.SHIPT_UNT_ID                  05210000
042700         AND B.AUD_CNTL_NBR     = C.AUD_CNTL_NBR                  05220000
042800         AND B.SHIPT_UNT_ID     = C.SHIPT_UNT_ID                  05230000
042900         AND B.UPC_NBR          = C.UPC_NBR                       05240000
043000         AND B.SCN_TMST         = C.SCN_TMST                      05250000
043100         AND B.SCN_TYP_CDE     <> :PC-E                           05260000
043200         AND C.VILN_GP_SEQ_NBR IN (                               05270000
043300              :PC-STYLE-SUB-VILN                                  05280000
043400             ,:PC-NO-DC-OTR-VILN                                  05290000
043500             ,:PC-NO-PBS-ALLOC-VILN                               05300000
043600             ,:PC-DMGD-MDSE-VILN )                                05310000
043700        GROUP BY C.VILN_GP_SEQ_NBR                                05320000
043800              ,  C.UPC_NBR                                        05330000
043900              ,  C.SCN_TMST                                       05340000
044000     END-EXEC.                                                    05350000
044100                                                                  05360000
044200***************************************************************** 05370000
044300*    DECLARE TICKETING CURSOR -- THIS CURSOR WILL RETRIEVE ALL    05380000
044400*    THE TICKETING EXCEPTIONS FOR A CERTAIN AUDIT/RCVR/UPC        05390000
044500***************************************************************** 05400000
044600     EXEC SQL                                                     05410000
044700         DECLARE TICKETING_CURSOR CURSOR FOR                      05420000
044800         SELECT                                                   05430000
044900                 C.SCN_TMST                                       05440000
045000              ,  C.VILN_GP_SEQ_NBR                                05450000
      *VSH 02/01/14 - BEGIN PR#5148D                                    05460000
038900*             ,  COUNT(*)                                         05470000
038900              ,  SUM(B.SCND_UNT_QTY)                              05480000
      *VSH 02/01/14 - END PR#5148D                                      05490000
045200         FROM                                                     05500000
045300                TSUATRN A                                         05510000
045400             ,  TSUAUPC B                                         05520000
045500             ,  TSUEXCP C                                         05530000
045600         WHERE                                                    05540000
045700             A.AUD_CNTL_NBR     = :DK-AUD-CNTL-NBR                05550000
045800         AND C.UPC_NBR          = :DK-UPC-NBR                     05560000
045900         AND A.TRN_NBR          = :DK-PO-NBR                      05570000
046000         AND A.REC_SEQ_NBR      = :DK-REC-SEQ-NBR                 05580000
046100         AND A.AUD_CNTL_NBR     = B.AUD_CNTL_NBR                  05590000
046200         AND A.SHIPT_UNT_ID     = B.SHIPT_UNT_ID                  05600000
046300         AND B.AUD_CNTL_NBR     = C.AUD_CNTL_NBR                  05610000
046400         AND B.SHIPT_UNT_ID     = C.SHIPT_UNT_ID                  05620000
046500         AND B.UPC_NBR          = C.UPC_NBR                       05630000
046600         AND B.SCN_TMST         = C.SCN_TMST                      05640000
046700         AND B.SCN_TYP_CDE     <> :PC-E                           05650000
046800         AND C.VILN_GP_SEQ_NBR IN  (                              05660000
046900              :PC-NO-BARCODE-VILN                                 05670000
047000             ,:PC-DMGD-BARCODE-VILN                               05680000
047100             ,:PC-NO-UPC-VILN                                     05690000
047200             ,:PC-UPC-NOT-FOUND-VILN                              05700000
047300             ,:PC-SKU-NOT-FOUND-VILN                              05710000
047400             ,:PC-NO-TAG-TICKET-VILN                              05720000
047500             ,:PC-WRONG-DEPT-TKT-VILN                             05730000
047600             ,:PC-WRONG-RETAIL-TKT-VILN                           05740000
047700             ,:PC-WRONG-COLOR-TKT-VILN                            05750000
047800             ,:PC-WRONG-SIZE-TKT-VILN                             05760000
047900             ,:PC-WRONG-RETAIL-MDSE-VILN                          05770000
048000             ,:PC-WRONG-COLOR-MDSE-VILN                           05780000
048100             ,:PC-WRONG-SIZE-MDSE-VILN                            05790000
048200             ,:PC-WRONG-CLASS-TKT-VILN                            05800000
048300             ,:PC-SIZE-STRIP-MDSE-VILN                            05810000
048400             ,:PC-WRONG-SKU-TKT-VILN                              05820000
048500             ,:PC-WRONG-STYLE-TKT-VILN                            05830000
048600             ,:PC-WRONG-STYLE-MDSE-VILN                           05840000
048800             ,:PC-WRG-TKT-MDSE-OK-VILN                            05850000
042500             ,:PC-WRG-BOX-ID                                      05860000
048900             ,:PC-NO-TAG-VILN)                                    05870000
049000        GROUP BY C.VILN_GP_SEQ_NBR                                05880000
049100              ,  C.UPC_NBR                                        05890000
049200              ,  C.SCN_TMST                                       05900000
049300     END-EXEC.                                                    05910000
049500                                                                  05920000
      *SB 11/15/13 - BEGIN PR#5148D                                     05930000
044200***************************************************************** 05940000
044300*    DECLARE RFID CURSOR -- THIS CURSOR WILL RETRIEVE ALL THE     05950000
044400*    RFID EXCEPTIONS FOR A CERTAIN AUDIT/RCVR/UPC                 05960000
044500***************************************************************** 05970000
044600     EXEC SQL                                                     05980000
044700         DECLARE RFID_CURSOR CURSOR FOR                           05990000
044800         SELECT                                                   06000000
044900                 C.SCN_TMST                                       06010000
045000              ,  C.VILN_GP_SEQ_NBR                                06020000
045100              ,  SUM(SCND_UNT_QTY)                                06030000
045100              ,  SUM(RFID_TGD_QTY)                                06040000
045200         FROM                                                     06050000
045300                TSUATRN A                                         06060000
045400             ,  TSUAUPC B                                         06070000
045500             ,  TSUEXCP C                                         06080000
045600         WHERE                                                    06090000
045700             A.AUD_CNTL_NBR     = :DK-AUD-CNTL-NBR                06100000
045800         AND C.UPC_NBR          = :DK-UPC-NBR                     06110000
045900         AND A.TRN_NBR          = :DK-PO-NBR                      06120000
046000         AND A.REC_SEQ_NBR      = :DK-REC-SEQ-NBR                 06130000
046100         AND A.AUD_CNTL_NBR     = B.AUD_CNTL_NBR                  06140000
046200         AND A.SHIPT_UNT_ID     = B.SHIPT_UNT_ID                  06150000
046300         AND B.AUD_CNTL_NBR     = C.AUD_CNTL_NBR                  06160000
046400         AND B.SHIPT_UNT_ID     = C.SHIPT_UNT_ID                  06170000
046500         AND B.UPC_NBR          = C.UPC_NBR                       06180000
046600         AND B.SCN_TMST         = C.SCN_TMST                      06190000
046600         AND C.SCN_TMST         >= A.UNT_AUD_STRT_TMST            06200000
046700         AND B.SCN_TYP_CDE     <> :PC-E                           06210000
046800         AND C.VILN_GP_SEQ_NBR IN  (                              06220000
                    :PC-RFID-UPC-MISPCK                                 06230000
047100             ,:PC-RFID-TKT-CLR                                    06240000
047300             ,:PC-RFID-TKT-SIZE                                   06250000
047500             ,:PC-RFID-TKT-STYLE)                                 06260000
049000        GROUP BY C.VILN_GP_SEQ_NBR                                06270000
049100              ,  C.UPC_NBR                                        06280000
049200              ,  C.SCN_TMST                                       06290000
                                                                        06300000
                                                                        06310000
              UNION                                                     06320000
                                                                        06330000
044800        (SELECT                                                   06340000
044900                 C.SCN_TMST                                       06350000
045000              ,  C.VILN_GP_SEQ_NBR                                06360000
045100              ,  SUM(SCND_UNT_QTY) AS QTY                         06370000
045100              ,  SUM(RFID_TGD_QTY) AS QTY1                        06380000
045200         FROM                                                     06390000
045300                TSUATRN A                                         06400000
045400             ,  TSUAUPC B                                         06410000
045500             ,  TSUEXCP C                                         06420000
045600         WHERE                                                    06430000
045700             A.AUD_CNTL_NBR     = :DK-AUD-CNTL-NBR                06440000
045800         AND C.UPC_NBR          = :DK-UPC-NBR                     06450000
045900         AND A.TRN_NBR          = :DK-PO-NBR                      06460000
046000         AND A.REC_SEQ_NBR      = :DK-REC-SEQ-NBR                 06470000
046100         AND A.AUD_CNTL_NBR     = B.AUD_CNTL_NBR                  06480000
046200         AND A.SHIPT_UNT_ID     = B.SHIPT_UNT_ID                  06490000
046300         AND B.AUD_CNTL_NBR     = C.AUD_CNTL_NBR                  06500000
046400         AND B.SHIPT_UNT_ID     = C.SHIPT_UNT_ID                  06510000
046500         AND B.UPC_NBR          = C.UPC_NBR                       06520000
046600         AND B.SCN_TMST         = C.SCN_TMST                      06530000
046600         AND C.SCN_TMST         >= A.UNT_AUD_STRT_TMST            06540000
046700         AND B.SCN_TYP_CDE      = :PC-E                           06550000
046800         AND C.VILN_GP_SEQ_NBR  = :PC-RFID-NO-TICKET              06560000
049000        GROUP BY C.VILN_GP_SEQ_NBR                                06570000
049100              ,  C.UPC_NBR                                        06580000
049200              ,  C.SCN_TMST                                       06590000
                                                                        06600000
              )                                                         06610000
                                                                        06620000
049300     END-EXEC.                                                    06630000
      *SB 11/15/13 - END PR#5148D                                       06640000
                                                                        06650000
049400 EJECT                                                            06660000
049600* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 06670000
049700 PROCEDURE DIVISION.                                              06680000
049800* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 06690000
049900                                                                  06700000
050000******************************************************************06710000
050100*  0000-MAINLINE - CONTROLS THE MAIN PROCESSING OF THE PROGRAM    06720000
050200******************************************************************06730000
050300 0000-PROGRAM-MAINLINE.                                           06740000
050400                                                                  06750000
050500     PERFORM 1000-INITIALIZE.                                     06760000
050600                                                                  06770000
050700     PERFORM 2000-CREATE-FILE                                     06780000
050800         UNTIL PS-EOF-VND-OVER-SHORT                              06790000
050900           AND PS-EOF-RCVR-OVER-SHORT                             06800000
051000                                                                  06810000
051100     PERFORM 9000-EOJ-ROUTINE.                                    06820000
051200     STOP RUN.                                                    06830000
051300*0000-EXIT.                                                       06840000
051400                                                                  06850000
051500******************************************************************06860000
051600*  1000-INITIALIZE                                                06870000
051700*       - ACCEPTS, EDITS, AND DISPLAYS THE CONTROL CARD.          06880000
051800*       - OPEN ALL INPUT/OUTPUT FILES                             06890000
051900*       - SELECT ALL HEADER INFORMATION                           06900000
052000******************************************************************06910000
052100 1000-INITIALIZE.                                                 06920000
052200                                                                  06930000
052300     INITIALIZE SU005-EXTRACT-RECORD.                             06940000
052400                                                                  06950000
052500     SET SU005-CASEPACK-AUDIT      TO TRUE.                       06960000
      *SB 11/19/13 - BEGIN PR#5148D                                     06970000
           SET PS-NOT-END-OF-CARDIN-FILE TO TRUE.                       06980000
      *SB 11/19/13 - END PR#5148D                                       06990000
052600**                                                                07000000
052700     OPEN INPUT  OS-VND-OVER-SHORT-FILE                           07010000
052800                 OS-RCVR-OVER-SHORT-FILE                          07020000
      *SB 11/19/13 - BEGIN PR#5148D                                     07030000
                       CARDIN-AUDIT-NBR-FILE                            07040000
      *SB 11/19/13 - END PR#5148D                                       07050000
052900          OUTPUT AS-AUDIT-SUM-EXTRACT-FILE                        07060000
053000                                                                  07070000
053100     SET  PS-NOT-EOF-VND-OVER-SHORT        TO TRUE.               07080000
053200     SET  PS-NOT-EOF-RCVR-OVER-SHORT       TO TRUE.               07090000
053300                                                                  07100000
053400     PERFORM 8000-READ-VND-OVER-SHORT.                            07110000
053500     PERFORM 8001-READ-RCVR-OVER-SHORT.                           07120000
053600                                                                  07130000
      *SB 11/19/13 - BEGIN PR#5148D                                     07140000
           PERFORM 8200-READ-CARDIN-FILE.                               07150000
           IF PS-END-OF-CARDIN-FILE                                     07160000
              DISPLAY '** SUKUT015 ABEND **'                            07170000
              DISPLAY '** CARDIN (AUDIT NUMBER) FILE IS EMPTY **'       07180000
              MOVE +4019                  TO PV-ABEND-CODE              07190000
              CALL 'ILBOABN0' USING PV-ABEND-CODE                       07200000
           END-IF.                                                      07210000
      *SB 11/19/13 - END PR#5148D                                       07220000
053700                                                                  07230000
053800******************************************************************07240000
053900* 2000-CREATE-FILE -- THE OVER/SHORT INPUT FILES ARE SORTED/SUMMED07250000
054000*   BY AUDIT/RECEIVER/SKU NUMBER.  FOR EACH ITEM, FILL IN THE     07260000
054100*   VENDOR AND/OR RECEIVER OVER/SHORT (2001 WILL DETERMINE IF BOTH07270000
054200*   ARE CREATED OR JUST ONE -- DEPENDS IF THERE IS A MATCHING     07280000
054300*   RECORD ON BOTH FILES) AND DETERMINE IF THERE WERE ANY OTHER   07290000
054400*   PICKING ERRORS TO RECORD.  WRITE THE CURRENT RECORD TO THE    07300000
054500*   EXTRACT FILE (WHICH WILL BE THE PICKING TYPE) AND THEN        07310000
054600*   DETERMINE IF THERE ARE ANY TICKETING ERRORS, AND WRITE THE    07320000
054700*   CURRENT RECORD TO THE EXRACT FILE (WHICH WILL BE THE TICKETING07330000
054800*   TYPE).                                                        07340000
054900******************************************************************07350000
055000 2000-CREATE-FILE.                                                07360000
055100                                                                  07370000
055200*    -DETERMINE WHICH FILE IS CURRENT                             07380000
055300     PERFORM 2001-SET-UP-HOLD-FIELDS.                             07390000
055400                                                                  07400000
055500*----------------------------------------------------------------*07410000
055600*                                               **   WR # 21361  *07420000
055700* ADDED CODE TO CALL XLKUT001                                    *07430000
055800*----------------------------------------------------------------*07440000
055900     PERFORM 2250-CALL-XLKUT-DOMAIN-PGM.                          07450000
056000                                                                  07460000
056100*    -GET THE TOTAL UNITS TRANSRIBED FOR THIS ITEM                07470000
056200     PERFORM 2300-GET-UNITS-TRNSCRBD.                             07480000
056300                                                                  07490000
056500*    -CREATE THE PICKING RECORD (INCLUDING OVER/SHORT AMTS)       07500000
056600*    -READS OF THE OVER/SHORT FILES ARE DONE HERE...              07510000
056700     PERFORM 2100-SET-UP-PICKING-RECORD.                          07520000
           IF (CC-MANUAL-GENERATED-AUDIT AND                            07530000
              (CC-QC-AUD-ONLY OR CC-QC-AND-RFID-AUD)) OR                07540000
              (CC-SYSTEM-GENERATED-AUDIT AND CC-QC-AUDIT)               07550000
056800        PERFORM 8100-WRITE-EXTRACT-FILE                           07560000
056900                                                                  07570000
057000*    -CREATE THE TICKETING RECORD                                 07580000
057100        PERFORM 2200-SET-UP-TICKETING-RECORD                      07590000
057200        PERFORM 8100-WRITE-EXTRACT-FILE                           07600000
           END-IF.                                                      07610000
056900                                                                  07620000
      *SB 11/15/13 - BEGIN PR#5148D                                     07630000
057000*    -CREATE THE RFID RECORD                                      07640000
           IF (CC-MANUAL-GENERATED-AUDIT AND                            07650000
              (CC-RFID-AUD-ONLY OR CC-QC-AND-RFID-AUD)) OR              07660000
              (CC-SYSTEM-GENERATED-AUDIT AND CC-RFID-AUDIT)             07670000
057100        PERFORM 2225-SET-UP-RFID-RECORD                           07680000
057200        PERFORM 8100-WRITE-EXTRACT-FILE                           07690000
           END-IF.                                                      07700000
      *SB 11/15/13 - END PR#5148D                                       07710000
057300                                                                  07720000
057400                                                                  07730000
057500******************************************************************07740000
057600* 2001-SET-UP-HOLD-FIELDS.                                       *07750000
057700* PROCESS:  THIS PARAGRAPH WILL SET-UP THE HOLD FIELDS WITH THE  *07760000
057800* KEY DATA FROM THE FILE WITH THE SMALLEST VALUES                *07770000
057900******************************************************************07780000
058000 2001-SET-UP-HOLD-FIELDS.                                         07790000
058100                                                                  07800000
058200     EVALUATE TRUE                                                07810000
058300*      MOVE THE SMALLER AUDIT RECORD TO THE HOLD FIELDS           07820000
058400       WHEN SU003-AUD-CNTL-NBR <  SU004-AUD-CNTL-NBR              07830000
058500          PERFORM 2003-MOVE-VND-OS-FIELDS                         07840000
058600          SET PS-USE-VND-OS-ONLY      TO TRUE                     07850000
058700       WHEN SU003-AUD-CNTL-NBR >  SU004-AUD-CNTL-NBR              07860000
058800          PERFORM 2004-MOVE-RCVR-OS-FIELDS                        07870000
058900          SET PS-USE-RCVR-OS-ONLY     TO TRUE                     07880000
059000                                                                  07890000
059100* -OR- MOVE THE SMALLER PO RECORD TO THE HOLD FIELDS              07900000
059200       WHEN SU003-PO-NBR < SU004-PO-NBR                           07910000
059300          PERFORM 2003-MOVE-VND-OS-FIELDS                         07920000
059400          SET PS-USE-VND-OS-ONLY      TO TRUE                     07930000
059500       WHEN SU003-PO-NBR > SU004-PO-NBR                           07940000
059600          PERFORM 2004-MOVE-RCVR-OS-FIELDS                        07950000
059700          SET PS-USE-RCVR-OS-ONLY     TO TRUE                     07960000
059800                                                                  07970000
059900* -OR- MOVE THE SMALLER RECEVIER RECORD TO THE HOLD FIELDS        07980000
060000       WHEN SU003-REC-SEQ-NBR < SU004-REC-SEQ-NBR                 07990000
060100          PERFORM 2003-MOVE-VND-OS-FIELDS                         08000000
060200          SET PS-USE-VND-OS-ONLY      TO TRUE                     08010000
060300       WHEN SU003-REC-SEQ-NBR > SU004-REC-SEQ-NBR                 08020000
060400          PERFORM 2004-MOVE-RCVR-OS-FIELDS                        08030000
060500          SET PS-USE-RCVR-OS-ONLY     TO TRUE                     08040000
060600                                                                  08050000
060700* -OR- MOVE THE SMALLER SKU RECORD TO THE HOLD FIELDS             08060000
060800       WHEN SU003-SKU-NBR  < SU004-SKU-NBR                        08070000
060900          PERFORM 2003-MOVE-VND-OS-FIELDS                         08080000
061000          SET PS-USE-VND-OS-ONLY      TO TRUE                     08090000
061100       WHEN SU003-SKU-NBR  > SU004-SKU-NBR                        08100000
061200          PERFORM 2004-MOVE-RCVR-OS-FIELDS                        08110000
061300          SET PS-USE-RCVR-OS-ONLY     TO TRUE                     08120000
061400                                                                  08130000
061500* -OR- IF THE SAME RECORD, MOVE THE VENDOR OVER/SHORT TO GET      08140000
061600*      THE UPC NUMBER (NOT ON THE RECEIVER OVER/SHORT FILE)       08150000
061700       WHEN OTHER                                                 08160000
061800          PERFORM 2003-MOVE-VND-OS-FIELDS                         08170000
061900          SET PS-USE-BOTH-FILES       TO TRUE                     08180000
062000     END-EVALUATE.                                                08190000
062100                                                                  08200000
062200                                                                  08210000
062300******************************************************************08220000
062400* 2003-MOVE-VND-OS-FIELDS.                                       *08230000
062500******************************************************************08240000
062600 2003-MOVE-VND-OS-FIELDS.                                         08250000
062700     MOVE SU003-AUD-CNTL-NBR        TO PV-HOLD-AUD-CNTL-NBR.      08260000
062800     MOVE SU003-PO-NBR              TO PV-HOLD-PO-NBR.            08270000
062900     MOVE SU003-REC-SEQ-NBR         TO PV-HOLD-REC-SEQ-NBR.       08280000
063000*----------------------------------------------------------------*08290000
063100*  MOVE STATEMENTS HAVE BEEN MODIFIED                WR # 21361  *08300000
063200*----------------------------------------------------------------*08310000
063300     MOVE SU003-SKU-NMBR            TO PV-HOLD-SKU-NBR.           08320000
063400     MOVE SU003-SKU-DEPT-NBR        TO PV-HOLD-SKU-DPT-NBR.       08330000
063500     MOVE SU003-SKU-CL-NBR          TO PV-HOLD-SKU-CLASS-NBR.     08340000
063600*----------------------------------------------------------------*08350000
063700* CHANGES MADE FOR WR # 21361 ENDS HERE.                         *08360000
063800*----------------------------------------------------------------*08370000
063900                                                                  08380000
064000******************************************************************08390000
064100* 2004-MOVE-RCVR-OS-FIELDS.                                      *08400000
064200******************************************************************08410000
064300 2004-MOVE-RCVR-OS-FIELDS.                                        08420000
064400     MOVE SU004-AUD-CNTL-NBR        TO PV-HOLD-AUD-CNTL-NBR.      08430000
064500     MOVE SU004-PO-NBR              TO PV-HOLD-PO-NBR.            08440000
064600     MOVE SU004-REC-SEQ-NBR         TO PV-HOLD-REC-SEQ-NBR.       08450000
064700*----------------------------------------------------------------*08460000
064800*  MOVE STATEMENTS HAVE BEEN MODIFIED                WR # 21361  *08470000
064900*----------------------------------------------------------------*08480000
065000     MOVE SU004-SKU-NMBR            TO PV-HOLD-SKU-NBR.           08490000
065100     MOVE SU004-SKU-DEPT-NBR        TO PV-HOLD-SKU-DPT-NBR.       08500000
065200     MOVE SU004-SKU-CL-NBR          TO PV-HOLD-SKU-CLASS-NBR.     08510000
065300*----------------------------------------------------------------*08520000
065400* CHANGES MADE FOR WR # 21361 ENDS HERE.                         *08530000
065500*----------------------------------------------------------------*08540000
065600                                                                  08550000
065700                                                                  08560000
065800******************************************************************08570000
065900* 2100-SET-UP-PICKING RECORD.                                    *08580000
066000* PROCESS:  CHECK IF APPLICBLE OVER/SHORT ERRORS EXISTS...IF SO, *08590000
066100* SET-UP FIELDS, AND CHECK FOR ANY OTHER PICKING ERROR BEFORE    *08600000
066200* WRITING TO A FILE.                                             *08610000
066300*                                                                *08620000
066400* THIS PARAGRAPH IS REALLY DOING MORE THAN JUST SETTING UP THE   *08630000
066500* PICKING ERRORS.  THE REPORT AND THE FILES ARE BY SKU NUMBER.   *08640000
066600* THIS PARAGRAPH WILL LOOP FOR EVERY RECORD FOR A PARTICULAR SKU *08650000
066700* NUMBER.  WITHIN SKU NUMBER THERE COULD BE MULTIPLE CARTONS     *08660000
066800* AND/OR MULTIPLE UPCS.  THIS PARAGRAPH WILL COMPARE THE AUDITED *08670000
066900* AND EXPECTED BUCKETS TO CREATE THE OVER/SHORT.  FOR EACH UNIQUE*08680000
067000* UPC, IT WILL ALSO GET THE TOTAL NUMBER OF UNITS AUDITED (USED  *08690000
067100* ON BOTH RECORD TYPES (PICKING AND TICKETING), IT WILL FILL ALL *08700000
067200* ALL THE BUCKETS FOR THE DIFFERENT PICKING ERRORS AND TICKETING *08710000
067300* ERRORS.  WE GET THE TICKETING ERRORS NOW BECAUSE THIS IS THE   *08720000
067400* POINT THAT WE ARE GOING TO BE GOING THROUGH ALL THE DIFFERENT  *08730000
067500* UPCS...BOTH TYPES OF EXCEPTIONS MUST BE CHECKED FOR EACH UPC   *08740000
067600******************************************************************08750000
067700 2100-SET-UP-PICKING-RECORD.                                      08760000
067800                                                                  08770000
067900     INITIALIZE SU005-PICKING-ERROR-RECORD                        08780000
068000                SU005-UNITS-AUDITED                               08790000
068100                PV-HOLD-UPC-NBR                                   08800000
068200                SU005-TOT-UNITS-IN-ERROR.                         08810000
068300                                                                  08820000
068400     SET SU005-PICKING-ERRORS           TO TRUE.                  08830000
068500                                                                  08840000
068600     MOVE PV-HOLD-AUD-CNTL-NBR          TO SU005-AUD-CNTL-NBR.    08850000
068700     MOVE PV-HOLD-PO-NBR                TO SU005-PO-NBR.          08860000
068800     MOVE PV-HOLD-REC-SEQ-NBR           TO SU005-REC-SEQ-NBR.     08870000
068900     MOVE PV-HOLD-SKU-NBR               TO SU005-SKU-NMBR.        08880000
069000*----------------------------------------------------------------*08890000
069100*  MOVE STATEMENTS HAVE BEEN MODIFIED                WR # 21361  *08900000
069200*----------------------------------------------------------------*08910000
069300     MOVE PV-HOLD-SKU-DPT-NBR           TO SU005-SKU-DEPT-NBR.    08920000
069400     MOVE PV-HOLD-SKU-CLASS-NBR         TO SU005-SKU-CL-NBR.      08930000
069500*----------------------------------------------------------------*08940000
069600* CHANGES MADE FOR WR # 21361 ENDS HERE.                         *08950000
069700*----------------------------------------------------------------*08960000
069800                                                                  08970000
069900*    IF THE CURRENT RECORD IS ONLY FROM THE VENDOR OVER/SHORT FILE08980000
070000*    OR IF THERE ARE MATCHING RECORDS ON BOTH FILES, CHECK IF THER08990000
070100*    IS AN OVERAGE, OR A SHORTAGE                                 09000000
070200     IF PS-USE-VND-OS-ONLY OR PS-USE-BOTH-FILES                   09010000
070300                                                                  09020000
070400*      ..ACCUMULATE THE OVER/SHORT UNTIL A NEW KEY OR END OF FILE 09030000
070500**                                                                09040000
070600*      LOOP WILL SPIN THROUGH ALL UPCS/CARTSON FOR THE CURRENT SKU09050000
070700*      THIS IS NEEDED BECAUSE AND ITEM COULD BE IN TWO DIFFERENT  09060000
070800*      CARTONS, AND COULD BE SHORT ONE IN THE 1ST AND OVER 1 IN   09070000
070900*      THE 2ND.  COMBINED WE GOT ALL THE ITEMS WE NEED, BUT AT THE09080000
071000*      CARTON LEVEL, THERE IS 1 OVER AND 1 SHORT -- THESE ERRORS  09090000
071100*      NEED TO BE REPORTED.                                       09100000
071200       PERFORM UNTIL SU003-AUD-CNTL-NBR > PV-HOLD-AUD-CNTL-NBR    09110000
071300           OR  SU003-PO-NBR           > PV-HOLD-PO-NBR            09120000
071400           OR  SU003-REC-SEQ-NBR      > PV-HOLD-REC-SEQ-NBR       09130000
071500           OR  SU003-SKU-NMBR         > PV-HOLD-SKU-NBR           09140000
071600           OR  PS-EOF-VND-OVER-SHORT                              09150000
071700*        IF THE QUANTITY AUDITED IS MORE THAN EXPECTED, IT IS     09160000
071800*        AN OVERAGE                                               09170000
071900         IF SU003-QTY-EXP < SU003-QTY-AUD                         09180000
072000*            ...SET-UP VENDOR-OVER FIELD                          09190000
072100             MOVE 'SU005-VENDOR-OVER'     TO PV-FIELD-NAME        09200000
072200             COMPUTE SU005-VENDOR-OVER =                          09210000
072300                   ( SU005-VENDOR-OVER +                          09220000
072400                   ( SU003-QTY-AUD - SU003-QTY-EXP ))             09230000
072500             ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR      09240000
072600             END-COMPUTE                                          09250000
072700                                                                  09260000
072800*            ... AND ADD THE QUANTITY TO THE TOTAL ERROR FIELD    09270000
072900             MOVE 'SU005-TOT-PIC-ERR'     TO PV-FIELD-NAME        09280000
073000             COMPUTE SU005-TOT-PIC-ERR =                          09290000
073100                   ( SU005-TOT-PIC-ERR +                          09300000
073200                   ( SU003-QTY-AUD - SU003-QTY-EXP ))             09310000
073300             ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR      09320000
073400             END-COMPUTE                                          09330000
073500         END-IF                                                   09340000
073600                                                                  09350000
073700*        IF A VENDOR SHORTAGE...                                  09360000
073800         IF SU003-QTY-EXP > SU003-QTY-AUD                         09370000
073900*            ... SETUP VENDOR-SHORT FIELD                         09380000
074000             MOVE 'SU005-VENDOR-SHORT'    TO PV-FIELD-NAME        09390000
074100             COMPUTE SU005-VENDOR-SHORT =                         09400000
074200                   ( SU005-VENDOR-SHORT +                         09410000
074300                   ( SU003-QTY-EXP - SU003-QTY-AUD ))             09420000
074400             ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR      09430000
074500             END-COMPUTE                                          09440000
074600                                                                  09450000
074700*            ... AND ADD THE QUANTITY TO THE TOTAL ERROR FIELD    09460000
074800             MOVE 'SU005-TOT-PIC-ERR'     TO PV-FIELD-NAME        09470000
074900             COMPUTE SU005-TOT-PIC-ERR =                          09480000
075000                   ( SU005-TOT-PIC-ERR +                          09490000
075100                   ( SU003-QTY-EXP - SU003-QTY-AUD ))             09500000
075200             ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR      09510000
075300             END-COMPUTE                                          09520000
075400         END-IF                                                   09530000
075500                                                                  09540000
075600*        AND ADD THE QUANTITY TO THE TOTAL UNITS IN ERROR FIELD   09550000
075700         MOVE 'SU005-TOT-UNITS-IN-PIC-ERR'                        09560000
075800                                      TO PV-FIELD-NAME            09570000
075900         COMPUTE SU005-TOT-UNITS-IN-PIC-ERR =                     09580000
076000                 SU005-TOT-UNITS-IN-PIC-ERR +                     09590000
076100                 SU003-PICK-ERR-CNT                               09600000
076200         ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR          09610000
076300         END-COMPUTE                                              09620000
076400*                                                                 09630000
076500         MOVE 'SU005-TOT-UNITS-IN-ERROR'                          09640000
076600                                      TO PV-FIELD-NAME            09650000
076700         COMPUTE SU005-TOT-UNITS-IN-ERROR   =                     09660000
076800                 SU005-TOT-UNITS-IN-ERROR   +                     09670000
076900                 SU003-UNT-ERR-CNT-COMBO                          09680000
077000         ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR          09690000
077100         END-COMPUTE                                              09700000
077200                                                                  09710000
077300*        AND ADD THE QUANTITY AUDITED TO THE TOTAL QTY AUDITED    09720000
077400*        SEE NOTE BELOW                                           09730000
077500         MOVE 'SU005-UNITS-AUDITED'   TO PV-FIELD-NAME            09740000
077600         COMPUTE SU005-UNITS-AUDITED =                            09750000
077700                 SU005-UNITS-AUDITED + SU003-QTY-AUD              09760000
077800         ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR          09770000
077900         END-COMPUTE                                              09780000
078000                                                                  09790000
078100*        FOR EACH DISTINCT UPC, GET THE UNITS AUDITED, ANY        09800000
078200*        PICKING ERRORS,  AND ANY TICKETING ERRORS                09810000
078300         IF SU003-UPC = PV-HOLD-UPC-NBR                           09820000
078400         OR SU003-UPC = 0                                         09830000
078500             CONTINUE                                             09840000
078600         ELSE                                                     09850000
078700             MOVE SU003-UPC            TO PV-HOLD-UPC-NBR         09860000
078800                                                                  09870000
078900*            UNITS AUDITED                                        09880000
079000*            COMMENTING OUT THIS CODE BECAUSE I MUST HAVE HAD MY  09890000
079100*            HEAD UP MY @$$ WHEN I CODED IT...THE UNITS AUDITED   09900000
079200*            ARE ALREADY COMING THROUGH ON THE FILE -- DON'T NEED 09910000
079300*            TO DO ANOTHER CALL TO DB2.                           09920000
079400                                                                  09930000
079500*            PERFORM 2400-GET-UNITS-AUDITED                       09940000
079600*            ADD PV-UNITS-AUDITED      TO SU005-UNITS-AUDITED     09950000
079700                                                                  09960000
079800*            PICKING EXCEPTIONS                                   09970000
079900             PERFORM 3000-CHECK-PICKING-ERRORS                    09980000
080000                                                                  09990000
080100*            TICKETING EXCEPTIONS                                 10000000
080200             PERFORM 3100-CHECK-TICKETING-ERRORS                  10010000
                                                                        10020000
      *SB 11/15/13 - BEGIN PR#5148D                                     10030000
080100*            RFID EXCEPTIONS                                      10040000
080200             PERFORM 3200-CHECK-RFID-ERRORS                       10050000
      *SB 11/15/13 - END PR#5148D                                       10060000
080300         END-IF                                                   10070000
080400                                                                  10080000
080500                                                                  10090000
080600*        READ THE NEXT VENDOR OVER/SHORT RECORD                   10100000
080700         PERFORM 8000-READ-VND-OVER-SHORT                         10110000
080800       END-PERFORM                                                10120000
080900     END-IF.                                                      10130000
081000                                                                  10140000
081100                                                                  10150000
081200*    IF THE CURRENT RECORD IS ONLY FROM THE RECEIVER OVER/SORT    10160000
081300*    FILE, OR IF THERE ARE MATCHING RECORDS ON BOTH FILES, CHECK  10170000
081400*    TO SEE IF THERE IS AN OVERAGE, OR A SHORTAGE                 10180000
081500     IF PS-USE-RCVR-OS-ONLY OR PS-USE-BOTH-FILES                  10190000
081600*        IF THE QUANTITY AUDITED IS MORE THAN RECEIVED, IT IS     10200000
081700*        AN OVERAGE (IF THE EXPECTED IS 0, THEN IT IS ACTUALLY    10210000
081800*        A STYLE SUB -- IGNORE THESE BECAUSE THE ERROR IS         10220000
081900*        GENERAGED WHEN THE UNIT WAS SCANNED)                     10230000
082000*                                                                 10240000
082100*        THERE IS NO LOOPING AND ACCUMULATING DONE HERE BECAUE    10250000
082200*        THE INPUT FILE CAN BE SORT/SUMMED AT THE PO/RECEIVER     10260000
082300*        SKU LEVEL.  THE SKU CAN ONLY BE ON THE RECEIVER ONCE     10270000
082400*        (SINCE NO CARTONS ARE INVOLVED)                          10280000
082500         IF SU004-QTY-RECV < SU004-QTY-AUD                        10290000
082600             SET PS-CREATE-OVER   TO TRUE                         10300000
082700             IF SU004-QTY-RECV > 0                                10310000
082800                 PERFORM 2150-CHECK-FOR-STYLE-SUB                 10320000
082900             END-IF                                               10330000
083000                                                                  10340000
083100             IF PS-CREATE-OVER                                    10350000
083200*            ... SETUP RECEIVER-OVERAGE-FIELD                     10360000
083300                 MOVE 'SU005-RECEIVER-OVER'   TO PV-FIELD-NAME    10370000
083400                 COMPUTE SU005-RECEIVER-OVER =                    10380000
083500                         SU004-QTY-AUD - SU004-QTY-RECV           10390000
083600                 ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR  10400000
083700                 END-COMPUTE                                      10410000
083800                                                                  10420000
083900*            ... AND ADD THE QUANTITY TO THE TOTAL ERROR FIELD    10430000
084000                 MOVE 'SU005-TOT-PIC-ERR'     TO PV-FIELD-NAME    10440000
084100                 COMPUTE SU005-TOT-PIC-ERR =                      10450000
084200                         SU005-TOT-PIC-ERR + SU005-RECEIVER-OVER  10460000
084300                 ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR  10470000
084400                 END-COMPUTE                                      10480000
084500             END-IF                                               10490000
084600         END-IF                                                   10500000
084700                                                                  10510000
084800*        IF A RECEIVER SHORTAGE                                   10520000
084900         IF SU004-QTY-RECV > SU004-QTY-AUD                        10530000
085000*            ... SETUP RECEIVER-SHORTAGE-FIELD                    10540000
085100             MOVE 'SU005-RECEIVER-SHORT'   TO PV-FIELD-NAME       10550000
085200             COMPUTE SU005-RECEIVER-SHORT =                       10560000
085300                     SU004-QTY-RECV - SU004-QTY-AUD               10570000
085400             ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR      10580000
085500             END-COMPUTE                                          10590000
085600                                                                  10600000
085700*            ... AND ADD THE QUANTITY TO THE TOTAL ERROR FIELD    10610000
085800             MOVE 'SU005-TOT-PIC-ERR'     TO PV-FIELD-NAME        10620000
085900             COMPUTE SU005-TOT-PIC-ERR =                          10630000
086000                     SU005-TOT-PIC-ERR + SU005-RECEIVER-SHORT     10640000
086100             ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR      10650000
086200             END-COMPUTE                                          10660000
086300         END-IF                                                   10670000
086400                                                                  10680000
086500*        AND ADD THE QUANTITY TO THE TOTAL UNITS IN ERROR FIELD   10690000
086600         MOVE 'SU005-TOT-UNITS-IN-PIC-ERR'                        10700000
086700                                      TO PV-FIELD-NAME            10710000
086800         COMPUTE SU005-TOT-UNITS-IN-PIC-ERR =                     10720000
086900            SU005-TOT-UNITS-IN-PIC-ERR + SU004-PICK-ERR-CNT       10730000
087000         ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR          10740000
087100         END-COMPUTE                                              10750000
087200*                                                                 10760000
087300         MOVE 'SU005-TOT-UNITS-IN-ERROR'                          10770000
087400                                      TO PV-FIELD-NAME            10780000
087500         COMPUTE SU005-TOT-UNITS-IN-ERROR   =                     10790000
087600                 SU005-TOT-UNITS-IN-ERROR   +                     10800000
087700                 SU004-UNT-ERR-CNT-COMBO                          10810000
087800         ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR          10820000
087900         END-COMPUTE                                              10830000
088000                                                                  10840000
088100*        READ THE NEXT RECEIVER OVER/SHORT RECORD                 10850000
088200         PERFORM 8001-READ-RCVR-OVER-SHORT                        10860000
088300     END-IF.                                                      10870000
088400                                                                  10880000
088500                                                                  10890000
088600******************************************************************10900000
088700* 2150-CHECK-FOR-STYLE-SUB.                                      *10910000
088800* PROCESS:  CHECK TO SEE IF THIS SCAN PRODUCED A STYLE SUB ERROR *10920000
088900******************************************************************10930000
089000 2150-CHECK-FOR-STYLE-SUB.                                        10940000
089100                                                                  10950000
089200     MOVE SU004-AUD-CNTL-NBR      TO DK-AUD-CNTL-NBR.             10960000
089300     MOVE SU004-SKU-NMBR          TO DK-SKU-NBR.                  10970000
089400                                                                  10980000
089500*----------------------------------------------------------------*10990000
089600*  SQL STATEMENT CHANGED TO ADD XL001-UPC-NBR        WR # 21361  *11000000
089700*----------------------------------------------------------------*11010000
089800     EXEC SQL                                                     11020000
089900         SELECT                                                   11030000
090000               VILN_GP_SEQ_NBR                                    11040000
090100         INTO                                                     11050000
090200               :SUEXCP-VILN-GP-SEQ-NBR                            11060000
090300         FROM                                                     11070000
090400               TSUEXCP A                                          11080000
090500         WHERE                                                    11090000
090600               A.AUD_CNTL_NBR        = :DK-AUD-CNTL-NBR           11100000
090700           AND A.SHIPT_UNT_ID        >  0                         11110000
090800           AND A.UPC_NBR             = :XL001-UPC-NBR             11120000
090900           AND A.VILN_GP_CDE         = 'VA'                       11130000
091000           AND A.VILN_GP_SEQ_NBR     IN (9, 10, 11)               11140000
091100     END-EXEC.                                                    11150000
091200                                                                  11160000
091300     EVALUATE TRUE                                                11170000
091400         WHEN SQLCODE = ZERO                                      11180000
091500         WHEN SQLCODE = -811                                      11190000
091600            SET PS-DONT-CREATE-OVER   TO TRUE                     11200000
091700                                                                  11210000
091800         WHEN SQLCODE = +100                                      11220000
091900            SET PS-CREATE-OVER        TO TRUE                     11230000
092000                                                                  11240000
092100         WHEN SQLWARN0 NOT EQUAL SPACE                            11250000
092200         WHEN SQLCODE NOT EQUAL ZERO                              11260000
092300             DISPLAY 'DK-AUD-CNTL-NBR: '                          11270000
092400                     DK-AUD-CNTL-NBR                              11280000
092500             DISPLAY 'DK-SKU-NBR: ' DK-SKU-NBR                    11290000
092600             MOVE '2150-CHECK-FOR-STYLE-SUB'                      11300000
092700                               TO  PV-PARAGRAPH-NAME              11310000
092800             PERFORM 9999-SQL-ABEND                               11320000
092900     END-EVALUATE.                                                11330000
093000*----------------------------------------------------------------*11340000
093100* CHANGES MADE FOR WR # 21361 ENDS HERE.                         *11350000
093200*----------------------------------------------------------------*11360000
093300                                                                  11370000
093400******************************************************************11380000
093500* 2200-SET-UP-TICKETING-RECORD.                                  *11390000
093600* PROCESS:  SELECT ANY OTHER TICKETING ERRORS                    *11400000
093700******************************************************************11410000
093800 2200-SET-UP-TICKETING-RECORD.                                    11420000
093900                                                                  11430000
094000     INITIALIZE SU005-TICKETING-ERROR-RECORD                      11440000
094100                SU005-TOT-UNITS-IN-ERROR.                         11450000
094200                                                                  11460000
094300     SET SU005-TICKETING-ERRORS         TO TRUE.                  11470000
094400                                                                  11480000
094500     MOVE PV-HOLD-AUD-CNTL-NBR      TO SU005-AUD-CNTL-NBR.        11490000
094600     MOVE PV-HOLD-PO-NBR            TO SU005-PO-NBR .             11500000
094700     MOVE PV-HOLD-REC-SEQ-NBR       TO SU005-REC-SEQ-NBR .        11510000
094800     MOVE PV-HOLD-SKU-NBR           TO SU005-SKU-NMBR .           11520000
094900*----------------------------------------------------------------*11530000
095000*  MOVE STATEMENTS HAVE BEEN MODIFIED                WR # 21361  *11540000
095100*----------------------------------------------------------------*11550000
095200     MOVE PV-HOLD-SKU-DPT-NBR       TO SU005-SKU-DEPT-NBR.        11560000
095300     MOVE PV-HOLD-SKU-CLASS-NBR     TO SU005-SKU-CL-NBR.          11570000
095400*----------------------------------------------------------------*11580000
095500* CHANGES MADE FOR WR # 21361 ENDS HERE.                         *11590000
095600*----------------------------------------------------------------*11600000
095700                                                                  11610000
095800*    MOVE TICKETING ERROR BUCKETS --                              11620000
095900*    THESE VALUES ARE ESTABLISHED IN PARA 2100-.  WE NEED TO DO   11630000
096000*    IT THERE BECAUSE IT IS THERE THAT EVERY DISTINCT UPC FOR A   11640000
096100*    SPECIFIC SKU WILL BE DISCOVERED.  FOR EACH UPC, A SELECTION  11650000
096200*    OF THE EXCEPTION TABLE WILL BE DONE TO FILL THESE BUCKETS.   11660000
096300     MOVE  PV-TICKET-NO-UPC         TO SU005-NO-UPC.              11670000
096400     MOVE  PV-TICKET-NO-BARCODE     TO SU005-NO-BARCODE.          11680000
096500     MOVE  PV-TICKET-DAMAGED-BARCODE                              11690000
096600                                    TO SU005-DAMAGED-BARCODE.     11700000
096700     MOVE  PV-TICKET-WRONG-UPC      TO SU005-WRONG-UPC.           11710000
096800     MOVE  PV-TICKET-WRONG-TICKET   TO SU005-WRONG-TICKET.        11720000
096900     MOVE  PV-TICKET-MISSING-TICKET TO SU005-MISSING-TICKET.      11730000
097000     MOVE  PV-TICKET-WRONG-LABEL    TO SU005-WRONG-LABEL.         11740000
097100     MOVE  PV-TOT-TIC-ERR           TO SU005-TOT-TIC-ERR.         11750000
097200     MOVE  PV-TOT-UNITS-IN-TIC-ERR  TO SU005-TOT-UNITS-IN-TIC-ERR.11760000
097300                                                                  11770000
097400*    RE-INITIALIZE THE PV FIELDS FOR PROCESSING THE NEXT INPUT    11780000
097500*    RECORD.                                                      11790000
097600     MOVE ZEROS                     TO  PV-TICKET-NO-UPC          11800000
097700                                        PV-TICKET-NO-BARCODE      11810000
097800                                        PV-TICKET-DAMAGED-BARCODE 11820000
097900                                        PV-TICKET-WRONG-UPC       11830000
098000                                        PV-TICKET-WRONG-TICKET    11840000
098100                                        PV-TICKET-MISSING-TICKET  11850000
098200                                        PV-TICKET-WRONG-LABEL     11860000
098300                                        PV-TOT-TIC-ERR            11870000
098400                                        PV-TOT-UNITS-IN-TIC-ERR.  11880000
098500                                                                  11890000
093300                                                                  11900000
      *SB 11/15/13 - BEGIN PR#5148D                                     11910000
093400******************************************************************11920000
093500* 2225-SET-UP-RFID-RECORD.                                       *11930000
093600* PROCESS:  SELECT ANY OTHER RFID ERRORS                         *11940000
093700******************************************************************11950000
093800 2225-SET-UP-RFID-RECORD.                                         11960000
093900                                                                  11970000
094000     INITIALIZE SU005-RFID-ERROR-RECORD                           11980000
094100                SU005-TOT-UNITS-IN-ERROR.                         11990000
094200                                                                  12000000
094300     SET SU005-RFID-ERRORS      TO TRUE.                          12010000
094400                                                                  12020000
094500     MOVE PV-HOLD-AUD-CNTL-NBR  TO SU005-AUD-CNTL-NBR.            12030000
094600     MOVE PV-HOLD-PO-NBR        TO SU005-PO-NBR .                 12040000
094700     MOVE PV-HOLD-REC-SEQ-NBR   TO SU005-REC-SEQ-NBR .            12050000
094800     MOVE PV-HOLD-SKU-NBR       TO SU005-SKU-NMBR .               12060000
095200     MOVE PV-HOLD-SKU-DPT-NBR   TO SU005-SKU-DEPT-NBR.            12070000
095300     MOVE PV-HOLD-SKU-CLASS-NBR TO SU005-SKU-CL-NBR.              12080000
095700                                                                  12090000
095800*    MOVE RFID ERROR BUCKETS --                                   12100000
095900*    THESE VALUES ARE ESTABLISHED IN PARA 2100-.  WE NEED TO DO   12110000
096000*    IT THERE BECAUSE IT IS THERE THAT EVERY DISTINCT UPC FOR A   12120000
096100*    SPECIFIC SKU WILL BE DISCOVERED.  FOR EACH UPC, A SELECTION  12130000
096200*    OF THE EXCEPTION TABLE WILL BE DONE TO FILL THESE BUCKETS.   12140000
096300     MOVE  PV-RFID-TKT-NO-EPC   TO SU005-WRG-TKT-NO-EPC-LOGO      12150000
096400     MOVE  PV-RFID-TKT-CLR      TO SU005-WRG-RFID-TKT-CLR         12160000
096500     MOVE  PV-RFID-TKT-SIZE     TO SU005-WRG-RFID-TKT-SIZE        12170000
096600     MOVE  PV-RFID-TKT-STYLE    TO SU005-WRG-RFID-TKT-STYLE       12180000
096700     MOVE  PV-RFID-NO-TICKET    TO SU005-NO-RFID-TICKET           12190000
096800     MOVE  PV-TOT-RFID-ERR      TO SU005-TOT-RFID-ERR             12200000
096900     MOVE  PV-TOT-UNITS-IN-RFID-ERR                               12210000
096900                                TO SU005-TOT-UNITS-IN-RFID-ERR    12220000
049600*    -GET THE TOTAL UNITS AUDITED FOR THIS STORE                  12230000
049700        PERFORM 2230-GET-UNITS-AUDITED                            12240000
                                                                        12250000
097300                                                                  12260000
097400*    RE-INITIALIZE THE PV FIELDS FOR PROCESSING THE NEXT INPUT    12270000
097500*    RECORD.                                                      12280000
097600     MOVE ZEROS                 TO PV-RFID-TKT-NO-EPC             12290000
097700                                   PV-RFID-TKT-CLR                12300000
097800                                   PV-RFID-TKT-SIZE               12310000
097900                                   PV-RFID-TKT-STYLE              12320000
098000                                   PV-RFID-NO-TICKET              12330000
098100                                   PV-TOT-RFID-ERR                12340000
098200                                   PV-TOT-UNITS-IN-RFID-ERR.      12350000
098500                                                                  12360000
093700*                                                                 12370000
088700******************************************************************12380000
088800* 2230-GET-UNITS-AUDITED.                                        *12390000
088900*  THIS PROCEDURE WILL GET THE TOTAL NUMBER OF UNITS AUDITED     *12400000
089000*  FOR THIS STORE/RECEIVER                                       *12410000
089100******************************************************************12420000
089200 2230-GET-UNITS-AUDITED.                                          12430000
089300                                                                  12440000
089400     MOVE PV-HOLD-AUD-CNTL-NBR          TO DK-AUD-CNTL-NBR        12450000
089500     MOVE PV-HOLD-PO-NBR                TO DK-PO-NBR              12460000
089600     MOVE PV-HOLD-REC-SEQ-NBR           TO DK-REC-SEQ-NBR         12470000
089600     MOVE PV-HOLD-SKU-NBR               TO DK-SKU-NUMBER          12480000
089800                                                                  12490000
089900     EXEC SQL                                                     12500000
090000         SELECT                                                   12510000
045100                SUM(RFID_TGD_QTY)                                 12520000
090200         INTO                                                     12530000
090300               :SU005-UNITS-AUDITED                               12540000
090400         FROM                                                     12550000
090500               TSUAUPC A                                          12560000
                  ,  TSUATRN B                                          12570000
090700         WHERE                                                    12580000
090800               B.TRN_NBR           = :DK-PO-NBR                   12590000
090900           AND B.REC_SEQ_NBR       = :DK-REC-SEQ-NBR              12600000
091100           AND B.AUD_CNTL_NBR      = :DK-AUD-CNTL-NBR             12610000
091200           AND B.AUD_CNTL_NBR      = A.AUD_CNTL_NBR               12620000
091300           AND B.SHIPT_UNT_ID      = A.SHIPT_UNT_ID               12630000
090900           AND A.SKU_NBR           = :DK-SKU-NUMBER               12640000
091400           AND A.SCN_TYP_CDE      <> :PC-E                        12650000
091500     END-EXEC.                                                    12660000
091600                                                                  12670000
091700     EVALUATE TRUE                                                12680000
091800         WHEN SQLCODE = ZERO                                      12690000
091900              CONTINUE                                            12700000
092100         WHEN SQLCODE = +100                                      12710000
092200         WHEN SQLCODE = -305                                      12720000
092300              MOVE +0          TO SU005-UNITS-AUDITED             12730000
092400                                                                  12740000
092500         WHEN SQLWARN0 NOT EQUAL SPACE                            12750000
092600         WHEN SQLCODE NOT EQUAL ZERO                              12760000
092700              MOVE '2230-GET-UNITS-AUDITED'                       12770000
092800                               TO  PV-PARAGRAPH-NAME              12780000
092900              MOVE 'SELECT FROM TSUATRN, TSUAUPC'                 12790000
093000                               TO  PV-DB2-OPERATION-ATTEMPTED     12800000
093100              DISPLAY 'PO NBR:      ' DK-PO-NBR                   12810000
093200              DISPLAY 'REC SEQ NBR: ' DK-REC-SEQ-NBR              12820000
093300              DISPLAY 'SKU NBR:     ' DK-SKU-NUMBER               12830000
093400              DISPLAY 'AUD CNTL NBR:' DK-AUD-CNTL-NBR             12840000
093500              PERFORM 9999-SQL-ABEND                              12850000
093600     END-EVALUATE.                                                12860000
      *SB 12/30/13 - END PR#5148D                                       12870000
098600******************************************************************12880000
098700* 2300-GET-UNITS-TRNSCRBD.                                       *12890000
098800*  THIS PROCEDURE WILL GET THE TOTAL NUMBER OF UNITS TRASNCRIBED *12900000
098900*  FOR THIS ITEM/RECEIVER                                        *12910000
099000******************************************************************12920000
099100 2300-GET-UNITS-TRNSCRBD.                                         12930000
099200                                                                  12940000
099300     MOVE PV-HOLD-PO-NBR                TO DK-PO-NBR              12950000
099400     MOVE PV-HOLD-REC-SEQ-NBR           TO DK-REC-SEQ-NBR         12960000
099500*----------------------------------------------------------------*12970000
099600*  REMOVED THE MOVE STATEMENT AND SQL STATEMENT HAVE BEEN        *12980000
099700*  MODIFIED TO INCLUDE XL001-DEPT-NBR-3CH,XL001-SUB-CL-NBR       *12990000
099800*  AND XL001-ITM-NBR                                 WR # 21361  *13000000
099900*----------------------------------------------------------------*13010000
100000                                                                  13020000
100100     EXEC SQL                                                     13030000
100200         SELECT                                                   13040000
100300               SUM(EXPTED_ITM_QTY)                                13050000
100400         INTO                                                     13060000
100500               :SU005-UNITS-TRNSCRBD                              13070000
100600         FROM                                                     13080000
100700               TRECDIS A                                          13090000
100800             , TPURITM B                                          13100000
100900             , TPURCHS C                                          13110000
101000         WHERE                                                    13120000
101100               A.ORD_NBR        = :DK-PO-NBR                      13130000
101200           AND A.REC_SEQ_NBR    = :DK-REC-SEQ-NBR                 13140000
101300           AND C.DEPT_NBR       = :XL001-DEPT-NBR-3CH             13150000
101400           AND B.CL_NBR         = :XL001-SUB-CL-NBR-2CH           13160000
101500           AND B.ITM_NBR        = :XL001-ITM-NBR                  13170000
101600           AND A.ORD_NBR        = B.PO_NBR                        13180000
101700           AND A.ORD_LNE_NBR    = B.APP_PO_LNE_NBR                13190000
101800           AND A.ORD_NBR        = C.PO_NBR                        13200000
102000           AND B.VER_STATUS_CDE = 'A'                             13220000
102100           AND C.VER_STATUS_CDE = 'A'                             13230000
102200     END-EXEC.                                                    13240000
102300                                                                  13250000
102400     EVALUATE TRUE                                                13260000
102500         WHEN SQLCODE = ZERO                                      13270000
102600              CONTINUE                                            13280000
102700                                                                  13290000
102800         WHEN SQLCODE = +100                                      13300000
102900         WHEN SQLCODE = -305                                      13310000
103000              MOVE +0          TO SU005-UNITS-TRNSCRBD            13320000
103100                                                                  13330000
103200         WHEN SQLWARN0 NOT EQUAL SPACE                            13340000
103300         WHEN SQLCODE NOT EQUAL ZERO                              13350000
103400              DISPLAY 'PO NBR: '            DK-PO-NBR             13360000
103500              DISPLAY 'RECEIVER SEQUENCE: ' DK-REC-SEQ-NBR        13370000
103600              DISPLAY 'SKU DEPT NBR: '      XL001-DEPT-NBR        13380000
103700              DISPLAY 'SKU CLASS NBR: '     XL001-SUB-CL-NBR      13390000
103800              DISPLAY 'SKU SEQ NBR: '       XL001-SKU-NBR         13400000
103900              MOVE '2300-GET-UNITS-TRNSCRBD'                      13410000
104000                               TO  PV-PARAGRAPH-NAME              13420000
104100              MOVE 'SELECT TRECDIS'                               13430000
104200                               TO  PV-DB2-OPERATION-ATTEMPTED     13440000
104300              PERFORM 9999-SQL-ABEND                              13450000
104400     END-EVALUATE.                                                13460000
104500*----------------------------------------------------------------*13470000
104600* CHANGES MADE FOR WR # 21361 ENDS HERE.                         *13480000
104700*----------------------------------------------------------------*13490000
104800                                                                  13500000
104900*----------------------------------------------------------------*13510000
105000*                                               **   WR # 21361  *13520000
105100* CODE FOR ACCESSING LOGISTICS DOMAIN ITEM ACCESS MODULE         *13530000
105200*----------------------------------------------------------------*13540000
105300 2250-CALL-XLKUT-DOMAIN-PGM.                                      13550000
105400                                                                  13560000
105500     INITIALIZE XL001-ITEM-COMMAREA                               13570000
105600                                                                  13580000
105700     MOVE PV-HOLD-SKU-NBR      TO XL001-KEY-SKU.                  13590000
105800                                                                  13600000
105900     SET XL001-SELECT-SKU                                         13610000
106000         XL001-SELECT-UPC                                         13620000
106100         XL001-SELECT-VND-STYL                                    13630000
106200         XL001-BY-NUMERIC-SKU  TO TRUE.                           13640000
106300                                                                  13650000
106400     CALL XL001-VSM-PGM USING  XL001-ITEM-COMMAREA.               13660000
106500                                                                  13670000
106600     MOVE XL001-SKU-SQLCODE TO SQLCODE.                           13680000
106700     EVALUATE TRUE                                                13690000
106800         WHEN XL001-SKU-CONTENTION                                13700000
106900              MOVE '2250-CALL-XLKUT-DOMAIN-PGM'                   13710000
107000                                     TO PV-ABEND-PARAGRAPH        13720000
107100              MOVE 'XL001-UPC-CONTENTION'                         13730000
107200                                     TO PV-ABEND-MESSAGE-TEXT     13740000
107300              MOVE XL001-SKU-SQLCODE TO PV-SQLCODE                13750000
107400              MOVE 'XLV_SKU'         TO PV-DB2-VIEW-NAME          13760000
107500              PERFORM 9200-PROCESS-ABEND                          13770000
107600         WHEN XL001-SKU-SQLCODE = +0                              13780000
107700              PERFORM 2310-SELECT-UPC                             13790000
107800         WHEN XL001-SKU-SQLCODE = +100                            13800000
107900              MOVE '000' TO XL001-DEPT-NBR-3CH                    13810000
108000              MOVE '00'  TO XL001-SUB-CL-NBR-2CH                  13820000
108100         WHEN OTHER                                               13830000
108200             PERFORM 9200-PROCESS-ABEND                           13840000
108300     END-EVALUATE.                                                13850000
108400* ADDED CODE TO RETRIEVE VALUES FROM XLV_UPC                      13860000
108500 2310-SELECT-UPC.                                                 13870000
108600     MOVE XL001-UPC-SQLCODE TO SQLCODE.                           13880000
108700     EVALUATE TRUE                                                13890000
108800         WHEN XL001-UPC-CONTENTION                                13900000
108900              MOVE '7010-SELECT-SKU-BY-SKU'                       13910000
109000                                     TO PV-ABEND-PARAGRAPH        13920000
109100              MOVE 'XL001-UPC-CONTENTION'                         13930000
109200                                     TO PV-ABEND-MESSAGE-TEXT     13940000
109300              MOVE XL001-UPC-SQLCODE TO PV-SQLCODE                13950000
109400              MOVE 'XLV_UPC'         TO PV-DB2-VIEW-NAME          13960000
109500              PERFORM 9200-PROCESS-ABEND                          13970000
109600         WHEN XL001-UPC-SQLCODE = +0                              13980000
109700              PERFORM 2320-SELECT-VND-STYL                        13990000
109710                                                                  14000000
109711*                                                                 14010000
109712*** ADDED - DMH - 9/9/10 END                                      14020000
109713*                                                                 14030000
109714         WHEN XL001-UPC-NOT-FOUND                                 14040000
109715              MOVE XL001-KEY-UPC-NBR    TO  PV-DISP-UPC           14050000
109716              MOVE PV-HOLD-AUD-CNTL-NBR TO  PV-DISP-AUD-CNTL-NBR  14060000
109717              MOVE PV-HOLD-PO-NBR       TO  PV-DISP-PO            14070000
109718              MOVE PV-HOLD-REC-SEQ-NBR  TO  PV-DISP-RCVR          14080000
109727              DISPLAY '***'                                       14090000
109728              DISPLAY '*** SUKUT015 ***'                          14100000
109729              DISPLAY '*** INVALID UPC: '  PV-DISP-UPC            14110000
109730              DISPLAY '*** AUDIT:       '  PV-DISP-AUD-CNTL-NBR   14120000
109731              DISPLAY '*** PO-RCVR:     '  PV-DISP-PO             14130000
109732                      '-'                  PV-DISP-RCVR           14140000
109733              DISPLAY '***'                                       14150000
109734*                                                                 14160000
109735*** ADDED - DMH - 9/9/10 END                                      14170000
109740*                                                                 14180000
109800         WHEN OTHER                                               14190000
109810             MOVE  '2310-SELECT-UPC' TO  PV-PARAGRAPH-NAME        14200000
109900             PERFORM 9999-SQL-ABEND                               14210000
110000     END-EVALUATE.                                                14220000
110100* ADDED CODE TO RETRIEVE VALUES FROM XLV_VND_STYL                 14230000
110200 2320-SELECT-VND-STYL.                                            14240000
110300     MOVE XL001-VND-STYL-SQLCODE TO SQLCODE.                      14250000
110400     EVALUATE TRUE                                                14260000
110500         WHEN XL001-VND-STYL-CONTENTION                           14270000
110600              MOVE '7010-SELECT-SKU-BY-SKU'                       14280000
110700                                     TO PV-ABEND-PARAGRAPH        14290000
110800              MOVE 'XL001-VND-STYL-CONTENTION'                    14300000
110900                                     TO PV-ABEND-MESSAGE-TEXT     14310000
111000              MOVE XL001-VND-STYL-SQLCODE TO PV-SQLCODE           14320000
111100              MOVE 'XLV_VND_STYL'    TO PV-DB2-VIEW-NAME          14330000
111200              PERFORM 9200-PROCESS-ABEND                          14340000
111300         WHEN XL001-VND-STYL-SQLCODE = +0                         14350000
111400              CONTINUE                                            14360000
111500         WHEN OTHER                                               14370000
111600             PERFORM 9200-PROCESS-ABEND                           14380000
111700     END-EVALUATE.                                                14390000
111800*----------------------------------------------------------------*14400000
111900* CHANGES MADE FOR WR # 21361 ENDS HERE.                         *14410000
112000*----------------------------------------------------------------*14420000
112100                                                                  14430000
117200******************************************************************14440000
117300* 3000-CHECK-PICKING-ERRORS.                                     *14450000
117400*  THIS PROCEDURE WILL GET ALL THE UNITS WITH PICKING EXCEPTIONS *14460000
117500*  AND ADD THE QUANTITY TO THE APPROPRIATE BUCKET ON THE OUTPUT  *14470000
117600*  FILE                                                          *14480000
117700******************************************************************14490000
117800 3000-CHECK-PICKING-ERRORS.                                       14500000
117900                                                                  14510000
118000     MOVE PV-HOLD-AUD-CNTL-NBR          TO DK-AUD-CNTL-NBR        14520000
118100     MOVE PV-HOLD-PO-NBR                TO DK-PO-NBR              14530000
118200     MOVE PV-HOLD-REC-SEQ-NBR           TO DK-REC-SEQ-NBR         14540000
118300     MOVE PV-HOLD-UPC-NBR               TO DK-UPC-NBR             14550000
118400     INITIALIZE PV-HOLD-TMST.                                     14560000
118500                                                                  14570000
118600     PERFORM 7000-OPEN-PICKING-CURSOR.                            14580000
118700     PERFORM 7020-FETCH-PICKING-CURSOR.                           14590000
118800                                                                  14600000
118900     PERFORM UNTIL PS-END-OF-PICKING-CURSOR                       14610000
119000*        ADD THE QUANTITY TO THE APPROPRIATE BUCKET               14620000
119100         EVALUATE SUEXCP-VILN-GP-SEQ-NBR                          14630000
119200           WHEN PC-STYLE-SUB-VILN                                 14640000
119300           WHEN PC-NO-DC-OTR-VILN                                 14650000
119400           WHEN PC-NO-PBS-ALLOC-VILN                              14660000
119500               MOVE 'SU005-STYLE-SUB'     TO PV-FIELD-NAME        14670000
119600               COMPUTE SU005-STYLE-SUB =                          14680000
119700                       SU005-STYLE-SUB + PV-DB2-COUNT             14690000
119800               ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR    14700000
119900               END-COMPUTE                                        14710000
120000                                                                  14720000
120100           WHEN PC-DMGD-MDSE-VILN                                 14730000
120200               MOVE 'SU005-DAMAGED-UNITS'  TO PV-FIELD-NAME       14740000
120300               COMPUTE SU005-DAMAGED-UNITS =                      14750000
120400                       SU005-DAMAGED-UNITS + PV-DB2-COUNT         14760000
120500               ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR    14770000
120600               END-COMPUTE                                        14780000
120700         END-EVALUATE                                             14790000
120800                                                                  14800000
120900*        INCREMENT THE TOTAL ERROR QUANTITY                       14810000
121000*        ADD +1                    TO SU005-TOT-PIC-ERR           14820000
121000         ADD PV-DB2-COUNT          TO SU005-TOT-PIC-ERR           14830000
121100                                                                  14840000
121200         PERFORM 7020-FETCH-PICKING-CURSOR                        14850000
121300     END-PERFORM.                                                 14860000
121400                                                                  14870000
121500     PERFORM 7010-CLOSE-PICKING-CURSOR.                           14880000
121600*                                                                 14890000
121700                                                                  14900000
121800*                                                                 14910000
121900******************************************************************14920000
122000* 3100-CHECK-TICKETING-ERRORS.                                   *14930000
122100*  THIS PROCEDURE WILL GET ALL THE UNITS WITH TICKETING          *14940000
122200*  EXCEPTION AND ADD THE QUANTITY TO THE APPROPRIATE BUCKET       14950000
122300*  ON THE OUTPUT FILE.                                           *14960000
122400******************************************************************14970000
122500 3100-CHECK-TICKETING-ERRORS.                                     14980000
122600                                                                  14990000
122700     MOVE PV-HOLD-AUD-CNTL-NBR          TO DK-AUD-CNTL-NBR        15000000
122800     MOVE PV-HOLD-PO-NBR                TO DK-PO-NBR              15010000
122900     MOVE PV-HOLD-REC-SEQ-NBR           TO DK-REC-SEQ-NBR         15020000
123000     MOVE PV-HOLD-UPC-NBR               TO DK-UPC-NBR             15030000
123100     INITIALIZE PV-HOLD-TMST.                                     15040000
123200                                                                  15050000
123300     PERFORM 7100-OPEN-TICKETING-CURSOR.                          15060000
123400     PERFORM 7120-FETCH-TICKETING-CURSOR.                         15070000
123500                                                                  15080000
123600     PERFORM UNTIL PS-END-OF-TICKETING-CURSOR                     15090000
123700*    ADD THE QUANTITY TO THE APPROPRIATE BUCKET                   15100000
123800         EVALUATE SUEXCP-VILN-GP-SEQ-NBR                          15110000
123900           WHEN PC-NO-BARCODE-VILN                                15120000
124000               MOVE 'PV-TICKET-NO-BARCODE' TO PV-FIELD-NAME       15130000
124100               COMPUTE PV-TICKET-NO-BARCODE =                     15140000
124200                       PV-TICKET-NO-BARCODE + PV-DB2-COUNT        15150000
124300               ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR    15160000
124400               END-COMPUTE                                        15170000
124500                                                                  15180000
124600           WHEN PC-DMGD-BARCODE-VILN                              15190000
124700               MOVE 'PV-TICKET-DAMAGED-BARCODE'                   15200000
124800                                            TO PV-FIELD-NAME      15210000
124900               COMPUTE PV-TICKET-DAMAGED-BARCODE =                15220000
125000                       PV-TICKET-DAMAGED-BARCODE +    PV-DB2-COUNT15230000
125100               ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR    15240000
125200               END-COMPUTE                                        15250000
125300                                                                  15260000
125400           WHEN PC-NO-UPC-VILN                                    15270000
125500               MOVE 'PV-TICKET-NO-UPC'      TO PV-FIELD-NAME      15280000
125600               COMPUTE PV-TICKET-NO-UPC =                         15290000
125700                       PV-TICKET-NO-UPC      + PV-DB2-COUNT       15300000
125800               ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR    15310000
125900               END-COMPUTE                                        15320000
126000                                                                  15330000
126100           WHEN PC-UPC-NOT-FOUND-VILN                             15340000
126200               MOVE 'PV-TICKET-WRONG-UPC' TO PV-FIELD-NAME        15350000
126300               COMPUTE PV-TICKET-WRONG-UPC =                      15360000
126400                       PV-TICKET-WRONG-UPC + PV-DB2-COUNT         15370000
126500               ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR    15380000
126600               END-COMPUTE                                        15390000
126700                                                                  15400000
126800           WHEN PC-SKU-NOT-FOUND-VILN                             15410000
126900           WHEN PC-WRONG-DEPT-TKT-VILN                            15420000
127000           WHEN PC-WRONG-RETAIL-TKT-VILN                          15430000
127100           WHEN PC-WRONG-COLOR-TKT-VILN                           15440000
127200           WHEN PC-WRONG-SIZE-TKT-VILN                            15450000
127300           WHEN PC-WRONG-CLASS-TKT-VILN                           15460000
127400           WHEN PC-WRONG-SKU-TKT-VILN                             15470000
127500           WHEN PC-WRONG-STYLE-TKT-VILN                           15480000
127600           WHEN PC-WRONG-STYLE-MDSE-VILN                          15490000
127800           WHEN PC-WRG-TKT-MDSE-OK-VILN                           15500000
127800           WHEN PC-WRG-BOX-ID                                     15510000
127900           WHEN PC-NO-TAG-VILN                                    15520000
128000               MOVE 'PV-TICKET-WRONG-TICKET' TO PV-FIELD-NAME     15530000
128100               COMPUTE PV-TICKET-WRONG-TICKET =                   15540000
128200                       PV-TICKET-WRONG-TICKET + PV-DB2-COUNT      15550000
128300               ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR    15560000
128400               END-COMPUTE                                        15570000
128500                                                                  15580000
128600           WHEN PC-NO-TAG-TICKET-VILN                             15590000
128700               MOVE 'PV-TICKET-MISSING-TICKET' TO    PV-FIELD-NAME15600000
128800               COMPUTE PV-TICKET-MISSING-TICKET =                 15610000
128900                       PV-TICKET-MISSING-TICKET + PV-DB2-COUNT    15620000
129000               ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR    15630000
129100               END-COMPUTE                                        15640000
129200                                                                  15650000
129300           WHEN PC-WRONG-RETAIL-MDSE-VILN                         15660000
129400           WHEN PC-WRONG-COLOR-MDSE-VILN                          15670000
129500           WHEN PC-WRONG-SIZE-MDSE-VILN                           15680000
129600           WHEN PC-SIZE-STRIP-MDSE-VILN                           15690000
129700               MOVE 'PV-TICKET-WRONG-LABEL' TO PV-FIELD-NAME      15700000
129800               COMPUTE PV-TICKET-WRONG-LABEL =                    15710000
129900                       PV-TICKET-WRONG-LABEL +                    15720000
130000                       PV-DB2-COUNT                               15730000
130100               ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR    15740000
130200               END-COMPUTE                                        15750000
130300                                                                  15760000
130400         END-EVALUATE                                             15770000
130500                                                                  15780000
130600*        INCREMENT THE TOTAL TICKETING ERROR QUANTITY             15790000
130700*        ADD +1                    TO PV-TOT-TIC-ERR              15800000
130700         ADD PV-DB2-COUNT          TO PV-TOT-TIC-ERR              15810000
130800                                                                  15820000
130900*        IF THIS IS A NEW UNIT (DIFFERENT SCANS) INCREMENT THE    15830000
131000*        TOTAL UNITS IN TICKETING ERROR QUANTITY                  15840000
131100         IF SUEXCP-SCN-TMST NOT EQUAL PV-HOLD-TMST                15850000
131200*            ADD +1                TO PV-TOT-UNITS-IN-TIC-ERR     15860000
131200             ADD PV-DB2-COUNT      TO PV-TOT-UNITS-IN-TIC-ERR     15870000
131300             MOVE SUEXCP-SCN-TMST  TO PV-HOLD-TMST                15880000
131400         END-IF                                                   15890000
131500                                                                  15900000
131600*        NOTHING IS DONE WITH THE UNITS IN ERROR FIELD...FOR      15910000
131700*        PICKING ERRORS, THIS FIELDS IS CALCULATED ALREADY (FROM  15920000
131800*        THE OVER/SHORT PROCESSESSING THAT OCCURRED EARLIER IN    15930000
131900*        THE JOB.                                                 15940000
132000                                                                  15950000
132100         PERFORM 7120-FETCH-TICKETING-CURSOR                      15960000
132200     END-PERFORM.                                                 15970000
132300                                                                  15980000
132400     PERFORM 7110-CLOSE-TICKETING-CURSOR.                         15990000
132500*                                                                 16000000
      *SB 11/15/13 - BEGIN PR#5148D                                     16010000
121900******************************************************************16020000
122000* 3200-CHECK-RFID-ERRORS.                                        *16030000
122100*  THIS PROCEDURE WILL GET ALL THE UNITS WITH RFID EXCEPTIONS    *16040000
122200*  AND ADD THE QUANTITY TO THE APPROPRIATE BUCKET ON THE OUTPUT  *16050000
122300*  FILE.                                                         *16060000
122400******************************************************************16070000
122500 3200-CHECK-RFID-ERRORS.                                          16080000
122600                                                                  16090000
122700     MOVE PV-HOLD-AUD-CNTL-NBR          TO DK-AUD-CNTL-NBR        16100000
122800     MOVE PV-HOLD-PO-NBR                TO DK-PO-NBR              16110000
122900     MOVE PV-HOLD-REC-SEQ-NBR           TO DK-REC-SEQ-NBR         16120000
123000     MOVE PV-HOLD-UPC-NBR               TO DK-UPC-NBR             16130000
123100     INITIALIZE PV-HOLD-TMST.                                     16140000
123200                                                                  16150000
123300     PERFORM 7200-OPEN-RFID-CURSOR.                               16160000
123400     PERFORM 7220-FETCH-RFID-CURSOR.                              16170000
123500                                                                  16180000
123600     PERFORM UNTIL PS-END-OF-RFID-CURSOR                          16190000
123700*    ADD THE QUANTITY TO THE APPROPRIATE BUCKET                   16200000
123800         EVALUATE SUEXCP-VILN-GP-SEQ-NBR                          16210000
124600           WHEN PC-RFID-UPC-MISPCK                                16220000
124700               MOVE 'PV-RFID-TKT-NO-EPC'    TO PV-FIELD-NAME      16230000
      *SB 04/10/14 - BEGIN PR#5148D                                     16231000
      *SB 03/21/14 - BEGIN PR#5148D                                     16240000
      *              IF PV-RFID-COUNT > 0                               16250000
124900*                 COMPUTE PV-RFID-TKT-NO-EPC =                    16260000
125000*                         PV-RFID-TKT-NO-EPC    + PV-RFID-COUNT   16270000
125100*                 ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR 16280000
125200*                 END-COMPUTE                                     16290000
      *              ELSE                                               16300000
124900*                 COMPUTE PV-RFID-TKT-NO-EPC =                    16310000
125000*                         PV-RFID-TKT-NO-EPC    + PV-DB2-COUNT    16320000
125100*                 ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR 16330000
125200*                 END-COMPUTE                                     16340000
      *              END-IF                                             16350000
      *SB 03/21/14 - END   PR#5148D                                     16360000
124900                  COMPUTE PV-RFID-TKT-NO-EPC =                    16360100
125000                          PV-RFID-TKT-NO-EPC    + 1               16360200
125100                  ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR 16360300
125200                  END-COMPUTE                                     16360400
      *SB 04/10/14 - END   PR#5148D                                     16361000
125300                                                                  16370000
124600           WHEN PC-RFID-TKT-CLR                                   16380000
124700               MOVE 'PV-RFID-TKT-CLR'       TO PV-FIELD-NAME      16390000
124900               COMPUTE PV-RFID-TKT-CLR =                          16400000
125000                       PV-RFID-TKT-CLR       + PV-RFID-COUNT      16410000
125100               ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR    16420000
125200               END-COMPUTE                                        16430000
125300                                                                  16440000
125400           WHEN PC-RFID-TKT-SIZE                                  16450000
125500               MOVE 'PV-RFID-TKT-SIZE'      TO PV-FIELD-NAME      16460000
125600               COMPUTE PV-RFID-TKT-SIZE =                         16470000
125700                       PV-RFID-TKT-SIZE      + PV-RFID-COUNT      16480000
125800               ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR    16490000
125900               END-COMPUTE                                        16500000
126000                                                                  16510000
125400           WHEN PC-RFID-TKT-STYLE                                 16520000
125500               MOVE 'PV-RFID-TKT-STYLE'     TO PV-FIELD-NAME      16530000
125600               COMPUTE PV-RFID-TKT-STYLE =                        16540000
125700                       PV-RFID-TKT-STYLE     + PV-RFID-COUNT      16550000
125800               ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR    16560000
125900               END-COMPUTE                                        16570000
126000                                                                  16580000
126100           WHEN PC-RFID-NO-TICKET                                 16590000
126200               MOVE 'PV-RFID-NO-TICKET'     TO PV-FIELD-NAME      16600000
126300               COMPUTE PV-DB2-COUNT =                             16610000
126400                       PV-DB2-COUNT - PV-RFID-COUNT               16620000
126500               ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR    16630000
126600               END-COMPUTE                                        16640000
126300               COMPUTE PV-RFID-NO-TICKET =                        16650000
126400                       PV-RFID-NO-TICKET     + PV-DB2-COUNT       16660000
126500               ON SIZE ERROR PERFORM 9100-FIELD-OVERFLOW-ERROR    16670000
126600               END-COMPUTE                                        16680000
126700                                                                  16690000
130400         END-EVALUATE                                             16700000
130500                                                                  16710000
130600*        INCREMENT THE TOTAL RFID ERROR QUANTITY                  16720000
123800         EVALUATE SUEXCP-VILN-GP-SEQ-NBR                          16730000
126100             WHEN PC-RFID-NO-TICKET                               16740000
130700                  ADD PV-DB2-COUNT     TO PV-TOT-RFID-ERR         16750000
      *SB 04/10/14 - BEGIN PR#5148D                                     16750100
      *SB 03/28/14 - BEGIN PR#5148D                                     16751000
                   WHEN PC-RFID-UPC-MISPCK                              16760000
      *                 IF PV-RFID-COUNT > 0                            16770000
      *                    ADD PV-RFID-COUNT TO PV-TOT-RFID-ERR         16780000
      *                 ELSE                                            16790000
      *                    ADD PV-DB2-COUNT  TO PV-TOT-RFID-ERR         16800000
      *                 END-IF                                          16810000
      *SB 03/28/14 - END   PR#5148D                                     16811000
                        ADD 1             TO PV-TOT-RFID-ERR            16811100
      *SB 04/10/14 - END   PR#5148D                                     16812000
126100             WHEN OTHER                                           16820000
130700                  ADD PV-RFID-COUNT    TO PV-TOT-RFID-ERR         16830000
130400         END-EVALUATE                                             16840000
130800                                                                  16850000
130900*        IF THIS IS A NEW UNIT (DIFFERENT SCANS) INCREMENT THE    16860000
131000*        TOTAL UNITS IN TICKETING ERROR QUANTITY                  16870000
131100         IF SUEXCP-SCN-TMST NOT EQUAL PV-HOLD-TMST                16880000
123800         EVALUATE SUEXCP-VILN-GP-SEQ-NBR                          16890000
126100             WHEN PC-RFID-NO-TICKET                               16900000
130700              ADD PV-DB2-COUNT     TO PV-TOT-UNITS-IN-RFID-ERR    16910000
      *SB 04/10/14 - BEGIN PR#5148D                                     16910100
      *SB 03/28/14 - BEGIN PR#5148D                                     16911000
      *            WHEN PC-RFID-UPC-MISPCK                              16920000
      *                 IF PV-RFID-COUNT > 0                            16930000
      *                    ADD PV-RFID-COUNT TO PV-TOT-UNITS-IN-RFID-ERR16940000
      *                 ELSE                                            16950000
      *                    ADD PV-DB2-COUNT  TO PV-TOT-UNITS-IN-RFID-ERR16960000
      *                 END-IF                                          16970000
      *SB 03/28/14 - END   PR#5148D                                     16971000
      *SB 04/10/14 - END   PR#5148D                                     16972000
126100             WHEN OTHER                                           16980000
131200             ADD PV-RFID-COUNT     TO PV-TOT-UNITS-IN-RFID-ERR    16990000
130400         END-EVALUATE                                             17000000
131300             MOVE SUEXCP-SCN-TMST  TO PV-HOLD-TMST                17010000
131400         END-IF                                                   17020000
131500                                                                  17030000
131600*        NOTHING IS DONE WITH THE UNITS IN ERROR FIELD...FOR      17040000
131700*        PICKING ERRORS, THIS FIELDS IS CALCULATED ALREADY (FROM  17050000
131800*        THE OVER/SHORT PROCESSESSING THAT OCCURRED EARLIER IN    17060000
131900*        THE JOB.                                                 17070000
132000                                                                  17080000
132100         PERFORM 7220-FETCH-RFID-CURSOR                           17090000
132200     END-PERFORM.                                                 17100000
132300                                                                  17110000
132400     PERFORM 7210-CLOSE-RFID-CURSOR.                              17120000
132500*                                                                 17130000
      *SB 11/15/13 - END PR#5148D                                       17140000
132600*                                                                 17150000
132700******************************************************************17160000
132800* 7000-OPEN-PICKING-CURSOR.                                      *17170000
132900*  THIS PROCEDURE WILL OPEN THE PICKING CURSOR.                   17180000
133000******************************************************************17190000
133100 7000-OPEN-PICKING-CURSOR.                                        17200000
133200                                                                  17210000
133300     EXEC SQL                                                     17220000
133400          OPEN PICKING_CURSOR                                     17230000
133500     END-EXEC.                                                    17240000
133600                                                                  17250000
133700     EVALUATE TRUE                                                17260000
133800         WHEN SQLCODE = ZERO                                      17270000
133900              SET PS-NOT-END-OF-PICKING-CURSOR                    17280000
134000                               TO  TRUE                           17290000
134100         WHEN SQLWARN0 NOT EQUAL SPACE                            17300000
134200         WHEN SQLCODE NOT EQUAL ZERO                              17310000
134300              MOVE '7000-OPEN-PICKING-CURSOR'                     17320000
134400                               TO  PV-PARAGRAPH-NAME              17330000
134500              MOVE 'OPEN PICKING_CURSOR'                          17340000
134600                               TO  PV-DB2-OPERATION-ATTEMPTED     17350000
134700              PERFORM 9999-SQL-ABEND                              17360000
134800     END-EVALUATE.                                                17370000
134900*                                                                 17380000
135000******************************************************************17390000
135100* 7010-CLOSE-PICKING-CURSOR.                                     *17400000
135200*  THIS PROCEDURE WILL CLOSE THE PICKING_CURSOR.                  17410000
135300******************************************************************17420000
135400 7010-CLOSE-PICKING-CURSOR.                                       17430000
135500                                                                  17440000
135600     EXEC SQL                                                     17450000
135700         CLOSE PICKING_CURSOR                                     17460000
135800     END-EXEC.                                                    17470000
135900                                                                  17480000
136000     EVALUATE TRUE                                                17490000
136100         WHEN SQLWARN0 NOT EQUAL SPACE                            17500000
136200         WHEN SQLCODE NOT EQUAL ZERO                              17510000
136300              DISPLAY 'PO NBR: '             DK-PO-NBR            17520000
136400              DISPLAY 'RECEIVER SEQ NBR: '   DK-REC-SEQ-NBR       17530000
136500              DISPLAY 'UPC NUMBER: '         DK-UPC-NBR           17540000
136600              DISPLAY 'AUDIT CNTL NBR: '     DK-AUD-CNTL-NBR      17550000
136700              MOVE '7010-CLOSE-PICKING-CURSOR'                    17560000
136800                               TO  PV-PARAGRAPH-NAME              17570000
136900              MOVE 'CLOSE PICKING_CURSOR'                         17580000
137000                               TO  PV-DB2-OPERATION-ATTEMPTED     17590000
137100              PERFORM 9999-SQL-ABEND                              17600000
137200     END-EVALUATE.                                                17610000
137300                                                                  17620000
137400*                                                                 17630000
137500******************************************************************17640000
137600* 7020-FETCH-PICKING-CURSOR                                      *17650000
137700*  THIS PROCEDURE WILL FETCH THE PICKING-CURSOR.                  17660000
137800******************************************************************17670000
137900 7020-FETCH-PICKING-CURSOR.                                       17680000
138000                                                                  17690000
138100     EXEC SQL                                                     17700000
138200          FETCH PICKING_CURSOR                                    17710000
138300          INTO                                                    17720000
138400                 :SUEXCP-SCN-TMST                                 17730000
138500               , :SUEXCP-VILN-GP-SEQ-NBR                          17740000
138600               , :PV-DB2-COUNT                                    17750000
138700     END-EXEC.                                                    17760000
138800                                                                  17770000
138900     EVALUATE TRUE                                                17780000
139000         WHEN SQLCODE = ZERO                                      17790000
139100              CONTINUE                                            17800000
139200                                                                  17810000
139300         WHEN SQLCODE = +100                                      17820000
139400         WHEN SQLCODE = -305                                      17830000
139500              SET PS-END-OF-PICKING-CURSOR                        17840000
139600                               TO  TRUE                           17850000
139700                                                                  17860000
139800         WHEN SQLWARN0 NOT EQUAL SPACE                            17870000
139900         WHEN SQLCODE NOT EQUAL ZERO                              17880000
140000              DISPLAY 'PO NBR: '             DK-PO-NBR            17890000
140100              DISPLAY 'RECEIVER SEQ NBR: '   DK-REC-SEQ-NBR       17900000
140200              DISPLAY 'UPC NUMBER: '         DK-UPC-NBR           17910000
140300              DISPLAY 'AUDIT CNTL NBR: '     DK-AUD-CNTL-NBR      17920000
140400              MOVE '7020-FETCH-PICKING-CURSOR'                    17930000
140500                               TO  PV-PARAGRAPH-NAME              17940000
140600              MOVE 'FETCH PICKING_CURSOR'                         17950000
140700                               TO  PV-DB2-OPERATION-ATTEMPTED     17960000
140800              PERFORM 9999-SQL-ABEND                              17970000
140900     END-EVALUATE.                                                17980000
141000                                                                  17990000
141100*                                                                 18000000
141200******************************************************************18010000
141300* 7100-OPEN-TICKETING-CURSOR.                                    *18020000
141400*  THIS PROCEDURE WILL OPEN THE TICKETING CURSOR.                 18030000
141500******************************************************************18040000
141600 7100-OPEN-TICKETING-CURSOR.                                      18050000
141700                                                                  18060000
141800     EXEC SQL                                                     18070000
141900          OPEN TICKETING_CURSOR                                   18080000
142000     END-EXEC.                                                    18090000
142100                                                                  18100000
142200     EVALUATE TRUE                                                18110000
142300         WHEN SQLCODE = ZERO                                      18120000
142400              SET PS-NOT-END-OF-TICKETING-CURSOR                  18130000
142500                               TO  TRUE                           18140000
142600         WHEN SQLWARN0 NOT EQUAL SPACE                            18150000
142700         WHEN SQLCODE NOT EQUAL ZERO                              18160000
142800              DISPLAY 'PO NBR: '             DK-PO-NBR            18170000
142900              DISPLAY 'RECEIVER SEQ NBR: '   DK-REC-SEQ-NBR       18180000
143000              DISPLAY 'UPC NUMBER: '         DK-UPC-NBR           18190000
143100              DISPLAY 'AUDIT CNTL NBR: '     DK-AUD-CNTL-NBR      18200000
143200              MOVE '7100-OPEN-TICKETING-CURSOR'                   18210000
143300                               TO  PV-PARAGRAPH-NAME              18220000
143400              MOVE 'OPEN TICKETING_CURSOR'                        18230000
143500                               TO  PV-DB2-OPERATION-ATTEMPTED     18240000
143600              PERFORM 9999-SQL-ABEND                              18250000
143700     END-EVALUATE.                                                18260000
143800*                                                                 18270000
143900******************************************************************18280000
144000* 7110-CLOSE-TICKETING-CURSOR.                                   *18290000
144100*  THIS PROCEDURE WILL CLOSE THE TICKETING_CURSOR.                18300000
144200******************************************************************18310000
144300 7110-CLOSE-TICKETING-CURSOR.                                     18320000
144400                                                                  18330000
144500     EXEC SQL                                                     18340000
144600         CLOSE TICKETING_CURSOR                                   18350000
144700     END-EXEC.                                                    18360000
144800                                                                  18370000
144900     EVALUATE TRUE                                                18380000
145000         WHEN SQLWARN0 NOT EQUAL SPACE                            18390000
145100         WHEN SQLCODE NOT EQUAL ZERO                              18400000
145200              DISPLAY 'PO NBR: '             DK-PO-NBR            18410000
145300              DISPLAY 'RECEIVER SEQ NBR: '   DK-REC-SEQ-NBR       18420000
145400              DISPLAY 'UPC NUMBER: '         DK-UPC-NBR           18430000
145500              DISPLAY 'AUDIT CNTL NBR: '     DK-AUD-CNTL-NBR      18440000
145600              MOVE '7110-CLOSE-TICKETING-CURSOR'                  18450000
145700                               TO  PV-PARAGRAPH-NAME              18460000
145800              MOVE 'CLOSE TICKETING_CURSOR'                       18470000
145900                               TO  PV-DB2-OPERATION-ATTEMPTED     18480000
146000              PERFORM 9999-SQL-ABEND                              18490000
146100     END-EVALUATE.                                                18500000
146200                                                                  18510000
146300*                                                                 18520000
146400******************************************************************18530000
146500* 7120-FETCH-TICKETING-CURSOR                                    *18540000
146600*  THIS PROCEDURE WILL FETCH THE TICKETING-CURSOR.                18550000
146700******************************************************************18560000
146800 7120-FETCH-TICKETING-CURSOR.                                     18570000
146900                                                                  18580000
147000     EXEC SQL                                                     18590000
147100          FETCH TICKETING_CURSOR                                  18600000
147200          INTO                                                    18610000
147300                 :SUEXCP-SCN-TMST                                 18620000
147400               , :SUEXCP-VILN-GP-SEQ-NBR                          18630000
147500               , :PV-DB2-COUNT                                    18640000
147600     END-EXEC.                                                    18650000
147700                                                                  18660000
147800     EVALUATE TRUE                                                18670000
147900         WHEN SQLCODE = ZERO                                      18680000
148000              CONTINUE                                            18690000
148100                                                                  18700000
148200         WHEN SQLCODE = +100                                      18710000
148300         WHEN SQLCODE = -305                                      18720000
148400              SET PS-END-OF-TICKETING-CURSOR                      18730000
148500                               TO  TRUE                           18740000
148600                                                                  18750000
148700         WHEN SQLWARN0 NOT EQUAL SPACE                            18760000
148800         WHEN SQLCODE NOT EQUAL ZERO                              18770000
148900              DISPLAY 'PO NBR: '             DK-PO-NBR            18780000
149000              DISPLAY 'RECEIVER SEQ NBR: '   DK-REC-SEQ-NBR       18790000
149100              DISPLAY 'UPC NUMBER: '         DK-UPC-NBR           18800000
149200              DISPLAY 'AUDIT CNTL NBR: '     DK-AUD-CNTL-NBR      18810000
149300              MOVE '7120-FETCH-TICKETING-CURSOR'                  18820000
149400                               TO  PV-PARAGRAPH-NAME              18830000
149500              MOVE 'FETCH TICKETING_CURSOR'                       18840000
149600                               TO  PV-DB2-OPERATION-ATTEMPTED     18850000
149700              PERFORM 9999-SQL-ABEND                              18860000
149800     END-EVALUATE.                                                18870000
149900                                                                  18880000
      *SB 11/15/13 - BEGIN PR#5148D                                     18890000
141200******************************************************************18900000
141300* 7200-OPEN-RFID-CURSOR.                                          18910000
141400*  THIS PROCEDURE WILL OPEN THE RFID CURSOR.                      18920000
141500******************************************************************18930000
141600 7200-OPEN-RFID-CURSOR.                                           18940000
141700                                                                  18950000
141800     EXEC SQL                                                     18960000
141900          OPEN RFID_CURSOR                                        18970000
142000     END-EXEC.                                                    18980000
142100                                                                  18990000
142200     EVALUATE TRUE                                                19000000
142300         WHEN SQLCODE = ZERO                                      19010000
142400              SET PS-NOT-END-OF-RFID-CURSOR                       19020000
142500                               TO  TRUE                           19030000
142600         WHEN SQLWARN0 NOT EQUAL SPACE                            19040000
142700         WHEN SQLCODE NOT EQUAL ZERO                              19050000
142800              DISPLAY 'PO NBR: '             DK-PO-NBR            19060000
142900              DISPLAY 'RECEIVER SEQ NBR: '   DK-REC-SEQ-NBR       19070000
143000              DISPLAY 'UPC NUMBER: '         DK-UPC-NBR           19080000
143100              DISPLAY 'AUDIT CNTL NBR: '     DK-AUD-CNTL-NBR      19090000
143200              MOVE '7200-OPEN-RFID-CURSOR'                        19100000
143300                               TO  PV-PARAGRAPH-NAME              19110000
143400              MOVE 'OPEN RFID_CURSOR'                             19120000
143500                               TO  PV-DB2-OPERATION-ATTEMPTED     19130000
143600              PERFORM 9999-SQL-ABEND                              19140000
143700     END-EVALUATE.                                                19150000
143800*                                                                 19160000
143900******************************************************************19170000
144000* 7210-CLOSE-RFID-CURSOR.                                         19180000
144100*  THIS PROCEDURE WILL CLOSE THE RFID_CURSOR.                     19190000
144200******************************************************************19200000
144300 7210-CLOSE-RFID-CURSOR.                                          19210000
144400                                                                  19220000
144500     EXEC SQL                                                     19230000
144600         CLOSE RFID_CURSOR                                        19240000
144700     END-EXEC.                                                    19250000
144800                                                                  19260000
144900     EVALUATE TRUE                                                19270000
145000         WHEN SQLWARN0 NOT EQUAL SPACE                            19280000
145100         WHEN SQLCODE NOT EQUAL ZERO                              19290000
145200              DISPLAY 'PO NBR: '             DK-PO-NBR            19300000
145300              DISPLAY 'RECEIVER SEQ NBR: '   DK-REC-SEQ-NBR       19310000
145400              DISPLAY 'UPC NUMBER: '         DK-UPC-NBR           19320000
145500              DISPLAY 'AUDIT CNTL NBR: '     DK-AUD-CNTL-NBR      19330000
145600              MOVE '7210-CLOSE-RFID-CURSOR'                       19340000
145700                               TO  PV-PARAGRAPH-NAME              19350000
145800              MOVE 'CLOSE RFID_CURSOR'                            19360000
145900                               TO  PV-DB2-OPERATION-ATTEMPTED     19370000
146000              PERFORM 9999-SQL-ABEND                              19380000
146100     END-EVALUATE.                                                19390000
146200                                                                  19400000
146300*                                                                 19410000
146400******************************************************************19420000
146500* 7220-FETCH-RFID-CURSOR                                          19430000
146600*  THIS PROCEDURE WILL FETCH THE RFID-CURSOR.                     19440000
146700******************************************************************19450000
146800 7220-FETCH-RFID-CURSOR.                                          19460000
146900                                                                  19470000
147000     EXEC SQL                                                     19480000
147100          FETCH RFID_CURSOR                                       19490000
147200          INTO                                                    19500000
147300                 :SUEXCP-SCN-TMST                                 19510000
147400               , :SUEXCP-VILN-GP-SEQ-NBR                          19520000
147500               , :PV-DB2-COUNT                                    19530000
147500               , :PV-RFID-COUNT                                   19540000
147600     END-EXEC.                                                    19550000
147700                                                                  19560000
147800     EVALUATE TRUE                                                19570000
147900         WHEN SQLCODE = ZERO                                      19580000
148000              CONTINUE                                            19590000
148100                                                                  19600000
148200         WHEN SQLCODE = +100                                      19610000
148300         WHEN SQLCODE = -305                                      19620000
148400              SET PS-END-OF-RFID-CURSOR                           19630000
148500                               TO  TRUE                           19640000
148600                                                                  19650000
148700         WHEN SQLWARN0 NOT EQUAL SPACE                            19660000
148800         WHEN SQLCODE NOT EQUAL ZERO                              19670000
148900              DISPLAY 'PO NBR: '             DK-PO-NBR            19680000
149000              DISPLAY 'RECEIVER SEQ NBR: '   DK-REC-SEQ-NBR       19690000
149100              DISPLAY 'UPC NUMBER: '         DK-UPC-NBR           19700000
149200              DISPLAY 'AUDIT CNTL NBR: '     DK-AUD-CNTL-NBR      19710000
149300              MOVE '7220-FETCH-RFID-CURSOR'                       19720000
149400                               TO  PV-PARAGRAPH-NAME              19730000
149500              MOVE 'FETCH RFID_CURSOR'                            19740000
149600                               TO  PV-DB2-OPERATION-ATTEMPTED     19750000
149700              PERFORM 9999-SQL-ABEND                              19760000
149800     END-EVALUATE.                                                19770000
      *SB 11/15/13 - END PR#5148D                                       19780000
149900                                                                  19790000
150000*                                                                 19800000
150100******************************************************************19810000
150200* 8000-READ-VND-OVER-SHORT.                                       19820000
150300*    READ THE VENDOR OVER/SHORT FILE -- THIS FILE WILL BE USED AS 19830000
150400*  THE DRIVER OF THE EXTRACT                                      19840000
150500******************************************************************19850000
150600 8000-READ-VND-OVER-SHORT.                                        19860000
150700     READ OS-VND-OVER-SHORT-FILE                                  19870000
150800        INTO SU003-EXTRACT-RECORD                                 19880000
150900     AT END                                                       19890000
151000        SET PS-EOF-VND-OVER-SHORT        TO TRUE                  19900000
151100        MOVE +999999999                  TO SU003-AUD-CNTL-NBR    19910000
151200     END-READ.                                                    19920000
151300                                                                  19930000
151400*                                                                 19940000
151500******************************************************************19950000
151600* 8001-READ-RCVR-OVER-SHORT.                                      19960000
151700******************************************************************19970000
151800 8001-READ-RCVR-OVER-SHORT.                                       19980000
151900     READ OS-RCVR-OVER-SHORT-FILE                                 19990000
152000        INTO SU004-EXTRACT-RECORD                                 20000000
152100     AT END                                                       20010000
152200        SET PS-EOF-RCVR-OVER-SHORT       TO TRUE                  20020000
152300        MOVE +999999999                  TO SU004-AUD-CNTL-NBR    20030000
152400     END-READ.                                                    20040000
152500                                                                  20050000
152600*                                                                 20060000
152700******************************************************************20070000
152800* 8100-WRITE-EXTRACT-FILE.                                        20080000
152900******************************************************************20090000
153000 8100-WRITE-EXTRACT-FILE.                                         20100000
153100        WRITE AS-AUDIT-SUM-EXTRACT-REC                            20110000
153200           FROM SU005-EXTRACT-RECORD.                             20120000
153300                                                                  20130000
      *SB 11/19/13 - BEGIN PR#5148D                                     20140000
       8200-READ-CARDIN-FILE.                                           20150000
      ******************************************************************20160000
                                                                        20170000
           READ CARDIN-AUDIT-NBR-FILE INTO CC-CARDIN                    20180000
              AT END                                                    20190000
                 SET PS-END-OF-CARDIN-FILE TO TRUE.                     20200000
                                                                        20210000
           IF PS-END-OF-CARDIN-FILE                                     20220000
               CONTINUE                                                 20230000
           ELSE                                                         20240000
               DISPLAY 'AUDIT NBR IS : ' CC-AUDIT-CNTL-NBR              20250000
               DISPLAY 'CARTON ID IS : ' CC-CARTON-ID                   20260000
           END-IF.                                                      20270000
      *SB 11/19/13 - END PR#5148D                                       20280000
                                                                        20290000
153400******************************************************************20300000
153500* 9000-EOJ-ROUTINE - PRINTS A GRAND TOTAL, AND CLOSES THE DRIVER  20310000
153600* CURSOR AND THE REPORT FILE.                                     20320000
153700******************************************************************20330000
153800 9000-EOJ-ROUTINE.                                                20340000
153900                                                                  20350000
154000     CLOSE  OS-VND-OVER-SHORT-FILE                                20360000
154100            OS-RCVR-OVER-SHORT-FILE                               20370000
      *SB 11/19/13 - BEGIN PR#5148D                                     20380000
                  CARDIN-AUDIT-NBR-FILE                                 20390000
      *SB 11/19/13 - END PR#5148D                                       20400000
154200            AS-AUDIT-SUM-EXTRACT-FILE.                            20410000
154300                                                                  20420000
154400                                                                  20430000
154500******************************************************************20440000
154600* 9100-FIELD-OVERFLOW-ERROR - IF ON OF THE ACCUMULATOR FIELDS    *20450000
154700* ROLLS OVER (IE THE NUMBER IS TOO BIG TO FIT) THIS PARAGRAPH    *20460000
154800* WILL ABEND THE PROGRAM                                         *20470000
154900******************************************************************20480000
155000 9100-FIELD-OVERFLOW-ERROR.                                       20490000
155100     DISPLAY '** ABEND     **'.                                   20500000
155200     DISPLAY '** PROGRAM   ** = SUKUT015'.                        20510000
155300     DISPLAY '** PROGRAM ACCUMULATOR OVERFLOW ERROR **'.          20520000
155400     DISPLAY '** THE DATA CREATES A TOTALS VALUE LARGER THAN '.   20530000
155500     DISPLAY '** THE FIELD SET-UP TO HANDLE IT.  INCREASE THE'.   20540000
155600     DISPLAY '** THE FOLLOWING FIELD WAS TOO SMALL: '.            20550000
155700     DISPLAY PV-FIELD-NAME.                                       20560000
155800                                                                  20570000
155900     MOVE +4004 TO ABEND-CODE.                                    20580000
156000     CALL 'ILBOABN0' USING ABEND-CODE.                            20590000
156100                                                                  20600000
156200******************************************************************20610000
156300* 9999-SQL-ABEND - PERFORMS THE ABEND FOR THE PROGRAM IN THE *    20620000
156400* EVENT THAT AN SQL ERROR OR WARNING CODE OCCURS. *               20630000
156500******************************************************************20640000
156600*----------------------------------------------------------------*20650000
156700*                                               ** WR # 21361    *20660000
156800* ADDED CODE TO DISPLAY MESSAGES,WHEN ABEND OCCURS FROM          *20670000
156900* LOGISTICS DOMAIN ITEM ACCESS MODULE.                           *20680000
157000*----------------------------------------------------------------*20690000
157100 9200-PROCESS-ABEND.                                              20700000
157200*                                                                 20710000
157300* SND 10/2009  DATA CONTENTION CHANGES START                      20720000
157400     IF SQLCODE                  = -904 OR -911 OR -913           20730000
157500        MOVE +4050               TO RETURN-CODE                   20740000
157600        STOP RUN                                                  20750000
157700     ELSE                                                         20760000
157800        PERFORM 9210-ABEND-PROGRAM                                20770000
157900     END-IF.                                                      20780000
158000*                                                                 20790000
158100*9200-EXIT.                                                       20800000
158200*                                                                 20810000
158300* SND 10/2009  DATA CONTENTION CHANGES END                        20820000
158400*                                                                 20830000
158500 9210-ABEND-PROGRAM.                                              20840000
158600     DISPLAY '** ABEND **       ** = SQLERROR'.                   20850000
158700     DISPLAY '** PROGRAM        ** = SUKUT015'.                   20860000
158800     DISPLAY '** ABEND PARAGRAPH **  ' PV-ABEND-PARAGRAPH.        20870000
158900     DISPLAY '** ERROR MESSAGE   **  ' PV-ABEND-MESSAGE-TEXT.     20880000
159000     DISPLAY '** SQLCODE         **  ' PV-SQLCODE.                20890000
159100     DISPLAY '** VIEW  NAME      **  ' PV-DB2-VIEW-NAME.          20900000
159200     MOVE +4013 TO PV-ABEND-CODE.                                 20910000
159300     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         20920000
159400*----------------------------------------------------------------*20930000
159500* CHANGES MADE FOR WR # 21361 ENDS HERE.                         *20940000
159600*----------------------------------------------------------------*20950000
159700 9999-SQL-ABEND.                                                  20960000
159800* SND 10/2009  DATA CONTENTION CHANGES START                      20970000
159900     IF SQLCODE                  = -904 OR -911 OR -913           20980000
160000        MOVE +4050               TO RETURN-CODE                   20990000
160100        STOP RUN                                                  21000000
160200     ELSE                                                         21010000
160300        PERFORM 9999-ABEND-PROGRAM                                21020000
160400     END-IF.                                                      21030000
160500*                                                                 21040000
160600*9999-EXIT.                                                       21050000
160700*                                                                 21060000
160800* SND 10/2009  DATA CONTENTION CHANGES END                        21070000
160900 9999-ABEND-PROGRAM.                                              21080000
161000     DISPLAY '** ABEND      **'.                                  21090000
161100     DISPLAY '** PROGRAM    ** = SUKUT015'.                       21100000
161200     DISPLAY '** PARAGRAPH  ** = ' PV-PARAGRAPH-NAME.             21110000
161300     DISPLAY '** OPERATION  ** = ' PV-DB2-OPERATION-ATTEMPTED.    21120000
161400                                                                  21130000
161500******************************************************************21140000
161600* THIS COPY BOOK MEMBER CONTAINS THE PROCEDURE DIVISION STATE-   *21150000
161700* MENTS THAT ARE REQUIRED TO UTILIZE THE DB2 ABEND MODULE        *21160000
161800* 'DSNTIAR' AND CONVERT THE SQLCA INFORMATION INTO A READABLE    *21170000
161900* FORMAT.                                                        *21180000
162000******************************************************************21190000
162100     COPY DPPD004.                                                21200000
162200                                                                  21210000
162300     MOVE +4013 TO ABEND-CODE.                                    21220000
162400     CALL 'ILBOABN0' USING ABEND-CODE.                            21230000
162500*9999-EXIT.                                                       21240000
