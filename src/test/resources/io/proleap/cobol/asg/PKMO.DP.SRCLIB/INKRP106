       ID  DIVISION.                                                    12/09/94
00002  PROGRAM-ID.         INKRP106                                     INKRP106
00003  AUTHOR.             TROY BIRK.                                      LV004
00004  INSTALLATION.       KOHLS DEPATMENT STORES.                      INKRP106
00005  DATE-WRITTEN.       OCTOBER 1993.                                INKRP106
00006  DATE-COMPILED.                                                   INKRP106
00007                                                                   INKRP106
00008 ***********************************************************       INKRP106
00009 *                                                                 INKRP106
00010 ***********************************************************       INKRP106
00011 *                  CHANGE LOG                                        CL**3
00012 ***********************************************************          CL**3
00013 * 03/94 M BLAZICH                                                    CL**3
00014 *       CHANGED LRECLS TO ACCOMODATE SCAN-LINE-NBR IN                CL**3
00015 *       FILE LAYOUTS                                                 CL**3
00016 ***********************************************************          CL**3
00013 * 03/2000  SCOTT JACKSON   CHG ID: BYRRPT                            CL**3
00014 *       CHANGE INKRP106-2 REPORTS TO FORCE A SEPERATOR PAGE          CL**3
00015 *       BETWEEN EACH CHANGE IN BUYER. THIS WILL PREVENT              CL**3
00016 *       NEXT BUYER REPORTS FROM PRINTING ON BACK OF PREVIOUS         CL**3
00016 ***********************************************************          CL**3
00013 * 05/2000  SCOTT JACKSON   CHG ID: MAY00                             CL**3
00014 *       REPORTS WERE NOT PRINTING 'FINAL' TOTALS IF ONLY 1 STR       CL**3
00015 *       WAS ON INPUT -OR- ON THE LAST STR WHERE FILE CONTAINED       CL**3
00016 *       MULTIPLE STORES. C600- WAS BYPASSING LAST STORE TOTALS.      CL**3
RB0123***********************************************************          CL**3
RB0123* 01/2001  RONNA BUTZ      CHG ID: RB0123                                 
RB0123*       THE FIRST DEPARTMENT OF THE LAST STORE IS PRINTING                
RB0123*       UNDER AS THE LAST DEPARTMENT OF THE SECOND FROM LAST              
RB0123*       STORE.                                                            
RB0123*                                                                         
RB0123*       CORRECT TO PRINT THE FIRST DEPARTMENT OF THE LAST                 
RB0123*       STORE CORRECTLY.                                                  
RB0123*                                                                         
RB0123*       ALSO, REWROTE BREAKING LOGIC AND ADDED A TABLE                    
RB0123*       TO ACCUMULATE DEPARTMENT/CLASS TOTAL DATA FOR THE                 
RB0123*       SUMMARY REPORT.  MODIFIED THE BREAKING LOGIC SO                   
RB0123*       THAT THE LOGIC IS NESTED BY LEVEL, AND THERE IS ONE               
RB0123*       PROCEDURE USED TO PROCESS THE BREAK LOGIC.                        
      ******************************************************************        
W21732* 11/2002  IGSI                                                           
W21732* CHANGED THE RECORD LENGTH OF PHY-INVENTORY-RECORD                       
W21732* FROM 82 TO 100.MADE DEPT AND CLASS NUMBER 4 DIGIT.                      
W21732* SKU SEQ NBR IS REPLACED WITH 8 DIGIT SKU NUMBER.                        
25248 ******************************************************************        
25248 * 25248  10-06-2003  UPC CAPABILITIES                                     
25248 *                    -ROD JANSSEN                                         
W26600* W26600 06-  -2004  PHYSICAL INVENTORY STORE EXPANSION                   
W26600*                    M JOHNSON                                            
W26006* W26006 02-24-2005  REMOVE REFERENCES TO OBSOLETE STORE TABLE.           
W26006*                    ERIN SEARL                                           
P28545* W28545 03-24-2006 ROD JANSSEN CYCLE INVENTORY PRICE MODULE SETUP        
      ******************************************************************        
SR3403* WR3403   06-17-2012  LARGE RETAIL    WR# W3403                 *        
SR3403*    JALAJ KUMAR  - CHANGES FOR LARGE RETAIL EXPANSION           *        
SR3403******************************************************************        
00017                                                                   INKRP106
00018  ENVIRONMENT DIVISION.                                            INKRP106
00019  CONFIGURATION SECTION.                                           INKRP106
00020  SOURCE-COMPUTER.        IBM-3090.                                INKRP106
00021  OBJECT-COMPUTER.        IBM-3090.                                INKRP106
00022  INPUT-OUTPUT SECTION.                                            INKRP106
00023  FILE-CONTROL.                                                    INKRP106
00024      SELECT PHY-INVENTORY-FILE                                    INKRP106
00025          ASSIGN TO INP01.                                         INKRP106
00026      SELECT PHY-INVENTORY-RPT-FILE                                INKRP106
00027          ASSIGN TO RPT01.                                         INKRP106
00028      SELECT BUYER-SUMMARY-RPT-FILE                                INKRP106
00029          ASSIGN TO RPT02.                                         INKRP106
00030      SKIP3                                                        INKRP106
00031  DATA DIVISION.                                                   INKRP106
00032  FILE SECTION.                                                    INKRP106
00033  FD  PHY-INVENTORY-FILE                                           INKRP106
00034      LABEL RECORDS ARE STANDARD                                   INKRP106
00035      BLOCK CONTAINS 0 RECORDS                                     INKRP106
00036      RECORDING  MODE IS F.                                        INKRP106
W21732 01  PHY-INVENTORY-RECORD         PIC X(100).                     INKRP106
00038                                                                   INKRP106
00039  FD  PHY-INVENTORY-RPT-FILE                                       INKRP106
00040      LABEL RECORDS ARE STANDARD                                   INKRP106
00041      BLOCK CONTAINS 0 RECORDS                                     INKRP106
00042      RECORDING  MODE IS F.                                        INKRP106
00043  01  PHY-INVENTORY-RPT-RECORD     PIC X(132).                     INKRP106
00044                                                                   INKRP106
00045  FD  BUYER-SUMMARY-RPT-FILE                                       INKRP106
00046      LABEL RECORDS ARE STANDARD                                   INKRP106
00047      BLOCK CONTAINS 0 RECORDS                                     INKRP106
00048      RECORDING  MODE IS F.                                        INKRP106
00049  01  BUYER-SUMMARY-RPT-RECORD     PIC X(132).                     INKRP106
00050                                                                   INKRP106
00051  WORKING-STORAGE SECTION.                                         INKRP106
00052 *                                                                 INKRP106
00053  01  ABEND-CODE                  PIC S9(04)  VALUE ZERO COMP SYNC.INKRP106
00054  01  SA-SAVE-AREAS.                                               INKRP106
W26600     05  SA-STORE-NO             PIC X(04)   VALUE SPACES.        INKRP106
25248      05  SA-STORE-NO-NUM REDEFINES                                INKRP101
W26600         SA-STORE-NO             PIC 9(04).                       INKRP101
00056      05  SA-BUYER-NAME           PIC X(20)   VALUE SPACES.        INKRP106
00057      05  SA-BUYER-NUMBER         PIC X(03)   VALUE SPACES.        INKRP106
00058      05  SA-DMA                  PIC X(02)   VALUE SPACES.        INKRP106
00059      05  SA-DEPT-CLASS.                                           INKRP106
W21732         10  SA-DEPT             PIC X(04)   VALUE SPACES.        INKRP106
W21732         10  SA-CLASS            PIC X(04)   VALUE SPACES.        INKRP106
00062 *                                                                 INKRP106
00063  01  PV-PROGRAM-VARIABLES.                                        INKRP106
00064      05  PV-MDSEAR-DESC          PIC X(30)    VALUE SPACES.       INKRP106
00065      05  PV-PARAGRAPH-NAME       PIC X(30)    VALUE SPACES.       INKRP106
00066      05  PV-DB2-OPER-ATTEMPTED   PIC X(30)    VALUE SPACES.       INKRP106
00067      05  PV-SQL-SUB              PIC 9(03)    VALUE ZERO.         INKRP106
00068      05  PV-FIRST-NAME           PIC X(12)    VALUE SPACES.       INKRP106
00069      05  FILLER REDEFINES PV-FIRST-NAME  OCCURS 12 TIMES.         INKRP106
00070          10 PV-FNAME-DIGIT       PIC X(01).                       INKRP106
00071      05  PV-LAST-NAME            PIC X(18)    VALUE SPACES.       INKRP106
00072      05  FILLER REDEFINES PV-LAST-NAME  OCCURS 18 TIMES.          INKRP106
00073          10 PV-LNAME-DIGIT       PIC X(01).                       INKRP106
00074      05  PV-FULL-NAME            PIC X(20)    VALUE SPACES.       INKRP106
00075      05  FILLER REDEFINES PV-FULL-NAME  OCCURS 20 TIMES.          INKRP106
00076          10 PV-FULLNAME-DIGIT    PIC X(01).                       INKRP106
25248      05 PV-EDIT-LOC-NBR          PIC S9(04) COMP VALUE ZEROS.             
25248      05 PV-EDIT-UPC-CODE         PIC 9(15)     VALUE ZEROS.               
25248      05 PV-EDIT-UPC-CODE-ALPHA REDEFINES                                  
25248         PV-EDIT-UPC-CODE         PIC X(15).                               
00077 *                                                                 INKRP106
00078  01  PA-PROGRAM-ACCUMULATORS                   COMP-3.            INKRP106
00079      05  PA-EXTENDED-RETAIL      PIC S9(09)V99 VALUE ZERO.        INKRP106
00080      05  PA-CLASS-QTY            PIC S9(09)    VALUE ZERO.        INKRP106
00081      05  PA-DEPT-QTY             PIC S9(09)    VALUE ZERO.        INKRP106
00082      05  PA-BUYER-QTY            PIC S9(09)    VALUE ZERO.        INKRP106
00083      05  PA-DMA-QTY              PIC S9(09)    VALUE ZERO.        INKRP106
00084      05  PA-FINAL-QTY            PIC S9(09)    VALUE ZERO.        INKRP106
00085      05  PA-CLASS-RETAIL         PIC S9(09)V99 VALUE ZERO.        INKRP106
00086      05  PA-DEPT-RETAIL          PIC S9(09)V99 VALUE ZERO.        INKRP106
00087      05  PA-BUYER-RETAIL         PIC S9(09)V99 VALUE ZERO.        INKRP106
00088      05  PA-DMA-RETAIL           PIC S9(09)V99 VALUE ZERO.        INKRP106
00089      05  PA-FINAL-RETAIL         PIC S9(09)V99 VALUE ZERO.        INKRP106
00090      05  PA-PAGE-COUNT           PIC S9(05)    VALUE ZERO.        INKRP106
00091      05  PA-PAGE-COUNT2          PIC S9(05)    VALUE ZERO.        INKRP106
00092      05  PA-EXCEPT-PAGE-COUNT    PIC S9(05)    VALUE ZERO.        INKRP106
RB0123     05  PA-EXCEPT-PAGE-COUNT2   PIC S9(05)    VALUE ZERO.        INKRP106
00093      05  PA-PAGE-DIV             PIC S9(05)    VALUE ZERO.        INKRP106
00094      05  PA-PAGE-REM             PIC S9(03)    VALUE ZERO.        INKRP106
00095 *                                                                 INKRP106
00096  01  FF-FETCH-FIELDS.                                             INKRP106
00097      05  FF-OP-CO-NMBR           PIC X(02)   VALUE SPACES.        INKRP106
W26600     05  FF-STORE-NMBR           PIC X(04)   VALUE SPACES.        INKRP106
00099      05  FF-STORE-NAME           PIC X(25)   VALUE SPACES.        INKRP106
00100 *                                                                 INKRP106
00101  01  PS-PROGRAM-SWITCHES.                                         INKRP106
00102      05  PS-END-OF-INPUT-SW      PIC X       VALUE 'N'.           INKRP106
00103          88  PS-END-OF-INPUT                 VALUE 'Y'.           INKRP106
00105R     05  PS-DONE-SW              PIC X       VALUE 'N'.           INKRP106
00105          88  PS-DONE                         VALUE 'Y'.           INKRP106
00106          88  PS-NOT-DONE                     VALUE 'N'.           INKRP106
RB0123     05  PS-BREAK-LEVEL-SW       PIC X       VALUE SPACE.                 
RB0123         88  PS-BREAK-LEVEL-SW-INIT          VALUE ' '.                   
RB0123         88  PS-BREAK-IS-STR                 VALUE 'S'.                   
RB0123         88  PS-BREAK-IS-DMA                 VALUE 'M'.                   
RB0123         88  PS-BREAK-IS-BYR                 VALUE 'B'.                   
RB0123         88  PS-BREAK-IS-DEPT                VALUE 'D'.                   
RB0123         88  PS-BREAK-IS-CLS                 VALUE 'C'.                   
RB0123     05  PS-BUYER-EXTRA-PAGE-SW  PIC X       VALUE 'N'.           INKRP106
RB0123         88  PS-BUYER-EXTRA-PAGE-ON          VALUE 'Y'.           INKRP106
RB0123         88  PS-BUYER-EXTRA-PAGE-OFF         VALUE 'N'.           INKRP106
RB0123                                                                          
00107 *                                                                 INKRP106
00108  01  CPU-DATE.                                                    INKRP106
00109      05  CPU-YEAR                    PIC X(02)     VALUE SPACES.  INKRP106
00110      05  CPU-MONTH                   PIC X(02)     VALUE SPACES.  INKRP106
00111      05  CPU-DAY                     PIC X(02)     VALUE SPACES.  INKRP106
00112 *                                                                 INKRP106
00113  01  CPU-TIME.                                                    INKRP106
00114      05  CPU-HOUR                    PIC X(02)     VALUE SPACES.  INKRP106
00115      05  CPU-MINUTE                  PIC X(02)     VALUE SPACES.  INKRP106
00116      05  FILLER                      PIC X(02)     VALUE SPACES.  INKRP106
00117 *                                                                 INKRP106
00118  01  DK-DATABASE-KEYS.                                            INKRP106
00119      05  DK-DEPT                      PIC X(03)   VALUE SPACES.   INKRP106
00120      05  DK-MAJ-CL                    PIC X(02)   VALUE SPACES.   INKRP106
00121      05  DK-SUB-CL                    PIC X(03)   VALUE SPACES.   INKRP106
00122      05  DK-MDSELV-CDE                PIC X(03)   VALUE SPACES.   INKRP106
00123      05  DK-RSPLVL-CDE                PIC X(03)   VALUE SPACES.   INKRP106
00124 *                                                                 INKRP106
00125  01  ID-INVENTORY-DATE.                                           INKRP106
00126      05  ID-MONTH                    PIC X(02)     VALUE SPACES.  INKRP106
00127      05  ID-DAY                      PIC X(02)     VALUE SPACES.  INKRP106
00128      05  ID-YEAR                     PIC X(02)     VALUE SPACES.  INKRP106
00129 *                                                                 INKRP106
00130  01  PC-PRINT-CONTROL.                                            INKRP106
00131      05  PC-ADVANCE              PIC S9(03)  VALUE ZERO COMP-3.   INKRP106
00132      05  PC-LINE-COUNT           PIC S9(03)  VALUE ZERO COMP-3.   INKRP106
00133      05  PC-ADVANCE2             PIC S9(03)  VALUE ZERO COMP-3.   INKRP106
00134      05  PC-LINE-COUNT2          PIC S9(03)  VALUE +60  COMP-3.   INKRP106
00135      05  PC-LINE-MAX             PIC S9(03)  VALUE +57  COMP-3.   INKRP106
RB0123     05  PC-BUYER-NO             PIC X(03)   VALUE SPACES.                
RB0123     05  PC-BUYER-NAME           PIC X(20)   VALUE SPACES.                
W26600     05  PC-STORE-NO             PIC X(04)   VALUE SPACES.                
RB0123     05  PC-STORE-NAME           PIC X(10)   VALUE SPACES.                
RB0123     05  PC-INV-DATE             PIC X(10)   VALUE SPACES.                
RB0123                                                                          
RB0123 01  HV-HOLD-VARIABLES.                                           INKRP106
RB0123     05  HV-BUYER-NO             PIC X(03)   VALUE SPACES.                
RB0123     05  HV-BUYER-NAME           PIC X(20)   VALUE SPACES.                
W26600     05  HV-STORE-NO             PIC X(04)   VALUE SPACES.                
RB0123     05  HV-STORE-NAME           PIC X(10)   VALUE SPACES.                
RB0123     05  HV-INV-DATE             PIC X(10)   VALUE SPACES.                
RB0123     05  HV-PA-PAGE-COUNT        PIC S9(05)  VALUE ZERO.                  
RB0123     05  HV-PA-PAGE-COUNT2       PIC S9(05)  VALUE ZERO.                  
RB0123                                                                          
00136 *                                                                 INKRP106
00137  01  PC-PROGRAM-CONSTANTS.                                        INKRP106
00138      05  PC-OPERCO-NBR               PIC X(02)   VALUE '03'.      INKRP106
00139      05  PC-BYR                      PIC X(03)   VALUE 'BYR'.     INKRP106
00140      05  PC-DPT                      PIC X(03)   VALUE 'DPT'.     INKRP106
00141      05  PC-MAX-RETRIES              PIC 9(03)   VALUE 3.         INKRP106
00142      05  PC-END-FIRST-NAME           PIC 9(02)   VALUE 12.        INKRP106
00143      05  PC-END-LAST-NAME            PIC 9(02)   VALUE 18.        INKRP106
25248      05  PC-ENTRY-MAX                PIC S9(02)    VALUE +02.     INKRP106
00145      05  PC-DETAIL-MAX               PIC S9(02)    VALUE +50.     INKRP106
RB0123     05  PC-SUMMARY-MAX              PIC S9(02)    VALUE +50.     INKRP106
00146      05  PC-CLASS                    PIC X(05)     VALUE          INKRP106
00147      'CLASS'.                                                     INKRP106
00148      05  PC-DEPT                     PIC X(05)     VALUE          INKRP106
00149      'DEPT '.                                                     INKRP106
00150      05  PC-BUYER                    PIC X(05)     VALUE          INKRP106
00151      'BUYER'.                                                     INKRP106
00152      05  PC-DMA                      PIC X(05)     VALUE          INKRP106
00153      'DMA  '.                                                     INKRP106
00154      05  PC-FINAL                    PIC X(05)     VALUE          INKRP106
00155      'FINAL'.                                                     INKRP106
00156 *                                                                 INKRP106
00157  01  DT-DETAIL-TABLE.                                             INKRP106
25248      05  DT-ENTRY OCCURS 2.                                       INKRP106
00159          10  DT-DETAIL OCCURS 50.                                 INKRP106
00160              15  DT-AREA             PIC  9(06).                  INKRP106
W26600             15  FILLER              PIC  X(02).                  INKRP106
W26600             15  DT-SKU              PIC  X(08).                  INKRP106
00161              15  FILLER              PIC  X(02).                  INKRP106
W26600             15  DT-UPC              PIC  X(15).                  INKRP106
W26600*                20  DT-UPC-KHL      PIC  X(07).                          
W26600*                20  DT-SKU          PIC  X(08).                          
SR3403             15  FILLER              PIC  X(01).                  INKRP106
SR3403             15  DT-PRICE            PIC  9(05)V99.               INKRP106
00165              15  FILLER              PIC  X(02).                  INKRP106
00166              15  DT-QTY              PIC  9(04).                  INKRP106
SR3403             15  FILLER              PIC  X(01).                  INKRP106
SR3403             15  DT-EXT-RTL          PIC S9(08)V99.               INKRP106
RB0123*                                                                 INKRP106
RB0123 01  ST-SUMMARY-TABLE.                                            INKRP106
RB0123     05  ST-ENTRY OCCURS 50.                                      INKRP106
RB0123         10  FILLER              PIC X(35).                       INKRP106
W21732         10  ST-DEPT             PIC X(04).                       INKRP106
RB0123         10  ST-DASH             PIC X(01).                       INKRP106
W21732         10  ST-CLASS            PIC X(04).                       INKRP106
W21732         10  FILLER              PIC X(02).                       INKRP106
RB0123         10  ST-CLASS-DESC       PIC X(20).                       INKRP106
RB0123         10  FILLER              PIC X(05).                       INKRP106
RB0123         10  ST-RETAIL           PIC 9(09)V99.                    INKRP106
RB0123         10  FILLER              PIC X(05).                       INKRP106
RB0123         10  ST-UNITS            PIC 9(09).                       INKRP106
RB0123         10  FILLER              PIC X(46).                       INKRP106
00170 *                                                                 INKRP106
00171  01  SS-SUBSCRIPTS.                                               INKRP106
00172      05  SS-ENTRY-SUB        PIC S9(04)  VALUE ZERO COMP SYNC.    INKRP106
00173      05  SS-DETAIL-SUB       PIC S9(04)  VALUE ZERO COMP SYNC.    INKRP106
00173      05  SS-SUMMARY-SUB      PIC S9(04)  VALUE ZERO COMP SYNC.    INKRP106
00174      05  SS-SUB              PIC S9(04)  VALUE ZERO COMP SYNC.    INKRP106
00175      05  SS-FIRST-SUB                    PIC S9(04)  VALUE ZEROES INKRP106
00176                                                      COMP SYNC.   INKRP106
00177      05  SS-LAST-SUB                     PIC S9(04)  VALUE ZEROES INKRP106
00178                                                      COMP SYNC.   INKRP106
00179      05  SS-TEMP-SUB1                    PIC S9(04)  VALUE ZEROES INKRP106
00180                                                      COMP SYNC.   INKRP106
00181      05  SS-TEMP-SUB2                    PIC S9(04)  VALUE ZEROES INKRP106
00182                                                      COMP SYNC.   INKRP106
00183 *                                                                 INKRP106
00184  01  H1-HEADING.                                                  INKRP106
00185      05  FILLER              PIC X(01)   VALUE SPACES.            INKRP106
00186      05  H1-DEPT-CLASS.                                           INKRP106
W21732         10  H1-DEPT         PIC X(04)   VALUE SPACES.            INKRP106
RB0123         10  H1-DASH         PIC X       VALUE '-'.               INKRP106
W21732         10  H1-CLASS        PIC X(04)   VALUE SPACES.            INKRP106
00190      05  FILLER              PIC X       VALUE SPACES.            INKRP106
00191      05  H1-CLASS-DESC       PIC X(20)   VALUE SPACES.            INKRP106
00192      05  FILLER              PIC X(06)   VALUE SPACES.            INKRP106
00193      05  FILLER              PIC X(9)    VALUE 'PHYSICAL '.       INKRP106
00194      05  FILLER              PIC X(10)   VALUE 'INVENTORY '.      INKRP106
00195      05  FILLER              PIC X(10)   VALUE 'FOR STORE '.      INKRP106
W26600     05  H1-STORE-NO         PIC XXXX.                            INKRP106
00197      05  FILLER              PIC X       VALUE SPACES.            INKRP106
00198      05  H1-STORE-NAME       PIC X(10).                           INKRP106
00199      05  FILLER              PIC X(07)   VALUE ' TAKEN '.         INKRP106
00200      05  H1-INV-DATE         PIC X(10) VALUE SPACES.              INKRP106
W21732     05  FILLER              PIC X(35)   VALUE SPACES.            INKRP106
00202 *                                                                 INKRP106
00203  01  H2-HEADING.                                                  INKRP106
00204      05  FILLER              PIC X(01)   VALUE SPACES.            INKRP106
00205      05  H2-BUYER-NO         PIC XXX.                             INKRP106
00206      05  FILLER              PIC XX      VALUE SPACES.            INKRP106
00207      05  H2-BUYER-NAME       PIC X(20)   VALUE SPACES.            INKRP106
00208      05  FILLER              PIC X(14)   VALUE SPACES.            INKRP106
00209      05  FILLER              PIC X(11)   VALUE 'LISTING OF '.     INKRP106
00210      05  FILLER              PIC X(9)    VALUE 'ITEMS BY '.       INKRP106
00211      05  FILLER              PIC X(13)   VALUE 'DEPARTMENT & '.   INKRP106
00212      05  FILLER              PIC X(10)   VALUE 'CLASS CODE'.      INKRP106
00213      05  FILLER              PIC X(49)   VALUE SPACES.            INKRP106
00214 *                                                                 INKRP106
00215 *                                                                 INKRP106
00216  01  H3-HEADING.                                                  INKRP106
00217      05  FILLER              PIC X(01)   VALUE SPACES.            INKRP106
00218      05  H3-BUYER-NO         PIC XXX.                             INKRP106
00219      05  FILLER              PIC XX      VALUE SPACES.            INKRP106
00220      05  H3-BUYER-NAME       PIC X(20)   VALUE SPACES.            INKRP106
W21732     05  FILLER              PIC X(09)   VALUE SPACES.            INKRP106
00222      05  FILLER              PIC X(10)   VALUE 'DEPT-CLASS'.      INKRP106
W21732     05  FILLER              PIC X(04)   VALUE SPACES.            INKRP106
00224      05  FILLER              PIC X(13)   VALUE 'DESCRIPTION  '.   INKRP106
W21732     05  FILLER              PIC X(18)   VALUE SPACES.            INKRP106
00226      05  FILLER              PIC X(13)   VALUE 'AMOUNT '.         INKRP106
00227      05  FILLER              PIC X(06)   VALUE SPACES.            INKRP106
00228      05  FILLER              PIC X(13)   VALUE 'QUANTITY'.        INKRP106
00229      05  FILLER              PIC X(23)   VALUE SPACES.            INKRP106
00230 *                                                                 INKRP106
00231  01  H4-HEADING.                                                  INKRP106
00232      05  FILLER              PIC X(34)   VALUE SPACES.            INKRP106
00233      05  FILLER              PIC X(9)    VALUE 'PHYSICAL '.       INKRP106
00234      05  FILLER              PIC X(10)   VALUE 'INVENTORY '.      INKRP106
00235      05  FILLER              PIC X(10)   VALUE 'FOR STORE '.      INKRP106
W26600     05  H4-STORE-NO         PIC XXXX.                            INKRP106
00237      05  FILLER              PIC X       VALUE SPACES.            INKRP106
00238      05  H4-STORE-NAME       PIC X(10).                           INKRP106
00239      05  FILLER              PIC X(07)   VALUE ' TAKEN '.         INKRP106
00240      05  H4-INV-DATE         PIC X(10) VALUE SPACES.              INKRP106
00241      05  FILLER              PIC X(38)   VALUE SPACES.            INKRP106
00242 *                                                                 INKRP106
00243  01  H5-HEADING.                                                  INKRP106
W26600     05  FILLER                 PIC  X(37)           VALUE SPACE. INKRP106
W26600     05  FILLER                 PIC  X(06)           VALUE        INKRP106
W26600         'RETAIL'.                                                INKRP106
W26600     05  FILLER                 PIC  X(08)           VALUE SPACE. INKRP106
W26600     05  FILLER                 PIC  X(08)           VALUE        INKRP106
W26600         'EXTENDED'.                                              INKRP106
W26600     05  FILLER                 PIC  X(37)           VALUE SPACE. INKRP106
W26600     05  FILLER                 PIC  X(06)           VALUE        INKRP106
W26600         'RETAIL'.                                                INKRP106
W26600     05  FILLER                 PIC  X(08)           VALUE SPACE. INKRP106
W26600     05  FILLER                 PIC  X(08)           VALUE        INKRP106
W26600         'EXTENDED'.                                              INKRP106
00256 *                                                                 INKRP106
00257  01  H6-HEADING.                                                  INKRP106
W26600     05  FILLER                 PIC  X(04)           VALUE SPACE. INKRP106
W26600     05  FILLER                 PIC  X(08)           VALUE        INKRP106
W26600         'AREA SKU'.                                              INKRP106
W26600     05  FILLER                 PIC  X(06)           VALUE SPACE. INKRP106
W26600     05  FILLER                 PIC  X(03)           VALUE 'UPC'. INKRP106
W26600     05  FILLER                 PIC  X(17)           VALUE SPACE. INKRP106
W26600     05  FILLER                 PIC  X(21)           VALUE        INKRP106
W26600         'PRICE  QTY     RETAIL'.                                         
W26600     05  FILLER                 PIC  X(04)           VALUE SPACE. INKRP106
W26600     05  FILLER                 PIC  X(08)           VALUE        INKRP106
W26600         'AREA SKU'.                                              INKRP106
W26600     05  FILLER                 PIC  X(06)           VALUE SPACE. INKRP106
W26600     05  FILLER                 PIC  X(03)           VALUE 'UPC'. INKRP106
W26600     05  FILLER                 PIC  X(17)           VALUE SPACE. INKRP106
W26600     05  FILLER                 PIC  X(21)           VALUE        INKRP106
W26600         'PRICE  QTY     RETAIL'.                                         
00284                                                                   INKRP106
00285  01  H7-HEADING.                                                  INKRP106
00286      05  FILLER              PIC X(46)   VALUE SPACES.            INKRP106
00287      05  FILLER              PIC X(11)   VALUE 'SUMMARY BY '.     INKRP106
00288      05  FILLER              PIC X(9)    VALUE 'BUYER AND'.       INKRP106
00289      05  FILLER              PIC X(13)   VALUE ' DEPARTMENT  '.   INKRP106
00290      05  FILLER              PIC X(04)   VALUE 'CODE'.            INKRP106
00291      05  FILLER              PIC X(49)   VALUE SPACES.            INKRP106
00292 *                                                                 INKRP106
00293  01  D1-DETAIL-LINE.                                              INKRP106
00294      05  FILLER              PIC X(01).                           INKRP106
25248      05  D1-ENTRY  OCCURS 2.                                      INKRP106
25248          10  FILLER              PIC  X(01).                      INKRP106
W26600         10  D1-AREA             PIC  ZZZZZZ.                     INKRP106
W26600         10  FILLER              PIC  X(01).                      INKRP106
W26600         10  D1-SKU              PIC  X(08).                              
W26600         10  FILLER              PIC  X(01).                      INKRP106
W26600         10  D1-UPC              PIC  X(15).                      INKRP106
SR3403         10  FILLER              PIC  X(02).                      INKRP106
SR3403         10  D1-PRICE            PIC  ZZZZ9.99.                   INKRP106
SR3403         10  D1-PRICE-RED REDEFINES D1-PRICE                      INKRP106
SR3403                                 PIC  X(08).                      INKRP106
00303          10  FILLER              PIC  X(01).                      INKRP106
00304          10  D1-QTY              PIC  ZZZZ.                       INKRP106
00305          10  FILLER              PIC  X(01).                      INKRP106
00306          10  D1-EXT-RTL          PIC  ZZZZZZ9.99.                 INKRP106
00307          10  D1-EXT-RTL-RED REDEFINES D1-EXT-RTL                  INKRP106
00308                                  PIC  X(10).                      INKRP106
25248          10  FILLER              PIC  X(01).                      INKRP106
00310 *                                                                 INKRP106
00311  01  D2-DETAIL-LINE.                                              INKRP106
00312      05  FILLER              PIC X(35)   VALUE SPACES.            INKRP106
W21732     05  D2-DEPT             PIC X(04)   VALUE SPACES.            INKRP106
RB0123     05  D2-DASH             PIC X(01)   VALUE '-'.               INKRP106
W21732     05  D2-CLASS            PIC X(04)   VALUE SPACES.            INKRP106
00316      05  FILLER              PIC X(05)   VALUE SPACES.            INKRP106
00317      05  D2-CLASS-DESC       PIC X(20)   VALUE SPACES.            INKRP106
00318      05  FILLER              PIC X(05)   VALUE SPACES.            INKRP106
00319      05  D2-RETAIL           PIC ZZZ,ZZZ,ZZ9.99.                  INKRP106
00320      05  FILLER              PIC X(05)   VALUE SPACES.            INKRP106
00321      05  D2-UNITS            PIC ZZZ,ZZZ,ZZ9.                     INKRP106
W21732     05  FILLER              PIC X(43)   VALUE SPACES.            INKRP106
00323 *                                                                 INKRP106
00324 *                                                                 INKRP106
00325  01  D3-DETAIL-LINE.                                              INKRP106
00326      05  FILLER              PIC X(22)   VALUE SPACES.            INKRP106
00327      05  D3-LEVEL            PIC X(05)   VALUE SPACES.            INKRP106
00328      05  FILLER              PIC X(01)   VALUE SPACES.            INKRP106
W21732     05  D3-NUMBER           PIC ZZZZ    VALUE SPACES.            INKRP106
W21732     05  FILLER              PIC X(07)   VALUE SPACES.            INKRP106
00331      05  FILLER              PIC X(05)   VALUE 'TOTAL'.           INKRP106
00332      05  FILLER              PIC X(05)   VALUE SPACES.            INKRP106
00333      05  D3-DESC             PIC X(20)   VALUE SPACES.            INKRP106
00334      05  FILLER              PIC X(05)   VALUE SPACES.            INKRP106
00335      05  D3-RETAIL           PIC ZZZ,ZZZ,ZZ9.99.                  INKRP106
00336      05  FILLER              PIC X(05)   VALUE SPACES.            INKRP106
00337      05  D3-UNITS            PIC ZZZ,ZZZ,ZZ9.                     INKRP106
W21732     05  FILLER              PIC X(39)   VALUE SPACES.            INKRP106
00310 *                                                                 INKRP106
BYRRPT 01  D4-DETAIL-LINE.                                              INKRP106
BYRRPT     05  FILLER              PIC X(48)   VALUE SPACES.            INKRP106
BYRRPT     05  FILLER              PIC X(37)   VALUE                    INKRP106
BYRRPT     'THIS PAGE IS INTENTIONALLY LEFT BLANK'.                     INKRP106
BYRRPT     05  FILLER              PIC X(47)   VALUE SPACES.            INKRP106
00339 *                                                                 INKRP106
00340  01  T1-TOTAL.                                                    INKRP106
00341      05  FILLER              PIC X VALUE SPACES.                  INKRP106
W21732     05  T1-NAME             PIC X(15) VALUE SPACES.              INKRP106
00343      05  T1-NAME-A REDEFINES T1-NAME.                             INKRP106
00344          10  T1-NAME-B       PIC X(5).                            INKRP106
00345          10  FILLER          PIC X.                               INKRP106
W21732         10  T1-NAME-NO      PIC X(9).                            INKRP106
00347          10  FILLER  REDEFINES  T1-NAME-NO.                       INKRP106
W21732             15  T1-DEPT     PIC XXXX.                            INKRP106
00349              15  T1-DASH     PIC X.                               INKRP106
W21732             15  T1-CLASS    PIC XXXX.                            INKRP106
00351      05  FILLER              PIC X(7) VALUE ' TOTAL '.            INKRP106
00352      05  FILLER              PIC X(9) VALUE 'QUANTITY '.          INKRP106
00353      05  T1-QTY              PIC ZZ,ZZZ,ZZZ.                      INKRP106
00354      05  FILLER              PIC X(8) VALUE '  TOTAL '.           INKRP106
00355      05  FILLER              PIC X(7) VALUE 'RETAIL '.            INKRP106
00356      05  T1-RETAIL           PIC ZZ,ZZZ,ZZZ.99.                   INKRP106
00357 *                                                                 INKRP106
00358 ******************************************************************INKRP106
00359 * COPY FOR STANDARD HEADING                                       INKRP106
00360 ** ***************************************************************INKRP106
00361      COPY DPWS132O.                                               INKRP106
00362 *                                                                 INKRP106
00363 ******************************************************************INKRP106
00364 * SQL ABEND ROUTINE WORKING STORAGE                               INKRP106
00365 ** ***************************************************************INKRP106
00366      COPY DPWS004.                                                INKRP106
00367 *                                                                 INKRP106
00368 ******************************************************************INKRP106
00369 * INPUT FILE COPY MEMBER                                          INKRP106
00370 ******************************************************************INKRP106
25248      COPY INWS014.                                                   CL**4
00372 *                                                                 INKRP106
  |   ******************************************************************INKRP106
  |   * STORE TABLE DCLGEN                                              INKRP106
  |   ******************************************************************INKRP106
  |        EXEC SQL                                                     INKRP106
  |            INCLUDE XMT00001                                         INKRP106
  |        END-EXEC.                                                    INKRP106
25248                                                                   INKRP106
P28545******************************************************************INKRP106
P28545* STORE TABLE DCLGEN                                              INKRP106
P28545******************************************************************INKRP106
P28545*    EXEC SQL                                                     INKRP106
P28545*        INCLUDE TMDSEAR                                          INKRP106
P28545*    END-EXEC.                                                    INKRP106
P28545*                                                                 INKRP106
P28545******************************************************************INKRP106
P28545* STORE TABLE DCLGEN                                              INKRP106
P28545******************************************************************INKRP106
P28545*    EXEC SQL                                                     INKRP106
P28545*        INCLUDE TRSPBAR                                          INKRP106
P28545*    END-EXEC.                                                    INKRP106
P28545*                                                                 INKRP106
P28545******************************************************************        
P28545* COPYBOOK - PRICING MODULE                                               
P28545******************************************************************        
P28545     COPY INWS400.                                                        
P28545                                                                          
00394 ******************************************************************INKRP106
00395 * DB2 COMMUNICATIONS AREA                                         INKRP106
00396 ******************************************************************INKRP106
00397      EXEC SQL                                                     INKRP106
00398          INCLUDE SQLCA                                            INKRP106
00399      END-EXEC.                                                    INKRP106
00400 *                                                                 INKRP106
00401      COPY SQLCA2.                                                 INKRP106
00402                                                                   INKRP106
00403  LINKAGE SECTION.                                                 INKRP106
00404 *                                                                 INKRP106
00405  PROCEDURE DIVISION.                                              INKRP106
00406 ******************************************************************INKRP106
00407 *  MAIN LINE LOGIC.                                               INKRP106
00408 ******************************************************************INKRP106
00409  A100-MAINLINE.                                                   INKRP106
00410 *                                                                 INKRP106
00411      PERFORM B100-GET-DATE-TIME.                                  INKRP106
00412      PERFORM B200-OPEN-FILES.                                     INKRP106
00413      PERFORM Z100-READ-INVENTORY-FILE.                            INKRP106
00414                                                                   INKRP106
RB0123     PERFORM B300-PROCESS-RPTS   UNTIL                            INKRP106
RB0123               PS-END-OF-INPUT.                                   INKRP106
00417                                                                   INKRP106
00418      PERFORM B400-CLOSE-FILES.                                    INKRP106
00419      STOP RUN.                                                    INKRP106
00420                                                                   INKRP106
00421 *                                                                 INKRP106
00422 ******************************************************************INKRP106
00423 * ONE TIME ROUTINE TO FORMAT DATE AND TIME IN THE REPORT HEADINGS.INKRP106
00424 ******************************************************************INKRP106
00425  B100-GET-DATE-TIME.                                              INKRP106
00426 *                                                                 INKRP106
00427      ACCEPT CPU-DATE FROM DATE.                                   INKRP106
00428      MOVE CPU-YEAR TO DP132O-RUN-YEAR.                            INKRP106
00429      MOVE CPU-MONTH TO DP132O-RUN-MONTH.                          INKRP106
00430      MOVE CPU-DAY TO DP132O-RUN-DAY.                              INKRP106
00431      ACCEPT CPU-TIME FROM TIME.                                   INKRP106
00432      MOVE CPU-HOUR TO DP132O-RUN-HOUR.                            INKRP106
00433      MOVE CPU-MINUTE TO DP132O-RUN-MINUTE.                        INKRP106
00434      MOVE 'INKRP106' TO DP132O-PROGRAM-NAME.                      INKRP106
00435 *                                                                 INKRP106
00436 ******************************************************************INKRP106
00437 * OPEN ALL FILES USED BY THIS PROGRAM.                            INKRP106
00438 ******************************************************************INKRP106
00439  B200-OPEN-FILES.                                                 INKRP106
00440 *                                                                 INKRP106
00441      OPEN INPUT  PHY-INVENTORY-FILE                               INKRP106
00442           OUTPUT PHY-INVENTORY-RPT-FILE                           INKRP106
00443                  BUYER-SUMMARY-RPT-FILE.                          INKRP106
00444 *                                                                 INKRP106
00501 *                                                                 INKRP106
RB0123******************************************************************        
RB0123*  PROCESS REPORT                                                         
RB0123******************************************************************        
RB0123 B300-PROCESS-RPTS.                                                       
RB0123*                                                                         
RB0123*    INITIALIZE DETAIL TABLE                                              
RB0123*                                                                         
RB0123     INITIALIZE DT-DETAIL-TABLE                                   INKRP106
RB0123                SS-DETAIL-SUB.                                    INKRP106
RB0123*                                                                         
00450      MOVE IN014-STORE-NUMBER TO SA-STORE-NO                       INKRP106
00451                                 H1-STORE-NO                       INKRP106
00452                                 H4-STORE-NO.                      INKRP106
00453      PERFORM Z200-READ-STORE-DB.                                  INKRP106
00454      MOVE FF-STORE-NAME      TO H1-STORE-NAME                     INKRP106
00455                                 H4-STORE-NAME.                    INKRP106
00456                                                                   INKRP106
00457      MOVE IN014-INV-DATE     TO H1-INV-DATE                       INKRP106
00458                                 H4-INV-DATE.                      INKRP106
00459      MOVE IN014-DEPT         TO SA-DEPT                           INKRP106
00460                                 H1-DEPT.                          INKRP106
RB0123     MOVE '-'                TO H1-DASH.                                  
00461      MOVE IN014-CLASS        TO SA-CLASS                          INKRP106
00462                                 H1-CLASS.                         INKRP106
00463      MOVE IN014-DMA TO SA-DMA.                                    INKRP106
00464 *                                                                 INKRP106
00465      MOVE IN014-BYR          TO  SA-BUYER-NUMBER                  INKRP106
00466                                  H2-BUYER-NO                      INKRP106
00467                                  H3-BUYER-NO.                     INKRP106
00468      MOVE 1                  TO  SS-ENTRY-SUB                     INKRP106
RB0123                                 SS-DETAIL-SUB                            
RB0123                                 SS-SUMMARY-SUB.                          
00471      MOVE IN014-CLASS-DESC  TO H1-CLASS-DESC.                     INKRP106
RB0123     PERFORM X200-GET-DEPT-DESC.                                  INKRP106
00473 *                                                                 INKRP106
RB1023     PERFORM C100-PROCESS-STORE             UNTIL                 INKRP106
00475                PS-END-OF-INPUT OR                                 INKRP106
00476                IN014-STORE-NUMBER NOT = SA-STORE-NO.              INKRP106
00477                                                                   INKRP106
RB0123     SET PS-BREAK-IS-STR TO TRUE.                                         
RB0123                                                                          
RB0123     PERFORM I100-PROCESS-BREAKS.                                         
RB0123*                                                                         
00502 ******************************************************************INKRP106
00503 * CLOSE ALL FILES USED BY THIS PROGRAM.                           INKRP106
00504 ******************************************************************INKRP106
00505  B400-CLOSE-FILES.                                                INKRP106
00506 *                                                                 INKRP106
00507      CLOSE  PHY-INVENTORY-FILE                                    INKRP106
00508             PHY-INVENTORY-RPT-FILE                                INKRP106
00509             BUYER-SUMMARY-RPT-FILE.                               INKRP106
00510 *                                                                 INKRP106
RB0123                                                                          
RB0123 C100-PROCESS-STORE.                                                      
RB0123                                                                          
RB0123******************************************************************        
RB0123*    PROCESS ALL STORES. WHEN A NEW STORE OR DMA IS ENCOUNTERED,          
RB0123*    PRINT THE DETAIL OF THE LAST CLASS FOR THE STORE.                    
RB0123******************************************************************        
RB0123                                                                          
RB0123     MOVE IN014-DMA TO SA-DMA.                                            
RB0123                                                                          
RB0123     PERFORM D100-PROCESS-DMA                                             
RB0123         UNTIL (IN014-STORE-NUMBER NOT = SA-STORE-NO)                     
RB0123            OR (IN014-DMA          NOT = SA-DMA)                          
RB0123            OR (PS-END-OF-INPUT).                                         
RB0123                                                                          
RB0123     SET PS-BREAK-IS-DMA TO TRUE.                                         
RB0123                                                                          
RB0123     PERFORM I100-PROCESS-BREAKS.                                         
RB0123                                                                          
RB0123                                                                          
RB0123 D100-PROCESS-DMA.                                                        
RB0123                                                                          
RB0123******************************************************************        
RB0123*    PROCESS ALL BYRS WITHIN THIS DMA.  WHEN A NEW STORE, DMA, OR         
RB0123*    BYR IS ENCOUNTERED, PRINT THE INFO FOR THE PREVIOUS BYR.             
RB0123******************************************************************        
RB0123                                                                          
RB0123     MOVE IN014-BYR TO SA-BUYER-NUMBER                                    
RB0123                       H2-BUYER-NO                                INKRP106
RB0123                       H3-BUYER-NO.                               INKRP106
RB0123     MOVE IN014-CLASS-DESC  TO H1-CLASS-DESC.                     INKRP106
RB0123     PERFORM X200-GET-DEPT-DESC.                                  INKRP106
RB0123                                                                          
RB0123     PERFORM E100-PROCESS-BYR                                             
RB0123         UNTIL (IN014-STORE-NUMBER NOT = SA-STORE-NO)                     
RB0123            OR (IN014-DMA          NOT = SA-DMA)                          
RB0123            OR (IN014-BYR          NOT = SA-BUYER-NUMBER)                 
RB0123            OR (PS-END-OF-INPUT).                                         
RB0123                                                                          
RB0123     SET PS-BREAK-IS-BYR TO TRUE.                                         
RB0123                                                                          
RB0123     PERFORM I100-PROCESS-BREAKS.                                         
RB0123                                                                          
RB0123                                                                          
RB0123 E100-PROCESS-BYR.                                                        
RB0123                                                                          
RB0123******************************************************************        
RB0123*    PROCESS ALL DEPTS WITHIN THIS BYR.  WHEN A NEW STORE, DMA,           
RB0123*    BYR, OR DEPT IS ENCOUNTERED, PRINT THE DEATIL FOR THE                
RB0123*    PREVIOUS CLASS.                                                      
RB0123******************************************************************        
RB0123                                                                          
RB0123     MOVE IN014-DEPT TO SA-DEPT.                                          
RB0123                                                                          
RB0123     PERFORM G100-PROCESS-DEPT                                            
RB0123         UNTIL (IN014-STORE-NUMBER NOT = SA-STORE-NO)                     
RB0123            OR (IN014-DMA          NOT = SA-DMA)                          
RB0123            OR (IN014-BYR          NOT = SA-BUYER-NUMBER)                 
RB0123            OR (IN014-DEPT         NOT = SA-DEPT)                         
RB0123            OR (PS-END-OF-INPUT).                                         
RB0123                                                                          
RB0123     SET PS-BREAK-IS-DEPT TO TRUE.                                        
RB0123                                                                          
RB0123     PERFORM I100-PROCESS-BREAKS.                                         
RB0123                                                                          
RB0123                                                                          
RB0123 G100-PROCESS-DEPT.                                                       
RB0123                                                                          
RB0123******************************************************************        
RB0123*    PROCESS ALL CLASSES IN THIS DEPT.   WHEN A NEW STORE, DMA,           
RB0123*    BYR, OR DEPT, OR CLASS IN ENCOUNTERED, PRINT THE DETAIL              
RB0123*    THE THE LAST CLASS.                                                  
RB0123******************************************************************        
RB0123                                                                          
RB0123     MOVE IN014-CLASS   TO SA-CLASS.                                      
RB0123                                                                          
RB0123     PERFORM H100-PROCESS-CLS                                             
RB0123         UNTIL (IN014-STORE-NUMBER NOT = SA-STORE-NO)                     
RB0123            OR (IN014-DMA        NOT = SA-DMA)                            
RB0123            OR (IN014-BYR        NOT = SA-BUYER-NUMBER)                   
RB0123            OR (IN014-DEPT       NOT = SA-DEPT)                           
RB0123            OR (IN014-CLASS      NOT = SA-CLASS)                          
RB0123            OR (PS-END-OF-INPUT).                                         
RB0123                                                                          
RB0123     SET PS-BREAK-IS-CLS TO TRUE.                                         
RB0123                                                                          
RB0123     PERFORM I100-PROCESS-BREAKS.                                         
RB0123                                                                          
RB0123******************************************************************INKRP106
RB0123* STORE CLASS DETAIL DATA IN TABLE                                INKRP106
RB0123*                                                                 INKRP106
RB0123******************************************************************INKRP106
RB0123 H100-PROCESS-CLS.                                                INKRP106
RB0123*                                                                 INKRP106
RB0123     MOVE IN014-AREA-NUMBER                                       INKRP106
RB0123         TO DT-AREA (SS-ENTRY-SUB, SS-DETAIL-SUB).                INKRP106
RB0123     MOVE IN014-PRICE                                             INKRP106
RB0123         TO DT-PRICE (SS-ENTRY-SUB, SS-DETAIL-SUB).               INKRP106
RB0123     MOVE IN014-QUANTITY                                          INKRP106
RB0123         TO DT-QTY (SS-ENTRY-SUB, SS-DETAIL-SUB).                 INKRP106
RB0123     COMPUTE PA-EXTENDED-RETAIL =                                 INKRP106
RB0123         IN014-QUANTITY * IN014-PRICE.                            INKRP106
RB0123     MOVE PA-EXTENDED-RETAIL                                      INKRP106
RB0123         TO DT-EXT-RTL (SS-ENTRY-SUB, SS-DETAIL-SUB).             INKRP106
W26600                                                                          
W26600     MOVE IN014-SKU              TO DT-SKU                                
W26600                                 (SS-ENTRY-SUB, SS-DETAIL-SUB).           
25248                                                                           
25248      IF IN014-UPC-CODE NOT EQUAL ZEROS                                    
W26600         MOVE IN014-UPC-CODE     TO PV-EDIT-UPC-CODE                      
W26600         MOVE PV-EDIT-UPC-CODE-ALPHA                                      
W26600                                 TO DT-UPC                                
W26600                                 (SS-ENTRY-SUB, SS-DETAIL-SUB)            
W26600     ELSE                                                                 
W26600         MOVE SPACE              TO DT-UPC                                
W26600                                 (SS-ENTRY-SUB, SS-DETAIL-SUB)            
25248      END-IF.                                                              
25248                                                                           
RB0123     ADD IN014-QUANTITY TO PA-CLASS-QTY                           INKRP106
RB0123                             PA-DEPT-QTY                          INKRP106
RB0123                             PA-BUYER-QTY                         INKRP106
RB0123                             PA-DMA-QTY                           INKRP106
RB0123                             PA-FINAL-QTY.                        INKRP106
RB0123     ADD PA-EXTENDED-RETAIL TO PA-CLASS-RETAIL                    INKRP106
RB0123                               PA-DEPT-RETAIL                     INKRP106
RB0123                               PA-BUYER-RETAIL                    INKRP106
RB0123                               PA-DMA-RETAIL                      INKRP106
RB0123                               PA-FINAL-RETAIL.                   INKRP106
RB0123                                                                          
RB0123     IF SS-DETAIL-SUB IS EQUAL TO PC-DETAIL-MAX                           
RB0123         IF SS-ENTRY-SUB IS EQUAL TO PC-ENTRY-MAX                         
RB0123             PERFORM Z600-PRINT-HEADINGS                                  
RB0123             PERFORM X100-UNLOAD-DETAIL-TABLE                             
RB0123             INITIALIZE DT-DETAIL-TABLE                                   
RB0123             MOVE 1 TO SS-ENTRY-SUB                                       
RB0123                       SS-DETAIL-SUB                                      
RB0123         ELSE                                                             
RB0123             ADD 1  TO SS-ENTRY-SUB                                       
RB0123             MOVE 1 TO SS-DETAIL-SUB                                      
RB0123         END-IF                                                           
RB0123     ELSE                                                                 
RB0123         ADD 1 TO SS-DETAIL-SUB                                           
RB0123     END-IF.                                                              
RB0123                                                                  INKRP106
RB0123     MOVE IN014-CLASS       TO SA-CLASS.                          INKRP106
RB0123     PERFORM Z100-READ-INVENTORY-FILE.                            INKRP106
RB0123                                                                          
RB0123******************************************************************INKRP106
RB0123* STORE CLASS SUMMARY DATA IN SUMMARY TABLE                       INKRP106
RB0123*                                                                 INKRP106
RB0123******************************************************************INKRP106
RB0123 H200-PROCESS-CLS-SUMMARY.                                        INKRP106
RB0123*                                                                 INKRP106
RB0123     MOVE SA-DEPT                                                         
RB0123         TO ST-DEPT (SS-SUMMARY-SUB).                                     
RB0123     MOVE SA-CLASS                                                        
RB0123         TO ST-CLASS (SS-SUMMARY-SUB).                                    
RB0123     MOVE '-'                                                             
RB0123         TO ST-DASH (SS-SUMMARY-SUB).                                     
RB0123     MOVE PA-CLASS-QTY                                                    
RB0123         TO ST-UNITS (SS-SUMMARY-SUB).                            INKRP106
RB0123     MOVE PA-CLASS-RETAIL                                                 
RB0123         TO ST-RETAIL (SS-SUMMARY-SUB).                                   
RB0123     MOVE H1-CLASS-DESC                                                   
RB0123         TO ST-CLASS-DESC (SS-SUMMARY-SUB).                               
RB0123                                                                          
RB0123     IF SS-SUMMARY-SUB IS EQUAL TO PC-SUMMARY-MAX                         
RB0123         PERFORM Z700-PRINT-BYR-SUMM-HEADINGS                             
RB0123         PERFORM J600-UNLOAD-SUMMARY-TABLE                                
RB0123         INITIALIZE ST-SUMMARY-TABLE                                      
RB0123         MOVE 1 TO SS-SUMMARY-SUB                                         
RB0123     ELSE                                                                 
RB0123         ADD 1  TO SS-SUMMARY-SUB                                         
RB0123     END-IF.                                                              
RB0123                                                                          
RB0123*                                                                         
RB0123 I100-PROCESS-BREAKS.                                                     
RB0123******************************************************************        
RB0123*    - PRINT THE HEADERS AND DETAIL DEPENDING UPON THE BREAK.             
RB0123*                                                                         
RB0123*    - THERE ARE TWO REPORTS THAT ARE CREATED, A DETAIL REPORT            
RB0123*      THAT BREAKS ON DEPARTMENT/CLASS, BUYER, DMA, AND STORE,            
RB0123*      AND A SUMMARY REPORT THAT BREAKS ON DEPT, BUYER, DMA,              
RB0123*      AND STORE.                                                         
RB0123*                                                                         
RB0123******************************************************************        
RB0123                                                                          
RB0123* ******PRINT THE REPORT HEADERS IN THIS SECTION                          
RB0123*    PRINT THE DETAIL REPORT HEADINGS ONLY FOR THE CLASS BREAK            
RB0123     IF PS-BREAK-IS-CLS                                                   
RB0123         PERFORM Z600-PRINT-HEADINGS.                                     
RB0123                                                                          
RB0123*    PRINT SUM REPORT HEADINGS IF BREAK ON DEPT                           
RB0123     IF PS-BREAK-IS-DEPT                                                  
RB0123                                                                          
RB0123         IF PS-BUYER-EXTRA-PAGE-ON                                        
RB0123                                                                          
RB0123             DIVIDE 2 INTO PA-EXCEPT-PAGE-COUNT2                          
RB0123                 GIVING PA-PAGE-DIV                                       
RB0123                 REMAINDER PA-PAGE-REM                                    
RB0123             IF PA-PAGE-REM NOT EQUAL 0                                   
RB0123                                                                          
RB0123                 PERFORM Z800-PRINT-SEPERATOR-PAGE                        
RB0123                 IF PA-PAGE-COUNT2 > ZERO                                 
RB0123                     ADD 1               TO PA-PAGE-COUNT2                
RB0123                 END-IF                                                   
RB0123                 MOVE PA-PAGE-COUNT2     TO HV-PA-PAGE-COUNT2             
RB0123                                                                          
RB0123             END-IF                                                       
RB0123             SET PS-BUYER-EXTRA-PAGE-OFF TO TRUE                          
RB0123                                                                          
RB0123         END-IF                                                           
RB0123                                                                          
RB0123         PERFORM Z700-PRINT-BYR-SUMM-HEADINGS                             
RB0123     END-IF.                                                              
RB0123                                                                          
RB0123                                                                          
RB0123* ******PRINT THE DETAIL AND SUMMARY DATA IN THIS SECTION                 
RB0123*    PRINT THE CLASS DETAIL DATA ON DETAIL REPORT                         
RB0123*    AND MOVE THE SUMMARY DEPARTMENT CLASS TO THE SUMMARY TABLE           
RB0123     IF PS-BREAK-IS-CLS                                                   
RB0123         PERFORM J100-PRINT-DETAIL-DATA                                   
RB0123     END-IF.                                                              
RB0123                                                                          
RB0123*    PRINT THE DEPARTMENT LEVEL TOTALS ON THE DETAIL REPORT               
RB0123*    AND THE DEPT LEVEL TOTALS ON THE SUMMARY REPORT                      
RB0123     IF PS-BREAK-IS-DEPT                                                  
RB0123                                                                          
RB0123*        PRINT THE DEPT TOTALS ON THE DETAIL REPORT                       
RB0123*        AND EMPTY OUT DEPT/CLASS SUMMARY TABLE DATA ONTO THE             
RB0123*        SUMMARY REPORT. PRINT THE DEPT TOTALS ON THE SUMMARY             
RB0123*        REPORT                                                           
RB0123         PERFORM J200-PRINT-DEPT-ON-DETAIL                                
RB0123         PERFORM J600-UNLOAD-SUMMARY-TABLE                                
RB0123         INITIALIZE ST-SUMMARY-TABLE                                      
RB0123         MOVE 1 TO SS-SUMMARY-SUB                                         
RB0123                                                                          
RB0123*        SAVE THE STORE AND BUYER INFO NEEDED IN CASE                     
RB0123*        WHERE AN EXTRA PAGE NEEDS TO PRINT FOR THE BUYER                 
RB0123         MOVE H3-BUYER-NO           TO PC-BUYER-NO                        
RB0123         MOVE H3-BUYER-NAME         TO PC-BUYER-NAME                      
RB0123         MOVE H4-STORE-NO           TO PC-STORE-NO                        
RB0123         MOVE H4-STORE-NAME         TO PC-STORE-NAME                      
RB0123         MOVE H4-INV-DATE           TO PC-INV-DATE                        
RB0123                                                                          
RB0123*        PRINT THE DEPT SUMMARY INFO                                      
RB0123         PERFORM J700-PRINT-DEPT-ON-SUMMARY                               
RB0123                                                                          
RB0123     END-IF.                                                              
RB0123                                                                          
RB0123*    PRINT THE BUYER LEVEL DATA                                           
RB0123     IF PS-BREAK-IS-BYR                                                   
RB0123                                                                          
RB0123         PERFORM J300-PRINT-BUYER-DATA                                    
RB0123         IF H3-BUYER-NO NOT = IN014-BYR                                   
RB0123                                                                          
RB0123             SET PS-BUYER-EXTRA-PAGE-ON TO TRUE                           
RB0123                                                                          
RB0123         END-IF                                                           
RB0123                                                                          
RB0123     END-IF.                                                              
RB0123                                                                          
RB0123*    PRINT THE DMA LEVEL DATA                                             
RB0123     IF PS-BREAK-IS-DMA                                                   
RB0123         PERFORM J400-PRINT-DMA-DATA                                      
RB0123     END-IF.                                                              
RB0123                                                                          
RB0123*    PRINT THE STORE LEVEL DATA                                           
RB0123     IF PS-BREAK-IS-STR                                                   
RB0123         PERFORM J500-PRINT-STR-DATA                                      
RB0123     END-IF.                                                              
RB0123                                                                          
RB0123     SET PS-BREAK-LEVEL-SW-INIT TO TRUE.                                  
RB0123                                                                          
RB0123                                                                          
RB0123 J100-PRINT-DETAIL-DATA.                                                  
RB0123*    UNLOAD DETAIL TABLE TO DETAIL REPORT                                 
RB0123     PERFORM X100-UNLOAD-DETAIL-TABLE.                                    
RB0123                                                                          
RB0123*    PRINT SUMMARY LINE ON DETAIL REPORT                                  
RB0123     MOVE PC-CLASS TO T1-NAME-B.                                          
RB0123     MOVE SA-DEPT  TO T1-DEPT                                             
RB0123                      D2-DEPT.                                            
RB0123     MOVE SA-CLASS TO T1-CLASS                                            
RB0123                      D2-CLASS.                                           
RB0123     MOVE '-'      TO T1-DASH.                                            
RB0123     MOVE PA-CLASS-QTY TO T1-QTY                                          
RB0123                          D2-UNITS.                                       
RB0123     MOVE PA-CLASS-RETAIL TO T1-RETAIL                                    
RB0123                             D2-RETAIL.                                   
RB0123     MOVE 2 TO PC-ADVANCE.                                                
RB0123     MOVE T1-TOTAL TO                                                     
RB0123            PHY-INVENTORY-RPT-RECORD.                                     
RB0123     PERFORM Z400-WRITE-REPORT-LINE.                                      
RB0123                                                                          
RB0123*    PRINT SUMMARY LINE FOR DEPARTMENT CLASS ON SUMMARY RPT               
RB0123     PERFORM H200-PROCESS-CLS-SUMMARY.                                    
RB0123     MOVE ZEROES TO PA-CLASS-QTY                                  INKRP106
RB0123                    PA-CLASS-RETAIL.                              INKRP106
RB0123     MOVE IN014-CLASS TO H1-CLASS.                                INKRP106
RB0123     INITIALIZE DT-DETAIL-TABLE.                                  INKRP106
RB0123     MOVE 1 TO  SS-ENTRY-SUB                                      INKRP106
RB0123                SS-DETAIL-SUB.                                    INKRP106
RB0123     MOVE IN014-CLASS-DESC  TO H1-CLASS-DESC.                     INKRP106
RB0123                                                                          
RB0123 J200-PRINT-DEPT-ON-DETAIL.                                               
RB0123     MOVE PC-DEPT        TO T1-NAME-B                             INKRP106
RB0123                            D3-LEVEL.                             INKRP106
RB0123     MOVE SA-DEPT        TO T1-NAME-NO.                           INKRP106
RB0123     MOVE PA-DEPT-QTY    TO T1-QTY                                INKRP106
RB0123                            D3-UNITS.                             INKRP106
RB0123     MOVE PA-DEPT-RETAIL TO T1-RETAIL                             INKRP106
RB0123                            D3-RETAIL.                            INKRP106
RB0123     MOVE T1-TOTAL TO                                             INKRP106
RB0123            PHY-INVENTORY-RPT-RECORD.                             INKRP106
RB0123     PERFORM Z400-WRITE-REPORT-LINE.                              INKRP106
RB0123                                                                          
RB0123 J300-PRINT-BUYER-DATA.                                                   
RB0123                                                                          
RB0123     MOVE PC-BUYER          TO T1-NAME-B                          INKRP106
RB0123                               D3-LEVEL.                          INKRP106
RB0123     INITIALIZE                D3-DESC.                           INKRP106
RB0123     MOVE SA-BUYER-NUMBER   TO T1-NAME-NO                         INKRP106
RB0123                               D3-NUMBER.                         INKRP106
RB0123     MOVE PA-BUYER-QTY      TO T1-QTY                             INKRP106
RB0123                               D3-UNITS.                          INKRP106
RB0123     MOVE PA-BUYER-RETAIL   TO T1-RETAIL                          INKRP106
RB0123                               D3-RETAIL.                         INKRP106
RB0123     MOVE 2 TO PC-ADVANCE.                                        INKRP106
RB0123     MOVE 2 TO PC-ADVANCE2.                                       INKRP106
RB0123     MOVE T1-TOTAL TO                                             INKRP106
RB0123                PHY-INVENTORY-RPT-RECORD.                         INKRP106
RB0123     PERFORM X400-PRINT-BYR-SUMM-TOT-LINE.                        INKRP106
RB0123     PERFORM Z400-WRITE-REPORT-LINE.                              INKRP106
RB0123     MOVE ZEROES TO PA-BUYER-QTY                                  INKRP106
RB0123                    PA-BUYER-RETAIL.                              INKRP106
RB0123                                                                          
RB0123 J400-PRINT-DMA-DATA.                                                     
RB0123                                                                          
RB0123     MOVE PC-DMA          TO   D3-LEVEL.                          INKRP106
RB0123     INITIALIZE D3-DESC.                                          INKRP106
RB0123     MOVE SA-DMA          TO   D3-NUMBER.                         INKRP106
RB0123     MOVE PA-DMA-QTY      TO   D3-UNITS.                          INKRP106
RB0123     MOVE PA-DMA-RETAIL   TO   D3-RETAIL.                         INKRP106
RB0123     MOVE 2 TO PC-ADVANCE2.                                       INKRP106
RB0123     PERFORM X400-PRINT-BYR-SUMM-TOT-LINE.                        INKRP106
RB0123                                                                  INKRP106
RB0123     MOVE IN014-BYR           TO  H3-BUYER-NO.                    INKRP106
RB0123     MOVE PV-FULL-NAME        TO  H3-BUYER-NAME.                  INKRP106
RB0123     MOVE IN014-BYR TO SA-BUYER-NUMBER.                           INKRP106
RB0123                                                                  INKRP106
RB0123     MOVE ZEROES TO PA-DMA-QTY                                    INKRP106
RB0123                    PA-DMA-RETAIL.                                INKRP106
RB0123                                                                          
RB0123 J500-PRINT-STR-DATA.                                                     
RB0123                                                                          
RB0123*    PRINT HEADER FOR THE DETAIL REPORT                                   
RB0123     MOVE SPACES TO H1-DEPT-CLASS.                                INKRP106
RB0123     INITIALIZE H1-CLASS-DESC                                     INKRP106
RB0123                H2-BUYER-NO                                       INKRP106
RB0123                H3-BUYER-NO                                       INKRP106
RB0123                H2-BUYER-NAME                                     INKRP106
RB0123                H3-BUYER-NAME.                                    INKRP106
RB0123     PERFORM Z600-PRINT-HEADINGS.                                         
RB0123                                                                          
RB0123*    MAP DATA FOR THE DETAIL FINAL LINE AND THE SUMMARY FINAL LINE        
RB0123     MOVE PC-FINAL  TO T1-NAME                                    INKRP106
RB0123                       D3-LEVEL.                                  INKRP106
RB0123     MOVE PA-FINAL-QTY TO T1-QTY                                  INKRP106
RB0123                          D3-UNITS.                               INKRP106
RB0123     MOVE PA-FINAL-RETAIL TO T1-RETAIL                            INKRP106
RB0123                             D3-RETAIL.                           INKRP106
RB0123     INITIALIZE D3-NUMBER                                         INKRP106
RB0123                D3-DESC.                                          INKRP106
RB0123     MOVE 3 TO PC-ADVANCE.                                        INKRP106
RB0123     MOVE 3 TO PC-ADVANCE2.                                       INKRP106
RB0123     MOVE T1-TOTAL TO                                             INKRP106
RB0123                PHY-INVENTORY-RPT-RECORD.                         INKRP106
RB0123                                                                          
RB0123*    PRINT THE FINAL LINES ON THE DETAIL                                  
RB0123*    AND CHECK TO SEE IF AN EXTRA PAGE NEEDS TO PRINT                     
RB0123*    ON THE DETAIL REPORT                                                 
RB0123                                                                          
RB0123     PERFORM Z400-WRITE-REPORT-LINE.                              INKRP106
RB0123     DIVIDE 2 INTO PA-EXCEPT-PAGE-COUNT                                   
RB0123         GIVING PA-PAGE-DIV                                               
RB0123         REMAINDER PA-PAGE-REM                                            
RB0123     IF PA-PAGE-REM NOT EQUAL 0                                           
RB0123                                                                          
RB0123         PERFORM Z600-PRINT-HEADINGS                                      
RB0123         MOVE D4-DETAIL-LINE TO PHY-INVENTORY-RPT-RECORD          INKRP106
RB0123         PERFORM Z400-WRITE-REPORT-LINE                           INKRP106
RB0123                                                                          
RB0123         IF PA-PAGE-COUNT  > ZERO                                         
RB0123             ADD 1               TO PA-PAGE-COUNT                         
RB0123         END-IF                                                           
RB0123         MOVE PA-PAGE-COUNT      TO HV-PA-PAGE-COUNT                      
RB0123                                                                          
RB0123     END-IF                                                               
RB0123                                                                          
RB0123*    PRINT THE FINAL LINES ON THE SUMMARY REPORT                          
RB0123     PERFORM X400-PRINT-BYR-SUMM-TOT-LINE.                        INKRP106
RB0123     MOVE PA-PAGE-COUNT   TO HV-PA-PAGE-COUNT.                            
RB0123     MOVE PA-PAGE-COUNT2  TO HV-PA-PAGE-COUNT2.                           
RB0123     MOVE ZEROES TO PA-FINAL-QTY                                  INKRP106
RB0123                    PA-FINAL-RETAIL                               INKRP106
RB0123                    PA-PAGE-COUNT                                         
RB0123                    PA-PAGE-COUNT2.                                       
RB0123*                                                                         
RB0123                                                                          
RB0123******************************************************************INKRP106
RB0123* J600-UNLOAD-DETAIL-TABLE  SUBSCRIPT FOR ROWS IS INCREMENTED     INKRP106
RB0123******************************************************************INKRP106
RB0123 J600-UNLOAD-SUMMARY-TABLE.                                       INKRP106
RB0123*                                                                 INKRP106
RB0123     MOVE 1 TO PC-ADVANCE2.                                       INKRP106
RB0123     PERFORM VARYING SS-SUB FROM 1 BY 1                           INKRP106
RB0123             UNTIL   SS-SUB >= SS-SUMMARY-SUB                     INKRP106
RB0123         MOVE SPACES TO D2-DETAIL-LINE                            INKRP106
RB0123         MOVE '-'                    TO D2-DASH                   INKRP106
RB0123         MOVE ST-DEPT       (SS-SUB) TO D2-DEPT                           
RB0123         MOVE ST-CLASS      (SS-SUB) TO D2-CLASS                          
RB0123         MOVE ST-CLASS-DESC (SS-SUB) TO D2-CLASS-DESC                     
RB0123         MOVE ST-RETAIL     (SS-SUB) TO D2-RETAIL                         
RB0123         MOVE ST-UNITS      (SS-SUB) TO D2-UNITS                          
RB0123                                                                  INKRP106
RB0123         PERFORM X300-PRINT-BYR-SUMM-LINE                         INKRP106
RB0123                                                                  INKRP106
RB0123     END-PERFORM.                                                 INKRP106
RB0123*                                                                         
RB0123                                                                          
RB0123******************************************************************INKRP106
RB0123* PRINT THE DEPARTMENT LEVEL DATA ON THE SUMMARY REPORT           INKRP106
RB0123******************************************************************INKRP106
RB0123 J700-PRINT-DEPT-ON-SUMMARY.                                              
RB0123                                                                          
RB0123*    MAP DATA FOR PRINTING DEPT SUMMARY LINE                              
RB0123     MOVE PC-DEPT        TO D3-LEVEL.                             INKRP106
RB0123     MOVE PA-DEPT-QTY    TO D3-UNITS.                             INKRP106
RB0123     MOVE PA-DEPT-RETAIL TO D3-RETAIL.                            INKRP106
RB0123     MOVE H1-DEPT        TO D3-NUMBER.                            INKRP106
RB0123     MOVE PV-MDSEAR-DESC TO D3-DESC.                              INKRP106
RB0123     MOVE 2 TO PC-ADVANCE2.                                       INKRP106
RB0123     MOVE +99 TO PC-LINE-COUNT2.                                  INKRP106
RB0123                                                                          
RB0123*    PRINT THE DEPT SUMMARY LINE ON THE SUMMARY REPORT            INKRP106
RB0123     PERFORM X400-PRINT-BYR-SUMM-TOT-LINE.                        INKRP106
RB0123                                                                          
RB0123*    CLEAR OUT DEPARTMENT ACCCUMMULATORS                                  
RB0123     MOVE ZEROES TO PA-DEPT-QTY                                   INKRP106
RB0123                    PA-DEPT-RETAIL.                               INKRP106
RB0123     MOVE IN014-DEPT    TO H1-DEPT.                               INKRP106
RB0123     MOVE '-'           TO H1-DASH.                                       
RB0123     PERFORM X200-GET-DEPT-DESC.                                  INKRP106
RB0123                                                                          
RB0123                                                                          
00637 *                                                                 INKRP106
00706 ******************************************************************INKRP106
RB0123* X100-UNLOAD-DETAIL-TABLE  SUBSCRIPT FOR ROWS IS INCREMENTED     INKRP106
00708 ******************************************************************INKRP106
RB0123 X100-UNLOAD-DETAIL-TABLE.                                        INKRP106
00710 *                                                                 INKRP106
00711      MOVE 1 TO PC-ADVANCE.                                        INKRP106
00712      PERFORM                                                      INKRP106
00713          VARYING SS-SUB FROM 1 BY 1                               INKRP106
00714          UNTIL   SS-SUB > PC-DETAIL-MAX                           INKRP106
00715          MOVE SPACES TO D1-DETAIL-LINE                            INKRP106
00716          EVALUATE TRUE                                            INKRP106
W26600           WHEN SS-ENTRY-SUB = 1                                  INKRP106
W26600             IF SS-SUB >= SS-DETAIL-SUB                           INKRP106
W26600               MOVE +51              TO SS-SUB                    INKRP106
W26600             ELSE                                                 INKRP106
W26600               MOVE DT-AREA (1, SS-SUB)                           INKRP106
W26600                                     TO D1-AREA (1)               INKRP106
W26600               MOVE DT-EXT-RTL (1, SS-SUB)                        INKRP106
W26600                                     TO D1-EXT-RTL (1)            INKRP106
W26600               MOVE DT-SKU  (1, SS-SUB)                           INKRP106
W26600                                     TO D1-SKU (1)                INKRP106
W26600               MOVE DT-UPC  (1, SS-SUB)                           INKRP106
W26600                                     TO D1-UPC (1)                INKRP106
W26600               MOVE DT-PRICE (1, SS-SUB)                          INKRP106
W26600                                     TO D1-PRICE (1)              INKRP106
W26600               MOVE DT-QTY  (1, SS-SUB)                           INKRP106
W26600                                     TO D1-QTY (1)                INKRP106
W26600                                                                  INKRP106
W26600               MOVE DT-EXT-RTL (1, SS-SUB)                        INKRP106
W26600                                     TO D1-EXT-RTL (1)            INKRP106
W26600               MOVE D1-DETAIL-LINE   TO PHY-INVENTORY-RPT-RECORD  INKRP106
W26600               PERFORM Z400-WRITE-REPORT-LINE                     INKRP106
W26600             END-IF                                               INKRP106
W26600           WHEN SS-ENTRY-SUB = 2                                  INKRP106
W26000             MOVE DT-AREA  (1, SS-SUB)                            INKRP106
W26000                                     TO D1-AREA  (1)              INKRP106
W26600             MOVE DT-SKU (1, SS-SUB) TO D1-SKU (1)                INKRP106
W26600             MOVE DT-UPC (1, SS-SUB) TO D1-UPC (1)                INKRP106
W26600             MOVE DT-PRICE (1, SS-SUB)                            INKRP106
W26600                                     TO D1-PRICE (1)              INKRP106
W26600             MOVE DT-QTY (1, SS-SUB) TO D1-QTY (1)                INKRP106
W26600             MOVE DT-EXT-RTL (1, SS-SUB)                          INKRP106
W26600                                     TO D1-EXT-RTL (1)            INKRP106
W26600             IF SS-SUB <= SS-DETAIL-SUB                           INKRP106
W26600               MOVE DT-AREA (2, SS-SUB)                           INKRP106
W26600                                     TO D1-AREA (2)               INKRP106
W26600               MOVE DT-SKU (2, SS-SUB)                            INKRP106
W26600                                     TO D1-SKU (2)                INKRP106
W26600               MOVE DT-UPC (2, SS-SUB)                            INKRP106
W26600                                     TO D1-UPC (2)                INKRP106
W26600               MOVE DT-PRICE (2, SS-SUB)                          INKRP106
W26600                                     TO D1-PRICE (2)              INKRP106
W26600               MOVE DT-QTY (2, SS-SUB)                            INKRP106
W26600                                     TO D1-QTY (2)                INKRP106
W26600               MOVE DT-EXT-RTL (2, SS-SUB)                        INKRP106
W26600                                     TO D1-EXT-RTL (2)            INKRP106
W26600             END-IF                                               INKRP106
W26600             MOVE D1-DETAIL-LINE     TO PHY-INVENTORY-RPT-RECORD  INKRP106
W26600             PERFORM Z400-WRITE-REPORT-LINE                       INKRP106
25248 *          WHEN SS-ENTRY-SUB = 3                                  INKRP106
  |   *                MOVE DT-PRICE (1, SS-SUB)   TO D1-PRICE (1)      INKRP106
  |   *                MOVE DT-EXT-RTL (1, SS-SUB) TO D1-EXT-RTL (1)    INKRP106
  |   *                MOVE DT-UPC-SKU (1, SS-SUB) TO D1-UPC-SKU (1)    INKRP106
  |   *                MOVE DT-QTY  (1, SS-SUB)    TO D1-QTY (1)        INKRP106
  |   *                MOVE DT-AREA  (1, SS-SUB)   TO D1-AREA  (1)      INKRP106
  |   *                                                                 INKRP106
  |   *                MOVE DT-PRICE (2, SS-SUB)   TO D1-PRICE (2)      INKRP106
  |   *                MOVE DT-EXT-RTL (2, SS-SUB) TO D1-EXT-RTL (2)    INKRP106
  |   *                MOVE DT-UPC-SKU (2, SS-SUB) TO D1-UPC-SKU (2)    INKRP106
  |   *                MOVE DT-QTY  (2, SS-SUB)    TO D1-QTY (2)        INKRP106
  |   *                MOVE DT-AREA  (2, SS-SUB)   TO D1-AREA  (2)      INKRP106
  |   *                                                                 INKRP106
  |   *                IF SS-SUB <= SS-DETAIL-SUB                       INKRP106
  |   *                    MOVE DT-PRICE (3, SS-SUB)   TO D1-PRICE (3)  INKRP106
  |   *                    MOVE DT-EXT-RTL (3, SS-SUB) TO D1-EXT-RTL (3)INKRP106
  |   *                    MOVE DT-UPC-SKU  (3, SS-SUB)                 INKRP106
  |   *                                            TO D1-UPC-SKU (3)    INKRP106
  |   *                    MOVE DT-QTY  (3, SS-SUB)    TO D1-QTY (3)    INKRP106
  |   *                    MOVE DT-AREA  (3, SS-SUB)   TO D1-AREA (3)   INKRP106
  |   *                END-IF                                           INKRP106
  |   *                MOVE D1-DETAIL-LINE TO                           INKRP106
  |   *                     PHY-INVENTORY-RPT-RECORD                    INKRP106
25248 *                PERFORM Z400-WRITE-REPORT-LINE                   INKRP106
00771          END-EVALUATE                                             INKRP106
00772                                                                   INKRP106
00773      END-PERFORM.                                                 INKRP106
00774 *                                                                 INKRP106
00775 ******************************************************************INKRP106
00776 *                                                                 INKRP106
00777 ******************************************************************INKRP106
RB0123 X200-GET-DEPT-DESC.                                              INKRP106
00779 *                                                                 INKRP106
W21732     MOVE IN014-DEPT(2:3)  TO DK-DEPT.                            INKRP106
00781      MOVE '000'       TO DK-MAJ-CL                                INKRP106
00782                          DK-SUB-CL.                               INKRP106
00783      MOVE PC-DPT TO DK-MDSELV-CDE.                                INKRP106
00784      MOVE PC-BYR TO DK-RSPLVL-CDE.                                INKRP106
00785      PERFORM Z300-GET-MERCH-AREA-INFO.                            INKRP106
RB0123     PERFORM Y100-FORMAT-NAME.                                    INKRP106
00789      MOVE PV-FULL-NAME TO H2-BUYER-NAME                           INKRP106
00790                           H3-BUYER-NAME.                          INKRP106
P28545     MOVE IN400-ATT-MDSEAR-DESC TO PV-MDSEAR-DESC.                INKRP106
00792 *                                                                 INKRP106
00793 ******************************************************************INKRP106
00794 *                                                                 INKRP106
00795 ******************************************************************INKRP106
RB0123 X300-PRINT-BYR-SUMM-LINE.                                        INKRP106
00797 *                                                                 INKRP106
00803      MOVE D2-DETAIL-LINE TO BUYER-SUMMARY-RPT-RECORD.             INKRP106
00804      PERFORM Z500-WRITE-BYR-SUMM-LINE.                            INKRP106
00805 *                                                                 INKRP106
00806 ******************************************************************INKRP106
00807 *                                                                 INKRP106
00808 ******************************************************************INKRP106
RB0123 X400-PRINT-BYR-SUMM-TOT-LINE.                                    INKRP106
00810 *                                                                 INKRP106
00811      MOVE D3-DETAIL-LINE TO BUYER-SUMMARY-RPT-RECORD.             INKRP106
00812      PERFORM Z500-WRITE-BYR-SUMM-LINE.                            INKRP106
00813 *                                                                 INKRP106
00814 ******************************************************************INKRP106
00815 *                                                                 INKRP106
00816 ******************************************************************INKRP106
RB0123 Y100-FORMAT-NAME.                                                INKRP106
00818 *                                                                 INKRP106
00819      SET PS-NOT-DONE TO TRUE.                                     INKRP106
00820      PERFORM VARYING SS-FIRST-SUB                                 INKRP106
00821              FROM PC-END-FIRST-NAME BY -1                         INKRP106
00822              UNTIL (PS-DONE OR                                    INKRP106
00823                     SS-FIRST-SUB < 1)                             INKRP106
00824         IF PV-FNAME-DIGIT(SS-FIRST-SUB) NOT = SPACES              INKRP106
00825            SET PS-DONE TO TRUE                                    INKRP106
00826         END-IF                                                    INKRP106
00827      END-PERFORM.                                                 INKRP106
00828                                                                   INKRP106
00829 *                                                                 INKRP106
00830      SET PS-NOT-DONE TO TRUE                                      INKRP106
00831      PERFORM VARYING SS-LAST-SUB                                  INKRP106
00832              FROM PC-END-LAST-NAME BY -1                          INKRP106
00833              UNTIL (PS-DONE OR                                    INKRP106
00834                     SS-LAST-SUB < 1)                              INKRP106
00835         IF PV-LNAME-DIGIT(SS-LAST-SUB) NOT = SPACES               INKRP106
00836            SET PS-DONE TO TRUE                                    INKRP106
00837         END-IF                                                    INKRP106
00838      END-PERFORM.                                                 INKRP106
00839                                                                   INKRP106
00840      MOVE PV-FIRST-NAME TO PV-FULL-NAME.                          INKRP106
00841 *                                                                 INKRP106
25248      COMPUTE SS-FIRST-SUB = SS-FIRST-SUB + 2                      INKRP106
00843      SET PS-NOT-DONE TO TRUE                                      INKRP106
00844      MOVE 1 TO SS-TEMP-SUB2.                                      INKRP106
00845      PERFORM VARYING SS-TEMP-SUB1                                 INKRP106
00846             FROM SS-FIRST-SUB BY 1                                INKRP106
00847             UNTIL (SS-TEMP-SUB1 > 20 OR PS-DONE)                  INKRP106
00848                                                                   INKRP106
00849         IF SS-TEMP-SUB2 > SS-LAST-SUB                             INKRP106
00850            SET PS-DONE TO TRUE                                    INKRP106
00851         END-IF                                                    INKRP106
00852                                                                   INKRP106
00853         MOVE PV-LNAME-DIGIT(SS-TEMP-SUB2) TO                      INKRP106
00854                              PV-FULLNAME-DIGIT(SS-TEMP-SUB1)      INKRP106
00855         ADD 1 TO SS-TEMP-SUB2                                     INKRP106
00856      END-PERFORM.                                                 INKRP106
00857 *                                                                 INKRP106
00858 ******************************************************************INKRP106
00859 *   READ FOR EDITED INVENTORY FILE                                INKRP106
00860 ******************************************************************INKRP106
00861  Z100-READ-INVENTORY-FILE.                                        INKRP106
00862 *                                                                 INKRP106
00863      READ PHY-INVENTORY-FILE                                      INKRP106
00864          INTO IN014-VALID-REPORT-RECORD                           INKRP106
00865              AT END                                               INKRP106
00866                 SET PS-END-OF-INPUT TO TRUE.                      INKRP106
00867 *                                                                 INKRP106
00868 ***************************************************************** INKRP106
00869 * Z200-READ-STORE-DB   READS THE DB2 STORE TABLE                  INKRP106
00870 ***************************************************************** INKRP106
00871  Z200-READ-STORE-DB.                                              INKRP106
00872                                                                   INKRP106
00873      PERFORM                                                      INKRP106
00874          WITH TEST AFTER                                          INKRP106
00875          VARYING PV-SQL-SUB                                       INKRP106
00876          FROM 1 BY 1                                              INKRP106
00877          UNTIL (PV-SQL-SUB > PC-MAX-RETRIES) OR                   INKRP106
00878                (SQLCODE = 0)                                      INKRP106
00879                                                                   INKRP106
  |            MOVE SA-STORE-NO         TO PV-EDIT-LOC-NBR                      
  |            MOVE PV-EDIT-LOC-NBR     TO XMT00001-LOC-NBR                     
  |                                                                             
  |            EXEC SQL                                                         
  |                SELECT LOC_NM                                                
  |                INTO :FF-STORE-NAME                                          
  |                FROM XMT_LOC                                                 
25248              WHERE LOC_NBR = :XMT00001-LOC-NBR                            
P28545             WITH UR                                                      
25248          END-EXEC                                                         
25248                                                                           
00888          EVALUATE TRUE                                            INKRP106
00889              WHEN SQLCODE = -904                                  INKRP106
00890              WHEN SQLCODE = -911                                  INKRP106
00891              WHEN SQLCODE = ZERO                                  INKRP106
00892                  CONTINUE                                         INKRP106
00893              WHEN SQLWARN0 NOT = SPACES                           INKRP106
00894              WHEN SQLCODE < 0                                     INKRP106
00895              WHEN SQLCODE > 0                                     INKRP106
00896                   MOVE 'Z200-READ-STORE-DB'                       INKRP106
00897                         TO PV-PARAGRAPH-NAME                      INKRP106
00898                   MOVE 'READING STORE TABLE'                      INKRP106
00899                         TO PV-DB2-OPER-ATTEMPTED                  INKRP106
00900                   PERFORM Z900-SQL-ABEND                          INKRP106
00901          END-EVALUATE                                             INKRP106
00902      END-PERFORM.                                                 INKRP106
00903                                                                   INKRP106
00904      IF PV-SQL-SUB > PC-MAX-RETRIES                               INKRP106
00905           MOVE 'Z200-READ-STORE-DB' TO PV-PARAGRAPH-NAME          INKRP106
00906           MOVE 'EXCEEDED MAX RETRIES' TO PV-DB2-OPER-ATTEMPTED    INKRP106
00907           PERFORM Z900-SQL-ABEND                                  INKRP106
00908      END-IF.                                                      INKRP106
00909 *                                                                 INKRP106
00910 ***************************************************************** INKRP106
00911 *                                                                 INKRP106
00912 ***************************************************************** INKRP106
00913  Z300-GET-MERCH-AREA-INFO.                                        INKRP106
P28545                                                                  INKRP106
P28545     INITIALIZE IN400-PV-INPUT-AREA.                                      
P28545                                                                          
P28545     SET IN400-PV-SKU-ATTRIB-LOOK TO TRUE.                                
P28545     MOVE IN014-STORE-NUMBER  TO IN400-PV-LOC-IN.                         
P28545     MOVE IN014-INV-DATE      TO IN400-PV-EFF-DTE-IN.                     
P28545     MOVE IN014-SKU           TO IN400-PV-SKU-IN.                         
P28545                                                                          
P28545     PERFORM IN400-LOOKUP-RETAIL.                                         
P28545                                                                          
P28545     IF IN400-PV-ATT-FOUND                                                
P28545         MOVE IN400-ATT-BYR-FIR-NAME  TO PV-FIRST-NAME                    
P28545         MOVE IN400-ATT-BYR-LAST-NAME TO PV-LAST-NAME                     
P28545     ELSE                                                                 
P28545         MOVE 'UNKNOWN'               TO PV-FIRST-NAME                    
P28545         MOVE SPACES                  TO PV-LAST-NAME                     
P28545     END-IF.                                                              
P28545                                                                          
P28545*    PERFORM                                                      INKRP106
P28545*        WITH TEST AFTER                                          INKRP106
P28545*        VARYING PV-SQL-SUB                                       INKRP106
P28545*        FROM 1 BY 1                                              INKRP106
P28545*        UNTIL (PV-SQL-SUB > PC-MAX-RETRIES) OR                   INKRP106
P28545*              (SQLCODE = 0)                                      INKRP106
P28545*       MOVE PC-OPERCO-NBR  TO MDSEAR-OPERCO-NBR                          
P28545*       MOVE DK-DEPT        TO MDSEAR-DEPT-NBR                            
P28545*       MOVE DK-SUB-CL      TO MDSEAR-SUB-CL-NBR                          
P28545*       MOVE DK-MAJ-CL      TO MDSEAR-MAJ-CL-NBR                          
P28545*       MOVE DK-MDSELV-CDE  TO MDSEAR-MDSELV-CDE                          
P28545*       MOVE DK-RSPLVL-CDE  TO RSPBAR-RSPLVL-CDE                          
P28545*                                                                 INKRP106
P28545*        EXEC SQL                                                 INKRP106
P28545*            SELECT WORKER_FIR_NAME,                              INKRP106
P28545*                   WORKER_LAST_NAME,                             INKRP106
P28545*                   MDSEAR_DESC                                   INKRP106
P28545*            INTO   :RSPBAR-WORKER-FIR-NAME,                      INKRP106
P28545*                   :RSPBAR-WORKER-LAST-NAME,                     INKRP106
P28545*                   :MDSEAR-DESC                                  INKRP106
P28545*            FROM   TMDSEAR B,                                    INKRP106
P28545*                   TRSPBAR A                                     INKRP106
P28545*            WHERE (B.OPERCO_NBR  = :MDSEAR-OPERCO-NBR)                   
P28545*              AND (B.DEPT_NBR    = :MDSEAR-DEPT-NBR)                     
P28545*              AND (B.MAJ_CL_NBR  = :MDSEAR-MAJ-CL-NBR)                   
P28545*              AND (B.SUB_CL_NBR  = :MDSEAR-SUB-CL-NBR)                   
P28545*              AND (B.MDSELV_CDE  = :MDSEAR-MDSELV-CDE)                   
P28545*              AND (B.MDSEAR_DKEY = A.MDSEAR_DKEY)                        
P28545*              AND (A.RSPLVL_CDE  = :RSPBAR-RSPLVL-CDE)                   
P28545*              AND ((A.WORKER_STRT_DTE <=                         INKRP106
P28545*                              DATE (CURRENT TIMESTAMP)) AND      INKRP106
P28545*                  (DATE (CURRENT TIMESTAMP) <=                   INKRP106
P28545*                              A.WORKER_END_DTE))                 INKRP106
P28545*              AND ((B.STRT_DTE <= DATE (CURRENT TIMESTAMP)) AND  INKRP106
P28545*                  (DATE (CURRENT TIMESTAMP) <= B.END_DTE))       INKRP106
P28545*        END-EXEC                                                 INKRP106
P28545*                                                                 INKRP106
P28545*        EVALUATE TRUE                                            INKRP106
P28545*            WHEN SQLCODE = -904                                  INKRP106
P28545*            WHEN SQLCODE = -911                                  INKRP106
P28545*            WHEN SQLCODE = ZERO                                  INKRP106
P28545*                CONTINUE                                         INKRP106
P28545*            WHEN SQLWARN0 NOT = SPACES                           INKRP106
P28545*            WHEN SQLCODE < 0                                     INKRP106
P28545*            WHEN SQLCODE > 0                                     INKRP106
P28545*                 DISPLAY 'STORE NUMBER : ', SA-STORE-NO          INKRP106
P28545*                 DISPLAY 'SQL DETAIL - SKU: ', DK-DEPT, '-',     INKRP106
P28545*                 DK-MAJ-CL, '-', DK-SUB-CL                       INKRP106
P28545*                 MOVE 'Z300-GET-MERCH-AREA-INFO'                 INKRP106
P28545*                       TO PV-PARAGRAPH-NAME                      INKRP106
P28545*                 MOVE 'SELECT MERCH AREA INFO'                   INKRP106
P28545*                       TO PV-DB2-OPER-ATTEMPTED                  INKRP106
P28545*                 PERFORM Z900-SQL-ABEND                          INKRP106
P28545*        END-EVALUATE                                             INKRP106
P28545*    END-PERFORM.                                                 INKRP106
P28545*    IF PV-SQL-SUB > PC-MAX-RETRIES                               INKRP106
P28545*         MOVE 'Z300-GET-MERCH-AREA-INFO' TO PV-PARAGRAPH-NAME    INKRP106
P28545*         MOVE 'EXCEEDED MAX RETRIES' TO PV-DB2-OPER-ATTEMPTED    INKRP106
P28545*         PERFORM Z900-SQL-ABEND                                  INKRP106
P28545*    END-IF.                                                      INKRP106
P28545*                                                                 INKRP106
00967 ***************************************************************** INKRP106
00968 * Z400-WRITE-REPORT-LINE  WRITE ROUTINE FOR DEPT/CLASS REPORT     INKRP106
00969 ***************************************************************** INKRP106
00970  Z400-WRITE-REPORT-LINE.                                          INKRP106
00971 *                                                                 INKRP106
00972      WRITE PHY-INVENTORY-RPT-RECORD                               INKRP106
00973        AFTER ADVANCING PC-ADVANCE.                                INKRP106
00974      ADD PC-ADVANCE TO PC-LINE-COUNT.                             INKRP106
00975                                                                   INKRP106
00976 *                                                                 INKRP106
00977 ***************************************************************** INKRP106
00978 *                                                                 INKRP106
00979 ***************************************************************** INKRP106
00980  Z500-WRITE-BYR-SUMM-LINE.                                        INKRP106
00981 *                                                                 INKRP106
00982      WRITE BUYER-SUMMARY-RPT-RECORD                               INKRP106
00983        AFTER ADVANCING PC-ADVANCE2.                               INKRP106
00984      ADD PC-ADVANCE2 TO PC-LINE-COUNT2.                           INKRP106
00985                                                                   INKRP106
00986 ******************************************************************INKRP106
00987 *  HEADING ROUTINE FOR DEPT/CLASS REPORT                          INKRP106
00988 ******************************************************************INKRP106
RB0123 Z600-PRINT-HEADINGS.                                             INKRP106
00990 *                                                                 INKRP106
00991      ADD 1 TO PA-PAGE-COUNT                                       INKRP106
RB0123              PA-EXCEPT-PAGE-COUNT.                                       
00992      MOVE PA-PAGE-COUNT TO DP132O-PAGE-NUMBER.                    INKRP106
00993      MOVE 1 TO DP132O-REPORT-NUMBER.                              INKRP106
00994      MOVE DP132O-STANDRD-HEADER-132-COLS TO                       INKRP106
00995             PHY-INVENTORY-RPT-RECORD.                             INKRP106
00996      WRITE PHY-INVENTORY-RPT-RECORD                               INKRP106
00997            AFTER ADVANCING PAGE.                                  INKRP106
00998      MOVE ZERO TO PC-LINE-COUNT.                                  INKRP106
00999                                                                   INKRP106
01000      MOVE H1-HEADING TO                                           INKRP106
01001             PHY-INVENTORY-RPT-RECORD.                             INKRP106
01002      MOVE 1 TO PC-ADVANCE.                                        INKRP106
01003      PERFORM Z400-WRITE-REPORT-LINE.                              INKRP106
01004                                                                   INKRP106
01005      MOVE H2-HEADING TO                                           INKRP106
01006             PHY-INVENTORY-RPT-RECORD.                             INKRP106
01007      MOVE 2 TO PC-ADVANCE.                                        INKRP106
01008      PERFORM Z400-WRITE-REPORT-LINE.                              INKRP106
01009      MOVE H5-HEADING TO                                           INKRP106
01010             PHY-INVENTORY-RPT-RECORD.                             INKRP106
01011      MOVE 2 TO PC-ADVANCE.                                        INKRP106
01012      PERFORM Z400-WRITE-REPORT-LINE.                              INKRP106
01013                                                                   INKRP106
01014      MOVE H6-HEADING TO                                           INKRP106
01015             PHY-INVENTORY-RPT-RECORD.                             INKRP106
01016      MOVE 1 TO PC-ADVANCE.                                        INKRP106
01017      PERFORM Z400-WRITE-REPORT-LINE.                              INKRP106
01018                                                                   INKRP106
01019      INITIALIZE PHY-INVENTORY-RPT-RECORD.                         INKRP106
01020      PERFORM Z400-WRITE-REPORT-LINE.                              INKRP106
01021 *                                                                 INKRP106
01022 ******************************************************************INKRP106
01023 *  HEADING ROUTINE FOR DEPT/CLASS REPORT                          INKRP106
01024 ******************************************************************INKRP106
RB0123 Z700-PRINT-BYR-SUMM-HEADINGS.                                    INKRP106
01026 *                                                                 INKRP106
RB0123     IF PS-BUYER-EXTRA-PAGE-OFF                                           
01027          ADD 1 TO PA-PAGE-COUNT2                                  INKRP106
RB0123                  HV-PA-PAGE-COUNT2                                       
01028          MOVE PA-PAGE-COUNT2 TO DP132O-PAGE-NUMBER                INKRP106
RB0123     ELSE                                                                 
RB0123         ADD 1 TO HV-PA-PAGE-COUNT2                                       
RB0123         MOVE HV-PA-PAGE-COUNT2 TO DP132O-PAGE-NUMBER                     
RB0123     END-IF.                                                              
RB0123                                                                          
RB0123     ADD 1 TO PA-EXCEPT-PAGE-COUNT2.                                      
01029      MOVE 2 TO DP132O-REPORT-NUMBER.                              INKRP106
01030      MOVE DP132O-STANDRD-HEADER-132-COLS TO                       INKRP106
01031           BUYER-SUMMARY-RPT-RECORD.                               INKRP106
01032      WRITE BUYER-SUMMARY-RPT-RECORD                               INKRP106
01033            AFTER ADVANCING PAGE.                                  INKRP106
01034                                                                   INKRP106
01035      MOVE ZERO TO PC-LINE-COUNT2.                                 INKRP106
01036                                                                   INKRP106
01037      MOVE H4-HEADING TO                                           INKRP106
01038           BUYER-SUMMARY-RPT-RECORD.                               INKRP106
01039      MOVE 1 TO PC-ADVANCE2.                                       INKRP106
01040      PERFORM Z500-WRITE-BYR-SUMM-LINE.                            INKRP106
01041                                                                   INKRP106
01042      MOVE H7-HEADING TO                                           INKRP106
01043           BUYER-SUMMARY-RPT-RECORD.                               INKRP106
01044      MOVE 2 TO PC-ADVANCE2.                                       INKRP106
01045      PERFORM Z500-WRITE-BYR-SUMM-LINE.                            INKRP106
01046                                                                   INKRP106
01047      MOVE H3-HEADING TO                                           INKRP106
01048           BUYER-SUMMARY-RPT-RECORD.                               INKRP106
01049      MOVE 2 TO PC-ADVANCE2.                                       INKRP106
01050      PERFORM Z500-WRITE-BYR-SUMM-LINE.                            INKRP106
01051                                                                   INKRP106
00501 *                                                                 INKRP106
BYRRPT***************************************************************** INKRP106
BYRRPT* Z800-PRINT-SEPARATOR-PAGE TO SEGREGATE BUYER REPORTS            INKRP106
BYRRPT***************************************************************** INKRP106
BYRRPT Z800-PRINT-SEPERATOR-PAGE.                                       INKRP106
BYRRPT*                                                                 INKRP106
RB0123     MOVE H3-BUYER-NO    TO HV-BUYER-NO.                                  
RB0123     MOVE H3-BUYER-NAME  TO HV-BUYER-NAME.                                
RB0123     MOVE H4-STORE-NO    TO HV-STORE-NO.                                  
RB0123     MOVE H4-STORE-NAME  TO HV-STORE-NAME.                                
RB0123     MOVE H4-INV-DATE    TO HV-INV-DATE.                                  
RB0123                                                                          
RB0123     MOVE PC-BUYER-NO    TO H3-BUYER-NO.                                  
RB0123     MOVE PC-BUYER-NAME  TO H3-BUYER-NAME.                                
RB0123     MOVE PC-STORE-NO    TO H4-STORE-NO.                                  
RB0123     MOVE PC-STORE-NAME  TO H4-STORE-NAME.                                
RB0123     MOVE PC-INV-DATE    TO H4-INV-DATE.                                  
RB0123                                                                          
RB0123     PERFORM Z700-PRINT-BYR-SUMM-HEADINGS.                                
BYRRPT     MOVE D4-DETAIL-LINE TO BUYER-SUMMARY-RPT-RECORD.             INKRP106
BYRRPT     PERFORM Z500-WRITE-BYR-SUMM-LINE.                            INKRP106
RB0123                                                                          
RB0123     MOVE HV-BUYER-NO    TO H3-BUYER-NO.                                  
RB0123     MOVE HV-BUYER-NAME  TO H3-BUYER-NAME.                                
RB0123     MOVE HV-STORE-NO    TO H4-STORE-NO.                                  
RB0123     MOVE HV-STORE-NAME  TO H4-STORE-NAME.                                
RB0123     MOVE HV-INV-DATE    TO H4-INV-DATE.                                  
01052 *                                                                 INKRP106
01053 ******************************************************************INKRP106
01054 *  STANDARD DB2 ERROR ABEND ROUTINE                               INKRP106
01055 *  THIS ROUTINE FORCES AN ABEND DUE TO A DB2 PROBLEM.             INKRP106
01056 ******************************************************************INKRP106
01057  Z900-SQL-ABEND.                                                  INKRP106
01058                                                                   INKRP106
01059      MOVE +4013                 TO ABEND-CODE.                    INKRP106
01060      DISPLAY '**  ABEND     **'.                                  INKRP106
01061      DISPLAY '**  PROGRAM   **  =  INKRP106'.                     INKRP106
01062      DISPLAY '**  PARAGRAPH **  = ' PV-PARAGRAPH-NAME.            INKRP106
01063      DISPLAY '**  OPERATION **  = ' PV-DB2-OPER-ATTEMPTED.        INKRP106
01064                                                                   INKRP106
01065 *    THE FOLLOWING COPYBOOK UTILIZES THE DB2 ABEND MODULE         INKRP106
01066 *    DSNTIAR TO CONVERT SQLCA INTO UNDERSTANDABLE VERBAGE.        INKRP106
01067                                                                   INKRP106
01068      COPY DPPD004.                                                INKRP106
01069                                                                   INKRP106
01070      CALL 'ILBOABN0'  USING ABEND-CODE.                           INKRP106
P28545******************************************************************        
P28545*  PRICING MODULE.                                                        
P28545******************************************************************        
P28545     COPY INPD400.                                                        
P28545                                                                          
