       IDENTIFICATION DIVISION.                                         00080015
       PROGRAM-ID.    MLKRP707.                                         00090054
       INSTALLATION.  KOHLS DEPARTMENT STORES.                          00110015
       DATE-WRITTEN.  08/13/2002.                                       00120043
       DATE-COMPILED.                                                   00130015
      ******************************************************************00140015
      *  MERCHANDISE LEDGER SKU ATTRIBUTE CONVERSION PROGRAM            00150015
      *                                                                 00160015
      *  THIS PROGRAM CONVERTS DATASETS THAT FEED MLK140 AVEA INTO A    00170015
      *  SALES FILE CONTAINING SKU ATTRIBUTES FOR THE UPDATED COPYBOOK. 00180021
      *  CHANGE ID (BADSKU) ADDED FOR SKU NOT FOUND ON TSKXREF          00181022
      ******************************************************************00190015
       ENVIRONMENT DIVISION.                                            00210015
       CONFIGURATION SECTION.                                           00220015
       INPUT-OUTPUT SECTION.                                            00230015
       FILE-CONTROL.                                                    00240015
                                                                        00250015
                                                                        00260015
           SELECT REGISTER-SALES-FILE                                   00270015
               ASSIGN TO INP01.                                         00280015
                                                                        00290015
           SELECT PRICE-CHANGE-FILE                                     00300015
               ASSIGN TO INP02.                                         00310015
                                                                        00320015
           SELECT STORE-TRANSFER-FILE                                   00330015
               ASSIGN TO INP03.                                         00340015
                                                                        00350015
           SELECT REGISTER-SALES-FILE-OUT                               00360015
               ASSIGN TO OUT01.                                         00370015
                                                                        00380015
           SELECT PRICE-CHANGE-FILE-OUT                                 00390015
               ASSIGN TO OUT02.                                         00400015
                                                                        00410015
           SELECT STORE-TRANSFER-FILE-OUT                               00420015
               ASSIGN TO OUT03.                                         00430015
                                                                        00440015
           SELECT ERROR-REPORT                                          00450015
               ASSIGN TO RPT01.                                         00460015
                                                                        00470015
                                                                        00480015
       DATA DIVISION.                                                   00481016
       FILE SECTION.                                                    00490015
                                                                        00500015
                                                                        00510015
       FD  REGISTER-SALES-FILE                                          00520015
           RECORDING  MODE IS F.                                        00530015
       01  REGISTER-SALES-REC               PIC X(56).                  00540015
                                                                        00550015
       FD  PRICE-CHANGE-FILE                                            00560015
           RECORDING  MODE IS F.                                        00570015
       01  PRICE-CHANGE-REC                 PIC X(100).                 00580044
                                                                        00590015
       FD  STORE-TRANSFER-FILE                                          00600015
           RECORDING  MODE IS F.                                        00610015
       01  STORE-TRANSFER-REC               PIC X(80).                  00620015
                                                                        00630015
       FD  REGISTER-SALES-FILE-OUT                                      00640015
           RECORDING  MODE IS F                                         00650015
           BLOCK CONTAINS 0 RECORDS.                                    00660015
       01  REGISTER-SALES-FILE-OUT-REC      PIC X(65).                  00670015
                                                                        00680015
       FD  PRICE-CHANGE-FILE-OUT                                        00690015
           RECORDING  MODE IS F                                         00700015
           BLOCK CONTAINS 0 RECORDS.                                    00710015
       01  PRICE-CHANGE-FILE-OUT-REC        PIC X(100).                 00720015
                                                                        00730015
       FD  STORE-TRANSFER-FILE-OUT                                      00740015
           RECORDING  MODE IS F                                         00750015
           BLOCK CONTAINS 0 RECORDS.                                    00760015
       01  STORE-TRANSFER-FILE-OUT-REC      PIC X(80).                  00770015
                                                                        00780015
       FD  ERROR-REPORT                                                 00790015
           RECORDING  MODE IS F.                                        00800015
       01  ERROR-REC                        PIC X(132).                 00810018
                                                                        00820015
       EJECT                                                            00830015
       WORKING-STORAGE SECTION.                                         00840015
                                                                        00850015
      ***************************************************************** 00860015
      *  DATA ENTRY SALES - (N) VERSION IS OUTPUT NEWSKU FORMAT         00870015
      ***************************************************************** 00880015
      *    COPY PSWS010  (ORIGINAL INPUT FORMAT)                        00890055
           COPY PSWS010.                                                00900055
                                                                        00910015
      ***************************************************************** 00920015
      *  PRICE CHANGES  - MLRD012O IS FORMAT FEEDING SYSTEMS USE TO     00930019
      *                            CREATE PRICE CHANGE DATA             00940019
      *                 - MLRD017  IS INPUT/OUTPUT PRICE CHANGE LAYOUT  00941019
      ***************************************************************** 00950015
      *    COPY MLRD012O (ORIGINAL INPUT FORMAT)                        00960053
           COPY MLRD017.                                                00970053
                                                                        00980015
      ***************************************************************** 00990015
      *  TRANSFERS      - MLRD005O IS FORMAT FEEDING SYSTEMS USE TO     01000019
      *                            CREATE TRANSFER DATA                 01001019
      *                 - MLRD019  IS INPUT/OUTPUT PRICE CHANGE LAYOUT  01010019
      ***************************************************************** 01020015
      *    COPY MLRD005O (ORIGINAL INPUT FORMAT)                        01030053
           COPY MLRD019.                                                01040053
                                                                        01050015
      ******************************************************************01060015
      *  DB2 ERROR MESSAGES FORMAT AREA.                                01070015
      ******************************************************************01080015
           COPY DPWS004.                                                01090053
      *                                                                 01100015
       01  CPU-DATE.                                                    01110015
           05  CPU-YEAR                    PIC X(02)     VALUE SPACES.  01120015
           05  CPU-MONTH                   PIC X(02)     VALUE SPACES.  01130015
           05  CPU-DAY                     PIC X(02)     VALUE SPACES.  01140015
                                                                        01150015
       01  CPU-TIME.                                                    01160015
           05  CPU-HOUR                    PIC X(02)     VALUE SPACES.  01170015
           05  CPU-MINUTE                  PIC X(02)     VALUE SPACES.  01180015
           05  FILLER                      PIC X(02)     VALUE SPACES.  01190015
                                                                        01200015
       01  WS-EDIT-MAJOR-CLASS.                                         01201046
           05  WS-EDIT-BYTE1               PIC X(01).                   01202046
           05  WS-EDIT-BYTE2               PIC X(01).                   01210046
       01  WS-MAJOR-CLASS-NUM REDEFINES                                 01211046
           WS-EDIT-MAJOR-CLASS             PIC 9(02).                   01212046
                                                                        01213046
       01  PV-PROGRAM-VARIABLES.                                        01220000
                                                                        01230007
           05  PV-SALES-FORMAT-PSWS010N.                                01240055
               10  PV-SALES-RECORD.                                     01250007
                   15  FILLER              PIC 9(5).                    01260007
                   15  FILLER              PIC 9(04)        COMP-3.     01270007
                   15  FILLER              PIC 9(04)        COMP-3.     01280007
                   15  FILLER              PIC 9(04)        COMP-3.     01290007
                   15  FILLER              PIC 9(06)        COMP-3.     01300007
                   15  FILLER              PIC 9(06).                   01310007
                   15  FILLER              PIC 9(04)        COMP-3.     01320007
                   15  FILLER              PIC 9(02).                   01330007
                   15  PV-SALE-SKU.                                     01340007
                       20  FILLER          PIC 9(05).                   01350007
                       20  PV-SALE-SEQNO   PIC 9(03).                   01360007
                   15  FILLER              PIC X(01).                   01370007
                   15  FILLER              PIC S9(05)       COMP-3.     01380007
                   15  FILLER              PIC S9(05)V99    COMP-3.     01390007
                   15  FILLER              PIC 9(02).                   01400007
                   15  FILLER              PIC 9(01).                   01410007
                   15  FILLER              PIC 9(02).                   01420007
                   15  FILLER              PIC 9(01).                   01430007
                   15  PV-SLS-CORR-CDE     PIC X(01).                   01440007
                       88  PV-NORMAL-TRANS                VALUE ' '.    01450007
                       88  PV-SALES-AUDIT-CORR            VALUE 'S'.    01460007
                       88  PV-SYSTEM-LATE-CORR            VALUE 'L'.    01470007
                   15  FILLER              PIC S9(05)V99    COMP-3.     01480007
               10  PV-SALE-DEPT-CLASS  PIC  9(05).                      01490007
               10  PV-SALE-DEPT-CLASS-X REDEFINES PV-SALE-DEPT-CLASS.   01500007
                   15  PV-SALE-DEPT    PIC  9(03).                      01510007
                   15  PV-SALE-CLASS   PIC  9(02).                      01520007
               10  PV-SALE-MAJOR-CLASS PIC  9(04).                      01530007
                                                                        01540000
           05  PV-PCHG-FORMAT-MLRD017.                                  01560007
               10  PV-PCHG-RECORD.                                      01570007
                   15  FILLER                         PIC X(01).        01580007
                       88  PV-PCHG-MARKDOWN-REC             VALUE '4'.  01590007
                       88  PV-PCHG-MARKUP-REC               VALUE '5'.  01600007
                   15  PV-PCHG-TYPE-CODE          PIC X(01) VALUE SPACE.01610007
                       88  PV-PCHG-MARKDOWN                 VALUE '1'.  01620007
                       88  PV-PCHG-MARKDOWN-CANCELLATION    VALUE '2'.  01630007
                       88  PV-PCHG-MARKUP                   VALUE '3'.  01640007
                       88  PV-PCHG-MARKUP-CANCELLATION      VALUE '4'.  01650007
                   15  PV-PCHG-SLS-CORR-CDE       PIC X(01) VALUE SPACE.01660007
                       88  PV-PCHG-NORMAL-TRANS             VALUE ' '.  01670007
                       88  PV-PCHG-SALES-AUDIT-CORR         VALUE 'S'.  01680007
                       88  PV-PCHG-SYSTEM-LATE-CORR         VALUE 'L'.  01690007
                   15  FILLER                  PIC X(05)  VALUE SPACE.  01700007
                   15  FILLER                  PIC X(04)  VALUE ZERO.   01710007
                   15  FILLER                  PIC X(02)  VALUE ZERO.   01720007
                   15  PV-PCHG-SKU.                                     01730007
                       20  FILLER              PIC 9(05)  VALUE ZERO.   01740007
                       20  PV-PCHG-SKU-SEQ-NBR PIC 9(03)  VALUE ZERO.   01750007
                   15  FILLER                    PIC X(01)  VALUE SPACE.01760007
                   15  FILLER                    PIC 9(04)V9(02)        01770007
                                                            VALUE ZERO. 01780007
                   15  FILLER                    PIC 9(04)V9(02)        01790007
                                                            VALUE ZERO. 01800007
                   15  FILLER                    PIC 9(04)  VALUE ZERO. 01810007
                   15  FILLER                    PIC  X(01) VALUE SPACE.01820007
                   15  FILLER                    PIC  X(03) VALUE SPACE.01830007
                   15  FILLER                    PIC  X(03) VALUE SPACE.01840007
                   15  FILLER                    PIC  X(03) VALUE SPACE.01850007
                   15  FILLER                    PIC S9(04)V9(02)       01860007
                                                            VALUE ZERO. 01870007
                   15  FILLER                    PIC  9(05) VALUE ZERO. 01880007
                   15  FILLER                    PIC  X(03) VALUE ZERO. 01890007
                   15  FILLER                    PIC  X(01) VALUE SPACE.01900007
                   15  FILLER                    PIC  X(01) VALUE SPACE.01910007
                   15  FILLER                    PIC  9(07) VALUE ZERO. 01920007
                   15  FILLER                    PIC  X(01) VALUE SPACE.01930007
                   15  FILLER                    PIC  X(03) VALUE SPACE.01940007
                   15  FILLER                    PIC S9(04) COMP        01950007
                                                            VALUE ZERO. 01960007
                   15  FILLER                    PIC 9(02) VALUE ZEROS. 01970007
               10  PV-PCHG-SKU-DTA-ATTRIB.                              01980007
                   15  PV-PCHG-PC-DEPT-CLASS     PIC  X(05).            01990007
                   15  PV-PCHG-PC-DEPT-CLASS-NUM REDEFINES              02000007
                       PV-PCHG-PC-DEPT-CLASS.                           02010007
                       20  PV-PCHG-PC-DEPT-NBR   PIC  9(03).            02020007
                       20  PV-PCHG-PC-CLASS-NBR  PIC  9(02).            02030007
                   15  PV-PCHG-PC-MAJ-CLASS      PIC  9(04).            02040021
               10  FILLER                        PIC  X(11).            02050007
                                                                        02060000
                                                                        02070000
           05  PV-XFER-FORMAT-MLRD019.                                  02080007
                10  PV-XFER-STORE-TRANSFER-RECORD.                      02090007
                    15  FILLER                PIC  9(01) VALUE ZERO.    02100007
                    15  FILLER                  PIC  X(01) VALUE SPACE. 02110007
                    15  FILLER                  PIC  9(14) VALUE ZERO.  02120007
                    15  FILLER                  PIC  X(03) VALUE SPACE. 02130007
                    15  FILLER                  PIC  9(03) VALUE ZERO.  02140007
                    15  FILLER                  PIC S9(04)V99.          02150007
                    15  FILLER                  PIC  9(03) VALUE ZERO.  02160007
                    15  FILLER                  PIC  X(05) VALUE SPACE. 02170007
                    15  FILLER                  PIC  9(03) VALUE ZERO.  02180007
                    15  PV-XFER-SKU.                                    02190007
                        20  FILLER              PIC  9(05) VALUE ZERO.  02200007
                        20  PV-XFER-SEQ-NO                              02210010
                                                PIC  9(03) VALUE ZERO.  02220007
                    15  FILLER                  PIC  9(04) VALUE ZEROS. 02230007
                    15  FILLER                  PIC  9(06) VALUE ZEROS. 02240007
                10  PV-XFER-SKU-DTA-ATTRIB.                             02250007
                    15  PV-XFER-DEPT-CLASS.                             02260010
                        20  PV-XFER-DEPT-NBR    PIC  9(03) VALUE ZEROES.02261010
                        20  PV-XFER-CLASS-NBR   PIC  9(02) VALUE ZEROES.02270010
                    15  PV-XFER-MAJ-CLASS       PIC  9(02) VALUE ZEROES.02280010
                10  FILLER                      PIC  X(16) VALUE SPACE. 02290010
                                                                        02300000
********************************                                        02310000
                                                                        02320000
           05  PV-XREF-SQL-CALLS               PIC 9(9)      VALUE 0.   02330000
                                                                        02340000
           05  PV-LINE-COUNT                   PIC 9(2).                02350000
           05  PV-PAGE-COUNT                   PIC 9(5).                02360015
           05  PV-TOT-MKDOWN-IN                PIC S9(09)    COMP-3.    02370015
           05  PV-TOT-MKDOWN-OK                PIC S9(09)    COMP-3.    02380015
           05  PV-TOT-MKUP-IN                  PIC S9(09)    COMP-3.    02390015
           05  PV-TOT-MKUP-OK                  PIC S9(09)    COMP-3.    02400015
           05  PV-TOT-PRC-CHG-IN               PIC S9(09)    COMP-3.    02410015
           05  PV-TOT-PRC-CHG-OK               PIC S9(09)    COMP-3.    02420015
           05  PV-TOT-SALE-IN                  PIC S9(09)    COMP-3.    02430015
           05  PV-TOT-SALE-OK                  PIC S9(09)    COMP-3.    02440015
           05  PV-TOT-TRANSFER-IN              PIC S9(09)    COMP-3.    02450015
           05  PV-TOT-TRANSFER-OK              PIC S9(09)    COMP-3.    02460015
                                                                        02460119
           05  PV-SKXREF-RENUM-STATUS          PIC 9(9) VALUE ZEROES.   02461019
                                                                        02470015
           05  PV-ISO-DTE                      PIC X(10).               02480015
                                                                        02490015
           05  PV-PROCESS-DATE                 PIC X(10).               02500015
           05  PV-PROCESS-DATEX REDEFINES      PV-PROCESS-DATE.         02510015
               10  PV-PROC-CC                  PIC 9(02).               02520015
               10  PV-PROC-YY                  PIC 9(02).               02530015
               10  FILLER                      PIC X(01).               02540015
               10  PV-PROC-MM                  PIC 9(02).               02550015
               10  FILLER                      PIC X(01).               02560015
               10  PV-PROC-DD                  PIC 9(02).               02570015
                                                                        02580015
           05  PV-PARAGRAPH-NAME               PIC X(30).               02590015
           05  PV-RTL-AMT                      PIC S9(09)V99 COMP-3.    02600007
           05  PV-OPERATION-ATTEMPTED          PIC  X(30) VALUE SPACES. 02610015
      *    NEW SKU                                                      02620015
           05  PV-HOLD-SKU                   PIC S9(08)  VALUE ZEROES.  02630015
           05  PV-HOLD-SKU-XREF              PIC S9(08)V COMP-3.        02640015
           05  PV-NEW-SKU-MCL.                                          02650015
               10  FILLER                    PIC 9(02)   VALUE ZEROS.   02660015
               10  PV-NEW-SKU-MAJ-CLASS      PIC 9(01).                 02670015
               10  FILLER                    PIC 9(01)   VALUE ZEROS.   02680015
           05  PV-SAVE-DEPT-CLASS-ATTR.                                 02690015
               10  PV-SAVE-DEPT-CLASS.                                  02700015
                   15  PV-SAVE-DEPT          PIC  9(03)  VALUE ZEROS.   02710015
                   15  PV-SAVE-SCL           PIC  9(02)  VALUE ZEROS.   02720015
               10  PV-SAVE-MAJ-CL            PIC  9(04)  VALUE ZEROS.   02730015
                                                                        02740015
           05  PV-KOHLS-UPC-LOW.                                        02740141
               10  FILLER                    PIC 9(04)  VALUE 0400.     02740235
               10  PV-KOHLS-SKU-MIN          PIC 9(08)  VALUE ZEROS.    02740435
               10  FILLER                    PIC 9(01)  VALUE 0.        02740535
                                                                        02741022
           05  PV-KOHLS-UPC-HIGH.                                       02741141
               10  FILLER                    PIC 9(04)  VALUE 0400.     02741235
               10  PV-KOHLS-SKU-MAX          PIC 9(08)  VALUE ZEROS.    02741435
               10  FILLER                    PIC 9(01)  VALUE 9.        02741535
                                                                        02743023
           05  PV-KOHLS-SIGN-UPC.                                       02743141
               10  PV-KOHLS-UPC-MIN-SIGNONLY     PIC S9(13).            02743237
               10  PV-KOHLS-UPC-MAX-SIGNONLY     PIC S9(13).            02743337
                                                                        02743437
           05  PV-KOHLS-SIGN-UPC.                                       02743541
               10  PV-KOHLS-UPC-MIN-SIGNV     PIC S9(13)V.              02743637
               10  PV-KOHLS-UPC-MAX-SIGNV     PIC S9(13)V.              02743737
                                                                        02743837
           05  PV-KOHLS-MDSEAR-UPC.                                     02744041
               10  PV-KOHLS-UPC-MIN          PIC S9(13)V COMP-3.        02745036
               10  PV-KOHLS-UPC-MAX          PIC S9(13)V COMP-3.        02746036
                                                                        02747035
       01  PS-SWITCHES.                                                 02750015
           05  PS-ERROR-SW                   PIC X       VALUE 'N'.     02760015
               88  PS-NO-ERROR                           VALUE 'N'.     02770015
               88  PS-ERROR                              VALUE 'Y'.     02780015
           05  REGISTER-SALES-FILE-SW        PIC X       VALUE 'N'.     02790015
               88  END-OF-REGISTER-SALES-FILE            VALUE 'Y'.     02800015
           05  PRICE-CHANGE-FILE-SW          PIC X       VALUE 'N'.     02810015
               88  END-OF-PRICE-CHANGE-FILE              VALUE 'Y'.     02820015
           05  STORE-TRANSFER-FILE-SW        PIC X       VALUE 'N'.     02870015
               88  END-OF-STORE-TRANSFER-FILE            VALUE 'Y'.     02880015
                                                                        02890015
       01  PC-PROGRAM-CONSTANTS.                                        02900015
           05  PC-PROGRAM-NAME             PIC  X(8)   VALUE 'MLKUT007'.02910049
           05  PC-MORE-THAN-MAX-RETRY          PIC S9(4)   VALUE +4.    02920015
           05  PC-END-OF-REPORT                PIC  X(133) VALUE        02930015
               '-*** END OF REPORT ***'.                                02940015
           05  PC-TYP-CDE-TRANSFER             PIC  X      VALUE '2'.   02950015
           05  PC-DPKUT500                     PIC  X(08)  VALUE        02960015
               'DPKUT500'.                                              02970015
           05  PC-SALES-CORR-TYPE              PIC  X(01)  VALUE 'O'.   02980015
           05  PC-D09910-PC-ATTR          PIC  X(09)  VALUE '099100010'.02990015
                                                                        03000015
       01  PV-PROGRAM-VARIBLES.                                         03010015
                                                                        03230015
           05  PV-TRANSACTION-TYPE.                                     03240015
               10  PV-TRAN-TYPE                PIC X(2).                03250015
               10  PV-TRAN-TYPE-DESC           PIC X(20).               03260015
           05  FILLER REDEFINES PV-TRANSACTION-TYPE                     03270015
                                               PIC X(22).               03280015
               88  PV-SALE                     VALUE                    03310015
                  '20SALE                '.                             03320015
               88  PV-STORE-TRANSFER           VALUE                    03330015
                  '30STORE TRANSFER      '.                             03340015
               88  PV-MKDOWN                   VALUE                    03350015
                  '40MARKDOWN            '.                             03360015
               88  PV-MKUP                     VALUE                    03370015
                  '50MARKUP              '.                             03380015
                                                                        03390015
           05  PV-JRNL-IND                     PIC X(01).               03410015
               88  PV-JRNL-YES                 VALUE  'Y'.              03420015
               88  PV-JRNL-NO                  VALUE  'N'.              03430015
                                                                        03440015
       01  DISPLAYED-HEADINGS.                                          03450015
           05  DH-TITLE                        PIC X(80).               03460015
               88  DH-COUNT-BY-SOURCE          VALUE                    03470015
                  'MLKRP707 - COUNTS BY SOURCE SYSTEM:'.                03480054
               88  DH-COUNT-BY-TRAN-TYPE       VALUE                    03490015
                  'MLKRP707 - COUNTS BY TRANSACTION-TYPE:'.             03500054
                                                                        03510015
           05  DH-HEADING.                                              03520015
               10  FILLER                      PIC X(30) VALUE SPACES.  03530015
               10  FILLER                      PIC X(11) VALUE          03540015
                  'INPUT'.                                              03550015
               10  FILLER                      PIC X(06) VALUE          03560015
                  'ERROR'.                                              03570015
               10  FILLER                      PIC X(13) VALUE          03580015
                  'SKIP CLASS'.                                         03590015
               10  FILLER                      PIC X(11) VALUE          03600015
                  'ACCEPTED'.                                           03610015
                                                                        03620015
           05  DL-DETAIL.                                               03630015
               10  FILLER                      PIC X(04).               03640015
               10  DL-DESC                     PIC X(20).               03650015
      *        10  DL-DESC                     PIC X(27).               03660015
                   88  DT1                     VALUE                    03670015
                  'PRICE CHANGE MRKDOWN'.                               03680021
                   88  DT2                     VALUE                    03710021
                  'PRICE CHANGE MARKUPS'.                               03720021
                   88  DT10                    VALUE                    03790015
                  'REGISTER SALES      '.                               03800015
                   88  DT11                    VALUE                    03830021
                  'STORE TRANSFERS     '.                               03840021
                   88  DT20                    VALUE                    03850015
                  'MARKDOWNS           '.                               03860015
                   88  DT21                    VALUE                    03870015
                  'MARKUPS             '.                               03880015
                   88  DT22                    VALUE                    03890015
                  'SALES               '.                               03900015
                   88  DT24                    VALUE                    03910015
                  'TRANSFERS           '.                               03920015
               10  FILLER                      PIC X(01).               03930015
               10  DL-INPUT                    PIC ZZ,ZZZ,ZZ9.          03940015
               10  FILLER                      PIC X(01)   VALUE SPACES.03950015
               10  DL-ERROR                    PIC ZZ,ZZZ,ZZZ.          03960015
               10  FILLER                      PIC X(01)   VALUE SPACES.03970015
               10  DL-SKIP-CLASS               PIC ZZ,ZZZ,ZZZ.          03980015
               10  FILLER                      PIC X(01)   VALUE SPACES.03990015
               10  DL-ACCEPTED                 PIC ZZ,ZZZ,ZZ9.          04000015
               10  FILLER                      PIC X(01)   VALUE SPACES.04010015
                                                                        04020015
      ***************************************************************** 04030015
      *  WORK AREA PASSED IN CALL TO DPKUT500                          *04040015
      ***************************************************************** 04050015
           COPY DPWS500.                                                04060053
                                                                        04070015
      ***************************************************************** 04080015
      *  STANDARD 133 BYTE REPORT HEADINGS                             *04090015
      ***************************************************************** 04100015
           COPY DPWS133O.                                               04110053
       01  HEADER2.                                                     04120015
           05  FILLER                  PIC X(47)   VALUE SPACES.        04130015
           05  FILLER                  PIC X(40)   VALUE                04140015
               'INVENTORY TRANSACTION LOAD ERRORS'.                     04150015
           05  FILLER                  PIC X(46)   VALUE SPACES.        04160015
                                                                        04170015
       01  HEADER3.                                                     04180015
           05  FILLER                  PIC X(01)   VALUE '0'.           04190015
           05  FILLER                  PIC X(04)   VALUE 'CODE'.        04200015
           05  FILLER                  PIC X(06)   VALUE SPACES.        04210015
           05  FILLER                  PIC X(21)   VALUE 'SOURCE'.      04220015
           05  FILLER                  PIC X(26)   VALUE 'REASON'.      04230015
           05  FILLER                  PIC X(80)   VALUE 'RECORD DATA'. 04240015
                                                                        04250015
       01  ERROR-LINE.                                                  04260015
           05  FILLER                  PIC X(02)   VALUE '0'.           04270015
           05  EL-CODE                 PIC X(01).                       04280015
           05  FILLER                  PIC X(05)   VALUE SPACES.        04290015
           05  EL-SOURCE               PIC X(17).                       04300015
           05  FILLER                  PIC X(01)   VALUE SPACES.        04310015
           05  EL-REASON               PIC X(25).                       04320015
           05  FILLER                  PIC X(01)   VALUE SPACES.        04330015
           05  EL-DATA                 PIC X(80).                       04340015
                                                                        04350015
       01  ABEND-CODE                          PIC S9(04)  VALUE +0     04360015
                                                           COMP SYNC.   04370015
           EXEC SQL                                                     04380015
               INCLUDE SQLCA                                            04390015
           END-EXEC.                                                    04400015
                                                                        04410015
           EXEC SQL                                                     04420015
               INCLUDE TSKXREF                                          04430015
           END-EXEC.                                                    04440015
                                                                        04450015
           EXEC SQL                                                     04451025
               INCLUDE TUPC                                             04452025
           END-EXEC.                                                    04453025
                                                                        04454025
           EXEC SQL                                                     04455025
               INCLUDE TMDSEAR                                          04456025
           END-EXEC.                                                    04457025
                                                                        04458025
       EJECT                                                            04460015
       PROCEDURE DIVISION.                                              04470015
                                                                        04480015
       1000-MAIN-MODULE.                                                04490019
      ******************************************************************04500015
      *  MAIN PROCESSING.                                               04510015
      ******************************************************************04520015
                                                                        04530015
           PERFORM 1100-HOUSEKEEPING.                                   04540019
                                                                        04550015
           PERFORM 2000-PROCESS-INPUT-FILES.                            04560019
                                                                        04570015
           PERFORM 3000-EOJ.                                            04580019
                                                                        04590015
           DISPLAY 'NBR OF SQL CALLS TO TSKXREF : ', PV-XREF-SQL-CALLS. 04600015
           DISPLAY 'XREF SKUS IN RENUM STATUS : ',                      04601019
                                                 PV-SKXREF-RENUM-STATUS.04610019
                                                                        04620015
           STOP RUN.                                                    04630015
      *                                                                 04640015
       1100-HOUSEKEEPING.                                               04650019
      ******************************************************************04660015
      *                                                                 04670019
      ******************************************************************04671019
                                                                        04680015
           OPEN OUTPUT REGISTER-SALES-FILE-OUT                          04690015
                       PRICE-CHANGE-FILE-OUT                            04700015
                       STORE-TRANSFER-FILE-OUT                          04730015
                       ERROR-REPORT.                                    04740015
                                                                        04750015
           INITIALIZE PV-PROGRAM-VARIABLES.                             04760015
                                                                        04770015
           MOVE 'N'   TO   REGISTER-SALES-FILE-SW                       04780015
                           PRICE-CHANGE-FILE-SW                         04790015
                           STORE-TRANSFER-FILE-SW                       04820015
                                                                        04830015
           ACCEPT CPU-DATE FROM DATE.                                   04840015
           MOVE CPU-YEAR   TO DP133O-RUN-YEAR                           04850015
           MOVE CPU-MONTH  TO DP133O-RUN-MONTH                          04860015
           MOVE CPU-DAY    TO DP133O-RUN-DAY                            04870015
                                                                        04880015
           ACCEPT CPU-TIME FROM TIME.                                   04890015
           MOVE CPU-HOUR   TO DP133O-RUN-HOUR.                          04900015
           MOVE CPU-MINUTE TO DP133O-RUN-MINUTE.                        04910015
           MOVE 'MLKRP707' TO DP133O-PROGRAM-NAME.                      04920054
                                                                        04930015
           PERFORM 5000-WRITE-HEADINGS.                                 04940019
                                                                        04950015
           EJECT.                                                       04960015
                                                                        04970015
      ******************************************************************04970119
      *                                                                 04970219
      ******************************************************************04970319
       1200-DISPLAY-COUNTS-BY-SOURCE.                                   04971019
                                                                        04972019
           MOVE ALL '*' TO DH-TITLE                                     04973019
           DISPLAY DH-TITLE                                             04974019
           SET DH-COUNT-BY-SOURCE            TO TRUE                    04975019
           DISPLAY DH-TITLE                                             04976019
           DISPLAY ' '                                                  04977019
           DISPLAY ' '                                                  04978019
           DISPLAY DH-HEADING                                           04979019
           DISPLAY ' '                                                  04979119
                                                                        04979219
           INITIALIZE DL-DETAIL                                         04979319
           MOVE   PV-TOT-MKDOWN-IN           TO DL-INPUT                04979419
           MOVE   PV-TOT-MKDOWN-OK           TO DL-ACCEPTED             04979519
                                                                        04979619
           SET DT1 TO TRUE                                              04979719
           DISPLAY DL-DETAIL                                            04979819
                                                                        04979919
           INITIALIZE DL-DETAIL                                         04980019
           MOVE   PV-TOT-MKUP-IN             TO DL-INPUT                04980119
           MOVE   PV-TOT-MKUP-OK             TO DL-ACCEPTED             04980219
                                                                        04980319
           SET DT2 TO TRUE                                              04980421
           DISPLAY DL-DETAIL                                            04980519
                                                                        04980619
           INITIALIZE DL-DETAIL                                         04980719
           MOVE   PV-TOT-SALE-IN               TO DL-INPUT              04980819
           MOVE   PV-TOT-SALE-OK               TO DL-ACCEPTED           04980919
                                                                        04981019
           SET DT10 TO TRUE                                             04981119
           DISPLAY DL-DETAIL                                            04981219
                                                                        04981319
           MOVE   PV-TOT-TRANSFER-IN         TO DL-INPUT                04981419
           MOVE   PV-TOT-TRANSFER-OK         TO DL-ACCEPTED             04981519
                                                                        04981619
           SET DT11 TO TRUE                                             04981721
           DISPLAY DL-DETAIL                                            04981819
           INITIALIZE DL-DETAIL.                                        04981919
                                                                        04982019
      ******************************************************************04982119
      *                                                                 04982219
      ******************************************************************04982319
       1300-DISPLAY-COUNTS-BY-TRAN-TP.                                  04982419
                                                                        04982519
           DISPLAY ' '                                                  04982619
           MOVE ALL '*' TO DH-TITLE                                     04982719
           DISPLAY DH-TITLE                                             04982819
           SET DH-COUNT-BY-TRAN-TYPE         TO TRUE                    04982919
           DISPLAY DH-TITLE                                             04983019
           DISPLAY ' '                                                  04983119
           DISPLAY ' '                                                  04983219
           DISPLAY DH-HEADING                                           04983319
           DISPLAY ' '                                                  04983419
                                                                        04983519
           INITIALIZE DL-DETAIL                                         04983619
           MOVE   PV-TOT-MKDOWN-IN           TO DL-INPUT                04983719
           MOVE   PV-TOT-MKDOWN-OK           TO DL-ACCEPTED             04983819
                                                                        04983919
           SET DT20 TO TRUE                                             04984019
           DISPLAY DL-DETAIL                                            04984119
           INITIALIZE DL-DETAIL                                         04984219
                                                                        04984319
           MOVE   PV-TOT-MKUP-IN             TO DL-INPUT                04984419
           MOVE   PV-TOT-MKUP-OK             TO DL-ACCEPTED             04984519
                                                                        04984619
           SET DT21 TO TRUE                                             04984719
           DISPLAY DL-DETAIL                                            04984819
           INITIALIZE DL-DETAIL                                         04984919
                                                                        04985019
           MOVE   PV-TOT-SALE-IN             TO DL-INPUT                04985119
           MOVE   PV-TOT-SALE-OK             TO DL-ACCEPTED             04985219
                                                                        04985319
           SET DT22 TO TRUE                                             04985419
           DISPLAY DL-DETAIL                                            04985519
           INITIALIZE DL-DETAIL                                         04985619
                                                                        04985719
           MOVE   PV-TOT-TRANSFER-IN         TO DL-INPUT                04985819
           MOVE   PV-TOT-TRANSFER-OK         TO DL-ACCEPTED             04985919
                                                                        04986019
           SET DT24 TO TRUE                                             04986119
           DISPLAY DL-DETAIL                                            04986219
           INITIALIZE DL-DETAIL                                         04986319
                                                                        04986419
           DISPLAY ' '                                                  04986519
           MOVE ALL '*' TO DH-TITLE                                     04986619
           DISPLAY DH-TITLE.                                            04986719
                                                                        04986819
      ******************************************************************04986919
      *                                                                 04987019
      ******************************************************************04988019
                                                                        05990015
       2000-PROCESS-INPUT-FILES.                                        06000019
                                                                        06010015
           DISPLAY 'OPEN REGISTER-SALES-FILE'                           06011015
           OPEN  INPUT REGISTER-SALES-FILE                              06020015
           PERFORM 7100-READ-REGISTER-SALES                             06030019
           PERFORM 2100-PROCESS-REGISTER-SALES                          06040019
               UNTIL END-OF-REGISTER-SALES-FILE                         06050015
           CLOSE REGISTER-SALES-FILE                                    06060015
           DISPLAY 'CLOSE REGISTER-SALES-FILE'                          06070015
           DISPLAY '*****'                                              06071015
                                                                        06072015
           DISPLAY '                        '                           06073015
           DISPLAY 'OPEN PRICE-CHANGE-FILE'                             06081015
           OPEN INPUT  PRICE-CHANGE-FILE                                06090015
           PERFORM 7200-READ-PRICE-CHANGE                               06100019
           PERFORM 2200-PROCESS-PRICE-CHANGE                            06110019
               UNTIL END-OF-PRICE-CHANGE-FILE                           06120015
           CLOSE PRICE-CHANGE-FILE                                      06130015
           DISPLAY 'CLOSE PRICE-CHANGE-FILE'                            06140015
           DISPLAY '*****'                                              06141015
                                                                        06150015
           DISPLAY '                        '                           06300115
           DISPLAY 'OPEN STORE-TRANSFER-FILE'                           06301015
           OPEN INPUT  STORE-TRANSFER-FILE                              06310015
           PERFORM 7300-READ-STORE-TRANSFER                             06320019
           PERFORM 2300-PROCESS-STORE-TRANSFER                          06330019
               UNTIL END-OF-STORE-TRANSFER-FILE                         06340015
           CLOSE STORE-TRANSFER-FILE.                                   06350015
           DISPLAY 'CLOSE STORE-TRANSFER-FILE'.                         06360015
                                                                        06370015
           EJECT                                                        06390015
                                                                        06391019
      ******************************************************************06392019
      *                                                                 06393019
      ******************************************************************06394019
       2100-PROCESS-REGISTER-SALES.                                     06400019
                                                                        06410015
           SET PV-SALE   TO TRUE.                                       06430015
                                                                        06440015
           ADD 1 TO  PV-TOT-SALE-IN.                                    06480015
                                                                        06500015
           IF  PV-SALE-SEQNO = ZEROES                                   06510015
                   MOVE PV-SALE-SKU(1:5)   TO PV-SALE-DEPT-CLASS        06520015
                                              PV-SAVE-DEPT-CLASS        06530015
                   MOVE PV-SALE-CLASS(1:1) TO PV-NEW-SKU-MAJ-CLASS      06540015
                   MOVE PV-NEW-SKU-MCL     TO PV-SALE-MAJOR-CLASS       06550015
                                              PV-SAVE-MAJ-CL            06560015
           ELSE                                                         06570015
               IF  PV-HOLD-SKU = PV-SALE-SKU                            06580015
                   MOVE PV-SAVE-DEPT-CLASS TO PV-SALE-DEPT-CLASS        06590015
                   MOVE PV-SAVE-MAJ-CL     TO PV-SALE-MAJOR-CLASS       06600015
               ELSE                                                     06610015
                   MOVE PV-SALE-SKU     TO PV-HOLD-SKU                  06620015
                   MOVE PV-HOLD-SKU     TO PV-HOLD-SKU-XREF             06630015
                   PERFORM 4000-RETRIEVE-SKU-ATTRIBUTES                 06640019
                   MOVE SKXREF-DEPT     TO PV-SALE-DEPT                 06650015
                                           PV-SAVE-DEPT                 06660015
                   MOVE SKXREF-SUBCLASS TO PV-SALE-CLASS                06670015
                                           PV-SAVE-SCL                  06680015
                   MOVE SKXREF-CLASS    TO PV-SALE-MAJOR-CLASS          06690015
                                           PV-SAVE-MAJ-CL               06700015
               END-IF                                                   06710015
           END-IF.                                                      06720015
                                                                        06730015
           PERFORM 3100-FMT-SALES-REC.                                  06740019
                                                                        06750015
           ADD 1 TO PV-TOT-SALE-OK.                                     06790015
                                                                        06810015
           PERFORM 7100-READ-REGISTER-SALES.                            06820019
                                                                        06830015
      ******************************************************************06830119
      *                                                                 06830219
      ******************************************************************06830319
                                                                        06830419
       2200-PROCESS-PRICE-CHANGE.                                       06830519
                                                                        06830619
                                                                        06830719
           ADD 1     TO  PV-TOT-PRC-CHG-IN                              06830819
                                                                        06830919
           IF PV-PCHG-MARKDOWN-REC                                      06831019
               SET PV-MKDOWN            TO TRUE                         06831119
               ADD 1 TO PV-TOT-MKDOWN-IN                                06831219
           ELSE                                                         06831319
               IF PV-PCHG-MARKUP-REC                                    06831419
                   SET PV-MKUP          TO TRUE                         06831519
                   ADD 1 TO PV-TOT-MKUP-IN                              06831619
               END-IF                                                   06831719
           END-IF                                                       06831819
                                                                        06831919
           IF  PV-PCHG-SKU-SEQ-NBR = ZEROES                             06832019
               MOVE PV-PCHG-SKU(1:5)          TO PV-PCHG-PC-DEPT-CLASS  06832121
                                                 PV-SAVE-DEPT-CLASS     06832221
               MOVE PV-PCHG-PC-CLASS-NBR(1:1) TO PV-NEW-SKU-MAJ-CLASS   06832321
               MOVE PV-NEW-SKU-MCL            TO PV-PCHG-PC-MAJ-CLASS   06832421
           ELSE                                                         06832519
      *    099-10 TRANSACTIONS WITH NON-000 SEQ (NOT FOUND - TSKXREF)   06832619
      *    MOVE 099-10 TO NEW SKU ATTRIBUTES                            06832719
               IF PV-PCHG-SKU(1:5) = '09910'                            06832819
                   MOVE PC-D09910-PC-ATTR    TO ML017-PC-SKU-DTA-ATTRIB 06832919
               ELSE                                                     06833019
                    IF  PV-HOLD-SKU = PV-PCHG-SKU                       06833119
                       MOVE PV-SAVE-DEPT-CLASS-ATTR                     06833219
                                        TO ML017-PC-SKU-DTA-ATTRIB      06833319
                                                                        06833421
                   ELSE                                                 06833719
                       MOVE PV-PCHG-SKU  TO PV-HOLD-SKU                 06833819
                       MOVE PV-HOLD-SKU     TO PV-HOLD-SKU-XREF         06833919
                       PERFORM 4000-RETRIEVE-SKU-ATTRIBUTES             06834019
                       MOVE SKXREF-DEPT     TO PV-PCHG-PC-DEPT-NBR      06834119
                                               PV-SAVE-DEPT             06834219
                       MOVE SKXREF-SUBCLASS TO PV-PCHG-PC-CLASS-NBR     06834319
                                               PV-SAVE-SCL              06834419
                       MOVE SKXREF-CLASS    TO PV-PCHG-PC-MAJ-CLASS     06834519
                                               PV-SAVE-MAJ-CL           06834619
                   END-IF                                               06834719
               END-IF                                                   06834819
           END-IF.                                                      06834919
                                                                        06835019
           ADD 1 TO PV-TOT-PRC-CHG-OK                                   06835119
                                                                        06835219
           IF  PV-PCHG-MARKDOWN-REC                                     06835319
               ADD 1 TO PV-TOT-MKDOWN-OK                                06835419
           ELSE                                                         06835519
               ADD 1 TO PV-TOT-MKUP-OK                                  06835619
           END-IF.                                                      06835719
                                                                        06835819
           PERFORM 3200-FMT-PRICE-CHANGE-REC                            06835919
                                                                        06836019
           PERFORM 7200-READ-PRICE-CHANGE.                              06836119
                                                                        06836219
      ******************************************************************06836319
      *                                                                 06836419
      ******************************************************************06836519
                                                                        06836619
       2300-PROCESS-STORE-TRANSFER.                                     06836719
                                                                        06836819
           SET PV-STORE-TRANSFER TO TRUE                                06836919
                                                                        06837019
           ADD 1     TO  PV-TOT-TRANSFER-IN                             06837119
                                                                        06837219
           IF  PV-XFER-SEQ-NO = ZEROES                                  06837319
               MOVE PV-XFER-SKU(1:5) TO PV-XFER-DEPT-CLASS              06837419
           ELSE                                                         06837519
               MOVE PV-XFER-SKU     TO PV-HOLD-SKU                      06837619
               MOVE PV-HOLD-SKU     TO PV-HOLD-SKU-XREF                 06837719
               PERFORM 4000-RETRIEVE-SKU-ATTRIBUTES                     06837819
               MOVE SKXREF-DEPT     TO PV-XFER-DEPT-NBR                 06837919
               MOVE SKXREF-SUBCLASS TO PV-XFER-CLASS-NBR                06838019
           END-IF.                                                      06838119
                                                                        06838219
           PERFORM 3300-FMT-TRANSFER-REC                                06838319
                                                                        06838419
           ADD 1 TO PV-TOT-TRANSFER-OK                                  06838519
                                                                        06838619
           PERFORM 7300-READ-STORE-TRANSFER.                            06838719
                                                                        06838819
                                                                        06838919
      ******************************************************************06839019
      *    CLOSE THE FILES AND DISPLAY COUNTS                           06839119
      ******************************************************************06839219
       3000-EOJ.                                                        06839319
                                                                        06839419
           MOVE PC-END-OF-REPORT TO ERROR-LINE                          06839519
           PERFORM 5100-WRITE-ERROR-REPORT.                             06839619
           CLOSE REGISTER-SALES-FILE-OUT                                06839719
                 PRICE-CHANGE-FILE-OUT                                  06839819
                 STORE-TRANSFER-FILE-OUT                                06839919
                 ERROR-REPORT.                                          06840019
           PERFORM 1200-DISPLAY-COUNTS-BY-SOURCE.                       06840119
           PERFORM 1300-DISPLAY-COUNTS-BY-TRAN-TP.                      06840219
                                                                        06840319
      ******************************************************************06840419
      *                                                                 06840519
      ******************************************************************06840619
                                                                        06841015
       3100-FMT-SALES-REC.                                              06850019
                                                                        06860015
           INITIALIZE D040-RECORD.                                      06870015
                                                                        06880015
           WRITE REGISTER-SALES-FILE-OUT-REC                            06890015
                                   FROM PV-SALES-FORMAT-PSWS010N.       06891055
                                                                        06900015
      ******************************************************************06910019
      *                                                                 06920019
      ******************************************************************06930019
                                                                        07530415
       3200-FMT-PRICE-CHANGE-REC.                                       07531019
                                                                        07532015
           INITIALIZE ML017-PRICE-CHANGE-RECORD.                        07533015
                                                                        07534015
           WRITE PRICE-CHANGE-FILE-OUT-REC                              07535015
                                     FROM PV-PCHG-FORMAT-MLRD017.       07536010
                                                                        07537015
      ******************************************************************07538019
      *                                                                 07539019
      ******************************************************************07540019
                                                                        07841015
       3300-FMT-TRANSFER-REC.                                           07842019
                                                                        07843015
           INITIALIZE ML019-TRANSFER-RECORD.                            07844015
                                                                        07845015
           WRITE STORE-TRANSFER-FILE-OUT-REC                            07846015
                                     FROM PV-XFER-FORMAT-MLRD019.       07847010
                                                                        07848015
      ******************************************************************07910015
      * IF SKU ATTRIBUTES (DEPT/SCL) ARE NOT ON INPUT FILE, USE 8-BYTE  07920015
      * SKU NUMBER TO RETRIEVE ATTRIBUTES (DEPT / SUBCLASS) FROM TSKXREF07930015
      ******************************************************************07940015
       4000-RETRIEVE-SKU-ATTRIBUTES.                                    07950019
                                                                        07960015
            ADD 1 TO PV-XREF-SQL-CALLS.                                 07980015
                                                                        07990015
            EXEC SQL                                                    08020015
                SELECT DEPT                                             08030015
                      ,CLASS                                            08040015
                      ,SUBCLASS                                         08050015
                      ,SKU_STAT_CDE                                     08051019
                 INTO  :SKXREF-DEPT                                     08060015
                      ,:SKXREF-CLASS                                    08070015
                      ,:SKXREF-SUBCLASS                                 08080015
                      ,:SKXREF-SKU-STAT-CDE                             08081019
                 FROM  TSKXREF                                          08090015
                WHERE  SKU = :PV-HOLD-SKU-XREF                          08100015
            END-EXEC.                                                   08110015
      *                                                                 08120015
           EVALUATE SQLCODE                                             08130015
               WHEN 0                                                   08140015
                  IF SKXREF-SKU-STAT-CDE = '98'                         08150041
                      ADD 1 TO PV-SKXREF-RENUM-STATUS                   08151019
                  END-IF                                                08152019
               WHEN +100                                                08160015
                  DISPLAY ' SKU ', PV-HOLD-SKU-XREF, ' XREF NOT FOUND'  08170024
                  PERFORM 4100-GET-DKEY-FROM-TUPC                       08171041
               WHEN OTHER                                               08210015
                  MOVE '4000-RETRIEVE-SKU-ATTRIBUTES'                   08220019
                                 TO PV-PARAGRAPH-NAME                   08230015
                  MOVE 'ERROR ON SELECT FROM TSKXREF'                   08240015
                                 TO PV-OPERATION-ATTEMPTED              08250015
                  PERFORM 9999-SQL-ABEND                                08260015
           END-EVALUATE.                                                08270015
                                                                        08280015
                                                                        08290015
      ******************************************************************08290122
      * PERFORMED WHEN A SKU IS NOT FOUND ON TSKXREF                    08290222
      ******************************************************************08290322
       4100-GET-DKEY-FROM-TUPC.                                         08291041
                                                                        08292022
           MOVE PV-HOLD-SKU-XREF  TO  PV-KOHLS-SKU-MIN                  08292127
                                      PV-KOHLS-SKU-MAX.                 08292227
                                                                        08293022
                                                                        08293138
           MOVE PV-KOHLS-UPC-LOW  TO  PV-KOHLS-UPC-MIN-SIGNONLY         08293240
                                      PV-KOHLS-UPC-MIN-SIGNV            08293437
                                                                        08293538
           MOVE PV-KOHLS-UPC-HIGH TO  PV-KOHLS-UPC-MAX-SIGNONLY         08293640
                                      PV-KOHLS-UPC-MAX-SIGNV            08293837
                                                                        08293937
           MOVE PV-KOHLS-UPC-MIN-SIGNONLY TO PV-KOHLS-UPC-MIN.          08294640
                                                                        08294739
           MOVE PV-KOHLS-UPC-MAX-SIGNONLY TO PV-KOHLS-UPC-MAX.          08294840
                                                                        08294939
            EXEC SQL                                                    08295039
                SELECT SUB_CL_MDSEAR_ID                                 08295139
                 INTO  :UPC-SUB-CL-MDSEAR-ID                            08295239
                 FROM  TUPC                                             08295339
                WHERE  (UPC_NBR >= :PV-KOHLS-UPC-MIN                    08295439
                  AND   UPC_NBR <= :PV-KOHLS-UPC-MAX)                   08295539
            END-EXEC.                                                   08295639
      *                                                                 08295739
           EVALUATE SQLCODE                                             08295839
               WHEN 0                                                   08295939
                  PERFORM 4200-GET-ATTR-FROM-TMDSEAR                    08296039
               WHEN +100                                                08296139
                  DISPLAY ' UPC ', PV-KOHLS-UPC-MIN, ' NOT FOUND-TUPC'  08296239
RWJ               MOVE PV-PCHG-SKU(1:3) TO SKXREF-DEPT                  08296345
 |                MOVE SPACES           TO WS-EDIT-MAJOR-CLASS          08296446
 |                MOVE PV-PCHG-SKU(4:1) TO WS-EDIT-BYTE1                08296948
 |                MOVE '0'              TO WS-EDIT-BYTE2                08297046
 |                MOVE WS-MAJOR-CLASS-NUM TO SKXREF-CLASS               08297146
 |                MOVE PV-PCHG-SKU(4:2) TO SKXREF-SUBCLASS              08297248
 |                DISPLAY ' SKU ', PV-PCHG-SKU, ' 4100-'                08297348
 |                DISPLAY ' DPT ', SKXREF-DEPT, ' 4100-'                08297448
 |                DISPLAY ' CLS ', SKXREF-CLASS, ' 4100-'               08297556
RWJ               DISPLAY ' SUB ', SKXREF-SUBCLASS, ' 4100-'            08297648
               WHEN OTHER                                               08297739
                  MOVE '4100-GET-DKEY-FROM-TUPC'                        08297839
                                 TO PV-PARAGRAPH-NAME                   08297939
                  MOVE 'ERROR ON SELECT FROM TUPC'                      08298039
                                 TO PV-OPERATION-ATTEMPTED              08298139
                  PERFORM 9999-SQL-ABEND                                08298239
           END-EVALUATE.                                                08298339
                                                                        08298439
                                                                        08298539
      ******************************************************************08298639
      *                                                                 08298739
      ******************************************************************08298839
       4200-GET-ATTR-FROM-TMDSEAR.                                      08298941
                                                                        08299039
            EXEC SQL                                                    08299139
                SELECT DEPT_NBR                                         08299239
                      ,MAJ_CL_NBR                                       08299339
                      ,SUB_CL_NBR                                       08299439
                 INTO  :MDSEAR-DEPT-NBR                                 08299539
                      ,:MDSEAR-MAJ-CL-NBR                               08299639
                      ,:MDSEAR-SUB-CL-NBR                               08299739
                 FROM  TMDSEAR                                          08299839
                WHERE  MDSEAR_DKEY = :UPC-SUB-CL-MDSEAR-ID              08299939
                  AND  MDSELV_CDE = 'SCL'                               08300039
            END-EXEC.                                                   08300139
      *                                                                 08300239
           EVALUATE SQLCODE                                             08300339
               WHEN 0                                                   08300439
                  MOVE MDSEAR-DEPT-NBR   TO SKXREF-DEPT                 08300539
                  MOVE MDSEAR-MAJ-CL-NBR TO SKXREF-CLASS                08300639
                  MOVE MDSEAR-SUB-CL-NBR TO SKXREF-SUBCLASS             08300739
               WHEN +100                                                08300839
                  DISPLAY ' UPC ', PV-KOHLS-UPC-MIN, ' MDSEAR NOT FOUND'08300939
RWJ               MOVE PV-PCHG-SKU(1:3) TO SKXREF-DEPT                  08301048
 |                MOVE SPACES           TO WS-EDIT-MAJOR-CLASS          08301148
 |                MOVE PV-PCHG-SKU(4:1) TO WS-EDIT-BYTE1                08301248
 |                MOVE '0'              TO WS-EDIT-BYTE2                08301348
 |                MOVE WS-MAJOR-CLASS-NUM TO SKXREF-CLASS               08301448
 |                MOVE PV-PCHG-SKU(4:2) TO SKXREF-SUBCLASS              08301548
 |                DISPLAY ' SKU ', PV-PCHG-SKU, ' 4200-'                08301648
 |                DISPLAY ' DPT ', SKXREF-DEPT, ' 4200-'                08301748
 |                DISPLAY ' CLS ', SKXREF-CLASS, ' 4200-'               08301856
RWJ               DISPLAY ' SUB ', SKXREF-SUBCLASS, ' 4200-'            08301948
               WHEN OTHER                                               08303039
                  MOVE '4200-GET-ATTR-FROM-TMDSEAR'                     08303139
                                 TO PV-PARAGRAPH-NAME                   08303239
                  MOVE 'ERROR ON SELECT FROM TMDSEAR'                   08303339
                                 TO PV-OPERATION-ATTEMPTED              08303439
                  PERFORM 9999-SQL-ABEND                                08303539
           END-EVALUATE.                                                08303639
                                                                        08303739
                                                                        08303839
      ******************************************************************08304039
      *                                                                 08310019
      ******************************************************************08320019
                                                                        08690007
       5100-WRITE-ERROR-REPORT.                                         08700019
                                                                        08710015
           IF PV-LINE-COUNT > 58                                        08720015
               PERFORM 5000-WRITE-HEADINGS                              08730019
           END-IF.                                                      08740015
                                                                        08750015
           ADD  1 TO  PV-LINE-COUNT                                     08780015
                                                                        08820015
           MOVE ERROR-LINE TO ERROR-REC.                                08830015
                                                                        08840015
           PERFORM 5200-WRITE-ERROR-REPORT.                             08850019
                                                                        08860015
      ******************************************************************08861019
      *                                                                 08862019
      ******************************************************************08863019
                                                                        08870015
       5000-WRITE-HEADINGS.                                             08880019
                                                                        08890015
           ADD 1              TO PV-PAGE-COUNT                          08900015
                                                                        08910015
           MOVE PV-PAGE-COUNT TO DP133O-PAGE-NUMBER.                    08920015
           MOVE 1             TO DP133O-REPORT-NUMBER.                  08930015
           MOVE DP133O-STANDRD-HEADER-133-COLS TO ERROR-REC.            08940015
                                                                        08970015
           PERFORM 5200-WRITE-ERROR-REPORT                              08980019
                                                                        08990015
           MOVE HEADER2       TO ERROR-REC                              09000015
           PERFORM 5200-WRITE-ERROR-REPORT                              09010019
                                                                        09020015
           MOVE HEADER3       TO ERROR-REC                              09030015
           PERFORM 5200-WRITE-ERROR-REPORT                              09040019
                                                                        09050015
           MOVE 4 TO PV-LINE-COUNT.                                     09060015
                                                                        09070015
      ******************************************************************09071019
      *                                                                 09072019
      ******************************************************************09073019
       5200-WRITE-ERROR-REPORT.                                         09080019
                                                                        09090015
           WRITE ERROR-REC.                                             09100015
      *                                                                 09110015
      *5200-ABEND.                                                      09120019
      *                                                                 09130015
      *    CALL 'ILBOABN0'             USING ABEND-CODE.                09140015
      *                                                                 09150015
      ******************************************************************09150119
      *                                                                 09150219
      ******************************************************************09150319
                                                                        09151019
       7100-READ-REGISTER-SALES.                                        09152019
                                                                        09153019
           READ REGISTER-SALES-FILE  INTO PV-SALES-RECORD               09154019
              AT END                                                    09155019
                   SET END-OF-REGISTER-SALES-FILE     TO TRUE.          09156019
                                                                        09157019
      ******************************************************************09157119
      *                                                                 09157219
      ******************************************************************09157319
                                                                        09158019
       7200-READ-PRICE-CHANGE.                                          09159019
                                                                        09159119
           READ PRICE-CHANGE-FILE   INTO PV-PCHG-RECORD                 09159219
              AT END                                                    09159319
                   SET END-OF-PRICE-CHANGE-FILE       TO TRUE.          09159419
                                                                        09159519
      ******************************************************************09159619
      *                                                                 09159719
      ******************************************************************09159819
                                                                        09159919
       7300-READ-STORE-TRANSFER.                                        09160019
                                                                        09160119
           READ STORE-TRANSFER-FILE INTO PV-XFER-STORE-TRANSFER-RECORD  09160219
              AT END                                                    09160319
                   SET END-OF-STORE-TRANSFER-FILE     TO TRUE.          09160419
                                                                        09160519
      ******************************************************************09161007
      *  STANDARD DB2 ERROR ABEND ROUTINE                               09170007
      *  THIS ROUTINE FORCES AN ABEND DUE TO A DB2 PROBLEM.             09180007
      ******************************************************************09190007
       9999-SQL-ABEND.                                                  09200007
                                                                        09210007
           MOVE +4013                 TO ABEND-CODE.                    09220007
           DISPLAY '**  ABEND     **'.                                  09230007
           DISPLAY '**  PROGRAM   ** => ' PC-PROGRAM-NAME.              09240007
           DISPLAY '**  PARAGRAPH **  = ' PV-PARAGRAPH-NAME.            09250007
           DISPLAY '**  OPERATION **  = ' PV-OPERATION-ATTEMPTED.       09260007
                                                                        09270007
      *    THE FOLLOWING COPYBOOK UTILIZES THE DB2 ABEND MODULE         09280007
      *    DSNTIAR TO CONVERT SQLCA INTO UNDERSTANDABLE VERBAGE.        09290007
                                                                        09300007
           COPY DPPD004.                                                09310052
           CALL 'ILBOABN0'  USING ABEND-CODE.                           09320007
                                                                        09330007
