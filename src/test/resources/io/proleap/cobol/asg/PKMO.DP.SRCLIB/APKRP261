000100 IDENTIFICATION DIVISION.                                         00010004
000200 PROGRAM-ID.     APKRP261.                                        00020004
000300 AUTHOR.         PAM VOLK.                                        00030004
000400*DATE-WRITTEN.   JAN  '97.                                        00040004
000500*DATE-COMPILED.                                                   00050004
000600*************************************************************     00060004
000700*    COBOL 2                                                *     00070004
000800*                                                           *     00080004
000900*    OPEN INVOICE AGING VENDOR SUMMARY REPORT               *     00090007
001000*                                                           *     00100007
001100*   PROGRAM OVERVIEW:                                       *     00110004
001200*                                                           *     00120004
001300*     THIS PROGRAM CREATES THE INVOICE AGING REPORT FROM    *     00130004
001400*   A FLAT FILE. COPY OF PROGRAM APKRP262 MINUS THE DETAIL  *     00140004
001500*   INFORMATION LINES.  UNDER THE MANUAL ENTRY METHOD       *     00150004
001600*   INVOICE TYPE 'MI AND 'RI' WILL BROKEN OUT INTO SEPARATE *     00160004
001700*   REPORTS.                                                *     00170004
001800*                                                           *     00180004
001900*   INPUT:                                                  *     00190004
002000*                                                           *     00200004
002100*  1) OPEN-INVOICE-FILE                     (APRD262)       *     00210007
002200*                                                           *     00220004
002300*   OUTPUT:                                                 *     00230004
002400*                                                           *     00240007
002500*  1) MANUAL-FILE                           (DPWS133O)      *     00250007
002600*  2) EDI-FILE                              (DPWS133O)      *     00260007
002700*  3) REMINV-FILE                           (DPWS133O)      *     00270007
002800*                                                           *     00280007
002900*************************************************************     00290007
003000*                                                           *     00300007
003100*        TOTALS ONLY                                        *     00310004
003200*        AGING INVOICE REPORT WITH TOTALS IN EACH AGE       *     00320004
003300*        BRACKET AND GRAND TOTALS FOR EACH VENDOR.          *     00330004
003400*        3 REPORTS ONE FOR MANUAL MI (MERCHANDISE INVOICE)  *     00340004
003500*        THE SECOND ONE FOR MANUAL RI (REMAINDER INVOICE)   *     00350004
003600*        AND THIRD FOR EDI ENTRY METHOD.                    *     00360004
003700*                                                           *     00370004
003800*************************************************************     00380004
003900*   CHANGES:                                                *     00390004
004000*                                                           *     00400004
004100*   02/03/97   ADDED A THIRD REPORT TO BREAK OUT TOTALS FOR *     00410004
004200*              REMAINDER INVOICES.  APKRP261-3              *     00420004
004300*                                                           *     00430004
004400*   08/22/97   THE WS ABEND-CODE AREA WAS REMOVED.          *     00440004
004500*                                                           *     00450004
004600* 11/17/00 - CHANGED THE RECORD LENGTH ON THE INPUT FILE    *     00460004
004700*            FROM 77 TO 78.  CHANGED THE APRD262I COPYBOOK  *     00470004
004800*            TO APRD262 AND RENAMED ALL FIELDS TO CONFORM   *     00480004
004900*            TO CURRENT STANDARDS.  EXPANDED THE            *     00490004
005000*            DAYS-DELINQUENT FIELD FROM 3 TO 5 POSITIONS.   *     00500004
005100*        BY: NANCY EILBES                      WR#: 20704   *     00510004
005200*                                                           *     00520006
005300* 02/27/01 - CHANGED THE RECORD LENGTH ON THE INPUT FILE    *     00530006
005400*            FROM 78 TO 100.                                *     00540006
005500*        BY: NANCY EILBES                      WR#: 20704   *     00550006
005600*                                                           *     00560007
005700* 02/05/2003                                                *     00570007
005800*    CHANGE MADE: ARKPO PHASE3 PROJECT.                     *     00580007
005900*    UPDATED THE PROGRAM TITLE TO MATCH THE SPEC TITLE.     *     00590007
006000*    UPDATED THE FILE NAMES IN THE PROGRAM COMMENT BLOCK &  *     00600007
006100*    RECOMPILED TO PICK UP UPDATED APRD262 COPYBOOK.        *     00610007
006200* MADE BY:  MIKE BESKE                          WR#: 23500  *     00620007
006210*                                                           *     00621008
006220* 06/12/2008                                                *     00622025
006230*    CHANGE MADE: MATCH BY DC PHASE 2 PROJECT.              *     00623008
006240*    REMOVED OUTPUTS TWO AND THREE, (EDI AND REMAINDER),    *     00624025
006250*    SINCE THERE WILL ONLY BE ONE REPORT GENERATED BY THIS  *     00625025
006260*    PROGRAM.  REMOVED ALL REFERENCES TO ENTRY-METHOD,      *     00626025
006261*    PO-STATUS, HOLD-IND SINCE THESE HAVE BEEN REMOVED FROM *     00626125
006262*    THE COPYBOOK APRD262.                                  *     00626225
006270* MADE BY:  ROLF NOHE                           WR#: 32804  *     00627008
006210*                                                           *     00628026
006220* 08/31/2021                                                *     00629026
006230*    CHANGE MADE: RECOMPILE FOR NEW VERSION OF APRD262      *     00629126
006270* MADE BY:  JEAN KURK                       CHG0260549      *     00629726
006300*************************************************************     00630007
006400/                                                                 00640007
006500 ENVIRONMENT DIVISION.                                            00650007
006600 CONFIGURATION SECTION.                                           00660007
006700 INPUT-OUTPUT SECTION.                                            00670007
006800 FILE-CONTROL.                                                    00680007
006900     SELECT OPEN-INVOICE-FILE ASSIGN TO UT-S-INP01.               00690007
007201     SELECT ALL-INVOICE-FILE  ASSIGN TO UT-S-OUT01.               00720108
007300/                                                                 00730007
007400 DATA DIVISION.                                                   00740007
007500 FILE SECTION.                                                    00750007
007600 FD  OPEN-INVOICE-FILE                                            00760007
007700     RECORDING MODE IS F                                          00770007
007800     LABEL RECORDS ARE STANDARD                                   00780007
007900     BLOCK CONTAINS 0 RECORDS                                     00790007
008000     DATA RECORD IS OPEN-INVOICE-RECORD.                          00800007
008100 01  OPEN-INVOICE-RECORD              PIC  X(100).                00810007
008200                                                                  00820007
008320 FD  ALL-INVOICE-FILE                                             00832008
008400     RECORDING MODE IS F                                          00840007
008500     LABEL RECORDS ARE STANDARD                                   00850007
008600     BLOCK CONTAINS 0 RECORDS                                     00860007
008710     DATA RECORD IS ALL-INVOICE-REC.                              00871008
008801 01  ALL-INVOICE-REC                  PIC  X(132).                00880108
008802                                                                  00880209
010300/                                                                 01030007
010400 WORKING-STORAGE SECTION.                                         01040007
010500 01  PROGRAM-WORKAREA.                                            01050007
010600     05  FILLER                      PIC  X(30) VALUE             01060007
010700                                 '** BEGINING OF APKRP261 W/S **'.01070007
010800     05  PW-CURRENT-PARAGRAPH         PIC  X(30).                 01080007
010900     05  PW-REPORT-NAME               PIC  X(08)    VALUE         01090007
011000                                      'APKRP261'.                 01100007
011100     05  PW-BLANK-LINE                PIC  X(132)   VALUE SPACES. 01110007
011200     05  PW-BREAK-COUNT               PIC  9(06)    VALUE ZEROES  01120007
011300                                                    COMP-3.       01130007
011400     05  PW-LINE-COUNT                PIC  9(03)    VALUE 99      01140007
011500                                                    COMP-3.       01150007
011600     05  PW-PAGE-COUNT                PIC  9(05)    VALUE ZEROES  01160007
011700                                                    COMP-3.       01170007
011800     05  PW-INPUT-COUNT               PIC  9(05)    VALUE ZEROES  01180007
011900                                                    COMP-3.       01190007
012000     05  PW-MAX-LINES                 PIC  9(03)    VALUE 60      01200007
012100                                                    COMP-3.       01210007
012200     05  PW-DISPLAY-COUNT             PIC  9(05)    VALUE 0.      01220007
012300     05  PW-GROSS-INVOICE-AMT         PIC  9(11)V99 VALUE ZERO    01230007
012400                                                    COMP-3.       01240007
012500     05  PW-UNDER30-AMT               PIC  9(11)V99 VALUE ZERO    01250007
012600                                                    COMP-3.       01260007
012700     05  PW-31-60-AMT                 PIC  9(11)V99 VALUE ZERO    01270007
012800                                                    COMP-3.       01280007
012900     05  PW-61-90-AMT                 PIC  9(11)V99 VALUE ZERO    01290007
013000                                                    COMP-3.       01300007
013100     05  PW-91-120-AMT                PIC  9(11)V99 VALUE ZERO    01310007
013200                                                    COMP-3.       01320007
013300     05  PW-OVER120-AMT               PIC  9(11)V99 VALUE ZERO    01330007
013400                                                    COMP-3.       01340007
013500     05  PW-TOT-GROSS-INVOICE-AMT     PIC  9(11)V99 VALUE ZERO    01350007
013600                                                    COMP-3.       01360007
013700     05  PW-TOT-UNDER30-AMT           PIC  9(11)V99 VALUE ZERO    01370007
013800                                                    COMP-3.       01380007
013900     05  PW-TOT-31-60-AMT             PIC  9(11)V99 VALUE ZERO    01390007
014000                                                    COMP-3.       01400007
014100     05  PW-TOT-61-90-AMT             PIC  9(11)V99 VALUE ZERO    01410007
014200                                                    COMP-3.       01420007
014300     05  PW-TOT-91-120-AMT            PIC  9(11)V99 VALUE ZERO    01430007
014400                                                    COMP-3.       01440007
014500     05  PW-TOT-OVER120-AMT           PIC  9(11)V99 VALUE ZERO    01450007
014600                                                    COMP-3.       01460007
014611     05  PW-VND-GROSS-INVOICE-AMT     PIC  9(11)V99 VALUE ZERO    01461119
014620                                                    COMP-3.       01462019
014630     05  PW-VND-UNDER30-AMT           PIC  9(11)V99 VALUE ZERO    01463019
014640                                                    COMP-3.       01464019
014650     05  PW-VND-31-60-AMT             PIC  9(11)V99 VALUE ZERO    01465019
014660                                                    COMP-3.       01466019
014670     05  PW-VND-61-90-AMT             PIC  9(11)V99 VALUE ZERO    01467019
014680                                                    COMP-3.       01468019
014690     05  PW-VND-91-120-AMT            PIC  9(11)V99 VALUE ZERO    01469019
014691                                                    COMP-3.       01469119
014692     05  PW-VND-OVER120-AMT           PIC  9(11)V99 VALUE ZERO    01469219
014693                                                    COMP-3.       01469319
014694     05  PW-GT-GROSS-INVOICE-AMT      PIC  9(11)V99 VALUE ZERO    01469419
014695                                                    COMP-3.       01469519
014696     05  PW-GT-UNDER30-AMT            PIC  9(11)V99 VALUE ZERO    01469619
014697                                                    COMP-3.       01469719
014698     05  PW-GT-31-60-AMT              PIC  9(11)V99 VALUE ZERO    01469819
014699                                                    COMP-3.       01469919
014700     05  PW-GT-61-90-AMT              PIC  9(11)V99 VALUE ZERO    01470019
014701                                                    COMP-3.       01470119
014702     05  PW-GT-91-120-AMT             PIC  9(11)V99 VALUE ZERO    01470219
014703                                                    COMP-3.       01470319
014704     05  PW-GT-OVER120-AMT            PIC  9(11)V99 VALUE ZERO    01470419
014705                                                    COMP-3.       01470519
014710                                                                  01471007
014800     05  PW-SAVE-ENTRY-METHOD         PIC  X(01)    VALUE SPACE.  01480007
014900     05  PW-SAVE-INVOICE-TYPE         PIC  X(02)    VALUE SPACE.  01490007
015000     05  PW-SAVE-VENDOR-NUMBER        PIC  9(09)    VALUE ZERO.   01500007
015100     05  PW-SAVE-RECORD-KEY           PIC  X(15)    VALUE SPACES. 01510007
015120     05  PW-SAVE-VENDOR-NAME          PIC  X(15)    VALUE SPACES. 01512014
015200                                                                  01520007
015300 01  PROGRAM-SWITCHES.                                            01530007
015400     05  PW-END-PROCESSING-SW         PIC  X(01)    VALUE 'N'.    01540007
015500         88  END-OF-PROCESSING                      VALUE 'Y'.    01550007
015600                                                                  01560007
015700 01  PW-CURRENT-DATE.                                             01570007
015800     05  PW-CURRENT-YEAR              PIC  9(02)    VALUE ZEROES. 01580007
015900     05  PW-CURRENT-MONTH             PIC  9(02)    VALUE ZEROES. 01590007
016000     05  PW-CURRENT-DAY               PIC  9(02)    VALUE ZEROES. 01600007
016100 01  PW-CURRENT-TIME.                                             01610007
016200     05  PW-CURRENT-HOUR              PIC  9(02)    VALUE ZEROES. 01620007
016300     05  PW-CURRENT-MINUTE            PIC  9(02)    VALUE ZEROES. 01630007
016400     05  FILLER                       PIC  9(02)    VALUE ZEROES. 01640007
016500 01  PW-DATE-BREAK-DOWN.                                          01650007
016600     05  PW-DATE-MM                   PIC  9(02)    VALUE ZEROES. 01660007
016700     05  PW-DATE-DD                   PIC  9(02)    VALUE ZEROES. 01670007
016800     05  PW-DATE-YY                   PIC  9(02)    VALUE ZEROES. 01680007
016900                                                                  01690009
017600/                                                                 01760007
017700     COPY DPWS133O.                                               01770007
017800                                                                  01780007
017900 01  HDR-LINE-2.                                                  01790007
018201     05  FILLER                       PIC  X(49)   VALUE SPACES.  01820109
018202     05  FILLER                       PIC  X(33)  VALUE           01820209
018203         'ALL INVOICE AGING VENDOR SUMMARY '.                     01820309
018300     05  HDR-2-TITLE                  PIC  X(17)   VALUE SPACES.  01830007
018400     05  FILLER                       PIC  X(40)   VALUE SPACES.  01840007
018500                                                                  01850007
018600 01  HDR-LINE-3.                                                  01860007
018700     05  FILLER                       PIC  X(59)   VALUE SPACES.  01870007
018800     05  FILLER                       PIC  X(06)   VALUE 'AS OF '.01880007
018900     05  HDR-3-DATE                   PIC  X(08)   VALUE SPACES.  01890007
019000     05  FILLER                       PIC  X(59)   VALUE SPACES.  01900007
019100                                                                  01910007
019200 01  PRINT-VENDOR-HEADER.                                         01920007
019300     05  FILLER                       PIC  X(05)    VALUE SPACES. 01930007
019400     05  FILLER                       PIC  X(08)    VALUE         01940007
019500                                      'VENDOR# '.                 01950007
019600     05  FILLER                       PIC  X(16)    VALUE         01960007
019700                                      '   VENDOR NAME  '.         01970007
019810     05  FILLER                       PIC  X(09)    VALUE SPACES. 01981016
019900     05  FILLER                       PIC  X(17)    VALUE         01990007
020000                                      ' GROSS INVOICE   '.        02000007
020100     05  FILLER                       PIC  X(14)    VALUE         02010007
020200                                      '     UNDER 30 '.           02020007
020300     05  FILLER                       PIC  X(16)    VALUE         02030007
020400                                      '        31 - 60 '.         02040007
020500     05  FILLER                       PIC  X(15)    VALUE         02050007
020600                                      '        61 - 90'.          02060007
020700     05  FILLER                       PIC  X(18)    VALUE         02070007
020800                                      '        91 - 120'.         02080007
020900     05  FILLER                       PIC  X(14)    VALUE         02090007
021000                                      '      OVER 120'.           02100007
021100                                                                  02110007
021200                                                                  02120007
021300                                                                  02130007
021400 01  PRINT-VENDOR-TOTAL.                                          02140007
021500     05  FILLER                       PIC  X(05)    VALUE SPACES. 02150007
021600     05  PRINT-VENDOR-NUMBER          PIC  X(09).                 02160007
021710     05  FILLER                       PIC  X(02)    VALUE SPACES. 02171008
021800     05  PRINT-VENDOR-NAME            PIC  X(15).                 02180015
021911     05  FILLER                       PIC  X(04)    VALUE SPACES. 02191115
022000     05  VENDOR-GROSS-INVOICE-AMT     PIC  ZZ,ZZZ,ZZZ,ZZ9.99      02200007
022100                                                    VALUE ZERO.   02210007
022200     05  FILLER                       PIC  X(02)    VALUE SPACES. 02220007
022300     05  VENDOR-UNDER30-AMT           PIC  ZZZ,ZZZ,ZZZ.ZZ         02230007
022400                                                    VALUE ZERO.   02240007
022500     05  FILLER                       PIC  X(02)    VALUE SPACES. 02250007
022600     05  VENDOR-31-60-AMT             PIC  ZZZ,ZZZ,ZZZ.ZZ         02260007
022700                                                    VALUE ZERO.   02270007
022800     05  FILLER                       PIC  X(02)    VALUE SPACES. 02280007
022900     05  VENDOR-61-90-AMT             PIC  ZZZ,ZZZ,ZZZ.ZZ         02290007
023000                                                    VALUE ZERO.   02300007
023100     05  FILLER                       PIC  X(02)    VALUE SPACES. 02310007
023200     05  VENDOR-91-120-AMT            PIC  ZZZ,ZZZ,ZZZ.ZZ         02320007
023300                                                    VALUE ZERO.   02330007
023400     05  FILLER                       PIC  X(02)    VALUE SPACES. 02340007
023500     05  VENDOR-OVER120-AMT           PIC  ZZZ,ZZZ,ZZZ.ZZ         02350007
023600                                                    VALUE ZERO.   02360007
023700                                                                  02370007
023800 01  PRINT-GRAND-TOTAL.                                           02380007
023900     05  FILLER                       PIC  X(05)    VALUE SPACES. 02390007
024000     05  FILLER                       PIC  X(06)    VALUE         02400007
024100                                      'GRAND '.                   02410007
024200     05  GRAND-ENTRY-METHOD           PIC  X(24)    VALUE SPACES. 02420007
024300     05  GRAND-GROSS-INVOICE-AMT      PIC  ZZ,ZZZ,ZZZ,ZZ9.99      02430007
024400                                                    VALUE ZERO.   02440007
024500     05  GRAND-UNDER30-AMT            PIC  Z,ZZZ,ZZZ,ZZZ.ZZ       02450007
024600                                                    VALUE ZERO.   02460007
024700     05  GRAND-31-60-AMT              PIC  Z,ZZZ,ZZZ,ZZZ.ZZ       02470007
024800                                                    VALUE ZERO.   02480007
024900     05  GRAND-61-90-AMT              PIC  Z,ZZZ,ZZZ,ZZZ.ZZ       02490007
025000                                                    VALUE ZERO.   02500007
025100     05  GRAND-91-120-AMT             PIC  Z,ZZZ,ZZZ,ZZZ.ZZ       02510007
025200                                                    VALUE ZERO.   02520007
025300     05  GRAND-OVER120-AMT            PIC  Z,ZZZ,ZZZ,ZZZ.ZZ       02530007
025400                                                    VALUE ZERO.   02540007
025500                                                                  02550007
025600 01  TOTAL-LINE.                                                  02560007
025700     05  FILLER                       PIC  X(13)    VALUE SPACES. 02570007
025800     05  TOTAL-ENTRY-METHOD           PIC  X(24)    VALUE SPACES. 02580007
025900     05  FILLER                       PIC  X(02)    VALUE SPACES. 02590007
026000     05  TOTAL-BREAK-COUNT            PIC  ZZZ,ZZ9  VALUE ZERO.   02600007
026100     05  FILLER                       PIC  X(92)    VALUE SPACES. 02610007
026200                                                                  02620007
026300 01  EOR-END-OF-REPORT.                                           02630007
026400     05  FILLER                  PIC  X(52)  VALUE SPACES.        02640007
026500     05  FILLER                  PIC  X(80)  VALUE                02650007
026600         '*****  END OF REPORT *****'.                            02660007
026700/                                                                 02670007
026800     COPY APRD262.                                                02680007
026900/                                                                 02690007
027000 PROCEDURE DIVISION.                                              02700007
027100*                                                                 02710007
027200 0000-MAINLINE.                                                   02720007
027300                                                                  02730007
027500     MOVE '0000-MAINLINE                ' TO PW-CURRENT-PARAGRAPH.02750012
027601     PERFORM 7000-INITIALIZATION.                                 02760108
027602     PERFORM 1000-DETAIL-PROCESSING                               02760208
027700         UNTIL END-OF-PROCESSING.                                 02770007
027811     PERFORM 9900-END-OF-INPUT.                                   02781108
027900                                                                  02790007
028000     GOBACK.                                                      02800007
028100/                                                                 02810007
028200 1000-DETAIL-PROCESSING.                                          02820007
028300     MOVE '1000-DETAIL-PROCESSING       ' TO PW-CURRENT-PARAGRAPH.02830007
028400*                                                                 02840007
030700                                                                  03070007
030800     IF AP262-VENDOR-NUMBER NOT = PW-SAVE-VENDOR-NUMBER           03080007
030911         PERFORM 9300-PRINT-VENDOR-TOTAL                          03091108
031000         MOVE AP262-VENDOR-NUMBER   TO PRINT-VENDOR-NUMBER        03100009
031100                                       PW-SAVE-VENDOR-NUMBER      03110009
031200         MOVE AP262-VENDOR-NAME     TO PRINT-VENDOR-NAME          03120009
031201                                       PW-SAVE-VENDOR-NAME        03120114
031220         PERFORM 2000-ACCUM-VENDOR-TOTALS                         03122009
031230         ADD 1                      TO PW-BREAK-COUNT             03123009
031240         MOVE AP262-RECORD-KEY      TO PW-SAVE-RECORD-KEY         03124009
031241         PERFORM 9600-PRINT-VENDOR-DETAIL-LINE                    03124112
031250         PERFORM 8000-READ-OPEN-INVOICE-FILE                      03125009
031300     ELSE                                                         03130009
031311         PERFORM 2000-ACCUM-VENDOR-TOTALS                         03131109
031320         ADD 1                      TO PW-BREAK-COUNT             03132009
031330         MOVE AP262-RECORD-KEY      TO PW-SAVE-RECORD-KEY         03133009
031340         PERFORM 9600-PRINT-VENDOR-DETAIL-LINE                    03134012
031350         PERFORM 8000-READ-OPEN-INVOICE-FILE                      03135009
031400     END-IF.                                                      03140009
031900                                                                  03190007
032200/                                                                 03220007
032300 2000-ACCUM-VENDOR-TOTALS.                                        03230007
032510     ADD  AP262-GROSS-INVOICE-AMT TO PW-VND-GROSS-INVOICE-AMT     03251023
032530                                     PW-GT-GROSS-INVOICE-AMT.     03253019
032600     EVALUATE AP262-DAYS-DELINQUENT                               03260007
032700         WHEN 00 THRU 30                                          03270007
032910             ADD  AP262-GROSS-INVOICE-AMT TO PW-VND-UNDER30-AMT   03291023
032930                                             PW-GT-UNDER30-AMT    03293019
033000         WHEN 31 THRU 60                                          03300007
033210             ADD  AP262-GROSS-INVOICE-AMT TO PW-VND-31-60-AMT     03321023
033230                                             PW-GT-31-60-AMT      03323019
033300         WHEN 61 THRU 90                                          03330007
033510             ADD  AP262-GROSS-INVOICE-AMT TO PW-VND-61-90-AMT     03351023
033530                                             PW-GT-61-90-AMT      03353019
033600         WHEN 91 THRU 120                                         03360007
033810             ADD  AP262-GROSS-INVOICE-AMT TO PW-VND-91-120-AMT    03381023
033830                                             PW-GT-91-120-AMT     03383019
033900         WHEN OTHER                                               03390007
034110             ADD  AP262-GROSS-INVOICE-AMT TO PW-VND-OVER120-AMT   03411023
034130                                             PW-GT-OVER120-AMT    03413019
034200     END-EVALUATE.                                                03420007
034500/                                                                 03450007
034510 3000-EVALUATE-DAYS-DELINQUENT.                                   03451010
034540     EVALUATE AP262-DAYS-DELINQUENT                               03454010
034550         WHEN 00 THRU 30                                          03455010
034560             MOVE AP262-GROSS-INVOICE-AMT TO VENDOR-UNDER30-AMT   03456010
034580         WHEN 31 THRU 60                                          03458010
034590             MOVE AP262-GROSS-INVOICE-AMT TO VENDOR-31-60-AMT     03459010
034592         WHEN 61 THRU 90                                          03459210
034593             MOVE AP262-GROSS-INVOICE-AMT TO VENDOR-61-90-AMT     03459310
034595         WHEN 91 THRU 120                                         03459510
034596             MOVE AP262-GROSS-INVOICE-AMT TO VENDOR-91-120-AMT    03459610
034598         WHEN OTHER                                               03459810
034599             MOVE AP262-GROSS-INVOICE-AMT TO VENDOR-OVER120-AMT   03459910
034601     END-EVALUATE.                                                03460110
034602/                                                                 03460210
034610 7000-INITIALIZATION.                                             03461010
034700     MOVE '7000-INITIALIZATION          ' TO PW-CURRENT-PARAGRAPH.03470012
034800*                                                                 03480007
034900     OPEN INPUT OPEN-INVOICE-FILE.                                03490007
035201     OPEN OUTPUT ALL-INVOICE-FILE.                                03520108
035300     ACCEPT PW-CURRENT-DATE FROM DATE.                            03530007
035400     MOVE PW-CURRENT-MONTH            TO DP133O-RUN-MONTH.        03540007
035500     MOVE PW-CURRENT-DAY              TO DP133O-RUN-DAY.          03550007
035600     MOVE PW-CURRENT-YEAR             TO DP133O-RUN-YEAR.         03560007
035700     MOVE DP133O-RUN-DATE             TO HDR-3-DATE.              03570007
035800     ACCEPT PW-CURRENT-TIME FROM TIME.                            03580007
035900     MOVE PW-CURRENT-HOUR             TO DP133O-RUN-HOUR.         03590007
036000     MOVE PW-CURRENT-MINUTE           TO DP133O-RUN-MINUTE.       03600007
036100     MOVE PW-REPORT-NAME              TO DP133O-PROGRAM-NAME.     03610007
036200*    MOVE 1                           TO DP133O-REPORT-NUMBER.    03620015
036311     PERFORM 8000-READ-OPEN-INVOICE-FILE.                         03631108
036400     IF NOT END-OF-PROCESSING                                     03640007
036611         PERFORM 9000-NEW-PAGE-PROCESSING                         03661108
038800     ELSE                                                         03880007
039601         PERFORM 9000-NEW-PAGE-PROCESSING                         03960109
039605         PERFORM 9500-PRINT-GRAND-TOTAL                           03960509
039606         PERFORM 9400-PRINT-TOTAL-LINE                            03960609
039607         MOVE ZERO TO PW-PAGE-COUNT                               03960709
039608         PERFORM 9000-NEW-PAGE-PROCESSING                         03960809
039700     END-IF.                                                      03970007
039701                                                                  03970110
039710     MOVE AP262-VENDOR-NUMBER   TO PRINT-VENDOR-NUMBER            03971010
039800                                   PW-SAVE-VENDOR-NUMBER.         03980010
039900     MOVE AP262-VENDOR-NAME     TO PRINT-VENDOR-NAME              03990015
039910                                   PW-SAVE-VENDOR-NAME.           03991015
040000/                                                                 04000007
040100 8000-READ-OPEN-INVOICE-FILE.                                     04010007
040200     MOVE '8000-READ-OPEN-INVOICE-FILE   ' TO PW-CURRENT-PARAGRAPH04020007
040300*                                                                 04030007
040400     READ OPEN-INVOICE-FILE                                       04040007
040500          INTO AP262-INPUT-RECORD                                 04050007
040600          AT END SET END-OF-PROCESSING TO TRUE.                   04060007
040610                                                                  04061009
040700     IF NOT END-OF-PROCESSING                                     04070007
040800         ADD 1 TO PW-INPUT-COUNT                                  04080009
040801     END-IF.                                                      04080109
040802                                                                  04080209
040900*                                                                 04090007
041200/                                                                 04120007
041300 9000-NEW-PAGE-PROCESSING.                                        04130007
041400     MOVE '9000-NEW-PAGE-PROCESSING     ' TO PW-CURRENT-PARAGRAPH.04140007
041500*                                                                 04150007
041600     ADD 1                            TO PW-PAGE-COUNT.           04160007
041700     MOVE PW-PAGE-COUNT               TO DP133O-PAGE-NUMBER.      04170007
043501     WRITE ALL-INVOICE-REC                                        04350115
043502           FROM  DP133O-STANDRD-HEADER-133-COLS                   04350215
043503           AFTER ADVANCING PAGE.                                  04350315
043504     WRITE ALL-INVOICE-REC                                        04350415
043506           FROM HDR-LINE-2                                        04350615
043507           AFTER ADVANCING 1 LINE.                                04350715
043508     WRITE ALL-INVOICE-REC                                        04350815
043510           FROM HDR-LINE-3                                        04351015
043511           AFTER ADVANCING 1 LINE.                                04351115
043512     WRITE ALL-INVOICE-REC                                        04351215
043514           FROM PRINT-VENDOR-HEADER                               04351415
043515           AFTER ADVANCING 2 LINES.                               04351515
043516     WRITE ALL-INVOICE-REC                                        04351615
043518           FROM PW-BLANK-LINE                                     04351815
043519     INITIALIZE ALL-INVOICE-REC.                                  04351915
043600                                                                  04360007
047300     MOVE 5                           TO PW-LINE-COUNT.           04730007
047400*                                                                 04740007
047700/                                                                 04770007
047800/                                                                 04780007
047900 9200-PRINT-VENDOR-HEADER.                                        04790007
048000     MOVE '9200-PRINT-VENDOR-HEADER     ' TO PW-CURRENT-PARAGRAPH.04800007
048100*                                                                 04810007
048200     ADD 3                            TO PW-LINE-COUNT.           04820007
048300     IF PW-LINE-COUNT >= PW-MAX-LINES                             04830007
048411         PERFORM 9000-NEW-PAGE-PROCESSING                         04841108
048500         ADD 2                        TO PW-LINE-COUNT            04850007
048600     ELSE                                                         04860007
048700         SUBTRACT 1 FROM PW-LINE-COUNT                            04870007
048800     END-IF.                                                      04880007
048900                                                                  04890007
050001     MOVE PRINT-VENDOR-HEADER         TO ALL-INVOICE-REC.         05000115
050002     WRITE ALL-INVOICE-REC AFTER ADVANCING 2 LINES.               05000215
050100     INITIALIZE PRINT-VENDOR-HEADER.                              05010007
050400/                                                                 05040007
050500 9300-PRINT-VENDOR-TOTAL.                                         05050007
050600     MOVE '9300-PRINT-VENDOR-TOTAL      ' TO PW-CURRENT-PARAGRAPH.05060007
050700*                                                                 05070007
050800     ADD 1                            TO PW-LINE-COUNT.           05080007
050900     IF PW-LINE-COUNT >= PW-MAX-LINES                             05090007
051011         PERFORM 9000-NEW-PAGE-PROCESSING                         05101108
051100         ADD 2                        TO PW-LINE-COUNT            05110007
051200     END-IF.                                                      05120007
051300                                                                  05130007
051930     MOVE PW-VND-GROSS-INVOICE-AMT TO VENDOR-GROSS-INVOICE-AMT.   05193019
051940     MOVE PW-VND-UNDER30-AMT       TO VENDOR-UNDER30-AMT.         05194019
051950     MOVE PW-VND-31-60-AMT         TO VENDOR-31-60-AMT.           05195019
051960     MOVE PW-VND-61-90-AMT         TO VENDOR-61-90-AMT.           05196019
051970     MOVE PW-VND-91-120-AMT        TO VENDOR-91-120-AMT.          05197019
051980     MOVE PW-VND-OVER120-AMT       TO VENDOR-OVER120-AMT.         05198019
051990     MOVE PW-SAVE-VENDOR-NUMBER    TO PRINT-VENDOR-NUMBER.        05199019
051991     MOVE PW-SAVE-VENDOR-NAME      TO PRINT-VENDOR-NAME.          05199119
052000                                                                  05200007
052403     MOVE PRINT-VENDOR-TOTAL    TO ALL-INVOICE-REC.               05240315
052404     WRITE ALL-INVOICE-REC.                                       05240415
053200                                                                  05320007
053910     INITIALIZE PW-VND-GROSS-INVOICE-AMT                          05391020
053920                PW-VND-UNDER30-AMT                                05392020
053930                PW-VND-31-60-AMT                                  05393020
053940                PW-VND-61-90-AMT                                  05394020
053950                PW-VND-91-120-AMT                                 05395020
053960                PW-VND-OVER120-AMT.                               05396020
054200/                                                                 05420007
054300 9400-PRINT-TOTAL-LINE.                                           05430007
054400     MOVE '9400-PRINT-TOTAL-LINE        ' TO PW-CURRENT-PARAGRAPH.05440007
054500*                                                                 05450007
054600     ADD 2                            TO PW-LINE-COUNT.           05460007
054700     IF PW-LINE-COUNT >= PW-MAX-LINES                             05470007
054811         PERFORM 9000-NEW-PAGE-PROCESSING                         05481108
054900     END-IF.                                                      05490007
055000                                                                  05500007
055100     MOVE 'TOTAL INVOICES'            TO TOTAL-ENTRY-METHOD.      05510015
055110     MOVE PW-INPUT-COUNT              TO TOTAL-BREAK-COUNT.       05511015
055200                                                                  05520007
055720     MOVE TOTAL-LINE                  TO ALL-INVOICE-REC.         05572015
055730     WRITE ALL-INVOICE-REC AFTER ADVANCING 2 LINES.               05573015
056700                                                                  05670007
056800     INITIALIZE PW-BREAK-COUNT.                                   05680007
056900     ADD 2                            TO PW-LINE-COUNT.           05690007
057000     IF PW-LINE-COUNT >= PW-MAX-LINES                             05700007
057111         PERFORM 9000-NEW-PAGE-PROCESSING                         05711108
057200     END-IF.                                                      05720007
057300                                                                  05730007
057612     WRITE ALL-INVOICE-REC FROM EOR-END-OF-REPORT AFTER 2.        05761215
058400/                                                                 05840007
058500 9500-PRINT-GRAND-TOTAL.                                          05850007
058600     MOVE '9500-PRINT-GRAND-TOTAL      ' TO PW-CURRENT-PARAGRAPH. 05860007
058700*                                                                 05870007
058800     ADD 2                            TO PW-LINE-COUNT.           05880007
058900     IF PW-LINE-COUNT >= PW-MAX-LINES                             05890007
059011         PERFORM 9000-NEW-PAGE-PROCESSING                         05901108
059100         ADD 2                        TO PW-LINE-COUNT            05910007
059200     END-IF.                                                      05920007
059300                                                                  05930007
059910     MOVE PW-GT-GROSS-INVOICE-AMT TO GRAND-GROSS-INVOICE-AMT.     05991019
059920     MOVE PW-GT-UNDER30-AMT       TO GRAND-UNDER30-AMT.           05992019
059930     MOVE PW-GT-31-60-AMT         TO GRAND-31-60-AMT.             05993019
059940     MOVE PW-GT-61-90-AMT         TO GRAND-61-90-AMT.             05994019
059950     MOVE PW-GT-91-120-AMT        TO GRAND-91-120-AMT.            05995019
059960     MOVE PW-GT-OVER120-AMT       TO GRAND-OVER120-AMT.           05996019
060000                                                                  06000007
060503     MOVE PRINT-GRAND-TOTAL           TO ALL-INVOICE-REC.         06050315
060504     WRITE ALL-INVOICE-REC AFTER ADVANCING 2 LINES.               06050415
061500                                                                  06150007
062110/                                                                 06211010
062200 9600-PRINT-VENDOR-DETAIL-LINE.                                   06220010
062300     MOVE '9600-PRINT-VENDOR-DETAIL-LINE' TO PW-CURRENT-PARAGRAPH.06230010
062384                                                                  06238410
062385     PERFORM 3000-EVALUATE-DAYS-DELINQUENT.                       06238510
062395                                                                  06239510
062420/                                                                 06242007
062500 9900-END-OF-INPUT.                                               06250007
062600     MOVE '9900-END-OF-INPUT            ' TO PW-CURRENT-PARAGRAPH.06260007
062700     DISPLAY '** APKRP261 SUMMARY **'.                            06270007
062800     MOVE PW-INPUT-COUNT TO PW-DISPLAY-COUNT.                     06280015
062900     DISPLAY '** INPUT COUNT - ' PW-DISPLAY-COUNT.                06290007
063000                                                                  06300007
063100     IF PW-SAVE-VENDOR-NUMBER NOT = ZERO                          06310007
063211         PERFORM 9600-PRINT-VENDOR-DETAIL-LINE                    06321112
063212         PERFORM 9300-PRINT-VENDOR-TOTAL                          06321210
063300     END-IF.                                                      06330007
063501     PERFORM 9500-PRINT-GRAND-TOTAL.                              06350108
063502     PERFORM 9400-PRINT-TOTAL-LINE.                               06350208
064400     CLOSE OPEN-INVOICE-FILE                                      06440007
064701           ALL-INVOICE-FILE.                                      06470108
