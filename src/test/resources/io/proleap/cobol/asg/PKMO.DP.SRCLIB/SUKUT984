000100******************************************************************00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300******************************************************************00030000
000400                                                                  00040000
000500 PROGRAM-ID.    SUKUT984.                                         00050000
000600 AUTHOR.        TOM BOYD                                          00060000
000700 INSTALLATION.  KOHLS.                                            00070000
000800 DATE-WRITTEN   JULY 2002.                                        00080000
000900 DATE-COMPILED.                                                   00090000
001000                                                                  00100000
001100******************************************************************00110000
001200* THIS PROGRAM WILL PRODUCE A UCC-128 ARCHIVE REPORT. THE REPORTS 00120000
001300* WILL BE PRODUCED BASED UPON THE REQUESTS MADE.                  00130000
001310******************************************************************00131000
001320                                                                  00132000
001330******************************************************************00133000
001340 ENVIRONMENT DIVISION.                                            00134000
001350******************************************************************00135000
001360                                                                  00136000
001370 CONFIGURATION SECTION.                                           00137000
001380                                                                  00138000
001390 SOURCE-COMPUTER.        IBM-3090.                                00139000
001400 OBJECT-COMPUTER.        IBM-3090.                                00140000
001500                                                                  00150000
001600 INPUT-OUTPUT SECTION.                                            00160000
001700                                                                  00170000
001800 FILE-CONTROL.                                                    00180000
001900                                                                  00190000
002000     SELECT INPUT-FILE                                            00200000
002100         ASSIGN TO INP4.                                          00210000
002200                                                                  00220000
002300     SELECT OUTPUT-FILE                                           00230000
002400         ASSIGN TO RPT01.                                         00240000
002500                                                                  00250000
002510******************************************************************00251000
002520 DATA DIVISION.                                                   00252000
002530******************************************************************00253000
002540                                                                  00254000
002550 FILE SECTION.                                                    00255000
002560                                                                  00256000
002570 FD  INPUT-FILE                                                   00257000
002580     RECORDING MODE IS F                                          00258000
002590     LABEL RECORDS ARE STANDARD                                   00259000
002600     RECORD CONTAINS 173                                          00260000
002700     BLOCK CONTAINS 0 RECORDS                                     00270000
002800     DATA RECORD IS INPUT-RECORD.                                 00280000
002900                                                                  00290000
003000 01  INPUT-RECORD                  PIC  X(173).                   00300000
003100                                                                  00310000
003200                                                                  00320000
003300 FD  OUTPUT-FILE                                                  00330000
003400     RECORDING MODE IS F                                          00340000
003500     LABEL RECORDS ARE STANDARD                                   00350000
003600     RECORD CONTAINS 132                                          00360000
003700     BLOCK CONTAINS 0 RECORDS                                     00370000
003800     DATA RECORD IS OUTPUT-RECORD.                                00380000
003900                                                                  00390000
004000 01  OUTPUT-RECORD             PIC  X(132).                       00400000
004100                                                                  00410000
004200******************************************************************00420000
004300 WORKING-STORAGE SECTION.                                         00430000
004400******************************************************************00440000
004500 01  PS-PROGRAM-SWITCHES.                                         00450000
004510     05  PS-EOF-INP-SW                PIC X(01)  VALUE 'N'.       00451000
004520         88  PS-EOF-INP                          VALUE 'Y'.       00452000
004530         88  PS-NOT-EOF-INP                      VALUE 'N'.       00453000
004540     05  PS-OPER-ID-SW                PIC X(01)  VALUE 'N'.       00454000
004550         88  PS-ALL-OPER-IDS                     VALUE 'Y'.       00455000
004560         88  PS-NOT-ALL-OPER-IDS                 VALUE 'N'.       00456000
004561     05  PS-NEW-CRTN-CHECK-SW         PIC X(01)  VALUE 'N'.       00456100
004562         88  PS-NEW-PO-CRTN                      VALUE 'Y'.       00456200
004563         88  PS-NOT-NEW-PO-CRTN                     VALUE 'N'.    00456300
004564     05  PS-AT-LEAST-ONE-RECORD-SW    PIC X(01)  VALUE 'N'.       00456400
004565         88  PS-AT-LEAST-ONE-RECORD-YES          VALUE 'Y'.       00456500
004566         88  PS-AT-LEAST-ONE-RECORD-NO           VALUE 'N'.       00456600
004567     05  PS-PROCESS-PREV-RECORD-SW    PIC X(01)  VALUE 'N'.       00456700
004568         88  PS-PROCESS-PREV-RECORD-YES          VALUE 'Y'.       00456800
004569         88  PS-PROCESS-PREV-RECORD-NO           VALUE 'N'.       00456900
004570                                                                  00457000
004571 01  PC-PROGRAM-CONSTANTS.                                        00457100
004572     05  PC-PROGRAM-NAME              PIC X(08)  VALUE 'SUKUT984'.00457200
004573     05  PC-MAX-LINES-PAGE            PIC 9(02)  VALUE 47.        00457300
004580                                                                  00458000
004590 01  PV-PROGRAM-VARIABLES.                                        00459000
004600     05  PV-RECORDS-READ              PIC 9(09)     VALUE ZERO.   00460000
004700     05  PV-RECORDS-WRITTEN           PIC 9(09)     VALUE ZERO.   00470000
004800     05  PV-PRINTED-LINES             PIC 9(09)     VALUE ZERO.   00480000
004900     05  PV-POS-PRINTED-LINES         PIC 9(09)     VALUE ZERO.   00490000
004901     05  PV-PAGE-COUNT                PIC S9(04)    VALUE ZERO    00490100
004902                                                    COMP-3.       00490200
004903     05  PV-REPORT-COUNT              PIC S9(04)    VALUE ZERO    00490300
004904                                                    COMP-3.       00490400
004905     05  PV-TK-PO-RCVR-COUNT          PIC S9(04)    VALUE ZERO    00490500
004906                                                    COMP-3.       00490600
004907                                                                  00490700
004908     05  PV-REQUESTED-PO              PIC 9(09)     VALUE ZERO.   00490800
004909     05  PV-REQUESTED-REC-SEQ         PIC 9(04)     VALUE ZERO.   00490900
004910     05  PV-REQUESTED-OPER-ID         PIC 9(04)     VALUE ZERO.   00491000
004920                                                                  00492000
004930     05  PV-CURRENT-PO                PIC S9(09)    VALUE ZERO.   00493000
004940     05  PV-CURRENT-REC-SEQ           PIC S9(09)    VALUE ZERO.   00494000
004950     05  PV-CURRENT-TRIP-ID           PIC S9(09)    VALUE ZERO.   00495000
004960     05  PV-CURRENT-OPER-ID           PIC S9(04)    VALUE ZERO.   00496000
004970     05  PV-CURRENT-SHIPT-ID          PIC S9(18)V   COMP-3.       00497000
004980     05  PV-CURRENT-TK                PIC X(08)     VALUE SPACES. 00498000
004990                                                                  00499000
005000     05 PV-PREV-OPER-ID               PIC S9(4).                  00500000
005100     05 PV-PREV-REQ-DEST-ID           PIC S9(4).                  00510000
005101     05 PV-PREV-REQ-DATE.                                         00510100
005102        10 PV-PREV-REQ-YY             PIC X(04).                  00510200
005103        10 FILLER                     PIC X(01).                  00510300
005104        10 PV-PREV-REQ-MM             PIC X(02).                  00510400
005105        10 FILLER                     PIC X(01).                  00510500
005106        10 PV-PREV-REQ-DD             PIC X(02).                  00510600
005107     05 PV-PREV-REQ-TIME.                                         00510700
005108        10 PV-PREV-REQ-HRS            PIC X(02).                  00510800
005109        10 FILLER                     PIC X(01).                  00510900
005110        10 PV-PREV-REQ-MIN            PIC X(02).                  00511000
005111        10 FILLER                     PIC X(01).                  00511100
005112        10 PV-PREV-REQ-SEC            PIC X(02).                  00511200
005113                                                                  00511300
005114     05  PV-PREV-SHIPT-ID             PIC S9(18)V   COMP-3.       00511400
005115     05  PV-PREV-PO                   PIC S9(09)    VALUE ZERO.   00511500
005116     05  PV-PREV-REC-SEQ              PIC S9(09)    VALUE ZERO.   00511600
005117     05  PV-PREV-TK                   PIC X(08)     VALUE SPACES. 00511700
005118                                                                  00511800
005119     05 PV-CURR-OPER-ID               PIC S9(4).                  00511900
005120     05 PV-CURR-REQ-DEST-ID           PIC S9(4).                  00512000
005121     05 PV-CURR-REQ-DATE.                                         00512100
005122        10 PV-CURR-REQ-YY             PIC X(04).                  00512200
005123        10 FILLER                     PIC X(01).                  00512300
005124        10 PV-CURR-REQ-MM             PIC X(02).                  00512400
005125        10 FILLER                     PIC X(01).                  00512500
005126        10 PV-CURR-REQ-DD             PIC X(02).                  00512600
005127     05 PV-CURR-REQ-TIME.                                         00512700
005128        10 PV-CURR-REQ-HRS            PIC X(02).                  00512800
005129        10 FILLER                     PIC X(01).                  00512900
005130        10 PV-CURR-REQ-MIN            PIC X(02).                  00513000
005131        10 FILLER                     PIC X(01).                  00513100
005132        10 PV-CURR-REQ-SEC            PIC X(02).                  00513200
005133                                                                  00513300
005134     05  PV-SHIPT-UNT-TOTAL           PIC S9(09)V   COMP-3.       00513400
005135     05  PV-SHIPT-UNT-GRD-TOT         PIC S9(09)V   COMP-3.       00513500
005136     05  PV-TOTAL-CRTN-QTY            PIC S9(09)V   COMP-3.       00513600
005137                                                                  00513700
005138     05  PV-TODAYS-DATE.                                          00513800
005139         10  PV-TODAYS-DATE-CCYY     PIC  9(04)    VALUE ZEROS.   00513900
005140         10  PV-TODAYS-DATE-MM       PIC  9(02)    VALUE ZEROS.   00514000
005141         10  PV-TODAYS-DATE-DD       PIC  9(02)    VALUE ZEROS.   00514100
005142     05  PV-TODAYS-TIME.                                          00514200
005143         10  PV-TODAYS-TIME-HH       PIC  9(02)    VALUE ZEROS.   00514300
005144         10  PV-TODAYS-TIME-MM       PIC  9(02)    VALUE ZEROS.   00514400
005145         10  PV-TODAYS-TIME-SS       PIC  9(02)    VALUE ZEROS.   00514500
005146         10  FILLER                  PIC  9(02)    VALUE ZEROS.   00514600
005147                                                                  00514700
005148 01  HL-REPORT-HEADINGS1.                                         00514800
005149     05  FILLER                       PIC X(55)     VALUE SPACES. 00514900
005150     05  FILLER                       PIC X(22)     VALUE         00515000
005151                                      'UCC-128 ARCHIVE REPORT'.   00515100
005152                                                                  00515200
005153 01  HL-REPORT-HEADINGS2.                                         00515300
005154     05  FILLER                       PIC X(17)     VALUE         00515400
005155                                      'REQUESTED BY   : '.        00515500
005156     05  HL2-REQ-TK-NBR               PIC X(08)     VALUE SPACE.  00515600
005157                                                                  00515700
005158 01  HL-REPORT-HEADINGS2A.                                        00515800
005159     05  FILLER                       PIC X(17)     VALUE         00515900
005160                                      'PO REQUESTED   : '.        00516000
005170     05  HL2-REQUEST-PO               PIC ZZZZZZZZ9.              00517000
005171     05  FILLER                       PIC X(13)     VALUE SPACES. 00517100
005172     05  FILLER                       PIC X(11)     VALUE         00517200
005173                                      'RECEIVER : '.              00517300
005174     05  HL2-REQUEST-REC              PIC ZZZ9.                   00517400
005175     05  FILLER                       PIC X(13)     VALUE SPACES. 00517500
005176     05  FILLER                       PIC X(14)     VALUE         00517600
005177                                      'OPER UNT ID : '.           00517700
005178     05  HL2-REQUEST-DC               PIC ZZZ9.                   00517800
005179     05  FILLER                       PIC X(13)     VALUE SPACES. 00517900
005180     05  FILLER                       PIC X(17)     VALUE         00518000
005181                                      'DEST STORE NBR : '.        00518100
005182     05  HL2-REQUEST-STR              PIC ZZZ9.                   00518200
005183                                                                  00518300
005184*    05  FILLER                       PIC X(81)     VALUE SPACES. 00518400
005185                                                                  00518500
005186                                                                  00518600
005187 01  HL-REPORT-HEADINGS3.                                         00518700
005188     05  FILLER                       PIC X(17)     VALUE         00518800
005189                                      'DATE REQUESTED : '.        00518900
005190     05  HL3-REQ-DATE.                                            00519000
005191         10  HL3-REQ-MM               PIC X(02).                  00519100
005192         10  FILLER                   PIC X(01)   VALUE '/'.      00519200
005193         10  HL3-REQ-DD               PIC X(02).                  00519300
005194         10  FILLER                   PIC X(01)   VALUE '/'.      00519400
005195         10  HL3-REQ-YY               PIC X(04).                  00519500
005196                                                                  00519600
005197 01  HL-REPORT-HEADINGS4.                                         00519700
005198     05  FILLER                       PIC X(17)     VALUE         00519800
005199                                      'TIME REQUESTED : '.        00519900
005200     05  HL4-REQ-TIME.                                            00520000
005201         10 HL4-REQ-HRS               PIC X(02).                  00520100
005202         10 FILLER                    PIC X(01)   VALUE ':'.      00520200
005203         10 HL4-REQ-MIN               PIC X(02).                  00520300
005204         10 FILLER                    PIC X(01)   VALUE '.'.      00520400
005205         10 HL4-REQ-SEC               PIC X(02).                  00520500
005206*    05  FILLER                       PIC X(107) VALUE SPACES.    00520600
005207                                                                  00520700
005208                                                                  00520800
005209 01  HL-REPORT-HEADINGS5.                                         00520900
005210     05  FILLER                       PIC X(32) VALUE SPACES.     00521000
005211     05  FILLER                       PIC X(04) VALUE 'ORGN'.     00521100
005212     05  FILLER                       PIC X(02) VALUE SPACES.     00521200
005213     05  FILLER                       PIC X(04) VALUE 'DEST'.     00521300
005214*    05  FILLER                       PIC X(105) VALUE SPACES.    00521400
005215                                                                  00521500
005216 01  HL-REPORT-HEADINGS6.                                         00521600
005217     05  FILLER                       PIC X(27) VALUE SPACES.     00521700
005218     05  FILLER                       PIC X(03) VALUE 'REC'.      00521800
005219     05  FILLER                       PIC X(02) VALUE SPACES.     00521900
005220     05  FILLER                       PIC X(04) VALUE 'OPER'.     00522000
005221     05  FILLER                       PIC X(02) VALUE SPACES.     00522100
005222     05  FILLER                       PIC X(04) VALUE 'OPER'.     00522200
005223     05  FILLER                       PIC X(30) VALUE SPACES.     00522300
005224     05  FILLER                       PIC X(05) VALUE 'SHIPT'.    00522400
005225     05  FILLER                       PIC X(04) VALUE SPACES.     00522500
005226     05  FILLER                       PIC X(02) VALUE 'PO'.       00522600
005227*    05  FILLER                       PIC X(58) VALUE SPACES.     00522700
005228                                                                  00522800
005229 01  HL-REPORT-HEADINGS7.                                         00522900
005230     05  FILLER                       PIC X(21) VALUE SPACES.     00523000
005231     05  FILLER                       PIC X(02) VALUE 'PO'.       00523100
005232     05  FILLER                       PIC X(04) VALUE SPACES.     00523200
005233     05  FILLER                       PIC X(03) VALUE 'SEQ'.      00523300
005234     05  FILLER                       PIC X(02) VALUE SPACES.     00523400
005235     05  FILLER                       PIC X(03) VALUE 'UNT'.      00523500
005236     05  FILLER                       PIC X(03) VALUE SPACES.     00523600
005237     05  FILLER                       PIC X(03) VALUE 'UNT'.      00523700
005238     05  FILLER                       PIC X(09) VALUE SPACES.     00523800
005239     05  FILLER                       PIC X(04) VALUE 'TRIP'.     00523900
005240     05  FILLER                       PIC X(19) VALUE SPACES.     00524000
005241     05  FILLER                       PIC X(03) VALUE 'UNT'.      00524100
005242     05  FILLER                       PIC X(04) VALUE SPACES.     00524200
005243     05  FILLER                       PIC X(03) VALUE 'LNE'.      00524300
005244     05  FILLER                       PIC X(14) VALUE SPACES.     00524400
005245     05  FILLER                       PIC X(03) VALUE 'UPC'.      00524500
005246     05  FILLER                       PIC X(04) VALUE SPACES.     00524600
005247     05  FILLER                       PIC X(04) VALUE 'SHPD'.     00524700
005248*    05  FILLER                       PIC X(34) VALUE SPACES.     00524800
005249                                                                  00524900
005250 01  HL-REPORT-HEADINGS8.                                         00525000
005251     05  FILLER                       PIC X(21) VALUE SPACES.     00525100
005252     05  FILLER                       PIC X(03) VALUE 'NBR'.      00525200
005253     05  FILLER                       PIC X(03) VALUE SPACES.     00525300
005254     05  FILLER                       PIC X(03) VALUE 'NBR'.      00525400
005255     05  FILLER                       PIC X(03) VALUE SPACES.     00525500
005256     05  FILLER                       PIC X(02) VALUE 'ID'.       00525600
005257     05  FILLER                       PIC X(04) VALUE SPACES.     00525700
005258     05  FILLER                       PIC X(02) VALUE 'ID'.       00525800
005259     05  FILLER                       PIC X(11) VALUE SPACES.     00525900
005260     05  FILLER                       PIC X(02) VALUE 'ID'.       00526000
005261     05  FILLER                       PIC X(20) VALUE SPACES.     00526100
005262     05  FILLER                       PIC X(02) VALUE 'ID'.       00526200
005263     05  FILLER                       PIC X(04) VALUE SPACES.     00526300
005264     05  FILLER                       PIC X(03) VALUE 'NBR'.      00526400
005265     05  FILLER                       PIC X(14) VALUE SPACES.     00526500
005266     05  FILLER                       PIC X(03) VALUE 'NBR'.      00526600
005267     05  FILLER                       PIC X(05) VALUE SPACES.     00526700
005268     05  FILLER                       PIC X(04) VALUE 'QTY'.      00526800
005269*    05  FILLER                       PIC X(33) VALUE SPACES.     00526900
005270                                                                  00527000
005271 01  HL-REPORT-HEADINGS9.                                         00527100
005272     05  FILLER                       PIC X(16) VALUE SPACES.     00527200
005273     05  FILLER                       PIC X(08) VALUE             00527300
005274         '--------'.                                              00527400
005275     05  FILLER                       PIC X(02) VALUE SPACES.     00527500
005276     05  FILLER                       PIC X(04) VALUE             00527600
005277         '----'.                                                  00527700
005278     05  FILLER                       PIC X(02) VALUE SPACES.     00527800
005279     05  FILLER                       PIC X(04) VALUE             00527900
005280         '----'.                                                  00528000
005281     05  FILLER                       PIC X(02) VALUE SPACES.     00528100
005282     05  FILLER                       PIC X(04) VALUE             00528200
005283         '----'.                                                  00528300
005284     05  FILLER                       PIC X(02) VALUE SPACES.     00528400
005285     05  FILLER                       PIC X(10) VALUE             00528500
005286         '----------'.                                            00528600
005287     05  FILLER                       PIC X(02) VALUE SPACES.     00528700
005288     05  FILLER                       PIC X(21) VALUE             00528800
005289         '---------------------'.                                 00528900
005290     05  FILLER                       PIC X(02) VALUE SPACES.     00529000
005291     05  FILLER                       PIC X(04) VALUE             00529100
005292         '----'.                                                  00529200
005293     05  FILLER                       PIC X(02) VALUE SPACES.     00529300
005294     05  FILLER                       PIC X(15) VALUE             00529400
005295         '---------------'.                                       00529500
005296     05  FILLER                       PIC X(02) VALUE SPACES.     00529600
005297     05  FILLER                       PIC X(06) VALUE             00529700
005298         '------'.                                                00529800
005299*    05  FILLER                       PIC X(34) VALUE SPACES.     00529900
005300                                                                  00530000
005310 01 DETAIL-LINES.                                                 00531000
005311     05  DL-LINE1.                                                00531100
005312         10 FILLER                    PIC X(15)  VALUE SPACES.    00531200
005313         10 DL1-PO-NBR                PIC ZZZZZZZZ9.              00531300
005314         10 FILLER                    PIC X(02)  VALUE SPACES.    00531400
005315         10 DL1-REC-SEQ-NBR           PIC ZZZ9   VALUE SPACES.    00531500
005316         10 FILLER                    PIC X(03)  VALUE SPACES.    00531600
005317         10 DL1-ORGN-OPER-UNT-ID      PIC ZZZ9   VALUE SPACES.    00531700
005318         10 FILLER                    PIC X(01)  VALUE SPACES.    00531800
005319         10 DL1-DEST-OPER-UNT-ID      PIC ZZZ9.                   00531900
005320         10 FILLER                    PIC X(03)  VALUE SPACES.    00532000
005321         10 DL1-TRIP-ID               PIC ZZZZZZZZ9.              00532100
005322         10 DL1-TRIP-ID-X REDEFINES DL1-TRIP-ID.                  00532200
005323            15 DL1-NO-TRIP-ID         PIC X(09).                  00532300
005324         10 FILLER                    PIC X(05)  VALUE SPACES.    00532400
005325         10 DL1-SHIPT-UNT-ID          PIC ZZZZZZZZZZZZZZZZZ9.     00532500
005326         10 FILLER                    PIC X(02)  VALUE SPACES.    00532600
005327         10 DL1-PO-LNE-NBR            PIC ZZZ9.                   00532700
005328         10 FILLER                    PIC X(02)  VALUE SPACES.    00532800
005329         10 DL1-UPC-NBR               PIC ZZZZZZZZZZZZZZ9.        00532900
005330         10 FILLER                    PIC X(02)  VALUE SPACES.    00533000
005331         10 DL1-SHIPT-QTY             PIC ZZZZZ9.                 00533100
005332*        10 FILLER                    PIC X(35)  VALUE SPACES.    00533200
005333                                                                  00533300
005334     05  DL-LINE2.                                                00533400
005335         10 FILLER                    PIC X(79)  VALUE SPACES.    00533500
005336         10 DL2-PO-LNE-NBR            PIC ZZZ9.                   00533600
005337         10 FILLER                    PIC X(02)  VALUE SPACES.    00533700
005338         10 DL2-UPC-NBR               PIC ZZZZZZZZZZZZZZ9.        00533800
005339         10 FILLER                    PIC X(02)  VALUE SPACES.    00533900
005340         10 DL2-SHIPT-QTY             PIC ZZZZZ9.                 00534000
005341*        10 FILLER                    PIC X(35)  VALUE SPACES.    00534100
005342                                                                  00534200
005343 01 TOTAL-LINES.                                                  00534300
005344     05  TL-LINE1.                                                00534400
005345         10 FILLER                    PIC X(102)  VALUE SPACES.   00534500
005346         10 FILLER                    PIC X(06)  VALUE '------'.  00534600
005347     05  TL-LINE2.                                                00534700
005348         10 FILLER                    PIC X(99)  VALUE SPACES.    00534800
005349         10 FILLER                    PIC X(01)  VALUE '*'.       00534900
005350         10 FILLER                    PIC X(02)  VALUE SPACES.    00535000
005351         10 TL2-SHIPT-QTY-TOTAL       PIC ZZZZZ9.                 00535100
005352     05  TL-LINE3.                                                00535200
005353         10 FILLER                    PIC X(102)  VALUE SPACES.   00535300
005354         10 FILLER                    PIC X(06)  VALUE '======'.  00535400
005355     05  TL-LINE4.                                                00535500
005356         10 FILLER                    PIC X(86)   VALUE SPACES.   00535600
005357         10 FILLER                    PIC X(16)   VALUE           00535700
005358                                      'TOTAL SHPD QTY: '.         00535800
005359         10 TL4-SHIPT-QTY-GRAND-TOT   PIC ZZZZZ9.                 00535900
005360     05  TL-LINE5.                                                00536000
005361         10 FILLER                    PIC X(86)   VALUE SPACES.   00536100
005362         10 FILLER                    PIC X(16)   VALUE           00536200
005363                                      'TOTAL CRTN CNT: '.         00536300
005364         10 TL5-TOTAL-CRTN-QTY        PIC ZZZZZ9.                 00536400
005365*        10 FILLER                    PIC X(43)   VALUE SPACES.   00536500
005366                                                                  00536600
005367 01 BLANK-LINE.                                                   00536700
005368     05  BL-BLANK-LINE.                                           00536800
005369         10 FILLER                    PIC X(132)  VALUE SPACES.   00536900
005370                                                                  00537000
005371 01 NO-DATA-LINE.                                                 00537100
005372     05  ND-NO-DATA-LN.                                           00537200
005373         10 FILLER                    PIC X(38)  VALUE SPACES.    00537300
005374         10 FILLER                    PIC X(44)  VALUE            00537400
005375         '****** NO DATA FOUND FOR REQUESTED PO ******'.          00537500
005376 01 NO-ARCHIVE-PO-REQUEST.                                        00537600
005377     05  ND-NO-ARCH-PO-REQUESTED.                                 00537700
005378         10 FILLER                    PIC X(38)  VALUE SPACES.    00537800
005379         10 FILLER                    PIC X(44)  VALUE            00537900
005380         '*** NO ARCHIVE PURCHASE ORDERS REQUESTED ***'.          00538000
005381/                                                                 00538100
005382******************************************************************00538200
005383*  RECORD LAYOUT COPYBOOK                                         00538300
005384******************************************************************00538400
005385     COPY DPWS132.                                                00538500
005386/                                                                 00538600
005387******************************************************************00538700
005388*  DATE COPYBOOK                                                  00538800
005389******************************************************************00538900
005390     COPY SURD032.                                                00539000
005391/                                                                 00539100
005392******************************************************************00539200
005393*  LAYOUT ARCHIVE RECORD COMBINED REC A/B                         00539300
005394******************************************************************00539400
005395     COPY SURD038.                                                00539500
005396/                                                                 00539600
005397******************************************************************00539700
005398 PROCEDURE DIVISION.                                              00539800
005399******************************************************************00539900
005400                                                                  00540000
005500 0000-PROGRAM-MAINLINE.                                           00550000
005600                                                                  00560000
005700                                                                  00570000
005800     OPEN INPUT  INPUT-FILE                                       00580000
005900          OUTPUT OUTPUT-FILE                                      00590000
006000                                                                  00600000
006100     PERFORM 500-INITIALIZE.                                      00610000
006200     PERFORM 2000-PROCESS-INP-FILE.                               00620000
006300                                                                  00630000
006400     CLOSE INPUT-FILE                                             00640000
006500           OUTPUT-FILE                                            00650000
006600                                                                  00660000
006700                                                                  00670000
006800     STOP RUN.                                                    00680000
006900/                                                                 00690000
007000******************************************************************00700000
007100* INITIALZE PROGRAM VARIABLES.                                    00710000
007200******************************************************************00720000
007300 500-INITIALIZE.                                                  00730000
007400                                                                  00740000
007500     ACCEPT PV-TODAYS-DATE FROM DATE YYYYMMDD.                    00750000
007600     ACCEPT PV-TODAYS-TIME FROM TIME.                             00760000
007700     INITIALIZE  PV-PAGE-COUNT                                    00770000
007800                 PV-TK-PO-RCVR-COUNT.                             00780000
007900     MOVE 1                        TO PV-REPORT-COUNT.            00790000
008000     MOVE PV-TODAYS-DATE-MM        TO DP132-RUN-MONTH.            00800000
008100     MOVE PV-TODAYS-DATE-DD        TO DP132-RUN-DAY.              00810000
008200     MOVE PV-TODAYS-DATE-CCYY      TO DP132-RUN-YEAR.             00820000
008300     MOVE PV-TODAYS-TIME-HH        TO DP132-RUN-HOUR.             00830000
008400     MOVE PV-TODAYS-TIME-MM        TO DP132-RUN-MINUTE.           00840000
008500     MOVE PC-PROGRAM-NAME          TO DP132-PROGRAM-NAME.         00850000
008600                                                                  00860000
008700/                                                                 00870000
008800******************************************************************00880000
008900* READS RECORD FROM THE INPUT FILE                                00890000
009000******************************************************************00900000
009100 1000-READ-INPUT-FILE.                                            00910000
009200                                                                  00920000
009300     INITIALIZE SU038-EXTRACT-RECORD                              00930000
009400                                                                  00940000
009500     READ INPUT-FILE                                              00950000
009600          INTO SU038-EXTRACT-RECORD                               00960000
009700            AT END                                                00970000
009800               SET PS-EOF-INP             TO TRUE                 00980000
009900               MOVE 0                     TO PV-CURRENT-PO        00990000
010000               MOVE 0                     TO PV-CURRENT-REC-SEQ   01000000
010010               MOVE 0                     TO PV-CURRENT-SHIPT-ID  01001000
010020               MOVE 0                     TO PV-CURR-OPER-ID      01002000
010030               MOVE ZEROES                TO PV-CURR-REQ-DEST-ID  01003000
010040               MOVE SPACES                TO PV-CURR-REQ-DATE     01004000
010050                                             PV-CURR-REQ-TIME     01005000
010060                                             PV-CURRENT-TK        01006000
010070            NOT AT END                                            01007000
010080               SET PS-NOT-EOF-INP                                 01008000
010090                   PS-AT-LEAST-ONE-RECORD-YES TO TRUE             01009000
010100               ADD +1                     TO PV-RECORDS-READ      01010000
010200               MOVE SU038-PO-NBR          TO PV-CURRENT-PO        01020000
010300               MOVE SU038-REC-SEQ-NBR     TO PV-CURRENT-REC-SEQ   01030000
010400               MOVE SU038-SHIPT-UNT-ID    TO PV-CURRENT-SHIPT-ID  01040000
010500               MOVE SU038-TK-NBR          TO PV-CURRENT-TK        01050000
010510               MOVE SU038-TRIP-ID         TO PV-CURRENT-TRIP-ID   01051000
010520                                                                  01052000
010530               MOVE SU038-REQ-OPER-ID     TO PV-CURR-OPER-ID      01053000
010540               MOVE SU038-REQ-DEST-ID     TO PV-CURR-REQ-DEST-ID  01054000
010550               MOVE SU038-REQ-DATE        TO PV-CURR-REQ-DATE     01055000
010560               MOVE SU038-REQ-TIME        TO PV-CURR-REQ-TIME     01056000
010570     END-READ.                                                    01057000
010580/                                                                 01058000
010590******************************************************************01059000
010600*                                                                *01060000
010700******************************************************************01070000
010800 2000-PROCESS-INP-FILE.                                           01080000
010900                                                                  01090000
011000     PERFORM 1000-READ-INPUT-FILE.                                01100000
011100     MOVE PV-CURRENT-TK       TO PV-PREV-TK.                      01110000
011200     MOVE PV-CURRENT-PO       TO PV-PREV-PO.                      01120000
011300     MOVE PV-CURRENT-REC-SEQ  TO PV-PREV-REC-SEQ.                 01130000
011400     MOVE PV-CURRENT-SHIPT-ID TO PV-PREV-SHIPT-ID.                01140000
011500     MOVE PV-CURR-OPER-ID     TO PV-PREV-OPER-ID                  01150000
011600     MOVE PV-CURR-REQ-DEST-ID TO PV-PREV-REQ-DEST-ID              01160000
011700     MOVE PV-CURR-REQ-DATE    TO PV-PREV-REQ-DATE                 01170000
011800     MOVE PV-CURR-REQ-TIME    TO PV-PREV-REQ-TIME                 01180000
011900                                                                  01190000
012000     INITIALIZE PV-SHIPT-UNT-TOTAL                                01200000
012100                PV-TOTAL-CRTN-QTY                                 01210000
012110                PV-SHIPT-UNT-GRD-TOT.                             01211000
012120     IF PS-AT-LEAST-ONE-RECORD-NO                                 01212000
012130        MOVE 'TKNORQST'  TO  SU038-TK-NBR                         01213000
012140     END-IF                                                       01214000
012150                                                                  01215000
012160     PERFORM 9100-WRITE-RPT-HEADINGS.                             01216000
012170     PERFORM 9200-PRINT-DETAIL-LN1.                               01217000
012180                                                                  01218000
012190     PERFORM 3000-PROCESS-REQUEST                                 01219000
012200        UNTIL PS-EOF-INP.                                         01220000
012210                                                                  01221000
012220     ADD 6 TO PV-PRINTED-LINES                                    01222000
012230        GIVING PV-POS-PRINTED-LINES                               01223000
012240     IF PV-POS-PRINTED-LINES  > PC-MAX-LINES-PAGE                 01224000
012241        PERFORM 9100-WRITE-RPT-HEADINGS                           01224100
012242     END-IF.                                                      01224200
012243                                                                  01224300
012244     PERFORM 9500-PRINT-PO-TOTALS.                                01224400
012245                                                                  01224500
012246/                                                                 01224600
012247******************************************************************01224700
012248*                                                                *01224800
012249******************************************************************01224900
012250 3000-PROCESS-REQUEST.                                            01225000
012260                                                                  01226000
012270     PERFORM 1000-READ-INPUT-FILE.                                01227000
012280                                                                  01228000
012290     IF (PV-CURRENT-TK       = PV-PREV-TK)      AND               01229000
012300        (PV-CURRENT-PO       = PV-PREV-PO)      AND               01230000
012400        (PV-CURRENT-REC-SEQ  = PV-PREV-REC-SEQ) AND               01240000
012500        (PV-CURRENT-SHIPT-ID = PV-PREV-SHIPT-ID)                  01250000
012510           ADD +1              TO PV-TK-PO-RCVR-COUNT             01251000
012520           PERFORM 9300-PRINT-DETAIL-LN2                          01252000
012521     ELSE                                                         01252100
012522        IF (PV-CURRENT-TK       = PV-PREV-TK)      AND            01252200
012523           (PV-CURRENT-PO       = PV-PREV-PO)      AND            01252300
012524           (PV-CURRENT-REC-SEQ  = PV-PREV-REC-SEQ) AND            01252400
012525           (PV-CURRENT-SHIPT-ID NOT = PV-PREV-SHIPT-ID)           01252500
012526              MOVE PV-CURRENT-SHIPT-ID TO PV-PREV-SHIPT-ID        01252600
012527              ADD +1              TO PV-TK-PO-RCVR-COUNT          01252700
012528                                                                  01252800
012529              ADD 3 TO PV-PRINTED-LINES                           01252900
012530                 GIVING PV-POS-PRINTED-LINES                      01253000
012531                                                                  01253100
012532              IF PV-POS-PRINTED-LINES  > PC-MAX-LINES-PAGE        01253200
012533                 PERFORM 9100-WRITE-RPT-HEADINGS                  01253300
012534              END-IF                                              01253400
012535                                                                  01253500
012536              PERFORM 9400-PRINT-SHPD-ID-TOTAL                    01253600
012537              INITIALIZE PV-SHIPT-UNT-TOTAL                       01253700
012538                                                                  01253800
012539              PERFORM 9200-PRINT-DETAIL-LN1                       01253900
012540                                                                  01254000
012541        ELSE                                                      01254100
012542           IF PS-EOF-INP                                          01254200
012543              CONTINUE                                            01254300
012544           ELSE                                                   01254400
012545              ADD 6 TO PV-PRINTED-LINES                           01254500
012546                 GIVING PV-POS-PRINTED-LINES                      01254600
012547              IF PV-POS-PRINTED-LINES  > PC-MAX-LINES-PAGE        01254700
012548                 SET PS-PROCESS-PREV-RECORD-YES TO TRUE           01254800
012549                 PERFORM 9100-WRITE-RPT-HEADINGS                  01254900
012550                 SET PS-PROCESS-PREV-RECORD-NO  TO TRUE           01255000
012551              END-IF                                              01255100
012552                                                                  01255200
012553              PERFORM 9500-PRINT-PO-TOTALS                        01255300
012554                                                                  01255400
012555              ADD +1   TO PV-REPORT-COUNT                         01255500
012556              MOVE 0   TO PV-PAGE-COUNT                           01255600
012557                                                                  01255700
012558              PERFORM 9100-WRITE-RPT-HEADINGS                     01255800
012559                                                                  01255900
012560              INITIALIZE PV-SHIPT-UNT-GRD-TOT                     01256000
012561                         PV-TOTAL-CRTN-QTY                        01256100
012562                         PV-SHIPT-UNT-TOTAL                       01256200
012563                         PV-TK-PO-RCVR-COUNT                      01256300
012564                                                                  01256400
012565              PERFORM 9200-PRINT-DETAIL-LN1                       01256500
012566           END-IF                                                 01256600
012567        END-IF                                                    01256700
012568     END-IF.                                                      01256800
012569/                                                                 01256900
012570******************************************************************01257000
012571* WRITES REPORT HEADINGS                                         *01257100
012572******************************************************************01257200
012580 9100-WRITE-RPT-HEADINGS.                                         01258000
012590                                                                  01259000
012600     INITIALIZE PV-PRINTED-LINES                                  01260000
012700     ADD +1                          TO  PV-PAGE-COUNT.           01270000
012710     IF PS-PROCESS-PREV-RECORD-YES OR PS-EOF-INP                  01271002
012800       MOVE PV-PREV-TK                 TO  HL2-REQ-TK-NBR         01280000
012900       MOVE PV-PREV-REQ-YY             TO  HL3-REQ-YY             01290000
013000       MOVE PV-PREV-REQ-MM             TO  HL3-REQ-MM             01300000
013100       MOVE PV-PREV-REQ-DD             TO  HL3-REQ-DD             01310000
013200       MOVE PV-PREV-REQ-TIME           TO  HL4-REQ-TIME           01320000
013300       MOVE PV-PREV-PO                 TO  HL2-REQUEST-PO         01330000
013400       MOVE PV-PREV-REC-SEQ            TO  HL2-REQUEST-REC        01340000
013500       MOVE PV-PREV-OPER-ID            TO  HL2-REQUEST-DC         01350000
013510     ELSE                                                         01351000
013600       MOVE ZEROES                     TO  HL2-REQUEST-STR        01360000
013700       MOVE PV-CURRENT-TK              TO  PV-PREV-TK             01370000
013800                                           HL2-REQ-TK-NBR         01380000
013900       MOVE PV-CURRENT-PO              TO  PV-PREV-PO             01390000
014000                                           HL2-REQUEST-PO         01400000
014100       MOVE PV-CURRENT-REC-SEQ         TO  PV-PREV-REC-SEQ        01410000
014200                                           HL2-REQUEST-REC        01420000
014300                                                                  01430000
014400       MOVE PV-CURR-OPER-ID            TO PV-PREV-OPER-ID         01440000
014500                                          HL2-REQUEST-DC          01450000
014510     END-IF                                                       01451000
014520                                                                  01452000
014600     MOVE PV-CURR-REQ-YY             TO  HL3-REQ-YY               01460000
014700     MOVE PV-CURR-REQ-MM             TO  HL3-REQ-MM               01470000
014800     MOVE PV-CURR-REQ-DD             TO  HL3-REQ-DD               01480000
014900     MOVE PV-CURR-REQ-TIME           TO  HL4-REQ-TIME             01490000
015000     MOVE PV-CURR-REQ-DATE           TO  PV-PREV-REQ-DATE         01500001
015100     MOVE PV-CURR-REQ-TIME           TO  PV-PREV-REQ-TIME         01510001
015200     MOVE PV-CURRENT-SHIPT-ID        TO  PV-PREV-SHIPT-ID         01520000
015500                                                                  01550000
015600     MOVE PV-PAGE-COUNT              TO  DP132-PAGE-NUMBER.       01560000
015700     MOVE PV-REPORT-COUNT            TO  DP132-REPORT-NUMBER.     01570000
015800                                                                  01580000
015900     WRITE OUTPUT-RECORD                                          01590000
016000       FROM DP132-STANDRD-HEADER-132-COLS                         01600000
016100         AFTER ADVANCING PAGE.                                    01610000
016200                                                                  01620000
016300     WRITE OUTPUT-RECORD                                          01630000
016310       FROM  HL-REPORT-HEADINGS1                                  01631000
016320         AFTER ADVANCING 2 LINE.                                  01632000
016330                                                                  01633000
016340     WRITE OUTPUT-RECORD                                          01634000
016350       FROM  HL-REPORT-HEADINGS2A                                 01635000
016360         AFTER ADVANCING 2 LINE.                                  01636000
016361                                                                  01636100
016362     WRITE OUTPUT-RECORD                                          01636200
016363       FROM  HL-REPORT-HEADINGS2                                  01636300
016364         AFTER ADVANCING 1 LINE.                                  01636400
016365                                                                  01636500
016366     WRITE OUTPUT-RECORD                                          01636600
016367       FROM  HL-REPORT-HEADINGS3                                  01636700
016368         AFTER ADVANCING 1 LINE.                                  01636800
016369                                                                  01636900
016370     WRITE OUTPUT-RECORD                                          01637000
016380       FROM  HL-REPORT-HEADINGS4                                  01638000
016390         AFTER ADVANCING 1 LINE.                                  01639000
016391                                                                  01639100
016392     WRITE OUTPUT-RECORD                                          01639200
016393       FROM  HL-REPORT-HEADINGS5                                  01639300
016394         AFTER ADVANCING 2 LINE.                                  01639400
016395                                                                  01639500
016396     WRITE OUTPUT-RECORD                                          01639600
016397       FROM  HL-REPORT-HEADINGS6                                  01639700
016398         AFTER ADVANCING 1 LINE.                                  01639800
016399                                                                  01639900
016400     WRITE OUTPUT-RECORD                                          01640000
016410       FROM  HL-REPORT-HEADINGS7                                  01641000
016420         AFTER ADVANCING 1 LINE.                                  01642000
016430                                                                  01643000
016440     WRITE OUTPUT-RECORD                                          01644000
016450       FROM  HL-REPORT-HEADINGS8                                  01645000
016460         AFTER ADVANCING 1 LINE.                                  01646000
016470                                                                  01647000
016480     WRITE OUTPUT-RECORD                                          01648000
016490       FROM  HL-REPORT-HEADINGS9                                  01649000
016491         AFTER ADVANCING 1 LINE.                                  01649100
016492                                                                  01649200
016493/                                                                 01649300
016494******************************************************************01649400
016495*                                                                 01649500
016496******************************************************************01649600
016497 9200-PRINT-DETAIL-LN1.                                           01649700
016498     ADD +1                      TO  PV-PRINTED-LINES.            01649800
016499     IF SU038-TRIP-ID = ZEROS                                     01649900
016500        MOVE ' NOT SCND' TO DL1-NO-TRIP-ID                        01650000
016600     ELSE                                                         01660000
016700        ADD SU038-SHPD-QTY          TO  PV-SHIPT-UNT-TOTAL        01670000
016800        ADD +1                      TO  PV-TOTAL-CRTN-QTY         01680000
016900        ADD SU038-SHPD-QTY          TO  PV-SHIPT-UNT-GRD-TOT      01690000
016910        MOVE SU038-TRIP-ID          TO  DL1-TRIP-ID               01691000
016920     END-IF                                                       01692000
016930                                                                  01693000
016931     MOVE SU038-PO-NBR           TO  DL1-PO-NBR.                  01693100
016932     MOVE SU038-REC-SEQ-NBR      TO  DL1-REC-SEQ-NBR.             01693200
016933     MOVE SU038-ORGN-OPER-UNT-ID TO  DL1-ORGN-OPER-UNT-ID.        01693300
016934     MOVE SU038-DEST-OPER-UNT-ID TO  DL1-DEST-OPER-UNT-ID.        01693400
016935     MOVE SU038-SHIPT-UNT-ID     TO  DL1-SHIPT-UNT-ID.            01693500
016936     MOVE SU038-TRN-LNE-NBR      TO  DL1-PO-LNE-NBR.              01693600
016937     MOVE SU038-UPC-NBR          TO  DL1-UPC-NBR.                 01693700
016938     MOVE SU038-SHPD-QTY         TO  DL1-SHIPT-QTY.               01693800
016939                                                                  01693900
016940     IF PV-PRINTED-LINES > PC-MAX-LINES-PAGE                      01694000
016941        PERFORM 9100-WRITE-RPT-HEADINGS                           01694100
016942     END-IF.                                                      01694200
016943                                                                  01694300
016944                                                                  01694400
016945     IF SU038-TRIP-ID = ZEROS AND                                 01694500
016946        PV-TK-PO-RCVR-COUNT = 0                                   01694600
016947          PERFORM 9600-PRINT-NO-DATA-RECORD                       01694700
016948     ELSE                                                         01694800
016949        MOVE ZEROES   TO PV-TK-PO-RCVR-COUNT                      01694900
016950        WRITE OUTPUT-RECORD                                       01695000
016951           FROM DL-LINE1                                          01695100
016952           AFTER ADVANCING 1 LINE                                 01695200
016953     END-IF.                                                      01695300
016954/                                                                 01695400
016955******************************************************************01695500
016956*                                                                 01695600
016957******************************************************************01695700
016958 9300-PRINT-DETAIL-LN2.                                           01695800
016959     ADD +1                      TO  PV-PRINTED-LINES.            01695900
016960     IF SU038-TRIP-ID = ZEROS                                     01696000
016970        CONTINUE                                                  01697000
016980     ELSE                                                         01698000
016990        ADD SU038-SHPD-QTY       TO  PV-SHIPT-UNT-TOTAL           01699000
017000        ADD SU038-SHPD-QTY       TO  PV-SHIPT-UNT-GRD-TOT         01700000
017100     END-IF                                                       01710000
017200                                                                  01720000
017300*    ADD SU038-SHPD-QTY          TO  PV-SHIPT-UNT-TOTAL.          01730000
017400*    ADD SU038-SHPD-QTY          TO  PV-SHIPT-UNT-GRD-TOT.        01740000
017500                                                                  01750000
017600     MOVE SU038-TRN-LNE-NBR      TO  DL2-PO-LNE-NBR.              01760000
017700     MOVE SU038-UPC-NBR          TO  DL2-UPC-NBR.                 01770000
017800     MOVE SU038-SHPD-QTY         TO  DL2-SHIPT-QTY.               01780000
017900                                                                  01790000
018000     IF PV-PRINTED-LINES > PC-MAX-LINES-PAGE                      01800000
018100        PERFORM 9100-WRITE-RPT-HEADINGS                           01810000
018200     END-IF.                                                      01820000
018300                                                                  01830000
018400     WRITE OUTPUT-RECORD                                          01840000
018500        FROM DL-LINE2                                             01850000
018600        AFTER ADVANCING 1 LINE.                                   01860000
018700/                                                                 01870000
018800******************************************************************01880000
018900*                                                                 01890000
019000******************************************************************01900000
019100 9400-PRINT-SHPD-ID-TOTAL.                                        01910000
019200     ADD +3                       TO PV-PRINTED-LINES.            01920000
019300     MOVE PV-SHIPT-UNT-TOTAL      TO TL2-SHIPT-QTY-TOTAL.         01930000
019400                                                                  01940000
019500     WRITE OUTPUT-RECORD                                          01950000
019600        FROM TL-LINE1                                             01960000
019700        AFTER ADVANCING 1 LINE.                                   01970000
019710                                                                  01971000
019720     WRITE OUTPUT-RECORD                                          01972000
019730        FROM TL-LINE2                                             01973000
019740        AFTER ADVANCING 1 LINE.                                   01974000
019750                                                                  01975000
019760     WRITE OUTPUT-RECORD                                          01976000
019761        FROM BL-BLANK-LINE                                        01976100
019762        AFTER ADVANCING 1 LINE.                                   01976200
019763                                                                  01976300
019764/                                                                 01976400
019765******************************************************************01976500
019766*                                                                 01976600
019767******************************************************************01976700
019768 9500-PRINT-PO-TOTALS.                                            01976800
019769     ADD +6                       TO PV-PRINTED-LINES.            01976900
019770     MOVE PV-SHIPT-UNT-TOTAL      TO TL2-SHIPT-QTY-TOTAL.         01977000
019780     MOVE PV-SHIPT-UNT-GRD-TOT    TO TL4-SHIPT-QTY-GRAND-TOT.     01978000
019790     MOVE PV-TOTAL-CRTN-QTY       TO TL5-TOTAL-CRTN-QTY.          01979000
019800                                                                  01980000
019900     WRITE OUTPUT-RECORD                                          01990000
020000        FROM TL-LINE1                                             02000000
020100        AFTER ADVANCING 1 LINE.                                   02010000
020200                                                                  02020000
020300     WRITE OUTPUT-RECORD                                          02030000
020400        FROM TL-LINE2                                             02040000
020500        AFTER ADVANCING 1 LINE.                                   02050000
020600                                                                  02060000
020700     WRITE OUTPUT-RECORD                                          02070000
020800        FROM BL-BLANK-LINE                                        02080000
020900        AFTER ADVANCING 1 LINE.                                   02090000
021000                                                                  02100000
021100     WRITE OUTPUT-RECORD                                          02110000
021200        FROM TL-LINE3                                             02120000
021300        AFTER ADVANCING 1 LINE.                                   02130000
021400                                                                  02140000
021500     WRITE OUTPUT-RECORD                                          02150000
021600        FROM TL-LINE4                                             02160000
021610        AFTER ADVANCING 1 LINE.                                   02161000
021620     WRITE OUTPUT-RECORD                                          02162000
021630        FROM TL-LINE5                                             02163000
021640        AFTER ADVANCING 1 LINE.                                   02164000
021650/                                                                 02165000
021660******************************************************************02166000
021670*                                                                 02167000
021680******************************************************************02168000
021690 9600-PRINT-NO-DATA-RECORD.                                       02169000
021700                                                                  02170000
021800     INITIALIZE PV-TOTAL-CRTN-QTY                                 02180000
021900                                                                  02190000
022000     WRITE OUTPUT-RECORD                                          02200000
022100        FROM BL-BLANK-LINE                                        02210000
022200        AFTER ADVANCING 1 LINE.                                   02220000
022300                                                                  02230000
022400     IF PS-AT-LEAST-ONE-RECORD-NO                                 02240000
022410       WRITE OUTPUT-RECORD                                        02241000
022420          FROM NO-ARCHIVE-PO-REQUEST                              02242000
022430          AFTER ADVANCING 1 LINE                                  02243000
022440     ELSE                                                         02244000
022450       WRITE OUTPUT-RECORD                                        02245000
022460          FROM ND-NO-DATA-LN                                      02246000
022470          AFTER ADVANCING 1 LINE                                  02247000
022480     END-IF.                                                      02248000
022490                                                                  02249000
022500/                                                                 02250000
