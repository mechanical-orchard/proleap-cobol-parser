000100 IDENTIFICATION DIVISION.                                                 
000200 PROGRAM-ID.     DSKUT008.                                                
000300 AUTHOR.         RICHARD MOORE.                                           
000400 DATE-WRITTEN.   12/30/98.                                                
000500 DATE-COMPILED.                                                           
000600*                                                           *             
000700*    SELECT GROUP3 DATA                                     *             
000800*                                                           *             
000800* CHANGE LOG:                                               *             
001300*                                                           *             
001400* 08/10/2022  JEAN KURK                  CHG0272895         *             
001400*             REMOVE TABLES TIMBKVS, TIMKBUP, TAUBKVS,      *             
001400*             TAUBKUP, TIMRCVS, TIMRCUP, TAURCUP, TAURCVS   *             
004510* 04/10/2022  JEAN KURK                  CHG0286696         *             
001400*             RECOMPILE FOR UPDATED COPYBOOKS               *             
001300*                                                           *             
000900 ENVIRONMENT DIVISION.                                                    
001000                                                                          
001100 INPUT-OUTPUT SECTION.                                                    
001200                                                                          
001300 FILE-CONTROL.                                                            
001400                                                                          
001500     SELECT PO-NBR-FILE                                                   
001600         ASSIGN         TO UT-S-PO01.                                     
001700     SELECT TBLE-FILE                                                     
001800         ASSIGN         TO UT-S-TBL01.                                    
001900     SELECT CONTROL-FILE                                                  
002000         ASSIGN         TO UT-S-CTL01.                                    
002100                                                                          
002200 DATA DIVISION.                                                           
002300                                                                          
002400 FILE SECTION.                                                            
002500     COPY DSFD001.                                                        
002600                                                                          
002700 WORKING-STORAGE SECTION.                                                 
002800 01  PV-OTHER-CRAPOLA.                                                    
002900     05  PV-WRITE-COUNT               PIC S9(9) COMP-3 VALUE              
003000                                                       ZERO.              
003100     05  PV-WHEN-COMPILED.                                                
003200         10  PV-COMPILE-DATE          PIC X(08).                          
003300         10  PV-COMPILE-TIME          PIC X(08).                          
003400     05  PV-DISP-NBR-1                PIC 9(09).                          
003500     05  PV-DISP-NBR-2                PIC 9(09).                          
003600     05  PV-DISP-NBR-3                PIC 9(09).                          
003700     05  PV-PO-X                      PIC X(09).                          
003800     05  PV-PO-NBR REDEFINES PV-PO-X  PIC 9(09).                          
003900     05  PS-CONTAINER-SPLIT-SW        PIC X(01) VALUE 'P'.                
004000         88  PS-PO-SPLIT-YES          VALUE 'P'.                          
004100         88  PS-CONTAINER-SPLIT-YES   VALUE 'C'.                          
004200/                                                                         
004300*    STANDARD OUTPUT                                                      
004400     COPY DSRD003.                                                        
004500                                                                          
004600     COPY DSWS008.                                                        
004700     COPY DSWS009.                                                        
004800     COPY DSWS010.                                                        
004900     COPY DSRD002.                                                        
005000     COPY DPWS004.                                                        
005100/                                                                         
005200*    DCLGENS FOR PROD TO TEST UTILITIES                                   
005300     COPY DSWS011.                                                        
005400/                                                                         
005500*****************************************************************         
005600     EXEC SQL                                                             
005700       DECLARE IMCNPO-CSR CURSOR FOR                                      
005800         SELECT                                                           
005900       CONTNR_ID                                                          
006000      ,CONTNR_SEQ_NBR                                                     
006100      ,PO_NBR                                                             
006200      ,CSTM_ENTR_ID                                                       
006300      ,MSTR_BOL_NBR                                                       
006400      ,HSE_BOL_NBR                                                        
006500      ,LTR_OF_CR_NBR                                                      
006600      ,PO_RCVD_DELY_TMST                                                  
006700      ,PO_C_O_PROD_CDE                                                    
006800      ,PO_CART_CNT                                                        
006900      ,PO_CBMT_QTY                                                        
007000      ,PO_WT_KGRM_QTY                                                     
007100      ,PO_UNT_QTY                                                         
007200      ,CRE_BY_USR_ID                                                      
007300      ,CRE_TMST                                                           
007400      ,LAST_UPD_BY_USR_ID                                                 
007500      ,LAST_UPD_TMST                                                      
007600      ,EXTL_REF_NBR                                                       
007700      ,BKR_FRGT_RLSE_CDE                                                  
007800      ,DO_RCVD_CDE                                                        
007900      ,CONTNR_PU_CDE                                                      
008000      ,ACTL_POE_DELY_CDE                                                  
008100      ,DVN_CDE                                                            
008200      ,DCONSLR_RET_CDE                                                    
008300      ,SPLT_XMIT_CDE                                                      
008400      ,DOC_RCVD_ORGN_TMST                                                 
008400      ,DCONSLR_DELY_CDE                                                   
008500         FROM                                                             
008600             TIMCNPO                                                      
008700         WHERE PO_NBR           = :HOLD-PO-NBR                            
008800     END-EXEC.                                                            
008900                                                                          
009000/                                                                         
009100**************************************************************            
009200     EXEC SQL                                                             
009300       DECLARE TIMCNRL-CSR CURSOR FOR                                     
009400         SELECT                                                           
009500             CONTNR_ID                                                    
009600            ,CONTNR_SEQ_NBR                                               
009700            ,PO_NBR                                                       
009800            ,DCONSLR_RLSE_CDE                                             
009900            ,DCONSLR_REQR_DTE                                             
010000            ,DCONSLR_ACTL_DTE                                             
010100            ,DCONSLR_ACTL_TM                                              
010200            ,CRE_TMST                                                     
010300            ,CRE_BY_UID                                                   
010400            ,LAST_UPD_TMST                                                
010500            ,LAST_UPD_BY_UID                                              
010600            ,DCONSLR_ENT_ID                                               
010700         FROM                                                             
010800             TIMCNRL                                                      
010900         WHERE CONTNR_ID    =  :IMCNPO-CONTNR-ID                          
011000         AND CONTNR_SEQ_NBR =  :IMCNPO-CONTNR-SEQ-NBR                     
011100         AND PO_NBR         =  :IMCNPO-PO-NBR                             
011200     END-EXEC.                                                            
011300/                                                                         
011400******************************************************************        
011500     EXEC SQL                                                             
011600       DECLARE IMBKPO_CSR CURSOR FOR                                      
011700         SELECT                                                           
011800             PO_NBR                                                       
011900            ,PO_BKG_SEQ_NBR                                               
012000            ,PO_BKG_DELY_TMST                                             
012100            ,EXTL_REF_NBR                                                 
012200            ,ORGN_SHPD_FR_CDE                                             
012300            ,CONSLR_SCAC_ID                                               
012400            ,IMPRT_TRIP_ID                                                
012500            ,DPRTR_TMST                                                   
012600            ,POE_DELY_TMST                                                
012700            ,CARR_SCAC_ID                                                 
012800            ,FOB_CDE                                                      
012900            ,IMPRT_VEH_NM                                                 
013000            ,TRIP_TYP_CDE                                                 
013100            ,DEST_POE_CDE                                                 
013200            ,C_O_PROD_CDE                                                 
013300            ,PROD_FCTRY_NM                                                
013400            ,PO_CART_CNT                                                  
013500            ,PO_CBMT_QTY                                                  
013600            ,PO_WT_KGRM_QTY                                               
013700            ,PO_UNT_QTY                                                   
013800            ,PO_EXC_APVL_CDE                                              
013900            ,PO_EXC_APVL_USR_ID                                           
014000            ,PO_EXC_APVL_TMST                                             
014100            ,PO_EXC_RSN_DESC                                              
014200            ,EST_LBD_NM                                                   
014300            ,EST_LBD_TMST                                                 
014400            ,SHIPT_BKG_TMST                                               
014500            ,VOY_CHG_RSN_DESC                                             
014600            ,DAT_SRC_ENT_ID                                               
014700            ,CRE_BY_USR_ID                                                
014800            ,CRE_TMST                                                     
014900            ,LAST_UPD_BY_USR_ID                                           
015000            ,LAST_UPD_TMST                                                
015100         FROM                                                             
015200             TIMBKPO                                                      
015300         WHERE PO_NBR        = :HOLD-PO-NBR                               
015400     END-EXEC.                                                            
015500                                                                          
015600/                                                                         
015700******************************************************************        
015800*    EXEC SQL                                                             
015900*      DECLARE IMBKVS_CSR CURSOR FOR                                      
016000*        SELECT                                                           
016100*            PO_NBR                                                       
016200*           ,PO_BKG_SEQ_NBR                                               
016300*           ,VS_NBR                                                       
016400*           ,HTS_ID                                                       
016500*           ,VS_CART_CNT                                                  
016600*           ,VS_CBMT_QTY                                                  
016700*           ,VS_WT_KGRM_QTY                                               
016800*           ,VS_UNT_QTY                                                   
016900*           ,QTA_CTG_IND                                                  
017000*           ,CRE_BY_USR_ID                                                
017100*           ,CRE_TMST                                                     
017200*           ,LAST_UPD_BY_USR_ID                                           
017300*           ,LAST_UPD_TMST                                                
017400*        FROM                                                             
017500*            TIMBKVS                                                      
017600*        WHERE PO_NBR        = :HOLD-PO-NBR                               
017700*    END-EXEC.                                                            
017800                                                                          
017900/                                                                         
018000******************************************************************        
018100*    EXEC SQL                                                             
018200*      DECLARE IMBKUP_CSR CURSOR FOR                                      
018300*        SELECT                                                           
018400*            PO_NBR                                                       
018500*           ,PO_BKG_SEQ_NBR                                               
018600*           ,VS_NBR                                                       
018700*           ,UPC_NBR                                                      
018800*           ,UPC_CART_CNT                                                 
018900*           ,UPC_CBMT_QTY                                                 
019000*           ,UPC_WT_KGRM_QTY                                              
019100*           ,UPC_UNT_QTY                                                  
019200*           ,CRE_BY_USR_ID                                                
019300*           ,CRE_TMST                                                     
019400*           ,LAST_UPD_BY_USR_ID                                           
019500*           ,LAST_UPD_TMST                                                
019600*        FROM                                                             
019700*            TIMBKUP                                                      
019800*        WHERE PO_NBR        = :HOLD-PO-NBR                               
019900*    END-EXEC.                                                            
020000                                                                          
020100/                                                                         
020200******************************************************************        
020300     EXEC SQL                                                             
020400       DECLARE IMRCPO_CSR CURSOR FOR                                      
020500         SELECT                                                           
020600             PO_NBR                                                       
020700            ,PO_RCVD_SEQ_NBR                                              
020800            ,PO_RCVD_DELY_TMST                                            
020900            ,EXTL_REF_NBR                                                 
021000            ,ORGN_SHPD_FR_CDE                                             
021100            ,CONSLR_SCAC_ID                                               
021200            ,IMPRT_TRIP_ID                                                
021300            ,DPRTR_TMST                                                   
021400            ,POE_DELY_TMST                                                
021500            ,CARR_SCAC_ID                                                 
021600            ,FOB_CDE                                                      
021700            ,IMPRT_VEH_NM                                                 
021800            ,TRIP_TYP_CDE                                                 
021900            ,DEST_POE_CDE                                                 
022000            ,C_O_PROD_CDE                                                 
022100            ,PROD_FCTRY_NM                                                
022200            ,PO_CART_CNT                                                  
022300            ,PO_CBMT_QTY                                                  
022400            ,PO_WT_KGRM_QTY                                               
022500            ,PO_UNT_QTY                                                   
022600            ,PO_EXC_APVL_CDE                                              
022700            ,PO_EXC_APVL_USR_ID                                           
022800            ,PO_EXC_APVL_TMST                                             
022900            ,PO_EXC_RSN_DESC                                              
023000            ,EST_LBD_NM                                                   
023100            ,EST_LBD_TMST                                                 
023200            ,VOY_CHG_RSN_DESC                                             
023300            ,DAT_SRC_ENT_ID                                               
023400            ,CRE_BY_USR_ID                                                
023500            ,CRE_TMST                                                     
023600            ,LAST_UPD_BY_USR_ID                                           
023700            ,LAST_UPD_TMST                                                
023800         FROM                                                             
023900             TIMRCPO                                                      
024000         WHERE PO_NBR        = :HOLD-PO-NBR                               
024100     END-EXEC.                                                            
024200                                                                          
024300/                                                                         
024400******************************************************************        
024500*    EXEC SQL                                                             
024600*      DECLARE IMRCUP_CSR CURSOR FOR                                      
024700*        SELECT                                                           
024800*            PO_NBR                                                       
024900*           ,PO_RCVD_SEQ_NBR                                              
025000*           ,VS_NBR                                                       
025100*           ,UPC_NBR                                                      
025200*           ,UPC_CART_CNT                                                 
025300*           ,UPC_CBMT_QTY                                                 
025400*           ,UPC_WT_KGRM_QTY                                              
025500*           ,UPC_UNT_QTY                                                  
025600*           ,CRE_BY_USR_ID                                                
025700*           ,CRE_TMST                                                     
025800*           ,LAST_UPD_BY_USR_ID                                           
025900*           ,LAST_UPD_TMST                                                
026000*        FROM                                                             
026100*            TIMRCUP                                                      
026200*        WHERE PO_NBR        = :HOLD-PO-NBR                               
026300*    END-EXEC.                                                            
026400                                                                          
026500/                                                                         
026600******************************************************************        
026700*    EXEC SQL                                                             
026800*      DECLARE IMRCVS_CSR CURSOR FOR                                      
026900*        SELECT                                                           
027000*            PO_NBR                                                       
027100*           ,PO_RCVD_SEQ_NBR                                              
027200*           ,VS_NBR                                                       
027300*           ,HTS_ID                                                       
027400*           ,VS_CART_CNT                                                  
027500*           ,VS_CBMT_QTY                                                  
027600*           ,VS_WT_KGRM_QTY                                               
027700*           ,VS_UNT_QTY                                                   
027800*           ,QTA_CTG_IND                                                  
027900*           ,CRE_BY_USR_ID                                                
028000*           ,CRE_TMST                                                     
028100*           ,LAST_UPD_BY_USR_ID                                           
028200*           ,LAST_UPD_TMST                                                
028300*        FROM                                                             
028400*            TIMRCVS                                                      
028500*        WHERE PO_NBR        = :HOLD-PO-NBR                               
028600*    END-EXEC.                                                            
028700                                                                          
028800/                                                                         
028900******************************************************************        
029000     EXEC SQL                                                             
029100       DECLARE IMCNTK-CSR CURSOR FOR                                      
029200         SELECT                                                           
029300             CONTNR_ID                                                    
029400            ,CONTNR_SEQ_NBR                                               
029500            ,CONSLR_SCAC_ID                                       ULT     
029600            ,MOM_IMPRT_TRIP_ID                                    ULT     
029700            ,MOM_DPRTR_TMST                                       ULT     
029800            ,MOM_POE_DELY_TMST                                    ULT     
029900            ,MOM_CARR_SCAC_ID                                     ULT     
030000            ,MOM_FOB_CDE                                          ULT     
030100            ,MOM_IMPRT_VEH_NM                                     ULT     
030200            ,MOM_TRIP_TYP_CDE                                     ULT     
030300            ,MOM_DEST_POE_CDE                                     ULT     
030400            ,FDR_IMPRT_TRIP_ID                                    ULT     
030500            ,FDR_DPRTR_TMST                                       ULT     
030600            ,FDR_POE_DELY_TMST                                    ULT     
030700            ,FDR_CARR_SCAC_ID                                     ULT     
030800            ,FDR_FOB_CDE                                          ULT     
030900            ,FDR_IMPRT_VEH_NM                                     ULT     
031000            ,FDR_TRIP_TYP_CDE                                     ULT     
031100            ,FDR_DEST_POE_CDE                                     ULT     
031200            ,SIZE_CDE                                             ULT     
031300            ,CART_CNT                                             ULT     
031400            ,CBMT_QTY                                             ULT     
031500            ,WT_KGRM_QTY                                          ULT     
031600            ,UNT_QTY                                              ULT     
031700            ,ORGN_SHPD_FR_CDE                                     ULT     
031800            ,ORGN_SHPD_TO_CDE                                     ULT     
031900            ,EST_LBD_NM                                           ULT     
032000            ,EST_LBD_TMST                                         ULT     
032100            ,RISU_DO_RSN_CDE                                      ULT     
032200            ,BKR_FRGT_RLSE_TMST                                   ULT     
032300            ,DO_TO_DCONSLR_TMST                                   ULT     
032400            ,DO_RCVD_TMST                                         ULT     
032500            ,CONTNR_PU_TMST                                       ULT     
032600            ,DAT_SRC_ENT_ID                                       ULT     
032700            ,CRE_BY_USR_ID                                                
032800            ,CRE_TMST                                                     
032900            ,LAST_UPD_BY_USR_ID                                   ULT     
033000            ,LAST_UPD_TMST                                        ULT     
033100            ,ACTL_POE_DELY_TMST                                   ULT     
033200            ,ACTL_DEST_POE_CDE                                    ULT     
033300            ,ACTL_LBD_NM                                          ULT     
033400            ,ACTL_LBD_TMST                                        ULT     
033500            ,DVN_TMST                                             ULT     
033600            ,DCONSLR_SCAC_ID                                      ULT     
033700            ,DCONSLR_RET_TMST                                     ULT     
033800            ,MOM_POL_CDE                                          ULT     
033900            ,FDR_POL_CDE                                          ULT     
034000            ,MOM_POR_CDE                                          ULT     
034100            ,FDR_POR_CDE                                          ULT     
034100            ,DCONSLR_DELY_TMST                                    ULT     
034200         FROM                                                             
034300             TIMCNTK                                                      
034400         WHERE                                                            
034500             CONTNR_ID       = :HOLD-CONTNR-ID                            
034600         AND                                                              
034700             CONTNR_SEQ_NBR  = :HOLD-CONTNR-SEQ-NBR                       
034800     END-EXEC.                                                            
034900/                                                                         
035000******************************************************************        
035100     EXEC SQL                                                             
035200       DECLARE IMCNUP-CSR CURSOR FOR                                      
035300         SELECT                                                           
035400             CONTNR_ID                                                    
035500            ,CONTNR_SEQ_NBR                                               
035600            ,PO_NBR                                                       
035700            ,VS_NBR                                                       
035800            ,UPC_NBR                                                      
035900            ,PO_LNE_NBR                                                   
036000            ,UPC_CART_CNT                                                 
036100            ,UPC_CBMT_QTY                                                 
036200            ,UPC_WT_KGRM_QTY                                              
036300            ,UPC_UNT_QTY                                                  
036400            ,CRE_BY_USR_ID                                                
036500            ,CRE_TMST                                                     
036600            ,LAST_UPD_BY_USR_ID                                           
036700            ,LAST_UPD_TMST                                                
036800            ,SKU_NBR                                                      
036900            ,ASN_PKGNG_CDE                                                
037000         FROM                                                             
037100             TIMCNUP                                                      
037200         WHERE CONTNR_ID    =  :HOLD-CONTNR-ID                            
037300         AND CONTNR_SEQ_NBR =  :HOLD-CONTNR-SEQ-NBR                       
037400         AND PO_NBR         =  :HOLD-PO-NBR                               
037500     END-EXEC.                                                            
037600                                                                          
037700/                                                                         
037800******************************************************************        
037900     EXEC SQL                                                             
038000       DECLARE TRT00008-CART-CSR CURSOR FOR                               
038100         SELECT                                                           
038200             CONTNR_ID                                                    
038300            ,CONTNR_SEQ_NBR                                               
038400            ,PO_NBR                                                       
038500            ,UPC_NBR                                                      
038600            ,SSCC_ID                                                      
038700            ,CRE_BY_USR_ID                                                
038800            ,CRE_TMST                                                     
038900            ,UNT_QTY                                                      
039000            ,LAST_UPD_BY_USR_ID                                           
039100            ,LAST_UPD_TMST                                                
039200         FROM                                                             
039300             TRT_IMPRT_CART                                               
039400         WHERE CONTNR_ID    =  :HOLD-CONTNR-ID                            
039500         AND CONTNR_SEQ_NBR =  :HOLD-CONTNR-SEQ-NBR                       
039600         AND PO_NBR         =  :HOLD-PO-NBR                               
039700     END-EXEC.                                                            
039800                                                                          
039900/                                                                         
040000******************************************************************        
040100     EXEC SQL                                                             
040200       DECLARE TRT00006_SEAL_CSR CURSOR FOR                               
040300         SELECT                                                           
040400             CONTNR_ID                                                    
040500            ,CONTNR_SEQ_NBR                                               
040600            ,SEAL_NBR                                                     
040700            ,CRE_TMST                                                     
040800            ,CRE_BY_USR_ID                                                
040900            ,LAST_UPD_TMST                                                
041000            ,LAST_UPD_BY_USR_ID                                           
041100         FROM                                                             
041200             TRT_IMPRT_SEAL                                               
041300         WHERE CONTNR_ID = :HOLD-CONTNR-ID                                
041400     END-EXEC.                                                            
041500                                                                          
041600/                                                                         
041700******************************************************************        
041800     EXEC SQL                                                             
041900       DECLARE IMCSEN_CSR CURSOR FOR                                      
042000         SELECT                                                           
042100                 CSTM_ENTR_ID                                             
042200                ,ENT_ID                                                   
042300                ,BKR_REF_NBR                                              
042400                ,FILD_TMST                                                
042500                ,EST_CLR_TMST                                             
042600                ,ACTL_CLR_TMST                                            
042700                ,EXM_TMST                                                 
042800                ,REJ_TMST                                                 
042900                ,REJ_DESC                                                 
043000                ,LQDN_TMST                                                
043100                ,LQDN_SSPNN_TMST                                          
043200                ,LQDN_SSPNN_DESC                                          
043300                ,DAT_SRC_ENT_ID                                           
043400                ,CRE_BY_USR_ID                                            
043500                ,CRE_TMST                                                 
043600                ,LAST_UPD_BY_USR_ID                                       
043700                ,LAST_UPD_TMST                                            
043800                ,MOM_DEST_POE_CDE                                         
043900         FROM                                                             
044000             TIMCSEN                                                      
044100         WHERE CSTM_ENTR_ID     = :HOLD-CSTM-ENTR-ID                      
044200     END-EXEC.                                                            
044300/                                                                         
044400******************************************************************        
044500     EXEC SQL                                                             
044600       DECLARE IMCSBL_CSR CURSOR FOR                                      
044700         SELECT                                                           
044800             CSTM_ENTR_ID                                                 
044900            ,MSTR_BOL_NBR                                                 
045000            ,HSE_BOL_NBR                                                  
045100            ,CRE_BY_USR_ID                                                
045200            ,CRE_TMST                                                     
045300            ,LAST_UPD_BY_USR_ID                                           
045400            ,LAST_UPD_TMST                                                
045500         FROM                                                             
045600             TIMCSBL                                                      
045700         WHERE CSTM_ENTR_ID     = :HOLD-CSTM-ENTR-ID                      
045800     END-EXEC.                                                            
045900/                                                                         
046000******************************************************************        
046100     EXEC SQL                                                             
046200       DECLARE IMCSCN_CSR CURSOR FOR                                      
046300         SELECT                                                           
046400                 CSTM_ENTR_ID                                             
046500                ,CONTNR_ID                                                
046600                ,CRE_BY_USR_ID                                            
046700                ,CRE_TMST                                                 
046800                ,LAST_UPD_BY_USR_ID                                       
046900                ,LAST_UPD_TMST                                            
047000         FROM                                                             
047100             TIMCSCN                                                      
047200         WHERE  CSTM_ENTR_ID    = :HOLD-CSTM-ENTR-ID                      
047300     END-EXEC.                                                            
047400/                                                                         
047500******************************************************************        
047600     EXEC SQL                                                             
047700       DECLARE IMCSPO_CSR CURSOR FOR                                      
047800         SELECT                                                           
047900                 CSTM_ENTR_ID                                             
048000                ,PO_NBR                                                   
048100                ,CRE_BY_USR_ID                                            
048200                ,CRE_TMST                                                 
048300                ,LAST_UPD_BY_USR_ID                                       
048400                ,LAST_UPD_TMST                                            
048500         FROM                                                             
048600             TIMCSPO                                                      
048700         WHERE PO_NBR           = :HOLD-PO-NBR                            
048800     END-EXEC.                                                            
048900/                                                                         
049000******************************************************************        
049100     EXEC SQL                                                             
049200       DECLARE AUCSEN_CSR CURSOR FOR                                      
049300         SELECT                                                           
049400               CSTM_ENTR_ID                                               
049500              ,ENT_ID                                                     
049600              ,BKR_REF_NBR                                                
049700              ,FILD_TMST                                                  
049800              ,EST_CLR_TMST                                               
049900              ,ACTL_CLR_TMST                                              
050000              ,EXM_TMST                                                   
050100              ,REJ_TMST                                                   
050200              ,REJ_DESC                                                   
050300              ,LQDN_TMST                                                  
050400              ,LQDN_SSPNN_TMST                                            
050500              ,LQDN_SSPNN_DESC                                            
050600              ,DAT_SRC_ENT_ID                                             
050700              ,LAST_UPD_BY_USR_ID                                         
050800              ,LAST_UPD_TMST                                              
050900              ,AUD_FUNC_CDE                                               
051000              ,AUD_TMST                                                   
051100              ,MOM_DEST_POE_CDE                                           
051200         FROM                                                             
051300             TAUCSEN                                                      
051400         WHERE CSTM_ENTR_ID     = :HOLD-CSTM-ENTR-ID                      
051500     END-EXEC.                                                            
051600/                                                                         
051700******************************************************************        
051800     EXEC SQL                                                             
051900       DECLARE AUCSPO_CSR CURSOR FOR                                      
052000         SELECT                                                           
052100               CSTM_ENTR_ID                                               
052200              ,PO_NBR                                                     
052300              ,LAST_UPD_BY_USR_ID                                         
052400              ,LAST_UPD_TMST                                              
052500              ,AUD_FUNC_CDE                                               
052600              ,AUD_TMST                                                   
052700         FROM                                                             
052800             TAUCSPO                                                      
052900         WHERE CSTM_ENTR_ID     = :HOLD-CSTM-ENTR-ID                      
053000     END-EXEC.                                                            
053100/                                                                         
053200******************************************************************        
053300     EXEC SQL                                                             
053400       DECLARE AUCSCN_CSR CURSOR FOR                                      
053500         SELECT                                                           
053600               CSTM_ENTR_ID                                               
053700              ,CONTNR_ID                                                  
053800              ,LAST_UPD_BY_USR_ID                                         
053900              ,LAST_UPD_TMST                                              
054000              ,AUD_FUNC_CDE                                               
054100              ,AUD_TMST                                                   
054200         FROM                                                             
054300             TAUCSCN                                                      
054400         WHERE CSTM_ENTR_ID     = :HOLD-CSTM-ENTR-ID                      
054500     END-EXEC.                                                            
054600/                                                                         
054700******************************************************************        
054800     EXEC SQL                                                             
054900       DECLARE AUCSBL_CSR CURSOR FOR                                      
055000         SELECT                                                           
055100               CSTM_ENTR_ID                                               
055200              ,MSTR_BOL_NBR                                               
055300              ,HSE_BOL_NBR                                                
055400              ,LAST_UPD_BY_USR_ID                                         
055500              ,LAST_UPD_TMST                                              
055600              ,AUD_FUNC_CDE                                               
055700              ,AUD_TMST                                                   
055800         FROM                                                             
055900             TAUCSBL                                                      
056000         WHERE CSTM_ENTR_ID     = :HOLD-CSTM-ENTR-ID                      
056100     END-EXEC.                                                            
056200/                                                                         
056300******************************************************************        
056400     EXEC SQL                                                             
056500       DECLARE AURCPO_CSR CURSOR FOR SELECT                               
056600                    PO_NBR                                                
056700                   ,PO_RCVD_SEQ_NBR                                       
056800                   ,PO_RCVD_DELY_TMST                                     
056900                   ,EXTL_REF_NBR                                          
057000                   ,ORGN_SHPD_FR_CDE                                      
057100                   ,CONSLR_SCAC_ID                                        
057200                   ,IMPRT_TRIP_ID                                         
057300                   ,DPRTR_TMST                                            
057400                   ,POE_DELY_TMST                                         
057500                   ,CARR_SCAC_ID                                          
057600                   ,FOB_CDE                                               
057700                   ,IMPRT_VEH_NM                                          
057800                   ,TRIP_TYP_CDE                                          
057900                   ,DEST_POE_CDE                                          
058000                   ,C_O_PROD_CDE                                          
058100                   ,PROD_FCTRY_NM                                         
058200                   ,PO_CART_CNT                                           
058300                   ,PO_CBMT_QTY                                           
058400                   ,PO_WT_KGRM_QTY                                        
058500                   ,PO_UNT_QTY                                            
058600                   ,PO_EXC_APVL_CDE                                       
058700                   ,PO_EXC_APVL_USR_ID                                    
058800                   ,PO_EXC_APVL_TMST                                      
058900                   ,PO_EXC_RSN_DESC                                       
059000                   ,EST_LBD_NM                                            
059100                   ,EST_LBD_TMST                                          
059200                   ,VOY_CHG_RSN_DESC                                      
059300                   ,DAT_SRC_ENT_ID                                        
059400                   ,LAST_UPD_BY_USR_ID                                    
059500                   ,LAST_UPD_TMST                                         
059600                   ,AUD_FUNC_CDE                                          
059700                   ,AUD_TMST                                              
059800         FROM                                                             
059900             TAURCPO                                                      
060000         WHERE PO_NBR           = :HOLD-PO-NBR                            
060100     END-EXEC.                                                            
060200/                                                                         
060300******************************************************************        
060400*    EXEC SQL                                                             
060500*      DECLARE AURCVS_CSR CURSOR FOR SELECT                               
060600*            PO_NBR                                                       
060700*           ,PO_RCVD_SEQ_NBR                                              
060800*           ,VS_NBR                                                       
060900*           ,HTS_ID                                                       
061000*           ,VS_CART_CNT                                                  
061100*           ,VS_CBMT_QTY                                                  
061200*           ,VS_WT_KGRM_QTY                                               
061300*           ,VS_UNT_QTY                                                   
061400*           ,QTA_CTG_IND                                                  
061500*           ,LAST_UPD_BY_USR_ID                                           
061600*           ,LAST_UPD_TMST                                                
061700*           ,AUD_FUNC_CDE                                                 
061800*           ,AUD_TMST                                                     
061900*        FROM                                                             
062000*            TAURCVS                                                      
062100*        WHERE PO_NBR           = :HOLD-PO-NBR                            
062200*    END-EXEC.                                                            
062300/                                                                         
062400******************************************************************        
062500*    EXEC SQL                                                             
062600*      DECLARE AURCUP_CSR CURSOR FOR SELECT                               
062700*            PO_NBR                                                       
062800*           ,PO_RCVD_SEQ_NBR                                              
062900*           ,VS_NBR                                                       
063000*           ,UPC_NBR                                                      
063100*           ,UPC_CART_CNT                                                 
063200*           ,UPC_CBMT_QTY                                                 
063300*           ,UPC_WT_KGRM_QTY                                              
063400*           ,UPC_UNT_QTY                                                  
063500*           ,LAST_UPD_BY_USR_ID                                           
063600*           ,LAST_UPD_TMST                                                
063700*           ,AUD_FUNC_CDE                                                 
063800*           ,AUD_TMST                                                     
063900*        FROM                                                             
064000*            TAURCUP                                                      
064100*        WHERE PO_NBR           = :HOLD-PO-NBR                            
064200*    END-EXEC.                                                            
064300/                                                                         
064400******************************************************************        
064500     EXEC SQL                                                             
064600       DECLARE AUBKPO_CSR CURSOR FOR SELECT                               
064700             PO_NBR                                                       
064800            ,PO_BKG_SEQ_NBR                                               
064900            ,PO_BKG_DELY_TMST                                             
065000            ,EXTL_REF_NBR                                                 
065100            ,ORGN_SHPD_FR_CDE                                             
065200            ,CONSLR_SCAC_ID                                               
065300            ,IMPRT_TRIP_ID                                                
065400            ,DPRTR_TMST                                                   
065500            ,POE_DELY_TMST                                                
065600            ,CARR_SCAC_ID                                                 
065700            ,FOB_CDE                                                      
065800            ,IMPRT_VEH_NM                                                 
065900            ,TRIP_TYP_CDE                                                 
066000            ,DEST_POE_CDE                                                 
066100            ,C_O_PROD_CDE                                                 
066200            ,PROD_FCTRY_NM                                                
066300            ,PO_CART_CNT                                                  
066400            ,PO_CBMT_QTY                                                  
066500            ,PO_WT_KGRM_QTY                                               
066600            ,PO_UNT_QTY                                                   
066700            ,PO_EXC_APVL_CDE                                              
066800            ,PO_EXC_APVL_USR_ID                                           
066900            ,PO_EXC_APVL_TMST                                             
067000            ,PO_EXC_RSN_DESC                                              
067100            ,EST_LBD_NM                                                   
067200            ,EST_LBD_TMST                                                 
067300            ,SHIPT_BKG_TMST                                               
067400            ,VOY_CHG_RSN_DESC                                             
067500            ,DAT_SRC_ENT_ID                                               
067600            ,LAST_UPD_BY_USR_ID                                           
067700            ,LAST_UPD_TMST                                                
067800            ,AUD_FUNC_CDE                                                 
067900            ,AUD_TMST                                                     
068000         FROM                                                             
068100             TAUBKPO                                                      
068200         WHERE PO_NBR           = :HOLD-PO-NBR                            
068300     END-EXEC.                                                            
068400/                                                                         
068500******************************************************************        
068600*    EXEC SQL                                                             
068700*      DECLARE AUBKVS_CSR CURSOR FOR SELECT                               
068800*            PO_NBR                                                       
068900*           ,PO_BKG_SEQ_NBR                                               
069000*           ,VS_NBR                                                       
069100*           ,HTS_ID                                                       
069200*           ,VS_CART_CNT                                                  
069300*           ,VS_CBMT_QTY                                                  
069400*           ,VS_WT_KGRM_QTY                                               
069500*           ,VS_UNT_QTY                                                   
069600*           ,QTA_CTG_IND                                                  
069700*           ,LAST_UPD_BY_USR_ID                                           
069800*           ,LAST_UPD_TMST                                                
069900*           ,AUD_FUNC_CDE                                                 
070000*           ,AUD_TMST                                                     
070100*        FROM                                                             
070200*            TAUBKVS                                                      
070300*        WHERE PO_NBR           = :HOLD-PO-NBR                            
070400*    END-EXEC.                                                            
070500/                                                                         
070600******************************************************************        
070700*    EXEC SQL                                                             
070800*      DECLARE AUBKUP_CSR CURSOR FOR SELECT                               
070900*            PO_NBR                                                       
071000*           ,PO_BKG_SEQ_NBR                                               
071100*           ,VS_NBR                                                       
071200*           ,UPC_NBR                                                      
071300*           ,UPC_CART_CNT                                                 
071400*           ,UPC_CBMT_QTY                                                 
071500*           ,UPC_WT_KGRM_QTY                                              
071600*           ,UPC_UNT_QTY                                                  
071700*           ,LAST_UPD_BY_USR_ID                                           
071800*           ,LAST_UPD_TMST                                                
071900*           ,AUD_FUNC_CDE                                                 
072000*           ,AUD_TMST                                                     
072100*        FROM                                                             
072200*            TAUBKUP                                                      
072300*        WHERE PO_NBR           = :HOLD-PO-NBR                            
072400*    END-EXEC.                                                            
072500/                                                                         
072600******************************************************************        
072700     EXEC SQL                                                             
072800       DECLARE AUCNPO_CSR CURSOR FOR SELECT                               
072900             CONTNR_ID                                                    
073000            ,CONTNR_SEQ_NBR                                               
073100            ,PO_NBR                                                       
073200            ,CSTM_ENTR_ID                                                 
073300            ,MSTR_BOL_NBR                                                 
073400            ,HSE_BOL_NBR                                                  
073500            ,LTR_OF_CR_NBR                                                
073600            ,PO_RCVD_DELY_TMST                                            
073700            ,PO_C_O_PROD_CDE                                              
073800            ,PO_CART_CNT                                                  
073900            ,PO_CBMT_QTY                                                  
074000            ,PO_WT_KGRM_QTY                                               
074100            ,PO_UNT_QTY                                                   
074200            ,LAST_UPD_BY_USR_ID                                           
074300            ,LAST_UPD_TMST                                                
074400            ,AUD_FUNC_CDE                                                 
074500            ,AUD_TMST                                                     
074600            ,EXTL_REF_NBR                                                 
074700            ,BKR_FRGT_RLSE_CDE                                            
074800            ,DO_RCVD_CDE                                                  
074900            ,CONTNR_PU_CDE                                                
075000            ,ACTL_POE_DELY_CDE                                            
075100            ,DVN_CDE                                                      
075200            ,DCONSLR_RET_CDE                                              
075300            ,SPLT_XMIT_CDE                                                
075400            ,DOC_RCVD_ORGN_TMST                                           
075400            ,DCONSLR_DELY_CDE                                             
075500         FROM                                                             
075600             TAUCNPO                                                      
075700         WHERE PO_NBR           = :HOLD-PO-NBR                            
075800     END-EXEC.                                                            
075900/                                                                         
076000******************************************************************        
076100     EXEC SQL                                                             
076200       DECLARE AUCNUP_CSR CURSOR FOR SELECT                               
076300             CONTNR_ID                                                    
076400            ,CONTNR_SEQ_NBR                                               
076500            ,PO_NBR                                                       
076600            ,VS_NBR                                                       
076700            ,UPC_NBR                                                      
076800            ,PO_LNE_NBR                                                   
076900            ,UPC_CART_CNT                                                 
077000            ,UPC_CBMT_QTY                                                 
077100            ,UPC_WT_KGRM_QTY                                              
077200            ,UPC_UNT_QTY                                                  
077300            ,LAST_UPD_BY_USR_ID                                           
077400            ,LAST_UPD_TMST                                                
077500            ,AUD_FUNC_CDE                                                 
077600            ,AUD_TMST                                                     
077700            ,SKU_NBR                                                      
077800            ,ASN_PKGNG_CDE                                                
077900         FROM                                                             
078000             TAUCNUP                                                      
078100         WHERE PO_NBR           = :HOLD-PO-NBR                            
078200     END-EXEC.                                                            
078300/                                                                         
078400******************************************************************        
078500     EXEC SQL                                                             
078600       DECLARE AUCNTK_CSR CURSOR FOR SELECT                               
078700             CONTNR_ID                                                    
078800            ,CONTNR_SEQ_NBR                                               
078900            ,CONSLR_SCAC_ID                                               
079000            ,MOM_IMPRT_TRIP_ID                                            
079100            ,MOM_DPRTR_TMST                                               
079200            ,MOM_POE_DELY_TMST                                            
079300            ,MOM_CARR_SCAC_ID                                             
079400            ,MOM_FOB_CDE                                                  
079500            ,MOM_IMPRT_VEH_NM                                             
079600            ,MOM_TRIP_TYP_CDE                                             
079700            ,MOM_DEST_POE_CDE                                             
079800            ,FDR_IMPRT_TRIP_ID                                            
079900            ,FDR_DPRTR_TMST                                               
080000            ,FDR_POE_DELY_TMST                                            
080100            ,FDR_CARR_SCAC_ID                                             
080200            ,FDR_FOB_CDE                                                  
080300            ,FDR_IMPRT_VEH_NM                                             
080400            ,FDR_TRIP_TYP_CDE                                             
080500            ,FDR_DEST_POE_CDE                                             
080600            ,SIZE_CDE                                                     
080700            ,CART_CNT                                                     
080800            ,CBMT_QTY                                                     
080900            ,WT_KGRM_QTY                                                  
081000            ,UNT_QTY                                                      
081100            ,ORGN_SHPD_FR_CDE                                             
081200            ,ORGN_SHPD_TO_CDE                                             
081300            ,EST_LBD_NM                                                   
081400            ,EST_LBD_TMST                                                 
081500            ,RISU_DO_RSN_CDE                                              
081600            ,BKR_FRGT_RLSE_TMST                                           
081700            ,DO_TO_DCONSLR_TMST                                           
081800            ,DO_RCVD_TMST                                                 
081900            ,CONTNR_PU_TMST                                               
082000            ,DAT_SRC_ENT_ID                                               
082100            ,LAST_UPD_BY_USR_ID                                           
082200            ,LAST_UPD_TMST                                                
082300            ,AUD_FUNC_CDE                                                 
082400            ,AUD_TMST                                                     
082500            ,ACTL_POE_DELY_TMST                                           
082600            ,ACTL_DEST_POE_CDE                                            
082700            ,ACTL_LBD_NM                                                  
082800            ,ACTL_LBD_TMST                                                
082900            ,DVN_TMST                                                     
083000            ,DCONSLR_SCAC_ID                                              
083100            ,DCONSLR_RET_TMST                                             
083200            ,MOM_POL_CDE                                                  
083300            ,FDR_POL_CDE                                                  
083400            ,MOM_POR_CDE                                                  
083500            ,FDR_POR_CDE                                                  
083500            ,DCONSLR_DELY_TMST                                            
083600         FROM                                                             
083700             TAUCNTK                                                      
083800         WHERE CONTNR_ID        = :HOLD-CONTNR-ID                         
083900         AND   CONTNR_SEQ_NBR   = :HOLD-CONTNR-SEQ-NBR                    
084000     END-EXEC.                                                            
084100/                                                                         
084200******************************************************************        
084300     EXEC SQL                                                             
084400       DECLARE AUD_CART_CSR CURSOR                                        
084500              FOR SELECT                                                  
084600             CONTNR_ID                                                    
084700            ,CONTNR_SEQ_NBR                                               
084800            ,PO_NBR                                                       
084900            ,UPC_NBR                                                      
085000            ,SSCC_ID                                                      
085100            ,UNT_QTY                                                      
085200            ,LAST_UPD_BY_USR_ID                                           
085300            ,LAST_UPD_TMST                                                
085400            ,AUD_FUNC_CDE                                                 
085500            ,AUD_TMST                                                     
085600         FROM                                                             
085700             TRT_AUD_IMPRT_CART                                           
085800         WHERE PO_NBR           = :HOLD-PO-NBR                            
085900     END-EXEC.                                                            
086000/                                                                         
086100******************************************************************        
086200     EXEC SQL                                                             
086300       DECLARE AUD_SEAL_CSR CURSOR                                        
086400              FOR SELECT                                                  
086500             CONTNR_ID                                                    
086600            ,CONTNR_SEQ_NBR                                               
086700            ,SEAL_NBR                                                     
086800            ,LAST_UPD_TMST                                                
086900            ,LAST_UPD_BY_USR_ID                                           
087000            ,AUD_FUNC_CDE                                                 
087100            ,AUD_TMST                                                     
087200         FROM                                                             
087300             TRT_AUD_IMPRT_SEAL                                           
087400         WHERE CONTNR_ID        = :HOLD-CONTNR-ID                         
087500         AND   CONTNR_SEQ_NBR   = :HOLD-CONTNR-SEQ-NBR                    
087600     END-EXEC.                                                            
087700/                                                                         
087800******************************************************************        
087900     EXEC SQL                                                             
088000       DECLARE ELCPO_CSR CURSOR FOR SELECT                                
088100                 PO_NBR                                                   
088200                ,DEPT_NBR                                                 
088300                ,FOB_CDE                                                  
088400                ,OTB_PER_NBR                                              
088500                ,IMPRT_TYP_CDE                                            
088600                ,STRT_FCTRY_DTE                                           
088700                ,LAST_FCTRY_DTE                                           
088800                ,TRIP_STRT_DTE                                            
088900                ,CRE_TMST                                                 
089000                ,LAST_UPD_TMST                                            
089100         FROM                                                             
089200             TELCPO                                                       
089300         WHERE PO_NBR           = :HOLD-PO-NBR                            
089400     END-EXEC.                                                            
089500/                                                                         
089600******************************************************************        
089700     EXEC SQL                                                             
089800       DECLARE ELCVS_CSR CURSOR FOR SELECT                                
089900                 PO_NBR                                                   
090000                ,VND_STYL_NM                                              
090100                ,VND_OUTR_PK_QTY                                          
090200                ,UNT_PER_CBMT_QTY                                         
090300                ,UNT_QTY                                                  
090400                ,LAST_UPD_TMST                                            
090500         FROM                                                             
090600             TELCVS                                                       
090700         WHERE PO_NBR           = :HOLD-PO-NBR                            
090800     END-EXEC.                                                            
090900/                                                                         
091000******************************************************************        
091100     EXEC SQL                                                             
091200       DECLARE VSCPT_CSR CURSOR FOR SELECT                                
091300                 PO_NBR                                                   
091400                ,VND_STYL_NM                                              
091500                ,CST_CPT_CDE                                              
091600                ,ALW_CHRG_CDE                                             
091700                ,CPT_CHRG_AMT                                             
091800                ,INCL_IN_ELC_IND                                          
091900                ,LAST_UPD_TMST                                            
092000         FROM                                                             
092100             TVSCPT                                                       
092200         WHERE PO_NBR           = :HOLD-PO-NBR                            
092300     END-EXEC.                                                            
092400/                                                                         
092500/                                                                         
092600******************************************************************        
092700     EXEC SQL                                                             
092800       DECLARE AUCNRL-CSR CURSOR FOR SELECT                               
092900                 CONTNR_ID                                                
093000                ,CONTNR_SEQ_NBR                                           
093100                ,PO_NBR                                                   
093200                ,DCONSLR_RLSE_CDE                                         
093300                ,DCONSLR_REQR_DTE                                         
093400                ,DCONSLR_ACTL_DTE                                         
093500                ,DCONSLR_ACTL_TM                                          
093600                ,CRE_TMST                                                 
093700                ,CRE_BY_UID                                               
093800                ,AUD_FUNC_CDE                                             
093900                ,AUD_TMST                                                 
094000                ,LAST_UPD_TMST                                            
094100                ,LAST_UPD_BY_UID                                          
094200                ,DCONSLR_ENT_ID                                           
094300         FROM                                                             
094400             TAUCNRL                                                      
094500         WHERE CONTNR_ID    =  :IMCNPO-CONTNR-ID                          
094600         AND CONTNR_SEQ_NBR =  :IMCNPO-CONTNR-SEQ-NBR                     
094700         AND PO_NBR         =  :IMCNPO-PO-NBR                             
094800     END-EXEC.                                                            
094900/                                                                         
095000*   RULE CONSTRAINT CURSOR FOR PO-LEVEL SPLITS                            
095100                                                                          
095200     EXEC SQL                                                             
095300       DECLARE RULE-CNSTR-CSR CURSOR FOR                                  
095400     SELECT                                                               
095500                                                                          
095600             RULC.RUL_ID                                                  
095700            ,RULC.RUL_CNSTR_CDE                                           
095800            ,RULC.RUL_CNSTR_TYP_CDE                                       
095900            ,RULC.RUL_CNSTR_VAL_TXT                                       
096000            ,RULC.CRE_TMST                                                
096100            ,RULC.CRE_BY_USR_ID                                           
096200     FROM                                                                 
096300         TRT_RUL_CNSTR RULC                                               
096400     WHERE                                                                
096500         RULC.RUL_ID  = :DS010-RUL-ID                                     
096600        WITH UR                                                           
096700                                                                          
096800     END-EXEC.                                                            
096900                                                                          
097000*   RULE CONSTRAINT CURSOR FOR CONTAINER SPLITS                           
097100                                                                          
097200     EXEC SQL                                                             
097300       DECLARE RULE-CNSTR-CNT-CSR CURSOR FOR                              
097400     SELECT                                                               
097500                                                                          
097600             RULC.RUL_ID                                                  
097700            ,RULC.RUL_CNSTR_CDE                                           
097800            ,RULC.RUL_CNSTR_TYP_CDE                                       
097900            ,RULC.RUL_CNSTR_VAL_TXT                                       
098000            ,RULC.CRE_TMST                                                
098100            ,RULC.CRE_BY_USR_ID                                           
098200     FROM                                                                 
098300         TRT_RUL_CNSTR RULC                                               
098400     WHERE                                                                
098500         RULC.RUL_ID                 = :DS010-RUL-ID                      
098600        WITH UR                                                           
098700                                                                          
098800     END-EXEC.                                                            
098900                                                                          
099000*   CONTAINER SPLIT DRIVER CSR                                            
099100     EXEC SQL                                                             
099200       DECLARE CONT-SPLIT-CSR CURSOR FOR                                  
099300          SELECT DISTINCT                                                 
099400                 CON.RUL_ID                                               
099500        FROM   TRT_RUL_CNSTR CON                                          
099600        ,      TRT_RUL_CNSTR SEQ                                          
099700        WHERE                                                             
099800              SUBSTR(CON.RUL_CNSTR_VAL_TXT,1,12)                          
099900                                 = :HOLD-CONTNR-ID                        
100000             AND  SMALLINT(SUBSTR(SEQ.RUL_CNSTR_VAL_TXT,1,06))            
100100                            = :HOLD-CONTNR-SEQ-NBR                        
100200             AND CON.RUL_ID = SEQ.RUL_ID                                  
100300             AND CON.RUL_CNSTR_TYP_CDE = 'CONT    '                       
100400             AND SEQ.RUL_CNSTR_TYP_CDE = 'SEQ     '                       
100500                                                                          
100600*          UNION                                                          
100700*                                                                         
100800*     DOMESTIC                                                            
100900*            SELECT                                                       
101000*                  RULC.RUL_ID                                            
101100*                                                                         
101200*              FROM                                                       
101300*                 TSHPTPO    SHPO                                         
101400*             ,   TSHIPMT    SHIP                                         
101500*             ,   TRT_RUL_CNSTR RULC                                      
101600*              WHERE                                                      
101700*                  SHPO.PO_NBR = :HOLD-PO-NBR                             
101800*              AND                                                        
101900*                  SHPO.SHIPT_ID      = SHIP.SHIPT_ID                     
102000*                                                                         
102100*              AND                                                        
102200*                  SHIP.PRO_NBR       = RULC.RUL_CNSTR_VAL_TXT            
102300*              AND                                                        
102400*                  SHIP.PRO_NBR      <> '                      '          
102500        WITH UR                                                           
102600     END-EXEC.                                                            
102700                                                                          
102800                                                                          
102900*   PO SPLIT DRIVER CSR                                                   
103000     EXEC SQL                                                             
103100       DECLARE PO-SPLIT-CSR CURSOR FOR                                    
103200          SELECT DISTINCT                                                 
103300                 CON.RUL_ID                                               
103400        FROM   TRT_RUL_CNSTR CON                                          
103500        WHERE                                                             
103600              SUBSTR(CON.RUL_CNSTR_VAL_TXT,1,09)                          
103700                                 = :PV-PO-X                               
103800             AND CON.RUL_CNSTR_TYP_CDE = 'CONPO   '                       
103900                                                                          
104000*    UNION                                                                
104100*                                                                         
104200*     DOMESTIC                                                            
104300*            SELECT                                                       
104400*                  RULC.RUL_ID                                            
104500*                                                                         
104600*              FROM                                                       
104700*                 TSHPTPO    SHPO                                         
104800*             ,   TSHIPMT    SHIP                                         
104900*             ,   TRT_RUL_CNSTR RULC                                      
105000*              WHERE                                                      
105100*                  SHPO.PO_NBR = :HOLD-PO-NBR                             
105200*              AND                                                        
105300*                  SHPO.SHIPT_ID      = SHIP.SHIPT_ID                     
105400*                                                                         
105500*              AND                                                        
105600*                  SHIP.PRO_NBR       = RULC.RUL_CNSTR_VAL_TXT            
105700*              AND                                                        
105800*                  SHIP.PRO_NBR      <> '                      '          
105900                                                                          
106000        WITH UR                                                           
106100     END-EXEC.                                                            
106200                                                                          
106300                                                                          
106400*   RULE CURSOR                                                           
106500     EXEC SQL                                                             
106600       DECLARE RULE-CSR CURSOR FOR                                        
106700     SELECT                                                               
106800                                                                          
106900             RUL.RUL_ID                                                   
107000            ,RUL.RUL_CDE                                                  
107100            ,RUL.RUL_TYP_CDE                                              
107200            ,RUL.RUL_BEG_DTE                                              
107300            ,RUL.RUL_END_DTE                                              
107400            ,RUL.CRE_TMST                                                 
107500            ,RUL.CRE_BY_USR_ID                                            
107600     FROM                                                                 
107700         TRT_RUL       RUL                                                
107800     WHERE                                                                
107900             RUL.RUL_ID       = :TRT00015-RUL-ID                          
108000        WITH UR                                                           
108100     END-EXEC.                                                            
108200                                                                          
108300*   AUDIT RULE CONSTRAINTS                                                
108400     EXEC SQL                                                             
108500       DECLARE TRT00018-CSR CURSOR FOR                                    
108600     SELECT                                                               
108700             RUL_ID                                                       
108800            ,RUL_CNSTR_CDE                                                
108900            ,RUL_CNSTR_TYP_CDE                                            
109000            ,RUL_CNSTR_VAL_TXT                                            
109100            ,CRE_TMST                                                     
109200            ,CRE_BY_USR_ID                                                
109300            ,AUD_CRE_USR_ID                                               
109400            ,AUD_FUNC_CDE                                                 
109500            ,AUD_CRE_TMST                                                 
109600     FROM                                                                 
109700         TRT_AUD_RUL_CNSTR                                                
109800     WHERE                                                                
109900             RUL_ID       = :TRT00015-RUL-ID                              
110000        WITH UR                                                           
110100     END-EXEC.                                                            
110200/                                                                         
110300*   AUDIT RULES                                                           
110400     EXEC SQL                                                             
110500       DECLARE TRT00017-CSR CURSOR FOR                                    
110600     SELECT                                                               
110700             RUL_ID                                                       
110800            ,RUL_CDE                                                      
110900            ,RUL_TYP_CDE                                                  
111000            ,RUL_BEG_DTE                                                  
111100            ,RUL_END_DTE                                                  
111200            ,CRE_TMST                                                     
111300            ,CRE_BY_USR_ID                                                
111400            ,AUD_CRE_USR_ID                                               
111500            ,AUD_FUNC_CDE                                                 
111600            ,AUD_CRE_TMST                                                 
111700     FROM                                                                 
111800         TRT_AUD_RUL                                                      
111900     WHERE                                                                
112000             RUL_ID       = :TRT00015-RUL-ID                              
112100        WITH UR                                                           
112200     END-EXEC.                                                            
112300/                                                                         
108300*   WHSE REPLENISHMENT INBOUND PO                                         
108400*    EXEC SQL                                                             
108500*      DECLARE TRT00057-CSR CURSOR FOR                                    
108600*    SELECT                                                               
108700*            WHSE_RPLNT_INBND_ID                                          
108800*           ,PO_NBR                                                       
108900*           ,EXTL_REF_NBR                                                 
109000*           ,DCONSLR_VEH_DPRTR_IND                                        
109100*           ,WHSE_ARRVL_IND                                               
109200*           ,WHSE_AUD_CMPLT_IND                                           
109300*           ,CRE_USR_ID                                                   
109400*           ,CRE_TMST                                                     
109500*           ,LAST_UPD_USR_ID                                              
109500*           ,LAST_UPD_TMST                                                
109600*    FROM                                                                 
109700*        TRT_WHSE_RPLNT_INBND_PO                                          
109800*    WHERE                                                                
109900*            PO_NBR       = :HOLD-PO-NBR                                  
110000*       WITH UR                                                           
110100*    END-EXEC.                                                            
110200*                                                                         
108300*   WHSE REPLENISHMENT INBOUND CART                                       
108400*    EXEC SQL                                                             
108500*      DECLARE TRT00058-CSR CURSOR FOR                                    
108600*    SELECT                                                               
108700*            WHSE_RPLNT_INBND_ID                                          
108800*           ,PO_NBR                                                       
108900*           ,EXTL_REF_NBR                                                 
108900*           ,SSCC_ID                                                      
109000*           ,DCONSLR_DPRTR_IND                                            
109100*           ,WHSE_ARRVL_SSCC_IND                                          
109200*           ,WHSE_AUD_CMPLT_IND                                           
109200*           ,WHSE_AUD_UNT_QTY                                             
109300*           ,CRE_USR_ID                                                   
109400*           ,CRE_TMST                                                     
109500*           ,LAST_UPD_USR_ID                                              
109500*           ,LAST_UPD_TMST                                                
109600*    FROM                                                                 
109700*        TRT_WHSE_RPLNT_INBND_CART                                        
109800*    WHERE                                                                
109900*            PO_NBR               = :HOLD-PO-NBR                          
109900*      AND   WHSE_RPLNT_INBND_ID  = :HOLD-RPLNT-ID                        
109900*      AND   EXTL_REF_NBR         = :HOLD-EXTL-REF-NBR                    
110000*       WITH UR                                                           
110100*    END-EXEC.                                                            
110200*                                                                         
108300*   WHSE REPLENISHMENT INBOUND PO AUDIT                                   
108400*    EXEC SQL                                                             
108500*      DECLARE TRT00060-CSR CURSOR FOR                                    
108600*    SELECT                                                               
108700*            WHSE_RPLNT_INBND_ID                                          
108800*           ,PO_NBR                                                       
108900*           ,EXTL_REF_NBR                                                 
109000*           ,DCONSLR_VEH_DPRTR_IND                                        
109100*           ,WHSE_ARRVL_IND                                               
109200*           ,WHSE_AUD_CMPLT_IND                                           
109300*           ,CRE_USR_ID                                                   
109400*           ,CRE_TMST                                                     
109500*           ,LAST_UPD_USR_ID                                              
109500*           ,LAST_UPD_TMST                                                
109500*           ,AUD_FUNC_CDE                                                 
109500*           ,AUD_TMST                                                     
109600*    FROM                                                                 
109700*        TRT_WHSE_RPLNT_INBND_PO_AUD                                      
109800*    WHERE                                                                
109900*            PO_NBR       = :HOLD-PO-NBR                                  
110000*       WITH UR                                                           
110100*    END-EXEC.                                                            
110200*                                                                         
108300*   WHSE REPLENISHMENT INBOUND CART AUDIT                                 
108400*    EXEC SQL                                                             
108500*      DECLARE TRT00061-CSR CURSOR FOR                                    
108600*    SELECT                                                               
108700*            WHSE_RPLNT_INBND_ID                                          
108800*           ,PO_NBR                                                       
108900*           ,EXTL_REF_NBR                                                 
108900*           ,SSCC_ID                                                      
109000*           ,DCONSLR_DPRTR_IND                                            
109100*           ,WHSE_ARRVL_SSCC_IND                                          
109200*           ,WHSE_AUD_CMPLT_IND                                           
109200*           ,WHSE_AUD_UNT_QTY                                             
109300*           ,CRE_USR_ID                                                   
109400*           ,CRE_TMST                                                     
109500*           ,LAST_UPD_USR_ID                                              
109500*           ,LAST_UPD_TMST                                                
109500*           ,AUD_FUNC_CDE                                                 
109500*           ,AUD_TMST                                                     
109600*    FROM                                                                 
109700*        TRT_WHSE_RPLNT_INBND_CART_AUD                                    
109800*    WHERE                                                                
109900*            PO_NBR               = :HOLD-PO-NBR                          
109900*      AND   WHSE_RPLNT_INBND_ID  = :HOLD-RPLNT-ID                        
109900*      AND   EXTL_REF_NBR         = :HOLD-EXTL-REF-NBR                    
110000*       WITH UR                                                           
110100*    END-EXEC.                                                            
110200/                                                                         
112400******************************************************************        
112500*LINKAGE SECTION.                                                         
112600******************************************************************        
112700*                                                                         
112800 PROCEDURE DIVISION.                                                      
112900                                                                          
113000 A100-MAINLINE.                                                           
113100                                                                          
113200                                                                          
113300                                                                          
113400     MOVE WHEN-COMPILED TO PV-WHEN-COMPILED                               
113500     DISPLAY SPACES                                                       
113600     DISPLAY ' *** DSKUT008 (GROUP3) VERSION 3 ***'                       
113700     DISPLAY 'COMPILE DATE: ' PV-COMPILE-DATE                             
113800             ' ' PV-COMPILE-TIME                                          
113900                                                                          
114000     SET DS009-S-PGM TO TRUE.                                             
114100     PERFORM DS002-INITIAL-PROCESSING.                                    
114200     PERFORM B100-FETCH-PROCESSING                                        
114300         VARYING DS009-PO-SUB FROM 1 BY 1                                 
114400         UNTIL DS009-PO-SUB > DS009-PO-SUB-MAX.                           
114500                                                                          
114600           DISPLAY '  ****  UNLOAD TOTALS  ****'                          
114700                                                                          
114800       PERFORM VARYING CNTL-I FROM 1 BY 1 UNTIL                           
114900           CNTL-I > CNTL-SUB-MAX OR CNTL-I > 200                          
115000           IF CNTL-TABLE(CNTL-I) NOT = SPACES                             
115100             IF DS009-GROUP-NBR(CNTL-I) = '3'                             
115200               MOVE DS009-READ-COUNT (CNTL-I) TO DS009-DISP-NBR           
115300               DISPLAY 'TABLE = ' CNTL-TABLE(CNTL-I)                      
115400                        DS009-DISP-NBR                                    
115500             END-IF                                                       
115600           END-IF                                                         
115700       END-PERFORM                                                        
115800                                                                          
115900       MOVE PV-WRITE-COUNT            TO DS009-DISP-NBR                   
116000       DISPLAY '*** TOTAL UNLOADS WRITTEN = '  DS009-DISP-NBR             
116100                                                                          
116200     PERFORM DS002-END-OF-JOB.                                            
116300                                                                          
116400     GOBACK.                                                              
116500/                                                                         
116600*****************************************************************         
116700*     FOR EACH TABLE IN THE CONTROL FILE PROCESS THE FETCH      *         
116800*****************************************************************         
116900 B100-FETCH-PROCESSING.                                                   
117000*                                                                         
117100     IF DS009-PO-NBR (DS009-PO-SUB) NUMERIC                               
117200                                                                          
117300       PERFORM WITH TEST BEFORE                                           
117400           VARYING DS009-CNTL-J FROM 1 BY 1                               
117500             UNTIL DS009-CNTL-J > CNTL-SUB-MAX                            
117600             IF CNTL-SEL (DS009-CNTL-J) = 'Y'                             
117700                MOVE CNTL-TABLE (DS009-CNTL-J)                            
117800                             TO DS009-PROCESS-TABLE                       
117900                PERFORM DS002-DO-PROCESS                                  
118000                IF DS009-DO-PROCESS                                       
118100                  MOVE DS009-PO-NBR (DS009-PO-SUB)                        
118200                                TO HOLD-PO-NBR                            
118300                                   PV-PO-NBR                              
118400                  PERFORM B100-TABLE-FETCH                                
118500                END-IF                                                    
118600             END-IF                                                       
118700       END-PERFORM                                                        
118800                                                                          
118900     END-IF.                                                              
119000/                                                                         
119100*****************************************************************         
119200* PROCESS THE TABLES                                                      
119300*****************************************************************         
119400 B100-TABLE-FETCH.                                                        
119500        EVALUATE TRUE                                                     
119600                                                                          
119700        WHEN DS009-PROCESS-TABLE = 'TIMCNPO'                              
119800*            CONTAINER LEVEL SPLITS                                       
119900             PERFORM Y100-OPEN-CURSOR                                     
120000             SET MORE-IMCNPO-DATA TO TRUE                                 
120100              PERFORM R101-FETCH-IMCNPO                                   
120200                 UNTIL NO-MORE-IMCNPO-DATA                                
120300             MOVE 'TIMCNPO' TO DS009-PROCESS-TABLE                        
120400             PERFORM Y100-CLOSE-CURSOR                                    
120500                                                                          
120600        WHEN DS009-PROCESS-TABLE = 'TIMBKPO'                              
120700             PERFORM Y100-OPEN-CURSOR                                     
120800             SET MORE-IMBKPO-DATA TO TRUE                                 
120900             PERFORM R100-FETCH-IMBKPO                                    
121000                UNTIL NO-MORE-IMBKPO-DATA                                 
121100             MOVE 'TIMBKPO' TO DS009-PROCESS-TABLE                        
121200             PERFORM Y100-CLOSE-CURSOR                                    
121300*       WHEN DS009-PROCESS-TABLE = 'TIMBKVS'                              
121400*            PERFORM Y100-OPEN-CURSOR                                     
121500*            SET MORE-IMBKVS-DATA TO TRUE                                 
121600*            PERFORM R100-FETCH-IMBKVS                                    
121700*               UNTIL NO-MORE-IMBKVS-DATA                                 
121800*            MOVE 'TIMBKVS' TO DS009-PROCESS-TABLE                        
121900*            PERFORM Y100-CLOSE-CURSOR                                    
122000*       WHEN DS009-PROCESS-TABLE = 'TIMBKUP'                              
122100*            PERFORM Y100-OPEN-CURSOR                                     
122200*            SET MORE-IMBKUP-DATA TO TRUE                                 
122300*            PERFORM R100-FETCH-IMBKUP                                    
122400*               UNTIL NO-MORE-IMBKUP-DATA                                 
122500*            MOVE 'TIMBKUP' TO DS009-PROCESS-TABLE                        
122600*            PERFORM Y100-CLOSE-CURSOR                                    
122700        WHEN DS009-PROCESS-TABLE = 'TIMRCPO'                              
122800             PERFORM Y100-OPEN-CURSOR                                     
122900             SET MORE-IMRCPO-DATA TO TRUE                                 
123000             PERFORM R100-FETCH-IMRCPO                                    
123100                UNTIL NO-MORE-IMRCPO-DATA                                 
123200             MOVE 'TIMRCPO' TO DS009-PROCESS-TABLE                        
123300             PERFORM Y100-CLOSE-CURSOR                                    
123400*       WHEN DS009-PROCESS-TABLE = 'TIMRCUP'                              
123500*            PERFORM Y100-OPEN-CURSOR                                     
123600*            SET MORE-IMRCUP-DATA TO TRUE                                 
123700*            PERFORM R100-FETCH-IMRCUP                                    
123800*               UNTIL NO-MORE-IMRCUP-DATA                                 
123900*            MOVE 'TIMRCUP' TO DS009-PROCESS-TABLE                        
124000*            PERFORM Y100-CLOSE-CURSOR                                    
124100*       WHEN DS009-PROCESS-TABLE = 'TIMRCVS'                              
124200*            PERFORM Y100-OPEN-CURSOR                                     
124300*            SET MORE-IMRCVS-DATA TO TRUE                                 
124400*            PERFORM R100-FETCH-IMRCVS                                    
124500*               UNTIL NO-MORE-IMRCVS-DATA                                 
124600*            MOVE 'TIMRCVS' TO DS009-PROCESS-TABLE                        
124700*            PERFORM Y100-CLOSE-CURSOR                                    
124800        WHEN DS009-PROCESS-TABLE = 'TIMCSPO'                              
124900             PERFORM Y100-OPEN-CURSOR                                     
125000             SET MORE-IMCSPO-DATA TO TRUE                                 
125100             PERFORM R100-FETCH-IMCSPO                                    
125200                UNTIL NO-MORE-IMCSPO-DATA                                 
125300             MOVE 'TIMCSPO' TO DS009-PROCESS-TABLE                        
125400             PERFORM Y100-CLOSE-CURSOR                                    
125500        WHEN DS009-PROCESS-TABLE = 'TAURCPO'                              
125600             PERFORM Y100-OPEN-CURSOR                                     
125700             SET MORE-AURCPO-DATA TO TRUE                                 
125800             PERFORM R100-FETCH-AURCPO                                    
125900                UNTIL NO-MORE-AURCPO-DATA                                 
126000             MOVE 'TAURCPO' TO DS009-PROCESS-TABLE                        
126100             PERFORM Y100-CLOSE-CURSOR                                    
126200*       WHEN DS009-PROCESS-TABLE = 'TAURCVS'                              
126300*            PERFORM Y100-OPEN-CURSOR                                     
126400*            SET MORE-AURCVS-DATA TO TRUE                                 
126500*            PERFORM R100-FETCH-AURCVS                                    
126600*               UNTIL NO-MORE-AURCVS-DATA                                 
126700*            MOVE 'TAURCVS' TO DS009-PROCESS-TABLE                        
126800*            PERFORM Y100-CLOSE-CURSOR                                    
126900*       WHEN DS009-PROCESS-TABLE = 'TAURCUP'                              
127000*            PERFORM Y100-OPEN-CURSOR                                     
127100*            SET MORE-AURCUP-DATA TO TRUE                                 
127200*            PERFORM R100-FETCH-AURCUP                                    
127300*               UNTIL NO-MORE-AURCUP-DATA                                 
127400*            MOVE 'TAURCUP' TO DS009-PROCESS-TABLE                        
127500*            PERFORM Y100-CLOSE-CURSOR                                    
127600        WHEN DS009-PROCESS-TABLE = 'TAUBKPO'                              
127700             PERFORM Y100-OPEN-CURSOR                                     
127800             SET MORE-AUBKPO-DATA TO TRUE                                 
127900             PERFORM R100-FETCH-AUBKPO                                    
128000                UNTIL NO-MORE-AUBKPO-DATA                                 
128100             MOVE 'TAUBKPO' TO DS009-PROCESS-TABLE                        
128200             PERFORM Y100-CLOSE-CURSOR                                    
128300*       WHEN DS009-PROCESS-TABLE = 'TAUBKVS'                              
128400*            PERFORM Y100-OPEN-CURSOR                                     
128500*            SET MORE-AUBKVS-DATA TO TRUE                                 
128600*            PERFORM R100-FETCH-AUBKVS                                    
128700*               UNTIL NO-MORE-AUBKVS-DATA                                 
128800*            MOVE 'TAUBKVS' TO DS009-PROCESS-TABLE                        
128900*            PERFORM Y100-CLOSE-CURSOR                                    
129000*       WHEN DS009-PROCESS-TABLE = 'TAUBKUP'                              
129100*            PERFORM Y100-OPEN-CURSOR                                     
129200*            SET MORE-AUBKUP-DATA TO TRUE                                 
129300*            PERFORM R100-FETCH-AUBKUP                                    
129400*               UNTIL NO-MORE-AUBKUP-DATA                                 
129500*            MOVE 'TAUBKUP' TO DS009-PROCESS-TABLE                        
129600*            PERFORM Y100-CLOSE-CURSOR                                    
129700        WHEN DS009-PROCESS-TABLE = 'TAUCNPO'                              
129800             PERFORM Y100-OPEN-CURSOR                                     
129900             SET MORE-AUCNPO-DATA TO TRUE                                 
130000             PERFORM R100-FETCH-AUCNPO                                    
130100                UNTIL NO-MORE-AUCNPO-DATA                                 
130200             MOVE 'TAUCNPO' TO DS009-PROCESS-TABLE                        
130300             PERFORM Y100-CLOSE-CURSOR                                    
130400        WHEN DS009-PROCESS-TABLE = 'TAUCNUP'                              
130500             PERFORM Y100-OPEN-CURSOR                                     
130600             SET MORE-AUCNUP-DATA TO TRUE                                 
130700             PERFORM R100-FETCH-AUCNUP                                    
130800                UNTIL NO-MORE-AUCNUP-DATA                                 
130900             MOVE 'TAUCNUP' TO DS009-PROCESS-TABLE                        
131000             PERFORM Y100-CLOSE-CURSOR                                    
131100        WHEN DS009-PROCESS-TABLE = 'TRT_AUD_IMPRT_CART'                   
131200             PERFORM Y100-OPEN-CURSOR                                     
131300             SET MORE-AUD-CART-DATA TO TRUE                               
131400             PERFORM R100-FETCH-TRT00009-AUD-CART                         
131500                UNTIL NO-MORE-AUD-CART-DATA                               
131600             MOVE 'TRT_AUD_IMPRT_CART'                                    
131700                                 TO DS009-PROCESS-TABLE                   
131800             PERFORM Y100-CLOSE-CURSOR                                    
131900        WHEN DS009-PROCESS-TABLE = 'TELCPO'                               
132000             PERFORM Y100-OPEN-CURSOR                                     
132100             SET MORE-ELCPO-DATA TO TRUE                                  
132200             PERFORM R100-FETCH-ELCPO                                     
132300                UNTIL NO-MORE-ELCPO-DATA                                  
132400             MOVE 'TELCPO' TO DS009-PROCESS-TABLE                         
132500             PERFORM Y100-CLOSE-CURSOR                                    
132600        WHEN DS009-PROCESS-TABLE = 'TELCVS'                               
132700             PERFORM Y100-OPEN-CURSOR                                     
132800             SET MORE-ELCVS-DATA TO TRUE                                  
132900             PERFORM R100-FETCH-ELCVS                                     
133000                UNTIL NO-MORE-ELCVS-DATA                                  
133100             MOVE 'TELCVS' TO DS009-PROCESS-TABLE                         
133200             PERFORM Y100-CLOSE-CURSOR                                    
133300        WHEN DS009-PROCESS-TABLE = 'TVSCPT'                               
133400             PERFORM Y100-OPEN-CURSOR                                     
133500             SET MORE-VSCPT-DATA TO TRUE                                  
133600             PERFORM R100-FETCH-VSCPT                                     
133700                UNTIL NO-MORE-VSCPT-DATA                                  
133800             MOVE 'TVSCPT' TO DS009-PROCESS-TABLE                         
133900             PERFORM Y100-CLOSE-CURSOR                                    
134000*       WHEN DS009-PROCESS-TABLE = 'TIMCNRL'                              
134100*            PERFORM Y100-OPEN-CURSOR                                     
134200*            SET MORE-IMCNRL-DATA TO TRUE                                 
134300*            PERFORM R100-FETCH-IMCNRL                                    
134400*               UNTIL NO-MORE-IMCNRL-DATA                                 
134500*            MOVE 'TIMCNRL' TO DS009-PROCESS-TABLE                        
134600*            PERFORM Y100-CLOSE-CURSOR                                    
134700*       WHEN DS009-PROCESS-TABLE = 'TAUCNRL'                              
134800*            PERFORM Y100-OPEN-CURSOR                                     
134900*            SET MORE-AUCNRL-DATA TO TRUE                                 
135000*            PERFORM R100-FETCH-AUCNRL                                    
135100*               UNTIL NO-MORE-AUCNRL-DATA                                 
135200*            MOVE 'TAUCNRL' TO DS009-PROCESS-TABLE                        
135300*            PERFORM Y100-CLOSE-CURSOR                                    
135400                                                                          
135500        WHEN DS009-PROCESS-TABLE = 'TRT_RUL_CNSTR'                        
135600                                                                          
135700*   OPEN RULES DRIVER FOR PO SPLITS CSR HERE                              
135800             SET DS010-END-PO-RUL-DRIVER-NO TO TRUE                       
135900             PERFORM R900P1-OPEN-PO-DRIVER                                
136000             PERFORM R900P2-FETCH-PO-DRIVER                               
136100                                                                          
136200             PERFORM UNTIL DS010-END-PO-RUL-DRIVER-YES                    
136300                 PERFORM R900-FETCH-DA-RULES                              
136400                 PERFORM R900P2-FETCH-PO-DRIVER                           
136500             END-PERFORM                                                  
136600                                                                          
136700             PERFORM R900P3-CLOSE-PO-DRIVER                               
131900*       WHEN DS009-PROCESS-TABLE = 'RPLNT_INBND_PO'                       
132000*            PERFORM Y100-OPEN-CURSOR                                     
132100*            SET MORE-TRT00057-DATA TO TRUE                               
132200*            PERFORM R100-FETCH-TRT00057                                  
132300*               UNTIL NO-MORE-TRT00057-DATA                               
132500*            PERFORM Y100-CLOSE-CURSOR                                    
131900*       WHEN DS009-PROCESS-TABLE = 'RPLNT_INBND_PO_AUD'                   
132000*            PERFORM Y100-OPEN-CURSOR                                     
132100*            SET MORE-TRT00060-DATA TO TRUE                               
132200*            PERFORM R100-FETCH-TRT00060                                  
132300*               UNTIL NO-MORE-TRT00060-DATA                               
132500*            PERFORM Y100-CLOSE-CURSOR                                    
136800                                                                          
136900        END-EVALUATE.                                                     
137000/                                                                         
137100 R101-FETCH-IMCNPO.                                                       
137200*                                                                         
137300     MOVE 'TIMCNPO' TO DS009-PROCESS-TABLE.                               
137400     PERFORM WITH TEST AFTER                                              
137500        VARYING DS009-RETRY-COUNTER FROM 1 BY 1                           
137600        UNTIL   DS009-RETRY-COUNTER > 3 OR                                
137700                SQLCODE = ZERO OR                                         
137800                SQLCODE = +100                                            
137900        EXEC SQL                                                          
138000            FETCH IMCNPO-CSR                                              
138100            INTO                                                          
138200              :IMCNPO-CONTNR-ID                                           
138300           ,  :IMCNPO-CONTNR-SEQ-NBR                                      
138400           ,  :IMCNPO-PO-NBR                                              
138500           ,  :IMCNPO-CSTM-ENTR-ID                                        
138600           ,  :IMCNPO-MSTR-BOL-NBR                                        
138700           ,  :IMCNPO-HSE-BOL-NBR                                         
138800           ,  :IMCNPO-LTR-OF-CR-NBR                                       
138900           ,  :IMCNPO-PO-RCVD-DELY-TMST                                   
139000           ,  :IMCNPO-PO-C-O-PROD-CDE                                     
139100           ,  :IMCNPO-PO-CART-CNT                                         
139200           ,  :IMCNPO-PO-CBMT-QTY                                 .       
139300           ,  :IMCNPO-PO-WT-KGRM-QTY                                      
139400           ,  :IMCNPO-PO-UNT-QTY                                          
139500           ,  :IMCNPO-CRE-BY-USR-ID                                       
139600           ,  :IMCNPO-CRE-TMST                                            
139700           ,  :IMCNPO-LAST-UPD-BY-USR-ID                                  
139800           ,  :IMCNPO-LAST-UPD-TMST                                       
139900           ,  :IMCNPO-EXTL-REF-NBR                                        
140000           ,  :IMCNPO-BKR-FRGT-RLSE-CDE                                   
140100           ,  :IMCNPO-DO-RCVD-CDE                                         
140200           ,  :IMCNPO-CONTNR-PU-CDE                                       
140300           ,  :IMCNPO-ACTL-POE-DELY-CDE                                   
140400           ,  :IMCNPO-DVN-CDE                                             
140500           ,  :IMCNPO-DCONSLR-RET-CDE                                     
140600           ,  :IMCNPO-SPLT-XMIT-CDE                                       
140700           ,  :IMCNPO-DOC-RCVD-ORGN-TMST                                  
140700           ,  :IMCNPO-DCONSLR-DELY-CDE                                    
140800        END-EXEC                                                          
140900                                                                          
141000        EVALUATE TRUE                                                     
141100            WHEN SQLCODE = ZERO OR -305                                   
119700               DISPLAY DS009-PROCESS-TABLE                                
140700               DISPLAY IMCNPO-DOC-RCVD-ORGN-TMST                          
141200               MOVE LENGTH OF DCLTIMCNPO TO DS009-TBLE-DATA-SIZE          
141300               COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE           
141400                                      + DS009-RECORD-FILLER               
141500               MOVE 01     TO DS002-ORDER                                 
141600               MOVE 01     TO DS002-VERSION                               
141700               MOVE DS009-TBLE-DATA-SIZE TO DS002-DATA-SIZE               
141800               MOVE 'TIMCNPO'            TO DS002-NAME                    
141900               MOVE DCLTIMCNPO           TO DS002-DATA-ITEM               
142000               INITIALIZE DS009-PKYS                                      
142100               PERFORM DS002-PROCESS-KEYS                                 
142200               MOVE WS-IMCNPO-KEYS  TO DS009-PKYS                         
142300               MOVE DS009-PKYS      TO DS002-KEYS                         
142400               PERFORM 8000-WRITE-UNLOAD                                  
142500                                                                          
142600               MOVE IMCNPO-CONTNR-ID TO HOLD-CONTNR-ID                    
142700               MOVE IMCNPO-CONTNR-SEQ-NBR                                 
142800                                        TO HOLD-CONTNR-SEQ-NBR            
142900                                                                          
143000               MOVE 'TIMCNTK' TO DS009-PROCESS-TABLE                      
143100               PERFORM DS002-DO-PROCESS                                   
143200               IF DS009-DO-PROCESS                                        
143300                  SET MORE-IMCNTK-DATA TO TRUE                            
143400                  PERFORM Y100-OPEN-CURSOR                                
143500                  PERFORM R100-FETCH-IMCNTK                               
143600                      UNTIL NO-MORE-IMCNTK-DATA                           
143700                  MOVE 'TIMCNTK' TO DS009-PROCESS-TABLE                   
143800                  PERFORM Y100-CLOSE-CURSOR                               
143900               END-IF                                                     
144000                                                                          
144100               MOVE 'TIMCNRL' TO DS009-PROCESS-TABLE                      
144200               PERFORM DS002-DO-PROCESS                                   
144300               IF DS009-DO-PROCESS                                        
144400                   PERFORM Y100-OPEN-CURSOR                               
144500                   SET MORE-IMCNRL-DATA TO TRUE                           
144600                   PERFORM R100-FETCH-IMCNRL                              
144700                      UNTIL NO-MORE-IMCNRL-DATA                           
144800                   PERFORM Y100-CLOSE-CURSOR                              
144900               END-IF                                                     
145000*                                                                         
145100               MOVE 'TAUCNRL' TO DS009-PROCESS-TABLE                      
145200               PERFORM DS002-DO-PROCESS                                   
145300               IF DS009-DO-PROCESS                                        
145400                   PERFORM Y100-OPEN-CURSOR                               
145500                   SET MORE-AUCNRL-DATA TO TRUE                           
145600                   PERFORM R100-FETCH-AUCNRL                              
145700                      UNTIL NO-MORE-AUCNRL-DATA                           
145800                   PERFORM Y100-CLOSE-CURSOR                              
145900               END-IF                                                     
146000*                                                                         
146100               MOVE 'TIMCNUP' TO DS009-PROCESS-TABLE                      
146200               PERFORM DS002-DO-PROCESS                                   
146300               IF DS009-DO-PROCESS                                        
146400                  SET MORE-IMCNUP-DATA TO TRUE                            
146500                  PERFORM Y100-OPEN-CURSOR                                
146600                  PERFORM R100-FETCH-IMCNUP                               
146700                      UNTIL NO-MORE-IMCNUP-DATA                           
146800                  MOVE 'TIMCNUP' TO DS009-PROCESS-TABLE                   
146900                  PERFORM Y100-CLOSE-CURSOR                               
147000               END-IF                                                     
147100                                                                          
147200               MOVE 'TRT_IMPRT_CART' TO DS009-PROCESS-TABLE               
147300               PERFORM DS002-DO-PROCESS                                   
147400               IF DS009-DO-PROCESS                                        
147500                  SET MORE-CART-DATA TO TRUE                              
147600                  PERFORM Y100-OPEN-CURSOR                                
147700                  PERFORM R100-FETCH-TRT00008-IMPRT-CART                  
147800                      UNTIL NO-MORE-CART-DATA                             
147900                  MOVE 'TRT_IMPRT_CART' TO DS009-PROCESS-TABLE            
148000                  PERFORM Y100-CLOSE-CURSOR                               
148100               END-IF                                                     
148200                                                                          
148300                                                                          
148400*   OPEN RULES DRIVER FOR CONTAINER SPLITS CSR HERE                       
148500             SET DS010-END-RUL-DRIVER-NO TO TRUE                          
148600             PERFORM R900C1-OPEN-CONT-DRIVER                              
148700             PERFORM R900C2-FETCH-CONT-DRIVER                             
148800                                                                          
148900             PERFORM UNTIL DS010-END-RUL-DRIVER-YES                       
149000                 PERFORM R900-FETCH-DA-RULES                              
149100                 PERFORM R900C2-FETCH-CONT-DRIVER                         
149200             END-PERFORM                                                  
149300                                                                          
149400             PERFORM R900C3-CLOSE-CONT-DRIVER                             
149500                                                                          
149600            WHEN SQLCODE = +100                                           
149700                 SET NO-MORE-IMCNPO-DATA  TO TRUE                         
149800            WHEN SQLCODE = -904                                           
149900            WHEN SQLCODE = -913                                           
150000              CONTINUE                                                    
150100           END-EVALUATE                                                   
150200         END-PERFORM.                                                     
150300*****************************************************************         
150400     PERFORM DS002-SQL-ABEND-FETCH.                                       
150500*****************************************************************         
150600/                                                                         
150700*****************************************************************         
150800*     FETCH IMBKVS DATA                                                   
150900*****************************************************************         
151000*R100-FETCH-IMBKVS.                                                       
151100*                                                                         
151200*    MOVE 'TIMBKVS' TO DS009-PROCESS-TABLE.                               
151300*    PERFORM WITH TEST AFTER                                              
151400*       VARYING DS009-RETRY-COUNTER FROM 1 BY 1                           
151500*       UNTIL   DS009-RETRY-COUNTER > 3 OR                                
151600*               SQLCODE = ZERO OR                                         
151700*               SQLCODE = +100                                            
151800*       EXEC SQL                                                          
151900*           FETCH IMBKVS_CSR                                              
152000*           INTO                                                          
152100*                :WS-IMBKVS-PO-NBR                                        
152200*               ,:WS-IMBKVS-PO-BKG-SEQ-NBR                                
152300*               ,:WS-IMBKVS-VS-NBR                                        
152400*               ,:WS-IMBKVS-HTS-ID                                        
152500*               ,:WS-IMBKVS-VS-CART-CNT                                   
152600*               ,:WS-IMBKVS-VS-CBMT-QTY                                   
152700*               ,:WS-IMBKVS-VS-WT-KGRM-QTY                                
152800*               ,:WS-IMBKVS-VS-UNT-QTY                                    
152900*               ,:WS-IMBKVS-QTA-CTG-IND                                   
153000*               ,:WS-IMBKVS-CRE-BY-USR-ID                                 
153100*               ,:WS-IMBKVS-CRE-TMST                                      
153200*               ,:WS-IMBKVS-LAST-UPD-BY-USR-ID                            
153300*               ,:WS-IMBKVS-LAST-UPD-TMST                                 
153400*       END-EXEC                                                          
153500*                                                                         
153600*       EVALUATE TRUE                                                     
153700*           WHEN SQLCODE = ZERO OR -305                                   
153800*                MOVE LENGTH OF WS-IMBKVS TO DS009-TBLE-DATA-SIZE         
153900*                COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE         
154000*                                          + DS009-RECORD-FILLER          
154100*                MOVE 02     TO DS002-ORDER                               
154200*                MOVE 01     TO DS002-VERSION                             
154300*                MOVE DS009-TBLE-DATA-SIZE TO DS002-DATA-SIZE             
154400*                MOVE 'TIMBKVS'            TO DS002-NAME                  
154500*                MOVE WS-IMBKVS            TO DS002-DATA-ITEM             
154600*                INITIALIZE DS009-PKYS                                    
154700*                PERFORM DS002-PROCESS-KEYS                               
154800*                MOVE WS-IMBKVS-KEYS  TO DS009-PKYS                       
154900*                MOVE DS009-PKYS      TO DS002-KEYS                       
155000*                PERFORM 8000-WRITE-UNLOAD                                
155100*           WHEN SQLCODE = +100                                           
155200*                SET NO-MORE-IMBKVS-DATA  TO TRUE                         
155300*           WHEN SQLCODE = -904                                           
155400*           WHEN SQLCODE = -913                                           
155500*             CONTINUE                                                    
155600*          END-EVALUATE                                                   
155700*        END-PERFORM.                                                     
155800*****************************************************************         
155900     PERFORM DS002-SQL-ABEND-FETCH.                                       
156000*****************************************************************         
156100/                                                                         
156200*****************************************************************         
156300*     FETCH IMBKUP DATA                                                   
156400*****************************************************************         
156500*R100-FETCH-IMBKUP.                                                       
156600*                                                                         
156700*    MOVE 'TIMBKUP' TO DS009-PROCESS-TABLE.                               
156800*    PERFORM WITH TEST AFTER                                              
156900*       VARYING DS009-RETRY-COUNTER FROM 1 BY 1                           
157000*       UNTIL   DS009-RETRY-COUNTER > 3 OR                                
157100*               SQLCODE = ZERO OR                                         
157200*               SQLCODE = +100                                            
157300*       EXEC SQL                                                          
157400*           FETCH IMBKUP_CSR                                              
157500*           INTO                                                          
157600*                :WS-IMBKUP-PO-NBR                                        
157700*               ,:WS-IMBKUP-PO-BKG-SEQ-NBR                                
157800*               ,:WS-IMBKUP-VS-NBR                                        
157900*               ,:WS-IMBKUP-UPC-NBR                                       
158000*               ,:WS-IMBKUP-UPC-CART-CNT                                  
158100*               ,:WS-IMBKUP-UPC-CBMT-QTY                                  
158200*               ,:WS-IMBKUP-UPC-WT-KGRM-QTY                               
158300*               ,:WS-IMBKUP-UPC-UNT-QTY                                   
158400*               ,:WS-IMBKUP-CRE-BY-USR-ID                                 
158500*               ,:WS-IMBKUP-CRE-TMST                                      
158600*               ,:WS-IMBKUP-LAST-UPD-BY-USR-ID                            
158700*               ,:WS-IMBKUP-LAST-UPD-TMST                                 
158800*       END-EXEC                                                          
158900*                                                                         
159000*       EVALUATE TRUE                                                     
159100*           WHEN SQLCODE = ZERO OR -305                                   
159200*                MOVE LENGTH OF WS-IMBKUP TO DS009-TBLE-DATA-SIZE         
159300*                COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE         
159400*                                          + DS009-RECORD-FILLER          
159500*                MOVE 02     TO DS002-ORDER                               
159600*                MOVE 01     TO DS002-VERSION                             
159700*                MOVE DS009-TBLE-DATA-SIZE TO DS002-DATA-SIZE             
159800*                MOVE 'TIMBKUP'            TO DS002-NAME                  
159900*                MOVE WS-IMBKUP            TO DS002-DATA-ITEM             
160000*                INITIALIZE DS009-PKYS                                    
160100*                PERFORM DS002-PROCESS-KEYS                               
160200*                MOVE WS-IMBKUP-KEYS  TO DS009-PKYS                       
160300*                MOVE DS009-PKYS      TO DS002-KEYS                       
160400*                PERFORM 8000-WRITE-UNLOAD                                
160500*           WHEN SQLCODE = +100                                           
160600*                SET NO-MORE-IMBKUP-DATA  TO TRUE                         
160700*           WHEN SQLCODE = -904                                           
160800*           WHEN SQLCODE = -913                                           
160900*             CONTINUE                                                    
161000*          END-EVALUATE                                                   
161100*        END-PERFORM.                                                     
161200*****************************************************************         
161300     PERFORM DS002-SQL-ABEND-FETCH.                                       
161400*****************************************************************         
161500/                                                                         
161600*                                                                         
161700*****************************************************************         
161800*     FETCH IMRCPO DATA                                                   
161900*****************************************************************         
162000 R100-FETCH-IMRCPO.                                                       
162100*                                                                         
162200     MOVE 'TIMRCPO' TO DS009-PROCESS-TABLE.                               
162300     PERFORM WITH TEST AFTER                                              
162400        VARYING DS009-RETRY-COUNTER FROM 1 BY 1                           
162500        UNTIL   DS009-RETRY-COUNTER > 3 OR                                
162600                SQLCODE = ZERO OR                                         
162700                SQLCODE = +100                                            
162800        EXEC SQL                                                          
162900            FETCH IMRCPO_CSR                                              
163000            INTO                                                          
163100                 :WS-IMRCPO-PO-NBR                                        
163200                ,:WS-IMRCPO-PO-RCVD-SEQ-NBR                               
163300                ,:WS-IMRCPO-PO-RCVD-DELY-TMST                             
163400                ,:WS-IMRCPO-EXTL-REF-NBR                                  
163500                ,:WS-IMRCPO-ORGN-SHPD-FR-CDE                              
163600                ,:WS-IMRCPO-CONSLR-SCAC-ID                                
163700                ,:WS-IMRCPO-IMPRT-TRIP-ID                                 
163800                ,:WS-IMRCPO-DPRTR-TMST                                    
163900                ,:WS-IMRCPO-POE-DELY-TMST                                 
164000                ,:WS-IMRCPO-CARR-SCAC-ID                                  
164100                ,:WS-IMRCPO-FOB-CDE                                       
164200                ,:WS-IMRCPO-IMPRT-VEH-NM                                  
164300                ,:WS-IMRCPO-TRIP-TYP-CDE                                  
164400                ,:WS-IMRCPO-DEST-POE-CDE                                  
164500                ,:WS-IMRCPO-C-O-PROD-CDE                                  
164600                ,:WS-IMRCPO-PROD-FCTRY-NM                                 
164700                ,:WS-IMRCPO-PO-CART-CNT                                   
164800                ,:WS-IMRCPO-PO-CBMT-QTY                                   
164900                ,:WS-IMRCPO-PO-WT-KGRM-QTY                                
165000                ,:WS-IMRCPO-PO-UNT-QTY                                    
165100                ,:WS-IMRCPO-PO-EXC-APVL-CDE                               
165200                ,:WS-IMRCPO-PO-EXC-APVL-USR-ID                            
165300                ,:WS-IMRCPO-PO-EXC-APVL-TMST                              
165400                ,:WS-IMRCPO-PO-EXC-RSN-DESC                               
165500                ,:WS-IMRCPO-EST-LBD-NM                                    
165600                ,:WS-IMRCPO-EST-LBD-TMST                                  
165700                ,:WS-IMRCPO-VOY-CHG-RSN-DESC                              
165800                ,:WS-IMRCPO-DAT-SRC-ENT-ID                                
165900                ,:WS-IMRCPO-CRE-BY-USR-ID                                 
166000                ,:WS-IMRCPO-CRE-TMST                                      
166100                ,:WS-IMRCPO-LAST-UPD-BY-USR-ID                            
166200                ,:WS-IMRCPO-LAST-UPD-TMST                                 
166300        END-EXEC                                                          
166400                                                                          
166500        EVALUATE TRUE                                                     
166600            WHEN SQLCODE = ZERO OR -305                                   
166700                 MOVE LENGTH OF WS-IMRCPO TO DS009-TBLE-DATA-SIZE         
166800                 COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE         
166900                                           + DS009-RECORD-FILLER          
167000                 MOVE 01     TO DS002-ORDER                               
167100                 MOVE 01     TO DS002-VERSION                             
167200                 MOVE DS009-TBLE-DATA-SIZE TO DS002-DATA-SIZE             
167300                 MOVE 'TIMRCPO'            TO DS002-NAME                  
167400                 MOVE WS-IMRCPO            TO DS002-DATA-ITEM             
167500                 INITIALIZE DS009-PKYS                                    
167600                 PERFORM DS002-PROCESS-KEYS                               
167700                 MOVE WS-IMRCPO-KEYS  TO DS009-PKYS                       
167800                 MOVE DS009-PKYS      TO DS002-KEYS                       
167900                 PERFORM 8000-WRITE-UNLOAD                                
168000            WHEN SQLCODE = +100                                           
168100                 SET NO-MORE-IMRCPO-DATA  TO TRUE                         
168200            WHEN SQLCODE = -904                                           
168300            WHEN SQLCODE = -913                                           
168400              CONTINUE                                                    
168500           END-EVALUATE                                                   
168600         END-PERFORM.                                                     
168700*****************************************************************         
168800     PERFORM DS002-SQL-ABEND-FETCH.                                       
168900*****************************************************************         
169000/                                                                         
169100*****************************************************************         
169200*     FETCH IMRCUP DATA                                                   
169300*****************************************************************         
169400*R100-FETCH-IMRCUP.                                                       
169500*                                                                         
169600*    MOVE 'TIMRCUP' TO DS009-PROCESS-TABLE.                               
169700*    PERFORM WITH TEST AFTER                                              
169800*       VARYING DS009-RETRY-COUNTER FROM 1 BY 1                           
169900*       UNTIL   DS009-RETRY-COUNTER > 3 OR                                
170000*               SQLCODE = ZERO OR                                         
170100*               SQLCODE = +100                                            
170200*       EXEC SQL                                                          
170300*           FETCH IMRCUP_CSR                                              
170400*           INTO                                                          
170500*                :WS-IMRCUP-PO-NBR                                        
170600*               ,:WS-IMRCUP-PO-RCVD-SEQ-NBR                               
170700*               ,:WS-IMRCUP-VS-NBR                                        
170800*               ,:WS-IMRCUP-UPC-NBR                                       
170900*               ,:WS-IMRCUP-UPC-CART-CNT                                  
171000*               ,:WS-IMRCUP-UPC-CBMT-QTY                                  
171100*               ,:WS-IMRCUP-UPC-WT-KGRM-QTY                               
171200*               ,:WS-IMRCUP-UPC-UNT-QTY                                   
171300*               ,:WS-IMRCUP-CRE-BY-USR-ID                                 
171400*               ,:WS-IMRCUP-CRE-TMST                                      
171500*               ,:WS-IMRCUP-LAST-UPD-BY-USR-ID                            
171600*               ,:WS-IMRCUP-LAST-UPD-TMST                                 
171700*       END-EXEC                                                          
171800*                                                                         
171900*       EVALUATE TRUE                                                     
172000*           WHEN SQLCODE = ZERO OR -305                                   
172100*                MOVE LENGTH OF WS-IMRCUP TO DS009-TBLE-DATA-SIZE         
172200*                COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE         
172300*                                          + DS009-RECORD-FILLER          
172400*                MOVE 02     TO DS002-ORDER                               
172500*                MOVE 01     TO DS002-VERSION                             
172600*                MOVE DS009-TBLE-DATA-SIZE TO DS002-DATA-SIZE             
172700*                MOVE 'TIMRCUP'            TO DS002-NAME                  
172800*                MOVE WS-IMRCUP            TO DS002-DATA-ITEM             
172900*                INITIALIZE DS009-PKYS                                    
173000*                PERFORM DS002-PROCESS-KEYS                               
173100*                MOVE WS-IMRCUP-KEYS  TO DS009-PKYS                       
173200*                MOVE DS009-PKYS      TO DS002-KEYS                       
173300*                PERFORM 8000-WRITE-UNLOAD                                
173400*           WHEN SQLCODE = +100                                           
173500*                SET NO-MORE-IMRCUP-DATA  TO TRUE                         
173600*           WHEN SQLCODE = -904                                           
173700*           WHEN SQLCODE = -913                                           
173800*             CONTINUE                                                    
173900*          END-EVALUATE                                                   
174000*        END-PERFORM.                                                     
174100*****************************************************************         
174200     PERFORM DS002-SQL-ABEND-FETCH.                                       
174300*****************************************************************         
174400/                                                                         
174500*****************************************************************         
174600*     FETCH IMRCVS DATA                                                   
174700*****************************************************************         
174800*R100-FETCH-IMRCVS.                                                       
174900*                                                                         
175000*    MOVE 'TIMRCVS' TO DS009-PROCESS-TABLE.                               
175100*    PERFORM WITH TEST AFTER                                              
175200*       VARYING DS009-RETRY-COUNTER FROM 1 BY 1                           
175300*       UNTIL   DS009-RETRY-COUNTER > 3 OR                                
175400*               SQLCODE = ZERO OR                                         
175500*               SQLCODE = +100                                            
175600*       EXEC SQL                                                          
175700*           FETCH IMRCVS_CSR                                              
175800*           INTO                                                          
175900*                :WS-IMRCVS-PO-NBR                                        
176000*               ,:WS-IMRCVS-PO-RCVD-SEQ-NBR                               
176100*               ,:WS-IMRCVS-VS-NBR                                        
176200*               ,:WS-IMRCVS-HTS-ID                                        
176300*               ,:WS-IMRCVS-VS-CART-CNT                                   
176400*               ,:WS-IMRCVS-VS-CBMT-QTY                                   
176500*               ,:WS-IMRCVS-VS-WT-KGRM-QTY                                
176600*               ,:WS-IMRCVS-VS-UNT-QTY                                    
176700*               ,:WS-IMRCVS-QTA-CTG-IND                                   
176800*               ,:WS-IMRCVS-CRE-BY-USR-ID                                 
176900*               ,:WS-IMRCVS-CRE-TMST                                      
177000*               ,:WS-IMRCVS-LAST-UPD-BY-USR-ID                            
177100*               ,:WS-IMRCVS-LAST-UPD-TMST                                 
177200*       END-EXEC                                                          
177300*                                                                         
177400*       EVALUATE TRUE                                                     
177500*           WHEN SQLCODE = ZERO OR -305                                   
177600*                MOVE LENGTH OF WS-IMRCVS TO DS009-TBLE-DATA-SIZE         
177700*                COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE         
177800*                                          + DS009-RECORD-FILLER          
177900*                MOVE 02     TO DS002-ORDER                               
178000*                MOVE 01     TO DS002-VERSION                             
178100*                MOVE DS009-TBLE-DATA-SIZE TO DS002-DATA-SIZE             
178200*                MOVE 'TIMRCVS'            TO DS002-NAME                  
178300*                MOVE WS-IMRCVS            TO DS002-DATA-ITEM             
178400*                INITIALIZE DS009-PKYS                                    
178500*                PERFORM DS002-PROCESS-KEYS                               
178600*                MOVE WS-IMRCVS-KEYS  TO DS009-PKYS                       
178700*                MOVE DS009-PKYS      TO DS002-KEYS                       
178800*                PERFORM 8000-WRITE-UNLOAD                                
178900*           WHEN SQLCODE = +100                                           
179000*                SET NO-MORE-IMRCVS-DATA  TO TRUE                         
179100*           WHEN SQLCODE = -904                                           
179200*           WHEN SQLCODE = -913                                           
179300*             CONTINUE                                                    
179400*          END-EVALUATE                                                   
179500*        END-PERFORM.                                                     
179600*****************************************************************         
179700     PERFORM DS002-SQL-ABEND-FETCH.                                       
179800*****************************************************************         
179900/                                                                         
180000*                                                                         
180100*****************************************************************         
180200*     FETCH IMBKPO DATA                                                   
180300*****************************************************************         
180400 R100-FETCH-IMBKPO.                                                       
180500*                                                                         
180600     MOVE 'TIMBKPO' TO DS009-PROCESS-TABLE.                               
180700     PERFORM WITH TEST AFTER                                              
180800        VARYING DS009-RETRY-COUNTER FROM 1 BY 1                           
180900        UNTIL   DS009-RETRY-COUNTER > 3 OR                                
181000                SQLCODE = ZERO OR                                         
181100                SQLCODE = +100                                            
181200        EXEC SQL                                                          
181300            FETCH IMBKPO_CSR                                              
181400            INTO                                                          
181500                 :WS-IMBKPO-PO-NBR                                        
181600                ,:WS-IMBKPO-PO-BKG-SEQ-NBR                                
181700                ,:WS-IMBKPO-PO-BKG-DELY-TMST                              
181800                ,:WS-IMBKPO-EXTL-REF-NBR                                  
181900                ,:WS-IMBKPO-ORGN-SHPD-FR-CDE                              
182000                ,:WS-IMBKPO-CONSLR-SCAC-ID                                
182100                ,:WS-IMBKPO-IMPRT-TRIP-ID                                 
182200                ,:WS-IMBKPO-DPRTR-TMST                                    
182300                ,:WS-IMBKPO-POE-DELY-TMST                                 
182400                ,:WS-IMBKPO-CARR-SCAC-ID                                  
182500                ,:WS-IMBKPO-FOB-CDE                                       
182600                ,:WS-IMBKPO-IMPRT-VEH-NM                                  
182700                ,:WS-IMBKPO-TRIP-TYP-CDE                                  
182800                ,:WS-IMBKPO-DEST-POE-CDE                                  
182900                ,:WS-IMBKPO-C-O-PROD-CDE                                  
183000                ,:WS-IMBKPO-PROD-FCTRY-NM                                 
183100                ,:WS-IMBKPO-PO-CART-CNT                                   
183200                ,:WS-IMBKPO-PO-CBMT-QTY                                   
183300                ,:WS-IMBKPO-PO-WT-KGRM-QTY                                
183400                ,:WS-IMBKPO-PO-UNT-QTY                                    
183500                ,:WS-IMBKPO-PO-EXC-APVL-CDE                               
183600                ,:WS-IMBKPO-PO-EXC-APVL-USR-ID                            
183700                ,:WS-IMBKPO-PO-EXC-APVL-TMST                              
183800                ,:WS-IMBKPO-PO-EXC-RSN-DESC                               
183900                ,:WS-IMBKPO-EST-LBD-NM                                    
184000                ,:WS-IMBKPO-EST-LBD-TMST                                  
184100                ,:WS-IMBKPO-SHIPT-BKG-TMST                                
184200                ,:WS-IMBKPO-VOY-CHG-RSN-DESC                              
184300                ,:WS-IMBKPO-DAT-SRC-ENT-ID                                
184400                ,:WS-IMBKPO-CRE-BY-USR-ID                                 
184500                ,:WS-IMBKPO-CRE-TMST                                      
184600                ,:WS-IMBKPO-LAST-UPD-BY-USR-ID                            
184700                ,:WS-IMBKPO-LAST-UPD-TMST                                 
184800        END-EXEC                                                          
184900                                                                          
185000        EVALUATE TRUE                                                     
185100            WHEN SQLCODE = ZERO OR -305                                   
185200                 MOVE LENGTH OF WS-IMBKPO TO DS009-TBLE-DATA-SIZE         
185300                 COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE         
185400                                           + DS009-RECORD-FILLER          
185500                 MOVE 01     TO DS002-ORDER                               
185600                 MOVE 01     TO DS002-VERSION                             
185700                 MOVE DS009-TBLE-DATA-SIZE TO DS002-DATA-SIZE             
185800                 MOVE 'TIMBKPO'            TO DS002-NAME                  
185900                 MOVE WS-IMBKPO            TO DS002-DATA-ITEM             
186000                 INITIALIZE DS009-PKYS                                    
186100                 PERFORM DS002-PROCESS-KEYS                               
186200                 MOVE WS-IMBKPO-KEYS  TO DS009-PKYS                       
186300                 MOVE DS009-PKYS      TO DS002-KEYS                       
186400                 PERFORM 8000-WRITE-UNLOAD                                
186500                                                                          
186600            WHEN SQLCODE = +100                                           
186700                 SET NO-MORE-IMBKPO-DATA  TO TRUE                         
186800            WHEN SQLCODE = -904                                           
186900            WHEN SQLCODE = -913                                           
187000              CONTINUE                                                    
187100           END-EVALUATE                                                   
187200         END-PERFORM.                                                     
187300*****************************************************************         
187400     PERFORM DS002-SQL-ABEND-FETCH.                                       
187500*****************************************************************         
187600/                                                                         
187700*****************************************************************         
187800*     FETCH IMCNTK DATA                                                   
187900*****************************************************************         
188000 R100-FETCH-IMCNTK.                                                       
188100*                                                                         
188200     MOVE 'TIMCNTK' TO DS009-PROCESS-TABLE.                               
188300     PERFORM WITH TEST AFTER                                              
188400        VARYING DS009-RETRY-COUNTER FROM 1 BY 1                           
188500        UNTIL   DS009-RETRY-COUNTER > 3 OR                                
188600                SQLCODE = ZERO OR                                         
188700                SQLCODE = +100                                            
188800        EXEC SQL                                                          
188900            FETCH IMCNTK-CSR                                              
189000            INTO                                                          
189100                 :IMCNTK-CONTNR-ID                                        
189200               , :IMCNTK-CONTNR-SEQ-NBR                                   
189300               , :IMCNTK-CONSLR-SCAC-ID                                   
189400               , :IMCNTK-MOM-IMPRT-TRIP-ID                                
189500               , :IMCNTK-MOM-DPRTR-TMST                                   
189600               , :IMCNTK-MOM-POE-DELY-TMST                                
189700               , :IMCNTK-MOM-CARR-SCAC-ID                                 
189800               , :IMCNTK-MOM-FOB-CDE                                      
189900               , :IMCNTK-MOM-IMPRT-VEH-NM                                 
190000               , :IMCNTK-MOM-TRIP-TYP-CDE                                 
190100               , :IMCNTK-MOM-DEST-POE-CDE                                 
190200               , :IMCNTK-FDR-IMPRT-TRIP-ID                                
190300               , :IMCNTK-FDR-DPRTR-TMST                                   
190400               , :IMCNTK-FDR-POE-DELY-TMST                                
190500               , :IMCNTK-FDR-CARR-SCAC-ID                                 
190600               , :IMCNTK-FDR-FOB-CDE                                      
190700               , :IMCNTK-FDR-IMPRT-VEH-NM                                 
190800               , :IMCNTK-FDR-TRIP-TYP-CDE                                 
190900               , :IMCNTK-FDR-DEST-POE-CDE                                 
191000               , :IMCNTK-SIZE-CDE                                         
191100               , :IMCNTK-CART-CNT                                         
191200               , :IMCNTK-CBMT-QTY                                         
191300               , :IMCNTK-WT-KGRM-QTY                                      
191400               , :IMCNTK-UNT-QTY                                          
191500               , :IMCNTK-ORGN-SHPD-FR-CDE                                 
191600               , :IMCNTK-ORGN-SHPD-TO-CDE                                 
191700               , :IMCNTK-EST-LBD-NM                                       
191800               , :IMCNTK-EST-LBD-TMST                                     
191900               , :IMCNTK-RISU-DO-RSN-CDE                                  
192000               , :IMCNTK-BKR-FRGT-RLSE-TMST                               
192100               , :IMCNTK-DO-TO-DCONSLR-TMST                               
192200               , :IMCNTK-DO-RCVD-TMST                                     
192300               , :IMCNTK-CONTNR-PU-TMST                                   
192400               , :IMCNTK-DAT-SRC-ENT-ID                                   
192500               , :IMCNTK-CRE-BY-USR-ID                                    
192600               , :IMCNTK-CRE-TMST                                         
192700               , :IMCNTK-LAST-UPD-BY-USR-ID                               
192800               , :IMCNTK-LAST-UPD-TMST                                    
192900               , :IMCNTK-ACTL-POE-DELY-TMST                               
193000               , :IMCNTK-ACTL-DEST-POE-CDE                                
193100               , :IMCNTK-ACTL-LBD-NM                                      
193200               , :IMCNTK-ACTL-LBD-TMST                                    
193300               , :IMCNTK-DVN-TMST                                         
193400               , :IMCNTK-DCONSLR-SCAC-ID                                  
193500               , :IMCNTK-DCONSLR-RET-TMST                                 
193600               , :IMCNTK-MOM-POL-CDE                                      
193700               , :IMCNTK-FDR-POL-CDE                                      
193800               , :IMCNTK-MOM-POR-CDE                                      
193900               , :IMCNTK-FDR-POR-CDE                                      
193900               , :IMCNTK-DCONSLR-DELY-TMST                                
194000        END-EXEC                                                          
194100                                                                          
194200        EVALUATE TRUE                                                     
194300            WHEN SQLCODE = ZERO OR -305                                   
194400                 MOVE LENGTH OF DCLTIMCNTK                                
194500                 TO DS009-TBLE-DATA-SIZE                                  
194600                 COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE         
194700                                           + DS009-RECORD-FILLER          
194800                 MOVE 03     TO DS002-ORDER                               
194900                 MOVE 02     TO DS002-VERSION                             
195000                 MOVE DS009-TBLE-DATA-SIZE TO DS002-DATA-SIZE             
195100                 MOVE 'TIMCNTK'        TO DS002-NAME                      
195200                 MOVE DCLTIMCNTK       TO DS002-DATA-ITEM                 
195300                 INITIALIZE DS009-PKYS                                    
195400                 PERFORM DS002-PROCESS-KEYS                               
195500                 MOVE WS-IMCNTK-KEYS  TO DS009-PKYS                       
195600                 MOVE DS009-PKYS      TO DS002-KEYS                       
195700                 PERFORM 8000-WRITE-UNLOAD                                
195800                                                                          
195900                 MOVE IMCNTK-CONTNR-ID TO HOLD-CONTNR-ID                  
196000                 MOVE IMCNTK-CONTNR-SEQ-NBR                               
196100                              TO HOLD-CONTNR-SEQ-NBR                      
196200                 MOVE 'TAUCNTK' TO DS009-PROCESS-TABLE                    
196300                 PERFORM DS002-DO-PROCESS                                 
196400                 IF DS009-DO-PROCESS                                      
196500                    SET MORE-AUCNTK-DATA TO TRUE                          
196600                    PERFORM Y100-OPEN-CURSOR                              
196700                    PERFORM R100-FETCH-AUCNTK                             
196800                        UNTIL NO-MORE-AUCNTK-DATA                         
196900                    MOVE 'TAUCNTK' TO DS009-PROCESS-TABLE                 
197000                    PERFORM Y100-CLOSE-CURSOR                             
197100                 END-IF                                                   
197200                                                                          
197300                 MOVE IMCNTK-CONTNR-ID TO HOLD-CONTNR-ID                  
197400                 MOVE 'TRT_IMPRT_SEAL' TO DS009-PROCESS-TABLE             
197500                 PERFORM DS002-DO-PROCESS                                 
197600                 IF DS009-DO-PROCESS                                      
197700                    SET MORE-SEAL-DATA TO TRUE                            
197800                    PERFORM Y100-OPEN-CURSOR                              
197900                    PERFORM R100-FETCH-TRT00006-IMPRT-SEAL                
198000                        UNTIL NO-MORE-SEAL-DATA                           
198100                    MOVE 'TRT_IMPRT_SEAL' TO DS009-PROCESS-TABLE          
198200                    PERFORM Y100-CLOSE-CURSOR                             
198300                 END-IF                                                   
198400                                                                          
198500                 MOVE IMCNTK-CONTNR-ID TO HOLD-CONTNR-ID                  
198600                 MOVE 'TRT_AUD_IMPRT_SEAL' TO DS009-PROCESS-TABLE         
198700                 PERFORM DS002-DO-PROCESS                                 
198800                 IF DS009-DO-PROCESS                                      
198900                    SET MORE-AUD-SEAL-DATA TO TRUE                        
199000                    PERFORM Y100-OPEN-CURSOR                              
199100                    PERFORM R100-FETCH-TRT00007-AUD-SEAL                  
199200                        UNTIL NO-MORE-AUD-SEAL-DATA                       
199300                    MOVE 'TRT_AUD_IMPRT_SEAL' TO                          
199400                                            DS009-PROCESS-TABLE           
199500                    PERFORM Y100-CLOSE-CURSOR                             
199600                 END-IF                                                   
199700                                                                          
199800            WHEN SQLCODE = +100                                           
199900                 SET NO-MORE-IMCNTK-DATA  TO TRUE                         
200000            WHEN SQLCODE = -904                                           
200100            WHEN SQLCODE = -913                                           
200200              CONTINUE                                                    
200300           END-EVALUATE                                                   
200400         END-PERFORM.                                                     
200500*****************************************************************         
200600     PERFORM DS002-SQL-ABEND-FETCH.                                       
200700*****************************************************************         
200800/                                                                         
200900*****************************************************************         
201000*     FETCH IMCNUP DATA                                                   
201100*****************************************************************         
201200 R100-FETCH-IMCNUP.                                                       
201300*                                                                         
201400     MOVE 'TIMCNUP' TO DS009-PROCESS-TABLE.                               
201500     PERFORM WITH TEST AFTER                                              
201600        VARYING DS009-RETRY-COUNTER FROM 1 BY 1                           
201700        UNTIL   DS009-RETRY-COUNTER > 3 OR                                
201800                SQLCODE = ZERO OR                                         
201900                SQLCODE = +100                                            
202000        EXEC SQL                                                          
202100            FETCH IMCNUP-CSR                                              
202200            INTO                                                          
202300                 :WS-IMCNUP-CONTNR-ID                                     
202400                ,:WS-IMCNUP-CONTNR-SEQ-NBR                                
202500                ,:WS-IMCNUP-PO-NBR                                        
202600                ,:WS-IMCNUP-VS-NBR                                        
202700                ,:WS-IMCNUP-UPC-NBR                                       
202800                ,:WS-IMCNUP-PO-LNE-NBR                                    
202900                ,:WS-IMCNUP-UPC-CART-CNT                                  
203000                ,:WS-IMCNUP-UPC-CBMT-QTY                                  
203100                ,:WS-IMCNUP-UPC-WT-KGRM-QTY                               
203200                ,:WS-IMCNUP-UPC-UNT-QTY                                   
203300                ,:WS-IMCNUP-CRE-BY-USR-ID                                 
203400                ,:WS-IMCNUP-CRE-TMST                                      
203500                ,:WS-IMCNUP-LAST-UPD-BY-USR-ID                            
203600                ,:WS-IMCNUP-LAST-UPD-TMST                                 
203700                ,:WS-IMCNUP-SKU-NBR                                       
203800                ,:WS-IMCNUP-ASN-PKGNG-CDE                                 
203900        END-EXEC                                                          
204000                                                                          
204100        EVALUATE TRUE                                                     
204200            WHEN SQLCODE = ZERO OR -305                                   
204300                 MOVE LENGTH OF WS-IMCNUP TO DS009-TBLE-DATA-SIZE         
204400                 COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE         
204500                                           + DS009-RECORD-FILLER          
204600                 MOVE 03     TO DS002-ORDER                               
204700                 MOVE 01     TO DS002-VERSION                             
204800                 MOVE DS009-TBLE-DATA-SIZE TO DS002-DATA-SIZE             
204900                 MOVE 'TIMCNUP'         TO DS002-NAME                     
205000                 MOVE WS-IMCNUP         TO DS002-DATA-ITEM                
205100                 INITIALIZE DS009-PKYS                                    
205200                 PERFORM DS002-PROCESS-KEYS                               
205300                 MOVE WS-IMCNUP-KEYS  TO DS009-PKYS                       
205400                 MOVE DS009-PKYS      TO DS002-KEYS                       
205500                 PERFORM 8000-WRITE-UNLOAD                                
205600                                                                          
205700            WHEN SQLCODE = +100                                           
205800                 SET NO-MORE-IMCNUP-DATA   TO TRUE                        
205900                                                                          
206000            WHEN SQLCODE = -904                                           
206100            WHEN SQLCODE = -913                                           
206200              CONTINUE                                                    
206300           END-EVALUATE                                                   
206400         END-PERFORM.                                                     
206500*****************************************************************         
206600     PERFORM DS002-SQL-ABEND-FETCH.                                       
206700*****************************************************************         
206800/                                                                         
206900 R100-FETCH-IMCNRL.                                                       
207000*                                                                         
207100     MOVE 'TIMCNRL' TO DS009-PROCESS-TABLE.                               
207200     PERFORM WITH TEST AFTER                                              
207300        VARYING DS009-RETRY-COUNTER FROM 1 BY 1                           
207400        UNTIL   DS009-RETRY-COUNTER > 3 OR                                
207500                SQLCODE = ZERO OR                                         
207600                SQLCODE = +100                                            
207700        EXEC SQL                                                          
207800            FETCH TIMCNRL-CSR                                             
207900            INTO                                                          
208000              :IMCNRL-CONTNR-ID                                           
208100           ,  :IMCNRL-CONTNR-SEQ-NBR                                      
208200           ,  :IMCNRL-PO-NBR                                              
208300           ,  :IMCNRL-DCONSLR-RLSE-CDE                                    
208400           ,  :IMCNRL-DCONSLR-REQR-DTE                                    
208500           ,  :IMCNRL-DCONSLR-ACTL-DTE                                    
208600           ,  :IMCNRL-DCONSLR-ACTL-TM                                     
208700           ,  :IMCNRL-CRE-TMST                                            
208800           ,  :IMCNRL-CRE-BY-UID                                          
208900           ,  :IMCNRL-LAST-UPD-TMST                                       
209000           ,  :IMCNRL-LAST-UPD-BY-UID                                     
209100           ,  :IMCNRL-DCONSLR-ENT-ID                                      
209200        END-EXEC                                                          
209300                                                                          
209400        EVALUATE TRUE                                                     
209500            WHEN SQLCODE = ZERO OR -305                                   
209600                 MOVE LENGTH OF DCLTIMCNRL TO DS009-TBLE-DATA-SIZE        
209700                 COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE         
209800                                           + DS009-RECORD-FILLER          
209900                 MOVE 03     TO DS002-ORDER                               
210000                 MOVE 01     TO DS002-VERSION                             
210100                 MOVE DS009-TBLE-DATA-SIZE TO DS002-DATA-SIZE             
210200                 MOVE 'TIMCNRL'         TO DS002-NAME                     
210300                 MOVE DCLTIMCNRL        TO DS002-DATA-ITEM                
210400                 INITIALIZE DS009-PKYS                                    
210500                 PERFORM DS002-PROCESS-KEYS                               
210600                 MOVE DS008-TIMCNRL-KEY TO DS009-PKYS                     
210700                 MOVE DS009-PKYS      TO DS002-KEYS                       
210800                 PERFORM 8000-WRITE-UNLOAD                                
210900                                                                          
211000            WHEN SQLCODE = +100                                           
211100                 SET NO-MORE-IMCNRL-DATA   TO TRUE                        
211200                                                                          
211300            WHEN SQLCODE = -904                                           
211400            WHEN SQLCODE = -913                                           
211500              CONTINUE                                                    
211600           END-EVALUATE                                                   
211700         END-PERFORM.                                                     
211800*****************************************************************         
211900     PERFORM DS002-SQL-ABEND-FETCH.                                       
212000*****************************************************************         
212100/                                                                         
212200*****************************************************************         
212300*     FETCH TRT00008_IMPRT_CART DATA                                      
212400*****************************************************************         
212500 R100-FETCH-TRT00008-IMPRT-CART.                                          
212600*                                                                         
212700     MOVE 'TRT_IMPRT_CART' TO DS009-PROCESS-TABLE.                        
212800     PERFORM WITH TEST AFTER                                              
212900        VARYING DS009-RETRY-COUNTER FROM 1 BY 1                           
213000        UNTIL   DS009-RETRY-COUNTER > 3 OR                                
213100                SQLCODE = ZERO OR                                         
213200                SQLCODE = +100                                            
213300        EXEC SQL                                                          
213400            FETCH TRT00008-CART-CSR                                       
213500            INTO                                                          
213600                 :WS-TRT00008-CONTNR-ID                                   
213700                ,:WS-TRT00008-CONTNR-SEQ-NBR                              
213800                ,:WS-TRT00008-PO-NBR                                      
213900                ,:WS-TRT00008-UPC-NBR                                     
214000                ,:WS-TRT00008-SSCC-ID                                     
214100                ,:WS-TRT00008-CRE-BY-USR-ID                               
214200                ,:WS-TRT00008-CRE-TMST                                    
214300                ,:WS-TRT00008-UNT-QTY                                     
214400                ,:WS-TRT00008-LAST-UPD-BY-USR-ID                          
214500                ,:WS-TRT00008-LAST-UPD-TMST                               
214600        END-EXEC                                                          
214700                                                                          
214800        EVALUATE TRUE                                                     
214900            WHEN SQLCODE = ZERO OR -305                                   
215000                 MOVE LENGTH OF WS-TRT00008                               
215100                                          TO DS009-TBLE-DATA-SIZE         
215200                 COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE         
215300                                           + DS009-RECORD-FILLER          
215400                 MOVE 01     TO DS002-ORDER                               
215500                 MOVE 01     TO DS002-VERSION                             
215600                 MOVE DS009-TBLE-DATA-SIZE TO DS002-DATA-SIZE             
215700                 MOVE 'TRT_IMPRT_CART'  TO DS002-NAME                     
215800                 MOVE WS-TRT00008 TO DS002-DATA-ITEM                      
215900                 INITIALIZE DS009-PKYS                                    
216000                 PERFORM DS002-PROCESS-KEYS                               
216100                 MOVE WS-TRT00008-KEYS TO DS009-PKYS                      
216200                 MOVE DS009-PKYS      TO DS002-KEYS                       
216300                 PERFORM 8000-WRITE-UNLOAD                                
216400                                                                          
216500            WHEN SQLCODE = +100                                           
216600                 SET NO-MORE-CART-DATA TO TRUE                            
216700            WHEN SQLCODE = -904                                           
216800            WHEN SQLCODE = -913                                           
216900              CONTINUE                                                    
217000           END-EVALUATE                                                   
217100         END-PERFORM.                                                     
217200*****************************************************************         
217300     PERFORM DS002-SQL-ABEND-FETCH.                                       
217400*****************************************************************         
217500/                                                                         
217600*****************************************************************         
217700*     FETCH TRT00006_IMPRT_SEAL DATA                                      
217800*****************************************************************         
217900 R100-FETCH-TRT00006-IMPRT-SEAL.                                          
218000*                                                                         
218100     MOVE 'TRT_IMPRT_SEAL' TO DS009-PROCESS-TABLE.                        
218200     PERFORM WITH TEST AFTER                                              
218300        VARYING DS009-RETRY-COUNTER FROM 1 BY 1                           
218400        UNTIL   DS009-RETRY-COUNTER > 3 OR                                
218500                SQLCODE = ZERO OR                                         
218600                SQLCODE = +100                                            
218700        EXEC SQL                                                          
218800            FETCH TRT00006_SEAL_CSR                                       
218900            INTO                                                          
219000                 :WS-TRT00006-CONTNR-ID                                   
219100                ,:WS-TRT00006-CONTNR-SEQ-NBR                              
219200                ,:WS-TRT00006-SEAL-NBR                                    
219300                ,:WS-TRT00006-CRE-TMST                                    
219400                ,:WS-TRT00006-CRE-BY-USR-ID                               
219500                ,:WS-TRT00006-LAST-UPD-TMST                               
219600                ,:WS-TRT00006-LAST-UPD-BY-USR-ID                          
219700        END-EXEC                                                          
219800                                                                          
219900        EVALUATE TRUE                                                     
220000            WHEN SQLCODE = ZERO OR -305                                   
220100                 MOVE LENGTH OF WS-TRT00006                               
220200                                          TO DS009-TBLE-DATA-SIZE         
220300                 COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE         
220400                                           + DS009-RECORD-FILLER          
220500                 MOVE 01     TO DS002-ORDER                               
220600                 MOVE 01     TO DS002-VERSION                             
220700                 MOVE DS009-TBLE-DATA-SIZE TO DS002-DATA-SIZE             
220800                 MOVE 'TRT_IMPRT_SEAL'  TO DS002-NAME                     
220900                 MOVE WS-TRT00006 TO DS002-DATA-ITEM                      
221000                 INITIALIZE DS009-PKYS                                    
221100                 PERFORM DS002-PROCESS-KEYS                               
221200                 MOVE WS-TRT00006-KEYS TO DS009-PKYS                      
221300                 MOVE DS009-PKYS      TO DS002-KEYS                       
221400                 PERFORM 8000-WRITE-UNLOAD                                
221500                                                                          
221600            WHEN SQLCODE = +100                                           
221700                 SET NO-MORE-SEAL-DATA TO TRUE                            
221800            WHEN SQLCODE = -904                                           
221900            WHEN SQLCODE = -913                                           
222000              CONTINUE                                                    
222100           END-EVALUATE                                                   
222200         END-PERFORM.                                                     
222300*****************************************************************         
222400     PERFORM DS002-SQL-ABEND-FETCH.                                       
222500*****************************************************************         
222600/                                                                         
222700*****************************************************************         
222800*     FETCH TRT00009_AUD_CART DATA                                        
222900*****************************************************************         
223000 R100-FETCH-TRT00009-AUD-CART.                                            
223100*                                                                         
223200     MOVE 'TRT_AUD_IMPRT_CART' TO DS009-PROCESS-TABLE.                    
223300     PERFORM WITH TEST AFTER                                              
223400        VARYING DS009-RETRY-COUNTER FROM 1 BY 1                           
223500        UNTIL   DS009-RETRY-COUNTER > 3 OR                                
223600                SQLCODE = ZERO OR                                         
223700                SQLCODE = +100                                            
223800        EXEC SQL                                                          
223900            FETCH AUD_CART_CSR                                            
224000            INTO                                                          
224100                 :WS-TRT00009-CONTNR-ID                                   
224200                ,:WS-TRT00009-CONTNR-SEQ-NBR                              
224300                ,:WS-TRT00009-PO-NBR                                      
224400                ,:WS-TRT00009-UPC-NBR                                     
224500                ,:WS-TRT00009-SSCC-ID                                     
224600                ,:WS-TRT00009-UNT-QTY                                     
224700                ,:WS-TRT00009-LAST-UPD-BY-USR-ID                          
224800                ,:WS-TRT00009-LAST-UPD-TMST                               
224900                ,:WS-TRT00009-AUD-FUNC-CDE                                
225000                ,:WS-TRT00009-AUD-TMST                                    
225100        END-EXEC                                                          
225200                                                                          
225300        EVALUATE TRUE                                                     
225400            WHEN SQLCODE = ZERO OR -305                                   
225500                 MOVE LENGTH OF WS-TRT00009                               
225600                                          TO DS009-TBLE-DATA-SIZE         
225700                 COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE         
225800                                           + DS009-RECORD-FILLER          
225900                 MOVE 01     TO DS002-ORDER                               
226000                 MOVE 01     TO DS002-VERSION                             
226100                 MOVE DS009-TBLE-DATA-SIZE TO DS002-DATA-SIZE             
226200                 MOVE 'TRT_AUD_IMPRT_CART' TO DS002-NAME                  
226300                 MOVE WS-TRT00009 TO DS002-DATA-ITEM                      
226400                 INITIALIZE DS009-PKYS                                    
226500                 PERFORM DS002-PROCESS-KEYS                               
226600                 MOVE WS-TRT00009-KEYS                                    
226700                                      TO DS009-PKYS                       
226800                 MOVE DS009-PKYS      TO DS002-KEYS                       
226900                 PERFORM 8000-WRITE-UNLOAD                                
227000                                                                          
227100            WHEN SQLCODE = +100                                           
227200                 SET NO-MORE-AUD-CART-DATA TO TRUE                        
227300            WHEN SQLCODE = -904                                           
227400            WHEN SQLCODE = -913                                           
227500              CONTINUE                                                    
227600           END-EVALUATE                                                   
227700         END-PERFORM.                                                     
227800*****************************************************************         
227900     PERFORM DS002-SQL-ABEND-FETCH.                                       
228000*****************************************************************         
228100/                                                                         
228200*****************************************************************         
228300*     FETCH TRT00007_AUD_SEAL DATA                                        
228400*****************************************************************         
228500 R100-FETCH-TRT00007-AUD-SEAL.                                            
228600*                                                                         
228700     MOVE 'TRT_AUD_IMPRT_SEAL' TO DS009-PROCESS-TABLE.                    
228800     PERFORM WITH TEST AFTER                                              
228900        VARYING DS009-RETRY-COUNTER FROM 1 BY 1                           
229000        UNTIL   DS009-RETRY-COUNTER > 3 OR                                
229100                SQLCODE = ZERO OR                                         
229200                SQLCODE = +100                                            
229300        EXEC SQL                                                          
229400            FETCH AUD_SEAL_CSR                                            
229500            INTO                                                          
229600                 :WS-TRT00007-CONTNR-ID                                   
229700                ,:WS-TRT00007-CONTNR-SEQ-NBR                              
229800                ,:WS-TRT00007-SEAL-NBR                                    
229900                ,:WS-TRT00007-LAST-UPD-TMST                               
230000                ,:WS-TRT00007-LAST-UPD-BY-USR-ID                          
230100                ,:WS-TRT00007-AUD-FUNC-CDE                                
230200                ,:WS-TRT00007-AUD-TMST                                    
230300        END-EXEC                                                          
230400                                                                          
230500        EVALUATE TRUE                                                     
230600            WHEN SQLCODE = ZERO OR -305                                   
230700                 MOVE LENGTH OF WS-TRT00007                               
230800                                          TO DS009-TBLE-DATA-SIZE         
230900                 COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE         
231000                                           + DS009-RECORD-FILLER          
231100                 MOVE 01     TO DS002-ORDER                               
231200                 MOVE 01     TO DS002-VERSION                             
231300                 MOVE DS009-TBLE-DATA-SIZE TO DS002-DATA-SIZE             
231400                 MOVE 'TRT_AUD_IMPRT_SEAL' TO DS002-NAME                  
231500                 MOVE WS-TRT00007 TO DS002-DATA-ITEM                      
231600                 INITIALIZE DS009-PKYS                                    
231700                 PERFORM DS002-PROCESS-KEYS                               
231800                 MOVE WS-TRT00007-KEYS                                    
231900                                      TO DS009-PKYS                       
232000                 MOVE DS009-PKYS      TO DS002-KEYS                       
232100                 PERFORM 8000-WRITE-UNLOAD                                
232200                                                                          
232300            WHEN SQLCODE = +100                                           
232400                 SET NO-MORE-AUD-SEAL-DATA TO TRUE                        
232500            WHEN SQLCODE = -904                                           
232600            WHEN SQLCODE = -913                                           
232700              CONTINUE                                                    
232800           END-EVALUATE                                                   
232900         END-PERFORM.                                                     
233000*****************************************************************         
233100     PERFORM DS002-SQL-ABEND-FETCH.                                       
233200*****************************************************************         
233300/                                                                         
233400*****************************************************************         
233500*     FETCH IMCSEN DATA                                                   
233600*****************************************************************         
233700*                                                                         
233800 R100-FETCH-IMCSEN.                                                       
233900*                                                                         
234000     PERFORM WITH TEST AFTER                                              
234100        VARYING DS009-RETRY-COUNTER FROM 1 BY 1                           
234200        UNTIL   DS009-RETRY-COUNTER > 3 OR                                
234300                SQLCODE = ZERO OR                                         
234400                SQLCODE = +100                                            
234500        EXEC SQL                                                          
234600            FETCH IMCSEN_CSR                                              
234700            INTO                                                          
234800                 :WS-IMCSEN                                               
234900        END-EXEC                                                          
235000                                                                          
235100        EVALUATE TRUE                                                     
235200            WHEN SQLCODE = ZERO OR -305                                   
235300                 MOVE LENGTH OF WS-IMCSEN TO DS009-TBLE-DATA-SIZE         
235400                 COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE         
235500                                           + DS009-RECORD-FILLER          
235600                 MOVE 01     TO DS002-ORDER                               
235700                 MOVE 01     TO DS002-VERSION                             
235800                 MOVE DS009-TBLE-DATA-SIZE TO DS002-DATA-SIZE             
235900                 MOVE 'TIMCSEN'            TO DS002-NAME                  
236000                 MOVE WS-IMCSEN            TO DS002-DATA-ITEM             
236100                 INITIALIZE DS009-PKYS                                    
236200                 PERFORM DS002-PROCESS-KEYS                               
236300                 MOVE WS-IMCSEN-KEYS TO DS009-PKYS                        
236400                 MOVE DS009-PKYS  TO DS002-KEYS                           
236500                 PERFORM 8000-WRITE-UNLOAD                                
236600                                                                          
236700            WHEN SQLCODE = +100                                           
236800                 SET NO-MORE-IMCSEN-DATA  TO TRUE                         
236900            WHEN SQLCODE = -904                                           
237000            WHEN SQLCODE = -913                                           
237100              CONTINUE                                                    
237200           END-EVALUATE                                                   
237300         END-PERFORM.                                                     
237400*****************************************************************         
237500     PERFORM DS002-SQL-ABEND-FETCH.                                       
237600*****************************************************************         
237700/                                                                         
237800*****************************************************************         
237900*     FETCH IMCSBL DATA                                                   
238000*****************************************************************         
238100*                                                                         
238200 R100-FETCH-IMCSBL.                                                       
238300*                                                                         
238400     PERFORM WITH TEST AFTER                                              
238500        VARYING DS009-RETRY-COUNTER FROM 1 BY 1                           
238600        UNTIL   DS009-RETRY-COUNTER > 3 OR                                
238700                SQLCODE = ZERO OR                                         
238800                SQLCODE = +100                                            
238900        EXEC SQL                                                          
239000            FETCH IMCSBL_CSR                                              
239100            INTO                                                          
239200                 :WS-IMCSBL                                               
239300        END-EXEC                                                          
239400                                                                          
239500        EVALUATE TRUE                                                     
239600            WHEN SQLCODE = ZERO OR -305                                   
239700               MOVE LENGTH OF WS-IMCSBL TO DS009-TBLE-DATA-SIZE           
239800               COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE           
239900                                         + DS009-RECORD-FILLER            
240000               MOVE 01     TO DS002-ORDER                                 
240100               MOVE 01     TO DS002-VERSION                               
240200               MOVE DS009-TBLE-DATA-SIZE TO DS002-DATA-SIZE               
240300               MOVE 'TIMCSBL'            TO DS002-NAME                    
240400               MOVE WS-IMCSBL            TO DS002-DATA-ITEM               
240500               INITIALIZE DS009-PKYS                                      
240600               PERFORM DS002-PROCESS-KEYS                                 
240700               MOVE WS-IMCSBL-KEYS TO DS009-PKYS                          
240800               MOVE DS009-PKYS  TO DS002-KEYS                             
240900               PERFORM 8000-WRITE-UNLOAD                                  
241000                                                                          
241100               MOVE WS-IMCSBL-CSTM-ENTR-ID TO HOLD-CSTM-ENTR-ID           
241200               MOVE 'TIMCSEN'  TO DS009-PROCESS-TABLE                     
241300               PERFORM DS002-DO-PROCESS                                   
241400               IF DS009-DO-PROCESS                                        
241500                  SET MORE-IMCSEN-DATA TO TRUE                            
241600                  PERFORM Y100-OPEN-CURSOR                                
241700                  PERFORM R100-FETCH-IMCSEN                               
241800                      UNTIL NO-MORE-IMCSEN-DATA                           
241900                  MOVE 'TIMCSEN' TO DS009-PROCESS-TABLE                   
242000                  PERFORM Y100-CLOSE-CURSOR                               
242100               END-IF                                                     
242200                                                                          
242300            WHEN SQLCODE = +100                                           
242400                 SET NO-MORE-IMCSBL-DATA  TO TRUE                         
242500            WHEN SQLCODE = -904                                           
242600            WHEN SQLCODE = -913                                           
242700              CONTINUE                                                    
242800           END-EVALUATE                                                   
242900         END-PERFORM.                                                     
243000*****************************************************************         
243100     PERFORM DS002-SQL-ABEND-FETCH.                                       
243200*****************************************************************         
243300/                                                                         
243400*****************************************************************         
243500*     FETCH IMCSCN DATA                                                   
243600*****************************************************************         
243700*                                                                         
243800 R100-FETCH-IMCSCN.                                                       
243900*                                                                         
244000     PERFORM WITH TEST AFTER                                              
244100        VARYING DS009-RETRY-COUNTER FROM 1 BY 1                           
244200        UNTIL   DS009-RETRY-COUNTER > 3 OR                                
244300                SQLCODE = ZERO OR                                         
244400                SQLCODE = +100                                            
244500        EXEC SQL                                                          
244600            FETCH IMCSCN_CSR                                              
244700            INTO                                                          
244800                 :WS-IMCSCN                                               
244900        END-EXEC                                                          
245000                                                                          
245100        EVALUATE TRUE                                                     
245200            WHEN SQLCODE = ZERO OR -305                                   
245300               MOVE LENGTH OF WS-IMCSCN TO DS009-TBLE-DATA-SIZE           
245400               COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE           
245500                                         + DS009-RECORD-FILLER            
245600               MOVE 01     TO DS002-ORDER                                 
245700               MOVE 01     TO DS002-VERSION                               
245800               MOVE DS009-TBLE-DATA-SIZE TO DS002-DATA-SIZE               
245900               MOVE 'TIMCSCN'            TO DS002-NAME                    
246000               MOVE WS-IMCSCN            TO DS002-DATA-ITEM               
246100               INITIALIZE DS009-PKYS                                      
246200               PERFORM DS002-PROCESS-KEYS                                 
246300               MOVE WS-IMCSCN-KEYS TO DS009-PKYS                          
246400               MOVE DS009-PKYS  TO DS002-KEYS                             
246500               PERFORM 8000-WRITE-UNLOAD                                  
246600                                                                          
246700               MOVE WS-IMCSCN-CSTM-ENTR-ID TO HOLD-CSTM-ENTR-ID           
246800               MOVE 'TIMCSEN'  TO DS009-PROCESS-TABLE                     
246900               PERFORM DS002-DO-PROCESS                                   
247000               IF DS009-DO-PROCESS                                        
247100                  SET MORE-IMCSEN-DATA TO TRUE                            
247200                  PERFORM Y100-OPEN-CURSOR                                
247300                  PERFORM R100-FETCH-IMCSEN                               
247400                      UNTIL NO-MORE-IMCSEN-DATA                           
247500                  MOVE 'TIMCSEN' TO DS009-PROCESS-TABLE                   
247600                  PERFORM Y100-CLOSE-CURSOR                               
247700               END-IF                                                     
247800                                                                          
247900            WHEN SQLCODE = +100                                           
248000                 SET NO-MORE-IMCSCN-DATA  TO TRUE                         
248100            WHEN SQLCODE = -904                                           
248200            WHEN SQLCODE = -913                                           
248300              CONTINUE                                                    
248400           END-EVALUATE                                                   
248500         END-PERFORM.                                                     
248600*****************************************************************         
248700     PERFORM DS002-SQL-ABEND-FETCH.                                       
248800*****************************************************************         
248900/                                                                         
249000*****************************************************************         
249100*     FETCH IMCSPO DATA                                                   
249200*****************************************************************         
249300*                                                                         
249400 R100-FETCH-IMCSPO.                                                       
249500*                                                                         
249600     PERFORM WITH TEST AFTER                                              
249700        VARYING DS009-RETRY-COUNTER FROM 1 BY 1                           
249800        UNTIL   DS009-RETRY-COUNTER > 3 OR                                
249900                SQLCODE = ZERO OR                                         
250000                SQLCODE = +100                                            
250100        EXEC SQL                                                          
250200            FETCH IMCSPO_CSR                                              
250300            INTO                                                          
250400                 :WS-IMCSPO                                               
250500        END-EXEC                                                          
250600                                                                          
250700        EVALUATE TRUE                                                     
250800            WHEN SQLCODE = ZERO OR -305                                   
250900               MOVE LENGTH OF WS-IMCSPO TO DS009-TBLE-DATA-SIZE           
251000               COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE           
251100                                         + DS009-RECORD-FILLER            
251200               MOVE 01     TO DS002-ORDER                                 
251300               MOVE 01     TO DS002-VERSION                               
251400               MOVE DS009-TBLE-DATA-SIZE TO DS002-DATA-SIZE               
251500               MOVE 'TIMCSPO'            TO DS002-NAME                    
251600               MOVE WS-IMCSPO            TO DS002-DATA-ITEM               
251700               INITIALIZE DS009-PKYS                                      
251800               PERFORM DS002-PROCESS-KEYS                                 
251900               MOVE WS-IMCSPO-KEYS TO DS009-PKYS                          
252000               MOVE DS009-PKYS  TO DS002-KEYS                             
252100               PERFORM 8000-WRITE-UNLOAD                                  
252200                                                                          
252300               MOVE WS-IMCSPO-CSTM-ENTR-ID TO HOLD-CSTM-ENTR-ID           
252400               MOVE 'TIMCSEN' TO DS009-PROCESS-TABLE                      
252500               PERFORM DS002-DO-PROCESS                                   
252600               IF DS009-DO-PROCESS                                        
252700                  SET MORE-IMCSEN-DATA TO TRUE                            
252800                  PERFORM Y100-OPEN-CURSOR                                
252900                  PERFORM R100-FETCH-IMCSEN                               
253000                      UNTIL NO-MORE-IMCSEN-DATA                           
253100                  MOVE 'TIMCSEN' TO DS009-PROCESS-TABLE                   
253200                  PERFORM Y100-CLOSE-CURSOR                               
253300               END-IF                                                     
253400                                                                          
253500               MOVE WS-IMCSPO-CSTM-ENTR-ID TO HOLD-CSTM-ENTR-ID           
253600               MOVE 'TIMCSCN'  TO DS009-PROCESS-TABLE                     
253700               PERFORM DS002-DO-PROCESS                                   
253800               IF DS009-DO-PROCESS                                        
253900                  SET MORE-IMCSCN-DATA TO TRUE                            
254000                  PERFORM Y100-OPEN-CURSOR                                
254100                  PERFORM R100-FETCH-IMCSCN                               
254200                      UNTIL NO-MORE-IMCSCN-DATA                           
254300                  MOVE 'TIMCSCN' TO DS009-PROCESS-TABLE                   
254400                  PERFORM Y100-CLOSE-CURSOR                               
254500               END-IF                                                     
254600                                                                          
254700               MOVE WS-IMCSPO-CSTM-ENTR-ID TO HOLD-CSTM-ENTR-ID           
254800               MOVE 'TIMCSBL' TO DS009-PROCESS-TABLE                      
254900               PERFORM DS002-DO-PROCESS                                   
255000               IF DS009-DO-PROCESS                                        
255100                  SET MORE-IMCSBL-DATA TO TRUE                            
255200                  PERFORM Y100-OPEN-CURSOR                                
255300                  PERFORM R100-FETCH-IMCSBL                               
255400                      UNTIL NO-MORE-IMCSBL-DATA                           
255500                  MOVE 'TIMCSBL' TO DS009-PROCESS-TABLE                   
255600                  PERFORM Y100-CLOSE-CURSOR                               
255700               END-IF                                                     
255800                                                                          
255900               MOVE WS-IMCSPO-CSTM-ENTR-ID TO HOLD-CSTM-ENTR-ID           
256000               MOVE 'TAUCSEN' TO DS009-PROCESS-TABLE                      
256100               PERFORM DS002-DO-PROCESS                                   
256200               IF DS009-DO-PROCESS                                        
256300                  SET MORE-AUCSEN-DATA TO TRUE                            
256400                  PERFORM Y100-OPEN-CURSOR                                
256500                  PERFORM R100-FETCH-AUCSEN                               
256600                      UNTIL NO-MORE-AUCSEN-DATA                           
256700                  MOVE 'TAUCSEN' TO DS009-PROCESS-TABLE                   
256800                  PERFORM Y100-CLOSE-CURSOR                               
256900               END-IF                                                     
257000                                                                          
257100               MOVE WS-IMCSPO-CSTM-ENTR-ID TO HOLD-CSTM-ENTR-ID           
257200               MOVE 'TAUCSBL' TO DS009-PROCESS-TABLE                      
257300               PERFORM DS002-DO-PROCESS                                   
257400               IF DS009-DO-PROCESS                                        
257500                  SET MORE-AUCSBL-DATA TO TRUE                            
257600                  PERFORM Y100-OPEN-CURSOR                                
257700                  PERFORM R100-FETCH-AUCSBL                               
257800                      UNTIL NO-MORE-AUCSBL-DATA                           
257900                  MOVE 'TAUCSBL' TO DS009-PROCESS-TABLE                   
258000                  PERFORM Y100-CLOSE-CURSOR                               
258100               END-IF                                                     
258200                                                                          
258300               MOVE WS-IMCSPO-CSTM-ENTR-ID TO HOLD-CSTM-ENTR-ID           
258400               MOVE 'TAUCSCN' TO DS009-PROCESS-TABLE                      
258500               PERFORM DS002-DO-PROCESS                                   
258600               IF DS009-DO-PROCESS                                        
258700                  SET MORE-AUCSCN-DATA TO TRUE                            
258800                  PERFORM Y100-OPEN-CURSOR                                
258900                  PERFORM R100-FETCH-AUCSCN                               
259000                      UNTIL NO-MORE-AUCSCN-DATA                           
259100                  MOVE 'TAUCSCN' TO DS009-PROCESS-TABLE                   
259200                  PERFORM Y100-CLOSE-CURSOR                               
259300               END-IF                                                     
259400                                                                          
259500               MOVE WS-IMCSPO-CSTM-ENTR-ID TO HOLD-CSTM-ENTR-ID           
259600               MOVE 'TAUCSPO' TO DS009-PROCESS-TABLE                      
259700               PERFORM DS002-DO-PROCESS                                   
259800               IF DS009-DO-PROCESS                                        
259900                  SET MORE-AUCSPO-DATA TO TRUE                            
260000                  PERFORM Y100-OPEN-CURSOR                                
260100                  PERFORM R100-FETCH-AUCSPO                               
260200                      UNTIL NO-MORE-AUCSPO-DATA                           
260300                  MOVE 'TAUCSPO' TO DS009-PROCESS-TABLE                   
260400                  PERFORM Y100-CLOSE-CURSOR                               
260500               END-IF                                                     
260600                                                                          
260700            WHEN SQLCODE = +100                                           
260800                 SET NO-MORE-IMCSPO-DATA  TO TRUE                         
260900            WHEN SQLCODE = -904                                           
261000            WHEN SQLCODE = -913                                           
261100              CONTINUE                                                    
261200           END-EVALUATE                                                   
261300         END-PERFORM.                                                     
261400*****************************************************************         
261500     PERFORM DS002-SQL-ABEND-FETCH.                                       
261600*****************************************************************         
261700/                                                                         
261800*****************************************************************         
261900*     FETCH AUCSEN DATA                                                   
262000*****************************************************************         
262100*                                                                         
262200 R100-FETCH-AUCSEN.                                                       
262300*                                                                         
262400     MOVE  'TAUCSEN'  TO DS009-PROCESS-TABLE.                             
262500     PERFORM WITH TEST AFTER                                              
262600        VARYING DS009-RETRY-COUNTER FROM 1 BY 1                           
262700        UNTIL   DS009-RETRY-COUNTER > 3 OR                                
262800                SQLCODE = ZERO OR                                         
262900                SQLCODE = +100                                            
263000        EXEC SQL                                                          
263100            FETCH AUCSEN_CSR                                              
263200            INTO                                                          
263300                 :WS-AUCSEN                                               
263400        END-EXEC                                                          
263500                                                                          
263600        EVALUATE TRUE                                                     
263700            WHEN SQLCODE = ZERO OR -305                                   
263800                 MOVE LENGTH OF WS-AUCSEN TO DS009-TBLE-DATA-SIZE         
263900                 COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE         
264000                                        + DS009-RECORD-FILLER             
264100                 MOVE 02     TO DS002-ORDER                               
264200                 MOVE 01     TO DS002-VERSION                             
264300                 MOVE DS009-TBLE-DATA-SIZE TO DS002-DATA-SIZE             
264400                 MOVE 'TAUCSEN'            TO DS002-NAME                  
264500                 MOVE WS-AUCSEN            TO DS002-DATA-ITEM             
264600                 INITIALIZE DS009-PKYS                                    
264700                 PERFORM DS002-PROCESS-KEYS                               
264800                 MOVE WS-AUCSEN-KEYS      TO DS009-PKYS                   
264900                 MOVE DS009-PKYS          TO DS002-KEYS                   
265000                 PERFORM 8000-WRITE-UNLOAD                                
265100                                                                          
265200            WHEN SQLCODE = +100                                           
265300                 SET NO-MORE-AUCSEN-DATA  TO TRUE                         
265400            WHEN SQLCODE = -904                                           
265500            WHEN SQLCODE = -913                                           
265600              CONTINUE                                                    
265700           END-EVALUATE                                                   
265800         END-PERFORM.                                                     
265900*****************************************************************         
266000     PERFORM DS002-SQL-ABEND-FETCH.                                       
266100*****************************************************************         
266200/                                                                         
266300*****************************************************************         
266400*     FETCH AUCSBL DATA                                                   
266500*****************************************************************         
266600*                                                                         
266700 R100-FETCH-AUCSBL.                                                       
266800*                                                                         
266900     MOVE  'TAUCSBL'  TO DS009-PROCESS-TABLE.                             
267000     PERFORM WITH TEST AFTER                                              
267100        VARYING DS009-RETRY-COUNTER FROM 1 BY 1                           
267200        UNTIL   DS009-RETRY-COUNTER > 3 OR                                
267300                SQLCODE = ZERO OR                                         
267400                SQLCODE = +100                                            
267500        EXEC SQL                                                          
267600            FETCH AUCSBL_CSR                                              
267700            INTO                                                          
267800                 :WS-AUCSBL                                               
267900        END-EXEC                                                          
268000                                                                          
268100        EVALUATE TRUE                                                     
268200            WHEN SQLCODE = ZERO OR -305                                   
268300                 MOVE LENGTH OF WS-AUCSBL TO DS009-TBLE-DATA-SIZE         
268400                 COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE         
268500                                        + DS009-RECORD-FILLER             
268600                 MOVE 01     TO DS002-ORDER                               
268700                 MOVE 01     TO DS002-VERSION                             
268800                 MOVE DS009-TBLE-DATA-SIZE TO DS002-DATA-SIZE             
268900                 MOVE 'TAUCSBL'            TO DS002-NAME                  
269000                 MOVE WS-AUCSBL            TO DS002-DATA-ITEM             
269100                 INITIALIZE DS009-PKYS                                    
269200                 PERFORM DS002-PROCESS-KEYS                               
269300                 MOVE WS-AUCSBL-KEYS      TO DS009-PKYS                   
269400                 MOVE DS009-PKYS          TO DS002-KEYS                   
269500                 PERFORM 8000-WRITE-UNLOAD                                
269600                                                                          
269700            WHEN SQLCODE = +100                                           
269800                 SET NO-MORE-AUCSBL-DATA  TO TRUE                         
269900            WHEN SQLCODE = -904                                           
270000            WHEN SQLCODE = -913                                           
270100              CONTINUE                                                    
270200           END-EVALUATE                                                   
270300         END-PERFORM.                                                     
270400*****************************************************************         
270500     PERFORM DS002-SQL-ABEND-FETCH.                                       
270600*****************************************************************         
270700/                                                                         
270800*****************************************************************         
270900*     FETCH AUCSCN DATA                                                   
271000*****************************************************************         
271100*                                                                         
271200 R100-FETCH-AUCSCN.                                                       
271300*                                                                         
271400     MOVE  'TAUCSCN'  TO DS009-PROCESS-TABLE.                             
271500     PERFORM WITH TEST AFTER                                              
271600        VARYING DS009-RETRY-COUNTER FROM 1 BY 1                           
271700        UNTIL   DS009-RETRY-COUNTER > 3 OR                                
271800                SQLCODE = ZERO OR                                         
271900                SQLCODE = +100                                            
272000        EXEC SQL                                                          
272100            FETCH AUCSCN_CSR                                              
272200            INTO                                                          
272300                 :WS-AUCSCN                                               
272400        END-EXEC                                                          
272500                                                                          
272600        EVALUATE TRUE                                                     
272700            WHEN SQLCODE = ZERO OR -305                                   
272800                 MOVE LENGTH OF WS-AUCSCN TO DS009-TBLE-DATA-SIZE         
272900                 COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE         
273000                                        + DS009-RECORD-FILLER             
273100                 MOVE 01     TO DS002-ORDER                               
273200                 MOVE 01     TO DS002-VERSION                             
273300                 MOVE DS009-TBLE-DATA-SIZE TO DS002-DATA-SIZE             
273400                 MOVE 'TAUCSCN'            TO DS002-NAME                  
273500                 MOVE WS-AUCSCN            TO DS002-DATA-ITEM             
273600                 INITIALIZE DS009-PKYS                                    
273700                 PERFORM DS002-PROCESS-KEYS                               
273800                 MOVE WS-AUCSCN-KEYS      TO DS009-PKYS                   
273900                 MOVE DS009-PKYS          TO DS002-KEYS                   
274000                 PERFORM 8000-WRITE-UNLOAD                                
274100                                                                          
274200            WHEN SQLCODE = +100                                           
274300                 SET NO-MORE-AUCSCN-DATA  TO TRUE                         
274400            WHEN SQLCODE = -904                                           
274500            WHEN SQLCODE = -913                                           
274600              CONTINUE                                                    
274700           END-EVALUATE                                                   
274800         END-PERFORM.                                                     
274900*****************************************************************         
275000     PERFORM DS002-SQL-ABEND-FETCH.                                       
275100*****************************************************************         
275200/                                                                         
275300*****************************************************************         
275400*     FETCH AUCSPO DATA                                                   
275500*****************************************************************         
275600*                                                                         
275700 R100-FETCH-AUCSPO.                                                       
275800*                                                                         
275900     MOVE  'TAUCSPO'  TO DS009-PROCESS-TABLE.                             
276000     PERFORM WITH TEST AFTER                                              
276100        VARYING DS009-RETRY-COUNTER FROM 1 BY 1                           
276200        UNTIL   DS009-RETRY-COUNTER > 3 OR                                
276300                SQLCODE = ZERO OR                                         
276400                SQLCODE = +100                                            
276500        EXEC SQL                                                          
276600            FETCH AUCSPO_CSR                                              
276700            INTO                                                          
276800                 :WS-AUCSPO                                               
276900        END-EXEC                                                          
277000                                                                          
277100        EVALUATE TRUE                                                     
277200            WHEN SQLCODE = ZERO OR -305                                   
277300                 MOVE LENGTH OF WS-AUCSPO TO DS009-TBLE-DATA-SIZE         
277400                 COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE         
277500                                        + DS009-RECORD-FILLER             
277600                 MOVE 01     TO DS002-ORDER                               
277700                 MOVE 01     TO DS002-VERSION                             
277800                 MOVE DS009-TBLE-DATA-SIZE TO DS002-DATA-SIZE             
277900                 MOVE 'TAUCSPO'            TO DS002-NAME                  
278000                 MOVE WS-AUCSPO            TO DS002-DATA-ITEM             
278100                 INITIALIZE DS009-PKYS                                    
278200                 PERFORM DS002-PROCESS-KEYS                               
278300                 MOVE WS-AUCSPO-KEYS      TO DS009-PKYS                   
278400                 MOVE DS009-PKYS          TO DS002-KEYS                   
278500                 PERFORM 8000-WRITE-UNLOAD                                
278600                                                                          
278700            WHEN SQLCODE = +100                                           
278800                 SET NO-MORE-AUCSPO-DATA  TO TRUE                         
278900            WHEN SQLCODE = -904                                           
279000            WHEN SQLCODE = -913                                           
279100              CONTINUE                                                    
279200           END-EVALUATE                                                   
279300         END-PERFORM.                                                     
279400*****************************************************************         
279500     PERFORM DS002-SQL-ABEND-FETCH.                                       
279600*****************************************************************         
279700/                                                                         
279800*****************************************************************         
279900*     FETCH AURCPO DATA                                                   
280000*****************************************************************         
280100*                                                                         
280200 R100-FETCH-AURCPO.                                                       
280300*                                                                         
280400     MOVE  'TAURCPO'  TO DS009-PROCESS-TABLE.                             
280500     PERFORM WITH TEST AFTER                                              
280600        VARYING DS009-RETRY-COUNTER FROM 1 BY 1                           
280700        UNTIL   DS009-RETRY-COUNTER > 3 OR                                
280800                SQLCODE = ZERO OR                                         
280900                SQLCODE = +100                                            
281000        EXEC SQL                                                          
281100            FETCH AURCPO_CSR                                              
281200            INTO                                                          
281300                 :WS-AURCPO                                               
281400        END-EXEC                                                          
281500                                                                          
281600        EVALUATE TRUE                                                     
281700            WHEN SQLCODE = ZERO OR -305                                   
281800                 MOVE LENGTH OF WS-AURCPO TO DS009-TBLE-DATA-SIZE         
281900                 COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE         
282000                                        + DS009-RECORD-FILLER             
282100                 MOVE 01     TO DS002-ORDER                               
282200                 MOVE 01     TO DS002-VERSION                             
282300                 MOVE DS009-TBLE-DATA-SIZE TO DS002-DATA-SIZE             
282400                 MOVE 'TAURCPO'            TO DS002-NAME                  
282500                 MOVE WS-AURCPO            TO DS002-DATA-ITEM             
282600                 INITIALIZE DS009-PKYS                                    
282700                 PERFORM DS002-PROCESS-KEYS                               
282800                 MOVE WS-AURCPO-KEYS      TO DS009-PKYS                   
282900                 MOVE DS009-PKYS          TO DS002-KEYS                   
283000                 PERFORM 8000-WRITE-UNLOAD                                
283100                                                                          
283200            WHEN SQLCODE = +100                                           
283300                 SET NO-MORE-AURCPO-DATA  TO TRUE                         
283400            WHEN SQLCODE = -904                                           
283500            WHEN SQLCODE = -913                                           
283600              CONTINUE                                                    
283700           END-EVALUATE                                                   
283800         END-PERFORM.                                                     
283900*****************************************************************         
284000     PERFORM DS002-SQL-ABEND-FETCH.                                       
284100*****************************************************************         
284200/                                                                         
284300*****************************************************************         
284400*     FETCH AURCVS DATA                                                   
284500*****************************************************************         
284600*                                                                         
284700*R100-FETCH-AURCVS.                                                       
284800*                                                                         
284900*    MOVE  'TAURCVS'  TO DS009-PROCESS-TABLE.                             
285000*    PERFORM WITH TEST AFTER                                              
285100*       VARYING DS009-RETRY-COUNTER FROM 1 BY 1                           
285200*       UNTIL   DS009-RETRY-COUNTER > 3 OR                                
285300*               SQLCODE = ZERO OR                                         
285400*               SQLCODE = +100                                            
285500*       EXEC SQL                                                          
285600*           FETCH AURCVS_CSR                                              
285700*           INTO                                                          
285800*                :WS-AURCVS                                               
285900*       END-EXEC                                                          
286000*                                                                         
286100*       EVALUATE TRUE                                                     
286200*           WHEN SQLCODE = ZERO OR -305                                   
286300*                MOVE LENGTH OF WS-AURCVS TO DS009-TBLE-DATA-SIZE         
286400*                COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE         
286500*                                       + DS009-RECORD-FILLER             
286600*                MOVE 01     TO DS002-ORDER                               
286700*                MOVE 01     TO DS002-VERSION                             
286800*                MOVE DS009-TBLE-DATA-SIZE TO DS002-DATA-SIZE             
286900*                MOVE 'TAURCVS'            TO DS002-NAME                  
287000*                MOVE WS-AURCVS            TO DS002-DATA-ITEM             
287100*                INITIALIZE DS009-PKYS                                    
287200*                PERFORM DS002-PROCESS-KEYS                               
287300*                MOVE WS-AURCVS-KEYS      TO DS009-PKYS                   
287400*                MOVE DS009-PKYS          TO DS002-KEYS                   
287500*                PERFORM 8000-WRITE-UNLOAD                                
287600*                                                                         
287700*           WHEN SQLCODE = +100                                           
287800*                SET NO-MORE-AURCVS-DATA  TO TRUE                         
287900*           WHEN SQLCODE = -904                                           
288000*           WHEN SQLCODE = -913                                           
288100*             CONTINUE                                                    
288200*          END-EVALUATE                                                   
288300*        END-PERFORM.                                                     
288400*****************************************************************         
288500     PERFORM DS002-SQL-ABEND-FETCH.                                       
288600*****************************************************************         
288700/                                                                         
288800*****************************************************************         
288900*     FETCH AURCUP DATA                                                   
289000*****************************************************************         
289100*                                                                         
289200*R100-FETCH-AURCUP.                                                       
289300*                                                                         
289400*    MOVE  'TAURCUP'  TO DS009-PROCESS-TABLE.                             
289500*    PERFORM WITH TEST AFTER                                              
289600*       VARYING DS009-RETRY-COUNTER FROM 1 BY 1                           
289700*       UNTIL   DS009-RETRY-COUNTER > 3 OR                                
289800*               SQLCODE = ZERO OR                                         
289900*               SQLCODE = +100                                            
290000*       EXEC SQL                                                          
290100*           FETCH AURCUP_CSR                                              
290200*           INTO                                                          
290300*                :WS-AURCUP                                               
290400*       END-EXEC                                                          
290500*                                                                         
290600*       EVALUATE TRUE                                                     
290700*           WHEN SQLCODE = ZERO OR -305                                   
290800*                MOVE LENGTH OF WS-AURCUP TO DS009-TBLE-DATA-SIZE         
290900*                COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE         
291000*                                       + DS009-RECORD-FILLER             
291100*                MOVE 01     TO DS002-ORDER                               
291200*                MOVE 01     TO DS002-VERSION                             
291300*                MOVE DS009-TBLE-DATA-SIZE TO DS002-DATA-SIZE             
291400*                MOVE 'TAURCUP'            TO DS002-NAME                  
291500*                MOVE WS-AURCUP            TO DS002-DATA-ITEM             
291600*                INITIALIZE DS009-PKYS                                    
291700*                PERFORM DS002-PROCESS-KEYS                               
291800*                MOVE WS-AURCUP-KEYS      TO DS009-PKYS                   
291900*                MOVE DS009-PKYS          TO DS002-KEYS                   
292000*                PERFORM 8000-WRITE-UNLOAD                                
292100*                                                                         
292200*           WHEN SQLCODE = +100                                           
292300*                SET NO-MORE-AURCUP-DATA  TO TRUE                         
292400*           WHEN SQLCODE = -904                                           
292500*           WHEN SQLCODE = -913                                           
292600*             CONTINUE                                                    
292700*          END-EVALUATE                                                   
292800*        END-PERFORM.                                                     
292900*****************************************************************         
293000     PERFORM DS002-SQL-ABEND-FETCH.                                       
293100*****************************************************************         
293200/                                                                         
293300*****************************************************************         
293400*     FETCH AUBKPO DATA                                                   
293500*****************************************************************         
293600*                                                                         
293700 R100-FETCH-AUBKPO.                                                       
293800*                                                                         
293900     MOVE  'TAUBKPO'  TO DS009-PROCESS-TABLE.                             
294000     PERFORM WITH TEST AFTER                                              
294100        VARYING DS009-RETRY-COUNTER FROM 1 BY 1                           
294200        UNTIL   DS009-RETRY-COUNTER > 3 OR                                
294300                SQLCODE = ZERO OR                                         
294400                SQLCODE = +100                                            
294500        EXEC SQL                                                          
294600            FETCH AUBKPO_CSR                                              
294700            INTO                                                          
294800                 :WS-AUBKPO                                               
294900        END-EXEC                                                          
295000                                                                          
295100        EVALUATE TRUE                                                     
295200            WHEN SQLCODE = ZERO OR -305                                   
295300                 MOVE LENGTH OF WS-AUBKPO TO DS009-TBLE-DATA-SIZE         
295400                 COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE         
295500                                        + DS009-RECORD-FILLER             
295600                 MOVE 01     TO DS002-ORDER                               
295700                 MOVE 01     TO DS002-VERSION                             
295800                 MOVE DS009-TBLE-DATA-SIZE TO DS002-DATA-SIZE             
295900                 MOVE 'TAUBKPO'            TO DS002-NAME                  
296000                 MOVE WS-AUBKPO            TO DS002-DATA-ITEM             
296100                 INITIALIZE DS009-PKYS                                    
296200                 PERFORM DS002-PROCESS-KEYS                               
296300                 MOVE WS-AUBKPO-KEYS      TO DS009-PKYS                   
296400                 MOVE DS009-PKYS          TO DS002-KEYS                   
296500                 PERFORM 8000-WRITE-UNLOAD                                
296600                                                                          
296700            WHEN SQLCODE = +100                                           
296800                 SET NO-MORE-AUBKPO-DATA  TO TRUE                         
296900            WHEN SQLCODE = -904                                           
297000            WHEN SQLCODE = -913                                           
297100              CONTINUE                                                    
297200           END-EVALUATE                                                   
297300         END-PERFORM.                                                     
297400*****************************************************************         
297500     PERFORM DS002-SQL-ABEND-FETCH.                                       
297600*****************************************************************         
297700/                                                                         
297800*****************************************************************         
297900*     FETCH AUBKVS DATA                                                   
298000*****************************************************************         
298100*                                                                         
298200*R100-FETCH-AUBKVS.                                                       
298300*                                                                         
298400*    MOVE  'TAUBKVS'  TO DS009-PROCESS-TABLE.                             
298500*    PERFORM WITH TEST AFTER                                              
298600*       VARYING DS009-RETRY-COUNTER FROM 1 BY 1                           
298700*       UNTIL   DS009-RETRY-COUNTER > 3 OR                                
298800*               SQLCODE = ZERO OR                                         
298900*               SQLCODE = +100                                            
299000*       EXEC SQL                                                          
299100*           FETCH AUBKVS_CSR                                              
299200*           INTO                                                          
299300*                :WS-AUBKVS                                               
299400*       END-EXEC                                                          
299500*                                                                         
299600*       EVALUATE TRUE                                                     
299700*           WHEN SQLCODE = ZERO OR -305                                   
299800*                MOVE LENGTH OF WS-AUBKVS TO DS009-TBLE-DATA-SIZE         
299900*                COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE         
300000*                                       + DS009-RECORD-FILLER             
300100*                MOVE 01     TO DS002-ORDER                               
300200*                MOVE 01     TO DS002-VERSION                             
300300*                MOVE DS009-TBLE-DATA-SIZE TO DS002-DATA-SIZE             
300400*                MOVE 'TAUBKVS'            TO DS002-NAME                  
300500*                MOVE WS-AUBKVS            TO DS002-DATA-ITEM             
300600*                INITIALIZE DS009-PKYS                                    
300700*                PERFORM DS002-PROCESS-KEYS                               
300800*                MOVE WS-AUBKVS-KEYS      TO DS009-PKYS                   
300900*                MOVE DS009-PKYS          TO DS002-KEYS                   
301000*                PERFORM 8000-WRITE-UNLOAD                                
301100*                                                                         
301200*           WHEN SQLCODE = +100                                           
301300*                SET NO-MORE-AUBKVS-DATA  TO TRUE                         
301400*           WHEN SQLCODE = -904                                           
301500*           WHEN SQLCODE = -913                                           
301600*             CONTINUE                                                    
301700*          END-EVALUATE                                                   
301800*        END-PERFORM.                                                     
301900*****************************************************************         
302000     PERFORM DS002-SQL-ABEND-FETCH.                                       
302100*****************************************************************         
302200/                                                                         
302300*****************************************************************         
302400*     FETCH AUBKUP DATA                                                   
302500*****************************************************************         
302600*                                                                         
302700*R100-FETCH-AUBKUP.                                                       
302800*                                                                         
302900*    MOVE  'TAUBKUP'  TO DS009-PROCESS-TABLE.                             
303000*    PERFORM WITH TEST AFTER                                              
303100*       VARYING DS009-RETRY-COUNTER FROM 1 BY 1                           
303200*       UNTIL   DS009-RETRY-COUNTER > 3 OR                                
303300*               SQLCODE = ZERO OR                                         
303400*               SQLCODE = +100                                            
303500*       EXEC SQL                                                          
303600*           FETCH AUBKUP_CSR                                              
303700*           INTO                                                          
303800*                :WS-AUBKUP                                               
303900*       END-EXEC                                                          
304000*                                                                         
304100*       EVALUATE TRUE                                                     
304200*           WHEN SQLCODE = ZERO OR -305                                   
304300*                MOVE LENGTH OF WS-AUBKUP TO DS009-TBLE-DATA-SIZE         
304400*                COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE         
304500*                                       + DS009-RECORD-FILLER             
304600*                MOVE 01     TO DS002-ORDER                               
304700*                MOVE 01     TO DS002-VERSION                             
304800*                MOVE DS009-TBLE-DATA-SIZE TO DS002-DATA-SIZE             
304900*                MOVE 'TAUBKUP'            TO DS002-NAME                  
305000*                MOVE WS-AUBKUP            TO DS002-DATA-ITEM             
305100*                INITIALIZE DS009-PKYS                                    
305200*                PERFORM DS002-PROCESS-KEYS                               
305300*                MOVE WS-AUBKUP-KEYS      TO DS009-PKYS                   
305400*                MOVE DS009-PKYS          TO DS002-KEYS                   
305500*                PERFORM 8000-WRITE-UNLOAD                                
305600*                                                                         
305700*           WHEN SQLCODE = +100                                           
305800*                SET NO-MORE-AUBKUP-DATA  TO TRUE                         
305900*           WHEN SQLCODE = -904                                           
306000*           WHEN SQLCODE = -913                                           
306100*             CONTINUE                                                    
306200*          END-EVALUATE                                                   
306300*        END-PERFORM.                                                     
306400*****************************************************************         
306500     PERFORM DS002-SQL-ABEND-FETCH.                                       
306600*****************************************************************         
306700/                                                                         
306800*****************************************************************         
306900*     FETCH AUCNPO DATA                                                   
307000*****************************************************************         
307100*                                                                         
307200 R100-FETCH-AUCNPO.                                                       
307300*                                                                         
307400     MOVE  'TAUCNPO'  TO DS009-PROCESS-TABLE.                             
307500     PERFORM WITH TEST AFTER                                              
307600        VARYING DS009-RETRY-COUNTER FROM 1 BY 1                           
307700        UNTIL   DS009-RETRY-COUNTER > 3 OR                                
307800                SQLCODE = ZERO OR                                         
307900                SQLCODE = +100                                            
308000        EXEC SQL                                                          
308100            FETCH AUCNPO_CSR                                              
308200            INTO                                                          
308300                 :WS-AUCNPO                                               
308400        END-EXEC                                                          
308500                                                                          
308600        EVALUATE TRUE                                                     
308700            WHEN SQLCODE = ZERO OR -305                                   
308800                 MOVE LENGTH OF WS-AUCNPO TO DS009-TBLE-DATA-SIZE         
308900                 COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE         
309000                                        + DS009-RECORD-FILLER             
309100                 MOVE 01     TO DS002-ORDER                               
309200                 MOVE 01     TO DS002-VERSION                             
309300                 MOVE DS009-TBLE-DATA-SIZE TO DS002-DATA-SIZE             
309400                 MOVE 'TAUCNPO'            TO DS002-NAME                  
309500                 MOVE WS-AUCNPO            TO DS002-DATA-ITEM             
309600                 INITIALIZE DS009-PKYS                                    
309700                 PERFORM DS002-PROCESS-KEYS                               
309800                 MOVE WS-AUCNPO-KEYS      TO DS009-PKYS                   
309900                 MOVE DS009-PKYS          TO DS002-KEYS                   
310000                 PERFORM 8000-WRITE-UNLOAD                                
310100                                                                          
310200            WHEN SQLCODE = +100                                           
310300                 SET NO-MORE-AUCNPO-DATA  TO TRUE                         
310400            WHEN SQLCODE = -904                                           
310500            WHEN SQLCODE = -913                                           
310600              CONTINUE                                                    
310700           END-EVALUATE                                                   
310800         END-PERFORM.                                                     
310900*****************************************************************         
311000     PERFORM DS002-SQL-ABEND-FETCH.                                       
311100*****************************************************************         
311200/                                                                         
311300*****************************************************************         
311400*     FETCH AUCNUP DATA                                                   
311500*****************************************************************         
311600*                                                                         
311700 R100-FETCH-AUCNUP.                                                       
311800*                                                                         
311900     MOVE  'TAUCNUP'  TO DS009-PROCESS-TABLE.                             
312000     PERFORM WITH TEST AFTER                                              
312100        VARYING DS009-RETRY-COUNTER FROM 1 BY 1                           
312200        UNTIL   DS009-RETRY-COUNTER > 3 OR                                
312300                SQLCODE = ZERO OR                                         
312400                SQLCODE = +100                                            
312500        EXEC SQL                                                          
312600            FETCH AUCNUP_CSR                                              
312700            INTO                                                          
312800                 :WS-AUCNUP                                               
312900        END-EXEC                                                          
313000                                                                          
313100        EVALUATE TRUE                                                     
313200            WHEN SQLCODE = ZERO OR -305                                   
313300                 MOVE LENGTH OF WS-AUCNUP TO DS009-TBLE-DATA-SIZE         
313400                 COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE         
313500                                        + DS009-RECORD-FILLER             
313600                 MOVE 01     TO DS002-ORDER                               
313700                 MOVE 01     TO DS002-VERSION                             
313800                 MOVE DS009-TBLE-DATA-SIZE TO DS002-DATA-SIZE             
313900                 MOVE 'TAUCNUP'            TO DS002-NAME                  
314000                 MOVE WS-AUCNUP            TO DS002-DATA-ITEM             
314100                 INITIALIZE DS009-PKYS                                    
314200                 PERFORM DS002-PROCESS-KEYS                               
314300                 MOVE WS-AUCNUP-KEYS      TO DS009-PKYS                   
314400                 MOVE DS009-PKYS          TO DS002-KEYS                   
314500                 PERFORM 8000-WRITE-UNLOAD                                
314600                                                                          
314700            WHEN SQLCODE = +100                                           
314800                 SET NO-MORE-AUCNUP-DATA  TO TRUE                         
314900            WHEN SQLCODE = -904                                           
315000            WHEN SQLCODE = -913                                           
315100              CONTINUE                                                    
315200           END-EVALUATE                                                   
315300         END-PERFORM.                                                     
315400*****************************************************************         
315500     PERFORM DS002-SQL-ABEND-FETCH.                                       
315600*****************************************************************         
315700/                                                                         
315800*****************************************************************         
315900*     FETCH AUCNTK DATA                                                   
316000*****************************************************************         
316100*                                                                         
316200 R100-FETCH-AUCNTK.                                                       
316300*                                                                         
316400     MOVE  'TAUCNTK'  TO DS009-PROCESS-TABLE.                             
316500     PERFORM WITH TEST AFTER                                              
316600        VARYING DS009-RETRY-COUNTER FROM 1 BY 1                           
316700        UNTIL   DS009-RETRY-COUNTER > 3 OR                                
316800                SQLCODE = ZERO OR                                         
316900                SQLCODE = +100                                            
317000        EXEC SQL                                                          
317100            FETCH AUCNTK_CSR                                              
317200            INTO                                                          
317300                :WS-AUCNTK-CONTNR-ID                                      
317400               ,:WS-AUCNTK-CONTNR-SEQ-NBR                                 
317500               ,:WS-AUCNTK-CONSLR-SCAC-ID                                 
317600               ,:WS-AUCNTK-MOM-IMPRT-TRIP-ID                              
317700               ,:WS-AUCNTK-MOM-DPRTR-TMST                                 
317800               ,:WS-AUCNTK-MOM-POE-DELY-TMST                              
317900               ,:WS-AUCNTK-MOM-CARR-SCAC-ID                               
318000               ,:WS-AUCNTK-MOM-FOB-CDE                                    
318100               ,:WS-AUCNTK-MOM-IMPRT-VEH-NM                               
318200               ,:WS-AUCNTK-MOM-TRIP-TYP-CDE                               
318300               ,:WS-AUCNTK-MOM-DEST-POE-CDE                               
318400               ,:WS-AUCNTK-FDR-IMPRT-TRIP-ID                              
318500               ,:WS-AUCNTK-FDR-DPRTR-TMST                                 
318600               ,:WS-AUCNTK-FDR-POE-DELY-TMST                              
318700               ,:WS-AUCNTK-FDR-CARR-SCAC-ID                               
318800               ,:WS-AUCNTK-FDR-FOB-CDE                                    
318900               ,:WS-AUCNTK-FDR-IMPRT-VEH-NM                               
319000               ,:WS-AUCNTK-FDR-TRIP-TYP-CDE                               
319100               ,:WS-AUCNTK-FDR-DEST-POE-CDE                               
319200               ,:WS-02-AUCNTK-SIZE-CDE                                    
319300               ,:WS-AUCNTK-CART-CNT                                       
319400               ,:WS-AUCNTK-CBMT-QTY                                       
319500               ,:WS-AUCNTK-WT-KGRM-QTY                                    
319600               ,:WS-AUCNTK-UNT-QTY                                        
319700               ,:WS-AUCNTK-ORGN-SHPD-FR-CDE                               
319800               ,:WS-AUCNTK-ORGN-SHPD-TO-CDE                               
319900               ,:WS-AUCNTK-EST-LBD-NM                                     
320000               ,:WS-AUCNTK-EST-LBD-TMST                                   
320100               ,:WS-AUCNTK-RISU-DO-RSN-CDE                                
320200               ,:WS-AUCNTK-BKR-FRGT-RLSE-TMST                             
320300               ,:WS-AUCNTK-DO-TO-DCONSLR-TMST                             
320400               ,:WS-AUCNTK-DO-RCVD-TMST                                   
320500               ,:WS-AUCNTK-CONTNR-PU-TMST                                 
320600               ,:WS-AUCNTK-DAT-SRC-ENT-ID                                 
320700               ,:WS-AUCNTK-LAST-UPD-BY-USR-ID                             
320800               ,:WS-AUCNTK-LAST-UPD-TMST                                  
320900               ,:WS-AUCNTK-AUD-FUNC-CDE                                   
321000               ,:WS-AUCNTK-AUD-TMST                                       
321100               ,:WS-AUCNTK-ACTL-POE-DELY-TMST                             
321200               ,:WS-AUCNTK-ACTL-DEST-POE-CDE                              
321300               ,:WS-AUCNTK-ACTL-LBD-NM                                    
321400               ,:WS-AUCNTK-ACTL-LBD-TMST                                  
321500               ,:WS-02-AUCNTK-DVN-TMST                                    
321600               ,:WS-02-AUCNTK-DCONSLR-SCAC-ID                             
321700               ,:WS-AUCNTK-DCONSLR-RET-TMST                               
321800               ,:WS-AUCNTK-MOM-POL-CDE                                    
321900               ,:WS-AUCNTK-FDR-POL-CDE                                    
322000               ,:WS-AUCNTK-MOM-POR-CDE                                    
322100               ,:WS-AUCNTK-FDR-POR-CDE                                    
322100               ,:WS-AUCNTK-DCONSLR-DELY-TMST                              
322200        END-EXEC                                                          
322300                                                                          
322400        EVALUATE TRUE                                                     
322500            WHEN SQLCODE = ZERO OR -305                                   
322600                 MOVE LENGTH OF WS-AUCNTK TO DS009-TBLE-DATA-SIZE         
322700                 COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE         
322800                                        + DS009-RECORD-FILLER             
322900                 MOVE 01     TO DS002-ORDER                               
323000                 MOVE 02     TO DS002-VERSION                             
323100                 MOVE DS009-TBLE-DATA-SIZE TO DS002-DATA-SIZE             
323200                 MOVE 'TAUCNTK'            TO DS002-NAME                  
323300                 MOVE WS-AUCNTK            TO DS002-DATA-ITEM             
323400                 INITIALIZE DS009-PKYS                                    
323500                 PERFORM DS002-PROCESS-KEYS                               
323600                 MOVE WS-AUCNTK-KEYS      TO DS009-PKYS                   
323700                 MOVE DS009-PKYS          TO DS002-KEYS                   
323800                 PERFORM 8000-WRITE-UNLOAD                                
323900                                                                          
324000            WHEN SQLCODE = +100                                           
324100                 SET NO-MORE-AUCNTK-DATA  TO TRUE                         
324200            WHEN SQLCODE = -904                                           
324300            WHEN SQLCODE = -913                                           
324400              CONTINUE                                                    
324500           END-EVALUATE                                                   
324600         END-PERFORM.                                                     
324700*****************************************************************         
324800     PERFORM DS002-SQL-ABEND-FETCH.                                       
324900*****************************************************************         
325000/                                                                         
325100*****************************************************************         
325200*     FETCH ELCPO DATA                                                    
325300*****************************************************************         
325400*                                                                         
325500 R100-FETCH-ELCPO.                                                        
325600*                                                                         
325700     MOVE  'TELCPO'   TO DS009-PROCESS-TABLE.                             
325800     PERFORM WITH TEST AFTER                                              
325900        VARYING DS009-RETRY-COUNTER FROM 1 BY 1                           
326000        UNTIL   DS009-RETRY-COUNTER > 3 OR                                
326100                SQLCODE = ZERO OR                                         
326200                SQLCODE = +100                                            
326300        EXEC SQL                                                          
326400            FETCH ELCPO_CSR                                               
326500            INTO                                                          
326600                 :WS-ELCPO                                                
326700        END-EXEC                                                          
326800                                                                          
326900        EVALUATE TRUE                                                     
327000            WHEN SQLCODE = ZERO OR -305                                   
327100                 MOVE LENGTH OF WS-ELCPO TO DS009-TBLE-DATA-SIZE          
327200                 COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE         
327300                                        + DS009-RECORD-FILLER             
327400                 MOVE 01     TO DS002-ORDER                               
327500                 MOVE 01     TO DS002-VERSION                             
327600                 MOVE DS009-TBLE-DATA-SIZE TO DS002-DATA-SIZE             
327700                 MOVE 'TELCPO'             TO DS002-NAME                  
327800                 MOVE WS-ELCPO             TO DS002-DATA-ITEM             
327900                 INITIALIZE DS009-PKYS                                    
328000                 PERFORM DS002-PROCESS-KEYS                               
328100                 MOVE WS-ELCPO-KEYS       TO DS009-PKYS                   
328200                 MOVE DS009-PKYS          TO DS002-KEYS                   
328300                 PERFORM 8000-WRITE-UNLOAD                                
328400                                                                          
328500            WHEN SQLCODE = +100                                           
328600                 SET NO-MORE-ELCPO-DATA   TO TRUE                         
328700            WHEN SQLCODE = -904                                           
328800            WHEN SQLCODE = -913                                           
328900              CONTINUE                                                    
329000           END-EVALUATE                                                   
329100         END-PERFORM.                                                     
329200*****************************************************************         
329300     PERFORM DS002-SQL-ABEND-FETCH.                                       
329400*****************************************************************         
329500/                                                                         
329600*****************************************************************         
329700*     FETCH ELCVS DATA                                                    
329800*****************************************************************         
329900*                                                                         
330000 R100-FETCH-ELCVS.                                                        
330100*                                                                         
330200     MOVE  'TELCVS'   TO DS009-PROCESS-TABLE.                             
330300     PERFORM WITH TEST AFTER                                              
330400        VARYING DS009-RETRY-COUNTER FROM 1 BY 1                           
330500        UNTIL   DS009-RETRY-COUNTER > 3 OR                                
330600                SQLCODE = ZERO OR                                         
330700                SQLCODE = +100                                            
330800        EXEC SQL                                                          
330900            FETCH ELCVS_CSR                                               
331000            INTO                                                          
331100                 :WS-ELCVS                                                
331200        END-EXEC                                                          
331300                                                                          
331400        EVALUATE TRUE                                                     
331500            WHEN SQLCODE = ZERO OR -305                                   
331600                 MOVE LENGTH OF WS-ELCVS TO DS009-TBLE-DATA-SIZE          
331700                 COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE         
331800                                        + DS009-RECORD-FILLER             
331900                 MOVE 01     TO DS002-ORDER                               
332000                 MOVE 01     TO DS002-VERSION                             
332100                 MOVE DS009-TBLE-DATA-SIZE TO DS002-DATA-SIZE             
332200                 MOVE 'TELCVS'             TO DS002-NAME                  
332300                 MOVE WS-ELCVS             TO DS002-DATA-ITEM             
332400                 INITIALIZE DS009-PKYS                                    
332500                 PERFORM DS002-PROCESS-KEYS                               
332600                 MOVE WS-ELCVS-KEYS       TO DS009-PKYS                   
332700                 MOVE DS009-PKYS          TO DS002-KEYS                   
332800                 PERFORM 8000-WRITE-UNLOAD                                
332900                                                                          
333000            WHEN SQLCODE = +100                                           
333100                 SET NO-MORE-ELCVS-DATA   TO TRUE                         
333200            WHEN SQLCODE = -904                                           
333300            WHEN SQLCODE = -913                                           
333400              CONTINUE                                                    
333500           END-EVALUATE                                                   
333600         END-PERFORM.                                                     
333700*****************************************************************         
333800     PERFORM DS002-SQL-ABEND-FETCH.                                       
333900*****************************************************************         
334000/                                                                         
334100*****************************************************************         
334200*     FETCH VSCPT DATA                                                    
334300*****************************************************************         
334400*                                                                         
334500 R100-FETCH-VSCPT.                                                        
334600*                                                                         
334700     MOVE  'TVSCPT'   TO DS009-PROCESS-TABLE.                             
334800     PERFORM WITH TEST AFTER                                              
334900        VARYING DS009-RETRY-COUNTER FROM 1 BY 1                           
335000        UNTIL   DS009-RETRY-COUNTER > 3 OR                                
335100                SQLCODE = ZERO OR                                         
335200                SQLCODE = +100                                            
335300        EXEC SQL                                                          
335400            FETCH VSCPT_CSR                                               
335500            INTO                                                          
335600                 :WS-VSCPT                                                
335700        END-EXEC                                                          
335800                                                                          
335900        EVALUATE TRUE                                                     
336000            WHEN SQLCODE = ZERO OR -305                                   
336100                 MOVE LENGTH OF WS-VSCPT TO DS009-TBLE-DATA-SIZE          
336200                 COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE         
336300                                        + DS009-RECORD-FILLER             
336400                 MOVE 01     TO DS002-ORDER                               
336500                 MOVE 01     TO DS002-VERSION                             
336600                 MOVE DS009-TBLE-DATA-SIZE TO DS002-DATA-SIZE             
336700                 MOVE 'TVSCPT'             TO DS002-NAME                  
336800                 MOVE WS-VSCPT             TO DS002-DATA-ITEM             
336900                 INITIALIZE DS009-PKYS                                    
337000                 PERFORM DS002-PROCESS-KEYS                               
337100                 MOVE WS-VSCPT-KEYS       TO DS009-PKYS                   
337200                 MOVE DS009-PKYS          TO DS002-KEYS                   
337300                 PERFORM 8000-WRITE-UNLOAD                                
337400                                                                          
337500            WHEN SQLCODE = +100                                           
337600                 SET NO-MORE-VSCPT-DATA   TO TRUE                         
337700            WHEN SQLCODE = -904                                           
337800            WHEN SQLCODE = -913                                           
337900              CONTINUE                                                    
338000           END-EVALUATE                                                   
338100         END-PERFORM.                                                     
338200*****************************************************************         
338300     PERFORM DS002-SQL-ABEND-FETCH.                                       
338400*****************************************************************         
338500*****************************************************************         
338600     PERFORM DS002-SQL-ABEND-FETCH.                                       
338700*****************************************************************         
338800/                                                                         
338900*****************************************************************         
339000*     FETCH AUCNRL DATA                                                   
339100*****************************************************************         
339200*                                                                         
339300 R100-FETCH-AUCNRL.                                                       
339400*                                                                         
339500     MOVE  'TAUCNRL'   TO DS009-PROCESS-TABLE.                            
339600     PERFORM WITH TEST AFTER                                              
339700        VARYING DS009-RETRY-COUNTER FROM 1 BY 1                           
339800        UNTIL   DS009-RETRY-COUNTER > 3 OR                                
339900                SQLCODE = ZERO OR                                         
340000                SQLCODE = +100                                            
340100        EXEC SQL                                                          
340200            FETCH AUCNRL-CSR                                              
340300            INTO                                                          
340400               :AUCNRL-CONTNR-ID                                          
340500             , :AUCNRL-CONTNR-SEQ-NBR                                     
340600             , :AUCNRL-PO-NBR                                             
340700             , :AUCNRL-DCONSLR-RLSE-CDE                                   
340800             , :AUCNRL-DCONSLR-REQR-DTE                                   
340900             , :AUCNRL-DCONSLR-ACTL-DTE                                   
341000             , :AUCNRL-DCONSLR-ACTL-TM                                    
341100             , :AUCNRL-CRE-TMST                                           
341200             , :AUCNRL-CRE-BY-UID                                         
341300             , :AUCNRL-AUD-FUNC-CDE                                       
341400             , :AUCNRL-AUD-TMST                                           
341500             , :AUCNRL-LAST-UPD-TMST                                      
341600             , :AUCNRL-LAST-UPD-BY-UID                                    
341700             , :AUCNRL-DCONSLR-ENT-ID                                     
341800        END-EXEC                                                          
341900                                                                          
342000        EVALUATE TRUE                                                     
342100            WHEN SQLCODE = ZERO OR -305                                   
342200                 MOVE LENGTH OF DCLTAUCNRL                                
342300                                          TO DS009-TBLE-DATA-SIZE         
342400                 COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE         
342500                                        + DS009-RECORD-FILLER             
342600                 MOVE 03     TO DS002-ORDER                               
342700                 MOVE 02     TO DS002-VERSION                             
342800                 MOVE DS009-TBLE-DATA-SIZE TO DS002-DATA-SIZE             
342900                 MOVE 'TAUCNRL'            TO DS002-NAME                  
343000                 MOVE DCLTAUCNRL           TO DS002-DATA-ITEM             
343100                 INITIALIZE DS009-PKYS                                    
343200                 PERFORM DS002-PROCESS-KEYS                               
343300                 MOVE WS-AUCNRL-KEYS      TO DS009-PKYS                   
343400                 MOVE DS009-PKYS          TO DS002-KEYS                   
343500                 PERFORM 8000-WRITE-UNLOAD                                
343600                                                                          
343700            WHEN SQLCODE = +100                                           
343800                 SET NO-MORE-AUCNRL-DATA  TO TRUE                         
343900            WHEN SQLCODE = -904                                           
344000            WHEN SQLCODE = -913                                           
344100              CONTINUE                                                    
344200           END-EVALUATE                                                   
344300         END-PERFORM.                                                     
344400/                                                                         
338900*****************************************************************         
339000*     FETCH TRT_WHSE_RPLNT_INBND_PO DATA                                  
339100*****************************************************************         
339200*                                                                         
339300*R100-FETCH-TRT00057.                                                     
339400*                                                                         
339500*    MOVE  'RPLNT_INBND_PO'   TO DS009-PROCESS-TABLE.                     
339600*    PERFORM WITH TEST AFTER                                              
339700*       VARYING DS009-RETRY-COUNTER FROM 1 BY 1                           
339800*       UNTIL   DS009-RETRY-COUNTER > 3 OR                                
339900*               SQLCODE = ZERO OR                                         
340000*               SQLCODE = +100                                            
340100*       EXEC SQL                                                          
340200*           FETCH TRT00057-CSR                                            
340300*           INTO                                                          
343500*              :WS-TRT57-WHSE-RPLNT-INBND-ID                              
343500*            , :WS-TRT57-PO-NBR                                           
343500*            , :WS-TRT57-EXTL-REF-NBR                                     
343700*            , :WS-TRT57-DCONSLR-VEH-DPRTR-IND                            
343800*            , :WS-TRT57-WHSE-ARRVL-IND                                   
343900*            , :WS-TRT57-WHSE-AUD-CMPLT-IND                               
344000*            , :WS-TRT57-CRE-USR-ID                                       
344100*            , :WS-TRT57-CRE-TMST                                         
344200*            , :WS-TRT57-LAST-UPD-USR-ID                                  
344200*            , :WS-TRT57-LAST-UPD-TMST                                    
341800*       END-EXEC                                                          
341900*                                                                         
342000*       EVALUATE TRUE                                                     
342100*           WHEN SQLCODE = ZERO                                           
342200*                MOVE LENGTH OF DCLTRT00057                               
342300*                                         TO DS009-TBLE-DATA-SIZE         
342400*                COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE         
342500*                                       + DS009-RECORD-FILLER             
342600*                MOVE 03     TO DS002-ORDER                               
342700*                MOVE 02     TO DS002-VERSION                             
342800*                MOVE DS009-TBLE-DATA-SIZE TO DS002-DATA-SIZE             
342900*                MOVE 'RPLNT_INBND_PO'  TO DS002-NAME                     
343000*                MOVE DCLTRT00057          TO DS002-DATA-ITEM             
343100*                INITIALIZE DS009-PKYS                                    
343200*                PERFORM DS002-PROCESS-KEYS                               
343300*                MOVE DS008-TRT00057-KEYS TO DS009-PKYS                   
343400*                MOVE DS009-PKYS          TO DS002-KEYS                   
343500*                PERFORM 8000-WRITE-UNLOAD                                
343600*                                                                         
343500*                MOVE WS-TRT57-WHSE-RPLNT-INBND-ID                        
343500*                                           TO HOLD-RPLNT-ID              
343500*                MOVE WS-TRT57-EXTL-REF-NBR TO HOLD-EXTL-REF-NBR          
343500*                                                                         
143000*                MOVE 'RPLNT_INBND_CART' TO DS009-PROCESS-TABLE           
143100*                PERFORM DS002-DO-PROCESS                                 
143200*                IF DS009-DO-PROCESS                                      
143300*                   SET MORE-TRT00058-DATA TO TRUE                        
143400*                   PERFORM Y100-OPEN-CURSOR                              
143500*                   PERFORM R100-FETCH-TRT00058                           
143600*                       UNTIL NO-MORE-TRT00058-DATA                       
143000*                   MOVE 'RPLNT_INBND_PO' TO DS009-PROCESS-TABLE          
143800*                   PERFORM Y100-CLOSE-CURSOR                             
143900*                END-IF                                                   
144000*                                                                         
143000*                MOVE 'RPLNT_INBND'       TO DS009-PROCESS-TABLE          
143100*                PERFORM DS002-DO-PROCESS                                 
143200*                IF DS009-DO-PROCESS                                      
143500*                   PERFORM R200-READ-TRT00056                            
143000*                   MOVE 'RPLNT_INBND_PO' TO DS009-PROCESS-TABLE          
143900*                END-IF                                                   
144000*                                                                         
342100*           WHEN SQLCODE = -305                                           
342200*                MOVE LENGTH OF DCLTRT00057                               
342300*                                         TO DS009-TBLE-DATA-SIZE         
342400*                COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE         
342500*                                       + DS009-RECORD-FILLER             
342600*                MOVE 03     TO DS002-ORDER                               
342700*                MOVE 02     TO DS002-VERSION                             
342800*                MOVE DS009-TBLE-DATA-SIZE TO DS002-DATA-SIZE             
342900*                MOVE 'RPLNT_INBND_PO'     TO DS002-NAME                  
343000*                MOVE DCLTRT00057          TO DS002-DATA-ITEM             
343100*                INITIALIZE DS009-PKYS                                    
343200*                PERFORM DS002-PROCESS-KEYS                               
343300*                MOVE DS008-TRT00057-KEYS TO DS009-PKYS                   
343400*                MOVE DS009-PKYS          TO DS002-KEYS                   
343500*                PERFORM 8000-WRITE-UNLOAD                                
343600*                                                                         
343700*           WHEN SQLCODE = +100                                           
343800*                SET NO-MORE-TRT00057-DATA  TO TRUE                       
343900*           WHEN SQLCODE = -904                                           
344000*           WHEN SQLCODE = -913                                           
344100*             CONTINUE                                                    
344200*          END-EVALUATE                                                   
344300*        END-PERFORM.                                                     
344400*                                                                         
338900*****************************************************************         
339000*     FETCH TRT_WHSE_RPLNT_INBND_CART DATA                                
339100*****************************************************************         
339200*                                                                         
339300*R100-FETCH-TRT00058.                                                     
339400*                                                                         
339500*    MOVE  'RPLNT_INBND_CART' TO DS009-PROCESS-TABLE.                     
339600*    PERFORM WITH TEST AFTER                                              
339700*       VARYING DS009-RETRY-COUNTER FROM 1 BY 1                           
339800*       UNTIL   DS009-RETRY-COUNTER > 3 OR                                
339900*               SQLCODE = ZERO OR                                         
340000*               SQLCODE = +100                                            
340100*       EXEC SQL                                                          
340200*           FETCH TRT00058-CSR                                            
340300*           INTO                                                          
343500*              :WS-TRT58-WHSE-RPLNT-INBND-ID                              
343500*            , :WS-TRT58-PO-NBR                                           
343500*            , :WS-TRT58-EXTL-REF-NBR                                     
343500*            , :WS-TRT58-SSCC-ID                                          
343700*            , :WS-TRT58-DCONSLR-DPRTR-IND                                
343800*            , :WS-TRT58-WHSE-ARRVL-SSCC-IND                              
343900*            , :WS-TRT58-WHSE-AUD-CMPLT-IND                               
343900*            , :WS-TRT58-WHSE-AUD-UNT-QTY                                 
344000*            , :WS-TRT58-CRE-USR-ID                                       
344100*            , :WS-TRT58-CRE-TMST                                         
344200*            , :WS-TRT58-LAST-UPD-USR-ID                                  
344200*            , :WS-TRT58-LAST-UPD-TMST                                    
341800*       END-EXEC                                                          
341900*                                                                         
342000*       EVALUATE TRUE                                                     
342100*           WHEN SQLCODE = ZERO OR -305                                   
342200*                MOVE LENGTH OF DCLTRT00058                               
342300*                                         TO DS009-TBLE-DATA-SIZE         
342400*                COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE         
342500*                                       + DS009-RECORD-FILLER             
342600*                MOVE 03     TO DS002-ORDER                               
342700*                MOVE 02     TO DS002-VERSION                             
342800*                MOVE DS009-TBLE-DATA-SIZE TO DS002-DATA-SIZE             
342900*                MOVE 'RPLNT_INBND_CART'   TO DS002-NAME                  
343000*                MOVE DCLTRT00058          TO DS002-DATA-ITEM             
343100*                INITIALIZE DS009-PKYS                                    
343200*                PERFORM DS002-PROCESS-KEYS                               
343300*                MOVE DS008-TRT00058-KEYS TO DS009-PKYS                   
343400*                MOVE DS009-PKYS          TO DS002-KEYS                   
343500*                PERFORM 8000-WRITE-UNLOAD                                
343600*                                                                         
343700*           WHEN SQLCODE = +100                                           
343800*                SET NO-MORE-TRT00058-DATA  TO TRUE                       
343900*           WHEN SQLCODE = -904                                           
344000*           WHEN SQLCODE = -913                                           
344100*             CONTINUE                                                    
344200*          END-EVALUATE                                                   
344300*        END-PERFORM.                                                     
344400*                                                                         
338900*****************************************************************         
339000*     FETCH TRT_WHSE_RPLNT_INBND_PO_AUD DATA                              
339100*****************************************************************         
339200*                                                                         
339300*R100-FETCH-TRT00060.                                                     
339400*                                                                         
339500*    MOVE  'RPLNT_INBND_PO_AUD'  TO DS009-PROCESS-TABLE.                  
339600*    PERFORM WITH TEST AFTER                                              
339700*       VARYING DS009-RETRY-COUNTER FROM 1 BY 1                           
339800*       UNTIL   DS009-RETRY-COUNTER > 3 OR                                
339900*               SQLCODE = ZERO OR                                         
340000*               SQLCODE = +100                                            
340100*       EXEC SQL                                                          
340200*           FETCH TRT00060-CSR                                            
340300*           INTO                                                          
343500*              :WS-TRT60-WHSE-RPLNT-INBND-ID                              
343500*            , :WS-TRT60-PO-NBR                                           
343500*            , :WS-TRT60-EXTL-REF-NBR                                     
343700*            , :WS-TRT60-DCONSLR-VEH-DPRTR-IND                            
343800*            , :WS-TRT60-WHSE-ARRVL-IND                                   
343900*            , :WS-TRT60-WHSE-AUD-CMPLT-IND                               
344000*            , :WS-TRT60-CRE-USR-ID                                       
344100*            , :WS-TRT60-CRE-TMST                                         
344200*            , :WS-TRT60-LAST-UPD-USR-ID                                  
344200*            , :WS-TRT60-LAST-UPD-TMST                                    
344200*            , :WS-TRT60-AUD-FUNC-CDE                                     
344200*            , :WS-TRT60-AUD-TMST                                         
341800*       END-EXEC                                                          
341900*                                                                         
342000*       EVALUATE TRUE                                                     
342100*           WHEN SQLCODE = ZERO                                           
342200*                MOVE LENGTH OF DCLTRT00060                               
342300*                                         TO DS009-TBLE-DATA-SIZE         
342400*                COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE         
342500*                                       + DS009-RECORD-FILLER             
342600*                MOVE 03     TO DS002-ORDER                               
342700*                MOVE 02     TO DS002-VERSION                             
342800*                MOVE DS009-TBLE-DATA-SIZE TO DS002-DATA-SIZE             
342900*                MOVE 'RPLNT_INBND_PO_AUD' TO DS002-NAME                  
343000*                MOVE DCLTRT00060          TO DS002-DATA-ITEM             
343100*                INITIALIZE DS009-PKYS                                    
343200*                PERFORM DS002-PROCESS-KEYS                               
343300*                MOVE DS008-TRT00060-KEYS TO DS009-PKYS                   
343400*                MOVE DS009-PKYS          TO DS002-KEYS                   
343500*                PERFORM 8000-WRITE-UNLOAD                                
343600*                                                                         
343500*                MOVE WS-TRT60-WHSE-RPLNT-INBND-ID                        
343500*                                           TO HOLD-RPLNT-ID              
343500*                MOVE WS-TRT60-EXTL-REF-NBR TO HOLD-EXTL-REF-NBR          
343500*                                                                         
143000*                MOVE 'RPLNT_INBND_CART_A'  TO DS009-PROCESS-TABLE        
143100*                PERFORM DS002-DO-PROCESS                                 
143200*                IF DS009-DO-PROCESS                                      
143300*                   SET MORE-TRT00061-DATA TO TRUE                        
143400*                   PERFORM Y100-OPEN-CURSOR                              
143500*                   PERFORM R100-FETCH-TRT00061                           
143600*                       UNTIL NO-MORE-TRT00061-DATA                       
143000*                   MOVE 'RPLNT_INBND_PO_AUD'                             
143000*                                       TO DS009-PROCESS-TABLE            
143800*                   PERFORM Y100-CLOSE-CURSOR                             
143900*                END-IF                                                   
144000*                                                                         
143000*                MOVE 'RPLNT_INBND_AUD' TO DS009-PROCESS-TABLE            
143100*                PERFORM DS002-DO-PROCESS                                 
143200*                IF DS009-DO-PROCESS                                      
143500*                   PERFORM R200-READ-TRT00056                            
143000*                   MOVE 'RPLNT_INBND_PO_AUD'                             
143000*                                       TO DS009-PROCESS-TABLE            
143900*                END-IF                                                   
144000*                                                                         
342100*           WHEN SQLCODE = -305                                           
342200*                MOVE LENGTH OF DCLTRT00060                               
342300*                                         TO DS009-TBLE-DATA-SIZE         
342400*                COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE         
342500*                                       + DS009-RECORD-FILLER             
342600*                MOVE 03     TO DS002-ORDER                               
342700*                MOVE 02     TO DS002-VERSION                             
342800*                MOVE DS009-TBLE-DATA-SIZE TO DS002-DATA-SIZE             
342900*                MOVE 'RPLNT_INBND_PO_AUD' TO DS002-NAME                  
343000*                MOVE DCLTRT00060          TO DS002-DATA-ITEM             
343100*                INITIALIZE DS009-PKYS                                    
343200*                PERFORM DS002-PROCESS-KEYS                               
343300*                MOVE DS008-TRT00060-KEYS TO DS009-PKYS                   
343400*                MOVE DS009-PKYS          TO DS002-KEYS                   
343500*                PERFORM 8000-WRITE-UNLOAD                                
343600*                                                                         
343700*           WHEN SQLCODE = +100                                           
343800*                SET NO-MORE-TRT00060-DATA  TO TRUE                       
343900*           WHEN SQLCODE = -904                                           
344000*           WHEN SQLCODE = -913                                           
344100*             CONTINUE                                                    
344200*          END-EVALUATE                                                   
344300*        END-PERFORM.                                                     
344400*                                                                         
338900*****************************************************************         
339000*     FETCH TRT_WHSE_RPLNT_INBND_CART_AUD DATA                            
339100*****************************************************************         
339200*                                                                         
339300*R100-FETCH-TRT00061.                                                     
339400*                                                                         
339500*    MOVE  'RPLNT_INBND_CART_A' TO DS009-PROCESS-TABLE.                   
339600*    PERFORM WITH TEST AFTER                                              
339700*       VARYING DS009-RETRY-COUNTER FROM 1 BY 1                           
339800*       UNTIL   DS009-RETRY-COUNTER > 3 OR                                
339900*               SQLCODE = ZERO OR                                         
340000*               SQLCODE = +100                                            
340100*       EXEC SQL                                                          
340200*           FETCH TRT00061-CSR                                            
340300*           INTO                                                          
343500*              :WS-TRT61-WHSE-RPLNT-INBND-ID                              
343500*            , :WS-TRT61-PO-NBR                                           
343500*            , :WS-TRT61-EXTL-REF-NBR                                     
343500*            , :WS-TRT61-SSCC-ID                                          
343700*            , :WS-TRT61-DCONSLR-DPRTR-IND                                
343800*            , :WS-TRT61-WHSE-ARRVL-SSCC-IND                              
343900*            , :WS-TRT61-WHSE-AUD-CMPLT-IND                               
343900*            , :WS-TRT61-WHSE-AUD-UNT-QTY                                 
344000*            , :WS-TRT61-CRE-USR-ID                                       
344100*            , :WS-TRT61-CRE-TMST                                         
344200*            , :WS-TRT61-LAST-UPD-USR-ID                                  
344200*            , :WS-TRT61-LAST-UPD-TMST                                    
344200*            , :WS-TRT61-AUD-FUNC-CDE                                     
344200*            , :WS-TRT61-AUD-TMST                                         
341800*       END-EXEC                                                          
341900*                                                                         
342000*       EVALUATE TRUE                                                     
342100*           WHEN SQLCODE = ZERO OR -305                                   
342200*                MOVE LENGTH OF DCLTRT00061                               
342300*                                         TO DS009-TBLE-DATA-SIZE         
342400*                COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE         
342500*                                       + DS009-RECORD-FILLER             
342600*                MOVE 03     TO DS002-ORDER                               
342700*                MOVE 02     TO DS002-VERSION                             
342800*                MOVE DS009-TBLE-DATA-SIZE TO DS002-DATA-SIZE             
342900*                MOVE 'RPLNT_INBND_CART_A' TO DS002-NAME                  
343000*                MOVE DCLTRT00061          TO DS002-DATA-ITEM             
343100*                INITIALIZE DS009-PKYS                                    
343200*                PERFORM DS002-PROCESS-KEYS                               
343300*                MOVE DS008-TRT00061-KEYS TO DS009-PKYS                   
343400*                MOVE DS009-PKYS          TO DS002-KEYS                   
343500*                PERFORM 8000-WRITE-UNLOAD                                
343600*                                                                         
343700*           WHEN SQLCODE = +100                                           
343800*                SET NO-MORE-TRT00061-DATA  TO TRUE                       
343900*           WHEN SQLCODE = -904                                           
344000*           WHEN SQLCODE = -913                                           
344100*             CONTINUE                                                    
344200*          END-EVALUATE                                                   
344300*        END-PERFORM.                                                     
344400*                                                                         
338900*****************************************************************         
339000*     READ TRT_WHSE_RPLNT_INBND DATA                                      
339100*****************************************************************         
339200*                                                                         
339300*R200-READ-TRT00056.                                                      
339400*                                                                         
339500*    MOVE  'RPLNT_INBND'      TO DS009-PROCESS-TABLE.                     
339600*    PERFORM WITH TEST AFTER                                              
339700*       VARYING DS009-RETRY-COUNTER FROM 1 BY 1                           
339800*       UNTIL   DS009-RETRY-COUNTER > 3 OR                                
339900*               SQLCODE = ZERO OR                                         
340000*               SQLCODE = +100                                            
340100*       EXEC SQL                                                          
340200*           SELECT                                                        
343500*              WHSE_RPLNT_INBND_ID                                        
343500*            , OWNER_SCAC_ID                                              
343500*            , VEH_NBR                                                    
343700*            , DCONSLR_DPRTR_TMST                                         
343800*            , DCONSLR_TRP_ID                                             
343900*            , WHSE_LOC_ID                                                
343900*            , DCONSLR_SCAC_CDE                                           
344000*            , WHSE_ARRVL_TMST                                            
344100*            , WHSE_AUD_CMPLT_TMST                                        
344200*            , POE_STD_EDI_CDE                                            
344200*            , CRE_USR_ID                                                 
344200*            , CRE_TMST                                                   
344200*            , LAST_UPD_USR_ID                                            
344200*            , LAST_UPD_TMST                                              
340300*           INTO                                                          
343500*              :WS-TRT56-WHSE-RPLNT-INBND-ID                              
343500*            , :WS-TRT56-OWNER-SCAC-ID                                    
343500*            , :WS-TRT56-VEH-NBR                                          
343700*            , :WS-TRT56-DCONSLR-DPRTR-TMST                               
343800*            , :WS-TRT56-DCONSLR-TRP-ID                                   
343900*            , :WS-TRT56-WHSE-LOC-ID                                      
343900*            , :WS-TRT56-DCONSLR-SCAC-CDE                                 
344000*            , :WS-TRT56-WHSE-ARRVL-TMST                                  
344100*            , :WS-TRT56-WHSE-AUD-CMPLT-TMST                              
344200*            , :WS-TRT56-POE-STD-EDI-CDE                                  
344200*            , :WS-TRT56-CRE-USR-ID                                       
344200*            , :WS-TRT56-CRE-TMST                                         
344200*            , :WS-TRT56-LAST-UPD-USR-ID                                  
344200*            , :WS-TRT56-LAST-UPD-TMST                                    
340200*           FROM TRT_WHSE_RPLNT_INBND                                     
341800*       END-EXEC                                                          
341900*                                                                         
342000*       EVALUATE TRUE                                                     
342100*           WHEN SQLCODE = ZERO OR -305                                   
342200*                MOVE LENGTH OF DCLTRT00056                               
342300*                                         TO DS009-TBLE-DATA-SIZE         
342400*                COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE         
342500*                                       + DS009-RECORD-FILLER             
342600*                MOVE 03     TO DS002-ORDER                               
342700*                MOVE 02     TO DS002-VERSION                             
342800*                MOVE DS009-TBLE-DATA-SIZE TO DS002-DATA-SIZE             
342900*                MOVE 'RPLNT_INBND'        TO DS002-NAME                  
343000*                MOVE DCLTRT00056          TO DS002-DATA-ITEM             
343100*                INITIALIZE DS009-PKYS                                    
343200*                PERFORM DS002-PROCESS-KEYS                               
343300*                MOVE DS008-TRT00056-KEYS TO DS009-PKYS                   
343400*                MOVE DS009-PKYS          TO DS002-KEYS                   
343500*                PERFORM 8000-WRITE-UNLOAD                                
343600*                                                                         
343700*           WHEN SQLCODE = +100                                           
343900*           WHEN SQLCODE = -904                                           
344000*           WHEN SQLCODE = -913                                           
344100*             CONTINUE                                                    
344200*          END-EVALUATE                                                   
344300*        END-PERFORM.                                                     
344400*                                                                         
338900*****************************************************************         
339000*     READ TRT_WHSE_RPLNT_INBND_AUD DATA                                  
339100*****************************************************************         
339200*                                                                         
339300*R200-READ-TRT00059.                                                      
339400*                                                                         
339500*    MOVE  'RPLNT_INBND_AUD'  TO DS009-PROCESS-TABLE.                     
339600*    PERFORM WITH TEST AFTER                                              
339700*       VARYING DS009-RETRY-COUNTER FROM 1 BY 1                           
339800*       UNTIL   DS009-RETRY-COUNTER > 3 OR                                
339900*               SQLCODE = ZERO OR                                         
340000*               SQLCODE = +100                                            
340100*       EXEC SQL                                                          
340200*           SELECT                                                        
343500*              WHSE_RPLNT_INBND_ID                                        
343500*            , OWNER_SCAC_ID                                              
343500*            , VEH_NBR                                                    
343700*            , DCONSLR_DPRTR_TMST                                         
343800*            , DCONSLR_TRP_ID                                             
343900*            , WHSE_LOC_ID                                                
343900*            , DCONSLR_SCAC_CDE                                           
344000*            , WHSE_ARRVL_TMST                                            
344100*            , WHSE_AUD_CMPLT_TMST                                        
344200*            , POE_STD_EDI_CDE                                            
344200*            , CRE_USR_ID                                                 
344200*            , CRE_TMST                                                   
344200*            , LAST_UPD_USR_ID                                            
344200*            , LAST_UPD_TMST                                              
344200*            , AUD_FUNC_CDE                                               
344200*            , AUD_TMST                                                   
340300*           INTO                                                          
343500*              :WS-TRT59-WHSE-RPLNT-INBND-ID                              
343500*            , :WS-TRT59-OWNER-SCAC-ID                                    
343500*            , :WS-TRT59-VEH-NBR                                          
343700*            , :WS-TRT59-DCONSLR-DPRTR-TMST                               
343800*            , :WS-TRT59-DCONSLR-TRP-ID                                   
343900*            , :WS-TRT59-WHSE-LOC-ID                                      
343900*            , :WS-TRT59-DCONSLR-SCAC-CDE                                 
344000*            , :WS-TRT59-WHSE-ARRVL-TMST                                  
344100*            , :WS-TRT59-WHSE-AUD-CMPLT-TMST                              
344200*            , :WS-TRT59-POE-STD-EDI-CDE                                  
344200*            , :WS-TRT59-CRE-USR-ID                                       
344200*            , :WS-TRT59-CRE-TMST                                         
344200*            , :WS-TRT59-LAST-UPD-USR-ID                                  
344200*            , :WS-TRT59-LAST-UPD-TMST                                    
344200*            , :WS-TRT59-AUD-FUNC-CDE                                     
344200*            , :WS-TRT59-AUD-TMST                                         
340200*           FROM TRT_WHSE_RPLNT_INBND_AUD                                 
341800*       END-EXEC                                                          
341900*                                                                         
342000*       EVALUATE TRUE                                                     
342100*           WHEN SQLCODE = ZERO OR -305                                   
342200*                MOVE LENGTH OF DCLTRT00059                               
342300*                                         TO DS009-TBLE-DATA-SIZE         
342400*                COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE         
342500*                                       + DS009-RECORD-FILLER             
342600*                MOVE 03     TO DS002-ORDER                               
342700*                MOVE 02     TO DS002-VERSION                             
342800*                MOVE DS009-TBLE-DATA-SIZE TO DS002-DATA-SIZE             
342900*                MOVE 'RPLNT_INBND_AUD'    TO DS002-NAME                  
343000*                MOVE DCLTRT00059          TO DS002-DATA-ITEM             
343100*                INITIALIZE DS009-PKYS                                    
343200*                PERFORM DS002-PROCESS-KEYS                               
343300*                MOVE DS008-TRT00059-KEYS TO DS009-PKYS                   
343400*                MOVE DS009-PKYS          TO DS002-KEYS                   
343500*                PERFORM 8000-WRITE-UNLOAD                                
343600*                                                                         
343700*           WHEN SQLCODE = +100                                           
343900*           WHEN SQLCODE = -904                                           
344000*           WHEN SQLCODE = -913                                           
344100*             CONTINUE                                                    
344200*          END-EVALUATE                                                   
344300*        END-PERFORM.                                                     
344400/                                                                         
344500 R900-FETCH-DA-RULES.                                                     
344600     DISPLAY 'R900-FETCH-DA-RULES'                                        
344700                                                                          
344800     MOVE 'TRT_RUL_CNSTR'   TO DS009-PROCESS-TABLE                        
344900     PERFORM Y100-OPEN-CURSOR                                             
345000     SET DS010-END-RULES-CNSTR-NO     TO TRUE                             
345100     PERFORM R901-FETCH-TRT00015                                          
345200                      UNTIL DS010-END-RULES-CNSTR-YES.                    
345300                                                                          
345400     MOVE 'TRT_RUL_CNSTR' TO DS009-PROCESS-TABLE                          
345500     PERFORM Y100-CLOSE-CURSOR.                                           
345600                                                                          
345700                                                                          
345800*        NOW GET THE RULES                                                
345900     MOVE 'TRT_RUL' TO DS009-PROCESS-TABLE                                
346000     PERFORM DS002-DO-PROCESS                                             
346100     IF DS009-DO-PROCESS                                                  
346200         SET DS010-END-RULES-NO       TO TRUE                             
346300         PERFORM Y100-OPEN-CURSOR                                         
346400         PERFORM R902-FETCH-RUL-MASTER                                    
346500                 UNTIL DS010-END-RULES-YES                                
346600         PERFORM Y100-CLOSE-CURSOR                                        
346700     END-IF                                                               
346800                                                                          
346900*    GET THE RULE CONTRAINT AUDITS                                        
347000     MOVE 'TRT_AUD_RUL_CNSTR' TO DS009-PROCESS-TABLE                      
347100     PERFORM DS002-DO-PROCESS                                             
347200     IF DS009-DO-PROCESS                                                  
347300         SET DS010-END-TRT00018-NO    TO TRUE                             
347400         PERFORM Y100-OPEN-CURSOR                                         
347500         PERFORM R903-FETCH-TRT00018                                      
347600                      UNTIL DS010-END-TRT00018-YES                        
347700         PERFORM Y100-CLOSE-CURSOR                                        
347800     END-IF                                                               
347900                                                                          
348000*    AND THE RULES AUDITS                                                 
348100     MOVE 'TRT_AUD_RUL' TO DS009-PROCESS-TABLE                            
348200     PERFORM DS002-DO-PROCESS                                             
348300     IF DS009-DO-PROCESS                                                  
348400         SET DS010-END-TRT00017-NO    TO TRUE                             
348500         PERFORM Y100-OPEN-CURSOR                                         
348600         PERFORM R904-FETCH-TRT00017                                      
348700                  UNTIL DS010-END-TRT00017-YES                            
348800         PERFORM Y100-CLOSE-CURSOR                                        
348900     END-IF.                                                              
349000                                                                          
349100                                                                          
349200 R900C1-OPEN-CONT-DRIVER.                                                 
349300                                                                          
349400     PERFORM WITH TEST AFTER                                              
349500             VARYING DS009-RETRY-COUNTER FROM 1 BY 1                      
349600             UNTIL   DS009-RETRY-COUNTER > 3 OR                           
349700                     SQLCODE = ZERO                                       
349800         EXEC SQL                                                         
349900             OPEN CONT-SPLIT-CSR                                          
350000         END-EXEC                                                         
350100                                                                          
350200         EVALUATE TRUE                                                    
350300             WHEN SQLCODE = ZERO                                          
350400             WHEN SQLCODE = -904                                          
350500             WHEN SQLCODE = -913                                          
350600                 CONTINUE                                                 
350700         END-EVALUATE                                                     
350800     END-PERFORM.                                                         
350900                                                                          
351000     PERFORM DS002-SQL-ABEND-OPEN-CSR.                                    
351100                                                                          
351200 R900C2-FETCH-CONT-DRIVER.                                                
351300                                                                          
351400     INITIALIZE DS010-RUL-ID                                              
351500                                                                          
351600     PERFORM WITH TEST AFTER                                              
351700        VARYING DS009-RETRY-COUNTER FROM 1 BY 1                           
351800        UNTIL   DS009-RETRY-COUNTER > 3 OR                                
351900                SQLCODE = ZERO OR                                         
352000                SQLCODE = +100                                            
352100        EXEC SQL                                                          
352200            FETCH CONT-SPLIT-CSR                                          
352300            INTO                                                          
352400             :DS010-RUL-ID                                                
352500        END-EXEC                                                          
352600                                                                          
352700        EVALUATE TRUE                                                     
352800            WHEN SQLCODE = ZERO OR -305                                   
352900               CONTINUE                                                   
353000            WHEN SQLCODE = +100                                           
353100                 SET DS010-END-RUL-DRIVER-YES TO TRUE                     
353200            WHEN SQLCODE = -904                                           
353300            WHEN SQLCODE = -913                                           
353400              CONTINUE                                                    
353500           END-EVALUATE                                                   
353600         END-PERFORM.                                                     
353700                                                                          
353800     PERFORM DS002-SQL-ABEND-FETCH.                                       
353900                                                                          
354000 R900C3-CLOSE-CONT-DRIVER.                                                
354100                                                                          
354200     EXEC SQL                                                             
354300         CLOSE CONT-SPLIT-CSR                                             
354400     END-EXEC                                                             
354500                                                                          
354600     EVALUATE TRUE                                                        
354700         WHEN SQLCODE = ZERO                                              
354800         WHEN SQLCODE = -904                                              
354900         WHEN SQLCODE = -913                                              
355000             CONTINUE                                                     
355100     END-EVALUATE                                                         
355200                                                                          
355300     PERFORM DS002-SQL-ABEND-CLOSE-CSR.                                   
355400/                                                                         
355500 R900P1-OPEN-PO-DRIVER.                                                   
355600     PERFORM WITH TEST AFTER                                              
355700             VARYING DS009-RETRY-COUNTER FROM 1 BY 1                      
355800             UNTIL   DS009-RETRY-COUNTER > 3 OR                           
355900                     SQLCODE = ZERO                                       
356000         EXEC SQL                                                         
356100             OPEN PO-SPLIT-CSR                                            
356200         END-EXEC                                                         
356300                                                                          
356400         EVALUATE TRUE                                                    
356500             WHEN SQLCODE = ZERO                                          
356600             WHEN SQLCODE = -904                                          
356700             WHEN SQLCODE = -913                                          
356800                 CONTINUE                                                 
356900         END-EVALUATE                                                     
357000     END-PERFORM.                                                         
357100                                                                          
357200     PERFORM DS002-SQL-ABEND-OPEN-CSR.                                    
357300                                                                          
357400 R900P2-FETCH-PO-DRIVER.                                                  
357500                                                                          
357600     INITIALIZE DS010-RUL-ID                                              
357700                                                                          
357800     PERFORM WITH TEST AFTER                                              
357900        VARYING DS009-RETRY-COUNTER FROM 1 BY 1                           
358000        UNTIL   DS009-RETRY-COUNTER > 3 OR                                
358100                SQLCODE = ZERO OR                                         
358200                SQLCODE = +100                                            
358300        EXEC SQL                                                          
358400            FETCH PO-SPLIT-CSR                                            
358500            INTO                                                          
358600             :DS010-RUL-ID                                                
358700        END-EXEC                                                          
358800                                                                          
358900        EVALUATE TRUE                                                     
359000            WHEN SQLCODE = ZERO OR -305                                   
359100               CONTINUE                                                   
359200            WHEN SQLCODE = +100                                           
359300                 SET DS010-END-PO-RUL-DRIVER-YES TO TRUE                  
359400            WHEN SQLCODE = -904                                           
359500            WHEN SQLCODE = -913                                           
359600              CONTINUE                                                    
359700           END-EVALUATE                                                   
359800         END-PERFORM.                                                     
359900                                                                          
360000     PERFORM DS002-SQL-ABEND-FETCH.                                       
360100                                                                          
360200 R900P3-CLOSE-PO-DRIVER.                                                  
360300                                                                          
360400     EXEC SQL                                                             
360500         CLOSE PO-SPLIT-CSR                                               
360600     END-EXEC                                                             
360700                                                                          
360800     EVALUATE TRUE                                                        
360900         WHEN SQLCODE = ZERO                                              
361000         WHEN SQLCODE = -904                                              
361100         WHEN SQLCODE = -913                                              
361200             CONTINUE                                                     
361300     END-EVALUATE                                                         
361400                                                                          
361500     PERFORM DS002-SQL-ABEND-CLOSE-CSR.                                   
361600/                                                                         
361700 R901-FETCH-TRT00015.                                                     
361800                                                                          
361900     PERFORM WITH TEST AFTER                                              
362000         VARYING DS009-RETRY-COUNTER FROM 1 BY 1                          
362100         UNTIL   DS009-RETRY-COUNTER > 3 OR                               
362200                 SQLCODE = ZERO OR                                        
362300                 SQLCODE = +100                                           
362400                                                                          
362500                 EXEC SQL                                                 
362600                     FETCH RULE-CNSTR-CSR                                 
362700                INTO                                                      
362800                    :TRT00015-RUL-ID                                      
362900                  , :TRT00015-RUL-CNSTR-CDE                               
363000                  , :TRT00015-RUL-CNSTR-TYP-CDE                           
363100                  , :TRT00015-RUL-CNSTR-VAL-TXT                           
363200                  , :TRT00015-CRE-TMST                                    
363300                  , :TRT00015-CRE-BY-USR-ID                               
363400             END-EXEC                                                     
363500                                                                          
363600        EVALUATE TRUE                                                     
363700            WHEN SQLCODE = ZERO OR -305                                   
363800                                                                          
363900*    YOU HAVE A RULE CONSTRAINT ROW HERE                                  
                   DISPLAY  'TRT_RUL_CNSTR'                                     
                                                                                
362800                     TRT00015-RUL-ID ' / '                                
362900                     TRT00015-RUL-CNSTR-CDE ' / '                         
363000                     TRT00015-RUL-CNSTR-TYP-CDE ' / '                     
363100                     TRT00015-RUL-CNSTR-VAL-TXT                           
364000                                                                          
364100         MOVE LENGTH OF DCLTRT00015   TO DS009-TBLE-DATA-SIZE             
364200         COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE                 
364300                                             + DS009-RECORD-FILLER        
364400         MOVE 04 TO DS002-ORDER                                           
364500         MOVE 01 TO DS002-VERSION                                         
364600         MOVE DS009-TBLE-DATA-SIZE TO DS002-DATA-SIZE                     
364700         MOVE 'TRT_RUL_CNSTR'  TO DS002-NAME                              
364800         MOVE DCLTRT00015      TO DS002-DATA-ITEM                         
364900         INITIALIZE DS009-PKYS                                            
365000         PERFORM DS002-PROCESS-KEYS                                       
365100         MOVE DS008-TRT00015-KEYS TO DS009-PKYS                           
365200         MOVE DS009-PKYS TO DS002-KEYS                                    
365300         MOVE TRT00015-RUL-ID TO PV-DISP-NBR-1                            
365400         MOVE TRT00015-RUL-CNSTR-CDE TO PV-DISP-NBR-2                     
365500         DISPLAY DS002-NAME ' '                                           
365600             PV-DISP-NBR-1   ' / '                                        
365700             PV-DISP-NBR-2  ' / '                                         
365800             TRT00015-RUL-CNSTR-TYP-CDE                                   
365900         PERFORM 8000-WRITE-UNLOAD                                        
366000         WHEN SQLCODE = +100                                              
366100             SET DS010-END-RULES-CNSTR-YES TO TRUE                        
366200         WHEN SQLCODE = -904                                              
366300         WHEN SQLCODE = -911                                              
366400         WHEN SQLCODE = -913                                              
366500             CONTINUE                                                     
366600         END-EVALUATE                                                     
366700     END-PERFORM.                                                         
366800/                                                                         
366900                                                                          
367000 R902-FETCH-RUL-MASTER.                                                   
367100     DISPLAY 'R902-FETCH-RUL-MASTER'                                      
367200     PERFORM WITH TEST AFTER                                              
367300        VARYING DS009-RETRY-COUNTER FROM 1 BY 1                           
367400        UNTIL   DS009-RETRY-COUNTER > 3 OR                                
367500                SQLCODE = ZERO OR                                         
367600                SQLCODE = +100                                            
367700        EXEC SQL                                                          
367800            FETCH RULE-CSR                                                
367900            INTO                                                          
368000             :TRT00014-RUL-ID                                             
368100           , :TRT00014-RUL-CDE                                            
368200           , :TRT00014-RUL-TYP-CDE                                        
368300           , :TRT00014-RUL-BEG-DTE                                        
368400           , :TRT00014-RUL-END-DTE                                        
368500           , :TRT00014-CRE-TMST                                           
368600           , :TRT00014-CRE-BY-USR-ID                                      
368700        END-EXEC                                                          
368800                                                                          
368900        EVALUATE TRUE                                                     
369000            WHEN SQLCODE = ZERO OR -305                                   
369100                                                                          
369200               MOVE LENGTH OF DCLTRT00014                                 
369300                                      TO DS009-TBLE-DATA-SIZE             
369400               COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE           
369500                                         + DS009-RECORD-FILLER            
369600               MOVE 04     TO DS002-ORDER                                 
369700               MOVE 00     TO DS002-VERSION                               
369800               MOVE DS009-TBLE-DATA-SIZE TO DS002-DATA-SIZE               
369900               MOVE 'TRT_RUL'            TO DS002-NAME                    
370000               MOVE DCLTRT00014          TO DS002-DATA-ITEM               
370100               INITIALIZE DS009-PKYS                                      
370200               PERFORM DS002-PROCESS-KEYS                                 
370300               MOVE DS008-TRT00014-KEYS TO DS009-PKYS                     
370400               MOVE DS009-PKYS TO DS002-KEYS                              
370500               PERFORM 8000-WRITE-UNLOAD                                  
370600               DISPLAY DS002-NAME                                         
370700                                                                          
370800            WHEN SQLCODE = +100                                           
370900                 SET DS010-END-RULES-YES  TO TRUE                         
371000            WHEN SQLCODE = -904                                           
371100            WHEN SQLCODE = -913                                           
371200              CONTINUE                                                    
371300           END-EVALUATE                                                   
371400         END-PERFORM.                                                     
371500                                                                          
371600     PERFORM DS002-SQL-ABEND-FETCH.                                       
371700/                                                                         
371800 R903-FETCH-TRT00018.                                                     
371900     DISPLAY 'R903-FETCH-TRT00018'                                        
372000     PERFORM WITH TEST AFTER                                              
372100        VARYING DS009-RETRY-COUNTER FROM 1 BY 1                           
372200        UNTIL   DS009-RETRY-COUNTER > 3 OR                                
372300                SQLCODE = ZERO OR                                         
372400                SQLCODE = +100                                            
372500        EXEC SQL                                                          
372600            FETCH TRT00018-CSR                                            
372700            INTO                                                          
372800              :TRT00018-RUL-ID                                            
372900           ,  :TRT00018-RUL-CNSTR-CDE                                     
373000           ,  :TRT00018-RUL-CNSTR-TYP-CDE                                 
373100           ,  :TRT00018-RUL-CNSTR-VAL-TXT                                 
373200           ,  :TRT00018-CRE-TMST                                          
373300           ,  :TRT00018-CRE-BY-USR-ID                                     
373400           ,  :TRT00018-AUD-CRE-USR-ID                                    
373500           ,  :TRT00018-AUD-FUNC-CDE                                      
373600           ,  :TRT00018-AUD-CRE-TMST                                      
373700        END-EXEC                                                          
373800                                                                          
373900        EVALUATE TRUE                                                     
374000            WHEN SQLCODE = ZERO OR -305                                   
374100                                                                          
374200               MOVE LENGTH OF DCLTRT00018                                 
374300                                      TO DS009-TBLE-DATA-SIZE             
374400               COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE           
374500                                         + DS009-RECORD-FILLER            
374600               MOVE 04     TO DS002-ORDER                                 
374700               MOVE 02     TO DS002-VERSION                               
374800               MOVE DS009-TBLE-DATA-SIZE TO DS002-DATA-SIZE               
374900               MOVE 'TRT_AUD_RUL_CNSTR'  TO DS002-NAME                    
375000               MOVE DCLTRT00018          TO DS002-DATA-ITEM               
375100               INITIALIZE DS009-PKYS                                      
375200               PERFORM DS002-PROCESS-KEYS                                 
375300               MOVE DS008-TRT00018-KEY  TO DS009-PKYS                     
375400               MOVE DS009-PKYS TO DS002-KEYS                              
375500               PERFORM 8000-WRITE-UNLOAD                                  
375600               DISPLAY DS002-NAME                                         
375700                                                                          
375800            WHEN SQLCODE = +100                                           
375900                 SET DS010-END-TRT00018-YES  TO TRUE                      
376000            WHEN SQLCODE = -904                                           
376100            WHEN SQLCODE = -913                                           
376200              CONTINUE                                                    
376300           END-EVALUATE                                                   
376400         END-PERFORM.                                                     
376500                                                                          
376600     PERFORM DS002-SQL-ABEND-FETCH.                                       
376700/                                                                         
376800 R904-FETCH-TRT00017.                                                     
376900     DISPLAY 'R904-FETCH-TRT00017'                                        
377000     PERFORM WITH TEST AFTER                                              
377100        VARYING DS009-RETRY-COUNTER FROM 1 BY 1                           
377200        UNTIL   DS009-RETRY-COUNTER > 3 OR                                
377300                SQLCODE = ZERO OR                                         
377400                SQLCODE = +100                                            
377500        EXEC SQL                                                          
377600            FETCH TRT00017-CSR                                            
377700            INTO                                                          
377800              :TRT00017-RUL-ID                                            
377900            , :TRT00017-RUL-CDE                                           
378000            , :TRT00017-RUL-TYP-CDE                                       
378100            , :TRT00017-RUL-BEG-DTE                                       
378200            , :TRT00017-RUL-END-DTE                                       
378300            , :TRT00017-CRE-TMST                                          
378400            , :TRT00017-CRE-BY-USR-ID                                     
378500            , :TRT00017-AUD-CRE-USR-ID                                    
378600            , :TRT00017-AUD-FUNC-CDE                                      
378700            , :TRT00017-AUD-CRE-TMST                                      
378800        END-EXEC                                                          
378900                                                                          
379000        DISPLAY 'SQLCODE= ' SQLCODE                                       
379100        EVALUATE TRUE                                                     
379200            WHEN SQLCODE = ZERO OR -305                                   
379300                                                                          
379400               MOVE LENGTH OF DCLTRT00017                                 
379500                                      TO DS009-TBLE-DATA-SIZE             
379600               COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE           
379700                                         + DS009-RECORD-FILLER            
379800               MOVE 04     TO DS002-ORDER                                 
379900               MOVE 03     TO DS002-VERSION                               
380000               MOVE DS009-TBLE-DATA-SIZE TO DS002-DATA-SIZE               
380100               MOVE 'TRT_AUD_RUL'        TO DS002-NAME                    
380200               MOVE DCLTRT00017          TO DS002-DATA-ITEM               
380300               INITIALIZE DS009-PKYS                                      
380400               PERFORM DS002-PROCESS-KEYS                                 
380500               MOVE DS008-TRT00017-KEY  TO DS009-PKYS                     
380600               MOVE DS009-PKYS TO DS002-KEYS                              
380700               PERFORM 8000-WRITE-UNLOAD                                  
380800               DISPLAY DS002-NAME                                         
380900                                                                          
381000            WHEN SQLCODE = +100                                           
381100                 SET DS010-END-TRT00017-YES  TO TRUE                      
381200            WHEN SQLCODE = -904                                           
381300            WHEN SQLCODE = -913                                           
381400              CONTINUE                                                    
381500           END-EVALUATE                                                   
381600         END-PERFORM.                                                     
381700                                                                          
381800     PERFORM DS002-SQL-ABEND-FETCH.                                       
381900/                                                                         
382000*****************************************************************         
382100*****************************************************************         
382200*                                                                         
382300 Y100-OPEN-CURSOR.                                                        
382400     PERFORM WITH TEST AFTER                                              
382500             VARYING DS009-RETRY-COUNTER FROM 1 BY 1                      
382600             UNTIL   DS009-RETRY-COUNTER > 3 OR                           
382700                     SQLCODE = ZERO                                       
382800                                                                          
382900             EVALUATE TRUE                                                
383000             WHEN DS009-PROCESS-TABLE = 'TIMBKPO'                         
383100               EXEC SQL                                                   
383200                  OPEN IMBKPO_CSR                                         
383300               END-EXEC                                                   
383400*            WHEN DS009-PROCESS-TABLE = 'TIMBKUP'                         
383500*              EXEC SQL                                                   
383600*                 OPEN IMBKUP_CSR                                         
383700*              END-EXEC                                                   
383800*            WHEN DS009-PROCESS-TABLE = 'TIMBKVS'                         
383900*              EXEC SQL                                                   
384000*                 OPEN IMBKVS_CSR                                         
384100*              END-EXEC                                                   
384200             WHEN DS009-PROCESS-TABLE = 'TIMRCPO'                         
384300               EXEC SQL                                                   
384400                  OPEN IMRCPO_CSR                                         
384500               END-EXEC                                                   
384600*            WHEN DS009-PROCESS-TABLE = 'TIMRCUP'                         
384700*              EXEC SQL                                                   
384800*                 OPEN IMRCUP_CSR                                         
384900*              END-EXEC                                                   
385000*            WHEN DS009-PROCESS-TABLE = 'TIMRCVS'                         
385100*              EXEC SQL                                                   
385200*                 OPEN IMRCVS_CSR                                         
385300*              END-EXEC                                                   
385400             WHEN DS009-PROCESS-TABLE = 'TIMCNTK'                         
385500               EXEC SQL                                                   
385600                  OPEN IMCNTK-CSR                                         
385700               END-EXEC                                                   
385800             WHEN DS009-PROCESS-TABLE = 'TIMCNPO'                         
385900               EXEC SQL                                                   
386000                  OPEN IMCNPO-CSR                                         
386100               END-EXEC                                                   
386200             WHEN DS009-PROCESS-TABLE = 'TIMCNRL'                         
386300               EXEC SQL                                                   
386400                  OPEN TIMCNRL-CSR                                        
386500               END-EXEC                                                   
386600             WHEN DS009-PROCESS-TABLE = 'TIMCNUP'                         
386700               EXEC SQL                                                   
386800                  OPEN IMCNUP-CSR                                         
386900               END-EXEC                                                   
387000             WHEN DS009-PROCESS-TABLE = 'TRT_IMPRT_CART'                  
387100               EXEC SQL                                                   
387200                  OPEN TRT00008-CART-CSR                                  
387300               END-EXEC                                                   
387400             WHEN DS009-PROCESS-TABLE = 'TRT_IMPRT_SEAL'                  
387500               EXEC SQL                                                   
387600                  OPEN TRT00006_SEAL_CSR                                  
387700               END-EXEC                                                   
387800             WHEN DS009-PROCESS-TABLE = 'TRT_AUD_IMPRT_CART'              
387900               EXEC SQL                                                   
388000                  OPEN AUD_CART_CSR                                       
388100               END-EXEC                                                   
388200             WHEN DS009-PROCESS-TABLE = 'TRT_AUD_IMPRT_SEAL'              
388300               EXEC SQL                                                   
388400                  OPEN AUD_SEAL_CSR                                       
388500               END-EXEC                                                   
388600             WHEN DS009-PROCESS-TABLE = 'TIMCSEN'                         
388700               EXEC SQL                                                   
388800                  OPEN  IMCSEN_CSR                                        
388900               END-EXEC                                                   
389000             WHEN DS009-PROCESS-TABLE = 'TIMCSBL'                         
389100               EXEC SQL                                                   
389200                  OPEN  IMCSBL_CSR                                        
389300               END-EXEC                                                   
389400             WHEN DS009-PROCESS-TABLE = 'TIMCSCN'                         
389500               EXEC SQL                                                   
389600                  OPEN  IMCSCN_CSR                                        
389700               END-EXEC                                                   
389800             WHEN DS009-PROCESS-TABLE = 'TIMCSPO'                         
389900               EXEC SQL                                                   
390000                  OPEN  IMCSPO_CSR                                        
390100               END-EXEC                                                   
390200             WHEN DS009-PROCESS-TABLE = 'TAUCSEN'                         
390300               EXEC SQL                                                   
390400                  OPEN  AUCSEN_CSR                                        
390500               END-EXEC                                                   
390600             WHEN DS009-PROCESS-TABLE = 'TAUCSBL'                         
390700               EXEC SQL                                                   
390800                  OPEN  AUCSBL_CSR                                        
390900               END-EXEC                                                   
391000             WHEN DS009-PROCESS-TABLE = 'TAUCSCN'                         
391100               EXEC SQL                                                   
391200                  OPEN  AUCSCN_CSR                                        
391300               END-EXEC                                                   
391400             WHEN DS009-PROCESS-TABLE = 'TAUCSPO'                         
391500               EXEC SQL                                                   
391600                  OPEN  AUCSPO_CSR                                        
391700               END-EXEC                                                   
391800             WHEN DS009-PROCESS-TABLE = 'TAURCPO'                         
391900               EXEC SQL                                                   
392000                  OPEN  AURCPO_CSR                                        
392100               END-EXEC                                                   
392200*            WHEN DS009-PROCESS-TABLE = 'TAURCVS'                         
392300*              EXEC SQL                                                   
392400*                 OPEN  AURCVS_CSR                                        
392500*              END-EXEC                                                   
392600*            WHEN DS009-PROCESS-TABLE = 'TAURCUP'                         
392700*              EXEC SQL                                                   
392800*                 OPEN  AURCUP_CSR                                        
392900*              END-EXEC                                                   
393000             WHEN DS009-PROCESS-TABLE = 'TAUBKPO'                         
393100               EXEC SQL                                                   
393200                  OPEN  AUBKPO_CSR                                        
393300               END-EXEC                                                   
393400*            WHEN DS009-PROCESS-TABLE = 'TAUBKVS'                         
393500*              EXEC SQL                                                   
393600*                 OPEN  AUBKVS_CSR                                        
393700*              END-EXEC                                                   
393800*            WHEN DS009-PROCESS-TABLE = 'TAUBKUP'                         
393900*              EXEC SQL                                                   
394000*                 OPEN  AUBKUP_CSR                                        
394100*              END-EXEC                                                   
394200             WHEN DS009-PROCESS-TABLE = 'TAUCNPO'                         
394300               EXEC SQL                                                   
394400                  OPEN  AUCNPO_CSR                                        
394500               END-EXEC                                                   
394600             WHEN DS009-PROCESS-TABLE = 'TAUCNUP'                         
394700               EXEC SQL                                                   
394800                  OPEN  AUCNUP_CSR                                        
394900               END-EXEC                                                   
395000             WHEN DS009-PROCESS-TABLE = 'TAUCNTK'                         
395100               EXEC SQL                                                   
395200                  OPEN  AUCNTK_CSR                                        
395300               END-EXEC                                                   
395400             WHEN DS009-PROCESS-TABLE = 'TELCPO'                          
395500               EXEC SQL                                                   
395600                  OPEN  ELCPO_CSR                                         
395700               END-EXEC                                                   
395800             WHEN DS009-PROCESS-TABLE = 'TELCVS'                          
395900               EXEC SQL                                                   
396000                  OPEN  ELCVS_CSR                                         
396100               END-EXEC                                                   
396200             WHEN DS009-PROCESS-TABLE = 'TVSCPT'                          
396300               EXEC SQL                                                   
396400                  OPEN  VSCPT_CSR                                         
396500               END-EXEC                                                   
396600             WHEN DS009-PROCESS-TABLE = 'TAUCNRL'                         
396700               EXEC SQL                                                   
396800                  OPEN  AUCNRL-CSR                                        
396900               END-EXEC                                                   
397000                                                                          
397100             WHEN DS009-PROCESS-TABLE = 'TRT_RUL'                         
397200               EXEC SQL                                                   
397300                  OPEN  RULE-CSR                                          
397400               END-EXEC                                                   
397500                                                                          
397600             WHEN DS009-PROCESS-TABLE = 'TRT_RUL_CNSTR'                   
397700*                IF PS-PO-SPLIT-YES                                       
397800                                                                          
397900                   EXEC SQL                                               
398000                      OPEN  RULE-CNSTR-CSR                                
398100                   END-EXEC                                               
398200                                                                          
398300*                ELSE                                                     
398400*                  EXEC SQL                                               
398500*                     OPEN  RULE-CNSTR-CNT-CSR                            
398600*                  END-EXEC                                               
398700*                END-IF                                                   
398800                                                                          
398900             WHEN DS009-PROCESS-TABLE = 'TRT_AUD_RUL_CNSTR'               
399000               EXEC SQL                                                   
399100                  OPEN  TRT00018-CSR                                      
399200               END-EXEC                                                   
399300                                                                          
399400             WHEN DS009-PROCESS-TABLE = 'TRT_AUD_RUL'                     
399500               EXEC SQL                                                   
399600                  OPEN TRT00017-CSR                                       
399700               END-EXEC                                                   
399800                                                                          
399400*            WHEN DS009-PROCESS-TABLE = 'RPLNT_INBND_PO'                  
399500*              EXEC SQL                                                   
399600*                 OPEN TRT00057-CSR                                       
399700*              END-EXEC                                                   
399800                                                                          
399400*            WHEN DS009-PROCESS-TABLE =                                   
399400*                                    'RPLNT_INBND_CART'                   
399500*              EXEC SQL                                                   
399600*                 OPEN TRT00058-CSR                                       
399700*              END-EXEC                                                   
399800                                                                          
399400*            WHEN DS009-PROCESS-TABLE =                                   
399400*                                    'RPLNT_INBND_PO_AUD'                 
399500*              EXEC SQL                                                   
399600*                 OPEN TRT00060-CSR                                       
399700*              END-EXEC                                                   
399800                                                                          
399400*            WHEN DS009-PROCESS-TABLE =                                   
399400*                                 'RPLNT_INBND_CART_A'                    
399500*              EXEC SQL                                                   
399600*                 OPEN TRT00061-CSR                                       
399700*              END-EXEC                                                   
399800                                                                          
399900             END-EVALUATE                                                 
400000                                                                          
400100             EVALUATE TRUE                                                
400200               WHEN SQLCODE = ZERO                                        
400300               WHEN SQLCODE = -904                                        
400400               WHEN SQLCODE = -913                                        
400500                  CONTINUE                                                
400600             END-EVALUATE                                                 
400700         END-PERFORM.                                                     
400800*****************************************************************         
400900     PERFORM DS002-SQL-ABEND-OPEN-CSR.                                    
401000*****************************************************************         
401100/                                                                         
401200*****************************************************************         
401300*  CLOSE CURSOR                                                           
401400*****************************************************************         
401500*                                                                         
401600 Y100-CLOSE-CURSOR.                                                       
401700     PERFORM WITH TEST AFTER                                              
401800             VARYING DS009-RETRY-COUNTER FROM 1 BY 1                      
401900             UNTIL   DS009-RETRY-COUNTER > 3 OR                           
402000                     SQLCODE = ZERO                                       
402100                                                                          
402200             EVALUATE TRUE                                                
402300             WHEN DS009-PROCESS-TABLE = 'TIMBKPO'                         
402400               EXEC SQL                                                   
402500                 CLOSE IMBKPO_CSR                                         
402600               END-EXEC                                                   
402700*            WHEN DS009-PROCESS-TABLE = 'TIMBKUP'                         
402800*              EXEC SQL                                                   
402900*                 CLOSE IMBKUP_CSR                                        
403000*              END-EXEC                                                   
403100*            WHEN DS009-PROCESS-TABLE = 'TIMBKVS'                         
403200*              EXEC SQL                                                   
403300*                 CLOSE IMBKVS_CSR                                        
403400*              END-EXEC                                                   
403500             WHEN DS009-PROCESS-TABLE = 'TIMRCPO'                         
403600               EXEC SQL                                                   
403700                  CLOSE IMRCPO_CSR                                        
403800               END-EXEC                                                   
403900*            WHEN DS009-PROCESS-TABLE = 'TIMRCUP'                         
404000*              EXEC SQL                                                   
404100*                 CLOSE IMRCUP_CSR                                        
404200*              END-EXEC                                                   
404300*            WHEN DS009-PROCESS-TABLE = 'TIMRCVS'                         
404400*              EXEC SQL                                                   
404500*                 CLOSE IMRCVS_CSR                                        
404600*              END-EXEC                                                   
404700             WHEN DS009-PROCESS-TABLE = 'TIMCNTK'                         
404800               EXEC SQL                                                   
404900                  CLOSE IMCNTK-CSR                                        
405000               END-EXEC                                                   
405100             WHEN DS009-PROCESS-TABLE = 'TIMCNPO'                         
405200               EXEC SQL                                                   
405300                  CLOSE IMCNPO-CSR                                        
405400               END-EXEC                                                   
405500             WHEN DS009-PROCESS-TABLE = 'TIMCNRL'                         
405600               EXEC SQL                                                   
405700                  CLOSE TIMCNRL-CSR                                       
405800               END-EXEC                                                   
405900             WHEN DS009-PROCESS-TABLE = 'TIMCNUP'                         
406000               EXEC SQL                                                   
406100                  CLOSE IMCNUP-CSR                                        
406200               END-EXEC                                                   
406300             WHEN DS009-PROCESS-TABLE = 'TRT_IMPRT_CART'                  
406400               EXEC SQL                                                   
406500                  CLOSE TRT00008-CART-CSR                                 
406600               END-EXEC                                                   
406700             WHEN DS009-PROCESS-TABLE = 'TRT_IMPRT_SEAL'                  
406800               EXEC SQL                                                   
406900                  CLOSE TRT00006_SEAL_CSR                                 
407000               END-EXEC                                                   
407100             WHEN DS009-PROCESS-TABLE = 'TRT_AUD_IMPRT_CART'              
407200               EXEC SQL                                                   
407300                  CLOSE AUD_CART_CSR                                      
407400               END-EXEC                                                   
407500             WHEN DS009-PROCESS-TABLE = 'TRT_AUD_IMPRT_SEAL'              
407600               EXEC SQL                                                   
407700                  CLOSE AUD_SEAL_CSR                                      
407800               END-EXEC                                                   
407900             WHEN DS009-PROCESS-TABLE = 'TIMCSEN'                         
408000               EXEC SQL                                                   
408100                  CLOSE IMCSEN_CSR                                        
408200               END-EXEC                                                   
408300             WHEN DS009-PROCESS-TABLE = 'TIMCSBL'                         
408400               EXEC SQL                                                   
408500                  CLOSE IMCSBL_CSR                                        
408600               END-EXEC                                                   
408700             WHEN DS009-PROCESS-TABLE = 'TIMCSCN'                         
408800               EXEC SQL                                                   
408900                  CLOSE IMCSCN_CSR                                        
409000               END-EXEC                                                   
409100             WHEN DS009-PROCESS-TABLE = 'TIMCSPO'                         
409200               EXEC SQL                                                   
409300                  CLOSE IMCSPO_CSR                                        
409400               END-EXEC                                                   
409500             WHEN DS009-PROCESS-TABLE = 'TAUCSEN'                         
409600               EXEC SQL                                                   
409700                  CLOSE AUCSEN_CSR                                        
409800               END-EXEC                                                   
409900             WHEN DS009-PROCESS-TABLE = 'TAUCSBL'                         
410000               EXEC SQL                                                   
410100                  CLOSE AUCSBL_CSR                                        
410200               END-EXEC                                                   
410300             WHEN DS009-PROCESS-TABLE = 'TAUCSCN'                         
410400               EXEC SQL                                                   
410500                  CLOSE AUCSCN_CSR                                        
410600               END-EXEC                                                   
410700             WHEN DS009-PROCESS-TABLE = 'TAUCSPO'                         
410800               EXEC SQL                                                   
410900                  CLOSE AUCSPO_CSR                                        
411000               END-EXEC                                                   
411100             WHEN DS009-PROCESS-TABLE = 'TAURCPO'                         
411200               EXEC SQL                                                   
411300                  CLOSE AURCPO_CSR                                        
411400               END-EXEC                                                   
411500*            WHEN DS009-PROCESS-TABLE = 'TAURCVS'                         
411600*              EXEC SQL                                                   
411700*                 CLOSE AURCVS_CSR                                        
411800*              END-EXEC                                                   
411900*            WHEN DS009-PROCESS-TABLE = 'TAURCUP'                         
412000*              EXEC SQL                                                   
412100*                 CLOSE AURCUP_CSR                                        
412200*              END-EXEC                                                   
412300             WHEN DS009-PROCESS-TABLE = 'TAUBKPO'                         
412400               EXEC SQL                                                   
412500                  CLOSE AUBKPO_CSR                                        
412600               END-EXEC                                                   
412700*            WHEN DS009-PROCESS-TABLE = 'TAUBKVS'                         
412800*              EXEC SQL                                                   
412900*                 CLOSE AUBKVS_CSR                                        
413000*              END-EXEC                                                   
413100*            WHEN DS009-PROCESS-TABLE = 'TAUBKUP'                         
413200*              EXEC SQL                                                   
413300*                 CLOSE AUBKUP_CSR                                        
413400*              END-EXEC                                                   
413500             WHEN DS009-PROCESS-TABLE = 'TAUCNPO'                         
413600               EXEC SQL                                                   
413700                  CLOSE AUCNPO_CSR                                        
413800               END-EXEC                                                   
413900             WHEN DS009-PROCESS-TABLE = 'TAUCNUP'                         
414000               EXEC SQL                                                   
414100                  CLOSE AUCNUP_CSR                                        
414200               END-EXEC                                                   
414300             WHEN DS009-PROCESS-TABLE = 'TAUCNTK'                         
414400               EXEC SQL                                                   
414500                  CLOSE AUCNTK_CSR                                        
414600               END-EXEC                                                   
414700             WHEN DS009-PROCESS-TABLE = 'TELCPO'                          
414800               EXEC SQL                                                   
414900                  CLOSE ELCPO_CSR                                         
415000               END-EXEC                                                   
415100             WHEN DS009-PROCESS-TABLE = 'TELCVS'                          
415200               EXEC SQL                                                   
415300                  CLOSE ELCVS_CSR                                         
415400               END-EXEC                                                   
415500             WHEN DS009-PROCESS-TABLE = 'TVSCPT'                          
415600               EXEC SQL                                                   
415700                  CLOSE VSCPT_CSR                                         
415800               END-EXEC                                                   
415900             WHEN DS009-PROCESS-TABLE = 'TAUCNRL'                         
416000               EXEC SQL                                                   
416100                  CLOSE AUCNRL-CSR                                        
416200               END-EXEC                                                   
416300                                                                          
416400             WHEN DS009-PROCESS-TABLE = 'TRT_RUL'                         
416500               EXEC SQL                                                   
416600                  CLOSE RULE-CSR                                          
416700               END-EXEC                                                   
416800             WHEN DS009-PROCESS-TABLE = 'TRT_RUL_CNSTR'                   
416900*                IF PS-PO-SPLIT-YES                                       
417000                                                                          
417100                   EXEC SQL                                               
417200                      CLOSE  RULE-CNSTR-CSR                               
417300                   END-EXEC                                               
417400                                                                          
417500*                ELSE                                                     
417600*                  EXEC SQL                                               
417700*                    CLOSE  RULE-CNSTR-CNT-CSR                            
417800*                  END-EXEC                                               
417900*                END-IF                                                   
418000                                                                          
418100             WHEN DS009-PROCESS-TABLE = 'TRT_AUD_RUL_CNSTR'               
418200               EXEC SQL                                                   
418300                  CLOSE TRT00018-CSR                                      
418400               END-EXEC                                                   
418500             WHEN DS009-PROCESS-TABLE = 'TRT_AUD_RUL'                     
418600               EXEC SQL                                                   
418700                  CLOSE TRT00017-CSR                                      
418800               END-EXEC                                                   
418500*            WHEN DS009-PROCESS-TABLE = 'RPLNT_INBND_PO'                  
418600*              EXEC SQL                                                   
418700*                 CLOSE TRT00057-CSR                                      
418800*              END-EXEC                                                   
418500*            WHEN DS009-PROCESS-TABLE =                                   
418500*                                     'RPLNT_INBND_CART'                  
418600*              EXEC SQL                                                   
418700*                 CLOSE TRT00058-CSR                                      
418800*              END-EXEC                                                   
418500*            WHEN DS009-PROCESS-TABLE =                                   
418500*                                    'RPLNT_INBND_PO_AUD'                 
418600*              EXEC SQL                                                   
418700*                 CLOSE TRT00060-CSR                                      
418800*              END-EXEC                                                   
418500*            WHEN DS009-PROCESS-TABLE =                                   
418500*                                 'RPLNT_INBND_CART_A'                    
418600*              EXEC SQL                                                   
418700*                 CLOSE TRT00061-CSR                                      
418800*              END-EXEC                                                   
418900                                                                          
419000             END-EVALUATE                                                 
419100                                                                          
419200             EVALUATE TRUE                                                
419300               WHEN SQLCODE = ZERO                                        
419400               WHEN SQLCODE = -904                                        
419500               WHEN SQLCODE = -913                                        
419600                  CONTINUE                                                
419700             END-EVALUATE                                                 
419800         END-PERFORM.                                                     
419900/                                                                         
420000 8000-WRITE-UNLOAD.                                                       
420100                                                                          
420200     IF DS009-PROCESS-TABLE = 'TRT_AUD_RUL'                               
420300         DISPLAY '8000-WRITE-UNLOAD'                                      
420400         DISPLAY 'TABLE-NAME = ' DS002-NAME                               
420500     END-IF                                                               
420600                                                                          
420700     SET DS009-SRCH-IDX TO +1.                                            
420800     SEARCH DS009-CNTL-RECORDS                                            
420900             VARYING DS009-SRCH-IDX                                       
421000         AT END                                                           
421100             CONTINUE                                                     
421200         WHEN CNTL-TABLE (DS009-SRCH-IDX) = DS009-PROCESS-TABLE           
421300             ADD 1 TO DS009-READ-COUNT (DS009-SRCH-IDX)                   
421400     END-SEARCH.                                                          
421500                                                                          
421600     WRITE TBLE-RECORD FROM DS002-RECORD                                  
421700     ADD 1 TO PV-WRITE-COUNT.                                             
421800*****************************************************************         
421900*    PERFORM DS002-SQL-ABEND-CLOSE-CSR.                                   
422000*****************************************************************         
422100/                                                                         
422200*****************************************************************         
422300     COPY DSPD002.                                                        
422400*****************************************************************         
