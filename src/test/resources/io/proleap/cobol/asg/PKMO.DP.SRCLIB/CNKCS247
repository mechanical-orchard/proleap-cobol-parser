000100*-----------------------*                                         00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300*-----------------------*                                         00030000
000400 PROGRAM-ID.    CNKCS247.                                         00040000
000500 AUTHOR.        DENISE HAHN.                                      00050000
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060000
000700 DATE-WRITTEN.  NOVEMBER 2016.                                    00070000
000800 DATE-COMPILED.                                                   00080000
000900                                                                  00090000
000910*---------------------------------------------------------------* 00091000
000920*    Y247 - WST_ATTR_DEFN - LIST                                * 00092000
000930*---------------------------------------------------------------* 00093000
263455* CHANGED 11/03/2021    BY JIM HUNTER      WR: CHG0263455         00094034
263455* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00095034
263455* MAKING THE CALL DYNAMIC VS STATIC.                              00096034
263455*----------------------------------------------------------------*00097034
CICS  * CHANGED 10/25/2022    BY JIM HUNTER      WR: CHG0276961         00098035
CICS  * ADD COPYBOOK DPWS930 AND MAKE THE CICS ARCHITECTURE CALL        00099035
CICS  * DYNAMIC INSTEAD OF STATIC BY CALLING DP930-CICS-ARCH-API.       00100035
CICS  *-----------------------------------------------------------------00110035
001700                                                                  00170000
002408 EJECT                                                            00240800
002409 ENVIRONMENT DIVISION.                                            00240900
002410                                                                  00241000
002420 DATA DIVISION.                                                   00242000
002430                                                                  00243000
002440 WORKING-STORAGE SECTION.                                         00244000
002450*                                                                 00245000
002460 01  DK-DB2-KEYS.                                                 00246000
002461     05  DK-ATTR-DEFN              PIC  X(10)     VALUE SPACES.   00246101
004200                                                                  00420001
004300 01  PC-PROGRAM-CONSTANTS.                                        00430000
004400     05  PC-CURRENT-MAP-NAME       PIC  X(08)  VALUE 'CNK247  '.  00440005
004500     05  PC-CURRENT-MAPSET-NAME    PIC  X(08)  VALUE 'CNKM247 '.  00450003
004600     05  PC-CURRENT-PROGRAM-NAME   PIC  X(08)  VALUE 'CNKCS247'.  00460000
005100     05  PC-LIST-QUEUE-SEQ         PIC  9(01)  VALUE 1.           00510022
005200     05  PC-SEL-QUEUE-SEQ          PIC  9(01)  VALUE 2.           00520000
005300     05  PC-CRIT-SPEC-FORMAT       PIC  X(01)  VALUE '1'.         00530000
005400     05  PC-LIST-FORMAT            PIC  X(01)  VALUE '2'.         00540000
005500     05  PC-ITEMS-PER-PANEL        PIC S9(04)  VALUE +09          00550032
005600                                               COMP SYNC.         00560000
005700     05  PC-MAX-BLOCKS-IN-ARRAY    PIC S9(04)  VALUE +2           00570000
005800                                               COMP SYNC.         00580000
005900     05  PC-MAX-ITEMS              PIC S9(09)  VALUE +0900000     00590032
006000                                               COMP-3.            00600000
006100     05  PC-MSG-NUMBER-LENGTH      PIC S9(04)  VALUE +5           00610000
006200                                               COMP SYNC.         00620000
006300     05  PC-MAX-RETRIES            PIC S9(03)  VALUE 3            00630000
006400                                               COMP-3.            00640000
006500     05  PC-INQ                    PIC  X(03)  VALUE 'INQ'.       00650000
006600     05  PC-UPD                    PIC  X(03)  VALUE 'UPD'.       00660000
006700     05  PC-DEL                    PIC  X(03)  VALUE 'DEL'.       00670000
006800     05  PC-ERR                    PIC  X(03)  VALUE 'ERR'.       00680000
006900                                                                  00690000
007300*    05  PC-CA                     PIC  X(02)  VALUE 'CA'.        00730000
007400*    05  PC-DS                     PIC  X(02)  VALUE 'DS'.        00740000
007500*    05  PC-IP                     PIC  X(02)  VALUE 'IP'.        00750000
007600*    05  PC-NW                     PIC  X(02)  VALUE 'NW'.        00760000
007700*    05  PC-PD                     PIC  X(02)  VALUE 'PD'.        00770000
007800*    05  PC-AD                     PIC  X(02)  VALUE 'AD'.        00780000
007900*    05  PC-IN                     PIC  X(02)  VALUE 'IN'.        00790000
008000*    05  PC-MA                     PIC  X(02)  VALUE 'MA'.        00800000
008100*    05  PC-01                     PIC  X(02)  VALUE '01'.        00810000
008200*    05  PC-000                    PIC  X(03)  VALUE '000'.       00820000
008300*    05  PC-RDM                    PIC  X(03)  VALUE 'RDM'.       00830000
008400*    05  PC-AC                     PIC  X(02)  VALUE 'AC'.        00840000
008500*    05  PC-Y                      PIC  X(25)  VALUE              00850000
008600*                                    'Y                        '. 00860000
008700*    05  PC-0001                   PIC  9(04)  VALUE 0001.        00870000
008800*    05  PC-ALL                    PIC  X(04)  VALUE 'ALL '.      00880000
008900*                                                                 00890000
009000*    05  PC-RQSTD-REF             PIC  X(23)                      00900000
009100*                                 VALUE 'REQUESTED REF NBR.....:'.00910000
009200*    05  PC-RQSTD-REF-DEPT        PIC  X(23)                      00920000
009300*                                 VALUE 'REQUESTED DEPT/REF NBR:'.00930000
009400*    05  PC-RQSTD-DEPT            PIC  X(23)                      00940000
009500*                                 VALUE 'REQUESTED DEPT NBR....:'.00950000
012400*                                                                 01240000
012500*----------------------------------------------------------------*01250000
012600*  SYSTEM MESSAGES                                               *01260000
012700*----------------------------------------------------------------*01270000
012800*   00005 = INVALID VALUE                                        *01280000
012900*   00008 = MUST BE NUMERIC                                      *01290000
013000*   00050 - NO LIST ITEMS WERE FOUND FOR THE CRITERIA SPECIFIED  *01300000
013100*   00051 - NO END OF RANGE HAS BEEN SPECIFIED                   *01310000
013200*   00052 - END OF RANGE PRECEDES START OF RANGE                 *01320000
013300*   00053 - NO START OF RANGE HAS BEEN SPECIFIED                 *01330000
013400*   00054 - ONLY ONE START OF RANGE INDICATOR MAY BE SPECIFIED   *01340000
013500*   00055 - ONLY ONE END OF RANGE INDICATOR MAY BE SPECIFIED     *01350000
013600*   00057 - A LIST ITEM MUST BE SELECTED FOR THIS FUNCTION       *01360000
013700*   00069 - TOP OF LIST                                          *01370000
013800*   00070 - BOTTOM OF LIST                                       *01380000
013900*   00101 - VALUE MUST BE > ZERO AND  < 1,000,000                *01390000
014000*   00279 - MORE ITEMS TO DISPLAY                                *01400000
014100*----------------------------------------------------------------*01410000
014200     05  PC-TSYMSG-NUMBERS.                                       01420000
014300         10  PC-TSYMSG-00005            PIC  9(05)  VALUE 00005.  01430000
014400         10  PC-TSYMSG-00008            PIC  9(05)  VALUE 00008.  01440000
014500         10  PC-TSYMSG-00050            PIC  9(05)  VALUE 00050.  01450000
014600         10  PC-TSYMSG-00051            PIC  9(05)  VALUE 00051.  01460000
014700         10  PC-TSYMSG-00052            PIC  9(05)  VALUE 00052.  01470000
014800         10  PC-TSYMSG-00053            PIC  9(05)  VALUE 00053.  01480000
014900         10  PC-TSYMSG-00054            PIC  9(05)  VALUE 00054.  01490000
015000         10  PC-TSYMSG-00055            PIC  9(05)  VALUE 00055.  01500000
015100         10  PC-TSYMSG-00057            PIC  9(05)  VALUE 00057.  01510000
015200         10  PC-TSYMSG-00069            PIC  9(05)  VALUE 00069.  01520000
015300         10  PC-TSYMSG-00070            PIC  9(05)  VALUE 00070.  01530000
015400         10  PC-TSYMSG-00101            PIC  9(05)  VALUE 00101.  01540000
015500         10  PC-TSYMSG-00279            PIC  9(05)  VALUE 00279.  01550000
015600                                                                  01560000
024800*                                                                 02480000
024900 01  PS-PROGRAM-SWITCHES.                                         02490000
025000     05  PS-ERROR-SW                    PIC  X(01)  VALUE 'Y'.    02500000
025100         88  PS-NO-ERROR                            VALUE 'Y'.    02510000
025200         88  PS-ERROR                               VALUE 'N'.    02520000
025300     05  PS-BLOCK-ERROR-SW              PIC  X(01)  VALUE 'Y'.    02530000
025400         88  PS-NO-BLOCK-ERROR                      VALUE 'Y'.    02540000
025500         88  PS-BLOCK-ERROR                         VALUE 'N'.    02550000
026200     05  PS-COMMAREA-SW                 PIC  X(01)  VALUE 'N'.    02620000
026300         88  PS-COMMAREA-VALID                      VALUE 'Y'.    02630000
026400         88  PS-COMMAREA-NOT-VALID                  VALUE 'N'.    02640000
026410     05  PS-LIST-END-SW                 PIC  X(01)  VALUE  'N'.   02641000
026420         88  PS-LIST-END                            VALUE  'Y'.   02642000
026430         88  PS-NO-LIST-END                         VALUE  'N'.   02643000
026440     05  PS-SOFT-ABORT-ERROR-SW         PIC  X(01)  VALUE 'N'.    02644006
026450         88  PS-SOFT-ABORT-ERROR                    VALUE 'Y'.    02645006
026460         88  PS-NO-SOFT-ABORT-ERROR                 VALUE 'N'.    02646006
027700*                                                                 02770000
027800 01  PV-PROGRAM-VARIABLES.                                        02780000
027900     05  PV-CICS-RESPONSE               PIC S9(08)  VALUE ZEROES  02790000
028000                                        COMP SYNC.                02800000
028200     05  PV-SUB                         PIC S9(04)  VALUE +0      02820000
028300                                                    COMP SYNC.    02830000
028400     05  PV-REMAINDER                   PIC S9(04)  VALUE +0      02840000
028500                                                    COMP SYNC.    02850000
028600     05  PV-READ-COUNT                  PIC S9(09)  VALUE +0      02860000
028700                                                    COMP-3.       02870000
028800     05  PV-ITEMS-PROCESSED             PIC S9(09)  VALUE +0      02880000
028900                                                    COMP-3.       02890000
029000     05  PV-HOLD-SELECTED-ITEMS         PIC S9(09)  VALUE +0      02900000
029100                                                    COMP-3.       02910000
029200     05  PV-ITEM-IN-USE                 PIC S9(09)  VALUE +0      02920000
029300                                                    COMP-3.       02930000
029400     05  PV-TOP-ITEM                    PIC S9(09)  VALUE +0      02940000
029500                                                    COMP-3.       02950000
029600     05  PV-BOTTOM-ITEM                 PIC S9(09)  VALUE +0      02960000
029700                                                    COMP-3.       02970000
029800     05  PV-TEMP-BLOCK-NUMBER           PIC S9(09)  VALUE +0      02980000
029900                                                    COMP-3.       02990000
030000     05  PV-BLOCK-NUMBER                PIC S9(04)  VALUE +0      03000000
030100                                                    COMP SYNC.    03010000
030200     05  PV-CICS-RESP                   PIC S9(04)  VALUE +0      03020000
030300                                                    COMP SYNC.    03030000
030400     05  PV-ITEM                        PIC S9(04)  VALUE +0      03040000
030500                                                    COMP SYNC.    03050000
030600     05  PV-SEL-QUEUE-ITEM              PIC S9(04)  VALUE +0      03060000
030700                                                    COMP SYNC.    03070000
030800     05  PV-SAVE-ITEM                   PIC S9(04)  VALUE +0      03080000
030900                                                    COMP SYNC.    03090000
031000     05  PV-HIGHEST-BLOCK-WRITTEN       PIC S9(04)  VALUE +0      03100000
031100                                                    COMP SYNC.    03110000
031200     05  PV-LIST-ITEM-NUMBER            PIC S9(04)  VALUE +0      03120000
031300                                                    COMP SYNC.    03130000
031400     05  PV-FIRST-BLOCK-IN-ARRAY        PIC S9(04)  VALUE +0      03140000
031500                                                    COMP SYNC.    03150000
031600     05  PV-NEXT-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      03160000
031700                                                    COMP SYNC.    03170000
031800     05  PV-PREV-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      03180000
031900                                                    COMP SYNC.    03190000
032000     05  PV-FIRST-BLOCK-IN-RANGE        PIC S9(04)  VALUE +0      03200000
032100                                                    COMP SYNC.    03210000
032200     05  PV-LAST-BLOCK-IN-RANGE         PIC S9(04)  VALUE +0      03220000
032300                                                    COMP SYNC.    03230000
032400     05  PV-START-OF-SELECTED-RANGE     PIC S9(04)  VALUE +0      03240000
032500                                                    COMP SYNC.    03250000
032600     05  PV-END-OF-SELECTED-RANGE       PIC S9(04)  VALUE +0      03260000
032700                                                    COMP SYNC.    03270000
032701     05  PV-WST00010-ELEM-COUNT         PIC S9(09)  COMP.         03270101
032710*                                                                 03271000
032800*    05  PV-SQL-SUB                     PIC S9(04)  VALUE +0      03280000
032900*                                                   COMP SYNC.    03290000
033000     05  PV-RETRY-COUNTER               PIC S9(04)  VALUE +0      03300006
033100                                                    COMP SYNC.    03310006
033200*    05  PV-NULL-IND-1                  PIC S9(04)  VALUE +0      03320000
033300*                                                   COMP.         03330000
033400*    05  PV-NULL-IND-2                  PIC S9(04)  VALUE +0      03340000
033500*                                                   COMP.         03350000
033600*    05  PV-NULL-IND-3                  PIC S9(04)  VALUE +0      03360000
033700*                                                   COMP.         03370000
033800     05  PV-SOFT-ABORT-MSG.                                       03380000
033900         10  FILLER            PIC X(12) VALUE ' CNKCS247 - '.    03390000
034000         10  FILLER            PIC X(09) VALUE 'SQLCODE: '.       03400000
034100         10  PV-SOFT-SQLCODE   PIC ZZ9-.                          03410000
034200         10  FILLER            PIC X(12) VALUE ' PARAGRAPH: '.    03420000
034300         10  PV-SOFT-PARAGRAPH PIC X(30).                         03430000
034400     05  PV-COMMAREA-LENGTH              PIC S9(04)  VALUE +0     03440000
034500                                                     COMP SYNC.   03450000
034600     05  PV-CICS-MSG-AREA                PIC  X(80)  VALUE SPACE. 03460000
034700     05  PV-CICS-MSG-AREA2               PIC  X(100) VALUE SPACE. 03470000
034800     05  PV-CICS-MSG-HOLD.                                        03480000
034900         10  FILLER                      PIC  X(01)  VALUE SPACE. 03490000
035000         10  PV-CICS-MSG-DATA            PIC  X(79)  VALUE SPACE. 03500000
035100     05  PV-CICS-MSG-HOLD2.                                       03510000
035200         10  FILLER                      PIC  X(01)  VALUE SPACE. 03520000
035300         10  PV-CICS-MSG-DATA2           PIC  X(99)  VALUE SPACE. 03530000
035400                                                                  03540000
035500                                                                  03550000
035600*    05  PV-CREATE-TMST                 PIC X(26)   VALUE SPACES. 03560000
035700*    05  PV-CREATE-TMST-R REDEFINES  PV-CREATE-TMST.              03570000
035800*        10   PV-CREATE-CC              PIC X(02).                03580000
035900*        10   PV-CREATE-YY              PIC X(02).                03590000
036000*        10   FILLER                    PIC X(01).                03600000
036100*        10   PV-CREATE-MM              PIC X(02).                03610000
036200*        10   FILLER                    PIC X(01).                03620000
036300*        10   PV-CREATE-DD              PIC X(02).                03630000
036400*        10   FILLER                    PIC X(16).                03640000
036500*    05  PV-CREATE-MMDDYY.                                        03650000
036600*        10   PV-CREATE-EDIT-MM         PIC X(02)   VALUE SPACES. 03660000
036700*        10   PV-CREATE-SLASH-1         PIC X(01)   VALUE SPACES. 03670000
036800*        10   PV-CREATE-EDIT-DD         PIC X(02)   VALUE SPACES. 03680000
036900*        10   PV-CREATE-SLASH-2         PIC X(01)   VALUE SPACES. 03690000
037000*        10   PV-CREATE-EDIT-YY         PIC X(02)   VALUE SPACES. 03700000
037100*    05  PV-STATUS-MMDDYY.                                        03710000
037200*        10   PV-STATUS-EDIT-MM         PIC X(02)   VALUE SPACES. 03720000
037300*        10   PV-STATUS-SLASH-1         PIC X(01)   VALUE SPACES. 03730000
037400*        10   PV-STATUS-EDIT-DD         PIC X(02)   VALUE SPACES. 03740000
037500*        10   PV-STATUS-SLASH-2         PIC X(01)   VALUE SPACES. 03750000
037600*        10   PV-STATUS-EDIT-YY         PIC X(02)   VALUE SPACES. 03760000
037700*    05  PV-SELECT-FROM-DATE.                                     03770000
037800*        10   PV-SELECT-FROM-EDIT-MM    PIC X(02)   VALUE SPACES. 03780000
037900*        10   PV-SELECT-FROM-SLASH-1    PIC X(01)   VALUE SPACES. 03790000
038000*        10   PV-SELECT-FROM-EDIT-DD    PIC X(02)   VALUE SPACES. 03800000
038100*        10   PV-SELECT-FROM-SLASH-2    PIC X(01)   VALUE SPACES. 03810000
038200*        10   PV-SELECT-FROM-EDIT-YY    PIC X(04)   VALUE SPACES. 03820000
048600*                                                                 04860000
048700*    05  PV-PULL-NUMBER                  PIC  9(08) VALUE ZEROES. 04870000
048800*    05  PV-REF-NUMBER                   PIC  X(15) VALUE SPACES. 04880000
048900*    05  PV-CS-LOCATION                  PIC  9(04) VALUE ZEROES. 04890000
049000*    05  PV-DC-NBR-SIGNED                PIC S9(04)  COMP.        04900000
049100*    05  PV-CS-LOC-SIGNED                PIC S9(04)  COMP.        04910000
049200*    05  PV-PULL-NBR-SIGNED              PIC S9(09)  COMP.        04920000
049300*    05  PV-CREATE-DATE                  PIC  X(08) VALUE SPACES. 04930000
049400*    05  PV-PULL-STATUS-CDE              PIC  X(02) VALUE SPACES. 04940000
049500*    05  PV-PULL-STATUS-DESC             PIC  X(09) VALUE SPACES. 04950000
049600*    05  PV-STATUS-DATE                  PIC  X(08) VALUE SPACES. 04960000
049700*    05  PV-PULL-SOURCE-CDE              PIC  X(02) VALUE SPACES. 04970000
049800*    05  PV-PULL-SOURCE-DESC             PIC  X(04) VALUE SPACES. 04980000
049900*    05  PV-NBR-ITEMS                    PIC  9(05) VALUE ZEROES. 04990000
050000*    05  PV-REQ-PULL-UNITS               PIC  9(06) VALUE ZEROES. 05000000
050100*    05  PV-ACT-PULL-UNITS               PIC  9(06) VALUE ZEROES. 05010000
050200*    05  PV-DISTRBUTED-UNITS             PIC  9(06) VALUE ZEROES. 05020000
050300                                                                  05030000
050400     05  PV-SEL-TERM-ID                  PIC  X(04).              05040000
050500     05  PV-SEL-TASK-NUMBER              PIC  9(05).              05050000
050600     05  PV-SEL-SEQ                      PIC  9(01).              05060000
050700                                                                  05070006
051200     05  PV-ORIGINAL-BLOCK               PIC S9(04)  VALUE +0     05120006
051300                                                     COMP SYNC.   05130006
051400     05  PV-ITEMS-HOLD                   PIC S9(03)  COMP-3.      05140006
051500     05  PV-ITEMS-DIFF                   PIC S9(03)  COMP-3.      05150006
051600*    05  PV-SEL-CNCL-CNT                 PIC S9(09)  COMP-3       05160000
051700*                                                    VALUE ZEROES.05170000
051800*    05  PV-SEL-UNCNCL-CNT               PIC S9(09)  COMP-3       05180000
051900*                                                    VALUE ZEROES.05190000
052000*    05  PV-CEPLDS-COUNT                 PIC S9(09)  VALUE ZEROES 05200000
052100*                                                    COMP.        05210000
052200*    05  PV-CEPLIT-COUNT                 PIC S9(09)  VALUE ZEROES 05220000
052300*                                                    COMP.        05230000
052400*    05  PV-LINES-NEW                    PIC S9(09)  VALUE ZEROES 05240000
052500*                                                    COMP.        05250000
052600*    05  PV-4-DIGIT-STORE                PIC  Z(04)  VALUE ZEROES.05260000
052700*                                                                 05270000
052800*    05  PV-RACF-ERROR-CODE              PIC  9(04)  VALUE ZEROES.05280000
052900*    05  PV-FROM-TMST.                                            05290000
053000*        10   PV-FROM-YY    PIC X(04)  VALUE ZEROES.              05300000
053100*        10   FILLER        PIC X(01)  VALUE '-'.                 05310000
053200*        10   PV-FROM-MM    PIC X(02)  VALUE ZEROES.              05320000
053300*        10   FILLER        PIC X(01)  VALUE '-'.                 05330000
053400*        10   PV-FROM-DD    PIC X(02)  VALUE ZEROES.              05340000
053500*        10   FILLER        PIC X(16)  VALUE '-00.00.00.000000'.  05350000
053600*    05  PV-TO-TMST.                                              05360000
053700*        10   PV-TO-YY      PIC X(04)  VALUE ZEROES.              05370000
053800*        10   FILLER        PIC X(01)  VALUE '-'.                 05380000
053900*        10   PV-TO-MM      PIC X(02)  VALUE ZEROES.              05390000
054000*        10   FILLER        PIC X(01)  VALUE '-'.                 05400000
054100*        10   PV-TO-DD      PIC X(02)  VALUE ZEROES.              05410000
054200*        10   FILLER        PIC X(16)  VALUE '-23.59.59.999999'.  05420000
054300*    05  PV-REF-DEPT-HOLD.                                        05430000
054400*        10  PV-DEPT-HOLD   PIC X(03)  VALUE SPACE.               05440000
054500*        10  FILLER         PIC X(01)  VALUE '/'.                 05450000
054600*        10  PV-REF-HOLD    PIC X(15)  VALUE SPACE.               05460000
054700*    05  PV-NUMERIC-DISTRB-QTY                                    05470000
054800*                           PIC Z(05)9-   VALUE ZEROES.           05480000
054900*    05  PV-DISPLAY-DISTRB-QTY                                    05490000
055000*                           PIC X(07)     VALUE SPACES.           05500000
055010     05  PV-DISP-MAX-LENGTH             PIC ZZZ9    VALUE ZEROS.  05501006
055020     05  PV-DISP-DEC-POS                PIC ZZZ9    VALUE ZEROS.  05502006
055030     05  PV-DISP-ELEM-CNT               PIC ZZZ9    VALUE ZEROS.  05503006
055100                                                                  05510000
056300******************************************************************05630000
056400**  THIS IS THE LAYOUT FOR THE LIST ITEMS TEMP STORAGE QUEUE.   **05640000
056500**  THIS MUST BE THE EXACT SAME FORMAT A BLOCK IN THE           **05650000
056600**  APPLICATION-SPECIFIC COMMAREA.                              **05660000
056700******************************************************************05670000
056800 01  LQW-LIST-QUEUE-WORK-AREA.                                    05680000
056900     05  LQW-BLOCK-MODIFIED             PIC  X(01)  VALUE SPACE.  05690000
057000     05  LQW-ITEM-ENTRIES               OCCURS  9 TIMES           05700031
057100                                        INDEXED BY LQW-IDX.       05710000
057200         10  LQW-LIST-ITEM-NUMBER       PIC S9(09)  COMP-3.       05720000
057300         10  LQW-TEMP-SELECTED-SW       PIC  X(01).               05730000
057400         10  LQW-SELECTED-SW            PIC  X(01).               05740000
057500             88  LQW-SELECT                         VALUE 'S'.    05750000
057600             88  LQW-DESELECT                       VALUE ' '.    05760000
057700         10  LQW-ACTION                 PIC  X(01).               05770000
057800             88  LQW-ADD                            VALUE 'A'.    05780000
057900             88  LQW-INQ                            VALUE 'I'.    05790000
058000             88  LQW-UPD                            VALUE 'U'.    05800000
058100             88  LQW-ERR                            VALUE 'E'.    05810000
058200         10  LQW-FUNC-CODE              PIC  X(10).               05820000
058300         10  LQW-FUNC-DESC              PIC  X(50).               05830000
058400         10  LQW-DEFN-SEQ               PIC  9(04).               05840000
058500         10  LQW-ATTR-DESC              PIC  X(50).               05850000
058600         10  LQW-REQD                   PIC  X(01).               05860000
058700         10  LQW-DATA-TYPE              PIC  X(03).               05870000
058800             88  LQW-DATE                           VALUE 'DTE'.  05880000
058900             88  LQW-NUMERIC                        VALUE 'NUM'.  05890000
059000             88  LQW-STRING                         VALUE 'STR'.  05900000
059100         10  LQW-MAX-LENGTH             PIC  9(04).               05910000
059200         10  LQW-DECIMAL-POSITIONS      PIC  9(04).               05920000
059300         10  LQW-ELEM-COUNT             PIC S9(09)  COMP.         05930000
060100                                                                  06010000
060200                                                                  06020000
060300*---------------------------------------------------------------* 06030000
060400* SELECTON QUEUE LAYOUT - FROM INTEGRATION LIST (CNKCS246)      * 06040000
060500*---------------------------------------------------------------* 06050000
060600     COPY CNWS024.                                                06060000
060700                                                                  06070000
060810*---------------------------------------------------------------* 06081000
060820* SELECTION QUEUE LAYOUT                                        * 06082000
060830*---------------------------------------------------------------* 06083000
060840     COPY CNWS026.                                                06084000
060850                                                                  06085000
062600*---------------------------------------------------------------* 06260000
062700*    MAP LAYOUT                                                 * 06270000
062800*---------------------------------------------------------------* 06280000
063000     COPY CNKM247.                                                06300003
063100*                                                                 06310000
063200 01  MR-OCCURS-LAYOUT                   REDEFINES  CNK247O.       06320000
063300     05  FILLER                         PIC X(112).               06330000
063400     05  MR-SCROLL-AREA                 OCCURS  9 TIMES.          06340031
063500         10  MR-SELECTL                 PIC S9(04) COMP.          06350000
063600         10  MR-SELECTA                 PIC  X(01).               06360000
063700         10  MR-SELECTC                 PIC  X(01).               06370000
063800         10  MR-SELECTH                 PIC  X(01).               06380000
063900         10  MR-SELECTI                 PIC  X(01).               06390000
064000                                                                  06400000
064100         10  MR-ACTIONL                 PIC S9(04) COMP.          06410000
064200         10  MR-ACTIONA                 PIC  X(01).               06420000
064300         10  MR-ACTIONC                 PIC  X(01).               06430000
064400         10  MR-ACTIONH                 PIC  X(01).               06440000
064500         10  MR-ACTION                  PIC  X(01).               06450000
064600                                                                  06460000
064700         10  MR-DEFSEQL                PIC S9(04) COMP.           06470000
064800         10  MR-DEFSEQA                PIC  X(01).                06480000
064900         10  MR-DEFSEQC                PIC  X(01).                06490000
065000         10  MR-DEFSEQH                PIC  X(01).                06500000
065100         10  MR-DEFSEQ                 PIC  Z(04).                06510000
065200                                                                  06520000
065300         10  MR-ATTDSCL                PIC S9(04) COMP.           06530000
065400         10  MR-ATTDSCA                PIC  X(01).                06540000
065500         10  MR-ATTDSCC                PIC  X(01).                06550000
065600         10  MR-ATTDSCH                PIC  X(01).                06560000
065700         10  MR-ATTDSC                 PIC  X(48).                06570033
065800                                                                  06580000
065900         10  MR-REQDL                  PIC S9(04) COMP.           06590000
066000         10  MR-REQDA                  PIC  X(01).                06600000
066100         10  MR-REQDC                  PIC  X(01).                06610000
066200         10  MR-REQDH                  PIC  X(01).                06620000
066300         10  MR-REQD                   PIC  X(01).                06630000
066400                                                                  06640000
066500         10  MR-DATYPEL                PIC S9(04) COMP.           06650000
066600         10  MR-DATYPEA                PIC  X(01).                06660000
066700         10  MR-DATYPEC                PIC  X(01).                06670000
066800         10  MR-DATYPEH                PIC  X(01).                06680000
066900         10  MR-DATYPE                 PIC  X(03).                06690000
067000                                                                  06700000
067100         10  MR-MAXLENL                PIC S9(04) COMP.           06710000
067200         10  MR-MAXLENA                PIC  X(01).                06720000
067300         10  MR-MAXLENC                PIC  X(01).                06730000
067400         10  MR-MAXLENH                PIC  X(01).                06740000
067500         10  MR-MAXLEN                 PIC  X(04).                06750000
067600                                                                  06760000
067700         10  MR-DECPOSL                PIC S9(04) COMP.           06770000
067800         10  MR-DECPOSA                PIC  X(01).                06780000
067900         10  MR-DECPOSC                PIC  X(01).                06790000
068000         10  MR-DECPOSH                PIC  X(01).                06800000
068100         10  MR-DECPOS                 PIC  X(04).                06810000
068200                                                                  06820000
068300         10  MR-ELMCNTL                PIC S9(04) COMP.           06830000
068400         10  MR-ELMCNTA                PIC  X(01).                06840000
068500         10  MR-ELMCNTC                PIC  X(01).                06850000
068600         10  MR-ELMCNTH                PIC  X(01).                06860000
068700         10  MR-ELMCNT                 PIC  X(04).                06870000
068800                                                                  06880000
068900                                                                  06890000
069000     05  FILLER                         PIC  X(12).               06900000
069100                                                                  06910000
072400*---------------------------------------------------------------* 07240000
072500*    ATTRIBUTE SETTINGS COPYBOOK.                               * 07250000
072600*---------------------------------------------------------------* 07260000
072800     COPY DPWS015.                                                07280000
072900                                                                  07290000
073000*---------------------------------------------------------------* 07300000
073100*    FUNCTION KEYS COPYBOOK.                                    * 07310000
073200*---------------------------------------------------------------* 07320000
073400     COPY DPWS016.                                                07340000
073500                                                                  07350000
073600*---------------------------------------------------------------* 07360006
073700*    NUMERIC EDIT LAYOUT.                                       * 07370006
073800*---------------------------------------------------------------* 07380006
073900     COPY DPWS010I.                                               07390006
074000                                                                  07400006
074200*---------------------------------------------------------------* 07420000
CICS  *    PARAMETERS FOR CALLING THE CICS ARCHITECTURE API.          * 07430035
074400*---------------------------------------------------------------* 07440000
074600     COPY DPWS030.                                                07460000
CICS       COPY DPWS930.                                                07461035
074700                                                                  07470000
074800*---------------------------------------------------------------* 07480000
074900*    STANDARD COMMAREA.                                         * 07490000
075000*---------------------------------------------------------------* 07500000
075200     COPY DPWS020.                                                07520000
075300     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                07530000
075400                                                                  07540000
075500*---------------------------------------------------------------* 07550000
076110* INTER-APPLICATION COMMAREA.                                   * 07611000
076120*   CNWS022 - IS THE INPUT LAYOUT WHEN COMING FROM THE CRIT.    * 07612000
076130*             SPEC SCREEN.  (CNKCS243)                          * 07613000
076140*   CNWS023 - IS THE INPUT LAYOUT WHEN COMING FROM THE CODE     * 07614000
076150*             LIST SCREEN.  (CNKCS246)                          * 07615000
076160*   CNWS025 - IS THE OUTPUT LAYOUT WHEN NAVIGATING TO THE       * 07616000
076170*             ADD/UPDATE DEFN SCREEN (CNKCS245)                 * 07617000
076200                                                                  07620000
076300         10  INTER-APPL-COMM-AREA       PIC X(200).               07630000
076400     COPY CNWS022.                                                07640000
076500     COPY CNWS023.                                                07650000
076510     COPY CNWS025.                                                07651000
076520                                                                  07652000
076600*---------------------------------------------------------------* 07660000
076700*  THIS IS THE APPLICATION-SPECIFIC COMMAREA.                   * 07670000
076800*---------------------------------------------------------------* 07680000
076900         10  ASC-SPECIFIC-COMMAREA.                               07690000
076910             15  ASC-FUNCTION                 PIC  X(02).         07691000
076920                 88  ASC-FUNCTION-NONE             VALUE ' '.     07692000
076930                 88  ASC-ADD-CODE                  VALUE 'AC'.    07693000
076940                 88  ASC-UPD-CODE                  VALUE 'UC'.    07694000
076950                 88  ASC-ADD-PARM                  VALUE 'AP'.    07695000
076960                 88  ASC-UPD-PARM                  VALUE 'UP'.    07696000
076990             15  ASC-PARM-NAME                PIC  X(10).         07699000
076991             15  ASC-PARM-DESC                PIC  X(50).         07699100
076992             15  ASC-APPL-FUNC                PIC  X(10).         07699200
076993             15  ASC-DEFN-CNT                 PIC  9(04).         07699300
076994             15  ASC-ELEM-CNT                 PIC  9(04).         07699400
086000                                                                  08600000
086100             15  FILLER                       PIC  X(50).         08610025
086200*-----------------------------------------------------------------08620000
086300             15  ASC-BLK-SUB                  PIC S9(04) COMP     08630000
086500                                                         SYNC.    08650000
086600             15  ASC-ITEM-SUB                 PIC S9(04) COMP     08660000
086800                                                         SYNC.    08680000
086900             15  ASC-NUMBER-OF-ITEMS-READ     PIC S9(09) COMP-3.  08690000
087100             15  ASC-NUMBER-OF-SELECTED-ITEMS PIC S9(09) COMP-3.  08710000
087300             15  ASC-ITEMS-DISPLAYED          PIC S9(03) COMP-3.  08730000
087500             15  ASC-ITEM-AT-TOP-OF-PANEL     PIC S9(09) COMP-3.  08750000
087700             15  ASC-ITEM-AT-BOT-OF-PANEL     PIC S9(09) COMP-3.  08770000
087900             15  ASC-HIGHEST-BLOCK-WRITTEN    PIC S9(04) COMP     08790000
088100                                                         SYNC.    08810000
088200             15  ASC-START-OF-SELECTED-RANGE  PIC S9(09) COMP-3.  08820000
088400             15  ASC-END-OF-SELECTED-RANGE    PIC S9(09) COMP-3.  08840000
088600             15  ASC-ITEMS-LEFT-INDICATOR     PIC  X(01).         08860000
088700                 88  ASC-ITEMS-LEFT-ON-DB          VALUE 'Y'.     08870000
088800                 88  ASC-NO-ITEMS-LEFT-ON-DB       VALUE 'N'.     08880000
088900             15  ASC-XCNTL-TO-RESEND-SW       PIC  X(01).         08890000
089000                 88  ASC-XCNTL-TO-RESEND           VALUE 'Y'.     08900000
089100                 88  ASC-XCNTL-TO-RESEND-NO        VALUE 'N'.     08910000
089200             15  ASC-TEMP-QUEUE-UPDATE-SW     PIC  X(01).         08920000
089300                 88  ASC-UPDATE-TSQ                VALUE 'Y'.     08930000
089400                 88  ASC-NO-TSQ-UPDATE             VALUE ' '.     08940000
089500             15  ASC-LIST-QUEUE-NAME.                             08950000
089600                 20  ASC-LIST-TERM-ID         PIC  X(04).         08960000
089700                 20  ASC-LIST-TASK-NUMBER     PIC S9(05) COMP-3.  08970000
089900                 20  ASC-LIST-SEQ             PIC  9(01).         08990000
089910                                                                  08991000
089920             15  ASC-START-ITEM-REQUEST.                          08992000
089930                 20  ASC-START-ITEM-REQUEST-N PIC  9(05).         08993000
089940                                                                  08994000
089950             15  ASC-SEL-SUB                  PIC S9(4) COMP.     08995000
089960             15  ASC-SEL-ITEM                 PIC S9(4) COMP.     08996000
089970                                                                  08997000
089980             15  ASC-USE-SELECTION-QUEUE-IND  PIC  X(1).          08998000
089990                 88  ASC-USE-SELECTION-QUEUE       VALUE 'Y'.     08999000
090000             15  ASC-SEL-QUEUE-NAME.                              09000000
090100                 20  ASC-SEL-TERM-ID          PIC  X(04).         09010000
090200                 20  ASC-SEL-TASK-NUMBER      PIC S9(05) COMP-3.  09020000
090400                 20  ASC-SEL-SEQ              PIC  9(01).         09040000
090500                                                                  09050000
090700             15  ASC-NUMBER-OF-TS-ITEMS       PIC S9(09) COMP-3.  09070000
096000                                                                  09600000
096100*-----------------------------------------------------------------09610000
096900             15  ASC-BLOCK-ENTRIES OCCURS 2 TIMES.                09690000
097000                 20  ASC-BLOCK-MODIFIED-SW           PIC  X(01).  09700000
097100                     88  ASC-BLOCK-NOT-MODIFIED      VALUE 'N'.   09710000
097200                     88  ASC-BLOCK-MODIFIED          VALUE 'Y'.   09720000
097300                                                                  09730000
097400                 20  ASC-ITEM-ARRAY.                              09740000
097500                     25  ASC-ITEM-ENTRIES OCCURS  9 TIMES.        09750031
097600                         30  ASC-LIST-ITEM-NUMBER                 09760000
097700                                                     PIC S9(09)   09770000
097800                                                     COMP-3.      09780000
097900                         30  ASC-TEMP-SELECTED-SW    PIC  X(01).  09790000
098000                             88  ASC-VALID-SELECT    VALUE ' '    09800000
098100                                                           'S'    09810000
098200                                                           'B'    09820000
098300                                                           'E'.   09830000
098400                             88  ASC-TEMP-NO-SELECT  VALUE ' '.   09840000
098500                             88  ASC-TEMP-SELECT     VALUE 'S'.   09850000
098600                             88  ASC-TEMP-BEGIN      VALUE 'B'.   09860000
098700                             88  ASC-TEMP-END        VALUE 'E'.   09870000
098800                         30  ASC-SELECTED-SW         PIC  X(01).  09880000
098900                             88  ASC-NO-SELECT       VALUE ' '.   09890000
099000                             88  ASC-SELECT          VALUE 'S'.   09900000
099100                             88  ASC-BEGIN           VALUE 'B'.   09910000
099200                             88  ASC-END             VALUE 'E'.   09920000
099300                         30  ASC-ACTION              PIC  X(01).  09930013
099400                         30  ASC-FUNC-CODE           PIC  X(10).  09940000
099500                         30  ASC-FUNC-DESC           PIC  X(50).  09950000
099600                         30  ASC-DEFN-SEQ            PIC  9(04).  09960000
099700                         30  ASC-ATTR-DESC           PIC  X(50).  09970000
099800                         30  ASC-REQD                PIC  X(01).  09980000
099900                         30  ASC-DATA-TYPE           PIC  X(03).  09990000
100000                             88  ASC-DATE            VALUE 'DTE'. 10000000
100100                             88  ASC-NUMERIC         VALUE 'NUM'. 10010000
100200                             88  ASC-STRING          VALUE 'STR'. 10020000
100300                         30  ASC-MAX-LENGTH          PIC  9(04).  10030000
100400                         30  ASC-DECIMAL-POSITION    PIC  9(04).  10040000
100500                         30  ASC-ELEM-COUNT          PIC S9(09)   10050000
100600                                                         COMP.    10060000
101000                                                                  10100000
101100                                                                  10110000
101200*---------------------------------------------------------------* 10120000
101300*    ABEND PROCESSING COPYBOOK.                                 * 10130000
101400*---------------------------------------------------------------* 10140000
101600     COPY DPWS013.                                                10160000
101700                                                                  10170000
101800*----------------------------------------------------------------*10180000
101900*    DB2 TABLE FOR WST_INTGRTN_TYP INTEGRATION CODE TABLE         10190000
102000*----------------------------------------------------------------*10200000
102100     EXEC SQL                                                     10210000
102200          INCLUDE WST00008                                        10220000
102300     END-EXEC.                                                    10230000
102400                                                                  10240000
102500                                                                  10250000
102600*----------------------------------------------------------------*10260000
102700*    DB2 TABLE FOR WST_ATTR_DEFN ATTRIBUTE DEFINITION TABLE       10270000
102800*----------------------------------------------------------------*10280000
102900     EXEC SQL                                                     10290000
103000          INCLUDE WST00009                                        10300000
103100     END-EXEC.                                                    10310000
103200                                                                  10320000
103300                                                                  10330000
103400*----------------------------------------------------------------*10340000
103500*    DB2 TABLE FOR WST_ATTR_ELEM ATTRIBUTE ELEMENT TABLE          10350000
103600*----------------------------------------------------------------*10360000
103700     EXEC SQL                                                     10370000
103800          INCLUDE WST00010                                        10380000
103900     END-EXEC.                                                    10390000
104000                                                                  10400000
104100                                                                  10410000
108100                                                                  10810000
108200*---------------------------------------------------------------* 10820000
108300* WST_ATTR_DEFN CURSOR                                          * 10830000
108400*---------------------------------------------------------------* 10840000
108500     EXEC SQL                                                     10850000
108600        DECLARE ATTR-DEFN-CSR CURSOR FOR                          10860000
108700         SELECT INTGRTN_TYP_CDE                                   10870000
108800              , ATTR_DEFN_SEQ_NBR                                 10880000
108900              , ATTR_DEFN_DESC                                    10890000
109000              , REQR_IND                                          10900000
109100              , DATYP_CDE                                         10910000
109200              , MAX_LEN_QTY                                       10920000
109300              , MAX_PCSN_QTY                                      10930000
109400           FROM WST_ATTR_DEFN                                     10940000
109500          WHERE INTGRTN_TYP_CDE   =  :DK-ATTR-DEFN                10950000
109600          ORDER BY ATTR_DEFN_SEQ_NBR                              10960000
109700     END-EXEC.                                                    10970000
109800                                                                  10980000
290600*---------------------------------------------------------------* 29060000
290700*    DB2 AREA FOR COMMUNICATIONS                                * 29070000
290800*---------------------------------------------------------------* 29080000
290900     EXEC SQL                                                     29090000
291000          INCLUDE SQLCA                                           29100000
291100     END-EXEC.                                                    29110000
291200                                                                  29120000
291300                                                                  29130000
291400*---------------------------------------------------------------* 29140000
291500*                                                               * 29150000
291600*---------------------------------------------------------------* 29160000
291700 LINKAGE SECTION.                                                 29170000
291800                                                                  29180000
291900 01  DFHCOMMAREA.                                                 29190000
292000     05  FILLER                         OCCURS  1 TO 4072 TIMES   29200000
292100                                        DEPENDING ON EIBCALEN.    29210000
292200         10  FILLER                     PIC X.                    29220000
292300                                                                  29230000
292400 EJECT                                                            29240000
292500 PROCEDURE DIVISION.                                              29250000
292600******************************************************************29260000
292700**  THIS MODULE IS THE HIGHEST PROCESSING LEVEL IN THE PROGRAM. **29270000
292800**  FIRST, CALL THE CICS ARCHITECTURE API, PERFORM THE PROGRAM  **29280000
292900**  PROCESSING AND THEN CALL THE CICS ARCHITECTURE API TO EXIT. **29290000
293000******************************************************************29300000
293100 0000-MAIN-MODULE.                                                29310000
293200     INITIALIZE DP030-CICS-API-FIELDS.                            29320000
293300     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       29330000
293400     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          29340000
293500     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         29350000
293600     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       29360000
293700     MOVE LENGTH OF CNK247I        TO DP030-MAP-LENGTH (1).       29370002
293800     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     29380000
293900     PERFORM 0001-CALL-CICS-ARCH-API.                             29390000
294000*                                                                 29400000
294100     PERFORM 1000-CONTROL-PROCESSING                              29410000
294200*                                                                 29420000
294300     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     29430000
294400     PERFORM 0001-CALL-CICS-ARCH-API.                             29440000
294500                                                                  29450000
294600******************************************************************29460000
294700**  THIS PARAGRAPH CALLS THE CICS ARCHITECTURE API SUBROUTINE   **29470000
294800**  AND WILL ABEND IF ANY ERRORS OCCURRED IN THAT CALL.         **29480000
294900******************************************************************29490000
295000 0001-CALL-CICS-ARCH-API.                                         29500000
CICS       CALL DP930-CICS-ARCH-API USING DFHEIBLK                      29510035
295200                                    DFHCOMMAREA                   29520035
295300                                    DP030-CICS-API-FIELDS         29530035
295400                                    DP020-STANDARD-COMMAREA       29540035
295500                                    CNK247I.                      29550035
295600*                                                                 29560000
295700     IF  DP030-RC-CALL-SUCCESSFUL                                 29570000
295800         CONTINUE                                                 29580000
295900     ELSE                                                         29590000
296000         SET DP013-NO-ROLLBACK                                    29600000
296100             DP013-XCTL-DISPLAY-RESTART                           29610000
296200             DP013-CICS-ABEND      TO TRUE                        29620000
296300         MOVE '0001-CALL-CICS-ARCH-API'                           29630000
296400                                   TO DP013-PARAGRAPH             29640000
CICS           MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O29641035
CICS  -             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      29642035
296700         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      29670000
296800         PERFORM DP013-0000-PROCESS-ABEND                         29680000
296900     END-IF.                                                      29690000
297000*----------------------------------------------------------------*29700000
297100* PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT      *29710000
297200* COURSE OF ACTION IS FOR THIS TRANSACTION.                      *29720000
297300*                                                                *29730000
297400* NOTE:  PV-TOP-ITEM IS THE ITEM THAT IS REQUESTED TO BE AT THE  *29740000
297500*  TOP OF THE PANEL.  MOVING ASC-ITEM-AT-TOP-OF-PANEL TO THIS    *29750000
297600*  MEANS THAT POSITION WITHIN THE LIST WILL NOT CHANGE -- THIS   *29760000
297700*  IS THE DEFAULT WHICH WILL BE OVERRIDDEN BY SCROLLING ACTIONS. *29770000
297800*----------------------------------------------------------------*29780000
297900                                                                  29790000
298000 1000-CONTROL-PROCESSING.                                         29800000
298100                                                                  29810000
298200     EVALUATE TRUE                                                29820000
298300         WHEN DP020-NEXT-ACT-INITIAL                              29830000
298400             INITIALIZE ASC-SPECIFIC-COMMAREA                     29840000
298500             MOVE EIBTRMID         TO ASC-LIST-TERM-ID            29850000
298600                                      ASC-SEL-TERM-ID             29860000
298700             MOVE DP020-SRC-TASK-NUMBER                           29870000
298800                                   TO ASC-LIST-TASK-NUMBER        29880000
298900                                      ASC-SEL-TASK-NUMBER         29890000
299000             MOVE PC-LIST-QUEUE-SEQ                               29900000
299100                                   TO ASC-LIST-SEQ                29910000
299200             MOVE PC-SEL-QUEUE-SEQ TO ASC-SEL-SEQ                 29920000
299300             PERFORM 1100-PROCESS-INTER-APPL-COMM                 29930000
299400                                                                  29940000
299500             PERFORM 4000-BUILD-INITIAL-PANEL                     29950000
299600                                                                  29960000
299700         WHEN DP020-NEXT-ACT-READ-MAP                             29970000
299800             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        29980000
299900                                   TO PV-TOP-ITEM                 29990000
300000             PERFORM 2000-PROCESS-PANEL                           30000000
300100                                                                  30010000
300200         WHEN DP020-NEXT-ACT-RETURN                               30020000
300300             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        30030000
300400                                   TO PV-TOP-ITEM                 30040000
300500             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    30050000
300600                                                                  30060000
301500** DMH       PERFORM 6000-REFRESH-PANEL-FROM-TEMP                 30150024
301600** DMH       PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 30160024
301700                                                                  30170000
301710             PERFORM 3200-RESET-ATTRIBUTES                        30171024
301720             MOVE +1               TO PV-TOP-ITEM                 30172024
301730                                                                  30173024
301740             PERFORM 2050-DELETE-LIST-QUEUE                       30174024
301750                                                                  30175024
301760             PERFORM 4000-BUILD-INITIAL-PANEL                     30176024
301770                                                                  30177024
301780                                                                  30178024
301800         WHEN OTHER                                               30180000
301900             SET DP013-LOGIC-ABEND TO TRUE                        30190000
302000             SET DP013-NO-ROLLBACK TO TRUE                        30200000
302100             MOVE '1000-CONTROL-PROCESSING'                       30210000
302200                                   TO DP013-PARAGRAPH             30220000
302300             MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'    30230000
302400                                   TO DP013-MESSAGE-TEXT(1)       30240000
302500             PERFORM DP013-0000-PROCESS-ABEND                     30250000
302600     END-EVALUATE.                                                30260000
302700                                                                  30270000
302800 EJECT                                                            30280000
302900*----------------------------------------------------------------*30290000
303000* DETERMINE IF DATA WAS PASSED THROUGH INTER-APPL COMMAREA OR    *30300000
303100* IF THERE IS DATA TO BE USED IN THE NAV-KEY FIELD.              *30310000
303200*----------------------------------------------------------------*30320000
303300                                                                  30330000
303400 1100-PROCESS-INTER-APPL-COMM.                                    30340000
303500                                                                  30350000
303600     SET PS-COMMAREA-VALID         TO TRUE.                       30360000
303700     MOVE SPACE                    TO ASC-START-ITEM-REQUEST.     30370000
303800                                                                  30380000
303900     IF  DP020-INT-APPL-FORMAT-IND = PC-CRIT-SPEC-FORMAT          30390000
304000         MOVE CN022-FUNCTION           TO ASC-FUNCTION            30400000
304300         MOVE CN022-PARM-NAME          TO ASC-PARM-NAME           30430000
304400         MOVE CN022-PARM-DESC          TO ASC-PARM-DESC           30440000
304500         MOVE CN022-PARM-FUNC          TO ASC-APPL-FUNC           30450000
306300     ELSE                                                         30630000
306310         IF CN023-NUMBER-OF-SELECTED-ITEMS > 0                    30631016
306320             SET ASC-USE-SELECTION-QUEUE TO TRUE                  30632016
306321             MOVE CN023-NUMBER-OF-SELECTED-ITEMS                  30632116
306322                                  TO ASC-NUMBER-OF-SELECTED-ITEMS 30632216
306323             MOVE CN023-NUMBER-OF-TS-ITEMS                        30632316
306324                                  TO ASC-NUMBER-OF-TS-ITEMS       30632416
306325             MOVE CN023-SEL-QUEUE-NAME                            30632516
306326                                  TO ASC-SEL-QUEUE-NAME           30632616
306327                                                                  30632716
306330             MOVE CN023-FUNCTION      TO ASC-FUNCTION             30633016
306360             MOVE CN023-PARM-CODE     TO ASC-PARM-NAME            30636016
306370             MOVE CN023-PARM-DESC     TO ASC-PARM-DESC            30637016
306380             MOVE CN023-APPL-FUNC     TO ASC-APPL-FUNC            30638016
306381                                                                  30638116
306390**           MOVE 'INQ' TO  ASC-ACTION                            30639018
306400             PERFORM 1120-PREPARE-LIST-ENTRY                      30640016
306500             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   30650016
306600**           PERFORM 4500-MOVE-COMMAREA-TO-TEMP                   30660017
308200         END-IF                                                   30820016
308210     END-IF.                                                      30821016
308300                                                                  30830000
308310                                                                  30831000
308320*----------------------------------------------------------------*30832000
308321*                                                                *30832100
308322*----------------------------------------------------------------*30832200
308330 1120-PREPARE-LIST-ENTRY.                                         30833000
308340                                                                  30834000
308350     MOVE CN024-MAX-ITEMS          TO ASC-SEL-SUB.                30835000
308360     MOVE ZERO                     TO ASC-SEL-ITEM.               30836000
308370     PERFORM 1130-GET-NEXT-RECORD.                                30837000
308380                                                                  30838000
308381*----------------------------------------------------------------*30838100
308391*  GET THE NEXT RECORD IF A LIST OF RECORDS ARE BEING PROCESSED  *30839100
308392*----------------------------------------------------------------*30839200
308394 1130-GET-NEXT-RECORD.                                            30839400
308395                                                                  30839500
308396     ADD +1                       TO ASC-SEL-SUB.                 30839600
308397                                                                  30839700
308398     IF  ASC-SEL-SUB > CN024-MAX-ITEMS                            30839800
308399         ADD +1                   TO ASC-SEL-ITEM                 30839900
308400         MOVE +1                  TO ASC-SEL-SUB                  30840000
308401     END-IF.                                                      30840100
308402                                                                  30840200
308403     IF  ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                30840300
308404         PERFORM 9100-READ-SEL-QUEUE                              30840405
308405         IF  CN024-ITEM (ASC-SEL-SUB) > ZERO                      30840500
308406             MOVE CN024-PARM-NAME   (ASC-SEL-SUB)                 30840600
308407                                  TO ASC-PARM-NAME                30840700
308408             MOVE CN024-PARM-DESC  (ASC-SEL-SUB)                  30840800
308409                                  TO ASC-PARM-DESC                30840900
308410             MOVE CN024-PARM-FUNC   (ASC-SEL-SUB)                 30841000
308411                                  TO ASC-APPL-FUNC                30841100
308412             MOVE CN024-DEFN-CNT    (ASC-SEL-SUB)                 30841200
308413                                  TO ASC-DEFN-CNT                 30841300
308414             MOVE CN024-ELEM-CNT    (ASC-SEL-SUB)                 30841400
308415                                  TO ASC-ELEM-CNT                 30841500
308416                                                                  30841600
308417             SET CN024-INQ (ASC-SEL-SUB)                          30841700
308418                                  TO TRUE                         30841800
308419             PERFORM 9200-REWRITE-SEL-QUEUE                       30841900
308420         ELSE                                                     30842000
308421             SUBTRACT +1 FROM ASC-SEL-SUB                         30842100
308422             MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER             30842200
308423             SET DP020-MSG-INFORMATIONAL                          30842300
308424                 PS-LIST-END             TO TRUE                  30842400
308425         END-IF                                                   30842500
308426     ELSE                                                         30842600
308427         SUBTRACT +1 FROM ASC-SEL-ITEM                            30842700
308428         MOVE CN024-MAX-ITEMS     TO ASC-SEL-SUB                  30842800
308429         MOVE PC-TSYMSG-00070     TO DP020-MSG-NUMBER             30842900
308430         SET DP020-MSG-INFORMATIONAL                              30843000
308431             PS-LIST-END             TO TRUE                      30843100
308432     END-IF.                                                      30843200
308433                                                                  30843300
308434                                                                  30843400
308435*----------------------------------------------------------------*30843500
308437*    GET THE PREVIOUS RECORD IF A LIST OF RECORDS ARE BEING      *30843700
308438*    PROCESSED.                                                  *30843800
308439*----------------------------------------------------------------*30843900
308442 1140-GET-PREV-RECORD.                                            30844200
308443                                                                  30844300
308444     SUBTRACT +1 FROM ASC-SEL-SUB.                                30844400
308445                                                                  30844500
308446     IF  ASC-SEL-SUB < +1                                         30844600
308447         SUBTRACT +1 FROM ASC-SEL-ITEM                            30844700
308448         MOVE CN024-MAX-ITEMS     TO ASC-SEL-SUB                  30844800
308449     END-IF.                                                      30844900
308450                                                                  30845000
308451     IF  ASC-SEL-ITEM > ZERO                                      30845100
308452         PERFORM 9100-READ-SEL-QUEUE                              30845205
308453         IF  CN024-ITEM (ASC-SEL-SUB) > ZERO                      30845300
308454             MOVE CN024-PARM-NAME  (ASC-SEL-SUB)                  30845400
308455                                  TO ASC-PARM-NAME                30845500
308456             MOVE CN024-PARM-DESC  (ASC-SEL-SUB)                  30845600
308457                                  TO ASC-PARM-DESC                30845700
308458             MOVE CN024-PARM-FUNC   (ASC-SEL-SUB)                 30845800
308459                                  TO ASC-APPL-FUNC                30845900
308460             MOVE CN024-DEFN-CNT    (ASC-SEL-SUB)                 30846000
308461                                  TO ASC-DEFN-CNT                 30846100
308462             MOVE CN024-ELEM-CNT    (ASC-SEL-SUB)                 30846200
308463                                  TO ASC-ELEM-CNT                 30846300
308464                                                                  30846400
308465             SET CN024-INQ (ASC-SEL-SUB)                          30846500
308466                                  TO TRUE                         30846600
308467         PERFORM 9200-REWRITE-SEL-QUEUE                           30846700
308468     ELSE                                                         30846800
308469         MOVE +1                  TO ASC-SEL-ITEM                 30846900
308470                                     ASC-SEL-SUB                  30847000
308471         MOVE PC-TSYMSG-00069     TO DP020-MSG-NUMBER             30847100
308472         SET DP020-MSG-INFORMATIONAL                              30847200
308473             PS-LIST-END             TO TRUE                      30847300
308474     END-IF.                                                      30847400
308475                                                                  30847500
308476                                                                  30847600
308480                                                                  30848000
308500*----------------------------------------------------------------*30850000
308600* DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA   *30860000
308700* ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *30870000
308800* USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *30880000
308900* OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *30890000
309000* FUNCTION KEYS CAN GET THIS FAR.                                *30900000
309100*----------------------------------------------------------------*30910000
309200                                                                  30920000
309300 2000-PROCESS-PANEL.                                              30930000
309400     EVALUATE TRUE                                                30940000
309500         WHEN DP020-SRC-AID = DP016-CLEAR                         30950000
309600             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    30960000
309700             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   30970000
309800             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 30980000
309900                                                                  30990000
310000         WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    31000000
310100             PERFORM 2050-DELETE-LIST-QUEUE                       31010000
310200             PERFORM 4000-BUILD-INITIAL-PANEL                     31020000
310300                                                                  31030000
310400         WHEN DP020-FK-DESELECT(DP020-SRC-AID)                    31040000
310500             PERFORM 2140-DESELECT-ALL-ITEMS                      31050000
310600             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 31060000
310700                                                                  31070000
310800         WHEN DP020-FK-SELECT-ALL(DP020-SRC-AID)                  31080000
310900             PERFORM 2150-SELECT-ALL-ITEMS                        31090000
311000             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 31100000
311100                                                                  31110000
311200         WHEN OTHER                                               31120000
311300             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 31130000
311400             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   31140000
311500                                                                  31150000
311600             IF  PS-NO-ERROR                                      31160000
311700                 SET DP030-CONTINUE-GO                            31170000
311800                                 TO TRUE                          31180000
311900                 PERFORM 2100-CHECK-FUNCTION-KEY                  31190000
312000             ELSE                                                 31200000
312100                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             31210000
312200                 SET DP030-OVERRIDE-GO                            31220000
312300                                 TO TRUE                          31230000
312400             END-IF                                               31240000
312500     END-EVALUATE.                                                31250000
312600                                                                  31260000
312610                                                                  31261000
312700*----------------------------------------------------------------*31270000
312800*  DELETE THE LIST ITEMS TEMP STORAGE QUEUE.                     *31280000
312900*----------------------------------------------------------------*31290000
313000 2050-DELETE-LIST-QUEUE.                                          31300000
313100                                                                  31310000
313200     EXEC CICS                                                    31320000
313300         DELETEQ TS                                               31330000
313400             QUEUE (ASC-LIST-QUEUE-NAME)                          31340000
313500             RESP  (PV-CICS-RESP)                                 31350000
313600     END-EXEC.                                                    31360000
313700                                                                  31370000
313800     IF (PV-CICS-RESP = DFHRESP(NORMAL)) OR                       31380000
313900        (PV-CICS-RESP = DFHRESP(QIDERR))                          31390000
314000         CONTINUE                                                 31400000
314100     ELSE                                                         31410000
314200         SET DP013-CICS-ABEND      TO TRUE                        31420000
314300         SET DP013-NO-ROLLBACK     TO TRUE                        31430000
314400                                                                  31440000
314500         MOVE '2050-DELETE-LIST-QUEUE'                            31450000
314600                                   TO DP013-PARAGRAPH             31460000
314700         MOVE 'ERROR TRYING TO DELETE LIST TEMP STORAGE QUEUE'    31470000
314800                                   TO DP013-MESSAGE-TEXT (1)      31480000
314900         PERFORM DP013-0000-PROCESS-ABEND                         31490000
315000     END-IF.                                                      31500000
315100                                                                  31510000
315200     MOVE +0                       TO ASC-HIGHEST-BLOCK-WRITTEN.  31520000
315300 EJECT                                                            31530000
315400*----------------------------------------------------------------*31540000
315500* ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED FIRST.*31550000
315600* NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED FROM THE  *31560000
315700* CICS ARCHITECTURE API.                                         *31570000
315800*----------------------------------------------------------------*31580000
315900 2100-CHECK-FUNCTION-KEY.                                         31590000
316000                                                                  31600000
316100     EVALUATE TRUE                                                31610000
326800*                                                                 32680000
326810* F13 - ADD DEFN  (WST_ATTR_DEFN) (LOCAL-FUNC-01)                 32681000
326811         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              32681100
326820                  SET CN022-ADD-DEFN TO TRUE                      32682000
326822                  MOVE ASC-PARM-NAME    TO  CN022-PARM-NAME       32682215
326823                  MOVE ASC-PARM-DESC    TO  CN022-PARM-DESC       32682315
326824                  MOVE ASC-APPL-FUNC    TO  CN022-PARM-FUNC       32682415
326840                                                                  32684000
326841* F15 - UPD DEFN  (WST_ATTR_DEFN) (LOCAL-FUNC-02)                 32684108
326842         WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              32684208
326843              IF  ASC-NUMBER-OF-SELECTED-ITEMS > 0                32684308
326844                  MOVE ASC-NUMBER-OF-SELECTED-ITEMS               32684408
326845                                TO CN025-NUMBER-OF-SELECTED-ITEMS 32684508
326846                  MOVE ASC-NUMBER-OF-TS-ITEMS                     32684608
326847                                      TO CN025-NUMBER-OF-TS-ITEMS 32684708
326848                  MOVE ASC-SEL-QUEUE-NAME                         32684808
326849                                         TO  CN025-SEL-QUEUE-NAME 32684908
326850                  SET CN025-UPD-DEFN TO TRUE                      32685008
326851                  MOVE ASC-PARM-NAME    TO  CN025-FUNC-NAME       32685108
326852                  MOVE ASC-PARM-DESC    TO  CN025-FUNC-DESC       32685208
326853                  MOVE ASC-APPL-FUNC    TO  CN025-APPL-FUNC       32685308
326854                  PERFORM 5000-PREPARE-SEL-QUEUE                  32685412
326855              ELSE                                                32685508
326856                  PERFORM 4400-MOVE-COMMAREA-TO-SCREEN            32685608
326857                  SET DP030-OVERRIDE-GO TO TRUE                   32685708
326858                  MOVE PC-TSYMSG-00057  TO DP020-MSG-NUMBER       32685808
326859                  SET DP020-MSG-FATAL   TO TRUE                   32685908
326860             END-IF                                               32686008
326861                                                                  32686108
326862* F17 - ADD ELEM            (LOCAL-FUNC-03)                       32686200
326863         WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)              32686300
326894              SET CN022-ADD-ELEM TO TRUE                          32689409
326895              MOVE ASC-PARM-NAME    TO  CN022-PARM-NAME           32689510
326896              MOVE ASC-PARM-DESC    TO  CN022-PARM-DESC           32689610
326897              MOVE ASC-APPL-FUNC    TO  CN022-PARM-FUNC           32689710
326899                                                                  32689900
326900* F24 - ELEM LIST           (LOCAL-FUNC-04)                       32690000
326901         WHEN DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID)              32690100
326902              PERFORM 2115-PREPARE-INTER-APPL-ELEM                32690200
326903              PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                32690300
326904                                                                  32690400
326905* F6 - FIRST PAGE                                                 32690500
326906         WHEN DP020-FK-FIRST-PAGE(DP020-SRC-AID)                  32690600
326907             PERFORM 3200-RESET-ATTRIBUTES                        32690700
326908             MOVE +1               TO PV-TOP-ITEM                 32690800
326909             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 32690900
326910                                                                  32691000
326911* F7 - PREVIOUS PAGE                                              32691100
326912         WHEN DP020-FK-PREV-PAGE(DP020-SRC-AID)                   32691200
326913             PERFORM 3200-RESET-ATTRIBUTES                        32691300
326914             PERFORM 2110-BROWSE-BACKWARD                         32691400
326915             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 32691500
326916                                                                  32691600
326917* F8 - NEXT PAGE                                                  32691700
326918         WHEN DP020-FK-NEXT-PAGE(DP020-SRC-AID)                   32691800
326919             PERFORM 3200-RESET-ATTRIBUTES                        32691900
326920             PERFORM 2120-BROWSE-FORWARD                          32692000
326921             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 32692100
326922                                                                  32692200
326923* ENTER KEY                                                       32692300
326924         WHEN DP020-SRC-AID = DP016-ENTER                         32692400
326925             PERFORM 2130-CHECK-FOR-JUMP-BROWSE                   32692500
326926             IF  PS-ERROR                                         32692600
326927                 CONTINUE                                         32692700
326928             ELSE                                                 32692800
326929                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             32692900
326930             END-IF                                               32693000
326931                                                                  32693100
326932         WHEN OTHER                                               32693200
326933             SET DP013-NO-ROLLBACK                                32693300
326934                 DP013-XCTL-DISPLAY-RESTART                       32693400
326935                 DP013-CICS-ABEND  TO TRUE                        32693500
326936             MOVE '2100-CHECK-FUNCTION-KEY' TO DP013-PARAGRAPH    32693600
326937             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      32693700
326938                                   TO DP013-MESSAGE-TEXT (1)      32693800
326939             PERFORM DP013-0000-PROCESS-ABEND                     32693900
326940     END-EVALUATE.                                                32694000
326941                                                                  32694100
326942******************************************************************32694200
326943** MOVE DATA NECESSARY TO THE DESTINATION PROGRAM(S) INTO THE   **32694300
326944** INTER-APPLICATION COMMAREA.                                  **32694400
326945******************************************************************32694500
326946 2110-PREPARE-INTER-APPL-COMM.                                    32694600
326947                                                                  32694700
326948     INITIALIZE CN022-INTER-APPL-COMMAREA.                        32694800
326949                                                                  32694900
326950     MOVE ASC-FUNCTION             TO CN022-FUNCTION.             32695000
326960                                                                  32696000
326970 2115-PREPARE-INTER-APPL-ELEM.                                    32697000
326980                                                                  32698000
326990     INITIALIZE CN022-INTER-APPL-COMMAREA.                        32699000
327000                                                                  32700000
327100     SET  CN022-FUNCTION-NONE       TO TRUE.                      32710000
327200     MOVE CN022-FUNCTION            TO ASC-FUNCTION.              32720000
327500     MOVE ASC-PARM-NAME             TO CN022-PARM-NAME.           32750000
327600     MOVE ASC-PARM-DESC             TO CN022-PARM-DESC.           32760000
327700                                                                  32770000
327800                                                                  32780000
344700*----------------------------------------------------------------*34470000
344800*    IF THE USER HITS THE PAGE BACKWARD KEY, COMPUTE THE TOP     *34480000
344900*    ITEM NUMBER FOR THE NEW PAGE.  IF IT IS ABOVE THE TOP,      *34490000
345000*    SET THE TOP ITEM NUMBER TO +1 AND DISPLAY THE TOP OF LIST   *34500000
345100*    MESSAGE.                                                    *34510000
345200*----------------------------------------------------------------*34520000
345300                                                                  34530000
345400 2110-BROWSE-BACKWARD.                                            34540000
345500     SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-AT-TOP-OF-PANEL    34550000
345600         GIVING PV-TOP-ITEM.                                      34560000
345700*                                                                 34570000
345800     IF  ((PV-TOP-ITEM < +1)                                      34580000
345900       OR (PV-TOP-ITEM = +1))                                     34590000
346000         MOVE +1                   TO PV-TOP-ITEM                 34600000
346100*        -- TOP OF LIST --                                        34610000
346200         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            34620000
346300         SET DP020-MSG-INFORMATIONAL TO TRUE                      34630000
346400     END-IF.                                                      34640000
346500                                                                  34650000
346600 EJECT                                                            34660000
346700*----------------------------------------------------------------*34670000
346800*    IF THE USER HITS THE PAGE FORWARD KEY, COMPUTE THE TOP      *34680000
346900*    ITEM NUMBER FOR THE NEW PAGE.  IF THE USER ATTEMPTS TO GO   *34690000
347000*    PAST THE END, ISSUE THE BOTTOM OF LIST MESSAGE.             *34700000
347100*----------------------------------------------------------------*34710000
347200                                                                  34720000
347300 2120-BROWSE-FORWARD.                                             34730000
347400                                                                  34740000
347500     ADD PC-ITEMS-PER-PANEL ASC-ITEM-AT-TOP-OF-PANEL              34750000
347600         GIVING PV-TOP-ITEM.                                      34760000
347700     IF  PV-TOP-ITEM > ASC-NUMBER-OF-ITEMS-READ                   34770000
347800         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            34780000
347900                                   TO PV-TOP-ITEM                 34790000
348000*        -- BOTTOM OF LIST --                                     34800000
348100         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            34810000
348200         SET DP020-MSG-INFORMATIONAL                              34820000
348300                                   TO TRUE                        34830000
348400     ELSE                                                         34840000
348500         COMPUTE PV-BOTTOM-ITEM =                                 34850000
348600             PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1                 34860000
348700         IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ            34870000
348800*            -- BOTTOM OF LIST --                                 34880000
348900             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            34890000
349000             SET DP020-MSG-INFORMATIONAL                          34900000
349100                                   TO TRUE                        34910000
349200         END-IF                                                   34920000
349300     END-IF.                                                      34930000
349400 EJECT                                                            34940000
349500*----------------------------------------------------------------*34950000
349600*    THE USER CAN CHANGE THE CURRENT BEGINNING LIST NUMBER SO    *34960000
349700*    THAT THE TRANSACTION WILL JUMP TO THAT POINT IN THE LIST.   *34970000
349800*    THIS IS A FASTER WAY TO GET TO A CERTAIN POINT IN THE LIST  *34980000
349900*    RATHER THAN HITTING NEXT-PAGE TO GET TO THAT POINT.         *34990000
350000*    THE NEW LIST NUMBER ENTERED IS EDITED TO MAKE SURE THAT     *35000000
350100*    IT IS NUMERIC AND FALLS BETWEEN A SPECIFIED RANGE.          *35010000
350200*----------------------------------------------------------------*35020000
350300                                                                  35030000
350400 2130-CHECK-FOR-JUMP-BROWSE.                                      35040000
350500     SET PS-NO-ERROR               TO TRUE.                       35050000
350600     IF (ASC-START-ITEM-REQUEST = SPACE)                          35060000
350700         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            35070000
350800                                   TO PV-TOP-ITEM                 35080000
350900     ELSE                                                         35090000
351000         MOVE ASC-START-ITEM-REQUEST                              35100000
351100                                   TO DP010I-UNEDITED-FIELD       35110000
351200         MOVE +0                   TO DP010I-MAXIMUM-DECIMALS     35120000
351300         MOVE LENGTH OF ASC-START-ITEM-REQUEST                    35130000
351400                                 TO DP010I-MAXIMUM-DIGITS         35140000
351500         SET DP010I-NEGATIVE-NOT-ALLOWED                          35150000
351600                                   TO TRUE                        35160000
263455         CALL DP010I-NUMERIC-EDIT-ROUTINE                         35171034
263455              USING DP010I-NUMERIC-EDIT-AREA                      35172034
351800                                                                  35180000
351900         IF  NOT DP010I-ERROR-DETECTED                            35190000
352000             MOVE DP010I-NUMERIC-FIELD                            35200000
352100                                   TO  ASC-START-ITEM-REQUEST-N   35210000
352200             IF  ASC-START-ITEM-REQUEST-N > ZERO                  35220000
352300                 IF  ASC-START-ITEM-REQUEST-N >                   35230000
352400                                          ASC-NUMBER-OF-ITEMS-READ35240000
352500                     MOVE SPACE TO ASC-START-ITEM-REQUEST         35250000
352600                     COMPUTE PV-TOP-ITEM =                        35260000
352700                             ASC-NUMBER-OF-ITEMS-READ             35270000
352800                             - PC-ITEMS-PER-PANEL + 1             35280000
352900                     IF  PV-TOP-ITEM < +1                         35290000
353000                         MOVE +1   TO PV-TOP-ITEM                 35300000
353100                         MOVE PC-TSYMSG-00070                     35310000
353200                                   TO DP020-MSG-NUMBER            35320000
353300                         SET DP020-MSG-INFORMATIONAL              35330000
353400                                   TO TRUE                        35340000
353500                     ELSE                                         35350000
353600                         MOVE  PV-TOP-ITEM                        35360000
353700                           TO  ASC-START-ITEM-REQUEST-N           35370000
353800                     END-IF                                       35380000
353900                 ELSE                                             35390000
354000                     MOVE ASC-START-ITEM-REQUEST-N                35400000
354100                                   TO PV-TOP-ITEM                 35410000
354200                     MOVE SPACE    TO ASC-START-ITEM-REQUEST      35420000
354300                     COMPUTE PV-BOTTOM-ITEM =                     35430000
354400                         PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1     35440000
354500                     IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ35450000
354600                         SUBTRACT  PV-TOP-ITEM                    35460000
354700                             FROM  ASC-NUMBER-OF-ITEMS-READ       35470000
354800                           GIVING  ASC-ITEMS-DISPLAYED            35480000
354900                         MOVE  ASC-NUMBER-OF-ITEMS-READ           35490000
355000                           TO  PV-BOTTOM-ITEM                     35500000
355100*                        -- BOTTOM OF LIST --                     35510000
355200                         MOVE PC-TSYMSG-00070                     35520000
355300                                   TO DP020-MSG-NUMBER            35530000
355400                         SET DP020-MSG-INFORMATIONAL              35540000
355500                                   TO TRUE                        35550000
355600                     END-IF                                       35560000
355700                 END-IF                                           35570000
355800             ELSE                                                 35580000
355900*                --- VALUE OUT OF RANGE ----                      35590000
356000                 MOVE PC-TSYMSG-00101                             35600000
356100                                   TO DP020-MSG-NUMBER            35610000
356200                 MOVE -1           TO ASTRTITL                    35620000
356300                 SET DP030-SET-CURSOR-APPL-1                      35630000
356400                                   TO TRUE                        35640000
356500                 MOVE DP015-REVERSE                               35650000
356600                                   TO ASTRTITH                    35660000
356700                 MOVE DP015-RED    TO ASTRTITC                    35670000
356800                 MOVE DP015-UNP-NUM-BRT-MDT                       35680000
356900                                   TO ASTRTITA                    35690000
357000                 SET DP020-MSG-FATAL                              35700000
357100                                   TO TRUE                        35710000
357200                 SET PS-ERROR      TO TRUE                        35720000
357300             END-IF                                               35730000
357400                                                                  35740000
357500         ELSE                                                     35750000
357600             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            35760000
357700             MOVE -1               TO ASTRTITL                    35770000
357800             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  35780000
357900             MOVE DP015-REVERSE    TO ASTRTITH                    35790000
358000             MOVE DP015-RED        TO ASTRTITC                    35800000
358100             MOVE DP015-UNP-NUM-BRT-MDT                           35810000
358200                                   TO ASTRTITA                    35820000
358300             SET DP020-MSG-FATAL   TO TRUE                        35830000
358400             SET PS-ERROR          TO TRUE                        35840000
358500         END-IF                                                   35850000
358600     END-IF.                                                      35860000
358700 EJECT                                                            35870000
358800*----------------------------------------------------------------*35880000
358900*    IF THE USER HITS THE DESELECT KEY, CLEAR THE SELECTION      *35890000
359000*    SWITCH FOR ALL ITEMS THAT WERE PREVIOUSLY SELECTED.         *35900000
359100*----------------------------------------------------------------*35910000
359200 2140-DESELECT-ALL-ITEMS.                                         35920000
359300     MOVE +1                       TO ASC-BLK-SUB.                35930000
359400                                                                  35940000
359500     PERFORM 2141-CLEAR-SELECTED-INDS                             35950000
359600         VARYING ASC-ITEM-SUB                                     35960000
359700         FROM 1 BY 1                                              35970000
359800         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 35980000
359900                                                                  35990000
360000     ADD +1                        TO ASC-BLK-SUB.                36000000
360100                                                                  36010000
360200     PERFORM 2141-CLEAR-SELECTED-INDS                             36020000
360300         VARYING ASC-ITEM-SUB                                     36030000
360400         FROM 1 BY 1                                              36040000
360500         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 36050000
360600                                                                  36060000
360700     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               36070000
360800                                   TO PV-LIST-ITEM-NUMBER.        36080000
360900                                                                  36090000
361000     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            36100000
361100         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    36110000
361200                                                                  36120000
361300     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     36130000
361400        (ASC-HIGHEST-BLOCK-WRITTEN > PC-MAX-BLOCKS-IN-ARRAY)      36140000
361500         MOVE +1                   TO ASC-BLK-SUB                 36150000
361600                                                                  36160000
361700         PERFORM 5100-WRITE-TEMP-STORAGE                          36170000
361800                                                                  36180000
361900         MOVE +1                   TO PV-BLOCK-NUMBER             36190000
362000                                                                  36200000
362100         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         36210000
362200             PV-FIRST-BLOCK-IN-ARRAY - 1                          36220000
362300                                                                  36230000
362400         PERFORM                                                  36240000
362500             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       36250000
362600                                                                  36260000
362700             PERFORM 4410-READ-TEMP-STORAGE                       36270000
362800                                                                  36280000
362900             PERFORM 2141-CLEAR-SELECTED-INDS                     36290000
363000                 VARYING ASC-ITEM-SUB FROM 1 BY 1                 36300000
363100                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          36310000
363200                                                                  36320000
363300             PERFORM 5100-WRITE-TEMP-STORAGE                      36330000
363400                                                                  36340000
363500             ADD +1                TO PV-BLOCK-NUMBER             36350000
363600                                                                  36360000
363700         END-PERFORM                                              36370000
363800                                                                  36380000
363900         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         36390000
364000             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     36400000
364100                                                                  36410000
364200         PERFORM                                                  36420000
364300             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       36430000
364400                   ASC-HIGHEST-BLOCK-WRITTEN                      36440000
364500                                                                  36450000
364600             MOVE PV-NEXT-BLOCK-IN-ARRAY                          36460000
364700                                   TO PV-BLOCK-NUMBER             36470000
364800                                                                  36480000
364900             PERFORM 4410-READ-TEMP-STORAGE                       36490000
365000                                                                  36500000
365100             PERFORM 2141-CLEAR-SELECTED-INDS                     36510000
365200                 VARYING ASC-ITEM-SUB                             36520000
365300                 FROM 1 BY 1                                      36530000
365400                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          36540000
365500                                                                  36550000
365600             PERFORM 5100-WRITE-TEMP-STORAGE                      36560000
365700                                                                  36570000
365800             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      36580000
365900                                                                  36590000
366000         END-PERFORM                                              36600000
366100                                                                  36610000
366200         MOVE PV-FIRST-BLOCK-IN-ARRAY                             36620000
366300                                   TO PV-BLOCK-NUMBER             36630000
366400                                                                  36640000
366500         PERFORM 4410-READ-TEMP-STORAGE                           36650000
366600     END-IF.                                                      36660000
366700                                                                  36670000
366800     MOVE +0                      TO ASC-NUMBER-OF-SELECTED-ITEMS.36680000
366900     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE.36690000
367000     MOVE +0                       TO ASC-END-OF-SELECTED-RANGE.  36700000
367100                                                                  36710000
367200     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        36720000
367300                                                                  36730000
367400 EJECT                                                            36740000
367500*----------------------------------------------------------------*36750000
367600*    MARK EACH ITEM AS BEING NOT SELECTED.                       *36760000
367700*----------------------------------------------------------------*36770000
367800                                                                  36780000
367900 2141-CLEAR-SELECTED-INDS.                                        36790000
368000                                                                  36800000
368100     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           36810000
368200             NOT EQUAL ZERO                                       36820000
368300         IF  NOT ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          36830000
368400             SET ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          36840000
368500                 ASC-TEMP-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)    36850000
368600                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  36860000
368700                                   TO TRUE                        36870000
368800         END-IF                                                   36880000
368900     END-IF.                                                      36890000
369000                                                                  36900000
369100 EJECT                                                            36910000
369200*----------------------------------------------------------------*36920000
369300*  IF THE USER HITS THE SELECT-ALL KEY, SET THE SELECTIO SWITCH  *36930000
369400*  FOR ALL ITEMS.                                                *36940000
369500*----------------------------------------------------------------*36950000
369600                                                                  36960000
369700 2150-SELECT-ALL-ITEMS.                                           36970000
369800                                                                  36980000
369900     MOVE +1                       TO ASC-BLK-SUB.                36990000
370000                                                                  37000000
370100     PERFORM 2151-SET-SELECTED-INDS                               37010000
370200         VARYING ASC-ITEM-SUB                                     37020000
370300         FROM 1 BY 1                                              37030000
370400         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 37040000
370500                                                                  37050000
370600     ADD +1                        TO ASC-BLK-SUB.                37060000
370700                                                                  37070000
370800     PERFORM 2151-SET-SELECTED-INDS                               37080000
370900         VARYING ASC-ITEM-SUB                                     37090000
371000         FROM 1 BY 1                                              37100000
371100         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 37110000
371200                                                                  37120000
371300     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               37130000
371400                                   TO PV-LIST-ITEM-NUMBER.        37140000
371500                                                                  37150000
371600     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            37160000
371700         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    37170000
371800                                                                  37180000
371900* 2/18/00 - BEGIN                                                 37190000
372000     IF  PV-FIRST-BLOCK-IN-ARRAY  = +1                            37200000
372100         MOVE +1                   TO ASC-BLK-SUB                 37210000
372200                                                                  37220000
372300         PERFORM 5100-WRITE-TEMP-STORAGE                          37230000
372400         MOVE +2                   TO ASC-BLK-SUB                 37240000
372500         PERFORM 5100-WRITE-TEMP-STORAGE                          37250000
372600         MOVE +1                   TO ASC-BLK-SUB                 37260000
372700         MOVE +1                   TO PV-BLOCK-NUMBER             37270000
372800     END-IF.                                                      37280000
372900* 2/18/00 - END                                                   37290000
373000                                                                  37300000
373100     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     37310000
373200        (ASC-HIGHEST-BLOCK-WRITTEN >   PC-MAX-BLOCKS-IN-ARRAY)    37320000
373300         MOVE +1                   TO ASC-BLK-SUB                 37330000
373400                                                                  37340000
373500         PERFORM 5100-WRITE-TEMP-STORAGE                          37350000
373600                                                                  37360000
373700         MOVE +1                   TO PV-BLOCK-NUMBER             37370000
373800                                                                  37380000
373900         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         37390000
374000             PV-FIRST-BLOCK-IN-ARRAY - 1                          37400000
374100                                                                  37410000
374200         PERFORM                                                  37420000
374300             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       37430000
374400                                                                  37440000
374500             PERFORM 4410-READ-TEMP-STORAGE                       37450000
374600                                                                  37460000
374700             PERFORM 2151-SET-SELECTED-INDS                       37470000
374800                 VARYING ASC-ITEM-SUB                             37480000
374900                 FROM 1 BY 1                                      37490000
375000                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          37500000
375100                                                                  37510000
375200             PERFORM 5100-WRITE-TEMP-STORAGE                      37520000
375300                                                                  37530000
375400             ADD +1                TO PV-BLOCK-NUMBER             37540000
375500                                                                  37550000
375600         END-PERFORM                                              37560000
375700                                                                  37570000
375800         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         37580000
375900             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     37590000
376000                                                                  37600000
376100         PERFORM                                                  37610000
376200             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       37620000
376300                   ASC-HIGHEST-BLOCK-WRITTEN                      37630000
376400                                                                  37640000
376500             MOVE PV-NEXT-BLOCK-IN-ARRAY                          37650000
376600                                   TO PV-BLOCK-NUMBER             37660000
376700                                                                  37670000
376800             PERFORM 4410-READ-TEMP-STORAGE                       37680000
376900                                                                  37690000
377000             PERFORM 2151-SET-SELECTED-INDS                       37700000
377100                 VARYING ASC-ITEM-SUB                             37710000
377200                 FROM 1 BY 1                                      37720000
377300                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          37730000
377400                                                                  37740000
377500             PERFORM 5100-WRITE-TEMP-STORAGE                      37750000
377600                                                                  37760000
377700             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      37770000
377800                                                                  37780000
377900         END-PERFORM                                              37790000
378000                                                                  37800000
378100         MOVE PV-FIRST-BLOCK-IN-ARRAY                             37810000
378200                                   TO PV-BLOCK-NUMBER             37820000
378300                                                                  37830000
378400         PERFORM 4410-READ-TEMP-STORAGE                           37840000
378500     END-IF.                                                      37850000
378600                                                                  37860000
378700                                                                  37870000
378800     MOVE ASC-NUMBER-OF-ITEMS-READ TO                             37880000
378900                       ASC-NUMBER-OF-SELECTED-ITEMS.              37890000
379000                                                                  37900000
379100     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        37910000
379200                                                                  37920000
379300 EJECT                                                            37930000
379400*----------------------------------------------------------------*37940000
379500*    MARK EACH ITEM AS BEING SELECTED.                           *37950000
379600*----------------------------------------------------------------*37960000
379700                                                                  37970000
379800 2151-SET-SELECTED-INDS.                                          37980000
379900                                                                  37990000
380000     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           38000000
380100             NOT EQUAL ZERO                                       38010000
380200         IF  NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             38020000
380300             SET ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             38030000
380400                 ASC-TEMP-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)        38040000
380500                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  38050000
380600                               TO  TRUE                           38060000
380700         END-IF                                                   38070000
380800     END-IF.                                                      38080000
380900******************************************************************38090000
381000** MOVE ALL OF THE FIELDS THAT WERE ENTERED / CHANGED ON THE    **38100000
381100** SCREEN INTO THE COMMAREA.  ALL EDITTING IS DONE IN THE COMM. **38110000
381200******************************************************************38120000
381300 2200-MOVE-SCREEN-TO-COMMAREA.                                    38130000
381400                                                                  38140000
381500     MOVE PV-TOP-ITEM              TO PV-ITEM-IN-USE.             38150000
381600     MOVE +1                       TO PV-SUB.                     38160000
381700*                                                                 38170000
381800     PERFORM 3100-SET-SUBSCRIPTS.                                 38180000
381900     IF  ASTRTITL > ZERO                                          38190000
382000         MOVE ASTRTITI         TO ASC-START-ITEM-REQUEST          38200000
382100     ELSE                                                         38210000
382200         IF  ASTRTITF = DP015-ERASE-EOF                           38220000
382300             INITIALIZE ASC-START-ITEM-REQUEST                    38230000
382400         END-IF                                                   38240000
382500     END-IF.                                                      38250000
382600                                                                  38260000
383500     PERFORM 2210-MOVE-LINES-TO-COMMAREA                          38350000
383600         VARYING PV-SUB                                           38360000
383700         FROM 1 BY 1                                              38370000
383800         UNTIL PV-SUB > ASC-ITEMS-DISPLAYED.                      38380000
383900******************************************************************38390000
384000** MOVE THE ENTERABLE FIELDS ON EACH LIST LINE INTO THE COMMAREA**38400000
384100******************************************************************38410000
384200 2210-MOVE-LINES-TO-COMMAREA.                                     38420000
384300     IF  MR-SELECTL (PV-SUB) > ZERO                               38430000
384400         SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE             38440000
384500         MOVE MR-SELECTI (PV-SUB)                                 38450000
384600                                   TO ASC-TEMP-SELECTED-SW        38460000
384700                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      38470000
384800     ELSE                                                         38480000
384900         IF  MR-SELECTA (PV-SUB) = DP015-ERASE-EOF                38490000
385000                 SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE     38500000
385100                 MOVE SPACE        TO ASC-TEMP-SELECTED-SW        38510000
385200                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      38520000
385300         END-IF                                                   38530000
385400     END-IF.                                                      38540000
385500     ADD +1                        TO ASC-ITEM-SUB.               38550000
385600     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        38560000
385700         ADD +1                    TO ASC-BLK-SUB                 38570000
385800         MOVE +1                   TO ASC-ITEM-SUB                38580000
385900     END-IF.                                                      38590000
385910                                                                  38591000
385920                                                                  38592000
386000******************************************************************38600000
386100** EDIT ALL OF THE DATA ON THE SCREEN AS IT RESIDES IN THE      **38610000
386200** COMMAREA (EDITTING IS NOT DONE AGAINST THE SCREEN DIRECTLY). **38620000
386300******************************************************************38630000
386400 3000-EDIT-DATA-IN-COMMAREA.                                      38640000
386500     SET PS-NO-ERROR               TO TRUE.                       38650000
386600     PERFORM 3200-RESET-ATTRIBUTES.                               38660000
386700     MOVE ASC-ITEMS-DISPLAYED      TO PV-SUB.                     38670000
386800                                                                  38680000
391100*                                                                 39110000
391200* CALCULATE THE POSITION OF THE LAST ITEM DISPLAYED.              39120000
391300* EDITTING IS DONE FROM THE BOTTOM UP.                            39130000
391400*                                                                 39140000
391500     COMPUTE PV-ITEM-IN-USE = PV-TOP-ITEM +                       39150000
391600         ASC-ITEMS-DISPLAYED - 1.                                 39160000
391700     PERFORM 3100-SET-SUBSCRIPTS.                                 39170000
391800                                                                  39180000
391900     IF  PS-NO-ERROR                                              39190000
392000         PERFORM 3005-EDIT-COMMAREA-BLOCKS                        39200000
392100     END-IF.                                                      39210000
392200                                                                  39220000
392300     IF  PS-NO-ERROR                                              39230000
392400         PERFORM 3400-CHECK-RANGE-SEQUENCE                        39240000
392500     END-IF.                                                      39250000
392600*                                                                 39260000
392700     IF  ((PS-NO-ERROR)                                           39270000
392800       AND (ASC-START-OF-SELECTED-RANGE > ZERO)                   39280000
392900       AND (ASC-END-OF-SELECTED-RANGE > ZERO))                    39290000
393000             PERFORM 3500-MARK-RANGE-AS-SELECTED                  39300000
393100     END-IF.                                                      39310000
393200                                                                  39320000
393300*----------------------------------------------------------------*39330000
393400*   3005-EDIT-COMMAREA-BLOCKS                                    *39340000
393500*----------------------------------------------------------------*39350000
393600 3005-EDIT-COMMAREA-BLOCKS.                                       39360000
393700     MOVE +1                       TO PV-BLOCK-NUMBER.            39370000
393800     MOVE +1                       TO ASC-BLK-SUB.                39380000
393900     MOVE PC-ITEMS-PER-PANEL       TO ASC-ITEM-SUB.               39390000
394000                                                                  39400000
394100     COMPUTE PV-BLOCK-NUMBER  =                                   39410000
394200        1 + ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) /                 39420000
394300            PC-ITEMS-PER-PANEL.                                   39430000
394400                                                                  39440000
394500     MOVE  PV-BLOCK-NUMBER         TO PV-ORIGINAL-BLOCK.          39450000
394600                                                                  39460000
394700     PERFORM                                                      39470000
394800       UNTIL PV-BLOCK-NUMBER > ASC-HIGHEST-BLOCK-WRITTEN          39480000
394900          OR PS-ERROR                                             39490000
395000          OR PS-BLOCK-ERROR                                       39500000
395100                                                                  39510000
395200             COMPUTE PV-ITEMS-HOLD  =                             39520000
395300                     ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) +        39530000
395400                     PC-ITEMS-PER-PANEL - 1                       39540000
395500                                                                  39550000
395600             IF  PV-ITEMS-HOLD  >  ASC-NUMBER-OF-ITEMS-READ       39560000
395700                 SUBTRACT  ASC-NUMBER-OF-ITEMS-READ               39570000
395800                     FROM  PV-ITEMS-HOLD                          39580000
395900                   GIVING  PV-ITEMS-DIFF                          39590000
396000                 SUBTRACT  PV-ITEMS-DIFF                          39600000
396100                     FROM  PC-ITEMS-PER-PANEL                     39610000
396200                   GIVING  PV-ITEMS-HOLD                          39620000
396300                     MOVE  PV-ITEMS-HOLD  TO  PV-SUB              39630000
396400                                              ASC-ITEM-SUB        39640000
396500                                              ASC-ITEMS-DISPLAYED 39650000
396600             ELSE                                                 39660000
396700                 MOVE ASC-ITEMS-DISPLAYED  TO PV-SUB              39670000
396800                 MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB        39680000
396900             END-IF                                               39690000
397000                                                                  39700000
397100             PERFORM 3300-EDIT-SELECTIONS                         39710000
397200                     VARYING PV-SUB                               39720000
397300                        FROM PV-SUB BY -1                         39730000
397400                       UNTIL PV-SUB < +1                          39740000
397500                                                                  39750000
397600             MOVE +1               TO ASC-BLK-SUB                 39760000
397700                                                                  39770000
397800             PERFORM 5105-REWRITE-ASC-LISTQ                       39780000
397900                                                                  39790000
398000             MOVE +1                TO ASC-BLK-SUB                39800000
398100                                                                  39810000
398200             IF  PS-BLOCK-ERROR                                   39820000
398300                 SET  PS-ERROR     TO TRUE                        39830000
398400                 MOVE ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB 1)        39840000
398500                                   TO PV-TOP-ITEM                 39850000
398600             ELSE                                                 39860000
398700                 ADD  +1           TO PV-BLOCK-NUMBER             39870000
398800                 IF  PV-BLOCK-NUMBER >                            39880000
398900                     ASC-HIGHEST-BLOCK-WRITTEN                    39890000
399000                     MOVE +2       TO ASC-BLK-SUB                 39900000
399100                     PERFORM 4410-READ-TEMP-STORAGE               39910000
399200                     MOVE +1       TO ASC-BLK-SUB                 39920000
399300                 ELSE                                             39930000
399400                     PERFORM 4410-READ-TEMP-STORAGE               39940000
399500                     ADD  +1        TO PV-BLOCK-NUMBER            39950000
399600                     MOVE +2        TO ASC-BLK-SUB                39960000
399700                     PERFORM 4410-READ-TEMP-STORAGE               39970000
399800                     SUBTRACT +1  FROM PV-BLOCK-NUMBER            39980000
399900                     MOVE +1        TO ASC-BLK-SUB                39990000
400000                 END-IF                                           40000000
400100             END-IF                                               40010000
400200     END-PERFORM.                                                 40020000
400300                                                                  40030000
400400     IF  PV-ORIGINAL-BLOCK  = +1    OR                            40040000
400500         PS-ERROR                   OR                            40050000
400600         PS-BLOCK-ERROR                                           40060000
400700         CONTINUE                                                 40070000
400800     ELSE                                                         40080000
400900         MOVE +1                 TO PV-BLOCK-NUMBER               40090000
401000         MOVE +1                 TO ASC-BLK-SUB                   40100000
401100         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  40110000
401200         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEMS-DISPLAYED           40120000
401300         PERFORM 4410-READ-TEMP-STORAGE                           40130000
401400                                                                  40140000
401500         PERFORM                                                  40150000
401600           UNTIL PV-BLOCK-NUMBER = PV-ORIGINAL-BLOCK              40160000
401700              OR PS-ERROR                                         40170000
401800              OR PS-BLOCK-ERROR                                   40180000
401900                                                                  40190000
402000                 COMPUTE PV-ITEMS-HOLD  =                         40200000
402100                         ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) +    40210000
402200                         PC-ITEMS-PER-PANEL - 1                   40220000
402300                                                                  40230000
402400                 IF  PV-ITEMS-HOLD > ASC-NUMBER-OF-ITEMS-READ     40240000
402500                     SUBTRACT  ASC-NUMBER-OF-ITEMS-READ           40250000
402600                         FROM  PV-ITEMS-HOLD                      40260000
402700                       GIVING  PV-ITEMS-DIFF                      40270000
402800                     SUBTRACT  PV-ITEMS-DIFF                      40280000
402900                         FROM  PC-ITEMS-PER-PANEL                 40290000
403000                       GIVING  PV-ITEMS-HOLD                      40300000
403100                         MOVE  PV-ITEMS-HOLD TO PV-SUB            40310000
403200                                                ASC-ITEM-SUB      40320000
403300                                               ASC-ITEMS-DISPLAYED40330000
403400                 ELSE                                             40340000
403500                     MOVE ASC-ITEMS-DISPLAYED  TO PV-SUB          40350000
403600                     MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB    40360000
403700                 END-IF                                           40370000
403800                                                                  40380000
403900                 PERFORM 3300-EDIT-SELECTIONS                     40390000
404000                         VARYING PV-SUB                           40400000
404100                            FROM PV-SUB BY -1                     40410000
404200                           UNTIL PV-SUB < +1                      40420000
404300                                                                  40430000
404900                 MOVE +1               TO ASC-BLK-SUB             40490000
405000                                                                  40500000
405100                 PERFORM 5105-REWRITE-ASC-LISTQ                   40510000
405200                                                                  40520000
405300                 MOVE +1                TO ASC-BLK-SUB            40530000
405400                                                                  40540000
405500                 IF  PS-BLOCK-ERROR                               40550000
405600                     SET  PS-ERROR     TO TRUE                    40560000
405700                     MOVE ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB 1)    40570000
405800                                       TO PV-TOP-ITEM             40580000
405900                 ELSE                                             40590000
406000                     ADD  +1            TO PV-BLOCK-NUMBER        40600000
406100                     IF  PV-BLOCK-NUMBER = PV-ORIGINAL-BLOCK      40610000
406200                         MOVE +2        TO ASC-BLK-SUB            40620000
406300                         PERFORM 4410-READ-TEMP-STORAGE           40630000
406400                         MOVE +1        TO ASC-BLK-SUB            40640000
406500                     ELSE                                         40650000
406600                         PERFORM 4410-READ-TEMP-STORAGE           40660000
406700                         ADD  +1        TO PV-BLOCK-NUMBER        40670000
406800                         MOVE +2        TO ASC-BLK-SUB            40680000
406900                         PERFORM 4410-READ-TEMP-STORAGE           40690000
407000                         SUBTRACT +1  FROM PV-BLOCK-NUMBER        40700000
407100                         MOVE +1        TO ASC-BLK-SUB            40710000
407200                     END-IF                                       40720000
407300                 END-IF                                           40730000
407400     END-PERFORM.                                                 40740000
407500                                                                  40750000
407600                                                                  40760000
419600*----------------------------------------------------------------*41960000
419700*    DETERMINE THE VALUE OF THE ITEM SUBSCRIPT BASED ON THE ITEM *41970000
419800*    CURRENTLY IN USE AND THE FIRST ITEM IN THE ARRAY.  THIS WILL*41980000
419900*    POSITION US IN THE 1ST BLOCK OF THE ARRAY.                  *41990000
420000*                                                                *42000000
420100*    IF THE ITEM SUBSCRIPT EXCEEDS THE MAXIMUM NUMBER OF ITEMS   *42010000
420200*    IN A BLOCK, RECALCULATE THE SUBSCRIPT BY SUBTRACTING OUT    *42020000
420300*    THE MAXIMUM NUMBER OF ITEMS.  THIS WILL CORRECTLY POSITION  *42030000
420400*    US IN THE 2ND BLOCK OF THE ARRAY.                           *42040000
420500*----------------------------------------------------------------*42050000
420600                                                                  42060000
420700 3100-SET-SUBSCRIPTS.                                             42070000
420800                                                                  42080000
420900     COMPUTE ASC-ITEM-SUB =                                       42090000
421000         (PV-ITEM-IN-USE - ASC-LIST-ITEM-NUMBER(1 1)) + 1.        42100000
421100                                                                  42110000
421200     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         42120000
421300         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            42130000
421400                                                                  42140000
421500         MOVE PC-MAX-BLOCKS-IN-ARRAY TO ASC-BLK-SUB               42150000
421600     ELSE                                                         42160000
421700         MOVE +1                     TO ASC-BLK-SUB               42170000
421800     END-IF.                                                      42180000
421900******************************************************************42190000
422000** RESET THE ATTRIBUTES OF ALL ENTERABLE FIELDS ON THE MAP.     **42200000
422100******************************************************************42210000
422200                                                                  42220000
422300 3200-RESET-ATTRIBUTES.                                           42230000
422400     MOVE DP015-UNP-ALP-NOR-OFF    TO ASTRTITA.                   42240006
422600     MOVE DP015-GREEN              TO ASTRTITC.                   42260006
422800     MOVE DP015-UNDERLINE          TO ASTRTITH.                   42280006
423000*                                                                 42300000
423100     PERFORM                                                      42310000
423200         VARYING PV-SUB                                           42320000
423300         FROM 1 BY 1                                              42330000
423400         UNTIL PV-SUB > PC-ITEMS-PER-PANEL                        42340000
423500         MOVE DP015-UNP-ALP-NOR-OFF                               42350000
423600                                   TO MR-SELECTA (PV-SUB)         42360000
423700         MOVE DP015-GREEN          TO MR-SELECTC (PV-SUB)         42370000
423800         MOVE DP015-UNDERLINE      TO MR-SELECTH (PV-SUB)         42380000
424200     END-PERFORM.                                                 42420000
424300******************************************************************42430000
424400** EDIT THE SELECTIONS MADE.  NOTE THAT THE 'SELECTED-SW' IS    **42440000
424500** WHAT WAS PREVIOUSLY CHECKED AND CORRECT 'TEMP-SELECTED-SW'   **42450000
424600** IS WHAT HAS JUST BEEN ENTERED AND HAS NOT BEEN EDITTED OR    **42460000
424700** WAS ENTERED EARLIER, BUT DID NOT PASS THE EDITS.             **42470000
424800******************************************************************42480000
424900 3300-EDIT-SELECTIONS.                                            42490020
425000     EVALUATE TRUE                                                42500000
425100         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     42510000
425200             = ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)         42520000
425300                 CONTINUE                                         42530000
425400         WHEN ASC-TEMP-SELECT  (ASC-BLK-SUB ASC-ITEM-SUB)         42540000
425500             IF  NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)        42550000
425600                 ADD +1         TO ASC-NUMBER-OF-SELECTED-ITEMS   42560000
425700                 MOVE ASC-TEMP-SELECTED-SW                        42570000
425800                                      (ASC-BLK-SUB ASC-ITEM-SUB)  42580000
425900                                TO ASC-SELECTED-SW                42590000
426000                                      (ASC-BLK-SUB ASC-ITEM-SUB)  42600000
426100             END-IF                                               42610000
426200         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     42620000
426300                 = SPACE                                          42630000
426400             EVALUATE TRUE                                        42640000
426500                 WHEN ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)       42650000
426600                     SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS42660000
426700                     MOVE SPACE TO ASC-SELECTED-SW                42670000
426800                                      (ASC-BLK-SUB ASC-ITEM-SUB)  42680000
426900                 WHEN ASC-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)        42690000
427000                     MOVE ZERO  TO ASC-START-OF-SELECTED-RANGE    42700000
427100                     MOVE SPACE TO ASC-SELECTED-SW                42710000
427200                                      (ASC-BLK-SUB ASC-ITEM-SUB)  42720000
427300                 WHEN ASC-END (ASC-BLK-SUB ASC-ITEM-SUB)          42730000
427400                     MOVE ZERO  TO ASC-END-OF-SELECTED-RANGE      42740000
427500                     MOVE SPACE TO ASC-SELECTED-SW                42750000
427600                                      (ASC-BLK-SUB ASC-ITEM-SUB)  42760000
427700             END-EVALUATE                                         42770000
427800         WHEN ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)           42780000
427900             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            42790000
428000                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    42800000
428100             END-IF                                               42810000
428200             PERFORM 3310-EDIT-RANGE                              42820000
428300         WHEN ASC-TEMP-END (ASC-BLK-SUB ASC-ITEM-SUB)             42830000
428400             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            42840000
428500                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    42850000
428600             END-IF                                               42860000
428700             PERFORM 3310-EDIT-RANGE                              42870000
428800         WHEN OTHER                                               42880000
428900             MOVE PC-TSYMSG-00005   TO DP020-MSG-NUMBER           42890000
429000             SET DP020-MSG-FATAL    TO TRUE                       42900000
429100             MOVE -1                TO MR-SELECTL (PV-SUB)        42910000
429200             SET DP030-SET-CURSOR-APPL-1                          42920000
429300                                    TO TRUE                       42930000
429400             MOVE DP015-RED         TO MR-SELECTC (PV-SUB)        42940000
429500             MOVE DP015-REVERSE     TO MR-SELECTH (PV-SUB)        42950000
429600             SET PS-ERROR TO TRUE                                 42960000
429700             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            42970000
429800                 SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS     42980000
429900                 MOVE SPACE         TO ASC-SELECTED-SW            42990000
430000                                        (ASC-BLK-SUB ASC-ITEM-SUB)43000000
430100             END-IF                                               43010000
430200     END-EVALUATE.                                                43020000
432900                                                                  43290000
433000     SUBTRACT +1             FROM PV-ITEM-IN-USE.                 43300000
433100     SUBTRACT +1 FROM ASC-ITEM-SUB.                               43310000
433200     IF  ASC-ITEM-SUB < 1                                         43320000
433300         SUBTRACT +1 FROM ASC-BLK-SUB                             43330000
433400         MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB                43340000
433500     END-IF.                                                      43350000
433600******************************************************************43360000
433700** IF A BEGINNING AND END OF RANGE WAS ENTERED TO SELECT A      **43370000
433800** RANGE OF LINES, MAKE SURE THERE IS ONLY 1 BEGINNING AND 1    **43380000
433900** ENDING AND MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN)**43390000
434000** THE ENDING.                                                  **43400000
434100******************************************************************43410000
434200 3310-EDIT-RANGE.                                                 43420000
434300     IF  ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)                43430000
434400         IF  ASC-START-OF-SELECTED-RANGE = ZERO                   43440000
434500             MOVE ASC-TEMP-SELECTED-SW  (ASC-BLK-SUB ASC-ITEM-SUB)43450000
434600                                   TO ASC-SELECTED-SW             43460000
434700                                        (ASC-BLK-SUB ASC-ITEM-SUB)43470000
434800             MOVE PV-ITEM-IN-USE   TO ASC-START-OF-SELECTED-RANGE 43480000
434900         ELSE                                                     43490000
435000             IF  ASC-START-OF-SELECTED-RANGE = PV-ITEM-IN-USE     43500000
435100                 CONTINUE                                         43510000
435200             ELSE                                                 43520000
435300*                -- ONLY ONE BEGINNING-OF-RANGE-ALLOWED --        43530000
435400                 MOVE PC-TSYMSG-00054                             43540000
435500                                   TO DP020-MSG-NUMBER            43550000
435600                 SET DP020-MSG-FATAL                              43560000
435700                                   TO TRUE                        43570000
435800                 MOVE -1           TO MR-SELECTL (PV-SUB)         43580000
435900                 SET DP030-SET-CURSOR-APPL-1                      43590000
436000                                   TO TRUE                        43600000
436100                 MOVE DP015-RED    TO MR-SELECTC (PV-SUB)         43610000
436200                 MOVE DP015-UNDERLINE                             43620000
436300                                   TO MR-SELECTH (PV-SUB)         43630000
436400                 SET PS-ERROR      TO TRUE                        43640000
436500             END-IF                                               43650000
436600         END-IF                                                   43660000
436700     ELSE                                                         43670000
436800         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     43680000
436900             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 43690000
437000                                   TO ASC-SELECTED-SW             43700000
437100                                     (ASC-BLK-SUB ASC-ITEM-SUB)   43710000
437200             MOVE PV-ITEM-IN-USE   TO ASC-END-OF-SELECTED-RANGE   43720000
437300         ELSE                                                     43730000
437400             IF  ASC-END-OF-SELECTED-RANGE = PV-ITEM-IN-USE       43740000
437500                 CONTINUE                                         43750000
437600             ELSE                                                 43760000
437700*                -- ONLY ONE END-OF-RANGE ALLOWED --              43770000
437800                 MOVE PC-TSYMSG-00055                             43780000
437900                                   TO DP020-MSG-NUMBER            43790000
438000                 SET DP020-MSG-FATAL                              43800000
438100                                   TO TRUE                        43810000
438200                 MOVE -1           TO MR-SELECTL (PV-SUB)         43820000
438300                 SET DP030-SET-CURSOR-APPL-1                      43830000
438400                                   TO TRUE                        43840000
438500                 SET PS-ERROR      TO TRUE                        43850000
438600             END-IF                                               43860000
438700         END-IF                                                   43870000
438800     END-IF.                                                      43880000
438900                                                                  43890000
452099******************************************************************45209900
452100** IF BOTH A BEGINNING AND END OF RANGE HAVE BEEN SPECIFIED,    **45210000
452101** MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN) THE END.  **45210100
452102******************************************************************45210200
452103 3400-CHECK-RANGE-SEQUENCE.                                       45210300
452104     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       45210400
452105       AND  ASC-END-OF-SELECTED-RANGE > ZERO                      45210500
452106       AND  ASC-START-OF-SELECTED-RANGE >                         45210600
452107                                         ASC-END-OF-SELECTED-RANGE45210700
452108*        -- END-OF-RANGE BEFORE BEGINNING-OF-RANGE                45210800
452109         MOVE PC-TSYMSG-00052 TO DP020-MSG-NUMBER                 45210900
452110         SET DP020-MSG-FATAL TO TRUE                              45211000
452120         SET PS-ERROR TO TRUE                                     45212000
452130         PERFORM 3410-POSITION-AT-ERROR                           45213000
452140     END-IF.                                                      45214000
452141                                                                  45214100
452142                                                                  45214200
452150******************************************************************45215000
452160** BECAUSE RANGES CAN SPAN ACROSS MULTIPLE PAGES, A SEPARATE    **45216000
452170** PARAGRAPH (THIS ONE) IS NEEDED TO DETERMINE WHERE THE CURSOR **45217000
452180** SHOULD BE POSITIONED ON A RANGE ERROR.                       **45218000
452190******************************************************************45219000
452200 3410-POSITION-AT-ERROR.                                          45220000
452300     SET DP030-SET-CURSOR-APPL-1                                  45230000
452400                                   TO TRUE.                       45240000
452500     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 45250000
452600                    - PV-TOP-ITEM + 1.                            45260000
452700     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      45270000
452800         CONTINUE                                                 45280000
452900     ELSE                                                         45290000
453000         MOVE -1                   TO MR-SELECTL (PV-SUB)         45300000
453100         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         45310000
453200         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         45320000
453300     END-IF.                                                      45330000
453400*                                                                 45340000
453500     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   45350000
453600                    - PV-TOP-ITEM + 1.                            45360000
453700     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      45370000
453800         CONTINUE                                                 45380000
453900     ELSE                                                         45390000
454000         MOVE -1                   TO MR-SELECTL (PV-SUB)         45400000
454100         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         45410000
454200         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         45420000
454300     END-IF.                                                      45430000
454400 EJECT                                                            45440000
454500*----------------------------------------------------------------*45450000
454600*    WHENEVER THE USER SELECTS AN ITEM AS THE BEGINNING RANGE    *45460000
454700*    AND ONE AS THE ENDING RANGE, MARK THESE ITEMS AS WELL AS    *45470000
454800*    THOSE THAT FALL IN THE RANGE AS BEING SELECTED.             *45480000
454900*----------------------------------------------------------------*45490000
455000                                                                  45500000
455100 3500-MARK-RANGE-AS-SELECTED.                                     45510000
455200     MOVE +1                       TO  ASC-BLK-SUB.               45520000
455300     PERFORM 3510-MARK-SELECTED-INDS                              45530000
455400         VARYING ASC-ITEM-SUB                                     45540000
455500         FROM 1 BY 1                                              45550000
455600         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 45560000
455700                                                                  45570000
455800     ADD +1                        TO ASC-BLK-SUB.                45580000
455900     PERFORM 3510-MARK-SELECTED-INDS                              45590000
456000         VARYING ASC-ITEM-SUB                                     45600000
456100         FROM 1 BY 1                                              45610000
456200         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 45620000
456300                                                                  45630000
456400     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               45640000
456500                                   TO  PV-LIST-ITEM-NUMBER.       45650000
456600     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            45660000
456700         1 + ((PV-LIST-ITEM-NUMBER - 1) /                         45670000
456800               PC-ITEMS-PER-PANEL).                               45680000
456900                                                                  45690000
457000     MOVE ASC-START-OF-SELECTED-RANGE                             45700000
457100                                   TO PV-START-OF-SELECTED-RANGE. 45710000
457200     COMPUTE PV-FIRST-BLOCK-IN-RANGE =                            45720000
457300         1 + ((PV-START-OF-SELECTED-RANGE - 1) /                  45730000
457400               PC-ITEMS-PER-PANEL).                               45740000
457500                                                                  45750000
457600     MOVE ASC-END-OF-SELECTED-RANGE                               45760000
457700                                   TO  PV-END-OF-SELECTED-RANGE.  45770000
457800     COMPUTE PV-LAST-BLOCK-IN-RANGE =                             45780000
457900         1 + ((PV-END-OF-SELECTED-RANGE - 1) /                    45790000
458000               PC-ITEMS-PER-PANEL).                               45800000
458100     COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                             45810000
458200         PV-FIRST-BLOCK-IN-ARRAY + 1.                             45820000
458300                                                                  45830000
458400     IF (PV-FIRST-BLOCK-IN-RANGE < PV-FIRST-BLOCK-IN-ARRAY) OR    45840000
458500        (PV-LAST-BLOCK-IN-RANGE  > PV-NEXT-BLOCK-IN-ARRAY)        45850000
458600         MOVE +1                   TO ASC-BLK-SUB                 45860000
458700         PERFORM 5100-WRITE-TEMP-STORAGE                          45870000
458800         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         45880000
458900             PV-FIRST-BLOCK-IN-ARRAY - 1                          45890000
459000                                                                  45900000
459100         PERFORM                                                  45910000
459200             UNTIL PV-FIRST-BLOCK-IN-RANGE >                      45920000
459300                   PV-PREV-BLOCK-IN-ARRAY                         45930000
459400             MOVE PV-FIRST-BLOCK-IN-RANGE                         45940000
459500                                   TO PV-BLOCK-NUMBER             45950000
459600             PERFORM 4410-READ-TEMP-STORAGE                       45960000
459700             PERFORM 3510-MARK-SELECTED-INDS                      45970000
459800                 VARYING ASC-ITEM-SUB                             45980000
459900                 FROM 1 BY 1                                      45990000
460000                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          46000000
460100             PERFORM 5100-WRITE-TEMP-STORAGE                      46010000
460200             ADD +1                TO PV-FIRST-BLOCK-IN-RANGE     46020000
460300         END-PERFORM                                              46030000
460400                                                                  46040000
460500         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         46050000
460600             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     46060000
460700         PERFORM                                                  46070000
460800             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       46080000
460900                   PV-LAST-BLOCK-IN-RANGE                         46090000
461000             MOVE PV-NEXT-BLOCK-IN-ARRAY                          46100000
461100                                   TO PV-BLOCK-NUMBER             46110000
461200             PERFORM 4410-READ-TEMP-STORAGE                       46120000
461300             PERFORM 3510-MARK-SELECTED-INDS                      46130000
461400                 VARYING ASC-ITEM-SUB                             46140000
461500                 FROM 1 BY 1                                      46150000
461600                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          46160000
461700             PERFORM 5100-WRITE-TEMP-STORAGE                      46170000
461800             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      46180000
461900         END-PERFORM                                              46190000
462000                                                                  46200000
462100         MOVE PV-FIRST-BLOCK-IN-ARRAY                             46210000
462200                                   TO PV-BLOCK-NUMBER             46220000
462300         PERFORM 4410-READ-TEMP-STORAGE                           46230000
462400     END-IF.                                                      46240000
462500                                                                  46250000
462600     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE 46260000
462700                                      ASC-END-OF-SELECTED-RANGE.  46270000
462800                                                                  46280000
462900 EJECT                                                            46290000
463000*----------------------------------------------------------------*46300000
463100* SET THE SELECTION INDICATOR TO 'S' WITHIN THE RANGE.           *46310000
463200*----------------------------------------------------------------*46320000
463300                                                                  46330000
463400 3510-MARK-SELECTED-INDS.                                         46340000
463500                                                                  46350000
463600     IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         46360000
463700                                ASC-ITEM-SUB) >                   46370000
463800         ASC-START-OF-SELECTED-RANGE)                             46380000
463900     OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         46390000
464000                                ASC-ITEM-SUB) =                   46400000
464100         ASC-START-OF-SELECTED-RANGE)                             46410000
464200                                                                  46420000
464300         IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     46430000
464400                                    ASC-ITEM-SUB) <               46440000
464500             ASC-END-OF-SELECTED-RANGE)                           46450000
464600         OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     46460000
464700                                    ASC-ITEM-SUB) =               46470000
464800             ASC-END-OF-SELECTED-RANGE)                           46480000
464900                                                                  46490000
465000             IF NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          46500000
465100                 SET ASC-SELECT     (ASC-BLK-SUB  ASC-ITEM-SUB)   46510000
465200                     ASC-TEMP-SELECT(ASC-BLK-SUB  ASC-ITEM-SUB)   46520000
465300                               TO TRUE                            46530000
465400                 SET ASC-BLOCK-MODIFIED(ASC-BLK-SUB)              46540000
465500                               TO TRUE                            46550000
465600                 ADD +1        TO ASC-NUMBER-OF-SELECTED-ITEMS    46560000
465700             END-IF                                               46570000
465800         END-IF                                                   46580000
465900     END-IF.                                                      46590000
466000                                                                  46600000
466100                                                                  46610000
522700*----------------------------------------------------------------*52270000
522800*    INITIALIZE BOTH BLOCKS IN THE ARRAY.                        *52280000
522900*    INITIALIZE ALL COUNTERS AND FLAGS.                          *52290000
523000*    READ THE DATA BASE FOR THE 1ST TIME AND FILL UP THE ARRAY.  *52300000
523100*    DISPLAY THE PANEL TO USER.                                  *52310000
523200*----------------------------------------------------------------*52320000
523300                                                                  52330000
523400 4000-BUILD-INITIAL-PANEL.                                        52340000
523500                                                                  52350000
523600     INITIALIZE                  ASC-BLOCK-ENTRIES (1)            52360000
523700                                 ASC-BLOCK-ENTRIES (2).           52370000
523800     MOVE +1                 TO  ASC-BLK-SUB.                     52380000
523900     SET ASC-ITEMS-LEFT-ON-DB                                     52390000
524000                             TO TRUE.                             52400000
524100                                                                  52410000
524200     MOVE +0                 TO ASC-ITEM-SUB                      52420000
524300                                ASC-NUMBER-OF-ITEMS-READ          52430000
524400                                ASC-NUMBER-OF-SELECTED-ITEMS      52440000
524500                                ASC-HIGHEST-BLOCK-WRITTEN         52450000
524600                                ASC-START-OF-SELECTED-RANGE       52460000
524700                                ASC-END-OF-SELECTED-RANGE         52470000
524800                                ASC-ITEM-AT-TOP-OF-PANEL.         52480000
524900                                                                  52490000
525000                                                                  52500000
525100     PERFORM 4100-PREPARE-CURSOR                                  52510000
525200                                                                  52520000
525300     PERFORM 4010-OPEN-CURSOR.                                    52530000
525400                                                                  52540000
525500     PERFORM 4300-READ-ITEMS-FROM-DB.                             52550000
525600                                                                  52560000
525700     PERFORM 4020-CLOSE-CURSOR.                                   52570000
525800                                                                  52580000
525900     MOVE +1                   TO  PV-TOP-ITEM.                   52590000
526000     IF  ASC-NUMBER-OF-ITEMS-READ = ZERO                          52600000
526100         SET DP020-NEXT-ACT-APPL-ERROR TO TRUE                    52610000
526200         SET DP020-MSG-FATAL   TO  TRUE                           52620000
526300         MOVE PC-TSYMSG-00050  TO  DP020-MSG-NUMBER               52630000
526400     ELSE                                                         52640000
526500         MOVE -1               TO MR-SELECTL (1)                  52650000
526600         SET DP030-SET-CURSOR-APPL-1                              52660000
526700                               TO TRUE                            52670000
526800         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                     52680000
526900     END-IF.                                                      52690000
527000 EJECT                                                            52700000
527100*----------------------------------------------------------------*52710000
527200* OPEN THE TMESSAGE CURSOR.                                      *52720000
527300*   IN THIS PARTICULAR APPLICATION ONE OF 3 DIFFERENT CURSORS    *52730000
527400*   WILL BE OPENED DEPENDING ON THE CRITERIA SPECIFIED BY THE    *52740000
527500*   USER.                                                        *52750000
527600*----------------------------------------------------------------*52760000
527700                                                                  52770000
527800 4010-OPEN-CURSOR.                                                52780000
527900     PERFORM                                                      52790000
528000         WITH TEST AFTER                                          52800000
528100         VARYING PV-RETRY-COUNTER                                 52810000
528200         FROM 1 BY 1                                              52820000
528300         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               52830000
528400                   OR (SQLCODE = ZERO))                           52840000
528401                                                                  52840100
528402              MOVE 'CURSOR:  ATTR-DEFN-CSR   '                    52840200
528403                                        TO DP013-MESSAGE-TEXT (2) 52840300
528404                                                                  52840400
528410              EXEC SQL                                            52841000
528420                   OPEN ATTR-DEFN-CSR                             52842000
528430              END-EXEC                                            52843000
560200                                                                  56020000
560300         EVALUATE TRUE                                            56030000
560400             WHEN SQLCODE = ZERO                                  56040000
560500             WHEN SQLCODE = -904                                  56050000
560600             WHEN SQLCODE = -913                                  56060000
560700                 CONTINUE                                         56070000
560800             WHEN SQLWARN0 NOT = SPACES                           56080000
560900             WHEN SQLCODE < ZERO                                  56090000
561000             WHEN SQLCODE > ZERO                                  56100000
561100                 MOVE '4010-OPEN-CURSOR'                          56110000
561200                                   TO DP013-PARAGRAPH             56120000
561300                 MOVE 'OPEN ATTR-DEFN CURSOR - '                  56130000
561400                                   TO DP013-MESSAGE-TEXT (1)      56140000
561500                 MOVE SQLCA        TO DP013-SQLCA                 56150000
561600                 MOVE 'WST_ATTR_DEFN' TO DP013-DB2-TABLE-NAME (1) 56160000
561700                 SET DP013-DB2-ABEND                              56170000
561800                     DP013-XCTL-DISPLAY-RESTART TO TRUE           56180000
561900                 PERFORM DP013-0000-PROCESS-ABEND                 56190000
562000         END-EVALUATE                                             56200000
562100     END-PERFORM.                                                 56210000
562200*                                                                 56220000
562300     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        56230000
562400         MOVE '4010-OPEN-CURSOR'   TO DP013-PARAGRAPH             56240000
562500         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR'   56250000
562600                                   TO DP013-MESSAGE-TEXT (1)      56260000
562700         MOVE SQLCA                TO DP013-SQLCA                 56270000
562800         MOVE 'WST_ATTR_DEFN'      TO DP013-DB2-TABLE-NAME (1)    56280000
562900         SET DP013-DB2-ABEND                                      56290000
563000             DP013-XCTL-DISPLAY-RESTART                           56300000
563100                                   TO TRUE                        56310000
563200         PERFORM DP013-0000-PROCESS-ABEND                         56320000
563300     END-IF.                                                      56330000
563400                                                                  56340000
563500                                                                  56350000
563600*----------------------------------------------------------------*56360000
563700* CLOSE THE TMESSAGE CURSOR.                                     *56370000
563800*   IN THIS PARTICULAR APPLICATION ONE OF 3 DIFFERENT CURSORS    *56380000
563900*   WILL BE CLOSED DEPENDING ON THE CRITERIA SPECIFIED BY THE    *56390000
564000*   USER.                                                        *56400000
564100*----------------------------------------------------------------*56410000
564200                                                                  56420000
564300 4020-CLOSE-CURSOR.                                               56430000
564310      EXEC SQL                                                    56431000
564320           CLOSE ATTR-DEFN-CSR                                    56432000
564330      END-EXEC                                                    56433000
586400*                                                                 58640000
586500     EVALUATE TRUE                                                58650000
586600         WHEN SQLCODE = ZERO                                      58660000
586700             CONTINUE                                             58670000
586800         WHEN SQLWARN0 NOT = SPACES                               58680000
586900         WHEN SQLCODE < ZERO                                      58690000
587000         WHEN SQLCODE > ZERO                                      58700000
587100             MOVE '4020-CLOSE-CURSOR'                             58710000
587200                               TO DP013-PARAGRAPH                 58720000
587300             MOVE 'CLOSE ATTR_DEFN CURSOR '                       58730000
587400                                  TO DP013-MESSAGE-TEXT (1)       58740000
587500             MOVE SQLCA           TO DP013-SQLCA                  58750000
587600             MOVE 'WST_ATTR_DEFN' TO DP013-DB2-TABLE-NAME (1)     58760000
587700             SET DP013-DB2-ABEND                                  58770000
587800                 DP013-XCTL-DISPLAY-RESTART TO TRUE               58780000
587900             PERFORM DP013-0000-PROCESS-ABEND                     58790000
588000     END-EVALUATE.                                                58800000
588100                                                                  58810000
588200                                                                  58820000
588300*----------------------------------------------------------------*58830000
588400*    SET UP THE HOST VARIABLES.                                  *58840000
588500*----------------------------------------------------------------*58850000
588600                                                                  58860000
588700 4100-PREPARE-CURSOR.                                             58870000
588800                                                                  58880000
588810     MOVE ASC-PARM-NAME        TO  DK-ATTR-DEFN.                  58881000
614400                                                                  61440000
614500*    MOVE ASC-PULL-NBR         TO DK-PULL-NUMBER.                 61450000
614600*    MOVE ASC-REF-NBR          TO DK-REF-NUMBER.                  61460000
614700*    MOVE ASC-DEPT-NBR-N       TO DK-DEPT-NUMBER.                 61470000
626100                                                                  62610000
626200                                                                  62620000
626300*----------------------------------------------------------------*62630000
626400*    READ THE ITEMS FROM THE DATA BASE AND MOVE THEM INTO THE    *62640000
626500*    BLOCKS IN THE ARRAY.  WHENEVER BOTH BLOCKS BECOME FULL,     *62650000
626600*    WRITE OUT THE 1ST BLOCK TO TEMPORARY STORAGE, MOVE THE 2ND  *62660000
626700*    BLOCK IN THE ARRAY TO THE 1ST BLOCK, AND INITIALIZE THE     *62670000
626800*    2ND BLOCK MAKING IT AVAILABLE TO BE USED.                   *62680000
626900*                                                                *62690000
627000*    DUE TO THE SIZE OF THE TABLE, AND THE ORDER IN WHICH THE    *62700000
627100*    ROWS ARE SORTED, THE ENTIRE TABLE IS READ INTO THE PROGRAM  *62710000
627200*    UPON INITIALIZATION.                                        *62720000
627300*----------------------------------------------------------------*62730000
627400 4300-READ-ITEMS-FROM-DB.                                         62740000
627500                                                                  62750000
627600     PERFORM                                                      62760000
627700         VARYING PV-READ-COUNT                                    62770000
627800         FROM 1 BY 1                                              62780000
627900         UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                    62790000
628000            OR (ASC-NO-ITEMS-LEFT-ON-DB))                         62800000
628100                                                                  62810000
628200         PERFORM 4310-FETCH                                       62820000
628300                                                                  62830000
628400         IF  ASC-ITEMS-LEFT-ON-DB                                 62840000
628500             IF  ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                62850000
628600                 ADD +1            TO ASC-ITEM-SUB                62860000
628700             ELSE                                                 62870000
628800                 ADD +1            TO ASC-BLK-SUB                 62880000
628900                 MOVE +1           TO ASC-ITEM-SUB                62890000
629000                                                                  62900000
629100                 IF  ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY         62910000
629200                     MOVE +1       TO ASC-BLK-SUB                 62920000
629300                     SET ASC-BLOCK-MODIFIED (1)                   62930000
629400                                   TO TRUE                        62940000
629500                     PERFORM 5100-WRITE-TEMP-STORAGE              62950000
629600                     MOVE ASC-BLOCK-ENTRIES                       62960000
629700                               (PC-MAX-BLOCKS-IN-ARRAY)           62970000
629800                                TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB) 62980000
629900                     ADD +1        TO ASC-BLK-SUB                 62990000
630000                     INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)   63000000
630100                     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)      63010000
630200                                   TO TRUE                        63020000
630300                 END-IF                                           63030000
630400             END-IF                                               63040000
630500             ADD +1                TO ASC-NUMBER-OF-ITEMS-READ    63050000
630600             MOVE ASC-NUMBER-OF-ITEMS-READ                        63060000
630700                                   TO ASC-LIST-ITEM-NUMBER        63070000
630800                                      (ASC-BLK-SUB ASC-ITEM-SUB)  63080000
630900                                                                  63090000
631000             EVALUATE TRUE                                        63100000
631100                 WHEN CN022-FUNCTION-NONE                         63110000
631200                     MOVE SPACES TO ASC-ACTION                    63120000
631300                                      (ASC-BLK-SUB ASC-ITEM-SUB)  63130000
631400                 WHEN CN022-UPD-CODE                              63140000
631500                     MOVE PC-UPD TO ASC-ACTION                    63150000
631600                                      (ASC-BLK-SUB ASC-ITEM-SUB)  63160000
631700                 WHEN CN023-ADD-DEFN                              63170000
631800                     MOVE PC-UPD TO ASC-ACTION                    63180000
631900                                      (ASC-BLK-SUB ASC-ITEM-SUB)  63190000
632000             END-EVALUATE                                         63200000
632100                                                                  63210000
632200             PERFORM 4320-GET-ELEM-COUNT                          63220000
632300                                                                  63230000
632400             MOVE  WST00009-INTGRTN-TYP-CDE   TO  ASC-FUNC-CODE   63240000
632500                                       (ASC-BLK-SUB ASC-ITEM-SUB) 63250000
632600             MOVE  WST00009-ATTR-DEFN-SEQ-NBR TO  ASC-DEFN-SEQ    63260000
632700                                       (ASC-BLK-SUB ASC-ITEM-SUB) 63270000
632800             MOVE  WST00009-ATTR-DEFN-DESC    TO  ASC-ATTR-DESC   63280000
632900                                       (ASC-BLK-SUB ASC-ITEM-SUB) 63290000
633000             MOVE  WST00009-REQR-IND          TO  ASC-REQD        63300000
633100                                       (ASC-BLK-SUB ASC-ITEM-SUB) 63310000
633200             MOVE  WST00009-DATYP-CDE         TO  ASC-DATA-TYPE   63320000
633300                                       (ASC-BLK-SUB ASC-ITEM-SUB) 63330000
633400             MOVE  WST00009-MAX-LEN-QTY       TO  ASC-MAX-LENGTH  63340000
633500                                       (ASC-BLK-SUB ASC-ITEM-SUB) 63350000
633600             MOVE  WST00009-MAX-PCSN-QTY TO ASC-DECIMAL-POSITION  63360000
633700                                       (ASC-BLK-SUB ASC-ITEM-SUB) 63370000
633800             MOVE  PV-WST00010-ELEM-COUNT     TO ASC-ELEM-COUNT   63380000
633900                                       (ASC-BLK-SUB ASC-ITEM-SUB) 63390000
634000                                                                  63400000
634100         END-IF                                                   63410000
643200     END-PERFORM.                                                 64320000
643300                                                                  64330000
643400     IF  ASC-NUMBER-OF-ITEMS-READ > ZERO                          64340000
643500         MOVE +1               TO ASC-BLK-SUB                     64350000
643600         PERFORM 5100-WRITE-TEMP-STORAGE                          64360000
643700         ADD +1                TO ASC-BLK-SUB                     64370000
643800         PERFORM 5100-WRITE-TEMP-STORAGE                          64380000
643900                                                                  64390000
644000         MOVE 1                TO ASC-BLK-SUB                     64400000
644100                                  PV-BLOCK-NUMBER                 64410000
644200         PERFORM 4410-READ-TEMP-STORAGE                           64420000
644300         IF  ASC-HIGHEST-BLOCK-WRITTEN GREATER THAN 1             64430000
644400             MOVE 2            TO ASC-BLK-SUB                     64440000
644500                                  PV-BLOCK-NUMBER                 64450000
644600             PERFORM 4410-READ-TEMP-STORAGE                       64460000
644700         END-IF                                                   64470000
644800     END-IF.                                                      64480000
644900 EJECT                                                            64490000
645000*----------------------------------------------------------------*64500000
645100*    FETCH THE MESSAGE CURSOR.                                   *64510000
645200*----------------------------------------------------------------*64520000
645300                                                                  64530000
645400 4310-FETCH.                                                      64540000
645410       EXEC SQL                                                   64541000
645420            FETCH ATTR-DEFN-CSR                                   64542000
645430             INTO                                                 64543000
645440                  :WST00009-INTGRTN-TYP-CDE                       64544000
645450                , :WST00009-ATTR-DEFN-SEQ-NBR                     64545000
645460                , :WST00009-ATTR-DEFN-DESC                        64546000
645470                , :WST00009-REQR-IND                              64547000
645480                , :WST00009-DATYP-CDE                             64548000
645490                , :WST00009-MAX-LEN-QTY                           64549000
645491                , :WST00009-MAX-PCSN-QTY                          64549100
645492       END-EXEC.                                                  64549200
645500                                                                  64550000
698800                                                                  69880000
698900     EVALUATE TRUE                                                69890000
699000         WHEN SQLCODE = ZERO                                      69900000
699100              CONTINUE                                            69910000
699200                                                                  69920000
699300         WHEN SQLCODE = +100                                      69930000
699400              CONTINUE                                            69940000
699500                                                                  69950000
699600         WHEN SQLWARN0 NOT = SPACE                                69960000
699700         WHEN SQLCODE NOT = ZERO                                  69970000
699800              MOVE '4310-FETCH-CURSOR'                            69980000
699900                               TO DP013-PARAGRAPH                 69990000
700000              MOVE 'FETCH MESSAGE CURSOR'                         70000000
700100                               TO DP013-MESSAGE-TEXT (1)          70010000
700200              MOVE SQLCA       TO DP013-SQLCA                     70020000
700300              SET DP013-DB2-ABEND                                 70030000
700400                               TO TRUE                            70040000
700500              PERFORM DP013-0000-PROCESS-ABEND                    70050000
700600     END-EVALUATE.                                                70060000
700700                                                                  70070000
700800     IF  SQLCODE EQUAL +100                                       70080000
700900         SET ASC-NO-ITEMS-LEFT-ON-DB                              70090000
701000                                   TO TRUE                        70100000
701100     END-IF.                                                      70110000
701200                                                                  70120000
701300                                                                  70130000
701400*----------------------------------------------------------------*70140000
701500* COUNT THE NUMBER OF ROWS ON WST_ATTR_ELEM FOR THE PARM         *70150000
701800*----------------------------------------------------------------*70180000
701900 4320-GET-ELEM-COUNT.                                             70190000
702000                                                                  70200000
702100       EXEC SQL                                                   70210000
702200            SELECT COUNT(*)                                       70220000
702300              INTO :PV-WST00010-ELEM-COUNT                        70230000
702400              FROM WST_ATTR_ELEM                                  70240000
702500             WHERE INTGRTN_TYP_CDE   = :WST00009-INTGRTN-TYP-CDE  70250000
702600               AND ATTR_DEFN_SEQ_NBR = :WST00009-ATTR-DEFN-SEQ-NBR70260000
702700       END-EXEC.                                                  70270000
702800                                                                  70280000
702900                                                                  70290000
703000     EVALUATE TRUE                                                70300000
703100         WHEN SQLCODE = ZERO                                      70310000
703200              CONTINUE                                            70320000
703300                                                                  70330000
703400         WHEN SQLCODE = +100                                      70340000
703500              MOVE 0  TO  PV-WST00010-ELEM-COUNT                  70350000
703600                                                                  70360000
703700         WHEN SQLWARN0 NOT = SPACE                                70370000
703800         WHEN SQLCODE NOT = ZERO                                  70380000
703900              MOVE '4320-GET-ELEM-COUNT' TO DP013-PARAGRAPH       70390000
704000              MOVE 'COUNT # OF ELEM ROWS  '                       70400000
704100                               TO DP013-MESSAGE-TEXT (1)          70410000
704200              MOVE SQLCA       TO DP013-SQLCA                     70420000
704300              SET DP013-DB2-ABEND TO TRUE                         70430000
704400              PERFORM DP013-0000-PROCESS-ABEND                    70440000
704500     END-EVALUATE.                                                70450000
704600                                                                  70460000
704700                                                                  70470000
739000*----------------------------------------------------------------*73900000
739100* MOVE THE DISPLAYED FIELDS FROM THE COMMAREA TO THE SCREEN.     *73910000
739200*----------------------------------------------------------------*73920000
739300                                                                  73930000
739400 4400-MOVE-COMMAREA-TO-SCREEN.                                    73940000
739500     IF  (((PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (1 1))             73950000
739600         AND (PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (2 1)))          73960000
739700         OR  (PV-TOP-ITEM < ASC-LIST-ITEM-NUMBER (1 1)))          73970000
739800             MOVE +1    TO ASC-BLK-SUB                            73980000
739900             PERFORM 5100-WRITE-TEMP-STORAGE                      73990000
740000             ADD +1     TO ASC-BLK-SUB                            74000000
740100             PERFORM 5100-WRITE-TEMP-STORAGE                      74010000
740200             DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL             74020000
740300                 GIVING PV-BLOCK-NUMBER                           74030000
740400                 REMAINDER PV-REMAINDER                           74040000
740500             IF  PV-REMAINDER > ZERO                              74050000
740600                 ADD +1 TO PV-BLOCK-NUMBER                        74060000
740700             END-IF                                               74070000
740800             MOVE +1    TO ASC-BLK-SUB                            74080000
740900             PERFORM 4410-READ-TEMP-STORAGE                       74090000
741000             ADD +1     TO ASC-BLK-SUB                            74100000
741100                           PV-BLOCK-NUMBER                        74110000
741200             PERFORM 4410-READ-TEMP-STORAGE                       74120000
741300     END-IF.                                                      74130000
741400     MOVE +1            TO ASC-BLK-SUB.                           74140000
741500     COMPUTE ASC-ITEM-SUB =                                       74150000
741600         ((PV-TOP-ITEM - ASC-LIST-ITEM-NUMBER (1 1))              74160000
741700         + PC-ITEMS-PER-PANEL).                                   74170000
741800*                                                                 74180000
741900     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        74190000
742000         ADD +1         TO ASC-BLK-SUB                            74200000
742100         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            74210000
742200     END-IF.                                                      74220000
742300*                                                                 74230000
742400     COMPUTE ASC-ITEM-AT-BOT-OF-PANEL =                           74240000
742500         ((PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1).                74250000
742600     PERFORM 4430-CHECK-FOR-BEGIN-AND-END.                        74260000
742700     PERFORM 4420-FORMAT-LIST-LINES                               74270000
742800         VARYING PV-SUB                                           74280000
742900         FROM PC-ITEMS-PER-PANEL BY -1                            74290000
743000         UNTIL PV-SUB < +1.                                       74300000
743100*                                                                 74310000
743200     COMPUTE ASC-ITEMS-DISPLAYED =                                74320000
743300         ((ASC-ITEM-AT-BOT-OF-PANEL - PV-TOP-ITEM) + 1).          74330000
743400     MOVE PV-TOP-ITEM              TO ASC-ITEM-AT-TOP-OF-PANEL    74340000
743500                                      ASTRTITO.                   74350000
743600     MOVE ASC-ITEM-AT-BOT-OF-PANEL TO AENDITO.                    74360000
743700     MOVE ASC-NUMBER-OF-ITEMS-READ TO ATOTITO.                    74370000
743800     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            74380000
743900                                   TO ASELITO.                    74390000
744000*                                                                 74400000
744010     MOVE  ASC-PARM-NAME           TO AIPARMO.                    74401000
744020     MOVE  ASC-PARM-DESC           TO AIPDESCO.                   74402000
745000                                                                  74500000
755000                                                                  75500000
755100*                                                                 75510000
755200     IF  DP020-MSG-NUMBER-X = SPACE                               75520000
755300         IF  ASC-ITEM-AT-BOT-OF-PANEL < ASC-NUMBER-OF-ITEMS-READ  75530000
755400*            --- MORE ITEMS TO DISPLAY ----                       75540000
755500             MOVE PC-TSYMSG-00279  TO DP020-MSG-NUMBER            75550000
755600             SET DP020-MSG-INFORMATIONAL TO TRUE                  75560000
755700         END-IF                                                   75570000
755800     END-IF.                                                      75580000
755900*----------------------------------------------------------------*75590000
756000*    READ A BLOCK FROM TEMPORARY STORAGE INTO THE ARRAY.         *75600000
756100*----------------------------------------------------------------*75610000
756200                                                                  75620000
756300 4410-READ-TEMP-STORAGE.                                          75630000
756400                                                                  75640000
756500     EXEC CICS                                                    75650000
756600         READQ TS                                                 75660000
756700             QUEUE (ASC-LIST-QUEUE-NAME)                          75670000
756800             INTO  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               75680000
756900             ITEM  (PV-BLOCK-NUMBER)                              75690000
757000             RESP  (PV-CICS-RESP)                                 75700000
757100     END-EXEC.                                                    75710000
757200                                                                  75720000
757300     IF  ((PV-CICS-RESP = DFHRESP (NORMAL))                       75730000
757400       OR (PV-CICS-RESP = DFHRESP (ITEMERR)))                     75740000
757500         CONTINUE                                                 75750000
757600     ELSE                                                         75760000
757700         SET DP013-CICS-ABEND     TO TRUE                         75770000
757800         SET DP013-NO-ROLLBACK    TO TRUE                         75780000
757900         MOVE '4410-READ-TEMP-STORAGE'                            75790000
758000                                  TO DP013-PARAGRAPH              75800000
758100         MOVE 'ERROR TRYING TO READ FROM TEMP STORAGE QUEUE'      75810000
758200                                  TO DP013-MESSAGE-TEXT(1)        75820000
758300         PERFORM DP013-0000-PROCESS-ABEND                         75830000
758400     END-IF.                                                      75840000
758500                                                                  75850000
758600     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             75860000
758700*                                                                 75870000
758800     IF  PV-CICS-RESP = DFHRESP (ITEMERR)                         75880000
758900         INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)               75890000
759000     END-IF.                                                      75900000
759100 EJECT                                                            75910000
759200*----------------------------------------------------------------*75920000
759300*    PROCESS THE ITEMS IN THE ARRAY AND MOVE THEM TO THE MAP.    *75930000
759400*----------------------------------------------------------------*75940000
759500                                                                  75950000
759600 4420-FORMAT-LIST-LINES.                                          75960000
759700     IF  ASC-ITEM-AT-BOT-OF-PANEL > ASC-NUMBER-OF-ITEMS-READ      75970000
759800         SUBTRACT +1 FROM ASC-ITEM-AT-BOT-OF-PANEL                75980000
759900         MOVE DP015-ASK-DRK-OFF  TO MR-SELECTA (PV-SUB)           75990000
760000         MOVE DP015-HL-OFF       TO MR-SELECTH (PV-SUB)           76000000
760100         MOVE SPACE              TO MR-SELECTI (PV-SUB)           76010000
760200                                    MR-ACTION  (PV-SUB)           76020000
760300                                    MR-ATTDSC  (PV-SUB)           76030000
760400                                    MR-REQD    (PV-SUB)           76040000
760500                                    MR-DATYPE  (PV-SUB)           76050000
760600                                    MR-MAXLEN  (PV-SUB)           76060000
760700                                    MR-DECPOS  (PV-SUB)           76070000
760800                                    MR-ELMCNT  (PV-SUB)           76080000
760900         MOVE ZEROES             TO MR-DEFSEQ  (PV-SUB)           76090000
761400     ELSE                                                         76140000
761500         IF  ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      76150000
761600                                                   > SPACE        76160000
761700             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 76170000
761800                                 TO MR-SELECTI (PV-SUB)           76180000
761900         ELSE                                                     76190000
762000             MOVE ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      76200000
762100                                 TO MR-SELECTI (PV-SUB)           76210000
762200         END-IF                                                   76220000
762300*                                                                 76230000
762400         IF  DP030-SET-CURSOR-TRAILER                             76240000
762500             IF  ((ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)76250000
762600                 > SPACE)                                         76260000
762700               OR (PV-SUB = 1))                                   76270000
762800                SET DP030-SET-CURSOR-APPL-1 TO TRUE               76280000
762900                MOVE -1          TO MR-SELECTL (PV-SUB)           76290000
763000             END-IF                                               76300000
763100         END-IF                                                   76310000
763200*                                                                 76320000
763210         MOVE ASC-ACTION (ASC-BLK-SUB ASC-ITEM-SUB)               76321000
763220                                          TO MR-ACTION   (PV-SUB) 76322000
763230         MOVE ASC-DEFN-SEQ       (ASC-BLK-SUB ASC-ITEM-SUB)       76323000
763240                                          TO MR-DEFSEQ   (PV-SUB) 76324000
763250         MOVE ASC-ATTR-DESC      (ASC-BLK-SUB ASC-ITEM-SUB)       76325000
763260                                          TO MR-ATTDSC   (PV-SUB) 76326000
763270         MOVE ASC-REQD           (ASC-BLK-SUB ASC-ITEM-SUB)       76327000
763280                                          TO MR-REQD     (PV-SUB) 76328000
763290         MOVE ASC-DATA-TYPE      (ASC-BLK-SUB ASC-ITEM-SUB)       76329000
763291                                          TO MR-DATYPE   (PV-SUB) 76329100
763292         MOVE ASC-MAX-LENGTH     (ASC-BLK-SUB ASC-ITEM-SUB)       76329200
763293                                          TO PV-DISP-MAX-LENGTH   76329300
763294         MOVE PV-DISP-MAX-LENGTH          TO MR-MAXLEN   (PV-SUB) 76329400
763295                                                                  76329500
763296         MOVE ASC-DECIMAL-POSITION (ASC-BLK-SUB ASC-ITEM-SUB)     76329600
763297                                          TO PV-DISP-DEC-POS      76329700
763298         MOVE PV-DISP-DEC-POS             TO MR-DECPOS   (PV-SUB) 76329800
763299                                                                  76329900
763300         MOVE ASC-ELEM-COUNT       (ASC-BLK-SUB ASC-ITEM-SUB)     76330000
763301                                          TO PV-DISP-ELEM-CNT     76330100
763302         MOVE PV-DISP-ELEM-CNT            TO  MR-ELMCNT  (PV-SUB) 76330200
775000     END-IF.                                                      77500000
775010                                                                  77501000
775100     SUBTRACT +1 FROM ASC-ITEM-SUB                                77510000
775200     IF  ASC-ITEM-SUB < + 1                                       77520000
775300         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  77530000
775400         MOVE +1                 TO ASC-BLK-SUB                   77540000
775500     END-IF.                                                      77550000
775600******************************************************************77560000
775700** IF A BEGINNING OF RANGE WAS SPECIFIED, MAKE SURE AN END OF   **77570000
775800** RANGE WAS SPECIFIED AND VICE-VERSA.  IF ONE IS MISSING,      **77580000
775900** ISSUE A WARNING.                                             **77590000
776000******************************************************************77600000
776100 4430-CHECK-FOR-BEGIN-AND-END.                                    77610000
776200     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       77620000
776300         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     77630000
776400*            -- NO END-OF-RANGE SPECFIED ---                      77640000
776500             MOVE PC-TSYMSG-00051  TO DP020-MSG-NUMBER            77650000
776600             SET DP020-MSG-WARNING TO TRUE                        77660000
776700             PERFORM 4431-POSITION-AT-WARNING                     77670000
776800         END-IF                                                   77680000
776900     ELSE                                                         77690000
777000         IF  ASC-END-OF-SELECTED-RANGE > ZERO                     77700000
777100*            -- NO BEGINNING-OF-RANGE SPECFIED ---                77710000
777200             MOVE PC-TSYMSG-00053  TO DP020-MSG-NUMBER            77720000
777300             SET DP020-MSG-WARNING TO TRUE                        77730000
777400             PERFORM 4431-POSITION-AT-WARNING                     77740000
777500         END-IF                                                   77750000
777600     END-IF.                                                      77760000
777700******************************************************************77770000
777800** ONCE IT HAS BEEN DETERMINED THAT A WARNING IS TO BE ISSUED,  **77780000
777900** DETERMINE IF EITHER THE BEGINNING OF RANGE OR END OF RANGE   **77790000
778000** IS ON THE CURRENT SCREEN.  IF IT IS, HIGHLIGHT IT AND        **77800000
778100** POSITION THE CURSOR THERE.                                   **77810000
778200******************************************************************77820000
778300 4431-POSITION-AT-WARNING.                                        77830000
778400     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 77840000
778500                    - PV-TOP-ITEM + 1.                            77850000
778600     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      77860000
778700         CONTINUE                                                 77870000
778800     ELSE                                                         77880000
778900         SET DP030-SET-CURSOR-APPL-1                              77890000
779000                                   TO TRUE                        77900000
779100         MOVE -1                   TO MR-SELECTL (PV-SUB)         77910000
779200         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         77920000
779300         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         77930000
779400     END-IF.                                                      77940000
779500*                                                                 77950000
779600     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   77960000
779700                    - PV-TOP-ITEM + 1.                            77970000
779800     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      77980000
779900         CONTINUE                                                 77990000
780000     ELSE                                                         78000000
780100         SET DP030-SET-CURSOR-APPL-1                              78010000
780200                                   TO TRUE                        78020000
780300         MOVE -1                   TO MR-SELECTL (PV-SUB)         78030000
780400         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         78040000
780500         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         78050000
780600     END-IF.                                                      78060000
780700                                                                  78070000
780800*                                                                 78080000
785000*----------------------------------------------------------------*78500000
785100*                                                                *78510000
785200*----------------------------------------------------------------*78520000
785300*4605-PROCESS-SELECTED-LINES.                                     78530000
785400*                                                                 78540000
785500*    PERFORM 4620-PROCESS-LINES.                                  78550000
785600*                                                                 78560000
786500*                                                                 78650000
786600*----------------------------------------------------------------*78660000
786700*                                                                *78670000
786800*                                                                *78680000
786900*----------------------------------------------------------------*78690000
787000*4620-PROCESS-LINES.                                              78700000
787100*                                                                 78710000
787200*    MOVE LQW-PULL-NUMBER (LQW-IDX)      TO PV-PULL-NUMBER.       78720000
787300*    MOVE LQW-REF-NUMBER (LQW-IDX)       TO PV-REF-NUMBER.        78730000
787400*    MOVE LQW-CS-LOCATION (LQW-IDX)      TO PV-CS-LOCATION.       78740000
787500*    MOVE LQW-CREATE-DATE (LQW-IDX)      TO PV-CREATE-DATE.       78750000
787600*    MOVE LQW-PULL-STATUS-CDE (LQW-IDX)  TO PV-PULL-STATUS-CDE.   78760000
787700*    MOVE LQW-PULL-STATUS-DESC (LQW-IDX) TO PV-PULL-STATUS-DESC.  78770000
787800*    MOVE LQW-STATUS-DATE (LQW-IDX)      TO PV-STATUS-DATE.       78780000
787900*    MOVE LQW-PULL-SOURCE-CDE (LQW-IDX)  TO PV-PULL-SOURCE-CDE.   78790000
788000*    MOVE LQW-PULL-SOURCE-DESC (LQW-IDX) TO PV-PULL-SOURCE-DESC.  78800000
788100*    MOVE LQW-NBR-ITEMS (LQW-IDX)        TO PV-NBR-ITEMS.         78810000
788200*    MOVE LQW-REQ-PULL-UNITS (LQW-IDX)   TO PV-REQ-PULL-UNITS.    78820000
788300*    MOVE LQW-ACT-PULL-UNITS (LQW-IDX)   TO PV-ACT-PULL-UNITS.    78830000
788400*    MOVE LQW-DISTRBUTED-UNITS (LQW-IDX) TO PV-DISTRBUTED-UNITS.  78840000
788500*                                                                 78850000
788600*    IF  PS-NO-ERROR                                              78860000
788700*        IF  LQW-SELECT (LQW-IDX)                                 78870000
788800*                PERFORM 4630-ISSUE-PRINT-REQ                     78880000
788900*        END-IF                                                   78890000
789000*    END-IF.                                                      78900000
789100*                                                                 78910000
789200*                                                                 78920000
789300*    IF  PS-NO-ERROR                                              78930000
789400*        SET  LQW-DESELECT (LQW-IDX)                              78940000
789500*             LQW-PRT (LQW-IDX)        TO  TRUE                   78950000
789600*        SUBTRACT  1                                              78960000
789700*            FROM  ASC-NUMBER-OF-SELECTED-ITEMS                   78970000
789800*        MOVE LQW-SELECTED-SW (LQW-IDX)                           78980000
789900*                             TO LQW-TEMP-SELECTED-SW (LQW-IDX)   78990000
790000*    END-IF.                                                      79000000
790100                                                                  79010000
790200                                                                  79020000
821300*----------------------------------------------------------------*82130000
821400* PREPARE THE SELECTED ITEMS TEMP STORAGE QUEUE.  MOVE ALL       *82140000
821500* SELECTED ITEMS FROM THE LIST TEMP STORAGE QUEUE TO THE LAYOUT  *82150000
821600* FOR THE SELECTED ITEMS QUEUE.                                  *82160000
821700*                                                                *82170000
821800* FIRST, DELETE THE SELECTION QUEUE, NEXT LOAD THE SELECTION     *82180000
821900* QUEUE RECORD.  FINALLY, WRITE THE SELECTION QUEUE ITEM WHEN    *82190000
822000* THE ARRAY IS FULL.                                             *82200000
822100*----------------------------------------------------------------*82210000
822300 5000-PREPARE-SEL-QUEUE.                                          82230000
822400                                                                  82240000
822500     MOVE +1                   TO  ASC-BLK-SUB.                   82250000
822600     PERFORM 5100-WRITE-TEMP-STORAGE.                             82260000
822700     ADD +1                    TO  ASC-BLK-SUB.                   82270000
822800     PERFORM 5100-WRITE-TEMP-STORAGE.                             82280000
822900                                                                  82290000
823000     MOVE ASC-SEL-QUEUE-NAME   TO  CN025-SEL-QUEUE-NAME.          82300000
823100     PERFORM 6010-DELETE-SEL-QUEUE.                               82310000
823200                                                                  82320000
823300     SET ASC-UPDATE-TSQ        TO  TRUE.                          82330000
823400                                                                  82340000
823500     SET CN026-IDX             TO  1.                             82350000
823600*    MOVE ZERO                 TO CN025-NUMBER-OF-TS-ITEMS.       82360011
823700     INITIALIZE CN026-SELECTED-ITEM-ARRAY.                        82370000
823800                                                                  82380000
823900     PERFORM 5200-FILL-SEL-QUEUE-RECORD                           82390000
824000             VARYING PV-ITEM                                      82400000
824100             FROM 1 BY 1                                          82410000
824200             UNTIL PV-ITEM GREATER ASC-HIGHEST-BLOCK-WRITTEN.     82420000
824300                                                                  82430000
824400     IF  CN026-IDX > 1                                            82440000
824500         PERFORM 5205-WRITE-SEL-QUEUE                             82450000
824600         ADD +1                TO CN025-NUMBER-OF-TS-ITEMS        82460000
824700     END-IF.                                                      82470000
824800 EJECT                                                            82480000
824900*----------------------------------------------------------------*82490000
825000*    WRITE A NEW BLOCK FROM THE ARRAY TO TEMPORARY STORAGE.      *82500000
825100*    REWRITE AN EXISITING BLOCK ONLY IF IT HAS BEEN MODIFIED.    *82510000
825200*----------------------------------------------------------------*82520000
825300                                                                  82530000
825400 5100-WRITE-TEMP-STORAGE.                                         82540000
825500     MOVE ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1)                     82550000
825600                                   TO PV-LIST-ITEM-NUMBER.        82560000
825700     COMPUTE PV-BLOCK-NUMBER =                                    82570000
825800         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    82580000
825900                                                                  82590000
826000     IF (PV-BLOCK-NUMBER < ASC-HIGHEST-BLOCK-WRITTEN)             82600000
826100     OR (PV-BLOCK-NUMBER = ASC-HIGHEST-BLOCK-WRITTEN)             82610000
826200         IF  ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                      82620000
826300             PERFORM 5105-REWRITE-ASC-LISTQ                       82630000
826400         END-IF                                                   82640000
826500     ELSE                                                         82650000
826600         COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                       82660000
826700         ASC-HIGHEST-BLOCK-WRITTEN + 1                            82670000
826800         PERFORM 5110-WRITE-ASC-LISTQ                             82680000
826900         ADD +1                    TO ASC-HIGHEST-BLOCK-WRITTEN   82690000
827000     END-IF.                                                      82700000
827100                                                                  82710000
827200     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             82720000
827300******************************************************************82730000
827400** REWRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-    **82740000
827500** SPECIFIC COMMAREA.                                           **82750000
827600******************************************************************82760000
827700 5105-REWRITE-ASC-LISTQ.                                          82770000
827800     EXEC CICS                                                    82780000
827900         WRITEQ TS                                                82790000
828000             QUEUE (ASC-LIST-QUEUE-NAME)                          82800000
828100             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               82810000
828200             ITEM  (PV-BLOCK-NUMBER)                              82820000
828300             REWRITE                                              82830000
828400             RESP  (PV-CICS-RESP)                                 82840000
828500     END-EXEC.                                                    82850000
828600                                                                  82860000
828700     IF  PV-CICS-RESP = DFHRESP(NORMAL)                           82870000
828800         CONTINUE                                                 82880000
828900     ELSE                                                         82890000
829000         SET DP013-CICS-ABEND            TO TRUE                  82900000
829100         SET DP013-NO-ROLLBACK           TO TRUE                  82910000
829200         MOVE '5105-REWRITE-ASC-LISTQ'   TO DP013-PARAGRAPH       82920000
829300         MOVE 'ATTEMPTING TO REWRITE LIST TEMP STORAGE QUEUE'     82930000
829400                                         TO DP013-MESSAGE-TEXT(1) 82940000
829500         PERFORM DP013-0000-PROCESS-ABEND                         82950000
829600     END-IF.                                                      82960000
829700                                                                  82970000
829800******************************************************************82980000
829900** WRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-      **82990000
830000** SPECIFIC COMMAREA.                                           **83000000
830100******************************************************************83010000
830200 5110-WRITE-ASC-LISTQ.                                            83020000
830300     EXEC CICS                                                    83030000
830400         WRITEQ TS                                                83040000
830500             QUEUE (ASC-LIST-QUEUE-NAME)                          83050000
830600             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               83060000
830700             ITEM  (PV-BLOCK-NUMBER)                              83070000
830800             RESP  (PV-CICS-RESP)                                 83080000
830900     END-EXEC.                                                    83090000
831000     IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                      83100000
831100         SET DP013-CICS-ABEND      TO TRUE                        83110000
831200         SET DP013-NO-ROLLBACK     TO TRUE                        83120000
831300         MOVE '5110-WRITE-ASC-LISTQ'                              83130000
831400                                   TO DP013-PARAGRAPH             83140000
831500         MOVE 'ATTEMPTING TO DELETE TEMP STORAGE QUEUE'           83150000
831600                                   TO DP013-MESSAGE-TEXT(1)       83160000
831700         PERFORM DP013-0000-PROCESS-ABEND                         83170000
831800     END-IF.                                                      83180000
831900 EJECT                                                            83190000
832000*----------------------------------------------------------------*83200000
832100* READ A LIST QUEUE RECORD AND MOVE THE KEYS OF SELECTED OBJECTS *83210000
832200* TO THE SELECTED ITEMS TEMP STORAGE QUEUE RECORD.               *83220000
832300*----------------------------------------------------------------*83230000
832400                                                                  83240000
832500 5200-FILL-SEL-QUEUE-RECORD.                                      83250000
832600                                                                  83260000
832700     PERFORM 6112-READ-LIST-QUEUE.                                83270000
832800                                                                  83280000
832900     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       83290000
833000         PERFORM                                                  83300000
833100         VARYING LQW-IDX                                          83310000
833200         FROM 1 BY 1                                              83320000
833300         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            83330000
833400           OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO          83340000
833500                                                                  83350000
833600             IF  LQW-SELECT (LQW-IDX)                             83360000
833700                 MOVE LQW-LIST-ITEM-NUMBER(LQW-IDX)               83370000
833800                            TO CN026-ITEM          (CN026-IDX)    83380000
833900                 MOVE LQW-ACTION (LQW-IDX)                        83390000
834000                            TO CN026-ACTION-SW     (CN026-IDX)    83400000
834100                 MOVE LQW-FUNC-CODE  (LQW-IDX)                    83410000
834200                            TO CN026-PARM-NAME     (CN026-IDX)    83420000
834300                 MOVE ASC-PARM-DESC                               83430023
834400                            TO CN026-PARM-DESC     (CN026-IDX)    83440000
834500                                                                  83450000
834501                 MOVE  LQW-DEFN-SEQ          (LQW-IDX)            83450114
834502                            TO CN026-DEFN-SEQ      (CN026-IDX)    83450214
834503                 MOVE  LQW-ATTR-DESC         (LQW-IDX)            83450314
834504                            TO CN026-ATTR-DESC     (CN026-IDX)    83450414
834540                                                                  83454014
834600                 MOVE  LQW-REQD              (LQW-IDX)            83460000
834700                            TO CN026-REQD          (CN026-IDX)    83470000
834800                 MOVE  LQW-DATA-TYPE         (LQW-IDX)            83480000
834900                            TO CN026-DATA-TYPE     (CN026-IDX)    83490000
835000                 MOVE  LQW-MAX-LENGTH        (LQW-IDX)            83500000
835100                            TO CNO26-MAX-LENGTH    (CN026-IDX)    83510000
835200                 MOVE  LQW-DECIMAL-POSITIONS (LQW-IDX)            83520000
835300                            TO CNO26-DECIMAL-POSITION             83530000
835400                                                   (CN026-IDX)    83540000
835500                 MOVE  LQW-ELEM-COUNT        (LQW-IDX)            83550000
835600                            TO CNO26-ELEM-CNT      (CN026-IDX)    83560000
837800                                                                  83780000
837900                 SET CN026-IDX UP BY 1                            83790000
838000                 IF  CN026-IDX > CN026-MAX-ITEMS                  83800000
838100                     PERFORM 5205-WRITE-SEL-QUEUE                 83810000
838200                     ADD +1        TO CN025-NUMBER-OF-TS-ITEMS    83820000
838300                     INITIALIZE CN026-SELECTED-ITEM-ARRAY         83830000
838400                     SET CN026-IDX TO  1                          83840000
838500                 END-IF                                           83850000
838600             END-IF                                               83860000
838700         END-PERFORM                                              83870000
838800     END-IF.                                                      83880000
838900                                                                  83890000
839000*----------------------------------------------------------------*83900000
839100*    WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE.                *83910000
839200*----------------------------------------------------------------*83920000
839300                                                                  83930000
839400 5205-WRITE-SEL-QUEUE.                                            83940000
839500                                                                  83950000
839600     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            83960000
839700                                   TO CN026-SELECTED-ITEMS.       83970000
839800                                                                  83980000
839900     EXEC CICS                                                    83990000
840000          WRITEQ TS                                               84000000
840100              QUEUE (ASC-SEL-QUEUE-NAME)                          84010000
840200              FROM  (CN026-SELECT-RECORD)                         84020000
840300              ITEM  (PV-SEL-QUEUE-ITEM)                           84030000
840400              RESP  (PV-CICS-RESP)                                84040000
840500     END-EXEC.                                                    84050000
840600                                                                  84060000
840700     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          84070000
840800         CONTINUE                                                 84080000
840900     ELSE                                                         84090000
841000         SET DP013-CICS-ABEND      TO TRUE                        84100000
841100         SET DP013-NO-ROLLBACK     TO TRUE                        84110000
841200         MOVE '5205-WRITE-SEL-QUEUE'                              84120000
841300                                   TO DP013-PARAGRAPH             84130000
841400         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          84140000
841500                                   TO DP013-MESSAGE-TEXT(1)       84150000
841600         PERFORM DP013-0000-PROCESS-ABEND                         84160000
841700     END-IF.                                                      84170000
841800 EJECT                                                            84180000
841900******************************************************************84190000
842000** WHEN RETURNING TO THIS TRANSACTION FROM ANOTHER TRANSACTION, **84200000
842100** SETUP THE ARRAY AS IT WAS WHEN WE HAD LEFT PREVIOUSLY.  EDIT **84210000
842200** THE SELECTIONS MADE AT THAT TIME AND DISPLAY THE PANEL TO    **84220000
842300** THE USER.                                                    **84230000
842400******************************************************************84240000
842500 6000-REFRESH-PANEL-FROM-TEMP.                                    84250000
842600                                                                  84260000
842700     IF  ASC-UPDATE-TSQ AND ASC-NUMBER-OF-SELECTED-ITEMS > 0      84270000
842800         SET ASC-NO-TSQ-UPDATE TO TRUE                            84280000
842900         MOVE ZERO                 TO PV-SAVE-ITEM                84290000
843000                                      PV-SEL-QUEUE-ITEM           84300000
843100         MOVE ASC-NUMBER-OF-SELECTED-ITEMS                        84310000
843200                                   TO PV-HOLD-SELECTED-ITEMS      84320000
843300         MOVE +1                   TO PV-ITEMS-PROCESSED          84330000
843400         PERFORM 6100-UPDATE-TSQ                                  84340000
843500             UNTIL PV-ITEMS-PROCESSED >                           84350000
843600                                     PV-HOLD-SELECTED-ITEMS       84360000
843700         PERFORM 6010-DELETE-SEL-QUEUE                            84370000
843800         INITIALIZE ASC-BLOCK-ENTRIES (1)                         84380000
843900                    ASC-BLOCK-ENTRIES (2)                         84390000
844000     END-IF.                                                      84400000
844100                                                                  84410000
844200*----------------------------------------------------------------*84420000
844300*    DELETE THE SELECTED ITEMS TEMP STORAGE QUEUE.               *84430000
844400*----------------------------------------------------------------*84440000
844500 6010-DELETE-SEL-QUEUE.                                           84450000
844600                                                                  84460000
844700     EXEC CICS                                                    84470000
844800         DELETEQ TS                                               84480000
844900             QUEUE (ASC-SEL-QUEUE-NAME)                           84490000
845000             RESP  (PV-CICS-RESP)                                 84500000
845100     END-EXEC.                                                    84510000
845200*                                                                 84520000
845300     IF ((PV-CICS-RESP = DFHRESP(NORMAL)) OR                      84530000
845400        (PV-CICS-RESP = DFHRESP(QIDERR)))                         84540000
845500         CONTINUE                                                 84550000
845600     ELSE                                                         84560000
845700         SET DP013-CICS-ABEND TO TRUE                             84570000
845800         SET DP013-NO-ROLLBACK TO TRUE                            84580000
845900         MOVE '6010-DELETE-SEL-QUEUE'                             84590000
846000                        TO DP013-PARAGRAPH                        84600000
846100         MOVE 'ERROR TRYING TO DELETE SELECTION TS QUEUE'         84610000
846200                        TO DP013-MESSAGE-TEXT (1)                 84620000
846300         PERFORM DP013-0000-PROCESS-ABEND                         84630000
846400     END-IF.                                                      84640000
846500                                                                  84650000
846600*----------------------------------------------------------------*84660000
846700*    INCREMENT THE TSQ ITEM NUMBER AND READ THE LIST QUEUE.      *84670000
846800*    LOOP THROUGH THE LIST QUEUE TO OBTAIN THE LINE ITEM NUMBER  *84680000
846900*    TO BE USED TO UPDATE (DESELECT) THE CORRECT LINE ITEM IN    *84690000
847000*    THE TEMP QUEUE.                                             *84700000
847100*----------------------------------------------------------------*84710000
847200                                                                  84720000
847300 6100-UPDATE-TSQ.                                                 84730000
847400                                                                  84740000
847500     ADD 1                     TO  PV-SEL-QUEUE-ITEM.             84750000
847600     PERFORM 6105-READ-SEL-QUEUE.                                 84760000
847700     PERFORM                                                      84770000
847800         VARYING CN026-IDX                                        84780000
847900         FROM 1 BY 1                                              84790000
848000         UNTIL ((PV-ITEMS-PROCESSED >                             84800000
848100                              PV-HOLD-SELECTED-ITEMS)             84810000
848200         OR (CN026-IDX GREATER THAN CN026-MAX-ITEMS))             84820000
848300         IF  CN026-ACTION-SW (CN026-IDX) > SPACE                  84830000
848400             PERFORM 6110-PROCESS-ITEMS                           84840000
848500         END-IF                                                   84850000
848600         ADD +1                TO PV-ITEMS-PROCESSED              84860000
848700     END-PERFORM.                                                 84870000
848800     PERFORM 6111-WRITE-LIST-QUEUE.                               84880000
848900*----------------------------------------------------------------*84890000
849000*    READ THE LIST QUEUE RECORD.                                 *84900000
849100*----------------------------------------------------------------*84910000
849200                                                                  84920000
849300 6105-READ-SEL-QUEUE.                                             84930000
849400                                                                  84940000
849500     EXEC CICS                                                    84950000
849600          READQ TS                                                84960000
849700              QUEUE (ASC-SEL-QUEUE-NAME)                          84970000
849800              INTO  (CN026-SELECT-RECORD)                         84980000
849900              ITEM  (PV-SEL-QUEUE-ITEM)                           84990000
850000              RESP  (PV-CICS-RESP)                                85000000
850100     END-EXEC.                                                    85010000
850200*                                                                 85020000
850300     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          85030000
850400         CONTINUE                                                 85040000
850500     ELSE                                                         85050000
850600         SET DP013-CICS-ABEND      TO  TRUE                       85060000
850700         SET DP013-NO-ROLLBACK     TO  TRUE                       85070000
850800         MOVE '6105-READ-SEL-QUEUE'                               85080000
850900                                   TO  DP013-PARAGRAPH            85090000
851000         MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           85100000
851100                                   TO  DP013-MESSAGE-TEXT(1)      85110000
851200                                                                  85120000
851300         MOVE ASC-SEL-TERM-ID      TO PV-SEL-TERM-ID              85130000
851400         MOVE ASC-SEL-TASK-NUMBER  TO PV-SEL-TASK-NUMBER          85140000
851500         MOVE ASC-SEL-SEQ          TO PV-SEL-SEQ                  85150000
851600         STRING ' QUEUE TERM ID-'                                 85160000
851700                 PV-SEL-TERM-ID                                   85170000
851800                ' QUEUE TASK-'                                    85180000
851900                 PV-SEL-TASK-NUMBER                               85190000
852000                ' QUEUE SEQ-'                                     85200000
852100                 PV-SEL-SEQ           DELIMITED BY SIZE           85210000
852200                                 INTO  DP013-MESSAGE-TEXT(2)      85220000
852300         PERFORM DP013-0000-PROCESS-ABEND                         85230000
852400     END-IF.                                                      85240000
852500 EJECT                                                            85250000
852600*----------------------------------------------------------------*85260000
852700*    CALCULATE THE TEMP QUEUE ITEM THAT MUST BE READ AND READ IT.*85270000
852800*    REWRITE THE CURRENT TEMP QUEUE ITEM IF NECESSARY.  CALCULATE*85280000
852900*    THE LINE ITEM OCCURENCE AND UPDATE (DESELECT) IT.           *85290000
853000*----------------------------------------------------------------*85300000
853100                                                                  85310000
853200 6110-PROCESS-ITEMS.                                              85320000
853300                                                                  85330000
853400     COMPUTE PV-ITEM = 1 + ((CN026-ITEM (CN026-IDX) - 1)          85340000
853500                     / PC-ITEMS-PER-PANEL).                       85350000
853600                                                                  85360000
853700     IF  PV-ITEM NOT EQUAL PV-SAVE-ITEM                           85370000
853800         IF  PV-SAVE-ITEM NOT EQUAL ZERO                          85380000
853900             PERFORM 6111-WRITE-LIST-QUEUE                        85390000
854000         END-IF                                                   85400000
854100         MOVE PV-ITEM          TO PV-SAVE-ITEM                    85410000
854200                                                                  85420000
854300         PERFORM 6112-READ-LIST-QUEUE                             85430000
854400         IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)               85440000
854500             CONTINUE                                             85450000
854600         END-IF                                                   85460000
854700     END-IF.                                                      85470000
854800                                                                  85480000
854900     COMPUTE PV-SUB = (CN026-ITEM (CN026-IDX)                     85490000
855000                    - LQW-LIST-ITEM-NUMBER (1)) + 1.              85500000
855100     SET LQW-DESELECT (PV-SUB) TO    TRUE                         85510000
855200     MOVE LQW-SELECTED-SW (PV-SUB)                                85520000
855300                               TO LQW-TEMP-SELECTED-SW (PV-SUB).  85530000
855400     EVALUATE TRUE                                                85540000
855500         WHEN CN026-INQ (CN026-IDX)                               85550000
855600              MOVE PC-INQ      TO LQW-ACTION (PV-SUB)             85560000
855700                                                                  85570000
855800         WHEN CN026-UPD (CN026-IDX)                               85580000
855900              MOVE PC-UPD      TO LQW-ACTION (PV-SUB)             85590000
855910              MOVE CN026-PARM-NAME (CN026-IDX)                    85591000
855920                               TO LQW-FUNC-CODE (PV-SUB)          85592000
855930              MOVE CN026-PARM-DESC (CN026-IDX)                    85593000
855940                               TO LQW-FUNC-DESC (PV-SUB)          85594000
855950              MOVE CN026-DEFN-SEQ  (CN026-IDX)                    85595000
855960                               TO LQW-DEFN-SEQ  (PV-SUB)          85596000
855970              MOVE CN026-ATTR-DESC (CN026-IDX)                    85597000
855980                               TO LQW-ATTR-DESC (PV-SUB)          85598000
855990              MOVE CN026-REQD      (CN026-IDX)                    85599000
855991                               TO LQW-REQD      (PV-SUB)          85599100
855992              MOVE CN026-DATA-TYPE (CN026-IDX)                    85599200
855993                               TO LQW-DATA-TYPE (PV-SUB)          85599300
855994              MOVE CNO26-MAX-LENGTH(CN026-IDX)                    85599400
855995                               TO LQW-MAX-LENGTH(PV-SUB)          85599500
855996              MOVE CNO26-DECIMAL-POSITION(CN026-IDX)              85599600
855997                               TO LQW-DECIMAL-POSITIONS(PV-SUB)   85599700
856000                                                                  85600000
856100         WHEN CN026-DEL (CN026-IDX)                               85610000
856200              MOVE PC-DEL      TO LQW-ACTION (PV-SUB)             85620000
856300                                                                  85630000
856400         WHEN CN026-ERR (CN026-IDX)                               85640000
856500              MOVE PC-ERR      TO LQW-ACTION (PV-SUB)             85650000
856600     END-EVALUATE.                                                85660000
856700                                                                  85670000
856800     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                85680000
856900                                                                  85690000
857000*----------------------------------------------------------------*85700000
857100*    WRITE THE TS QUEUE RECORD JUST UPDATED IN C600.             *85710000
857200*----------------------------------------------------------------*85720000
857300                                                                  85730000
857400 6111-WRITE-LIST-QUEUE.                                           85740000
857500                                                                  85750000
857600     EXEC CICS                                                    85760000
857700         WRITEQ TS                                                85770000
857800             QUEUE (ASC-LIST-QUEUE-NAME)                          85780000
857900             FROM  (LQW-LIST-QUEUE-WORK-AREA)                     85790000
858000             ITEM  (PV-SAVE-ITEM)                                 85800000
858100             REWRITE                                              85810000
858200             RESP  (PV-CICS-RESP)                                 85820000
858300     END-EXEC.                                                    85830000
858400*                                                                 85840000
858500     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          85850000
858600         CONTINUE                                                 85860000
858700     ELSE                                                         85870000
858800         SET DP013-CICS-ABEND  TO  TRUE                           85880000
858900         SET DP013-NO-ROLLBACK TO  TRUE                           85890000
859000         MOVE '6111-WRITE-LIST-QUEUE'                             85900000
859100                               TO  DP013-PARAGRAPH                85910000
859200         MOVE 'ATTEMPTING TO REWRITE LIST QUEUE'                  85920000
859300                               TO  DP013-MESSAGE-TEXT(1)          85930000
859400         PERFORM DP013-0000-PROCESS-ABEND                         85940000
859500     END-IF.                                                      85950000
859600                                                                  85960000
859700 EJECT                                                            85970000
859800*----------------------------------------------------------------*85980000
859900*    READ THE TEMPORARY STORAGE QUEUE INTO A TEMPORARY WORK AREA.*85990000
860000*----------------------------------------------------------------*86000000
860100                                                                  86010000
860200 6112-READ-LIST-QUEUE.                                            86020000
860300                                                                  86030000
860400     EXEC CICS                                                    86040000
860500         READQ TS                                                 86050000
860600             QUEUE (ASC-LIST-QUEUE-NAME)                          86060000
860700             INTO  (LQW-LIST-QUEUE-WORK-AREA)                     86070000
860800             ITEM  (PV-ITEM)                                      86080000
860900             RESP  (PV-CICS-RESP)                                 86090000
861000     END-EXEC.                                                    86100000
861100*                                                                 86110000
861200     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          86120000
861300         CONTINUE                                                 86130000
861400     ELSE                                                         86140000
861500         SET DP013-CICS-ABEND        TO TRUE                      86150000
861600         SET DP013-NO-ROLLBACK       TO TRUE                      86160000
861700         MOVE '6112-READ-LIST-QUEUE' TO DP013-PARAGRAPH           86170000
861800         MOVE 'ATTEMPTING TO READQ LIST QUEUE'                    86180000
861900                                     TO DP013-MESSAGE-TEXT(1)     86190000
862000         PERFORM DP013-0000-PROCESS-ABEND                         86200000
862100     END-IF.                                                      86210000
871600                                                                  87160000
871610*----------------------------------------------------------------*87161005
871620* READ AN ITEM FROM THE SELECTED ITEMS TEMP STORAGE QUEUE.       *87162005
871630*----------------------------------------------------------------*87163005
871640 9100-READ-SEL-QUEUE.                                             87164005
871650     EXEC CICS                                                    87165005
871660         READQ TS                                                 87166005
871670             QUEUE (ASC-SEL-QUEUE-NAME)                           87167005
871680             INTO  (CN024-SELECT-RECORD)                          87168006
871690             ITEM  (ASC-SEL-ITEM)                                 87169005
871691             RESP  (PV-CICS-RESP)                                 87169105
871692     END-EXEC.                                                    87169205
871693     IF PV-CICS-RESP EQUAL DFHRESP(NORMAL)                        87169305
871694         CONTINUE                                                 87169405
871695     ELSE                                                         87169505
871696         SET DP013-LOGIC-ABEND                                    87169605
871697             DP013-NO-ROLLBACK   TO   TRUE                        87169705
871698         MOVE '9100-READ-SEL-QUEUE'                               87169805
871699                                 TO   DP013-PARAGRAPH             87169905
871700         MOVE 'ATTEMPTING TO READ THE LIST SELECTIONS TS QUEUE'   87170005
871701                                 TO   DP013-MESSAGE-TEXT (1)      87170105
871702         PERFORM DP013-0000-PROCESS-ABEND                         87170205
871703     END-IF.                                                      87170305
871704                                                                  87170405
871705                                                                  87170505
871706*----------------------------------------------------------------*87170605
871707* UPDATE AN ITEM IN THE SELECTED ITEMS TEMP STORAGE QUEUE.       *87170705
871708*----------------------------------------------------------------*87170805
871709 9200-REWRITE-SEL-QUEUE.                                          87170905
871710                                                                  87171005
871711     EXEC CICS                                                    87171105
871712          WRITEQ TS                                               87171205
871713              QUEUE  (ASC-SEL-QUEUE-NAME)                         87171305
871714              FROM   (CN024-SELECT-RECORD)                        87171406
871715              ITEM   (ASC-SEL-ITEM)                               87171505
871716              RESP   (PV-CICS-RESP)                               87171605
871717              REWRITE                                             87171705
871718     END-EXEC.                                                    87171805
871719                                                                  87171905
871720     IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)                   87172005
871721         SET DP013-CICS-ABEND                                     87172105
871722             DP013-NO-ROLLBACK     TO TRUE                        87172205
871723         MOVE '9200-REWRITE-SEL-QUEUE'                            87172305
871724                                   TO DP013-PARAGRAPH             87172405
871725         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   87172505
871726                                   TO DP013-MESSAGE-TEXT (1)      87172605
871727         PERFORM DP013-0000-PROCESS-ABEND                         87172705
871728     END-IF.                                                      87172805
871729                                                                  87172905
871730                                                                  87173005
871740*----------------------------------------------------------------*87174000
871800*    THE DB2 RESOURCE IS NOT AVAILABLE, DISPLAY A MESSAGE ON     *87180000
871900*    THE TERMINAL INDICATING THAT THE RESOURCE IS UNAVAILABLE.   *87190000
872000*----------------------------------------------------------------*87200000
872100 9900-SOFT-ABORT.                                                 87210000
872200                                                                  87220000
872300     EXEC CICS SYNCPOINT                                          87230000
872400          ROLLBACK                                                87240000
872500     END-EXEC.                                                    87250000
872600                                                                  87260000
872700     SET  PS-ERROR                                                87270000
872800          PS-SOFT-ABORT-ERROR                                     87280000
872900          DP020-MSG-FATAL       TO  TRUE.                         87290000
873000                                                                  87300000
873100                                                                  87310000
873200*----------------------------------------------------------------*87320000
873300*    ABEND PROCESSOR MODULE                                      *87330000
873400*----------------------------------------------------------------*87340000
873500                                                                  87350000
873600     COPY DPPD013.                                                87360000
