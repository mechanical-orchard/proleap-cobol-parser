000100******************************************************************00010001
000200 IDENTIFICATION DIVISION.                                         00020001
000300******************************************************************00030001
000400                                                                  00040001
000500 PROGRAM-ID.                RCKUT806.                             00050001
000510                                                                  00051001
000520 AUTHOR.                    GERMAN BANDA.                         00052001
000530                                                                  00053001
000540 INSTALLATION.              KOHLS DEPARTMENT STORES.              00054001
000550                                                                  00055001
000560 DATE-WRITTEN.              MAY 2003.                             00056001
000570                                                                  00057001
000580 DATE-COMPILED.                                                   00058001
000590                                                                  00059001
000600******************************************************************00060001
000700*  BATCH PROGRAM - THIS IS THE BATCH VERSION OF THE PREPACK      *00070001
000800*      VALIDATION. ANY LOGIC CHANGES SHOULD ALSO BE MADE TO THE  *00080001
000900*      CICS VERSION (RCKCS806)                                   *00090001
000910* *                                                               00091001
000920*      ROUTINE.  IT'S BASIC FUNCTIONS ARE:                       *00092001
000930*      1. VALIDATE LINE RATIO-TO-ORDER QUANTITY.                 *00093001
000940*      2. DETERMINE THE 'DRIVER' LINE.                           *00094001
000950*      3. CALCULATE THE 'BEST CASE RECEIPT' OF EACH LINE.        *00095001
000960******************************************************************00096001
000970******************************************************************00097001
000980                                                                  00098001
000990                                                                  00099001
001000 ENVIRONMENT DIVISION.                                            00100001
001100******************************************************************00110001
001200                                                                  00120001
001300                                                                  00130001
001400******************************************************************00140001
001500 DATA DIVISION.                                                   00150001
001600******************************************************************00160001
001700                                                                  00170001
001800 WORKING-STORAGE SECTION.                                         00180001
001900                                                                  00190001
002000 01  FILLER                      PIC X(28) VALUE                  00200001
002100                                          'RCKUT806 START OF W/S'.00210001
002200 01  PV-PROGRAM-VARIABLES.                                        00220001
002300     05  PV-TOT-RATIO            PIC S9(07)       VALUE +0 COMP-3.00230001
002400     05  PV-TOT-PACK-QTY         PIC S9(07)       VALUE +0 COMP-3.00240001
002500     05  PV-WRK-RATIO            PIC S9(05)       VALUE +0 COMP-3.00250001
002510     05  PV-WRK-QTY              PIC S9(07)       VALUE +0 COMP-3.00251001
002520     05  PV-WRK-REMAINDER        PIC S9(05)       VALUE +0 COMP-3.00252001
002530     05  PV-HOLD-WRK-QTY         PIC S9(07)       VALUE +0 COMP-3.00253001
002540     05  PV-WRK-PACKS            PIC S9(07)V9(04) VALUE +0 COMP-3.00254001
002550     05  PV-HOLD-WRK-PACKS       PIC S9(07)V9(04) COMP-3          00255001
002560                                             VALUE +9999999.9999. 00256001
002570     05  PV-VARIANCE             PIC S9(07)V9(04) VALUE +0 COMP-3.00257001
002580     05  PV-HOLD-LINE-NBR        PIC S9(05)       VALUE +1 COMP-3.00258001
002590                                                                  00259001
002600 01  PS-SUBSRIPTS.                                                00260001
002700     05  PS-LNE-SUB              PIC S9(04)       VALUE +1 COMP.  00270001
002800                                                                  00280001
002900 01  PS-SWITCHES.                                                 00290001
003000                                                                  00300001
003100     05  PS-VARY-OVER-SW         PIC X(01)  VALUE SPACE.          00310001
003200         88  PS-VARIANCE-OVER               VALUE 'Y'.            00320001
003300                                                                  00330001
003400     05  PS-VARY-UNDER-SW        PIC X(01)  VALUE SPACE.          00340001
003500         88  PS-VARIANCE-UNDER              VALUE 'Y'.            00350001
003600                                                                  00360001
003700 01  PC-CONSTANTS.                                                00370001
003800     05  PC-1                    PIC  X(01)  VALUE '1'.           00380001
003900     05  PC-Y                    PIC  X(01)  VALUE 'Y'.           00390001
004000     05  PC-N                    PIC  X(01)  VALUE 'N'.           00400001
004100     05  PC-MAX-LINES            PIC S9(03)  VALUE +100.          00410001
004200                                                                  00420001
004300                                                                  00430001
004400* -------------------------------------------------------------- *00440001
004500*    LAYOUT FOR THE ABEND MODULE COMMUNICATIONS AREA.             00450001
004600* -------------------------------------------------------------- *00460001
004700                                                                  00470001
004800     COPY DPWS013.                                                00480005
004900                                                                  00490001
005000     COPY RCWS806.                                                00500001
005100                                                                  00510001
005200                                                                  00520001
005300* -------------------------------------------------------------- *00530001
005400 LINKAGE SECTION.                                                 00540001
005500* -------------------------------------------------------------- *00550001
005600                                                                  00560001
005700 01  DFHCOMMAREA.                                                 00570001
005800     05  FILLER                       OCCURS 15035 TIMES.         00580001
005900*                                     DEPENDING ON EIBCALEN.      00590001
006000         10  FILLER                   PIC X.                      00600001
006100                                                                  00610001
006200                                                                  00620001
006300* -------------------------------------------------------------- *00630001
006400 PROCEDURE DIVISION USING DFHCOMMAREA.                            00640001
006500* -------------------------------------------------------------- *00650001
006600                                                                  00660001
006700 0000-MAINLINE.                                                   00670001
006800                                                                  00680001
006900     MOVE DFHCOMMAREA TO RC806-PRODUCT-PACK-VALIDATION.           00690001
007000                                                                  00700001
007100* -------------------------------------------------------------- *00710001
007200*    INITIALIZE ALL FIELDS THAT RETURN TO THE HOST PROGRAM AND    00720001
007300*    CHECK INCOMING RATIOS AND LINE ORDER QUANTITIES FOR VALID    00730001
007400*    DATA.                                                        00740001
007500* -------------------------------------------------------------- *00750001
007600                                                                  00760001
007700     INITIALIZE RC806-PACK-STATUS                                 00770001
007800                RC806-BEST-CASE-PACKS                             00780001
007900                RC806-INNER-PACK-RATIO-TOT                        00790001
008000                RC806-OUTER-PACK-RATIO-TOT                        00800001
008100                RC806-UNITS-PER-CARTON                            00810001
008200                RC806-NBR-OF-PACKS                                00820001
008300                RC806-TOTAL-NBR-OF-CARTONS                        00830001
008400                RC806-DRIVER-LNE-SUB                              00840001
008500                RC806-ERROR-FLAGS                                 00850001
008510                                                                  00851001
008520     MOVE +0 TO PV-TOT-RATIO                                      00852001
008530                PV-TOT-PACK-QTY                                   00853001
008540                PV-WRK-RATIO                                      00854001
008550                PV-WRK-QTY                                        00855001
008560                PV-WRK-REMAINDER                                  00856001
008570                PV-HOLD-WRK-QTY                                   00857001
008580                PV-WRK-PACKS                                      00858001
008590                PV-VARIANCE                                       00859001
008591     MOVE  +9999999.9999  TO PV-HOLD-WRK-PACKS                    00859102
008592                                                                  00859201
008593     MOVE +1 TO PV-HOLD-LINE-NBR                                  00859301
008594                PS-LNE-SUB                                        00859401
008595     MOVE SPACE                                                   00859501
008596             TO PS-VARY-OVER-SW                                   00859601
008597                PS-VARY-UNDER-SW                                  00859701
008598                                                                  00859801
008599     IF RC806-NBR-OF-LINES NUMERIC                                00859901
008600         IF RC806-NBR-OF-LINES > +0                               00860001
008610             CONTINUE                                             00861001
008700         ELSE                                                     00870001
008800             SET RC806-INV-NBR-OF-LINES TO TRUE                   00880001
008900         END-IF                                                   00890001
009000     ELSE                                                         00900001
009100         MOVE +0  TO RC806-NBR-OF-LINES                           00910001
009200         SET RC806-INV-NBR-OF-LINES TO TRUE                       00920001
009300     END-IF.                                                      00930001
009400                                                                  00940001
009500     PERFORM                                                      00950001
009600       UNTIL PS-LNE-SUB > PC-MAX-LINES                            00960001
009700         INITIALIZE RC806-BEST-CASE-UNITS (PS-LNE-SUB)            00970001
009800                    RC806-ODD-UNITS       (PS-LNE-SUB)            00980001
009900                    RC806-PCNT-VARIANCE   (PS-LNE-SUB)            00990001
010000                    RC806-LINE-STAT       (PS-LNE-SUB)            01000001
010100                    RC806-VARIANCE-TYPE   (PS-LNE-SUB)            01010001
010200         IF PS-LNE-SUB > RC806-NBR-OF-LINES                       01020001
010300             CONTINUE                                             01030001
010400         ELSE                                                     01040001
010500             IF RC806-PO-RATIO (PS-LNE-SUB) NOT NUMERIC   OR      01050001
010600                RC806-RC-RATIO (PS-LNE-SUB) NOT NUMERIC   OR      01060001
010700                RC806-UNIT-QTY (PS-LNE-SUB) NOT NUMERIC   OR      01070001
010800                RC806-RCVG-QTY (PS-LNE-SUB) NOT NUMERIC           01080001
010900                 SET RC806-LINE-NOT-NUMERIC (PS-LNE-SUB)          01090001
011000                     RC806-INV-LINE-DATA TO TRUE                  01100001
011100             END-IF                                               01110001
011200         END-IF                                                   01120001
011300         ADD +1  TO PS-LNE-SUB                                    01130001
011400     END-PERFORM.                                                 01140001
011500                                                                  01150001
011600     IF RC806-INV-LINE-DATA    OR                                 01160001
011700        RC806-INV-NBR-OF-LINES                                    01170001
011800         GO TO 8000-END                                           01180001
011900*        PERFORM 8000-END                                         01190001
012000     END-IF.                                                      01200001
012100                                                                  01210001
012200     IF NOT RC806-VALID-FUNCTION                                  01220001
012300         SET RC806-INV-FUNCTION-CD TO TRUE                        01230001
012400         GO TO 8000-END                                           01240001
012500*        PERFORM 8000-END                                         01250001
012600     END-IF.                                                      01260001
012700                                                                  01270001
012800     MOVE +1  TO PS-LNE-SUB                                       01280001
012900                                                                  01290001
013000     PERFORM 1000-PROCESS-LINES                                   01300001
013100       UNTIL PS-LNE-SUB > RC806-NBR-OF-LINES                      01310001
013200          OR PS-LNE-SUB > PC-MAX-LINES                            01320001
013300                                                                  01330001
013400     PERFORM 1100-FINISH-PROCESS                                  01340001
013500                                                                  01350001
013600     GO TO 8000-END.                                              01360001
013700*    PERFORM 8000-END.                                            01370001
013800                                                                  01380001
013900                                                                  01390001
014000 1000-PROCESS-LINES.                                              01400001
014100                                                                  01410001
014200     EVALUATE TRUE                                                01420001
014300                                                                  01430001
014400         WHEN RC806-VALIDATE-RATIO                                01440001
014500             PERFORM 2000-VALIDATE-RATIO                          01450001
014600                                                                  01460001
014610         WHEN RC806-CALC-BEST-CASE                                01461001
014620             PERFORM 3000-VARY-DRIVER-CALCS                       01462001
014630                                                                  01463001
014640         WHEN RC806-VALIDATE-AND-CALC                             01464001
014650             PERFORM 2000-VALIDATE-RATIO                          01465001
014660             PERFORM 3000-VARY-DRIVER-CALCS                       01466001
014670                                                                  01467001
014680     END-EVALUATE.                                                01468001
014690                                                                  01469001
014700* -------------------------------------------------------------- *01470001
014800*    IF JUST VALIDATING RATIO, ACCUMULATE THE P.O. QUANTITIES     01480001
014900*    OTHERWISE ACCUMULATE THE RECEIVING QUANTITIES.               01490001
015000* -------------------------------------------------------------- *01500001
015100                                                                  01510001
015200     IF RC806-VALIDATE-RATIO                                      01520001
015300         IF RC806-PO-RATIO (PS-LNE-SUB) NUMERIC                   01530001
015400             ADD RC806-PO-RATIO (PS-LNE-SUB) TO PV-TOT-RATIO      01540001
015500         END-IF                                                   01550001
015600         IF RC806-UNIT-QTY (PS-LNE-SUB) NUMERIC                   01560001
015700             ADD RC806-UNIT-QTY (PS-LNE-SUB) TO PV-TOT-PACK-QTY   01570001
015800         END-IF                                                   01580001
015900     ELSE                                                         01590001
015901         IF RC806-RC-RATIO (PS-LNE-SUB) NUMERIC                   01590101
015902             ADD RC806-RC-RATIO (PS-LNE-SUB) TO PV-TOT-RATIO      01590201
015903         END-IF                                                   01590301
015904         IF RC806-RCVG-QTY (PS-LNE-SUB) NUMERIC                   01590401
015905             ADD RC806-RCVG-QTY (PS-LNE-SUB) TO PV-TOT-PACK-QTY   01590501
015906         END-IF                                                   01590601
015907     END-IF.                                                      01590701
015908                                                                  01590801
015909     ADD +1 TO PS-LNE-SUB.                                        01590901
015910                                                                  01591001
015920                                                                  01592001
015930 1100-FINISH-PROCESS.                                             01593001
015940                                                                  01594001
015950     PERFORM 5000-BEST-CASE.                                      01595001
015960                                                                  01596001
015970     MOVE +1 TO PS-LNE-SUB                                        01597001
015980                                                                  01598001
015990     PERFORM 4000-PROCESS-LINES-AGAIN                             01599001
016000       UNTIL PS-LNE-SUB > RC806-NBR-OF-LINES                      01600001
016100          OR PS-LNE-SUB > PC-MAX-LINES                            01610001
016200                                                                  01620001
016300* -------------------------------------------------------------- *01630001
016400*    FOR 'INNER PREPACK' ORDERS:                                  01640001
016500*    IF COMING FROM P.O. SYSTEM, INNER PACK QUANTITY IS           01650001
016600*    TOTAL UNITS PER CARTON, SO NUMBER OF PACKS PER CARTON        01660001
016700*    WILL BE CALCULATED AND BOTH NUMBERS WILL BE SENT BACK.       01670001
016800*    IF COMING FROM RECEIVING SYSTEM, INNER PACK QUANTITY IS      01680001
016900*    NUMBER OF PACKS PER CARTON, SO TOTAL UNITS PER CARTON        01690001
017000*    WILL BE CALCULATED AND BOTH NUMBERS WILL BE SENT BACK.       01700001
017100* -------------------------------------------------------------- *01710001
017200                                                                  01720001
017300     MOVE PV-TOT-RATIO  TO  RC806-INNER-PACK-RATIO-TOT.           01730001
017400                                                                  01740001
017500     IF RC806-INNER-PACK-QTY > +0                                 01750001
017600         IF RC806-VALIDATE-RATIO                                  01760001
017700             DIVIDE RC806-INNER-PACK-QTY                          01770001
017800               BY   PV-TOT-RATIO                                  01780001
017900               GIVING RC806-NBR-OF-PACKS                          01790001
018000             MOVE RC806-INNER-PACK-QTY TO RC806-UNITS-PER-CARTON  01800001
018100         ELSE                                                     01810001
018200             MULTIPLY RC806-INNER-PACK-QTY                        01820001
018300               BY     PV-TOT-RATIO                                01830001
018400               GIVING RC806-UNITS-PER-CARTON                      01840001
018500             MOVE RC806-INNER-PACK-QTY TO RC806-NBR-OF-PACKS      01850001
018600         END-IF                                                   01860001
018700     ELSE                                                         01870001
018800         MOVE PV-TOT-RATIO  TO RC806-UNITS-PER-CARTON             01880001
018900         MOVE +1            TO RC806-NBR-OF-PACKS                 01890001
019000     END-IF.                                                      01900001
019100                                                                  01910001
019200     IF RC806-UNITS-PER-CARTON NOT = +0                           01920001
019300         DIVIDE PV-TOT-PACK-QTY BY RC806-UNITS-PER-CARTON         01930001
019400                           GIVING  RC806-TOTAL-NBR-OF-CARTONS     01940001
019500     END-IF.                                                      01950001
019600                                                                  01960001
019700     MOVE PV-TOT-RATIO      TO RC806-OUTER-PACK-RATIO-TOT         01970001
019800     MOVE PV-TOT-PACK-QTY   TO RC806-OUTER-PACK-QTY-TOT.          01980001
019900                                                                  01990001
020000                                                                  02000001
020100 2000-VALIDATE-RATIO.                                             02010001
020200                                                                  02020001
020300* -------------------------------------------------------------- *02030001
020400*    IF JUST VALIDATING RATIO, USE THE P.O. QUANTITIES            02040001
020500*    OTHERWISE USE THE RECEIVING QUANTITIES.                      02050001
020600* -------------------------------------------------------------- *02060001
020700                                                                  02070001
020800     IF RC806-VALIDATE-RATIO                                      02080001
020900         MOVE RC806-UNIT-QTY (PS-LNE-SUB) TO PV-WRK-QTY           02090001
021000         MOVE RC806-PO-RATIO (PS-LNE-SUB) TO PV-WRK-RATIO         02100001
021100     ELSE                                                         02110001
021200         MOVE RC806-RCVG-QTY (PS-LNE-SUB) TO PV-WRK-QTY           02120001
021300         MOVE RC806-RC-RATIO (PS-LNE-SUB) TO PV-WRK-RATIO         02130001
021400         IF RC806-RC-RATIO (PS-LNE-SUB) NOT =                     02140001
021500            RC806-PO-RATIO (PS-LNE-SUB)                           02150001
021600             SET RC806-BAD-PACK TO TRUE                           02160001
021700         END-IF                                                   02170001
021800     END-IF.                                                      02180001
021900                                                                  02190001
022000     INITIALIZE PV-WRK-REMAINDER                                  02200001
022100                                                                  02210001
022200     IF PV-WRK-RATIO NOT = +0                                     02220001
022300         DIVIDE PV-WRK-QTY                                        02230001
022400           BY   PV-WRK-RATIO                                      02240001
022500           GIVING PV-WRK-QTY REMAINDER PV-WRK-REMAINDER           02250001
022600     ELSE                                                         02260001
022700         IF PV-WRK-QTY > +0                                       02270001
022800             SET RC806-BAD-RATIO (PS-LNE-SUB) TO TRUE             02280001
022900         END-IF                                                   02290001
023000     END-IF.                                                      02300001
023100                                                                  02310001
023200     IF PV-WRK-REMAINDER NOT = +0                                 02320001
023300         SET RC806-BAD-RATIO (PS-LNE-SUB) TO TRUE                 02330001
023400     ELSE                                                         02340001
023500         IF PV-HOLD-WRK-QTY = +0                                  02350001
023600             MOVE PV-WRK-QTY TO PV-HOLD-WRK-QTY                   02360001
023700         END-IF                                                   02370001
023800     END-IF.                                                      02380001
023900                                                                  02390001
024000     IF (PS-LNE-SUB > +1      AND                                 02400001
024100         PV-HOLD-WRK-QTY NOT = +0)                                02410001
024200         IF PV-WRK-QTY NOT = PV-HOLD-WRK-QTY                      02420001
024300             SET RC806-BAD-PACK                                   02430001
024400                 RC806-BAD-RATIO (PS-LNE-SUB) TO TRUE             02440001
024500         END-IF                                                   02450001
024600     END-IF.                                                      02460001
024700                                                                  02470001
024800                                                                  02480001
024900 3000-VARY-DRIVER-CALCS.                                          02490001
025000                                                                  02500001
025100     IF RC806-UNIT-QTY (PS-LNE-SUB) > +0                          02510001
025200                                                                  02520001
025300         IF RC806-RC-RATIO (PS-LNE-SUB) > +0                      02530001
025400                                                                  02540001
025500             SUBTRACT RC806-UNIT-QTY (PS-LNE-SUB)                 02550001
025600                 FROM RC806-RCVG-QTY (PS-LNE-SUB)                 02560001
025700                 GIVING PV-WRK-QTY                                02570001
025800                                                                  02580001
025900             DIVIDE   PV-WRK-QTY                                  02590001
026000               BY     RC806-UNIT-QTY (PS-LNE-SUB)                 02600001
026100               GIVING PV-VARIANCE ROUNDED                         02610001
026200                                                                  02620001
026300             MULTIPLY PV-VARIANCE                                 02630001
026310                BY    +100                                        02631001
026320                GIVING PV-VARIANCE                                02632001
026330                                                                  02633001
026340             MOVE PV-VARIANCE TO PV-WRK-QTY                       02634001
026350                                                                  02635001
026360             IF PV-VARIANCE NOT = PV-WRK-QTY                      02636001
026370                 IF PV-VARIANCE > +0                              02637001
026380                     ADD +1                                       02638001
026390                         PV-WRK-QTY                               02639001
026400                     GIVING RC806-PCNT-VARIANCE (PS-LNE-SUB)      02640001
026500                 ELSE                                             02650001
026600                     SUBTRACT +1                                  02660001
026700                       FROM   PV-WRK-QTY                          02670001
026800                      GIVING  RC806-PCNT-VARIANCE (PS-LNE-SUB)    02680001
026900                 END-IF                                           02690001
027000             ELSE                                                 02700001
027100                 MOVE PV-VARIANCE                                 02710001
027200                   TO RC806-PCNT-VARIANCE (PS-LNE-SUB)            02720001
027300             END-IF                                               02730001
027400         ELSE                                                     02740001
027500             MOVE +0 TO RC806-PCNT-VARIANCE (PS-LNE-SUB)          02750001
027600                        PV-VARIANCE                               02760001
027700         END-IF                                                   02770001
027800     ELSE                                                         02780001
027900         MOVE +9999.9 TO RC806-PCNT-VARIANCE (PS-LNE-SUB)         02790001
028000                         PV-VARIANCE                              02800001
028100     END-IF.                                                      02810001
028200                                                                  02820001
028300                                                                  02830001
028400     EVALUATE TRUE                                                02840001
028500                                                                  02850001
028600       WHEN RC806-PCNT-VARIANCE (PS-LNE-SUB) < +0                 02860001
028700           SET PS-VARIANCE-UNDER                 TO TRUE          02870001
028800           SET RC806-VARIANCE-UNDER (PS-LNE-SUB) TO TRUE          02880001
028900                                                                  02890001
029000       WHEN RC806-PCNT-VARIANCE (PS-LNE-SUB) > +0                 02900001
029100           SET PS-VARIANCE-OVER                  TO TRUE          02910001
029200           SET RC806-VARIANCE-OVER (PS-LNE-SUB)  TO TRUE          02920001
029210                                                                  02921001
029220     END-EVALUATE                                                 02922001
029230                                                                  02923001
029240     IF RC806-RC-RATIO (PS-LNE-SUB) NOT = +0                      02924001
029250         DIVIDE RC806-RCVG-QTY (PS-LNE-SUB)                       02925001
029260             BY RC806-RC-RATIO (PS-LNE-SUB)                       02926001
029270             GIVING PV-WRK-PACKS ROUNDED                          02927001
029280         IF PV-WRK-PACKS < PV-HOLD-WRK-PACKS                      02928001
029290             MOVE PV-WRK-PACKS  TO PV-HOLD-WRK-PACKS              02929001
029300             MOVE PS-LNE-SUB    TO PV-HOLD-LINE-NBR               02930001
029400         END-IF                                                   02940001
029500     END-IF.                                                      02950001
029600                                                                  02960001
029700                                                                  02970001
029800 4000-PROCESS-LINES-AGAIN.                                        02980001
029900                                                                  02990001
030000* -------------------------------------------------------------- *03000001
030100*    GO THRU THE TABLE AGAIN:                                     03010001
030200*    1. CALCULATE BEST UNITS AND ODD-UNITS.                       03020001
030300* -------------------------------------------------------------- *03030001
030400                                                                  03040001
030500     IF RC806-RC-RATIO (PS-LNE-SUB) NOT = +0                      03050001
030600         MULTIPLY  RC806-BEST-CASE-PACKS                          03060001
030700            BY     RC806-RC-RATIO (PS-LNE-SUB)                    03070001
030800            GIVING RC806-BEST-CASE-UNITS (PS-LNE-SUB)             03080001
030900         IF RC806-BEST-CASE-UNITS (PS-LNE-SUB) >                  03090001
031000            RC806-RCVG-QTY        (PS-LNE-SUB)                    03100001
031100             MOVE +0 TO RC806-BEST-CASE-UNITS (PS-LNE-SUB)        03110001
031200             MOVE RC806-RCVG-QTY  (PS-LNE-SUB)                    03120001
031300               TO RC806-ODD-UNITS (PS-LNE-SUB)                    03130001
031400         ELSE                                                     03140001
031500             SUBTRACT RC806-BEST-CASE-UNITS (PS-LNE-SUB)          03150001
031600               FROM   RC806-RCVG-QTY        (PS-LNE-SUB)          03160001
031700               GIVING RC806-ODD-UNITS       (PS-LNE-SUB)          03170001
031800         END-IF                                                   03180001
031900     ELSE                                                         03190001
032000         IF RC806-RCVG-QTY (PS-LNE-SUB) > +1                      03200001
032100             MOVE RC806-RCVG-QTY  (PS-LNE-SUB)                    03210001
032200               TO RC806-ODD-UNITS (PS-LNE-SUB)                    03220001
032300         END-IF                                                   03230001
032400     END-IF.                                                      03240001
032500                                                                  03250001
032600     ADD +1 TO PS-LNE-SUB.                                        03260001
032700                                                                  03270001
032800                                                                  03280001
032900 5000-BEST-CASE.                                                  03290001
033000                                                                  03300001
033100     IF PS-VARIANCE-OVER    AND                                   03310001
033200        PS-VARIANCE-UNDER                                         03320001
033300         SET RC806-BAD-PACK TO TRUE                               03330001
033400     END-IF                                                       03340001
033500                                                                  03350001
033600     IF (NOT PS-VARIANCE-OVER)   AND                              03360001
033700         PS-VARIANCE-UNDER                                        03370001
033710         SET RC806-PACK-UNDER  TO TRUE                            03371001
033720     END-IF                                                       03372001
033730                                                                  03373001
033740     IF PS-VARIANCE-OVER   AND                                    03374001
033750       (NOT PS-VARIANCE-UNDER)                                    03375001
033760         SET RC806-PACK-OVER   TO TRUE                            03376001
033770     END-IF.                                                      03377001
033780                                                                  03378001
033790     MOVE PV-HOLD-LINE-NBR TO PS-LNE-SUB                          03379001
033800                              RC806-DRIVER-LNE-SUB                03380001
033900                                                                  03390001
034000     IF RC806-RCVG-QTY (PS-LNE-SUB)  <                            03400001
034100        RC806-RC-RATIO (PS-LNE-SUB)                               03410001
034200       OR RC806-RC-RATIO (PS-LNE-SUB) = +0                        03420001
034300*        MOVE RC806-RCVG-QTY (PS-LNE-SUB)                         03430001
034400*          TO RC806-BEST-CASE-PACKS                               03440001
034500         MOVE +0  TO RC806-BEST-CASE-PACKS                        03450001
034600     ELSE                                                         03460001
034700         DIVIDE   RC806-RCVG-QTY (PS-LNE-SUB)                     03470001
034800           BY     RC806-RC-RATIO (PS-LNE-SUB)                     03480001
034900           GIVING RC806-BEST-CASE-PACKS                           03490001
035000     END-IF.                                                      03500001
035100                                                                  03510001
035200                                                                  03520001
035300 8000-END.                                                        03530001
035400                                                                  03540001
035600     MOVE RC806-PRODUCT-PACK-VALIDATION    TO DFHCOMMAREA.        03560001
035700     GOBACK.                                                      03570001
035800                                                                  03580001
035900                                                                  03590001
036000*9999-ABEND.                                                      03600001
036100                                                                  03610001
036200*    MOVE 'RCKUT806' TO DP013-PROGRAM.                            03620001
036300                                                                  03630001
036400*    SET DP013-LINK-RETURN TO TRUE.                               03640001
036500*    SET DP013-NO-ROLLBACK TO TRUE.                               03650001
036510                                                                  03651001
036520*    INITIALIZE  DP013-SRC-TASK-NUMBER                            03652001
036530*                DP013-STACK.                                     03653001
036540                                                                  03654001
036550*    MOVE DFHEIBLK               TO DP013-DFHEIBLK.               03655001
036560                                                                  03656001
036570                                                                  03657001
