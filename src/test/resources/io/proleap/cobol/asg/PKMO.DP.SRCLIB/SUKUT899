000100******************************************************************00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300******************************************************************00030000
000400                                                                  00040000
000500 PROGRAM-ID.    SUKUT899.                                         00050000
000600 AUTHOR.        DAN HINTZ.                                        00060000
000700 INSTALLATION.  KOHLS.                                            00070000
000800 DATE-WRITTEN   SEPTEMBER 2012.                                   00080000
000900 DATE-COMPILED.                                                   00090000
001000                                                                  00100000
001100******************************************************************00110000
001200*  THIS PROGRAM WAS NEEDED TO TAKE A FILE CREATED SHOWING THE     00120000
001300*  SHIP_UNT_ID'S THAT NEED TO BE MOVED FROM ONE TRAILER TO ANOTHER00130000
001400*  TRAILER.  ROWS WILL NEED TO BE INSERTED INTO SUT_OTBND_LOC TO  00140000
001401*  SIMULATE BEING SCANNED ON TO THE NEW TRAILER.                  00140109
001410*                                                                 00141000
001420*  THIS PROGRAM WILL CREATE THE SQL INSERTS TO SUT_OTBND_LOC      00142010
001430*  FOR THE SHIP_UNT_ID'S FOUND IN THE INPUT FILE.                 00143000
001474*                                                                 00147400
001475******************************************************************00147500
001476******************************************************************00147600
001477 ENVIRONMENT DIVISION.                                            00147700
001478******************************************************************00147800
001479                                                                  00147900
001480 CONFIGURATION SECTION.                                           00148000
001490                                                                  00149000
001500 SOURCE-COMPUTER.        IBM-3090.                                00150000
001600 OBJECT-COMPUTER.        IBM-3090.                                00160000
001700                                                                  00170000
001800 INPUT-OUTPUT SECTION.                                            00180000
001900                                                                  00190000
002000 FILE-CONTROL.                                                    00200000
002100                                                                  00210000
002200     SELECT INPUT-FILE                                            00220000
002300         ASSIGN TO INP01.                                         00230000
002400                                                                  00240000
002500     SELECT SQL-OUTPUT-FILE                                       00250000
002600         ASSIGN TO OUT01.                                         00260000
002700******************************************************************00270000
002800 DATA DIVISION.                                                   00280000
002900******************************************************************00290000
003000                                                                  00300000
003100 FILE SECTION.                                                    00310000
003200                                                                  00320000
003300 FD  INPUT-FILE                                                   00330000
003400     RECORDING MODE IS F                                          00340000
003500     LABEL RECORDS ARE STANDARD                                   00350000
003600     BLOCK CONTAINS 0 RECORDS.                                    00360000
003700*                                                                 00370000
003800 01  INPUT-RECORD.                                                00380000
004400     05  FILLER                  PIC X(02).                       00440012
004500     05  IN-SML                  PIC X(18).                       00450012
004811     05  FILLER                  PIC X(60).                       00481115
004820*                                                                 00482000
004840*    05  FILLER                  PIC X(06).                       00484000
004850*    05  IN-DC                   PIC 9(03).                       00485000
004860*    05  FILLER                  PIC X(02).                       00486000
004870*    05  IN-STORE                PIC 9(04).                       00487000
004880*    05  FILLER                  PIC X(05).                       00488000
004890*    05  IN-SML                  PIC X(18).                       00489000
004891*    05  FILLER                  PIC X(02).                       00489100
004892*    05  IN-TMST                 PIC X(26).                       00489200
004893*    05  FILLER                  PIC X(02).                       00489300
004894*    05  IN-TRIP                 PIC 9(09).                       00489400
004895*    05  FILLER                  PIC X(03).                       00489500
004896                                                                  00489600
004897                                                                  00489700
004900 FD  SQL-OUTPUT-FILE                                              00490000
005000     RECORDING MODE IS F                                          00500000
005100     LABEL RECORDS ARE STANDARD                                   00510000
005200     BLOCK CONTAINS 0 RECORDS.                                    00520000
005300                                                                  00530000
005400 01  SQL-OUTPUT-RECORD                PIC X(80).                  00540000
005500*                                                                 00550000
005600*                                                                 00560000
005700******************************************************************00570000
005800 WORKING-STORAGE SECTION.                                         00580000
005900******************************************************************00590000
006000*                                                                 00600000
006100*                                                                 00610000
006200******************************************************************00620000
006300*  DB2 FORMATTED MESSAGE AREA                                     00630000
006400******************************************************************00640000
006500     COPY DPWS004.                                                00650000
006600*                                                                 00660000
006700*                                                                 00670000
006800 01  ABEND-CODE                      PIC S9(04)    VALUE +0       00680000
006900                                                   COMP SYNC.     00690000
007000                                                                  00700000
007100 01  PS-PROGRAM-SWITCHES.                                         00710000
007200     05  PS-EOF-INPUT-SW             PIC  X(01)    VALUE 'N'.     00720000
007300         88  PS-EOF-INPUT                          VALUE 'Y'.     00730000
007400         88  PS-MORE-INPUT                         VALUE 'N'.     00740000
007500                                                                  00750000
007600*                                                                 00760000
007700 01  PV-SQL-LINE-01.                                              00770010
007800     05  FILLER     PIC X(03)  VALUE SPACES.                      00780010
007810     05  FILLER     PIC X(33)  VALUE                              00781010
007820                    'INSERT INTO DB2PDBA.SUT_OTBND_LOC'.          00782010
007900     05  FILLER     PIC X(44)  VALUE SPACES.                      00790010
008200*                                                                 00820007
008300 01  PV-SQL-LINE-02.                                              00830010
008400     05  FILLER     PIC X(03)  VALUE SPACES.                      00840010
008500     05  FILLER     PIC X(33)  VALUE                              00850010
008510                    '( SHIPT_UNT_ID                   '.          00851010
008610     05  FILLER     PIC X(44)  VALUE SPACES.                      00861010
008700*                                                                 00870007
008710 01  PV-SQL-LINE-03.                                              00871010
008720     05  FILLER     PIC X(03)  VALUE SPACES.                      00872010
008730     05  FILLER     PIC X(33)  VALUE                              00873010
008732                    ',CRE_TMST                        '.          00873210
008740     05  FILLER     PIC X(44)  VALUE SPACES.                      00874010
008750*                                                                 00875007
008751 01  PV-SQL-LINE-04.                                              00875114
008752     05  FILLER     PIC X(03)  VALUE SPACES.                      00875210
008753     05  FILLER     PIC X(33)  VALUE                              00875310
008754                    ',OTBND_TRIP_ID                   '.          00875410
008758     05  FILLER     PIC X(44)  VALUE SPACES.                      00875810
008759*                                                                 00875907
008760 01  PV-SQL-LINE-05.                                              00876010
008761     05  FILLER     PIC X(03)  VALUE SPACES.                      00876110
008762     05  FILLER     PIC X(33)  VALUE                              00876210
008763                    ',LOC_NBR                         '.          00876310
008766     05  FILLER     PIC X(44)  VALUE SPACES.                      00876610
008767*                                                                 00876707
008768 01  PV-SQL-LINE-06.                                              00876810
008770     05  FILLER     PIC X(03)  VALUE SPACES.                      00877010
008780     05  FILLER     PIC X(33)  VALUE                              00878010
008781                    ',SCN_CDE                         '.          00878110
008790     05  FILLER     PIC X(44)  VALUE SPACES.                      00879010
008791*                                                                 00879107
008792 01  PV-SQL-LINE-07.                                              00879210
008793     05  FILLER     PIC X(03)  VALUE SPACES.                      00879310
008794     05  FILLER     PIC X(33)  VALUE                              00879410
008795                    ',CRE_USR_ID                      '.          00879510
008797     05  FILLER     PIC X(44)  VALUE SPACES.                      00879710
008798*                                                                 00879807
008799 01  PV-SQL-LINE-08.                                              00879910
008800     05  FILLER     PIC X(03)  VALUE SPACES.                      00880010
008801     05  FILLER     PIC X(33)  VALUE                              00880110
008802                    ',ACTV_CDE                        '.          00880210
008804     05  FILLER     PIC X(44)  VALUE SPACES.                      00880410
008805*                                                                 00880507
008806 01  PV-SQL-LINE-09.                                              00880610
008807     05  FILLER     PIC X(03)  VALUE SPACES.                      00880710
008808     05  FILLER     PIC X(33)  VALUE                              00880810
008809                    ',INBD_TRIP_ID)                   '.          00880910
008811     05  FILLER     PIC X(44)  VALUE SPACES.                      00881110
008812*                                                                 00881207
008813 01  PV-SQL-LINE-10.                                              00881310
008814     05  FILLER     PIC X(03)  VALUE SPACES.                      00881410
008815     05  FILLER     PIC X(08)  VALUE 'VALUES ('.                  00881510
008816     05  SQL-SML    PIC X(18)  VALUE SPACES.                      00881610
008819     05  FILLER     PIC X(51)  VALUE SPACES.                      00881910
008820*                                                                 00882007
008821 01  PV-SQL-LINE-11.                                              00882110
008822     05  FILLER     PIC X(03)  VALUE SPACES.                      00882210
008823     05  FILLER     PIC X(08)  VALUE '       ,'.                  00882310
008824     05  FILLER     PIC X(17)  VALUE 'CURRENT TIMESTAMP'.         00882410
008826     05  FILLER     PIC X(75)  VALUE SPACES.                      00882610
008828*                                                                 00882807
008829 01  PV-SQL-LINE-12.                                              00882910
008830     05  FILLER     PIC X(03)  VALUE SPACES.                      00883010
008831     05  FILLER     PIC X(08)  VALUE '       ,'.                  00883110
008832     05  SQL-TRIP   PIC 9(09)  VALUE ZEROES.                      00883210
008834     05  FILLER     PIC X(60)  VALUE SPACES.                      00883410
008835*                                                                 00883507
008836 01  PV-SQL-LINE-13.                                              00883610
008837     05  FILLER     PIC X(03)  VALUE SPACES.                      00883710
008838     05  FILLER     PIC X(08)  VALUE '       ,'.                  00883810
008839     05  SQL-DC     PIC 9(03)  VALUE ZEROES.                      00883910
008841     05  FILLER     PIC X(66)  VALUE SPACES.                      00884110
008842*                                                                 00884207
008843 01  PV-SQL-LINE-14.                                              00884310
008844     05  FILLER     PIC X(03)  VALUE SPACES.                      00884410
008845     05  FILLER     PIC X(08)  VALUE '       ,'.                  00884510
008846     05  FILLER     PIC X(06)  VALUE '''SHON'''.                  00884610
008848     05  FILLER     PIC X(63)  VALUE SPACES.                      00884810
008849*                                                                 00884907
008850 01  PV-SQL-LINE-15.                                              00885010
008851     05  FILLER     PIC X(03)  VALUE SPACES.                      00885110
008852     05  FILLER     PIC X(08)  VALUE '       ,'.                  00885210
008853     05             PIC X(09)  VALUE '''TKMA408'''.               00885310
008855     05  FILLER     PIC X(60)  VALUE SPACES.                      00885510
008856*                                                                 00885607
008857 01  PV-SQL-LINE-16.                                              00885710
008858     05  FILLER     PIC X(03)  VALUE SPACES.                      00885810
008859     05  FILLER     PIC X(08)  VALUE '       ,'.                  00885910
008860     05  FILLER     PIC X(03)  VALUE '''A'''.                     00886010
008862     05  FILLER     PIC X(66)  VALUE SPACES.                      00886210
008863*                                                                 00886307
008864 01  PV-SQL-LINE-17.                                              00886410
008865     05  FILLER     PIC X(03)  VALUE SPACES.                      00886510
008866     05  FILLER     PIC X(08)  VALUE '       ,'.                  00886610
008868     05  FILLER     PIC X(02)  VALUE '0)'.                        00886810
008869     05  FILLER     PIC X(67)  VALUE SPACES.                      00886910
008870*                                                                 00887007
008871 01  PV-SQL-LINE-18.                                              00887110
008872     05  FILLER     PIC X(03)  VALUE SPACES.                      00887210
008873     05  FILLER     PIC X(01)  VALUE ';'.                         00887310
008874     05  FILLER     PIC X(76)  VALUE SPACES.                      00887410
008875*                                                                 00887500
008876 01  PV-SQL-LINE-20.                                              00887610
008877     05  FILLER     PIC X(03)  VALUE SPACES.                      00887707
008878     05  FILLER     PIC X(22)  VALUE                              00887807
008879                    'UPDATE DB2PDBA.TSUCRDV'.                     00887907
008880     05  FILLER     PIC X(55)  VALUE SPACES.                      00888007
008881*                                                                 00888107
008882 01  PV-SQL-LINE-21.                                              00888210
008883     05  FILLER     PIC X(03)  VALUE SPACES.                      00888307
008884     05  FILLER     PIC X(22)  VALUE                              00888407
008886                    '   SET ACTV_CDE     = '.                     00888607
008887     05  FILLER     PIC X(03)  VALUE '''I'''.                     00888709
008891     05  FILLER     PIC X(52)  VALUE SPACES.                      00889109
008892*                                                                 00889208
008897 01  PV-SQL-LINE-22.                                              00889710
008898     05  FILLER     PIC X(03)  VALUE SPACES.                      00889807
008899     05  FILLER     PIC X(22)  VALUE                              00889907
008900                    ' WHERE OPER_UNT_ID  = '.                     00890007
008902     05  SQL-DIVERT-DC     PIC 9(03)  VALUE ZEROS.                00890213
008904     05  FILLER     PIC X(52)  VALUE SPACES.                      00890408
008905*                                                                 00890507
008906 01  PV-SQL-LINE-23.                                              00890610
008907     05  FILLER     PIC X(03)  VALUE SPACES.                      00890707
008908     05  FILLER     PIC X(22)  VALUE                              00890807
008909                    '   AND SHIPT_UNT_ID = '.                     00890907
008910     05  SQL-DIVERT-SML    PIC 9(18)  VALUE ZEROES.               00891013
008911     05  FILLER     PIC X(44)  VALUE SPACES.                      00891107
008912*                                                                 00891207
008991 01  PV-SQL-LINE-24.                                              00899110
008992     05  FILLER     PIC X(03)  VALUE SPACES.                      00899207
008993     05  FILLER     PIC X(01)  VALUE ';'.                         00899307
008994     05  FILLER     PIC X(76)  VALUE SPACES.                      00899407
008995*                                                                 00899500
008996                                                                  00899600
008997 01  PV-PROGRAM-VARIABLES.                                        00899700
008998     05  PV-QUOTE                    PIC  X(01)    VALUE '#'.     00899800
008999     05  PV-ITEM-NBR                 PIC  9(15)    VALUE ZERO.    00899900
009000     05  PV-PARAGRAPH-NAME           PIC  X(30)    VALUE SPACES.  00900000
009100     05  PV-DB2-OPERATION-ATTEMPTED  PIC  X(30)    VALUE SPACES.  00910000
009200     05  PV-READ-COUNTER             PIC S9(09)    VALUE ZERO     00920000
009300                                                   COMP SYNC.     00930000
009400     05  PV-WRITE-COUNTER            PIC S9(09)    VALUE ZERO     00940000
009500                                                   COMP SYNC.     00950000
009600     05  PV-DISPLAY-COUNT            PIC ZZZ,ZZZ,ZZ9.             00960000
009700                                                                  00970000
009800     05  PV-DB2-COUNT                PIC S9(09)    VALUE ZERO     00980000
009900                                                   COMP-3.        00990000
011100                                                                  01110000
011300                                                                  01130000
011400******************************************************************01140000
011500 PROCEDURE DIVISION.                                              01150000
011600******************************************************************01160000
011700                                                                  01170000
011800 0000-PROGRAM-MAINLINE.                                           01180000
011900******************************************************************01190000
012000* 0000-PROGRAM-MAINLINE - CONTROLS THE MAIN PROCESSING OF THE     01200000
012100*      PROGRAM.                                                   01210000
012200******************************************************************01220000
012300                                                                  01230000
012400     PERFORM 1000-INITIALIZE.                                     01240000
012500     IF PS-MORE-INPUT                                             01250000
012600         PERFORM 2000-PROCESS-INPUT                               01260000
012700            UNTIL PS-EOF-INPUT                                    01270000
012800     END-IF.                                                      01280000
012900     PERFORM 9000-EOJ-ROUTINE.                                    01290000
013000                                                                  01300000
013100     STOP RUN.                                                    01310000
013200                                                                  01320000
013300 1000-INITIALIZE.                                                 01330000
013400******************************************************************01340000
013500*  DO FIRST TIME PROGRAM INITIALIZATION TASKS.                    01350000
013600*    -- OPEN FILES                                                01360000
013700******************************************************************01370000
013800                                                                  01380000
013900     OPEN INPUT INPUT-FILE                                        01390000
014000          OUTPUT SQL-OUTPUT-FILE.                                 01400000
014100                                                                  01410000
014200 2000-PROCESS-INPUT.                                              01420000
014300******************************************************************01430000
014400*  PROCESS THE INPUT FILE.                                        01440000
014500******************************************************************01450000
014600                                                                  01460000
014700     PERFORM 8000-READ-INPUT.                                     01470000
014800                                                                  01480000
014900     IF PS-EOF-INPUT                                              01490000
015000         CONTINUE                                                 01500000
015100     ELSE                                                         01510000
015200         PERFORM 8200-WRITE-SQL-FILE                              01520000
015300     END-IF.                                                      01530000
015400                                                                  01540000
015500                                                                  01550000
015600 8000-READ-INPUT.                                                 01560000
015700******************************************************************01570000
015800*  READ THE INPUT DATA                                            01580000
015900******************************************************************01590000
016000     READ INPUT-FILE                                              01600000
016100          AT END                                                  01610000
016200             SET PS-EOF-INPUT TO TRUE.                            01620000
016300                                                                  01630000
016400     IF  PS-EOF-INPUT                                             01640000
016500         CONTINUE                                                 01650000
016600     ELSE                                                         01660000
016700         ADD +1 TO PV-READ-COUNTER                                01670000
016800     END-IF.                                                      01680000
016900                                                                  01690000
017000 8200-WRITE-SQL-FILE.                                             01700000
017100******************************************************************01710000
017200*  WRITE THE OUTPUT RECORDS                                       01720000
017300******************************************************************01730000
017310*    MOVE  IN-DC         TO  SQL-DC.                              01731000
017314*    MOVE  IN-SML        TO  SQL-SML.                             01731400
017318*    MOVE  IN-TRIP       TO  SQL-TRIP.                            01731800
017500                                                                  01750000
017501     MOVE  840           TO  SQL-DC                               01750113
017502                             SQL-DIVERT-DC.                       01750213
017503     MOVE  IN-SML        TO  SQL-SML                              01750313
017504                             SQL-DIVERT-SML.                      01750413
017505     MOVE  015135292     TO  SQL-TRIP.                            01750518
017546                                                                  01754600
017547     INITIALIZE SQL-OUTPUT-RECORD.                                01754700
017550                                                                  01755000
020800     WRITE SQL-OUTPUT-RECORD   FROM                               02080000
020900           PV-SQL-LINE-01.                                        02090000
020910     WRITE SQL-OUTPUT-RECORD   FROM                               02091000
020920           PV-SQL-LINE-02.                                        02092000
020930     WRITE SQL-OUTPUT-RECORD   FROM                               02093000
020940           PV-SQL-LINE-03.                                        02094000
020950     WRITE SQL-OUTPUT-RECORD   FROM                               02095000
020960           PV-SQL-LINE-04.                                        02096000
020970     WRITE SQL-OUTPUT-RECORD   FROM                               02097000
020980           PV-SQL-LINE-05.                                        02098000
020990     WRITE SQL-OUTPUT-RECORD   FROM                               02099010
020991           PV-SQL-LINE-06.                                        02099110
020992     WRITE SQL-OUTPUT-RECORD   FROM                               02099210
020993           PV-SQL-LINE-07.                                        02099310
020995     WRITE SQL-OUTPUT-RECORD   FROM                               02099510
020996           PV-SQL-LINE-08.                                        02099610
020997     WRITE SQL-OUTPUT-RECORD   FROM                               02099710
020998           PV-SQL-LINE-09.                                        02099810
020999     WRITE SQL-OUTPUT-RECORD   FROM                               02099910
021000           PV-SQL-LINE-10.                                        02100010
021001     WRITE SQL-OUTPUT-RECORD   FROM                               02100110
021002           PV-SQL-LINE-11.                                        02100210
021003     WRITE SQL-OUTPUT-RECORD   FROM                               02100310
021004           PV-SQL-LINE-12.                                        02100410
021005     WRITE SQL-OUTPUT-RECORD   FROM                               02100510
021006           PV-SQL-LINE-13.                                        02100610
021007     WRITE SQL-OUTPUT-RECORD   FROM                               02100710
021008           PV-SQL-LINE-14.                                        02100810
021009     WRITE SQL-OUTPUT-RECORD   FROM                               02100910
021010           PV-SQL-LINE-15.                                        02101010
021011     WRITE SQL-OUTPUT-RECORD   FROM                               02101110
021012           PV-SQL-LINE-16.                                        02101210
021013     WRITE SQL-OUTPUT-RECORD   FROM                               02101310
021014           PV-SQL-LINE-17.                                        02101410
021015     WRITE SQL-OUTPUT-RECORD   FROM                               02101510
021016           PV-SQL-LINE-18.                                        02101610
021020     ADD +1 TO PV-WRITE-COUNTER.                                  02102000
021030**   WRITE SQL-OUTPUT-RECORD   FROM                               02103016
021040**         PV-SQL-LINE-20.                                        02104016
021041**   WRITE SQL-OUTPUT-RECORD   FROM                               02104116
021042**         PV-SQL-LINE-21.                                        02104216
021043**   WRITE SQL-OUTPUT-RECORD   FROM                               02104316
021044**         PV-SQL-LINE-22.                                        02104416
021045**   WRITE SQL-OUTPUT-RECORD   FROM                               02104516
021046**         PV-SQL-LINE-23.                                        02104616
021047**   WRITE SQL-OUTPUT-RECORD   FROM                               02104716
021048**         PV-SQL-LINE-24.                                        02104816
021050**   ADD +1 TO PV-WRITE-COUNTER.                                  02105016
021100                                                                  02110000
021200 9000-EOJ-ROUTINE.                                                02120000
021300******************************************************************02130000
021400*  CLOSE OUTPUT FILE.  CLOSE THE CURSOR.                          02140000
021500******************************************************************02150000
021600     CLOSE INPUT-FILE                                             02160000
021700           SQL-OUTPUT-FILE.                                       02170000
021800                                                                  02180000
021900     MOVE PV-READ-COUNTER TO PV-DISPLAY-COUNT.                    02190000
022000     DISPLAY 'TOTAL RECORDS INPUT  ' PV-DISPLAY-COUNT.            02200000
022100     MOVE PV-WRITE-COUNTER TO PV-DISPLAY-COUNT.                   02210000
022200     DISPLAY 'TOTAL RECORDS OUTPUT ' PV-DISPLAY-COUNT.            02220000
