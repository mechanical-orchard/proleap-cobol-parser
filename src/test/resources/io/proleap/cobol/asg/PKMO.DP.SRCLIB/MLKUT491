000100 IDENTIFICATION DIVISION.                                         00010002
000200 PROGRAM-ID.    MLKUT491.                                         00020002
000300 AUTHOR.        B.GRAHAM.                                         00030008
000400 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00040002
000500 DATE-WRITTEN.  03-01-07.                                         00050008
000600 DATE-COMPILED.                                                   00060002
000700******************************************************************00070002
000800*                                                                 00080002
000800* COPIED FROM MLKUT419 FOR BRAND VENDOR CHANGES                   00081002
000800*                                                                 00082002
000900* MLKUT491 -                                                      00083002
001000*                                                                 00084002
001100* THIS PROGRAM WILL COMPARE TWO DATA INTEGRITY EXTRACT FILES AND  00085002
001200* CREATE A REPORT FILE OF THE DIFFERENCES.                        00086002
001300*                                                                 00087002
001400* ONE EXTRACT FILE WILL BE DESIGNATED AS THE 'LOW' EXTRACT FILE,  00088002
001500* AND THE OTHER WILL BE DESIGNATED AS THE 'HIGH' EXTRACT FILE.    00089002
001600* THE 'LOW' EXTRACT FILE CORRESPONDS TO THE LOWER-LEVEL TABLE OF  00090002
001700* THE TWO TABLES BEING COMPARED.                                  00100002
001800*                                                                 00110002
001900* BECAUSE THIS SAME PROGRAM IS USED TO COMPARE ANY TWO OF THE DATA00120002
002000* INTEGRITY EXTRACT FILES, A CONTROL CARD IS READ TO INDICATE     00130002
002100* WHICH TWO ARE BEING COMPARED IN A GIVEN RUN.  THIS IS NECESSARY 00140002
002200* BECAUSE THERE ARE SOME MINOR DIFFERENCES IN PROCESSING, DEPEND- 00150002
002300* ING UPON WHICH TWO TABLES ARE BEING COMPARED.                   00160002
002400*                                                                 00170002
002500* THE SAME CONTROL CARD WILL BE READ BY THE REPORT PROGRAM SO THAT00180002
002600* IT CAN PUT THE APPROPRIATE TABLE NAMES ON THE REPORT.           00190002
002700*                                                                 00200002
008000******************************************************************00730002
007400* CHG ID   DATE        DESCRIPTION                               *00740002
007500* ------   ----------  ----------------------------------------- *00750002
007600* WR28582  07-10-2007  ORIGINAL INSTALLATION                      00760003
007600*  C28582  08-20-2007  CHANGED PGM TO CONTROL COMPARISIONS        00803103
007700*                      BASED UPON THE SOPT PARAMETER              00803203
007800*                      (USUALLY MONTH END VS NOT MONTH END)       00803303
007800*                      INC000000035939                            00803409
007900*                      - BRUCE GRAHAM - STRATAGEM INC.            00803509
PK0408*  PK0408  04-18-2008  PREVENT "ADJ-GRO-MRGN-AMT DOES NOT MATCH"  00803610
PK0408*                      ERRS BETWEEN MLT_MNLY_SUM AND TMNDPT IF 0  00803710
PK0408*                      IN SLS_RTL_AMT AND GRO_MRGN_AMT ON TMNDPT. 00803810
PK0408*                      - PAUL KEBER    INC000000339265            00804011
008000******************************************************************00804110
008100*                                                                 00805002
008200 ENVIRONMENT DIVISION.                                            00806002
008300*                                                                 00807002
008400 CONFIGURATION SECTION.                                           00808002
008500*                                                                 00809002
008600 SOURCE-COMPUTER.        IBM-3090.                                00810002
008700 OBJECT-COMPUTER.        IBM-3090.                                00820002
008800*                                                                 00830002
008900 INPUT-OUTPUT SECTION.                                            00840002
009000 FILE-CONTROL.                                                    00850002
009100                                                                  00860002
009200     SELECT COMPARE-TABLES-CTL-FILE                               00870002
009300         ASSIGN TO INP01.                                         00880002
009400                                                                  00890002
009500     SELECT L-DATA-INTEGRITY-EXTR-FILE                            00900002
009600         ASSIGN TO INP02.                                         00910002
009700                                                                  00920002
009800     SELECT H-DATA-INTEGRITY-EXTR-FILE                            00930002
009900         ASSIGN TO INP03.                                         00940002
C28582                                                                  00941003
C28582     SELECT SOPT-CTL-FILE                                         00942003
C28582         ASSIGN TO INP04.                                         00943003
010000                                                                  00950002
010100     SELECT DATA-INTEGRITY-DIFF-FILE                              00960002
010200         ASSIGN TO OUT01.                                         00970002
010300                                                                  00980002
010400******************************************************************00990002
010500 DATA DIVISION.                                                   01000002
010600******************************************************************01010002
010700                                                                  01020002
010800 FILE SECTION.                                                    01030002
010900                                                                  01040002
011000 FD  COMPARE-TABLES-CTL-FILE                                      01050002
011100     LABEL RECORDS ARE STANDARD                                   01060002
011200     RECORDING MODE IS F                                          01070002
011300     BLOCK CONTAINS 0 RECORDS.                                    01080002
011400 01  COMPARE-TABLES-CTL-REC      PIC X(80).                       01090002
011500                                                                  01100002
011600 FD  L-DATA-INTEGRITY-EXTR-FILE                                   01110002
011700     LABEL RECORDS ARE STANDARD                                   01120002
011800     RECORDING MODE IS F                                          01130002
011900     BLOCK CONTAINS 0 RECORDS.                                    01140002
012000*01  L-DATA-INTEGRITY-EXTR-REC   PIC X(110).                      01150002
012100 01  L-DATA-INTEGRITY-EXTR-REC   PIC X(200).                      01160002
012200                                                                  01170002
012300 FD  H-DATA-INTEGRITY-EXTR-FILE                                   01180002
012400     LABEL RECORDS ARE STANDARD                                   01190002
012500     RECORDING MODE IS F                                          01200002
012600     BLOCK CONTAINS 0 RECORDS.                                    01210002
012700*01  H-DATA-INTEGRITY-EXTR-REC   PIC X(110).                      01220002
012800 01  H-DATA-INTEGRITY-EXTR-REC   PIC X(200).                      01230002
012200                                                                  01231003
C28582 FD  SOPT-CTL-FILE                                                01232003
C28582     LABEL RECORDS ARE STANDARD                                   01233003
C28582     RECORDING MODE IS F                                          01234003
C28582     BLOCK CONTAINS 0 RECORDS.                                    01235003
C28582 01  SOPT-CTL-REC                PIC X(80).                       01237003
012900                                                                  01240002
013000 FD  DATA-INTEGRITY-DIFF-FILE                                     01250002
013100     RECORDING MODE IS F                                          01260002
013200     LABEL RECORDS ARE STANDARD                                   01270002
013300     BLOCK CONTAINS 0 RECORDS.                                    01280002
013400                                                                  01290002
013500*01  DATA-INTEGRITY-DIFF-REC     PIC X(35).                       01300002
013600 01  DATA-INTEGRITY-DIFF-REC     PIC X(80).                       01310002
013700                                                                  01320002
013800*                                                                 01330002
013900******************************************************************01340002
014000 WORKING-STORAGE SECTION.                                         01350002
014100******************************************************************01360002
014200                                                                  01370002
014300 01  PS-PROGRAM-SWITCHES.                                         01380002
014400     05  PS-MORE-LOW-EXTR-RECS-SW                                 01390002
014500                                 PIC X       VALUE 'Y'.           01400002
014600         88  PS-MORE-LOW-EXTR-RECS           VALUE 'Y'.           01410002
014700         88  PS-NO-MORE-LOW-EXTR-RECS        VALUE 'N'.           01420002
014800     05  PS-MORE-HIGH-EXTR-RECS-SW                                01430002
014900                                 PIC X       VALUE 'Y'.           01440002
015000         88  PS-MORE-HIGH-EXTR-RECS          VALUE 'Y'.           01450002
015100         88  PS-NO-MORE-HIGH-EXTR-RECS       VALUE 'N'.           01460002
015200     05  PS-BYPASS-0-DOLLARS-SW  PIC X.                           01470002
015300         88  PS-BYPASS-0-DOLLARS             VALUE 'Y'.           01480002
015400         88  PS-NO-BYPASS-DOLLARS            VALUE 'N'.           01490002
015500                                                                  01500002
015600 01  PA-PROGRAM-ACCUMULATORS                 COMP-3.              01510002
015700     05  PA-LOW-RECS-READ        PIC S9(13)  VALUE ZERO.          01520002
015800     05  PA-HIGH-RECS-READ       PIC S9(13)  VALUE ZERO.          01530002
015900     05  PA-KEY-MATCHES          PIC S9(13)  VALUE ZERO.          01540002
016000     05  PA-REPORT-RECS-WRITTEN  PIC S9(13)  VALUE ZERO.          01550002
016100                                                                  01560002
016200 01  CD-COUNTER-DISPLAY.                                          01570002
016300     05  CD-COUNT-HOLD1          PIC Z,ZZZ,ZZZ,ZZZ,ZZ9.           01580002
016400                                                                  01590002
016500*** ELIMINATED DIFFERENCES DUE TO A CHANGE IN THE WAY             01600002
016600*** SHRINK IS CALCUTATED.  THE CALCULATED SHRINK AMOUNT           01610002
016700*** FROM TMNSCLS IS NOW BEING USED IN THE RECALC PROGRAMS         01620002
016800*** FOR TMNSCL, TMNMCL AND TMNDPT.                                01630002
016900 01  PC-PROGRAM-CONSTANTS.                                        01640002
017000*    05  PC-SHNK-MAX-MNSCLS-MNSCL                                 01650002
017100*                                PIC S9(11)V99 COMP-3             01660002
017200*                                VALUE 2.00 .                     01670002
017300*    05  PC-SHNK-MAX-MNSCL-MNMCL                                  01680002
017400*                                PIC S9(11)V99 COMP-3             01690002
017500*                                VALUE 2.00 .                     01700002
017600*    05  PC-SHNK-MAX-MNMCL-MNDPT                                  01710002
017700*                                PIC S9(11)V99 COMP-3             01720002
017800*                                VALUE .05 .                      01730002
017900     05  PC-LOW-TABLE-TWKPOSS    PIC X(07) VALUE 'TWKPOSS'.       01740002
018000     05  PC-HIGH-TABLE-TWKSCLS   PIC X(07) VALUE 'TWKSCLS'.       01750002
018100     05  PC-LOW-TABLE-TVADPT     PIC X(07) VALUE 'TVADPT '.       01760002
018200     05  PC-LOW-TABLE-TVAMCL     PIC X(07) VALUE 'TVAMCL '.       01770002
018300     05  PC-LOW-TABLE-TWKDPTS    PIC X(07) VALUE 'TWKDPTS'.       01780002
018400     05  PC-LOW-TABLE-TWKDPTC    PIC X(07) VALUE 'TWKDPTC'.       01790002
018500     05  PC-LOW-TABLE-TMNDPTC    PIC X(07) VALUE 'TMNDPTC'.       01800002
018600     05  PC-LOW-TABLE-TMNMCLC    PIC X(07) VALUE 'TMNMCLC'.       01810002
018700     05  PC-LOW-TABLE-TWKMCLC    PIC X(07) VALUE 'TWKMCLC'.       01820002
018710     05  PC-LOW-TABLE-WKLYSUM    PIC X(07) VALUE 'WKLYSUM'.       01830002
018720     05  PC-LOW-TABLE-MNLYSUM    PIC X(07) VALUE 'MNLYSUM'.       01840002
C28582     05  PC-LOW-TABLE-MNLYDBV    PIC X(07) VALUE 'MNLYDBV'.       01840106
C28582     05  PC-HIGH-TABLE-WKLYSUM   PIC X(07) VALUE 'WKLYSUM'.       01841006
C28582     05  PC-HIGH-TABLE-MNLYSUM   PIC X(07) VALUE 'MNLYSUM'.       01842006
C28582     05  PC-HIGH-TABLE-MNLYDBV   PIC X(07) VALUE 'MNLYDBV'.       01843006
018800                                                                  01850002
018900 01  PV-PROGRAM-VARIABLES.                                        01860002
019000     05  PV-LOW-FILE-KEY.                                         01870002
019100         10  PV-LOW-FK-FSCL-MN-END-DTE                            01880002
019200                                 PIC X(10).                       01890002
019300         10  PV-LOW-FK-FSCL-MN-NBR                                01900002
019400                                 PIC X(02).                       01910002
019500         10  PV-LOW-FK-DEPT-NBR  PIC X(03).                       01920002
019600         10  PV-LOW-FK-MAJ-CL-NBR                                 01930002
019700                                 PIC X(02).                       01940002
019800         10  PV-LOW-FK-SUB-CL-NBR                                 01950002
019900                                 PIC X(02).                       01960002
020000         10  PV-LOW-FK-STR-NBR   PIC S9(4) COMP.                  01970002
B28582         10  PV-LOW-FK-DKEY-NBR  PIC S9(09) COMP.                 01980002
020100     05  PV-HIGH-FILE-KEY.                                        01990002
020200         10  PV-HIGH-FK-FSCL-MN-END-DTE                           02000002
020300                                 PIC X(10).                       02001002
020400         10  PV-HIGH-FK-FSCL-MN-NBR                               02002002
020500                                 PIC X(02).                       02003002
020600         10  PV-HIGH-FK-DEPT-NBR PIC X(03).                       02004002
020700         10  PV-HIGH-FK-MAJ-CL-NBR                                02005002
020800                                 PIC X(02).                       02006002
020900         10  PV-HIGH-FK-SUB-CL-NBR                                02007002
021000                                 PIC X(02).                       02008002
021100         10  PV-HIGH-FK-STR-NBR  PIC S9(4) COMP.                  02009002
B28582         10  PV-HIGH-FK-DKEY-NBR PIC S9(09) COMP.                 02010002
021200                                                                  02020002
021300     05  PV-DIFF-SHNK-RTL-AMT    PIC S9(11)V99 COMP-3.            02030002
021400                                                                  02040002
021500 01 ABEND-AREAS.                                                  02050002
021600     05 ABEND-CODE               PIC S9(04)  VALUE ZERO           02060002
021700                                             COMP SYNC.           02070002
021800         88  AC-BAD-DATA                     VALUE +4003.         02080002
021900         88  AC-DB2-ERROR                    VALUE +4013.         02090002
022000     05  AA-ABEND-LIT            PIC X(40)   VALUE                02100002
022100           '*****       ABEND'.                                   02110002
022200     05  AA-PROGRAM-LIT          PIC X(40)   VALUE                02120002
022300             '*****   PROGRAM: MLKUT491'.                         02130002
022400     05  AA-PARAGRAPH-LIT.                                        02140002
022500         10  FILLER              PIC X(17)   VALUE                02150002
022600             '***** PARAGRAPH: '.                                 02160002
022700         10  AA-PARAGRAPH-NAME   PIC X(35)   VALUE SPACES.        02170002
022800     05  AA-MESSAGE-LINE.                                         02180002
022900         10  FILLER              PIC X(06)   VALUE '*****'.       02190002
023000         10  AA-MESSAGE          PIC X(127)  VALUE SPACES.        02200002
023100     05  AA-DB2-ERROR-LIT        PIC X(40)   VALUE                02210002
023200             '*****    DB2 ERROR'.                                02220002
023300     05  AA-DB2-OPERATION-LIT.                                    02230002
023400         10  FILLER              PIC X(17)   VALUE                02240002
023500             '***** OPERATION: '.                                 02250002
023600         10  AA-DB2-OPERATION.                                    02260002
023700             15  AA-DB2-OP-1     PIC X(25)   VALUE SPACES.        02270002
023800             15  AA-DB2-OP-2     PIC X(25)   VALUE SPACES.        02280002
023900     05  AA-DB2-TABLE-1          PIC X(08)   VALUE SPACES.        02290002
024000     05  AA-DB2-TABLE-2          PIC X(08)   VALUE SPACES.        02300002
024100     05  AA-DB2-TABLE-3          PIC X(08)   VALUE SPACES.        02310002
024200     05  AA-DB2-TABLE-4          PIC X(08)   VALUE SPACES.        02320002
024300                                                                  02330002
024400 EJECT                                                            02340002
024500                                                                  02350002
024600*** DATA INTEGRITY COMPARE TABLES CONTROL CARD                    02360002
024700 01  CC-CONTROL-CARD-REC.                                         02370002
024800     05  CC-LOW-TABLE            PIC X(7).                        02380002
024900     05  FILLER                  PIC X.                           02390002
025000     05  CC-HIGH-TABLE           PIC X(7).                        02400002
025100     05  FILLER                  PIC X(65).                       02410002
C28582                                                                  02411003
C28582*** DATA INTEGRITY COMPARE SOPT CONTROL CARD                      02412003
C28582*** MONTH END OR NOT MONTH END                                    02412103
C28582 01  CC-SOPT-CTL-REC.                                             02413003
C28582     05  CC-SOPT-CTL-CDE         PIC X(1).                        02414003
C28582         88  CC-SOPT-MONTH-END-NO   VALUE '0'.                    02414103
C28582         88  CC-SOPT-MONTH-END-YES  VALUE '1'.                    02414203
C28582     05  FILLER                  PIC X(79).                       02415003
C28582                                                                  02420003
025300                                                                  02430002
025400*** L O W                                                         02440002
025500*** DATA INTEGRITY EXTRACT FILE                                   02450002
025600     COPY MLRD211 REPLACING ML211 BY LLLOW.                       02460002
025700                                                                  02470002
025800                                                                  02480002
025900*** H I G H                                                       02490002
026000*** DATA INTEGRITY EXTRACT FILE                                   02500002
026100     COPY MLRD211 REPLACING ML211 BY HHIGH.                       02510002
026200                                                                  02520002
026300                                                                  02530002
026400*** DATA INTEGRITY DIFFERENCE REPORT FILE                         02540002
026500     COPY MLRD212.                                                02550002
026600                                                                  02560002
026700 EJECT                                                            02570002
026800                                                                  02580002
026900******************************************************************02590002
027000 PROCEDURE DIVISION.                                              02600002
027100******************************************************************02610002
027200                                                                  02620002
027300******************************************************************02630002
027400 0000-MAINLINE-MLKUT491.                                          02640002
027500******************************************************************02650002
027600*                                                                 02660002
027700     PERFORM 1000-INITIALIZATION.                                 02670002
027800                                                                  02680002
027900     PERFORM 2000-MAIN-PROCESS.                                   02690002
028000                                                                  02700002
028100     PERFORM 8000-EOJ.                                            02710002
028200                                                                  02720002
028300     STOP RUN.                                                    02730002
028400                                                                  02740002
028500 EJECT                                                            02750002
028600                                                                  02760002
028700******************************************************************02770002
028800 1000-INITIALIZATION.                                             02780002
028900******************************************************************02790002
029000*                                                                 02800002
029100     OPEN INPUT  COMPARE-TABLES-CTL-FILE                          02810002
029200                 L-DATA-INTEGRITY-EXTR-FILE                       02820002
C28582                 H-DATA-INTEGRITY-EXTR-FILE                       02830003
C28582                 SOPT-CTL-FILE.                                   02831003
029400     OPEN OUTPUT DATA-INTEGRITY-DIFF-FILE.                        02840002
029500                                                                  02850002
029600     PERFORM 4000-READ-CONTROL-CARD.                              02860002
029500                                                                  02861003
029800     DISPLAY ' '.                                                 02880002
029900     DISPLAY '*** MLKUT491 INPUT CONTROL CARD VALUES ***'         02890002
030000     DISPLAY CC-CONTROL-CARD-REC.                                 02900002
029500                                                                  02900103
C28582     PERFORM 4050-READ-SOPT-CONTROL-CARD.                         02901003
C28582                                                                  02902003
C28582     DISPLAY ' '.                                                 02903003
C28582     DISPLAY '*** MLKUT491 INPUT SOPT CONTROL VALUES ***'         02904003
C28582     DISPLAY CC-SOPT-CTL-REC.                                     02905003
030100                                                                  02910002
030200     INITIALIZE PA-PROGRAM-ACCUMULATORS.                          02920002
030300     INITIALIZE PV-PROGRAM-VARIABLES.                             02930002
030400                                                                  02940002
030500 EJECT                                                            02950002
030600                                                                  02960002
030700******************************************************************02970002
030800 2000-MAIN-PROCESS.                                               02980002
030900******************************************************************02990002
031000*                                                                 03000002
031100     PERFORM 4100-READ-LOW-EXTRACT-FILE.                          03010002
031200                                                                  03020002
031300     IF PS-NO-MORE-LOW-EXTR-RECS                                  03030002
031400         MOVE '2000-MAIN-PROCESS'                                 03040002
031500                                 TO AA-PARAGRAPH-NAME             03050002
031600         MOVE 'EMPTY LOW EXTRACT FILE'                            03060002
031700                                 TO AA-MESSAGE                    03070002
031800         MOVE +4002              TO ABEND-CODE                    03080002
031900         PERFORM 9900-COMMON-ABEND-ROUTINE                        03090002
032000     END-IF.                                                      03100002
032100                                                                  03110002
032200     PERFORM 4200-READ-HIGH-EXTRACT-FILE.                         03120002
032300                                                                  03130002
032400     IF PS-NO-MORE-HIGH-EXTR-RECS                                 03140002
032500         MOVE '2000-MAIN-PROCESS'                                 03150002
032600                                 TO AA-PARAGRAPH-NAME             03160002
032700         MOVE 'EMPTY HIGH EXTRACT FILE'                           03170002
032800                                 TO AA-MESSAGE                    03180002
032900         MOVE +4003              TO ABEND-CODE                    03190002
033000         PERFORM 9900-COMMON-ABEND-ROUTINE                        03200002
033100     END-IF.                                                      03210002
033200                                                                  03220002
033300     PERFORM                                                      03230002
033400       UNTIL PS-NO-MORE-LOW-EXTR-RECS                             03240002
033500         AND PS-NO-MORE-HIGH-EXTR-RECS                            03250002
033600         PERFORM 2100-COMPARE-FILES                               03260002
033700     END-PERFORM.                                                 03270002
033800                                                                  03280002
033900 EJECT                                                            03290002
034000                                                                  03300002
034100******************************************************************03310002
034200 2100-COMPARE-FILES.                                              03320002
034300******************************************************************03330002
034400*                                                                 03340002
034500     PERFORM 3000-BUILD-FILE-KEYS.                                03350002
034600                                                                  03360002
034700     IF PV-LOW-FILE-KEY = PV-HIGH-FILE-KEY                        03370002
034800         ADD 1                   TO PA-KEY-MATCHES                03380002
034900         IF CC-LOW-TABLE = PC-LOW-TABLE-TWKPOSS                   03390002
035000            AND                                                   03400002
035100            CC-HIGH-TABLE = PC-HIGH-TABLE-TWKSCLS                 03410002
035200             PERFORM 5400-COMPARE-BOTH-FILE-AMTS                  03420002
035300         ELSE                                                     03430002
035400             PERFORM 5100-COMPARE-BOTH-FILE-AMTS                  03440002
035500         END-IF                                                   03450002
035600         PERFORM 4100-READ-LOW-EXTRACT-FILE                       03460002
035700         PERFORM 4200-READ-HIGH-EXTRACT-FILE                      03470002
035800     ELSE                                                         03480002
035900         IF PV-LOW-FILE-KEY < PV-HIGH-FILE-KEY                    03490002
036000             PERFORM 5200-PROCESS-ONLY-LOW-FILE                   03500002
036100             PERFORM 4100-READ-LOW-EXTRACT-FILE                   03510002
036200         ELSE                                                     03520002
036300             PERFORM 5300-PROCESS-ONLY-HIGH-FILE                  03530002
036400             PERFORM 4200-READ-HIGH-EXTRACT-FILE                  03540002
036500         END-IF                                                   03550002
036600     END-IF.                                                      03560002
036700                                                                  03570002
036800 EJECT                                                            03580002
036900                                                                  03590002
037000******************************************************************03600002
037100 3000-BUILD-FILE-KEYS.                                            03610002
037200******************************************************************03620002
037300*                                                                 03630002
037400     INITIALIZE PV-LOW-FILE-KEY.                                  03640002
037500     INITIALIZE PV-HIGH-FILE-KEY.                                 03650002
037600                                                                  03660002
037700     IF LLLOW-DATA-INTEGRITY-EXTR-REC = HIGH-VALUES               03670002
037800         MOVE HIGH-VALUES        TO PV-LOW-FILE-KEY               03680002
037900     ELSE                                                         03690002
038000         MOVE LLLOW-FSCL-MN-END-DTE                               03700002
038100                                 TO PV-LOW-FK-FSCL-MN-END-DTE     03710002
038200         MOVE LLLOW-FSCL-MN-NBR  TO PV-LOW-FK-FSCL-MN-NBR         03720002
038300         MOVE LLLOW-DEPT-NBR     TO PV-LOW-FK-DEPT-NBR            03730002
038400         EVALUATE TRUE                                            03740002
038500             WHEN CC-LOW-TABLE = 'TWKDPT'                         03750002
038600                 MOVE '00'       TO PV-LOW-FK-MAJ-CL-NBR          03760002
038700                                    PV-LOW-FK-SUB-CL-NBR          03770002
038800                 MOVE 0          TO PV-LOW-FK-STR-NBR             03780002
B28582                 MOVE ZEROS      TO PV-LOW-FK-DKEY-NBR            03790002
038900             WHEN CC-LOW-TABLE = PC-LOW-TABLE-TVADPT              03800002
039000                 MOVE '00'       TO PV-LOW-FK-MAJ-CL-NBR          03810002
039100                                    PV-LOW-FK-SUB-CL-NBR          03820002
039200                 MOVE 0          TO PV-LOW-FK-STR-NBR             03830002
B28582                 MOVE ZEROS      TO PV-LOW-FK-DKEY-NBR            03840002
039300             WHEN CC-LOW-TABLE = 'TMNMCL'                         03850002
039400                 MOVE '00'       TO PV-LOW-FK-MAJ-CL-NBR          03860002
039500                                    PV-LOW-FK-SUB-CL-NBR          03870002
039600                 MOVE 0          TO PV-LOW-FK-STR-NBR             03880002
B28582                 MOVE ZEROS      TO PV-LOW-FK-DKEY-NBR            03890002
039700             WHEN CC-LOW-TABLE = 'TMNSCL'                         03900002
039800                 MOVE LLLOW-MAJ-CL-NBR                            03910002
039900                                 TO PV-LOW-FK-MAJ-CL-NBR          03920002
040000                 MOVE '00'       TO PV-LOW-FK-SUB-CL-NBR          03930002
040100                 MOVE 0          TO PV-LOW-FK-STR-NBR             03940002
B28582                 MOVE ZEROS      TO PV-LOW-FK-DKEY-NBR            03950002
040200             WHEN CC-LOW-TABLE = PC-LOW-TABLE-TVAMCL              03960002
040300                 MOVE LLLOW-MAJ-CL-NBR                            03970002
040400                                 TO PV-LOW-FK-MAJ-CL-NBR          03980002
040500                 MOVE '00'       TO PV-LOW-FK-SUB-CL-NBR          03990002
040600                 MOVE 0          TO PV-LOW-FK-STR-NBR             04000002
B28582                 MOVE ZEROS      TO PV-LOW-FK-DKEY-NBR            04010002
040700             WHEN CC-LOW-TABLE = 'TMNDPTS'                        04020002
040800                 MOVE '00'       TO PV-LOW-FK-MAJ-CL-NBR          04030002
040900                                    PV-LOW-FK-SUB-CL-NBR          04040002
041000                 MOVE 0          TO PV-LOW-FK-STR-NBR             04050002
B28582                 MOVE ZEROS      TO PV-LOW-FK-DKEY-NBR            04060002
041100             WHEN CC-LOW-TABLE = 'TMNMCLS'                        04070002
041200                 MOVE LLLOW-MAJ-CL-NBR                            04080002
041300                                 TO PV-LOW-FK-MAJ-CL-NBR          04090002
041400                 MOVE '00'       TO PV-LOW-FK-SUB-CL-NBR          04100002
041500                 MOVE 0          TO PV-LOW-FK-STR-NBR             04110002
B28582                 MOVE ZEROS      TO PV-LOW-FK-DKEY-NBR            04120002
041600             WHEN CC-LOW-TABLE = 'TMNSCLS'                        04130002
041700                 MOVE LLLOW-MAJ-CL-NBR                            04140002
041800                                 TO PV-LOW-FK-MAJ-CL-NBR          04150002
049100                 MOVE LLLOW-SUB-CL-NBR                            04160002
042000                                 TO PV-LOW-FK-SUB-CL-NBR          04170002
042100                 MOVE 0          TO PV-LOW-FK-STR-NBR             04180002
B28582                 MOVE ZEROS      TO PV-LOW-FK-DKEY-NBR            04190002
042200             WHEN CC-LOW-TABLE = 'TWKSCLS'                        04200002
042300                 MOVE LLLOW-MAJ-CL-NBR                            04210002
042400                                 TO PV-LOW-FK-MAJ-CL-NBR          04211002
042500                 MOVE LLLOW-SUB-CL-NBR                            04212002
042600                                 TO PV-LOW-FK-SUB-CL-NBR          04213002
042700                 MOVE LLLOW-STR-NBR                               04214002
042800                                 TO PV-LOW-FK-STR-NBR             04215002
B28582                 MOVE ZEROS      TO PV-LOW-FK-DKEY-NBR            04216002
042900*** WR 20698                                                      04217002
043000             WHEN CC-LOW-TABLE = PC-LOW-TABLE-TWKPOSS             04218002
043100                 MOVE LLLOW-MAJ-CL-NBR                            04219002
043200                                 TO PV-LOW-FK-MAJ-CL-NBR          04220002
043300                 MOVE LLLOW-SUB-CL-NBR                            04230002
043400                                 TO PV-LOW-FK-SUB-CL-NBR          04240002
043500                 MOVE LLLOW-STR-NBR                               04250002
043600                                 TO PV-LOW-FK-STR-NBR             04260002
B28582                 MOVE ZEROS      TO PV-LOW-FK-DKEY-NBR            04270002
043700             WHEN CC-LOW-TABLE = 'TWKMCL'                         04280002
043800                 MOVE LLLOW-MAJ-CL-NBR                            04290002
043900                                 TO PV-LOW-FK-MAJ-CL-NBR          04300002
044000                 MOVE '00'       TO PV-LOW-FK-SUB-CL-NBR          04310002
044100                 MOVE 0          TO PV-LOW-FK-STR-NBR             04320002
B28582                 MOVE ZEROS      TO PV-LOW-FK-DKEY-NBR            04330002
044200             WHEN CC-LOW-TABLE = 'TWKMCLS'                        04340002
044300                 MOVE LLLOW-MAJ-CL-NBR                            04350002
044400                                 TO PV-LOW-FK-MAJ-CL-NBR          04360002
044500                 MOVE '00'       TO PV-LOW-FK-SUB-CL-NBR          04370002
044600                 MOVE LLLOW-STR-NBR                               04380002
044700                                 TO PV-LOW-FK-STR-NBR             04390002
B28582                 MOVE ZEROS      TO PV-LOW-FK-DKEY-NBR            04400002
044800*** WR 21355                                                      04410002
044900             WHEN CC-LOW-TABLE = PC-LOW-TABLE-TWKDPTS             04420002
045000                 MOVE '00'       TO PV-LOW-FK-MAJ-CL-NBR          04430002
045100                                    PV-LOW-FK-SUB-CL-NBR          04440002
045200                 MOVE 0          TO PV-LOW-FK-STR-NBR             04450002
B28582                 MOVE ZEROS      TO PV-LOW-FK-DKEY-NBR            04460002
045300             WHEN CC-LOW-TABLE = PC-LOW-TABLE-TWKDPTC             04470002
045400                 MOVE '00'       TO PV-LOW-FK-MAJ-CL-NBR          04480002
045500                                    PV-LOW-FK-SUB-CL-NBR          04490002
045600                 MOVE 0          TO PV-LOW-FK-STR-NBR             04500002
B28582                 MOVE ZEROS      TO PV-LOW-FK-DKEY-NBR            04510002
045700             WHEN CC-LOW-TABLE = PC-LOW-TABLE-TMNDPTC             04520002
045800                 MOVE '00'       TO PV-LOW-FK-MAJ-CL-NBR          04530002
045900                                    PV-LOW-FK-SUB-CL-NBR          04540002
046000                 MOVE 0          TO PV-LOW-FK-STR-NBR             04550002
B28582                 MOVE ZEROS      TO PV-LOW-FK-DKEY-NBR            04560002
046100             WHEN CC-LOW-TABLE = PC-LOW-TABLE-TWKMCLC             04570002
046200                 MOVE LLLOW-MAJ-CL-NBR                            04580002
046300                                 TO PV-LOW-FK-MAJ-CL-NBR          04590002
046400                 MOVE '00'       TO PV-LOW-FK-SUB-CL-NBR          04600002
046500                 MOVE 0          TO PV-LOW-FK-STR-NBR             04610002
B28582                 MOVE ZEROS      TO PV-LOW-FK-DKEY-NBR            04620002
046600             WHEN CC-LOW-TABLE = PC-LOW-TABLE-TMNMCLC             04630002
046700                 MOVE LLLOW-MAJ-CL-NBR                            04640002
046800                                 TO PV-LOW-FK-MAJ-CL-NBR          04650002
046900                 MOVE '00'       TO PV-LOW-FK-SUB-CL-NBR          04660002
047000                 MOVE 0          TO PV-LOW-FK-STR-NBR             04670002
B28582                 MOVE ZEROS      TO PV-LOW-FK-DKEY-NBR            04680002
047010             WHEN CC-LOW-TABLE = PC-LOW-TABLE-WKLYSUM             04690002
047012                 MOVE LLLOW-MAJ-CL-NBR                            04700002
047013                                 TO PV-LOW-FK-MAJ-CL-NBR          04700102
047014                 MOVE LLLOW-SUB-CL-NBR                            04700202
047015                                 TO PV-LOW-FK-SUB-CL-NBR          04700302
047016                 MOVE LLLOW-STR-NBR                               04700402
047017                                 TO PV-LOW-FK-STR-NBR             04700502
B28582                 MOVE LLLOW-DKEY-NBR                              04700602
B28582                                 TO PV-LOW-FK-DKEY-NBR            04700702
047018             WHEN CC-LOW-TABLE = PC-LOW-TABLE-MNLYSUM             04700802
047019                 MOVE LLLOW-MAJ-CL-NBR                            04700902
047020                                 TO PV-LOW-FK-MAJ-CL-NBR          04701002
047030                 MOVE LLLOW-SUB-CL-NBR                            04702002
047040                                 TO PV-LOW-FK-SUB-CL-NBR          04702102
047050                 MOVE LLLOW-STR-NBR                               04702202
047060                                 TO PV-LOW-FK-STR-NBR             04702302
B28582                 MOVE LLLOW-DKEY-NBR                              04702402
B28582                                 TO PV-LOW-FK-DKEY-NBR            04702502
047100         END-EVALUATE                                             04702602
047200     END-IF.                                                      04702702
047300                                                                  04702802
047400     IF HHIGH-DATA-INTEGRITY-EXTR-REC = HIGH-VALUES               04702902
047500         MOVE HIGH-VALUES        TO PV-HIGH-FILE-KEY              04703002
047600     ELSE                                                         04704002
047700         MOVE HHIGH-FSCL-MN-END-DTE                               04705002
047800                                 TO PV-HIGH-FK-FSCL-MN-END-DTE    04706002
047900         MOVE HHIGH-FSCL-MN-NBR  TO PV-HIGH-FK-FSCL-MN-NBR        04707002
048000         MOVE HHIGH-DEPT-NBR     TO PV-HIGH-FK-DEPT-NBR           04708002
048100         MOVE HHIGH-MAJ-CL-NBR   TO PV-HIGH-FK-MAJ-CL-NBR         04709002
048200         MOVE HHIGH-SUB-CL-NBR   TO PV-HIGH-FK-SUB-CL-NBR         04710002
048300         MOVE HHIGH-STR-NBR      TO PV-HIGH-FK-STR-NBR            04720002
048300         MOVE HHIGH-DKEY-NBR     TO PV-HIGH-FK-DKEY-NBR           04730002
048400     END-IF.                                                      04740002
048500                                                                  04750002
048600 EJECT                                                            04760002
048700                                                                  04770002
048800******************************************************************04780002
048900 4000-READ-CONTROL-CARD.                                          04790002
049000******************************************************************04800002
049100*                                                                 04810002
049200     READ COMPARE-TABLES-CTL-FILE                                 04820002
049300       INTO CC-CONTROL-CARD-REC                                   04830002
049400         AT END                                                   04840002
049500             MOVE '4000-READ-CONTROL-CARD'                        04850002
049600                                 TO AA-PARAGRAPH-NAME             04860002
049700             MOVE 'CONTROL CARD IS MISSING'                       04870002
049800                                 TO AA-MESSAGE                    04880002
049900             MOVE +4001          TO ABEND-CODE                    04890002
050000             PERFORM 9900-COMMON-ABEND-ROUTINE                    04900002
050100     END-READ.                                                    04910002
048700                                                                  04911003
C28582******************************************************************04912003
C28582 4050-READ-SOPT-CONTROL-CARD.                                     04913003
C28582******************************************************************04914003
C28582                                                                  04915003
C28582     READ SOPT-CTL-FILE                                           04916003
C28582       INTO CC-SOPT-CTL-REC                                       04917003
C28582         AT END                                                   04918003
C28582             MOVE '4050-READ-SOPT-CONTROL-CARD'                   04919003
C28582                                 TO AA-PARAGRAPH-NAME             04919103
C28582             MOVE 'CONTROL CARD IS MISSING'                       04919203
C28582                                 TO AA-MESSAGE                    04919303
C28582             MOVE +4002          TO ABEND-CODE                    04919403
C28582             PERFORM 9900-COMMON-ABEND-ROUTINE                    04919503
C28582     END-READ.                                                    04919603
C28582                                                                  04919703
C28582     IF CC-SOPT-MONTH-END-NO OR                                   04920003
C28582        CC-SOPT-MONTH-END-YES                                     04921003
C28582         CONTINUE                                                 04922003
C28582     ELSE                                                         04923003
C28582             MOVE '4050-READ-SOPT-CONTROL-CARD'                   04923103
C28582                                 TO AA-PARAGRAPH-NAME             04923203
C28582             MOVE 'CONTROL CARD VALUE IS INVALID '                04923303
C28582                                 TO AA-MESSAGE                    04923403
C28582             MOVE +4002          TO ABEND-CODE                    04923503
C28582             PERFORM 9900-COMMON-ABEND-ROUTINE                    04923603
C28582     END-IF.                                                      04924005
C28582                                                                  04925003
050300 EJECT                                                            04930002
050400                                                                  04940002
050500******************************************************************04950002
050600 4100-READ-LOW-EXTRACT-FILE.                                      04960002
050700******************************************************************04970002
050800*                                                                 04980002
050900     IF PS-MORE-LOW-EXTR-RECS                                     04990002
051000         READ L-DATA-INTEGRITY-EXTR-FILE                          05000002
051100           INTO LLLOW-DATA-INTEGRITY-EXTR-REC                     05010002
051200             AT END                                               05020002
051300                 SET PS-NO-MORE-LOW-EXTR-RECS                     05030002
051400                                 TO TRUE                          05040002
051500                 MOVE HIGH-VALUES                                 05050002
051600                                 TO LLLOW-DATA-INTEGRITY-EXTR-REC 05060002
051700         END-READ                                                 05070002
051800     END-IF.                                                      05080002
051900                                                                  05090002
052000     IF PS-MORE-LOW-EXTR-RECS                                     05100002
052100         ADD 1                   TO PA-LOW-RECS-READ              05110002
C28582         IF CC-SOPT-MONTH-END-NO                                  05111003
C28582             MOVE ZEROS          TO LLLOW-END-INV-COST1-AMT       05112003
C28582                                    LLLOW-END-INV-COST2-AMT       05113003
C28582                                    LLLOW-ADJ-GRO-MRGN-AMT        05114003
C28582         END-IF                                                   05115003
052200     END-IF.                                                      05120002
052300                                                                  05130002
052400 EJECT                                                            05140002
052500                                                                  05150002
052600******************************************************************05160002
052700 4200-READ-HIGH-EXTRACT-FILE.                                     05170002
052800******************************************************************05180002
052900*                                                                 05190002
053000     IF PS-MORE-HIGH-EXTR-RECS                                    05200002
053100         READ H-DATA-INTEGRITY-EXTR-FILE                          05210002
053200           INTO HHIGH-DATA-INTEGRITY-EXTR-REC                     05220002
053300             AT END                                               05230002
053400                 SET PS-NO-MORE-HIGH-EXTR-RECS                    05240002
053500                                 TO TRUE                          05250002
053600                 MOVE HIGH-VALUES                                 05260002
053700                                 TO HHIGH-DATA-INTEGRITY-EXTR-REC 05270002
053800         END-READ                                                 05280002
053900     END-IF.                                                      05290002
054000                                                                  05300002
054100     IF PS-MORE-HIGH-EXTR-RECS                                    05310002
054200         ADD 1                   TO PA-HIGH-RECS-READ             05320002
C28582         IF CC-SOPT-MONTH-END-NO                                  05321003
C28582             MOVE ZEROS          TO HHIGH-END-INV-COST1-AMT       05322003
C28582                                    HHIGH-END-INV-COST2-AMT       05323003
C28582                                    HHIGH-ADJ-GRO-MRGN-AMT        05324003
C28582         END-IF                                                   05325003
054300     END-IF.                                                      05330002
054400                                                                  05340002
054500 EJECT                                                            05350002
054600                                                                  05360002
054700******************************************************************05370002
054800 5100-COMPARE-BOTH-FILE-AMTS.                                     05380002
054900******************************************************************05390002
055000*                                                                 05400002
B28582     MOVE HHIGH-FSCL-MN-END-DTE  TO ML212-FSCL-MN-END-DTE.        05410002
B28582     MOVE HHIGH-FSCL-MN-NBR      TO ML212-FSCL-MN-NBR.            05420002
B28582     MOVE HHIGH-DEPT-NBR         TO ML212-DEPT-NBR.               05430002
B28582     MOVE HHIGH-MAJ-CL-NBR       TO ML212-MAJ-CL-NBR.             05440002
B28582     MOVE HHIGH-SUB-CL-NBR       TO ML212-SUB-CL-NBR.             05450002
B28582     MOVE HHIGH-STR-NBR          TO ML212-STR-NBR.                05460002
B28582     MOVE HHIGH-DKEY-NBR         TO ML212-DKEY-NBR.               05470002
055700                                                                  05480002
055800     IF LLLOW-SLS-RTL-AMT NOT = HHIGH-SLS-RTL-AMT                 05490002
B28582         MOVE LLLOW-SLS-RTL-AMT  TO ML212-LOW-TBL-AMT             05500002
B28582         MOVE HHIGH-SLS-RTL-AMT  TO ML212-HIGH-TBL-AMT            05510002
B28582         MOVE 3                  TO ML212-ERR-MSG-NBR             05520002
056200         WRITE DATA-INTEGRITY-DIFF-REC                            05530002
B28582             FROM ML212-DATA-INTEGRITY-DIFF-REC                   05540002
056400         ADD 1                   TO PA-REPORT-RECS-WRITTEN        05550002
056500     END-IF.                                                      05560002
056600                                                                  05570002
056700     IF LLLOW-MKDN-RTL-AMT NOT = HHIGH-MKDN-RTL-AMT               05580002
B28582         MOVE LLLOW-MKDN-RTL-AMT TO ML212-LOW-TBL-AMT             05590002
B28582         MOVE HHIGH-MKDN-RTL-AMT TO ML212-HIGH-TBL-AMT            05600002
B28582         MOVE 4                  TO ML212-ERR-MSG-NBR             05610002
057100         WRITE DATA-INTEGRITY-DIFF-REC                            05620002
B28582             FROM ML212-DATA-INTEGRITY-DIFF-REC                   05630002
057300         ADD 1                   TO PA-REPORT-RECS-WRITTEN        05640002
057400     END-IF.                                                      05650002
057500                                                                  05660002
057600     IF LLLOW-MKUP-RTL-AMT NOT = HHIGH-MKUP-RTL-AMT               05670002
B28582         MOVE LLLOW-MKUP-RTL-AMT TO ML212-LOW-TBL-AMT             05680002
B28582         MOVE HHIGH-MKUP-RTL-AMT TO ML212-HIGH-TBL-AMT            05690002
057900         MOVE 5                  TO ML212-ERR-MSG-NBR             05700002
058000         WRITE DATA-INTEGRITY-DIFF-REC                            05710002
058100             FROM ML212-DATA-INTEGRITY-DIFF-REC                   05720002
058200         ADD 1                   TO PA-REPORT-RECS-WRITTEN        05730002
058300     END-IF.                                                      05740002
058400                                                                  05750002
058500     IF LLLOW-XFER-IN-RTL-AMT NOT = HHIGH-XFER-IN-RTL-AMT         05760002
058600         MOVE LLLOW-XFER-IN-RTL-AMT                               05770002
B28582                                 TO ML212-LOW-TBL-AMT             05780002
058800         MOVE HHIGH-XFER-IN-RTL-AMT                               05790002
B28582                                 TO ML212-HIGH-TBL-AMT            05800002
B28582         MOVE 6                  TO ML212-ERR-MSG-NBR             05810002
059100         WRITE DATA-INTEGRITY-DIFF-REC                            05820002
B28582             FROM ML212-DATA-INTEGRITY-DIFF-REC                   05830002
059300         ADD 1                   TO PA-REPORT-RECS-WRITTEN        05840002
059400     END-IF.                                                      05850002
059500                                                                  05860002
059600     IF LLLOW-XFER-OUT-RTL-AMT NOT = HHIGH-XFER-OUT-RTL-AMT       05870002
059700         MOVE LLLOW-XFER-OUT-RTL-AMT                              05880002
B28582                                 TO ML212-LOW-TBL-AMT             05890002
059900         MOVE HHIGH-XFER-OUT-RTL-AMT                              05900002
B28582                                 TO ML212-HIGH-TBL-AMT            05910002
B28582         MOVE 7                  TO ML212-ERR-MSG-NBR             05920002
060200         WRITE DATA-INTEGRITY-DIFF-REC                            05930002
060300             FROM ML212-DATA-INTEGRITY-DIFF-REC                   05940002
060400         ADD 1                   TO PA-REPORT-RECS-WRITTEN        05950002
060500     END-IF.                                                      05960002
060600                                                                  05970002
060700     IF LLLOW-RCPT-RTL-AMT NOT = HHIGH-RCPT-RTL-AMT               05980002
B28582         MOVE LLLOW-RCPT-RTL-AMT TO ML212-LOW-TBL-AMT             05990002
B28582         MOVE HHIGH-RCPT-RTL-AMT TO ML212-HIGH-TBL-AMT            06000002
B28582         MOVE 8                  TO ML212-ERR-MSG-NBR             06010002
061100         WRITE DATA-INTEGRITY-DIFF-REC                            06020002
B28582             FROM ML212-DATA-INTEGRITY-DIFF-REC                   06030002
061300         ADD 1                   TO PA-REPORT-RECS-WRITTEN        06040002
061400     END-IF.                                                      06050002
061500                                                                  06060002
061600     IF LLLOW-RCPT-NET-COST-AMT NOT = HHIGH-RCPT-NET-COST-AMT     06070002
061700         MOVE LLLOW-RCPT-NET-COST-AMT                             06080002
B28582                                 TO ML212-LOW-TBL-AMT             06090002
061900         MOVE HHIGH-RCPT-NET-COST-AMT                             06100002
B28582                                 TO ML212-HIGH-TBL-AMT            06110002
B28582         MOVE 9                  TO ML212-ERR-MSG-NBR             06120002
062200         WRITE DATA-INTEGRITY-DIFF-REC                            06130002
B28582             FROM ML212-DATA-INTEGRITY-DIFF-REC                   06140002
062400         ADD 1                   TO PA-REPORT-RECS-WRITTEN        06150002
062500     END-IF.                                                      06160002
062600                                                                  06170002
062700     IF LLLOW-PADJ-RTL-AMT NOT = HHIGH-PADJ-RTL-AMT               06180002
B28582         MOVE LLLOW-PADJ-RTL-AMT TO ML212-LOW-TBL-AMT             06190002
B28582         MOVE HHIGH-PADJ-RTL-AMT TO ML212-HIGH-TBL-AMT            06200002
B28582         MOVE 10                 TO ML212-ERR-MSG-NBR             06210002
063100         WRITE DATA-INTEGRITY-DIFF-REC                            06220002
B28582             FROM ML212-DATA-INTEGRITY-DIFF-REC                   06230002
063300         ADD 1                   TO PA-REPORT-RECS-WRITTEN        06240002
063400     END-IF.                                                      06250002
063500                                                                  06260002
063600     IF LLLOW-PADJ-NET-COST-AMT NOT = HHIGH-PADJ-NET-COST-AMT     06270002
063700         MOVE LLLOW-PADJ-NET-COST-AMT                             06280002
B28582                                 TO ML212-LOW-TBL-AMT             06290002
063900         MOVE HHIGH-PADJ-NET-COST-AMT                             06300002
B28582                                 TO ML212-HIGH-TBL-AMT            06310002
B28582         MOVE 11                 TO ML212-ERR-MSG-NBR             06320002
064200         WRITE DATA-INTEGRITY-DIFF-REC                            06330002
B28582             FROM ML212-DATA-INTEGRITY-DIFF-REC                   06340002
064400         ADD 1                   TO PA-REPORT-RECS-WRITTEN        06350002
064500     END-IF.                                                      06360002
064600**WR21394 COMMENTED OUT OUTER IF TEST                             06370002
064700*    IF CC-LOW-TABLE NOT = PC-LOW-TABLE-TVADPT AND                06380002
064800*       CC-LOW-TABLE NOT = PC-LOW-TABLE-TVAMCL                    06390002
064900     IF LLLOW-INV-ADJ-RTL-AMT NOT = HHIGH-INV-ADJ-RTL-AMT         06400002
065000        MOVE LLLOW-INV-ADJ-RTL-AMT                                06410002
B28582                             TO ML212-LOW-TBL-AMT                 06420002
065200        MOVE HHIGH-INV-ADJ-RTL-AMT                                06430002
B28582                             TO ML212-HIGH-TBL-AMT                06440002
B28582        MOVE 12                  TO ML212-ERR-MSG-NBR             06450002
065500        WRITE DATA-INTEGRITY-DIFF-REC                             06460002
B28582            FROM ML212-DATA-INTEGRITY-DIFF-REC                    06470002
065700        ADD 1                    TO PA-REPORT-RECS-WRITTEN        06480002
065800     END-IF.                                                      06490002
065900*    END-IF.                                                      06500002
066000                                                                  06510002
066100*** ELIMINTATE SHRINK TOLERANCE LEVELS                            06520002
066200     IF CC-LOW-TABLE NOT = 'TWKSCLS'                              06530002
066300*        PERFORM 5110-SHRINK-COMPARISONS.                         06540002
066400         IF LLLOW-SHNK-RTL-AMT = HHIGH-SHNK-RTL-AMT               06550002
066500             NEXT SENTENCE                                        06560002
066600         ELSE                                                     06570002
066700             MOVE LLLOW-SHNK-RTL-AMT                              06580002
B28582                                 TO ML212-LOW-TBL-AMT             06590002
066900             MOVE HHIGH-SHNK-RTL-AMT                              06600002
B28582                                 TO ML212-HIGH-TBL-AMT            06610002
B28582             MOVE 13             TO ML212-ERR-MSG-NBR             06620002
067200             WRITE DATA-INTEGRITY-DIFF-REC                        06630002
B28582                 FROM ML212-DATA-INTEGRITY-DIFF-REC               06640002
067400             ADD 1               TO PA-REPORT-RECS-WRITTEN        06650002
067500         END-IF                                                   06660002
067600     END-IF.                                                      06670002
067700                                                                  06680002
067800     IF CC-LOW-TABLE NOT = 'TWKSCLS'                              06690002
067900         IF LLLOW-END-INV-RTL-AMT NOT = HHIGH-END-INV-RTL-AMT     06700002
068000             MOVE LLLOW-END-INV-RTL-AMT                           06710002
B28582                                 TO ML212-LOW-TBL-AMT             06720002
068200             MOVE HHIGH-END-INV-RTL-AMT                           06730002
B28582                                 TO ML212-HIGH-TBL-AMT            06740002
B28582             MOVE 14             TO ML212-ERR-MSG-NBR             06750002
068500             WRITE DATA-INTEGRITY-DIFF-REC                        06760002
B28582                 FROM ML212-DATA-INTEGRITY-DIFF-REC               06770002
068700             ADD 1               TO PA-REPORT-RECS-WRITTEN        06780002
068800         END-IF                                                   06790002
068900     END-IF.                                                      06800002
067700                                                                  06810002
B28582     IF CC-LOW-TABLE NOT = 'TWKSCLS'                              06820002
B28582         IF LLLOW-END-INV-COST2-AMT                               06830002
B28582                                  NOT = HHIGH-END-INV-COST2-AMT   06831002
B28582             MOVE LLLOW-END-INV-COST2-AMT                         06832002
B28582                                 TO ML212-LOW-TBL-AMT             06833002
B28582             MOVE HHIGH-END-INV-COST2-AMT                         06834002
B28582                                 TO ML212-HIGH-TBL-AMT            06835002
B28582             MOVE 15             TO ML212-ERR-MSG-NBR             06836002
B28582             WRITE DATA-INTEGRITY-DIFF-REC                        06837002
B28582                 FROM ML212-DATA-INTEGRITY-DIFF-REC               06838002
B28582             ADD 1               TO PA-REPORT-RECS-WRITTEN        06839002
B28582         END-IF                                                   06840002
B28582     END-IF.                                                      06840102
067700                                                                  06840202
B28582     IF CC-LOW-TABLE NOT = 'TWKSCLS'                              06840302
B28582         IF LLLOW-ADJ-GRO-MRGN-AMT NOT = HHIGH-ADJ-GRO-MRGN-AMT   06840510
PK0408           AND NOT (CC-LOW-TABLE = 'MNLYSUM'                      06840610
PK0408                    AND CC-HIGH-TABLE = 'TMNDPT'                  06840710
PK0408                    AND HHIGH-SLS-RTL-AMT = 0                     06840810
PK0408                    AND HHIGH-ADJ-GRO-MRGN-AMT = 0)               06840910
B28582             MOVE LLLOW-ADJ-GRO-MRGN-AMT                          06841010
B28582                                 TO ML212-LOW-TBL-AMT             06841110
B28582             MOVE HHIGH-ADJ-GRO-MRGN-AMT                          06841210
B28582                                 TO ML212-HIGH-TBL-AMT            06841310
B28582             MOVE 16             TO ML212-ERR-MSG-NBR             06841410
B28582             WRITE DATA-INTEGRITY-DIFF-REC                        06841510
B28582                 FROM ML212-DATA-INTEGRITY-DIFF-REC               06841610
B28582             ADD 1               TO PA-REPORT-RECS-WRITTEN        06841710
B28582         END-IF                                                   06841810
B28582     END-IF.                                                      06841910
069000                                                                  06842010
B28582     IF (CC-LOW-TABLE = PC-LOW-TABLE-WKLYSUM  OR                  06842110
C28582         CC-LOW-TABLE = PC-LOW-TABLE-MNLYSUM  OR                  06842210
C28582         CC-LOW-TABLE = PC-LOW-TABLE-MNLYDBV)                     06842310
C28582         AND (CC-HIGH-TABLE = PC-HIGH-TABLE-WKLYSUM  OR           06842410
C28582              CC-HIGH-TABLE = PC-HIGH-TABLE-MNLYSUM  OR           06842510
C28582              CC-HIGH-TABLE = PC-HIGH-TABLE-MNLYDBV)              06842610
067800         AND HHIGH-DKEY-NBR  = 0                                  06842710
067800         AND LLLOW-DKEY-NBR  = 0                                  06842810
B28582             MOVE 19             TO ML212-ERR-MSG-NBR             06842910
B28582             MOVE ZEROS          TO ML212-LOW-TBL-AMT             06843002
B28582                                    ML212-HIGH-TBL-AMT            06844002
B28582             WRITE DATA-INTEGRITY-DIFF-REC                        06845002
B28582                 FROM ML212-DATA-INTEGRITY-DIFF-REC               06846002
B28582             ADD 1               TO PA-REPORT-RECS-WRITTEN        06847002
B28582     END-IF.                                                      06848002
069100 EJECT                                                            06849002
069200*** COMMENTED OUT PARAGRAPH                                       06850002
069300******************************************************************06860002
069400*5110-SHRINK-COMPARISONS.                                         06870002
069500******************************************************************06880002
069600*                                                                 06890002
069700*    COMPUTE PV-DIFF-SHNK-RTL-AMT =                               06900002
069800*        LLLOW-SHNK-RTL-AMT - HHIGH-SHNK-RTL-AMT.                 06910002
069900*                                                                 06920002
070000*    IF PV-DIFF-SHNK-RTL-AMT NEGATIVE                             06930002
070100*        COMPUTE PV-DIFF-SHNK-RTL-AMT = PV-DIFF-SHNK-RTL-AMT * -1.06940002
070200*                                                                 06950002
070300*                                                                 06960002
070400* CHANGE EQUATION TO ALLOW A CERTAIN AMOUNT OF VARIANCE           06970002
070500*                                                                 06980002
070600*    IF CC-LOW-TABLE = 'TMNSCLS'                                  06990002
070700*        IF PV-DIFF-SHNK-RTL-AMT > PC-SHNK-MAX-MNSCLS-MNSCL       07000002
070800*            MOVE LLLOW-SHNK-RTL-AMT                              07010002
070900*                                TO ML212-LOW-TBL-AMT             07020002
071000*            MOVE HHIGH-SHNK-RTL-AMT                              07030002
071100*                                TO ML212-HIGH-TBL-AMT            07040002
071200*            MOVE 13             TO ML212-ERR-MSG-NBR             07050002
071300*            WRITE DATA-INTEGRITY-DIFF-REC                        07060002
071400*                FROM ML212-DATA-INTEGRITY-DIFF-REC               07070002
071500*            ADD 1               TO PA-REPORT-RECS-WRITTEN        07080002
071600*        END-IF                                                   07090002
071700*    END-IF.                                                      07100002
071800*                                                                 07110002
071900*    IF CC-LOW-TABLE = 'TMNSCL'                                   07120002
072000*        IF PV-DIFF-SHNK-RTL-AMT > PC-SHNK-MAX-MNSCL-MNMCL        07130002
072100*            MOVE LLLOW-SHNK-RTL-AMT                              07140002
072200*                                TO ML212-LOW-TBL-AMT             07150002
072300*            MOVE HHIGH-SHNK-RTL-AMT                              07160002
072400*                                TO ML212-HIGH-TBL-AMT            07170002
072500*            MOVE 13             TO ML212-ERR-MSG-NBR             07180002
072600*            WRITE DATA-INTEGRITY-DIFF-REC                        07190002
072700*                FROM ML212-DATA-INTEGRITY-DIFF-REC               07200002
072800*            ADD 1               TO PA-REPORT-RECS-WRITTEN        07210002
072900*        END-IF                                                   07220002
073000*    END-IF.                                                      07230002
073100*                                                                 07240002
073200*    IF CC-LOW-TABLE = 'TMNMCL'                                   07250002
073300*        IF PV-DIFF-SHNK-RTL-AMT > PC-SHNK-MAX-MNMCL-MNDPT        07260002
073400*            MOVE LLLOW-SHNK-RTL-AMT                              07270002
073500*                                TO ML212-LOW-TBL-AMT             07280002
073600*            MOVE HHIGH-SHNK-RTL-AMT                              07290002
073700*                                TO ML212-HIGH-TBL-AMT            07300002
073800*                                                                 07310002
073900*            WRITE DATA-INTEGRITY-DIFF-REC                        07320002
074000*                FROM ML212-DATA-INTEGRITY-DIFF-REC               07330002
074100*            ADD 1               TO PA-REPORT-RECS-WRITTEN        07340002
074200*        END-IF                                                   07350002
074300*    END-IF.                                                      07360002
074400                                                                  07370002
074500                                                                  07380002
074600******************************************************************07390002
074700 5200-PROCESS-ONLY-LOW-FILE.                                      07400002
074800******************************************************************07410002
074900*                                                                 07420002
B28582                                                                  07430002
B28582     IF LLLOW-DKEY-NBR = 0                                        07440002
B28582         AND (CC-LOW-TABLE = PC-LOW-TABLE-WKLYSUM  OR             07450002
B28582              CC-LOW-TABLE = PC-LOW-TABLE-MNLYSUM  OR             07450106
B28582              CC-LOW-TABLE = PC-LOW-TABLE-MNLYDBV)                07450206
C28582         AND (CC-HIGH-TABLE = PC-HIGH-TABLE-WKLYSUM  OR           07450306
C28582              CC-HIGH-TABLE = PC-HIGH-TABLE-MNLYSUM  OR           07450406
C28582              CC-HIGH-TABLE = PC-HIGH-TABLE-MNLYDBV)              07450506
B28582         PERFORM 5230-LLLOW-DKEY-ERR                              07450606
B28582     END-IF.                                                      07450706
075100                                                                  07450806
075000     PERFORM 5210-BYPASS-LLLOW-0-DLRS-CHK.                        07450906
075100                                                                  07451006
075200     IF PS-BYPASS-0-DOLLARS                                       07451106
075300         CONTINUE                                                 07451206
075400     ELSE                                                         07451306
075500         PERFORM 5220-PROCESS-NO-HIGH-RECD-ERR                    07451406
075600     END-IF.                                                      07452002
075700                                                                  07453002
075800 EJECT                                                            07454002
075900                                                                  07455002
076000******************************************************************07456002
076100 5210-BYPASS-LLLOW-0-DLRS-CHK.                                    07457002
076200******************************************************************07458002
076300                                                                  07459002
076400     IF (LLLOW-SLS-RTL-AMT = 0)                                   07460002
076500       AND (LLLOW-MKDN-RTL-AMT = 0)                               07470002
076600       AND (LLLOW-MKUP-RTL-AMT = 0)                               07480002
076700       AND (LLLOW-XFER-IN-RTL-AMT = 0)                            07490002
076800       AND (LLLOW-XFER-OUT-RTL-AMT = 0)                           07500002
076900       AND (LLLOW-RCPT-RTL-AMT = 0)                               07510002
077000       AND (LLLOW-RCPT-NET-COST-AMT = 0)                          07520002
077100       AND (LLLOW-PADJ-RTL-AMT = 0)                               07530002
077200       AND (LLLOW-PADJ-NET-COST-AMT = 0)                          07540002
077300       AND (LLLOW-INV-ADJ-RTL-AMT = 0)                            07550002
077400       AND (LLLOW-SHNK-RTL-AMT = 0)                               07560002
B28582       AND (LLLOW-END-INV-RTL-AMT = 0)                            07570002
B28582       AND (LLLOW-END-INV-COST1-AMT = 0)                          07580002
B28582       AND (LLLOW-END-INV-COST2-AMT = 0)                          07590002
B28582       AND (LLLOW-ADJ-GRO-MRGN-AMT = 0)                           07600002
077500         SET PS-BYPASS-0-DOLLARS TO TRUE                          07610002
077600     ELSE                                                         07620002
077700         SET PS-NO-BYPASS-DOLLARS TO TRUE                         07630002
077800     END-IF.                                                      07640002
077900                                                                  07650002
078000 EJECT                                                            07660002
078100                                                                  07670002
078200******************************************************************07680002
078300 5220-PROCESS-NO-HIGH-RECD-ERR.                                   07690002
078400******************************************************************07700002
078500*                                                                 07710002
B28582     MOVE LLLOW-FSCL-MN-END-DTE  TO ML212-FSCL-MN-END-DTE.        07720002
B28582     MOVE LLLOW-FSCL-MN-NBR      TO ML212-FSCL-MN-NBR.            07730002
B28582     MOVE LLLOW-DEPT-NBR         TO ML212-DEPT-NBR.               07740002
078900     EVALUATE TRUE                                                07750002
079000         WHEN CC-LOW-TABLE = 'TWKDPT'                             07760002
B28582             MOVE '00'           TO ML212-MAJ-CL-NBR              07770002
B28582                                    ML212-SUB-CL-NBR              07780002
B28582             MOVE 0              TO ML212-STR-NBR                 07790002
B28582             MOVE ZEROS          TO ML212-DKEY-NBR                07800002
079400         WHEN CC-LOW-TABLE = PC-LOW-TABLE-TVADPT                  07810002
B28582             MOVE '00'           TO ML212-MAJ-CL-NBR              07820002
B28582                                    ML212-SUB-CL-NBR              07830002
B28582             MOVE 0              TO ML212-STR-NBR                 07840002
B28582             MOVE ZEROS          TO ML212-DKEY-NBR                07850002
079800         WHEN CC-LOW-TABLE = 'TMNMCL'                             07860002
B28582             MOVE '00'           TO ML212-MAJ-CL-NBR              07870002
B28582                                    ML212-SUB-CL-NBR              07880002
B28582             MOVE 0              TO ML212-STR-NBR                 07890002
B28582             MOVE ZEROS          TO ML212-DKEY-NBR                07900002
080200         WHEN CC-LOW-TABLE = 'TMNSCL'                             07910002
080300             MOVE LLLOW-MAJ-CL-NBR                                07920002
B28582                                 TO ML212-MAJ-CL-NBR              07930002
B28582             MOVE '00'           TO ML212-SUB-CL-NBR              07940002
B28582             MOVE 0              TO ML212-STR-NBR                 07950002
B28582             MOVE ZEROS          TO ML212-DKEY-NBR                07960002
080700         WHEN CC-LOW-TABLE = PC-LOW-TABLE-TVAMCL                  07970002
080800             MOVE LLLOW-MAJ-CL-NBR                                07980002
B28582                                 TO ML212-MAJ-CL-NBR              07990002
B28582             MOVE '00'           TO ML212-SUB-CL-NBR              08000002
B28582             MOVE 0              TO ML212-STR-NBR                 08010002
B28582             MOVE ZEROS          TO ML212-DKEY-NBR                08020002
081200         WHEN CC-LOW-TABLE = 'TMNDPTS'                            08030002
B28582             MOVE '00'           TO ML212-MAJ-CL-NBR              08040002
B28582                                    ML212-SUB-CL-NBR              08050002
B28582             MOVE 0              TO ML212-STR-NBR                 08060002
B28582             MOVE ZEROS          TO ML212-DKEY-NBR                08070002
081600         WHEN CC-LOW-TABLE = 'TMNMCLS'                            08080002
081700             MOVE LLLOW-MAJ-CL-NBR                                08090002
B28582                                 TO ML212-MAJ-CL-NBR              08100002
B28582             MOVE '00'           TO ML212-SUB-CL-NBR              08110002
B28582             MOVE 0              TO ML212-STR-NBR                 08120002
B28582             MOVE ZEROS          TO ML212-DKEY-NBR                08130002
082100         WHEN CC-LOW-TABLE = 'TMNSCLS'                            08140002
082200             MOVE LLLOW-MAJ-CL-NBR                                08150002
B28582                                 TO ML212-MAJ-CL-NBR              08160002
082400             MOVE LLLOW-SUB-CL-NBR                                08170002
B28582                                 TO ML212-SUB-CL-NBR              08180002
B28582             MOVE 0              TO ML212-STR-NBR                 08190002
B28582             MOVE ZEROS          TO ML212-DKEY-NBR                08200002
082700         WHEN CC-LOW-TABLE = 'TWKSCLS'                            08201002
082800             MOVE LLLOW-MAJ-CL-NBR                                08202002
B28582                                 TO ML212-MAJ-CL-NBR              08203002
B28582             MOVE LLLOW-SUB-CL-NBR                                08204002
B28582                                 TO ML212-SUB-CL-NBR              08205002
B28582             MOVE LLLOW-STR-NBR  TO ML212-STR-NBR                 08206002
B28582             MOVE ZEROS          TO ML212-DKEY-NBR                08207002
083300         WHEN CC-LOW-TABLE = PC-LOW-TABLE-TWKPOSS                 08208002
B28582             MOVE LLLOW-MAJ-CL-NBR                                08209002
B28582                                 TO ML212-MAJ-CL-NBR              08210002
B28582             MOVE LLLOW-SUB-CL-NBR                                08220002
B28582                                 TO ML212-SUB-CL-NBR              08230002
B28582             MOVE LLLOW-STR-NBR  TO ML212-STR-NBR                 08240002
B28582             MOVE ZEROS          TO ML212-DKEY-NBR                08250002
083900         WHEN CC-LOW-TABLE = 'TWKMCL'                             08260002
084000             MOVE LLLOW-MAJ-CL-NBR                                08270002
B28582                                 TO ML212-MAJ-CL-NBR              08280002
B28582             MOVE '00'           TO ML212-SUB-CL-NBR              08290002
B28582             MOVE 0              TO ML212-STR-NBR                 08300002
B28582             MOVE ZEROS          TO ML212-DKEY-NBR                08310002
084400***- WR 21355                                                     08320002
084500         WHEN CC-LOW-TABLE = PC-LOW-TABLE-TWKDPTS                 08330002
B28582             MOVE '00'           TO ML212-MAJ-CL-NBR              08340002
B28582                                    ML212-SUB-CL-NBR              08350002
B28582             MOVE LLLOW-STR-NBR  TO ML212-STR-NBR                 08360002
B28582             MOVE ZEROS          TO ML212-DKEY-NBR                08370002
084900         WHEN CC-LOW-TABLE = PC-LOW-TABLE-TWKDPTC                 08380002
B28582             MOVE '00'           TO ML212-MAJ-CL-NBR              08390002
B28582                                    ML212-SUB-CL-NBR              08400002
B28582             MOVE 0              TO ML212-STR-NBR                 08410002
B28582             MOVE ZEROS          TO ML212-DKEY-NBR                08420002
085300         WHEN CC-LOW-TABLE = PC-LOW-TABLE-TMNDPTC                 08430002
B28582             MOVE '00'           TO ML212-MAJ-CL-NBR              08440002
B28582                                    ML212-SUB-CL-NBR              08450002
B28582             MOVE 0              TO ML212-STR-NBR                 08460002
B28582             MOVE ZEROS          TO ML212-DKEY-NBR                08470002
085700         WHEN CC-LOW-TABLE = PC-LOW-TABLE-TWKMCLC                 08480002
B28582             MOVE '00'           TO ML212-MAJ-CL-NBR              08490002
B28582                                    ML212-SUB-CL-NBR              08500002
B28582             MOVE 0              TO ML212-STR-NBR                 08510002
B28582             MOVE ZEROS          TO ML212-DKEY-NBR                08520002
086100         WHEN CC-LOW-TABLE = PC-LOW-TABLE-TMNMCLC                 08530002
B28582             MOVE '00'           TO ML212-MAJ-CL-NBR              08540002
B28582                                    ML212-SUB-CL-NBR              08550002
B28582             MOVE 0              TO ML212-STR-NBR                 08560002
B28582             MOVE ZEROS          TO ML212-DKEY-NBR                08570002
086410         WHEN CC-LOW-TABLE = PC-LOW-TABLE-WKLYSUM                 08580002
086420             MOVE LLLOW-MAJ-CL-NBR                                08590002
B28582                                 TO ML212-MAJ-CL-NBR              08600002
086440             MOVE LLLOW-SUB-CL-NBR                                08610002
B28582                                 TO ML212-SUB-CL-NBR              08620002
B28582             MOVE LLLOW-STR-NBR  TO ML212-STR-NBR                 08630002
B28582             MOVE LLLOW-DKEY-NBR TO ML212-DKEY-NBR                08640002
086470         WHEN CC-LOW-TABLE = PC-LOW-TABLE-MNLYSUM                 08640102
086480             MOVE LLLOW-MAJ-CL-NBR                                08640202
B28582                                 TO ML212-MAJ-CL-NBR              08640302
086491             MOVE LLLOW-SUB-CL-NBR                                08640402
B28582                                 TO ML212-SUB-CL-NBR              08640502
B28582             MOVE LLLOW-STR-NBR  TO ML212-STR-NBR                 08640602
B28582             MOVE LLLOW-DKEY-NBR TO ML212-DKEY-NBR                08640702
086500     END-EVALUATE.                                                08640802
086600                                                                  08640902
B28582     MOVE 0                      TO ML212-LOW-TBL-AMT             08641002
B28582                                    ML212-HIGH-TBL-AMT.           08642002
B28582     MOVE 1                      TO ML212-ERR-MSG-NBR.            08643002
087000                                                                  08644002
087100     WRITE DATA-INTEGRITY-DIFF-REC                                08645002
B28582         FROM ML212-DATA-INTEGRITY-DIFF-REC.                      08646002
087300                                                                  08647002
087400     ADD 1                       TO PA-REPORT-RECS-WRITTEN.       08648002
087500                                                                  08649002
B28582 5230-LLLOW-DKEY-ERR.                                             08650002
B28582*                                                                 08660002
B28582     MOVE LLLOW-FSCL-MN-END-DTE  TO ML212-FSCL-MN-END-DTE.        08670002
B28582     MOVE LLLOW-FSCL-MN-NBR      TO ML212-FSCL-MN-NBR.            08680002
B28582     MOVE LLLOW-DEPT-NBR         TO ML212-DEPT-NBR.               08690002
B28582     MOVE LLLOW-MAJ-CL-NBR       TO ML212-MAJ-CL-NBR.             08700002
B28582     MOVE LLLOW-SUB-CL-NBR       TO ML212-SUB-CL-NBR.             08710002
B28582     MOVE LLLOW-STR-NBR          TO ML212-STR-NBR.                08720002
B28582     MOVE LLLOW-DKEY-NBR         TO ML212-DKEY-NBR.               08730002
086600                                                                  08731002
B28582     MOVE 0                      TO ML212-LOW-TBL-AMT             08732002
B28582                                    ML212-HIGH-TBL-AMT.           08732102
B28582     MOVE 17                     TO ML212-ERR-MSG-NBR.            08732202
087000                                                                  08732302
087100     WRITE DATA-INTEGRITY-DIFF-REC                                08732402
B28582         FROM ML212-DATA-INTEGRITY-DIFF-REC.                      08732502
087300                                                                  08732602
087400     ADD 1                       TO PA-REPORT-RECS-WRITTEN.       08732702
087700                                                                  08732802
087600 EJECT                                                            08732902
087700                                                                  08733002
087800******************************************************************08734002
087900 5300-PROCESS-ONLY-HIGH-FILE.                                     08735002
088000******************************************************************08736002
088100*                                                                 08737002
B28582                                                                  08738002
B28582     IF HHIGH-DKEY-NBR = 0                                        08739002
B28582         AND (CC-LOW-TABLE = PC-LOW-TABLE-WKLYSUM  OR             08740002
C28582              CC-LOW-TABLE = PC-LOW-TABLE-MNLYSUM  OR             08750007
C28582              CC-LOW-TABLE = PC-LOW-TABLE-MNLYDBV)                08750106
B28582         AND (CC-HIGH-TABLE = PC-HIGH-TABLE-WKLYSUM  OR           08751006
B28582              CC-HIGH-TABLE = PC-HIGH-TABLE-MNLYSUM  OR           08752007
B28582              CC-HIGH-TABLE = PC-HIGH-TABLE-MNLYDBV)              08753006
B28582         PERFORM 5330-HHIGH-DKEY-ERR                              08760002
B28582     END-IF.                                                      08770002
B28582                                                                  08780002
088200     PERFORM 5310-BYPASS-HHIGH-0-DLRS-CHK.                        08790002
088300                                                                  08800002
088400     IF PS-BYPASS-0-DOLLARS                                       08810002
088500         CONTINUE                                                 08820002
088600     ELSE                                                         08830002
088700         PERFORM 5320-PROCESS-NO-LOW-RECD-ERR                     08840002
088800     END-IF.                                                      08850002
088900                                                                  08860002
089000 EJECT                                                            08870002
089100                                                                  08880002
089200******************************************************************08890002
089300 5310-BYPASS-HHIGH-0-DLRS-CHK.                                    08900002
089400******************************************************************08910002
089500                                                                  08920002
089600     IF (HHIGH-SLS-RTL-AMT = 0)                                   08930002
089700       AND (HHIGH-MKDN-RTL-AMT = 0)                               08940002
089800       AND (HHIGH-MKUP-RTL-AMT = 0)                               08950002
089900       AND (HHIGH-XFER-IN-RTL-AMT = 0)                            08960002
090000       AND (HHIGH-XFER-OUT-RTL-AMT = 0)                           08970002
090100       AND (HHIGH-RCPT-RTL-AMT = 0)                               08980002
090200       AND (HHIGH-RCPT-NET-COST-AMT = 0)                          08990002
090300       AND (HHIGH-PADJ-RTL-AMT = 0)                               09000002
090400       AND (HHIGH-PADJ-NET-COST-AMT = 0)                          09010002
090500       AND (HHIGH-INV-ADJ-RTL-AMT = 0)                            09020002
090600       AND (HHIGH-SHNK-RTL-AMT = 0)                               09030002
B28582       AND (HHIGH-END-INV-RTL-AMT = 0)                            09031002
B28582       AND (HHIGH-END-INV-COST1-AMT = 0)                          09032002
B28582       AND (HHIGH-END-INV-COST2-AMT = 0)                          09033002
B28582       AND (HHIGH-ADJ-GRO-MRGN-AMT = 0)                           09034002
090700         SET PS-BYPASS-0-DOLLARS TO TRUE                          09035002
090800     ELSE                                                         09036002
090900         SET PS-NO-BYPASS-DOLLARS TO TRUE                         09037002
091000     END-IF.                                                      09038002
091100                                                                  09039002
091200 EJECT                                                            09040002
091300                                                                  09050002
091400******************************************************************09060002
091500 5320-PROCESS-NO-LOW-RECD-ERR.                                    09070002
091600******************************************************************09080002
091700*                                                                 09090002
B28582     MOVE HHIGH-FSCL-MN-END-DTE  TO ML212-FSCL-MN-END-DTE.        09100002
B28582     MOVE HHIGH-FSCL-MN-NBR      TO ML212-FSCL-MN-NBR.            09110002
B28582     MOVE HHIGH-DEPT-NBR         TO ML212-DEPT-NBR.               09120002
B28582     MOVE HHIGH-MAJ-CL-NBR       TO ML212-MAJ-CL-NBR.             09130002
B28582     MOVE HHIGH-SUB-CL-NBR       TO ML212-SUB-CL-NBR.             09140002
B28582     MOVE HHIGH-STR-NBR          TO ML212-STR-NBR.                09150002
B28582     MOVE HHIGH-DKEY-NBR         TO ML212-DKEY-NBR.               09160002
B28582     MOVE 0                      TO ML212-LOW-TBL-AMT             09170002
B28582                                    ML212-HIGH-TBL-AMT.           09180002
B28582     MOVE 2                      TO ML212-ERR-MSG-NBR.            09190002
092700                                                                  09200002
092800     WRITE DATA-INTEGRITY-DIFF-REC                                09210002
B28582         FROM ML212-DATA-INTEGRITY-DIFF-REC.                      09220002
093000                                                                  09230002
093100     ADD 1                       TO PA-REPORT-RECS-WRITTEN.       09240002
B28582                                                                  09250002
B28582 5330-HHIGH-DKEY-ERR.                                             09260002
B28582                                                                  09270002
B28582     MOVE HHIGH-FSCL-MN-END-DTE  TO ML212-FSCL-MN-END-DTE.        09280002
B28582     MOVE HHIGH-FSCL-MN-NBR      TO ML212-FSCL-MN-NBR.            09290002
B28582     MOVE HHIGH-DEPT-NBR         TO ML212-DEPT-NBR.               09291002
B28582     MOVE HHIGH-MAJ-CL-NBR       TO ML212-MAJ-CL-NBR.             09292002
B28582     MOVE HHIGH-SUB-CL-NBR       TO ML212-SUB-CL-NBR.             09293002
B28582     MOVE HHIGH-STR-NBR          TO ML212-STR-NBR.                09294002
B28582     MOVE HHIGH-DKEY-NBR         TO ML212-DKEY-NBR.               09295002
B28582     MOVE 0                      TO ML212-LOW-TBL-AMT             09296002
B28582                                    ML212-HIGH-TBL-AMT.           09297002
B28582     MOVE 18                     TO ML212-ERR-MSG-NBR.            09298002
092700                                                                  09299002
092800     WRITE DATA-INTEGRITY-DIFF-REC                                09299102
B28582         FROM ML212-DATA-INTEGRITY-DIFF-REC.                      09299202
093000                                                                  09299302
093100     ADD 1                       TO PA-REPORT-RECS-WRITTEN.       09299402
093200                                                                  09299502
093300******************************************************************09299602
093400 5400-COMPARE-BOTH-FILE-AMTS.                                     09299702
093500******************************************************************09299802
B28582     MOVE HHIGH-FSCL-MN-END-DTE  TO ML212-FSCL-MN-END-DTE.        09299902
B28582     MOVE HHIGH-FSCL-MN-NBR      TO ML212-FSCL-MN-NBR.            09300002
B28582     MOVE HHIGH-DEPT-NBR         TO ML212-DEPT-NBR.               09310002
B28582     MOVE HHIGH-MAJ-CL-NBR       TO ML212-MAJ-CL-NBR.             09320002
B28582     MOVE HHIGH-SUB-CL-NBR       TO ML212-SUB-CL-NBR.             09330002
B28582     MOVE HHIGH-STR-NBR          TO ML212-STR-NBR.                09340002
           MOVE HHIGH-DKEY-NBR         TO ML212-DKEY-NBR.               09350002
094200                                                                  09360002
094300     IF LLLOW-RCPT-RTL-AMT NOT = HHIGH-RCPT-RTL-AMT               09370002
B28582         MOVE LLLOW-RCPT-RTL-AMT TO ML212-LOW-TBL-AMT             09380002
B28582         MOVE HHIGH-RCPT-RTL-AMT TO ML212-HIGH-TBL-AMT            09390002
B28582         MOVE 8                  TO ML212-ERR-MSG-NBR             09400002
094700         WRITE DATA-INTEGRITY-DIFF-REC                            09410002
B28582             FROM ML212-DATA-INTEGRITY-DIFF-REC                   09420002
094900         ADD 1                   TO PA-REPORT-RECS-WRITTEN        09430002
095000     END-IF.                                                      09440002
095100                                                                  09450002
095200     IF LLLOW-RCPT-NET-COST-AMT NOT = HHIGH-RCPT-NET-COST-AMT     09460002
095300         MOVE LLLOW-RCPT-NET-COST-AMT                             09470002
B28582                                 TO ML212-LOW-TBL-AMT             09480002
095500         MOVE HHIGH-RCPT-NET-COST-AMT                             09490002
B28582                                 TO ML212-HIGH-TBL-AMT            09500002
095700         MOVE 9                  TO ML212-ERR-MSG-NBR             09510002
095800         WRITE DATA-INTEGRITY-DIFF-REC                            09520002
B28582             FROM ML212-DATA-INTEGRITY-DIFF-REC                   09530002
096000         ADD 1                   TO PA-REPORT-RECS-WRITTEN        09540002
096100     END-IF.                                                      09550002
096200                                                                  09560002
096300 EJECT                                                            09570002
096400                                                                  09580002
096500******************************************************************09590002
096600 8000-EOJ.                                                        09600002
096700******************************************************************09610002
096800*                                                                 09620002
096900     DISPLAY ' '.                                                 09630002
097000     DISPLAY '  PROGRAM MLKUT491 PROCESSING SUMMARY'.             09640002
097100     DISPLAY '  -----------------------------------'.             09650002
097200     DISPLAY ' '.                                                 09660002
097300*                                                                 09670002
097400     MOVE PA-LOW-RECS-READ       TO CD-COUNT-HOLD1.               09680002
097500     DISPLAY 'LOW RECORDS READ =       ' CD-COUNT-HOLD1.          09690002
097600*                                                                 09700002
097700     MOVE PA-HIGH-RECS-READ      TO CD-COUNT-HOLD1.               09710002
097800     DISPLAY 'HIGH RECORDS READ =      ' CD-COUNT-HOLD1.          09720002
097900*                                                                 09730002
098000     MOVE PA-KEY-MATCHES         TO CD-COUNT-HOLD1.               09740002
098100     DISPLAY 'KEY MATCHES =            ' CD-COUNT-HOLD1.          09750002
098200*                                                                 09760002
098300     MOVE PA-REPORT-RECS-WRITTEN TO CD-COUNT-HOLD1.               09770002
098400     DISPLAY 'REPORT RECORDS WRITTEN = ' CD-COUNT-HOLD1.          09780002
098500*                                                                 09790002
098600     DISPLAY ' '.                                                 09800002
098700                                                                  09810002
C28582     CLOSE COMPARE-TABLES-CTL-FILE                                09820004
C28582           L-DATA-INTEGRITY-EXTR-FILE                             09830004
C28582           H-DATA-INTEGRITY-EXTR-FILE                             09840004
C28582           SOPT-CTL-FILE                                          09841004
C28582           DATA-INTEGRITY-DIFF-FILE.                              09850004
099200                                                                  09860002
099300 EJECT                                                            09870002
099400                                                                  09880002
099500******************************************************************09890002
099600 9900-COMMON-ABEND-ROUTINE.                                       09900002
099700******************************************************************09910002
099800*                                                                 09920002
099900     DISPLAY AA-ABEND-LIT.                                        09930002
100000     DISPLAY AA-PROGRAM-LIT.                                      09940002
100100     DISPLAY AA-PARAGRAPH-LIT.                                    09950002
100200     DISPLAY AA-MESSAGE-LINE.                                     09960002
100300     DISPLAY ABEND-CODE.                                          09970002
100400                                                                  09980002
100500     CALL 'ILBOABN0' USING ABEND-CODE.                            09990002
100600                                                                  10000002
