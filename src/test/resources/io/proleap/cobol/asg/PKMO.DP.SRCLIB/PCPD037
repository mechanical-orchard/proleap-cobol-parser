000100******************************************************************00010009
000200*  PCPD037                                                       *00020009
000300******************************************************************00030009
000400*  CALCULATES THE CHECK DIGIT FOR A FAST NUMBER.  BASED ON CODE IN00040009
000500*  PROGRAM TFKCS423.                                              00050009
000600******************************************************************00060009
000700 P0300-GET-CHK-DIGIT.                                             00070009
000800     PERFORM P0310-SUM-XFER-DIGITS                                00080009
000900         VARYING PC037-XFER-IDX                                   00090009
001000         FROM 1 BY 1                                              00100009
001100         UNTIL PC037-XFER-IDX > 11.                               00110012
001200                                                                  00120009
001300     PERFORM P0320-COMPUTE-CHK-DIGIT.                             00130009
001400*                                                                 00140009
001500 P0310-SUM-XFER-DIGITS.                                           00150009
001600     IF PC037-XFER-DIGIT (PC037-XFER-IDX) > 4                     00160013
001700         COMPUTE PC037-DBL-DIGIT =                                00170009
001800             ((PC037-XFER-DIGIT (PC037-XFER-IDX) * 2) - 9)        00180009
001900     ELSE                                                         00190009
002000         COMPUTE PC037-DBL-DIGIT =                                00200009
002100             PC037-XFER-DIGIT (PC037-XFER-IDX) * 2                00210009
002200     END-IF.                                                      00220009
002300                                                                  00230009
002400     SET PC037-IDX-VALUE TO PC037-XFER-IDX.                       00240009
002500                                                                  00250009
002600     DIVIDE  PC037-IDX-VALUE BY 2                                 00260009
002700         GIVING PC037-QUOTIENT                                    00270009
002800         REMAINDER PC037-REMAINDER                                00280009
002900     END-DIVIDE.                                                  00290009
003000                                                                  00300009
003100     IF PC037-REMAINDER = ZERO                                    00310009
003200         COMPUTE PC037-DIGIT-SUM =                                00320009
003300             PC037-DIGIT-SUM + PC037-DBL-DIGIT                    00330009
003400     ELSE                                                         00340009
003500         COMPUTE PC037-DIGIT-SUM =                                00350009
003600             PC037-DIGIT-SUM + PC037-XFER-DIGIT (PC037-XFER-IDX)  00360009
003700     END-IF.                                                      00370009
003800*                                                                 00380009
003900 P0320-COMPUTE-CHK-DIGIT.                                         00390009
004000     DIVIDE  PC037-DIGIT-SUM BY 10                                00400009
004100         GIVING PC037-QUOTIENT                                    00410009
004200         REMAINDER PC037-REMAINDER                                00420009
004300     END-DIVIDE.                                                  00430009
004400*                                                                 00440009
004500     IF PC037-REMAINDER = ZERO                                    00450009
004600         MOVE ZERO               TO PC037-CHK-DIGIT               00460009
004700     ELSE                                                         00470009
004800         COMPUTE PC037-CHK-DIGIT =                                00480009
004900             10  -  PC037-REMAINDER                               00490009
005000     END-IF.                                                      00500009
005100     MOVE PC037-CHK-DIGIT        TO PC037-FAST-CHECK-DIGIT.       00510009
