000100 IDENTIFICATION DIVISION.                                         00010000
000200 PROGRAM-ID.    VNKCS013.                                         00020000
000300 AUTHOR.        CHRIS KORTENDICK.                                 00030000
000400 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00040000
000500 DATE-WRITTEN.  06/93.                                            00050000
000600 DATE-COMPILED.                                                   00060000
000700***************************************************************** 00070002
000800*  V013 - VENDOR TERMS INQUIRY PROGRAM                          * 00080002
000900*  DISPLAY PAYMENT, SHIPPING, AND PURCHASE TERMS FOR A SPECIFIED* 00090002
001000*  VENDOR.                                                      * 00100002
001100*                                                               * 00110002
001200*   02/20/2003                                                  * 00120000
001300*      NEED IN QA                                               * 00130000
001400*   MADE BY: L SCHALLHORN                 WR#: 23417            * 00140000
001500*                                                               * 00150002
001600* DATE  08/28/2003                                              * 00160002
001700*     CHANGE MADE: ADDED CODE TO FETCH AND DISPLAY VND_AUTH_ID  * 00170002
001800*     FROM TVNDAGR.                                             * 00180002
001900*     MADE BY: MIKE BESKE              WR/IR #: WR21316         * 00190002
002000*                                                               * 00200002
002100* DATE  03/27/2006                                              * 00210011
002200*     CHANGE MADE: ADDED CODE TO FETCH AND DISPLAY LATE_SHIPT_  * 00220011
002300*     IND, CHRG_PCT AND CHRG_FCTR_CDE FROM TVNDAGR UNDER THE    * 00230011
002400*     SHIPPING TERMS PROCESSING (PARA 4040-).                   * 00240011
002500*     MADE BY: MIKE BESKE              WR/IR #: WR30028         * 00250011
002600*                                                               * 00260011
002100* DATE  01/03/2023                                              * 00261019
002200*     CHANGE MADE: CHANGE CALL TO DPKCS030 TO DYNAMIC           * 00262019
002500*     MADE BY: JEAN KURK               WR/IR #: CHG0277999      * 00265019
002700*---------------------------------------------------------------* 00270011
002800 ENVIRONMENT DIVISION.                                            00280011
002900 DATA DIVISION.                                                   00290011
003000 WORKING-STORAGE SECTION.                                         00300011
003100                                                                  00310011
003200 01  NI-NULL-INDICATORS.                                          00320011
003300     05  NI-EXTENT-DUN-NBR            PIC S9(4) COMP VALUE ZERO.  00330011
003400     05  NI-VNDAGR-PAYT-TERM-ID       PIC S9(4) COMP VALUE ZERO.  00340011
003500     05  NI-VNDAGR-FOB-POINT-TXT      PIC S9(4) COMP VALUE ZERO.  00350011
003600     05  NI-VNDAGR-SHIPT-POINT-TXT    PIC S9(4) COMP VALUE ZERO.  00360011
003700     05  NI-VNDAGR-RTV-RA-REQD-IND    PIC S9(4) COMP VALUE ZERO.  00370011
003800     05  NI-VNDAGR-RTV-NO-RA-REQD-IND PIC S9(4) COMP VALUE ZERO.  00380011
003900     05  NI-VNDAGR-DEBIT-DESTROY-IND  PIC S9(4) COMP VALUE ZERO.  00390011
004000     05  NI-VNDAGR-MARKOUT-IND        PIC S9(4) COMP VALUE ZERO.  00400011
004100     05  NI-VNDAGR-VND-AUTH-ID        PIC S9(4) COMP VALUE ZERO.  00410011
004200                                                                  00420011
004300 01  PC-PROGRAM-CONSTANTS.                                        00430011
004400     05  PC-CURRENT-MAP-NAME          PIC X(8)  VALUE 'VN013A  '. 00440011
004500     05  PC-CURRENT-MAPSET-NAME       PIC X(8)  VALUE 'VNKM013 '. 00450011
004600     05  PC-CURRENT-PROGRAM-NAME      PIC X(8)  VALUE 'VNKCS013'. 00460011
004700     05  PC-INTER-APPL-CRIT-SPEC      PIC X     VALUE '1'.        00470011
004800     05  PC-INTER-APPL-LIST           PIC X     VALUE '2'.        00480011
004900     05  PC-SHIPPING                  PIC X     VALUE '1'.        00490011
005000     05  PC-PAYMENT                   PIC X     VALUE '2'.        00500011
005100     05  PC-PURCHASE                  PIC X     VALUE '3'.        00510011
005200     05  PC-PRIMARY                   PIC XX    VALUE '01'.       00520011
005300     05  PC-MAX-RETRIES               PIC S9(4) COMP SYNC         00530011
005400                                                VALUE +3.         00540011
005500     05  PC-MAX-REC-CNT               PIC S9(4) COMP SYNC         00550011
005600                                                VALUE +9999.      00560011
005700     05  PC-TSYMSG-NUMBERS.                                       00570011
005800         10  PC-TSYMSG-00057          PIC 9(5)  VALUE 00057.      00580011
005900         10  PC-TSYMSG-00069          PIC 9(5)  VALUE 00069.      00590011
006000         10  PC-TSYMSG-00070          PIC 9(5)  VALUE 00070.      00600011
006100         10  PC-TSYMSG-00156          PIC 9(5)  VALUE 00156.      00610011
006200         10  PC-TSYMSG-00488          PIC 9(5)  VALUE 00488.      00620011
006300         10  PC-TSYMSG-00489          PIC 9(5)  VALUE 00489.      00630011
006400         10  PC-TSYMSG-00499          PIC 9(5)  VALUE 00499.      00640011
006500         10  PC-TSYMSG-00500          PIC 9(5)  VALUE 00500.      00650011
006600                                                                  00660011
006700 01  PS-PROGRAM-SWITCHES.                                         00670011
006800     05  PS-ERROR-SW                  PIC  X    VALUE 'N'.        00680011
006900         88  PS-NO-ERROR                        VALUE 'N'.        00690011
007000         88  PS-ERROR                           VALUE 'Y'.        00700011
007100     05  PS-END-OF-LIST-SW            PIC  X    VALUE 'N'.        00710011
007200         88  PS-NOT-END-OF-LIST                 VALUE 'N'.        00720011
007300         88  PS-END-OF-LIST                     VALUE 'Y'.        00730011
007400                                                                  00740011
007500 01  PV-PROGRAM-VARIABLES.                                        00750011
007600     05  PV-CICS-RESPONSE             PIC S9(4) COMP SYNC         00760011
007700                                                VALUE ZERO.       00770011
007800     05  PV-RETRY-COUNTER             PIC S9(4) COMP SYNC         00780011
007900                                                VALUE ZERO.       00790011
008000     05  PV-VENDOR-NAME-LOW           PIC X(30) VALUE SPACES.     00800011
008100     05  PV-VENDOR-NAME-HIGH          PIC X(30) VALUE SPACES.     00810011
008200     05  PV-DEPT-NBR                  PIC XXX   VALUE SPACES.     00820011
008300     05  PV-INHOUSE-NBR-X.                                        00830011
008400         10  PV-INHOUSE-NBR           PIC 999   VALUE ZERO.       00840011
008500     05  PV-INHOUSE-NUMBER            PIC S999 COMP-3 VALUE ZERO. 00850011
008600     05  PV-INHOUSE-NBR-LOW           PIC S999 COMP-3 VALUE ZERO. 00860011
008700     05  PV-INHOUSE-NBR-HIGH          PIC S999 COMP-3 VALUE ZERO. 00870011
008800     05  PV-NUM-KOHLS-FRGHT-PCT       PIC 9(5)  VALUE ZERO.       00880011
008900     05  PV-NUM-VENDR-FRGHT-PCT       PIC 9(5)  VALUE ZERO.       00890011
009000     05  PV-NUM-DISCOUNT-PCT          PIC 99    VALUE ZERO.       00900011
009100     05  PV-NUM-CHARGE-PCT            PIC 99V9999 VALUE ZERO.     00910015
009200     05  PV-EDIT-KOHLS-FRGHT-PCT      PIC ZZZ.99.                 00920011
009300     05  PV-EDIT-VENDR-FRGHT-PCT      PIC ZZZ.99.                 00930011
009400     05  PV-EDIT-DISCOUNT-DAYS        PIC ZZZ.                    00940011
009500     05  PV-EDIT-DISCOUNT-PCT         PIC ZZ.                     00950011
009600     05  PV-EDIT-DUE-DAYS             PIC ZZZ.                    00960011
009700     05  PV-EDIT-PAYT-TERM-ID         PIC ZZZ.                    00970011
009800     05  PV-EDIT-CHARGE-PCT           PIC Z9.9999.                00980018
009900                                                                  00990011
010000******************************************************************01000011
010100*    SELECTED ITEMS TEMPORARY STORAGE QUEUE ITEM LAYOUT           01010011
010200******************************************************************01020011
010300     COPY VNWS003.                                                01030011
010400                                                                  01040011
010500******************************************************************01050011
010600*    PAYMENT TERMS                                                01060011
010700******************************************************************01070011
010800     COPY POWS020.                                                01080011
010900                                                                  01090011
011000******************************************************************01100011
011100*    BMS MAP                                                      01110011
011200******************************************************************01120011
011300     COPY VNKM013.                                                01130011
011400                                                                  01140011
011500******************************************************************01150011
011600*    BMS ATTRIBUTES                                               01160011
011700******************************************************************01170011
011800     COPY DPWS015.                                                01180011
011900                                                                  01190011
012000******************************************************************01200011
012100*    FUNCTION KEYS                                                01210011
012200******************************************************************01220011
012300     COPY DPWS016.                                                01230011
012400                                                                  01240011
012500***************************************************************** 01250011
012600*    PARAMETERS FOR CALLING CICS ARCHITECTURE API                 01260019
012700***************************************************************** 01270011
012800     COPY DPWS030.                                                01280011
012800     COPY DPWS930.                                                01281019
012900                                                                  01290011
013000***************************************************************** 01300011
013100*    GLOBAL COMMUNICATION AREA                                    01310011
013200***************************************************************** 01320011
013300     COPY DPWS020.                                                01330011
013400     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                01340011
013500                                                                  01350011
013600***************************************************************** 01360011
013700*    INTER-APPLICATION COMMUNICATION AREA                         01370011
013800***************************************************************** 01380011
013900         10  INTER-APPL-COMM-AREA PIC X(200).                     01390011
014000     COPY VNWS001.                                                01400011
014100     COPY VNWS002.                                                01410011
014200                                                                  01420011
014300***************************************************************** 01430011
014400*    APPLICATION SPECIFIC COMMUNICATION AREA                      01440011
014500***************************************************************** 01450011
014600         10  ASC-SPECIFIC-COMMAREA.                               01460011
014700             15  ASC-INT-APPL-FORMAT-IND        PIC X.            01470011
014800             15  ASC-USE-SELECTION-QUEUE-IND                      01480011
014900                                                PIC X.            01490011
015000                 88  ASC-USE-SELECTION-QUEUE         VALUE 'Y'.   01500011
015100             15  ASC-SEL-QUEUE-NAME             PIC X(8).         01510011
015200             15  ASC-NUMBER-OF-TS-ITEMS         PIC S9(5) COMP-3. 01520011
015300             15  ASC-NUMBER-OF-SELECTED-ITEMS                     01530011
015400                                                PIC S9(9) COMP-3. 01540011
015500             15  ASC-SEL-SUB                    PIC S9(4) COMP.   01550011
015600             15  ASC-SEL-ITEM                   PIC S9(4) COMP.   01560011
015700             15  ASC-KEY-FIELDS.                                  01570011
015800                 20  ASC-DEPARTMENT             PIC XXX.          01580011
015900                 20  ASC-ENT-ID                 PIC S9(9) COMP.   01590011
016000             15  ASC-SCREEN-FIELDS.                               01600011
016100                 20  ASC-INHOUSE-NBR            PIC XXX.          01610011
016200                 20  ASC-ENT-NAME-DESC          PIC X(30).        01620011
016300                 20  ASC-DUN-NBR                PIC X(9).         01630011
016400                 20  ASC-PAYT-TERM-ID           PIC S9(4) COMP.   01640011
016500                 20  ASC-PAYT-TERM-ID-DESC      PIC X(28).        01650011
016600                 20  ASC-FOB-POINT-TXT          PIC X(20).        01660011
016700                 20  ASC-SHIPT-POINT-TXT        PIC X(20).        01670011
016800                 20  ASC-FRGT-PAYT-CDE          PIC X.            01680011
016900                 20  ASC-FRGT-TERM-ID           PIC ZZ9.          01690011
017000                 20  ASC-KOHLS-FRGT-PCT         PIC 9(3)V99.      01700011
017100                 20  ASC-VEND-FRGT-PCT          PIC 9(3)V99.      01710011
017200                 20  ASC-RTV-RA-REQD-IND        PIC X.            01720011
017300                 20  ASC-RTV-NO-RA-REQD-IND     PIC X.            01730011
017400                 20  ASC-DEBIT-DESTROY-IND      PIC X.            01740011
017500                 20  ASC-MARKOUT-IND            PIC X.            01750011
017600                 20  ASC-VND-AUTH-ID            PIC X(10).        01760011
017700                 20  ASC-LATE-SHIPMENT-IND      PIC X.            01770011
017800                 20  ASC-CHARGE-PCT             PIC V9(6).        01780014
017900                 20  ASC-CHARGE-FACTOR-CDE      PIC X.            01790011
018000                                                                  01800011
018100******************************************************************01810011
018200*    ABEND PROCESSING                                             01820011
018300******************************************************************01830011
018400     COPY DPWS013.                                                01840011
018500                                                                  01850011
018600******************************************************************01860011
018700*    DB2 SQL COMMUNICATION AREA                                   01870011
018800******************************************************************01880011
018900     EXEC SQL                                                     01890011
019000          INCLUDE SQLCA                                           01900011
019100     END-EXEC.                                                    01910011
019200                                                                  01920011
019300******************************************************************01930011
019400*    DB2 DCLGEN FOR VENDOR DEPARTMENT TABLE                       01940011
019500******************************************************************01950011
019600     EXEC SQL                                                     01960011
019700          INCLUDE TVNDDPT                                         01970011
019800     END-EXEC.                                                    01980011
019900                                                                  01990011
020000******************************************************************02000011
020100*    DB2 DCLGEN FOR VENDOR EXTERNAL ENTERPRISE TABLE              02010011
020200******************************************************************02020011
020300     EXEC SQL                                                     02030011
020400          INCLUDE TEXTENT                                         02040011
020500     END-EXEC.                                                    02050011
020600                                                                  02060011
020700******************************************************************02070011
020800*    DB2 DCLGEN FOR VENDOR EXTERNAL ENTERPRISE NAME TABLE         02080011
020900******************************************************************02090011
021000     EXEC SQL                                                     02100011
021100          INCLUDE TENTNME                                         02110011
021200     END-EXEC.                                                    02120011
021300                                                                  02130011
021400******************************************************************02140011
021500*    DB2 DCLGEN FOR VENDOR AGREEMENT TABLE                        02150011
021600******************************************************************02160011
021700     EXEC SQL                                                     02170011
021800          INCLUDE TVNDAGR                                         02180011
021900     END-EXEC.                                                    02190011
022000                                                                  02200011
022100******************************************************************02210011
022200*    DB2 DCLGEN FOR FREIGHT TERMS TABLE                           02220011
022300******************************************************************02230011
022400     EXEC SQL                                                     02240011
022500          INCLUDE TFRGTRM                                         02250011
022600     END-EXEC.                                                    02260011
022700                                                                  02270011
022800******************************************************************02280011
022900*    DB2 DCLGEN FOR VENDOR PAYMENT TERMS TABLE                    02290011
023000******************************************************************02300011
023100     EXEC SQL                                                     02310011
023200          INCLUDE TPAYTRM                                         02320011
023300     END-EXEC.                                                    02330011
023400                                                                  02340011
023500 LINKAGE SECTION.                                                 02350011
023600                                                                  02360011
023700 01  DFHCOMMAREA.                                                 02370011
023800     05  FILLER                       OCCURS 1 TO 4072 TIMES      02380011
023900                                      DEPENDING ON EIBCALEN.      02390011
024000         10  FILLER                   PIC  X.                     02400011
024100                                                                  02410011
024200 PROCEDURE DIVISION.                                              02420011
024300******************************************************************02430011
024400*    CALL CICS ARCHITECTURE APPLICATION PROGRAM INTERFACE.        02440011
024500*                                                                 02450011
024600*    PERFORM PROGRAM LOGIC.                                       02460011
024700*                                                                 02470011
024800*    CALL CICS ARCHITECTURE APPLICATION PROGRAM INTERFACE.        02480011
024900******************************************************************02490011
025000 0000-MAIN-MODULE.                                                02500011
025100                                                                  02510011
025200     INITIALIZE DP030-CICS-API-FIELDS.                            02520011
025300     MOVE +1                     TO DP030-NUMBER-OF-MAPS.         02530011
025400     MOVE PC-CURRENT-MAPSET-NAME TO DP030-MAPSET-NAME.            02540011
025500     MOVE PC-CURRENT-MAP-NAME    TO DP030-MAP-NAME (1).           02550011
025600     SET DP030-RECEIVE-APPL-MAP  TO TRUE.                         02560011
025700     MOVE LENGTH OF VN013AI      TO DP030-MAP-LENGTH (1).         02570011
025800     MOVE 'PROGRAM ENTRY CALL'   TO DP013-MESSAGE-TEXT (1).       02580011
025900                                                                  02590011
026000     PERFORM 0001-CALL-CICS-ARCH-API.                             02600011
026100                                                                  02610011
026200     PERFORM 1000-CONTROL-PROCESSING.                             02620011
026300                                                                  02630011
026400     MOVE 'PROGRAM EXIT CALL' TO DP013-MESSAGE-TEXT (1).          02640011
026500                                                                  02650011
026600     PERFORM 0001-CALL-CICS-ARCH-API.                             02660011
026700                                                                  02670011
026800 0001-CALL-CICS-ARCH-API.                                         02680011
026900                                                                  02690011
027000*    CALL 'DPKCS030' USING DFHEIBLK                               02700019
027000     CALL DP930-CICS-ARCH-API USING DFHEIBLK                      02701019
027100                           DFHCOMMAREA                            02710011
027200                           DP030-CICS-API-FIELDS                  02720011
027300                           DP020-STANDARD-COMMAREA                02730011
027400                           VN013AI.                               02740011
027500                                                                  02750011
027600     IF NOT DP030-RC-CALL-SUCCESSFUL                              02760011
027700         SET DP013-CICS-ABEND                                     02770011
027800             DP013-NO-ROLLBACK                                    02780011
027900             DP013-XCTL-DISPLAY-RESTART TO TRUE                   02790011
028000         MOVE '0001-CALL-CICS-ARCH-API' TO DP013-PARAGRAPH        02800011
028100*        MOVE 'UNSUCCESSFUL CALL TO DPKCS030, RETURN-CODE ON NEXT 02810019
028200*             'LINE'            TO DP013-MESSAGE-TEXT (2)         02820019
028100         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O02821020
028200-             'N NEXT LINE'     TO DP013-MESSAGE-TEXT (2)         02822020
028300         MOVE DP030-RETURN-CODE TO DP013-MESSAGE-TEXT (3)         02830011
028400                                                                  02840011
028500         PERFORM DP013-0000-PROCESS-ABEND                         02850011
028600     END-IF.                                                      02860011
028700                                                                  02870011
028800******************************************************************02880011
028900*    EXECUTE APPROPRIATE LOGIC BASED ON ACTION TO BE PERFORMED    02890011
029000******************************************************************02900011
029100 1000-CONTROL-PROCESSING.                                         02910011
029200                                                                  02920011
029300     EVALUATE TRUE                                                02930011
029400                                                                  02940011
029500         WHEN DP020-NEXT-ACT-INITIAL                              02950011
029600              SET PS-NO-ERROR TO TRUE                             02960011
029700                                                                  02970011
029800              PERFORM 1100-PROCESS-INTER-APPL-COMM                02980011
029900                                                                  02990011
030000              IF PS-NO-ERROR                                      03000011
030100                                                                  03010011
030200                  PERFORM 4000-BUILD-INITIAL-PANEL                03020011
030300              END-IF                                              03030011
030400                                                                  03040011
030500                                                                  03050011
030600         WHEN DP020-NEXT-ACT-READ-MAP                             03060011
030700                                                                  03070011
030800              PERFORM 2000-PROCESS-PANEL                          03080011
030900                                                                  03090011
031000                                                                  03100011
031100         WHEN DP020-NEXT-ACT-RETURN                               03110011
031200                                                                  03120011
031300              PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                03130011
031400                                                                  03140011
031500                                                                  03150011
031600         WHEN OTHER                                               03160011
031700              SET DP013-LOGIC-ABEND                               03170011
031800                  DP013-NO-ROLLBACK TO TRUE                       03180011
031900              MOVE '1000-CONTROL-PROCESSING' TO DP013-PARAGRAPH   03190011
032000              MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED' TO03200011
032100                                             DP013-MESSAGE-TEXT(1)03210011
032200              MOVE DP020-NEXT-APPL-ACTIVITY TO                    03220011
032300                                             DP013-MESSAGE-TEXT(2)03230011
032400              PERFORM DP013-0000-PROCESS-ABEND                    03240011
032500                                                                  03250011
032600     END-EVALUATE.                                                03260011
032700                                                                  03270011
032800 1100-PROCESS-INTER-APPL-COMM.                                    03280011
032900                                                                  03290011
033000     INITIALIZE ASC-SPECIFIC-COMMAREA.                            03300011
033100     MOVE DP020-INT-APPL-FORMAT-IND TO ASC-INT-APPL-FORMAT-IND.   03310011
033200                                                                  03320011
033300******************************************************************03330011
033400*   DEPENDING ON WHICH FIELD(S) WERE ENTERED / MISSING ON THE     03340011
033500*   CRITERIA SPEC. SCREEN, SEND THE APPROPRIATE ERROR MESSAGE     03350011
033600******************************************************************03360011
033700     EVALUATE DP020-INT-APPL-FORMAT-IND                           03370011
033800         WHEN PC-INTER-APPL-CRIT-SPEC                             03380011
033900              IF (VN001-VENDOR-NAME       = SPACES AND            03390011
034000                  VN001-DEPARTMENT-NUMBER = SPACES AND            03400011
034100                  VN001-INHOUSE-NUMBER    = SPACES) OR            03410011
034200                 (VN001-DEPARTMENT-NUMBER > SPACES AND            03420011
034300                 (VN001-VENDOR-NAME       = SPACES AND            03430011
034400                  VN001-INHOUSE-NUMBER    = SPACES))              03440011
034500                   SET PS-ERROR                                   03450011
034600                       DP030-OVERRIDE-GO                          03460011
034700                       DP020-MSG-FATAL                            03470011
034800                       DP020-NEXT-ACT-APPL-ERROR TO TRUE          03480011
034900                   MOVE PC-TSYMSG-00488 TO DP020-MSG-NUMBER       03490011
035000              ELSE                                                03500011
035100                  PERFORM 1110-FORMAT-KEYS                        03510011
035200                  PERFORM 1120-GET-ENTERPRISE-ID                  03520011
035300              END-IF                                              03530011
035400                                                                  03540011
035500                                                                  03550011
035600         WHEN PC-INTER-APPL-LIST                                  03560011
035700              IF VN002-NUMBER-OF-SELECTED-ITEMS = ZERO            03570011
035800                  SET PS-ERROR                                    03580011
035900                      DP030-OVERRIDE-GO                           03590011
036000                      DP020-MSG-WARNING                           03600011
036100                      DP020-NEXT-ACT-APPL-ERROR TO TRUE           03610011
036200                  MOVE PC-TSYMSG-00057 TO DP020-MSG-NUMBER        03620011
036300              ELSE                                                03630011
036400                  SET ASC-USE-SELECTION-QUEUE TO TRUE             03640011
036500                  MOVE VN002-NUMBER-OF-SELECTED-ITEMS TO          03650011
036600                                      ASC-NUMBER-OF-SELECTED-ITEMS03660011
036700                  MOVE VN002-NUMBER-OF-TS-ITEMS TO                03670011
036800                                            ASC-NUMBER-OF-TS-ITEMS03680011
036900                  MOVE VN002-SEL-QUEUE-NAME TO ASC-SEL-QUEUE-NAME 03690011
037000                  MOVE VN003-MAX-ITEMS      TO ASC-SEL-SUB        03700011
037100                  MOVE ZERO                 TO ASC-SEL-ITEM       03710011
037200                                                                  03720011
037300                  PERFORM 2010-GET-NEXT-VENDOR                    03730011
037400              END-IF                                              03740011
037500                                                                  03750011
037600                                                                  03760011
037700         WHEN OTHER                                               03770011
037800              SET PS-ERROR                                        03780011
037900                  DP030-OVERRIDE-GO                               03790011
038000                  DP020-MSG-FATAL                                 03800011
038100                  DP020-NEXT-ACT-APPL-ERROR TO TRUE               03810011
038200              MOVE PC-TSYMSG-00488 TO DP020-MSG-NUMBER            03820011
038300     END-EVALUATE.                                                03830011
038400                                                                  03840011
038500******************************************************************03850011
038600*   DEPENDING ON WHICH FIELD(S) WERE ENTERED ON THE CRITERIA SPEC.03860011
038700*   SCREEN, FORMAT THE KEYS NEEDED TO RETRIEVE THE DESIRED INFO.  03870011
038800******************************************************************03880011
038900 1110-FORMAT-KEYS.                                                03890011
039000                                                                  03900011
039100     MOVE VN001-DEPARTMENT-NUMBER   TO PV-DEPT-NBR.               03910011
039200                                                                  03920011
039300     IF VN001-INHOUSE-NUMBER > SPACES                             03930011
039400         MOVE VN001-INHOUSE-NUMBER  TO PV-INHOUSE-NBR-X           03940011
039500         MOVE PV-INHOUSE-NBR        TO PV-INHOUSE-NBR-LOW         03950011
039600                                       PV-INHOUSE-NBR-HIGH        03960011
039700         MOVE LOW-VALUES            TO PV-VENDOR-NAME-LOW         03970011
039800         MOVE HIGH-VALUES           TO PV-VENDOR-NAME-HIGH        03980011
039900     ELSE                                                         03990011
040000         MOVE ZERO                  TO PV-INHOUSE-NBR-LOW         04000011
040100         MOVE +999                  TO PV-INHOUSE-NBR-HIGH        04010011
040200         IF VN001-VENDOR-NAME > SPACES                            04020011
040300             MOVE VN001-VENDOR-NAME TO PV-VENDOR-NAME-LOW         04030011
040400                                       PV-VENDOR-NAME-HIGH        04040011
040500         ELSE                                                     04050011
040600             MOVE LOW-VALUES        TO PV-VENDOR-NAME-LOW         04060011
040700             MOVE HIGH-VALUES       TO PV-VENDOR-NAME-HIGH        04070011
040800         END-IF                                                   04080011
040900     END-IF.                                                      04090011
041000                                                                  04100011
041100 1120-GET-ENTERPRISE-ID.                                          04110011
041200                                                                  04120011
041300     PERFORM WITH TEST AFTER                                      04130011
041400             VARYING PV-RETRY-COUNTER  FROM 1 BY 1                04140011
041500             UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES OR         04150011
041600                     SQLCODE = ZERO OR                            04160011
041700                     SQLCODE = +100                               04170011
041800                                                                  04180011
041900     EXEC SQL                                                     04190011
042000          SELECT DISTINCT A.ENT_ID                                04200011
042100            INTO :VNDDPT-ENT-ID                                   04210011
042200            FROM TVNDDPT A                                        04220011
042300                ,TENTNME B                                        04230011
042400           WHERE A.ENT_ID    = B.ENT_ID                           04240011
042500             AND A.DEPT_NBR  = :PV-DEPT-NBR                       04250011
042600             AND A.INHOUSE_NBR BETWEEN :PV-INHOUSE-NBR-LOW        04260011
042700                                   AND :PV-INHOUSE-NBR-HIGH       04270011
042800             AND B.ENT_NAME_DESC BETWEEN :PV-VENDOR-NAME-LOW      04280011
042900                                     AND :PV-VENDOR-NAME-HIGH     04290011
043000     END-EXEC                                                     04300011
043100                                                                  04310011
043200     EVALUATE TRUE                                                04320011
043300         WHEN SQLCODE = ZERO                                      04330011
043400         WHEN SQLCODE = +100                                      04340011
043500         WHEN SQLCODE = -904                                      04350011
043600         WHEN SQLCODE = -913                                      04360011
043700              CONTINUE                                            04370011
043800                                                                  04380011
043900         WHEN SQLWARN0 NOT = SPACES                               04390011
044000         WHEN SQLCODE  NOT = ZERO                                 04400011
044100              MOVE '1120-GET-ENTERPRISE-ID' TO DP013-PARAGRAPH    04410011
044200              MOVE 'UNSUCCESSFUL SELECT ENTERPRISE ID' TO         04420011
044300                                            DP013-MESSAGE-TEXT (1)04430011
044400              MOVE SQLCA TO DP013-SQLCA                           04440011
044500              MOVE 'TVNDDPT ' TO DP013-DB2-TABLE-NAME (1)         04450011
044600              MOVE 'TENTNME ' TO DP013-DB2-TABLE-NAME (2)         04460011
044700              SET DP013-DB2-ABEND                                 04470011
044800                  DP013-XCTL-DISPLAY-RESTART TO TRUE              04480011
044900                                                                  04490011
045000              PERFORM DP013-0000-PROCESS-ABEND                    04500011
045100     END-EVALUATE                                                 04510011
045200     END-PERFORM.                                                 04520011
045300                                                                  04530011
045400     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         04540011
045500         MOVE '1120-GET-ENTERPRISE-ID' TO DP013-PARAGRAPH         04550011
045600         MOVE 'MAX RETRIES EXCEEDED ON SELECT ENTERPRISE ID' TO   04560011
045700                                            DP013-MESSAGE-TEXT (1)04570011
045800         MOVE SQLCA      TO DP013-SQLCA                           04580011
045900         MOVE 'TVNDDPT ' TO DP013-DB2-TABLE-NAME (1)              04590011
046000         MOVE 'TENTNME ' TO DP013-DB2-TABLE-NAME (2)              04600011
046100         SET DP013-DB2-ABEND                                      04610011
046200             DP013-XCTL-DISPLAY-RESTART TO TRUE                   04620011
046300                                                                  04630011
046400         PERFORM DP013-0000-PROCESS-ABEND                         04640011
046500     END-IF.                                                      04650011
046600                                                                  04660011
046700     IF SQLCODE = ZERO                                            04670011
046800         MOVE PV-DEPT-NBR   TO ASC-DEPARTMENT                     04680011
046900         MOVE VNDDPT-ENT-ID TO ASC-ENT-ID                         04690011
047000     END-IF.                                                      04700011
047100                                                                  04710011
047200     IF SQLCODE = +100                                            04720011
047300         SET PS-ERROR                                             04730011
047400             DP020-MSG-FATAL                                      04740011
047500             DP020-NEXT-ACT-APPL-ERROR TO TRUE                    04750011
047600         IF VN001-INHOUSE-NUMBER > SPACES                         04760011
047700             MOVE PC-TSYMSG-00156 TO DP020-MSG-NUMBER             04770011
047800         ELSE                                                     04780011
047900             IF VN001-VENDOR-NAME > SPACES                        04790011
048000                 MOVE PC-TSYMSG-00489 TO DP020-MSG-NUMBER         04800011
048100             END-IF                                               04810011
048200         END-IF                                                   04820011
048300     END-IF.                                                      04830011
048400                                                                  04840011
048500******************************************************************04850011
048600*    PROCESS FUNCTION KEYS THAT DON'T REQUIRE DATA TO BE EDITED.  04860011
048700*    IF ONE OF THESE KEYS ISN'T USED, PERFORM DATA EDITS AND      04870011
048800*    PROCESS FUNCTION KEYS THAT REQUIRE DATA TO BE EDITED.        04880011
048900******************************************************************04890011
049000 2000-PROCESS-PANEL.                                              04900011
049100                                                                  04910011
049200     EVALUATE TRUE                                                04920011
049300         WHEN DP020-SRC-AID = DP016-CLEAR                         04930011
049400                                                                  04940011
049500              PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                04950011
049600                                                                  04960011
049700                                                                  04970011
049800         WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    04980011
049900                                                                  04990011
050000              PERFORM 4000-BUILD-INITIAL-PANEL                    05000011
050100                                                                  05010011
050200                                                                  05020011
050300         WHEN DP020-FK-NEXT-SELECTION (DP020-SRC-AID)             05030011
050400              IF ASC-USE-SELECTION-QUEUE                          05040011
050500                                                                  05050011
050600                  PERFORM 2010-GET-NEXT-VENDOR                    05060011
050700                                                                  05070011
050800                  IF PS-END-OF-LIST                               05080011
050900                      SET PS-NOT-END-OF-LIST TO TRUE              05090011
051000                  ELSE                                            05100011
051100                      PERFORM 4000-BUILD-INITIAL-PANEL            05110011
051200                  END-IF                                          05120011
051300              ELSE                                                05130011
051400                  SET PS-END-OF-LIST                              05140011
051500                      DP020-MSG-INFORMATIONAL TO TRUE             05150011
051600                  MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER        05160011
051700              END-IF                                              05170011
051800                                                                  05180011
051900                                                                  05190011
052000         WHEN DP020-FK-PREV-SELECTION (DP020-SRC-AID)             05200011
052100              IF ASC-USE-SELECTION-QUEUE                          05210011
052200                                                                  05220011
052300                  PERFORM 2020-GET-PREV-VENDOR                    05230011
052400                                                                  05240011
052500                  IF PS-END-OF-LIST                               05250011
052600                      SET PS-NOT-END-OF-LIST TO TRUE              05260011
052700                  ELSE                                            05270011
052800                      PERFORM 4000-BUILD-INITIAL-PANEL            05280011
052900                  END-IF                                          05290011
053000              ELSE                                                05300011
053100                  SET PS-END-OF-LIST                              05310011
053200                      DP020-MSG-INFORMATIONAL TO TRUE             05320011
053300                  MOVE PC-TSYMSG-00069 TO DP020-MSG-NUMBER        05330011
053400              END-IF                                              05340011
053500                                                                  05350011
053600                                                                  05360011
053700         WHEN OTHER                                               05370011
053800                                                                  05380011
053900              PERFORM 2100-CHECK-FUNCTION-KEY                     05390011
054000                                                                  05400011
054100     END-EVALUATE.                                                05410011
054200                                                                  05420011
054300 2010-GET-NEXT-VENDOR.                                            05430011
054400                                                                  05440011
054500     ADD +1 TO ASC-SEL-SUB.                                       05450011
054600                                                                  05460011
054700     IF ASC-SEL-SUB > VN003-MAX-ITEMS                             05470011
054800         ADD  +1 TO ASC-SEL-ITEM                                  05480011
054900         MOVE +1 TO ASC-SEL-SUB                                   05490011
055000     END-IF.                                                      05500011
055100                                                                  05510011
055200     IF ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                 05520011
055300                                                                  05530011
055400         PERFORM 9100-READ-SELECTION-QUEUE                        05540011
055500                                                                  05550011
055600         IF VN003-ITEM (ASC-SEL-SUB) > ZERO                       05560011
055700             MOVE VN003-DEPARTMENT (ASC-SEL-SUB) TO ASC-DEPARTMENT05570011
055800             MOVE VN003-ENT-ID     (ASC-SEL-SUB) TO ASC-ENT-ID    05580011
055900             SET VN003-INQ (ASC-SEL-SUB) TO TRUE                  05590011
056000                                                                  05600011
056100             PERFORM 9200-REWRITE-SELECTION-QUEUE                 05610011
056200                                                                  05620011
056300             INITIALIZE ASC-SCREEN-FIELDS                         05630011
056400         ELSE                                                     05640011
056500             SUBTRACT +1 FROM ASC-SEL-SUB                         05650011
056600             SET PS-END-OF-LIST                                   05660011
056700                 DP020-MSG-INFORMATIONAL TO TRUE                  05670011
056800             MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER             05680011
056900         END-IF                                                   05690011
057000     ELSE                                                         05700011
057100         SUBTRACT +1 FROM ASC-SEL-ITEM                            05710011
057200         MOVE VN003-MAX-ITEMS TO ASC-SEL-SUB                      05720011
057300         SET PS-END-OF-LIST                                       05730011
057400             DP020-MSG-INFORMATIONAL TO TRUE                      05740011
057500         MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER                 05750011
057600     END-IF.                                                      05760011
057700                                                                  05770011
057800 2020-GET-PREV-VENDOR.                                            05780011
057900                                                                  05790011
058000     SUBTRACT +1 FROM ASC-SEL-SUB.                                05800011
058100     IF ASC-SEL-SUB < +1                                          05810011
058200         SUBTRACT +1 FROM ASC-SEL-ITEM                            05820011
058300         MOVE VN003-MAX-ITEMS TO ASC-SEL-SUB                      05830011
058400     END-IF.                                                      05840011
058500                                                                  05850011
058600     IF ASC-SEL-ITEM > ZERO                                       05860011
058700                                                                  05870011
058800         PERFORM 9100-READ-SELECTION-QUEUE                        05880011
058900                                                                  05890011
059000         IF VN003-DEPARTMENT (ASC-SEL-SUB) > SPACES AND           05900011
059100            VN003-ENT-ID     (ASC-SEL-SUB) > ZERO                 05910011
059200             MOVE VN003-DEPARTMENT (ASC-SEL-SUB) TO ASC-DEPARTMENT05920011
059300             MOVE VN003-ENT-ID     (ASC-SEL-SUB) TO ASC-ENT-ID    05930011
059400         END-IF                                                   05940011
059500         INITIALIZE ASC-SCREEN-FIELDS                             05950011
059600     ELSE                                                         05960011
059700         MOVE +1 TO ASC-SEL-ITEM                                  05970011
059800                    ASC-SEL-SUB                                   05980011
059900         SET PS-END-OF-LIST                                       05990011
060000             DP020-MSG-INFORMATIONAL TO TRUE                      06000011
060100             MOVE PC-TSYMSG-00069 TO DP020-MSG-NUMBER             06010011
060200     END-IF.                                                      06020011
060300                                                                  06030011
060400******************************************************************06040011
060500*    PROCESS FUNCTION KEYS THAT REQUIRE DATA TO BE EDITED         06050011
060600******************************************************************06060011
060700 2100-CHECK-FUNCTION-KEY.                                         06070011
060800                                                                  06080011
060900     EVALUATE TRUE                                                06090011
061000         WHEN DP020-FK-LOCAL-GOTO (DP020-SRC-AID)                 06100011
061100              MOVE ASC-DEPARTMENT    TO VN001-DEPARTMENT-NUMBER   06110011
061200              MOVE ASC-INHOUSE-NBR   TO VN001-INHOUSE-NUMBER      06120011
061300              MOVE ASC-ENT-NAME-DESC TO VN001-VENDOR-NAME         06130011
061400                                                                  06140011
061500                                                                  06150011
061600         WHEN DP020-SRC-AID = DP016-ENTER                         06160011
061700              CONTINUE                                            06170011
061800                                                                  06180011
061900                                                                  06190011
062000         WHEN OTHER                                               06200011
062100              SET DP013-CICS-ABEND                                06210011
062200                  DP013-NO-ROLLBACK                               06220011
062300                  DP013-XCTL-DISPLAY-RESTART TO TRUE              06230011
062400              MOVE '2100-CHECK-FUNCTION-KEY' TO DP013-PARAGRAPH   06240011
062500              MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API' TO  06250011
062600                                            DP013-MESSAGE-TEXT (1)06260011
062700              PERFORM DP013-0000-PROCESS-ABEND                    06270011
062800                                                                  06280011
062900     END-EVALUATE.                                                06290011
063000                                                                  06300011
063100 4000-BUILD-INITIAL-PANEL.                                        06310011
063200                                                                  06320011
063300     SET PS-NO-ERROR                                              06330011
063400         DP030-SET-CURSOR-TRAILER TO TRUE.                        06340011
063500                                                                  06350011
063600     PERFORM 4010-GET-HEADING-INFO.                               06360011
063700                                                                  06370011
063800     PERFORM 4020-GET-PAYT-TERM-ID.                               06380011
063900                                                                  06390011
064000     PERFORM 4030-GET-PAYMENT-TERMS.                              06400011
064100                                                                  06410011
064200     PERFORM 4040-GET-SHIPPING-TERMS.                             06420011
064300                                                                  06430011
064400     PERFORM 4050-GET-PURCHASE-TERMS.                             06440011
064500                                                                  06450011
064600     IF PS-NO-ERROR                                               06460011
064700         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                    06470011
064800                                                                  06480011
064900 4010-GET-HEADING-INFO.                                           06490011
065000                                                                  06500011
065100     PERFORM WITH TEST AFTER                                      06510011
065200             VARYING PV-RETRY-COUNTER  FROM 1 BY 1                06520011
065300             UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES OR         06530011
065400                     SQLCODE = ZERO OR                            06540011
065500                     SQLCODE = +100                               06550011
065600                                                                  06560011
065700     EXEC SQL                                                     06570011
065800          SELECT A.INHOUSE_NBR                                    06580011
065900                ,B.ENT_NAME_DESC                                  06590011
066000                ,C.DUN_NBR                                        06600011
066100            INTO :VNDDPT-INHOUSE-NBR                              06610011
066200                ,:ENTNME-ENT-NAME-DESC                            06620011
066300                ,:EXTENT-DUN-NBR                                  06630011
066400                 :NI-EXTENT-DUN-NBR                               06640011
066500            FROM TVNDDPT A, TENTNME B, TEXTENT C                  06650011
066600           WHERE A.ENT_ID   = :ASC-ENT-ID                         06660011
066700             AND A.DEPT_NBR = :ASC-DEPARTMENT                     06670011
066800             AND A.ENT_ID   = B.ENT_ID                            06680011
066900             AND B.SEQ_NBR  =                                     06690011
067000                 (SELECT MAX(SEQ_NBR)                             06700011
067100                    FROM TENTNME                                  06710011
067200                   WHERE ENT_ID   = :ASC-ENT-ID                   06720011
067300                     AND TYPE_CDE = :PC-PRIMARY)                  06730011
067400             AND B.TYPE_CDE = :PC-PRIMARY                         06740011
067500             AND A.ENT_ID   = C.ENT_ID                            06750011
067600     END-EXEC                                                     06760011
067700                                                                  06770011
067800     EVALUATE TRUE                                                06780011
067900         WHEN SQLCODE = ZERO                                      06790011
068000         WHEN SQLCODE = -904                                      06800011
068100         WHEN SQLCODE = -913                                      06810011
068200              CONTINUE                                            06820011
068300                                                                  06830011
068400         WHEN SQLWARN0 NOT = SPACES                               06840011
068500         WHEN SQLCODE  NOT = ZERO                                 06850011
068600              MOVE '4010-GET-HEADING-INFO' TO DP013-PARAGRAPH     06860011
068700              MOVE 'UNSUCCESSFUL SELECT HEADING INFO' TO          06870011
068800                                            DP013-MESSAGE-TEXT (1)06880011
068900              MOVE SQLCA TO DP013-SQLCA                           06890011
069000              MOVE 'TVNDDPT ' TO DP013-DB2-TABLE-NAME (1)         06900011
069100              MOVE 'TENTNME ' TO DP013-DB2-TABLE-NAME (2)         06910011
069200              MOVE 'TEXTENT ' TO DP013-DB2-TABLE-NAME (3)         06920011
069300              SET DP013-DB2-ABEND                                 06930011
069400                  DP013-XCTL-DISPLAY-RESTART TO TRUE              06940011
069500                                                                  06950011
069600              PERFORM DP013-0000-PROCESS-ABEND                    06960011
069700     END-EVALUATE                                                 06970011
069800     END-PERFORM.                                                 06980011
069900                                                                  06990011
070000     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         07000011
070100         MOVE '4010-GET-HEADING-INFO' TO DP013-PARAGRAPH          07010011
070200         MOVE 'MAX RETRIES EXCEEDED ON SELECT HEADING INFO' TO    07020011
070300                                            DP013-MESSAGE-TEXT (1)07030011
070400         MOVE SQLCA      TO DP013-SQLCA                           07040011
070500         MOVE 'TEXTENT ' TO DP013-DB2-TABLE-NAME (1)              07050011
070600         MOVE 'TENTNME ' TO DP013-DB2-TABLE-NAME (2)              07060011
070700         SET DP013-DB2-ABEND                                      07070011
070800             DP013-XCTL-DISPLAY-RESTART TO TRUE                   07080011
070900                                                                  07090011
071000         PERFORM DP013-0000-PROCESS-ABEND                         07100011
071100     END-IF.                                                      07110011
071200                                                                  07120011
071300     IF SQLCODE = ZERO                                            07130011
071400         MOVE VNDDPT-INHOUSE-NBR   TO ASC-INHOUSE-NBR             07140011
071500         MOVE ENTNME-ENT-NAME-DESC TO ASC-ENT-NAME-DESC           07150011
071600         IF NI-EXTENT-DUN-NBR = -1                                07160011
071700             MOVE SPACES           TO ASC-DUN-NBR                 07170011
071800         ELSE                                                     07180011
071900             MOVE EXTENT-DUN-NBR   TO ASC-DUN-NBR                 07190011
072000         END-IF                                                   07200011
072100     END-IF.                                                      07210011
072200                                                                  07220011
072300 4020-GET-PAYT-TERM-ID.                                           07230011
072400                                                                  07240011
072500     PERFORM WITH TEST AFTER                                      07250011
072600             VARYING PV-RETRY-COUNTER  FROM 1 BY 1                07260011
072700             UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES OR         07270011
072800                     SQLCODE = ZERO OR                            07280011
072900                     SQLCODE = +100                               07290011
073000                                                                  07300011
073100     EXEC SQL                                                     07310011
073200          SELECT PAYT_TERM_ID                                     07320011
073300            INTO :VNDAGR-PAYT-TERM-ID                             07330011
073400                 :NI-VNDAGR-PAYT-TERM-ID                          07340011
073500            FROM TVNDAGR                                          07350011
073600           WHERE ENT_ID            = :ASC-ENT-ID                  07360011
073700             AND DEPT_NBR          = :ASC-DEPARTMENT              07370011
073800             AND AGRMT_TYP_ID      = :PC-PAYMENT                  07380011
073900             AND SEQ_NBR           =                              07390011
074000                 (SELECT MAX(SEQ_NBR)                             07400011
074100                    FROM TVNDAGR                                  07410011
074200                   WHERE ENT_ID            = :ASC-ENT-ID          07420011
074300                     AND DEPT_NBR          = :ASC-DEPARTMENT      07430011
074400                     AND AGRMT_TYP_ID      = :PC-PAYMENT)         07440011
074500     END-EXEC                                                     07450011
074600                                                                  07460011
074700     EVALUATE TRUE                                                07470011
074800         WHEN SQLCODE = ZERO                                      07480011
074900         WHEN SQLCODE = +100                                      07490011
075000         WHEN SQLCODE = -904                                      07500011
075100         WHEN SQLCODE = -913                                      07510011
075200              CONTINUE                                            07520011
075300                                                                  07530011
075400         WHEN SQLWARN0 NOT = SPACES                               07540011
075500         WHEN SQLCODE  NOT = ZERO                                 07550011
075600              MOVE '4020-GET-PAYT-TERM-ID' TO DP013-PARAGRAPH     07560011
075700              MOVE 'UNSUCCESSFUL SELECT PAY TERM ID' TO           07570011
075800                                            DP013-MESSAGE-TEXT (1)07580011
075900              MOVE SQLCA TO DP013-SQLCA                           07590011
076000              MOVE 'TVNDAGR ' TO DP013-DB2-TABLE-NAME (1)         07600011
076100              SET DP013-DB2-ABEND                                 07610011
076200                  DP013-XCTL-DISPLAY-RESTART TO TRUE              07620011
076300                                                                  07630011
076400              PERFORM DP013-0000-PROCESS-ABEND                    07640011
076500     END-EVALUATE                                                 07650011
076600     END-PERFORM.                                                 07660011
076700                                                                  07670011
076800     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         07680011
076900         MOVE '4020-GET-PAYT-TERM-ID' TO DP013-PARAGRAPH          07690011
077000         MOVE 'MAX RETRIES EXCEEDED ON SELECT PAY TERM ID' TO     07700011
077100                                            DP013-MESSAGE-TEXT (1)07710011
077200         MOVE SQLCA      TO DP013-SQLCA                           07720011
077300         MOVE 'TVNDAGR ' TO DP013-DB2-TABLE-NAME (1)              07730011
077400         SET DP013-DB2-ABEND                                      07740011
077500             DP013-XCTL-DISPLAY-RESTART TO TRUE                   07750011
077600                                                                  07760011
077700         PERFORM DP013-0000-PROCESS-ABEND                         07770011
077800     END-IF.                                                      07780011
077900                                                                  07790011
078000     IF SQLCODE = ZERO                                            07800011
078100        IF NI-VNDAGR-PAYT-TERM-ID = -1                            07810011
078200            MOVE ZERO               TO ASC-PAYT-TERM-ID           07820011
078300        ELSE                                                      07830011
078400            MOVE VNDAGR-PAYT-TERM-ID TO ASC-PAYT-TERM-ID          07840011
078500        END-IF                                                    07850011
078600     END-IF.                                                      07860011
078700                                                                  07870011
078800 4030-GET-PAYMENT-TERMS.                                          07880011
078900                                                                  07890011
079000     PERFORM WITH TEST AFTER                                      07900011
079100             VARYING PV-RETRY-COUNTER  FROM 1 BY 1                07910011
079200             UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES OR         07920011
079300                     SQLCODE = ZERO OR                            07930011
079400                     SQLCODE = +100                               07940011
079500                                                                  07950011
079600     EXEC SQL                                                     07960011
079700          SELECT DISCOUNT_DAYS_QTY                                07970011
079800                ,DISCOUNT_PCT                                     07980011
079900                ,DUE_DAY_QTY                                      07990011
080000                ,DUE_DAY_FR_DTE_TXT                               08000011
080100                ,OTHER_TXT                                        08010011
080200            INTO :PAYTRM-DISCOUNT-DAYS-QTY                        08020011
080300                ,:PAYTRM-DISCOUNT-PCT                             08030011
080400                ,:PAYTRM-DUE-DAY-QTY                              08040011
080500                ,:PAYTRM-DUE-DAY-FR-DTE-TXT                       08050011
080600                ,:PAYTRM-OTHER-TXT                                08060011
080700            FROM TPAYTRM                                          08070011
080800           WHERE PAY_TERM_ID = :ASC-PAYT-TERM-ID                  08080011
080900     END-EXEC                                                     08090011
081000                                                                  08100011
081100     EVALUATE TRUE                                                08110011
081200         WHEN SQLCODE = ZERO                                      08120011
081300         WHEN SQLCODE = +100                                      08130011
081400         WHEN SQLCODE = -904                                      08140011
081500         WHEN SQLCODE = -913                                      08150011
081600              CONTINUE                                            08160011
081700                                                                  08170011
081800         WHEN SQLWARN0 NOT = SPACES                               08180011
081900         WHEN SQLCODE  NOT = ZERO                                 08190011
082000              MOVE '4030-GET-PAYMENT-TERMS' TO DP013-PARAGRAPH    08200011
082100              MOVE 'UNSUCCESSFUL SELECT PAYMENT TERMS' TO         08210011
082200                                            DP013-MESSAGE-TEXT (1)08220011
082300              MOVE SQLCA TO DP013-SQLCA                           08230011
082400              MOVE 'TPAYTRM ' TO DP013-DB2-TABLE-NAME (1)         08240011
082500              SET DP013-DB2-ABEND                                 08250011
082600                  DP013-XCTL-DISPLAY-RESTART TO TRUE              08260011
082700                                                                  08270011
082800              PERFORM DP013-0000-PROCESS-ABEND                    08280011
082900     END-EVALUATE                                                 08290011
083000     END-PERFORM.                                                 08300011
083100                                                                  08310011
083200     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         08320011
083300         MOVE '4030-GET-PAYT-TERM-ID' TO DP013-PARAGRAPH          08330011
083400         MOVE 'MAX RETRIES EXCEEDED ON SELECT PAYMENT TERMS' TO   08340011
083500                                            DP013-MESSAGE-TEXT (1)08350011
083600         MOVE SQLCA      TO DP013-SQLCA                           08360011
083700         MOVE 'TPAYTRM ' TO DP013-DB2-TABLE-NAME (1)              08370011
083800         SET DP013-DB2-ABEND                                      08380011
083900             DP013-XCTL-DISPLAY-RESTART TO TRUE                   08390011
084000                                                                  08400011
084100         PERFORM DP013-0000-PROCESS-ABEND                         08410011
084200     END-IF.                                                      08420011
084300                                                                  08430011
084400     IF SQLCODE = ZERO                                            08440011
084500         PERFORM 4035-FORMAT-PAYT-TERM-DESC                       08450011
084600         END-IF.                                                  08460011
084700                                                                  08470011
084800     IF SQLCODE = +100                                            08480011
084900         MOVE SPACES TO ASC-PAYT-TERM-ID-DESC.                    08490011
085000                                                                  08500011
085100 4035-FORMAT-PAYT-TERM-DESC.                                      08510011
085200                                                                  08520011
085300     COPY POPD001.                                                08530011
085400                                                                  08540011
085500 4040-GET-SHIPPING-TERMS.                                         08550011
085600                                                                  08560011
085700     PERFORM WITH TEST AFTER                                      08570011
085800             VARYING PV-RETRY-COUNTER  FROM 1 BY 1                08580011
085900             UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES OR         08590011
086000                     SQLCODE = ZERO OR                            08600011
086100                     SQLCODE = +100                               08610011
086200                                                                  08620011
086300     EXEC SQL                                                     08630011
086400          SELECT VT1.FOB_POINT_TXT                                08640011
086500                ,VT1.SHIPT_POINT_TXT                              08650011
086600                ,COALESCE(VT1.LATE_SHIPT_IND,'N')                 08660017
086700                ,COALESCE(VT1.CHRG_PCT,0)                         08670012
086800                ,COALESCE(VT1.CHRG_FCTR_CDE,' ')                  08680013
086900                ,COALESCE(B.FRGT_TERM_ID,0)                       08690011
087000                ,COALESCE(B.KOHLS_FRGT_PCT,0)                     08700011
087100                ,COALESCE(B.VND_FRGT_PCT,0)                       08710011
087200            INTO :VNDAGR-FOB-POINT-TXT                            08720011
087300                 :NI-VNDAGR-FOB-POINT-TXT                         08730011
087400                ,:VNDAGR-SHIPT-POINT-TXT                          08740011
087500                 :NI-VNDAGR-SHIPT-POINT-TXT                       08750011
087600                ,:VNDAGR-LATE-SHIPT-IND                           08760011
087700                ,:VNDAGR-CHRG-PCT                                 08770012
087800                ,:VNDAGR-CHRG-FCTR-CDE                            08780012
087900                ,:FRGTRM-FRGT-TERM-ID                             08790011
088000                ,:FRGTRM-KOHLS-FRGT-PCT                           08800011
088100                ,:FRGTRM-VND-FRGT-PCT                             08810011
088200            FROM                                                  08820011
088300                (SELECT A.FOB_POINT_TXT                           08830011
088400                       ,A.SHIPT_POINT_TXT                         08840011
088500                       ,A.LATE_SHIPT_IND                          08850011
088600                       ,A.CHRG_PCT                                08860012
088700                       ,A.CHRG_FCTR_CDE                           08870012
088800                       ,A.FRGT_TERM_ID                            08880011
088900                   FROM TVNDAGR A                                 08890011
089000                  WHERE ENT_ID   = :ASC-ENT-ID                    08900011
089100                    AND DEPT_NBR = :ASC-DEPARTMENT                08910011
089200                    AND AGRMT_TYP_ID = '1'                        08920011
089300             AND SEQ_NBR           =                              08930011
089400                 (SELECT MAX(SEQ_NBR)                             08940011
089500                    FROM TVNDAGR                                  08950011
089600                   WHERE ENT_ID            = :ASC-ENT-ID          08960011
089700                     AND DEPT_NBR          = :ASC-DEPARTMENT      08970011
089800                     AND AGRMT_TYP_ID      = :PC-SHIPPING))       08980011
089900                                          AS VT1                  08990011
090000        LEFT OUTER JOIN TFRGTRM B                                 09000011
090100             ON B.FRGT_TERM_ID = VT1.FRGT_TERM_ID                 09010011
090200     END-EXEC                                                     09020011
090300                                                                  09030011
090400     EVALUATE TRUE                                                09040011
090500         WHEN SQLCODE = ZERO                                      09050011
090600         WHEN SQLCODE = +100                                      09060011
090700         WHEN SQLCODE = -904                                      09070011
090800         WHEN SQLCODE = -913                                      09080011
090900              CONTINUE                                            09090011
091000                                                                  09100011
091100         WHEN SQLWARN0 NOT = SPACES                               09110011
091200         WHEN SQLCODE  NOT = ZERO                                 09120011
091300              MOVE '4040-GET-SHIPPING-TERMS' TO DP013-PARAGRAPH   09130011
091400              MOVE 'UNSUCCESSFUL SELECT SHIPPING TERMS' TO        09140011
091500                                            DP013-MESSAGE-TEXT (1)09150011
091600              MOVE SQLCA TO DP013-SQLCA                           09160011
091700              MOVE 'TVNDAGR ' TO DP013-DB2-TABLE-NAME (1)         09170011
091800              SET DP013-DB2-ABEND                                 09180011
091900                  DP013-XCTL-DISPLAY-RESTART TO TRUE              09190011
092000                                                                  09200011
092100              PERFORM DP013-0000-PROCESS-ABEND                    09210011
092200     END-EVALUATE                                                 09220011
092300     END-PERFORM.                                                 09230011
092400                                                                  09240011
092500     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         09250011
092600         MOVE '4040-GET-SHIPPING-TERMS' TO DP013-PARAGRAPH        09260011
092700         MOVE 'MAX RETRIES EXCEEDED ON SELECT SHIPPING TERMS' TO  09270011
092800                                            DP013-MESSAGE-TEXT (1)09280011
092900         MOVE SQLCA      TO DP013-SQLCA                           09290011
093000         MOVE 'TVNDAGR ' TO DP013-DB2-TABLE-NAME (1)              09300011
093100         SET DP013-DB2-ABEND                                      09310011
093200             DP013-XCTL-DISPLAY-RESTART TO TRUE                   09320011
093300                                                                  09330011
093400         PERFORM DP013-0000-PROCESS-ABEND                         09340011
093500     END-IF.                                                      09350011
093600                                                                  09360011
093700     IF SQLCODE = ZERO                                            09370011
093800        IF NI-VNDAGR-FOB-POINT-TXT = -1                           09380011
093900            MOVE SPACES               TO ASC-FOB-POINT-TXT        09390011
094000        ELSE                                                      09400011
094100            MOVE VNDAGR-FOB-POINT-TXT TO ASC-FOB-POINT-TXT        09410011
094200        END-IF                                                    09420011
094300        IF NI-VNDAGR-SHIPT-POINT-TXT = -1                         09430011
094400            MOVE SPACES                  TO ASC-SHIPT-POINT-TXT   09440011
094500        ELSE                                                      09450011
094600            MOVE VNDAGR-SHIPT-POINT-TXT TO ASC-SHIPT-POINT-TXT    09460011
094700        END-IF                                                    09470011
094800                                                                  09480011
094900        MOVE FRGTRM-FRGT-TERM-ID   TO ASC-FRGT-TERM-ID            09490011
095000        MOVE FRGTRM-KOHLS-FRGT-PCT TO ASC-KOHLS-FRGT-PCT          09500011
095100        MOVE FRGTRM-VND-FRGT-PCT   TO ASC-VEND-FRGT-PCT           09510011
095200        MOVE VNDAGR-LATE-SHIPT-IND TO ASC-LATE-SHIPMENT-IND       09520011
095300        MOVE VNDAGR-CHRG-PCT       TO ASC-CHARGE-PCT              09530012
095400        MOVE VNDAGR-CHRG-FCTR-CDE  TO ASC-CHARGE-FACTOR-CDE       09540012
095500                                                                  09550011
095600        IF FRGTRM-KOHLS-FRGT-PCT = 1.00                           09560011
095700           MOVE 'K' TO ASC-FRGT-PAYT-CDE                          09570011
095800        ELSE                                                      09580011
095900           IF FRGTRM-VND-FRGT-PCT = 1.00                          09590011
096000              MOVE 'V' TO ASC-FRGT-PAYT-CDE                       09600011
096100           ELSE                                                   09610011
096200              IF FRGTRM-KOHLS-FRGT-PCT > 0 AND                    09620011
096300                 FRGTRM-VND-FRGT-PCT   > 0                        09630011
096400                 MOVE 'B' TO ASC-FRGT-PAYT-CDE                    09640011
096500              ELSE                                                09650011
096600                 IF FRGTRM-FRGT-TERM-ID = 0                       09660011
096700                    MOVE ' ' TO ASC-FRGT-PAYT-CDE                 09670011
096800                 END-IF                                           09680011
096900              END-IF                                              09690011
097000           END-IF                                                 09700011
097100        END-IF                                                    09710011
097200     END-IF.                                                      09720011
097300                                                                  09730011
097400     IF SQLCODE = +100                                            09740011
097500         INITIALIZE ASC-FOB-POINT-TXT                             09750011
097600                    ASC-SHIPT-POINT-TXT                           09760011
097700                    ASC-FRGT-PAYT-CDE                             09770011
097800                    ASC-KOHLS-FRGT-PCT                            09780011
097900                    ASC-VEND-FRGT-PCT                             09790011
098000                    ASC-LATE-SHIPMENT-IND                         09800012
098100                    ASC-CHARGE-PCT                                09810012
098200                    ASC-CHARGE-FACTOR-CDE.                        09820012
098300                                                                  09830011
098400 4050-GET-PURCHASE-TERMS.                                         09840011
098500                                                                  09850011
098600     PERFORM WITH TEST AFTER                                      09860011
098700             VARYING PV-RETRY-COUNTER  FROM 1 BY 1                09870011
098800             UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES OR         09880011
098900                     SQLCODE = ZERO OR                            09890011
099000                     SQLCODE = +100                               09900011
099100                                                                  09910011
099200     EXEC SQL                                                     09920011
099300          SELECT RTV_RA_REQD_IND                                  09930011
099400                ,RTV_NO_RA_REQD_IND                               09940011
099500                ,DEBIT_DESTROY_IND                                09950011
099600                ,MARKOUT_IND                                      09960011
099700                ,VND_AUTH_ID                                      09970011
099800            INTO :VNDAGR-RTV-RA-REQD-IND                          09980011
099900                 :NI-VNDAGR-RTV-RA-REQD-IND                       09990011
100000                ,:VNDAGR-RTV-NO-RA-REQD-IND                       10000011
100100                 :NI-VNDAGR-RTV-NO-RA-REQD-IND                    10010011
100200                ,:VNDAGR-DEBIT-DESTROY-IND                        10020011
100300                 :NI-VNDAGR-DEBIT-DESTROY-IND                     10030011
100400                ,:VNDAGR-MARKOUT-IND                              10040011
100500                 :NI-VNDAGR-MARKOUT-IND                           10050011
100600                ,:VNDAGR-VND-AUTH-ID                              10060011
100700                 :NI-VNDAGR-VND-AUTH-ID                           10070011
100800            FROM TVNDAGR                                          10080011
100900           WHERE ENT_ID            = :ASC-ENT-ID                  10090011
101000             AND DEPT_NBR          = :ASC-DEPARTMENT              10100011
101100             AND AGRMT_TYP_ID      = :PC-PURCHASE                 10110011
101200             AND SEQ_NBR           =                              10120011
101300                 (SELECT MAX(SEQ_NBR)                             10130011
101400                    FROM TVNDAGR                                  10140011
101500                   WHERE ENT_ID            = :ASC-ENT-ID          10150011
101600                     AND DEPT_NBR          = :ASC-DEPARTMENT      10160011
101700                     AND AGRMT_TYP_ID      = :PC-PURCHASE)        10170011
101800     END-EXEC                                                     10180011
101900                                                                  10190011
102000     EVALUATE TRUE                                                10200011
102100         WHEN SQLCODE = ZERO                                      10210011
102200         WHEN SQLCODE = +100                                      10220011
102300         WHEN SQLCODE = -904                                      10230011
102400         WHEN SQLCODE = -913                                      10240011
102500              CONTINUE                                            10250011
102600                                                                  10260011
102700         WHEN SQLWARN0 NOT = SPACES                               10270011
102800         WHEN SQLCODE  NOT = ZERO                                 10280011
102900              MOVE '4050-GET-PURCHASE-TERMS' TO DP013-PARAGRAPH   10290011
103000              MOVE 'UNSUCCESSFUL SELECT PURCHASE TERMS' TO        10300011
103100                                            DP013-MESSAGE-TEXT (1)10310011
103200              MOVE SQLCA TO DP013-SQLCA                           10320011
103300              MOVE 'TVNDAGR ' TO DP013-DB2-TABLE-NAME (1)         10330011
103400              SET DP013-DB2-ABEND                                 10340011
103500                  DP013-XCTL-DISPLAY-RESTART TO TRUE              10350011
103600                                                                  10360011
103700              PERFORM DP013-0000-PROCESS-ABEND                    10370011
103800     END-EVALUATE                                                 10380011
103900     END-PERFORM.                                                 10390011
104000                                                                  10400011
104100     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         10410011
104200         MOVE '4050-GET-PURCHASE-TERMS' TO DP013-PARAGRAPH        10420011
104300         MOVE 'MAX RETRIES EXCEEDED ON SELECT PURCHASE TERMS' TO  10430011
104400                                            DP013-MESSAGE-TEXT (1)10440011
104500         MOVE SQLCA      TO DP013-SQLCA                           10450011
104600         MOVE 'TVNDAGR ' TO DP013-DB2-TABLE-NAME (1)              10460011
104700         SET DP013-DB2-ABEND                                      10470011
104800             DP013-XCTL-DISPLAY-RESTART TO TRUE                   10480011
104900                                                                  10490011
105000         PERFORM DP013-0000-PROCESS-ABEND                         10500011
105100     END-IF.                                                      10510011
105200                                                                  10520011
105300     IF SQLCODE = ZERO                                            10530011
105400        IF NI-VNDAGR-RTV-RA-REQD-IND = -1                         10540011
105500            MOVE SPACE                  TO ASC-RTV-RA-REQD-IND    10550011
105600        ELSE                                                      10560011
105700            MOVE VNDAGR-RTV-RA-REQD-IND TO ASC-RTV-RA-REQD-IND    10570011
105800        END-IF                                                    10580011
105900        IF NI-VNDAGR-RTV-NO-RA-REQD-IND = -1                      10590011
106000            MOVE SPACE                   TO ASC-RTV-NO-RA-REQD-IND10600011
106100        ELSE                                                      10610011
106200            MOVE VNDAGR-RTV-NO-RA-REQD-IND                        10620011
106300                                         TO ASC-RTV-NO-RA-REQD-IND10630011
106400        END-IF                                                    10640011
106500        IF NI-VNDAGR-DEBIT-DESTROY-IND = -1                       10650011
106600            MOVE SPACE                    TO ASC-DEBIT-DESTROY-IND10660011
106700        ELSE                                                      10670011
106800            MOVE VNDAGR-DEBIT-DESTROY-IND TO ASC-DEBIT-DESTROY-IND10680011
106900        END-IF                                                    10690011
107000        IF NI-VNDAGR-MARKOUT-IND = -1                             10700011
107100            MOVE SPACE              TO ASC-MARKOUT-IND            10710011
107200        ELSE                                                      10720011
107300            MOVE VNDAGR-MARKOUT-IND TO ASC-MARKOUT-IND            10730011
107400        END-IF                                                    10740011
107500        IF NI-VNDAGR-VND-AUTH-ID     = -1                         10750011
107600            MOVE SPACE              TO ASC-VND-AUTH-ID            10760011
107700        ELSE                                                      10770011
107800            MOVE VNDAGR-VND-AUTH-ID TO ASC-VND-AUTH-ID            10780011
107900        END-IF                                                    10790011
108000     END-IF.                                                      10800011
108100                                                                  10810011
108200     IF SQLCODE = +100                                            10820011
108300         INITIALIZE ASC-RTV-RA-REQD-IND                           10830011
108400                    ASC-RTV-NO-RA-REQD-IND                        10840011
108500                    ASC-DEBIT-DESTROY-IND                         10850011
108600                    ASC-MARKOUT-IND                               10860011
108700                    ASC-VND-AUTH-ID.                              10870011
108800                                                                  10880011
108900 4400-MOVE-COMMAREA-TO-SCREEN.                                    10890011
109000                                                                  10900011
109100     MOVE ASC-DEPARTMENT          TO ADPTNBRO.                    10910011
109200     MOVE ASC-ENT-NAME-DESC       TO AVNAMEO.                     10920011
109300     MOVE ASC-INHOUSE-NBR         TO AINHSO.                      10930011
109400     MOVE ASC-DUN-NBR             TO ADUNSO.                      10940011
109500     MOVE ASC-PAYT-TERM-ID        TO PV-EDIT-PAYT-TERM-ID.        10950011
109600     MOVE PV-EDIT-PAYT-TERM-ID    TO APAYTRMO.                    10960011
109700     MOVE ASC-PAYT-TERM-ID-DESC   TO APAYTXTO.                    10970011
109800     MOVE ASC-FOB-POINT-TXT       TO AFOBPNTO.                    10980011
109900     MOVE ASC-SHIPT-POINT-TXT     TO ASHPPNTO.                    10990011
110000     MOVE ASC-FRGT-PAYT-CDE       TO APAYFRGO.                    11000011
110100     MOVE ASC-FRGT-TERM-ID        TO AFRTIDTO.                    11010011
110200     MULTIPLY ASC-KOHLS-FRGT-PCT BY +100 GIVING                   11020011
110300                                     PV-NUM-KOHLS-FRGHT-PCT.      11030011
110400     MOVE PV-NUM-KOHLS-FRGHT-PCT  TO PV-EDIT-KOHLS-FRGHT-PCT.     11040011
110500     MOVE PV-EDIT-KOHLS-FRGHT-PCT TO AKFRGHTO.                    11050011
110600     MULTIPLY ASC-VEND-FRGT-PCT BY +100 GIVING                    11060011
110700                                     PV-NUM-VENDR-FRGHT-PCT.      11070011
110800     MOVE PV-NUM-VENDR-FRGHT-PCT  TO PV-EDIT-VENDR-FRGHT-PCT.     11080011
110900     MOVE PV-EDIT-VENDR-FRGHT-PCT TO AVFRGHTO.                    11090011
111000     MOVE ASC-RTV-RA-REQD-IND     TO ARTVRQDO.                    11100011
111100     MOVE ASC-RTV-NO-RA-REQD-IND  TO ARTVNRQO.                    11110011
111200     MOVE ASC-DEBIT-DESTROY-IND   TO ADBTDSTO.                    11120011
111300     MOVE ASC-MARKOUT-IND         TO AMRKOUTO.                    11130011
111400     MOVE ASC-VND-AUTH-ID         TO AAUTHIDO.                    11140011
111500     MOVE ASC-LATE-SHIPMENT-IND   TO ALTEINDO.                    11150011
111600     MULTIPLY ASC-CHARGE-PCT BY +100 GIVING                       11160011
111700                                     PV-NUM-CHARGE-PCT.           11170011
111800     MOVE PV-NUM-CHARGE-PCT       TO PV-EDIT-CHARGE-PCT.          11180011
111900     MOVE PV-EDIT-CHARGE-PCT      TO ACHGPCTO.                    11190011
112000     MOVE ASC-CHARGE-FACTOR-CDE   TO ACHGCDEO.                    11200011
112100                                                                  11210011
112200 9100-READ-SELECTION-QUEUE.                                       11220011
112300                                                                  11230011
112400     EXEC CICS READQ TS QUEUE (ASC-SEL-QUEUE-NAME)                11240011
112500                        INTO  (VN003-VENDOR-SEL-REC)              11250011
112600                        ITEM  (ASC-SEL-ITEM)                      11260011
112700                        RESP  (PV-CICS-RESPONSE)                  11270011
112800                        END-EXEC.                                 11280011
112900                                                                  11290011
113000     IF PV-CICS-RESPONSE NOT = DFHRESP (NORMAL)                   11300011
113100         SET DP013-LOGIC-ABEND                                    11310011
113200             DP013-NO-ROLLBACK TO TRUE                            11320011
113300         MOVE '9100-READ-SELECTION-QUEUE' TO DP013-PARAGRAPH      11330011
113400         MOVE 'UNSUCCESSFUL SELECTION TEMP STORAGE QUEUE READ' TO 11340011
113500                                            DP013-MESSAGE-TEXT (1)11350011
113600         PERFORM DP013-0000-PROCESS-ABEND                         11360011
113700     END-IF.                                                      11370011
113800                                                                  11380011
113900 9200-REWRITE-SELECTION-QUEUE.                                    11390011
114000                                                                  11400011
114100     EXEC CICS WRITEQ TS QUEUE   (ASC-SEL-QUEUE-NAME)             11410011
114200                         FROM    (VN003-VENDOR-SEL-REC)           11420011
114300                         ITEM    (ASC-SEL-ITEM)                   11430011
114400                         RESP    (PV-CICS-RESPONSE)               11440011
114500                         REWRITE                                  11450011
114600                         END-EXEC.                                11460011
114700                                                                  11470011
114800     IF PV-CICS-RESPONSE NOT = DFHRESP (NORMAL)                   11480011
114900         SET DP013-CICS-ABEND                                     11490011
115000             DP013-NO-ROLLBACK TO TRUE                            11500011
115100         MOVE '9200-REWRITE-SELECTION-QUEUE' TO DP013-PARAGRAPH   11510011
115200         MOVE 'UNSUCCESSFUL SELECTION TEMP STORAGE QUEUE REWRITE' 11520011
115300                                         TO DP013-MESSAGE-TEXT (1)11530011
115400         PERFORM DP013-0000-PROCESS-ABEND                         11540011
115500     END-IF.                                                      11550011
115600                                                                  11560011
115700******************************************************************11570011
115800*   ABEND PROCESSING                                              11580011
115900******************************************************************11590011
116000     COPY DPPD013.                                                11600011
