000100*-----------------------*                                         00010099
000200 IDENTIFICATION DIVISION.                                         00020069
000300*-----------------------*                                         00030004
000400 PROGRAM-ID.    CNKCS216.                                         00040099
000500 AUTHOR.        CRAIG KEHOE.                                      00050004
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060004
000700 DATE-WRITTEN.  07-07-00.                                         00070004
000800 DATE-COMPILED.                                                   00080004
000900*---------------------------------------------------------------* 00090099
001000*    Y216 - PRINTER MAINTENANCE - PRINTER ADD/UPDATE/DELETE       00100099
001100*    THIS PROGRAM WILL PROCESS THE PRINTER ID ADD/UPDATE/         00110099
001200*    OR DELETE WHEN THE ASSOCIATE SELECTS F13-ADD, F15-UPDATE,    00120099
001300*    OR F16-DELETE FROM THE PRINTER LIST SCREEN (CNKCS215).       00130099
001400*    THE ASSOCIATE MAY ALSO GO TO THE PRINTER TYPE LIST,          00140099
001500*    STOCK TYPE LIST OR CLUSTER LIST FROM THIS PROGRAM.           00150099
001600*---------------------------------------------------------------* 00160099
263455* CHANGED 11/02/2021    BY JIM HUNTER      WR: CHG0263455                 
263455* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE             
263455* MAKING THE CALL DYNAMIC VS STATIC.                                      
263455*----------------------------------------------------------------*        
CICS  * CHANGED 10/25/2022    BY JIM HUNTER      WR: CHG0276961                 
CICS  * ADD COPYBOOK DPWS930 AND MAKE THE CICS ARCHITECTURE CALL                
CICS  * DYNAMIC INSTEAD OF STATIC BY CALLING DP930-CICS-ARCH-API.               
CICS  *-----------------------------------------------------------------        
001700 ENVIRONMENT DIVISION.                                            00170004
001800                                                                  00180004
001900 DATA DIVISION.                                                   00190004
002000                                                                  00200004
002100 WORKING-STORAGE SECTION.                                         00210004
002200                                                                  00220004
002300 01  DN-DB2-NULL-INDICATORS.                                      00230099
002400     05  DN-CLUSTER-NBR           PIC S9(04)  COMP  VALUE ZEROES. 00240099
002500*                                                                 00250004
002600 01  DK-DB2-KEYS.                                                 00260099
002700     10  DK-PRTR-ID               PIC   X(08).                    00270099
002800     10  DK-PRTR-OPER-UNT-ID      PIC  S9(4) COMP   VALUE ZEROES. 00271099
002900     10  DK-PRTR-CLUSTR-NBR       PIC  S9(4) COMP   VALUE ZEROES. 00280099
003000     10  DK-PAPR-TRK-QTY          PIC  S9(4) COMP   VALUE ZEROES. 00290099
003100*                                                                 00300099
003200 01  PC-PROGRAM-CONSTANTS.                                        00310004
003300     05  PC-CURRENT-PROGRAM-NAME  PIC  X(08)  VALUE  'CNKCS216'.  00320099
003400     05  PC-CURRENT-MAP-NAME      PIC  X(08)  VALUE  'CNK216  '.  00330099
003500     05  PC-CURRENT-MAPSET-NAME   PIC  X(08)  VALUE  'CNKM216 '.  00340099
003600     05  PC-01                    PIC  X(02)  VALUE  '01'.        00350099
003700     05  PC-APPL-MAP              PIC S9(04)  VALUE  +1           00360004
003800                                              COMP.               00370004
003900     05  PC-MAX-RETRIES           PIC S9(04)  VALUE  +3           00380004
004000                                              COMP.               00390004
004100     05  PC-INTER-APPL-CODES.                                     00400099
004200         10  PC-INTER-APPL-CRIT-SPEC-UPD                          00410099
004300                                  PIC  X(01)  VALUE '5'.          00420099
004400         10  PC-INTER-APPL-CRIT-SPEC-ADD                          00430099
004500                                  PIC  X(01)  VALUE '4'.          00440099
004600         10  PC-INTER-APPL-LIST-ADD                               00450099
004700                                  PIC  X(01)  VALUE '2'.          00460099
004800         10  PC-INTER-APPL-LIST-UPDATE                            00470099
004900                                  PIC  X(01)  VALUE '3'.          00480099
005000         10  PC-INTER-APPL-LIST-DELETE                            00490099
005100                                  PIC  X(01)  VALUE '1'.          00500099
005200     05  PC-PRINT-QUEUE-SEQ       PIC  9(01)  VALUE 3.            00510099
005300*----------------------------------------------------------------*00520099
005400*  SYSTEM MESSAGES                                                00530099
005500*----------------------------------------------------------------*00540099
005600*   00005 - INVALID VALUE                                         00550099
005700*   00007 - REQUIRED ENTRY                                        00560099
005800*   00008 - MUST BE NUMERIC                                       00570099
005900*   00034 - ADD SUCCESSFUL                                        00580099
006000*   00057 - A LIST ITEM MUST BE SELECTED FOR THIS FUNCTION        00590099
006100*   00059 - UPDATE(S) SUCCESSFUL                                  00600099
006200*   00069 - TOP OF LIST                                           00610099
006300*   00070 - BOTTOM OF LIST                                        00620099
006400*   00095 - APPLICATION SYSTEM DOES NOT EXIST                     00630099
006500*   00115 - DELETE SUCCESSFUL                                     00640099
006600*   00302 - DATA ENTERED IN THE 'KEY' FIELD IS INVALID            00650099
006700*   00354 - DELETE PENDING - PRESS PF2 TO CONFIRM                 00660099
006800*   00527 - TYPE CODE DOES NOT EXIST                              00670099
006900*   00746 - INVALID PRINTER DESTINATION                           00680099
007000*   02542 - PRINTER ALREADY EXISTS - UNABLE TO ADD                00690099
007100*   02551 - CLUSTER ID NOT REQUIRED FOR LINE PRINTER              00700099
007200*   99901 - INVALID COMMAND WAS ENTERED                           00710099
007300*----------------------------------------------------------------*00720099
007400     05  PC-TSYMSG-NUMBERS.                                       00730004
007500         10  PC-TSYMSG-00005      PIC  9(05)  VALUE  00005.       00740071
007600         10  PC-TSYMSG-00007      PIC  9(05)  VALUE  00007.       00750004
007700         10  PC-TSYMSG-00008      PIC  9(05)  VALUE  00008.       00760099
007800         10  PC-TSYMSG-00034      PIC  9(05)  VALUE  00034.       00770099
007900         10  PC-TSYMSG-00057      PIC  9(05)  VALUE  00057.       00780099
008000         10  PC-TSYMSG-00059      PIC  9(05)  VALUE  00059.       00790004
008100         10  PC-TSYMSG-00069      PIC  9(05)  VALUE  00069.       00800004
008200         10  PC-TSYMSG-00070      PIC  9(05)  VALUE  00070.       00810004
008300         10  PC-TSYMSG-00095      PIC  9(05)  VALUE  00095.       00820004
008400         10  PC-TSYMSG-00115      PIC  9(05)  VALUE  00115.       00830099
008500         10  PC-TSYMSG-00302      PIC  9(05)  VALUE  00302.       00840004
008600         10  PC-TSYMSG-00354      PIC  9(05)  VALUE  00354.       00850099
008700         10  PC-TSYMSG-00527      PIC  9(05)  VALUE  00527.       00860099
008710         10  PC-TSYMSG-00551      PIC  9(05)  VALUE  00551.       00860099
008800         10  PC-TSYMSG-00746      PIC  9(05)  VALUE  00746.       00870099
008900         10  PC-TSYMSG-02542      PIC  9(05)  VALUE  02542.       00880099
009000         10  PC-TSYMSG-02551      PIC  9(05)  VALUE  02551.       00890099
009100         10  PC-TSYMSG-99901      PIC  9(05)  VALUE  99901.       00900004
009200*                                                                 00910099
009300     05  PC-A                     PIC  X(01)  VALUE  'A'.         00920099
009400     05  PC-I                     PIC  X(01)  VALUE  'I'.         00930099
009500     05  PC-L                     PIC  X(01)  VALUE  'L'.         00940099
009600     05  PC-N                     PIC  X(01)  VALUE  'N'.         00950099
009700     05  PC-SPACE                 PIC  X(03)  VALUE  '   '.       00960099
009800*                                                                 00970004
009900 01  PS-PROGRAM-SWITCHES.                                         00980004
010000     05  PS-ERROR-SW              PIC  X(01)  VALUE  'N'.         00990004
010100         88  PS-ERROR                         VALUE  'Y'.         01000004
010200         88  PS-NO-ERROR                      VALUE  'N'.         01010004
010300     05  PS-COMMAREA-SW           PIC  X(01)  VALUE  'N'.         01020099
010400         88  PS-COMMAREA-VALID                VALUE  'Y'.         01030099
010500         88  PS-COMMAREA-NOT-VALID            VALUE  'N'.         01040099
010600     05  PS-LIST-END-SW           PIC  X(01)  VALUE  'N'.         01050099
010700         88  PS-LIST-END                      VALUE  'Y'.         01060099
010800         88  PS-NO-LIST-END                   VALUE  'N'.         01070099
010900     05  PS-NULL-CLUSTER-SW       PIC  X(01)  VALUE  'N'.         01080099
011000         88  PS-NULL-CLUSTER-YES              VALUE  'Y'.         01090099
011100         88  PS-NULL-CLUSTER-NO               VALUE  'N'.         01100099
011200     05  PS-EOF-STK-TYP-CURSOR-SW        PIC  X(01)  VALUE 'N'.   01110099
011300         88  PS-EOF-STK-TYP-CURSOR                   VALUE 'Y'.   01120099
011400         88  PS-NOT-EOF-STK-TYP-CURSOR               VALUE 'N'.   01130099
011500*                                                                 01140099
011600 01  PV-PROGRAM-VARIABLES.                                        01150004
011700     05  PV-CICS-RESPONSE         PIC S9(04)  VALUE +0            01160004
011800                                              COMP SYNC.          01170004
012100     05  PV-INPUT-SPACE-CNT       PIC S9(04)  VALUE +0            01200030
012200                                              COMP SYNC.          01210030
012300     05  PV-STAT-1                PIC X(01)   VALUE SPACES.       01220099
012400         88   PV-STAT-1-ACTIVE                VALUE 'A'.          01230099
012500         88   PV-STAT-1-INACTIVE              VALUE 'I'.          01240099
012600     05  PV-STAT-2                PIC X(02)   VALUE SPACES.       01250099
012700         88   PV-STAT-2-ACTIVE                VALUE 'A'.          01260099
012800         88   PV-STAT-2-INACTIVE              VALUE 'I'.          01270099
012900                                                                  01280099
013000     05  PV-OPER-UNT-ID           PIC S9(04)  COMP.               01290099
013100     05  PV-FCLTY-NME             PIC X(25).                      01300099
013200     05  PV-FCLTY-ID              PIC S9(04)  COMP.               01310099
013300******************************************************************01320099
013400*PV-INP VARIABLES HOLD COMMAREA VALUES                            01330099
013500*       ONLY PV-INP VARIABLES READ FROM AND WRITE TO ASC-'S       01340099
013600******************************************************************01350099
013700     05  PV-INP-PRTR-OPER-UNT-ID  PIC S9(04)  COMP.               01360099
013800     05  PV-INP-PRTR-FCLTY-NME    PIC X(25).                      01370099
013900     05  PV-INP-PRTR-FCLTY-ID     PIC S9(04)  COMP.               01380099
014000     05  PV-INP-PRTR-ID           PIC X(08).                      01390099
014100     05  PV-INP-PRTR-CLUSTR-NBR   PIC S9(04)  VALUE +0            01400099
014200                                              COMP.               01410099
014300     05  PV-INP-PRTR-TYP-CDE      PIC X(08).                      01420099
014400     05  PV-INP-PRTR-LOC-DESC     PIC X(30).                      01430099
014500     05  PV-INP-PRTR-PHY-STAT-CDE PIC X(01).                      01440099
014600                                                                  01450099
014700*THIS IS HOW MANY TRACKS A PRTR HAS (1, 2 OR 3)                   01460099
014800     05  PV-INP-PAPR-TRK-QTY1     PIC S9(04)  COMP.               01470099
014900     05  PV-INP-PAPR-TRK-QTY2     PIC S9(04)  COMP.               01480099
015000     05  PV-INP-PAPR-TRK-QTY3     PIC S9(04)  COMP.               01490099
015100                                                                  01500099
015200*THIS IS THE STOCK TYPE CODE-THIS IS WHICH TRACK (0,1 OR 2)       01510099
015300     05  PV-INP-STK-TYP-CDE0      PIC X(08).                      01520099
015400     05  PV-INP-STK-TYP-CDE1      PIC X(08).                      01530099
015500     05  PV-INP-STK-TYP-CDE2      PIC X(08).                      01540099
015600*                                                                 01550099
015700******************************************************************01560099
015800*PV-TBL VARIABLES HOLD TABLE VALUES                               01570099
015900*       ONLY PV-TBL VARIABLES READ FROM AND WRITE TO TABLES       01580099
016000******************************************************************01590099
016100     05  PV-TBL-PRTR-MFR-DESC     PIC X(25).                      01600099
016200     05  PV-TBL-PRTR-MDL-DESC     PIC X(25).                      01610099
016300     05  PV-TBL-AUTO-CTTR-IND     PIC X(01).                      01620099
016400     05  PV-TBL-PRT-BRCDE-IND     PIC X(01).                      01630099
016500     05  PV-TBL-PRTR-CNTL-IND     PIC X(01).                      01640099
016600     05  PV-TBL-PRTR-ID           PIC X(08).                      01650099
016700     05  PV-TBL-PRTR-CLUSTR-NBR   PIC X(04).                      01660099
016800     05  PV-TBL-PRTR-CLUSTR-NBR-R REDEFINES                       01670099
016900                                     PV-TBL-PRTR-CLUSTR-NBR.      01680099
017000         10  PV-TBL-PRTR-CLUSTR-NBR-N PIC 9(04).                  01690099
017100     05  PV-TBL-PRTR-TYP-CDE      PIC X(08).                      01700099
017200     05  PV-TBL-PRTR-LOC-DESC     PIC X(30).                      01710099
017300     05  PV-TBL-PRTR-PHY-STAT-CDE PIC X(01).                      01720099
017400                                                                  01730099
017500*THIS IS HOW MANY TRACKS A PRTR HAS (1, 2 OR 3)                   01740099
017600     05  PV-TBL-PRTR-TRK-NBR      PIC S9(04)  COMP.               01760099
017700                                                                  01770099
017800*THIS IS THE STOCK TYPE CODE-THIS IS WHICH TRACK (0,1 OR 2)       01780099
017900     05  PV-TBL-STK-TYP-CDE       PIC X(08).                      01790099
018000     05  PV-TBL-STK-TYP-CDE0      PIC X(08).                      01800099
018100     05  PV-TBL-STK-TYP-CDE1      PIC X(08).                      01810099
018200     05  PV-TBL-STK-TYP-CDE2      PIC X(08).                      01820099
018300                                                                  01830099
018400*******                                                           01840099
018500     05  PV-PAPR-TRK-QTY1         PIC X(04)   VALUE SPACES.       01850099
018600         88   PV-PAPR-TRK1-1                  VALUE '0001'.       01860099
018700         88   PV-PAPR-TRK1-2                  VALUE '0002'.       01870099
018800         88   PV-PAPR-TRK1-3                  VALUE '0003'.       01880099
018900     05  PV-PAPR-TRK-QTY2         PIC X(04)   VALUE SPACES.       01890099
019000         88   PV-PAPR-TRK2-1                  VALUE '0001'.       01900099
019100         88   PV-PAPR-TRK2-2                  VALUE '0002'.       01910099
019200         88   PV-PAPR-TRK2-3                  VALUE '0003'.       01920099
019300     05  PV-PAPR-TRK-QTY3         PIC X(04)   VALUE SPACES.       01930099
019400         88   PV-PAPR-TRK3-1                  VALUE '0001'.       01940099
019500         88   PV-PAPR-TRK3-2                  VALUE '0002'.       01950099
019600         88   PV-PAPR-TRK3-3                  VALUE '0003'.       01960099
019700*                                                                 01970099
019800*                                                                 01980099
019900*---------------------------------------------------------------* 01990083
020000* SELECTON QUEUE LAYOUT                                         * 02000083
020100*---------------------------------------------------------------* 02010083
020200     COPY CNWS163.                                                02020099
020300                                                                  02030083
020400*----------------------------------------------------------------*02040004
020500*    MAP LAYOUT                                                  *02050004
020600*----------------------------------------------------------------*02060004
020700                                                                  02070004
020800     COPY CNKM216.                                                02080099
020900                                                                  02090004
021000*----------------------------------------------------------------*02100004
021100*    ATTRIBUTE SETTINGS COPYBOOK.                                *02110004
021200*----------------------------------------------------------------*02120004
021300                                                                  02130004
021400     COPY DPWS015.                                                02140004
021500     COPY DPWS057.                                                02150005
021600                                                                  02160004
021700*----------------------------------------------------------------*02170004
021800*    FUNCTION KEYS COPYBOOK                                      *02180004
021900*----------------------------------------------------------------*02190004
022000                                                                  02200004
022100     COPY DPWS016.                                                02210004
022200                                                                  02220004
022300                                                                  02230099
022400**--------------------------------------------------------------**02240004
022500** THE CALLING PARAMETER LIST (DPWS010) FOR THE NUMERIC EDIT    **02250004
022600** SUB-ROUTINE (DPKUT100).                                      **02260004
022700**--------------------------------------------------------------**02270004
022800     COPY DPWS010I.                                               02280004
022900                                                                  02290099
023000**--------------------------------------------------------------**02300004
023100** THE CALLING PARAMETER LIST (DPWS030) FOR THE CICS ARCHITECTURE*02310004
023200** APPLICATION PROGRAMMING INTERFACE MODULE                     **02320004
023300**--------------------------------------------------------------**02330004
023400     COPY DPWS030.                                                02340004
CICS       COPY DPWS930.                                                02350099
023600**--------------------------------------------------------------**02360004
023700*    STANDARD COMMAREA.                                           02370004
023800**--------------------------------------------------------------**02380004
023900                                                                  02390004
024000     COPY DPWS020.                                                02400004
024100     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                02410004
024200                                                                  02420004
024300*---------------------------------------------------------------* 02430099
024400* INTER-APPLICATION COMMAREA.                                     02440099
024500*   CNWS161 - IS THE INPUT LAYOUT WHEN COMING FROM THE CRIT.    * 02450099
024600*             SPEC SCREEN.                                        02460099
024700*   CNWS162 - IS THE INPUT LAYOUT THAT WILL BE PASSED FROM        02470099
024800*             THE LIST SCREEN                                     02480099
024900*---------------------------------------------------------------* 02490099
025000                                                                  02500004
025100         10  INTER-APPL-COMM-AREA PIC X(200).                     02510004
025200     COPY CNWS161.                                                02520099
025300     COPY CNWS162.                                                02530099
025400***************************************************************** 02540004
025500*    SPECIFIC COMMMAREA FOR DPKCS041.                             02550004
025600***************************************************************** 02560004
025700         10  ASC-SPECIFIC-COMMAREA.                               02570004
025800             15  ASC-CONFIRMATION-SW       PIC X(01).             02580099
025900                 88  ASC-NEED-CONFIRMATION            VALUE  'Y'. 02590099
026000                 88  ASC-NOT-NEED-CONFIRMATION        VALUE  'N'. 02600099
026100             15  ASC-PRINTER-ID-SW        PIC  X(01).             02610099
026200                 88  ASC-LABEL-PRINTER                VALUE  'L'. 02620099
026300                 88  ASC-LINE-PRINTER                 VALUE  'N'. 02630099
026400             15  ASC-OPER-UNT-ID           PIC S9(04)  COMP.      02640099
026500             15  ASC-FCLTY-NME             PIC X(25).             02650099
026600             15  ASC-FCLTY-ID              PIC S9(04)  COMP.      02660099
026700             15  ASC-PRTR-ID               PIC X(08).             02670099
026800             15  ASC-PRTR-CLUSTR-NBR       PIC X(04).             02680099
026900             15  ASC-PRTR-CLUSTR-NBR-R REDEFINES                  02690099
027000                                       ASC-PRTR-CLUSTR-NBR.       02700099
027100                 20  ASC-PRTR-CLUSTR-NBR-N PIC 9(04).             02710099
027200                                                                  02720099
027300             15  ASC-NULL-CLUSTER-SW       PIC  X(01).            02730099
027400                 88  ASC-NULL-CLUSTER-YES             VALUE  'Y'. 02740099
027500                 88  ASC-NULL-CLUSTER-NO              VALUE  'N'. 02750099
027600             15  ASC-PRTR-TYP-CDE          PIC X(08).             02760082
027700             15  ASC-PRTR-LOC-DESC         PIC X(30).             02770082
027800                                                                  02780099
027900             15  ASC-PRTR-STATUS-CDE         PIC  X(01).          02790099
028000                 88  ASC-PRTR-STAT-VALID      VALUE 'A' 'I' ' '.  02800099
028100                 88  ASC-PRTR-STAT-ENTERED    VALUE 'A' 'I'.      02810099
028200                 88  ASC-PRTR-STAT-ACTIVE     VALUE 'A'.          02820099
028300                 88  ASC-PRTR-STAT-INACTIVE   VALUE 'I'.          02830099
028400                                                                  02840099
028500*NEED TO REDEFINE THIS FIELD SO WE CAN DO NUMERIC EDIT            02850099
028600*THIS IS HOW MANY TRACKS A PRTR HAS (1, 2 OR 3)                   02860099
028700             15  ASC-PAPR-TRK-QTY          PIC X(04).             02870099
028800                 88  ASC-PAPR-TRK-QTY-VALID   VALUE '0001'        02880099
028900                                                    '0002'        02890099
029000                                                    '0003'        02900099
029100                                                    '    '.       02910099
029200                 88  ASC-PAPR-TRK-ENTERED     VALUE '0001'        02920099
029300                                                    '0002'        02930099
029400                                                    '0003'.       02940099
029500                 88  ASC-PAPR-TRK-QTY-1       VALUE '0001'.       02950099
029600                 88  ASC-PAPR-TRK-QTY-2       VALUE '0002'.       02960099
029700                 88  ASC-PAPR-TRK-QTY-3       VALUE '0003'.       02970099
029800             15  ASC-PAPR-TRK-QTY-R REDEFINES                     02980099
029900                                       ASC-PAPR-TRK-QTY.          02990099
030000                 20  ASC-PAPR-TRK-QTY-N    PIC 9(04).             03000099
030100                                                                  03010099
030200             15  ASC-PRTR-TRK-NBR1         PIC S9(04)  COMP.      03020099
030300             15  ASC-PRTR-TRK-NBR2         PIC S9(04)  COMP.      03030099
030400             15  ASC-PRTR-TRK-NBR3         PIC S9(04)  COMP.      03040099
030500                                                                  03050099
030600*THIS IS THE STOCK TYPE CODE-THIS IS WHICH TRACK (0,1 OR 2)       03060099
030700             15  ASC-STK-TYP-CDE0          PIC X(08).             03070099
030800             15  ASC-STK-TYP-CDE1          PIC X(08).             03080099
030900             15  ASC-STK-TYP-CDE2          PIC X(08).             03090099
031000                                                                  03100099
031100             15  ASC-INT-APPL-FORMAT-IND   PIC X(01).             03110099
031200*SWITCHES                                                         03120099
031300             15  ASC-ACTION-SW          PIC X(03).                03130099
031400                 88  ASC-ADD            VALUE 'ADD'.              03140099
031500                 88  ASC-DELETE         VALUE 'DEL'.              03150099
031600                 88  ASC-UPDATE         VALUE 'UPD'.              03160099
031700             15  ASC-PRTR-ID-SW            PIC X(01).             03170099
031800                 88  ASC-PRTR-ID-ENTERED         VALUE 'Y'.       03180099
031900                 88  ASC-NO-PRINTER-ID-ENTERED   VALUE 'N'.       03190099
032000*                                                                 03200099
032100             15  ASC-PRTR-ID-EXISTS-SW    PIC  X(01).             03210099
032200                 88  ASC-PRTR-ID-EXISTS               VALUE  'Y'. 03220099
032300                 88  ASC-PRTR-ID-NOT-EXISTS           VALUE  'N'. 03230099
032400             15  ASC-PRTR-TYPE-EXISTS-SW  PIC  X(01).             03240099
032500                 88  ASC-PRTR-TYPE-EXISTS             VALUE  'Y'. 03250099
032600                 88  ASC-PRTR-TYPE-NOT-EXISTS         VALUE  'N'. 03260099
032700*                                                                 03270099
032800             15  ASC-TPRTRID-INSERTED-SW  PIC  X(01).             03280099
032900                 88  ASC-TPRTRID-INSERTED             VALUE  'Y'. 03290099
033000                 88  ASC-TPRTRID-NOT-INSERTED         VALUE  'N'. 03300099
033100             15  ASC-TPRTRTK-INSERTED-SW  PIC  X(01).             03310099
033200                 88  ASC-TPRTRTK-INSERTED             VALUE  'Y'. 03320099
033300                 88  ASC-TPRTRTK-NOT-INSERTED         VALUE  'N'. 03330099
033400                                                                  03340099
033500             15  ASC-TPRTRID-UPDATED-SW   PIC  X(01).             03350099
033600                 88  ASC-TPRTRID-UPDATED              VALUE  'Y'. 03360099
033700                 88  ASC-TPRTRID-NOT-UPDATED          VALUE  'N'. 03370099
033800             15  ASC-TPRTRTY-UPDATED-SW   PIC  X(01).             03380099
033900                 88  ASC-TPRTRTY-UPDATED              VALUE  'Y'. 03390099
034000                 88  ASC-TPRTRTY-NOT-UPDATED          VALUE  'N'. 03400099
034100             15  ASC-TPRTRTK-UPDATED-SW   PIC  X(01).             03410099
034200                 88  ASC-TPRTRTK-UPDATED              VALUE  'Y'. 03420099
034300                 88  ASC-TPRTRTK-NOT-UPDATED          VALUE  'N'. 03430099
034400                                                                  03440099
034500             15  ASC-TPRTRID-DELETED-SW   PIC  X(01).             03450099
034600                 88  ASC-TPRTRID-DELETED              VALUE  'Y'. 03460099
034700                 88  ASC-TPRTRID-NOT-DELETED          VALUE  'N'. 03470099
034800             15  ASC-TPRTRTK-DELETED-SW   PIC  X(01).             03480099
034900                 88  ASC-TPRTRTK-DELETED              VALUE  'Y'. 03490099
035000                 88  ASC-TPRTRTK-NOT-DELETED          VALUE  'N'. 03500099
035100*                                                                 03510099
035200             15  ASC-MSG-NUMBER.                                  03520024
035300                 20  ASC-MSG-NUMBER-N      PIC  9(05).            03530024
035400             15  ASC-INT-APPL-FORMAT-SAVE  PIC  X(01).            03540099
035500             15  ASC-SYSTEM-ID             PIC  X(02).            03550024
035600             15  ASC-MSG-TEXT              PIC  X(70).            03560024
035700             15  ASC-USE-SELECTION-QUEUE-IND                      03570024
035800                                           PIC  X(01).            03580024
035900                 88  ASC-USE-SELECTION-QUEUE           VALUE 'Y'. 03590024
036000             15  ASC-SEL-QUEUE-NAME        PIC  X(08).            03600024
036100             15  ASC-NUMBER-OF-TS-ITEMS    PIC S9(05)  COMP-3.    03610024
036200             15  ASC-NUMBER-OF-SELECTED-ITEMS                     03620029
036300                                           PIC S9(09)  COMP-3.    03630029
036400             15  ASC-PRT-QUEUE-NAME.                              03640099
036500                 20  ASC-PRT-TERM-ID          PIC  X(04).         03650099
036600                 20  ASC-PRT-TASK-NUMBER      PIC S9(05) COMP-3.  03660099
036700                 20  ASC-PRT-SEQ              PIC  9(01).         03670099
036800             15  ASC-ITEM-SUB                 PIC S9(04)  COMP    03680099
036900                                                          SYNC.   03690099
037000             15  ASC-SEL-SUB               PIC S9(04)  COMP.      03700024
037100             15  ASC-SEL-ITEM              PIC S9(04)  COMP.      03710024
037200             15  ASC-TEMP-QUEUE-UPDATE-SW     PIC  X(01).         03720099
037300                 88  ASC-UPDATE-TSQ                VALUE 'Y'.     03730099
037400                 88  ASC-NO-TSQ-UPDATE             VALUE ' '.     03740099
037500                                                                  03750099
037600*----------------------------------------------------------------*03760004
037700*    ABEND PROCESSING COPYBOOK.                                  *03770004
037800*----------------------------------------------------------------*03780004
037900     COPY DPWS013.                                                03790004
038000                                                                  03800004
038100*    DB2 AREA FOR PRINTER CLUSTER                                 03810099
038200     EXEC SQL                                                     03820099
038300          INCLUDE TPRTRCL                                         03830099
038400     END-EXEC.                                                    03840099
038500                                                                  03850099
038600*    DB2 AREA FOR PRINTER TYPE                                    03860099
038700     EXEC SQL                                                     03870099
038800          INCLUDE TPRTRTY                                         03880099
038900     END-EXEC.                                                    03890099
039000                                                                  03900099
039100*    DB2 AREA FOR STOCK TYPE                                      03910099
039200     EXEC SQL                                                     03920099
039300          INCLUDE TSTKTYP                                         03930099
039400     END-EXEC.                                                    03940099
039500                                                                  03950099
039600*    DB2 AREA FOR PRINTER ID                                      03960099
039700     EXEC SQL                                                     03970099
039800          INCLUDE TPRTRID                                         03980099
039900     END-EXEC.                                                    03990099
040000                                                                  04000099
040100*    DB2 AREA FOR PRINTER TRACK                                   04010099
040200     EXEC SQL                                                     04020099
040300          INCLUDE TPRTRTK                                         04030099
040400     END-EXEC.                                                    04040099
040500                                                                  04050099
040600                                                                  04060004
040700*    DB2 AREA FOR TSYMSG  (SYSTEM MESSAGE - SHORT MESSAGE)        04070004
040800     EXEC SQL                                                     04080004
040900          INCLUDE TSYMSG                                          04090004
041000     END-EXEC.                                                    04100004
041100                                                                  04110004
041200*    DB2 AREA FOR COMMUNICATIONS                                  04120004
041300     EXEC SQL                                                     04130004
041400          INCLUDE SQLCA                                           04140004
041500     END-EXEC.                                                    04150004
041600                                                                  04160099
041700     EXEC SQL                                                     04170099
041800        DECLARE STK-TYP-CSR CURSOR FOR                            04180099
041900             SELECT                                               04190099
042000                 STK_TYP_CDE                                      04200099
042100                ,PRTR_TRK_NBR                                     04210099
042200             FROM  TPRTRTK                                        04220099
042300             WHERE PRTR_ID = :DK-PRTR-ID                          04230099
042400               AND PRTR_OPER_UNT_ID = :DK-PRTR-OPER-UNT-ID        04231099
042500         END-EXEC                                                 04240099
042600*                                                                 04250099
042700*                                                                 04260099
042800 LINKAGE SECTION.                                                 04270004
042900                                                                  04280004
043000 01  DFHCOMMAREA.                                                 04290004
043100     05  FILLER                         OCCURS  1 TO 4072 TIMES   04300004
043200                                        DEPENDING ON EIBCALEN.    04310004
043300         10  FILLER                     PIC X.                    04320004
043400                                                                  04330004
043500                                                                  04340004
043600 PROCEDURE DIVISION.                                              04350004
043700***************************************************************** 04360004
043800** THIS MODULE CONTROLS THE OVERALL PROCESSING IN THE PROGRAM. ** 04370004
043900** THE SETUP AND PERFORM OF PARAGRAPH 0001-CALL-CICS-ARCH-API  ** 04380004
044000** MUST BE THE FIRST CODE EXECUTED IN THIS PROGRAM.            ** 04390004
044100**                                                             ** 04400004
044200** THE SECOND OR 'EXIT' PERFORM OF THIS PARAGRAPH MUST BE THE  ** 04410004
044300** LAST CODE EXECUTED ON EACH ITERATION OF THIS PROGRAM.       ** 04420004
044400***************************************************************** 04430004
044500 0000-MAIN-MODULE.                                                04440004
044600     INITIALIZE DP030-CICS-API-FIELDS.                            04450004
044700     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       04460004
044800     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          04470004
044900     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         04480004
045000     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       04490004
045100     MOVE LENGTH OF CNK216I        TO DP030-MAP-LENGTH (1).       04500099
045200     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     04510004
045300     PERFORM 0001-CALL-CICS-ARCH-API.                             04520004
045400                                                                  04530099
045500     PERFORM 1000-CONTROL-PROCESSING                              04540004
045600                                                                  04550099
045700     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     04560004
045800     PERFORM 0001-CALL-CICS-ARCH-API.                             04570004
045900                                                                  04580004
046000 0001-CALL-CICS-ARCH-API.                                         04590004
CICS       CALL DP930-CICS-ARCH-API USING DFHEIBLK                              
046200                                    DFHCOMMAREA                           
046300                                    DP030-CICS-API-FIELDS                 
046400                                    DP020-STANDARD-COMMAREA               
046500                                    CNK216I.                              
046600                                                                  04650099
046700     IF  DP030-RC-CALL-SUCCESSFUL                                 04660004
046800         CONTINUE                                                 04670004
046900     ELSE                                                         04680004
047000         SET DP013-NO-ROLLBACK                                    04690004
047100             DP013-XCTL-DISPLAY-RESTART                           04700004
047200             DP013-CICS-ABEND      TO TRUE                        04710004
047300         MOVE 'BEFORE 0000-MAIN-MODULE'                           04720004
047400                                   TO DP013-PARAGRAPH             04730004
CICS           MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O        
CICS  -             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)              
047700         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      04760004
047800         PERFORM DP013-0000-PROCESS-ABEND                         04770004
047900     END-IF.                                                      04780004
048000*                                                                 04790099
048100*                                                                 04800099
048200*----------------------------------------------------------------*04810004
048300*    PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT   *04820004
048400*    COURSE OF ACTION IS FOR THIS TRANSACTION.                   *04830004
048500*----------------------------------------------------------------*04840004
048600 1000-CONTROL-PROCESSING.                                         04850004
048700                                                                  04860004
048800     EVALUATE TRUE                                                04870004
048900         WHEN DP020-NEXT-ACT-INITIAL                              04880004
049000              INITIALIZE ASC-SPECIFIC-COMMAREA                    04890099
049100              MOVE EIBTRMID               TO ASC-PRT-TERM-ID      04900099
049200              MOVE DP020-SRC-TASK-NUMBER  TO ASC-PRT-TASK-NUMBER  04910099
049300              MOVE PC-PRINT-QUEUE-SEQ     TO ASC-PRT-SEQ          04920099
049400              PERFORM 1100-PROCESS-INTER-APPL-COMM                04930099
049500              MOVE PC-A      TO ASC-PRTR-STATUS-CDE               04940099
049600                                                                  04950099
049700              IF  PS-COMMAREA-NOT-VALID                           04960099
049800                  SET DP020-NEXT-ACT-APPL-ERROR                   04970099
049900                                    TO TRUE                       04980099
050000              ELSE                                                04990099
050100                  PERFORM 4000-BUILD-INITIAL-PANEL                05000099
050200                  PERFORM 3200-RESET-ATTRIBUTES                   05010099
050300              END-IF                                              05020099
050400                                                                  05030099
050500         WHEN DP020-NEXT-ACT-READ-MAP                             05040004
050600             PERFORM 2000-PROCESS-PANEL                           05050004
050700*F3-END                                                           05060099
050800         WHEN DP020-NEXT-ACT-RETURN                               05070004
050900             PERFORM 4000-BUILD-INITIAL-PANEL                     05080099
051000             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   05090004
051100             MOVE -1                   TO APRTIDL                 05100099
051200                                                                  05110099
051300             EVALUATE TRUE                                        05120099
051400                WHEN ASC-LABEL-PRINTER                            05130099
051500                   MOVE ASC-PRTR-CLUSTR-NBR   TO APCLNBRO         05140099
051600                WHEN ASC-LINE-PRINTER                             05150099
051700                   MOVE SPACES                TO APCLNBRO         05160099
051800             END-EVALUATE                                         05170099
051900             MOVE ASC-PAPR-TRK-QTY            TO ANBRTRKO         05180099
052000                                                                  05190099
052100         WHEN OTHER                                               05200004
052200             SET DP013-LOGIC-ABEND TO TRUE                        05210004
052300             SET DP013-NO-ROLLBACK TO TRUE                        05220004
052400             MOVE '1000-CONTROL-PROCESSING'                       05230004
052500                                   TO DP013-PARAGRAPH             05240004
052600             MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'    05250099
052700                                   TO DP013-MESSAGE-TEXT(1)       05260004
052800             MOVE DP020-NEXT-APPL-ACTIVITY                        05270004
052900                                   TO DP013-MESSAGE-TEXT(2)       05280004
053000             PERFORM DP013-0000-PROCESS-ABEND                     05290004
053100     END-EVALUATE.                                                05300004
053200*                                                                 05310099
053300*                                                                 05320099
053400******************************************************************05330004
053500** DETERMINE THE KEY OF THE OBJECT TO BE UPDATED BASED ON THE   **05340004
053600** INTER-APPLICATION FORMAT CODE.                               **05350004
053700******************************************************************05360004
053800 1100-PROCESS-INTER-APPL-COMM.                                    05370099
053900     INITIALIZE ASC-SPECIFIC-COMMAREA.                            05380004
054000     MOVE DP020-INT-APPL-FORMAT-IND                               05390004
054100                                   TO ASC-INT-APPL-FORMAT-IND.    05400004
054200                                                                  05410099
054300     SET PS-COMMAREA-VALID         TO TRUE.                       05420099
054400                                                                  05430099
054500*WHEN COMING FROM CRIT SPEC (CNKCS214- F13=ADDPRTR)               05440099
054600     EVALUATE ASC-INT-APPL-FORMAT-IND                             05450099
054700         WHEN PC-INTER-APPL-CRIT-SPEC-ADD                         05460099
054800             MOVE CN161-OPER-UNT-ID       TO ASC-OPER-UNT-ID      05470099
054900             MOVE CN161-FCLTY-ID          TO ASC-FCLTY-ID         05480099
055000             MOVE CN161-FCLTY-NME         TO ASC-FCLTY-NME        05490099
055100             MOVE CN161-PRINTER-ID        TO ASC-PRTR-ID          05500099
055200                                             PV-INP-PRTR-ID       05510099
055300             MOVE CN161-PRINTER-ID-SW     TO ASC-PRTR-ID-SW       05520099
055400                                                                  05530099
055500                                                                  05540099
055600*WHEN COMING FROM CRIT SPEC (CNKCS214- F15=UPDPRTR)               05550099
055700         WHEN PC-INTER-APPL-CRIT-SPEC-UPD                         05560099
055800             MOVE CN161-OPER-UNT-ID       TO ASC-OPER-UNT-ID      05570099
055900             MOVE CN161-FCLTY-ID          TO ASC-FCLTY-ID         05580099
056000             MOVE CN161-FCLTY-NME         TO ASC-FCLTY-NME        05590099
056100             MOVE CN161-PRINTER-ID        TO ASC-PRTR-ID          05600099
056200                                             PV-INP-PRTR-ID       05610099
056300             MOVE CN161-PRINTER-ID-SW     TO ASC-PRTR-ID-SW       05620099
056400                                                                  05630099
056500             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   05640099
056600             PERFORM 3010-FIND-PRINTER-ID-ON-TBL                  05650099
056700             PERFORM 3040-GET-NBR-TRKS-FROM-TBL                   05660099
056800                                                                  05670099
056900*GET STOCK TYPE BASED ON NUMBER OF TRACKS                         05680099
057000             MOVE ASC-PRTR-ID          TO DK-PRTR-ID              05690099
057100             MOVE ASC-OPER-UNT-ID      TO DK-PRTR-OPER-UNT-ID     05691099
057200             PERFORM 4010-OPEN-CURSOR                             05700099
057300             PERFORM 4310-FETCH                                   05710099
057400                UNTIL PS-EOF-STK-TYP-CURSOR                       05720099
057500             PERFORM 4020-CLOSE-CURSOR                            05730099
057600                                                                  05740099
057700                                                                  05750099
057800*WHEN COMING FROM PRINTER ADD LIST SCREEN (CNKCS215)              05760099
057900         WHEN PC-INTER-APPL-LIST-ADD                              05770099
058000             SET ASC-USE-SELECTION-QUEUE TO TRUE                  05780099
058100             MOVE CN162-NUMBER-OF-SELECTED-ITEMS                  05790099
058200                                   TO ASC-NUMBER-OF-SELECTED-ITEMS05800099
058300             MOVE CN162-NUMBER-OF-TS-ITEMS                        05810099
058400                                   TO ASC-NUMBER-OF-TS-ITEMS      05820099
058500             MOVE CN162-SEL-QUEUE-NAME                            05830099
058600                                   TO ASC-SEL-QUEUE-NAME          05840099
058700             MOVE CN162-OPER-UNT-ID TO ASC-OPER-UNT-ID            05850099
058800             MOVE CN162-FCLTY-ID TO ASC-FCLTY-ID                  05860099
058900             MOVE CN162-FCLTY-NME TO ASC-FCLTY-NME                05870099
059000             PERFORM 4500-MOVE-COMMAREA-TO-TEMP                   05880099
059100                                                                  05890099
059200                                                                  05900099
059300*WHEN COMING FROM PRINTER UPDATE LIST SCREEN (CNKCS215)           05910099
059400         WHEN PC-INTER-APPL-LIST-UPDATE                           05920099
059500           IF CN162-NUMBER-OF-SELECTED-ITEMS > 0                  05930099
059600             SET ASC-USE-SELECTION-QUEUE TO TRUE                  05940099
059700             MOVE CN162-NUMBER-OF-SELECTED-ITEMS                  05950099
059800                                   TO ASC-NUMBER-OF-SELECTED-ITEMS05960099
059900             MOVE CN162-NUMBER-OF-TS-ITEMS                        05970099
060000                                   TO ASC-NUMBER-OF-TS-ITEMS      05980099
060100             MOVE CN162-SEL-QUEUE-NAME                            05990099
060200                                   TO ASC-SEL-QUEUE-NAME          06000099
060300             MOVE CN162-OPER-UNT-ID TO ASC-OPER-UNT-ID            06010099
060400             MOVE CN162-FCLTY-ID TO ASC-FCLTY-ID                  06020099
060500             MOVE CN162-FCLTY-NME TO ASC-FCLTY-NME                06030099
060600             MOVE 'UPD' TO  ASC-ACTION-SW                         06040099
060700             PERFORM 1120-PREPARE-LIST-ENTRY                      06050099
060800             PERFORM 4500-MOVE-COMMAREA-TO-TEMP                   06060099
060900             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   06070099
061000             PERFORM 3010-FIND-PRINTER-ID-ON-TBL                  06080099
061100             PERFORM 3040-GET-NBR-TRKS-FROM-TBL                   06090099
061200                                                                  06100099
061300*GET STOCK TYPE BASED ON NUMBER OF TRACKS                         06110099
061400             MOVE ASC-PRTR-ID          TO DK-PRTR-ID              06120099
061500             MOVE ASC-OPER-UNT-ID      TO DK-PRTR-OPER-UNT-ID     06121099
061600             PERFORM 4010-OPEN-CURSOR                             06130099
061700             PERFORM 4310-FETCH                                   06140099
061800                UNTIL PS-EOF-STK-TYP-CURSOR                       06150099
061900             PERFORM 4020-CLOSE-CURSOR                            06160099
062000           ELSE                                                   06170099
062100              MOVE PC-TSYMSG-00057       TO DP020-MSG-NUMBER      06180099
062200              SET  PS-COMMAREA-NOT-VALID TO TRUE                  06190099
062300           END-IF                                                 06200099
062400                                                                  06210099
062500*WHEN COMING FROM PRINTER DELETE LIST SCREEN (CNKCS215)           06220099
062600         WHEN PC-INTER-APPL-LIST-DELETE                           06230099
062700           IF CN162-NUMBER-OF-SELECTED-ITEMS > 0                  06240099
062800             SET ASC-USE-SELECTION-QUEUE TO TRUE                  06250099
062900             MOVE CN162-NUMBER-OF-SELECTED-ITEMS                  06260099
063000                                   TO ASC-NUMBER-OF-SELECTED-ITEMS06270099
063100             MOVE CN162-NUMBER-OF-TS-ITEMS                        06280099
063200                                   TO ASC-NUMBER-OF-TS-ITEMS      06290099
063300             MOVE CN162-SEL-QUEUE-NAME                            06300099
063400                                   TO ASC-SEL-QUEUE-NAME          06310099
063500             MOVE CN162-OPER-UNT-ID TO ASC-OPER-UNT-ID            06320099
063600             MOVE CN162-FCLTY-ID TO ASC-FCLTY-ID                  06330099
063700             MOVE CN162-FCLTY-NME TO ASC-FCLTY-NME                06340099
063800             MOVE 'DEL' TO  ASC-ACTION-SW                         06350099
063900             PERFORM 1120-PREPARE-LIST-ENTRY                      06360099
064000             PERFORM 4500-MOVE-COMMAREA-TO-TEMP                   06370099
064100             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   06380099
064200             PERFORM 3010-FIND-PRINTER-ID-ON-TBL                  06390099
064300             PERFORM 3040-GET-NBR-TRKS-FROM-TBL                   06400099
064400                                                                  06410099
064500*GET STOCK TYPE BASED ON NUMBER OF TRACKS                         06420099
064600             MOVE ASC-PRTR-ID          TO DK-PRTR-ID              06430099
064700             MOVE ASC-OPER-UNT-ID      TO DK-PRTR-OPER-UNT-ID     06431099
064800             PERFORM 4010-OPEN-CURSOR                             06440099
064900             PERFORM 4310-FETCH                                   06450099
065000                UNTIL PS-EOF-STK-TYP-CURSOR                       06460099
065100             PERFORM 4020-CLOSE-CURSOR                            06470099
065200           ELSE                                                   06480099
065300             MOVE PC-TSYMSG-00057       TO DP020-MSG-NUMBER       06490099
065400             SET  PS-COMMAREA-NOT-VALID TO TRUE                   06500099
065500           END-IF                                                 06510099
065600     END-EVALUATE.                                                06520099
065700*                                                                 06530099
065800*                                                                 06540099
065900*----------------------------------------------------------------*06550099
066000* ENTRY IS FROM A LIST.  GET THE MESSAGE NUMBER FROM THE TEMP    *06560099
066100* STORAGE QUEUE PASSED FROM THE LIST.                            *06570099
066200*----------------------------------------------------------------*06580099
066300 1120-PREPARE-LIST-ENTRY.                                         06590099
066400     MOVE CN163-MAX-ITEMS          TO ASC-SEL-SUB.                06600099
066500     MOVE ZERO                     TO ASC-SEL-ITEM.               06610099
066600     PERFORM 1130-GET-NEXT-RECORD.                                06620099
066700*                                                                 06630099
066800*                                                                 06640099
066900*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*06650099
067000*    GET THE NEXT RECORD IF A LIST OF RECORDS ARE BEING PROCESSED*06660099
067100*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*06670099
067200 1130-GET-NEXT-RECORD.                                            06680099
067300     ADD +1                        TO ASC-SEL-SUB.                06690099
067400                                                                  06700099
067500     SET ASC-UPDATE-TSQ TO TRUE.                                  06710099
067600                                                                  06720099
067700     IF  ASC-SEL-SUB > CN163-MAX-ITEMS                            06730099
067800         ADD +1                    TO ASC-SEL-ITEM                06740099
067900         MOVE +1                   TO ASC-SEL-SUB                 06750099
068000     END-IF.                                                      06760099
068100                                                                  06770099
068200     IF  ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                06780099
068300         PERFORM 9100-READ-SEL-QUEUE                              06790099
068400         IF  CN163-ITEM (ASC-SEL-SUB) > ZERO                      06800099
068500             MOVE CN163-PRTR-ID        (ASC-SEL-SUB)              06810099
068600                                   TO ASC-PRTR-ID                 06820099
068700             MOVE CN163-CLUSTR-NBR     (ASC-SEL-SUB)              06830099
068800                                   TO ASC-PRTR-CLUSTR-NBR         06840099
068900             MOVE CN163-PRTR-TYP-CDE   (ASC-SEL-SUB)              06850099
069000                                   TO ASC-PRTR-TYP-CDE            06860099
069100             MOVE CN163-PRTR-LOC-DESC  (ASC-SEL-SUB)              06870099
069200                                   TO ASC-PRTR-LOC-DESC           06880099
069300             MOVE CN163-PRTR-PHY-STAT-CDE (ASC-SEL-SUB)           06890099
069400                                   TO ASC-PRTR-STATUS-CDE         06900099
069500             MOVE CN163-CLUSTR-NULL-SW (ASC-SEL-SUB)              06910099
069600                                   TO ASC-NULL-CLUSTER-SW         06920099
069700                                                                  06930099
069800             SET CN163-INQ (ASC-SEL-SUB) TO TRUE                  06940099
069900             PERFORM 9200-REWRITE-SEL-QUEUE                       06950099
070000         ELSE                                                     06960099
070100             SUBTRACT +1 FROM ASC-SEL-SUB                         06970099
070200             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            06980099
070300             SET DP020-MSG-INFORMATIONAL                          06990099
070400                 PS-LIST-END       TO TRUE                        07000099
070500         END-IF                                                   07010099
070600     ELSE                                                         07020099
070700         SUBTRACT +1 FROM ASC-SEL-ITEM                            07030099
070800         MOVE CN163-MAX-ITEMS      TO ASC-SEL-SUB                 07040099
070900         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            07050099
071000         SET DP020-MSG-INFORMATIONAL                              07060099
071100                 PS-LIST-END       TO TRUE                        07070099
071200     END-IF.                                                      07080099
071300*                                                                 07090099
071400*                                                                 07100099
071500******************************************************************07110099
071600*  GET THE PREVIOUS RECORD IF A LIST OF RECORDS ARE BEING         07120099
071700*  PROCESSED.                                                     07130099
071800******************************************************************07140099
071900 1140-GET-PREV-RECORD.                                            07150099
072000     SUBTRACT +1 FROM ASC-SEL-SUB.                                07160099
072100                                                                  07170099
072200     IF  ASC-SEL-SUB < +1                                         07180099
072300         SUBTRACT +1 FROM ASC-SEL-ITEM                            07190099
072400         MOVE CN163-MAX-ITEMS      TO ASC-SEL-SUB                 07200099
072500     END-IF.                                                      07210099
072600                                                                  07220099
072700     IF  ASC-SEL-ITEM > ZERO                                      07230099
072800         PERFORM 9100-READ-SEL-QUEUE                              07240099
072900         IF  CN163-ITEM (ASC-SEL-SUB) > ZERO                      07250099
073000             MOVE CN163-PRTR-ID        (ASC-SEL-SUB)              07260099
073100                                   TO ASC-PRTR-ID                 07270099
073200             MOVE CN163-CLUSTR-NBR     (ASC-SEL-SUB)              07280099
073300                                   TO ASC-PRTR-CLUSTR-NBR         07290099
073400             MOVE CN163-PRTR-TYP-CDE   (ASC-SEL-SUB)              07300099
073500                                   TO ASC-PRTR-TYP-CDE            07310099
073600             MOVE CN163-PRTR-LOC-DESC  (ASC-SEL-SUB)              07320099
073700                                   TO ASC-PRTR-LOC-DESC           07330099
073800             MOVE CN163-PRTR-PHY-STAT-CDE (ASC-SEL-SUB)           07340099
073900                                   TO ASC-PRTR-STATUS-CDE         07350099
074000             MOVE CN163-CLUSTR-NULL-SW (ASC-SEL-SUB)              07360099
074100                                   TO ASC-NULL-CLUSTER-SW         07370099
074200         END-IF                                                   07380099
074300                                                                  07390099
074400         SET CN163-INQ (ASC-SEL-SUB) TO TRUE                      07400099
074500         PERFORM 9200-REWRITE-SEL-QUEUE                           07410099
074600     ELSE                                                         07420099
074700         MOVE +1                   TO ASC-SEL-ITEM                07430099
074800                                      ASC-SEL-SUB                 07440099
074900         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            07450099
075000         SET DP020-MSG-INFORMATIONAL                              07460099
075100             PS-LIST-END             TO TRUE                      07470099
075200     END-IF.                                                      07480099
075300*                                                                 07490099
075400*                                                                 07500099
075500*----------------------------------------------------------------*07510099
075600* DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA   *07520099
075700* ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *07530099
075800* USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *07540099
075900* OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *07550099
076000* FUNCTION KEYS CAN GET THIS FAR.                                *07560099
076100*----------------------------------------------------------------*07570099
076200 2000-PROCESS-PANEL.                                              07580099
076300                                                                  07590099
076400     EVALUATE TRUE                                                07600099
076500                                                                  07610099
076600         WHEN DP020-SRC-AID = DP016-CLEAR                         07620099
076700             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 07630099
076800             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   07640099
076900                                                                  07650099
077000*F5 REFRESH - CLEAR ALL FIELDS EXCEPT OPER UNIT ID,               07660099
077100*CLEAR ALL FIELDS EXCEPT OPER UNT ID, FCLTY NAME & FCLTY ID       07670099
077200         WHEN DP020-FK-REFRESH(DP020-SRC-AID)                     07680099
077300             MOVE ASC-OPER-UNT-ID TO PV-OPER-UNT-ID               07690099
077400             MOVE ASC-FCLTY-NME   TO PV-FCLTY-NME                 07700099
077500             MOVE ASC-FCLTY-ID    TO PV-FCLTY-ID                  07710099
077600*LMM         INITIALIZE ASC-SPECIFIC-COMMAREA                     07720099
077700             MOVE PV-OPER-UNT-ID  TO ASC-OPER-UNT-ID              07730099
077800             MOVE PV-FCLTY-NME    TO ASC-FCLTY-NME                07740099
077900             MOVE PV-FCLTY-ID     TO ASC-FCLTY-ID                 07750099
078000                                                                  07760099
078100             PERFORM 4000-BUILD-INITIAL-PANEL                     07770099
078200*LMM         PERFORM 3200-RESET-ATTRIBUTES                        07780099
078300                                                                  07790099
078400*F20-NEXT SEL                                                     07800099
078500         WHEN DP020-FK-NEXT-SELECTION (DP020-SRC-AID)             07810099
078600             IF  ASC-USE-SELECTION-QUEUE                          07820099
078700                 PERFORM 1130-GET-NEXT-RECORD                     07830099
078800                 PERFORM 4500-MOVE-COMMAREA-TO-TEMP               07840099
078900                 PERFORM 3010-FIND-PRINTER-ID-ON-TBL              07850099
079000                 PERFORM 3000-EDIT-DATA-IN-COMMAREA               07860099
079100                 PERFORM 4600-MOVE-TEMP-TO-COMMAREA               07870099
079200                 IF PS-LIST-END                                   07880099
079300                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         07890099
079400                     SET PS-NO-LIST-END TO TRUE                   07900099
079500                 ELSE                                             07910099
079600                     PERFORM 4000-BUILD-INITIAL-PANEL             07920099
079700                     PERFORM 3200-RESET-ATTRIBUTES                07930099
079800                 END-IF                                           07940099
079900             ELSE                                                 07950099
080000*                --- BOTTOM OF LIST ---                           07960099
080100                 MOVE PC-TSYMSG-00070                             07970099
080200                                   TO DP020-MSG-NUMBER            07980099
080300                 SET DP020-MSG-INFORMATIONAL                      07990099
080400                                   TO TRUE                        08000099
080500             END-IF                                               08010099
080600                                                                  08020099
080700*F19-PREV SEL                                                     08030099
080800         WHEN DP020-FK-PREV-SELECTION (DP020-SRC-AID)             08040099
080900             IF  ASC-USE-SELECTION-QUEUE                          08050099
081000                 PERFORM 1140-GET-PREV-RECORD                     08060099
081100                 PERFORM 4500-MOVE-COMMAREA-TO-TEMP               08070099
081200                 PERFORM 3010-FIND-PRINTER-ID-ON-TBL              08080099
081300                 PERFORM 3000-EDIT-DATA-IN-COMMAREA               08090099
081400                 PERFORM 4600-MOVE-TEMP-TO-COMMAREA               08100099
081500                 IF PS-LIST-END                                   08110099
081600                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         08120099
081700                     SET PS-NO-LIST-END                           08130099
081800                                   TO TRUE                        08140099
081900                 ELSE                                             08150099
082000                     PERFORM 4000-BUILD-INITIAL-PANEL             08160099
082100                     PERFORM 3200-RESET-ATTRIBUTES                08170099
082200                 END-IF                                           08180099
082300             ELSE                                                 08190099
082400                 MOVE PC-TSYMSG-00069                             08200099
082500                                   TO DP020-MSG-NUMBER            08210099
082600                 SET DP020-MSG-INFORMATIONAL                      08220099
082700                                   TO TRUE                        08230099
082800             END-IF                                               08240099
082900                                                                  08250099
083000         WHEN OTHER                                               08260099
083100             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 08270099
083200             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   08280099
083300             IF  PS-NO-ERROR                                      08290099
083400                 SET DP030-CONTINUE-GO                            08300099
083500                                   TO TRUE                        08310099
083600                 PERFORM 4500-MOVE-COMMAREA-TO-TEMP               08320099
083700                 PERFORM 2100-CHECK-FUNCTION-KEY                  08330099
083800                 PERFORM 4600-MOVE-TEMP-TO-COMMAREA               08340099
083900                 IF DP020-SRC-AID = DP016-ENTER                   08350099
084000                    CONTINUE                                      08360099
084100                 ELSE                                             08370099
084200                    PERFORM 4400-MOVE-COMMAREA-TO-SCREEN          08380099
084300                 END-IF                                           08390099
084400             ELSE                                                 08400099
084500                 SET DP030-OVERRIDE-GO                            08410099
084600                                   TO TRUE                        08420099
084700             END-IF                                               08430099
084800     END-EVALUATE.                                                08440099
084900*                                                                 08450099
085000*                                                                 08460099
085100*----------------------------------------------------------------*08470099
085200* ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED       *08480099
085300* FIRST.  NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED   *08490099
085400* FROM THE CICS ARCHITECTURE API.                                *08500099
085500*----------------------------------------------------------------*08510099
085600 2100-CHECK-FUNCTION-KEY.                                         08520099
085700     EVALUATE TRUE                                                08530099
085800         WHEN DP020-SRC-AID = DP016-ENTER                         08540099
085900             PERFORM 3010-FIND-PRINTER-ID-ON-TBL                  08550099
086000             PERFORM 3040-GET-NBR-TRKS-FROM-TBL                   08560099
086100             MOVE ASC-PRTR-ID          TO DK-PRTR-ID              08570099
086200             MOVE ASC-OPER-UNT-ID      TO DK-PRTR-OPER-UNT-ID     08571099
086300             PERFORM 4010-OPEN-CURSOR                             08580099
086400             PERFORM 4310-FETCH                                   08590099
086500                UNTIL PS-EOF-STK-TYP-CURSOR                       08600099
086600             PERFORM 4020-CLOSE-CURSOR                            08610099
086700             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 08620099
086800                                                                  08630099
086900*--------F13=ADD PRINTER ID                                       08640099
087000         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              08650099
087100             SET DP020-MSG-INFORMATIONAL TO TRUE                  08660099
087200             PERFORM 3010-FIND-PRINTER-ID-ON-TBL                  08670099
087300                                                                  08680099
087400             IF ASC-PRTR-ID-NOT-EXISTS                            08690099
087500                PERFORM 5000-PROCESS-ADD                          08700099
087600             END-IF                                               08710099
087700                                                                  08720099
087800*--------F15=UPDATE PRINTER ID                                    08730099
087900         WHEN DP020-FK-LOCAL-FUNC-07 (DP020-SRC-AID)              08740099
088000             SET DP020-MSG-INFORMATIONAL TO TRUE                  08750099
088100             PERFORM 3010-FIND-PRINTER-ID-ON-TBL                  08760099
088200             PERFORM 4600-MOVE-TEMP-TO-COMMAREA                   08770099
088300                                                                  08780099
088400             IF ASC-ACTION-SW = 'UPD'                             08790099
088500                 PERFORM 9100-READ-SEL-QUEUE                      08800099
088600                 SET CN163-UPD (ASC-SEL-SUB) TO TRUE              08810099
088700                 MOVE ASC-PRTR-CLUSTR-NBR                         08820099
088800                        TO CN163-CLUSTR-NBR (ASC-SEL-SUB)         08830099
088900                 MOVE ASC-PRTR-TYP-CDE                            08840099
089000                        TO CN163-PRTR-TYP-CDE (ASC-SEL-SUB)       08850099
089100                 MOVE ASC-PRTR-LOC-DESC                           08860099
089200                        TO CN163-PRTR-LOC-DESC (ASC-SEL-SUB)      08870099
089300                 MOVE ASC-PRTR-STATUS-CDE                         08880099
089400                        TO CN163-PRTR-PHY-STAT-CDE (ASC-SEL-SUB)  08890099
089500                 MOVE ASC-NULL-CLUSTER-SW                         08900099
089600                        TO CN163-CLUSTR-NULL-SW (ASC-SEL-SUB)     08910099
089700                 PERFORM 9200-REWRITE-SEL-QUEUE                   08920099
089800             END-IF                                               08930099
089900                                                                  08940099
090000             IF ASC-PRTR-ID-EXISTS                                08950099
090100                PERFORM 5100-PROCESS-UPDATE                       08960099
090200             END-IF                                               08970099
090300                                                                  08980099
090400*--------F16=DELETE PRINTER ID                                    08990099
090500         WHEN DP020-FK-LOCAL-FUNC-06 (DP020-SRC-AID)              09000099
090600             SET DP020-MSG-INFORMATIONAL TO TRUE                  09010099
090700             PERFORM 3010-FIND-PRINTER-ID-ON-TBL                  09020099
090800                                                                  09030099
090900             IF ASC-ACTION-SW = 'DEL'                             09040099
091000                 PERFORM 9100-READ-SEL-QUEUE                      09050099
091100                 SET CN163-DEL (ASC-SEL-SUB) TO TRUE              09060099
091200                 PERFORM 9200-REWRITE-SEL-QUEUE                   09070099
091300             END-IF                                               09080099
091400                                                                  09090099
091500             IF ASC-PRTR-ID-EXISTS                                09100099
091600                SET PS-ERROR                TO TRUE               09110099
091700                SET DP020-MSG-FATAL         TO TRUE               09120099
091800                MOVE PC-TSYMSG-00354        TO DP020-MSG-NUMBER   09130099
091900                MOVE -1                     TO APRTIDL            09140099
092000                SET DP030-SET-CURSOR-APPL-1 TO TRUE               09150099
092100             END-IF                                               09160099
092200                                                                  09170099
092300*--------F2=CONFIRM                                               09180099
092400         WHEN DP020-FK-CONFIRM (DP020-SRC-AID)                    09190099
092500             PERFORM 5200-PROCESS-DELETE                          09200099
092600                                                                  09210099
092700                                                                  09220099
092800*--------F17=PRTTYPLS -- PRINTER TYPE LIST                        09230099
092900         WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              09240099
093000             CONTINUE                                             09250099
093100                                                                  09260099
093200                                                                  09270099
093300*--------F23=STKTYLST -- STOCK TYPE LIST                          09280099
093400         WHEN DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID)              09290099
093500             CONTINUE                                             09300099
093600                                                                  09310099
093700                                                                  09320099
093800*--------F24=CLSTRLST -- CLUSTER LIST                             09330099
093900         WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)              09340099
094000             CONTINUE                                             09350099
094100                                                                  09360099
094200         WHEN OTHER                                               09370099
094300             SET DP013-NO-ROLLBACK                                09380099
094400                 DP013-XCTL-DISPLAY-RESTART                       09390099
094500                 DP013-CICS-ABEND TO TRUE                         09400099
094600             MOVE '2000-PROCESS-PANEL'                            09410099
094700                                   TO DP013-PARAGRAPH             09420099
094800             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      09430099
094900                                   TO DP013-MESSAGE-TEXT (1)      09440099
095000             PERFORM DP013-0000-PROCESS-ABEND                     09450099
095100     END-EVALUATE.                                                09460099
095200*                                                                 09470099
095300*                                                                 09480099
095400*----------------------------------------------------------------*09490099
095500* MOVE DATA ENTERED ON THE SCREEN INTO THEIR RESPECTIVE FIELDS   *09500099
095600* IN THE APPLICATION-SPECIFIC COMMAREA.  ALL EDITS ARE DONE IN   *09510099
095700* THE APPLICATION-SPECIFIC COMMAERA, NOT ON THE SCREEN.          *09520099
095800* THIS PARAGRAPH DOES NOT USE TEMPORARY VARIABLES.               *09530099
095900*----------------------------------------------------------------*09540099
096000 2200-MOVE-SCREEN-TO-COMMAREA.                                    09550099
096100*PRINTER ID                                                       09560099
096200         IF  APRTIDL > ZERO                                       09570099
096300             MOVE APRTIDI             TO ASC-PRTR-ID              09580099
096400                                         PV-INP-PRTR-ID           09590099
096500         ELSE                                                     09600099
096600             IF  APRTIDF = DP015-ERASE-EOF                        09610099
096700                 MOVE SPACE            TO ASC-PRTR-ID             09620099
096800             END-IF                                               09630099
096900         END-IF                                                   09640099
097000                                                                  09650099
097100*PRINTER CLUSTER NUMBER                                           09660099
097200         IF  APCLNBRL > ZERO                                      09670099
097300             MOVE APCLNBRI             TO ASC-PRTR-CLUSTR-NBR     09680099
097400         ELSE                                                     09690099
097500             IF  APCLNBRF = DP015-ERASE-EOF                       09700099
097600                 MOVE ZERO             TO ASC-PRTR-CLUSTR-NBR     09710099
097700             END-IF                                               09720099
097800         END-IF                                                   09730099
097900                                                                  09740099
098000*PRINTER TYPE CODE                                                09750099
098100         IF  ATYPCDEL > ZERO                                      09760099
098200             MOVE ATYPCDEI             TO ASC-PRTR-TYP-CDE        09770099
098300         ELSE                                                     09780099
098400             IF  ATYPCDEF = DP015-ERASE-EOF                       09790099
098500                 MOVE ZERO             TO ASC-PRTR-TYP-CDE        09800099
098600             END-IF                                               09810099
098700         END-IF                                                   09820099
098800                                                                  09830099
098900*PRINTER LOCATION DESC                                            09840099
099000         IF  ALCDESCL > ZERO                                      09850099
099100             MOVE ALCDESCI             TO ASC-PRTR-LOC-DESC       09860099
099200         ELSE                                                     09870099
099300             IF  ALCDESCF = DP015-ERASE-EOF                       09880099
099400                 MOVE SPACE            TO ASC-PRTR-LOC-DESC       09890099
099500             END-IF                                               09900099
099600         END-IF                                                   09910099
099700                                                                  09920099
099800*PRINTER STATUS CODE                                              09930099
099900         IF  APSTCDEL > ZERO                                      09940099
100000             MOVE APSTCDEI             TO ASC-PRTR-STATUS-CDE     09950099
100100         ELSE                                                     09960099
100200             IF  APSTCDEF = DP015-ERASE-EOF                       09970099
100300                 MOVE SPACE            TO ASC-PRTR-STATUS-CDE     09980099
100400             END-IF                                               09990099
100500         END-IF                                                   10000099
100600                                                                  10010099
100700*NUMBER OF TRACKS                                                 10020099
100800         IF  ANBRTRKL > ZERO                                      10030099
100900             MOVE ANBRTRKI             TO ASC-PAPR-TRK-QTY        10040099
101000                                          DK-PAPR-TRK-QTY         10050099
101100         ELSE                                                     10060099
101200             IF  ANBRTRKF = DP015-ERASE-EOF                       10070099
101300                 MOVE ZERO             TO ASC-PAPR-TRK-QTY        10080099
101400                                          DK-PAPR-TRK-QTY         10090099
101500             END-IF                                               10100099
101600         END-IF                                                   10110099
101700                                                                  10120099
101800*STOCK TYPE FOR TRACK 0                                           10130099
101900         IF  ASTKTYP0L > ZERO                                     10140099
102000             MOVE ASTKTYP0I            TO ASC-STK-TYP-CDE0        10150099
102100         ELSE                                                     10160099
102200             IF  ASTKTYP0F = DP015-ERASE-EOF                      10170099
102300                 MOVE SPACE            TO ASC-STK-TYP-CDE0        10180099
102400             END-IF                                               10190099
102500         END-IF                                                   10200099
102600                                                                  10210099
102700*STOCK TYPE FOR TRACK 1                                           10220099
102800         IF  ASTKTYP1L > ZERO                                     10230099
102900             MOVE ASTKTYP1I            TO ASC-STK-TYP-CDE1        10240099
103000         ELSE                                                     10250099
103100             IF  ASTKTYP1F = DP015-ERASE-EOF                      10260099
103200                 MOVE SPACE            TO ASC-STK-TYP-CDE1        10270099
103300             END-IF                                               10280099
103400         END-IF                                                   10290099
103500                                                                  10300099
103600*STOCK TYPE FOR TRACK 2                                           10310099
103700         IF  ASTKTYP2L > ZERO                                     10320099
103800             MOVE ASTKTYP2I            TO ASC-STK-TYP-CDE2        10330099
103900         ELSE                                                     10340099
104000             IF  ASTKTYP2F = DP015-ERASE-EOF                      10350099
104100                 MOVE SPACE            TO ASC-STK-TYP-CDE2        10360099
104200             END-IF.                                              10370099
104300*                                                                 10380099
104400*                                                                 10390099
104500*----------------------------------------------------------------*10400099
104600* PERFORM EDITS ON EACH FIELD ENTERED BY THE USER.  IF AN ERROR  *10410099
104700* IS FOUND, THE CURSOR IS POSITIONED AT THAT FIELD AND AN        *10420099
104800* APPROPRIATE ERROR MESSAGE IS DISPLAYED.                        *10430099
104900*----------------------------------------------------------------*10440099
105000 3000-EDIT-DATA-IN-COMMAREA.                                      10450099
105100     PERFORM 3200-RESET-ATTRIBUTES.                               10460099
105200*                                                                 10470099
105300*-----------------------------------------------------------------10480099
105400* PRINTER ID                                                      10490099
105500* NOTE:  NUMERIC EDIT DONE ON PRINTER ID TO DETERMINE IF LINE     10500099
105600*        PRINTER OR LABEL PRINTER                                 10510099
105700*-----------------------------------------------------------------10520099
105800     IF  ASC-PRTR-ID = SPACES                                     10530099
105900         IF  DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)               10540099
106000             SET PS-ERROR                TO TRUE                  10550099
106100             SET DP020-MSG-FATAL         TO TRUE                  10560099
106200             MOVE PC-TSYMSG-00007        TO DP020-MSG-NUMBER      10570099
106300             MOVE DP015-UNP-ALP-BRT-OFF  TO APRTIDA               10580099
106400             MOVE DP015-RED              TO APRTIDC               10590099
106500             MOVE DP015-REVERSE          TO APRTIDH               10600099
106600             MOVE -1                     TO APRTIDL               10610099
106700             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  10620099
106800         END-IF                                                   10630099
106900     END-IF.                                                      10640099
107000                                                                  10650099
107100     IF  ASC-PRTR-ID >     SPACES OR                              10660099
107200         ASC-PRTR-ID > SPACES AND                                 10670099
107300         (DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)  OR              10680099
107400          DP020-SRC-AID = DP016-ENTER)                            10690099
107500         MOVE ASC-PRTR-ID              TO DP010I-UNEDITED-FIELD   10700099
107600         MOVE LENGTH OF ASC-PRTR-ID                               10710099
107700                                       TO DP010I-MAXIMUM-DIGITS   10720099
107800         MOVE ZERO                     TO DP010I-MAXIMUM-DECIMALS 10730099
107900         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  10740099
263455         CALL DP010I-NUMERIC-EDIT-ROUTINE                                 
263455              USING DP010I-NUMERIC-EDIT-AREA                              
108100         IF  DP010I-ERROR-DETECTED                                10760099
108200             SET ASC-LINE-PRINTER      TO TRUE                    10770099
108300         ELSE                                                     10780099
108400             SET ASC-LABEL-PRINTER     TO TRUE                    10790099
108500         END-IF.                                                  10800099
108600*                                                                 10810099
108700*-----------------------------------------------------------------10820099
108800* PRINTER CLUSTER NBR - FOR LABEL PRINTERS ONLY                   10830099
108900* CLUSTER NUMBER ENTERED MUST BE NUMERIC                          10840099
109000*-----------------------------------------------------------------10850099
109100     IF ASC-PRTR-CLUSTR-NBR  = SPACES                             10860099
109200        AND ASC-LABEL-PRINTER                                     10870099
109300        IF  DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)                10880099
109400            SET PS-ERROR                TO TRUE                   10890099
109500            SET DP020-MSG-FATAL         TO TRUE                   10900099
109600            MOVE PC-TSYMSG-00007        TO DP020-MSG-NUMBER       10910099
109700            MOVE DP015-UNP-ALP-BRT-OFF  TO APCLNBRA               10920099
109800            MOVE DP015-RED              TO APCLNBRC               10930099
109900            MOVE DP015-REVERSE          TO APCLNBRH               10940099
110000            MOVE -1                     TO APCLNBRL               10950099
110100            SET DP030-SET-CURSOR-APPL-1 TO TRUE                   10960099
110200         END-IF                                                   10970099
110300     END-IF.                                                      10980099
110400                                                                  10990099
110500     IF ASC-PRTR-CLUSTR-NBR  = SPACES  AND                        11000099
110600         (DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)  OR              11010099
110700          DP020-SRC-AID = DP016-ENTER) AND                        11020099
110800          ASC-LINE-PRINTER                                        11030099
110900          MOVE LOW-VALUES TO ASC-PRTR-CLUSTR-NBR                  11040099
111000     END-IF                                                       11050099
111100                                                                  11060099
111200     IF  ASC-PRTR-CLUSTR-NBR  >  SPACES   AND                     11070099
111300          ASC-LABEL-PRINTER                                       11080099
111400          MOVE ASC-PRTR-CLUSTR-NBR    TO APCLNBRO                 11090099
111500     END-IF                                                       11100099
111600                                                                  11110099
111700     IF  ASC-PRTR-CLUSTR-NBR  >  SPACES   AND                     11120099
111800          ASC-LABEL-PRINTER AND                                   11130099
111900         (DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)  OR              11140099
112000          DP020-FK-LOCAL-FUNC-07 (DP020-SRC-AID)  OR              11150099
112100          DP020-SRC-AID = DP016-ENTER)                            11160099
112200         MOVE ASC-PRTR-CLUSTR-NBR      TO DP010I-UNEDITED-FIELD   11170099
112300         MOVE LENGTH OF ASC-PRTR-CLUSTR-NBR                       11180099
112400                                       TO DP010I-MAXIMUM-DIGITS   11190099
112500         MOVE ZERO                     TO DP010I-MAXIMUM-DECIMALS 11200099
112600         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  11210099
263455         CALL DP010I-NUMERIC-EDIT-ROUTINE                                 
263455              USING DP010I-NUMERIC-EDIT-AREA                              
112800         IF  DP010I-ERROR-DETECTED                                11230099
112900             SET PS-ERROR                TO TRUE                  11240099
113000             SET DP020-MSG-FATAL         TO TRUE                  11250099
113100             MOVE PC-TSYMSG-00008        TO DP020-MSG-NUMBER      11260099
113200             MOVE DP015-UNP-ALP-BRT-OFF  TO APCLNBRA              11270099
113300             MOVE DP015-RED              TO APCLNBRC              11280099
113400             MOVE DP015-REVERSE          TO APCLNBRH              11290099
113500             MOVE -1                     TO APCLNBRL              11300099
113600             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  11310099
113700         ELSE                                                     11320099
113800             MOVE DP010I-NUMERIC-FIELD                            11330099
113900               TO ASC-PRTR-CLUSTR-NBR-N                           11340099
114000             MOVE ASC-PRTR-CLUSTR-NBR-N  TO APCLNBRO              11350099
114100         END-IF                                                   11360099
114200     ELSE                                                         11370099
114300            IF  ASC-PRTR-CLUSTR-NBR  >  SPACES AND                11380099
114400                ASC-LINE-PRINTER                                  11390099
114500                SET PS-ERROR                TO TRUE               11400099
114600                SET DP020-MSG-FATAL         TO TRUE               11410099
114700                MOVE PC-TSYMSG-02551        TO DP020-MSG-NUMBER   11420099
114800                MOVE DP015-UNP-ALP-BRT-OFF  TO APCLNBRA           11430099
114900                MOVE DP015-RED              TO APCLNBRC           11440099
115000                MOVE DP015-REVERSE          TO APCLNBRH           11450099
115100                MOVE -1                     TO APCLNBRL           11460099
115200                SET DP030-SET-CURSOR-APPL-1 TO TRUE               11470099
115300            ELSE                                                  11480099
115400                IF  ASC-PRTR-CLUSTR-NBR  >  SPACES   AND          11490099
115500                   (DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)  OR    11500099
115600                    DP020-SRC-AID = DP016-ENTER) AND              11510099
115700                    ASC-LINE-PRINTER                              11520099
115800                    MOVE LOW-VALUES TO ASC-PRTR-CLUSTR-NBR        11530099
115900                END-IF                                            11540099
116000            END-IF                                                11550099
116100     END-IF.                                                      11560099
116200*                                                                 11570099
116300*-----------------------------------------------------------------11580099
116400*PRINTER TYPE CODE                                                11590099
116500*-----------------------------------------------------------------11600099
116600     IF  ASC-PRTR-TYP-CDE  = SPACES                               11610099
116700         IF  DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)               11620099
116800             SET PS-ERROR                TO TRUE                  11630099
116900             SET DP020-MSG-FATAL         TO TRUE                  11640099
117000             MOVE PC-TSYMSG-00007        TO DP020-MSG-NUMBER      11650099
117100             MOVE DP015-UNP-ALP-BRT-OFF  TO ATYPCDEA              11660099
117200             MOVE DP015-RED              TO ATYPCDEC              11670099
117300             MOVE DP015-REVERSE          TO ATYPCDEH              11680099
117400             MOVE -1                     TO ATYPCDEL              11690099
117500             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  11700099
117600         END-IF                                                   11710099
117700     ELSE                                                         11720099
117800         PERFORM 3030-VALIDATE-PRTR-TYPE-CDE                      11730099
117900     END-IF.                                                      11740099
118000*                                                                 11750099
118100*-----------------------------------------------------------------11760099
118200*PRINTER LOCATION DESC                                            11770099
118300*-----------------------------------------------------------------11780099
118400     IF  ASC-PRTR-LOC-DESC = SPACES                               11790099
118500         IF  DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)               11800099
118600             SET PS-ERROR                TO TRUE                  11810099
118700             SET DP020-MSG-FATAL         TO TRUE                  11820099
118800             MOVE PC-TSYMSG-00007        TO DP020-MSG-NUMBER      11830099
118900             MOVE DP015-UNP-ALP-BRT-OFF  TO ALCDESCA              11840099
119000             MOVE DP015-RED              TO ALCDESCC              11850099
119100             MOVE DP015-REVERSE          TO ALCDESCH              11860099
119200             MOVE -1                     TO ALCDESCL              11870099
119300             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  11880099
119400         END-IF                                                   11890099
119500     END-IF.                                                      11900099
119600                                                                  11910099
119700*-----------------------------------------------------------------11920099
119800*PRINTER STATUS CODE - 'A' OR 'I' ONLY                            11930099
119900*-----------------------------------------------------------------11940099
120000     IF  ASC-PRTR-STATUS-CDE = SPACES                             11950099
120100         IF  DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)               11960099
120200             SET PS-ERROR                TO TRUE                  11970099
120300             SET DP020-MSG-FATAL         TO TRUE                  11980099
120400             MOVE PC-TSYMSG-00007        TO DP020-MSG-NUMBER      11990099
120500             MOVE DP015-UNP-ALP-BRT-OFF  TO APSTCDEA              12000099
120600             MOVE DP015-RED              TO APSTCDEC              12010099
120700             MOVE DP015-REVERSE          TO APSTCDEH              12020099
120800             MOVE -1                     TO APSTCDEL              12030099
120900             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  12040099
121000         END-IF                                                   12050099
121100     END-IF.                                                      12060099
121200                                                                  12070099
121300     IF  ASC-PRTR-STATUS-CDE  >  SPACES                           12080099
121400         EVALUATE TRUE                                            12090099
121500            WHEN ASC-PRTR-STATUS-CDE = 'A'                        12100099
121600               SET ASC-PRTR-STAT-ACTIVE TO TRUE                   12110099
121700               PERFORM 9000-PROCESS-PRTR-STAT-CDE                 12120099
121800            WHEN ASC-PRTR-STATUS-CDE = 'I'                        12130099
121900               SET ASC-PRTR-STAT-INACTIVE TO TRUE                 12140099
122000               PERFORM 9000-PROCESS-PRTR-STAT-CDE                 12150099
122100            WHEN OTHER                                            12160099
122200                 SET PS-ERROR                                     12170099
122300                 DP020-MSG-FATAL             TO TRUE              12180099
122400                 MOVE PC-TSYMSG-00005        TO DP020-MSG-NUMBER  12190099
122500                 MOVE DP015-UNP-ALP-BRT-OFF  TO APSTCDEA          12200099
122600                 MOVE DP015-RED              TO APSTCDEC          12210099
122700                 MOVE DP015-REVERSE          TO APSTCDEH          12220099
122800                 MOVE -1                     TO APSTCDEL          12230099
122900                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              12240099
123000         END-EVALUATE                                             12250099
123100     END-IF.                                                      12260099
123200                                                                  12670099
123300*    IF  ASC-PAPR-TRK-QTY  >  SPACES                              12680099
123400*        EVALUATE TRUE                                            12690099
123500*           WHEN ASC-PAPR-TRK-QTY = '1' OR '0001'                 12700099
123600*              SET ASC-PAPR-TRK-QTY-1 TO TRUE                     12710099
123700*              PERFORM 9050-PROCESS-PAPR-TRK-QTY                  12720099
123800*           WHEN ASC-PAPR-TRK-QTY = '2' OR '0002'                 12730099
123900*              SET ASC-PAPR-TRK-QTY-2 TO TRUE                     12740099
124000*              PERFORM 9050-PROCESS-PAPR-TRK-QTY                  12750099
124100*           WHEN ASC-PAPR-TRK-QTY = '3' OR '0003'                 12760099
124200*              SET ASC-PAPR-TRK-QTY-3 TO TRUE                     12770099
124300*              PERFORM 9050-PROCESS-PAPR-TRK-QTY                  12780099
124400*           WHEN OTHER                                            12790099
124500*                SET PS-ERROR                                     12800099
124600*                DP020-MSG-FATAL             TO TRUE              12810099
124700*                MOVE PC-TSYMSG-00005        TO DP020-MSG-NUMBER  12820099
124800*                MOVE DP015-UNP-ALP-BRT-OFF  TO ANBRTRKA          12830099
124900*                MOVE DP015-RED              TO ANBRTRKC          12840099
125000*                MOVE DP015-REVERSE          TO ANBRTRKH          12850099
125100*                MOVE -1                     TO ANBRTRKL          12860099
125200*                SET DP030-SET-CURSOR-APPL-1 TO TRUE              12870099
125300*        END-EVALUATE                                             12880099
125400*    END-IF.                                                      12890099
125500                                                                  12900099
125600                                                                  12910099
125700*-----------------------------------------------------------------12920099
125800* STOCK TYPE                                                      12930099
125900*-----------------------------------------------------------------12940099
126000         EVALUATE TRUE                                            12950099
126100**IF NBR OF TRKS = 1, FILL IN TRACK 0                             12960099
126200           WHEN ASC-PAPR-TRK-QTY-N = 1 AND                        12970099
126300             ( DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID) OR          12980099
126400               DP020-FK-LOCAL-FUNC-07 (DP020-SRC-AID) )           12980099
126500              IF ASC-STK-TYP-CDE0 = SPACES                        12990099
126600                 SET PS-ERROR                TO TRUE              13000099
126700                 SET DP020-MSG-FATAL         TO TRUE              13010099
126800                 MOVE PC-TSYMSG-00007        TO DP020-MSG-NUMBER  13020099
126900                 MOVE DP015-UNP-ALP-BRT-OFF  TO ASTKTYP0A         13030099
127000                 MOVE DP015-RED              TO ASTKTYP0C         13040099
127100                 MOVE DP015-REVERSE          TO ASTKTYP0H         13050099
127200                 MOVE -1                     TO ASTKTYP0L         13060099
127300                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              13070099
127400              ELSE                                                13080099
127500                 PERFORM 3050-VALIDATE-STOCK-TYPE-TRK0            13090099
127600              END-IF                                              13100099
127700                                                                  13110099
127800              IF ASC-STK-TYP-CDE1 > SPACES                        13120099
127900                 SET PS-ERROR                TO TRUE              13130099
128000                 SET DP020-MSG-FATAL         TO TRUE              13140099
128100                 MOVE PC-TSYMSG-00005        TO DP020-MSG-NUMBER  13150099
128200                 MOVE DP015-UNP-ALP-BRT-OFF  TO ASTKTYP1A         13160099
128300                 MOVE DP015-RED              TO ASTKTYP1C         13170099
128400                 MOVE DP015-REVERSE          TO ASTKTYP1H         13180099
128500                 MOVE -1                     TO ASTKTYP1L         13190099
128600                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              13200099
128700              END-IF                                              13210099
128800                                                                  13220099
128900              IF ASC-STK-TYP-CDE2 > SPACES                        13230099
129000                 SET PS-ERROR                TO TRUE              13240099
129100                 SET DP020-MSG-FATAL         TO TRUE              13250099
129200                 MOVE PC-TSYMSG-00005        TO DP020-MSG-NUMBER  13260099
129300                 MOVE DP015-UNP-ALP-BRT-OFF  TO ASTKTYP2A         13270099
129400                 MOVE DP015-RED              TO ASTKTYP2C         13280099
129500                 MOVE DP015-REVERSE          TO ASTKTYP2H         13290099
129600                 MOVE -1                     TO ASTKTYP2L         13300099
129700                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              13310099
129800              END-IF                                              13320099
129900                                                                  13330099
130000**IF NBR OF TRKS = 2, FILL IN TRACKS 0 AND 1                      13340099
130100           WHEN ASC-PAPR-TRK-QTY-N = 2 AND                        13350099
130200            ( DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID) OR           13360099
130300               DP020-FK-LOCAL-FUNC-07 (DP020-SRC-AID))            12980099
130400              IF ASC-STK-TYP-CDE0 = SPACES                        13370099
130500                 SET PS-ERROR                TO TRUE              13380099
130600                 SET DP020-MSG-FATAL         TO TRUE              13390099
130700                 MOVE PC-TSYMSG-00007        TO DP020-MSG-NUMBER  13400099
130800                 MOVE DP015-UNP-ALP-BRT-OFF  TO ASTKTYP0A         13410099
130900                 MOVE DP015-RED              TO ASTKTYP0C         13420099
131000                 MOVE DP015-REVERSE          TO ASTKTYP0H         13430099
131100                 MOVE -1                     TO ASTKTYP0L         13440099
131200                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              13450099
131300              ELSE                                                13460099
131400                 PERFORM 3050-VALIDATE-STOCK-TYPE-TRK0            13470099
131500              END-IF                                              13480099
131600                                                                  13490099
131700              IF ASC-STK-TYP-CDE1 = SPACES                        13500099
131800                 SET PS-ERROR                TO TRUE              13510099
131900                 SET DP020-MSG-FATAL         TO TRUE              13520099
132000                 MOVE PC-TSYMSG-00007        TO DP020-MSG-NUMBER  13530099
132100                 MOVE DP015-UNP-ALP-BRT-OFF  TO ASTKTYP1A         13540099
132200                 MOVE DP015-RED              TO ASTKTYP1C         13550099
132300                 MOVE DP015-REVERSE          TO ASTKTYP1H         13560099
132400                 MOVE -1                     TO ASTKTYP1L         13570099
132500                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              13580099
132600              ELSE                                                13590099
132700                 PERFORM 3051-VALIDATE-STOCK-TYPE-TRK1            13600099
132800              END-IF                                              13610099
132900                                                                  13620099
133000              IF ASC-STK-TYP-CDE2 > SPACES                        13630099
133100                 SET PS-ERROR                TO TRUE              13640099
133200                 SET DP020-MSG-FATAL         TO TRUE              13650099
133300                 MOVE PC-TSYMSG-00005        TO DP020-MSG-NUMBER  13660099
133400                 MOVE DP015-UNP-ALP-BRT-OFF  TO ASTKTYP2A         13670099
133500                 MOVE DP015-RED              TO ASTKTYP2C         13680099
133600                 MOVE DP015-REVERSE          TO ASTKTYP2H         13690099
133700                 MOVE -1                     TO ASTKTYP2L         13700099
133800                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              13710099
133900              END-IF                                              13720099
134000                                                                  13730099
134100**IF NBR OF TRKS = 3, FILL IN TRACKS 0, 1 AND 2                   13740099
134200           WHEN ASC-PAPR-TRK-QTY-N = 3 AND                        13750099
134300            ( DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID) OR           13760099
134400               DP020-FK-LOCAL-FUNC-07 (DP020-SRC-AID))            12980099
134500              IF ASC-STK-TYP-CDE0 = SPACES                        13770099
134600                 SET PS-ERROR                TO TRUE              13780099
134700                 SET DP020-MSG-FATAL         TO TRUE              13790099
134800                 MOVE PC-TSYMSG-00007        TO DP020-MSG-NUMBER  13800099
134900                 MOVE DP015-UNP-ALP-BRT-OFF  TO ASTKTYP0A         13810099
135000                 MOVE DP015-RED              TO ASTKTYP0C         13820099
135100                 MOVE DP015-REVERSE          TO ASTKTYP0H         13830099
135200                 MOVE -1                     TO ASTKTYP0L         13840099
135300                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              13850099
135400              ELSE                                                13860099
135500                 PERFORM 3050-VALIDATE-STOCK-TYPE-TRK0            13870099
135600              END-IF                                              13880099
135700                                                                  13890099
135800              IF ASC-STK-TYP-CDE1 = SPACES                        13900099
135900                 SET PS-ERROR                TO TRUE              13910099
136000                 SET DP020-MSG-FATAL         TO TRUE              13920099
136100                 MOVE PC-TSYMSG-00007        TO DP020-MSG-NUMBER  13930099
136200                 MOVE DP015-UNP-ALP-BRT-OFF  TO ASTKTYP1A         13940099
136300                 MOVE DP015-RED              TO ASTKTYP1C         13950099
136400                 MOVE DP015-REVERSE          TO ASTKTYP1H         13960099
136500                 MOVE -1                     TO ASTKTYP1L         13970099
136600                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              13980099
136700              ELSE                                                13990099
136800                 PERFORM 3051-VALIDATE-STOCK-TYPE-TRK1            14000099
136900              END-IF                                              14010099
137000                                                                  14020099
137100              IF ASC-STK-TYP-CDE2 = SPACES                        14030099
137200                 SET PS-ERROR                TO TRUE              14040099
137300                 SET DP020-MSG-FATAL         TO TRUE              14050099
137400                 MOVE PC-TSYMSG-00007        TO DP020-MSG-NUMBER  14060099
137500                 MOVE DP015-UNP-ALP-BRT-OFF  TO ASTKTYP2A         14070099
137600                 MOVE DP015-RED              TO ASTKTYP2C         14080099
137700                 MOVE DP015-REVERSE          TO ASTKTYP2H         14090099
137800                 MOVE -1                     TO ASTKTYP2L         14100099
137900                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              14110099
138000              ELSE                                                14120099
138100                 PERFORM 3052-VALIDATE-STOCK-TYPE-TRK2            14130099
138200              END-IF                                              14140099
138300         END-EVALUATE.                                            14150099
138400                                                                  14160099
138500*                                                                 14170099
138600*----------------------------------------------------------------*14180099
138700* CHECK TO SEE IF PRINTER ID ENTERED EXISTS ON TABLE              14190099
138800*----------------------------------------------------------------*14200099
138900 3010-FIND-PRINTER-ID-ON-TBL.                                     14210099
139000                                                                  14290099
139100*LMM     MOVE PV-TBL-PRTR-CLUSTR-NBR-N                            14300099
139200*LMM       TO DK-PRTR-CLUSTR-NBR                                  14310099
139300                                                                  14320099
139400         EXEC SQL                                                 14330099
139500             SELECT  PRTR_ID                                      14340099
139600                    ,PRTR_CLUSTR_NBR                              14350099
139700                    ,PRTR_TYP_CDE                                 14360099
139800                    ,PRTR_LOC_DESC                                14370099
139900                    ,PRTR_PHY_STAT_CDE                            14380099
140000               INTO  :PV-TBL-PRTR-ID                              14390099
140100                    ,:DK-PRTR-CLUSTR-NBR :DN-CLUSTER-NBR          14400099
140200                    ,:PV-TBL-PRTR-TYP-CDE                         14410099
140300                    ,:PV-TBL-PRTR-LOC-DESC                        14420099
140400                    ,:PV-TBL-PRTR-PHY-STAT-CDE                    14430099
140500               FROM TPRTRID                                       14440099
140600             WHERE  PRTR_ID          = :ASC-PRTR-ID               14450099
140700               AND  PRTR_OPER_UNT_ID = :ASC-OPER-UNT-ID           14460099
140800               AND  PRTR_FCLTY_ID    = :ASC-FCLTY-ID              14470099
140900         END-EXEC                                                 14480099
141000         EVALUATE TRUE                                            14490099
141100             WHEN SQLCODE = ZERO                                  14500099
141200                 SET ASC-PRTR-ID-EXISTS    TO TRUE                14510099
141300                                                                  14520099
141400                 IF DN-CLUSTER-NBR = -1 AND ASC-LINE-PRINTER      14530099
141500                    MOVE LOW-VALUES TO PV-TBL-PRTR-CLUSTR-NBR     14540099
141600                 ELSE                                             14550099
141700                    MOVE DK-PRTR-CLUSTR-NBR                       14560099
141800                                    TO PV-TBL-PRTR-CLUSTR-NBR     14570099
141900                                       APCLNBRO                   14580099
142000                 END-IF                                           14590099
142100                                                                  14600099
142200                 IF  DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)       14610099
142300                     SET PS-ERROR                                 14620099
142400                         DP020-MSG-FATAL           TO TRUE        14630099
142500                     MOVE PC-TSYMSG-02542                         14640099
142600                                          TO DP020-MSG-NUMBER     14650099
142700                     MOVE DP015-UNP-ALP-BRT-OFF    TO APRTIDA     14660099
142800                     MOVE DP015-RED                TO APRTIDC     14670099
142900                     MOVE DP015-REVERSE            TO APRTIDH     14680099
143000                     MOVE -1                       TO APRTIDL     14690099
143100                     SET DP030-SET-CURSOR-APPL-1   TO TRUE        14700099
143200                 ELSE                                             14710099
143300                     IF  ASC-PRTR-ID       =  SPACES              14720099
143400                         MOVE PV-TBL-PRTR-ID TO ASC-PRTR-ID       14730099
143500                     END-IF                                       14740099
143600                                                                  14750099
143700                     IF DP020-SRC-AID = DP016-ENTER               14760099
143800                        CONTINUE                                  14770099
143900                     ELSE                                         14780099
144000                        MOVE PV-TBL-PRTR-TYP-CDE                  14790099
144100                          TO ASC-PRTR-TYP-CDE                     14800099
144200                        MOVE PV-TBL-PRTR-LOC-DESC                 14810099
144300                          TO ASC-PRTR-LOC-DESC                    14820099
144400                        MOVE PV-TBL-PRTR-PHY-STAT-CDE             14830099
144500                          TO ASC-PRTR-STATUS-CDE                  14840099
144600                     END-IF                                       14850099
144700                 END-IF                                           14860099
144800             WHEN SQLCODE = +100                                  14870099
144900                 SET ASC-PRTR-ID-NOT-EXISTS     TO TRUE           14900099
145000             WHEN SQLCODE = -904                                  14880099
145100             WHEN SQLCODE = -913                                  14890099
145101             WHEN SQLCODE = -911                                  14890099
145110                 PERFORM 9900-SOFT-ABORT                                  
145300             WHEN SQLWARN0 NOT = SPACES                           14910099
145400             WHEN SQLCODE < +0                                    14920099
145500             WHEN SQLCODE > +0                                    14930099
145600                     MOVE '3010-FIND-PRINTER-ID-ON-TBL'           14940099
145700                                       TO DP013-PARAGRAPH         14950099
145800                     MOVE 'ERROR FINDING THE PRINTER'             14960099
145900                                       TO DP013-MESSAGE-TEXT (1)  14970099
146000                     MOVE SQLCA        TO DP013-SQLCA             14980099
146100                     MOVE 'TPRTRID'    TO DP013-DB2-TABLE-NAME (1)14990099
146200                     SET DP013-DB2-ABEND                          15000099
146300                         DP013-XCTL-DISPLAY-RESTART TO TRUE       15010099
146400                     PERFORM DP013-0000-PROCESS-ABEND             15020099
146500     END-EVALUATE.                                                15030099
146600*                                                                 15200099
146700*                                                                 15210099
146800******************************************************************15220099
146900* VALIDATE THE PRINTER TYPE CODE -                                15230099
147000* CHECK TO SEE IF IT IS ON THE TPRTRTY TABLE                      15240099
147100******************************************************************15250099
147200 3030-VALIDATE-PRTR-TYPE-CDE.                                     15260099
147300                                                                  15340099
147400         EXEC SQL                                                 15350099
147500             SELECT                                               15360099
147600                 PRTR_TYP_CDE                                     15370099
147700               , PRTR_MFR_DESC                                    15380099
147800               , PRTR_MDL_DESC                                    15390099
147900               , PAPR_TRK_QTY                                     15400099
148000               , AUTO_CTTR_IND                                    15410099
148100               , PRT_BRCDE_IND                                    15420099
148200               , PRTR_CNTL_IND                                    15430099
148300             INTO                                                 15440099
148400                 :PV-TBL-PRTR-TYP-CDE                             15450099
148500               , :PV-TBL-PRTR-MFR-DESC                            15460099
148600               , :PV-TBL-PRTR-MDL-DESC                            15470099
148700               , :PRTRTY-PAPR-TRK-QTY                             15480099
148800               , :PV-TBL-AUTO-CTTR-IND                            15490099
148900               , :PV-TBL-PRT-BRCDE-IND                            15500099
149000               , :PV-TBL-PRTR-CNTL-IND                            15510099
149100             FROM TPRTRTY                                         15520099
149200             WHERE PRTR_TYP_CDE = :ASC-PRTR-TYP-CDE               15530099
149300         END-EXEC                                                 15540099
149400                                                                  15550099
149500         EVALUATE TRUE                                            15560099
149600             WHEN SQLCODE = ZERO                                  15570099
149700                 SET ASC-PRTR-TYPE-EXISTS TO TRUE                 15600099
149800                 MOVE PRTRTY-PAPR-TRK-QTY TO ASC-PAPR-TRK-QTY     15480099
149900             WHEN SQLCODE = -904                                  15580099
150000             WHEN SQLCODE = -913                                  15590099
150010             WHEN SQLCODE = -911                                  14890099
150020                 PERFORM 9900-SOFT-ABORT                                  
150200             WHEN SQLCODE = +100                                  15610099
150300                 SET ASC-PRTR-TYPE-NOT-EXISTS TO TRUE             15620099
150400                 SET PS-ERROR              TO TRUE                15630099
150500                 SET DP020-MSG-FATAL       TO TRUE                15640099
150600                 MOVE PC-TSYMSG-00527      TO DP020-MSG-NUMBER    15650099
150700                 MOVE DP015-UNP-ALP-BRT-OFF                       15660099
150800                                           TO ATYPCDEA            15670099
150900                 MOVE DP015-RED            TO ATYPCDEC            15680099
151000                 MOVE DP015-REVERSE        TO ATYPCDEH            15690099
151100                 MOVE -1                   TO ATYPCDEL            15700099
151200                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              15710099
151300             WHEN SQLWARN0 NOT = SPACES                           15720099
151400             WHEN SQLCODE < ZERO                                  15730099
151500             WHEN SQLCODE > ZERO                                  15740099
151600                 MOVE 'VALIDATE-PRTR-TYPE-CDE'                    15750099
151700                                   TO DP013-PARAGRAPH             15760099
151800                 MOVE 'ERROR VALIDATING THE PRINTER TYPE'         15770099
151900                                   TO DP013-MESSAGE-TEXT (1)      15780099
152000                 MOVE SQLCA        TO DP013-SQLCA                 15790099
152100                 MOVE 'TPRTRTY'    TO DP013-DB2-TABLE-NAME (1)    15800099
152200                 SET DP013-DB2-ABEND                              15810099
152300                     DP013-XCTL-DISPLAY-RESTART TO TRUE           15820099
152400                 PERFORM DP013-0000-PROCESS-ABEND                 15830099
152500     END-EVALUATE.                                                15840099
152600*                                                                 16010099
152700*                                                                 16020099
152800******************************************************************16030099
152900* GET NUMBER OF TRACKS BASED ON PRINTER TYPE                      16040099
153000* CHECK TO SEE IF IT IS ON THE TPRTRTY TABLE                      16050099
153100******************************************************************16060099
153200 3040-GET-NBR-TRKS-FROM-TBL.                                      16070099
154000         EXEC SQL                                                 16150099
154100             SELECT                                               16160099
154200                 PAPR_TRK_QTY                                     16170099
154300             INTO :PRTRTY-PAPR-TRK-QTY                            16180099
154400             FROM  TPRTRTY                                        16190099
154500             WHERE PRTR_TYP_CDE = :ASC-PRTR-TYP-CDE               16200099
154600         END-EXEC                                                 16210099
154700                                                                  16220099
154800         EVALUATE TRUE                                            16230099
154900             WHEN SQLCODE = ZERO                                  16240099
155200               IF DP020-SRC-AID = DP016-ENTER                     16270099
155300                  CONTINUE                                        16280099
155400               ELSE                                               16290099
155500                  MOVE PRTRTY-PAPR-TRK-QTY                        16300099
155600                    TO ASC-PAPR-TRK-QTY                           16310099
155700                  MOVE ASC-PAPR-TRK-QTY TO ANBRTRKO               16320099
155800               END-IF                                             16330099
155810             WHEN SQLCODE = -904                                  16250099
155820             WHEN SQLCODE = -913                                  16260099
155830             WHEN SQLCODE = -911                                  14890099
155840                 PERFORM 9900-SOFT-ABORT                                  
155900             WHEN SQLCODE = +100                                  16340099
156000                 IF ASC-PRTR-ID-EXISTS                            16350099
156100                    SET PS-ERROR              TO TRUE             16360099
156200                    SET DP020-MSG-FATAL       TO TRUE             16370099
156300                    MOVE PC-TSYMSG-00005      TO DP020-MSG-NUMBER 16380099
156400                    MOVE DP015-UNP-ALP-BRT-OFF                    16390099
156500                                              TO ANBRTRKA         16400099
156600                    MOVE DP015-RED            TO ANBRTRKC         16410099
156700                    MOVE DP015-REVERSE        TO ANBRTRKH         16420099
156800                    MOVE -1                   TO ANBRTRKL         16430099
156900                    SET DP030-SET-CURSOR-APPL-1 TO TRUE           16440099
157000                 ELSE                                             16450099
157100                    CONTINUE                                      16460099
157200                 END-IF                                           16470099
157300             WHEN SQLWARN0 NOT = SPACES                           16480099
157400             WHEN SQLCODE < ZERO                                  16490099
157500             WHEN SQLCODE > ZERO                                  16500099
157600                 MOVE 'GET-NBR-TRKS'                              16510099
157700                                   TO DP013-PARAGRAPH             16520099
157800                 MOVE 'ERROR SELECTING NBR TRKS'                  16530099
157900                                   TO DP013-MESSAGE-TEXT (1)      16540099
158000                 MOVE SQLCA        TO DP013-SQLCA                 16550099
158100                 MOVE 'TPRTRTY'    TO DP013-DB2-TABLE-NAME (1)    16560099
158200                 SET DP013-DB2-ABEND                              16570099
158300                     DP013-XCTL-DISPLAY-RESTART TO TRUE           16580099
158400                 PERFORM DP013-0000-PROCESS-ABEND                 16590099
158500         END-EVALUATE.                                            16600099
158600                                                                  16610099
160300*                                                                 16780099
160400******************************************************************16790099
160500* VALIDATE STOCK TYPE FOR TRACK 0 (FRONT TRACK/TOP TRAY)          16800099
160600* CHECK TO SEE IF ON TSTKTYP TABLE                                16810099
160700******************************************************************16820099
160800 3050-VALIDATE-STOCK-TYPE-TRK0.                                   16830099
161600                                                                  16910099
161700         EXEC SQL                                                 16920099
161800              SELECT  STK_TYP_CDE                                 16930099
161900                INTO  :PV-TBL-STK-TYP-CDE0                        16940099
162000                FROM  TSTKTYP                                     16950099
162100               WHERE  STK_TYP_CDE  = :ASC-STK-TYP-CDE0            16960099
162200         END-EXEC                                                 16970099
162300                                                                  16980099
162400         EVALUATE TRUE                                            16990099
162500             WHEN SQLCODE = ZERO                                  17000099
162800                 MOVE 1 TO PV-INP-PAPR-TRK-QTY1                   17030099
162900                 MOVE PV-TBL-STK-TYP-CDE0 TO ASTKTYP0O            17040099
163000             WHEN SQLCODE = +100                                  17050099
163100                 SET PS-ERROR              TO TRUE                17060099
163200                 SET DP020-MSG-FATAL       TO TRUE                17070099
163300                 MOVE PC-TSYMSG-00005      TO DP020-MSG-NUMBER    17080099
163400                 MOVE DP015-UNP-ALP-BRT-OFF                       17090099
163500                                           TO ASTKTYP0A           17100099
163600                 MOVE DP015-RED            TO ASTKTYP0C           17110099
163700                 MOVE DP015-REVERSE        TO ASTKTYP0H           17120099
163800                 MOVE -1                   TO ASTKTYP0L           17130099
163900                 SET DP030-SET-CURSOR-APPL-1                      17140099
163901                                           TO TRUE                17150099
163910             WHEN SQLCODE = -904                                  17010099
163920             WHEN SQLCODE = -913                                  17020099
163930             WHEN SQLCODE = -911                                  14890099
163940                 PERFORM 9900-SOFT-ABORT                                  
164100             WHEN SQLWARN0 NOT = SPACES                           17160099
164200             WHEN SQLCODE < ZERO                                  17170099
164300             WHEN SQLCODE > ZERO                                  17180099
164400                 MOVE 'VALIDATE-PRTR-TRACK-QTY'                   17190099
164500                                   TO DP013-PARAGRAPH             17200099
164600                 MOVE 'ERROR VALIDATING PRTR TRACK QTY'           17210099
164700                                   TO DP013-MESSAGE-TEXT (1)      17220099
164800                 MOVE SQLCA        TO DP013-SQLCA                 17230099
164900                 MOVE 'TSTKTYP'    TO DP013-DB2-TABLE-NAME (1)    17240099
165000                 SET DP013-DB2-ABEND                              17250099
165100                     DP013-XCTL-DISPLAY-RESTART TO TRUE           17260099
165200                 PERFORM DP013-0000-PROCESS-ABEND                 17270099
165300         END-EVALUATE.                                            17280099
165400                                                                  17290099
167000*                                                                 17450099
167100*                                                                 17460099
167200******************************************************************17470099
167300* VALIDATE STOCK TYPE FOR TRACK 1 (MIDDLE TRACK/MIDDLE TRAY)      17480099
167400* CHECK TO SEE IF ON TSTKTYP TABLE                                17490099
167500******************************************************************17500099
167600 3051-VALIDATE-STOCK-TYPE-TRK1.                                   17510099
168400                                                                  17590099
168500         EXEC SQL                                                 17600099
168600              SELECT  STK_TYP_CDE                                 17610099
168700                INTO  :PV-TBL-STK-TYP-CDE1                        17620099
168800                FROM  TSTKTYP                                     17630099
168900               WHERE  STK_TYP_CDE  = :ASC-STK-TYP-CDE1            17640099
169000         END-EXEC                                                 17650099
169100                                                                  17660099
169200         EVALUATE TRUE                                            17670099
169300             WHEN SQLCODE = ZERO                                  17680099
169600                 MOVE 2 TO PV-INP-PAPR-TRK-QTY2                   17710099
169700             WHEN SQLCODE = +100                                  17720099
169800                 SET PS-ERROR              TO TRUE                17730099
169900                 SET DP020-MSG-FATAL       TO TRUE                17740099
170000                 MOVE PC-TSYMSG-00005      TO DP020-MSG-NUMBER    17750099
170100                 MOVE DP015-UNP-ALP-BRT-OFF                       17760099
170200                                           TO ASTKTYP1A           17770099
170300                 MOVE DP015-RED            TO ASTKTYP1C           17780099
170400                 MOVE DP015-REVERSE        TO ASTKTYP1H           17790099
170500                 MOVE -1                   TO ASTKTYP1L           17800099
170600                 SET DP030-SET-CURSOR-APPL-1                      17810099
170700                                           TO TRUE                17820099
170710             WHEN SQLCODE = -904                                  17690099
170720             WHEN SQLCODE = -913                                  17700099
170730             WHEN SQLCODE = -911                                  14890099
170740                 PERFORM 9900-SOFT-ABORT                                  
170800             WHEN SQLWARN0 NOT = SPACES                           17830099
170900             WHEN SQLCODE < ZERO                                  17840099
171000             WHEN SQLCODE > ZERO                                  17850099
171100                 MOVE 'VALIDATE-PRTR-TRACK-QTY'                   17860099
171200                                   TO DP013-PARAGRAPH             17870099
171300                 MOVE 'ERROR VALIDATING PRTR TRACK QTY'           17880099
171400                                   TO DP013-MESSAGE-TEXT (1)      17890099
171500                 MOVE SQLCA        TO DP013-SQLCA                 17900099
171600                 MOVE 'TSTKTYP'    TO DP013-DB2-TABLE-NAME (1)    17910099
171700                 SET DP013-DB2-ABEND                              17920099
171800                     DP013-XCTL-DISPLAY-RESTART TO TRUE           17930099
171900                 PERFORM DP013-0000-PROCESS-ABEND                 17940099
172000         END-EVALUATE.                                            17950099
172100                                                                  17960099
173700*                                                                 18120099
173800*                                                                 18130099
173900******************************************************************18140099
174000* VALIDATE STOCK TYPE FOR TRACK 2 (REAR TRACK/BOTTOM TRAY)        18150099
174100* CHECK TO SEE IF ON TSTKTYP TABLE                                18160099
174200******************************************************************18170099
174300 3052-VALIDATE-STOCK-TYPE-TRK2.                                   18180099
175100                                                                  18260099
175200         EXEC SQL                                                 18270099
175300              SELECT  STK_TYP_CDE                                 18280099
175400                INTO  :PV-TBL-STK-TYP-CDE2                        18290099
175500                FROM  TSTKTYP                                     18300099
175600               WHERE  STK_TYP_CDE  = :ASC-STK-TYP-CDE2            18310099
175700         END-EXEC                                                 18320099
175800                                                                  18330099
175900         EVALUATE TRUE                                            18340099
176000             WHEN SQLCODE = ZERO                                  18350099
176300                 MOVE 3 TO PV-INP-PAPR-TRK-QTY3                   18380099
176400             WHEN SQLCODE = +100                                  18390099
176500                 SET PS-ERROR              TO TRUE                18400099
176600                 SET DP020-MSG-FATAL       TO TRUE                18410099
176700                 MOVE PC-TSYMSG-00005      TO DP020-MSG-NUMBER    18420099
176800                 MOVE DP015-UNP-ALP-BRT-OFF                       18430099
176900                                           TO ASTKTYP2A           18440099
177000                 MOVE DP015-RED            TO ASTKTYP2C           18450099
177100                 MOVE DP015-REVERSE        TO ASTKTYP2H           18460099
177200                 MOVE -1                   TO ASTKTYP2L           18470099
177300                 SET DP030-SET-CURSOR-APPL-1                      18480099
177400                                           TO TRUE                18490099
177410             WHEN SQLCODE = -904                                  18360099
177420             WHEN SQLCODE = -913                                  18370099
177430             WHEN SQLCODE = -911                                  14890099
177440                 PERFORM 9900-SOFT-ABORT                                  
177500             WHEN SQLWARN0 NOT = SPACES                           18500099
177600             WHEN SQLCODE < ZERO                                  18510099
177700             WHEN SQLCODE > ZERO                                  18520099
177800                 MOVE 'VALIDATE-PRTR-TRACK-QTY'                   18530099
177900                                   TO DP013-PARAGRAPH             18540099
178000                 MOVE 'ERROR VALIDATING PRTR TRACK QTY'           18550099
178100                                   TO DP013-MESSAGE-TEXT (1)      18560099
178200                 MOVE SQLCA        TO DP013-SQLCA                 18570099
178300                 MOVE 'TSTKTYP'    TO DP013-DB2-TABLE-NAME (1)    18580099
178400                 SET DP013-DB2-ABEND                              18590099
178500                     DP013-XCTL-DISPLAY-RESTART TO TRUE           18600099
178600                 PERFORM DP013-0000-PROCESS-ABEND                 18610099
178700         END-EVALUATE.                                            18620099
178800                                                                  18630099
180400*                                                                 18790099
180500*                                                                 18800099
180600*----------------------------------------------------------------*18810099
180700* MOVE THE DEFAULT ATTRIBUTE VALUES TO THE ENTERABLE FIELDS ON   *18820099
180800* MAP.                                                           *18830099
180900*----------------------------------------------------------------*18840099
181000 3200-RESET-ATTRIBUTES.                                           18850099
181100     MOVE DP015-UNP-ALP-NOR-OFF    TO APCLNBRA                    18860099
181200                                      ATYPCDEA                    18870099
181300                                      ALCDESCA                    18880099
181400                                      APSTCDEA                    18890099
181500*                                     ANBRTRKA                    18900099
181600                                      ASTKTYP0A                   18910099
181700                                      ASTKTYP1A                   18920099
181800                                      ASTKTYP2A.                  18930099
181900     MOVE DP015-GREEN              TO APCLNBRC                    18940099
182000                                      ATYPCDEC                    18950099
182100                                      ALCDESCC                    18960099
182200                                      APSTCDEC                    18970099
182300*                                     ANBRTRKC                    18980099
182400                                      ASTKTYP0C                   18990099
182500                                      ASTKTYP1C                   19000099
182600                                      ASTKTYP2C.                  19010099
182700     MOVE DP015-UNDERLINE          TO APCLNBRH                    19020099
182800                                      ATYPCDEH                    19030099
182900                                      ALCDESCH                    19040099
183000                                      APSTCDEH                    19050099
183100*                                     ANBRTRKH                    19060099
183200                                      ASTKTYP0H                   19070099
183300                                      ASTKTYP1H                   19080099
183400                                      ASTKTYP2H.                  19090099
183500     EVALUATE ASC-INT-APPL-FORMAT-IND                             19100099
183600         WHEN PC-INTER-APPL-CRIT-SPEC-ADD                         19110099
183700         WHEN PC-INTER-APPL-LIST-ADD                              19120099
183800            MOVE DP015-UNP-ALP-NOR-OFF    TO APRTIDA              19130099
183900            MOVE DP015-GREEN              TO APRTIDC              19140099
184000            MOVE DP015-UNDERLINE          TO APRTIDH              19150099
184100     END-EVALUATE.                                                19160099
184200*                                                                 19170099
184300*                                                                 19180099
184400*----------------------------------------------------------------*19190099
184500*    VALIDATE THE QUEUE WAS PASSED AND DISPLAY FOR THE FIRST     *19200099
184600*    ENTRY.                                                      *19210099
184700*----------------------------------------------------------------*19220099
184800 4000-BUILD-INITIAL-PANEL.                                        19230099
184900     EVALUATE ASC-INT-APPL-FORMAT-IND                             19240099
185000         WHEN PC-INTER-APPL-CRIT-SPEC-UPD                         19250099
185100             SET DP030-SET-CURSOR-APPL-1     TO TRUE              19260099
185200             MOVE -1                         TO APCLNBRL          19270099
185300         WHEN PC-INTER-APPL-CRIT-SPEC-ADD                         19280099
185400             MOVE DP015-UNP-ALP-NOR-OFF    TO ANBRTRKA            18860099
185500             MOVE DP015-GREEN              TO ANBRTRKC            18940099
185600             MOVE DP015-UNDERLINE          TO ANBRTRKH            19020099
185700             SET DP030-SET-CURSOR-APPL-1     TO TRUE              19290099
185800             MOVE -1                         TO APRTIDL           19300099
185900         WHEN PC-INTER-APPL-LIST-ADD                              19310099
186000             SET DP030-SET-CURSOR-APPL-1     TO TRUE              19320099
186100             MOVE -1                         TO APRTIDL           19330099
186200         WHEN PC-INTER-APPL-LIST-UPDATE                           19340099
186300             SET DP030-SET-CURSOR-APPL-1     TO TRUE              19350099
186400             MOVE -1                         TO APCLNBRL          19360099
186500         WHEN PC-INTER-APPL-LIST-DELETE                           19370099
186600             SET DP030-SET-CURSOR-APPL-1     TO TRUE              19380099
186700             MOVE -1                         TO APRTIDL           19390099
186800     END-EVALUATE                                                 19400099
186900                                                                  19410099
187000     PERFORM 3040-GET-NBR-TRKS-FROM-TBL                           05660099
187100     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        19420099
187200*                                                                 19430099
187300*                                                                 19440099
187400*----------------------------------------------------------------*19450099
187500* OPEN CURSOR                                                     19460099
187600*----------------------------------------------------------------*19470099
187700 4010-OPEN-CURSOR.                                                19480099
188400                                                                  19550099
188500         EXEC SQL                                                 19560099
188600              OPEN STK-TYP-CSR                                    19570099
188700         END-EXEC                                                 19580099
188800                                                                  19590099
188900         EVALUATE TRUE                                            19600099
189000             WHEN SQLCODE = ZERO                                  19610099
189010                 CONTINUE                                                 
189100             WHEN SQLCODE = -904                                  19620099
189200             WHEN SQLCODE = -913                                  19630099
189210             WHEN SQLCODE = -911                                  19630099
189300                 PERFORM 9900-SOFT-ABORT                          19640099
189400             WHEN SQLWARN0 NOT = SPACES                           19650099
189500             WHEN SQLCODE < ZERO                                  19660099
189600             WHEN SQLCODE > ZERO                                  19670099
189700                 MOVE '4010-OPEN-CURSOR'                          19680099
189800                                   TO DP013-PARAGRAPH             19690099
189900                 MOVE 'OPEN CURSOR - '                            19700099
190000                                   TO DP013-MESSAGE-TEXT (1)      19710099
190100                 MOVE SQLCA        TO DP013-SQLCA                 19720099
190200                 MOVE 'TPRTRTK '   TO DP013-DB2-TABLE-NAME (1)    19730099
190300                 SET DP013-DB2-ABEND                              19740099
190400                     DP013-XCTL-DISPLAY-RESTART TO TRUE           19750099
190500                 PERFORM DP013-0000-PROCESS-ABEND                 19760099
190600         END-EVALUATE.                                            19770099
192000/                                                                 19910099
192300*----------------------------------------------------------------*19940099
192400* CLOSE CURSOR                                                    19950099
192500*----------------------------------------------------------------*19960099
192600 4020-CLOSE-CURSOR.                                               19970099
192700     EXEC SQL                                                     19980099
192800          CLOSE STK-TYP-CSR                                       19990099
192900     END-EXEC                                                     20000099
193000                                                                  20010099
193100     EVALUATE TRUE                                                20020099
193200         WHEN SQLCODE = ZERO                                      20030099
193300             CONTINUE                                             20040099
193400         WHEN SQLWARN0 NOT = SPACES                               20050099
193500         WHEN SQLCODE < ZERO                                      20060099
193600         WHEN SQLCODE > ZERO                                      20070099
193700             MOVE '4020-CLOSE-CURSOR'                             20080099
193800                               TO DP013-PARAGRAPH                 20090099
193900             MOVE 'CLOSE CURSOR '                                 20100099
194000                               TO DP013-MESSAGE-TEXT (1)          20110099
194100             MOVE SQLCA        TO DP013-SQLCA                     20120099
194200             MOVE 'TPRTRTK '   TO DP013-DB2-TABLE-NAME (1)        20130099
194300             SET DP013-DB2-ABEND                                  20140099
194400                 DP013-XCTL-DISPLAY-RESTART TO TRUE               20150099
194500             PERFORM DP013-0000-PROCESS-ABEND                     20160099
194600     END-EVALUATE.                                                20170099
194700                                                                  20180099
194800/                                                                 20190099
195100*----------------------------------------------------------------*20220099
195200*    FETCH THE STOCK TYPE                                         20230099
195300*----------------------------------------------------------------*20240099
195400 4310-FETCH.                                                      20250099
195500           EXEC SQL                                               20260099
195600                FETCH STK-TYP-CSR                                 20270099
195700                  INTO :PV-TBL-STK-TYP-CDE                        20280099
195800                     , :PV-TBL-PRTR-TRK-NBR                       20290099
195900           END-EXEC                                               20300099
196000                                                                  20310099
196100           EVALUATE TRUE                                          20320099
196200               WHEN SQLCODE = ZERO                                20330099
196300                  IF DP020-SRC-AID = DP016-ENTER                  20340099
196400                     CONTINUE                                     20350099
196500                  ELSE                                            20360099
196600                      IF PV-TBL-PRTR-TRK-NBR = ZERO               20370099
196700                        MOVE PV-TBL-STK-TYP-CDE                   20380099
196800                            TO ASC-STK-TYP-CDE0                   20390099
196900                        MOVE ASC-STK-TYP-CDE0 TO ASTKTYP0O        20400099
197000                        MOVE PV-TBL-PRTR-TRK-NBR                  20410099
197100                            TO ASC-PRTR-TRK-NBR1                  20420099
197200                      END-IF                                      20430099
197300                                                                  20440099
197400                      IF PV-TBL-PRTR-TRK-NBR = 1                  20450099
197500                        MOVE PV-TBL-STK-TYP-CDE                   20460099
197600                            TO ASC-STK-TYP-CDE1                   20470099
197700                        MOVE ASC-STK-TYP-CDE1 TO ASTKTYP1O        20480099
197800                        MOVE PV-TBL-PRTR-TRK-NBR                  20490099
197900                            TO ASC-PRTR-TRK-NBR2                  20500099
198000                      END-IF                                      20510099
198100                                                                  20520099
198200                      IF PV-TBL-PRTR-TRK-NBR = 2                  20530099
198300                        MOVE PV-TBL-STK-TYP-CDE                   20540099
198400                            TO ASC-STK-TYP-CDE2                   20550099
198500                        MOVE ASC-STK-TYP-CDE2 TO ASTKTYP2O        20560099
198600                        MOVE PV-TBL-PRTR-TRK-NBR                  20570099
198700                            TO ASC-PRTR-TRK-NBR3                  20580099
198800                      END-IF                                      20590099
198900                  END-IF                                          20600099
199000               WHEN SQLCODE = +100                                20610099
199100                   SET PS-EOF-STK-TYP-CURSOR TO TRUE              20620099
199200               WHEN SQLWARN0 NOT = SPACE                          20630099
199300               WHEN SQLCODE NOT = ZERO                            20640099
199400                    MOVE '4310-FETCH-CURSOR'                      20650099
199500                                     TO DP013-PARAGRAPH           20660099
199600                    MOVE 'FETCH MESSAGE CURSOR'                   20670099
199700                                     TO DP013-MESSAGE-TEXT (1)    20680099
199800                    MOVE SQLCA       TO DP013-SQLCA               20690099
199900                    SET DP013-DB2-ABEND                           20700099
200000                                     TO TRUE                      20710099
200100                    PERFORM DP013-0000-PROCESS-ABEND              20720099
200200           END-EVALUATE.                                          20730099
200500*----------------------------------------------------------------*20760099
200600*    RESTORE THE DATA ON THE SCREEN FROM THE COMM AREA.          *20770099
200700*----------------------------------------------------------------*20780099
200800 4400-MOVE-COMMAREA-TO-SCREEN.                                    20790099
200900     MOVE ASC-OPER-UNT-ID          TO AOPERO.                     20800099
201000     MOVE ASC-FCLTY-NME            TO AFDESCO.                    20810099
201100     MOVE ASC-FCLTY-ID             TO AFCLTYO.                    20820099
201200     MOVE ASC-PRTR-ID              TO APRTIDO.                    20830099
201300                                                                  20840099
201400*LMM                                                              20850099
201500     EVALUATE TRUE                                                20860099
201600         WHEN DP020-FK-REFRESH(DP020-SRC-AID)                     20870099
201700              EVALUATE ASC-INT-APPL-FORMAT-IND                    20880099
201800                  WHEN PC-INTER-APPL-CRIT-SPEC-ADD                20890099
201900                  WHEN PC-INTER-APPL-LIST-ADD                     20900099
202000                     INITIALIZE ASC-PRTR-ID                       20910099
202100                     MOVE ASC-PRTR-ID              TO APRTIDO     20920099
202200                                                                  20930099
202300                     INITIALIZE ASC-PRTR-CLUSTR-NBR               20940099
202400                     MOVE ASC-PRTR-CLUSTR-NBR      TO APCLNBRO    20950099
202500                                                                  20960099
202600                     INITIALIZE ASC-PRTR-TYP-CDE                  20970099
202700                     MOVE ASC-PRTR-TYP-CDE         TO ATYPCDEO    20980099
202800                                                                  20990099
202900                     INITIALIZE ASC-PRTR-LOC-DESC                 21000099
203000                     MOVE ASC-PRTR-LOC-DESC        TO ALCDESCO    21010099
203100                                                                  21020099
203200                     INITIALIZE ASC-PRTR-STATUS-CDE               21030099
203300                     MOVE ASC-PRTR-STATUS-CDE      TO APSTCDEO    21040099
203400                                                                  21050099
203500                     INITIALIZE ASC-PAPR-TRK-QTY                  21060099
203600                     MOVE ASC-PAPR-TRK-QTY         TO ANBRTRKO    21070099
203700                                                                  21080099
203800                     INITIALIZE ASC-STK-TYP-CDE0                  21090099
203900                     MOVE ASC-STK-TYP-CDE0         TO ASTKTYP0O   21100099
204000                                                                  21110099
204100                     INITIALIZE ASC-STK-TYP-CDE1                  21120099
204200                     MOVE ASC-STK-TYP-CDE1         TO ASTKTYP1O   21130099
204300                                                                  21140099
204400                     INITIALIZE ASC-STK-TYP-CDE2                  21150099
204500                     MOVE ASC-STK-TYP-CDE2         TO ASTKTYP2O   21160099
204600                                                                  21170099
204700                  WHEN PC-INTER-APPL-CRIT-SPEC-UPD                21180099
204800                     EVALUATE TRUE                                21190099
204900                       WHEN ASC-LABEL-PRINTER                     21200099
205000                          MOVE ASC-PRTR-CLUSTR-NBR    TO APCLNBRO 21210099
205100                       WHEN ASC-LINE-PRINTER                      21220099
205200                          MOVE SPACES                TO APCLNBRO  21230099
205300                     END-EVALUATE                                 21240099
205400                       MOVE ASC-PRTR-TYP-CDE         TO ATYPCDEO  21250099
205500                       MOVE ASC-PRTR-LOC-DESC        TO ALCDESCO  21260099
205600                       MOVE ASC-PRTR-STATUS-CDE      TO APSTCDEO  21270099
205700                       MOVE ASC-PAPR-TRK-QTY         TO ANBRTRKO  21280099
205800                       MOVE ASC-STK-TYP-CDE0         TO ASTKTYP0O 21290099
205900                       MOVE ASC-STK-TYP-CDE1         TO ASTKTYP1O 21300099
206000                       MOVE ASC-STK-TYP-CDE2         TO ASTKTYP2O 21310099
206100                       MOVE -1                       TO APCLNBRL  21320099
206200              END-EVALUATE                                        21330099
206300     END-EVALUATE                                                 21340099
206400                                                                  21350099
206500     EVALUATE ASC-INT-APPL-FORMAT-IND                             21360099
206600         WHEN PC-INTER-APPL-CRIT-SPEC-ADD                         21370099
206700         WHEN PC-INTER-APPL-CRIT-SPEC-UPD                         21380099
206800         WHEN PC-INTER-APPL-LIST-ADD                              21390099
206900            MOVE ASC-PRTR-TYP-CDE         TO ATYPCDEO             21400099
207000            MOVE ASC-PRTR-LOC-DESC        TO ALCDESCO             21410099
207100            MOVE ASC-PRTR-STATUS-CDE      TO APSTCDEO             21420099
207200            MOVE ASC-PAPR-TRK-QTY         TO ANBRTRKO             21430099
207300            MOVE ASC-STK-TYP-CDE0         TO ASTKTYP0O            21440099
207400            MOVE ASC-STK-TYP-CDE1         TO ASTKTYP1O            21450099
207500            MOVE ASC-STK-TYP-CDE2         TO ASTKTYP2O            21460099
207600         WHEN PC-INTER-APPL-LIST-UPDATE                           21470099
207700            EVALUATE TRUE                                         21480099
207800               WHEN ASC-LABEL-PRINTER                             21490099
207900                  MOVE ASC-PRTR-CLUSTR-NBR   TO APCLNBRO          21500099
208000               WHEN ASC-LINE-PRINTER                              21510099
208100                  MOVE SPACES                TO APCLNBRO          21520099
208200            END-EVALUATE                                          21530099
208300            MOVE ASC-PRTR-TYP-CDE         TO ATYPCDEO             21540099
208400            MOVE ASC-PRTR-LOC-DESC        TO ALCDESCO             21550099
208500            MOVE ASC-PRTR-STATUS-CDE      TO APSTCDEO             21560099
208600            MOVE ASC-PAPR-TRK-QTY         TO ANBRTRKO             21570099
208700            MOVE ASC-STK-TYP-CDE0         TO ASTKTYP0O            21580099
208800            MOVE ASC-STK-TYP-CDE1         TO ASTKTYP1O            21590099
208900            MOVE ASC-STK-TYP-CDE2         TO ASTKTYP2O            21600099
209000            MOVE -1                       TO APCLNBRL             21610099
209100                                                                  21620099
209200         WHEN PC-INTER-APPL-LIST-DELETE                           21630099
209300            EVALUATE TRUE                                         21640099
209400               WHEN ASC-LABEL-PRINTER                             21650099
209500                  MOVE ASC-PRTR-CLUSTR-NBR   TO APCLNBRO          21660099
209600               WHEN ASC-LINE-PRINTER                              21670099
209700                  MOVE SPACES                TO APCLNBRO          21680099
209800            END-EVALUATE                                          21690099
209900            MOVE ASC-PRTR-TYP-CDE         TO ATYPCDEO             21700099
210000            MOVE ASC-PRTR-LOC-DESC        TO ALCDESCO             21710099
210100            MOVE ASC-PRTR-STATUS-CDE      TO APSTCDEO             21720099
210200     END-EVALUATE.                                                21730099
210300*                                                                 21740099
210400*WHEN AT PRINTER UPDATE SCREEN, PROTECT PRINTER ID FIELD          21750099
210500*AND PLACE CURSOR AT PRINTER CLUSTER NUMBER FIELD.                21760099
210600     EVALUATE ASC-INT-APPL-FORMAT-IND                             21770099
210700         WHEN PC-INTER-APPL-CRIT-SPEC-UPD                         21780099
210800         WHEN PC-INTER-APPL-LIST-UPDATE                           21790099
210900             SET DP030-SET-CURSOR-APPL-1     TO TRUE              21800099
211000             MOVE -1                         TO APCLNBRL          21810099
211100             MOVE DP015-UNP-ALP-NOR-OFF      TO APCLNBRA          21820099
211200             MOVE DP015-GREEN                TO APCLNBRC          21830099
211300             MOVE DP015-UNDERLINE            TO APCLNBRH          21840099
211400                                                                  21850099
211500             MOVE DP015-ASK-NOR-OFF          TO AOPERA            21860099
211600             MOVE DP015-BLUE                 TO AOPERC            21870099
211700                                                                  21880099
211800             MOVE DP015-ASK-NOR-OFF          TO AFDESCA           21890099
211900             MOVE DP015-BLUE                 TO AFDESCC           21900099
212000                                                                  21910099
212100             MOVE DP015-ASK-NOR-OFF          TO AFCLTYA           21920099
212200             MOVE DP015-BLUE                 TO AFCLTYC           21930099
212300                                                                  21940099
212400             MOVE DP015-ASK-NOR-OFF          TO APRTIDA           21950099
212500             MOVE DP015-BLUE                 TO APRTIDC           21960099
212600     END-EVALUATE.                                                21970099
212700*                                                                 21980099
212800*                                                                 21990099
212900 4500-MOVE-COMMAREA-TO-TEMP.                                      22000099
213000     MOVE ASC-PRTR-ID             TO PV-INP-PRTR-ID.              22010099
213100     MOVE ASC-OPER-UNT-ID         TO PV-INP-PRTR-OPER-UNT-ID.     22020099
213200     MOVE ASC-FCLTY-ID            TO PV-INP-PRTR-FCLTY-ID.        22030099
213300     MOVE ASC-FCLTY-NME           TO PV-INP-PRTR-FCLTY-NME.       22040099
213400*LMM MOVE ASC-PRTR-CLUSTR-NBR     TO PV-INP-PRTR-CLUSTR-NBR.      22050099
213500     MOVE ASC-PRTR-TYP-CDE        TO PV-INP-PRTR-TYP-CDE.         22060099
213600     MOVE ASC-PRTR-LOC-DESC       TO PV-INP-PRTR-LOC-DESC.        22070099
213700     MOVE ASC-PRTR-STATUS-CDE     TO PV-INP-PRTR-PHY-STAT-CDE.    22080099
213800     MOVE ASC-STK-TYP-CDE0        TO PV-INP-STK-TYP-CDE0.         22090099
213900     MOVE ASC-STK-TYP-CDE1        TO PV-INP-STK-TYP-CDE1.         22100099
214000     MOVE ASC-STK-TYP-CDE2        TO PV-INP-STK-TYP-CDE2.         22110099
214100*                                                                 22120099
214200*                                                                 22130099
214300 4600-MOVE-TEMP-TO-COMMAREA.                                      22140099
214400     MOVE PV-INP-PRTR-ID            TO ASC-PRTR-ID.               22150099
214500     MOVE PV-INP-PRTR-OPER-UNT-ID   TO ASC-OPER-UNT-ID.           22160099
214600     MOVE PV-INP-PRTR-FCLTY-ID      TO ASC-FCLTY-ID.              22170099
214700     MOVE PV-INP-PRTR-FCLTY-NME     TO ASC-FCLTY-NME.             22180099
214800                                                                  22190099
214900     EVALUATE ASC-INT-APPL-FORMAT-IND                             22200099
215000         WHEN PC-INTER-APPL-CRIT-SPEC-UPD                         22210099
215100            IF  ASC-LABEL-PRINTER                                 22220099
215200                MOVE DK-PRTR-CLUSTR-NBR    TO ASC-PRTR-CLUSTR-NBR 22230099
215300            ELSE                                                  22240099
215400                MOVE SPACES                TO ASC-PRTR-CLUSTR-NBR 22250099
215500            END-IF                                                22260099
215600         WHEN OTHER                                               22270099
215700            IF  ASC-LABEL-PRINTER                                 22280099
215800                MOVE ASC-PRTR-CLUSTR-NBR-N TO ASC-PRTR-CLUSTR-NBR 22290099
215900            ELSE                                                  22300099
216000                MOVE SPACES                TO ASC-PRTR-CLUSTR-NBR 22310099
216100            END-IF                                                22320099
216200     END-EVALUATE.                                                22330099
216300                                                                  22340099
216400     MOVE PV-INP-PRTR-TYP-CDE       TO ASC-PRTR-TYP-CDE.          22350099
216500     MOVE PV-INP-PRTR-LOC-DESC      TO ASC-PRTR-LOC-DESC.         22360099
216600     MOVE PV-INP-PRTR-PHY-STAT-CDE  TO ASC-PRTR-STATUS-CDE.       22370099
216700     MOVE PV-INP-STK-TYP-CDE0       TO ASC-STK-TYP-CDE0.          22380099
216800     MOVE PV-INP-STK-TYP-CDE1       TO ASC-STK-TYP-CDE1.          22390099
216900     MOVE PV-INP-STK-TYP-CDE2       TO ASC-STK-TYP-CDE2.          22400099
217000*                                                                 22410099
217100*                                                                 22420099
217200*----------------------------------------------------------------*22430099
217300* PROCESS TABLE INSERTS                                          *22440099
217400*----------------------------------------------------------------*22450099
217500 5000-PROCESS-ADD.                                                22460099
217600         PERFORM 6100-INSERT-TPRTRID                              22470099
217700                                                                  22480099
217800         IF  ASC-STK-TYP-CDE0 > SPACES                            24190099
217900             MOVE ZERO       TO PRTRTK-PRTR-TRK-NBR               24260099
218000             MOVE ASC-STK-TYP-CDE0 TO PRTRTK-STK-TYP-CDE          24270099
218100             PERFORM 6200-INSERT-TPRTRTK                          22490099
218200         END-IF                                                           
218300         IF  ASC-STK-TYP-CDE1 > SPACES                            24190099
218400             MOVE 1          TO PRTRTK-PRTR-TRK-NBR               24260099
218500             MOVE ASC-STK-TYP-CDE1 TO PRTRTK-STK-TYP-CDE          24270099
218600             PERFORM 6200-INSERT-TPRTRTK                          22490099
218700         END-IF                                                           
218800         IF  ASC-STK-TYP-CDE2 > SPACES                            24190099
218900             MOVE 2          TO PRTRTK-PRTR-TRK-NBR               24260099
219000             MOVE ASC-STK-TYP-CDE2 TO PRTRTK-STK-TYP-CDE          24270099
219100             PERFORM 6200-INSERT-TPRTRTK                          22490099
219200         END-IF                                                           
219300                                                                  22500099
219400         IF ASC-TPRTRID-INSERTED AND                              22510099
219500            ASC-TPRTRTK-INSERTED                                  22520099
219600            MOVE PC-TSYMSG-00034                                  22530099
219700                           TO DP020-MSG-NUMBER                    22540099
219800            SET DP020-MSG-INFORMATIONAL                           22550099
219900                           TO TRUE                                22560099
220000         END-IF.                                                  22570099
220100*                                                                 22580099
220200*                                                                 22590099
220300*----------------------------------------------------------------*22600099
220400* PROCESS TABLE UPDATES                                          *22610099
220500*----------------------------------------------------------------*22620099
220600 5100-PROCESS-UPDATE.                                             22630099
220700                                                                  22640099
220800         IF ASC-PRTR-CLUSTR-NBR > SPACES OR                       22650099
220900            ASC-PRTR-TYP-CDE    > SPACES OR                       22660099
221000            ASC-PRTR-LOC-DESC   > SPACES OR                       22670099
221100            ASC-PRTR-STATUS-CDE > SPACES                          22680099
221200            PERFORM 7100-UPDATE-TPRTRID                           22690099
221300         END-IF                                                   22700099
221400                                                                  22710099
221500         IF ASC-STK-TYP-CDE0 > SPACES OR                          22720099
221600            ASC-STK-TYP-CDE1 > SPACES OR                          22730099
221700            ASC-STK-TYP-CDE2 > SPACES                             22740099
221800            PERFORM 7200-UPDATE-TPRTRTK                           22750099
221900         END-IF                                                           
222000                                                                          
222100*    PROCESS DELETIONS HERE                                       22770099
222200     PERFORM 5110-DELETE-BLANK-CODES                                      
222300                                                                  22770099
222400                                                                  22770099
222500         IF ASC-TPRTRID-UPDATED OR                                22780099
222600            ASC-TPRTRTY-UPDATED OR                                22790099
222700            ASC-TPRTRTK-UPDATED                                   22800099
222800            MOVE PC-TSYMSG-00059                                  22810099
222900                           TO DP020-MSG-NUMBER                    22820099
223000            SET DP020-MSG-INFORMATIONAL                           22830099
223100                           TO TRUE                                22840099
223200         END-IF.                                                  22850099
223300                                                                          
223400 5110-DELETE-BLANK-CODES.                                                 
223500     IF ASC-STK-TYP-CDE0 = SPACES                                 22720099
223600         MOVE ZERO              TO PRTRTK-PRTR-TRK-NBR            27690099
223700         PERFORM 8210-DELETE-TPRTRTK                              22940099
223800     END-IF                                                               
223900     IF ASC-STK-TYP-CDE1 = SPACES                                 22720099
224000         MOVE 1                 TO PRTRTK-PRTR-TRK-NBR            27690099
224100         PERFORM 8210-DELETE-TPRTRTK                              22940099
224200     END-IF                                                               
224300     IF ASC-STK-TYP-CDE2 = SPACES                                 22720099
224400         MOVE 2                 TO PRTRTK-PRTR-TRK-NBR            27690099
224500         PERFORM 8210-DELETE-TPRTRTK                              22940099
224600     END-IF.                                                              
224700*                                                                 22860099
224800*                                                                 22870099
224900*----------------------------------------------------------------*22880099
225000* PROCESS TABLE DELETES                                          *22890099
225100*----------------------------------------------------------------*22900099
225200 5200-PROCESS-DELETE.                                             22910099
225300                                                                  22920099
225400         PERFORM 8100-DELETE-TPRTRID                              22930099
225500         PERFORM 8200-DELETE-TPRTRTK                              22940099
225600                                                                  22950099
225700         IF ASC-TPRTRID-DELETED AND                               22960099
225800            ASC-TPRTRTK-DELETED                                   22970099
225900            MOVE PC-TSYMSG-00115                                  22980099
226000                       TO DP020-MSG-NUMBER                        22990099
226100            SET DP020-MSG-INFORMATIONAL                           23000099
226200                       TO TRUE                                    23010099
226300         END-IF.                                                  23020099
226400*                                                                 23030099
226500*                                                                 23040099
226600*----------------------------------------------------------------*23050099
226700* INSERT A ROW INTO THE PRINTER ID TABLE                         *23060099
226800*----------------------------------------------------------------*23070099
226900 6100-INSERT-TPRTRID.                                             23080099
227600                                                                  23150099
227700         MOVE  ASC-PRTR-CLUSTR-NBR-N                              23160099
227800           TO  DK-PRTR-CLUSTR-NBR                                 23170099
227900                                                                  23180099
228000         IF  ASC-LINE-PRINTER                                     23190099
228100             EXEC SQL                                             23200099
228200                 INSERT INTO TPRTRID                              23210099
228300                 (                                                23220099
228400                  PRTR_ID                                         23230099
228500                 ,PRTR_OPER_UNT_ID                                23240099
228600                 ,PRTR_FCLTY_ID                                   23250099
228700                 ,PRTR_CLUSTR_NBR                                 23260099
228800                 ,PRTR_TYP_CDE                                    23270099
228900                 ,PRTR_LOC_DESC                                   23280099
229000                 ,PRTR_PHY_STAT_CDE                               23290099
229100                 )                                                23300099
229200                 VALUES                                           23310099
229300                 (                                                23320099
229400                  :PV-INP-PRTR-ID                                 23330099
229500                 ,:PV-INP-PRTR-OPER-UNT-ID                        23340099
229600                 ,:PV-INP-PRTR-FCLTY-ID                           23350099
229700                 , NULL                                           23360099
229800                 ,:PV-INP-PRTR-TYP-CDE                            23370099
229900                 ,:PV-INP-PRTR-LOC-DESC                           23380099
230000                 ,:PV-INP-PRTR-PHY-STAT-CDE                       23390099
230100                 )                                                23400099
230200             END-EXEC                                             23410099
230300         ELSE                                                     23420099
230400             EXEC SQL                                             23430099
230500                 INSERT INTO TPRTRID                              23440099
230600                 (                                                23450099
230700                  PRTR_ID                                         23460099
230800                 ,PRTR_OPER_UNT_ID                                23470099
230900                 ,PRTR_FCLTY_ID                                   23480099
231000                 ,PRTR_CLUSTR_NBR                                 23490099
231100                 ,PRTR_TYP_CDE                                    23500099
231200                 ,PRTR_LOC_DESC                                   23510099
231300                 ,PRTR_PHY_STAT_CDE                               23520099
231400                 )                                                23530099
231500                 VALUES                                           23540099
231600                 (                                                23550099
231700                  :PV-INP-PRTR-ID                                 23560099
231800                 ,:PV-INP-PRTR-OPER-UNT-ID                        23570099
231900                 ,:PV-INP-PRTR-FCLTY-ID                           23580099
232000                 ,:DK-PRTR-CLUSTR-NBR                             23590099
232100                 ,:PV-INP-PRTR-TYP-CDE                            23600099
232200                 ,:PV-INP-PRTR-LOC-DESC                           23610099
232300                 ,:PV-INP-PRTR-PHY-STAT-CDE                       23620099
232400                 )                                                23630099
232500             END-EXEC                                             23640099
232600         END-IF                                                   23650099
232700         EVALUATE TRUE                                            23660099
232800             WHEN SQLCODE = +0                                    23670099
233100                 IF DN-CLUSTER-NBR = -1                           23700099
233200                    MOVE 0 TO ASC-PRTR-CLUSTR-NBR-N               23710099
233300                 ELSE                                             23720099
233400                    MOVE DK-PRTR-CLUSTR-NBR                       23730099
233500                           TO ASC-PRTR-CLUSTR-NBR-N               23740099
233600                 END-IF                                           23750099
233700                 SET ASC-TPRTRID-INSERTED TO TRUE                 23760099
233710             WHEN SQLCODE = -904                                  23680099
233720             WHEN SQLCODE = -913                                  23690099
233730             WHEN SQLCODE = -911                                  19630099
233740                 PERFORM 9900-SOFT-ABORT                          19640099
233800             WHEN SQLWARN0 NOT = SPACES                           23770099
233900             WHEN SQLCODE < +0                                    23780099
234000             WHEN SQLCODE > +0                                    23790099
234100                 MOVE '6100-INSERT-TPRTRID'                       23800099
234200                                   TO DP013-PARAGRAPH             23810099
234300                 MOVE 'ERROR INSERTING ROW TO TPRTRID'            23820099
234400                                   TO DP013-MESSAGE-TEXT (1)      23830099
234500                 MOVE SQLCA        TO DP013-SQLCA                 23840099
234600                 MOVE 'TPRTRID'    TO DP013-DB2-TABLE-NAME (1)    23850099
234700                 SET DP013-DB2-ABEND                              23860099
234800                     DP013-XCTL-DISPLAY-RESTART TO TRUE           23870099
234900                 PERFORM DP013-0000-PROCESS-ABEND                 23880099
235000         END-EVALUATE.                                            23890099
235100                                                                  23900099
236900*----------------------------------------------------------------*24080099
237000* INSERT A ROW INTO THE PRINTER TRACK TABLE                      *24090099
237100*----------------------------------------------------------------*24100099
237200 6200-INSERT-TPRTRTK.                                             24110099
237300                                                                  24180099
237400             EXEC SQL                                             24200099
237500                 INSERT INTO TPRTRTK                              24210099
237600                 (                                                24220099
237700                      PRTR_ID                                     24230099
237800                     ,PRTR_OPER_UNT_ID                            24240099
237900                     ,PRTR_FCLTY_ID                               24250099
238000                     ,PRTR_TRK_NBR                                24260099
238100                     ,STK_TYP_CDE                                 24270099
238200                     ,PRTR_TRK_STAT_CDE                           24280099
238300                 )                                                24290099
238400                 VALUES                                           24300099
238500                 (                                                24310099
238600                      :PV-INP-PRTR-ID                             24320099
238700                     ,:PV-INP-PRTR-OPER-UNT-ID                    24330099
238800                     ,:PV-INP-PRTR-FCLTY-ID                       24340099
238900                     , :PRTRTK-PRTR-TRK-NBR                       24260099
239000                     , :PRTRTK-STK-TYP-CDE                        24270099
239100                     ,:PV-INP-PRTR-PHY-STAT-CDE                   24370099
239200                 )                                                24380099
239300             END-EXEC                                             24390099
239400                                                                  24870099
239500         EVALUATE TRUE                                            24880099
239600             WHEN SQLCODE = +0                                    24890099
239700                 SET ASC-TPRTRTK-INSERTED TO TRUE                 24920099
239800             WHEN SQLCODE = -904                                  24900099
239900             WHEN SQLCODE = -913                                  24910099
239910             WHEN SQLCODE = -911                                  19630099
239920                 PERFORM 9900-SOFT-ABORT                          19640099
240100             WHEN SQLWARN0 NOT = SPACES                           24930099
240200             WHEN SQLCODE < +0                                    24940099
240300             WHEN SQLCODE > +0                                    24950099
240400                 MOVE '6200-INSERT-TPRTRTK'                       24960099
240500                                   TO DP013-PARAGRAPH             24970099
240600                 MOVE 'ERROR INSERTING ROW INTO TPRTRTK'          24980099
240700                                   TO DP013-MESSAGE-TEXT (1)      24990099
240800                 MOVE SQLCA        TO DP013-SQLCA                 25000099
240900                 MOVE 'TPRTRTK'    TO DP013-DB2-TABLE-NAME (1)    25010099
241000                 SET DP013-DB2-ABEND                              25020099
241100                     DP013-XCTL-DISPLAY-RESTART TO TRUE           25030099
241200                 PERFORM DP013-0000-PROCESS-ABEND                 25040099
241300         END-EVALUATE.                                            25050099
241400                                                                  25060099
241500*                                                                 25220099
241600*                                                                 25230099
241700******************************************************************25240099
241800** UPDATE A ROW ON THE PRINTER ID TABLE                         **25250099
241900******************************************************************25260099
242000 7100-UPDATE-TPRTRID.                                             25270099
242800                                                                  25350099
242900         IF  ASC-PRTR-CLUSTR-NBR  >= ZEROES                       25360099
243000             MOVE  ASC-PRTR-CLUSTR-NBR-N                          25370099
243100               TO  PV-INP-PRTR-CLUSTR-NBR                         25380099
243200             SET  PS-NULL-CLUSTER-NO                              25390099
243300                  ASC-NULL-CLUSTER-NO  TO TRUE                    25400099
243400         ELSE                                                     25410099
243500             SET  PS-NULL-CLUSTER-YES                             25420099
243600                  ASC-NULL-CLUSTER-YES TO TRUE                    25430099
243700             MOVE LOW-VALUES  TO  ASC-PRTR-CLUSTR-NBR             25440099
243800         END-IF                                                   25450099
243900                                                                  25460099
244000         IF  ASC-LINE-PRINTER  OR                                 25470099
244100             PS-NULL-CLUSTER-YES                                  25480099
244200             EXEC SQL                                             25490099
244300                 UPDATE TPRTRID                                   25500099
244400                 SET                                              25510099
244500                      PRTR_CLUSTR_NBR   =  NULL                   25520099
244600                     ,PRTR_TYP_CDE      = :PV-INP-PRTR-TYP-CDE    25530099
244700                     ,PRTR_LOC_DESC     = :PV-INP-PRTR-LOC-DESC   25540099
244800                     ,PRTR_PHY_STAT_CDE =                         25550099
244900                                      :PV-INP-PRTR-PHY-STAT-CDE   25560099
245000               WHERE PRTR_ID            = :ASC-PRTR-ID            25570099
245100                 AND PRTR_OPER_UNT_ID   = :ASC-OPER-UNT-ID        25580099
245200                 AND PRTR_FCLTY_ID      = :ASC-FCLTY-ID           25590099
245300             END-EXEC                                             25600099
245400         ELSE                                                     25610099
245500             EXEC SQL                                             25620099
245600                 UPDATE TPRTRID                                   25630099
245700                 SET                                              25640099
245800                      PRTR_CLUSTR_NBR   = :PV-INP-PRTR-CLUSTR-NBR 25650099
245900                     ,PRTR_TYP_CDE      = :PV-INP-PRTR-TYP-CDE    25660099
246000                     ,PRTR_LOC_DESC     = :PV-INP-PRTR-LOC-DESC   25670099
246100                     ,PRTR_PHY_STAT_CDE =                         25680099
246200                                      :PV-INP-PRTR-PHY-STAT-CDE   25690099
246300               WHERE PRTR_ID            = :ASC-PRTR-ID            25700099
246400                 AND PRTR_OPER_UNT_ID   = :ASC-OPER-UNT-ID        25710099
246500                 AND PRTR_FCLTY_ID      = :ASC-FCLTY-ID           25720099
246600             END-EXEC                                             25730099
246700         END-IF                                                   25740099
246800         EVALUATE TRUE                                            25750099
246900             WHEN SQLCODE = +0                                    25760099
247000*DMH             IF DN-CLUSTER-NBR = -1                           25790099
247100*DMH                MOVE LOW-VALUES TO ASC-PRTR-CLUSTR-NBR        25800099
247200*DMH             ELSE                                             25810099
247300*DMH                MOVE DK-PRTR-CLUSTR-NBR                       25820099
247400*DMH                       TO ASC-PRTR-CLUSTR-NBR-N               25830099
247500*DMH             END-IF                                           25840099
247600                 SET ASC-TPRTRID-UPDATED TO TRUE                  25850099
247700             WHEN SQLCODE = -904                                  25770099
247800             WHEN SQLCODE = -913                                  25780099
247810             WHEN SQLCODE = -911                                  19630099
247820                 PERFORM 9900-SOFT-ABORT                          19640099
248000             WHEN SQLWARN0 NOT = SPACES                           25860099
248100             WHEN SQLCODE < +0                                    25870099
248200             WHEN SQLCODE > +0                                    25880099
248300                 MOVE '7100-UPDATE-TPRTRID'                       25890099
248400                                   TO DP013-PARAGRAPH             25900099
248500                 MOVE 'ERROR UPDATING THE PRINTER TABLE'          25910099
248600                                   TO DP013-MESSAGE-TEXT (1)      25920099
248700                 MOVE SQLCA        TO DP013-SQLCA                 25930099
248800                 MOVE 'TPRTRID'    TO DP013-DB2-TABLE-NAME (1)    25940099
248900                 SET DP013-DB2-ABEND                              25950099
249000                     DP013-XCTL-DISPLAY-RESTART TO TRUE           25960099
249100                 PERFORM DP013-0000-PROCESS-ABEND                 25970099
249200         END-EVALUATE.                                            25980099
249300                                                                  25990099
250900*                                                                 26150099
251000*                                                                 26160099
251100******************************************************************26170099
251200** UPDATE A ROW ON THE PRINTER TRACK TABLE                      **26180099
251300******************************************************************26190099
251400 7200-UPDATE-TPRTRTK.                                             26200099
251500                                                                  26280099
251600         IF  ASC-STK-TYP-CDE0 > SPACES                            26290099
251700             MOVE ZERO       TO PRTRTK-PRTR-TRK-NBR               24260099
251800             MOVE ASC-STK-TYP-CDE0 TO PRTRTK-STK-TYP-CDE          24270099
251900             EXEC SQL                                             26300099
252000                 UPDATE TPRTRTK                                   26310099
252100                 SET                                              26320099
252200                      STK_TYP_CDE       = :PRTRTK-STK-TYP-CDE     26330099
252300               WHERE PRTR_TRK_NBR       = :PRTRTK-PRTR-TRK-NBR    26340099
252400                 AND PRTR_ID            = :ASC-PRTR-ID            26350099
252500                 AND PRTR_OPER_UNT_ID   = :ASC-OPER-UNT-ID        26360099
252600                 AND PRTR_FCLTY_ID      = :ASC-FCLTY-ID           26370099
252700             END-EXEC                                             26380099
252800             PERFORM 7200A-CHECK-SQLCODE                          26381099
252900         END-IF                                                   26390099
253000*                                                                 26400099
253100         IF  ASC-STK-TYP-CDE1 > SPACES                            26410099
253200             MOVE 1          TO PRTRTK-PRTR-TRK-NBR               24260099
253300             MOVE ASC-STK-TYP-CDE1 TO PRTRTK-STK-TYP-CDE          24270099
253400             EXEC SQL                                             26420099
253500                 UPDATE TPRTRTK                                   26430099
253600                 SET                                              26440099
253700                      STK_TYP_CDE       = :PRTRTK-STK-TYP-CDE     26450099
253800               WHERE PRTR_TRK_NBR       = :PRTRTK-PRTR-TRK-NBR    26460099
253900                 AND PRTR_ID            = :ASC-PRTR-ID            26470099
254000                 AND PRTR_OPER_UNT_ID   = :ASC-OPER-UNT-ID        26480099
254100                 AND PRTR_FCLTY_ID      = :ASC-FCLTY-ID           26490099
254200             END-EXEC                                             26500099
254300             PERFORM 7200A-CHECK-SQLCODE                          26381099
254400         END-IF                                                   26510099
254500*                                                                 26520099
254600         IF  ASC-STK-TYP-CDE2 > SPACES                            26530099
254700             MOVE 2          TO PRTRTK-PRTR-TRK-NBR               24260099
254800             MOVE ASC-STK-TYP-CDE2 TO PRTRTK-STK-TYP-CDE          24270099
254900             EXEC SQL                                             26540099
255000                 UPDATE TPRTRTK                                   26550099
255100                 SET                                              26560099
255200                      STK_TYP_CDE       = :PRTRTK-STK-TYP-CDE     26570099
255300               WHERE PRTR_TRK_NBR       = :PRTRTK-PRTR-TRK-NBR    26580099
255400                 AND PRTR_ID            = :ASC-PRTR-ID            26590099
255500                 AND PRTR_OPER_UNT_ID   = :ASC-OPER-UNT-ID        26600099
255600                 AND PRTR_FCLTY_ID      = :ASC-FCLTY-ID           26610099
255700             END-EXEC                                             26620099
255800             PERFORM 7200A-CHECK-SQLCODE                          26381099
255900         END-IF.                                                  26630099
256000                                                                  26640099
256100 7200A-CHECK-SQLCODE.                                             26641099
256200         EVALUATE TRUE                                            26650099
256300             WHEN SQLCODE = +0                                    26660099
256600                 SET ASC-TPRTRTK-UPDATED TO TRUE                  26690099
256700             WHEN SQLCODE = +100                                  26691099
256800                 PERFORM 6200-INSERT-TPRTRTK                      26692099
256810             WHEN SQLCODE = -904                                  26670099
256820             WHEN SQLCODE = -913                                  26680099
256830             WHEN SQLCODE = -911                                  19630099
256840                 PERFORM 9900-SOFT-ABORT                          19640099
256900             WHEN SQLWARN0 NOT = SPACES                           26700099
257000             WHEN SQLCODE < +0                                    26710099
257100             WHEN SQLCODE > +0                                    26720099
257200                 MOVE '7200-UPDATE-TPRTRTK'                       26730099
257300                                   TO DP013-PARAGRAPH             26740099
257400                 MOVE 'ERROR UPDATING THE TRACKS TABLE'           26750099
257500                                   TO DP013-MESSAGE-TEXT (1)      26760099
257600                 MOVE SQLCA        TO DP013-SQLCA                 26770099
257700                 MOVE 'TPRTRTK'    TO DP013-DB2-TABLE-NAME (1)    26780099
257800                 SET DP013-DB2-ABEND                              26790099
257900                     DP013-XCTL-DISPLAY-RESTART TO TRUE           26800099
258000                 PERFORM DP013-0000-PROCESS-ABEND                 26810099
258100         END-EVALUATE.                                            26820099
258200                                                                  26990099
258300*                                                                 27000099
258400*----------------------------------------------------------------*27010099
258500* DELETE A ROW FROM THE PRINTER ID TABLE                          27020099
258600*----------------------------------------------------------------*27030099
258700 8100-DELETE-TPRTRID.                                             27040099
259400                                                                  27110099
259500         EXEC SQL                                                 27120099
259600             DELETE FROM TPRTRID                                  27130099
259700            WHERE PRTR_ID          = :ASC-PRTR-ID                 27140099
259800              AND PRTR_OPER_UNT_ID = :ASC-OPER-UNT-ID             27150099
259900              AND PRTR_FCLTY_ID    = :ASC-FCLTY-ID                27160099
260000         END-EXEC                                                 27170099
260100         EVALUATE TRUE                                            27180099
260200             WHEN SQLCODE = +0                                    27190099
260500                 SET ASC-TPRTRID-DELETED TO TRUE                  27220099
260510             WHEN SQLCODE = -904                                  27200099
260520             WHEN SQLCODE = -913                                  27210099
260530             WHEN SQLCODE = -911                                  19630099
260540                 PERFORM 9900-SOFT-ABORT                          19640099
260600             WHEN SQLWARN0 NOT = SPACES                           27230099
260700             WHEN SQLCODE < +0                                    27240099
260800             WHEN SQLCODE > +0                                    27250099
260900                 MOVE '8100-DELETE-TPRTRID'                       27260099
261000                                   TO DP013-PARAGRAPH             27270099
261100                 MOVE 'ERROR DELETING A ROW FROM TPRTRID'         27280099
261200                                   TO DP013-MESSAGE-TEXT (1)      27290099
261300                 MOVE SQLCA        TO DP013-SQLCA                 27300099
261400                 MOVE 'TPRTRID'    TO DP013-DB2-TABLE-NAME (1)    27310099
261500                 SET DP013-DB2-ABEND                              27320099
261600                     DP013-XCTL-DISPLAY-RESTART TO TRUE           27330099
261700                 PERFORM DP013-0000-PROCESS-ABEND                 27340099
261800         END-EVALUATE.                                            27350099
261900                                                                  27360099
263700*----------------------------------------------------------------*27540099
263800* DELETE ALL ROWS FROM THE PRINTER TRACK TABLE FOR A GIVEN PRTR   27550099
263900*----------------------------------------------------------------*27560099
264000 8200-DELETE-TPRTRTK.                                             27570099
264100                                                                  27640099
264200             EXEC SQL                                             27650099
264300                 DELETE FROM TPRTRTK                              27660099
264400                WHERE PRTR_ID          = :ASC-PRTR-ID             27670099
264500                  AND PRTR_OPER_UNT_ID = :ASC-OPER-UNT-ID         27680099
264600                  AND PRTR_FCLTY_ID    = :ASC-FCLTY-ID            27690099
264700             END-EXEC                                             27700099
264800                                                                          
264900             EVALUATE TRUE                                        27710099
265000                 WHEN SQLCODE = +0                                27720099
265100                 WHEN SQLCODE = +100                              27720099
265200                     SET ASC-TPRTRTK-DELETED TO TRUE              27750099
265300                 WHEN SQLCODE = -904                              27730099
265400                 WHEN SQLCODE = -913                              27740099
265410                 WHEN SQLCODE = -911                              19630099
265420                     PERFORM 9900-SOFT-ABORT                      19640099
265600                 WHEN SQLWARN0 NOT = SPACES                       27760099
265700                 WHEN SQLCODE < +0                                27770099
265800                 WHEN SQLCODE > +0                                27780099
265900                     MOVE '8200-DELETE-TPRTRTK'                   27790099
266000                                       TO DP013-PARAGRAPH         27800099
266100                     MOVE 'ERROR DELETING A ROW FROM TPRTRTK'     27810099
266200                                       TO DP013-MESSAGE-TEXT (1)  27820099
266300                     MOVE SQLCA        TO DP013-SQLCA             27830099
266400                     MOVE 'TPRTRTK'    TO DP013-DB2-TABLE-NAME (1)27840099
266500                     SET DP013-DB2-ABEND                          27850099
266600                         DP013-XCTL-DISPLAY-RESTART TO TRUE       27860099
266700                     PERFORM DP013-0000-PROCESS-ABEND             27870099
266800             END-EVALUATE.                                        27880099
266900                                                                  27530099
267000*----------------------------------------------------------------*27540099
267100* DELETE THE PRTR-TRK-NBR ROW FOR A GIVEN PRTR                    27550099
267200*----------------------------------------------------------------*27560099
267300 8210-DELETE-TPRTRTK.                                             27570099
267400                                                                  27640099
267500             EXEC SQL                                             27650099
267600                 DELETE FROM TPRTRTK                              27660099
267700                WHERE PRTR_ID          = :ASC-PRTR-ID             27670099
267800                  AND PRTR_OPER_UNT_ID = :ASC-OPER-UNT-ID         27680099
267900                  AND PRTR_FCLTY_ID    = :ASC-FCLTY-ID            27690099
268000                  AND PRTR_TRK_NBR     = :PRTRTK-PRTR-TRK-NBR     27690099
268100             END-EXEC                                             27700099
268200                                                                          
268300             EVALUATE TRUE                                        27710099
268400                 WHEN SQLCODE = +0                                27720099
268500                 WHEN SQLCODE = +100                              27720099
268600                     SET ASC-TPRTRTK-DELETED TO TRUE              27750099
268700                 WHEN SQLCODE = -904                              27730099
268800                 WHEN SQLCODE = -913                              27740099
268810                 WHEN SQLCODE = -911                              19630099
268820                     PERFORM 9900-SOFT-ABORT                      19640099
269000                 WHEN SQLWARN0 NOT = SPACES                       27760099
269100                 WHEN SQLCODE < +0                                27770099
269200                 WHEN SQLCODE > +0                                27780099
269300                     MOVE '8200-DELETE-TPRTRTK'                   27790099
269400                                       TO DP013-PARAGRAPH         27800099
269500                     MOVE 'ERROR DELETING A ROW FROM TPRTRTK'     27810099
269600                                       TO DP013-MESSAGE-TEXT (1)  27820099
269700                     MOVE SQLCA        TO DP013-SQLCA             27830099
269800                     MOVE 'TPRTRTK'    TO DP013-DB2-TABLE-NAME (1)27840099
269900                     SET DP013-DB2-ABEND                          27850099
270000                         DP013-XCTL-DISPLAY-RESTART TO TRUE       27860099
270100                     PERFORM DP013-0000-PROCESS-ABEND             27870099
270200             END-EVALUATE.                                        27880099
270300*                                                                 28060099
270400*----------------------------------------------------------------*28070099
270500* THIS PARAGRAPH IS NEEDED TO MAKE SURE PRINTER STATUS CODE       28080099
270600* ENTERED IS 'A' OR 'I' ONLY.                                     28090099
270700*----------------------------------------------------------------*28100099
270800 9000-PROCESS-PRTR-STAT-CDE.                                      28110099
270900                                                                  28120099
271000     EVALUATE TRUE                                                28130099
271100         WHEN  ASC-PRTR-STAT-ACTIVE                               28140099
271200                   SET  PV-STAT-1-ACTIVE                          28150099
271300                        PV-STAT-2-ACTIVE       TO  TRUE           28160099
271400                  MOVE  PC-A TO CN162-PRTR-PHY-STAT-CDE           28170099
271500         WHEN  ASC-PRTR-STAT-INACTIVE                             28180099
271600                   SET  PV-STAT-1-INACTIVE                        28190099
271700                        PV-STAT-2-INACTIVE     TO  TRUE           28200099
271800                  MOVE  PC-I TO CN162-PRTR-PHY-STAT-CDE           28210099
271900     END-EVALUATE.                                                28220099
272000*                                                                 28230099
272100*                                                                 28240099
272200*----------------------------------------------------------------*28250099
272300* THIS PARAGRAPH IS NEEDED TO MAKE SURE NUMBER OF TRACKS          28260099
272400* ENTERED IS '1', '2', OR '3' ONLY.                               28270099
272500*----------------------------------------------------------------*28280099
272600*9050-PROCESS-PAPR-TRK-QTY.                                       28290099
272700*                                                                 28300099
272800*    EVALUATE TRUE                                                28310099
272900*        WHEN  ASC-PAPR-TRK-QTY-1                                 28320099
273000*                  SET  PV-PAPR-TRK1-1                            28330099
273100*                       PV-PAPR-TRK1-2                            28340099
273200*                       PV-PAPR-TRK1-3         TO  TRUE           28350099
273300*        WHEN  ASC-PAPR-TRK-QTY-2                                 28360099
273400*                  SET  PV-PAPR-TRK2-1                            28370099
273500*                       PV-PAPR-TRK2-2                            28380099
273600*                       PV-PAPR-TRK2-3         TO  TRUE           28390099
273700*        WHEN  ASC-PAPR-TRK-QTY-3                                 28400099
273800*                  SET  PV-PAPR-TRK3-1                            28410099
273900*                       PV-PAPR-TRK3-2                            28420099
274000*                       PV-PAPR-TRK3-3         TO  TRUE           28430099
274100*    END-EVALUATE.                                                28440099
274200*                                                                 28450099
274300*                                                                 28460099
274400*----------------------------------------------------------------*28470099
274500* READ AN ITEM FROM THE SELECTED ITEMS TEMP STORAGE QUEUE.       *28480099
274600*----------------------------------------------------------------*28490099
274700 9100-READ-SEL-QUEUE.                                             28500099
274800     EXEC CICS                                                    28510099
274900         READQ TS                                                 28520099
275000             QUEUE (ASC-SEL-QUEUE-NAME)                           28530099
275100             INTO  (CN163-SELECT-RECORD)                          28540099
275200             ITEM  (ASC-SEL-ITEM)                                 28550099
275300             RESP  (PV-CICS-RESPONSE)                             28560099
275400     END-EXEC.                                                    28570099
275500                                                                  28580099
275600     IF  PV-CICS-RESPONSE = DFHRESP(NORMAL)                       28590099
275700         CONTINUE                                                 28600099
275800     ELSE                                                         28610099
275900         SET DP013-LOGIC-ABEND                                    28620099
276000             DP013-NO-ROLLBACK     TO TRUE                        28630099
276100         MOVE '9100-READ-SEL-QUEUE'                               28640099
276200                                   TO DP013-PARAGRAPH             28650099
276300         MOVE 'ATTEMPTING TO READ THE LIST SELECTIONS TS QUEUE'   28660099
276400                                   TO DP013-MESSAGE-TEXT (1)      28670099
276500         PERFORM DP013-0000-PROCESS-ABEND                         28680099
276600     END-IF.                                                      28690099
276700*                                                                 28700099
276800*                                                                 28710099
276900*----------------------------------------------------------------*28720099
277000* UPDATE AN ITEM IN THE SELECTED ITEMS TEMP STORAGE QUEUE.       *28730099
277100*----------------------------------------------------------------*28740099
277200 9200-REWRITE-SEL-QUEUE.                                          28750099
277300     EXEC CICS                                                    28760099
277400          WRITEQ TS                                               28770099
277500              QUEUE  (ASC-SEL-QUEUE-NAME)                         28780099
277600              FROM   (CN163-SELECT-RECORD)                        28790099
277700              ITEM   (ASC-SEL-ITEM)                               28800099
277800              RESP   (PV-CICS-RESPONSE)                           28810099
277900              REWRITE                                             28820099
278000     END-EXEC.                                                    28830099
278100                                                                  28840099
278200     IF  PV-CICS-RESPONSE NOT = DFHRESP(NORMAL)                   28850099
278300         SET DP013-CICS-ABEND                                     28860099
278400             DP013-NO-ROLLBACK     TO TRUE                        28870099
278500         MOVE '9200-REWRITE-SEL-QUEUE'                            28880099
278600                                   TO DP013-PARAGRAPH             28890099
278700         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   28900099
278800                                   TO DP013-MESSAGE-TEXT (1)      28910099
278900         PERFORM DP013-0000-PROCESS-ABEND                         28920099
279000     END-IF.                                                      28930099
279100*                                                                 28940099
279200 9900-SOFT-ABORT.                                                         
279300     SET PS-ERROR         TO TRUE.                                        
279400     SET DP020-MSG-FATAL  TO TRUE.                                        
279500     MOVE 'THROUGH SOFT-ABORT PARA'                                       
279600                            TO DP013-MESSAGE-TEXT (1)                     
279700     MOVE PC-TSYMSG-00551 TO DP020-MSG-NUMBER.                            
279900     SET DP020-NEXT-ACT-APPL-ERROR TO TRUE                                
280100     PERFORM 9901-BACKUP.                                                 
280200     MOVE 'PROGRAM EXIT CALL' TO DP013-MESSAGE-TEXT (1).                  
280300     PERFORM 0001-CALL-CICS-ARCH-API.                                     
280400                                                                          
280500 9901-BACKUP.                                                             
280600     EXEC CICS SYNCPOINT                                                  
280700         ROLLBACK                                                         
280800     END-EXEC.                                                            
280900                                                                          
281000*                                                                 28950099
281100     COPY DPPD013.                                                28960099
281200*----------------------------------------------------------------*28970099
281300*    ABEND PROCESSOR MODULE                                      *28980099
281400*----------------------------------------------------------------*28990099
