000100*************************                                         00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300*************************                                         00030000
000400 PROGRAM-ID.      SEKRP007.                                       00040000
000500 AUTHOR.          MIKE SOMMERS.                                   00050000
000600 DATE-WRITTEN.    DECEMBER 2005.                                  00060000
000700                                                                  00070000
000800*        READ AN IDENTITY MANAGEMENT EXTRACT FILE AND LIST        00080000
000900*        ASSOCIATES WITHOUT USER ID'S.                            00090000
001020                                                                  00102000
001030 ENVIRONMENT DIVISION.                                            00103000
001040 CONFIGURATION SECTION.                                           00104000
001050 SOURCE-COMPUTER. IBM-3090.                                       00105000
001060 OBJECT-COMPUTER. IBM-3090.                                       00106000
001070                                                                  00107000
001080 INPUT-OUTPUT SECTION.                                            00108000
001090 FILE-CONTROL.                                                    00109000
001100     SELECT ID-MGMT-EXTRACT-FILE       ASSIGN TO INP01.           00110000
001200     SELECT PRINT-FILE                 ASSIGN TO RPT01.           00120000
001300     EJECT                                                        00130000
001400***************                                                   00140000
001500 DATA DIVISION.                                                   00150000
001600***************                                                   00160000
001700 FILE SECTION.                                                    00170000
001800 FD  ID-MGMT-EXTRACT-FILE                                         00180000
001900                             BLOCK CONTAINS 0 RECORDS,            00190000
002000                             RECORD CONTAINS 242 CHARACTERS,      00200013
002100                             RECORDING MODE IS F,                 00210000
002200                             LABEL RECORDS ARE STANDARD,          00220000
002300                             DATA RECORD IS ID-MGMT-REC.          00230000
002400 01  ID-MGMT-REC             PIC X(242).                          00240013
002500                                                                  00250000
002600 FD  PRINT-FILE                                                   00260000
002700                             BLOCK CONTAINS 0 RECORDS,            00270000
002800                             RECORD CONTAINS 132 CHARACTERS,      00280000
002900                             RECORDING MODE IS F,                 00290000
003000                             LABEL RECORDS ARE STANDARD,          00300000
003100                             DATA RECORD IS PRINT-REC.            00310000
003200 01  PRINT-REC               PIC X(132).                          00320000
003300     EJECT                                                        00330000
003400*************************                                         00340000
003500 WORKING-STORAGE SECTION.                                         00350000
003600*************************                                         00360000
003700******************************************************************00370000
003800*   IDENTITY MANAGEMENT EXTRACT RECORD LAYOUT                     00380000
003900******************************************************************00390000
004000     COPY SERD005.                                                00400000
004100                                                                  00410000
004200                                                                  00420000
004300******************************************************************00430000
004400*   REPORT RECORD                                                 00440000
004500******************************************************************00450000
004600 01  RR-REPORT-RECORD.                                            00460000
004700     05  FILLER                      PIC X(6)      VALUE SPACES.  00470006
004710     05  RR-PERSON-TYPE              PIC X(14)     VALUE SPACES.  00471010
004900     05  FILLER                      PIC X(2)      VALUE SPACES.  00490010
005000     05  RR-EMPLOYEE-NBR             PIC X(7)      VALUE SPACES.  00500000
005100     05  FILLER                      PIC X(8)      VALUE SPACES.  00510003
005400     05  RR-NAME                     PIC X(40)     VALUE SPACES.  00540000
005700     05  FILLER                      PIC X(4)      VALUE SPACES.  00570000
005800     05  RR-EMPLOYEE-LOCATION        PIC X(4)      VALUE SPACES.  00580000
005810     05  FILLER                      PIC X(6)      VALUE SPACES.  00581006
005820     05  RR-EMPLOYEE-DEPARTMENT      PIC X(7)      VALUE SPACES.  00582000
005900     05  FILLER                      PIC X(4)      VALUE SPACES.  00590000
006100                                                                  00610000
006200 01  SL-SEPARATOR-LINE.                                           00620000
006300     05  FILLER                      PIC X(1)      VALUE SPACES.  00630000
006400     05  FILLER                      PIC X(131)    VALUE ALL '-'. 00640000
006500                                                                  00650000
006600 01  TR1-TOTAL-RECORD-1.                                          00660000
006700     05  FILLER                      PIC X(4)      VALUE SPACES.  00670000
006800     05  FILLER                      PIC X(16)     VALUE          00680000
006900         'TOTAL NUMBER OF '.                                      00690000
007000     05  TR1-TOTAL-TYPE              PIC X(15)     VALUE SPACES.  00700010
007100     05  FILLER                      PIC X(20)     VALUE          00710000
007200         ' WITHOUT USER ID''S: '.                                 00720000
007500     05  TR1-HR-TOTAL                PIC ZZZZ9     VALUE ZEROES.  00750000
007600     05  FILLER                      PIC X(72)     VALUE SPACES.  00760010
007700     EJECT                                                        00770000
007800 01  HEADING-LINE1.                                               00780000
007900     05  HL1-DATE.                                                00790000
008000         10  HL1-MM              PIC 9(2)    VALUE ZEROES.        00800000
008100         10  FILLER              PIC X(1)    VALUE '-'.           00810000
008200         10  HL1-DD              PIC 9(2)    VALUE ZEROES.        00820000
008300         10  FILLER              PIC X(1)    VALUE '-'.           00830000
008400         10  HL1-YY              PIC 9(2)    VALUE ZEROES.        00840000
008500     05  FILLER                  PIC X(2)    VALUE SPACES.        00850000
008600     05  HL1-TIME.                                                00860000
008700         10  HL1-HR              PIC 9(2)    VALUE ZEROES.        00870000
008800         10  FILLER              PIC X(1)    VALUE ':'.           00880000
008900         10  HL1-MN              PIC 9(2)    VALUE ZEROES.        00890000
009000         10  FILLER              PIC X(1)    VALUE ':'.           00900000
009100         10  HL1-SC              PIC 9(2)    VALUE ZEROES.        00910000
009200     05  FILLER                  PIC X(23)   VALUE SPACES.        00920000
009300     05  FILLER                  PIC X(48)                        00930000
009400         VALUE 'K O H L '' S   D E P A R T M E N T   S T O R E S'.00940000
009500     05  FILLER                  PIC X(22)   VALUE SPACES.        00950000
009600     05  FILLER                  PIC X(9)    VALUE 'SEKRP007-'.   00960000
009700     05  HL1-RPTNO               PIC 9(1)    VALUE 1.             00970000
009800     05  FILLER                  PIC X(7)    VALUE '  PAGE '.     00980000
009900     05  HL1-PAGE                PIC ZZZ9    VALUE ZEROES.        00990000
010000                                                                  01000000
010100 01  HEADING-LINE2.                                               01010000
010200     05  FILLER                  PIC X(46)      VALUE SPACES.     01020003
010300     05  FILLER                  PIC X(37)      VALUE             01030000
010400         'INDIVIDUALS ON LDAP WITHOUT USER ID''S'.                01040000
010700     05  FILLER                  PIC X(49)      VALUE SPACES.     01070003
010800                                                                  01080000
010900 01  HEADING-LINE3.                                               01090000
010910     05  FILLER                  PIC X(3)       VALUE SPACES.     01091006
011000     05  FILLER                  PIC X(52)      VALUE             01100000
011100         ' TYPE OF PERSON    EMPL NBR       NAME              '.  01110006
011200     05  FILLER                  PIC X(52)      VALUE             01120000
011300         '                        LOCATION   DEPARTMENT       '.  01130003
011400     05  FILLER                  PIC X(25)      VALUE SPACES.     01140006
011700     EJECT                                                        01170000
011800 01  WS-WORKING-STORAGE.                                          01180000
011900     05  WS-PAGE-CNT             PIC 9(3) COMP  VALUE ZEROES.     01190000
012000     05  WS-LINE-CNT             PIC 9(2)       VALUE 80.         01200000
012500     05  WS-HOLD-COMMON-NAME     PIC X(40)      VALUE SPACES.     01250000
012800     05  WS-EMPLOYEE-REC-CNT     PIC 9(5) COMP  VALUE ZEROES.     01280010
012900     05  WS-CONTRACTOR-REC-CNT   PIC 9(5) COMP  VALUE ZEROES.     01290000
013000     05  WS-STORE-EMPL-REC-CNT   PIC 9(5) COMP  VALUE ZEROES.     01300010
013200     05  WS-CLASSIFICATION       PIC X(16)      VALUE SPACES.     01320000
013300         88  WSC-EMPLOYEE                       VALUE             01330000
013400             'KOHLS_EMPLOYEE  '.                                  01340000
013500         88  WSC-CONTRACTOR                     VALUE             01350000
013600             'KOHLS_CONTRACTOR'.                                  01360000
013700         88  WSC-STORE-EMPLOYEE                 VALUE             01370010
013800             'KOHLS_STORE_EMPL'.                                  01380010
014100     05  WS-DATE.                                                 01410000
014200         10  WS-YR               PIC 9(2)       VALUE ZEROES.     01420000
014300         10  WS-MO               PIC 9(2)       VALUE ZEROES.     01430000
014400         10  WS-DY               PIC 9(2)       VALUE ZEROES.     01440000
014500     05  WS-TIME.                                                 01450000
014600         10  WS-HR               PIC 9(2)       VALUE ZEROES.     01460000
014700         10  WS-MIN              PIC 9(2)       VALUE ZEROES.     01470000
014800         10  WS-SEC              PIC 9(2)       VALUE ZEROES.     01480000
014900         10  WS-HSEC             PIC 9(2)       VALUE ZEROES.     01490000
017700 01  ID-MGMT-EXTRACT-FILE-EOF    PIC 9(1)       VALUE ZEROES.     01770000
017800     88 IMEF-EOF                                VALUE 1.          01780000
017900                                                                  01790000
018000 01  ABEND-CODE                  PIC 9(2) COMP  VALUE ZEROES.     01800000
018100     EJECT                                                        01810000
018200********************                                              01820000
018300 PROCEDURE DIVISION.                                              01830000
018400********************                                              01840000
018500     DISPLAY '****************************'                       01850000
018600     DISPLAY '** BEGIN PROGRAM SEKRP007 **'                       01860000
018700     DISPLAY '****************************'                       01870000
018800     DISPLAY ' '.                                                 01880000
018900                                                                  01890000
019000     ACCEPT WS-TIME FROM TIME.                                    01900000
019100     ACCEPT WS-DATE FROM DATE.                                    01910000
019200     MOVE WS-HR  TO HL1-HR.                                       01920000
019300     MOVE WS-MIN TO HL1-MN.                                       01930000
019400     MOVE WS-SEC TO HL1-SC.                                       01940000
019500     MOVE WS-MO  TO HL1-MM.                                       01950000
019600     MOVE WS-DY  TO HL1-DD.                                       01960000
019700     MOVE WS-YR  TO HL1-YY.                                       01970000
019800                                                                  01980000
019900     OPEN INPUT  ID-MGMT-EXTRACT-FILE.                            01990000
020000     OPEN OUTPUT PRINT-FILE.                                      02000000
020100                                                                  02010000
020200     PERFORM A200-READ-ID-MGMT-EXTRACT-FILE                       02020001
020400         UNTIL IMEF-EOF.                                          02040000
020500     PERFORM Y900-WRITE-TOTALS.                                   02050000
020600                                                                  02060000
020700     CLOSE ID-MGMT-EXTRACT-FILE                                   02070000
020800           PRINT-FILE.                                            02080000
020900                                                                  02090000
021000     DISPLAY ' '.                                                 02100000
021100     DISPLAY '****************************'                       02110000
021200     DISPLAY '**  END PROGRAM SEKRP007  **'                       02120000
021300     DISPLAY '****************************'                       02130000
021400     STOP RUN.                                                    02140000
021500                                                                  02150000
021600********************************                                  02160000
021700 A200-READ-ID-MGMT-EXTRACT-FILE.                                  02170000
021800********************************                                  02180000
022200     READ ID-MGMT-EXTRACT-FILE INTO SE005-LDAP-EXTRACT            02220004
022300         AT END                                                   02230004
022400          MOVE 1 TO ID-MGMT-EXTRACT-FILE-EOF.                     02240005
022501                                                                  02250104
022510     IF IMEF-EOF                                                  02251004
022520         CONTINUE                                                 02252004
022530     ELSE                                                         02253004
022540         PERFORM R000-MOVE-FIELDS-TO-REPORT                       02254004
022550     END-IF.                                                      02255004
022600                                                                  02260000
026100                                                                  02610000
026200****************************                                      02620000
026300 R000-MOVE-FIELDS-TO-REPORT.                                      02630000
026400****************************                                      02640000
026500     INITIALIZE RR-REPORT-RECORD.                                 02650000
026800     MOVE SE005-ASSOC-ID               TO RR-EMPLOYEE-NBR.        02680000
027000     MOVE SE005-COMMON-NAME            TO RR-NAME.                02700000
027100     MOVE SE005-LOC-NBR                TO RR-EMPLOYEE-LOCATION.   02710000
027200     MOVE SE005-DEPT-NBR               TO RR-EMPLOYEE-DEPARTMENT. 02720000
027300     MOVE SE005-CLASSIFICATION         TO WS-CLASSIFICATION.      02730000
027310     IF WSC-EMPLOYEE                                              02731000
027320         MOVE 'EMPLOYEE      '         TO RR-PERSON-TYPE.         02732011
027330     IF WSC-CONTRACTOR                                            02733000
027340         MOVE 'CONTRACTOR    '         TO RR-PERSON-TYPE.         02734010
027350     IF WSC-STORE-EMPLOYEE                                        02735010
027360         MOVE 'STORE EMPLOYEE'         TO RR-PERSON-TYPE.         02736010
027400     PERFORM Y000-WRITE-REPORT-RECORD.                            02740000
027500                                                                  02750000
028500                                                                  02850000
028700     IF WSC-EMPLOYEE                                              02870000
028800         ADD 1 TO WS-EMPLOYEE-REC-CNT                             02880010
028900     END-IF.                                                      02890000
029600     IF WSC-CONTRACTOR                                            02960000
029700         ADD 1 TO WS-CONTRACTOR-REC-CNT                           02970000
029800     END-IF.                                                      02980000
029810     IF WSC-STORE-EMPLOYEE                                        02981011
029820         ADD 1 TO WS-STORE-EMPL-REC-CNT                           02982011
029830     END-IF.                                                      02983011
029900                                                                  02990000
030000**************************                                        03000000
030100 Y000-WRITE-REPORT-RECORD.                                        03010000
030200**************************                                        03020000
030300     IF WS-LINE-CNT > 59                                          03030000
030400         PERFORM Z100-HEADINGS                                    03040000
030500     END-IF.                                                      03050000
030600     IF IMEF-EOF                                                  03060000
030700         MOVE SPACES TO PRINT-REC                                 03070000
030800         WRITE PRINT-REC                                          03080000
030900             AFTER ADVANCING 1 LINE                               03090000
031000         ADD 1 TO WS-LINE-CNT                                     03100000
031100     END-IF.                                                      03110000
031200     WRITE PRINT-REC FROM RR-REPORT-RECORD                        03120000
031300         AFTER ADVANCING 1 LINE.                                  03130000
031400     ADD 1 TO WS-LINE-CNT.                                        03140000
031500                                                                  03150000
031600                                                                  03160000
032700*******************                                               03270000
032800 Y900-WRITE-TOTALS.                                               03280000
032900*******************                                               03290000
033000     IF WS-LINE-CNT > 55                                          03300000
033100         PERFORM Z100-HEADINGS                                    03310000
033200     END-IF.                                                      03320000
033300     MOVE SPACES TO PRINT-REC.                                    03330000
033310     WRITE PRINT-REC                                              03331003
033320         AFTER ADVANCING 1 LINE.                                  03332003
033400                                                                  03340000
033500     MOVE WS-EMPLOYEE-REC-CNT   TO TR1-HR-TOTAL.                  03350010
033600     MOVE 'EMPLOYEES      '     TO TR1-TOTAL-TYPE.                03360010
033700     WRITE PRINT-REC FROM TR1-TOTAL-RECORD-1                      03370000
033800         AFTER ADVANCING 1 LINE.                                  03380000
033900     MOVE SPACES TO RR-REPORT-RECORD.                             03390000
034300                                                                  03430000
034400     MOVE WS-CONTRACTOR-REC-CNT TO TR1-HR-TOTAL.                  03440007
034500     MOVE 'CONTRACTORS    '     TO TR1-TOTAL-TYPE.                03450010
034600     WRITE PRINT-REC FROM TR1-TOTAL-RECORD-1                      03460000
034700         AFTER ADVANCING 1 LINE.                                  03470000
034800                                                                  03480010
034900     MOVE WS-STORE-EMPL-REC-CNT TO TR1-HR-TOTAL.                  03490010
035000     MOVE 'STORE EMPLOYEES'     TO TR1-TOTAL-TYPE.                03500010
035100     WRITE PRINT-REC FROM TR1-TOTAL-RECORD-1                      03510010
035200         AFTER ADVANCING 1 LINE.                                  03520010
035700                                                                  03570000
035710     MOVE '** END OF REPORT **' TO RR-NAME.                       03571000
035720     WRITE PRINT-REC FROM RR-REPORT-RECORD                        03572000
035730         AFTER ADVANCING 1 LINE.                                  03573000
035800                                                                  03580000
035810                                                                  03581000
035900***************                                                   03590000
036000 Z100-HEADINGS.                                                   03600000
036100***************                                                   03610000
036200     ADD 1                 TO WS-PAGE-CNT.                        03620000
036300     MOVE 1                TO HL1-RPTNO.                          03630000
036400     MOVE WS-PAGE-CNT      TO HL1-PAGE.                           03640000
036500     MOVE SPACES           TO PRINT-REC.                          03650000
036600     WRITE PRINT-REC FROM HEADING-LINE1                           03660000
036700         AFTER ADVANCING PAGE.                                    03670000
036800     WRITE PRINT-REC FROM HEADING-LINE2                           03680000
036900         AFTER ADVANCING 1 LINE.                                  03690000
037000     WRITE PRINT-REC FROM HEADING-LINE3                           03700000
037100         AFTER ADVANCING 2 LINES.                                 03710000
037200     MOVE SPACES TO PRINT-REC.                                    03720000
037300     WRITE PRINT-REC                                              03730000
037400         AFTER ADVANCING 1 LINE.                                  03740000
037500     MOVE ZEROES TO WS-LINE-CNT.                                  03750000
