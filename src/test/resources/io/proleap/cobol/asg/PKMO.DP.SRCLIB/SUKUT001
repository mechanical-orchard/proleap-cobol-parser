000100***************************************************************** 00010089
000200 IDENTIFICATION DIVISION.                                         00020089
000300***************************************************************** 00030089
000400                                                                  00040089
000500 PROGRAM-ID.             SUKUT001.                                00050089
000600 AUTHOR.                 LARRY SCHLEICHER - STRATAGEM.            00060089
000700 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00070089
000800 DATE-WRITTEN            AUGUST, 1996.                            00080089
000900 DATE-COMPILED.                                                   00090089
001000***************************************************************** 00100089
001100***************************************************************** 00110089
001200*                                                               * 00120089
001300*  THIS PROGRAM WILL CREATE AN EXTRACT FILE OF ALL OF THE       * 00130089
001400*  CARTON RECORDS ASSOCIATED TO A TRIP.  THESE CARTON RECORDS   * 00140089
001500*  WILL BE READ BY THE REPORT PROGRAMS AS INPUT DATA.           * 00150089
001600***************************************************************** 00160089
001700*  CHANGED 10/24/02 BY ALBERT A VINOD                           * 00170089
001800*   WR# 21361 REMOVED ALL REFERENCES OF DB2 TABLES TSK AND      * 00180089
001900*             TUPCSKU.                                          * 00190089
002000***************************************************************** 00200089
002100*  CHANGED MM/DD/YY BY XXXXXXXXXXX                              * 00210089
002200*   WR# XXXX XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX * 00220089
002300*                                                               * 00230089
002400***************************************************************** 00240089
002500***************************************************************** 00250089
002600 ENVIRONMENT DIVISION.                                            00260089
002700***************************************************************** 00270089
002800                                                                  00280089
002900 CONFIGURATION SECTION.                                           00290089
003000                                                                  00300089
003100 SOURCE-COMPUTER.        IBM-3090.                                00310089
003200 OBJECT-COMPUTER.        IBM-3090.                                00320089
003300                                                                  00330089
003400 INPUT-OUTPUT SECTION.                                            00340089
003500                                                                  00350089
003600 FILE-CONTROL.                                                    00360089
003700*                                                                 00370089
003800     SELECT CARDIN-TRIP-ID-FILE                                   00380089
003900         ASSIGN TO CARDIN.                                        00390089
004000                                                                  00400089
004100     SELECT SU-EXTRACT-FILE                                       00410089
004200         ASSIGN TO OUT01.                                         00420089
004300*                                                                 00430089
004400***************************************************************** 00440089
004500 DATA DIVISION.                                                   00450089
004600***************************************************************** 00460089
004700*                                                                 00470089
004800 FILE SECTION.                                                    00480089
004900*                                                                 00490089
005000 FD  CARDIN-TRIP-ID-FILE                                          00500089
005100     LABEL RECORDS ARE STANDARD                                   00510089
005200     RECORDING MODE IS F                                          00520089
005300     BLOCK CONTAINS 0 RECORDS                                     00530089
005400     RECORD CONTAINS 80 CHARACTERS.                               00540089
005500 01  CC-RECORD                       PIC X(80).                   00550089
005600                                                                  00560089
005700 FD  SU-EXTRACT-FILE                                              00570089
005800     RECORDING MODE IS F                                          00580089
005900     BLOCK CONTAINS 0  RECORDS.                                   00590089
006000 01  SU-EXTRACT-RECORD               PIC  X(200).                 00600089
006100*                                                                 00610089
006200                                                                  00620089
006300 WORKING-STORAGE SECTION.                                         00630089
006400*                                                                 00640089
006500 01  PROGRAM-SWITCHES.                                            00650089
006600     05  PS-END-OF-TRAILER-CURSOR-SW PIC  X(01)    VALUE 'N'.     00660089
006700         88  PS-END-OF-TRAILER-CURSOR              VALUE 'Y'.     00670089
006800     05  PS-END-OF-CARTON-CURSOR-SW PIC   X(01)    VALUE 'N'.     00680089
006900         88  PS-END-OF-CARTON-CURSOR               VALUE 'Y'.     00690089
007000     05  PS-END-OF-CARDIN-SW         PIC  X(01)    VALUE 'N'.     00700089
007100         88  PS-END-OF-CARDIN                      VALUE 'Y'.     00710089
007200     05  PS-RECORD-TYPE-SW           PIC  X(01)    VALUE 'B'.     00720089
007300         88  PS-ERROR-RECORD                       VALUE 'A'.     00730089
007400         88  PS-DETAIL-RECORD                      VALUE 'B'.     00740089
007500     05  PS-AUTO-VE-RCVR-SW          PIC  X(01)    VALUE 'N'.     00750089
007600         88  PS-AUTO-VE-RCVR                       VALUE 'Y'.     00760089
007700         88  PS-AUTO-VE-RCVR-NO                    VALUE 'N'.     00770089
007800**   05  PS-ZERO-RCVR-SW             PIC  X(01)    VALUE 'N'.     00780089
007900     05  PS-ZERO-RCVR-SW             PIC  X(01).                  00790089
008000         88  PS-RCVR-EXISTS                        VALUE 'Y'.     00800089
008100         88  PS-NO-RCVR-EXISTS                     VALUE 'N'.     00810089
008200*                                                                 00820089
008300 01  PC-CONSTANTS.                                                00830089
008400     05  PC-1                        PIC S9(03)    VALUE +1       00840089
008500                                                   COMP-3.        00850089
008600     05  PC-A                        PIC  X(01)    VALUE 'A'.     00860089
008700     05  PC-B                        PIC  X(01)    VALUE 'B'.     00870089
008800     05  PC-Y                        PIC  X(01)    VALUE 'Y'.     00880089
008900     05  PC-N                        PIC  X(01)    VALUE 'N'.     00890089
009000     05  PC-RCV                      PIC  X(03)    VALUE 'RCV'.   00900089
009100     05  PC-VE                       PIC  X(02)    VALUE 'VE'.    00910089
009200     05  PC-SUKUT001                 PIC  X(08)    VALUE          00920089
009300         'SUKUT001'.                                              00930089
009400     05  PC-AUTOVE-PARM-PROGRAM    PIC X(08)  VALUE 'RCKUT127'.   00940089
009500*                                                                 00950089
009600 01  PV-MISC-FIELDS.                                              00960089
009700     05  PV-LINE-SUB                 PIC S9(03)    VALUE ZERO     00970089
009800                                                   COMP-3.        00980089
009900     05  PV-ABEND-CODE               PIC S9(04)    VALUE ZERO     00990089
010000                                                   COMP SYNC.     01000089
010100     05  PV-ABEND-PARAGRAPH          PIC  X(30)    VALUE SPACES.  01010089
010200     05  PV-ABEND-OPERATION1         PIC  X(51)    VALUE SPACES.  01020089
010300     05  PV-DB2-TABLE-NAME           PIC  X(08)    VALUE SPACES.  01030089
010400     05  PV-MANIFEST-X               PIC  X(09).                  01040089
010500     05  PV-MANIFEST REDEFINES PV-MANIFEST-X                      01050089
010600                                     PIC  9(09).                  01060089
010700 EJECT                                                            01070089
010800*                                                                 01080089
010900                                                                  01090089
011000 01  CC-CARDIN.                                                   01100089
011100     05  CC-MANIFEST                 PIC X(09).                   01110089
011200     05  FILLER                      PIC X(71).                   01120089
011300                                                                  01130089
011400*                                                                 01140089
011500     COPY SURD001.                                                01150089
011600                                                                  01160089
011700*                                                                 01170089
011800*-----------------------------------------------------------------01180089
011900*  COPYBOOK FOR AUTO VE ACCESS MODULE                             01190089
012000*-----------------------------------------------------------------01200089
012100     COPY RCWS040.                                                01210089
012200                                                                  01220089
012300*                                                                 01230089
012400*  COPY BOOK FOR SHIPMENT TABLE                                   01240089
012500*                                                                 01250089
012600     EXEC SQL                                                     01260089
012700          INCLUDE TSHIPMT                                         01270089
012800     END-EXEC.                                                    01280089
012900*                                                                 01290089
013000*  COPY BOOK FOR SHIPMENT PO TABLE                                01300089
013100*                                                                 01310089
013200     EXEC SQL                                                     01320089
013300          INCLUDE TSHPTPO                                         01330089
013400     END-EXEC.                                                    01340089
013500*                                                                 01350089
013600*  COPY BOOK FOR PURCHASE ORDER TABLE                             01360089
013700*                                                                 01370089
013800     EXEC SQL                                                     01380089
013900          INCLUDE TPURCHS                                         01390089
014000     END-EXEC.                                                    01400089
014100*                                                                 01410089
014200*  COPY BOOK FOR EXTERNAL ENTITY TABLE                            01420089
014300*                                                                 01430089
014400     EXEC SQL                                                     01440089
014500          INCLUDE TEXTENT                                         01450089
014600     END-EXEC.                                                    01460089
014700*                                                                 01470089
014800*  COPY BOOK FOR EXTERNAL ENTITY NAME TABLE                       01480089
014900*                                                                 01490089
015000     EXEC SQL                                                     01500089
015100          INCLUDE TENTNME                                         01510089
015200     END-EXEC.                                                    01520089
015300*                                                                 01530089
015400*  COPY BOOK FOR THE TROUBLE REASON TABLE                         01540089
015500*                                                                 01550089
015600     EXEC SQL                                                     01560089
015700          INCLUDE TTRBRSN                                         01570089
015800     END-EXEC.                                                    01580089
015900*                                                                 01590089
016000*  COPY BOOK FOR THE TROUBLE NOTIFICATION TABLE                   01600089
016100*                                                                 01610089
016200     EXEC SQL                                                     01620089
016300          INCLUDE TTRBNTF                                         01630089
016400     END-EXEC.                                                    01640089
016500*                                                                 01650089
016600*  COPY BOOK FOR SHIPMENT UNIT/UPC ASSOCIATION                    01660089
016700*                                                                 01670089
016800     EXEC SQL                                                     01680089
016900          INCLUDE TSHUUPC                                         01690089
017000     END-EXEC.                                                    01700089
017100*                                                                 01710089
017200*  COPY BOOK FOR PACKSLIP TABLE                                   01720089
017300*                                                                 01730089
017400     EXEC SQL                                                     01740089
017500          INCLUDE TPKSLIP                                         01750089
017600     END-EXEC.                                                    01760089
017700*                                                                 01770089
017800*  COPY BOOK FOR INBOUND EDI PACKSLIP/VENDOR SHIPMENT UNIT ASSOC T01780089
017900*                                                                 01790089
018000     EXEC SQL                                                     01800089
018100          INCLUDE TINPKSU                                         01810089
018200     END-EXEC.                                                    01820089
018300*                                                                 01830089
018400*  COPY BOOK FOR SHIPMENT UNIT LOCATION                           01840089
018500*                                                                 01850089
018600     EXEC SQL                                                     01860089
018700          INCLUDE TSHUNLO                                         01870089
018800     END-EXEC.                                                    01880089
018900*                                                                 01890089
019000*  COPY BOOK FOR SHIPMENT UNIT TABLE                              01900089
019100*                                                                 01910089
019200     EXEC SQL                                                     01920089
019300          INCLUDE TSHPUNT                                         01930089
019400     END-EXEC.                                                    01940089
019500******************************************************************01950089
019600*   REMOVED REFERENCES OF DB2 TABLE TSK               WR # 21361 *01960089
019700******************************************************************01970089
019800******************************************************************01980089
019900*   REMOVED REFERENCES OF DB2 TABLE TUPCSKU           WR # 21361 *01990089
020000******************************************************************02000089
020100******************************************************************02010089
020200*  CHANGES MADE FOR WR # 21361 ENDS HERE                         *02020089
020300******************************************************************02030089
020400*                                                                 02040089
020500*  COPY BOOK FOR THE VEHICLE TRIP TABLE                           02050089
020600*                                                                 02060089
020700     EXEC SQL                                                     02070089
020800          INCLUDE TVHTRIP                                         02080089
020900     END-EXEC.                                                    02090089
021000*                                                                 02100089
021100*  COPY BOOK FOR THE VEHICLE TABLE                                02110089
021200*                                                                 02120089
021300     EXEC SQL                                                     02130089
021400          INCLUDE TVEHICL                                         02140089
021500     END-EXEC.                                                    02150089
021600*                                                                 02160089
021700*  COPY BOOK FOR TRIP STATUS TABLE                                02170089
021800*                                                                 02180089
021900     EXEC SQL                                                     02190089
022000          INCLUDE TTRIPST                                         02200089
022100     END-EXEC.                                                    02210089
022200*                                                                 02220089
022300*  COPY BOOK FOR TRIP STATUS TYPE TABLE                           02230089
022400*                                                                 02240089
022500     EXEC SQL                                                     02250089
022600          INCLUDE TTRSTYP                                         02260089
022700     END-EXEC.                                                    02270089
022800*                                                                 02280089
022900*  COPY BOOK FOR THE RECEIVER TABLE                               02290089
023000*                                                                 02300089
023100     EXEC SQL                                                     02310089
023200          INCLUDE TRECEIV                                         02320089
023300     END-EXEC.                                                    02330089
023400 EJECT                                                            02340089
023500*  DB2 COMMUNICATION AREA                                         02350089
023600*                                                                 02360089
023700     EXEC SQL                                                     02370089
023800         INCLUDE SQLCA                                            02380089
023900     END-EXEC.                                                    02390089
024000 EJECT                                                            02400089
024100*  DB2 COMMUNICATION AREA2                                        02410089
024200*                                                                 02420089
024300     COPY SQLCA2.                                                 02430089
024400 EJECT                                                            02440089
024500                                                                  02450089
024600                                                                  02460089
024700     EXEC SQL                                                     02470089
024800       DECLARE TRAILER-CSR CURSOR FOR                             02480089
024900         SELECT DISTINCT                                          02490089
025000                C.PO_NBR                                          02500089
025100              , C.REC_SEQ_NBR                                     02510089
025200              , F.SHIPT_UNT_ID                                    02520089
025300          FROM  TVHTRIP A                                         02530089
025400              , TSHIPMT B                                         02540089
025500              , TSHPTPO C                                         02550089
025600              , TRECEIV D                                         02560089
025700              , TPKSLIP E                                         02570089
025800              , TINPKSU F                                         02580089
025900              , TSHPUNT G                                         02590089
026000          WHERE A.TRIP_ID           = :VHTRIP-TRIP-ID             02600089
026100            AND A.TRIP_ID           = B.TRIP_ID                   02610089
026200            AND C.SHIPT_ID          = B.SHIPT_ID                  02620089
026300            AND C.PO_NBR            = D.ORD_NBR                   02630089
026400            AND C.REC_SEQ_NBR       = D.REC_SEQ_NBR               02640089
026500            AND D.VER_STATUS_CDE    = :PC-A                       02650089
026600            AND E.VER_STAT_CDE      = :PC-A                       02660089
026700            AND C.PO_NBR            = E.PO_NBR                    02670089
026800            AND C.REC_SEQ_NBR       = E.REC_SEQ_NBR               02680089
026900            AND E.PO_NBR            = F.PO_NBR                    02690089
027000            AND E.SEQ_NBR           = F.SEQ_NBR                   02700089
027100            AND F.SHIPT_UNT_ID      = G.SHIPT_UNT_ID              02710089
027200            AND G.ACTV_IND          = 'A'                         02720089
027300     END-EXEC.                                                    02730089
027400                                                                  02740089
027500     EXEC SQL                                                     02750089
027600       DECLARE CARTON-CSR CURSOR FOR                              02760089
027700         SELECT DISTINCT                                          02770089
027800                B.SHIPT_UNT_ID                                    02780089
027900              , B.TRN_NBR                                         02790089
028000              , A.CRE_TMST                                        02800089
028100              , A.OPER_UNT_ID                                     02810089
028200              , C.ORGN_OPER_UNT_ID                                02820089
028300          FROM  TSHUNLO A                                         02830089
028400              , TSHUUPC B                                         02840089
028500              , TSHPUNT C                                         02850089
028600          WHERE A.TRIP_ID           = :VHTRIP-TRIP-ID             02860089
028700            AND A.SHIPT_UNT_ID      = B.SHIPT_UNT_ID              02870089
028800            AND A.SHIPT_UNT_ID      = C.SHIPT_UNT_ID              02880089
028900            AND A.SCN_LOC_ID        = 'RECV'                      02890089
029000            AND A.ACTV_CDE          = 'A'                         02900089
029100            AND C.ACTV_IND          = 'A'                         02910089
029200     END-EXEC.                                                    02920089
029300                                                                  02930089
029400                                                                  02940089
029500*                                                                 02950089
029600 PROCEDURE DIVISION.                                              02960089
029700*                                                                 02970089
029800 0000-MAINLINE-PROCESSING.                                        02980089
029900******************************************************************02990089
030000**  THIS IS THE MAIN DRIVER FOR THE PROGRAM.                      03000089
030100******************************************************************03010089
030200     OPEN INPUT  CARDIN-TRIP-ID-FILE                              03020089
030300          OUTPUT SU-EXTRACT-FILE.                                 03030089
030400*                                                                 03040089
030500     PERFORM 1000-INITIALIZATION.                                 03050089
030600*                                                                 03060089
030700     PERFORM 2000-PROCESS-TRAILER.                                03070089
030800     PERFORM 3000-PROCESS-CARTON.                                 03080089
030900                                                                  03090089
031000     CLOSE CARDIN-TRIP-ID-FILE                                    03100089
031100           SU-EXTRACT-FILE.                                       03110089
031200*                                                                 03120089
031300     GOBACK.                                                      03130089
031400*                                                                 03140089
031500*                                                                 03150089
031600 1000-INITIALIZATION.                                             03160089
031700******************************************************************03170089
031800**  PERFORM THE INITIAL PROCESSING FOR THE PROGRAM.               03180089
031900******************************************************************03190089
032000                                                                  03200089
032100     READ CARDIN-TRIP-ID-FILE INTO CC-CARDIN                      03210089
032200        AT END                                                    03220089
032300           SET PS-END-OF-CARDIN TO TRUE.                          03230089
032400                                                                  03240089
032500     IF PS-END-OF-CARDIN                                          03250089
032600         DISPLAY '** SUKUT001 ABEND **'                           03260089
032700         DISPLAY '** CARDIN (STORE NUMBER) FILE IS EMPTY **'      03270089
032800         MOVE +4019                  TO PV-ABEND-CODE             03280089
032900         CALL 'ILBOABN0' USING PV-ABEND-CODE                      03290089
033000     END-IF.                                                      03300089
033100                                                                  03310089
033200     DISPLAY 'TRIP ID IS : ' CC-MANIFEST.                         03320089
033300                                                                  03330089
033400     MOVE CC-MANIFEST         TO PV-MANIFEST-X.                   03340089
033500     MOVE PV-MANIFEST         TO VHTRIP-TRIP-ID.                  03350089
033600     MOVE PV-MANIFEST         TO SU001-MANIFEST-NBR.              03360089
033700     MOVE ZERO                TO SU001-SHIPT-UNT-ID.              03370089
033800     MOVE ZERO                TO SU001-PO-NUMBER.                 03380089
033900     MOVE ZERO                TO SU001-REC-SEQ-NBR.               03390089
034000     MOVE PC-Y                TO SU001-SCANNED-IND                03400089
034100                                 SU001-MISDIRECT-IND              03410089
034200                                 SU001-NOT-FOUND-IND              03420089
034300                                 SU001-FREE-ASTRAY-IND            03430089
034400                                 SU001-ANOTHER-TRAILER-IND.       03440089
034500     MOVE SPACES              TO SU001-BRCDE-NBR                  03450089
034600                                 SU001-TSULBXF-USED               03460089
034700     MOVE PC-B                TO SU001-RECORD-TYPE-IND.           03470089
034800     MOVE SPACES              TO SU001-AUTO-VE-IND.               03480089
034900     PERFORM 8000-WRITE-EXTRACT-RECORD.                           03490089
035000*                                                                 03500089
035100 2000-PROCESS-TRAILER.                                            03510089
035200     SET PS-DETAIL-RECORD TO TRUE.                                03520089
035300     PERFORM 2100-OPEN-TRAILER-CURSOR.                            03530089
035400*SLH                                                              03540089
035500*    DISPLAY 'TRAILER CURSOR OPEN'.                               03550089
035501                                                                  03550189
035502     IF PS-DETAIL-RECORD                                          03550289
035503         PERFORM 2200-FETCH-TRAILER-CURSOR                        03550389
035600     END-IF.                                                      03560089
035700     PERFORM 2300-PROCESS-TRAILER-CURSOR                          03570089
035800         UNTIL PS-END-OF-TRAILER-CURSOR                           03580089
035900            OR PS-ERROR-RECORD.                                   03590089
036000     IF PS-DETAIL-RECORD                                          03600089
036100         PERFORM 2400-CLOSE-TRAILER-CURSOR                        03610089
036200     END-IF.                                                      03620089
036300                                                                  03630089
036400 2100-OPEN-TRAILER-CURSOR.                                        03640089
036500     MOVE '2100-OPEN-TRAILER-CURSOR   '                           03650089
036600                                 TO PV-ABEND-PARAGRAPH.           03660089
036700     EXEC SQL                                                     03670089
036800         OPEN TRAILER-CSR                                         03680089
036900     END-EXEC.                                                    03690089
037000     EVALUATE TRUE                                                03700089
037100       WHEN SQLCODE = ZEROS                                       03710089
037200         CONTINUE                                                 03720089
037300       WHEN SQLCODE = -904                                        03730089
037400       WHEN SQLCODE = -911                                        03740089
037500       WHEN SQLCODE = -913                                        03750089
037600         PERFORM 2500-PROCESS-ERROR-RECORD                        03760089
037700       WHEN OTHER                                                 03770089
037800         DISPLAY PV-ABEND-PARAGRAPH                               03780089
037900         PERFORM Z999-SQL-ERROR                                   03790089
038000     END-EVALUATE.                                                03800089
038100                                                                  03810089
038200 2200-FETCH-TRAILER-CURSOR.                                       03820089
038300     MOVE '2200-FETCH-TRAILER-CURSOR   '                          03830089
038400                                 TO PV-ABEND-PARAGRAPH.           03840089
038500     EXEC SQL                                                     03850089
038600          FETCH TRAILER-CSR                                       03860089
038700          INTO  :SHPTPO-PO-NBR                                    03870089
038800              , :SHPTPO-REC-SEQ-NBR                               03880089
038900              , :INPKSU-SHIPT-UNT-ID                              03890089
039000     END-EXEC.                                                    03900089
039100                                                                  03910089
039200     EVALUATE TRUE                                                03920089
039300       WHEN SQLCODE = ZEROS                                       03930089
039400         CONTINUE                                                 03940089
039500       WHEN SQLCODE = +100                                        03950089
039600         SET PS-END-OF-TRAILER-CURSOR TO TRUE                     03960089
039700       WHEN SQLCODE = -904                                        03970089
039800       WHEN SQLCODE = -911                                        03980089
039900       WHEN SQLCODE = -913                                        03990089
040000         PERFORM 2500-PROCESS-ERROR-RECORD                        04000089
040100       WHEN OTHER                                                 04010089
040200         DISPLAY PV-ABEND-PARAGRAPH                               04020089
040300         PERFORM Z999-SQL-ERROR                                   04030089
040400     END-EVALUATE.                                                04040089
040500                                                                  04050089
040600 2300-PROCESS-TRAILER-CURSOR.                                     04060089
040700     MOVE PV-MANIFEST         TO SU001-MANIFEST-NBR.              04070089
040800     MOVE INPKSU-SHIPT-UNT-ID TO SU001-SHIPT-UNT-ID.              04080089
040900     MOVE SHPTPO-PO-NBR       TO SU001-PO-NUMBER.                 04090089
041000     MOVE SHPTPO-REC-SEQ-NBR  TO SU001-REC-SEQ-NBR.               04100089
041100*SLH                                                              04110089
041101*    DISPLAY ' PO ' SU001-PO-NUMBER ' RCVR ' SU001-REC-SEQ-NBR    04110189
041102     MOVE SPACES              TO SU001-SCANNED-IND                04110289
041200                                 SU001-MISDIRECT-IND              04120089
041300                                 SU001-NOT-FOUND-IND              04130089
041400                                 SU001-FREE-ASTRAY-IND            04140089
041500                                 SU001-ANOTHER-TRAILER-IND.       04150089
041600     MOVE SPACES              TO SU001-BRCDE-NBR                  04160089
041700                                 SU001-TSULBXF-USED               04170089
041800     MOVE PC-B                TO SU001-RECORD-TYPE-IND.           04180089
041900     PERFORM 8000-WRITE-EXTRACT-RECORD.                           04190089
042000     MOVE SPACES              TO SU001-AUTO-VE-IND.               04200089
042100     PERFORM 2200-FETCH-TRAILER-CURSOR.                           04210089
042200                                                                  04220089
042300                                                                  04230089
042400 2400-CLOSE-TRAILER-CURSOR.                                       04240089
042500     MOVE '2400-CLOSE-TRAILER-CURSOR   '                          04250089
042600                                 TO PV-ABEND-PARAGRAPH.           04260089
042700     EXEC SQL                                                     04270089
042800         CLOSE TRAILER-CSR                                        04280089
042900     END-EXEC.                                                    04290089
043000     EVALUATE TRUE                                                04300089
043100       WHEN SQLCODE = ZEROS                                       04310089
043200         CONTINUE                                                 04320089
043300       WHEN SQLCODE = -904                                        04330089
043400       WHEN SQLCODE = -911                                        04340089
043500       WHEN SQLCODE = -913                                        04350089
043600         PERFORM 2500-PROCESS-ERROR-RECORD                        04360089
043700       WHEN OTHER                                                 04370089
043800         DISPLAY PV-ABEND-PARAGRAPH                               04380089
043900         PERFORM Z999-SQL-ERROR                                   04390089
044000     END-EVALUATE.                                                04400089
044100                                                                  04410089
044200*                                                                 04420089
044300 2500-PROCESS-ERROR-RECORD.                                       04430089
044400     MOVE PV-MANIFEST         TO SU001-MANIFEST-NBR.              04440089
044500     MOVE ZERO                TO SU001-SHIPT-UNT-ID.              04450089
044600     MOVE ZERO                TO SU001-PO-NUMBER.                 04460089
044700     MOVE ZERO                TO SU001-REC-SEQ-NBR.               04470089
044800     MOVE PC-Y                TO SU001-SCANNED-IND                04480089
044900                                 SU001-MISDIRECT-IND              04490089
045000                                 SU001-NOT-FOUND-IND              04500089
045100                                 SU001-FREE-ASTRAY-IND            04510089
045200                                 SU001-ANOTHER-TRAILER-IND.       04520089
045300     MOVE SPACES              TO SU001-BRCDE-NBR                  04530089
045400                                 SU001-TSULBXF-USED               04540089
045500     MOVE PC-A                TO SU001-RECORD-TYPE-IND.           04550089
045600     MOVE SPACES              TO SU001-AUTO-VE-IND.               04560089
045700     PERFORM 8000-WRITE-EXTRACT-RECORD.                           04570089
045800                                                                  04580089
045900     SET PS-ERROR-RECORD      TO TRUE.                            04590089
046000                                                                  04600089
046100*                                                                 04610089
046200 3000-PROCESS-CARTON.                                             04620089
046300     SET PS-DETAIL-RECORD TO TRUE.                                04630089
046400     PERFORM 3100-OPEN-CARTON-CURSOR.                             04640089
046500*SLH                                                              04650089
046501*    DISPLAY 'CARTON CURSOR OPEN '.                               04650189
046502     IF PS-DETAIL-RECORD                                          04650289
046600         PERFORM 3200-FETCH-CARTON-CURSOR                         04660089
046700     END-IF.                                                      04670089
046800     PERFORM 3300-PROCESS-CARTON-CURSOR                           04680089
046900         UNTIL PS-END-OF-CARTON-CURSOR                            04690089
047000            OR PS-ERROR-RECORD.                                   04700089
047100     IF PS-DETAIL-RECORD                                          04710089
047200         PERFORM 3400-CLOSE-CARTON-CURSOR                         04720089
047300     END-IF.                                                      04730089
047400 3100-OPEN-CARTON-CURSOR.                                         04740089
047500     MOVE '3100-OPEN-CARTON-CURSOR   '                            04750089
047600                                 TO PV-ABEND-PARAGRAPH.           04760089
047700     EXEC SQL                                                     04770089
047800         OPEN CARTON-CSR                                          04780089
047900     END-EXEC.                                                    04790089
048000     EVALUATE TRUE                                                04800089
048100       WHEN SQLCODE = ZEROS                                       04810089
048200         CONTINUE                                                 04820089
048300       WHEN SQLCODE = -904                                        04830089
048400       WHEN SQLCODE = -911                                        04840089
048500       WHEN SQLCODE = -913                                        04850089
048600         PERFORM 3500-PROCESS-ERROR-RECORD                        04860089
048700       WHEN OTHER                                                 04870089
048800         DISPLAY PV-ABEND-PARAGRAPH                               04880089
048900         PERFORM Z999-SQL-ERROR                                   04890089
049000     END-EVALUATE.                                                04900089
049100                                                                  04910089
049200 3200-FETCH-CARTON-CURSOR.                                        04920089
049300     MOVE '3200-FETCH-CARTON-CURSOR   '                           04930089
049400                                 TO PV-ABEND-PARAGRAPH.           04940089
049500     EXEC SQL                                                     04950089
049600          FETCH CARTON-CSR                                        04960089
049700          INTO  :SHUUPC-SHIPT-UNT-ID                              04970089
049800              , :SHUUPC-TRN-NBR                                   04980089
049900              , :SHUNLO-CRE-TMST                                  04990089
050000              , :SHUNLO-OPER-UNT-ID                               05000089
050100              , :SHPUNT-ORGN-OPER-UNT-ID                          05010089
050200     END-EXEC.                                                    05020089
050300                                                                  05030089
050400     EVALUATE TRUE                                                05040089
050500       WHEN SQLCODE = ZEROS                                       05050089
050600         CONTINUE                                                 05060089
050700       WHEN SQLCODE = +100                                        05070089
050800           SET PS-END-OF-CARTON-CURSOR TO TRUE                    05080089
050900       WHEN SQLCODE = -904                                        05090089
051000       WHEN SQLCODE = -911                                        05100089
051100       WHEN SQLCODE = -913                                        05110089
051200         PERFORM 3500-PROCESS-ERROR-RECORD                        05120089
051300       WHEN OTHER                                                 05130089
051400         DISPLAY PV-ABEND-PARAGRAPH                               05140089
051500         PERFORM Z999-SQL-ERROR                                   05150089
051600     END-EVALUATE.                                                05160089
051700                                                                  05170089
051800 3300-PROCESS-CARTON-CURSOR.                                      05180089
051900     MOVE SHUUPC-SHIPT-UNT-ID TO SU001-SHIPT-UNT-ID.              05190089
052000     MOVE SHUUPC-TRN-NBR      TO SU001-PO-NUMBER.                 05200089
052100     MOVE PC-Y                TO SU001-SCANNED-IND.               05210089
052200                                                                  05220089
052300     PERFORM 4000-GET-RCVR-SEQ-NBR.                               05230089
052400*SLH                                                              05240089
052500*    DISPLAY 'PO ' SU001-PO-NUMBER ' RCVR '                       05250089
052600*      PKSLIP-REC-SEQ-NBR.                                        05260089
052700     IF PS-NO-RCVR-EXISTS                                         05270089
052800        SET PS-AUTO-VE-RCVR-NO TO TRUE                            05280089
052900     ELSE                                                         05290089
053000        PERFORM 4500-CALL-AUTO-VE-MODULE                          05300089
053100     END-IF.                                                      05310089
053200*SLH                                                              05320089
053300*    DISPLAY 'RETURNED FROM 4500-'                                05330089
053301     MOVE PKSLIP-REC-SEQ-NBR TO SU001-REC-SEQ-NBR.                05330189
053302                                                                  05330289
053303     IF PS-DETAIL-RECORD                                          05330389
053304         IF SHUNLO-OPER-UNT-ID = SHPUNT-ORGN-OPER-UNT-ID          05330489
053305            MOVE SPACES         TO SU001-MISDIRECT-IND            05330589
053306         ELSE                                                     05330689
053307*           IF SHUNLO-OPER-UNT-ID = RECEIV-CURR-OPER-UNT-ID       05330792
053307            IF SHUNLO-OPER-UNT-ID = RECEIV-CRE-OPER-UNT-ID        05330892
053308               MOVE SPACES      TO SU001-MISDIRECT-IND            05330992
053309            ELSE                                                  05331092
053310               MOVE PC-Y        TO SU001-MISDIRECT-IND            05332092
053400            END-IF                                                05340089
053500         END-IF                                                   05350089
053600                                                                  05360089
053700         IF PS-AUTO-VE-RCVR-NO                                    05370089
053800            PERFORM 5000-FREE-ASTRAY-CHECK                        05380089
053900         ELSE                                                     05390089
054000            IF RECEIV-FRE-ASTRA-IND = PC-Y AND                    05400089
054100               RECEIV-STATUS-CDE NOT = PC-VE                      05410089
054200               MOVE PC-Y TO SU001-FREE-ASTRAY-IND                 05420089
054400            ELSE                                                  05440089
054500               PERFORM 5000-FREE-ASTRAY-CHECK                     05450089
054600               IF SU001-FREE-ASTRAY-IND = PC-Y                    05460089
054700                  MOVE 'N' TO SU001-AUTO-VE-IND                   05470089
054800               ELSE                                               05480089
054900                  MOVE PC-N TO SU001-FREE-ASTRAY-IND              05490089
054901               END-IF                                             05490189
054902            END-IF                                                05490289
054903         END-IF                                                   05490389
054904                                                                  05490489
054905         IF PS-DETAIL-RECORD                                      05490589
055000             PERFORM 6000-DIFF-TRAILER-CHECK                      05500089
055100             IF PS-DETAIL-RECORD                                  05510089
055200                 IF SQLCODE = ZEROS OR                            05520089
055300                    SQLCODE = -811                                05530089
055400                     MOVE PC-Y   TO SU001-ANOTHER-TRAILER-IND     05540089
055500                 ELSE                                             05550089
055600                     MOVE SPACES TO SU001-ANOTHER-TRAILER-IND     05560089
055700                 END-IF                                           05570089
055800                 PERFORM 7000-NOT-FOUND-CHECK                     05580089
055900                 IF PS-DETAIL-RECORD                              05590089
056000                     IF SHPUNT-SHIPT-UNT-SRC-ID = PC-RCV          05600089
056100                         MOVE PC-Y   TO SU001-NOT-FOUND-IND       05610089
056200                     ELSE                                         05620089
056300                         MOVE SPACES TO SU001-NOT-FOUND-IND       05630089
056400                     END-IF                                       05640089
056500                     MOVE PC-B       TO SU001-RECORD-TYPE-IND     05650089
056600                     PERFORM 8000-WRITE-EXTRACT-RECORD            05660089
056700                     PERFORM 3200-FETCH-CARTON-CURSOR             05670089
056800                 END-IF                                           05680089
056900             END-IF                                               05690089
057000         END-IF                                                   05700089
057100     END-IF.                                                      05710089
057200                                                                  05720089
057300                                                                  05730089
057400 3400-CLOSE-CARTON-CURSOR.                                        05740089
057500     MOVE '3400-CLOSE-CARTON-CURSOR   '                           05750089
057600                                 TO PV-ABEND-PARAGRAPH.           05760089
057700     EXEC SQL                                                     05770089
057800         CLOSE CARTON-CSR                                         05780089
057900     END-EXEC.                                                    05790089
058000     EVALUATE TRUE                                                05800089
058100       WHEN SQLCODE = ZEROS                                       05810089
058200         CONTINUE                                                 05820089
058300       WHEN SQLCODE = -904                                        05830089
058400       WHEN SQLCODE = -911                                        05840089
058500       WHEN SQLCODE = -913                                        05850089
058600         PERFORM 3500-PROCESS-ERROR-RECORD                        05860089
058700       WHEN OTHER                                                 05870089
058800         DISPLAY PV-ABEND-PARAGRAPH                               05880089
058900         PERFORM Z999-SQL-ERROR                                   05890089
059000     END-EVALUATE.                                                05900089
059100                                                                  05910089
059200 3500-PROCESS-ERROR-RECORD.                                       05920089
059300     MOVE PV-MANIFEST         TO SU001-MANIFEST-NBR.              05930089
059400     MOVE ZERO                TO SU001-SHIPT-UNT-ID.              05940089
059500     MOVE ZERO                TO SU001-PO-NUMBER.                 05950089
059600     MOVE ZERO                TO SU001-REC-SEQ-NBR.               05960089
059700     MOVE PC-Y                TO SU001-SCANNED-IND                05970089
059800                                 SU001-MISDIRECT-IND              05980089
059900                                 SU001-NOT-FOUND-IND              05990089
060000                                 SU001-FREE-ASTRAY-IND            06000089
060100                                 SU001-ANOTHER-TRAILER-IND.       06010089
060200     MOVE SPACES              TO SU001-BRCDE-NBR                  06020089
060300                                 SU001-TSULBXF-USED               06030089
060400     MOVE PC-A                TO SU001-RECORD-TYPE-IND.           06040089
060500     MOVE SPACES              TO SU001-AUTO-VE-IND.               06050089
060600     PERFORM 8000-WRITE-EXTRACT-RECORD.                           06060089
060700                                                                  06070089
060800     SET PS-ERROR-RECORD      TO TRUE.                            06080089
060900                                                                  06090089
061000*                                                                 06100089
061100 4000-GET-RCVR-SEQ-NBR.                                           06110089
061200     EXEC SQL                                                     06120089
061300        SELECT  DISTINCT                                          06130089
061400                B.REC_SEQ_NBR                                     06140089
061500              , C.FRE_ASTRA_IND                                   06150089
061600              , C.STATUS_CDE                                      06160089
                    , C.CRE_OPER_UNT_ID                                 06161091
061700              , C.CURR_OPER_UNT_ID                                06170089
061800          INTO  :PKSLIP-REC-SEQ-NBR                               06180089
061900              , :RECEIV-FRE-ASTRA-IND                             06190089
062000              , :RECEIV-STATUS-CDE                                06200089
062100              , :RECEIV-CRE-OPER-UNT-ID                           06210091
062100              , :RECEIV-CURR-OPER-UNT-ID                          06211091
062200          FROM  TINPKSU A                                         06220089
062300              , TPKSLIP B                                         06230089
062400              , TRECEIV C                                         06240089
062500              , TSHPUNT D                                         06250089
062600          WHERE A.SHIPT_UNT_ID      = :SHUUPC-SHIPT-UNT-ID        06260089
062700            AND A.SHIPT_UNT_ID      = D.SHIPT_UNT_ID              06270089
062800            AND A.PO_NBR            = B.PO_NBR                    06280089
062900            AND A.SEQ_NBR           = B.SEQ_NBR                   06290089
063000            AND B.PO_NBR            = C.ORD_NBR                   06300089
063100            AND B.REC_SEQ_NBR       = C.REC_SEQ_NBR               06310089
063200            AND B.VER_STAT_CDE      = 'A'                         06320089
063210            AND C.VER_STATUS_CDE    = 'A'                         06321089
063300     END-EXEC.                                                    06330089
063400                                                                  06340089
063500     EVALUATE TRUE                                                06350089
063600       WHEN SQLCODE = ZEROS                                       06360089
063700       WHEN SQLCODE = -811                                        06370089
063800          SET PS-RCVR-EXISTS TO TRUE                              06380089
063900       WHEN SQLCODE = +100                                        06390089
064000          SET PS-NO-RCVR-EXISTS TO TRUE                           06400089
064100          INITIALIZE PKSLIP-REC-SEQ-NBR                           06410089
064200                     RECEIV-FRE-ASTRA-IND                         06420089
064300                     RECEIV-STATUS-CDE                            06430089
064400                     RECEIV-CURR-OPER-UNT-ID                      06440089
                           RECEIV-CRE-OPER-UNT-ID                       06441093
064500       WHEN SQLCODE = -904                                        06450089
064600       WHEN SQLCODE = -911                                        06460089
064700       WHEN SQLCODE = -913                                        06470089
064800         PERFORM 3500-PROCESS-ERROR-RECORD                        06480089
064900       WHEN OTHER                                                 06490089
064910         MOVE ' 4000-GET-RCVR-SEQ-NBR' TO PV-ABEND-PARAGRAPH      06491089
065000         DISPLAY PV-ABEND-PARAGRAPH                               06500089
065100         DISPLAY 'SHIPT-UNT-ID: ' SHUUPC-SHIPT-UNT-ID             06510089
065200         PERFORM Z999-SQL-ERROR                                   06520089
065300     END-EVALUATE.                                                06530089
065400*                                                                 06540089
065500                                                                  06550089
065600******************************************************************06560089
065700*CALL AUTO VE ACCESS MODULE RCKUT127 (RCWS040 COPYBOOK)           06570089
065800 4500-CALL-AUTO-VE-MODULE.                                        06580089
065900******************************************************************06590089
066000     INITIALIZE RC040-FIELDS.                                     06600089
066100                                                                  06610089
066200     MOVE PS-ZERO-RCVR-SW TO RC040-ZERO-RCVR-SW                   06620089
066300     MOVE RECEIV-CURR-OPER-UNT-ID TO RC040-SIGNON-LOCATION        06630089
066400                                                                  06640089
066500     MOVE SHUUPC-TRN-NBR       TO RC040-PO-NBR.                   06650089
066600     MOVE PKSLIP-REC-SEQ-NBR   TO RC040-PO-RCVR.                  06660089
066610     MOVE PC-SUKUT001          TO RC040-CALLING-PROGRAM.          06661090
066700                                                                  06670089
066800***  SLH                                                          06680089
066900**   DISPLAY 'CALLING RCKUT127'.                                  06690089
066901                                                                  06690189
066902     CALL RC040-AUTOVE-CHECK-PGM USING RC040-FIELDS               06690289
066903***  SLH                                                          06690389
066904**   DISPLAY 'RETURN FROM RCKUT127'.                              06690489
066905                                                                  06690589
067000     EVALUATE TRUE                                                06700089
067100      WHEN RC040-SUCCESSFUL                                       06710089
067200        IF RC040-AUTO-VE-SW  = PC-Y                               06720089
067300           SET PS-AUTO-VE-RCVR TO TRUE                            06730089
067400           MOVE 'Y' TO SU001-AUTO-VE-IND                          06740089
067500        ELSE                                                      06750089
067600           SET PS-AUTO-VE-RCVR-NO TO TRUE                         06760089
067700           MOVE 'N' TO SU001-AUTO-VE-IND                          06770089
067800        END-IF                                                    06780089
067900      WHEN RC040-NOT-SUCCESSFUL                                   06790089
068000      WHEN RC040-INVALID-SQL                                      06800089
068100        DISPLAY 'SUCCESS INDICATOR' RC040-SUCCESS-IND             06810089
068101        DISPLAY RC040-CRA-RET-MSG                                 06810189
068102        MOVE '4500-CALL-AUTO-VE-MODULE'                           06810289
068200                             TO PV-ABEND-PARAGRAPH                06820089
068300        MOVE 'ACCESS INFO FOR RCKUT127 INCORRECT'                 06830089
068400                             TO PV-ABEND-OPERATION1               06840089
068500        PERFORM Z999-SQL-ERROR                                    06850089
068600                                                                  06860089
068700      WHEN SQLWARN0 NOT = SPACE                                   06870089
068800      WHEN SQLCODE  NOT = +0                                      06880089
068900        DISPLAY 'SUCCESS INDICATOR' RC040-SUCCESS-IND             06890089
068901        DISPLAY RC040-CRA-RET-MSG                                 06890189
068902        MOVE '4500-CALL-AUTO-VE-MODULE'                           06890289
069000                             TO PV-ABEND-PARAGRAPH                06900089
069100        MOVE 'UNSUCCESSFUL SELECT OF PO/RCVR'                     06910089
069200                             TO PV-ABEND-OPERATION1               06920089
069300        PERFORM Z999-SQL-ERROR                                    06930089
069400     END-EVALUATE.                                                06940089
069500                                                                  06950089
069600 5000-FREE-ASTRAY-CHECK.                                          06960089
069700     MOVE SPACES              TO SU001-FREE-ASTRAY-IND.           06970089
069800     MOVE ZERO                TO SU001-REC-SEQ-NBR.               06980089
069900                                                                  06990089
070000     EXEC SQL                                                     07000089
070100        SELECT  DISTINCT                                          07010089
070200                D.TRIP_ID                                         07020089
070300              , B.REC_SEQ_NBR                                     07030089
070400          INTO  :SHIPMT-TRIP-ID                                   07040089
070500              , :PKSLIP-REC-SEQ-NBR                               07050089
070600          FROM  TINPKSU A                                         07060089
070700              , TPKSLIP B                                         07070089
070800              , TSHPTPO C                                         07080089
070900              , TSHIPMT D                                         07090089
071000          WHERE A.SHIPT_UNT_ID      = :SHUUPC-SHIPT-UNT-ID        07100089
071100*           AND D.TRIP_ID           = :VHTRIP-TRIP-ID             07110089
071200            AND A.PO_NBR            = B.PO_NBR                    07120089
071300            AND A.SEQ_NBR           = B.SEQ_NBR                   07130089
071400            AND B.PO_NBR            = C.PO_NBR                    07140089
071500            AND B.REC_SEQ_NBR       = C.REC_SEQ_NBR               07150089
071600            AND B.VER_STAT_CDE      = :PC-A                       07160089
071700            AND D.SHIPT_ID          = C.SHIPT_ID                  07170089
071800     END-EXEC.                                                    07180089
071900                                                                  07190089
072000     EVALUATE TRUE                                                07200089
072100       WHEN SQLCODE = ZEROS                                       07210089
072200       WHEN SQLCODE = -811                                        07220089
072300          IF SHIPMT-TRIP-ID NOT = VHTRIP-TRIP-ID                  07230089
072400             MOVE PC-Y        TO SU001-FREE-ASTRAY-IND            07240089
072500          END-IF                                                  07250089
072600          MOVE PKSLIP-REC-SEQ-NBR   TO SU001-REC-SEQ-NBR          07260089
072700       WHEN SQLCODE = +100                                        07270089
072800          MOVE PC-Y        TO SU001-FREE-ASTRAY-IND               07280089
072900       WHEN SQLCODE = -904                                        07290089
073000       WHEN SQLCODE = -911                                        07300089
073100       WHEN SQLCODE = -913                                        07310089
073200         PERFORM 3500-PROCESS-ERROR-RECORD                        07320089
073300       WHEN OTHER                                                 07330089
073301        MOVE '5000-FREE-ASTRAY-CHECK  '                           07330189
073302                             TO PV-ABEND-PARAGRAPH                07330289
073400         DISPLAY PV-ABEND-PARAGRAPH                               07340089
073500         DISPLAY 'SHIPT-UNT-ID: ' SHUUPC-SHIPT-UNT-ID             07350089
073600         PERFORM Z999-SQL-ERROR                                   07360089
073700     END-EVALUATE.                                                07370089
073800                                                                  07380089
073900 6000-DIFF-TRAILER-CHECK.                                         07390089
074000     MOVE '6000-DIFF-TRAILER-CHECK'                               07400089
074100                                 TO PV-ABEND-PARAGRAPH.           07410089
074200                                                                  07420089
074300     EXEC SQL                                                     07430089
074400        SELECT  A.TRIP_ID                                         07440089
074500          INTO  :SHUNLO-TRIP-ID                                   07450089
074600          FROM  TSHUNLO A                                         07460089
074700         WHERE  A.SHIPT_UNT_ID = :SHUUPC-SHIPT-UNT-ID             07470089
074800           AND  A.TRIP_ID      ^= :VHTRIP-TRIP-ID                 07480089
074900           AND  A.SCN_LOC_ID    = 'RECV'                          07490089
075000           AND  A.ACTV_CDE      = 'A'                             07500089
075100     END-EXEC.                                                    07510089
075200                                                                  07520089
075300     EVALUATE TRUE                                                07530089
075400       WHEN SQLCODE = ZEROS                                       07540089
075500       WHEN SQLCODE = +100                                        07550089
075600       WHEN SQLCODE = -811                                        07560089
075700         CONTINUE                                                 07570089
075800       WHEN SQLCODE = -904                                        07580089
075900       WHEN SQLCODE = -911                                        07590089
076000       WHEN SQLCODE = -913                                        07600089
076100         PERFORM 3500-PROCESS-ERROR-RECORD                        07610089
076200       WHEN OTHER                                                 07620089
076300         DISPLAY PV-ABEND-PARAGRAPH                               07630089
076400         DISPLAY 'SHIPT-UNT-ID: ' SHUUPC-SHIPT-UNT-ID             07640089
076500         PERFORM Z999-SQL-ERROR                                   07650089
076600     END-EVALUATE.                                                07660089
076700                                                                  07670089
076800                                                                  07680089
076900 7000-NOT-FOUND-CHECK.                                            07690089
077000     MOVE '7000-NOT-FOUND-CHECK'                                  07700089
077100                                 TO PV-ABEND-PARAGRAPH.           07710089
077200                                                                  07720089
077300     EXEC SQL                                                     07730089
077400        SELECT  A.SHIPT_UNT_SRC_ID                                07740089
077500          INTO  :SHPUNT-SHIPT-UNT-SRC-ID                          07750089
077600          FROM  TSHPUNT A                                         07760089
077700         WHERE  A.SHIPT_UNT_ID = :SHUUPC-SHIPT-UNT-ID             07770089
077800           AND  A.ACTV_IND         = 'A'                          07780089
077900     END-EXEC.                                                    07790089
078000                                                                  07800089
078100     EVALUATE TRUE                                                07810089
078200       WHEN SQLCODE = ZEROS                                       07820089
078300         CONTINUE                                                 07830089
078400       WHEN SQLCODE = -904                                        07840089
078500       WHEN SQLCODE = -911                                        07850089
078600       WHEN SQLCODE = -913                                        07860089
078700         PERFORM 3500-PROCESS-ERROR-RECORD                        07870089
078800       WHEN OTHER                                                 07880089
078900         DISPLAY PV-ABEND-PARAGRAPH                               07890089
079000         DISPLAY 'SHIPT-UNT-ID: ' SHUUPC-SHIPT-UNT-ID             07900089
079100         PERFORM Z999-SQL-ERROR                                   07910089
079200     END-EVALUATE.                                                07920089
079300                                                                  07930089
079400*                                                                 07940089
079500 8000-WRITE-EXTRACT-RECORD.                                       07950089
079600     WRITE SU-EXTRACT-RECORD                                      07960089
079700       FROM SU001-EXTRACT-RECORD.                                 07970089
079800*                                                                 07980089
079900******************************************************************07990089
080000*     SQL WARNING OR ERROR PROCESSING                            *08000089
080100*                                                                *08010089
080200******************************************************************08020089
080300                                                                  08030089
080400*                                                                 08040089
080500 Z999-SQL-ERROR.                                                  08050089
080600*---------------                                                  08060089
080700                                                                  08070089
080701     DISPLAY PV-ABEND-PARAGRAPH.                                  08070189
080702     DISPLAY PV-ABEND-OPERATION1.                                 08070289
080800     MOVE SQLCODE    TO SQLCODE2.                                 08080089
080900     MOVE SQLERRD(3) TO SQLERRD3.                                 08090089
081000     DISPLAY '** ABEND **       ** = SQLERROR'.                   08100089
081100     DISPLAY '** PROGRAM        ** = SUKUT001'.                   08110089
081200     DISPLAY '** SQLCODE        ** = ' SQLCODE2.                  08120089
081300     DISPLAY '** ROWS PROCESSED ** = ' SQLERRD3.                  08130089
081400     DISPLAY '** SQLERRM        ** = ' SQLERRM.                   08140089
081500     DISPLAY '** SQLERRMC       ** = ' SQLERRMC.                  08150089
081600     EXEC SQL                                                     08160089
081700         COMMIT                                                   08170089
081800     END-EXEC.                                                    08180089
081900     MOVE +4013 TO PV-ABEND-CODE.                                 08190089
082000     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         08200089
