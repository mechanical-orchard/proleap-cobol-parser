000100 TITLE 'LABOR SYSTEM - TEAM ASSOCIATE ADD'.                       00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300                                                                  00030000
000400 PROGRAM-ID.             DLKRF450.                                00040000
000500 AUTHOR.                 DENNIS STEFFEN.                          00050000
000600 INSTALLATION.           KOHLS.                                   00060000
000700 DATE-WRITTEN.           JANUARY 2004.                            00070000
000800 DATE-COMPILED.                                                   00080000
000900 ENVIRONMENT DIVISION.                                            00090000
001000 DATA DIVISION.                                                   00100000
001100                                                                  00110000
001200 WORKING-STORAGE SECTION.                                         00120000
001300*                                                                 00130000
001400 01  PC-PROGRAM-CONSTANTS.                                        00140000
001500     05  PC-TRANID                    PIC  X(04)  VALUE 'D450'.   00150000
001600     05  PC-CURRENT-PROGRAM-NAME      PIC X(08) VALUE 'DLKRF450'. 00160000
001700                                                                  00170000
001800* ERROR MESSAGES                                                 *00180000
001900     05  PC-UNRECOGNIZED-PF-KEY-MSG PIC X(19) VALUE               00190000
002000                                           'UNRECOGNIZED PF KEY'. 00200000
002100     05  PC-ENTER-THROUGH-MENU-MSG  PIC X(19) VALUE               00210000
002200                                           'ENTER THROUGH MENU '. 00220000
002300     05  PC-TRANS-UNAVAILABLE-MSG   PIC X(19) VALUE               00230000
002400                                           'TRANS NOT AVAILABLE'. 00240000
002500     05  PC-WRONG-FACILITY          PIC X(19) VALUE               00250000
002600                                           'WRG FCLTY - F2 CONF'. 00260000
002700                                                                  00270000
002800 01  PS-PROGRAM-SWITCHES.                                         00280000
002900     05  PS-ERROR-SW                  PIC  X(01)  VALUE 'N'.      00290000
003000         88  PS-ERRORS-YES                        VALUE 'Y'.      00300000
003100         88  PS-ERRORS-NO                         VALUE 'N'.      00310000
003200     05  PS-VALID-INPUT-SW            PIC  X(01)  VALUE 'N'.      00320000
003300         88  PS-VALID-INPUT                       VALUE 'Y'.      00330000
003400         88  PS-INVALID-INPUT                     VALUE 'N'.      00340000
003500     05  PS-CREATE-NEW-USER-SW        PIC X(01) VALUE 'N'.        00350000
003600         88  PS-CREATE-NEW-USER-NO              VALUE 'N'.        00360000
003700         88  PS-CREATE-NEW-USER-YES             VALUE 'Y'.        00370000
003710     05  PS-CREATE-MANUAL-ADD-SW      PIC X(01) VALUE 'N'.        00371007
003720         88  PS-CREATE-MAN-ADD-YES              VALUE 'Y'.        00372007
003730         88  PS-CREATE-MAN-ADD-NO               VALUE 'N'.        00373007
003800/                                                                 00380000
003810 01  DK-DB2-KEYS.                                                 00381018
003820     05  DK-LOC-NBR               PIC  S9(4) COMP   VALUE 0.      00382018
003890     05  DK-USR-ID                PIC   X(08)       VALUE SPACES. 00389018
003892                                                                  00389218
003900*----------------------------------------------------------------*00390000
004000*  PROGRAM VARIABLES                                             *00400000
004100*----------------------------------------------------------------*00410000
004200 01  PV-PROGRAM-VARIABLES.                                        00420000
004300                                                                  00430000
004400     05  PV-UNSTRING-COUNT            PIC S9(03) COMP-3.          00440000
004500     05  PV-POINTER                   PIC S9(03) COMP-3.          00450000
004600     05  PV-TALLY                     PIC S9(03) COMP-3.          00460000
004700     05  PV-TOT-QTY                   PIC S9(7) COMP-3.           00470000
004800     05  PV-TEAM-COUNT                PIC S9(4) COMP.             00480000
004900                                                                  00490000
005000     05  PV-COMMAREA-LENGTH           PIC S9(04)  VALUE +0        00500000
005100                                                     COMP SYNC.   00510000
005200     05  PV-MESSAGE-AREA              PIC  X(19)  VALUE SPACE.    00520000
005300     05  PV-CICS-RESPONSE             PIC S9(09)  VALUE ZEROS     00530000
005400                                                     COMP SYNC.   00540000
005500     05  PV-TRANSFER-PROGRAM          PIC  X(08)  VALUE SPACE.    00550000
005600     05  PV-USERID                    PIC X(08) VALUE SPACES.     00560000
005610     05  PV-USERID-MAN-ADD            PIC X(08) VALUE SPACES.     00561007
005700     05  PV-TMST                      PIC X(26) VALUE SPACES.     00570000
005800     05  PV-LABOR-CURRENT-TIMESTAMP   PIC  X(26).                 00580000
005900     05  PV-HOLD-TIMESTAMP            PIC  X(26).                 00590000
006000     05  PV-DUMMY-USERID              PIC X(08) VALUE SPACES.     00600000
006100     05  PV-KEYED-USERID.                                         00610000
006200         10  PV-KEYED-USERID-1-2      PIC X(02) VALUE  SPACES.    00620000
006300             88 PV-KEYED-USERID-KOHLS VALUE 'TK', 'TV', 'TC'.     00630000
006400         10  FILLER                   PIC X(06) VALUE  SPACES.    00640000
006401     05  PV-DISP-OPER                 PIC 9(04) VALUE ZEROES.     00640119
006402     05  PV-DISP-SQL                  PIC -999  VALUE ZEROES.     00640219
006403                                                                  00640319
006410     05  PV-START-TMST.                                           00641002
006420         10 PV-START-TMST-DATE.                                   00642002
006430             15 PV-START-TMST-YR      PIC 9(04).                  00643002
006440             15 PV-DASH-1             PIC X.                      00644002
006450             15 PV-START-TMST-MO      PIC 9(02).                  00645002
006451             15 PV-DASH-2             PIC X.                      00645102
006470             15 PV-START-TMST-DA      PIC 9(02).                  00647002
006471             15 PV-DASH-3             PIC X.                      00647102
006490         10 PV-START-TMST-TIME.                                   00649002
006491             15 PV-START-TMST-HR      PIC 9(02) VALUE ZEROES.     00649103
006492             15 PV-DEC-1              PIC X     VALUE '.'.        00649203
006493             15 PV-START-TMST-MN      PIC 9(02) VALUE ZEROES.     00649303
006494             15 PV-DEC-2              PIC X     VALUE '.'.        00649403
006496             15 PV-START-TMST-SS      PIC 9(02) VALUE ZEROES.     00649603
006497             15 PV-DEC-3              PIC X     VALUE '.'.        00649703
006499         10 PV-MILL-SEC               PIC 9(06) VALUE ZEROES.     00649903
006500                                                                  00650002
006510                                                                  00651000
006600 01  PV-LOG-MSG.                                                  00660000
006700     05  FILLER                       PIC X(12) VALUE             00670000
006800         ' D450 ERROR '.                                          00680000
006900     05  FILLER                       PIC X(06) VALUE             00690000
007000         'USER= '.                                                00700000
007100     05  PV-LOG-USER-ID               PIC X(08) VALUE SPACES.     00710000
007200     05  FILLER                       PIC X(10) VALUE             00720000
007300         ' SQLCODE= '.                                            00730000
007400     05  PV-SQLCODE                   PIC -9(03).                 00740000
007500     05  FILLER                       PIC X(06) VALUE             00750000
007600         ' ERR= '.                                                00760000
007700     05  PV-ERROR-NBR                 PIC 9(03) VALUE ZERO.       00770000
007800 01  PV-LOG-MSG-2.                                                00780000
007900     05  FILLER                       PIC X(12) VALUE             00790000
008000         ' D450 ERROR '.                                          00800000
008100     05  FILLER                       PIC X(10) VALUE             00810000
008200         'STRT DTE= '.                                            00820000
008300     05  PV-STRT-DTE                  PIC X(10) VALUE SPACES.     00830000
008400     05  FILLER                       PIC X(10) VALUE             00840000
008500         ' NBR TXT= '.                                            00850000
008600     05  PV-NBR-TXT                   PIC X(10).                  00860000
008700     05  FILLER                       PIC X(10) VALUE             00870000
008800         ' SEQ NBR= '.                                            00880000
008900     05  PV-NBR-SEQ-NBR               PIC -9(09) VALUE ZERO.      00890000
009000/                                                                 00900000
009100* COMMAREA FOR DLKRF SCREENS                                      00910000
009200     COPY DLWS010.                                                00920000
009300/                                                                 00930000
009400* COMMAREA FOR XLKUT067                                           00940000
009500     COPY XLWS067.                                                00950000
009600/                                                                 00960000
009700* COMMAREA FOR DLKUT001                                           00970000
009800     COPY DLWS003.                                                00980000
009900/                                                                 00990000
010000* COMMAREA FOR DLKUP002                                           01000000
010100     COPY DLWS005.                                                01010000
010200/                                                                 01020000
010300* COMMAREA FOR XLKUP033                                           01030000
010400     COPY XLWS072.                                                01040000
010500/                                                                 01050000
010600*  MAP LAYOUT                                                     01060000
010700     COPY DLKM450.                                                01070000
010800/                                                                 01080000
010900* HELP SCREEN COMMAREA                                            01090000
011000     COPY PCWS192.                                                01100000
011100* HELP SCREEN WORK AREA                                           01110000
011200     COPY PCWS188.                                                01120000
011300/                                                                 01130000
011400*  NUMERIC EDITS                                                  01140000
011500     COPY DPWS010I.                                               01150000
011600*  KOHL'S STANDARD ATTRIBUTES                                     01160000
011700     COPY DPWS015.                                                01170000
011800                                                                  01180000
011900*  KOHL'S STANDARD ATTENTION IDENTIFIER LIST                      01190000
012000     COPY DFHAID.                                                 01200000
012100                                                                  01210000
012200*  LAYOUT FOR THE ABEND MODULE COMMUNICATIONS AREA.               01220000
012300     COPY DPWS013.                                                01230000
012400/                                                                 01240000
012500*    DLT_TEM_ASGMT                                                01250000
012600     EXEC SQL                                                     01260000
012700         INCLUDE DLT00003                                         01270000
012800     END-EXEC.                                                    01280000
012900                                                                  01290000
012910*    DLT_ASGMT                                                    01291008
012920     EXEC SQL                                                     01292008
012930         INCLUDE DLT00004                                         01293008
012940     END-EXEC.                                                    01294008
012950                                                                  01295008
013000*    DLT_RDPR_USR_LSTG                                            01300000
013100     EXEC SQL                                                     01310000
013200         INCLUDE DLT00009                                         01320000
013300     END-EXEC.                                                    01330000
013400                                                                  01340000
013500*    PARAMETER TABLE                                              01350000
013600     EXEC SQL                                                     01360000
013700         INCLUDE TKRPRPM                                          01370000
013800     END-EXEC.                                                    01380000
013900                                                                  01390000
014000     EXEC SQL                                                     01400000
014100         INCLUDE SQLCA                                            01410000
014200     END-EXEC.                                                    01420000
014300                                                                  01430000
014400 LINKAGE SECTION.                                                 01440000
014500 01  DFHCOMMAREA.                                                 01450000
014600     05  FILLER                         OCCURS  1 TO 4072 TIMES   01460000
014700                                      DEPENDING ON EIBCALEN.      01470000
014800         10  FILLER                   PIC X.                      01480000
014900/                                                                 01490000
015000 PROCEDURE DIVISION.                                              01500000
015100 0000-PROGRAM-MAINLINE.                                           01510000
015200                                                                  01520000
015300     INITIALIZE DL010-COMMAREA                                    01530000
015400     MOVE DFHCOMMAREA                 TO DL010-COMMAREA           01540000
015500                                                                  01550000
015600     EVALUATE TRUE                                                01560000
015700         WHEN EIBCALEN = ZERO                                     01570000
015800             MOVE PC-ENTER-THROUGH-MENU-MSG                       01580000
015900                                      TO PV-MESSAGE-AREA          01590000
016000             PERFORM 8110-RETURN                                  01600000
016100                                                                  01610000
016200         WHEN EIBTRNID = 'Z278'                                   01620000
016300*            RETURNING FROM HELP SCREEN                           01630000
016400             MOVE DFHCOMMAREA         TO PC192-COMMAREA           01640000
016500             MOVE PC192-HOST-SAVE-AREA                            01650000
016600                                      TO DL010-COMMAREA           01660000
016700             SET DL010-PROCESS-SCREEN TO TRUE                     01670000
016800             MOVE PC192-HOST-SAVE-MAP TO DL450AO                  01680000
016900             MOVE -1                  TO AUSERL                   01690000
017000             PERFORM 8000-SEND-MAP                                01700000
017100             PERFORM 8100-RETURN-TRANID                           01710000
017200                                                                  01720000
017300         WHEN DL010-INITIALIZE-SCREEN                             01730000
017400         WHEN EIBAID = DFHCLEAR                                   01740000
017500             SET DL010-PROCESS-SCREEN TO TRUE                     01750000
017600             PERFORM 1000-INITIALIZE                              01760000
017700             PERFORM 8000-SEND-MAP                                01770000
017800             PERFORM 8100-RETURN-TRANID                           01780000
017900                                                                  01790000
018000         WHEN EIBAID = DFHPF2 AND DL010-CHG-PENDING               01800000
018100             PERFORM 4000-CHANGE-ASSIGNMENTS                      01810000
018200             SET DL010-PROCESS-SCREEN TO TRUE                     01820000
018300             MOVE -1                  TO AUSERL                   01830000
018400             PERFORM 8010-SEND-DATA-ONLY                          01840000
018500             PERFORM 8100-RETURN-TRANID                           01850000
018510                                                                  01851030
018520         WHEN EIBAID = DFHPF2 AND DL010-WAIT-FOR-CONFIRM          01852030
018530             PERFORM 3000-ADD-PROCESSING                          01853030
018540             SET DL010-PROCESS-SCREEN TO TRUE                     01854030
018550             MOVE -1                  TO AUSERL                   01855030
018560             PERFORM 8010-SEND-DATA-ONLY                          01856030
018570             PERFORM 8100-RETURN-TRANID                           01857030
018580                                                                  01858030
018600         WHEN EIBAID = DFHPF3                                     01860000
018700             IF DL010-CHG-PENDING                                 01870000
018800                 SET DL010-PROCESS-SCREEN                         01880000
018900                                      TO TRUE                     01890000
019000                 MOVE SPACES          TO ALINE5O                  01900000
019100                                         ALINE6O                  01910000
019200                 MOVE 'F5-ADD  F6-TEAM LST'                       01920000
019300                                      TO ALINE7O                  01930000
019400                 MOVE ' FUNCTION IGNORED  '                       01940000
019500                                      TO ALINE8O                  01950000
019600                 MOVE -1              TO AUSERL                   01960000
019700                 PERFORM 8010-SEND-DATA-ONLY                      01970000
019800                 PERFORM 8100-RETURN-TRANID                       01980000
019900             ELSE                                                 01990000
020000                 MOVE DL010-ROOT-PROGRAM                          02000000
020100                                      TO PV-TRANSFER-PROGRAM      02010000
020200                 PERFORM 8200-XCTL                                02020000
020300             END-IF                                               02030000
020400                                                                  02040000
020500         WHEN EIBAID = DFHPF4 AND DL010-CHG-PENDING               02050000
020600             MOVE PC-CURRENT-PROGRAM-NAME TO DL010-LAST-PROGRAM   02060000
020700             MOVE 'DLKRF452'          TO PV-TRANSFER-PROGRAM      02070000
020800                                         DL010-NEXT-PROGRAM       02080000
020900             MOVE 'DLKRF450'          TO DL010-LAST-PROGRAM       02090000
021000             PERFORM 8200-XCTL                                    02100000
021100                                                                  02110000
021200         WHEN EIBAID = DFHPF5                                     02120000
021300*            ADD PROCESSING                                       02130000
021400             PERFORM 3000-ADD-PROCESSING                          02140000
021500             MOVE -1                  TO AUSERL                   02150000
021600             PERFORM 8010-SEND-DATA-ONLY                          02160000
021700             PERFORM 8100-RETURN-TRANID                           02170000
021800                                                                  02180000
021900         WHEN EIBAID = DFHENTER                                   02190000
022000             PERFORM 2000-PROCESS-SCREEN-FIELDS                   02200000
022100             IF PS-ERRORS-NO                                      02210000
022200                 MOVE -1              TO AUSERL                   02220000
022300                 PERFORM 8010-SEND-DATA-ONLY                      02230000
022400                 PERFORM 8100-RETURN-TRANID                       02240000
022500             ELSE                                                 02250000
022600                 PERFORM 8010-SEND-DATA-ONLY                      02260000
022700                 PERFORM 8100-RETURN-TRANID                       02270000
022800             END-IF                                               02280000
022900                                                                  02290000
023000         WHEN EIBAID = DFHPF6                                     02300000
023100*            LIST ASSOCIATES                                      02310000
023200             MOVE PC-CURRENT-PROGRAM-NAME TO DL010-LAST-PROGRAM   02320000
023300             MOVE 'DLKRF451'          TO PV-TRANSFER-PROGRAM      02330000
023400                                         DL010-NEXT-PROGRAM       02340000
023500             MOVE 'DLKRF452'          TO DL010-LAST-PROGRAM       02350000
023600             PERFORM 8200-XCTL                                    02360000
023700                                                                  02370000
023800         WHEN EIBAID = DFHPF1                                     02380000
023900             PERFORM 8020-RECEIVE-MAP                             02390000
024000             MOVE DL450AO             TO PC192-HOST-SAVE-MAP      02400000
024100             PERFORM 1200-HELP-SCREEN                             02410000
024200                                                                  02420000
024300         WHEN OTHER                                               02430000
024400             PERFORM 8020-RECEIVE-MAP                             02440000
024500             MOVE -1                  TO AUSERL                   02450000
024600             MOVE PC-UNRECOGNIZED-PF-KEY-MSG                      02460000
024700                                      TO ALINE8O                  02470000
024800             PERFORM 8000-SEND-MAP                                02480000
024900             PERFORM 8100-RETURN-TRANID                           02490000
025000     END-EVALUATE.                                                02500000
025100                                                                  02510000
025200     GOBACK.                                                      02520000
025300                                                                  02530000
025400 1000-INITIALIZE.                                                 02540000
025500                                                                  02550000
025600     EXEC SQL                                                     02560000
025700         SET :PV-TMST = CURRENT TIMESTAMP                         02570000
025800     END-EXEC                                                     02580000
025900                                                                  02590000
026000     MOVE PC-TRANID                   TO DL010-TRAN-ID            02600000
026100     MOVE SPACES                      TO ALINE5O                  02610000
026200                                         ALINE6O                  02620000
026300                                         ALINE7O                  02630000
026400                                         ALINE8O                  02640000
026500     PERFORM 7000-COUNT-UP-TEAM                                   02650000
026600     MOVE PV-TEAM-COUNT               TO ATMCNTO                  02660000
026700*    MOVE DL010-ASGMT-ACTV-USR-QTY    TO ATMCNTO                  02670000
026800     MOVE DL010-WRK-TYP-DESC          TO ATYPEO                   02680000
026900     MOVE DL010-WRK-AREA-DESC         TO AAREAO                   02690000
027000     MOVE DL010-KEYED-USERID          TO AUSERO                   02700000
027100     MOVE 'F5-ADD      F6-LIST'       TO ALINE7O                  02710000
027200                                                                  02720000
027300*    PERFORM 2100-EDIT-INPUT.                                     02730000
027400                                                                  02740000
027500     PERFORM 8000-SEND-MAP                                        02750000
027600     PERFORM 8100-RETURN-TRANID.                                  02760000
027700                                                                  02770000
027800 1200-HELP-SCREEN.                                                02780000
027900     MOVE 'DPKRF278'                  TO PV-TRANSFER-PROGRAM      02790000
028000     MOVE 'DLKRF450'                  TO PC192-PROGRAM-NAME       02800000
028100     COPY PCPD188.                                                02810000
028200     MOVE PC188-DISPLAY-DATE          TO PC192-DISPLAY-DATE.      02820000
028300     MOVE DL010-COMMAREA              TO PC192-HOST-SAVE-AREA     02830000
028400     PERFORM 8220-XCTL-TO-HELP.                                   02840000
028500/                                                                 02850000
028600 2000-PROCESS-SCREEN-FIELDS.                                      02860000
028700                                                                  02870000
028800     PERFORM 8020-RECEIVE-MAP                                     02880000
028900     PERFORM 2100-EDIT-INPUT.                                     02890000
029000                                                                  02900000
029100     IF PS-VALID-INPUT                                            02910000
029200         CONTINUE                                                 02920000
029300     ELSE                                                         02930000
029400         PERFORM 8010-SEND-DATA-ONLY                              02940000
029500         PERFORM 8100-RETURN-TRANID                               02950000
029600     END-IF.                                                      02960000
029700                                                                  02970000
029800 2100-EDIT-INPUT.                                                 02980000
029900                                                                  02990000
030000     MOVE SPACES                      TO ALINE5O                  03000000
030100                                         ALINE6O                  03010000
030200     SET PS-VALID-INPUT               TO TRUE                     03020000
030300                                                                  03030000
030400     IF AUSERL > ZERO                                             03040000
030500         MOVE AUSERI                  TO PV-USERID                03050000
030600     ELSE                                                         03060000
030700         MOVE DL010-USERID            TO PV-USERID                03070000
030800     END-IF.                                                      03080000
030900                                                                  03090000
031000     IF PV-USERID = SPACES                                        03100000
031100         MOVE 'ID IS REQUIRED'        TO ALINE5O                  03110000
031200         SET PS-INVALID-INPUT         TO TRUE                     03120000
031300     ELSE                                                         03130000
031400         MOVE PV-USERID               TO AUSERO                   03140000
031500                                         DL010-KEYED-USERID       03150000
031600     END-IF.                                                      03160000
031700                                                                  03170000
031800/                                                                 03180000
031900 3000-ADD-PROCESSING.                                             03190000
032000     PERFORM 8020-RECEIVE-MAP                                     03200000
032100     PERFORM 2100-EDIT-INPUT.                                     03210000
032200                                                                  03220000
032300     IF PS-VALID-INPUT                                            03230000
032400         PERFORM 8600-CALL-XLKUT067                               03240000
032500         EVALUATE TRUE                                            03250000
032600         WHEN XL067-SUCCESSFUL AND NOT XL067-USER-NOT-FOUND       03260000
032700             PERFORM 7050-DUMMY-USERID                            03270000
032800             IF DL010-KEYED-USERID = PV-DUMMY-USERID              03280000
032900                 SET PS-INVALID-INPUT TO TRUE                     03290000
033000                 MOVE 'NOT A VALID'   TO ALINE5O                  03300000
033100                 MOVE 'ASSOCIATE'     TO ALINE6O                  03310000
033200                 MOVE -1              TO AUSERL                   03320000
033300             END-IF                                               03330000
033400             IF PS-VALID-INPUT AND XL067-USER-REVOKED-IND = 'Y'   03340000
033500                 SET PS-INVALID-INPUT TO TRUE                     03350000
033600                 MOVE 'REVOKED USERID' TO ALINE5O                 03360000
033700                 MOVE SPACES          TO ALINE6O                  03370000
033800                 MOVE '   ADD IS IGNORED  '                       03380000
033900                                      TO ALINE8O                  03390000
034000                 MOVE -1              TO AUSERL                   03400000
034100             END-IF                                               03410000
034110*                                                                 03411017
034120*  DMH - 3/24/2022 BEGIN                                          03412017
034130*  IF VALID ASSOCIATE - CHECK TO SEE IF THE ASSOCIATE IS FOR A    03413017
034140*  DIFFERENT DC LOCATION                                          03414017
034150*                                                                 03415017
034151                                                                  03415122
034153             IF  DL010-WAIT-FOR-CONFIRM                           03415330
034192                 CONTINUE                                         03419230
034193             ELSE                                                 03419330
034194* CHECK IF TEMP USERID                                            03419417
034195                 IF  XL067-USER-IS-TEMP                           03419530
034196                     PERFORM 3015-SELECT-DLT-USR-LOC-TEMP         03419630
034197                 ELSE                                             03419730
034198* CHECK IF KOHLS USERID                                           03419817
034199                     IF  XL067-USER-IS-KOHLS                      03419930
034200                         PERFORM 3055-SELECT-DLT-USR-LOC-KOHLS    03420030
034201                     END-IF                                       03420130
034202                 END-IF                                           03420230
034203             END-IF                                               03420330
034204*                                                                 03420430
034205*  DMH - 3/24/2022 END                                            03420530
034206*                                                                 03420630
034210                                                                  03421000
034300         WHEN XL067-SUCCESSFUL AND XL067-USER-NOT-FOUND           03430000
034400             SET PS-INVALID-INPUT     TO TRUE                     03440000
034500             MOVE 'NOT A VALID'       TO ALINE5O                  03450000
034600             MOVE 'ASSOCIATE'         TO ALINE6O                  03460000
034700             MOVE -1                  TO AUSERL                   03470000
034800             PERFORM 8010-SEND-DATA-ONLY                          03480000
034900             PERFORM 8100-RETURN-TRANID                           03490000
035000                                                                  03500000
035100         WHEN XL067-SQL-ERROR                                     03510000
035200         WHEN XL067-INVALID-ACCESS                                03520000
035300             MOVE '3000-ADD-PROCESSING' TO DP013-PARAGRAPH        03530000
035400             MOVE 'DLKRF450 - DB2 ERROR IN PROGRAM: '             03540000
035500                                      TO DP013-MESSAGE-TEXT (1)   03550000
035600             MOVE 'XLKUT067'          TO DP013-MESSAGE-TEXT (2)   03560000
035700             SET DP013-CICS-ABEND                                 03570000
035800                 DP013-ROLLBACK       TO TRUE                     03580000
035900             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               03590000
036000             MOVE PC-TRANS-UNAVAILABLE-MSG                        03600000
036100                                      TO ALINE8O                  03610000
036200             SET DL010-PROCESS-SCREEN TO TRUE                     03620000
036300             MOVE -1                  TO AUSERL                   03630000
036400             PERFORM 8000-SEND-MAP                                03640000
036500             PERFORM 8100-RETURN-TRANID                           03650000
036600                                                                  03660000
036700         WHEN OTHER                                               03670000
036800             MOVE '3000-ADD-PROCESSING' TO DP013-PARAGRAPH        03680000
036900             MOVE 'DLKRF450 - UNDETERMINED ERROR IN PGM: '        03690000
037000                                      TO DP013-MESSAGE-TEXT (1)   03700000
037100             MOVE 'XLKUT067'          TO DP013-MESSAGE-TEXT (2)   03710000
037200             SET DP013-CICS-ABEND                                 03720000
037300                 DP013-ROLLBACK       TO TRUE                     03730000
037400             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               03740000
037500             MOVE PC-TRANS-UNAVAILABLE-MSG                        03750000
037600                                      TO ALINE8O                  03760000
037700             SET DL010-PROCESS-SCREEN TO TRUE                     03770000
037800             MOVE -1                  TO AUSERL                   03780000
037900             PERFORM 8000-SEND-MAP                                03790000
038000             PERFORM 8100-RETURN-TRANID                           03800000
038100                                                                  03810000
038200         END-EVALUATE                                             03820000
038300     END-IF.                                                      03830000
038400                                                                  03840000
038500     IF PS-VALID-INPUT                                            03850000
038600         PERFORM 3001-CHECK-IF-NEW-USER                           03860000
038700     END-IF.                                                      03870000
038701                                                                  03870117
038810                                                                  03881000
038900     IF PS-VALID-INPUT                                            03890000
039000         INITIALIZE DL003-ASGMT-COMMAREA                          03900000
039100         SET DL003-BY-USER-KEY        TO TRUE                     03910000
039200         MOVE DL010-KEYED-USERID      TO DL003-KEY-USER-ID        03920000
039300         PERFORM 8610-CALL-DLKUT001                               03930000
039400                                                                  03940000
039500         EVALUATE TRUE                                            03950000
039600         WHEN DL003-ASGMT-FOUND                                   03960000
039700*            SHOW PF2 TO REASSIGN TO USER HERE                    03970000
039800*            SHOW PF4 (DLKRF452) TO SEE OTHER ASSIGNMENT          03980000
039900                                                                  03990000
040000                                                                  04000000
040100         IF DL003-ASGMT-START-DTE = DL010-ASGMT-STRT-DTE          04010000
040200             AND                                                  04020000
040300             DL003-ASGMT-NBR-TXT  = DL010-ASGMT-NBR-TXT           04030000
040400             AND                                                  04040000
040500             DL003-ASGMT-NBR-SEQ-NBR  = DL010-ASGMT-NBR-SEQ-NBR   04050000
040600                                                                  04060000
040700             MOVE ' ALREADY ASSIGNED  '                           04070000
040800                                      TO ALINE5O                  04080000
040900             MOVE '   TO THIS TEAM    '                           04090000
041000                                      TO ALINE6O                  04100000
041100             MOVE 'F5-ADD  F6-TEAM LST'                           04110000
041200                                      TO ALINE7O                  04120000
041300             MOVE '   ADD IS IGNORED  ' TO ALINE8O                04130000
041400                                                                  04140000
041500         ELSE                                                     04150000
041600                                                                  04160000
041700             MOVE ' ATTACHED TO OTHER '                           04170000
041800                                      TO ALINE5O                  04180000
041900             MOVE '    ASSIGNMENT     '                           04190000
042000                                      TO ALINE6O                  04200000
042100             MOVE 'F2-ADD    F3-IGNORE'                           04210000
042200                                      TO ALINE7O                  04220000
042300             MOVE 'F4-DISP OTHER ASGMT'                           04230000
042400                                      TO ALINE8O                  04240000
042500             SET PS-INVALID-INPUT                                 04250000
042600                 DL010-CHG-PENDING    TO TRUE                     04260000
042700         END-IF                                                   04270000
042800         WHEN DL003-ASGMT-NOT-FOUND                               04280000
042900*            CALL DLKUP002 TO ADD WORKER TO ASSIGNMENT            04290000
043000             PERFORM 3100-ADD-TO-ASSIGNMENT                       04300000
043001**GB 6/25/15                                                      04300101
043002             IF PS-ERRORS-NO                                      04300201
043010                PERFORM 3150-CREATE-ASGMNT-EVENT                  04301001
043011                IF PS-ERRORS-NO                                   04301107
043012                  PERFORM 4200-SEL-TEAM-ASGMT-USERS               04301207
043013                  IF PS-CREATE-MAN-ADD-YES                        04301307
043014                     PERFORM 3150-CREATE-ASGMNT-EVENT             04301407
043015                  END-IF                                          04301507
043016                END-IF                                            04301607
043020             END-IF                                               04302001
043030**GB 6/25/15                                                      04303001
043100             IF PS-ERRORS-NO                                      04310000
043200                 PERFORM 7000-COUNT-UP-TEAM                       04320000
043300                 MOVE PV-TEAM-COUNT   TO ATMCNTO                  04330000
043400             END-IF                                               04340000
043500         WHEN DL003-ASGMT-MULT-FOUND                              04350000
043600*            ERROR SCREEN DLKRF456                                04360000
043700             SET PS-INVALID-INPUT     TO TRUE                     04370000
043800             MOVE 1                   TO PV-ERROR-NBR             04380000
043900                                         DL010-ERROR-NBR          04390000
044000             MOVE DL010-USERID        TO PV-LOG-USER-ID           04400000
044100             MOVE DL003-ASGMT-SQLCODE TO PV-SQLCODE               04410000
044200             PERFORM 9903-WRITE-CICS-LOG                          04420000
044300             MOVE 4                   TO DL010-PGM-MSG-NBR        04430000
044400             PERFORM 8210-XCTL-ERROR-SCREEN                       04440000
044500         WHEN OTHER                                               04450000
044600*            ERROR SCREEN DLKRF456                                04460000
044700             SET PS-INVALID-INPUT     TO TRUE                     04470000
044800             MOVE 2                   TO PV-ERROR-NBR             04480000
044900                                         DL010-ERROR-NBR          04490000
045000             MOVE DL010-USERID        TO PV-LOG-USER-ID           04500000
045100             MOVE DL003-ASGMT-SQLCODE TO PV-SQLCODE               04510000
045200             PERFORM 9903-WRITE-CICS-LOG                          04520000
045300             MOVE 1                   TO DL010-PGM-MSG-NBR        04530000
045400             PERFORM 8210-XCTL-ERROR-SCREEN                       04540000
045500         END-EVALUATE                                             04550000
045600                                                                  04560000
045700     END-IF.                                                      04570000
045800                                                                  04580000
045801 3001-CHECK-IF-NEW-USER.                                          04580100
045809     MOVE DL010-KEYED-USERID TO PV-KEYED-USERID.                  04580900
045810     IF PV-KEYED-USERID-KOHLS                                     04581000
045811         SET PS-CREATE-NEW-USER-YES       TO TRUE                 04581100
045812         PERFORM 7100-SELECT-RDPR-USR                             04581200
045813     ELSE                                                         04581300
045814         SET PS-CREATE-NEW-USER-NO        TO TRUE                 04581400
045815     END-IF.                                                      04581500
045816                                                                  04581600
045820     IF PS-CREATE-NEW-USER-YES                                    04582000
045830*        THE SWITCH COULD BE TURNED OFF IN PARA 7000              04583000
084300         INITIALIZE XL072-EAI-EXPORT-COMMAREA                     08430000
084400                                                                  08440000
084500         SET XL072-PC-APP-ID      TO TRUE                         08450000
084600         MOVE 'DC LABOR'          TO XL072-EVNT-OBJ-TXT           08460000
084700         MOVE 'ASSOCIATE ADD'     TO XL072-EVNT-OBJ-ACTN-TXT      08470000
084900                                                                  08490000
085000         MOVE DL010-USERID        TO XL072-CRE-BY-USR-ID          08500000
085300         MOVE 'DLKRF450'          TO XL072-CRE-PGM-NM             08530000
085500         MOVE 'N/A'               TO XL072-DTL-COPYBOOK-NM        08550000
085501         MOVE DL010-OPER-UNT-ID   TO XL072-EVNT-KY-1-NBR          08550100
085502         MOVE DL010-KEYED-USERID  TO XL072-EVNT-KY-1-TXT          08550200
085503         MOVE XL067-LAST-NAME     TO XL072-EVNT-KY-2-TXT          08550300
085504         MOVE XL067-FIRST-NAME    TO XL072-EVNT-KY-3-TXT          08550400
085600                                                                  08560000
086000         SET XL072-COMMIT-UPDATE  TO TRUE                         08600000
086100         MOVE 'DLKRF450'          TO XL072-ORIG-CALLING-PGM-NM    08610000
086200                                                                  08620000
088500         PERFORM 8630-CALL-XLKUP033                               08850000
090000                                                                  09000000
090001     END-IF.                                                      09000100
090002                                                                  09000217
090003                                                                  09000317
090004******************************************************************09000417
090005*  DMH - 3/24/2022                                               *09000517
090006*  IF VALID ASSOCIATE - CHECK TO SEE IF THE ASSOCIATE IS FOR A   *09000617
090007*  DIFFERENT DC LOCATION                                         *09000717
090008*  CHECK FOR TEMP USERID                                         *09000817
090015*----------------------------------------------------------------*09001517
090016* TEMP USERID AND CURRENT OPER                                   *09001617
090017* CHECK IF THE TK HAS ALREADY BEEN USED FOR CURRENT LOCATION     *09001717
090018* +0 OR -811 - THE TK HAS ALREADY BEEN USED FOR CURRENT LOCATION *09001817
090019* +100 - NOT USED FOR THIS LOCATION                              *09001917
090020*        PERFORM SQL AGAIN WITHOUT OPER TO SEE IF FROM ANOTHER   *09002017
090021*        LOCATION                                                *09002117
090023******************************************************************09002321
090024 3015-SELECT-DLT-USR-LOC-TEMP.                                    09002417
090041                                                                  09004117
090042     MOVE DL010-KEYED-USERID TO  DK-USR-ID.                       09004217
090043     MOVE DL010-OPER-UNT-ID  TO  DK-LOC-NBR.                      09004317
090044                                                                  09004417
090045     EXEC SQL                                                     09004517
090046          SELECT LOC_NBR                                          09004617
090047            INTO :DLT00009-LOC-NBR                                09004717
090048            FROM DLT_RDPR_USR_LSTG                                09004817
090049           WHERE TMP_USR_ID  = :DK-USR-ID                         09004917
090050             AND LOC_NBR     = :DK-LOC-NBR                        09005017
090051            WITH UR                                               09005117
090052     END-EXEC.                                                    09005217
090053                                                                  09005317
090054     EVALUATE TRUE                                                09005417
090055         WHEN SQLCODE = +0                                        09005517
090056         WHEN SQLCODE = -811                                      09005617
090057              CONTINUE                                            09005717
090067                                                                  09006717
090068         WHEN SQLCODE = +100                                      09006817
090079              PERFORM 3020-DLT-USR-TEMP-NO-OPER                   09007917
090080                                                                  09008017
090081         WHEN SQLWARN0 NOT = SPACES                               09008117
090082         WHEN SQLCODE < +0                                        09008217
090083         WHEN SQLCODE > +0                                        09008317
090084                                                                  09008417
090107             MOVE 3015                TO PV-ERROR-NBR             09010717
090108                                         DL010-ERROR-NBR          09010817
090109             PERFORM 9903-WRITE-CICS-LOG                          09010917
090110             MOVE '3015-SELECT-DLT-USR-LOC-TEMP'                  09011017
090111                                      TO DL010-PARAGRAPH          09011117
090112             MOVE 'DLKRF450 - TEMP USER & OPER'                   09011217
090113                                      TO DL010-MESSAGE-TEXT(1)    09011317
090114             MOVE SQLCA               TO DL010-SQLCA              09011417
090115             MOVE 'DLT_RDPR_USR_LSTG' TO DL010-DB2-TABLE-NAME(1)  09011517
090116             SET DL010-ABEND          TO TRUE                     09011617
090117             MOVE 3                   TO DL010-PGM-MSG-NBR        09011717
090118             PERFORM 8210-XCTL-ERROR-SCREEN                       09011817
090119                                                                  09011917
090120     END-EVALUATE.                                                09012017
090121                                                                  09012117
090122                                                                  09012217
090123*----------------------------------------------------------------*09012317
090124* TEMP USERID AND NO OPER                                        *09012417
090125* CHECK IF THE TK HAS ALREADY BEEN USED FOR DIFFERENT LOCATION   *09012517
090126* +0 OR -811 - THE TK HAS ALREADY BEEN USED AT DIFFERENT OPER    *09012617
090127*              DISPLAY NEW ERROR MESSAGE WITH F2-CONFIRM         *09012717
090128* +100 - NOT USED FOR THIS LOCATION                              *09012817
090129*        THIS IS A NEW ID - CONTINUE PROCESSING                  *09012917
090130*----------------------------------------------------------------*09013017
090131 3020-DLT-USR-TEMP-NO-OPER.                                       09013117
090148                                                                  09014817
090149     MOVE DL010-KEYED-USERID TO  DK-USR-ID.                       09014917
090150     MOVE DL010-OPER-UNT-ID  TO  DK-LOC-NBR.                      09015017
090151                                                                  09015117
090152     EXEC SQL                                                     09015217
090153          SELECT LOC_NBR                                          09015317
090154            INTO :DLT00009-LOC-NBR                                09015417
090155            FROM DLT_RDPR_USR_LSTG                                09015517
090156           WHERE TMP_USR_ID  = :DK-USR-ID                         09015617
090157            FETCH FIRST 1 ROW ONLY                                09015717
090158            WITH UR                                               09015817
090159     END-EXEC.                                                    09015917
090160                                                                  09016017
090161     EVALUATE TRUE                                                09016117
090162         WHEN SQLCODE = +0                                        09016217
090163         WHEN SQLCODE = -811                                      09016317
090174             MOVE DLT00009-LOC-NBR TO  PV-DISP-OPER               09017424
090175             MOVE '**USERID LAST USED*'                           09017525
090176                                      TO ALINE5O                  09017617
090177             STRING '**AT LOCATION '                              09017725
090178                    PV-DISP-OPER '*'     DELIMITED BY SIZE        09017826
090179                                    INTO ALINE6O                  09017924
090180             MOVE 'F2-CONFIRM ADD     '                           09018024
090181                                      TO ALINE7O                  09018124
090182             MOVE 'F3-IGNORE          '                           09018224
090183                                      TO ALINE8O                  09018324
090184             SET PS-INVALID-INPUT                                 09018424
090185                 DL010-WAIT-FOR-CONFIRM TO TRUE                   09018529
090199                                                                  09019917
090200         WHEN SQLCODE = +100                                      09020017
090211              CONTINUE                                            09021117
090212                                                                  09021217
090213         WHEN SQLWARN0 NOT = SPACES                               09021317
090214         WHEN SQLCODE < +0                                        09021417
090215         WHEN SQLCODE > +0                                        09021517
090225             MOVE 3020                TO PV-ERROR-NBR             09022517
090226                                         DL010-ERROR-NBR          09022617
090227             PERFORM 9903-WRITE-CICS-LOG                          09022717
090228             MOVE '3020-SELECT-DLT-USR-TEMP-NO-OPER'              09022817
090229                                      TO DL010-PARAGRAPH          09022917
090230             MOVE 'DLKRF450 - TEMP USER NO OPER '                 09023017
090231                                      TO DL010-MESSAGE-TEXT(1)    09023117
090232             MOVE SQLCA               TO DL010-SQLCA              09023217
090233             MOVE 'DLT_RDPR_USR_LSTG' TO DL010-DB2-TABLE-NAME(1)  09023317
090234             SET DL010-ABEND          TO TRUE                     09023417
090235             MOVE 3                   TO DL010-PGM-MSG-NBR        09023517
090236             PERFORM 8210-XCTL-ERROR-SCREEN                       09023617
090237                                                                  09023717
090238     END-EVALUATE.                                                09023817
090239                                                                  09023917
090240                                                                  09024017
090242******************************************************************09024217
090243*  DMH - 3/24/2022                                               *09024317
090244*  IF VALID ASSOCIATE - CHECK TO SEE IF THE ASSOCIATE IS FOR A   *09024417
090245*  DIFFERENT DC LOCATION                                         *09024517
090246*  CHECK FOIR KOHLS USERID                                       *09024617
090251*----------------------------------------------------------------*09025117
090252* KOHLS USERID AND CURRENT OPER                                  *09025217
090253* CHECK IF THE TK HAS ALREADY BEEN USED FOR CURRENT LOCATION     *09025317
090254* +0 OR -811 - THE TK HAS ALREADY BEEN USED FOR CURRENT LOCATION *09025417
090255* +100 - NOT USED FOR THIS LOCATION                              *09025517
090256*        PERFORM SQL AGAIN WITHOUT OPER TO SEE IF FROM ANOTHER   *09025617
090257*        LOCATION                                                *09025717
090259******************************************************************09025921
090260 3055-SELECT-DLT-USR-LOC-KOHLS.                                   09026017
090278     MOVE DL010-KEYED-USERID TO  DK-USR-ID.                       09027817
090279     MOVE DL010-OPER-UNT-ID  TO  DK-LOC-NBR.                      09027917
090280                                                                  09028017
090281     EXEC SQL                                                     09028117
090282          SELECT LOC_NBR                                          09028217
090283            INTO :DLT00009-LOC-NBR                                09028317
090284            FROM DLT_RDPR_USR_LSTG                                09028417
090285           WHERE USR_ID      = :DK-USR-ID                         09028517
090286             AND LOC_NBR     = :DK-LOC-NBR                        09028617
090287            WITH UR                                               09028717
090288     END-EXEC.                                                    09028817
090289                                                                  09028917
090290     EVALUATE TRUE                                                09029017
090291         WHEN SQLCODE = +0                                        09029117
090292         WHEN SQLCODE = -811                                      09029217
090293              CONTINUE                                            09029317
090294                                                                  09029417
090304         WHEN SQLCODE = +100                                      09030417
090315              PERFORM 3060-DLT-USR-KOHLS-NO-OPER                  09031517
090316                                                                  09031617
090317         WHEN SQLWARN0 NOT = SPACES                               09031717
090318         WHEN SQLCODE < +0                                        09031817
090319         WHEN SQLCODE > +0                                        09031917
090320                                                                  09032017
090329             MOVE 3055                TO PV-ERROR-NBR             09032917
090330                                         DL010-ERROR-NBR          09033017
090331             PERFORM 9903-WRITE-CICS-LOG                          09033117
090332             MOVE '3055-SELECT-DLT-USR-LOC-KOHLS'                 09033217
090333                                      TO DL010-PARAGRAPH          09033317
090334             MOVE 'DLKRF450 - TEMP USER & OPER'                   09033417
090335                                      TO DL010-MESSAGE-TEXT(1)    09033517
090336             MOVE SQLCA               TO DL010-SQLCA              09033617
090337             MOVE 'DLT_RDPR_USR_LSTG' TO DL010-DB2-TABLE-NAME(1)  09033717
090338             SET DL010-ABEND          TO TRUE                     09033817
090339             MOVE 3                   TO DL010-PGM-MSG-NBR        09033917
090340             PERFORM 8210-XCTL-ERROR-SCREEN                       09034017
090341                                                                  09034117
090342     END-EVALUATE.                                                09034217
090343                                                                  09034317
090344                                                                  09034417
090345*----------------------------------------------------------------*09034517
090346* KOHLS USERID AND NO OPER                                       *09034617
090347* CHECK IF THE TK HAS ALREADY BEEN USED FOR DIFFERENT LOCATION   *09034717
090348* +0 OR -811 - THE TK HAS ALREADY BEEN USED AT DIFFERENT OPER    *09034817
090349*              DISPLAY NEW ERROR MESSAGE WITH F2-CONFIRM         *09034917
090350* +100 - NOT USED FOR THIS LOCATION                              *09035017
090351*        THIS IS A NEW ID - CONTINUE PROCESSING                  *09035117
090352*----------------------------------------------------------------*09035217
090353 3060-DLT-USR-KOHLS-NO-OPER.                                      09035317
090370                                                                  09037017
090371     MOVE DL010-KEYED-USERID TO  DK-USR-ID.                       09037117
090372     MOVE DL010-OPER-UNT-ID  TO  DK-LOC-NBR.                      09037217
090373                                                                  09037317
090374     EXEC SQL                                                     09037417
090375          SELECT LOC_NBR                                          09037517
090376            INTO :DLT00009-LOC-NBR                                09037617
090377            FROM DLT_RDPR_USR_LSTG                                09037717
090378           WHERE USR_ID      = :DK-USR-ID                         09037817
090379            FETCH FIRST 1 ROW ONLY                                09037917
090380            WITH UR                                               09038017
090381     END-EXEC.                                                    09038117
090382                                                                  09038217
090383     EVALUATE TRUE                                                09038317
090384         WHEN SQLCODE = +0                                        09038417
090385         WHEN SQLCODE = -811                                      09038517
090386                                                                  09038617
090396             MOVE DLT00009-LOC-NBR TO  PV-DISP-OPER               09039624
090398             MOVE '**USERID LAST USED*'                           09039825
090399                                      TO ALINE5O                  09039917
090400             STRING '**AT LOCATION '                              09040025
090401                    PV-DISP-OPER '*'     DELIMITED BY SIZE        09040126
090402                                    INTO ALINE6O                  09040224
090403             MOVE 'F2-CONFIRM ADD     '                           09040317
090404                                      TO ALINE7O                  09040417
090405             MOVE 'F3-IGNORE          '                           09040517
090406                                      TO ALINE8O                  09040617
090407             SET PS-INVALID-INPUT                                 09040717
090408                 DL010-WAIT-FOR-CONFIRM TO TRUE                   09040829
090409                                                                  09040917
090410         WHEN SQLCODE = +100                                      09041017
090411                                                                  09041117
090421              CONTINUE                                            09042117
090422                                                                  09042217
090423         WHEN SQLWARN0 NOT = SPACES                               09042317
090424         WHEN SQLCODE < +0                                        09042417
090425         WHEN SQLCODE > +0                                        09042517
090426                                                                  09042617
090435             MOVE 3060                TO PV-ERROR-NBR             09043517
090436                                         DL010-ERROR-NBR          09043617
090437             PERFORM 9903-WRITE-CICS-LOG                          09043717
090438             MOVE '3060-SELECT-DLT-USR-KOHLS-NO-OPER'             09043817
090439                                      TO DL010-PARAGRAPH          09043917
090440             MOVE 'DLKRF450 - KOHLS USER NO OPER '                09044017
090441                                      TO DL010-MESSAGE-TEXT(1)    09044117
090442             MOVE SQLCA               TO DL010-SQLCA              09044217
090443             MOVE 'DLT_RDPR_USR_LSTG' TO DL010-DB2-TABLE-NAME(1)  09044317
090444             SET DL010-ABEND          TO TRUE                     09044417
090445             MOVE 3                   TO DL010-PGM-MSG-NBR        09044517
090446             PERFORM 8210-XCTL-ERROR-SCREEN                       09044617
090447                                                                  09044717
090448     END-EVALUATE.                                                09044817
090449                                                                  09044917
090450                                                                  09045017
090453******************************************************************09045317
090454*                                                                *09045417
090455*                                                                *09045517
090456******************************************************************09045617
090457 3100-ADD-TO-ASSIGNMENT.                                          09045700
090464                                                                  09046401
090465     INITIALIZE DL005-ASGMT-COMMAREA                              09046500
090466     SET DL005-BY-ASGMT-NBR           TO TRUE                     09046600
090467     SET DL005-ADD-TO-ASGMT           TO TRUE                     09046700
090468     SET DL005-DO-NOT-COMMIT-UPDATE   TO TRUE                     09046800
090469     MOVE DL010-ASGMT-STRT-DTE        TO DL005-KEY-START-DTE      09046900
090470     MOVE DL010-ASGMT-NBR-TXT         TO DL005-KEY-NBR-TXT        09047000
090471     MOVE DL010-ASGMT-NBR-SEQ-NBR     TO DL005-KEY-NBR-SEQ-NBR    09047100
090472     MOVE DL010-KEYED-USERID          TO DL005-KEY-USER-ID        09047200
090473     MOVE DL010-USERID                TO DL005-KEY-ADD-BY-USER-ID 09047300
090474     IF XL067-USER-IS-KOHLS                                       09047400
090475         SET DL005-KEY-USR-IS-KOHLS   TO TRUE                     09047500
090476     ELSE                                                         09047600
090477         SET DL005-KEY-USR-IS-TEMP    TO TRUE                     09047700
090478     END-IF                                                       09047800
090479     MOVE 'DLKRF450'                  TO DL005-ORIG-CALLING-PGM-NM09047900
090480                                                                  09048000
090481     PERFORM 8620-CALL-DLKUP002.                                  09048100
090482                                                                  09048200
090490     EVALUATE TRUE                                                09049000
090500         WHEN DL005-SUCCESSFUL                                    09050000
090600             CONTINUE                                             09060000
090700         WHEN DL005-ASGMT-NOT-ACTIVE                              09070000
090800             MOVE '     INACTIVE      '                           09080000
090900                                      TO ALINE5O                  09090000
091000             MOVE '    ASSIGNMENT     '                           09100000
091100                                      TO ALINE6O                  09110000
091200             MOVE SPACES              TO ALINE7O                  09120000
091300             MOVE '     PRESS F3      '                           09130000
091400                                      TO ALINE8O                  09140000
091500             MOVE -1                  TO AUSERL                   09150000
091600             SET PS-ERRORS-YES        TO TRUE                     09160000
091700         WHEN DL005-SQL-ERROR                                     09170000
091800             MOVE 3                   TO PV-ERROR-NBR             09180000
091900                                         DL010-ERROR-NBR          09190000
092000             MOVE DL010-USERID        TO PV-LOG-USER-ID           09200000
092100             MOVE DL005-ASGMT-SQLCODE TO PV-SQLCODE               09210000
092200             PERFORM 9903-WRITE-CICS-LOG                          09220000
092300             MOVE '3100-ADD-TO-ASSIGNMENT'                        09230000
092400                                      TO DL010-PARAGRAPH          09240000
092500             MOVE 'DLKRF450 - END ASSIGNMENT'                     09250000
092600                                      TO DL010-MESSAGE-TEXT(1)    09260000
092700             MOVE DL005-SQL-ERROR-PARA                            09270000
092800                                      TO DL010-MESSAGE-TEXT(2)    09280000
092900             MOVE DL005-SQLCA         TO DL010-SQLCA              09290000
093000             SET DL010-ABEND          TO TRUE                     09300000
093100             MOVE 3                   TO DL010-PGM-MSG-NBR        09310000
093200             PERFORM 8210-XCTL-ERROR-SCREEN                       09320000
093300     END-EVALUATE.                                                09330000
093305******************************************************************09330506
093306*GB 7/01/14 ADDED LOGIC TO CREATE NEW EVENT ASSIGNMENT USER ADD   09330606
093307*   FOR LM LABOR THIS WILL CREATE VISIBILITY FOR THE 'HELPER'     09330706
093308*   ROLE WHERE THE ASSOCIATE IS ON A TEAM, BUT NOT CREATING       09330806
093309*   ACTUAL EVENTS TO THE DATABASE.                                09330906
093310******************************************************************09331006
093311 3150-CREATE-ASGMNT-EVENT.                                        09331101
093391                                                                  09339101
093394     INITIALIZE XL072-EAI-EXPORT-COMMAREA                         09339401
093395                                                                  09339501
093396     SET XL072-PC-APP-ID         TO TRUE                          09339601
093397     MOVE 'DC LABOR'             TO XL072-EVNT-OBJ-TXT            09339701
093398     MOVE 'ASSIGNMENT USER ADD'  TO XL072-EVNT-OBJ-ACTN-TXT       09339801
093399                                                                  09339901
093400     MOVE DL010-USERID        TO XL072-CRE-BY-USR-ID              09340001
093401     MOVE 'DLKRF450'          TO XL072-CRE-PGM-NM                 09340101
093402     MOVE 'N/A'                   TO XL072-DTL-COPYBOOK-NM        09340201
093403                                                                  09340301
093404     MOVE DL010-ASGMT-NBR-SEQ-NBR TO XL072-EVNT-KY-1-NBR          09340401
093405     MOVE DL010-OPER-UNT-ID       TO XL072-EVNT-KY-2-NBR          09340501
093406                                                                  09340601
093407     MOVE DL010-ASGMT-NBR-TXT TO XL072-EVNT-KY-1-TXT              09340701
093408                                                                  09340807
093409     IF PS-CREATE-MAN-ADD-YES                                     09340907
093410        MOVE PV-USERID-MAN-ADD   TO XL072-EVNT-KY-2-TXT           09341011
093411     ELSE                                                         09341107
093412        MOVE DL010-KEYED-USERID  TO XL072-EVNT-KY-2-TXT           09341207
093413     END-IF                                                       09341307
093414                                                                  09341407
093415     MOVE DL010-WRK-AREA-DESC TO XL072-EVNT-KY-3-TXT              09341501
093416     MOVE DL010-WRK-TYP-DESC  TO XL072-EVNT-KY-4-TXT              09341601
093417                                                                  09341701
093418     MOVE DL010-ASGMT-STRT-DTE  TO   PV-START-TMST-DATE           09341803
093419     MOVE '-'                  TO    PV-DASH-1                    09341902
093420                                     PV-DASH-2                    09342002
093421                                     PV-DASH-3.                   09342102
093422     MOVE PV-START-TMST        TO   XL072-EVNT-KY-1-TMST          09342202
093423     MOVE DL005-ASSOC-TMST     TO   XL072-EVNT-KY-2-TMST          09342302
093424                                                                  09342402
093425     SET XL072-COMMIT-UPDATE  TO TRUE                             09342502
093426     MOVE 'DLKRF450'          TO XL072-ORIG-CALLING-PGM-NM        09342602
093427                                                                  09342702
093428     PERFORM 8630-CALL-XLKUP033.                                  09342802
093430                                                                  09343002
093500 3200-END-FROM-ASSIGNMENT.                                        09350000
093560                                                                  09356028
093600     INITIALIZE DL005-ASGMT-COMMAREA                              09360000
093700     SET DL005-BY-ASGMT-NBR                                       09370000
093800         DL005-END-FROM-ASGMT                                     09380000
093900         DL005-KEY-LVE-RSN-SSTOP                                  09390000
094000         DL005-DO-NOT-COMMIT-UPDATE   TO TRUE                     09400000
094100     MOVE DL003-ASGMT-START-DTE       TO DL005-KEY-START-DTE      09410000
094200     MOVE DL003-ASGMT-NBR-TXT         TO DL005-KEY-NBR-TXT        09420000
094300     MOVE DL003-ASGMT-NBR-SEQ-NBR     TO DL005-KEY-NBR-SEQ-NBR    09430000
094400     MOVE DL003-TEM-ASGMT-SEQ-NBR     TO                          09440000
094500                                   DL005-KEY-TEM-ASGMT-SEQ-NBR    09450000
094600     MOVE DL010-KEYED-USERID          TO DL005-KEY-USER-ID        09460000
094700     MOVE DL010-USERID                TO DL005-KEY-ADD-BY-USER-ID 09470000
094800     IF DL003-USR-IS-KOHLS                                        09480000
094900         SET DL005-KEY-USR-IS-KOHLS    TO TRUE                    09490000
095000     ELSE                                                         09500000
095100         SET DL005-KEY-USR-IS-TEMP     TO TRUE                    09510000
095200     END-IF                                                       09520000
095300     MOVE 'DLKRF450'                  TO DL005-ORIG-CALLING-PGM-NM09530000
095400                                         DL005-KEY-LVE-PGM-NM     09540000
095500                                                                  09550000
095600     PERFORM 8620-CALL-DLKUP002.                                  09560000
095700     EVALUATE TRUE                                                09570000
095800         WHEN DL005-SUCCESSFUL                                    09580000
095900             CONTINUE                                             09590000
096000         WHEN DL005-SQL-ERROR                                     09600000
096100             MOVE 4                   TO PV-ERROR-NBR             09610000
096200                                         DL010-ERROR-NBR          09620000
096300             MOVE DL010-USERID        TO PV-LOG-USER-ID           09630000
096400             MOVE DL005-ASGMT-SQLCODE TO PV-SQLCODE               09640000
096500             PERFORM 9903-WRITE-CICS-LOG                          09650000
096600             MOVE '3200-END-FROM-ASSIGNMENT'                      09660000
096700                                      TO DL010-PARAGRAPH          09670000
096800             MOVE 'DLKRF450 - END ASSIGNMENT'                     09680000
096900                                      TO DL010-MESSAGE-TEXT(1)    09690000
097000             MOVE DL005-SQL-ERROR-PARA                            09700000
097100                                      TO DL010-MESSAGE-TEXT(2)    09710000
097200             MOVE DL005-SQLCA         TO DL010-SQLCA              09720000
097300             SET DL010-ABEND          TO TRUE                     09730000
097400             MOVE 3                   TO DL010-PGM-MSG-NBR        09740000
097500             PERFORM 8210-XCTL-ERROR-SCREEN                       09750000
097600     END-EVALUATE.                                                09760000
097700                                                                  09770000
097800                                                                  09780000
097900* THE FOLLOWING IS TO PROCESS THE CALL TO XLKUP033 TO LOG AN      09790000
098000* INDIRECT CODE OF AN S (SYSTEM) MOVE FOR THE ASSOCIATE           09800000
098100                                                                  09810000
098200 3300-GENERATE-S-MOVE.                                            09820000
098300                                                                  09830000
098400     INITIALIZE XL072-EAI-EXPORT-COMMAREA.                        09840000
098500                                                                  09850000
098600     SET XL072-PC-APP-ID                                          09860000
098700         XL072-COMMIT-UPDATE          TO TRUE.                    09870000
098800                                                                  09880000
098900     MOVE PC-CURRENT-PROGRAM-NAME     TO XL072-CRE-PGM-NM.        09890000
099000                                                                  09900000
099100     MOVE ZEROES                      TO XL072-EVNT-KY-1-NBR      09910000
099200                                         XL072-EVNT-KY-2-NBR      09920000
099300                                         XL072-EVNT-KY-3-NBR      09930000
099400                                         XL072-EVNT-KY-4-NBR      09940000
099500                                         XL072-EVNT-KY-5-NBR.     09950000
099600                                                                  09960000
099700     MOVE SPACES                      TO XL072-EVNT-KY-1-TXT      09970000
099800                                         XL072-EVNT-KY-2-TXT      09980000
099900                                         XL072-EVNT-KY-3-TXT      09990000
100000                                         XL072-EVNT-KY-4-TXT      10000000
100100                                         XL072-EVNT-KY-5-TXT      10010000
100200                                         XL072-EVNT-KY-1-TMST     10020000
100300                                         XL072-EVNT-KY-2-TMST     10030000
100400                                         XL072-EVNT-KY-3-TMST     10040000
100500                                         XL072-EVNT-KY-4-TMST     10050000
100600                                         XL072-EVNT-KY-5-TMST.    10060000
100700                                                                  10070000
100800     MOVE 'DC LABOR'                  TO XL072-EVNT-OBJ-TXT.      10080000
100900     MOVE 'INDIRECT LABOR'            TO XL072-EVNT-OBJ-ACTN-TXT. 10090000
101000     MOVE DL010-KEYED-USERID          TO XL072-CRE-BY-USR-ID.     10100000
101100     MOVE DL010-OPER-UNT-ID           TO XL072-EVNT-KY-1-NBR.     10110000
101200***  MOVE 'SMOVE'                     TO XL072-EVNT-KY-1-TXT.     10120000
101300     IF DL003-ASGMT-WK-TYP-DESC = 'RECV'                          10130000
101400         MOVE 'SRMOVE'                TO XL072-EVNT-KY-1-TXT      10140000
101500     END-IF.                                                      10150000
101600     IF DL003-ASGMT-WK-TYP-DESC = 'SHIP'                          10160000
101700         MOVE 'SSMOVE'                TO XL072-EVNT-KY-1-TXT      10170000
101800     END-IF.                                                      10180000
101900     IF DL003-ASGMT-WK-TYP-DESC = 'P2L'                           10190000
102000         MOVE 'SPMOVE'                TO XL072-EVNT-KY-1-TXT      10200000
102100     END-IF.                                                      10210000
102200     IF DL003-ASGMT-WK-TYP-DESC = 'FLAT'                          10220000
102300         MOVE 'SFMOVE'                TO XL072-EVNT-KY-1-TXT      10230000
102400     END-IF.                                                      10240000
102500     IF DL003-ASGMT-WK-TYP-DESC = 'RLABL'                         10250000
102600         MOVE 'SLMOVE'                TO XL072-EVNT-KY-1-TXT      10260000
102700     END-IF.                                                      10270000
102800     IF DL003-ASGMT-WK-TYP-DESC = 'MASTCON'                       10280000
102900         MOVE 'SMMOVE'                TO XL072-EVNT-KY-1-TXT      10290000
103000     END-IF.                                                      10300000
103100                                                                  10310000
103200     MOVE DL005-ASSOC-TMST            TO PV-HOLD-TIMESTAMP.       10320000
103300                                                                  10330000
103400     PERFORM 3320-GET-TIMESTAMP.                                  10340000
103500     MOVE PV-LABOR-CURRENT-TIMESTAMP  TO XL072-EVNT-KY-1-TMST     10350000
103600                                                                  10360000
103700     SET XL072-COPYBOOK-NOT-USED      TO TRUE.                    10370000
103800                                                                  10380000
103900     PERFORM 8630-CALL-XLKUP033.                                  10390000
104000                                                                  10400000
104100 3320-GET-TIMESTAMP.                                              10410000
104200                                                                  10420000
104300     EXEC SQL                                                     10430000
104400         SET  :PV-LABOR-CURRENT-TIMESTAMP =                       10440000
104500              (TIMESTAMP(:PV-HOLD-TIMESTAMP) - 1 SECOND)          10450000
104600     END-EXEC.                                                    10460000
104700/                                                                 10470000
104800 4000-CHANGE-ASSIGNMENTS.                                         10480000
104860                                                                  10486028
104900     PERFORM 8020-RECEIVE-MAP                                     10490000
105000     PERFORM 2100-EDIT-INPUT.                                     10500000
105100                                                                  10510000
105200*    IS THIS A VALID USERID?                                      10520000
105300     IF PS-VALID-INPUT                                            10530000
105400         PERFORM 8600-CALL-XLKUT067                               10540000
105500         EVALUATE TRUE                                            10550000
105600         WHEN XL067-SUCCESSFUL AND NOT XL067-USER-NOT-FOUND       10560000
105700             PERFORM 7050-DUMMY-USERID                            10570000
105800             IF DL010-KEYED-USERID = PV-DUMMY-USERID              10580000
105900                 SET PS-INVALID-INPUT TO TRUE                     10590000
106000                 MOVE 'NOT A VALID'   TO ALINE5O                  10600000
106100                 MOVE 'ASSOCIATE'     TO ALINE6O                  10610000
106200                 MOVE -1              TO AUSERL                   10620000
106300             END-IF                                               10630000
106400             IF PS-VALID-INPUT AND XL067-USER-REVOKED-IND = 'Y'   10640000
106500                 SET PS-INVALID-INPUT TO TRUE                     10650000
106600                 MOVE 'REVOKED USERID' TO ALINE5O                 10660000
106700                 MOVE SPACES          TO ALINE6O                  10670000
106800                 MOVE '   ADD IS IGNORED  '                       10680000
106900                                      TO ALINE8O                  10690000
107000                 MOVE -1              TO AUSERL                   10700000
107100             END-IF                                               10710000
107200         WHEN XL067-SUCCESSFUL AND XL067-USER-NOT-FOUND           10720000
107300             SET PS-INVALID-INPUT     TO TRUE                     10730000
107400             MOVE 'NOT A VALID'       TO ALINE5O                  10740000
107500             MOVE 'ASSOCIATE'         TO ALINE6O                  10750000
107600             MOVE -1                  TO AUSERL                   10760000
107700         END-EVALUATE                                             10770000
107800     END-IF.                                                      10780000
107900                                                                  10790000
108000*    IF USERID IS VALID, FIND HIS CURRENT ASSIGNMENT              10800000
108100     IF PS-VALID-INPUT                                            10810000
108200         INITIALIZE DL003-ASGMT-COMMAREA                          10820000
108300         SET DL003-BY-USER-KEY        TO TRUE                     10830000
108400         MOVE DL010-KEYED-USERID      TO DL003-KEY-USER-ID        10840000
108500         PERFORM 8610-CALL-DLKUT001                               10850000
108600     END-IF                                                       10860000
108700                                                                  10870000
108770                                                                  10877017
108780                                                                  10878017
108800     IF DL003-SUCCESSFUL                                          10880000
108900         IF DL003-ASGMT-START-DTE = DL010-ASGMT-STRT-DTE          10890000
109000             AND                                                  10900000
109100             DL003-ASGMT-NBR-TXT  = DL010-ASGMT-NBR-TXT           10910000
109200             AND                                                  10920000
109300             DL003-ASGMT-NBR-SEQ-NBR  = DL010-ASGMT-NBR-SEQ-NBR   10930000
109400                                                                  10940000
109500             MOVE ' ALREADY ASSIGNED  '                           10950000
109600                                      TO ALINE5O                  10960000
109700             MOVE '   TO THIS TEAM    '                           10970000
109800                                      TO ALINE6O                  10980000
109900             MOVE 'F5-ADD  F6-TEAM LST'                           10990000
110000                                      TO ALINE7O                  11000000
110100             MOVE '   ADD IS IGNORED  ' TO ALINE8O                11010000
110200                                                                  11020000
110300     ELSE                                                         11030000
110400                                                                  11040000
110500*                  NOW END THE CURRENT ASSIGNMENT                 11050000
110600             PERFORM 3200-END-FROM-ASSIGNMENT                     11060000
110700                                                                  11070000
110800*                  GENERATE AN 'S MOVE' TO MARK WHEN HE LEFT      11080000
110900             PERFORM 3300-GENERATE-S-MOVE                         11090000
111000                                                                  11100000
111100*                  THEN REASSIGN THE USER TO THE NEW ONE          11110000
111200             PERFORM 3100-ADD-TO-ASSIGNMENT                       11120000
111210**GB 6/25/15                                                      11121005
111220             IF PS-ERRORS-NO                                      11122005
111230                PERFORM 3150-CREATE-ASGMNT-EVENT                  11123005
111231                IF PS-ERRORS-NO                                   11123107
111232                  PERFORM 4200-SEL-TEAM-ASGMT-USERS               11123207
111233                  IF PS-CREATE-MAN-ADD-YES                        11123307
111234                     PERFORM 3150-CREATE-ASGMNT-EVENT             11123407
111235                  END-IF                                          11123507
111236                END-IF                                            11123607
111240             END-IF                                               11124005
111250**GB 6/25/15                                                      11125005
111300     END-IF.                                                      11130000
111400/                                                                 11140000
111500 7000-COUNT-UP-TEAM.                                              11150000
111560                                                                  11156028
111600     EXEC SQL                                                     11160000
111700         SELECT COUNT(*)                                          11170000
111800         INTO :PV-TEAM-COUNT                                      11180000
111900         FROM                                                     11190000
112000             DLT_TEM_ASGMT                                        11200000
112100         WHERE                                                    11210000
112200             ASGMT_STRT_DTE     = :DL010-ASGMT-STRT-DTE           11220000
112300             AND                                                  11230000
112400             ASGMT_NBR_TXT      = :DL010-ASGMT-NBR-TXT            11240000
112500             AND                                                  11250000
112600             ASGMT_NBR_SEQ_NBR  = :DL010-ASGMT-NBR-SEQ-NBR        11260000
112700             AND                                                  11270000
112800             LVE_TMST           IS NULL                           11280000
112900     END-EXEC.                                                    11290000
113000                                                                  11300000
113100     EVALUATE TRUE                                                11310000
113200         WHEN SQLCODE = ZERO                                      11320000
113300         WHEN SQLCODE = +100                                      11330000
113400             CONTINUE                                             11340000
113500         WHEN SQLCODE = -904                                      11350000
113600         WHEN SQLCODE = -913                                      11360000
113700         WHEN SQLCODE = -911                                      11370000
113800             MOVE DL010-KEYED-USERID  TO PV-LOG-USER-ID           11380000
113900             MOVE SQLCODE             TO PV-SQLCODE               11390000
114000             MOVE 5                   TO PV-ERROR-NBR             11400000
114100                                         DL010-ERROR-NBR          11410000
114200             PERFORM 9903-WRITE-CICS-LOG                          11420000
114300             PERFORM 9000-SOFT-ABORT                              11430000
114400             PERFORM 8210-XCTL-ERROR-SCREEN                       11440000
114500         WHEN SQLWARN0 NOT = SPACES                               11450000
114600         WHEN SQLCODE NOT EQUAL ZERO                              11460000
114700             MOVE DL010-KEYED-USERID  TO PV-LOG-USER-ID           11470000
114800             MOVE SQLCODE             TO PV-SQLCODE               11480000
114900             MOVE 6                   TO PV-ERROR-NBR             11490000
115000                                         DL010-ERROR-NBR          11500000
115100             PERFORM 9903-WRITE-CICS-LOG                          11510000
115200             MOVE DL010-ASGMT-STRT-DTE    TO PV-STRT-DTE          11520000
115300             MOVE DL010-ASGMT-NBR-TXT     TO PV-NBR-TXT           11530000
115400             MOVE DL010-ASGMT-NBR-SEQ-NBR TO PV-NBR-SEQ-NBR       11540000
115500             PERFORM 9904-WRITE-CICS-LOG                          11550000
115600             MOVE '7000-COUNT-UP-TEAM'                            11560000
115700                                      TO DL010-PARAGRAPH          11570000
115800             MOVE 'DLKRF450 - OPEN NAME CURSOR'                   11580000
115900                                      TO DL010-MESSAGE-TEXT(1)    11590000
116000             MOVE SQLCA               TO DL010-SQLCA              11600000
116100             MOVE 'DLT_TEM_ASGMT'     TO DL010-DB2-TABLE-NAME(1)  11610000
116200             SET DL010-ABEND          TO TRUE                     11620000
116300             MOVE 3                   TO DL010-PGM-MSG-NBR        11630000
116400             PERFORM 8210-XCTL-ERROR-SCREEN                       11640000
116500                                                                  11650000
116600     END-EVALUATE.                                                11660000
116601                                                                  11660107
116602******************************************************************11660214
116603* CHECK THAT ADDING OF ASSOCIATE IS CHANGING ASSIGNMENT FROM AN   11660314
116604* INDIVIDUAL ASSIGNMENT TO A TEAM ASSIGNMENT. IF YES, SET SWITCH  11660414
116605* TO CREATE A SECOND ASSIGNMENT ADD EVENT FOR THE INDIVIDUAL      11660514
116606* THAT CREATED THE ASSIGNMENT.                                    11660614
116607******************************************************************11660714
116610 4200-SEL-TEAM-ASGMT-USERS.                                       11661007
116620                                                                  11662007
116630     SET  PS-CREATE-MAN-ADD-NO  TO TRUE                           11663007
116640                                                                  11664007
116650     EXEC SQL                                                     11665007
116660         SELECT                                                   11666007
116670                B.KOHLS_USR_ID                                    11667007
116680          INTO                                                    11668007
116690                :PV-USERID-MAN-ADD                                11669007
116691          FROM  DLT_ASGMT A                                       11669107
116692              , DLT_TEM_ASGMT B                                   11669207
116693         WHERE  A.ASGMT_STRT_DTE    = B.ASGMT_STRT_DTE            11669307
116694           AND  A.ASGMT_NBR_SEQ_NBR = B.ASGMT_NBR_SEQ_NBR         11669407
116695           AND  A.ASGMT_NBR_TXT     = B.ASGMT_NBR_TXT             11669507
116696           AND  A.ASGMT_STRT_DTE    = :DL010-ASGMT-STRT-DTE       11669607
116697           AND  A.ASGMT_NBR_SEQ_NBR = :DL010-ASGMT-NBR-SEQ-NBR    11669707
116698           AND  A.ASGMT_NBR_TXT     = :DL010-ASGMT-NBR-TXT        11669807
116700           AND (B.KOHLS_USR_ID     <> :DL010-KEYED-USERID OR      11670014
116701                B.TMP_USR_ID       <> :DL010-KEYED-USERID )       11670114
116702           AND  B.LVE_TMST         IS NULL                        11670207
116703           AND  B.LVE_RSN_CDE       = 'N'                         11670307
116704     END-EXEC                                                     11670407
116705                                                                  11670507
116706                                                                  11670607
116707     EVALUATE TRUE                                                11670707
116708         WHEN SQLCODE = ZERO                                      11670807
116709              SET PS-CREATE-MAN-ADD-YES TO TRUE                   11670907
116710         WHEN SQLCODE = +100                                      11671007
116712         WHEN SQLCODE = -811                                      11671209
116713              SET PS-CREATE-MAN-ADD-NO TO TRUE                    11671307
116714         WHEN SQLCODE = -305                                      11671415
116715              PERFORM 4210-SEL-TEAM-ASGMT-TEMP                    11671515
116716         WHEN SQLCODE = -904                                      11671615
116720         WHEN SQLCODE = -913                                      11672007
116730         WHEN SQLCODE = -911                                      11673007
116740             MOVE DL010-KEYED-USERID  TO PV-LOG-USER-ID           11674010
116750             MOVE SQLCODE             TO PV-SQLCODE               11675007
116751             MOVE 4200                TO PV-ERROR-NBR             11675107
116752                                         DL010-ERROR-NBR          11675207
116753             PERFORM 9903-WRITE-CICS-LOG                          11675307
116754             PERFORM 9000-SOFT-ABORT                              11675407
116755             PERFORM 8210-XCTL-ERROR-SCREEN                       11675507
116756         WHEN SQLWARN0 NOT = SPACES                               11675607
116757         WHEN SQLCODE NOT EQUAL ZERO                              11675707
116758             MOVE 4200                TO PV-ERROR-NBR             11675807
116759                                         DL010-ERROR-NBR          11675907
116760             PERFORM 9903-WRITE-CICS-LOG                          11676007
116761             MOVE '4200-SEL-TEAM-ASGMT-USERS'                     11676107
116762                                      TO DL010-PARAGRAPH          11676207
116763             MOVE 'DLKRF450 - SELEC TEAM USERS'                   11676307
116764                                      TO DL010-MESSAGE-TEXT(1)    11676407
116765             MOVE SQLCA               TO DL010-SQLCA              11676507
116766             MOVE 'DLT_TEM_ASGMT'     TO DL010-DB2-TABLE-NAME(1)  11676607
116767             SET DL010-ABEND          TO TRUE                     11676707
116768             MOVE 3                   TO DL010-PGM-MSG-NBR        11676807
116769             PERFORM 8210-XCTL-ERROR-SCREEN                       11676907
116770                                                                  11677007
116771     END-EVALUATE.                                                11677107
116772                                                                  11677214
116773 4210-SEL-TEAM-ASGMT-TEMP.                                        11677315
116780                                                                  11678015
116781     SET  PS-CREATE-MAN-ADD-NO  TO TRUE                           11678115
116782                                                                  11678215
116783     EXEC SQL                                                     11678315
116784         SELECT                                                   11678415
116785                B.TMP_USR_ID                                      11678515
116786          INTO                                                    11678615
116790                :PV-USERID-MAN-ADD                                11679015
116800          FROM  DLT_ASGMT A                                       11680015
116810              , DLT_TEM_ASGMT B                                   11681015
116820         WHERE  A.ASGMT_STRT_DTE    = B.ASGMT_STRT_DTE            11682015
116830           AND  A.ASGMT_NBR_SEQ_NBR = B.ASGMT_NBR_SEQ_NBR         11683015
116840           AND  A.ASGMT_NBR_TXT     = B.ASGMT_NBR_TXT             11684015
116841           AND  A.ASGMT_STRT_DTE    = :DL010-ASGMT-STRT-DTE       11684115
116842           AND  A.ASGMT_NBR_SEQ_NBR = :DL010-ASGMT-NBR-SEQ-NBR    11684215
116843           AND  A.ASGMT_NBR_TXT     = :DL010-ASGMT-NBR-TXT        11684315
116844           AND (B.KOHLS_USR_ID     <> :DL010-KEYED-USERID OR      11684415
116845                B.TMP_USR_ID       <> :DL010-KEYED-USERID )       11684515
116846           AND  B.LVE_TMST         IS NULL                        11684615
116847           AND  B.LVE_RSN_CDE       = 'N'                         11684715
116848     END-EXEC                                                     11684815
116849                                                                  11684915
116850                                                                  11685015
116851     EVALUATE TRUE                                                11685115
116852         WHEN SQLCODE = ZERO                                      11685215
116853              SET PS-CREATE-MAN-ADD-YES TO TRUE                   11685315
116854         WHEN SQLCODE = +100                                      11685415
116855         WHEN SQLCODE = -811                                      11685515
116856         WHEN SQLCODE = -305                                      11685616
116857              SET PS-CREATE-MAN-ADD-NO TO TRUE                    11685716
116858         WHEN SQLCODE = -904                                      11685816
116859         WHEN SQLCODE = -913                                      11685916
116860         WHEN SQLCODE = -911                                      11686016
116861             MOVE DL010-KEYED-USERID  TO PV-LOG-USER-ID           11686116
116862             MOVE SQLCODE             TO PV-SQLCODE               11686216
116863             MOVE 4210                TO PV-ERROR-NBR             11686316
116864                                         DL010-ERROR-NBR          11686416
116865             PERFORM 9903-WRITE-CICS-LOG                          11686516
116866             PERFORM 9000-SOFT-ABORT                              11686616
116867             PERFORM 8210-XCTL-ERROR-SCREEN                       11686716
116868         WHEN SQLWARN0 NOT = SPACES                               11686816
116869         WHEN SQLCODE NOT EQUAL ZERO                              11686916
116870             MOVE 4200                TO PV-ERROR-NBR             11687016
116871                                         DL010-ERROR-NBR          11687116
116872             PERFORM 9903-WRITE-CICS-LOG                          11687216
116873             MOVE '4210-SEL-TEAM-ASGMT-TEMP '                     11687316
116874                                      TO DL010-PARAGRAPH          11687416
116875             MOVE 'DLKRF450 - SELEC TEAM USERS'                   11687516
116876                                      TO DL010-MESSAGE-TEXT(1)    11687616
116877             MOVE SQLCA               TO DL010-SQLCA              11687716
116878             MOVE 'DLT_TEM_ASGMT'     TO DL010-DB2-TABLE-NAME(1)  11687816
116879             SET DL010-ABEND          TO TRUE                     11687916
116880             MOVE 3                   TO DL010-PGM-MSG-NBR        11688016
116881             PERFORM 8210-XCTL-ERROR-SCREEN                       11688116
116882                                                                  11688216
116883     END-EVALUATE.                                                11688316
116884                                                                  11688416
116890 7050-DUMMY-USERID.                                               11689015
116896                                                                  11689628
116900     EXEC SQL                                                     11690000
117000         SELECT FUNC_TXT                                          11700000
117100         INTO :PV-DUMMY-USERID                                    11710000
117200         FROM                                                     11720000
117300             TKRPRPM                                              11730000
117400         WHERE                                                    11740000
117500             FUNC_TXT           = :DL010-KEYED-USERID             11750000
117600             AND                                                  11760000
117700             INTFC_SYS_CDE      = 'DLX'                           11770000
117800             AND                                                  11780000
117900             SYS_PRC_FUNC_CDE   = 'DLPLDU'                        11790000
118000             AND                                                  11800000
118100             FUNC_PRC_STAT_CDE  = 'AC'                            11810000
118200             AND                                                  11820000
118300             CURRENT TIMESTAMP BETWEEN                            11830000
118400             FUNC_BEG_TMST AND FUNC_END_TMST                      11840000
118500     END-EXEC.                                                    11850000
118600                                                                  11860000
118700     EVALUATE TRUE                                                11870000
118800         WHEN SQLCODE = ZERO                                      11880000
118900             CONTINUE                                             11890000
119000         WHEN SQLCODE = +100                                      11900000
119100             MOVE SPACES              TO PV-DUMMY-USERID          11910000
119200         WHEN SQLCODE = -904                                      11920000
119300         WHEN SQLCODE = -913                                      11930000
119400         WHEN SQLCODE = -911                                      11940000
119500             MOVE DL010-KEYED-USERID  TO PV-LOG-USER-ID           11950000
119600             MOVE SQLCODE             TO PV-SQLCODE               11960000
119700             MOVE 7                   TO PV-ERROR-NBR             11970000
119800                                         DL010-ERROR-NBR          11980000
119900             PERFORM 9903-WRITE-CICS-LOG                          11990000
120000             PERFORM 9000-SOFT-ABORT                              12000000
120100             PERFORM 8210-XCTL-ERROR-SCREEN                       12010000
120200         WHEN SQLWARN0 NOT = SPACES                               12020000
120300         WHEN SQLCODE NOT EQUAL ZERO                              12030000
120400             MOVE 8                   TO PV-ERROR-NBR             12040000
120500                                         DL010-ERROR-NBR          12050000
120600             PERFORM 9903-WRITE-CICS-LOG                          12060000
120700             MOVE '7050-DUMMY-USERID'                             12070000
120800                                      TO DL010-PARAGRAPH          12080000
120900             MOVE 'DLKRF450 - OPEN NAME CURSOR'                   12090000
121000                                      TO DL010-MESSAGE-TEXT(1)    12100000
121100             MOVE SQLCA               TO DL010-SQLCA              12110000
121200             MOVE 'DLT_TEM_ASGMT'     TO DL010-DB2-TABLE-NAME(1)  12120000
121300             SET DL010-ABEND          TO TRUE                     12130000
121400             MOVE 3                   TO DL010-PGM-MSG-NBR        12140000
121500             PERFORM 8210-XCTL-ERROR-SCREEN                       12150000
121600                                                                  12160000
121700     END-EVALUATE.                                                12170000
121800                                                                  12180000
121900/                                                                 12190000
122000 7100-SELECT-RDPR-USR.                                            12200000
122100                                                                  12210000
122200*    IF THE USER HAS NEVER BEEN A PART OF AN ASSIGNMENT,HE IS NEW 12220000
122300                                                                  12230000
122400     EXEC SQL                                                     12240000
122500     SELECT 'N'                                                   12250000
122600     INTO :PS-CREATE-NEW-USER-SW                                  12260000
122700     FROM                                                         12270000
122800         DLT_RDPR_USR_LSTG                                        12280000
122900     WHERE                                                        12290000
123000             USR_ID       = :DL010-KEYED-USERID                   12300000
123100         AND LOC_NBR      = :DL010-OPER-UNT-ID                    12310000
123200         FETCH FIRST 1 ROW ONLY                                   12320000
123300     END-EXEC.                                                    12330000
123400                                                                  12340000
123500     EVALUATE TRUE                                                12350000
123600         WHEN SQLCODE = ZERO                                      12360000
123700         WHEN SQLCODE = +100                                      12370000
123800             CONTINUE                                             12380000
123900         WHEN SQLCODE = -904                                      12390000
124000         WHEN SQLCODE = -913                                      12400000
124100         WHEN SQLCODE = -911                                      12410000
124200             MOVE DL010-KEYED-USERID  TO PV-LOG-USER-ID           12420000
124300             MOVE SQLCODE             TO PV-SQLCODE               12430000
124400             MOVE 9                   TO PV-ERROR-NBR             12440000
124500                                         DL010-ERROR-NBR          12450000
124600             PERFORM 9903-WRITE-CICS-LOG                          12460000
124700             PERFORM 9000-SOFT-ABORT                              12470000
124800             PERFORM 8210-XCTL-ERROR-SCREEN                       12480000
124900         WHEN SQLWARN0 NOT = SPACES                               12490000
125000         WHEN SQLCODE NOT EQUAL ZERO                              12500000
125100             MOVE 10                  TO PV-ERROR-NBR             12510000
125200                                         DL010-ERROR-NBR          12520000
125300             PERFORM 9903-WRITE-CICS-LOG                          12530000
125400             MOVE '7100-SELECT-RDPR-USR '                         12540000
125500                                      TO DL010-PARAGRAPH          12550000
125600             MOVE 'DLKRF450 - DETERMINE NEW USER'                 12560000
125700                                      TO DL010-MESSAGE-TEXT(1)    12570000
125800             MOVE SQLCA               TO DL010-SQLCA              12580000
125900             MOVE 'DLT_RDPR_USR '     TO DL010-DB2-TABLE-NAME(1)  12590000
126000             SET DL010-ABEND          TO TRUE                     12600000
126100             MOVE 3                   TO DL010-PGM-MSG-NBR        12610000
126200             PERFORM 8210-XCTL-ERROR-SCREEN                       12620000
126300                                                                  12630000
126400     END-EVALUATE.                                                12640000
126500/                                                                 12650000
126600 8000-SEND-MAP.                                                   12660000
126700                                                                  12670000
126800     EXEC CICS                                                    12680000
126900         SEND MAP       ('DL450A')                                12690000
127000              MAPSET    ('DLKM450')                               12700000
127100              ERASE                                               12710000
127200              RESP      (PV-CICS-RESPONSE)                        12720000
127300     END-EXEC.                                                    12730000
127400                                                                  12740000
127500     EVALUATE TRUE                                                12750000
127600         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 12760000
127700             CONTINUE                                             12770000
127800         WHEN OTHER                                               12780000
127900             MOVE '8000-SEND-MAP'     TO DP013-PARAGRAPH          12790000
128000             MOVE 'DLKRF450 - UNABLE TO SEND MAP'                 12800000
128100                                      TO DP013-MESSAGE-TEXT (1)   12810000
128200             SET DP013-CICS-ABEND                                 12820000
128300                 DP013-ROLLBACK       TO TRUE                     12830000
128400             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               12840000
128500     END-EVALUATE.                                                12850000
128600                                                                  12860000
128700 8010-SEND-DATA-ONLY.                                             12870000
128800                                                                  12880000
128900     EXEC CICS                                                    12890000
129000         SEND MAP       ('DL450A')                                12900000
129100              MAPSET    ('DLKM450')                               12910000
129200              CURSOR                                              12920000
129300              DATAONLY                                            12930000
129400              RESP      (PV-CICS-RESPONSE)                        12940000
129500     END-EXEC.                                                    12950000
129600                                                                  12960000
129700     EVALUATE TRUE                                                12970000
129800         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 12980000
129900             CONTINUE                                             12990000
130000         WHEN OTHER                                               13000000
130100             MOVE '8010-SEND-DATA-ONLY'                           13010000
130200                                      TO DP013-PARAGRAPH          13020000
130300             MOVE 'DLKRF450 - UNABLE TO SEND DATA'                13030000
130400                                      TO DP013-MESSAGE-TEXT (1)   13040000
130500             SET DP013-CICS-ABEND                                 13050000
130600                 DP013-ROLLBACK       TO TRUE                     13060000
130700             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               13070000
130800     END-EVALUATE.                                                13080000
130900                                                                  13090000
131000 8020-RECEIVE-MAP.                                                13100000
131100                                                                  13110000
131200     EXEC CICS                                                    13120000
131300         RECEIVE MAP    ('DL450A')                                13130000
131400                 MAPSET ('DLKM450')                               13140000
131500                 RESP   (PV-CICS-RESPONSE)                        13150000
131600     END-EXEC.                                                    13160000
131700                                                                  13170000
131800     EVALUATE TRUE                                                13180000
131900         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 13190000
132000             CONTINUE                                             13200000
132100         WHEN PV-CICS-RESPONSE = DFHRESP (MAPFAIL)                13210000
132200             CONTINUE                                             13220000
132300         WHEN OTHER                                               13230000
132400            MOVE '8020-RECEIVE-MAP'      TO DP013-PARAGRAPH       13240000
132500            MOVE 'DLKRF450 - UNABLE TO RECEIVE MAP'               13250000
132600                                         TO DP013-MESSAGE-TEXT (1)13260000
132700            SET DP013-LOGIC-ABEND        TO TRUE                  13270000
132800            SET DP013-ROLLBACK           TO TRUE                  13280000
132900            PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG                13290000
133000     END-EVALUATE.                                                13300000
133100                                                                  13310000
133200 8100-RETURN-TRANID.                                              13320000
133300                                                                  13330000
133400     MOVE LENGTH OF DL010-COMMAREA    TO PV-COMMAREA-LENGTH       13340000
133500     EXEC CICS                                                    13350000
133600         RETURN TRANSID  (PC-TRANID)                              13360000
133700                COMMAREA (DL010-COMMAREA)                         13370000
133800                LENGTH   (PV-COMMAREA-LENGTH)                     13380000
133900                RESP     (PV-CICS-RESPONSE)                       13390000
134000     END-EXEC.                                                    13400000
134100                                                                  13410000
134200     EVALUATE TRUE                                                13420000
134300         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 13430000
134400             CONTINUE                                             13440000
134500         WHEN OTHER                                               13450000
134600             MOVE '8100-RETURN-TRANIND' TO DP013-PARAGRAPH        13460000
134700             MOVE 'DLKRF450 - UNABLE TO RETURN TO TRANID'         13470000
134800                 TO DP013-MESSAGE-TEXT (1)                        13480000
134900             SET DP013-CICS-ABEND       TO TRUE                   13490000
135000             SET DP013-ROLLBACK         TO TRUE                   13500000
135100             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               13510000
135200     END-EVALUATE.                                                13520000
135300                                                                  13530000
135400 8110-RETURN.                                                     13540000
135500                                                                  13550000
135600     EXEC CICS                                                    13560000
135700         SEND FROM (PV-MESSAGE-AREA)                              13570000
135800              LENGTH (19)                                         13580000
135900              ERASE                                               13590000
136000     END-EXEC.                                                    13600000
136100                                                                  13610000
136200     EXEC CICS                                                    13620000
136300         RETURN                                                   13630000
136400     END-EXEC.                                                    13640000
136500                                                                  13650000
136600 8200-XCTL.                                                       13660000
136700     SET DL010-INITIALIZE-SCREEN      TO TRUE.                    13670000
136800     MOVE PC-CURRENT-PROGRAM-NAME     TO DL010-LAST-PROGRAM       13680000
136900*                                        DL010-MENU-PROGRAM       13690000
137000     MOVE LENGTH OF DL010-COMMAREA    TO PV-COMMAREA-LENGTH       13700000
137100                                                                  13710000
137200     EXEC CICS                                                    13720000
137300         XCTL  PROGRAM   (PV-TRANSFER-PROGRAM)                    13730000
137400               COMMAREA  (DL010-COMMAREA)                         13740000
137500               LENGTH    (PV-COMMAREA-LENGTH)                     13750000
137600               RESP      (PV-CICS-RESPONSE)                       13760000
137700     END-EXEC.                                                    13770000
137800                                                                  13780000
137900     EVALUATE TRUE                                                13790000
138000         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 13800000
138100             CONTINUE                                             13810000
138200         WHEN OTHER                                               13820000
138300             MOVE '8200-XCTL'         TO DP013-PARAGRAPH          13830000
138400             MOVE 'DLKRF450 - UNABLE TO XCTL TO PROGRAM: '        13840000
138500                                      TO DP013-MESSAGE-TEXT (1)   13850000
138600             MOVE PV-TRANSFER-PROGRAM TO DP013-MESSAGE-TEXT (2)   13860000
138700             SET DP013-CICS-ABEND                                 13870000
138800                 DP013-ROLLBACK       TO TRUE                     13880000
138900             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               13890000
139000             MOVE PC-TRANS-UNAVAILABLE-MSG                        13900000
139100                                      TO ALINE8O                  13910000
139200             SET DL010-PROCESS-SCREEN TO TRUE                     13920000
139300             MOVE -1                  TO AUSERL                   13930000
139400*            MOVE DL010-MENU-PROGRAM  TO DL010-LAST-PROGRAM       13940000
139500             PERFORM 8000-SEND-MAP                                13950000
139600             PERFORM 8100-RETURN-TRANID                           13960000
139700     END-EVALUATE.                                                13970000
139800                                                                  13980000
139900 8210-XCTL-ERROR-SCREEN.                                          13990000
140000                                                                  14000000
140100     IF NOT DL010-ABEND                                           14010000
140200         SET DL010-INITIALIZE-SCREEN  TO TRUE                     14020000
140300     END-IF                                                       14030000
140400     MOVE DFHEIBLK                    TO DL010-DFHEIBLK.          14040000
140500     MOVE PC-CURRENT-PROGRAM-NAME     TO DL010-LAST-PROGRAM.      14050000
140600     MOVE LENGTH OF DL010-COMMAREA    TO PV-COMMAREA-LENGTH       14060000
140700     MOVE 'DLKRF456'                  TO PV-TRANSFER-PROGRAM      14070000
140800     IF DL010-PGM-MSG-NBR = ZERO                                  14080000
140900*        UNDEFINED ERROR                                          14090000
141000         MOVE 1                       TO DL010-PGM-MSG-NBR        14100000
141100     END-IF                                                       14110000
141200*                                                                 14120000
141300     EXEC CICS                                                    14130000
141400         XCTL  PROGRAM   (PV-TRANSFER-PROGRAM)                    14140000
141500               COMMAREA  (DL010-COMMAREA)                         14150000
141600               LENGTH    (PV-COMMAREA-LENGTH)                     14160000
141700               RESP      (PV-CICS-RESPONSE)                       14170000
141800     END-EXEC.                                                    14180000
141900                                                                  14190000
142000     EVALUATE TRUE                                                14200000
142100         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 14210000
142200             CONTINUE                                             14220000
142300         WHEN OTHER                                               14230000
142400             MOVE '8200-XCTL'                                     14240000
142500                                      TO DP013-PARAGRAPH          14250000
142600             MOVE 'DLKRF451 - UNABLE TO XCTL TO PROGRAM: '        14260000
142700                                      TO DP013-MESSAGE-TEXT (1)   14270000
142800             MOVE PV-TRANSFER-PROGRAM TO DP013-MESSAGE-TEXT (2)   14280000
142900             SET DP013-CICS-ABEND                                 14290000
143000                 DP013-ROLLBACK       TO TRUE                     14300000
143100             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               14310000
143200             MOVE PC-TRANS-UNAVAILABLE-MSG                        14320000
143300                                      TO ALINE8O                  14330000
143400             SET DL010-PROCESS-SCREEN TO TRUE                     14340000
143500             PERFORM 8000-SEND-MAP                                14350000
143600             PERFORM 8100-RETURN-TRANID                           14360000
143700     END-EVALUATE.                                                14370000
143800/                                                                 14380000
143900*                                                                 14390000
144000 8220-XCTL-TO-HELP.                                               14400000
144100                                                                  14410000
144200     MOVE LENGTH OF PC192-COMMAREA    TO PV-COMMAREA-LENGTH       14420000
144300                                                                  14430000
144400     EXEC CICS                                                    14440000
144500         XCTL                                                     14450000
144600             PROGRAM   (PV-TRANSFER-PROGRAM)                      14460000
144700             COMMAREA  (PC192-COMMAREA)                           14470000
144800             LENGTH    (PV-COMMAREA-LENGTH)                       14480000
144900             RESP      (PV-CICS-RESPONSE)                         14490000
145000     END-EXEC.                                                    14500000
145100                                                                  14510000
145200     EVALUATE TRUE                                                14520000
145300         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 14530000
145400              CONTINUE                                            14540000
145500         WHEN OTHER                                               14550000
145600             MOVE '8220-XCTL-TO-HELP' TO DP013-PARAGRAPH          14560000
145700             MOVE 'DLKRF450 - UNABLE TO XCTL TO PROGRAM: '        14570000
145800                                      TO DP013-MESSAGE-TEXT (1)   14580000
145900             MOVE PV-TRANSFER-PROGRAM TO DP013-MESSAGE-TEXT (2)   14590000
146000             SET DP013-CICS-ABEND                                 14600000
146100                 DP013-ROLLBACK       TO TRUE                     14610000
146200             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               14620000
146300             MOVE PC-TRANS-UNAVAILABLE-MSG                        14630000
146400                                      TO ALINE8O                  14640000
146500             SET DL010-PROCESS-SCREEN TO TRUE                     14650000
146600             MOVE -1                  TO AUSERL                   14660000
146700             PERFORM 8000-SEND-MAP                                14670000
146800             PERFORM 8100-RETURN-TRANID                           14680000
146900     END-EVALUATE.                                                14690000
147000/                                                                 14700000
147100 8600-CALL-XLKUT067.                                              14710000
147200                                                                  14720000
147300     INITIALIZE XL067-USER-COMMAREA                               14730000
147400     SET XL067-BY-USER-ID                                         14740000
147500         XL067-SELECT-BOTH-USERS      TO TRUE                     14750000
147600                                                                  14760000
147700     MOVE DL010-KEYED-USERID          TO XL067-KEY-USER-ID        14770000
147800     MOVE 'DLKRF450'                  TO XL067-ORIG-CALLING-PGM-NM14780000
147900                                                                  14790000
148000     CALL XL067-USER-PGM USING DFHEIBLK                           14800000
148100                               XL067-COMMAREA                     14810000
148200                               XL067-USER-COMMAREA                14820000
148300                                                                  14830000
148400     EVALUATE TRUE                                                14840000
148500         WHEN XL067-SUCCESSFUL                                    14850000
148600             CONTINUE                                             14860000
148700         WHEN XL067-SQL-ERROR                                     14870000
148800         WHEN XL067-INVALID-ACCESS                                14880000
148900             MOVE '8600-CALL-XLKUT067' TO DP013-PARAGRAPH         14890000
149000             MOVE 'DLKRF450 - DB2 ERROR IN PROGRAM: '             14900000
149100                                      TO DP013-MESSAGE-TEXT (1)   14910000
149200             MOVE 'XLKUT067'          TO DP013-MESSAGE-TEXT (2)   14920000
149300             SET DP013-CICS-ABEND                                 14930000
149400                 DP013-ROLLBACK       TO TRUE                     14940000
149500             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               14950000
149600             MOVE PC-TRANS-UNAVAILABLE-MSG                        14960000
149700                                      TO ALINE8O                  14970000
149800             SET DL010-PROCESS-SCREEN TO TRUE                     14980000
149900             MOVE -1                  TO AUSERL                   14990000
150000             PERFORM 8000-SEND-MAP                                15000000
150100             PERFORM 8100-RETURN-TRANID                           15010000
150200         WHEN OTHER                                               15020000
150300             MOVE '8600-CALL-XLKUT067' TO DP013-PARAGRAPH         15030000
150400             MOVE 'DLKRF450 - UNDETERMINED ERROR IN PGM: '        15040000
150500                                      TO DP013-MESSAGE-TEXT (1)   15050000
150600             MOVE 'XLKUT067'          TO DP013-MESSAGE-TEXT (2)   15060000
150700             SET DP013-CICS-ABEND                                 15070000
150800                 DP013-ROLLBACK       TO TRUE                     15080000
150900             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               15090000
151000             MOVE PC-TRANS-UNAVAILABLE-MSG                        15100000
151100                                      TO ALINE8O                  15110000
151200             SET DL010-PROCESS-SCREEN TO TRUE                     15120000
151300             MOVE -1                  TO AUSERL                   15130000
151400             PERFORM 8000-SEND-MAP                                15140000
151500             PERFORM 8100-RETURN-TRANID                           15150000
151600     END-EVALUATE.                                                15160000
151700/                                                                 15170000
151800 8610-CALL-DLKUT001.                                              15180000
151860                                                                  15186028
151900     MOVE 'DLKRF450'                  TO DL003-ORIG-CALLING-PGM-NM15190000
152000                                                                  15200000
152100     CALL DL003-USER-PGM USING DFHEIBLK                           15210000
152200                               DL003-COMMAREA                     15220000
152300                               DL003-ASGMT-COMMAREA               15230000
152400                                                                  15240000
152500     EVALUATE TRUE                                                15250000
152600         WHEN DL003-SUCCESSFUL                                    15260000
152700             CONTINUE                                             15270000
152800         WHEN DL003-SQL-ERROR                                     15280000
152900         WHEN DL003-INVALID-ACCESS                                15290000
153000             MOVE '8610-CALL-DLKUT001' TO DP013-PARAGRAPH         15300000
153100             MOVE 'DLKRF450 - DB2 ERROR IN PROGRAM: '             15310000
153200                                      TO DP013-MESSAGE-TEXT (1)   15320000
153300             MOVE 'DLKUT001'          TO DP013-MESSAGE-TEXT (2)   15330000
153400             SET DP013-CICS-ABEND                                 15340000
153500                 DP013-ROLLBACK       TO TRUE                     15350000
153600             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               15360000
153700             MOVE PC-TRANS-UNAVAILABLE-MSG                        15370000
153800                                      TO ALINE8O                  15380000
153900             SET DL010-PROCESS-SCREEN TO TRUE                     15390000
154000             MOVE -1                  TO AUSERL                   15400000
154100             PERFORM 8000-SEND-MAP                                15410000
154200             PERFORM 8100-RETURN-TRANID                           15420000
154300         WHEN OTHER                                               15430000
154400             MOVE '8610-CALL-DLKUT001' TO DP013-PARAGRAPH         15440000
154500             MOVE 'DLKRF450 - UNDETERMINED ERROR IN PGM: '        15450000
154600                                      TO DP013-MESSAGE-TEXT (1)   15460000
154700             MOVE 'DLKUT001'          TO DP013-MESSAGE-TEXT (2)   15470000
154800             SET DP013-CICS-ABEND                                 15480000
154900                 DP013-ROLLBACK       TO TRUE                     15490000
155000             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               15500000
155100             MOVE PC-TRANS-UNAVAILABLE-MSG                        15510000
155200                                      TO ALINE8O                  15520000
155300             SET DL010-PROCESS-SCREEN TO TRUE                     15530000
155400             MOVE -1                  TO AUSERL                   15540000
155500             PERFORM 8000-SEND-MAP                                15550000
155600             PERFORM 8100-RETURN-TRANID                           15560000
155700     END-EVALUATE.                                                15570000
155800                                                                  15580000
155900 8620-CALL-DLKUP002.                                              15590000
156000                                                                  15600031
156120     CALL DL005-USER-PGM USING DFHEIBLK                           15612000
156200                               DL005-COMMAREA                     15620000
156300                               DL005-ASGMT-COMMAREA               15630000
156420                                                                  15642000
156500     EVALUATE TRUE                                                15650000
156600         WHEN DL005-SUCCESSFUL                                    15660000
156700             MOVE 'F5-ADD  F6-TEAM LST'                           15670000
156800                                      TO ALINE7O                  15680000
156900             MOVE '  ASSOCIATE ADDED ' TO ALINE8O                 15690000
157000         WHEN DL005-SQL-ERROR                                     15700000
157100             CONTINUE                                             15710000
157200         WHEN DL005-ASGMT-NOT-ACTIVE                              15720000
157300             CONTINUE                                             15730000
157400         WHEN DL005-INVALID-ACCESS                                15740000
157500             MOVE '8610-CALL-DLKUT001' TO DP013-PARAGRAPH         15750000
157600             MOVE 'DLKRF450 - DB2 ERROR IN PROGRAM: '             15760000
157700                                      TO DP013-MESSAGE-TEXT (1)   15770000
157800             MOVE 'DLKUP002'          TO DP013-MESSAGE-TEXT (2)   15780000
157900             SET DP013-CICS-ABEND                                 15790000
158000                 DP013-ROLLBACK       TO TRUE                     15800000
158100             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               15810000
158200             MOVE PC-TRANS-UNAVAILABLE-MSG                        15820000
158300                                      TO ALINE8O                  15830000
158400             SET DL010-PROCESS-SCREEN TO TRUE                     15840000
158500             MOVE -1                  TO AUSERL                   15850000
158600             PERFORM 8000-SEND-MAP                                15860000
158700             PERFORM 8100-RETURN-TRANID                           15870000
158800         WHEN OTHER                                               15880000
158900             MOVE '8620-CALL-DLKUP002' TO DP013-PARAGRAPH         15890000
159000             MOVE 'DLKRF450 - UNDETERMINED ERROR IN PGM: '        15900000
159100                                      TO DP013-MESSAGE-TEXT (1)   15910000
159200             MOVE 'DLKUP002'          TO DP013-MESSAGE-TEXT (2)   15920000
159300             SET DP013-CICS-ABEND                                 15930000
159400                 DP013-ROLLBACK       TO TRUE                     15940000
159500             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               15950000
159600             MOVE PC-TRANS-UNAVAILABLE-MSG                        15960000
159700                                      TO ALINE8O                  15970000
159800             SET DL010-PROCESS-SCREEN TO TRUE                     15980000
159900             MOVE -1                  TO AUSERL                   15990000
160000             PERFORM 8000-SEND-MAP                                16000000
160100             PERFORM 8100-RETURN-TRANID                           16010000
160200     END-EVALUATE.                                                16020000
160300/                                                                 16030000
160400*-----------------------------------------------------------------16040000
160500*  CALL XLKUP033 TO LOG AN INDIRECT SYSTEM MOVE TO THE EAI       *16050000
160600*  BUSINESS EVENT TABLES.                                        *16060000
160700*-----------------------------------------------------------------16070000
160800 8630-CALL-XLKUP033.                                              16080000
160900                                                                  16090000
161000     CALL XL072-USER-PGM USING DFHEIBLK                           16100000
161100                              XL072-COMMAREA                      16110000
161200                              XL072-EAI-EXPORT-COMMAREA.          16120000
161300                                                                  16130000
161400     EVALUATE TRUE                                                16140000
161500         WHEN XL072-SUCCESSFUL                                    16150000
161600             CONTINUE                                             16160000
161700         WHEN OTHER                                               16170000
161800             MOVE '8630-CALL-DLKUP033' TO DP013-PARAGRAPH         16180000
161900             MOVE 'DLKRF450 - UNDETERMINED ERROR IN PGM: '        16190000
162000                                      TO DP013-MESSAGE-TEXT (1)   16200000
162100             MOVE 'DLKUP033'          TO DP013-MESSAGE-TEXT (2)   16210000
162200             SET DP013-CICS-ABEND                                 16220000
162300                 DP013-ROLLBACK       TO TRUE                     16230000
162400             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               16240000
162500             MOVE PC-TRANS-UNAVAILABLE-MSG                        16250000
162600                                      TO ALINE8O                  16260000
162700             SET DL010-PROCESS-SCREEN TO TRUE                     16270000
162800             MOVE -1                  TO AUSERL                   16280000
162900             PERFORM 8000-SEND-MAP                                16290000
163000             PERFORM 8100-RETURN-TRANID                           16300000
163100     END-EVALUATE.                                                16310000
163200/                                                                 16320000
163300 9000-SOFT-ABORT.                                                 16330000
163400                                                                  16340000
163500     EXEC CICS                                                    16350000
163600         SYNCPOINT ROLLBACK                                       16360000
163700     END-EXEC.                                                    16370000
163800                                                                  16380000
163900*    MOVE 4                           TO PC033-PGM-MSG-NBR        16390000
164000*    MOVE SQLCODE                     TO PC033-SQLCODE            16400000
164100*    PERFORM 8210-XCTL-ERROR-SCREEN.                              16410000
164200                                                                  16420000
164300                                                                  16430000
164400 9903-WRITE-CICS-LOG.                                             16440000
164500                                                                  16450000
164600                                                                  16460000
164700     EXEC CICS                                                    16470000
164800         WRITEQ TD                                                16480000
164900             QUEUE  ('CSSL')                                      16490000
165000             FROM   (PV-LOG-MSG)                                  16500000
165100             RESP   (PV-CICS-RESPONSE)                            16510000
165200     END-EXEC.                                                    16520000
165300                                                                  16530000
165400 9904-WRITE-CICS-LOG.                                             16540000
165500                                                                  16550000
165600                                                                  16560000
165700     EXEC CICS                                                    16570000
165800         WRITEQ TD                                                16580000
165900             QUEUE  ('CSSL')                                      16590000
166000             FROM   (PV-LOG-MSG-2)                                16600000
166100             RESP   (PV-CICS-RESPONSE)                            16610000
166200     END-EXEC.                                                    16620000
166300                                                                  16630000
166400 9999-WRITE-MESSAGE-TO-CICS-LOG.                                  16640000
166500                                                                  16650000
166600     MOVE PC-CURRENT-PROGRAM-NAME     TO DP013-PROGRAM.           16660000
166700     MOVE DFHEIBLK                    TO DP013-DFHEIBLK.          16670000
166800     INITIALIZE DP013-SRC-TASK-NUMBER                             16680000
166900                DP013-STACK.                                      16690000
167000     SET DP013-LINK-RETURN            TO TRUE.                    16700000
167100                                                                  16710000
167200     EXEC CICS                                                    16720000
167300         LINK                                                     16730000
167400             PROGRAM   (DP013-NAME)                               16740000
167500             COMMAREA  (DP013-PARAMETERS)                         16750000
167600             LENGTH    (DP013-LENGTH)                             16760000
167700     END-EXEC.                                                    16770000
167800                                                                  16780000
167900*----------------------------------------------------------------*16790000
168000*    ABEND PROCESSOR MODULE                                      *16800000
168100*----------------------------------------------------------------*16810000
168200                                                                  16820000
168300*    COPY DPPD014.                                                16830000
168400                                                                  16840000
