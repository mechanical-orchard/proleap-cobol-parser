000100******************************************************************00010001
000200 IDENTIFICATION DIVISION.                                         00020001
000300******************************************************************00030001
000400                                                                  00040001
000500 PROGRAM-ID.             SUKUT073.                                00050001
000600 AUTHOR.                 LYNN MCADAMS.                            00060001
000700 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00070001
000800 DATE-WRITTEN            JULY, 2002.                              00080001
000900 DATE-COMPILED.                                                   00090001
001000                                                                  00100001
001100*----------------------------------------------------------------*00110001
001200* THIS PROGRAM WILL CREATE 2 OUTPUT EXTRACT FILES AT THE PO,     *00120001
001300* RECEIVER, LINE LEVEL.  THE INPUT FILE WILL BE THE VERIFIED/    *00130002
001400* COMPLETED EXTRACT FILES MERGED FROM THE CURRENT & PREVIOUS     *00140099
001500* DAYS.  THE INPUT AND OUTPUT LAYOUT FOR THE FILES IS SURD036.   *00150002
001600*                                                                *00160099
001700* THE FIRST OUTPUT FILE CONTAINS RECORDS TO BE CHECKED,          *00170002
001800* DETERMINING IF REPORTABLE.  THESE RECORDS WILL HAVE A          *00180099
001900* P2L CARTON COUNT > 0 AND WILL BE LESS THAN 24 HOURS OLD.       *00190099
002000*                                                                *00200099
002100* THIS FILE WILL BE THE INPUT FOR THE NEXT EXTRACT PROGRAM       *00210099
002200* (SUKUT075) WHICH IS REPORTABLE DATA.                           *00220099
002300*                                                                *00230099
002400* THE SECOND FILE CONTAINS RECORDS THAT ARE VERIFIED, AND LESS   *00240099
002500* THAN 7 DAYS OLD.  THIS FILE IS RETAINED AND USED THE NEXT DAY. *00250099
002600*----------------------------------------------------------------*00260001
002700                                                                  00270001
002800***************************************************************** 00280001
002900 ENVIRONMENT DIVISION.                                            00290001
003000***************************************************************** 00300001
003100 INPUT-OUTPUT SECTION.                                            00310001
003200                                                                  00320001
003300 FILE-CONTROL.                                                    00330001
003400                                                                  00340001
003500     SELECT VRFYD-CMPLT-FILE ASSIGN TO INP01.                     00350003
003600     SELECT EXTRACT-FILE1    ASSIGN TO OUT01.                     00360003
003700     SELECT EXTRACT-FILE2    ASSIGN TO OUT02.                     00370003
003800                                                                  00380001
003900***************************************************************** 00390001
004000 DATA DIVISION.                                                   00400001
004100***************************************************************** 00410001
004200 FILE SECTION.                                                    00420001
004300*                                                                 00430001
004400*                                                                 00440001
004500 FD  VRFYD-CMPLT-FILE                                             00450003
004600     RECORDING MODE IS F                                          00460001
004700     LABEL RECORDS ARE STANDARD                                   00470001
004800     BLOCK CONTAINS 0 RECORDS.                                    00480001
004900 01  VRFYD-CMPLT-RECORD          PIC X(300).                      00490092
005000*                                                                 00500001
005100 FD  EXTRACT-FILE1                                                00510001
005200     RECORDING MODE IS F                                          00520001
005300     LABEL RECORDS ARE STANDARD                                   00530001
005400     BLOCK CONTAINS 0 RECORDS.                                    00540001
005500 01  EXTRACT-RECORD1             PIC X(300).                      00550092
005600*                                                                 00560001
005700 FD  EXTRACT-FILE2                                                00570001
005800     RECORDING MODE IS F                                          00580001
005900     LABEL RECORDS ARE STANDARD                                   00590001
006000     BLOCK CONTAINS 0 RECORDS.                                    00600001
006100 01  EXTRACT-RECORD2             PIC X(300).                      00610092
006200*                                                                 00620001
006300***************************************************************** 00630001
006400 WORKING-STORAGE SECTION.                                         00640001
006500                                                                  00650001
006600 01  PS-PROGRAM-SWITCHES.                                         00660001
006700     05  PS-ERROR-SW              PIC  X(01)  VALUE  'N'.         00670003
006800         88  PS-ERROR                         VALUE  'Y'.         00680003
006900         88  PS-WARNING                       VALUE  'W'.         00690003
007000         88  PS-NO-ERROR                      VALUE  'N'.         00700003
007100     05  PS-END-OF-VRFYD-CMPLT-SW  PIC X(01)  VALUE 'N'.          00710018
007200         88  PS-END-OF-VRFYD-CMPLT-FILE       VALUE 'Y'.          00720003
007300         88  PS-NOT-END-OF-VRFYD-CMPLT-FILE   VALUE 'N'.          00730003
007400     05  PS-WRITE-EXTR1-SW         PIC X(01)  VALUE 'N'.          00740099
007500         88  PS-WRITE-EXTR1                   VALUE 'Y'.          00750099
007600         88  PS-WRITE-EXTR1-DEFAULT           VALUE 'N'.          00760099
007700     05  PS-WRITE-EXTR2-SW         PIC X(01)  VALUE 'N'.          00770099
007800         88  PS-WRITE-EXTR2                   VALUE 'Y'.          00780099
007900         88  PS-WRITE-EXTR2-DEFAULT           VALUE 'N'.          00790099
008000     05  PS-DAY-PARM-SW            PIC X(01)  VALUE 'N'.          00800099
008100         88  PS-DAY-PARM-OK                   VALUE 'Y'.          00810099
008200         88  PS-DAY-PARM-NOT-OK               VALUE 'N'.          00820099
008300                                                                  00830099
008400*                                                                 00840001
008500 01  PV-PROGRAM-VARIABLES.                                        00850001
008600     05  PV-MINUS-P2L-HOURS            PIC  X(26).                00860099
008700     05  PV-DEFAULT-TMST               PIC  X(26) VALUE           00870099
008800            '9999-09-09-09.09.09.999999'.                         00880099
008900     05  PV-DISPLAY-PO-NBR               PIC 999999999-.          00890099
009000     05  PV-DISPLAY-PO-LINE-NBR          PIC 999999999-.          00900099
009100     05  PV-DISPLAY-RCVR-SEQ-NBR         PIC 999999999-.          00910099
009200     05  PV-CURRENT-TIMESTAMP     PIC X(26)   VALUE               00920003
009300                                                 SPACES.          00930003
009400     05  PV-EXTRACT-DTE                PIC X(10).                 00940050
009500                                                                  00950099
009600     05  PV-CRE-DATE-TMST              PIC X(10).                 00960050
009700     05  PV-CRE-TIME-TMST              PIC X(8).                  00970050
009800                                                                  00980099
009900     05  PV-DB2-OPERATION-ATTEMPTED   PIC  X(30) VALUE SPACES.    00990051
010000     05  PV-DISPLAY-SQLCODE           PIC -9(05) VALUE ZEROES.    01000099
010100     05  PV-DB2-OPERATION-MESSAGE-1   PIC  X(79) VALUE SPACES.    01010050
010200     05  PV-DB2-TABLE-NAME            PIC  X(08) VALUE SPACES.    01020099
010300     05  PV-DB2-TABLE-NAME1           PIC  X(08) VALUE SPACES.    01030099
010400     05  PV-DB2-FUNCTION             PIC X(30) VALUE SPACE.       01040099
010500                                                                  01050099
010600     05  PV-READ-COUNT                PIC S9(09) VALUE ZERO       01060099
010700                                                  COMP SYNC.      01070001
010800     05  PV-WRITE-EXTR1-COUNT         PIC S9(09) VALUE ZERO       01080099
010900                                                  COMP SYNC.      01090001
011000     05  PV-WRITE-EXTR2-COUNT         PIC S9(09) VALUE ZERO       01100099
011100                                                  COMP SYNC.      01110099
011200     05  PV-DISPLAY-READ-CNT          PIC ZZZ,ZZZ,ZZ9.            01120099
011300     05  PV-DISPLAY-WRITE-CNT1        PIC ZZZ,ZZZ,ZZ9.            01130099
011400     05  PV-DISPLAY-WRITE-CNT2        PIC ZZZ,ZZZ,ZZ9.            01140099
011500                                                                  01150099
011600     05  PV-DB2-CURRENT-TIMESTAMP     PIC X(26)  VALUE SPACE.     01160001
011700     05  PV-WORK-TMST.                                            01170005
011800         10  PV-WORK-TMST-1.                                      01180005
011900             15  PV-WK-CCYY           PIC  X(04)  VALUE SPACE.    01190005
012000             15  FILLER               PIC  X(01)  VALUE SPACE.    01200005
012100             15  PV-WK-MO             PIC  X(02)  VALUE SPACE.    01210005
012200             15  FILLER               PIC  X(01)  VALUE SPACE.    01220005
012300             15  PV-WK-DA             PIC  X(02)  VALUE SPACE.    01230005
012400         10  PV-WORK-TMST-2.                                      01240005
012500             15  FILLER               PIC  X(01)  VALUE SPACE.    01250005
012600             15  PV-WK-HH             PIC  X(02)  VALUE SPACE.    01260005
012700             15  FILLER               PIC  X(01)  VALUE SPACE.    01270005
012800             15  PV-WK-MM             PIC  X(02)  VALUE SPACE.    01280005
012900             15  FILLER               PIC  X(01)  VALUE SPACE.    01290005
013000             15  PV-WK-SS             PIC  X(02)  VALUE SPACE.    01300005
013100             15  FILLER               PIC  X(01)  VALUE SPACE.    01310005
013200             15  FILLER               PIC  X(06)  VALUE ZERO.     01320005
013300     05  PV-LK-DTE-ISO.                                           01330005
013400         10  PV-LK-DTE-CCYY           PIC  X(04)  VALUE SPACE.    01340005
013500         10  PV-LK-DTE-MO             PIC  X(02)  VALUE SPACE.    01350005
013600         10  PV-LK-DTE-DD             PIC  X(02)  VALUE SPACE.    01360005
013700     05  PV-FROM-PARAGRAPH        PIC X(35)   VALUE               01370005
013800                                                 SPACES.          01380005
013900     05  PV-INPUT-DATE.                                           01390005
014000         10  PV-INPUT-DATE-MM     PIC 9(2)     VALUE ZEROES.      01400005
014100         10  FILLER               PIC X(1)     VALUE SPACES.      01410005
014200         10  PV-INPUT-DATE-DD     PIC 9(2)     VALUE ZEROES.      01420005
014300         10  FILLER               PIC X(1)     VALUE SPACES.      01430005
014400         10  PV-INPUT-DATE-CCY    PIC 9(4)     VALUE ZEROES.      01440005
014500                                                                  01450015
014600     05  PV-CURR-DATE-JULIAN      PIC X(07).                      01460040
014700     05  PV-CURR-DATE-JULIAN-N REDEFINES                          01470040
014800            PV-CURR-DATE-JULIAN   PIC 9(07).                      01480040
014900                                                                  01490015
015000     05  PV-VFY-DATE-JULIAN       PIC X(07).                      01500024
015100     05  PV-VFY-DATE-JULIAN-N REDEFINES                           01510016
015200            PV-VFY-DATE-JULIAN    PIC 9(07).                      01520024
015300                                                                  01530015
015400     05  PV-RCVD-DATE-JULIAN      PIC X(07).                      01540040
015500     05  PV-RCVD-DATE-JULIAN-N REDEFINES                          01550040
015600            PV-RCVD-DATE-JULIAN   PIC 9(07).                      01560040
015700                                                                  01570040
015800     05  PV-DIFFERENCE            PIC X(07).                      01580024
015900     05  PV-DIFFERENCE-N REDEFINES                                01590015
016000            PV-DIFFERENCE         PIC 9(07).                      01600024
016100     05  PV-VEMFDY-QTY-DAYS       PIC  S9(9) COMP.                01610099
016200     05  PV-P2LHRS-QTY-HRS        PIC  S9(9) COMP.                01620099
016300                                                                  01630099
016400 01  DK-DB-KEYS.                                                  01640001
016500     05  DK-PO-NBR                   PIC S9(09) COMP.             01650001
016600     05  DK-REC-SEQ-NBR              PIC S9(09) COMP.             01660099
016700     05  DK-LINE-NBR                 PIC S9(09) COMP.             01670099
016800     05  DK-OPER-UNT-ID              PIC S9(04) COMP.             01680099
016900                                                                  01690001
017000 01 PC-PROGRAM-CONSTANTS.                                         01700001
017100     05 PC-PROGRAM-NAME              PIC X(08)  VALUE 'SUKUT073'. 01710001
017200     05 PC-DEFAULT-TMST              PIC X(26)                    01720001
017300             VALUE '9999-09-09-09.09.09.999999'.                  01730001
017400     05 PC-0                         PIC X(01)  VALUE '0'.        01740044
017500                                                                  01750001
017600                                                                  01760001
017700 01  PV-ABEND-FIELDS.                                             01770001
017800     05  PV-ABEND-CODE                PIC S9(04) VALUE +0         01780001
017900                                                 COMP SYNC.       01790001
018000     05  PV-ABEND-PROGRAM             PIC  X(08) VALUE 'SUKUT073'.01800001
018100     05  PV-ABEND-PARAGRAPH           PIC  X(50) VALUE SPACES.    01810001
018200     05  PV-ABEND-OPERATION1          PIC  X(51) VALUE SPACES.    01820008
018300     05  PV-ABEND-OPERATION2          PIC  X(51) VALUE SPACES.    01830008
018400     05  PV-ABEND-OPERATION3          PIC  X(51) VALUE SPACES.    01840099
018500                                                                  01850004
018600******************************************************************01860001
018700*  USED FOR DB2 ERROR MESSAGE BUILDING                            01870001
018800******************************************************************01880001
018900     COPY DPWS004.                                                01890099
019000                                                                  01900001
019100*----------------------------------------------------------------*01910007
019200*    ABEND PROCESSING COPYBOOK.                                  *01920007
019300*----------------------------------------------------------------*01930007
019400                                                                  01940007
019500     COPY DPWS013.                                                01950099
019600*----------------------------------------------------------------*01960004
019700*  WORK AREA PASSED IN CALL TO DPKUT500                          *01970004
019800*----------------------------------------------------------------*01980004
019900     COPY DPWS500.                                                01990099
020000******************************************************************02000001
020100*   DB2 SQL COMMUNICATION AREA                                    02010001
020200******************************************************************02020001
020300     EXEC SQL                                                     02030001
020400          INCLUDE SQLCA                                           02040001
020500     END-EXEC.                                                    02050001
020600*DB2 AREA FOR COMMUNICATIONS AREA2                                02060099
020700     COPY SQLCA2.                                                 02070099
020800                                                                  02080001
020900******************************************************************02090097
021000*   DB2 DCLGEN FOR RC-RECEIPT ITEM TABLE                          02100097
021100******************************************************************02110097
021200     EXEC SQL                                                     02120097
021300          INCLUDE TRECITM                                         02130097
021400     END-EXEC.                                                    02140097
021500                                                                  02150097
021600******************************************************************02160001
021700*   DB2 DCLGEN FOR DC-DISTRIBUTION TRANSACTION HEADER TABLE       02170001
021800******************************************************************02180001
021900     EXEC SQL                                                     02190001
022000          INCLUDE TDISTHD                                         02200001
022100     END-EXEC.                                                    02210001
022200                                                                  02220001
022300******************************************************************02230002
022400*   DB2 DCLGEN FOR PARM TABLE                                     02240002
022500******************************************************************02250002
022600     EXEC SQL                                                     02260002
022700          INCLUDE TKRPRPM                                         02270002
022800     END-EXEC.                                                    02280002
022900                                                                  02290002
023000******************************************************************02300099
023100*   DB2 DCLGEN FOR PC-WORK ORDER INSTRUCTION TABLE                02310099
023200******************************************************************02320099
023300     EXEC SQL                                                     02330099
023400          INCLUDE TWKORIN                                         02340099
023500     END-EXEC.                                                    02350099
023600                                                                  02360099
023700                                                                  02370099
023800******************************************************************02380099
023900                                                                  02390098
024000                                                                  02400002
024100***********************************************************       02410002
024200*  RECORD LAYOUT FOR THE CARTON EXCEPTION EXTRACT FILE            02420091
024300***********************************************************       02430002
024400     COPY SURD036.                                                02440099
024500                                                                  02450002
024600 EJECT                                                            02460002
024700***********************************************************       02470002
024800 PROCEDURE DIVISION.                                              02480002
024900***********************************************************       02490002
025000*    DISPLAY '***BEGINNING SUKUT073***'.                          02500099
025100                                                                  02510072
025200     PERFORM 1000-INITIALIZE.                                     02520099
025300                                                                  02530072
025400     PERFORM 2000-PROCESS-VRFYD-CMPLT-FILE                        02540003
025500         UNTIL PS-END-OF-VRFYD-CMPLT-FILE.                        02550066
025600                                                                  02560066
025700     IF PS-END-OF-VRFYD-CMPLT-FILE                                02570099
025800        CONTINUE                                                  02580099
025900     END-IF                                                       02590099
026000                                                                  02600099
026100     MOVE PV-READ-COUNT           TO PV-DISPLAY-READ-CNT.         02610099
026200     DISPLAY 'TOTAL RECORDS READ  '  PV-DISPLAY-READ-CNT.         02620099
026300                                                                  02630099
026400     MOVE PV-WRITE-EXTR1-COUNT    TO PV-DISPLAY-WRITE-CNT1.       02640099
026500     DISPLAY 'TOTAL CHK RPTG RECS WRITTEN '                       02650099
026600                            PV-DISPLAY-WRITE-CNT1.                02660099
026700                                                                  02670099
026800     MOVE PV-WRITE-EXTR2-COUNT    TO PV-DISPLAY-WRITE-CNT2.       02680099
026900     DISPLAY 'TOTAL RETAIN RECS WRITTEN   '                       02690099
027000                            PV-DISPLAY-WRITE-CNT2.                02700099
027100                                                                  02710098
027200     CLOSE VRFYD-CMPLT-FILE                                       02720098
027300           EXTRACT-FILE1                                          02730098
027400           EXTRACT-FILE2.                                         02740098
027500                                                                  02750098
027600     GOBACK.                                                      02760098
027700                                                                  02770098
027800                                                                  02780098
027900***********************************************************       02790098
028000*  DO FIRST TIME PROGRAM INITIALIZE TASKS.                        02800099
028100 1000-INITIALIZE.                                                 02810099
028200***********************************************************       02820098
028300     OPEN INPUT  VRFYD-CMPLT-FILE                                 02830098
028400          OUTPUT EXTRACT-FILE1                                    02840098
028500          OUTPUT EXTRACT-FILE2.                                   02850098
028600                                                                  02860098
028700     INITIALIZE SU036-RECORD.                                     02870099
028800                                                                  02880099
028900*FIRST READ                                                       02890098
029000     PERFORM 7100-READ-VRFYD-CMPLT-FILE.                          02900098
029100                                                                  02910098
029200     IF PS-END-OF-VRFYD-CMPLT-FILE                                02920098
029300         DISPLAY '** PO FILE IS EMPTY **'                         02930099
029400     ELSE                                                         02940098
029500         MOVE SU036-OPER-UNT-ID TO DK-OPER-UNT-ID                 02950099
029600         MOVE SU036-PO-NUMBER   TO DK-PO-NBR                      02960099
029700         MOVE SU036-REC-SEQ-NBR TO DK-REC-SEQ-NBR                 02970099
029800         MOVE SU036-LINE-NBR    TO DK-LINE-NBR                    02980099
029900                                                                  02990099
030000*GET PARM VALUES ONE TIME                                         03000099
030100         PERFORM 2400-GET-QTY-DAYS                                03010099
030200         PERFORM 2500-GET-P2L-HRS                                 03020099
030300*                                                                 03030099
030400         PERFORM 2420-GET-LINE-STATUS-CDE                         03040099
030500                                                                  03050099
030600*CHECK IF ITEM IS XX DAYS OLD - IF SO SET WRITE EXTR2             03060099
030700         IF RECITM-STATUS-CDE = 'VE'                              03070099
030800            PERFORM 2450-SELECT-TRECITM                           03080099
030900            PERFORM 2455-GET-TMSTS                                03090099
031000         END-IF                                                   03100099
031100         IF RECITM-STATUS-CDE = 'CM' OR 'IP'                      03110099
031200            PERFORM 2475-SELECT-TWKORIN                           03120099
031300            PERFORM 2455-GET-TMSTS                                03130099
031400         END-IF                                                   03140099
031500                                                                  03150099
031600                                                                  03160099
031700*IF NOT OLDER THAN XX DAYS, CHECK TO SEE IF P2L AND GREATER       03170099
031800*THAN XX HOURS OLD - ELSE DROP IT.                                03180099
031900         IF PS-DAY-PARM-OK                                        03190099
032000           PERFORM 2550-SELECT-TDISTHD                            03200099
032100             IF PS-WRITE-EXTR1                                    03210099
032200               ADD +1 TO PV-WRITE-EXTR1-COUNT                     03220099
032300               PERFORM 8000-WRITE-EXTRACT1                        03230099
032400             END-IF                                               03240099
032500             IF PS-WRITE-EXTR2                                    03250099
032600               ADD +1 TO PV-WRITE-EXTR2-COUNT                     03260099
032700               PERFORM 8100-WRITE-EXTRACT2                        03270099
032800             END-IF                                               03280099
032900*LMM ADD                                                          03290099
033000           INITIALIZE SU036-RECORD                                03300099
033100           SET PS-WRITE-EXTR1-DEFAULT TO TRUE                     03310099
033200           SET PS-WRITE-EXTR2-DEFAULT TO TRUE                     03320099
033300         END-IF                                                   03330099
033400     END-IF.                                                      03340099
033500                                                                  03350099
033600                                                                  03360099
033700***************************************************************** 03370099
033800 2000-PROCESS-VRFYD-CMPLT-FILE.                                   03380099
033900***************************************************************** 03390099
034000     MOVE '2000-PROCESS-VRFYD-CMPLT-FILE' TO PV-ABEND-PARAGRAPH.  03400099
034100                                                                  03410099
034200*NEXT READ                                                        03420099
034300     PERFORM 7100-READ-VRFYD-CMPLT-FILE                           03430099
034400                                                                  03440099
034500     IF PS-END-OF-VRFYD-CMPLT-FILE                                03450099
034600          CONTINUE                                                03460099
034700     ELSE                                                         03470099
034800         IF  SU036-PO-NUMBER    =  DK-PO-NBR  AND                 03480099
034900             SU036-REC-SEQ-NBR  =  DK-REC-SEQ-NBR AND             03490099
035000             SU036-LINE-NBR     =  DK-LINE-NBR                    03500099
035100             CONTINUE                                             03510099
035200         ELSE                                                     03520099
035300            PERFORM 2420-GET-LINE-STATUS-CDE                      03530099
035400                                                                  03540099
035500            IF RECITM-STATUS-CDE = 'VE'                           03550099
035600               PERFORM 2450-SELECT-TRECITM                        03560099
035700               PERFORM 2455-GET-TMSTS                             03570099
035800            END-IF                                                03580099
035900            IF RECITM-STATUS-CDE = 'CM' OR 'IP'                   03590099
036000               PERFORM 2475-SELECT-TWKORIN                        03600099
036100               PERFORM 2455-GET-TMSTS                             03610099
036200            END-IF                                                03620099
036300                                                                  03630099
036400            IF PS-DAY-PARM-OK                                     03640099
036500               PERFORM 2550-SELECT-TDISTHD                        03650099
036600                                                                  03660099
036700               IF PS-WRITE-EXTR1                                  03670099
036800                 ADD +1 TO PV-WRITE-EXTR1-COUNT                   03680099
036900                 PERFORM 8000-WRITE-EXTRACT1                      03690099
037000               END-IF                                             03700099
037100               IF PS-WRITE-EXTR2                                  03710099
037200                 ADD +1 TO PV-WRITE-EXTR2-COUNT                   03720099
037300                 PERFORM 8100-WRITE-EXTRACT2                      03730099
037400               END-IF                                             03740099
037500                                                                  03750099
037600*LMM ADD                                                          03760099
037700               INITIALIZE SU036-RECORD                            03770099
037800               SET PS-WRITE-EXTR1-DEFAULT TO TRUE                 03780099
037900               SET PS-WRITE-EXTR2-DEFAULT TO TRUE                 03790099
038000            END-IF                                                03800099
038100         END-IF                                                   03810099
038200     END-IF.                                                      03820099
038300                                                                  03830099
038400                                                                  03840099
038500***************************************************************** 03850099
038600 2400-GET-QTY-DAYS.                                               03860099
038700***************************************************************** 03870099
038800     EXEC SQL                                                     03880099
038900          SELECT FUNC_QTY                                         03890099
039000            INTO  :PV-VEMFDY-QTY-DAYS                             03900099
039100            FROM TKRPRPM                                          03910099
039200           WHERE SYS_PRC_FUNC_CDE = 'VEMFDY'                      03920099
039300             AND LOC_ID           = :DK-OPER-UNT-ID               03930099
039400             WITH UR                                              03940099
039500     END-EXEC.                                                    03950099
039600                                                                  03960099
039700     EVALUATE TRUE                                                03970099
039800         WHEN SQLCODE = +0                                        03980099
039900              DISPLAY 'PARM VEMFDY VALUE = ' PV-VEMFDY-QTY-DAYS   03990099
040000         WHEN SQLCODE = +100                                      04000099
040100              CONTINUE                                            04010099
040200         WHEN SQLWARN0 NOT = SPACE                                04020099
040300         WHEN SQLCODE  NOT = +0                                   04030099
040400              MOVE '2400-GET-QTY-DAYS'                            04040099
040500                                   TO PV-ABEND-PARAGRAPH          04050099
040600              MOVE 'SELECT FROM TKRPRPM'                          04060099
040700                                   TO PV-ABEND-OPERATION1         04070099
040800              PERFORM Z999-SQL-ABEND                              04080099
040900     END-EVALUATE.                                                04090099
041000                                                                  04100099
041100***************************************************************** 04110099
041200 2420-GET-LINE-STATUS-CDE.                                        04120099
041300***************************************************************** 04130099
041400     MOVE SU036-OPER-UNT-ID TO DK-OPER-UNT-ID                     04140099
041500     MOVE SU036-PO-NUMBER   TO DK-PO-NBR                          04150099
041600     MOVE SU036-REC-SEQ-NBR TO DK-REC-SEQ-NBR                     04160099
041700     MOVE SU036-LINE-NBR    TO DK-LINE-NBR                        04170099
041800                                                                  04180099
041900     EXEC SQL                                                     04190099
042000          SELECT STATUS_CDE                                       04200099
042100            INTO  :RECITM-STATUS-CDE                              04210099
042200            FROM TRECITM                                          04220099
042300           WHERE OPER_UNT_ID = :DK-OPER-UNT-ID                    04230099
042400             AND ORD_NBR     = :DK-PO-NBR                         04240099
042500             AND REC_SEQ_NBR = :DK-REC-SEQ-NBR                    04250099
042600             AND ORD_LNE_NBR = :DK-LINE-NBR                       04260099
042700             WITH UR                                              04270099
042800     END-EXEC.                                                    04280099
042900                                                                  04290099
043000     EVALUATE TRUE                                                04300099
043100         WHEN SQLCODE = +0                                        04310099
043200              MOVE RECITM-STATUS-CDE  TO SU036-LINE-STATUS        04320099
043300         WHEN SQLCODE = +100                                      04330099
043400              CONTINUE                                            04340099
043500         WHEN SQLWARN0 NOT = SPACE                                04350099
043600         WHEN SQLCODE  NOT = +0                                   04360099
043700              MOVE '2420-GET-LINE-STATUS-CDE'                     04370099
043800                                   TO PV-ABEND-PARAGRAPH          04380099
043900              MOVE 'SELECT FROM TRECITM'                          04390099
044000                                   TO PV-ABEND-OPERATION1         04400099
044100              MOVE DK-PO-NBR           TO PV-DISPLAY-PO-NBR       04410099
044200              STRING 'PO NBR: '         DELIMITED BY SIZE         04420099
044300                  PV-DISPLAY-PO-NBR     DELIMITED BY SIZE         04430099
044400                            INTO PV-ABEND-OPERATION1              04440099
044500              MOVE DK-REC-SEQ-NBR                                 04450099
044600                              TO PV-DISPLAY-RCVR-SEQ-NBR          04460099
044700              STRING 'RECV SEQ: '       DELIMITED BY SIZE         04470099
044800                  PV-DISPLAY-RCVR-SEQ-NBR                         04480099
044900                                        DELIMITED BY SIZE         04490099
045000                            INTO PV-ABEND-OPERATION2              04500099
045100              MOVE DK-LINE-NBR         TO PV-DISPLAY-PO-LINE-NBR  04510099
045200              STRING 'PO LINE NBR: '    DELIMITED BY SIZE         04520099
045300                 PV-DISPLAY-PO-LINE-NBR DELIMITED BY SIZE         04530099
045400                            INTO PV-ABEND-OPERATION3              04540099
045500              PERFORM Z999-SQL-ABEND                              04550099
045600     END-EVALUATE.                                                04560099
045700                                                                  04570099
045800                                                                  04580099
045900***************************************************************** 04590099
046000 2450-SELECT-TRECITM.                                             04600099
046100***************************************************************** 04610099
046200     EXEC SQL                                                     04620099
046300          SELECT ORD_NBR                                          04630099
046400                ,REC_SEQ_NBR                                      04640099
046500                ,OPER_UNT_ID                                      04650099
046600                ,VERFYD_TMST                                      04660099
046700            INTO  :RECITM-ORD-NBR                                 04670099
046800                , :RECITM-REC-SEQ-NBR                             04680099
046900                , :RECITM-OPER-UNT-ID                             04690099
047000                , :RECITM-VERFYD-TMST                             04700099
047100            FROM TRECITM                                          04710099
047200           WHERE OPER_UNT_ID = :DK-OPER-UNT-ID                    04720099
047300             AND ORD_NBR     = :DK-PO-NBR                         04730099
047400             AND REC_SEQ_NBR = :DK-REC-SEQ-NBR                    04740099
047500             AND ORD_LNE_NBR = :DK-LINE-NBR                       04750099
047600             AND VERFYD_TMST >= (CURRENT TIMESTAMP -              04760099
047700                               :PV-VEMFDY-QTY-DAYS DAYS)          04770099
047800             AND STATUS_CDE  NOT IN ('DE')                        04780099
047900             WITH UR                                              04790099
048000     END-EXEC.                                                    04800099
048100                                                                  04810099
048200     EVALUATE TRUE                                                04820099
048300         WHEN SQLCODE = +0                                        04830099
048400              SET PS-DAY-PARM-OK TO TRUE                          04840099
048500              SET PS-WRITE-EXTR2 TO TRUE                          04850099
048600              MOVE RECITM-VERFYD-TMST TO                          04860099
048700                   SU036-TMST-LINE-VERIFIED                       04870099
048800         WHEN SQLCODE = +100                                      04880099
048900              SET PS-DAY-PARM-NOT-OK TO TRUE                      04890099
049000              SET PS-WRITE-EXTR2-DEFAULT TO TRUE                  04900099
049100         WHEN SQLWARN0 NOT = SPACE                                04910099
049200         WHEN SQLCODE  NOT = +0                                   04920099
049300              MOVE '2450-SELECT-TRECITM'                          04930099
049400                                   TO PV-ABEND-PARAGRAPH          04940099
049500              MOVE 'SELECT FROM TRECITM'                          04950099
049600                                   TO PV-ABEND-OPERATION1         04960099
049700              MOVE RECITM-ORD-NBR      TO PV-DISPLAY-PO-NBR       04970099
049800              STRING 'PO NBR: '         DELIMITED BY SIZE         04980099
049900                  PV-DISPLAY-PO-NBR     DELIMITED BY SIZE         04990099
050000                            INTO PV-ABEND-OPERATION1              05000099
050100              MOVE RECITM-REC-SEQ-NBR                             05010099
050200                              TO PV-DISPLAY-RCVR-SEQ-NBR          05020099
050300              STRING 'RECV SEQ: '       DELIMITED BY SIZE         05030099
050400                  PV-DISPLAY-RCVR-SEQ-NBR                         05040099
050500                                        DELIMITED BY SIZE         05050099
050600                            INTO PV-ABEND-OPERATION2              05060099
050700              PERFORM Z999-SQL-ABEND                              05070099
050800     END-EVALUATE.                                                05080099
050900                                                                  05090099
051000                                                                  05100099
051100***************************************************************** 05110099
051200 2455-GET-TMSTS.                                                  05120099
051300***************************************************************** 05130099
051400     MOVE SU036-PO-NUMBER   TO DK-PO-NBR                          05140099
051500     MOVE SU036-REC-SEQ-NBR TO DK-REC-SEQ-NBR                     05150099
051600     MOVE SU036-LINE-NBR    TO DK-LINE-NBR                        05160099
051700                                                                  05170099
051800     EXEC SQL                                                     05180099
051900          SELECT RSLTS_RCVD_TMST                                  05190099
052000               , FCSE_CNFRMN_TMST                                 05200099
052100            INTO  :DISTHD-RSLTS-RCVD-TMST                         05210099
052200               ,  :DISTHD-FCSE-CNFRMN-TMST                        05220099
052300            FROM TDISTHD                                          05230099
052400           WHERE ORD_NBR      = :DK-PO-NBR                        05240099
052500             AND ORD_LNE_NBR  = :DK-LINE-NBR                      05250099
052600             AND RCVR_SEQ_NBR = :DK-REC-SEQ-NBR                   05260099
052700           WITH UR                                                05270099
052800     END-EXEC.                                                    05280099
052900                                                                  05290099
053000     EVALUATE TRUE                                                05300099
053100         WHEN SQLCODE = 0                                         05310099
053200             MOVE DISTHD-FCSE-CNFRMN-TMST                         05320099
053300                                   TO SU036-TMST-LINE-CONFIRMED   05330099
053400             MOVE DISTHD-RSLTS-RCVD-TMST                          05340099
053500                                   TO SU036-TMST-LINE-P2L-UPLD    05350099
053600         WHEN SQLCODE = +100                                      05360099
053700             CONTINUE                                             05370099
053800         WHEN SQLCODE = -904                                      05380099
053900         WHEN SQLCODE = -911                                      05390099
054000             MOVE '2455-GET-TMSTS'                                05400099
054100                                    TO PV-ABEND-PARAGRAPH         05410099
054200             MOVE 'SELECT FROM TDISTHD'                           05420099
054300                                TO PV-DB2-OPERATION-ATTEMPTED     05430099
054400             MOVE SQLCODE       TO PV-DISPLAY-SQLCODE             05440099
054500             MOVE 'TDISTHD'     TO PV-DB2-TABLE-NAME              05450099
054600             MOVE DK-PO-NBR           TO PV-DISPLAY-PO-NBR        05460099
054700             STRING 'PO NBR: '         DELIMITED BY SIZE          05470099
054800                 PV-DISPLAY-PO-NBR     DELIMITED BY SIZE          05480099
054900                           INTO PV-ABEND-OPERATION1               05490099
055000             MOVE DK-REC-SEQ-NBR                                  05500099
055100                             TO PV-DISPLAY-RCVR-SEQ-NBR           05510099
055200             STRING 'RECV SEQ: '       DELIMITED BY SIZE          05520099
055300                 PV-DISPLAY-RCVR-SEQ-NBR                          05530099
055400                                       DELIMITED BY SIZE          05540099
055500                           INTO PV-ABEND-OPERATION2               05550099
055600             MOVE DK-LINE-NBR         TO PV-DISPLAY-PO-LINE-NBR   05560099
055700             STRING 'PO LINE NBR: '    DELIMITED BY SIZE          05570099
055800                PV-DISPLAY-PO-LINE-NBR DELIMITED BY SIZE          05580099
055900                           INTO PV-ABEND-OPERATION3               05590099
056000             PERFORM Z999-SQL-ABEND                               05600099
056100         WHEN OTHER                                               05610099
056200             MOVE '2455-GET-TMSTS'                                05620099
056300                                    TO PV-ABEND-PARAGRAPH         05630099
056400             MOVE 'SELECT FROM TDISTHD'                           05640099
056500                                TO PV-DB2-OPERATION-ATTEMPTED     05650099
056600             MOVE SQLCODE       TO PV-DISPLAY-SQLCODE             05660099
056700             MOVE 'TDISTHD'     TO PV-DB2-TABLE-NAME              05670099
056800             MOVE DK-PO-NBR           TO PV-DISPLAY-PO-NBR        05680099
056900             STRING 'PO NBR: '         DELIMITED BY SIZE          05690099
057000                 PV-DISPLAY-PO-NBR     DELIMITED BY SIZE          05700099
057100                           INTO PV-ABEND-OPERATION1               05710099
057200             MOVE DK-REC-SEQ-NBR                                  05720099
057300                             TO PV-DISPLAY-RCVR-SEQ-NBR           05730099
057400             STRING 'RECV SEQ: '       DELIMITED BY SIZE          05740099
057500                 PV-DISPLAY-RCVR-SEQ-NBR                          05750099
057600                                       DELIMITED BY SIZE          05760099
057700                           INTO PV-ABEND-OPERATION2               05770099
057800             MOVE DK-LINE-NBR         TO PV-DISPLAY-PO-LINE-NBR   05780099
057900             STRING 'PO LINE NBR: '    DELIMITED BY SIZE          05790099
058000                PV-DISPLAY-PO-LINE-NBR DELIMITED BY SIZE          05800099
058100                           INTO PV-ABEND-OPERATION3               05810099
058200             PERFORM Z999-SQL-ABEND                               05820099
058300     END-EVALUATE.                                                05830099
058400                                                                  05840099
058500                                                                  05850099
058600***************************************************************** 05860099
058700 2475-SELECT-TWKORIN.                                             05870099
058800***************************************************************** 05880099
058900     EXEC SQL                                                     05890099
059000        SELECT A.STOP_TMST                                        05900099
059100        INTO  :WKORIN-STOP-TMST                                   05910099
059200        FROM   TWKORIN A                                          05920099
059300        WHERE  A.ORD_NBR          = :DK-PO-NBR                    05930099
059400          AND  A.RCVR_SEQ_NBR     = :DK-REC-SEQ-NBR               05940099
059500          AND  A.ORD_LNE_NBR      = 0                             05950099
059600          AND  A.VER_STATUS_CDE   = 'A'                           05960099
059700          AND  A.STOP_TMST IN                                     05970099
059800            (SELECT MAX(C.STOP_TMST)                              05980099
059900              FROM TWKORIN C                                      05990099
060000            WHERE C.ORD_NBR      = :DK-PO-NBR                     06000099
060100              AND C.RCVR_SEQ_NBR = :DK-REC-SEQ-NBR                06010099
060200              AND C.ORD_LNE_NBR  = 0                              06020099
060300              AND C.VER_STATUS_CDE   = 'A'                        06030099
060400              AND STOP_TMST >= (CURRENT TIMESTAMP -               06040099
060500                               :PV-VEMFDY-QTY-DAYS DAYS)          06050099
060600              AND STOP_TMST NOT IN ('9999-09-09-09.09.09.000000') 06060099
060700              AND STOP_TMST NOT IN ('9999-09-09-09.09.09.999999'))06070099
060800              WITH UR                                             06080099
060900     END-EXEC.                                                    06090099
061000                                                                  06100099
061100     EVALUATE TRUE                                                06110099
061200         WHEN SQLCODE = +0                                        06120099
061300              SET PS-DAY-PARM-OK TO TRUE                          06130099
061400              SET PS-WRITE-EXTR2 TO TRUE                          06140099
061500              MOVE WKORIN-STOP-TMST TO SU036-TMST-LINE-VERIFIED   06150099
061600         WHEN SQLCODE = +100                                      06160099
061700              SET PS-DAY-PARM-NOT-OK TO TRUE                      06170099
061800              SET PS-WRITE-EXTR2-DEFAULT TO TRUE                  06180099
061900         WHEN SQLWARN0 NOT = SPACE                                06190099
062000         WHEN SQLCODE  NOT = +0                                   06200099
062100              MOVE '2475-SELECT-TWKORIN'                          06210099
062200                                   TO PV-ABEND-PARAGRAPH          06220099
062300              MOVE 'ATTEMPTING TO SELECT TWKORIN'                 06230099
062400                                   TO PV-ABEND-OPERATION1         06240099
062500              MOVE DK-PO-NBR           TO PV-DISPLAY-PO-NBR       06250099
062600              STRING 'PO NBR: '         DELIMITED BY SIZE         06260099
062700                  PV-DISPLAY-PO-NBR     DELIMITED BY SIZE         06270099
062800                            INTO PV-ABEND-OPERATION1              06280099
062900              MOVE DK-REC-SEQ-NBR                                 06290099
063000                              TO PV-DISPLAY-RCVR-SEQ-NBR          06300099
063100              STRING 'RECV SEQ: '       DELIMITED BY SIZE         06310099
063200                  PV-DISPLAY-RCVR-SEQ-NBR                         06320099
063300                                        DELIMITED BY SIZE         06330099
063400                            INTO PV-ABEND-OPERATION2              06340099
063500              PERFORM Z999-SQL-ABEND                              06350099
063600     END-EVALUATE.                                                06360099
063700                                                                  06370099
063800                                                                  06380099
063900***************************************************************** 06390099
064000 2500-GET-P2L-HRS.                                                06400099
064100***************************************************************** 06410099
064200     MOVE SU036-OPER-UNT-ID   TO DK-OPER-UNT-ID                   06420099
064300                                                                  06430099
064400     EXEC SQL                                                     06440099
064500       SELECT   FUNC_QTY                                          06450099
064600         INTO   :PV-P2LHRS-QTY-HRS                                06460099
064700         FROM   TKRPRPM                                           06470099
064800        WHERE   SYS_PRC_FUNC_CDE  = 'P2LHRS'                      06480099
064900          AND   LOC_ID            = :DK-OPER-UNT-ID               06490099
065000          WITH UR                                                 06500099
065100     END-EXEC.                                                    06510099
065200                                                                  06520099
065300     EVALUATE TRUE                                                06530099
065400         WHEN SQLCODE = ZERO                                      06540099
065500              DISPLAY 'PARM P2LHRS VALUE = ' PV-P2LHRS-QTY-HRS    06550099
065600         WHEN SQLCODE = +100                                      06560099
065700              CONTINUE                                            06570099
065800         WHEN SQLWARN0 NOT = SPACE                                06580099
065900         WHEN SQLCODE  NOT = +0                                   06590099
066000              MOVE '2500-GET-P2L-HRS'                             06600099
066100                                   TO PV-ABEND-PARAGRAPH          06610099
066200              MOVE 'SELECT FROM TKRPRPM'                          06620099
066300                                   TO PV-ABEND-OPERATION1         06630099
066400              PERFORM Z999-SQL-ABEND                              06640099
066500     END-EVALUATE.                                                06650099
066600                                                                  06660099
066700                                                                  06670099
066800***************************************************************** 06680099
066900 2550-SELECT-TDISTHD.                                             06690099
067000***************************************************************** 06700099
067100     MOVE SU036-PO-NUMBER   TO DK-PO-NBR                          06710099
067200     MOVE SU036-REC-SEQ-NBR TO DK-REC-SEQ-NBR                     06720099
067300     MOVE SU036-LINE-NBR    TO DK-LINE-NBR                        06730099
067400                                                                  06740099
067500     EXEC SQL                                                     06750099
067600          SELECT ORD_NBR                                          06760099
067700               , RCVR_SEQ_NBR                                     06770099
067800               , ORD_LNE_NBR                                      06780099
067900               , OPER_UNT_ID                                      06790099
068000               , RSLTS_RCVD_TMST                                  06800099
068100               , FCSE_CNFRMN_TMST                                 06810099
068200               , P2L_CART_CNT                                     06820099
068300               , (CURRENT TIMESTAMP - :PV-P2LHRS-QTY-HRS HOURS)   06830099
068400            INTO  :DISTHD-ORD-NBR                                 06840099
068500               ,  :DISTHD-RCVR-SEQ-NBR                            06850099
068600               ,  :DISTHD-ORD-LNE-NBR                             06860099
068700               ,  :DISTHD-OPER-UNT-ID                             06870099
068800               ,  :DISTHD-RSLTS-RCVD-TMST                         06880099
068900               ,  :DISTHD-FCSE-CNFRMN-TMST                        06890099
069000               ,  :DISTHD-P2L-CART-CNT                            06900099
069100               ,  :PV-MINUS-P2L-HOURS                             06910099
069200            FROM TDISTHD                                          06920099
069300           WHERE ORD_NBR      = :DK-PO-NBR                        06930099
069400             AND ORD_LNE_NBR  = :DK-LINE-NBR                      06940099
069500             AND RCVR_SEQ_NBR = :DK-REC-SEQ-NBR                   06950099
069600             AND P2L_CART_CNT > 0                                 06960099
069700           WITH UR                                                06970099
069800     END-EXEC.                                                    06980099
069900                                                                  06990099
070000     EVALUATE TRUE                                                07000099
070100         WHEN SQLCODE = 0                                         07010099
070200*THIS WRITE IS FOR P2L'S THAT MEET HOURS CRITERIA                 07020099
070300*P2L'S THAT DO NOT MEET HOURS CRITERIA DO NOT GET WRITTEN AT ALL  07030099
070400             IF DISTHD-RSLTS-RCVD-TMST < PV-MINUS-P2L-HOURS       07040099
070500                SET PS-WRITE-EXTR1     TO TRUE                    07050099
070600             END-IF                                               07060099
070700*LMM                                                              07070099
070800             IF RECITM-STATUS-CDE      = 'VE' AND                 07080099
070900                DISTHD-RSLTS-RCVD-TMST = PC-DEFAULT-TMST          07090099
071000                SET PS-WRITE-EXTR1     TO TRUE                    07100099
071100             END-IF                                               07110099
071200         WHEN SQLCODE = +100                                      07120099
071300*THIS WRITE IS FOR NON-P2L'S                                      07130099
071400             SET PS-WRITE-EXTR1     TO TRUE                       07140099
071500         WHEN SQLCODE = -904                                      07150099
071600         WHEN SQLCODE = -911                                      07160099
071700             MOVE '2550-SELECT-TDISTHD'                           07170099
071800                                    TO PV-ABEND-PARAGRAPH         07180099
071900             MOVE 'SELECT FROM TDISTHD'                           07190099
072000                                TO PV-DB2-OPERATION-ATTEMPTED     07200099
072100             MOVE SQLCODE       TO PV-DISPLAY-SQLCODE             07210099
072200             MOVE 'TDISTHD'     TO PV-DB2-TABLE-NAME              07220099
072300             MOVE DK-PO-NBR           TO PV-DISPLAY-PO-NBR        07230099
072400             STRING 'PO NBR: '         DELIMITED BY SIZE          07240099
072500                 PV-DISPLAY-PO-NBR     DELIMITED BY SIZE          07250099
072600                           INTO PV-ABEND-OPERATION1               07260099
072700             MOVE DK-REC-SEQ-NBR                                  07270099
072800                             TO PV-DISPLAY-RCVR-SEQ-NBR           07280099
072900             STRING 'RECV SEQ: '       DELIMITED BY SIZE          07290099
073000                 PV-DISPLAY-RCVR-SEQ-NBR                          07300099
073100                                       DELIMITED BY SIZE          07310099
073200                           INTO PV-ABEND-OPERATION2               07320099
073300             MOVE DK-LINE-NBR         TO PV-DISPLAY-PO-LINE-NBR   07330099
073400             STRING 'PO LINE NBR: '    DELIMITED BY SIZE          07340099
073500                PV-DISPLAY-PO-LINE-NBR DELIMITED BY SIZE          07350099
073600                           INTO PV-ABEND-OPERATION3               07360099
073700             PERFORM Z999-SQL-ABEND                               07370099
073800         WHEN OTHER                                               07380099
073900             MOVE '2550-SELECT-TDISTHD'                           07390099
074000                                    TO PV-ABEND-PARAGRAPH         07400099
074100             MOVE 'SELECT FROM TDISTHD'                           07410099
074200                                TO PV-DB2-OPERATION-ATTEMPTED     07420099
074300             MOVE SQLCODE       TO PV-DISPLAY-SQLCODE             07430099
074400             MOVE 'TDISTHD'     TO PV-DB2-TABLE-NAME              07440099
074500             MOVE DK-PO-NBR           TO PV-DISPLAY-PO-NBR        07450099
074600             STRING 'PO NBR: '         DELIMITED BY SIZE          07460099
074700                 PV-DISPLAY-PO-NBR     DELIMITED BY SIZE          07470099
074800                           INTO PV-ABEND-OPERATION1               07480099
074900             MOVE DK-REC-SEQ-NBR                                  07490099
075000                             TO PV-DISPLAY-RCVR-SEQ-NBR           07500099
075100             STRING 'RECV SEQ: '       DELIMITED BY SIZE          07510099
075200                 PV-DISPLAY-RCVR-SEQ-NBR                          07520099
075300                                       DELIMITED BY SIZE          07530099
075400                           INTO PV-ABEND-OPERATION2               07540099
075500             PERFORM Z999-SQL-ABEND                               07550099
075600     END-EVALUATE.                                                07560099
075700                                                                  07570099
075800                                                                  07580099
075900***************************************************************** 07590099
076000 7100-READ-VRFYD-CMPLT-FILE.                                      07600099
076100******************************************************************07610099
076200     READ VRFYD-CMPLT-FILE INTO SU036-RECORD                      07620099
076300        AT END                                                    07630099
076400           SET PS-END-OF-VRFYD-CMPLT-FILE TO TRUE                 07640099
076500        NOT AT END                                                07650099
076600           ADD +1 TO PV-READ-COUNT                                07660099
076700           CONTINUE                                               07670099
076800     END-READ.                                                    07680099
076900                                                                  07690099
077000                                                                  07700099
077100******************************************************************07710099
077200 8000-WRITE-EXTRACT1.                                             07720099
077300******************************************************************07730099
077400     WRITE EXTRACT-RECORD1                                        07740099
077500       FROM SU036-RECORD.                                         07750099
077600                                                                  07760099
077700                                                                  07770099
077800******************************************************************07780099
077900 8100-WRITE-EXTRACT2.                                             07790099
078000******************************************************************07800099
078100     WRITE EXTRACT-RECORD2                                        07810099
078200       FROM SU036-RECORD.                                         07820099
078300*    INITIALIZE SU036-RECORD.                                     07830099
078400                                                                  07840099
078500***************************************************************** 07850099
078600 Z999-SQL-ABEND.                                                  07860099
078700***************************************************************** 07870099
078800     MOVE SQLCODE                     TO SQLCODE2.                07880099
078900     MOVE SQLERRD(3)                  TO SQLERRD3.                07890099
079000                                                                  07900099
079100     DISPLAY '** ABEND **         ** = SQLERROR'.                 07910099
079200     DISPLAY '** PROGRAM   ** = ' PC-PROGRAM-NAME.                07920099
079300     DISPLAY '** PO NUMBER ** = ' PV-DISPLAY-PO-NBR.              07930099
079400     DISPLAY '** RECEIVER  ** = ' PV-DISPLAY-RCVR-SEQ-NBR.        07940099
079500     DISPLAY '** PO LNE NBR** = ' PV-DISPLAY-PO-LINE-NBR.         07950099
079600                                                                  07960099
079700                                                                  07970099
079800     DISPLAY '** PARAGRAPH ** = ' PV-ABEND-PARAGRAPH.             07980099
079900     DISPLAY '** OPERATION ** = ' PV-DB2-FUNCTION.                07990099
080000     DISPLAY '** DB2 TABLE ** = ' PV-DB2-TABLE-NAME.              08000099
080100     DISPLAY '** DB2 TABLE ** = ' PV-DB2-TABLE-NAME1.             08010099
080200     DISPLAY '** SQLCODE          ** = ' SQLCODE2.                08020099
080300     DISPLAY '** ROWS PROCESSED   ** = ' SQLERRD3.                08030099
080400     DISPLAY '** SQLERRM          ** = ' SQLERRM.                 08040099
080500     DISPLAY '** SQLERRMC         ** = ' SQLERRMC.                08050099
080600                                                                  08060099
080700                                                                  08070099
080800     MOVE +4013                  TO PV-ABEND-CODE.                08080099
080900     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         08090099
