      ***************************************************************** 00010000
       IDENTIFICATION DIVISION.                                         00020000
      ***************************************************************** 00030000
                                                                        00040000
       PROGRAM-ID.             TCKRP004.                                00050001
       AUTHOR.                 J MYERS.                                 00060000
       INSTALLATION.           KOHLS.                                   00070000
       DATE-WRITTEN            03/2002.                                 00080000
       DATE-COMPILED.                                                   00090000
                                                                        00100000
      ***************************************************************** 00110000
      *  PURPOSE:                                                       00120000
      *  CREATE DAILY DEBIT ADJUSTMENT REPORT                           00130001
      *         DAILY DEBIT ADJUSTMENT TOTALS REPORT                    00131001
      ***************************************************************** 00160000
       ENVIRONMENT DIVISION.                                            00170000
      ***************************************************************** 00180000
                                                                        00190000
       CONFIGURATION SECTION.                                           00200000
                                                                        00210000
       SOURCE-COMPUTER.        IBM-3090.                                00220000
                                                                        00230000
       OBJECT-COMPUTER.        IBM-3090.                                00240000
                                                                        00250000
       INPUT-OUTPUT SECTION.                                            00260000
                                                                        00270000
       FILE-CONTROL.                                                    00280000
                                                                        00290000
           SELECT CONTROL-DATE-FILE                                     00300000
               ASSIGN TO INP01.                                         00310000
                                                                        00320000
           SELECT ADJ-INPUT-FILE                                        00320100
               ASSIGN TO INP02.                                         00320200
                                                                        00320300
           SELECT ADJUSTMENT-REPORT                                     00351001
               ASSIGN TO RPT01.                                         00352000
                                                                        00353000
           SELECT ADJUSTMENT-TOTAL-REPORT                               00354001
               ASSIGN TO RPT02.                                         00355001
                                                                        00356001
      ******************************************************************00370000
       DATA DIVISION.                                                   00380000
      ******************************************************************00390000
                                                                        00400000
       FILE SECTION.                                                    00410000
                                                                        00420000
       FD  CONTROL-DATE-FILE                                            00430000
           RECORDING MODE IS F                                          00440000
           BLOCK CONTAINS 0 RECORDS                                     00450000
           LABEL RECORDS ARE OMITTED.                                   00460000
                                                                        00470000
       01  CONTROL-DATE-RECORD         PIC X(80).                       00480000
                                                                        00490000
       FD  ADJ-INPUT-FILE                                               00490100
           RECORDING MODE IS F                                          00490200
           BLOCK CONTAINS 0 RECORDS.                                    00490300
                                                                        00490500
       01  ADJ-INPUT-RECORD            PIC X(258).                      00490600
                                                                        00490700
                                                                        00578000
       FD  ADJUSTMENT-REPORT                                            00579001
           RECORDING MODE IS F                                          00579100
           BLOCK CONTAINS 0 RECORDS.                                    00579300
                                                                        00579500
       01  ADJUSTMENT-REPT-RECORD        PIC X(132).                    00579601
                                                                        00579700
       FD  ADJUSTMENT-TOTAL-REPORT                                      00579806
           RECORDING MODE IS F                                          00579901
           BLOCK CONTAINS 0 RECORDS.                                    00580001
                                                                        00580101
       01  ADJ-TOTAL-REPT-RECORD        PIC X(132).                     00580201
                                                                        00580301
      ******************************************************************00590000
       WORKING-STORAGE SECTION.                                         00600000
      ******************************************************************00610000
       01  FILLER                            PIC X(50)  VALUE           00620000
           ' *** WORKING STORAGE STARTS HERE FOR TCKRP004 *** '.        00630001
                                                                        00640000
      ******************************************************************00650000
      * RECORD LAYOUT FOR INPUT DATE CARD (POS DATE)                   *00660000
      ******************************************************************00670000
       01  CC-CONTROL-CARD.                                             00680000
           05  CC-CONTROL-CARD-DISPLAY.                                 00690000
               10  CC-CONTROL-NAME     PIC X(14)    VALUE SPACE.        00700000
                   88  CC-VALID-CONTROL-NAME        VALUE               00710000
                      'P.O.S. DATE = '.                                 00720000
               10  CC-POS-DATE-MMDDYY  PIC 9(6)     VALUE ZERO.         00730000
          05  FILLER                  PIC X(60)    VALUE SPACE.         00740000
                                                                        00750000
      ******************************************************************00760000
      *  PARAMETER LIST FOR THE CALENDAR ROUTINE (DPKUT500)            *00770000
      ******************************************************************00780000
           COPY DPWS500.                                                00790000
                                                                        00800000
       01  AC-ABEND-CODE                      PIC S9(04) VALUE ZERO     00810000
                                                        COMP SYNC.      00820000
           88  AC-CONTROL-CARD-ERROR                    VALUE +4003.    00830000
           88  AC-DB2-ERROR                             VALUE +4013.    00840000
           88  AC-CALENDAR-ROUTINE-ERROR                VALUE +4019.    00850000
                                                                        00860000
        01  PS-PROGRAM-SWITCHES.                                        00870000
           05  PS-END-OF-CONTROL-FILE-SW     PIC X(01)  VALUE 'N'.      00880000
               88  PS-END-OF-CONTROL-FILE               VALUE 'Y'.      00890000
           05  PS-END-OF-ADJ-SW              PIC X(01)  VALUE 'N'.      00891000
               88  PS-NOT-END-OF-ADJ-FILE               VALUE 'N'.      00892000
               88  PS-END-OF-ADJ-FILE                   VALUE 'Y'.      00900000
      ******************************************************************00935000
      *   PROGRAM CONSTANTS                                            *00936000
      ******************************************************************00937000
       01  PC-CONSTANTS.                                                00940000
           05  PC-LINE-LIMIT                 PIC S9(04) VALUE +60.      00950000
           05  PC-PROGRAM-NAME               PIC  X(08) VALUE           00980000
                                                       'TCKRP004'.      00990001
           05  PC-REPORT-NBR-1             PIC 9(01)     VALUE 1.       00991000
           05  PC-REPORT-NBR-2             PIC 9(01)     VALUE 2.       00991105
                                                                        00992000
       01  SUBSCRIPTS.                                                  01210020
           05  SUB1                        PIC S9(04)    COMP.          01210120
                                                                        01210220
       01  PV-PROGRAM-VARIABLES.                                        01211020
           05  PV-MISC-COUNT-FIELDS                         COMP-3.     01220000
                10  PV-R1-LINE-CNT           PIC S9(05) VALUE ZERO.     01230003
                10  PV-R2-LINE-CNT           PIC S9(05) VALUE ZERO.     01231003
                10  PV-R1-PAGE-CNT           PIC S9(05) VALUE ZERO.     01240003
                10  PV-R2-PAGE-CNT           PIC S9(05) VALUE ZERO.     01250003
           05  PV-SV-STORE-NUMBER            PIC  X(04) VALUE SPACE.    01260006
           05  PV-PARAGRAPH-NAME             PIC  X(30) VALUE SPACE.    01261006
           05  PV-OPERATION-MSG-1            PIC  X(40) VALUE SPACE.    01270000
           05  PV-OPERATION-MSG-2            PIC  X(40) VALUE SPACE.    01280000
           05  PV-DB2-OPERATION              PIC  X(30) VALUE SPACE.    01290000
           05  PV-POS-CCYY-MM-DD             PIC  X(10).                01300000
           05  PV-CORP-ORIG-TOTAL            PIC  S9(09)V99 VALUE ZERO. 01304208
           05  PV-CORP-ADJ-TOTAL             PIC  S9(09)V99 VALUE ZERO. 01304308
           05  PV-STORE-ORIG-TOTAL           PIC  S9(09)V99 VALUE ZERO. 01304408
           05  PV-STORE-ADJ-TOTAL            PIC  S9(09)V99 VALUE ZERO. 01304508
           05  PV-CARD-NUMBER.                                          01304622
               10  PV-SPACE-CARD-NUMBER      PIC  X(12)                 01304723
                                                  VALUE 'XXXXXXXXXXXX'. 01304823
               10  PV-CARD-NBR               PIC  X(04) VALUE SPACE.    01304923
                                                                        01310019
      ******************************************************************01310100
      *   DATE AND TIME FIELDS.                                        *01310200
      ******************************************************************01310300
       01  PV-DATE-AND-TIME-FIELDS.                                     01310400
           05  PV-MMDDYY-DATE.                                          01310504
               10  PV-MMDDYY-MM            PIC X(02).                   01310604
               10  PV-MMDDYY-DD            PIC X(02).                   01310704
               10  PV-MMDDYY-YY            PIC X(02).                   01310804
           05  PV-YYMMDD-DATE.                                          01310904
               10  PV-YYMMDD-YY            PIC X(02).                   01311004
               10  PV-YYMMDD-MM            PIC X(02).                   01311104
               10  PV-YYMMDD-DD            PIC X(02).                   01311204
           05  PV-CURR-DATE-CCYYMMDD.                                   01311404
               10  PV-CURR-DATE-CCYY       PIC  9(04).                  01311504
               10  PV-CURR-DATE-MM         PIC  9(02).                  01311604
               10  PV-CURR-DATE-DD         PIC  9(02).                  01311704
           05  PV-CURR-TIME.                                            01311804
               10  PV-CURR-TIME-HH         PIC  9(02)    VALUE ZERO.    01311904
               10  PV-CURR-TIME-MM         PIC  9(02)    VALUE ZERO.    01312004
               10  PV-CURR-TIME-SS         PIC  9(02)    VALUE ZERO.    01313004
           05  PV-FMT-DATE.                                             01316004
               10  PV-FMT-MM               PIC  9(02)    VALUE ZERO.    01316104
               10  PV-SLASH-1              PIC  X(01)    VALUE '/'.     01316200
               10  PV-FMT-DD               PIC  9(02)    VALUE ZERO.    01316304
               10  PV-SLASH-2              PIC  X(01)    VALUE '/'.     01316400
               10  PV-FMT-CC               PIC  9(02)    VALUE ZERO.    01316504
               10  PV-FMT-YY               PIC  9(02)    VALUE ZERO.    01316604
                                                                        01316704
       01  TBL-CORP-TOTAL.                                              01316820
           05  TBL-CORP-TOTAL-TABLE OCCURS 30 TIMES.                    01316920
               10  TBL-CORP-DATE           PIC X(10).                   01317020
               10  TBL-CORP-ORIG-AMT       PIC S9(09)V99.               01317120
               10  TBL-CORP-ADJ-AMT        PIC S9(09)V99.               01317220
                                                                        01317320
      ******************************************************************01317420
      *  TOP OF PAGE HEADING LINE FOR PRINTING A 132 CHARACTER REPORT. *01317520
      ******************************************************************01317620
           COPY DPWS132.                                                01317720
                                                                        01317820
      ***************************************************************** 01360100
      *  ADJUSTMENT INPUT FILE                                          01360200
      ******************************************************************01360300
           COPY TCWS005.                                                01360405
                                                                        01360519
      ******************************************************************01910000
      *  HEADING LINES DEBIT ADJUSTMENT REPORTS                        *01920002
      ******************************************************************01930000
       01  R1-TITLE-LINE-1.                                             01940001
           05  FILLER                      PIC  X(44)    VALUE SPACES.  01950001
           05  T1-TITLE                    PIC  X(34)    VALUE          01960001
               'DAILY DEBIT ADJUSTMENT REPORT FOR '.                    01970001
           05  T1-PROCESS-DTE              PIC  X(10)    VALUE SPACES.  01980000
           05  FILLER                      PIC  X(44)    VALUE SPACES.  01990001
                                                                        02000000
       01  R2-TITLE-LINE-1.                                             02001001
           05  FILLER                      PIC  X(40)    VALUE SPACES.  02002001
           05  T2-TITLE                    PIC  X(41)    VALUE          02003006
               'DAILY DEBIT ADJUSTMENT TOTALS REPORT FOR '.             02004005
           05  T2-PROCESS-DTE              PIC  X(10)    VALUE SPACES.  02005001
           05  FILLER                      PIC  X(41)    VALUE SPACES.  02006001
                                                                        02007001
       01  SPACE-REPORT-LINE.                                           02010000
           05  FILLER                      PIC  X(132)   VALUE SPACES.  02020000
                                                                        02061000
       01  H1-COLUMN-HEADING-1.                                         02070003
           05  FILLER                      PIC  X(07)    VALUE SPACES.  02080003
           05  FILLER                      PIC  X(39)    VALUE          02090003
               'O R I G I N A L   I N F O R M A T I O N'.               02100005
           05  FILLER                      PIC  X(25)    VALUE SPACES.  02101003
           05  FILLER                      PIC  X(44)    VALUE          02102003
               'A D J U S T M E N T    I N F O R M A T I O N'.          02103005
           05  FILLER                      PIC  X(17)    VALUE SPACES.  02110003
                                                                        02191003
       01  H1-COLUMN-HEADING-2.                                         02192003
           05  FILLER                      PIC  X(03)    VALUE SPACES.  02193014
           05  FILLER                      PIC  X(04)    VALUE          02194003
               'DATE'.                                                  02195003
           05  FILLER                      PIC  X(04)    VALUE SPACES.  02196013
           05  FILLER                      PIC  X(05)    VALUE          02197003
               'STORE'.                                                 02198003
           05  FILLER                      PIC  X(02)    VALUE SPACES.  02199003
           05  FILLER                      PIC  X(03)    VALUE          02199103
               'REG'.                                                   02199203
           05  FILLER                      PIC  X(01)    VALUE SPACES.  02199313
           05  FILLER                      PIC  X(04)    VALUE          02199403
               'TRAN'.                                                  02199503
           05  FILLER                      PIC  X(03)    VALUE SPACES.  02199614
           05  FILLER                      PIC  X(11)    VALUE          02199703
               'CARD NUMBER'.                                           02199803
           05  FILLER                      PIC  X(05)    VALUE SPACES.  02200014
           05  FILLER                      PIC  X(08)    VALUE          02210001
               'ORIG AMT'.                                              02220001
           05  FILLER                      PIC  X(04)    VALUE SPACES.  02230017
           05  FILLER                      PIC  X(07)    VALUE          02240001
               'ADJ AMT'.                                               02250001
           05  FILLER                      PIC  X(04)    VALUE SPACES.  02260014
           05  FILLER                      PIC  X(04)    VALUE          02270001
               'DATE'.                                                  02280001
           05  FILLER                      PIC  X(07)    VALUE SPACES.  02290018
           05  FILLER                      PIC  X(06)    VALUE          02300001
               'NUMBER'.                                                02310001
           05  FILLER                      PIC  X(05)    VALUE SPACES.  02320018
           05  FILLER                      PIC  X(03)    VALUE          02330001
               'TYP'.                                                   02340001
           05  FILLER                      PIC  X(04)    VALUE SPACES.  02341017
           05  FILLER                      PIC  X(13)    VALUE          02342001
               'ACTION/STATUS'.                                         02343001
           05  FILLER                      PIC  X(02)    VALUE SPACES.  02350017
           05  FILLER                      PIC  X(06)    VALUE          02351001
               'REASON'.                                                02352001
           05  FILLER                      PIC  X(02)    VALUE SPACES.  02352117
           05  FILLER                      PIC  X(12)    VALUE          02352201
               'FRC/SETL DTE'.                                          02352305
                                                                        02360000
       01  H1-COLUMN-HEADING-3.                                         02361003
           05  FILLER                      PIC  X(19)    VALUE          02363001
               'ORIGINATOR COMMENTS'.                                   02364005
           05  FILLER                      PIC  X(113)   VALUE SPACES.  02365001
                                                                        02365101
       01  H1-COLUMN-HEADING-4.                                         02366003
           05  FILLER                      PIC  X(19)    VALUE          02367001
               'RECEIVER COMMENTS  '.                                   02368005
           05  FILLER                      PIC  X(113)   VALUE SPACES.  02369001
                                                                        02369102
       01  H2-COLUMN-HEADING-1.                                         02369202
           05  FILLER                      PIC  X(05)    VALUE          02369602
               'STORE'.                                                 02369702
           05  FILLER                      PIC  X(12)    VALUE SPACES.  02369802
           05  FILLER                      PIC  X(14)    VALUE          02369902
               'ORIGINAL TOTAL'.                                        02370002
           05  FILLER                      PIC  X(07)    VALUE SPACES.  02370102
           05  FILLER                      PIC  X(16)    VALUE          02370202
               'ADJUSTMENT TOTAL'.                                      02370302
           05  FILLER                      PIC  X(78)    VALUE SPACES.  02370402
                                                                        02373202
      ******************************************************************02374000
      *  DETAIL LINE.                                                   02380000
      ******************************************************************02390000
       01  D1-DETAIL-LINE-1.                                            02400000
           05  D1-ORIG-DATE                PIC  X(10).                  02402001
           05  FILLER                      PIC  X(02)    VALUE SPACES.  02403013
           05  D1-STORE                    PIC  X(04).                  02403101
           05  FILLER                      PIC  X(01)    VALUE SPACES.  02404013
           05  D1-REG                      PIC  X(04).                  02405000
           05  FILLER                      PIC  X(01)    VALUE SPACES.  02407013
           05  D1-TRAN                     PIC  X(04).                  02408000
           05  FILLER                      PIC  X(01)    VALUE SPACES.  02409101
           05  D1-CARD-NUMBER              PIC  X(16).                  02409200
           05  FILLER                      PIC  X(01)    VALUE SPACES.  02409402
           05  D1-ORIG-AMT                 PIC  ZZZZZ9.99.              02409513
           05  FILLER                      PIC  X(02)    VALUE SPACES.  02409717
           05  D1-ADJ-AMT                  PIC  ZZZZZ9.99.              02409813
           05  FILLER                      PIC  X(01)    VALUE SPACES.  02410002
           05  D1-ADJ-DATE                 PIC  X(10).                  02410102
           05  FILLER                      PIC  X(01)    VALUE SPACES.  02410302
           05  D1-ADJ-NBR                  PIC  X(12).                  02410402
           05  FILLER                      PIC  X(02)    VALUE SPACES.  02410609
           05  D1-ADJ-TYP                  PIC  X(03).                  02410702
           05  FILLER                      PIC  X(04)    VALUE SPACES.  02410917
           05  D1-TRAN-DISP                PIC  X(12).                  02411002
           05  FILLER                      PIC  X(05)    VALUE SPACES.  02411117
           05  D1-REASON                   PIC  X(03).                  02411210
           05  FILLER                      PIC  X(04)    VALUE SPACES.  02411317
           05  D1-FOR-STTL-DTE             PIC  X(10).                  02411410
                                                                        02412000
       01  D1-DETAIL-LINE-2.                                            02413002
           05  D1-ORIG-COMMENTS            PIC  X(80).                  02414002
           05  FILLER                      PIC  X(52)    VALUE SPACES.  02415002
                                                                        02416002
       01  D1-DETAIL-LINE-3.                                            02417002
           05  D1-RECV-COMMENTS            PIC  X(50).                  02418002
           05  FILLER                      PIC  X(82)    VALUE SPACES.  02419002
                                                                        02420002
      ******************************************************************02421003
      *  STORE TOTAL LINE REPORT 1                                      02422003
      ******************************************************************02423003
       01  T1-STORE-TOT-RPT1.                                           02424003
           05  FILLER                      PIC  X(06)    VALUE          02426006
               'STORE '.                                                02426103
           05  T1-STORE                    PIC  X(04).                  02427003
           05  FILLER                      PIC  X(06)    VALUE          02428006
               ' TOTAL'.                                                02429003
           05  FILLER                      PIC  X(26)    VALUE SPACES.  02429116
           05  T1-STORE-ORIG-AMT           PIC  ZZZZZZZ9.99.            02429603
           05  FILLER                      PIC  X(01)    VALUE SPACES.  02429703
           05  TI-STORE-ADJ-AMT            PIC  ZZZZZZ9.99.             02429816
           05  FILLER                      PIC  X(68)    VALUE SPACES.  02429915
                                                                        02430903
      ******************************************************************02431003
      *  CORPORATE TOTAL LINE REPORT 1                                  02431103
      ******************************************************************02431203
       01  T1-CORP-TOT-RPT1.                                            02431303
           05  FILLER                      PIC  X(15)    VALUE          02431406
               'CORPORATE TOTAL'.                                       02431505
           05  FILLER                      PIC  X(27)    VALUE SPACES.  02431916
           05  T1-CORP-ORIG-AMT            PIC  ZZZZZZZ9.99.            02432003
           05  FILLER                      PIC  X(01)    VALUE SPACES.  02432103
           05  T1-CORP-ADJ-AMT             PIC  ZZZZZZ9.99.             02432216
           05  FILLER                      PIC  X(68)    VALUE SPACES.  02432315
                                                                        02432403
       01  D2-DETAIL-LINE-1.                                            02433003
           05  FILLER                      PIC  X(01)    VALUE SPACES.  02440002
           05  D2-STORE                    PIC  X(04).                  02441002
           05  FILLER                      PIC  X(12)    VALUE SPACES.  02460002
           05  D2-ORIG-TOTAL               PIC  ZZZ,ZZZ,ZZ9.99.         02470002
           05  FILLER                      PIC  X(09)    VALUE SPACES.  02490002
           05  D2-ADJ-TOTAL                PIC  ZZZ,ZZZ,ZZ9.99.         02500002
           05  FILLER                      PIC  X(78)    VALUE SPACES.  02520002
                                                                        02530002
       01  TL-CORP-TOTAL-LINE.                                          02540002
           05  FILLER                      PIC  X(15)    VALUE          02550003
               'CORPORATE TOTAL'.                                       02551005
           05  FILLER                      PIC  X(02)    VALUE SPACES.  02570003
           05  TL-ORIG-TOTAL               PIC  ZZZ,ZZZ,ZZ9.99.         02580002
           05  FILLER                      PIC  X(09)    VALUE SPACES.  02590002
           05  TL-ADJ-TOTAL                PIC  ZZZ,ZZZ,ZZ9.99.         02600002
           05  FILLER                      PIC  X(78)    VALUE SPACES.  02610002
                                                                        02620002
       PROCEDURE DIVISION.                                              02890000
                                                                        02900019
      ******************************************************************02910000
      * 0000-MAINLINE-PARAGRAPH                                         02920000
      ******************************************************************02930000
       0000-MAINLINE-PARAGRAPH.                                         02940000
                                                                        02950000
           PERFORM 1000-INITIALIZE-PROGRAM.                             02960000
                                                                        02961003
           PERFORM 2000-READ-ADJ-FILE.                                  02970000
                                                                        02980000
      ******************************************************************02981003
      * SET SAVE STORE NUMBER ON FIRST READ                             02982003
      ******************************************************************02983003
           MOVE TC005-STORE-NUMBER     TO  PV-SV-STORE-NUMBER.          02990006
                                                                        03000003
           PERFORM 3000-PROCESS                                         03010002
               UNTIL PS-END-OF-ADJ-FILE.                                03020003
                                                                        03053000
           PERFORM 4000-WRITE-CORP-LINES.                               03054003
                                                                        03055003
           CLOSE CONTROL-DATE-FILE                                      03060000
                 ADJ-INPUT-FILE                                         03061000
                 ADJUSTMENT-REPORT                                      03071102
                 ADJUSTMENT-TOTAL-REPORT.                               03071202
                                                                        03080000
           GOBACK.                                                      03090000
                                                                        03100000
      ******************************************************************03120000
      * 1000-INITIALIZE-PROGRAM                                         03130000
      *     OPEN FILES, PROCESS CONTROL CARD                            03140000
      ******************************************************************03150000
       1000-INITIALIZE-PROGRAM.                                         03170000
                                                                        03180000
           OPEN INPUT  CONTROL-DATE-FILE                                03190000
                       ADJ-INPUT-FILE                                   03191000
                OUTPUT ADJUSTMENT-REPORT                                03203002
                       ADJUSTMENT-TOTAL-REPORT.                         03204002
                                                                        03209402
           READ CONTROL-DATE-FILE INTO CC-CONTROL-CARD                  03210100
              AT END                                                    03210200
                 SET PS-END-OF-CONTROL-FILE TO TRUE.                    03210300
                                                                        03210400
           IF PS-END-OF-CONTROL-FILE                                    03210500
              DISPLAY 'DATE CARD MISSING '                              03210600
              MOVE '1000-INITIALIZE-PROGRAM ' TO PV-PARAGRAPH-NAME      03210700
              SET AC-CONTROL-CARD-ERROR TO TRUE                         03210800
              PERFORM 9999-ABEND                                        03210900
           ELSE                                                         03211000
              DISPLAY PC-PROGRAM-NAME ' CONTROL DATE:  '                03211100
                   CC-POS-DATE-MMDDYY                                   03211200
              MOVE CC-POS-DATE-MMDDYY TO PV-MMDDYY-DATE                 03211306
              MOVE 20              TO PV-FMT-CC                         03211404
              MOVE PV-MMDDYY-YY    TO PV-FMT-YY                         03211506
              MOVE PV-MMDDYY-MM    TO PV-FMT-MM                         03211606
              MOVE PV-MMDDYY-DD    TO PV-FMT-DD                         03211706
              MOVE PV-FMT-DATE     TO T1-PROCESS-DTE                    03211804
              MOVE PV-FMT-DATE     TO T2-PROCESS-DTE                    03211911
           END-IF.                                                      03212011
                                                                        03212111
           INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              03212211
                                                                        03212311
           SET  DPG51-ACTUAL-CALENDAR-ONLY   TO TRUE.                   03212411
           SET  DPG51-DO-NOT-INCR-DECR-DATE  TO TRUE.                   03212511
           SET  DPG52-LK-DTE-GREG            TO TRUE.                   03212611
           MOVE CC-POS-DATE-MMDDYY           TO DPG52-LK-DATE-INPUT.    03212711
           CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51 DPG52 DPG53    03212811
                                                   DPG54 DPG55 DPG56.   03212911
           EVALUATE TRUE                                                03213011
               WHEN DPG54-SEVERE-ERROR                                  03213111
               WHEN DPG54-DATE-INVALID                                  03213211
                   MOVE '1000-PROCESS-DATE-CARD'                        03213311
                                                 TO PV-PARAGRAPH-NAME   03213411
                   MOVE 'ERROR CONVERTING INPUT CARD DATE'              03213511
                                                 TO PV-OPERATION-MSG-1  03213611
                   SET AC-CALENDAR-ROUTINE-ERROR TO TRUE                03213711
                   MOVE DPG54-ERROR-MESSAGE      TO PV-OPERATION-MSG-2  03213811
                   PERFORM 9999-ABEND                                   03213911
           END-EVALUATE.                                                03214011
                                                                        03214111
           MOVE DPG55-DB2-ISO-DATE-FMT       TO PV-POS-CCYY-MM-DD.      03214211
                                                                        03214311
           PERFORM 1400-FORMAT-HEADINGS.                                03214411
                                                                        03214519
      ******************************************************************03214611
      * 1400-FORMAT-HEADINGS                                            03215000
      *     GET CURRENT DATE AND TIME FROM SYSTEM.                      03216000
      *     FORMAT REPORT FIELDS IN THE TOP PAGE HEADING LINE.          03217000
      *     FORMAT HEADING LINE 2 WITH CONVERTED POS DATE.              03218000
      ******************************************************************03219000
       1400-FORMAT-HEADINGS.                                            03219100
                                                                        03219200
           MOVE FUNCTION CURRENT-DATE (1:8) TO PV-CURR-DATE-CCYYMMDD.   03219300
           ACCEPT PV-CURR-TIME FROM TIME.                               03219400
                                                                        03219500
           MOVE PV-CURR-DATE-MM             TO DP132-RUN-MONTH.         03219700
           MOVE PV-CURR-DATE-DD             TO DP132-RUN-DAY.           03219800
           MOVE PV-CURR-DATE-CCYY           TO DP132-RUN-YEAR.          03219900
                                                                        03220000
           MOVE PV-CURR-TIME-HH             TO DP132-RUN-HOUR.          03220100
           MOVE PV-CURR-TIME-MM             TO DP132-RUN-MINUTE.        03220200
           MOVE PC-PROGRAM-NAME             TO DP132-PROGRAM-NAME.      03220300
                                                                        03221500
           PERFORM 1450-WRITE-REPORT1-HEADING.                          03221603
           PERFORM 1451-WRITE-REPORT2-HEADING.                          03221703
                                                                        03221803
      ******************************************************************03222003
      * 1450 WRITE-REPORT1-HEADING.                                     03222103
      *     WRITE THE REPORT HEADINGS FOR REPORT ONE                    03222203
      * TITLE = 'DAILY DEBIT ADJUSTMENT REPORT FOR'                     03222303
      *                                                                 03222403
      ******************************************************************03222503
       1450-WRITE-REPORT1-HEADING.                                      03222619
                                                                        03222703
           MOVE +8 TO PV-R1-LINE-CNT.                                   03222804
           ADD  +1 TO PV-R1-PAGE-CNT.                                   03222904
                                                                        03223003
           MOVE PC-REPORT-NBR-1        TO DP132-REPORT-NUMBER.          03223105
           MOVE PV-R1-PAGE-CNT         TO DP132-PAGE-NUMBER.            03223304
                                                                        03223403
            WRITE ADJUSTMENT-REPT-RECORD                                03223503
             FROM DP132-STANDRD-HEADER-132-COLS                         03223603
             AFTER ADVANCING PAGE.                                      03223703
                                                                        03223803
            WRITE ADJUSTMENT-REPT-RECORD                                03223903
             FROM R1-TITLE-LINE-1                                       03224003
             AFTER ADVANCING 1 LINE.                                    03224103
                                                                        03224203
            WRITE ADJUSTMENT-REPT-RECORD                                03224303
             FROM  H1-COLUMN-HEADING-1                                  03224403
             AFTER ADVANCING 2 LINE.                                    03224503
                                                                        03224603
            WRITE ADJUSTMENT-REPT-RECORD                                03224703
             FROM  H1-COLUMN-HEADING-2                                  03224803
             AFTER ADVANCING 2 LINE.                                    03224903
                                                                        03225003
            WRITE ADJUSTMENT-REPT-RECORD                                03225103
             FROM  H1-COLUMN-HEADING-3                                  03225203
             AFTER ADVANCING 1 LINE.                                    03225303
                                                                        03225403
            WRITE ADJUSTMENT-REPT-RECORD                                03225503
             FROM  H1-COLUMN-HEADING-4                                  03225603
             AFTER ADVANCING 1 LINE.                                    03225703
                                                                        03225803
            WRITE ADJUSTMENT-REPT-RECORD                                03225903
             FROM  SPACE-REPORT-LINE                                    03226003
             AFTER ADVANCING 1 LINE.                                    03226103
                                                                        03226203
      ******************************************************************03227003
      * 1450 WRITE-REPORT2-HEADING.                                     03228003
      *     WRITE THE REPORT HEADINGS FOR REPORT TWO                    03229003
      * TITLE = 'DAILY DEBIT ADJUSTMENT TOTALS REPORT FOR '             03230003
      *                                                                 03231003
      ******************************************************************03231103
       1451-WRITE-REPORT2-HEADING.                                      03231219
                                                                        03231303
           MOVE +5 TO PV-R2-LINE-CNT.                                   03231404
           ADD  +1 TO PV-R2-PAGE-CNT.                                   03231504
                                                                        03231603
           MOVE PC-REPORT-NBR-2        TO DP132-REPORT-NUMBER.          03231705
           MOVE PV-R2-PAGE-CNT         TO DP132-PAGE-NUMBER.            03231905
                                                                        03232003
           WRITE ADJ-TOTAL-REPT-RECORD                                  03232104
            FROM DP132-STANDRD-HEADER-132-COLS                          03232204
            AFTER ADVANCING PAGE.                                       03232304
                                                                        03232403
           WRITE ADJ-TOTAL-REPT-RECORD                                  03232504
            FROM R2-TITLE-LINE-1                                        03232604
            AFTER ADVANCING 1 LINE.                                     03232704
                                                                        03232803
           WRITE ADJ-TOTAL-REPT-RECORD                                  03232904
            FROM  H2-COLUMN-HEADING-1                                   03233004
            AFTER ADVANCING 3 LINE.                                     03233104
                                                                        03233203
           WRITE ADJ-TOTAL-REPT-RECORD                                  03233304
            FROM  SPACE-REPORT-LINE                                     03233404
            AFTER ADVANCING 1 LINE.                                     03233504
                                                                        03233603
      ******************************************************************03233803
      * 2000-READ-INPUT-FILE                                            03233903
      *     READ THE ADJUSTMENT INPUT FILE                              03234003
      ******************************************************************03234103
       2000-READ-ADJ-FILE.                                              03234219
                                                                        03234303
           READ ADJ-INPUT-FILE  INTO TC005-ADJUSTMENT-FILE              03234403
               AT END                                                   03234503
                   SET PS-END-OF-ADJ-FILE TO TRUE                       03234603
           END-READ.                                                    03234703
                                                                        03234803
      ***************************************************************** 04470000
      * 3000-PROCESS                                                    04480003
      *        PROCESS THROUGH THE ADJUSTMENT INPUT RECORDS WITH        04490003
      * CONTROL BREAKS ON STORE NUMBER.                                 04491003
      * CONTROL BREAKS SHOW THE STORE TOTALS ON BOTH REPORTS            04492018
      * AT END SHOW THE CORPORATE TOTAL                                 04493003
      ***************************************************************** 04500000
       3000-PROCESS.                                                    04501019
                                                                        04502019
           IF TC005-STORE-NUMBER    NOT = PV-SV-STORE-NUMBER            04510006
               PERFORM 3100-WRITE-STORE-TOTALS                          04520006
               ADD PV-STORE-ORIG-TOTAL TO PV-CORP-ORIG-TOTAL            04530006
               ADD PV-STORE-ADJ-TOTAL  TO PV-CORP-ADJ-TOTAL             04540006
               MOVE TC005-STORE-NUMBER TO  PV-SV-STORE-NUMBER           04541006
               MOVE 0                  TO PV-STORE-ORIG-TOTAL           04550006
               MOVE 0                  TO PV-STORE-ADJ-TOTAL            04560006
           END-IF.                                                      04570006
                                                                        04580003
           PERFORM 3200-WRITE-DETAIL-LINES.                             04590006
                                                                        04591004
           ADD TC005-ORIG-TRANS-AMT    TO PV-STORE-ORIG-TOTAL.          04600006
           ADD TC005-ADJUST-AMT        TO PV-STORE-ADJ-TOTAL.           04610006
                                                                        04620003
           PERFORM 2000-READ-ADJ-FILE.                                  04630006
                                                                        04632003
      ******************************************************************04633018
      *  3100-WRITE-STORE-TOTALS                                        04634018
      *     WRITE THE STORE CONTROL BREAK LINE TO THE REPORT            04635018
      ******************************************************************04636018
       3100-WRITE-STORE-TOTALS.                                         04640003
                                                                        04700003
            MOVE PV-SV-STORE-NUMBER    TO T1-STORE.                     04700406
            MOVE PV-STORE-ORIG-TOTAL   TO T1-STORE-ORIG-AMT.            04700806
            MOVE PV-STORE-ADJ-TOTAL    TO TI-STORE-ADJ-AMT.             04701006
            MOVE PV-SV-STORE-NUMBER    TO D2-STORE.                     04701106
            MOVE PV-STORE-ORIG-TOTAL   TO D2-ORIG-TOTAL.                04701206
            MOVE PV-STORE-ADJ-TOTAL    TO D2-ADJ-TOTAL.                 04701306
                                                                        04701403
            IF PV-R1-LINE-CNT > 55                                      04701505
                PERFORM 1450-WRITE-REPORT1-HEADING                      04701603
            END-IF.                                                     04701703
                                                                        04701803
            WRITE ADJUSTMENT-REPT-RECORD                                04701903
             FROM T1-STORE-TOT-RPT1                                     04702003
             AFTER ADVANCING 1 LINE.                                    04702103
                                                                        04702203
            WRITE ADJUSTMENT-REPT-RECORD                                04702303
             FROM SPACE-REPORT-LINE                                     04702403
             AFTER ADVANCING 1 LINE.                                    04702503
                                                                        04702603
            ADD  +2                    TO PV-R1-LINE-CNT.               04702703
                                                                        04702803
            IF PV-R2-LINE-CNT > 57                                      04702905
                PERFORM 1451-WRITE-REPORT2-HEADING                      04703003
            END-IF.                                                     04703103
                                                                        04703203
            WRITE ADJ-TOTAL-REPT-RECORD                                 04703303
             FROM D2-DETAIL-LINE-1                                      04703403
             AFTER ADVANCING 1 LINE.                                    04703503
                                                                        04703603
            ADD  +1                    TO PV-R2-LINE-CNT.               04703703
                                                                        04704003
      ******************************************************************04705018
      * 3200-WRITE-DETAIL-LINES                                         04706018
      *     WRITE THE 3 DETAIL LINES TO THE REPORT                      04707018
      *      1ST LINE IS INFORMATION                                    04707118
      *      2ND LINE IS ORIGINATOR COMMENTS                            04707218
      *      3RD LINE IS RECEIVER COMMENTS                              04707318
      ******************************************************************04708018
       3200-WRITE-DETAIL-LINES.                                         04710003
                                                                        04711003
            MOVE TC005-ORIG-TRAN-DTE   TO PV-YYMMDD-DATE.               04713006
            MOVE 20                    TO PV-FMT-CC.                    04713104
            MOVE PV-YYMMDD-YY          TO PV-FMT-YY.                    04713204
            MOVE PV-YYMMDD-MM          TO PV-FMT-MM.                    04713304
            MOVE PV-YYMMDD-DD          TO PV-FMT-DD.                    04713404
            MOVE PV-FMT-DATE           TO D1-ORIG-DATE.                 04714005
            MOVE TC005-STORE-NUMBER    TO D1-STORE.                     04715005
            MOVE TC005-REG-NBR         TO D1-REG.                       04717005
            MOVE TC005-TRAN-NBR        TO D1-TRAN.                      04719005
            MOVE TC005-PRI-CARD-NBR    TO PV-CARD-NUMBER.               04719222
            MOVE 'XXXXXXXXXXXX'        TO PV-SPACE-CARD-NUMBER.         04719323
            MOVE PV-CARD-NUMBER        TO D1-CARD-NUMBER.               04719423
            MOVE TC005-ORIG-TRANS-AMT  TO D1-ORIG-AMT.                  04719505
            MOVE TC005-ADJUST-AMT      TO D1-ADJ-AMT.                   04719605
            MOVE TC005-STTLMNT-DATE    TO PV-YYMMDD-DATE.               04719906
            MOVE 20                    TO PV-FMT-CC.                    04720004
            MOVE PV-YYMMDD-YY          TO PV-FMT-YY.                    04720104
            MOVE PV-YYMMDD-MM          TO PV-FMT-MM.                    04720204
            MOVE PV-YYMMDD-DD          TO PV-FMT-DD.                    04720304
            MOVE PV-FMT-DATE           TO D1-ADJ-DATE.                  04720405
            MOVE TC005-ADJ-NBR         TO D1-ADJ-NBR.                   04720505
            MOVE TC005-ADJUST-TYP      TO D1-ADJ-TYP.                   04720606
            MOVE TC005-ADJ-REASON      TO D1-REASON.                    04720710
                                                                        04720810
            EVALUATE TC005-TRAN-DISP                                    04720910
                WHEN '100'                                              04721021
                    MOVE 'NEW ITEM    '                                 04721121
                                       TO D1-TRAN-DISP                  04721210
                WHEN '101'                                              04721321
                    MOVE 'DELETE      '                                 04721421
                                       TO D1-TRAN-DISP                  04721521
                WHEN '102'                                              04721621
                    MOVE 'UPDATE      '                                 04721721
                                       TO D1-TRAN-DISP                  04721821
                WHEN '103'                                              04721921
                    MOVE 'REMINDER    '                                 04722021
                                       TO D1-TRAN-DISP                  04722121
                WHEN '110'                                              04722221
                    MOVE 'AUTH PAYMENT'                                 04722321
                                       TO D1-TRAN-DISP                  04722421
                WHEN '111'                                              04722521
                    MOVE 'REQ PAY FRC '                                 04722621
                                       TO D1-TRAN-DISP                  04722721
                WHEN '112'                                              04722821
                    MOVE 'REQ PAY APPR'                                 04722921
                                       TO D1-TRAN-DISP                  04723021
                WHEN '115'                                              04723121
                    MOVE 'DENIED      '                                 04723221
                                       TO D1-TRAN-DISP                  04723321
            END-EVALUATE.                                               04723421
                                                                        04723521
            MOVE TC005-FORCE-STTL-DTE  TO PV-YYMMDD-DATE.               04723621
            MOVE 20                    TO PV-FMT-CC.                    04723721
            MOVE PV-YYMMDD-YY          TO PV-FMT-YY.                    04723821
            MOVE PV-YYMMDD-MM          TO PV-FMT-MM.                    04723921
            MOVE PV-YYMMDD-DD          TO PV-FMT-DD.                    04724021
            MOVE PV-FMT-DATE           TO D1-FOR-STTL-DTE.              04724121
                                                                        04724221
            MOVE TC005-ORIG-COMMENTS   TO D1-ORIG-COMMENTS.             04724321
            MOVE TC005-RECV-COMMENTS   TO D1-RECV-COMMENTS.             04724421
                                                                        04724521
            IF PV-R1-LINE-CNT > 56                                      04725021
                PERFORM 1450-WRITE-REPORT1-HEADING                      04730003
            END-IF.                                                     04740003
                                                                        04750003
            WRITE ADJUSTMENT-REPT-RECORD                                04760003
             FROM D1-DETAIL-LINE-1                                      04770003
             AFTER ADVANCING 1 LINE.                                    04780003
                                                                        04790003
            WRITE ADJUSTMENT-REPT-RECORD                                04800003
             FROM D1-DETAIL-LINE-2                                      04810003
             AFTER ADVANCING 1 LINE.                                    04820003
                                                                        04830003
            WRITE ADJUSTMENT-REPT-RECORD                                04840003
             FROM D1-DETAIL-LINE-3                                      04850003
             AFTER ADVANCING 1 LINE.                                    04860003
                                                                        04870003
            WRITE ADJUSTMENT-REPT-RECORD                                04880003
             FROM SPACE-REPORT-LINE                                     04890003
             AFTER ADVANCING 1 LINE.                                    04900003
                                                                        04910003
            ADD  +4                    TO PV-R1-LINE-CNT.               04920003
                                                                        04930003
      ******************************************************************04931018
      * 4000-WRITE-CORP-LINES                                           04932018
      *     WRITE THE LAST CONTROL BREAK (STORE) LINE                   04933018
      *      WRITES THE CORPORATE TOTAL LINES ON REPORT                 04934018
      ******************************************************************04937018
       4000-WRITE-CORP-LINES.                                           04940005
                                                                        04950005
            PERFORM 3100-WRITE-STORE-TOTALS                             04950109
            ADD PV-STORE-ORIG-TOTAL    TO PV-CORP-ORIG-TOTAL            04950209
            ADD PV-STORE-ADJ-TOTAL     TO PV-CORP-ADJ-TOTAL             04950309
                                                                        04950409
            MOVE PV-CORP-ORIG-TOTAL    TO T1-CORP-ORIG-AMT.             04950507
            MOVE PV-CORP-ADJ-TOTAL     TO T1-CORP-ADJ-AMT.              04950607
            MOVE PV-CORP-ORIG-TOTAL    TO TL-ORIG-TOTAL.                04950707
            MOVE PV-CORP-ADJ-TOTAL     TO TL-ADJ-TOTAL.                 04950807
                                                                        04950905
            WRITE ADJUSTMENT-REPT-RECORD                                04951005
             FROM T1-CORP-TOT-RPT1                                      04952005
             AFTER ADVANCING 2 LINE.                                    04953005
                                                                        04959305
            WRITE ADJ-TOTAL-REPT-RECORD                                 04959405
             FROM TL-CORP-TOTAL-LINE                                    04959505
             AFTER ADVANCING 2 LINE.                                    04959605
                                                                        04959705
      ******************************************************************05220000
      * 9999-ABEND                                                      05230000
      *     ABEND PROGRAM WHEN A NON-DB2 ERROR OCCURS.                  05240000
      ******************************************************************05250000
       9999-ABEND.                                                      05260000
           DISPLAY '** ABEND           **'.                             05270000
           DISPLAY '** PROGRAM         ** = ' PC-PROGRAM-NAME.          05280000
           DISPLAY '** PARAGRAPH       ** = ' PV-PARAGRAPH-NAME.        05290000
           DISPLAY '** OPERATION       ** = ' PV-OPERATION-MSG-1.       05300000
           DISPLAY '**                 ** = ' PV-OPERATION-MSG-2.       05310000
           CALL 'ILBOABN0' USING AC-ABEND-CODE.                         05320000
