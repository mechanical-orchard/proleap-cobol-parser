000100 IDENTIFICATION DIVISION.                                         00010030
000200 PROGRAM-ID.    POKRP081.                                         00020030
000300 AUTHOR.        CHRIS KUNSTMANN IBS.                              00030030
000400 INSTALLATION.  KOHLS.                                            00040030
000500 DATE-WRITTEN.  09/99.                                            00050030
000600 DATE-COMPILED.                                                   00060030
000700***************************************************************** 00070030
000800*     PRINT PREPACK SHIPPING INSTRUCTIONS                       * 00080030
000900*                                                               * 00090030
001000* THIS PROGRAM WILL GENERATE SHIPPING INSTRUCTIONS FOR A        * 00100030
001100* PREPACK (PACKAGING CODE M OR I ) PO ONLY. ALL OTHER PO'S ARE  * 00110030
001200* STILL PROCESSED THROUGH POKCS004.                             * 00120030
001300***************************************************************** 00130030
001400* DATE     WHO      DESCRIPTION                                 * 00140030
001410***************************************************************** 00150040
001420* TKMA888 04/18/2003 - CHANGED REPORT LAYOUT LINES FOR PRINTING   00160040
001430* BILL SCHROEDER       INSTRUCTIONS ON MULTI PACKS                00170040
001440* STRATAGEM, INC.                                                 00180040
001500***************************************************************** 00190036
W24803* 05/16/03 - S PRABHAKAR RAO, IGSI - WR NO. 24803                 00200049
W24803*    - REPLACED DEPARTMENT, CLASS AND 3 DIGIT SEQUENCE NUMBER     00210049
W24803*      WITH DEPARTMENT, SUB CLASS, MAJOR CLASS AND SKU NUMBER     00220049
W24803*      RESPECTIVELY FOR NI SKU CONVERSION.                        00230049
W24803***************************************************************** 00240049
W24803* 01/13/14 - SUE BARTELT  - CHG0081355                            00250069
W24803*    - CHANGES MADE FOR MTK PO PACKAGING CODE CHANGES             00260068
W24803*      ADDED NEW PARAGRAPH 1110-GET-TPOPRPK TO GET PREPK-TYP-CDE  00270068
W24803*      THIS PARA IS CALLED FROM 1100-GET-HEADER-INFO.             00280068
W24803*      ADD TPOPRPK.PREPK_TYP_CDE TO SELECT IN APP-PREPACK-CSR     00290068
W24803*      IN 2330-PROCESS-INSTRUCTION REPLACE PURCHS-PKGNG-CDE = I   00300068
W24803*      WITH POPRPK-PREPK-TYP-CDE = I, IN 2343-PROCESS-PREPACK-CSR 00310068
W24803*      REPLACE PURCHS-PKGNG-CDE = I WITH POPRPK-PREPK-TYP-CDE = I 00320068
W24803***************************************************************** 00330068
C98147* 11/04/2014 - LINDA FRIESS - CHG0098147                          00340071
C98147*   EXPANDED PO NUMBER IN REPORT TO 8 DIGITS.                     00350071
C98147***************************************************************** 00360071
001600 ENVIRONMENT DIVISION.                                            00370030
001700 CONFIGURATION SECTION.                                           00380030
001800 SOURCE-COMPUTER. IBM-3090.                                       00390030
001900 OBJECT-COMPUTER. IBM-3090.                                       00400030
002000 INPUT-OUTPUT SECTION.                                            00410030
002100 FILE-CONTROL.                                                    00420030
002200                                                                  00430030
002300     SELECT INPUT-FILE                                            00440030
002400         ASSIGN TO INP01.                                         00450030
002500     SELECT POSIRPT-FILE                                          00460030
002600         ASSIGN TO RPT01.                                         00470030
002700                                                                  00480030
002800******************************************************************00490030
002900 DATA DIVISION.                                                   00500030
003000******************************************************************00510030
003100 FILE SECTION.                                                    00520030
003200                                                                  00530030
003300 FD  INPUT-FILE                                                   00540030
003400     RECORDING MODE IS F                                          00550030
003500     LABEL RECORDS ARE STANDARD                                   00560030
003600     RECORD CONTAINS 80 CHARACTERS                                00570030
003700     BLOCK CONTAINS 0 RECORDS.                                    00580030
003800 01  INPUT-RECORD                     PIC  X(80).                 00590030
003900                                                                  00600030
004000 FD  POSIRPT-FILE                                                 00610030
004100     RECORDING MODE F                                             00620030
004200     BLOCK CONTAINS 0 RECORDS                                     00630030
004300     RECORD CONTAINS 150 CHARACTERS                               00640030
004400     LABEL RECORDS ARE OMITTED                                    00650030
004500     DATA RECORD IS POSIRPT-RECORD.                               00660030
004600 01  POSIRPT-RECORD                   PIC  X(150).                00670030
004700                                                                  00680030
004800 WORKING-STORAGE SECTION.                                         00690030
004900                                                                  00700030
005000 01  IR-INPUT-RECORD.                                             00710030
005100     05  IR-PO-NBR                    PIC S9(09) COMP.            00720030
005200     05  IR-RPT-TYPE-BY               PIC  X(02).                 00730030
005300     05  IR-RPT-TYPE-VN               PIC  X(02).                 00740030
005400     05  FILLER                       PIC  X(72).                 00750030
005500                                                                  00760030
005600 01  SD-SYSTEM-DATE.                                              00770030
005700     05  SD-SYSTEM-YY                 PIC  9(02) VALUE ZEROES.    00780030
005800     05  SD-SYSTEM-MM                 PIC  9(02) VALUE ZEROES.    00790030
005900     05  SD-SYSTEM-DD                 PIC  9(02) VALUE ZEROES.    00800030
006000                                                                  00810030
006100 01  ST-SYSTEM-TIME.                                              00820030
006200     05  ST-SYSTEM-HH                 PIC  9(02) VALUE ZEROES.    00830030
006300     05  ST-SYSTEM-MM                 PIC  9(02) VALUE ZEROES.    00840030
006400     05  ST-SYSTEM-SS                 PIC  9(02) VALUE ZEROES.    00850030
006500     05  FILLER                       PIC  9(02) VALUE ZEROES.    00860030
006600                                                                  00870030
006700 01  PS-PROGRAM-SWITCHES.                                         00880030
006800     05  PS-EOF-SHIP-CSR-SW           PIC  X(01) VALUE 'N'.       00890030
006900         88  PS-EOF-SHIP-CSR                     VALUE 'Y'.       00900030
007000         88  PS-NOT-EOF-SHIP-CSR                 VALUE 'N'.       00910030
007100     05  PS-EOF-PREPACK-CSR-SW        PIC  X(01) VALUE 'N'.       00920030
007200         88  PS-EOF-PREPACK-CSR                  VALUE 'Y'.       00930030
007300         88  PS-NOT-EOF-PREPACK-CSR              VALUE 'N'.       00940030
007400     05  PS-EOF-PO-LINE-CSR-SW        PIC  X(01) VALUE 'N'.       00950030
007500         88  PS-EOF-PO-LINE-CSR                  VALUE 'Y'.       00960030
007600         88  PS-NOT-EOF-PO-LINE-CSR              VALUE 'N'.       00970030
007700     05  PS-EOF-TALLPLN-CSR-SW        PIC  X(01) VALUE 'N'.       00980030
007800         88  PS-EOF-TALLPLN-CSR                  VALUE 'Y'.       00990030
007900         88  PS-NOT-EOF-TALLPLN-CSR              VALUE 'N'.       01000030
008000                                                                  01010030
008100 01  PC-PROGRAM-CONSTANTS.                                        01020030
008200     05  PC-INIT-DATE                 PIC  X(10) VALUE            01030030
008300                                                     '0001-01-01'.01040030
008400     05  PC-DPKUT410                  PIC  X(08) VALUE 'DPKUT410'.01050038
008500     05  PC-LINE-MAX                  PIC S9(04) VALUE +60.       01060039
008600     05  PC-MULTI-INSTR1              PIC  X(60) VALUE            01070039
008700       'SHIPMENT CONTAINS MULTI SKU/UPC PACKS. PLEASE ENSURE    '.01080039
008800     05  PC-MULTI-INSTR2              PIC  X(60) VALUE            01090039
008900       'CARTONS ARE PACKED AS DEFINED ON THE ORDER.             '.01100039
009000     05  PC-INNER-INSTR1              PIC  X(60) VALUE            01110039
009100       'SHIPMENT CONTAINS MULTI SKU/UPC PACKS WITH DEFINED INNER'.01120039
009200     05  PC-INNER-INSTR2              PIC  X(60) VALUE            01130039
009300       'PACK QUANTITIES. SEE P.O. FOR SPECIFIC INNER PACK ITEMS.'.01140039
009400                                                                  01150039
009500 01  PV-PROGRAM-VARIABLES.                                        01160039
009600     05  PV-PO-NBR                    PIC S9(09) VALUE +0 COMP.   01170039
009700     05  PV-ABEND-PARAGRAPH           PIC  X(30) VALUE SPACES.    01180039
009800     05  PV-ABEND-CODE                PIC S9(04) VALUE +0         01190039
009900                                                 COMP.            01200039
010000     05  PV-NULL-IND                  PIC S9(04) VALUE +0         01210039
010100                                                 COMP.            01220039
010200     05  PV-DB2-COUNT                 PIC S9(09) VALUE +0         01230039
010300                                                 COMP-3.          01240039
010400     05  PV-QUOTIENT                  PIC S9(04) VALUE +0         01250039
010500                                                 COMP.            01260039
010600     05  PV-REMAINDER                 PIC S9(04) VALUE +0         01270039
010700                                                 COMP.            01280039
010800     05  PV-SHIP-NBR                  PIC S9(03) VALUE +0.        01290039
010900     05  PV-DATE-BREAK.                                           01300039
011000         10  PV-DB-CC                 PIC  X(02).                 01310039
011100         10  PV-DB-YY                 PIC  X(02).                 01320039
011200         10  FILLER                   PIC  X(01).                 01330039
011300         10  PV-DB-MM                 PIC  X(02).                 01340039
011400         10  FILLER                   PIC  X(01).                 01350039
011500         10  PV-DB-DD                 PIC  X(02).                 01360039
011600     05  PV-DATE-BREAK-SLASH.                                     01370039
011700         10  PV-DBS-MM                PIC  X(02).                 01380039
011800         10  FILLER                   PIC  X(01) VALUE '/'.       01390039
011900         10  PV-DBS-DD                PIC  X(02).                 01400039
012000         10  FILLER                   PIC  X(01) VALUE '/'.       01410039
012100         10  PV-DBS-YY                PIC  X(02).                 01420039
012200     05  PV-EDIT-ZIP-CODE             PIC  X(10).                 01430063
012300     05  PV-EDIT-ZIP-NO-DASH REDEFINES PV-EDIT-ZIP-CODE.          01440063
012400         10  PV-EZND-1-5              PIC  X(05).                 01450063
012500         10  PV-EZND-6-9              PIC  X(04).                 01460063
               10  FILLER                   PIC  X(01).                 01470063
           05  PV-EDIT-ZIP-DASH REDEFINES PV-EDIT-ZIP-CODE.             01480063
               10  PV-EZD-1-5               PIC  X(05).                 01490063
               10  PV-EZD-DASH              PIC  X(01).                 01500063
               10  PV-EZD-6-9               PIC  X(04).                 01510063
012600     05  PV-ZIP-CODE-DISPLAY.                                     01520039
012700         10  PV-ZCD-1-5               PIC  X(05).                 01530039
012800         10  FILLER                   PIC  X(01) VALUE '-'.       01540039
012900         10  PV-ZCD-6-9               PIC  X(04).                 01550039
013000     05  PV-CITY                      PIC  X(15).                 01560039
013100     05  PV-STATE-PROV                PIC  X(30).                 01570039
013200     05  PV-COUNTRY                   PIC  X(30).                 01580039
013300     05  PV-LINE-QTY                  PIC S9(09) COMP-3.          01590039
013400     05  PV-UNITS-CARTON              PIC S9(09) COMP-3.          01600039
013500     05  PV-PO-PREPK-ID               PIC S9(04) COMP-3.          01610039
W24803     05  PV-NULL-INDICATOR-VARIABLES.                             01620051
W24803         10 PV-MAJ-CL-NBR-IND         PIC S9(04) COMP VALUE +0.   01630051
W24803         10 PV-SUB-CL-NBR-IND         PIC S9(04) COMP VALUE +0.   01640051
W24803         10 PV-SKU-NBR-IND            PIC S9(04) COMP VALUE +0.   01650051
W24803         10 PV-VS-NBR-IND             PIC S9(04) COMP VALUE +0.   01660051
W24803         10 PV-SKU-DESC-IND           PIC S9(04) COMP VALUE +0.   01670051
W24803         10 PV-CSTM-CLOR-DESC-IND     PIC S9(04) COMP VALUE +0.   01680051
W24803         10 PV-SIZE-DESC-IND          PIC S9(04) COMP VALUE +0.   01690051
W24803     05  PV-TEMP-SKU.                                             01700051
W24803         10 PV-TEMP-DEPT              PIC 9(03)  VALUE ZEROES.    01710057
W24803         10 PV-TEMP-CLASS             PIC 9(02)  VALUE ZEROES.    01720057
W24803         10 PV-TEMP-SEQ               PIC 9(03)  VALUE ZEROES.    01730057
W24803     05  PV-TEMP-MAJ-CL.                                          01740052
W24803         10 PV-TEMP-MAJ-CL-1          PIC 9(01)  VALUE 0.         01750051
W24803         10 FILLER                    PIC 9(01)  VALUE 0.         01760051
W24803     05  PV-CLASS                     PIC 9(02)  VALUE 0.         01770051
W24803     05  PV-SKU                       PIC 9(08)  VALUE 0.         01780051
013600                                                                  01790039
013700 01  PV-REPORT-CONTROLS.                                          01800039
013800     05  PV-PAGE-CNT                  PIC S9(07) VALUE  0         01810039
013900                                                 COMP-3.          01820039
014000     05  PV-LINE-CNT                  PIC S9(03) VALUE +0.        01830039
014100                                                                  01840039
014200******************************************************************01850039
014300*  COMMUNICATIONS AREA2 FOR DB2                                   01860039
014400******************************************************************01870039
014500     COPY SQLCA2.                                                 01880039
014600                                                                  01890039
014700******************************************************************01900039
014800*  WORKING STORAGE AREA FOR NAME REFORMAT DPPD024                 01910039
014900******************************************************************01920039
015000     COPY DPWS024.                                                01930039
015100                                                                  01940039
015200******************************************************************01950039
015300*  WORKING STORAGE AREA FOR COUNTRY AND STATE RETRIEVAL           01960039
015400******************************************************************01970039
015500     COPY DPWS410.                                                01980039
015600                                                                  01990039
015700******************************************************************02000039
015800*  PURCHASE ORDER REPORT PRINT LINES                              02010039
015900******************************************************************02020039
016000 01  HEADER-LINE1.                                                02030039
016100     05  FILLER                       PIC  X(11) VALUE            02040039
016200         'PO NUMBER: '.                                           02050039
C98147     05  HL1-PO-NBR                   PIC  ZZZZZZZZ.              02060071
C98147     05  FILLER                       PIC  X(03) VALUE SPACES.    02070071
016500     05  FILLER                       PIC  X(12) VALUE            02080039
016600         'ORDER DATE: '.                                          02090039
016700     05  HL1-ORD-DATE                 PIC  X(08).                 02100039
016800     05  FILLER                       PIC  X(09) VALUE SPACES.    02110039
016900     05  FILLER                       PIC  X(08) VALUE 'K O H L '.02120039
017000     05  FILLER                       PIC  X(01) VALUE QUOTE.     02130039
017100     05  FILLER                       PIC  X(38) VALUE            02140039
017200         ' S   D E P A R T M E N T   S T O R E S'.                02150039
017300     05  FILLER                       PIC  X(18) VALUE SPACES.    02160039
017400     05  FILLER                       PIC  X(06) VALUE 'DATE: '.  02170039
017500     05  HL1-RUN-MONTH                PIC  X(02).                 02180039
017600     05  FILLER                       PIC  X(01) VALUE '/'.       02190039
017700     05  HL1-RUN-DAY                  PIC  X(02).                 02200039
017800     05  FILLER                       PIC  X(01) VALUE '/'.       02210039
017900     05  HL1-RUN-YEAR                 PIC  X(02).                 02220039
018000     05  FILLER                       PIC  X(06) VALUE SPACES.    02230039
018100     05  FILLER                       PIC  X(06) VALUE 'TIME: '.  02240039
018200     05  HL1-RUN-HOUR                 PIC  X(02).                 02250039
018300     05  FILLER                       PIC  X(01) VALUE ':'.       02260039
018400     05  HL1-RUN-MINUTE               PIC  X(02).                 02270039
018500     05  FILLER                       PIC  X(01) VALUE ':'.       02280039
018600     05  HL1-RUN-SECOND               PIC  X(02).                 02290039
018700                                                                  02300039
018800 01  HEADER-LINE2.                                                02310039
018900     05  FILLER                       PIC  X(11) VALUE            02320039
019000         'DEPT.....: '.                                           02330039
019100     05  HL2-DEPT-NBR                 PIC  X(03).                 02340039
019200     05  FILLER                       PIC  X(02) VALUE SPACES.    02350039
019300     05  HL2-DEPT-NAME                PIC  X(25).                 02360039
019400     05  FILLER                       PIC  X(13) VALUE SPACES.    02370039
019500     05  FILLER                       PIC  X(41) VALUE            02380039
019600         'S H I P P I N G   I N S T R U C T I O N S'.             02390039
019700     05  FILLER                       PIC  X(41) VALUE SPACES.    02400039
019800     05  FILLER                       PIC  X(06) VALUE 'PAGE: '.  02410039
019900     05  HL2-PAGE                     PIC  ZZZZ,ZZZ.              02420039
020000                                                                  02430039
020100 01  HEADER-LINE3.                                                02440039
020200     05  FILLER                       PIC  X(69) VALUE SPACES.    02450039
020300     05  HL3-VERSION                  PIC  X(12).                 02460039
020400     05  FILLER                       PIC  X(69) VALUE SPACES.    02470039
020500                                                                  02480039
020600 01  HEADER-LINE4.                                                02490039
020700     05  FILLER                       PIC  X(20) VALUE            02500039
020800         ' ** S H I P M E N T '.                                  02510039
020900     05  HL4-SHIP-NBR                 PIC  ZZZ.                   02520039
021000     05  FILLER                       PIC  X(06) VALUE '  O F '.  02530039
021100     05  HL4-NBR-SHIP                 PIC  ZZZ.                   02540039
021200     05  FILLER                       PIC  X(03) VALUE ' **'.     02550039
021300     05  FILLER                       PIC  X(17) VALUE SPACES.    02560039
021400     05  FILLER                       PIC  X(10) VALUE            02570039
021500         ' VENDOR.: '.                                            02580039
021600     05  HL4-VEND-NAME                PIC  X(30).                 02590039
021700     05  FILLER                       PIC  X(12) VALUE SPACES.    02600039
021800     05  FILLER                       PIC  X(21) VALUE            02610039
021900         'TOTAL PACKS....:     '.                                 02620039
022000     05  HL4-PACKS                    PIC  Z,ZZ9.                 02630039
022100     05  FILLER                       PIC  X(20) VALUE SPACES.    02640039
022200                                                                  02650039
022300 01  HEADER-LINE5.                                                02660039
022400     05  FILLER                       PIC  X(10) VALUE            02670039
022500         ' SHIP TO: '.                                            02680039
022600     05  HL5-SHIP-TO-NAME             PIC  X(30).                 02690039
022700     05  FILLER                       PIC  X(22) VALUE SPACES.    02700039
022800     05  HL5-VEND-ADDR-1              PIC  X(40).                 02710039
022900     05  FILLER                       PIC  X(02) VALUE SPACES.    02720039
023000     05  FILLER                       PIC  X(17) VALUE            02730039
023100         'TOTAL UNITS....: '.                                     02740039
023200     05  HL5-UNITS                    PIC  Z,ZZZ,ZZ9.             02750039
023300     05  FILLER                       PIC  X(20) VALUE SPACES.    02760039
023400                                                                  02770039
023500 01  HEADER-LINE6.                                                02780039
023600     05  FILLER                       PIC  X(10) VALUE SPACES.    02790039
023700     05  HL6-SHIP-TO-ADDR-1           PIC  X(40).                 02800039
023800     05  FILLER                       PIC  X(12) VALUE SPACES.    02810039
023900     05  HL6-VEND-ADDR-2              PIC  X(40).                 02820039
024000     05  FILLER                       PIC  X(02) VALUE SPACES.    02830039
024100     05  FILLER                       PIC  X(21) VALUE            02840039
024200         'TOTAL LINES....:     '.                                 02850039
024300     05  HL6-LINES                    PIC  Z,ZZ9.                 02860039
024400     05  FILLER                       PIC  X(20) VALUE SPACES.    02870039
024500                                                                  02880039
024600 01  HEADER-LINE7.                                                02890039
024700     05  FILLER                       PIC  X(10) VALUE SPACES.    02900039
024800     05  HL7-SHIP-TO-ADDR-2           PIC  X(40).                 02910039
024900     05  FILLER                       PIC  X(12) VALUE SPACES.    02920039
025000     05  HL7-VEND-ADDR-3              PIC  X(40).                 02930039
025100     05  FILLER                       PIC  X(02) VALUE SPACES.    02940039
025200     05  FILLER                       PIC  X(21) VALUE            02950039
025300         'TOTAL SKUS.....:     '.                                 02960039
025400     05  HL7-SKUS                     PIC  Z,ZZ9.                 02970039
025500     05  FILLER                       PIC  X(20) VALUE SPACES.    02980039
025600                                                                  02990039
025700 01  HEADER-LINE8-A.                                              03000039
025800     05  FILLER                       PIC  X(10) VALUE SPACES.    03010039
025900     05  HL8-SHIP-TO-ADDR-3A          PIC  X(40).                 03020039
026000     05  FILLER                       PIC  X(02) VALUE SPACES.    03030039
026100     05  FILLER                       PIC  X(10) VALUE            03040039
026200         ' CONTACT: '.                                            03050039
026300     05  HL8-CONTACT                  PIC  X(40).                 03060039
026400     05  FILLER                       PIC  X(02) VALUE SPACES.    03070039
026500     05  FILLER                       PIC  X(26) VALUE            03080039
026600         'FOB POINT...............: '.                            03090039
026700     05  HL8-FOB-PT                   PIC  X(20).                 03100039
026800                                                                  03110039
026900 01  HEADER-LINE8-B.                                              03120039
027000     05  FILLER                       PIC  X(10) VALUE SPACES.    03130039
027100     05  HL8-SHIP-TO-ADDR-3B          PIC  X(40).                 03140039
027200     05  FILLER                       PIC  X(100) VALUE SPACES.   03150039
027300                                                                  03160039
027400 01  HEADER-LINE9.                                                03170039
027500     05  FILLER                       PIC  X(52) VALUE SPACES.    03180039
027600     05  FILLER                       PIC  X(10) VALUE            03190039
027700         ' FAX #..: '.                                            03200039
027800     05  HL9-VEND-FAX                 PIC  X(24).                 03210039
027900     05  FILLER                       PIC  X(18) VALUE SPACES.    03220039
028000     05  FILLER                       PIC  X(26) VALUE            03230039
028100         'DO NOT SHIP BEFORE......: '.                            03240039
028200     05  HL9-DNSB-MONTH               PIC  X(02).                 03250039
028300     05  FILLER                       PIC  X(01) VALUE '/'.       03260039
028400     05  HL9-DNSB-DAY                 PIC  X(02).                 03270039
028500     05  FILLER                       PIC  X(01) VALUE '/'.       03280039
028600     05  HL9-DNSB-YEAR                PIC  X(02).                 03290039
028700     05  FILLER                       PIC  X(12) VALUE SPACES.    03300039
028800                                                                  03310039
028900 01  HEADER-LINE10.                                               03320039
029000     05  FILLER                       PIC  X(104) VALUE SPACES.   03330039
029100     05  FILLER                       PIC  X(26) VALUE            03340039
029200         'CANCEL IF NOT SHIPPED BY: '.                            03350039
029300     05  HL10-CNSB-MONTH              PIC  X(02).                 03360039
029400     05  FILLER                       PIC  X(01) VALUE '/'.       03370039
029500     05  HL10-CNSB-DAY                PIC  X(02).                 03380039
029600     05  FILLER                       PIC  X(01) VALUE '/'.       03390039
029700     05  HL10-CNSB-YEAR               PIC  X(02).                 03400039
029800     05  FILLER                       PIC  X(12) VALUE SPACES.    03410039
029900                                                                  03420039
030000 01  HEADER-LINE11.                                               03430039
030100     05  FILLER                       PIC  X(104) VALUE SPACES.   03440039
030200     05  FILLER                       PIC  X(26) VALUE            03450039
030300         'EARLIEST AD DATE........: '.                            03460039
030400     05  HL11-AD-DATE                 PIC  X(08).                 03470039
030500     05  FILLER                       PIC  X(12) VALUE SPACES.    03480039
030600                                                                  03490039
030700 01  HEADER-LINE12.                                               03500039
030800     05  FILLER                       PIC  X(104) VALUE SPACES.   03510039
030900     05  FILLER                       PIC  X(26) VALUE            03520039
031000         'PICTURED AD.............: '.                            03530039
031100     05  HL12-PIC-AD-IND              PIC  X(03).                 03540039
031200     05  FILLER                       PIC  X(17) VALUE SPACES.    03550039
031300                                                                  03560039
031400 01  INSTR-HEADER.                                                03570039
031500     05  FILLER                       PIC  X(13) VALUE            03580039
031600         'INSTRUCTIONS:'.                                         03590039
031700     05  FILLER                       PIC  X(137) VALUE SPACES.   03600039
031800                                                                  03610039
031900 01  INSTR-LINE.                                                  03620039
032000     05  FILLER                       PIC  X(07) VALUE SPACES.    03630039
032100     05  INSTR-DESC                   PIC  X(60).                 03640039
032200     05  FILLER                       PIC  X(83) VALUE SPACES.    03650039
032300                                                                  03660039
032400 01  PACK-LINE-1.                                                 03670039
032500     05  FILLER                       PIC  X(13) VALUE            03680039
032610* TKMA888 * REPLACED 1 LINE WITH 1 LINE **************************03690040
032620*           TO CHANGE FIELD LABEL                                 03700040
032630* TKMA888 *------------------------------------------------------*03710040
032640*           'PACK ......: '.                                      03720040
032650            'PACK ID ...: '.                                      03730040
032660* TKMA888 *------------------------------------------------------*03740040
032700     05  PL1-PACK-ID                  PIC  Z9.                    03750039
032710* TKMA888 * REPLACED 1 LINE WITH 4 LINES**************************03760040
032720*           TO ADD A FIELD TO PRINT LINE                          03770040
032730* TKMA888 *------------------------------------------------------*03780040
032731*    05  FILLER                       PIC  X(13) VALUE SPACES.    03790040
032732* TKMA888 *------------------------------------------------------*03800040
032740     05  FILLER                       PIC  X(03) VALUE SPACES.    03810040
032750     05  FILLER                       PIC  X(10) VALUE            03820040
032760         'PACK SKU: '.                                            03830040
032770     05  PL1-SKU-NBR                  PIC  ZZZZZZZ9.              03840042
032771     05  FILLER                       PIC  X(03) VALUE SPACES.    03850040
032780* TKMA888 *------------------------------------------------------*03860040
032900     05  FILLER                       PIC  X(13) VALUE            03870039
033000            'TOTAL UNITS: '.                                      03880039
033100     05  PL1-PACK-UNITS               PIC  Z,ZZZ,ZZ9.             03890039
033110* TKMA888 * REPLACED 1 LINE WITH 1 LINE **************************03900040
033200*    05  FILLER                       PIC  X(15) VALUE SPACES.    03910040
033210* TKMA888 *------------------------------------------------------*03920040
033220     05  FILLER                       PIC  X(04) VALUE SPACES.    03930040
033230* TKMA888 *------------------------------------------------------*03940040
033300     05  FILLER                       PIC  X(19) VALUE            03950039
033400            'NUMBER OF CARTONS: '.                                03960039
033500     05  PL1-CARTON-NUMERIC.                                      03970039
033600         10  PL1-NBR-CARTONS          PIC  Z,ZZ9.                 03980039
033700         10  CARTON-SPACES            PIC  X(17) VALUE SPACES.    03990039
033800     05  PL1-NBR-CARTONS-X REDEFINES  PL1-CARTON-NUMERIC          04000039
033900                                      PIC  X(22).                 04010039
034000     05  FILLER                       PIC  X(01) VALUE SPACES.    04020039
034100     05  FILLER                       PIC  X(18) VALUE            04030039
034200            'UNITS PER CARTON: '.                                 04040039
034300     05  PL1-UNITS-CARTON             PIC  Z,ZZZ,ZZ9.             04050039
034400     05  FILLER                       PIC  X(16) VALUE SPACES.    04060039
034500                                                                  04070039
034600 01  PACK-LINE-2.                                                 04080039
034700     05  FILLER                       PIC  X(21) VALUE            04090039
034800            'PACK DATA UNAVAILABLE'.                              04100039
034900     05  FILLER                       PIC  X(07) VALUE SPACES.    04110039
035000     05  FILLER                       PIC  X(13) VALUE            04120039
035100            'TOTAL UNITS: '.                                      04130039
035200     05  PL2-PACK-UNITS               PIC  Z,ZZZ,ZZ9.             04140039
035300     05  FILLER                       PIC  X(100) VALUE SPACES.   04150039
035400                                                                  04160039
035500 01  INNER-LINE-2.                                                04170039
035510* TKMA888 * REPLACED 1 LINE WITH 1 LINE **************************04180041
035520*           TO CHANGE FIELD LABEL                                 04190041
035530* TKMA888 *------------------------------------------------------*04200041
035540*    05  FILLER                       PIC  X(13) VALUE            04210041
035550*            'DESCRIPTION: '.                                     04220041
035560     05  FILLER                       PIC  X(18) VALUE            04230041
035570             'PACK DESCRIPTION: '.                                04240041
035580* TKMA888 *------------------------------------------------------*04250041
035800     05  IL2-PACK-DESC                PIC  X(40) VALUE SPACES.    04260039
035810* TKMA888 * REPLACED 1 LINE WITH 1 LINE **************************04270041
035900*    05  FILLER                       PIC  X(11) VALUE SPACES.    04280041
035901     05  FILLER                       PIC  X(02) VALUE SPACES.    04290041
035910* TKMA888 *------------------------------------------------------*04300041
035920* TKMA888 * ADDED 4 LINES ****************************************04310041
035960     05  FILLER                       PIC  X(10) VALUE            04320041
035970             'PACK UPC: '.                                        04330041
035980     05  IL2-UPC-NBR                  PIC  ZZZZZZZZZZZZZZ9.       04340042
035990     05  FILLER                       PIC  X(02) VALUE SPACES.    04350041
035991* TKMA888 *------------------------------------------------------*04360041
036000     05  FILLER                       PIC  X(20) VALUE            04370039
036100            'NBR OF INNER PACKS: '.                               04380039
036200     05  IL2-PACK-QTY                 PIC  Z,ZZ9.                 04390039
036210* TKMA888 * REPLACED 1 LINE WITH 1 LINE **************************04400041
036300*    05  FILLER                       PIC  X(14) VALUE SPACES.    04410041
036301     05  FILLER                       PIC  X(02) VALUE SPACES.    04420041
036310* TKMA888 *------------------------------------------------------*04430041
036400     05  FILLER                       PIC  X(26) VALUE            04440039
036500            'UNITS PER INNER PACK:     '.                         04450039
036600     05  IL2-UNITS-INNER              PIC  Z,ZZ9.                 04460039
036610* TKMA888 * REPLACED 1 LINE WITH 1 LINE **************************04470041
036700*    05  FILLER                       PIC  X(16) VALUE SPACES.    04480041
036701     05  FILLER                       PIC  X(03) VALUE SPACES.    04490041
036710* TKMA888 *------------------------------------------------------*04500041
036800                                                                  04510039
036900 01  MULTI-LINE-2.                                                04520039
037000* TKMA888 * REPLACED 1 LINE WITH 1 LINE **************************04530040
037100*           TO CHANGE FIELD LABEL                                 04540040
037110* TKMA888 *------------------------------------------------------*04550040
037120*    05  FILLER                       PIC  X(13) VALUE            04560040
037130*            'DESCRIPTION: '.                                     04570040
037140     05  FILLER                       PIC  X(18) VALUE            04580040
037150             'PACK DESCRIPTION: '.                                04590040
037160* TKMA888 *------------------------------------------------------*04600040
037200     05  ML2-PACK-DESC                PIC  X(40) VALUE SPACES.    04610039
037210* TKMA888 * REPLACED 1 LINE WITH 4 LINE **************************04620040
037220*           TO ADD PACK UPC TO REPORT                             04630040
037230* TKMA888 *------------------------------------------------------*04640040
037240*    05  FILLER                       PIC  X(97) VALUE SPACES.    04650040
037250     05  FILLER                       PIC  X(10) VALUE            04660041
037260             'PACK UPC: '.                                        04670041
037270     05  ML2-UPC-NBR                  PIC  ZZZZZZZZZZZZZZ9.       04680042
037280     05  FILLER                       PIC  X(62) VALUE SPACES.    04690041
037290* TKMA888 *------------------------------------------------------*04700040
037400                                                                  04710039
037500 01  SKU-LINE-1.                                                  04720039
037600     05  SL1-SKU-NBR                  PIC  999.                   04730039
W24803     05  FILLER                       PIC  X(06) VALUE ' DEPT:'.  04740044
037800     05  SL1-DEPT                     PIC  X(03).                 04750039
037900     05  FILLER                       PIC  X(01) VALUE SPACES.    04760039
W24803     05  FILLER                       PIC  X(04) VALUE 'MCL:'.    04770054
W24803     05  SL1-MAJ-CL                   PIC  X(02).                 04780044
W24803     05  FILLER                       PIC  X(01) VALUE SPACES.    04790044
W24803     05  FILLER                       PIC  X(04) VALUE 'SCL:'.    04800054
W24803     05  SL1-SUB-CL                   PIC  X(02).                 04810044
W24803     05  FILLER                       PIC  X(01) VALUE SPACES.    04820044
W24803     05  FILLER                       PIC  X(04) VALUE 'SKU:'.    04830044
W24803     05  SL1-SKU                      PIC  X(08).                 04840044
038300     05  FILLER                       PIC  X(11) VALUE            04850059
038400         '    STYLE: '.                                           04860059
038500     05  SL1-STYLE                    PIC  X(20).                 04870039
W24803     05  FILLER                       PIC  X(07) VALUE            04880054
W24803         ' DESC: '.                                               04890054
038800     05  SL1-DESC                     PIC  X(25).                 04900059
W24803     05  FILLER                       PIC  X(12) VALUE            04910045
W24803         '  PK RATIO: '.                                          04920045
039100     05  SL1-RATO                     PIC  ZZ9.                   04930039
039200     05  FILLER                       PIC  X(17) VALUE            04940039
039300         '       QUANTITY: '.                                     04950039
039400     05  SL1-QTY                      PIC  ZZZ,ZZ9.               04960039
W24803     05  FILLER                       PIC  X(10) VALUE SPACES.    04970059
039600                                                                  04980039
039700 01  SKU-LINE-2.                                                  04990039
039800     05  FILLER                       PIC  X(10) VALUE            05000039
039900         '   COLOR: '.                                            05010039
040000     05  SL2-COLOR                    PIC  X(25).                 05020039
040100     05  FILLER                       PIC  X(07) VALUE ' SIZE: '. 05030039
040200     05  SL2-SIZE                     PIC  X(25).                 05040039
040300     05  FILLER                       PIC  X(83) VALUE SPACES.    05050039
040400                                                                  05060039
040500 01  END-REPORT-LINE.                                             05070039
040600     05  FILLER                       PIC  X(61) VALUE SPACES.    05080039
040700     05  FILLER                       PIC  X(28) VALUE            05090039
040800         'END OF SHIPPING INSTRUCTIONS'.                          05100039
040900     05  FILLER                       PIC  X(61) VALUE SPACES.    05110039
041000                                                                  05120039
041100 01  BLANK-REPORT-LINE.                                           05130039
041200     05  FILLER                       PIC  X(58) VALUE SPACES.    05140039
041300     05  FILLER                       PIC  X(34) VALUE            05150039
041400         'THIS PAGE INTENTIONALLY LEFT BLANK'.                    05160039
041500     05  FILLER                       PIC  X(58) VALUE SPACES.    05170039
041600                                                                  05180039
041700 01  ASTERIK-LINE.                                                05190039
041800     05  FILLER                       PIC  X(04) VALUE SPACES.    05200039
041900     05  FILLER   OCCURS 71 TIMES.                                05210039
042000         10  FILLER                   PIC  X(01) VALUE '*'.       05220039
042100         10  FILLER                   PIC  X(01) VALUE SPACES.    05230039
042200     05  FILLER                       PIC  X(04) VALUE SPACES.    05240039
042300                                                                  05250039
042400******************************************************************05260039
042500*  COMMUNICATIONS AREA FOR DB2                                    05270039
042600******************************************************************05280039
042700     EXEC SQL                                                     05290039
042800          INCLUDE SQLCA                                           05300039
042900     END-EXEC.                                                    05310039
043000******************************************************************05320039
043100*  COPY BOOK FOR PURCHASE ORDER TABLE                             05330039
043200******************************************************************05340039
043300     EXEC SQL                                                     05350039
043400          INCLUDE TPURCHS                                         05360039
043500     END-EXEC.                                                    05370039
043600******************************************************************05380039
043700*  COPY BOOK FOR PURCHASE ITEM TABLE                              05390039
043800******************************************************************05400039
043900     EXEC SQL                                                     05410039
044000          INCLUDE TPURITM                                         05420039
044100     END-EXEC.                                                    05430039
044200******************************************************************05440039
044300*  COPY BOOK FOR PO PLANNED SHIPMENT TABLE                        05450039
044400******************************************************************05460039
044500     EXEC SQL                                                     05470039
044600          INCLUDE TPLNSHP                                         05480039
044700     END-EXEC.                                                    05490039
044800******************************************************************05500039
044900*  COPY BOOK FOR ALLOCATION PLAN TABLE                            05510039
045000******************************************************************05520039
045100     EXEC SQL                                                     05530039
045200          INCLUDE TALLPLN                                         05540039
045300     END-EXEC.                                                    05550039
045400******************************************************************05560039
045500*  COPY BOOK FOR EXTERNAL ENTERPRISE NAME TABLE                   05570039
045600******************************************************************05580039
045700     EXEC SQL                                                     05590039
045800          INCLUDE TENTNME                                         05600039
045900     END-EXEC.                                                    05610039
046000******************************************************************05620039
046100*  COPY BOOK FOR ENTERPRISE LOCATION TABLE                        05630039
046200******************************************************************05640039
046300     EXEC SQL                                                     05650039
046400          INCLUDE TBUSLOC                                         05660039
046500     END-EXEC.                                                    05670039
046600******************************************************************05680039
046700*  COPY BOOK FOR ENTERPRISE REP TABLE                             05690039
046800******************************************************************05700039
046900     EXEC SQL                                                     05710039
047000          INCLUDE TENTREP                                         05720039
047100     END-EXEC.                                                    05730039
060600******************************************************************05740063
060700*  COPY BOOK FOR LOCATION TABLE                                   05750063
060800******************************************************************05760063
060900     EXEC SQL                                                     05770063
061000          INCLUDE XMT00001                                        05780063
061100     END-EXEC.                                                    05790063
      ******************************************************************05800063
      *    DB2 AREA FOR DC LOCATION ASSIGNMENT                          05810063
      ******************************************************************05820063
           EXEC SQL                                                     05830063
                INCLUDE XMT00002                                        05840063
           END-EXEC.                                                    05850063
047800******************************************************************05860039
047900*  COPY BOOK FOR MERCHANDISE AREA                                 05870039
048000******************************************************************05880039
048100     EXEC SQL                                                     05890039
048200          INCLUDE TMDSEAR                                         05900039
048300     END-EXEC.                                                    05910039
048400******************************************************************05920039
048500*  COPY BOOK FOR PO PREPACK DATA                                  05930039
048600******************************************************************05940039
048700     EXEC SQL                                                     05950039
048800          INCLUDE TPOPRPK                                         05960039
048900     END-EXEC.                                                    05970039
W24803******************************************************************05980059
W24803*  COPY BOOK FOR XLT_SKU TABLE                                    05990059
W24803******************************************************************06000059
W24803     EXEC SQL                                                     06010051
W24803          INCLUDE  XLT00003                                       06020051
W24803     END-EXEC.                                                    06030051
W24803******************************************************************06040059
W24803*  COPY BOOK FOR XLT_VND_STYL TABLE                               06050059
W24803******************************************************************06060059
W24803     EXEC SQL                                                     06070051
W24803          INCLUDE  XLT00004                                       06080051
W24803     END-EXEC.                                                    06090051
049000******************************************************************06100039
049100*  CURSOR FOR SHIPMENTS                                           06110039
049200******************************************************************06120039
049300     EXEC SQL                                                     06130039
049400         DECLARE SHIP-CSR CURSOR FOR                              06140039
049500         SELECT DISTINCT(DEST_NBR)                                06150039
049600         FROM TALLPLN A, TPURITM B                                06160039
049700         WHERE A.PO_NBR = :PV-PO-NBR                              06170039
049800           AND A.CURR_SPLIT_QTY > +0                              06180039
049900           AND B.PO_NBR = A.PO_NBR                                06190039
050000           AND B.PO_LNE_NBR = A.PO_LNE_NBR                        06200039
050100           AND B.VER_STATUS_CDE = 'A'                             06210039
050200           AND B.STATUS_CDE NOT IN ('CA', 'CB')                   06220039
050300         ORDER BY DEST_NBR                                        06230039
050400     END-EXEC.                                                    06240039
050500******************************************************************06250039
050600*  CURSOR FOR PO LINE ITEMS APPROVED, IN A PACK                   06260039
050700******************************************************************06270039
050800     EXEC SQL                                                     06280039
050900         DECLARE APP-PREPACK-CSR CURSOR FOR                       06290039
051000         SELECT A.CURR_SPLIT_QTY,                                 06300039
051100                A.PLAN_NBR,                                       06310039
051200                B.CL_NBR,                                         06320051
051300                B.SKU_SEQ_NBR,                                    06330055
051400                B.VEND_STYL_NAME,                                 06340051
051500                B.SKU_DESC,                                       06350051
051600                B.COLOR_DESC,                                     06360051
051700                B.SIZE_DESC,                                      06370051
W24803                E.MAJ_CL_NBR,                                     06380051
W24803                E.SUB_CL_NBR,                                     06390051
W24803                D.SKU_NBR,                                        06400051
W24803                E.VS_NBR,                                         06410051
W24803                D.SKU_DESC,                                       06420051
W24803                D.CSTM_CLOR_DESC,                                 06430051
W24803                D.SIZE_DESC,                                      06440051
051800                B.APP_PO_LNE_NBR,                                 06450051
051900                B.PO_LNE_NBR,                                     06460039
052000                B.ITM_NBR,                                        06470039
052100                B.UNT_QTY,                                        06480039
052200                B.PREPK_RATO_QTY,                                 06490039
052300                C.PO_PREPK_ID,                                    06500039
052400                C.PREPK_DESC,                                     06510039
052500                C.INPK_UNT_QTY,                                   06520039
052510* TKMA888 * ADDED 3 LINES ****************************************06530040
052520                C.PK_SKU_NBR,                                     06540050
052530                C.PREPK_UPC_NBR,                                  06550050
052550* TKMA888 *------------------------------------------------------*06560040
052600                C.OTPK_UNT_QTY,                                   06570039
052700                C.OTPK_ORD_QTY,                                   06580064
052510* TKMA537 * ADDED 1 LINE  ****************************************06590064
052700                C.PREPK_TYP_CDE                                   06600064
052550* TKMA537 *------------------------------------------------------*06610064
052800         FROM   TALLPLN A,                                        06620039
W24803                TPOPRPK C,                                        06630051
W24803                TPURITM B LEFT OUTER JOIN                         06640051
W24803                XLT_SKU D ON B.ITM_NBR = D.ITM_NBR                06650059
W24803                LEFT OUTER JOIN                                   06660051
W24803                XLT_VND_STYL E ON D.STYL_ID = E.STYL_ID           06670059
W24803         WHERE  A.PO_NBR = :ALLPLN-PO-NBR                         06680051
053200           AND  A.CURR_SPLIT_QTY > +0                             06690039
053300           AND  A.DEST_NBR = :ALLPLN-DEST-NBR                     06700039
053400           AND  B.PO_NBR = A.PO_NBR                               06710039
053500           AND  B.PO_LNE_NBR = A.PO_LNE_NBR                       06720039
053600           AND  B.VER_STATUS_CDE = 'A'                            06730039
053700           AND  B.STATUS_CDE NOT IN ('CA', 'CB')                  06740039
053800           AND  C.PO_NBR = A.PO_NBR                               06750039
053900           AND  C.PO_PREPK_ID = B.PO_PREPK_ID                     06760039
054000         ORDER BY C.PO_PREPK_ID,                                  06770039
054100                  B.APP_PO_LNE_NBR,                               06780039
054200                  B.PO_LNE_NBR                                    06790039
054300     END-EXEC.                                                    06800039
054400******************************************************************06810039
054500*  CURSOR FOR PO LINE ITEMS APPROVED, NOT IN A PACK               06820039
054600******************************************************************06830039
054700     EXEC SQL                                                     06840039
054800         DECLARE APP-PO-LINE-CSR CURSOR FOR                       06850039
054900         SELECT A.CURR_SPLIT_QTY,                                 06860039
055000                A.PLAN_NBR,                                       06870039
055100                B.CL_NBR,                                         06880051
055200                B.SKU_SEQ_NBR,                                    06890055
055300                B.VEND_STYL_NAME,                                 06900051
055400                B.SKU_DESC,                                       06910051
055500                B.COLOR_DESC,                                     06920051
055600                B.SIZE_DESC,                                      06930051
W24803                D.MAJ_CL_NBR,                                     06940051
W24803                D.SUB_CL_NBR,                                     06950051
W24803                C.SKU_NBR,                                        06960051
W24803                D.VS_NBR,                                         06970051
W24803                C.SKU_DESC,                                       06980051
W24803                C.CSTM_CLOR_DESC,                                 06990051
W24803                C.SIZE_DESC,                                      07000051
055700                B.APP_PO_LNE_NBR,                                 07010039
055800                B.PO_LNE_NBR,                                     07020039
055900                B.ITM_NBR,                                        07030039
056000                B.UNT_QTY,                                        07040039
056100                B.PREPK_RATO_QTY                                  07050039
056200         FROM   TALLPLN A,                                        07060039
W24803                TPURITM B LEFT OUTER JOIN                         07070051
W24803                XLT_SKU C ON B.ITM_NBR = C.ITM_NBR                07080059
W24803                LEFT OUTER JOIN                                   07090051
W24803                XLT_VND_STYL D ON C.STYL_ID = D.STYL_ID           07100059
W24803         WHERE  A.PO_NBR = :ALLPLN-PO-NBR                         07110051
056500           AND  A.CURR_SPLIT_QTY > +0                             07120039
056600           AND  A.DEST_NBR = :ALLPLN-DEST-NBR                     07130039
056700           AND  B.PO_NBR = A.PO_NBR                               07140039
056800           AND  B.PO_LNE_NBR = A.PO_LNE_NBR                       07150039
056900           AND  B.VER_STATUS_CDE = 'A'                            07160039
057000           AND  B.STATUS_CDE NOT IN ('CA', 'CB')                  07170039
057100           AND  B.PO_PREPK_ID = 0                                 07180039
057200         ORDER BY B.APP_PO_LNE_NBR,                               07190039
057300                  B.PO_LNE_NBR                                    07200039
057400     END-EXEC.                                                    07210039
057500******************************************************************07220039
057600*  CURSOR FOR TALLPLN                                             07230039
057700******************************************************************07240039
057800     EXEC SQL                                                     07250039
057900         DECLARE TALLPLN-CSR CURSOR WITH HOLD FOR                 07260039
058000         SELECT CURR_SPLIT_QTY,                                   07270039
058100                PO_LNE_NBR,                                       07280039
058200                PLAN_NBR                                          07290039
058300         FROM   TALLPLN                                           07300039
058400         WHERE  PO_NBR = :PV-PO-NBR                               07310039
                 AND  CURR_SPLIT_QTY > 0                                07320062
058500     END-EXEC.                                                    07330039
058600                                                                  07340039
058700 PROCEDURE DIVISION.                                              07350039
058800                                                                  07360039
058900******************************************************************07370039
059000*  CONTROLS THE MAIN PROCESSING OF THE PROGRAM.                   07380039
059100******************************************************************07390039
059200 0000-MAINLINE.                                                   07400039
059300                                                                  07410039
059400     PERFORM 1000-INITIALIZE.                                     07420039
059500                                                                  07430039
059600     DISPLAY 'PO NBR = ' IR-PO-NBR.                               07440039
059700     DISPLAY ' BUYER REPORT CODE = ' IR-RPT-TYPE-BY.              07450039
059800     DISPLAY ' VENDOR REPORT CODE = ' IR-RPT-TYPE-VN.             07460039
059900                                                                  07470039
060000     IF IR-RPT-TYPE-BY = 'BY'                                     07480039
060100         MOVE 'BUYER COPY  '          TO HL3-VERSION              07490039
060200         PERFORM 2000-PROCESS-REPORT                              07500039
060300     END-IF.                                                      07510039
060400                                                                  07520039
060500     IF IR-RPT-TYPE-VN = 'VN'                                     07530039
060600         MOVE 'VENDOR COPY '          TO HL3-VERSION              07540039
060700         PERFORM 2000-PROCESS-REPORT                              07550039
060800     END-IF.                                                      07560039
060900                                                                  07570039
061000     CLOSE INPUT-FILE                                             07580039
061100           POSIRPT-FILE.                                          07590039
061200                                                                  07600039
061300     STOP RUN.                                                    07610039
061400                                                                  07620039
061500                                                                  07630039
061600******************************************************************07640039
061700*  OPENS THE FILES  READ INPUT FILE, INITS HEADER FIELDS          07650039
061800******************************************************************07660039
061900 1000-INITIALIZE.                                                 07670039
062000                                                                  07680039
062100     OPEN INPUT  INPUT-FILE                                       07690039
062200          OUTPUT POSIRPT-FILE.                                    07700039
062300                                                                  07710039
062400     READ INPUT-FILE INTO IR-INPUT-RECORD                         07720039
062500       AT END                                                     07730039
062600         DISPLAY  '****** ABEND IN PROGRAM POKRP081 *******'      07740039
062700         DISPLAY  'EMPTY INPUT FILE'                              07750039
062800         MOVE +4003                   TO PV-ABEND-CODE            07760039
062900         CALL 'ILBOABN0' USING PV-ABEND-CODE.                     07770039
063000                                                                  07780039
063100     DISPLAY IR-PO-NBR ' PO NUMBER BEING PROCESSED '.             07790039
063200     MOVE IR-PO-NBR                   TO PV-PO-NBR.               07800039
063300     ACCEPT SD-SYSTEM-DATE FROM DATE.                             07810039
063400     MOVE SD-SYSTEM-MM                TO HL1-RUN-MONTH.           07820039
063500     MOVE SD-SYSTEM-DD                TO HL1-RUN-DAY.             07830039
063600     MOVE SD-SYSTEM-YY                TO HL1-RUN-YEAR.            07840039
063700                                                                  07850039
063800     ACCEPT ST-SYSTEM-TIME FROM TIME.                             07860039
063900     MOVE ST-SYSTEM-HH                TO HL1-RUN-HOUR.            07870039
064000     MOVE ST-SYSTEM-MM                TO HL1-RUN-MINUTE.          07880039
064100     MOVE ST-SYSTEM-SS                TO HL1-RUN-SECOND.          07890039
064200                                                                  07900039
064300     PERFORM 1100-GET-HEADER-INFO.                                07910039
064400                                                                  07920039
064500                                                                  07930039
064600******************************************************************07940039
064700*  CONTROLS HEADER PROCESSING                                     07950039
064800******************************************************************07960039
064900 1100-GET-HEADER-INFO.                                            07970039
065000                                                                  07980039
065100     PERFORM 1101-GET-TPURCHS.                                    07990039
065200     PERFORM 1102-GET-TENTNME.                                    08000039
065300     PERFORM 1103-GET-TBUSLOC.                                    08010039
065400     PERFORM 1104-GET-TPLNSHP.                                    08020039
065500     PERFORM 1105-GET-TMDSEAR.                                    08030039
065600     PERFORM 1107-DETERMINE-NBR-OF-SHIPS.                         08040039
065700     PERFORM 1108-GET-ADDATE.                                     08050039
065800     PERFORM 1109-DETERMINE-PIC-AD.                               08060039
052510* TKMA537 * ADDED 1 LINE  ****************************************08070064
065800     PERFORM 1110-GET-TPOPRPK.                                    08080064
052510* TKMA537 -------------------------------------------------------*08090064
065900                                                                  08100039
066000******************************************************************08110039
066100*  RETRIEVES AND FORMATS PO DATA ON TPURCHS                       08120039
066200******************************************************************08130039
066300 1101-GET-TPURCHS.                                                08140039
066400                                                                  08150039
066500       EXEC SQL                                                   08160039
066600         SELECT ORD_DTE,                                          08170039
066700                ENT_ID,                                           08180039
066800                DEPT_NBR,                                         08190039
066900                ADR_SEQ_NBR,                                      08200039
067000                DIR_STR_IND,                                      08210039
067100                PKGNG_CDE                                         08220039
067200         INTO  :PURCHS-ORD-DTE,                                   08230039
067300               :PURCHS-ENT-ID,                                    08240039
067400               :PURCHS-DEPT-NBR,                                  08250039
067500               :PURCHS-ADR-SEQ-NBR,                               08260039
067600               :PURCHS-DIR-STR-IND,                               08270039
067700               :PURCHS-PKGNG-CDE                                  08280039
067800         FROM TPURCHS                                             08290039
067900         WHERE PO_NBR         = :PV-PO-NBR                        08300039
068000           AND VER_STATUS_CDE = 'A'                               08310039
068100           AND PO_CATEG_CDE   = 'MR'                              08320039
068200       END-EXEC.                                                  08330039
068300                                                                  08340039
068400       EVALUATE TRUE                                              08350039
068500         WHEN SQLCODE = +0                                        08360039
068600             CONTINUE                                             08370039
068700         WHEN SQLWARN NOT = SPACE                                 08380039
068800         WHEN SQLCODE NOT = +0                                    08390039
068900             MOVE '1101-GET-TPURCHS'                              08400039
069000                                      TO PV-ABEND-PARAGRAPH       08410039
069100             PERFORM 9000-SQL-ABEND                               08420039
069200       END-EVALUATE.                                              08430039
069300                                                                  08440039
069400     MOVE PV-PO-NBR                   TO HL1-PO-NBR.              08450039
069500     MOVE PURCHS-DEPT-NBR             TO HL2-DEPT-NBR.            08460039
069600     MOVE PURCHS-ORD-DTE              TO PV-DATE-BREAK.           08470039
069700     MOVE PV-DB-MM                    TO PV-DBS-MM.               08480039
069800     MOVE PV-DB-DD                    TO PV-DBS-DD.               08490039
069900     MOVE PV-DB-YY                    TO PV-DBS-YY.               08500039
070000     MOVE PV-DATE-BREAK-SLASH         TO HL1-ORD-DATE.            08510039
070100                                                                  08520039
070200                                                                  08530039
070300******************************************************************08540039
070400*  RETRIEVES AND FORMATS PO DATA ON TENTNME                       08550039
070500******************************************************************08560039
070600 1102-GET-TENTNME.                                                08570039
070700                                                                  08580039
070800     EXEC SQL                                                     08590039
070900         SELECT ENT_NAME_DESC                                     08600039
071000         INTO  :ENTNME-ENT-NAME-DESC                              08610039
071100         FROM TENTNME                                             08620039
071200         WHERE ENT_ID = :PURCHS-ENT-ID                            08630039
071300           AND TYPE_CDE = '01'                                    08640039
071400     END-EXEC.                                                    08650039
071500                                                                  08660039
071600     EVALUATE TRUE                                                08670039
071700         WHEN SQLCODE = +0                                        08680039
071800         WHEN SQLCODE = +100                                      08690039
071900             CONTINUE                                             08700039
072000         WHEN SQLWARN NOT = SPACE                                 08710039
072100         WHEN SQLCODE NOT = +0                                    08720039
072200             MOVE '1102-GET-TENTNME'  TO PV-ABEND-PARAGRAPH       08730039
072300             PERFORM 9000-SQL-ABEND                               08740039
072400     END-EVALUATE.                                                08750039
072500                                                                  08760039
072600     IF SQLCODE = +100                                            08770039
072700         MOVE SPACES                  TO HL4-VEND-NAME            08780039
072800     ELSE                                                         08790039
072900         MOVE ENTNME-ENT-NAME-DESC    TO HL4-VEND-NAME            08800039
073000     END-IF.                                                      08810039
073100                                                                  08820039
073200                                                                  08830039
073300******************************************************************08840039
073400*  RETRIEVES AND FORMATS PO DATA ON TBUSLOC AND TENTREP           08850039
073500******************************************************************08860039
073600 1103-GET-TBUSLOC.                                                08870039
073700                                                                  08880039
073800     EXEC SQL                                                     08890039
073900         SELECT ADDRESS_LINE1_DESC,                               08900039
074000                ADDRESS_LINE2_DESC,                               08910039
074100                ATTENTION_TO_TXT,                                 08920039
074200                CITY_NAME,                                        08930039
074300                ZIP_CDE,                                          08940039
074400                ST_PROV_CDE,                                      08950039
074500                CNTRY_CDE                                         08960039
074600         INTO  :BUSLOC-ADDRESS-LINE1-DESC,                        08970039
074700               :BUSLOC-ADDRESS-LINE2-DESC,                        08980039
074800               :BUSLOC-ATTENTION-TO-TXT,                          08990039
074900               :BUSLOC-CITY-NAME,                                 09000039
075000               :BUSLOC-ZIP-CDE,                                   09010039
075100               :BUSLOC-ST-PROV-CDE,                               09020039
075200               :BUSLOC-CNTRY-CDE                                  09030039
075300         FROM TBUSLOC                                             09040039
075400         WHERE ENT_ID = :PURCHS-ENT-ID                            09050039
075500           AND FUNCTION_ID = 2                                    09060039
075600           AND SEQ_NBR = :PURCHS-ADR-SEQ-NBR                      09070039
075700     END-EXEC.                                                    09080039
075800                                                                  09090039
075900     EVALUATE TRUE                                                09100039
076000         WHEN SQLCODE = +0                                        09110039
076100         WHEN SQLCODE = +100                                      09120039
076200             CONTINUE                                             09130039
076300         WHEN SQLWARN NOT = SPACE                                 09140039
076400         WHEN SQLCODE NOT = +0                                    09150039
076500             MOVE '1103-GET-TBUSLOC'  TO PV-ABEND-PARAGRAPH       09160039
076600             PERFORM 9000-SQL-ABEND                               09170039
076700     END-EVALUATE.                                                09180039
076800                                                                  09190039
076900     IF SQLCODE = +100                                            09200039
077000         MOVE SPACES                  TO HL5-VEND-ADDR-1          09210039
077100         MOVE SPACES                  TO HL6-VEND-ADDR-2          09220039
077200         MOVE SPACES                  TO HL7-VEND-ADDR-3          09230039
077300     ELSE                                                         09240039
077400         MOVE BUSLOC-CITY-NAME        TO PV-CITY                  09250039
077500         IF BUSLOC-CNTRY-CDE = 'US ' OR SPACES                    09260039
077600             MOVE SPACES              TO PV-COUNTRY               09270039
077700                                         PV-STATE-PROV            09280039
077800             MOVE BUSLOC-ST-PROV-CDE  TO PV-STATE-PROV            09290039
077900         ELSE                                                     09300039
078000             PERFORM 1150-RETRIEVE-PROV-COUNTRY                   09310039
078100         END-IF                                                   09320039
078200         MOVE BUSLOC-ADDRESS-LINE1-DESC                           09330039
078300                                      TO HL5-VEND-ADDR-1          09340039
078400         IF BUSLOC-ADDRESS-LINE2-DESC > SPACES                    09350039
078500             MOVE BUSLOC-ADDRESS-LINE2-DESC                       09360039
078600                                      TO HL6-VEND-ADDR-2          09370039
078700             INITIALIZE HL7-VEND-ADDR-3                           09380039
078800             STRING PV-CITY             DELIMITED BY '  '         09390039
078900                    ', '                DELIMITED BY SIZE         09400039
079000                    PV-STATE-PROV       DELIMITED BY '  '         09410039
079100                    '  '                DELIMITED BY SIZE         09420039
079200                    BUSLOC-ZIP-CDE      DELIMITED BY '  '         09430039
079300                    '  '                DELIMITED BY SIZE         09440039
079400                    PV-COUNTRY          DELIMITED BY '  '         09450039
079500               INTO HL7-VEND-ADDR-3                               09460039
079600         ELSE                                                     09470039
079700             INITIALIZE HL6-VEND-ADDR-2                           09480039
079800             STRING BUSLOC-CITY-NAME    DELIMITED BY '  '         09490039
079900                    ', '                DELIMITED BY SIZE         09500039
080000                    PV-STATE-PROV       DELIMITED BY '  '         09510039
080100                    '  '                DELIMITED BY SIZE         09520039
080200                    BUSLOC-ZIP-CDE      DELIMITED BY '  '         09530039
080300                    '  '                DELIMITED BY SIZE         09540039
080400                    PV-COUNTRY          DELIMITED BY '  '         09550039
080500               INTO HL6-VEND-ADDR-2                               09560039
080600             MOVE BUSLOC-ATTENTION-TO-TXT                         09570039
080700                                      TO HL7-VEND-ADDR-3          09580039
080800         END-IF                                                   09590039
080900     END-IF.                                                      09600039
081000                                                                  09610039
081100     EXEC SQL                                                     09620039
081200         SELECT A.FAX_NBR,                                        09630039
081300                A.FIRST_NAME,                                     09640039
081400                A.LAST_NAME                                       09650039
081500         INTO  :ENTREP-FAX-NBR,                                   09660039
081600               :ENTREP-FIRST-NAME,                                09670039
081700               :ENTREP-LAST-NAME                                  09680039
081800         FROM TENTREP A                                           09690039
081900         WHERE A.ENT_ID = :PURCHS-ENT-ID                          09700039
082000           AND A.FUNCTION_ID = 13                                 09710039
082100           AND A.SEQ_NBR = (SELECT MIN(B.SEQ_NBR)                 09720039
082200                            FROM TENTREP B                        09730039
082300                            WHERE B.ENT_ID = A.ENT_ID             09740039
082400                              AND B.FUNCTION_ID = A.FUNCTION_ID)  09750039
082500     END-EXEC.                                                    09760039
082600                                                                  09770039
082700     EVALUATE TRUE                                                09780039
082800         WHEN SQLCODE = +0                                        09790039
082900         WHEN SQLCODE = +100                                      09800039
083000             CONTINUE                                             09810039
083100         WHEN SQLWARN NOT = SPACE                                 09820039
083200         WHEN SQLCODE NOT = +0                                    09830039
083300             MOVE '1103-GET-TBUSLOC'                              09840039
083400                                      TO PV-ABEND-PARAGRAPH       09850039
083500             PERFORM 9000-SQL-ABEND                               09860039
083600     END-EVALUATE.                                                09870039
083700                                                                  09880039
083800     IF SQLCODE = +100                                            09890039
083900         MOVE SPACES                  TO HL8-CONTACT              09900039
084000         MOVE SPACES                  TO HL9-VEND-FAX             09910039
084100     ELSE                                                         09920039
084200         MOVE 40                      TO DP024-FLNAME-LENGTH      09930039
084300         MOVE ENTREP-LAST-NAME        TO DP024-LNAME              09940039
084400         MOVE ENTREP-FIRST-NAME       TO DP024-FNAME              09950039
084500         PERFORM DP024-0000-FORMAT-NAME                           09960039
084600         MOVE DP024-FLNAME            TO HL8-CONTACT              09970039
084700         MOVE ENTREP-FAX-NBR          TO HL9-VEND-FAX             09980039
084800     END-IF.                                                      09990039
084900                                                                  10000039
085000                                                                  10010039
085100******************************************************************10020039
085200*  RETRIEVES AND FORMATS PO DATA ON TPLNSHP                       10030039
085300******************************************************************10040039
085400 1104-GET-TPLNSHP.                                                10050039
085500                                                                  10060039
085600     EXEC SQL                                                     10070039
085700         SELECT FOB_POINT_TXT,                                    10080039
085800                DONT_SHIP_BEF_DTE,                                10090039
085900                CAN_IFNOT_SHIP_DTE                                10100039
086000         INTO  :PLNSHP-FOB-POINT-TXT,                             10110039
086100               :PLNSHP-DONT-SHIP-BEF-DTE,                         10120039
086200               :PLNSHP-CAN-IFNOT-SHIP-DTE                         10130039
086300         FROM TPLNSHP                                             10140039
086400         WHERE PO_NBR = :PV-PO-NBR                                10150039
086500           AND VER_STATUS_CDE = 'A'                               10160039
086600     END-EXEC.                                                    10170039
086700                                                                  10180039
086800     EVALUATE TRUE                                                10190039
086900         WHEN SQLCODE = +0                                        10200039
087000             CONTINUE                                             10210039
087100         WHEN SQLWARN NOT = SPACE                                 10220039
087200         WHEN SQLCODE NOT = +0                                    10230039
087300             MOVE '1104-GET-TPLNSHP'                              10240039
087400                                      TO PV-ABEND-PARAGRAPH       10250039
087500             PERFORM 9000-SQL-ABEND                               10260039
087600     END-EVALUATE.                                                10270039
087700                                                                  10280039
087800     MOVE PLNSHP-FOB-POINT-TXT        TO HL8-FOB-PT.              10290039
087900     MOVE PLNSHP-DONT-SHIP-BEF-DTE    TO PV-DATE-BREAK.           10300039
088000     MOVE PV-DB-MM                    TO HL9-DNSB-MONTH.          10310039
088100     MOVE PV-DB-DD                    TO HL9-DNSB-DAY.            10320039
088200     MOVE PV-DB-YY                    TO HL9-DNSB-YEAR.           10330039
088300     MOVE PLNSHP-CAN-IFNOT-SHIP-DTE   TO PV-DATE-BREAK.           10340039
088400     MOVE PV-DB-MM                    TO HL10-CNSB-MONTH.         10350039
088500     MOVE PV-DB-DD                    TO HL10-CNSB-DAY.           10360039
088600     MOVE PV-DB-YY                    TO HL10-CNSB-YEAR.          10370039
088700                                                                  10380039
088800                                                                  10390039
088900******************************************************************10400039
089000*  GET DEPARTMENT NAME FROM TMDSEAR                               10410039
089100******************************************************************10420039
089200 1105-GET-TMDSEAR.                                                10430039
089300                                                                  10440039
089400     EXEC SQL                                                     10450039
089500         SELECT MDSEAR_DESC                                       10460039
089600         INTO  :MDSEAR-DESC                                       10470039
089700         FROM TMDSEAR                                             10480039
089800         WHERE OPERCO_NBR = '03'                                  10490039
089900           AND DEPT_NBR = :PURCHS-DEPT-NBR                        10500039
090000           AND MDSELV_CDE = 'DPT'                                 10510039
090100           AND STRT_DTE <= CURRENT DATE                           10520039
090200           AND END_DTE >= CURRENT DATE                            10530039
090300     END-EXEC.                                                    10540039
090400                                                                  10550039
090500     EVALUATE TRUE                                                10560039
090600         WHEN SQLCODE = +0                                        10570039
090700             MOVE MDSEAR-DESC         TO HL2-DEPT-NAME            10580039
090800         WHEN SQLCODE = +100                                      10590039
090900             MOVE SPACES              TO HL2-DEPT-NAME            10600039
091000         WHEN SQLWARN NOT = SPACE                                 10610039
091100         WHEN SQLCODE NOT = +0                                    10620039
091200             MOVE '1105-GET-TMDSEAR'                              10630039
091300                                      TO PV-ABEND-PARAGRAPH       10640039
091400             PERFORM 9000-SQL-ABEND                               10650039
091500     END-EVALUATE.                                                10660039
091600                                                                  10670039
091700                                                                  10680039
091800******************************************************************10690039
091900*  DETERMINE NUMBER OF SHIPMENTS FOR THIS ORDER                   10700039
092000******************************************************************10710039
092100 1107-DETERMINE-NBR-OF-SHIPS.                                     10720039
092200                                                                  10730039
092300     MOVE +0                          TO PV-DB2-COUNT.            10740039
092400     EXEC SQL                                                     10750039
092500         SELECT COUNT(DISTINCT(DEST_NBR))                         10760039
092600         INTO  :PV-DB2-COUNT                                      10770039
092700         FROM TALLPLN A, TPURITM B                                10780039
092800         WHERE A.PO_NBR = :PV-PO-NBR                              10790039
092900           AND A.CURR_SPLIT_QTY > +0                              10800039
093000           AND B.PO_NBR = A.PO_NBR                                10810039
093100           AND B.PO_LNE_NBR = A.PO_LNE_NBR                        10820039
093200           AND B.VER_STATUS_CDE = 'A'                             10830039
093300           AND B.STATUS_CDE NOT IN ('CA', 'CB')                   10840039
093400     END-EXEC.                                                    10850039
093500                                                                  10860039
093600     EVALUATE TRUE                                                10870039
093700         WHEN SQLCODE = +0                                        10880039
093800             MOVE PV-DB2-COUNT        TO HL4-NBR-SHIP             10890039
093900         WHEN SQLCODE = +100                                      10900039
094000             MOVE 0                   TO HL4-NBR-SHIP             10910039
094100         WHEN SQLWARN NOT = SPACE                                 10920039
094200         WHEN SQLCODE NOT = +0                                    10930039
094300             MOVE '1107-DETERMINE-NBR-OF-SHIPS'                   10940039
094400                                      TO PV-ABEND-PARAGRAPH       10950039
094500             PERFORM 9000-SQL-ABEND                               10960039
094600     END-EVALUATE.                                                10970039
094700                                                                  10980039
094800                                                                  10990039
094900******************************************************************11000039
095000*  RETRIEVES ANY AD MERCHANDISE FROM TPURITM                      11010039
095100******************************************************************11020039
095200 1108-GET-ADDATE.                                                 11030039
095300                                                                  11040039
095400     EXEC SQL                                                     11050039
095500         SELECT MIN(AD_EVNT_DTE)                                  11060039
095600         INTO  :PURITM-AD-EVNT-DTE:PV-NULL-IND                    11070039
095700         FROM TPURITM                                             11080039
095800         WHERE PO_NBR  = :PV-PO-NBR                               11090039
095900           AND VER_STATUS_CDE = 'A'                               11100039
096000           AND AD_EVNT_DTE > :PC-INIT-DATE                        11110039
096100           AND STATUS_CDE NOT IN ('CA', 'CB')                     11120039
096200     END-EXEC.                                                    11130039
096300                                                                  11140039
096400     EVALUATE TRUE                                                11150039
096500         WHEN SQLCODE = +0                                        11160039
096600         WHEN SQLCODE = +100                                      11170039
096700             CONTINUE                                             11180039
096800         WHEN SQLWARN NOT = SPACE                                 11190039
096900         WHEN SQLCODE NOT = +0                                    11200039
097000             MOVE '1108-GET-ADDATE'   TO PV-ABEND-PARAGRAPH       11210039
097100             PERFORM 9000-SQL-ABEND                               11220039
097200     END-EVALUATE.                                                11230039
097300                                                                  11240039
097400     IF SQLCODE = +100                                            11250039
097500       OR PV-NULL-IND < +0                                        11260039
097600         MOVE SPACES                  TO HL11-AD-DATE             11270039
097700     ELSE                                                         11280039
097800         MOVE PURITM-AD-EVNT-DTE      TO PV-DATE-BREAK            11290039
097900         MOVE PV-DB-MM                TO PV-DBS-MM                11300039
098000         MOVE PV-DB-DD                TO PV-DBS-DD                11310039
098100         MOVE PV-DB-YY                TO PV-DBS-YY                11320039
098200         MOVE PV-DATE-BREAK-SLASH     TO HL11-AD-DATE             11330039
098300     END-IF.                                                      11340039
098400                                                                  11350039
098500                                                                  11360039
098600******************************************************************11370039
098700*  CHECKS IF ITEM IS PICTURED IN AD                               11380039
098800******************************************************************11390039
098900 1109-DETERMINE-PIC-AD.                                           11400039
099000                                                                  11410039
099100                                                                  11420039
099200     MOVE +0                          TO PV-DB2-COUNT.            11430039
099300     EXEC SQL                                                     11440039
099400         SELECT COUNT(*)                                          11450039
099500         INTO  :PV-DB2-COUNT                                      11460039
099600         FROM TPURITM                                             11470039
099700         WHERE PO_NBR = :PV-PO-NBR                                11480039
099800           AND PIC_ITM_IND = 'Y'                                  11490039
099900     END-EXEC.                                                    11500039
100000                                                                  11510039
100100     EVALUATE TRUE                                                11520039
100200         WHEN SQLCODE = +0                                        11530039
100300         WHEN SQLCODE = +100                                      11540039
100400             CONTINUE                                             11550039
100500         WHEN SQLWARN NOT = SPACE                                 11560039
100600         WHEN SQLCODE NOT = +0                                    11570039
100700             MOVE '1109-DETERMINE-PIC-AD'                         11580039
100800                                      TO PV-ABEND-PARAGRAPH       11590039
100900             PERFORM 9000-SQL-ABEND                               11600039
101000     END-EVALUATE.                                                11610039
101100                                                                  11620039
101200     IF PV-DB2-COUNT > ZERO                                       11630039
101300         MOVE 'YES'                   TO HL12-PIC-AD-IND          11640039
101400     ELSE                                                         11650039
101500         MOVE ' NO'                   TO HL12-PIC-AD-IND          11660039
101600     END-IF.                                                      11670039
101700                                                                  11680039
066000******************************************************************11690064
066100*  RETRIEVES AND PACK DATA ON TPOPRPK                             11700064
066200******************************************************************11710064
066300 1110-GET-TPOPRPK.                                                11720064
066400                                                                  11730064
066500       EXEC SQL                                                   11740064
066600         SELECT PREPK_TYP_CDE                                     11750064
067200         INTO  :POPRPK-PREPK-TYP-CDE                              11760064
067800         FROM TPOPRPK                                             11770064
067900         WHERE PO_NBR         = :PV-PO-NBR                        11780064
068300         FETCH FIRST 1 ROWS ONLY                                  11790064
068200       END-EXEC.                                                  11800064
068300                                                                  11810064
068400       EVALUATE TRUE                                              11820064
068500         WHEN SQLCODE = +0                                        11830064
068600             CONTINUE                                             11840064
068700         WHEN SQLWARN NOT = SPACE                                 11850064
068800         WHEN SQLCODE NOT = +0                                    11860064
068900             MOVE '1110-GET-TPOPRPK'                              11870064
069000                                      TO PV-ABEND-PARAGRAPH       11880064
069100             PERFORM 9000-SQL-ABEND                               11890064
069200       END-EVALUATE.                                              11900064
069300                                                                  11910064
070100                                                                  11920064
101800******************************************************************11930039
101900*  RETRIEVE THE COUNTRY AND PROVINCE FROM THE PEOPLESOFT TABLES   11940039
102000******************************************************************11950039
102100 1150-RETRIEVE-PROV-COUNTRY.                                      11960039
102200                                                                  11970039
102300     MOVE BUSLOC-ST-PROV-CDE          TO DP410-STATE-CODE.        11980039
102400     MOVE BUSLOC-CNTRY-CDE            TO DP410-COUNTRY-CODE.      11990039
102500                                                                  12000039
102600     CALL PC-DPKUT410 USING DP410-ST-PROV-CNTRY-ROUTINE.          12010039
102700                                                                  12020039
102800     EVALUATE TRUE                                                12030039
102900                                                                  12040039
103000         WHEN  DP410-DB2-ERROR                                    12050039
103100             DISPLAY 'STATE/PROV = ' DP410-STATE-CODE             12060039
103200             DISPLAY 'COUNTRY = ' DP410-COUNTRY-CODE              12070039
103300             MOVE '1150-RETRIEVE-PROV-COUNTRY'                    12080039
103400                                      TO PV-ABEND-PARAGRAPH       12090039
103500             PERFORM 9000-SQL-ABEND                               12100039
103600                                                                  12110039
103700         WHEN  DP410-DEADLOCK-BYPASS-ROUTINE                      12120039
103800             MOVE DP410-STATE-CODE    TO PV-STATE-PROV            12130039
103900             MOVE DP410-COUNTRY-CODE  TO PV-COUNTRY               12140039
104000                                                                  12150039
104100         WHEN  OTHER                                              12160039
104200             MOVE SPACES              TO PV-STATE-PROV            12170039
104300                                         PV-COUNTRY               12180039
104400             MOVE DP410-STATE-NAME    TO PV-STATE-PROV            12190039
104500             MOVE DP410-COUNTRY-NAME  TO PV-COUNTRY               12200039
104600     END-EVALUATE.                                                12210039
104700                                                                  12220039
104800******************************************************************12230039
104900*  CONTROLS REPORT PROCESSING                                     12240039
105000******************************************************************12250039
105100 2000-PROCESS-REPORT.                                             12260039
105200                                                                  12270039
105300     PERFORM 2200-OPEN-SHIPMENT-CURSOR.                           12280039
105400     PERFORM 2300-PROCESS-SHIPMENT-CURSOR                         12290039
105500         UNTIL PS-EOF-SHIP-CSR.                                   12300039
105600     PERFORM 2400-CLOSE-SHIPMENT-CURSOR.                          12310039
105700                                                                  12320039
105800                                                                  12330039
105900******************************************************************12340039
106000*  OPENS SHIPMENT CURSOR                                          12350039
106100******************************************************************12360039
106200 2200-OPEN-SHIPMENT-CURSOR.                                       12370039
106300                                                                  12380039
106400     EXEC SQL                                                     12390039
106500         OPEN SHIP-CSR                                            12400039
106600     END-EXEC.                                                    12410039
106700                                                                  12420039
106800     EVALUATE TRUE                                                12430039
106900         WHEN SQLCODE = +0                                        12440039
107000             CONTINUE                                             12450039
107100         WHEN SQLWARN NOT = SPACE                                 12460039
107200         WHEN SQLCODE NOT = +0                                    12470039
107300             MOVE '2200-OPEN-SHIP-CSR'                            12480039
107400                                      TO PV-ABEND-PARAGRAPH       12490039
107500             PERFORM 9000-SQL-ABEND                               12500039
107600     END-EVALUATE.                                                12510039
107700     SET PS-NOT-EOF-SHIP-CSR          TO TRUE.                    12520039
107800     INITIALIZE PV-SHIP-NBR.                                      12530039
107900                                                                  12540039
108000                                                                  12550039
108100******************************************************************12560039
108200*  FETCHS SHIPMENT CURSOR AND CONTROLS PROCESSING FOR PRINTING    12570039
108300*  OF SHIPMENT                                                    12580039
108400******************************************************************12590039
108500 2300-PROCESS-SHIPMENT-CURSOR.                                    12600039
108600                                                                  12610039
108700     EXEC SQL                                                     12620039
108800         FETCH SHIP-CSR                                           12630039
108900         INTO  :ALLPLN-DEST-NBR                                   12640039
109000     END-EXEC.                                                    12650039
109100                                                                  12660039
109200     EVALUATE TRUE                                                12670039
109300         WHEN SQLCODE = +0                                        12680039
109400         WHEN SQLCODE = +100                                      12690039
109500             CONTINUE                                             12700039
109600         WHEN SQLWARN NOT = SPACE                                 12710039
109700         WHEN SQLCODE NOT = +0                                    12720039
109800             MOVE '2300-PROCESS-SHIPMENT-CURSOR'                  12730039
109900                                      TO PV-ABEND-PARAGRAPH       12740039
110000             PERFORM 9000-SQL-ABEND                               12750039
110100     END-EVALUATE.                                                12760039
110200                                                                  12770039
110300     IF SQLCODE = +100                                            12780039
110400         SET PS-EOF-SHIP-CSR          TO TRUE                     12790039
110500     ELSE                                                         12800039
110600         PERFORM 2310-GET-SHIPMENT-DATA                           12810039
110700         PERFORM 2320-GET-SHIPMENT-COUNTS                         12820039
110800         ADD +1                       TO PV-SHIP-NBR              12830039
110900         MOVE PV-SHIP-NBR             TO HL4-SHIP-NBR             12840039
111000         MOVE ZEROES                  TO PV-PAGE-CNT              12850039
111100         PERFORM 2900-REPORT-HEADINGS                             12860039
111200         WRITE POSIRPT-RECORD FROM HEADER-LINE8-A                 12870039
111300             AFTER 1 LINES                                        12880039
111400         WRITE POSIRPT-RECORD FROM HEADER-LINE9                   12890039
111500             AFTER 1 LINES                                        12900039
111600         WRITE POSIRPT-RECORD FROM HEADER-LINE10                  12910039
111700             AFTER 1 LINES                                        12920039
111800         WRITE POSIRPT-RECORD FROM HEADER-LINE11                  12930039
111900             AFTER 1 LINES                                        12940039
112000         WRITE POSIRPT-RECORD FROM HEADER-LINE12                  12950039
112100             AFTER 1 LINES                                        12960039
112200         ADD +5                       TO PV-LINE-CNT              12970039
112300                                                                  12980039
112400         PERFORM 2330-PROCESS-INSTRUCTION                         12990039
112500         PERFORM 2340-PROCESS-PREPACK-SKUS                        13000039
112600         IF PV-LINE-CNT > ( PC-LINE-MAX - 2 )                     13010039
112700             PERFORM 2900-REPORT-HEADINGS                         13020039
112800             WRITE POSIRPT-RECORD FROM HEADER-LINE8-B             13030039
112900               AFTER 1 LINES                                      13040039
113000             ADD +1                   TO PV-LINE-CNT              13050039
113100         END-IF                                                   13060039
113200                                                                  13070039
113300         WRITE POSIRPT-RECORD FROM END-REPORT-LINE                13080039
113400             AFTER 3 LINES                                        13090039
113500     END-IF.                                                      13100039
113600                                                                  13110039
113700                                                                  13120039
113800******************************************************************13130039
113900*  RETRIEVES AND FORMATS SHIP TO DATA FROM XMT_LOC                13140063
114000******************************************************************13150039
114100 2310-GET-SHIPMENT-DATA.                                          13160039
114200                                                                  13170039
114300     EXEC SQL                                                     13180039
114400         SELECT LOC_NM,                                           13190063
114500                LNE_1_ADDR,                                       13200063
114600                LNE_2_ADDR,                                       13210063
114700                CTY_NM,                                           13220063
114800                ST_CDE,                                           13230063
114900                ZIP_10_CDE                                        13240063
115000         INTO  :XMT00001-LOC-NM,                                  13250063
115100               :XMT00001-LNE-1-ADDR,                              13260063
115200               :XMT00001-LNE-2-ADDR,                              13270063
115300               :XMT00001-CTY-NM,                                  13280063
115400               :XMT00001-ST-CDE,                                  13290063
115500               :XMT00001-ZIP-10-CDE                               13300063
115600         FROM XMT_LOC                                             13310063
115700         WHERE LOC_NBR = :ALLPLN-DEST-NBR                         13320063
115900     END-EXEC.                                                    13330039
116000                                                                  13340039
116100     EVALUATE TRUE                                                13350039
116200         WHEN SQLCODE = +0                                        13360039
116300         WHEN SQLCODE = +100                                      13370039
116400             CONTINUE                                             13380039
116500         WHEN SQLWARN NOT = SPACE                                 13390039
116600         WHEN SQLCODE NOT = +0                                    13400039
116700             MOVE '2310-GET-SHIPMENT-DATA'                        13410039
116800                                      TO PV-ABEND-PARAGRAPH       13420039
116900             PERFORM 9000-SQL-ABEND                               13430039
117000     END-EVALUATE.                                                13440039
117100                                                                  13450039
117200     IF SQLCODE = 0                                               13460039
117300         MOVE XMT00001-LOC-NM   TO HL5-SHIP-TO-NAME               13470063
117400         MOVE XMT00001-LNE-1-ADDR                                 13480063
117500                                   TO HL6-SHIP-TO-ADDR-1          13490063
117700         MOVE XMT00001-ZIP-10-CDE                                 13500063
117800                                   TO PV-EDIT-ZIP-CODE            13510063
               IF PV-EZD-DASH EQUAL '-' OR ' '                          13520063
                  MOVE PV-EZD-1-5          TO PV-ZCD-1-5                13530063
                  MOVE PV-EZD-6-9          TO PV-ZCD-6-9                13540063
               ELSE                                                     13550063
                  MOVE PV-EZND-1-5          TO PV-ZCD-1-5               13560063
                  MOVE PV-EZND-6-9          TO PV-ZCD-6-9               13570063
               END-IF                                                   13580063
117900         MOVE SPACES                  TO HL7-SHIP-TO-ADDR-2       13590039
118000         IF XMT00001-LNE-2-ADDR > SPACES                          13600063
118100             MOVE XMT00001-LNE-2-ADDR                             13610063
118200                                   TO HL7-SHIP-TO-ADDR-2          13620063
118300             STRING XMT00001-CTY-NM        DELIMITED BY '  '      13630063
118400                    ', '                   DELIMITED BY SIZE      13640039
118500                    XMT00001-ST-CDE        DELIMITED BY '  '      13650063
118600                    '  '                   DELIMITED BY SIZE      13660039
118700                    PV-ZIP-CODE-DISPLAY    DELIMITED BY SIZE      13670039
118800               INTO HL8-SHIP-TO-ADDR-3A                           13680039
118900             MOVE HL8-SHIP-TO-ADDR-3A TO HL8-SHIP-TO-ADDR-3B      13690039
119000         ELSE                                                     13700039
119100             STRING XMT00001-CTY-NM        DELIMITED BY '  '      13710063
119200                    ', '                   DELIMITED BY SIZE      13720039
119300                    XMT00001-ST-CDE        DELIMITED BY '  '      13730063
119400                    '  '                   DELIMITED BY SIZE      13740039
119500                    PV-ZIP-CODE-DISPLAY    DELIMITED BY SIZE      13750039
119600               INTO HL7-SHIP-TO-ADDR-2                            13760039
119700             MOVE SPACES              TO HL8-SHIP-TO-ADDR-3A      13770039
119800                                         HL8-SHIP-TO-ADDR-3B      13780039
119900         END-IF                                                   13790039
120000     ELSE                                                         13800039
120100         MOVE SPACES                  TO HL5-SHIP-TO-NAME         13810039
120200                                         HL6-SHIP-TO-ADDR-1       13820039
120300                                         HL7-SHIP-TO-ADDR-2       13830039
120400                                         HL8-SHIP-TO-ADDR-3A      13840039
120500                                         HL8-SHIP-TO-ADDR-3B      13850039
120600     END-IF.                                                      13860039
120700                                                                  13870039
120800                                                                  13880039
120900******************************************************************13890039
121000*  DETERMINES COUNTS OF UNITS, LINES, AND SKUS FOR A GIVEN        13900039
121100*  SHIPPING DESTINATION                                           13910039
121200******************************************************************13920039
121300 2320-GET-SHIPMENT-COUNTS.                                        13930039
121400                                                                  13940039
121500     EXEC SQL                                                     13950039
121600         SELECT SUM(A.CURR_SPLIT_QTY)                             13960039
121700         INTO  :ALLPLN-CURR-SPLIT-QTY                             13970039
121800         FROM TALLPLN A, TPURITM B                                13980039
121900         WHERE A.PO_NBR = :PV-PO-NBR                              13990039
122000           AND A.CURR_SPLIT_QTY > +0                              14000039
122100           AND A.DEST_NBR = :ALLPLN-DEST-NBR                      14010039
122200           AND B.PO_NBR = A.PO_NBR                                14020039
122300           AND B.PO_LNE_NBR = A.PO_LNE_NBR                        14030039
122400           AND B.VER_STATUS_CDE = 'A'                             14040039
122500           AND B.STATUS_CDE NOT IN ('CA', 'CB')                   14050039
122600     END-EXEC.                                                    14060039
122700                                                                  14070039
122800     EVALUATE TRUE                                                14080039
122900         WHEN SQLCODE = +0                                        14090039
123000             MOVE ALLPLN-CURR-SPLIT-QTY                           14100039
123100                                      TO HL5-UNITS                14110039
123200         WHEN SQLCODE = +100                                      14120039
123300             MOVE ZEROES              TO HL5-UNITS                14130039
123400         WHEN SQLWARN NOT = SPACE                                 14140039
123500         WHEN SQLCODE NOT = +0                                    14150039
123600             MOVE '2320-GET-SHIPMENT-COUNTS - UNITS'              14160039
123700                                      TO PV-ABEND-PARAGRAPH       14170039
123800             PERFORM 9000-SQL-ABEND                               14180039
123900     END-EVALUATE.                                                14190039
124000                                                                  14200039
124100                                                                  14210039
124200     EXEC SQL                                                     14220039
124300         SELECT COUNT(DISTINCT(B.PO_LNE_NBR))                     14230039
124400         INTO  :PV-DB2-COUNT                                      14240039
124500         FROM TALLPLN A, TPURITM B                                14250039
124600         WHERE A.PO_NBR = :PV-PO-NBR                              14260039
124700           AND A.CURR_SPLIT_QTY > +0                              14270039
124800           AND A.DEST_NBR = :ALLPLN-DEST-NBR                      14280039
124900           AND B.PO_NBR = A.PO_NBR                                14290039
125000           AND B.PO_LNE_NBR = A.PO_LNE_NBR                        14300039
125100           AND B.VER_STATUS_CDE = 'A'                             14310039
125200           AND B.STATUS_CDE NOT IN ('CA', 'CB')                   14320039
125300     END-EXEC.                                                    14330039
125400                                                                  14340039
125500     EVALUATE TRUE                                                14350039
125600         WHEN SQLCODE = +0                                        14360039
125700             MOVE PV-DB2-COUNT        TO HL6-LINES                14370039
125800         WHEN SQLCODE = +100                                      14380039
125900             MOVE ZEROES              TO HL6-LINES                14390039
126000         WHEN SQLWARN NOT = SPACE                                 14400039
126100         WHEN SQLCODE NOT = +0                                    14410039
126200             MOVE '2320-GET-SHIPMENT-COUNTS - LINES'              14420039
126300                                      TO PV-ABEND-PARAGRAPH       14430039
126400             PERFORM 9000-SQL-ABEND                               14440039
126500     END-EVALUATE.                                                14450039
126600                                                                  14460039
126700     EXEC SQL                                                     14470039
W24803         SELECT COUNT(DISTINCT(ITM_NBR))                          14480046
126900         INTO  :PV-DB2-COUNT                                      14490039
127000         FROM TALLPLN A, TPURITM B                                14500039
127100         WHERE A.PO_NBR = :PV-PO-NBR                              14510039
127200           AND A.CURR_SPLIT_QTY > +0                              14520039
127300           AND A.DEST_NBR = :ALLPLN-DEST-NBR                      14530039
127400           AND B.PO_NBR = A.PO_NBR                                14540039
127500           AND B.PO_LNE_NBR = A.PO_LNE_NBR                        14550039
127600           AND B.VER_STATUS_CDE = 'A'                             14560039
127700           AND B.STATUS_CDE NOT IN ('CA', 'CB')                   14570039
127800     END-EXEC.                                                    14580039
127900                                                                  14590039
128000     EVALUATE TRUE                                                14600039
128100         WHEN SQLCODE = +0                                        14610039
128200             MOVE PV-DB2-COUNT        TO HL7-SKUS                 14620039
128300         WHEN SQLCODE = +100                                      14630039
128400             MOVE ZEROES              TO HL7-SKUS                 14640039
128500         WHEN SQLWARN NOT = SPACE                                 14650039
128600         WHEN SQLCODE NOT = +0                                    14660039
128700             MOVE '2320-GET-SHIPMENT-COUNTS - SKUS'               14670039
128800                                      TO PV-ABEND-PARAGRAPH       14680039
128900             PERFORM 9000-SQL-ABEND                               14690039
129000     END-EVALUATE.                                                14700039
129100                                                                  14710039
129200* DETERMINE NUMBER OF UNIQUE PACKS SET UP                         14720039
129300     EXEC SQL                                                     14730039
129400         SELECT COUNT(DISTINCT(PO_PREPK_ID))                      14740039
129500         INTO  :PV-DB2-COUNT                                      14750039
129600         FROM TALLPLN A, TPURITM B                                14760039
129700         WHERE A.PO_NBR = :PV-PO-NBR                              14770039
129800           AND A.CURR_SPLIT_QTY > +0                              14780039
129900           AND A.DEST_NBR = :ALLPLN-DEST-NBR                      14790039
130000           AND B.PO_NBR = A.PO_NBR                                14800039
130100           AND B.PO_LNE_NBR = A.PO_LNE_NBR                        14810039
130200           AND B.VER_STATUS_CDE = 'A'                             14820039
130300           AND B.STATUS_CDE NOT IN ('CA', 'CB')                   14830039
130400           AND B.PO_PREPK_ID > +0                                 14840039
130500     END-EXEC.                                                    14850039
130600                                                                  14860039
130700     EVALUATE TRUE                                                14870039
130800         WHEN SQLCODE = +0                                        14880039
130900             MOVE PV-DB2-COUNT        TO HL4-PACKS                14890039
131000         WHEN SQLCODE = +100                                      14900039
131100             MOVE ZEROES              TO HL4-PACKS                14910039
131200             CONTINUE                                             14920039
131300         WHEN SQLWARN NOT = SPACE                                 14930039
131400         WHEN SQLCODE NOT = +0                                    14940039
131500             MOVE '2320-GET-SHIPMENT-COUNTS - PACKS'              14950039
131600                                      TO PV-ABEND-PARAGRAPH       14960039
131700             PERFORM 9000-SQL-ABEND                               14970039
131800     END-EVALUATE.                                                14980039
131900                                                                  14990039
132000                                                                  15000039
132100******************************************************************15010039
132200*  CONTROLS INSTRUCTION PROCESSING                                15020039
132300******************************************************************15030039
132400 2330-PROCESS-INSTRUCTION.                                        15040039
132500                                                                  15050039
132600     WRITE POSIRPT-RECORD FROM INSTR-HEADER                       15060039
132700         AFTER 2 LINES.                                           15070039
132800                                                                  15080039
132900     IF POPRPK-PREPK-TYP-CDE = 'I'                                15090064
 33000         MOVE PC-INNER-INSTR1         TO INSTR-DESC               15100064
133100         WRITE POSIRPT-RECORD FROM INSTR-LINE                     15110039
133200           AFTER 1 LINES                                          15120039
133300                                                                  15130039
133400         MOVE PC-INNER-INSTR2         TO INSTR-DESC               15140039
133500         WRITE POSIRPT-RECORD FROM INSTR-LINE                     15150039
133600             AFTER 1 LINES                                        15160039
133700     ELSE                                                         15170039
133800         MOVE PC-MULTI-INSTR1         TO INSTR-DESC               15180039
133900         WRITE POSIRPT-RECORD FROM INSTR-LINE                     15190039
134000           AFTER 1 LINES                                          15200039
134100                                                                  15210039
134200         MOVE PC-MULTI-INSTR2         TO INSTR-DESC               15220039
134300         WRITE POSIRPT-RECORD FROM INSTR-LINE                     15230039
134400             AFTER 1 LINES                                        15240039
134500     END-IF.                                                      15250039
134600     ADD +4                           TO PV-LINE-CNT.             15260039
134700                                                                  15270039
134800                                                                  15280039
134900******************************************************************15290039
135000*  CONTROLS SKUS PROCESSING FOR EACH DESTINATION WITHIN A PO      15300039
135100******************************************************************15310039
135200 2340-PROCESS-PREPACK-SKUS.                                       15320039
135300                                                                  15330039
W24803     MOVE PV-PO-NBR TO ALLPLN-PO-NBR                              15340051
135400     SET PS-NOT-EOF-PREPACK-CSR                                   15350039
135500         PS-NOT-EOF-PO-LINE-CSR       TO TRUE.                    15360039
135600     MOVE +9999                       TO PV-PO-PREPK-ID.          15370039
135700     PERFORM 2341-OPEN-PREPACK-CSR.                               15380039
135800     PERFORM 2342-PROCESS-PREPACK-CSR                             15390039
135900         UNTIL PS-EOF-PREPACK-CSR.                                15400039
136000     PERFORM 2343-CLOSE-PREPACK-CSR.                              15410039
136100                                                                  15420039
136200     PERFORM 2350-PROCESS-LINES.                                  15430039
136300     IF PS-NOT-EOF-PO-LINE-CSR                                    15440039
136400         MOVE 99                      TO POPRPK-PO-PREPK-ID       15450039
136500         PERFORM 2351-OPEN-PO-LINE-CSR                            15460039
136600         PERFORM 2352-PROCESS-PO-LINE-CSR                         15470039
136700           UNTIL PS-EOF-PO-LINE-CSR                               15480039
136800         PERFORM 2353-CLOSE-PO-LINE-CSR                           15490039
136900     END-IF.                                                      15500039
137000                                                                  15510039
137100                                                                  15520039
137200******************************************************************15530039
137300*  OPENS PREPACK CSR                                              15540039
137400******************************************************************15550039
137500 2341-OPEN-PREPACK-CSR.                                           15560039
137600                                                                  15570039
137700     EXEC SQL                                                     15580039
137800         OPEN APP-PREPACK-CSR                                     15590039
137900     END-EXEC.                                                    15600039
138000                                                                  15610039
138100     EVALUATE TRUE                                                15620039
138200         WHEN SQLCODE = +0                                        15630039
138300             CONTINUE                                             15640039
138400         WHEN SQLWARN NOT = SPACE                                 15650039
138500         WHEN SQLCODE NOT = +0                                    15660039
138600             MOVE '2341-OPEN-PREPACK-CSR'                         15670039
138700                                      TO PV-ABEND-PARAGRAPH       15680039
138800             PERFORM 9000-SQL-ABEND                               15690039
138900     END-EVALUATE.                                                15700039
139000                                                                  15710039
139100                                                                  15720039
139200******************************************************************15730039
139300*  FETCHS PREPACK CSR AND PRINTS                                  15740039
139400******************************************************************15750039
139500 2342-PROCESS-PREPACK-CSR.                                        15760039
139600                                                                  15770039
W24803     INITIALIZE  PV-NULL-INDICATOR-VARIABLES                      15780051
139700     EXEC SQL                                                     15790039
139800         FETCH APP-PREPACK-CSR                                    15800039
139900         INTO :ALLPLN-CURR-SPLIT-QTY,                             15810039
140000              :ALLPLN-PLAN-NBR,                                   15820039
140100              :PURITM-CL-NBR,                                     15830051
140200              :PURITM-SKU-SEQ-NBR,                                15840061
140300              :PURITM-VEND-STYL-NAME,                             15850051
140400              :PURITM-SKU-DESC,                                   15860051
140500              :PURITM-COLOR-DESC,                                 15870051
140600              :PURITM-SIZE-DESC,                                  15880051
W24803              :XLT00004-MAJ-CL-NBR:PV-MAJ-CL-NBR-IND,             15890051
W24803              :XLT00004-SUB-CL-NBR:PV-SUB-CL-NBR-IND,             15900051
W24803              :XLT00003-SKU-NBR:PV-SKU-NBR-IND,                   15910051
W24803              :XLT00004-VS-NBR:PV-VS-NBR-IND,                     15920051
W24803              :XLT00003-SKU-DESC:PV-SKU-DESC-IND,                 15930051
W24803              :XLT00003-CSTM-CLOR-DESC:PV-CSTM-CLOR-DESC-IND,     15940052
W24803              :XLT00003-SIZE-DESC:PV-SIZE-DESC-IND,               15950051
140700              :PURITM-APP-PO-LNE-NBR,                             15960039
140800              :PURITM-PO-LNE-NBR,                                 15970039
140900              :PURITM-ITM-NBR,                                    15980039
141000              :PURITM-UNT-QTY,                                    15990039
141100              :PURITM-PREPK-RATO-QTY,                             16000039
141200              :POPRPK-PO-PREPK-ID,                                16010039
141300              :POPRPK-PREPK-DESC,                                 16020039
141400              :POPRPK-INPK-UNT-QTY,                               16030039
141410* TKMA888 * ADDED 2 LINES ****************************************16040040
141420              :POPRPK-PK-SKU-NBR,                                 16050040
141430              :POPRPK-PREPK-UPC-NBR,                              16060040
141450* TKMA888 *------------------------------------------------------*16070040
141500              :POPRPK-OTPK-UNT-QTY,                               16080039
141600              :POPRPK-OTPK-ORD-QTY,                               16090064
141410* TKMA537 * ADDED 1 LINES ****************************************16100064
141600              :POPRPK-PREPK-TYP-CDE                               16110064
141450* TKMA537 *------------------------------------------------------*16120064
141700     END-EXEC.                                                    16130039
141800                                                                  16140039
141900     EVALUATE TRUE                                                16150039
142000         WHEN SQLCODE = +0                                        16160039
142100         WHEN SQLCODE = +100                                      16170039
142200             CONTINUE                                             16180039
142300         WHEN SQLWARN NOT = SPACE                                 16190039
142400         WHEN SQLCODE NOT = +0                                    16200039
142500             MOVE '2342-PROCESS-PREPACK-CSR'                      16210039
142600                                      TO PV-ABEND-PARAGRAPH       16220039
142700             PERFORM 9000-SQL-ABEND                               16230039
142800     END-EVALUATE.                                                16240039
142900                                                                  16250039
143000     IF SQLCODE = +100                                            16260039
143100         SET PS-EOF-PREPACK-CSR       TO TRUE                     16270039
143200     ELSE                                                         16280039
143300         IF PV-LINE-CNT > PC-LINE-MAX                             16290039
143400* CAUSE PAGE BREAK FOR A NEW PACK ID, BUT NOT THE FIRST TIME.     16300039
143500           OR ( POPRPK-PO-PREPK-ID NOT = PV-PO-PREPK-ID           16310039
143600               AND PV-PO-PREPK-ID < +9999                         16320039
143700               AND PV-LINE-CNT > ( PC-LINE-MAX - 5 ) )            16330039
143800                                                                  16340039
143900             PERFORM 2900-REPORT-HEADINGS                         16350039
144000             WRITE POSIRPT-RECORD FROM HEADER-LINE8-B             16360039
144100                 AFTER 1 LINES                                    16370039
144200             ADD +1                   TO PV-LINE-CNT              16380039
144300         END-IF                                                   16390039
144400                                                                  16400039
144500         IF POPRPK-PO-PREPK-ID NOT = PV-PO-PREPK-ID               16410039
144600             PERFORM 2344-GET-TPOPRPK                             16420039
144700* ACCUMULATE THE TOTAL LINE UNITS IN THE PACK FOR THIS DEST       16430039
144800             MOVE PV-LINE-QTY         TO PL1-PACK-UNITS           16440039
144900                                                                  16450039
145000             IF POPRPK-PREPK-TYP-CDE = 'I'                        16460064
145100                 MOVE POPRPK-INPK-UNT-QTY                         16470039
145200                                      TO IL2-UNITS-INNER          16480039
145300                 MOVE POPRPK-OTPK-UNT-QTY                         16490039
145400                                      TO PL1-UNITS-CARTON         16500039
145500                                         PV-UNITS-CARTON          16510039
145600                 MOVE POPRPK-PREPK-DESC                           16520039
145700                                      TO IL2-PACK-DESC            16530039
145800                 MOVE ZEROES          TO IL2-PACK-QTY             16540039
145900                 IF POPRPK-INPK-UNT-QTY > ZEROS                   16550039
146000                     DIVIDE POPRPK-OTPK-UNT-QTY                   16560039
146100                     BY     POPRPK-INPK-UNT-QTY                   16570039
146200                     GIVING PV-QUOTIENT                           16580039
146300                     REMAINDER PV-REMAINDER                       16590039
146400                                                                  16600039
146500                     IF PV-REMAINDER = ZEROS                      16610039
146600                         MOVE PV-QUOTIENT                         16620039
146700                                      TO IL2-PACK-QTY             16630039
146800                     END-IF                                       16640039
146900                 END-IF                                           16650039
147000             ELSE                                                 16660039
147100                 MOVE POPRPK-INPK-UNT-QTY                         16670039
147200                                      TO PL1-UNITS-CARTON         16680039
147300                                         PV-UNITS-CARTON          16690039
147400                 MOVE POPRPK-PREPK-DESC                           16700039
147500                                      TO ML2-PACK-DESC            16710039
147600             END-IF                                               16720039
147700                                                                  16730039
147800             DIVIDE PV-LINE-QTY                                   16740039
147900             BY     PV-UNITS-CARTON                               16750039
148000             GIVING PV-QUOTIENT                                   16760039
148100             REMAINDER PV-REMAINDER                               16770039
148200             IF PV-REMAINDER = ZEROS                              16780039
148300                 MOVE PV-QUOTIENT     TO PL1-NBR-CARTONS          16790039
148400                 MOVE SPACES          TO CARTON-SPACES            16800039
148500             ELSE                                                 16810039
148600                 MOVE '* PARTIAL CARTON      '                    16820039
148700                                      TO PL1-NBR-CARTONS-X        16830039
148800             END-IF                                               16840039
148900                                                                  16850039
149000* PRINT PACK LINES                                                16860039
149100             IF PV-PO-PREPK-ID < +9999                            16870039
149200                 WRITE POSIRPT-RECORD FROM ASTERIK-LINE           16880039
149300                     AFTER 2 LINES                                16890039
149400                 MOVE SPACES          TO POSIRPT-RECORD           16900039
149500                 WRITE POSIRPT-RECORD                             16910039
149600                     AFTER 1 LINES                                16920039
149700             ELSE                                                 16930039
149800                 MOVE SPACES          TO POSIRPT-RECORD           16940039
149900                 WRITE POSIRPT-RECORD                             16950039
150000                     AFTER 3 LINES                                16960039
150100             END-IF                                               16970039
150200             MOVE POPRPK-PO-PREPK-ID  TO PL1-PACK-ID              16980039
150300                                         PV-PO-PREPK-ID           16990039
150310* TKMA888 * ADDED 2 LINES ****************************************17000043
150320*            TO INCLUDE SKU AND UPC NUMBERS ON INSTR PRINT        17010043
150330* TKMA888 *------------------------------------------------------*17020043
150340             MOVE POPRPK-PK-SKU-NBR    TO PL1-SKU-NBR             17030043
150350             MOVE POPRPK-PREPK-UPC-NBR TO ML2-UPC-NBR             17040043
150360                                          IL2-UPC-NBR             17050043
150370* TKMA888 *------------------------------------------------------*17060043
150400             WRITE POSIRPT-RECORD FROM PACK-LINE-1                17070039
150500                 AFTER 1 LINES                                    17080039
150600             IF PURCHS-PKGNG-CDE = 'I'                            17090039
150700                 WRITE POSIRPT-RECORD FROM INNER-LINE-2           17100039
150800                   AFTER 1 LINES                                  17110039
150900             ELSE                                                 17120039
151000                 WRITE POSIRPT-RECORD FROM MULTI-LINE-2           17130039
151100                   AFTER 1 LINES                                  17140039
151200             END-IF                                               17150039
151300             ADD +5                   TO PV-LINE-CNT              17160039
151400         END-IF                                                   17170039
151500         PERFORM 2800-FORMAT-PRINT-SKU-LINE                       17180039
151600     END-IF.                                                      17190039
151700                                                                  17200039
151800                                                                  17210039
151900******************************************************************17220039
152000*  CLOSES PREPACK CSR                                             17230039
152100******************************************************************17240039
152200 2343-CLOSE-PREPACK-CSR.                                          17250039
152300                                                                  17260039
152400     EXEC SQL                                                     17270039
152500         CLOSE APP-PREPACK-CSR                                    17280039
152600     END-EXEC.                                                    17290039
152700                                                                  17300039
152800     EVALUATE TRUE                                                17310039
152900         WHEN SQLCODE = +0                                        17320039
153000             CONTINUE                                             17330039
153100         WHEN SQLWARN NOT = SPACE                                 17340039
153200         WHEN SQLCODE NOT = +0                                    17350039
153300             MOVE '2343-CLOSE-PREPACK-CSR'                        17360039
153400                                      TO PV-ABEND-PARAGRAPH       17370039
153500             PERFORM 9000-SQL-ABEND                               17380039
153600     END-EVALUATE.                                                17390039
153700                                                                  17400039
153800                                                                  17410039
153900******************************************************************17420039
154000*  RETRIEVES AND FORMATS PO PREPACK DATA ON TPOPRPK               17430039
154100******************************************************************17440039
154200 2344-GET-TPOPRPK.                                                17450039
154300                                                                  17460039
154400                                                                  17470039
154500       EXEC SQL                                                   17480039
154600         SELECT SUM(A.CURR_SPLIT_QTY)                             17490039
154700         INTO :PV-LINE-QTY                                        17500039
154800         FROM   TALLPLN A,                                        17510039
154900                TPURITM B,                                        17520039
155000                TPOPRPK C                                         17530039
155100         WHERE  A.PO_NBR = :PV-PO-NBR                             17540039
155200           AND  A.CURR_SPLIT_QTY > +0                             17550039
155300           AND  A.DEST_NBR = :ALLPLN-DEST-NBR                     17560039
155400           AND  B.PO_NBR = A.PO_NBR                               17570039
155500           AND  B.PO_LNE_NBR = A.PO_LNE_NBR                       17580039
155600           AND  B.VER_STATUS_CDE = 'A'                            17590039
155700           AND  B.STATUS_CDE NOT IN ('CA', 'CB')                  17600039
155800           AND  C.PO_NBR = A.PO_NBR                               17610039
155900           AND  B.PO_PREPK_ID = :POPRPK-PO-PREPK-ID               17620039
156000           AND  C.PO_PREPK_ID = B.PO_PREPK_ID                     17630039
156100       END-EXEC.                                                  17640039
156200                                                                  17650039
156300       EVALUATE TRUE                                              17660039
156400         WHEN SQLCODE = +0                                        17670039
156500             CONTINUE                                             17680039
156600         WHEN SQLWARN NOT = SPACE                                 17690039
156700         WHEN SQLCODE NOT = +0                                    17700039
156800             MOVE '2344-GET-TPOPRPK'  TO PV-ABEND-PARAGRAPH       17710039
156900             PERFORM 9000-SQL-ABEND                               17720039
157000       END-EVALUATE.                                              17730039
157100                                                                  17740039
157200                                                                  17750039
157300******************************************************************17760039
157400*  RETRIEVES THE TOTAL ALLOCATIONS NOT IN A PACK.                 17770039
157500******************************************************************17780039
157600 2350-PROCESS-LINES.                                              17790039
157700                                                                  17800039
157800     INITIALIZE PV-LINE-QTY.                                      17810039
157900       EXEC SQL                                                   17820039
158000         SELECT SUM(A.CURR_SPLIT_QTY)                             17830039
158100         INTO :PV-LINE-QTY                                        17840039
158200         FROM   TALLPLN A,                                        17850039
158300                TPURITM B                                         17860039
158400         WHERE  A.PO_NBR = :PV-PO-NBR                             17870039
158500           AND  A.CURR_SPLIT_QTY > +0                             17880039
158600           AND  A.DEST_NBR = :ALLPLN-DEST-NBR                     17890039
158700           AND  B.PO_NBR = A.PO_NBR                               17900039
158800           AND  B.PO_LNE_NBR = A.PO_LNE_NBR                       17910039
158900           AND  B.VER_STATUS_CDE = 'A'                            17920039
159000           AND  B.STATUS_CDE NOT IN ('CA', 'CB')                  17930039
159100           AND  B.PO_PREPK_ID = 0                                 17940039
159200       END-EXEC.                                                  17950039
159300                                                                  17960039
159400       EVALUATE TRUE                                              17970039
159500         WHEN SQLCODE = +0                                        17980039
159600             CONTINUE                                             17990039
159700         WHEN SQLCODE = -305                                      18000039
159800             SET PS-EOF-PO-LINE-CSR   TO TRUE                     18010039
159900         WHEN SQLWARN NOT = SPACE                                 18020039
160000         WHEN SQLCODE NOT = +0                                    18030039
160100             MOVE '2350-PROCESS-LINES'                            18040039
160200                                      TO PV-ABEND-PARAGRAPH       18050039
160300             PERFORM 9000-SQL-ABEND                               18060039
160400       END-EVALUATE.                                              18070039
160500                                                                  18080039
160600                                                                  18090039
160700******************************************************************18100039
160800*  OPENS PO LINE CSR                                              18110039
160900******************************************************************18120039
161000 2351-OPEN-PO-LINE-CSR.                                           18130039
161100                                                                  18140039
161200     EXEC SQL                                                     18150039
161300         OPEN APP-PO-LINE-CSR                                     18160039
161400     END-EXEC.                                                    18170039
161500                                                                  18180039
161600     EVALUATE TRUE                                                18190039
161700         WHEN SQLCODE = +0                                        18200039
161800             CONTINUE                                             18210039
161900         WHEN SQLWARN NOT = SPACE                                 18220039
162000         WHEN SQLCODE NOT = +0                                    18230039
162100             MOVE '2351-OPEN-PO-LINE-CSR'                         18240039
162200                                      TO PV-ABEND-PARAGRAPH       18250039
162300             PERFORM 9000-SQL-ABEND                               18260039
162400     END-EVALUATE.                                                18270039
162500                                                                  18280039
162600                                                                  18290039
162700******************************************************************18300039
162800*  FETCHS PO LINE CSR AND PRINTS                                  18310039
162900******************************************************************18320039
163000 2352-PROCESS-PO-LINE-CSR.                                        18330039
163100                                                                  18340039
W24803     INITIALIZE  PV-NULL-INDICATOR-VARIABLES                      18350051
163200     EXEC SQL                                                     18360039
163300         FETCH APP-PO-LINE-CSR                                    18370039
163400         INTO :ALLPLN-CURR-SPLIT-QTY,                             18380039
163500              :ALLPLN-PLAN-NBR,                                   18390039
163600              :PURITM-CL-NBR,                                     18400051
163700              :PURITM-SKU-SEQ-NBR,                                18410055
163800              :PURITM-VEND-STYL-NAME,                             18420051
163900              :PURITM-SKU-DESC,                                   18430051
164000              :PURITM-COLOR-DESC,                                 18440051
164100              :PURITM-SIZE-DESC,                                  18450051
W24803              :XLT00004-MAJ-CL-NBR:PV-MAJ-CL-NBR-IND,             18460051
W24803              :XLT00004-SUB-CL-NBR:PV-SUB-CL-NBR-IND,             18470051
W24803              :XLT00003-SKU-NBR:PV-SKU-NBR-IND,                   18480051
W24803              :XLT00004-VS-NBR:PV-VS-NBR-IND,                     18490051
W24803              :XLT00003-SKU-DESC:PV-SKU-DESC-IND,                 18500051
W24803              :XLT00003-CSTM-CLOR-DESC:PV-CSTM-CLOR-DESC-IND,     18510052
W24803              :XLT00003-SIZE-DESC:PV-SIZE-DESC-IND,               18520051
164200              :PURITM-APP-PO-LNE-NBR,                             18530039
164300              :PURITM-PO-LNE-NBR,                                 18540039
164400              :PURITM-ITM-NBR,                                    18550039
164500              :PURITM-UNT-QTY,                                    18560039
164600              :PURITM-PREPK-RATO-QTY                              18570039
164700     END-EXEC.                                                    18580039
164800                                                                  18590039
164900     EVALUATE TRUE                                                18600039
165000         WHEN SQLCODE = +0                                        18610039
165100         WHEN SQLCODE = +100                                      18620039
165200             CONTINUE                                             18630039
165300         WHEN SQLWARN NOT = SPACE                                 18640039
165400         WHEN SQLCODE NOT = +0                                    18650039
165500             MOVE '2352-PROCESS-PO-LINE-CSR'                      18660039
165600                                      TO PV-ABEND-PARAGRAPH       18670039
165700             PERFORM 9000-SQL-ABEND                               18680039
165800     END-EVALUATE.                                                18690039
165900                                                                  18700039
166000     IF SQLCODE = +100                                            18710039
166100         SET PS-EOF-PO-LINE-CSR       TO TRUE                     18720039
166200     ELSE                                                         18730039
166300         IF PV-LINE-CNT > PC-LINE-MAX                             18740039
166400           OR ( POPRPK-PO-PREPK-ID NOT = PV-PO-PREPK-ID           18750039
166500               AND PV-PO-PREPK-ID NOT = +9999                     18760039
166600               AND PV-LINE-CNT > ( PC-LINE-MAX - 5 ) )            18770039
166700             PERFORM 2900-REPORT-HEADINGS                         18780039
166800             WRITE POSIRPT-RECORD FROM HEADER-LINE8-B             18790039
166900                 AFTER 1 LINES                                    18800039
167000             ADD +1                   TO PV-LINE-CNT              18810039
167100         END-IF                                                   18820039
167200                                                                  18830039
167300         IF POPRPK-PO-PREPK-ID NOT = PV-PO-PREPK-ID               18840039
167400             IF PV-PO-PREPK-ID < +9999                            18850039
167500                 MOVE SPACES          TO POSIRPT-RECORD           18860039
167600                 WRITE POSIRPT-RECORD                             18870039
167700                     AFTER 1 LINES                                18880039
167800                 WRITE POSIRPT-RECORD FROM ASTERIK-LINE           18890039
167900                     AFTER 1 LINES                                18900039
168000                 MOVE SPACES          TO POSIRPT-RECORD           18910039
168100                 WRITE POSIRPT-RECORD                             18920039
168200                     AFTER 1 LINES                                18930039
168300             ELSE                                                 18940039
168400                 MOVE SPACES          TO POSIRPT-RECORD           18950039
168500                 WRITE POSIRPT-RECORD                             18960039
168600                     AFTER 3 LINES                                18970039
168700             END-IF                                               18980039
168800             MOVE POPRPK-PO-PREPK-ID  TO PV-PO-PREPK-ID           18990039
168900             MOVE PV-LINE-QTY         TO PL2-PACK-UNITS           19000039
169000                                                                  19010039
169100             WRITE POSIRPT-RECORD FROM PACK-LINE-2                19020039
169200                 AFTER 1 LINES                                    19030039
169300             ADD +4                   TO PV-LINE-CNT              19040039
169400         END-IF                                                   19050039
169500         PERFORM 2800-FORMAT-PRINT-SKU-LINE                       19060039
169600     END-IF.                                                      19070039
169700                                                                  19080039
169800                                                                  19090039
169900******************************************************************19100039
170000*  CLOSES PO LINE CSR                                             19110039
170100******************************************************************19120039
170200 2353-CLOSE-PO-LINE-CSR.                                          19130039
170300                                                                  19140039
170400     EXEC SQL                                                     19150039
170500         CLOSE APP-PO-LINE-CSR                                    19160039
170600     END-EXEC.                                                    19170039
170700                                                                  19180039
170800     EVALUATE TRUE                                                19190039
170900         WHEN SQLCODE = +0                                        19200039
171000             CONTINUE                                             19210039
171100         WHEN SQLWARN NOT = SPACE                                 19220039
171200         WHEN SQLCODE NOT = +0                                    19230039
171300             MOVE '2353-CLOSE-PO-LINE-CSR'                        19240039
171400                                   TO PV-ABEND-PARAGRAPH          19250039
171500             PERFORM 9000-SQL-ABEND                               19260039
171600     END-EVALUATE.                                                19270039
171700                                                                  19280039
171800                                                                  19290039
171900******************************************************************19300039
172000*  CLOSES SHIPMENT CURSOR                                         19310039
172100******************************************************************19320039
172200 2400-CLOSE-SHIPMENT-CURSOR.                                      19330039
172300                                                                  19340039
172400     EXEC SQL                                                     19350039
172500         CLOSE SHIP-CSR                                           19360039
172600     END-EXEC.                                                    19370039
172700                                                                  19380039
172800     EVALUATE TRUE                                                19390039
172900         WHEN SQLCODE = +0                                        19400039
173000             CONTINUE                                             19410039
173100         WHEN SQLWARN NOT = SPACE                                 19420039
173200         WHEN SQLCODE NOT = +0                                    19430039
173300             MOVE '2400-CLOSE-SHIP-CSR'                           19440039
173400                                   TO PV-ABEND-PARAGRAPH          19450039
173500             PERFORM 9000-SQL-ABEND                               19460039
173600     END-EVALUATE.                                                19470039
173700                                                                  19480039
173800                                                                  19490039
173900******************************************************************19500039
174000*  FORMATS SKU DATA TO PRINT LINE AND PRINTS THEM.                19510039
174100******************************************************************19520039
174200 2800-FORMAT-PRINT-SKU-LINE.                                      19530039
174300                                                                  19540039
174400     MOVE PURITM-APP-PO-LNE-NBR       TO SL1-SKU-NBR.             19550039
174500                                                                  19560039
174600     MOVE PURCHS-DEPT-NBR             TO SL1-DEPT.                19570061
W24803     IF PV-SKU-NBR-IND = +0                                       19580055
W24803        MOVE XLT00004-MAJ-CL-NBR      TO  PV-CLASS                19590055
W24803        MOVE PV-CLASS                 TO  SL1-MAJ-CL              19600055
W24803        MOVE XLT00004-SUB-CL-NBR      TO  PV-CLASS                19610055
W24803        MOVE PV-CLASS                 TO  SL1-SUB-CL              19620055
W24803        MOVE XLT00003-SKU-NBR         TO  PV-SKU                  19630055
W24803        MOVE PV-SKU                   TO  SL1-SKU                 19640055
W24803        MOVE XLT00004-VS-NBR          TO  SL1-STYLE               19650055
W24803        MOVE XLT00003-SKU-DESC        TO  SL1-DESC                19660055
W24803        MOVE XLT00003-CSTM-CLOR-DESC  TO  SL2-COLOR               19670055
W24803        MOVE XLT00003-SIZE-DESC       TO  SL2-SIZE                19680055
W24803     ELSE                                                         19690055
W24803        MOVE PURITM-CL-NBR            TO  SL1-SUB-CL              19700055
W24803        MOVE PURCHS-DEPT-NBR          TO  PV-TEMP-DEPT            19710055
W24803        MOVE PURITM-CL-NBR            TO  PV-TEMP-CLASS           19720055
W24803        MOVE PURITM-SKU-SEQ-NBR       TO  PV-TEMP-SEQ             19730055
W24803        MOVE PV-TEMP-SKU              TO  SL1-SKU                 19740055
W24803        MOVE PURITM-CL-NBR(1:1)       TO  PV-TEMP-MAJ-CL-1        19750055
W24803        MOVE PV-TEMP-MAJ-CL           TO  SL1-MAJ-CL              19760055
W24803        MOVE PURITM-VEND-STYL-NAME    TO  SL1-STYLE               19770055
W24803        MOVE PURITM-SKU-DESC          TO  SL1-DESC                19780055
W24803        MOVE PURITM-COLOR-DESC        TO  SL2-COLOR               19790055
W24803        MOVE PURITM-SIZE-DESC         TO  SL2-SIZE                19800055
W24803     END-IF                                                       19810055
175100     MOVE PURITM-PREPK-RATO-QTY       TO SL1-RATO.                19820039
175200     MOVE ALLPLN-CURR-SPLIT-QTY       TO SL1-QTY.                 19830039
175500                                                                  19840039
175600     WRITE POSIRPT-RECORD FROM SKU-LINE-1                         19850039
175700       AFTER 2 LINES.                                             19860039
175800     WRITE POSIRPT-RECORD FROM SKU-LINE-2                         19870039
175900       AFTER 1 LINES.                                             19880039
176000     ADD +3                           TO PV-LINE-CNT.             19890039
176200*----------------------------------------------------------------*19900039
176300*    NAME REFORMATOR MODULE                                      *19910039
176400*----------------------------------------------------------------*19920039
176500*DP024-0000-FORMAT-NAME.                                          19930039
176600                                                                  19940039
176700     COPY DPPD024.                                                19950039
176800                                                                  19960039
176900                                                                  19970039
177000 2900-REPORT-HEADINGS.                                            19980039
177100                                                                  19990039
177200     ADD +1                        TO PV-PAGE-CNT.                20000039
177300     MOVE PV-PAGE-CNT              TO HL2-PAGE.                   20010039
177400                                                                  20020039
177500     WRITE POSIRPT-RECORD FROM HEADER-LINE1                       20030039
177600         AFTER ADVANCING PAGE.                                    20040039
177700     WRITE POSIRPT-RECORD FROM HEADER-LINE2                       20050039
177800         AFTER 1 LINES.                                           20060039
177900     WRITE POSIRPT-RECORD FROM HEADER-LINE3                       20070039
178000         AFTER 1 LINES.                                           20080039
178100     WRITE POSIRPT-RECORD FROM HEADER-LINE4                       20090039
178200         AFTER 2 LINES.                                           20100039
178300     WRITE POSIRPT-RECORD FROM HEADER-LINE5                       20110039
178400         AFTER 1 LINES.                                           20120039
178500     WRITE POSIRPT-RECORD FROM HEADER-LINE6                       20130039
178600         AFTER 1 LINES.                                           20140039
178700     WRITE POSIRPT-RECORD FROM HEADER-LINE7                       20150039
178800         AFTER 1 LINES.                                           20160039
178900                                                                  20170039
179000     MOVE +8                       TO PV-LINE-CNT.                20180039
179100                                                                  20190039
179200                                                                  20200039
179300******************************************************************20210039
179400*  - ERROR ROUTINE FOR DB2 ABENDS                                 20220039
179500******************************************************************20230039
179600 9000-SQL-ABEND.                                                  20240039
179700                                                                  20250039
179800     MOVE SQLCODE                  TO SQLCODE2.                   20260039
179900     MOVE SQLERRD(3)               TO SQLERRD3.                   20270039
180000     DISPLAY '** ABEND          **'.                              20280039
180100     DISPLAY '** PROGRAM        ** = POKRP081'.                   20290039
180200     DISPLAY '** PARAGRAPH      ** = ' PV-ABEND-PARAGRAPH.        20300039
180300     DISPLAY '** SQLCODE        ** = ' SQLCODE2.                  20310039
180400     DISPLAY '** ROWS PROCESSED ** = ' SQLERRD3.                  20320039
180500     DISPLAY '** SQLERRM        ** = ' SQLERRM.                   20330039
180600     DISPLAY '** SQLERRMC       ** = ' SQLERRMC.                  20340039
180700     MOVE +4013                    TO PV-ABEND-CODE.              20350039
180800     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         20360039
