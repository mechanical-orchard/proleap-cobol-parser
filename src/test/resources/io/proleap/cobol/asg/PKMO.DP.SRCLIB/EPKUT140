000100 IDENTIFICATION DIVISION.                                         00010000
000200 PROGRAM-ID.      EPKUT140.                                       00020000
000300 AUTHOR.          NANCY MARTIN.                                   00030000
000400 DATE-WRITTEN.    MAY 2004.                                       00040000
000500                                                                  00050000
000600*--------------------------------------------------------------*  00060000
000700*                                                              *  00070000
000800*  INPUTS:                                                     *  00080000
000900*      EPRD075   LIST OF REACTIVATED SKUS                      *  00090000
001000*      EPRD132   LIST OF EXCLUDED SKUS                         *  00100000
001100*         NOTE - THIS PROGRAM DOES NOT USE A CONTROL CARD      *  00110000
001200*                                                              *  00120000
001300* OUTPUTS:                                                     *  00130000
001400*                                                              *  00140000
001500*      EPRD135   FILE OF EXCLUDED SKUS AND / OR REACTIVATED    *  00150000
001600*     (EPRD135)     SKUS THAT SHOULD BE PROCSSED AS POTENTIAL  *  00160000
001700*                     CHANGES RELATED TO FUTURE PERM CHANGES.  *  00170000
001800*                                                              *  00180000
001900* DESCRIPTION:                                                 *  00190000
002000*                                                              *  00200000
002100*      PROGRAM READS THRU EACH INPUT FILE - CHECKS FOR THE     *  00210000
002200*  CORRESPONDING XST_SKU RECORD AND PUTS OUT AN OUTPUT RECORD  *  00220000
002300*  AS APPPROPRIATE. THE SKU WILL BE SELECTED TO GET THE        *  00230000
002400*  INTERNAL UPC (AND VALIDATE IT EXISTS) FROM XS SKU TABLE.    *  00240000
002600*       OUTPUT RECORDS WILL ZERO FILL OTHER DATA ELEMENTS.     *  00250000
002700*                                                              *  00260000
002800*--------------------------------------------------------------*  00270000
002900*--------------------------------------------------------------*  00280000
003000* HISTORY LOG:                                                    00290000
003100*--------------------------------------------------------------*  00300000
003200* DATE:                                                           00310000
003300* WR/IR#:                                                         00320000
003400* PROGRAMMER:                                                     00330000
003500* DESCRIPTION:                                                    00340000
003600*                                                                 00350000
003700*--------------------------------------------------------------*  00360000
003800 ENVIRONMENT DIVISION.                                            00370000
003900*--------------------------------------------------------------*  00380000
004000 CONFIGURATION SECTION.                                           00390000
004100 SOURCE-COMPUTER.        IBM-3090.                                00400000
004200 OBJECT-COMPUTER.        IBM-3090.                                00410000
004300                                                                  00420000
004400 INPUT-OUTPUT SECTION.                                            00430000
004500                                                                  00440000
004600 FILE-CONTROL.                                                    00450000
004700                                                                  00460000
004800     SELECT REACTIVATED-SKU-FILE                                  00470000
004900            ASSIGN TO INP01.                                      00480000
005000                                                                  00490000
005100     SELECT EXCLUDED-SKU-FILE                                     00500000
005200            ASSIGN TO INP02.                                      00510000
005300                                                                  00520000
005400     SELECT FPLU-CHG-FILE                                         00530000
005500            ASSIGN TO OUT01.                                      00540000
005600                                                                  00550000
005700 DATA DIVISION.                                                   00560000
005800 FILE SECTION.                                                    00570000
005900                                                                  00580000
006000 FD  REACTIVATED-SKU-FILE                                         00590000
006100     RECORDING MODE F                                             00600000
006200     BLOCK CONTAINS 0 RECORDS                                     00610000
006300     LABEL RECORDS ARE OMITTED                                    00620000
006400     DATA RECORD IS REACTIVATED-SKU-RECORD.                       00630000
006500 01  REACTIVATED-SKU-RECORD       PIC  X(050).                    00640000
006600                                                                  00650000
006700 FD  EXCLUDED-SKU-FILE                                            00660000
006800     RECORDING MODE F                                             00670000
006900     BLOCK CONTAINS 0 RECORDS                                     00680000
007000     LABEL RECORDS ARE OMITTED                                    00690000
007100     DATA RECORD IS EXCLUDED-SKU-RECORD.                          00700000
007200 01  EXCLUDED-SKU-RECORD          PIC  X(050).                    00710000
007300                                                                  00720000
007400 FD  FPLU-CHG-FILE                                                00730000
007500     RECORDING MODE F                                             00740000
007600     BLOCK CONTAINS 0 RECORDS                                     00750000
007700     LABEL RECORDS ARE OMITTED                                    00760000
007800     DATA RECORD IS FPLU-CHG-RECORD.                              00770000
007900 01  FPLU-CHG-RECORD              PIC  X(60).                     00780000
008000                                                                  00790000
008100 WORKING-STORAGE SECTION.                                         00800000
008200*--------------------------------------------------------------*  00810000
008300* PS - PROGRAM SWITCHES                                           00820000
008400*--------------------------------------------------------------*  00830000
008500 01  PS-PROGRAM-SWITCHES.                                         00840000
008600     05  PS-END-OF-REAC-SKU-SW        PIC  X(001) VALUE 'N'.      00850000
008700         88  PS-END-OF-REAC-SKU-FILE              VALUE 'Y'.      00860000
008800         88  PS-NOT-END-OF-REAC-SKU-FILE          VALUE 'N'.      00870000
008900                                                                  00880000
009000     05  PS-END-OF-EXCL-SKU-SW        PIC  X(001) VALUE 'N'.      00890000
009100         88  PS-END-OF-EXCL-SKU-FILE              VALUE 'Y'.      00900000
009200         88  PS-NOT-END-OF-EXCL-SKU-FILE          VALUE 'N'.      00910000
009300                                                                  00920000
009400*--------------------------------------------------------------*  00930000
009500* PROGRAM CONSTANTS                                               00940000
009600*--------------------------------------------------------------*  00950000
009700 01  PC-PROGRAM-CONSTANTS.                                        00960000
009800     05  PC-PROGRAM-NAME          PIC X(08) VALUE 'EPKUT140'.     00970000
009900     05  PC-MAX-RETRIES           PIC S9(4) VALUE +5 COMP.        00980000
010000     05  PC-TEN-BLANKS            PIC X(10) VALUE SPACES.         00990000
010100     05  PC-ASTERISK-LINE         PIC X(80) VALUE ALL '*'.        01000000
010200                                                                  01010000
010300*--------------------------------------------------------------*  01020000
010400* PV- PROGRAM VARIABLES                                           01030000
010500*--------------------------------------------------------------*  01040000
010600 01  PV-PROGRAM-VARAIBLES.                                        01050000
010800     05  PV-PARAGRAPH-NAME        PIC X(40)   VALUE SPACES.       01070000
010900     05  PV-SQL-SUB               PIC S9(04)  VALUE 0  COMP.      01080000
011000     05  PV-ABEND-CODE            PIC 9999    VALUE 0  COMP.      01090000
011100                                                                  01100000
011200*--------------------------------------------------------------*  01110000
011300* PV- DB2 VARIABLES.                                              01120000
011400*--------------------------------------------------------------*  01130000
011500 01  PV-DB2-VARAIBLES.                                            01140000
011700     05  PV-DB2-INTR-UPC-ID-TEMP  PIC S9(10) COMP   VALUE 0.      01141001
011600     05  PV-DB2-SKU-NBR           PIC S9(8)V COMP-3 VALUE 0.      01150000
011800                                                                  01170001
011900*--------------------------------------------------------------*  01180000
012000* EPRD075 - REACTIVATED SKU FILE LAYOUT                           01190000
012100*--------------------------------------------------------------*  01200000
012200     COPY EPRD075.                                                01210000
012300                                                                  01220000
012400*--------------------------------------------------------------*  01230000
012500* EPRD132 - EXCLUDED SKU FILE LAYOUT                              01240000
012600*--------------------------------------------------------------*  01250000
012700     COPY EPRD132.                                                01260000
012800                                                                  01270000
012900*--------------------------------------------------------------*  01280000
013000* EPRD135 PERM RECORD LAYOUT                                      01290000
013100*--------------------------------------------------------------*  01300000
013200     COPY EPRD135.                                                01310000
013300                                                                  01320000
013400*--------------------------------------------------------------*  01330000
013500* VARIABLES REQUIRED FOR THE FORMAT SQLCA ROUTINE DPPD004         01340000
013600*--------------------------------------------------------------*  01350000
013700     COPY DPWS004.                                                01360000
013800                                                                  01370000
013900*--------------------------------------------------------------*  01380000
014000* DB2 ABEND COPYBOOK                                              01390000
014100*--------------------------------------------------------------*  01400000
014200     COPY DPWS900.                                                01410000
014300                                                                  01420000
014400*--------------------------------------------------------------*  01430000
014500* DB2 MESSAGE AREA                                                01440000
014600*--------------------------------------------------------------*  01450000
014700     COPY SQLCA2.                                                 01460000
014800                                                                  01470000
014900*--------------------------------------------------------------*  01480000
015000* PROGRAM COUNTERS                                                01490000
015100*--------------------------------------------------------------*  01500000
015200****NEM****WORK HERE                                              01510000
015300 01  PV-PROGRAM-COUNTERS         COMP-3.                          01520000
015400     05  PV-REACTIVATED-READS     PIC 9(9) VALUE 0.               01530000
015500     05  PV-EXCLUDED-READS        PIC 9(9) VALUE 0.               01540000
015600                                                                  01550000
015700     05  PV-MISSING-SKU-COUNT      PIC 9(9) VALUE 0.              01560000
015800     05  PV-FOUND-SKU-COUNT        PIC 9(9) VALUE 0.              01570000
015900                                                                  01580000
016000     05  PV-CNT-OUTPUT-RECORDS    PIC 9(9) VALUE 0.               01590000
016100     05  PV-CNT-OUT075-RECORDS    PIC 9(9) VALUE 0.               01600000
016200     05  PV-CNT-OUT132-RECORDS    PIC 9(9) VALUE 0.               01610000
016300                                                                  01620000
016400*--------------------------------------------------------------*  01630000
016500* ERROR HANDLING                                                  01640000
016600*--------------------------------------------------------------*  01650000
016700 01  PV-MISC-ABEND-FIELDS.                                        01660000
016800     05  PV-OPERATION-MSG-1      PIC X(40) VALUE SPACES.          01670000
016900     05  PV-OPERATION-MSG-2      PIC X(40) VALUE SPACES.          01680000
017000     05  PV-DB2-OPERATION        PIC X(30) VALUE SPACES.          01690000
017100                                                                  01700000
017200 01  ABEND-CODE                  PIC S9(4) VALUE 0  COMP SYNC.    01710000
017300     88  ABEND-4003-CTRL-CARD-ERROR        VALUE +4003.           01720000
017400     88  ABEND-4013-DB2-ERROR              VALUE +4013.           01730000
017500     88  ABEND-4019-CAL-SUB-ERROR          VALUE +4019.           01740000
017600     88  ABEND-4020-MQ-ERROR               VALUE +4020.           01750000
017700     88  ABEND-4444-FORCED-ABEND           VALUE +4444.           01760000
017800     88  ABEND-4008-PGM-LOGIC-ERROR        VALUE +4008.           01770000
017900                                                                  01780000
018000*--------------------------------------------------------------*  01790000
018100* DB2 COMMUNICATIONS AREA                                         01800000
018200*--------------------------------------------------------------*  01810000
018300     EXEC SQL                                                     01820000
018400       INCLUDE SQLCA                                              01830000
018500     END-EXEC.                                                    01840000
018600                                                                  01850000
018700*--------------------------------------------------------------*  01860000
018800* DB2 TABLE XST00010 (XST_SKU) - SKU TABLE                        01870000
018900*--------------------------------------------------------------*  01880000
019000     EXEC SQL                                                     01890000
019100       INCLUDE XST00010                                           01900000
019200     END-EXEC.                                                    01910000
019300                                                                  01920000
019400 LINKAGE SECTION.                                                 01930000
019500                                                                  01940000
019600*--------------------------------------------------------------*  01950000
019700 PROCEDURE DIVISION.                                              01960000
019800*--------------------------------------------------------------*  01970000
019900 0000-MAINLINE.                                                   01980000
020000                                                                  01990000
020100     DISPLAY ' '.                                                 02000000
020200     DISPLAY '*********************************************'.     02010000
020300     DISPLAY '   PROGRAM NAME: ' PC-PROGRAM-NAME, ' START'.       02020000
020400     DISPLAY '*********************************************'.     02030000
020500     DISPLAY ' '.                                                 02040000
020600     PERFORM 1000-INITIALIZATION.                                 02050000
020700                                                                  02060000
020800     IF PS-NOT-END-OF-REAC-SKU-FILE                               02070000
020900        PERFORM 3000-CREATE-REACTIVATED-LIST                      02080000
021000     END-IF.                                                      02090000
021100                                                                  02100000
021200     IF PS-NOT-END-OF-EXCL-SKU-FILE                               02110000
021300        PERFORM 4000-CREATE-EXCLUDED-LIST                         02120000
021400     END-IF.                                                      02130000
021500                                                                  02140000
021600     IF  PV-EXCLUDED-READS > 0                                    02150000
021700         MOVE 04 TO RETURN-CODE                                   02160000
021800         DISPLAY '****>>>> OUTPUT RECS > 0 - SETTING RC 4 **'     02170000
021900     ELSE                                                         02180000
022000         DISPLAY '****>>>> OUTPUT RECS = 0 - NOT SETTING RC **'   02190000
022100     END-IF.                                                      02200000
022200     PERFORM 9999-WRAPUP.                                         02210000
022300                                                                  02220000
022400     GOBACK.                                                      02230000
022500                                                                  02240000
022600*0000-EXIT.                                                       02250000
022700                                                                  02260000
022800*--------------------------------------------------------------*  02270000
022900* 1000-INITIALIZATION.                                            02280000
023000*     INITIALIZATION AREA - INITIALIZES ALL VARIABLES, OPENS      02290000
023100*     FILES, DOES INITIAL READ OF BOTH INUPUT FILES.              02300000
023200*--------------------------------------------------------------*  02310000
023300 1000-INITIALIZATION.                                             02320000
023400                                                                  02330000
023500     OPEN INPUT  REACTIVATED-SKU-FILE,                            02340000
023600                 EXCLUDED-SKU-FILE.                               02350000
023700     OPEN OUTPUT FPLU-CHG-FILE.                                   02360000
023800                                                                  02370000
023900     PERFORM 7000-READ-REACTIVATED.                               02380000
024000     IF PS-END-OF-REAC-SKU-FILE                                   02390000
024100       DISPLAY ' '                                                02400000
024200       DISPLAY '** REACTIVATED SKU FILE IS EMPTY  '               02410000
024300       DISPLAY ' '                                                02420000
024400     ELSE                                                         02430000
024600       DISPLAY '>>>> FIRST REACTIVATED RECORD - ',                02440000
024700               EP075-XREF-SKU-CHG-REC                             02450000
024800     END-IF.                                                      02460000
024900                                                                  02470000
025000     PERFORM 7100-READ-EXCLUDED.                                  02480000
025100     IF PS-END-OF-EXCL-SKU-FILE                                   02490000
025200       DISPLAY ' '                                                02500000
025300       DISPLAY '** EXCLUDED SKU FILE IS EMPTY  '                  02510000
025400       DISPLAY ' '                                                02520000
025500     ELSE                                                         02530000
025700       DISPLAY '>>>> FIRST EXCLUDED RECORD - ',                   02540000
025800               EP132-PLU-EXCL-REC                                 02550000
025900     END-IF.                                                      02560000
026000                                                                  02570000
026100*1000-EXIT.                                                       02580000
026200                                                                  02590000
026300*--------------------------------------------------------------*  02600000
026400* 3000-CREATE-REACTIVATED-LIST                                 *  02610000
026500*                                                              *  02620000
026600*      THIS PROCESS READS THRU THE FILE AND PUTS OUT A FPLU    *  02630000
026700*  RECORD FOR EACH REACTIVATED RECORD THAT A SKU IS FOUND FOR  *  02640000
026800*                                                              *  02650000
026900*--------------------------------------------------------------*  02660000
027000 3000-CREATE-REACTIVATED-LIST.                                    02670000
027100                                                                  02680000
027200     DISPLAY PC-ASTERISK-LINE.                                    02690000
027300     DISPLAY '     START OF REACTIVATED FILE'.                    02700000
027400     DISPLAY PC-ASTERISK-LINE.                                    02710000
027500                                                                  02720000
027600     PERFORM UNTIL PS-END-OF-REAC-SKU-FILE                        02730000
027700             ADD 1 TO PV-REACTIVATED-READS                        02740000
027800             PERFORM 3400-GET-SKU-AND-WRITE                       02750000
027900             PERFORM 7000-READ-REACTIVATED                        02760000
028000     END-PERFORM.                                                 02770000
028100                                                                  02780000
028200*3000-EXIT.                                                       02790000
028300                                                                  02800000
028400*--------------------------------------------------------------*  02810000
028500* 3400-GET-SKU-AND-WRITE.                                      *  02820000
028600*--------------------------------------------------------------*  02830000
028700 3400-GET-SKU-AND-WRITE.                                          02840000
028800                                                                  02850000
028900     PERFORM 3600-SELECT-SKU.                                     02860000
029000                                                                  02870000
029100     PERFORM 6000-FORMAT-075OUT.                                  02880000
029200     PERFORM 8000-WRITE-FPLU-HIER-RECORD.                         02890000
029300                                                                  02900000
029400*3400-EXIT.                                                       02910000
029500                                                                  02920000
029600*--------------------------------------------------------------*  02930000
029700* 3600-SELECT-SKU.                                             *  02940000
029800*--------------------------------------------------------------*  02950000
029900 3600-SELECT-SKU.                                                 02960000
030000                                                                  02970000
030100     MOVE '3600-SELECT-SKU' TO PV-PARAGRAPH-NAME.                 02980000
030200     MOVE EP075-INTERNAL-UPC-ID TO PV-DB2-INTR-UPC-ID-TEMP.       02990001
030201     MOVE PV-DB2-INTR-UPC-ID-TEMP TO XST00010-INTR-UPC-ID.        02991001
030300                                                                  03000000
030400     PERFORM                                                      03010000
030500        WITH TEST AFTER                                           03020000
030600      VARYING PV-SQL-SUB                                          03030000
030700         FROM 1 BY 1                                              03040000
030800        UNTIL (PV-SQL-SUB GREATER PC-MAX-RETRIES                  03050000
030900                    OR  SQLCODE = 0                               03060000
031000                    OR  SQLCODE = +100)                           03070000
031100         EXEC SQL                                                 03080000
031200              SELECT  SKU_NBR                                     03090000
031300                INTO  :PV-DB2-SKU-NBR                             03100000
031400                FROM  XST_SKU                                     03110000
031500               WHERE  INTR_UPC_ID = :XST00010-INTR-UPC-ID         03120001
031600                WITH UR                                           03130000
031700         END-EXEC                                                 03140000
031800                                                                  03150000
031900         EVALUATE TRUE                                            03160000
032000             WHEN SQLCODE = -911                                  03170000
032100             WHEN SQLCODE = -913                                  03180000
032200                  CONTINUE                                        03190000
032300             WHEN SQLCODE = 0                                     03200000
032400                  CONTINUE                                        03210000
032500****NEMDEL        DISPLAY '*** SKU OK - ' XST00010-INTR-UPC-ID    03220001
032600             WHEN SQLCODE = +100                                  03230000
032700                  DISPLAY '*** SKU NOT FOUND FOR - ',             03240000
032800                     EP075-INTERNAL-UPC-ID, ' -- BYPASSING **'    03250000
032900                  ADD 1 TO PV-MISSING-SKU-COUNT                   03260000
033000                  MOVE ZEROS TO  PV-DB2-SKU-NBR                   03270001
033100             WHEN OTHER                                           03280000
033200                  MOVE 'ERROR ON SKU SELECT '                     03290000
033300                              TO PV-DB2-OPERATION                 03300000
033400                  PERFORM 9900-SQL-ABEND-ROUTINE                  03310000
033500         END-EVALUATE                                             03320000
033600     END-PERFORM.                                                 03330000
033700     IF PV-SQL-SUB GREATER PC-MAX-RETRIES                         03340000
033800        MOVE '3600-SELECT-SKU' TO  PV-PARAGRAPH-NAME              03350000
033900        MOVE 'SELECT RETRIES EXCEEDED'                            03360000
034000                               TO  PV-DB2-OPERATION               03370000
034100        PERFORM 9900-SQL-ABEND-ROUTINE                            03380000
034200     END-IF.                                                      03390000
034300                                                                  03400000
034400*3600-EXIT.                                                       03410000
034500                                                                  03420000
034600*--------------------------------------------------------------*  03430000
034700* 4000-CREATE-EXCLUDED-LIST                                    *  03440000
034800*                                                              *  03450000
034900*      THIS PROCESS READS THRU THE FILE AND PUTS OUT A FPLU    *  03460000
035000*  RECORD FOR EACH EXCLUDED RECORD (SKU IS ON INPUT RECORD)    *  03470000
035100*                                                              *  03480000
035200*--------------------------------------------------------------*  03490000
035300 4000-CREATE-EXCLUDED-LIST.                                       03500000
035400                                                                  03510000
035500     DISPLAY PC-ASTERISK-LINE.                                    03520000
035600     DISPLAY '     START OF EXCLUDED FILE'.                       03530000
035700     DISPLAY PC-ASTERISK-LINE.                                    03540000
035800                                                                  03550000
035900     PERFORM UNTIL PS-END-OF-EXCL-SKU-FILE                        03560000
036000             ADD 1 TO PV-EXCLUDED-READS                           03570000
036100             PERFORM 6500-FORMAT-132OUT                           03580000
036200             PERFORM 8000-WRITE-FPLU-HIER-RECORD                  03590000
036300             PERFORM 7100-READ-EXCLUDED                           03600000
036400     END-PERFORM.                                                 03610000
036500                                                                  03620000
036600*4000-EXIT.                                                       03630000
036700                                                                  03640000
036800*--------------------------------------------------------------*  03650000
036900* 6000-FORMAT-075OUT.                                             03660000
037000*    INITIALIZE OUTPUT RECORD, FILL IN DATA AND WRITE RECORD   *  03670000
037100*--------------------------------------------------------------*  03680000
037200 6000-FORMAT-075OUT.                                              03690000
037300                                                                  03700000
037400     INITIALIZE EP135-FPLU-HIER-RECORD.                           03710000
037500                                                                  03720000
           MOVE 'SKU'      TO EP135-MDSE-HIER-CDE.                      03730000
037600     MOVE ZEROES     TO EP135-DEPT-NBR,                           03740000
037700                        EP135-MAJ-CLASS,                          03750000
037800                        EP135-SUB-CLASS,                          03760000
037900                        EP135-VENDOR-STYLE.                       03770000
038000     MOVE EP075-INTERNAL-UPC-ID TO EP135-INTR-UPC-ID.             03780000
038100     MOVE PV-DB2-SKU-NBR        TO EP135-SKU-NBR.                 03790000
038200     ADD 1 TO PV-CNT-OUT075-RECORDS.                              03800000
038300                                                                  03810000
038400*6000-EXIT.                                                       03820000
038500                                                                  03830000
038600*--------------------------------------------------------------*  03840000
038700* 6500-FORMAT-075OUT.                                             03850000
038800*    INITIALIZE OUTPUT RECORD, FILL IN DATA AND WRITE RECORD   *  03860000
038900*--------------------------------------------------------------*  03870000
039000 6500-FORMAT-132OUT.                                              03880000
039100                                                                  03890000
039200     INITIALIZE EP135-FPLU-HIER-RECORD.                           03900000
039300                                                                  03910000
           MOVE 'SKU'      TO EP135-MDSE-HIER-CDE.                      03920000
039400     MOVE ZEROES            TO EP135-DEPT-NBR,                    03930000
039500                               EP135-MAJ-CLASS,                   03940000
039600                               EP135-SUB-CLASS,                   03950000
039700                               EP135-VENDOR-STYLE.                03960000
039800     MOVE EP132-INTR-UPC-ID TO EP135-INTR-UPC-ID.                 03970000
039900     MOVE EP132-SKU-NBR     TO EP135-SKU-NBR.                     03980000
040000     ADD 1 TO PV-CNT-OUT132-RECORDS.                              03990000
040100                                                                  04000000
040200*6500-EXIT.                                                       04010000
040300                                                                  04020000
040400*--------------------------------------------------------------*  04030000
040500* 7000-READ-REACTIVATED.                                          04040000
040600*     READ REACTIVATED SKU FILE EPRD075.                          04050000
040700*          THIS FILE MAY OR MAY NOT CONTAIN DATA                  04060000
040800*--------------------------------------------------------------*  04070000
040900 7000-READ-REACTIVATED.                                           04080000
041000                                                                  04090000
041100     READ REACTIVATED-SKU-FILE                                    04100000
041200          INTO EP075-XREF-SKU-CHG-REC                             04110000
041300       AT END                                                     04120000
041400          SET PS-END-OF-REAC-SKU-FILE TO TRUE.                    04130000
041500                                                                  04140000
041600*7000-EXIT.                                                       04150000
041700                                                                  04160000
041800*--------------------------------------------------------------*  04170000
041900* 7100-READ-EXCLUDED.                                             04180000
042000*     READ REACTIVATED SKU FILE EPRD132.                          04190000
042100*          THIS WILL NOT CONTAIN DATA EXCEPT WHEN THE MONTHLY     04200000
042200*          EXCLUDED SKU PROCESS HAS RUN (THEN MAY OR MAY NOT).    04210000
042300*--------------------------------------------------------------*  04220000
042400 7100-READ-EXCLUDED.                                              04230000
042500                                                                  04240000
042600     READ EXCLUDED-SKU-FILE                                       04250000
042700          INTO EP132-PLU-EXCL-REC                                 04260000
042800       AT END                                                     04270000
042900          SET PS-END-OF-EXCL-SKU-FILE TO TRUE.                    04280000
043000                                                                  04290000
043100*7100-EXIT.                                                       04300000
043200                                                                  04310000
043300*--------------------------------------------------------------*  04320000
043400* 8000-WRITE-FPLU-HIER-RECORD.                                    04330000
043500*--------------------------------------------------------------*  04340000
043600 8000-WRITE-FPLU-HIER-RECORD.                                     04350000
043700                                                                  04360000
043800     MOVE '8000-WRITE-FPLU-HIER-RECORD' TO PV-PARAGRAPH-NAME.     04370000
043900                                                                  04380000
044000     WRITE FPLU-CHG-RECORD FROM EP135-FPLU-HIER-RECORD.           04390000
044100                                                                  04400000
044200     ADD 1           TO PV-CNT-OUTPUT-RECORDS.                    04410000
044300                                                                  04420000
044400*8000-EXIT.                                                       04430000
044500                                                                  04440000
044600*--------------------------------------------------------------*  04450000
044700* 9900-SQL-ABEND-ROUTINE.                                         04460000
044800*     SQL ABEND ROUTINE.                                          04470000
044900*--------------------------------------------------------------*  04480000
045000 9900-SQL-ABEND-ROUTINE.                                          04490000
045100     DISPLAY '** ABEND     **'.                                   04500000
045200     DISPLAY '** PROGRAM   ** = ' PC-PROGRAM-NAME.                04510000
045300     DISPLAY '** PARAGRAPH ** = ' PV-PARAGRAPH-NAME.              04520000
045400     DISPLAY '** OPERATION ** = ' PV-DB2-OPERATION.               04530000
045500                                                                  04540000
045600     COPY DPPD004.                                                04550000
045700     SET ABEND-4013-DB2-ERROR TO TRUE.                            04560000
045800     CALL 'ILBOABN0' USING ABEND-CODE.                            04570000
045900                                                                  04580000
046000*9900-EXIT.                                                       04590000
046100                                                                  04600000
046200*--------------------------------------------------------------*  04610000
046300* 9999-WRAPUP.                                                    04620000
046400*     END OF PROGRAM ROUTINE.  CLOSES ALL FILES AND DISPLAYS      04630000
046500*     ANY DATA FROM THE PROGRAM.                                  04640000
046600*--------------------------------------------------------------*  04650000
046700 9999-WRAPUP.                                                     04660000
046800     CLOSE REACTIVATED-SKU-FILE,                                  04670000
046900           EXCLUDED-SKU-FILE,                                     04680000
047000           FPLU-CHG-FILE.                                         04690000
047100                                                                  04700000
047200     DISPLAY ' '.                                                 04710000
047300     DISPLAY '*************************************************'. 04720000
047400     DISPLAY ' '.                                                 04730000
047500     DISPLAY 'NUMBER OF REACTIVATED SKU READS:        '           04740000
047600              PV-REACTIVATED-READS, ' -- EPRD075'                 04750000
047700     DISPLAY 'NUMBER OF MISSING SKU ENCOUNTERED:      '           04760000
047800              PV-MISSING-SKU-COUNT.                               04770000
047900     COMPUTE PV-FOUND-SKU-COUNT =                                 04780000
048000         PV-REACTIVATED-READS -  PV-MISSING-SKU-COUNT.            04790000
048100     DISPLAY '      NUMBER OF XS SKU RECORDS FOUND:   '           04800000
048200              PV-FOUND-SKU-COUNT.                                 04810000
048300     DISPLAY 'NUMBER OF EXCLUDED SKU READS:           '           04820000
048400              PV-EXCLUDED-READS, ' -- EPRD132'                    04830000
048500     DISPLAY ' '.                                                 04840000
048600     DISPLAY 'NUMBER OF OUTPUT EP135 RECORDS WRITTEN: '           04850000
048700              PV-CNT-OUTPUT-RECORDS,                              04860000
048800             ' - DD OUT01'.                                       04870000
048900     DISPLAY PC-TEN-BLANKS,                                       04880000
049000             'OUTPUT FROM EPRD075 RECORDS:  '                     04890000
049100              PV-CNT-OUT075-RECORDS,                              04900000
049200             ' - REACTIVATED'.                                    04910000
049300     DISPLAY PC-TEN-BLANKS,                                       04920000
049400             'OUTPUT FROM EPRD132 RECORDS:  '                     04930000
049500              PV-CNT-OUT132-RECORDS,                              04940000
049600             ' - EXCLUDED'.                                       04950000
049700     DISPLAY ' '.                                                 04960000
049800     DISPLAY '*********************************************'.     04970000
049900     DISPLAY '   PROGRAM NAME: ' PC-PROGRAM-NAME, ' END'.         04980000
050000     DISPLAY '*********************************************'.     04990000
050100                                                                  05000000
050200*9999-EXIT.                                                       05010000
