000100***************************************************************** 00010035
000200 IDENTIFICATION DIVISION.                                         00020035
000300***************************************************************** 00030035
000400                                                                  00040035
000500 PROGRAM-ID.             ARKUT143.                                00050064
000600 AUTHOR.                 COGNIZANT.                               00060035
000700 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00070035
000800 DATE-WRITTEN            JULY  2019.                              00080062
000900 DATE-COMPILED.                                                   00090035
001000                                                                  00100035
001100***************************************************************** 00110035
001200*  PURPOSE:                                                       00120035
001300*  THIS PROGRAM WILL TOKENIZE THE BELOW FIELDS IN THE INPUT FILE  00130062
001600*  1) AR143-CHD-ACCOUNT-NUMBER                                    00140064
001700*  PROTEGRITY MODULE WILL BE INVOKED TO TOKENIZE THE FIELDS       00150062
001800*                                                                 00160035
001900*  INPUT:  TRAN ACTVTY REPORT FILE                                00170065
002000*  OUTPUT: TRAN ACTVTY REPORT FILE WITH TOKENIZED ACCOUNT NUMBER  00180065
002100*                                                                 00190035
002200***************************************************************** 00200035
002300*----------------------------------------------------------------*00210035
002400*                                                                *00220035
002500* DATE:        07/24/2019                                        *00230062
002600* WR/IR#:      CHG0230275                                        *00240072
002700* PROGRAMMER:  COGNIZANT                                         *00250035
002800* DESCRIPTION: INITIAL VERSION CREATED FOR FD FILE TRANSFER      *00260065
002900*              PROJECT                                           *00270035
003000*                                                                *00280035
003100*----------------------------------------------------------------*00290035
003200***************************************************************** 00300035
003300 ENVIRONMENT DIVISION.                                            00310035
003400***************************************************************** 00320035
003500                                                                  00330035
003600 CONFIGURATION SECTION.                                           00340035
003700                                                                  00350035
003800 SOURCE-COMPUTER.        IBM-3090.                                00360035
003900                                                                  00370035
004000 OBJECT-COMPUTER.        IBM-3090.                                00380035
004100                                                                  00390035
004200 INPUT-OUTPUT SECTION.                                            00400035
004300                                                                  00410035
004400 FILE-CONTROL.                                                    00420035
004500                                                                  00430035
004600     SELECT AR143-INPUT-FILE                                      00440064
004700         ASSIGN TO INP01.                                         00450035
004800                                                                  00460035
004900     SELECT AR143-TOKEN-FILE                                      00470064
005000         ASSIGN TO OUT01.                                         00480035
005100                                                                  00490035
005200******************************************************************00500035
005300 DATA DIVISION.                                                   00510035
005400******************************************************************00520035
005500                                                                  00530035
005600 FILE SECTION.                                                    00540035
005700                                                                  00550035
005800 FD  AR143-INPUT-FILE                                             00560064
005900     RECORDING MODE IS V                                          00570069
006000     BLOCK CONTAINS 0 RECORDS                                     00580035
006100     LABEL RECORDS ARE STANDARD                                   00590035
006200     RECORD IS VARYING FROM 1 TO 241.                             00600070
006300                                                                  00610035
006400 01  AR143-INPUT-RECORD          PIC X(241).                      00620069
006500                                                                  00630035
006600 FD  AR143-TOKEN-FILE                                             00640064
006700     RECORDING MODE IS V                                          00650071
006800     BLOCK CONTAINS 0 RECORDS                                     00660035
006900     LABEL RECORDS ARE STANDARD                                   00670035
007000     RECORD IS VARYING FROM 1 TO 241.                             00680071
007100                                                                  00690035
007200 01  AR143-TOKEN-RECORD          PIC X(241).                      00700071
007300                                                                  00710035
007400******************************************************************00720035
007500 WORKING-STORAGE SECTION.                                         00730035
007600******************************************************************00740035
007700 01  FILLER                            PIC X(50)  VALUE           00750035
007800     ' *** WORKING STORAGE STARTS HERE FOR ARKUT143 *** '.        00760065
007900                                                                  00770035
008000 01  ABEND-CODE                        PIC S9(04) VALUE +0.       00780057
008100                                                                  00790057
008200 01  PS-PROGRAM-SWITCHES.                                         00800035
008300     05  PS-END-OF-AR143-SW            PIC X(01)  VALUE 'N'.      00810064
008400         88  PS-NOT-END-OF-AR143                  VALUE 'N'.      00820064
008500         88  PS-END-OF-AR143                      VALUE 'Y'.      00830064
008600                                                                  00840035
008700 01  PC-CONSTANTS.                                                00850035
008800     05  PC-PROGRAM-NAME               PIC  X(08) VALUE           00860035
008900                                                 'ARKUT143'.      00870065
009000 01  PV-PROGRAM-VARIABLES.                                        00880035
009100     05  PV-AR143-READ-COUNT           PIC  9(07) VALUE ZEROES.   00890064
009200     05  PV-AR143-WRITE-COUNT          PIC  9(07) VALUE ZEROES.   00900064
009300     05  PV-INPUT-LENGTH               PIC  9(09).                00910056
009400                                                                  00920035
009410********                                                          00930059
009500******************************************************************00940062
009600* RECORD LAYOUT FOR SETTLEMENT ADJUSTMENT FILE- INPUT AND OUTPUT *00950062
009700******************************************************************00960062
009701     COPY ARRD143.                                                00970065
009702********                                                          00980059
010000******************************************************************00990035
010100* LAYOUT THAT DEFINES THE PARAMETERS NEEDED TO INVOKE PROTEGRITY *01000035
010200* MODULE                                                         *01010035
010300******************************************************************01020035
010400     COPY PTYCCSIP.                                               01030035
010500                                                                  01040035
010600******************************************************************01050035
010700* LAYOUT THAT DEFINES THE WORKING VARIABLES TO INVOKE PROTEGRITY *01060035
010800* MODULE                                                         *01070035
010900******************************************************************01080035
011000     COPY DPWS031.                                                01090052
011100                                                                  01100035
011200******************************************************************01110035
011300                                                                  01120035
011400 PROCEDURE DIVISION.                                              01130035
011500                                                                  01140035
011600 0000-MAINLINE-PARA.                                              01150035
011700                                                                  01160035
011800     PERFORM 1000-INITIALIZE.                                     01170035
011900                                                                  01180035
012000     PERFORM 2000-PROCESS-RECORDS                                 01190035
012100           UNTIL PS-END-OF-AR143.                                 01200064
012200                                                                  01210035
012300     PERFORM 9000-EOJ-ROUTINE.                                    01220035
012400                                                                  01230035
012500     STOP RUN.                                                    01240035
012600                                                                  01250035
012700******************************************************************01260035
012800* 1000-INITIALIZE                                                 01270035
012900*     INITIALIZE THE VARIABLES, OPEN THE INPUT AND OUTPUT FILES   01280035
013000*     AND READ THE INPUT FILE                                     01290035
013100******************************************************************01300035
013200 1000-INITIALIZE.                                                 01310035
013300                                                                  01320035
013400     DISPLAY 'PROGRAM - ' PC-PROGRAM-NAME.                        01330035
013500     INITIALIZE PV-PROGRAM-VARIABLES.                             01340035
013600     MOVE PC-PROGRAM-NAME               TO DP031-PROGRAM-NAME.    01350055
013700                                                                  01360035
013800     OPEN INPUT  AR143-INPUT-FILE                                 01370064
013900          OUTPUT AR143-TOKEN-FILE.                                01380064
014000                                                                  01390035
014100     PERFORM 2100-READ-AR143.                                     01400064
014200                                                                  01410035
014300******************************************************************01420035
014400* 2000-PROCESS-RECORDS                                            01430035
014500*   1. TOKENIZE THE FIELDS IN THE INPUT FILE                      01440062
014800*   2. WRITE THE RECORDS TO OUTPUT AND READ THE NEXT RECORD TO    01450035
014900*      PROCESS                                                    01460035
015000******************************************************************01470035
015100 2000-PROCESS-RECORDS.                                            01480035
015200                                                                  01490035
015300     IF AR143-RECORDS(1:2) NOT = 'TR' AND                         01500068
015301        AR143-CHD-ACCOUNT-NUMBER > SPACES                         01510068
015302        MOVE ZEROES TO PV-INPUT-LENGTH                            01520068
015600        INSPECT FUNCTION REVERSE (AR143-CHD-ACCOUNT-NUMBER)       01530068
015700            TALLYING PV-INPUT-LENGTH FOR LEADING SPACES           01540068
015800        COMPUTE PV-INPUT-LENGTH =                                 01550068
015900            LENGTH OF AR143-CHD-ACCOUNT-NUMBER - PV-INPUT-LENGTH  01560068
016400        PERFORM 2200-TOKENIZE-CHD-ACC-NBR                         01570068
016500     END-IF.                                                      01580068
016800     PERFORM 3000-WRITE-AR143.                                    01590064
016900     PERFORM 2100-READ-AR143.                                     01600064
017000                                                                  01610035
017100******************************************************************01620035
017200* 2100-READ-AR143                                                 01630064
017300*      READ THE RECORDS IN SETTLEMENT ADJUSTMENT FILE             01640035
017400******************************************************************01650035
017500 2100-READ-AR143.                                                 01660064
017600                                                                  01670035
017700     READ AR143-INPUT-FILE INTO AR143-RECORDS                     01680066
017800        AT END                                                    01690035
017900           SET PS-END-OF-AR143 TO TRUE                            01700064
018000        NOT AT END                                                01710035
018100           ADD 1               TO PV-AR143-READ-COUNT             01720064
018200     END-READ.                                                    01730035
018300                                                                  01740035
018400******************************************************************01750035
018500* 2200-TOKENIZE-CHD-ACC-NBR                                       01760067
018800******************************************************************01770035
018900 2200-TOKENIZE-CHD-ACC-NBR.                                       01780067
019000                                                                  01790035
019100     INITIALIZE CSI-PARAMETERS                                    01800044
019200                DP031-PROTEG-PGM-PARAMETERS.                      01810051
019300                                                                  01820044
019400     SET CSI-ENCRYPT-FUNCTION         TO TRUE.                    01830044
019500     SET DP031-ACCTNBR                TO TRUE.                    01840061
019600     MOVE 'AC-ACCT'                   TO DP031-FIELD.             01850059
019700     MOVE AR143-CHD-ACCOUNT-NUMBER    TO DP031-CLEAR-TEXT.        01860065
019800     MOVE PV-INPUT-LENGTH             TO DP031-INPUT-LEN.         01870051
019900     PERFORM DP031-0000-PROTG-TOKEN-DETOKEN.                      01880052
020000                                                                  01890044
020100     IF CSI-RETURN-CODE NOT = ZERO                                01900044
020200        DISPLAY 'ABEND IN RECORD NUMBER - ' PV-AR143-READ-COUNT   01910064
020300        DISPLAY 'INPUT-LENGTH - ' PV-INPUT-LENGTH                 01920058
020400        PERFORM DP031-9999-ABEND                                  01930052
020500     END-IF.                                                      01940044
020510     INITIALIZE AR143-CHD-ACCOUNT-NUMBER.                         01950065
020600     MOVE DP031-CIPHER-TEXT        TO AR143-CHD-ACCOUNT-NUMBER.   01960065
020700                                                                  01970035
020800******************************************************************01980063
020900* 3000-WRITE-AR143                                                01990064
021000*      WRITE THE RECORDS TO OUTPUT                                02000035
021100******************************************************************02010035
021200 3000-WRITE-AR143.                                                02020064
021300                                                                  02030035
021400     WRITE AR143-TOKEN-RECORD FROM AR143-RECORDS.                 02040066
021500     ADD 1                   TO PV-AR143-WRITE-COUNT.             02050064
021600                                                                  02060035
021700******************************************************************02070035
021800* 9000-EOJ-ROUTINE                                                02080035
021900*      CLOSE THE INPUT AND OUTPUT FILES, DISPLAY THE MESSAGES     02090035
022000*      AND TERMINATE THE PROCESS.                                 02100035
022100******************************************************************02110035
022200 9000-EOJ-ROUTINE.                                                02120035
022300                                                                  02130035
022400     CLOSE AR143-INPUT-FILE                                       02140064
022500           AR143-TOKEN-FILE.                                      02150064
022600                                                                  02160035
022700     IF PV-AR143-READ-COUNT = 0                                   02170064
022800        DISPLAY 'INPUT SETTLEMENT ADJUSTMENT FILE IS EMPTY'       02180035
022900     END-IF.                                                      02190035
023000     DISPLAY 'SAF RECORDS READ   : ' PV-AR143-READ-COUNT.         02200064
023100     DISPLAY 'SAF RECORDS WRITTEN: ' PV-AR143-WRITE-COUNT.        02210064
023200                                                                  02220035
023300******************************************************************02230035
023400*      COPY MEMBER DPPD031 CONTAINS STATEMENTS NEEDED TO INVOKE   02240052
023500*      PROTEGRITY MODULE FOR TOKENIZATION                         02250035
023600******************************************************************02260035
023700      COPY DPPD031.                                               02270052
023800                                                                  02280035
023900******************************************************************02290035
