000100 IDENTIFICATION DIVISION.                                         00010004
000200 PROGRAM-ID.     DSKUT005.                                        00020004
000300 AUTHOR.         RICHARD MOORE.                                   00030004
000400 DATE-WRITTEN.   12/30/98.                                        00040004
000500 DATE-COMPILED.                                                   00050004
000600*************************************************************     00060004
000700*                                                           *     00070004
000800*    PULL GROUP 2 DATA                                      *     00080004
000900*                                                           *     00090004
001000*************************************************************     00100004
001010*05/27/2020  G BANDA  - ADD LOGIC TO PULL ORIG-PKSL-SEQ-NBR       00101005
001020*                       FROM TPKSLIP TABLE                        00102005
004510*08/10/2022  J KURK   - RECOMPILE FOR COPYBOOK DSPD002            00103007
004510*04/10/2022  J KURK   - RECOMPILE FOR UPDATED COPYBOOKS           00103108
001040*************************************************************     00104005
001100                                                                  00110004
001200 ENVIRONMENT DIVISION.                                            00120004
001300                                                                  00130004
001400 INPUT-OUTPUT SECTION.                                            00140004
001500                                                                  00150004
001600 FILE-CONTROL.                                                    00160004
001700                                                                  00170004
001800     SELECT PO-NBR-FILE                                           00180004
001900         ASSIGN         TO UT-S-PO01.                             00190004
002000     SELECT TBLE-FILE                                             00200004
002100         ASSIGN         TO UT-S-TBL01.                            00210004
002200     SELECT CONTROL-FILE                                          00220004
002300         ASSIGN         TO UT-S-CTL01.                            00230004
002400                                                                  00240004
002500 DATA DIVISION.                                                   00250004
002600 FILE SECTION.                                                    00260004
002700* FD DECLARATIONS                                                 00270004
002800     COPY DSFD001.                                                00280004
002900                                                                  00290004
003000 WORKING-STORAGE SECTION.                                         00300004
003100 01  PV-OTHER-CRAPOLA.                                            00310004
003200     05  PV-WRITE-COUNT               PIC S9(9) COMP-3 VALUE      00320004
003300                                                       ZERO.      00330004
003400     05  PV-WHEN-COMPILED.                                        00340004
003500         10  PV-COMPILE-DATE          PIC X(08).                  00350004
003600         10  PV-COMPILE-TIME          PIC X(08).                  00360004
003700     COPY DSWS008.                                                00370004
003800/                                                                 00380004
003900     COPY DSWS009.                                                00390004
004000/                                                                 00400004
004100     COPY DSWS010.                                                00410004
004200/                                                                 00420004
004300     COPY DPWS004.                                                00430004
004400/                                                                 00440004
004500     COPY DSRD002.                                                00450004
004600*    FOR COMPILE USE ONLY                                         00460004
004700     COPY DSRD003.                                                00470004
004800/                                                                 00480004
004900******************************************************************00490004
005000*  DCLGENS                                                        00500004
005100******************************************************************00510004
005200     COPY DSWS011.                                                00520004
005300/                                                                 00530004
005400*  CURSOR TO PULL BACK TSHPTPO DATA                               00540004
005500     EXEC SQL                                                     00550004
005600       DECLARE SHPTPO-CSR CURSOR FOR                              00560004
005700         SELECT                                                   00570004
005800                SHIPT_ID                                          00580004
005900               ,PO_NBR                                            00590004
006000*              ,DEPT_NBR                                          00600004
006100               ,REC_SEQ_NBR                                       00610004
006200               ,EXPTED_CART_CNT                                   00620004
006300               ,ACTL_CART_CNT                                     00630004
006400               ,DMG_CART_CNT                                      00640004
006500               ,PKSL_IND                                          00650004
006600               ,VEND_NAME                                         00660004
006700               ,FRGT_CHG_AMT                                      00670004
006800               ,LAST_UPD_PGM_ID                                   00680004
006900               ,CRE_USER_ID                                       00690004
007000               ,CARR_CART_CT                                      00700004
007100               ,CARR_LAST_UPD_DTE                                 00710004
007200               ,CARR_LAST_UPD_TIME                                00720004
007300               ,VEND_CART_CT                                      00730004
007400               ,VEND_LAST_UPD_DTE                                 00740004
007500               ,VEND_LAST_UPD_TIME                                00750004
007600               ,CRE_TMST                                          00760004
007700               ,LAST_UPD_DTE                                      00770004
007800               ,LAST_UPD_TIME                                     00780004
007900               ,LAST_UPD_USER_ID                                  00790004
008000               ,PRIM_SHIPT_IND                                    00800004
008100               ,SPLT_XMIT_IND                                     00810004
008200               ,SPLT_XMIT_DTE                                     00820004
008300               ,SPLT_XMIT_TM                                      00830004
008400         FROM                                                     00840004
008500             TSHPTPO                                              00850004
008600         WHERE PO_NBR           = :HOLD-PO-NBR                    00860004
008700         WITH UR                                                  00870004
008800     END-EXEC.                                                    00880004
008900 EJECT                                                            00890004
009000******************************************************************00900004
009100*  CURSOR TO PULL BACK TPKSLIP DATA                               00910004
009200******************************************************************00920004
009300     EXEC SQL                                                     00930004
009400       DECLARE PKSLIP-CSR CURSOR FOR                              00940004
009500         SELECT                                                   00950004
009600                PO_NBR                                            00960004
009700               ,SEQ_NBR                                           00970004
009800               ,CRE_TMST                                          00980004
009900               ,VER_STAT_CDE                                      00990004
010000               ,OPER_UNT_ID                                       01000004
010100               ,FCLTY_ID                                          01010004
010200               ,PKSL_NBR                                          01020004
010300               ,STR_DEST_NBR                                      01030004
010400               ,REC_SEQ_NBR                                       01040004
010500               ,SHIPT_ID                                          01050004
010600               ,BOL_NBR                                           01060004
010700               ,PRO_NBR                                           01070004
010800               ,PKSL_STAT_CDE                                     01080004
010900               ,CRE_UID                                           01090004
011000               ,PO_VER_NBR                                        01100004
011100               ,CRE_SRC_CDE                                       01110004
011200               ,EXPTED_PKG_QTY                                    01120004
011300               ,OWNER_SCAC_ID                                     01130004
011400               ,ASN_NBR                                           01140004
011500               ,VEND_SHIP_DTE                                     01150004
011600               ,PKSL_PG_CNT                                       01160004
011700               ,CONTNR_ID                                         01170004
011710               ,ORIG_PKSL_SEQ_NBR                                 01171004
011720         FROM                                                     01172004
011730             TPKSLIP                                              01173004
011740         WHERE PO_NBR       = :HOLD-PO-NBR                        01174004
011750         WITH UR                                                  01175004
011760     END-EXEC.                                                    01176004
011770                                                                  01177004
011780 EJECT                                                            01178004
011790******************************************************************01179004
011800*  CURSOR TO PULL BACK TPKITEM DATA                               01180004
011900******************************************************************01190004
012000     EXEC SQL                                                     01200004
012100       DECLARE PKITEM-CSR CURSOR FOR                              01210004
012200         SELECT                                                   01220004
012300                PO_NBR                                            01230004
012400               ,SEQ_NBR                                           01240004
012500               ,PKSL_LNE_NBR                                      01250004
012600               ,CRE_TMST                                          01260004
012700               ,VER_STAT_CDE                                      01270004
012800               ,PKSL_ITM_QTY                                      01280004
012900               ,CRE_UID                                           01290004
013000               ,PURITM_VER_NBR                                    01300004
013100               ,ORIG_PKSL_ITM_QTY                                 01310004
013200         FROM                                                     01320004
013300             TPKITEM                                              01330004
013400         WHERE PO_NBR        = :HOLD-PO-NBR                       01340004
013500         WITH UR                                                  01350004
013600     END-EXEC.                                                    01360004
013700                                                                  01370004
013800 EJECT                                                            01380004
013900******************************************************************01390004
014000*  CURSOR TO PULL BACK TRECITM DATA                               01400004
014100******************************************************************01410004
014200     EXEC SQL                                                     01420004
014300       DECLARE RECITM-CSR CURSOR FOR                              01430004
014400         SELECT                                                   01440004
014500                ORD_NBR                                           01450004
014600               ,ORD_LNE_NBR                                       01460004
014700               ,REC_SEQ_NBR                                       01470004
014800               ,OPER_UNT_ID                                       01480004
014900               ,FCLTY_ID                                          01490004
015000               ,CRE_TMST                                          01500004
015100               ,CRE_UID                                           01510004
015200               ,PO_VER_NBR                                        01520004
015300               ,ITM_NBR                                           01530004
015400               ,PRE_TKT_IND                                       01540004
015500               ,TKT_FMT_ID                                        01550004
015600               ,RTV_IND                                           01560004
015700               ,STATUS_CDE                                        01570004
015800               ,VER_STATUS_CDE                                    01580004
015900               ,PKSL_ITM_QTY                                      01590004
016000               ,DTL_CK_ITM_QTY                                    01600004
016100               ,INNR_PACK_QTY                                     01610004
016200               ,CASE_PACK_QTY                                     01620004
016300               ,RTV_QTY                                           01630004
016400               ,EXPTED_CART_CNT                                   01640004
016500               ,ACTL_CART_CNT                                     01650004
016600               ,MKING_APRON_TMST                                  01660004
016700               ,UNT_COST_AMT                                      01670004
016800               ,COLOR_DESC                                        01680004
016900               ,SIZE_DESC                                         01690004
017000               ,VEND_STYL_NAME                                    01700004
017100               ,VEND_DESC                                         01710004
017200               ,VERFYD_TMST                                       01720004
017300               ,PKSL_NBR                                          01730004
017400               ,REC_INV_LNE_NBR                                   01740004
017500               ,DMG_ITM_QTY                                       01750004
017600               ,UPD_TMST                                          01760004
017700               ,UPD_UID                                           01770004
017800               ,UPD_PGM_ID                                        01780004
017900               ,RCPT_DISTR_UPD_CDE                                01790004
018000               ,VRFD_USR_ID                                       01800004
018100               ,LAST_TRSCP_TMST                                   01810004
018200               ,LAST_TRSCP_USR_ID                                 01820004
018300               ,PREPK_ID                                          01830004
018400               ,PREPK_RATO_QTY                                    01840004
018500               ,PREPK_ODD_UNT_QTY                                 01850004
018600               ,PREPK_DRV_LNE_CDE                                 01860004
018700               ,UNT_RTL_AMT                                       01870004
018800               ,GP_RTL_AMT                                        01880004
018900               ,GP_QTY                                            01890004
019000               ,ORIG_PKSL_ITM_QTY                                 01900004
019100         FROM                                                     01910004
019200             TRECITM                                              01920004
019300         WHERE ORD_NBR     = :HOLD-PO-NBR                         01930004
019400         WITH UR                                                  01940004
019500     END-EXEC.                                                    01950004
019600                                                                  01960004
019700 EJECT                                                            01970004
019800******************************************************************01980004
019900*  CURSOR TO PULL BACK TRECEIV DATA                               01990004
020000******************************************************************02000004
020100     EXEC SQL                                                     02010004
020200       DECLARE RECEIV-CSR CURSOR FOR                              02020004
020300         SELECT                                                   02030004
020400                ORD_NBR                                           02040004
020500               ,REC_SEQ_NBR                                       02050004
020600               ,CRE_TMST                                          02060004
020700               ,CRE_UID                                           02070004
020800               ,PO_VER_NBR                                        02080004
020900               ,OPER_UNT_ID                                       02090004
021000               ,FCLTY_ID                                          02100004
021100               ,STATUS_CDE                                        02110004
021200               ,SYST_CRE_CDE                                      02120004
021300               ,REC_TYP_CDE                                       02130004
021400               ,VER_STATUS_CDE                                    02140004
021500               ,PACK_BY_ST_IND                                    02150004
021600               ,REC_TMST                                          02160004
021700               ,EXPTED_CART_CNT                                   02170004
021800               ,ACTL_CART_CNT                                     02180004
021900               ,EXPTED_ITM_QTY                                    02190004
022000               ,ACTL_ITM_QTY                                      02200004
022100               ,RCVR_NBR                                          02210004
022200               ,ML_POST_TMST                                      02220004
022300               ,FS_POST_TMST                                      02230004
022400               ,PRE_TKT_IND                                       02240004
022500               ,AD_INFO_DESC                                      02250004
022600               ,IN_TRBL_TMST                                      02260004
022700               ,IN_TRBL_MIN_CNT                                   02270004
022800               ,IN_TRBL_HOUR_CNT                                  02280004
022900               ,VERFYD_TMST                                       02290004
023000               ,RCVG_CLERK_INIT_ID                                02300004
023100               ,REFER_BACK_SEQ_NBR                                02310004
023200               ,AP_PRC_CDE                                        02320004
023300               ,AP_PRC_DTE                                        02330004
023400               ,MIS_DIRECT_IND                                    02340004
023500               ,IMPRT_IND                                         02350004
023600               ,CRE_OPER_UNT_ID                                   02360004
023700               ,CRE_FCLTY_ID                                      02370004
023800               ,CURR_OPER_UNT_ID                                  02380004
023900               ,CURR_FCLTY_ID                                     02390004
024000               ,UPD_TMST                                          02400004
024100               ,UPD_UID                                           02410004
024200               ,UPD_PGM_ID                                        02420004
024300               ,APRON_LOC_DESC                                    02430004
024400               ,MKNG_APRN_PRT_TMST                                02440004
024500               ,GOH_IND                                           02450004
024600               ,VRFD_USR_ID                                       02460004
024700               ,AP_RVRSL_IND                                      02470004
024800               ,AP_RVRSL_DTE                                      02480004
024900               ,PKGNG_CDE                                         02490004
025000         FROM                                                     02500004
025100             TRECEIV                                              02510004
025200         WHERE ORD_NBR     = :HOLD-PO-NBR                         02520004
025300         WITH UR                                                  02530004
025400     END-EXEC.                                                    02540004
025500                                                                  02550004
025600 EJECT                                                            02560004
025700******************************************************************02570004
025800*  CURSOR TO PULL BACK TRECDIS DATA                               02580004
025900******************************************************************02590004
026000     EXEC SQL                                                     02600004
026100       DECLARE RECDIS-CSR CURSOR FOR                              02610004
026200         SELECT                                                   02620004
026300                ORD_NBR                                           02630004
026400               ,ORD_LNE_NBR                                       02640004
026500               ,REC_SEQ_NBR                                       02650004
026600               ,OPER_UNT_ID                                       02660004
026700               ,FCLTY_ID                                          02670004
026800               ,CRE_TMST                                          02680004
026900               ,CRE_UID                                           02690004
027000               ,VER_STATUS_CDE                                    02700004
027100               ,EXPTED_ITM_QTY                                    02710004
027200               ,VERIFY_ITM_QTY                                    02720004
027300               ,AP_VERIFY_ITM_QTY                                 02730004
027400               ,STR_NBR                                           02740004
027500               ,STR_FCLTY_ID                                      02750004
027600               ,PLAN_ITM_QTY                                      02760004
027700               ,AP_PRC_CDE                                        02770004
027800               ,AP_PRC_DTE                                        02780004
027900         FROM                                                     02790004
028000             TRECDIS                                              02800004
028100         WHERE ORD_NBR     = :HOLD-PO-NBR                         02810004
028200         WITH UR                                                  02820004
028300     END-EXEC.                                                    02830004
028400                                                                  02840004
028500 EJECT                                                            02850004
028600******************************************************************02860004
028700*  CURSOR TO PULL BACK TVHTRIP DATA                               02870004
028800******************************************************************02880004
028900     EXEC SQL                                                     02890004
029000       DECLARE VHTRIP-CSR CURSOR FOR                              02900004
029100         SELECT                                                   02910004
029200                OWNER_SCAC_ID                                     02920004
029300               ,VEH_NBR                                           02930004
029400               ,TRIP_ID                                           02940004
029500               ,TRIP_BEG_DTE                                      02950004
029600               ,TRIP_BEG_TME                                      02960004
029700               ,CRT_SRC_CDE                                       02970004
029800               ,LAST_UPD_DTE                                      02980004
029900               ,LAST_UPD_TME                                      02990004
030000               ,LAST_UPD_UID                                      03000004
030100               ,MANIFEST_NBR                                      03010004
030200               ,PLND_TRIP_SEQ                                     03020004
030300               ,PLND_ACTVY_CDE                                    03030004
030400               ,OWNR_SCAC_SHIP_DTE                                03040004
030500               ,REF_TRIP_ID                                       03050004
030600               ,EST_AR_TMST                                       03060004
030700               ,SPLT_XMIT_IND                                     03070004
030800               ,SPLT_XMIT_DTE                                     03080004
030900               ,SPLT_XMIT_TM                                      03090004
031000         FROM                                                     03100004
031100             TVHTRIP                                              03110004
031200         WHERE TRIP_ID       = :HOLD-TRIP-ID                      03120004
031300         WITH UR                                                  03130004
031400     END-EXEC.                                                    03140004
031500                                                                  03150004
031600 EJECT                                                            03160004
031700******************************************************************03170004
031800*  CURSOR TO PULL BACK TSHIPST DATA                               03180004
031900******************************************************************03190004
032000     EXEC SQL                                                     03200004
032100       DECLARE SHIPST-CSR CURSOR FOR                              03210004
032200         SELECT                                                   03220004
032300                SHIPT_ID                                          03230004
032400               ,SHIPT_STATUS_CDE                                  03240004
032500               ,STATUS_DTE                                        03250004
032600               ,STATUS_TME                                        03260004
032700               ,STATUS_UID                                        03270004
032800               ,DELAY_RSN_CDE                                     03280004
032900               ,CARR_STATUS_CDE                                   03290004
033000               ,TIME_ZONE_CDE                                     03300004
033100               ,CITY_NAME                                         03310004
033200               ,STATE_CDE                                         03320004
033300         FROM                                                     03330004
033400             TSHIPST                                              03340004
033500         WHERE SHIPT_ID     = :HOLD-SHIPT-ID                      03350004
033600         WITH UR                                                  03360004
033700     END-EXEC.                                                    03370004
033800                                                                  03380004
033900 EJECT                                                            03390004
034000******************************************************************03400004
034100*  CURSOR TO PULL BACK TTRIPST DATA                               03410004
034200******************************************************************03420004
034300     EXEC SQL                                                     03430004
034400       DECLARE TRIPST-CSR CURSOR FOR                              03440004
034500         SELECT                                                   03450004
034600                TRIP_ID                                           03460004
034700               ,TRIP_STATUS_CDE                                   03470004
034800               ,STATUS_DTE                                        03480004
034900               ,STATUS_TME                                        03490004
035000               ,STATUS_UID                                        03500004
035100               ,OPER_UNT_ID                                       03510004
035200               ,FCLTY_ID                                          03520004
035300               ,FCLTY_AREA_ID                                     03530004
035400         FROM                                                     03540004
035500             TTRIPST                                              03550004
035600         WHERE TRIP_ID       = :HOLD-TRIP-ID                      03560004
035700         WITH UR                                                  03570004
035800     END-EXEC.                                                    03580004
035900                                                                  03590004
036000 EJECT                                                            03600004
036100******************************************************************03610004
036200*  CURSOR TO PULL BACK TVEHICL DATA                               03620004
036300******************************************************************03630004
036400     EXEC SQL                                                     03640004
036500       DECLARE VEHICL-CSR CURSOR FOR                              03650004
036600         SELECT                                                   03660004
036700                OWNER_SCAC_ID                                     03670004
036800               ,VEH_NBR                                           03680004
036900               ,CRT_SRC_CDE                                       03690004
037000               ,LAST_UPD_DTE                                      03700004
037100               ,LAST_UPD_TME                                      03710004
037200               ,LAST_UPD_UID                                      03720004
037300               ,USAGE_CDE                                         03730004
037400               ,VEH_TYP_CDE                                       03740004
037500               ,CURR_STATUS_CDE                                   03750004
037600               ,CURR_STATUS_DTE                                   03760004
037700               ,CURR_STATUS_TME                                   03770004
037800               ,CURR_OPER_UNT_ID                                  03780004
037900               ,CURR_FCLTY_ID                                     03790004
038000               ,CURR_FAC_AREA_ID                                  03800004
038100               ,CURR_LOC_DTE                                      03810004
038200               ,CURR_LOC_TME                                      03820004
038300               ,CURR_TRIP_ID                                      03830004
038400               ,VEH_SIZE_CDE                                      03840004
038500         FROM                                                     03850004
038600             TVEHICL                                              03860004
038700         WHERE VEH_NBR       = :HOLD-VEH-NBR                      03870004
038800         AND   OWNER_SCAC_ID = :HOLD-SCAC-ID                      03880004
038900         WITH UR                                                  03890004
039000     END-EXEC.                                                    03900004
039100 EJECT                                                            03910004
039200******************************************************************03920004
039300*  CURSOR TO PULL BACK TSHIPMT DATA                               03930004
039400******************************************************************03940004
039500     EXEC SQL                                                     03950004
039600       DECLARE SHIPMT-CSR CURSOR FOR                              03960004
039700         SELECT                                                   03970004
039800                TRIP_ID                                           03980004
039900               ,SHIPT_ID                                          03990004
040000               ,CRT_SRC_CDE                                       04000004
040100               ,LAST_UPD_DTE                                      04010004
040200               ,LAST_UPD_TME                                      04020004
040300               ,LAST_UPD_UID                                      04030004
040400               ,PRO_SCAC_ID                                       04040004
040500               ,PRO_NBR                                           04050004
040600               ,BOL_NBR                                           04060004
040700               ,SHIPPER_NME                                       04070004
040800               ,SHIPT_TYP_CDE                                     04080004
040900               ,EXPTED_GRO_WGHT                                   04090004
041000               ,PKG_TYP_CDE                                       04100004
041100               ,EXPTED_PKG_QTY                                    04110004
041200               ,FRGT_CHG_AMT                                      04120004
041300               ,FRGT_TERMS_CDE                                    04130004
041400               ,EXPTED_PLT_QTY                                    04140004
041500               ,VEND_SHIP_DTE                                     04150004
041600               ,EST_AR_TMST                                       04160004
041700               ,ORIG_SCAC_ID                                      04170004
041800               ,LAST_UPD_PGM_ID                                   04180004
041900               ,CRE_USER_ID                                       04190004
042000               ,CARR_CART_CT                                      04200004
042100               ,CARR_LAST_UPD_DTE                                 04210004
042200               ,CARR_LAST_UPD_TIME                                04220004
042300               ,VEND_CART_CT                                      04230004
042400               ,VEND_LAST_UPD_DTE                                 04240004
042500               ,VEND_LAST_UPD_TIME                                04250004
042600               ,VEH_NBR                                           04260004
042700               ,AUTH_NBR                                          04270004
042800               ,AUTH_DTE                                          04280004
042900               ,CONFIRM_DTE                                       04290004
043000               ,CONFIRM_TIME                                      04300004
043100               ,COMPLETE_PRO_NBR                                  04310004
043200               ,COMPLETE_BOL_NBR                                  04320004
043300               ,PROCESSED_DTE                                     04330004
043400               ,INVC_NBR                                          04340004
043500               ,CARR_AUTH_ID                                      04350004
043600         FROM                                                     04360004
043700             TSHIPMT                                              04370004
043800         WHERE SHIPT_ID      = :HOLD-SHIPT-ID                     04380004
043900         WITH UR                                                  04390004
044000     END-EXEC.                                                    04400004
044100 EJECT                                                            04410004
044200******************************************************************04420004
044300*  CURSOR TO PULL BACK TRECDVS DATA                               04430004
044400******************************************************************04440004
044500     EXEC SQL                                                     04450004
044600       DECLARE RECDVS-CSR CURSOR FOR                              04460004
044700         SELECT                                                   04470004
044800            ORD_NBR                                               04480004
044900           ,ORD_LNE_NBR                                           04490004
045000           ,REC_SEQ_NBR                                           04500004
045100           ,STR_NBR                                               04510004
045200           ,VRFY_SRC_CDE                                          04520004
045300           ,EXPTED_ITM_QTY                                        04530004
045400           ,VRFY_ITM_QTY                                          04540004
045500           ,VER_STAT_CDE                                          04550004
045600         FROM                                                     04560004
045700             TRECDVS                                              04570004
045800         WHERE ORD_NBR          = :HOLD-PO-NBR                    04580004
045900         WITH UR                                                  04590004
046000     END-EXEC.                                                    04600004
046100 EJECT                                                            04610004
046200******************************************************************04620004
046300*  CURSOR TO PULL BACK TAUTRIP DATA                               04630004
046400******************************************************************04640004
046500     EXEC SQL                                                     04650004
046600       DECLARE AUTRIP-CSR CURSOR FOR                              04660004
046700         SELECT                                                   04670004
046800                   OWNER_SCAC_ID                                  04680004
046900                  ,VEH_NBR                                        04690004
047000                  ,TRIP_ID                                        04700004
047100                  ,TRIP_BEG_DTE                                   04710004
047200                  ,TRIP_BEG_TME                                   04720004
047300                  ,CRT_SRC_CDE                                    04730004
047400                  ,LAST_UPD_DTE                                   04740004
047500                  ,LAST_UPD_TME                                   04750004
047600                  ,LAST_UPD_UID                                   04760004
047700                  ,MANIFEST_NBR                                   04770004
047800                  ,PLND_TRIP_SEQ                                  04780004
047900                  ,PLND_ACTVY_CDE                                 04790004
048000                  ,REF_TRIP_ID                                    04800004
048100                  ,EST_AR_TMST                                    04810004
048200                  ,OWNR_SCAC_SHIP_DTE                             04820004
048300                  ,AUD_STATUS_CDE                                 04830004
048400                  ,SPLT_XMIT_IND                                  04840004
048500                  ,SPLT_XMIT_DTE                                  04850004
048600                  ,SPLT_XMIT_TM                                   04860004
048700         FROM                                                     04870004
048800             TAUTRIP                                              04880004
048900         WHERE TRIP_ID          = :HOLD-TRIP-ID                   04890004
049000         WITH UR                                                  04900004
049100     END-EXEC.                                                    04910004
049200 EJECT                                                            04920004
049300******************************************************************04930004
049400*  CURSOR TO PULL BACK TAUSHIP-DATA                               04940006
049500******************************************************************04950004
049600     EXEC SQL                                                     04960004
049700       DECLARE AUSHIP-CSR CURSOR FOR SELECT                       04970004
049800                    TRIP_ID                                       04980004
049900                   ,SHIPT_ID                                      04990004
050000                   ,CRT_SRC_CDE                                   05000004
050100                   ,LAST_UPD_DTE                                  05010004
050200                   ,LAST_UPD_TME                                  05020004
050300                   ,LAST_UPD_UID                                  05030004
050400                   ,PRO_SCAC_ID                                   05040004
050500                   ,PRO_NBR                                       05050004
050600                   ,BOL_NBR                                       05060004
050700                   ,SHIPPER_NME                                   05070004
050800                   ,SHIPT_TYP_CDE                                 05080004
050900                   ,EXPTED_GRO_WGHT                               05090004
051000                   ,PKG_TYP_CDE                                   05100004
051100                   ,EXPTED_PKG_QTY                                05110004
051200                   ,FRGT_CHG_AMT                                  05120004
051300                   ,FRGT_TERMS_CDE                                05130004
051400                   ,EST_AR_TMST                                   05140004
051500                   ,VEND_SHIP_DTE                                 05150004
051600                   ,EXPTED_PLT_QTY                                05160004
051700                   ,ORIG_SCAC_ID                                  05170004
051800                   ,LAST_UPD_PGM_ID                               05180004
051900                   ,CRE_USER_ID                                   05190004
052000                   ,CARR_CART_CT                                  05200004
052100                   ,CARR_LAST_UPD_DTE                             05210004
052200                   ,CARR_LAST_UPD_TIME                            05220004
052300                   ,VEND_CART_CT                                  05230004
052400                   ,VEND_LAST_UPD_DTE                             05240004
052500                   ,VEND_LAST_UPD_TIME                            05250004
052600                   ,VEH_NBR                                       05260004
052700                   ,AUTH_NBR                                      05270004
052800                   ,AUTH_DTE                                      05280004
052900                   ,CONFIRM_DTE                                   05290004
053000                   ,CONFIRM_TIME                                  05300004
053100                   ,AUD_STATUS_CDE                                05310004
053200                   ,PROCESSED_DTE                                 05320004
053300                   ,INVC_NBR                                      05330004
053400                   ,CARR_AUTH_ID                                  05340004
053500         FROM                                                     05350004
053600             TAUSHIP                                              05360004
053700         WHERE SHIPT_ID         = :HOLD-SHIPT-ID                  05370004
053800         WITH UR                                                  05380004
053900     END-EXEC.                                                    05390004
054000 EJECT                                                            05400004
054100******************************************************************05410004
054110*  CURSOR TO PULL BACK TAUSHPO DATA                               05411006
054120******************************************************************05412004
054130     EXEC SQL                                                     05413004
054140       DECLARE AUSHPO-CSR CURSOR FOR SELECT                       05414004
054150                    SHIPT_ID                                      05415004
054160                   ,PO_NBR                                        05416004
054170*                  ,DEPT_NBR                                      05417004
054180                   ,REC_SEQ_NBR                                   05418004
054190                   ,EXPTED_CART_CNT                               05419004
054200                   ,ACTL_CART_CNT                                 05420004
054300                   ,DMG_CART_CNT                                  05430004
054400                   ,PKSL_IND                                      05440004
054500                   ,VEND_NAME                                     05450004
054600                   ,FRGT_CHG_AMT                                  05460004
054700                   ,LAST_UPD_PGM_ID                               05470004
054800                   ,CRE_USER_ID                                   05480004
054900                   ,CARR_CART_CT                                  05490004
055000                   ,CARR_LAST_UPD_DTE                             05500004
055100                   ,CARR_LAST_UPD_TIME                            05510004
055200                   ,VEND_CART_CT                                  05520004
055300                   ,VEND_LAST_UPD_DTE                             05530004
055400                   ,VEND_LAST_UPD_TIME                            05540004
055500                   ,CRE_TMST                                      05550004
055600                   ,LAST_UPD_DTE                                  05560004
055700                   ,LAST_UPD_TIME                                 05570004
055800                   ,LAST_UPD_USER_ID                              05580004
055900                   ,PRIM_SHIPT_IND                                05590004
056000                   ,SPLT_XMIT_IND                                 05600004
056100                   ,SPLT_XMIT_DTE                                 05610004
056200                   ,SPLT_XMIT_TM                                  05620004
056300                   ,TRN_CDE                                       05630004
056400         FROM                                                     05640004
056500             TAUSHPO                                              05650004
056600         WHERE PO_NBR           = :HOLD-PO-NBR                    05660004
056700         WITH UR                                                  05670004
056800     END-EXEC.                                                    05680004
056900 EJECT                                                            05690004
057000******************************************************************05700004
057100*  CURSOR TO PULL BACK TAUVHCL DATA                               05710006
057200******************************************************************05720004
057300     EXEC SQL                                                     05730004
057400       DECLARE AUVHCL-CSR CURSOR FOR SELECT                       05740004
057500                    OWNER_SCAC_ID                                 05750004
057600                   ,VEH_NBR                                       05760004
057700                   ,CRT_SRC_CDE                                   05770004
057800                   ,LAST_UPD_DTE                                  05780004
057900                   ,LAST_UPD_TME                                  05790004
058000                   ,LAST_UPD_UID                                  05800004
058100                   ,USAGE_CDE                                     05810004
058200                   ,VEH_TYP_CDE                                   05820004
058300                   ,CURR_STATUS_CDE                               05830004
058400                   ,CURR_STATUS_DTE                               05840004
058500                   ,CURR_STATUS_TME                               05850004
058600                   ,CURR_OPER_UNT_ID                              05860004
058700                   ,CURR_FCLTY_ID                                 05870004
058800                   ,CURR_FAC_AREA_ID                              05880004
058900                   ,CURR_LOC_DTE                                  05890004
059000                   ,CURR_LOC_TME                                  05900004
059100                   ,CURR_TRIP_ID                                  05910004
059200                   ,VEH_SIZE_CDE                                  05920004
059300         FROM                                                     05930004
059400             TAUVHCL                                              05940004
059500         WHERE OWNER_SCAC_ID    = :HOLD-OWNER-SCAC-ID             05950004
059600         AND   VEH_NBR          = :HOLD-VEH-NBR                   05960004
059700         WITH UR                                                  05970004
059800     END-EXEC.                                                    05980004
059900 EJECT                                                            05990004
060000******************************************************************06000004
060100*  CURSOR TO PULL BACK TDISTHD DATA                               06010004
060200******************************************************************06020004
060300     EXEC SQL                                                     06030004
060400       DECLARE DISTHD-CSR CURSOR FOR                              06040004
060500         SELECT                                                   06050004
060600                   ORD_NBR                                        06060004
060700                  ,RCVR_SEQ_NBR                                   06070004
060800                  ,ORD_LNE_NBR                                    06080004
060900                  ,WRK_ORD_SEQ_NBR                                06090004
061000                  ,OPER_UNT_ID                                    06100004
061100                  ,DISTRB_PRC_AREA_ID                             06110004
061200                  ,PRCG_STAT_CDE                                  06120004
061300                  ,CRE_TMST                                       06130004
061400                  ,RSLTS_RCVD_TMST                                06140004
061500                  ,VRFD_TMST                                      06150004
061600                  ,PRC_AREA_MODU_ID                               06160004
061700                  ,CRE_USR_ID                                     06170004
061800                  ,TOT_CART_CNT                                   06180004
061900                  ,CART_DWNLD_DTE                                 06190004
062000                  ,CART_DWNLD_TM                                  06200004
062100                  ,CART_DWNLD_USR_ID                              06210004
062200                  ,FCSE_CART_CNT                                  06220004
062300                  ,FCSE_LBL_TYP_CDE                               06230004
062400                  ,P2L_CART_CNT                                   06240004
062500                  ,INPK_CART_CNT                                  06250004
062600                  ,INPK_UNT_QTY                                   06260004
062700                  ,INPK_CNVYB_IND                                 06270004
062800                  ,OTPK_UNT_QTY                                   06280004
062900                  ,SYS_CRE_CDE                                    06290004
063000                  ,SPC_INSTR_DESC                                 06300004
063100                  ,FCSE_CNFRMN_TMST                               06310004
063200                  ,FCSE_CNFRMN_USR_ID                             06320004
063300                  ,FCSE_CNFRMN_PGM_ID                             06330004
063400                  ,ACTV_IND                                       06340004
063500                  ,DLT_REQ_SRC_ID                                 06350004
063600                  ,DLT_REQ_TMST                                   06360004
063700                  ,DLT_RSLT_CDE                                   06370004
063800                  ,P2L_SCN_CART_CNT                               06380004
063900                  ,CRE_LBL_OPT_CDE                                06390004
064000                  ,FCSE_FCLTY_AREA_ID                             06400004
064100                  ,ODD_CART_UNT_QTY                               06410004
064200                  ,PREPK_LNE_PRC_CDE                              06420004
064300                  ,UCC128_DAT_USG_CDE                             06430004
064400                  ,CAL_UNT_PRCD_QTY                               06440004
064500         FROM                                                     06450004
064600             TDISTHD                                              06460004
064700         WHERE ORD_NBR          = :HOLD-PO-NBR                    06470004
064800         WITH UR                                                  06480004
064900     END-EXEC.                                                    06490004
065000 EJECT                                                            06500004
065100******************************************************************06510004
065200*  CURSOR TO PULL BACK TDISTDT DATA                               06520004
065300******************************************************************06530004
065400     EXEC SQL                                                     06540004
065500       DECLARE DISTDT-CSR CURSOR FOR                              06550004
065600         SELECT                                                   06560004
065700                   ORD_NBR                                        06570004
065800                  ,RCVR_SEQ_NBR                                   06580004
065900                  ,ORD_LNE_NBR                                    06590004
066000                  ,WRK_ORD_SEQ_NBR                                06600004
066100                  ,STR_NBR                                        06610004
066200                  ,EXPTED_ALLOC_QTY                               06620004
066300                  ,ACTL_ALLOC_QTY                                 06630004
066400                  ,RCVG_PSTD_STAT_CDE                             06640004
066500                  ,P2L_SPLT_UNT_QTY                               06650004
066600                  ,FCSE_SPLT_UNT_QTY                              06660004
066700                  ,INPK_SPLT_UNT_QTY                              06670004
066800                  ,FCSE_ACTL_UNT_QTY                              06680004
066900                  ,ODD_CART_IND                                   06690004
067000                  ,PREPK_ODD_UNT_QTY                              06700004
067100         FROM                                                     06710004
067200             TDISTDT                                              06720004
067300         WHERE ORD_NBR          = :HOLD-PO-NBR                    06730004
067400         WITH UR                                                  06740004
067500     END-EXEC.                                                    06750004
067600 EJECT                                                            06760004
067700******************************************************************06770004
067800*  CURSOR TO PULL BACK TWRKORD DATA                               06780004
067900******************************************************************06790004
068000     EXEC SQL                                                     06800004
068100       DECLARE WRKORD-CSR CURSOR FOR                              06810004
068200         SELECT                                                   06820004
068300                   ORD_NBR                                        06830004
068400                  ,RCVR_SEQ_NBR                                   06840004
068500                  ,ORD_LNE_NBR                                    06850004
068600                  ,WORK_ORD_SEQ_NBR                               06860004
068700                  ,OPER_UNT_ID                                    06870004
068800                  ,FCLTY_ID                                       06880004
068900                  ,CRE_TMST                                       06890004
069000                  ,VER_STATUS_CDE                                 06900004
069100                  ,CRE_UID_ID                                     06910004
069200                  ,EXPTED_CART_CNT                                06920004
069300                  ,ACTL_CART_CNT                                  06930004
069400                  ,EXPTED_ITM_CNT                                 06940004
069500                  ,ACTL_ITM_CNT                                   06950004
069600                  ,STAT_CDE                                       06960004
069700                  ,WORK_ORD_DISTR_IND                             06970004
069800                  ,OPER_SET_ID                                    06980004
069900                  ,INST_CART_CNT                                  06990004
070000                  ,INST_LNE_LOC_CDE                               07000004
070100                  ,INST_PRC_AREA_ID                               07010004
070200                  ,WO_INSTR_SEL_IND                               07020004
070300                  ,INST_ITM_CNT                                   07030004
070400         FROM                                                     07040004
070500             TWRKORD                                              07050004
070600         WHERE ORD_NBR          = :HOLD-PO-NBR                    07060004
070700         WITH UR                                                  07070004
070800     END-EXEC.                                                    07080004
070900 EJECT                                                            07090004
071000******************************************************************07100004
071100*  CURSOR TO PULL BACK TWKORIN DATA                               07110004
071200******************************************************************07120004
071300     EXEC SQL                                                     07130004
071400       DECLARE WKORIN-CSR CURSOR FOR                              07140004
071500         SELECT                                                   07150004
071600                   ORD_NBR                                        07160004
071700                  ,RCVR_SEQ_NBR                                   07170004
071800                  ,ORD_LNE_NBR                                    07180004
071900                  ,WORK_ORD_SEQ_NBR                               07190004
072000                  ,OPER_UNT_ID                                    07200004
072100                  ,FCLTY_ID                                       07210004
072200                  ,WO_INSTR_SEQ_NBR                               07220004
072300                  ,CRE_TMST                                       07230004
072400                  ,VER_STATUS_CDE                                 07240004
072500                  ,CRE_UID_ID                                     07250004
072600                  ,OPER_ID                                        07260004
072700                  ,FCLTY_AREA_ID                                  07270004
072800                  ,PRC_FCLTY_AREA_ID                              07280004
072900                  ,EXPTED_CART_CNT                                07290004
073000                  ,ACTL_CART_CNT                                  07300004
073100                  ,ALLOC_IND                                      07310004
073200                  ,REPACK_IND                                     07320004
073300                  ,STRT_TMST                                      07330004
073400                  ,STOP_TMST                                      07340004
073500                  ,SCREEN_SEQ_NBR                                 07350004
073600                  ,LNE_LOC_CDE                                    07360004
073700                  ,REC_SEL_IND                                    07370004
073800         FROM                                                     07380004
073900             TWKORIN                                              07390004
074000         WHERE ORD_NBR          = :HOLD-PO-NBR                    07400004
074100         WITH UR                                                  07410004
074200     END-EXEC.                                                    07420004
074300 EJECT                                                            07430004
074400******************************************************************07440004
074500*  CURSOR TO PULL BACK TSHPSUM DATA                               07450004
074600******************************************************************07460004
074700     EXEC SQL                                                     07470004
074800       DECLARE SHPSUM-CSR CURSOR FOR                              07480004
074900         SELECT                                                   07490004
075000           PO_NBR                                                 07500004
075100          ,PKSL_SEQ_NBR                                           07510004
075200          ,CART_COMB_NBR                                          07520004
075300          ,PO_LNE_NBR                                             07530004
075400          ,TOT_CART_CNT                                           07540004
075500          ,OTPK_UNT_QTY                                           07550004
075600          ,CRE_TMST                                               07560004
075700         FROM                                                     07570004
075800             TSHPSUM                                              07580004
075900         WHERE PO_NBR           = :HOLD-PO-NBR                    07590004
076000         WITH UR                                                  07600004
076100     END-EXEC.                                                    07610004
076200 EJECT                                                            07620004
076300******************************************************************07630004
076400*  CURSOR TO PULL BACK TLBVRDA DATA                               07640004
076500******************************************************************07650004
076600     EXEC SQL                                                     07660004
076700       DECLARE LBVRDA-CSR CURSOR FOR                              07670004
076800         SELECT                                                   07680004
076900            PO_NBR                                                07690004
077000           ,RCVR_SEQ_NBR                                          07700004
077100           ,PO_LNE_NBR                                            07710004
077200           ,PREPK_ID                                              07720004
077300           ,OTPK_UNT_QTY                                          07730004
077400           ,LBL_ASG_IND                                           07740004
077500           ,LBL_TYP_CDE                                           07750004
077600           ,LBL_ASG_SEQ_NBR                                       07760004
077700           ,PRNT_CART_SEQ_ID                                      07770004
077800           ,CART_LBL_TYP_CDE                                      07780004
077900           ,PREPK_PRCG_LNE_NBR                                    07790004
078000           ,INPK_UNT_QTY                                          07800004
078100           ,PREPK_RATO_QTY                                        07810004
078200           ,PREPK_UNT_QTY                                         07820004
078300           ,DEST_OPER_UNT_ID                                      07830004
078400           ,CSE_PK_QTY                                            07840004
078500           ,ODD_CART_IND                                          07850004
078600           ,INPK_CNVYB_IND                                        07860004
078700           ,LBL_TYP_LBL_SEQ_ID                                    07870004
078800           ,LBL_TYP_TOT_QTY                                       07880004
078900           ,BRCDE_NBR                                             07890004
079000           ,STR_ZN_ID                                             07900004
079100           ,MODU_DESC                                             07910004
079200           ,ITM_NBR                                               07920004
079300           ,DEPT_DESC                                             07930004
079400           ,MAJ_CL_DESC                                           07940004
079500           ,SEASET_NM                                             07950004
079600           ,FIXT_ID                                               07960004
079700           ,STRG_AREA_CDE                                         07970004
079800           ,RCLM_IND                                              07980004
079900*CLP 03/21/2016                                                   07990004
080000           ,LBL_MSG_TXT                                           08000004
080100         FROM                                                     08010004
080200             TLBVRDA                                              08020004
080300         WHERE PO_NBR           = :HOLD-PO-NBR                    08030004
080400         WITH UR                                                  08040004
080500     END-EXEC.                                                    08050004
080600 EJECT                                                            08060004
080610******************************************************************08061004
080620*  CURSOR TO PULL BACK TLBPTDA DATA                               08062004
080630******************************************************************08063004
080640     EXEC SQL                                                     08064004
080650       DECLARE LBPTDA-CSR CURSOR FOR                              08065004
080660         SELECT                                                   08066004
080670               TRIP_ID                                            08067004
080680              ,CRE_USR_ID                                         08068004
080690              ,LBL_PRT_BTCH_ID                                    08069004
080700              ,SHIPT_UNT_ID                                       08070004
080800              ,OPER_UNT_ID                                        08080004
080900              ,FCLTY_ID                                           08090004
081000              ,CRE_TMST                                           08100004
081100              ,OWNR_SCAC_ID                                       08110004
081200              ,VEH_NBR                                            08120004
081300              ,RPRT_IND                                           08130004
081400              ,SU_DUP_LBL_IND                                     08140004
081500              ,SU_FRE_ASTRA_IND                                   08150004
081600              ,SU_MSSG_DAT_IND                                    08160004
081700              ,SU_MISDIR_IND                                      08170004
081800              ,MISDIR_OPER_UNT_ID                                 08180004
081900              ,PO_NBR                                             08190004
082000              ,RCVR_SEQ_NBR                                       08200004
082100              ,PO_LNE_NBR                                         08210004
082200              ,DEST_OPER_UNT_ID                                   08220004
082300              ,STR_NM                                             08230004
082400              ,STR_ZN_ID                                          08240004
082500              ,SKU_DEPT_NBR                                       08250004
082600              ,SKU_CL_NBR                                         08260004
082700*             ,SKU_SEQ_NBR                                        08270004
082800              ,VS_NBR                                             08280004
082900              ,OTPK_UNT_QTY                                       08290004
083000              ,INPK_UNT_QTY                                       08300004
083100              ,PRTR_ID                                            08310004
083200              ,BRCDE_NBR                                          08320004
083300              ,DC_PRTD_AT_CDE                                     08330004
083400              ,INVLD_DAT_ERR_CDE                                  08340004
083500              ,PREPK_ID                                           08350004
083600              ,PREPK_RATO_QTY                                     08360004
083700              ,PREPK_UNT_QTY                                      08370004
083800              ,CSE_PK_QTY                                         08380004
083900              ,ODD_CART_IND                                       08390004
084000              ,INPK_CNVYB_IND                                     08400004
084100              ,LBL_TYP_LBL_SEQ_ID                                 08410004
084200              ,LBL_TYP_TOT_QTY                                    08420004
084300              ,MODU_DESC                                          08430004
084400              ,ITM_NBR                                            08440004
084500              ,DEPT_DESC                                          08450004
084600              ,MAJ_CL_DESC                                        08460004
084700              ,SEASET_NM                                          08470004
084800              ,FIXT_ID                                            08480004
084900              ,CART_LBL_TYP_CDE                                   08490004
085000              ,STRG_AREA_CDE                                      08500004
085100              ,CART_ACTN_CDE                                      08510004
085200              ,HNG_FOLD_SEQ_NBR                                   08520004
085300              ,BUS_AREA_ID                                        08530004
085400              ,SKU_NBR                                            08540004
085500*CLP 03/21/2016                                                   08550004
085600              ,LBL_MSG_TXT                                        08560004
085700         FROM                                                     08570004
085800             TLBPTDA                                              08580004
085900         WHERE TRIP_ID          = :HOLD-TRIP-ID                   08590004
086000         WITH UR                                                  08600004
086100     END-EXEC.                                                    08610004
086200 EJECT                                                            08620004
086300******************************************************************08630004
086400*LINKAGE SECTION.                                                 08640004
086500******************************************************************08650004
086600*                                                                 08660004
086700 PROCEDURE DIVISION.                                              08670004
086800                                                                  08680004
086900 A100-MAINLINE.                                                   08690004
087000                                                                  08700004
087100                                                                  08710004
087200     MOVE WHEN-COMPILED TO PV-WHEN-COMPILED                       08720004
087300     DISPLAY SPACES                                               08730004
087400     DISPLAY ' *** DSKUT005 VERSION 2 ***'                        08740004
087500     DISPLAY 'COMPILE DATE: ' PV-COMPILE-DATE                     08750004
087600             ' ' PV-COMPILE-TIME                                  08760004
087700                                                                  08770004
087800                                                                  08780004
087900     SET DS009-S-PGM TO TRUE.                                     08790004
088000     PERFORM DS002-INITIAL-PROCESSING.                            08800004
088100     PERFORM B100-FETCH-PROCESSING                                08810004
088200         VARYING DS009-PO-SUB FROM 1 BY 1                         08820004
088300         UNTIL DS009-PO-SUB > DS009-PO-SUB-MAX.                   08830004
088400                                                                  08840004
088500           DISPLAY '  ****  UNLOAD TOTALS  ****'                  08850004
088600                                                                  08860004
088700       PERFORM VARYING CNTL-I FROM 1 BY 1 UNTIL                   08870004
088800           CNTL-I > CNTL-SUB-MAX OR CNTL-I > 200                  08880004
088900           IF CNTL-TABLE(CNTL-I) NOT = SPACES                     08890004
089000             IF DS009-GROUP-NBR(CNTL-I) = '2'                     08900004
089100                MOVE DS009-READ-COUNT (CNTL-I) TO DS009-DISP-NBR  08910004
089200                DISPLAY 'TABLE = ' CNTL-TABLE(CNTL-I)             08920004
089300                        DS009-DISP-NBR                            08930004
089400           END-IF                                                 08940004
089500           END-IF                                                 08950004
089600       END-PERFORM                                                08960004
089700                                                                  08970004
089800       MOVE PV-WRITE-COUNT            TO DS009-DISP-NBR           08980004
089900       DISPLAY '*** TOTAL UNLOADS WRITTEN = '  DS009-DISP-NBR     08990004
090000                                                                  09000004
090100     PERFORM DS002-END-OF-JOB.                                    09010004
090200                                                                  09020004
090300     GOBACK.                                                      09030004
090400 EJECT                                                            09040004
090500***************************************************************** 09050004
090600*     FOR EACH TABLE IN THE CONTROL FILE PROCESS THE FETCH      * 09060004
090700***************************************************************** 09070004
090800 B100-FETCH-PROCESSING.                                           09080004
090900*                                                                 09090004
091000     IF DS009-PO-NBR (DS009-PO-SUB) NUMERIC                       09100004
091100                                                                  09110004
091200       PERFORM WITH TEST BEFORE                                   09120004
091300           VARYING DS009-CNTL-J FROM 1 BY 1                       09130004
091400             UNTIL DS009-CNTL-J > CNTL-SUB-MAX                    09140004
091500             IF CNTL-SEL (DS009-CNTL-J) = 'Y'                     09150004
091600                MOVE CNTL-TABLE (DS009-CNTL-J)                    09160004
091700                             TO DS009-PROCESS-TABLE               09170004
091800                PERFORM DS002-DO-PROCESS                          09180004
091900                IF DS009-DO-PROCESS                               09190004
092000                  MOVE DS009-PO-NBR (DS009-PO-SUB)                09200004
092100                                TO HOLD-PO-NBR                    09210004
092200                  PERFORM B100-TABLE-FETCH                        09220004
092300                END-IF                                            09230004
092400             END-IF                                               09240004
092500       END-PERFORM                                                09250004
092600                                                                  09260004
092700     END-IF.                                                      09270004
092800 EJECT                                                            09280004
092900***************************************************************** 09290004
093000* PROCESS THE TABLES                                              09300004
093100***************************************************************** 09310004
093200 B100-TABLE-FETCH.                                                09320004
093300        EVALUATE TRUE                                             09330004
093400        WHEN DS009-PROCESS-TABLE = 'TRECEIV'                      09340004
093500             PERFORM Y100-OPEN-CURSOR                             09350004
093600             SET MORE-RECEIV-DATA TO TRUE                         09360004
093700             PERFORM R100-FETCH-RECEIV                            09370004
093800                 UNTIL NO-MORE-RECEIV-DATA                        09380004
093900             MOVE 'TRECEIV' TO DS009-PROCESS-TABLE                09390004
094000             PERFORM Y100-CLOSE-CURSOR                            09400004
094100        WHEN DS009-PROCESS-TABLE = 'TRECITM'                      09410004
094200             PERFORM Y100-OPEN-CURSOR                             09420004
094300             SET MORE-RECITM-DATA TO TRUE                         09430004
094400             PERFORM R100-FETCH-RECITM                            09440004
094500                 UNTIL NO-MORE-RECITM-DATA                        09450004
094600             MOVE 'TRECITM' TO DS009-PROCESS-TABLE                09460004
094700             PERFORM Y100-CLOSE-CURSOR                            09470004
094800        WHEN DS009-PROCESS-TABLE = 'TRECDIS'                      09480004
094900             PERFORM Y100-OPEN-CURSOR                             09490004
095000             SET MORE-RECDIS-DATA TO TRUE                         09500004
095100             PERFORM R100-FETCH-RECDIS                            09510004
095200                 UNTIL NO-MORE-RECDIS-DATA                        09520004
095300             MOVE 'TRECDIS' TO DS009-PROCESS-TABLE                09530004
095400             PERFORM Y100-CLOSE-CURSOR                            09540004
095500        WHEN DS009-PROCESS-TABLE = 'TPKITEM'                      09550004
095600             PERFORM Y100-OPEN-CURSOR                             09560004
095700             SET MORE-PKITEM-DATA TO TRUE                         09570004
095800             PERFORM R100-FETCH-PKITEM                            09580004
095900                 UNTIL NO-MORE-PKITEM-DATA                        09590004
096000             MOVE 'TPKITEM' TO DS009-PROCESS-TABLE                09600004
096100             PERFORM Y100-CLOSE-CURSOR                            09610004
096200        WHEN DS009-PROCESS-TABLE = 'TPKSLIP'                      09620004
096300             PERFORM Y100-OPEN-CURSOR                             09630004
096400             SET MORE-PKSLIP-DATA TO TRUE                         09640004
096500             PERFORM R100-FETCH-PKSLIP                            09650004
096600                 UNTIL NO-MORE-PKSLIP-DATA                        09660004
096700             MOVE 'TPKSLIP' TO DS009-PROCESS-TABLE                09670004
096800             PERFORM Y100-CLOSE-CURSOR                            09680004
096900        WHEN DS009-PROCESS-TABLE = 'TSHPTPO'                      09690004
097000             PERFORM Y100-OPEN-CURSOR                             09700004
097100             SET MORE-SHPTPO-DATA TO TRUE                         09710004
097200             PERFORM R100-FETCH-SHPTPO                            09720004
097300                 UNTIL NO-MORE-SHPTPO-DATA                        09730004
097400             MOVE 'TSHPTPO' TO DS009-PROCESS-TABLE                09740004
097500             PERFORM Y100-CLOSE-CURSOR                            09750004
097600        WHEN DS009-PROCESS-TABLE = 'TRECDVS'                      09760004
097700             PERFORM Y100-OPEN-CURSOR                             09770004
097800             SET MORE-RECDVS-DATA TO TRUE                         09780004
097900             PERFORM R100-FETCH-RECDVS                            09790004
098000                UNTIL NO-MORE-RECDVS-DATA                         09800004
098100             MOVE 'TRECDVS' TO DS009-PROCESS-TABLE                09810004
098200             PERFORM Y100-CLOSE-CURSOR                            09820004
098300        WHEN DS009-PROCESS-TABLE = 'TAUSHPO'                      09830004
098400             PERFORM Y100-OPEN-CURSOR                             09840004
098500             SET MORE-AUSHPO-DATA TO TRUE                         09850004
098600             PERFORM R100-FETCH-AUSHPO                            09860004
098700                UNTIL NO-MORE-AUSHPO-DATA                         09870004
098800             MOVE 'TAUSHPO' TO DS009-PROCESS-TABLE                09880004
098900             PERFORM Y100-CLOSE-CURSOR                            09890004
099000        WHEN DS009-PROCESS-TABLE = 'TDISTHD'                      09900004
099100             PERFORM Y100-OPEN-CURSOR                             09910004
099200             SET MORE-DISTHD-DATA TO TRUE                         09920004
099300             PERFORM R100-FETCH-DISTHD                            09930004
099400                UNTIL NO-MORE-DISTHD-DATA                         09940004
099500             MOVE 'TDISTHD' TO DS009-PROCESS-TABLE                09950004
099600             PERFORM Y100-CLOSE-CURSOR                            09960004
099700        WHEN DS009-PROCESS-TABLE = 'TDISTDT'                      09970004
099800             PERFORM Y100-OPEN-CURSOR                             09980004
099900             SET MORE-DISTDT-DATA TO TRUE                         09990004
100000             PERFORM R100-FETCH-DISTDT                            10000004
100100                UNTIL NO-MORE-DISTDT-DATA                         10010004
100200             MOVE 'TDISTDT' TO DS009-PROCESS-TABLE                10020004
100300             PERFORM Y100-CLOSE-CURSOR                            10030004
100400        WHEN DS009-PROCESS-TABLE = 'TWRKORD'                      10040004
100500             PERFORM Y100-OPEN-CURSOR                             10050004
100600             SET MORE-WRKORD-DATA TO TRUE                         10060004
100700             PERFORM R100-FETCH-WRKORD                            10070004
100800                UNTIL NO-MORE-WRKORD-DATA                         10080004
100900             MOVE 'TWRKORD' TO DS009-PROCESS-TABLE                10090004
101000             PERFORM Y100-CLOSE-CURSOR                            10100004
101100        WHEN DS009-PROCESS-TABLE = 'TWKORIN'                      10110004
101200             PERFORM Y100-OPEN-CURSOR                             10120004
101300             SET MORE-WKORIN-DATA TO TRUE                         10130004
101400             PERFORM R100-FETCH-WKORIN                            10140004
101500                UNTIL NO-MORE-WKORIN-DATA                         10150004
101600             MOVE 'TWKORIN' TO DS009-PROCESS-TABLE                10160004
101700             PERFORM Y100-CLOSE-CURSOR                            10170004
101800        WHEN DS009-PROCESS-TABLE = 'TSHPSUM'                      10180004
101900             PERFORM Y100-OPEN-CURSOR                             10190004
102000             SET MORE-SHPSUM-DATA TO TRUE                         10200004
102100             PERFORM R100-FETCH-SHPSUM                            10210004
102200                UNTIL NO-MORE-SHPSUM-DATA                         10220004
102300             MOVE 'TSHPSUM' TO DS009-PROCESS-TABLE                10230004
102400             PERFORM Y100-CLOSE-CURSOR                            10240004
102500        WHEN DS009-PROCESS-TABLE = 'TLBVRDA'                      10250004
102600             PERFORM Y100-OPEN-CURSOR                             10260004
102700             SET MORE-LBVRDA-DATA TO TRUE                         10270004
102800             PERFORM R100-FETCH-LBVRDA                            10280004
102900                UNTIL NO-MORE-LBVRDA-DATA                         10290004
103000             MOVE 'TLBVRDA' TO DS009-PROCESS-TABLE                10300004
103100             PERFORM Y100-CLOSE-CURSOR                            10310004
103200        END-EVALUATE.                                             10320004
103300*                                                                 10330004
103400 EJECT                                                            10340004
103500***************************************************************** 10350004
103600*     FETCH SHPTPO INFO                                           10360004
103700***************************************************************** 10370004
103800*                                                                 10380004
103900 R100-FETCH-SHPTPO.                                               10390004
104000*                                                                 10400004
104100     MOVE 'TSHPTPO' TO DS009-PROCESS-TABLE.                       10410004
104200     PERFORM WITH TEST AFTER                                      10420004
104300        VARYING DS009-RETRY-COUNTER FROM 1 BY 1                   10430004
104400        UNTIL   DS009-RETRY-COUNTER > 3 OR                        10440004
104500                SQLCODE = ZERO OR                                 10450004
104600                SQLCODE = +100                                    10460004
104700        EXEC SQL                                                  10470004
104800            FETCH SHPTPO-CSR                                      10480004
104900            INTO                                                  10490004
105000               :WS-SHPTPO-SHIPT-ID                                10500004
105100              ,:WS-SHPTPO-PO-NBR                                  10510004
105200              ,:WS-SHPTPO-REC-SEQ-NBR                             10520004
105300              ,:WS-SHPTPO-EXPTED-CART-CNT                         10530004
105400              ,:WS-SHPTPO-ACTL-CART-CNT                           10540004
105500              ,:WS-SHPTPO-DMG-CART-CNT                            10550004
105600              ,:WS-SHPTPO-PKSL-IND                                10560004
105700              ,:WS-SHPTPO-VEND-NAME                               10570004
105800              ,:WS-SHPTPO-FRGT-CHG-AMT                            10580004
105900              ,:WS-SHPTPO-LAST-UPD-PGM-ID                         10590004
106000              ,:WS-SHPTPO-CRE-USER-ID                             10600004
106100              ,:WS-SHPTPO-CARR-CART-CT                            10610004
106200              ,:WS-SHPTPO-CARR-LAST-UPD-DTE                       10620004
106300              ,:WS-SHPTPO-CARR-LAST-UPD-TIME                      10630004
106400              ,:WS-SHPTPO-VEND-CART-CT                            10640004
106500              ,:WS-SHPTPO-VEND-LAST-UPD-DTE                       10650004
106600              ,:WS-SHPTPO-VEND-LAST-UPD-TIME                      10660004
106700              ,:WS-SHPTPO-CRE-TMST                                10670004
106800              ,:WS-SHPTPO-LAST-UPD-DTE                            10680004
106900              ,:WS-SHPTPO-LAST-UPD-TIME                           10690004
107000              ,:WS-SHPTPO-LAST-UPD-USER-ID                        10700004
107100              ,:WS-SHPTPO-PRIM-SHIPT-IND                          10710004
107200              ,:WS-SHPTPO-SPLT-XMIT-IND                           10720004
107300              ,:WS-SHPTPO-SPLT-XMIT-DTE                           10730004
107400              ,:WS-SHPTPO-SPLT-XMIT-TM                            10740004
107500        END-EXEC                                                  10750004
107600                                                                  10760004
107700        EVALUATE TRUE                                             10770004
107800            WHEN SQLCODE = ZERO OR -305                           10780004
107900                 MOVE LENGTH OF WS-SHPTPO TO DS009-TBLE-DATA-SIZE 10790004
108000                 COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE 10800004
108100                                           + DS009X-RECORD-FILLER 10810004
108200                 MOVE 11                   TO TBLE-ORDER          10820004
108300                 MOVE 01                   TO TBLE-VERSION        10830004
108400                 MOVE DS009-TBLE-DATA-SIZE TO TBLE-DATA-SIZE      10840004
108500                 MOVE 'TSHPTPO'            TO TBLE-NAME           10850004
108600                 MOVE WS-SHPTPO            TO TBLE-DATA-ITEM      10860004
108700                 INITIALIZE DS009-PKYS                            10870004
108800                 PERFORM DS002-PROCESS-KEYS                       10880004
108900                 MOVE WS-SHPTPO-KEYS  TO DS009-PKYS               10890004
109000                 MOVE DS009-PKYS      TO TBLE-KEYS                10900004
109100*                WRITE TBLE-RECORD                                10910004
109200                 PERFORM 8000-WRITE-UNLOAD                        10920004
109300                                                                  10930004
109400                 SET MORE-SHIPST-DATA TO TRUE                     10940004
109500                 SET MORE-SHIPMT-DATA TO TRUE                     10950004
109600                                                                  10960004
109700                 MOVE WS-SHPTPO-SHIPT-ID  TO  HOLD-SHIPT-ID       10970004
109800                 MOVE 'TSHIPST' TO DS009-PROCESS-TABLE            10980004
109900                 PERFORM DS002-DO-PROCESS                         10990004
110000                 IF DS009-DO-PROCESS                              11000004
110100                     PERFORM Y100-OPEN-CURSOR                     11010004
110200                     PERFORM R100-FETCH-SHIPST                    11020004
110300                         UNTIL NO-MORE-SHIPST-DATA                11030004
110400                     PERFORM Y100-CLOSE-CURSOR                    11040004
110500                 END-IF                                           11050004
110600                                                                  11060004
110700                 MOVE WS-SHPTPO-SHIPT-ID  TO  HOLD-SHIPT-ID       11070004
110800                 MOVE 'TSHIPMT' TO DS009-PROCESS-TABLE            11080004
110900                 PERFORM DS002-DO-PROCESS                         11090004
111000                 IF DS009-DO-PROCESS                              11100004
111100                     PERFORM Y100-OPEN-CURSOR                     11110004
111200                     PERFORM R100-FETCH-SHIPMT                    11120004
111300                         UNTIL NO-MORE-SHIPMT-DATA                11130004
111400                     PERFORM Y100-CLOSE-CURSOR                    11140004
111500                 END-IF                                           11150004
111600                                                                  11160004
111700            WHEN SQLCODE = +100                                   11170004
111800                 SET NO-MORE-SHPTPO-DATA  TO TRUE                 11180004
111900            WHEN SQLCODE = -904                                   11190004
112000            WHEN SQLCODE = -913                                   11200004
112100              CONTINUE                                            11210004
112200           END-EVALUATE                                           11220004
112300         END-PERFORM.                                             11230004
112400***************************************************************** 11240004
112500     PERFORM DS002-SQL-ABEND-FETCH.                               11250004
112600***************************************************************** 11260004
112700 EJECT                                                            11270004
112800***************************************************************** 11280004
112900*     FETCH PKSLIP DATA                                           11290004
113000***************************************************************** 11300004
113100 R100-FETCH-PKSLIP.                                               11310004
113200*                                                                 11320004
113300     MOVE 'TPKSLIP' TO DS009-PROCESS-TABLE.                       11330004
113400     PERFORM WITH TEST AFTER                                      11340004
113500        VARYING DS009-RETRY-COUNTER FROM 1 BY 1                   11350004
113600        UNTIL   DS009-RETRY-COUNTER > 3 OR                        11360004
113700                SQLCODE = ZERO OR                                 11370004
113800                SQLCODE = +100                                    11380004
113900        EXEC SQL                                                  11390004
114000            FETCH PKSLIP-CSR                                      11400004
114100            INTO                                                  11410004
114200               :WS-PKSLIP-PO-NBR                                  11420004
114300              ,:WS-PKSLIP-SEQ-NBR                                 11430004
114400              ,:WS-PKSLIP-CRE-TMST                                11440004
114500              ,:WS-PKSLIP-VER-STAT-CDE                            11450004
114600              ,:WS-PKSLIP-OPER-UNT-ID                             11460004
114700              ,:WS-PKSLIP-FCLTY-ID                                11470004
114800              ,:WS-PKSLIP-PKSL-NBR                                11480004
114900              ,:WS-PKSLIP-STR-DEST-NBR                            11490004
115000              ,:WS-PKSLIP-REC-SEQ-NBR                             11500004
115100              ,:WS-PKSLIP-SHIPT-ID                                11510004
115200              ,:WS-PKSLIP-BOL-NBR                                 11520004
115300              ,:WS-PKSLIP-PRO-NBR                                 11530004
115400              ,:WS-PKSLIP-PKSL-STAT-CDE                           11540004
115500              ,:WS-PKSLIP-CRE-UID                                 11550004
115600              ,:WS-PKSLIP-PO-VER-NBR                              11560004
115700              ,:WS-PKSLIP-CRE-SRC-CDE                             11570004
115800              ,:WS-PKSLIP-EXPTED-PKG-QTY                          11580004
115900              ,:WS-PKSLIP-OWNER-SCAC-ID                           11590004
116000              ,:WS-PKSLIP-ASN-NBR                                 11600004
116100              ,:WS-PKSLIP-VEND-SHIP-DTE                           11610004
116200              ,:WS-PKSLIP-PKSL-PG-CNT                             11620004
116300              ,:WS-PKSLIP-CONTNR-ID                               11630004
116400              ,:WS-PKSLIP-ORIG-PKSL-SEQ-NBR                       11640004
116500        END-EXEC                                                  11650004
116600                                                                  11660004
116700        EVALUATE TRUE                                             11670004
116800            WHEN SQLCODE = ZERO OR -305                           11680004
116900                 MOVE LENGTH OF WS-PKSLIP TO DS009-TBLE-DATA-SIZE 11690004
117000                 COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE 11700004
117100                                           + DS009X-RECORD-FILLER 11710004
117200                 MOVE 10     TO TBLE-ORDER                        11720004
117300                 MOVE 03     TO TBLE-VERSION                      11730004
117400                 MOVE DS009-TBLE-DATA-SIZE TO TBLE-DATA-SIZE      11740004
117500                 MOVE 'TPKSLIP'            TO TBLE-NAME           11750004
117600                 MOVE WS-PKSLIP            TO TBLE-DATA-ITEM      11760004
117700                 INITIALIZE DS009-PKYS                            11770004
117800                 PERFORM DS002-PROCESS-KEYS                       11780004
117900                 MOVE WS-PKSLIP-KEYS  TO DS009-PKYS               11790004
118000                 MOVE DS009-PKYS      TO TBLE-KEYS                11800004
118100*                WRITE TBLE-RECORD                                11810004
118200                 PERFORM 8000-WRITE-UNLOAD                        11820004
118300            WHEN SQLCODE = +100                                   11830004
118400                 SET NO-MORE-PKSLIP-DATA  TO TRUE                 11840004
118500            WHEN SQLCODE = -904                                   11850004
118600            WHEN SQLCODE = -913                                   11860004
118700              CONTINUE                                            11870004
118800           END-EVALUATE                                           11880004
118900         END-PERFORM.                                             11890004
119000***************************************************************** 11900004
119100     PERFORM DS002-SQL-ABEND-FETCH.                               11910004
119200***************************************************************** 11920004
119300 EJECT                                                            11930004
119400***************************************************************** 11940004
119500*     FETCH PKITEM INFO                                           11950004
119600***************************************************************** 11960004
119700 R100-FETCH-PKITEM.                                               11970004
119800*                                                                 11980004
119900     MOVE 'TPKITEM' TO DS009-PROCESS-TABLE.                       11990004
120000     PERFORM WITH TEST AFTER                                      12000004
120100        VARYING DS009-RETRY-COUNTER FROM 1 BY 1                   12010004
120200        UNTIL   DS009-RETRY-COUNTER > 3 OR                        12020004
120300                SQLCODE = ZERO OR                                 12030004
120400                SQLCODE = +100                                    12040004
120500        EXEC SQL                                                  12050004
120600            FETCH PKITEM-CSR                                      12060004
120700            INTO                                                  12070004
120800               :WS-PKITEM-PO-NBR                                  12080004
120900              ,:WS-PKITEM-SEQ-NBR                                 12090004
121000              ,:WS-PKITEM-PKSL-LNE-NBR                            12100004
121100              ,:WS-PKITEM-CRE-TMST                                12110004
121200              ,:WS-PKITEM-VER-STAT-CDE                            12120004
121300              ,:WS-PKITEM-PKSL-ITM-QTY                            12130004
121400              ,:WS-PKITEM-CRE-UID                                 12140004
121500              ,:WS-PKITEM-PURITM-VER-NBR                          12150004
121600              ,:WS-PKITEM-ORIG-PKSL-ITM-QTY                       12160004
121700        END-EXEC                                                  12170004
121800                                                                  12180004
121900        EVALUATE TRUE                                             12190004
122000            WHEN SQLCODE = ZERO OR -305                           12200004
122100                 MOVE LENGTH OF WS-PKITEM TO DS009-TBLE-DATA-SIZE 12210004
122200                 COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE 12220004
122300                                           + DS009X-RECORD-FILLER 12230004
122400                 MOVE 10     TO TBLE-ORDER                        12240004
122500                 MOVE 04     TO TBLE-VERSION                      12250004
122600                 MOVE DS009-TBLE-DATA-SIZE TO TBLE-DATA-SIZE      12260004
122700                 MOVE 'TPKITEM'            TO TBLE-NAME           12270004
122800                 MOVE WS-PKITEM            TO TBLE-DATA-ITEM      12280004
122900                 INITIALIZE DS009-PKYS                            12290004
123000                 PERFORM DS002-PROCESS-KEYS                       12300004
123100                 MOVE WS-PKITEM-KEYS  TO DS009-PKYS               12310004
123200                 MOVE DS009-PKYS      TO TBLE-KEYS                12320004
123300*                WRITE TBLE-RECORD                                12330004
123400                 PERFORM 8000-WRITE-UNLOAD                        12340004
123500            WHEN SQLCODE = +100                                   12350004
123600                 SET NO-MORE-PKITEM-DATA  TO TRUE                 12360004
123700            WHEN SQLCODE = -904                                   12370004
123800            WHEN SQLCODE = -913                                   12380004
123900              CONTINUE                                            12390004
124000           END-EVALUATE                                           12400004
124100         END-PERFORM.                                             12410004
124200***************************************************************** 12420004
124300     PERFORM DS002-SQL-ABEND-FETCH.                               12430004
124400***************************************************************** 12440004
124500 EJECT                                                            12450004
124600***************************************************************** 12460004
124700*     FETCH TRECEIV INFO                                          12470004
124800***************************************************************** 12480004
124900 R100-FETCH-RECEIV.                                               12490004
125000*                                                                 12500004
125100     MOVE 'TRECEIV' TO DS009-PROCESS-TABLE.                       12510004
125200     PERFORM WITH TEST AFTER                                      12520004
125300        VARYING DS009-RETRY-COUNTER FROM 1 BY 1                   12530004
125400        UNTIL   DS009-RETRY-COUNTER > 3 OR                        12540004
125500                SQLCODE = ZERO OR                                 12550004
125600                SQLCODE = +100                                    12560004
125700        EXEC SQL                                                  12570004
125800            FETCH RECEIV-CSR                                      12580004
125900            INTO                                                  12590004
126000               :WS-RECEIV-ORD-NBR                                 12600004
126100              ,:WS-RECEIV-REC-SEQ-NBR                             12610004
126200              ,:WS-RECEIV-CRE-TMST                                12620004
126300              ,:WS-RECEIV-CRE-UID                                 12630004
126400              ,:WS-RECEIV-PO-VER-NBR                              12640004
126500              ,:WS-RECEIV-OPER-UNT-ID                             12650004
126600              ,:WS-RECEIV-FCLTY-ID                                12660004
126700              ,:WS-RECEIV-STATUS-CDE                              12670004
126800              ,:WS-RECEIV-SYST-CRE-CDE                            12680004
126900              ,:WS-RECEIV-REC-TYP-CDE                             12690004
127000              ,:WS-RECEIV-VER-STATUS-CDE                          12700004
127100              ,:WS-RECEIV-PACK-BY-ST-IND                          12710004
127200              ,:WS-RECEIV-REC-TMST                                12720004
127300              ,:WS-RECEIV-EXPTED-CART-CNT                         12730004
127400              ,:WS-RECEIV-ACTL-CART-CNT                           12740004
127500              ,:WS-RECEIV-EXPTED-ITM-QTY                          12750004
127600              ,:WS-RECEIV-ACTL-ITM-QTY                            12760004
127700              ,:WS-RECEIV-RCVR-NBR                                12770004
127800              ,:WS-RECEIV-ML-POST-TMST                            12780004
127900              ,:WS-RECEIV-FS-POST-TMST                            12790004
128000              ,:WS-RECEIV-PRE-TKT-IND                             12800004
128100              ,:WS-RECEIV-AD-INFO-DESC                            12810004
128200              ,:WS-RECEIV-IN-TRBL-TMST                            12820004
128300              ,:WS-RECEIV-IN-TRBL-MIN-CNT                         12830004
128400              ,:WS-RECEIV-IN-TRBL-HOUR-CNT                        12840004
128500              ,:WS-RECEIV-VERFYD-TMST                             12850004
128600              ,:WS-RECEIV-RCVG-CLERK-INIT-ID                      12860004
128700              ,:WS-RECEIV-REFER-BACK-SEQ-NBR                      12870004
128800              ,:WS-RECEIV-AP-PRC-CDE                              12880004
128900              ,:WS-RECEIV-AP-PRC-DTE                              12890004
129000              ,:WS-RECEIV-MIS-DIRECT-IND                          12900004
129100              ,:WS-RECEIV-IMPRT-IND                               12910004
129200              ,:WS-RECEIV-CRE-OPER-UNT-ID                         12920004
129300              ,:WS-RECEIV-CRE-FCLTY-ID                            12930004
129400              ,:WS-RECEIV-CURR-OPER-UNT-ID                        12940004
129500              ,:WS-RECEIV-CURR-FCLTY-ID                           12950004
129600              ,:WS-RECEIV-UPD-TMST                                12960004
129700              ,:WS-RECEIV-UPD-UID                                 12970004
129800              ,:WS-RECEIV-UPD-PGM-ID                              12980004
129900              ,:WS-RECEIV-APRON-LOC-DESC                          12990004
130000              ,:WS-RECEIV-MKNG-APRN-PRT-TMST                      13000004
130100              ,:WS-RECEIV-GOH-IND                                 13010004
130200              ,:WS-RECEIV-VRFD-USR-ID                             13020004
130300              ,:WS-RECEIV-AP-RVRSL-IND                            13030004
130400              ,:WS-RECEIV-AP-RVRSL-DTE                            13040004
130500              ,:WS-RECEIV-PKGNG-CDE                               13050004
130600        END-EXEC                                                  13060004
130700                                                                  13070004
130800        EVALUATE TRUE                                             13080004
130900            WHEN SQLCODE = ZERO OR -305                           13090004
131000                 MOVE LENGTH OF WS-RECEIV TO DS009-TBLE-DATA-SIZE 13100004
131100                 COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE 13110004
131200                                           + DS009X-RECORD-FILLER 13120004
131300                 MOVE 10     TO TBLE-ORDER                        13130004
131400                 MOVE 00     TO TBLE-VERSION                      13140004
131500                 MOVE DS009-TBLE-DATA-SIZE TO TBLE-DATA-SIZE      13150004
131600                 MOVE 'TRECEIV'            TO TBLE-NAME           13160004
131700                 MOVE WS-RECEIV            TO TBLE-DATA-ITEM      13170004
131800                 INITIALIZE DS009-PKYS                            13180004
131900                 PERFORM DS002-PROCESS-KEYS                       13190004
132000                 MOVE WS-RECEIV-KEYS  TO DS009-PKYS               13200004
132100                 MOVE DS009-PKYS      TO TBLE-KEYS                13210004
132200*                WRITE TBLE-RECORD                                13220004
132300                 PERFORM 8000-WRITE-UNLOAD                        13230004
132400            WHEN SQLCODE = +100                                   13240004
132500                 SET NO-MORE-RECEIV-DATA TO TRUE                  13250004
132600            WHEN SQLCODE = -904                                   13260004
132700            WHEN SQLCODE = -913                                   13270004
132800              CONTINUE                                            13280004
132900           END-EVALUATE                                           13290004
133000         END-PERFORM.                                             13300004
133100***************************************************************** 13310004
133200     PERFORM DS002-SQL-ABEND-FETCH.                               13320004
133300***************************************************************** 13330004
133400 EJECT                                                            13340004
133500***************************************************************** 13350004
133600*     FETCH RECITM INFO                                           13360004
133700***************************************************************** 13370004
133800 R100-FETCH-RECITM.                                               13380004
133900*                                                                 13390004
134000     MOVE 'TRECITM' TO DS009-PROCESS-TABLE.                       13400004
134100     PERFORM WITH TEST AFTER                                      13410004
134200        VARYING DS009-RETRY-COUNTER FROM 1 BY 1                   13420004
134300        UNTIL   DS009-RETRY-COUNTER > 3 OR                        13430004
134400                SQLCODE = ZERO OR                                 13440004
134500                SQLCODE = +100                                    13450004
134600        EXEC SQL                                                  13460004
134700            FETCH RECITM-CSR                                      13470004
134800            INTO                                                  13480004
134900               :WS-RECITM-ORD-NBR                                 13490004
135000              ,:WS-RECITM-ORD-LNE-NBR                             13500004
135100              ,:WS-RECITM-REC-SEQ-NBR                             13510004
135200              ,:WS-RECITM-OPER-UNT-ID                             13520004
135300              ,:WS-RECITM-FCLTY-ID                                13530004
135400              ,:WS-RECITM-CRE-TMST                                13540004
135500              ,:WS-RECITM-CRE-UID                                 13550004
135600              ,:WS-RECITM-PO-VER-NBR                              13560004
135700              ,:WS-RECITM-ITM-NBR                                 13570004
135800              ,:WS-RECITM-PRE-TKT-IND                             13580004
135900              ,:WS-RECITM-TKT-FMT-ID                              13590004
136000              ,:WS-RECITM-RTV-IND                                 13600004
136100              ,:WS-RECITM-STATUS-CDE                              13610004
136200              ,:WS-RECITM-VER-STATUS-CDE                          13620004
136300              ,:WS-RECITM-PKSL-ITM-QTY                            13630004
136400              ,:WS-RECITM-DTL-CK-ITM-QTY                          13640004
136500              ,:WS-RECITM-INNR-PACK-QTY                           13650004
136600              ,:WS-RECITM-CASE-PACK-QTY                           13660004
136700              ,:WS-RECITM-RTV-QTY                                 13670004
136800              ,:WS-RECITM-EXPTED-CART-CNT                         13680004
136900              ,:WS-RECITM-ACTL-CART-CNT                           13690004
137000              ,:WS-RECITM-MKING-APRON-TMST                        13700004
137100              ,:WS-RECITM-UNT-COST-AMT                            13710004
137200              ,:WS-RECITM-COLOR-DESC                              13720004
137300              ,:WS-RECITM-SIZE-DESC                               13730004
137400              ,:WS-RECITM-VEND-STYL-NAME                          13740004
137500              ,:WS-RECITM-VEND-DESC                               13750004
137600              ,:WS-RECITM-VERFYD-TMST                             13760004
137700              ,:WS-RECITM-PKSL-NBR                                13770004
137800              ,:WS-RECITM-REC-INV-LNE-NBR                         13780004
137900              ,:WS-RECITM-DMG-ITM-QTY                             13790004
138000              ,:WS-RECITM-UPD-TMST                                13800004
138100              ,:WS-RECITM-UPD-UID                                 13810004
138200              ,:WS-RECITM-UPD-PGM-ID                              13820004
138300              ,:WS-RECITM-RCPT-DISTR-UPD-CDE                      13830004
138400              ,:WS-RECITM-VRFD-USR-ID                             13840004
138500              ,:WS-RECITM-LAST-TRSCP-TMST                         13850004
138600              ,:WS-RECITM-LAST-TRSCP-USR-ID                       13860004
138700              ,:WS-RECITM-PREPK-ID                                13870004
138800              ,:WS-RECITM-PREPK-RATO-QTY                          13880004
138900              ,:WS-RECITM-PREPK-ODD-UNT-QTY                       13890004
139000              ,:WS-RECITM-PREPK-DRV-LNE-CDE                       13900004
139100              ,:WS-RECITM-UNT-RTL-AMT                             13910004
139200              ,:WS-RECITM-GP-RTL-AMT                              13920004
139300              ,:WS-RECITM-GP-QTY                                  13930004
139400              ,:WS-RECITM-ORIG-PKSL-ITM-QTY                       13940004
139500        END-EXEC                                                  13950004
139600                                                                  13960004
139700        EVALUATE TRUE                                             13970004
139800            WHEN SQLCODE = ZERO OR -305                           13980004
139900                 MOVE LENGTH OF WS-RECITM TO DS009-TBLE-DATA-SIZE 13990004
140000                 COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE 14000004
140100                                           + DS009X-RECORD-FILLER 14010004
140200                 MOVE 10     TO TBLE-ORDER                        14020004
140300                 MOVE 01     TO TBLE-VERSION                      14030004
140400                 MOVE DS009-TBLE-DATA-SIZE TO TBLE-DATA-SIZE      14040004
140500                 MOVE 'TRECITM'            TO TBLE-NAME           14050004
140600                 MOVE WS-RECITM            TO TBLE-DATA-ITEM      14060004
140700                 INITIALIZE DS009-PKYS                            14070004
140800                 PERFORM DS002-PROCESS-KEYS                       14080004
140900                 MOVE WS-RECITM-KEYS  TO DS009-PKYS               14090004
141000                 MOVE DS009-PKYS      TO TBLE-KEYS                14100004
141100*                WRITE TBLE-RECORD                                14110004
141200                 PERFORM 8000-WRITE-UNLOAD                        14120004
141300            WHEN SQLCODE = +100                                   14130004
141400                 SET NO-MORE-RECITM-DATA  TO TRUE                 14140004
141500            WHEN SQLCODE = -904                                   14150004
141600            WHEN SQLCODE = -913                                   14160004
141700              CONTINUE                                            14170004
141800           END-EVALUATE                                           14180004
141900         END-PERFORM.                                             14190004
142000***************************************************************** 14200004
142100     PERFORM DS002-SQL-ABEND-FETCH.                               14210004
142200***************************************************************** 14220004
142300 EJECT                                                            14230004
142400*                                                                 14240004
142500***************************************************************** 14250004
142600*     FETCH RECDIS INFO                                           14260004
142700***************************************************************** 14270004
142800 R100-FETCH-RECDIS.                                               14280004
142900*                                                                 14290004
143000     MOVE 'TRECDIS' TO DS009-PROCESS-TABLE.                       14300004
143100     PERFORM WITH TEST AFTER                                      14310004
143200        VARYING DS009-RETRY-COUNTER FROM 1 BY 1                   14320004
143300        UNTIL   DS009-RETRY-COUNTER > 3 OR                        14330004
143400                SQLCODE = ZERO OR                                 14340004
143500                SQLCODE = +100                                    14350004
143600        EXEC SQL                                                  14360004
143700            FETCH RECDIS-CSR                                      14370004
143800            INTO                                                  14380004
143900               :WS-RECDIS-ORD-NBR                                 14390004
144000              ,:WS-RECDIS-ORD-LNE-NBR                             14400004
144100              ,:WS-RECDIS-REC-SEQ-NBR                             14410004
144200              ,:WS-RECDIS-OPER-UNT-ID                             14420004
144300              ,:WS-RECDIS-FCLTY-ID                                14430004
144400              ,:WS-RECDIS-CRE-TMST                                14440004
144500              ,:WS-RECDIS-CRE-UID                                 14450004
144600              ,:WS-RECDIS-VER-STATUS-CDE                          14460004
144700              ,:WS-RECDIS-EXPTED-ITM-QTY                          14470004
144800              ,:WS-RECDIS-VERIFY-ITM-QTY                          14480004
144900              ,:WS-RECDIS-AP-VERIFY-ITM-QTY                       14490004
145000              ,:WS-RECDIS-STR-NBR                                 14500004
145100              ,:WS-RECDIS-STR-FCLTY-ID                            14510004
145200              ,:WS-RECDIS-PLAN-ITM-QTY                            14520004
145300              ,:WS-RECDIS-AP-PRC-CDE                              14530004
145400              ,:WS-RECDIS-AP-PRC-DTE                              14540004
145500        END-EXEC                                                  14550004
145600                                                                  14560004
145700        EVALUATE TRUE                                             14570004
145800            WHEN SQLCODE = ZERO OR -305                           14580004
145900                 MOVE LENGTH OF WS-RECDIS TO DS009-TBLE-DATA-SIZE 14590004
146000                 COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE 14600004
146100                                           + DS009X-RECORD-FILLER 14610004
146200                 MOVE 10     TO TBLE-ORDER                        14620004
146300                 MOVE 02     TO TBLE-VERSION                      14630004
146400                 MOVE DS009-TBLE-DATA-SIZE TO TBLE-DATA-SIZE      14640004
146500                 MOVE 'TRECDIS'            TO TBLE-NAME           14650004
146600                 MOVE WS-RECDIS            TO TBLE-DATA-ITEM      14660004
146700                 INITIALIZE DS009-PKYS                            14670004
146800                 PERFORM DS002-PROCESS-KEYS                       14680004
146900                 MOVE WS-RECDIS-KEYS  TO DS009-PKYS               14690004
147000                 MOVE DS009-PKYS      TO TBLE-KEYS                14700004
147100*                WRITE TBLE-RECORD                                14710004
147200                 PERFORM 8000-WRITE-UNLOAD                        14720004
147300            WHEN SQLCODE = +100                                   14730004
147400                 SET NO-MORE-RECDIS-DATA  TO TRUE                 14740004
147500            WHEN SQLCODE = -904                                   14750004
147600            WHEN SQLCODE = -913                                   14760004
147700              CONTINUE                                            14770004
147800           END-EVALUATE                                           14780004
147900         END-PERFORM.                                             14790004
148000***************************************************************** 14800004
148100     PERFORM DS002-SQL-ABEND-FETCH.                               14810004
148200***************************************************************** 14820004
148300 EJECT                                                            14830004
148400***************************************************************** 14840004
148500*     FETCH SHIPMT DATA                                           14850004
148600***************************************************************** 14860004
148700 R100-FETCH-SHIPMT.                                               14870004
148800*                                                                 14880004
148900     INITIALIZE     WS-SHIPMT.                                    14890004
149000     MOVE 'TSHIPMT' TO DS009-PROCESS-TABLE.                       14900004
149100     PERFORM WITH TEST AFTER                                      14910004
149200        VARYING DS009-RETRY-COUNTER FROM 1 BY 1                   14920004
149300        UNTIL   DS009-RETRY-COUNTER > 3 OR                        14930004
149400                SQLCODE = ZERO OR                                 14940004
149500                SQLCODE = +100                                    14950004
149600        EXEC SQL                                                  14960004
149700            FETCH SHIPMT-CSR                                      14970004
149800            INTO                                                  14980004
149900               :WS-SHIPMT-TRIP-ID                                 14990004
150000               :WS-SHIPMT-TRIP-ID-NN                              15000004
150100              ,:WS-SHIPMT-SHIPT-ID                                15010004
150200              ,:WS-SHIPMT-CRT-SRC-CDE                             15020004
150300              ,:WS-SHIPMT-LAST-UPD-DTE                            15030004
150400              ,:WS-SHIPMT-LAST-UPD-TME                            15040004
150500              ,:WS-SHIPMT-LAST-UPD-UID                            15050004
150600              ,:WS-SHIPMT-PRO-SCAC-ID                             15060004
150700              ,:WS-SHIPMT-PRO-NBR                                 15070004
150800              ,:WS-SHIPMT-BOL-NBR                                 15080004
150900              ,:WS-SHIPMT-SHIPPER-NME                             15090004
151000              ,:WS-SHIPMT-SHIPT-TYP-CDE                           15100004
151100              ,:WS-SHIPMT-EXPTED-GRO-WGHT                         15110004
151200              ,:WS-SHIPMT-PKG-TYP-CDE                             15120004
151300              ,:WS-SHIPMT-EXPTED-PKG-QTY                          15130004
151400              ,:WS-SHIPMT-FRGT-CHG-AMT                            15140004
151500              ,:WS-SHIPMT-FRGT-TERMS-CDE                          15150004
151600              ,:WS-SHIPMT-EXPTED-PLT-QTY                          15160004
151700              ,:WS-SHIPMT-VEND-SHIP-DTE                           15170004
151800              ,:WS-SHIPMT-EST-AR-TMST                             15180004
151900               :WS-SHIPMT-EST-AR-TMST-NN                          15190004
152000              ,:WS-SHIPMT-ORIG-SCAC-ID                            15200004
152100              ,:WS-SHIPMT-LAST-UPD-PGM-ID                         15210004
152200              ,:WS-SHIPMT-CRE-USER-ID                             15220004
152300              ,:WS-SHIPMT-CARR-CART-CT                            15230004
152400              ,:WS-SHIPMT-CARR-LAST-UPD-DTE                       15240004
152500              ,:WS-SHIPMT-CARR-LAST-UPD-TIME                      15250004
152600              ,:WS-SHIPMT-VEND-CART-CT                            15260004
152700              ,:WS-SHIPMT-VEND-LAST-UPD-DTE                       15270004
152800              ,:WS-SHIPMT-VEND-LAST-UPD-TIME                      15280004
152900              ,:WS-SHIPMT-VEH-NBR                                 15290004
153000              ,:WS-SHIPMT-AUTH-NBR                                15300004
153100              ,:WS-SHIPMT-AUTH-DTE                                15310004
153200              ,:WS-SHIPMT-CONFIRM-DTE                             15320004
153300              ,:WS-SHIPMT-CONFIRM-TIME                            15330004
153400              ,:WS-SHIPMT-COMPLETE-PRO-NBR                        15340004
153500              ,:WS-SHIPMT-COMPLETE-BOL-NBR                        15350004
153600              ,:WS-SHIPMT-PROCESSED-DTE                           15360004
153700              ,:WS-SHIPMT-INVC-NBR                                15370004
153800              ,:WS-SHIPMT-CARR-AUTH-ID                            15380004
153900        END-EXEC                                                  15390004
154000                                                                  15400004
154100        EVALUATE TRUE                                             15410004
154200            WHEN SQLCODE = ZERO OR -305                           15420004
154300                 MOVE LENGTH OF WS-SHIPMT TO DS009-TBLE-DATA-SIZE 15430004
154400                 COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE 15440004
154500                                           + DS009X-RECORD-FILLER 15450004
154600                 MOVE 11     TO TBLE-ORDER                        15460004
154700                 MOVE 03     TO TBLE-VERSION                      15470004
154800                 MOVE DS009-TBLE-DATA-SIZE TO TBLE-DATA-SIZE      15480004
154900                 MOVE 'TSHIPMT'            TO TBLE-NAME           15490004
155000                 MOVE WS-SHIPMT            TO TBLE-DATA-ITEM      15500004
155100                 INITIALIZE DS009-PKYS                            15510004
155200                 PERFORM DS002-PROCESS-KEYS                       15520004
155300                 MOVE WS-SHIPMT-KEYS  TO DS009-PKYS               15530004
155400                 MOVE DS009-PKYS      TO TBLE-KEYS                15540004
155500*                WRITE TBLE-RECORD                                15550004
155600                 PERFORM 8000-WRITE-UNLOAD                        15560004
155700                                                                  15570004
155800                 SET MORE-TRIPST-DATA TO TRUE                     15580004
155900                 SET MORE-VHTRIP-DATA TO TRUE                     15590004
156000                                                                  15600004
156100                 MOVE WS-SHIPMT-TRIP-ID  TO HOLD-TRIP-ID          15610004
156200                 MOVE 'TVHTRIP' TO DS009-PROCESS-TABLE            15620004
156300                 PERFORM DS002-DO-PROCESS                         15630004
156400                 IF DS009-DO-PROCESS                              15640004
156500                     PERFORM Y100-OPEN-CURSOR                     15650004
156600                     PERFORM R100-FETCH-VHTRIP                    15660004
156700                         UNTIL NO-MORE-VHTRIP-DATA                15670004
156800                     PERFORM Y100-CLOSE-CURSOR                    15680004
156900                 END-IF                                           15690004
157000                                                                  15700004
157100                 MOVE WS-SHIPMT-TRIP-ID  TO HOLD-TRIP-ID          15710004
157200                 MOVE 'TTRIPST' TO DS009-PROCESS-TABLE            15720004
157300                 PERFORM DS002-DO-PROCESS                         15730004
157400                 IF DS009-DO-PROCESS                              15740004
157500                     PERFORM Y100-OPEN-CURSOR                     15750004
157600                     PERFORM R100-FETCH-TRIPST                    15760004
157700                         UNTIL NO-MORE-TRIPST-DATA                15770004
157800                     PERFORM Y100-CLOSE-CURSOR                    15780004
157900                 END-IF                                           15790004
158000                                                                  15800004
158100                 MOVE WS-SHIPMT-SHIPT-ID TO HOLD-SHIPT-ID         15810004
158200                 MOVE 'TAUSHIP' TO DS009-PROCESS-TABLE            15820004
158300                 PERFORM DS002-DO-PROCESS                         15830004
158400                 IF DS009-DO-PROCESS                              15840004
158500                    SET MORE-AUSHIP-DATA TO TRUE                  15850004
158600                    PERFORM Y100-OPEN-CURSOR                      15860004
158700                    PERFORM R100-FETCH-AUSHIP                     15870004
158800                        UNTIL NO-MORE-AUSHIP-DATA                 15880004
158900                    MOVE 'TAUSHIP' TO DS009-PROCESS-TABLE         15890004
159000                    PERFORM Y100-CLOSE-CURSOR                     15900004
159100                 END-IF                                           15910004
159200                                                                  15920004
159300                MOVE WS-SHIPMT-TRIP-ID  TO HOLD-TRIP-ID           15930004
159400                MOVE 'TLBPTDA'          TO DS009-PROCESS-TABLE    15940004
159500                PERFORM DS002-DO-PROCESS                          15950004
159600                IF DS009-DO-PROCESS                               15960004
159700                   SET MORE-LBPTDA-DATA TO TRUE                   15970004
159800                   PERFORM Y100-OPEN-CURSOR                       15980004
159900                   PERFORM R100-FETCH-LBPTDA                      15990004
160000                            UNTIL NO-MORE-LBPTDA-DATA             16000004
160100                   MOVE 'TLBPTDA' TO DS009-PROCESS-TABLE          16010004
160200                   PERFORM Y100-CLOSE-CURSOR                      16020004
160300                END-IF                                            16030004
160400                                                                  16040004
160500            WHEN SQLCODE = +100                                   16050004
160600                 SET NO-MORE-SHIPMT-DATA  TO TRUE                 16060004
160700            WHEN SQLCODE = -904                                   16070004
160800            WHEN SQLCODE = -913                                   16080004
160900              CONTINUE                                            16090004
161000           END-EVALUATE                                           16100004
161100         END-PERFORM.                                             16110004
161200***************************************************************** 16120004
161300     PERFORM DS002-SQL-ABEND-FETCH.                               16130004
161400***************************************************************** 16140004
161500 EJECT                                                            16150004
161600*                                                                 16160004
161700***************************************************************** 16170004
161800*     FETCH SHIPST DATA                                           16180004
161900***************************************************************** 16190004
162000 R100-FETCH-SHIPST.                                               16200004
162100*                                                                 16210004
162200     MOVE 'TSHIPST' TO DS009-PROCESS-TABLE.                       16220004
162300     PERFORM WITH TEST AFTER                                      16230004
162400        VARYING DS009-RETRY-COUNTER FROM 1 BY 1                   16240004
162500        UNTIL   DS009-RETRY-COUNTER > 3 OR                        16250004
162600                SQLCODE = ZERO OR                                 16260004
162700                SQLCODE = +100                                    16270004
162800        EXEC SQL                                                  16280004
162900            FETCH SHIPST-CSR                                      16290004
163000            INTO                                                  16300004
163100               :WS-SHIPST-SHIPT-ID                                16310004
163200              ,:WS-SHIPST-SHIPT-STATUS-CDE                        16320004
163300              ,:WS-SHIPST-STATUS-DTE                              16330004
163400              ,:WS-SHIPST-STATUS-TME                              16340004
163500              ,:WS-SHIPST-STATUS-UID                              16350004
163600              ,:WS-SHIPST-DELAY-RSN-CDE                           16360004
163700              ,:WS-SHIPST-CARR-STATUS-CDE                         16370004
163800              ,:WS-SHIPST-TIME-ZONE-CDE                           16380004
163900              ,:WS-SHIPST-CITY-NAME                               16390004
164000              ,:WS-SHIPST-STATE-CDE                               16400004
164100        END-EXEC                                                  16410004
164200                                                                  16420004
164300        EVALUATE TRUE                                             16430004
164400            WHEN SQLCODE = ZERO OR -305                           16440004
164500                 MOVE LENGTH OF WS-SHIPST TO DS009-TBLE-DATA-SIZE 16450004
164600                 COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE 16460004
164700                                           + DS009X-RECORD-FILLER 16470004
164800                 MOVE 11     TO TBLE-ORDER                        16480004
164900                 MOVE 13     TO TBLE-VERSION                      16490004
165000                 MOVE DS009-TBLE-DATA-SIZE TO TBLE-DATA-SIZE      16500004
165100                 MOVE 'TSHIPST'            TO TBLE-NAME           16510004
165200                 MOVE WS-SHIPST            TO TBLE-DATA-ITEM      16520004
165300                 INITIALIZE DS009-PKYS                            16530004
165400                 PERFORM DS002-PROCESS-KEYS                       16540004
165500                 MOVE WS-SHIPST-KEYS  TO DS009-PKYS               16550004
165600                 MOVE DS009-PKYS      TO TBLE-KEYS                16560004
165700*                WRITE TBLE-RECORD                                16570004
165800                 PERFORM 8000-WRITE-UNLOAD                        16580004
165900            WHEN SQLCODE = +100                                   16590004
166000                 SET NO-MORE-SHIPST-DATA  TO TRUE                 16600004
166100            WHEN SQLCODE = -904                                   16610004
166200            WHEN SQLCODE = -913                                   16620004
166300              CONTINUE                                            16630004
166400           END-EVALUATE                                           16640004
166500         END-PERFORM.                                             16650004
166600***************************************************************** 16660004
166700     PERFORM DS002-SQL-ABEND-FETCH.                               16670004
166800***************************************************************** 16680004
166900 EJECT                                                            16690004
167000*                                                                 16700004
167100***************************************************************** 16710004
167200*     FETCH TRIPST DATA                                           16720004
167300***************************************************************** 16730004
167400 R100-FETCH-TRIPST.                                               16740004
167500*                                                                 16750004
167600     MOVE 'TTRIPST' TO DS009-PROCESS-TABLE.                       16760004
167700     PERFORM WITH TEST AFTER                                      16770004
167800        VARYING DS009-RETRY-COUNTER FROM 1 BY 1                   16780004
167900        UNTIL   DS009-RETRY-COUNTER > 3 OR                        16790004
168000                SQLCODE = ZERO OR                                 16800004
168100                SQLCODE = +100                                    16810004
168200        EXEC SQL                                                  16820004
168300            FETCH TRIPST-CSR                                      16830004
168400            INTO                                                  16840004
168500               :WS-TRIPST-TRIP-ID                                 16850004
168600              ,:WS-TRIPST-TRIP-STATUS-CDE                         16860004
168700              ,:WS-TRIPST-STATUS-DTE                              16870004
168800              ,:WS-TRIPST-STATUS-TME                              16880004
168900              ,:WS-TRIPST-STATUS-UID                              16890004
169000              ,:WS-TRIPST-OPER-UNT-ID                             16900004
169100              ,:WS-TRIPST-FCLTY-ID                                16910004
169200              ,:WS-TRIPST-FCLTY-AREA-ID                           16920004
169300        END-EXEC                                                  16930004
169400                                                                  16940004
169500        EVALUATE TRUE                                             16950004
169600            WHEN SQLCODE = ZERO OR -305                           16960004
169700                 MOVE LENGTH OF WS-TRIPST TO DS009-TBLE-DATA-SIZE 16970004
169800                 COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE 16980004
169900                                           + DS009X-RECORD-FILLER 16990004
170000                 MOVE 11     TO TBLE-ORDER                        17000004
170100                 MOVE 04     TO TBLE-VERSION                      17010004
170200                 MOVE DS009-TBLE-DATA-SIZE TO TBLE-DATA-SIZE      17020004
170300                 MOVE 'TTRIPST'         TO TBLE-NAME              17030004
170400                 MOVE WS-TRIPST         TO TBLE-DATA-ITEM         17040004
170500                 INITIALIZE DS009-PKYS                            17050004
170600                 PERFORM DS002-PROCESS-KEYS                       17060004
170700                 MOVE WS-TRIPST-KEYS  TO DS009-PKYS               17070004
170800                 MOVE DS009-PKYS      TO TBLE-KEYS                17080004
170900*                WRITE TBLE-RECORD                                17090004
171000                 PERFORM 8000-WRITE-UNLOAD                        17100004
171100            WHEN SQLCODE = +100                                   17110004
171200                 SET NO-MORE-TRIPST-DATA TO TRUE                  17120004
171300            WHEN SQLCODE = -904                                   17130004
171400            WHEN SQLCODE = -913                                   17140004
171500              CONTINUE                                            17150004
171600           END-EVALUATE                                           17160004
171700         END-PERFORM.                                             17170004
171800***************************************************************** 17180004
171900     PERFORM DS002-SQL-ABEND-FETCH.                               17190004
172000***************************************************************** 17200004
172100 EJECT                                                            17210004
172200*                                                                 17220004
172300***************************************************************** 17230004
172400*     FETCH VHTRIP INFO                                           17240004
172500***************************************************************** 17250004
172600 R100-FETCH-VHTRIP.                                               17260004
172700*                                                                 17270004
172800     INITIALIZE     WS-VHTRIP.                                    17280004
172900     MOVE 'TVHTRIP' TO DS009-PROCESS-TABLE.                       17290004
173000     PERFORM WITH TEST AFTER                                      17300004
173100        VARYING DS009-RETRY-COUNTER FROM 1 BY 1                   17310004
173200        UNTIL   DS009-RETRY-COUNTER > 3 OR                        17320004
173300                SQLCODE = ZERO OR                                 17330004
173400                SQLCODE = +100                                    17340004
173500        EXEC SQL                                                  17350004
173600            FETCH VHTRIP-CSR                                      17360004
173700            INTO                                                  17370004
173800               :WS-VHTRIP-OWNER-SCAC-ID                           17380004
173900              ,:WS-VHTRIP-VEH-NBR                                 17390004
174000               :WS-VHTRIP-VEH-NBR-NN                              17400004
174100              ,:WS-VHTRIP-TRIP-ID                                 17410004
174200              ,:WS-VHTRIP-TRIP-BEG-DTE                            17420004
174300              ,:WS-VHTRIP-TRIP-BEG-TME                            17430004
174400              ,:WS-VHTRIP-CRT-SRC-CDE                             17440004
174500              ,:WS-VHTRIP-LAST-UPD-DTE                            17450004
174600              ,:WS-VHTRIP-LAST-UPD-TME                            17460004
174700              ,:WS-VHTRIP-LAST-UPD-UID                            17470004
174800              ,:WS-VHTRIP-MANIFEST-NBR                            17480004
174900              ,:WS-VHTRIP-PLND-TRIP-SEQ                           17490004
175000              ,:WS-VHTRIP-PLND-ACTVY-CDE                          17500004
175100              ,:WS-VHTRIP-OWNR-SCAC-SHIP-DTE                      17510004
175200              ,:WS-VHTRIP-REF-TRIP-ID                             17520004
175300              ,:WS-VHTRIP-EST-AR-TMST                             17530004
175400               :WS-VHTRIP-EST-AR-TMST-NN                          17540004
175500              ,:WS-VHTRIP-SPLT-XMIT-IND                           17550004
175600              ,:WS-VHTRIP-SPLT-XMIT-DTE                           17560004
175700              ,:WS-VHTRIP-SPLT-XMIT-TM                            17570004
175800        END-EXEC                                                  17580004
175900                                                                  17590004
176000        EVALUATE TRUE                                             17600004
176100            WHEN SQLCODE = ZERO OR -305                           17610004
176200                 MOVE LENGTH OF WS-VHTRIP TO DS009-TBLE-DATA-SIZE 17620004
176300                 COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE 17630004
176400                                           + DS009X-RECORD-FILLER 17640004
176500                 MOVE 11     TO TBLE-ORDER                        17650004
176600                 MOVE 02     TO TBLE-VERSION                      17660004
176700                 MOVE DS009-TBLE-DATA-SIZE TO TBLE-DATA-SIZE      17670004
176800                 MOVE 'TVHTRIP'            TO TBLE-NAME           17680004
176900                 MOVE WS-VHTRIP            TO TBLE-DATA-ITEM      17690004
177000                 INITIALIZE DS009-PKYS                            17700004
177100                 PERFORM DS002-PROCESS-KEYS                       17710004
177200                 MOVE WS-VHTRIP-KEYS  TO DS009-PKYS               17720004
177300                 MOVE DS009-PKYS      TO TBLE-KEYS                17730004
177400*                WRITE TBLE-RECORD                                17740004
177500                 PERFORM 8000-WRITE-UNLOAD                        17750004
177600                                                                  17760004
177700                 MOVE WS-VHTRIP-VEH-NBR       TO HOLD-VEH-NBR     17770004
177800                 MOVE WS-VHTRIP-OWNER-SCAC-ID TO HOLD-SCAC-ID     17780004
177900                 MOVE 'TVEHICL' TO DS009-PROCESS-TABLE            17790004
178000                 PERFORM DS002-DO-PROCESS                         17800004
178100                 IF DS009-DO-PROCESS                              17810004
178200                     SET MORE-VEHICL-DATA TO TRUE                 17820004
178300                     PERFORM Y100-OPEN-CURSOR                     17830004
178400                     PERFORM R100-FETCH-VEHICL                    17840004
178500                         UNTIL NO-MORE-VEHICL-DATA                17850004
178600                     PERFORM Y100-CLOSE-CURSOR                    17860004
178700                 END-IF                                           17870004
178800                                                                  17880004
178900                 MOVE WS-VHTRIP-TRIP-ID TO HOLD-TRIP-ID           17890004
179000                 MOVE 'TAUTRIP' TO DS009-PROCESS-TABLE            17900004
179100                 PERFORM DS002-DO-PROCESS                         17910004
179200                 IF DS009-DO-PROCESS                              17920004
179300                    SET MORE-AUTRIP-DATA TO TRUE                  17930004
179400                    PERFORM Y100-OPEN-CURSOR                      17940004
179500                    PERFORM R100-FETCH-AUTRIP                     17950004
179600                        UNTIL NO-MORE-AUTRIP-DATA                 17960004
179700                    MOVE 'TAUTRIP' TO DS009-PROCESS-TABLE         17970004
179800                    PERFORM Y100-CLOSE-CURSOR                     17980004
179900                 END-IF                                           17990004
180000                                                                  18000004
180100            WHEN SQLCODE = +100                                   18010004
180200                 SET NO-MORE-VHTRIP-DATA  TO TRUE                 18020004
180300            WHEN SQLCODE = -904                                   18030004
180400            WHEN SQLCODE = -913                                   18040004
180500              CONTINUE                                            18050004
180600           END-EVALUATE                                           18060004
180700         END-PERFORM.                                             18070004
180800***************************************************************** 18080004
180900     PERFORM DS002-SQL-ABEND-FETCH.                               18090004
181000***************************************************************** 18100004
181100 EJECT                                                            18110004
181200***************************************************************** 18120004
181300*     FETCH VEHICL DATA                                           18130004
181400***************************************************************** 18140004
181500 R100-FETCH-VEHICL.                                               18150004
181600*                                                                 18160004
181700     INITIALIZE     WS-VEHICL.                                    18170004
181800     MOVE 'TVEHICL' TO DS009-PROCESS-TABLE.                       18180004
181900     PERFORM WITH TEST AFTER                                      18190004
182000        VARYING DS009-RETRY-COUNTER FROM 1 BY 1                   18200004
182100        UNTIL   DS009-RETRY-COUNTER > 3 OR                        18210004
182200                SQLCODE = ZERO OR                                 18220004
182300                SQLCODE = +100                                    18230004
182400        EXEC SQL                                                  18240004
182500            FETCH VEHICL-CSR                                      18250004
182600            INTO                                                  18260004
182700               :WS-VEHICL-OWNER-SCAC-ID                           18270004
182800              ,:WS-VEHICL-VEH-NBR                                 18280004
182900              ,:WS-VEHICL-CRT-SRC-CDE                             18290004
183000              ,:WS-VEHICL-LAST-UPD-DTE                            18300004
183100              ,:WS-VEHICL-LAST-UPD-TME                            18310004
183200              ,:WS-VEHICL-LAST-UPD-UID                            18320004
183300              ,:WS-VEHICL-USAGE-CDE                               18330004
183400              ,:WS-VEHICL-VEH-TYP-CDE                             18340004
183500              ,:WS-VEHICL-CURR-STATUS-CDE                         18350004
183600              ,:WS-VEHICL-CURR-STATUS-DTE                         18360004
183700              ,:WS-VEHICL-CURR-STATUS-TME                         18370004
183800              ,:WS-VEHICL-CURR-OPER-UNT-ID                        18380004
183900              ,:WS-VEHICL-CURR-FCLTY-ID                           18390004
184000              ,:WS-VEHICL-CURR-FAC-AREA-ID                        18400004
184100              ,:WS-VEHICL-CURR-LOC-DTE                            18410004
184200              ,:WS-VEHICL-CURR-LOC-TME                            18420004
184300              ,:WS-VEHICL-CURR-TRIP-ID                            18430004
184400               :WS-VEHICL-CURR-TRIP-ID-NN                         18440004
184500              ,:WS-VEHICL-VEH-SIZE-CDE                            18450004
184600        END-EXEC                                                  18460004
184700                                                                  18470004
184800        EVALUATE TRUE                                             18480004
184900            WHEN SQLCODE = ZERO OR -305                           18490004
185000                 MOVE LENGTH OF WS-VEHICL TO DS009-TBLE-DATA-SIZE 18500004
185100                 COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE 18510004
185200                                           + DS009X-RECORD-FILLER 18520004
185300                 MOVE 11     TO TBLE-ORDER                        18530004
185400                 MOVE 09     TO TBLE-VERSION                      18540004
185500                 MOVE DS009-TBLE-DATA-SIZE TO TBLE-DATA-SIZE      18550004
185600                 MOVE 'TVEHICL'            TO TBLE-NAME           18560004
185700                 MOVE WS-VEHICL            TO TBLE-DATA-ITEM      18570004
185800                 INITIALIZE DS009-PKYS                            18580004
185900                 PERFORM DS002-PROCESS-KEYS                       18590004
186000                 MOVE WS-VEHICL-KEYS  TO DS009-PKYS               18600004
186100                 MOVE DS009-PKYS      TO TBLE-KEYS                18610004
186200*                WRITE TBLE-RECORD                                18620004
186300                 PERFORM 8000-WRITE-UNLOAD                        18630004
186400                                                                  18640004
186500                 MOVE WS-VEHICL-OWNER-SCAC-ID TO                  18650004
186600                               HOLD-OWNER-SCAC-ID                 18660004
186700                 MOVE WS-VEHICL-VEH-NBR TO HOLD-VEH-NBR           18670004
186800                 MOVE 'TAUVHCL' TO DS009-PROCESS-TABLE            18680004
186900                 PERFORM DS002-DO-PROCESS                         18690004
187000                 IF DS009-DO-PROCESS                              18700004
187100                    SET MORE-AUVHCL-DATA TO TRUE                  18710004
187200                    PERFORM Y100-OPEN-CURSOR                      18720004
187300                    PERFORM R100-FETCH-AUVHCL                     18730004
187400                        UNTIL NO-MORE-AUVHCL-DATA                 18740004
187500                    MOVE 'TAUVHCL' TO DS009-PROCESS-TABLE         18750004
187600                    PERFORM Y100-CLOSE-CURSOR                     18760004
187700                 END-IF                                           18770004
187800                                                                  18780004
187900            WHEN SQLCODE = +100                                   18790004
188000                 SET NO-MORE-VEHICL-DATA  TO TRUE                 18800004
188100            WHEN SQLCODE = -904                                   18810004
188200            WHEN SQLCODE = -913                                   18820004
188300              CONTINUE                                            18830004
188400           END-EVALUATE                                           18840004
188500         END-PERFORM.                                             18850004
188600***************************************************************** 18860004
188700     PERFORM DS002-SQL-ABEND-FETCH.                               18870004
188800***************************************************************** 18880004
188900 EJECT                                                            18890004
189000***************************************************************** 18900004
189100*     FETCH RECDVS DATA                                           18910004
189200***************************************************************** 18920004
189300*                                                                 18930004
189400 R100-FETCH-RECDVS.                                               18940004
189500*                                                                 18950004
189600     MOVE 'TRECDVS' TO DS009-PROCESS-TABLE.                       18960004
189700     PERFORM WITH TEST AFTER                                      18970004
189800        VARYING DS009-RETRY-COUNTER FROM 1 BY 1                   18980004
189900        UNTIL   DS009-RETRY-COUNTER > 3 OR                        18990004
190000                SQLCODE = ZERO OR                                 19000004
190100                SQLCODE = +100                                    19010004
190200        EXEC SQL                                                  19020004
190300            FETCH RECDVS-CSR                                      19030004
190400            INTO                                                  19040004
190500                 :WS-RECDVS                                       19050004
190600        END-EXEC                                                  19060004
190700                                                                  19070004
190800        EVALUATE TRUE                                             19080004
190900            WHEN SQLCODE = ZERO OR -305                           19090004
191000                 MOVE LENGTH OF WS-RECDVS TO DS009-TBLE-DATA-SIZE 19100004
191100                 COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE 19110004
191200                                        + DS009X-RECORD-FILLER    19120004
191300                 MOVE 10     TO TBLE-ORDER                        19130004
191400                 MOVE 11     TO TBLE-VERSION                      19140004
191500                 MOVE DS009-TBLE-DATA-SIZE TO TBLE-DATA-SIZE      19150004
191600                 MOVE 'TRECDVS'            TO TBLE-NAME           19160004
191700                 MOVE WS-RECDVS            TO TBLE-DATA-ITEM      19170004
191800                 INITIALIZE DS009-PKYS                            19180004
191900                 PERFORM DS002-PROCESS-KEYS                       19190004
192000                 MOVE WS-RECDVS-KEYS      TO DS009-PKYS           19200004
192100                 MOVE DS009-PKYS          TO TBLE-KEYS            19210004
192200*                WRITE TBLE-RECORD                                19220004
192300                 PERFORM 8000-WRITE-UNLOAD                        19230004
192400                                                                  19240004
192500            WHEN SQLCODE = +100                                   19250004
192600                 SET NO-MORE-RECDVS-DATA  TO TRUE                 19260004
192700            WHEN SQLCODE = -904                                   19270004
192800            WHEN SQLCODE = -913                                   19280004
192900              CONTINUE                                            19290004
193000           END-EVALUATE                                           19300004
193100         END-PERFORM.                                             19310004
193200***************************************************************** 19320004
193300     PERFORM DS002-SQL-ABEND-FETCH.                               19330004
193400***************************************************************** 19340004
193500 EJECT                                                            19350004
193600***************************************************************** 19360004
193700*     FETCH AUTRIP DATA                                           19370004
193800***************************************************************** 19380004
193900*                                                                 19390004
194000 R100-FETCH-AUTRIP.                                               19400004
194100*                                                                 19410004
194200     INITIALIZE     WS-AUTRIP.                                    19420004
194300     MOVE 'TAUTRIP' TO DS009-PROCESS-TABLE.                       19430004
194400     PERFORM WITH TEST AFTER                                      19440004
194500        VARYING DS009-RETRY-COUNTER FROM 1 BY 1                   19450004
194600        UNTIL   DS009-RETRY-COUNTER > 3 OR                        19460004
194700                SQLCODE = ZERO OR                                 19470004
194800                SQLCODE = +100                                    19480004
194900        EXEC SQL                                                  19490004
195000            FETCH AUTRIP-CSR                                      19500004
195100            INTO                                                  19510004
195200                    :WS-AUTRIP-OWNER-SCAC-ID                      19520004
195300                   ,:WS-AUTRIP-VEH-NBR                            19530004
195400                    :WS-AUTRIP-VEH-NBR-NN                         19540004
195500                   ,:WS-AUTRIP-TRIP-ID                            19550004
195600                   ,:WS-AUTRIP-TRIP-BEG-DTE                       19560004
195700                   ,:WS-AUTRIP-TRIP-BEG-TME                       19570004
195800                   ,:WS-AUTRIP-CRT-SRC-CDE                        19580004
195900                   ,:WS-AUTRIP-LAST-UPD-DTE                       19590004
196000                   ,:WS-AUTRIP-LAST-UPD-TME                       19600004
196100                   ,:WS-AUTRIP-LAST-UPD-UID                       19610004
196200                   ,:WS-AUTRIP-MANIFEST-NBR                       19620004
196300                   ,:WS-AUTRIP-PLND-TRIP-SEQ                      19630004
196400                   ,:WS-AUTRIP-PLND-ACTVY-CDE                     19640004
196500                   ,:WS-AUTRIP-REF-TRIP-ID                        19650004
196600                   ,:WS-AUTRIP-EST-AR-TMST                        19660004
196700                    :WS-AUTRIP-EST-AR-TMST-NN                     19670004
196800                   ,:WS-AUTRIP-OWNR-SCAC-SHIP-DTE                 19680004
196900                   ,:WS-AUTRIP-AUD-STATUS-CDE                     19690004
197000                   ,:WS-AUTRIP-SPLT-XMIT-IND                      19700004
197100                   ,:WS-AUTRIP-SPLT-XMIT-DTE                      19710004
197200                   ,:WS-AUTRIP-SPLT-XMIT-TM                       19720004
197300        END-EXEC                                                  19730004
197400                                                                  19740004
197500        EVALUATE TRUE                                             19750004
197600            WHEN SQLCODE = ZERO OR -305                           19760004
197700                 MOVE LENGTH OF WS-AUTRIP TO DS009-TBLE-DATA-SIZE 19770004
197800                 COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE 19780004
197900                                        + DS009X-RECORD-FILLER    19790004
198000                 MOVE 11     TO TBLE-ORDER                        19800004
198100                 MOVE 07     TO TBLE-VERSION                      19810004
198200                 MOVE DS009-TBLE-DATA-SIZE TO TBLE-DATA-SIZE      19820004
198300                 MOVE 'TAUTRIP'            TO TBLE-NAME           19830004
198400                 MOVE WS-AUTRIP            TO TBLE-DATA-ITEM      19840004
198500                 INITIALIZE DS009-PKYS                            19850004
198600                 PERFORM DS002-PROCESS-KEYS                       19860004
198700                 MOVE WS-AUTRIP-KEYS      TO DS009-PKYS           19870004
198800                 MOVE DS009-PKYS          TO TBLE-KEYS            19880004
198900*                WRITE TBLE-RECORD                                19890004
199000                 PERFORM 8000-WRITE-UNLOAD                        19900004
199100                                                                  19910004
199200            WHEN SQLCODE = +100                                   19920004
199300                 SET NO-MORE-AUTRIP-DATA  TO TRUE                 19930004
199400            WHEN SQLCODE = -904                                   19940004
199500            WHEN SQLCODE = -913                                   19950004
199600              CONTINUE                                            19960004
199700           END-EVALUATE                                           19970004
199800         END-PERFORM.                                             19980004
199900***************************************************************** 19990004
200000     PERFORM DS002-SQL-ABEND-FETCH.                               20000004
200100***************************************************************** 20010004
200200 EJECT                                                            20020004
200300***************************************************************** 20030004
200400*     FETCH AUSHIP DATA                                           20040004
200500***************************************************************** 20050004
200600*                                                                 20060004
200700 R100-FETCH-AUSHIP.                                               20070004
200800*                                                                 20080004
200900     MOVE  'TAUSHIP'  TO DS009-PROCESS-TABLE.                     20090004
201000     PERFORM WITH TEST AFTER                                      20100004
201100        VARYING DS009-RETRY-COUNTER FROM 1 BY 1                   20110004
201200        UNTIL   DS009-RETRY-COUNTER > 3 OR                        20120004
201300                SQLCODE = ZERO OR                                 20130004
201400                SQLCODE = +100                                    20140004
201500        EXEC SQL                                                  20150004
201600            FETCH AUSHIP-CSR                                      20160004
201700            INTO                                                  20170004
201800                   :WS-AUSHIP-TRIP-ID                             20180004
201900                   :WS-AUSHIP-TRIP-ID-NN                          20190004
202000                  ,:WS-AUSHIP-SHIPT-ID                            20200004
202100                  ,:WS-AUSHIP-CRT-SRC-CDE                         20210004
202200                  ,:WS-AUSHIP-LAST-UPD-DTE                        20220004
202300                  ,:WS-AUSHIP-LAST-UPD-TME                        20230004
202400                  ,:WS-AUSHIP-LAST-UPD-UID                        20240004
202500                  ,:WS-AUSHIP-PRO-SCAC-ID                         20250004
202600                  ,:WS-AUSHIP-PRO-NBR                             20260004
202700                  ,:WS-AUSHIP-BOL-NBR                             20270004
202800                  ,:WS-AUSHIP-SHIPPER-NME                         20280004
202900                  ,:WS-AUSHIP-SHIPT-TYP-CDE                       20290004
203000                  ,:WS-AUSHIP-EXPTED-GRO-WGHT                     20300004
203100                  ,:WS-AUSHIP-PKG-TYP-CDE                         20310004
203200                  ,:WS-AUSHIP-EXPTED-PKG-QTY                      20320004
203300                  ,:WS-AUSHIP-FRGT-CHG-AMT                        20330004
203400                  ,:WS-AUSHIP-FRGT-TERMS-CDE                      20340004
203500                  ,:WS-AUSHIP-EST-AR-TMST                         20350004
203600                   :WS-AUSHIP-EST-AR-TMST-NN                      20360004
203700                  ,:WS-AUSHIP-VEND-SHIP-DTE                       20370004
203800                  ,:WS-AUSHIP-EXPTED-PLT-QTY                      20380004
203900                  ,:WS-AUSHIP-ORIG-SCAC-ID                        20390004
204000                  ,:WS-AUSHIP-LAST-UPD-PGM-ID                     20400004
204100                  ,:WS-AUSHIP-CRE-USER-ID                         20410004
204200                  ,:WS-AUSHIP-CARR-CART-CT                        20420004
204300                  ,:WS-AUSHIP-CARR-LAST-UPD-DTE                   20430004
204400                  ,:WS-AUSHIP-CARR-LAST-UPD-TIME                  20440004
204500                  ,:WS-AUSHIP-VEND-CART-CT                        20450004
204600                  ,:WS-AUSHIP-VEND-LAST-UPD-DTE                   20460004
204700                  ,:WS-AUSHIP-VEND-LAST-UPD-TIME                  20470004
204800                  ,:WS-AUSHIP-VEH-NBR                             20480004
204900                  ,:WS-AUSHIP-AUTH-NBR                            20490004
205000                  ,:WS-AUSHIP-AUTH-DTE                            20500004
205100                  ,:WS-AUSHIP-CONFIRM-DTE                         20510004
205200                  ,:WS-AUSHIP-CONFIRM-TIME                        20520004
205300                  ,:WS-AUSHIP-AUD-STATUS-CDE                      20530004
205400                  ,:WS-AUSHIP-PROCESSED-DTE                       20540004
205500                  ,:WS-AUSHIP-INVC-NBR                            20550004
205600                  ,:WS-AUSHIP-CARR-AUTH-ID                        20560004
205700        END-EXEC                                                  20570004
205800                                                                  20580004
205900        EVALUATE TRUE                                             20590004
206000            WHEN SQLCODE = ZERO OR -305                           20600004
206100                 MOVE LENGTH OF WS-AUSHIP TO DS009-TBLE-DATA-SIZE 20610004
206200                 COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE 20620004
206300                                        + DS009X-RECORD-FILLER    20630004
206400                 MOVE 11     TO TBLE-ORDER                        20640004
206500                 MOVE 05     TO TBLE-VERSION                      20650004
206600                 MOVE DS009-TBLE-DATA-SIZE TO TBLE-DATA-SIZE      20660004
206700                 MOVE 'TAUSHIP'            TO TBLE-NAME           20670004
206800                 MOVE WS-AUSHIP            TO TBLE-DATA-ITEM      20680004
206900                 INITIALIZE DS009-PKYS                            20690004
207000                 PERFORM DS002-PROCESS-KEYS                       20700004
207100                 MOVE WS-AUSHIP-KEYS      TO DS009-PKYS           20710004
207200                 MOVE DS009-PKYS          TO TBLE-KEYS            20720004
207300*                WRITE TBLE-RECORD                                20730004
207400                 PERFORM 8000-WRITE-UNLOAD                        20740004
207500                                                                  20750004
207600            WHEN SQLCODE = +100                                   20760004
207700                 SET NO-MORE-AUSHIP-DATA  TO TRUE                 20770004
207800            WHEN SQLCODE = -904                                   20780004
207900            WHEN SQLCODE = -913                                   20790004
208000              CONTINUE                                            20800004
208100           END-EVALUATE                                           20810004
208200         END-PERFORM.                                             20820004
208300***************************************************************** 20830004
208400     PERFORM DS002-SQL-ABEND-FETCH.                               20840004
208500***************************************************************** 20850004
208600 EJECT                                                            20860004
208700***************************************************************** 20870004
208800*     FETCH AUSHPO DATA                                           20880004
208900***************************************************************** 20890004
209000*                                                                 20900004
209100 R100-FETCH-AUSHPO.                                               20910004
209200*                                                                 20920004
209300     MOVE  'TAUSHPO'  TO DS009-PROCESS-TABLE.                     20930004
209400     PERFORM WITH TEST AFTER                                      20940004
209500        VARYING DS009-RETRY-COUNTER FROM 1 BY 1                   20950004
209600        UNTIL   DS009-RETRY-COUNTER > 3 OR                        20960004
209700                SQLCODE = ZERO OR                                 20970004
209800                SQLCODE = +100                                    20980004
209900        EXEC SQL                                                  20990004
210000            FETCH AUSHPO-CSR                                      21000004
210100            INTO                                                  21010004
210200                 :WS-AUSHPO                                       21020004
210300        END-EXEC                                                  21030004
210400                                                                  21040004
210500        EVALUATE TRUE                                             21050004
210600            WHEN SQLCODE = ZERO OR -305                           21060004
210700                 MOVE LENGTH OF WS-AUSHPO TO DS009-TBLE-DATA-SIZE 21070004
210800                 COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE 21080004
210900                                        + DS009X-RECORD-FILLER    21090004
211000                 MOVE 11     TO TBLE-ORDER                        21100004
211100                 MOVE 08     TO TBLE-VERSION                      21110004
211200                 MOVE DS009-TBLE-DATA-SIZE TO TBLE-DATA-SIZE      21120004
211300                 MOVE 'TAUSHPO'            TO TBLE-NAME           21130004
211400                 MOVE WS-AUSHPO            TO TBLE-DATA-ITEM      21140004
211500                 INITIALIZE DS009-PKYS                            21150004
211600                 PERFORM DS002-PROCESS-KEYS                       21160004
211700                 MOVE WS-AUSHPO-KEYS      TO DS009-PKYS           21170004
211800                 MOVE DS009-PKYS          TO TBLE-KEYS            21180004
211900*                WRITE TBLE-RECORD                                21190004
212000                 PERFORM 8000-WRITE-UNLOAD                        21200004
212100                                                                  21210004
212200            WHEN SQLCODE = +100                                   21220004
212300                 SET NO-MORE-AUSHPO-DATA  TO TRUE                 21230004
212400            WHEN SQLCODE = -904                                   21240004
212500            WHEN SQLCODE = -913                                   21250004
212600              CONTINUE                                            21260004
212700           END-EVALUATE                                           21270004
212800         END-PERFORM.                                             21280004
212900***************************************************************** 21290004
213000     PERFORM DS002-SQL-ABEND-FETCH.                               21300004
213100***************************************************************** 21310004
213200 EJECT                                                            21320004
213300***************************************************************** 21330004
213400*     FETCH AUVHCL DATA                                           21340004
213500***************************************************************** 21350004
213600*                                                                 21360004
213700 R100-FETCH-AUVHCL.                                               21370004
213800*                                                                 21380004
213900     MOVE  'TAUVHCL'  TO DS009-PROCESS-TABLE.                     21390004
214000     PERFORM WITH TEST AFTER                                      21400004
214100        VARYING DS009-RETRY-COUNTER FROM 1 BY 1                   21410004
214200        UNTIL   DS009-RETRY-COUNTER > 3 OR                        21420004
214300                SQLCODE = ZERO OR                                 21430004
214400                SQLCODE = +100                                    21440004
214500        EXEC SQL                                                  21450004
214600            FETCH AUVHCL-CSR                                      21460004
214700            INTO                                                  21470004
214800                   :WS-AUVHCL-OWNER-SCAC-ID                       21480004
214900                  ,:WS-AUVHCL-VEH-NBR                             21490004
215000                  ,:WS-AUVHCL-CRT-SRC-CDE                         21500004
215100                  ,:WS-AUVHCL-LAST-UPD-DTE                        21510004
215200                  ,:WS-AUVHCL-LAST-UPD-TME                        21520004
215300                  ,:WS-AUVHCL-LAST-UPD-UID                        21530004
215400                  ,:WS-AUVHCL-USAGE-CDE                           21540004
215500                  ,:WS-AUVHCL-VEH-TYP-CDE                         21550004
215600                  ,:WS-AUVHCL-CURR-STATUS-CDE                     21560004
215700                  ,:WS-AUVHCL-CURR-STATUS-DTE                     21570004
215800                  ,:WS-AUVHCL-CURR-STATUS-TME                     21580004
215900                  ,:WS-AUVHCL-CURR-OPER-UNT-ID                    21590004
216000                  ,:WS-AUVHCL-CURR-FCLTY-ID                       21600004
216100                  ,:WS-AUVHCL-CURR-FAC-AREA-ID                    21610004
216200                  ,:WS-AUVHCL-CURR-LOC-DTE                        21620004
216300                  ,:WS-AUVHCL-CURR-LOC-TME                        21630004
216400                  ,:WS-AUVHCL-CURR-TRIP-ID                        21640004
216500                   :WS-AUVHCL-CURR-TRIP-ID-NN                     21650004
216600                  ,:WS-AUVHCL-VEH-SIZE-CDE                        21660004
216700        END-EXEC                                                  21670004
216800                                                                  21680004
216900        EVALUATE TRUE                                             21690004
217000            WHEN SQLCODE = ZERO OR -305                           21700004
217100                 MOVE LENGTH OF WS-AUVHCL TO DS009-TBLE-DATA-SIZE 21710004
217200                 COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE 21720004
217300                                        + DS009X-RECORD-FILLER    21730004
217400                 MOVE 11     TO TBLE-ORDER                        21740004
217500                 MOVE 10     TO TBLE-VERSION                      21750004
217600                 MOVE DS009-TBLE-DATA-SIZE TO TBLE-DATA-SIZE      21760004
217700                 MOVE 'TAUVHCL'            TO TBLE-NAME           21770004
217800                 MOVE WS-AUVHCL            TO TBLE-DATA-ITEM      21780004
217900                 INITIALIZE DS009-PKYS                            21790004
218000                 PERFORM DS002-PROCESS-KEYS                       21800004
218100                 MOVE WS-AUVHCL-KEYS      TO DS009-PKYS           21810004
218200                 MOVE DS009-PKYS          TO TBLE-KEYS            21820004
218300*                WRITE TBLE-RECORD                                21830004
218400                 PERFORM 8000-WRITE-UNLOAD                        21840004
218500                                                                  21850004
218600            WHEN SQLCODE = +100                                   21860004
218700                 SET NO-MORE-AUVHCL-DATA  TO TRUE                 21870004
218800            WHEN SQLCODE = -904                                   21880004
218900            WHEN SQLCODE = -913                                   21890004
219000              CONTINUE                                            21900004
219100           END-EVALUATE                                           21910004
219200         END-PERFORM.                                             21920004
219300***************************************************************** 21930004
219400     PERFORM DS002-SQL-ABEND-FETCH.                               21940004
219500***************************************************************** 21950004
219600 EJECT                                                            21960004
219700***************************************************************** 21970004
219800*     FETCH DISTHD DATA                                           21980004
219900***************************************************************** 21990004
220000*                                                                 22000004
220100 R100-FETCH-DISTHD.                                               22010004
220200*                                                                 22020004
220300     MOVE  'TDISTHD'  TO DS009-PROCESS-TABLE.                     22030004
220400     PERFORM WITH TEST AFTER                                      22040004
220500        VARYING DS009-RETRY-COUNTER FROM 1 BY 1                   22050004
220600        UNTIL   DS009-RETRY-COUNTER > 3 OR                        22060004
220700                SQLCODE = ZERO OR                                 22070004
220800                SQLCODE = +100                                    22080004
220900        EXEC SQL                                                  22090004
221000            FETCH DISTHD-CSR                                      22100004
221100            INTO                                                  22110004
221200                 :WS-DISTHD                                       22120004
221300        END-EXEC                                                  22130004
221400                                                                  22140004
221500        EVALUATE TRUE                                             22150004
221600            WHEN SQLCODE = ZERO OR -305                           22160004
221700                 MOVE LENGTH OF WS-DISTHD TO DS009-TBLE-DATA-SIZE 22170004
221800                 COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE 22180004
221900                                        + DS009X-RECORD-FILLER    22190004
222000                 MOVE 10     TO TBLE-ORDER                        22200004
222100                 MOVE 05     TO TBLE-VERSION                      22210004
222200                 MOVE DS009-TBLE-DATA-SIZE TO TBLE-DATA-SIZE      22220004
222300                 MOVE 'TDISTHD'            TO TBLE-NAME           22230004
222400                 MOVE WS-DISTHD            TO TBLE-DATA-ITEM      22240004
222500                 INITIALIZE DS009-PKYS                            22250004
222600                 PERFORM DS002-PROCESS-KEYS                       22260004
222700                 MOVE WS-DISTHD-KEYS      TO DS009-PKYS           22270004
222800                 MOVE DS009-PKYS          TO TBLE-KEYS            22280004
222900*                WRITE TBLE-RECORD                                22290004
223000                 PERFORM 8000-WRITE-UNLOAD                        22300004
223100                                                                  22310004
223200            WHEN SQLCODE = +100                                   22320004
223300                 SET NO-MORE-DISTHD-DATA  TO TRUE                 22330004
223400            WHEN SQLCODE = -904                                   22340004
223500            WHEN SQLCODE = -913                                   22350004
223600              CONTINUE                                            22360004
223700           END-EVALUATE                                           22370004
223800         END-PERFORM.                                             22380004
223900***************************************************************** 22390004
224000     PERFORM DS002-SQL-ABEND-FETCH.                               22400004
224100***************************************************************** 22410004
224200 EJECT                                                            22420004
224300***************************************************************** 22430004
224400*     FETCH DISTDT DATA                                           22440004
224500***************************************************************** 22450004
224600*                                                                 22460004
224700 R100-FETCH-DISTDT.                                               22470004
224800*                                                                 22480004
224900     MOVE  'TDISTDT'  TO DS009-PROCESS-TABLE.                     22490004
225000     PERFORM WITH TEST AFTER                                      22500004
225100        VARYING DS009-RETRY-COUNTER FROM 1 BY 1                   22510004
225200        UNTIL   DS009-RETRY-COUNTER > 3 OR                        22520004
225300                SQLCODE = ZERO OR                                 22530004
225400                SQLCODE = +100                                    22540004
225500        EXEC SQL                                                  22550004
225600            FETCH DISTDT-CSR                                      22560004
225700            INTO                                                  22570004
225800                 :WS-DISTDT                                       22580004
225900        END-EXEC                                                  22590004
226000                                                                  22600004
226100        EVALUATE TRUE                                             22610004
226200            WHEN SQLCODE = ZERO OR -305                           22620004
226300                 MOVE LENGTH OF WS-DISTDT TO DS009-TBLE-DATA-SIZE 22630004
226400                 COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE 22640004
226500                                        + DS009X-RECORD-FILLER    22650004
226600                 MOVE 10     TO TBLE-ORDER                        22660004
226700                 MOVE 06     TO TBLE-VERSION                      22670004
226800                 MOVE DS009-TBLE-DATA-SIZE TO TBLE-DATA-SIZE      22680004
226900                 MOVE 'TDISTDT'            TO TBLE-NAME           22690004
227000                 MOVE WS-DISTDT            TO TBLE-DATA-ITEM      22700004
227100                 INITIALIZE DS009-PKYS                            22710004
227200                 PERFORM DS002-PROCESS-KEYS                       22720004
227300                 MOVE WS-DISTDT-KEYS      TO DS009-PKYS           22730004
227400                 MOVE DS009-PKYS          TO TBLE-KEYS            22740004
227500*                WRITE TBLE-RECORD                                22750004
227600                 PERFORM 8000-WRITE-UNLOAD                        22760004
227700                                                                  22770004
227800            WHEN SQLCODE = +100                                   22780004
227900                 SET NO-MORE-DISTDT-DATA  TO TRUE                 22790004
228000            WHEN SQLCODE = -904                                   22800004
228100            WHEN SQLCODE = -913                                   22810004
228200              CONTINUE                                            22820004
228300           END-EVALUATE                                           22830004
228400         END-PERFORM.                                             22840004
228500***************************************************************** 22850004
228600     PERFORM DS002-SQL-ABEND-FETCH.                               22860004
228700***************************************************************** 22870004
228800 EJECT                                                            22880004
228900***************************************************************** 22890004
229000*     FETCH WRKORD DATA                                           22900004
229100***************************************************************** 22910004
229200*                                                                 22920004
229300 R100-FETCH-WRKORD.                                               22930004
229400*                                                                 22940004
229500     MOVE  'TWRKORD'  TO DS009-PROCESS-TABLE.                     22950004
229600     PERFORM WITH TEST AFTER                                      22960004
229700        VARYING DS009-RETRY-COUNTER FROM 1 BY 1                   22970004
229800        UNTIL   DS009-RETRY-COUNTER > 3 OR                        22980004
229900                SQLCODE = ZERO OR                                 22990004
230000                SQLCODE = +100                                    23000004
230100        EXEC SQL                                                  23010004
230200            FETCH WRKORD-CSR                                      23020004
230300            INTO                                                  23030004
230400                 :WS-WRKORD                                       23040004
230500        END-EXEC                                                  23050004
230600                                                                  23060004
230700        EVALUATE TRUE                                             23070004
230800            WHEN SQLCODE = ZERO OR -305                           23080004
230900                 MOVE LENGTH OF WS-WRKORD TO DS009-TBLE-DATA-SIZE 23090004
231000                 COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE 23100004
231100                                        + DS009X-RECORD-FILLER    23110004
231200                 MOVE 10     TO TBLE-ORDER                        23120004
231300                 MOVE 07     TO TBLE-VERSION                      23130004
231400                 MOVE DS009-TBLE-DATA-SIZE TO TBLE-DATA-SIZE      23140004
231500                 MOVE 'TWRKORD'            TO TBLE-NAME           23150004
231600                 MOVE WS-WRKORD            TO TBLE-DATA-ITEM      23160004
231700                 INITIALIZE DS009-PKYS                            23170004
231800                 PERFORM DS002-PROCESS-KEYS                       23180004
231900                 MOVE WS-WRKORD-KEYS      TO DS009-PKYS           23190004
232000                 MOVE DS009-PKYS          TO TBLE-KEYS            23200004
232100*                WRITE TBLE-RECORD                                23210004
232200                 PERFORM 8000-WRITE-UNLOAD                        23220004
232300                                                                  23230004
232400            WHEN SQLCODE = +100                                   23240004
232500                 SET NO-MORE-WRKORD-DATA  TO TRUE                 23250004
232600            WHEN SQLCODE = -904                                   23260004
232700            WHEN SQLCODE = -913                                   23270004
232800              CONTINUE                                            23280004
232900           END-EVALUATE                                           23290004
233000         END-PERFORM.                                             23300004
233100***************************************************************** 23310004
233200     PERFORM DS002-SQL-ABEND-FETCH.                               23320004
233300***************************************************************** 23330004
233400 EJECT                                                            23340004
233500***************************************************************** 23350004
233600*     FETCH WKORIN DATA                                           23360004
233700***************************************************************** 23370004
233800*                                                                 23380004
233900 R100-FETCH-WKORIN.                                               23390004
234000*                                                                 23400004
234100     MOVE  'TWKORIN'  TO DS009-PROCESS-TABLE.                     23410004
234200     PERFORM WITH TEST AFTER                                      23420004
234300        VARYING DS009-RETRY-COUNTER FROM 1 BY 1                   23430004
234400        UNTIL   DS009-RETRY-COUNTER > 3 OR                        23440004
234500                SQLCODE = ZERO OR                                 23450004
234600                SQLCODE = +100                                    23460004
234700        EXEC SQL                                                  23470004
234800            FETCH WKORIN-CSR                                      23480004
234900            INTO                                                  23490004
235000                 :WS-WKORIN                                       23500004
235100        END-EXEC                                                  23510004
235200                                                                  23520004
235300        EVALUATE TRUE                                             23530004
235400            WHEN SQLCODE = ZERO OR -305                           23540004
235500                 MOVE LENGTH OF WS-WKORIN TO DS009-TBLE-DATA-SIZE 23550004
235600                 COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE 23560004
235700                                        + DS009X-RECORD-FILLER    23570004
235800                 MOVE 10     TO TBLE-ORDER                        23580004
235900                 MOVE 08     TO TBLE-VERSION                      23590004
236000                 MOVE DS009-TBLE-DATA-SIZE TO TBLE-DATA-SIZE      23600004
236100                 MOVE 'TWKORIN'            TO TBLE-NAME           23610004
236200                 MOVE WS-WKORIN            TO TBLE-DATA-ITEM      23620004
236300                 INITIALIZE DS009-PKYS                            23630004
236400                 PERFORM DS002-PROCESS-KEYS                       23640004
236500                 MOVE WS-WKORIN-KEYS      TO DS009-PKYS           23650004
236600                 MOVE DS009-PKYS          TO TBLE-KEYS            23660004
236700*                WRITE TBLE-RECORD                                23670004
236800                 PERFORM 8000-WRITE-UNLOAD                        23680004
236900                                                                  23690004
237000            WHEN SQLCODE = +100                                   23700004
237100                 SET NO-MORE-WKORIN-DATA  TO TRUE                 23710004
237200            WHEN SQLCODE = -904                                   23720004
237300            WHEN SQLCODE = -913                                   23730004
237400              CONTINUE                                            23740004
237500           END-EVALUATE                                           23750004
237600         END-PERFORM.                                             23760004
237700***************************************************************** 23770004
237800     PERFORM DS002-SQL-ABEND-FETCH.                               23780004
237900***************************************************************** 23790004
238000 EJECT                                                            23800004
238100***************************************************************** 23810004
238200*     FETCH SHPSUM DATA                                           23820004
238300***************************************************************** 23830004
238400*                                                                 23840004
238500 R100-FETCH-SHPSUM.                                               23850004
238600*                                                                 23860004
238700     MOVE  'TSHPSUM'  TO DS009-PROCESS-TABLE.                     23870004
238800     PERFORM WITH TEST AFTER                                      23880004
238900        VARYING DS009-RETRY-COUNTER FROM 1 BY 1                   23890004
239000        UNTIL   DS009-RETRY-COUNTER > 3 OR                        23900004
239100                SQLCODE = ZERO OR                                 23910004
239200                SQLCODE = +100                                    23920004
239300        EXEC SQL                                                  23930004
239400            FETCH SHPSUM-CSR                                      23940004
239500            INTO                                                  23950004
239600                 :WS-SHPSUM                                       23960004
239700        END-EXEC                                                  23970004
239800                                                                  23980004
239900        EVALUATE TRUE                                             23990004
240000            WHEN SQLCODE = ZERO OR -305                           24000004
240100                 MOVE LENGTH OF WS-SHPSUM TO DS009-TBLE-DATA-SIZE 24010004
240200                 COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE 24020004
240300                                        + DS009X-RECORD-FILLER    24030004
240400                 MOVE 10     TO TBLE-ORDER                        24040004
240500                 MOVE 09     TO TBLE-VERSION                      24050004
240600                 MOVE DS009-TBLE-DATA-SIZE TO TBLE-DATA-SIZE      24060004
240700                 MOVE 'TSHPSUM'            TO TBLE-NAME           24070004
240800                 MOVE WS-SHPSUM            TO TBLE-DATA-ITEM      24080004
240900                 INITIALIZE DS009-PKYS                            24090004
241000                 PERFORM DS002-PROCESS-KEYS                       24100004
241100                 MOVE WS-SHPSUM-KEYS      TO DS009-PKYS           24110004
241200                 MOVE DS009-PKYS          TO TBLE-KEYS            24120004
241300*                WRITE TBLE-RECORD                                24130004
241400                 PERFORM 8000-WRITE-UNLOAD                        24140004
241500                                                                  24150004
241600            WHEN SQLCODE = +100                                   24160004
241700                 SET NO-MORE-SHPSUM-DATA  TO TRUE                 24170004
241800            WHEN SQLCODE = -904                                   24180004
241900            WHEN SQLCODE = -913                                   24190004
242000              CONTINUE                                            24200004
242100           END-EVALUATE                                           24210004
242200         END-PERFORM.                                             24220004
242300***************************************************************** 24230004
242400     PERFORM DS002-SQL-ABEND-FETCH.                               24240004
242500***************************************************************** 24250004
242600 EJECT                                                            24260004
242700***************************************************************** 24270004
242800*     FETCH LBVRDA DATA                                           24280004
242900***************************************************************** 24290004
243000*                                                                 24300004
243100 R100-FETCH-LBVRDA.                                               24310004
243200*                                                                 24320004
243300     MOVE  'TLBVRDA'  TO DS009-PROCESS-TABLE.                     24330004
243400     PERFORM WITH TEST AFTER                                      24340004
243500        VARYING DS009-RETRY-COUNTER FROM 1 BY 1                   24350004
243600        UNTIL   DS009-RETRY-COUNTER > 3 OR                        24360004
243700                SQLCODE = ZERO OR                                 24370004
243800                SQLCODE = +100                                    24380004
243900        EXEC SQL                                                  24390004
244000            FETCH LBVRDA-CSR                                      24400004
244100            INTO                                                  24410004
244200                :WS-LBVRDA-PO-NBR                                 24420004
244300               ,:WS-LBVRDA-RCVR-SEQ-NBR                           24430004
244400               ,:WS-LBVRDA-PO-LNE-NBR                             24440004
244500               ,:WS-LBVRDA-PREPK-ID                               24450004
244600               ,:WS-LBVRDA-OTPK-UNT-QTY                           24460004
244700               ,:WS-LBVRDA-LBL-ASG-IND                            24470004
244800               ,:WS-LBVRDA-LBL-TYP-CDE                            24480004
244900               ,:WS-LBVRDA-LBL-ASG-SEQ-NBR                        24490004
245000               ,:WS-LBVRDA-PRNT-CART-SEQ-ID                       24500004
245100               ,:WS-LBVRDA-CART-LBL-TYP-CDE                       24510004
245200               ,:WS-LBVRDA-PREPK-PRCG-LNE-NBR                     24520004
245300               ,:WS-LBVRDA-INPK-UNT-QTY                           24530004
245400               ,:WS-LBVRDA-PREPK-RATO-QTY                         24540004
245500               ,:WS-LBVRDA-PREPK-UNT-QTY                          24550004
245600               ,:WS-LBVRDA-DEST-OPER-UNT-ID                       24560004
245700               ,:WS-LBVRDA-CSE-PK-QTY                             24570004
245800               ,:WS-LBVRDA-ODD-CART-IND                           24580004
245900               ,:WS-LBVRDA-INPK-CNVYB-IND                         24590004
246000               ,:WS-LBVRDA-LBL-TYP-LBL-SEQ-ID                     24600004
246100               ,:WS-LBVRDA-LBL-TYP-TOT-QTY                        24610004
246200               ,:WS-LBVRDA-BRCDE-NBR                              24620004
246300               ,:WS-LBVRDA-STR-ZN-ID                              24630004
246400               ,:WS-LBVRDA-MODU-DESC                              24640004
246500               ,:WS-LBVRDA-ITM-NBR                                24650004
246600               ,:WS-LBVRDA-DEPT-DESC                              24660004
246700               ,:WS-LBVRDA-MAJ-CL-DESC                            24670004
246800               ,:WS-LBVRDA-SEASET-NM                              24680004
246900               ,:WS-LBVRDA-FIXT-ID                                24690004
247000               ,:WS-LBVRDA-STRG-AREA-CDE                          24700004
247100               ,:WS-LBVRDA-RCLM-IND                               24710004
247200*CLP 03/21/2106                                                   24720004
247300               ,:WS-LBVRDA-LBL-MSG-TXT                            24730004
247400        END-EXEC                                                  24740004
247500                                                                  24750004
247600        EVALUATE TRUE                                             24760004
247700            WHEN SQLCODE = ZERO OR -305                           24770004
247800                 MOVE LENGTH OF WS-LBVRDA TO DS009-TBLE-DATA-SIZE 24780004
247900                 COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE 24790004
248000                                        + DS009X-RECORD-FILLER    24800004
248100                 MOVE 10     TO TBLE-ORDER                        24810004
248200                 MOVE 10     TO TBLE-VERSION                      24820004
248300                 MOVE DS009-TBLE-DATA-SIZE TO TBLE-DATA-SIZE      24830004
248400                 MOVE 'TLBVRDA'            TO TBLE-NAME           24840004
248500                 MOVE WS-LBVRDA            TO TBLE-DATA-ITEM      24850004
248600                 INITIALIZE DS009-PKYS                            24860004
248700                 PERFORM DS002-PROCESS-KEYS                       24870004
248800                 MOVE WS-LBVRDA-KEYS      TO DS009-PKYS           24880004
248900                 MOVE DS009-PKYS          TO TBLE-KEYS            24890004
249000*                WRITE TBLE-RECORD                                24900004
249100                 PERFORM 8000-WRITE-UNLOAD                        24910004
249200                                                                  24920004
249300            WHEN SQLCODE = +100                                   24930004
249400                 SET NO-MORE-LBVRDA-DATA  TO TRUE                 24940004
249500            WHEN SQLCODE = -904                                   24950004
249600            WHEN SQLCODE = -913                                   24960004
249700              CONTINUE                                            24970004
249800           END-EVALUATE                                           24980004
249900         END-PERFORM.                                             24990004
250000***************************************************************** 25000004
250100     PERFORM DS002-SQL-ABEND-FETCH.                               25010004
250200***************************************************************** 25020004
250300 EJECT                                                            25030004
250400***************************************************************** 25040004
250500*     FETCH LBPTDA DATA                                           25050004
250600***************************************************************** 25060004
250700*                                                                 25070004
250800 R100-FETCH-LBPTDA.                                               25080004
250900*                                                                 25090004
251000     MOVE  'TLBPTDA'  TO DS009-PROCESS-TABLE.                     25100004
251100     PERFORM WITH TEST AFTER                                      25110004
251200        VARYING DS009-RETRY-COUNTER FROM 1 BY 1                   25120004
251300        UNTIL   DS009-RETRY-COUNTER > 3 OR                        25130004
251400                SQLCODE = ZERO OR                                 25140004
251500                SQLCODE = +100                                    25150004
251600        EXEC SQL                                                  25160004
251700            FETCH LBPTDA-CSR                                      25170004
251800            INTO                                                  25180004
251900                 :WS-LBPTDA                                       25190004
252000        END-EXEC                                                  25200004
252100                                                                  25210004
252200        EVALUATE TRUE                                             25220004
252300            WHEN SQLCODE = ZERO OR -305                           25230004
252400                 MOVE LENGTH OF WS-LBPTDA TO DS009-TBLE-DATA-SIZE 25240004
252500                 COMPUTE DS009-RECORD-SIZE = DS009-TBLE-DATA-SIZE 25250004
252600                                        + DS009X-RECORD-FILLER    25260004
252700                 MOVE 11     TO TBLE-ORDER                        25270004
252800                 MOVE 12     TO TBLE-VERSION                      25280004
252900                 MOVE DS009-TBLE-DATA-SIZE TO TBLE-DATA-SIZE      25290004
253000                 MOVE 'TLBPTDA'            TO TBLE-NAME           25300004
253100                 MOVE WS-LBPTDA            TO TBLE-DATA-ITEM      25310004
253200                 INITIALIZE DS009-PKYS                            25320004
253300                 PERFORM DS002-PROCESS-KEYS                       25330004
253400                 MOVE WS-LBPTDA-KEYS      TO DS009-PKYS           25340004
253500                 MOVE DS009-PKYS          TO TBLE-KEYS            25350004
253600*                WRITE TBLE-RECORD                                25360004
253700                 PERFORM 8000-WRITE-UNLOAD                        25370004
253800                                                                  25380004
253900            WHEN SQLCODE = +100                                   25390004
254000                 SET NO-MORE-LBPTDA-DATA  TO TRUE                 25400004
254100            WHEN SQLCODE = -904                                   25410004
254200            WHEN SQLCODE = -913                                   25420004
254300              CONTINUE                                            25430004
254400           END-EVALUATE                                           25440004
254500         END-PERFORM.                                             25450004
254600***************************************************************** 25460004
254700     PERFORM DS002-SQL-ABEND-FETCH.                               25470004
254800***************************************************************** 25480004
254900 EJECT                                                            25490004
255000***************************************************************** 25500004
255100*     OPEN CURSOR                                                 25510004
255200***************************************************************** 25520004
255300*                                                                 25530004
255400 Y100-OPEN-CURSOR.                                                25540004
255500     PERFORM WITH TEST AFTER                                      25550004
255600             VARYING DS009-RETRY-COUNTER FROM 1 BY 1              25560004
255700             UNTIL   DS009-RETRY-COUNTER > 3 OR                   25570004
255800                     SQLCODE = ZERO                               25580004
255900                                                                  25590004
256000             EVALUATE TRUE                                        25600004
256100             WHEN DS009-PROCESS-TABLE = 'TSHPTPO'                 25610004
256200             EXEC SQL                                             25620004
256300                OPEN SHPTPO-CSR                                   25630004
256400             END-EXEC                                             25640004
256500             WHEN DS009-PROCESS-TABLE = 'TPKITEM'                 25650004
256600             EXEC SQL                                             25660004
256700                OPEN PKITEM-CSR                                   25670004
256800             END-EXEC                                             25680004
256900             WHEN DS009-PROCESS-TABLE = 'TPKSLIP'                 25690004
257000             EXEC SQL                                             25700004
257100                OPEN PKSLIP-CSR                                   25710004
257200             END-EXEC                                             25720004
257300             WHEN DS009-PROCESS-TABLE = 'TRECITM'                 25730004
257400             EXEC SQL                                             25740004
257500                OPEN RECITM-CSR                                   25750004
257600             END-EXEC                                             25760004
257700             WHEN DS009-PROCESS-TABLE = 'TRECEIV'                 25770004
257800             EXEC SQL                                             25780004
257900                OPEN RECEIV-CSR                                   25790004
258000             END-EXEC                                             25800004
258100             WHEN DS009-PROCESS-TABLE = 'TRECDIS'                 25810004
258200             EXEC SQL                                             25820004
258300                OPEN RECDIS-CSR                                   25830004
258400             END-EXEC                                             25840004
258500             WHEN DS009-PROCESS-TABLE = 'TVHTRIP'                 25850004
258600             EXEC SQL                                             25860004
258700                OPEN VHTRIP-CSR                                   25870004
258800             END-EXEC                                             25880004
258900             WHEN DS009-PROCESS-TABLE = 'TTRIPST'                 25890004
259000             EXEC SQL                                             25900004
259100                OPEN TRIPST-CSR                                   25910004
259200             END-EXEC                                             25920004
259300             WHEN DS009-PROCESS-TABLE = 'TSHIPST'                 25930004
259400             EXEC SQL                                             25940004
259500                OPEN SHIPST-CSR                                   25950004
259600             END-EXEC                                             25960004
259700             WHEN DS009-PROCESS-TABLE = 'TSHIPMT'                 25970004
259800             EXEC SQL                                             25980004
259900                OPEN SHIPMT-CSR                                   25990004
260000             END-EXEC                                             26000004
260100             WHEN DS009-PROCESS-TABLE = 'TVEHICL'                 26010004
260200             EXEC SQL                                             26020004
260300                OPEN VEHICL-CSR                                   26030004
260400             END-EXEC                                             26040004
260500             WHEN DS009-PROCESS-TABLE = 'TRECDVS'                 26050004
260600               EXEC SQL                                           26060004
260700                  OPEN  RECDVS-CSR                                26070004
260800               END-EXEC                                           26080004
260900             WHEN DS009-PROCESS-TABLE = 'TAUTRIP'                 26090004
261000               EXEC SQL                                           26100004
261100                  OPEN  AUTRIP-CSR                                26110004
261200               END-EXEC                                           26120004
261300             WHEN DS009-PROCESS-TABLE = 'TAUSHIP'                 26130004
261400               EXEC SQL                                           26140004
261500                  OPEN  AUSHIP-CSR                                26150004
261600               END-EXEC                                           26160004
261700             WHEN DS009-PROCESS-TABLE = 'TAUSHPO'                 26170004
261800               EXEC SQL                                           26180004
261900                  OPEN  AUSHPO-CSR                                26190004
262000               END-EXEC                                           26200004
262100             WHEN DS009-PROCESS-TABLE = 'TAUVHCL'                 26210004
262200               EXEC SQL                                           26220004
262300                  OPEN  AUVHCL-CSR                                26230004
262400               END-EXEC                                           26240004
262500             WHEN DS009-PROCESS-TABLE = 'TDISTHD'                 26250004
262600               EXEC SQL                                           26260004
262700                  OPEN  DISTHD-CSR                                26270004
262800               END-EXEC                                           26280004
262900             WHEN DS009-PROCESS-TABLE = 'TDISTDT'                 26290004
263000               EXEC SQL                                           26300004
263100                  OPEN  DISTDT-CSR                                26310004
263200               END-EXEC                                           26320004
263300             WHEN DS009-PROCESS-TABLE = 'TWRKORD'                 26330004
263400               EXEC SQL                                           26340004
263500                  OPEN  WRKORD-CSR                                26350004
263600               END-EXEC                                           26360004
263700             WHEN DS009-PROCESS-TABLE = 'TWKORIN'                 26370004
263800               EXEC SQL                                           26380004
263900                  OPEN  WKORIN-CSR                                26390004
264000               END-EXEC                                           26400004
264100             WHEN DS009-PROCESS-TABLE = 'TSHPSUM'                 26410004
264200               EXEC SQL                                           26420004
264300                  OPEN  SHPSUM-CSR                                26430004
264400               END-EXEC                                           26440004
264500             WHEN DS009-PROCESS-TABLE = 'TLBVRDA'                 26450004
264600               EXEC SQL                                           26460004
264700                  OPEN  LBVRDA-CSR                                26470004
264800               END-EXEC                                           26480004
264900             WHEN DS009-PROCESS-TABLE = 'TLBPTDA'                 26490004
265000               EXEC SQL                                           26500004
265100                  OPEN  LBPTDA-CSR                                26510004
265200               END-EXEC                                           26520004
265300             END-EVALUATE                                         26530004
265400             EVALUATE TRUE                                        26540004
265500                 WHEN SQLCODE = ZERO                              26550004
265600                 WHEN SQLCODE = -904                              26560004
265700                 WHEN SQLCODE = -913                              26570004
265800                      CONTINUE                                    26580004
265900             END-EVALUATE                                         26590004
266000     END-PERFORM.                                                 26600004
266100***************************************************************** 26610004
266200     PERFORM DS002-SQL-ABEND-OPEN-CSR.                            26620004
266300***************************************************************** 26630004
266400 EJECT                                                            26640004
266500*                                                                 26650004
266600***************************************************************** 26660004
266700*     CLOSE CURSOR                                                26670004
266800***************************************************************** 26680004
266900*                                                                 26690004
267000 Y100-CLOSE-CURSOR.                                               26700004
267100     PERFORM WITH TEST AFTER                                      26710004
267200             VARYING DS009-RETRY-COUNTER FROM 1 BY 1              26720004
267300             UNTIL   DS009-RETRY-COUNTER > 3 OR                   26730004
267400                     SQLCODE = ZERO                               26740004
267500                                                                  26750004
267600             EVALUATE TRUE                                        26760004
267700             WHEN DS009-PROCESS-TABLE = 'TSHPTPO'                 26770004
267800             EXEC SQL                                             26780004
267900                CLOSE SHPTPO-CSR                                  26790004
268000             END-EXEC                                             26800004
268100             WHEN DS009-PROCESS-TABLE = 'TPKITEM'                 26810004
268200             EXEC SQL                                             26820004
268300                CLOSE PKITEM-CSR                                  26830004
268400             END-EXEC                                             26840004
268500             WHEN DS009-PROCESS-TABLE = 'TPKSLIP'                 26850004
268600             EXEC SQL                                             26860004
268700                CLOSE PKSLIP-CSR                                  26870004
268800             END-EXEC                                             26880004
268900             WHEN DS009-PROCESS-TABLE = 'TRECITM'                 26890004
269000             EXEC SQL                                             26900004
269100                CLOSE RECITM-CSR                                  26910004
269200             END-EXEC                                             26920004
269300             WHEN DS009-PROCESS-TABLE = 'TRECEIV'                 26930004
269400             EXEC SQL                                             26940004
269500                CLOSE RECEIV-CSR                                  26950004
269600             END-EXEC                                             26960004
269700             WHEN DS009-PROCESS-TABLE = 'TRECDIS'                 26970004
269800             EXEC SQL                                             26980004
269900                CLOSE RECDIS-CSR                                  26990004
270000             END-EXEC                                             27000004
270100             WHEN DS009-PROCESS-TABLE = 'TVHTRIP'                 27010004
270200             EXEC SQL                                             27020004
270300                CLOSE VHTRIP-CSR                                  27030004
270400             END-EXEC                                             27040004
270500             WHEN DS009-PROCESS-TABLE = 'TTRIPST'                 27050004
270600             EXEC SQL                                             27060004
270700                CLOSE TRIPST-CSR                                  27070004
270800             END-EXEC                                             27080004
270900             WHEN DS009-PROCESS-TABLE = 'TSHIPST'                 27090004
271000             EXEC SQL                                             27100004
271100                CLOSE SHIPST-CSR                                  27110004
271200             END-EXEC                                             27120004
271300             WHEN DS009-PROCESS-TABLE = 'TSHIPMT'                 27130004
271400             EXEC SQL                                             27140004
271500                CLOSE SHIPMT-CSR                                  27150004
271600             END-EXEC                                             27160004
271700             WHEN DS009-PROCESS-TABLE = 'TVEHICL'                 27170004
271800             EXEC SQL                                             27180004
271900                CLOSE VEHICL-CSR                                  27190004
272000             END-EXEC                                             27200004
272100             WHEN DS009-PROCESS-TABLE = 'TRECDVS'                 27210004
272200               EXEC SQL                                           27220004
272300                  CLOSE RECDVS-CSR                                27230004
272400               END-EXEC                                           27240004
272500             WHEN DS009-PROCESS-TABLE = 'TAUTRIP'                 27250004
272600               EXEC SQL                                           27260004
272700                  CLOSE AUTRIP-CSR                                27270004
272800               END-EXEC                                           27280004
272900             WHEN DS009-PROCESS-TABLE = 'TAUSHIP'                 27290004
273000               EXEC SQL                                           27300004
273100                  CLOSE AUSHIP-CSR                                27310004
273200               END-EXEC                                           27320004
273300             WHEN DS009-PROCESS-TABLE = 'TAUSHPO'                 27330004
273400               EXEC SQL                                           27340004
273500                  CLOSE AUSHPO-CSR                                27350004
273600               END-EXEC                                           27360004
273700             WHEN DS009-PROCESS-TABLE = 'TAUVHCL'                 27370004
273800               EXEC SQL                                           27380004
273900                  CLOSE AUVHCL-CSR                                27390004
274000               END-EXEC                                           27400004
274100             WHEN DS009-PROCESS-TABLE = 'TDISTHD'                 27410004
274200               EXEC SQL                                           27420004
274300                  CLOSE DISTHD-CSR                                27430004
274400               END-EXEC                                           27440004
274500             WHEN DS009-PROCESS-TABLE = 'TDISTDT'                 27450004
274600               EXEC SQL                                           27460004
274700                  CLOSE DISTDT-CSR                                27470004
274800               END-EXEC                                           27480004
274900             WHEN DS009-PROCESS-TABLE = 'TWRKORD'                 27490004
275000               EXEC SQL                                           27500004
275100                  CLOSE WRKORD-CSR                                27510004
275200               END-EXEC                                           27520004
275300             WHEN DS009-PROCESS-TABLE = 'TWKORIN'                 27530004
275400               EXEC SQL                                           27540004
275500                  CLOSE WKORIN-CSR                                27550004
275600               END-EXEC                                           27560004
275700             WHEN DS009-PROCESS-TABLE = 'TSHPSUM'                 27570004
275800               EXEC SQL                                           27580004
275900                  CLOSE SHPSUM-CSR                                27590004
276000               END-EXEC                                           27600004
276100             WHEN DS009-PROCESS-TABLE = 'TLBVRDA'                 27610004
276200               EXEC SQL                                           27620004
276300                  CLOSE LBVRDA-CSR                                27630004
276400               END-EXEC                                           27640004
276500             WHEN DS009-PROCESS-TABLE = 'TLBPTDA'                 27650004
276600               EXEC SQL                                           27660004
276700                  CLOSE LBPTDA-CSR                                27670004
276800               END-EXEC                                           27680004
276900             END-EVALUATE                                         27690004
277000                                                                  27700004
277100             EVALUATE TRUE                                        27710004
277200                 WHEN SQLCODE = ZERO                              27720004
277300                 WHEN SQLCODE = +100                              27730004
277400                 WHEN SQLCODE = -904                              27740004
277500                 WHEN SQLCODE = -913                              27750004
277600                      CONTINUE                                    27760004
277700             END-EVALUATE                                         27770004
277800     END-PERFORM.                                                 27780004
277900                                                                  27790004
278000     PERFORM DS002-SQL-ABEND-CLOSE-CSR.                           27800004
278100/                                                                 27810004
278200 8000-WRITE-UNLOAD.                                               27820004
278300                                                                  27830004
278400     SET DS009-SRCH-IDX TO +1.                                    27840004
278500     SEARCH DS009-CNTL-RECORDS                                    27850004
278600             VARYING DS009-SRCH-IDX                               27860004
278700         AT END                                                   27870004
278800             CONTINUE                                             27880004
278900         WHEN CNTL-TABLE (DS009-SRCH-IDX) = DS009-PROCESS-TABLE   27890004
279000             ADD 1 TO DS009-READ-COUNT (DS009-SRCH-IDX)           27900004
279100     END-SEARCH.                                                  27910004
279200                                                                  27920004
279300     WRITE TBLE-RECORD                                            27930004
279400     ADD 1 TO PV-WRITE-COUNT.                                     27940004
279500/                                                                 27950004
279600*    COPY DSPD009.                                                27960004
279700     COPY DSPD002.                                                27970004
