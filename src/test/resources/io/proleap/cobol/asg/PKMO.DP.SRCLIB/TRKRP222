000100******************************************************************00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300******************************************************************00030000
000400                                                                  00040000
000500 PROGRAM-ID.    TRKRP222.                                         00050000
000600 AUTHOR.        DAVE PHELPS                                       00060000
000700 INSTALLATION.  KOHLS.                                            00070000
000800 DATE-WRITTEN   JUNE,1998.                                        00080000
000900 DATE-COMPILED.                                                   00090000
001000                                                                  00100000
001100*----------------------------------------------------------------*00110000
001200*  THIS PROGRAM CREATES AN GOOD REPORT OF DATA THAT WAS           00120000
001300*  LOADED TO THE DB2 TABLES IN TRKUP225.                          00130000
001400*----------------------------------------------------------------*00140000
001500                                                                  00150000
001600******************************************************************00160000
001700 ENVIRONMENT DIVISION.                                            00170000
001800******************************************************************00180000
001900                                                                  00190000
002000 CONFIGURATION SECTION.                                           00200000
002100                                                                  00210000
002200 SOURCE-COMPUTER.        IBM-3090.                                00220000
002300 OBJECT-COMPUTER.        IBM-3090.                                00230000
002400                                                                  00240000
002500 INPUT-OUTPUT SECTION.                                            00250000
002600                                                                  00260000
002700 FILE-CONTROL.                                                    00270000
002800                                                                  00280000
002900     SELECT ERROR-FILE                                            00290000
003000         ASSIGN TO INP01.                                         00300000
003100                                                                  00310000
003200     SELECT ERROR-REPORT-FILE                                     00320000
003300         ASSIGN TO RPT01.                                         00330000
003400                                                                  00340000
003500******************************************************************00350000
003600 DATA DIVISION.                                                   00360000
003700******************************************************************00370000
003800                                                                  00380000
003900 FILE SECTION.                                                    00390000
004000                                                                  00400000
004100 FD  ERROR-FILE                                                   00410000
004200     RECORDING MODE IS F                                          00420000
004300     LABEL RECORDS ARE STANDARD                                   00430000
004400     BLOCK CONTAINS 0 RECORDS.                                    00440000
004500                                                                  00450000
004600 01  ERROR-RECORD                     PIC  X(254).                00460000
004700                                                                  00470000
004800                                                                  00480000
004900 FD  ERROR-REPORT-FILE                                            00490000
005000     RECORDING MODE IS F                                          00500000
005100     LABEL RECORDS ARE STANDARD                                   00510000
005200     BLOCK CONTAINS 0 RECORDS.                                    00520000
005300                                                                  00530000
005400 01  ERROR-REPORT-RECORD              PIC  X(132).                00540000
005500*                                                                 00550000
005600*                                                                 00560000
005700*----------------------------------------------------------------*00570000
005800 WORKING-STORAGE SECTION.                                         00580000
005900*----------------------------------------------------------------*00590000
005901*                                                                 00600000
005902*----------------------------------------------------------------*00610000
005903*   PURCHASE ORDER HEADER TABLE.                                  00620000
005904*----------------------------------------------------------------*00630000
005905                                                                  00640000
005906     EXEC SQL                                                     00650000
005907         INCLUDE TPURCHS                                          00660000
005908     END-EXEC.                                                    00670000
005909                                                                  00680000
005910*----------------------------------------------------------------*00690000
005920*   VENDOR NAME HEADER TABLE.                                     00700000
005930*----------------------------------------------------------------*00710000
005940                                                                  00720000
005950     EXEC SQL                                                     00730000
005960         INCLUDE TENTNME                                          00740000
005970     END-EXEC.                                                    00750000
005971                                                                  00760000
005972*----------------------------------------------------------------*00770000
005973*   POL HEADER TABLE.                                             00780000
005974*----------------------------------------------------------------*00790000
005975                                                                  00800000
005976     EXEC SQL                                                     00810000
005977         INCLUDE TIMFOB                                           00820000
005978     END-EXEC.                                                    00830000
005979                                                                  00840000
006100*----------------------------------------------------------------*00850000
006200***  WORK FIELDS FOR THE ERROR REPORT                             00860000
006400*----------------------------------------------------------------*00870000
006500     COPY TRRD221.                                                00880004
006600*                                                                 00890000
006800*----------------------------------------------------------------*00900000
006900***  STANDARD REPORT HEADER FOR 132 COLUMN REPORT                 00910000
007000*----------------------------------------------------------------*00920000
007100     COPY DPWS132O.                                               00930003
007200*                                                                 00940000
007400 01  HL1-HEADING-LINE-1.                                          00950000
007815         10 FILLER                   PIC  X(02)      VALUE SPACES.00960000
007816     05  HL1-TRANS-DATE.                                          00970000
007817         10 HL-TRANS-MM              PIC  X(02)      VALUE SPACE. 00980000
007818         10 FILLER                   PIC  X(01)      VALUE '/'.   00990000
007819         10 HL-TRANS-DD              PIC  X(02)      VALUE SPACE. 01000000
007820         10 FILLER                   PIC  X(01)      VALUE '/'.   01010000
007821         10 HL-TRANS-YY              PIC  X(02)      VALUE SPACE. 01020000
007822     05  FILLER                      PIC  X(02)      VALUE SPACE. 01030000
007823     05  HL1-TRANS-TIME.                                          01040000
007830         10 HL-TRANS-TIME-HH         PIC  X(02)      VALUE SPACE. 01050000
007840         10 FILLER                   PIC  X(01)      VALUE ':'.   01060000
007841         10 HL-TRANS-TIME-MM         PIC  X(02)      VALUE SPACE. 01070000
007842     05  FILLER                      PIC  X(01)      VALUE SPACE. 01080000
007843     05  FILLER                      PIC  X(13)      VALUE        01090000
007844         'TRANSMIT DATE'.                                         01100000
007845     05  FILLER                      PIC  X(16)      VALUE SPACE. 01110000
007846     05  FILLER                      PIC  X(38)      VALUE        01120000
007847         '    IMPORT PURCHASE ORDER TRACKING    '.                01130000
007848     05  FILLER                      PIC  X(16)      VALUE SPACE. 01140000
007849     05  FILLER                      PIC  X(07)      VALUE        01150000
007850         'FILE ID'.                                               01160000
007851     05  FILLER                      PIC  X(02)      VALUE SPACE. 01170000
007852     05  HL1-FILE-ID                 PIC  X(09)      VALUE SPACE. 01180000
007853     05  FILLER                      PIC  X(01)      VALUE SPACE. 01190000
007854*                                                                 01200000
007855 01  HL1-HEADING-LINE-2.                                          01210000
007856         10 FILLER                   PIC  X(02)      VALUE SPACES.01220000
007857     05  HL1-LOAD-DATE.                                           01230000
007858         10 HL-LOAD-MM               PIC  X(02)      VALUE SPACE. 01240000
007859         10 FILLER                   PIC  X(01)      VALUE '/'.   01250000
007860         10 HL-LOAD-DD               PIC  X(02)      VALUE SPACE. 01260000
007861         10 FILLER                   PIC  X(01)      VALUE '/'.   01270000
007862         10 HL-LOAD-YY               PIC  X(02)      VALUE SPACE. 01280000
007863     05  FILLER                      PIC  X(02)      VALUE SPACE. 01290000
007864     05  HL1-LOAD-TIME.                                           01300000
007865         10 HL-LOAD-TIME-HH          PIC  X(02)      VALUE SPACE. 01310000
007866         10 FILLER                   PIC  X(01)      VALUE ':'.   01320000
007867         10 HL-LOAD-TIME-MM          PIC  X(02)      VALUE SPACE. 01330000
007868     05  FILLER                      PIC  X(01)      VALUE SPACE. 01340000
007869     05  FILLER                      PIC  X(13)      VALUE        01350000
007870         'LOAD DATE    '.                                         01360000
007871     05  FILLER                      PIC  X(16)      VALUE SPACE. 01370000
007872     05  FILLER                      PIC  X(38)      VALUE        01380000
007873         '     RECEIVING LOAD DETAIL REPORT     '.                01390000
007874     05  FILLER                      PIC  X(16)      VALUE SPACE. 01400000
007875     05  HL1-EXPEDITOR               PIC  X(30)      VALUE SPACES.01410000
007876*                                                                 01420000
007877 01  HL2-HEADING-LINE-1.                                          01430000
007878     05  FILLER                      PIC  X(31)      VALUE SPACE. 01440000
007879     05  HL2-RECD-1                  PIC  X(04)      VALUE        01450000
007880         'RCVD'.                                                  01460000
007881     05  FILLER                      PIC  X(04)      VALUE SPACE. 01470000
007882     05  FILLER                      PIC  X(04)      VALUE        01480000
007883         'SHPD'.                                                  01490000
007884     05  FILLER                      PIC  X(28)      VALUE SPACE. 01500000
007885*                                                                 01510000
007886 01  HL2-HEADING-LINE-2.                                          01520000
007887     05  FILLER                      PIC  X(03)      VALUE SPACE. 01530000
007888     05  HL2-RECD-2                  PIC  X(02)      VALUE        01540000
007889         'PO'.                                                    01550000
007890     05  FILLER                      PIC  X(06)      VALUE SPACE. 01560000
007891     05  HL2-TRN                     PIC  X(09)      VALUE        01570000
007892         'REFERENCE'.                                             01580000
007893     05  FILLER                      PIC  X(08)      VALUE SPACE. 01590000
007894     05  FILLER                      PIC  X(08)      VALUE        01600000
007895         'DELY DTE'.                                              01610000
007896     05  FILLER                      PIC  X(03)      VALUE SPACE. 01620000
007897     05  FILLER                      PIC  X(04)      VALUE        01630000
007898         'FROM'.                                                  01640000
007899     05  FILLER                      PIC  X(10)      VALUE SPACE. 01650000
007900     05  FILLER                      PIC  X(11)      VALUE        01660000
007901         'VENDOR NAME'.                                           01670000
007902     05  FILLER                      PIC  X(33)      VALUE SPACE. 01680000
007980*                                                                 01690000
007981 01  HL3-HEADING-LINE-1.                                          01700000
007982     05  HL3-TYPE-1-LNE-1            PIC  X(04).                  01710000
007983     05  FILLER                      PIC  X(04)      VALUE SPACE. 01720000
007984     05  HL3-TYPE-2-LNE-1            PIC  X(04).                  01730000
008300     05  FILLER                      PIC  X(49)      VALUE SPACE. 01740000
008400     05  FILLER                      PIC  X(06)      VALUE        01750000
008401         'CONSOL'.                                                01760000
008402*                                                                 01770000
008403 01  HL3-HEADING-LINE-2.                                          01780000
008404     05  HL3-TYPE-1-LNE-2            PIC  X(04).                  01790000
008405     05  FILLER                      PIC  X(04)      VALUE SPACE. 01800000
008406     05  HL3-TYPE-2-LNE-2            PIC  X(04).                  01810000
008407     05  FILLER                      PIC  X(02)      VALUE SPACE. 01820000
008408     05  FILLER                      PIC  X(05)      VALUE        01830000
008409         'CNTRY'.                                                 01840000
008422     05  FILLER                      PIC  X(17)      VALUE SPACE. 01850000
008423     05  FILLER                      PIC  X(12)      VALUE        01860000
008424         'FACTORY NAME'.                                          01870000
008425     05  FILLER                      PIC  X(14)      VALUE SPACE. 01880000
008426     05  FILLER                      PIC  X(06)      VALUE        01890000
008427         'SCAC'.                                                  01900000
008428     05  FILLER                      PIC  X(02)      VALUE SPACE. 01910000
008429     05  FILLER                      PIC  X(07)      VALUE        01920000
008430         'CARTONS'.                                               01930000
008410     05  FILLER                      PIC  X(07)      VALUE SPACE. 01940000
008420     05  FILLER                      PIC  X(05)      VALUE        01950000
008421         'UNITS'.                                                 01960000
008431     05  FILLER                      PIC  X(09)      VALUE SPACE. 01970000
008432     05  FILLER                      PIC  X(04)      VALUE        01980000
008433         'CBMS'.                                                  01990000
008434     05  FILLER                      PIC  X(06)      VALUE SPACE. 02000000
008435     05  FILLER                      PIC  X(05)      VALUE        02010000
008436         'KGRMS'.                                                 02020000
008437     05  FILLER                      PIC  X(70)      VALUE SPACE. 02030000
008438*                                                                 02040000
008439 01  HL4-HEADING-LINE-1.                                          02050000
008440     05  FILLER                      PIC  X(09)      VALUE SPACE. 02060000
008441     05  HL4-TYPE-1-LNE-1            PIC  X(04).                  02070000
008442     05  FILLER                      PIC  X(04)      VALUE SPACE. 02080000
008443     05  HL4-TYPE-2-LNE-1            PIC  X(03).                  02090000
008444     05  FILLER                      PIC  X(71)      VALUE SPACE. 02100000
008445*                                                                 02110000
008446 01  HL4-HEADING-LINE-2.                                          02120000
008447     05  FILLER                      PIC  X(09)      VALUE SPACE. 02130000
008448     05  HL4-TYPE-1-LNE-2            PIC  X(04).                  02140000
008449     05  FILLER                      PIC  X(04)      VALUE SPACE. 02150000
008450     05  HL4-TYPE-2-LNE-2            PIC  X(04).                  02160000
008451     05  FILLER                      PIC  X(07)      VALUE SPACE. 02170000
008452     05  FILLER                      PIC  X(12)      VALUE        02180000
008453         'VENDOR STYLE'.                                          02190000
008454     05  FILLER                      PIC  X(30)      VALUE SPACE. 02200000
008455     05  FILLER                      PIC  X(07)      VALUE        02210000
008456         'CARTONS'.                                               02220000
008457     05  FILLER                      PIC  X(07)      VALUE SPACE. 02230000
008458     05  FILLER                      PIC  X(05)      VALUE        02240000
008459         'UNITS'.                                                 02250000
008460     05  FILLER                      PIC  X(09)      VALUE SPACE. 02260000
008470     05  FILLER                      PIC  X(04)      VALUE        02270000
008471         'CBMS'.                                                  02280000
008472     05  FILLER                      PIC  X(06)      VALUE SPACE. 02290000
008473     05  FILLER                      PIC  X(05)      VALUE        02300000
008474         'KGRMS'.                                                 02310000
008475     05  FILLER                      PIC  X(70)      VALUE SPACE. 02320000
008476*                                                                 02330000
008477 01  HL5-HEADING-LINE-1.                                          02340000
008478     05  FILLER                      PIC  X(17)      VALUE SPACE. 02350000
008479     05  HL5-RECD                    PIC  X(04).                  02360000
008480     05  FILLER                      PIC  X(04)      VALUE SPACE. 02370000
008481     05  HL5-TRN                     PIC  X(03).                  02380000
008482     05  FILLER                      PIC  X(02)      VALUE SPACE. 02390000
008483*                                                                 02400000
008484 01  HL5-HEADING-LINE-2.                                          02410000
008485     05  FILLER                      PIC  X(17)      VALUE SPACE. 02420000
008486     05  HL5-TYPE-1                  PIC  X(04).                  02430000
008487     05  FILLER                      PIC  X(04)      VALUE SPACE. 02440000
008488     05  HL5-TYPE-2                  PIC  X(04).                  02450000
008489     05  FILLER                      PIC  X(07)      VALUE SPACE. 02460000
008490     05  FILLER                      PIC  X(12)      VALUE        02470000
008491         'VENDOR STYLE'.                                          02480000
008492     05  FILLER                      PIC  X(10)      VALUE SPACE. 02490000
008493     05  FILLER                      PIC  X(03)      VALUE        02500000
008494         'UPC'.                                                   02510000
008495     05  FILLER                      PIC  X(09)      VALUE SPACE. 02520000
008496     05  FILLER                      PIC  X(07)      VALUE        02530000
008497         'CARTONS'.                                               02540000
008498     05  FILLER                      PIC  X(07)      VALUE SPACE. 02550000
008499     05  FILLER                      PIC  X(05)      VALUE        02560000
008500         'UNITS'.                                                 02570000
008501     05  FILLER                      PIC  X(09)      VALUE SPACE. 02580000
008502     05  FILLER                      PIC  X(04)      VALUE        02590000
008503         'CBMS'.                                                  02600000
008504     05  FILLER                      PIC  X(06)      VALUE SPACE. 02610000
008505     05  FILLER                      PIC  X(05)      VALUE        02620000
008506         'KGRMS'.                                                 02630000
008508*                                                                 02640000
008509 01  HL6-HEADING-LINE-1.                                          02650000
008510     05  HL6-RECD                    PIC  X(04)      VALUE        02660000
008511         'RECD'.                                                  02670000
008512     05  FILLER                      PIC  X(04)      VALUE SPACE. 02680000
008513     05  HL6-TRN                     PIC  X(04)      VALUE        02690000
008514         'TRN '.                                                  02700000
008515     05  FILLER                      PIC  X(02)      VALUE SPACE. 02710000
008516     05  HL6-TYPE-3                  PIC  X(03)      VALUE        02720000
008517         'VSL'.                                                   02730000
008518     05  FILLER                      PIC  X(13)      VALUE SPACE. 02740000
008519     05  FILLER                      PIC  X(04)      VALUE        02750000
008520         'CARR'.                                                  02760000
008461     05  FILLER                      PIC  X(74)      VALUE SPACE. 02770000
008482     05  FILLER                      PIC  X(07)      VALUE        02780000
008483         'EST LBD'.                                               02790000
008461     05  FILLER                      PIC  X(10)      VALUE SPACE. 02800000
008482     05  FILLER                      PIC  X(03)      VALUE        02810000
008483         'EST'.                                                   02820000
008522*                                                                 02830000
008523 01  HL6-HEADING-LINE-2-A.                                        02840000
008524     05  HL6-TYPE-1                  PIC  X(04)      VALUE        02850000
008525         'TYPE'.                                                  02860000
008526     05  FILLER                      PIC  X(04)      VALUE SPACE. 02870000
008527     05  HL6-TYPE-2                  PIC  X(04)      VALUE        02880000
008528         'TYPE'.                                                  02890000
008529     05  FILLER                      PIC  X(01)      VALUE SPACE. 02900000
008530     05  HL6-A-TYPE-3                PIC  X(04)      VALUE        02910000
008531         'TYPE'.                                                  02920000
008532     05  FILLER                      PIC  X(02)      VALUE SPACE. 02930000
008533     05  FILLER                      PIC  X(10)      VALUE        02940000
008534         'VOYAGE NBR'.                                            02950000
008481     05  FILLER                      PIC  X(01)      VALUE SPACE. 02960000
008488     05  FILLER                      PIC  X(04)      VALUE        02970000
008489         'SCAC'.                                                  02980000
008484     05  FILLER                      PIC  X(10)      VALUE SPACE. 02990000
008485     05  FILLER                      PIC  X(11)      VALUE        03000000
008486         'VESSEL NAME'.                                           03010000
008490     05  FILLER                      PIC  X(13)      VALUE SPACE. 03020000
008491     05  FILLER                      PIC  X(03)      VALUE        03030000
008492         'POL'.                                                   03040000
008487     05  FILLER                      PIC  X(08)      VALUE SPACE. 03050000
008482     05  FILLER                      PIC  X(03)      VALUE        03060000
008483         'ETD'.                                                   03070000
008487     05  FILLER                      PIC  X(06)      VALUE SPACE. 03080000
008482     05  FILLER                      PIC  X(03)      VALUE        03090000
008483         'POE'.                                                   03100000
008487     05  FILLER                      PIC  X(04)      VALUE SPACE. 03110000
008482     05  FILLER                      PIC  X(03)      VALUE        03120000
008483         'ETA'.                                                   03130000
008493     05  FILLER                      PIC  X(11)      VALUE SPACE. 03140000
008482     05  FILLER                      PIC  X(04)      VALUE        03150000
008483         'DEST'.                                                  03160000
008493     05  FILLER                      PIC  X(12)      VALUE SPACE. 03170000
008482     05  FILLER                      PIC  X(03)      VALUE        03180000
008483         'LBD'.                                                   03190000
008493     05  FILLER                      PIC  X(09)      VALUE SPACE. 03200000
008554*                                                                 03210000
008555 01  HL7-HEADING-LINE-1.                                          03220000
008556     05  HL7-RECD                    PIC  X(04)      VALUE        03230000
008557         'RECD'.                                                  03240000
008558     05  FILLER                      PIC  X(04)      VALUE SPACE. 03250000
008559     05  HL7-TRN                     PIC  X(04)      VALUE        03260000
008560         'TRN '.                                                  03270000
008561     05  FILLER                      PIC  X(16)      VALUE SPACE. 03280000
008562     05  FILLER                      PIC  X(04)      VALUE        03290000
008563         'CARR'.                                                  03300000
008564     05  FILLER                      PIC  X(12)      VALUE SPACE. 03310000
008565*                                                                 03320000
008566 01  HL7-HEADING-LINE-2.                                          03330000
008567     05  HL7-TYPE-1                  PIC  X(04)      VALUE        03340000
008568         'TYPE'.                                                  03350000
008569     05  FILLER                      PIC  X(04)      VALUE SPACE. 03360000
008570     05  HL7-TYPE-2                  PIC  X(04)      VALUE        03370000
008571         'TYPE'.                                                  03380000
008572     05  FILLER                      PIC  X(03)      VALUE SPACE. 03390000
008573     05  FILLER                      PIC  X(10)      VALUE        03400000
008574         'VOYAGE NBR'.                                            03410000
008575     05  FILLER                      PIC  X(02)      VALUE SPACE. 03420000
008576     05  FILLER                      PIC  X(04)      VALUE        03430000
008577         'SCAC'.                                                  03440000
008578     05  FILLER                      PIC  X(05)      VALUE SPACE. 03450000
008579     05  FILLER                      PIC  X(03)      VALUE        03460000
008580         'ETA'.                                                   03470000
008581     05  FILLER                      PIC  X(09)      VALUE SPACE. 03480000
008582     05  FILLER                      PIC  X(03)      VALUE        03490000
008583         'ETD'.                                                   03500000
008584     05  FILLER                      PIC  X(08)      VALUE SPACE. 03510000
008585     05  FILLER                      PIC  X(20)      VALUE        03520000
008586         'VOYAGE CHANGE REASON'.                                  03530000
008587     05  FILLER                      PIC  X(11)      VALUE SPACE. 03540000
009990*                                                                 03550000
009991 01  DL-DETAIL-LINE-2.                                            03560000
009992     05  DL02-PO-NBR-9              PIC  ZZZZZZZZZ  VALUE ZEROES. 03570000
013306     05  DL02-PO-NBR-X REDEFINES DL02-PO-NBR-9                    03580000
013307                                    PIC  XXXXXXXXX.               03590000
013308     05  FILLER                     PIC  X(02)    VALUE SPACES.   03600000
013309     05  DL02-REFERENCE-NBR         PIC  X(15)    VALUE SPACES.   03610000
013310     05  FILLER                     PIC  X(01)    VALUE SPACES.   03620000
013320     05  DL02-EST-DELIVERY-DATE.                                  03630000
013330         10  DL02-EST-DEL-MON       PIC  X(02)    VALUE SPACES.   03640000
013340         10  DL02-EST-SLASH-1       PIC  X(01)    VALUE '/'.      03650000
013350         10  DL02-EST-DEL-DAY       PIC  X(02)    VALUE SPACES.   03660000
013360         10  DL02-EST-SLASH-2       PIC  X(01)    VALUE '/'.      03670000
013361         10  DL02-EST-DEL-YEAR      PIC  X(04)    VALUE SPACES.   03680000
013362     05  FILLER                     PIC  X(02)    VALUE SPACES.   03690000
013363     05  DL02-SHPD-FR-CDE           PIC  X(03)    VALUE SPACES.   03700000
013364     05  FILLER                     PIC  X(02)    VALUE SPACES.   03710000
013365     05  DL02-VENDOR-NAME           PIC  X(30)    VALUE SPACES.   03720000
013366     05  FILLER                     PIC  X(10)    VALUE SPACES.   03730000
013367*                                                                 03740000
013368 01  DL-DETAIL-LINE-3.                                            03750000
013369     05  DL03-RECD-TYPE             PIC  X(06)    VALUE SPACES.   03760000
013370     05  FILLER                     PIC  X(03)    VALUE SPACES.   03770000
013371     05  DL03-TRN-TYPE              PIC  X(01)    VALUE SPACES.   03780000
013372     05  FILLER                     PIC  X(05)    VALUE SPACES.   03790000
013373     05  DL03-PROD-CNTRY-CDE        PIC  X(03).                   03800000
013378     05  FILLER                     PIC  X(07)    VALUE SPACES.   03810000
013379     05  DL03-PROD-FCTRY-CDE        PIC  X(35).                   03820000
013380     05  FILLER                     PIC  X(02)    VALUE SPACES.   03830000
013381     05  DL03-SCAC                  PIC  X(04).                   03840000
013382     05  FILLER                     PIC  X(02)    VALUE SPACES.   03850000
013383     05  DL03-CARTONS-9             PIC ZZZZZZZZ9.                03860000
013384     05  DL03-CARTONS-X REDEFINES DL03-CARTONS-9                  03870000
013385                                    PIC XXXXXXXXX.                03880000
013374     05  FILLER                     PIC  X(03)    VALUE SPACES.   03890000
013375     05  DL03-UNITS-9               PIC  ZZZZZZZZ9.               03900000
013376     05  DL03-UNITS-X   REDEFINES DL03-UNITS-9                    03910000
013377                                    PIC  XXXXXXXXX.               03920000
013386     05  FILLER                     PIC  X(03)    VALUE SPACES.   03930000
013387     05  DL03-CBMS-9                PIC ZZZZZZ9.99.               03940000
013388     05  DL03-CBMS-X  REDEFINES DL03-CBMS-9                       03950000
013389                                    PIC XXXXXXXXXX.               03960000
013390     05  FILLER                     PIC  X(02)    VALUE SPACES.   03970000
013391     05  DL03-KGRMS-9               PIC ZZZZZZZZ9.                03980000
013392     05  DL03-KGRMS-X REDEFINES DL03-KGRMS-9                      03990000
013393                                    PIC XXXXXXXXX.                04000000
013394     05  FILLER                     PIC  X(01)    VALUE SPACES.   04010000
013395*                                                                 04020000
013396 01  DL-DETAIL-LINE-4.                                            04030000
013397     05  FILLER                     PIC  X(09)    VALUE SPACES.   04040000
013398     05  DL04-RECD-TYPE             PIC  X(06)    VALUE SPACES.   04050000
013399     05  FILLER                     PIC  X(03)    VALUE SPACES.   04060000
013400     05  DL04-TRN-TYPE              PIC  X(01)    VALUE SPACES.   04070000
013401     05  FILLER                     PIC  X(06)    VALUE SPACES.   04080000
013402     05  DL04-VENDOR-STYLE          PIC  X(20)    VALUE SPACES.   04090000
013403     05  FILLER                     PIC  X(23)    VALUE SPACES.   04100000
013404     05  DL04-CARTONS-9             PIC ZZZZZZZZ9.                04110000
013405     05  DL04-CARTONS-X REDEFINES DL04-CARTONS-9                  04120000
013406                                    PIC XXXXXXXXX.                04130000
013407     05  FILLER                     PIC  X(03)    VALUE SPACES.   04140000
013408     05  DL04-UNITS-9               PIC ZZZZZZZZ9.                04150000
013409     05  DL04-UNITS-X   REDEFINES DL04-UNITS-9                    04160000
013410                                    PIC XXXXXXXXX.                04170000
013411     05  FILLER                     PIC  X(01)    VALUE SPACES.   04180000
013412     05  DL04-CBMS-9                PIC ZZZZZZZZ9.99.             04190000
013413     05  DL04-CBMS-X    REDEFINES DL04-CBMS-9                     04200000
013414                                    PIC XXXXXXXXXXXX.             04210000
013415     05  FILLER                     PIC  X(02)    VALUE SPACES.   04220000
013416     05  DL04-KGRMS-9               PIC ZZZZZZZZ9.                04230000
013417     05  DL04-KGRMS-X   REDEFINES DL04-KGRMS-9                    04240000
013418                                    PIC XXXXXXXXX.                04250000
013419     05  FILLER                     PIC  X(02)    VALUE SPACES.   04260000
013420*                                                                 04270000
013421*                                                                 04280000
013422 01  DL-DETAIL-LINE-5.                                            04290000
013423     05  FILLER                     PIC  X(17)    VALUE SPACES.   04300000
013424     05  DL05-RECD-TYPE             PIC  X(06)    VALUE SPACES.   04310000
013425     05  FILLER                     PIC  X(03)    VALUE SPACES.   04320000
013426     05  DL05-TRN-TYPE              PIC  X(01)    VALUE SPACES.   04330000
013427     05  FILLER                     PIC  X(04)    VALUE SPACES.   04340000
013428     05  DL05-VENDOR-STYLE          PIC  X(20).                   04350000
013429     05  FILLER                     PIC  X(01)    VALUE SPACES.   04360000
013430     05  DL05-UPC                   PIC  999999999999999.         04370000
013431     05  FILLER                     PIC  X(01)    VALUE SPACES.   04380000
013432     05  DL05-CARTON-9              PIC ZZZZZZZZ9.                04390000
013433     05  DL05-CARTON-X  REDEFINES DL05-CARTON-9                   04400000
013434                                    PIC XXXXXXXXX.                04410000
013435     05  FILLER                     PIC  X(03)    VALUE SPACES.   04420000
013436     05  DL05-UNITS-9               PIC ZZZZZZZZ9.                04430000
013437     05  DL05-UNITS-X   REDEFINES DL05-UNITS-9                    04440000
013438                                    PIC XXXXXXXXX.                04450000
013439     05  FILLER                     PIC  X(03)    VALUE SPACES.   04460000
013440     05  DL05-CBMS-9                PIC ZZZZZZ9.99.               04470000
013441     05  DL05-CBMS-X    REDEFINES DL05-CBMS-9                     04480000
013442                                    PIC XXXXXXXXXX.               04490000
013443     05  FILLER                     PIC  X(02)    VALUE SPACES.   04500000
013444     05  DL05-KGRMS-9               PIC ZZZZZZZZ9.                04510000
013445     05  DL05-KGRMS-X REDEFINES DL05-KGRMS-9                      04520000
013446                                    PIC XXXXXXXXX.                04530000
013447     05  FILLER                     PIC  X(02)    VALUE SPACES.   04540000
013448*                                                                 04550000
013449 01  DL-DETAIL-LINE-6-A.                                          04560000
013450     05  DL06-A-RECD-TYPE           PIC  X(06)    VALUE SPACES.   04570000
013451     05  FILLER                     PIC  X(03)    VALUE SPACES.   04580000
013452     05  DL06-A-TRN-TYPE            PIC  X(01)    VALUE SPACES.   04590000
013453     05  FILLER                     PIC  X(04)    VALUE SPACES.   04600000
013454     05  DL06-A-VSL-TYPE            PIC  X(01)    VALUE SPACES.   04610000
013455     05  FILLER                     PIC  X(04)    VALUE SPACES.   04620000
013456     05  DL06-A-VOYAGE-NBR          PIC  X(10)    VALUE SPACES.   04630000
013457     05  FILLER                     PIC  X(01)    VALUE SPACES.   04640000
013458     05  DL06-A-SCAC                PIC  X(04)    VALUE SPACES.   04650000
013459     05  FILLER                     PIC  X(03)    VALUE SPACES.   04660000
013460     05  DL06-A-VESSEL-NAME         PIC  X(25)    VALUE SPACES.   04670000
013507     05  FILLER                     PIC  X(06)    VALUE SPACES.   04680000
013508     05  DL06-A-POL                 PIC  X(05)    VALUE SPACES.   04690000
013500     05  FILLER                     PIC  X(03)    VALUE SPACES.   04700000
013501     05  DL06-A-ETD-DTE.                                          04710000
013502         10  DL06-A-ETD-DTE-MM      PIC  X(02)    VALUE SPACES.   04720000
013503         10  DL06-A-ETD-SLASH-1     PIC  X(01)    VALUE '/'.      04730000
013504         10  DL06-A-ETD-DTE-DD      PIC  X(02)    VALUE SPACES.   04740000
013505         10  DL06-A-ETD-SLASH-2     PIC  X(01)    VALUE '/'.      04750000
013506         10  DL06-A-ETD-DTE-YY      PIC  X(04)    VALUE SPACES.   04760000
013509     05  FILLER                     PIC  X(01)    VALUE SPACES.   04770000
013510     05  DL06-A-POE                 PIC  X(04)    VALUE SPACES.   04780000
013493     05  FILLER                     PIC  X(01)    VALUE SPACES.   04790000
013494     05  DL06-A-ETA-DTE.                                          04800000
013495         10  DL06-A-ETA-DTE-MM      PIC  X(02)    VALUE SPACES.   04810000
013496         10  DL06-A-ETA-SLASH-1     PIC  X(01)    VALUE '/'.      04820000
013497         10  DL06-A-ETA-DTE-DD      PIC  X(02)    VALUE SPACES.   04830000
013498         10  DL06-A-ETA-SLASH-2     PIC  X(01)    VALUE '/'.      04840000
013499         10  DL06-A-ETA-DTE-YY      PIC  X(04)    VALUE SPACES.   04850000
013509     05  FILLER                     PIC  X(01)    VALUE SPACES.   04860000
013510     05  DL06-A-EST-LBD-DEST        PIC  X(18)    VALUE SPACES.   04870000
013509     05  FILLER                     PIC  X(01)    VALUE SPACES.   04880000
013510     05  DL06-A-EST-LBD.                                          04890000
013527         10  DL06-A-EST-DTE-MM      PIC  X(02)    VALUE SPACES.   04900000
013528         10  DL06-A-EST-SLASH-1     PIC  X(01)    VALUE '/'.      04910000
013529         10  DL06-A-EST-DTE-DD      PIC  X(02)    VALUE SPACES.   04920000
013530         10  DL06-A-EST-SLASH-2     PIC  X(01)    VALUE '/'.      04930000
013531         10  DL06-A-EST-DTE-YY      PIC  X(04)    VALUE SPACES.   04940000
013511     05  FILLER                     PIC  X(02)    VALUE SPACES.   04950000
013480*                                                                 04960000
013512*                                                                 04970000
013513 01  DL-DETAIL-LINE-7.                                            04980000
013514     05  DL07-A-RECD-TYPE           PIC  X(06)    VALUE SPACES.   04990000
013515     05  FILLER                     PIC  X(04)    VALUE SPACES.   05000000
013516     05  DL07-A-TRN-TYPE            PIC  X(01)    VALUE SPACES.   05010000
013517     05  FILLER                     PIC  X(04)    VALUE SPACES.   05020000
013518     05  DL07-A-VOYAGE-NBR          PIC  X(10)    VALUE SPACES.   05030000
013519     05  FILLER                     PIC  X(02)    VALUE SPACES.   05040000
013520     05  DL07-A-SCAC                PIC  X(04)    VALUE SPACES.   05050000
013521     05  FILLER                     PIC  X(02)    VALUE SPACES.   05060000
013522     05  DL07-A-ETA-DTE.                                          05070000
013523         10  DL07-A-ETA-DTE-MM      PIC  X(02)    VALUE SPACES.   05080000
013524         10  DL07-A-ETA-SLASH-1     PIC  X(01)    VALUE '/'.      05090000
013525         10  DL07-A-ETA-DTE-DD      PIC  X(02)    VALUE SPACES.   05100000
013526         10  DL07-A-ETA-SLASH-2     PIC  X(01)    VALUE '/'.      05110000
013527         10  DL07-A-ETA-DTE-YY      PIC  X(04)    VALUE SPACES.   05120000
013528     05  FILLER                     PIC  X(02)    VALUE SPACES.   05130000
013529     05  DL07-A-ETD-DTE.                                          05140000
013530         10  DL07-A-ETD-DTE-MM      PIC  X(02)    VALUE SPACES.   05150000
013531         10  DL07-A-ETD-SLASH-1     PIC  X(01)    VALUE '/'.      05160000
013532         10  DL07-A-ETD-DTE-DD      PIC  X(02)    VALUE SPACES.   05170000
013533         10  DL07-A-ETD-SLASH-2     PIC  X(01)    VALUE '/'.      05180000
013534         10  DL07-A-ETD-DTE-YY      PIC  X(04)    VALUE SPACES.   05190000
013535     05  FILLER                     PIC  X(01)    VALUE SPACES.   05200000
013536     05  DL07-A-VOYAGE-CHANGE       PIC  X(30)    VALUE SPACES.   05210000
013537     05  FILLER                     PIC  X(01)    VALUE SPACES.   05220000
013592*                                                                 05230000
008306 01  TRL-HEADING-LINE-1.                                          05240000
008320     05  FILLER                      PIC  X(45)      VALUE        05250000
008321         'A = ADD, B/Z = CHANGE, C = CHANGE, D = DELETE'.         05260000
008325     05  FILLER                      PIC  X(01)      VALUE SPACE. 05270000
008326     05  FILLER                      PIC  X(20)      VALUE        05280000
008327         'E = CHANGE TO DELETE'.                                  05290000
008328     05  FILLER                      PIC  X(14)      VALUE SPACE. 05300000
013592*                                                                 05310000
013539 01  ER-END-OF-REPORT-LINE.                                       05320000
013540     05  FILLER                     PIC  X(54)    VALUE SPACE.    05330000
013541     05  FILLER                     PIC  X(25)    VALUE           05340000
013542         '***** END OF REPORT *****'.                             05350000
013543     05  FILLER                     PIC  X(53)    VALUE SPACE.    05360000
013544*                                                                 05370000
013545 01  EP-EMPTY-REPORT-LINE.                                        05380000
013546     05  FILLER                     PIC  X(25)    VALUE           05390000
013547         '******* NO DATA *********'.                             05400000
013548     05  FILLER                     PIC  X(87)    VALUE SPACE.    05410000
013549*                                                                 05420000
013550 01  PS-PROGRAM-SWITCHES.                                         05430000
013560     05  PS-EOF-ERROR-FILE-SW       PIC  X(01)    VALUE SPACE.    05440000
013600         88  PS-EOF-ERROR-FILE                    VALUE 'Y'.      05450000
014201     05  PS-NEW-PAGE-SW             PIC  X(01)    VALUE SPACE.    05460000
014202         88  PS-NEW-PAGE                          VALUE 'Y'.      05470000
014203         88  PS-NOT-NEW-PAGE                      VALUE 'N'.      05480000
014204     05  PS-NEW-PO-SW               PIC  X(01)    VALUE SPACE.    05490000
014205         88  PS-NEW-PO                            VALUE 'Y'.      05500000
014206         88  PS-NOT-NEW-PO                        VALUE 'N'.      05510000
014270     05  PS-ERD-SW                  PIC  X(01)    VALUE SPACE.    05520000
014280         88  PS-ERD-YES                           VALUE 'Y'.      05530000
014290         88  PS-ERD-NO                            VALUE 'N'.      05540000
014291     05  PS-LOG-SW                  PIC  X(01)    VALUE SPACE.    05550000
014292         88  PS-LOG-YES                           VALUE 'Y'.      05560000
014293         88  PS-LOG-NO                            VALUE 'N'.      05570000
014294     05  PS-LOGVS-SW                PIC  X(01)    VALUE SPACE.    05580000
014295         88  PS-LOGVS-YES                         VALUE 'Y'.      05590000
014296         88  PS-LOGVS-NO                          VALUE 'N'.      05600000
014297     05  PS-LOGUPC-SW               PIC  X(01)    VALUE SPACE.    05610000
014298         88  PS-LOGUPC-YES                        VALUE 'Y'.      05620000
014299         88  PS-LOGUPC-NO                         VALUE 'N'.      05630000
014300     05  PS-ERDRSN-SW               PIC  X(01)    VALUE SPACE.    05640000
014301         88  PS-ERDRSN-YES                        VALUE 'Y'.      05650000
014302         88  PS-ERDRSN-NO                         VALUE 'N'.      05660000
014303*                                                                 05670000
014400*                                                                 05680000
014500 01 PC-PROGRAM-CONSTANTS.                                         05690000
014600     05  PC-PAGE-SIZE-055           PIC S9(04)    VALUE +055      05700000
014700                                                  COMP SYNC.      05710000
014701     05  PC-PAGE-SIZE-060           PIC S9(04)    VALUE +060      05720000
014702                                                  COMP SYNC.      05730000
014800     05  PC-HEADING-SIZE            PIC S9(04)    VALUE +006      05740000
014900                                                  COMP SYNC.      05750000
015000     05  PC-MAX-RETRIES             PIC S9(04)    VALUE +3        05760000
015100                                                  COMP SYNC.      05770000
015200     05  PC-MAX-TABLE-ENTRIES       PIC S9(04)    VALUE +20       05780000
015300                                                  COMP SYNC.      05790000
015600     05  PC-CURRENT-PROGRAM-NAME    PIC  X(08)    VALUE           05800000
015700         'TRKRP222'.                                              05810000
015800     05  PC-A                       PIC  X(01)    VALUE 'A'.      05820000
015900     05  PC-01                      PIC  X(02)    VALUE '01'.     05830000
016300*                                                                 05840000
016400 01  V-PROGRAM-VARIABLES.                                         05850000
016500     05  PV-LINES-USED              PIC S9(04)    VALUE ZERO      05860000
016600                                                  COMP SYNC.      05870000
016700     05  PV-DELY-DTE-PREV           PIC  X(08)    VALUE SPACES.   05880000
016800     05  PV-SHPD-FR-CDE-PREV        PIC  X(03)    VALUE SPACES.   05890000
016900     05  PV-TRN-TYPE-PREV           PIC  X(01)    VALUE SPACES.   05900000
016901     05  PV-REC-TYP-CDE-PREV        PIC  X(06)    VALUE SPACES.   05910000
016902         88 PV-LOG-REC-TYP-CDE-LOG       VALUE 'LOG  '.           05920000
016903         88 PV-LOGVS-REC-TYP-CDE-LOGVS   VALUE 'LOGVS '.          05930000
016904         88 PV-LOGUPC-REC-TYP-CDE-LOGUPC VALUE 'LOGUPC'.          05940000
016905         88 PV-ERD-REC-TYP-CDE-ERD       VALUE 'ERD  '.           05950000
016906         88 PV-ERDRSN-REC-TYP-CD-ERDRSN  VALUE 'ERDRSN'.          05960000
016907     05  PV-PO-NBR                  PIC  9(09)    VALUE ZERO.     05970000
016908     05  PV-CONTAINER-NBR           PIC  X(12)    VALUE SPACES.   05980000
016909     05  PV-EXTL-REF-NBR            PIC  X(15)    VALUE SPACES.   05990000
016910     05  PV-BLANK-LINE              PIC  X(132)   VALUE SPACES.   06000000
016920     05  PV-NO-OF-POS-IN-ERROR      PIC  S9(06)   VALUE ZEROES.   06010000
017100     05  PV-PAGE-COUNT              PIC  9(05)    VALUE ZERO.     06020000
020200*                                                                 06030000
020300 01  SD-SYSTEM-DATE.                                              06040000
020400     05  SD-SYSTEM-DATE-YY          PIC  9(02)      VALUE ZERO.   06050000
020500     05  SD-SYSTEM-DATE-MM          PIC  9(02)      VALUE ZERO.   06060000
020600     05  SD-SYSTEM-DATE-DD          PIC  9(02)      VALUE ZERO.   06070000
020800*                                                                 06080000
020900 01  ST-SYSTEM-TIME.                                              06090000
021000     05  ST-SYSTEM-HOUR             PIC  9(02)      VALUE ZERO.   06100000
021100     05  ST-SYSTEM-MINUTE           PIC  9(02)      VALUE ZERO.   06110000
021200     05  FILLER                     PIC  9(04)      VALUE ZERO.   06120000
021300*----------------------------------------------------------------*06130000
033200*  COMMUNICATION AREAS FOR DB2                                    06140000
033300*----------------------------------------------------------------*06150000
033400     EXEC SQL                                                     06160000
033500         INCLUDE SQLCA                                            06170000
033600     END-EXEC.                                                    06180000
033800*----------------------------------------------------------------*06190000
033900*  DB2 COMMUNICATION AREA 2                                       06200000
034000*----------------------------------------------------------------*06210000
034100     COPY SQLCA2.                                                 06220003
034101*                                                                 06230000
034102******************************************************************06240000
034103 PROCEDURE DIVISION.                                              06250000
034104******************************************************************06260000
034105*                                                                 06270000
034106*----------------------------------------------------------------*06280000
034107* 0000-PROGRAM-MAINLINE - CONTROLS THE MAIN PROCESSING OF THE     06290000
034108*      PROGRAM.                                                   06300000
034109*----------------------------------------------------------------*06310000
034110 0000-PROGRAM-MAINLINE.                                           06320000
034120                                                                  06330000
034130     PERFORM 1000-INITIALIZE.                                     06340000
034140*                                                                 06350000
034141     PERFORM 2000-PROCESS-REPORT-DATA                             06360000
034142       UNTIL PS-EOF-ERROR-FILE.                                   06370000
034143*                                                                 06380000
034144     PERFORM 9000-EOJ-ROUTINE.                                    06390000
034145*                                                                 06400000
034146     STOP RUN.                                                    06410000
034147*                                                                 06420000
034148*0000-EXIT.                                                       06430000
034149*                                                                 06440000
034150******************************************************************06450000
034151*  DO FIRST TIME PROGRAM INITIALIZATION TASKS.                    06460000
034152*    -- OPEN FILES                                                06470000
034153*    -- SET UP AND PRINT REPORT HEADINGS                          06480000
034154******************************************************************06490000
034155 1000-INITIALIZE.                                                 06500000
034156                                                                  06510000
034157     OPEN INPUT  ERROR-FILE                                       06520000
034158          OUTPUT ERROR-REPORT-FILE.                               06530000
034159*                                                                 06540000
034160     ACCEPT SD-SYSTEM-DATE FROM DATE.                             06550000
034161     ACCEPT ST-SYSTEM-TIME FROM TIME.                             06560000
034162     MOVE SD-SYSTEM-DATE-YY      TO DP132O-RUN-YEAR.              06570000
034163     MOVE SD-SYSTEM-DATE-MM      TO DP132O-RUN-MONTH.             06580000
034164     MOVE SD-SYSTEM-DATE-DD      TO DP132O-RUN-DAY.               06590000
034165     MOVE ST-SYSTEM-HOUR         TO DP132O-RUN-HOUR.              06600000
034166     MOVE ST-SYSTEM-MINUTE       TO DP132O-RUN-MINUTE.            06610000
034167     MOVE PC-CURRENT-PROGRAM-NAME                                 06620000
034168                                 TO DP132O-PROGRAM-NAME.          06630000
034169     MOVE 1                      TO DP132O-REPORT-NUMBER.         06640000
034170     INITIALIZE     PS-ERD-SW                                     06650000
034180                    PS-LOG-SW                                     06660000
034190                    PS-LOGVS-SW                                   06670000
034200                    PS-LOGUPC-SW                                  06680000
034300                    PS-ERDRSN-SW                                  06690000
034301                    PS-NEW-PAGE-SW.                               06700000
034302*                                                                 06710000
034303     PERFORM 7000-READ-ERROR-FILE UNTIL                           06720000
034304             PS-EOF-ERROR-FILE OR                                 06730000
034305            (TR221-RPT-TYP-DETAIL AND                             06740000
034306             NOT TR221-REC-TYP-HDR-CDE-HDR)                       06750000
034307*                                                                 06760000
034500     IF NOT PS-EOF-ERROR-FILE                                     06770000
034600                                                                  06780000
034700         IF TR221-PO-NBR NUMERIC                                  06790000
034800            MOVE TR221-PO-NBR        TO DL02-PO-NBR-9             06800000
034900         ELSE                                                     06810000
035000            MOVE TR221-PO-NBR-X      TO DL02-PO-NBR-X             06820000
035100         END-IF                                                   06830000
035200                                                                  06840000
035300         MOVE TR221-PO-NBR    TO     PV-PO-NBR                    06850000
035400         MOVE TR221-EXTL-REF-NBR TO PV-EXTL-REF-NBR               06860000
035500                                     DL02-REFERENCE-NBR           06870000
035600                                                                  06880000
035700         MOVE TR221-PO-RCVD-DELY-DTE (5:2) TO                     06890000
035800                                     PV-DELY-DTE-PREV (5:2)       06900000
035900                                     DL02-EST-DEL-MON             06910000
036000         MOVE TR221-PO-RCVD-DELY-DTE (7:2) TO                     06920000
036100                                     PV-DELY-DTE-PREV (7:2)       06930000
036200                                     DL02-EST-DEL-DAY             06940000
036300         MOVE TR221-PO-RCVD-DELY-DTE (1:4) TO                     06950000
036400                                     PV-DELY-DTE-PREV (1:4)       06960000
036500                                     DL02-EST-DEL-YEAR            06970000
036600                                                                  06980000
036700         MOVE TR221-TRN-TYP       TO PV-TRN-TYPE-PREV             06990000
036800                                                                  07000000
036900         MOVE TR221-ORGN-SHPD-FR-CDE TO                           07010000
037000                                  PV-SHPD-FR-CDE-PREV             07020000
037100                                  DL02-SHPD-FR-CDE                07030000
037200                                                                  07040000
               IF TR221-PO-RCVD-DELY-DTE (1:4) = '0001' OR              07050000
                 TR221-PO-RCVD-DELY-DTE (1:4) = SPACES                  07060000
                    MOVE SPACES TO DL02-EST-SLASH-1                     07070000
                                   DL02-EST-SLASH-2                     07080000
                                   DL02-EST-DEL-MON                     07090000
                                   DL02-EST-DEL-DAY                     07100000
                                   DL02-EST-DEL-YEAR                    07110000
               ELSE                                                     07120000
                    MOVE '/'    TO DL02-EST-SLASH-1                     07130000
                                   DL02-EST-SLASH-2                     07140000
               END-IF                                                   07150000
038202*                                                                 07160000
               IF TR221-ERROR-TYPE NOT = 'EMT' AND                      07170000
                  TR221-ERROR-TYPE NOT = 'IEA' OR                       07180000
                  TR221-ERROR-TYPE = '   '                              07190000
                    PERFORM  8000-WRITE-PAGE-HEADINGS                   07200000
               END-IF                                                   07210000
038207*                                                                 07220000
038208     ELSE                                                         07230000
038205         PERFORM  8000-WRITE-PAGE-HEADINGS                        07240000
038208     END-IF                                                       07250000
038209*                                                                 07260000
           IF TR221-ERROR-TYPE = 'EMT' OR                               07270002
              TR221-ERROR-TYPE = 'IEA' OR                               07280002
              PS-EOF-ERROR-FILE                                         07290002
              PERFORM 9100-EOJ-ROUTINE                                  07300002
              STOP RUN                                                  07310002
           ELSE                                                         07320002
              PERFORM 2025-BUILD-ERROR-RPT-DATA                         07330002
           END-IF.                                                      07340002
038292*                                                                 07370000
038293*1000-EXIT.                                                       07380000
038294*                                                                 07390000
038295* **************************************************************  07400000
038296*  PROCESSING FOR ERROR RECORDS.                                  07410000
038297******************************************************************07420000
038298 2000-PROCESS-REPORT-DATA.                                        07430000
038299                                                                  07440000
038300     MOVE SPACES TO TR221-RPT-TYP                                 07450000
038400*                                                                 07460000
038500     PERFORM 7000-READ-ERROR-FILE UNTIL                           07470000
038600             PS-EOF-ERROR-FILE OR                                 07480000
038700            (TR221-RPT-TYP-DETAIL AND                             07490000
038800             NOT TR221-REC-TYP-HDR-CDE-HDR)                       07500000
038900*                                                                 07510000
039000     IF TR221-RPT-TYP-DETAIL                                      07520000
039100        PERFORM 2025-BUILD-ERROR-RPT-DATA                         07530000
039200     END-IF.                                                      07540000
039300*                                                                 07550000
039400******************************************************************07560000
039500*  BUILD THE LINES FOR THE REPORT.                                07570000
039600******************************************************************07580000
039700 2025-BUILD-ERROR-RPT-DATA.                                       07590000
039800                                                                  07600000
043115     IF TR221-REC-TYP-ERD-CDE-ERD                                 07610000
043116         PERFORM 3250-MOVE-ERD-TO-DETAIL                          07620000
043117     END-IF.                                                      07630000
043118                                                                  07640000
043119     IF TR221-REC-TYP-ERDRSN-CD-ERDRSN                            07650000
043120         PERFORM 3300-MOVE-ERDRSN-TO-DETAIL                       07660000
043130     END-IF.                                                      07670000
043131                                                                  07680000
043132     IF TR221-REC-TYP-LOG-CDE-LOG                                 07690000
043133         PERFORM 3100-MOVE-LOG-TO-DETAIL                          07700000
043134     END-IF.                                                      07710000
043135                                                                  07720000
043136     IF TR221-REC-TYP-LOGVS-CDE-LOGVS                             07730000
043137         PERFORM 3150-MOVE-LOGVS-TO-DETAIL                        07740000
043138     END-IF.                                                      07750000
043139                                                                  07760000
043140     IF TR221-REC-TYP-LOGUPC-CD-LOGUPC                            07770000
043141         PERFORM 3200-MOVE-LOGUPC-TO-DETAIL                       07780000
043142     END-IF.                                                      07790000
043143                                                                  07800000
043144     PERFORM 2050-CHECK-FOR-PREVIOUS.                             07810000
043145     PERFORM 8100-WRITE-ERROR-RPT-DETAIL.                         07820000
043146*                                                                 07830000
043147     IF NOT TR221-REC-TYP-ERD-CDE-ERD AND                         07840000
043148        NOT TR221-REC-TYP-LOG-CDE-LOG AND                         07850000
043149        NOT TR221-REC-TYP-LOGUPC-CD-LOGUPC AND                    07860000
043150        NOT TR221-REC-TYP-ERDRSN-CD-ERDRSN                        07870000
043151         PERFORM 3650-MOVE-ERROR-TO-DETAIL                        07880000
043152     END-IF.                                                      07890000
043153*                                                                 07900000
043154*2000-EXIT.                                                       07910000
043155*                                                                 07920000
043156* **************************************************************  07930000
043157*  CHECKS TO SEE IF THERE IS A BREAK, IF THERE IS NOT             07940000
043158*  DATA IS NOT REPEATED FOR CONTAINER-NO AND REFERNCE-NO          07950000
043159* *************************************************************** 07960000
043160 2050-CHECK-FOR-PREVIOUS.                                         07970000
043170                                                                  07980000
043180     IF  TR221-EXTL-REF-NBR = PV-EXTL-REF-NBR AND                 07990000
043190         TR221-PO-NBR = PV-PO-NBR AND                             08000000
043200         TR221-PO-RCVD-DELY-DTE (5:2) = PV-DELY-DTE-PREV (5:2) AND08010000
043300         TR221-PO-RCVD-DELY-DTE (7:2) = PV-DELY-DTE-PREV (7:2) AND08020000
043400         TR221-PO-RCVD-DELY-DTE (1:4) = PV-DELY-DTE-PREV (1:4) AND08030000
043500         TR221-TRN-TYP               = PV-TRN-TYPE-PREV AND       08040000
043600         TR221-ORGN-SHPD-FR-CDE      = PV-SHPD-FR-CDE-PREV AND    08050000
043700        (TR221-REC-TYP-ERD-CDE-ERD OR                             08060000
043800         TR221-REC-TYP-ERDRSN-CD-ERDRSN OR                        08070000
043900         TR221-REC-TYP-LOG-CDE-LOG OR                             08080000
044000         TR221-REC-TYP-LOGVS-CDE-LOGVS OR                         08090000
044100         TR221-REC-TYP-LOGUPC-CD-LOGUPC)                          08100000
044200         CONTINUE                                                 08110000
044300     ELSE                                                         08120000
044400                                                                  08130000
044500         IF TR221-PO-NBR NUMERIC                                  08140000
044600            MOVE TR221-PO-NBR        TO DL02-PO-NBR-9             08150000
044700         ELSE                                                     08160000
044800            MOVE TR221-PO-NBR-X      TO DL02-PO-NBR-X             08170000
044900         END-IF                                                   08180000
045000                                                                  08190000
045100         MOVE TR221-PO-NBR    TO     PV-PO-NBR                    08200000
045200         MOVE TR221-EXTL-REF-NBR TO PV-EXTL-REF-NBR               08210000
045300                                    DL02-REFERENCE-NBR            08220000
045400                                                                  08230000
045500         MOVE TR221-PO-RCVD-DELY-DTE (5:2) TO                     08240000
045600                                     PV-DELY-DTE-PREV (5:2)       08250000
045700                                     DL02-EST-DEL-MON             08260000
045800         MOVE TR221-PO-RCVD-DELY-DTE (7:2) TO                     08270000
045900                                     PV-DELY-DTE-PREV (7:2)       08280000
046000                                     DL02-EST-DEL-DAY             08290000
046100         MOVE TR221-PO-RCVD-DELY-DTE (1:4) TO                     08300000
046200                                     PV-DELY-DTE-PREV (1:4)       08310000
046300                                     DL02-EST-DEL-YEAR            08320000
046400                                                                  08330000
046500         MOVE TR221-TRN-TYP          TO PV-TRN-TYPE-PREV          08340000
046600                                                                  08350000
046700         MOVE TR221-ORGN-SHPD-FR-CDE TO                           08360000
046800                                     PV-SHPD-FR-CDE-PREV          08370000
046900                                     DL02-SHPD-FR-CDE             08380000
047000                                                                  08390000
047100       IF TR221-PO-RCVD-DELY-DTE (1:4) = '0001' OR                08400000
047200         TR221-PO-RCVD-DELY-DTE (1:4) = SPACES                    08410000
047300            MOVE SPACES TO DL02-EST-SLASH-1                       08420000
047400                           DL02-EST-SLASH-2                       08430000
047500                           DL02-EST-DEL-MON                       08440000
047600                           DL02-EST-DEL-DAY                       08450000
047700                           DL02-EST-DEL-YEAR                      08460000
047800       ELSE                                                       08470000
047900            MOVE '/'    TO DL02-EST-SLASH-1                       08480000
048000                           DL02-EST-SLASH-2                       08490000
048100       END-IF                                                     08500000
048200                                                                  08510000
048300         INITIALIZE     PS-ERD-SW                                 08520000
048400                        PS-LOG-SW                                 08530000
048500                        PS-LOGVS-SW                               08540000
048600                        PS-LOGUPC-SW                              08550000
048700                        PS-ERDRSN-SW                              08560000
048800         SET PS-NEW-PO           TO TRUE                          08570000
048900         SET PS-NEW-PAGE  TO TRUE                                 08580000
049000         PERFORM  8000-WRITE-PAGE-HEADINGS                        08590000
049100     END-IF.                                                      08600000
049200*                                                                 08610000
049300     IF PV-LINES-USED >= PC-PAGE-SIZE-060                         08620000
049301        SET PS-NEW-PAGE  TO TRUE                                  08630000
049302        SET PS-ERD-NO TO TRUE                                     08640000
049303        SET PS-LOG-NO TO TRUE                                     08650000
049304        SET PS-LOGVS-NO TO TRUE                                   08660000
049305        SET PS-LOGUPC-NO TO TRUE                                  08670000
049306        SET PS-ERDRSN-NO TO TRUE                                  08680000
049307        PERFORM 8000-WRITE-PAGE-HEADINGS                          08690000
049308     END-IF.                                                      08700000
049309                                                                  08710000
049310                                                                  08720000
049311                                                                  08730000
049312******************************************************************08740000
049313* SELECT VENDOR NAME FROM TPURCHS.                                08750000
049314******************************************************************08760000
049400                                                                  08770000
049401 2060-SELECT-VENDOR-NAME.                                         08780000
049402                                                                  08790000
049403     MOVE TR221-PO-NBR         TO  PURCHS-PO-NBR.                 08800000
049404     MOVE PC-A                 TO  PURCHS-VER-STATUS-CDE.         08810000
049405                                                                  08820000
049600     EXEC SQL                                                     08830000
049700           SELECT DISTINCT                                        08840000
049800                  A.ENT_NAME_DESC                                 08850000
050300           INTO   :ENTNME-ENT-NAME-DESC                           08860000
050800           FROM   TENTNME A,                                      08870000
050900                  TPURCHS B                                       08880000
051000           WHERE  B.PO_NBR       = :PURCHS-PO-NBR                 08890000
051100           AND    A.ENT_ID       = B.ENT_ID                       08900000
051200           AND    VER_STATUS_CDE = :PURCHS-VER-STATUS-CDE         08910000
051300           AND    A.TYPE_CDE    = :PC-01                          08920000
051400                                                                  08930000
051900     END-EXEC.                                                    08940000
052000                                                                  08950000
052100     EVALUATE TRUE                                                08960000
052200         WHEN SQLCODE = 0                                         08970000
052300             MOVE ENTNME-ENT-NAME-DESC   TO DL02-VENDOR-NAME      08980000
052400         WHEN SQLCODE = +100                                      08990000
052500             MOVE SPACES                 TO DL02-VENDOR-NAME      09000000
053000         WHEN SQLCODE = -904                                      09010000
053100         WHEN SQLCODE = -911                                      09020000
053200             MOVE SPACES                 TO DL02-VENDOR-NAME      09030000
053300             CONTINUE                                             09040000
054600     END-EVALUATE.                                                09050000
054700*                                                                 09060000
208800******************************************************************09070000
208900* CHECKS TO SEE IF THE POE-CDE ON MAINFRAME IS VALID (ACTIVE).   *09080000
208910* ALSO, CHECKS THE LANDBRIGDE NAME.                              *09090000
209000******************************************************************09100000
209100 3010-EDIT-POE-LBD.                                               09110000
209200                                                                  09120000
013527     MOVE SPACES TO               DL06-A-EST-DTE-MM               09130000
013529                                  DL06-A-EST-DTE-DD               09140000
013531                                  DL06-A-EST-DTE-YY               09150000
013527     MOVE SPACES TO               DL06-A-EST-SLASH-1              09160000
                                        DL06-A-EST-SLASH-2              09170000
209200                                                                  09180000
209210     IF TR221-ERD-DEST-POE-CDE = SPACES  AND                      09190000
209220        TR221-ERD-EST-LBD-NM   = SPACES                           09200000
210420         CONTINUE                                                 09210000
210600     ELSE                                                         09220000
210610         IF TR221-ERD-EST-LBD-NM = SPACES                         09230000
210620             PERFORM 3015-POE-CHECK                               09240000
210621         ELSE                                                     09250000
210622             IF TR221-ERD-DEST-POE-CDE = SPACES                   09260000
                        MOVE TR221-ERD-POE-DELY-DTE (1:4)  TO           09270000
                              DL06-A-EST-DTE-YY                         09280000
                        MOVE TR221-ERD-POE-DELY-DTE (5:2)  TO           09290000
                              DL06-A-EST-DTE-MM                         09300000
                        MOVE TR221-ERD-POE-DELY-DTE (7:2)  TO           09310000
                              DL06-A-EST-DTE-DD                         09320000
                                                                        09330000
                     IF TR221-ERD-POE-DELY-DTE(1:4) = '0001' OR         09340000
                       TR221-ERD-POE-DELY-DTE(1:4) = SPACES             09350000
                          MOVE SPACES TO DL06-A-EST-SLASH-1             09360000
                                         DL06-A-EST-SLASH-2             09370000
                                         DL06-A-EST-DTE-MM              09380000
                                         DL06-A-EST-DTE-DD              09390000
                                         DL06-A-EST-DTE-YY              09400000
                     ELSE                                               09410000
                          MOVE '/'    TO DL06-A-EST-SLASH-1             09420000
                                         DL06-A-EST-SLASH-2             09430000
                     END-IF                                             09440000
                   ELSE                                                 09450000
                   IF TR221-ERD-DEST-POE-CDE = SPACES                   09460000
                        MOVE TR221-ERD-POE-DELY-DTE (1:4)  TO           09470000
                              DL06-A-EST-DTE-YY                         09480000
                        MOVE TR221-ERD-POE-DELY-DTE (5:2)  TO           09490000
                              DL06-A-EST-DTE-MM                         09500000
                        MOVE TR221-ERD-POE-DELY-DTE (7:2)  TO           09510000
                              DL06-A-EST-DTE-DD                         09520000
                                                                        09530000
                     IF TR221-ERD-POE-DELY-DTE(1:4) = '0001' OR         09540000
                       TR221-ERD-POE-DELY-DTE(1:4) = SPACES             09550000
                          MOVE SPACES TO DL06-A-EST-SLASH-1             09560000
                                         DL06-A-EST-SLASH-2             09570000
                                         DL06-A-EST-DTE-MM              09580000
                                         DL06-A-EST-DTE-DD              09590000
                                         DL06-A-EST-DTE-YY              09600000
                     ELSE                                               09610000
                          MOVE '/'    TO DL06-A-EST-SLASH-1             09620000
                                         DL06-A-EST-SLASH-2             09630000
                     END-IF                                             09640000
                       PERFORM 3015-POE-CHECK                           09650000
                   END-IF                                               09660000
               END-IF                                                   09670000
           END-IF.                                                      09680000
213300                                                                  09690000
213310******************************************************************09700000
213320* CHECKS TO SEE IF THE POE-CDE ON MAINFRAME IS VALID (ACTIVE).   *09710000
213330* ALSO, CHECKS THE LANDBRIGDE NAME.                              *09720000
213340******************************************************************09730000
213350 3015-POE-CHECK.                                                  09740000
213395                                                                  09750000
068000     IF TR221-ERD-DEST-POE-CDE NOT = SPACES                       09760000
213399         MOVE TR221-ERD-POE-DELY-DTE (1:4)  TO                    09770000
                     DL06-A-EST-DTE-YY                                  09780000
213403         MOVE TR221-ERD-POE-DELY-DTE (5:2)  TO                    09790000
                     DL06-A-EST-DTE-MM                                  09800000
213407         MOVE TR221-ERD-POE-DELY-DTE (7:2)  TO                    09810000
013529               DL06-A-EST-DTE-DD                                  09820000
                                                                        09830000
                   IF TR221-ERD-POE-DELY-DTE(1:4) = '0001' OR           09840000
                     TR221-ERD-POE-DELY-DTE(1:4) = SPACES               09850000
                        MOVE SPACES TO DL06-A-EST-SLASH-1               09860000
                                       DL06-A-EST-SLASH-2               09870000
                                       DL06-A-EST-DTE-MM                09880000
                                       DL06-A-EST-DTE-DD                09890000
                                       DL06-A-EST-DTE-YY                09900000
                   ELSE                                                 09910000
                        MOVE '/'    TO DL06-A-EST-SLASH-1               09920000
                                       DL06-A-EST-SLASH-2               09930000
                  END-IF                                                09940000
213426     ELSE                                                         09950000
213429         MOVE TR221-ERD-POE-DELY-DTE (1:4)  TO                    09960000
                     DL06-A-EST-DTE-YY                                  09970000
213433         MOVE TR221-ERD-POE-DELY-DTE (5:2)  TO                    09980000
                     DL06-A-EST-DTE-MM                                  09990000
213437         MOVE TR221-ERD-POE-DELY-DTE (7:2)  TO                    10000000
013529               DL06-A-EST-DTE-DD                                  10010000
                                                                        10020000
                   IF TR221-ERD-POE-DELY-DTE(1:4) = '0001' OR           10030000
                     TR221-ERD-POE-DELY-DTE(1:4) = SPACES               10040000
                        MOVE SPACES TO DL06-A-EST-SLASH-1               10050000
                                       DL06-A-EST-SLASH-2               10060000
                                       DL06-A-EST-DTE-MM                10070000
                                       DL06-A-EST-DTE-DD                10080000
                                       DL06-A-EST-DTE-YY                10090000
                   ELSE                                                 10100000
                        MOVE '/'    TO DL06-A-EST-SLASH-1               10110000
                                       DL06-A-EST-SLASH-2               10120000
                  END-IF                                                10130000
213466     END-IF.                                                      10140000
054701*                                                                 10150000
054702******************************************************************10160000
054703*MOVE LOG DATA TO REPORT DETAIL LINE                              10170000
054704******************************************************************10180000
054705 3100-MOVE-LOG-TO-DETAIL.                                         10190000
054706                                                                  10200000
054707     MOVE TR221-REC-TYP-LOG-CDE      TO                           10210000
054708                                     PV-REC-TYP-CDE-PREV          10220000
054709                                     DL03-RECD-TYPE.              10230000
054710     MOVE TR221-TRN-TYP              TO                           10240000
054720                                     DL03-TRN-TYPE                10250000
054730     MOVE TR221-LOG-C-O-PROD-CDE     TO                           10260000
054740                                     DL03-PROD-CNTRY-CDE          10270000
054750                                                                  10280000
054760     IF TR221-LOG-PO-UNT-QTY  NUMERIC                             10290000
054770        MOVE TR221-LOG-PO-UNT-QTY    TO DL03-UNITS-9              10300000
054780     ELSE                                                         10310000
054790        MOVE TR221-LOG-PO-UNT-QTY-X  TO DL03-UNITS-X              10320000
054800     END-IF                                                       10330000
054900                                                                  10340000
055000     MOVE TR221-LOG-PROD-FCTRY-NM    TO                           10350000
055100                                     DL03-PROD-FCTRY-CDE          10360000
055200     MOVE TR221-LOG-CONSOL-SCAC-ID   TO                           10370000
055300                                     DL03-SCAC                    10380000
055400                                                                  10390000
055500     IF TR221-LOG-PO-CART-CNT NUMERIC                             10400000
055600        MOVE TR221-LOG-PO-CART-CNT     TO DL03-CARTONS-9          10410000
055700     ELSE                                                         10420000
055800        MOVE TR221-LOG-PO-CART-CNT-X   TO DL03-CARTONS-X          10430000
055900     END-IF                                                       10440000
056000                                                                  10450000
056100     IF TR221-LOG-PO-CBMT-QTY NUMERIC                             10460000
056200        MOVE TR221-LOG-PO-CBMT-QTY     TO DL03-CBMS-9             10470000
056300     ELSE                                                         10480000
056400        MOVE TR221-LOG-PO-CBMT-QTY-X   TO DL03-CBMS-X             10490000
056500     END-IF                                                       10500000
056600                                                                  10510000
056700     IF TR221-LOG-PO-WT-KGRM-QTY NUMERIC                          10520000
056800        MOVE TR221-LOG-PO-WT-KGRM-QTY   TO DL03-KGRMS-9           10530000
056900     ELSE                                                         10540000
057000        MOVE TR221-LOG-PO-WT-KGRM-QTY-X TO DL03-KGRMS-X           10550000
057100     END-IF.                                                      10560000
057101*                                                                 10570000
057102******************************************************************10580000
057103*MOVE LOGVS DATA TO REPORT DETAIL LINE                            10590000
057104******************************************************************10600000
057105 3150-MOVE-LOGVS-TO-DETAIL.                                       10610000
057106                                                                  10620000
057107     MOVE TR221-REC-TYP-LOGVS-CDE    TO                           10630000
057108                                     PV-REC-TYP-CDE-PREV          10640000
057109                                     DL04-RECD-TYPE               10650000
057110     MOVE TR221-TRN-TYP              TO                           10660000
057120                                     DL04-TRN-TYPE                10670000
057130     MOVE TR221-LOGVS-VS-NBR         TO                           10680000
057140                                     DL04-VENDOR-STYLE            10690000
057150                                                                  10700000
057160     IF TR221-LOGVS-VS-CART-CNT NUMERIC                           10710000
057170        MOVE TR221-LOGVS-VS-CART-CNT   TO DL04-CARTONS-9          10720000
057180     ELSE                                                         10730000
057190        MOVE TR221-LOGVS-VS-CART-CNT-X TO DL04-CARTONS-X          10740000
057200     END-IF                                                       10750000
057300                                                                  10760000
057400     IF TR221-LOGVS-VS-UNT-QTY  NUMERIC                           10770000
057500        MOVE TR221-LOGVS-VS-UNT-QTY    TO DL04-UNITS-9            10780000
057600     ELSE                                                         10790000
057700        MOVE TR221-LOGVS-VS-UNT-QTY-X  TO DL04-UNITS-X            10800000
057800     END-IF                                                       10810000
057900                                                                  10820000
058000     IF TR221-LOGVS-VS-CBMT-QTY NUMERIC                           10830000
058100        MOVE TR221-LOGVS-VS-CBMT-QTY   TO DL04-CBMS-9             10840000
058200     ELSE                                                         10850000
058300        MOVE TR221-LOGVS-VS-CBMT-QTY-X TO DL04-CBMS-X             10860000
058400     END-IF                                                       10870000
058500                                                                  10880000
058600     IF TR221-LOGVS-VS-WT-KGRM-QTY NUMERIC                        10890000
058700        MOVE TR221-LOGVS-VS-WT-KGRM-QTY TO DL04-KGRMS-9           10900000
058800     ELSE                                                         10910000
058900        MOVE TR221-LOGVS-VS-WT-KGRM-QTY-X TO DL04-KGRMS-X         10920000
059000     END-IF.                                                      10930000
059001*                                                                 10940000
059002******************************************************************10950000
059003*MOVE LOGUPC DATA TO REPORT DETAIL LINE                           10960000
059004******************************************************************10970000
059005 3200-MOVE-LOGUPC-TO-DETAIL.                                      10980000
059006                                                                  10990000
059007     MOVE TR221-REC-TYP-LOGUPC-CDE      TO                        11000000
059008                                        PV-REC-TYP-CDE-PREV       11010000
059009                                        DL05-RECD-TYPE.           11020000
059010     MOVE TR221-TRN-TYP                 TO                        11030000
059020                                        DL05-TRN-TYPE.            11040000
059030     MOVE TR221-LOGUPC-VS-NBR           TO                        11050000
059040                                        DL05-VENDOR-STYLE         11060000
059050     MOVE TR221-LOGUPC-UPC-NBR          TO                        11070000
059060                                        DL05-UPC                  11080000
059070                                                                  11090000
059080     IF TR221-LOGUPC-UPC-CART-CNT NUMERIC                         11100000
059090         MOVE TR221-LOGUPC-UPC-CART-CNT  TO DL05-CARTON-9         11110000
059100     ELSE                                                         11120000
059200         MOVE TR221-LOGUPC-UPC-CART-CNT-X TO DL05-CARTON-X        11130000
059300     END-IF                                                       11140000
059400                                                                  11150000
059500     IF TR221-LOGUPC-UPC-UNT-QTY  NUMERIC                         11160000
059600         MOVE TR221-LOGUPC-UPC-UNT-QTY   TO DL05-UNITS-9          11170000
059700     ELSE                                                         11180000
059800         MOVE TR221-LOGUPC-UPC-UNT-QTY-X TO DL05-UNITS-X          11190000
059900     END-IF                                                       11200000
060000                                                                  11210000
060100     IF TR221-LOGUPC-UPC-CBMT-QTY NUMERIC                         11220000
060200         MOVE TR221-LOGUPC-UPC-CBMT-QTY  TO DL05-CBMS-9           11230000
060300     ELSE                                                         11240000
060400         MOVE TR221-LOGUPC-UPC-CBMT-QTY-X TO DL05-CBMS-X          11250000
060500     END-IF                                                       11260000
060600                                                                  11270000
060700                                                                  11280000
060800     IF TR221-LOGUPC-UPC-WT-KGRM-QTY NUMERIC                      11290000
060900        MOVE TR221-LOGUPC-UPC-WT-KGRM-QTY   TO DL05-KGRMS-9       11300000
061000     ELSE                                                         11310000
061100        MOVE TR221-LOGUPC-UPC-WT-KGRM-QTY-X TO DL05-KGRMS-X       11320000
061200     END-IF.                                                      11330000
061201*                                                                 11340000
061202******************************************************************11350000
061203*MOVE ERD DATA TO REPORT DETAIL LINE                              11360000
061204******************************************************************11370000
061205 3250-MOVE-ERD-TO-DETAIL.                                         11380000
061206                                                                  11390000
061207     MOVE TR221-REC-TYP-ERD-CDE       TO                          11400000
061208                                      PV-REC-TYP-CDE-PREV         11410000
061209                                      DL06-A-RECD-TYPE.           11420000
061210     MOVE TR221-TRN-TYP               TO                          11430000
061220                                      DL06-A-TRN-TYPE.            11440000
061230     MOVE TR221-ERD-TRIP-TYP-CDE      TO                          11450000
061240                                      DL06-A-VSL-TYPE             11460000
061250     MOVE TR221-ERD-IMPRT-TRIP-ID     TO                          11470000
061260                                      DL06-A-VOYAGE-NBR           11480000
061270     MOVE TR221-ERD-CARR-SCAC-ID      TO                          11490000
061280                                      DL06-A-SCAC                 11500000
061290     MOVE TR221-ERD-IMPRT-VEH-NM       TO                         11510000
061300                                      DL06-A-VESSEL-NAME          11520000
061400     MOVE TR221-ERD-POE-DELY-DTE (5:2) TO                         11530000
061500                                      DL06-A-ETA-DTE-MM           11540000
061600     MOVE TR221-ERD-POE-DELY-DTE (7:2) TO                         11550000
061700                                      DL06-A-ETA-DTE-DD           11560000
061800     MOVE TR221-ERD-POE-DELY-DTE (1:4) TO                         11570000
061900                                      DL06-A-ETA-DTE-YY           11580000
062000                                                                  11590000
062100     IF TR221-ERD-POE-DELY-DTE (1:4) = '0001' OR                  11600000
062200       TR221-ERD-POE-DELY-DTE (1:4) = SPACES                      11610000
062300          MOVE SPACES TO DL06-A-ETA-SLASH-1                       11620000
062400                         DL06-A-ETA-SLASH-2                       11630000
062500                         DL06-A-ETA-DTE-MM                        11640000
062600                         DL06-A-ETA-DTE-DD                        11650000
062700                         DL06-A-ETA-DTE-YY                        11660000
062800     ELSE                                                         11670000
062900          MOVE '/'    TO DL06-A-ETA-SLASH-1                       11680000
063000                         DL06-A-ETA-SLASH-2                       11690000
063100     END-IF                                                       11700000
063200                                                                  11710000
063300     MOVE TR221-ERD-DPRTR-DTE (5:2)   TO                          11720000
063400                                      DL06-A-ETD-DTE-MM           11730000
063500     MOVE TR221-ERD-DPRTR-DTE (7:2)   TO                          11740000
063600                                      DL06-A-ETD-DTE-DD           11750000
063700     MOVE TR221-ERD-DPRTR-DTE (1:4)   TO                          11760000
063800                                      DL06-A-ETD-DTE-YY           11770000
063900                                                                  11780000
064000     IF TR221-ERD-DPRTR-DTE (1:4) = '0001' OR                     11790000
064100       TR221-ERD-DPRTR-DTE (1:4) = SPACES                         11800000
064200           MOVE SPACES TO DL06-A-ETD-SLASH-1                      11810000
064300                          DL06-A-ETD-SLASH-2                      11820000
064400                          DL06-A-ETD-DTE-MM                       11830000
064500                          DL06-A-ETD-DTE-DD                       11840000
064600                          DL06-A-ETD-DTE-YY                       11850000
064700     ELSE                                                         11860000
064800           MOVE '/'    TO DL06-A-ETD-SLASH-1                      11870000
064900                          DL06-A-ETD-SLASH-2                      11880000
065000     END-IF                                                       11890000
065200     MOVE TR221-ERD-FOB-CDE           TO                          11900000
065300                                      DL06-A-POL                  11910000
065400     MOVE TR221-ERD-DEST-POE-CDE      TO                          11920000
065500                                      DL06-A-POE.                 11930000
094114*                                                                 11940000
208200     PERFORM 3010-EDIT-POE-LBD                                    11950000
094114*                                                                 11960000
068000     MOVE TR221-ERD-EST-LBD-NM        TO                          11970000
                                            DL06-A-EST-LBD-DEST.        11980000
065501*                                                                 11990000
065502******************************************************************12000000
065503*MOVE ERDRSN DATA TO REPORT DETAIL LINE                           12010000
065504******************************************************************12020000
065505 3300-MOVE-ERDRSN-TO-DETAIL.                                      12030000
065506                                                                  12040000
065507     IF TR221-PO-NBR  = PV-PO-NBR                                 12050000
065508        SET PS-NOT-NEW-PO        TO TRUE                          12060000
065509     ELSE                                                         12070000
065510        SET PS-NEW-PO            TO TRUE                          12080000
065520        SET PS-ERDRSN-NO         TO TRUE                          12090000
065530     END-IF.                                                      12100000
065540                                                                  12110000
065550     IF TR221-PO-NBR NUMERIC                                      12120000
065560         MOVE TR221-PO-NBR        TO DL02-PO-NBR-9                12130000
065570     ELSE                                                         12140000
065580         MOVE TR221-PO-NBR-X      TO DL02-PO-NBR-X                12150000
065590     END-IF                                                       12160000
065600                                                                  12170000
065900                                                                  12180000
066000     MOVE TR221-REC-TYP-ERDRSN-CDE TO                             12190000
066100                                   PV-REC-TYP-CDE-PREV            12200000
066200                                   DL07-A-RECD-TYPE.              12210000
066300     MOVE TR221-TRN-TYP            TO                             12220000
066400                                   DL07-A-TRN-TYPE                12230000
066500     MOVE TR221-ERDRSN-IMPRT-TRIP-ID TO                           12240000
066600                                   DL07-A-VOYAGE-NBR              12250000
066700     MOVE TR221-ERDRSN-CARR-SCAC-ID TO                            12260000
066800                                   DL07-A-SCAC                    12270000
066900     MOVE TR221-ERDRSN-POE-DELY-DTE (5:2) TO                      12280000
067000                                   DL07-A-ETA-DTE-MM              12290000
067100     MOVE TR221-ERDRSN-POE-DELY-DTE (7:2) TO                      12300000
067200                                   DL07-A-ETA-DTE-DD              12310000
067300     MOVE TR221-ERDRSN-POE-DELY-DTE (1:4) TO                      12320000
067400                                   DL07-A-ETA-DTE-YY              12330000
067500                                                                  12340000
067600     IF TR221-ERDRSN-POE-DELY-DTE (1:4) = '0001' OR               12350000
067700       TR221-ERDRSN-POE-DELY-DTE (1:4) = SPACES                   12360000
067800          MOVE SPACES TO DL07-A-ETA-SLASH-1                       12370000
067900                         DL07-A-ETA-SLASH-2                       12380000
068000                         DL07-A-ETA-DTE-MM                        12390000
068100                         DL07-A-ETA-DTE-DD                        12400000
068200                         DL07-A-ETA-DTE-YY                        12410000
068300     ELSE                                                         12420000
068400          MOVE '/'    TO DL07-A-ETA-SLASH-1                       12430000
068500                         DL07-A-ETA-SLASH-2                       12440000
068600     END-IF                                                       12450000
068700                                                                  12460000
068800     MOVE TR221-ERDRSN-DPRTR-DTE (5:2) TO                         12470000
068900                                   DL07-A-ETD-DTE-MM              12480000
069000     MOVE TR221-ERDRSN-DPRTR-DTE (7:2) TO                         12490000
069100                                   DL07-A-ETD-DTE-DD              12500000
069200     MOVE TR221-ERDRSN-DPRTR-DTE (1:4) TO                         12510000
069300                                   DL07-A-ETD-DTE-YY              12520000
069400                                                                  12530000
069500     IF TR221-ERDRSN-DPRTR-DTE (1:4) = '0001' OR                  12540000
069600       TR221-ERDRSN-DPRTR-DTE (1:4) = SPACES                      12550000
069700          MOVE SPACES TO DL07-A-ETD-SLASH-1                       12560000
069800                         DL07-A-ETD-SLASH-2                       12570000
069900                         DL07-A-ETD-DTE-MM                        12580000
070000                         DL07-A-ETD-DTE-DD                        12590000
070100                         DL07-A-ETD-DTE-YY                        12600000
070200     ELSE                                                         12610000
070300          MOVE '/'    TO DL07-A-ETD-SLASH-1                       12620000
070400                         DL07-A-ETD-SLASH-2                       12630000
070500     END-IF                                                       12640000
070600                                                                  12650000
070700     MOVE TR221-ERDRSN-VOY-CHG-RSN-DESC TO                        12660000
070800                         DL07-A-VOYAGE-CHANGE.                    12670000
070900*                                                                 12680000
091702******************************************************************12690000
091703*3650-MOVE-ERROR-TO-DETAIL.                                       12700000
091704******************************************************************12710000
091705 3650-MOVE-ERROR-TO-DETAIL.                                       12720000
091706                                                                  12730000
091707     SET PS-NEW-PO               TO TRUE.                         12740000
091708     SET PS-ERD-NO               TO TRUE.                         12750000
091709     SET PS-LOG-NO               TO TRUE.                         12760000
091710*    SET PS-LOGVS-NO             TO TRUE.                         12770000
091720*    SET PS-LOGUPC-NO            TO TRUE.                         12780000
091730*    SET PS-ERDRSN-NO            TO TRUE.                         12790000
091760                                                                  12800000
091761                                                                  12810000
091762******************************************************************12820000
091763*MOVE WHS DATA TO REPORT DETAIL LINE                              12830000
091764                                                                  12840000
091765******************************************************************12850000
091766*  READ THE ERROR-FILE                                           *12860000
091767******************************************************************12870000
091768 7000-READ-ERROR-FILE.                                            12880000
091769                                                                  12890000
091770     READ ERROR-FILE                                              12900000
091771       INTO TR221-RECORD                                          12910000
091772         AT END                                                   12920000
091773           SET PS-EOF-ERROR-FILE TO TRUE.                         12930000
092320                                                                  12940000
092330     IF TR221-REC-TYP-HDR-CDE-HDR                                 12950000
092340        MOVE TR221-HDR-CONSOL-TRNS-DTE (5:2) TO                   12960000
092350             HL-TRANS-MM                                          12970000
092360        MOVE TR221-HDR-CONSOL-TRNS-DTE (7:2) TO                   12980000
092370             HL-TRANS-DD                                          12990000
092380        MOVE TR221-HDR-CONSOL-TRNS-DTE (3:2) TO                   13000000
092390             HL-TRANS-YY                                          13010000
092400        MOVE TR221-HDR-CONSOL-TRNS-TM (1:2) TO                    13020000
092500             HL-TRANS-TIME-HH                                     13030000
092600        MOVE TR221-HDR-CONSOL-TRNS-TM (3:2) TO                    13040000
092700             HL-TRANS-TIME-MM                                     13050000
092800        MOVE TR221-HDR-CONSOL-FIL-ID TO                           13060000
092900             HL1-FILE-ID                                          13070000
093000        MOVE TR221-HDR-LOAD-DTE (5:2) TO                          13080000
093100             HL-LOAD-MM                                           13090000
093200        MOVE TR221-HDR-LOAD-DTE (7:2) TO                          13100000
093300             HL-LOAD-DD                                           13110000
093400        MOVE TR221-HDR-LOAD-DTE (3:2) TO                          13120000
093500             HL-LOAD-YY                                           13130000
093600        MOVE TR221-HDR-LOAD-TM (1:2) TO                           13140000
093700             HL-LOAD-TIME-HH                                      13150000
093800        MOVE TR221-HDR-LOAD-TM (3:2) TO                           13160000
093900             HL-LOAD-TIME-MM                                      13170000
094000        MOVE TR221-HDR-CONSOL-ENTNME TO                           13180000
094100             HL1-EXPEDITOR                                        13190000
094101     END-IF.                                                      13200000
094102*                                                                 13210000
094103***************************************************************** 13220000
094104*  PRINT THE HEADINGS ON EACH PAGE.                             * 13230000
094105***************************************************************** 13240000
094106 8000-WRITE-PAGE-HEADINGS.                                        13250000
094107                                                                  13260000
094108     ADD 1                TO PV-PAGE-COUNT.                       13270000
094109     MOVE PV-PAGE-COUNT   TO DP132O-PAGE-NUMBER.                  13280000
094107*                                                                 13290000
094108     IF PV-PAGE-COUNT > 1                                         13300000
094107*                                                                 13310000
              PERFORM                                                   13320000
                  WITH TEST AFTER                                       13330000
                  VARYING PV-LINES-USED                                 13340000
                  FROM PV-LINES-USED BY 1                               13350000
                  UNTIL PV-LINES-USED GREATER THAN PC-PAGE-SIZE-060     13360000
094107*                                                                 13370000
                   IF PV-LINES-USED > PC-PAGE-SIZE-060                  13380000
                     WRITE ERROR-REPORT-RECORD                          13390000
                       FROM TRL-HEADING-LINE-1                          13400000
                         AFTER ADVANCING 2 LINES                        13410000
                   ELSE                                                 13420000
                     WRITE ERROR-REPORT-RECORD                          13430000
                       FROM PV-BLANK-LINE                               13440000
                         AFTER ADVANCING 1 LINE                         13450000
                   END-IF                                               13460000
094107*                                                                 13470000
              END-PERFORM                                               13480000
094107*                                                                 13490000
094108     END-IF.                                                      13500000
094110*                                                                 13510000
094111     WRITE ERROR-REPORT-RECORD                                    13520000
094112       FROM DP132O-STANDRD-HEADER-132-COLS                        13530000
094113         AFTER ADVANCING PAGE.                                    13540000
094114*                                                                 13550000
094115     MOVE PC-HEADING-SIZE TO PV-LINES-USED.                       13560000
065700     MOVE TR221-PO-NBR    TO       PV-PO-NBR                      13570000
065800     PERFORM 2060-SELECT-VENDOR-NAME.                             13580000
094116*                                                                 13590000
094117     WRITE ERROR-REPORT-RECORD                                    13600000
094118       FROM HL1-HEADING-LINE-1                                    13610000
094119         AFTER ADVANCING 1 LINE.                                  13620000
094120*                                                                 13630000
094121     WRITE ERROR-REPORT-RECORD                                    13640000
094122       FROM HL1-HEADING-LINE-2                                    13650000
094123         AFTER ADVANCING 1 LINE.                                  13660000
094124                                                                  13670000
094125     WRITE ERROR-REPORT-RECORD                                    13680000
094126       FROM HL2-HEADING-LINE-1                                    13690000
094127         AFTER ADVANCING 2 LINES.                                 13700000
094128                                                                  13710000
094129     WRITE ERROR-REPORT-RECORD                                    13720000
094130       FROM HL2-HEADING-LINE-2                                    13730000
094140         AFTER ADVANCING 1 LINES.                                 13740000
094150                                                                  13750000
094160     WRITE ERROR-REPORT-RECORD                                    13760000
094170       FROM DL-DETAIL-LINE-2                                      13770000
094171         AFTER ADVANCING 1 LINES.                                 13780000
094172*                                                                 13790000
094173     WRITE ERROR-REPORT-RECORD                                    13800000
094174       FROM PV-BLANK-LINE                                         13810000
094175         AFTER ADVANCING 1 LINES.                                 13820000
094178*                                                                 13830000
094179     INITIALIZE DP132O-LASER-NEW-PAGE-INDICATR.                   13840000
094180*                                                                 13850000
094181*8000-EXIT.                                                       13860000
094182*                                                                 13870000
094183******************************************************************13880000
094184*  WRITE THE ERROR REPORT DETAIL RECORD.                          13890000
094185******************************************************************13900000
094186 8100-WRITE-ERROR-RPT-DETAIL.                                     13910000
094187                                                                  13920000
094188                                                                  13930000
094189     IF TR221-REC-TYP-LOG-CDE-LOG                                 13940000
094190        PERFORM 8200-WRITE-LOG-RECORD                             13950000
094191     END-IF.                                                      13960000
094192                                                                  13970000
094193     IF TR221-REC-TYP-LOGVS-CDE-LOGVS                             13980000
094194        PERFORM 8250-WRITE-LOGVS-RECORD                           13990000
094195     END-IF.                                                      14000000
094200                                                                  14010000
094300     IF TR221-REC-TYP-LOGUPC-CD-LOGUPC                            14020000
094400        PERFORM 8300-WRITE-LOGUPC-RECORD                          14030000
094500     END-IF.                                                      14040000
094600                                                                  14050000
094700     IF TR221-REC-TYP-ERD-CDE-ERD                                 14060000
094800        PERFORM 8350-WRITE-ERD-RECORD                             14070000
094900     END-IF.                                                      14080000
095000                                                                  14090000
095100     IF TR221-REC-TYP-ERDRSN-CD-ERDRSN                            14100000
095200        PERFORM 8400-WRITE-ERDRSN-RECORD                          14110000
095300     END-IF.                                                      14120000
095400                                                                  14130000
098000     IF NOT TR221-REC-TYP-LOG-CDE-LOG AND                         14140000
098100        NOT TR221-REC-TYP-LOGVS-CDE-LOGVS AND                     14150000
098200        NOT TR221-REC-TYP-LOGUPC-CD-LOGUPC AND                    14160000
098300        NOT TR221-REC-TYP-ERD-CDE-ERD AND                         14170000
098400        NOT TR221-REC-TYP-ERDRSN-CD-ERDRSN                        14180000
098900        PERFORM 8750-WRITE-ERROR-RECORD                           14190000
099000     END-IF.                                                      14200000
099100                                                                  14210000
099101     IF PV-LINES-USED >= PC-PAGE-SIZE-060                         14220000
099102        SET PS-NEW-PAGE  TO TRUE                                  14230000
099103        SET PS-ERDRSN-NO TO TRUE                                  14240000
099109     END-IF.                                                      14250000
099110*                                                                 14260000
099111*8100-EXIT.                                                       14270000
099112*                                                                 14280000
099113******************************************************************14290000
099114*  WRITE THE ERROR REPORT DETAIL RECORD.                          14300000
099115******************************************************************14310000
099116 8150-WRITE-ERROR-RPT-DETAIL.                                     14320000
099117                                                                  14330000
099118     IF PV-LOG-REC-TYP-CDE-LOG                                    14340000
099119        PERFORM 8200-WRITE-LOG-RECORD                             14350000
099120     END-IF.                                                      14360000
099130                                                                  14370000
099140     IF PV-LOGVS-REC-TYP-CDE-LOGVS                                14380000
099150        PERFORM 8250-WRITE-LOGVS-RECORD                           14390000
099160     END-IF.                                                      14400000
099170                                                                  14410000
099180     IF PV-LOGUPC-REC-TYP-CDE-LOGUPC                              14420000
099190        PERFORM 8300-WRITE-LOGUPC-RECORD                          14430000
099200     END-IF.                                                      14440000
099300                                                                  14450000
099400     IF PV-ERD-REC-TYP-CDE-ERD                                    14460000
099500        PERFORM 8350-WRITE-ERD-RECORD                             14470000
099600     END-IF.                                                      14480000
099700                                                                  14490000
099800     IF PV-ERDRSN-REC-TYP-CD-ERDRSN                               14500000
099900        PERFORM 8400-WRITE-ERDRSN-RECORD                          14510000
100000     END-IF.                                                      14520000
100001                                                                  14530000
100002*    IF PV-LINES-USED > PC-PAGE-SIZE-051 AND                      14540000
100003     IF PV-LINES-USED > PC-PAGE-SIZE-060                          14550000
100004        SET PS-NEW-PAGE  TO TRUE                                  14560000
100005        SET PS-ERD-NO TO TRUE                                     14570000
100006        SET PS-LOG-NO TO TRUE                                     14580000
100007        SET PS-LOGVS-NO TO TRUE                                   14590000
100008        SET PS-LOGUPC-NO TO TRUE                                  14600000
100009        SET PS-ERDRSN-NO TO TRUE                                  14610000
100010        PERFORM 8000-WRITE-PAGE-HEADINGS                          14620000
100011     END-IF.                                                      14630000
100012*                                                                 14640000
100013*8150-EXIT.                                                       14650000
100014*                                                                 14660000
100015******************************************************************14670000
100016*  PRINT LOG ERROR RECORD                                         14680000
100017******************************************************************14690000
100018 8200-WRITE-LOG-RECORD.                                           14700000
100019                                                                  14710000
100020     IF PS-ERD-YES AND                                            14720000
100030       NOT PS-NEW-PAGE                                            14730000
100040        MOVE SPACES TO HL3-TYPE-1-LNE-1                           14740000
100050                       HL3-TYPE-1-LNE-2                           14750000
100060                       HL3-TYPE-2-LNE-1                           14760000
100070                       HL3-TYPE-2-LNE-2                           14770000
100080     ELSE                                                         14780000
100090        MOVE 'RECD' TO HL3-TYPE-1-LNE-1                           14790000
100100        MOVE 'TYPE' TO HL3-TYPE-1-LNE-2                           14800000
100200        MOVE 'TRN'  TO HL3-TYPE-2-LNE-1                           14810000
100300        MOVE 'TYPE' TO HL3-TYPE-2-LNE-2                           14820000
100400     END-IF.                                                      14830000
100500                                                                  14840000
100600     WRITE ERROR-REPORT-RECORD                                    14850000
100700         FROM HL3-HEADING-LINE-1                                  14860000
100800             AFTER ADVANCING 2 LINES.                             14870000
100900                                                                  14880000
101000     WRITE ERROR-REPORT-RECORD                                    14890000
101100         FROM HL3-HEADING-LINE-2                                  14900000
101200             AFTER ADVANCING 1 LINES.                             14910000
101300                                                                  14920000
101400     WRITE ERROR-REPORT-RECORD                                    14930000
101500         FROM DL-DETAIL-LINE-3                                    14940000
101600             AFTER ADVANCING 1 LINES.                             14950000
101700                                                                  14960000
101800     ADD 4 TO PV-LINES-USED.                                      14970000
101900                                                                  14980000
102000     SET PS-LOG-YES TO TRUE.                                      14990000
102100     SET PS-NOT-NEW-PAGE TO TRUE.                                 15000000
102101                                                                  15010000
102102******************************************************************15020000
102103*  PRINT LOGVS ERROR RECORD                                       15030000
102104******************************************************************15040000
102105 8250-WRITE-LOGVS-RECORD.                                         15050000
102106                                                                  15060000
102107     IF PS-LOGVS-YES AND                                          15070000
102108       PS-NOT-NEW-PAGE                                            15080000
102109        MOVE SPACES TO HL4-TYPE-1-LNE-1                           15090000
102110                       HL4-TYPE-1-LNE-2                           15100000
102120                       HL4-TYPE-2-LNE-1                           15110000
102130                       HL4-TYPE-2-LNE-2                           15120000
102140     ELSE                                                         15130000
102150        MOVE 'RECD' TO HL4-TYPE-1-LNE-1                           15140000
102160        MOVE 'TYPE' TO HL4-TYPE-1-LNE-2                           15150000
102170        MOVE 'TRN'  TO HL4-TYPE-2-LNE-1                           15160000
102180        MOVE 'TYPE' TO HL4-TYPE-2-LNE-2                           15170000
102190     END-IF.                                                      15180000
102200                                                                  15190000
102300     WRITE ERROR-REPORT-RECORD                                    15200000
102400         FROM HL4-HEADING-LINE-1                                  15210000
102500     AFTER ADVANCING 2 LINES.                                     15220000
102600                                                                  15230000
102700     WRITE ERROR-REPORT-RECORD                                    15240000
102800         FROM HL4-HEADING-LINE-2                                  15250000
102900     AFTER ADVANCING 1 LINES.                                     15260000
103000                                                                  15270000
103100     WRITE ERROR-REPORT-RECORD                                    15280000
103200         FROM DL-DETAIL-LINE-4                                    15290000
103300     AFTER ADVANCING 1 LINES.                                     15300000
103400                                                                  15310000
103500     ADD 4 TO PV-LINES-USED.                                      15320000
103600                                                                  15330000
103700     SET PS-LOGVS-YES TO TRUE.                                    15340000
103800     SET PS-NOT-NEW-PAGE TO TRUE.                                 15350000
103801                                                                  15360000
103802******************************************************************15370000
103803*  PRINT LOGUPC ERROR RECORD                                      15380000
103804******************************************************************15390000
103805 8300-WRITE-LOGUPC-RECORD.                                        15400000
103806                                                                  15410000
103807     IF PS-LOGUPC-YES AND                                         15420000
103808       NOT PS-NEW-PAGE                                            15430000
103809        MOVE SPACES TO HL5-RECD                                   15440000
103810        MOVE SPACES TO HL5-TRN                                    15450000
103820        MOVE SPACES TO HL5-TYPE-1                                 15460000
103830                       HL5-TYPE-2                                 15470000
103840     ELSE                                                         15480000
103850        MOVE 'RECD' TO HL5-RECD                                   15490000
103860        MOVE 'TRN'  TO HL5-TRN                                    15500000
103870        MOVE 'TYPE' TO HL5-TYPE-1                                 15510000
103880                       HL5-TYPE-2                                 15520000
103890     END-IF.                                                      15530000
103900                                                                  15540000
104000     WRITE ERROR-REPORT-RECORD                                    15550000
104100         FROM HL5-HEADING-LINE-1                                  15560000
104200     AFTER ADVANCING 2 LINES.                                     15570000
104300                                                                  15580000
104400     WRITE ERROR-REPORT-RECORD                                    15590000
104500         FROM HL5-HEADING-LINE-2                                  15600000
104600     AFTER ADVANCING 1 LINES.                                     15610000
104700                                                                  15620000
104800     WRITE ERROR-REPORT-RECORD                                    15630000
104900         FROM DL-DETAIL-LINE-5                                    15640000
105000     AFTER ADVANCING 1 LINES.                                     15650000
105100                                                                  15660000
105200*                                                                 15670000
105300     ADD 4 TO PV-LINES-USED.                                      15680000
105400                                                                  15690000
105500     SET PS-LOGUPC-YES TO TRUE.                                   15700000
105600     SET PS-NOT-NEW-PAGE TO TRUE.                                 15710000
105601                                                                  15720000
105602******************************************************************15730000
105603*  PRINT ERD ERROR RECORD                                         15740000
105604******************************************************************15750000
105605 8350-WRITE-ERD-RECORD.                                           15760000
105606                                                                  15770000
105607     IF (PS-ERD-YES OR                                            15780000
105608       PS-LOG-YES) AND                                            15790000
105609       NOT PS-NEW-PAGE                                            15800000
105610        MOVE SPACES TO HL6-RECD                                   15810000
105620        MOVE SPACES TO HL6-TRN                                    15820000
105630        MOVE SPACES TO HL6-TYPE-1                                 15830000
105640                       HL6-TYPE-2                                 15840000
105650     ELSE                                                         15850000
105660        MOVE 'RECD' TO HL6-RECD                                   15860000
105670        MOVE 'TRN'  TO HL6-TRN                                    15870000
105680        MOVE 'TYPE' TO HL6-TYPE-1                                 15880000
105690                       HL6-TYPE-2                                 15890000
105700     END-IF.                                                      15900000
105800                                                                  15910000
105900     WRITE ERROR-REPORT-RECORD                                    15920000
106000         FROM HL6-HEADING-LINE-1                                  15930000
106100     AFTER ADVANCING 2 LINES.                                     15940000
106200                                                                  15950000
106300     WRITE ERROR-REPORT-RECORD                                    15960000
106400         FROM HL6-HEADING-LINE-2-A                                15970000
106500     AFTER ADVANCING 1 LINES.                                     15980000
106600                                                                  15990000
106700     WRITE ERROR-REPORT-RECORD                                    16000000
106800         FROM DL-DETAIL-LINE-6-A                                  16010000
106900     AFTER ADVANCING 1 LINES.                                     16020000
107000                                                                  16030000
107100     ADD 4 TO PV-LINES-USED.                                      16040000
107200                                                                  16050000
107300     SET PS-ERD-YES TO TRUE.                                      16060000
107400     SET PS-NOT-NEW-PAGE TO TRUE.                                 16070000
107401                                                                  16080000
107402******************************************************************16090000
107403*  PRINT ERDRSN ERROR RECORD                                      16100000
107404******************************************************************16110000
107405 8400-WRITE-ERDRSN-RECORD.                                        16120000
107406                                                                  16130000
107407     IF PS-LOG-YES OR                                             16140000
107408       PS-LOGVS-YES OR                                            16150000
107409       PS-LOGUPC-YES OR                                           16160000
107410       PS-ERDRSN-YES AND                                          16170000
107420       NOT PS-NEW-PAGE                                            16180000
107430        MOVE SPACES TO HL7-RECD                                   16190000
107440        MOVE SPACES TO HL7-TRN                                    16200000
107450        MOVE SPACES TO HL7-TYPE-1                                 16210000
107460                       HL7-TYPE-2                                 16220000
107470     ELSE                                                         16230000
107480        MOVE 'RECD' TO HL7-RECD                                   16240000
107490        MOVE 'TRN'  TO HL7-TRN                                    16250000
107500        MOVE 'TYPE' TO HL7-TYPE-1                                 16260000
107600                       HL7-TYPE-2                                 16270000
107601     END-IF.                                                      16280000
107602                                                                  16290000
107603     WRITE ERROR-REPORT-RECORD                                    16300000
107604           FROM HL7-HEADING-LINE-1                                16310000
107605     AFTER ADVANCING 2 LINES                                      16320000
107606                                                                  16330000
107607     WRITE ERROR-REPORT-RECORD                                    16340000
107608           FROM HL7-HEADING-LINE-2                                16350000
107609     AFTER ADVANCING 1 LINES.                                     16360000
107610                                                                  16370000
107620     WRITE ERROR-REPORT-RECORD                                    16380000
107630           FROM DL-DETAIL-LINE-7                                  16390000
107640     AFTER ADVANCING 1 LINES.                                     16400000
107650                                                                  16410000
107660                                                                  16420000
107670     ADD 4 TO PV-LINES-USED.                                      16430000
107680                                                                  16440000
107690     SET PS-ERDRSN-YES TO TRUE.                                   16450000
107700     SET PS-NOT-NEW-PAGE TO TRUE.                                 16460000
107800                                                                  16470000
145101*                                                                 16480000
145102******************************************************************16490000
145103*  PRINT ERROR  ERROR RECORD                                      16500000
145104******************************************************************16510000
145105 8750-WRITE-ERROR-RECORD.                                         16520000
145106                                                                  16530000
145107      IF  PS-NEW-PAGE OR                                          16540000
145108          PS-ERD-NO OR                                            16550000
145109          PS-NEW-PO                                               16560000
145110            WRITE ERROR-REPORT-RECORD                             16570000
145120                  FROM HL6-HEADING-LINE-1                         16580000
145130            AFTER ADVANCING 2 LINES                               16590000
145140                                                                  16600000
145150            SET PS-NOT-NEW-PAGE TO TRUE                           16610000
145160                                                                  16620000
145170            ADD 2 TO PV-LINES-USED                                16630000
145180     END-IF.                                                      16640000
145190                                                                  16650000
145200     WRITE ERROR-REPORT-RECORD                                    16660000
145300         FROM HL2-HEADING-LINE-1                                  16670000
145400             AFTER ADVANCING 2 LINES.                             16680000
146300                                                                  16690000
146400     ADD 2 TO PV-LINES-USED.                                      16700000
146401                                                                  16710000
146402******************************************************************16720000
146403*  PRINT END OF REPORT MESSAGE, CLOSE THE OUTPUT FILE, AND CLOSE  16730000
146404*  THE CURSOR.                                                    16740000
146405******************************************************************16750000
146406 9000-EOJ-ROUTINE.                                                16760000
146407                                                                  16770000
146408     IF NOT TR221-RPT-TYP-DETAIL AND                              16780000
146409       TR221-RPT-TYP NOT = SPACES                                 16790000
146410        PERFORM  8150-WRITE-ERROR-RPT-DETAIL                      16800000
146411     END-IF.                                                      16810000
146412                                                                  16820000
146413     ADD 2 TO PV-LINES-USED.                                      16830000
146414                                                                  16840000
146415     IF PV-LINES-USED > PC-PAGE-SIZE-060                          16850000
146416        PERFORM 8000-WRITE-PAGE-HEADINGS                          16860000
146417     END-IF.                                                      16870000
146418                                                                  16880000
146419     WRITE ERROR-REPORT-RECORD                                    16890000
146420         FROM ER-END-OF-REPORT-LINE                               16900000
146421             AFTER ADVANCING 2 LINES.                             16910000
146422                                                                  16920000
146423     CLOSE ERROR-FILE                                             16930000
146424           ERROR-REPORT-FILE.                                     16940000
146425*                                                                 16950000
146426*9000-EXIT.                                                       16960000
146427*                                                                 16970000
146428******************************************************************16980000
146429*  PRINTS REPORT MESSAGE IF THERE IS NO DATA ON THE FILE          16990000
146430******************************************************************17000000
146431 9100-EOJ-ROUTINE.                                                17010000
146432**                                                                17020000
146433**   PERFORM 8000-WRITE-PAGE-HEADINGS.                            17030000
146434**                                                                17040000
146435     WRITE ERROR-REPORT-RECORD                                    17050000
146436         FROM EP-EMPTY-REPORT-LINE                                17060000
146437             AFTER ADVANCING 2 LINES.                             17070000
146438                                                                  17080000
146439                                                                  17090000
146440     WRITE ERROR-REPORT-RECORD                                    17100000
146441         FROM ER-END-OF-REPORT-LINE                               17110000
146442             AFTER ADVANCING 2 LINES.                             17120000
146443                                                                  17130000
146444     CLOSE ERROR-FILE                                             17140000
146445           ERROR-REPORT-FILE.                                     17150000
146446*                                                                 17160000
146447*9100-EXIT.                                                       17170000
146448                                                                  17180000
