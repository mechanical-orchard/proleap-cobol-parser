      ******************************************************************00010019
       IDENTIFICATION DIVISION.                                         00020019
      ******************************************************************00030019
                                                                        00040019
       PROGRAM-ID.             TFKRP497.                                00050019
       AUTHOR.                 WILLIAM B. BURT.                         00060019
       INSTALLATION.           KOHLS.                                   00070019
       DATE-WRITTEN            JULY, 1997.                              00080019
       DATE-COMPILED.                                                   00090019
                                                                        00100019
      ******************************************************************00110019
      *      THIS PROGRAM PRODUCES THE TRANSFER DISCREPANCY RECAP REPORT00120019
      *  FOR A USER SPECIFIED TIME PERIOD.                              00130019
      ******************************************************************00140019
100404** 10/04/2004 CHANGED BY: RAY GRAF                                00141020
100404**     EXPAND STORE NUMBER. MAKE DOMAIN COMPLIANT.                00142020
      ***************************************************************** 00143020
                                                                        00150019
      ******************************************************************00160019
       ENVIRONMENT DIVISION.                                            00170019
      ******************************************************************00180019
                                                                        00190019
       CONFIGURATION SECTION.                                           00200019
                                                                        00210019
       SOURCE-COMPUTER.        IBM-3090.                                00220019
       OBJECT-COMPUTER.        IBM-3090.                                00230019
                                                                        00240019
       INPUT-OUTPUT SECTION.                                            00250019
                                                                        00260019
       FILE-CONTROL.                                                    00270019
                                                                        00280019
           SELECT PROCESS-DATES-FILE                                    00290019
               ASSIGN TO INP01.                                         00300019
                                                                        00310019
           SELECT STR-TOT-DISCREPANCY-FILE                              00320019
               ASSIGN TO INP02.                                         00330019
                                                                        00340019
           SELECT XFER-DISCREPANCY-RECAP-REPORT                         00350019
               ASSIGN TO RPT01.                                         00360019
                                                                        00370019
      ******************************************************************00380019
       DATA DIVISION.                                                   00390019
      ******************************************************************00400019
                                                                        00410019
       FILE SECTION.                                                    00420019
                                                                        00430019
       FD  PROCESS-DATES-FILE                                           00440019
           RECORDING MODE IS F                                          00450019
           LABEL RECORDS ARE STANDARD                                   00460019
           BLOCK CONTAINS 0 RECORDS.                                    00470019
                                                                        00480019
       01  PROCESS-DATES-RECORD                PIC  X(16).              00490019
                                                                        00500019
       FD  STR-TOT-DISCREPANCY-FILE                                     00510019
           RECORDING MODE IS F                                          00520019
           LABEL RECORDS ARE STANDARD                                   00530019
           BLOCK CONTAINS 0 RECORDS.                                    00540019
                                                                        00550019
       01  STR-TOT-DISCREPANCY-RECORD          PIC  X(39).              00560025
                                                                        00570019
       FD  XFER-DISCREPANCY-RECAP-REPORT                                00580019
           RECORDING MODE IS F                                          00590019
           LABEL RECORDS ARE STANDARD                                   00600019
           BLOCK CONTAINS 0 RECORDS.                                    00610019
                                                                        00620019
       01  XFER-DISCREPANCY-RECAP-LINE         PIC X(132).              00630019
                                                                        00640019
      ******************************************************************00650019
       WORKING-STORAGE SECTION.                                         00660019
      ******************************************************************00670019
                                                                        00680019
      *                                                                 00690019
      *  STANDARD REPORT HEADER FOR 132 COLUMN REPORT                   00700019
      *                                                                 00710019
           COPY DPWS132O.                                               00720019
                                                                        00730019
      *                                                                 00740019
      *  RECORD LAYOUT FOR THE PROCESS DATES FILE                       00750019
      *                                                                 00760019
           COPY TFRD029.                                                00770019
                                                                        00780019
      *                                                                 00790019
      *  RECORD LAYOUT FOR THE STORE TOTAL DISCREPANCY FILE             00800019
      *                                                                 00810019
           COPY TFRD037.                                                00820019
                                                                        00830019
       01  CD-CURRENT-DATE.                                             00840019
           05  CD-CURRENT-YEAR                 PIC  9(02)  VALUE ZEROS. 00850019
           05  CD-CURRENT-MONTH                PIC  9(02)  VALUE ZEROS. 00860019
           05  CD-CURRENT-DAY                  PIC  9(02)  VALUE ZEROS. 00870019
                                                                        00880019
       01  CT-CURRENT-TIME.                                             00890019
           05  CT-CURRENT-HOUR                 PIC  9(02)  VALUE ZEROS. 00900019
           05  CT-CURRENT-MINUTE               PIC  9(02)  VALUE ZEROS. 00910019
           05  FILLER                          PIC  9(04)  VALUE ZEROS. 00920019
                                                                        00930019
       01  CK-CURRENT-KEY-AREA.                                         00940019
           05  CK-DISTRICT-NBR                 PIC  X(04)  VALUE SPACE. 00950024
                                                                        00960019
       01  DA-DETAIL-ACCUMULATORS.                                      00970019
           05  DA-XFERS-WITH-DSCRPS            PIC  9(08)  VALUE ZEROS. 00980019
           05  DA-ADJ-UNITS                    PIC  9(09)  VALUE ZEROS. 00990019
           05  DA-ADJ-RTL                      PIC S9(11)V99            01000019
                                                           VALUE ZEROS  01010019
                                                           COMP-3.      01020019
                                                                        01030019
       01  DL-DETAIL-LINE.                                              01040019
100404*    05  FILLER                          PIC  X(04)  VALUE SPACE. 01050021
100404     05  FILLER                          PIC  X(03)  VALUE SPACE. 01051021
100404*    05  DL-FROM-STR-NBR                 PIC  X(03)  VALUE SPACE. 01060021
100404     05  DL-FROM-STR-NBR                 PIC  9(04)  VALUE ZEROS. 01061023
           05  FILLER                          PIC  X(01)  VALUE SPACE. 01070019
           05  DL-FROM-STR-NAME                PIC  X(10)  VALUE SPACE. 01080019
           05  FILLER                          PIC  X(13)  VALUE SPACE. 01090019
           05  DL-TOT-XFERS-WITH-DSCRPS        PIC  ZZZ,ZZ9             01100019
                                                           VALUE ZEROS. 01110019
           05  FILLER                          PIC  X(04)  VALUE SPACE. 01120019
           05  DL-ADJ-UNITS                    PIC  ZZ,ZZZ,ZZ9          01130019
                                                           VALUE ZEROS. 01140019
           05  FILLER                          PIC  X(05)  VALUE SPACE. 01150019
           05  DL-ADJ-RTL                      PIC  ZZZ,ZZZ,ZZ9.99-     01160019
                                                           VALUE ZEROS. 01170019
           05  FILLER                          PIC  X(60)  VALUE SPACE. 01180019
                                                                        01190019
       01  DT-DISTRICT-TOTAL.                                           01200019
           05  FILLER                          PIC  X(03)  VALUE SPACE. 01210019
           05  FILLER                          PIC  X(08)  VALUE        01220019
               'DISTRICT'.                                              01230019
           05  FILLER                          PIC  X(01)  VALUE SPACE. 01240019
           05  DT-DISTRICT-NBR                 PIC  X(04)  VALUE SPACE. 01250024
           05  FILLER                          PIC  X(01)  VALUE SPACE. 01260019
           05  FILLER                          PIC  X(06)  VALUE        01270019
               'TOTALS'.                                                01280019
           05  FILLER                          PIC  X(05)  VALUE SPACE. 01290026
           05  DT-XFERS-WITH-DSCRPS            PIC  ZZ,ZZZ,ZZ9          01300019
                                                           VALUE ZEROS. 01310019
           05  FILLER                          PIC  X(03)  VALUE SPACE. 01320019
           05  DT-ADJ-UNITS                    PIC  ZZZ,ZZZ,ZZ9         01330019
                                                           VALUE ZEROS. 01340019
           05  FILLER                          PIC  X(03)  VALUE SPACE. 01350019
           05  DT-ADJ-RTL                      PIC  Z,ZZZ,ZZZ,ZZ9.99-   01360019
                                                           VALUE ZEROS. 01370019
           05  FILLER                          PIC  X(60)  VALUE SPACE. 01380019
                                                                        01390019
       01  END-OF-REPORT-LINE.                                          01400019
           05  FILLER                          PIC  X(54)  VALUE SPACE. 01410019
           05  FILLER                          PIC  X(25)  VALUE        01420019
               '***** END OF REPORT *****'.                             01430019
           05  FILLER                          PIC  X(53)  VALUE SPACE. 01440019
                                                                        01450019
       01  FT-FINAL-TOTAL.                                              01460019
           05  FILLER                          PIC  X(03)  VALUE SPACE. 01470019
           05  FILLER                          PIC  X(14)  VALUE        01480019
               'COMPANY TOTALS'.                                        01490019
           05  FILLER                          PIC  X(10)  VALUE SPACE. 01500019
           05  FT-XFERS-WITH-DSCRPS            PIC  ZZZ,ZZZ,ZZ9         01510019
                                                           VALUE ZEROS. 01520019
           05  FILLER                          PIC  X(03)  VALUE SPACE. 01530019
           05  FT-ADJ-UNITS                    PIC  ZZZ,ZZZ,ZZ9         01540019
                                                           VALUE ZEROS. 01550019
           05  FILLER                          PIC  X(02)  VALUE SPACE. 01560019
           05  FT-ADJ-RTL                      PIC  ZZ,ZZZ,ZZZ,ZZ9.99-  01570019
                                                           VALUE ZEROS. 01580019
           05  FILLER                          PIC  X(60)  VALUE SPACE. 01590019
                                                                        01600019
       01  HL1-HEADING-LINE-1.                                          01610019
           05  FILLER                          PIC  X(50)  VALUE SPACE. 01620019
           05  FILLER                          PIC  X(33)  VALUE        01630019
               'TRANSFER DISCREPANCY RECAP REPORT'.                     01640019
           05  FILLER                          PIC  X(49)  VALUE SPACE. 01650019
                                                                        01660019
       01  HL2-HEADING-LINE-2.                                          01670019
           05  FILLER                          PIC  X(49)  VALUE SPACE. 01680019
           05  FILLER                          PIC  X(10)  VALUE        01690019
               'FOR PERIOD'.                                            01700019
           05  FILLER                          PIC  X(01)  VALUE SPACE. 01710019
           05  HL2-PERIOD-START-DTE.                                    01720019
               10  HL2-PERIOD-START-MONTH      PIC  9(02)  VALUE ZEROS. 01730019
               10  FILLER                      PIC  X(01)  VALUE '/'.   01740019
               10  HL2-PERIOD-START-DAY        PIC  9(02)  VALUE ZEROS. 01750019
               10  FILLER                      PIC  X(01)  VALUE '/'.   01760019
               10  HL2-PERIOD-START-CENTURY    PIC  9(02)  VALUE ZEROS. 01770019
               10  HL2-PERIOD-START-YEAR       PIC  9(02)  VALUE ZEROS. 01780019
           05  FILLER                          PIC  X(01)  VALUE SPACE. 01790019
           05  FILLER                          PIC  X(02)  VALUE        01800019
               'TO'.                                                    01810019
           05  FILLER                          PIC  X(01)  VALUE SPACE. 01820019
           05  HL2-PERIOD-END-DTE.                                      01830019
               10  HL2-PERIOD-END-MONTH        PIC  9(02)  VALUE ZEROS. 01840019
               10  FILLER                      PIC  X(01)  VALUE '/'.   01850019
               10  HL2-PERIOD-END-DAY          PIC  9(02)  VALUE ZEROS. 01860019
               10  FILLER                      PIC  X(01)  VALUE '/'.   01870019
               10  HL2-PERIOD-END-CENTURY      PIC  9(02)  VALUE ZEROS. 01880019
               10  HL2-PERIOD-END-YEAR         PIC  9(02)  VALUE ZEROS. 01890019
           05  FILLER                          PIC  X(48)  VALUE SPACE. 01900019
                                                                        01910019
       01  HL3-HEADING-LINE-3.                                          01920019
           05  FILLER                          PIC  X(24)  VALUE SPACE. 01930019
           05  FILLER                          PIC  X(14)  VALUE        01940019
               '# OF TRANSFERS'.                                        01950019
           05  FILLER                          PIC  X(06)  VALUE SPACE. 01960019
           05  FILLER                          PIC  X(08)  VALUE        01970019
               'ADJUSTED'.                                              01980019
           05  FILLER                          PIC  X(08)  VALUE SPACE. 01990019
           05  FILLER                          PIC  X(12)  VALUE        02000019
               'NET ADJUSTED'.                                          02010019
           05  FILLER                          PIC  X(60)  VALUE SPACE. 02020019
                                                                        02030019
       01  HL4-HEADING-LINE-4.                                          02040019
           05  FILLER                          PIC  X(04)  VALUE SPACE. 02050019
           05  FILLER                          PIC  X(13)  VALUE        02060019
               'SENDING STORE'.                                         02070019
           05  FILLER                          PIC  X(06)  VALUE SPACE. 02080019
           05  FILLER                          PIC  X(15)  VALUE        02090019
               'W/DISCREPANCIES'.                                       02100019
           05  FILLER                          PIC  X(07)  VALUE SPACE. 02110019
           05  FILLER                          PIC  X(05)  VALUE        02120019
               'UNITS'.                                                 02130019
           05  FILLER                          PIC  X(11)  VALUE SPACE. 02140019
           05  FILLER                          PIC  X(09)  VALUE        02150019
               'INVENTORY'.                                             02160019
           05  FILLER                          PIC  X(62)  VALUE SPACE. 02170019
                                                                        02180019
       01  PC-PROGRAM-CONSTANTS.                                        02190019
           05  PC-CURRENT-PROGRAM-NAME         PIC  X(08)  VALUE        02200019
               'TFKRP497'.                                              02210019
           05  PC-ONE                          PIC  9(01)  VALUE 1.     02220019
           05  PC-PAGE-SIZE                    PIC S9(04)  VALUE +64    02230019
                                                           COMP SYNC.   02240019
           05  PC-LINES-NEEDED-FOR-TOTALS      PIC S9(04)  VALUE +2     02250019
                                                           COMP SYNC.   02260019
                                                                        02270019
       01  NO-DATA-LINE.                                                02280019
           05  FILLER                          PIC  X(52)  VALUE SPACE. 02290019
           05  FILLER                          PIC  X(28)  VALUE        02300019
               'NO DATA FOR REQUESTED PERIOD'.                          02310019
           05  FILLER                          PIC  X(52)  VALUE SPACE. 02320019
                                                                        02330019
       01  PS-PROGRAM-SWITCHES.                                         02340019
           05  PS-END-OF-STR-TOT-FILE-IND      PIC  X(01)  VALUE 'N'.   02350019
               88  PS-END-OF-STR-TOT-FILE                  VALUE 'Y'.   02360019
                                                                        02370019
       01  PV-PROGRAM-VARIABLES.                                        02380019
           05  PV-PAGE-COUNT                   PIC S9(04)  VALUE +0     02390019
                                                           COMP.        02400019
           05  PV-LINE-COUNT                   PIC S9(04)  VALUE +0     02410019
                                                           COMP.        02420019
           05  PV-ADVANCE-COUNT                PIC S9(04)  VALUE +0     02430019
                                                           COMP.        02440019
                                                                        02450019
       01  TA-TOTAL-ACCUMULATORS.                                       02460019
           05  TA-XFERS-WITH-DSCRPS            PIC  9(09)  VALUE ZEROS. 02470019
           05  TA-ADJ-UNITS                    PIC  9(09)  VALUE ZEROS. 02480019
           05  TA-ADJ-RTL                      PIC S9(11)V99            02490019
                                                           VALUE ZEROS  02500019
                                                           COMP-3.      02510019
                                                                        02520019
      ******************************************************************02530019
       PROCEDURE DIVISION.                                              02540019
      ******************************************************************02550019
                                                                        02560019
      ******************************************************************02570019
      *  0000-MAINLINE - CONTROLS THE MAIN PROCESSING OF THE PROGRAM    02580019
      ******************************************************************02590019
       0000-PROGRAM-MAINLINE.                                           02600019
           PERFORM 1000-INITIALIZE.                                     02610019
                                                                        02620019
           PERFORM 2000-CREATE-DISCRP-RECAP-RPT                         02630019
               UNTIL  PS-END-OF-STR-TOT-FILE.                           02640019
                                                                        02650019
           PERFORM 9000-EOJ-ROUTINE.                                    02660019
                                                                        02670019
           STOP RUN.                                                    02680019
      *                                                                 02690019
       1000-INITIALIZE.                                                 02700019
           ACCEPT CD-CURRENT-DATE       FROM  DATE.                     02710019
           MOVE CD-CURRENT-YEAR             TO  DP132O-RUN-YEAR.        02720019
           MOVE CD-CURRENT-MONTH            TO  DP132O-RUN-MONTH.       02730019
           MOVE CD-CURRENT-DAY              TO  DP132O-RUN-DAY.         02740019
                                                                        02750019
           ACCEPT CT-CURRENT-TIME       FROM  TIME.                     02760019
           MOVE CT-CURRENT-HOUR             TO  DP132O-RUN-HOUR.        02770019
           MOVE CT-CURRENT-MINUTE           TO  DP132O-RUN-MINUTE.      02780019
                                                                        02790019
           MOVE PC-CURRENT-PROGRAM-NAME     TO  DP132O-PROGRAM-NAME.    02800019
           MOVE PC-ONE                      TO  DP132O-REPORT-NUMBER.   02810019
                                                                        02820019
           OPEN  INPUT PROCESS-DATES-FILE                               02830019
                       STR-TOT-DISCREPANCY-FILE                         02840019
                OUTPUT XFER-DISCREPANCY-RECAP-REPORT.                   02850019
                                                                        02860019
           PERFORM 7000-READ-PROCESS-DATES-FILE.                        02870019
                                                                        02880019
           MOVE TF029-PROCESS-START-MONTH   TO HL2-PERIOD-START-MONTH.  02890019
           MOVE TF029-PROCESS-START-DAY     TO HL2-PERIOD-START-DAY.    02900019
           MOVE TF029-PROCESS-START-CENTURY TO HL2-PERIOD-START-CENTURY.02910019
           MOVE TF029-PROCESS-START-YEAR    TO HL2-PERIOD-START-YEAR.   02920019
           MOVE TF029-PROCESS-END-MONTH     TO HL2-PERIOD-END-MONTH.    02930019
           MOVE TF029-PROCESS-END-DAY       TO HL2-PERIOD-END-DAY.      02940019
           MOVE TF029-PROCESS-END-CENTURY   TO HL2-PERIOD-END-CENTURY.  02950019
           MOVE TF029-PROCESS-END-YEAR      TO HL2-PERIOD-END-YEAR.     02960019
                                                                        02970019
           PERFORM 7100-READ-STR-TOT-DSCRP-FILE.                        02980019
                                                                        02990019
           IF PS-END-OF-STR-TOT-FILE                                    03000019
               MOVE SPACES  TO  HL3-HEADING-LINE-3                      03010019
                                HL4-HEADING-LINE-4                      03020019
                                                                        03030019
               PERFORM 8500-WRITE-HEADING-LINES                         03040019
                                                                        03050019
               WRITE XFER-DISCREPANCY-RECAP-LINE                        03060019
                   FROM NO-DATA-LINE                                    03070019
                   AFTER ADVANCING PV-ADVANCE-COUNT LINES               03080019
                                                                        03090019
               MOVE 3 TO PV-ADVANCE-COUNT                               03100019
               PERFORM 8400-WRITE-END-OF-REPORT-LINE                    03110019
           ELSE                                                         03120019
               INITIALIZE DA-DETAIL-ACCUMULATORS                        03130019
                          TA-TOTAL-ACCUMULATORS                         03140019
               PERFORM 8500-WRITE-HEADING-LINES                         03150019
           END-IF.                                                      03160019
      *                                                                 03170019
       2000-CREATE-DISCRP-RECAP-RPT.                                    03180019
           MOVE TF037-DISTRICT-NBR  TO  CK-DISTRICT-NBR                 03190019
                                        DT-DISTRICT-NBR.                03200019
                                                                        03210019
           PERFORM 2100-PROCESS-DISTRICT                                03220019
               UNTIL ((PS-END-OF-STR-TOT-FILE)                          03230019
                  OR  (TF037-DISTRICT-NBR  NOT =  CK-DISTRICT-NBR)).    03240019
                                                                        03250019
           PERFORM 3000-CONTROL-BREAK.                                  03260019
                                                                        03270019
           IF PS-END-OF-STR-TOT-FILE                                    03280019
               PERFORM 8000-LINES-NEEDED-FOR-TOTALS                     03290019
               MOVE TA-XFERS-WITH-DSCRPS  TO  FT-XFERS-WITH-DSCRPS      03300019
               MOVE TA-ADJ-UNITS          TO  FT-ADJ-UNITS              03310019
               MOVE TA-ADJ-RTL            TO  FT-ADJ-RTL                03320019
               PERFORM 8300-WRITE-FINAL-TOTAL-LINE                      03330019
               MOVE 3 TO PV-ADVANCE-COUNT                               03340019
               PERFORM 8400-WRITE-END-OF-REPORT-LINE                    03350019
           END-IF.                                                      03360019
      *                                                                 03370019
       2100-PROCESS-DISTRICT.                                           03380019
           MOVE TF037-STORE-NBR          TO  DL-FROM-STR-NBR.           03390019
           MOVE TF037-STORE-NAME         TO  DL-FROM-STR-NAME.          03400019
           MOVE TF037-XFERS-WITH-DSCRPS  TO  DL-TOT-XFERS-WITH-DSCRPS.  03410019
           MOVE TF037-ADJ-UNITS          TO  DL-ADJ-UNITS.              03420019
           MOVE TF037-ADJ-RTL            TO  DL-ADJ-RTL.                03430019
                                                                        03440019
           PERFORM 8100-WRITE-DETAIL-LINE.                              03450019
                                                                        03460019
           COMPUTE DA-XFERS-WITH-DSCRPS =                               03470019
               (DA-XFERS-WITH-DSCRPS  +  TF037-XFERS-WITH-DSCRPS).      03480019
                                                                        03490019
           COMPUTE DA-ADJ-UNITS  =                                      03500019
               (DA-ADJ-UNITS  +  TF037-ADJ-UNITS).                      03510019
                                                                        03520019
           COMPUTE DA-ADJ-RTL  =                                        03530019
               (DA-ADJ-RTL  +  TF037-ADJ-RTL).                          03540019
                                                                        03550019
           PERFORM 7100-READ-STR-TOT-DSCRP-FILE.                        03560019
      *                                                                 03570019
      ******************************************************************03580019
      * CONTROL BREAK ON CHANGE IN STORE NUMBER.                        03590019
      ******************************************************************03600019
       3000-CONTROL-BREAK.                                              03610019
           PERFORM 8000-LINES-NEEDED-FOR-TOTALS.                        03620019
                                                                        03630019
           COMPUTE TA-XFERS-WITH-DSCRPS  =                              03640019
               (TA-XFERS-WITH-DSCRPS  +  DA-XFERS-WITH-DSCRPS).         03650019
                                                                        03660019
           COMPUTE TA-ADJ-UNITS  =                                      03670019
               (TA-ADJ-UNITS  +  DA-ADJ-UNITS).                         03680019
                                                                        03690019
           COMPUTE TA-ADJ-RTL  =                                        03700019
               (TA-ADJ-RTL  +  DA-ADJ-RTL).                             03710019
                                                                        03720019
           MOVE DA-XFERS-WITH-DSCRPS  TO  DT-XFERS-WITH-DSCRPS.         03730019
           MOVE DA-ADJ-UNITS          TO  DT-ADJ-UNITS.                 03740019
           MOVE DA-ADJ-RTL            TO  DT-ADJ-RTL.                   03750019
           PERFORM 8200-WRITE-DISTRICT-TOTAL-LINE.                      03760019
                                                                        03770019
           INITIALIZE DA-DETAIL-ACCUMULATORS.                           03780019
      *                                                                 03790019
       7000-READ-PROCESS-DATES-FILE.                                    03800019
           READ PROCESS-DATES-FILE                                      03810019
               INTO TF029-PROCESS-DATES-RECORD                          03820019
           END-READ.                                                    03830019
      *                                                                 03840019
       7100-READ-STR-TOT-DSCRP-FILE.                                    03850019
           READ STR-TOT-DISCREPANCY-FILE                                03860019
               INTO TF037-STR-TOT-DSCRP-RECORD                          03870019
                   AT END                                               03880019
                       SET PS-END-OF-STR-TOT-FILE  TO  TRUE             03890019
           END-READ.                                                    03900019
                                                                        03910019
      ******************************************************************03920019
      * 8000-LINES-NEEDED-FOR-TOTALS - PERFORMS A CHECK VERYING THAT THE03930019
      * CURRENT LEVEL OF BREAK TOTALS WILL FIT ON THE PAGE.  IF NOT,    03940019
      * HEADING LINE ARE PRODUCED, THE LINE COUNT INITIALIZED AND THE   03950019
      * DETAIL LINE IS FILLED WITH THE APPROPRIATE INFORMATION BASED    03960019
      * UPON THE CURRENT LEVEL OF CONTROL BREAK.                        03970019
      ******************************************************************03980019
       8000-LINES-NEEDED-FOR-TOTALS.                                    03990019
           IF (PV-LINE-COUNT + PC-LINES-NEEDED-FOR-TOTALS) >            04000019
                   PC-PAGE-SIZE                                         04010019
               INITIALIZE PV-LINE-COUNT                                 04020019
               PERFORM 8500-WRITE-HEADING-LINES                         04030019
           END-IF.                                                      04040019
      *                                                                 04050019
      ******************************************************************04060019
      * WRITES A DETAIL LINE AND COMPUTES THE LINE COUNT.               04070019
      ******************************************************************04080019
       8100-WRITE-DETAIL-LINE.                                          04090019
           IF (PV-LINE-COUNT + PV-ADVANCE-COUNT) >                      04100019
                   PC-PAGE-SIZE                                         04110019
               INITIALIZE PV-LINE-COUNT                                 04120019
               PERFORM 8500-WRITE-HEADING-LINES                         04130019
           END-IF.                                                      04140019
                                                                        04150019
           WRITE XFER-DISCREPANCY-RECAP-LINE                            04160019
               FROM DL-DETAIL-LINE                                      04170019
               AFTER ADVANCING PV-ADVANCE-COUNT LINES.                  04180019
           COMPUTE PV-LINE-COUNT =                                      04190019
                   PV-LINE-COUNT + PV-ADVANCE-COUNT.                    04200019
           MOVE SPACES TO DL-DETAIL-LINE.                               04210019
           MOVE 1 TO PV-ADVANCE-COUNT.                                  04220019
      *                                                                 04230019
       8200-WRITE-DISTRICT-TOTAL-LINE.                                  04240019
           MOVE 2 TO PV-ADVANCE-COUNT.                                  04250019
           WRITE XFER-DISCREPANCY-RECAP-LINE                            04260019
               FROM DT-DISTRICT-TOTAL                                   04270019
               AFTER ADVANCING PV-ADVANCE-COUNT LINES.                  04280019
           COMPUTE PV-LINE-COUNT =                                      04290019
                   PV-LINE-COUNT + PV-ADVANCE-COUNT.                    04300019
      *                                                                 04310019
       8300-WRITE-FINAL-TOTAL-LINE.                                     04320019
           WRITE XFER-DISCREPANCY-RECAP-LINE                            04330019
               FROM FT-FINAL-TOTAL                                      04340019
               AFTER ADVANCING PV-ADVANCE-COUNT LINES.                  04350019
      *                                                                 04360019
      ******************************************************************04370019
      * WRITES THE KOHLS STANDARD END OF REPORT LINE, VERIFYING IT WILL 04380019
      * STILL FIT ON THE PAGE.                                          04390019
      ******************************************************************04400019
       8400-WRITE-END-OF-REPORT-LINE.                                   04410019
           IF (PV-LINE-COUNT + PV-ADVANCE-COUNT) >                      04420019
                   PC-PAGE-SIZE                                         04430019
               INITIALIZE PV-LINE-COUNT                                 04440019
               PERFORM 8500-WRITE-HEADING-LINES                         04450019
           END-IF.                                                      04460019
           WRITE XFER-DISCREPANCY-RECAP-LINE                            04470019
               FROM END-OF-REPORT-LINE                                  04480019
               AFTER ADVANCING PV-ADVANCE-COUNT LINES.                  04490019
      *                                                                 04500019
      ******************************************************************04510019
      * PRODUCES HEADINGS ASSOCIATED WITH THE TRANSFER DISCREPANCY      04520019
      * REPORT.                                                         04530019
      ******************************************************************04540019
       8500-WRITE-HEADING-LINES.                                        04550019
           ADD 1 TO PV-PAGE-COUNT.                                      04560019
           MOVE PV-PAGE-COUNT TO DP132O-PAGE-NUMBER.                    04570019
                                                                        04580019
           WRITE XFER-DISCREPANCY-RECAP-LINE                            04590019
               FROM DP132O-STANDRD-HEADER-132-COLS                      04600019
               AFTER ADVANCING PAGE.                                    04610019
                                                                        04620019
           WRITE XFER-DISCREPANCY-RECAP-LINE                            04630019
               FROM HL1-HEADING-LINE-1                                  04640019
               AFTER ADVANCING 2 LINES.                                 04650019
                                                                        04660019
           WRITE XFER-DISCREPANCY-RECAP-LINE                            04670019
               FROM HL2-HEADING-LINE-2                                  04680019
               AFTER ADVANCING 1 LINES.                                 04690019
                                                                        04700019
           WRITE XFER-DISCREPANCY-RECAP-LINE                            04710019
               FROM HL3-HEADING-LINE-3                                  04720019
               AFTER ADVANCING 2 LINES.                                 04730019
                                                                        04740019
           WRITE XFER-DISCREPANCY-RECAP-LINE                            04750019
               FROM HL4-HEADING-LINE-4                                  04760019
               AFTER ADVANCING 1 LINES.                                 04770019
                                                                        04780019
           MOVE 2 TO PV-ADVANCE-COUNT.                                  04790019
           MOVE 7 TO PV-LINE-COUNT.                                     04800019
      *                                                                 04810019
       9000-EOJ-ROUTINE.                                                04820019
           CLOSE PROCESS-DATES-FILE                                     04830019
                 STR-TOT-DISCREPANCY-FILE                               04840019
                 XFER-DISCREPANCY-RECAP-REPORT.                         04850019
      *                                                                 04860019
