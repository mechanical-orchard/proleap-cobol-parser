000100*-----------------------*                                         00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300*-----------------------*                                         00030000
000400 PROGRAM-ID.    PCKCS702.                                         00040000
000500                                                                  00050000
000600 AUTHOR.        ANN RAISLER.                                      00060000
000700 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00070000
000800 DATE-WRITTEN.  09-15-98.                                         00080000
000900 DATE-COMPILED.                                                   00090000
001000                                                                  00100000
001100*---------------------------------------------------------------* 00110000
001200*    E702 - P2L/CASEPACK LABEL REPRINT                          * 00120000
001300*                                                               * 00130000
001400*    THIS SCREEN CAN BE USED TO REVIEW THE PO/RCVR/ITEM         * 00140000
001500*    AND IS USED TO REPRINT THE SHIPPING LABELS FOR THAT ITEM   * 00150000
001600*                                                               * 00160000
001700*---------------------------------------------------------------* 00170000
001710* DATE  11/04/2021                                                00171021
001720*            - CHANGE CALL OF 'DPKUT100' TO                     * 00172021
001730*              CALL DP010I-NUMERIC-EDIT-ROUTINE                 * 00173021
001740*              MAKING THE CALL DYNAMIC VS STATIC                * 00174021
001750*     MADE BY: GERMAN BANDA            WR/IR #: CHG0264232        00175022
001760*-----------------------------------------------------------------00176021
1122RM* DATE  11/07/2022                                              * 00177023
1122RM*            - ADD COPYBOOK DPWS930                             * 00178023
1122RM*              CHANGE CALL TO DPWS030 FROM STATIC TO            * 00179023
1122RM*              DYNAMIC.                                         * 00179123
1122RM*     MADE BY: BOB MCASEY              WR/IR #: CHG0277910      * 00179223
1122rm*-----------------------------------------------------------------00179323
001800                                                                  00180000
001900 ENVIRONMENT DIVISION.                                            00190000
002000                                                                  00200000
002100 DATA DIVISION.                                                   00210000
002200                                                                  00220000
002300 WORKING-STORAGE SECTION.                                         00230000
002400                                                                  00240000
002500                                                                  00250000
002600 01  DK-DB2-KEYS.                                                 00260000
002700     05  DK-OPER-UNT-ID                PIC S9(4) COMP VALUE ZERO. 00270000
002800     05  DK-OPER-UNT-ID-2              PIC S9(4) COMP VALUE ZERO. 00280000
002900     05  DK-FCLTY-ID                   PIC S9(4) COMP VALUE ZERO. 00290000
003000     05  DK-MODU-NBR                   PIC S9(4) COMP VALUE ZERO. 00300000
003100     05  DK2-PO-NBR                    PIC S9(09) COMP VALUE +0.  00310000
003200     05  DK2-REC-SEQ-NBR               PIC S9(09) COMP VALUE +0.  00320000
003300     05  DK2-PREPK-ID                  PIC S9(04) COMP VALUE +0.  00330000
003400                                                                  00340000
003500 01  PC-PROGRAM-CONSTANTS.                                        00350000
003600     05  PC-CURRENT-MAP-NAME            PIC  X(08)  VALUE         00360000
003700                                                    'PC702A  '.   00370000
003800     05  PC-CURRENT-MAPSET-NAME         PIC  X(08)  VALUE         00380000
003900                                                    'PCKM702 '.   00390000
004000     05  PC-CURRENT-PROGRAM-NAME        PIC  X(08)  VALUE         00400000
004100                                                    'PCKCS702'.   00410000
004200     05  PC-LABEL-PROGRAM                PIC  X(08)  VALUE        00420000
004300                                                    'PCKCS191'.   00430000
004400                                                                  00440000
004500                                                                  00450000
004600     05  PC-REPORT-PGM-1           PIC  X(08)  VALUE 'PCKCS126'.  00460000
004700     05  PC-REPORT-PGM-2           PIC  X(08)  VALUE 'PCKCS123'.  00470000
004800                                                                  00480000
004900     05  PC-DEFAULT-TIMESTAMP      PIC  X(26)  VALUE              00490000
005000                                  '9999-09-09-09.09.09.999999'.   00500000
005100                                                                  00510000
005200     05  PC-PRINT-QUEUE-SEQ             PIC  9(01)  VALUE 3.      00520000
005300     05  PC-CRIT-SPEC-FORMAT            PIC  X(01)  VALUE '1'.    00530000
005400     05  PC-LIST-FORMAT                 PIC  X(01)  VALUE '2'.    00540000
005500                                                                  00550000
005600     05  PC-SML                         PIC  X(05)  VALUE         00560000
005700                                                    '(SML)'.      00570000
005800     05  PC-PGYBCK                      PIC  X(08)  VALUE         00580000
005900                                                    '(PGYBCK)'.   00590000
006000     05  PC-NO-LBL                      PIC  X(08)  VALUE         00600000
006100                                                    '(NO LBL)'.   00610000
006200     05  PC-NO-LBL-PRT-ID               PIC  X(02)  VALUE         00620000
006300                                                    'NL'.         00630000
006400     05  PC-P2L-CASE-DESC               PIC  X(10)  VALUE         00640000
006500                                                    'P2L/CASE  '. 00650000
006600     05  PC-P2L-LBL-DESC                PIC  X(10)  VALUE         00660000
006700                                                    'P2L LBL   '. 00670000
006800     05  PC-CASE-LBL-DESC               PIC  X(10)  VALUE         00680000
006900                                                    'CASE LBL  '. 00690000
007000     05  PC-ITEMS-PER-PANEL             PIC S9(04)  VALUE +10     00700000
007100                                                    COMP SYNC.    00710000
007200     05  PC-MAX-RETRIES                 PIC S9(04)  VALUE  +2.    00720000
007300     05  PC-MGMX                        PIC  X(04)  VALUE 'MGMX'. 00730000
007400                                                                  00740000
007500     05  PC-A                           PIC X(01)   VALUE 'A'.    00750000
007600     05  PC-B                           PIC X(01)   VALUE 'B'.    00760000
007700     05  PC-C                           PIC X(01)   VALUE 'C'.    00770000
007710     05  PC-D                           PIC X(01)   VALUE 'D'.    00771003
007800     05  PC-F                           PIC X(01)   VALUE 'F'.    00780000
007900     05  PC-I                           PIC X(01)   VALUE 'I'.    00790000
008000     05  PC-O                           PIC X(01)   VALUE 'O'.    00800000
008100     05  PC-N                           PIC X(01)   VALUE 'N'.    00810000
008200     05  PC-P                           PIC X(01)   VALUE 'P'.    00820000
008300     05  PC-R                           PIC X(01)   VALUE 'R'.    00830000
008400     05  PC-S                           PIC X(01)   VALUE 'S'.    00840000
008500     05  PC-X                           PIC X(01)   VALUE 'X'.    00850000
008600     05  PC-Y                           PIC X(01)   VALUE 'Y'.    00860000
008700     05  PC-01                          PIC X(02)   VALUE '01'.   00870000
008800     05  PC-03                          PIC X(02)   VALUE '03'.   00880000
008900     05  PC-PRTR-VALIDATION-PGM    PIC  X(08)  VALUE 'DPKCS060'.  00890000
009000                                                                  00900000
009100     05  PC-ODD-CRTN-FCSE               PIC X(04) VALUE 'FCSE'.   00910000
009200     05  PC-ODD-CRTN-INPK               PIC X(04) VALUE 'INPK'.   00920000
009300     05  PC-ODD-CRTN-P2L                PIC X(04) VALUE 'P2L '.   00930000
009400                                                                  00940000
009500     05  PC-INNER-PREPACK            PIC  X(06) VALUE 'INPRPK'.   00950000
009600     05  PC-MULTI-SKU                PIC  X(06) VALUE 'MLTSKU'.   00960000
009700     05  PC-SINGLE-SKU               PIC  X(06) VALUE 'SGLSKU'.   00970000
009800     05  PC-CASEPACK                 PIC  X(06) VALUE 'CASEPK'.   00980000
009900     05  PC-BULK                     PIC  X(06) VALUE 'BULK  '.   00990000
010000                                                                  01000000
010100     05  PC-QTY              PIC  X(03) VALUE 'QTY'.              01010000
010200     05  PC-PAK              PIC  X(03) VALUE 'PAK'.              01020000
010300     05  PC-INPK             PIC  X(13) VALUE 'INPAK.......:'.    01030000
010400     05  PC-RATIO            PIC  X(13) VALUE 'RATIO.......:'.    01040000
010500     05  PC-SKU              PIC  X(13) VALUE 'SKU.........:'.    01050000
010600     05  PC-PACKID           PIC  X(13) VALUE 'PACK ID.....:'.    01060000
010700                                                                  01070000
010800                                                                  01080000
010900*----------------------------------------------------------------*01090000
011000*  SYSTEM MESSAGES                                               *01100000
011100*----------------------------------------------------------------*01110000
011200* 00005 - INVALID VALUE                                          *01120000
011300* 00008 - MUST BE NUMERIC                                        *01130000
011400* 00051 - NO END OF RANGE HAS BEEN SPECIFIED                     *01140000
011500* 00052 - END OF RANGE PRECEDES START OF RANGE                   *01150000
011600* 00053 - NO START OF RANGE HAS BEEN SPECIFIED                   *01160000
011700* 00054 - ONLY ONE START OF RANGE INDICATOR MAY BE SPECIFIED     *01170000
011800* 00055 - ONLY ONE END OF RANGE INDICATOR MAY BE SPECIFIED       *01180000
011900* 00057 - A LIST ITEM MUST BE SELECTED FOR THIS FUNCTION         *01190000
012000* 00069 - TOP OF LIST                                            *01200000
012100* 00070 - BOTTOM OF LIST                                         *01210000
012200* 00101 - VALUE MUST BE > ZERO AND  < 1,000,000                  *01220000
012300* 00746 - INVALID PRINTER DESTINATION                            *01230000
012400* 00763 - VALID VALUES ARE 'R' AND 'S'                           *01240000
012500* 01563 - PRINTER ID MUST BE ENTERED FOR THIS SELECTION          *01250000
012600* 01770 - SELECTED LINE(S) HAVE BEEN SUCCESSFULLY PROCESSED      *01260000
012700* 01796 - LABEL PRINT ORDER HAS CHANGED, MUST REPRINT ALL LABEL  *01270000
012800* 01797 - PIGGYBACK LABELS REQUESTED, PIGGYBACK PRINTER ID REQ   *01280000
012900* 01798 - SML LABELS REQUESTED, SML PRINTER ID REQUIRED          *01290000
013000* 01814 - MUST SELECT EITHER "ALL" OR A "FROM - TO" RANGE FOR    *01300000
013100*           A REPRINT                                            *01310000
013200* 01845 - OVERRIDE MOD NUMBER NOT ON SAME DYNAPACK SERVER AS     *01320000
013300*           ORIGINAL MOD NUMBER                                  *01330000
013400* 01846 - REQUESTED REPRINT RANGE IS OUTSIDE THE TOTAL           *01340000
013500*           NUMBER OF LABELS                                     *01350000
013600* 01952 - CANNOT USE 'FROM TO' OPTION FOR PIGGYBACK LBL, PRINT   *01360000
013700* 02424 - PGYBK PRTRS CANNOT BE USED FOR PRE-PACK TYPE I OR M    *01370000
013800* 02508-E-CANNOT REPRINT LABELS FOR LINES THAT WERE PROCESSED USI*01380000
013900*         128 DATA                                               *01390000
014000* 99901 - INVALID COMMAND WAS ENTERED                            *01400000
014100*----------------------------------------------------------------*01410000
014200 01  PC-TSYMSG-NUMBERS.                                           01420000
014300     10  PC-TSYMSG-00005                PIC  9(05)  VALUE 00005.  01430000
014400     10  PC-TSYMSG-00007                PIC  9(05)  VALUE 00007.  01440000
014500     10  PC-TSYMSG-00008                PIC  9(05)  VALUE 00008.  01450000
014600     10  PC-TSYMSG-00050                PIC  9(05)  VALUE 00050.  01460000
014700     10  PC-TSYMSG-00051                PIC  9(05)  VALUE 00051.  01470000
014800     10  PC-TSYMSG-00052                PIC  9(05)  VALUE 00052.  01480000
014900     10  PC-TSYMSG-00053                PIC  9(05)  VALUE 00053.  01490000
015000     10  PC-TSYMSG-00054                PIC  9(05)  VALUE 00054.  01500000
015100     10  PC-TSYMSG-00055                PIC  9(05)  VALUE 00055.  01510000
015200     10  PC-TSYMSG-00057                PIC  9(05)  VALUE 00057.  01520000
015300     10  PC-TSYMSG-00069                PIC  9(05)  VALUE 00069.  01530000
015400     10  PC-TSYMSG-00070                PIC  9(05)  VALUE 00070.  01540000
015500     10  PC-TSYMSG-00746                PIC  9(05)  VALUE 00746.  01550000
015600     10  PC-TSYMSG-00763                PIC  9(05)  VALUE 00763.  01560000
015700     10  PC-TSYMSG-01563                PIC  9(05)  VALUE 01563.  01570000
015800     10  PC-TSYMSG-01796                PIC  9(05)  VALUE 01796.  01580000
015900     10  PC-TSYMSG-01731                PIC  9(05)  VALUE 01731.  01590000
016000     10  PC-TSYMSG-01797                PIC  9(05)  VALUE 01797.  01600000
016100     10  PC-TSYMSG-01798                PIC  9(05)  VALUE 01798.  01610000
016200     10  PC-TSYMSG-01814                PIC  9(05)  VALUE 01814.  01620000
016300     10  PC-TSYMSG-01842                PIC  9(05)  VALUE 01842.  01630000
016400     10  PC-TSYMSG-01845                PIC  9(05)  VALUE 01845.  01640000
016500     10  PC-TSYMSG-01846                PIC  9(05)  VALUE 01846.  01650000
016600     10  PC-TSYMSG-01952                PIC  9(05)  VALUE 01952.  01660000
016700     10  PC-TSYMSG-02424                PIC  9(05)  VALUE 02424.  01670000
016800     10  PC-TSYMSG-02508                PIC  9(05)  VALUE 02508.  01680000
016900     10  PC-TSYMSG-00984                PIC  9(05)  VALUE 00984.  01690000
017000     10  PC-TSYMSG-03265                PIC  9(05)  VALUE 03265.  01700004
017001     10  PC-TSYMSG-03415                PIC  9(05)  VALUE 03415.  01700112
017010     10  PC-TSYMSG-99901                PIC  9(05)  VALUE 99901.  01701004
017100                                                                  01710000
017200                                                                  01720000
017300*----------------------------------------------------------------*01730000
017400 01  PS-PROGRAM-SWITCHES.                                         01740000
017500     05  PS-ERROR-SW                    PIC  X(01)  VALUE  'N'.   01750000
017600         88  PS-NO-ERROR                            VALUE  'N'.   01760000
017700         88  PS-ERROR                               VALUE  'Y'.   01770000
017800     05  PS-COMMAREA-SW                 PIC  X(01)  VALUE  'N'.   01780000
017900         88  PS-COMMAREA-VALID                      VALUE  'Y'.   01790000
018000         88  PS-COMMAREA-NOT-VALID                  VALUE  'N'.   01800000
018100     05  PS-LIST-END-SW                 PIC  X(01)  VALUE  'N'.   01810000
018200         88  PS-LIST-END                            VALUE  'Y'.   01820000
018300         88  PS-NO-LIST-END                         VALUE  'N'.   01830000
018400     05  PS-PRINTER-ERROR-SW            PIC  X(01)  VALUE  'N'.   01840000
018500         88  PS-PRINTER-ERROR                       VALUE  'Y'.   01850000
018600                                                                  01860000
018700 01  PM-PROGRAM-MESSAGES.                                         01870000
018800     05  PM-PROGRAM-MESSAGE-1.                                    01880000
018900         10  PM-RET-CDE                 PIC  X(02)  VALUE SPACES. 01890000
019000         10  FILLER                     PIC  X(01)  VALUE '-'.    01900000
019100         10  PM-RET-MSG                 PIC  X(25)  VALUE SPACES. 01910000
019200         10  FILLER                     PIC  X(48)  VALUE SPACES. 01920000
019300                                                                  01930000
019400*                                                                 01940000
019500                                                                  01950000
019600                                                                  01960000
019700*----------------------------------------------------------------*01970000
019800 01  PV-PROGRAM-VARIABLES.                                        01980000
019900     05  PV-MOD-NBR-N                   PIC  9(04).               01990000
020000     05  FILLER  REDEFINES  PV-MOD-NBR-N.                         02000000
020100         10  FILLER                   PIC  X(01).                 02010000
020200         10  PV-MOD-NBR-3             PIC  X(03).                 02020000
020300                                                                  02030000
020400     05  PV-CICS-RESP                   PIC S9(04)  VALUE +0      02040000
020500                                                    COMP SYNC.    02050000
020600     05  PV-COMMAREA-LENGTH              PIC S9(04)  VALUE +0     02060000
020700                                                     COMP SYNC.   02070000
020800     05  PV-OVERRIDE-IP-ADDR          PIC X(15) VALUE SPACES.     02080000
020900     05  PV-OVERRIDE-DIVERT-CDE       PIC X(04) VALUE SPACES.     02090000
021000     05  PV-DISTDT-ODD-CNT-FCSE       PIC S9(09)      COMP.       02100000
021100     05  PV-DISTDT-ODD-CNT-INPK       PIC S9(09)      COMP.       02110000
021200     05  PV-TOT-PREPK-UNTS            PIC  S9(9)      COMP.       02120000
021300     05  PV-TOT-PREPK-INPK-UNTS       PIC  S9(9)      COMP.       02130000
021400     05  PV-DISPLAY-PACKID.                                       02140000
021500         10  FILLER                      PIC   X(03) VALUE 'PK-'. 02150000
021600         10  PV-PACKID                   PIC   9(04).             02160000
021700         10  FILLER                      PIC   X(01) VALUE SPACE. 02170000
021800                                                                  02180000
021900     05  PV-SOFT-ABORT-MSG.                                       02190000
022000         10  FILLER            PIC X(12) VALUE ' PCKCS702 - '.    02200000
022100         10  FILLER            PIC X(09) VALUE 'SQLCODE: '.       02210000
022200         10  PV-SOFT-SQLCODE   PIC ZZ9-.                          02220000
022300         10  FILLER            PIC X(07) VALUE ' PARA: '.         02230000
022400         10  PV-SOFT-PARAGRAPH PIC X(30).                         02240000
022500         10  PV-SOFT-MSG       PIC X(18).                         02250000
022600     05  PV-CICS-MSG-AREA                PIC  X(80)  VALUE SPACE. 02260000
022700     05  PV-CICS-MSG-AREA2               PIC  X(100) VALUE SPACE. 02270000
022800                                                                  02280000
022900     05  PV-FORMAT-TMST.                                          02290000
023000         10  PV-FORMAT-TMST-DTE.                                  02300000
023100             15  PV-FORMAT-TMST-DTE-MM  PIC X(02)  VALUE SPACES.  02310000
023200             15  PV-FORMAT-SLASH        PIC X(01)  VALUE '/'.     02320000
023300             15  PV-FORMAT-TMST-DTE-DD  PIC X(02)  VALUE SPACES.  02330000
023400             15  PV-FORMAT-SLASH        PIC X(01)  VALUE '/'.     02340000
023500             15  PV-FORMAT-TMST-DTE-CY  PIC X(04)  VALUE SPACES.  02350000
023600         10  PV-FORMAT-TMST-TM.                                   02360000
023700             15  PV-FORMAT-TMST-TM-HH   PIC X(02)  VALUE SPACES.  02370000
023800             15  PV-FORMAT-COLON        PIC X(01)  VALUE ':'.     02380000
023900             15  PV-FORMAT-TMST-TM-MM   PIC X(02)  VALUE SPACES.  02390000
024000             15  PV-FORMAT-COLON        PIC X(01)  VALUE ':'.     02400000
024100             15  PV-FORMAT-TMST-TM-SS   PIC X(02)  VALUE SPACES.  02410000
024200                                                                  02420000
024300     05  PV-REFORMAT-TMST.                                        02430000
024400         10  PV-REFORMAT-TMST-DTE.                                02440000
024500             15  PV-REFORMAT-TMST-DTE-CY  PIC X(04)  VALUE SPACES.02450000
024600             15  FILLER                   PIC X(01)  VALUE SPACES.02460000
024700             15  PV-REFORMAT-TMST-DTE-MM  PIC X(02)  VALUE SPACES.02470000
024800             15  FILLER                   PIC X(01)  VALUE SPACES.02480000
024900             15  PV-REFORMAT-TMST-DTE-DD  PIC X(02)  VALUE SPACES.02490000
025000             15  FILLER                   PIC X(01)  VALUE SPACES.02500000
025100         10  PV-REFORMAT-TMST-TM.                                 02510000
025200             15  PV-REFORMAT-TMST-TM-HH   PIC X(02)  VALUE SPACES.02520000
025300             15  FILLER                   PIC X(01)  VALUE SPACES.02530000
025400             15  PV-REFORMAT-TMST-TM-MM   PIC X(02)  VALUE SPACES.02540000
025500             15  FILLER                   PIC X(01)  VALUE SPACES.02550000
025600             15  PV-REFORMAT-TMST-TM-SS   PIC X(02)  VALUE SPACES.02560000
025700             15  FILLER                   PIC X(01)  VALUE SPACES.02570000
025800             15  PV-REFORMAT-TMST-TM-TS   PIC X(06)  VALUE SPACES.02580000
025900                                                                  02590000
026000*---------------------------------------------------------------* 02600000
026100*  RECORD LAYOUT FOR THE MESSAGE SELECTION TEMP STORAGE QUEUE.  * 02610000
026200*---------------------------------------------------------------* 02620000
026300     COPY DPWS057.                                                02630000
026400                                                                  02640000
026500                                                                  02650000
026600*---------------------------------------------------------------* 02660000
026700*  RECORD LAYOUT FOR THE LIST INPUT                             * 02670000
026800*---------------------------------------------------------------* 02680000
026900     COPY PCWS121.                                                02690000
027000                                                                  02700000
027100                                                                  02710000
027200*---------------------------------------------------------------* 02720000
027300*    MAP LAYOUT                                                 * 02730000
027400*---------------------------------------------------------------* 02740000
027500                                                                  02750000
027600     COPY PCKM702.                                                02760000
027700                                                                  02770000
027800*---------------------------------------------------------------* 02780000
027900*    ATTRIBUTE SETTINGS COPYBOOK.                               * 02790000
028000*---------------------------------------------------------------* 02800000
028100                                                                  02810000
028200     COPY DPWS015.                                                02820000
028300                                                                  02830000
028400*---------------------------------------------------------------* 02840000
028500*    FUNCTION KEYS COPYBOOK.                                    * 02850000
028600*---------------------------------------------------------------* 02860000
028700                                                                  02870000
028800     COPY DPWS016.                                                02880000
028900                                                                  02890000
029000*---------------------------------------------------------------* 02900000
029100*    NUMERIC EDIT LAYOUT.                                       * 02910000
029200*---------------------------------------------------------------* 02920000
029300                                                                  02930000
029400     COPY DPWS010I.                                               02940000
029500                                                                  02950000
029600*----------------------------------------------------------------*02960000
029700*  SENDING/RECEIVING AREA FOR THE                                *02970000
029800*  PRINTER VALIDATION ROUTING (DPKCS060)                         *02980000
029900*----------------------------------------------------------------*02990000
030000     COPY DPWS072.                                                03000000
030100                                                                  03010000
030200                                                                  03020000
030300*----------------------------------------------------------------*03030000
030400*  COPYBOOK USED TO FOR ITEM ACCESS MODULE                        03040000
030500*  (XLKUT001)                                                     03050000
030600*----------------------------------------------------------------*03060000
030700     COPY XLWS001.                                                03070000
030800/                                                                 03080000
030900*---------------------------------------------------------------* 03090000
031000*    PARAMETERS FOR CALLING CICS ARCHITECTURE API (DPKCS030).   * 03100000
031100*---------------------------------------------------------------* 03110000
031200     COPY DPWS030.                                                03120000
1122rm     COPY DPWS930.                                                03121023
031300                                                                  03130000
031400*---------------------------------------------------------------* 03140000
031500*  RECORD LAYOUTS FOR THE RECEIVING AUDIT ROUTINE                 03150000
031600*---------------------------------------------------------------* 03160000
031700     COPY PCWS126.                                                03170000
031800                                                                  03180000
031900                                                                  03190000
032000*---------------------------------------------------------------* 03200000
032100*    STANDARD COMMAREA.                                         * 03210000
032200*---------------------------------------------------------------* 03220000
032300     COPY DPWS020.                                                03230000
032400     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                03240000
032500                                                                  03250000
032600*---------------------------------------------------------------* 03260000
032700* INTER-APPLICATION COMMAREA.                                   * 03270000
032800*   PCWS120 - IS THE INPUT LAYOUT WHEN COMING FROM THE CRIT.    * 03280000
032900*             SPEC SCREEN.                                      * 03290000
033000*   PCWS122 - IS THE INPUT LAYOUT THAT WILL BE PASSED FROM      * 03300000
033100*             THE LIST SCREEN                                   * 03310000
033200*---------------------------------------------------------------* 03320000
033300                                                                  03330000
033400         10  INTER-APPL-COMM-AREA       PIC X(200).               03340000
033500     COPY PCWS120.                                                03350000
033600     COPY PCWS122.                                                03360000
033700*---------------------------------------------------------------* 03370000
033800*  THIS IS THE APPLICATION-SPECIFIC COMMAREA.                   * 03380000
033900*---------------------------------------------------------------* 03390000
034000         10  ASC-SPECIFIC-COMMAREA.                               03400000
034100           15  ASC-KEYS.                                          03410000
034200             20  ASC-PO-NBR                   PIC S9(09) COMP.    03420000
034300             20  ASC-REC-SEQ-NBR              PIC S9(09) COMP.    03430000
034400             20  ASC-PO-LNE-NBR               PIC S9(04) COMP.    03440000
034500             20  ASC-OPER-UNT-ID              PIC S9(04).         03450000
034600             20  ASC-FCLTY-ID                 PIC S9(04).         03460000
034700             20  ASC-MODU-NBR.                                    03470000
034800                 25  ASC-MODU-NBR-N           PIC 9(03).          03480000
034900             20  ASC-SML-P2L-PRTR-ID          PIC  X(08).         03490000
035000             20  ASC-SML-P2L-PRTR-ID-N REDEFINES                  03500000
035100                 ASC-SML-P2L-PRTR-ID          PIC  9(08).         03510000
035200             20  FILLER  REDEFINES  ASC-SML-P2L-PRTR-ID.          03520000
035300                 25  FILLER                   PIC  X(05).         03530000
035400                 25  ASC-SML-P2L-PRTR-ID-3    PIC  X(03).         03540000
035500             20  ASC-PGYBCK-PRTR-ID           PIC  X(08).         03550000
035600             20  ASC-PGYBCK-PRTR-ID-N  REDEFINES                  03560000
035700                 ASC-PGYBCK-PRTR-ID           PIC  9(08).         03570000
035800             20  FILLER  REDEFINES  ASC-PGYBCK-PRTR-ID.           03580000
035900                 25  FILLER                   PIC  X(05).         03590000
036000                 25  ASC-PGYBCK-PRTR-ID-3     PIC  X(03).         03600000
036100             20  ASC-CURR-FCLTY-ID            PIC S9(04).         03610000
036200             20  ASC-CURR-OPER-UNT-ID         PIC S9(04).         03620000
036300             20  ASC-DFLT-STR-ZN-ID           PIC  X(05).         03630000
036400             20  ASC-LBL-PRT-TYPE             PIC  X(01).         03640000
036500             20  ASC-LBL-ORIG-PRT-ORDER       PIC  X(01).         03650000
036600             20  ASC-CRE-LBL-IND              PIC  X(01).         03660000
036700                 88  ASC-CRE-BOTH-LBL             VALUE 'B'.      03670000
036800                 88  ASC-CRE-P2L-LBL              VALUE 'P'.      03680000
036900                 88  ASC-CRE-SML-LBL              VALUE 'C'.      03690000
037000             20  ASC-LBL-PRT-ORDER            PIC  X(01).         03700000
037100             20  ASC-INPK-UNT-QTY             PIC S9(04) COMP-3.  03710000
037200             20  ASC-OTPK-UNT-QTY             PIC S9(04) COMP-3.  03720000
037300             20  ASC-INPK-CNVYB-IND           PIC  X(01).         03730000
037400             20  ASC-PRT-HEAD-FOOT            PIC  X(01).         03740000
037500             20  ASC-ODD-CARTON               PIC S9(04) COMP-3.  03750000
037600             20  ASC-ODD-CARTON-USE-SW        PIC  X(01).         03760000
037700                 88  ASC-ODD-CRTN-FCSE             VALUE 'F'.     03770000
037800                 88  ASC-ODD-CRTN-INPK             VALUE 'I'.     03780000
037900                 88  ASC-ODD-CRTN-P2L              VALUE 'P'.     03790000
038000                 88  ASC-ODD-CRTN-NONE             VALUE 'N'.     03800000
038100             20  ASC-PRT-QUEUE-NAME.                              03810000
038200                 25  ASC-PRT-TERM-ID          PIC  X(04).         03820000
038300                 25  ASC-PRT-TASK-NUMBER      PIC S9(05) COMP-3.  03830000
038400                 25  ASC-PRT-SEQ              PIC  9(01).         03840000
038500             20  ASC-ITEM-SUB                 PIC S9(04)  COMP    03850000
038600                                                          SYNC.   03860000
038700             20  ASC-SEL-SUB                  PIC S9(4)   COMP.   03870000
038800             20  ASC-SEL-ITEM                 PIC S9(4)   COMP.   03880000
038900             20  ASC-USE-SELECTION-QUEUE-IND                      03890000
039000                                           PIC  X(01).            03900000
039100                 88  ASC-USE-SELECTION-QUEUE           VALUE 'Y'. 03910000
039200             20  ASC-SEL-QUEUE-NAME.                              03920000
039300                 25  ASC-SEL-TERM-ID          PIC  X(04).         03930000
039400                 25  ASC-SEL-TASK-NUMBER      PIC S9(05) COMP-3.  03940000
039500                 25  ASC-SEL-SEQ              PIC  9(01).         03950000
039600             20  ASC-NUMBER-OF-TS-ITEMS       PIC S9(09)  COMP-3. 03960000
039700             20  ASC-NUMBER-OF-SELECTED-ITEMS PIC S9(09)  COMP-3. 03970000
039800             20  ASC-DISTHD-ORIG-LBL-TYP      PIC  X(01).         03980000
039900             20  ASC-CRIT-SPEC-PRT-ORDER      PIC  X(01).         03990000
040000             20  ASC-DC-PRTD-AT               PIC  X(02).         04000000
040100             20  ASC-PKGNG-CD                 PIC X(01).          04010000
040200                 88  ASC-PRE-PACK-ORDER           VALUE 'I', 'M'. 04020000
040300                 88  ASC-INNER-PREPK              VALUE 'I'.      04030000
040400                 88  ASC-MULTI-SKU-PREPK          VALUE 'M'.      04040000
040500                 88  ASC-SINGLE-SKU-PREPK         VALUE 'S'.      04050000
040600                 88  ASC-CASEPACK                 VALUE 'C'.      04060000
040700                 88  ASC-BULK-PACK                VALUE 'B'.      04070000
040800             20  ASC-DSPLY-PKGNG-CD           PIC X(01).          04080000
040900                 88  ASC-DSP-PRE-PACK-ORDER       VALUE 'I', 'M'. 04090000
041000                 88  ASC-DSP-INNER-PREPK          VALUE 'I'.      04100000
041100                 88  ASC-DSP-MULTI-SKU-PREPK      VALUE 'M'.      04110000
041200                 88  ASC-DSP-SINGLE-SKU-PREPK     VALUE 'S'.      04120000
041300                 88  ASC-DSP-CASEPACK             VALUE 'C'.      04130000
041400                 88  ASC-DSP-BULK-PACK            VALUE 'B'.      04140000
041500             20  ASC-PREPK-ID                 PIC S9(04) COMP.    04150000
041600             20  ASC-PREPK-RATIO              PIC S9(04) COMP.    04160000
041700             20  ASC-PACKS-IN-CRTN            PIC S9(04) COMP.    04170000
041800             20  ASC-P2L-PAK                  PIC S9(09) COMP-3.  04180000
041900             20  ASC-SHIP-PAK                 PIC S9(09) COMP-3.  04190000
042000             20  ASC-PROC-PAK                 PIC S9(09) COMP-3.  04200000
042100             20  ASC-PKSL-PAK                 PIC S9(09) COMP-3.  04210000
042200             20  ASC-UCC128-DATA-SW           PIC X(01).          04220000
042300                 88  ASC-UCC128-DATA-YES          VALUE 'Y'.      04230000
042400                 88  ASC-UCC128-DATA-NO           VALUE 'N'.      04240000
042410             20  ASC-USE-UCC128-DATA-SW       PIC  X(01).         04241009
042420                 88  ASC-USE-UCC128-DATA-YES         VALUE 'Y'.   04242009
042430                 88  ASC-USE-UCC128-DATA-NO          VALUE 'N'.   04243009
042440                 88  ASC-USE-UCC128-DATA-IGN         VALUE 'I'.   04244009
042450             20  ASC-ERR-ON-LABEL-DWNLD-SW    PIC  X(01).         04245012
042460                 88  ASC-ERR-ON-LABEL-DWNLD          VALUE 'Y'.   04246012
042470                 88  ASC-ERR-ON-LABEL-DWNLD-NO       VALUE 'N'.   04247012
042500             20  ASC-SKU                      PIC  X(08).         04250000
042510                                                                  04251018
042520* 10/05/10 - DMH - begin                                          04252018
042530             20  ASC-TRIP-ARRIVE-DATE        PIC  X(10).          04253018
042540             20  ASC-TRIP-ARRIVE-DATE-R                           04254018
042550                 REDEFINES ASC-TRIP-ARRIVE-DATE.                  04255018
042560                 25  ASC-TRIP-ARRIVE-CCYY    PIC  X(04).          04256018
042570                 25  ASC-TRIP-ARRIVE-DASH1   PIC  X(01).          04257018
042580                 25  ASC-TRIP-ARRIVE-MM      PIC  X(02).          04258018
042590                 25  ASC-TRIP-ARRIVE-DASH2   PIC  X(01).          04259018
042591                 25  ASC-TRIP-ARRIVE-DD      PIC  X(02).          04259118
042592* 10/05/10 - DMH - end                                            04259218
042593                                                                  04259318
042600                                                                  04260000
042700           15    ASC-SCREEN-DATA.                                 04270000
042800             20  ASC-MODU-NBR-OVERRIDE.                           04280000
042900                 25 ASC-MODU-NBR-OVERRIDE-N   PIC 9(03).          04290000
043000             20  ASC-DFLT-ORIG-STR-ZN-ID      PIC  X(05).         04300000
043100             20  ASC-P2L-CART-CNT             PIC S9(09) COMP-3.  04310000
043200             20  ASC-P2L-QTY                  PIC S9(09) COMP-3.  04320000
043300             20  ASC-SHIP-CART-CNT            PIC S9(09) COMP-3.  04330000
043400             20  ASC-SHIP-QTY                 PIC S9(09) COMP-3.  04340000
043500             20  ASC-PROC-CART-CNT            PIC S9(09) COMP-3.  04350000
043600             20  ASC-PROC-QTY                 PIC S9(09) COMP-3.  04360000
043700             20  ASC-PKSL-QTY                 PIC S9(09) COMP-3.  04370000
043800             20  ASC-SPEC-INST-DESC           PIC  X(10).         04380000
043900             20  ASC-STATUS                   PIC  X(08).         04390000
044000             20  ASC-CRE-LBL-DESC             PIC  X(10).         04400000
044100             20  ASC-DPT-NBR                  PIC  X(03).         04410000
044200             20  ASC-PRT-P2L-ALL              PIC X.              04420000
044300             20  ASC-PRT-P2L-FROM             PIC X(5).           04430000
044400             20  ASC-PRT-P2L-FROM-N REDEFINES ASC-PRT-P2L-FROM    04440000
044500                                              PIC 9(05).          04450000
044600             20  ASC-PRT-P2L-TO               PIC X(5).           04460000
044700             20  ASC-PRT-P2L-TO-N REDEFINES ASC-PRT-P2L-TO        04470000
044800                                              PIC 9(05).          04480000
044900             20  ASC-PRT-SHP-ALL              PIC X.              04490000
045000             20  ASC-PRT-SHP-FROM             PIC X(5).           04500000
045100             20  ASC-PRT-SHP-FROM-N REDEFINES ASC-PRT-SHP-FROM    04510000
045200                                              PIC 9(05).          04520000
045300             20  ASC-PRT-SHP-TO               PIC X(5).           04530000
045400             20  ASC-PRT-SHP-TO-N REDEFINES ASC-PRT-SHP-TO        04540000
045500                                              PIC 9(05).          04550000
045600             20  ASC-PRT-IO                   PIC X.              04560000
045700             20  ASC-PRT-SI                   PIC X(10).          04570000
045800             20  ASC-FCSE-SHIPPED             PIC 9(09).          04580000
045900             20  ASC-INPK-SHIPPED             PIC 9(09).          04590000
046000             20  ASC-FCSE-SHIPPED-REM         PIC 9(09).          04600000
046100             20  ASC-INPK-SHIPPED-REM         PIC 9(09).          04610000
046200             20  ASC-USERID                   PIC X(08).          04620000
046300             20  ASC-SIGNON-USERID            PIC X(08).          04630000
046400             20  ASC-TMST-DTE                 PIC X(10).          04640000
046500             20  ASC-TMST-TM                  PIC X(08).          04650000
046600             20  ASC-ITM-NBR                  PIC 9(15).          04660000
046700             20  ASC-CLASS                    PIC X(02).          04670000
046800             20  ASC-DEPT                     PIC X(03).          04680000
046900         10  FILLER                           PIC X(942).         04690018
047000                                                                  04700000
047100*---------------------------------------------------------------* 04710000
047200*    ABEND PROCESSING COPYBOOK.                                 * 04720000
047300*---------------------------------------------------------------* 04730000
047400                                                                  04740000
047500     COPY DPWS013.                                                04750000
047600                                                                  04760000
047700                                                                  04770000
047800*---------------------------------------------------------------* 04780000
047900*    RC - RECEIPT ITEM TABLE                                    * 04790000
048000*---------------------------------------------------------------* 04800000
048100     EXEC SQL                                                     04810000
048200          INCLUDE TRECITM                                         04820000
048300     END-EXEC.                                                    04830000
048400                                                                  04840000
048500*---------------------------------------------------------------* 04850000
048600*    PO - PURCHASE ITEM TABLE                                   * 04860000
048700*---------------------------------------------------------------* 04870000
048800     EXEC SQL                                                     04880000
048900          INCLUDE TPURITM                                         04890000
049000     END-EXEC.                                                    04900000
049100                                                                  04910000
049200*---------------------------------------------------------------* 04920000
049300*    PO - PURCHASE ORDER TABLE                                  * 04930000
049400*---------------------------------------------------------------* 04940000
049500     EXEC SQL                                                     04950000
049600          INCLUDE TPURCHS                                         04960000
049700     END-EXEC.                                                    04970000
049800                                                                  04980000
049900*---------------------------------------------------------------* 04990000
050000*    RC-RECEIPT DISTRIBUTION                                    * 05000000
050100*---------------------------------------------------------------* 05010000
050200     EXEC SQL                                                     05020000
050300          INCLUDE TRECDIS                                         05030000
050400     END-EXEC.                                                    05040000
050500                                                                  05050000
050600*---------------------------------------------------------------* 05060000
050700*    DC-DISTRIBUTION TRANSACTION HEADER                         * 05070000
050800*---------------------------------------------------------------* 05080000
050900     EXEC SQL                                                     05090000
051000          INCLUDE TDISTHD                                         05100000
051100     END-EXEC.                                                    05110000
051200                                                                  05120000
051300*---------------------------------------------------------------* 05130000
051400*    DC-DISTRIBUTION TRANSACTION DETAIL                         * 05140000
051500*---------------------------------------------------------------* 05150000
051600     EXEC SQL                                                     05160000
051700          INCLUDE TDISTDT                                         05170000
051800     END-EXEC.                                                    05180000
051900                                                                  05190000
052000*---------------------------------------------------------------* 05200000
052700*---------------------------------------------------------------* 05270000
052800*    P2L MODULE TABLE                                           * 05280000
052900*---------------------------------------------------------------* 05290000
053000     EXEC SQL                                                     05300000
053100          INCLUDE TP2LMOD                                         05310000
053200     END-EXEC.                                                    05320000
053300                                                                  05330000
053400*---------------------------------------------------------------* 05340000
053500*      -SKU TABLE                                               * 05350000
053600*---------------------------------------------------------------* 05360000
053700     EXEC SQL                                                     05370000
053800          INCLUDE TSK                                             05380000
053900     END-EXEC.                                                    05390000
054000                                                                  05400000
054100*---------------------------------------------------------------* 05410000
054200*      -COMPANY CONTROL TABLE                                   * 05420000
054300*---------------------------------------------------------------* 05430000
054400     EXEC SQL                                                     05440000
054500          INCLUDE TCOCNTL                                         05450000
054600     END-EXEC.                                                    05460000
054700                                                                  05470000
054710*---------------------------------------------------------------* 05471012
054720*      -OUTBOUND CARTON TABLE  (SUT_OTBND_CART)                 * 05472012
054730*---------------------------------------------------------------* 05473012
054740     EXEC SQL                                                     05474012
054750          INCLUDE SUT00024                                        05475012
054760     END-EXEC.                                                    05476012
054770                                                                  05477012
054780*---------------------------------------------------------------* 05478012
054790*      -OUTBOUND UPC TABLE  (SUT_OTBND_UPC )                 *    05479012
054791*---------------------------------------------------------------* 05479112
054792     EXEC SQL                                                     05479212
054793          INCLUDE SUT00028                                        05479312
054794     END-EXEC.                                                    05479412
054795                                                                  05479512
054796*---------------------------------------------------------------* 05479616
054797*      -PARAMETER TABLE                                      *    05479716
054798*---------------------------------------------------------------* 05479816
054799     EXEC SQL                                                     05479916
054800          INCLUDE TKRPRPM                                         05480016
054801     END-EXEC.                                                    05480116
054802                                                                  05480216
054810*---------------------------------------------------------------* 05481016
054900*    DB2 AREA FOR COMMUNICATIONS                                * 05490000
055000*---------------------------------------------------------------* 05500000
055100     EXEC SQL                                                     05510000
055200          INCLUDE SQLCA                                           05520000
055300     END-EXEC.                                                    05530000
055400                                                                  05540000
055500                                                                  05550000
055600                                                                  05560000
055700 LINKAGE SECTION.                                                 05570000
055800                                                                  05580000
055900 01  DFHCOMMAREA.                                                 05590000
056000     05  FILLER                         OCCURS  1 TO 4072 TIMES   05600000
056100                                        DEPENDING ON EIBCALEN.    05610000
056200         10  FILLER                     PIC X.                    05620000
056300                                                                  05630000
056400                                                                  05640000
056500 PROCEDURE DIVISION.                                              05650000
056600******************************************************************05660000
056700**  THIS MODULE IS THE HIGHEST PROCESSING LEVEL IN THE PROGRAM. **05670000
056800**  FIRST, CALL THE CICS ARCHITECTURE API, PERFORM THE PROGRAM  **05680000
056900**  PROCESSING AND THEN CALL THE CICS ARCHITECTURE API TO EXIT. **05690000
057000******************************************************************05700000
057100 0000-MAIN-MODULE.                                                05710000
057200     INITIALIZE DP030-CICS-API-FIELDS.                            05720000
057300     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       05730000
057400     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          05740000
057500     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         05750000
057600     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       05760000
057700     MOVE LENGTH OF PC702AI        TO DP030-MAP-LENGTH (1).       05770000
057800     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     05780000
057900     PERFORM 0001-CALL-CICS-ARCH-API.                             05790000
058000                                                                  05800000
058100     PERFORM 1000-CONTROL-PROCESSING                              05810000
058200                                                                  05820000
058300     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     05830000
058400     PERFORM 0001-CALL-CICS-ARCH-API.                             05840000
058500                                                                  05850000
058600******************************************************************05860000
058700**  THIS PARAGRAPH CALLS THE CICS ARCHITECTURE API SUBROUTINE   **05870000
058800**  AND WILL ABEND IF ANY ERRORS OCCURRED IN THAT CALL.         **05880000
058900******************************************************************05890000
059000 0001-CALL-CICS-ARCH-API.                                         05900000
1122rm*    CALL 'DPKCS030' USING DFHEIBLK                               05910023
1122RM     CALL DP930-CICS-ARCH-API                                     05911023
1122RM                     USING DFHEIBLK                               05912023
059200                           DFHCOMMAREA                            05920000
059300                           DP030-CICS-API-FIELDS                  05930000
059400                           DP020-STANDARD-COMMAREA                05940000
059500                           PC702AI.                               05950000
059600                                                                  05960000
059700     IF  DP030-RC-CALL-SUCCESSFUL                                 05970000
059800         CONTINUE                                                 05980000
059900     ELSE                                                         05990000
060000         SET DP013-NO-ROLLBACK                                    06000000
060100             DP013-XCTL-DISPLAY-RESTART                           06010000
060200             DP013-CICS-ABEND      TO TRUE                        06020000
060300         MOVE '0001-CALL-CICS-ARCH-API'                           06030000
060400                                   TO DP013-PARAGRAPH             06040000
1122rm*        MOVE 'CALL TO DPKCS030 NOT SUCCESSFUL, RETURN-CODE ON NEX06050023
1122rm*             'T LINE'             TO DP013-MESSAGE-TEXT (2)      06060023
1122RM         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O06061023
1122RM-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      06062023
060700         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      06070000
060800         PERFORM DP013-0000-PROCESS-ABEND                         06080000
060900     END-IF.                                                      06090000
061000                                                                  06100000
061100                                                                  06110000
061200*----------------------------------------------------------------*06120000
061300* PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT      *06130000
061400* COURSE OF ACTION IS FOR THIS TRANSACTION.                      *06140000
061500*----------------------------------------------------------------*06150000
061600 1000-CONTROL-PROCESSING.                                         06160000
061700                                                                  06170000
061800     EVALUATE TRUE                                                06180000
061900         WHEN DP020-NEXT-ACT-INITIAL                              06190000
062000             INITIALIZE ASC-SPECIFIC-COMMAREA                     06200000
062100             MOVE EIBTRMID               TO ASC-PRT-TERM-ID       06210000
062200             MOVE DP020-SRC-TASK-NUMBER  TO ASC-PRT-TASK-NUMBER   06220000
062300             MOVE PC-PRINT-QUEUE-SEQ     TO ASC-PRT-SEQ           06230000
062400             PERFORM 1100-PROCESS-INTER-APPL-COMM                 06240000
062500             IF  PS-COMMAREA-NOT-VALID                            06250000
062600                 SET DP020-NEXT-ACT-APPL-ERROR                    06260000
062700                                   TO TRUE                        06270000
062800             ELSE                                                 06280000
062900                 PERFORM 4000-BUILD-INITIAL-PANEL                 06290000
063000                 PERFORM 3200-RESET-ATTRIBUTES                    06300000
063100             END-IF                                               06310000
063200                                                                  06320000
063300         WHEN DP020-NEXT-ACT-READ-MAP                             06330000
063400             PERFORM 2000-PROCESS-PANEL                           06340000
063500                                                                  06350000
063600         WHEN DP020-NEXT-ACT-RETURN                               06360000
063700             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   06370000
063800             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 06380000
063900             MOVE -1                   TO APONBRL                 06390000
064000                                                                  06400000
064100         WHEN OTHER                                               06410000
064200             SET DP013-LOGIC-ABEND TO TRUE                        06420000
064300             SET DP013-NO-ROLLBACK TO TRUE                        06430000
064400             MOVE '1000-CONTROL-PROCESSING'                       06440000
064500                                   TO DP013-PARAGRAPH             06450000
064600             MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'    06460000
064700                                   TO DP013-MESSAGE-TEXT(1)       06470000
064800             PERFORM DP013-0000-PROCESS-ABEND                     06480000
064900                                                                  06490000
065000     END-EVALUATE.                                                06500000
065100                                                                  06510000
065200*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*06520000
065300* DETERMINE IF DATA WAS PASSED THROUGH INTER-APPL COMMAREA OR    *06530000
065400* IF THERE IS DATA TO BE USED IN THE NAV-KEY FIELD.              *06540000
065500*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*06550000
065600 1100-PROCESS-INTER-APPL-COMM.                                    06560000
065700                                                                  06570000
065800     SET PS-COMMAREA-VALID         TO TRUE.                       06580000
065900     IF  DP020-INT-APPL-FORMAT-IND =  PC-CRIT-SPEC-FORMAT         06590000
066000         MOVE PC120-PO-NBR         TO ASC-PO-NBR                  06600000
066100         MOVE PC120-REC-SEQ-NBR    TO ASC-REC-SEQ-NBR             06610000
066200         MOVE PC120-OPER-UNT-ID    TO ASC-OPER-UNT-ID             06620000
066300         MOVE PC120-FCLTY-ID       TO ASC-FCLTY-ID                06630000
066400         MOVE PC120-CURR-OPER-UNT-ID                              06640000
066500                                   TO ASC-CURR-OPER-UNT-ID        06650000
066600         MOVE PC120-CURR-FCLTY-ID  TO ASC-CURR-FCLTY-ID           06660000
066700         MOVE PC120-SML-P2L-PRTR-ID                               06670000
066800                                   TO ASC-SML-P2L-PRTR-ID         06680000
066900         MOVE PC120-PGYBCK-PRTR-ID TO ASC-PGYBCK-PRTR-ID          06690000
067000         MOVE PC120-DFLT-STR-ZN-ID TO ASC-DFLT-STR-ZN-ID          06700000
067100                                      ASC-DFLT-ORIG-STR-ZN-ID     06710000
067200         MOVE PC120-INPK-UNT-QTY   TO ASC-INPK-UNT-QTY            06720000
067300         MOVE PC120-OTPK-UNT-QTY   TO ASC-OTPK-UNT-QTY            06730000
067400         MOVE PC120-CRE-LBL-IND    TO ASC-CRE-LBL-IND             06740000
067500         MOVE PC120-LBL-PRT-ORDER  TO ASC-LBL-PRT-ORDER           06750000
067600         MOVE PC120-ODD-CARTON     TO ASC-ODD-CARTON              06760000
067700         MOVE PC120-ODD-CRTN-USE-SW TO ASC-ODD-CARTON-USE-SW      06770000
067800         MOVE PC120-DC-PRTD-AT      TO ASC-DC-PRTD-AT             06780019
067810         MOVE PC120-TRIP-ARRIVE-DATE TO ASC-TRIP-ARRIVE-DATE      06781018
067900         EVALUATE TRUE                                            06790000
068000             WHEN ASC-CRE-BOTH-LBL                                06800000
068100                  MOVE  PC-P2L-CASE-DESC  TO  ASC-CRE-LBL-DESC    06810000
068200             WHEN ASC-CRE-P2L-LBL                                 06820000
068300                  MOVE  PC-P2L-LBL-DESC   TO  ASC-CRE-LBL-DESC    06830000
068400             WHEN ASC-CRE-SML-LBL                                 06840000
068500                  MOVE  PC-CASE-LBL-DESC  TO  ASC-CRE-LBL-DESC    06850000
068600         END-EVALUATE                                             06860000
068700         MOVE PC120-SPEC-INST-DESC TO ASC-SPEC-INST-DESC          06870000
068800         MOVE PC120-PO-LINE-NBR    TO ASC-PO-LNE-NBR              06880000
068900         MOVE PC120-PRT-HEAD-FOOT  TO ASC-PRT-HEAD-FOOT           06890000
069000         MOVE PC120-PKGNG-CD       TO ASC-PKGNG-CD                06900000
069100         MOVE PC120-DSPLY-PKGNG-CD TO ASC-DSPLY-PKGNG-CD          06910000
069110         MOVE PC120-DPT-NBR        TO ASC-DEPT                    06911002
069200     END-IF.                                                      06920000
069300                                                                  06930000
069400     IF  DP020-INT-APPL-FORMAT-IND =  PC-LIST-FORMAT              06940000
069500        IF PC122-NUMBER-OF-SELECTED-ITEMS > 0                     06950000
069600           MOVE PC122-PO-NBR         TO ASC-PO-NBR                06960000
069700           MOVE PC122-REC-SEQ-NBR    TO ASC-REC-SEQ-NBR           06970000
069800           MOVE PC122-OPER-UNT-ID    TO ASC-OPER-UNT-ID           06980000
069900           MOVE PC122-FCLTY-ID       TO ASC-FCLTY-ID              06990000
070000           MOVE PC122-CURR-OPER-UNT-ID                            07000000
070100                                     TO ASC-CURR-OPER-UNT-ID      07010000
070200           MOVE PC122-CURR-FCLTY-ID  TO ASC-CURR-FCLTY-ID         07020000
070300           MOVE PC122-SML-P2L-PRTR-ID                             07030000
070400                                     TO ASC-SML-P2L-PRTR-ID       07040000
070500           MOVE PC122-PGYBCK-PRTR-ID TO ASC-PGYBCK-PRTR-ID        07050000
070600           MOVE PC122-DFLT-STR-ZN-ID TO ASC-DFLT-STR-ZN-ID        07060000
070700                                        ASC-DFLT-ORIG-STR-ZN-ID   07070000
070800           MOVE PC122-LBL-PRT-ORDER  TO ASC-CRIT-SPEC-PRT-ORDER   07080000
070900           MOVE PC122-DC-PRTD-AT     TO ASC-DC-PRTD-AT            07090000
071000           MOVE PC122-PKGNG-CD       TO ASC-PKGNG-CD              07100000
071100           MOVE PC122-DSPLY-PKGNG-CD TO ASC-DSPLY-PKGNG-CD        07110000
071110           MOVE PC122-TRIP-ARRIVE-DATE                            07111018
071120                                     TO ASC-TRIP-ARRIVE-DATE      07112018
071200           EVALUATE TRUE                                          07120000
071300               WHEN ASC-CRE-BOTH-LBL                              07130000
071400                  MOVE  PC-P2L-CASE-DESC  TO  ASC-CRE-LBL-DESC    07140000
071500               WHEN ASC-CRE-P2L-LBL                               07150000
071600                  MOVE  PC-P2L-LBL-DESC   TO  ASC-CRE-LBL-DESC    07160000
071700               WHEN ASC-CRE-SML-LBL                               07170000
071800                  MOVE  PC-CASE-LBL-DESC  TO  ASC-CRE-LBL-DESC    07180000
071900           END-EVALUATE                                           07190000
072000           SET ASC-USE-SELECTION-QUEUE   TO TRUE                  07200000
072100           MOVE PC122-NUMBER-OF-TS-ITEMS TO ASC-NUMBER-OF-TS-ITEMS07210000
072200           MOVE PC122-SEL-QUEUE-NAME     TO ASC-SEL-QUEUE-NAME    07220000
072300           PERFORM 1120-PREPARE-LIST-ENTRY                        07230000
072400        ELSE                                                      07240000
072500           MOVE PC-TSYMSG-00057       TO DP020-MSG-NUMBER         07250000
072600           SET  PS-COMMAREA-NOT-VALID TO TRUE                     07260000
072700       END-IF.                                                    07270000
072800                                                                  07280000
072900*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*07290000
073000 1120-PREPARE-LIST-ENTRY.                                         07300000
073100                                                                  07310000
073200     MOVE PC121-MAX-ITEMS          TO ASC-SEL-SUB.                07320000
073300     MOVE ZERO                     TO ASC-SEL-ITEM.               07330000
073400     PERFORM 1130-GET-NEXT-RECORD.                                07340000
073500                                                                  07350000
073600*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*07360000
073700*    GET THE NEXT RECORD IF A LIST OF RECORDS ARE BEING PROCESSED*07370000
073800*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*07380000
073900 1130-GET-NEXT-RECORD.                                            07390000
074000                                                                  07400000
074100     ADD +1                       TO ASC-SEL-SUB.                 07410000
074200                                                                  07420000
074300     IF  ASC-SEL-SUB > PC121-MAX-ITEMS                            07430000
074400         ADD +1                   TO ASC-SEL-ITEM                 07440000
074500         MOVE +1                  TO ASC-SEL-SUB                  07450000
074600     END-IF.                                                      07460000
074700                                                                  07470000
074800     IF  ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                07480000
074900         PERFORM 9100-READ-SEL-QUEUE                              07490000
075000         IF  PC121-ITEM (ASC-SEL-SUB) > ZERO                      07500000
075100             MOVE PC121-PO-LNE-NBR (ASC-SEL-SUB)                  07510000
075200                                  TO ASC-PO-LNE-NBR               07520000
075300             MOVE PC121-CL-NBR  (ASC-SEL-SUB)                     07530000
075400                                  TO ASC-CLASS                    07540000
075500             MOVE PC121-SKU-NBR (ASC-SEL-SUB)                     07550000
075600                                  TO ASC-SKU                      07560000
075700             MOVE PC121-MODU-NBR (ASC-SEL-SUB)                    07570000
075800                                  TO PV-MOD-NBR-N                 07580000
075900             MOVE PV-MOD-NBR-3    TO ASC-MODU-NBR                 07590000
076000             MOVE PC121-INPK-UNT-QTY (ASC-SEL-SUB)                07600000
076100                                  TO ASC-INPK-UNT-QTY             07610000
076200             MOVE PC121-OTPK-UNT-QTY (ASC-SEL-SUB)                07620000
076300                                  TO ASC-OTPK-UNT-QTY             07630000
076400             MOVE PC121-INPK-CNVYB-IND (ASC-SEL-SUB)              07640000
076500                                       TO ASC-INPK-CNVYB-IND      07650000
076600             MOVE PC121-CRE-LBL-IND (ASC-SEL-SUB)                 07660000
076700                                       TO ASC-CRE-LBL-IND         07670000
076800             MOVE PC121-P2L-PRT-HDR-SW (ASC-SEL-SUB)              07680000
076900                                       TO ASC-PRT-HEAD-FOOT       07690000
077000             MOVE PC121-ODD-CARTON     (ASC-SEL-SUB)              07700000
077100                                       TO ASC-ODD-CARTON          07710000
077200             MOVE PC121-ODD-CRTN-USE-SW(ASC-SEL-SUB)              07720000
077300                                       TO ASC-ODD-CARTON-USE-SW   07730000
077400             MOVE PC121-PREPK-ID(ASC-SEL-SUB)                     07740000
077500                                       TO ASC-PREPK-ID            07750000
077600             MOVE PC121-PREPK-RATIO(ASC-SEL-SUB)                  07760000
077700                                       TO ASC-PREPK-RATIO         07770000
077800             MOVE PC121-PACKS-IN-CRTN(ASC-SEL-SUB)                07780000
077900                                       TO ASC-PACKS-IN-CRTN       07790000
078000             MOVE PC121-ITEM-NBR (ASC-SEL-SUB)                    07800000
078100                                       TO ASC-ITM-NBR             07810000
078200             SET PC121-INQ (ASC-SEL-SUB)                          07820000
078300                                  TO TRUE                         07830000
078400             PERFORM 9200-REWRITE-SEL-QUEUE                       07840000
078500         ELSE                                                     07850000
078600             SUBTRACT +1 FROM ASC-SEL-SUB                         07860000
078700             MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER             07870000
078800             SET DP020-MSG-INFORMATIONAL                          07880000
078900                 PS-LIST-END             TO TRUE                  07890000
079000         END-IF                                                   07900000
079100     ELSE                                                         07910000
079200         SUBTRACT +1 FROM ASC-SEL-ITEM                            07920000
079300         MOVE PC121-MAX-ITEMS     TO ASC-SEL-SUB                  07930000
079400         MOVE PC-TSYMSG-00070     TO DP020-MSG-NUMBER             07940000
079500         SET DP020-MSG-INFORMATIONAL                              07950000
079600             PS-LIST-END             TO TRUE                      07960000
079700     END-IF.                                                      07970000
079800                                                                  07980000
079900/                                                                 07990000
080000*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*08000000
080100*    GET THE PREVIOUS RECORD IF A LIST OF RECORDS ARE BEING      *08010000
080200*    PROCESSED.                                                  *08020000
080300*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*08030000
080400                                                                  08040000
080500 1140-GET-PREV-RECORD.                                            08050000
080600                                                                  08060000
080700     SUBTRACT +1 FROM ASC-SEL-SUB.                                08070000
080800                                                                  08080000
080900     IF  ASC-SEL-SUB < +1                                         08090000
081000         SUBTRACT +1 FROM ASC-SEL-ITEM                            08100000
081100         MOVE PC121-MAX-ITEMS     TO ASC-SEL-SUB                  08110000
081200     END-IF.                                                      08120000
081300                                                                  08130000
081400     IF  ASC-SEL-ITEM > ZERO                                      08140000
081500         PERFORM 9100-READ-SEL-QUEUE                              08150000
081600         MOVE PC121-PO-LNE-NBR (ASC-SEL-SUB)                      08160000
081700                              TO ASC-PO-LNE-NBR                   08170000
081800         MOVE PC121-CL-NBR     (ASC-SEL-SUB)                      08180000
081900                              TO ASC-CLASS                        08190000
082000         MOVE PC121-SKU-NBR    (ASC-SEL-SUB)                      08200000
082100                              TO ASC-SKU                          08210000
082200         MOVE PC121-MODU-NBR (ASC-SEL-SUB)                        08220000
082300                              TO PV-MOD-NBR-N                     08230000
082400         MOVE PV-MOD-NBR-3    TO ASC-MODU-NBR                     08240000
082500         MOVE PC121-INPK-UNT-QTY (ASC-SEL-SUB)                    08250000
082600                              TO ASC-INPK-UNT-QTY                 08260000
082700         MOVE PC121-OTPK-UNT-QTY (ASC-SEL-SUB)                    08270000
082800                              TO ASC-OTPK-UNT-QTY                 08280000
082900         MOVE PC121-INPK-CNVYB-IND  (ASC-SEL-SUB)                 08290000
083000                                 TO ASC-INPK-CNVYB-IND            08300000
083100         MOVE PC121-ITEM-NBR (ASC-SEL-SUB)                        08310000
083200                                       TO ASC-ITM-NBR             08320000
083300         SET PC121-INQ (ASC-SEL-SUB)                              08330000
083400                                  TO TRUE                         08340000
083500         PERFORM 9200-REWRITE-SEL-QUEUE                           08350000
083600     ELSE                                                         08360000
083700         MOVE +1                  TO ASC-SEL-ITEM                 08370000
083800                                     ASC-SEL-SUB                  08380000
083900         MOVE PC-TSYMSG-00069     TO DP020-MSG-NUMBER             08390000
084000         SET DP020-MSG-INFORMATIONAL                              08400000
084100             PS-LIST-END             TO TRUE                      08410000
084200     END-IF.                                                      08420000
084300                                                                  08430000
084400                                                                  08440000
084500                                                                  08450000
084600                                                                  08460000
084700 EJECT                                                            08470000
084800                                                                  08480000
084900*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*08490000
085000* DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA   *08500000
085100* ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *08510000
085200* USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *08520000
085300* OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *08530000
085400* FUNCTION KEYS CAN GET THIS FAR.                                *08540000
085500*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*08550000
085600 2000-PROCESS-PANEL.                                              08560000
085700                                                                  08570000
085800     EVALUATE TRUE                                                08580000
085900         WHEN DP020-SRC-AID = DP016-CLEAR                         08590000
086000             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   08600000
086100             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 08610000
086200                                                                  08620000
086300         WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    08630000
086400             PERFORM 4000-BUILD-INITIAL-PANEL                     08640000
086500             PERFORM 3200-RESET-ATTRIBUTES                        08650000
086600                                                                  08660000
086700         WHEN DP020-FK-NEXT-SELECTION (DP020-SRC-AID)             08670000
086800             IF  ASC-USE-SELECTION-QUEUE                          08680000
086900                 PERFORM 1130-GET-NEXT-RECORD                     08690000
087000                 IF PS-LIST-END                                   08700000
087100                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         08710000
087200                     SET PS-NO-LIST-END TO TRUE                   08720000
087300                 ELSE                                             08730000
087400                     PERFORM 4000-BUILD-INITIAL-PANEL             08740000
087500                     PERFORM 3200-RESET-ATTRIBUTES                08750000
087600                 END-IF                                           08760000
087700              ELSE                                                08770000
087800*                --- BOTTOM OF LIST ---                           08780000
087900                 MOVE PC-TSYMSG-00070                             08790000
088000                                   TO DP020-MSG-NUMBER            08800000
088100                 SET DP020-MSG-INFORMATIONAL                      08810000
088200                                   TO TRUE                        08820000
088300             END-IF                                               08830000
088400                                                                  08840000
088500         WHEN DP020-FK-PREV-SELECTION (DP020-SRC-AID)             08850000
088600             IF  ASC-USE-SELECTION-QUEUE                          08860000
088700                 PERFORM 1140-GET-PREV-RECORD                     08870000
088800                 IF PS-LIST-END                                   08880000
088900                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         08890000
089000                     SET PS-NO-LIST-END                           08900000
089100                                   TO TRUE                        08910000
089200                 ELSE                                             08920000
089300                     PERFORM 4000-BUILD-INITIAL-PANEL             08930000
089400                     PERFORM 3200-RESET-ATTRIBUTES                08940000
089500                 END-IF                                           08950000
089600             ELSE                                                 08960000
089700                 MOVE PC-TSYMSG-00069                             08970000
089800                                   TO DP020-MSG-NUMBER            08980000
089900                 SET DP020-MSG-INFORMATIONAL                      08990000
090000                                   TO TRUE                        09000000
090100             END-IF                                               09010000
090200                                                                  09020000
090300         WHEN OTHER                                               09030000
090400             PERFORM 2010-CHECK-CICS-NETWORK                      09040000
090500             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 09050000
090600             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   09060000
090700             IF  PS-NO-ERROR                                      09070000
090800                 SET DP030-CONTINUE-GO                            09080000
090900                                 TO TRUE                          09090000
091000                 PERFORM 2100-CHECK-FUNCTION-KEY                  09100000
091100             ELSE                                                 09110000
091200                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             09120000
091300                 SET DP030-OVERRIDE-GO                            09130000
091400                                 TO TRUE                          09140000
091500             END-IF                                               09150000
091600     END-EVALUATE.                                                09160000
091700                                                                  09170000
091800                                                                  09180000
091900*----------------------------------------------------------------*09190000
092000*  DETERMINE WHAT CICS NETWORK YOU ARE WORKING IN                *09200000
092100*----------------------------------------------------------------*09210000
092200 2010-CHECK-CICS-NETWORK.                                         09220000
092300                                                                  09230000
092400      EXEC CICS                                                   09240000
092500          ASSIGN                                                  09250000
092600              USERID (ASC-SIGNON-USERID)                          09260000
092700      END-EXEC.                                                   09270000
092800                                                                  09280000
092900                                                                  09290000
093000*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*09300000
093100* ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED FIRST.*09310000
093200* NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED FROM THE  *09320000
093300* CICS ARCHITECTURE API.                                         *09330000
093400*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*09340000
093500 2100-CHECK-FUNCTION-KEY.                                         09350000
093600                                                                  09360000
093700     EVALUATE TRUE                                                09370000
093800                                                                  09380000
093900* F18 - LABEL REPRINT (LOCAL-FUNC-02)                             09390000
094000                                                                  09400000
094100         WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              09410000
094200             PERFORM 5000-PREPARE-SEL-QUEUE                       09420000
094300                                                                  09430000
094400* F17 - STORE LIST (LOCAL-FUNC-01)                                09440000
094500                                                                  09450000
094600         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              09460000
094700             MOVE ASC-PO-NBR             TO PC120-PO-NBR          09470000
094800             MOVE ASC-REC-SEQ-NBR        TO PC120-REC-SEQ-NBR     09480000
094900             MOVE ASC-OPER-UNT-ID        TO PC120-OPER-UNT-ID     09490000
095000             MOVE ASC-FCLTY-ID           TO PC120-FCLTY-ID        09500000
095100             MOVE ASC-CURR-OPER-UNT-ID   TO PC120-CURR-OPER-UNT-ID09510000
095200             MOVE ASC-CURR-FCLTY-ID      TO PC120-CURR-FCLTY-ID   09520000
095300             MOVE ASC-SML-P2L-PRTR-ID    TO PC120-SML-P2L-PRTR-ID 09530000
095400             MOVE ASC-PGYBCK-PRTR-ID     TO PC120-PGYBCK-PRTR-ID  09540000
095500             MOVE ASC-MODU-NBR           TO PC120-MODU-NBR        09550000
095600             IF  ASC-SPEC-INST-DESC  >  SPACES                    09560000
095700                 MOVE ASC-SPEC-INST-DESC   TO PC120-DFLT-STR-ZN-ID09570000
095800             ELSE                                                 09580000
095900                 MOVE ASC-DFLT-STR-ZN-ID   TO PC120-DFLT-STR-ZN-ID09590000
096000             END-IF                                               09600000
096100             MOVE ASC-PROC-CART-CNT        TO PC120-CART-CNT      09610000
096200             MOVE ASC-INPK-UNT-QTY         TO PC120-INPK-UNT-QTY  09620000
096300             MOVE ASC-OTPK-UNT-QTY         TO PC120-OTPK-UNT-QTY  09630000
096400             MOVE ASC-CRE-LBL-IND          TO PC120-CRE-LBL-IND   09640000
096500             MOVE ASC-LBL-PRT-ORDER        TO PC120-LBL-PRT-ORDER 09650000
096600             MOVE ASC-SPEC-INST-DESC       TO PC120-SPEC-INST-DESC09660000
096700             MOVE ASC-PO-LNE-NBR           TO PC120-PO-LINE-NBR   09670000
096800             MOVE ASC-ODD-CARTON           TO PC120-ODD-CARTON    09680000
096900             MOVE ASC-ODD-CARTON-USE-SW  TO PC120-ODD-CRTN-USE-SW 09690000
097000             MOVE ASC-PKGNG-CD            TO PC120-PKGNG-CD       09700000
097100             MOVE ASC-DSPLY-PKGNG-CD      TO PC120-DSPLY-PKGNG-CD 09710000
097200             MOVE ASC-PREPK-RATIO         TO PC120-PREPK-RATIO    09720000
097300             MOVE ASC-PREPK-ID            TO PC120-PREPK-ID       09730000
097400             MOVE ASC-PACKS-IN-CRTN       TO PC120-PACKS-IN-CRTN  09740000
097410             MOVE ASC-DEPT                TO PC120-DPT-NBR        09741002
097411             MOVE ASC-TRIP-ARRIVE-DATE TO PC120-TRIP-ARRIVE-DATE  09741118
097420             MOVE ASC-USE-UCC128-DATA-SW                          09742010
097430                            TO PC120-USE-UCC128-DATA-SW           09743010
097500                                                                  09750000
097600                                                                  09760000
097700         WHEN DP020-FK-FIRST-PAGE(DP020-SRC-AID)                  09770000
097800             PERFORM 3200-RESET-ATTRIBUTES                        09780000
097900             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 09790000
098000                                                                  09800000
098100                                                                  09810000
098200         WHEN DP020-SRC-AID = DP016-ENTER                         09820000
098300             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 09830000
098400                                                                  09840000
098500                                                                  09850000
098600         WHEN OTHER                                               09860000
098700             SET DP013-NO-ROLLBACK                                09870000
098800                 DP013-XCTL-DISPLAY-RESTART                       09880000
098900                 DP013-CICS-ABEND  TO TRUE                        09890000
099000             MOVE '2100-CHECK-FUNCTION-KEY'                       09900000
099100                                   TO DP013-PARAGRAPH             09910000
099200             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      09920000
099300                                   TO DP013-MESSAGE-TEXT (1)      09930000
099400             PERFORM DP013-0000-PROCESS-ABEND                     09940000
099500     END-EVALUATE.                                                09950000
099600                                                                  09960000
099700 2200-MOVE-SCREEN-TO-COMMAREA.                                    09970000
099800                                                                  09980000
099900                                                                  09990000
100000     IF  AP2PRTL > ZERO                                           10000000
100100         MOVE AP2PRTI          TO ASC-SML-P2L-PRTR-ID             10010000
100200     ELSE                                                         10020000
100300         IF  AP2PRTF = DP015-ERASE-EOF                            10030000
100400             MOVE  SPACES      TO ASC-SML-P2L-PRTR-ID             10040000
100500         END-IF                                                   10050000
100600     END-IF.                                                      10060000
100700                                                                  10070000
100800     IF  APBPRTL > ZERO                                           10080000
100900         MOVE APBPRTI          TO ASC-PGYBCK-PRTR-ID              10090000
101000     ELSE                                                         10100000
101100         IF  APBPRTF = DP015-ERASE-EOF                            10110000
101200             MOVE  SPACES      TO ASC-PGYBCK-PRTR-ID              10120000
101300         END-IF                                                   10130000
101400     END-IF.                                                      10140000
101500                                                                  10150000
101600     IF  APRALLL > ZERO                                           10160000
101700         MOVE APRALLI          TO ASC-PRT-P2L-ALL                 10170000
101800     ELSE                                                         10180000
101900         IF  APRALLF = DP015-ERASE-EOF                            10190000
102000             MOVE  SPACES      TO ASC-PRT-P2L-ALL                 10200000
102100         END-IF                                                   10210000
102200     END-IF.                                                      10220000
102300                                                                  10230000
102400     IF  APRFRML > ZERO                                           10240000
102500         MOVE APRFRMI          TO ASC-PRT-P2L-FROM                10250000
102600     ELSE                                                         10260000
102700         IF  APRFRMF = DP015-ERASE-EOF                            10270000
102800             MOVE  SPACES      TO ASC-PRT-P2L-FROM                10280000
102900         END-IF                                                   10290000
103000     END-IF.                                                      10300000
103100                                                                  10310000
103200     IF  APRTOL > ZERO                                            10320000
103300         MOVE APRTOI           TO ASC-PRT-P2L-TO                  10330000
103400     ELSE                                                         10340000
103500         IF  APRTOF = DP015-ERASE-EOF                             10350000
103600             MOVE  SPACES      TO ASC-PRT-P2L-TO                  10360000
103700         END-IF                                                   10370000
103800     END-IF.                                                      10380000
103900                                                                  10390000
104000     IF  APRSALLL > ZERO                                          10400000
104100         MOVE APRSALLI         TO ASC-PRT-SHP-ALL                 10410000
104200     ELSE                                                         10420000
104300         IF  APRSALLF = DP015-ERASE-EOF                           10430000
104400             MOVE  SPACES      TO ASC-PRT-SHP-ALL                 10440000
104500         END-IF                                                   10450000
104600     END-IF.                                                      10460000
104700                                                                  10470000
104800     IF  APRSFRML > ZERO                                          10480000
104900         MOVE APRSFRMI         TO ASC-PRT-SHP-FROM                10490000
105000     ELSE                                                         10500000
105100         IF  APRSFRMF = DP015-ERASE-EOF                           10510000
105200             MOVE  SPACES      TO ASC-PRT-SHP-FROM                10520000
105300         END-IF                                                   10530000
105400     END-IF.                                                      10540000
105500                                                                  10550000
105600     IF  APRSTOL > ZERO                                           10560000
105700         MOVE APRSTOI          TO ASC-PRT-SHP-TO                  10570000
105800     ELSE                                                         10580000
105900         IF  APRSTOF = DP015-ERASE-EOF                            10590000
106000             MOVE  SPACES      TO ASC-PRT-SHP-TO                  10600000
106100         END-IF                                                   10610000
106200     END-IF.                                                      10620000
106300                                                                  10630000
106400                                                                  10640000
106500     IF  APRSIOL > ZERO                                           10650000
106600         MOVE APRSIOI           TO ASC-PRT-IO                     10660000
106700     ELSE                                                         10670000
106800         IF  APRSIOF = DP015-ERASE-EOF                            10680000
106900             MOVE  SPACES      TO ASC-PRT-IO                      10690000
107000         END-IF                                                   10700000
107100     END-IF.                                                      10710000
107200                                                                  10720000
107300     IF ALBSIL > ZERO                                             10730000
107400         MOVE ALBSII             TO ASC-SPEC-INST-DESC            10740000
107500     ELSE                                                         10750000
107600         IF  ALBSIF = DP015-ERASE-EOF                             10760000
107700             MOVE  SPACES        TO ASC-SPEC-INST-DESC            10770000
107800         END-IF                                                   10780000
107900     END-IF.                                                      10790000
108000                                                                  10800000
108100     IF  ALBORDL > ZERO                                           10810000
108200         MOVE ALBORDI          TO ASC-LBL-PRT-ORDER               10820000
108300     ELSE                                                         10830000
108400         IF  ALBORDF = DP015-ERASE-EOF                            10840000
108500             MOVE  SPACES      TO ASC-LBL-PRT-ORDER               10850000
108600         END-IF                                                   10860000
108700     END-IF.                                                      10870000
108800                                                                  10880000
108900     IF  ALBTYPL > ZERO                                           10890000
109000         MOVE ALBTYPI          TO ASC-LBL-PRT-TYPE                10900000
109100     ELSE                                                         10910000
109200         IF  ALBTYPF = DP015-ERASE-EOF                            10920000
109300             MOVE  SPACES      TO ASC-LBL-PRT-TYPE                10930000
109400         END-IF                                                   10940000
109500     END-IF.                                                      10950000
109600                                                                  10960000
109700     IF  ALBSIL > ZERO                                            10970000
109800         MOVE ALBSII           TO ASC-PRT-SI                      10980000
109900     ELSE                                                         10990000
110000         IF  ALBSIF = DP015-ERASE-EOF                             11000000
110100             MOVE  SPACES      TO ASC-PRT-SI                      11010000
110200         END-IF                                                   11020000
110300     END-IF.                                                      11030000
110400                                                                  11040000
110500     IF  AMODLL > ZERO                                            11050000
110600         MOVE AMODLI           TO ASC-MODU-NBR-OVERRIDE           11060000
110700     ELSE                                                         11070000
110800         IF  AMODLF = DP015-ERASE-EOF                             11080000
110900             MOVE  SPACES      TO ASC-MODU-NBR-OVERRIDE           11090000
111000         END-IF                                                   11100000
111100     END-IF.                                                      11110000
111200                                                                  11120000
111300                                                                  11130000
111400                                                                  11140000
111500*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*11150000
111600*  EDIT ALL OF THE DATA ON THE SCREEN AS IT RESIDES IN THE       *11160000
111700*  COMMAREA (EDITTING IS NOT DONE AGAINST THE SCREEN DIRECTLY).  *11170000
111800*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*11180000
111900 3000-EDIT-DATA-IN-COMMAREA.                                      11190000
112000     SET PS-NO-ERROR               TO TRUE.                       11200000
112100                                                                  11210000
112200     PERFORM 3200-RESET-ATTRIBUTES.                               11220000
112430*  VALIDATE LABEL TYPE                                            11243000
112500*                                                                 11250000
112600                                                                  11260000
112700     IF ASC-PRT-SHP-ALL  > SPACES                                 11270000
112800     OR ASC-PRT-SHP-FROM > SPACES                                 11280000
112900     OR ASC-PRT-SHP-TO   > SPACES                                 11290000
113000        IF ASC-LBL-PRT-TYPE = PC-S OR PC-P                        11300000
113100           CONTINUE                                               11310000
113200        ELSE                                                      11320000
113300           SET PS-ERROR                                           11330000
113400           DP020-MSG-FATAL       TO TRUE                          11340000
113500           MOVE PC-TSYMSG-00005      TO DP020-MSG-NUMBER          11350000
113600           MOVE DP015-UNP-ALP-BRT-OFF                             11360000
113700                                     TO ALBTYPA                   11370000
113800           MOVE DP015-RED            TO ALBTYPC                   11380000
113900           MOVE DP015-REVERSE        TO ALBTYPH                   11390000
114000           MOVE -1                   TO ALBTYPL                   11400000
114100           SET DP030-SET-CURSOR-APPL-1 TO TRUE                    11410000
114200        END-IF                                                    11420000
114300     END-IF.                                                      11430000
114400                                                                  11440000
114500*                                                                 11450000
114600*  PIGGYBACK CANNOT BE PRINTED IN SHUFFLED ORDER AND CANNOT       11460000
114700*  BE REQUESTED TO REPRINT TO/FROM, SO PROTECT THESE FIELDS.      11470000
114800*                                                                 11480000
114900                                                                  11490000
115000     IF ASC-LBL-PRT-TYPE = PC-P                                   11500000
115100        MOVE PC-R              TO ASC-LBL-PRT-ORDER               11510000
115200        MOVE ASC-LBL-PRT-ORDER TO ALBORDO                         11520000
115300        MOVE DP015-PRO-NOR-OFF    TO APRSFRMA                     11530000
115400                                     APRSTOA                      11540000
115500                                     ALBORDA                      11550000
115600        MOVE DP015-BLUE           TO APRSFRMC                     11560000
115700                                     APRSTOC                      11570000
115800                                     ALBORDC                      11580000
115900     END-IF.                                                      11590000
116000*                                                                 11600000
116100*  VALIDATE PRINT ORDER                                           11610000
116200*                                                                 11620000
116300                                                                  11630000
116400     IF PS-NO-ERROR                                               11640000
116500         IF ASC-LBL-PRT-ORDER = PC-S OR PC-R OR PC-D              11650003
116600             CONTINUE                                             11660000
116700         ELSE                                                     11670000
116800             IF ASC-PRT-SHP-ALL  > SPACES                         11680000
116900             OR ASC-PRT-SHP-FROM > SPACES                         11690000
117000             OR ASC-PRT-SHP-TO   > SPACES                         11700000
117100                SET PS-ERROR                                      11710000
117200                DP020-MSG-FATAL   TO TRUE                         11720000
117300                MOVE PC-TSYMSG-00763  TO DP020-MSG-NUMBER         11730000
117400                MOVE DP015-UNP-ALP-BRT-OFF                        11740000
117500                                          TO ALBORDA              11750000
117600                MOVE DP015-RED        TO ALBORDC                  11760000
117700                MOVE DP015-REVERSE    TO ALBORDH                  11770000
117800                MOVE -1               TO ALBORDL                  11780000
117900                SET DP030-SET-CURSOR-APPL-1 TO TRUE               11790000
118000             ELSE                                                 11800000
118100                MOVE SPACE TO ASC-LBL-PRT-ORDER                   11810000
118200             END-IF                                               11820000
118300         END-IF                                                   11830000
118400     END-IF.                                                      11840000
118500                                                                  11850000
118600*                                                                 11860000
118700*  VALIDATE LABEL I/O                                             11870000
118800*                                                                 11880000
118900     IF PS-NO-ERROR                                               11890000
119000        IF ASC-PRT-IO  = PC-I OR PC-O OR SPACES                   11900000
119100            CONTINUE                                              11910000
119200        ELSE                                                      11920000
119300            SET PS-ERROR                                          11930000
119400            DP020-MSG-FATAL       TO TRUE                         11940000
119500            MOVE PC-TSYMSG-00005      TO DP020-MSG-NUMBER         11950000
119600            MOVE DP015-UNP-ALP-BRT-OFF                            11960000
119700                                      TO APRSIOA                  11970000
119800            MOVE DP015-RED            TO APRSIOC                  11980000
119900            MOVE DP015-REVERSE        TO APRSIOH                  11990000
120000            MOVE -1                   TO APRSIOL                  12000000
120100            SET DP030-SET-CURSOR-APPL-1 TO TRUE                   12010000
120200        END-IF.                                                   12020000
120300                                                                  12030000
120400*                                                                 12040000
120500*  VALIDATE P2L REPRINT ALL FLAG                                  12050000
120600*                                                                 12060000
120700                                                                  12070000
120800     IF ASC-PRT-P2L-ALL = SPACES OR PC-Y OR PC-X OR PC-S          12080000
120900         CONTINUE                                                 12090000
121000     ELSE                                                         12100000
121100         SET PS-ERROR                                             12110000
121200         DP020-MSG-FATAL       TO TRUE                            12120000
121300         MOVE PC-TSYMSG-00005      TO DP020-MSG-NUMBER            12130000
121400         MOVE DP015-UNP-ALP-BRT-OFF                               12140000
121500                                   TO APRALLA                     12150000
121600         MOVE DP015-RED            TO APRALLC                     12160000
121700         MOVE DP015-REVERSE        TO APRALLH                     12170000
121800         MOVE -1                   TO APRALLL                     12180000
121900         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      12190000
122000     END-IF.                                                      12200000
122100*                                                                 12210000
122200*  CANNOT ENTER 'ALL' AND 'TO/FROM'                               12220000
122300*                                                                 12230000
122400                                                                  12240000
122500     IF PS-NO-ERROR                                               12250000
122600        IF ASC-PRT-P2L-ALL = PC-Y OR PC-S OR PC-X                 12260000
122700           IF ASC-PRT-P2L-FROM >  SPACES OR                       12270000
122800              ASC-PRT-P2L-TO >  SPACES                            12280000
122900              SET PS-ERROR                                        12290000
123000              DP020-MSG-FATAL       TO TRUE                       12300000
123100              MOVE PC-TSYMSG-01814      TO DP020-MSG-NUMBER       12310000
123200              MOVE DP015-UNP-ALP-BRT-OFF                          12320000
123300                                        TO APRFRMA                12330000
123400              MOVE DP015-RED            TO APRFRMC                12340000
123500              MOVE DP015-REVERSE        TO APRFRMH                12350000
123600              MOVE -1                   TO APRFRML                12360000
123700              SET DP030-SET-CURSOR-APPL-1 TO TRUE                 12370000
123800           END-IF                                                 12380000
123900        END-IF                                                    12390000
124000     END-IF.                                                      12400000
124100                                                                  12410000
124200     IF PS-NO-ERROR                                               12420000
124300        IF ASC-PRT-SHP-ALL = PC-Y OR PC-S OR PC-X                 12430000
124400           IF ASC-PRT-SHP-FROM >  SPACES OR                       12440000
124500              ASC-PRT-SHP-TO >  SPACES                            12450000
124600              SET PS-ERROR                                        12460000
124700              DP020-MSG-FATAL       TO TRUE                       12470000
124800              MOVE PC-TSYMSG-01814      TO DP020-MSG-NUMBER       12480000
124900              MOVE DP015-UNP-ALP-BRT-OFF                          12490000
125000                                        TO APRSFRMA               12500000
125100              MOVE DP015-RED            TO APRSFRMC               12510000
125200              MOVE DP015-REVERSE        TO APRSFRMH               12520000
125300              MOVE -1                   TO APRSFRML               12530000
125400              SET DP030-SET-CURSOR-APPL-1 TO TRUE                 12540000
125500           END-IF                                                 12550000
125600        END-IF                                                    12560000
125700     END-IF.                                                      12570000
125800*                                                                 12580000
125900*  VALIDATE SHIP REPRINT ALL FLAG                                 12590000
126000*                                                                 12600000
126100                                                                  12610000
126200     IF ASC-PRT-SHP-ALL = SPACES OR PC-Y OR PC-X OR PC-S          12620000
126300         CONTINUE                                                 12630000
126400     ELSE                                                         12640000
126500         SET PS-ERROR                                             12650000
126600         DP020-MSG-FATAL       TO TRUE                            12660000
126700         MOVE PC-TSYMSG-00005      TO DP020-MSG-NUMBER            12670000
126800         MOVE DP015-UNP-ALP-BRT-OFF                               12680000
126900                                   TO APRSALLA                    12690000
127000         MOVE DP015-RED            TO APRSALLC                    12700000
127100         MOVE DP015-REVERSE        TO APRSALLH                    12710000
127200         MOVE -1                   TO APRSALLL                    12720000
127300         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      12730000
127400     END-IF.                                                      12740000
127500                                                                  12750000
127600*                                                                 12760000
127700*  VALIDATE P2L 'FROM'                                            12770000
127800*                                                                 12780000
127900                                                                  12790000
128000     IF PS-NO-ERROR                                               12800000
128100       IF  ASC-PRT-P2L-FROM > SPACES                              12810000
128200         MOVE ASC-PRT-P2L-FROM            TO DP010I-UNEDITED-FIELD12820000
128300         MOVE LENGTH OF ASC-PRT-P2L-FROM  TO DP010I-MAXIMUM-DIGITS12830000
128400         MOVE ZERO                      TO DP010I-MAXIMUM-DECIMALS12840000
128500         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  12850000
128610         CALL DP010I-NUMERIC-EDIT-ROUTINE                         12861020
128620                         USING DP010I-NUMERIC-EDIT-AREA           12862020
128700         IF  DP010I-ERROR-DETECTED                                12870000
128800             SET PS-ERROR                                         12880000
128900                 DP020-MSG-FATAL       TO TRUE                    12890000
129000             MOVE PC-TSYMSG-00008      TO DP020-MSG-NUMBER        12900000
129100             MOVE DP015-UNP-NUM-BRT-OFF                           12910000
129200                                       TO APRFRMA                 12920000
129300             MOVE DP015-RED            TO APRFRMC                 12930000
129400             MOVE DP015-REVERSE        TO APRFRMH                 12940000
129500             MOVE -1                   TO APRFRML                 12950000
129600             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  12960000
129700         ELSE                                                     12970000
129800             MOVE DP010I-NUMERIC-FIELD                            12980000
129900                                   TO ASC-PRT-P2L-FROM-N          12990000
130000                                      APRFRMO                     13000000
130100         END-IF                                                   13010000
130200         IF ASC-PRT-P2L-FROM-N > ASC-P2L-CART-CNT                 13020000
130300             SET PS-ERROR                                         13030000
130400                 DP020-MSG-FATAL       TO TRUE                    13040000
130500             MOVE PC-TSYMSG-01846      TO DP020-MSG-NUMBER        13050000
130600             MOVE DP015-UNP-NUM-BRT-OFF                           13060000
130700                                       TO APRFRMA                 13070000
130800             MOVE DP015-RED            TO APRFRMC                 13080000
130900             MOVE DP015-REVERSE        TO APRFRMH                 13090000
131000             MOVE -1                   TO APRFRML                 13100000
131100             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  13110000
131200       END-IF                                                     13120000
131300     END-IF.                                                      13130000
131400                                                                  13140000
131500*                                                                 13150000
131600*  VALIDATE P2L 'TO'                                              13160000
131700*                                                                 13170000
131800                                                                  13180000
131900     IF PS-NO-ERROR                                               13190000
132000       IF  ASC-PRT-P2L-TO   > SPACES                              13200000
132100         MOVE ASC-PRT-P2L-TO              TO DP010I-UNEDITED-FIELD13210000
132200         MOVE LENGTH OF ASC-PRT-P2L-TO    TO DP010I-MAXIMUM-DIGITS13220000
132300         MOVE ZERO                      TO DP010I-MAXIMUM-DECIMALS13230000
132400         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  13240000
132510         CALL DP010I-NUMERIC-EDIT-ROUTINE                         13251020
132520                         USING DP010I-NUMERIC-EDIT-AREA           13252020
132600         IF  DP010I-ERROR-DETECTED                                13260000
132700             SET PS-ERROR                                         13270000
132800                 DP020-MSG-FATAL       TO TRUE                    13280000
132900             MOVE PC-TSYMSG-00008      TO DP020-MSG-NUMBER        13290000
133000             MOVE DP015-UNP-NUM-BRT-OFF                           13300000
133100                                       TO APRTOA                  13310000
133200             MOVE DP015-RED            TO APRTOC                  13320000
133300             MOVE DP015-REVERSE        TO APRTOH                  13330000
133400             MOVE -1                   TO APRTOL                  13340000
133500             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  13350000
133600         ELSE                                                     13360000
133700             MOVE DP010I-NUMERIC-FIELD                            13370000
133800                                   TO ASC-PRT-P2L-TO-N            13380000
133900                                      APRTOO                      13390000
134000         END-IF                                                   13400000
134100         IF ASC-PRT-P2L-TO-N > ASC-P2L-CART-CNT                   13410000
134200             SET PS-ERROR                                         13420000
134300                 DP020-MSG-FATAL       TO TRUE                    13430000
134400             MOVE PC-TSYMSG-01846      TO DP020-MSG-NUMBER        13440000
134500             MOVE DP015-UNP-NUM-BRT-OFF                           13450000
134600                                       TO APRTOA                  13460000
134700             MOVE DP015-RED            TO APRTOC                  13470000
134800             MOVE DP015-REVERSE        TO APRTOH                  13480000
134900             MOVE -1                   TO APRTOL                  13490000
135000             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  13500000
135100         END-IF                                                   13510000
135200       END-IF                                                     13520000
135300     END-IF.                                                      13530000
135400                                                                  13540000
135500                                                                  13550000
135600*                                                                 13560000
135700*  VALIDATE P2L MODULE OVERRIDE                                   13570000
135800*                                                                 13580000
135900                                                                  13590000
136000     IF PS-NO-ERROR                                               13600000
136100         EVALUATE TRUE                                            13610000
136200         WHEN ASC-PRT-P2L-ALL NOT = SPACES                        13620000
136300             IF ASC-MODU-NBR-OVERRIDE NOT = ZERO                  13630000
136400                 PERFORM 3040-VALIDATE-MODULE-OVERRIDE            13640000
136500             END-IF                                               13650000
136600         WHEN ASC-PRT-P2L-TO   > SPACES                           13660000
136700                 AND ASC-MODU-NBR-OVERRIDE > ZEROES               13670000
136800             SET PS-ERROR                                         13680000
136900                 DP020-MSG-FATAL       TO TRUE                    13690000
137000             MOVE PC-TSYMSG-01842      TO DP020-MSG-NUMBER        13700000
137100             MOVE DP015-UNP-NUM-BRT-OFF                           13710000
137200                                       TO AMODLA                  13720000
137300             MOVE DP015-RED            TO AMODLC                  13730000
137400             MOVE DP015-REVERSE        TO AMODLH                  13740000
137500             MOVE -1                   TO AMODLL                  13750000
137600             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  13760000
137700         END-EVALUATE                                             13770000
137800     END-IF.                                                      13780000
137900*                                                                 13790000
138000*  VALIDATE SHIP 'FROM'                                           13800000
138100*                                                                 13810000
138200                                                                  13820000
138300     IF PS-NO-ERROR                                               13830000
138400       IF  ASC-PRT-SHP-FROM > SPACES                              13840000
138500         MOVE ASC-PRT-SHP-FROM            TO DP010I-UNEDITED-FIELD13850000
138600         MOVE LENGTH OF ASC-PRT-SHP-FROM  TO DP010I-MAXIMUM-DIGITS13860000
138700         MOVE ZERO                      TO DP010I-MAXIMUM-DECIMALS13870000
138800         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  13880000
138910         CALL DP010I-NUMERIC-EDIT-ROUTINE                         13891020
138920                         USING DP010I-NUMERIC-EDIT-AREA           13892020
139000         IF  DP010I-ERROR-DETECTED                                13900000
139100             SET PS-ERROR                                         13910000
139200                 DP020-MSG-FATAL       TO TRUE                    13920000
139300             MOVE PC-TSYMSG-00008      TO DP020-MSG-NUMBER        13930000
139400             MOVE DP015-UNP-NUM-BRT-OFF                           13940000
139500                                       TO APRSFRMA                13950000
139600             MOVE DP015-RED            TO APRSFRMC                13960000
139700             MOVE DP015-REVERSE        TO APRSFRMH                13970000
139800             MOVE -1                   TO APRSFRML                13980000
139900             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  13990000
140000         ELSE                                                     14000000
140100             MOVE DP010I-NUMERIC-FIELD                            14010000
140200                                   TO ASC-PRT-SHP-FROM-N          14020000
140300                                      APRSFRMO                    14030000
140400         END-IF                                                   14040000
140500       END-IF                                                     14050000
140600     END-IF.                                                      14060000
140700                                                                  14070000
140800*                                                                 14080000
140900*  VALIDATE SHIP 'TO'                                             14090000
141000*                                                                 14100000
141100                                                                  14110000
141200     IF PS-NO-ERROR                                               14120000
141300       IF  ASC-PRT-SHP-TO   > SPACES                              14130000
141400         MOVE ASC-PRT-SHP-TO              TO DP010I-UNEDITED-FIELD14140000
141500         MOVE LENGTH OF ASC-PRT-SHP-TO    TO DP010I-MAXIMUM-DIGITS14150000
141600         MOVE ZERO                      TO DP010I-MAXIMUM-DECIMALS14160000
141700         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  14170000
141810         CALL DP010I-NUMERIC-EDIT-ROUTINE                         14181020
141820                         USING DP010I-NUMERIC-EDIT-AREA           14182020
141900         IF  DP010I-ERROR-DETECTED                                14190000
142000             SET PS-ERROR                                         14200000
142100                 DP020-MSG-FATAL       TO TRUE                    14210000
142200             MOVE PC-TSYMSG-00008      TO DP020-MSG-NUMBER        14220000
142300             MOVE DP015-UNP-NUM-BRT-OFF                           14230000
142400                                       TO APRSTOA                 14240000
142500             MOVE DP015-RED            TO APRSTOC                 14250000
142600             MOVE DP015-REVERSE        TO APRSTOH                 14260000
142700             MOVE -1                   TO APRSTOL                 14270000
142800             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  14280000
142900         ELSE                                                     14290000
143000             MOVE DP010I-NUMERIC-FIELD                            14300000
143100                                   TO ASC-PRT-SHP-TO-N            14310000
143200                                      APRSTOO                     14320000
143300         END-IF                                                   14330000
143400       END-IF                                                     14340000
143500     END-IF.                                                      14350000
143600                                                                  14360000
143700                                                                  14370000
143800*                                                                 14380000
143900*  IF PIGGYBACK LBL TYPE - CANNOT USE FROM-TO OPTION              14390000
144000*                                                                 14400000
144100                                                                  14410000
144200     IF  ASC-LBL-PRT-TYPE = PC-P                                  14420000
144300         IF  ASC-PRT-SHP-TO-N    >  ZERO  OR                      14430000
144400             ASC-PRT-SHP-FROM-N  >  ZERO                          14440000
144500                 SET PS-ERROR                                     14450000
144600                     DP020-MSG-FATAL   TO TRUE                    14460000
144700                 MOVE PC-TSYMSG-01952  TO DP020-MSG-NUMBER        14470000
144800                 MOVE DP015-UNP-ALP-BRT-OFF                       14480000
144900                                       TO ALBTYPA                 14490000
145000                 MOVE DP015-RED        TO ALBTYPC                 14500000
145100                 MOVE DP015-REVERSE    TO ALBTYPH                 14510000
145200                 MOVE -1               TO ALBTYPL                 14520000
145300                 MOVE ZEROES           TO APRSFRMO                14530000
145400                                          APRSTOO                 14540000
145500                 MOVE SPACES           TO ASC-PRT-SHP-FROM        14550000
145600                                          ASC-PRT-SHP-TO          14560000
145700                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              14570000
145800         END-IF                                                   14580000
145900     END-IF.                                                      14590000
146000                                                                  14600000
146100                                                                  14610000
146110*                                                                 14611004
146120*  IF ORIGINAL DOWNLOAD IN DOOR SEQUENCE TO/FROM REPRINT INVALID  14612004
146130* MUST REPRINT ALL                                                14613004
146140     IF PS-NO-ERROR                                               14614005
146150     IF  ASC-LBL-PRT-ORDER = PC-D                                 14615004
146160         IF  ASC-PRT-SHP-TO-N    >  ZERO  OR                      14616004
146170             ASC-PRT-SHP-FROM-N  >  ZERO                          14617004
146180                 SET PS-ERROR                                     14618004
146190                     DP020-MSG-FATAL   TO TRUE                    14619004
146191                 MOVE PC-TSYMSG-03265  TO DP020-MSG-NUMBER        14619104
146192                 MOVE DP015-UNP-ALP-BRT-OFF                       14619204
146193                                       TO ALBTYPA                 14619304
146194                 MOVE DP015-RED        TO ALBTYPC                 14619404
146195                 MOVE DP015-REVERSE    TO ALBTYPH                 14619504
146196                 MOVE -1               TO ALBTYPL                 14619604
146197                 MOVE ZEROES           TO APRSFRMO                14619704
146198                                          APRSTOO                 14619804
146199                 MOVE SPACES           TO ASC-PRT-SHP-FROM        14619904
146200                                          ASC-PRT-SHP-TO          14620004
146201                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              14620104
146202         END-IF                                                   14620204
146203     END-IF                                                       14620305
146204     END-IF.                                                      14620405
146205                                                                  14620505
146206                                                                  14620605
146210*                                                                 14621004
146300*  MUST ENTER 'Y' FOR ALL OR FROM/TO                              14630000
146400*                                                                 14640000
146500     IF PS-NO-ERROR                                               14650000
146600        IF DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)                 14660000
146700           IF  ASC-PRT-P2L-FROM = SPACES AND                      14670000
146800               ASC-PRT-P2L-TO   = SPACES AND                      14680000
146900               ASC-PRT-P2L-ALL  = SPACES AND                      14690000
147000               ASC-PRT-SHP-FROM = SPACES AND                      14700000
147100               ASC-PRT-SHP-TO   = SPACES AND                      14710000
147200               ASC-PRT-SHP-ALL  = SPACES                          14720000
147300               SET PS-ERROR                                       14730000
147400                   DP020-MSG-FATAL       TO TRUE                  14740000
147500               MOVE PC-TSYMSG-00007      TO DP020-MSG-NUMBER      14750000
147600               IF ASC-SHIP-CART-CNT > 0                           14760000
147700                  MOVE DP015-UNP-NUM-BRT-OFF TO APRSTOA           14770000
147800                                                APRSFRMA          14780000
147900                  MOVE DP015-UNP-ALP-BRT-OFF TO APRSALLA          14790000
148000                  MOVE DP015-RED             TO APRSTOC           14800000
148100                                                APRSFRMC          14810000
148200                                                APRSALLC          14820000
148300                  MOVE DP015-REVERSE         TO APRSTOH           14830000
148400                                                APRSFRMH          14840000
148500                                                APRSALLH          14850000
148600                  MOVE -1                    TO APRSALLL          14860000
148700               END-IF                                             14870000
148800               IF ASC-P2L-CART-CNT > 0                            14880000
148900                  MOVE DP015-UNP-NUM-BRT-OFF                      14890000
149000                                             TO APRTOA            14900000
149100                                                APRFRMA           14910000
149200                  MOVE DP015-UNP-ALP-BRT-OFF TO APRALLA           14920000
149300                  MOVE DP015-RED             TO APRTOC            14930000
149400                                                APRFRMC           14940000
149500                                                APRALLC           14950000
149600                  MOVE DP015-REVERSE         TO APRTOH            14960000
149700                                                APRFRMH           14970000
149800                                                APRALLH           14980000
149900                  MOVE -1                    TO APRALLL           14990000
150000               END-IF                                             15000000
150100               SET DP030-SET-CURSOR-APPL-1  TO TRUE               15010000
150200           END-IF                                                 15020000
150300        END-IF                                                    15030000
150400     END-IF.                                                      15040000
150500*                                                                 15050000
150600*  'ALL' MUST BE SELECTED IF PRINT ORDER CHANGED FROM WHAT WAS ON 15060000
150700*  TDISTHD                                                        15070000
150800*                                                                 15080000
150900     IF ASC-LBL-PRT-ORDER NOT = ASC-LBL-ORIG-PRT-ORDER            15090000
151000*       OR ASC-LBL-PRT-ORDER = PC-R                               15100000
151100        MOVE DP015-PRO-NOR-OFF    TO APRSFRMA                     15110000
151200                                     APRSTOA                      15120000
151300        MOVE DP015-BLUE           TO APRSFRMC                     15130000
151400                                     APRSTOC                      15140000
151500     END-IF.                                                      15150000
151600                                                                  15160000
151700     IF PS-NO-ERROR                                               15170000
151800****    IF DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)                 15180000
151900          IF ASC-LBL-PRT-ORDER NOT = ASC-LBL-ORIG-PRT-ORDER       15190000
152000         AND ASC-LBL-ORIG-PRT-ORDER NOT = SPACES                  15200000
152100             IF (ASC-PRT-P2L-ALL = PC-Y OR PC-X OR PC-S) OR       15210000
152200                (ASC-PRT-SHP-ALL = PC-Y OR PC-X OR PC-S)          15220000
152300                CONTINUE                                          15230000
152400             ELSE                                                 15240000
152500                SET PS-ERROR                                      15250000
152600                    DP020-MSG-FATAL       TO TRUE                 15260000
152700                MOVE PC-TSYMSG-01796      TO DP020-MSG-NUMBER     15270000
152800                MOVE SPACES  TO ASC-PRT-SHP-FROM                  15280000
152900                                ASC-PRT-SHP-TO                    15290000
153000                MOVE ASC-PRT-SHP-FROM-N   TO APRSFRMO             15300000
153100                MOVE ASC-PRT-SHP-TO-N     TO APRSTOO              15310000
153200                MOVE DP015-UNP-ALP-BRT-OFF                        15320000
153300                                          TO APRSALLA             15330000
153400                MOVE DP015-RED            TO APRSALLC             15340000
153500                MOVE DP015-REVERSE        TO APRSALLH             15350000
153600                MOVE -1                   TO APRSALLL             15360000
153700                SET DP030-SET-CURSOR-APPL-1 TO TRUE               15370000
153800             END-IF                                               15380000
153900          END-IF                                                  15390000
154000*      END-IF                                                     15400000
154100     END-IF.                                                      15410000
154200*                                                                 15420000
154300*  IF 'FROM' ENTERED THEN 'TO' IS NEEDED                          15430000
154400*                                                                 15440000
154500     IF PS-NO-ERROR                                               15450000
154600       IF (ASC-PRT-P2L-FROM = SPACES AND                          15460000
154700         ASC-PRT-P2L-TO   NOT = SPACES)                           15470000
154800         SET PS-ERROR                                             15480000
154900             DP020-MSG-FATAL       TO TRUE                        15490000
155000         MOVE PC-TSYMSG-00053      TO DP020-MSG-NUMBER            15500000
155100         MOVE DP015-UNP-NUM-BRT-OFF                               15510000
155200                                   TO APRFRMA                     15520000
155300         MOVE DP015-RED            TO APRFRMC                     15530000
155400         MOVE DP015-REVERSE        TO APRFRMH                     15540000
155500         MOVE -1                   TO APRFRML                     15550000
155600         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      15560000
155700       END-IF                                                     15570000
155800     END-IF.                                                      15580000
155900*                                                                 15590000
156000     IF PS-NO-ERROR                                               15600000
156100       IF (ASC-PRT-P2L-TO = SPACES AND                            15610000
156200         ASC-PRT-P2L-FROM   NOT = SPACES)                         15620000
156300         SET PS-ERROR                                             15630000
156400             DP020-MSG-FATAL       TO TRUE                        15640000
156500         MOVE PC-TSYMSG-00051      TO DP020-MSG-NUMBER            15650000
156600         MOVE DP015-UNP-NUM-BRT-OFF                               15660000
156700                                   TO APRTOA                      15670000
156800         MOVE DP015-RED            TO APRTOC                      15680000
156900         MOVE DP015-REVERSE        TO APRTOH                      15690000
157000         MOVE -1                   TO APRTOL                      15700000
157100         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      15710000
157200       END-IF                                                     15720000
157300     END-IF.                                                      15730000
157400*                                                                 15740000
157500     IF PS-NO-ERROR                                               15750000
157600       IF (ASC-PRT-SHP-FROM = SPACES AND                          15760000
157700         ASC-PRT-SHP-TO   NOT = SPACES)                           15770000
157800         SET PS-ERROR                                             15780000
157900             DP020-MSG-FATAL       TO TRUE                        15790000
158000         MOVE PC-TSYMSG-00053      TO DP020-MSG-NUMBER            15800000
158100         MOVE DP015-UNP-NUM-BRT-OFF                               15810000
158200                                   TO APRSFRMA                    15820000
158300         MOVE DP015-RED            TO APRSFRMC                    15830000
158400         MOVE DP015-REVERSE        TO APRSFRMH                    15840000
158500         MOVE -1                   TO APRSFRML                    15850000
158600         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      15860000
158700       END-IF                                                     15870000
158800     END-IF.                                                      15880000
158900*                                                                 15890000
159000     IF PS-NO-ERROR                                               15900000
159100       IF (ASC-PRT-SHP-TO = SPACES AND                            15910000
159200         ASC-PRT-SHP-FROM   NOT = SPACES)                         15920000
159300         SET PS-ERROR                                             15930000
159400             DP020-MSG-FATAL       TO TRUE                        15940000
159500         MOVE PC-TSYMSG-00051      TO DP020-MSG-NUMBER            15950000
159600         MOVE DP015-UNP-NUM-BRT-OFF                               15960000
159700                                   TO APRSTOA                     15970000
159800         MOVE DP015-RED            TO APRSTOC                     15980000
159900         MOVE DP015-REVERSE        TO APRSTOH                     15990000
160000         MOVE -1                   TO APRSTOL                     16000000
160100         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      16010000
160200       END-IF                                                     16020000
160300     END-IF.                                                      16030000
160400                                                                  16040000
160500*                                                                 16050000
160600*  IF 'FROM' ENTERED THEN 'TO' IS NEEDED AND IT MUST BE           16060000
160700*  GREATER THAN 'FROM'                                            16070000
160800*                                                                 16080000
160900     IF PS-NO-ERROR                                               16090000
161000       IF ASC-PRT-P2L-FROM-N > 0                                  16100000
161100           IF ASC-PRT-P2L-TO-N < ASC-PRT-P2L-FROM-N               16110000
161200              SET PS-ERROR                                        16120000
161300                  DP020-MSG-FATAL         TO TRUE                 16130000
161400              MOVE PC-TSYMSG-00052        TO DP020-MSG-NUMBER     16140000
161500              MOVE DP015-UNP-NUM-BRT-OFF  TO APRFRMA              16150000
161600              MOVE DP015-RED              TO APRFRMC              16160000
161700              MOVE DP015-REVERSE          TO APRFRMH              16170000
161800              MOVE -1                     TO APRFRML              16180000
161900              SET DP030-SET-CURSOR-APPL-1 TO TRUE                 16190000
162000           END-IF                                                 16200000
162100       END-IF                                                     16210000
162200     END-IF.                                                      16220000
162300*                                                                 16230000
162400                                                                  16240000
162500     IF PS-NO-ERROR                                               16250000
162600       IF ASC-PRT-SHP-FROM-N > 0                                  16260000
162700           IF ASC-PRT-SHP-TO-N < ASC-PRT-SHP-FROM-N               16270000
162800              SET PS-ERROR                                        16280000
162900                  DP020-MSG-FATAL         TO TRUE                 16290000
163000              MOVE PC-TSYMSG-00052        TO DP020-MSG-NUMBER     16300000
163100              MOVE DP015-UNP-NUM-BRT-OFF  TO APRSFRMA             16310000
163200              MOVE DP015-RED              TO APRSFRMC             16320000
163300              MOVE DP015-REVERSE          TO APRSFRMH             16330000
163400              MOVE -1                     TO APRSFRML             16340000
163500              SET DP030-SET-CURSOR-APPL-1 TO TRUE                 16350000
163600           END-IF                                                 16360000
163700       END-IF                                                     16370000
163800     END-IF.                                                      16380000
163900*                                                                 16390000
164000*  DEFAULT THE I/O CODE TO 'O' IF SHIPPING LABELS CHOSEN. MOVE    16400000
164100*  SPACES TO IT IF SHIPPING LABELS NOT CHOSEN BUT P2L ARE USED.   16410000
164200*                                                                 16420000
164300     IF ASC-PRT-SHP-FROM > SPACES                                 16430000
164400        IF ASC-PRT-IO = SPACES                                    16440000
164500           MOVE PC-O               TO ASC-PRT-IO                  16450000
164600                                      APRSIOO                     16460000
164700        END-IF                                                    16470000
164800     ELSE                                                         16480000
164900        IF ASC-PRT-P2L-FROM > SPACES OR                           16490000
165000           ASC-PRT-P2L-ALL > SPACES                               16500000
165100              MOVE SPACES          TO ASC-PRT-IO                  16510000
165200                                      APRSIOO                     16520000
165300        END-IF                                                    16530000
165400     END-IF.                                                      16540000
165500     IF ASC-INPK-CNVYB-IND = PC-N                                 16550000
165600        MOVE PC-O                  TO ASC-PRT-IO                  16560000
165700        MOVE DP015-PRO-NOR-OFF     TO APRSIOA                     16570000
165800     END-IF.                                                      16580000
165900                                                                  16590000
166000     IF ASC-INPK-CNVYB-IND = PC-Y AND ASC-PRT-SHP-ALL = SPACES    16600000
166100            AND ASC-PRT-IO = SPACES                               16610000
166200         IF DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)                16620000
166300             CONTINUE                                             16630000
166400         ELSE                                                     16640000
166500*02/09 - BEGIN                                                    16650000
166600         IF  ASC-PRT-SHP-FROM = SPACES AND                        16660000
166700             ASC-PRT-SHP-TO = SPACES                              16670000
166800             CONTINUE                                             16680000
166900*02/09 - BEGIN                                                    16690000
167000         ELSE                                                     16700000
167100             SET PS-ERROR                                         16710000
167200                 DP020-MSG-FATAL          TO TRUE                 16720000
167300             MOVE PC-TSYMSG-00007         TO DP020-MSG-NUMBER     16730000
167400             MOVE DP015-UNP-ALP-BRT-OFF   TO APRSIOA              16740000
167500             MOVE DP015-RED               TO APRSIOC              16750000
167600             MOVE DP015-REVERSE           TO APRSIOH              16760000
167700             MOVE -1                      TO APRSIOL              16770000
167800             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  16780000
167900         END-IF                                                   16790000
168000         END-IF                                                   16800000
168100     END-IF                                                       16810000
168200                                                                  16820000
168300* CHECK THAT SHIP FROM/TO ISN'T GREATER THAN TOTAL LABELS         16830000
168400                                                                  16840000
168500     EVALUATE TRUE                                                16850000
168600     WHEN ASC-PRT-SHP-ALL = 'S' OR 'Y' OR 'X'                     16860000
168700         CONTINUE                                                 16870000
168800     WHEN ASC-PRT-IO = SPACES                                     16880000
168900         IF ASC-PRT-SHP-FROM-N > ASC-SHIP-CART-CNT                16890000
169000             SET PS-ERROR                                         16900000
169100                 DP020-MSG-FATAL       TO TRUE                    16910000
169200             MOVE PC-TSYMSG-01846      TO DP020-MSG-NUMBER        16920000
169300             MOVE DP015-UNP-NUM-BRT-OFF                           16930000
169400                                       TO APRSFRMA                16940000
169500             MOVE DP015-RED            TO APRSFRMC                16950000
169600             MOVE DP015-REVERSE        TO APRSFRMH                16960000
169700             MOVE -1                   TO APRSFRML                16970000
169800             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  16980000
169900         END-IF                                                   16990000
170000         IF ASC-PRT-SHP-TO-N > ASC-SHIP-CART-CNT                  17000000
170100             SET PS-ERROR                                         17010000
170200                 DP020-MSG-FATAL       TO TRUE                    17020000
170300             MOVE PC-TSYMSG-01846      TO DP020-MSG-NUMBER        17030000
170400             MOVE DP015-UNP-NUM-BRT-OFF                           17040000
170500                                       TO APRSTOA                 17050000
170600             MOVE DP015-RED            TO APRSTOC                 17060000
170700             MOVE DP015-REVERSE        TO APRSTOH                 17070000
170800             MOVE -1                   TO APRSTOL                 17080000
170900             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  17090000
171000       END-IF                                                     17100000
171100     WHEN ASC-PRT-IO = 'I'                                        17110000
171200         IF ASC-PRT-SHP-FROM-N > ASC-INPK-SHIPPED                 17120000
171300             SET PS-ERROR                                         17130000
171400                 DP020-MSG-FATAL       TO TRUE                    17140000
171500             MOVE PC-TSYMSG-01846      TO DP020-MSG-NUMBER        17150000
171600             MOVE DP015-UNP-NUM-BRT-OFF                           17160000
171700                                       TO APRSFRMA                17170000
171800             MOVE DP015-RED            TO APRSFRMC                17180000
171900             MOVE DP015-REVERSE        TO APRSFRMH                17190000
172000             MOVE -1                   TO APRSFRML                17200000
172100             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  17210000
172200         END-IF                                                   17220000
172300         IF ASC-PRT-SHP-TO-N > ASC-INPK-SHIPPED                   17230000
172400             SET PS-ERROR                                         17240000
172500                 DP020-MSG-FATAL       TO TRUE                    17250000
172600             MOVE PC-TSYMSG-01846      TO DP020-MSG-NUMBER        17260000
172700             MOVE DP015-UNP-NUM-BRT-OFF                           17270000
172800                                       TO APRSTOA                 17280000
172900             MOVE DP015-RED            TO APRSTOC                 17290000
173000             MOVE DP015-REVERSE        TO APRSTOH                 17300000
173100             MOVE -1                   TO APRSTOL                 17310000
173200             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  17320000
173300       END-IF                                                     17330000
173400     WHEN ASC-PRT-IO = 'O'                                        17340000
173500         IF ASC-PRT-SHP-FROM-N > ASC-FCSE-SHIPPED                 17350000
173600             SET PS-ERROR                                         17360000
173700                 DP020-MSG-FATAL       TO TRUE                    17370000
173800             MOVE PC-TSYMSG-01846      TO DP020-MSG-NUMBER        17380000
173900             MOVE DP015-UNP-NUM-BRT-OFF                           17390000
174000                                       TO APRSFRMA                17400000
174100             MOVE DP015-RED            TO APRSFRMC                17410000
174200             MOVE DP015-REVERSE        TO APRSFRMH                17420000
174300             MOVE -1                   TO APRSFRML                17430000
174400             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  17440000
174500         END-IF                                                   17450000
174600         IF ASC-PRT-SHP-TO-N > ASC-FCSE-SHIPPED                   17460000
174700             SET PS-ERROR                                         17470000
174800                 DP020-MSG-FATAL       TO TRUE                    17480000
174900             MOVE PC-TSYMSG-01846      TO DP020-MSG-NUMBER        17490000
175000             MOVE DP015-UNP-NUM-BRT-OFF                           17500000
175100                                       TO APRSTOA                 17510000
175200             MOVE DP015-RED            TO APRSTOC                 17520000
175300             MOVE DP015-REVERSE        TO APRSTOH                 17530000
175400             MOVE -1                   TO APRSTOL                 17540000
175500             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  17550000
175600         END-IF                                                   17560000
175700     END-EVALUATE.                                                17570000
175800*                                                                 17580000
175900*  VALIDATE PRINTER ID'S                                          17590000
176000*                                                                 17600000
176100                                                                  17610000
176200     EVALUATE TRUE                                                17620000
176300         WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              17630000
176400       IF PS-NO-ERROR                                             17640000
176500        IF ((ASC-SML-P2L-PRTR-ID = SPACES                         17650000
176600        AND  ASC-PGYBCK-PRTR-ID = SPACES) OR                      17660000
176700            (ASC-SML-P2L-PRTR-ID = SPACES                         17670000
176800        AND  ASC-LBL-PRT-TYPE = PC-S)     OR                      17680000
176900            (ASC-PGYBCK-PRTR-ID = SPACES                          17690000
177000        AND  ASC-LBL-PRT-TYPE = PC-P)     OR                      17700000
177100            (ASC-SML-P2L-PRTR-ID = PC-NO-LBL-PRT-ID               17710000
177200        AND  ASC-PGYBCK-PRTR-ID  = PC-NO-LBL-PRT-ID)   OR         17720000
177300            (ASC-SML-P2L-PRTR-ID = PC-NO-LBL-PRT-ID               17730000
177400        AND  ASC-LBL-PRT-TYPE = PC-S)                  OR         17740000
177500            (ASC-PGYBCK-PRTR-ID = PC-NO-LBL-PRT-ID                17750000
177600        AND  ASC-LBL-PRT-TYPE = PC-P))                            17760000
177700            SET PS-ERROR                                          17770000
177800            DP020-MSG-FATAL       TO TRUE                         17780000
177900            IF (ASC-SML-P2L-PRTR-ID = SPACES  OR                  17790000
178000                ASC-SML-P2L-PRTR-ID = PC-NO-LBL-PRT-ID)  AND      17800000
178100                ASC-LBL-PRT-TYPE    = PC-S                        17810000
178200               MOVE -1                TO AP2PRTL                  17820000
178300               MOVE DP015-UNP-ALP-BRT-OFF                         17830000
178400                                      TO AP2PRTA                  17840000
178500               MOVE DP015-RED         TO AP2PRTC                  17850000
178600               MOVE DP015-REVERSE     TO AP2PRTH                  17860000
178700               MOVE PC-TSYMSG-01798   TO DP020-MSG-NUMBER         17870000
178800            ELSE                                                  17880000
178900               IF (ASC-PGYBCK-PRTR-ID  = SPACES  OR               17890000
179000                   ASC-PGYBCK-PRTR-ID  = PC-NO-LBL-PRT-ID) AND    17900000
179100                   ASC-LBL-PRT-TYPE = PC-P                        17910000
179200                  MOVE -1                TO APBPRTL               17920000
179300                  MOVE DP015-UNP-ALP-BRT-OFF                      17930000
179400                                         TO APBPRTA               17940000
179500                  MOVE DP015-RED         TO APBPRTC               17950000
179600                  MOVE DP015-REVERSE     TO APBPRTH               17960000
179700                  MOVE PC-TSYMSG-01797   TO DP020-MSG-NUMBER      17970000
179800               ELSE                                               17980000
179900                  MOVE DP015-UNP-ALP-BRT-OFF                      17990000
180000                                         TO AP2PRTA               18000000
180100                  MOVE DP015-RED         TO AP2PRTC               18010000
180200                  MOVE DP015-REVERSE     TO AP2PRTH               18020000
180300                  MOVE PC-TSYMSG-00746   TO DP020-MSG-NUMBER      18030000
180400                  MOVE -1                TO AP2PRTL               18040000
180500               END-IF                                             18050000
180600            END-IF                                                18060000
180700            SET DP030-SET-CURSOR-APPL-1 TO TRUE                   18070000
180800        ELSE                                                      18080000
180900            IF ASC-SML-P2L-PRTR-ID NOT = SPACES                   18090000
181000               MOVE ASC-SML-P2L-PRTR-ID TO DP072-PRINTER-ID       18100000
181100               MOVE PC-REPORT-PGM-1     TO DP072-RPT-PGM-NME      18110000
181200               PERFORM 3010-VALIDATE-PRINTER                      18120000
181300               IF PS-NO-ERROR                                     18130000
181400                 PERFORM 3020-VALIDATE-PRINTER-ID-SML             18140000
181500                 IF PS-NO-ERROR                                   18150000
181600                    MOVE DP072-PRTR-CLUSTER-NBR                   18160000
181700                                   TO PC126-SHP-PRTR-CLUSTER-NBR  18170000
181800                                      PC120-SHP-PRTR-CLUSTER-NBR  18180000
181900                    MOVE DP072-PRTR-IP-ADDRESS                    18190000
182000                                   TO PC126-SHP-PRTR-IP-ADDR      18200000
182100                                      PC120-SHP-PRTR-IP-ADDR      18210000
182200                    MOVE DP072-PRTR-CLUSTER-OS-RLSE-CDE           18220000
182300                                   TO PC126-SHP-PRTR-OS-RLSE-CDE  18230000
182400                                      PC120-SHP-PRTR-OS-RLSE-CDE  18240000
182500                    MOVE DP072-PRTR-DATA-XFER-MODE-ID             18250000
182600                                   TO PC126-SHP-DATA-XFER-MODE-ID 18260000
182700                                      PC120-SHP-DATA-XFER-MODE-ID 18270000
182800                    MOVE DP072-XMIT-INTFC-CDE                     18280000
182900                                   TO PC126-SHP-XMIT-INTFC-CDE    18290000
183000                                      PC120-SHP-XMIT-INTFC-CDE    18300000
183100                    MOVE DP072-PRTR-TYP-CDE                       18310000
183200                                   TO PC126-SHP-PRTR-TYP-CDE      18320000
183300                                      PC120-SHP-PRTR-TYP-CDE      18330000
183400              END-IF                                              18340000
183500            END-IF                                                18350000
183600        END-IF                                                    18360000
183700        END-IF                                                    18370000
183800      END-IF                                                      18380000
183900     END-EVALUATE.                                                18390000
184000                                                                  18400000
184100                                                                  18410000
184200*-----------------------------------------------------------------18420000
184300* IF PIGGYBACK LABEL PRINTER ID IS ENTERED - VALIDATE             18430000
184400*-----------------------------------------------------------------18440000
184500     IF  PS-NO-ERROR                                              18450000
184600         IF  ASC-PGYBCK-PRTR-ID  =  PC-NO-LBL-PRT-ID              18460000
184700             NEXT SENTENCE                                        18470000
184800         ELSE                                                     18480000
184900         IF  ASC-PGYBCK-PRTR-ID > SPACES                          18490000
185000             IF  ASC-PRE-PACK-ORDER                               18500000
185100                 SET  PS-ERROR                                    18510000
185200                      DP020-MSG-FATAL  TO TRUE                    18520000
185300                 MOVE PC-TSYMSG-02424  TO DP020-MSG-NUMBER        18530000
185400                 MOVE DP015-UNP-ALP-BRT-OFF                       18540000
185500                                       TO APBPRTA                 18550000
185600                 MOVE DP015-RED        TO APBPRTC                 18560000
185700                                          APBPRTC                 18570000
185800                 MOVE DP015-REVERSE    TO APBPRTH                 18580000
185900                 MOVE -1               TO APBPRTL                 18590000
186000                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              18600000
186100             ELSE                                                 18610000
186200                 MOVE ASC-PGYBCK-PRTR-ID TO DP072-PRINTER-ID      18620000
186300                 MOVE PC-REPORT-PGM-2    TO DP072-RPT-PGM-NME     18630000
186400                 PERFORM 3010-VALIDATE-PRINTER                    18640000
186500                 IF  PS-NO-ERROR                                  18650000
186600                     PERFORM 3030-VALIDATE-PRINTER-ID-PGBK        18660000
186700                     IF PS-NO-ERROR                               18670000
186800                        MOVE DP072-PRTR-CLUSTER-NBR               18680000
186900                           TO PC126-PGYBK-PRTR-CLUSTER-NBR        18690000
187000                              PC120-PGYBCK-PRTR-CLUSTER-NBR       18700000
187100                        MOVE DP072-PRTR-IP-ADDRESS                18710000
187200                           TO PC126-PGYBK-PRTR-IP-ADDR            18720000
187300                              PC120-PGYBCK-PRTR-IP-ADDR           18730000
187400                        MOVE DP072-PRTR-CLUSTER-OS-RLSE-CDE       18740000
187500                           TO PC126-PGYBK-PRTR-OS-RLSE-CDE        18750000
187600                              PC120-PGYBCK-PRTR-OS-RLSE-CDE       18760000
187700                        MOVE DP072-PRTR-DATA-XFER-MODE-ID         18770000
187800                           TO PC126-PGYBK-DATA-XFER-MODE-ID       18780000
187900                              PC120-PGYBCK-DATA-XFER-MODE-ID      18790000
188000                        MOVE DP072-XMIT-INTFC-CDE                 18800000
188100                                   TO PC126-PGYBK-XMIT-INTFC-CDE  18810000
188200                                      PC120-PGYBCK-XMIT-INTFC-CDE 18820000
188300                        MOVE DP072-PRTR-TYP-CDE                   18830000
188400                                   TO PC126-PGYBK-PRTR-TYP-CDE    18840000
188500                                      PC120-PGYBCK-PRTR-TYP-CDE   18850000
188600                     END-IF                                       18860000
188700                 END-IF                                           18870000
188800             END-IF                                               18880000
188900         END-IF                                                   18890000
189000         END-IF                                                   18900000
189100     END-IF.                                                      18910000
189200                                                                  18920000
189300*                                                                 18930000
189400*  CHECK IF LABELS PROCESSED USING UCC128 DATA                    18940000
189500* ASC-UCC128-DATA-YES                                             18950000
189600                                                                  18960000
189700     IF DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)                    18970000
189800        IF ASC-UCC128-DATA-YES                                    18980000
189900              SET PS-ERROR                                        18990000
190000              DP020-MSG-FATAL       TO TRUE                       19000000
190100              MOVE PC-TSYMSG-02508      TO DP020-MSG-NUMBER       19010000
190200              MOVE DP015-UNP-ALP-BRT-OFF                          19020000
190300                                        TO ALBTYPA                19030000
190400              MOVE DP015-RED            TO ALBTYPC                19040000
190500              MOVE DP015-REVERSE        TO ALBTYPH                19050000
190600              MOVE -1                   TO ALBTYPL                19060000
190700              SET DP030-SET-CURSOR-APPL-1 TO TRUE                 19070000
190800        END-IF                                                    19080000
190900     END-IF.                                                      19090000
190901                                                                  19090112
190910* GB 8/11/05 BEG                                                  19091012
190920        IF DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)                 19092012
190930           IF  ASC-ERR-ON-LABEL-DWNLD                             19093012
190940               SET PS-ERROR                                       19094012
190950                   DP020-MSG-FATAL       TO TRUE                  19095012
190960               MOVE PC-TSYMSG-03415      TO DP020-MSG-NUMBER      19096012
190970               SET DP030-SET-CURSOR-APPL-1  TO TRUE               19097012
190980           END-IF                                                 19098012
190990        END-IF.                                                   19099013
190991* GB 8/11/05 BEG                                                  19099112
190992                                                                  19099212
191000                                                                  19100000
191200                                                                  19120000
191300*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*19130000
191400*   3010-VALIDATE-PRINTER                                        *19140000
191500* CALLS DPKCS060 TO VALIDATE THE PRINTER ID                      *19150000
191600*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*19160000
191700 3010-VALIDATE-PRINTER.                                           19170000
191800                                                                  19180000
191900     MOVE PC-01                      TO DP072-RPT-PGM-TYP-ID.     19190000
192000     MOVE DP020-LOCATION-NBR         TO DP072-ORIGIN-OPER-UNT-ID. 19200008
192100     MOVE DP020-LOCATION-NBR         TO DP072-OPER-UNT-ID.        19210008
192200     MOVE 1                          TO DP072-ORIGIN-FCLTY-ID     19220000
192300                                        DP072-FCLTY-ID.           19230000
192400     SET DP072-VALIDATE              TO TRUE.                     19240000
192500                                                                  19250000
192600     EXEC CICS                                                    19260000
192700          LINK PROGRAM  (PC-PRTR-VALIDATION-PGM)                  19270000
192800               COMMAREA (DP072-COMM-AREA)                         19280000
192900               RESP     (PV-CICS-RESP)                            19290000
193000     END-EXEC                                                     19300000
193100                                                                  19310000
193200     EVALUATE TRUE                                                19320000
193300         WHEN PV-CICS-RESP = DFHRESP (NORMAL)                     19330000
193400              CONTINUE                                            19340000
193500         WHEN OTHER                                               19350000
193600             SET PS-ERROR                                         19360000
193700                 DP020-MSG-FATAL       TO TRUE                    19370000
193800             MOVE PC-TSYMSG-00746      TO DP020-MSG-NUMBER        19380000
193900             IF  DP072-RPT-PGM-NME = PC-REPORT-PGM-1              19390000
194000                 MOVE DP015-UNP-ALP-BRT-OFF                       19400000
194100                                       TO APBPRTA                 19410000
194200                 MOVE DP015-RED        TO APBPRTC                 19420000
194300                 MOVE DP015-REVERSE    TO APBPRTH                 19430000
194400                 MOVE -1               TO APBPRTL                 19440000
194500             ELSE                                                 19450000
194600                 MOVE DP015-UNP-ALP-BRT-OFF                       19460000
194700                                       TO APBPRTA                 19470000
194800                 MOVE DP015-RED        TO APBPRTC                 19480000
194900                 MOVE DP015-REVERSE    TO APBPRTH                 19490000
195000                 MOVE -1               TO APBPRTL                 19500000
195100             END-IF                                               19510000
195200             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  19520000
195300     END-EVALUATE.                                                19530000
195400                                                                  19540000
195500                                                                  19550000
195600*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*19560000
195700*  VALIDATE THE PRINTER NUMBER ENTERED ON THE SCREEN TO ENSURE   *19570000
195800*  THIS IS A VALID PRINTER AND THAT SHIPPING MANIFEST LABELS     *19580000
195900*  CAN BE PRINTED ON THIS PRINTER.                               *19590000
196000*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*19600000
196100 3020-VALIDATE-PRINTER-ID-SML.                                    19610000
196200                                                                  19620000
196300     IF  DP072-PRTR-CLUSTER-OS-RLSE-CDE  = PC-MGMX                19630000
196400         SET  PS-PRINTER-ERROR                                    19640000
196500              PS-ERROR                                            19650000
196600              DP020-MSG-FATAL         TO TRUE                     19660000
196700         MOVE PC-TSYMSG-00746         TO DP020-MSG-NUMBER         19670000
196800         MOVE DP015-UNP-ALP-BRT-MDT   TO AP2PRTA                  19680000
196900         MOVE DP015-RED               TO AP2PRTC                  19690000
197000         MOVE DP015-REVERSE           TO AP2PRTH                  19700000
197100         MOVE -1                      TO AP2PRTL                  19710000
197200         SET DP030-SET-CURSOR-APPL-1  TO TRUE                     19720000
197300     END-IF.                                                      19730000
197400                                                                  19740000
197500     IF  DP072-PRTR-PRTR-TRK-STAT-CDE    = PC-A                   19750000
197600         CONTINUE                                                 19760000
197700     ELSE                                                         19770000
197800         SET  PS-PRINTER-ERROR                                    19780000
197900              PS-ERROR                                            19790000
198000              DP020-MSG-FATAL         TO TRUE                     19800000
198100         MOVE PC-TSYMSG-00746         TO DP020-MSG-NUMBER         19810000
198200         MOVE DP015-UNP-ALP-BRT-MDT   TO AP2PRTA                  19820000
198300         MOVE DP015-RED               TO AP2PRTC                  19830000
198400         MOVE DP015-REVERSE           TO AP2PRTH                  19840000
198500         MOVE -1                      TO AP2PRTL                  19850000
198600         SET DP030-SET-CURSOR-APPL-1  TO TRUE                     19860000
198700     END-IF.                                                      19870000
198800                                                                  19880000
198900                                                                  19890000
199000*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*19900000
199100*  VALIDATE THE PRINTER NUMBER ENTERED ON THE SCREEN TO ENSURE   *19910000
199200*  THIS IS A VALID PRINTER AND THAT PIGGYBACK LABELS CAN BE      *19920000
199300*  PRINTED ON THIS PRINTER.                                      *19930000
199400*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*19940000
199500 3030-VALIDATE-PRINTER-ID-PGBK.                                   19950000
199600                                                                  19960000
199700     IF  DP072-PRTR-PRTR-TRK-STAT-CDE    = PC-A                   19970000
199800         CONTINUE                                                 19980000
199900     ELSE                                                         19990000
200000         SET  PS-PRINTER-ERROR                                    20000000
200100              PS-ERROR                                            20010000
200200              DP020-MSG-FATAL         TO TRUE                     20020000
200300         MOVE PC-TSYMSG-00746         TO DP020-MSG-NUMBER         20030000
200400         MOVE DP015-UNP-ALP-BRT-MDT   TO APBPRTA                  20040000
200500         MOVE DP015-RED               TO APBPRTC                  20050000
200600         MOVE DP015-REVERSE           TO APBPRTH                  20060000
200700         MOVE -1                      TO APBPRTL                  20070000
200800         SET DP030-SET-CURSOR-APPL-1  TO TRUE                     20080000
200900     END-IF.                                                      20090000
201000                                                                  20100000
201100 3040-VALIDATE-MODULE-OVERRIDE.                                   20110000
201200                                                                  20120000
201300     IF  ASC-MODU-NBR-OVERRIDE > SPACES                           20130000
201400         MOVE ASC-MODU-NBR-OVERRIDE       TO DP010I-UNEDITED-FIELD20140000
201500         MOVE 3                           TO DP010I-MAXIMUM-DIGITS20150000
201600         MOVE ZERO                      TO DP010I-MAXIMUM-DECIMALS20160000
201700         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  20170000
201810         CALL DP010I-NUMERIC-EDIT-ROUTINE                         20181020
201820                         USING DP010I-NUMERIC-EDIT-AREA           20182020
201900         IF  DP010I-ERROR-DETECTED                                20190000
202000             SET PS-ERROR                                         20200000
202100                 DP020-MSG-FATAL       TO TRUE                    20210000
202200             MOVE PC-TSYMSG-00008      TO DP020-MSG-NUMBER        20220000
202300             MOVE DP015-UNP-NUM-BRT-OFF                           20230000
202400                                       TO AMODLA                  20240000
202500             MOVE DP015-RED            TO AMODLC                  20250000
202600             MOVE DP015-REVERSE        TO AMODLH                  20260000
202700             MOVE -1                   TO AMODLL                  20270000
202800             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  20280000
202900         ELSE                                                     20290000
203000             MOVE DP010I-NUMERIC-FIELD                            20300000
203100                                   TO ASC-MODU-NBR-OVERRIDE-N     20310000
203200                                      AMODLO                      20320000
203300             PERFORM 3041-VERIFY-MODULE-NBR                       20330000
203400         END-IF                                                   20340000
203500         IF PS-NO-ERROR                                           20350000
203600             PERFORM 3042-COMPARE-MODULES                         20360000
203700         END-IF                                                   20370000
203800     END-IF.                                                      20380000
203900                                                                  20390000
204000 3041-VERIFY-MODULE-NBR.                                          20400000
204100                                                                  20410000
204200     MOVE ASC-OPER-UNT-ID       TO DK-OPER-UNT-ID                 20420000
204300     MOVE ASC-FCLTY-ID          TO DK-FCLTY-ID                    20430000
204400     MOVE ASC-MODU-NBR-OVERRIDE-N TO DK-MODU-NBR                  20440000
204500                                                                  20450000
204600     EXEC SQL                                                     20460000
204700         SELECT SRVR_IP_ADDR                                      20470000
204800            ,   DIVERT_CDE                                        20480000
204900           INTO :PV-OVERRIDE-IP-ADDR                              20490000
205000            ,   :PV-OVERRIDE-DIVERT-CDE                           20500000
205100           FROM TP2LMOD                                           20510000
205200          WHERE OPER_UNT_ID    = :DK-OPER-UNT-ID                  20520000
205300            AND FCLTY_ID       = :DK-FCLTY-ID                     20530000
205400            AND MODU_NBR       = :DK-MODU-NBR                     20540000
205500     END-EXEC                                                     20550000
205600                                                                  20560000
205700     EVALUATE TRUE                                                20570000
205800         WHEN SQLCODE = ZERO                                      20580000
205900             CONTINUE                                             20590000
206000         WHEN SQLCODE = +100                                      20600000
206100             SET PS-ERROR                                         20610000
206200                 DP020-MSG-FATAL       TO TRUE                    20620000
206300             MOVE PC-TSYMSG-01731      TO DP020-MSG-NUMBER        20630000
206400             MOVE DP015-UNP-NUM-BRT-OFF                           20640000
206500                                       TO AMODLA                  20650000
206600             MOVE DP015-RED            TO AMODLC                  20660000
206700             MOVE DP015-REVERSE        TO AMODLH                  20670000
206800             MOVE -1                   TO AMODLL                  20680000
206900             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  20690000
207000         WHEN OTHER                                               20700000
207100              MOVE '3041-VERIFY-MODULE-NBR'                       20710000
207200                               TO DP013-PARAGRAPH                 20720000
207300              MOVE 'VERIFY MODULE NBR VALID '                     20730000
207400                               TO DP013-MESSAGE-TEXT (1)          20740000
207500              MOVE SQLCA       TO DP013-SQLCA                     20750000
207600              MOVE 'TP2LMOD '  TO DP013-DB2-TABLE-NAME (1)        20760000
207700              SET DP013-DB2-ABEND                                 20770000
207800                  DP013-XCTL-DISPLAY-RESTART                      20780000
207900                                   TO TRUE                        20790000
208000                  PERFORM DP013-0000-PROCESS-ABEND                20800000
208100     END-EVALUATE.                                                20810000
208200                                                                  20820000
208300 3042-COMPARE-MODULES.                                            20830000
208400                                                                  20840000
208500     MOVE ASC-OPER-UNT-ID       TO DK-OPER-UNT-ID                 20850000
208600     MOVE ASC-FCLTY-ID          TO DK-FCLTY-ID                    20860000
208700     MOVE ASC-MODU-NBR-N        TO DK-MODU-NBR                    20870000
208800                                                                  20880000
208900     EXEC SQL                                                     20890000
209000         SELECT                                                   20900000
209100                SRVR_IP_ADDR                                      20910000
209200            ,   DIVERT_CDE                                        20920000
209300           INTO :P2LMOD-SRVR-IP-ADDR                              20930000
209400            ,   :P2LMOD-DIVERT-CDE                                20940000
209500           FROM TP2LMOD                                           20950000
209600          WHERE OPER_UNT_ID    = :DK-OPER-UNT-ID                  20960000
209700            AND FCLTY_ID       = :DK-FCLTY-ID                     20970000
209800            AND MODU_NBR       = :DK-MODU-NBR                     20980000
209900     END-EXEC                                                     20990000
210000                                                                  21000000
210100     EVALUATE TRUE                                                21010000
210200         WHEN SQLCODE = ZERO                                      21020000
210300             CONTINUE                                             21030000
210400         WHEN SQLCODE = +100                                      21040000
210500             SET PS-ERROR                                         21050000
210600                 DP020-MSG-FATAL       TO TRUE                    21060000
210700             MOVE PC-TSYMSG-01731      TO DP020-MSG-NUMBER        21070000
210800             MOVE DP015-UNP-NUM-BRT-OFF                           21080000
210900                                       TO AMODLA                  21090000
211000             MOVE DP015-RED            TO AMODLC                  21100000
211100             MOVE DP015-REVERSE        TO AMODLH                  21110000
211200             MOVE -1                   TO AMODLL                  21120000
211300             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  21130000
211400         WHEN OTHER                                               21140000
211500              MOVE '3041-VERIFY-MODULE-NBR'                       21150000
211600                               TO DP013-PARAGRAPH                 21160000
211700              MOVE 'VERIFY MODULE NBR VALID '                     21170000
211800                               TO DP013-MESSAGE-TEXT (1)          21180000
211900              MOVE SQLCA       TO DP013-SQLCA                     21190000
212000              MOVE 'TP2LMOD '  TO DP013-DB2-TABLE-NAME (1)        21200000
212100              SET DP013-DB2-ABEND                                 21210000
212200                  DP013-XCTL-DISPLAY-RESTART                      21220000
212300                                   TO TRUE                        21230000
212400                  PERFORM DP013-0000-PROCESS-ABEND                21240000
212500     END-EVALUATE.                                                21250000
212600                                                                  21260000
212700     IF PV-OVERRIDE-IP-ADDR = P2LMOD-SRVR-IP-ADDR                 21270000
212800         CONTINUE                                                 21280000
212900     ELSE                                                         21290000
213000         SET PS-ERROR                                             21300000
213100             DP020-MSG-FATAL           TO TRUE                    21310000
213200         MOVE PC-TSYMSG-01845          TO DP020-MSG-NUMBER        21320000
213300         MOVE DP015-UNP-NUM-BRT-OFF                               21330000
213400                                   TO AMODLA                      21340000
213500         MOVE DP015-RED                TO AMODLC                  21350000
213600         MOVE DP015-REVERSE            TO AMODLH                  21360000
213700         MOVE -1                       TO AMODLL                  21370000
213800         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      21380000
213900     END-IF.                                                      21390000
214000                                                                  21400000
214100*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*21410000
214200*  RESET THE ATTRIBUTES OF ALL ENTERABLE FIELDS ON THE MAP.      *21420000
214300*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*21430000
214400 3200-RESET-ATTRIBUTES.                                           21440000
214500     MOVE DP015-UNP-ALP-NOR-OFF    TO ALBTYPA                     21450000
214600                                      AP2PRTA                     21460000
214700                                      APBPRTA                     21470000
214800                                      APRALLA                     21480000
214900                                      APRSALLA                    21490000
215000                                      APRSIOA                     21500000
215100                                      ALBORDA                     21510000
215200                                      AMODLA                      21520000
215300                                      ALBSIA.                     21530000
215400     MOVE DP015-UNP-NUM-NOR-OFF    TO APRFRMA                     21540000
215500                                      APRTOA                      21550000
215600                                      APRSFRMA                    21560000
215700                                      APRSTOA.                    21570000
215800     MOVE DP015-GREEN              TO ALBTYPC                     21580000
215900                                      AP2PRTC                     21590000
216000                                      APBPRTC                     21600000
216100                                      APRALLC                     21610000
216200                                      APRFRMC                     21620000
216300                                      APRTOC                      21630000
216400                                      APRSALLC                    21640000
216500                                      APRSFRMC                    21650000
216600                                      APRSTOC                     21660000
216700                                      APRSIOC                     21670000
216800                                      ALBORDC                     21680000
216900                                      AMODLC                      21690000
217000                                      ALBSIC.                     21700000
217100     MOVE DP015-UNDERLINE          TO ALBTYPH                     21710000
217200                                      AP2PRTH                     21720000
217300                                      APBPRTH                     21730000
217400                                      APRALLH                     21740000
217500                                      APRFRMH                     21750000
217600                                      APRTOH                      21760000
217700                                      APRSALLH                    21770000
217800                                      APRSFRMH                    21780000
217900                                      APRSTOH                     21790000
218000                                      APRSIOH                     21800000
218100                                      ALBORDH                     21810000
218200                                      AMODLH                      21820000
218300                                      ALBSIH.                     21830000
218400                                                                  21840000
218500     MOVE DP015-PRO-NOR-OFF        TO ALBDSCA                     21850000
218600                                      ALBLCRA.                    21860000
218700     MOVE DP015-BLUE               TO ALBDSCC                     21870000
218800                                      ALBLCRC.                    21880000
218900                                                                  21890000
219000                                                                  21900000
219100     IF ASC-SHIP-CART-CNT = 0                                     21910000
219200          MOVE DP015-PRO-NOR-OFF    TO APRSALLA                   21920000
219300                                       APRSTOA                    21930000
219400                                       APRSFRMA                   21940000
219500                                       APBPRTA                    21950000
219600                                       ALBTYPA                    21960000
219700                                       ALBORDA                    21970000
219800                                       APRSIOA                    21980000
219900          MOVE DP015-BLUE           TO APRSIOC                    21990000
220000                                       APRSTOC                    22000000
220100                                       APRSFRMC                   22010000
220200                                       APRSALLC                   22020000
220300                                       APBPRTC                    22030000
220400                                       ALBTYPC                    22040000
220500                                       ALBORDC                    22050000
220600     END-IF.                                                      22060000
220700                                                                  22070000
220800     IF ASC-P2L-CART-CNT = 0                                      22080000
220900          MOVE DP015-PRO-NOR-OFF    TO APRALLA                    22090000
221000                                       APRTOA                     22100000
221100                                       APRFRMA                    22110000
221200                                       AMODLA                     22120000
221300          MOVE DP015-BLUE           TO APRALLC                    22130000
221400                                       APRTOC                     22140000
221500                                       APRFRMC                    22150000
221600                                       AMODLC                     22160000
221700     END-IF.                                                      22170000
221800                                                                  22180000
221900     IF ASC-INPK-CNVYB-IND = PC-N                                 22190000
222000          MOVE PC-O                  TO ASC-PRT-IO                22200000
222100          MOVE DP015-PRO-NOR-OFF     TO APRSIOA                   22210000
222200          MOVE DP015-BLUE            TO APRSIOC                   22220000
222300     END-IF.                                                      22230000
222400                                                                  22240000
222500     IF  ALBTYPO  =  PC-P                                         22250000
222600         MOVE DP015-PRO-NOR-OFF      TO APRSFRMA                  22260000
222700                                        APRSTOA                   22270000
222800                                        ALBORDA                   22280000
222900         MOVE DP015-BLUE             TO APRSFRMC                  22290000
223000                                        APRSTOC                   22300000
223100                                        ALBORDC                   22310000
223200     END-IF.                                                      22320000
223300                                                                  22330000
223400*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*22340000
223500*    INITIALIZE BOTH BLOCKS IN THE ARRAY.                        *22350000
223600*    INITIALIZE ALL COUNTERS AND FLAGS.                          *22360000
223700*    READ THE DATA BASE FOR THE 1ST TIME AND FILL UP THE ARRAY.  *22370000
223800*    DISPLAY THE PANEL TO USER.                                  *22380000
223900*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*22390000
224000 4000-BUILD-INITIAL-PANEL.                                        22400000
224100                                                                  22410000
224200     INITIALIZE ASC-SCREEN-DATA.                                  22420000
224300                                                                  22430000
224400     MOVE +0                  TO ASC-ITEM-SUB                     22440000
224500                                 ASC-NUMBER-OF-SELECTED-ITEMS.    22450000
224600                                                                  22460000
224700     PERFORM 4050-GET-TDISTHD.                                    22470000
224800                                                                  22480000
224900     MOVE DISTHD-CRE-USR-ID           TO ASC-USERID               22490000
225000     MOVE DISTHD-FCSE-LBL-TYP-CDE     TO ASC-DISTHD-ORIG-LBL-TYP  22500000
225100                                                                  22510000
225200     MOVE DISTHD-CRE-TMST             TO PV-REFORMAT-TMST.        22520000
225300     MOVE PV-REFORMAT-TMST-DTE-CY     TO PV-FORMAT-TMST-DTE-CY.   22530000
225400     MOVE PV-REFORMAT-TMST-DTE-MM     TO PV-FORMAT-TMST-DTE-MM.   22540000
225500     MOVE PV-REFORMAT-TMST-DTE-DD     TO PV-FORMAT-TMST-DTE-DD.   22550000
225600     MOVE PV-REFORMAT-TMST-TM-HH      TO PV-FORMAT-TMST-TM-HH.    22560000
225700     MOVE PV-REFORMAT-TMST-TM-MM      TO PV-FORMAT-TMST-TM-MM.    22570000
225800     MOVE PV-REFORMAT-TMST-TM-SS      TO PV-FORMAT-TMST-TM-SS.    22580000
225900     MOVE PV-FORMAT-TMST-DTE          TO ASC-TMST-DTE.            22590000
226000     MOVE PV-FORMAT-TMST-TM           TO ASC-TMST-TM.             22600000
226100                                                                  22610000
226200     IF (SQLCODE NOT = +0 OR                                      22620000
226300        (SQLCODE = +0 AND DISTHD-TOT-CART-CNT = 0))               22630000
226400         SET PS-ERROR                  TO TRUE                    22640000
226500         SET DP020-MSG-FATAL           TO TRUE                    22650000
226600         MOVE PC-TSYMSG-00050          TO DP020-MSG-NUMBER        22660000
226700         SET DP030-SET-CURSOR-APPL-1   TO TRUE                    22670000
226800         SET DP020-NEXT-ACT-APPL-ERROR TO TRUE                    22680000
226900     END-IF.                                                      22690000
226901                                                                  22690115
226902     IF PS-NO-ERROR                                               22690215
226910        PERFORM 4090-CHECK-ERROR-ON-DOWNLOAD                      22691015
227000     END-IF                                                       22700015
227010                                                                  22701015
227100**GB 3/21/02 BEG                                                  22710000
227200**CHANGE TO ALLOW ASSOCIATE TO VIEW SCREEN                        22720000
227300     IF DISTHD-UCC128-DAT-USG-CDE = 'U'                           22730000
227400         SET ASC-UCC128-DATA-YES       TO TRUE                    22740000
227500     ELSE                                                         22750000
227600         SET ASC-UCC128-DATA-NO        TO TRUE                    22760000
227700     END-IF.                                                      22770000
227710**GB 2/11/05                                                      22771009
227800     MOVE DISTHD-UCC128-DAT-USG-CDE    TO ASC-USE-UCC128-DATA-SW  22780009
227810                                                                  22781009
227900*    IF DISTHD-UCC128-DAT-USG-CDE = 'U'                           22790000
228000*        SET PS-ERROR                  TO TRUE                    22800000
228100*        SET DP020-MSG-FATAL           TO TRUE                    22810000
228200*        MOVE PC-TSYMSG-02508          TO DP020-MSG-NUMBER        22820000
228300*        SET DP030-SET-CURSOR-APPL-1   TO TRUE                    22830000
228400*        SET DP020-NEXT-ACT-APPL-ERROR TO TRUE                    22840000
228500*    END-IF.                                                      22850000
228600*                                                                 22860000
228700**GB 3/21/02 END                                                  22870000
228800                                                                  22880000
228900     IF PS-NO-ERROR                                               22890000
229000       EVALUATE DISTHD-FCSE-LBL-TYP-CDE                           22900000
229100         WHEN PC-P                                                22910000
229200           MOVE PC-P TO ASC-LBL-PRT-TYPE                          22920000
229300           MOVE PC-R TO ASC-LBL-PRT-ORDER                         22930000
229400                        ASC-LBL-ORIG-PRT-ORDER                    22940000
229500           MOVE DP015-PRO-NOR-OFF    TO APRSFRMA                  22950000
229600                                        APRSTOA                   22960000
229700                                        ALBORDA                   22970000
229800           MOVE DP015-BLUE           TO APRSFRMC                  22980000
229900                                        APRSTOC                   22990000
230000                                        ALBORDC                   23000000
230100         WHEN PC-R                                                23010000
230200           MOVE PC-S TO ASC-LBL-PRT-TYPE                          23020000
230300           MOVE PC-R TO ASC-LBL-PRT-ORDER                         23030000
230400                        ASC-LBL-ORIG-PRT-ORDER                    23040000
230500         WHEN PC-S                                                23050000
230600           MOVE PC-S TO ASC-LBL-PRT-TYPE                          23060000
230700                        ASC-LBL-PRT-ORDER                         23070000
230800                        ASC-LBL-ORIG-PRT-ORDER                    23080000
230900         WHEN PC-X                                                23090000
231000           MOVE PC-X                    TO ASC-LBL-PRT-TYPE       23100000
231100           MOVE ASC-CRIT-SPEC-PRT-ORDER TO ASC-LBL-PRT-ORDER      23110000
231200                                           ASC-LBL-ORIG-PRT-ORDER 23120000
231210         WHEN PC-D                                                23121006
231220           MOVE PC-S                    TO ASC-LBL-PRT-TYPE       23122006
231230           MOVE PC-D                    TO ASC-LBL-PRT-ORDER      23123007
231240                                           ASC-LBL-ORIG-PRT-ORDER 23124006
231300         WHEN OTHER                                               23130000
231400             IF ASC-LBL-PRT-TYPE = SPACES                         23140000
231500                IF ASC-SML-P2L-PRTR-ID > SPACES                   23150000
231600                   MOVE PC-S TO ASC-LBL-PRT-TYPE                  23160000
231700                ELSE                                              23170000
231800                   MOVE PC-P TO ASC-LBL-PRT-TYPE                  23180000
231900               END-IF                                             23190000
232000             END-IF                                               23200000
232100       END-EVALUATE                                               23210000
232200     END-IF.                                                      23220000
232300                                                                  23230000
232400*                                                                 23240000
232500*  'ALL' MUST BE SELECTED IF PRINT ORDER CHANGED FROM WHAT WAS ON 23250000
232600*  TDISTHD                                                        23260000
232700*                                                                 23270000
232800     IF ASC-LBL-PRT-ORDER NOT = ASC-LBL-ORIG-PRT-ORDER            23280000
232900*        OR ASC-LBL-PRT-ORDER = PC-R                              23290000
233000        MOVE DP015-PRO-NOR-OFF    TO APRSFRMA                     23300000
233100                                     APRSTOA                      23310000
233200        MOVE DP015-BLUE           TO APRSFRMC                     23320000
233300                                     APRSTOC                      23330000
233400     END-IF.                                                      23340000
233500                                                                  23350000
233600     IF PS-NO-ERROR                                               23360000
233700        IF ASC-INPK-UNT-QTY = 0                                   23370000
233800           MOVE DISTHD-INPK-UNT-QTY TO ASC-INPK-UNT-QTY           23380000
233900        END-IF                                                    23390000
234000        IF ASC-MODU-NBR = SPACES OR LOW-VALUES OR '000'           23400000
234100           MOVE DISTHD-PRC-AREA-MODU-ID TO ASC-MODU-NBR           23410000
234200        END-IF                                                    23420000
234300        IF ASC-OTPK-UNT-QTY = 0                                   23430000
234400           MOVE DISTHD-OTPK-UNT-QTY TO ASC-OTPK-UNT-QTY           23440000
234500        END-IF                                                    23450000
234600        IF ASC-INPK-CNVYB-IND = SPACES OR LOW-VALUES              23460000
234700           MOVE DISTHD-INPK-CNVYB-IND TO ASC-INPK-CNVYB-IND       23470000
234800        END-IF                                                    23480000
234900        IF ASC-MODU-NBR = SPACES OR LOW-VALUES                    23490000
235000           MOVE   DISTHD-PRC-AREA-MODU-ID TO ASC-MODU-NBR         23500000
235100        END-IF                                                    23510000
235200                                                                  23520000
235300        MOVE DISTHD-P2L-CART-CNT TO ASC-P2L-CART-CNT              23530000
235400                                                                  23540000
235500        MOVE DISTHD-SPC-INSTR-DESC TO ASC-SPEC-INST-DESC          23550000
235600                                                                  23560000
235700        ADD DISTHD-FCSE-CART-CNT, DISTHD-INPK-CART-CNT            23570000
235800             GIVING ASC-SHIP-CART-CNT                             23580000
235900                                                                  23590000
236000        MOVE DISTHD-TOT-CART-CNT  TO ASC-PROC-CART-CNT            23600000
236100                                                                  23610000
236200        MULTIPLY DISTHD-TOT-CART-CNT BY DISTHD-OTPK-UNT-QTY       23620000
236300             GIVING ASC-PROC-QTY                                  23630000
236400                                                                  23640000
236500        IF  ASC-PRE-PACK-ORDER                                    23650000
236600            DIVIDE  ASC-PROC-QTY                                  23660000
236700                BY  ASC-PREPK-RATIO                               23670000
236800            GIVING  ASC-PROC-PAK                                  23680000
236900        END-IF                                                    23690000
237000                                                                  23700000
237100        PERFORM 4040-GET-TRECITM                                  23710000
237200                                                                  23720000
237300        EVALUATE TRUE                                             23730000
237400          WHEN   RECITM-STATUS-CDE = 'VE'                         23740000
237500               MOVE 'VERFYD  '              TO ASC-STATUS         23750000
237600          WHEN   DISTHD-PRCG-STAT-CDE = 'P' OR 'V'                23760000
237700               MOVE 'PRVRFYD  '             TO ASC-STATUS         23770000
237800          WHEN   DISTHD-PRCG-STAT-CDE = 'D'                       23780000
237900              IF DISTHD-P2L-CART-CNT = 0                          23790000
238000                  MOVE 'FCS RDY '          TO ASC-STATUS          23800000
238100              ELSE                                                23810000
238200                  MOVE 'DOWNLD   '         TO ASC-STATUS          23820000
238300              END-IF                                              23830000
238400          WHEN DISTHD-PRCG-STAT-CDE = 'B'                         23840000
238500              IF DISTHD-FCSE-CNFRMN-TMST = PC-DEFAULT-TIMESTAMP   23850000
238600                  MOVE 'CNFM ND  '         TO ASC-STATUS          23860000
238700              ELSE                                                23870000
238800                  IF DISTHD-RSLTS-RCVD-TMST = PC-DEFAULT-TIMESTAMP23880000
238900                     MOVE 'P2L ND   '     TO ASC-STATUS           23890000
239000                  END-IF                                          23900000
239100              END-IF                                              23910000
239200* BAD RATIO                                                       23920000
239300         WHEN DISTHD-PRCG-STAT-CDE  =  'A'                        23930000
239400              MOVE 'BAD RAT '          TO ASC-STATUS              23940000
239500* NOT ARRIVED                                                     23950000
239600         WHEN DISTHD-PRCG-STAT-CDE  =  'G'                        23960000
239700              MOVE 'NOT ARR '          TO ASC-STATUS              23970000
239800                                                                  23980000
239900          WHEN ASC-STATUS = SPACES                                23990000
240000              MOVE 'READY    '             TO ASC-STATUS          24000000
240100        END-EVALUATE                                              24010000
240200                                                                  24020000
240300        PERFORM 4060-GET-TDISTDT                                  24030000
240400                                                                  24040000
240500        IF DISTHD-RSLTS-RCVD-TMST = PC-DEFAULT-TIMESTAMP          24050000
240600            MOVE DISTDT-P2L-SPLT-UNT-QTY TO ASC-P2L-QTY           24060000
240700        ELSE                                                      24070000
240800            MOVE DISTDT-ACTL-ALLOC-QTY TO ASC-P2L-QTY             24080000
240900        END-IF                                                    24090000
241000                                                                  24100000
241100        IF  ASC-PRE-PACK-ORDER                                    24110000
241200            DIVIDE  ASC-P2L-QTY                                   24120000
241300                BY  ASC-PREPK-RATIO                               24130000
241400            GIVING  ASC-P2L-PAK                                   24140000
241500        END-IF                                                    24150000
241600                                                                  24160000
241700        MOVE DISTDT-FCSE-ACTL-UNT-QTY TO ASC-SHIP-QTY             24170000
241800                                                                  24180000
241900        IF  ASC-PRE-PACK-ORDER                                    24190000
242000            DIVIDE  ASC-SHIP-QTY                                  24200000
242100                BY  ASC-PREPK-RATIO                               24210000
242200            GIVING  ASC-SHIP-PAK                                  24220000
242300        END-IF                                                    24230000
242400                                                                  24240000
242500        MOVE 0 TO ASC-FCSE-SHIPPED-REM                            24250000
242600                  ASC-INPK-SHIPPED-REM                            24260000
242700                                                                  24270000
242800        IF  PV-DISTDT-ODD-CNT-FCSE  >  0                          24280000
242900            SUBTRACT DISTHD-ODD-CART-UNT-QTY                      24290000
243000                FROM DISTDT-FCSE-SPLT-UNT-QTY                     24300000
243100        END-IF                                                    24310000
243200                                                                  24320000
243300        IF (DISTDT-FCSE-SPLT-UNT-QTY > 0) AND                     24330000
243400             (DISTHD-OTPK-UNT-QTY > 0)                            24340000
243500           DIVIDE   DISTDT-FCSE-SPLT-UNT-QTY BY                   24350000
243600                    DISTHD-OTPK-UNT-QTY                           24360000
243700                 GIVING ASC-FCSE-SHIPPED                          24370000
243800                 REMAINDER ASC-FCSE-SHIPPED-REM                   24380000
243900        ELSE                                                      24390000
244000           MOVE 0 TO ASC-FCSE-SHIPPED                             24400000
244100                     ASC-FCSE-SHIPPED-REM                         24410000
244200        END-IF                                                    24420000
244300                                                                  24430000
244400        IF  ASC-FCSE-SHIPPED-REM > 0  OR                          24440000
244500            PV-DISTDT-ODD-CNT-FCSE  >  0                          24450000
244600           ADD 1 TO ASC-FCSE-SHIPPED                              24460000
244700        END-IF                                                    24470000
244800                                                                  24480000
244900        IF DISTDT-INPK-SPLT-UNT-QTY > 0                           24490000
245000           DIVIDE   DISTDT-INPK-SPLT-UNT-QTY BY                   24500000
245100                    DISTHD-INPK-UNT-QTY                           24510000
245200                    GIVING ASC-INPK-SHIPPED                       24520000
245300                    REMAINDER ASC-INPK-SHIPPED-REM                24530000
245400        ELSE                                                      24540000
245500           MOVE 0   TO ASC-INPK-SHIPPED                           24550000
245600                       ASC-INPK-SHIPPED-REM                       24560000
245700        END-IF                                                    24570000
245800                                                                  24580000
245900        IF ASC-INPK-SHIPPED-REM > 0                               24590000
246000           ADD 1 TO ASC-INPK-SHIPPED                              24600000
246100        END-IF                                                    24610000
246200                                                                  24620000
246300        PERFORM 4070-GET-TRECDIS                                  24630000
246400        IF  RECITM-STATUS-CDE = 'VE'                              24640000
246500            MOVE RECDIS-AP-VERIFY-ITM-QTY TO ASC-PKSL-QTY         24650000
246600        ELSE                                                      24660000
246700            MOVE RECDIS-EXPTED-ITM-QTY TO ASC-PKSL-QTY            24670000
246800        END-IF                                                    24680000
246900                                                                  24690000
247000        IF  ASC-PRE-PACK-ORDER                                    24700000
247100            DIVIDE  ASC-PKSL-QTY                                  24710000
247200                BY  ASC-PREPK-RATIO                               24720000
247300            GIVING  ASC-PKSL-PAK                                  24730000
247400        END-IF                                                    24740000
247500                                                                  24750000
247600*       IF ASC-SKU = SPACES                                       24760000
247700           PERFORM 4080-GET-SKU                                   24770000
247800*      END-IF                                                     24780000
247900                                                                  24790000
248000       PERFORM 4077-CALL-XLKUT001                                 24800000
248100                                                                  24810000
248200       IF ASC-SHIP-CART-CNT = 0                                   24820000
248300          MOVE DP015-PRO-NOR-OFF    TO APRSALLA                   24830000
248400                                       APRSTOA                    24840000
248500                                       APRSFRMA                   24850000
248600                                       APBPRTA                    24860000
248700                                       ALBTYPA                    24870000
248800                                       ALBORDA                    24880000
248900                                       APRSIOA                    24890000
249000          MOVE DP015-BLUE           TO APRSIOC                    24900000
249100                                       APRSTOC                    24910000
249200                                       APRSFRMC                   24920000
249300                                       APRSALLC                   24930000
249400                                       APBPRTC                    24940000
249500                                       ALBTYPC                    24950000
249600                                       ALBORDC                    24960000
249700       END-IF                                                     24970000
249800                                                                  24980000
249900       IF ASC-P2L-CART-CNT = 0                                    24990000
250000          MOVE DP015-PRO-NOR-OFF    TO APRALLA                    25000000
250100                                       APRTOA                     25010000
250200                                       APRFRMA                    25020000
250300                                       AMODLA                     25030000
250400          MOVE DP015-BLUE           TO APRALLC                    25040000
250500                                       APRTOC                     25050000
250600                                       APRFRMC                    25060000
250700                                       AMODLC                     25070000
250800       END-IF                                                     25080000
250900                                                                  25090000
251000       MOVE ZERO                    TO APRTOO                     25100000
251100                                       APRFRMO                    25110000
251200                                       APRSTOO                    25120000
251300                                       APRSFRMO                   25130000
251400       MOVE SPACES                  TO APRALLO                    25140000
251500                                       APRSALLO                   25150000
251600                                                                  25160000
251700       IF ASC-INPK-CNVYB-IND = PC-N                               25170000
251800            MOVE PC-O                  TO ASC-PRT-IO              25180000
251900            MOVE DP015-PRO-NOR-OFF     TO APRSIOA                 25190000
252000            MOVE DP015-BLUE            TO APRSIOC                 25200000
252100       END-IF                                                     25210000
252200       PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                       25220000
252300       MOVE -1                   TO AP2PRTL                       25230000
252400     END-IF.                                                      25240000
252500                                                                  25250000
252600*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*25260000
252700* GET STATUS CD FROM TRECITM                                     *25270000
252800*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*25280000
252900                                                                  25290000
253000 4040-GET-TRECITM.                                                25300000
253100                                                                  25310000
253200     EXEC SQL                                                     25320000
253300     SELECT                                                       25330000
253400               STATUS_CDE                                         25340000
253500         INTO                                                     25350000
253600              :RECITM-STATUS-CDE                                  25360000
253700         FROM  TRECITM                                            25370000
253800         WHERE ORD_NBR          = :ASC-PO-NBR                     25380000
253900         AND REC_SEQ_NBR        = :ASC-REC-SEQ-NBR                25390000
254000         AND ORD_LNE_NBR        = :ASC-PO-LNE-NBR                 25400000
254100         AND VER_STATUS_CDE     = 'A'                             25410000
254200     END-EXEC.                                                    25420000
254300                                                                  25430000
254400     EVALUATE TRUE                                                25440000
254500         WHEN SQLCODE = ZERO                                      25450000
254600             CONTINUE                                             25460000
254700         WHEN SQLCODE = +100                                      25470000
254800             MOVE SPACES              TO RECITM-STATUS-CDE        25480000
254900         WHEN SQLCODE = -904                                      25490000
255000         WHEN SQLCODE = -911                                      25500000
255100         WHEN SQLCODE = -913                                      25510000
255200             PERFORM 9900-SOFT-ABORT                              25520000
255300                                                                  25530000
255400         WHEN SQLWARN0 NOT = SPACES                               25540000
255500         WHEN SQLCODE < ZERO                                      25550000
255600         WHEN SQLCODE > ZERO                                      25560000
255700             MOVE '4040-GET-RECITM'                               25570000
255800                                  TO DP013-PARAGRAPH              25580000
255900             MOVE 'UNSUCCESSFUL SELECT FOR STATUS CD'             25590000
256000                                  TO DP013-MESSAGE-TEXT (1)       25600000
256100             MOVE SQLCA      TO DP013-SQLCA                       25610000
256200             MOVE 'TRECITM ' TO DP013-DB2-TABLE-NAME (1)          25620000
256300             SET DP013-DB2-ABEND                                  25630000
256400                 DP013-NO-ROLLBACK                                25640000
256500                                  TO TRUE                         25650000
256600             PERFORM DP013-0000-PROCESS-ABEND                     25660000
256700     END-EVALUATE.                                                25670000
256800                                                                  25680000
256900*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*25690000
257000* GET REMAINING INFO FROM TDISTHD                                *25700000
257100*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*25710000
257200 4050-GET-TDISTHD.                                                25720000
257300                                                                  25730000
257400         EXEC SQL                                                 25740000
257500             SELECT PRC_AREA_MODU_ID,                             25750000
257600                    FCSE_LBL_TYP_CDE,                             25760000
257700                    INPK_UNT_QTY,                                 25770000
257800                    OTPK_UNT_QTY,                                 25780000
257900                    INPK_CNVYB_IND,                               25790000
258000                    TOT_CART_CNT,                                 25800000
258100                    P2L_CART_CNT,                                 25810000
258200                    FCSE_CART_CNT,                                25820000
258300                    INPK_CART_CNT,                                25830000
258400                    RSLTS_RCVD_TMST,                              25840000
258500                    FCSE_CNFRMN_TMST,                             25850000
258600                    PRCG_STAT_CDE,                                25860000
258700                    SPC_INSTR_DESC,                               25870000
258800                    CRE_USR_ID,                                   25880000
258900                    ODD_CART_UNT_QTY,                             25890000
259000                    UCC128_DAT_USG_CDE,                           25900000
259100                    CRE_TMST                                      25910000
259200             INTO   :DISTHD-PRC-AREA-MODU-ID,                     25920000
259300                    :DISTHD-FCSE-LBL-TYP-CDE,                     25930000
259400                    :DISTHD-INPK-UNT-QTY,                         25940000
259500                    :DISTHD-OTPK-UNT-QTY,                         25950000
259600                    :DISTHD-INPK-CNVYB-IND,                       25960000
259700                    :DISTHD-TOT-CART-CNT,                         25970000
259800                    :DISTHD-P2L-CART-CNT,                         25980000
259900                    :DISTHD-FCSE-CART-CNT,                        25990000
260000                    :DISTHD-INPK-CART-CNT,                        26000000
260100                    :DISTHD-RSLTS-RCVD-TMST,                      26010000
260200                    :DISTHD-FCSE-CNFRMN-TMST,                     26020000
260300                    :DISTHD-PRCG-STAT-CDE,                        26030000
260400                    :DISTHD-SPC-INSTR-DESC,                       26040000
260500                    :DISTHD-CRE-USR-ID,                           26050000
260600                    :DISTHD-ODD-CART-UNT-QTY,                     26060000
260700                    :DISTHD-UCC128-DAT-USG-CDE,                   26070000
260800                    :DISTHD-CRE-TMST                              26080000
260900             FROM  TDISTHD                                        26090000
261000          WHERE ORD_NBR          =  :ASC-PO-NBR                   26100000
261100          AND   ORD_LNE_NBR      =  :ASC-PO-LNE-NBR               26110000
261200          AND   RCVR_SEQ_NBR     =  :ASC-REC-SEQ-NBR              26120000
261300         END-EXEC.                                                26130000
261400                                                                  26140000
261500         EVALUATE TRUE                                            26150000
261600                                                                  26160000
261700             WHEN SQLCODE = +0                                    26170000
261800             WHEN SQLCODE = +100                                  26180000
261900             WHEN SQLCODE = -811                                  26190000
262000             WHEN SQLCODE = -904                                  26200000
262100             WHEN SQLCODE = -913                                  26210000
262200                 CONTINUE                                         26220000
262300                                                                  26230000
262400             WHEN SQLWARN0 NOT = SPACES                           26240000
262500             WHEN SQLCODE < +0                                    26250000
262600             WHEN SQLCODE > +0                                    26260000
262700                 MOVE '4050-GET-TDISTHD'                          26270000
262800                                 TO DP013-PARAGRAPH               26280000
262900                 MOVE 'GET DATA FROM TDISTHD TABLE'               26290000
263000                                 TO DP013-MESSAGE-TEXT (1)        26300000
263100                 MOVE SQLCA      TO DP013-SQLCA                   26310000
263200                 MOVE 'TDISTHD'  TO DP013-DB2-TABLE-NAME (1)      26320000
263300                 SET DP013-DB2-ABEND                              26330000
263400                     DP013-XCTL-DISPLAY-RESTART                   26340000
263500                                 TO TRUE                          26350000
263600                 PERFORM DP013-0000-PROCESS-ABEND                 26360000
263700         END-EVALUATE.                                            26370000
263800                                                                  26380000
263900                                                                  26390000
264000                                                                  26400000
264100                                                                  26410000
264200*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*26420000
264300* GET QUANTITY INFO FROM TDISTDT                                 *26430000
264400*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*26440000
264500 4060-GET-TDISTDT.                                                26450000
264600                                                                  26460000
264700                                                                  26470000
264800         EXEC SQL                                                 26480000
264900             SELECT SUM(P2L_SPLT_UNT_QTY),                        26490000
265000                    SUM(ACTL_ALLOC_QTY),                          26500000
265100                    SUM(FCSE_SPLT_UNT_QTY),                       26510000
265200                    SUM(INPK_SPLT_UNT_QTY),                       26520000
265300                    SUM(FCSE_ACTL_UNT_QTY)                        26530000
265400             INTO   :DISTDT-P2L-SPLT-UNT-QTY,                     26540000
265500                    :DISTDT-ACTL-ALLOC-QTY,                       26550000
265600                    :DISTDT-FCSE-SPLT-UNT-QTY,                    26560000
265700                    :DISTDT-INPK-SPLT-UNT-QTY,                    26570000
265800                    :DISTDT-FCSE-ACTL-UNT-QTY                     26580000
265900             FROM  TDISTDT                                        26590000
266000         WHERE  ORD_NBR          =  :ASC-PO-NBR                   26600000
266100          AND   ORD_LNE_NBR      =  :ASC-PO-LNE-NBR               26610000
266200          AND   RCVR_SEQ_NBR     =  :ASC-REC-SEQ-NBR              26620000
266300         END-EXEC.                                                26630000
266400                                                                  26640000
266500         EVALUATE TRUE                                            26650000
266600                                                                  26660000
266700             WHEN SQLCODE = +0                                    26670000
266800                 CONTINUE                                         26680000
266900             WHEN SQLCODE = +100                                  26690000
267000             WHEN SQLCODE = -305                                  26700000
267100             WHEN SQLCODE = -811                                  26710000
267200             WHEN SQLCODE = -904                                  26720000
267300             WHEN SQLCODE = -913                                  26730000
267400                MOVE 0 TO DISTDT-P2L-SPLT-UNT-QTY                 26740000
267500                          DISTDT-ACTL-ALLOC-QTY                   26750000
267600                          DISTDT-FCSE-SPLT-UNT-QTY                26760000
267700                          DISTDT-INPK-SPLT-UNT-QTY                26770000
267800                          DISTDT-FCSE-ACTL-UNT-QTY                26780000
267900                                                                  26790000
268000             WHEN SQLWARN0 NOT = SPACES                           26800000
268100             WHEN SQLCODE < +0                                    26810000
268200             WHEN SQLCODE > +0                                    26820000
268300                 MOVE '4060-GET-TDISTDT'                          26830000
268400                                 TO DP013-PARAGRAPH               26840000
268500                 MOVE 'GET DATA FROM TDISTDT TABLE'               26850000
268600                                 TO DP013-MESSAGE-TEXT (1)        26860000
268700                 MOVE SQLCA      TO DP013-SQLCA                   26870000
268800                 MOVE 'TDISTDT'  TO DP013-DB2-TABLE-NAME (1)      26880000
268900                 SET DP013-DB2-ABEND                              26890000
269000                     DP013-XCTL-DISPLAY-RESTART                   26900000
269100                                 TO TRUE                          26910000
269200                 PERFORM DP013-0000-PROCESS-ABEND                 26920000
269300         END-EVALUATE.                                            26930000
269400                                                                  26940000
269500         EXEC SQL                                                 26950000
269600             SELECT COUNT(*)                                      26960000
269700             INTO   :PV-DISTDT-ODD-CNT-FCSE                       26970000
269800             FROM  TDISTDT                                        26980000
269900         WHERE  ORD_NBR          =  :ASC-PO-NBR                   26990000
270000           AND  ORD_LNE_NBR      =  :ASC-PO-LNE-NBR               27000000
270100           AND  RCVR_SEQ_NBR     =  :ASC-REC-SEQ-NBR              27010000
270200           AND  ODD_CART_IND     =  :PC-F                         27020000
270300         END-EXEC.                                                27030000
270400                                                                  27040000
270500         EVALUATE TRUE                                            27050000
270600                                                                  27060000
270700             WHEN SQLCODE = +0                                    27070000
270800                 CONTINUE                                         27080000
270900             WHEN SQLCODE = +100                                  27090000
271000             WHEN SQLCODE = -305                                  27100000
271100             WHEN SQLCODE = -811                                  27110000
271200             WHEN SQLCODE = -904                                  27120000
271300             WHEN SQLCODE = -913                                  27130000
271400                MOVE 0 TO PV-DISTDT-ODD-CNT-FCSE                  27140000
271500                                                                  27150000
271600             WHEN SQLWARN0 NOT = SPACES                           27160000
271700             WHEN SQLCODE < +0                                    27170000
271800             WHEN SQLCODE > +0                                    27180000
271900                 MOVE '4060-GET-TDISTDT-2'                        27190000
272000                                 TO DP013-PARAGRAPH               27200000
272100                 MOVE 'GET DATA FROM TDISTDT TABLE'               27210000
272200                                 TO DP013-MESSAGE-TEXT (1)        27220000
272300                 MOVE SQLCA      TO DP013-SQLCA                   27230000
272400                 MOVE 'TDISTDT'  TO DP013-DB2-TABLE-NAME (1)      27240000
272500                 SET DP013-DB2-ABEND                              27250000
272600                     DP013-XCTL-DISPLAY-RESTART                   27260000
272700                                 TO TRUE                          27270000
272800                 PERFORM DP013-0000-PROCESS-ABEND                 27280000
272900         END-EVALUATE.                                            27290000
273000                                                                  27300000
273100                                                                  27310000
273200                                                                  27320000
273300*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*27330000
273400* GET PACKSLIP INFO FROM TRECDIS                                 *27340000
273500*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*27350000
273600 4070-GET-TRECDIS.                                                27360000
273700                                                                  27370000
273800                                                                  27380000
273900         EXEC SQL                                                 27390000
274000             SELECT SUM(EXPTED_ITM_QTY),                          27400000
274100                    SUM(AP_VERIFY_ITM_QTY)                        27410000
274200             INTO   :RECDIS-EXPTED-ITM-QTY,                       27420000
274300                    :RECDIS-AP-VERIFY-ITM-QTY                     27430000
274400             FROM  TRECDIS                                        27440000
274500         WHERE  ORD_NBR          =  :ASC-PO-NBR                   27450000
274600          AND   ORD_LNE_NBR      =  :ASC-PO-LNE-NBR               27460000
274700          AND   REC_SEQ_NBR      =  :ASC-REC-SEQ-NBR              27470000
274800         END-EXEC.                                                27480000
274900                                                                  27490000
275000         EVALUATE TRUE                                            27500000
275100                                                                  27510000
275200             WHEN SQLCODE = +0                                    27520000
275300                 CONTINUE                                         27530000
275400             WHEN SQLCODE = +100                                  27540000
275500             WHEN SQLCODE = -305                                  27550000
275600             WHEN SQLCODE = -811                                  27560000
275700             WHEN SQLCODE = -904                                  27570000
275800             WHEN SQLCODE = -913                                  27580000
275900                 MOVE 0 TO  RECDIS-EXPTED-ITM-QTY,                27590000
276000                            RECDIS-AP-VERIFY-ITM-QTY              27600000
276100                                                                  27610000
276200             WHEN SQLWARN0 NOT = SPACES                           27620000
276300             WHEN SQLCODE < +0                                    27630000
276400             WHEN SQLCODE > +0                                    27640000
276500                 MOVE '4070-GET-TRECDIS'                          27650000
276600                                 TO DP013-PARAGRAPH               27660000
276700                 MOVE 'GET DATA FROM TRECDIS TABLE'               27670000
276800                                 TO DP013-MESSAGE-TEXT (1)        27680000
276900                 MOVE SQLCA      TO DP013-SQLCA                   27690000
277000                 MOVE 'TRECDIS'  TO DP013-DB2-TABLE-NAME (1)      27700000
277100                 SET DP013-DB2-ABEND                              27710000
277200                     DP013-XCTL-DISPLAY-RESTART                   27720000
277300                                 TO TRUE                          27730000
277400                 PERFORM DP013-0000-PROCESS-ABEND                 27740000
277500         END-EVALUATE.                                            27750000
277600                                                                  27760000
277700                                                                  27770000
277800                                                                  27780000
277900                                                                  27790000
278000*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*27800000
278100* GET THE VENDOR STYLE NAME FROM TRECITM/TPURITM FOR PC126       *27810000
278200*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*27820000
278300 4075-GET-VENDOR-STYLE.                                           27830000
278400     EXEC SQL                                                     27840000
278500          SELECT B.VEND_STYL_NAME                                 27850000
278600           INTO :PURITM-VEND-STYL-NAME                            27860000
278700           FROM TRECITM A                                         27870000
278800               ,TPURITM B                                         27880000
278900          WHERE A.ORD_NBR           = :ASC-PO-NBR                 27890000
279000            AND A.REC_SEQ_NBR       = :ASC-REC-SEQ-NBR            27900000
279100            AND A.ORD_LNE_NBR       = :ASC-PO-LNE-NBR             27910000
279200            AND A.VER_STATUS_CDE    = 'A'                         27920000
279300            AND A.ORD_NBR           = B.PO_NBR                    27930000
279400            AND A.ORD_LNE_NBR       = B.APP_PO_LNE_NBR            27940000
279500            AND B.VER_STATUS_CDE    = 'A'                         27950000
279600     END-EXEC.                                                    27960000
279700                                                                  27970000
279800     EVALUATE TRUE                                                27980000
279900         WHEN SQLCODE = ZERO                                      27990000
280000              MOVE  PURITM-VEND-STYL-NAME  TO  PC126-VENDOR-STYLE 28000000
280100         WHEN SQLCODE = -904                                      28010000
280200         WHEN SQLCODE = -913                                      28020000
280300              CONTINUE                                            28030000
280400         WHEN SQLWARN0 NOT = SPACES                               28040000
280500         WHEN SQLCODE < ZERO                                      28050000
280600         WHEN SQLCODE > ZERO                                      28060000
280700              MOVE '4075-GET-VENDOR-STYLE'                        28070000
280800                                     TO DP013-PARAGRAPH           28080000
280900              MOVE 'GET VENDOR STYLE NAME  '                      28090000
281000                                     TO DP013-MESSAGE-TEXT (1)    28100000
281100              MOVE SQLCA             TO DP013-SQLCA               28110000
281200              MOVE 'TPURITM'         TO DP013-DB2-TABLE-NAME (1)  28120000
281300              MOVE 'TRECITM'         TO DP013-DB2-TABLE-NAME (2)  28130000
281400              SET DP013-DB2-ABEND TO TRUE                         28140000
281500              SET DP013-XCTL-DISPLAY-RESTART                      28150000
281600                                     TO TRUE                      28160000
281700              PERFORM DP013-0000-PROCESS-ABEND                    28170000
281800     END-EVALUATE.                                                28180000
281900                                                                  28190000
282000                                                                  28200000
282100*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*28210000
282200* GET SSCC-18-IND FROM TCOCNTL TO DETERMINE IF DC IS SET UP      *28220000
282300* TO PROCESS 20 & 22 DIGIT BARCODES                              *28230000
282400*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*28240000
282500 4076-GET-TCOCNTL-INFO.                                           28250000
282600                                                                  28260000
282700     MOVE ASC-OPER-UNT-ID  TO  DK-OPER-UNT-ID-2.                  28270000
282800                                                                  28280000
282900     EXEC SQL                                                     28290000
283000          SELECT  SSCC_18_IND                                     28300000
283100            INTO :COCNTL-SSCC-18-IND                              28310000
283200            FROM  TCOCNTL                                         28320000
283300           WHERE  OPER_UNT_ID  = :DK-OPER-UNT-ID-2                28330000
283400     END-EXEC.                                                    28340000
283500                                                                  28350000
283600     EVALUATE TRUE                                                28360000
283700         WHEN SQLCODE = ZERO                                      28370000
283800              CONTINUE                                            28380000
283900         WHEN SQLWARN0 NOT = SPACES                               28390000
284000         WHEN SQLCODE < ZERO                                      28400000
284100         WHEN SQLCODE > ZERO                                      28410000
284200              MOVE '4076-GET-TCOCNTL-INFO'                        28420000
284300                                     TO DP013-PARAGRAPH           28430000
284400              MOVE 'GET SSCC-18-IND        '                      28440000
284500                                     TO DP013-MESSAGE-TEXT (1)    28450000
284600              MOVE SQLCA             TO DP013-SQLCA               28460000
284700              MOVE 'TCOCNTL'         TO DP013-DB2-TABLE-NAME (1)  28470000
284800              SET DP013-DB2-ABEND TO TRUE                         28480000
284900              SET DP013-XCTL-DISPLAY-RESTART                      28490000
285000                                     TO TRUE                      28500000
285100              PERFORM DP013-0000-PROCESS-ABEND                    28510000
285200     END-EVALUATE.                                                28520000
285300                                                                  28530000
285400                                                                  28540000
285500*----------------------------------------------------------------*28550000
285600* GET ITEM NUMBER FROM TSK TABLE.                                *28560000
285700*----------------------------------------------------------------*28570000
285800 4077-CALL-XLKUT001.                                              28580000
285900                                                                  28590000
286000     INITIALIZE XL001-ITEM-COMMAREA.                              28600000
286100                                                                  28610000
286200     MOVE ASC-ITM-NBR                 TO XL001-KEY-ITM-NBR        28620000
286300                                                                  28630000
286400     SET  XL001-BY-ITEM                                           28640000
286500          XL001-SELECT-SKU            TO TRUE                     28650000
286600                                                                  28660000
286700     CALL XL001-VSM-PGM USING  DFHEIBLK                           28670000
286800                               XL001-COMMAREA                     28680000
286900                               XL001-ITEM-COMMAREA.               28690000
287000     EVALUATE TRUE                                                28700000
287100         WHEN XL001-SUCCESSFUL                                    28710000
287200             MOVE XL001-SKU-NBR TO ASC-SKU                        28720000
287300         WHEN XL001-SQL-ERROR                                     28730000
287400              IF XL001-SKU-CONTENTION                             28740000
287500                 MOVE XL001-SKU-SQLCODE TO PV-SOFT-SQLCODE        28750000
287600                 MOVE '4077-CALL-XLKUT001 ' TO PV-SOFT-PARAGRAPH  28760000
287700                 MOVE 'TABLE CONTENTION' TO PV-SOFT-MSG           28770000
287800                 MOVE PV-SOFT-ABORT-MSG  TO PV-CICS-MSG-AREA2     28780000
287900                 MOVE LENGTH OF PV-CICS-MSG-AREA2                 28790000
288000                                        TO PV-COMMAREA-LENGTH     28800000
288100                 EXEC CICS                                        28810000
288200                      WRITEQ TD                                   28820000
288300                       QUEUE  ('CSSL')                            28830000
288400                        FROM  (PV-CICS-MSG-AREA2)                 28840000
288500                      LENGTH  (PV-COMMAREA-LENGTH)                28850000
288600                        RESP  (PV-CICS-RESP)                      28860000
288700                 END-EXEC                                         28870000
288800                 MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER      28880000
288900                 SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE          28890000
289000                 PERFORM 9900-SOFT-ABORT                          28900000
289100              ELSE                                                28910000
289200                 MOVE '4077-CALL-XLKUT001'                        28920000
289300                                        TO DP013-PARAGRAPH        28930000
289400                 MOVE 'SQL ERROR IN CALLED MODULE'                28940000
289500                                        TO DP013-MESSAGE-TEXT (1) 28950000
289600                 MOVE XL001-SQLCA       TO DP013-SQLCA            28960000
289700                 MOVE 'XLKUT001'        TO DP013-DB2-TABLE-NAME(1)28970000
289800                 SET DP013-DB2-ABEND TO TRUE                      28980000
289900                 SET DP013-XCTL-DISPLAY-RESTART                   28990000
290000                                        TO TRUE                   29000000
290100              END-IF                                              29010000
290200         WHEN OTHER                                               29020000
290300                 MOVE '4077-CALL-XLKUT001'                        29030000
290400                                        TO DP013-PARAGRAPH        29040000
290500                 MOVE 'INVALID ACCESS  '                          29050000
290600                                        TO DP013-MESSAGE-TEXT (1) 29060000
290700                 MOVE XL001-SQLCA       TO DP013-SQLCA            29070000
290800                 MOVE 'XLKUT001'        TO DP013-DB2-TABLE-NAME(1)29080000
290900                 SET DP013-DB2-ABEND TO TRUE                      29090000
291000                 SET DP013-XCTL-DISPLAY-RESTART                   29100000
291100                                        TO TRUE                   29110000
291200                                                                  29120000
291300     END-EVALUATE.                                                29130000
291400                                                                  29140000
291500*----------------------------------------------------------------*29150000
291600* GET THE TOTAL NUMBER OF UNITS FOR A PREPACK ORDER (M OR I)     *29160000
291700*----------------------------------------------------------------*29170000
291800 4078-GET-TOT-PREPK-UNTS.                                         29180000
291900     MOVE ASC-PO-NBR       TO  DK2-PO-NBR.                        29190000
292000     MOVE ASC-REC-SEQ-NBR  TO  DK2-REC-SEQ-NBR.                   29200000
292100     MOVE ASC-PREPK-ID     TO  DK2-PREPK-ID.                      29210000
292200                                                                  29220000
292300     EXEC SQL                                                     29230000
292400         SELECT SUM(PREPK_RATO_QTY)                               29240000
292500               ,SUM(INNR_PACK_QTY)                                29250000
292600           INTO :PV-TOT-PREPK-UNTS                                29260000
292700               ,:PV-TOT-PREPK-INPK-UNTS                           29270000
292800           FROM TRECITM                                           29280000
292900          WHERE ORD_NBR      =  :DK2-PO-NBR                       29290000
293000            AND REC_SEQ_NBR  =  :DK2-REC-SEQ-NBR                  29300000
293100            AND PREPK_ID     =  :DK2-PREPK-ID                     29310000
293200     END-EXEC.                                                    29320000
293300                                                                  29330000
293400     EVALUATE TRUE                                                29340000
293500         WHEN SQLCODE = +0                                        29350000
293600             CONTINUE                                             29360000
293700         WHEN SQLCODE = -904                                      29370000
293800         WHEN SQLCODE = -913                                      29380000
293900              CONTINUE                                            29390000
294000         WHEN SQLWARN0 NOT = SPACES                               29400000
294100         WHEN SQLCODE < ZERO                                      29410000
294200         WHEN SQLCODE > ZERO                                      29420000
294300              MOVE '4078-GET-TOT-PREPK-UNTS'                      29430000
294400                                     TO DP013-PARAGRAPH           29440000
294500              MOVE 'GET TOTAL NUMBER OF UNIT IN PACK'             29450000
294600                                     TO DP013-MESSAGE-TEXT (1)    29460000
294700              MOVE SQLCA             TO DP013-SQLCA               29470000
294800              MOVE 'TRECITM'         TO DP013-DB2-TABLE-NAME (1)  29480000
294900              SET DP013-DB2-ABEND TO TRUE                         29490000
295000              SET DP013-XCTL-DISPLAY-RESTART                      29500000
295100                                     TO TRUE                      29510000
295200              PERFORM DP013-0000-PROCESS-ABEND                    29520000
295300     END-EVALUATE.                                                29530000
295400                                                                  29540000
295500                                                                  29550000
295600*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*29560000
295700* GET SKU FROM TPURITM/TPURCHS                                   *29570000
295800*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*29580000
295900 4080-GET-SKU.                                                    29590000
296000                                                                  29600000
296100                                                                  29610000
296200         EXEC SQL                                                 29620000
296300             SELECT C.DEPT_NBR,                                   29630000
296400                    B.CL_NBR,                                     29640000
296500                    B.SKU_SEQ_NBR,                                29650000
296600                    B.ITM_NBR                                     29660000
296700             INTO   :PURCHS-DEPT-NBR,                             29670000
296800                    :PURITM-CL-NBR,                               29680000
296900                    :PURITM-SKU-SEQ-NBR,                          29690000
297000                    :PURITM-ITM-NBR                               29700000
297100             FROM  TRECITM A,                                     29710000
297200                   TPURITM B,                                     29720000
297300                   TPURCHS C                                      29730000
297400        WHERE   A.ORD_NBR        =  :ASC-PO-NBR                   29740000
297500          AND   A.ORD_LNE_NBR    =  :ASC-PO-LNE-NBR               29750000
297600          AND   A.REC_SEQ_NBR    =  :ASC-REC-SEQ-NBR              29760000
297700          AND   A.ORD_NBR        =  B.PO_NBR                      29770000
297800          AND   A.ORD_NBR        =  C.PO_NBR                      29780000
297900          AND   A.ORD_LNE_NBR    =  B.APP_PO_LNE_NBR              29790000
298000          AND   A.VER_STATUS_CDE = 'A'                            29800000
298100          AND   B.VER_STATUS_CDE = 'A'                            29810000
298200          AND   C.VER_STATUS_CDE = 'A'                            29820000
298300                                                                  29830000
298400         END-EXEC.                                                29840000
298500                                                                  29850000
298600         EVALUATE TRUE                                            29860000
298700                                                                  29870000
298800             WHEN SQLCODE = +0                                    29880000
298900                 MOVE PURITM-ITM-NBR  TO ASC-ITM-NBR              29890000
299000                 MOVE PURITM-CL-NBR   TO ASC-CLASS                29900000
299100                 MOVE PURCHS-DEPT-NBR TO ASC-DEPT                 29910000
299200             WHEN SQLCODE = +100                                  29920000
299300             WHEN SQLCODE = -811                                  29930000
299400             WHEN SQLCODE = -904                                  29940000
299500             WHEN SQLCODE = -913                                  29950000
299600                 MOVE SPACES TO  PURCHS-DEPT-NBR,                 29960000
299700                                 PURITM-CL-NBR,                   29970000
299800                                 PURITM-SKU-SEQ-NBR               29980000
299900             WHEN SQLWARN0 NOT = SPACES                           29990000
300000             WHEN SQLCODE < +0                                    30000000
300100             WHEN SQLCODE > +0                                    30010000
300200                 MOVE '4080-GET-SKU'                              30020000
300300                                 TO DP013-PARAGRAPH               30030000
300400                 MOVE 'GET DATA FROM TPURITM/TPURCHS'             30040000
300500                                 TO DP013-MESSAGE-TEXT (1)        30050000
300600                 MOVE SQLCA      TO DP013-SQLCA                   30060000
300700                 MOVE 'TPURITM'  TO DP013-DB2-TABLE-NAME (1)      30070000
300800                 SET DP013-DB2-ABEND                              30080000
300900                     DP013-XCTL-DISPLAY-RESTART                   30090000
301000                                 TO TRUE                          30100000
301100                 PERFORM DP013-0000-PROCESS-ABEND                 30110000
301200         END-EVALUATE.                                            30120000
301300                                                                  30130000
301400                                                                  30140000
301500                                                                  30150000
301600                                                                  30160000
301700                                                                  30170000
301710*----------------------------------------------------------------*30171011
301720* CHECK IF LABEL PRINT ABENDED ON INTIAL DOWNLOAD AND OTBND TABLE*30172011
301721* WAS NOT UPDATED CORRECTLY                                      *30172111
301730*----------------------------------------------------------------*30173011
301740 4090-CHECK-ERROR-ON-DOWNLOAD.                                    30174011
301750                                                                  30175011
301760                                                                  30176011
301770       EXEC SQL                                                   30177011
301780         SELECT A.SHIPT_UNT_ID                                    30178011
301793          INTO  :SUT00024-SHIPT-UNT-ID                            30179311
301797          FROM  SUT_OTBND_CART A                                  30179711
301798             ,  SUT_OTBND_UPC B                                   30179811
301799             ,  TKRPRPM       C                                   30179916
301800          WHERE   A.SHIPT_UNT_ID   =  B.SHIPT_UNT_ID              30180011
301801            AND   B.TRN_NBR        =  :ASC-PO-NBR                 30180111
301802            AND   B.TRN_LNE_NBR    =  :ASC-PO-LNE-NBR             30180211
301803            AND   B.RCVR_SEQ_NBR   =  :ASC-REC-SEQ-NBR            30180311
301804            AND   A.CART_TYP_CDE   =  ' '                         30180411
301805            AND   A.CART_SRC_CDE   =  'CPS'                       30180511
301806            AND   A.LBL_PRT_SEQ_NBR = 0                           30180611
301807            AND   A.ACTV_IND       = 'Y'                          30180711
301808            AND   A.ORGN_LOC_NBR   = C.LOC_ID                     30180816
301809            AND   C.SYS_PRC_FUNC_CDE  = 'CSMFST'                  30180916
301810            AND   C.FUNC_TXT          = 'Y'                       30181017
301811            AND   C.FUNC_PRC_STAT_CDE = 'AC'                      30181116
301812       END-EXEC.                                                  30181211
301813                                                                  30181311
301814         EVALUATE TRUE                                            30181411
301815                                                                  30181511
301816             WHEN SQLCODE = +0                                    30181611
301817             WHEN SQLCODE = -811                                  30181712
301818                 SET ASC-ERR-ON-LABEL-DWNLD TO TRUE               30181812
301819             WHEN SQLCODE = +100                                  30181911
301820                  SET ASC-ERR-ON-LABEL-DWNLD-NO TO TRUE           30182012
301827             WHEN SQLWARN0 NOT = SPACES                           30182711
301828             WHEN SQLCODE < +0                                    30182811
301829             WHEN SQLCODE > +0                                    30182911
301830                 MOVE '4090-CHECK-ERROR-ON-DOWNLOAD'              30183012
301831                                 TO DP013-PARAGRAPH               30183111
301832                 MOVE 'CHECK OTBND CARTON DATA  '                 30183212
301833                                 TO DP013-MESSAGE-TEXT (1)        30183311
301834                 MOVE SQLCA      TO DP013-SQLCA                   30183411
301835                 MOVE 'SUT_OTBND_CART' TO DP013-DB2-TABLE-NAME (1)30183512
301836                 SET DP013-DB2-ABEND                              30183611
301837                     DP013-XCTL-DISPLAY-RESTART                   30183711
301838                                 TO TRUE                          30183811
301839                 PERFORM DP013-0000-PROCESS-ABEND                 30183911
301840         END-EVALUATE.                                            30184011
301841                                                                  30184111
301842                                                                  30184211
301843                                                                  30184311
301844                                                                  30184411
301845                                                                  30184511
301850*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*30185011
301900* MOVE THE DISPLAYED FIELDS FROM THE COMMAREA TO THE SCREEN.     *30190000
302000*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*30200000
302100 4400-MOVE-COMMAREA-TO-SCREEN.                                    30210000
302200     MOVE ASC-OPER-UNT-ID          TO AOPUNTO.                    30220000
302300     MOVE ASC-FCLTY-ID             TO AFCLTYO.                    30230000
302400     MOVE ASC-SML-P2L-PRTR-ID      TO AP2PRTO.                    30240000
302500     MOVE ASC-PGYBCK-PRTR-ID       TO APBPRTO.                    30250000
302600     MOVE ASC-MODU-NBR             TO AMODULO.                    30260000
302700     MOVE ASC-PO-NBR               TO APONBRO.                    30270000
302800     MOVE ASC-REC-SEQ-NBR          TO ARECVRO.                    30280000
302900                                                                  30290000
303000     IF  ASC-DSP-INNER-PREPK                                      30300000
303100         MOVE  PC-INNER-PREPACK    TO APKGCDO                     30310000
303200     ELSE                                                         30320000
303300     IF  ASC-DSP-MULTI-SKU-PREPK                                  30330000
303400         MOVE  PC-MULTI-SKU        TO APKGCDO                     30340000
303500     ELSE                                                         30350000
303600     IF  ASC-DSP-SINGLE-SKU-PREPK                                 30360000
303700         MOVE  PC-SINGLE-SKU       TO APKGCDO                     30370000
303800     ELSE                                                         30380000
303900     IF  ASC-DSP-CASEPACK                                         30390000
304000         MOVE  PC-CASEPACK         TO APKGCDO                     30400000
304100     ELSE                                                         30410000
304200     IF  ASC-DSP-BULK-PACK                                        30420000
304300         MOVE  PC-BULK             TO APKGCDO                     30430000
304400     END-IF                                                       30440000
304500     END-IF                                                       30450000
304600     END-IF                                                       30460000
304700     END-IF                                                       30470000
304800     END-IF.                                                      30480000
304900                                                                  30490000
305000     IF  ASC-DSP-PRE-PACK-ORDER                                   30500000
305100         MOVE DP015-YELLOW         TO APKGCDC                     30510000
305200     END-IF.                                                      30520000
305300                                                                  30530000
305400     IF  ASC-PRE-PACK-ORDER                                       30540000
305500         MOVE DP015-YELLOW         TO ATOTPSC                     30550000
305600                                      ATOTPRC                     30560000
305700                                      ATOTP2C                     30570000
305800                                      ATOTSHC                     30580000
305900                                      AINPAKC                     30590000
306000                                      ASKUC                       30600000
306100         MOVE ASC-PREPK-RATIO      TO AINPAKO                     30610000
306200         MOVE ASC-PREPK-ID         TO PV-PACKID                   30620000
306300         MOVE PV-DISPLAY-PACKID    TO ASKUO                       30630000
306400         MOVE ASC-PKSL-PAK         TO ATOTPSO                     30640000
306500         MOVE ASC-PROC-PAK         TO ATOTPRO                     30650000
306600         MOVE ASC-P2L-PAK          TO ATOTP2O                     30660000
306700         MOVE ASC-SHIP-PAK         TO ATOTSHO                     30670000
306800         MOVE PC-PAK               TO AHPKSLO                     30680000
306900                                      AHPRCSO                     30690000
307000                                      AHP2LO                      30700000
307100                                      AHSHIPO                     30710000
307200         MOVE PC-RATIO             TO AHINRTO                     30720000
307300         MOVE PC-PACKID            TO AHSKPKO                     30730000
307400     ELSE                                                         30740000
307500         MOVE ASC-INPK-UNT-QTY     TO AINPAKO                     30750000
307600         MOVE ASC-SKU              TO ASKUO                       30760000
307700         MOVE ASC-PKSL-QTY         TO ATOTPSO                     30770000
307800         MOVE ASC-PROC-QTY         TO ATOTPRO                     30780000
307900         MOVE ASC-P2L-QTY          TO ATOTP2O                     30790000
308000         MOVE ASC-SHIP-QTY         TO ATOTSHO                     30800000
308100         MOVE PC-QTY               TO AHPKSLO                     30810000
308200                                      AHPRCSO                     30820000
308300                                      AHP2LO                      30830000
308400                                      AHSHIPO                     30840000
308500         MOVE PC-INPK              TO AHINRTO                     30850000
308600         MOVE PC-SKU               TO AHSKPKO                     30860000
308700     END-IF.                                                      30870000
308800                                                                  30880000
308900     MOVE ASC-USERID               TO ACRUSERO.                   30890000
309000     MOVE ASC-PO-LNE-NBR           TO ALINEO.                     30900000
309100     MOVE ASC-OTPK-UNT-QTY         TO AOTPAKO.                    30910000
309200     MOVE ASC-STATUS               TO ASTATO.                     30920000
309300     MOVE ASC-INPK-CNVYB-IND       TO AIPCNVO.                    30930000
309400     MOVE ASC-LBL-PRT-TYPE         TO ALBTYPO.                    30940000
309500                                                                  30950000
309600     MOVE ASC-ODD-CARTON           TO AODUNTO.                    30960000
309700     IF  ASC-ODD-CRTN-FCSE                                        30970000
309800         MOVE  PC-ODD-CRTN-FCSE    TO AODUSEO                     30980000
309900     ELSE                                                         30990000
310000     IF  ASC-ODD-CRTN-INPK                                        31000000
310100         MOVE  PC-ODD-CRTN-INPK    TO AODUSEO                     31010000
310200     ELSE                                                         31020000
310300     IF  ASC-ODD-CRTN-P2L                                         31030000
310400         MOVE  PC-ODD-CRTN-P2L     TO AODUSEO                     31040000
310500     ELSE                                                         31050000
310600         MOVE  SPACES              TO AODUSEO                     31060000
310700     END-IF                                                       31070000
310800     END-IF                                                       31080000
310900     END-IF.                                                      31090000
311000                                                                  31100000
311100     IF ASC-SHIP-CART-CNT > 0                                     31110000
311200        IF ASC-LBL-PRT-TYPE = PC-S                                31120000
311300            MOVE PC-SML            TO ALBDSCO                     31130000
311400        ELSE                                                      31140000
311500        IF ASC-LBL-PRT-TYPE = PC-P                                31150000
311600            MOVE PC-PGYBCK         TO ALBDSCO                     31160000
311700        ELSE                                                      31170000
311800        IF ASC-LBL-PRT-TYPE = PC-X                                31180000
311900            MOVE PC-NO-LBL         TO ALBDSCO                     31190000
312000        END-IF                                                    31200000
312100        END-IF                                                    31210000
312200        END-IF                                                    31220000
312300     ELSE                                                         31230000
312400        MOVE SPACES                TO ALBDSCO                     31240000
312500     END-IF.                                                      31250000
312600     MOVE ASC-LBL-PRT-ORDER        TO ALBORDO.                    31260000
312700     MOVE ASC-P2L-CART-CNT         TO AP2CRTO.                    31270000
312800     MOVE ASC-PROC-CART-CNT        TO APRCRTO.                    31280000
312900     MOVE ASC-SHIP-CART-CNT        TO ASHCRTO.                    31290000
313000     EVALUATE ASC-CRE-LBL-IND                                     31300000
313100        WHEN PC-B                                                 31310000
313200           MOVE PC-P2L-CASE-DESC   TO ALBLCRO                     31320000
313300        WHEN PC-P                                                 31330000
313400           MOVE PC-P2L-LBL-DESC    TO ALBLCRO                     31340000
313500        WHEN PC-C                                                 31350000
313600           MOVE PC-CASE-LBL-DESC   TO ALBLCRO                     31360000
313700        WHEN OTHER                                                31370000
313800           MOVE SPACES             TO ALBLCRO                     31380000
313900     END-EVALUATE.                                                31390000
314000     MOVE ASC-PRT-HEAD-FOOT        TO AP2LHDO.                    31400000
314100     MOVE ASC-PRT-IO               TO APRSIOO.                    31410000
314200     MOVE ASC-INPK-SHIPPED         TO AINPKO.                     31420000
314300     MOVE ASC-FCSE-SHIPPED         TO AFCSEO.                     31430000
314400     MOVE ASC-SPEC-INST-DESC       TO ALBSIO.                     31440000
314500                                                                  31450000
314600     MOVE ASC-TMST-DTE             TO ACRDTEO.                    31460000
314700     MOVE ASC-TMST-TM              TO ACRTMEO.                    31470000
314800                                                                  31480000
314900                                                                  31490000
315000*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*31500000
315100 5000-PREPARE-SEL-QUEUE.                                          31510000
315200                                                                  31520000
315300                                                                  31530000
315400     MOVE ASC-PO-NBR             TO  PC126-PO-NBR.                31540000
315500     MOVE ASC-REC-SEQ-NBR        TO  PC126-RCVR-SEQ-NBR.          31550000
315600     MOVE ASC-PO-LNE-NBR         TO  PC126-PO-LNE-NBR.            31560000
315700     MOVE ASC-OPER-UNT-ID        TO  PC126-OPER-UNT-ID.           31570000
315800     MOVE ASC-ODD-CARTON         TO  PC126-ODD-CRTN-UNT-QTY.      31580000
315900     MOVE ASC-ODD-CARTON-USE-SW  TO  PC126-ODD-CRTN-USE.          31590000
316000     MOVE ASC-DC-PRTD-AT         TO  PC126-DC-PRTD-AT.            31600000
316100     MOVE ASC-ITM-NBR            TO  PC126-ITEM-NBR.              31610000
316110     MOVE ASC-TRIP-ARRIVE-DATE   TO  PC126-TRIP-ARRIVE-DATE       31611018
316200                                                                  31620000
316300     IF  ASC-DISTHD-ORIG-LBL-TYP  =  PC-X                         31630000
316400         SET  PC126-INITIAL-PRINT  TO  TRUE                       31640000
316500     ELSE                                                         31650000
316600         SET  PC126-REPRINT        TO  TRUE                       31660000
316700     END-IF.                                                      31670000
316800                                                                  31680000
316900     MOVE ASC-LBL-PRT-ORDER      TO  PC126-PRT-SEQ.               31690000
317000     IF  ASC-SPEC-INST-DESC  >  SPACES                            31700000
317100         MOVE ASC-SPEC-INST-DESC TO PC126-STR-ZNE                 31710000
317200     ELSE                                                         31720000
317300         MOVE ASC-DFLT-STR-ZN-ID TO PC126-STR-ZNE                 31730000
317400     END-IF.                                                      31740000
317500     MOVE ASC-SKU                TO  PC126-SKU.                   31750000
317600***** IF THE USER ENTERED 'I' OR 'O' IN THE I/O LABELS FIELD      31760000
317700***** FOR SHIPPING AND THEY ENTERED ONLY P2L LABEL DATA THEN      31770000
317800***** IGNORE THE DATA THEY ENTERED IN THE I/O LABEL FIELD         31780000
317900***** AS THEY WEREN'T SUPPOSED TO USE THIS FIELD.                 31790000
318000     IF ASC-PRT-SHP-FROM = SPACES AND                             31800000
318100        ASC-PRT-SHP-TO   = SPACES AND                             31810000
318200        ASC-PRT-SHP-ALL  = SPACES                                 31820000
318300        MOVE SPACES TO ASC-PRT-IO                                 31830000
318400     END-IF.                                                      31840000
318500     IF ASC-PRT-IO = PC-O                                         31850000
318600        IF ASC-PRT-SHP-ALL = PC-Y OR PC-X OR PC-S                 31860000
318700          SET PC126-SHP-RPRT-FCSE-ALL TO TRUE                     31870000
318800        ELSE                                                      31880000
318900          SET PC126-SHP-RPRT-FCSE     TO TRUE                     31890000
319000        END-IF                                                    31900000
319100     ELSE                                                         31910000
319200        IF ASC-PRT-IO = PC-I                                      31920000
319300           IF ASC-PRT-SHP-ALL = PC-Y OR PC-X OR PC-S              31930000
319400              SET PC126-SHP-RPRT-INPK-ALL TO TRUE                 31940000
319500           ELSE                                                   31950000
319600              SET PC126-SHP-RPRT-INPK     TO TRUE                 31960000
319700           END-IF                                                 31970000
319800        ELSE                                                      31980000
319900           IF ASC-PRT-SHP-ALL = PC-Y OR PC-X OR PC-S              31990000
320000               SET PC126-SHP-RPRT-ALL     TO TRUE                 32000000
320100           END-IF                                                 32010000
320200        END-IF                                                    32020000
320300     END-IF.                                                      32030000
320400                                                                  32040000
320500     IF ASC-PRT-P2L-ALL = PC-Y OR PC-X OR PC-S                    32050000
320600         SET PC126-P2L-RPRT-ALL           TO TRUE                 32060000
320700     END-IF.                                                      32070000
320800                                                                  32080000
320900     IF ASC-PRT-SHP-FROM = SPACES AND                             32090000
321000        ASC-PRT-SHP-TO   = SPACES AND                             32100000
321100        ASC-PRT-SHP-ALL  = SPACES                                 32110000
321200        MOVE ZEROES              TO PC126-FCSE-LBL-CNT            32120000
321300                                    PC126-INPK-LBL-CNT            32130000
321400                                    PC126-SHP-REPRT-FROM-CNT      32140000
321500                                    PC126-SHP-REPRT-TO-CNT        32150000
321600        MOVE SPACES              TO PC126-SHIP-LABEL-TYPE         32160000
321700     ELSE                                                         32170000
321800        MOVE ASC-LBL-PRT-TYPE    TO PC126-SHIP-LABEL-TYPE         32180000
321900        MOVE ASC-PRT-SHP-FROM-N  TO PC126-SHP-REPRT-FROM-CNT      32190000
322000        MOVE ASC-PRT-SHP-TO-N    TO PC126-SHP-REPRT-TO-CNT        32200000
322100        IF ASC-PRT-IO = PC-I                                      32210000
322200            MOVE 0               TO PC126-FCSE-LBL-CNT            32220000
322300        ELSE                                                      32230000
322400            MOVE ASC-FCSE-SHIPPED TO PC126-FCSE-LBL-CNT           32240000
322500        END-IF                                                    32250000
322600        IF ASC-PRT-IO = PC-O                                      32260000
322700            MOVE 0               TO PC126-INPK-LBL-CNT            32270000
322800        ELSE                                                      32280000
322900            MOVE ASC-INPK-SHIPPED TO PC126-INPK-LBL-CNT           32290000
323000        END-IF                                                    32300000
323100     END-IF.                                                      32310000
323200                                                                  32320000
323300     IF ASC-PRT-P2L-FROM = SPACES AND                             32330000
323400        ASC-PRT-P2L-TO   = SPACES AND                             32340000
323500        ASC-PRT-P2L-ALL  = SPACES                                 32350000
323600        MOVE ZEROES              TO PC126-P2L-LBL-CNT             32360000
323700                                    PC126-P2L-REPRT-FROM-CNT      32370000
323800                                    PC126-P2L-REPRT-TO-CNT        32380000
323900     ELSE                                                         32390000
324000        MOVE ASC-P2L-CART-CNT    TO PC126-P2L-LBL-CNT             32400000
324100        MOVE ASC-PRT-P2L-FROM-N  TO PC126-P2L-REPRT-FROM-CNT      32410000
324200        MOVE ASC-PRT-P2L-TO-N    TO PC126-P2L-REPRT-TO-CNT        32420000
324300     END-IF.                                                      32430000
324400                                                                  32440000
324500     MOVE ASC-OTPK-UNT-QTY       TO PC126-OTPK-UNT-QTY.           32450000
324600     MOVE ASC-INPK-UNT-QTY       TO PC126-INPK-UNT-QTY.           32460000
324700     IF ASC-MODU-NBR-OVERRIDE-N > ZERO                            32470000
324800         MOVE ASC-MODU-NBR-OVERRIDE-N                             32480000
324900                                 TO PC126-MOD-NBR                 32490000
325000     ELSE                                                         32500000
325100         MOVE ASC-MODU-NBR       TO PC126-MOD-NBR                 32510000
325200     END-IF                                                       32520000
325300     MOVE ASC-SML-P2L-PRTR-ID    TO PC126-SHP-PRTR-ID.            32530000
325400     MOVE ASC-PGYBCK-PRTR-ID     TO PC126-PGYBK-PRTR-ID.          32540000
325500     MOVE ASC-PRT-QUEUE-NAME     TO PC126-PRT-QUEUE-NAME.         32550000
325600     MOVE PC-CURRENT-PROGRAM-NAME                                 32560000
325700                                 TO PC126-CALLING-PGM-NME.        32570000
325800     PERFORM 4075-GET-VENDOR-STYLE.                               32580000
325900     PERFORM 4076-GET-TCOCNTL-INFO.                               32590000
326000     MOVE  COCNTL-SSCC-18-IND    TO PC126-SSCC-18-IND.            32600000
326100                                                                  32610000
326200* DMH BEGIN - 4/4/03                                              32620000
326300*    IF  DP020-INT-APPL-FORMAT-IND =  PC-CRIT-SPEC-FORMAT         32630000
326400*        IF PURITM-SKU-SEQ-NBR = '000'                            32640000
326500*           MOVE ZEROES TO ASC-SKU                                32650000
326600*        ELSE                                                     32660000
326700*           IF PURITM-SKU-SEQ-NBR = '999'                         32670000
326800*              MOVE '99999999'  TO ASC-SKU                        32680000
326900*           ELSE                                                  32690000
327000*              PERFORM 4077-CALL-XLKUT001                         32700000
327100*           END-IF                                                32710000
327200*        END-IF                                                   32720000
327300*    END-IF                                                       32730000
327400* DMH END   - 4/4/03                                              32740000
327500                                                                  32750000
327600                                                                  32760000
327700     MOVE 0                      TO PC126-DC-BOUND-UNTS           32770000
327800                                    PC126-RTV-BOUND-UNTS.         32780000
327900     MOVE ASC-PRT-HEAD-FOOT      TO PC126-P2L-PRT-HDR-SW          32790000
328000** DMH                                                            32800000
328100     MOVE ASC-PKGNG-CD           TO PC126-PKGNG-CD.               32810000
328200     MOVE ASC-DSPLY-PKGNG-CD     TO PC126-DSPLY-PKGNG-CD.         32820000
328300     MOVE ASC-PREPK-ID           TO PC126-PREPK-ID.               32830000
328400     MOVE ASC-PREPK-RATIO        TO PC126-PREPK-RATIO.            32840000
328500     MOVE ASC-PACKS-IN-CRTN      TO PC126-PACKS-IN-CRTN.          32850000
328600     MOVE ASC-SIGNON-USERID      TO PC126-USER-ID.                32860000
328700     MOVE ASC-DEPT               TO PC126-DEPT-NBR.               32870000
328800     MOVE ASC-CLASS              TO PC126-CL-NBR.                 32880000
328900                                                                  32890000
329000     IF  ASC-PRE-PACK-ORDER                                       32900000
329100         PERFORM 4078-GET-TOT-PREPK-UNTS                          32910000
329200         MOVE  PV-TOT-PREPK-UNTS  TO  PC126-TOT-PREPK-UNTS        32920000
329300         MOVE  PV-TOT-PREPK-INPK-UNTS                             32930000
329400                                  TO  PC126-PREPK-INPK-UNT-QTY    32940000
329500     ELSE                                                         32950000
329600         MOVE  ZEROES             TO  PC126-TOT-PREPK-UNTS        32960000
329700                                      PC126-PREPK-INPK-UNT-QTY    32970000
329800     END-IF.                                                      32980000
329900** DMH                                                            32990000
330000     MOVE LENGTH OF PC126-COMMAREA-REC                            33000000
330100                                 TO PV-COMMAREA-LENGTH.           33010000
330200     PERFORM 5900-LINK-PRINT-ROUTINE-SYSTEC.                      33020000
330300                                                                  33030000
330400     IF  ASC-DISTHD-ORIG-LBL-TYP  =  PC-X                         33040000
330500         PERFORM 6000-UPDATE-DISTHD                               33050000
330600     END-IF.                                                      33060000
330700                                                                  33070000
330800                                                                  33080000
330900*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*33090000
331000*    LINK TO THE PROGRAM WHICH BUILDS THE JOBS USED TO PRODUCE   *33100000
331100*    THE BATCH SHIPPING MANIFEST LABELS.  THIS ROUTINE WILL      *33110000
331200*    BE USED FOR PRINTERS THAT ARE SET UP FOR THE NEW SYS-TEC    *33120000
331300*    LABEL SYSTEM.                                               *33130000
331400*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*33140000
331500 5900-LINK-PRINT-ROUTINE-SYSTEC.                                  33150000
331600     EXEC CICS                                                    33160000
331700          LINK PROGRAM  ('PCKCS191')                              33170000
331800               COMMAREA (PC126-COMMAREA-REC)                      33180000
331900               LENGTH   (PV-COMMAREA-LENGTH)                      33190000
332000               RESP     (PV-CICS-RESP)                            33200000
332100     END-EXEC.                                                    33210000
332200     EVALUATE TRUE                                                33220000
332300         WHEN PV-CICS-RESP = DFHRESP (NORMAL)                     33230000
332400              CONTINUE                                            33240000
332500         WHEN OTHER                                               33250000
332600              PERFORM DP013-0000-PROCESS-ABEND                    33260000
332700     END-EVALUATE.                                                33270000
332800     MOVE PC126-CRA-RET-CDE      TO PM-RET-CDE.                   33280000
332900     MOVE PC126-CRA-RET-MSG      TO PM-RET-MSG.                   33290000
333000     MOVE PM-PROGRAM-MESSAGE-1   TO DP020-MSG-TEXT.               33300000
333100                                                                  33310000
333200                                                                  33320000
333300*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 33330000
333400* UPDATE DISTHD LBL TYPE IF ORIGINALLY = 'X'                     *33340000
333500*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 33350000
333600 6000-UPDATE-DISTHD.                                              33360000
333700                                                                  33370000
333800     MOVE  ASC-LBL-PRT-TYPE       TO  DISTHD-FCSE-LBL-TYP-CDE.    33380000
333900                                                                  33390000
334000     IF  DISTHD-FCSE-LBL-TYP-CDE  =  PC-X                         33400000
334100         MOVE  PC-N               TO  DISTHD-FCSE-LBL-TYP-CDE     33410000
334200     END-IF.                                                      33420000
334300                                                                  33430000
334400     EXEC SQL                                                     33440000
334500          UPDATE TDISTHD                                          33450000
334600             SET                                                  33460000
334700                 FCSE_LBL_TYP_CDE  = :DISTHD-FCSE-LBL-TYP-CDE     33470000
334800           WHERE ORD_NBR           = :ASC-PO-NBR                  33480000
334900             AND RCVR_SEQ_NBR      = :ASC-REC-SEQ-NBR             33490000
335000             AND ORD_LNE_NBR       = :ASC-PO-LNE-NBR              33500000
335100     END-EXEC.                                                    33510000
335200                                                                  33520000
335300     EVALUATE TRUE                                                33530000
335400                                                                  33540000
335500         WHEN SQLCODE = +0                                        33550000
335600             CONTINUE                                             33560000
335700                                                                  33570000
335800         WHEN SQLCODE = -904                                      33580000
335900         WHEN SQLCODE = -911                                      33590000
336000         WHEN SQLCODE = -913                                      33600000
336100             PERFORM 9900-SOFT-ABORT                              33610000
336200                                                                  33620000
336300         WHEN SQLWARN0 NOT = SPACES                               33630000
336400         WHEN SQLCODE < +0                                        33640000
336500         WHEN SQLCODE > +0                                        33650000
336600             MOVE '6000-UPDATE-DISTHD'                            33660000
336700                             TO DP013-PARAGRAPH                   33670000
336800             MOVE 'UPDATE LABEL TYPE ON DISTHD TABLE'             33680000
336900                             TO DP013-MESSAGE-TEXT (1)            33690000
337000             MOVE SQLCA          TO DP013-SQLCA                   33700000
337100             MOVE 'TDISTHD'      TO DP013-DB2-TABLE-NAME (1)      33710000
337200             SET DP013-DB2-ABEND                                  33720000
337300                 DP013-XCTL-DISPLAY-RESTART                       33730000
337400                             TO TRUE                              33740000
337500             PERFORM DP013-0000-PROCESS-ABEND                     33750000
337600     END-EVALUATE.                                                33760000
337700                                                                  33770000
337800                                                                  33780000
337900*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 33790000
338000* READ AN ITEM FROM THE SELECTED ITEMS TEMP STORAGE QUEUE.       *33800000
338100*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 33810000
338200 9100-READ-SEL-QUEUE.                                             33820000
338300     EXEC CICS                                                    33830000
338400         READQ TS                                                 33840000
338500             QUEUE (ASC-SEL-QUEUE-NAME)                           33850000
338600             INTO  (PC121-DC-SELECT-RECORD)                       33860000
338700             ITEM  (ASC-SEL-ITEM)                                 33870000
338800             RESP  (PV-CICS-RESP)                                 33880000
338900     END-EXEC.                                                    33890000
339000     IF PV-CICS-RESP EQUAL DFHRESP(NORMAL)                        33900000
339100         CONTINUE                                                 33910000
339200     ELSE                                                         33920000
339300         SET DP013-LOGIC-ABEND                                    33930000
339400             DP013-NO-ROLLBACK   TO   TRUE                        33940000
339500         MOVE '9100-READ-SEL-QUEUE'                               33950000
339600                                 TO   DP013-PARAGRAPH             33960000
339700         MOVE 'ATTEMPTING TO READ THE LIST SELECTIONS TS QUEUE'   33970000
339800                                 TO   DP013-MESSAGE-TEXT (1)      33980000
339900         PERFORM DP013-0000-PROCESS-ABEND                         33990000
340000     END-IF.                                                      34000000
340100                                                                  34010000
340200                                                                  34020000
340300*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*34030000
340400* UPDATE AN ITEM IN THE SELECTED ITEMS TEMP STORAGE QUEUE.       *34040000
340500*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 34050000
340600 9200-REWRITE-SEL-QUEUE.                                          34060000
340700     EXEC CICS                                                    34070000
340800          WRITEQ TS                                               34080000
340900              QUEUE  (ASC-SEL-QUEUE-NAME)                         34090000
341000              FROM   (PC121-DC-SELECT-RECORD)                     34100000
341100              ITEM   (ASC-SEL-ITEM)                               34110000
341200              RESP   (PV-CICS-RESP)                               34120000
341300              REWRITE                                             34130000
341400     END-EXEC.                                                    34140000
341500                                                                  34150000
341600     IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)                   34160000
341700         SET DP013-CICS-ABEND                                     34170000
341800             DP013-NO-ROLLBACK     TO TRUE                        34180000
341900         MOVE '9200-REWRITE-SEL-QUEUE'                            34190000
342000                                   TO DP013-PARAGRAPH             34200000
342100         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   34210000
342200                                   TO DP013-MESSAGE-TEXT (1)      34220000
342300         PERFORM DP013-0000-PROCESS-ABEND                         34230000
342400     END-IF.                                                      34240000
342500                                                                  34250000
342600                                                                  34260000
342700*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*34270000
342800*    THE DB2 RESOURCE IS NOT AVAILABLE, DISPLAY A MESSAGE ON     *34280000
342900*    THE TERMINAL INDICATING THAT THE RESOURCE IS UNAVAILABLE.   *34290000
343000*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*34300000
343100 9900-SOFT-ABORT.                                                 34310000
343200                                                                  34320000
343300     EXEC CICS SYNCPOINT                                          34330000
343400          ROLLBACK                                                34340000
343500     END-EXEC.                                                    34350000
343600                                                                  34360000
343700     SET  PS-ERROR              TO TRUE.                          34370000
343800                                                                  34380000
343900                                                                  34390000
344000*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*34400000
344100*    ABEND PROCESSOR MODULE                                      *34410000
344200*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*34420000
344300                                                                  34430000
344400     COPY DPPD013.                                                34440000
