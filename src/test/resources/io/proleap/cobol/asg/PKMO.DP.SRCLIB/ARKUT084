000100******************************************************************00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300******************************************************************00030000
000400                                                                  00040000
000500 PROGRAM-ID.             ARKUT084.                                00050005
000600 AUTHOR.                 KAREN GIVENS.                            00060000
000700 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00070000
000800 DATE-WRITTEN            02-16-2012.                              00080000
000900 DATE-COMPILED.                                                   00090000
001000                                                                  00100000
001100******************************************************************00110000
001100* THE PURPOSE OF THIS PROGRAM IS TO READ THROUGH FIRST DATA       00120013
001100* EMSR (ENHANCED MAILER STATEMENT RECORD FILE) SOURCE FILE TO     00130014
001100* VERIFY THAT WE RECEIVED ALL THE RECORDS FROM FD AND TO          00140014
001100* PRODUCE OTHER OUTPUT DATASETS THAT CONTAIN RECORD COUNTS.       00150014
001100* THIS PROGRAM WILL WRITE OUT AN EXACT COPY OF THE EMSR SOURCE    00160014
001100* FILE WITHOUT HEADER AND TRAILER RECORDS.                        00170014
001100* THIS PROGRAM WILL WRITE OUT 8 OUTPUT COUNT FILES.               00180014
001500******************************************************************00190000
001600                                                                  00200000
001700******************************************************************00210000
001800 ENVIRONMENT DIVISION.                                            00220000
001900******************************************************************00230000
002000                                                                  00240000
002100 CONFIGURATION SECTION.                                           00250000
002200                                                                  00260000
002300 SOURCE-COMPUTER.        IBM-3090.                                00270000
002400 OBJECT-COMPUTER.        IBM-3090.                                00280000
002500                                                                  00290000
002600 INPUT-OUTPUT SECTION.                                            00300000
002700                                                                  00310000
002800 FILE-CONTROL.                                                    00320000
002900                                                                  00330000
003000     SELECT EMSR-STMT-IN-FILE                                     00340000
003100         ASSIGN TO INP01.                                         00350000
003300     SELECT EMSR-STMT-OUT-FILE                                    00360000
003400         ASSIGN TO OUT01.                                         00370000
003401     SELECT TOTAL-NBR-EMSR-BSE-FILE                               00380000
003402         ASSIGN TO OUT02.                                         00390000
003403     SELECT TOTAL-NBR-EMSR-DTL-FILE                               00400000
003404         ASSIGN TO OUT03.                                         00410000
003405     SELECT TOTAL-NBR-EMSR-INSFLG-FILE                            00420000
003406         ASSIGN TO OUT04.                                         00430000
003407     SELECT TOTAL-NBR-EMSR-INSNM2-FILE                            00440000
003408         ASSIGN TO OUT05.                                         00450000
003409     SELECT TOTAL-NBR-EMSR-INSPRD-FILE                            00460000
003410         ASSIGN TO OUT06.                                         00470000
003411     SELECT TOTAL-NBR-EMSR-INSNM-FILE                             00480000
003412         ASSIGN TO OUT07.                                         00490000
003413     SELECT TOTAL-NBR-EMSR-INSNM2GR-FILE                          00500000
003414         ASSIGN TO OUT08.                                         00510000
003415     SELECT TOTAL-NBR-EMSR-ADMSG-FILE                             00520000
003416         ASSIGN TO OUT09.                                         00530000
003500                                                                  00540000
003600******************************************************************00550000
003700 DATA DIVISION.                                                   00560000
003800******************************************************************00570000
003900                                                                  00580000
004000 FILE SECTION.                                                    00590000
004100                                                                  00600000
004200 FD EMSR-STMT-IN-FILE                                             00610000
004300     RECORDING MODE V                                             00620000
004300     LABEL RECORDS ARE STANDARD                                   00630007
004300     BLOCK CONTAINS 0 RECORDS                                     00640007
004300     RECORD IS VARYING IN SIZE                                    00650007
004300               FROM 90 TO 13442                                   00660007
004300                   DEPENDING ON IN-REC-LENGTH.                    00670007
004601 01  EMSR-CUSTOM-MSR-STMT-RECORD.                                 00680000
004602     05  EMSR-CKEY-RECORD-KEY.                                    00690000
005000         10  EMSR-CKEY-RECORD-ID    PIC X(2).                     00700000
005000             88  IN-EMSR-HEADER-REC       VALUE "HD".             00710000
005000             88  IN-EMSR-TRAILER-REC      VALUE "TR".             00720000
005000             88  IN-EMSR-BSE-REC          VALUE "B0".             00730004
005000             88  IN-EMSR-DTL-REC          VALUE "N0".             00740004
005000         10  FILLER                 PIC X(88).                    00750000
005015************************************************************      00760000
006200* FOR 01 LEVELS, ADD 10 BYTES TO ACCOUNT FOR REC IDENTIFIER.      00770000
006300************************************************************      00780000
006906 01 IN-EMSR-REC                     PIC X(13442).                 00790003
006907                                                                  00800000
006908 FD EMSR-STMT-OUT-FILE                                            00810000
006909     RECORDING MODE IS V                                          00820000
006909     LABEL RECORDS ARE STANDARD                                   00830007
006909     BLOCK CONTAINS 0 RECORDS                                     00840007
006909     RECORD IS VARYING IN SIZE                                    00850007
006909               FROM 90 TO 13442                                   00860007
006909                   DEPENDING ON OUT-REC-LENGTH.                   00870007
006913************************************************************      00880000
006914* FOR 01 LEVELS, ADD 10 BYTES TO ACCOUNT FOR REC IDENTIFIER.      00890000
006915************************************************************      00900000
006400 01 OUT-BSE-REC                     PIC X(90).                    00910000
006906 01 OUT-EMSR-REC                    PIC X(13442).                 00920003
006922                                                                  00930000
006923 FD TOTAL-NBR-EMSR-BSE-FILE                                       00940000
006924     RECORDING MODE IS F                                          00950000
006925     BLOCK CONTAINS 0 RECORDS                                     00960000
006926     LABEL RECORDS ARE STANDARD.                                  00970000
006927 01  TOTAL-NBR-EMSR-BSE-REC          PIC X(80).                   00980000
006928                                                                  00990000
006929 FD TOTAL-NBR-EMSR-DTL-FILE                                       01000000
006930     RECORDING MODE IS F                                          01010000
006931     BLOCK CONTAINS 0 RECORDS                                     01020000
006932     LABEL RECORDS ARE STANDARD.                                  01030000
006933 01  TOTAL-NBR-EMSR-DTL-REC          PIC X(80).                   01040000
006934                                                                  01050000
006935 FD TOTAL-NBR-EMSR-INSFLG-FILE                                    01060000
006936     RECORDING MODE IS F                                          01070000
006937     BLOCK CONTAINS 0 RECORDS                                     01080000
006938     LABEL RECORDS ARE STANDARD.                                  01090000
006939 01  TOTAL-NBR-EMSR-INSFLG-REC       PIC X(80).                   01100000
006940                                                                  01110000
006941 FD TOTAL-NBR-EMSR-INSNM2-FILE                                    01120000
006942     RECORDING MODE IS F                                          01130000
006943     BLOCK CONTAINS 0 RECORDS                                     01140000
006944     LABEL RECORDS ARE STANDARD.                                  01150000
006945 01  TOTAL-NBR-EMSR-INSNM2-REC       PIC X(80).                   01160000
006946                                                                  01170000
006947 FD TOTAL-NBR-EMSR-INSPRD-FILE                                    01180000
006948     RECORDING MODE IS F                                          01190000
006949     BLOCK CONTAINS 0 RECORDS                                     01200000
006950     LABEL RECORDS ARE STANDARD.                                  01210000
006951 01  TOTAL-NBR-EMSR-INSPRD-REC       PIC X(80).                   01220000
006952                                                                  01230000
006953 FD TOTAL-NBR-EMSR-INSNM-FILE                                     01240000
006954     RECORDING MODE IS F                                          01250000
006955     BLOCK CONTAINS 0 RECORDS                                     01260000
006956     LABEL RECORDS ARE STANDARD.                                  01270000
006957 01  TOTAL-NBR-EMSR-INSNM-REC        PIC X(80).                   01280000
006958                                                                  01290000
006959 FD TOTAL-NBR-EMSR-INSNM2GR-FILE                                  01300000
006960     RECORDING MODE IS F                                          01310000
006961     BLOCK CONTAINS 0 RECORDS                                     01320000
006962     LABEL RECORDS ARE STANDARD.                                  01330000
006963 01  TOTAL-NBR-EMSR-INSNM2GR-REC     PIC X(80).                   01340000
006970                                                                  01350000
006971 FD TOTAL-NBR-EMSR-ADMSG-FILE                                     01360000
006972     RECORDING MODE IS F                                          01370000
006973     BLOCK CONTAINS 0 RECORDS                                     01380000
006974     LABEL RECORDS ARE STANDARD.                                  01390000
006975 01  TOTAL-NBR-EMSR-ADMSG-REC        PIC X(80).                   01400000
006982                                                                  01410000
006989 WORKING-STORAGE SECTION.                                         01420000
006990******************************************************************01430000
006991*                        ABEND CODES                              01440000
006992******************************************************************01450000
006993     COPY ARWS052.                                                01460000
006994                                                                  01470000
006995******************************************************************01480000
006996*                        SWITCHES                                 01490000
006997******************************************************************01500000
006998 01 PS-PROGRAM-SWITCHES.                                          01510000
006999    05 PS-PROCESSING-SW               PIC X      VALUE SPACES.    01520000
007000       88 PS-CONTINUE-PROCESSING                 VALUE 'Y'.       01530000
007001       88 PS-STOP-PROCESSING                     VALUE 'N'.       01540000
007002                                                                  01550000
007003******************************************************************01560000
007004*                        CONSTANTS                                01570000
007005******************************************************************01580000
007100 01 PC-PROGRAM-CONSTANTS.                                         01590000
007200    05 PC-PROGRAM-NAME                PIC X(8)   VALUE 'ARKUT084'.01600000
007300                                                                  01610000
007400******************************************************************01620000
007500*                        VARIABLES                                01630000
007600******************************************************************01640000
007700 01 PV-PROGRAM-VARIABLES.                                         01650000
008000    05 PV-READ-COUNT                  PIC S9(9)  VALUE ZEROES     01660000
008100                                                 COMP.            01670000
008101    05 PV-CRDMAST-COUNT               PIC S9(9)  VALUE ZEROES     01680000
008102                                                 COMP.            01690000
008103    05 PV-BSE-COUNT                   PIC S9(9)  VALUE ZEROES     01700000
008104                                                 COMP.            01710000
008105    05 PV-DTL-COUNT                   PIC S9(9)  VALUE ZEROES     01720000
008106                                                 COMP.            01730000
008107    05 PV-INSFLG-COUNT                PIC S9(9)  VALUE ZEROES     01740000
008108                                                 COMP.            01750000
008109    05 PV-INSNM2-COUNT                PIC S9(9)  VALUE ZEROES     01760000
008110                                                 COMP.            01770000
008111    05 PV-INSPRD-COUNT                PIC S9(9)  VALUE ZEROES     01780000
008112                                                 COMP.            01790000
008113    05 PV-INSNM-COUNT                 PIC S9(9)  VALUE ZEROES     01800000
008114                                                 COMP.            01810000
008115    05 PV-INSNM2GR-COUNT              PIC S9(9)  VALUE ZEROES     01820000
008116                                                 COMP.            01830000
008117    05 PV-ADMSG-COUNT                 PIC S9(9)  VALUE ZEROES     01840000
008118                                                 COMP.            01850000
008200    05 PV-BTCH-DATE.                                              01860000
008300       10 PV-BTCH-DATE-YYYY           PIC 9(04)  VALUE ZEROS.     01870000
008400       10 PV-BTCH-DATE-MM             PIC 9(02)  VALUE ZEROS.     01880000
008500       10 PV-BTCH-DATE-DD             PIC 9(02)  VALUE ZEROS.     01890000
008600    05 PV-BTCH-NBR.                                               01900000
008700       10 PV-BTCH-SEQ-NBR             PIC 9(1)   VALUE ZERO.      01910000
008800       10 PV-BTCH-MM                  PIC 9(2)   VALUE ZEROS.     01920000
008900       10 PV-BTCH-DD                  PIC 9(2)   VALUE ZEROS.     01930000
009202    05 PV-TRAILER-REC-CNT             PIC 9(8)   VALUE ZEROS.     01940009
008920    77 IN-REC-LENGTH                  PIC 9(5)   VALUE ZEROS.     01950007
008920    77 OUT-REC-LENGTH                 PIC 9(5)   VALUE ZEROS.     01960007
009000******************************************************************01970000
009100*                        WORK AREA                                01980000
009200******************************************************************01990000
009201 01 IN-TRAILER-RECORD.                                            02000009
009203    05 FILLER                       PIC X(10) VALUE SPACES.       02010009
009202    05 IN-TRAILER-REC-CNT           PIC 9(08) VALUE ZEROES.       02020009
009203    05 FILLER                       PIC X(72) VALUE SPACES.       02030009
009204                                                                  02040000
009201 01 OUT-TOTAL-RECORD.                                             02050009
009202    05 OUT-TOTAL-RECORD-COUNT       PIC 9(10) VALUE ZEROES.       02060009
009203    05 FILLER                       PIC X(70) VALUE SPACES.       02070009
009204                                                                  02080009
009205******************************************************************02090000
009206*                        COPYBOOKS                                02100000
009207******************************************************************02110000
009300                                                                  02120000
009400******************************************************************02130000
009500* FD EMSR CUSTOM MASTER STATEMENT LAYOUT - VARIABLE LAYOUT (INPUT)02140000
009600******************************************************************02150000
009700     COPY ARRD081.                                                02160000
009800                                                                  02170000
009900******************************************************************02180000
010000 PROCEDURE DIVISION.                                              02190000
010100******************************************************************02200000
010200*--------------*                                                  02210000
010300 0000-MAINLINE.                                                   02220000
010400*--------------*                                                  02230000
010500                                                                  02240000
010600     PERFORM Z050-INITIALIZE.                                     02250000
010700                                                                  02260000
010800     PERFORM 1000-PROCESS-CARD-MASTER-FILE.                       02270000
010900                                                                  02280000
011000     PERFORM Z100-END-PROC.                                       02290000
011100                                                                  02300000
011200     STOP RUN.                                                    02310000
011300                                                                  02320000
011400*-------------------------------*                                 02330000
011500 1000-PROCESS-CARD-MASTER-FILE.                                   02340000
011600*-------------------------------*                                 02350000
011700     SET PS-CONTINUE-PROCESSING TO TRUE.                          02360000
011800                                                                  02370000
011900     PERFORM 4000-READ-EMSR-STMT.                                 02380000
012000                                                                  02390000
012100     PERFORM 2000-PROCESS-CARD-MASTER                             02400000
012200       UNTIL PS-STOP-PROCESSING.                                  02410000
012201                                                                  02420000
012202     PERFORM 5000-WRITE-OUTPUT-FILES.                             02430000
012203                                                                  02440000
012400*-------------------------------*                                 02450000
012500 2000-PROCESS-CARD-MASTER.                                        02460000
012600*-------------------------------*                                 02470000
013900                                                                  02480000
013901     IF IN-EMSR-HEADER-REC                                        02490000
013901        PERFORM 4000-READ-EMSR-STMT                               02500000
013901     ELSE                                                         02510000
013901        IF IN-EMSR-TRAILER-REC                                    02520000
013902           MOVE EMSR-CUSTOM-MSR-STMT-RECORD                       02530009
013902                                    TO IN-TRAILER-RECORD          02540009
013902           MOVE IN-TRAILER-REC-CNT  TO PV-TRAILER-REC-CNT         02550009
013901           PERFORM 4000-READ-EMSR-STMT                            02560000
013901        ELSE                                                      02570000
013902           MOVE EMSR-CUSTOM-MSR-STMT-RECORD                       02580007
013902                             TO AR-81-CUSTOM-MSR-STMT-RECORD      02590007
013903           PERFORM 2100-PROCESS-MASTER-COUNTS                     02600000
013904           PERFORM 5100-WRITE-MSTR-REC                            02610000
013905           PERFORM 4000-READ-EMSR-STMT                            02620000
014603        END-IF                                                    02630000
014604     END-IF.                                                      02640000
014605                                                                  02650000
014607*-------------------------------*                                 02660000
014608 2100-PROCESS-MASTER-COUNTS.                                      02670000
014609*-------------------------------*                                 02680000
014606                                                                  02690000
014614     IF IN-EMSR-BSE-REC                                           02700000
014618        ADD +1                      TO PV-BSE-COUNT               02710000
014619     END-IF.                                                      02720000
014606                                                                  02730000
014614     IF IN-EMSR-DTL-REC                                           02740000
014618        ADD +1                      TO PV-DTL-COUNT               02750000
014619     END-IF.                                                      02760000
014606                                                                  02770000
029321*-------------------------------*                                 02780000
029322 4000-READ-EMSR-STMT.                                             02790000
029323*-------------------------------*                                 02800000
029324                                                                  02810000
029325     READ EMSR-STMT-IN-FILE                                       02820000
029327       AT END                                                     02830000
029328        SET PS-STOP-PROCESSING TO TRUE                            02840000
029329     END-READ.                                                    02850000
029330                                                                  02860000
029331     IF NOT PS-STOP-PROCESSING                                    02870000
029332        ADD 1 TO PV-READ-COUNT                                    02880000
029333     END-IF.                                                      02890000
029334                                                                  02900000
029335*-------------------------------*                                 02910000
029336 5000-WRITE-OUTPUT-FILES.                                         02920000
029337*-------------------------------*                                 02930000
029338     PERFORM 5200-WRITE-BSE-CNT-REC.                              02940000
029339     PERFORM 5300-WRITE-DTL-CNT-REC.                              02950000
029340     PERFORM 5400-WRITE-INSFLG-CNT-REC.                           02960000
029341     PERFORM 5500-WRITE-INSNM2-CNT-REC.                           02970000
029342     PERFORM 5600-WRITE-INSPRD-CNT-REC.                           02980000
029343     PERFORM 5700-WRITE-INSNM-CNT-REC.                            02990000
029344     PERFORM 5800-WRITE-INSNM2GR-CNT-REC.                         03000000
029345     PERFORM 5900-WRITE-ADMSG-CNT-REC.                            03010000
029349                                                                  03020000
029350*-------------------------------*                                 03030000
029351 5100-WRITE-MSTR-REC.                                             03040000
029352*-------------------------------*                                 03050000
029337                                                                  03060007
029350     MOVE IN-REC-LENGTH TO OUT-REC-LENGTH.                        03070007
029351                                                                  03080007
029373     MOVE IN-EMSR-REC (1:IN-REC-LENGTH)                           03090007
029374       TO OUT-EMSR-REC.                                           03100000
029375     WRITE OUT-EMSR-REC.                                          03110000
029375                                                                  03120000
029376     ADD 1                                                        03130000
029377      TO PV-CRDMAST-COUNT.                                        03140000
029378                                                                  03150000
029379*-------------------------------*                                 03160000
029380 5200-WRITE-BSE-CNT-REC.                                          03170000
029381*-------------------------------*                                 03180000
029382     MOVE PV-BSE-COUNT                                            03190000
029383       TO OUT-TOTAL-RECORD-COUNT                                  03200000
029384     WRITE TOTAL-NBR-EMSR-BSE-REC                                 03210000
029385        FROM OUT-TOTAL-RECORD.                                    03220000
029386                                                                  03230000
029387*-------------------------------*                                 03240000
029388 5300-WRITE-DTL-CNT-REC.                                          03250000
029389*-------------------------------*                                 03260000
029390     MOVE PV-DTL-COUNT                                            03270000
029391       TO OUT-TOTAL-RECORD-COUNT                                  03280000
029392     WRITE TOTAL-NBR-EMSR-DTL-REC                                 03290000
029393        FROM OUT-TOTAL-RECORD.                                    03300000
029394                                                                  03310000
029395*-------------------------------*                                 03320000
029396 5400-WRITE-INSFLG-CNT-REC.                                       03330000
029397*-------------------------------*                                 03340000
014606                                                                  03350000
014614     COMPUTE PV-INSFLG-COUNT  =                                   03360000
014618             PV-BSE-COUNT  * 16                                   03370001
014606                                                                  03380000
029398     MOVE PV-INSFLG-COUNT                                         03390000
029399       TO OUT-TOTAL-RECORD-COUNT                                  03400000
029400     WRITE TOTAL-NBR-EMSR-INSFLG-REC                              03410000
029401        FROM OUT-TOTAL-RECORD.                                    03420000
029402                                                                  03430000
029403*-------------------------------*                                 03440000
029404 5500-WRITE-INSNM2-CNT-REC.                                       03450000
029405*-------------------------------*                                 03460000
014606                                                                  03470000
014614     COMPUTE PV-INSNM2-COUNT =                                    03480000
014618             PV-BSE-COUNT  * 16                                   03490001
029410                                                                  03500000
029406     MOVE PV-INSNM2-COUNT                                         03510000
029407       TO OUT-TOTAL-RECORD-COUNT                                  03520000
029408     WRITE TOTAL-NBR-EMSR-INSNM2-REC                              03530000
029409        FROM OUT-TOTAL-RECORD.                                    03540000
029410                                                                  03550000
029411*-------------------------------*                                 03560000
029412 5600-WRITE-INSPRD-CNT-REC.                                       03570000
029413*-------------------------------*                                 03580000
014619                                                                  03590000
014606     COMPUTE PV-INSPRD-COUNT =                                    03600000
014618             PV-BSE-COUNT  * 6                                    03610001
029418                                                                  03620000
029414     MOVE PV-INSPRD-COUNT                                         03630000
029415       TO OUT-TOTAL-RECORD-COUNT                                  03640000
029416     WRITE TOTAL-NBR-EMSR-INSPRD-REC                              03650000
029417        FROM OUT-TOTAL-RECORD.                                    03660000
029418                                                                  03670000
029419*-------------------------------*                                 03680000
029420 5700-WRITE-INSNM-CNT-REC.                                        03690000
029421*-------------------------------*                                 03700000
014606                                                                  03710000
014614     COMPUTE PV-INSNM-COUNT =                                     03720000
014618             PV-BSE-COUNT  * 16                                   03730001
029426                                                                  03740000
029422     MOVE PV-INSNM-COUNT                                          03750000
029423       TO OUT-TOTAL-RECORD-COUNT                                  03760000
029424     WRITE TOTAL-NBR-EMSR-INSNM-REC                               03770000
029425        FROM OUT-TOTAL-RECORD.                                    03780000
029426                                                                  03790000
029427*-------------------------------*                                 03800000
029428 5800-WRITE-INSNM2GR-CNT-REC.                                     03810000
029429*-------------------------------*                                 03820000
014606                                                                  03830000
014614     COMPUTE PV-INSNM2GR-COUNT =                                  03840000
014618             PV-BSE-COUNT  * 5                                    03850001
029434                                                                  03860000
029430     MOVE PV-INSNM2GR-COUNT                                       03870000
029431       TO OUT-TOTAL-RECORD-COUNT                                  03880000
029432     WRITE TOTAL-NBR-EMSR-INSNM2GR-REC                            03890000
029433        FROM OUT-TOTAL-RECORD.                                    03900000
029434                                                                  03910000
029435*-------------------------------*                                 03920000
029436 5900-WRITE-ADMSG-CNT-REC.                                        03930000
029437*-------------------------------*                                 03940000
014606                                                                  03950000
014614     COMPUTE PV-ADMSG-COUNT =                                     03960000
014618             PV-BSE-COUNT  * 5                                    03970001
014606                                                                  03980000
029438     MOVE PV-ADMSG-COUNT                                          03990000
029439       TO OUT-TOTAL-RECORD-COUNT                                  04000000
029440     WRITE TOTAL-NBR-EMSR-ADMSG-REC                               04010000
029441        FROM OUT-TOTAL-RECORD.                                    04020000
029442                                                                  04030000
029450                                                                  04040000
029467******************************************************************04050000
029468* Z050 - INITIALIZE                                               04060000
029469******************************************************************04070000
029470 Z050-INITIALIZE.                                                 04080000
029471                                                                  04090000
029472     OPEN INPUT  EMSR-STMT-IN-FILE                                04100000
029473     OPEN OUTPUT EMSR-STMT-OUT-FILE                               04110000
029474                 TOTAL-NBR-EMSR-BSE-FILE                          04120000
029475                 TOTAL-NBR-EMSR-DTL-FILE                          04130000
029476                 TOTAL-NBR-EMSR-INSFLG-FILE                       04140000
029477                 TOTAL-NBR-EMSR-INSNM2-FILE                       04150000
029478                 TOTAL-NBR-EMSR-INSPRD-FILE                       04160000
029479                 TOTAL-NBR-EMSR-INSNM-FILE                        04170000
029480                 TOTAL-NBR-EMSR-INSNM2GR-FILE                     04180000
029481                 TOTAL-NBR-EMSR-ADMSG-FILE.                       04190000
029485                                                                  04200000
029486****************************************                          04210000
029487* Z100 - PREFORMS TASK TERMINATION PROCESSING                     04220000
029488******************************************************************04230000
029489 Z100-END-PROC.                                                   04240000
029490     DISPLAY ' '.                                                 04250000
029491     DISPLAY '**********************'.                            04260000
029492     DISPLAY '   ARKUT084 CONTROLS  '.                            04270000
029493     DISPLAY '**********************'.                            04280000
029494     DISPLAY ' '.                                                 04290000
029495     DISPLAY 'RECORDS     READ   : '    PV-READ-COUNT.            04300000
029496     DISPLAY 'EMSR     REC WRITES: '    PV-CRDMAST-COUNT.         04310000
029498     DISPLAY 'BSE      REC WRITES: '    PV-BSE-COUNT.             04320000
029499     DISPLAY 'DTL      REC WRITES: '    PV-DTL-COUNT.             04330000
029500     DISPLAY 'INSFLG   REC WRITES: '    PV-INSFLG-COUNT.          04340000
029501     DISPLAY 'INSNM2   REC WRITES: '    PV-INSNM2-COUNT.          04350000
029502     DISPLAY 'INSPRD   REC WRITES: '    PV-INSPRD-COUNT.          04360000
029503     DISPLAY 'INSNM    REC WRITES: '    PV-INSNM-COUNT.           04370000
029504     DISPLAY 'INSNM2GR REC WRITES: '    PV-INSNM2GR-COUNT         04380000
029505     DISPLAY 'ADMSG    REC WRITES: '    PV-ADMSG-COUNT.           04390000
029508                                                                  04400009
029508     IF PV-READ-COUNT = 0                                         04410009
029509        DISPLAY ' '                                               04420009
029510        DISPLAY '*** NO CARD MASTER RECORDS TO REFORMAT ***'      04430009
029511     END-IF.                                                      04440009
029508                                                                  04450009
029508     IF PV-TRAILER-REC-CNT NOT EQUAL PV-READ-COUNT                04460010
029509        DISPLAY ' '                                               04470009
029510        DISPLAY '*** WARNING WARNING WARNING WARNING ***'         04480009
029510        DISPLAY '***************************************'         04490009
029510        DISPLAY '***** EMSR STMT MSTR TRAILER COUNT ****'         04500011
029510        DISPLAY '****** DOES NOT MATCH PROGRAM  ********'         04510009
029510        DISPLAY '*********  RECORD READ COUNT  *********'         04520009
029510        DISPLAY '**** WE MAY NOT HAVE RECEIVED *********'         04530009
029510        DISPLAY '******* ALL RECS FROM FDR !!! *********'         04540009
029510        DISPLAY '***************************************'         04550009
029509        DISPLAY ' '                                               04560012
029509        DISPLAY 'FD TRAILER COUNT = ' PV-TRAILER-REC-CNT          04570012
029509        DISPLAY ' ARKUT084  COUNT = ' PV-READ-COUNT               04580012
029509        DISPLAY ' '                                               04590012
029509        MOVE 0004 TO RETURN-CODE                                  04600012
029509        DISPLAY ' '                                               04610009
029511     END-IF.                                                      04620009
029512                                                                  04630009
029513     CLOSE EMSR-STMT-IN-FILE                                      04640000
029514           EMSR-STMT-OUT-FILE                                     04650000
029515           TOTAL-NBR-EMSR-BSE-FILE                                04660000
029516           TOTAL-NBR-EMSR-DTL-FILE                                04670000
029517           TOTAL-NBR-EMSR-INSFLG-FILE                             04680000
029518           TOTAL-NBR-EMSR-INSNM2-FILE                             04690000
029519           TOTAL-NBR-EMSR-INSPRD-FILE                             04700000
029520           TOTAL-NBR-EMSR-INSNM-FILE                              04710000
029521           TOTAL-NBR-EMSR-INSNM2GR-FILE                           04720000
029522           TOTAL-NBR-EMSR-ADMSG-FILE.                             04730000
029526                                                                  04740000
029534******************************************************************04750009
