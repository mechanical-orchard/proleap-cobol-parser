000100 IDENTIFICATION DIVISION.                                         00010023
000200 PROGRAM-ID.     DBKDM011.                                        00020050
000300 AUTHOR.         BARBARA NEHRLING.                                00030023
000400 INSTALLATION.   KOHLS.                                           00040023
000500 DATE-WRITTEN.   MAY 1996.                                        00050023
000600*                                                                 00060023
000700****************************************************************  00070052
000800***  DB2 EXPLAIN HISTORY                    ********************  00080023
000900***     E.K.R.8  TSO OPTION                 ********************  00090029
001000****************************************************************  00100023
001100***************  MODIFICATION HISTORY  *************************  00110027
001200****************************************************************  00120027
001300***  DATE     NAME          TYPE OF CHANGE                   ***  00130027
001400****************************************************************  00140027
001500*** 08/22/02  TOM PETERSON   CHANGED REPORT TO ALLOW FOR     ***  00150027
001600***                          FIVE DIGITS IN QUERYNO COLUMN.  ***  00160027
001700*** 03/05/03  TOM PETERSON   CORRECT REPORT HEADING FOR      ***  00170028
001800***                          PARALLELISM MODE COLUMN.        ***  00180028
001900*** 11/26/04  SID CHAN       ADD DSN_STATEMNT_TABLE FOR      ***  00190030
002000***                          SQL COST ESTIMATES.             ***  00200030
002100****************************************************************  00210027
002110***********************************************************       00211069
002120* 03/08  LARRY SCHLEICHER                                         00212070
002130*     ADDED SUPPORT FOR DB2 VERSION 8.  ALLOW THE LENGTH          00213070
002140*     OF TABLE NAMES TO INCREASE FROM 18 CHARACTERS TO 128.       00214070
002141***********************************************************       00214199
002142* 03/14  BETSY JEFFERY                                            00214299
002143*     INCREASED THE SIZE OF THE TEMPORARY FILE NAME TO            00214399
002144*     MULTI-LOGON ISPF REQUIREMENTS.                              00214499
002150***********************************************************       00215070
002200*                                                                 00220023
002300 ENVIRONMENT DIVISION.                                            00230023
002400 CONFIGURATION SECTION.                                           00240023
002500 SOURCE-COMPUTER.        IBM.                                     00250023
002600 OBJECT-COMPUTER.        IBM.                                     00260023
002700 INPUT-OUTPUT SECTION.                                            00270023
002800                                                                  00280023
002900 FILE-CONTROL.                                                    00290023
003000                                                                  00300023
003100     SELECT BROWSE-FILE ASSIGN TO EXPHDATA.                       00310054
003200                                                                  00320023
003300 DATA DIVISION.                                                   00330023
003400 FILE SECTION.                                                    00340023
003500 FD  BROWSE-FILE                                                  00350023
003600     RECORDING MODE IS F                                          00360023
003700     LABEL RECORDS ARE STANDARD                                   00370023
003800     RECORD CONTAINS 132 CHARACTERS                               00380054
003900     BLOCK CONTAINS 0 RECORDS                                     00390023
004000     DATA RECORD IS BROWSE-RECORD.                                00400023
004100 01  BROWSE-RECORD           PIC X(132).                          00410054
004200                                                                  00420023
004300*                                                                 00430023
004400     EJECT                                                        00440023
004500 WORKING-STORAGE SECTION.                                         00450023
004600*                                                                 00460023
004700 01  REPORT-TITLE1.                                               00470023
004800     05  FILLER            PIC X(52)   VALUE SPACES.              00480023
004900     05  FILLER            PIC X(29)                              00490054
005000         VALUE  'PRODUCTION DB2 EXPLAIN REPORT'.                  00500054
005100     05  FILLER            PIC X(51)   VALUE SPACES.              00510054
005200                                                                  00520023
005300 01  REPORT-TITLE2.                                               00530023
005400     05  FILLER            PIC X(02)   VALUE SPACES.              00540023
005500     05  FILLER            PIC X(10)   VALUE 'PROGRAM = '.        00550023
005600     05  TITLE-PROGRAM     PIC X(11)   VALUE SPACES.              00560023
005700     05  FILLER            PIC X(32)   VALUE SPACES.              00570090
005701     05  FILLER            PIC X(23)   VALUE                      00570188
005702         '* = CURRENT ACCESS PATH'.                               00570288
005703     05  FILLER            PIC X(54)   VALUE SPACES.              00570390
005704                                                                  00570488
005900 01  REPORT-TITLE3.                                               00590023
006000     05  FILLER            PIC X(01)   VALUE SPACES.              00600041
006100     05  FILLER            PIC X(10)   VALUE '  DATE'.            00610024
006200     05  FILLER            PIC X(01)   VALUE SPACES.              00620024
006300     05  FILLER            PIC X(05)   VALUE ' QRY'.              00630026
006400     05  FILLER            PIC X(01)   VALUE SPACE.               00640023
006500     05  FILLER            PIC X(02)   VALUE 'BK'.                00650031
006600     05  FILLER            PIC X(01)   VALUE SPACES.              00660024
006700     05  FILLER            PIC X(02)   VALUE 'PL'.                00670031
006800     05  FILLER            PIC X(01)   VALUE SPACES.              00680024
006900     05  FILLER            PIC X(03)   VALUE SPACES.              00690026
007000     05  FILLER            PIC X(01)   VALUE SPACES.              00700024
007100     05  FILLER            PIC X(18)   VALUE SPACES.              00710024
007200     05  FILLER            PIC X(01)   VALUE SPACES.              00720024
007300     05  FILLER            PIC X(04)   VALUE 'CORR'.              00730023
007400     05  FILLER            PIC X(01)   VALUE SPACES.              00740024
007500     05  FILLER            PIC X(03)   VALUE 'ACC'.               00750024
007600     05  FILLER            PIC X(01)   VALUE SPACES.              00760024
007700     05  FILLER            PIC X(03)   VALUE 'MTC'.               00770024
007800     05  FILLER            PIC X(01)   VALUE SPACES.              00780024
007900     05  FILLER            PIC X(02)   VALUE 'MX'.                00790023
008000     05  FILLER            PIC X(01)   VALUE SPACES.              00800024
008100     05  FILLER            PIC X(18)   VALUE SPACES.              00810024
008200     05  FILLER            PIC X(01)   VALUE SPACES.              00820024
008300     05  FILLER            PIC X(02)   VALUE 'IX'.                00830032
008400     05  FILLER            PIC X(01)   VALUE SPACES.              00840024
008500     05  FILLER            PIC X(04)   VALUE 'SRTN'.              00850031
008600     05  FILLER            PIC X(01)   VALUE SPACES.              00860024
008700     05  FILLER            PIC X(04)   VALUE 'SRTC'.              00870031
008800     05  FILLER            PIC X(01)   VALUE SPACES.              00880024
008900     05  FILLER            PIC X(03)   VALUE 'TS'.                00890024
009000     05  FILLER            PIC X(01)   VALUE SPACES.              00900024
009100     05  FILLER            PIC X(01)   VALUE 'P'.                 00910043
009200     05  FILLER            PIC X(01)   VALUE SPACES.              00920024
009300     05  FILLER            PIC X(02)   VALUE 'PA'.                00930043
009400     05  FILLER            PIC X(01)   VALUE SPACES.              00940024
009500     05  FILLER            PIC X(03)   VALUE 'MSJ'.               00950024
009600     05  FILLER            PIC X(01)   VALUE SPACES.              00960024
009700     05  FILLER            PIC X(02)   VALUE 'PG'.                00970042
009800     05  FILLER            PIC X(01)   VALUE SPACES.              00980037
009900     05  FILLER            PIC X(01)   VALUE 'C'.                 00990047
010000     05  FILLER            PIC X(01)   VALUE SPACES.              01000047
010100     05  FILLER            PIC X(09)   VALUE 'SQL COST'.          01010045
010200     05  FILLER            PIC X(01)   VALUE SPACES.              01020038
010300     05  FILLER            PIC X(09)   VALUE 'SQL COST'.          01030045
010400                                                                  01040023
010500 01  REPORT-TITLE4.                                               01050023
010600     05  FILLER            PIC X(01)   VALUE SPACES.              01060041
010700     05  FILLER            PIC X(10)   VALUE 'EXPLAINED'.         01070024
010800     05  FILLER            PIC X(01)   VALUE SPACES.              01080024
010900     05  FILLER            PIC X(05)   VALUE ' NBR'.              01090026
011000     05  FILLER            PIC X(01)   VALUE SPACE.               01100024
011100     05  FILLER            PIC X(02)   VALUE '#'.                 01110031
011200     05  FILLER            PIC X(01)   VALUE SPACES.              01120024
011300     05  FILLER            PIC X(02)   VALUE '#'.                 01130031
011400     05  FILLER            PIC X(01)   VALUE SPACES.              01140024
011500     05  FILLER            PIC X(03)   VALUE 'MTD'.               01150026
011600     05  FILLER            PIC X(01)   VALUE SPACES.              01160024
011700     05  FILLER            PIC X(18)   VALUE 'TABLE'.             01170024
011800     05  FILLER            PIC X(01)   VALUE SPACES.              01180024
011900     05  FILLER            PIC X(04)   VALUE 'NAME'.              01190024
012000     05  FILLER            PIC X(01)   VALUE SPACES.              01200024
012100     05  FILLER            PIC X(03)   VALUE 'TYP'.               01210024
012200     05  FILLER            PIC X(01)   VALUE SPACES.              01220024
012300     05  FILLER            PIC X(03)   VALUE 'COL'.               01230024
012400     05  FILLER            PIC X(01)   VALUE SPACES.              01240024
012500     05  FILLER            PIC X(02)   VALUE 'OP'.                01250024
012600     05  FILLER            PIC X(01)   VALUE SPACES.              01260024
012700     05  FILLER            PIC X(18)   VALUE 'INDEX'.             01270024
012800     05  FILLER            PIC X(01)   VALUE SPACES.              01280024
012900     05  FILLER            PIC X(02)   VALUE 'OL'.                01290031
013000     05  FILLER            PIC X(01)   VALUE SPACES.              01300024
013100     05  FILLER            PIC X(04)   VALUE 'UJOG'.              01310031
013200     05  FILLER            PIC X(01)   VALUE SPACES.              01320024
013300     05  FILLER            PIC X(04)   VALUE 'UJOG'.              01330031
013400     05  FILLER            PIC X(01)   VALUE SPACES.              01340024
013500     05  FILLER            PIC X(03)   VALUE 'LCK'.               01350024
013600     05  FILLER            PIC X(01)   VALUE SPACES.              01360024
013700     05  FILLER            PIC X(01)   VALUE 'F'.                 01370044
013800     05  FILLER            PIC X(01)   VALUE SPACES.              01380024
013900     05  FILLER            PIC X(02)   VALUE 'MO'.                01390043
014000     05  FILLER            PIC X(01)   VALUE SPACES.              01400024
014100     05  FILLER            PIC X(03)   VALUE 'COL'.               01410024
014200     05  FILLER            PIC X(01)   VALUE SPACES.              01420024
014300     05  FILLER            PIC X(02)   VALUE 'RN'.                01430042
014400     05  FILLER            PIC X(01)   VALUE SPACES.              01440047
014500     05  FILLER            PIC X(01)   VALUE 'C'.                 01450047
014600     05  FILLER            PIC X(01)   VALUE SPACES.              01460037
014700     05  FILLER            PIC X(09)   VALUE 'MIL SECS '.         01470049
014800     05  FILLER            PIC X(01)   VALUE SPACES.              01480037
014900     05  FILLER            PIC X(09)   VALUE 'SRV UNITS'.         01490049
015000                                                                  01500023
015100 01  REPORT-TITLE5.                                               01510023
015200     05  FILLER            PIC X(01)   VALUE SPACES.              01520041
015300     05  FILLER            PIC X(10)   VALUE '----------'.        01530024
015400     05  FILLER            PIC X(01)   VALUE SPACES.              01540024
015500     05  FILLER            PIC X(05)   VALUE '-----'.             01550026
015600     05  FILLER            PIC X(01)   VALUE SPACE.               01560024
015700     05  FILLER            PIC X(02)   VALUE '--'.                01570031
015800     05  FILLER            PIC X(01)   VALUE SPACES.              01580024
015900     05  FILLER            PIC X(02)   VALUE '--'.                01590031
016000     05  FILLER            PIC X(01)   VALUE SPACES.              01600024
016100     05  FILLER            PIC X(03)   VALUE '---'.               01610026
016200     05  FILLER            PIC X(01)   VALUE SPACES.              01620024
016300     05  FILLER            PIC X(18)   VALUE ALL '-'.             01630024
016400     05  FILLER            PIC X(01)   VALUE SPACES.              01640024
016500     05  FILLER            PIC X(04)   VALUE '----'.              01650024
016600     05  FILLER            PIC X(01)   VALUE SPACES.              01660024
016700     05  FILLER            PIC X(03)   VALUE '---'.               01670024
016800     05  FILLER            PIC X(01)   VALUE SPACES.              01680024
016900     05  FILLER            PIC X(03)   VALUE '---'.               01690024
017000     05  FILLER            PIC X(01)   VALUE SPACES.              01700024
017100     05  FILLER            PIC X(02)   VALUE '--'.                01710024
017200     05  FILLER            PIC X(01)   VALUE SPACES.              01720024
017300     05  FILLER            PIC X(18)   VALUE ALL '-'.             01730024
017400     05  FILLER            PIC X(01)   VALUE SPACES.              01740024
017500     05  FILLER            PIC X(02)   VALUE '--'.                01750031
017600     05  FILLER            PIC X(01)   VALUE SPACES.              01760024
017700     05  FILLER            PIC X(04)   VALUE '----'.              01770031
017800     05  FILLER            PIC X(01)   VALUE SPACES.              01780024
017900     05  FILLER            PIC X(04)   VALUE '----'.              01790031
018000     05  FILLER            PIC X(01)   VALUE SPACES.              01800024
018100     05  FILLER            PIC X(03)   VALUE '---'.               01810024
018200     05  FILLER            PIC X(01)   VALUE SPACES.              01820024
018300     05  FILLER            PIC X(01)   VALUE '-'.                 01830045
018400     05  FILLER            PIC X(01)   VALUE SPACES.              01840024
018500     05  FILLER            PIC X(02)   VALUE '--'.                01850045
018600     05  FILLER            PIC X(01)   VALUE SPACES.              01860024
018700     05  FILLER            PIC X(03)   VALUE '---'.               01870024
018800     05  FILLER            PIC X(01)   VALUE SPACES.              01880024
018900     05  FILLER            PIC X(02)   VALUE '--'.                01890045
019000     05  FILLER            PIC X(01)   VALUE SPACES.              01900047
019100     05  FILLER            PIC X(01)   VALUE '-'.                 01910047
019200     05  FILLER            PIC X(01)   VALUE SPACES.              01920037
019300     05  FILLER            PIC X(09)   VALUE ALL '-'.             01930045
019400     05  FILLER            PIC X(01)   VALUE SPACES.              01940037
019500     05  FILLER            PIC X(09)   VALUE ALL '-'.             01950045
019600                                                                  01960023
019700 01  REPORT-DTL.                                                  01970025
019800     05  RPT-CURRENT-IND   PIC X(01)   VALUE SPACES.              01980075
019900     05  RPT-TIMESTAMP     PIC X(10)   VALUE SPACES.              01990024
020000     05  FILLER            PIC X(01)   VALUE SPACES.              02000024
020100     05  RPT-QNO           PIC ZZZZ9   VALUE ZERO.                02010026
020200     05  FILLER            PIC X(01)   VALUE SPACES.              02020023
020300     05  RPT-BLK           PIC Z9      VALUE ZERO.                02030025
020400     05  FILLER            PIC X(01)   VALUE SPACES.              02040032
020500     05  RPT-PLN           PIC Z9      VALUE ZERO.                02050025
020600     05  FILLER            PIC X(01)   VALUE SPACES.              02060032
020700     05  RPT-M             PIC Z9      VALUE ZERO.                02070026
020800     05  FILLER            PIC X(02)   VALUE SPACES.              02080025
020900     05  RPT-TABLE         PIC X(18)   VALUE SPACES.              02090024
021000     05  FILLER            PIC X(01)   VALUE SPACES.              02100033
021100     05  RPT-CORR-NAME     PIC X(04)   VALUE SPACES.              02110023
021200     05  FILLER            PIC X(02)   VALUE SPACES.              02120025
021300     05  RPT-A             PIC X(02)   VALUE SPACE.               02130025
021400     05  FILLER            PIC X(01)   VALUE SPACES.              02140024
021500     05  RPT-MC            PIC Z9      VALUE ZEROS.               02150025
021600     05  FILLER            PIC X(02)   VALUE SPACES.              02160025
021700     05  RPT-MX-OP         PIC Z9      VALUE ZEROS.               02170023
021800     05  FILLER            PIC X(01)   VALUE SPACES.              02180024
021900     05  RPT-INDEX         PIC X(18)   VALUE SPACES.              02190024
022000     05  FILLER            PIC X(01)   VALUE SPACES.              02200033
022100     05  RPT-IO            PIC X(02)   VALUE SPACES.              02210025
022200     05  FILLER            PIC X(01)   VALUE SPACES.              02220024
022300     05  RPT-SORTN-U       PIC X(01)   VALUE SPACES.              02230023
022400     05  RPT-SORTN-J       PIC X(01)   VALUE SPACES.              02240023
022500     05  RPT-SORTN-O       PIC X(01)   VALUE SPACES.              02250023
022600     05  RPT-SORTN-G       PIC X(01)   VALUE SPACES.              02260023
022700     05  FILLER            PIC X(01)   VALUE SPACES.              02270024
022800     05  RPT-SORTC-U       PIC X(01)   VALUE SPACES.              02280023
022900     05  RPT-SORTC-J       PIC X(01)   VALUE SPACES.              02290023
023000     05  RPT-SORTC-O       PIC X(01)   VALUE SPACES.              02300023
023100     05  RPT-SORTC-G       PIC X(01)   VALUE SPACES.              02310023
023200     05  FILLER            PIC X(01)   VALUE SPACES.              02320024
023300     05  RPT-LCK           PIC X(03)   VALUE SPACES.              02330036
023400     05  FILLER            PIC X(01)   VALUE SPACES.              02340042
023500     05  RPT-PF            PIC X(01)   VALUE SPACES.              02350043
023600     05  FILLER            PIC X(01)   VALUE SPACES.              02360047
023700     05  RPT-PA-MODE       PIC X(02)   VALUE SPACES.              02370043
023800     05  FILLER            PIC X(01)   VALUE SPACES.              02380024
023900     05  RPT-JN-CLS        PIC X(03)   VALUE SPACES.              02390023
024000     05  FILLER            PIC X(01)   VALUE SPACES.              02400024
024100     05  RPT-PAGE-RNGE     PIC X(02)   VALUE SPACES.              02410042
024200     05  FILLER            PIC X(01)   VALUE SPACES.              02420042
024300     05  RPT-COST-CATG     PIC X(01)   VALUE SPACES.              02430048
024400     05  FILLER            PIC X(01)   VALUE SPACES.              02440048
024500     05  RPT-COST-MS       PIC Z(09)   VALUE ZEROS.               02450041
024600     05  FILLER            PIC X(01)   VALUE SPACES.              02460041
024700     05  RPT-COST-SU       PIC Z(09)   VALUE ZEROS.               02470041
024800                                                                  02480023
024900 01  REPORT-DTL2.                                                 02490066
025000     05  FILLER            PIC X(28)   VALUE SPACES.              02500066
025100     05  RPT-TABLE2        PIC X(64)   VALUE SPACES.              02510070
025200                                                                  02520066
025210 01  REPORT-DTL3.                                                 02521070
025220     05  FILLER            PIC X(28)   VALUE SPACES.              02522070
025230     05  RPT-TABLE3        PIC X(64)   VALUE SPACES.              02523070
025240                                                                  02524070
025300 01  NO-MATCH-INFO.                                               02530023
025400     05  FILLER            PIC X(02)   VALUE  SPACES.             02540023
025500     05  FILLER            PIC X(78)                              02550023
025600         VALUE  'PROGRAM NOT FOUND ON PLAN_TABLE'.                02560023
025700                                                                  02570023
025800 01  END-OF-REPORT.                                               02580023
025900     05  FILLER            PIC X(56)   VALUE  SPACES.             02590023
026000     05  FILLER            PIC X(21)                              02600023
026100         VALUE  '*** END OF REPORT ***'.                          02610023
026200     05  FILLER            PIC X(55)   VALUE  SPACES.             02620054
026300                                                                  02630023
026400 01  ISP-FUNCTIONS.                                               02640023
026500     05  ISP-DISPLAY     PIC X(8) VALUE 'DISPLAY'.                02650023
026600     05  ISP-ADDPOP      PIC X(8) VALUE 'ADDPOP  '.               02660023
026700     05  ISP-REMPOP      PIC X(8) VALUE 'REMPOP  '.               02670023
026800     05  ISP-VDEFINE     PIC X(8) VALUE 'VDEFINE'.                02680023
026900     05  ISP-VDELETE     PIC X(8) VALUE 'VDELETE'.                02690023
027000     05  ISP-VGET        PIC X(8) VALUE 'VGET'.                   02700023
027100     05  ISP-VPUT        PIC X(8) VALUE 'VPUT'.                   02710023
027200     05  ISP-VRESET      PIC X(8) VALUE 'VRESET'.                 02720023
027300     05  ISP-VCOPY       PIC X(8) VALUE 'VCOPY'.                  02730023
027400     05  ISP-VREPLACE    PIC X(8) VALUE 'VREPLACE'.               02740023
027500     05  ISP-TBOPEN      PIC X(8) VALUE 'TBOPEN'.                 02750023
027600     05  ISP-TBCREATE    PIC X(8) VALUE 'TBCREATE'.               02760023
027700     05  ISP-TBCLOSE     PIC X(8) VALUE 'TBCLOSE'.                02770023
027800     05  ISP-TBEND       PIC X(8) VALUE 'TBEND  '.                02780023
027900     05  ISP-TBDISPL     PIC X(8) VALUE 'TBDISPL'.                02790023
028000     05  ISP-TBSORT      PIC X(8) VALUE 'TBSORT'.                 02800023
028100     05  ISP-TBTOP       PIC X(8) VALUE 'TBTOP'.                  02810023
028200     05  ISP-TBBOTTOM    PIC X(8) VALUE 'TBBOTTOM'.               02820023
028300     05  ISP-TBSKIP      PIC X(8) VALUE 'TBSKIP'.                 02830023
028400     05  ISP-TBADD       PIC X(8) VALUE 'TBADD '.                 02840023
028500     05  ISP-TBPUT       PIC X(8) VALUE 'TBPUT '.                 02850023
028600     05  ISP-TBMOD       PIC X(8) VALUE 'TBMOD '.                 02860023
028700     05  ISP-TBDELETE    PIC X(8) VALUE 'TBDELETE'.               02870023
028800     05  ISP-TBEXIST     PIC X(8) VALUE 'TBEXIST '.               02880023
028900     05  ISP-TBSCAN      PIC X(8) VALUE 'TBSCAN'.                 02890023
029000     05  ISP-TBPAD       PIC 9(8) COMP VALUE 0.                   02900023
029100     05  ISP-NEWCOPY     PIC X(8) VALUE 'NEWCOPY'.                02910023
029200     05  ISP-FTOPEN      PIC X(8) VALUE 'FTOPEN'.                 02920023
029300     05  ISP-FTINCL      PIC X(8) VALUE 'FTINCL'.                 02930023
029400     05  ISP-FTCLOSE     PIC X(8) VALUE 'FTCLOSE'.                02940023
029500     05  ISP-SELECT      PIC X(8) VALUE 'SELECT'.                 02950023
029600     05  ISP-BROWSE      PIC X(8) VALUE 'BROWSE'.                 02960023
029700     05  ISP-SETMSG      PIC X(8) VALUE 'SETMSG'.                 02970023
029800     05  ISP-CONTROL     PIC X(8) VALUE 'CONTROL'.                02980023
029900     05  ISP-NONDISPL    PIC X(8) VALUE 'NONDISPL'.               02990023
030000     05  ISP-SPLIT       PIC X(8) VALUE 'SPLIT'.                  03000023
030100     05  ISP-DISABLE     PIC X(8) VALUE 'DISABLE'.                03010023
030200     05  ISP-ENABLE      PIC X(8) VALUE 'ENABLE'.                 03020023
030300     05  ISP-NO          PIC X(8) VALUE 'NO'.                     03030023
030400     05  ISP-YES         PIC X(8) VALUE 'YES'.                    03040023
030500*                                                                 03050023
030600 01  ISP-MISC-DEFS.                                               03060023
030700     05  ISP-FORMAT      PIC X(8) VALUE 'CHAR'.                   03070023
030800     05  ISP-MOVE        PIC X(8) VALUE 'MOVE'.                   03080023
030900     05  ISP-WRITE       PIC X(8) VALUE 'WRITE'.                  03090023
031000     05  ISP-NOWRITE     PIC X(8) VALUE 'NOWRITE'.                03100023
031100     05  ISP-REPLACE     PIC X(8) VALUE 'REPLACE'.                03110023
031200     05  ISP-ORDERED     PIC X(8) VALUE 'ORDERED'.                03120023
031300     05  ISP-SHARED      PIC X(8) VALUE 'SHARED'.                 03130023
031400     05  ISP-PROFILE     PIC X(8) VALUE 'PROFILE'.                03140023
031500     05  ISP-ASIS        PIC X(8) VALUE 'ASIS'.                   03150023
031600     05  ISP-NOREAD      PIC X(8) VALUE 'NOREAD'.                 03160023
031700     05  ISP-NEXT        PIC X(8) VALUE 'NEXT'.                   03170023
031800     05  ISP-TEMP        PIC X(8) VALUE 'TEMP'.                   03180023
031900     05  ISP-PANEL       PIC X(8) VALUE  SPACES.                  03190023
032000     05  ISP-DUMMY       PIC X(8) VALUE  SPACES.                  03200023
032100     05  ISP-MSG         PIC X(8) VALUE  'CMN000  '.              03210023
032200     05  ISP-CSR         PIC X(8) VALUE  SPACES.                  03220023
032300     05  ISP-FIELD       PIC X(8) VALUE  SPACES.                  03230023
032400     05  ISP-SKEL        PIC X(8) VALUE  SPACES.                  03240023
032500     05  ISP-ERRORS      PIC X(8) VALUE 'ERRORS'.                 03250023
032600     05  ISP-RETURN      PIC X(8) VALUE 'RETURN'.                 03260023
032700     05  ISP-CANCEL      PIC X(8) VALUE 'CANCEL'.                 03270023
032800     05  ISP-SAVE        PIC X(8) VALUE 'SAVE'.                   03280023
032900     05  ISP-RESTORE     PIC X(8) VALUE 'RESTORE'.                03290023
033000     05  TBL-LIST-GT     PIC X(4) VALUE '(GT)'.                   03300023
033100*                                                                 03310023
033200***  DEFINE DATA TYPE PARAMETER FOR VARIABLE DEFINE SERVICE CALL. 03320023
033300*                                                                 03330023
033400 01  CHAR                PIC X(08)     VALUE 'CHAR    '.          03340023
033500                                                                  03350054
033600*                                                                 03360054
033700*  PARAMETER LIST FOR THE DYNAMIC ALLOCATION ROUTINE              03370054
033800*                                                                 03380054
033900     COPY DPWS023.                                                03390054
034000                                                                  03400054
034100*                                                                 03410054
034200*  PARAMETER LIST FOR THE ISPF PRINT PANEL ROUTINE                03420054
034300*                                                                 03430054
034400     COPY DPWS300.                                                03440054
034500                                                                  03450054
034600 01  VAR-SMSG                    PIC X(24)   VALUE SPACES.        03460060
034700 01  FILLER                      REDEFINES VAR-SMSG.              03470060
034800     05  VAR-SMSG-FILLER         PIC X(20).                       03480060
034900     05  VAR-SMSG-SQLCODE        PIC 9(4).                        03490060
035000 01  VAR-LMSG                    PIC X(72)   VALUE SPACES.        03500060
035100 01  PV-PROGRAM-VARIABLES.                                        03510054
035200     05  VAR-ZTEMPF              PIC X(44)   VALUE SPACES.        03520054
035300     05  VAR-DSNAME              PIC X(46)   VALUE SPACES.        03530054
035400     05  VAR-VOLUME              PIC X(06)   VALUE SPACES.        03540054
035500     05  VAR-PASSWORD            PIC X(08)   VALUE SPACES.        03550054
035600     05  PV-DYNALC-ROUTINE-ERROR-MSG.                             03560054
035700         10  FILLER              PIC X(13)    VALUE               03570054
035800             'DYNALC ERROR '.                                     03580054
035900         10  PV-DR-RETURN-CODE   PIC 9999     VALUE ZEROS.        03590054
036000         10  FILLER              PIC X(2)     VALUE '; '.         03600054
036100         10  PV-DR-DDNAME        PIC X(8)     VALUE SPACES.       03610054
036200         10  FILLER              PIC X(5)     VALUE ' DD; '.      03620054
036300         10  PV-DR-ERROR-DESC    PIC X(41)    VALUE SPACES.       03630054
036400     05  PV-BROWSE-DSNAME        PIC X(44)   VALUE SPACES.        03640058
036500     05  PV-COUNTR               PIC S9(4)   COMP.                03650054
036600     05  PV-FIELD-LENGTH         PIC 9(8)     VALUE ZEROS         03660062
036700                                              COMP SYNC.          03670062
036900     05  PV-PREV-QUERYNO         PIC S9(9)   COMP VALUE +0.       03690054
037000     05  PV-DATE-CNT             PIC S9(4)   COMP VALUE +0.       03700054
037010                                                                  03701086
037011 01  PV-PREV-TIMESTAMP.                                           03701186
037012     05  FILLER                  PIC X(26)   VALUE SPACES.        03701299
037016 01  FILLER REDEFINES PV-PREV-TIMESTAMP.                          03701686
037017     05  PV-PREV-DATE-H-M        PIC X(20).                       03701799
037020     05  FILLER                  PIC X(06).                       03702099
037100                                                                  03710023
037200 01  WS-TIMESTAMP.                                                03720023
037300     05  WS-YYYY                 PIC X(04)   VALUE SPACES.        03730023
037310     05  FILLER                  PIC X(01).                       03731099
037400     05  WS-MM                   PIC X(02)   VALUE SPACES.        03740023
037410     05  FILLER                  PIC X(01).                       03741099
037500     05  WS-DD                   PIC X(02)   VALUE SPACES.        03750023
037600     05  FILLER                  PIC X(16)   VALUE SPACES.        03760099
037700 01  FILLER REDEFINES WS-TIMESTAMP.                               03770024
037810     05  WS-DATE-H-M             PIC X(20).                       03781099
037910     05  FILLER                  PIC X(06).                       03791099
038000                                                                  03800024
038100 01  WS-EXPLAIN-DATE.                                             03810024
038200     05  WS-ED-YYYY              PIC X(04)   VALUE SPACES.        03820024
038300     05  FILLER                  PIC X(01)   VALUE '-'.           03830024
038400     05  WS-ED-MM                PIC X(02)   VALUE SPACES.        03840024
038500     05  FILLER                  PIC X(01)   VALUE '-'.           03850024
038600     05  WS-ED-DD                PIC X(02)   VALUE SPACES.        03860024
038700                                                                  03870023
038800 01  WS-NULL-INDICATORS.                                          03880023
038900     05  WS-NULL-CORRELATION-NAME PIC S9(4)  VALUE +0 COMP.       03890023
039000     05  WS-NULL-PARALLELISM-MODE PIC S9(4)  VALUE +0 COMP.       03900023
039100     05  WS-NULL-MERGE-JOIN-COLS PIC S9(4)   VALUE +0 COMP.       03910023
039200                                                                  03920023
039300 01  WS-MISC.                                                     03930039
039400     05  WS-COST-MS               PIC S9(9)  VALUE +0 COMP.       03940041
039500     05  WS-COST-SU               PIC S9(9)  VALUE +0 COMP.       03950041
039600     05  WS-COST-CATG             PIC X(01)  VALUE SPACES.        03960048
039700*                                                                 03970023
039710 01  WS-PROGNAME                  PIC X(128) VALUE SPACES.        03971073
039800***  DEFINE STORAGE FOR DIALOG VARIABLES.                         03980023
039900*                                                                 03990023
040000 01  VAR-CMNEKPGM        PIC X(08)     VALUE SPACES.              04000023
040100 01  FREE-SPACE          PIC X(80)     VALUE SPACES.              04010023
040200 01  ABEND-CODE                    PIC S9(4) VALUE ZERO           04020023
040300                                             COMP.                04030023
040400     88  ABEND-4013                          VALUE 4013.          04040023
040500                                                                  04050023
040600 01  PS-PRINT-SWITCH               PIC X(1)  VALUE 'N'.           04060023
040700     88  PS-EOF-PRINT                        VALUE 'Y'.           04070023
040800     88  PS-NOT-EOF-PRINT                    VALUE 'N'.           04080023
040900 01  PS-TABLE-VALIDITY             PIC X(1)  VALUE 'N'.           04090023
041000     88  PS-TABLE-IS-VALID                   VALUE 'Y'.           04100023
041100     88  PS-TABLE-IS-NOT-VALID               VALUE 'N'.           04110023
041200 01  PS-ALLOCATE-SW                PIC X(1)  VALUE 'N'.           04120023
041300     88  PS-IS-ALLOCATED                     VALUE 'Y'.           04130023
041400     88  PS-IS-NOT-ALLOCATED                 VALUE 'N'.           04140023
041500 01  PS-DB2-ERROR-INDICATOR        PIC X(1)  VALUE 'N'.           04150023
041600     88  PS-DB2-ERROR                        VALUE 'Y'.           04160023
041700     88  PS-NO-DB2-ERROR                     VALUE 'N'.           04170023
041800 01  PS-USER-INPUT                 PIC X(1)  VALUE 'N'.           04180023
041900     88  PS-USER-INPUT-VALID                 VALUE 'Y'.           04190023
042000     88  PS-USER-INPUT-NOT-VALID             VALUE 'N'.           04200023
042100 01  PS-KEY-COLUMN-SELECT          PIC X(1)  VALUE 'N'.           04210023
042200     88  PS-KEY-COLUMN-SELECTED              VALUE 'Y'.           04220023
042300     88  PS-KEY-COLUMN-NOT-SELECTED          VALUE 'N'.           04230023
042400                                                                  04240023
042500**                                                                04250023
042600 01  PROGRAM-CONSTANTS.                                           04260023
042700     05  PC-CURRENT-PROGRAM-NAME   PIC X(08)  VALUE 'DBKDM011'.   04270053
042800     05  PC-BROWSE-DDNAME          PIC X(08)  VALUE 'EXPHDATA'.   04280058
042900     05  PC-BROWSE-DSNAME-SUFFIX   PIC X(05)  VALUE '.EXPH'.      04290058
043000     05  PC-MAX-RETRIES            PIC S9(3)  VALUE +3            04300023
043100                                              COMP-3.             04310023
043200     05  PC-COMMIT-MAX             PIC S9(3)  VALUE +49           04320023
043300                                              COMP-3.             04330023
043400*                                                                 04340023
043500 01  COMMON-NAMELIST.                                             04350023
043600     05  NAM-ZTEMPF      PIC X(08)     VALUE 'ZTEMPF'.            04360023
043700     05  NAM-SMSG        PIC X(08)     VALUE 'SMSG'.              04370023
043800     05  NAM-LMSG        PIC X(08)     VALUE 'LMSG'.              04380023
043900*                                                                 04390023
044000***  DEFINE DIALOG VARIABLE NAMES FOR DIALOG SERVICE CALLS.       04400023
044100*                                                                 04410023
044200 01  NAM-CMNEKPGM        PIC X(08)     VALUE 'CMNEKPGM'.          04420023
044300*                                                                 04430023
044400***                                                               04440023
044500************************************************************      04450023
044600*    DSN_STATEMNT_TABLE DCLGEN                             *      04460059
044700************************************************************      04470023
044800     EXEC SQL                                                     04480023
044900         INCLUDE STATEMNT                                         04490059
045000     END-EXEC.                                                    04500023
045100*                                                                 04510023
045200***                                                               04520059
045300************************************************************      04530059
045400*    SYSIBM.SYSTABLESPACE DCLGEN                           *      04540059
045500************************************************************      04550059
045600     EXEC SQL                                                     04560059
045700         INCLUDE PLANTBL                                          04570059
045800     END-EXEC.                                                    04580059
045900*                                                                 04590059
045910************************************************************      04591075
045920*    SYSIBM.SYSPACKAGE DCLGEN                              *      04592075
045930************************************************************      04593075
045940     EXEC SQL                                                     04594075
045950         INCLUDE SYSPKG                                           04595075
045960     END-EXEC.                                                    04596075
045970*                                                                 04597075
046000************************************************************      04600023
046100*    DECLARE PLAN_TABLE AND DSN_STATEMNT_TABLE CURSOR      *      04610040
046200************************************************************      04620023
046300*                                                                 04630023
046400     EXEC SQL                                                     04640023
046500      DECLARE PLAN_TABLE_CSR CURSOR FOR                           04650023
046600          SELECT P.QUERYNO                                        04660038
046700               , P.QBLOCKNO                                       04670038
046800               , P.PLANNO                                         04680038
046900               , P.METHOD                                         04690038
047000               , P.TNAME                                          04700038
047100               , P.TABNO                                          04710038
047200               , P.CORRELATION_NAME                               04720038
047300               , P.ACCESSTYPE                                     04730038
047400               , P.MATCHCOLS                                      04740038
047500               , P.MIXOPSEQ                                       04750038
047600               , P.ACCESSNAME                                     04760038
047700               , P.INDEXONLY                                      04770038
047800               , P.SORTN_UNIQ                                     04780038
047900               , P.SORTN_JOIN                                     04790038
048000               , P.SORTN_ORDERBY                                  04800038
048100               , P.SORTN_GROUPBY                                  04810038
048200               , P.SORTC_UNIQ                                     04820038
048300               , P.SORTC_JOIN                                     04830038
048400               , P.SORTC_ORDERBY                                  04840038
048500               , P.SORTC_GROUPBY                                  04850038
048600               , P.TSLOCKMODE                                     04860038
048700               , P.PREFETCH                                       04870038
048800               , P.COLUMN_FN_EVAL                                 04880038
048900               , P.PARALLELISM_MODE                               04890038
049000               , P.MERGE_JOIN_COLS                                04900038
049100               , P.PAGE_RANGE                                     04910038
049200               , P.TIMESTAMP                                      04920038
049300               , S.PROCMS                                         04930040
049400               , S.PROCSU                                         04940040
049500               , S.COST_CATEGORY                                  04950048
049501               , P.BIND_TIME                                      04950184
049510               , K.BINDTIME                                       04951075
049600          FROM PLAN_TABLE  P                                      04960038
049700              ,DSN_STATEMNT_TABLE  S                              04970040
049710              ,SYSIBM.SYSPACKAGE  K                               04971077
049800          WHERE P.PROGNAME = :WS-PROGNAME                         04980074
049810            AND K.NAME     = :WS-PROGNAME                         04981078
049900            AND P.COLLID  = K.COLLID                              04990085
049910            AND P.QUERYNO = S.QUERYNO                             04991085
050000            AND P.APPLNAME = S.APPLNAME                           05000040
050100            AND P.PROGNAME =  S.PROGNAME                          05010040
050200            AND P.BIND_TIME = S.EXPLAIN_TIME                      05020040
050300          ORDER BY P.BIND_TIME DESC                               05030038
050400                 , P.QUERYNO                                      05040038
050500                 , P.QBLOCKNO                                     05050038
050600                 , P.PLANNO                                       05060038
050700                 , P.MIXOPSEQ                                     05070038
050710           WITH UR                                                05071088
050800     END-EXEC.                                                    05080023
050900                                                                  05090051
051000************************************************************      05100023
051100*    SQL COMMUNICATIONS AREA DCLGEN                        *      05110023
051200************************************************************      05120023
051300*                                                                 05130023
051400     EXEC SQL                                                     05140023
051500         INCLUDE SQLCA                                            05150023
051600     END-EXEC.                                                    05160023
051700*                                                                 05170023
051800*                                                                 05180023
051900 PROCEDURE DIVISION.                                              05190023
052000                                                                  05200023
052100************************************************************      05210023
052200*    VDEFINES FOR PANEL                                    *      05220023
052300************************************************************      05230023
052400     MOVE LENGTH OF VAR-ZTEMPF TO PV-FIELD-LENGTH.                05240063
052500     CALL 'ISPLINK' USING ISP-VDEFINE NAM-ZTEMPF VAR-ZTEMPF       05250063
052600                          ISP-FORMAT PV-FIELD-LENGTH.             05260063
052700     MOVE LENGTH OF VAR-SMSG TO PV-FIELD-LENGTH.                  05270063
052800     CALL 'ISPLINK' USING ISP-VDEFINE NAM-SMSG VAR-SMSG           05280063
052900                          ISP-FORMAT PV-FIELD-LENGTH.             05290063
053000     MOVE LENGTH OF VAR-LMSG TO PV-FIELD-LENGTH.                  05300063
053100     CALL 'ISPLINK' USING ISP-VDEFINE NAM-LMSG VAR-LMSG           05310063
053200                          ISP-FORMAT PV-FIELD-LENGTH.             05320063
053300     MOVE LENGTH OF VAR-CMNEKPGM TO PV-FIELD-LENGTH.              05330063
053400     CALL 'ISPLINK' USING ISP-VDEFINE                             05340063
053500         NAM-CMNEKPGM  VAR-CMNEKPGM  CHAR  PV-FIELD-LENGTH.       05350063
053600                                                                  05360023
053700************************************************************      05370023
053800*    VGETS FROM PROFILES                                   *      05380023
053900************************************************************      05390023
054000                                                                  05400023
054100     CALL 'ISPLINK' USING ISP-VGET NAM-ZTEMPF ISP-SHARED.         05410023
054200     MOVE SPACES TO ISP-MSG.                                      05420023
054300                                                                  05430054
054400     INSPECT VAR-ZTEMPF TALLYING PV-COUNTR FOR CHARACTERS         05440054
054500                 BEFORE INITIAL '.CNTL'.                          05450054
054600     MOVE VAR-ZTEMPF (1:PV-COUNTR)  TO PV-BROWSE-DSNAME.          05460058
054700     ADD 1 TO PV-COUNTR.                                          05470054
054800     MOVE PC-BROWSE-DSNAME-SUFFIX TO                              05480057
054900               PV-BROWSE-DSNAME (PV-COUNTR:5).                    05490058
055000                                                                  05500023
055100     PERFORM 1700-DISPLAY-PANEL THRU 1700-EXIT UNTIL              05510023
055200          RETURN-CODE NOT = 0.                                    05520023
055300                                                                  05530023
055400     IF PS-IS-ALLOCATED                                           05540054
055500         PERFORM 9100-DELETE-FILE                                 05550054
055600     END-IF.                                                      05560054
055700                                                                  05570023
055800     GOBACK.                                                      05580023
055900                                                                  05590023
056000************************************************************      05600023
056100*    DISPLAY THE PANEL                                     *      05610023
056200************************************************************      05620023
056300*                                                                 05630023
056400 1700-DISPLAY-PANEL.                                              05640023
056500                                                                  05650023
056600     MOVE 'CMNEKPGM' TO ISP-CSR.                                  05660023
056700     MOVE 'CMNEKRB'  TO ISP-PANEL.                                05670023
056800     CALL 'ISPLINK' USING ISP-DISPLAY,                            05680023
056900                          ISP-PANEL,                              05690023
057000                          ISP-MSG,                                05700023
057100                          ISP-CSR.                                05710023
057200                                                                  05720023
057300     MOVE SPACES TO ISP-MSG.                                      05730023
057400     MOVE SPACES TO VAR-SMSG.                                     05740023
057500     MOVE SPACES TO VAR-LMSG.                                     05750023
057600                                                                  05760023
057700     IF RETURN-CODE NOT = 0                                       05770023
057800         GO TO 1700-EXIT.                                         05780023
057900                                                                  05790023
058000     PERFORM 2100-EDIT-INPUT THRU 2100-EXIT.                      05800023
058100     IF PS-USER-INPUT-NOT-VALID                                   05810023
058200         GO TO 1700-EXIT.                                         05820023
058300                                                                  05830023
058400     IF PS-IS-NOT-ALLOCATED                                       05840054
058500         PERFORM 3000-ALLOCATE-TEMP-FILE                          05850054
058600     END-IF.                                                      05860054
058700                                                                  05870023
058800     IF PS-IS-ALLOCATED                                           05880023
058900         OPEN OUTPUT BROWSE-FILE                                  05890023
059000         WRITE BROWSE-RECORD FROM REPORT-TITLE1                   05900023
059100         MOVE SPACES TO BROWSE-RECORD                             05910023
059200         WRITE BROWSE-RECORD                                      05920023
059300         MOVE VAR-CMNEKPGM TO TITLE-PROGRAM                       05930023
059400         WRITE BROWSE-RECORD FROM REPORT-TITLE2                   05940023
059500         MOVE SPACES TO BROWSE-RECORD                             05950088
059600         WRITE BROWSE-RECORD                                      05960088
059700         WRITE BROWSE-RECORD FROM REPORT-TITLE3                   05970023
059800         WRITE BROWSE-RECORD FROM REPORT-TITLE4                   05980023
059900         WRITE BROWSE-RECORD FROM REPORT-TITLE5                   05990023
060000         PERFORM 4000-DB2-TABLE-FUNCTIONS                         06000023
060100             THRU 4000-EXIT                                       06010023
060200         MOVE SPACES TO BROWSE-RECORD                             06020023
060300         WRITE BROWSE-RECORD                                      06030023
060400         WRITE BROWSE-RECORD FROM END-OF-REPORT                   06040023
060500         CLOSE BROWSE-FILE                                        06050054
060600     END-IF.                                                      06060054
060700                                                                  06070054
060800     IF ((PS-IS-ALLOCATED)                                        06080054
060900             AND (PS-NO-DB2-ERROR))                               06090054
061000         PERFORM 8000-BROWSE-FILE                                 06100054
061100     END-IF.                                                      06110054
061200                                                                  06120023
061300 1700-EXIT.                                                       06130023
061400     EXIT.                                                        06140023
061500     EJECT                                                        06150023
061600************************************************************      06160023
061700* SET SWITCHES TO INDICATE WHAT OPTION HAS BEEN SPECIFIED  *      06170023
061800* BY THE USER                                              *      06180023
061900************************************************************      06190023
062000 2100-EDIT-INPUT.                                                 06200023
062100                                                                  06210023
062200     SET PS-NOT-EOF-PRINT TO TRUE.                                06220023
062300     SET PS-NO-DB2-ERROR TO TRUE.                                 06230023
062400     MOVE 'Y' TO PS-USER-INPUT.                                   06240023
062500                                                                  06250023
062600     IF VAR-CMNEKPGM = SPACES                                     06260023
062700          MOVE 'N' TO PS-USER-INPUT                               06270023
062800          MOVE 'SPECIFY REQUIRED PARM' TO VAR-SMSG                06280023
062900          MOVE 'SUPPLY THE PROGRAM NAME' TO VAR-LMSG              06290023
063000          MOVE 'CMN000  ' TO ISP-MSG                              06300023
063100     ELSE                                                         06310023
063200          MOVE 'Y' TO PS-USER-INPUT.                              06320023
063300                                                                  06330023
063400 2100-EXIT.                                                       06340023
063500     EXIT.                                                        06350023
063600     EJECT                                                        06360023
063700************************************************************      06370023
063800* USE DYNALLOC TO ALLOCATE TEMP FILE THAT WILL BE DISPLAYED*      06380023
063900************************************************************      06390023
064000 3000-ALLOCATE-TEMP-FILE.                                         06400023
064100     PERFORM 9100-DELETE-FILE.                                    06410054
064200                                                                  06420054
064300     IF ((DP023-LASTRC = ZERO)                                    06430054
064400             OR (DP023-LASTRC = DP023-RC-DATASET-DOESNT-EXIST))   06440054
064500         INITIALIZE DP023-DYNALC-PARMS                            06450054
064600         MOVE PC-BROWSE-DDNAME TO DP023-DDNAME                    06460058
064700         MOVE PV-BROWSE-DSNAME TO DP023-DSNAME                    06470058
064800         SET DP023-DISP-NEW TO TRUE                               06480054
064900         SET DP023-FREE-CLOSE-NO TO TRUE                          06490054
065000         SET DP023-RECFM-FIXED-BLOCK TO TRUE                      06500054
065100         MOVE LENGTH OF BROWSE-RECORD TO DP023-RECSZ              06510064
065200         MOVE 2000 TO DP023-RECOUNT                               06520054
065300                                                                  06530054
065400         SET DP023-DISABLE-DISPLAY-ABEND TO TRUE                  06540054
065500                                                                  06550054
065600         PERFORM DP023-0000-DYNALC                                06560054
065700         IF DP023-LASTRC = ZERO                                   06570054
065800             SET PS-IS-ALLOCATED TO TRUE                          06580054
065900         ELSE                                                     06590054
066000             SET PS-IS-NOT-ALLOCATED TO TRUE                      06600054
066100             MOVE DP023-DDNAME TO PV-DR-DDNAME                    06610054
066200             MOVE DP023-RC (DP023-SUB) TO PV-DR-RETURN-CODE       06620054
066300             MOVE DP023-DESC (DP023-SUB) TO PV-DR-ERROR-DESC      06630054
066400             MOVE PV-DYNALC-ROUTINE-ERROR-MSG TO VAR-LMSG         06640054
066500             MOVE 'CMN000  ' TO ISP-MSG                           06650054
066600         END-IF                                                   06660054
066700     ELSE                                                         06670054
066800         SET PS-IS-NOT-ALLOCATED TO TRUE                          06680054
066900         MOVE DP023-DDNAME TO PV-DR-DDNAME                        06690054
067000         MOVE DP023-RC (DP023-SUB) TO PV-DR-RETURN-CODE           06700054
067100         MOVE DP023-DESC (DP023-SUB) TO PV-DR-ERROR-DESC          06710054
067200         MOVE PV-DYNALC-ROUTINE-ERROR-MSG TO VAR-LMSG             06720054
067300         MOVE 'CMN000  ' TO ISP-MSG                               06730054
067400     END-IF.                                                      06740054
067500                                                                  06750054
067600************************************************************      06760023
067700* MAIN-LINE LOGIC                                          *      06770023
067800************************************************************      06780023
067900 4000-DB2-TABLE-FUNCTIONS.                                        06790023
068000                                                                  06800023
068100     MOVE VAR-CMNEKPGM TO WS-PROGNAME.                            06810073
068200                                                                  06820023
068300     PERFORM 4200-OPEN-PLAN-TABLE-CURSOR                          06830023
068400         THRU 4200-EXIT.                                          06840023
068500     IF PS-DB2-ERROR                                              06850023
068600         GO TO 4000-EXIT.                                         06860023
068700                                                                  06870023
068800     MOVE SPACES TO PV-PREV-TIMESTAMP.                            06880086
068900     MOVE +0     TO PV-PREV-QUERYNO.                              06890023
069000     MOVE +0     TO PV-DATE-CNT.                                  06900023
069100     PERFORM 4300-FETCH-PLAN-TABLE THRU 4300-EXIT                 06910023
069200         UNTIL SQLCODE NOT = ZERO                                 06920023
069300         OR PV-DATE-CNT > 3.                                      06930023
069400     IF PS-DB2-ERROR                                              06940023
069500         GO TO 4000-EXIT.                                         06950023
069600                                                                  06960023
069700     PERFORM 4400-CLOSE-PLAN-TABLE-CURSOR                         06970023
069800         THRU 4400-EXIT.                                          06980023
069900     IF PS-DB2-ERROR                                              06990023
070000         GO TO 4000-EXIT.                                         07000023
070100                                                                  07010023
070200 4000-EXIT.                                                       07020023
070300     EXIT.                                                        07030023
070400     EJECT                                                        07040023
070500************************************************************      07050023
070600* OPEN PLAN_TABLE CURSOR                                   *      07060023
070700************************************************************      07070023
070800 4200-OPEN-PLAN-TABLE-CURSOR.                                     07080023
070900                                                                  07090023
071000      EXEC SQL                                                    07100023
071100          OPEN PLAN_TABLE_CSR                                     07110023
071200      END-EXEC.                                                   07120023
071300                                                                  07130023
071400      IF SQLCODE NOT = 0                                          07140023
071500          SET PS-DB2-ERROR TO TRUE                                07150023
071600          MOVE 'SQLCODE =' TO VAR-SMSG-FILLER                     07160023
071700          MOVE SQLCODE TO VAR-SMSG-SQLCODE                        07170023
071800          MOVE '4200-OPEN CURSOR ABEND, CONTACT DATA RESOURCE'    07180023
071900               TO VAR-LMSG                                        07190023
072000          MOVE 'CMN000  ' TO ISP-MSG.                             07200023
072100                                                                  07210023
072200 4200-EXIT.                                                       07220023
072300     EXIT.                                                        07230023
072400     EJECT                                                        07240023
072500************************************************************      07250023
072600* FETCH THE ROWS FROM THE PLAN_TABLE                       *      07260023
072700************************************************************      07270023
072800 4300-FETCH-PLAN-TABLE.                                           07280023
072900                                                                  07290023
073000     INITIALIZE DCLPLAN-TABLE.                                    07300023
073100                                                                  07310023
073200     EXEC SQL                                                     07320023
073300         FETCH PLAN_TABLE_CSR                                     07330023
073400         INTO :PLANTBL-QUERYNO                                    07340023
073500            , :PLANTBL-QBLOCKNO                                   07350023
073600            , :PLANTBL-PLANNO                                     07360023
073700            , :PLANTBL-METHOD                                     07370023
073800            , :PLANTBL-TNAME                                      07380023
073900            , :PLANTBL-TABNO                                      07390023
074000            , :PLANTBL-CORRELATION-NAME :WS-NULL-CORRELATION-NAME 07400023
074100            , :PLANTBL-ACCESSTYPE                                 07410023
074200            , :PLANTBL-MATCHCOLS                                  07420023
074300            , :PLANTBL-MIXOPSEQ                                   07430023
074400            , :PLANTBL-ACCESSNAME                                 07440023
074500            , :PLANTBL-INDEXONLY                                  07450023
074600            , :PLANTBL-SORTN-UNIQ                                 07460023
074700            , :PLANTBL-SORTN-JOIN                                 07470023
074800            , :PLANTBL-SORTN-ORDERBY                              07480023
074900            , :PLANTBL-SORTN-GROUPBY                              07490023
075000            , :PLANTBL-SORTC-UNIQ                                 07500023
075100            , :PLANTBL-SORTC-JOIN                                 07510023
075200            , :PLANTBL-SORTC-ORDERBY                              07520023
075300            , :PLANTBL-SORTC-GROUPBY                              07530023
075400            , :PLANTBL-TSLOCKMODE                                 07540023
075500            , :PLANTBL-PREFETCH                                   07550023
075600            , :PLANTBL-COLUMN-FN-EVAL                             07560023
075700            , :PLANTBL-PARALLELISM-MODE :WS-NULL-PARALLELISM-MODE 07570023
075800            , :PLANTBL-MERGE-JOIN-COLS :WS-NULL-MERGE-JOIN-COLS   07580023
075900            , :PLANTBL-PAGE-RANGE                                 07590023
076000            , :PLANTBL-TIMESTAMP                                  07600023
076100            , :WS-COST-MS                                         07610040
076200            , :WS-COST-SU                                         07620040
076300            , :WS-COST-CATG                                       07630048
076301            , :PLANTBL-BIND-TIME                                  07630184
076310            , :SYSPKG-BINDTIME                                    07631075
076400     END-EXEC.                                                    07640023
076500                                                                  07650023
076600     IF SQLCODE = ZERO                                            07660023
076700         PERFORM 4310-WRITE-LINE THRU 4310-EXIT                   07670023
076800     ELSE                                                         07680023
076900     IF SQLCODE = +100                                            07690023
077000         IF PV-PREV-DATE-H-M EQUAL SPACES                         07700099
077100             MOVE SPACES TO BROWSE-RECORD                         07710023
077200             WRITE BROWSE-RECORD                                  07720023
077300             WRITE BROWSE-RECORD FROM NO-MATCH-INFO               07730023
077400         END-IF                                                   07740023
077500     ELSE                                                         07750023
077600         SET PS-DB2-ERROR TO TRUE                                 07760023
077700         MOVE 'SQLCODE =' TO VAR-SMSG-FILLER                      07770023
077800         MOVE SQLCODE TO VAR-SMSG-SQLCODE                         07780023
077900         MOVE                                                     07790023
078000         '4300-FETCH-PLAN-TABLE ABEND, CONTACT DATA RESOURCE'     07800023
078100             TO VAR-LMSG                                          07810023
078200         MOVE 'CMN000  ' TO ISP-MSG                               07820023
078300     END-IF                                                       07830023
078400     END-IF.                                                      07840023
078500                                                                  07850023
078600  4300-EXIT.                                                      07860023
078700     EXIT.                                                        07870023
078800     EJECT                                                        07880023
078900************************************************************      07890023
079000*                                                          *      07900023
079100************************************************************      07910023
079200 4310-WRITE-LINE.                                                 07920023
079300                                                                  07930023
079400     MOVE PLANTBL-BIND-TIME TO WS-TIMESTAMP.                      07940099
079500                                                                  07950023
079600     IF WS-DATE-H-M  EQUAL PV-PREV-DATE-H-M                       07960098
079700         IF PLANTBL-QUERYNO EQUAL PV-PREV-QUERYNO                 07970023
079800             CONTINUE                                             07980023
079900         ELSE                                                     07990023
080000             MOVE SPACES TO BROWSE-RECORD                         08000023
080100             WRITE BROWSE-RECORD                                  08010023
080200             MOVE PLANTBL-QUERYNO TO PV-PREV-QUERYNO              08020023
080300         END-IF                                                   08030023
080400     ELSE                                                         08040023
080500         ADD 1 TO PV-DATE-CNT                                     08050023
080600         IF PV-DATE-CNT < 4                                       08060023
080700             MOVE SPACES TO BROWSE-RECORD                         08070023
080800             WRITE BROWSE-RECORD                                  08080023
080900             MOVE SPACES TO BROWSE-RECORD                         08090023
081000             WRITE BROWSE-RECORD                                  08100023
081100         END-IF                                                   08110023
081200         MOVE WS-TIMESTAMP      TO PV-PREV-TIMESTAMP              08120098
081300         MOVE PLANTBL-QUERYNO   TO PV-PREV-QUERYNO                08130023
081400     END-IF.                                                      08140023
081500                                                                  08150023
081510     IF PLANTBL-BIND-TIME = SYSPKG-BINDTIME                       08151084
081530         MOVE '*'     TO     RPT-CURRENT-IND                      08153076
081531     ELSE                                                         08153175
081540         MOVE SPACES  TO     RPT-CURRENT-IND                      08154076
081550     END-IF.                                                      08155075
081600     MOVE PLANTBL-QUERYNO     TO RPT-QNO.                         08160023
081700     MOVE PLANTBL-QBLOCKNO    TO RPT-BLK.                         08170023
081800     MOVE PLANTBL-PLANNO      TO RPT-PLN.                         08180023
081900     MOVE PLANTBL-METHOD      TO RPT-M.                           08190023
082100     IF PLANTBL-TNAME-LEN < 19                                    08210071
082101         MOVE PLANTBL-TNAME-TEXT (1:18)   TO RPT-TABLE            08210170
082102         MOVE SPACES                      TO RPT-TABLE2           08210271
082103         MOVE SPACES                      TO RPT-TABLE3           08210371
082104     ELSE                                                         08210470
082105         MOVE SPACES                      TO RPT-TABLE            08210570
082106         MOVE PLANTBL-TNAME-TEXT (1:64)   TO RPT-TABLE2           08210670
082110         MOVE PLANTBL-TNAME-TEXT (65:64)  TO RPT-TABLE3           08211070
082120     END-IF.                                                      08212070
082200     IF WS-NULL-CORRELATION-NAME < +0                             08220023
082300         MOVE SPACES          TO RPT-CORR-NAME                    08230023
082400     ELSE                                                         08240023
082500         MOVE PLANTBL-CORRELATION-NAME-TEXT TO RPT-CORR-NAME      08250072
082600     END-IF.                                                      08260023
082700     MOVE PLANTBL-ACCESSTYPE  TO RPT-A.                           08270023
082800     MOVE PLANTBL-MATCHCOLS   TO RPT-MC.                          08280023
082900     MOVE PLANTBL-MIXOPSEQ    TO RPT-MX-OP.                       08290023
083000     MOVE PLANTBL-ACCESSNAME-TEXT  TO RPT-INDEX.                  08300072
083100     MOVE PLANTBL-INDEXONLY   TO RPT-IO.                          08310023
083200     MOVE PLANTBL-SORTN-UNIQ  TO RPT-SORTN-U.                     08320023
083300     MOVE PLANTBL-SORTN-JOIN  TO RPT-SORTN-J.                     08330023
083400     MOVE PLANTBL-SORTN-ORDERBY TO RPT-SORTN-O.                   08340023
083500     MOVE PLANTBL-SORTN-GROUPBY TO RPT-SORTN-G.                   08350023
083600     MOVE PLANTBL-SORTC-UNIQ  TO RPT-SORTC-U.                     08360023
083700     MOVE PLANTBL-SORTC-JOIN  TO RPT-SORTC-J.                     08370023
083800     MOVE PLANTBL-SORTC-ORDERBY TO RPT-SORTC-O.                   08380023
083900     MOVE PLANTBL-SORTC-GROUPBY TO RPT-SORTC-G.                   08390023
084000     MOVE PLANTBL-TSLOCKMODE  TO RPT-LCK.                         08400023
084100     MOVE PLANTBL-PREFETCH    TO RPT-PF.                          08410023
084200     IF WS-NULL-PARALLELISM-MODE < +0                             08420023
084300         MOVE SPACES          TO RPT-PA-MODE                      08430043
084400     ELSE                                                         08440023
084500         MOVE PLANTBL-PARALLELISM-MODE TO RPT-PA-MODE             08450043
084600     END-IF.                                                      08460023
084700     IF WS-NULL-MERGE-JOIN-COLS < +0                              08470023
084800         MOVE SPACES          TO RPT-JN-CLS                       08480023
084900     ELSE                                                         08490023
085000         MOVE PLANTBL-MERGE-JOIN-COLS TO RPT-JN-CLS               08500023
085100     END-IF.                                                      08510023
085200     MOVE PLANTBL-PAGE-RANGE  TO RPT-PAGE-RNGE.                   08520023
085300     MOVE WS-YYYY             TO WS-ED-YYYY.                      08530024
085400     MOVE WS-MM               TO WS-ED-MM.                        08540024
085500     MOVE WS-DD               TO WS-ED-DD.                        08550024
085600     MOVE WS-EXPLAIN-DATE     TO RPT-TIMESTAMP.                   08560024
085700     MOVE WS-COST-MS          TO RPT-COST-MS.                     08570039
085800     MOVE WS-COST-SU          TO RPT-COST-SU.                     08580039
085900     MOVE WS-COST-CATG        TO RPT-COST-CATG.                   08590048
086000                                                                  08600048
086100     IF PV-DATE-CNT < 4                                           08610048
086200         WRITE BROWSE-RECORD FROM REPORT-DTL                      08620048
086300         IF RPT-TABLE2 > SPACES                                   08630066
086400             WRITE BROWSE-RECORD FROM REPORT-DTL2                 08640066
086500         END-IF                                                   08650066
086510         IF RPT-TABLE3 > SPACES                                   08651070
086520             WRITE BROWSE-RECORD FROM REPORT-DTL3                 08652070
086530         END-IF                                                   08653070
086600     END-IF.                                                      08660048
086700                                                                  08670048
086800 4310-EXIT.                                                       08680048
086900     EXIT.                                                        08690048
087000     EJECT                                                        08700048
087100************************************************************      08710048
087200* CLOSE PLAN-TABLE_CURSOR                                  *      08720048
087300************************************************************      08730048
087400 4400-CLOSE-PLAN-TABLE-CURSOR.                                    08740048
087500                                                                  08750048
087600     EXEC SQL                                                     08760048
087700         CLOSE PLAN_TABLE_CSR                                     08770048
087800     END-EXEC.                                                    08780048
087900                                                                  08790048
088000     IF SQLCODE NOT = ZERO                                        08800048
088100         SET PS-DB2-ERROR TO TRUE                                 08810023
088200         MOVE 'SQLCODE =' TO VAR-SMSG-FILLER                      08820023
088300         MOVE SQLCODE TO VAR-SMSG-SQLCODE                         08830023
088400         MOVE '4400-CLOSE CURSOR ABEND, CONTACT DATA RESOURCE'    08840023
088500              TO VAR-LMSG                                         08850023
088600         MOVE 'CMN000  ' TO ISP-MSG.                              08860023
088700*                                                                 08870023
088800 4400-EXIT.                                                       08880023
088900     EXIT.                                                        08890023
089000     EJECT                                                        08900023
089100************************************************************      08910023
089200* DISPLAY BROWSE-FILE                                      *      08920023
089300************************************************************      08930023
089400 8000-BROWSE-FILE.                                                08940056
089500     MOVE ZERO TO PV-COUNTR.                                      08950054
089600     INSPECT PV-BROWSE-DSNAME TALLYING PV-COUNTR FOR              08960058
089700                 CHARACTERS BEFORE INITIAL '.'.                   08970054
089800     ADD 2 TO PV-COUNTR.                                          08980054
089900*BLJ MOVE PV-BROWSE-DSNAME (PV-COUNTR:13) TO VAR-DSNAME.          08990099
089910     MOVE PV-BROWSE-DSNAME (PV-COUNTR:21) TO VAR-DSNAME.          08991099
090000     MOVE 'CMNEKRBD' TO ISP-PANEL.                                09000054
090100     CALL 'ISPLINK' USING ISP-BROWSE,                             09010054
090200                          VAR-DSNAME,                             09020054
090300                          VAR-VOLUME,                             09030054
090400                          VAR-PASSWORD,                           09040054
090500                          ISP-PANEL.                              09050054
090600*                                                                 09060054
090700*  CALL THE COMMON PRINT REQUEST PANEL PROGRAM TO ALLOW THE OPTION09070054
090800*  OF PRINTING THE FILE THAT WAS JUST BROWSED.                    09080054
090900*                                                                 09090054
091000     INITIALIZE DP300-ISPF-PRINT-PARMS.                           09100054
091100     MOVE PC-CURRENT-PROGRAM-NAME TO                              09110054
091200               DP300-CALLING-PROGRAM-NAME.                        09120054
091300     MOVE 1 TO DP300-CALLING-REPORT-NUMBER.                       09130054
091400     MOVE PV-BROWSE-DSNAME TO DP300-FILE-DSNAME.                  09140058
091500     SET DP300-FR-FIXED-BLOCK TO TRUE.                            09150054
091600     MOVE 132 TO DP300-FILE-LRECL.                                09160054
091700     SET DP300-PT-PRINT-TITLE-LINE                                09170054
091800         DP300-RH-REPEAT-HEADINGS TO TRUE.                        09180054
091900     MOVE 8 TO DP300-HEADING-LINE-COUNT.                          09190055
092000     CALL DP300-ISPF-PRINT-REQ-PROGRAM                            09200054
092100               USING DP300-ISPF-PRINT-PARMS.                      09210054
092200     MOVE 'CMN000  ' TO ISP-MSG                                   09220054
092300     MOVE DP300-ERROR-MESSAGE TO VAR-LMSG.                        09230054
092400     IF DP300-RI-PRINT-REQUESTED                                  09240054
092500         MOVE DP300-ERROR-MESSAGE TO VAR-SMSG                     09250054
092600     END-IF.                                                      09260054
092700                                                                  09270054
092800************************************************************      09280054
092900* DELETE BROWSE FILE                                       *      09290054
093000************************************************************      09300054
093100 9100-DELETE-FILE.                                                09310054
093200     INITIALIZE DP023-DYNALC-PARMS.                               09320054
093300     MOVE PC-BROWSE-DDNAME TO DP023-DDNAME.                       09330058
093400     MOVE PV-BROWSE-DSNAME TO DP023-DSNAME.                       09340058
093500     SET DP023-DISP-DELETE TO TRUE.                               09350054
093600     SET DP023-FREE-CLOSE-NO TO TRUE.                             09360054
093700     SET DP023-RECFM-FIXED-BLOCK TO TRUE.                         09370054
093800     MOVE LENGTH OF BROWSE-RECORD TO DP023-RECSZ.                 09380064
093900     MOVE ZEROES TO DP023-RECOUNT.                                09390064
094000                                                                  09400054
094100     SET DP023-DISABLE-DISPLAY-ABEND TO TRUE.                     09410054
094200                                                                  09420054
094300     PERFORM DP023-0000-DYNALC.                                   09430054
094400                                                                  09440054
094500     SET PS-IS-NOT-ALLOCATED TO TRUE.                             09450054
094600                                                                  09460054
094700*                                                                 09470054
094800*  DYNAMIC ALLOCATION ROUTINE                                     09480054
094900*                                                                 09490054
095000     COPY DPPD023.                                                09500054
