000100 IDENTIFICATION DIVISION.                                         00010000
000200 TITLE 'MANIFESTING - SCAN ON OR OFF CARTONS ONTO A TRAILER'.     00020000
000300                                                                  00030000
000400 PROGRAM-ID.             PCKRF879.                                00040000
000500 AUTHOR.                 DENNIS STEFFEN.                          00050000
000600 INSTALLATION.           KOHLS.                                   00060000
000700 DATE-WRITTEN.           MAY, 2001.                               00070000
000800 DATE-COMPILED.                                                   00080000
000900                                                                  00090000
001000 ENVIRONMENT DIVISION.                                            00100000
001100 DATA DIVISION.                                                   00110000
001200                                                                  00120000
001300 WORKING-STORAGE SECTION.                                         00130000
001400                                                                  00140000
001500 01  PC-PROGRAM-CONSTANTS.                                        00150000
001600     05  PC-TRANID                    PIC X(04) VALUE 'E879'.     00160000
001700     05  PC-CURRENT-PROGRAM-NAME      PIC X(08) VALUE 'PCKRF879'. 00170000
001900     05  PC-RAND-PGM                  PIC X(08) VALUE 'DPKUT902'. 00190000
002000     05  PC-DUMMY-TIMESTAMP           PIC X(26) VALUE             00200000
002100            '9999-09-09-09.09.09.999999'.                         00210000
002200     05  PC-LOW-TIMESTAMP             PIC X(26) VALUE             00220000
002300            '0001-01-01-00.00.00.000000'.                         00230000
002400     05  PC-DLX                       PIC X(03) VALUE 'DLX'.      00240000
002500     05  PC-DLSHPI                    PIC X(06) VALUE 'DLSHPI'.   00250000
002600     05  PC-Y                         PIC X(01) VALUE 'Y'.        00260000
002700     05  PC-SHIPPING                  PIC X(08) VALUE 'SHIPPING'. 00270000
002800     05  PC-PALLET-MANUAL             PIC X(40) VALUE             00280000
002900         'PALLET MANUAL SCAN                      '.              00290000
003000     05  PC-CARTON-MANUAL             PIC X(40) VALUE             00300000
003100         'CARTON MANUAL SCAN                      '.              00310000
003200                                                                  00320000
003300* ERROR MESSAGES                                                 *00330000
003400     05  PC-UNRECOGNIZED-PF-KEY-MSG   PIC X(19) VALUE             00340000
003500                                           'UNRECOGNIZED PF KEY'. 00350000
003600     05  PC-ENTER-THROUGH-MENU-MSG    PIC X(19) VALUE             00360000
003700                                           'ENTER THROUGH MENU '. 00370000
003800     05  PC-TRANS-UNAVAILABLE-MSG     PIC X(19) VALUE             00380000
003900                                           'TRANS NOT AVAILABLE'. 00390000
004000     05  PC-WRONG-FACILITY            PIC X(19) VALUE             00400000
004100                                           'WRG FCLTY - F2 CONF'. 00410000
004200                                                                  00420000
004300 01  PS-PROGRAM-SWITCHES.                                         00430000
004400     05  PS-ERROR-SW                  PIC X(01)  VALUE 'N'.       00440000
004500         88  PS-ERRORS-YES                        VALUE 'Y'.      00450000
004600         88  PS-ERRORS-NO                         VALUE 'N'.      00460000
004700     05  PS-XCTL-SW                   PIC X(04)   VALUE SPACES.   00470000
004800         88  PS-XCTL-E871                       VALUE 'E871'.     00480000
004900     05  PS-VALID-INPUT-SW            PIC X(01) VALUE 'N'.        00490000
005000         88  PS-VALID-INPUT                       VALUE 'Y'.      00500000
005100         88  PS-INVALID-INPUT                     VALUE 'N'.      00510000
005200     05  PS-SUCRDV-SW                 PIC X(01) VALUE 'N'.        00520000
005300         88  PS-SUCRDV-YES                        VALUE 'Y'.      00530000
005400         88  PS-SUCRDV-NO                         VALUE 'N'.      00540000
005500     05  PS-TRLR-OPEN-SW              PIC X(04) VALUE SPACES.     00550000
005600         88  PS-TRLR-OPEN-THIS-DOOR             VALUE 'THIS'.     00560000
005700         88  PS-TRLR-OPEN-DIFF-DOOR             VALUE 'DIFF'.     00570000
005800     05  PC-STORE-DOOR-CSR-SW         PIC X(01) VALUE 'N'.        00580000
005900         88  PS-END-STORE-DOOR-CSR              VALUE 'Y'.        00590000
006000         88  PS-NOT-END-STORE-DOOR-CSR          VALUE 'N'.        00600000
006100     05  PS-DOOR-DEST-EDIT-SW         PIC X(01) VALUE 'Y'.        00610000
006200         88  PS-SKIP-DOOR-DEST-EDITS            VALUE 'N'.        00620000
006300         88  PS-DO-DOOR-DEST-EDITS              VALUE 'Y'.        00630000
006400     05  PS-DIVERT-DOOR-SW            PIC X(01) VALUE 'Y'.        00640000
006500         88  PS-DIVERT-DOOR-YES                 VALUE 'Y'.        00650000
006600         88  PS-DIVERT-DOOR-NO                  VALUE 'N'.        00660000
006700     05  PS-SERIAL-SW                 PIC X(01) VALUE 'N'.        00670000
006800         88  PS-SERIAL-NO                       VALUE 'N'.        00680000
006900         88  PS-SERIAL-YES                      VALUE 'Y'.        00690000
007000     05  PS-ACTIVE-TRIP-SW            PIC X(01) VALUE 'N'.        00700000
007100         88  PS-ACTIVE-TRIP-EXISTS              VALUE 'Y'.        00710000
007200         88  PS-NO-ACTIVE-TRIP-EXISTS           VALUE 'N'.        00720000
007300     05  PS-KIDS-SW                   PIC X(01) VALUE 'N'.        00730000
007400         88  PS-ALL-KIDS                        VALUE 'N'.        00740000
007500         88  PS-END-OF-KIDS                     VALUE 'Y'.        00750000
007600     05  PS-PARENTS-SW                PIC X(01) VALUE 'N'.        00760000
007700         88  PS-ALL-PARENTS                     VALUE 'N'.        00770000
007800         88  PS-END-OF-PARENTS                  VALUE 'Y'.        00780000
007900     05  PS-MASTER-CONTAINER-SW       PIC X(01) VALUE SPACE.      00790000
008000         88  PS-MASTER-CONTAINER                VALUE 'M'.        00800000
008100         88  PS-OTHER-CONTAINER                 VALUE 'O'.        00810000
008200     05  PS-DOOR-GROUP-SW             PIC X(01) VALUE SPACE.      00820000
008300         88  PS-DOOR-GROUP-FOUND-YES            VALUE 'Y'.        00830000
008400         88  PS-DOOR-GROUP-FOUND-NO             VALUE 'N'.        00840000
008500                                                                  00850000
008600 01  PV-PROGRAM-VARIABLES.                                        00860000
008700     05  PV-SCAN-ON-TRIP-ID           PIC S9(09) VALUE ZEROES     00870000
008800                                                     COMP SYNC.   00880000
008900     05  PV-DISP-SHIPT-UNT-ID         PIC  9(18).                 00890000
008910     05  PV-DISP-SHIPT-UNT-ID2        PIC  9(18).                 00891000
008920     05  PV-DISP-SHIPT-UNT-ID3        PIC  9(18).                 00892000
008930     05  PV-SUB                       PIC S9(03) COMP-3.          00893000
008940     05  PV-KIDS-COUNT                PIC S9(05) COMP-3.          00894000
008950     05  PV-DB2-COUNT                 PIC S9(05) COMP-3.          00895000
008960     05  PV-SHIPT-UNT-SRC-ID          PIC X(03)  VALUE SPACES.    00896000
008970     05  PV-TRIP-STAT-DESC            PIC X(10)  VALUE SPACES.    00897000
008980     05  PV-COMMAREA-LENGTH           PIC S9(04)  VALUE +0        00898000
008990                                                     COMP SYNC.   00899000
009000     05  PV-MESSAGE-AREA              PIC  X(19)  VALUE SPACE.    00900000
009100     05  PV-CICS-RESPONSE             PIC S9(09)  VALUE ZEROS     00910000
009200                                                     COMP SYNC.   00920000
009300     05  PV-TRANSFER-PROGRAM          PIC X(08) VALUE SPACE.      00930000
009400     05  PV-SEASET-RELEASE-DATE       PIC X(08) VALUE SPACES.     00940000
009500     05  PV-SEASET-RELEASE-DISP-DATE  PIC X(10) VALUE SPACES.     00950000
009600     05  PV-DATE-DURATION             PIC S9(8) COMP-3            00960000
009700                                                VALUE ZERO.       00970000
009800     05  PV-ERROR-MESSAGE             PIC X(45)  VALUE SPACE.     00980000
009900     05  PV-CICS-MSG-AREA2            PIC X(100) VALUE SPACE.     00990000
010000     05  PV-CURRENT-TIMESTAMP         PIC X(26)  VALUE SPACE.     01000000
010100     05  PV-NUMBER-OF-CARTONS         PIC S9(8)  VALUE 0 COMP.    01010000
010200     05  PV-NUMBER-OF-UNITS           PIC S9(8)  VALUE 0 COMP.    01020000
010300     05  PV-MST-NBR-OF-CARTONS        PIC S9(8)  VALUE 0 COMP.    01030000
010400     05  PV-MST-NBR-OF-UNITS          PIC S9(8)  VALUE 0 COMP.    01040000
010500     05  PV-MST-TOTAL-CARTONS         PIC S9(8)  VALUE 0 COMP.    01050000
010600     05  PV-MST-TOTAL-UNITS           PIC S9(8)  VALUE 0 COMP.    01060000
010700                                                                  01070000
010800 01  PV-LOG-MSG.                                                  01080000
010900     05  FILLER                       PIC X(12) VALUE             01090000
011000         ' E879 ERROR '.                                          01100000
011100     05  FILLER                       PIC X(05) VALUE             01110000
011200         'USER='.                                                 01120000
011300     05  PV-USER-ID                   PIC X(08) VALUE SPACES.     01130000
011400     05  FILLER                       PIC X(09) VALUE             01140000
011500         ' SQLCODE='.                                             01150000
011600     05  PV-SQLCODE                   PIC -9(03).                 01160000
011700     05  FILLER                       PIC X(05) VALUE             01170000
011800         ' ERR='.                                                 01180000
011900     05  PV-ERROR-NBR                 PIC 9(03) VALUE ZERO.       01190000
012000     05  FILLER                       PIC X(06) VALUE             01200000
012100         ' DOOR='.                                                01210000
012200     05  PV-DISPLAY-DOOR              PIC X(04) VALUE ZEROES.     01220000
012300     05  FILLER                       PIC X(05) VALUE             01230000
012400         ' SML='.                                                 01240000
012500     05  PV-DISPLAY-SML               PIC 9(18) VALUE ZEROES.     01250000
012600/                                                                 01260000
012700 01  PV-EDITING-FIELDS.                                           01270000
012800     05  PV-CTN.                                                  01280000
012900         10  PV-CTN-CHAR              PIC X(01)                   01290000
013000                            OCCURS 20 TIMES.                      01300000
013100     05  PV-CTN-18                    PIC X(18) VALUE ZEROES.     01310000
013200     05  PV-CTN-N REDEFINES PV-CTN-18 PIC 9(18).                  01320000
013300                                                                  01330000
013400     05  PV-BARCODE-CHECKER           PIC X(20).                  01340000
013500* VALID PATTERNS                                                  01350000
013600         88  PV-VALID-BARCODE         VALUES                      01360000
013700             '00499999999999999999'                               01370000
013800             'B049999999999999999B'                               01380000
013900             'BB499999999999999999'                               01390000
014000             '499999999999999999BB'                               01400000
014100             '409999999999999999BB'                               01410000
014200             '449999999999999999BB'                               01420000
014300             'B409999999999999999B'                               01430000
014400             'B499999999999999999B'                               01440000
014500             'B449999999999999999B'.                              01450000
014600         88  PV-2-LEAD-ZEROES         VALUE                       01460000
014700             '00499999999999999999'.                              01470000
014800         88  PV-LEAD-TRAIL-SPACES     VALUE                       01480000
014900             'B499999999999999999B'                               01490000
015000             'B409999999999999999B'                               01500000
015100             'B449999999999999999B'.                              01510000
015200         88  PV-2-LEAD-SPACES         VALUE                       01520000
015300             'BB499999999999999999'.                              01530000
015400         88  PV-TRAIL-SPACES          VALUE                       01540000
015500             '499999999999999999BB'                               01550000
015600             '409999999999999999BB'                               01560000
015700             '449999999999999999BB'.                              01570000
015800                                                                  01580000
015900* INVALID PATTERNS                                                01590000
016000         88  PV-NOT-START-WITH-4      VALUES                      01600000
016100             '999999999999999999BB'                               01610000
016200             'B999999999999999999B'                               01620000
016300             'BB999999999999999999'.                              01630000
016400         88  PV-NOT-START-WITH-004    VALUES                      01640000
016500             '00999999999999999999'.                              01650000
016600         88  PV-INVALID-ALL-BLANK     VALUES                      01660000
016700             'BBBBBBBBBBBBBBBBBBBB'.                              01670000
016800                                                                  01680000
016900     05  PV-BARCODE-EDIT-MASK REDEFINES                           01690000
017000                              PV-BARCODE-CHECKER.                 01700000
017100         10  PV-BARCODE-CHAR          PIC X(01)                   01710000
017200                              OCCURS 20 TIMES.                    01720000
017300                                                                  01730000
017400 01  PV-DISPLAY-FIELDS.                                           01740000
017500     05  PV-DISPLAY-DOOR-ID           PIC  X(04)  VALUE SPACE.    01750000
017600     05  PV-DISPLAY-OPER              PIC  9(04)  VALUE ZEROES.   01760000
017700     05  PV-DISPLAY-SEQ-NBR           PIC  9(11)  VALUE ZEROES.   01770000
017800     05  PV-DISPLAY-DEST              PIC  9(04)  VALUE ZEROES.   01780000
017900     05  PV-DISPLAY-SRL-NBR           PIC  9(09)  VALUE ZEROES.   01790000
018000     05  PV-DISPLAY-SCAC              PIC  X(04)  VALUE SPACES.   01800000
018100     05  PV-DISPLAY-TRLR-ID           PIC  X(12)  VALUE ZEROES.   01810000
018200     05  PV-DISPLAY-TRIP              PIC  9(09)  VALUE ZEROES.   01820000
018300                                                                  01830000
018400     05  DK-BRCDE-NBR                 PIC X(22) VALUE SPACES.     01840000
018500                                                                  01850000
018600     05  DK-BRCDE-NBR-CHILD-N         PIC 9(20) VALUE ZEROES.     01860000
018700     05  DK-BRCDE-NBR-CHILD REDEFINES DK-BRCDE-NBR-CHILD-N        01870000
018800                                      PIC X(20).                  01880000
018801                                                                  01880100
018802     05  DK-PARENT-SHIPT-UNT-ID       PIC S9(18)V COMP-3          01880200
018803                                                VALUE ZERO.       01880300
018804     05  DK-FIND-CARTON               PIC S9(18)V COMP-3          01880400
018805                                                VALUE ZERO.       01880500
018806     05  DK-CHILD-CARTON              PIC S9(18)V COMP-3          01880600
018807                                                VALUE ZERO.       01880700
018808                                                                  01880800
018809     COPY PCWS046.                                                01880900
018810                                                                  01881000
018820*    COMMAREA USED WHEN CALLING DLKUP001                          01882000
018830     COPY DLWS001.                                                01883000
018840                                                                  01884000
018850*    USED TO CONSISTENTLY FORMAT THE ASSIGNMENT NUMBER FIELD      01885000
018860     COPY DLWS011.                                                01886000
018870                                                                  01887000
018880*    COMMAREA USED WHEN CALLING DLKCS410                          01888000
018890     COPY DLWS016.                                                01889000
018900                                                                  01890000
019000*    COMMAREA USED WHEN CALLING XLKUP033                          01900000
019100     COPY XLWS072.                                                01910000
019200                                                                  01920000
019300*    USED WITH XLWS072 WHEN CALLING XLWS072                       01930000
019400     COPY PCWS242.                                                01940000
019500                                                                  01950000
019600                                                                  01960000
019700 01  CA-COMMAREA.                                                 01970000
019800     COPY PCWS233.                                                01980000
019900     05  CA-PRIVATE-COMMAREA          PIC X(100).                 01990000
020000     05  CA-REDEFINED-COMMAREA REDEFINES CA-PRIVATE-COMMAREA.     02000000
020100         10  CA-CURR-DOOR             PIC X(04).                  02010000
020200         10  CA-CURR-DEST             PIC 9(04).                  02020000
020300         10  CA-CURR-SERIAL-NBR       PIC 9(09).                  02030000
020400         10  CA-OTBND-CART-SW         PIC X(01).                  02040000
020500             88  CA-OTBND-CART-YES              VALUE 'Y'.        02050000
020600             88  CA-OTBND-CART-NO               VALUE 'N'.        02060000
020700         10  CA-VENDOR-CARTON         PIC S9(18)V COMP-3.         02070000
020800         10  CA-DOOR-TYP-CDE          PIC X(02).                  02080000
020900         10  FILLER                   PIC X(70).                  02090000
021000/                                                                 02100000
021100*  MAP LAYOUT                                                     02110000
021200     COPY PCKM879.                                                02120000
021300                                                                  02130000
021400* HELP SCREEN COMMAREA                                            02140000
021500     COPY PCWS192.                                                02150000
021600* HELP SCREEN WORK AREA                                           02160000
021700     COPY PCWS188.                                                02170000
021800/                                                                 02180000
021900     COPY DPWS010I.                                               02190000
022000*  KOHL'S STANDARD ATTRIBUTE AND PRINTER CONTROL CHARACTER LIST   02200000
022100     COPY DPWS015.                                                02210000
022200                                                                  02220000
022300*  KOHL'S STANDARD ATTENTION IDENTIFIER LIST                      02230000
022400     COPY DFHAID.                                                 02240000
022500                                                                  02250000
022600*  LAYOUT FOR THE ABEND MODULE COMMUNICATIONS AREA.               02260000
022700     COPY DPWS013.                                                02270000
022800/                                                                 02280000
022900*    TRAILER ID MASTER                                            02290000
023000     EXEC SQL                                                     02300000
023100         INCLUDE TCNTRID                                          02310000
023200     END-EXEC.                                                    02320000
023300                                                                  02330000
023400*    SHIP UNIT MASTER                                             02340000
023500     EXEC SQL                                                     02350000
023600         INCLUDE SUT00024                                         02360000
023700     END-EXEC.                                                    02370000
023800                                                                  02380000
023900*    SHIP UNIT LOCATION                                           02390000
024000     EXEC SQL                                                     02400000
024100         INCLUDE SUT00027                                         02410000
024200     END-EXEC.                                                    02420000
024300                                                                  02430000
024400*    DIVERTER CARTONS                                             02440000
024500     EXEC SQL                                                     02450000
024600         INCLUDE TSUCRDV                                          02460000
024700     END-EXEC.                                                    02470000
024800                                                                  02480000
024900*    OUTBOUND TRAILER TRIP                                        02490000
025000     EXEC SQL                                                     02500000
025100         INCLUDE TSUOBTR                                          02510000
025200     END-EXEC.                                                    02520000
025300                                                                  02530000
025400*    SUT_TRIP_WRKR_AUD TABLE                                      02540000
025500     EXEC SQL                                                     02550000
025600         INCLUDE SUT00006                                         02560000
025700     END-EXEC.                                                    02570000
025800                                                                  02580000
025900*    OUTBOUND TRAILER TRIP STATUS                                 02590000
026000     EXEC SQL                                                     02600000
026100         INCLUDE TSUOBTS                                          02610000
026200     END-EXEC.                                                    02620000
026300                                                                  02630000
026400*    SEASONAL SET MASTER                                          02640000
026500     EXEC SQL                                                     02650000
026600         INCLUDE TSEASET                                          02660000
026700     END-EXEC.                                                    02670000
026800                                                                  02680000
026900*    ???                                                          02690000
027000     EXEC SQL                                                     02700000
027100         INCLUDE TKRPRPM                                          02710000
027200     END-EXEC.                                                    02720000
027300                                                                  02730000
027400*    DOOR GROUP TEMPLATE                                          02740000
027500     EXEC SQL                                                     02750000
027600         INCLUDE DLT00000                                         02760000
027700     END-EXEC.                                                    02770000
027800                                                                  02780000
027900*    DOOR GROUP                                                   02790000
028000     EXEC SQL                                                     02800000
028100         INCLUDE DLT00001                                         02810000
028200     END-EXEC.                                                    02820000
028300                                                                  02830000
028400*    OUTBOUND / UPC ASSOCIATION                                   02840000
028500     EXEC SQL                                                     02850000
028600         INCLUDE SUT00028                                         02860000
028700     END-EXEC.                                                    02870000
028800                                                                  02880000
028900*  CONTAINS THE WHOLE GROUP INCLUDING THE PATRIARCH, HIS CHILDREN 02890000
029000*  AND ALL OF THE UNCLES.  IT DOESN'T CONTAIN THE UNCLES'         02900000
029100*  CHILDREN (COUSINS).                                            02910000
029200                                                                  02920000
029300*  GET ALL PARENTS THAT ARE AT OR BENEATH THE LEVEL OF THE GIVEN  02930000
029400     EXEC SQL DECLARE PARENT-CSR CURSOR WITH HOLD FOR             02940000
029500         SELECT UNT1.SHIPT_UNT_ID        AS PARENT                02950000
029600        ,       UNT2.SHIPT_UNT_ID        AS CHILD                 02960000
029700        ,       UNT2.CART_SRC_CDE                                 02970000
029800        ,       UNT2.MSTR_CART_IND                                02980000
029900         FROM   SUT_OTBND_CART UNT1                               02990000
030000               ,SUT_OTBND_CART UNT2                               03000000
030100         WHERE  UNT1.PRNT_CART_ID     = :PC233-CARTON             03010000
030200          AND  UNT2.PRNT_CART_ID      = UNT1.SHIPT_UNT_ID         03020000
030300          AND  UNT1.ACTV_IND          = 'Y'                       03030000
030400          AND  UNT2.ACTV_IND          = 'Y'                       03040000
030500*         AND  UNT2.MSTR_CART_IND     > '0'                       03050000
030600          AND  UNT2.MSTR_CART_IND     = 'Y'                       03060000
030700     ORDER BY                                                     03070000
030800          UNT2.SHIPT_UNT_ID                                       03080000
030900     END-EXEC.                                                    03090000
031000                                                                  03100000
031100                                                                  03110000
031200                                                                  03120000
031300*  GET ALL CHILDREN OF THE PARENTS IN THE PARENT-CSR              03130000
031400     EXEC SQL DECLARE CHILD-CSR CURSOR FOR                        03140000
031500         SELECT UNT1.SHIPT_UNT_ID                                 03150000
031600        ,       UNT1.MSTR_CART_IND                                03160000
031700         FROM   SUT_OTBND_CART UNT1                               03170000
031800         WHERE  UNT1.PRNT_CART_ID      = :SUT00024-SHIPT-UNT-ID   03180000
031900          AND   UNT1.SHIPT_UNT_ID     <> :PC233-CARTON            03190000
032000          AND   UNT1.ACTV_IND          = 'Y'                      03200000
032100          AND   UNT1.MSTR_CART_IND     = 'N'                      03210000
032200     END-EXEC                                                     03220000
032300/                                                                 03230000
032400     EXEC SQL                                                     03240000
032500         INCLUDE SQLCA                                            03250000
032600     END-EXEC.                                                    03260000
032700                                                                  03270000
032800 LINKAGE SECTION.                                                 03280000
032900 01  DFHCOMMAREA.                                                 03290000
033000     05  FILLER                         OCCURS  1 TO 4072 TIMES   03300000
033100                                      DEPENDING ON EIBCALEN.      03310000
033200         10  FILLER                   PIC X.                      03320000
033300/                                                                 03330000
033400 PROCEDURE DIVISION.                                              03340000
033500 0000-PROGRAM-MAINLINE.                                           03350000
033600                                                                  03360000
033700     INITIALIZE CA-COMMAREA                                       03370000
033800     MOVE DFHCOMMAREA                 TO CA-COMMAREA              03380000
033900                                                                  03390000
034000     EVALUATE TRUE                                                03400000
034100         WHEN EIBCALEN = ZERO                                     03410000
034200             MOVE PC-ENTER-THROUGH-MENU-MSG                       03420000
034300                                      TO PV-MESSAGE-AREA          03430000
034400             PERFORM 8110-RETURN                                  03440000
034500                                                                  03450000
034600         WHEN EIBTRNID = 'Z278'                                   03460000
034700*            RETURNING FROM F1 HELP INFO SCREEN                   03470000
034800             MOVE DFHCOMMAREA         TO PC192-COMMAREA           03480000
034900             MOVE PC192-HOST-SAVE-AREA                            03490000
035000                                      TO CA-COMMAREA              03500000
035100             SET PC233-PROCESS-SCREEN TO TRUE                     03510000
035200             MOVE PC192-HOST-SAVE-MAP TO PC879AO                  03520000
035300             PERFORM 8000-SEND-MAP                                03530000
035400             PERFORM 8100-RETURN-TRANID                           03540000
035500                                                                  03550000
035600         WHEN PC233-UPDATE-CONFIRMED                              03560000
035700             SET PS-ERRORS-NO                                     03570000
035800                 PC233-PROCESS-SCREEN TO TRUE                     03580000
035900             PERFORM 8400-GET-TIMESTAMP                           03590000
036000             IF PC233-SCAN-ON-CONTAINER                           03600000
036100                 PERFORM 3000-LOAD-DA-BOX                         03610000
036200                 PERFORM 7400-INSERT-WRKR-AUD                     03620000
036300             ELSE                                                 03630000
036400                 PERFORM 4000-UNLOAD-DA-BOX                       03640000
036500                 PERFORM 7400-INSERT-WRKR-AUD                     03650000
036600             END-IF                                               03660000
036700                                                                  03670000
036800             IF PS-ERRORS-YES                                     03680000
036900                 IF PS-XCTL-E871                                  03690000
037000                     PERFORM 8210-XCTL-ERROR-SCREEN               03700000
037100                 ELSE                                             03710000
037200                     PERFORM 8010-SEND-DATA-ONLY                  03720000
037300                     PERFORM 8100-RETURN-TRANID                   03730000
037400                 END-IF                                           03740000
037500             ELSE                                                 03750000
037600                 MOVE PC233-CARTON    TO ASMLO                    03760000
037700                 MOVE PC233-DOOR-ID   TO ADOORO                   03770000
037800                 MOVE PC233-STR-NBR   TO ADESTO                   03780000
037900                 MOVE PC233-SERIAL-NBR                            03790000
038000                                      TO ASERIALO                 03800000
038100                 MOVE PC233-OWNER-SCAC-ID                         03810000
038200                                      TO ASCACO                   03820000
038300                 MOVE PC233-TRAILER   TO ATRLRO                   03830000
038400                 PERFORM 0001-DETERMINE-MESSAGE                   03840000
038500                 PERFORM 8000-SEND-MAP                            03850000
038600                 PERFORM 8100-RETURN-TRANID                       03860000
038700             END-IF                                               03870000
038800                                                                  03880000
038900         WHEN PC233-INITIALIZE-SCREEN                             03890000
039000         WHEN EIBAID = DFHCLEAR                                   03900000
039100             PERFORM 1000-INITIALIZE                              03910000
039200             PERFORM 8000-SEND-MAP                                03920000
039300             PERFORM 8100-RETURN-TRANID                           03930000
039400                                                                  03940000
039500         WHEN EIBAID = DFHPF3                                     03950000
039600             MOVE PC233-MENU-PROGRAM  TO PV-TRANSFER-PROGRAM      03960000
039700             PERFORM 8200-XCTL                                    03970000
039800                                                                  03980000
039900         WHEN EIBAID = DFHPF4                                     03990000
040000*            TOGGLE BETWEEN LOAD AND UNLOAD                       04000000
040100             IF PC233-SCAN-OFF-CONTAINER                          04010000
040200                 MOVE ' SCAN ON CONTAINER'                        04020000
040300                                      TO ATITLEO                  04030000
040400                 MOVE 'F4-TURN SCAN OFF  ' TO ALEGENDO            04040000
040500                 MOVE SPACES          TO AMSGLNO                  04050000
040600                 SET PC233-SCAN-ON-CONTAINER                      04060000
040700                                      TO TRUE                     04070000
040800             ELSE                                                 04080000
040900                 MOVE ' SCAN OFF CONTAINER'                       04090000
041000                                      TO ATITLEO                  04100000
041100                 MOVE 'F4-TURN SCAN ON   ' TO ALEGENDO            04110000
041200                 MOVE SPACES          TO AMSGLNO                  04120000
041300                 SET PC233-SCAN-OFF-CONTAINER                     04130000
041400                                      TO TRUE                     04140000
041500             END-IF                                               04150000
041600             PERFORM 8010-SEND-DATA-ONLY                          04160000
041700             PERFORM 8100-RETURN-TRANID                           04170000
041800                                                                  04180000
041900         WHEN EIBAID = DFHPF8                                     04190000
042000             MOVE 'PCKRF880'          TO PV-TRANSFER-PROGRAM      04200000
042100             PERFORM 8200-XCTL                                    04210000
042200                                                                  04220000
042300         WHEN EIBAID = DFHPF9                                     04230000
042400             MOVE 'PCKRF743'          TO PV-TRANSFER-PROGRAM      04240000
042500             PERFORM 8200-XCTL                                    04250000
042600                                                                  04260000
042700         WHEN EIBAID = DFHENTER                                   04270000
042800*            EDIT ONLY                                            04280000
042900             PERFORM 8020-RECEIVE-MAP                             04290000
043000             PERFORM 2100-EDIT-INPUT                              04300000
043100             PERFORM 8400-GET-TIMESTAMP                           04310000
043200                                                                  04320000
043300             IF PS-ERRORS-NO                                      04330000
043400                 IF PC233-SCAN-ON-CONTAINER                       04340000
043500                     PERFORM 3000-LOAD-DA-BOX                     04350000
043600                 ELSE                                             04360000
043700                     PERFORM 4000-UNLOAD-DA-BOX                   04370000
043800                 END-IF                                           04380000
043900             END-IF                                               04390000
044000                                                                  04400000
044100             IF PS-ERRORS-YES                                     04410000
044200                 IF PS-XCTL-E871                                  04420000
044300                     PERFORM 8210-XCTL-ERROR-SCREEN               04430000
044400                 ELSE                                             04440000
044500                     PERFORM 8010-SEND-DATA-ONLY                  04450000
044600                     PERFORM 8100-RETURN-TRANID                   04460000
044700                 END-IF                                           04470000
044800             ELSE                                                 04480000
044900                 PERFORM 0001-DETERMINE-MESSAGE                   04490000
045000                 PERFORM 8010-SEND-DATA-ONLY                      04500000
045100                 PERFORM 8100-RETURN-TRANID                       04510000
045200             END-IF                                               04520000
045300                                                                  04530000
045400         WHEN EIBAID = DFHPF1                                     04540000
045500             PERFORM 8020-RECEIVE-MAP                             04550000
045600             MOVE PC879AO             TO PC192-HOST-SAVE-MAP      04560000
045700             PERFORM 1200-HELP-SCREEN                             04570000
045800                                                                  04580000
045900         WHEN OTHER                                               04590000
046000             PERFORM 8020-RECEIVE-MAP                             04600000
046100             MOVE PC-UNRECOGNIZED-PF-KEY-MSG                      04610000
046200                                      TO AMSGLNO                  04620000
046300             PERFORM 8000-SEND-MAP                                04630000
046400             PERFORM 8100-RETURN-TRANID                           04640000
046500     END-EVALUATE.                                                04650000
046600                                                                  04660000
046700     GOBACK.                                                      04670000
046800                                                                  04680000
046900 0001-DETERMINE-MESSAGE.                                          04690000
047000     IF PC233-SCAN-ON-CONTAINER                                   04700000
047100         EVALUATE TRUE                                            04710000
047200             WHEN PC233-PARENT                                    04720000
047300                 IF CA-DOOR-TYP-CDE = 'DS'                        04730000
047400                 OR CA-DOOR-TYP-CDE = 'ST'                        04740000
047500                     MOVE 'MASTER RETAINED'                       04750000
047600                                      TO AMSGLNO                  04760000
047700                 ELSE                                             04770000
047800                     MOVE 'MASTER DISSOLVED' TO AMSGLNO           04780000
047900                 END-IF                                           04790000
048000             WHEN PC233-CHILD                                     04800000
048100                 MOVE 'CHILD SCANNED' TO AMSGLNO                  04810000
048200             WHEN PC233-ORPHAN                                    04820000
048300                   MOVE 'CONTAINER SCANNED'                       04830000
048400                                      TO AMSGLNO                  04840000
048500         END-EVALUATE                                             04850000
048600     ELSE                                                         04860000
048700         EVALUATE TRUE                                            04870000
048800             WHEN PC233-PARENT                                    04880000
048900                 MOVE 'MASTER SCANNED OFF'                        04890000
049000                                      TO AMSGLNO                  04900000
049100             WHEN PC233-CHILD                                     04910000
049200                 MOVE 'CHILD SCANNED OFF'                         04920000
049300                                      TO AMSGLNO                  04930000
049400* DMH        WHEN PC233-ORPHAN                                    04940000
049500             WHEN OTHER                                           04950000
049600                 MOVE 'CONTNR SCANNED OFF'                        04960000
049700                                      TO AMSGLNO                  04970000
049800         END-EVALUATE                                             04980000
049900     END-IF.                                                      04990000
050000                                                                  05000000
050100 1000-INITIALIZE.                                                 05010000
050200                                                                  05020000
050300     INITIALIZE CA-REDEFINED-COMMAREA                             05030000
050400                PC233-CARTON                                      05040000
050500     MOVE PC233-DOOR-ID               TO ADOORO                   05050000
050600     MOVE PC233-STR-NBR               TO ADESTO                   05060000
050700     MOVE PC233-SERIAL-NBR            TO ASERIALO                 05070000
050800     MOVE PC233-OWNER-SCAC-ID         TO ASCACO                   05080000
050900     MOVE PC233-TRAILER               TO ATRLRO                   05090000
051000                                                                  05100000
051100*    IF RETURNING FROM THE ERROR MESSAGE SCREEN, LEAVE            05110000
051200*    THE PROCESSING MODE ALONE                                    05120000
051300*DMH IF EIBTRNID = 'E871'                                         05130000
051400*DMH     CONTINUE                                                 05140000
051500*DMH ELSE                                                         05150000
051600*DMH     SET PC233-SCAN-ON-CONTAINER  TO TRUE                     05160000
051700*DMH END-IF                                                       05170000
051800                                                                  05180000
051900     IF PC233-SCAN-ON-CONTAINER                                   05190000
052000         MOVE ' SCAN ON CONTAINER '   TO ATITLEO                  05200000
052100         MOVE 'F4-TURN SCAN OFF  '    TO ALEGENDO                 05210000
052200         MOVE SPACES                  TO AMSGLNO                  05220000
052300     ELSE                                                         05230000
052400         MOVE ' SCAN OFF CONTAINER'   TO ATITLEO                  05240000
052500         MOVE 'F4-TURN SCAN ON   '    TO ALEGENDO                 05250000
052600         MOVE SPACES                  TO AMSGLNO                  05260000
052700     END-IF                                                       05270000
052800                                                                  05280000
052900     MOVE PC233-MENU-PROGRAM          TO PV-TRANSFER-PROGRAM      05290000
053000     MOVE PC-TRANID                   TO PC233-TRAN-ID            05300000
053100     MOVE PC233-USER-ID               TO PV-USER-ID.              05310000
053200     SET PC233-PROCESS-SCREEN         TO TRUE.                    05320000
053300                                                                  05330000
053400 1200-HELP-SCREEN.                                                05340000
053500     MOVE 'DPKRF278'                  TO PV-TRANSFER-PROGRAM      05350000
053600     MOVE PC-CURRENT-PROGRAM-NAME     TO PC192-PROGRAM-NAME       05360000
053700     COPY PCPD188.                                                05370000
053800     MOVE PC188-DISPLAY-DATE          TO PC192-DISPLAY-DATE.      05380000
053900     MOVE CA-COMMAREA                 TO PC192-HOST-SAVE-AREA     05390000
054000     PERFORM 8220-XCTL-TO-HELP.                                   05400000
054100/                                                                 05410000
054200 2100-EDIT-INPUT.                                                 05420000
054300                                                                  05430000
054400     IF  ASMLL > ZERO                                             05440000
054500         MOVE ASMLI TO PV-CTN                                     05450000
054600     ELSE                                                         05460000
054700         IF ASMLA = DP015-ERASE-EOF                               05470000
054800             MOVE SPACES TO PV-CTN                                05480000
054900         END-IF                                                   05490000
055000     END-IF.                                                      05500000
055100                                                                  05510000
055200     PERFORM 2110-EDIT-CTN.                                       05520000
055300                                                                  05530000
055400     IF PS-VALID-INPUT                                            05540000
055500         SET PS-ERRORS-NO             TO TRUE                     05550000
055600         IF PC233-SCAN-ON-CONTAINER                               05560000
055700             PERFORM 2200-CHECK-TABLES-FOR-LOAD                   05570000
055800             MOVE SUOBTR-DOOR-TYP-CDE  TO CA-DOOR-TYP-CDE         05580000
055900         ELSE                                                     05590000
056000             PERFORM 2300-CHECK-TABLES-FOR-UNLOAD                 05600000
056100         END-IF                                                   05610000
056200     ELSE                                                         05620000
056300         PERFORM 8010-SEND-DATA-ONLY                              05630000
056400         PERFORM 8100-RETURN-TRANID                               05640000
056500     END-IF.                                                      05650000
056600                                                                  05660000
056700                                                                  05670000
056800 2110-EDIT-CTN.                                                   05680000
056900                                                                  05690000
057000     SET PS-VALID-INPUT               TO TRUE                     05700000
057100* BARCODE CAN BE EITHER 20 DIGITS OR 18 DIGITS WITHOUT            05710000
057200* THE LEADING 2 ZEROS                                             05720000
057300                                                                  05730000
057400     PERFORM VARYING PV-SUB FROM 1 BY 1                           05740000
057500             UNTIL PV-SUB > 20                                    05750000
057600                                                                  05760000
057700         EVALUATE TRUE                                            05770000
057800         WHEN PV-CTN-CHAR (PV-SUB) = ZERO                         05780000
057900             IF PV-SUB < 3                                        05790000
058000                 MOVE ZERO            TO PV-BARCODE-CHAR          05800000
058100                                         (PV-SUB)                 05810000
058200             ELSE                                                 05820000
058300                 MOVE '9'             TO PV-BARCODE-CHAR          05830000
058400                                         (PV-SUB)                 05840000
058500             END-IF                                               05850000
058600         WHEN PV-CTN-CHAR (PV-SUB) = '4'                          05860000
058700             IF PV-SUB < 4                                        05870000
058800                 MOVE '4'             TO PV-BARCODE-CHAR          05880000
058900                                         (PV-SUB)                 05890000
059000             ELSE                                                 05900000
059100                 MOVE '9'             TO PV-BARCODE-CHAR          05910000
059200                                         (PV-SUB)                 05920000
059300             END-IF                                               05930000
059400         WHEN PV-CTN-CHAR (PV-SUB) = SPACE                        05940000
059500             MOVE 'B'                 TO PV-BARCODE-CHAR          05950000
059600                                         (PV-SUB)                 05960000
059700         WHEN PV-CTN-CHAR (PV-SUB) NUMERIC                        05970000
059800             MOVE '9'                 TO PV-BARCODE-CHAR          05980000
059900                                         (PV-SUB)                 05990000
060000         WHEN OTHER                                               06000000
060100             MOVE 'X'                 TO PV-BARCODE-CHAR          06010000
060200                                         (PV-SUB)                 06020000
060300             MOVE 'MUST BE NUMERIC'   TO AMSGLNO                  06030000
060400         END-EVALUATE                                             06040000
060500     END-PERFORM.                                                 06050000
060600                                                                  06060000
060700                                                                  06070000
060800     INITIALIZE DK-BRCDE-NBR                                      06080000
060900                PV-CTN-18                                         06090000
061000                PC233-CARTON                                      06100000
061100                PC233-BRCDE-NBR                                   06110000
061200                AMSGLNO                                           06120000
061300     MOVE DP015-UNP-ALP-NOR-MDT       TO ASMLA.                   06130000
061400                                                                  06140000
061500     IF PV-VALID-BARCODE                                          06150000
061600         EVALUATE TRUE                                            06160000
061700             WHEN PV-2-LEAD-ZEROES                                06170000
061800                 MOVE PV-CTN (3:18)   TO PV-CTN-18                06180000
061900                 MOVE PV-CTN          TO DK-BRCDE-NBR             06190000
062000             WHEN PV-LEAD-TRAIL-SPACES                            06200000
062100                 MOVE PV-CTN (2:18)   TO PV-CTN-18                06210000
062200                 MOVE ZEROES          TO DK-BRCDE-NBR (1:2)       06220000
062300                 MOVE PV-CTN (2:18)   TO DK-BRCDE-NBR (3:18)      06230000
062400             WHEN PV-2-LEAD-SPACES                                06240000
062500                 MOVE PV-CTN (3:18)   TO PV-CTN-18                06250000
062600                 MOVE ZEROES          TO DK-BRCDE-NBR (1:2)       06260000
062700                 MOVE PV-CTN (3:18)   TO DK-BRCDE-NBR (3:18)      06270000
062800             WHEN PV-TRAIL-SPACES                                 06280000
062900                 MOVE PV-CTN (1:18)   TO PV-CTN-18                06290000
063000                 MOVE ZEROES          TO DK-BRCDE-NBR (1:2)       06300000
063100                 MOVE PV-CTN (1:18)   TO DK-BRCDE-NBR (3:18)      06310000
063200         END-EVALUATE                                             06320000
063300                                                                  06330000
063400                                                                  06340000
063500         MOVE PV-CTN-N                TO PC233-CARTON             06350000
063600         MOVE DK-BRCDE-NBR            TO PC233-BRCDE-NBR          06360000
063700         MOVE PC233-BRCDE-NBR (6:4)   TO PC233-STR-NBR            06370000
063800         MOVE PC233-BRCDE-NBR (5:1)   TO                          06380000
063900                             PC233-SEASET-DIVERT-PFX-NBR          06390000
064000         MOVE PC233-CARTON            TO ASMLO                    06400000
064100                                                                  06410000
064200     ELSE                                                         06420000
064300         SET PS-INVALID-INPUT         TO TRUE                     06430000
064400         MOVE DP015-UNP-ALP-NOR-MDT   TO ASMLA                    06440000
064500         MOVE -1                      TO ASMLL                    06450000
064600                                                                  06460000
064700         MOVE PV-CTN                  TO ASMLO                    06470000
064800         MOVE 'INVALID CTN ID      '  TO AMSGLNO                  06480000
064900     END-IF.                                                      06490000
065000/                                                                 06500000
065100 2200-CHECK-TABLES-FOR-LOAD.                                      06510000
065200                                                                  06520000
065300     PERFORM 2205-CHECK-IF-LOADED                                 06530000
065400                                                                  06540000
065500     IF PS-ERRORS-NO                                              06550000
065600         PERFORM 8300-LINK-TO-STATUS-MODULE                       06560000
065700     END-IF.                                                      06570000
065800                                                                  06580000
065900     IF PS-ERRORS-NO                                              06590000
066000         IF ((PC046-SCANNED-ONTO-TRLR OR                          06600000
066100             PC046-LOADED-ONTO-TRLR)  AND                         06610000
066200             (PC046-TRIP-STATUS  = 'SO'  OR                       06620000
066300              PC046-TRIP-STATUS  = 'SU'  OR                       06630000
066400              PC046-TRIP-STATUS  = 'DR'  OR                       06640000
066500              PC046-TRIP-STATUS  = 'AR')                          06650000
066600             )                                                    06660000
066700            CONTINUE                                              06670000
066800         ELSE                                                     06680000
066900            IF PC046-SCANNED-ONTO-TRLR OR                         06690000
067000               PC046-LOADED-ONTO-TRLR                             06700000
067100                    SET PS-ERRORS-YES    TO TRUE                  06710000
067200                    MOVE PC046-OTBD-TRIP-ID                       06720000
067300                                         TO PC233-ERROR-TRIP-ID   06730000
067400                    MOVE PC046-SCAC      TO PC233-ERROR-SCAC-ID   06740000
067500                    MOVE PC046-TRLR-ID   TO PC233-ERROR-TRLR-ID   06750000
067600                    MOVE 14              TO PC233-PGM-MSG-NBR     06760000
067700                    SET PS-XCTL-E871     TO TRUE                  06770000
067800            END-IF                                                06780000
067900         END-IF                                                   06790000
068000     END-IF.                                                      06800000
068100                                                                  06810000
068200* ONLY VALIDATE CARTON DESTINATION AND TRAILER DESTINATION FOR    06820000
068300* SHIPPING TRAILERS                                               06830000
068400                                                                  06840000
068500                                                                  06850000
068600     IF PS-ERRORS-NO                                              06860000
068700         PERFORM 7020-SELECT-TSUOBTR                              06870000
068800         IF  SUOBTR-DOOR-TYP-CDE  =  'SH'                         06880000
068900             IF PC046-DEST-OPER-UNT-ID = SUOBTR-DEST-OPER-UNT-ID  06890000
069000                 CONTINUE                                         06900000
069100             ELSE                                                 06910000
069200*                SPECIAL MESSAGE FOR INACTIVE MASTER CARTONS      06920000
069300*                WITH NO ACTIVE DIVERTS                           06930000
069400                 IF SUT00024-CART-SRC-CDE = 'MST'                 06940000
069500                        AND PS-SUCRDV-NO AND                      06950000
069600                        PC046-INACTIVATED                         06960000
069700                     SET PS-ERRORS-YES TO TRUE                    06970000
069800                     MOVE PC046-DEST-OPER-UNT-ID                  06980000
069900                                      TO PC233-ERROR-CTN-STR-NBR  06990000
070000                     MOVE PC233-TRIP-ID   TO PC233-ERROR-TRIP-ID  07000000
070100                     MOVE PC233-OWNER-SCAC-ID                     07010000
070200                                      TO PC233-ERROR-SCAC-ID      07020000
070300                     MOVE PC233-SERIAL-NBR                        07030000
070400                                      TO PC233-ERROR-SRL-NBR      07040000
070500                     MOVE SUOBTR-DEST-OPER-UNT-ID                 07050000
070600                                      TO PC233-ERROR-TRLR-STR-NBR 07060000
070700                     MOVE 42          TO PC233-PGM-MSG-NBR        07070000
070800                     SET PS-XCTL-E871 TO TRUE                     07080000
070900                 ELSE                                             07090000
071000                     SET PS-ERRORS-YES TO TRUE                    07100000
071100                     MOVE PC046-DEST-OPER-UNT-ID                  07110000
071200                                      TO PC233-ERROR-CTN-STR-NBR  07120000
071300                     MOVE PC233-TRIP-ID   TO PC233-ERROR-TRIP-ID  07130000
071400                     MOVE PC233-OWNER-SCAC-ID                     07140000
071500                                      TO PC233-ERROR-SCAC-ID      07150000
071600                     MOVE PC233-SERIAL-NBR                        07160000
071700                                      TO PC233-ERROR-SRL-NBR      07170000
071800                     MOVE SUOBTR-DEST-OPER-UNT-ID                 07180000
071900                                      TO PC233-ERROR-TRLR-STR-NBR 07190000
072000                     MOVE 15          TO PC233-PGM-MSG-NBR        07200000
072100                     SET PS-XCTL-E871 TO TRUE                     07210000
072200                 END-IF                                           07220000
072300             END-IF                                               07230000
072400         END-IF                                                   07240000
072500     END-IF.                                                      07250000
072600                                                                  07260000
072700     IF PS-ERRORS-NO                                              07270000
072800     EVALUATE TRUE                                                07280000
072900     WHEN SUT00024-MSTR-CART-IND NOT = 'N'                        07290000
073000         MOVE SUT00024-SHIPT-UNT-ID   TO                          07300000
073100                            PC233-ERROR-MSTR-CARTON               07310000
073200         PERFORM 2230-COUNT-KIDS                                  07320000
073300         SET PS-ERRORS-YES                                        07330000
073400             PC233-PARENT             TO TRUE                     07340000
073500         MOVE SUT00027-OTBND-TRIP-ID  TO PC233-ERROR-TRIP-ID      07350000
073600         MOVE CNTRID-SCAC-CDE         TO PC233-ERROR-SCAC-ID      07360000
073700         MOVE CNTRID-TRLR-SRL-NBR     TO PC233-ERROR-SRL-NBR      07370000
073800         MOVE 16                      TO PC233-PGM-MSG-NBR        07380000
073900         SET PS-XCTL-E871             TO TRUE                     07390000
074000     WHEN SUT00024-PRNT-CART-ID NOT = SUT00024-SHIPT-UNT-ID       07400000
074100*    CHILD                                                        07410000
074200         SET PS-ERRORS-YES                                        07420000
074300             PC233-CHILD              TO TRUE                     07430000
074400         PERFORM 2240-FIND-THE-PAPA                               07440000
074500         MOVE SUT00027-OTBND-TRIP-ID  TO PC233-ERROR-TRIP-ID      07450000
074600         MOVE CNTRID-SCAC-CDE         TO PC233-ERROR-SCAC-ID      07460000
074700         MOVE CNTRID-TRLR-SRL-NBR     TO PC233-ERROR-SRL-NBR      07470000
074800         MOVE 17                      TO PC233-PGM-MSG-NBR        07480000
074900         SET PS-XCTL-E871             TO TRUE                     07490000
075000     WHEN OTHER                                                   07500000
075100         SET PC233-ORPHAN             TO TRUE                     07510000
075200     END-EVALUATE                                                 07520000
075300     END-IF.                                                      07530000
075400                                                                  07540000
075500*    IF THE TRAILER IS AT A SHIPPING DOOR, CHECK TO SEE IF        07550000
075600*    THE CARTON IS PART OF A SEASONAL SET SHIPMENT AND THEN       07560000
075700*    IS IT TOO EARLY TO BE SENDING GOODS FOR THAT SEASONAL        07570000
075800*    SET.                                                         07580000
075900     IF  SUOBTR-DOOR-TYP-CDE  =  'SH'                             07590000
076000         IF PS-ERRORS-NO                                          07600000
076100             PERFORM 2210-CHECK-SEASONAL-SET                      07610000
076200         END-IF                                                   07620000
076300     END-IF.                                                      07630000
076400                                                                  07640000
076500 2205-CHECK-IF-LOADED.                                            07650000
076600                                                                  07660000
076700*    PERFORM 7180-SELECT-OTBND-CART.                              07670000
076800     PERFORM 5000-GET-CARTON-INFO.                                07680000
076900                                                                  07690000
077000     IF SUT00024-ACTV-IND = 'N'                                   07700000
077100         IF SUT00024-CART-SRC-CDE = 'MST'                         07710000
077200             IF PS-SUCRDV-NO                                      07720000
077300                 CONTINUE                                         07730000
077400             ELSE                                                 07740000
077500                 SET PS-ERRORS-YES            TO TRUE             07750000
077600                 MOVE 'INACTIVE MASTER   '                        07760000
077700                                      TO AMSGLNO                  07770000
077800             END-IF                                               07780000
077900         ELSE                                                     07790000
078000                 SET PS-ERRORS-YES            TO TRUE             07800000
078100             MOVE ' INACTIVE CARTON  '                            07810000
078200                                      TO AMSGLNO                  07820000
078300         END-IF                                                   07830000
078400     ELSE                                                         07840000
078500         PERFORM 7190-SELECT-OTBND-LOC                            07850000
078600         IF SUT00027-SCN-CDE = 'SHON'                             07860000
078700             IF PV-SCAN-ON-TRIP-ID = PC233-TRIP-ID                07870000
078800                 MOVE 'CTN ALREADY SCANED'                        07880000
078900                                      TO AMSGLNO                  07890000
079000                 SET PS-ERRORS-YES    TO TRUE                     07900000
079100             ELSE                                                 07910000
079200                 PERFORM 2250-PUT-CTN-ON-RIGHT-TRIP               07920000
079300         END-IF                                                   07930000
079400     END-IF.                                                      07940000
079500                                                                  07950000
079600 2210-CHECK-SEASONAL-SET.                                         07960000
079700     PERFORM 7000-SELECT-TSEASET.                                 07970000
079800     IF SQLCODE = ZERO                                            07980000
079900         PERFORM 7001-TEST-THE-DATE                               07990000
080000         IF PV-DATE-DURATION > ZERO                               08000000
080100*           SEASONAL SET CARTON SHOULD NOT BE SCANNED ON YET      08010000
080200             SET PS-ERRORS-YES                                    08020000
080300                 PS-XCTL-E871         TO TRUE                     08030000
080400             MOVE 44                  TO PC233-PGM-MSG-NBR        08040000
080500             MOVE PV-SEASET-RELEASE-DISP-DATE                     08050000
080600                          TO PC233-SEASET-STR-RLSE-BEG-DTE        08060000
080700         END-IF                                                   08070000
080800     END-IF.                                                      08080000
080900                                                                  08090000
081000 2230-COUNT-KIDS.                                                 08100000
081100     MOVE ZERO                        TO PV-KIDS-COUNT            08110000
081200     PERFORM 7030-COUNT-OTBND-CART.                               08120000
081300     SET PS-ERRORS-YES                TO TRUE                     08130000
081400     MOVE PC233-TRIP-ID               TO PC233-ERROR-TRIP-ID      08140000
081500     MOVE PC233-OWNER-SCAC-ID         TO PC233-ERROR-SCAC-ID      08150000
081600     MOVE PC233-SERIAL-NBR            TO PC233-ERROR-SRL-NBR      08160000
081700     MOVE 16                          TO PC233-PGM-MSG-NBR        08170000
081800     SET PS-XCTL-E871                 TO TRUE.                    08180000
081900                                                                  08190000
082000 2240-FIND-THE-PAPA.                                              08200000
082100     MOVE PC233-CARTON                TO DK-FIND-CARTON           08210000
082200     PERFORM UNTIL DK-PARENT-SHIPT-UNT-ID =                       08220000
082300                   SUT00024-PRNT-CART-ID                          08230000
082400             OR SQLCODE = +100                                    08240000
082500             OR PV-SHIPT-UNT-SRC-ID = 'MST'                       08250000
082600         PERFORM 7040-SELECT-OTBND-CART                           08260000
082700         IF SQLCODE = ZERO                                        08270000
082800             MOVE DK-PARENT-SHIPT-UNT-ID                          08280000
082900                                      TO DK-FIND-CARTON           08290000
083000                                         PC233-ERROR-MSTR-CARTON  08300000
083100         END-IF                                                   08310000
083200     END-PERFORM.                                                 08320000
083300                                                                  08330000
083400 2250-PUT-CTN-ON-RIGHT-TRIP.                                      08340000
083500     PERFORM 7300-SCAN-OFF-PREV-TRLR.                             08350000
083600                                                                  08360000
083700     IF PS-ERRORS-NO                                              08370000
083800         PERFORM 7310-INACT-PREV-SCAN-ON                          08380000
083900     END-IF.                                                      08390000
084000/                                                                 08400000
084100 2300-CHECK-TABLES-FOR-UNLOAD.                                    08410000
084200     IF PS-ERRORS-NO                                              08420000
084300         PERFORM 2310-IS-THIS-A-MASTER                            08430000
084400     END-IF.                                                      08440000
084500                                                                  08450000
084600     IF PS-ERRORS-NO                                              08460000
084700         PERFORM 8300-LINK-TO-STATUS-MODULE                       08470000
084800     END-IF.                                                      08480000
084900                                                                  08490000
085000     IF PS-ERRORS-NO                                              08500000
085100         EVALUATE TRUE                                            08510000
085200         WHEN PC046-SCANNED-OFF-TRLR                              08520000
085300             MOVE PC046-CRTN-STAT-DESC                            08530000
085400                                      TO AMSGLNO                  08540000
085500             SET PS-ERRORS-YES        TO TRUE                     08550000
085600         WHEN PC046-SCANNED-ONTO-TRLR                             08560000
085700         WHEN PC046-LOADED-ONTO-TRLR                              08570000
085800             IF PC046-TRLR-SRL = PC233-SERIAL-NBR                 08580000
085900                 CONTINUE                                         08590000
086000             ELSE                                                 08600000
086100                 SET PS-ERRORS-YES    TO TRUE                     08610000
086200                 MOVE PC046-OTBD-TRIP-ID                          08620000
086300                                      TO PC233-ERROR-TRIP-ID      08630000
086400                 MOVE PC046-SCAC      TO PC233-ERROR-SCAC-ID      08640000
086500                 MOVE PC046-TRLR-SRL  TO PC233-ERROR-SRL-NBR      08650000
086600                 MOVE 14              TO PC233-PGM-MSG-NBR        08660000
086700                 SET PS-XCTL-E871     TO TRUE                     08670000
086800             END-IF                                               08680000
086900         WHEN PC046-DIVERTED-TO-TRLR                              08690000
087000             IF PC046-DOOR-ID = PC233-DOOR-ID                     08700000
087100                 CONTINUE                                         08710000
087200             ELSE                                                 08720000
087300                 MOVE 'CTN NOT SCANNED ON'                        08730000
087400                                          TO AMSGLNO              08740000
087500                 SET PS-ERRORS-YES        TO TRUE                 08750000
087600             END-IF                                               08760000
087700         WHEN OTHER                                               08770000
087800             MOVE 'CTN NOT SCANNED ON'                            08780000
087900                                      TO AMSGLNO                  08790000
088000             SET PS-ERRORS-YES        TO TRUE                     08800000
088100         END-EVALUATE                                             08810000
088200     END-IF.                                                      08820000
088300                                                                  08830000
088400                                                                  08840000
088500 2310-IS-THIS-A-MASTER.                                           08850000
088600                                                                  08860000
088700*    PERFORM 7180-SELECT-OTBND-CART.                              08870000
088800     PERFORM 5000-GET-CARTON-INFO.                                08880000
088900     IF SUT00024-CART-SRC-CDE = 'MST'                             08890000
089000         SET PS-ERRORS-YES            TO TRUE                     08900000
089100         MOVE SUT00027-OTBND-TRIP-ID  TO PC233-ERROR-TRIP-ID      08910000
089200         MOVE CNTRID-SCAC-CDE         TO PC233-ERROR-SCAC-ID      08920000
089300         MOVE CNTRID-TRLR-SRL-NBR     TO PC233-ERROR-SRL-NBR      08930000
089400         MOVE 19                      TO PC233-PGM-MSG-NBR        08940000
089500         SET PS-XCTL-E871             TO TRUE                     08950000
089600     END-IF.                                                      08960000
089700/                                                                 08970000
089800 3000-LOAD-DA-BOX.                                                08980000
089900                                                                  08990000
090000     EVALUATE TRUE                                                09000000
090100         WHEN PC233-PARENT                                        09010000
090200             AND CA-DOOR-TYP-CDE NOT = 'DS'                       09020000
090300             AND CA-DOOR-TYP-CDE NOT = 'ST'                       09030000
090400             PERFORM 3100-LOAD-PARENT-AND-KIDS                    09040000
090500***              MOVE 'MASTER SCANNED ON' TO AMSGLNO              09050000
090600         WHEN PC233-CHILD                                         09060000
090700             PERFORM 3200-LOAD-ONE-KID                            09070000
090800                 MOVE 'CHILD SCANNED OFF'  TO AMSGLNO             09080000
090900         WHEN PC233-ORPHAN                                        09090000
091000             OR CA-DOOR-TYP-CDE = 'DS'                            09100000
091100             OR CA-DOOR-TYP-CDE = 'ST'                            09110000
091200             IF CA-OTBND-CART-NO                                  09120000
091300                 MOVE CA-VENDOR-CARTON                            09130000
091400                                      TO SUT00024-SHIPT-UNT-ID    09140000
091500             ELSE                                                 09150000
091600                 MOVE PC233-CARTON    TO SUT00024-SHIPT-UNT-ID    09160000
091700             END-IF                                               09170000
091800             MOVE 'SHON'              TO SUT00027-SCN-CDE         09180000
091900             MOVE 'A'                 TO SUT00027-ACTV-CDE        09190000
092000             PERFORM 4200-MANAGE-ASSIGNMENTS                      09200000
092100             PERFORM 7150-INSERT-OTBND-LOC                        09210000
092200             PERFORM 7200-INACT-DIVERTER-CTN                      09220000
092300             IF PC233-P4-INTERFACE-YES                            09230000
092400                PERFORM 5200-CALL-XLKUP033                        09240000
092500             END-IF                                               09250000
092600     END-EVALUATE.                                                09260000
092700                                                                  09270000
092800 3100-LOAD-PARENT-AND-KIDS.                                       09280000
092900                                                                  09290000
093000*    PERFORM 7180-SELECT-OTBND-CART                               09300000
093100     PERFORM 5000-GET-CARTON-INFO.                                09310000
093200                                                                  09320000
093300     EVALUATE TRUE                                                09330000
093400     WHEN PC233-ERROR-KID-COUNT = ZERO                            09340000
093500*        PARENT WITHOUT ANY CHILDREN (AN EMPTY PALLET)            09350000
093600         MOVE PC233-ERROR-MSTR-CARTON TO SUT00024-SHIPT-UNT-ID    09360000
093700         PERFORM 7160-INACTIVATE-AND-UNHOOK                       09370000
093800                                                                  09380000
093900     WHEN SUT00024-SHIPT-UNT-ID NOT = SUT00024-PRNT-CART-ID       09390000
094000*        PARENT THAT IS A CHILD OF ANOTHER PARENT                 09400000
094100*        (A BOX OF POLYBAGS ON A PALLET)                          09410000
094200         PERFORM 5400-FIND-CONTAINER-INFO                         09420000
094300         PERFORM 7160-INACTIVATE-AND-UNHOOK                       09430000
094400         MOVE 'SHON'                  TO SUT00027-SCN-CDE         09440000
094500         MOVE 'I'                     TO SUT00027-ACTV-CDE        09450000
094600         PERFORM 4200-MANAGE-ASSIGNMENTS                          09460000
094700         PERFORM 7150-INSERT-OTBND-LOC                            09470000
094800         PERFORM 7200-INACT-DIVERTER-CTN                          09480000
094900         IF PC233-P4-INTERFACE-YES                                09490000
095000            PERFORM 5200-CALL-XLKUP033                            09500000
095100         END-IF                                                   09510000
095200         PERFORM 7100-OPEN-CHILD-CSR                              09520000
095300         PERFORM 7110-FETCH-CHILD-CSR                             09530000
095400         PERFORM UNTIL PS-END-OF-KIDS                             09540000
095500             MOVE 'SHON'              TO SUT00027-SCN-CDE         09550000
095600             MOVE 'A'                 TO SUT00027-ACTV-CDE        09560000
095700             PERFORM 7150-INSERT-OTBND-LOC                        09570000
095800             PERFORM 7170-UNHOOK-FROM-PARENT                      09580000
095900*             DRS CHG 12/06/2007                                  09590000
096000             IF SUT00024-MSTR-CART-IND = 'Y'                      09600000
096100                 PERFORM 7200-INACT-DIVERTER-CTN                  09610000
096200             ELSE                                                 09620000
096300                 PERFORM 7201-INACT-DIVERTER-CTN-CHILD            09630000
096400             END-IF                                               09640000
096500*            DRS CHG 12/06/2007                                   09650000
096600             PERFORM 7200-INACT-DIVERTER-CTN                      09660000
096700             PERFORM 7110-FETCH-CHILD-CSR                         09670000
096800         END-PERFORM                                              09680000
096900         PERFORM 7120-CLOSE-CHILD-CSR                             09690000
097000                                                                  09700000
097100     WHEN OTHER                                                   09710000
097200*        PARENT WITH CHILDREN (A LOADED PALLET)                   09720000
097300         PERFORM 7130-OPEN-PARENT-CSR                             09730000
097400         PERFORM 7140-FETCH-PARENT-CSR                            09740000
097500         PERFORM 3110-PROCESS-THIS-PARENT                         09750000
097600             UNTIL PS-END-OF-PARENTS                              09760000
097700         PERFORM 7145-CLOSE-PARENT-CSR                            09770000
097710*                                                                 09771000
097720* DMH - ADDED 4/3/06 - BEGIN                                      09772000
097721         PERFORM 4200-MANAGE-ASSIGNMENTS                          09772100
097722                                                                  09772200
097723         IF PC233-P4-INTERFACE-YES                                09772300
097724            PERFORM 5200-CALL-XLKUP033                            09772400
097725         END-IF                                                   09772500
097726* DMH - ADDED 4/3/06 - END                                        09772600
097727*                                                                 09772700
097728                                                                  09772800
097729     END-EVALUATE.                                                09772900
097730                                                                  09773000
097740 3110-PROCESS-THIS-PARENT.                                        09774000
097750     IF SUT00024-CART-SRC-CDE = 'MST'                             09775000
097760                                                                  09776000
097770         PERFORM 5400-FIND-CONTAINER-INFO                         09777000
097780         PERFORM 5410-FIND-MASTER-INFO                            09778000
097790         PERFORM 7160-INACTIVATE-AND-UNHOOK                       09779000
097800                                                                  09780000
097900         MOVE 'SHON'                  TO SUT00027-SCN-CDE         09790000
098000         MOVE 'I'                     TO SUT00027-ACTV-CDE        09800000
098100*                                                                 09810000
098200* DMH - DELETE - 4/3/06                                           09820000
098300*        PERFORM 4200-MANAGE-ASSIGNMENTS                          09830000
098400*                                                                 09840000
098500                                                                  09850000
098600         PERFORM 7150-INSERT-OTBND-LOC                            09860000
098700                                                                  09870000
098800*                                                                 09880000
098900* DMH - DELETE - 4/3/06                                           09890000
099000*        IF PC233-P4-INTERFACE-YES                                09900000
099100*           PERFORM 5200-CALL-XLKUP033                            09910000
099200*        END-IF                                                   09920000
099210*                                                                 09921000
099220                                                                  09922000
099230         PERFORM 7200-INACT-DIVERTER-CTN                          09923000
099240                                                                  09924000
099250*        PROCESS ALL CHILDREN OF THIS PARENT                      09925000
099260         PERFORM 7100-OPEN-CHILD-CSR                              09926000
099270         PERFORM 7110-FETCH-CHILD-CSR                             09927000
099280                                                                  09928000
099290*        LOAD THE COUSINS HERE                                    09929000
099300         PERFORM UNTIL PS-END-OF-KIDS                             09930000
099400             MOVE 'SHON'              TO SUT00027-SCN-CDE         09940000
099500             MOVE 'A'                 TO SUT00027-ACTV-CDE        09950000
099600             PERFORM 7150-INSERT-OTBND-LOC                        09960000
099700             PERFORM 7170-UNHOOK-FROM-PARENT                      09970000
099800*             DRS CHG 12/06/2007                                  09980000
099900             IF SUT00024-MSTR-CART-IND = 'Y'                      09990000
100000                 PERFORM 7200-INACT-DIVERTER-CTN                  10000000
100100             ELSE                                                 10010000
100200                 PERFORM 7201-INACT-DIVERTER-CTN-CHILD            10020000
100300             END-IF                                               10030000
100400*            DRS CHG 12/06/2007                                   10040000
100500             PERFORM 7110-FETCH-CHILD-CSR                         10050000
100600         END-PERFORM                                              10060000
100700         PERFORM 7120-CLOSE-CHILD-CSR                             10070000
100800     ELSE                                                         10080000
100900         MOVE 'SHON'                  TO SUT00027-SCN-CDE         10090000
101000         MOVE 'A'                     TO SUT00027-ACTV-CDE        10100000
101100         PERFORM 4200-MANAGE-ASSIGNMENTS                          10110000
101200         PERFORM 7150-INSERT-OTBND-LOC                            10120000
101300         PERFORM 7170-UNHOOK-FROM-PARENT                          10130000
101400*  DRS CHG 12/06/2007                                             10140000
101410         IF SUT00024-MSTR-CART-IND = 'Y'                          10141000
101420             PERFORM 7200-INACT-DIVERTER-CTN                      10142000
101430         ELSE                                                     10143000
101440             PERFORM 7201-INACT-DIVERTER-CTN-CHILD                10144000
101450         END-IF                                                   10145000
101460*  DRS CHG 12/06/2007                                             10146000
101470         IF PC233-P4-INTERFACE-YES                                10147000
101480            PERFORM 5200-CALL-XLKUP033                            10148000
101490         END-IF                                                   10149000
101500     END-IF.                                                      10150000
101600                                                                  10160000
101700     PERFORM 7140-FETCH-PARENT-CSR.                               10170000
101800                                                                  10180000
101900                                                                  10190000
102000 3200-LOAD-ONE-KID.                                               10200000
102100     MOVE PC233-CARTON                TO SUT00024-SHIPT-UNT-ID    10210000
102200     MOVE 'SHON'                      TO SUT00027-SCN-CDE         10220000
102300     MOVE 'A'                         TO SUT00027-ACTV-CDE        10230000
102400     PERFORM 4200-MANAGE-ASSIGNMENTS.                             10240000
102500     PERFORM 7150-INSERT-OTBND-LOC                                10250000
102600     PERFORM 7170-UNHOOK-FROM-PARENT                              10260000
102700     PERFORM 7200-INACT-DIVERTER-CTN                              10270000
102800     IF PC233-P4-INTERFACE-YES                                    10280000
102900        PERFORM 5200-CALL-XLKUP033                                10290000
103000     END-IF                                                       10300000
103100     PERFORM 7030-COUNT-OTBND-CART                                10310000
103200                                                                  10320000
103300     IF PC233-ERROR-KID-COUNT = ZERO                              10330000
103400         PERFORM 3205-INACT-THE-MASTER                            10340000
103500     END-IF.                                                      10350000
103600                                                                  10360000
103700                                                                  10370000
103800 3205-INACT-THE-MASTER.                                           10380000
103900     MOVE PC233-ERROR-MSTR-CARTON     TO SUT00024-SHIPT-UNT-ID    10390000
104000     PERFORM 7160-INACTIVATE-AND-UNHOOK.                          10400000
104100                                                                  10410000
104200                                                                  10420000
104300 4000-UNLOAD-DA-BOX.                                              10430000
104400                                                                  10440000
104500     PERFORM 7200-INACT-DIVERTER-CTN.                             10450000
104600                                                                  10460000
104700* DMH 9/19/02                                                     10470000
104800     IF CA-OTBND-CART-NO                                          10480000
104900         MOVE CA-VENDOR-CARTON                                    10490000
105000                              TO SUT00027-SHIPT-UNT-ID            10500000
105100     ELSE                                                         10510000
105200         MOVE PC233-CARTON    TO SUT00027-SHIPT-UNT-ID            10520000
105300     END-IF                                                       10530000
105400* DMH 9/19/02                                                     10540000
105500                                                                  10550000
105600     PERFORM 7210-INACT-CURRENT-SHUNLO.                           10560000
105700     IF  PC233-SCAN-OFF-CONTAINER AND                             10570000
105800         CA-OTBND-CART-NO                                         10580000
105900         CONTINUE                                                 10590000
106000     ELSE                                                         10600000
106100         IF CA-OTBND-CART-NO                                      10610000
106200             MOVE CA-VENDOR-CARTON                                10620000
106300                                  TO SUT00024-SHIPT-UNT-ID        10630000
106400         ELSE                                                     10640000
106500             MOVE PC233-CARTON    TO SUT00024-SHIPT-UNT-ID        10650000
106600         END-IF                                                   10660000
106700         MOVE 'SHOF'              TO SUT00027-SCN-CDE             10670000
106800         MOVE 'I'                 TO SUT00027-ACTV-CDE            10680000
106900         PERFORM 4200-MANAGE-ASSIGNMENTS                          10690000
107000         PERFORM 7150-INSERT-OTBND-LOC                            10700000
107100         IF PC233-P4-INTERFACE-YES                                10710000
107200            PERFORM 5200-CALL-XLKUP033                            10720000
107300         END-IF                                                   10730000
107400     END-IF.                                                      10740000
107500                                                                  10750000
107600                                                                  10760000
107700****************************************************************  10770000
107800*    DETERMINES WHETHER INTERFACING OF MANAGING OF ASSIGNMENTS *  10780000
107900*    NEEDS TO BE DONE.                                         *  10790000
108000****************************************************************  10800000
108100 4200-MANAGE-ASSIGNMENTS.                                         10810000
108200                                                                  10820000
108300     EVALUATE TRUE                                                10830000
108400         WHEN PC233-P4-INTERFACE-YES                              10840000
108500              PERFORM 4300-FIND-DOOR-GROUP                        10850000
108600                                                                  10860000
108700         WHEN PC233-P4-INTERFACE-NO                               10870000
108800              CONTINUE                                            10880000
108900                                                                  10890000
109000         WHEN OTHER                                               10900000
109100              PERFORM 4400-SELECT-TKRPRPM-DLSHPI                  10910000
109200                                                                  10920000
109300              IF PC233-P4-INTERFACE-YES                           10930000
109400                 PERFORM 4300-FIND-DOOR-GROUP                     10940000
109500              END-IF                                              10950000
109600                                                                  10960000
109700     END-EVALUATE.                                                10970000
109800                                                                  10980000
109900****************************************************************  10990000
110000*    PC233-DOOR-ID IS THE DOOR NUMBER THAT THEY ARE WORKING AT.*  11000000
110100*          IF IT IS EQUAL TO THE PC233-P4-DOOR-ID, THEN WE     *  11010000
110200*          ARE DONE BECAUSE AN ASSIGNMENT HAS ALREADY BEEN     *  11020000
110300*          ESTABLISHED.                                        *  11030000
110400****************************************************************  11040000
110500 4300-FIND-DOOR-GROUP.                                            11050000
110600                                                                  11060000
110700     IF PC233-P4-DOOR-ID = PC233-DOOR-ID                          11070000
110800        INITIALIZE DL001-ASGMT-COMMAREA                           11080000
110900                                                                  11090000
111000        MOVE PC233-ASGMT-STRT-DTE   TO                            11100000
111100                                   DL001-KEY-START-DTE            11110000
111200        MOVE PC233-ASGMT-NBR-TXT    TO                            11120000
111300                                   DL001-KEY-NBR-TXT              11130000
111400        MOVE PC233-ASGMT-NBR-SEQ-NBR TO                           11140000
111500                                   DL001-KEY-NBR-SEQ-NBR          11150000
111600        PERFORM 4800-CALL-DLKUP001                                11160000
111700        IF DL001-ASGMT-CLOSED-RETURN                              11170000
111800            PERFORM 4500-DETERMINE-DOOR-GROUP                     11180000
111900            PERFORM 4600-CALL-DLKCS410                            11190000
112000            PERFORM 4800-CALL-DLKUP001                            11200000
112100        END-IF                                                    11210000
112200     ELSE                                                         11220000
112300        PERFORM 4500-DETERMINE-DOOR-GROUP                         11230000
112400                                                                  11240000
112500        IF PS-DOOR-GROUP-FOUND-YES                                11250000
112600           IF DLT00001-DOOR-GP-NBR =                              11260000
112700                                    PC233-P4-DOOR-GP-NBR          11270000
112800              MOVE PC233-DOOR-ID TO PC233-P4-DOOR-ID              11280000
112900              INITIALIZE DL001-ASGMT-COMMAREA                     11290000
113000                                                                  11300000
113100              MOVE PC233-ASGMT-STRT-DTE   TO                      11310000
113200                                         DL001-KEY-START-DTE      11320000
113300              MOVE PC233-ASGMT-NBR-TXT    TO                      11330000
113400                                         DL001-KEY-NBR-TXT        11340000
113500              MOVE PC233-ASGMT-NBR-SEQ-NBR TO                     11350000
113600                                         DL001-KEY-NBR-SEQ-NBR    11360000
113700              PERFORM 4800-CALL-DLKUP001                          11370000
113800              IF DL001-ASGMT-CLOSED-RETURN                        11380000
113900                 PERFORM 4500-DETERMINE-DOOR-GROUP                11390000
114000                 PERFORM 4600-CALL-DLKCS410                       11400000
114100                 PERFORM 4800-CALL-DLKUP001                       11410000
114200              END-IF                                              11420000
114300           ELSE                                                   11430000
114400              PERFORM 4600-CALL-DLKCS410                          11440000
114500                                                                  11450000
114600              INITIALIZE DL001-ASGMT-COMMAREA                     11460000
114700              MOVE DL016-ESO-ASGMT-START-DTE   TO                 11470000
114800                                         DL001-KEY-START-DTE      11480000
114900              MOVE DL016-ESO-ASGMT-NBR-TXT     TO                 11490000
115000                                         DL001-KEY-NBR-TXT        11500000
115100              MOVE DL016-ESO-ASGMT-NBR-SEQ-NBR TO                 11510000
115200                                         DL001-KEY-NBR-SEQ-NBR    11520000
115300              PERFORM 4800-CALL-DLKUP001                          11530000
115400              IF DL001-ASGMT-CLOSED-RETURN                        11540000
115500                 PERFORM 4500-DETERMINE-DOOR-GROUP                11550000
115600                 PERFORM 4600-CALL-DLKCS410                       11560000
115700                 PERFORM 4800-CALL-DLKUP001                       11570000
115800              END-IF                                              11580000
115900              MOVE PC233-DOOR-ID TO PC233-P4-DOOR-ID              11590000
116000              MOVE DLT00001-DOOR-GP-NBR TO                        11600000
116100                                    PC233-P4-DOOR-GP-NBR          11610000
116200           END-IF                                                 11620000
116300        END-IF                                                    11630000
116400     END-IF.                                                      11640000
116500                                                                  11650000
116600                                                                  11660000
116700****************************************************************  11670000
116800*    DETERMINES WHETHER INTERFACING OF MANAGING OF ASSIGNMENTS *  11680000
116900*    NEEDS TO BE DONE.                                         *  11690000
117000****************************************************************  11700000
117100 4400-SELECT-TKRPRPM-DLSHPI.                                      11710000
117200                                                                  11720000
117300     EXEC SQL                                                     11730000
117400       SELECT                                                     11740000
117500               FUNC_TXT                                           11750000
117600         INTO                                                     11760000
117700              :KRPRPM-FUNC-TXT                                    11770000
117800         FROM  TKRPRPM                                            11780000
117900        WHERE  LOC_ID            = :PC233-OPER-UNT-ID             11790000
118000          AND  INTFC_SYS_CDE     = :PC-DLX                        11800000
118100          AND  SYS_PRC_FUNC_CDE  = :PC-DLSHPI                     11810000
118200                                                                  11820000
118300     END-EXEC.                                                    11830000
118400                                                                  11840000
118500     EVALUATE TRUE                                                11850000
118600         WHEN SQLCODE = ZERO                                      11860000
118700              IF KRPRPM-FUNC-TXT = 'Y'                            11870000
118800                 SET PC233-P4-INTERFACE-YES TO TRUE               11880000
118900              ELSE                                                11890000
119000                 SET PC233-P4-INTERFACE-NO  TO TRUE               11900000
119100              END-IF                                              11910000
119200         WHEN SQLCODE = +100                                      11920000
119300              SET PC233-P4-INTERFACE-NO  TO TRUE                  11930000
119400         WHEN SQLCODE = -904                                      11940000
119500         WHEN SQLCODE = -913                                      11950000
119600         WHEN SQLCODE = -911                                      11960000
119700              MOVE 1                   TO PV-ERROR-NBR            11970000
119800              PERFORM 9903-WRITE-CICS-LOG                         11980000
119900              PERFORM 9000-SOFT-ABORT                             11990000
120000         WHEN SQLWARN0 NOT = SPACES                               12000000
120100         WHEN SQLCODE NOT EQUAL ZERO                              12010000
120200              SET PC233-P4-INTERFACE-NO  TO TRUE                  12020000
120300              PERFORM 4550-FORMAT-COMMON-DATA                     12030000
120400                                                                  12040000
120500              MOVE '4400-SELECT-TKRPRPM-DLSHPI'                   12050000
120600                                       TO PC233-PARAGRAPH         12060000
120700              STRING PC-CURRENT-PROGRAM-NAME                      12070000
120800                     ' - LOOKUP LABOR INTERFACING'                12080000
120900                      DELIMITED BY SIZE                           12090000
121000                      INTO PC233-MESSAGE-TEXT(1)                  12100000
121100              MOVE SQLCA               TO PC233-SQLCA             12110000
121200              MOVE 'TKRPRPM'           TO PC233-DB2-TABLE-NAME(1) 12120000
121300              SET PC233-ABEND          TO TRUE                    12130000
121400              MOVE 99                  TO PC233-PGM-MSG-NBR       12140000
121500              PERFORM 8210-XCTL-ERROR-SCREEN                      12150000
121600     END-EVALUATE.                                                12160000
121700                                                                  12170000
121800****************************************************************  12180000
121900*    FIND THE DOOR GROUP FOR THE DOOR.                         *  12190000
122000*                                                              *  12200000
122100****************************************************************  12210000
122200 4500-DETERMINE-DOOR-GROUP.                                       12220000
122300                                                                  12230000
122400     EXEC SQL                                                     12240000
122500       SELECT                                                     12250000
122600               GP.DOOR_GP_NBR                                     12260000
122700         INTO                                                     12270000
122800              :DLT00001-DOOR-GP-NBR                               12280000
122900         FROM  DLT_DOOR_GP      GP                                12290000
123000              ,DLT_DOOR_GP_TMPL TMPL                              12300000
123100                                                                  12310000
123200        WHERE  TMPL.DC_NBR        = :PC233-OPER-UNT-ID            12320000
123300          AND  GP.DOOR_ID         = :PC233-DOOR-ID                12330000
123400          AND  GP.DOOR_GP_TMPL_ID = TMPL.DOOR_GP_TMPL_ID          12340000
123500          AND  TMPL.ACTV_IND      = :PC-Y                         12350000
123600                                                                  12360000
123700     END-EXEC.                                                    12370000
123800                                                                  12380000
123900     EVALUATE TRUE                                                12390000
124000         WHEN SQLCODE = ZERO                                      12400000
124100              SET PS-DOOR-GROUP-FOUND-YES TO TRUE                 12410000
124101* DANH - 09/03/2008 - BEGIN                                       12410100
124102         WHEN SQLCODE = +100                                      12410200
124103             MOVE 52 TO PC233-PGM-MSG-NBR                         12410300
124104             PERFORM 8210-XCTL-ERROR-SCREEN                       12410400
124105                                                                  12410500
124106* DANH - 09/03/2008 - END                                         12410600
124107         WHEN SQLCODE = -904                                      12410700
124108         WHEN SQLCODE = -913                                      12410800
124109         WHEN SQLCODE = -911                                      12410900
124110              MOVE 2                   TO PV-ERROR-NBR            12411000
124120              PERFORM 9903-WRITE-CICS-LOG                         12412000
124130              PERFORM 9000-SOFT-ABORT                             12413000
124140         WHEN SQLWARN0 NOT = SPACES                               12414000
124150         WHEN SQLCODE NOT EQUAL ZERO                              12415000
124160              SET PS-DOOR-GROUP-FOUND-NO  TO TRUE                 12416000
124170              PERFORM 4550-FORMAT-COMMON-DATA                     12417000
124180                                                                  12418000
124190              MOVE '4500-DETERMINE-DOOR-NUMBER'                   12419000
124200                                       TO PC233-PARAGRAPH         12420000
124300              MOVE 'PCKRF879 - FIND DOOR NUMBER        '          12430000
124400                                       TO PC233-MESSAGE-TEXT(1)   12440000
124500              MOVE SQLCA               TO PC233-SQLCA             12450000
124600              MOVE 'DLT_DOOR_GP'       TO PC233-DB2-TABLE-NAME(1) 12460000
124700              MOVE 'DLT_DOOR_GP_TMPL'  TO PC233-DB2-TABLE-NAME(2) 12470000
124800              SET PC233-ABEND          TO TRUE                    12480000
124900              MOVE 99                  TO PC233-PGM-MSG-NBR       12490000
125000              PERFORM 8210-XCTL-ERROR-SCREEN                      12500000
125100     END-EVALUATE.                                                12510000
125200                                                                  12520000
125300****************************************************************  12530000
125400*                                                              *  12540000
125500*                                                              *  12550000
125600****************************************************************  12560000
125700 4550-FORMAT-COMMON-DATA.                                         12570000
125800                                                                  12580000
125900     MOVE PC233-OPER-UNT-ID      TO PV-DISPLAY-OPER.              12590000
126000     MOVE PC233-DOOR-ID          TO PV-DISPLAY-DOOR-ID.           12600000
126100     MOVE PC233-STR-NBR          TO PV-DISPLAY-DEST.              12610000
126200     MOVE PC233-SERIAL-NBR       TO PV-DISPLAY-SRL-NBR.           12620000
126300     MOVE PC233-OWNER-SCAC-ID    TO PV-DISPLAY-SCAC.              12630000
126400     MOVE PC233-TRIP-ID          TO PV-DISPLAY-TRIP.              12640000
126500     MOVE PC233-CARTON           TO PV-DISP-SHIPT-UNT-ID.         12650000
126600     STRING  ' OPER-'                                             12660000
126700             PV-DISPLAY-OPER                                      12670000
126800             ' DOOR-'                                             12680000
126900             PV-DISPLAY-DOOR-ID                                   12690000
127000             ' DEST-'                                             12700000
127100             PV-DISPLAY-DEST                                      12710000
127200             ' '                                                  12720000
127300             PV-DISP-SHIPT-UNT-ID   DELIMITED BY SIZE             12730000
127400             INTO                                                 12740000
127500             PC233-MESSAGE-TEXT(2).                               12750000
127600     STRING  ' TRLR SRL#-'                                        12760000
127700             PV-DISPLAY-SRL-NBR                                   12770000
127800             '   SCAC-'                                           12780000
127900             PV-DISPLAY-SCAC                                      12790000
128000             '   TRIP-'                                           12800000
128100             PV-DISPLAY-TRIP        DELIMITED BY SIZE             12810000
128200             INTO                                                 12820000
128300             PC233-MESSAGE-TEXT(3).                               12830000
128400                                                                  12840000
128500     MOVE 3                   TO PV-ERROR-NBR                     12850000
128600                                PC233-ERROR-NBR.                  12860000
128700     PERFORM 9903-WRITE-CICS-LOG.                                 12870000
128800                                                                  12880000
128900****************************************************************  12890000
129000*                                                              *  12900000
129100*                                                              *  12910000
129200****************************************************************  12920000
129300 4600-CALL-DLKCS410.                                              12930000
129400                                                                  12940000
129500     INITIALIZE  DL016-PGM-COMMAREA.                              12950000
129600     SET DL016-ESTABLISH-ASGMT TO TRUE.                           12960000
129700     SET DL016-COMMIT-UPDATE   TO TRUE.                           12970000
129800                                                                  12980000
129900     MOVE PC-CURRENT-PROGRAM-NAME TO DL016-CALLING-PGM-NM.        12990000
130000     MOVE PC233-USER-ID TO DL016-SIGN-ON-USR-ID.                  13000000
130100                                                                  13010000
130200     SET  DL011-AN-SHIP-WRK-TYP TO TRUE.                          13020000
130300     MOVE DL011-KEY-ASGMT-NBR-WRK-TYP TO DL016-ASGMT-NBR-WRK-TYP. 13030000
130400                                                                  13040000
130500     SET  DL011-SHIP-WRK-TYP TO TRUE.                             13050000
130600     MOVE DL011-KEY-WK-TYP TO DL016-EAI-WK-TYP-DESC.              13060000
130700                                                                  13070000
130800     MOVE DLT00001-DOOR-GP-NBR TO                                 13080000
130900                                   DL011-SD-WRK-AREA-DOOR-GROUP.  13090000
131000     MOVE DL011-SHIP-DOORGRP-WRK-AREA TO DL016-EAI-WK-AREA-DESC.  13100000
131100                                                                  13110000
131200     MOVE PC233-OPER-UNT-ID TO DL016-EAI-DC-NBR.                  13120000
131300     MOVE PC233-USER-ID     TO DL016-EAI-CRE-BY-USR-ID.           13130000
131400     SET  DL016-EAI-USR-IS-UNKNOWN TO TRUE.                       13140000
131500                                                                  13150000
131600     MOVE LENGTH OF DL016-PGM-COMMAREA                            13160000
131700                                      TO PV-COMMAREA-LENGTH.      13170000
131800                                                                  13180000
131900     EXEC CICS LINK                                               13190000
132000         PROGRAM  (DL016-USER-PGM)                                13200000
132100         COMMAREA (DL016-PGM-COMMAREA)                            13210000
132200         LENGTH   (PV-COMMAREA-LENGTH)                            13220000
132300         RESP     (PV-CICS-RESPONSE)                              13230000
132400     END-EXEC.                                                    13240000
132500                                                                  13250000
132600     IF  PV-CICS-RESPONSE = DFHRESP (NORMAL)                      13260000
132700                                                                  13270000
132800     EVALUATE TRUE                                                13280000
132900         WHEN DL016-SUCCESSFUL                                    13290000
133000              MOVE DL016-ESO-ASGMT-START-DTE TO                   13300000
133100                             PC233-ASGMT-STRT-DTE                 13310000
133200              MOVE DL016-ESO-ASGMT-NBR-TXT   TO                   13320000
133300                             PC233-ASGMT-NBR-TXT                  13330000
133400              MOVE DL016-ESO-ASGMT-NBR-SEQ-NBR TO                 13340000
133500                             PC233-ASGMT-NBR-SEQ-NBR              13350000
133600                                                                  13360000
133700         WHEN DL016-SQL-ERROR                                     13370000
133800              STRING ' DLKCS410 SQL ERROR FOR USER ID-'           13380000
133900                      PC233-USER-ID                               13390000
134000                      DELIMITED BY SIZE                           13400000
134100                      INTO PV-ERROR-MESSAGE                       13410000
134200                                                                  13420000
134300              PERFORM 4700-FORMAT-ERROR-MESSAGE                   13430000
134400                                                                  13440000
134500         WHEN DL016-CALLED-MODULE-FAILURE                         13450000
134600              STRING ' DLKCS410 CALLED MODULE FAILURE FOR '       13460000
134700                      PC233-USER-ID                               13470000
134800                      DELIMITED BY SIZE                           13480000
134900                      INTO PV-ERROR-MESSAGE                       13490000
135000                                                                  13500000
135100              PERFORM 4700-FORMAT-ERROR-MESSAGE                   13510000
135200                                                                  13520000
135300         WHEN DL016-INVALID-ACCESS                                13530000
135400              STRING ' DLKCS410 INVALID ACCESS FAILURE FOR '      13540000
135500                      PC233-USER-ID                               13550000
135600                      DELIMITED BY SIZE                           13560000
135700                      INTO PV-ERROR-MESSAGE                       13570000
135800                                                                  13580000
135900              PERFORM 4700-FORMAT-ERROR-MESSAGE                   13590000
136000                                                                  13600000
136100         WHEN OTHER                                               13610000
136200              STRING ' DLKCS410 OTHER TYPE FAILURE FOR '          13620000
136300                      PC233-USER-ID                               13630000
136400                      DELIMITED BY SIZE                           13640000
136500                      INTO PV-ERROR-MESSAGE                       13650000
136600                                                                  13660000
136700              PERFORM 4700-FORMAT-ERROR-MESSAGE                   13670000
136800                                                                  13680000
136900     END-EVALUATE                                                 13690000
137000     ELSE                                                         13700000
137100         MOVE '4600-CALL-DLKCS410' TO PC233-PARAGRAPH             13710000
137200         MOVE PV-CICS-RESPONSE     TO PC233-MESSAGE-TEXT (1)      13720000
137300         MOVE 'BAD RETURN FROM DLKCS410' TO                       13730000
137400                                      PC233-MESSAGE-TEXT (2)      13740000
137500         MOVE 2                    TO PC233-ERROR-NBR             13750000
137600         SET PC233-ABEND           TO TRUE                        13760000
137700         MOVE 99                   TO PC233-PGM-MSG-NBR           13770000
137800         PERFORM 8210-XCTL-ERROR-SCREEN                           13780000
137900     END-IF.                                                      13790000
138000                                                                  13800000
138100****************************************************************  13810000
138200*                                                              *  13820000
138300*                                                              *  13830000
138400****************************************************************  13840000
138500 4700-FORMAT-ERROR-MESSAGE.                                       13850000
138600                                                                  13860000
138700     MOVE DL016-ASGMT-SQLCODE    TO PV-SQLCODE.                   13870000
138800     MOVE PC233-OPER-UNT-ID      TO PV-DISPLAY-OPER.              13880000
138900                                                                  13890000
139000     INITIALIZE PV-CICS-MSG-AREA2.                                13900000
139100     STRING ' PCKRF879-4700- '                                    13910000
139200             PV-DISPLAY-OPER   '-'                                13920000
139300             PV-ERROR-MESSAGE                                     13930000
139400            ' SQLCODE=' PV-SQLCODE                                13940000
139500             DELIMITED BY SIZE                                    13950000
139600             INTO PV-CICS-MSG-AREA2.                              13960000
139700     PERFORM 999A-WRITE-CSSL-MSG.                                 13970000
139800                                                                  13980000
139900     INITIALIZE PV-CICS-MSG-AREA2.                                13990000
140000     STRING ' PCKRF879-' DL016-USER-PGM                           14000000
140100            ' -- ' DL016-CALL-MOD-FAIL-SQL-PARA                   14010000
140200            ' -- ' DL016-CALL-MOD-FAIL-NM                         14020000
140300            ' -- ' DL016-CALL-MOD-FAIL-ERR-CDE                    14030000
140400             DELIMITED BY SIZE                                    14040000
140500             INTO PV-CICS-MSG-AREA2.                              14050000
140600     PERFORM 999A-WRITE-CSSL-MSG.                                 14060000
140700                                                                  14070000
140800****************************************************************  14080000
140900*    SECURE THE REQUIRED NUMBER OF SEQUENCE NUMBERS.           *  14090000
141000*                                                              *  14100000
141100****************************************************************  14110000
141200 4800-CALL-DLKUP001.                                              14120000
141300                                                                  14130000
141400     SET DL001-BY-ASGMT-KEY                                       14140000
141500         DL001-COMMIT-UPDATE                                      14150000
141600         DL001-FIND-NEXT-ASGMT    TO TRUE.                        14160000
141700                                                                  14170000
141800     IF SUT00024-CART-SRC-CDE = 'MST'                             14180000
141900        MOVE +2 TO DL001-NBR-OF-NBRS-NEED-QTY                     14190000
142000     ELSE                                                         14200000
142100        MOVE +1 TO DL001-NBR-OF-NBRS-NEED-QTY                     14210000
142200     END-IF.                                                      14220000
142300                                                                  14230000
142400     SET DL001-FIND-NEXT-ASGMT    TO TRUE.                        14240000
142500                                                                  14250000
142600     MOVE PC-CURRENT-PROGRAM-NAME TO DL001-ORIG-CALLING-PGM-NM.   14260000
142700                                                                  14270000
142800     CALL DL001-USER-PGM USING DFHEIBLK                           14280000
142900                              DL001-COMMAREA                      14290000
143000                              DL001-ASGMT-COMMAREA.               14300000
143100                                                                  14310000
143200     EVALUATE TRUE                                                14320000
143300         WHEN DL001-SUCCESSFUL                                    14330000
143400              IF DL001-ASGMT-NEXT-USED                            14340000
143500                 MOVE DL001-NXT-START-DTE                         14350000
143600                               TO PC233-ASGMT-STRT-DTE            14360000
143700                 MOVE DL001-NXT-NBR-TXT                           14370000
143800                               TO PC233-ASGMT-NBR-TXT             14380000
143900                 MOVE DL001-NXT-NBR-SEQ-NBR                       14390000
144000                               TO PC233-ASGMT-NBR-SEQ-NBR         14400000
144100              END-IF                                              14410000
144200                                                                  14420000
144300         WHEN DL001-ASGMT-CLOSED-RETURN                           14430000
144400              CONTINUE                                            14440000
144500                                                                  14450000
144600         WHEN OTHER                                               14460000
144700              MOVE DL001-ASGMT-SQLCODE TO  PV-SQLCODE             14470000
144800              INITIALIZE PV-CICS-MSG-AREA2                        14480000
144900              STRING ' PCKRF879-4800- '                           14490000
145000                     'SQLCODE=' PV-SQLCODE                        14500000
145100                     ' - RETURN CODE=' DL001-RETURN-CODE          14510000
145200                      DELIMITED BY SIZE                           14520000
145300                      INTO PV-CICS-MSG-AREA2                      14530000
145400               MOVE LENGTH OF PV-CICS-MSG-AREA2                   14540000
145500                                             TO PV-COMMAREA-LENGTH14550000
145600               PERFORM 999A-WRITE-CSSL-MSG                        14560000
145700                                                                  14570000
145800               INITIALIZE PV-CICS-MSG-AREA2                       14580000
145900               STRING ' PCKRF879-' DL001-USER-PGM                 14590000
146000                      ' -- ' DL001-SQL-ERROR-PARA                 14600000
146100                      ' -- ' DL001-CALL-MOD-FAIL-NM               14610000
146200                      ' -- ' DL001-CALL-MOD-FAIL-ERR-CDE          14620000
146300                       DELIMITED BY SIZE                          14630000
146400                       INTO PV-CICS-MSG-AREA2                     14640000
146500               MOVE LENGTH OF PV-CICS-MSG-AREA2                   14650000
146600                                             TO PV-COMMAREA-LENGTH14660000
146700               PERFORM 999A-WRITE-CSSL-MSG                        14670000
146800                                                                  14680000
146900     END-EVALUATE.                                                14690000
147000                                                                  14700000
147100 5000-GET-CARTON-INFO.                                            14710000
147200     PERFORM 7180-SELECT-OTBND-CART.                              14720000
147300     IF CA-OTBND-CART-NO                                          14730000
147400         PERFORM 7185-SELECT-OTBND-CART                           14740000
147500     END-IF.                                                      14750000
147600     IF (PC233-SCAN-OFF-CONTAINER AND                             14760000
147700         CA-OTBND-CART-NO)                                        14770000
147800             OR                                                   14780000
147900        (SUT00024-ACTV-IND = 'N' AND                              14790000
148000         SUT00024-CART-SRC-CDE = 'MST')                           14800000
148100             PERFORM 7220-SELECT-TSUCRDV                          14810000
148200     END-IF.                                                      14820000
148300                                                                  14830000
148400                                                                  14840000
148500****************************************************************  14850000
148600*    FORMAT BUSINESS EVENTS (PALLET MANUAL) OR (CARTON MANUAL) *  14860000
148700*    BOTH EVENTS GO TO THE PCT00011 AND PCT00012 BUSINESS      *  14870000
148800*    EVENT TABLES.                                             *  14880000
148900*                                                              *  14890000
149000****************************************************************  14900000
149100 5200-CALL-XLKUP033.                                              14910000
149200                                                                  14920000
149300     INITIALIZE XL072-EAI-EXPORT-COMMAREA.                        14930000
149400                                                                  14940000
149500     SET  XL072-PC-APP-ID   TO TRUE.                              14950000
149600     MOVE PC-SHIPPING       TO XL072-EVNT-OBJ-TXT.                14960000
149700                                                                  14970000
149800     EVALUATE TRUE                                                14980000
149900         WHEN SUT00024-CART-SRC-CDE = 'MST'                       14990000
150000              MOVE PC-PALLET-MANUAL TO XL072-EVNT-OBJ-ACTN-TXT    15000000
150100                                                                  15010000
150200         WHEN OTHER                                               15020000
150300              MOVE PC-CARTON-MANUAL TO XL072-EVNT-OBJ-ACTN-TXT    15030000
150400                                                                  15040000
150500     END-EVALUATE.                                                15050000
150600                                                                  15060000
150700     MOVE PC233-USER-ID     TO XL072-CRE-BY-USR-ID.               15070000
150800     MOVE PC-CURRENT-PROGRAM-NAME TO XL072-CRE-PGM-NM.            15080000
150900     MOVE PC233-TRIP-ID     TO XL072-EVNT-KY-1-NBR.               15090000
151000     MOVE PC233-OPER-UNT-ID TO XL072-EVNT-KY-2-NBR.               15100000
151100     MOVE PC233-CARTON      TO XL072-EVNT-KY-3-NBR.               15110000
151200     MOVE PC233-P4-DOOR-GP-NBR      TO XL072-EVNT-KY-4-NBR.       15120000
151300     MOVE PC233-P4-DOOR-ID          TO XL072-EVNT-KY-1-TXT.       15130000
151400     MOVE PV-CURRENT-TIMESTAMP TO XL072-EVNT-KY-1-TMST.           15140000
151500                                                                  15150000
151600     INITIALIZE PC242-DTL-TXT-AREA.                               15160000
151700                                                                  15170000
151800     EVALUATE TRUE                                                15180000
151900         WHEN SUT00024-CART-SRC-CDE = 'MST'                       15190000
152000              SET PC242-MANUAL-SCAN-MSTR-CRTN TO TRUE             15200000
152100              MOVE PC233-ASGMT-STRT-DTE                           15210000
152200                               TO PC242-AF-ASGMT-STRT-DTE         15220000
152300              MOVE PC233-ASGMT-NBR-TXT                            15230000
152400                               TO PC242-AF-ASGMT-NBR-TXT          15240000
152500              MOVE PC233-ASGMT-NBR-SEQ-NBR                        15250000
152600                               TO PC242-AF-ASGMT-NBR-SEQ-NBR      15260000
152700              MOVE DL001-SEQ-START-NBR                            15270000
152800                               TO PC242-AF-ASGMT-SEQ-DTL-NBR-O    15280000
152900              COMPUTE PC242-AF-ASGMT-SEQ-DTL-NBR-P =              15290000
153000                               DL001-SEQ-START-NBR  +  1          15300000
153100              MOVE PV-MST-TOTAL-CARTONS                           15310000
153200                               TO PC242-AF-INNER-CARTON-QTY       15320000
153300              MOVE PV-MST-TOTAL-UNITS                             15330000
153400                               TO PC242-AF-INNER-UNIT-QTY         15340000
153500                                                                  15350000
153600         WHEN OTHER                                               15360000
153700              SET PC242-MANUAL-SCAN-SML-CRTN TO TRUE              15370000
153800              MOVE PC233-ASGMT-STRT-DTE                           15380000
153900                               TO PC242-AG-ASGMT-STRT-DTE         15390000
154000              MOVE PC233-ASGMT-NBR-TXT                            15400000
154100                               TO PC242-AG-ASGMT-NBR-TXT          15410000
154200              MOVE PC233-ASGMT-NBR-SEQ-NBR                        15420000
154300                               TO PC242-AG-ASGMT-NBR-SEQ-NBR      15430000
154400              MOVE DL001-SEQ-START-NBR                            15440000
154500                               TO PC242-AG-ASGMT-SEQ-DTL-NBR      15450000
154600              IF PC233-SCAN-OFF-CONTAINER                         15460000
154700                 SET PC242-AG-CRTN-SCAN-OFF TO TRUE               15470000
154800              ELSE                                                15480000
154900                 SET PC242-AG-CRTN-SCAN-ON  TO TRUE               15490000
155000              END-IF                                              15500000
155100              MOVE DL001-SEQ-START-NBR                            15510000
155200                               TO PC242-AG-ASGMT-SEQ-DTL-NBR      15520000
155300                                                                  15530000
155400     END-EVALUATE.                                                15540000
155500                                                                  15550000
155600                                                                  15560000
155700                                                                  15570000
155800     SET  XL072-PCWS242-COPYBOOK   TO TRUE.                       15580000
155900     SET  XL072-COMMIT-UPDATE      TO TRUE.                       15590000
156000     MOVE PC242-DTL-TXT-AREA       TO XL072-DTL-TXT.              15600000
156100                                                                  15610000
156200     CALL XL072-USER-PGM USING DFHEIBLK                           15620000
156300                              XL072-COMMAREA                      15630000
156400                              XL072-EAI-EXPORT-COMMAREA.          15640000
156500                                                                  15650000
156600     EVALUATE TRUE                                                15660000
156700         WHEN XL072-SUCCESSFUL                                    15670000
156800              CONTINUE                                            15680000
156900         WHEN OTHER                                               15690000
157000              MOVE PC233-OPER-UNT-ID TO  PV-DISPLAY-OPER          15700000
157100              MOVE PC233-ASGMT-NBR-SEQ-NBR TO PV-DISPLAY-SEQ-NBR  15710000
157200              MOVE XL072-EAI-DB-SQLCODE                           15720000
157300                                     TO  PV-SQLCODE               15730000
157400              INITIALIZE PV-CICS-MSG-AREA2                        15740000
157500              STRING ' PCKRF879-5200- '                           15750000
157600                      PV-DISPLAY-OPER   '-'                       15760000
157700                      PC233-ASGMT-STRT-DTE  ' - '                 15770000
157800                      PC233-ASGMT-NBR-TXT   ' - '                 15780000
157900                      PV-DISPLAY-SEQ-NBR ' - '                    15790000
158000                      PC233-USER-ID ' - '                         15800000
158100                     'SQLCODE=' PV-SQLCODE                        15810000
158200                     ' - RETURN CODE=' XL072-RETURN-CODE          15820000
158300                                                DELIMITED BY SIZE 15830000
158400                                           INTO PV-CICS-MSG-AREA2 15840000
158500               MOVE LENGTH OF PV-CICS-MSG-AREA2                   15850000
158600                                             TO PV-COMMAREA-LENGTH15860000
158700               PERFORM 999A-WRITE-CSSL-MSG                        15870000
158800                                                                  15880000
158900              INITIALIZE PV-CICS-MSG-AREA2                        15890000
159000              STRING ' PCKRF879-' XL072-USER-PGM                  15900000
159100                      ' -- ' XL072-SQL-ERROR-PARA                 15910000
159200                      ' -- ' XL072-CALL-MOD-FAIL-NM               15920000
159300                      ' -- ' XL072-CALL-MOD-FAIL-ERR-CDE          15930000
159400                                                DELIMITED BY SIZE 15940000
159500                                           INTO PV-CICS-MSG-AREA2 15950000
159600               MOVE LENGTH OF PV-CICS-MSG-AREA2                   15960000
159700                                             TO PV-COMMAREA-LENGTH15970000
159800               PERFORM 999A-WRITE-CSSL-MSG                        15980000
159900                                                                  15990000
160000              INITIALIZE PV-CICS-MSG-AREA2                        16000000
160100              STRING ' PCKRF879-' XL072-USER-PGM                  16010000
160200                      ' -- ' XL072-SQLCA                          16020000
160300                                                DELIMITED BY SIZE 16030000
160400                                           INTO PV-CICS-MSG-AREA2 16040000
160500               MOVE LENGTH OF PV-CICS-MSG-AREA2                   16050000
160600                                             TO PV-COMMAREA-LENGTH16060000
160700               PERFORM 999A-WRITE-CSSL-MSG                        16070000
160800                                                                  16080000
160900               MOVE 4                   TO PV-ERROR-NBR           16090000
161000                                           PC233-ERROR-NBR        16100000
161100               PERFORM 9903-WRITE-CICS-LOG                        16110000
161200               MOVE '5200-CALL-XLKUP033'                          16120000
161300                                        TO PC233-PARAGRAPH        16130000
161400               MOVE 'PCKRF879 - CALL XLKUP033 ERROR'              16140000
161500                                        TO PC233-MESSAGE-TEXT(1)  16150000
161600               MOVE SQLCA               TO PC233-SQLCA            16160000
161700               SET PC233-ABEND          TO TRUE                   16170000
161800               MOVE 99                  TO PC233-PGM-MSG-NBR      16180000
161900               PERFORM 8210-XCTL-ERROR-SCREEN                     16190000
162000                                                                  16200000
162100     END-EVALUATE.                                                16210000
162200                                                                  16220000
162300****************************************************************  16230000
162400*                                                              *  16240000
162500*                                                              *  16250000
162600****************************************************************  16260000
162700 5400-FIND-CONTAINER-INFO.                                        16270000
162800* DMH - TEST ONLY                                                 16280000
162900     INITIALIZE PV-CICS-MSG-AREA2.                                16290000
163000     MOVE  PC233-CARTON             TO PV-DISP-SHIPT-UNT-ID.      16300000
163100     MOVE  DK-PARENT-SHIPT-UNT-ID   TO PV-DISP-SHIPT-UNT-ID2.     16310000
163200     MOVE  SUT00024-SHIPT-UNT-ID    TO PV-DISP-SHIPT-UNT-ID3.     16320000
163300     STRING ' PCKRF879-5400- '                                    16330000
163400             'PC233='  PV-DISP-SHIPT-UNT-ID                       16340000
163500             ' PARENT='  PV-DISP-SHIPT-UNT-ID2                    16350000
163600             ' CHILD='  PV-DISP-SHIPT-UNT-ID3                     16360000
163700             DELIMITED BY SIZE                                    16370000
163800             INTO PV-CICS-MSG-AREA2.                              16380000
163810     PERFORM 999A-WRITE-CSSL-MSG.                                 16381000
163820* DMH - TEST ONLY                                                 16382000
163830                                                                  16383000
163840     PERFORM 5500-SELECT-MASTER-CONTAINER.                        16384000
163850                                                                  16385000
163860     PERFORM 5600-FIND-UNITS-TO-CARTON.                           16386000
163870                                                                  16387000
163880****************************************************************  16388000
163890*  FIND THE NUMBER OF UNITS THAT ARE IN THE MASTER CONTAINER   *  16389000
163900*  DO NOT INCLUDE THE MASTER ITSELF IN THE CARTON COUNT        *  16390000
164000****************************************************************  16400000
164100 5410-FIND-MASTER-INFO.                                           16410000
164200                                                                  16420000
164300     PERFORM 5510-FIND-CHILD-COUNT.                               16430000
164310                                                                  16431000
164320     PERFORM 5610-FIND-CHILD-UNITS.                               16432000
164330                                                                  16433000
164340     ADD  PV-MST-NBR-OF-CARTONS  TO  PV-MST-TOTAL-CARTONS.        16434000
164350     ADD  PV-MST-NBR-OF-UNITS    TO  PV-MST-TOTAL-UNITS.          16435000
164360                                                                  16436000
164370****************************************************************  16437000
164380*                                                              *  16438000
164390*                                                              *  16439000
164400****************************************************************  16440000
164500                                                                  16450000
164600 5500-SELECT-MASTER-CONTAINER.                                    16460000
164700                                                                  16470000
164800     EXEC SQL                                                     16480000
164900       SELECT  COUNT(*)                                           16490000
165000         INTO                                                     16500000
165100              :PV-NUMBER-OF-CARTONS                               16510000
165200         FROM  SUT_OTBND_CART   CART                              16520000
165300                                                                  16530000
165400        WHERE  CART.PRNT_CART_ID  = :PC233-CARTON                 16540000
165500          AND  CART.PRNT_CART_ID  <> CART.SHIPT_UNT_ID            16550000
165600          AND  CART.ACTV_IND      = :PC-Y                         16560000
165700                                                                  16570000
165800     END-EXEC.                                                    16580000
165900                                                                  16590000
166000     EVALUATE TRUE                                                16600000
166100         WHEN SQLCODE = ZERO                                      16610000
166200              CONTINUE                                            16620000
166300                                                                  16630000
166400         WHEN SQLCODE = +100                                      16640000
166500              MOVE 0 TO PV-NUMBER-OF-CARTONS                      16650000
166600                                                                  16660000
166700         WHEN SQLCODE = -904                                      16670000
166800         WHEN SQLCODE = -913                                      16680000
166900         WHEN SQLCODE = -911                                      16690000
167000              MOVE 5                   TO PV-ERROR-NBR            16700000
167100              PERFORM 9903-WRITE-CICS-LOG                         16710000
167200              PERFORM 9000-SOFT-ABORT                             16720000
167300         WHEN SQLWARN0 NOT = SPACES                               16730000
167400         WHEN SQLCODE NOT EQUAL ZERO                              16740000
167500              SET PS-DOOR-GROUP-FOUND-NO  TO TRUE                 16750000
167600              PERFORM 4550-FORMAT-COMMON-DATA                     16760000
167700                                                                  16770000
167800              MOVE '5500-SELECT-MASTER-CONTAINER'                 16780000
167900                                       TO PC233-PARAGRAPH         16790000
168000              MOVE 'PCKRF879 - FIND MASTER CONTAINER'             16800000
168100                                       TO PC233-MESSAGE-TEXT(1)   16810000
168200              MOVE SQLCA               TO PC233-SQLCA             16820000
168300              MOVE 'SUT_OTBND_CART'    TO PC233-DB2-TABLE-NAME(1) 16830000
168400              SET PC233-ABEND          TO TRUE                    16840000
168500              MOVE 99                  TO PC233-PGM-MSG-NBR       16850000
168600              PERFORM 8210-XCTL-ERROR-SCREEN                      16860000
168700     END-EVALUATE.                                                16870000
168800                                                                  16880000
168900****************************************************************  16890000
169000*                                                              *  16900000
169001*                                                              *  16900100
169002****************************************************************  16900200
169003 5510-FIND-CHILD-COUNT.                                           16900300
169004                                                                  16900400
169005     EXEC SQL                                                     16900500
169006       SELECT  COUNT(*)                                           16900600
169007         INTO                                                     16900700
169008              :PV-MST-NBR-OF-CARTONS                              16900800
169009         FROM  SUT_OTBND_CART   CART                              16900900
169010                                                                  16901000
169011        WHERE  CART.PRNT_CART_ID  = :SUT00024-SHIPT-UNT-ID        16901100
169012          AND  CART.PRNT_CART_ID  <> CART.SHIPT_UNT_ID            16901200
169013          AND  CART.ACTV_IND      = :PC-Y                         16901300
169014          AND  CART.CART_SRC_CDE <> 'MST'                         16901400
169015                                                                  16901500
169016     END-EXEC.                                                    16901600
169017                                                                  16901700
169018     EVALUATE TRUE                                                16901800
169019         WHEN SQLCODE = ZERO                                      16901900
169020              CONTINUE                                            16902000
169021                                                                  16902100
169022         WHEN SQLCODE = +100                                      16902200
169023              MOVE 0 TO PV-MST-NBR-OF-CARTONS                     16902300
169024                                                                  16902400
169025         WHEN SQLCODE = -904                                      16902500
169026         WHEN SQLCODE = -913                                      16902600
169027         WHEN SQLCODE = -911                                      16902700
169028              MOVE 5                   TO PV-ERROR-NBR            16902800
169029              PERFORM 9903-WRITE-CICS-LOG                         16902900
169030              PERFORM 9000-SOFT-ABORT                             16903000
169031         WHEN SQLWARN0 NOT = SPACES                               16903100
169032         WHEN SQLCODE NOT EQUAL ZERO                              16903200
169033              SET PS-DOOR-GROUP-FOUND-NO  TO TRUE                 16903300
169034              PERFORM 4550-FORMAT-COMMON-DATA                     16903400
169035                                                                  16903500
169036              MOVE '5510-FIND-CHILD-COUNT       '                 16903600
169037                                       TO PC233-PARAGRAPH         16903700
169038              MOVE 'PCKRF879-COUNT NBR OF CHILD CRTNS'            16903800
169039                                       TO PC233-MESSAGE-TEXT(1)   16903900
169040              MOVE SQLCA               TO PC233-SQLCA             16904000
169041              MOVE 'SUT_OTBND_CART'    TO PC233-DB2-TABLE-NAME(1) 16904100
169042              SET PC233-ABEND          TO TRUE                    16904200
169043              MOVE 99                  TO PC233-PGM-MSG-NBR       16904300
169044              PERFORM 8210-XCTL-ERROR-SCREEN                      16904400
169045     END-EVALUATE.                                                16904500
169046                                                                  16904600
169047                                                                  16904700
169048****************************************************************  16904800
169049*                                                              *  16904900
169050*                                                              *  16905000
169060****************************************************************  16906000
169070 5600-FIND-UNITS-TO-CARTON.                                       16907000
169080                                                                  16908000
169090     EXEC SQL                                                     16909000
169100       SELECT  SUM(UPC.SHPD_UNT_QTY)                              16910000
169200         INTO                                                     16920000
169300              :PV-NUMBER-OF-UNITS                                 16930000
169400         FROM  SUT_OTBND_CART   CART                              16940000
169500              ,SUT_OTBND_UPC    UPC                               16950000
169600                                                                  16960000
169700        WHERE  CART.PRNT_CART_ID  = :PC233-CARTON                 16970000
169800          AND  CART.PRNT_CART_ID  <> CART.SHIPT_UNT_ID            16980000
169900          AND  CART.ACTV_IND      = :PC-Y                         16990000
170000          AND  CART.SHIPT_UNT_ID  = UPC.SHIPT_UNT_ID              17000000
170100                                                                  17010000
170200     END-EXEC.                                                    17020000
170300                                                                  17030000
170400     EVALUATE TRUE                                                17040000
170500         WHEN SQLCODE = ZERO                                      17050000
170600              CONTINUE                                            17060000
170700                                                                  17070000
170800         WHEN SQLCODE = +100                                      17080000
170900         WHEN SQLCODE = -305                                      17090000
171000              MOVE 0 TO PV-NUMBER-OF-UNITS                        17100000
171100                                                                  17110000
171200         WHEN SQLCODE = -904                                      17120000
171300         WHEN SQLCODE = -913                                      17130000
171400         WHEN SQLCODE = -911                                      17140000
171500              MOVE 6                   TO PV-ERROR-NBR            17150000
171600              PERFORM 9903-WRITE-CICS-LOG                         17160000
171700              PERFORM 9000-SOFT-ABORT                             17170000
171800         WHEN SQLWARN0 NOT = SPACES                               17180000
171900         WHEN SQLCODE NOT EQUAL ZERO                              17190000
172000              SET PS-DOOR-GROUP-FOUND-NO  TO TRUE                 17200000
172100              PERFORM 4550-FORMAT-COMMON-DATA                     17210000
172200                                                                  17220000
172300             MOVE '5600-FIND-UNITS-TO-CARTON'                     17230000
172400                                      TO PC233-PARAGRAPH          17240000
172500             MOVE 'PCKRF879 - FIND UNITS TO CARTON    '           17250000
172600                                      TO PC233-MESSAGE-TEXT(1)    17260000
172700             MOVE SQLCA               TO PC233-SQLCA              17270000
172800             MOVE 'SUT_OTBND_CART'    TO PC233-DB2-TABLE-NAME(1)  17280000
172900             MOVE 'SUT_OTBND_UPC'     TO PC233-DB2-TABLE-NAME(2)  17290000
173000             SET PC233-ABEND          TO TRUE                     17300000
173100             MOVE 99                  TO PC233-PGM-MSG-NBR        17310000
173200             PERFORM 8210-XCTL-ERROR-SCREEN                       17320000
173300     END-EVALUATE.                                                17330000
173400                                                                  17340000
173500                                                                  17350000
173600****************************************************************  17360000
173700*                                                              *  17370000
173800*                                                              *  17380000
173900****************************************************************  17390000
173910 5610-FIND-CHILD-UNITS.                                           17391000
173920                                                                  17392000
173930     EXEC SQL                                                     17393000
173940       SELECT  SUM(UPC.SHPD_UNT_QTY)                              17394000
173950         INTO                                                     17395000
173960              :PV-MST-NBR-OF-UNITS                                17396000
173970         FROM  SUT_OTBND_CART   CART                              17397000
173980              ,SUT_OTBND_UPC    UPC                               17398000
173990                                                                  17399000
173991        WHERE  CART.PRNT_CART_ID  = :SUT00024-SHIPT-UNT-ID        17399100
173992          AND  CART.PRNT_CART_ID  <> CART.SHIPT_UNT_ID            17399200
173993          AND  CART.ACTV_IND      = :PC-Y                         17399300
173994          AND  CART.SHIPT_UNT_ID  = UPC.SHIPT_UNT_ID              17399400
173995                                                                  17399500
173996     END-EXEC.                                                    17399600
173997                                                                  17399700
173998     EVALUATE TRUE                                                17399800
173999         WHEN SQLCODE = ZERO                                      17399900
174000              CONTINUE                                            17400000
174001                                                                  17400100
174002         WHEN SQLCODE = +100                                      17400200
174003         WHEN SQLCODE = -305                                      17400300
174004              MOVE 0 TO PV-MST-NBR-OF-UNITS                       17400400
174005                                                                  17400500
174006         WHEN SQLCODE = -904                                      17400600
174007         WHEN SQLCODE = -913                                      17400700
174008         WHEN SQLCODE = -911                                      17400800
174009              MOVE 6                   TO PV-ERROR-NBR            17400900
174010              PERFORM 9903-WRITE-CICS-LOG                         17401000
174011              PERFORM 9000-SOFT-ABORT                             17401100
174012         WHEN SQLWARN0 NOT = SPACES                               17401200
174013         WHEN SQLCODE NOT EQUAL ZERO                              17401300
174014              SET PS-DOOR-GROUP-FOUND-NO  TO TRUE                 17401400
174015              PERFORM 4550-FORMAT-COMMON-DATA                     17401500
174016                                                                  17401600
174017             MOVE '5610-FIND-CHILD-UNITS'                         17401700
174018                                      TO PC233-PARAGRAPH          17401800
174019             MOVE 'PCKRF879 - FIND MSTR NUMBR OF UNITS'           17401900
174020                                      TO PC233-MESSAGE-TEXT(1)    17402000
174021             MOVE SQLCA               TO PC233-SQLCA              17402100
174022             MOVE 'SUT_OTBND_CART'    TO PC233-DB2-TABLE-NAME(1)  17402200
174023             MOVE 'SUT_OBBND_UPC'     TO PC233-DB2-TABLE-NAME(2)  17402300
174024             SET PC233-ABEND          TO TRUE                     17402400
174025             MOVE 99                  TO PC233-PGM-MSG-NBR        17402500
174026             PERFORM 8210-XCTL-ERROR-SCREEN                       17402600
174027     END-EVALUATE.                                                17402700
174028                                                                  17402800
174029                                                                  17402900
174030/                                                                 17403000
174040 7000-SELECT-TSEASET.                                             17404000
174050     EXEC SQL                                                     17405000
174060         SELECT                                                   17406000
174070             STR_RLSE_END_DTE                                     17407000
174080         ,   CHAR(STR_RLSE_END_DTE,USA)                           17408000
174090         INTO                                                     17409000
174100             :SEASET-STR-RLSE-END-DTE                             17410000
174200         ,   :PV-SEASET-RELEASE-DISP-DATE                         17420000
174300         FROM TSEASET                                             17430000
174400         WHERE                                                    17440000
174500             DIVERT_PFX_NBR       = :PC233-SEASET-DIVERT-PFX-NBR  17450000
174600             AND SEASET_STAT_CDE  = 'A'                           17460000
174700*            AND CURRENT DATE     >= STR_RLSE_BEG_DTE             17470000
174800     END-EXEC.                                                    17480000
174900                                                                  17490000
175000     EVALUATE TRUE                                                17500000
175100         WHEN SQLCODE = ZERO                                      17510000
175200         WHEN SQLCODE = -811                                      17520000
175300         WHEN SQLCODE = +100                                      17530000
175400             CONTINUE                                             17540000
175500         WHEN SQLCODE = -904                                      17550000
175600         WHEN SQLCODE = -913                                      17560000
175700         WHEN SQLCODE = -911                                      17570000
175800             MOVE 7                   TO PV-ERROR-NBR             17580000
175900             PERFORM 9903-WRITE-CICS-LOG                          17590000
176000             PERFORM 9000-SOFT-ABORT                              17600000
176100         WHEN SQLWARN0 NOT = SPACES                               17610000
176200         WHEN SQLCODE NOT EQUAL ZERO                              17620000
176300             MOVE 8                   TO PV-ERROR-NBR             17630000
176400                                         PC233-ERROR-NBR          17640000
176500             PERFORM 9903-WRITE-CICS-LOG                          17650000
176600             MOVE '7020-SELECT-TSUOBTR'                           17660000
176700                                      TO PC233-PARAGRAPH          17670000
176800             MOVE 'PCKRF879 - CHECK DEST ON TRAILER'              17680000
176900                                      TO PC233-MESSAGE-TEXT(1)    17690000
177000             MOVE SQLCA               TO PC233-SQLCA              17700000
177100             MOVE 'TSUOBTR'           TO PC233-DB2-TABLE-NAME(1)  17710000
177200             SET PC233-ABEND          TO TRUE                     17720000
177300             MOVE 99                  TO PC233-PGM-MSG-NBR        17730000
177400             PERFORM 8210-XCTL-ERROR-SCREEN                       17740000
177500     END-EVALUATE.                                                17750000
177600                                                                  17760000
177700 7001-TEST-THE-DATE.                                              17770000
177800     EXEC SQL                                                     17780000
177900         SELECT DAYS(:SEASET-STR-RLSE-END-DTE) -                  17790000
178000                DAYS(CURRENT DATE)                                17800000
178100         INTO                                                     17810000
178200             :PV-DATE-DURATION                                    17820000
178300         FROM                                                     17830000
178400         SYSIBM.SYSDUMMY1                                         17840000
178500     END-EXEC.                                                    17850000
178600                                                                  17860000
178700     EVALUATE TRUE                                                17870000
178800         WHEN SQLCODE = ZERO                                      17880000
178900             CONTINUE                                             17890000
179000         WHEN SQLCODE = -904                                      17900000
179100         WHEN SQLCODE = -913                                      17910000
179200         WHEN SQLCODE = -911                                      17920000
179300             MOVE 9                   TO PV-ERROR-NBR             17930000
179400             PERFORM 9903-WRITE-CICS-LOG                          17940000
179500             PERFORM 9000-SOFT-ABORT                              17950000
179600         WHEN SQLWARN0 NOT = SPACES                               17960000
179700         WHEN SQLCODE NOT EQUAL ZERO                              17970000
179800             MOVE 10                  TO PV-ERROR-NBR             17980000
179900                                         PC233-ERROR-NBR          17990000
180000             PERFORM 9903-WRITE-CICS-LOG                          18000000
180100             MOVE '7020-SELECT-TSUOBTR'                           18010000
180200                                      TO PC233-PARAGRAPH          18020000
180300             MOVE 'PCKRF879 - CHECK DEST ON TRAILER'              18030000
180400                                      TO PC233-MESSAGE-TEXT(1)    18040000
180500             MOVE SQLCA               TO PC233-SQLCA              18050000
180600             MOVE 'TSUOBTR'           TO PC233-DB2-TABLE-NAME(1)  18060000
180700             SET PC233-ABEND          TO TRUE                     18070000
180800             MOVE 99                  TO PC233-PGM-MSG-NBR        18080000
180900             PERFORM 8210-XCTL-ERROR-SCREEN                       18090000
181000     END-EVALUATE.                                                18100000
181100                                                                  18110000
181200 7020-SELECT-TSUOBTR.                                             18120000
181300                                                                  18130000
181400     EXEC SQL                                                     18140000
181500         SELECT                                                   18150000
181600             OBTR.DEST_OPER_UNT_ID                                18160000
181700            ,OBTR.DOOR_TYP_CDE                                    18170000
181800         INTO :SUOBTR-DEST-OPER-UNT-ID                            18180000
181900             ,:SUOBTR-DOOR-TYP-CDE                                18190000
182000         FROM                                                     18200000
182100              TSUOBTR OBTR                                        18210000
182200         WHERE                                                    18220000
182300             OBTR.OTBND_TRIP_ID    = :PC233-TRIP-ID               18230000
182400         AND OBTR.TRIP_ACTV_CDE    = 'A'                          18240000
182500     END-EXEC                                                     18250000
182600                                                                  18260000
182700     EVALUATE TRUE                                                18270000
182800         WHEN SQLCODE = ZERO                                      18280000
182900         WHEN SQLCODE = -811                                      18290000
183000         WHEN SQLCODE = +100                                      18300000
183100             CONTINUE                                             18310000
183200         WHEN SQLCODE = -904                                      18320000
183300         WHEN SQLCODE = -913                                      18330000
183400         WHEN SQLCODE = -911                                      18340000
183500             MOVE 11                  TO PV-ERROR-NBR             18350000
183600             PERFORM 9903-WRITE-CICS-LOG                          18360000
183700             PERFORM 9000-SOFT-ABORT                              18370000
183800         WHEN SQLWARN0 NOT = SPACES                               18380000
183900         WHEN SQLCODE NOT EQUAL ZERO                              18390000
184000             MOVE 12                  TO PV-ERROR-NBR             18400000
184100                                         PC233-ERROR-NBR          18410000
184200             PERFORM 9903-WRITE-CICS-LOG                          18420000
184300             MOVE '7020-SELECT-TSUOBTR'                           18430000
184400                                      TO PC233-PARAGRAPH          18440000
184500             MOVE 'PCKRF879 - CHECK DEST ON TRAILER'              18450000
184600                                      TO PC233-MESSAGE-TEXT(1)    18460000
184700             MOVE SQLCA               TO PC233-SQLCA              18470000
184800             MOVE 'TSUOBTR'           TO PC233-DB2-TABLE-NAME(1)  18480000
184900             SET PC233-ABEND          TO TRUE                     18490000
185000             MOVE 99                  TO PC233-PGM-MSG-NBR        18500000
185100             PERFORM 8210-XCTL-ERROR-SCREEN                       18510000
185200     END-EVALUATE.                                                18520000
185300                                                                  18530000
185400                                                                  18540000
185500 7030-COUNT-OTBND-CART.                                           18550000
185600                                                                  18560000
185700*  COUNT CHILDREN OF THE MASTER CARTON                            18570000
185800*  PC233-ERROR-MSTR-CARTON WAS FOUND IN THE PREVIOUS CYCLE        18580000
185900*  AS PART OF THE WARNING SCREEN FOR LOADING A CHILD              18590000
186000     EXEC SQL                                                     18600000
186100         SELECT COUNT(*)                                          18610000
186200         INTO   :PC233-ERROR-KID-COUNT                            18620000
186300         FROM   SUT_OTBND_CART A                                  18630000
186400         WHERE  A.PRNT_CART_ID      = :PC233-ERROR-MSTR-CARTON    18640000
186500           AND  A.PRNT_CART_ID      <> A.SHIPT_UNT_ID             18650000
186600           AND  A.ACTV_IND = 'Y'                                  18660000
186700                                                                  18670000
186800     END-EXEC.                                                    18680000
186900                                                                  18690000
187000     EVALUATE TRUE                                                18700000
187100         WHEN SQLCODE = ZERO                                      18710000
187200         WHEN SQLCODE = -811                                      18720000
187300         WHEN SQLCODE = +100                                      18730000
187400             CONTINUE                                             18740000
187500         WHEN SQLCODE = -904                                      18750000
187600         WHEN SQLCODE = -913                                      18760000
187700         WHEN SQLCODE = -911                                      18770000
187800             MOVE 13                  TO PV-ERROR-NBR             18780000
187900             PERFORM 9903-WRITE-CICS-LOG                          18790000
188000             PERFORM 9000-SOFT-ABORT                              18800000
188100         WHEN SQLWARN0 NOT = SPACES                               18810000
188200         WHEN SQLCODE NOT EQUAL ZERO                              18820000
188300             MOVE 14                  TO PV-ERROR-NBR             18830000
188400                                         PC233-ERROR-NBR          18840000
188500             PERFORM 9903-WRITE-CICS-LOG                          18850000
188600             MOVE '7030-COUNT-OTBND-CART'                         18860000
188700                                      TO PC233-PARAGRAPH          18870000
188800             MOVE 'PCKRF879 - CHECK DEST ON TRAILER'              18880000
188900                                      TO PC233-MESSAGE-TEXT(1)    18890000
189000             MOVE SQLCA               TO PC233-SQLCA              18900000
189100             MOVE 'SUT00024'          TO PC233-DB2-TABLE-NAME(1)  18910000
189200             SET PC233-ABEND          TO TRUE                     18920000
189300             MOVE 99                  TO PC233-PGM-MSG-NBR        18930000
189400             PERFORM 8210-XCTL-ERROR-SCREEN                       18940000
189500     END-EVALUATE.                                                18950000
189600                                                                  18960000
189700                                                                  18970000
189800 7040-SELECT-OTBND-CART.                                          18980000
189900     EXEC SQL                                                     18990000
190000         SELECT B.SHIPT_UNT_ID                                    19000000
190100         ,      B.PRNT_CART_ID                                    19010000
190200         ,      B.CART_SRC_CDE                                    19020000
190300         INTO :DK-PARENT-SHIPT-UNT-ID                             19030000
190400         ,    :SUT00024-PRNT-CART-ID                              19040000
190500         ,    :PV-SHIPT-UNT-SRC-ID                                19050000
190600         FROM   SUT_OTBND_CART A                                  19060000
190700         ,      SUT_OTBND_CART B                                  19070000
190800         WHERE  A.SHIPT_UNT_ID      = :DK-FIND-CARTON             19080000
190900           AND  A.PRNT_CART_ID      = B.SHIPT_UNT_ID              19090000
191000     END-EXEC                                                     19100000
191100                                                                  19110000
191200     EVALUATE TRUE                                                19120000
191300         WHEN SQLCODE = ZERO                                      19130000
191400         WHEN SQLCODE = -811                                      19140000
191500         WHEN SQLCODE = +100                                      19150000
191600             CONTINUE                                             19160000
191700         WHEN SQLCODE = -904                                      19170000
191800         WHEN SQLCODE = -913                                      19180000
191900         WHEN SQLCODE = -911                                      19190000
192000             MOVE 15                  TO PV-ERROR-NBR             19200000
192100             PERFORM 9903-WRITE-CICS-LOG                          19210000
192200             PERFORM 9000-SOFT-ABORT                              19220000
192300         WHEN SQLWARN0 NOT = SPACES                               19230000
192400         WHEN SQLCODE NOT EQUAL ZERO                              19240000
192500             MOVE 16                  TO PV-ERROR-NBR             19250000
192600                                         PC233-ERROR-NBR          19260000
192700             PERFORM 9903-WRITE-CICS-LOG                          19270000
192800             MOVE '7040-SELECT-OTBND-CART'                        19280000
192900                                      TO PC233-PARAGRAPH          19290000
193000             MOVE 'PCKRF879 - FIND PARENT SHPUNT'                 19300000
193100                                      TO PC233-MESSAGE-TEXT(1)    19310000
193200             MOVE SQLCA               TO PC233-SQLCA              19320000
193300             MOVE 'SUT00024'          TO PC233-DB2-TABLE-NAME(1)  19330000
193400             SET PC233-ABEND          TO TRUE                     19340000
193500             MOVE 99                  TO PC233-PGM-MSG-NBR        19350000
193600             PERFORM 8210-XCTL-ERROR-SCREEN                       19360000
193700     END-EVALUATE.                                                19370000
193800                                                                  19380000
193900                                                                  19390000
194000 7100-OPEN-CHILD-CSR.                                             19400000
194100                                                                  19410000
194200     EXEC SQL                                                     19420000
194300         OPEN CHILD-CSR                                           19430000
194400     END-EXEC.                                                    19440000
194500                                                                  19450000
194600     EVALUATE TRUE                                                19460000
194700         WHEN SQLCODE = ZERO                                      19470000
194800             SET PS-ALL-KIDS          TO TRUE                     19480000
194900         WHEN SQLCODE = -904                                      19490000
195000         WHEN SQLCODE = -913                                      19500000
195100         WHEN SQLCODE = -911                                      19510000
195200             MOVE 17                  TO PV-ERROR-NBR             19520000
195300             PERFORM 9903-WRITE-CICS-LOG                          19530000
195400             PERFORM 9000-SOFT-ABORT                              19540000
195500         WHEN SQLWARN0 NOT = SPACES                               19550000
195600         WHEN SQLCODE NOT EQUAL ZERO                              19560000
195700             MOVE 18                  TO PV-ERROR-NBR             19570000
195800                                         PC233-ERROR-NBR          19580000
195900             PERFORM 9903-WRITE-CICS-LOG                          19590000
196000             MOVE '7100-OPEN-CHILD-CSR'                           19600000
196100                                      TO PC233-PARAGRAPH          19610000
196200             MOVE 'PCKRF879 - FIND ALL CHILDREN'                  19620000
196300                                      TO PC233-MESSAGE-TEXT(1)    19630000
196400             MOVE SQLCA               TO PC233-SQLCA              19640000
196500             MOVE 'SUT00024'          TO PC233-DB2-TABLE-NAME(1)  19650000
196600             SET PC233-ABEND          TO TRUE                     19660000
196700             MOVE 99                  TO PC233-PGM-MSG-NBR        19670000
196800             PERFORM 8210-XCTL-ERROR-SCREEN                       19680000
196900     END-EVALUATE.                                                19690000
197000                                                                  19700000
197100                                                                  19710000
197200 7110-FETCH-CHILD-CSR.                                            19720000
197300                                                                  19730000
197400     EXEC SQL                                                     19740000
197500         FETCH CHILD-CSR                                          19750000
197600         INTO                                                     19760000
197700             :SUT00024-SHIPT-UNT-ID                               19770000
197800         ,   :SUT00024-MSTR-CART-IND                              19780000
197900     END-EXEC.                                                    19790000
198000                                                                  19800000
198100     EVALUATE TRUE                                                19810000
198200         WHEN SQLCODE = ZERO                                      19820000
198300             CONTINUE                                             19830000
198400         WHEN SQLCODE = +100                                      19840000
198500             SET PS-END-OF-KIDS       TO TRUE                     19850000
198600         WHEN SQLCODE = -904                                      19860000
198700         WHEN SQLCODE = -913                                      19870000
198800         WHEN SQLCODE = -911                                      19880000
198900             MOVE 19                  TO PV-ERROR-NBR             19890000
199000             PERFORM 9903-WRITE-CICS-LOG                          19900000
199100             PERFORM 9000-SOFT-ABORT                              19910000
199200         WHEN SQLWARN0 NOT = SPACES                               19920000
199300         WHEN SQLCODE NOT EQUAL ZERO                              19930000
199400             MOVE 20                  TO PV-ERROR-NBR             19940000
199500                                         PC233-ERROR-NBR          19950000
199600             PERFORM 9903-WRITE-CICS-LOG                          19960000
199700             MOVE '7110-FETCH-CHILD-CSR'                          19970000
199800                                      TO PC233-PARAGRAPH          19980000
199900             MOVE 'PCKRF879 - FETCH A CHILD'                      19990000
200000                                      TO PC233-MESSAGE-TEXT(1)    20000000
200100             MOVE SQLCA               TO PC233-SQLCA              20010000
200200             MOVE 'SUT00024'          TO PC233-DB2-TABLE-NAME(1)  20020000
200300             SET PC233-ABEND          TO TRUE                     20030000
200400             MOVE 99                  TO PC233-PGM-MSG-NBR        20040000
200500             PERFORM 8210-XCTL-ERROR-SCREEN                       20050000
200600     END-EVALUATE.                                                20060000
200700                                                                  20070000
200800                                                                  20080000
200900 7120-CLOSE-CHILD-CSR.                                            20090000
201000                                                                  20100000
201100     EXEC SQL                                                     20110000
201200         CLOSE CHILD-CSR                                          20120000
201300     END-EXEC.                                                    20130000
201400                                                                  20140000
201500     EVALUATE TRUE                                                20150000
201600         WHEN SQLCODE = ZERO                                      20160000
201700             CONTINUE                                             20170000
201800         WHEN SQLCODE = -904                                      20180000
201900         WHEN SQLCODE = -913                                      20190000
202000         WHEN SQLCODE = -911                                      20200000
202100             MOVE 21                  TO PV-ERROR-NBR             20210000
202200             PERFORM 9903-WRITE-CICS-LOG                          20220000
202300             PERFORM 9000-SOFT-ABORT                              20230000
202400         WHEN SQLWARN0 NOT = SPACES                               20240000
202500         WHEN SQLCODE NOT EQUAL ZERO                              20250000
202600             MOVE 22                  TO PV-ERROR-NBR             20260000
202700                                         PC233-ERROR-NBR          20270000
202800             PERFORM 9903-WRITE-CICS-LOG                          20280000
202900             MOVE '7120-CLOSE-CHILD-CSR'                          20290000
203000                                      TO PC233-PARAGRAPH          20300000
203100             MOVE 'PCKRF879 - CLOSE CHILD CURSOR'                 20310000
203200                                      TO PC233-MESSAGE-TEXT(1)    20320000
203300             MOVE SQLCA               TO PC233-SQLCA              20330000
203400             MOVE 'SUT00024'          TO PC233-DB2-TABLE-NAME(1)  20340000
203500             SET PC233-ABEND          TO TRUE                     20350000
203600             MOVE 99                  TO PC233-PGM-MSG-NBR        20360000
203700             PERFORM 8210-XCTL-ERROR-SCREEN                       20370000
203800     END-EVALUATE.                                                20380000
203900                                                                  20390000
204000 7130-OPEN-PARENT-CSR.                                            20400000
204100                                                                  20410000
204200     EXEC SQL                                                     20420000
204300         OPEN PARENT-CSR                                          20430000
204400     END-EXEC.                                                    20440000
204500                                                                  20450000
204600     EVALUATE TRUE                                                20460000
204700         WHEN SQLCODE = ZERO                                      20470000
204800             CONTINUE                                             20480000
204900         WHEN SQLCODE = -904                                      20490000
205000         WHEN SQLCODE = -913                                      20500000
205100         WHEN SQLCODE = -911                                      20510000
205200             MOVE 23                  TO PV-ERROR-NBR             20520000
205300             PERFORM 9903-WRITE-CICS-LOG                          20530000
205400             PERFORM 9000-SOFT-ABORT                              20540000
205500         WHEN SQLWARN0 NOT = SPACES                               20550000
205600         WHEN SQLCODE NOT EQUAL ZERO                              20560000
205700             MOVE 24                  TO PV-ERROR-NBR             20570000
205800                                         PC233-ERROR-NBR          20580000
205900             PERFORM 9903-WRITE-CICS-LOG                          20590000
206000             MOVE '7130-OPEN-PARENT-CSR'                          20600000
206100                                      TO PC233-PARAGRAPH          20610000
206200             MOVE 'PCKRF879 - FIND ALL PARENTS'                   20620000
206300                                      TO PC233-MESSAGE-TEXT(1)    20630000
206400             MOVE SQLCA               TO PC233-SQLCA              20640000
206500             MOVE 'SUT00024'          TO PC233-DB2-TABLE-NAME(1)  20650000
206600             SET PC233-ABEND          TO TRUE                     20660000
206700             MOVE 99                  TO PC233-PGM-MSG-NBR        20670000
206800             PERFORM 8210-XCTL-ERROR-SCREEN                       20680000
206900     END-EVALUATE.                                                20690000
207000                                                                  20700000
207100                                                                  20710000
207200 7140-FETCH-PARENT-CSR.                                           20720000
207300                                                                  20730000
207400     EXEC SQL                                                     20740000
207500         FETCH PARENT-CSR                                         20750000
207600         INTO                                                     20760000
207700             :DK-PARENT-SHIPT-UNT-ID                              20770000
207800         ,   :SUT00024-SHIPT-UNT-ID                               20780000
207900         ,   :SUT00024-CART-SRC-CDE                               20790000
208000         ,   :SUT00024-MSTR-CART-IND                              20800000
208100     END-EXEC.                                                    20810000
208200                                                                  20820000
208300     EVALUATE TRUE                                                20830000
208400         WHEN SQLCODE = ZERO                                      20840000
208500             CONTINUE                                             20850000
208600         WHEN SQLCODE = +100                                      20860000
208700             SET PS-END-OF-PARENTS    TO TRUE                     20870000
208800         WHEN SQLCODE = -904                                      20880000
208900         WHEN SQLCODE = -913                                      20890000
209000         WHEN SQLCODE = -911                                      20900000
209100             MOVE 25                  TO PV-ERROR-NBR             20910000
209200             PERFORM 9903-WRITE-CICS-LOG                          20920000
209300             PERFORM 9000-SOFT-ABORT                              20930000
209400         WHEN SQLWARN0 NOT = SPACES                               20940000
209500         WHEN SQLCODE NOT EQUAL ZERO                              20950000
209600             MOVE 26                  TO PV-ERROR-NBR             20960000
209700                                         PC233-ERROR-NBR          20970000
209800             PERFORM 9903-WRITE-CICS-LOG                          20980000
209900             MOVE '7140-FETCH-PARENT-CSR'                         20990000
210000                                      TO PC233-PARAGRAPH          21000000
210100             MOVE 'PCKRF879 - FETCH A PARENT'                     21010000
210200                                      TO PC233-MESSAGE-TEXT(1)    21020000
210300             MOVE SQLCA               TO PC233-SQLCA              21030000
210400             MOVE 'SUT00024'          TO PC233-DB2-TABLE-NAME(1)  21040000
210500             SET PC233-ABEND          TO TRUE                     21050000
210600             MOVE 99                  TO PC233-PGM-MSG-NBR        21060000
210700             PERFORM 8210-XCTL-ERROR-SCREEN                       21070000
210800     END-EVALUATE.                                                21080000
210900                                                                  21090000
211000                                                                  21100000
211100 7145-CLOSE-PARENT-CSR.                                           21110000
211200                                                                  21120000
211300     EXEC SQL                                                     21130000
211400         CLOSE PARENT-CSR                                         21140000
211500     END-EXEC.                                                    21150000
211600                                                                  21160000
211700     EVALUATE TRUE                                                21170000
211800         WHEN SQLCODE = ZERO                                      21180000
211900             CONTINUE                                             21190000
212000         WHEN SQLCODE = -904                                      21200000
212100         WHEN SQLCODE = -913                                      21210000
212200         WHEN SQLCODE = -911                                      21220000
212300             MOVE 27                  TO PV-ERROR-NBR             21230000
212400             PERFORM 9903-WRITE-CICS-LOG                          21240000
212500             PERFORM 9000-SOFT-ABORT                              21250000
212600         WHEN SQLWARN0 NOT = SPACES                               21260000
212700         WHEN SQLCODE NOT EQUAL ZERO                              21270000
212800             MOVE 28                  TO PV-ERROR-NBR             21280000
212900                                         PC233-ERROR-NBR          21290000
213000             PERFORM 9903-WRITE-CICS-LOG                          21300000
213100             MOVE '7145-CLOSE-PARENT-CSR'                         21310000
213200                                      TO PC233-PARAGRAPH          21320000
213300             MOVE 'PCKRF879 - CLOSE PARENT CURSOR'                21330000
213400                                      TO PC233-MESSAGE-TEXT(1)    21340000
213500             MOVE SQLCA               TO PC233-SQLCA              21350000
213600             MOVE 'SUT00024'          TO PC233-DB2-TABLE-NAME(1)  21360000
213700             SET PC233-ABEND          TO TRUE                     21370000
213800             MOVE 99                  TO PC233-PGM-MSG-NBR        21380000
213900             PERFORM 8210-XCTL-ERROR-SCREEN                       21390000
214000     END-EVALUATE.                                                21400000
214100                                                                  21410000
214200                                                                  21420000
214300 7150-INSERT-OTBND-LOC.                                           21430000
214400                                                                  21440000
214500     EXEC SQL                                                     21450000
214600         INSERT INTO SUT_OTBND_LOC                                21460000
214700         (                                                        21470000
214800              SHIPT_UNT_ID                                        21480000
214900              , LOC_NBR                                           21490000
215000              , SCN_CDE                                           21500000
215100              , CRE_USR_ID                                        21510000
215200              , CRE_TMST                                          21520000
215300              , OTBND_TRIP_ID                                     21530000
215400              , ACTV_CDE                                          21540000
215500              , INBD_TRIP_ID                                      21550000
215600         )                                                        21560000
215700         VALUES                                                   21570000
215800         (                                                        21580000
215900                 :SUT00024-SHIPT-UNT-ID                           21590000
216000               , :PC233-OPER-UNT-ID                               21600000
216100               , :SUT00027-SCN-CDE                                21610000
216200               , :PC233-USER-ID                                   21620000
216300               , :PV-CURRENT-TIMESTAMP                            21630000
216400               , :PC233-TRIP-ID                                   21640000
216500               , :SUT00027-ACTV-CDE                               21650000
216600               , 0                                                21660000
216700           )                                                      21670000
216800     END-EXEC.                                                    21680000
216900                                                                  21690000
217000     EVALUATE TRUE                                                21700000
217100         WHEN SQLCODE = ZERO                                      21710000
217200             CONTINUE                                             21720000
217300*            IF PC233-SCAN-ON-CONTAINER                           21730000
217400*               MOVE 'CONTNR SCANNED ON' TO AMSGLNO               21740000
217500*            ELSE                                                 21750000
217600*               MOVE 'CONTNR SCANNED OFF' TO AMSGLNO              21760000
217700*            END-IF                                               21770000
217800         WHEN SQLCODE = -904                                      21780000
217900         WHEN SQLCODE = -913                                      21790000
218000         WHEN SQLCODE = -911                                      21800000
218100             MOVE 29                  TO PV-ERROR-NBR             21810000
218200             PERFORM 9903-WRITE-CICS-LOG                          21820000
218300             PERFORM 9000-SOFT-ABORT                              21830000
218400         WHEN SQLWARN0 NOT = SPACES                               21840000
218500         WHEN SQLCODE NOT EQUAL ZERO                              21850000
218600             MOVE 30                  TO PV-ERROR-NBR             21860000
218700                                         PC233-ERROR-NBR          21870000
218800             PERFORM 9903-WRITE-CICS-LOG                          21880000
218900             MOVE '7150-INSERT-OTBND-LOC'                         21890000
219000                                      TO PC233-PARAGRAPH          21900000
219100             MOVE 'PCKRF879 - INSERT SUT_OTBND_LOC ROW'           21910000
219200                                      TO PC233-MESSAGE-TEXT(1)    21920000
219300             MOVE SUT00024-SHIPT-UNT-ID TO PV-DISP-SHIPT-UNT-ID   21930000
219400             MOVE PV-DISP-SHIPT-UNT-ID                            21940000
219500                                      TO PC233-MESSAGE-TEXT(2)    21950000
219600             MOVE SQLCA               TO PC233-SQLCA              21960000
219700             MOVE 'SUT00027'          TO PC233-DB2-TABLE-NAME(1)  21970000
219800             SET PC233-ABEND          TO TRUE                     21980000
219900             MOVE 99                  TO PC233-PGM-MSG-NBR        21990000
220000             PERFORM 8210-XCTL-ERROR-SCREEN                       22000000
220100     END-EVALUATE.                                                22010000
220200                                                                  22020000
220300                                                                  22030000
220400 7160-INACTIVATE-AND-UNHOOK.                                      22040000
220500*    PC233-CARTON IS THE OUTER MOST CARTON OR PALLET              22050000
220600*    CHILD CURSOR COULD CONTAIN MASTER CARTONS THAT WOULD         22060000
220700*    HAVE CHILDREN OF THEIR OWN.  THESE MASTERS WILL BE           22070000
220800*    INACTIVATED AS WE FIND THEM.  THE OUTER MOST CARTON IS       22080000
220900*    ALSO PART OF THE CURSOR                                      22090000
221000                                                                  22100000
221100     EXEC SQL                                                     22110000
221200         UPDATE SUT_OTBND_CART                                    22120000
221300             SET ACTV_IND      = 'N'                              22130000
221400         ,   PRNT_CART_ID      = :SUT00024-SHIPT-UNT-ID           22140000
221500         WHERE                                                    22150000
221600             SHIPT_UNT_ID = :SUT00024-SHIPT-UNT-ID                22160000
221700     END-EXEC.                                                    22170000
221800                                                                  22180000
221900     EVALUATE TRUE                                                22190000
222000         WHEN SQLCODE = ZERO                                      22200000
222100             CONTINUE                                             22210000
222200         WHEN SQLCODE = -904                                      22220000
222300         WHEN SQLCODE = -913                                      22230000
222400         WHEN SQLCODE = -911                                      22240000
222500             MOVE 31                  TO PV-ERROR-NBR             22250000
222600             PERFORM 9903-WRITE-CICS-LOG                          22260000
222700             PERFORM 9000-SOFT-ABORT                              22270000
222800         WHEN SQLWARN0 NOT = SPACES                               22280000
222900         WHEN SQLCODE NOT EQUAL ZERO                              22290000
223000             MOVE 32                  TO PV-ERROR-NBR             22300000
223100                                         PC233-ERROR-NBR          22310000
223200             PERFORM 9903-WRITE-CICS-LOG                          22320000
223300             MOVE '7160-INACTIVATE-AND-UNHOOK'                    22330000
223400                                      TO PC233-PARAGRAPH          22340000
223500             MOVE 'PCKRF879 - UPDATE SUT_OTBND_CART ROW'          22350000
223600                                      TO PC233-MESSAGE-TEXT(1)    22360000
223700             MOVE SQLCA               TO PC233-SQLCA              22370000
223800             MOVE 'SUT00024'          TO PC233-DB2-TABLE-NAME(1)  22380000
223900             SET PC233-ABEND          TO TRUE                     22390000
224000             MOVE 99                  TO PC233-PGM-MSG-NBR        22400000
224100             PERFORM 8210-XCTL-ERROR-SCREEN                       22410000
224200     END-EVALUATE.                                                22420000
224300                                                                  22430000
224400                                                                  22440000
224500 7170-UNHOOK-FROM-PARENT.                                         22450000
224600                                                                  22460000
224700     EXEC SQL                                                     22470000
224800         UPDATE SUT_OTBND_CART                                    22480000
224900             SET PRNT_CART_ID      = :SUT00024-SHIPT-UNT-ID       22490000
225000         WHERE                                                    22500000
225100             SHIPT_UNT_ID          = :SUT00024-SHIPT-UNT-ID       22510000
225200         AND ACTV_IND              = 'Y'                          22520000
225300     END-EXEC.                                                    22530000
225400                                                                  22540000
225500     EVALUATE TRUE                                                22550000
225600         WHEN SQLCODE = ZERO                                      22560000
225700             CONTINUE                                             22570000
225800         WHEN SQLCODE = -904                                      22580000
225900         WHEN SQLCODE = -913                                      22590000
226000         WHEN SQLCODE = -911                                      22600000
226100             MOVE 33                  TO PV-ERROR-NBR             22610000
226200             PERFORM 9903-WRITE-CICS-LOG                          22620000
226300             PERFORM 9000-SOFT-ABORT                              22630000
226400         WHEN SQLWARN0 NOT = SPACES                               22640000
226500         WHEN SQLCODE NOT EQUAL ZERO                              22650000
226600             MOVE 34                  TO PV-ERROR-NBR             22660000
226700                                         PC233-ERROR-NBR          22670000
226800             PERFORM 9903-WRITE-CICS-LOG                          22680000
226900             MOVE '7170-UNHOOK-FROM-PARENT'                       22690000
227000                                      TO PC233-PARAGRAPH          22700000
227100             MOVE 'PCKRF879 - UPDATE SUT_OTBND_CART ROW'          22710000
227200                                      TO PC233-MESSAGE-TEXT(1)    22720000
227300             MOVE SQLCA               TO PC233-SQLCA              22730000
227400             MOVE 'SUT00024'          TO PC233-DB2-TABLE-NAME(1)  22740000
227500             SET PC233-ABEND          TO TRUE                     22750000
227600             MOVE 99                  TO PC233-PGM-MSG-NBR        22760000
227700             PERFORM 8210-XCTL-ERROR-SCREEN                       22770000
227800     END-EVALUATE.                                                22780000
227900                                                                  22790000
228000                                                                  22800000
228100 7180-SELECT-OTBND-CART.                                          22810000
228200                                                                  22820000
228300     EXEC SQL                                                     22830000
228400         SELECT                                                   22840000
228500             PUNT.SHIPT_UNT_ID                                    22850000
228600         ,   PUNT.CART_SRC_CDE                                    22860000
228700         ,   PUNT.PRNT_CART_ID                                    22870000
228800         ,   PUNT.MSTR_CART_IND                                   22880000
228900         ,   PUNT.ACTV_IND                                        22890000
229000         INTO                                                     22900000
229100            :SUT00024-SHIPT-UNT-ID                                22910000
229200         ,  :SUT00024-CART-SRC-CDE                                22920000
229300         ,  :SUT00024-PRNT-CART-ID                                22930000
229400         ,  :SUT00024-MSTR-CART-IND                               22940000
229500         ,  :SUT00024-ACTV-IND                                    22950000
229600         FROM                                                     22960000
229700              SUT_OTBND_CART PUNT                                 22970000
229800         WHERE                                                    22980000
229900             PUNT.SHIPT_UNT_ID     = :PC233-CARTON                22990000
230000     END-EXEC                                                     23000000
230100                                                                  23010000
230200     EVALUATE TRUE                                                23020000
230300         WHEN SQLCODE = ZERO                                      23030000
230400             SET CA-OTBND-CART-YES    TO TRUE                     23040000
230500         WHEN SQLCODE = +100                                      23050000
230600             SET CA-OTBND-CART-NO     TO TRUE                     23060000
230700*            SET PS-ERRORS-YES        TO TRUE                     23070000
230800*            MOVE 'CTN NOT ON FILE'   TO AMSGLNO                  23080000
230900         WHEN SQLCODE = -904                                      23090000
231000         WHEN SQLCODE = -913                                      23100000
231100         WHEN SQLCODE = -911                                      23110000
231200             MOVE 35                  TO PV-ERROR-NBR             23120000
231300             PERFORM 9903-WRITE-CICS-LOG                          23130000
231400             PERFORM 9000-SOFT-ABORT                              23140000
231500         WHEN SQLWARN0 NOT = SPACES                               23150000
231600         WHEN SQLCODE NOT EQUAL ZERO                              23160000
231700             MOVE 36                  TO PV-ERROR-NBR             23170000
231800                                         PC233-ERROR-NBR          23180000
231900             PERFORM 9903-WRITE-CICS-LOG                          23190000
232000             MOVE '7180-SELECT-SHPUNT'                            23200000
232100                                      TO PC233-PARAGRAPH          23210000
232200             MOVE 'PCKRF879 - CHECK DEST ON CARTON'               23220000
232300                                      TO PC233-MESSAGE-TEXT(1)    23230000
232400             MOVE SQLCA               TO PC233-SQLCA              23240000
232500             MOVE 'SUT00024'          TO PC233-DB2-TABLE-NAME(1)  23250000
232600             SET PC233-ABEND          TO TRUE                     23260000
232700             MOVE 99                  TO PC233-PGM-MSG-NBR        23270000
232800             PERFORM 8210-XCTL-ERROR-SCREEN                       23280000
232900     END-EVALUATE.                                                23290000
233000                                                                  23300000
233100 7185-SELECT-OTBND-CART.                                          23310000
233200     EXEC SQL                                                     23320000
233300         SELECT                                                   23330000
233400             PUNT.SHIPT_UNT_ID                                    23340000
233500         ,   PUNT.CART_SRC_CDE                                    23350000
233600         ,   PUNT.PRNT_CART_ID                                    23360000
233700         ,   PUNT.MSTR_CART_IND                                   23370000
233800         ,   PUNT.ACTV_IND                                        23380000
233900         ,   PUNT.ORIG_CART_ID                                    23390000
234000     INTO                                                         23400000
234100            :SUT00024-SHIPT-UNT-ID                                23410000
234200         ,  :SUT00024-CART-SRC-CDE                                23420000
234300         ,  :SUT00024-PRNT-CART-ID                                23430000
234400         ,  :SUT00024-MSTR-CART-IND                               23440000
234500         ,  :SUT00024-ACTV-IND                                    23450000
234600         ,  :SUT00024-ORIG-CART-ID                                23460000
234700          FROM  SUT_OTBND_CART PUNT                               23470000
234800         WHERE  PUNT.ORIG_CART_ID   = :PC233-CARTON               23480000
234900     END-EXEC.                                                    23490000
235000                                                                  23500000
235100     EVALUATE TRUE                                                23510000
235200         WHEN SQLCODE = ZERO                                      23520000
235300             MOVE SUT00024-SHIPT-UNT-ID TO CA-VENDOR-CARTON       23530000
235400         WHEN SQLCODE = +100                                      23540000
235500             SET PS-ERRORS-YES        TO TRUE                     23550000
235600             MOVE 'CTN NOT ON FILE'   TO AMSGLNO                  23560000
235700         WHEN SQLCODE = -904                                      23570000
235800         WHEN SQLCODE = -913                                      23580000
235900         WHEN SQLCODE = -911                                      23590000
236000             MOVE 37                  TO PV-ERROR-NBR             23600000
236100             PERFORM 9903-WRITE-CICS-LOG                          23610000
236200             PERFORM 9000-SOFT-ABORT                              23620000
236300         WHEN SQLWARN0 NOT = SPACES                               23630000
236400         WHEN SQLCODE NOT EQUAL ZERO                              23640000
236500             MOVE 38                  TO PV-ERROR-NBR             23650000
236600                                         PC233-ERROR-NBR          23660000
236700             PERFORM 9903-WRITE-CICS-LOG                          23670000
236800             MOVE '7185-SELECT-OTBND-CART'                        23680000
236900                                      TO PC233-PARAGRAPH          23690000
237000             MOVE 'PCKRF879 - CHECK DEST ON CARTON'               23700000
237100                                      TO PC233-MESSAGE-TEXT(1)    23710000
237200             MOVE SQLCA               TO PC233-SQLCA              23720000
237300             MOVE 'SUT00024'          TO PC233-DB2-TABLE-NAME(1)  23730000
237400             SET PC233-ABEND          TO TRUE                     23740000
237500             MOVE 99                  TO PC233-PGM-MSG-NBR        23750000
237600             PERFORM 8210-XCTL-ERROR-SCREEN                       23760000
237700     END-EVALUATE.                                                23770000
237800                                                                  23780000
237900                                                                  23790000
238000 7190-SELECT-OTBND-LOC.                                           23800000
238100                                                                  23810000
238200     EXEC SQL                                                     23820000
238300         SELECT                                                   23830000
238400             UNLO.SCN_CDE                                         23840000
238500         ,   UNLO.OTBND_TRIP_ID                                   23850000
238600         INTO                                                     23860000
238700             :SUT00027-SCN-CDE                                    23870000
238800         ,   :PV-SCAN-ON-TRIP-ID                                  23880000
238900         FROM                                                     23890000
239000              SUT_OTBND_LOC UNLO                                  23900000
239100         WHERE                                                    23910000
239200             UNLO.SHIPT_UNT_ID     = :PC233-CARTON                23920000
239300         AND UNLO.CRE_TMST =                                      23930000
239400         (                                                        23940000
239500         SELECT MAX(UNLO1.CRE_TMST)                               23950000
239600         FROM                                                     23960000
239700            SUT_OTBND_LOC UNLO1                                   23970000
239800         WHERE                                                    23980000
239900             UNLO1.SHIPT_UNT_ID     = :PC233-CARTON               23990000
240000         AND UNLO1.SCN_CDE          = 'SHON'                      24000000
240100         AND UNLO1.ACTV_CDE         = 'A'                         24010000
240200         )                                                        24020000
240300     END-EXEC                                                     24030000
240400                                                                  24040000
240500     EVALUATE TRUE                                                24050000
240600         WHEN SQLCODE = ZERO                                      24060000
240700         WHEN SQLCODE = +100                                      24070000
240800             CONTINUE                                             24080000
240900         WHEN SQLCODE = -904                                      24090000
241000         WHEN SQLCODE = -913                                      24100000
241100         WHEN SQLCODE = -911                                      24110000
241200             MOVE 39                  TO PV-ERROR-NBR             24120000
241300             PERFORM 9903-WRITE-CICS-LOG                          24130000
241400             PERFORM 9000-SOFT-ABORT                              24140000
241500         WHEN SQLWARN0 NOT = SPACES                               24150000
241600         WHEN SQLCODE NOT EQUAL ZERO                              24160000
241700             MOVE 40                  TO PV-ERROR-NBR             24170000
241800                                         PC233-ERROR-NBR          24180000
241900             PERFORM 9903-WRITE-CICS-LOG                          24190000
242000             MOVE '7190-SELECT-OTBND-LOC'                         24200000
242100                                      TO PC233-PARAGRAPH          24210000
242200             MOVE 'PCKRF879 - CHECK DEST ON CARTON'               24220000
242300                                      TO PC233-MESSAGE-TEXT(1)    24230000
242400             MOVE SQLCA               TO PC233-SQLCA              24240000
242500             MOVE 'SUT00027'          TO PC233-DB2-TABLE-NAME(1)  24250000
242600             SET PC233-ABEND          TO TRUE                     24260000
242700             MOVE 99                  TO PC233-PGM-MSG-NBR        24270000
242800             PERFORM 8210-XCTL-ERROR-SCREEN                       24280000
242900     END-EVALUATE.                                                24290000
243000                                                                  24300000
243100                                                                  24310000
243200 7200-INACT-DIVERTER-CTN.                                         24320000
243300                                                                  24330000
243400     EXEC SQL                                                     24340000
243500         UPDATE TSUCRDV                                           24350000
243600             SET ACTV_CDE       = 'I'                             24360000
243700             ,   NACTV_USR_ID   = :PC233-USER-ID                  24370000
243800         WHERE                                                    24380000
243900             BRCDE_NBR          = :PC233-BRCDE-NBR                24390000
244000     END-EXEC.                                                    24400000
244100                                                                  24410000
244200     EVALUATE TRUE                                                24420000
244300         WHEN SQLCODE = ZERO                                      24430000
244400         WHEN SQLCODE = +100                                      24440000
244500             CONTINUE                                             24450000
244600         WHEN SQLCODE = -904                                      24460000
244700         WHEN SQLCODE = -913                                      24470000
244800         WHEN SQLCODE = -911                                      24480000
244900             MOVE 41                  TO PV-ERROR-NBR             24490000
245000             PERFORM 9903-WRITE-CICS-LOG                          24500000
245100             PERFORM 9000-SOFT-ABORT                              24510000
245200         WHEN SQLWARN0 NOT = SPACES                               24520000
245300         WHEN SQLCODE NOT EQUAL ZERO                              24530000
245400             MOVE 42                  TO PV-ERROR-NBR             24540000
245500                                         PC233-ERROR-NBR          24550000
245600             PERFORM 9903-WRITE-CICS-LOG                          24560000
245700             MOVE '7200-INACT-DIVERTER-CTN'                       24570000
245800                                      TO PC233-PARAGRAPH          24580000
245900             MOVE 'PCKRF879 - UPDATE TSUCRDV ROW'                 24590000
246000                                      TO PC233-MESSAGE-TEXT(1)    24600000
246100             MOVE SQLCA               TO PC233-SQLCA              24610000
246200             MOVE 'SUT00024'          TO PC233-DB2-TABLE-NAME(1)  24620000
246300             SET PC233-ABEND          TO TRUE                     24630000
246400             MOVE 99                  TO PC233-PGM-MSG-NBR        24640000
246500             PERFORM 8210-XCTL-ERROR-SCREEN                       24650000
246600     END-EVALUATE.                                                24660000
246601                                                                  24660100
246602 7201-INACT-DIVERTER-CTN-CHILD.                                   24660200
246603                                                                  24660300
246604     MOVE SUT00024-SHIPT-UNT-ID       TO DK-BRCDE-NBR-CHILD-N     24660400
246605     EXEC SQL                                                     24660500
246606         UPDATE TSUCRDV                                           24660600
246607             SET ACTV_CDE       = 'I'                             24660700
246608             ,   NACTV_USR_ID   = :PC233-USER-ID                  24660800
246609         WHERE                                                    24660900
246610             BRCDE_NBR          = :DK-BRCDE-NBR-CHILD             24661000
246611     END-EXEC.                                                    24661100
246612                                                                  24661200
246613     EVALUATE TRUE                                                24661300
246614         WHEN SQLCODE = ZERO                                      24661400
246615         WHEN SQLCODE = +100                                      24661500
246616             CONTINUE                                             24661600
246617         WHEN SQLCODE = -904                                      24661700
246618         WHEN SQLCODE = -913                                      24661800
246619         WHEN SQLCODE = -911                                      24661900
246620             MOVE 41                  TO PV-ERROR-NBR             24662000
246621             PERFORM 9903-WRITE-CICS-LOG                          24662100
246622             PERFORM 9000-SOFT-ABORT                              24662200
246623         WHEN SQLWARN0 NOT = SPACES                               24662300
246624         WHEN SQLCODE NOT EQUAL ZERO                              24662400
246625             MOVE 421                 TO PV-ERROR-NBR             24662500
246626                                         PC233-ERROR-NBR          24662600
246627             PERFORM 9903-WRITE-CICS-LOG                          24662700
246628             MOVE '7201-INACT-DIVERTER-CTN-CHILD'                 24662800
246629                                      TO PC233-PARAGRAPH          24662900
246630             MOVE 'PCKRF879 - UPDATE TSUCRDV ROW'                 24663000
246640                                      TO PC233-MESSAGE-TEXT(1)    24664000
246650             MOVE SQLCA               TO PC233-SQLCA              24665000
246660             MOVE 'SUT00024'          TO PC233-DB2-TABLE-NAME(1)  24666000
246670             SET PC233-ABEND          TO TRUE                     24667000
246680             MOVE 99                  TO PC233-PGM-MSG-NBR        24668000
246690             PERFORM 8210-XCTL-ERROR-SCREEN                       24669000
246700     END-EVALUATE.                                                24670000
246800                                                                  24680000
246900                                                                  24690000
247000 7210-INACT-CURRENT-SHUNLO.                                       24700000
247100                                                                  24710000
247200     EXEC SQL                                                     24720000
247300         UPDATE SUT_OTBND_LOC                                     24730000
247400             SET ACTV_CDE     = 'I'                               24740000
247500         WHERE                                                    24750000
247600             SHIPT_UNT_ID     = :SUT00027-SHIPT-UNT-ID            24760000
247700         AND CRE_TMST =                                           24770000
247800         (                                                        24780000
247900         SELECT MAX(UNLO1.CRE_TMST)                               24790000
248000         FROM                                                     24800000
248100            SUT_OTBND_LOC UNLO1                                   24810000
248200         WHERE                                                    24820000
248300             UNLO1.SHIPT_UNT_ID     = :SUT00027-SHIPT-UNT-ID      24830000
248400         AND UNLO1.SCN_CDE          = 'SHON'                      24840000
248500         )                                                        24850000
248600     END-EXEC.                                                    24860000
248700                                                                  24870000
248800     EVALUATE TRUE                                                24880000
248900         WHEN SQLCODE = ZERO                                      24890000
249000         WHEN SQLCODE = +100                                      24900000
249100             CONTINUE                                             24910000
249200         WHEN SQLCODE = -904                                      24920000
249300         WHEN SQLCODE = -913                                      24930000
249400         WHEN SQLCODE = -911                                      24940000
249500             MOVE 43                  TO PV-ERROR-NBR             24950000
249600             PERFORM 9903-WRITE-CICS-LOG                          24960000
249700             PERFORM 9000-SOFT-ABORT                              24970000
249800         WHEN SQLWARN0 NOT = SPACES                               24980000
249900         WHEN SQLCODE NOT EQUAL ZERO                              24990000
250000             MOVE 44                  TO PV-ERROR-NBR             25000000
250100                                         PC233-ERROR-NBR          25010000
250200             PERFORM 9903-WRITE-CICS-LOG                          25020000
250300             MOVE '7210-INACT-CURRENT-SHUNLO'                     25030000
250400                                      TO PC233-PARAGRAPH          25040000
250500             MOVE 'PCKRF879 - UPDATE SUT_OTBND_LOC ROW'           25050000
250600                                      TO PC233-MESSAGE-TEXT(1)    25060000
250700             MOVE SQLCA               TO PC233-SQLCA              25070000
250800             MOVE 'SUT00027'          TO PC233-DB2-TABLE-NAME(1)  25080000
250900             SET PC233-ABEND          TO TRUE                     25090000
251000             MOVE 99                  TO PC233-PGM-MSG-NBR        25100000
251100             PERFORM 8210-XCTL-ERROR-SCREEN                       25110000
251200     END-EVALUATE.                                                25120000
251300                                                                  25130000
251400                                                                  25140000
251500***************************************************************** 25150000
251600* CHECK TO SEE IF CARTON WAS DIVERTED                           * 25160000
251700***************************************************************** 25170000
251800 7220-SELECT-TSUCRDV.                                             25180000
251900     EXEC SQL                                                     25190000
252000         SELECT                                                   25200000
252100                 ACTV_CDE                                         25210000
252200           INTO                                                   25220000
252300                 :SUCRDV-ACTV-CDE                                 25230000
252400           FROM                                                   25240000
252500                 TSUCRDV                                          25250000
252600          WHERE  BRCDE_NBR          = :PC233-BRCDE-NBR            25260000
252700            AND  ACTV_CDE           = 'A'                         25270000
252800     END-EXEC.                                                    25280000
252900                                                                  25290000
253000     EVALUATE TRUE                                                25300000
253100         WHEN SQLCODE = ZERO                                      25310000
253200         WHEN SQLCODE = -811                                      25320000
253300              SET  PS-SUCRDV-YES      TO TRUE                     25330000
253400              SET  PS-ERRORS-NO       TO TRUE                     25340000
253500         WHEN SQLCODE = +100                                      25350000
253600*        THIS IS NOT AN ERROR FOR SCANNING ON INACTIVE MASTERS    25360000
253700             IF SUT00024-ACTV-IND = 'N' AND                       25370000
253800                SUT00024-CART-SRC-CDE = 'MST'                     25380000
253900                 SET PS-SUCRDV-NO     TO TRUE                     25390000
254000             ELSE                                                 25400000
254100                 SET PS-ERRORS-YES    TO TRUE                     25410000
254200                 MOVE 'CTN NOT ON FILE'   TO AMSGLNO              25420000
254300             END-IF                                               25430000
254400         WHEN SQLCODE = -904                                      25440000
254500         WHEN SQLCODE = -913                                      25450000
254600         WHEN SQLCODE = -911                                      25460000
254700             MOVE 45                  TO PV-ERROR-NBR             25470000
254800             PERFORM 9903-WRITE-CICS-LOG                          25480000
254900             PERFORM 9000-SOFT-ABORT                              25490000
255000         WHEN SQLWARN0 NOT = SPACES                               25500000
255100         WHEN SQLCODE NOT EQUAL ZERO                              25510000
255200             MOVE 46                  TO PV-ERROR-NBR             25520000
255300                                         PC233-ERROR-NBR          25530000
255400             PERFORM 9903-WRITE-CICS-LOG                          25540000
255500             MOVE '7220-SELECT-TSUCRDV'                           25550000
255600                                      TO PC233-PARAGRAPH          25560000
255700             MOVE 'PCKRF879 - CHECK IF CARTON DIVERTED'           25570000
255800                                      TO PC233-MESSAGE-TEXT(1)    25580000
255900             MOVE SQLCA               TO PC233-SQLCA              25590000
256000             MOVE 'TSUCRDV'           TO PC233-DB2-TABLE-NAME(1)  25600000
256100             SET PC233-ABEND          TO TRUE                     25610000
256200             MOVE 99                  TO PC233-PGM-MSG-NBR        25620000
256300             PERFORM 8210-XCTL-ERROR-SCREEN                       25630000
256400     END-EVALUATE.                                                25640000
256500                                                                  25650000
256600 7300-SCAN-OFF-PREV-TRLR.                                         25660000
256700                                                                  25670000
256800     EXEC SQL                                                     25680000
256900         INSERT INTO SUT_OTBND_LOC                                25690000
257000         (                                                        25700000
257100              SHIPT_UNT_ID                                        25710000
257200              , CRE_TMST                                          25720000
257300              , OTBND_TRIP_ID                                     25730000
257400              , LOC_NBR                                           25740000
257500              , SCN_CDE                                           25750000
257600              , CRE_USR_ID                                        25760000
257700              , ACTV_CDE                                          25770000
257800              , INBD_TRIP_ID                                      25780000
257900         )                                                        25790000
258000         VALUES                                                   25800000
258100         (                                                        25810000
258200                 :PC233-CARTON                                    25820000
258300               , CURRENT TIMESTAMP                                25830000
258400               , :PV-SCAN-ON-TRIP-ID                              25840000
258500               , :PC233-OPER-UNT-ID                               25850000
258600               , 'SHOF'                                           25860000
258700               , :PC233-USER-ID                                   25870000
258800               , 'I'                                              25880000
258900               , 0                                                25890000
259000           )                                                      25900000
259100     END-EXEC.                                                    25910000
259200                                                                  25920000
259300     EVALUATE TRUE                                                25930000
259400         WHEN SQLCODE = ZERO                                      25940000
259500             CONTINUE                                             25950000
259600         WHEN SQLCODE = -904                                      25960000
259700         WHEN SQLCODE = -913                                      25970000
259800         WHEN SQLCODE = -911                                      25980000
259900             MOVE 47                  TO PV-ERROR-NBR             25990000
260000             PERFORM 9903-WRITE-CICS-LOG                          26000000
260100             PERFORM 9000-SOFT-ABORT                              26010000
260200         WHEN SQLWARN0 NOT = SPACES                               26020000
260300         WHEN SQLCODE NOT EQUAL ZERO                              26030000
260400             MOVE 48                  TO PV-ERROR-NBR             26040000
260500                                         PC233-ERROR-NBR          26050000
260600             PERFORM 9903-WRITE-CICS-LOG                          26060000
260700             MOVE '7300-SCAN-OFF-PREV-TRLR'                       26070000
260800                                      TO PC233-PARAGRAPH          26080000
260900             MOVE 'PCKRF879 - INSERT SUT_OTBND_LOC ROW'           26090000
261000                                      TO PC233-MESSAGE-TEXT(1)    26100000
261100             MOVE PC233-CARTON          TO PV-DISP-SHIPT-UNT-ID   26110000
261200             MOVE PV-DISP-SHIPT-UNT-ID                            26120000
261300                                      TO PC233-MESSAGE-TEXT(2)    26130000
261400             MOVE SQLCA               TO PC233-SQLCA              26140000
261500             MOVE 'SUT00027'          TO PC233-DB2-TABLE-NAME(1)  26150000
261600             SET PC233-ABEND          TO TRUE                     26160000
261700             MOVE 99                  TO PC233-PGM-MSG-NBR        26170000
261800             PERFORM 8210-XCTL-ERROR-SCREEN                       26180000
261900     END-EVALUATE.                                                26190000
262000                                                                  26200000
262100 7310-INACT-PREV-SCAN-ON.                                         26210000
262200                                                                  26220000
262300     EXEC SQL                                                     26230000
262400         UPDATE SUT_OTBND_LOC                                     26240000
262500             SET ACTV_CDE     = 'I'                               26250000
262600         WHERE                                                    26260000
262700             SHIPT_UNT_ID     = :PC233-CARTON                     26270000
262800         AND SCN_CDE          = 'SHON'                            26280000
262900         AND ACTV_CDE         = 'A'                               26290000
263000         AND OTBND_TRIP_ID    = :PV-SCAN-ON-TRIP-ID               26300000
263100     END-EXEC.                                                    26310000
263200                                                                  26320000
263300     EVALUATE TRUE                                                26330000
263400         WHEN SQLCODE = ZERO                                      26340000
263500         WHEN SQLCODE = +100                                      26350000
263600             CONTINUE                                             26360000
263700         WHEN SQLCODE = -904                                      26370000
263800         WHEN SQLCODE = -913                                      26380000
263900         WHEN SQLCODE = -911                                      26390000
264000             MOVE 49                  TO PV-ERROR-NBR             26400000
264100             PERFORM 9903-WRITE-CICS-LOG                          26410000
264200             PERFORM 9000-SOFT-ABORT                              26420000
264300         WHEN SQLWARN0 NOT = SPACES                               26430000
264400         WHEN SQLCODE NOT EQUAL ZERO                              26440000
264500             MOVE 50                  TO PV-ERROR-NBR             26450000
264600                                         PC233-ERROR-NBR          26460000
264700             PERFORM 9903-WRITE-CICS-LOG                          26470000
264800             MOVE '7310-INACT-PREV-SCAN-ON'                       26480000
264900                                      TO PC233-PARAGRAPH          26490000
265000             MOVE 'PCKRF879 - UPDATE SUT_OTBND_LOC ROW'           26500000
265100                                      TO PC233-MESSAGE-TEXT(1)    26510000
265200             MOVE SQLCA               TO PC233-SQLCA              26520000
265300             MOVE 'SUT00027'          TO PC233-DB2-TABLE-NAME(1)  26530000
265400             SET PC233-ABEND          TO TRUE                     26540000
265500             MOVE 99                  TO PC233-PGM-MSG-NBR        26550000
265600             PERFORM 8210-XCTL-ERROR-SCREEN                       26560000
265700     END-EVALUATE.                                                26570000
265800                                                                  26580000
265900                                                                  26590000
266000                                                                  26600000
266100 7400-INSERT-WRKR-AUD.                                            26610000
266200     EXEC SQL                                                     26620000
266300         INSERT INTO SUT_TRIP_WRKR_AUD                            26630000
266400             (                                                    26640000
266500               OTBND_TRIP_ID                                      26650000
266600             , USR_ID                                             26660000
266700             , CRE_TMST                                           26670000
266800             , CRE_BY_PGM_NM                                      26680000
266900                 )                                                26690000
267000                                                                  26700000
267100             VALUES                                               26710000
267200                                                                  26720000
267300                 (                                                26730000
267400                 :PC233-TRIP-ID                                   26740000
267500             ,   :PC233-USER-ID                                   26750000
267600             ,   CURRENT TIMESTAMP                                26760000
267700             ,   :PC-CURRENT-PROGRAM-NAME                         26770000
267800                 )                                                26780000
267900     END-EXEC.                                                    26790000
268000                                                                  26800000
268100     EVALUATE TRUE                                                26810000
268200         WHEN SQLCODE = ZERO                                      26820000
268300             CONTINUE                                             26830000
268400         WHEN SQLCODE = -904                                      26840000
268500         WHEN SQLCODE = -913                                      26850000
268600         WHEN SQLCODE = -911                                      26860000
268700             MOVE 51                  TO PV-ERROR-NBR             26870000
268800             PERFORM 9903-WRITE-CICS-LOG                          26880000
268900             PERFORM 9000-SOFT-ABORT                              26890000
269000         WHEN SQLWARN0 NOT = SPACES                               26900000
269100         WHEN SQLCODE NOT EQUAL ZERO                              26910000
269200              MOVE PC233-OPER-UNT-ID      TO PV-DISPLAY-OPER      26920000
269300              MOVE PC233-DOOR-ID          TO PV-DISPLAY-DOOR-ID   26930000
269400              MOVE PC233-STR-NBR          TO PV-DISPLAY-DEST      26940000
269500              MOVE PC233-SERIAL-NBR       TO PV-DISPLAY-SRL-NBR   26950000
269600              MOVE PC233-OWNER-SCAC-ID    TO PV-DISPLAY-SCAC      26960000
269700              MOVE PC233-TRIP-ID          TO PV-DISPLAY-TRIP      26970000
269800              STRING  ' OPER-'               DELIMITED BY SIZE    26980000
269900                      PV-DISPLAY-OPER        DELIMITED BY SIZE    26990000
270000                      '  DOOR-'              DELIMITED BY SIZE    27000000
270100                      PV-DISPLAY-DOOR-ID     DELIMITED BY SIZE    27010000
270200                      '  DEST-'              DELIMITED BY SIZE    27020000
270300                      PV-DISPLAY-DEST        DELIMITED BY SIZE    27030000
270400                                        INTO                      27040000
270500                                        PC233-MESSAGE-TEXT(2)     27050000
270600             STRING   ' TRLR SRL#-'          DELIMITED BY SIZE    27060000
270700                      PV-DISPLAY-SRL-NBR     DELIMITED BY SIZE    27070000
270800                      '   SCAC-'             DELIMITED BY SIZE    27080000
270900                      PV-DISPLAY-SCAC        DELIMITED BY SIZE    27090000
271000                      '   TRIP-'             DELIMITED BY SIZE    27100000
271100                      PV-DISPLAY-TRIP        DELIMITED BY SIZE    27110000
271200                                        INTO                      27120000
271300                                        PC233-MESSAGE-TEXT(3)     27130000
271400                                                                  27140000
271500             MOVE 52                  TO PV-ERROR-NBR             27150000
271600                                         PC233-ERROR-NBR          27160000
271700             PERFORM 9903-WRITE-CICS-LOG                          27170000
271800             MOVE '7400-INSERT-WRKR-AUD'                          27180000
271900                                      TO PC233-PARAGRAPH          27190000
272000             MOVE 'PCKRF879 - INSERT WORKER AUDIT'                27200000
272100                                      TO PC233-MESSAGE-TEXT(1)    27210000
272200             MOVE SQLCA               TO PC233-SQLCA              27220000
272300             MOVE 'SUT00006'          TO PC233-DB2-TABLE-NAME(1)  27230000
272400             SET PC233-ABEND          TO TRUE                     27240000
272500             MOVE 99                  TO PC233-PGM-MSG-NBR        27250000
272600             PERFORM 8210-XCTL-ERROR-SCREEN                       27260000
272700     END-EVALUATE.                                                27270000
272800/                                                                 27280000
272900                                                                  27290000
273000***************************************************************** 27300000
273100*                                                               * 27310000
273200***************************************************************** 27320000
273300 8000-SEND-MAP.                                                   27330000
273400                                                                  27340000
273500     MOVE -1                          TO ASMLL                    27350000
273600     EXEC CICS                                                    27360000
273700         SEND MAP       ('PC879A')                                27370000
273800              MAPSET    ('PCKM879')                               27380000
273900              ERASE                                               27390000
274000              CURSOR                                              27400000
274100              RESP      (PV-CICS-RESPONSE)                        27410000
274200     END-EXEC.                                                    27420000
274300                                                                  27430000
274400     EVALUATE TRUE                                                27440000
274500         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 27450000
274600             CONTINUE                                             27460000
274700         WHEN OTHER                                               27470000
274800             MOVE '8000-SEND-MAP'     TO DP013-PARAGRAPH          27480000
274900             MOVE 'PCKRF879 - UNABLE TO SEND MAP'                 27490000
275000                                      TO DP013-MESSAGE-TEXT (1)   27500000
275100             SET DP013-CICS-ABEND                                 27510000
275200                 DP013-ROLLBACK       TO TRUE                     27520000
275300             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               27530000
275400     END-EVALUATE.                                                27540000
275500                                                                  27550000
275600 8010-SEND-DATA-ONLY.                                             27560000
275700                                                                  27570000
275800     MOVE -1                          TO ASMLL                    27580000
275900     EXEC CICS                                                    27590000
276000         SEND MAP       ('PC879A')                                27600000
276100              MAPSET    ('PCKM879')                               27610000
276200              CURSOR                                              27620000
276300              DATAONLY                                            27630000
276400              RESP      (PV-CICS-RESPONSE)                        27640000
276500     END-EXEC.                                                    27650000
276600                                                                  27660000
276700     EVALUATE TRUE                                                27670000
276800         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 27680000
276900             CONTINUE                                             27690000
277000         WHEN OTHER                                               27700000
277100             MOVE '8010-SEND-DATA-ONLY'                           27710000
277200                                      TO DP013-PARAGRAPH          27720000
277300             MOVE 'PCKRF879 - UNABLE TO SEND DATA'                27730000
277400                                      TO DP013-MESSAGE-TEXT (1)   27740000
277500             SET DP013-CICS-ABEND                                 27750000
277600                 DP013-ROLLBACK       TO TRUE                     27760000
277700             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               27770000
277800     END-EVALUATE.                                                27780000
277900                                                                  27790000
278000 8020-RECEIVE-MAP.                                                27800000
278100                                                                  27810000
278200     EXEC CICS                                                    27820000
278300         RECEIVE MAP    ('PC879A')                                27830000
278400                 MAPSET ('PCKM879')                               27840000
278500                 RESP   (PV-CICS-RESPONSE)                        27850000
278600     END-EXEC.                                                    27860000
278700                                                                  27870000
278800     EVALUATE TRUE                                                27880000
278900         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 27890000
279000             CONTINUE                                             27900000
279100         WHEN PV-CICS-RESPONSE = DFHRESP (MAPFAIL)                27910000
279200             CONTINUE                                             27920000
279300         WHEN OTHER                                               27930000
279400            MOVE '8020-RECEIVE-MAP'   TO DP013-PARAGRAPH          27940000
279500            MOVE 'PCKRF879 - UNABLE TO RECEIVE MAP'               27950000
279600                                      TO DP013-MESSAGE-TEXT (1)   27960000
279700            SET DP013-LOGIC-ABEND     TO TRUE                     27970000
279800            SET DP013-ROLLBACK        TO TRUE                     27980000
279900            PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG                27990000
280000     END-EVALUATE.                                                28000000
280100                                                                  28010000
280200 8100-RETURN-TRANID.                                              28020000
280300                                                                  28030000
280400     MOVE LENGTH OF CA-COMMAREA       TO PV-COMMAREA-LENGTH       28040000
280500     EXEC CICS                                                    28050000
280600         RETURN TRANSID  (PC-TRANID)                              28060000
280700                COMMAREA (CA-COMMAREA)                            28070000
280800                LENGTH   (PV-COMMAREA-LENGTH)                     28080000
280900                RESP     (PV-CICS-RESPONSE)                       28090000
281000     END-EXEC.                                                    28100000
281100                                                                  28110000
281200     EVALUATE TRUE                                                28120000
281300         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 28130000
281400             CONTINUE                                             28140000
281500         WHEN OTHER                                               28150000
281600             MOVE '8100-RETURN-TRANIND'                           28160000
281700                                      TO DP013-PARAGRAPH          28170000
281800             MOVE 'PCKRF879 - UNABLE TO RETURN TO TRANID'         28180000
281900                 TO DP013-MESSAGE-TEXT (1)                        28190000
282000             SET DP013-CICS-ABEND     TO TRUE                     28200000
282100             SET DP013-ROLLBACK       TO TRUE                     28210000
282200             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               28220000
282300     END-EVALUATE.                                                28230000
282400                                                                  28240000
282500 8110-RETURN.                                                     28250000
282600                                                                  28260000
282700     EXEC CICS                                                    28270000
282800         SEND FROM (PV-MESSAGE-AREA)                              28280000
282900              LENGTH (19)                                         28290000
283000              ERASE                                               28300000
283100     END-EXEC.                                                    28310000
283200                                                                  28320000
283300     EXEC CICS                                                    28330000
283400         RETURN                                                   28340000
283500     END-EXEC.                                                    28350000
283600                                                                  28360000
283700 8200-XCTL.                                                       28370000
283800     SET PC233-INITIALIZE-SCREEN      TO TRUE.                    28380000
283900     MOVE PC-CURRENT-PROGRAM-NAME     TO PC233-LAST-PROGRAM.      28390000
284000     MOVE LENGTH OF CA-COMMAREA       TO PV-COMMAREA-LENGTH       28400000
284100                                                                  28410000
284200     EXEC CICS                                                    28420000
284300         XCTL  PROGRAM   (PV-TRANSFER-PROGRAM)                    28430000
284400               COMMAREA  (CA-COMMAREA)                            28440000
284500               LENGTH    (PV-COMMAREA-LENGTH)                     28450000
284600               RESP      (PV-CICS-RESPONSE)                       28460000
284700     END-EXEC.                                                    28470000
284800                                                                  28480000
284900     EVALUATE TRUE                                                28490000
285000         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 28500000
285100             CONTINUE                                             28510000
285200         WHEN OTHER                                               28520000
285300             MOVE '8200-XCTL'                                     28530000
285400                                      TO DP013-PARAGRAPH          28540000
285500             MOVE 'PCKRF879 - UNABLE TO XCTL TO PROGRAM: '        28550000
285600                                      TO DP013-MESSAGE-TEXT (1)   28560000
285700             MOVE PV-TRANSFER-PROGRAM TO DP013-MESSAGE-TEXT (2)   28570000
285800             SET DP013-CICS-ABEND                                 28580000
285900                 DP013-ROLLBACK       TO TRUE                     28590000
286000             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               28600000
286100             MOVE PC-TRANS-UNAVAILABLE-MSG                        28610000
286200                                      TO AMSGLNO                  28620000
286300             SET PC233-PROCESS-SCREEN TO TRUE                     28630000
286400             PERFORM 8000-SEND-MAP                                28640000
286500             PERFORM 8100-RETURN-TRANID                           28650000
286600     END-EVALUATE.                                                28660000
286700                                                                  28670000
286800 8210-XCTL-ERROR-SCREEN.                                          28680000
286900                                                                  28690000
287000     EXEC CICS                                                    28700000
287100         SYNCPOINT ROLLBACK                                       28710000
287200     END-EXEC                                                     28720000
287300                                                                  28730000
287400     IF NOT PC233-ABEND                                           28740000
287500         SET PC233-INITIALIZE-SCREEN  TO TRUE                     28750000
287600     END-IF                                                       28760000
287700     IF PC233-PGM-MSG-NBR = ZERO                                  28770000
287800         MOVE 2                       TO PC233-PGM-MSG-NBR        28780000
287900     END-IF                                                       28790000
288000                                                                  28800000
288100     MOVE DFHEIBLK                    TO PC233-DFHEIBLK.          28810000
288200     MOVE PC-CURRENT-PROGRAM-NAME     TO PC233-LAST-PROGRAM.      28820000
288300     MOVE LENGTH OF CA-COMMAREA       TO PV-COMMAREA-LENGTH       28830000
288400     MOVE 'PCKRF871'                  TO PV-TRANSFER-PROGRAM      28840000
288500                                                                  28850000
288600     EXEC CICS                                                    28860000
288700         XCTL  PROGRAM   (PV-TRANSFER-PROGRAM)                    28870000
288800               COMMAREA  (CA-COMMAREA)                            28880000
288900               LENGTH    (PV-COMMAREA-LENGTH)                     28890000
289000               RESP      (PV-CICS-RESPONSE)                       28900000
289100     END-EXEC.                                                    28910000
289200                                                                  28920000
289300     EVALUATE TRUE                                                28930000
289400         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 28940000
289500             CONTINUE                                             28950000
289600         WHEN OTHER                                               28960000
289700             MOVE '8200-XCTL'                                     28970000
289800                                      TO DP013-PARAGRAPH          28980000
289900             MOVE 'PCKRF879 - UNABLE TO XCTL TO PROGRAM: '        28990000
290000                                      TO DP013-MESSAGE-TEXT (1)   29000000
290100             MOVE PV-TRANSFER-PROGRAM TO DP013-MESSAGE-TEXT (2)   29010000
290200             SET DP013-CICS-ABEND                                 29020000
290300                 DP013-ROLLBACK       TO TRUE                     29030000
290400             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               29040000
290500             MOVE PC-TRANS-UNAVAILABLE-MSG                        29050000
290600                                      TO AMSGLNO                  29060000
290700             SET PC233-PROCESS-SCREEN TO TRUE                     29070000
290800             PERFORM 8000-SEND-MAP                                29080000
290900             PERFORM 8100-RETURN-TRANID                           29090000
291000     END-EVALUATE.                                                29100000
291100                                                                  29110000
291200*                                                                 29120000
291300 8220-XCTL-TO-HELP.                                               29130000
291400                                                                  29140000
291500     MOVE LENGTH OF PC192-COMMAREA    TO PV-COMMAREA-LENGTH       29150000
291600                                                                  29160000
291700     EXEC CICS                                                    29170000
291800         XCTL                                                     29180000
291900             PROGRAM   (PV-TRANSFER-PROGRAM)                      29190000
292000             COMMAREA  (PC192-COMMAREA)                           29200000
292100             LENGTH    (PV-COMMAREA-LENGTH)                       29210000
292200             RESP      (PV-CICS-RESPONSE)                         29220000
292300     END-EXEC.                                                    29230000
292400                                                                  29240000
292500     EVALUATE TRUE                                                29250000
292600         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 29260000
292700              CONTINUE                                            29270000
292800         WHEN OTHER                                               29280000
292900             MOVE '8220-XCTL-TO-HELP' TO DP013-PARAGRAPH          29290000
293000             MOVE 'PCKRF879 - UNABLE TO XCTL TO PROGRAM: '        29300000
293100                                      TO DP013-MESSAGE-TEXT (1)   29310000
293200             MOVE PV-TRANSFER-PROGRAM TO DP013-MESSAGE-TEXT (2)   29320000
293300             SET DP013-CICS-ABEND                                 29330000
293400                 DP013-ROLLBACK       TO TRUE                     29340000
293500             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               29350000
293600             MOVE PC-TRANS-UNAVAILABLE-MSG                        29360000
293700                                      TO AMSGLNO                  29370000
293800             SET PC233-PROCESS-SCREEN TO TRUE                     29380000
293900             PERFORM 8000-SEND-MAP                                29390000
294000             PERFORM 8100-RETURN-TRANID                           29400000
294100     END-EVALUATE.                                                29410000
294200/                                                                 29420000
294300 8300-LINK-TO-STATUS-MODULE.                                      29430000
294400     INITIALIZE  PC046-COMMAREA-REC.                              29440000
294500     SET PC046-FROM-SCAN-ON-OFF       TO TRUE.                    29450000
294600     MOVE PC233-CARTON                TO PC046-CARTON-ID.         29460000
294700                                                                  29470000
294800     CALL PC046-CARTON-STATUS-MODULE                              29480000
294900             USING DFHEIBLK                                       29490000
295000             PC046-COMMAREA                                       29500000
295100             PC046-COMMAREA-REC                                   29510000
295200     END-CALL                                                     29520000
295300                                                                  29530000
295400     IF PC046-SUCCESSFUL                                          29540000
295500         CONTINUE                                                 29550000
295600     ELSE                                                         29560000
295700         SET PS-ERRORS-YES            TO TRUE                     29570000
295800         EVALUATE TRUE                                            29580000
295900             WHEN PC046-INVALID-SQL                               29590000
296000             WHEN PC046-DATABASE-BUSY                             29600000
296100                 MOVE PC046-SQLCA     TO SQLCA                    29610000
296200                 MOVE 'DATABASE BUSY' TO AMSGLNO                  29620000
296300             WHEN PC046-CRTN-STAT-ERROR                           29630000
296400                 MOVE 'CRTN STATUS ERROR' TO AMSGLNO              29640000
296500             WHEN OTHER                                           29650000
296600                 MOVE 'ERROR-SEE SUPERVSR' TO AMSGLNO             29660000
296700         END-EVALUATE                                             29670000
296800                                                                  29680000
296900         PERFORM 9904-WRITE-CRTN-MODULE-MSG                       29690000
297000     END-IF.                                                      29700000
297100                                                                  29710000
297200****************************************************************  29720000
297300*    RETRIEVE THE CURRENT TIMESTAMP TO USE WHEN UPDATING ROWS. *  29730000
297400*                                                              *  29740000
297500****************************************************************  29750000
297600                                                                  29760000
297700 8400-GET-TIMESTAMP.                                              29770000
297800                                                                  29780000
297900     EXEC SQL                                                     29790000
298000                                                                  29800000
298100         SET :PV-CURRENT-TIMESTAMP  = CURRENT TIMESTAMP           29810000
298200                                                                  29820000
298300     END-EXEC.                                                    29830000
298400                                                                  29840000
298500     EVALUATE SQLCODE                                             29850000
298600         WHEN 0                                                   29860000
298700              CONTINUE                                            29870000
298800                                                                  29880000
298900         WHEN OTHER                                               29890000
299000              PERFORM 4550-FORMAT-COMMON-DATA                     29900000
299100                                                                  29910000
299200              MOVE '8400-GET-TIMESTAMP'                           29920000
299300                                       TO PC233-PARAGRAPH         29930000
299400              STRING PC-CURRENT-PROGRAM-NAME                      29940000
299500                     ' - GET CURRENT TIMESTAMP   '                29950000
299600                      DELIMITED BY SIZE                           29960000
299700                      INTO PC233-MESSAGE-TEXT(1)                  29970000
299800              MOVE SQLCA               TO PC233-SQLCA             29980000
299900              SET PC233-ABEND          TO TRUE                    29990000
300000              MOVE 99                  TO PC233-PGM-MSG-NBR       30000000
300100              PERFORM 8210-XCTL-ERROR-SCREEN                      30010000
300200                                                                  30020000
300300     END-EVALUATE.                                                30030000
300400/                                                                 30040000
300500 9000-SOFT-ABORT.                                                 30050000
300600                                                                  30060000
300700     EXEC CICS                                                    30070000
300800         SYNCPOINT ROLLBACK                                       30080000
300900     END-EXEC                                                     30090000
301000                                                                  30100000
301100     MOVE 1                           TO PC233-PGM-MSG-NBR        30110000
301200     MOVE SQLCODE                     TO PC233-SQLCODE            30120000
301300     PERFORM 8210-XCTL-ERROR-SCREEN.                              30130000
301400                                                                  30140000
301500                                                                  30150000
301600 9904-WRITE-CRTN-MODULE-MSG.                                      30160000
301700                                                                  30170000
301800     PERFORM 9903-WRITE-CICS-LOG.                                 30180000
301900                                                                  30190000
302000     EXEC CICS                                                    30200000
302100         WRITEQ TD                                                30210000
302200             QUEUE  ('CSSL')                                      30220000
302300             FROM   (PC046-CRA-RET-MSG)                           30230000
302400             RESP   (PV-CICS-RESPONSE)                            30240000
302500     END-EXEC.                                                    30250000
302600                                                                  30260000
302700                                                                  30270000
302800 9903-WRITE-CICS-LOG.                                             30280000
302900                                                                  30290000
303000     MOVE SQLCODE                     TO PV-SQLCODE               30300000
303100     MOVE PC233-DOOR-ID               TO PV-DISPLAY-DOOR          30310000
303200     MOVE PC233-USER-ID               TO PV-USER-ID               30320000
303300     MOVE PC233-CARTON                TO PV-DISPLAY-SML           30330000
303400                                                                  30340000
303500     EXEC CICS                                                    30350000
303600         WRITEQ TD                                                30360000
303700             QUEUE  ('CSSL')                                      30370000
303800             FROM   (PV-LOG-MSG)                                  30380000
303900             RESP   (PV-CICS-RESPONSE)                            30390000
304000     END-EXEC.                                                    30400000
304100                                                                  30410000
304200 9999-WRITE-MESSAGE-TO-CICS-LOG.                                  30420000
304300                                                                  30430000
304400     MOVE PC-CURRENT-PROGRAM-NAME     TO DP013-PROGRAM.           30440000
304500     MOVE DFHEIBLK                    TO DP013-DFHEIBLK.          30450000
304600     INITIALIZE DP013-SRC-TASK-NUMBER                             30460000
304700                DP013-STACK.                                      30470000
304800     SET DP013-LINK-RETURN            TO TRUE.                    30480000
304900                                                                  30490000
305000     EXEC CICS                                                    30500000
305100         LINK                                                     30510000
305200             PROGRAM   (DP013-NAME)                               30520000
305300             COMMAREA  (DP013-PARAMETERS)                         30530000
305400             LENGTH    (DP013-LENGTH)                             30540000
305500     END-EXEC.                                                    30550000
305600                                                                  30560000
305700 999A-WRITE-CSSL-MSG.                                             30570000
305800                                                                  30580000
305900     MOVE LENGTH OF PV-CICS-MSG-AREA2 TO PV-COMMAREA-LENGTH.      30590000
306000                                                                  30600000
306100     EXEC CICS                                                    30610000
306200         WRITEQ TD                                                30620000
306300             QUEUE  ('CSSL')                                      30630000
306400             FROM   (PV-CICS-MSG-AREA2)                           30640000
306500           LENGTH   (PV-COMMAREA-LENGTH)                          30650000
306600             RESP   (PV-CICS-RESPONSE)                            30660000
306700     END-EXEC.                                                    30670000
