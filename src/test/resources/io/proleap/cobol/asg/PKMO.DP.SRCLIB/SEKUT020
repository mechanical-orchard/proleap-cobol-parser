000100*------------------------*                                        00020001
000200 IDENTIFICATION DIVISION.                                         00030001
000300*------------------------*                                        00040001
000400 PROGRAM-ID.     SEKUT020.                                        00050001
000500 AUTHOR.         BARB SCHULTZ.                                    00060001
000600 DATE-WRITTEN.   01/30/12.                                        00070001
000700*---------------------------------------------------------------* 00080001
000800*                ITIM PROGRAM                                   * 00090001
000900*---------------------------------------------------------------* 00100001
001300*    PROGRAM OVERVIEW:                                          * 00110001
001400*    THIS PROGRAM READS IN THE ITIM FILE.  THE RECORDS ARE COMMA* 00120001
001500*    DELIMITED WITH QUOTES IN A FEW TXT FIELDS.  WE NEED TO     * 00130001
001500*    UNSTRING THE RECORDS, THEN LOOK FOR DOUBLE QUOTES, SPACE   * 00140001
001500*    OUT THE FIELDS WITH THE DOUBLE QUOTES BECAUSE THESE FIELDS * 00150001
001500*    ALSO HAD COMMAS BETWEEN THE QUOTES MAKING THEM 2 FIELDS.   * 00160001
001500*    MOVE THE SECOND FIELD OVER THE FIRST FIELD.  MOVE ALL THE  * 00170001
001500*    FIELDS TO THE SERD009 LAYOUT. PROGRAM SEKUT021 WILL THEN   * 00180001
001500*    MOVE THE SERD009 FIELDS TO THE UPS LAYOUT.                 * 00190001
001900*---------------------------------------------------------------* 00200001
002000*                                                               * 00210001
002100* INPUT:                                                        * 00220001
002200*   1. ITIM EMPLOYEE LIST FILE                                  * 00230001
002600*                                                               * 00240001
002700* OUTPUT:                                                       * 00250001
002800*                                                               * 00260001
002900*   1. ITIM EMPLOYEE LIST FILE WITHOUT COMMAS WITHIN THE        * 00270001
002900*      FIELDS THAT HAD QUOTES AND COMMAS                        * 00280001
003300*      SERD009                                                  * 00290001
003400*---------------------------------------------------------------* 00300001
003500* CHANGE LOG:                                                   * 00310001
003600*   DATE  05/15/2020                                            * 00320001
003700*       CHANGE MADE: RENAMED GLKUT095 TO SEKUT020               * 00330001
003800*       MADE BY: JEAN KURK                                      * 00340001
003400*---------------------------------------------------------------* 00341001
003500* CHANGE LOG:                                                   * 00342001
003600*   DATE  10/05/2018                                            * 00343001
003700*       CHANGE MADE: CHANGED AUTH FIELD LEN FROM 40 TO 100      * 00344001
003800*       MADE BY: COGNIZANT               WR/IR #: CHG0209813    * 00345001
004000*---------------------------------------------------------------* 00350001
003500* CHANGE LOG:                                                   * 00360001
003600*   DATE  05/06/2018                                            * 00370001
003700*       CHANGE MADE: CHANGED NUMBER OF CHARACTER NEEDS TO BE    * 00380001
      *                    CHECKED FROM 40 TO 100 IN PARA               00390001
      *                    2260-LOOK-FOR-QUOTE                          00400001
003800*       MADE BY: COGNIZANT               WR/IR #: CHG0201259    * 00410001
003900*                                                               * 00420001
004000*---------------------------------------------------------------* 00430001
003500* CHANGE LOG:                                                   * 00440001
003600*   DATE  01/30/2012                                            * 00450001
003700*       CHANGE MADE: INITIAL VERSION.                           * 00460001
003800*       MADE BY: BARB SCHULTZ            WR/IR #: 3559          * 00470001
003900*                                                               * 00480001
004000*---------------------------------------------------------------* 00490001
004100                                                                  00500001
004200*---------------------*                                           00510001
004300 ENVIRONMENT DIVISION.                                            00520001
004400*---------------------*                                           00530001
004500 CONFIGURATION SECTION.                                           00540001
004600 SOURCE-COMPUTER.    IBM-3090.                                    00550001
004700 OBJECT-COMPUTER.    IBM-3090.                                    00560001
004800                                                                  00570001
004900 INPUT-OUTPUT SECTION.                                            00580001
005000 FILE-CONTROL.                                                    00590001
005100                                                                  00600001
005200     SELECT ITIM-INPUT-FILE        ASSIGN TO INP01.               00610001
005300     SELECT ITIM-OUTPUT-FILE       ASSIGN TO OUT01.               00620001
005600                                                                  00630001
005700*--------------*                                                  00640001
005800 DATA DIVISION.                                                   00650001
005900*--------------*                                                  00660001
006000 FILE SECTION.                                                    00670001
006100                                                                  00680001
006200 FD  ITIM-INPUT-FILE                                              00690001
006300     RECORDING MODE IS F                                          00700001
006400     LABEL RECORDS ARE OMITTED                                    00710001
006500     BLOCK CONTAINS 0 RECORDS.                                    00720001
006700 01  ITIM-INPUT-REC            PIC  X(1200).                      00730001
006800                                                                  00740001
006900 FD  ITIM-OUTPUT-FILE                                             00750001
007000     RECORDING MODE IS F                                          00760001
007100     LABEL RECORDS ARE OMITTED                                    00770001
007200     BLOCK CONTAINS 0 RECORDS.                                    00780001
007400 01  ITIM-OUTPUT-REC           PIC  X(960).                       00790001
007500                                                                  00800001
009000 EJECT                                                            00810001
009100                                                                  00820001
009200 WORKING-STORAGE SECTION.                                         00830001
009300                                                                  00840001
010200 01  PROGRAM-CONSTANTS.                                           00850001
010300     05  PC-PROGRAM-NAME         PIC  X(08)     VALUE 'SEKUT020'. 00860001
010400                                                                  00870001
010900 01  PS-PROGRAM-SWITCHES.                                         00880001
011000     05  PS-INPUT-EOF-SWT           PIC X(01)      VALUE 'N'.     00890001
011100         88  PS-INPUT-EOF                          VALUE 'Y'.     00900001
011000     05  PS-END-QUOTE-SW            PIC X(01)      VALUE 'N'.     00910001
011100         88  PS-FOUND-END-QUOTE                    VALUE 'Y'.     00920001
011100         88  PS-NOT-FOUND-END-QUOTE                VALUE 'N'.     00930001
011000     05  PS-END-SW                  PIC X(01)      VALUE 'N'.     00940001
011100         88  PS-FOUND-END                          VALUE 'Y'.     00950001
011100         88  PS-NOT-FOUND-END                      VALUE 'N'.     00960001
010400                                                                  00970001
021900 01  PROGRAM-VARIABLES.                                           00980001
023300     05  PV-DOUBLE-QUOTE          PIC  X(01)   VALUE '"'.         00990001
023300     05  PV-WS-CTR                PIC  9(04)   VALUE ZEROS.       01000001
023300     05  PV-TOTAL-NO-FIELDS       PIC  9(04)   VALUE ZEROS.       01010001
063500     05  PV-WRT-COUNT             PIC  9(09)   VALUE ZEROES.      01020001
050400     05  PV-QUOTE-COUNTER         PIC  9(02)   VALUE ZEROES.      01030001
063500     05  PV-QUOTE                 PIC  X(01)   VALUE '"'.         01040001
063500     05  PV-QUOTE-IND             PIC  9(03)   VALUE ZEROES.      01050001
010400     05  PV-COUNTER               PIC S9(3)    VALUE ZERO.        01060001
063500     05  PV-HOLD-FIELD.                                           01070001
063500         10  PV-HD-FIELD OCCURS 75 TIMES                          01080001
063500                                  PIC  X(01)   VALUE SPACES.      01090001
010400     05  PV-HOLD-INDEX            PIC S9(3)    VALUE ZERO.        01100001
010400     05  PT-AUTH-INDEX            PIC S9(3)     VALUE ZERO.       01110001
010400                                                                  01120001
010400 01  PT-AUTH-MESSAGE.                                             01130001
010400     05  PT-AUTH-FIELD            OCCURS 75  TIMES                01140001
      *CHG0209813START                                                  01150001
010400                                  PIC X(100)   VALUE SPACES.      01160001
      *CHG0209813END                                                    01170001
010400                                                                  01180001
010400                                                                  01190001
039600*----------------------------------------------------------------*01200001
039700*    ABEND DATA AREAS                                             01210001
039800*----------------------------------------------------------------*01220001
039900 01  ABEND-CODE                    PIC S9(4)    VALUE ZEROES      01230001
040000                                   COMP         SYNC.             01240001
040100                                                                  01250001
040200     88  AC-ANY-ERROR                           VALUE  +4001      01260001
040300                                                THRU   +4019.     01270001
040400     88  AC-BAD-WRITE                           VALUE  +4001.     01280001
040500     88  AC-BAD-READ                            VALUE  +4002.     01290001
040600     88  AC-CONTROL-CARD-ERROR                  VALUE  +4003.     01300001
040700     88  AC-OPEN-ERROR                          VALUE  +4005.     01310001
040800     88  AC-CLOSE-ERROR                         VALUE  +4006.     01320001
040900     88  AC-BAD-DATA                            VALUE  +4008.     01330001
041000     88  AC-DB2-ERROR                           VALUE  +4013.     01340001
041100     88  AC-UNSUCCESSFUL-SELECT                 VALUE  +4015.     01350001
041200     88  AC-MAX-RETRIES-EXCEEDED                VALUE  +4016.     01360001
041300     88  AC-DATE-ERROR                          VALUE  +4019.     01370001
041500                                                                  01380001
041600 01  ABEND-AREAS.                                                 01390001
041700     05  AA-ABEND-LIT              PIC  X(40)   VALUE             01400001
041800             '*****       ABEND'.                                 01410001
041900     05  AA-PROGRAM-LIT            PIC  X(40)   VALUE             01420001
042000             '*****   PROGRAM: SEKUT020'.                         01430001
042100     05  AA-PARAGRAPH-LIT.                                        01440001
042200         10  FILLER                PIC  X(17)   VALUE             01450001
042300             '***** PARAGRAPH: '.                                 01460001
042400         10  AA-PARAGRAPH-NAME     PIC  X(35)   VALUE SPACES.     01470001
042500     05  AA-MESSAGE-LINE-1.                                       01480001
042600         10  FILLER                PIC  X(06)   VALUE '*****'.    01490001
042700         10  AA-MESSAGE            PIC  X(80)   VALUE SPACES.     01500001
042800     05  AA-MESSAGE-LINE-2.                                       01510001
042900         10  FILLER                PIC  X(06)   VALUE '*****'.    01520001
043000         10  AA-MESSAGE-2          PIC  X(80)   VALUE SPACES.     01530001
043100     05  AA-DB2-ERROR-LIT          PIC  X(40)   VALUE             01540001
043200             '*****    DB2 ERROR'.                                01550001
043300     05  AA-DB2-OPERATION-LIT.                                    01560001
043400         10  FILLER                PIC  X(17)   VALUE             01570001
043500             '***** OPERATION: '.                                 01580001
043600         10  AA-DB2-OPERATION.                                    01590001
043700             15  AA-DB2-OP-1       PIC  X(25)   VALUE SPACES.     01600001
043800             15  AA-DB2-OP-2       PIC  X(25)   VALUE SPACES.     01610001
043900     05  AA-DB2-TABLE-1            PIC  X(08)   VALUE SPACES.     01620001
044000     05  AA-DB2-TABLE-2            PIC  X(08)   VALUE SPACES.     01630001
044100     05  AA-DB2-TABLE-3            PIC  X(08)   VALUE SPACES.     01640001
010800                                                                  01650001
010800******************************************************************01660001
010800*  ITIM OUTPUT FILE                                              *01670001
010800******************************************************************01680001
010800     COPY SERD009.                                                01690001
026100                                                                  01700001
045100***************************************************************** 01710001
045200 PROCEDURE DIVISION.                                              01720001
045300***************************************************************** 01730001
045400 0000-PROGRAM-MAINLINE.                                           01740001
045500                                                                  01750001
045600     PERFORM 1000-INITIALIZE.                                     01760001
045700                                                                  01770001
045800     PERFORM 2000-PROCESS-INPUT                                   01780001
045900         UNTIL PS-INPUT-EOF.                                      01790001
046100                                                                  01800001
046000     PERFORM 4000-END-OF-PROGRAM.                                 01810001
046100                                                                  01820001
046200     GOBACK.                                                      01830001
046400                                                                  01840001
046500*----------------------------------------------------------------*01850001
046600*    INITIALIZATION PROCESSING                                   *01860001
046700*    - OPEN FILE.                                                *01870001
046900*----------------------------------------------------------------*01880001
047000 1000-INITIALIZE.                                                 01890001
047100                                                                  01900001
047200     DISPLAY '***-----  SEKUT020  (PROCESSING MSGS)  -----***'.   01910001
047300     DISPLAY ' '.                                                 01920001
047400                                                                  01930001
047500     OPEN INPUT ITIM-INPUT-FILE                                   01940001
047600          OUTPUT ITIM-OUTPUT-FILE.                                01950001
047900                                                                  01960001
050300     PERFORM 2500-READ-INPUT.                                     01970001
050400                                                                  01980001
050300     PERFORM 2600-READ-INPUT.                                     01990001
050400                                                                  02000001
053600*----------------------------------------------------------------*02010001
053700*    PROCESS INPUT                                               *02020001
053800*----------------------------------------------------------------*02030001
045800 2000-PROCESS-INPUT.                                              02040001
054000                                                                  02050001
010400     INITIALIZE PT-AUTH-MESSAGE                                   02060001
063500                PV-HOLD-FIELD.                                    02070001
010400     MOVE ZERO TO PV-HOLD-INDEX                                   02080001
010400                  PT-AUTH-INDEX                                   02090001
010400                  PV-COUNTER.                                     02100001
054000                                                                  02110001
054000     PERFORM 2100-UNSTRING.                                       02120001
054000                                                                  02130001
050400     PERFORM 2400-MOVE-TO-OUTPUT.                                 02140001
050400                                                                  02150001
054000     PERFORM 2800-WRITE-OUTPUT-RECORD.                            02160001
054000                                                                  02170001
054000     INITIALIZE SE009-ITIM-DETAIL.                                02180001
054000                                                                  02190001
054000     PERFORM 2600-READ-INPUT.                                     02200001
054000                                                                  02210001
054000****************************************************************  02220001
045800*UNSTRING THE INPUT RECORD                                        02230001
054000****************************************************************  02240001
054000 2100-UNSTRING.                                                   02250001
054000                                                                  02260001
050400     MOVE +1 TO PT-AUTH-INDEX.                                    02270001
050400     MOVE 1 TO PV-WS-CTR.                                         02280001
050400                                                                  02290001
050400     PERFORM UNTIL PT-AUTH-INDEX > 75                             02300001
050400          UNSTRING SE009-ITIM-DETAIL                              02310001
050400             DELIMITED BY ','                                     02320001
050400             INTO PT-AUTH-FIELD (PT-AUTH-INDEX)                   02330001
050400             WITH POINTER PV-WS-CTR                               02340001
050400          END-UNSTRING                                            02350001
050400          ADD +1 TO PT-AUTH-INDEX                                 02360001
050400     END-PERFORM.                                                 02370001
050400                                                                  02380001
050400     ADD +1 TO PT-AUTH-INDEX.                                     02390001
050400     COMPUTE PV-TOTAL-NO-FIELDS = PT-AUTH-INDEX - 1.              02400001
050400                                                                  02410001
050400     MOVE +1 TO PT-AUTH-INDEX.                                    02420001
050400     PERFORM 2200-SEARCH-FOR-QUOTE                                02430001
050400             UNTIL PT-AUTH-INDEX > 75.                            02440001
050400                                                                  02450001
050400******************************************************************02460001
050400**SEARCH FOR BEGINNING QUOTE,IF THERE IS A QUOTE THERE WAS A COMMA02470001
050400*                                                                 02480001
050400* SPACE OUT THE FIELD                                             02490001
050400* ADD 1 TO THE INDEX AND SPACE OUT THE NEXT FIELD BECAUSE THERE   02500001
050400*    ALWAYS IS A COMMA IN THE FIELD IF THERE WAS A QUOTE MARK     02510001
050400* PERFORM A PARAGRAPH TO MOVE THE FIELDS BACK ONE SO THAT THE     02520001
050400*    NAME OR POSITION IS ALWAYS IN ONE FIELD                      02530001
050400*                                                                 02540001
050400* EXAMPLE "SCHULTZ, BARBARA"                                      02550001
050400*    THIS PRODUCED TWO FIELDS AND WE WANT ONE FIELD               02560001
050400* EXAMPLE "SCHULTZ, BARBARA, J"                                   02570001
050400*    THIS PRODUCED THREE FIELDS AND WE WANT ONE FIELD             02580001
050400******************************************************************02590001
050400 2200-SEARCH-FOR-QUOTE.                                           02600001
050400     MOVE PT-AUTH-FIELD (PT-AUTH-INDEX) TO PV-HOLD-FIELD.         02610001
050400     IF PV-HD-FIELD(1) = PV-QUOTE                                 02620001
              MOVE 'N' TO PS-END-QUOTE-SW                               02630001
050400        PERFORM 2250-FIND-END-QUOTE                               02640001
050400     ELSE                                                         02650001
050400        ADD +1 TO PT-AUTH-INDEX                                   02660001
050400     END-IF.                                                      02670001
050400                                                                  02680001
050400******************************************************************02690001
      * MOVE SPACES TO THE FIRST FIELD                                  02700001
050400* FIND THE ENDING QUOTE AND SPACE OUT EVERYTHING IN BETWEEN THE   02710001
050400* QUOTE, SPACE BY SPACE                                           02720001
050400******************************************************************02730001
050400 2250-FIND-END-QUOTE.                                             02740001
050400     MOVE SPACES TO PT-AUTH-FIELD(PT-AUTH-INDEX).                 02750001
050400     ADD +1 TO PT-AUTH-INDEX.                                     02760001
050400     MOVE PT-AUTH-FIELD (PT-AUTH-INDEX) TO PV-HOLD-FIELD.         02770001
050400                                                                  02780001
011000     MOVE 'N' TO PS-END-SW.                                       02790001
050400     MOVE +0 TO PV-QUOTE-COUNTER.                                 02800001
           PERFORM 2260-LOOK-FOR-QUOTE UNTIL PS-FOUND-END.              02810001
350400                                                                  02820001
050400     IF PV-QUOTE-COUNTER >= 2                                     02830001
050400        SUBTRACT 1 FROM PT-AUTH-INDEX                             02840001
050400        MOVE SPACES TO PT-AUTH-FIELD(PT-AUTH-INDEX)               02850001
050400        MOVE PT-AUTH-INDEX TO PV-HOLD-INDEX                       02860001
050400        PERFORM 2300-MOVE-FIELDS UNTIL PV-HOLD-INDEX > 75         02870001
350400     END-IF.                                                      02880001
050400                                                                  02890001
050400******************************************************************02900001
050400* FIND THE ENDING QUOTE AND SPACE OUT EVERYTHING IN BETWEEN THE   02910001
050400* QUOTE, SPACE BY SPACE                                           02920001
      * MOVE THE FIELD OVER THE TOP OF THE LAST FIELD, MOVING ALL       02930001
      *   FIELDS BACK BY ONE.                                           02940001
050400******************************************************************02950001
050400 2260-LOOK-FOR-QUOTE.                                             02960001
050400     MOVE +1 TO PV-QUOTE-IND.                                     02970001
050400     MOVE 'N' TO PS-END-QUOTE-SW.                                 02980001
050400     PERFORM 2270-FIND-END-QUOTE                                  02990001
050400         UNTIL PS-FOUND-END-QUOTE OR                              03000001
      *CHG0201259-START                                                 03010001
050400               PV-QUOTE-IND >= 100.                               03020001
      *CHG0201259-END                                                   03030001
050400                                                                  03040001
           IF PS-NOT-FOUND-END-QUOTE                                    03050001
050400        MOVE SPACES TO PT-AUTH-FIELD(PT-AUTH-INDEX)               03060001
050400        ADD +1 TO PV-QUOTE-COUNTER                                03070001
050400        ADD +1 TO PT-AUTH-INDEX                                   03080001
050400        MOVE PT-AUTH-FIELD (PT-AUTH-INDEX) TO                     03090001
050400                        PV-HOLD-FIELD                             03100001
050400        MOVE +1 TO  PV-QUOTE-IND                                  03110001
050400        MOVE 'N' TO PS-END-SW                                     03120001
050400     ELSE                                                         03130001
050400        MOVE +1 TO PV-QUOTE-IND                                   03140001
050400        MOVE SPACES TO PT-AUTH-FIELD(PT-AUTH-INDEX)               03150001
050400     END-IF.                                                      03160001
350400                                                                  03170001
050400     MOVE PT-AUTH-INDEX TO PV-HOLD-INDEX.                         03180001
050400     PERFORM 2300-MOVE-FIELDS UNTIL PV-HOLD-INDEX > 75.           03190001
050400                                                                  03200001
050400******************************************************************03210001
050400* FIND THE ENDING QUOTE                                           03220001
      * IF THE QUOTE IS FOUND SET THE SWITCH TO TRUE                    03230001
050400******************************************************************03240001
050400 2270-FIND-END-QUOTE.                                             03250001
050400                                                                  03260001
050400     IF PV-HD-FIELD(PV-QUOTE-IND) = PV-QUOTE                      03270001
011000         SET PS-FOUND-END-QUOTE TO TRUE                           03280001
011000         SET PS-FOUND-END TO TRUE                                 03290001
050400     END-IF.                                                      03300001
050400                                                                  03310001
050400     ADD +1 TO  PV-QUOTE-IND.                                     03320001
050400                                                                  03330001
050400******************************************************************03340001
050400* MOVE THE FIELDS BACK BY ONE                                     03350001
050400******************************************************************03360001
050400 2300-MOVE-FIELDS.                                                03370001
050400      MOVE PT-AUTH-FIELD(PV-HOLD-INDEX) TO                        03380001
050400           PT-AUTH-FIELD(PV-HOLD-INDEX - 1).                      03390001
050400      ADD +1 TO PV-HOLD-INDEX.                                    03400001
050400                                                                  03410001
050400******************************************************************03420001
050400* MOVE THE FIELDS TO SERD009                                      03430001
050400******************************************************************03440001
050400 2400-MOVE-TO-OUTPUT.                                             03450001
050400                                                                  03460001
050400      MOVE PT-AUTH-FIELD (1) TO SE009-KHREG-NUM.                  03470001
050400      MOVE PT-AUTH-FIELD (2) TO SE009-SUP-NAME.                   03480001
050400      MOVE PT-AUTH-FIELD (3) TO SE009-JOBACTION.                  03490001
000400      MOVE PT-AUTH-FIELD (4) TO SE009-CELL-PHONE.                 03500001
050400      MOVE PT-AUTH-FIELD (5) TO SE009-PAGER.                      03510001
050400      MOVE PT-AUTH-FIELD (6) TO SE009-KHEMPL-ID.                  03520001
050400      MOVE PT-AUTH-FIELD (7) TO SE009-KHMIDDLE-INITIAL.           03530001
050400      MOVE PT-AUTH-FIELD (8) TO SE009-EMAIL.                      03540001
050400      MOVE PT-AUTH-FIELD (9) TO SE009-LOC-ZIP.                    03550001
050400      MOVE PT-AUTH-FIELD(10) TO SE009-ORIG-HIRE-DATE.             03560001
050400      MOVE PT-AUTH-FIELD(11) TO SE009-HOME-FAX-NBR.               03570001
050400      MOVE PT-AUTH-FIELD(12) TO SE009-LOC-ADDR.                   03580001
050400      MOVE PT-AUTH-FIELD(13) TO SE009-EMP-TERM-CODE.              03590001
050400      MOVE PT-AUTH-FIELD(14) TO SE009-KH-DEPT-ID.                 03600001
050400      MOVE PT-AUTH-FIELD(15) TO SE009-KH-ROLE.                    03610001
050400      MOVE PT-AUTH-FIELD(16) TO SE009-KH-COMPANY.                 03620001
050400      MOVE PT-AUTH-FIELD(17) TO SE009-DEPT-NAME.                  03630001
050400      MOVE PT-AUTH-FIELD(18) TO SE009-TERR-NUM.                   03640001
050400      MOVE PT-AUTH-FIELD(19) TO SE009-DEPT-BEG-DATE.              03650001
050400      MOVE PT-AUTH-FIELD(20) TO SE009-JOB-ACTION.                 03660001
050400      MOVE PT-AUTH-FIELD(21) TO SE009-TELEX-NUM.                  03670001
050400      MOVE PT-AUTH-FIELD(22) TO SE009-GADS-USER-TYPE.             03680001
050400      MOVE PT-AUTH-FIELD(23) TO SE009-HOME-PHONE.                 03690001
050400      MOVE PT-AUTH-FIELD(24) TO SE009-HIRE-DATE.                  03700001
050400      MOVE PT-AUTH-FIELD(25) TO SE009-KH-LOC-NUM.                 03710001
050400      MOVE PT-AUTH-FIELD(26) TO SE009-POS-BEG-DATE.               03720001
050400      MOVE PT-AUTH-FIELD(27) TO SE009-EMPL-TYP-CODE.              03730001
050400      MOVE PT-AUTH-FIELD(28) TO SE009-POSITION-NAME.              03740001
050400      MOVE PT-AUTH-FIELD(29) TO SE009-NAME.                       03750001
050400      MOVE PT-AUTH-FIELD(30) TO SE009-PERSON-TYPE.                03760001
050400      MOVE PT-AUTH-FIELD(31) TO SE009-KH-TITLE.                   03770001
050400      MOVE PT-AUTH-FIELD(32) TO SE009-SHIFT.                      03780001
050400      MOVE PT-AUTH-FIELD(33) TO SE009-LOC-STATE.                  03790001
050400      MOVE PT-AUTH-FIELD(34) TO SE009-GADS-LAST-NAME.             03800001
050400      MOVE PT-AUTH-FIELD(35) TO SE009-ALIAS-TK.                   03810001
050400      MOVE PT-AUTH-FIELD(36) TO SE009-EMP-CATEGORY.               03820001
050400      MOVE PT-AUTH-FIELD(37) TO SE009-DISPLAY-NAME.               03830001
050400      MOVE PT-AUTH-FIELD(38) TO SE009-PAY-GROUP.                  03840001
050400      MOVE PT-AUTH-FIELD(39) TO SE009-LOC-NAME.                   03850001
050400      MOVE PT-AUTH-FIELD(40) TO SE009-JOB-ACT-NAME.               03860001
050400      MOVE PT-AUTH-FIELD(41) TO SE009-JOB-CODE.                   03870001
050400      MOVE PT-AUTH-FIELD(42) TO SE009-LOC-CITY.                   03880001
050400      MOVE PT-AUTH-FIELD(43) TO SE009-FIRST-NAME.                 03890001
050400      MOVE PT-AUTH-FIELD(44) TO SE009-JOB-CODE-NAME.              03900001
050400      MOVE PT-AUTH-FIELD(45) TO SE009-KH-USER-TYPE.               03910001
050400      MOVE PT-AUTH-FIELD(46) TO SE009-TK-NUMBER.                  03920001
050400      MOVE PT-AUTH-FIELD(47) TO SE009-HAS-MAIL-ACCT.              03930001
050400      MOVE PT-AUTH-FIELD(48) TO SE009-JOB-BEG-DATE.               03940001
050400      MOVE PT-AUTH-FIELD(49) TO SE009-JOB-ACT-DATE.               03950001
050400      MOVE PT-AUTH-FIELD(50) TO SE009-POSN-NUM.                   03960001
050400      MOVE PT-AUTH-FIELD(51) TO SE009-WORK-PHONE.                 03970001
050400      MOVE PT-AUTH-FIELD(52) TO SE009-EMPL-STATUS.                03980001
050400      MOVE PT-AUTH-FIELD(53) TO SE009-ACC-CRD-NBR.                03990001
050400      MOVE PT-AUTH-FIELD(54) TO SE009-HAS-APPS-ACCESS.            04000001
050400      MOVE PT-AUTH-FIELD(55) TO SE009-EMPL-INITIALS.              04010001
050400      MOVE PT-AUTH-FIELD(56) TO SE009-DEVICE-NBRS.                04020001
050400      MOVE PT-AUTH-FIELD(57) TO SE009-LAST-DAY-WORKED.            04030001
050400      MOVE PT-AUTH-FIELD(58) TO SE009-LOC-TYPE.                   04040001
050400      MOVE PT-AUTH-FIELD(59) TO SE009-POS-TRAINED.                04050001
050400      MOVE PT-AUTH-FIELD(60) TO SE009-RECORD-TYPE.                04060001
050400      MOVE PT-AUTH-FIELD(61) TO SE009-TERM-DATE.                  04070001
050400      MOVE PT-AUTH-FIELD(62) TO SE009-SUPERVISOR-ID.              04080001
050400      MOVE PT-AUTH-FIELD(63) TO SE009-SN.                         04090001
050400      MOVE PT-AUTH-FIELD(64) TO SE009-UID.                        04100001
050400      MOVE PT-AUTH-FIELD(65) TO SE009-KHDISTNUM.                  04110001
050400                                                                  04120001
060000****************************************************************  04130001
060000*     READ THE INPUT FILE                                         04140001
060000****************************************************************  04150001
060000 2500-READ-INPUT.                                                 04160001
060000     READ ITIM-INPUT-FILE INTO SE009-ITIM-HEADER                  04170001
060000         AT END                                                   04180001
060000             SET PS-INPUT-EOF TO TRUE.                            04190001
060000                                                                  04200001
060000****************************************************************  04210001
060000*     READ THE INPUT FILE                                         04220001
060000****************************************************************  04230001
060000 2600-READ-INPUT.                                                 04240001
060000     READ ITIM-INPUT-FILE INTO SE009-ITIM-DETAIL                  04250001
060000         AT END                                                   04260001
060000             SET PS-INPUT-EOF TO TRUE.                            04270001
060000                                                                  04280001
062000******************************************************************04290001
062100*    WRITE DETAIL OUTPUT RECORD                                  *04300001
062200******************************************************************04310001
062300 2800-WRITE-OUTPUT-RECORD.                                        04320001
062400                                                                  04330001
062500     WRITE ITIM-OUTPUT-REC FROM SE009-ITIM-DETAIL.                04340001
063200                                                                  04350001
063500     ADD 1 TO PV-WRT-COUNT.                                       04360001
063200                                                                  04370001
063200                                                                  04380001
063200****************************************************************  04390001
052000*    END OF PROGRAM                                              *04400001
052100*    - CLOSE THE FILES                                           *04410001
063200****************************************************************  04420001
052300 4000-END-OF-PROGRAM.                                             04430001
052400                                                                  04440001
052500     DISPLAY '****-----------------------------------------****'. 04450001
052600     DISPLAY '**----     END OF SEKUT020 PROCESSING!     ----**'. 04460001
052700     DISPLAY '****-----------------------------------------****'. 04470001
052800     DISPLAY ' '.                                                 04480001
052900                                                                  04490001
053000     CLOSE ITIM-INPUT-FILE                                        04500001
053100           ITIM-OUTPUT-FILE.                                      04510001
103600                                                                  04520001
