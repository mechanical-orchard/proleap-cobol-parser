000100******************************************************************00010001
000200 IDENTIFICATION DIVISION.                                         00020001
000300******************************************************************00030001
000400                                                                  00040001
000500 PROGRAM-ID.    SUKUT029.                                         00050001
000600 AUTHOR.        GERMAN BANDA.                                     00060001
000700 INSTALLATION.  KOHLS.                                            00070001
000800 DATE-WRITTEN   FEBRUARY 2000.                                    00080001
000900 DATE-COMPILED.                                                   00090001
001000                                                                  00100001
001100******************************************************************00110001
001200*THIS PROGRAM WILL EVALUATE EACH RECORD FROM THE INPUT FILE TO    00120010
001300*DETERMINE IF IT SHOULD BE WRITTEN OUT INTO THE MISDIRECT ERRORS  00130010
001400*OUTPUT FILE.                                                     00140010
001600******************************************************************00160001
002400 ENVIRONMENT DIVISION.                                            00240001
002500******************************************************************00250001
002600 INPUT-OUTPUT SECTION.                                            00260001
002800 FILE-CONTROL.                                                    00280001
002900                                                                  00290001
003000                                                                  00300001
003100     SELECT SU-EXTRACT-FILE-IN ASSIGN TO IN01.                    00310001
003200                                                                  00320001
003300     SELECT SU-EXTRACT-FILE-OUT ASSIGN TO OUT01.                  00330002
003400                                                                  00340001
003500******************************************************************00350001
003600 DATA DIVISION.                                                   00360001
003700******************************************************************00370001
003800                                                                  00380001
003900 FILE SECTION.                                                    00390001
004000                                                                  00400001
004100 FD  SU-EXTRACT-FILE-IN                                           00410001
004200     RECORDING MODE IS F                                          00420001
004300     LABEL RECORDS ARE STANDARD                                   00430001
004400     BLOCK CONTAINS 0 RECORDS.                                    00440001
004500                                                                  00450001
004600 01  SU-EXTRACT-RECORD          PIC  X(200).                      00460001
004700                                                                  00470001
004800 FD  SU-EXTRACT-file-out                                          00480001
004900     RECORDING MODE IS F                                          00490001
005000     LABEL RECORDS ARE STANDARD                                   00500001
005100     BLOCK CONTAINS 0 RECORDS.                                    00510001
005200                                                                  00520001
005300 01  SU-EXTRACT-RECORD-OUT     PIC  X(200).                       00530004
005400                                                                  00540001
005500                                                                  00550001
005600******************************************************************00560001
005700 WORKING-STORAGE SECTION.                                         00570001
007900*-----------------------------------------------------------------00790001
008000*                                                                 00800001
008100*-----------------------------------------------------------------00810001
008500 01  PS-PROGRAM-SWITCHES.                                         00850001
008600     05  PS-EOF-EXTRACT-FILE-SW       PIC X(01)  VALUE 'N'.       00860001
008700         88  PS-EOF-EXTRACT-FILE                 VALUE 'Y'.       00870001
008800         88  PS-MORE-EXTRACT-RECORDS             VALUE 'N'.       00880001
008900                                                                  00890001
009000 01  PC-PROGRAM-CONSTANTS.                                        00900001
009100     05  PC-CURRENT-PROGRAM-NAME   PIC  X(08) VALUE 'SUKUT029'.   00910001
009300                                                                  00930001
009400 01  PV-PROGRAM-VARIABLES.                                        00940001
010200     05  PV-DISPLAY-COUNT            PIC  z(09).                  01020018
010300                                                                  01030018
010400     05  PV-WRITE-COUNTER            PIC S9(09)    VALUE ZERO     01040001
010500                                                   COMP SYNC.     01050001
010600     05  PV-READ-COUNTER             PIC S9(09)    VALUE ZERO     01060001
010700                                                   COMP SYNC.     01070001
010710     05  PV-WRGDWLD-WRGCHKIN-CNTR     PIC S9(09)   VALUE ZERO     01071008
010720                                                   COMP SYNC.     01072008
010730     05  PV-RGHTDWLD-WRGCHKIN-CNTR    PIC S9(09)   VALUE ZERO     01073008
010740                                                   COMP SYNC.     01074008
010750     05  PV-WRGDWLD-RGHTCHKIN-CNTR    PIC S9(09)   VALUE ZERO     01075008
010760                                                   COMP SYNC.     01076008
010770     05  PV-BULK-MISDIRECT-CNTR       PIC S9(09)   VALUE ZERO     01077008
010780                                                   COMP SYNC.     01078008
010790     05  PV-DISP-SML                  PIC  9(18)   VALUE ZERO.    01079011
010791     05  PV-SISTER-DC-COUNT           PIC S9(09)   VALUE ZERO     01079117
010792                                                   COMP SYNC.     01079217
010800                                                                  01080001
010900*---------------------------------------------------------*       01090001
011000*  COPYBOOK USED IN CREATING EXTRACT FILE.                *       01100001
011100*---------------------------------------------------------*       01110001
011200     COPY SURD008.                                                01120010
011300*---------------------------------------------------------*       01130001
011400                                                                  01140001
011700 PROCEDURE DIVISION.                                              01170001
011800******************************************************************01180001
012000* 0000-PROGRAM-MAINLINE - CONTROLS THE MAIN PROCESSING OF THE     01200001
012100*      PROGRAM.                                                   01210001
012200*-----------------------------------------------------------------01220001
012210     DISPLAY '***BEGINNING SUKUT029***'.                          01221009
012300 0000-PROGRAM-MAINLINE.                                           01230001
012400                                                                  01240001
012500     PERFORM 1000-INITIALIZE.                                     01250001
012600                                                                  01260001
012700     IF PS-MORE-EXTRACT-RECORDS                                   01270001
012800       PERFORM 2000-PROCESS-RECORDS                               01280001
012900            UNTIL PS-EOF-EXTRACT-FILE                             01290001
013000     END-IF.                                                      01300001
013100                                                                  01310001
013200     PERFORM 9000-EOJ-ROUTINE.                                    01320001
013300                                                                  01330001
013400     GOBACK.                                                      01340001
013500                                                                  01350001
013600                                                                  01360001
013700*-----------------------------------------------------------------01370001
013800*  DO FIRST TIME PROGRAM INITIALIZATION TASKS.                    01380001
013900*    -- OPEN FILES                                                01390001
014000*    -- INITIAL READ                                              01400001
014200*-----------------------------------------------------------------01420001
014300 1000-INITIALIZE.                                                 01430001
014400                                                                  01440001
014500     OPEN INPUT  SU-EXTRACT-FILE-IN.                              01450001
014600     OPEN OUTPUT SU-EXTRACT-FILE-OUT.                             01460002
014700                                                                  01470001
014800     PERFORM 5000-READ-EXTRACT-FILE.                              01480002
014900                                                                  01490001
016600*-----------------------------------------------------------------01660001
016700*  PROCESS THE RECORDS FROM THE INPUT EXTRACT FILE                01670001
016800*-----------------------------------------------------------------01680001
016900 2000-PROCESS-RECORDS.                                            01690001
017000                                                                  01700001
017200     PERFORM 3000-EVAL-FOR-MISDRCT-FILE.                          01720006
017300     PERFORM 5000-READ-EXTRACT-FILE.                              01730006
018100*-----------------------------------------------------------------01810001
018200*                                                                 01820002
018300*-----------------------------------------------------------------01830001
018400 3000-EVAL-FOR-MISDRCT-FILE.                                      01840006
018401                                                                  01840102
018402*                                                                 01840214
018403* If a carton is for EFC, and it is processed by its sister DC    01840314
018404* then it is NOT a misdirect                                      01840414
018405*                                                                 01840514
018406* DMH 11/17/17- BEGIN                                             01840617
018408      IF  SU008-EBUS-IND  = 'Y'  AND                              01840817
018409          SU008-SCN-OPER-UNT-ID = SU008-EFC-SISTER-DC             01840917
018410              ADD  1  TO  PV-SISTER-DC-COUNT                      01841017
018416      ELSE                                                        01841617
018417                                                                  01841717
018418* DMH 11/17/17- END                                               01841817
018419      IF SU008-DEST-OPER-UNT-ID = SU008-ORGN-OPER-UNT-ID          01841914
018420           IF  SU008-ORGN-OPER-UNT-ID = SU008-SCN-OPER-UNT-ID     01842018
018432                CONTINUE                                          01843201
018433           ELSE                                                   01843301
018434                SET BULK-MISDIRECT TO TRUE                        01843401
018435                ADD +1 TO PV-BULK-MISDIRECT-CNTR                  01843508
018436                PERFORM 8000-WRITE-RECORD                         01843601
018437           END-IF                                                 01843701
018438      ELSE                                                        01843801
018439           IF SU008-SCN-OPER-UNT-ID = SU008-ORGN-OPER-UNT-ID      01843901
018440               IF  SU008-SCN-OPER-UNT-ID = SU008-PROCESS-DC-NBR   01844018
018452                  CONTINUE                                        01845201
018453               ELSE                                               01845301
018454                  SET WRG-DC-DWNLD-WRG-CHCKIN-DC TO TRUE          01845401
018455                  ADD +1 TO PV-WRGDWLD-WRGCHKIN-CNTR              01845508
018456                  PERFORM 8000-WRITE-RECORD                       01845601
018457               END-IF                                             01845701
018458           ELSE                                                   01845801
018459              IF  SU008-SCN-OPER-UNT-ID = SU008-PROCESS-DC-NBR    01845918
018471                    SET WRG-DC-DWNLD-RGHT-CHCKIN-DC TO TRUE       01847108
018472                    ADD +1 TO PV-WRGDWLD-RGHTCHKIN-CNTR           01847208
018473                    PERFORM 8000-WRITE-RECORD                     01847307
018474              ELSE                                                01847407
018475                 IF  SU008-ORGN-OPER-UNT-ID =                     01847518
018476                                            SU008-PROCESS-DC-NBR  01847618
018492                     SET RGHT-DC-DWNLD-WRG-CHCKIN-DC TO TRUE      01849211
018493                     ADD +1 TO PV-RGHTDWLD-WRGCHKIN-CNTR          01849311
018494                     PERFORM 8000-WRITE-RECORD                    01849411
018495                 ELSE                                             01849511
018496                     SET WRG-DC-DWNLD-WRG-CHCKIN-DC TO TRUE       01849611
018497                     ADD +1 TO PV-WRGDWLD-WRGCHKIN-CNTR           01849711
018498                     PERFORM 8000-WRITE-RECORD                    01849811
018499                 END-IF                                           01849911
018500              END-IF                                              01850011
018510           END-IF                                                 01851011
018600      END-IF                                                      01860017
018700      END-IF.                                                     01870017
024500*-----------------------------------------------------------------02450001
024600 5000-READ-EXTRACT-FILE.                                          02460002
024700                                                                  02470001
024710     INITIALIZE SU008-EXTRACT-RECORD.                             02471006
024900     READ SU-EXTRACT-FILE-IN  INTO SU008-EXTRACT-RECORD           02490001
025000        AT END                                                    02500001
025100           SET PS-EOF-EXTRACT-FILE TO TRUE                        02510006
025110        not at end                                                02511006
025120           ADD +1 TO PV-READ-COUNTER                              02512006
025200     END-READ.                                                    02520006
025300*-----------------------------------------------------------------02530001
025400*  WRITE THE SHIPMENT-UNIT-RECORD                                 02540001
025500*-----------------------------------------------------------------02550001
025600 8000-WRITE-RECORD.                                               02560001
025700                                                                  02570001
025800     WRITE SU-EXTRACT-RECORD-OUT FROM SU008-EXTRACT-RECORD.       02580004
025900     ADD +1 TO PV-WRITE-COUNTER.                                  02590002
026000                                                                  02600001
026100                                                                  02610001
026200*-----------------------------------------------------------------02620001
026300*  CLOSE OUTPUT FILE.                                             02630001
026400*-----------------------------------------------------------------02640001
026500 9000-EOJ-ROUTINE.                                                02650001
026600     CLOSE SU-EXTRACT-FILE-IN                                     02660001
026700           SU-EXTRACT-FILE-OUT.                                   02670002
026800                                                                  02680001
026900     MOVE PV-READ-COUNTER TO PV-DISPLAY-COUNT.                    02690001
027000     DISPLAY ' '                                                  02700020
027010     DISPLAY 'TOTAL EXTRACT RECORDS READ      ' PV-DISPLAY-COUNT. 02701020
027020     DISPLAY ' '                                                  02702020
027100     MOVE PV-WRITE-COUNTER TO PV-DISPLAY-COUNT.                   02710001
027200     DISPLAY 'TOTAL MISDIRECT RECORDS WRITTEN ' PV-DISPLAY-COUNT. 02720008
027201     DISPLAY ' '                                                  02720120
027210*                                                                 02721008
027300     MOVE PV-BULK-MISDIRECT-CNTR TO PV-DISPLAY-COUNT.             02730008
027400     DISPLAY 'TOTAL BULK MISDIRECT RECORDS    ' PV-DISPLAY-COUNT. 02740018
027410*                                                                 02741008
027500     MOVE PV-WRGDWLD-WRGCHKIN-CNTR TO PV-DISPLAY-COUNT.           02750008
027600     DISPLAY 'TOTAL WRGDWNLD/WRGCHCKIN        ' PV-DISPLAY-COUNT. 02760018
027610*                                                                 02761008
027700     MOVE PV-RGHTDWLD-WRGCHKIN-CNTR TO PV-DISPLAY-COUNT.          02770008
027800     DISPLAY 'TOTAL RGHTDWNLD/WRGCHCKIN       ' PV-DISPLAY-COUNT. 02780018
027810*                                                                 02781008
027900     MOVE PV-WRGDWLD-RGHTCHKIN-CNTR TO PV-DISPLAY-COUNT.          02790008
028000     DISPLAY 'TOTAL WRGDWNLD/RGHTCHCKIN       ' PV-DISPLAY-COUNT. 02800018
028100*                                                                 02810017
028200     MOVE PV-SISTER-DC-COUNT        TO PV-DISPLAY-COUNT.          02820017
028300     DISPLAY ' '.                                                 02830019
028400     DISPLAY 'TOTAL SISTER DC (not misdirect) ' PV-DISPLAY-COUNT. 02840019
