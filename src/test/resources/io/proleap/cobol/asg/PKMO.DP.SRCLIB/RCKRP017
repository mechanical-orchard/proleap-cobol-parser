000100 IDENTIFICATION DIVISION.                                         00010064
000200 TITLE 'DAILY DETAILED RECEIPTS REPORTS'.                         00020064
000300 PROGRAM-ID.             RCKRP017.                                00030064
000400 AUTHOR.                 DENNIS STEFFEN - OMNI RESOURCES.         00040064
000500 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00050064
000600 DATE-WRITTEN            MARCH 1997.                              00060064
000700 DATE-COMPILED.                                                   00070064
000800                                                                  00080064
000900 ENVIRONMENT DIVISION.                                            00090064
001000 CONFIGURATION SECTION.                                           00100064
001100 SOURCE-COMPUTER.        IBM-3090.                                00110064
001200 OBJECT-COMPUTER.        IBM-3090.                                00120064
001300 INPUT-OUTPUT SECTION.                                            00130064
001400 FILE-CONTROL.                                                    00140064
001500                                                                  00150064
001600     SELECT STORE-REC-EXTRACT-FILE  ASSIGN TO INP01.              00160064
001700     SELECT RECEIPTS-TOTAL-FILE     ASSIGN TO OUT01.              00170064
001800     SELECT DAILY-RECEIPTS          ASSIGN TO RPT01.              00180064
001900     SELECT SUMMARY-REPORT          ASSIGN TO RPT02.              00190064
002000 EJECT                                                            00200064
002100 DATA DIVISION.                                                   00210064
002200 FILE SECTION.                                                    00220064
002300 SKIP3                                                            00230064
002400 FD  STORE-REC-EXTRACT-FILE                                       00240064
002500     RECORDING MODE IS F                                          00250064
002600     BLOCK CONTAINS  0 RECORDS                                    00260064
002700     LABEL RECORDS ARE STANDARD.                                  00270064
002800 SKIP1                                                            00280064
002900 01  STORE-REC-EXTRACT-REC          PIC X(300).                   00290064
003000 SKIP3                                                            00300064
003100 FD  RECEIPTS-TOTAL-FILE                                          00310064
003200     RECORDING MODE IS F                                          00320064
003300     BLOCK CONTAINS  0 RECORDS                                    00330064
003400     LABEL RECORDS ARE STANDARD.                                  00340064
003500 SKIP1                                                            00350064
003600 01  RECEIPTS-TOTAL-REC          PIC X(080).                      00360064
003700 SKIP3                                                            00370064
003800 FD  DAILY-RECEIPTS                                               00380064
003900     RECORDING MODE IS F                                          00390064
004000     RECORD CONTAINS 133 CHARACTERS                               00400064
004100     BLOCK CONTAINS  0 RECORDS                                    00410064
004200     LABEL RECORDS ARE STANDARD.                                  00420064
004300 01  DAILY-RECEIPTS-RPT          PIC X(133).                      00430064
004400 SKIP1                                                            00440064
004500 FD  SUMMARY-REPORT                                               00450064
004600     RECORDING MODE IS F                                          00460064
004700     RECORD CONTAINS 133 CHARACTERS                               00470064
004800     BLOCK CONTAINS  0 RECORDS                                    00480064
004900     LABEL RECORDS ARE STANDARD.                                  00490064
005000 SKIP1                                                            00500064
005100 01  SUMMARY-RPT                 PIC X(133).                      00510064
005200 SKIP3                                                            00520064
005300 EJECT                                                            00530064
005400 WORKING-STORAGE SECTION.                                         00540064
005500 01  FILLER     PIC X(40) VALUE 'WORKING STORAGE STARTS HERE'.    00550064
005600*                                                                 00560064
005700 01  PV-SUBSCRIPTS.                                               00570064
005800     05  PV-STORE-SUB                 PIC S9(4) COMP VALUE ZERO.  00580064
005900     05  SUB                          PIC S9(4) COMP VALUE ZERO.  00590064
006000     05  SUB1                         PIC S9(4) COMP VALUE ZERO.  00600064
006100                                                                  00610064
006200 01  PROGRAM-SWITCHES.                                            00620064
006300     05  PS-STOREEXT-EOF              PIC X VALUE 'N'.            00630064
006400         88  PS-EOF-STOREEXT                VALUE 'Y'.            00640064
006500     05  PS-NO-DETAIL-SW              PIC X VALUE 'N'.            00650064
006600         88  PS-NO-DETAIL                   VALUE 'Y'.            00660064
006700     05  PS-DISCREPANCY-SW            PIC X VALUE 'N'.            00670064
006800         88 PS-DISCREPANCY-FOUND            VALUE 'Y'.            00680064
006900                                                                  00690064
007000 01  PROGRAM-COUNTERS COMP-3.                                     00700064
007100     05  PV-STOREEXT-COUNT            PIC S9(9)     VALUE ZERO.   00710064
007200     05  PV-LINE-CNT                  PIC S9(3)     VALUE +56.    00720064
007300     05  PV-PAGE-CNT                  PIC S9(5)     VALUE ZERO.   00730064
007400     05  PV-SELECT-COUNTER            PIC S9(05)    VALUE ZERO.   00740064
007500     05  PV-SKU-COUNTER               PIC S9(05)    VALUE ZERO.   00750064
007600     05  PV-RCVR-CNT                  PIC S9(07)    VALUE ZERO.   00760064
007700     05  PV-QTY-MARKED-TOT            PIC S9(09)    VALUE ZERO.   00770084
007800     05  PV-COST-TOT                  PIC S9(09)V99 VALUE ZERO.   00780064
007900     05  PV-RETAIL-TOT                PIC S9(09)V99 VALUE ZERO.   00790064
008000     05  PV-HOLD-UNIT-MARKED-TOTAL    PIC S9(9)     VALUE ZERO.   00800064
008100     05  PV-HOLD-UNIT-RETAIL          PIC S9(7)V99  VALUE ZERO.   00810064
008200     05  PV-HOLD-UNIT-OPEN-TOTAL      PIC S9(7)V99  VALUE ZERO.   00820064
008210******    WR # 27201 - START                                      00830082
008300*    05  PV-RTL-AMT                   PIC S9(7)V99  VALUE ZERO.   00840064
008400*    05  PV-SKU-RTL-AMT               PIC S9(7)V99  VALUE ZERO.   00850064
008410******    WR # 27201 - END                                        00860082
008500                                                                  00870064
008600                                                                  00880064
008700 01  PROGRAM-DATE-INFO.                                           00890064
008800     05 PV-DATE                                      VALUE        00900064
008900                                                       LOW-VALUES.00910064
009000         10  PV-MM                    PIC XX.                     00920064
009100         10  PV-DD                    PIC XX.                     00930064
009200         10  PV-YY                    PIC XX.                     00940064
009300     05  PV-TIME.                                                 00950064
009400         10  PV-TIME-HH               PIC 99      VALUE ZEROS.    00960064
009500         10  PV-TIME-MM               PIC 99      VALUE ZEROS.    00970064
009600         10  FILLER                   PIC 9(4)    VALUE ZEROS.    00980064
009700     05  PV-CURRENT-DATE.                                         00990064
009800         10  PV-CURR-YY               PIC 9(2)    VALUE ZEROS.    01000064
009900         10  PV-CURR-MM               PIC 9(2)    VALUE ZEROS.    01010064
010000         10  PV-CURR-DD               PIC 9(2)    VALUE ZEROS.    01020064
010100     05  PV-HOLD-TIMESTAMP.                                       01030064
010200         10  PV-HOLD-TMST-YYYY        PIC X(4).                   01040064
010300         10  FILLER                   PIC X(1).                   01050064
010400         10  PV-HOLD-TMST-MM          PIC X(2).                   01060064
010500         10  FILLER                   PIC X(1).                   01070064
010600         10  PV-HOLD-TMST-DD          PIC X(2).                   01080064
010700         10  FILLER                   PIC X(16).                  01090064
010800 01  MISC.                                                        01100064
010900     05  PC-MAX-RETRIES               PIC S9(03) COMP-3 VALUE +3. 01110064
011000     05  PV-CC                        PIC 9  VALUE 1.             01120064
011100     05  PV-HOLD-CLASS.                                           01130064
011200         10  PV-CLASS                PIC X(03).                   01140064
011300     05  PV-HOLD-CLASS-RDF REDEFINES PV-HOLD-CLASS.               01150064
011400         10  PV-CLASS-RDF            PIC X(02).                   01160064
011500         10  FILLER                  PIC X(01).                   01170064
011600     05  PV-HOLD-STYLE.                                           01180064
011700         10  FILLER                  PIC X(01).                   01190064
011800         10  PV-SEQ                  PIC X(03).                   01200064
011900         10  FILLER                  PIC X(01).                   01210064
011910*----------------------------------------------------------------*01220082
011920* ADDED PROGRAM VARIABLES                             WR # 21361 *01230082
011930* PV-HOLD-SKU-NBR, PV-TEMP-KEY-SKU, PV-TEMP-GP-QTY &             *01240082
011940* PV-TEMP-UNT-RTL-AMT.                                           *01250082
011950*----------------------------------------------------------------*01260082
011960     05  PV-HOLD-SKU-NBR             PIC X(8).                    01270082
011961******    WR # 27201 - START                                      01280082
011970*    05  PV-TEMP-KEY-SKU             PIC 9(8).                    01290066
011980*    05  PV-TEMP-GP-QTY              PIC 9(9).                    01300066
011990*    05  PV-TEMP-UNT-RTL-AMT         PIC 9(7)V9(2).               01310066
011991******    WR # 27201 - END                                        01320082
011992*----------------------------------------------------------------*01330066
011993* CHANGES MADE FOR WR # 21361 ENDS HERE.                         *01340067
011994*----------------------------------------------------------------*01350066
012000     05  PV-HOLD-VERIFIED-DATE.                                   01360064
012100         10  PV-HOLD-VD-MM           PIC 9(02)   VALUE ZERO.      01370064
012200         10  PV-HOLD-VD-DD           PIC 9(02)   VALUE ZERO.      01380064
012300         10  PV-HOLD-VD-YY           PIC 9(02)   VALUE ZERO.      01390064
012400     05  PV-HOLD-DEPT                PIC X(03).                   01400064
012500     05  PV-HOLD-REC-SRC-CDE         PIC X(01).                   01410064
012600     05  PV-HOLD-SEQ-NBR             PIC 9(09).                   01420064
012700     05  PV-NOTIF-NBR                PIC S9(09)      COMP.        01430064
012800     05  PV-HOLD-STORE               PIC S9(04) COMP.             01440064
012900     05  PV-WORK-RECSEQ-NBR.                                      01450064
013000         10  PV-WORK-FILLER          PIC X(05).                   01460064
013100         10  PV-WORK-REC-SEQ-NBR     PIC X(04).                   01470064
013200     05  PV-OPEN-FORMAT.                                          01480064
013300         10  PV-DTL-FORMAT-OPEN      PIC ZZZZ,ZZ9-.               01490064
013400     05  PV-ADJ-OPEN-FORMAT.                                      01500064
013500         10  PV-ADJ-FORMAT-OPEN      PIC ZZZZ,ZZZ-.               01510064
013600     05  PV-PARAGRAPH-NAME           PIC  X(30) VALUE SPACE.      01520064
013700     05  PV-DB2-OPERATION-ATTEMPTED  PIC  X(30) VALUE SPACE.      01530064
013800                                                                  01540064
013900 01  ABEND-CODE                      PIC S9(04) VALUE +0          01550064
014000                                                COMP SYNC.        01560064
014100     88  ABEND-4013-DB2-ERROR                   VALUE +4013.      01570064
014200/                                                                 01580064
014300 01  PV-HEADER1.                                                  01590064
014400     05  FILLER              PIC X(44)       VALUE SPACES.        01600064
014500     05  FILLER              PIC X(44)       VALUE                01610064
014600     'K O H L S  D E P A R T M E N T  S T O R E S'.               01620064
014700     05  FILLER              PIC X(25)       VALUE SPACES.        01630064
014800     05  FILLER              PIC X(19)       VALUE                01640064
014900     'REPORT: RCKRP017-1 '.                                       01650064
015000 SKIP2                                                            01660064
015100 01  PV-HEADER2.                                                  01670064
015200     05  FILLER              PIC X(10)       VALUE                01680064
015300         ' DIVISION-'.                                            01690064
015400     05  PV-HDR2-DIVISION    PIC XXX         VALUE SPACES.        01700064
015500     05  FILLER              PIC X(20)       VALUE SPACES.        01710064
015600     05  FILLER              PIC X(45)       VALUE                01720064
015700     'M E R C H A N D I S E     P R O C E S S I N G'.             01730064
015800     05  FILLER              PIC X(16)       VALUE                01740064
015900     '     S Y S T E M'.                                          01750064
016000     05  FILLER              PIC X(24)       VALUE SPACES.        01760064
016100     05  FILLER              PIC X(8)        VALUE                01770064
016200     'PAGE    '.                                                  01780064
016300     05  PV-HDR2-PAGE        PIC ZZ,ZZ9      VALUE ZEROS.         01790064
016400 SKIP2                                                            01800064
016500 01  PV-HEADER3.                                                  01810064
016600     05  FILLER              PIC X(98)       VALUE SPACES.        01820064
016700     05  FILLER              PIC X(16)       VALUE                01830064
016800     'RUN DATE/TIME   '.                                          01840064
016900     05  PV-HDR3-RUN-DATE-MM PIC 99          VALUE ZEROS.         01850064
017000     05  FILLER              PIC X           VALUE '/'.           01860064
017100     05  PV-HDR3-RUN-DATE-DD PIC 99          VALUE ZEROS.         01870064
017200     05  FILLER              PIC X           VALUE '/'.           01880064
017300     05  PV-HDR3-RUN-DATE-YY PIC 99          VALUE ZEROS.         01890064
017400     05  FILLER              PIC X(5)        VALUE SPACES.        01900064
017500     05  PV-HDR3-RUN-TIME-HH PIC 99          VALUE ZEROS.         01910064
017600     05  FILLER              PIC X           VALUE ':'.           01920064
017700     05  PV-HDR3-RUN-TIME-MM PIC 99          VALUE ZEROS.         01930064
017800 SKIP2                                                            01940064
017900 01  PV-HEADER4.                                                  01950064
018000     05  FILLER              PIC X(12)       VALUE                01960064
018100     ' DEPARTMENT-'.                                              01970064
018200     05  PV-HDR4-DEPARTMENT  PIC XXX         VALUE SPACES.        01980064
018300     05  FILLER              PIC X(40)       VALUE SPACES.        01990064
018400     05  FILLER              PIC X(82)       VALUE                02000064
018500     'DAILY DETAILED RECEIPTS REPORT'.                            02010064
018600 SKIP2                                                            02020064
018700 01  PV-HEADER5.                                                  02030064
018800     05  FILLER              PIC X(57)       VALUE SPACES.        02040064
018900     05  FILLER              PIC X(75)       VALUE                02050064
019000     '(VERIFIED COUNT)'.                                          02060064
019100 SKIP2                                                            02070064
019200 01  PV-HEADER6.                                                  02080064
019300     05  FILLER              PIC X(8)        VALUE                02090064
019400     ' REGION-'.                                                  02100064
019500     05  PV-HDR6-REGION      PIC XX          VALUE SPACES.        02110064
019600     05  FILLER              PIC X(51)       VALUE SPACES.        02120064
019700     05  PV-HDR6-MM          PIC XX          VALUE SPACES.        02130064
019800     05  FILLER              PIC X           VALUE '/'.           02140064
019900     05  PV-HDR6-DD          PIC XX          VALUE SPACES.        02150064
020000     05  FILLER              PIC X           VALUE '/'.           02160064
020100     05  PV-HDR6-YY          PIC XX          VALUE SPACES.        02170064
020200     05  FILLER              PIC X(63)       VALUE SPACES.        02180064
020300 SKIP2                                                            02190064
020400 01  PV-HEADER7.                                                  02200064
020500     05  FILLER              PIC X(31)       VALUE                02210064
020600     ' SKU NUMBER              '.                                 02220064
020700     05  FILLER              PIC X(25)       VALUE                02230064
020800     'ST      RETAIL QTY.'.                                       02240064
020900     05  FILLER              PIC X(27)       VALUE                02250064
021000     '  ST      RETAIL QTY.'.                                     02260064
021100     05  FILLER              PIC X(27)       VALUE                02270064
021200     '  ST      RETAIL QTY.'.                                     02280064
021300     05  FILLER              PIC X(21)       VALUE                02290064
021400     '  ST      RETAIL QTY.'.                                     02300064
021500 SKIP2                                                            02310064
021600 01  PV-HEADER8.                                                  02320064
021700     05  FILLER              PIC X(20)       VALUE SPACES.        02330064
021800     05  FILLER              PIC X(18)       VALUE                02340064
021900     'RETAIL'.                                                    02350064
022000     05  FILLER              PIC X(27)       VALUE                02360064
022100     'OPEN   MARKED  '.                                           02370064
022200     05  FILLER              PIC X(25)       VALUE                02380064
022300     'OPEN   MARKED'.                                             02390064
022400     05  FILLER              PIC X(27)       VALUE                02400064
022500     '  OPEN   MARKED'.                                           02410064
022600     05  FILLER              PIC X(21)       VALUE                02420064
022700     '  OPEN   MARKED'.                                           02430064
022800 SKIP2                                                            02440064
022900 01  PV-HEADER9.                                                  02450064
023000     05  FILLER              PIC X(11)       VALUE                02460064
023100     '  PO-SEQ#: '.                                               02470064
023200     05  PV-HDR9-PO-NO       PIC X(8)        VALUE SPACES.        02480064
023300     05  FILLER              PIC X(03)       VALUE                02490064
023400     ' - '.                                                       02500064
023500     05  PV-HDR9-RECSEQ-NBR  PIC X(04)       VALUE SPACES.        02510064
023600     05  FILLER              PIC X(13)       VALUE                02520064
023700     '     VENDOR: '.                                             02530064
023800     05  PV-HDR9-VENDOR-NO   PIC XXX         VALUE SPACES.        02540064
023900     05  FILLER              PIC X(15)       VALUE                02550064
024000     '  VENDOR NAME: '.                                           02560064
024100     05  PV-HDR9-VENDOR-NAME PIC X(25)       VALUE SPACES.        02570064
024200     05  FILLER              PIC X(22)       VALUE                02580064
024300     '  RECEIVING LOCATION: '.                                    02590064
024400     05  PV-HDR9-REC-LOC     PIC X(25)       VALUE SPACES.        02600064
024500 SKIP2                                                            02610064
024600 01  PV-HEADER9-ADJ.                                              02620064
024700     05  FILLER              PIC X(17)       VALUE                02630064
024800     ' ** ADJUSTMENT - '.                                         02640064
024900     05  PV-HDR9-MM          PIC XX          VALUE SPACES.        02650064
025000     05  FILLER              PIC X           VALUE '/'.           02660064
025100     05  PV-HDR9-DD          PIC XX          VALUE SPACES.        02670064
025200     05  FILLER              PIC X           VALUE '/'.           02680064
025300     05  PV-HDR9-YYYY        PIC XXXX        VALUE SPACES.        02690064
025400     05  FILLER              PIC X(3)        VALUE                02700064
025500     ' **'.                                                       02710064
025600     05  FILLER              PIC X(63)       VALUE SPACES.        02720064
025700 SKIP2                                                            02730064
025800 01  PV-HEADER10.                                                 02740064
025900     05  FILLER              PIC X(3)        VALUE SPACES.        02750064
026000     05  PV-HDR10-FILLER     PIC X(14)       VALUE SPACES.        02760064
026100     05  FILLER              PIC X           VALUE SPACES.        02770064
026200     05  PV-HDR10-TOTAL      PIC ZZZ,ZZ9-    VALUE ZEROS.         02780064
026300     05  FILLER              PIC X(101)      VALUE SPACES.        02790064
026400 SKIP2                                                            02800064
026410* CHANGED THE STRUCTURE OF PV-DETAIL.                 WR # 21361 *02810067
026420 01  PV-DETAIL.                                                   02820066
026430     05  PV-DTL-CLASS        PIC XX          VALUE SPACES.        02830066
026440     05  FILLER              PIC X           VALUE SPACE.         02840066
026450     05  PV-DTL-SKU-NBR      PIC X(8)        VALUE SPACES.        02850066
026460     05  FILLER              PIC X           VALUE SPACE.         02860066
027400     05  PV-DTL-UNIT-RETAIL  PIC ZZZZ,ZZZ.99- VALUE ZEROS.        02870064
027500     05  PV-DTL-STORE-TOTALS     OCCURS 4 TIMES.                  02880064
027600         10  FILLER          PIC X(5).                            02890064
027700         10  PV-DTL-LOC-NBR  PIC 9(04).                           02900064
027800         10  PV-DTL-RETAIL-OPEN                                   02910064
027900                             PIC X(9).                            02920064
028000         10  PV-DTL-RETAIL-MARKED                                 02930064
028100                             PIC ZZZZ,ZZ9-.                       02940064
028200     05  FILLER              PIC X(1).                            02950064
028300/                                                                 02960064
028400 01  PV-OUT1-DETAIL.                                              02970064
028500     05  PV-OUT1-MM          PIC 99.                              02980064
028600     05  FILLER              PIC X(01)       VALUE '/'.           02990064
028700     05  PV-OUT1-DD          PIC 99.                              03000064
028800     05  FILLER              PIC X(01)       VALUE '/'.           03010064
028900     05  PV-OUT1-YY          PIC 99.                              03020064
029000     05  FILLER              PIC X(01)       VALUE SPACE.         03030064
029100     05  PV-OUT1-HOURS       PIC 99.                              03040064
029200     05  FILLER              PIC X(01)       VALUE '.'.           03050064
029300     05  PV-OUT1-MINUTES     PIC 99.                              03060064
029400     05  FILLER              PIC X(01)       VALUE SPACE.         03070064
029500     05  PV-OUT1-RCVR-TOT    PIC S9(07)      COMP-3.              03080064
029600     05  FILLER              PIC X(01)       VALUE SPACE.         03090064
029700     05  PV-OUT1-MARKED-TOT  PIC S9(09)      COMP-3.              03100064
029800     05  FILLER              PIC X(01)       VALUE SPACE.         03110064
029900     05  PV-OUT1-COST-TOT    PIC S9(09)V99   COMP-3.              03120064
030000     05  FILLER              PIC X(01)       VALUE SPACE.         03130064
030100     05  PV-OUT1-RET-TOT     PIC S9(09)V99   COMP-3.              03140064
030200     05  FILLER              PIC X(41)       VALUE SPACES.        03150064
030300/                                                                 03160064
030400 01  PV-RPT2-HEADER1.                                             03170064
030500     05  FILLER              PIC X           VALUE SPACE.         03180064
030600     05  PV-RPT2-MM          PIC 99.                              03190064
030700     05  FILLER              PIC X           VALUE '/'.           03200064
030800     05  PV-RPT2-DD          PIC 99.                              03210064
030900     05  FILLER              PIC X           VALUE '/'.           03220064
031000     05  PV-RPT2-YY          PIC 99.                              03230064
031100     05  FILLER              PIC XX          VALUE SPACE.         03240064
031200     05  PV-RPT2-HOURS       PIC 99.                              03250064
031300     05  FILLER              PIC X           VALUE ':'.           03260064
031400     05  PV-RPT2-MINUTES     PIC 99.                              03270064
031500     05  FILLER              PIC X(28)       VALUE SPACES.        03280064
031600     05  FILLER              PIC X(44)       VALUE                03290064
031700     'K O H L S  D E P A R T M E N T  S T O R E S'.               03300064
031800     05  FILLER              PIC X(23)       VALUE SPACES.        03310064
031900     05  FILLER              PIC X(17)       VALUE                03320064
032000         'RCKRP017-2  PAGE '.                                     03330064
032100     05  PV-RPT2-PAGE-NBR    PIC ZZZZ9.                           03340064
032200                                                                  03350064
032300 01  PV-RPT2-HEADER2.                                             03360064
032400     05  FILLER              PIC X(50)       VALUE SPACE.         03370064
032500     05  FILLER              PIC X(32)       VALUE                03380064
032600     'RECEIPTS VERIFIED SUMMARY REPORT'.                          03390064
032700     05  FILLER              PIC X(50)       VALUE SPACES.        03400064
032800                                                                  03410064
032900 01  PV-RPT2-HEADER3.                                             03420064
033000     05  FILLER              PIC X(15)       VALUE SPACE.         03430064
033100     05  FILLER              PIC X(20)       VALUE SPACE.         03440064
033200     05  FILLER              PIC X(08)       VALUE                03450064
033300     'RECEIVER'.                                                  03460064
033400     05  FILLER              PIC X(20)       VALUE SPACE.         03470064
033500     05  FILLER              PIC X(08)       VALUE                03480064
033600     'QUANTITY'.                                                  03490064
033700     05  FILLER              PIC X(20)       VALUE SPACE.         03500064
033800     05  FILLER              PIC X(04)       VALUE                03510064
033900     'COST'.                                                      03520064
034000     05  FILLER              PIC X(20)       VALUE SPACE.         03530064
034100     05  FILLER              PIC X(06)       VALUE                03540064
034200     'RETAIL'.                                                    03550064
034300     05  FILLER              PIC X(20)       VALUE SPACE.         03560064
034400                                                                  03570064
034500 01  PV-RPT2-HEADER4.                                             03580064
034600     05  FILLER              PIC X(15)       VALUE SPACE.         03590064
034700     05  FILLER              PIC X(20)       VALUE SPACE.         03600064
034800     05  FILLER              PIC X(08)       VALUE                03610064
034900     ' NUMBER '.                                                  03620064
035000     05  FILLER              PIC X(20)       VALUE SPACE.         03630064
035100     05  FILLER              PIC X(08)       VALUE                03640064
035200     ' MARKED '.                                                  03650064
035300     05  FILLER              PIC X(19)       VALUE SPACE.         03660064
035400     05  FILLER              PIC X(06)       VALUE                03670064
035500     'AMOUNT'.                                                    03680064
035600     05  FILLER              PIC X(19)       VALUE SPACE.         03690064
035700     05  FILLER              PIC X(06)       VALUE                03700064
035800     'AMOUNT'.                                                    03710064
035900     05  FILLER              PIC X(20)       VALUE SPACE.         03720064
036000                                                                  03730064
036100 01  PV-RPT2-DETAIL.                                              03740064
036200     05  FILLER              PIC X(15)       VALUE                03750064
036300     '   FINAL TOTALS'.                                           03760064
036400     05  FILLER              PIC X(20)       VALUE SPACE.         03770064
036500     05  PV-RPT2-RCVR-TOT    PIC ZZZ,ZZ9.                         03780064
036600     05  FILLER              PIC X(17)       VALUE SPACE.         03790064
036700     05  PV-RPT2-MARKED-TOT  PIC ZZZ,ZZZ,ZZ9-.                    03800065
036800     05  FILLER              PIC X(15)       VALUE SPACE.         03810065
036900     05  PV-RPT2-COST-TOT    PIC ZZZ,ZZZ,ZZ9.99-.                 03820064
037000     05  FILLER              PIC X(10)       VALUE SPACE.         03830064
037100     05  PV-RPT2-RET-TOT     PIC ZZZ,ZZZ,ZZ9.99-.                 03840064
037200/                                                                 03850064
037300 01  PV-TOTAL.                                                    03860064
037400     05  FILLER              PIC X(68)       VALUE SPACES.        03870064
037500     05  PV-TTL-LIT-1        PIC X(27)       VALUE SPACES.        03880064
037600     05  FILLER              PIC X(9)        VALUE SPACES.        03890064
037700     05  PV-TTL-TOTAL-RETAIL PIC ZZZ,ZZZ,ZZZ.99-                  03900064
037800                                             VALUE ZEROS.         03910064
037900     05  FILLER              PIC X           VALUE SPACES.        03920064
038000     05  PV-TTL-ASTERICKS    PIC X(5)        VALUE SPACES.        03930064
038100     05  FILLER              PIC X(8)        VALUE SPACES.        03940064
038200 SKIP2                                                            03950064
038210******    WR # 27201 - START                                      03960082
038300*01  PV-RETAIL-DISCREP.                                           03970064
038400*    05  FILLER              PIC X(43)       VALUE                03980064
038500*        '**  **  **  VERIFIED RETAIL DOES NOT MATCH'.            03990064
038600*    05  FILLER              PIC X(34)       VALUE                04000064
038700*        'CURRENT RETAIL FOR SKU  **  **  **'.                    04010064
038800*    05  FILLER              PIC X(6)        VALUE SPACES.        04020064
038900*    05  FILLER              PIC X(18)       VALUE                04030064
039000*        'RETAIL FOR SKU IS '.                                    04040064
039100*    05  PV-SKU-RETAIL       PIC ZZZZ,ZZ9.99-.                    04050064
039110******    WR # 27201 - END                                        04060082
039200                                                                  04070064
039300 01  PR-PRINT-NO-DETAIL.                                          04080064
039400     05  FILLER                      PIC X(53)  VALUE SPACES.     04090064
039500     05  FILLER                      PIC X(29)  VALUE             04100064
039600         '*** NO DETAILS TO REPORT ***'.                          04110064
039601                                                                  04120064
039602 01  PR-PRINT-FINAL.                                              04130000
039603     05  FILLER                      PIC X(53)  VALUE SPACES.     04140000
039604     05  FILLER                      PIC X(21)  VALUE             04150000
039605         '*** END OF REPORT ***'.                                 04160000
039606                                                                  04170000
039607/                                                                 04180064
039608     COPY DPWS132O.                                               04190070
039609/                                                                 04200064
039610     COPY STOREEXT.                                               04210070
039620/                                                                 04220064
045810*  LOGISTICS DOMAIN LOCATION MODULE                               04230033
045820*                                                                 04240033
045830     COPY XLWS071.                                                04250033
045900/                                                                 04260030
045901     EXEC SQL                                                     04270082
045902         INCLUDE TTRBNTF                                          04280064
045903     END-EXEC.                                                    04290064
045904/                                                                 04300064
045905     EXEC SQL                                                     04310064
045906         INCLUDE SQLCA                                            04320064
045907     END-EXEC.                                                    04330064
045908                                                                  04340064
045909     COPY SQLCA2.                                                 04350064
045910                                                                  04360064
045911     COPY DPWS004.                                                04370064
045912                                                                  04380066
045913*  COPYBOOK FOR LOGISTICS DOMAIN ITEM ACCESS MODULE  WR # 21361  *04390067
045914                                                                  04400066
045915******    WR # 27201 - START                                      04410082
045916*    COPY XLWS001.                                                04420066
045917******    WR # 27201 - START                                      04430082
045918/                                                                 04440064
045919 01  PT-LOCATIONS-TABLE.                                          04450064
045920     05  PT-LOCATIONS OCCURS 50 TIMES INDEXED BY LOC-IDX.         04460085
045921         10  PT-OPER-UNT-ID  PIC S9(4) COMP.                      04470064
045922         10  PT-FCLTY-ID     PIC S9(4) COMP.                      04480064
045923         10  PT-LOCATION     PIC X(25).                           04490064
045924                                                                  04500064
045925 01  PV-STORE-TOTALS-TABLE             VALUE ZERO.                04510064
045926     05  PV-STORE-TOTALS    OCCURS 5000 TIMES.                    04520064
045927         10  PV-LOC-NBR          PIC S9(04).                      04530064
045928         10  PV-STORE-OPEN-QTY   PIC S9(8).                       04540064
045929         10  PV-STORE-MARKED-QTY PIC S9(8).                       04550064
045930         10  PV-STORE-RECVD-QTY  PIC S9(8).                       04560064
045931         10  PV-STORE-ORDER-QTY  PIC S9(8).                       04570064
045932/                                                                 04580064
045933 PROCEDURE DIVISION.                                              04590064
045934     PERFORM 1000-INITIALIZE.                                     04600064
045935                                                                  04610064
045936     PERFORM 2000-PROCESS UNTIL PS-EOF-STOREEXT                   04620064
045937                                                                  04630064
045938     PERFORM 9000-EOJ.                                            04640064
045939                                                                  04650064
045940     GOBACK.                                                      04660064
045941                                                                  04670064
045942 1000-INITIALIZE.                                                 04680064
045943     OPEN INPUT STORE-REC-EXTRACT-FILE                            04690064
045944          OUTPUT RECEIPTS-TOTAL-FILE                              04700064
045945                 DAILY-RECEIPTS                                   04710064
045946                 SUMMARY-REPORT                                   04720064
045947     PERFORM 8000-READ-STORE-EXTRACT.                             04730064
045948                                                                  04740064
045949     IF PS-EOF-STOREEXT                                           04750064
045950         DISPLAY SPACES                                           04760064
045951         DISPLAY '****** NO INPUT RECORDS ******'                 04770064
045952         DISPLAY SPACES                                           04780064
045953         SET PS-NO-DETAIL             TO TRUE                     04790064
045954         INITIALIZE STORE-EXTRACT-LINE                            04800064
045955         PERFORM 1100-FIRST-HEADERS                               04810064
045956         WRITE DAILY-RECEIPTS-RPT FROM PR-PRINT-NO-DETAIL         04820064
045957               AFTER 2                                            04830064
045958         WRITE SUMMARY-RPT FROM PR-PRINT-NO-DETAIL                04840064
045959               AFTER 2                                            04850064
045960     ELSE                                                         04860064
045961         PERFORM 1100-FIRST-HEADERS                               04870064
045962     END-IF                                                       04880064
045963                                                                  04890064
045964     MOVE SPACES                      TO PV-DETAIL.               04900064
045965                                                                  04910064
045966 1100-FIRST-HEADERS.                                              04920064
045967                                                                  04930064
045968     INITIALIZE PT-LOCATIONS-TABLE.                               04940064
046000     ACCEPT PV-CURRENT-DATE FROM DATE                             04950064
046100     MOVE PV-CURR-MM                  TO PV-HDR3-RUN-DATE-MM      04960064
046200                                         PV-OUT1-MM               04970064
046300                                         PV-RPT2-MM               04980064
046400     MOVE PV-CURR-DD                  TO PV-HDR3-RUN-DATE-DD      04990064
046500                                         PV-OUT1-DD               05000064
046600                                         PV-RPT2-DD               05010064
046700     MOVE PV-CURR-YY                  TO PV-HDR3-RUN-DATE-YY      05020064
046800                                         PV-OUT1-YY               05030064
046900                                         PV-RPT2-YY               05040064
047000     ACCEPT PV-TIME             FROM TIME.                        05050064
047100     MOVE PV-TIME-HH                  TO PV-HDR3-RUN-TIME-HH      05060064
047200                                         PV-OUT1-HOURS            05070064
047300                                         PV-RPT2-HOURS            05080064
047400     MOVE PV-TIME-MM                  TO PV-HDR3-RUN-TIME-MM      05090064
047500                                         PV-OUT1-MINUTES          05100064
047600                                         PV-RPT2-MINUTES          05110064
047700     MOVE +1                          TO PV-RPT2-PAGE-NBR         05120064
047800                                                                  05130064
047900     MOVE SE-DATE-VERIFIED-COUNT      TO PV-DATE                  05140064
048000                                         PV-HOLD-VERIFIED-DATE    05150064
048100*    MOVE PV-MM                       TO PV-HDR6-MM               05160064
048200*    MOVE PV-DD                       TO PV-HDR6-DD               05170064
048300*    MOVE PV-YY                       TO PV-HDR6-YY               05180064
048400                                                                  05190064
048500     MOVE SE-CLASS                    TO PV-HOLD-CLASS            05200064
048600     MOVE SE-SKU-NBR                  TO PV-HOLD-SKU-NBR          05210066
048700     MOVE SE-REC-SRC-CDE              TO PV-HOLD-REC-SRC-CDE      05220064
048800     MOVE SE-REC-SEQ-NBR              TO PV-HOLD-SEQ-NBR          05230064
048900     MOVE SE-LOWEST-RETAIL            TO PV-HOLD-UNIT-RETAIL      05240064
048910******    WR # 27201 - START                                      05250082
049000*                                        PV-RTL-AMT               05260064
049010******    WR # 27201 - END                                        05270082
049100                                                                  05280064
049200     IF PS-EOF-STOREEXT                                           05290064
049300        NEXT SENTENCE                                             05300064
049400     ELSE                                                         05310064
049500         ADD +1                           TO PV-RCVR-CNT.         05320064
049600                                                                  05330064
049700     MOVE ZEROS                       TO PV-HOLD-UNIT-OPEN-TOTAL  05340064
049800                                        PV-HOLD-UNIT-MARKED-TOTAL 05350064
049900                                                                  05360064
050000     PERFORM 8100-SET-UP-HEADINGS                                 05370064
050100     PERFORM 8200-PRINT-HEADINGS.                                 05380064
050200                                                                  05390064
050300     WRITE SUMMARY-RPT FROM PV-RPT2-HEADER1 AFTER PAGE.           05400064
050400     WRITE SUMMARY-RPT FROM PV-RPT2-HEADER2 AFTER 2               05410064
050500     WRITE SUMMARY-RPT FROM PV-RPT2-HEADER3 AFTER 3               05420064
050600     WRITE SUMMARY-RPT FROM PV-RPT2-HEADER4 AFTER 1.              05430064
050700                                                                  05440064
050800 2000-PROCESS.                                                    05450064
050900                                                                  05460064
051000     IF SE-DATE-VERIFIED-COUNT = PV-HOLD-VERIFIED-DATE            05470064
051100        CONTINUE                                                  05480064
051200     ELSE                                                         05490064
051300        MOVE SE-DATE-VERIFIED-COUNT TO                            05500064
051400             PV-HOLD-VERIFIED-DATE                                05510064
051500        MOVE ZERO TO PV-PAGE-CNT                                  05520064
051600     END-IF.                                                      05530064
051700                                                                  05540064
051800     IF SE-REC-SEQ-NBR = PV-HOLD-SEQ-NBR                          05550064
051900             AND                                                  05560064
052000        SE-PO = PV-HDR9-PO-NO                                     05570064
052100         CONTINUE                                                 05580064
052200     ELSE                                                         05590064
052300         ADD +1                       TO PV-RCVR-CNT              05600064
052400     END-IF.                                                      05610064
052500                                                                  05620064
052600     IF SE-DIVISION-SEQNO             = PV-HDR2-DIVISION          05630064
052700             AND                                                  05640064
052800        SE-DEPT                       = PV-HOLD-DEPT              05650064
052900             AND                                                  05660064
053000        SE-REGION                     = PV-HDR6-REGION            05670064
053100             AND                                                  05680064
053200        SE-REC-SEQ-NBR                = PV-HOLD-SEQ-NBR           05690064
053300             AND                                                  05700064
053400        SE-PO                         = PV-HDR9-PO-NO             05710064
053500             AND                                                  05720064
053600        SE-REC-SRC-CDE                = PV-HOLD-REC-SRC-CDE       05730064
053700             CONTINUE                                             05740064
053800     ELSE                                                         05750064
053900         PERFORM 8300-PRT-DETAIL-LINE                             05760064
054000         PERFORM 8100-SET-UP-HEADINGS                             05770064
054100         PERFORM 8200-PRINT-HEADINGS                              05780064
054200     END-IF.                                                      05790064
054300                                                                  05800064
054400     IF SE-CLASS                      = PV-HOLD-CLASS             05810064
054500             AND                                                  05820064
054600        SE-SKU-NBR                    = PV-HOLD-SKU-NBR           05830066
054700             AND                                                  05840064
054800        SE-LOWEST-RETAIL              = PV-HOLD-UNIT-RETAIL       05850064
054900         CONTINUE                                                 05860064
055000     ELSE                                                         05870064
055100         PERFORM 8300-PRT-DETAIL-LINE                             05880064
055200     END-IF.                                                      05890064
055300                                                                  05900064
055400     IF SE-LOC-NBR NOT = PV-HOLD-STORE                            05910064
055500         IF PV-STORE-SUB NOT = ZERO                               05920064
055600             COMPUTE PV-STORE-OPEN-QTY (PV-STORE-SUB) =           05930064
055700               +  PV-STORE-ORDER-QTY (PV-STORE-SUB)               05940064
055800               -  PV-STORE-RECVD-QTY (PV-STORE-SUB)               05950064
055900               +  PV-STORE-MARKED-QTY (PV-STORE-SUB)              05960064
056000             ADD +1 TO PV-STORE-SUB                               05970064
056100             MOVE SE-LOC-NBR TO PV-HOLD-STORE,                    05980064
056200                              PV-LOC-NBR (PV-STORE-SUB)           05990064
056300             MOVE SE-RETAIL-UNITS-ORDER TO PV-STORE-ORDER-QTY     06000064
056400                                             (PV-STORE-SUB)       06010064
056500             MOVE SE-RETAIL-UNITS-RECVD TO PV-STORE-RECVD-QTY     06020064
056600                                             (PV-STORE-SUB)       06030064
056700         ELSE                                                     06040064
056800             ADD +1 TO PV-STORE-SUB                               06050064
056900             MOVE SE-LOC-NBR TO PV-HOLD-STORE,                    06060064
057000                              PV-LOC-NBR (PV-STORE-SUB)           06070064
057100             MOVE SE-RETAIL-UNITS-ORDER TO PV-STORE-ORDER-QTY     06080064
057200                                             (PV-STORE-SUB)       06090064
057300             MOVE SE-RETAIL-UNITS-RECVD TO PV-STORE-RECVD-QTY     06100064
057400                                             (PV-STORE-SUB)       06110064
057500         END-IF                                                   06120064
057600     END-IF.                                                      06130064
057700                                                                  06140064
057800     COMPUTE PV-STORE-MARKED-QTY (PV-STORE-SUB) =                 06150064
057900          PV-STORE-MARKED-QTY (PV-STORE-SUB)                      06160064
058000       +  SE-RETAIL-UNITS-MARK.                                   06170064
058100                                                                  06180064
058300     PERFORM 8000-READ-STORE-EXTRACT.                             06190064
058400/                                                                 06200064
063910*----------------------------------------------------------------*06210066
063920*                                               **   WR # 21361  *06220067
063930* REMOVED   PARA 7000-READ-TSK-TABLE.                            *06230066
063940* ADDED     PARA 7000-CALL-XLKUT-DOMAIN-PGM.                     *06240066
063950* ADDED     PARA 7001-READ-SKU-STR-VIEW.                         *06250066
063960* CODE FOR ACCESSING LOGISTICS DOMAIN ITEM ACCESS MODULE.        *06260066
063970* ADDED CODE TO GET THE DATA FROM VIEWS.                         *06270066
063980*----------------------------------------------------------------*06280066
063990                                                                  06290066
063991******    WR # 27201 - START - COMMENTED 7000- AND 7001- PARAS    06300082
063992*7000-CALL-XLKUT-DOMAIN-PGM.                                      06310066
063993                                                                  06320066
063994*    INITIALIZE XL001-ITEM-COMMAREA                               06330066
063995*               PV-SKU-RETAIL.                                    06340066
063996                                                                  06350066
063997*    MOVE 'N' TO PS-DISCREPANCY-SW.                               06360066
063998*    MOVE PV-HOLD-SKU-NBR         TO PV-TEMP-KEY-SKU.             06370069
063999*    MOVE PV-TEMP-KEY-SKU         TO XL001-KEY-SKU.               06380066
064000                                                                  06390066
064001*    SET  XL001-BY-NUMERIC-SKU                                    06400066
064002*         XL001-SELECT-SKU                                        06410066
064003*         XL001-SELECT-SKU-STR    TO TRUE.                        06420066
064004                                                                  06430066
064005*    CALL XL001-VSM-PGM USING  XL001-ITEM-COMMAREA.               06440066
064006                                                                  06450066
064007*    EVALUATE TRUE                                                06460066
064008                                                                  06470066
064009*     WHEN XL001-SKU-SQLCODE = +0                                 06480066
064010*       PERFORM 7001-READ-SKU-STR-VIEW                            06490066
064011                                                                  06500066
064012*     WHEN XL001-SKU-SQLCODE = +100                               06510066
064013*       CONTINUE                                                  06520066
064014                                                                  06530066
064015*     WHEN XL001-SKU-CONTENTION                                   06540066
064016*       MOVE '7010-SELECT-SKU-BY-SKU'                             06550066
064017*                            TO PV-PARAGRAPH-NAME                 06560066
064018*       MOVE 'SKU CONTENTION'                                     06570066
064019*                            TO PV-DB2-OPERATION-ATTEMPTED        06580066
064020*       MOVE XL001-SKU-SQLCODE TO SQLCODE                         06590066
064021*       PERFORM 9800-SQL-ABEND                                    06600066
064022                                                                  06610066
064023*     WHEN OTHER                                                  06620066
064024*       MOVE '7010-SELECT-SKU-BY-SKU'                             06630066
064025*                            TO PV-PARAGRAPH-NAME                 06640066
064026*       MOVE 'INVALID RETURN'                                     06650066
064027*                            TO PV-DB2-OPERATION-ATTEMPTED        06660066
064028*       MOVE XL001-SKU-SQLCODE TO SQLCODE                         06670066
064029*       PERFORM 9800-SQL-ABEND                                    06680066
064030*    END-EVALUATE.                                                06690066
064031                                                                  06700066
064032*7001-READ-SKU-STR-VIEW.                                          06710066
064033                                                                  06720066
064034*    EVALUATE TRUE                                                06730066
064035                                                                  06740066
064036*     WHEN XL001-SKU-STR-SQLCODE = +0                             06750066
064037*       MOVE XL001-GP-QTY          TO PV-TEMP-GP-QTY              06760066
064038*       MOVE XL001-GP-AMT          TO PV-TEMP-UNT-RTL-AMT         06770070
064039*            IF  PV-TEMP-GP-QTY = 0                               06780068
064040*                MOVE ZEROES TO PV-SKU-RTL-AMT                    06790069
064041*            ELSE                                                 06800070
064042*                COMPUTE PV-SKU-RTL-AMT =                         06810066
064043*                        PV-TEMP-UNT-RTL-AMT / PV-TEMP-GP-QTY     06820066
064044*            END-IF                                               06830068
064045*            IF PV-SKU-RTL-AMT = PV-RTL-AMT                       06840068
064046*                CONTINUE                                         06850068
064047*            ELSE                                                 06860068
064048*                SET PS-DISCREPANCY-FOUND TO TRUE                 06870068
064049*                MOVE PV-SKU-RTL-AMT TO PV-SKU-RETAIL             06880068
064050*            END-IF                                               06890068
064051                                                                  06900066
064052*     WHEN XL001-SKU-STR-SQLCODE = +100                           06910066
064053*       INITIALIZE PV-TEMP-GP-QTY                                 06920066
064054*                  PV-TEMP-UNT-RTL-AMT                            06930066
064055                                                                  06940066
064056*     WHEN XL001-SKU-STR-CONTENTION                               06950066
064057*       MOVE '7010-SELECT-SKU-BY-SKU'                             06960066
064058*                            TO PV-PARAGRAPH-NAME                 06970066
064059*       MOVE 'SKU STR CONTENTION'                                 06980066
064060*                            TO PV-DB2-OPERATION-ATTEMPTED        06990066
064061*       MOVE XL001-SKU-SQLCODE TO SQLCODE                         07000066
064062*       PERFORM 9800-SQL-ABEND                                    07010066
064063                                                                  07020066
064064*     WHEN OTHER                                                  07030066
064065*       MOVE '7010-SELECT-SKU-BY-SKU'                             07040066
064066*                            TO PV-PARAGRAPH-NAME                 07050066
064067*       MOVE 'INVALID RETURN'                                     07060066
064068*                            TO PV-DB2-OPERATION-ATTEMPTED        07070066
064069*       MOVE XL001-SKU-SQLCODE TO SQLCODE                         07080066
064070*       PERFORM 9800-SQL-ABEND                                    07090066
064071*    END-EVALUATE.                                                07100066
064072/                                                                 07110066
064073******    WR # 27201 - END                                        07120082
064074*----------------------------------------------------------------*07130066
064075* CHANGES MADE FOR WR # 21361 ENDS HERE.                         *07140067
064076*----------------------------------------------------------------*07150066
064080 7100-READ-TROUBLE-TABLE.                                         07160064
064100     INITIALIZE DCLTTRBNTF.                                       07170064
064200                                                                  07180064
064300     EXEC SQL                                                     07190064
064400         SELECT NOTIF_TMST                                        07200064
064500         INTO :TRBNTF-NOTIF-TMST                                  07210064
064600         FROM TTRBNTF                                             07220064
064700         WHERE NOTIF_NBR = :PV-NOTIF-NBR                          07230064
064800     END-EXEC                                                     07240064
064900                                                                  07250064
065000     EVALUATE TRUE                                                07260064
065100         WHEN SQLCODE = ZEROS                                     07270064
065200             MOVE TRBNTF-NOTIF-TMST TO PV-HOLD-TIMESTAMP          07280064
065300             MOVE PV-HOLD-TMST-YYYY TO PV-HDR9-YYYY               07290064
065400             MOVE PV-HOLD-TMST-MM   TO PV-HDR9-MM                 07300064
065500             MOVE PV-HOLD-TMST-DD   TO PV-HDR9-DD                 07310064
065600         WHEN SQLCODE = +100                                      07320064
065700             MOVE '0001' TO PV-HDR9-YYYY                          07330064
065800             MOVE '01'   TO PV-HDR9-MM                            07340064
065900             MOVE '01'   TO PV-HDR9-DD                            07350064
066000         WHEN OTHER                                               07360064
066100             MOVE '7100-READ-TROUBLE-TABLE'                       07370064
066200                 TO PV-PARAGRAPH-NAME                             07380064
066300             MOVE 'SELECT THE TROUBLE TABLE'                      07390064
066400                 TO PV-DB2-OPERATION-ATTEMPTED                    07400064
066500             PERFORM 9800-SQL-ABEND                               07410064
066600     END-EVALUATE.                                                07420064
066610                                                                  07430082
066700 7200-GET-LOC-NAME.                                               07440064
070306                                                                  07450033
070307     INITIALIZE XL071-COMMAREA-REC.                               07460033
070308     MOVE SE-OPER-UNT-ID       TO XL071-LOCATION-NUMBER           07470082
070309                                                                  07480033
070310     CALL XL071-LOCATION-MODULE USING XL071-COMMAREA-REC.         07490082
070315                                                                  07500033
070316     EVALUATE TRUE                                                07510082
070317     WHEN XL071-NO-ERRORS                                         07520082
070319     WHEN XL071-LOC-NOT-FOUND                                     07530033
070320     WHEN XL071-DC-ASGMT-NOT-FND                                  07540082
070350         CONTINUE                                                 07550004
070351     WHEN XL071-BAD-DB2-RETURN                                    07560082
070352         MOVE XL071-SQLCA             TO SQLCA                    07570033
070353         MOVE '7200-GET-LOC-NAME'     TO PV-PARAGRAPH-NAME        07580064
070354         MOVE 'CALL XLKUT071 LOCATION MODULE'                     07590064
070355                                     TO PV-DB2-OPERATION-ATTEMPTED07600064
070356         PERFORM 9800-SQL-ABEND                                   07610064
070357     END-EVALUATE.                                                07620033
070358/                                                                 07630064
070359 8000-READ-STORE-EXTRACT.                                         07640064
070360     READ STORE-REC-EXTRACT-FILE                                  07650064
070361         INTO STORE-EXTRACT-LINE                                  07660064
070362     AT END                                                       07670064
070363         SET PS-EOF-STOREEXT          TO TRUE                     07680064
070364     NOT AT END                                                   07690064
070365         ADD +1                       TO PV-STOREEXT-COUNT        07700064
070366         ADD SE-COST-EXTENSION        TO PV-COST-TOT              07710064
070367         ADD SE-RETAIL-EXTENSION      TO PV-RETAIL-TOT            07720064
070368     END-READ.                                                    07730064
070369/                                                                 07740064
070370 8100-SET-UP-HEADINGS.                                            07750064
070371     MOVE SE-DIVISION-SEQNO           TO PV-HDR2-DIVISION.        07760064
070372     MOVE SE-DEPT                     TO PV-HOLD-DEPT             07770064
070373                                         PV-HDR4-DEPARTMENT.      07780064
070400     MOVE SE-REGION                   TO PV-HDR6-REGION.          07790064
070500     MOVE SE-PO                       TO PV-HDR9-PO-NO.           07800064
070600     MOVE SE-REC-SEQ-NBR              TO PV-WORK-RECSEQ-NBR       07810064
070700                                         PV-HOLD-SEQ-NBR.         07820064
070800     MOVE PV-WORK-REC-SEQ-NBR         TO PV-HDR9-RECSEQ-NBR.      07830064
070900     MOVE SE-VENDOR-NO-INHOUSE        TO PV-HDR9-VENDOR-NO.       07840064
071000     MOVE SE-VENDOR-NAME-INHOUSE      TO PV-HDR9-VENDOR-NAME.     07850064
071100                                                                  07860064
071200     EVALUATE SE-RECEIVING-LOCATION                               07870064
071300     WHEN 'DS'                                                    07880064
071400         MOVE 'DIRECT SHIP'           TO PV-HDR9-REC-LOC          07890064
071500     WHEN 'DC'                                                    07900064
071600         SET LOC-IDX TO 1                                         07910064
071700         SEARCH PT-LOCATIONS                                      07920064
071800         AT END                                                   07930064
071900             DISPLAY SPACES                                       07940064
072000             DISPLAY 'LOCATION TABLE OVERFLOW'                    07950064
072100             DISPLAY 'PARAGRAPH 8100-SET-UP-HEADINGS'             07960064
072200             DISPLAY SPACES                                       07970064
072300             CLOSE STORE-REC-EXTRACT-FILE                         07980064
072400                   RECEIPTS-TOTAL-FILE                            07990064
072500                   DAILY-RECEIPTS                                 08000064
072600                   SUMMARY-REPORT                                 08010064
072700             MOVE +4004 TO ABEND-CODE                             08020070
072800             CALL 'ILBOABN0' USING ABEND-CODE                     08030064
072900         WHEN PT-OPER-UNT-ID(LOC-IDX) = ZERO                      08040064
073000             MOVE SE-OPER-UNT-ID TO PT-OPER-UNT-ID(LOC-IDX)       08050064
073200             MOVE SE-FCLTY-ID    TO PT-FCLTY-ID(LOC-IDX)          08060064
073300                                                                  08070064
073400             PERFORM 7200-GET-LOC-NAME                            08080064
073500             IF XL071-NO-ERRORS                                   08090082
073600                 MOVE XL071-LOC-NM                                08100064
073700                                 TO PT-LOCATION(LOC-IDX)          08110064
073800                                    PV-HDR9-REC-LOC               08120064
073900             ELSE                                                 08130064
074000                 MOVE 'UNKNOWN'  TO PT-LOCATION(LOC-IDX)          08140064
074100                                    PV-HDR9-REC-LOC               08150064
074200             END-IF                                               08160064
074210                                                                  08170082
074300         WHEN PT-OPER-UNT-ID(LOC-IDX) = SE-OPER-UNT-ID            08180064
074400          AND PT-FCLTY-ID(LOC-IDX)    = SE-FCLTY-ID               08190064
074500             MOVE PT-LOCATION(LOC-IDX)                            08200064
074600                                      TO PV-HDR9-REC-LOC          08210064
074700         END-SEARCH                                               08220064
074800     END-EVALUATE.                                                08230064
074900                                                                  08240064
075000     MOVE SE-REC-SRC-CDE              TO PV-HOLD-REC-SRC-CDE.     08250064
075100/                                                                 08260064
075200 8200-PRINT-HEADINGS.                                             08270064
075300     WRITE DAILY-RECEIPTS-RPT FROM PV-HEADER1 AFTER PAGE.         08280064
075400     ADD +1 TO PV-PAGE-CNT.                                       08290064
075500     MOVE PV-PAGE-CNT TO PV-HDR2-PAGE.                            08300064
075600     WRITE DAILY-RECEIPTS-RPT FROM PV-HEADER2 AFTER 1.            08310064
075700     WRITE DAILY-RECEIPTS-RPT FROM PV-HEADER3 AFTER 1.            08320064
075800     WRITE DAILY-RECEIPTS-RPT FROM PV-HEADER4 AFTER 1.            08330064
075900     WRITE DAILY-RECEIPTS-RPT FROM PV-HEADER5 AFTER 1.            08340064
076000                                                                  08350064
076100     MOVE PV-HOLD-VD-MM               TO PV-HDR6-MM.              08360064
076200     MOVE PV-HOLD-VD-DD               TO PV-HDR6-DD.              08370064
076300     MOVE PV-HOLD-VD-YY               TO PV-HDR6-YY.              08380064
076400                                                                  08390064
076500     WRITE DAILY-RECEIPTS-RPT FROM PV-HEADER6 AFTER 1.            08400064
076600     WRITE DAILY-RECEIPTS-RPT FROM PV-HEADER7 AFTER 2.            08410064
076700     WRITE DAILY-RECEIPTS-RPT FROM PV-HEADER8 AFTER 1.            08420064
076800     WRITE DAILY-RECEIPTS-RPT FROM PV-HEADER9 AFTER 2.            08430064
076900     IF SE-ADJUSTMENT                                             08440064
077000         MOVE SE-NOTIF-NBR TO PV-NOTIF-NBR                        08450064
077100         PERFORM 7100-READ-TROUBLE-TABLE                          08460064
077200         WRITE DAILY-RECEIPTS-RPT FROM PV-HEADER9-ADJ             08470064
077300             AFTER 1                                              08480064
077400         MOVE +11 TO PV-LINE-CNT                                  08490064
077500     ELSE                                                         08500064
077600         MOVE +10 TO PV-LINE-CNT                                  08510064
077700     END-IF.                                                      08520064
077800/                                                                 08530064
077900 8300-PRT-DETAIL-LINE.                                            08540064
077910* ADDED & REMOVED SOME MOVE STATEMENTS                WR # 21361 *08550067
077920     COMPUTE PV-STORE-OPEN-QTY (PV-STORE-SUB) =                   08560066
077930       +  PV-STORE-ORDER-QTY (PV-STORE-SUB)                       08570066
077940       -  PV-STORE-RECVD-QTY (PV-STORE-SUB)                       08580066
077950       +  PV-STORE-MARKED-QTY (PV-STORE-SUB).                     08590066
077960     MOVE PV-HOLD-CLASS               TO PV-DTL-CLASS.            08600066
077970     MOVE PV-HOLD-SKU-NBR             TO PV-DTL-SKU-NBR.          08610066
077980     MOVE PV-HOLD-UNIT-RETAIL         TO PV-DTL-UNIT-RETAIL.      08620066
077990     MOVE 2                           TO PV-CC.                   08630066
077991     MOVE +1                          TO SUB, SUB1.               08640066
079500                                                                  08650064
079600     PERFORM 8310-MOVE-STORE-TABLE UNTIL SUB > PV-STORE-SUB.      08660064
079700                                                                  08670064
079800     IF  SUB1 = 1                                                 08680064
079900         NEXT SENTENCE                                            08690064
080000     ELSE                                                         08700064
080100         WRITE DAILY-RECEIPTS-RPT FROM PV-DETAIL AFTER PV-CC      08710064
080200         ADD PV-CC                        TO PV-LINE-CNT          08720064
080300         MOVE 1                           TO PV-CC                08730064
080400         MOVE SPACES                      TO PV-DETAIL            08740064
080500     END-IF.                                                      08750064
080600                                                                  08760064
080700     PERFORM 8400-PRINT-TOTAL-UNITS.                              08770064
080800                                                                  08780064
080900     MOVE ZERO                        TO PV-STORE-SUB             08790064
081000                                         PV-HOLD-UNIT-OPEN-TOTAL  08800064
081100                                       PV-HOLD-UNIT-MARKED-TOTAL. 08810064
081200     MOVE SE-CLASS                    TO PV-HOLD-CLASS.           08820064
081300     MOVE SE-SKU-NBR                  TO PV-HOLD-SKU-NBR.         08830066
081400     MOVE SE-LOWEST-RETAIL            TO PV-HOLD-UNIT-RETAIL.     08840064
081410******    WR # 27201 - START                                      08850082
081500*                                        PV-RTL-AMT.              08860064
081510******    WR # 27201 - END                                        08870082
081600     MOVE ZEROS                       TO PV-STORE-TOTALS-TABLE.   08880064
081700     MOVE 100                         TO PV-HOLD-STORE.           08890064
081800                                                                  08900064
081900 8310-MOVE-STORE-TABLE.                                           08910064
082000     MOVE PV-LOC-NBR (SUB)            TO PV-DTL-LOC-NBR (SUB1).   08920064
082100     IF  PV-HOLD-REC-SRC-CDE = 'A'                                08930064
082200         MOVE ZERO                    TO PV-ADJ-FORMAT-OPEN       08940064
082300         MOVE PV-ADJ-OPEN-FORMAT      TO                          08950064
082400              PV-DTL-RETAIL-OPEN (SUB1)                           08960064
082500     ELSE                                                         08970064
082600         MOVE PV-STORE-OPEN-QTY (SUB) TO                          08980064
082700              PV-DTL-FORMAT-OPEN                                  08990064
082800         MOVE PV-OPEN-FORMAT          TO                          09000064
082900              PV-DTL-RETAIL-OPEN (SUB1)                           09010064
083000     END-IF.                                                      09020064
083100                                                                  09030064
083200     MOVE PV-STORE-MARKED-QTY (SUB)   TO                          09040064
083300         PV-DTL-RETAIL-MARKED (SUB1).                             09050064
083400     ADD PV-STORE-OPEN-QTY (SUB)      TO                          09060064
083500         PV-HOLD-UNIT-OPEN-TOTAL.                                 09070064
083600     ADD PV-STORE-MARKED-QTY (SUB)    TO                          09080064
083700                                        PV-HOLD-UNIT-MARKED-TOTAL 09090064
083800                                        PV-QTY-MARKED-TOT         09100064
083900                                                                  09110064
084000     IF PV-LINE-CNT > 55                                          09120064
084100         PERFORM 8200-PRINT-HEADINGS                              09130064
084200     END-IF.                                                      09140064
084300                                                                  09150064
084400     IF SUB1 = 4                                                  09160064
084500         WRITE DAILY-RECEIPTS-RPT FROM PV-DETAIL AFTER PV-CC      09170064
084600         ADD PV-CC                    TO PV-LINE-CNT              09180064
084700         MOVE 1                       TO PV-CC                    09190064
084800         MOVE +0                      TO SUB1                     09200064
084900         MOVE SPACES                  TO PV-DETAIL                09210064
085000     END-IF.                                                      09220064
085100                                                                  09230064
085200     ADD +1 TO SUB, SUB1.                                         09240064
085300/                                                                 09250064
085400 8400-PRINT-TOTAL-UNITS.                                          09260064
085500     IF PV-STORE-SUB NOT = +1                                     09270064
085600         IF  PV-HOLD-REC-SRC-CDE = 'A'                            09280064
085700             MOVE 'TOTAL ADJUST :'    TO PV-HDR10-FILLER          09290064
085800             MOVE PV-HOLD-UNIT-MARKED-TOTAL                       09300064
085900                                      TO PV-HDR10-TOTAL           09310064
086000             WRITE DAILY-RECEIPTS-RPT FROM PV-HEADER10            09320064
086100         ELSE                                                     09330064
086200             MOVE '  TOTAL OPEN :'    TO PV-HDR10-FILLER          09340064
086300             MOVE PV-HOLD-UNIT-OPEN-TOTAL                         09350064
086400                                      TO PV-HDR10-TOTAL           09360064
086500             WRITE DAILY-RECEIPTS-RPT FROM PV-HEADER10            09370064
086600             MOVE 'TOTAL MARKED :'    TO PV-HDR10-FILLER          09380064
086700             MOVE PV-HOLD-UNIT-MARKED-TOTAL                       09390064
086800                                      TO PV-HDR10-TOTAL           09400064
086900             WRITE DAILY-RECEIPTS-RPT FROM PV-HEADER10            09410064
087000         END-IF                                                   09420064
087100                                                                  09430064
087200         MOVE SPACES TO DAILY-RECEIPTS-RPT                        09440064
087300         WRITE DAILY-RECEIPTS-RPT AFTER 2                         09450064
087400         ADD 4                        TO PV-LINE-CNT              09460064
087500     END-IF.                                                      09470064
087600                                                                  09480064
087610******    WR # 27201 - START - COMMENTED FOLLOWING CODE           09490082
087700*    PERFORM 7000-CALL-XLKUT-DOMAIN-PGM                           09500066
087800                                                                  09510064
087900*    IF PS-DISCREPANCY-FOUND                                      09520064
088000*        WRITE DAILY-RECEIPTS-RPT FROM PV-RETAIL-DISCREP          09530064
088100*                         AFTER 2                                 09540064
088200*        MOVE SPACES                  TO DAILY-RECEIPTS-RPT       09550064
088300*        WRITE DAILY-RECEIPTS-RPT AFTER 2                         09560064
088400*        ADD 4                        TO PV-LINE-CNT              09570064
088500*    END-IF.                                                      09580064
088510******    WR # 27201 - END                                        09590082
088600/                                                                 09600064
088700 9000-EOJ.                                                        09610064
088800     DISPLAY 'STORE EXTRACTS READ = ' PV-STOREEXT-COUNT           09620064
088900     DISPLAY SPACES.                                              09630064
089000                                                                  09640064
089100*    ADD +1                           TO PV-RCVR-CNT              09650064
089200*    ADD SE-COST-EXTENSION            TO PV-COST-TOT              09660064
089300*    ADD SE-RETAIL-EXTENSION          TO PV-RETAIL-TOT            09670064
089400                                                                  09680064
089500     IF PS-NO-DETAIL                                              09690064
089600         WRITE DAILY-RECEIPTS-RPT FROM PR-PRINT-FINAL             09700064
089700                          AFTER 2                                 09710064
089800     ELSE                                                         09720064
089900         PERFORM 8300-PRT-DETAIL-LINE                             09730064
090000         WRITE DAILY-RECEIPTS-RPT FROM PR-PRINT-FINAL             09740064
090100                          AFTER 2                                 09750064
090200     END-IF                                                       09760064
090300                                                                  09770064
090400     MOVE PV-RCVR-CNT                 TO PV-RPT2-RCVR-TOT         09780064
090500                                         PV-OUT1-RCVR-TOT         09790064
090600     MOVE PV-QTY-MARKED-TOT           TO PV-RPT2-MARKED-TOT       09800064
090700                                         PV-OUT1-MARKED-TOT       09810064
090800     MOVE PV-COST-TOT                 TO PV-RPT2-COST-TOT         09820064
090900                                         PV-OUT1-COST-TOT         09830064
091000     MOVE PV-RETAIL-TOT               TO PV-RPT2-RET-TOT          09840064
091100                                         PV-OUT1-RET-TOT          09850064
091200                                                                  09860064
091300     WRITE SUMMARY-RPT FROM PV-RPT2-DETAIL AFTER 2                09870064
091400     WRITE SUMMARY-RPT FROM PR-PRINT-FINAL AFTER 2                09880064
091500                                                                  09890064
091600     WRITE RECEIPTS-TOTAL-REC FROM PV-OUT1-DETAIL                 09900064
091700                                                                  09910064
091800     CLOSE STORE-REC-EXTRACT-FILE                                 09920064
091900           RECEIPTS-TOTAL-FILE                                    09930064
092000           DAILY-RECEIPTS                                         09940064
092100           SUMMARY-REPORT.                                        09950064
092200                                                                  09960064
092300 9800-SQL-ABEND.                                                  09970064
092400     DISPLAY '** ABEND     **'.                                   09980064
092500     DISPLAY '** PROGRAM   ** = RCKRP017'.                        09990064
092600     DISPLAY '** PARAGRAPH ** = ' PV-PARAGRAPH-NAME.              10000064
092700     DISPLAY '** OPERATION ** = ' PV-DB2-OPERATION-ATTEMPTED.     10010064
092800                                                                  10020064
092900******************************************************************10030064
093000* THIS COPY BOOK MEMBER CONTAINS THE PROCEDURE DIVISION STATE-    10040064
093100* MENTS THAT ARE REQUIRED TO UTILIZE THE DB2 ABEND MODULE         10050064
093200* 'DSNTIAR' AND CONVERT THE SQLCA INFORMATION INTO A READABLE     10060064
093300* FORMAT.                                                         10070064
093400******************************************************************10080064
093500     COPY DPPD004.                                                10090070
093600                                                                  10100064
093700     MOVE +4013 TO ABEND-CODE.                                    10110064
093800     CALL 'ILBOABN0' USING ABEND-CODE.                            10120064
093900                                                                  10130064
