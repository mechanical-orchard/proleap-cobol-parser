000100***************************************************************** 00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300***************************************************************** 00030000
000400 PROGRAM-ID.    XLKUT008.                                         00040000
000500 AUTHOR.        STEPHANIE HERON.                                  00050000
000600 INSTALLATION.  KOHLS.                                            00060000
000700 DATE-WRITTEN   SEPTEMBER 2002.                                   00070000
000800 DATE-COMPILED.                                                   00080000
000900***************************************************************** 00090000
001000*  THIS PROGRAM WILL REFORMAT THE VSM SKU EXTRACT (IMRD053)     * 00100000
001100*  INTO LOGISTICS DOMAIN SKU LAYOUT (XLRD008)                   * 00110000
001400***************************************************************** 00140000
001500***************************************************************** 00150000
001600* CHANGE DESCRIPTION                                              00160000
001700***************************************************************** 00170000
001800* DATE  05/19/2010                                                00180000
001900*  CHANGE MADE: CHANGED TO INCLUDE THE NEW WAREHOUSE INDICATOR    00190000
002000*  FIELD(XL008-WHSE-RPLNT-IND)IN THE REFORMATTING.                00200000
002100*  MADE BY: TOYAM SAIKH     TKID:TKMAX89                          00210000
002200*  CHANGES ARE TAGGED AS TS 05/19/2010                            00220000
002201***************************************************************** 00220100
002202 ENVIRONMENT DIVISION.                                            00220200
002203 INPUT-OUTPUT SECTION.                                            00220300
002204                                                                  00220400
002205 FILE-CONTROL.                                                    00220500
002206                                                                  00220600
002207     SELECT VSM-SKU-FILE                                          00220700
002208         ASSIGN TO INP01.                                         00220800
002209                                                                  00220900
002210     SELECT LOGISTIC-SKU-FILE                                     00221000
002211         ASSIGN TO OUT01.                                         00221100
002212                                                                  00221200
002213***************************************************************** 00221300
002300 DATA DIVISION.                                                   00230000
002400***************************************************************** 00240000
002500 FILE SECTION.                                                    00250000
002600                                                                  00260000
002700 FD  VSM-SKU-FILE                                                 00270000
002800     RECORDING MODE IS F                                          00280000
002810     BLOCK CONTAINS 0 RECORDS                                     00281000
002900     LABEL RECORDS ARE STANDARD.                                  00290000
003000                                                                  00300000
003300 01  VSM-SKU-RECORD               PIC X(500).                     00330000
003700                                                                  00370000
003701 FD  LOGISTIC-SKU-FILE                                            00370100
003702     RECORDING MODE IS F                                          00370200
003703     BLOCK CONTAINS 0 RECORDS                                     00370300
003704     LABEL RECORDS ARE STANDARD.                                  00370400
003705                                                                  00370500
003706 01  LOGISTIC-SKU-RECORD          PIC X(150).                     00370600
003707                                                                  00370700
003800                                                                  00380000
003900***************************************************************** 00390000
004000 WORKING-STORAGE SECTION.                                         00400000
004100                                                                  00410000
004200 01  PS-PROGRAM-SWITCHES.                                         00420000
004300     05  PS-EOF-INPUT-SW              PIC X(01)  VALUE 'N'.       00430000
004400         88  PS-EOF-INPUT-YES                    VALUE 'Y'.       00440000
004500         88  PS-EOF-INPUT-NO                     VALUE 'N'.       00450000
004600                                                                  00460000
004700 01  PC-PROGRAM-CONSTANTS.                                        00470000
004800     05  PC-PROGRAM-NAME              PIC  X(08) VALUE 'XLKUT008'.00480000
005000                                                                  00500000
005100 01  PV-PROGRAM-VARIABLES.                                        00510000
005900     05  PV-RECORDS-READ              PIC  9(09) VALUE  0.        00590000
006000     05  PV-RECORDS-WRITTEN           PIC  9(09) VALUE  0.        00600000
006700     05  PV-SQLCODE                   PIC  S9(9) VALUE +0.        00670000
006800     05  PV-DISP-SQLCODE              PIC ZZZZZZ9-.               00680000
006900                                                                  00690000
007000                                                                  00700000
007100 01  PV-ABEND-FIELDS.                                             00710000
007200     05  PV-ABEND-CODE                PIC  S9(4) VALUE +0         00720000
007300                                                 COMP SYNC.       00730000
007400     05  PV-ABEND-PROGRAM             PIC  X(08) VALUE 'XLKUT008'.00740000
007500     05  PV-ABEND-PARAGRAPH           PIC  X(50) VALUE SPACES.    00750000
007600     05  PV-ABEND-OPERATION           PIC  X(50) VALUE SPACES.    00760000
007700     05  PV-ABEND-TABLE               PIC  X(12) VALUE SPACES.    00770000
007900     05  PV-DB2-OPERATION-MESSAGE-1   PIC  X(79) VALUE SPACES.    00790000
008000     05  PV-DB2-OPERATION-MESSAGE-2   PIC  X(79) VALUE SPACES.    00800000
008100     05  PV-DB2-OPERATION-MESSAGE-3   PIC  X(79) VALUE SPACES.    00810000
008200                                                                  00820000
008300                                                                  00830000
008400***********************************************************       00840000
008500*  COPYBOOK USED FOR THE VSM SKU INPUT FILE               *       00850000
008600***********************************************************       00860000
008700     COPY IMRD053.                                                00870000
008800                                                                  00880000
008801***********************************************************       00880100
008802*  COPYBOOK USED FOR THE LOGISTIC SKU OUTPUT FILE         *       00880200
008803***********************************************************       00880300
008804 01  PC-LOGISTIC-SKU-OUTPUT.                                      00880400
008805     COPY XLRD008.                                                00880500
008806                                                                  00880600
010800***************************************************************** 01080000
010900 PROCEDURE DIVISION.                                              01090000
011000***************************************************************** 01100000
011100     DISPLAY '**** BEGINNING XLKUT008 ****'.                      01110000
011200     DISPLAY ' '.                                                 01120000
011300                                                                  01130000
011400     OPEN INPUT  VSM-SKU-FILE                                     01140000
011410          OUTPUT LOGISTIC-SKU-FILE.                               01141000
011500                                                                  01150000
011600     PERFORM 1000-READ-INPUT-FILE.                                01160000
011700                                                                  01170000
012100     PERFORM 2000-PROCESS-INPUT-FILE                              01210000
012200       UNTIL PS-EOF-INPUT-YES.                                    01220000
012300                                                                  01230000
012400     CLOSE VSM-SKU-FILE                                           01240000
012410           LOGISTIC-SKU-FILE.                                     01241000
012500                                                                  01250000
012600     DISPLAY '   INPUT VSM SKU RECS    = ' PV-RECORDS-READ.       01260000
012700     DISPLAY '  OUTPUT VSM SKU RECS    = ' PV-RECORDS-WRITTEN.    01270000
012800     DISPLAY ' '.                                                 01280000
012900     DISPLAY '****  END OF  XLKUT008  ****'.                      01290000
013000                                                                  01300000
013100     GOBACK.                                                      01310000
013200                                                                  01320000
013300                                                                  01330000
013400***************************************************************** 01340000
013500*  READ A VSM SKU RECORD                                          01350000
013600***************************************************************** 01360000
013700 1000-READ-INPUT-FILE.                                            01370000
013800                                                                  01380000
013900     MOVE '1000-READ-INPUT-FILE    ' TO PV-ABEND-PARAGRAPH.       01390000
014000                                                                  01400000
014010     INITIALIZE IM053-ITEM-SKU-DOMAIN-REC.                        01401000
014020                                                                  01402000
014100     READ VSM-SKU-FILE                                            01410000
014200          INTO IM053-ITEM-SKU-DOMAIN-REC                          01420000
014300            AT END                                                01430000
014400               SET PS-EOF-INPUT-YES TO TRUE                       01440000
014900     END-READ.                                                    01490000
015000                                                                  01500000
015100     IF PS-EOF-INPUT-YES                                          01510000
015200        CONTINUE                                                  01520000
015300     ELSE                                                         01530000
015400        ADD +1 TO PV-RECORDS-READ                                 01540000
015401     END-IF.                                                      01540100
015402                                                                  01540200
015403***************************************************************** 01540300
015404*  REFORMAT THE VSM SKU EXTRACT FILE                            * 01540400
015405***************************************************************** 01540500
015500 2000-PROCESS-INPUT-FILE.                                         01550000
015600                                                                  01560000
015700     MOVE '2000-PROCESS-INPUT-FILE ' TO PV-ABEND-PARAGRAPH.       01570000
015800                                                                  01580000
015900     MOVE IM053-INTR-UPC-ID         TO XL008-INTR-UPC-ID.         01590000
016000     MOVE IM053-RMS-STYL-ID         TO XL008-STYL-ID.             01600000
016100     MOVE IM053-ITM-NBR             TO XL008-ITM-NBR.             01610000
016200     MOVE IM053-SKU                 TO XL008-SKU-NBR.             01620000
016300     MOVE IM053-SKU-STAT-CDE        TO XL008-SKU-STAT-CDE.        01630000
016400     MOVE IM053-SKU-STAT-DESC       TO XL008-SKU-STAT-DESC.       01640000
016500     MOVE IM053-INNR-PK-QTY         TO XL008-INNR-PK-QTY.         01650000
016600     MOVE IM053-OUTR-PK-QTY         TO XL008-OUTR-PK-QTY.         01660000
016700     MOVE IM053-INTR-UPC-DESC       TO XL008-SKU-DESC.            01670000
016800     MOVE IM053-KOHLS-SIZE-CDE      TO XL008-KOHLS-SIZE-CDE.      01680000
016900     MOVE IM053-KOHLS-SIZE-DESC     TO XL008-SIZE-DESC.           01690000
017000     MOVE IM053-NRF-CLOR-CDE        TO XL008-NRF-CLOR-CDE.        01700000
017100     MOVE IM053-SHRT-CLOR-DESC      TO XL008-SHRT-CLOR-DESC.      01710000
017200     MOVE IM053-CSTM-CLOR-DESC      TO XL008-CSTM-CLOR-DESC.      01720000
017300     MOVE IM053-REGN-PRIC-IND       TO XL008-REGN-PRIC-IND.       01730000
017400     MOVE IM053-KY-ITM-IND          TO XL008-KY-ITM-IND.          01740000
017401     MOVE IM053-GP-CDE              TO XL008-GP-CDE.              01740100
017402                                                                  01740200
017403*TS 05/19/2010 BEG                                                01740300
017407     MOVE IM053-WHSE-RPLNT-IND      TO XL008-WHSE-RPLNT-IND.      01740702
017411*TS 05/19/2010 END                                                01741102
017420     PERFORM 2100-WRITE-OUTPUT.                                   01742002
017700                                                                  01770000
017800     PERFORM 1000-READ-INPUT-FILE.                                01780000
018500                                                                  01850000
018600                                                                  01860000
021600***************************************************************** 02160000
021700*  WRITE A RECORDS TO THE LOGISTICS SKU OUTPUT FILE             * 02170000
021800***************************************************************** 02180000
021900 2100-WRITE-OUTPUT.                                               02190000
022000                                                                  02200000
022100     MOVE 'A'    TO XL008-FILE-INDICATOR.                         02210000
022200     WRITE LOGISTIC-SKU-RECORD FROM                               02220000
022300         XL008-SKU-RECORD                                         02230000
039400     END-WRITE.                                                   03940000
039401     ADD +1                 TO PV-RECORDS-WRITTEN.                03940100
039402                                                                  03940200
