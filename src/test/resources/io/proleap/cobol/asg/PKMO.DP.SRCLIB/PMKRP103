000100*----------------------------------------------------------       00010001
000200 IDENTIFICATION DIVISION.                                         00020001
000300*----------------------------------------------------------       00030001
000400 PROGRAM-ID.             PMKRP103.                                00040001
000500 AUTHOR.                 ALEXIS KEIKER.                           00050001
000600 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00060001
000700 DATE-WRITTEN.           APRIL 2003.                              00070001
000800 DATE-COMPILED.                                                   00080001
000900*----------------------------------------------------------       00090001
001000*          PMKRP103 - PROMO ITEM SALES RESULTS SUMMARY            00100001
001010*                             BY BUYER, BY DEPT                   00110001
001020*----------------------------------------------------------       00120001
001023* THIS PROGRAM WILL PRODUCE AN ACTUAL/FORECAST REPORT. THERE      00130031
001024* IS NO FORECAST REPORT. THIS PROGRAM WILL READ                   00140031
001025* IN A SORTED INPUT FILE CREATED FROM PROGRAM PMKUT100.           00150031
001026* IT WILL THEN REPORT EACH PROMO ITEMS SALE RESULTS.              00160031
001031* THIS REPORT IS A LITTLE DIFFERENT THAN PMKRP100 AND PMKRP101    00170031
001032* BECAUSE IT IS TOTALING BY BUYER AND NOT JUST PROMOTION.         00180031
001033* THIS REPORT ALSO IS SECTIONED WITHIN THE BREAKS BY DEPARTMENT.  00190031
001034*----------------------------------------------------------       00200001
001035* HISTORY LOG:                                                    00210001
001036*----------------------------------------------------------       00220001
001037* DATE:                                                           00230001
001038* WR/IR#:                                                         00240001
001039* PROGRAMMER:                                                     00250001
001040* DESCRIPTION:                                                    00260001
001041*                                                                 00270001
PM3403* 04/20/2012 - PMO 3403 (LARGE RETAIL PROJECT).                   00280038
PM3403*   EXPAND UNIT RETAIL FIELDS TO ALLOW FOR AMT > 9999.99          00290038
PGNBR *                                                                 00290143
PGNBR * DATE: 07/25/2014                                                00291043
PGNBR * WR/IR#: PRB 47935                                               00292043
PGNBR * PROGRAMMER: COGNIZANT                                           00293043
PGNBR * DESCRIPTION: MODIFIED THE PROGRAM TO PROCESS THE PROMO ITEMS AS 00294043
PGNBR *              3 CATEGORIES ADVERTISED,ADVERTISED WITH NO PAGE    00295043
PGNBR *              AND UNADVERTISED VS 2 CATEGORIES ADV & UNADV       00296043
PGNBR *                                                                 00297043
001042*----------------------------------------------------------       00300001
001050 ENVIRONMENT DIVISION.                                            00310001
001060*----------------------------------------------------------       00320001
001070 CONFIGURATION SECTION.                                           00330001
001080 SOURCE-COMPUTER. IBM-3090.                                       00340001
001090 OBJECT-COMPUTER. IBM-3090.                                       00350001
001100                                                                  00360001
001200 INPUT-OUTPUT SECTION.                                            00370001
001300                                                                  00380001
001400 FILE-CONTROL.                                                    00390001
001500                                                                  00400001
001600     SELECT PROMO-ITM-SUMM-FILE                                   00410001
001700            ASSIGN TO INP01.                                      00420001
001800                                                                  00430001
001900     SELECT PROMO-ITM-SUMM-REPORT                                 00440001
002000            ASSIGN TO RPT01.                                      00450001
002100                                                                  00460001
002200*----------------------------------------------------------       00470001
002300 DATA DIVISION.                                                   00480001
002400*----------------------------------------------------------       00490001
002500 FILE SECTION.                                                    00500001
002600                                                                  00510001
002700 FD  PROMO-ITM-SUMM-FILE                                          00520001
002800     RECORDING MODE F                                             00530001
002900     BLOCK CONTAINS 0 RECORDS                                     00540001
003000     LABEL RECORDS ARE OMITTED.                                   00550001
003100 01  PROMO-ITM-SUMM-RECORD            PIC X(750).                 00560001
003200                                                                  00570001
003300 FD  PROMO-ITM-SUMM-REPORT                                        00580001
003400     RECORDING MODE F                                             00590001
003500     BLOCK CONTAINS 0 RECORDS                                     00600001
003600     LABEL RECORDS ARE OMITTED.                                   00610001
003700 01  PROMO-ITM-SUMM-RPT-LINE          PIC X(250).                 00620001
003800                                                                  00630001
003900 WORKING-STORAGE SECTION.                                         00640001
004000*----------------------------------------------------------       00650001
004100* CD- CONTROL DATES (DATES ACCEPTED INTO THE PROGRAM)             00660001
004200*----------------------------------------------------------       00670001
004300 01  CD-CONTROL-DATES.                                            00680001
004400     05  CD-CPU-DATE.                                             00690001
004500         10  CD-CPU-YR                PIC 9(02)  VALUE ZEROES.    00700001
004510         10  CD-CPU-MO                PIC 9(02)  VALUE ZEROES.    00710001
004520         10  CD-CPU-DY                PIC 9(02)  VALUE ZEROES.    00720001
004530                                                                  00730001
004540     05  CD-CPU-DATE-GREG.                                        00740001
004550         10  CD-CPU-MM                PIC 9(02)  VALUE ZEROES.    00750001
004560         10  CD-CPU-DD                PIC 9(02)  VALUE ZEROES.    00760001
004570         10  CD-CPU-YY                PIC 9(02)  VALUE ZEROES.    00770001
004580                                                                  00780001
004590     05  CD-CPU-DATE-ISO              PIC X(10)  VALUE SPACES.    00790001
004591                                                                  00800001
004592*----------------------------------------------------------       00810001
004593* CT- CONTROL TIMES (TIMES ACCEPTED INTO THE PROGRAM)             00820001
004594*----------------------------------------------------------       00830001
004595 01  CT-CONTROL-TIMES.                                            00840001
004596     05  CT-CPU-TIME.                                             00850001
004597         10  CT-CPU-HR                PIC 9(02)  VALUE ZEROES.    00860001
004598         10  CT-CPU-MIN               PIC 9(02)  VALUE ZEROES.    00870001
004599         10  CT-CPU-SEC               PIC 9(02)  VALUE ZEROES.    00880001
004600         10  CT-CPU-HSEC              PIC 9(02)  VALUE ZEROES.    00890001
004601                                                                  00900001
004602*----------------------------------------------------------       00910001
004603* PC- PROGRAM CONSTANTS                                           00920001
004604*----------------------------------------------------------       00930001
004605 01  PC-PROGRAM-CONSTANTS.                                        00940001
004606     05  PC-MAX-LINE-CNT              PIC S9(04) VALUE +78 COMP.  00950001
004607     05  PC-SUB-1                     PIC 9(01)  VALUE 1.         00960001
004608     05  PC-SUB-2                     PIC 9(01)  VALUE 2.         00970001
004609     05  PC-DEFAULT-BEG-HR            PIC 9(02)  VALUE 0.         00980001
004610     05  PC-DEFAULT-BEG-MIN           PIC 9(02)  VALUE 0.         00990001
004620     05  PC-DEFAULT-END-HR            PIC 9(02)  VALUE 23.        01000001
004630     05  PC-DEFAULT-END-MIN           PIC 9(02)  VALUE 59.        01010001
004640     05  PC-CHAR-BUY                  PIC X(03)  VALUE 'BUY'.     01020001
004650     05  PC-CHAR-GET                  PIC X(03)  VALUE 'GET'.     01030001
004660     05  PC-CHAR-OFF                  PIC X(03)  VALUE 'OFF'.     01040001
004670     05  PC-CHAR-EFFECTIVE            PIC X(09)  VALUE            01050001
004680                                          'EFFECTIVE'.            01060001
004690     05  PC-FORECAST-RSLT             PIC X(36)  VALUE            01070026
004700         'FORECAST ONLY RESULTS (IN THOUSANDS)'.                  01080026
004800     05  PC-ACTUAL-RSLT               PIC X(36)  VALUE            01090026
004900         'ACTUAL RESULTS (IN THOUSANDS)       '.                  01100026
005000     05  PC-PERCENT-SIGN              PIC X(01)  VALUE '%'.       01110001
005100     05  PC-DOLLAR-SIGN               PIC X(01)  VALUE '$'.       01120001
005200     05  PC-FRONT-PAR                 PIC X(01)  VALUE '('.       01130001
005300     05  PC-BACK-PAR                  PIC X(01)  VALUE ')'.       01140001
005400     05  PC-ONE-LINE                  PIC S9(04) VALUE +1 COMP.   01150001
005500     05  PC-CURRENT-PROGRAM-NAME      PIC X(08)  VALUE            01160001
005600                                                 'PMKRP103'.      01170001
005700     05  PC-COLON                     PIC X(01)  VALUE ':'.       01180001
005800     05  PC-DASH                      PIC X(01)  VALUE '-'.       01190001
005900     05  PC-ALL-DAY                   PIC X(07)  VALUE            01200001
006000                                                 'ALL DAY'.       01210001
006010     05  PC-DEPARTMENT                PIC X(11)  VALUE            01220005
006020          'DEPARTMENT:'.                                          01230005
006100     05  PC-PROMO-ITEMS-ON-PAGE       PIC X(37)  VALUE            01240001
006200          'PROMO ITEMS ON PAGE:                 '.                01250001
006500     05  PC-PROMO-ITEMS-UNADV         PIC X(37)  VALUE            01260001
006600          'UNADVERTISED                         '.                01270001
006700     05  PC-TOTAL                     PIC X(05)  VALUE            01280002
006800          'TOTAL'.                                                01290002
007100     05  PC-ADV-TOTAL                 PIC X(16)  VALUE            01300002
007200          'TOTAL ADVERTISED'.                                     01310002
PGNBR      05  PC-ADVNO-TOTAL               PIC X(16)  VALUE            01311042
PGNBR           'TOTAL ADVNO PAGE'.                                     01312040
007300     05  PC-UNADV-TOTAL               PIC X(18)  VALUE            01320002
007400          'TOTAL UNADVERTISED'.                                   01330002
007500     05  PC-ADV-BUY-TOTAL             PIC X(22)  VALUE            01340002
007600          'TOTAL ADVERTISED BUYER'.                               01350002
PGNBR      05  PC-ANP-BUY-TOTAL             PIC X(22)  VALUE            01351041
PGNBR           'TOTAL ADVER NOPG BUYER'.                               01352041
007610     05  PC-UNADV-BUY-TOTAL           PIC X(24)  VALUE            01360002
007620          'TOTAL UNADVERTISED BUYER'.                             01370002
007630     05  PC-BUY-TOTAL                 PIC X(11)  VALUE            01380002
007640          'TOTAL BUYER'.                                          01390002
007700                                                                  01400001
007800*----------------------------------------------------------       01410001
007900* PS- PROGRAM SWITCHES                                            01420001
008000*----------------------------------------------------------       01430001
008100 01  PS-PROGRAM-SWITCHES.                                         01440001
008200     05  PS-SALES-RESULTS-SW          PIC X(01)  VALUE 'Y'.       01450001
008300         88  PS-EOF-SALES-RESULTS                VALUE 'N'.       01460001
008400         88  PS-NOT-EOF-SALES-RESULTS            VALUE 'Y'.       01470001
008500     05  PS-FIRST-TIME-SW             PIC X(01)  VALUE 'Y'.       01480001
008600         88  PS-NOT-FIRST-TIME                   VALUE 'N'.       01490001
008700         88  PS-FIRST-TIME                       VALUE 'Y'.       01500001
008800     05  PS-PAGE-SECTION-TTL-SW       PIC X(01)  VALUE 'Y'.       01510001
008900         88  PS-PAGE-SECTION-TTL                 VALUE 'N'.       01520001
009000         88  PS-NO-PAGE-TTL                      VALUE 'Y'.       01530001
009700     05  PS-TOT-PROMO-TTL-SW          PIC X(01)  VALUE 'Y'.       01540001
009800         88  PS-TOT-PROMO-TTL                    VALUE 'N'.       01550001
009900         88  PS-NO-TOT-PROMO-TTL                 VALUE 'Y'.       01560001
PGNBR *    05  PS-ADV-PROMO-TTL-SW          PIC X(01)  VALUE 'Y'.       01570040
PGNBR *        88  PS-UNADV-PROMO-TTL                  VALUE 'N'.       01580040
PGNBR *        88  PS-ADV-PROMO-TTL                    VALUE 'Y'.       01590040
PGNBR      05  PS-ADV-PROMO-TTL-SW          PIC X(01)  VALUE '0'.       01591040
PGNBR          88  PS-ADV-PROMO-TTL                    VALUE '1'.       01591140
PGNBR          88  PS-ADV-NOPGE-TTL                    VALUE '2'.       01591240
PGNBR          88  PS-UNADV-PROMO-TTL                  VALUE '3'.       01592040
010300                                                                  01600001
010400*----------------------------------------------------------       01610001
010500* PV- PROGRAM VARIABLES                                           01620001
010600*----------------------------------------------------------       01630001
010700 01  PV-PROGRAM-VARIABLES.                                        01640001
010800     05  PV-ADVANCE-LINES             PIC S9(04) VALUE +0 COMP.   01650021
010900     05  PV-SAVE-LINE-AMT             PIC S9(04) VALUE +0 COMP.   01660021
010910     05  PV-SAVE-SKIP-LINES           PIC S9(04) VALUE +0 COMP.   01670021
011000     05  PV-LINE-CNT                  PIC S9(04) VALUE +0 COMP.   01680001
011100     05  PV-PAGE-CNT                  PIC 9(05)  VALUE 0.         01690001
011110     05  PV-VAR-IDX                   PIC S9(04) VALUE +0.        01700030
011200     05  PV-PARAGRAPH-NAME            PIC X(30)  VALUE SPACE.     01710001
011300     05  PV-OPERATION-MSG-1           PIC X(40)  VALUE SPACES.    01720001
011400     05  PV-OPERATION-MSG-2           PIC X(40)  VALUE SPACES.    01730001
011410     05  PV-SAVE-DEPT-NBR             PIC 9(04)  VALUE 0.         01740007
011420     05  PV-SAVE-BUYER-NBR            PIC 9(04)  VALUE 0.         01750007
011500     05  PV-SAVE-VAR                  PIC X(60)  VALUE SPACES.    01760030
011600     05  PV-SAVE-NUM                  PIC 9(02)  VALUE 0.         01770001
011700     05  PV-SAVE-LENGTH               PIC 9(02)  VALUE 0.         01780001
011710     05  PV-CHAR-LENGTH               PIC 9(02)  VALUE 0.         01790030
011800     05  PV-SUBSCRIPT                 PIC 9(02)  VALUE 0.         01800001
011900     05  PV-PROMO-NM-LENGTH           PIC 9(02)  VALUE 0.         01810001
012000     05  PV-AD-EVNT-NM-LENGTH         PIC 9(02)  VALUE 0.         01820001
012100     05  PV-AD-EVNT-NBR-LENGTH        PIC 9(02)  VALUE 0.         01830001
012200     05  PV-BUYER-FRST-LENGTH         PIC 9(02)  VALUE 0.         01840001
012300     05  PV-BUYER-LAST-LENGTH         PIC 9(02)  VALUE 0.         01850001
012400                                                                  01860001
012500     05  PV-TIER-ITM-DESC.                                        01870001
012600         10  FILLER                   PIC X(01)  VALUE SPACES.    01880001
012700         10  PV-TIER-ITM-DESC-1       PIC X(39)  VALUE SPACES.    01890001
012800     05  PV-THRS-AMT-NUM              PIC 9(08)V9(02) VALUE 0.    01900001
012900     05  PV-THRS-AMT-NUM-X REDEFINES                              01910001
013000         PV-THRS-AMT-NUM              PIC 9(10).                  01920001
013100     05  PV-DISC-PCT-NUM              PIC 9(03)V9(03) VALUE 0.    01930001
013200     05  PV-DISC-PCT-NUM-X REDEFINES                              01940001
013300         PV-DISC-PCT-NUM              PIC 9(06).                  01950001
013400     05  PV-DISC-AMT-NUM              PIC 9(08)V9(02) VALUE 0.    01960001
013500     05  PV-DISC-AMT-NUM-X REDEFINES                              01970001
013600         PV-DISC-AMT-NUM              PIC 9(10).                  01980001
013700     05  PV-SAVE-THRS-AMT.                                        01990001
013800         10  PV-SAVE-THRS-AMT-1       PIC 9(08)  VALUE 0.         02000001
013900         10  PV-SAVE-THRS-AMT-2       PIC 9(02)  VALUE 0.         02010001
014000     05  PV-SAVE-DISC-PCT.                                        02020001
014100         10  PV-SAVE-DISC-PCT-1       PIC 9(03)  VALUE 0.         02030001
014200         10  PV-SAVE-DISC-PCT-2       PIC 9(03)  VALUE 0.         02040001
014300     05  PV-SAVE-DISC-AMT.                                        02050001
014400         10  PV-SAVE-DISC-AMT-1       PIC 9(08)  VALUE 0.         02060001
014500         10  PV-SAVE-DISC-AMT-2       PIC 9(02)  VALUE 0.         02070001
014600     05  PV-THRS-AMT-CHAR             PIC X(08)  VALUE SPACES.    02080001
014700     05  PV-DISC-PCT-CHAR             PIC X(03)  VALUE SPACES.    02090001
014800     05  PV-DISC-AMT-CHAR             PIC X(08)  VALUE SPACES.    02100001
014900     05  PV-THRS-QTY-CHAR             PIC X(05)  VALUE SPACES.    02110001
015000     05  PV-POINTER-FIELD             PIC S9(03) VALUE +0.        02120001
015100     05  PV-LAST-ADEVNT-ID            PIC 9(10)  VALUE 0.         02130001
015200     05  PV-LAST-PROMO-ID             PIC 9(10)  VALUE 0.         02140001
015300     05  PV-LAST-BUYER-NBR            PIC 9(04)  VALUE 0.         02150001
015310     05  PV-LAST-DEPT-NBR             PIC 9(04)  VALUE 0.         02160008
015400     05  PV-TIER-PRICG-ID             PIC 9(10)  VALUE 0.         02170001
015500     05  PV-AD-PG-NBR                 PIC 9(03)  VALUE 0.         02180001
015600     05  PV-ROUND-TO-WHOLE-DOLLARS    PIC S9(09) VALUE +0.        02190001
015700     05  PV-ROUND-TO-TENTHS           PIC S9(09)V9 VALUE +0.      02200001
015710     05  PV-ROUND-TO-HDRTHS           PIC S9(09)V99 VALUE +0.     02210028
015800     05  PV-ROUND-VOL-PCT             PIC 9(09)V9 VALUE 0.        02220001
015900     05  PV-TRUNCAT-VOL-PCT           PIC 9(04)V9 VALUE 0.        02230024
016000     05  PV-TRUNCAT-VOL-PCT-X REDEFINES                           02240001
016100         PV-TRUNCAT-VOL-PCT           PIC 9(05).                  02250024
016200     05  PV-NUM-VOL-PCT.                                          02260001
016300         10  PV-NUM-VOL-PCT-1         PIC 9(04)  VALUE 0.         02270024
016400         10  PV-NUM-VOL-PCT-2         PIC 9(01)  VALUE 0.         02280001
016500     05  PV-CHAR-VOL-PCT REDEFINES                                02290001
016600         PV-NUM-VOL-PCT.                                          02300001
016700         10  PV-CHAR-VOL-PCT-1        PIC X(04).                  02310024
016800         10  PV-CHAR-VOL-PCT-2        PIC X(01).                  02320001
016900     05  PV-FINAL-VOL-PCT.                                        02330001
016910         10  PV-FINAL-VOL-PCT-1       PIC X(01)  VALUE SPACES.    02340024
017000         10  PV-FINAL-VOL-PCT-2       PIC X(01)  VALUE SPACES.    02350024
017100         10  PV-FINAL-VOL-PCT-3       PIC X(01)  VALUE SPACES.    02360024
017200         10  PV-FINAL-VOL-PCT-4       PIC X(01)  VALUE SPACES.    02370024
017300         10  PV-FINAL-VOL-PCT-5       PIC X(01)  VALUE SPACES.    02380024
017400         10  FILLER                   PIC X(01)  VALUE '.'.       02390001
017500         10  PV-FINAL-VOL-PCT-6       PIC X(01)  VALUE SPACES.    02400024
017600         10  PV-FINAL-VOL-PCT-7       PIC X(01)  VALUE SPACES.    02410024
017700     05  PV-SEP-VOL-PCT.                                          02420001
017710         10  PV-SEP-VOL-PCT-1         PIC 9(01)  VALUE 0.         02430024
017800         10  PV-SEP-VOL-PCT-2         PIC 9(01)  VALUE 0.         02440024
017900         10  PV-SEP-VOL-PCT-3         PIC 9(01)  VALUE 0.         02450024
018000         10  PV-SEP-VOL-PCT-4         PIC 9(01)  VALUE 0.         02460024
018100         10  PV-SEP-VOL-PCT-5         PIC 9(01)  VALUE 0.         02470024
018110     05  PV-VOL-PCT-CHG               PIC S9(09)V9999 VALUE +0    02480001
018120                                                     COMP-3.      02490001
018130     05  PV-MU-PCT                    PIC S9(09)V9999 VALUE +0    02500001
018140                                                     COMP-3.      02510001
018150     05  PV-SELL-THRU-PCT             PIC S9(09)V9999 VALUE +0    02520001
018160                                                     COMP-3.      02530001
018170     05  PV-RPT-LINE                  PIC X(250) VALUE SPACES.    02540001
018180     05  PV-PROMO-STRT-TMST.                                      02550001
018190         10  PV-PROMO-STRT-DTE.                                   02560001
018191             15  PV-PM-STRT-DTE-CC    PIC X(02)  VALUE SPACES.    02570001
018192             15  PV-PM-STRT-DTE-YY    PIC X(02)  VALUE SPACES.    02580001
018193             15  FILLER               PIC X(01)  VALUE SPACES.    02590001
018194             15  PV-PM-STRT-DTE-MM    PIC X(02)  VALUE SPACES.    02600001
018195             15  FILLER               PIC X(01)  VALUE SPACES.    02610001
018196             15  PV-PM-STRT-DTE-DD    PIC X(02)  VALUE SPACES.    02620001
018197         10  FILLER                   PIC X(01)  VALUE SPACES.    02630001
018198         10  PV-PROMO-STRT-TM.                                    02640001
018199             15  PV-PM-STRT-TM-HH     PIC X(02)  VALUE SPACES.    02650001
018200             15  FILLER               PIC X(01)  VALUE SPACES.    02660001
018210             15  PV-PM-STRT-TM-MM     PIC X(02)  VALUE SPACES.    02670001
018220             15  FILLER               PIC X(01)  VALUE SPACES.    02680001
018230             15  PV-PM-STRT-TM-SS     PIC X(02)  VALUE SPACES.    02690001
018240                                                                  02700001
018250     05  PV-PROMO-END-TMST.                                       02710001
018260         10  PV-PROMO-END-DTE.                                    02720001
018270             15  PV-PM-END-DTE-CC     PIC X(02)  VALUE SPACES.    02730001
018280             15  PV-PM-END-DTE-YY     PIC X(02)  VALUE SPACES.    02740001
018290             15  FILLER               PIC X(01)  VALUE SPACES.    02750001
018300             15  PV-PM-END-DTE-MM     PIC X(02)  VALUE SPACES.    02760001
018400             15  FILLER               PIC X(01)  VALUE SPACES.    02770001
018500             15  PV-PM-END-DTE-DD     PIC X(02)  VALUE SPACES.    02780001
018600         10  FILLER                   PIC X(01)  VALUE SPACES.    02790001
018700         10  PV-PROMO-END-TM.                                     02800001
018800             15  PV-PM-END-TM-HH      PIC X(02)  VALUE SPACES.    02810001
018900             15  FILLER               PIC X(01)  VALUE SPACES.    02820001
019000             15  PV-PM-END-TM-MM      PIC X(02)  VALUE SPACES.    02830001
019100             15  FILLER               PIC X(01)  VALUE SPACES.    02840001
019200             15  PV-PM-END-TM-SS      PIC X(02)  VALUE SPACES.    02850001
019300                                                                  02860001
019400     05  PV-PROMO-ITM-STRT-TMST.                                  02870001
019500         10  PV-PROMO-ITM-STRT-DTE.                               02880001
019600             15  PV-PI-STRT-DTE-CC    PIC X(02)  VALUE SPACES.    02890001
019700             15  PV-PI-STRT-DTE-YY    PIC X(02)  VALUE SPACES.    02900001
019800             15  FILLER               PIC X(01)  VALUE SPACES.    02910001
019900             15  PV-PI-STRT-DTE-MM    PIC X(02)  VALUE SPACES.    02920001
020000             15  FILLER               PIC X(01)  VALUE SPACES.    02930001
020100             15  PV-PI-STRT-DTE-DD    PIC X(02)  VALUE SPACES.    02940001
020200         10  FILLER                   PIC X(01)  VALUE SPACES.    02950001
020300         10  PV-PROMO-ITM-STRT-TM.                                02960001
020400             15  PV-PI-STRT-TM-HH     PIC X(02)  VALUE SPACES.    02970001
020500             15  FILLER               PIC X(01)  VALUE SPACES.    02980001
020600             15  PV-PI-STRT-TM-MM     PIC X(02)  VALUE SPACES.    02990001
020700             15  FILLER               PIC X(01)  VALUE SPACES.    03000001
020800             15  PV-PI-STRT-TM-SS     PIC X(02)  VALUE SPACES.    03010001
020900                                                                  03020001
021000     05  PV-PROMO-ITM-END-TMST.                                   03030001
021100         10  PV-PROMO-ITM-END-DTE.                                03040001
021200             15  PV-PI-END-DTE-CC     PIC X(02)  VALUE SPACES.    03050001
021300             15  PV-PI-END-DTE-YY     PIC X(02)  VALUE SPACES.    03060001
021400             15  FILLER               PIC X(01)  VALUE SPACES.    03070001
021500             15  PV-PI-END-DTE-MM     PIC X(02)  VALUE SPACES.    03080001
021600             15  FILLER               PIC X(01)  VALUE SPACES.    03090001
021700             15  PV-PI-END-DTE-DD     PIC X(02)  VALUE SPACES.    03100001
021800         10  FILLER                   PIC X(01)  VALUE SPACES.    03110001
021900         10  PV-PROMO-ITM-END-TM.                                 03120001
022000             15  PV-PI-END-TM-HH      PIC X(02)  VALUE SPACES.    03130001
022010             15  FILLER               PIC X(01)  VALUE SPACES.    03140001
022020             15  PV-PI-END-TM-MM      PIC X(02)  VALUE SPACES.    03150001
022030             15  FILLER               PIC X(01)  VALUE SPACES.    03160001
022040             15  PV-PI-END-TM-SS      PIC X(02)  VALUE SPACES.    03170001
022050                                                                  03180001
022060     05  PV-PM-ITM-EFF-STRT-DTE.                                  03190001
022070         10  PV-EFF-STRT-DTE-MM       PIC X(02)  VALUE SPACES.    03200001
022080         10  FILLER                   PIC X(01)  VALUE '/'.       03210001
022090         10  PV-EFF-STRT-DTE-DD       PIC X(02)  VALUE SPACES.    03220001
022091         10  FILLER                   PIC X(01)  VALUE '/'.       03230001
022092         10  PV-EFF-STRT-DTE-YY       PIC X(02)  VALUE SPACES.    03240001
022093                                                                  03250001
022094     05  PV-PM-ITM-EFF-END-DTE.                                   03260001
022095         10  PV-EFF-END-DTE-MM        PIC X(02)  VALUE SPACES.    03270001
022096         10  FILLER                   PIC X(01)  VALUE '/'.       03280001
022097         10  PV-EFF-END-DTE-DD        PIC X(02)  VALUE SPACES.    03290001
022098         10  FILLER                   PIC X(01)  VALUE '/'.       03300001
022099         10  PV-EFF-END-DTE-YY        PIC X(02)  VALUE SPACES.    03310001
022100                                                                  03320001
022101     05  PV-EFF-DTE-LAYOUT.                                       03330001
022102         10  FILLER                   PIC X(02)  VALUE SPACES.    03340001
022103         10  PV-OPEN-PARENTH          PIC X(01)  VALUE SPACES.    03350001
022104         10  PV-EFF-STRT-DTE          PIC X(08)  VALUE SPACES.    03360001
022105         10  PV-DTE-DASH              PIC X(01)  VALUE SPACES.    03370001
022106         10  PV-EFF-END-DTE           PIC X(08)  VALUE SPACES.    03380001
022107         10  PV-CLOSE-PARENTH         PIC X(01)  VALUE SPACES.    03390001
022108                                                                  03400001
022109     05  PV-VARIABLE-OUTPUT-FIELD.                                03410001
022110         10  PV-BIT-VARIABLE          PIC X(01)  VALUE SPACES     03420001
022120                                       OCCURS 61 TIMES            03430030
022130                                       INDEXED BY                 03440001
022131                                       PV-BIT-IDX.                03450001
022132                                                                  03460001
022133     05  PV-VER-AD-VARIABLE.                                      03470030
022134         10  PV-PARENTHESES           PIC X(01)  VALUE SPACES.    03480030
022135         10  PV-VERSION-AD            PIC X(59)  VALUE SPACES.    03490030
022136                                                                  03500030
022137     05  PV-HEADER-DTE-TM.                                        03510001
022138         10  PV-BEG-DAY-ALPHA         PIC X(10).                  03520001
022139         10  PV-BEG-DATE              PIC X(08).                  03530001
022140         10  FILLER                   PIC X(02)  VALUE SPACES.    03540001
022141         10  PV-BEG-TIME.                                         03550001
022142             15  PV-BEG-HR-TIME       PIC 9(02).                  03560001
022143             15  PV-BEG-TIME-COLON    PIC X(01).                  03570001
022144             15  PV-BEG-MIN-TIME      PIC 9(02).                  03580001
022145             15  FILLER               PIC X(02)  VALUE SPACES.    03590001
022146         10  FILLER                   PIC X(11)  VALUE            03600001
022147                                      '   THROUGH '.              03610001
022148         10  PV-END-DAY-ALPHA         PIC X(10).                  03620001
022149         10  PV-END-DATE              PIC X(08).                  03630001
022150         10  FILLER                   PIC X(02)  VALUE SPACES.    03640001
022151         10  PV-END-TIME.                                         03650001
022152             15  PV-END-HR-TIME       PIC 9(02).                  03660001
022153             15  PV-END-TIME-COLON    PIC X(01).                  03670001
022154             15  PV-END-MIN-TIME      PIC 9(02).                  03680001
022155             15  FILLER               PIC X(02).                  03690001
022156         10  FILLER                   PIC X(22)  VALUE SPACES.    03700001
022157                                                                  03710001
022158*----------------------------------------------------------       03720001
022159* PA- PROGRAM ACCUMULATORS                                        03730001
022160*----------------------------------------------------------       03740001
022161 01  PA-PROGRAM-ACCUMULATORS.                                     03750001
022162     05  PA-CNT-ADV-TOT               PIC 9(09)  VALUE ZEROES.    03760001
022163     05  PA-CNT-UNADV-TOT             PIC 9(09)  VALUE ZEROES.    03770001
022164     05  PA-CNT-SPACES-1              PIC 9(09)  VALUE ZEROES.    03780001
022170     05  PA-CNT-POS-1                 PIC 9(09)  VALUE ZEROES.    03790001
022180     05  PA-CNT-SPACES-2              PIC 9(09)  VALUE ZEROES.    03800001
022190     05  PA-CNT-SPACES                PIC 9(09)  VALUE ZEROES.    03810001
022200     05  PA-CNT-POS-2                 PIC 9(09)  VALUE ZEROES.    03820001
022300                                                                  03830001
022400*----------------------------------------------------------       03840001
022500* TBL- TABLE VARIABLES                                            03850001
022600*----------------------------------------------------------       03860001
022700* NOTE: THE FIRST OCCURRENCE CONTAINS ACTUAL FIGURES, THE SECOND  03870001
022800*    OCCURRENCE CONTAINS FORECAST FIGURES                         03880001
022900 01  TBL-SECT-TOTAL-TABLE.                                        03890001
023000     05  TBL-STOT-LINE-01 OCCURS 02 TIMES                         03900001
023100                           INDEXED BY TBL-STOT-INDX.              03910001
023200         10  TBL-STOT-TOT-SALE-AMT    PIC S9(09)V9(02) COMP-3.    03920001
023300         10  TBL-STOT-TOT-MD-AMT      PIC S9(09)V9(02) COMP-3.    03930001
023400         10  TBL-STOT-TOT-SLS-UNT-QTY                             03940001
023500                                      PIC S9(09)V9(02) COMP-3.    03950001
023600         10  TBL-STOT-TOT-EOH-INV-QTY                             03960001
023700                                      PIC S9(09)V9(02) COMP-3.    03970001
023800         10  TBL-STOT-PREP-UNT-QTY    PIC S9(09)V9(02) COMP-3.    03980001
023900         10  TBL-STOT-TOT-SLS-COST-AMT                            03990001
024000                                      PIC S9(09)V9(02) COMP-3.    04000001
024100                                                                  04010001
024101* NOTE: THE FIRST OCCURRENCE CONTAINS ACTUAL FIGURES, THE SECOND  04020006
024102*    OCCURRENCE CONTAINS FORECAST FIGURES                         04030006
024110 01  TBL-DEPT-TOTAL-TABLE.                                        04040006
024120     05  TBL-DTOT-LINE-01 OCCURS 02 TIMES                         04050006
024130                           INDEXED BY TBL-STOT-INDX.              04060006
024140         10  TBL-DTOT-TOT-SALE-AMT    PIC S9(09)V9(02) COMP-3.    04070006
024150         10  TBL-DTOT-TOT-MD-AMT      PIC S9(09)V9(02) COMP-3.    04080006
024160         10  TBL-DTOT-TOT-SLS-UNT-QTY                             04090006
024170                                      PIC S9(09)V9(02) COMP-3.    04100006
024180         10  TBL-DTOT-TOT-EOH-INV-QTY                             04110006
024190                                      PIC S9(09)V9(02) COMP-3.    04120006
024191         10  TBL-DTOT-PREP-UNT-QTY    PIC S9(09)V9(02) COMP-3.    04130006
024192         10  TBL-DTOT-TOT-SLS-COST-AMT                            04140006
024193                                      PIC S9(09)V9(02) COMP-3.    04150006
024194                                                                  04160006
024195* NOTE: THE FIRST OCCURRENCE CONTAINS ACTUAL FIGURES, THE SECOND  04170006
024196*    OCCURRENCE CONTAINS FORECAST FIGURES                         04180006
024197 01  TBL-BUYADV-TOTAL-TABLE.                                      04190006
024198     05  TBL-BATOT-LINE-01 OCCURS 02 TIMES                        04200006
024199                          INDEXED BY TBL-PMTOT-INDX.              04210006
024200         10  TBL-BATOT-TOT-SALE-AMT   PIC S9(09)V9(02) COMP-3.    04220006
024201         10  TBL-BATOT-TOT-MD-AMT     PIC S9(09)V9(02) COMP-3.    04230006
024202         10  TBL-BATOT-TOT-SLS-UNT-QTY                            04240006
024203                                      PIC S9(09)V9(02) COMP-3.    04250006
024204         10  TBL-BATOT-TOT-EOH-INV-QTY                            04260006
024205                                      PIC S9(09)V9(02) COMP-3.    04270006
024206         10  TBL-BATOT-PREP-UNT-QTY   PIC S9(09)V9(02) COMP-3.    04280006
024207         10  TBL-BATOT-TOT-SLS-COST-AMT                           04290006
024208                                      PIC S9(09)V9(02) COMP-3.    04300006
024209                                                                  04310006
PGNBR * NOTE: THE FIRST OCCURRENCE CONTAINS ACTUAL FIGURES, THE SECOND  04311040
PGNBR *    OCCURRENCE CONTAINS FORECAST FIGURES                         04312040
PGNBR  01  TBL-BUYADNP-TOTAL-TABLE.                                     04313040
PGNBR      05  TBL-BNPTOT-LINE-01 OCCURS 02 TIMES                       04314040
PGNBR                           INDEXED BY TBL-PMTOT-INDX.              04315040
PGNBR          10  TBL-BNPTOT-TOT-SALE-AMT   PIC S9(09)V9(02) COMP-3.   04316040
PGNBR          10  TBL-BNPTOT-TOT-MD-AMT     PIC S9(09)V9(02) COMP-3.   04317040
PGNBR          10  TBL-BNPTOT-TOT-SLS-UNT-QTY                           04318040
PGNBR                                        PIC S9(09)V9(02) COMP-3.   04319040
PGNBR          10  TBL-BNPTOT-TOT-EOH-INV-QTY                           04319140
PGNBR                                        PIC S9(09)V9(02) COMP-3.   04319240
PGNBR          10  TBL-BNPTOT-PREP-UNT-QTY   PIC S9(09)V9(02) COMP-3.   04319340
PGNBR          10  TBL-BNPTOT-TOT-SLS-COST-AMT                          04319440
PGNBR                                        PIC S9(09)V9(02) COMP-3.   04319540
PGNBR                                                                   04319640
024210* NOTE: THE FIRST OCCURRENCE CONTAINS ACTUAL FIGURES, THE SECOND  04320006
024211*    OCCURRENCE CONTAINS FORECAST FIGURES                         04330006
024212 01  TBL-BUYUNADV-TOTAL-TABLE.                                    04340006
024213     05  TBL-BUTOT-LINE-01 OCCURS 02 TIMES                        04350006
024214                          INDEXED BY TBL-PMTOT-INDX.              04360006
024215         10  TBL-BUTOT-TOT-SALE-AMT   PIC S9(09)V9(02) COMP-3.    04370006
024216         10  TBL-BUTOT-TOT-MD-AMT     PIC S9(09)V9(02) COMP-3.    04380006
024217         10  TBL-BUTOT-TOT-SLS-UNT-QTY                            04390006
024218                                      PIC S9(09)V9(02) COMP-3.    04400006
024219         10  TBL-BUTOT-TOT-EOH-INV-QTY                            04410006
024220                                      PIC S9(09)V9(02) COMP-3.    04420006
024221         10  TBL-BUTOT-PREP-UNT-QTY   PIC S9(09)V9(02) COMP-3.    04430006
024222         10  TBL-BUTOT-TOT-SLS-COST-AMT                           04440006
024223                                      PIC S9(09)V9(02) COMP-3.    04450006
024224                                                                  04460006
024230* NOTE: THE FIRST OCCURRENCE CONTAINS ACTUAL FIGURES, THE SECOND  04470001
024300*    OCCURRENCE CONTAINS FORECAST FIGURES                         04480001
024400 01  TBL-BUYER-TOTAL-TABLE.                                       04490006
024500     05  TBL-BTOT-LINE-01 OCCURS 02 TIMES                         04500006
024600                          INDEXED BY TBL-PMTOT-INDX.              04510001
024700         10  TBL-BTOT-TOT-SALE-AMT    PIC S9(09)V9(02) COMP-3.    04520006
024800         10  TBL-BTOT-TOT-MD-AMT      PIC S9(09)V9(02) COMP-3.    04530006
024900         10  TBL-BTOT-TOT-SLS-UNT-QTY                             04540006
025000                                      PIC S9(09)V9(02) COMP-3.    04550001
025100         10  TBL-BTOT-TOT-EOH-INV-QTY                             04560006
025200                                      PIC S9(09)V9(02) COMP-3.    04570001
025300         10  TBL-BTOT-PREP-UNT-QTY    PIC S9(09)V9(02) COMP-3.    04580006
025400         10  TBL-BTOT-TOT-SLS-COST-AMT                            04590006
025500                                      PIC S9(09)V9(02) COMP-3.    04600006
025600                                                                  04610001
025700*----------------------------------------------------------       04620001
025800* ABEND- ABEND VARIABLES                                          04630001
025900*----------------------------------------------------------       04640001
026000 01  ABEND-CODE                       PIC S9(04) VALUE +0 COMP.   04650001
026100     88  ABEND-4001-WRITE-ERROR                  VALUE +4001.     04660001
026200     88  ABEND-4002-READ-ERROR                   VALUE +4002.     04670001
026300     88  ABEND-4003-CTRL-CARD-ERROR              VALUE +4003.     04680001
026400     88  ABEND-4004-TABLE-ERROR                  VALUE +4004.     04690001
026500     88  ABEND-4005-OPEN-ERROR                   VALUE +4005.     04700001
026600     88  ABEND-4006-CLOSE-ERROR                  VALUE +4006.     04710001
026700     88  ABEND-4007-SEQUENCE-ERROR               VALUE +4007.     04720001
026800     88  ABEND-4008-DATA-ERROR                   VALUE +4008.     04730001
026900     88  ABEND-4009-KEY-DATA-ERROR               VALUE +4009.     04740001
027200     88  ABEND-4013-DB2-ERROR                    VALUE +4013.     04750001
027300     88  ABEND-4019-DATE-ROUTINE-ERROR           VALUE +4019.     04760001
027400     88  ABEND-4444-FORCED-ABEND                 VALUE +4444.     04770001
027500                                                                  04780001
027600 01  END-OF-REPORT-LINE.                                          04790001
027700     05  FILLER                       PIC X(25)  VALUE            04800001
027800         ' ** END OF REPORT **     '.                             04810001
027900                                                                  04820001
028000*----------------------------------------------------------       04830001
028100* HD- HEADER INFO                                                 04840001
028200*----------------------------------------------------------       04850001
028300 01  HEADER-01.                                                   04860001
028400     05  FILLER                       PIC X(89) VALUE SPACES.     04870027
028500     05  FILLER                       PIC X(41)  VALUE            04880026
028600         'PROMO ITEM SUMMARY - BY BUYER, BY DEPT - '.             04890026
028700     05  HDR-01-TITLE                 PIC X(36)  VALUE SPACES.    04900026
028800     05  FILLER                       PIC X(84)  VALUE SPACES.    04910027
028900                                                                  04920001
029000 01  HEADER-02.                                                   04930001
029100     05  FILLER                       PIC X(12)  VALUE            04940036
029200                                      ' AD EVENT : '.             04950036
029300     05  HDR-02-ADEVNT-STRING         PIC X(238) VALUE SPACES.    04960036
029400                                                                  04970001
029500 01  HEADER-03.                                                   04980001
029600     05  FILLER                       PIC X(12)  VALUE            04990001
029700                                      ' PROMOTION: '.             05000001
029800     05  HDR-03-PROMO-STRING          PIC X(238) VALUE SPACES.    05010001
029900                                                                  05020001
030000 01  HEADER-04.                                                   05030001
030010     05  FILLER                       PIC X(12)  VALUE            05040036
030020                                      ' BUYER    : '.             05050036
030030     05  HDR-04-BUYER-NBR             PIC 9(04)  VALUE ZEROES.    05060001
030031     05  FILLER                       PIC X(01)  VALUE SPACES.    05070001
030032     05  HDR-04-BUYER-STRING          PIC X(233) VALUE SPACES.    05080036
030033                                                                  05090001
030034 01  HEADER-05.                                                   05100001
030035     05  FILLER                       PIC X(45)  VALUE            05110001
030036         '                                             '.         05120001
030037     05  FILLER                       PIC X(45)  VALUE            05130001
030038         '       AD   AD           SALES VOLUME       V'.         05140015
030039     05  FILLER                       PIC X(45)  VALUE            05150001
030040         'OL %            MARKDOWN $              UNITS'.         05160013
030050     05  FILLER                       PIC X(45)  VALUE            05170001
030060         ' SOLD              PREP UNITS       SELL     '.         05180036
030070     05  FILLER                       PIC X(45)  VALUE            05190001
030080         '       TOTAL COST       MARKUP %      RETAIL '.         05200014
030090     05  FILLER                       PIC X(25)  VALUE            05210001
030100         'PRICE       PROMO PRICE  '.                             05220001
030200                                                                  05230001
030300 01  HEADER-06.                                                   05240001
030400     05  FILLER                       PIC X(45)  VALUE            05250001
030500         ' PROMO ITEM DESCRIPTION                      '.         05260001
030600     05  FILLER                       PIC X(45)  VALUE            05270012
030700         '      PAGE SPACE        ACT        FCST      '.         05280015
030800     05  FILLER                       PIC X(45)  VALUE            05290001
030900         'CHG           ACT        FCST         ACT    '.         05300013
031000     05  FILLER                       PIC X(45)  VALUE            05310001
031100         '    FCST         ACT        FCST   THRU %    '.         05320036
031200     05  FILLER                       PIC X(45)  VALUE            05330001
031300         '     ACT        FCST   ACT   FCST      MIN   '.         05340014
031400     05  FILLER                       PIC X(25)  VALUE            05350001
031500         '   MAX      MIN      MAX '.                             05360001
031600                                                                  05370001
031700                                                                  05380001
031800*----------------------------------------------------------       05390001
031900* DTL- DETAIL INFO                                                05400001
032000*----------------------------------------------------------       05410001
032100 01  DETAIL-HEADER-01.                                            05420001
032200     05  DTL-HDR-01-PAGE.                                         05430001
032300         10  DTL-HDR-01-PM-DEPT.                                  05440002
032400             15  FILLER               PIC X(01) VALUE SPACES.     05450002
032500             15  DTL-HDR-01-PM-TITLE  PIC X(11) VALUE SPACES.     05460005
032610             15  FILLER               PIC X(01) VALUE SPACES.     05470005
032700             15  DTL-HDR-01-PM-DEPT-NBR                           05480002
032800                                      PIC 9(04).                  05490005
032810             15  FILLER               PIC X(01) VALUE SPACES.     05500002
032900             15  DTL-HDR-01-PM-DEPT-NM                            05510002
032910                                      PIC X(20).                  05520002
033000         10  DTL-HDR-01-HEADER  REDEFINES                         05530002
033100             DTL-HDR-01-PM-DEPT.                                  05540002
033200             15  FILLER               PIC X(01).                  05550001
033300             15  DTL-HDR-01-HEADING-TITLE                         05560001
033400                                      PIC X(37).                  05570005
033500     05  FILLER                       PIC X(212) VALUE SPACES.    05580005
033600                                                                  05590001
033601 01  DETAIL-HEADER-02.                                            05600005
033610     05  DTL-HDR-02-MISC.                                         05610005
033620         10  DTL-HDR-02-PM-MISC.                                  05620005
033621             15  FILLER               PIC X(01) VALUE SPACES.     05630005
033630             15  FILLER               PIC X(14) VALUE             05640005
033640                 '--------------'.                                05650005
033697     05  FILLER                       PIC X(235) VALUE SPACES.    05660005
033698                                                                  05670005
033700 01  DETAIL-VARIABLE.                                             05680001
033800     05  FILLER                       PIC X(01)  VALUE SPACES.    05690001
033900     05  DTL-VAR-VOL-PCT-CHG          PIC ZZZ9.9.                 05700036
033910     05  DTL-VAR-VOL-PCT-CHG1 REDEFINES                           05710036
033920         DTL-VAR-VOL-PCT-CHG          PIC ZZZZ.Z.                 05720036
034000     05  FILLER                       PIC X(01)  VALUE SPACES.    05730001
034100                                                                  05740001
034200 01  DETAIL-01.                                                   05750001
034300     05  FILLER                       PIC X(01)  VALUE SPACES.    05760001
034400     05  DTL-01-PMITEM-DESC           PIC X(50).                  05770001
034500     05  FILLER                       PIC X(01)  VALUE SPACES.    05780001
034510     05  DTL-01-AD-PG-NBR             PIC ZZZ.                    05790006
034520     05  FILLER                       PIC X(01)  VALUE SPACES.    05800006
034600     05  DTL-01-AD-SPC-CDE            PIC X(04).                  05810001
034700     05  FILLER                       PIC X(02)  VALUE SPACES.    05820028
034800     05  DTL-01-ACTL-SLS-RTL-AMT      PIC ZZZ,ZZ9.99.             05830036
034810     05  DTL-01-ACTL-SLS-RTL-AMT1 REDEFINES                       05840036
034820         DTL-01-ACTL-SLS-RTL-AMT      PIC ZZZ,ZZZ.ZZ.             05850036
034900     05  FILLER                       PIC X(02)  VALUE SPACES.    05860028
035000     05  DTL-01-FCST-SLS-RTL-AMT      PIC ZZZ,ZZZ.ZZ.             05870028
035100     05  FILLER                       PIC X(02)  VALUE SPACES.    05880024
035200     05  DTL-01-VOL-PCT-CHG           PIC X(08)  VALUE SPACES.    05890024
035300     05  DTL-01-VOL-PCT-SIGN          PIC X(01)  VALUE SPACES.    05900001
035400     05  FILLER                       PIC X(02)  VALUE SPACES.    05910028
035500     05  DTL-01-ACTL-MD-AMT           PIC ZZZ,ZZ9.99.             05920036
035510     05  DTL-01-ACTL-MD-AMT1 REDEFINES                            05930036
035520         DTL-01-ACTL-MD-AMT           PIC ZZZ,ZZZ.ZZ.             05940036
035600     05  FILLER                       PIC X(02)  VALUE SPACES.    05950028
035700     05  DTL-01-FCST-MD-AMT           PIC ZZZ,ZZZ.ZZ.             05960028
035800     05  FILLER                       PIC X(02)  VALUE SPACES.    05970028
035900     05  DTL-01-ACTL-UNT-SLD-QTY      PIC ZZZ,ZZ9.99.             05980036
035910     05  DTL-01-ACTL-UNT-SLD-QTY1 REDEFINES                       05990036
035920         DTL-01-ACTL-UNT-SLD-QTY      PIC ZZZ,ZZZ.ZZ.             06000036
036000     05  FILLER                       PIC X(02)  VALUE SPACES.    06010028
036100     05  DTL-01-FCST-UNT-SLD-QTY      PIC ZZZ,ZZZ.ZZ.             06020028
036200     05  FILLER                       PIC X(02)  VALUE SPACES.    06030028
036300     05  DTL-01-ACTL-PREP-UNT-QTY     PIC ZZZ,ZZ9.99.             06040036
036310     05  DTL-01-ACTL-PREP-UNT-QTY1 REDEFINES                      06050036
036320         DTL-01-ACTL-PREP-UNT-QTY     PIC ZZZ,ZZZ.ZZ.             06060036
036400     05  FILLER                       PIC X(02)  VALUE SPACES.    06070028
036500     05  DTL-01-FCST-PREP-UNT-QTY     PIC ZZZ,ZZZ.ZZ.             06080028
036600     05  FILLER                       PIC X(03)  VALUE SPACES.    06090001
036700     05  DTL-01-SELL-THRU-PCT         PIC ZZ9.9.                  06100036
036710     05  DTL-01-SELL-THRU-PCT1 REDEFINES                          06110036
036720         DTL-01-SELL-THRU-PCT         PIC ZZZ.Z.                  06120036
036800     05  DTL-O1-SELL-PCT-SIGN         PIC X(01)  VALUE SPACES.    06130001
036810     05  FILLER                       PIC X(02)  VALUE SPACES.    06140028
036820     05  DTL-01-ACTL-COST-AMT         PIC ZZZ,ZZ9.99.             06150036
036821     05  DTL-01-ACTL-COST-AMT1 REDEFINES                          06160036
036822         DTL-01-ACTL-COST-AMT         PIC ZZZ,ZZZ.ZZ.             06170036
036830     05  FILLER                       PIC X(02)  VALUE SPACES.    06180028
036840     05  DTL-01-FCST-COST-AMT         PIC ZZZ,ZZZ.ZZ.             06190028
036850     05  FILLER                       PIC X(01)  VALUE SPACES.    06200006
036860     05  DTL-01-ACTL-MU-PCT           PIC ZZ9.9.                  06210036
036861     05  DTL-01-ACTL-MU-PCT1 REDEFINES                            06220036
036862         DTL-01-ACTL-MU-PCT           PIC ZZZ.Z.                  06230036
036870     05  DTL-01-ACTL-PCT-SIGN         PIC X(01)  VALUE SPACES.    06240001
036880     05  FILLER                       PIC X(01)  VALUE SPACES.    06250006
036890     05  DTL-01-FCST-MU-PCT           PIC ZZ9.9.                  06260036
036891     05  DTL-01-FCST-MU-PCT1 REDEFINES                            06270036
036892         DTL-01-FCST-MU-PCT           PIC ZZZ.Z.                  06280036
036900     05  DTL-01-FCST-PCT-SIGN         PIC X(01)  VALUE SPACES.    06290001
PM3403     05  FILLER                       PIC X(01)  VALUE SPACES.    06300039
PM3403*    05  DTL-01-MIN-RTL-PRC           PIC ZZZZ.ZZ.                06310038
PM3403     05  DTL-01-MIN-RTL-PRC           PIC ZZZZZ.ZZ.               06320038
PM3403*    05  FILLER                       PIC X(01)  VALUE SPACES.    06330039
037300     05  DTL-01-RTL-DASH              PIC X(01)  VALUE SPACES.    06340001
PM3403*    05  DTL-01-MAX-RTL-PRC           PIC ZZZZ.ZZ.                06350038
PM3403     05  DTL-01-MAX-RTL-PRC           PIC ZZZZZ.ZZ.               06360038
PM3403     05  FILLER                       PIC X(01)  VALUE SPACES.    06370039
PM3403*    05  DTL-01-MIN-PROMO-PRC         PIC ZZZZ.ZZ.                06380038
PM3403     05  DTL-01-MIN-PROMO-PRC         PIC ZZZZZ.ZZ.               06390038
PM3403*    05  FILLER                       PIC X(01)  VALUE SPACES.    06400039
037620     05  DTL-01-PRM-DASH              PIC X(01)  VALUE SPACES.    06410001
PM3403*    05  DTL-01-MAX-PROMO-PRC         PIC ZZZZ.ZZ.                06420038
PM3403     05  DTL-01-MAX-PROMO-PRC         PIC ZZZZZ.ZZ.               06430038
PM3403*    05  FILLER                       PIC X(01)  VALUE SPACES.    06440038
037650                                                                  06450001
037800 01  DETAIL-02.                                                   06460030
037810     05  FILLER                       PIC X(01)  VALUE SPACES.    06470030
037820     05  DTL-02-DTES.                                             06480030
037830         10  DTL-02-EFF-DTES          PIC X(36)  VALUE SPACES.    06490030
037831         10  FILLER                   PIC X(26)  VALUE SPACES.    06500030
037832     05  DTL-02-VERSIONS                                          06510030
037833         REDEFINES DTL-02-DTES.                                   06520030
037834         10  FILLER                   PIC X(02).                  06530030
037835         10  DTL-01-VERSION-AD        PIC X(60).                  06540030
037836     05  FILLER                       PIC X(205) VALUE SPACES.    06550030
037837                                                                  06560030
037838 01  DETAIL-PM-TOTALS.                                            06570006
037839     05  DTL-ADV.                                                 06580001
037840         10  DTL-ADV-TITLE.                                       06590001
037841             15  FILLER               PIC X(01).                  06600001
037842             15  DTL-ADV-PM-TITLE     PIC X(16).                  06610002
037843             15  FILLER               PIC X(01).                  06620002
037844             15  DTL-ADV-PM-DEPT      PIC 9(04).                  06630005
037845             15  FILLER               PIC X(02).                  06640006
PGNBR          10  DTL-ADVNO-TITLE REDEFINES                            06650040
PGNBR              DTL-ADV-TITLE.                                       06660040
PGNBR              15  FILLER               PIC X(01).                  06670040
PGNBR              15  DTL-ADVNO-PM-TITLE   PIC X(18).                  06680040
PGNBR              15  FILLER               PIC X(01).                  06690040
PGNBR              15  DTL-ADVNO-PM-DEPT    PIC 9(04).                  06700040
037846         10  DTL-UNADV-TITLE REDEFINES                            06701040
037847             DTL-ADV-TITLE.                                       06702040
037848             15  FILLER               PIC X(01).                  06703040
037849             15  DTL-UNADV-PM-TITLE   PIC X(18).                  06704040
037850             15  FILLER               PIC X(01).                  06705040
037851             15  DTL-UNADV-PM-DEPT    PIC 9(04).                  06706040
037852     05  FILLER                       PIC X(38)  VALUE SPACES.    06710028
037853     05  DTL-PM-TOT-ACTL-SLS-AMT      PIC ZZZ,ZZ9.99.             06720036
037854     05  DTL-PM-TOT-ACTL-SLS-AMT1 REDEFINES                       06730036
037855         DTL-PM-TOT-ACTL-SLS-AMT      PIC ZZZ,ZZZ.ZZ.             06740036
037860     05  FILLER                       PIC X(02)  VALUE SPACES.    06750028
037870     05  DTL-PM-TOT-FCST-SLS-AMT      PIC ZZZ,ZZZ.ZZ.             06760028
037871     05  FILLER                       PIC X(02)  VALUE SPACES.    06770024
037872     05  DTL-PM-TOT-VOL-PCT-CHG       PIC X(08)  VALUE SPACES.    06780024
037873     05  DTL-PM-VOL-PCT-SIGN          PIC X(01)  VALUE SPACES.    06790006
037874     05  FILLER                       PIC X(02)  VALUE SPACES.    06800028
037875     05  DTL-PM-TOT-ACTL-MD-AMT       PIC ZZZ,ZZ9.99.             06810036
037876     05  DTL-PM-TOT-ACTL-MD-AMT1 REDEFINES                        06820036
037877         DTL-PM-TOT-ACTL-MD-AMT       PIC ZZZ,ZZZ.ZZ.             06830036
037878     05  FILLER                       PIC X(02)  VALUE SPACES.    06840028
037879     05  DTL-PM-TOT-FCST-MD-AMT       PIC ZZZ,ZZZ.ZZ.             06850028
037880     05  FILLER                       PIC X(02)  VALUE SPACES.    06860028
037881     05  DTL-PM-TOT-ACTL-UNT-QTY      PIC ZZZ,ZZ9.99.             06870036
037882     05  DTL-PM-TOT-ACTL-UNT-QTY1 REDEFINES                       06880036
037883         DTL-PM-TOT-ACTL-UNT-QTY      PIC ZZZ,ZZZ.ZZ.             06890036
037884     05  FILLER                       PIC X(02)  VALUE SPACES.    06900028
037885     05  DTL-PM-TOT-FCST-UNT-QTY      PIC ZZZ,ZZZ.ZZ.             06910028
037886     05  FILLER                       PIC X(02)  VALUE SPACES.    06920028
037887     05  DTL-PM-TOT-ACTL-PREP-QTY     PIC ZZZ,ZZ9.99.             06930036
037888     05  DTL-PM-TOT-ACTL-PREP-QTY1 REDEFINES                      06940036
037889         DTL-PM-TOT-ACTL-PREP-QTY     PIC ZZZ,ZZZ.ZZ.             06950036
037890     05  FILLER                       PIC X(02)  VALUE SPACES.    06960028
037891     05  DTL-PM-TOT-FCST-PREP-QTY     PIC ZZZ,ZZZ.ZZ.             06970028
037892     05  FILLER                       PIC X(03)  VALUE SPACES.    06980001
037893     05  DTL-PM-TOT-SELL-THRU-PCT     PIC ZZ9.9.                  06990036
037894     05  DTL-PM-TOT-SELL-THRU-PCT1 REDEFINES                      07000036
037895         DTL-PM-TOT-SELL-THRU-PCT     PIC ZZZ.Z.                  07010036
037896     05  DTL-PM-SELL-PCT-SIGN         PIC X(01)  VALUE SPACES.    07020006
037897     05  FILLER                       PIC X(02)  VALUE SPACES.    07030028
037898     05  DTL-PM-TOT-ACTL-COST-AMT     PIC ZZZ,ZZ9.99.             07040036
037899     05  DTL-PM-TOT-ACTL-COST-AMT1 REDEFINES                      07050036
037900         DTL-PM-TOT-ACTL-COST-AMT     PIC ZZZ,ZZZ.ZZ.             07060036
037901     05  FILLER                       PIC X(02)  VALUE SPACES.    07070028
037902     05  DTL-PM-TOT-FCST-COST-AMT     PIC ZZZ,ZZZ.ZZ.             07080028
037903     05  FILLER                       PIC X(01)  VALUE SPACES.    07090006
037904     05  DTL-PM-TOT-ACTL-MU-PCT       PIC ZZ9.9.                  07100036
037905     05  DTL-PM-TOT-ACTL-MU-PCT1 REDEFINES                        07110036
037906         DTL-PM-TOT-ACTL-MU-PCT       PIC ZZZ.Z.                  07120036
037907     05  DTL-PM-ACTL-PCT-SIGN         PIC X(01)  VALUE SPACES.    07130006
037908     05  FILLER                       PIC X(01)  VALUE SPACES.    07140006
037909     05  DTL-PM-TOT-FCST-MU-PCT       PIC ZZ9.9.                  07150036
037910     05  DTL-PM-TOT-FCST-MU-PCT1 REDEFINES                        07160036
037911         DTL-PM-TOT-FCST-MU-PCT       PIC ZZZ.Z.                  07170036
037912     05  DTL-PM-FCST-PCT-SIGN         PIC X(01)  VALUE SPACES.    07180006
037913     05  FILLER                       PIC X(36)  VALUE SPACES.    07190006
037920                                                                  07200001
037967 01  DETAIL-BUY-TOTALS.                                           07210002
037968     05  DTL-BUY.                                                 07220002
037969         10  DTL-BUY-TITLE.                                       07230002
037970             15  FILLER               PIC X(01).                  07240002
037971             15  DTL-BUY-PM-TITLE     PIC X(22).                  07250007
037972             15  FILLER               PIC X(01).                  07260002
037973             15  DTL-BUY-PM-BUYER     PIC 9(04).                  07270002
037974             15  FILLER               PIC X(02).                  07280002
PGNBR          10  DTL-BUY-ANP-TITLE REDEFINES                          07281041
PGNBR              DTL-BUY-TITLE.                                       07281141
PGNBR              15  FILLER               PIC X(01).                  07282041
PGNBR              15  DTL-BUYER-ANP-TITLE  PIC X(24).                  07283041
PGNBR              15  FILLER               PIC X(01).                  07284041
PGNBR              15  DTL-BUY-ANP-BUYER    PIC 9(04).                  07285041
037975         10  DTL-BUY-UNADV-TITLE REDEFINES                        07290002
037976             DTL-BUY-TITLE.                                       07300002
037977             15  FILLER               PIC X(01).                  07310002
037978             15  DTL-BUYER-UNADV-TITLE                            07320009
037979                                      PIC X(24).                  07330009
037980             15  FILLER               PIC X(01).                  07340002
037981             15  DTL-BUY-UNADV-BUYER  PIC 9(04).                  07350002
037982     05  FILLER                       PIC X(32)  VALUE SPACES.    07360028
037983     05  DTL-BUY-TOT-ACTL-SLS-AMT     PIC ZZZ,ZZ9.99.             07370036
037984     05  DTL-BUY-TOT-ACTL-SLS-AMT1 REDEFINES                      07380036
037985         DTL-BUY-TOT-ACTL-SLS-AMT     PIC ZZZ,ZZZ.ZZ.             07390036
037986     05  FILLER                       PIC X(02)  VALUE SPACES.    07400028
037987     05  DTL-BUY-TOT-FCST-SLS-AMT     PIC ZZZ,ZZZ.ZZ.             07410028
037988     05  FILLER                       PIC X(02)  VALUE SPACES.    07420024
037989     05  DTL-BUY-TOT-VOL-PCT-CHG      PIC X(08)  VALUE SPACES.    07430024
037990     05  DTL-BUY-VOL-PCT-SIGN         PIC X(01)  VALUE SPACES.    07440002
037991     05  FILLER                       PIC X(02)  VALUE SPACES.    07450028
037992     05  DTL-BUY-TOT-ACTL-MD-AMT      PIC ZZZ,ZZ9.99.             07460036
037993     05  DTL-BUY-TOT-ACTL-MD-AMT1 REDEFINES                       07470036
037994         DTL-BUY-TOT-ACTL-MD-AMT      PIC ZZZ,ZZZ.ZZ.             07480036
037995     05  FILLER                       PIC X(02)  VALUE SPACES.    07490028
037996     05  DTL-BUY-TOT-FCST-MD-AMT      PIC ZZZ,ZZZ.ZZ.             07500028
037997     05  FILLER                       PIC X(02)  VALUE SPACES.    07510028
037998     05  DTL-BUY-TOT-ACTL-UNT-QTY     PIC ZZZ,ZZ9.99.             07520036
037999     05  DTL-BUY-TOT-ACTL-UNT-QTY1 REDEFINES                      07530036
038000         DTL-BUY-TOT-ACTL-UNT-QTY     PIC ZZZ,ZZZ.ZZ.             07540036
038001     05  FILLER                       PIC X(02)  VALUE SPACES.    07550028
038002     05  DTL-BUY-TOT-FCST-UNT-QTY     PIC ZZZ,ZZZ.ZZ.             07560028
038003     05  FILLER                       PIC X(02)  VALUE SPACES.    07570028
038004     05  DTL-BUY-TOT-ACTL-PREP-QTY    PIC ZZZ,ZZ9.99.             07580036
038005     05  DTL-BUY-TOT-ACTL-PREP-QTY1 REDEFINES                     07590036
038006         DTL-BUY-TOT-ACTL-PREP-QTY    PIC ZZZ,ZZ9.99.             07600036
038007     05  FILLER                       PIC X(02)  VALUE SPACES.    07610028
038008     05  DTL-BUY-TOT-FCST-PREP-QTY    PIC ZZZ,ZZZ.ZZ.             07620028
038009     05  FILLER                       PIC X(03)  VALUE SPACES.    07630002
038010     05  DTL-BUY-TOT-SELL-THRU-PCT    PIC ZZ9.9.                  07640036
038011     05  DTL-BUY-TOT-SELL-THRU-PCT1 REDEFINES                     07650036
038012         DTL-BUY-TOT-SELL-THRU-PCT    PIC ZZZ.Z.                  07660036
038013     05  DTL-BUY-SELL-PCT-SIGN        PIC X(01)  VALUE SPACES.    07670002
038014     05  FILLER                       PIC X(02)  VALUE SPACES.    07680028
038015     05  DTL-BUY-TOT-ACTL-COST-AMT    PIC ZZZ,ZZ9.99.             07690036
038016     05  DTL-BUY-TOT-ACTL-COST-AMT1 REDEFINES                     07700036
038017         DTL-BUY-TOT-ACTL-COST-AMT    PIC ZZZ,ZZZ.ZZ.             07710036
038018     05  FILLER                       PIC X(02)  VALUE SPACES.    07720028
038019     05  DTL-BUY-TOT-FCST-COST-AMT    PIC ZZZ,ZZZ.ZZ.             07730028
038020     05  FILLER                       PIC X(01)  VALUE SPACES.    07740006
038021     05  DTL-BUY-TOT-ACTL-MU-PCT      PIC ZZ9.9.                  07750036
038022     05  DTL-BUY-TOT-ACTL-MU-PCT1 REDEFINES                       07760036
038023         DTL-BUY-TOT-ACTL-MU-PCT      PIC ZZZ.Z.                  07770036
038024     05  DTL-BUY-ACTL-PCT-SIGN        PIC X(01)  VALUE SPACES.    07780002
038025     05  FILLER                       PIC X(01)  VALUE SPACES.    07790006
038026     05  DTL-BUY-TOT-FCST-MU-PCT      PIC ZZ9.9.                  07800036
038027     05  DTL-BUY-TOT-FCST-MU-PCT1 REDEFINES                       07810036
038028         DTL-BUY-TOT-FCST-MU-PCT      PIC ZZZ.Z.                  07820036
038029     05  DTL-BUY-FCST-PCT-SIGN        PIC X(01)  VALUE SPACES.    07830002
038030     05  FILLER                       PIC X(36)  VALUE SPACES.    07840006
038031                                                                  07850002
038032 01  DETAIL-TTL-TOTALS.                                           07860002
038033     05  DTL-TTL-PAGE.                                            07870002
038034         10  DTL-TTL-TITLE.                                       07880002
038035             15  FILLER               PIC X(01).                  07890002
038036             15  DTL-TTL-PM-TITLE     PIC X(05).                  07900002
038037             15  FILLER               PIC X(01).                  07910002
038038             15  DTL-TTL-DEPT-NBR     PIC 9(04).                  07920002
038039             15  FILLER               PIC X(06).                  07930002
038040         10  DTL-TTL-BUY-TITLE REDEFINES                          07940002
038041             DTL-TTL-TITLE.                                       07950002
038042             15  FILLER               PIC X(01).                  07960002
038043             15  DTL-TTL-BUYER-TITLE  PIC X(11).                  07970008
038044             15  FILLER               PIC X(01).                  07980002
038045             15  DTL-TTL-BUY-NBR      PIC 9(04).                  07990002
038046     05  FILLER                       PIC X(45)  VALUE SPACES.    08000028
038047     05  DTL-TTL-ACTL-TOT-SLS-AMT     PIC ZZZ,ZZ9.99.             08010036
038048     05  DTL-TTL-ACTL-TOT-SLS-AMT1 REDEFINES                      08020036
038049         DTL-TTL-ACTL-TOT-SLS-AMT     PIC ZZZ,ZZZ.ZZ.             08030036
038050     05  FILLER                       PIC X(02)  VALUE SPACES.    08040028
038051     05  DTL-TTL-FCST-TOT-SLS-AMT     PIC ZZZ,ZZZ.ZZ.             08050028
038052     05  FILLER                       PIC X(02)  VALUE SPACES.    08060024
038053     05  DTL-TTL-TOT-VOL-PCT-CHG      PIC X(08)  VALUE SPACES.    08070024
038054     05  DTL-TTL-VOL-PCT-SIGN         PIC X(01)  VALUE SPACES.    08080002
038055     05  FILLER                       PIC X(02)  VALUE SPACES.    08090028
038056     05  DTL-TTL-TOT-ACTL-MD-AMT      PIC ZZZ,ZZ9.99.             08100036
038057     05  DTL-TTL-TOT-ACTL-MD-AMT1 REDEFINES                       08110036
038058         DTL-TTL-TOT-ACTL-MD-AMT      PIC ZZZ,ZZZ.ZZ.             08120036
038059     05  FILLER                       PIC X(02)  VALUE SPACES.    08130028
038060     05  DTL-TTL-TOT-FCST-MD-AMT      PIC ZZZ,ZZZ.ZZ.             08140028
038061     05  FILLER                       PIC X(02)  VALUE SPACES.    08150028
038062     05  DTL-TTL-TOT-ACTL-UNT-QTY     PIC ZZZ,ZZ9.99.             08160036
038063     05  DTL-TTL-TOT-ACTL-UNT-QTY1 REDEFINES                      08170036
038064         DTL-TTL-TOT-ACTL-UNT-QTY     PIC ZZZ,ZZZ.ZZ.             08180036
038065     05  FILLER                       PIC X(02)  VALUE SPACES.    08190028
038066     05  DTL-TTL-TOT-FCST-UNT-QTY     PIC ZZZ,ZZZ.ZZ.             08200028
038067     05  FILLER                       PIC X(02)  VALUE SPACES.    08210028
038068     05  DTL-TTL-TOT-ACTL-PREP-QTY    PIC ZZZ,ZZ9.99.             08220036
038069     05  DTL-TTL-TOT-ACTL-PREP-QTY1 REDEFINES                     08230036
038070         DTL-TTL-TOT-ACTL-PREP-QTY    PIC ZZZ,ZZZ.ZZ.             08240036
038071     05  FILLER                       PIC X(02)  VALUE SPACES.    08250028
038072     05  DTL-TTL-TOT-FCST-PREP-QTY    PIC ZZZ,ZZZ.ZZ.             08260028
038073     05  FILLER                       PIC X(03)  VALUE SPACES.    08270002
038074     05  DTL-TTL-TOT-SELL-THRU-PCT    PIC ZZ9.9.                  08280036
038075     05  DTL-TTL-TOT-SELL-THRU-PCT1 REDEFINES                     08290036
038076         DTL-TTL-TOT-SELL-THRU-PCT    PIC ZZZ.Z.                  08300036
038077     05  DTL-TTL-SELL-PCT-SIGN        PIC X(01)  VALUE SPACES.    08310002
038078     05  FILLER                       PIC X(02)  VALUE SPACES.    08320028
038079     05  DTL-TTL-TOT-ACTL-COST-AMT    PIC ZZZ,ZZ9.99.             08330036
038080     05  DTL-TTL-TOT-ACTL-COST-AMT1 REDEFINES                     08340036
038081         DTL-TTL-TOT-ACTL-COST-AMT    PIC ZZZ,ZZZ.ZZ.             08350036
038082     05  FILLER                       PIC X(02)  VALUE SPACES.    08360028
038083     05  DTL-TTL-TOT-FCST-COST-AMT    PIC ZZZ,ZZZ.ZZ.             08370028
038084     05  FILLER                       PIC X(01)  VALUE SPACES.    08380006
038085     05  DTL-TTL-TOT-ACTL-MU-PCT      PIC ZZ9.9.                  08390036
038086     05  DTL-TTL-TOT-ACTL-MU-PCT1 REDEFINES                       08400036
038087         DTL-TTL-TOT-ACTL-MU-PCT      PIC ZZZ.Z.                  08410036
038088     05  DTL-TTL-ACTL-PCT-SIGN        PIC X(01)  VALUE SPACES.    08420002
038089     05  FILLER                       PIC X(01)  VALUE SPACES.    08430006
038090     05  DTL-TTL-TOT-FCST-MU-PCT      PIC ZZ9.9.                  08440036
038091     05  DTL-TTL-TOT-FCST-MU-PCT1 REDEFINES                       08450036
038092         DTL-TTL-TOT-FCST-MU-PCT      PIC ZZZ.Z.                  08460036
038093     05  DTL-TTL-FCST-PCT-SIGN        PIC X(01)  VALUE SPACES.    08470002
038094     05  FILLER                       PIC X(36)  VALUE SPACES.    08480006
038095                                                                  08490002
038101*----------------------------------------------------------       08500001
038102* COPYBOOK FOR THE PROMO ITEM SUMMARY EXTRACT - INPUT             08510001
038103*----------------------------------------------------------       08520001
038104     COPY PMRD100.                                                08530001
038105                                                                  08540001
038106*----------------------------------------------------------       08550001
038107*  DATE VALIDATION CALLING PARAMETER LIST                         08560001
038108*----------------------------------------------------------       08570001
038109     COPY DPWS500.                                                08580001
038110                                                                  08590001
038111*----------------------------------------------------------       08600001
038112*  STANDARD HEADER LINE - KOHLS 250 COL                           08610001
038113*----------------------------------------------------------       08620001
038114     COPY DPWS250O.                                               08630001
038115     EJECT                                                        08640001
038116                                                                  08650001
038117*----------------------------------------------------------       08660001
038118 PROCEDURE DIVISION.                                              08670001
038119*----------------------------------------------------------       08680001
038120 0000-MAINLINE.                                                   08690001
038121                                                                  08700001
038122     PERFORM 1000-INITIALIZATION.                                 08710001
038123                                                                  08720001
038124     PERFORM 2000-PROCESS-SALES-RESULTS                           08730001
038125             UNTIL PS-EOF-SALES-RESULTS.                          08740001
038130                                                                  08750001
038200     PERFORM 3000-END-OF-JOB-ROUTINE.                             08760001
038300                                                                  08770001
038400     GOBACK.                                                      08780001
038500                                                                  08790001
038600*0000-EXIT.                                                       08800001
038700 EJECT.                                                           08810001
038800                                                                  08820001
038900*----------------------------------------------------------       08830001
039000* 1000-INITIALIZATION.                                            08840001
039100*     INITIALIZATION AREA - INITIALIZES ALL VARIABLES, OPENS      08850001
039200*     FILES, READS INPUT FILES, AND PROCESSES ANY INPUT FILE      08860001
039300*     PARAMETERS IT MAY NEED TO USE TO READ AND PROCESS           08870001
039400*     ANY OF THE RECORDS FROM THE INPUT FILE.                     08880001
039500*----------------------------------------------------------       08890001
039600 1000-INITIALIZATION.                                             08900001
039700                                                                  08910001
039800     INITIALIZE PM100-PROMO-ITM-SUMM                              08920001
039900                TBL-SECT-TOTAL-TABLE                              08930001
040000                TBL-DEPT-TOTAL-TABLE                              08940006
040010                TBL-BUYADV-TOTAL-TABLE                            08950006
040020                TBL-BUYUNADV-TOTAL-TABLE                          08960006
PGNBR                 TBL-BUYADNP-TOTAL-TABLE                           08961044
040030                TBL-BUYER-TOTAL-TABLE.                            08970006
040100                                                                  08980001
040110     SET PS-FIRST-TIME TO TRUE.                                   08990022
040120                                                                  09000022
040200     OPEN INPUT PROMO-ITM-SUMM-FILE                               09010001
040300         OUTPUT PROMO-ITM-SUMM-REPORT.                            09020001
040400                                                                  09030001
040500     ACCEPT CD-CPU-DATE FROM DATE.                                09040001
040600     MOVE CD-CPU-YR                  TO CD-CPU-YY.                09050001
040700     MOVE CD-CPU-MO                  TO CD-CPU-MM.                09060001
040710     MOVE CD-CPU-DY                  TO CD-CPU-DD.                09070001
040720                                                                  09080001
040721     INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              09090001
040722     SET DPG51-ACTUAL-CALENDAR-ONLY  TO TRUE.                     09100001
040723     SET DPG51-DO-NOT-INCR-DECR-DATE TO TRUE.                     09110001
040724     SET DPG52-LK-DTE-GREG           TO TRUE.                     09120001
040725     MOVE CD-CPU-DATE-GREG           TO DPG52-LK-DATE-INPUT.      09130001
040726     MOVE 'INVALID CONVERT OF CURRENT DATE FROM CPU'              09140001
040727                                     TO PV-OPERATION-MSG-1.       09150001
040728                                                                  09160001
040729     PERFORM 9100-CALENDAR-ROUTINE.                               09170001
040730                                                                  09180001
040740     MOVE DPG55-DB2-ISO-DATE-FMT     TO CD-CPU-DATE-ISO.          09190001
040750                                                                  09200001
040760     ACCEPT CT-CPU-TIME FROM TIME.                                09210001
040770     MOVE CT-CPU-HR                  TO DP250O-RUN-HOUR.          09220001
040780     MOVE CT-CPU-MIN                 TO DP250O-RUN-MINUTE.        09230001
040790     MOVE CD-CPU-MO                  TO DP250O-RUN-MONTH.         09240001
040800     MOVE CD-CPU-DY                  TO DP250O-RUN-DAY.           09250001
040900     MOVE CD-CPU-YR                  TO DP250O-RUN-YEAR.          09260001
041000     MOVE PC-CURRENT-PROGRAM-NAME    TO DP250O-PROGRAM-NAME.      09270001
041100                                                                  09280001
041200     PERFORM 8000-READ-SALES-RESULTS.                             09290001
041300                                                                  09300001
041400     IF PS-EOF-SALES-RESULTS                                      09310001
041500        DISPLAY 'NO PROMO ITEMS TO REPORT ON'                     09320001
041600     ELSE                                                         09330001
041800        EVALUATE TRUE                                             09340001
041900          WHEN PM100-ACTUAL                                       09350001
042000               MOVE PC-ACTUAL-RSLT   TO HDR-01-TITLE              09360001
042100          WHEN PM100-FORECAST                                     09370001
042200               MOVE PC-FORECAST-RSLT TO HDR-01-TITLE              09380001
042300          WHEN OTHER                                              09390001
042400               DISPLAY 'PM100-FCST-ACTUAL-IND: '                  09400001
042500                              PM100-FCST-ACTUAL-IND               09410001
042600               SET ABEND-4444-FORCED-ABEND TO TRUE                09420001
042700               MOVE '1000-INITIALIZATION' TO PV-PARAGRAPH-NAME    09430001
042800               MOVE 'NOT A VALID FORECAST/ACTUAL IND'             09440001
042900                                       TO PV-OPERATION-MSG-1      09450001
043000               PERFORM 9800-ABEND                                 09460001
043100        END-EVALUATE                                              09470001
043200     END-IF.                                                      09480001
043300                                                                  09490001
043400*1000-EXIT.                                                       09500001
043500 EJECT.                                                           09510001
043600                                                                  09520001
043700*----------------------------------------------------------       09530001
043800* 2000-PROCESS-SALES-RESULTS.                                     09540001
043900*     PROCESSES THE SALES RESULTS FILE AND CREATES A              09550001
044000*     A REPORT. THIS REPORT BREAKS BY AD EVENT/PROMOTION/ BUYER.  09560031
044100*     WITHIN EACH PROMOTION/BUYER THE REPORT WILL BREAK           09570031
044200*     BY DEPARTMENT.  EACH DEPARTMENT WILL THEN SEPERATE          09580031
044300*     ADVERTISED(PAGE NUMBER) AND UNADVERTISED PROMO ITEMS.       09590031
044500*----------------------------------------------------------       09600001
044600 2000-PROCESS-SALES-RESULTS.                                      09610001
044700                                                                  09620001
044800     EVALUATE TRUE                                                09630001
044801       WHEN (PM100-AD-EVNT-ID IS NOT = PV-LAST-ADEVNT-ID)         09640016
044802         OR (PM100-PROMO-ID IS NOT = PV-LAST-PROMO-ID)            09650016
044810         OR (PM100-BYR-NBR IS NOT = PV-LAST-BUYER-NBR)            09660016
044820            IF PS-NOT-FIRST-TIME                                  09670006
044821               PERFORM 3100-PROCESS-SECT-TTL                      09680006
044822               PERFORM 3110-PROCESS-DEPT-TTL                      09690006
044830               PERFORM 3120-PROCESS-ADV-PROMO-TTL                 09700006
PGNBR                PERFORM 3030-PROCESS-ADV-NOPGE-TTL                 09701041
044840               PERFORM 3130-PROCESS-UNADV-PROMO-TTL               09710006
044891               PERFORM 3140-PROCESS-BUYER-TTL                     09720006
044895               INITIALIZE TBL-SECT-TOTAL-TABLE                    09730006
044896                          TBL-DEPT-TOTAL-TABLE                    09740006
044897                          TBL-BUYADV-TOTAL-TABLE                  09750006
PGNBR                           TBL-BUYADNP-TOTAL-TABLE                 09751041
044898                          TBL-BUYUNADV-TOTAL-TABLE                09760006
044899                          TBL-BUYER-TOTAL-TABLE                   09770006
044900            END-IF                                                09780006
044901            PERFORM 2300-FORMAT-HEADING-FIELDS                    09790006
044902            PERFORM 2100-ADEVNT-PROMO-HDR-BREAK                   09800006
044903            PERFORM 2400-CREATE-HEADING-FIELDS                    09810006
044904            PERFORM 3400-PROCESS-ADV-UNADV-LINES                  09820011
044905            PERFORM 3600-PROCESS-PAGE-HEADER                      09830006
044906            PERFORM 3500-PROCESS-DETAIL-HEADER                    09840008
044907            MOVE PM100-AD-EVNT-ID TO PV-LAST-ADEVNT-ID            09850006
044908            MOVE PM100-PROMO-ID   TO PV-LAST-PROMO-ID             09860006
044909            MOVE PM100-BYR-NBR    TO PV-LAST-BUYER-NBR            09870006
044910            MOVE PM100-AD-PG-NBR  TO PV-AD-PG-NBR                 09880006
044911            MOVE PM100-DEPT-NBR   TO PV-LAST-DEPT-NBR             09890006
044912            SET PS-NOT-FIRST-TIME TO TRUE                         09900006
047000       WHEN (PM100-DEPT-NBR IS NOT = PV-LAST-DEPT-NBR)            09910003
047192            PERFORM 3100-PROCESS-SECT-TTL                         09920006
047193            PERFORM 3110-PROCESS-DEPT-TTL                         09930006
047194            INITIALIZE TBL-SECT-TOTAL-TABLE                       09940006
047300                       TBL-DEPT-TOTAL-TABLE                       09950006
047400            MOVE PM100-DEPT-NBR    TO PV-LAST-DEPT-NBR            09960004
047410            MOVE PM100-AD-PG-NBR   TO PV-AD-PG-NBR                09970004
047420            PERFORM 3400-PROCESS-ADV-UNADV-LINES                  09980011
047500            PERFORM 3500-PROCESS-DETAIL-HEADER                    09990008
047600       WHEN (PM100-AD-PG-NBR NOT = PV-AD-PG-NBR)                  10000004
PGNBR         AND (PM100-PROMO-ITM-ADV-IND = 'Y')                       10010041
047900            PERFORM 3100-PROCESS-SECT-TTL                         10020006
048000            INITIALIZE TBL-SECT-TOTAL-TABLE                       10030004
048100            MOVE PM100-AD-PG-NBR   TO PV-AD-PG-NBR                10040004
048101            MOVE +2                TO PV-SAVE-SKIP-LINES          10050021
048110            PERFORM 3400-PROCESS-ADV-UNADV-LINES                  10060011
048400     END-EVALUATE.                                                10070001
048500     PERFORM 2200-PROCESS-DETAIL.                                 10080001
048600                                                                  10090001
048700     PERFORM 8000-READ-SALES-RESULTS.                             10100001
048800                                                                  10110001
048900*2000-EXIT.                                                       10120001
049000 EJECT.                                                           10130001
049100                                                                  10140001
050900*----------------------------------------------------------       10150001
051000* 2100-ADEVNT-PROMO-HDR-BREAK.                                    10160001
051100*     WHEN AN ADEVENT ID/PROMO ID CHANGE, GIVE THE NEW            10170001
051200*     START/END DATES.                                            10180001
051300*----------------------------------------------------------       10190001
051400 2100-ADEVNT-PROMO-HDR-BREAK.                                     10200001
051500                                                                  10210001
051600     INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              10220001
051700     SET DPG51-ACTUAL-CALENDAR-ONLY      TO TRUE.                 10230001
051800     SET DPG51-DO-NOT-INCR-DECR-DATE     TO TRUE.                 10240001
051900     SET DPG52-LK-DTE-ISO-FMT            TO TRUE.                 10250001
052000     MOVE PM100-PROMO-STRT-TMST          TO PV-PROMO-STRT-TMST.   10260001
052100     MOVE PM100-PROMO-END-TMST           TO PV-PROMO-END-TMST.    10270001
052200     MOVE PV-PROMO-STRT-DTE              TO DPG52-LK-DATE-INPUT.  10280001
052300     MOVE 'INVALID PROMO BEGINNING DATE' TO PV-OPERATION-MSG-1.   10290001
052400                                                                  10300001
052500     PERFORM 9100-CALENDAR-ROUTINE.                               10310001
052600                                                                  10320001
052700     MOVE DPG55-ALPHA-WEEK-DAY  TO PV-BEG-DAY-ALPHA.              10330001
052800     MOVE DPG55-GREG-DATE-FMT   TO PV-BEG-DATE.                   10340001
052900                                                                  10350001
053000     IF (PV-PM-STRT-TM-HH =                                       10360001
053100         PC-DEFAULT-BEG-HR AND                                    10370001
053110         PV-PM-STRT-TM-MM =                                       10380001
053120         PC-DEFAULT-BEG-MIN)                                      10390001
053130         IF PV-PROMO-STRT-DTE = PV-PROMO-END-DTE                  10400001
053140* NEED TO CLEAR OUT ANY LETTERS FROM A PREVIOUS 'ALL DAY' DISPLAY 10410001
053150            MOVE SPACES         TO PV-BEG-TIME                    10420001
053160            MOVE PV-PM-STRT-TM-HH                                 10430001
053170                                TO PV-BEG-HR-TIME                 10440001
053180            MOVE PC-COLON       TO PV-BEG-TIME-COLON              10450001
053190            MOVE PV-PM-STRT-TM-MM                                 10460001
053200                                TO PV-BEG-MIN-TIME                10470001
053300         ELSE                                                     10480001
053400            MOVE PC-ALL-DAY     TO PV-BEG-TIME                    10490001
053500         END-IF                                                   10500001
053600     ELSE                                                         10510001
053700* NEED TO CLEAR OUT ANY LETTERS FROM A PREVIOUS 'ALL DAY' DISPLAY 10520001
053800        MOVE SPACES             TO PV-BEG-TIME                    10530001
053900        MOVE PV-PM-STRT-TM-HH                                     10540001
054000                                TO PV-BEG-HR-TIME                 10550001
054100        MOVE PC-COLON           TO PV-BEG-TIME-COLON              10560001
054200        MOVE PV-PM-STRT-TM-MM                                     10570001
054300                                TO PV-BEG-MIN-TIME                10580001
054400     END-IF.                                                      10590001
054500                                                                  10600001
054600     INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              10610001
054700     SET DPG51-ACTUAL-CALENDAR-ONLY   TO TRUE.                    10620001
054800     SET DPG51-DO-NOT-INCR-DECR-DATE  TO TRUE.                    10630001
054900     SET DPG52-LK-DTE-ISO-FMT         TO TRUE.                    10640001
055000     MOVE PV-PROMO-END-DTE            TO DPG52-LK-DATE-INPUT.     10650001
055100     MOVE 'INVALID PROMO ENDING DATE' TO PV-OPERATION-MSG-1.      10660001
055200                                                                  10670001
055300     PERFORM 9100-CALENDAR-ROUTINE.                               10680001
055400                                                                  10690001
055500     MOVE DPG55-ALPHA-WEEK-DAY  TO PV-END-DAY-ALPHA.              10700001
055600     MOVE DPG55-GREG-DATE-FMT   TO PV-END-DATE.                   10710001
055700                                                                  10720001
055800     IF (PV-PM-END-TM-HH =                                        10730001
055900         PC-DEFAULT-END-HR AND                                    10740001
056000         PV-PM-END-TM-MM =                                        10750001
056100         PC-DEFAULT-END-MIN)                                      10760001
056200         IF PV-PROMO-STRT-DTE = PV-PROMO-END-DTE                  10770001
056300* NEED TO CLEAR OUT ANY LETTERS FROM A PREVIOUS 'ALL DAY' DISPLAY 10780001
056400            MOVE SPACES         TO PV-END-TIME                    10790001
056500            MOVE PV-PM-END-TM-HH                                  10800001
056600                                TO PV-END-HR-TIME                 10810001
056700            MOVE PC-COLON       TO PV-END-TIME-COLON              10820001
056800            MOVE PV-PM-END-TM-MM                                  10830001
056900                                TO PV-END-MIN-TIME                10840001
057000         ELSE                                                     10850001
057100            MOVE PC-ALL-DAY     TO PV-END-TIME                    10860001
057200         END-IF                                                   10870001
057300      ELSE                                                        10880001
057400* NEED TO CLEAR OUT ANY LETTERS FROM A PREVIOUS 'ALL DAY' DISPLAY 10890001
057500         MOVE SPACES            TO PV-END-TIME                    10900001
057600         MOVE PV-PM-END-TM-HH                                     10910001
057700                                TO PV-END-HR-TIME                 10920001
057800         MOVE PC-COLON          TO PV-END-TIME-COLON              10930001
057900         MOVE PV-PM-END-TM-MM                                     10940001
058000                                TO PV-END-MIN-TIME                10950001
058100     END-IF.                                                      10960001
058200                                                                  10970001
058300*2100-EXIT.                                                       10980001
058400 EJECT.                                                           10990001
058500                                                                  11000001
058600*----------------------------------------------------------       11010001
058700* 2200-PROCESS-DETAIL.                                            11020001
058800*     PROCESS REPORT DETAIL LINES.                                11030001
058900*----------------------------------------------------------       11040001
059000 2200-PROCESS-DETAIL.                                             11050001
059100                                                                  11060001
059200     MOVE SPACES                TO DETAIL-01                      11070001
059300                                   DETAIL-02                      11080001
059400                                   DETAIL-VARIABLE.               11090001
059500                                                                  11100001
059510     MOVE PM100-DEPT-NBR        TO PV-SAVE-DEPT-NBR.              11110007
059520     MOVE PM100-BYR-NBR         TO PV-SAVE-BUYER-NBR.             11120007
059521     MOVE PM100-AD-PG-NBR       TO DTL-01-AD-PG-NBR.              11130007
059530                                                                  11140007
059600*** WHEN THE RECORD IS TIERED PRICING SET UP THE DETAIL           11150001
059700*** LINES DIFFERENTLY.                                            11160001
059800     IF PM100-TIER-PRICG                                          11170001
059900        PERFORM 2210-CREATE-TIER-DESC                             11180001
060000        MOVE PV-TIER-ITM-DESC       TO DTL-01-PMITEM-DESC         11190006
060100     ELSE                                                         11200001
060200        MOVE PM100-PROMO-ITM-DESC   TO DTL-01-PMITEM-DESC         11210001
060300        MOVE PM100-AD-SP-CDE        TO DTL-01-AD-SPC-CDE          11220001
060400     END-IF.                                                      11230001
060500                                                                  11240001
060600*** THIS IS PROCESSED FOR ACTUAL REPORTS ONLY.                    11250001
060700     IF PM100-ACTUAL                                              11260001
060900        MOVE PM100-ACTL-SLS-RTL-AMT  TO DTL-01-ACTL-SLS-RTL-AMT   11270036
061120        MOVE PM100-ACTL-MKDN-RTL-AMT TO DTL-01-ACTL-MD-AMT        11280036
061160        MOVE PM100-ACTL-SLS-UNT-QTY  TO DTL-01-ACTL-UNT-SLD-QTY   11290036
061200        MOVE PM100-ACTL-SLS-COST-AMT TO DTL-01-ACTL-COST-AMT      11300036
061400*** THIS IS PROCESSED FOR ACTUAL SIMPLE PRICING RECORDS           11310001
061500*** ONLY.                                                         11320001
061600        IF PM100-SMPL-PRICG                                       11330001
061700           IF PM100-PROMO-REG-TYP-CDE = 'U '                      11340001
061800              PERFORM 2220-FORMAT-PROMO-ITM-DTES                  11350001
061900              MOVE PV-PM-ITM-EFF-STRT-DTE TO PV-EFF-STRT-DTE      11360001
062000              MOVE PV-PM-ITM-EFF-END-DTE  TO PV-EFF-END-DTE       11370001
062100              MOVE PC-DASH                TO PV-DTE-DASH          11380001
062200              MOVE PC-FRONT-PAR           TO PV-OPEN-PARENTH      11390001
062300              MOVE PC-BACK-PAR            TO PV-CLOSE-PARENTH     11400001
062400              MOVE PV-EFF-DTE-LAYOUT      TO DTL-02-EFF-DTES      11410001
062500           END-IF                                                 11420001
062600           ADD PM100-ACTL-SLS-RTL-AMT  TO                         11430001
062700                              TBL-STOT-TOT-SALE-AMT(PC-SUB-1)     11440001
062710                              TBL-DTOT-TOT-SALE-AMT(PC-SUB-1)     11450017
062800                              TBL-BTOT-TOT-SALE-AMT(PC-SUB-1)     11460006
062900           ADD PM100-ACTL-MKDN-RTL-AMT TO                         11470001
063000                              TBL-STOT-TOT-MD-AMT(PC-SUB-1)       11480003
063010                              TBL-DTOT-TOT-MD-AMT(PC-SUB-1)       11490017
063100                              TBL-BTOT-TOT-MD-AMT(PC-SUB-1)       11500006
063200           ADD PM100-ACTL-SLS-UNT-QTY  TO                         11510001
063300                              TBL-STOT-TOT-SLS-UNT-QTY(PC-SUB-1)  11520003
063310                              TBL-DTOT-TOT-SLS-UNT-QTY(PC-SUB-1)  11530017
063400                              TBL-BTOT-TOT-SLS-UNT-QTY(PC-SUB-1)  11540006
063410           ADD PM100-ACTL-SLS-COST-AMT TO                         11550001
063420                              TBL-STOT-TOT-SLS-COST-AMT(PC-SUB-1) 11560001
063421                              TBL-DTOT-TOT-SLS-COST-AMT(PC-SUB-1) 11570017
063430                              TBL-BTOT-TOT-SLS-COST-AMT(PC-SUB-1) 11580006
063440           ADD PM100-ACTL-EOH-INV-QTY TO                          11590001
063450                              TBL-STOT-TOT-EOH-INV-QTY(PC-SUB-1)  11600001
063451                              TBL-DTOT-TOT-EOH-INV-QTY(PC-SUB-1)  11610017
063460                              TBL-BTOT-TOT-EOH-INV-QTY(PC-SUB-1)  11620006
063461           ADD PM100-ACTL-PREP-UNT-QTY TO                         11630018
063462                              TBL-STOT-PREP-UNT-QTY(PC-SUB-1)     11640018
063463                              TBL-DTOT-PREP-UNT-QTY(PC-SUB-1)     11650018
063466                              TBL-BTOT-PREP-UNT-QTY(PC-SUB-1)     11660018
063467           IF PM100-PROMO-ITM-ADV-IND = 'Y' AND                   11670040
PGNBR               PM100-AD-PG-NBR NOT = 0                             11671040
063468              ADD PM100-ACTL-SLS-RTL-AMT  TO                      11680018
063469                             TBL-BATOT-TOT-SALE-AMT(PC-SUB-1)     11690018
063470              ADD PM100-ACTL-MKDN-RTL-AMT TO                      11700018
063471                             TBL-BATOT-TOT-MD-AMT(PC-SUB-1)       11710018
063472              ADD PM100-ACTL-SLS-UNT-QTY  TO                      11720018
063473                             TBL-BATOT-TOT-SLS-UNT-QTY(PC-SUB-1)  11730018
063474              ADD PM100-ACTL-SLS-COST-AMT TO                      11740018
063475                             TBL-BATOT-TOT-SLS-COST-AMT(PC-SUB-1) 11750018
063476              ADD PM100-ACTL-EOH-INV-QTY TO                       11760018
063477                             TBL-BATOT-TOT-EOH-INV-QTY(PC-SUB-1)  11770018
063478              ADD PM100-ACTL-PREP-UNT-QTY TO                      11780018
063479                             TBL-BATOT-PREP-UNT-QTY(PC-SUB-1)     11790018
063480           ELSE                                                   11800018
063481              IF PM100-PROMO-ITM-ADV-IND = 'N'                    11810018
063482                 ADD PM100-ACTL-SLS-RTL-AMT  TO                   11820018
063483                             TBL-BUTOT-TOT-SALE-AMT(PC-SUB-1)     11830018
063484                 ADD PM100-ACTL-MKDN-RTL-AMT TO                   11840018
063485                             TBL-BUTOT-TOT-MD-AMT(PC-SUB-1)       11850018
063486                 ADD PM100-ACTL-SLS-UNT-QTY  TO                   11860018
063487                             TBL-BUTOT-TOT-SLS-UNT-QTY(PC-SUB-1)  11870018
063488                 ADD PM100-ACTL-SLS-COST-AMT TO                   11880018
063489                             TBL-BUTOT-TOT-SLS-COST-AMT(PC-SUB-1) 11890018
063490                 ADD PM100-ACTL-EOH-INV-QTY TO                    11900018
063491                             TBL-BUTOT-TOT-EOH-INV-QTY(PC-SUB-1)  11910018
063492                 ADD PM100-ACTL-PREP-UNT-QTY TO                   11920018
063493                             TBL-BUTOT-PREP-UNT-QTY(PC-SUB-1)     11930018
PGNBR               ELSE                                                11931040
PGNBR                  IF PM100-PROMO-ITM-ADV-IND = 'Y' AND             11932040
PGNBR                     PM100-AD-PG-NBR = 0                           11933040
PGNBR                  ADD PM100-ACTL-SLS-RTL-AMT  TO                   11934040
PGNBR                              TBL-BNPTOT-TOT-SALE-AMT(PC-SUB-1)    11935040
PGNBR                  ADD PM100-ACTL-MKDN-RTL-AMT TO                   11936040
PGNBR                              TBL-BNPTOT-TOT-MD-AMT(PC-SUB-1)      11937040
PGNBR                  ADD PM100-ACTL-SLS-UNT-QTY  TO                   11938040
PGNBR                              TBL-BNPTOT-TOT-SLS-UNT-QTY(PC-SUB-1) 11939040
PGNBR                  ADD PM100-ACTL-SLS-COST-AMT TO                   11939140
PGNBR                              TBL-BNPTOT-TOT-SLS-COST-AMT(PC-SUB-1)11939240
PGNBR                  ADD PM100-ACTL-EOH-INV-QTY TO                    11939340
PGNBR                              TBL-BNPTOT-TOT-EOH-INV-QTY(PC-SUB-1) 11939440
PGNBR                  ADD PM100-ACTL-PREP-UNT-QTY TO                   11939540
PGNBR                              TBL-BNPTOT-PREP-UNT-QTY(PC-SUB-1)    11939640
PGNBR                  END-IF                                           11939740
063494              END-IF                                              11940018
063495           END-IF                                                 11950018
063497           MOVE PM100-ACTL-PREP-UNT-QTY                           11960036
063498                                    TO DTL-01-ACTL-PREP-UNT-QTY   11970036
063600                                                                  11980029
063700           MOVE ZEROES              TO PV-ROUND-TO-TENTHS         11990036
064000           MOVE PM100-ACTL-TOT-MKUP-PCT                           12000036
064010                                    TO PV-ROUND-TO-TENTHS         12010036
064100           MOVE PV-ROUND-TO-TENTHS  TO DTL-01-ACTL-MU-PCT         12020036
064200           MOVE PC-PERCENT-SIGN     TO DTL-01-ACTL-PCT-SIGN       12030036
064300                                                                  12040001
064900           MOVE ZEROES             TO PV-ROUND-TO-TENTHS          12050001
065000           ADD PM100-SELL-THRU-PCT TO PV-ROUND-TO-TENTHS ROUNDED  12060001
065100           MOVE PV-ROUND-TO-TENTHS TO DTL-01-SELL-THRU-PCT        12070001
065110           MOVE PC-PERCENT-SIGN    TO DTL-O1-SELL-PCT-SIGN        12080036
065700                                                                  12090001
065710           IF PM100-FCST-SLS-RTL-AMT = ZEROES                     12100036
065720              MOVE SPACES          TO DETAIL-VARIABLE             12110036
065730              MOVE DETAIL-VARIABLE TO DTL-01-VOL-PCT-CHG          12120036
065740              MOVE SPACES          TO DTL-01-VOL-PCT-SIGN         12130036
065750           ELSE                                                   12140036
065800              MOVE ZEROES           TO PV-ROUND-TO-TENTHS         12150036
065900              ADD PM100-VOL-PCT-CHG TO PV-ROUND-TO-TENTHS ROUNDED 12160036
066000              IF PM100-VOL-PCT-CHG < 0                            12170036
066100                 PERFORM 9000-ADD-PARENTH-TO-NEG-PCT              12180036
066200                 MOVE PV-FINAL-VOL-PCT    TO DTL-01-VOL-PCT-CHG   12190036
066300              ELSE                                                12200036
066400                 MOVE PV-ROUND-TO-TENTHS  TO DTL-VAR-VOL-PCT-CHG  12210036
066500                 MOVE DETAIL-VARIABLE     TO DTL-01-VOL-PCT-CHG   12220036
066600              END-IF                                              12230036
066610              MOVE PC-PERCENT-SIGN        TO DTL-01-VOL-PCT-SIGN  12240036
066620           END-IF                                                 12250036
067110        END-IF                                                    12260001
067120     END-IF.                                                      12270001
067130                                                                  12280001
067140*** THIS IS PROCESSED FOR ALL SIMPLE PRICING RECORD IN            12290001
067141*** ACTUAL AND FORECAST REPORTS.                                  12300001
067142     IF PM100-SMPL-PRICG                                          12310001
067143        MOVE PM100-MIN-UNT-REG-RTL-AMT TO DTL-01-MIN-RTL-PRC      12320001
067144        MOVE PM100-MAX-UNT-REG-RTL-AMT TO DTL-01-MAX-RTL-PRC      12330001
067145        MOVE PM100-MIN-UNT-PRM-RTL-AMT TO DTL-01-MIN-PROMO-PRC    12340001
067146        MOVE PM100-MAX-UNT-PRM-RTL-AMT TO DTL-01-MAX-PROMO-PRC    12350001
067147        IF PM100-MIN-UNT-REG-RTL-AMT NOT = 0 AND                  12360001
067148           PM100-MAX-UNT-REG-RTL-AMT NOT = 0                      12370001
067149           MOVE PC-DASH                TO DTL-01-RTL-DASH         12380001
067150        END-IF                                                    12390001
067160        IF PM100-MIN-UNT-PRM-RTL-AMT NOT = 0 AND                  12400001
067170           PM100-MAX-UNT-PRM-RTL-AMT NOT = 0                      12410001
067180           MOVE PC-DASH                TO DTL-01-PRM-DASH         12420001
067190        END-IF                                                    12430001
067210        MOVE PM100-FCST-SLS-RTL-AMT  TO DTL-01-FCST-SLS-RTL-AMT   12440036
067230        ADD PM100-FCST-SLS-RTL-AMT   TO                           12450036
067240                               TBL-STOT-TOT-SALE-AMT(PC-SUB-2)    12460001
067241                               TBL-DTOT-TOT-SALE-AMT(PC-SUB-2)    12470017
067250                               TBL-BTOT-TOT-SALE-AMT(PC-SUB-2)    12480006
067251                                                                  12490029
067270        MOVE PM100-FCST-MKDN-RTL-AMT TO DTL-01-FCST-MD-AMT        12500036
067290        ADD PM100-FCST-MKDN-RTL-AMT  TO                           12510036
067300                                   TBL-STOT-TOT-MD-AMT(PC-SUB-2)  12520001
067310                                   TBL-DTOT-TOT-MD-AMT(PC-SUB-2)  12530017
067400                                   TBL-BTOT-TOT-MD-AMT(PC-SUB-2)  12540006
067410                                                                  12550029
067600        MOVE PM100-FCST-SLS-UNT-QTY  TO DTL-01-FCST-UNT-SLD-QTY   12560036
067800        ADD PM100-FCST-SLS-UNT-QTY   TO                           12570036
067900                            TBL-STOT-TOT-SLS-UNT-QTY(PC-SUB-2)    12580001
067910                            TBL-DTOT-TOT-SLS-UNT-QTY(PC-SUB-2)    12590017
068000                            TBL-BTOT-TOT-SLS-UNT-QTY(PC-SUB-2)    12600006
068010                                                                  12610029
068200        MOVE PM100-FCST-PROJD-UNT-QTY                             12620036
068300                                     TO DTL-01-FCST-PREP-UNT-QTY  12630036
068500        ADD PM100-FCST-PROJD-UNT-QTY TO                           12640001
068600                                  TBL-STOT-PREP-UNT-QTY(PC-SUB-2) 12650001
068610                                  TBL-DTOT-PREP-UNT-QTY(PC-SUB-2) 12660017
068700                                  TBL-BTOT-PREP-UNT-QTY(PC-SUB-2) 12670006
068710                                                                  12680029
068900        MOVE PM100-FCST-SLS-COST-AMT TO DTL-01-FCST-COST-AMT      12690036
069100        ADD PM100-FCST-SLS-COST-AMT  TO                           12700036
069200                              TBL-STOT-TOT-SLS-COST-AMT(PC-SUB-2) 12710001
069210                              TBL-DTOT-TOT-SLS-COST-AMT(PC-SUB-2) 12720017
069300                              TBL-BTOT-TOT-SLS-COST-AMT(PC-SUB-2) 12730006
069400                                                                  12740001
069410        IF PM100-PROMO-ITM-ADV-IND = 'Y' AND                      12750040
PGNBR            PM100-AD-PG-NBR NOT = 0                                12751040
069420           ADD PM100-FCST-SLS-RTL-AMT   TO                        12760020
069430                         TBL-BATOT-TOT-SALE-AMT(PC-SUB-2)         12770018
069440           ADD PM100-FCST-MKDN-RTL-AMT  TO                        12780020
069450                         TBL-BATOT-TOT-MD-AMT(PC-SUB-2)           12790018
069460           ADD PM100-FCST-SLS-UNT-QTY   TO                        12800020
069470                         TBL-BATOT-TOT-SLS-UNT-QTY(PC-SUB-2)      12810018
069480           ADD PM100-FCST-SLS-COST-AMT  TO                        12820020
069490                         TBL-BATOT-TOT-SLS-COST-AMT(PC-SUB-2)     12830018
069493           ADD PM100-FCST-PROJD-UNT-QTY TO                        12840020
069494                         TBL-BATOT-PREP-UNT-QTY(PC-SUB-2)         12850018
069495        ELSE                                                      12860018
069496           IF PM100-PROMO-ITM-ADV-IND = 'N'                       12870018
069497              ADD PM100-FCST-SLS-RTL-AMT   TO                     12880020
069498                         TBL-BUTOT-TOT-SALE-AMT(PC-SUB-2)         12890018
069499              ADD PM100-FCST-MKDN-RTL-AMT  TO                     12900020
069500                         TBL-BUTOT-TOT-MD-AMT(PC-SUB-2)           12910018
069501              ADD PM100-FCST-SLS-UNT-QTY   TO                     12920020
069502                         TBL-BUTOT-TOT-SLS-UNT-QTY(PC-SUB-2)      12930018
069503              ADD PM100-FCST-SLS-COST-AMT  TO                     12940020
069504                         TBL-BUTOT-TOT-SLS-COST-AMT(PC-SUB-2)     12950018
069507              ADD PM100-FCST-PROJD-UNT-QTY TO                     12960020
069508                         TBL-BUTOT-PREP-UNT-QTY(PC-SUB-2)         12970018
PGNBR            ELSE                                                   12971040
PGNBR               IF PM100-PROMO-ITM-ADV-IND = 'Y' AND                12972040
PGNBR                  PM100-AD-PG-NBR = 0                              12973040
PGNBR               ADD PM100-FCST-SLS-RTL-AMT   TO                     12974040
PGNBR                          TBL-BNPTOT-TOT-SALE-AMT(PC-SUB-2)        12975040
PGNBR               ADD PM100-FCST-MKDN-RTL-AMT  TO                     12976040
PGNBR                          TBL-BNPTOT-TOT-MD-AMT(PC-SUB-2)          12977040
PGNBR               ADD PM100-FCST-SLS-UNT-QTY   TO                     12978040
PGNBR                          TBL-BNPTOT-TOT-SLS-UNT-QTY(PC-SUB-2)     12979040
PGNBR               ADD PM100-FCST-SLS-COST-AMT  TO                     12979140
PGNBR                          TBL-BNPTOT-TOT-SLS-COST-AMT(PC-SUB-2)    12979240
PGNBR               ADD PM100-FCST-PROJD-UNT-QTY TO                     12979340
PGNBR                          TBL-BNPTOT-PREP-UNT-QTY(PC-SUB-2)        12979440
PGNBR               END-IF                                              12979540
069509           END-IF                                                 12980018
069510        END-IF                                                    12990018
069511        IF PM100-FCST-SLS-RTL-AMT = ZEROES                        13000036
069512           CONTINUE                                               13010036
069513        ELSE                                                      13020036
069520           MOVE ZEROES                 TO PV-ROUND-TO-TENTHS      13030036
069600           ADD PM100-FCST-TOT-MKUP-PCT TO                         13040036
069610                                    PV-ROUND-TO-TENTHS ROUNDED    13050036
069700           MOVE PV-ROUND-TO-TENTHS     TO DTL-01-FCST-MU-PCT      13060036
069800           MOVE PC-PERCENT-SIGN        TO DTL-01-FCST-PCT-SIGN    13070036
070300        END-IF                                                    13080001
070400     END-IF.                                                      13090001
070500                                                                  13100001
070510     IF PV-SAVE-SKIP-LINES NOT = 0                                13110021
070520        MOVE PV-SAVE-SKIP-LINES TO PV-ADVANCE-LINES               13120021
070530                                   PV-SAVE-LINE-AMT               13130021
070531        MOVE ZEROES             TO PV-SAVE-SKIP-LINES             13140021
070540     ELSE                                                         13150021
070600        MOVE 1                  TO PV-ADVANCE-LINES               13160021
070700                                   PV-SAVE-LINE-AMT               13170021
070710     END-IF.                                                      13180021
070800     ADD PV-ADVANCE-LINES       TO PV-LINE-CNT.                   13190001
070900     PERFORM 3200-CHECK-MAX-LINE-CNT.                             13200001
071000     MOVE DETAIL-01             TO PV-RPT-LINE.                   13210001
071100     PERFORM 8200-WRITE-RPT-LINE.                                 13220001
071200                                                                  13230001
071300     IF PM100-PROMO-REG-TYP-CDE = 'U '                            13240001
071400        MOVE 1                     TO PV-ADVANCE-LINES            13250001
071500        ADD PV-ADVANCE-LINES       TO PV-LINE-CNT                 13260001
071600        MOVE DETAIL-02             TO PV-RPT-LINE                 13270001
071700        PERFORM 8200-WRITE-RPT-LINE                               13280001
071710     END-IF.                                                      13290001
071720                                                                  13300001
071721     IF PM100-AD-VERSION(PC-SUB-1) NOT = SPACES                   13310030
071722        MOVE SPACES TO PV-VERSION-AD                              13320032
071723        PERFORM 2230-CREATE-VERSION-DATA                          13330030
071724        MOVE 1                     TO PV-ADVANCE-LINES            13340030
071725        ADD PV-ADVANCE-LINES       TO PV-LINE-CNT                 13350030
071726        MOVE DETAIL-02             TO PV-RPT-LINE                 13360030
071727        PERFORM 8200-WRITE-RPT-LINE                               13370030
071728     END-IF.                                                      13380030
071729                                                                  13390030
071730*2200-EXIT.                                                       13400001
071740 EJECT.                                                           13410001
071750                                                                  13420001
071760*----------------------------------------------------------       13430001
071770* 2210-CREATE-TIER-DESC.                                          13440001
071780*     CREATE THE PROMO ITEM DESCRIPTION FIELD FOR TIERED          13450001
071790*     PRICING RECORDS.                                            13460001
071800*----------------------------------------------------------       13470001
071900 2210-CREATE-TIER-DESC.                                           13480001
072000                                                                  13490001
072100     INITIALIZE PA-CNT-POS-1                                      13500001
072200                PA-CNT-POS-2                                      13510001
072300                PA-CNT-SPACES-1                                   13520001
072400                PA-CNT-SPACES-2                                   13530001
072500                PV-TIER-ITM-DESC.                                 13540001
072600                                                                  13550001
072700     EVALUATE TRUE                                                13560001
072800         WHEN PM100-TIER-PRICG-TYP-CDE = 'TAP'                    13570001
072900              MOVE PM100-TIER-THRS-AMT TO PV-THRS-AMT-NUM         13580001
073000              MOVE PV-THRS-AMT-NUM-X   TO PV-SAVE-THRS-AMT        13590001
073100              MOVE PV-SAVE-THRS-AMT-1  TO PV-THRS-AMT-CHAR        13600001
073200              INSPECT PV-THRS-AMT-CHAR REPLACING                  13610001
073300                      LEADING ZERO BY " "                         13620001
073400              INSPECT PV-THRS-AMT-CHAR                            13630001
073500                     TALLYING PA-CNT-SPACES-1 FOR ALL " "         13640001
073600              COMPUTE PA-CNT-POS-1 = 8 - PA-CNT-SPACES-1          13650001
073700              ADD +1 TO PA-CNT-SPACES-1                           13660001
073800              MOVE PM100-TIER-DISC-PCT TO PV-DISC-PCT-NUM         13670001
073900              MOVE PV-DISC-PCT-NUM-X   TO PV-SAVE-DISC-PCT        13680001
074000              MOVE PV-SAVE-DISC-PCT-1  TO PV-DISC-PCT-CHAR        13690001
074100              INSPECT PV-DISC-PCT-CHAR REPLACING                  13700001
074200                      LEADING ZERO BY " "                         13710001
074300              INSPECT PV-DISC-PCT-CHAR                            13720001
074400                     TALLYING PA-CNT-SPACES-2 FOR ALL " "         13730001
074500              COMPUTE PA-CNT-POS-2 = 3 - PA-CNT-SPACES-2          13740001
074600              ADD +1 TO PA-CNT-SPACES-2                           13750001
074700              MOVE +1 TO PV-POINTER-FIELD                         13760001
074800              STRING PC-CHAR-BUY DELIMITED BY " "                 13770001
074900                     " " DELIMITED BY SIZE                        13780001
075000                     PC-DOLLAR-SIGN DELIMITED BY " "              13790001
075100                     PV-THRS-AMT-CHAR                             13800001
075200                         (PA-CNT-SPACES-1:PA-CNT-POS-1)           13810001
075300                     "," DELIMITED BY SIZE                        13820001
075400                     " " DELIMITED BY SIZE                        13830001
075500                     PC-CHAR-GET DELIMITED BY " "                 13840001
075600                     " " DELIMITED BY SIZE                        13850001
075700                     PV-DISC-PCT-CHAR                             13860001
075800                         (PA-CNT-SPACES-2:PA-CNT-POS-2)           13870001
075900                     PC-PERCENT-SIGN DELIMITED BY " "             13880001
076000                     " " DELIMITED BY SIZE                        13890001
076100                     PC-CHAR-OFF DELIMITED BY " "                 13900001
076200              INTO PV-TIER-ITM-DESC-1                             13910001
076300              WITH POINTER PV-POINTER-FIELD                       13920001
076400         WHEN PM100-TIER-PRICG-TYP-CDE = 'TQP'                    13930001
076500              MOVE PM100-TIER-THRS-QTY TO PV-THRS-QTY-CHAR        13940001
076600              INSPECT PV-THRS-QTY-CHAR REPLACING                  13950001
076700                      LEADING ZERO BY " "                         13960001
076800              INSPECT PV-THRS-QTY-CHAR                            13970001
076900                     TALLYING PA-CNT-SPACES-1 FOR ALL " "         13980001
077000              COMPUTE PA-CNT-POS-1 = 5 - PA-CNT-SPACES-1          13990001
077100              ADD +1 TO PA-CNT-SPACES-1                           14000001
077200              MOVE PM100-TIER-DISC-PCT TO PV-DISC-PCT-NUM         14010001
077300              MOVE PV-DISC-PCT-NUM-X   TO PV-SAVE-DISC-PCT        14020001
077400              MOVE PV-SAVE-DISC-PCT-1  TO PV-DISC-PCT-CHAR        14030001
077500              INSPECT PV-DISC-PCT-CHAR REPLACING                  14040001
077600                      LEADING ZERO BY " "                         14050001
077700              INSPECT PV-DISC-PCT-CHAR                            14060001
077800                     TALLYING PA-CNT-SPACES-2 FOR ALL " "         14070001
077900              COMPUTE PA-CNT-POS-2 = 3 - PA-CNT-SPACES-2          14080001
078000              ADD +1 TO PA-CNT-SPACES-2                           14090001
078100              MOVE +1 TO PV-POINTER-FIELD                         14100001
078200              STRING PC-CHAR-BUY DELIMITED BY " "                 14110001
078300                     " " DELIMITED BY SIZE                        14120001
078400                     PV-THRS-QTY-CHAR                             14130001
078500                         (PA-CNT-SPACES-1:PA-CNT-POS-1)           14140001
078600                     "," DELIMITED BY SIZE                        14150001
078700                     " " DELIMITED BY SIZE                        14160001
078800                     PC-CHAR-GET DELIMITED BY " "                 14170001
078900                     " " DELIMITED BY SIZE                        14180001
079000                     PV-DISC-PCT-CHAR                             14190001
079100                         (PA-CNT-SPACES-2:PA-CNT-POS-2)           14200001
079200                     PC-PERCENT-SIGN DELIMITED BY " "             14210001
079300                     " " DELIMITED BY SIZE                        14220001
079400                     PC-CHAR-OFF DELIMITED BY " "                 14230001
079500              INTO PV-TIER-ITM-DESC-1                             14240001
079600              WITH POINTER PV-POINTER-FIELD                       14250001
079700         WHEN PM100-TIER-PRICG-TYP-CDE = 'TQA'                    14260001
079800              MOVE PM100-TIER-THRS-QTY TO PV-THRS-QTY-CHAR        14270001
079900              INSPECT PV-THRS-QTY-CHAR REPLACING                  14280001
079910                      LEADING ZERO BY " "                         14290001
079920              INSPECT PV-THRS-QTY-CHAR                            14300001
079930                     TALLYING PA-CNT-SPACES-1 FOR ALL " "         14310001
079940              COMPUTE PA-CNT-POS-1 = 5 - PA-CNT-SPACES-1          14320001
079950              ADD +1 TO PA-CNT-SPACES-1                           14330001
079960              MOVE PM100-TIER-DISC-AMT TO PV-DISC-AMT-NUM         14340001
079970              MOVE PV-DISC-AMT-NUM-X   TO PV-SAVE-DISC-AMT        14350001
079980              MOVE PV-SAVE-DISC-AMT-1  TO PV-DISC-AMT-CHAR        14360001
079981              INSPECT PV-DISC-AMT-CHAR REPLACING                  14370001
079982                      LEADING ZERO BY " "                         14380001
079983              INSPECT PV-DISC-AMT-CHAR                            14390001
079984                     TALLYING PA-CNT-SPACES-2 FOR ALL " "         14400001
079985              COMPUTE PA-CNT-POS-2 = 8 - PA-CNT-SPACES-2          14410001
079986              ADD +1 TO PA-CNT-SPACES-2                           14420001
079987              MOVE +1 TO PV-POINTER-FIELD                         14430001
079988              STRING PC-CHAR-BUY DELIMITED BY " "                 14440001
079989                     " " DELIMITED BY SIZE                        14450001
079990                     PV-THRS-QTY-CHAR                             14460001
080000                         (PA-CNT-SPACES-1:PA-CNT-POS-1)           14470001
080001                     "," DELIMITED BY SIZE                        14480001
080002                     " " DELIMITED BY SIZE                        14490001
080003                     PC-CHAR-GET DELIMITED BY " "                 14500001
080004                     " " DELIMITED BY SIZE                        14510001
080005                     PC-DOLLAR-SIGN DELIMITED BY " "              14520001
080006                     PV-DISC-AMT-CHAR                             14530001
080007                         (PA-CNT-SPACES-2:PA-CNT-POS-2)           14540001
080008                     " " DELIMITED BY SIZE                        14550001
080009                     PC-CHAR-OFF DELIMITED BY " "                 14560001
080010              INTO PV-TIER-ITM-DESC-1                             14570001
080011              WITH POINTER PV-POINTER-FIELD                       14580001
080012         WHEN PM100-TIER-PRICG-TYP-CDE = 'TAA'                    14590001
080013              MOVE PM100-TIER-THRS-AMT TO PV-THRS-AMT-NUM         14600001
080014              MOVE PV-THRS-AMT-NUM-X   TO PV-SAVE-THRS-AMT        14610001
080015              MOVE PV-SAVE-THRS-AMT-1  TO PV-THRS-AMT-CHAR        14620001
080016              INSPECT PV-THRS-AMT-CHAR REPLACING                  14630001
080017                      LEADING ZERO BY " "                         14640001
080018              INSPECT PV-THRS-AMT-CHAR                            14650001
080019                     TALLYING PA-CNT-SPACES-1 FOR ALL " "         14660001
080020              COMPUTE PA-CNT-POS-1 = 8 - PA-CNT-SPACES-1          14670001
080021              ADD +1 TO PA-CNT-SPACES-1                           14680001
080022              MOVE PM100-TIER-DISC-AMT TO PV-DISC-AMT-NUM         14690001
080023              MOVE PV-DISC-AMT-NUM-X   TO PV-SAVE-DISC-AMT        14700001
080024              MOVE PV-SAVE-DISC-AMT-1  TO PV-DISC-AMT-CHAR        14710001
080025              INSPECT PV-DISC-AMT-CHAR REPLACING                  14720001
080026                      LEADING ZERO BY " "                         14730001
080027              INSPECT PV-DISC-AMT-CHAR                            14740001
080028                     TALLYING PA-CNT-SPACES-2 FOR ALL " "         14750001
080029              COMPUTE PA-CNT-POS-2 = 8 - PA-CNT-SPACES-2          14760001
080030              ADD +1 TO PA-CNT-SPACES-2                           14770001
080031              MOVE +1 TO PV-POINTER-FIELD                         14780001
080032              STRING PC-CHAR-BUY DELIMITED BY " "                 14790001
080033                     " " DELIMITED BY SIZE                        14800001
080034                     PC-DOLLAR-SIGN DELIMITED BY " "              14810001
080035                     PV-THRS-AMT-CHAR                             14820001
080036                         (PA-CNT-SPACES-1:PA-CNT-POS-1)           14830001
080037                     "," DELIMITED BY SIZE                        14840001
080038                     " " DELIMITED BY SIZE                        14850001
080039                     PC-CHAR-GET DELIMITED BY " "                 14860001
080040                     " " DELIMITED BY SIZE                        14870001
080041                     PC-DOLLAR-SIGN DELIMITED BY " "              14880001
080042                     PV-DISC-AMT-CHAR                             14890001
080043                         (PA-CNT-SPACES-2:PA-CNT-POS-2)           14900001
080044                     " " DELIMITED BY SIZE                        14910001
080045                     PC-CHAR-OFF DELIMITED BY " "                 14920001
080046              INTO PV-TIER-ITM-DESC-1                             14930001
080047              WITH POINTER PV-POINTER-FIELD                       14940001
080048     END-EVALUATE.                                                14950001
080049                                                                  14960001
080050*2210-EXIT.                                                       14970001
080051 EJECT.                                                           14980001
080052                                                                  14990001
080053*----------------------------------------------------------       15000001
080054* 2220-FORMAT-PROMO-ITM-DTES.                                     15010001
080055*     IF THE PROMO ITEM IS ATTACHED TO AN UNADVERTISED            15020001
080056*     PROMOTION, THE PROMO ITEM EFFECTIVE DATES NEED              15030001
080057*     TO BE INCLUDED IN THE REPORTS.                              15040001
080058*----------------------------------------------------------       15050001
080059 2220-FORMAT-PROMO-ITM-DTES.                                      15060001
080060                                                                  15070001
080061     MOVE PM100-PROMO-ITM-STRT-TMST TO PV-PROMO-ITM-STRT-TMST.    15080001
080062     MOVE PM100-PROMO-ITM-END-TMST  TO PV-PROMO-ITM-END-TMST.     15090001
080063     MOVE PV-PI-STRT-DTE-YY         TO PV-EFF-STRT-DTE-YY.        15100001
080064     MOVE PV-PI-STRT-DTE-MM         TO PV-EFF-STRT-DTE-MM.        15110001
080065     MOVE PV-PI-STRT-DTE-DD         TO PV-EFF-STRT-DTE-DD.        15120001
080066     MOVE PV-PI-END-DTE-YY          TO PV-EFF-END-DTE-YY.         15130001
080067     MOVE PV-PI-END-DTE-MM          TO PV-EFF-END-DTE-MM.         15140001
080068     MOVE PV-PI-END-DTE-DD          TO PV-EFF-END-DTE-DD.         15150001
080069                                                                  15160001
080070*2220-EXIT.                                                       15170001
080071 EJECT.                                                           15180001
080072                                                                  15190001
080073*----------------------------------------------------------       15200030
080074* 2230-CREATE-VERSION-DATA.                                       15210030
080075*     CREATE THE VERSION DATA IF THE PROMO ITEM HAS SPECIFIC      15220030
080076*     VERSIONS THAT IT IS IN.                                     15230030
080077*----------------------------------------------------------       15240030
080078 2230-CREATE-VERSION-DATA.                                        15250030
080079                                                                  15260030
080080     INITIALIZE PV-CHAR-LENGTH.                                   15270030
080081     MOVE +1 TO PV-POINTER-FIELD.                                 15280030
080082     PERFORM                                                      15290030
080083       VARYING PV-VAR-IDX FROM 1 BY 1                             15300030
080084         UNTIL PM100-AD-VERSION(PV-VAR-IDX) = SPACES              15310030
080085            OR PV-VAR-IDX > 15                                    15320030
080086              STRING PM100-AD-VERSION(PV-VAR-IDX) DELIMITED BY " "15330030
080087              "," DELIMITED BY SIZE                               15340030
080088              " " DELIMITED BY SIZE                               15350030
080089          INTO PV-VERSION-AD                                      15360030
080090          WITH POINTER PV-POINTER-FIELD                           15370030
080091     END-PERFORM.                                                 15380030
080092                                                                  15390030
080093     MOVE PC-FRONT-PAR          TO PV-PARENTHESES.                15400030
080094     MOVE PV-VERSION-AD         TO PV-SAVE-VAR.                   15410030
080095     MOVE 61                    TO PV-SAVE-NUM.                   15420030
080096     PERFORM 2310-COUNT-FIELD-LENGTH.                             15430030
080097     MOVE PV-SAVE-LENGTH        TO PV-CHAR-LENGTH.                15440030
080098                                                                  15450030
080099     MOVE PC-BACK-PAR          TO PV-VERSION-AD(PV-CHAR-LENGTH:1).15460030
080100     MOVE PV-VER-AD-VARIABLE   TO DTL-01-VERSION-AD.              15470030
080101                                                                  15480030
080102*2230-EXIT.                                                       15490030
080103 EJECT.                                                           15500030
080104                                                                  15510030
080105*----------------------------------------------------------       15520001
080106* 2300-FORMAT-HEADING-FIELDS.                                     15530001
080107*     FORMAT THE AD EVENT TITLES AND THE PROMOTION TITLES.        15540001
080108*----------------------------------------------------------       15550001
080109 2300-FORMAT-HEADING-FIELDS.                                      15560001
080110                                                                  15570001
080111     MOVE PM100-AD-EVNT-NBR-TXT TO PV-SAVE-VAR.                   15580001
080112     MOVE 16                    TO PV-SAVE-NUM.                   15590001
080113     PERFORM 2310-COUNT-FIELD-LENGTH.                             15600001
080120     MOVE PV-SAVE-LENGTH        TO PV-AD-EVNT-NBR-LENGTH.         15610001
080200                                                                  15620001
080210     MOVE PM100-AD-EVNT-NM      TO PV-SAVE-VAR.                   15630001
080220     MOVE 41                    TO PV-SAVE-NUM.                   15640001
080230     PERFORM 2310-COUNT-FIELD-LENGTH.                             15650001
080231     MOVE PV-SAVE-LENGTH        TO PV-AD-EVNT-NM-LENGTH.          15660001
080232                                                                  15670001
080233     MOVE PM100-PROMO-NM        TO PV-SAVE-VAR.                   15680001
080234     MOVE 41                    TO PV-SAVE-NUM.                   15690001
080235     PERFORM 2310-COUNT-FIELD-LENGTH.                             15700001
080236     MOVE PV-SAVE-LENGTH        TO PV-PROMO-NM-LENGTH.            15710001
080237                                                                  15720001
080238     MOVE PM100-BYR-FRST-NM     TO PV-SAVE-VAR.                   15730001
080239     MOVE 41                    TO PV-SAVE-NUM.                   15740001
080240     PERFORM 2310-COUNT-FIELD-LENGTH.                             15750001
080250     MOVE PV-SAVE-LENGTH        TO PV-BUYER-FRST-LENGTH.          15760001
080251                                                                  15770001
080252     MOVE PM100-BYR-LAST-NM     TO PV-SAVE-VAR.                   15780001
080253     MOVE 41                    TO PV-SAVE-NUM.                   15790001
080254     PERFORM 2310-COUNT-FIELD-LENGTH.                             15800001
080255     MOVE PV-SAVE-LENGTH        TO PV-BUYER-LAST-LENGTH.          15810001
080256                                                                  15820001
080257*2300-EXIT.                                                       15830001
080258 EJECT.                                                           15840001
080259                                                                  15850001
080260*----------------------------------------------------------       15860001
080261* 2310-COUNT-FIELD-LENGTH.                                        15870001
080262*     COUNTS THE ACTUAL FIELD'S LENGTH.                           15880001
080263*----------------------------------------------------------       15890001
080264 2310-COUNT-FIELD-LENGTH.                                         15900001
080265                                                                  15910001
080266     INITIALIZE PV-VARIABLE-OUTPUT-FIELD.                         15920001
080267     MOVE PV-SAVE-VAR    TO PV-VARIABLE-OUTPUT-FIELD.             15930001
080268                                                                  15940001
080269     MOVE PV-SAVE-NUM TO PV-SUBSCRIPT.                            15950001
080270                                                                  15960001
080271     PERFORM                                                      15970001
080272        VARYING PV-BIT-IDX FROM PV-SAVE-NUM BY -1                 15980001
080273        UNTIL PV-BIT-VARIABLE(PV-BIT-IDX) NOT = SPACES            15990001
080274               OR PV-BIT-IDX = 1                                  16000001
080275        SUBTRACT 1 FROM PV-SUBSCRIPT                              16010001
080276     END-PERFORM.                                                 16020001
080277                                                                  16030001
080278     MOVE PV-SUBSCRIPT TO PV-SAVE-LENGTH.                         16040001
080279                                                                  16050001
080280*2310-EXIT.                                                       16060001
080281 EJECT.                                                           16070001
080282                                                                  16080001
080283*----------------------------------------------------------       16090001
080284* 2400-CREATE-HEADING-FIELDS.                                     16100001
080285*     CREATE THE AD EVENT AND THE PROMO HEADINGS.                 16110001
080286*----------------------------------------------------------       16120001
080287 2400-CREATE-HEADING-FIELDS.                                      16130001
080288                                                                  16140001
080289     MOVE SPACES          TO HDR-02-ADEVNT-STRING                 16150001
080290                             HDR-03-PROMO-STRING                  16160001
080291                             HDR-04-BUYER-STRING.                 16170001
080292                                                                  16180001
080293     MOVE +1 TO PV-POINTER-FIELD.                                 16190001
080294     STRING PM100-AD-EVNT-NBR-TXT(1:PV-AD-EVNT-NBR-LENGTH)        16200001
080295            " " DELIMITED BY SIZE                                 16210001
080296            PM100-AD-EVNT-NM(1:PV-AD-EVNT-NM-LENGTH)              16220001
080297            " " DELIMITED BY SIZE                                 16230001
080298       INTO HDR-02-ADEVNT-STRING                                  16240001
080299       WITH POINTER PV-POINTER-FIELD.                             16250001
080300                                                                  16260001
080301     MOVE +1 TO PV-POINTER-FIELD.                                 16270001
080302     STRING PM100-PROMO-NM(1:PV-PROMO-NM-LENGTH)                  16280001
080303            " " DELIMITED BY SIZE                                 16290001
080304            " " DELIMITED BY SIZE                                 16300001
080305            " " DELIMITED BY SIZE                                 16310001
080306            PC-CHAR-EFFECTIVE DELIMITED BY " "                    16320001
080307            ":" DELIMITED BY SIZE                                 16330001
080308            " " DELIMITED BY SIZE                                 16340001
080309            PV-HEADER-DTE-TM(1:87)                                16350001
080310            " " DELIMITED BY SIZE                                 16360001
080311       INTO HDR-03-PROMO-STRING                                   16370001
080312       WITH POINTER PV-POINTER-FIELD.                             16380001
080313                                                                  16390001
080314     MOVE PM100-BYR-NBR     TO HDR-04-BUYER-NBR.                  16400001
080315     MOVE +1 TO PV-POINTER-FIELD.                                 16410001
080316     STRING PM100-BYR-FRST-NM(1:PV-BUYER-FRST-LENGTH)             16420001
080317            " " DELIMITED BY SIZE                                 16430001
080318            PM100-BYR-LAST-NM(1:PV-BUYER-LAST-LENGTH)             16440001
080319            " " DELIMITED BY SIZE                                 16450001
080320       INTO HDR-04-BUYER-STRING                                   16460001
080321       WITH POINTER PV-POINTER-FIELD.                             16470001
080322                                                                  16480001
080323*2400-EXIT.                                                       16490001
080324 EJECT.                                                           16500001
080325                                                                  16510001
080326*----------------------------------------------------------       16520001
080327* 3000-END-OF-JOB-ROUTINE.                                        16530001
080328*     PERFORMS THE FINAL PROCESSING OF THE PROGRAM.               16540001
080329*     WRITES OUT THE CLOSING LINES OF THE REPORT, CLOSES          16550001
080330*     ANY FILES, AND DISPLAYS ANY NECESSARY STATISTICS.           16560001
080331*----------------------------------------------------------       16570001
080332 3000-END-OF-JOB-ROUTINE.                                         16580001
080333                                                                  16590001
080334     IF PS-NOT-FIRST-TIME                                         16600022
080335        PERFORM 3100-PROCESS-SECT-TTL                             16610022
080336        PERFORM 3110-PROCESS-DEPT-TTL                             16620022
080337        PERFORM 3120-PROCESS-ADV-PROMO-TTL                        16630022
PGNBR         PERFORM 3030-PROCESS-ADV-NOPGE-TTL                        16631041
080338        PERFORM 3130-PROCESS-UNADV-PROMO-TTL                      16640022
080339        PERFORM 3140-PROCESS-BUYER-TTL                            16650022
080340                                                                  16660006
080367        MOVE 2                     TO PV-ADVANCE-LINES            16670022
080368                                      PV-SAVE-LINE-AMT            16680022
080369        ADD PV-ADVANCE-LINES       TO PV-LINE-CNT                 16690022
080370        PERFORM 3200-CHECK-MAX-LINE-CNT                           16700022
080380        MOVE END-OF-REPORT-LINE    TO PV-RPT-LINE                 16710022
080390        PERFORM 8200-WRITE-RPT-LINE                               16720022
080391     END-IF.                                                      16730022
080400                                                                  16740001
080500     CLOSE PROMO-ITM-SUMM-FILE                                    16750001
080600           PROMO-ITM-SUMM-REPORT.                                 16760001
080610                                                                  16770001
080620*3000-EXIT.                                                       16780001
080630 EJECT.                                                           16790001
080640                                                                  16800001
083100*----------------------------------------------------------       16810001
083200* 3100-PROCESS-SECT-TTL.                                          16820006
083300*     PROCESS THE SECTION TOTAL OF THE REPORT.                    16830006
083400*----------------------------------------------------------       16840001
083500 3100-PROCESS-SECT-TTL.                                           16850008
083600                                                                  16860001
083700     MOVE SPACES               TO DETAIL-PM-TOTALS                16870006
083800                                  DETAIL-VARIABLE.                16880006
083900                                                                  16890001
PGNBR      IF PS-ADV-PROMO-TTL-SW = 1                                   16900040
PGNBR         MOVE PC-ADV-TOTAL          TO DTL-ADV-PM-TITLE            16910040
PGNBR         MOVE PV-SAVE-DEPT-NBR      TO DTL-ADV-PM-DEPT             16920040
PGNBR      ELSE                                                         16930040
PGNBR         IF PS-ADV-PROMO-TTL-SW = 2                                16931040
PGNBR            MOVE PC-ADVNO-TOTAL        TO DTL-ADVNO-PM-TITLE       16932040
PGNBR            MOVE PV-SAVE-DEPT-NBR      TO DTL-ADVNO-PM-DEPT        16933040
PGNBR         ELSE                                                      16934040
PGNBR            MOVE PC-UNADV-TOTAL        TO DTL-UNADV-PM-TITLE       16940040
PGNBR            MOVE PV-SAVE-DEPT-NBR      TO DTL-UNADV-PM-DEPT        16950040
PGNBR         END-IF                                                    16951040
084140     END-IF.                                                      16960006
084200                                                                  16970001
084300*** THIS IS PROCESSED ONLY FOR THE ACTUAL REPORTS.                16980001
084400     IF PM100-ACTUAL                                              16990001
084600        MOVE TBL-STOT-TOT-SALE-AMT(PC-SUB-1)                      17000036
084700                                   TO DTL-PM-TOT-ACTL-SLS-AMT     17010036
084900                                                                  17020001
085000        IF TBL-STOT-TOT-SALE-AMT(PC-SUB-2) = ZEROES               17030001
085100           CONTINUE                                               17040001
085200        ELSE                                                      17050001
085300           COMPUTE PV-VOL-PCT-CHG ROUNDED =                       17060035
085310                 ((TBL-STOT-TOT-SALE-AMT(PC-SUB-2) -              17070035
085400                   TBL-STOT-TOT-SALE-AMT(PC-SUB-1)) /             17080035
085500                   TBL-STOT-TOT-SALE-AMT(PC-SUB-2)) * -100        17090035
085600                   ON SIZE ERROR                                  17100001
085700                   MOVE 0 TO PV-VOL-PCT-CHG                       17110001
085800           END-COMPUTE                                            17120001
085900           MOVE ZEROES             TO PV-ROUND-TO-TENTHS          17130001
086000           ADD PV-VOL-PCT-CHG      TO PV-ROUND-TO-TENTHS ROUNDED  17140001
086100           IF PV-VOL-PCT-CHG < 0                                  17150001
086200              PERFORM 9000-ADD-PARENTH-TO-NEG-PCT                 17160001
086300              MOVE PV-FINAL-VOL-PCT                               17170006
086310                                   TO DTL-PM-TOT-VOL-PCT-CHG      17180006
086400           ELSE                                                   17190001
086500              MOVE PV-ROUND-TO-TENTHS                             17200001
086600                                   TO DTL-VAR-VOL-PCT-CHG         17210006
086700              MOVE DETAIL-VARIABLE TO DTL-PM-TOT-VOL-PCT-CHG      17220006
086800           END-IF                                                 17230001
086810           MOVE PC-PERCENT-SIGN    TO DTL-PM-VOL-PCT-SIGN         17240036
087400        END-IF                                                    17250001
087500                                                                  17260001
087540        COMPUTE PV-SELL-THRU-PCT ROUNDED =                        17270033
087550                (TBL-STOT-TOT-SLS-UNT-QTY(PC-SUB-1) /             17280033
087560                (TBL-STOT-TOT-EOH-INV-QTY(PC-SUB-1) +             17290033
087570                 TBL-STOT-TOT-SLS-UNT-QTY(PC-SUB-1))) * 100       17300033
087580                 ON SIZE ERROR                                    17310033
087590                 MOVE 0 TO PV-SELL-THRU-PCT                       17320033
087591        END-COMPUTE                                               17330033
088300        MOVE ZEROES                TO PV-ROUND-TO-TENTHS          17340001
088400        ADD PV-SELL-THRU-PCT       TO PV-ROUND-TO-TENTHS ROUNDED  17350001
088500        MOVE PV-ROUND-TO-TENTHS    TO DTL-PM-TOT-SELL-THRU-PCT    17360006
088510        MOVE PC-PERCENT-SIGN       TO DTL-PM-SELL-PCT-SIGN        17370036
089100                                                                  17380001
089300        MOVE TBL-STOT-TOT-MD-AMT(PC-SUB-1)                        17390036
089400                                   TO DTL-PM-TOT-ACTL-MD-AMT      17400036
089510                                                                  17410029
089700        MOVE TBL-STOT-TOT-SLS-UNT-QTY(PC-SUB-1)                   17420036
089800                                   TO DTL-PM-TOT-ACTL-UNT-QTY     17430036
089910                                                                  17440029
090100        MOVE TBL-STOT-PREP-UNT-QTY(PC-SUB-1)                      17450036
090200                                   TO DTL-PM-TOT-ACTL-PREP-QTY    17460036
090310                                                                  17470029
090500        MOVE TBL-STOT-TOT-SLS-COST-AMT(PC-SUB-1)                  17480036
090600                                   TO DTL-PM-TOT-ACTL-COST-AMT    17490036
090800                                                                  17500001
090900        IF TBL-STOT-TOT-SALE-AMT(PC-SUB-1) = ZEROES               17510001
091010           MOVE ZEROES             TO PV-MU-PCT                   17520036
091020           MOVE PV-MU-PCT          TO DTL-PM-TOT-ACTL-MU-PCT      17530036
091030           MOVE PC-PERCENT-SIGN    TO DTL-PM-ACTL-PCT-SIGN        17540036
091100        ELSE                                                      17550001
091200           COMPUTE PV-MU-PCT ROUNDED =                            17560001
091300                   ((TBL-STOT-TOT-SALE-AMT(PC-SUB-1) -            17570001
091400                    TBL-STOT-TOT-SLS-COST-AMT(PC-SUB-1))/         17580001
091500                    TBL-STOT-TOT-SALE-AMT(PC-SUB-1)) * 100        17590001
091600                    ON SIZE ERROR                                 17600001
091700                    MOVE 0 TO PV-MU-PCT                           17610001
091800           END-COMPUTE                                            17620001
091900           MOVE ZEROES             TO PV-ROUND-TO-TENTHS          17630001
092000           ADD PV-MU-PCT           TO PV-ROUND-TO-TENTHS ROUNDED  17640001
092100           MOVE PV-ROUND-TO-TENTHS TO DTL-PM-TOT-ACTL-MU-PCT      17650006
092500           MOVE PC-PERCENT-SIGN    TO DTL-PM-ACTL-PCT-SIGN        17660036
092700        END-IF                                                    17670001
092800     END-IF.                                                      17680001
092900                                                                  17690001
093000*** THIS IS PROCESSED FOR FORECAST AND ACTUAL REPORTS.            17700001
093200     MOVE TBL-STOT-TOT-SALE-AMT(PC-SUB-2)                         17710036
093300                                   TO DTL-PM-TOT-FCST-SLS-AMT.    17720036
093410                                                                  17730029
093600     MOVE TBL-STOT-TOT-MD-AMT(PC-SUB-2)                           17740036
093700                                   TO DTL-PM-TOT-FCST-MD-AMT.     17750036
093810                                                                  17760029
094000     MOVE TBL-STOT-TOT-SLS-UNT-QTY(PC-SUB-2)                      17770036
094100                                   TO DTL-PM-TOT-FCST-UNT-QTY.    17780036
094210                                                                  17790029
094400     MOVE TBL-STOT-PREP-UNT-QTY(PC-SUB-2)                         17800036
094500                                   TO DTL-PM-TOT-FCST-PREP-QTY.   17810036
094700                                                                  17820029
094900     MOVE TBL-STOT-TOT-SLS-COST-AMT(PC-SUB-2)                     17830036
095000                                   TO DTL-PM-TOT-FCST-COST-AMT.   17840036
095200                                                                  17850001
095300     IF TBL-STOT-TOT-SALE-AMT(PC-SUB-2) = ZEROES                  17860001
095400         CONTINUE                                                 17870001
095500     ELSE                                                         17880001
095600         COMPUTE PV-MU-PCT ROUNDED =                              17890001
095700                 ((TBL-STOT-TOT-SALE-AMT(PC-SUB-2) -              17900001
095800                 TBL-STOT-TOT-SLS-COST-AMT(PC-SUB-2))/            17910001
095900                 TBL-STOT-TOT-SALE-AMT(PC-SUB-2)) * 100           17920001
096000                 ON SIZE ERROR                                    17930001
096100                 MOVE 0 TO PV-MU-PCT                              17940001
096200         END-COMPUTE                                              17950001
096300         MOVE ZEROES               TO PV-ROUND-TO-TENTHS          17960006
096400         ADD PV-MU-PCT             TO PV-ROUND-TO-TENTHS ROUNDED  17970006
096500         MOVE PV-ROUND-TO-TENTHS   TO DTL-PM-TOT-FCST-MU-PCT      17980006
096600         MOVE PC-PERCENT-SIGN      TO DTL-PM-FCST-PCT-SIGN        17990036
097200     END-IF.                                                      18000001
097300                                                                  18010001
097400     MOVE 2                    TO PV-ADVANCE-LINES.               18020006
097500     ADD PV-ADVANCE-LINES      TO PV-LINE-CNT.                    18030006
097600     PERFORM 3300-CHECK-LNE-CNT-FOR-TTLS.                         18040001
097700     MOVE DETAIL-PM-TOTALS     TO PV-RPT-LINE.                    18050006
097800     PERFORM 8200-WRITE-RPT-LINE.                                 18060001
097900                                                                  18070001
098000*3100-EXIT.                                                       18080006
098100 EJECT.                                                           18090001
098200                                                                  18100001
098210*----------------------------------------------------------       18110006
098220* 3110-PROCESS-DEPT-TTL.                                          18120006
098230*     PROCESS THE DEPARTMENT TOTAL OF THE REPORT.                 18130006
098240*----------------------------------------------------------       18140006
098250 3110-PROCESS-DEPT-TTL.                                           18150006
098260                                                                  18160006
098270     MOVE SPACES               TO DETAIL-TTL-TOTALS               18170006
098280                                  DETAIL-VARIABLE.                18180006
098290                                                                  18190006
098292     MOVE PC-TOTAL             TO DTL-TTL-PM-TITLE.               18200006
098293     MOVE PV-SAVE-DEPT-NBR     TO DTL-TTL-DEPT-NBR.               18210006
098294                                                                  18220006
098295*** THIS IS PROCESSED ONLY FOR THE ACTUAL REPORTS.                18230006
098296     IF PM100-ACTUAL                                              18240006
098298        MOVE TBL-DTOT-TOT-SALE-AMT(PC-SUB-1)                      18250036
098299                                   TO DTL-TTL-ACTL-TOT-SLS-AMT    18260036
098301                                                                  18270006
098302        IF TBL-DTOT-TOT-SALE-AMT(PC-SUB-2) = ZEROES               18280006
098303           CONTINUE                                               18290006
098304        ELSE                                                      18300006
098305           COMPUTE PV-VOL-PCT-CHG ROUNDED =                       18310035
098306                 ((TBL-DTOT-TOT-SALE-AMT(PC-SUB-2) -              18320035
098307                   TBL-DTOT-TOT-SALE-AMT(PC-SUB-1)) /             18330035
098308                   TBL-DTOT-TOT-SALE-AMT(PC-SUB-2)) * -100        18340035
098309                   ON SIZE ERROR                                  18350006
098310                   MOVE 0 TO PV-VOL-PCT-CHG                       18360006
098311           END-COMPUTE                                            18370006
098312           MOVE ZEROES             TO PV-ROUND-TO-TENTHS          18380006
098313           ADD PV-VOL-PCT-CHG      TO PV-ROUND-TO-TENTHS ROUNDED  18390006
098314           IF PV-VOL-PCT-CHG < 0                                  18400006
098315              PERFORM 9000-ADD-PARENTH-TO-NEG-PCT                 18410006
098316              MOVE PV-FINAL-VOL-PCT                               18420006
098317                                   TO DTL-TTL-TOT-VOL-PCT-CHG     18430006
098318           ELSE                                                   18440006
098319              MOVE PV-ROUND-TO-TENTHS                             18450006
098320                                   TO DTL-VAR-VOL-PCT-CHG         18460006
098321              MOVE DETAIL-VARIABLE TO DTL-TTL-TOT-VOL-PCT-CHG     18470006
098322           END-IF                                                 18480006
098323           MOVE PC-PERCENT-SIGN    TO DTL-TTL-VOL-PCT-SIGN        18490036
098329        END-IF                                                    18500006
098330                                                                  18510006
098332        COMPUTE PV-SELL-THRU-PCT ROUNDED =                        18520033
098333                (TBL-DTOT-TOT-SLS-UNT-QTY(PC-SUB-1) /             18530033
098334                (TBL-DTOT-TOT-EOH-INV-QTY(PC-SUB-1) +             18540033
098335                 TBL-DTOT-TOT-SLS-UNT-QTY(PC-SUB-1))) * 100       18550033
098336                 ON SIZE ERROR                                    18560033
098337                 MOVE 0 TO PV-SELL-THRU-PCT                       18570033
098338        END-COMPUTE                                               18580033
098347        MOVE ZEROES                TO PV-ROUND-TO-TENTHS          18590006
098348        ADD PV-SELL-THRU-PCT       TO PV-ROUND-TO-TENTHS ROUNDED  18600006
098349        MOVE PV-ROUND-TO-TENTHS    TO DTL-TTL-TOT-SELL-THRU-PCT   18610006
098350        MOVE PC-PERCENT-SIGN       TO DTL-TTL-SELL-PCT-SIGN       18620036
098356                                                                  18630006
098358        MOVE TBL-DTOT-TOT-MD-AMT(PC-SUB-1)                        18640036
098359                                   TO DTL-TTL-TOT-ACTL-MD-AMT     18650036
098361                                                                  18660029
098363        MOVE TBL-DTOT-TOT-SLS-UNT-QTY(PC-SUB-1)                   18670036
098364                                   TO DTL-TTL-TOT-ACTL-UNT-QTY    18680036
098366                                                                  18690029
098368        MOVE TBL-DTOT-PREP-UNT-QTY(PC-SUB-1)                      18700036
098369                                   TO DTL-TTL-TOT-ACTL-PREP-QTY   18710036
098371                                                                  18720029
098373        MOVE TBL-DTOT-TOT-SLS-COST-AMT(PC-SUB-1)                  18730036
098374                                   TO DTL-TTL-TOT-ACTL-COST-AMT   18740036
098376                                                                  18750006
098377        IF TBL-DTOT-TOT-SALE-AMT(PC-SUB-1) = ZEROES               18760006
098379           MOVE ZEROES             TO PV-MU-PCT                   18770036
098380           MOVE PV-MU-PCT          TO DTL-TTL-TOT-ACTL-MU-PCT     18780036
098381           MOVE PC-PERCENT-SIGN    TO DTL-TTL-ACTL-PCT-SIGN       18790036
098382        ELSE                                                      18800006
098383           COMPUTE PV-MU-PCT ROUNDED =                            18810006
098384                   ((TBL-DTOT-TOT-SALE-AMT(PC-SUB-1) -            18820006
098385                    TBL-DTOT-TOT-SLS-COST-AMT(PC-SUB-1))/         18830006
098386                    TBL-DTOT-TOT-SALE-AMT(PC-SUB-1)) * 100        18840006
098387                    ON SIZE ERROR                                 18850006
098388                    MOVE 0 TO PV-MU-PCT                           18860006
098389           END-COMPUTE                                            18870006
098390           MOVE ZEROES             TO PV-ROUND-TO-TENTHS          18880006
098391           ADD PV-MU-PCT           TO PV-ROUND-TO-TENTHS ROUNDED  18890006
098392           MOVE PV-ROUND-TO-TENTHS TO DTL-TTL-TOT-ACTL-MU-PCT     18900006
098393           MOVE PC-PERCENT-SIGN    TO DTL-TTL-ACTL-PCT-SIGN       18910036
098396        END-IF                                                    18920006
098397     END-IF.                                                      18930006
098398                                                                  18940006
098399*** THIS IS PROCESSED FOR FORECAST AND ACTUAL REPORTS.            18950006
098401     MOVE TBL-DTOT-TOT-SALE-AMT(PC-SUB-2)                         18960036
098402                                   TO DTL-TTL-FCST-TOT-SLS-AMT.   18970036
098404                                                                  18980029
098406     MOVE TBL-DTOT-TOT-MD-AMT(PC-SUB-2)                           18990036
098407                                   TO DTL-TTL-TOT-FCST-MD-AMT.    19000036
098409                                                                  19010029
098411     MOVE TBL-DTOT-TOT-SLS-UNT-QTY(PC-SUB-2)                      19020036
098412                                   TO DTL-TTL-TOT-FCST-UNT-QTY.   19030036
098414                                                                  19040029
098416     MOVE TBL-DTOT-PREP-UNT-QTY(PC-SUB-2)                         19050036
098417                                   TO DTL-TTL-TOT-FCST-PREP-QTY.  19060036
098419                                                                  19070029
098421     MOVE TBL-DTOT-TOT-SLS-COST-AMT(PC-SUB-2)                     19080036
098422                                   TO DTL-TTL-TOT-FCST-COST-AMT.  19090036
098424                                                                  19100006
098425     IF TBL-DTOT-TOT-SALE-AMT(PC-SUB-2) = ZEROES                  19110006
098426         CONTINUE                                                 19120006
098427     ELSE                                                         19130006
098428         COMPUTE PV-MU-PCT ROUNDED =                              19140006
098429                 ((TBL-DTOT-TOT-SALE-AMT(PC-SUB-2) -              19150006
098430                 TBL-DTOT-TOT-SLS-COST-AMT(PC-SUB-2))/            19160006
098431                 TBL-DTOT-TOT-SALE-AMT(PC-SUB-2)) * 100           19170006
098432                 ON SIZE ERROR                                    19180006
098433                 MOVE 0 TO PV-MU-PCT                              19190006
098434         END-COMPUTE                                              19200006
098435         MOVE ZEROES               TO PV-ROUND-TO-TENTHS          19210006
098436         ADD PV-MU-PCT             TO PV-ROUND-TO-TENTHS ROUNDED  19220006
098437         MOVE PV-ROUND-TO-TENTHS   TO DTL-TTL-TOT-FCST-MU-PCT     19230006
098438         MOVE PC-PERCENT-SIGN      TO DTL-TTL-FCST-PCT-SIGN       19240036
098444     END-IF.                                                      19250006
098445                                                                  19260006
098446     MOVE 1                    TO PV-ADVANCE-LINES.               19270006
098447     ADD PV-ADVANCE-LINES      TO PV-LINE-CNT.                    19280006
098448     PERFORM 3300-CHECK-LNE-CNT-FOR-TTLS.                         19290006
098449     MOVE DETAIL-TTL-TOTALS    TO PV-RPT-LINE.                    19300006
098450     PERFORM 8200-WRITE-RPT-LINE.                                 19310006
098451                                                                  19320006
098452*3110-EXIT.                                                       19330006
098453 EJECT.                                                           19340006
098454                                                                  19350006
098455*----------------------------------------------------------       19360001
098460* 3120-PROCESS-ADV-PROMO-TTL.                                     19370006
098500*     PROCESS THE ADVERTISED PROMOTION TOTAL OF THE REPORT.       19380001
098600*----------------------------------------------------------       19390001
098700 3120-PROCESS-ADV-PROMO-TTL.                                      19400006
098800                                                                  19410001
099400     MOVE SPACES               TO DETAIL-BUY-TOTALS               19420007
099500                                  DETAIL-VARIABLE.                19430006
099600     MOVE PC-ADV-BUY-TOTAL     TO DTL-BUY-PM-TITLE.               19440007
099601     MOVE PV-SAVE-BUYER-NBR    TO DTL-BUY-PM-BUYER.               19450007
099610                                                                  19460006
099700     IF PM100-ACTUAL                                              19470006
099900        MOVE TBL-BATOT-TOT-SALE-AMT(PC-SUB-1)                     19480036
100000                                   TO DTL-BUY-TOT-ACTL-SLS-AMT    19490036
100200                                                                  19500001
100210        IF TBL-BATOT-TOT-SALE-AMT(PC-SUB-2) = ZEROES              19510006
100220           CONTINUE                                               19520006
100230        ELSE                                                      19530006
100240           COMPUTE PV-VOL-PCT-CHG ROUNDED =                       19540035
100241                  ((TBL-BATOT-TOT-SALE-AMT(PC-SUB-2) -            19550035
100250                    TBL-BATOT-TOT-SALE-AMT(PC-SUB-1)) /           19560035
100260                    TBL-BATOT-TOT-SALE-AMT(PC-SUB-2)) * -100      19570035
100270                    ON SIZE ERROR                                 19580006
100280                    MOVE 0 TO PV-VOL-PCT-CHG                      19590006
100290           END-COMPUTE                                            19600006
100300           MOVE ZEROES             TO PV-ROUND-TO-TENTHS          19610006
100400           ADD PV-VOL-PCT-CHG      TO PV-ROUND-TO-TENTHS ROUNDED  19620006
100500           IF PV-VOL-PCT-CHG < 0                                  19630006
100600              PERFORM 9000-ADD-PARENTH-TO-NEG-PCT                 19640006
100700              MOVE PV-FINAL-VOL-PCT                               19650006
100800                                   TO DTL-BUY-TOT-VOL-PCT-CHG     19660007
100900           ELSE                                                   19670006
101000              MOVE PV-ROUND-TO-TENTHS                             19680006
101100                                   TO DTL-VAR-VOL-PCT-CHG         19690006
101200              MOVE DETAIL-VARIABLE TO DTL-BUY-TOT-VOL-PCT-CHG     19700007
101400           END-IF                                                 19710006
101410           MOVE PC-PERCENT-SIGN    TO DTL-BUY-VOL-PCT-SIGN        19720036
102100        END-IF                                                    19730006
102200                                                                  19740001
102240        COMPUTE PV-SELL-THRU-PCT ROUNDED =                        19750033
102250                (TBL-BATOT-TOT-SLS-UNT-QTY(PC-SUB-1) /            19760033
102260                (TBL-BATOT-TOT-EOH-INV-QTY(PC-SUB-1) +            19770033
102270                 TBL-BATOT-TOT-SLS-UNT-QTY(PC-SUB-1))) * 100      19780033
102280                 ON SIZE ERROR                                    19790033
102290                 MOVE 0 TO PV-SELL-THRU-PCT                       19800033
102291        END-COMPUTE                                               19810033
102631        MOVE ZEROES                TO PV-ROUND-TO-TENTHS          19820006
102632        ADD PV-SELL-THRU-PCT       TO PV-ROUND-TO-TENTHS ROUNDED  19830006
102633        MOVE PV-ROUND-TO-TENTHS    TO DTL-BUY-TOT-SELL-THRU-PCT   19840007
102634        MOVE PC-PERCENT-SIGN       TO DTL-BUY-SELL-PCT-SIGN       19850036
102638                                                                  19860036
102650        MOVE TBL-BATOT-TOT-MD-AMT(PC-SUB-1)                       19870036
102660                                   TO DTL-BUY-TOT-ACTL-MD-AMT     19880036
102671                                                                  19890029
102690        MOVE TBL-BATOT-TOT-SLS-UNT-QTY(PC-SUB-1)                  19900036
102700                                   TO DTL-BUY-TOT-ACTL-UNT-QTY    19910036
102810                                                                  19920029
103000        MOVE TBL-BATOT-PREP-UNT-QTY(PC-SUB-1)                     19930036
103100                                   TO DTL-BUY-TOT-ACTL-PREP-QTY   19940036
103210                                                                  19950029
103400        MOVE TBL-BATOT-TOT-SLS-COST-AMT(PC-SUB-1)                 19960036
103500                                   TO DTL-BUY-TOT-ACTL-COST-AMT   19970036
103700                                                                  19980001
103800        IF TBL-BATOT-TOT-SALE-AMT(PC-SUB-1) = ZEROES              19990006
103910           MOVE ZEROES             TO PV-MU-PCT                   20000036
103920           MOVE PV-MU-PCT          TO DTL-BUY-TOT-ACTL-MU-PCT     20010036
103930           MOVE PC-PERCENT-SIGN    TO DTL-BUY-ACTL-PCT-SIGN       20020036
104000        ELSE                                                      20030006
104100           COMPUTE PV-MU-PCT ROUNDED =                            20040006
104200                   ((TBL-BATOT-TOT-SALE-AMT(PC-SUB-1) -           20050006
104300                     TBL-BATOT-TOT-SLS-COST-AMT(PC-SUB-1))/       20060006
104400                     TBL-BATOT-TOT-SALE-AMT(PC-SUB-1)) * 100      20070006
104500                     ON SIZE ERROR                                20080006
104600                     MOVE 0 TO PV-MU-PCT                          20090006
104700           END-COMPUTE                                            20100006
104800           MOVE ZEROES             TO PV-ROUND-TO-TENTHS          20110006
104900           ADD PV-MU-PCT           TO PV-ROUND-TO-TENTHS ROUNDED  20120006
105000           MOVE PV-ROUND-TO-TENTHS TO DTL-BUY-TOT-ACTL-MU-PCT     20130036
105500           MOVE PC-PERCENT-SIGN    TO DTL-BUY-ACTL-PCT-SIGN       20140036
105700        END-IF                                                    20150006
105800     END-IF.                                                      20160006
105900                                                                  20170001
106100     MOVE TBL-BATOT-TOT-SALE-AMT(PC-SUB-2)                        20180036
106200                                   TO DTL-BUY-TOT-FCST-SLS-AMT.   20190036
106310                                                                  20200029
106500     MOVE TBL-BATOT-TOT-MD-AMT(PC-SUB-2)                          20210036
106600                                   TO DTL-BUY-TOT-FCST-MD-AMT.    20220036
106710                                                                  20230029
106900     MOVE TBL-BATOT-TOT-SLS-UNT-QTY(PC-SUB-2)                     20240036
107000                                   TO DTL-BUY-TOT-FCST-UNT-QTY.   20250036
107110                                                                  20260029
107300     MOVE TBL-BATOT-PREP-UNT-QTY(PC-SUB-2)                        20270036
107400                                   TO DTL-BUY-TOT-FCST-PREP-QTY.  20280036
107600                                                                  20290029
107800     MOVE TBL-BATOT-TOT-SLS-COST-AMT(PC-SUB-2)                    20300036
107900                                   TO DTL-BUY-TOT-FCST-COST-AMT.  20310036
108100                                                                  20320001
108200     IF TBL-BATOT-TOT-SALE-AMT(PC-SUB-2) = ZEROES                 20330006
108300        CONTINUE                                                  20340006
108400     ELSE                                                         20350006
108500        COMPUTE PV-MU-PCT ROUNDED =                               20360006
108600                ((TBL-BATOT-TOT-SALE-AMT(PC-SUB-2) -              20370006
108700                  TBL-BATOT-TOT-SLS-COST-AMT(PC-SUB-2))/          20380006
108800                  TBL-BATOT-TOT-SALE-AMT(PC-SUB-2)) * 100         20390006
108900                  ON SIZE ERROR                                   20400006
109000                  MOVE 0 TO PV-MU-PCT                             20410006
109100        END-COMPUTE                                               20420006
109200        MOVE ZEROES                TO PV-ROUND-TO-TENTHS          20430006
109300        ADD PV-MU-PCT              TO PV-ROUND-TO-TENTHS ROUNDED  20440006
109400        MOVE PV-ROUND-TO-TENTHS    TO DTL-BUY-TOT-FCST-MU-PCT     20450009
109900        MOVE PC-PERCENT-SIGN       TO DTL-BUY-FCST-PCT-SIGN       20460036
110100     END-IF.                                                      20470006
110300                                                                  20480001
110310     MOVE 2                    TO PV-ADVANCE-LINES.               20490019
110320     ADD PV-ADVANCE-LINES      TO PV-LINE-CNT.                    20500019
110330     PERFORM 3300-CHECK-LNE-CNT-FOR-TTLS.                         20510019
110340     MOVE DETAIL-HEADER-02     TO PV-RPT-LINE.                    20520019
110350     PERFORM 8200-WRITE-RPT-LINE.                                 20530019
110360                                                                  20540019
110400     MOVE 1                    TO PV-ADVANCE-LINES.               20550006
110500     ADD PV-ADVANCE-LINES      TO PV-LINE-CNT.                    20560006
110600     PERFORM 3300-CHECK-LNE-CNT-FOR-TTLS.                         20570001
110700     MOVE DETAIL-BUY-TOTALS    TO PV-RPT-LINE.                    20580007
110800     PERFORM 8200-WRITE-RPT-LINE.                                 20590001
110900                                                                  20600001
111000*3120-EXIT.                                                       20610001
111100 EJECT.                                                           20620001
111200                                                                  20630001
111300*----------------------------------------------------------       20640001
111400* 3130-PROCESS-UNADV-PROMO-TTL.                                   20650001
111500*     PROCESS THE UNADVERTISED PROMOTION TOTAL OF THE REPORT.     20660001
111600*----------------------------------------------------------       20670001
111700 3130-PROCESS-UNADV-PROMO-TTL.                                    20680001
111800                                                                  20690001
112400     MOVE SPACES               TO DETAIL-BUY-TOTALS               20700007
112500                                  DETAIL-VARIABLE.                20710006
112600     MOVE PC-UNADV-BUY-TOTAL   TO DTL-BUYER-UNADV-TITLE.          20720009
112601     MOVE PV-SAVE-BUYER-NBR    TO DTL-BUY-UNADV-BUYER.            20730007
112610                                                                  20740006
112700     IF PM100-ACTUAL                                              20750006
112900        MOVE TBL-BUTOT-TOT-SALE-AMT(PC-SUB-1)                     20760036
113000                                   TO DTL-BUY-TOT-ACTL-SLS-AMT    20770036
113200                                                                  20780001
113300        IF TBL-BUTOT-TOT-SALE-AMT(PC-SUB-2) = ZEROES              20790006
113400           CONTINUE                                               20800006
113500        ELSE                                                      20810006
113600           COMPUTE PV-VOL-PCT-CHG ROUNDED =                       20820035
113610                  ((TBL-BUTOT-TOT-SALE-AMT(PC-SUB-2) -            20830035
113700                    TBL-BUTOT-TOT-SALE-AMT(PC-SUB-1)) /           20840035
113800                    TBL-BUTOT-TOT-SALE-AMT(PC-SUB-2)) * -100      20850035
113900                    ON SIZE ERROR                                 20860006
114000                    MOVE 0 TO PV-VOL-PCT-CHG                      20870006
114100           END-COMPUTE                                            20880006
114200           MOVE ZEROES             TO PV-ROUND-TO-TENTHS          20890006
114300           ADD PV-VOL-PCT-CHG      TO PV-ROUND-TO-TENTHS ROUNDED  20900006
114400           IF PV-VOL-PCT-CHG < 0                                  20910006
114500              PERFORM 9000-ADD-PARENTH-TO-NEG-PCT                 20920006
114600              MOVE PV-FINAL-VOL-PCT                               20930006
114700                                   TO DTL-BUY-TOT-VOL-PCT-CHG     20940007
114800           ELSE                                                   20950006
114900              MOVE PV-ROUND-TO-TENTHS                             20960006
115000                                   TO DTL-VAR-VOL-PCT-CHG         20970001
115100              MOVE DETAIL-VARIABLE TO DTL-BUY-TOT-VOL-PCT-CHG     20980007
115300           END-IF                                                 20990006
115700           MOVE PC-PERCENT-SIGN    TO DTL-BUY-VOL-PCT-SIGN        21000036
116000        END-IF                                                    21010006
116100                                                                  21020001
116140        COMPUTE PV-SELL-THRU-PCT ROUNDED =                        21030033
116150                (TBL-BUTOT-TOT-SLS-UNT-QTY(PC-SUB-1) /            21040033
116160                (TBL-BUTOT-TOT-EOH-INV-QTY(PC-SUB-1) +            21050033
116170                 TBL-BUTOT-TOT-SLS-UNT-QTY(PC-SUB-1))) * 100      21060033
116180                 ON SIZE ERROR                                    21070033
116190                 MOVE 0 TO PV-SELL-THRU-PCT                       21080033
116191        END-COMPUTE                                               21090033
116450        MOVE ZEROES                TO PV-ROUND-TO-TENTHS          21100006
116460        ADD PV-SELL-THRU-PCT       TO PV-ROUND-TO-TENTHS ROUNDED  21110006
116470        MOVE PV-ROUND-TO-TENTHS    TO DTL-BUY-TOT-SELL-THRU-PCT   21120007
116471        MOVE PC-PERCENT-SIGN       TO DTL-BUY-SELL-PCT-SIGN       21130036
116480                                                                  21140001
117000        MOVE TBL-BUTOT-TOT-MD-AMT(PC-SUB-1)                       21150036
117100                                   TO DTL-BUY-TOT-ACTL-MD-AMT     21160036
117210                                                                  21170029
117400        MOVE TBL-BUTOT-TOT-SLS-UNT-QTY(PC-SUB-1)                  21180036
117500                                   TO DTL-BUY-TOT-ACTL-UNT-QTY    21190036
117601                                                                  21200029
117620        MOVE TBL-BUTOT-PREP-UNT-QTY(PC-SUB-1)                     21210036
117630                                   TO DTL-BUY-TOT-ACTL-PREP-QTY   21220036
117641                                                                  21230029
117660        MOVE TBL-BUTOT-TOT-SLS-COST-AMT(PC-SUB-1)                 21240036
117670                                   TO DTL-BUY-TOT-ACTL-COST-AMT   21250036
117690                                                                  21260001
117691        IF TBL-BUTOT-TOT-SALE-AMT(PC-SUB-1) = ZEROES              21270006
117693           MOVE ZEROES             TO PV-MU-PCT                   21280036
117694           MOVE PV-MU-PCT          TO DTL-BUY-TOT-ACTL-MU-PCT     21290036
117695           MOVE PC-PERCENT-SIGN    TO DTL-BUY-ACTL-PCT-SIGN       21300036
117696        ELSE                                                      21310006
117697           COMPUTE PV-MU-PCT ROUNDED =                            21320006
117698                   ((TBL-BUTOT-TOT-SALE-AMT(PC-SUB-1) -           21330006
117699                     TBL-BUTOT-TOT-SLS-COST-AMT(PC-SUB-1))/       21340006
117700                     TBL-BUTOT-TOT-SALE-AMT(PC-SUB-1)) * 100      21350006
117701                     ON SIZE ERROR                                21360006
117702                     MOVE 0 TO PV-MU-PCT                          21370006
117703           END-COMPUTE                                            21380006
117704           MOVE ZEROES             TO PV-ROUND-TO-TENTHS          21390006
117705           ADD PV-MU-PCT           TO PV-ROUND-TO-TENTHS ROUNDED  21400006
117706           MOVE PV-ROUND-TO-TENTHS TO DTL-BUY-TOT-ACTL-MU-PCT     21410007
117710           MOVE PC-PERCENT-SIGN    TO DTL-BUY-ACTL-PCT-SIGN       21420036
117712        END-IF                                                    21430006
117713     END-IF.                                                      21440006
117714                                                                  21450001
117716     MOVE TBL-BUTOT-TOT-SALE-AMT(PC-SUB-2)                        21460036
117717                                   TO DTL-BUY-TOT-FCST-SLS-AMT.   21470036
117719                                                                  21480029
117721     MOVE TBL-BUTOT-TOT-MD-AMT(PC-SUB-2)                          21490036
117722                                   TO DTL-BUY-TOT-FCST-MD-AMT.    21500036
117731                                                                  21510029
117733     MOVE TBL-BUTOT-TOT-SLS-UNT-QTY(PC-SUB-2)                     21520036
117734                                   TO DTL-BUY-TOT-FCST-UNT-QTY.   21530036
117736                                                                  21540029
117738     MOVE TBL-BUTOT-PREP-UNT-QTY(PC-SUB-2)                        21550036
117739                                   TO DTL-BUY-TOT-FCST-PREP-QTY.  21560036
117741                                                                  21570029
117743     MOVE TBL-BUTOT-TOT-SLS-COST-AMT(PC-SUB-2)                    21580036
117744                                   TO DTL-BUY-TOT-FCST-COST-AMT.  21590036
117746                                                                  21600001
117747     IF TBL-BUTOT-TOT-SALE-AMT(PC-SUB-2) = ZEROES                 21610006
117748        CONTINUE                                                  21620006
117749     ELSE                                                         21630006
117750        COMPUTE PV-MU-PCT ROUNDED =                               21640006
117751                ((TBL-BUTOT-TOT-SALE-AMT(PC-SUB-2) -              21650006
117752                  TBL-BUTOT-TOT-SLS-COST-AMT(PC-SUB-2))/          21660006
117753                  TBL-BUTOT-TOT-SALE-AMT(PC-SUB-2)) * 100         21670006
117754                  ON SIZE ERROR                                   21680006
117755                  MOVE 0 TO PV-MU-PCT                             21690006
117756        END-COMPUTE                                               21700006
117757        MOVE ZEROES                TO PV-ROUND-TO-TENTHS          21710006
117758        ADD PV-MU-PCT              TO PV-ROUND-TO-TENTHS ROUNDED  21720006
117759        MOVE PV-ROUND-TO-TENTHS    TO DTL-BUY-TOT-FCST-MU-PCT     21730007
117763        MOVE PC-PERCENT-SIGN       TO DTL-BUY-FCST-PCT-SIGN       21740036
117765     END-IF.                                                      21750006
117766                                                                  21760001
117767     MOVE 1                    TO PV-ADVANCE-LINES.               21770006
117768     ADD PV-ADVANCE-LINES      TO PV-LINE-CNT.                    21780006
117769     PERFORM 3300-CHECK-LNE-CNT-FOR-TTLS.                         21790001
117770     MOVE DETAIL-BUY-TOTALS    TO PV-RPT-LINE.                    21800008
117771     PERFORM 8200-WRITE-RPT-LINE.                                 21810001
117772                                                                  21820001
117773*3130-EXIT.                                                       21830001
117774 EJECT.                                                           21840001
117775                                                                  21850001
PGNBR *----------------------------------------------------------       21851041
PGNBR * 3030-PROCESS-ADV-NOPGE-TTL.                                     21852041
PGNBR *     PROCESS THE ADVERTISED PROMO WITH NO PAGE TOTAL.            21853041
PGNBR *----------------------------------------------------------       21854041
PGNBR  3030-PROCESS-ADV-NOPGE-TTL.                                      21855041
PGNBR                                                                   21856041
PGNBR      MOVE SPACES               TO DETAIL-BUY-TOTALS               21857041
PGNBR                                   DETAIL-VARIABLE.                21858041
PGNBR      MOVE PC-ANP-BUY-TOTAL     TO DTL-BUYER-ANP-TITLE.            21859041
PGNBR      MOVE PV-SAVE-BUYER-NBR    TO DTL-BUY-ANP-BUYER.              21859141
PGNBR                                                                   21859241
PGNBR      IF PM100-ACTUAL                                              21859341
PGNBR         MOVE TBL-BNPTOT-TOT-SALE-AMT(PC-SUB-1)                    21859441
PGNBR                                    TO DTL-BUY-TOT-ACTL-SLS-AMT    21859541
PGNBR                                                                   21859641
PGNBR         IF TBL-BNPTOT-TOT-SALE-AMT(PC-SUB-2) = ZEROES             21859741
PGNBR            CONTINUE                                               21859841
PGNBR         ELSE                                                      21859941
PGNBR            COMPUTE PV-VOL-PCT-CHG ROUNDED =                       21860041
PGNBR                   ((TBL-BNPTOT-TOT-SALE-AMT(PC-SUB-2) -           21860141
PGNBR                     TBL-BNPTOT-TOT-SALE-AMT(PC-SUB-1)) /          21860241
PGNBR                     TBL-BNPTOT-TOT-SALE-AMT(PC-SUB-2)) * -100     21860341
PGNBR                     ON SIZE ERROR                                 21860441
PGNBR                     MOVE 0 TO PV-VOL-PCT-CHG                      21860541
PGNBR            END-COMPUTE                                            21860641
PGNBR            MOVE ZEROES             TO PV-ROUND-TO-TENTHS          21860741
PGNBR            ADD PV-VOL-PCT-CHG      TO PV-ROUND-TO-TENTHS ROUNDED  21860841
PGNBR            IF PV-VOL-PCT-CHG < 0                                  21860941
PGNBR               PERFORM 9000-ADD-PARENTH-TO-NEG-PCT                 21861041
PGNBR               MOVE PV-FINAL-VOL-PCT                               21861141
PGNBR                                    TO DTL-BUY-TOT-VOL-PCT-CHG     21861241
PGNBR            ELSE                                                   21861341
PGNBR               MOVE PV-ROUND-TO-TENTHS                             21861441
PGNBR                                    TO DTL-VAR-VOL-PCT-CHG         21861541
PGNBR               MOVE DETAIL-VARIABLE TO DTL-BUY-TOT-VOL-PCT-CHG     21861641
PGNBR            END-IF                                                 21861741
PGNBR            MOVE PC-PERCENT-SIGN    TO DTL-BUY-VOL-PCT-SIGN        21861841
PGNBR         END-IF                                                    21861941
PGNBR                                                                   21862041
PGNBR         COMPUTE PV-SELL-THRU-PCT ROUNDED =                        21862141
PGNBR                 (TBL-BNPTOT-TOT-SLS-UNT-QTY(PC-SUB-1) /           21862241
PGNBR                 (TBL-BNPTOT-TOT-EOH-INV-QTY(PC-SUB-1) +           21862341
PGNBR                  TBL-BNPTOT-TOT-SLS-UNT-QTY(PC-SUB-1))) * 100     21862441
PGNBR                  ON SIZE ERROR                                    21862541
PGNBR                  MOVE 0 TO PV-SELL-THRU-PCT                       21862641
PGNBR         END-COMPUTE                                               21862741
PGNBR         MOVE ZEROES                TO PV-ROUND-TO-TENTHS          21862841
PGNBR         ADD PV-SELL-THRU-PCT       TO PV-ROUND-TO-TENTHS ROUNDED  21862941
PGNBR         MOVE PV-ROUND-TO-TENTHS    TO DTL-BUY-TOT-SELL-THRU-PCT   21863041
PGNBR         MOVE PC-PERCENT-SIGN       TO DTL-BUY-SELL-PCT-SIGN       21863141
PGNBR                                                                   21863241
PGNBR         MOVE TBL-BNPTOT-TOT-MD-AMT(PC-SUB-1)                      21863341
PGNBR                                    TO DTL-BUY-TOT-ACTL-MD-AMT     21863441
PGNBR                                                                   21863541
PGNBR         MOVE TBL-BNPTOT-TOT-SLS-UNT-QTY(PC-SUB-1)                 21863641
PGNBR                                    TO DTL-BUY-TOT-ACTL-UNT-QTY    21863741
PGNBR                                                                   21863841
PGNBR         MOVE TBL-BNPTOT-PREP-UNT-QTY(PC-SUB-1)                    21863941
PGNBR                                    TO DTL-BUY-TOT-ACTL-PREP-QTY   21864041
PGNBR                                                                   21864141
PGNBR         MOVE TBL-BNPTOT-TOT-SLS-COST-AMT(PC-SUB-1)                21864241
PGNBR                                    TO DTL-BUY-TOT-ACTL-COST-AMT   21864341
PGNBR                                                                   21864441
PGNBR         IF TBL-BNPTOT-TOT-SALE-AMT(PC-SUB-1) = ZEROES             21864541
PGNBR            MOVE ZEROES             TO PV-MU-PCT                   21864641
PGNBR            MOVE PV-MU-PCT          TO DTL-BUY-TOT-ACTL-MU-PCT     21864741
PGNBR            MOVE PC-PERCENT-SIGN    TO DTL-BUY-ACTL-PCT-SIGN       21864841
PGNBR         ELSE                                                      21864941
PGNBR            COMPUTE PV-MU-PCT ROUNDED =                            21865041
PGNBR                    ((TBL-BNPTOT-TOT-SALE-AMT(PC-SUB-1) -          21865141
PGNBR                      TBL-BNPTOT-TOT-SLS-COST-AMT(PC-SUB-1))/      21865241
PGNBR                      TBL-BNPTOT-TOT-SALE-AMT(PC-SUB-1)) * 100     21865341
PGNBR                      ON SIZE ERROR                                21865441
PGNBR                      MOVE 0 TO PV-MU-PCT                          21865541
PGNBR            END-COMPUTE                                            21865641
PGNBR            MOVE ZEROES             TO PV-ROUND-TO-TENTHS          21865741
PGNBR            ADD PV-MU-PCT           TO PV-ROUND-TO-TENTHS ROUNDED  21865841
PGNBR            MOVE PV-ROUND-TO-TENTHS TO DTL-BUY-TOT-ACTL-MU-PCT     21865941
PGNBR            MOVE PC-PERCENT-SIGN    TO DTL-BUY-ACTL-PCT-SIGN       21866041
PGNBR         END-IF                                                    21866141
PGNBR      END-IF.                                                      21866241
PGNBR                                                                   21866341
PGNBR      MOVE TBL-BNPTOT-TOT-SALE-AMT(PC-SUB-2)                       21866441
PGNBR                                    TO DTL-BUY-TOT-FCST-SLS-AMT.   21866541
PGNBR                                                                   21866641
PGNBR      MOVE TBL-BNPTOT-TOT-MD-AMT(PC-SUB-2)                         21866741
PGNBR                                    TO DTL-BUY-TOT-FCST-MD-AMT.    21866841
PGNBR                                                                   21866941
PGNBR      MOVE TBL-BNPTOT-TOT-SLS-UNT-QTY(PC-SUB-2)                    21867041
PGNBR                                    TO DTL-BUY-TOT-FCST-UNT-QTY.   21867141
PGNBR                                                                   21867241
PGNBR      MOVE TBL-BNPTOT-PREP-UNT-QTY(PC-SUB-2)                       21867341
PGNBR                                    TO DTL-BUY-TOT-FCST-PREP-QTY.  21867441
PGNBR                                                                   21867541
PGNBR      MOVE TBL-BNPTOT-TOT-SLS-COST-AMT(PC-SUB-2)                   21867641
PGNBR                                    TO DTL-BUY-TOT-FCST-COST-AMT.  21867741
PGNBR                                                                   21867841
PGNBR      IF TBL-BNPTOT-TOT-SALE-AMT(PC-SUB-2) = ZEROES                21867941
PGNBR         CONTINUE                                                  21868041
PGNBR      ELSE                                                         21868141
PGNBR         COMPUTE PV-MU-PCT ROUNDED =                               21868241
PGNBR                 ((TBL-BNPTOT-TOT-SALE-AMT(PC-SUB-2) -             21868341
PGNBR                   TBL-BNPTOT-TOT-SLS-COST-AMT(PC-SUB-2))/         21868441
PGNBR                   TBL-BNPTOT-TOT-SALE-AMT(PC-SUB-2)) * 100        21868541
PGNBR                   ON SIZE ERROR                                   21868641
PGNBR                   MOVE 0 TO PV-MU-PCT                             21868741
PGNBR         END-COMPUTE                                               21868841
PGNBR         MOVE ZEROES                TO PV-ROUND-TO-TENTHS          21868941
PGNBR         ADD PV-MU-PCT              TO PV-ROUND-TO-TENTHS ROUNDED  21869041
PGNBR         MOVE PV-ROUND-TO-TENTHS    TO DTL-BUY-TOT-FCST-MU-PCT     21869141
PGNBR         MOVE PC-PERCENT-SIGN       TO DTL-BUY-FCST-PCT-SIGN       21869241
PGNBR      END-IF.                                                      21869341
PGNBR                                                                   21869441
PGNBR      MOVE 1                    TO PV-ADVANCE-LINES.               21869541
PGNBR      ADD PV-ADVANCE-LINES      TO PV-LINE-CNT.                    21869641
PGNBR      PERFORM 3300-CHECK-LNE-CNT-FOR-TTLS.                         21869741
PGNBR      MOVE DETAIL-BUY-TOTALS    TO PV-RPT-LINE.                    21869841
PGNBR      PERFORM 8200-WRITE-RPT-LINE.                                 21869941
PGNBR                                                                   21870041
PGNBR *3030-EXIT.                                                       21870141
PGNBR  EJECT.                                                           21870241
PGNBR                                                                   21870341
117776*----------------------------------------------------------       21870441
117777* 3140-PROCESS-BUYER-TTL.                                         21871041
117778*     PROCESS THE COMPLETE PROMOTION TOTAL.                       21880001
117779*----------------------------------------------------------       21890001
117780 3140-PROCESS-BUYER-TTL.                                          21900006
117790                                                                  21910001
117800     MOVE SPACES               TO DETAIL-TTL-TOTALS               21920007
117900                                  DETAIL-VARIABLE.                21930006
118000                                                                  21940001
118010     MOVE PC-BUY-TOTAL         TO DTL-TTL-BUYER-TITLE.            21950008
118011     MOVE PV-SAVE-BUYER-NBR    TO DTL-TTL-BUY-NBR.                21960007
118020                                                                  21970001
118021*** THIS IS PROCESSED ONLY FOR THE ACTUAL REPORTS.                21980001
118022     IF PM100-ACTUAL                                              21990001
118024        MOVE TBL-BTOT-TOT-SALE-AMT(PC-SUB-1)                      22000036
118025                                   TO DTL-TTL-ACTL-TOT-SLS-AMT    22010036
118027                                                                  22020001
118028        IF TBL-BTOT-TOT-SALE-AMT(PC-SUB-2) = ZEROES               22030006
118029           CONTINUE                                               22040001
118030        ELSE                                                      22050001
118031           COMPUTE PV-VOL-PCT-CHG ROUNDED =                       22060035
118032                 ((TBL-BTOT-TOT-SALE-AMT(PC-SUB-2) -              22070035
118033                   TBL-BTOT-TOT-SALE-AMT(PC-SUB-1)) /             22080035
118034                   TBL-BTOT-TOT-SALE-AMT(PC-SUB-2)) * -100        22090035
118035                   ON SIZE ERROR                                  22100001
118036                   MOVE 0 TO PV-VOL-PCT-CHG                       22110001
118037           END-COMPUTE                                            22120001
118038           MOVE ZEROES             TO PV-ROUND-TO-TENTHS          22130001
118039           ADD PV-VOL-PCT-CHG      TO PV-ROUND-TO-TENTHS ROUNDED  22140001
118040           IF PV-VOL-PCT-CHG < 0                                  22150001
118041              PERFORM 9000-ADD-PARENTH-TO-NEG-PCT                 22160001
118042              MOVE PV-FINAL-VOL-PCT                               22170006
118043                                   TO DTL-TTL-TOT-VOL-PCT-CHG     22180007
118044           ELSE                                                   22190001
118045              MOVE PV-ROUND-TO-TENTHS                             22200001
118046                                   TO DTL-VAR-VOL-PCT-CHG         22210006
118047              MOVE DETAIL-VARIABLE TO DTL-TTL-TOT-VOL-PCT-CHG     22220007
118048           END-IF                                                 22230001
118052           MOVE PC-PERCENT-SIGN    TO DTL-TTL-VOL-PCT-SIGN        22240036
118061        END-IF                                                    22250001
118062                                                                  22260001
118066        COMPUTE PV-SELL-THRU-PCT ROUNDED =                        22270033
118067                (TBL-BTOT-TOT-SLS-UNT-QTY(PC-SUB-1) /             22280033
118068                (TBL-BTOT-TOT-EOH-INV-QTY(PC-SUB-1) +             22290033
118069                 TBL-BTOT-TOT-SLS-UNT-QTY(PC-SUB-1))) * 100       22300033
118070                 ON SIZE ERROR                                    22310033
118071                 MOVE 0 TO PV-SELL-THRU-PCT                       22320033
118072        END-COMPUTE                                               22330033
118081        MOVE ZEROES                TO PV-ROUND-TO-TENTHS          22340001
118082        ADD PV-SELL-THRU-PCT       TO PV-ROUND-TO-TENTHS ROUNDED  22350001
118083        MOVE PV-ROUND-TO-TENTHS    TO DTL-TTL-TOT-SELL-THRU-PCT   22360007
118084        MOVE PC-PERCENT-SIGN       TO DTL-TTL-SELL-PCT-SIGN       22370036
118085                                                                  22380036
118091        MOVE TBL-BTOT-TOT-MD-AMT(PC-SUB-1)                        22390036
118092                                   TO DTL-TTL-TOT-ACTL-MD-AMT     22400036
118094                                                                  22410029
118096        MOVE TBL-BTOT-TOT-SLS-UNT-QTY(PC-SUB-1)                   22420036
118097                                   TO DTL-TTL-TOT-ACTL-UNT-QTY    22430036
118099                                                                  22440029
118101        MOVE TBL-BTOT-PREP-UNT-QTY(PC-SUB-1)                      22450036
118102                                   TO DTL-TTL-TOT-ACTL-PREP-QTY   22460036
118104                                                                  22470029
118106        MOVE TBL-BTOT-TOT-SLS-COST-AMT(PC-SUB-1)                  22480036
118107                                   TO DTL-TTL-TOT-ACTL-COST-AMT   22490036
118109                                                                  22500001
118110        IF TBL-BTOT-TOT-SALE-AMT(PC-SUB-1) = ZEROES               22510006
118112           MOVE ZEROES             TO PV-MU-PCT                   22520036
118113           MOVE PV-MU-PCT          TO DTL-TTL-TOT-ACTL-MU-PCT     22530036
118114           MOVE PC-PERCENT-SIGN    TO DTL-TTL-ACTL-PCT-SIGN       22540036
118115        ELSE                                                      22550001
118116           COMPUTE PV-MU-PCT ROUNDED =                            22560001
118117                   ((TBL-BTOT-TOT-SALE-AMT(PC-SUB-1) -            22570006
118118                    TBL-BTOT-TOT-SLS-COST-AMT(PC-SUB-1))/         22580006
118119                    TBL-BTOT-TOT-SALE-AMT(PC-SUB-1)) * 100        22590006
118120                    ON SIZE ERROR                                 22600001
118121                    MOVE 0 TO PV-MU-PCT                           22610001
118122           END-COMPUTE                                            22620001
118123           MOVE ZEROES             TO PV-ROUND-TO-TENTHS          22630001
118124           ADD PV-MU-PCT           TO PV-ROUND-TO-TENTHS ROUNDED  22640001
118125           MOVE PV-ROUND-TO-TENTHS TO DTL-TTL-TOT-ACTL-MU-PCT     22650007
118129           MOVE PC-PERCENT-SIGN    TO DTL-TTL-ACTL-PCT-SIGN       22660036
118131        END-IF                                                    22670001
118132     END-IF.                                                      22680001
118133                                                                  22690001
118134*** THIS IS PROCESSED FOR FORECAST AND ACTUAL REPORTS.            22700001
118136     MOVE TBL-BTOT-TOT-SALE-AMT(PC-SUB-2)                         22710036
118137                                   TO DTL-TTL-FCST-TOT-SLS-AMT.   22720036
118139                                                                  22730029
118141     MOVE TBL-BTOT-TOT-MD-AMT(PC-SUB-2)                           22740036
118142                                   TO DTL-TTL-TOT-FCST-MD-AMT.    22750036
118144                                                                  22760029
118146     MOVE TBL-BTOT-TOT-SLS-UNT-QTY(PC-SUB-2)                      22770036
118147                                   TO DTL-TTL-TOT-FCST-UNT-QTY.   22780036
118149                                                                  22790029
118151     MOVE TBL-BTOT-PREP-UNT-QTY(PC-SUB-2)                         22800036
118152                                   TO DTL-TTL-TOT-FCST-PREP-QTY.  22810036
118154                                                                  22820029
118156     MOVE TBL-BTOT-TOT-SLS-COST-AMT(PC-SUB-2)                     22830036
118157                                   TO DTL-TTL-TOT-FCST-COST-AMT.  22840036
118159                                                                  22850001
118160     IF TBL-BTOT-TOT-SALE-AMT(PC-SUB-2) = ZEROES                  22860006
118161         CONTINUE                                                 22870001
118162     ELSE                                                         22880001
118163         COMPUTE PV-MU-PCT ROUNDED =                              22890001
118164                 ((TBL-BTOT-TOT-SALE-AMT(PC-SUB-2) -              22900006
118165                 TBL-BTOT-TOT-SLS-COST-AMT(PC-SUB-2))/            22910006
118166                 TBL-BTOT-TOT-SALE-AMT(PC-SUB-2)) * 100           22920006
118167                 ON SIZE ERROR                                    22930001
118168                 MOVE 0 TO PV-MU-PCT                              22940001
118169         END-COMPUTE                                              22950001
118170         MOVE ZEROES               TO PV-ROUND-TO-TENTHS          22960006
118171         ADD PV-MU-PCT             TO PV-ROUND-TO-TENTHS ROUNDED  22970006
118172         MOVE PV-ROUND-TO-TENTHS   TO DTL-TTL-TOT-FCST-MU-PCT     22980007
118176         MOVE PC-PERCENT-SIGN      TO DTL-TTL-FCST-PCT-SIGN       22990036
118178     END-IF.                                                      23000001
118179                                                                  23010001
118180     MOVE 1                    TO PV-ADVANCE-LINES.               23020006
118181     ADD PV-ADVANCE-LINES      TO PV-LINE-CNT.                    23030006
118182     PERFORM 3300-CHECK-LNE-CNT-FOR-TTLS.                         23040001
118183     MOVE DETAIL-TTL-TOTALS    TO PV-RPT-LINE.                    23050008
118184     PERFORM 8200-WRITE-RPT-LINE.                                 23060001
118185                                                                  23070001
118186*3140-EXIT.                                                       23080001
118187 EJECT.                                                           23090001
118188                                                                  23100001
118189*----------------------------------------------------------       23110001
118190* 3200-CHECK-MAX-LINE-CNT.                                        23120001
118191*     CHECKS TO SEE IF IT HAS REACHED THE MAXIMUM AMOUNT          23130001
118192*     OF LINES FOR THE PAGE. WRITES OUT ALL HEADERS.              23140001
118193*----------------------------------------------------------       23150001
118194 3200-CHECK-MAX-LINE-CNT.                                         23160001
118195                                                                  23170001
118196     IF PV-LINE-CNT > PC-MAX-LINE-CNT                             23180001
118197         PERFORM 3600-PROCESS-PAGE-HEADER                         23190005
118198         PERFORM 3500-PROCESS-DETAIL-HEADER                       23200008
118199         MOVE 1                  TO PV-ADVANCE-LINES              23210001
118200         ADD PV-ADVANCE-LINES    TO PV-LINE-CNT                   23220001
118201     END-IF.                                                      23230001
118202                                                                  23240001
118203*3200-EXIT.                                                       23250001
118204 EJECT.                                                           23260001
118205                                                                  23270001
118206*----------------------------------------------------------       23280001
118207* 3300-CHECK-LNE-CNT-FOR-TTLS.                                    23290001
118208*     CHECKS TO SEE IF IT HAS REACHED THE MAXIMUM AMOUNT          23300001
118210*     OF LINES FOR THE PAGE. WRITES OUT ALL HEADERS.              23310001
118300*----------------------------------------------------------       23320001
118301 3300-CHECK-LNE-CNT-FOR-TTLS.                                     23330001
118302                                                                  23340001
118303     IF PV-LINE-CNT > PC-MAX-LINE-CNT                             23350001
118304         PERFORM 3600-PROCESS-PAGE-HEADER                         23360005
118309         MOVE 2                  TO PV-ADVANCE-LINES              23370006
118310         ADD PV-ADVANCE-LINES    TO PV-LINE-CNT                   23380006
118311     END-IF.                                                      23390001
118312                                                                  23400001
118313*3300-EXIT.                                                       23410001
118314 EJECT.                                                           23420001
118315                                                                  23430001
118316*----------------------------------------------------------       23440001
118317* 3400-PROCESS-ADV-UNADV-LINES.                                   23450005
118318*     PROCESS THE UNADVERTISED/ADVERTISED START SECTION.          23460005
118319*----------------------------------------------------------       23470001
118320 3400-PROCESS-ADV-UNADV-LINES.                                    23480005
118321                                                                  23490001
118323     EVALUATE TRUE                                                23500001
118324         WHEN PM100-AD-PG-NBR NOT = 0 AND                         23510001
118325              PM100-PROMO-ITM-ADV-IND = 'Y'                       23520001
118331              SET PS-ADV-PROMO-TTL    TO TRUE                     23530040
PGNBR          WHEN PM100-AD-PG-NBR = 0 AND                             23531040
PGNBR               PM100-PROMO-ITM-ADV-IND = 'Y'                       23532040
PGNBR               SET PS-ADV-NOPGE-TTL    TO TRUE                     23533040
118332         WHEN PM100-AD-PG-NBR = 0 AND                             23540001
118333              PM100-PROMO-ITM-ADV-IND = 'N'                       23550001
118336              SET PS-UNADV-PROMO-TTL  TO TRUE                     23560001
118337     END-EVALUATE.                                                23570001
118350                                                                  23580001
118351*3400-EXIT.                                                       23590001
118352 EJECT.                                                           23600001
118353                                                                  23610001
118354*----------------------------------------------------------       23620005
118355* 3500-PROCESS-DETAIL-HEADER.                                     23630005
118356*     PROCESS REPORT DETAIL HEADER LINES.                         23640005
118357*----------------------------------------------------------       23650005
118358 3500-PROCESS-DETAIL-HEADER.                                      23660005
118359                                                                  23670005
118360     MOVE SPACES                 TO DETAIL-HEADER-01.             23680005
118370     MOVE PC-DEPARTMENT          TO DTL-HDR-01-PM-TITLE.          23690005
118371     MOVE PM100-DEPT-NBR         TO DTL-HDR-01-PM-DEPT-NBR.       23700005
118372     MOVE PM100-DEPT-NM          TO DTL-HDR-01-PM-DEPT-NM.        23710005
118377     MOVE 2                      TO PV-ADVANCE-LINES              23720005
118378                                    PV-SAVE-LINE-AMT.             23730005
118379     ADD PV-ADVANCE-LINES        TO PV-LINE-CNT.                  23740005
118380     IF PV-LINE-CNT > PC-MAX-LINE-CNT                             23750005
118381         PERFORM 3600-PROCESS-PAGE-HEADER                         23760005
118382         MOVE PV-SAVE-LINE-AMT   TO PV-ADVANCE-LINES              23770005
118383         ADD PV-ADVANCE-LINES    TO PV-LINE-CNT                   23780005
118384     END-IF.                                                      23790005
118385     MOVE DETAIL-HEADER-01       TO PV-RPT-LINE.                  23800005
118386     PERFORM 8200-WRITE-RPT-LINE.                                 23810005
118387                                                                  23820005
118388     MOVE 1                      TO PV-ADVANCE-LINES.             23830005
118390     ADD PV-ADVANCE-LINES        TO PV-LINE-CNT.                  23840005
118396     MOVE DETAIL-HEADER-02       TO PV-RPT-LINE.                  23850005
118397     PERFORM 8200-WRITE-RPT-LINE.                                 23860005
118398                                                                  23870005
118399*3500-EXIT.                                                       23880005
118400 EJECT.                                                           23890005
118410                                                                  23900005
118422*----------------------------------------------------------       23910001
118423* 3600-PROCESS-PAGE-HEADER.                                       23920005
118424*     PROCESS REPORT PAGE HEADERS.                                23930001
118425*----------------------------------------------------------       23940001
118426 3600-PROCESS-PAGE-HEADER.                                        23950005
118427                                                                  23960001
118428     MOVE ZEROES                 TO PV-LINE-CNT.                  23970001
118429     ADD 1                       TO PV-PAGE-CNT.                  23980001
118430     MOVE PV-PAGE-CNT            TO DP250O-PAGE-NUMBER.           23990001
118431     MOVE 1                      TO DP250O-REPORT-NUMBER.         24000001
118432                                                                  24010001
118433     MOVE DP250O-STANDRD-HEADER-250-COLS                          24020001
118434                                 TO PV-RPT-LINE.                  24030001
118435     PERFORM 8100-WRITE-SLS-RPT-NEW-PAGE.                         24040001
118436                                                                  24050001
118437     MOVE HEADER-01              TO PV-RPT-LINE.                  24060001
118438     MOVE 2                      TO PV-ADVANCE-LINES.             24070001
118439     ADD PV-ADVANCE-LINES        TO PV-LINE-CNT.                  24080001
118440     PERFORM 8200-WRITE-RPT-LINE.                                 24090001
118441                                                                  24100001
118442     MOVE HEADER-02              TO PV-RPT-LINE.                  24110001
118443     MOVE 1                      TO PV-ADVANCE-LINES.             24120001
118444     ADD PV-ADVANCE-LINES        TO PV-LINE-CNT.                  24130001
118445     PERFORM 8200-WRITE-RPT-LINE.                                 24140001
118446                                                                  24150001
118447     MOVE HEADER-03              TO PV-RPT-LINE.                  24160001
118448     MOVE 1                      TO PV-ADVANCE-LINES.             24170001
118449     ADD PV-ADVANCE-LINES        TO PV-LINE-CNT.                  24180001
118450     PERFORM 8200-WRITE-RPT-LINE.                                 24190001
118451                                                                  24200001
118452     MOVE HEADER-04              TO PV-RPT-LINE.                  24210001
118453     MOVE 1                      TO PV-ADVANCE-LINES.             24220001
118454     ADD PV-ADVANCE-LINES        TO PV-LINE-CNT.                  24230001
118455     PERFORM 8200-WRITE-RPT-LINE                                  24240001
118456                                                                  24250001
118462     MOVE HEADER-05              TO PV-RPT-LINE.                  24260001
118463     MOVE 2                      TO PV-ADVANCE-LINES.             24270001
118464     ADD PV-ADVANCE-LINES        TO PV-LINE-CNT.                  24280001
118465     PERFORM 8200-WRITE-RPT-LINE                                  24290001
118466                                                                  24300001
118467     MOVE HEADER-06              TO PV-RPT-LINE.                  24310001
118468     MOVE 1                      TO PV-ADVANCE-LINES.             24320001
118469     ADD PV-ADVANCE-LINES        TO PV-LINE-CNT.                  24330001
118470     PERFORM 8200-WRITE-RPT-LINE.                                 24340001
118471                                                                  24350001
118472*3600-EXIT.                                                       24360005
118473 EJECT.                                                           24370001
118474                                                                  24380001
118475*----------------------------------------------------------       24390001
118476* 8000-READ-SALES-RESULTS.                                        24400001
118477*     READ SALES RESULTS INPUT RECORDS.                           24410001
118478*----------------------------------------------------------       24420001
118479 8000-READ-SALES-RESULTS.                                         24430001
118480                                                                  24440001
118481     READ PROMO-ITM-SUMM-FILE INTO PM100-PROMO-ITM-SUMM           24450001
118482          AT END                                                  24460001
118483             SET PS-EOF-SALES-RESULTS TO TRUE                     24470001
118484     END-READ.                                                    24480001
118485                                                                  24490001
118486*8000-EXIT.                                                       24500001
118487 EJECT.                                                           24510001
118488                                                                  24520001
118489*----------------------------------------------------------       24530001
118490* 8100-WRITE-SLS-RPT-NEW-PAGE.                                    24540001
118491*     WRITES NEW PAGE.                                            24550001
118492*----------------------------------------------------------       24560001
118493 8100-WRITE-SLS-RPT-NEW-PAGE.                                     24570001
118494                                                                  24580001
118495     WRITE PROMO-ITM-SUMM-RPT-LINE                                24590001
118496           FROM PV-RPT-LINE                                       24600001
118497           AFTER ADVANCING PAGE.                                  24610001
118498                                                                  24620001
118499     ADD 2            TO PV-LINE-CNT.                             24630001
118500                                                                  24640001
118501*8100-EXIT.                                                       24650001
118502 EJECT.                                                           24660001
118503                                                                  24670001
118504*----------------------------------------------------------       24680001
118505* 8200-WRITE-RPT-LINE.                                            24690001
118506*     WRITES OUT A LINE ON THE REPORT.                            24700001
118507*----------------------------------------------------------       24710001
118508 8200-WRITE-RPT-LINE.                                             24720001
118509                                                                  24730001
118510     WRITE PROMO-ITM-SUMM-RPT-LINE                                24740001
118511           FROM PV-RPT-LINE                                       24750001
118512           AFTER ADVANCING PV-ADVANCE-LINES.                      24760001
118513                                                                  24770001
118514*8200-EXIT.                                                       24780001
118515 EJECT.                                                           24790001
118516                                                                  24800001
118529*----------------------------------------------------------       24810001
118530* 9000-ADD-PARENTH-TO-NEG-PCT.                                    24820001
118531*     PUTS PARENTHESES AROUND A NEGATIVE PERCENT FOR THE          24830001
118532*     VOLUME PERCETN CHANGE FIELD.                                24840001
118533*----------------------------------------------------------       24850001
118534 9000-ADD-PARENTH-TO-NEG-PCT.                                     24860001
118535                                                                  24870001
118536     INITIALIZE PV-ROUND-VOL-PCT                                  24880001
118537                PV-TRUNCAT-VOL-PCT                                24890001
118538                PV-NUM-VOL-PCT                                    24900001
118539                PV-FINAL-VOL-PCT                                  24910001
118540                PV-SEP-VOL-PCT                                    24920001
118541                PA-CNT-SPACES.                                    24930001
118542                                                                  24940001
118543     MOVE PV-ROUND-TO-TENTHS      TO PV-ROUND-VOL-PCT.            24950001
118544     MOVE PV-ROUND-VOL-PCT        TO PV-TRUNCAT-VOL-PCT.          24960001
118545     MOVE PV-TRUNCAT-VOL-PCT-X    TO PV-NUM-VOL-PCT.              24970001
118546     MOVE PV-TRUNCAT-VOL-PCT-X    TO PV-SEP-VOL-PCT.              24980001
118547     INSPECT PV-CHAR-VOL-PCT-1 REPLACING                          24990001
118548             LEADING ZERO BY " ".                                 25000001
118549     INSPECT PV-CHAR-VOL-PCT-1                                    25010001
118550            TALLYING PA-CNT-SPACES FOR ALL " ".                   25020001
118551     EVALUATE TRUE                                                25030001
118552         WHEN PA-CNT-SPACES = 0                                   25040001
118553              MOVE PC-FRONT-PAR     TO PV-FINAL-VOL-PCT-1         25050001
118554              MOVE PV-SEP-VOL-PCT-1 TO PV-FINAL-VOL-PCT-2         25060001
118555              MOVE PV-SEP-VOL-PCT-2 TO PV-FINAL-VOL-PCT-3         25070001
118556              MOVE PV-SEP-VOL-PCT-3 TO PV-FINAL-VOL-PCT-4         25080001
118557              MOVE PV-SEP-VOL-PCT-4 TO PV-FINAL-VOL-PCT-5         25090001
118558              MOVE PV-SEP-VOL-PCT-5 TO PV-FINAL-VOL-PCT-6         25100024
118559         WHEN PA-CNT-SPACES = 1                                   25110001
118560              MOVE PC-FRONT-PAR     TO PV-FINAL-VOL-PCT-2         25120001
118561              MOVE PV-SEP-VOL-PCT-2 TO PV-FINAL-VOL-PCT-3         25130001
118562              MOVE PV-SEP-VOL-PCT-3 TO PV-FINAL-VOL-PCT-4         25140001
118563              MOVE PV-SEP-VOL-PCT-4 TO PV-FINAL-VOL-PCT-5         25150001
118564              MOVE PV-SEP-VOL-PCT-5 TO PV-FINAL-VOL-PCT-6         25160024
118565         WHEN PA-CNT-SPACES = 2                                   25170001
118566              MOVE PC-FRONT-PAR     TO PV-FINAL-VOL-PCT-3         25180001
118567              MOVE PV-SEP-VOL-PCT-3 TO PV-FINAL-VOL-PCT-4         25190001
118568              MOVE PV-SEP-VOL-PCT-4 TO PV-FINAL-VOL-PCT-5         25200001
118569              MOVE PV-SEP-VOL-PCT-5 TO PV-FINAL-VOL-PCT-6         25210024
118570         WHEN PA-CNT-SPACES = 3                                   25220001
118571              MOVE PC-FRONT-PAR     TO PV-FINAL-VOL-PCT-4         25230001
118572              MOVE PV-SEP-VOL-PCT-4 TO PV-FINAL-VOL-PCT-5         25240001
118573              MOVE PV-SEP-VOL-PCT-5 TO PV-FINAL-VOL-PCT-6         25250024
118574         WHEN PA-CNT-SPACES = 4                                   25260024
118575              MOVE PC-FRONT-PAR     TO PV-FINAL-VOL-PCT-5         25270024
118576              MOVE PV-SEP-VOL-PCT-5 TO PV-FINAL-VOL-PCT-6         25280024
118577     END-EVALUATE.                                                25290001
118578     MOVE PC-BACK-PAR               TO PV-FINAL-VOL-PCT-7.        25300024
118579                                                                  25310001
118580                                                                  25320001
118581*9000-EXIT.                                                       25330001
118582 EJECT.                                                           25340001
118583                                                                  25350001
118584*----------------------------------------------------------       25360001
118585* 9100-CALENDAR-ROUTINE.                                          25370001
118586*     CALLS THE DATE ROUTINE WITH SPECIFIED PARAMETERS.           25380001
118587*----------------------------------------------------------       25390001
118588 9100-CALENDAR-ROUTINE.                                           25400001
118589                                                                  25410001
118590     CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51 DPG52          25420001
118591                                             DPG53 DPG54          25430001
118592                                             DPG55 DPG56.         25440001
118593     EVALUATE TRUE                                                25450001
118594         WHEN DPG54-NO-ERROR                                      25460001
118595             CONTINUE                                             25470001
118596         WHEN DPG54-WARNING-ERROR                                 25480001
118597             DISPLAY '** WARNING - PROGRAM '                      25490001
118598                      PC-CURRENT-PROGRAM-NAME ' **'               25500001
118599             DISPLAY '** 9100-CALENDAR-ROUTINE'                   25510001
118600             DISPLAY '** CALL TO DPKUT500 RETURNED WARNING ERROR' 25520001
118601             DISPLAY '** DPG54-ERROR-MESSAGE: '                   25530001
118602             DISPLAY '** ' DPG54-ERROR-MESSAGE                    25540001
118603             DISPLAY '** DPG51: ' DPG51                           25550001
118604             DISPLAY '** DPG52: ' DPG52                           25560001
118605             DISPLAY '** PLEASE INVESTIGATE FURTHER **'           25570001
118606         WHEN DPG54-SEVERE-ERROR                                  25580001
118607             DISPLAY '** ABEND - PROGRAM '                        25590001
118608                      PC-CURRENT-PROGRAM-NAME ' **'               25600001
118609             DISPLAY '** 9100-CALENDAR-ROUTINE'                   25610001
118610             DISPLAY '** CALL TO DPKUT500 RETURNED SEVERE ERROR'  25620001
118611             IF DPG54-CALENDAR-TYPE-INVALID                       25630001
118620                DISPLAY '** DPG54-CALENDAR-TYPE-INVALID'          25640001
118700                DISPLAY '** DPG51-CALENDAR-TYPE: '                25650001
118800                         DPG51-CALENDAR-TYPE                      25660001
118900             END-IF                                               25670001
119000             IF DPG54-DATE-INVALID                                25680001
119100                DISPLAY '** DPG54-DATE-INVALID'                   25690001
119200                DISPLAY '** DPG52-LK-DATE-INPUT: '                25700001
119300                         DPG52-LK-DATE-INPUT                      25710001
119400             END-IF                                               25720001
119500             IF DPG54-INCR-DECR-INVALID                           25730001
119600                DISPLAY '** DPG54-INCR-DECR-INVALID'              25740001
119700                DISPLAY '** DPG51-INCREMENT-DECREMENT-FLAG: '     25750001
119800                         DPG51-INCREMENT-DECREMENT-FLAG           25760001
119900             END-IF                                               25770001
120000             MOVE DPG54-ERROR-MESSAGE                             25780001
120100                                 TO PV-OPERATION-MSG-2            25790001
120200             SET ABEND-4019-DATE-ROUTINE-ERROR TO TRUE            25800001
120300             PERFORM 9800-ABEND                                   25810001
120400     END-EVALUATE.                                                25820001
120500                                                                  25830001
120600*9100-EXIT.                                                       25840001
120700 EJECT.                                                           25850001
120800                                                                  25860001
120900*----------------------------------------------------------       25870001
121000* 9800-ABEND.                                                     25880001
121100*     PERFORMS A NON-SQL-ABEND.                                   25890001
121200*----------------------------------------------------------       25900001
121300 9800-ABEND.                                                      25910001
121400                                                                  25920001
121500     DISPLAY '** ABEND           **'.                             25930001
121600     DISPLAY '** PROGRAM         ** = ' PC-CURRENT-PROGRAM-NAME.  25940001
121700     DISPLAY '** PARAGRAPH       ** = ' PV-PARAGRAPH-NAME.        25950001
121800     DISPLAY '** OPERATION       ** = ' PV-OPERATION-MSG-1.       25960001
121900     DISPLAY '**                 ** = ' PV-OPERATION-MSG-2.       25970001
122000                                                                  25980001
122100     CALL 'ILBOABN0' USING ABEND-CODE.                            25990001
