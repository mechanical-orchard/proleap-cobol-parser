000100*************************                                         00010001
000200 IDENTIFICATION DIVISION.                                         00020001
000300*************************                                         00030001
000400 PROGRAM-ID.      DPKUT003.                                       00040001
000500 AUTHOR.          MICHAEL N TYE, CAP GEMINI AMERICA.              00050001
000600 INSTALLATION.    KOHLS DEPARTMENT STORES.                        00060001
000700 DATE-WRITTEN.    AUGUST 12, 1988.                                00070001
000800 DATE-COMPILED.                                                   00080001
000900                                                                  00090001
001000              THIS PROGRAM USES THE OUTPUT FROM UTILITY IEBPTPCH, 00100001
001100              DDNAME SYSUT2, AS INPUT TO CREATE A TEMPORARY FILE  00110001
001200              CONTAINING PROGRAM NAME AND DESCRIPTION.            00120001
001300                                                                  00130001
001400 ENVIRONMENT DIVISION.                                            00140001
001500 CONFIGURATION SECTION.                                           00150001
001600 SOURCE-COMPUTER. IBM-3090.                                       00160001
001700 OBJECT-COMPUTER. IBM-3090.                                       00170001
001800                                                                  00180001
001900 INPUT-OUTPUT SECTION.                                            00190001
002000 FILE-CONTROL.                                                    00200001
002100     SELECT IEBPTPCH-SYSUT2-FILE       ASSIGN TO INP01.           00210001
002200     SELECT TEMP-PROGRAM-DESC-FILE     ASSIGN TO OUT01.           00220001
002300                                                                  00230001
002400***************                                                   00240001
002500 DATA DIVISION.                                                   00250001
002600***************                                                   00260001
002700 FILE SECTION.                                                    00270001
002800 FD  IEBPTPCH-SYSUT2-FILE                                         00280001
002900                             BLOCK CONTAINS 0 RECORDS             00290001
003000                             RECORD CONTAINS 100 CHARACTERS       00300001
003100                             LABEL RECORDS ARE STANDARD           00310001
003200                             RECORDING MODE F                     00320001
003300                             DATA RECORD IS IEBPTPCH-SYSUT2-REC.  00330001
003400 01  IEBPTPCH-SYSUT2-REC     PIC X(100).                          00340001
003500                                                                  00350001
003600 FD  TEMP-PROGRAM-DESC-FILE                                       00360001
003700                             BLOCK CONTAINS 0 RECORDS             00370001
003800                             RECORD CONTAINS 60 CHARACTERS        00380001
003900                             LABEL RECORDS ARE STANDARD           00390001
004000                             RECORDING MODE F                     00400001
004100                             DATA RECORD IS TEMP-PROGRAM-DESC-REC.00410001
004200 01  TEMP-PROGRAM-DESC-REC   PIC X(60).                           00420001
004300                                                                  00430001
004400     EJECT                                                        00440001
004500                                                                  00450001
004600 WORKING-STORAGE SECTION.                                         00460001
004700                                                                  00470001
004800**   IEBPTPCH-SYSUT2-FILE LAYOUT (INPUT)    **                    00480001
004900                                                                  00490001
005000 01  IEBPTPCI-RECORD.                                             00500001
005100     05  IEBPTPCI-PRINT-LINE     PIC X(100)     VALUE SPACES.     00510001
005200     05  IEBPTPCI-HDG-LINE  REDEFINES  IEBPTPCI-PRINT-LINE.       00520001
005300         10  FILLER              PIC X.                           00530001
005400         10  IEBPTPCI-HDG-2-12   PIC X(11).                       00540001
005500             88  IEBPTPCI-MEMBER-NAME           VALUE             00550001
005600                                                'MEMBER NAME'.    00560001
005700         10  FILLER              PIC X(02).                       00570001
005800         10  IEBPTPCI-HDG-MEMBER PIC X(08).                       00580001
005900         10  FILLER              PIC X(78).                       00590001
006000     05  IEBPTPCI-DESC-LINE  REDEFINES  IEBPTPCI-PRINT-LINE.      00600001
006100         10  FILLER              PIC X(21).                       00610001
006200         10  IEBPTPCI-PGM-DESC   PIC X(50).                       00620001
006300         10  IEBPTPCI-PGM-DESC-TBL  REDEFINES  IEBPTPCI-PGM-DESC. 00630001
006400             15  IEBPTPCI-PGM-DESC-CHAR  OCCURS 50 TIMES          00640001
006500                                         INDEXED BY IX-PDT  PIC X.00650001
006600         10  FILLER              PIC X(29).                       00660001
006700                                                                  00670001
006800**   TEMP-PROGRAM-DESC-FILE LAYOUT (OUTPUT)  **                   00680001
006900                                                                  00690001
007000 01  TEMPPGMO-RECORD.                                             00700001
007100     05  TEMPPGMO-PGM-NAME-PAN.                                   00710001
007200         10  TEMPPGMO-PGM-NAME   PIC X(08)      VALUE SPACES.     00720001
007300         10  FILLER              PIC X(02)      VALUE SPACES.     00730001
007400     05  TEMPPGMO-PGM-DESC       PIC X(50)      VALUE SPACES.     00740001
007500                                                                  00750001
007600                                                                  00760001
007700 01  PROGRAM-SWITCHES.                                            00770001
008000     05  PS-EOF-IEBPTPCI         PIC X          VALUE 'N'.        00800001
008100         88  EOF-IEBPTPCI                       VALUE 'Y'.        00810001
008200     05  PS-NAME-FOUND-SW        PIC  X(01)  VALUE 'N'.           00820001
008300         88  PS-NAME-FOUND                   VALUE 'P', 'C'.      00830001
008310         88  PS-PROGRAM-NAME-FOUND           VALUE 'P'.           00831001
008320         88  PS-COPYBOOK-NAME-FOUND          VALUE 'C'.           00832001
008400         88  PS-NAME-NOT-FOUND               VALUE 'N'.           00840001
008500                                                                  00850001
008600 01  PC-PROGRAM-CONSTANTS.                                        00860001
008700     05  PC-PGM-NAME-DEL         PIC  X(13)  VALUE                00870001
008800                                             'PROGRAM NAME:'.     00880001
008810     05  PC-COPYBOOK-NAME-DEL    PIC  X(14)  VALUE                00881001
008820                                             'COPYBOOK NAME:'.    00882001
008900 01  PV-PROGRAM-VARIABLES.                                        00890001
009000     05  PV-NAME-POINTER         PIC S9(04)  VALUE 1.             00900001
009100*                                            COMP SYNC.           00910001
009200     05  PV-TALLY                PIC S9(04)  VALUE 1.             00920001
009300*                                            COMP SYNC.           00930001
009400     05  PV-TEMP                 PIC  X(100) VALUE SPACE.         00940001
009500     05  PV-PGM-DESC             PIC  X(50)  VALUE SPACE.         00950001
009600     05  FILLER                  REDEFINES PV-PGM-DESC.           00960001
009700         10  PV-PGM-DESC-CHAR    OCCURS 50 TIMES                  00970001
009800                                 INDEXED BY PV-DESC-IDX           00980001
009900                                 PIC  X(01).                      00990001
010000                                                                  01000001
010100 01  WORK-AREA.                                                   01010001
010200     05  WS-ALPHABET-FIELDS.                                      01020001
010300****>> THE FOLLOWING "LOWER CASE" FIELDS HAVE HEXADECIMAL VALUES  01030001
010400****>> THAT ARE ONLY SEEN IN TSO.                                 01040001
010500         10  WS-LOWER-CASE-A     PIC X          VALUE 'a'.        01050001
010600         10  WS-UPPER-CASE-A     PIC X          VALUE 'A'.        01060001
010700         10  WS-LOWER-CASE-B     PIC X          VALUE 'b'.        01070001
010800         10  WS-UPPER-CASE-B     PIC X          VALUE 'B'.        01080001
010900         10  WS-LOWER-CASE-C     PIC X          VALUE 'c'.        01090001
011000         10  WS-UPPER-CASE-C     PIC X          VALUE 'C'.        01100001
011100         10  WS-LOWER-CASE-D     PIC X          VALUE 'd'.        01110001
011200         10  WS-UPPER-CASE-D     PIC X          VALUE 'D'.        01120001
011300         10  WS-LOWER-CASE-E     PIC X          VALUE 'e'.        01130001
011400         10  WS-UPPER-CASE-E     PIC X          VALUE 'E'.        01140001
011500         10  WS-LOWER-CASE-F     PIC X          VALUE 'f'.        01150001
011600         10  WS-UPPER-CASE-F     PIC X          VALUE 'F'.        01160001
011700         10  WS-LOWER-CASE-G     PIC X          VALUE 'g'.        01170001
011800         10  WS-UPPER-CASE-G     PIC X          VALUE 'G'.        01180001
011900         10  WS-LOWER-CASE-H     PIC X          VALUE 'h'.        01190001
012000         10  WS-UPPER-CASE-H     PIC X          VALUE 'H'.        01200001
012100         10  WS-LOWER-CASE-I     PIC X          VALUE 'i'.        01210001
012200         10  WS-UPPER-CASE-I     PIC X          VALUE 'I'.        01220001
012300         10  WS-LOWER-CASE-J     PIC X          VALUE 'j'.        01230001
012400         10  WS-UPPER-CASE-J     PIC X          VALUE 'J'.        01240001
012500         10  WS-LOWER-CASE-K     PIC X          VALUE 'k'.        01250001
012600         10  WS-UPPER-CASE-K     PIC X          VALUE 'K'.        01260001
012700         10  WS-LOWER-CASE-L     PIC X          VALUE 'l'.        01270001
012800         10  WS-UPPER-CASE-L     PIC X          VALUE 'L'.        01280001
012900         10  WS-LOWER-CASE-M     PIC X          VALUE 'm'.        01290001
013000         10  WS-UPPER-CASE-M     PIC X          VALUE 'M'.        01300001
013100         10  WS-LOWER-CASE-N     PIC X          VALUE 'n'.        01310001
013200         10  WS-UPPER-CASE-N     PIC X          VALUE 'N'.        01320001
013300         10  WS-LOWER-CASE-O     PIC X          VALUE 'o'.        01330001
013400         10  WS-UPPER-CASE-O     PIC X          VALUE 'O'.        01340001
013500         10  WS-LOWER-CASE-P     PIC X          VALUE 'p'.        01350001
013600         10  WS-UPPER-CASE-P     PIC X          VALUE 'P'.        01360001
013700         10  WS-LOWER-CASE-Q     PIC X          VALUE 'q'.        01370001
013800         10  WS-UPPER-CASE-Q     PIC X          VALUE 'Q'.        01380001
013900         10  WS-LOWER-CASE-R     PIC X          VALUE 'r'.        01390001
014000         10  WS-UPPER-CASE-R     PIC X          VALUE 'R'.        01400001
014100         10  WS-LOWER-CASE-S     PIC X          VALUE 's'.        01410001
014200         10  WS-UPPER-CASE-S     PIC X          VALUE 'S'.        01420001
014300         10  WS-LOWER-CASE-T     PIC X          VALUE 't'.        01430001
014400         10  WS-UPPER-CASE-T     PIC X          VALUE 'T'.        01440001
014500         10  WS-LOWER-CASE-U     PIC X          VALUE 'u'.        01450001
014600         10  WS-UPPER-CASE-U     PIC X          VALUE 'U'.        01460001
014700         10  WS-LOWER-CASE-V     PIC X          VALUE 'v'.        01470001
014800         10  WS-UPPER-CASE-V     PIC X          VALUE 'V'.        01480001
014900         10  WS-LOWER-CASE-W     PIC X          VALUE 'w'.        01490001
015000         10  WS-UPPER-CASE-W     PIC X          VALUE 'W'.        01500001
015100         10  WS-LOWER-CASE-X     PIC X          VALUE 'x'.        01510001
015200         10  WS-UPPER-CASE-X     PIC X          VALUE 'X'.        01520001
015300         10  WS-LOWER-CASE-Y     PIC X          VALUE 'y'.        01530001
015400         10  WS-UPPER-CASE-Y     PIC X          VALUE 'Y'.        01540001
015500         10  WS-LOWER-CASE-Z     PIC X          VALUE 'z'.        01550001
015600         10  WS-UPPER-CASE-Z     PIC X          VALUE 'Z'.        01560001
015700     05  WS-ALPHABET-TBL  REDEFINES  WS-ALPHABET-FIELDS.          01570001
015800         10  WS-ALPHA-TBL-CHARS  OCCURS  26  TIMES                01580001
015900                                 ASCENDING KEY WS-LOWER-CASE-CHAR 01590001
016000                                 INDEXED BY IX-ATC.               01600001
016100             15  WS-LOWER-CASE-CHAR                               01610001
016200                                 PIC X.                           01620001
016300             15  WS-UPPER-CASE-CHAR                               01630001
016400                                 PIC X.                           01640001
016500                                                                  01650001
016600     EJECT                                                        01660001
016700********************                                              01670001
016800 PROCEDURE DIVISION.                                              01680001
016900********************                                              01690001
017000                                                                  01700001
017100                                                                  01710001
017200     OPEN INPUT  IEBPTPCH-SYSUT2-FILE                             01720001
017300          OUTPUT TEMP-PROGRAM-DESC-FILE.                          01730001
017400                                                                  01740001
017500                                                                  01750001
017600     PERFORM X100-READ-IEBPTPCH-FILE                              01760001
017700         UNTIL IEBPTPCI-MEMBER-NAME                               01770001
017800         OR EOF-IEBPTPCI.                                         01780001
017900                                                                  01790001
018000                                                                  01800001
018100     IF IEBPTPCI-MEMBER-NAME                                      01810001
018200         PERFORM A100-PROCESS-IEBPTPCH-FILE                       01820001
018300             UNTIL EOF-IEBPTPCI                                   01830001
018400     END-IF.                                                      01840001
018500                                                                  01850001
018600                                                                  01860001
018700     CLOSE       IEBPTPCH-SYSUT2-FILE                             01870001
018800                 TEMP-PROGRAM-DESC-FILE.                          01880001
018900                                                                  01890001
019000                                                                  01900001
019100     STOP RUN.                                                    01910001
019200                                                                  01920001
019300     EJECT                                                        01930001
019400                                                                  01940001
019500******************************************************************01950001
019600*** A100 THIS PARAGRAPH PROCESSES THE INPUT FILE FROM "IEBPTPCH"  01960001
019700***      BY TAKING THE MEMBER NAME FROM THE DOCUMENTATION PDS AS  01970001
019800***      THE PROGRAM NAME, AND BY TAKING THE PROGRAM DESCRIPTION  01980001
019900***      AFTER HAVING CONVERTED ANY LOWER CASE LETTERS TO UPPER.  01990001
020000******************************************************************02000001
020100 A100-PROCESS-IEBPTPCH-FILE.                                      02010001
020200                                                                  02020001
020300                                                                  02030001
020400     MOVE IEBPTPCI-HDG-MEMBER     TO TEMPPGMO-PGM-NAME.           02040001
020500     MOVE SPACE                   TO IEBPTPCI-HDG-2-12.           02050001
020600                                                                  02060001
020610     SET PS-NAME-NOT-FOUND        TO TRUE.                        02061001
020620                                                                  02062001
020700     PERFORM A120-FIND-PROGRAM-NAME                               02070001
020800         UNTIL PS-NAME-FOUND                                      02080001
020900            OR IEBPTPCI-MEMBER-NAME                               02090001
021000            OR EOF-IEBPTPCI.                                      02100001
021100                                                                  02110001
021200                                                                  02120001
021300     IF PS-PROGRAM-NAME-FOUND                                     02130001
021400         PERFORM A110-CONVERT-LOWER-CASE                          02140001
021500             VARYING PV-DESC-IDX FROM 1 BY 1                      02150001
021600             UNTIL PV-DESC-IDX > 50                               02160001
021700*                                                                 02170001
021800         MOVE ZERO TO PV-TALLY                                    02180001
021900         INSPECT PV-PGM-DESC                                      02190001
022000             TALLYING PV-TALLY                                    02200001
022100             FOR LEADING SPACE                                    02210001
022200         ADD 1 TO PV-TALLY                                        02220001
022300*                                                                 02230001
022400         MOVE PV-PGM-DESC(PV-TALLY:)                              02240001
022500                                  TO TEMPPGMO-PGM-DESC            02250001
022600         WRITE TEMP-PROGRAM-DESC-REC                              02260001
022700                                FROM TEMPPGMO-RECORD              02270001
022900         PERFORM X100-READ-IEBPTPCH-FILE                          02290001
023000             UNTIL IEBPTPCI-MEMBER-NAME                           02300001
023100             OR EOF-IEBPTPCI                                      02310001
023200     ELSE                                                         02320001
023210         IF PS-NAME-NOT-FOUND                                     02321003
023300             MOVE '* PGM DESCRIPTION NOT FOUND *'                 02330001
023400                                  TO TEMPPGMO-PGM-DESC            02340001
023500             WRITE TEMP-PROGRAM-DESC-REC                          02350001
023600                                FROM TEMPPGMO-RECORD              02360001
023700         END-IF                                                   02370001
023710     END-IF.                                                      02371001
023800                                                                  02380001
023821     PERFORM X100-READ-IEBPTPCH-FILE                              02382104
023840         UNTIL IEBPTPCI-MEMBER-NAME                               02384004
023850            OR EOF-IEBPTPCI.                                      02385004
023900                                                                  02390001
024000*A100-END.                                                        02400004
024300                                                                  02430001
024400******************************************************************02440001
024500*** A110 THIS PARAGRAPH CONVERTS ANY LOWER CASE LETTERS IN THE    02450001
024600***      PROGRAM DESCRIPTION TO UPPER CASE LETTERS.               02460001
024700******************************************************************02470001
024800 A110-CONVERT-LOWER-CASE.                                         02480001
024900                                                                  02490001
025000                                                                  02500001
025100     IF ( PV-PGM-DESC-CHAR (PV-DESC-IDX)   IS NOT LESS THAN       02510001
025200                                           WS-LOWER-CASE-A )      02520001
025300        AND                                                       02530001
025400        ( PV-PGM-DESC-CHAR (PV-DESC-IDX)   IS NOT GREATER THAN    02540001
025500                                           WS-LOWER-CASE-Z )      02550001
025600        SEARCH ALL WS-ALPHA-TBL-CHARS                             02560001
025700            WHEN WS-LOWER-CASE-CHAR (IX-ATC)  =                   02570001
025800                                  PV-PGM-DESC-CHAR(PV-DESC-IDX)   02580001
025900                MOVE WS-UPPER-CASE-CHAR (IX-ATC)                  02590001
026000                                  TO                              02600001
026100                                  PV-PGM-DESC-CHAR(PV-DESC-IDX)   02610001
026200     END-IF.                                                      02620001
026300                                                                  02630001
026500*A110-END.                                                        02650004
026600                                                                  02660004
026700***************************************************************   02670001
026800** BECAUSE THE PROGRAM NAME MIGHT NOT ALWAYS BE IN THE SAME  **   02680001
026900** CHARACTER POSITIONS, UNSTRING TO FIND IT.                 **   02690001
027000***************************************************************   02700001
027100 A120-FIND-PROGRAM-NAME.                                          02710001
027200     MOVE 1     TO PV-NAME-POINTER.                               02720002
027300     MOVE SPACE TO PV-TEMP.                                       02730001
027400*                                                                 02740001
027500     UNSTRING IEBPTPCI-RECORD                                     02750001
027600         DELIMITED BY PC-COPYBOOK-NAME-DEL                        02760001
027700         INTO         PV-TEMP                                     02770001
027800         WITH POINTER PV-NAME-POINTER                             02780001
027900     END-UNSTRING.                                                02790001
028000*                                                                 02800001
028100     IF  PV-NAME-POINTER < LENGTH OF IEBPTPCI-RECORD              02810001
028400         SET PS-COPYBOOK-NAME-FOUND TO TRUE                       02840001
028500     END-IF.                                                      02850001
028510*                                                                 02851001
028511     IF PS-NAME-NOT-FOUND                                         02851101
028512         MOVE 1     TO PV-NAME-POINTER                            02851202
028513         MOVE SPACE TO PV-TEMP                                    02851302
028520         UNSTRING IEBPTPCI-RECORD                                 02852001
028530             DELIMITED BY PC-PGM-NAME-DEL                         02853001
028540             INTO         PV-TEMP                                 02854001
028550             WITH POINTER PV-NAME-POINTER                         02855001
028560         END-UNSTRING                                             02856001
028570*                                                                 02857001
028580         IF  PV-NAME-POINTER < LENGTH OF IEBPTPCI-RECORD          02858001
028590             MOVE IEBPTPCI-RECORD (PV-NAME-POINTER:)              02859001
028591                                 TO PV-PGM-DESC                   02859101
028592             SET PS-PROGRAM-NAME-FOUND TO TRUE                    02859201
028593         END-IF                                                   02859301
028594     END-IF.                                                      02859401
028600*                                                                 02860001
028700     PERFORM X100-READ-IEBPTPCH-FILE.                             02870001
028800                                                                  02880001
028900******************************************************************02890001
029000*** X100 THIS PARAGRAPH READS THE INPUT FILE FROM "IEBPTPCH".     02900001
029100******************************************************************02910001
029200 X100-READ-IEBPTPCH-FILE.                                         02920001
029300                                                                  02930001
029400                                                                  02940001
029500     READ IEBPTPCH-SYSUT2-FILE  INTO IEBPTPCI-RECORD              02950001
029600         AT END                                                   02960001
029700             SET EOF-IEBPTPCI TO TRUE.                            02970001
029800                                                                  02980001
