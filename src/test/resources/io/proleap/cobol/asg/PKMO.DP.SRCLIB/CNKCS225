000100*-----------------------*                                         00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300*-----------------------*                                         00030000
000400 PROGRAM-ID.    CNKCS225.                                         00040000
000500 AUTHOR.        DEANNA BRANTNER                                   00050000
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060000
000700 DATE-WRITTEN.  JANUARY, 2001                                     00070000
000800 DATE-COMPILED.                                                   00080000
000910*---------------------------------------------------------------* 00091000
001000*    Y225 - DC-DOOR DEFINITION - ADD, UPDATE, OR LIST             00100000
001100*    THIS PROGRAM WILL PROCESS THE DOOR ID ADD, UPDATE, OR LIST   00110000
001200*    WHEN THE ASSOCIATE SELECTS F13-ADD, OR F15-UPDATE, FROM      00120000
001300*    THE CRIT SPEC SCREEN (CNKCS224). OR THEY CAN GO TO F17-LIST  00130000
001400*    F17 - DOOR TYPE LIST - CNLDRTYPE - CNKCS226.                 00140000
001500*---------------------------------------------------------------* 00150000
263455* CHANGED 11/02/2021    BY JIM HUNTER      WR: CHG0263455         00151001
263455* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00152001
263455* MAKING THE CALL DYNAMIC VS STATIC.                              00153001
263455*----------------------------------------------------------------*00154001
CICS  * CHANGED 10/25/2022    BY JIM HUNTER      WR: CHG0276961         00155002
CICS  * ADD COPYBOOK DPWS930 AND MAKE THE CICS ARCHITECTURE CALL        00156002
CICS  * DYNAMIC INSTEAD OF STATIC BY CALLING DP930-CICS-ARCH-API.       00157002
CICS  *-----------------------------------------------------------------00158002
001600 ENVIRONMENT DIVISION.                                            00160000
001700 DATA DIVISION.                                                   00170000
001800                                                                  00180000
001900 WORKING-STORAGE SECTION.                                         00190000
002000                                                                  00200000
002100 01  DK-DB2-KEYS.                                                 00210000
002200     05  DK-DOOR-ID               PIC   X(4)        VALUE SPACES. 00220000
002300     05  DK-DOOR-TYPE-CDE         PIC   X(2)        VALUE SPACES. 00230000
002400     05  DK-OPER-UNT-ID           PIC  S9(4) COMP   VALUE ZEROES. 00240000
002500     05  DK-STR-NBR               PIC  S9(4) COMP   VALUE ZEROES. 00250000
002600     05  DK-DIVERT-NBR            PIC  S9(4) COMP   VALUE ZEROES. 00260000
002700     05  DK-DIVERT-LOC            PIC   X(4)        VALUE SPACES. 00270000
002800                                                                  00280000
002900 01  PC-PROGRAM-CONSTANTS.                                        00290000
003000     05  PC-CURRENT-PROGRAM-NAME  PIC  X(08)  VALUE  'CNKCS225'.  00300000
003100     05  PC-CURRENT-MAP-NAME      PIC  X(08)  VALUE  'CNK225  '.  00310000
003200     05  PC-CURRENT-MAPSET-NAME   PIC  X(08)  VALUE  'CNKM225 '.  00320000
003300     05  PC-APPL-MAP              PIC S9(04)  VALUE  +1           00330000
003400                                              COMP.               00340000
003500     05  PC-MAX-RETRIES           PIC S9(04)  VALUE  +3           00350000
003600                                              COMP.               00360000
003700     05  PC-INTER-APPL-CODES.                                     00370000
003800         10  PC-INTER-APPL-CRIT-SPEC-UPD  PIC  X(01)  VALUE '1'.  00380000
003900         10  PC-INTER-APPL-CRIT-SPEC-ADD  PIC  X(01)  VALUE '1'.  00390000
004000         10  PC-INTER-APPL-LIST-ADD       PIC  X(01)  VALUE '1'.  00400000
004100         10  PC-INTER-APPL-LIST-UPDATE    PIC  X(01)  VALUE '2'.  00410000
004200     05  PC-D                     PIC  X(01)  VALUE  'D'.         00420000
004300     05  PC-I                     PIC  X(01)  VALUE  'I'.         00430000
004400     05  PC-L                     PIC  X(01)  VALUE  'L'.         00440000
004500     05  PC-N                     PIC  X(01)  VALUE  'N'.         00450000
004600     05  PC-U                     PIC  X(01)  VALUE  'U'.         00460000
004700     05  PC-SPACE                 PIC  X(03)  VALUE  '   '.       00470000
004800     05  PC-01                    PIC  X(02)  VALUE  '01'.        00480000
004900     05  PC-DC                    PIC  X(02)  VALUE  'DC'.        00490000
005000     05  PC-DS                    PIC  X(02)  VALUE  'DS'.        00500000
005100     05  PC-SH                    PIC  X(02)  VALUE  'SH'.        00510000
005200     05  PC-DEFAULT-TIMESTAMP     PIC  X(26)                      00520000
005300                          VALUE  '9999-09-09-09.09.09.999999'.    00530000
005400                                                                  00540000
005500*----------------------------------------------------------------*00550000
005600*  SYSTEM MESSAGES                                                00560000
005700*----------------------------------------------------------------*00570000
005800*   00005 - INVALID VALUE                                         00580000
005900*   00007 - REQUIRED ENTRY                                        00590000
006000*   00008 - MUST BE NUMERIC                                       00600000
006100*   00034 - ADD SUCCESSFUL                                        00610000
006200*   00045 - INVALID FUNCTION                                      00620000
006300*   00059 - UPDATE(S) SUCCESSFUL                                  00630000
006400*   00069 - TOP OF LIST                                           00640000
006500*   00070 - BOTTOM OF LIST                                        00650000
006600*   00115 - DELETE SUCCESSFUL                                     00660000
006700*   00354 - DELETE PENDING - PRESS PF2 TO CONFIRM                 00670000
006800*   00527 - TYPE CODE DOES NOT EXIST                              00680000
006900*   02571 - UNABLE TO UPD - CURRENT OPER UNT AND OPER UNIT ID ENTE00690000
007000*   02574 - UPDATE FUNCTION INVALID - DOOR IS CURRENTLY NOT DEFINE00700000
007100*   02575 - STORE ASSIGNMNT FUNCTION ONLY VALID FOR DOOR TYPES SHI00710000
007200*   02576 - UPDATING DOOR DEFINITION - PRESS F2 TO CONFIRM        00720000
007300*   02577 - CANNOT CHANGE DOOR TYPE - DOOR ASSIGNED TO A NON-STORE00730000
007400*   02578 - CANNOT CHANGE DOOR TYPE - DOOR ASSIGNED TO A NON-DC LO00740000
007500*   02579 - CANNOT CHANGE DOOR TYPE-DOOR CURRENTLY ASSIGNED TO A D00750000
007600*   02620 - DOORS SHARING SAME CONVEYOR DIVERT CANNOT HAVE SAME ST00760000
007700*   02643 - DOOR ALREADY EXISTS                                   00770000
007800*   02936 - SHARED DIVERT & LANE ASSIGNMENT ONLY VALID FOR SHIPPIN00780000
007801*   03264 - LABEL SEQUENCE MUST BE UNIQUE - DOOR &VAR IS THIS SEQU00780100
007802*   03266 - DOOR LABEL SEQUENCE IS ONLY VALID FOR SHIPPING DOORS  00780200
007803*   03267 - SHIPPING DOOR LABEL SEQUENCE MUST BE GREATER THAN 0   00780300
007810*   05046 - LAND ASSGNMT AND DIVERT LOCATION ID REQUIRED FOR SH   00781000
007900*   99901 - INVALID COMMAND WAS ENTERED                           00790000
008000*----------------------------------------------------------------*00800000
008100     05  PC-TSYMSG-NUMBERS.                                       00810000
008200         10  PC-TSYMSG-00005      PIC  9(05)  VALUE  00005.       00820000
008300         10  PC-TSYMSG-00007      PIC  9(05)  VALUE  00007.       00830000
008400         10  PC-TSYMSG-00008      PIC  9(05)  VALUE  00008.       00840000
008500         10  PC-TSYMSG-00034      PIC  9(05)  VALUE  00034.       00850000
008600         10  PC-TSYMSG-00045      PIC  9(05)  VALUE  00045.       00860000
008700         10  PC-TSYMSG-00059      PIC  9(05)  VALUE  00059.       00870000
008800         10  PC-TSYMSG-00069      PIC  9(05)  VALUE  00069.       00880000
008900         10  PC-TSYMSG-00070      PIC  9(05)  VALUE  00070.       00890000
009000         10  PC-TSYMSG-00115      PIC  9(05)  VALUE  00115.       00900000
009100         10  PC-TSYMSG-00354      PIC  9(05)  VALUE  00354.       00910000
009200         10  PC-TSYMSG-00527      PIC  9(05)  VALUE  00527.       00920000
009300         10  PC-TSYMSG-02571      PIC  9(05)  VALUE  02571.       00930000
009400         10  PC-TSYMSG-02574      PIC  9(05)  VALUE  02574.       00940000
009500         10  PC-TSYMSG-02575      PIC  9(05)  VALUE  02575.       00950000
009600         10  PC-TSYMSG-02576      PIC  9(05)  VALUE  02576.       00960000
009700         10  PC-TSYMSG-02577      PIC  9(05)  VALUE  02577.       00970000
009800         10  PC-TSYMSG-02578      PIC  9(05)  VALUE  02578.       00980000
009900         10  PC-TSYMSG-02579      PIC  9(05)  VALUE  02579.       00990000
010000         10  PC-TSYMSG-02620      PIC  9(05)  VALUE  02620.       01000000
010100         10  PC-TSYMSG-02643      PIC  9(05)  VALUE  02643.       01010000
010200         10  PC-TSYMSG-02936      PIC  9(05)  VALUE  02936.       01020000
010300         10  PC-TSYMSG-02937      PIC  9(05)  VALUE  02937.       01030000
010310         10  PC-TSYMSG-03046      PIC  9(05)  VALUE  03046.       01031000
010311         10  PC-TSYMSG-03264      PIC  9(05)  VALUE  03264.       01031100
010320         10  PC-TSYMSG-03266      PIC  9(05)  VALUE  03266.       01032000
010330         10  PC-TSYMSG-03267      PIC  9(05)  VALUE  03267.       01033000
010400         10  PC-TSYMSG-99901      PIC  9(05)  VALUE  99901.       01040000
010500*                                                                 01050000
010600 01  PS-PROGRAM-SWITCHES.                                         01060000
010700     05  PS-ERROR-SW              PIC  X(01)  VALUE  'N'.         01070000
010800         88  PS-ERROR                         VALUE  'Y'.         01080000
010900         88  PS-NO-ERROR                      VALUE  'N'.         01090000
011000     05  PS-COMMAREA-SW           PIC  X(01)  VALUE  'N'.         01100000
011100         88  PS-COMMAREA-VALID                VALUE  'Y'.         01110000
011200         88  PS-COMMAREA-NOT-VALID            VALUE  'N'.         01120000
011300     05  PS-LIST-END-SW           PIC  X(01)  VALUE  'N'.         01130000
011400         88  PS-LIST-END                      VALUE  'Y'.         01140000
011500         88  PS-NO-LIST-END                   VALUE  'N'.         01150000
011600     05  PS-STORE-SW              PIC  X(01)  VALUE  'N'.         01160000
011700         88  PS-STORES-EXIST                  VALUE  'Y'.         01170000
011800         88  PS-NO-STORES-EXIST               VALUE  'N'.         01180000
011900     05  PS-DIVERT-SW             PIC  X(01)  VALUE  'N'.         01190000
012000         88  PS-DUP-DIVERT-EXIST              VALUE  'Y'.         01200000
012100         88  PS-NO-DUP-DIVERT-EXIST           VALUE  'N'.         01210000
012200     05  PS-DUPLICATE-STORE-SW    PIC  X(01)  VALUE  'N'.         01220000
012300         88  PS-DUP-STORE-ASGNMT              VALUE  'Y'.         01230000
012400         88  PS-NO-DUP-STORE-ASGNMT           VALUE  'N'.         01240000
012410     05  PS-LBL-SEQ-OPER-EXISTS-SW PIC X(01)  VALUE  'N'.         01241000
012420         88  PS-LBL-SEQ-OPER-EXISTS-YES       VALUE  'Y'.         01242000
012430         88  PS-LBL-SEQ-OPER-EXISTS-NO        VALUE  'N'.         01243000
012440     05  PS-TYPE-CHANGED-SW        PIC X(01)  VALUE  'N'.         01244000
012450         88  PS-TYPE-CHANGED-YES              VALUE  'Y'.         01245000
012460         88  PS-TYPE-CHANGED-NO               VALUE  'N'.         01246000
012500                                                                  01250000
012600 01  PV-PROGRAM-VARIABLES.                                        01260000
012700     05  PV-CICS-RESPONSE         PIC S9(04)  VALUE +0            01270000
012800                                              COMP SYNC.          01280000
012900     05  PV-RETRY-COUNTER         PIC S9(04)  VALUE +0            01290000
013000                                              COMP SYNC.          01300000
013100     05  PV-INPUT-SPACE-CNT       PIC S9(04)  VALUE +0            01310000
013200                                              COMP SYNC.          01320000
013300     05  PV-READ-COUNT            PIC S9(09)  VALUE +0            01330000
013400                                              COMP-3.             01340000
013500     05  PV-READ-STORES-COUNT     PIC S9(09)  VALUE +0            01350000
013600                                              COMP-3.             01360000
013700     05  PC-MAX-ITEMS             PIC S9(09)  VALUE +3            01370000
013800                                              COMP-3.             01380000
013900     05  PV-LANE-ASSGN-NUM        PIC  9(09)  VALUE ZEROES.       01390000
013901     05  PV-LABEL-SEQ             PIC S9(04) COMP.                01390100
013902     05  PV-LABEL-SEQ-COUNT       PIC S9(09)  VALUE +0            01390200
013903                                              COMP-3.             01390300
013910     05  PV-DOOR-ID.                                              01391000
014000         10  PV-DOOR-ID1          PIC X(1)  VALUE SPACES.         01400000
014100         10  PV-DOOR-ID2          PIC X(1)  VALUE SPACES.         01410000
014200         10  PV-DOOR-ID3          PIC X(1)  VALUE SPACES.         01420000
014300         10  PV-DOOR-ID4          PIC X(1)  VALUE SPACES.         01430000
014400******************************************************************01440000
014500*PV-INP VARIABLES HOLD COMMAREA VALUES                            01450000
014600*       ONLY PV-INP VARIABLES READ FROM AND WRITE TO ASC-'S       01460000
014700******************************************************************01470000
014800     05  PV-INP-FUNCTION              PIC  X(01).                 01480000
014900     05  PV-INP-CURR-OPER-UNT-ID      PIC S9(04) COMP.            01490000
015000     05  PV-INP-CURR-FCLTY-ID         PIC S9(04) COMP.            01500000
015100     05  PV-INP-CURR-FCLTY-NME        PIC X(25).                  01510000
015200     05  PV-INP-OPER-UNT-ID           PIC S9(04) COMP.            01520000
015300     05  PV-INP-FCLTY-ID              PIC S9(04) COMP.            01530000
015400     05  PV-INP-FCLTY-NME             PIC X(25).                  01540000
015500     05  PV-INP-DOOR-ID               PIC X(04).                  01550000
015600     05  PV-INP-DOOR-TYPE-CDE         PIC X(02).                  01560000
015700     05  PV-INP-DOOR-TYPE-DESC        PIC  X(30).                 01570000
015800     05  PV-INP-LOC-DESC              PIC  X(30).                 01580000
015900     05  PV-INP-LABEL-SEQ             PIC S9(04) COMP.            01590000
016000     05  PV-INP-LANE-ASGNMT           PIC S9(09) COMP.            01600000
016100     05  PV-INP-DIVERT-LOC            PIC  X(04).                 01610000
016200     05  PV-INP-STORE-ASGNMT          PIC  X(05).                 01620000
016300                                                                  01630000
016400*---------------------------------------------------------------* 01640000
016500* SELECTON QUEUE LAYOUT                                         * 01650000
016600*---------------------------------------------------------------* 01660000
016700     COPY CNWS013.                                                01670000
016800                                                                  01680000
016900*----------------------------------------------------------------*01690000
017000*    MAP LAYOUT                                                  *01700000
017100*----------------------------------------------------------------*01710000
017200     COPY CNKM225.                                                01720000
017300                                                                  01730000
017400*----------------------------------------------------------------*01740000
017500*    ATTRIBUTE SETTINGS COPYBOOK.                                *01750000
017600*----------------------------------------------------------------*01760000
017700     COPY DPWS015.                                                01770000
017800                                                                  01780000
017900*----------------------------------------------------------------*01790000
018000*    FUNCTION KEYS COPYBOOK                                      *01800000
018100*----------------------------------------------------------------*01810000
018200     COPY DPWS016.                                                01820000
018300                                                                  01830000
018400**--------------------------------------------------------------**01840000
018500** THE CVLLING PARAMETER LIST (DPWS010) FOR THE NUMERIC EDIT    **01850000
018600** SUB-ROUTINE (DPKUT100).                                      **01860000
018700**--------------------------------------------------------------**01870000
018800     COPY DPWS010I.                                               01880000
018900                                                                  01890000
019000**--------------------------------------------------------------**01900000
019100** THE CALLING PARAMETER LIST (DPWS030) FOR THE CICS ARCHITECTURE*01910000
019200** APPLICATION PROGRAMMING INTERFACE MODULE.                    **01920002
019300**--------------------------------------------------------------**01930000
019400     COPY DPWS030.                                                01940000
CICS       COPY DPWS930.                                                01941002
019500                                                                  01950000
019600**--------------------------------------------------------------**01960000
019700*    STANDARD COMMAREA.                                           01970000
019800**--------------------------------------------------------------**01980000
019900     COPY DPWS020.                                                01990000
020000     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                02000000
020100                                                                  02010000
020200*---------------------------------------------------------------* 02020000
020300* INTER-APPLICATION COMMAREA.                                     02030000
020400*   CNWS011 - IS THE INPUT LAYOUT WHEN COMING FROM THE CRIT.    * 02040000
020500*             SPEC SCREEN.                                        02050000
020600*   CNWS012 - IS THE INPUT LAYOUT THAT WILL BE PASSED FROM        02060000
020700*             THE LIST SCREEN                                     02070000
020800*---------------------------------------------------------------* 02080000
020900                                                                  02090000
021000         10  INTER-APPL-COMM-AREA PIC X(200).                     02100000
021100     COPY CNWS011.                                                02110000
021200     COPY CNWS012.                                                02120000
021300***************************************************************** 02130000
021400*    SPECIFIC COMMMAREA FOR CNKCS225.                             02140000
021500***************************************************************** 02150000
021600         10  ASC-SPECIFIC-COMMAREA.                               02160000
021700             15  ASC-FUNCTION              PIC  X(01).            02170000
021800             15  ASC-CURR-OPER-UNT-ID      PIC S9(04)  COMP.      02180000
021900             15  ASC-CURR-FCLTY-ID         PIC S9(04)  COMP.      02190000
022000             15  ASC-CURR-FCLTY-NME        PIC X(25).             02200000
022100             15  ASC-OPER-UNT-ID           PIC S9(04)  COMP.      02210000
022200             15  ASC-FCLTY-ID              PIC S9(04)  COMP.      02220000
022300             15  ASC-FCLTY-NME             PIC X(25).             02230000
022400             15  ASC-DOOR-ID               PIC X(04).             02240000
022500             15  ASC-DOOR-ID-X REDEFINES ASC-DOOR-ID.             02250000
022600                 20  ASC-DOOR-ID-N         PIC 9(04).             02260000
022700             15  ASC-DOOR-TYPE-CODE        PIC X(02).             02270000
022800             15  ASC-LABEL-SEQ             PIC  X(04).            02280000
022900             15  ASC-LABEL-SEQ-X REDEFINES ASC-LABEL-SEQ.         02290000
023000                 20  ASC-LABEL-SEQ-N       PIC  Z(04).            02300000
023100             15  ASC-DOOR-TYPE-DESC        PIC  X(30).            02310000
023200             15  ASC-LOC-DESC              PIC  X(30).            02320000
023300             15  ASC-LANE-ASGNMT           PIC  X(09).            02330000
023400             15  ASC-LANE-ASGNMT-X REDEFINES ASC-LANE-ASGNMT.     02340000
023500                 20  ASC-LANE-ASGNMT-N     PIC  Z(09).            02350000
023600             15  ASC-DIVERT-LOC            PIC  X(04).            02360000
023700             15  ASC-STORE-ASGNMT          PIC  X(05).            02370000
023800             15  ASC-COUNT                 PIC S9(09) COMP.       02380000
023900                                                                  02390000
024000             15  ASC-INT-APPL-FORMAT-IND   PIC X(01).             02400000
024100*SWITCHES                                                         02410000
024200             15  ASC-ACTION-SW          PIC X(03).                02420000
024300                 88  ASC-ADD            VALUE 'ADD'.              02430000
024400                 88  ASC-DELETE         VALUE 'DEL'.              02440000
024500                 88  ASC-UPDATE         VALUE 'UPD'.              02450000
024600             15  ASC-MSG-NUMBER.                                  02460000
024700                 20  ASC-MSG-NUMBER-N      PIC  9(05).            02470000
024800             15  ASC-INT-APPL-FORMAT-SAVE  PIC  X(01).            02480000
024900             15  ASC-DOOR-TERM-ID          PIC  X(04).            02490000
025000             15  ASC-SYSTEM-ID             PIC  X(02).            02500000
025100             15  ASC-MSG-TEXT              PIC  X(70).            02510000
025200             15  ASC-USE-SELECTION-QUEUE-IND                      02520000
025300                                           PIC  X(01).            02530000
025400                 88  ASC-USE-SELECTION-QUEUE           VALUE 'Y'. 02540000
025500             15  ASC-SEL-QUEUE-NAME        PIC  X(08).            02550000
025600             15  ASC-NUMBER-OF-TS-ITEMS    PIC S9(05)  COMP-3.    02560000
025700             15  ASC-NUMBER-OF-SELECTED-ITEMS                     02570000
025800                                           PIC S9(09)  COMP-3.    02580000
025900             15  ASC-ITEM-SUB                 PIC S9(04)  COMP    02590000
026000                                                          SYNC.   02600000
026100             15  ASC-SEL-SUB               PIC S9(04)  COMP.      02610000
026200             15  ASC-SEL-ITEM              PIC S9(04)  COMP.      02620000
026300             15  ASC-TEMP-QUEUE-UPDATE-SW  PIC  X(01).            02630000
026400                 88  ASC-UPDATE-TSQ                   VALUE 'Y'.  02640000
026500                 88  ASC-NO-TSQ-UPDATE                VALUE ' '.  02650000
026600                                                                  02660000
026700             15  ASC-TCNDCDR-INSERTED-SW  PIC  X(01).             02670000
026800                 88  ASC-TCNDCDR-INSERTED             VALUE  'Y'. 02680000
026900                 88  ASC-TCNDCDR-NOT-INSERTED         VALUE  'N'. 02690000
027000             15  ASC-TCNDCDR-UPDATED-SW   PIC  X(01).             02700000
027100                 88  ASC-TCNDCDR-UPDATED              VALUE  'Y'. 02710000
027200                 88  ASC-TCNDCDR-NOT-UPDATED          VALUE  'N'. 02720000
027300             15  ASC-ITEMS-LEFT-INDICATOR     PIC  X(01).         02730000
027400                 88  ASC-ITEMS-LEFT-ON-DB             VALUE 'Y'.  02740000
027500                 88  ASC-NO-ITEMS-LEFT-ON-DB          VALUE 'N'.  02750000
027600             15  ASC-STORES-LEFT-INDICATOR    PIC  X(01).         02760000
027700                 88  ASC-STORES-LEFT-ON-DB            VALUE 'Y'.  02770000
027800                 88  ASC-NO-STORES-LEFT-ON-DB          VALUE 'N'. 02780000
027900             15  ASC-DVRT-LANE-REQ-SW         PIC  X(01).         02790000
028000                 88  ASC-DVRT-LANE-REQ-YES            VALUE 'Y'.  02800000
028100                 88  ASC-DVRT-LANE-REQ-NO             VALUE 'N'.  02810000
028110             15  ASC-F2-CONFIRM-SW            PIC  X(01).         02811000
028120                 88  ASC-F2-CONFIRM-YES               VALUE 'Y'.  02812000
028130                 88  ASC-F2-CONFIRM-NO                VALUE 'N'.  02813000
028200                                                                  02820000
028300*----------------------------------------------------------------*02830000
028400*    ABEND PROCESSING COPYBOOK.                                  *02840000
028500*----------------------------------------------------------------*02850000
028600     COPY DPWS013.                                                02860000
028700                                                                  02870000
028800*----------------------------------------------------------------*02880000
028900*    DB2 TABLE FOR CONTROL DOOR TYPE                              02890000
029000*----------------------------------------------------------------*02900000
029100     EXEC SQL                                                     02910000
029200          INCLUDE TCNDRTY                                         02920000
029300     END-EXEC.                                                    02930000
029400                                                                  02940000
029500*----------------------------------------------------------------*02950000
029600*    DB2 TABLE FOR CONTROL DISTRIBUTION CENTER DOORS              02960000
029700*----------------------------------------------------------------*02970000
029800     EXEC SQL                                                     02980000
029900          INCLUDE TCNDCDR                                         02990000
030000     END-EXEC.                                                    03000000
030100                                                                  03010000
030200*----------------------------------------------------------------*03020000
030300*    DB2 TABLE FOR CONTROL DOOR TO STORE TABLE                    03030000
030400*----------------------------------------------------------------*03040000
030500     EXEC SQL                                                     03050000
030600          INCLUDE TCNDRST                                         03060000
030700     END-EXEC.                                                    03070000
030714                                                                  03071400
030720*----------------------------------------------------------------*03072000
030730*    DB2 TABLE FOR LOCATION                                       03073000
030740*----------------------------------------------------------------*03074000
030750     EXEC SQL                                                     03075000
030760          INCLUDE XLT00010                                        03076000
030770     END-EXEC.                                                    03077000
030800                                                                  03080000
030900*----------------------------------------------------------------*03090000
031000*    COMMAREA USED TO CALL XLKUT071                               03100000
031100*----------------------------------------------------------------*03110000
031200     COPY XLWS071.                                                03120000
031500                                                                  03150000
031600*----------------------------------------------------------------*03160000
031700*    CURSOR USED TO CHECK FOR MATCHING DIVERT/LANE ASSIGNMENTS    03170000
031800*----------------------------------------------------------------*03180000
031900     EXEC SQL                                                     03190000
032000        DECLARE SAME-DIVERT-CSR CURSOR FOR                        03200000
032100           SELECT A.OPER_UNT_ID                                   03210000
032200                 ,A.DOOR_ID                                       03220000
032300                 ,A.DIVERT_NBR                                    03230000
032400           FROM  TCNDCDR A                                        03240000
032500              ,  TCNDRTY B                                        03250000
032600          WHERE  A.OPER_UNT_ID    = :DK-OPER-UNT-ID               03260000
032700            AND  A.DOOR_ID       <> :DK-DOOR-ID                   03270000
032800            AND  A.DIVERT_NBR     = :DK-DIVERT-NBR                03280000
032900            AND  A.DIVERT_LOC_ID  = :DK-DIVERT-LOC                03290000
033000            AND  A.DOOR_TYP_CDE   = B.DOOR_TYP_CDE                03300000
033100            AND  B.DIVERT_TYP_CDE = :PC-D                         03310000
033200                                                                  03320000
033300        ORDER BY DOOR_ID                                          03330000
033400     END-EXEC.                                                    03340000
033500                                                                  03350000
033600*----------------------------------------------------------------*03360000
033700*    CURSOR USED TO CHECK FOR MATCHING STORE ASSIGNMENTS          03370000
033800*----------------------------------------------------------------*03380000
033900     EXEC SQL                                                     03390000
034000        DECLARE SAME-STORE-CSR CURSOR FOR                         03400000
034100           SELECT OPER_UNT_ID                                     03410000
034200                 ,DOOR_ID                                         03420000
034300                 ,STR_NBR                                         03430000
034400           FROM  TCNDRST                                          03440000
034500          WHERE  OPER_UNT_ID  =  :DK-OPER-UNT-ID                  03450000
034600            AND  DOOR_ID      =  :DK-DOOR-ID                      03460000
034700            AND  END_TMST     =  :PC-DEFAULT-TIMESTAMP            03470000
034800        ORDER BY DOOR_ID                                          03480000
034900     END-EXEC.                                                    03490000
035000                                                                  03500000
035100*----------------------------------------------------------------*03510000
035200*    DB2 AREA FOR COMMUNICATIONS                                  03520000
035300*----------------------------------------------------------------*03530000
035400     EXEC SQL                                                     03540000
035500          INCLUDE SQLCA                                           03550000
035600     END-EXEC.                                                    03560000
035700                                                                  03570000
035800*----------------------------------------------------------------*03580000
035900 LINKAGE SECTION.                                                 03590000
036000                                                                  03600000
036100 01  DFHCOMMAREA.                                                 03610000
036200     05  FILLER                         OCCURS  1 TO 4072 TIMES   03620000
036300                                        DEPENDING ON EIBCALEN.    03630000
036400         10  FILLER                     PIC X.                    03640000
036500                                                                  03650000
036600 PROCEDURE DIVISION.                                              03660000
036700***************************************************************** 03670000
036800** THIS MODULE CONTROLS THE OVERALL PROCESSING IN THE PROGRAM. ** 03680000
036900** THE SETUP AND PERFORM OF PARAGRAPH 0001-CALL-CICS-ARCH-API  ** 03690000
037000** MUST BE THE FIRST CODE EXECUTED IN THIS PROGRAM.            ** 03700000
037100**                                                             ** 03710000
037200** THE SECOND OR 'EXIT' PERFORM OF THIS PARAGRAPH MUST BE THE  ** 03720000
037300** LAST CODE EXECUTED ON EACH ITERATION OF THIS PROGRAM.       ** 03730000
037400***************************************************************** 03740000
037500 0000-MAIN-MODULE.                                                03750000
037600     INITIALIZE DP030-CICS-API-FIELDS.                            03760000
037700     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       03770000
037800     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          03780000
037900     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         03790000
038000     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       03800000
038100     MOVE LENGTH OF CNK225I        TO DP030-MAP-LENGTH (1).       03810000
038200     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     03820000
038300     PERFORM 0001-CALL-CICS-ARCH-API.                             03830000
038400                                                                  03840000
038500     PERFORM 1000-CONTROL-PROCESSING                              03850000
038600                                                                  03860000
038700     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     03870000
038800     PERFORM 0001-CALL-CICS-ARCH-API.                             03880000
038900                                                                  03890000
039000 0001-CALL-CICS-ARCH-API.                                         03900000
CICS       CALL DP930-CICS-ARCH-API USING DFHEIBLK                      03910002
039200                                    DFHCOMMAREA                   03920002
039300                                    DP030-CICS-API-FIELDS         03930002
039400                                    DP020-STANDARD-COMMAREA       03940002
039500                                    CNK225I.                      03950002
039600                                                                  03960000
039700     IF  DP030-RC-CALL-SUCCESSFUL                                 03970000
039800         CONTINUE                                                 03980000
039900     ELSE                                                         03990000
040000         SET DP013-NO-ROLLBACK                                    04000000
040100             DP013-XCTL-DISPLAY-RESTART                           04010000
040200             DP013-CICS-ABEND      TO TRUE                        04020000
040300         MOVE 'BEFORE 0000-MAIN-MODULE'                           04030000
040400                                   TO DP013-PARAGRAPH             04040000
CICS           MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O04041002
CICS  -             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      04042002
040700         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      04070000
040800         PERFORM DP013-0000-PROCESS-ABEND                         04080000
040900     END-IF.                                                      04090000
041000*                                                                 04100000
041100*----------------------------------------------------------------*04110000
041200*    PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT   *04120000
041300*    COURSE OF ACTION IS FOR THIS TRANSACTION.                   *04130000
041400*----------------------------------------------------------------*04140000
041500 1000-CONTROL-PROCESSING.                                         04150000
041600                                                                  04160000
041700     EVALUATE TRUE                                                04170000
041800         WHEN DP020-NEXT-ACT-INITIAL                              04180000
041900              INITIALIZE ASC-SPECIFIC-COMMAREA                    04190000
042000              MOVE EIBTRMID TO ASC-DOOR-TERM-ID                   04200000
042100              PERFORM 1100-PROCESS-INTER-APPL-COMM                04210000
042200                                                                  04220000
042300              IF  PS-COMMAREA-NOT-VALID                           04230000
042400                  SET DP020-NEXT-ACT-APPL-ERROR TO TRUE           04240000
042500              ELSE                                                04250000
042600                  PERFORM 4000-BUILD-INITIAL-PANEL                04260000
042700                  PERFORM 4400-MOVE-COMMAREA-TO-SCREEN            04270000
042800                  IF  ASC-DOOR-TYPE-CODE  =  'SH'    AND          04280000
042900                      (ASC-DIVERT-LOC     =  SPACES  OR           04290000
043000                       ASC-LANE-ASGNMT    =  SPACES)              04300000
043100                       SET  ASC-DVRT-LANE-REQ-YES  TO  TRUE       04310000
043200                  END-IF                                          04320000
043300                  PERFORM 3200-RESET-ATTRIBUTES                   04330000
043400              END-IF                                              04340000
043500                                                                  04350000
043600         WHEN DP020-NEXT-ACT-READ-MAP                             04360000
043700             PERFORM 2000-PROCESS-PANEL                           04370000
043800*F3-END                                                           04380000
043900         WHEN DP020-NEXT-ACT-RETURN                               04390000
044000             PERFORM 4000-BUILD-INITIAL-PANEL                     04400000
044100             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   04410000
044200             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 04420000
044300             MOVE -1                   TO ADOORIDL                04430000
044400                                                                  04440000
044500         WHEN OTHER                                               04450000
044600             SET DP013-LOGIC-ABEND TO TRUE                        04460000
044700             SET DP013-NO-ROLLBACK TO TRUE                        04470000
044800             MOVE '1000-CONTROL-PROCESSING'                       04480000
044900                                   TO DP013-PARAGRAPH             04490000
045000             MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'    04500000
045100                                   TO DP013-MESSAGE-TEXT(1)       04510000
045200             MOVE DP020-NEXT-APPL-ACTIVITY                        04520000
045300                                   TO DP013-MESSAGE-TEXT(2)       04530000
045400             PERFORM DP013-0000-PROCESS-ABEND                     04540000
045500     END-EVALUATE.                                                04550000
045600*                                                                 04560000
045700******************************************************************04570000
045800** DETERMINE THE KEY OF THE OBJECT TO BE UPDATED BASED ON THE   **04580000
045900** INTER-APPLICATION FORMAT CODE.                               **04590000
046000******************************************************************04600000
046100 1100-PROCESS-INTER-APPL-COMM.                                    04610000
046200     INITIALIZE ASC-SPECIFIC-COMMAREA.                            04620000
046300     MOVE DP020-INT-APPL-FORMAT-IND                               04630000
046400                                   TO ASC-INT-APPL-FORMAT-IND.    04640000
046500                                                                  04650000
046600     SET PS-COMMAREA-VALID                                        04660000
046700         ASC-F2-CONFIRM-NO         TO TRUE.                       04670000
046800*WHEN COMING FROM CRIT SPEC (CNKCS224- F13=ADDDOOR)               04680000
046900*WHEN COMING FROM CRIT SPEC (CNKCS224- F15=UPDDOOR)               04690000
047000*WHEN COMING FROM DOOR TYPE LIST SCREEN (CNKCS226)                04700000
047100     EVALUATE ASC-INT-APPL-FORMAT-IND                             04710000
047200         WHEN PC-INTER-APPL-CRIT-SPEC-ADD                         04720000
047300         WHEN PC-INTER-APPL-CRIT-SPEC-UPD                         04730000
047400         WHEN PC-INTER-APPL-LIST-ADD                              04740000
047500             MOVE CN011-FUNCTION          TO ASC-FUNCTION         04750000
047600             MOVE CN011-CURR-OPER-UNT-ID  TO ASC-CURR-OPER-UNT-ID 04760000
047700             MOVE CN011-CURR-FCLTY-ID     TO ASC-CURR-FCLTY-ID    04770000
047800             MOVE CN011-CURR-FCLTY-NME    TO ASC-CURR-FCLTY-NME   04780000
047900             MOVE CN011-OPER-UNT-ID       TO ASC-OPER-UNT-ID      04790000
048000             MOVE CN011-FCLTY-ID          TO ASC-FCLTY-ID         04800000
048100             MOVE CN011-FCLTY-NME         TO ASC-FCLTY-NME        04810000
048200             MOVE CN011-DOOR-ID           TO ASC-DOOR-ID          04820000
048300             MOVE CN011-DOOR-TYPE-CDE     TO ASC-DOOR-TYPE-CODE   04830000
048400             MOVE CN011-DOOR-TYPE-DESC    TO ASC-DOOR-TYPE-DESC   04840000
048500             MOVE CN011-LOC-DESC          TO ASC-LOC-DESC         04850000
048600             MOVE CN011-DIVERT-CODE       TO ASC-LANE-ASGNMT-N    04860000
048700             MOVE CN011-DIVERT-LOC-ID     TO ASC-DIVERT-LOC       04870000
048800             MOVE CN011-LABEL-SEQ         TO ASC-LABEL-SEQ-N      04880000
048900             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   04890000
049000             PERFORM 4500-MOVE-COMMAREA-TO-TEMP                   04900000
049100                                                                  04910000
049200*WHEN COMING FROM DOOR LIST SCREEN (CNKCS227)                     04920000
049300         WHEN PC-INTER-APPL-LIST-UPDATE                           04930000
049400           IF CN012-NUMBER-OF-SELECTED-ITEMS > 0                  04940000
049500             SET ASC-USE-SELECTION-QUEUE TO TRUE                  04950000
049600             MOVE CN012-NUMBER-OF-SELECTED-ITEMS                  04960000
049700                                   TO ASC-NUMBER-OF-SELECTED-ITEMS04970000
049800             MOVE CN012-NUMBER-OF-TS-ITEMS                        04980000
049900                                   TO ASC-NUMBER-OF-TS-ITEMS      04990000
050000             MOVE CN012-SEL-QUEUE-NAME                            05000000
050100                                   TO ASC-SEL-QUEUE-NAME          05010000
050200             MOVE CN012-CURR-OPER-UNT-ID TO ASC-CURR-OPER-UNT-ID  05020000
050300             MOVE CN012-CURR-FCLTY-ID    TO ASC-CURR-FCLTY-ID     05030000
050400             MOVE CN012-OPER-UNT-ID      TO ASC-OPER-UNT-ID       05040000
050500             MOVE CN012-FCLTY-ID         TO ASC-FCLTY-ID          05050000
050600             MOVE CN012-FUNCTION         TO ASC-FUNCTION          05060000
050700             MOVE 'UPD' TO  ASC-ACTION-SW                         05070000
050800             PERFORM 1120-PREPARE-LIST-ENTRY                      05080000
050900             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   05090000
051000             PERFORM 4500-MOVE-COMMAREA-TO-TEMP                   05100000
051100         END-IF                                                   05110000
051200     END-EVALUATE.                                                05120000
051300                                                                  05130000
051400*----------------------------------------------------------------*05140000
051500* ENTRY IS FROM A LIST.  GET THE MESSAGE NUMBER FROM THE TEMP    *05150000
051600* STORAGE QUEUE PASSED FROM THE LIST.                            *05160000
051700*----------------------------------------------------------------*05170000
051800 1120-PREPARE-LIST-ENTRY.                                         05180000
051900     MOVE CN013-MAX-ITEMS          TO ASC-SEL-SUB.                05190000
052000     MOVE ZERO                     TO ASC-SEL-ITEM.               05200000
052100     PERFORM 1130-GET-NEXT-RECORD.                                05210000
052200                                                                  05220000
052300*---------------------------------------------------------------- 05230000
052400*    GET THE NEXT RECORD IF A LIST OF RECORDS ARE BEING PROCESSED*05240000
052500*---------------------------------------------------------------- 05250000
052600 1130-GET-NEXT-RECORD.                                            05260000
052700     ADD +1                        TO ASC-SEL-SUB.                05270000
052800                                                                  05280000
052900     SET ASC-UPDATE-TSQ TO TRUE.                                  05290000
053000                                                                  05300000
053100     IF  ASC-SEL-SUB > CN013-MAX-ITEMS                            05310000
053200         ADD +1                    TO ASC-SEL-ITEM                05320000
053300         MOVE +1                   TO ASC-SEL-SUB                 05330000
053400     END-IF.                                                      05340000
053500                                                                  05350000
053600     IF  ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                05360000
053700         PERFORM 9100-READ-SEL-QUEUE                              05370000
053800         IF  CN013-ITEM (ASC-SEL-SUB) > ZERO                      05380000
053900             MOVE CN013-DOOR-ID  (ASC-SEL-SUB)  TO ASC-DOOR-ID    05390000
054000             MOVE CN013-TYPE-CODE (ASC-SEL-SUB)                   05400000
054100                                             TO ASC-DOOR-TYPE-CODE05410000
054200             MOVE CN013-LOC-DESC (ASC-SEL-SUB)                    05420000
054300                                             TO ASC-LOC-DESC      05430000
054400             MOVE CN013-LANE-ASGNMT (ASC-SEL-SUB)                 05440000
054500                                              TO ASC-LANE-ASGNMT-N05450000
054600             MOVE CN013-DIVERT-LOC-ID (ASC-SEL-SUB)               05460000
054700                                              TO ASC-DIVERT-LOC   05470000
054800             MOVE CN013-LBL-SEQ-NBR (ASC-SEL-SUB)                 05480000
054900                                              TO ASC-LABEL-SEQ-N  05490000
055000             MOVE CN013-STORE-ASGNMT (ASC-SEL-SUB)                05500000
055100                                               TO ASC-STORE-ASGNMT05510000
055200             SET CN013-INQ (ASC-SEL-SUB) TO TRUE                  05520000
055300             PERFORM 9200-REWRITE-SEL-QUEUE                       05530000
055400         ELSE                                                     05540000
055500             SUBTRACT +1 FROM ASC-SEL-SUB                         05550000
055600             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            05560000
055700             SET DP020-MSG-INFORMATIONAL                          05570000
055800                 PS-LIST-END       TO TRUE                        05580000
055900         END-IF                                                   05590000
056000     ELSE                                                         05600000
056100         SUBTRACT +1 FROM ASC-SEL-ITEM                            05610000
056200         MOVE CN013-MAX-ITEMS      TO ASC-SEL-SUB                 05620000
056300         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            05630000
056400         SET DP020-MSG-INFORMATIONAL                              05640000
056500                 PS-LIST-END       TO TRUE                        05650000
056600     END-IF.                                                      05660000
056700                                                                  05670000
056800******************************************************************05680000
056900*  GET THE PREVIOUS RECORD IF A LIST OF RECORDS ARE BEING         05690000
057000*  PROCESSED.                                                     05700000
057100******************************************************************05710000
057200 1140-GET-PREV-RECORD.                                            05720000
057300     SUBTRACT +1 FROM ASC-SEL-SUB.                                05730000
057400                                                                  05740000
057500     IF  ASC-SEL-SUB < +1                                         05750000
057600         SUBTRACT +1 FROM ASC-SEL-ITEM                            05760000
057700         MOVE CN013-MAX-ITEMS      TO ASC-SEL-SUB                 05770000
057800     END-IF.                                                      05780000
057900                                                                  05790000
058000     IF  ASC-SEL-ITEM > ZERO                                      05800000
058100         PERFORM 9100-READ-SEL-QUEUE                              05810000
058200         IF  CN013-ITEM (ASC-SEL-SUB) > ZERO                      05820000
058300             MOVE CN013-DOOR-ID  (ASC-SEL-SUB)  TO ASC-DOOR-ID    05830000
058400             MOVE CN013-TYPE-CODE (ASC-SEL-SUB)                   05840000
058500                                            TO ASC-DOOR-TYPE-CODE 05850000
058600             MOVE CN013-LOC-DESC (ASC-SEL-SUB)                    05860000
058700                                            TO ASC-LOC-DESC       05870000
058800             MOVE CN013-LANE-ASGNMT (ASC-SEL-SUB)                 05880000
058900                                              TO ASC-LANE-ASGNMT-N05890000
059000             MOVE CN013-DIVERT-LOC-ID (ASC-SEL-SUB)               05900000
059100                                              TO ASC-DIVERT-LOC   05910000
059200             MOVE CN013-LBL-SEQ-NBR (ASC-SEL-SUB)                 05920000
059300                                              TO ASC-LABEL-SEQ-N  05930000
059400             MOVE CN013-STORE-ASGNMT (ASC-SEL-SUB)                05940000
059500                                               TO ASC-STORE-ASGNMT05950000
059600         END-IF                                                   05960000
059700                                                                  05970000
059800         SET CN013-INQ (ASC-SEL-SUB) TO TRUE                      05980000
059900         PERFORM 9200-REWRITE-SEL-QUEUE                           05990000
060000     ELSE                                                         06000000
060100         MOVE +1                   TO ASC-SEL-ITEM                06010000
060200                                      ASC-SEL-SUB                 06020000
060300         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            06030000
060400         SET DP020-MSG-INFORMATIONAL                              06040000
060500             PS-LIST-END             TO TRUE                      06050000
060600     END-IF.                                                      06060000
060700                                                                  06070000
060800*----------------------------------------------------------------*06080000
060900* DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA   *06090000
061000* ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *06100000
061100* USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *06110000
061200* OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *06120000
061300* FUNCTION KEYS CAN GET THIS FAR.                                *06130000
061400*----------------------------------------------------------------*06140000
061500 2000-PROCESS-PANEL.                                              06150000
061600                                                                  06160000
061700     EVALUATE TRUE                                                06170000
061800                                                                  06180000
061900         WHEN DP020-SRC-AID = DP016-CLEAR                         06190000
062000             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   06200000
062100             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 06210000
062200                                                                  06220000
062300*F5 REFRESH -                                                     06230000
062400         WHEN DP020-FK-REFRESH(DP020-SRC-AID)                     06240000
062500              SET  ASC-DVRT-LANE-REQ-NO                           06250000
062510                   ASC-F2-CONFIRM-NO     TO  TRUE                 06251000
062600              PERFORM 4000-BUILD-INITIAL-PANEL                    06260000
062700              PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                06270000
062800              PERFORM 3200-RESET-ATTRIBUTES                       06280000
062900              PERFORM 4100-CHECK-4-STORE-ASGNMT                   06290000
063000              IF PS-STORES-EXIST                                  06300000
063100                  SET PS-ERROR                                    06310000
063200                      DP020-MSG-FATAL       TO TRUE               06320000
063300                  MOVE PC-TSYMSG-02579        TO DP020-MSG-NUMBER 06330000
063400                  MOVE DP015-PRO-NOR-OFF      TO ADRTYPCA         06340000
063500                  MOVE DP015-RED              TO ADRTYPCC         06350000
063600                  MOVE DP015-REVERSE          TO ADRTYPCH         06360000
063700                  MOVE -1                     TO ADRTYPCL         06370000
063800                  SET DP030-SET-CURSOR-APPL-1 TO TRUE             06380000
063900              END-IF                                              06390000
064000                                                                  06400000
064100*F20-NEXT SEL                                                     06410000
064200         WHEN DP020-FK-NEXT-SELECTION (DP020-SRC-AID)             06420000
064300             MOVE DP020-INT-APPL-FORMAT-IND                       06430000
064400                                      TO ASC-INT-APPL-FORMAT-IND  06440000
064500             IF ASC-INT-APPL-FORMAT-IND = '2'                     06450000
064600               IF  ASC-USE-SELECTION-QUEUE                        06460000
064700                   PERFORM 1130-GET-NEXT-RECORD                   06470000
064800                   PERFORM 3000-EDIT-DATA-IN-COMMAREA             06480000
064900                   IF PS-LIST-END                                 06490000
065000                       PERFORM 4400-MOVE-COMMAREA-TO-SCREEN       06500000
065100                       SET PS-NO-LIST-END TO TRUE                 06510000
065200                   ELSE                                           06520000
065300                       PERFORM 4000-BUILD-INITIAL-PANEL           06530000
065400                       PERFORM 4400-MOVE-COMMAREA-TO-SCREEN       06540000
065500                       PERFORM 3200-RESET-ATTRIBUTES              06550000
065600                   END-IF                                         06560000
065700               ELSE                                               06570000
065800*                --- BOTTOM OF LIST ---                           06580000
065900                   MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER       06590000
066000                   SET DP020-MSG-INFORMATIONAL TO TRUE            06600000
066100               END-IF                                             06610000
066200           ELSE                                                   06620000
066300               MOVE PC-TSYMSG-00045 TO DP020-MSG-NUMBER           06630000
066400               SET DP020-MSG-FATAL TO TRUE                        06640000
066500           END-IF                                                 06650000
066600                                                                  06660000
066700*F19-PREV SEL                                                     06670000
066800         WHEN DP020-FK-PREV-SELECTION (DP020-SRC-AID)             06680000
066900             MOVE DP020-INT-APPL-FORMAT-IND                       06690000
067000                                      TO ASC-INT-APPL-FORMAT-IND  06700000
067100             IF ASC-INT-APPL-FORMAT-IND = '2'                     06710000
067200                IF  ASC-USE-SELECTION-QUEUE                       06720000
067300                   PERFORM 1140-GET-PREV-RECORD                   06730000
067400                   PERFORM 3000-EDIT-DATA-IN-COMMAREA             06740000
067500                   IF PS-LIST-END                                 06750000
067600                       PERFORM 4400-MOVE-COMMAREA-TO-SCREEN       06760000
067700                       SET PS-NO-LIST-END TO TRUE                 06770000
067800                   ELSE                                           06780000
067900                       PERFORM 4000-BUILD-INITIAL-PANEL           06790000
068000                       PERFORM 4400-MOVE-COMMAREA-TO-SCREEN       06800000
068100                       PERFORM 3200-RESET-ATTRIBUTES              06810000
068200                   END-IF                                         06820000
068300               ELSE                                               06830000
068400                   MOVE PC-TSYMSG-00069 TO DP020-MSG-NUMBER       06840000
068500                   SET DP020-MSG-INFORMATIONAL TO TRUE            06850000
068600               END-IF                                             06860000
068700           ELSE                                                   06870000
068800               MOVE PC-TSYMSG-00045 TO DP020-MSG-NUMBER           06880000
068900               SET DP020-MSG-FATAL TO TRUE                        06890000
069000           END-IF                                                 06900000
069100                                                                  06910000
069200         WHEN OTHER                                               06920000
069300             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 06930000
069400             PERFORM 3200-RESET-ATTRIBUTES                        06940000
069500             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   06950000
069600             IF PS-NO-ERROR                                       06960000
069700                 PERFORM 4500-MOVE-COMMAREA-TO-TEMP               06970000
069800                 PERFORM 2100-CHECK-FUNCTION-KEY                  06980000
069900                 IF PS-NO-ERROR                                   06990000
070000                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         07000000
070100                     SET DP030-CONTINUE-GO TO TRUE                07010000
070200                 ELSE                                             07020000
070300                     SET DP030-OVERRIDE-GO TO TRUE                07030000
070400                 END-IF                                           07040000
070500             ELSE                                                 07050000
070600                 SET DP030-OVERRIDE-GO TO TRUE                    07060000
070700             END-IF                                               07070000
070800     END-EVALUATE.                                                07080000
070900                                                                  07090000
071000*----------------------------------------------------------------*07100000
071100* ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED       *07110000
071200* FIRST.  NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED   *07120000
071300* FROM THE CICS ARCHITECTURE API.                                *07130000
071400*----------------------------------------------------------------*07140000
071500 2100-CHECK-FUNCTION-KEY.                                         07150000
071600     EVALUATE TRUE                                                07160000
071700         WHEN DP020-SRC-AID = DP016-ENTER                         07170000
071800             IF SQLCODE = +0                                      07180000
071900                 IF  ASC-DOOR-TYPE-CODE  =  'SH'    AND           07190000
072000                     (ASC-DIVERT-LOC     =  SPACES  OR            07200000
072100                      ASC-LANE-ASGNMT    =  SPACES)               07210000
072200                     MOVE DP015-PRO-NOR-OFF      TO ADOORIDA      07220000
072300                     MOVE DP015-BLUE             TO ADOORIDC      07230000
072400                     MOVE DP015-HL-OFF           TO ADOORIDH      07240000
072500                     MOVE DP015-UNP-ALP-BRT-OFF  TO ALANEASGA     07250000
072600                                                    ADIVLOCA      07260000
072700                     MOVE DP015-GREEN            TO ALANEASGC     07270000
072800                                                    ADIVLOCC      07280000
072900                     MOVE DP015-UNDERLINE        TO ALANEASGH     07290000
073000                                                    ADIVLOCH      07300000
073100                 ELSE                                             07310000
073200                     MOVE DP015-PRO-NOR-OFF  TO ADOORIDA          07320000
073300                                                ALANEASGA         07330000
073400                                                ADIVLOCA          07340000
073500                     MOVE DP015-BLUE         TO ADOORIDC          07350000
073600                                                ALANEASGC         07360000
073700                                                ADIVLOCC          07370000
073800                     MOVE DP015-HL-OFF       TO ADOORIDH          07380000
073900                                                ALANEASGH         07390000
074000                                                ADIVLOCH          07400000
074100                 END-IF                                           07410000
074200             ELSE                                                 07420000
074300                SET PS-NO-ERROR       TO TRUE                     07430000
074400                MOVE SPACES           TO DP020-MSG-SEVERITY-IND   07440000
074500                MOVE ZEROES           TO DP020-MSG-NUMBER         07450000
074600                MOVE DP015-PRO-NOR-OFF      TO AOPRUNTA           07460000
074700                MOVE DP015-BLUE             TO AOPRUNTC           07470000
074800                MOVE DP015-HL-OFF           TO AOPRUNTH           07480000
074900                MOVE +1                     TO AOPRUNTL           07490000
075000                MOVE DP015-UNP-ALP-NOR-OFF  TO ADOORIDA           07500000
075100                MOVE DP015-GREEN            TO ADOORIDC           07510000
075200                MOVE DP015-UNDERLINE        TO ADOORIDH           07520000
075300                MOVE -1                     TO ADOORIDL           07530000
075400                SET DP030-SET-CURSOR-APPL-1 TO TRUE               07540000
075500                MOVE PV-INP-LOC-DESC        TO ASC-LOC-DESC       07550000
075600             END-IF                                               07560000
075700             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 07570000
075800                                                                  07580000
075900*-F02 = CONFIRM UPDATE                                            07590000
076000         WHEN DP020-FK-CONFIRM  (DP020-SRC-AID)                   07600000
076100              AND ASC-F2-CONFIRM-YES                              07610000
076200             IF ASC-ACTION-SW = 'UPD'                             07620000
076300                 PERFORM 9100-READ-SEL-QUEUE                      07630000
076400                 SET CN013-UPD (ASC-SEL-SUB) TO TRUE              07640000
076500                 MOVE ASC-DOOR-ID  TO CN013-DOOR-ID (ASC-SEL-SUB) 07650000
076600                 MOVE ASC-DOOR-TYPE-CODE                          07660000
076700                                  TO CN013-TYPE-CODE (ASC-SEL-SUB)07670000
076800                 MOVE ASC-LOC-DESC TO CN013-LOC-DESC (ASC-SEL-SUB)07680000
076900                 MOVE ASC-LANE-ASGNMT-N                           07690000
077000                                TO CN013-LANE-ASGNMT (ASC-SEL-SUB)07700000
077100                 MOVE ASC-DIVERT-LOC                              07710000
077200                             TO CN013-DIVERT-LOC-ID (ASC-SEL-SUB) 07720000
077300                 MOVE ASC-LABEL-SEQ-N                             07730000
077400                               TO CN013-LBL-SEQ-NBR (ASC-SEL-SUB) 07740000
077500                 MOVE ASC-STORE-ASGNMT                            07750000
077600                              TO CN013-STORE-ASGNMT (ASC-SEL-SUB) 07760000
077700                 PERFORM 9200-REWRITE-SEL-QUEUE                   07770000
077800             END-IF                                               07780000
077900                                                                  07790000
078000           IF  ASC-DOOR-ID  = SPACES                              07800000
078100                 SET PS-ERROR                                     07810000
078200                     DP020-MSG-FATAL         TO TRUE              07820000
078300                 MOVE PC-TSYMSG-00007        TO DP020-MSG-NUMBER  07830000
078400                 MOVE DP015-UNP-ALP-BRT-OFF  TO ADOORIDA          07840000
078500                 MOVE DP015-RED              TO ADOORIDC          07850000
078600                 MOVE DP015-REVERSE          TO ADOORIDH          07860000
078700                 MOVE -1                     TO ADOORIDL          07870000
078800                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              07880000
078900           END-IF                                                 07890000
079000           IF  ASC-DOOR-TYPE-CODE = SPACES                        07900000
079100                 SET PS-ERROR                                     07910000
079200                     DP020-MSG-FATAL         TO TRUE              07920000
079300                 MOVE PC-TSYMSG-00007        TO DP020-MSG-NUMBER  07930000
079400                 MOVE DP015-UNP-ALP-BRT-OFF  TO ADRTYPCA          07940000
079500                 MOVE DP015-RED              TO ADRTYPCC          07950000
079600                 MOVE DP015-REVERSE          TO ADRTYPCH          07960000
079700                 MOVE -1                     TO ADRTYPCL          07970000
079800                 MOVE +1                     TO ADOORIDL          07980000
079900                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              07990000
080000           END-IF                                                 08000000
080100           IF  ASC-LOC-DESC  = SPACES                             08010000
080200                 SET PS-ERROR                                     08020000
080300                     DP020-MSG-FATAL         TO TRUE              08030000
080400                 MOVE PC-TSYMSG-00007        TO DP020-MSG-NUMBER  08040000
080500                 MOVE DP015-UNP-ALP-BRT-OFF  TO ALOCDSCA          08050000
080600                 MOVE DP015-RED              TO ALOCDSCC          08060000
080700                 MOVE DP015-REVERSE          TO ALOCDSCH          08070000
080800                 MOVE -1                     TO ALOCDSCL          08080000
080900                 MOVE +1                     TO ADOORIDL          08090000
081000                 MOVE +1                     TO ADRTYPCL          08100000
081100                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              08110000
081200           END-IF                                                 08120000
081300           IF (ASC-DOOR-ID = 'YARD' AND                           08130000
081400              ASC-DOOR-TYPE-CODE NOT =  'YD')                     08140000
081500                 SET PS-ERROR                                     08150000
081600                     DP020-MSG-FATAL         TO TRUE              08160000
081700                 MOVE PC-TSYMSG-00005        TO DP020-MSG-NUMBER  08170000
081800                 MOVE DP015-UNP-ALP-BRT-OFF  TO ADRTYPCA          08180000
081900                 MOVE DP015-RED              TO ADRTYPCC          08190000
082000                 MOVE DP015-REVERSE          TO ADRTYPCH          08200000
082100                 MOVE -1                     TO ADRTYPCL          08210000
082200                 MOVE +1                     TO ADOORIDL          08220000
082300                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              08230000
082400           END-IF                                                 08240000
082500           IF (ASC-DOOR-ID NOT = 'YARD' AND                       08250000
082600              ASC-DOOR-TYPE-CODE =  'YD')                         08260000
082700                 SET PS-ERROR                                     08270000
082800                     DP020-MSG-FATAL         TO TRUE              08280000
082900                 MOVE PC-TSYMSG-00005        TO DP020-MSG-NUMBER  08290000
083000                 MOVE DP015-UNP-ALP-BRT-OFF  TO ADOORIDA          08300000
083100                 MOVE DP015-RED              TO ADOORIDC          08310000
083200                 MOVE DP015-REVERSE          TO ADOORIDH          08320000
083300                 MOVE -1                     TO ADOORIDL          08330000
083400                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              08340000
083500           END-IF                                                 08350000
083600           IF (ASC-DOOR-TYPE-CODE = 'SH' OR 'DS') AND             08360000
083700              (ASC-LANE-ASGNMT > SPACE)                           08370000
083800                   PERFORM 4100-CHECK-4-STORE-ASGNMT              08380000
083900                   IF PS-STORES-EXIST                             08390000
084000                       PERFORM 4200-CHECK-4-DUP-DIVERT            08400000
084100                   END-IF                                         08410000
084200           END-IF                                                 08420000
084300           IF PS-NO-ERROR                                         08430000
084400               PERFORM 5100-PROCESS-UPDATE                        08440000
084500               SET  ASC-DVRT-LANE-REQ-NO  TO  TRUE                08450000
084600               IF PS-NO-ERROR                                     08460000
084700                   PERFORM 2110-PREPARE-INTER-APPL-COMM           08470000
084800               END-IF                                             08480000
084900           END-IF                                                 08490000
085000                                                                  08500000
085100*-F13 = ADD DOOR ID                                               08510000
085200         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              08520000
085300           IF  ASC-DOOR-ID  = SPACES                              08530000
085400                 SET PS-ERROR                                     08540000
085500                     DP020-MSG-FATAL         TO TRUE              08550000
085600                 MOVE PC-TSYMSG-00007        TO DP020-MSG-NUMBER  08560000
085700                 MOVE DP015-UNP-ALP-BRT-OFF  TO ADOORIDA          08570000
085800                 MOVE DP015-RED              TO ADOORIDC          08580000
085900                 MOVE DP015-REVERSE          TO ADOORIDH          08590000
086000                 MOVE -1                     TO ADOORIDL          08600000
086100                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              08610000
086200           END-IF                                                 08620000
086300           IF  ASC-DOOR-TYPE-CODE = SPACES                        08630000
086400                 SET PS-ERROR                                     08640000
086500                     DP020-MSG-FATAL         TO TRUE              08650000
086600                 MOVE PC-TSYMSG-00007        TO DP020-MSG-NUMBER  08660000
086700                 MOVE DP015-UNP-ALP-BRT-OFF  TO ADRTYPCA          08670000
086800                 MOVE DP015-RED              TO ADRTYPCC          08680000
086900                 MOVE DP015-REVERSE          TO ADRTYPCH          08690000
087000                 MOVE -1                     TO ADRTYPCL          08700000
087100                 MOVE +1                     TO ADOORIDL          08710000
087200                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              08720000
087300           END-IF                                                 08730000
087400           IF  ASC-LOC-DESC  = SPACES                             08740000
087500                 SET PS-ERROR                                     08750000
087600                     DP020-MSG-FATAL         TO TRUE              08760000
087700                 MOVE PC-TSYMSG-00007        TO DP020-MSG-NUMBER  08770000
087800                 MOVE DP015-UNP-ALP-BRT-OFF  TO ALOCDSCA          08780000
087900                 MOVE DP015-RED              TO ALOCDSCC          08790000
088000                 MOVE DP015-REVERSE          TO ALOCDSCH          08800000
088100                 MOVE -1                     TO ALOCDSCL          08810000
088200                 MOVE +1                     TO ADOORIDL          08820000
088300                 MOVE +1                     TO ADRTYPCL          08830000
088400                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              08840000
088500           END-IF                                                 08850000
088600           IF ASC-LANE-ASGNMT > SPACE AND ASC-DIVERT-LOC = SPACES 08860000
088700                 SET PS-ERROR                                     08870000
088800                     DP020-MSG-FATAL         TO TRUE              08880000
088900                 MOVE PC-TSYMSG-00007        TO DP020-MSG-NUMBER  08890000
089000                 MOVE DP015-UNP-ALP-BRT-OFF  TO ADIVLOCA          08900000
089100                 MOVE DP015-RED              TO ADIVLOCC          08910000
089200                 MOVE DP015-REVERSE          TO ADIVLOCH          08920000
089300                 MOVE -1                     TO ADIVLOCL          08930000
089400                 MOVE +1                     TO ADOORIDL          08940000
089500                 MOVE +1                     TO ADRTYPCL          08950000
089600                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              08960000
089700           END-IF                                                 08970000
089800           IF ASC-LANE-ASGNMT = SPACE AND ASC-DIVERT-LOC > SPACES 08980000
089900                 SET PS-ERROR                                     08990000
090000                     DP020-MSG-FATAL         TO TRUE              09000000
090100                 MOVE PC-TSYMSG-00007        TO DP020-MSG-NUMBER  09010000
090200                 MOVE DP015-UNP-ALP-BRT-OFF  TO ALANEASGA         09020000
090300                 MOVE DP015-RED              TO ALANEASGC         09030000
090400                 MOVE DP015-REVERSE          TO ALANEASGH         09040000
090500                 MOVE -1                     TO ALANEASGL         09050000
090600                 MOVE +1                     TO ADOORIDL          09060000
090700                 MOVE +1                     TO ADRTYPCL          09070000
090800                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              09080000
090900           END-IF                                                 09090000
091000* DMH - BEGIN                                                     09100000
091100           IF ASC-DOOR-TYPE-CODE =  'SH'  AND                     09110000
091200              (ASC-LANE-ASGNMT = SPACE  OR                        09120000
091300               ASC-LANE-ASGNMT = LOW-VALUES)                      09130000
091400                 SET PS-ERROR                                     09140000
091500                     DP020-MSG-FATAL                              09150000
091600                     ASC-DVRT-LANE-REQ-YES   TO TRUE              09160000
091700                 MOVE PC-TSYMSG-00007        TO DP020-MSG-NUMBER  09170000
091800                 MOVE DP015-UNP-ALP-BRT-OFF  TO ALANEASGA         09180000
091900                 MOVE DP015-RED              TO ALANEASGC         09190000
092000                 MOVE DP015-REVERSE          TO ALANEASGH         09200000
092100                 MOVE -1                     TO ALANEASGL         09210000
092200                 MOVE +1                     TO ADOORIDL          09220000
092300                 MOVE +1                     TO ADRTYPCL          09230000
092400                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              09240000
092500           END-IF                                                 09250000
092600           IF ASC-DOOR-TYPE-CODE =  'SH'  AND                     09260000
092700              (ASC-DIVERT-LOC = SPACES  OR                        09270000
092800               ASC-DIVERT-LOC = LOW-VALUES)                       09280000
092900                 SET PS-ERROR                                     09290000
093000                     DP020-MSG-FATAL                              09300000
093100                     ASC-DVRT-LANE-REQ-YES   TO TRUE              09310000
093200                 MOVE PC-TSYMSG-00007        TO DP020-MSG-NUMBER  09320000
093300                 MOVE DP015-UNP-ALP-BRT-OFF  TO ADIVLOCA          09330000
093400                 MOVE DP015-RED              TO ADIVLOCC          09340000
093500                 MOVE DP015-REVERSE          TO ADIVLOCH          09350000
093600                 MOVE -1                     TO ADIVLOCL          09360000
093700                 MOVE +1                     TO ADOORIDL          09370000
093800                 MOVE +1                     TO ADRTYPCL          09380000
093900                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              09390000
094000           END-IF                                                 09400000
094100* DMH - END                                                       09410000
094200           IF (ASC-DOOR-ID = 'YARD' AND                           09420000
094300              ASC-DOOR-TYPE-CODE NOT =  'YD')                     09430000
094400                 SET PS-ERROR                                     09440000
094500                     DP020-MSG-FATAL         TO TRUE              09450000
094600                 MOVE PC-TSYMSG-00005        TO DP020-MSG-NUMBER  09460000
094700                 MOVE DP015-UNP-ALP-BRT-OFF  TO ADRTYPCA          09470000
094800                 MOVE DP015-RED              TO ADRTYPCC          09480000
094900                 MOVE DP015-REVERSE          TO ADRTYPCH          09490000
095000                 MOVE -1                     TO ADRTYPCL          09500000
095100                 MOVE +1                     TO ADOORIDL          09510000
095200                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              09520000
095300           END-IF                                                 09530000
095400           IF (ASC-DOOR-ID NOT = 'YARD' AND                       09540000
095500              ASC-DOOR-TYPE-CODE =  'YD')                         09550000
095600                 SET PS-ERROR                                     09560000
095700                     DP020-MSG-FATAL         TO TRUE              09570000
095800                 MOVE PC-TSYMSG-00005        TO DP020-MSG-NUMBER  09580000
095900                 MOVE DP015-UNP-ALP-BRT-OFF  TO ADOORIDA          09590000
096000                 MOVE DP015-RED              TO ADOORIDC          09600000
096100                 MOVE DP015-REVERSE          TO ADOORIDH          09610000
096200                 MOVE -1                     TO ADOORIDL          09620000
096300                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              09630000
096400           END-IF                                                 09640000
096401                                                                  09640100
096402* DMH - 3/5/03 BEGIN                                              09640200
096410           IF  ASC-DOOR-TYPE-CODE = 'SH'                          09641000
096430               MOVE ASC-LANE-ASGNMT-N   TO  PV-LANE-ASSGN-NUM     09643000
096431               IF  PV-LANE-ASSGN-NUM  >  0    AND                 09643100
096440                   ASC-DIVERT-LOC     > SPACES                    09644000
096441                   CONTINUE                                       09644100
096442               ELSE                                               09644200
096450                   SET PS-ERROR                                   09645000
096460                       DP020-MSG-FATAL       TO TRUE              09646000
096470                   MOVE PC-TSYMSG-03046      TO DP020-MSG-NUMBER  09647000
096471                   MOVE DP015-UNP-ALP-BRT-OFF TO ALANEASGA        09647100
096472                                                 ADIVLOCA         09647200
096473                   MOVE DP015-RED             TO ALANEASGC        09647300
096474                                                 ADIVLOCC         09647400
096475                   MOVE DP015-REVERSE         TO ALANEASGH        09647500
096476                                                 ADIVLOCH         09647600
096477                   MOVE -1                    TO ALANEASGL        09647700
096478                                                 ADIVLOCL         09647800
096479                   SET DP030-SET-CURSOR-APPL-1 TO TRUE            09647900
096480               END-IF                                             09648000
096481                                                                  09648100
096482               IF PS-NO-ERROR                                     09648200
096483                  IF PV-INP-LABEL-SEQ > 0                         09648300
096484                    PERFORM 3080-CHECK-EXISTING-LBL-SEQ           09648400
096485                    IF PS-LBL-SEQ-OPER-EXISTS-YES                 09648500
096486                      SET PS-ERROR                                09648600
096487                          DP020-MSG-FATAL       TO TRUE           09648700
096488                      MOVE PC-TSYMSG-03264   TO DP020-MSG-NUMBER  09648800
096489                      MOVE CNDCDR-DOOR-ID       TO DP020-MSG-TEXT 09648900
096490                      MOVE DP015-UNP-ALP-BRT-OFF TO ALBLNBRA      09649000
096491                      MOVE DP015-RED             TO ALBLNBRC      09649100
096492                      MOVE DP015-REVERSE         TO ALBLNBRH      09649200
096493                      MOVE -1                    TO ALBLNBRL      09649300
096494                      SET DP030-SET-CURSOR-APPL-1 TO TRUE         09649400
096495                    END-IF                                        09649500
096496                  ELSE                                            09649600
096497                      SET PS-ERROR                                09649700
096498                          DP020-MSG-FATAL       TO TRUE           09649800
096499                      MOVE PC-TSYMSG-03267   TO DP020-MSG-NUMBER  09649900
096500                      MOVE DP015-UNP-ALP-BRT-OFF TO ALBLNBRA      09650000
096501                      MOVE DP015-RED             TO ALBLNBRC      09650100
096502                      MOVE DP015-REVERSE         TO ALBLNBRH      09650200
096503                      MOVE -1                    TO ALBLNBRL      09650300
096504                      SET DP030-SET-CURSOR-APPL-1 TO TRUE         09650400
096505                  END-IF                                          09650500
096506               END-IF                                             09650600
096507* DMH 7/26 ELSE                                                   09650700
096508* GB  - 5/10/04 BEG                                               09650800
096509*                                                                 09650900
096510* DMH 7/27/04  MOVE ASC-LABEL-SEQ-N TO PV-LABEL-SEQ               09651000
096511* DMH 7/27/04  IF PV-LABEL-SEQ > 0                                09651100
096512* DMH 7/27/04     SET PS-ERROR                                    09651200
096513* DMH 7/27/04         DP020-MSG-FATAL       TO TRUE               09651300
096514* DMH 7/27/04     MOVE PC-TSYMSG-03266      TO DP020-MSG-NUMBER   09651400
096515* DMH 7/27/04     MOVE DP015-UNP-ALP-BRT-OFF TO ALBLNBRA          09651500
096516* DMH 7/27/04     MOVE DP015-RED             TO ALBLNBRC          09651600
096517* DMH 7/27/04     MOVE DP015-REVERSE         TO ALBLNBRH          09651700
096518* DMH 7/27/04     MOVE +1                    TO ADRTYPCL          09651800
096519* DMH 7/27/04     MOVE -1                    TO ALBLNBRL          09651900
096520* DMH 7/27/04     SET DP030-SET-CURSOR-APPL-1 TO TRUE             09652000
096521* DMH 7/27/04  END-IF                                             09652100
096522* GB  - 5/10/04 END                                               09652200
096523                                                                  09652300
096524           END-IF                                                 09652400
096525* DMH - 3/5/03 END                                                09652500
096526                                                                  09652600
096527           IF (ASC-DOOR-TYPE-CODE = 'RC'  OR                      09652700
096528               ASC-DOOR-TYPE-CODE = 'SG')        AND              09652800
096530               (ASC-LANE-ASGNMT-N NOT > 0  AND                    09653000
096540                ASC-DIVERT-LOC    NOT > SPACES)                   09654000
096541               CONTINUE                                           09654100
096550           ELSE                                                   09655000
096560               IF  PS-NO-ERROR                                    09656000
096600                   PERFORM 3060-SELECT-TCNDCDR                    09660000
096610               END-IF                                             09661000
096620           END-IF                                                 09662000
096700                                                                  09670000
096800           IF  PS-NO-ERROR                                        09680000
096900               PERFORM 5000-PROCESS-ADD                           09690000
097000               IF  PS-NO-ERROR                                    09700000
097100                   PERFORM 2110-PREPARE-INTER-APPL-COMM           09710000
097200                   MOVE DP015-PRO-NOR-OFF        TO ADOORIDA      09720000
097300                                                    ADRTYPCA      09730000
097400                                                    ALOCDSCA      09740000
097500                                                    ALANEASGA     09750000
097600                                                    ADIVLOCA      09760000
097700                                                    ALBLNBRA      09770000
097800                   MOVE DP015-BLUE               TO ADOORIDC      09780000
097900                                                    ADRTYPCC      09790000
098000                                                    ALOCDSCC      09800000
098100                                                    ALANEASGC     09810000
098200                                                    ADIVLOCC      09820000
098300                                                    ALBLNBRC      09830000
098400                   MOVE DP015-HL-OFF             TO ADOORIDH      09840000
098500                                                    ADRTYPCH      09850000
098600                                                    ALOCDSCH      09860000
098700                                                    ALANEASGH     09870000
098800                                                    ADIVLOCH      09880000
098900                                                    ALBLNBRH      09890000
099000               END-IF                                             09900000
099100           END-IF                                                 09910000
099200                                                                  09920000
099300*-F15 = UPDATE DOOR ID                                            09930000
099400         WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)              09940000
099410             SET ASC-F2-CONFIRM-NO TO TRUE                        09941000
099500*DMH         IF ASC-ACTION-SW = 'UPD'                             09950000
099600*DMH             PERFORM 9100-READ-SEL-QUEUE                      09960000
099700*DMH             SET CN013-UPD (ASC-SEL-SUB) TO TRUE              09970000
099800*DMH             MOVE ASC-DOOR-ID  TO CN013-DOOR-ID (ASC-SEL-SUB) 09980000
099900*DMH             MOVE ASC-DOOR-TYPE-CODE                          09990000
100000*DMH                              TO CN013-TYPE-CODE (ASC-SEL-SUB)10000000
100100*DMH             MOVE ASC-LOC-DESC TO CN013-LOC-DESC (ASC-SEL-SUB)10010000
100200*DMH             MOVE ASC-LANE-ASGNMT-N                           10020000
100300*DMH                            TO CN013-LANE-ASGNMT (ASC-SEL-SUB)10030000
100400*DMH             MOVE ASC-DIVERT-LOC                              10040000
100500*DMH                         TO CN013-DIVERT-LOC-ID (ASC-SEL-SUB) 10050000
100600*DMH             MOVE ASC-LABEL-SEQ-N                             10060000
100700*DMH                           TO CN013-LBL-SEQ-NBR (ASC-SEL-SUB) 10070000
100800*DMH             MOVE ASC-STORE-ASGNMT                            10080000
100900*DMH                          TO CN013-STORE-ASGNMT (ASC-SEL-SUB) 10090000
101000*DMH             PERFORM 9200-REWRITE-SEL-QUEUE                   10100000
101100*DMH         END-IF                                               10110000
101200                                                                  10120000
101300           IF  ASC-DOOR-ID  = SPACES                              10130000
101400                 SET PS-ERROR                                     10140000
101500                     DP020-MSG-FATAL         TO TRUE              10150000
101600                 MOVE PC-TSYMSG-00007        TO DP020-MSG-NUMBER  10160000
101700                 MOVE DP015-UNP-ALP-BRT-OFF  TO ADOORIDA          10170000
101800                 MOVE DP015-RED              TO ADOORIDC          10180000
101900                 MOVE DP015-REVERSE          TO ADOORIDH          10190000
102000                 MOVE -1                     TO ADOORIDL          10200000
102100                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              10210000
102200           END-IF                                                 10220000
102300           IF  ASC-DOOR-TYPE-CODE = SPACES                        10230000
102400                 SET PS-ERROR                                     10240000
102500                     DP020-MSG-FATAL         TO TRUE              10250000
102600                 MOVE PC-TSYMSG-00007        TO DP020-MSG-NUMBER  10260000
102700                 MOVE DP015-UNP-ALP-BRT-OFF  TO ADRTYPCA          10270000
102800                 MOVE DP015-RED              TO ADRTYPCC          10280000
102900                 MOVE DP015-REVERSE          TO ADRTYPCH          10290000
103000                 MOVE -1                     TO ADRTYPCL          10300000
103100                 MOVE +1                     TO ADOORIDL          10310000
103200                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              10320000
103300           END-IF                                                 10330000
103400           IF  ASC-LOC-DESC  = SPACES                             10340000
103500                 SET PS-ERROR                                     10350000
103600                     DP020-MSG-FATAL         TO TRUE              10360000
103700                 MOVE PC-TSYMSG-00007        TO DP020-MSG-NUMBER  10370000
103800                 MOVE DP015-UNP-ALP-BRT-OFF  TO ALOCDSCA          10380000
103900                 MOVE DP015-RED              TO ALOCDSCC          10390000
104000                 MOVE DP015-REVERSE          TO ALOCDSCH          10400000
104100                 MOVE -1                     TO ALOCDSCL          10410000
104200                 MOVE +1                     TO ADOORIDL          10420000
104300                 MOVE +1                     TO ADRTYPCL          10430000
104400                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              10440000
104500           END-IF                                                 10450000
104600* DMH - BEGIN                                                     10460000
104700           IF ASC-DOOR-TYPE-CODE =  'SH'  AND                     10470000
104800              (ASC-LANE-ASGNMT = SPACE  OR                        10480000
104900               ASC-LANE-ASGNMT = LOW-VALUES)                      10490000
105000                 SET PS-ERROR                                     10500000
105100                     DP020-MSG-FATAL                              10510000
105200                     ASC-DVRT-LANE-REQ-YES   TO TRUE              10520000
105300                 MOVE PC-TSYMSG-00007        TO DP020-MSG-NUMBER  10530000
105400                 MOVE DP015-UNP-ALP-BRT-OFF  TO ALANEASGA         10540000
105500                                                ADIVLOCA          10550000
105600                 MOVE DP015-RED              TO ALANEASGC         10560000
105700                                                ADIVLOCC          10570000
105800                 MOVE DP015-REVERSE          TO ALANEASGH         10580000
105900                                                ADIVLOCH          10590000
106000                 MOVE -1                     TO ALANEASGL         10600000
106100                 MOVE +1                     TO ADOORIDL          10610000
106200                 MOVE +1                     TO ADRTYPCL          10620000
106300                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              10630000
106400           END-IF                                                 10640000
106500           IF ASC-DOOR-TYPE-CODE =  'SH'  AND                     10650000
106600              (ASC-DIVERT-LOC = SPACES  OR                        10660000
106700               ASC-DIVERT-LOC = LOW-VALUES)                       10670000
106800                 SET PS-ERROR                                     10680000
106900                     DP020-MSG-FATAL                              10690000
107000                     ASC-DVRT-LANE-REQ-YES   TO TRUE              10700000
107100                 MOVE PC-TSYMSG-00007        TO DP020-MSG-NUMBER  10710000
107200                 MOVE DP015-UNP-ALP-BRT-OFF  TO ALANEASGA         10720000
107300                                                ADIVLOCA          10730000
107400                 MOVE DP015-RED              TO ALANEASGC         10740000
107500                                                ADIVLOCC          10750000
107600                 MOVE DP015-REVERSE          TO ALANEASGH         10760000
107700                                                ADIVLOCH          10770000
107800                 MOVE -1                     TO ADIVLOCL          10780000
107900                 MOVE +1                     TO ADOORIDL          10790000
108000                 MOVE +1                     TO ADRTYPCL          10800000
108100                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              10810000
108200           END-IF                                                 10820000
108300* DMH - END                                                       10830000
108400           IF (ASC-DOOR-ID = 'YARD' AND                           10840000
108500              ASC-DOOR-TYPE-CODE NOT =  'YD')                     10850000
108600                 SET PS-ERROR                                     10860000
108700                     DP020-MSG-FATAL         TO TRUE              10870000
108800                 MOVE PC-TSYMSG-00005        TO DP020-MSG-NUMBER  10880000
108900                 MOVE DP015-UNP-ALP-BRT-OFF  TO ADRTYPCA          10890000
109000                 MOVE DP015-RED              TO ADRTYPCC          10900000
109100                 MOVE DP015-REVERSE          TO ADRTYPCH          10910000
109200                 MOVE -1                     TO ADRTYPCL          10920000
109300                 MOVE +1                     TO ADOORIDL          10930000
109400                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              10940000
109500           END-IF                                                 10950000
109600           IF (ASC-DOOR-ID NOT = 'YARD' AND                       10960000
109700              ASC-DOOR-TYPE-CODE =  'YD')                         10970000
109800                 SET PS-ERROR                                     10980000
109900                     DP020-MSG-FATAL         TO TRUE              10990000
110000                 MOVE PC-TSYMSG-00005        TO DP020-MSG-NUMBER  11000000
110100                 MOVE DP015-UNP-ALP-BRT-OFF  TO ADOORIDA          11010000
110200                 MOVE DP015-RED              TO ADOORIDC          11020000
110300                 MOVE DP015-REVERSE          TO ADOORIDH          11030000
110400                 MOVE -1                     TO ADOORIDL          11040000
110500                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              11050000
110600           END-IF                                                 11060000
110700           IF (ASC-DOOR-TYPE-CODE = 'SH' OR 'DS') AND             11070000
110800              (ASC-LANE-ASGNMT > SPACE)                           11080000
110900                   PERFORM 4100-CHECK-4-STORE-ASGNMT              11090000
111000                   IF PS-STORES-EXIST                             11100000
111100                       PERFORM 4200-CHECK-4-DUP-DIVERT            11110000
111200                   END-IF                                         11120000
111300           END-IF                                                 11130000
111400*GB  9/14/05     --ADD CHECK FOR PS-NO-ERROR                      11140000
111401         IF PS-NO-ERROR                                           11140100
111600               PERFORM 3060-SELECT-TCNDCDR                        11160000
113003******************************************************************11300300
113004         END-IF                                                   11300400
113005******************************************************************11300500
113006                                                                  11300600
113010               IF PS-NO-ERROR                                     11301000
113011                  IF PV-INP-LABEL-SEQ > 0                         11301100
113020                    PERFORM 3080-CHECK-EXISTING-LBL-SEQ           11302000
113030                    IF PS-LBL-SEQ-OPER-EXISTS-YES                 11303000
113040                      SET PS-ERROR                                11304000
113050                          DP020-MSG-FATAL       TO TRUE           11305000
113060                      MOVE PC-TSYMSG-03264    TO DP020-MSG-NUMBER 11306000
113070                      MOVE CNDCDR-DOOR-ID      TO DP020-MSG-TEXT  11307000
113080                      MOVE DP015-UNP-ALP-BRT-OFF TO ALBLNBRA      11308000
113090                      MOVE DP015-RED             TO ALBLNBRC      11309000
113091                      MOVE DP015-REVERSE         TO ALBLNBRH      11309100
113092                      MOVE -1                    TO ALBLNBRL      11309200
113093                      SET DP030-SET-CURSOR-APPL-1 TO TRUE         11309300
113100                    END-IF                                        11310000
113101                  ELSE                                            11310100
113102                      SET PS-ERROR                                11310200
113103                          DP020-MSG-FATAL       TO TRUE           11310300
113104                      MOVE PC-TSYMSG-03267    TO DP020-MSG-NUMBER 11310400
113106                      MOVE DP015-UNP-ALP-BRT-OFF TO ALBLNBRA      11310600
113107                      MOVE DP015-RED             TO ALBLNBRC      11310700
113108                      MOVE DP015-REVERSE         TO ALBLNBRH      11310800
113109                      MOVE -1                    TO ALBLNBRL      11310900
113110                      SET DP030-SET-CURSOR-APPL-1 TO TRUE         11311000
113111                  END-IF                                          11311100
113112               END-IF                                             11311200
113113                                                                  11311300
113114* DMH 7/27 ELSE                                                   11311400
113115* DMH 7/27/04 MOVE ASC-LABEL-SEQ-N TO PV-LABEL-SEQ                11311500
113116* DMH 7/27/04 IF PV-LABEL-SEQ > 0                                 11311600
113117* DMH 7/27/04    SET PS-ERROR                                     11311700
113118* DMH 7/27/04        DP020-MSG-FATAL       TO TRUE                11311800
113119* DMH 7/27/04    MOVE PC-TSYMSG-03266      TO DP020-MSG-NUMBER    11311900
113120* DMH 7/27/04    MOVE DP015-UNP-ALP-BRT-OFF TO ALBLNBRA           11312000
113121* DMH 7/27/04    MOVE DP015-RED             TO ALBLNBRC           11312100
113122* DMH 7/27/04    MOVE DP015-REVERSE         TO ALBLNBRH           11312200
113123* DMH 7/27/04    MOVE +1                    TO ADRTYPCL           11312300
113124* DMH 7/27/04    MOVE -1                    TO ALBLNBRL           11312400
113125* DMH 7/27/04    SET DP030-SET-CURSOR-APPL-1 TO TRUE              11312500
113126* DMH 7/27/04 END-IF                                              11312600
113127                                                                  11312700
113300           IF  PS-NO-ERROR                                        11330000
113310                SET ASC-F2-CONFIRM-YES      TO TRUE               11331000
113400                SET PS-ERROR                TO TRUE               11340000
113500                SET DP020-MSG-FATAL         TO TRUE               11350000
113600                MOVE PC-TSYMSG-02576        TO DP020-MSG-NUMBER   11360000
113700                MOVE DP015-PRO-NOR-OFF      TO ADOORIDA           11370000
113800                MOVE DP015-BLUE             TO ADOORIDC           11380000
113900                MOVE -1                     TO ADRTYPCL           11390000
114000                SET DP030-SET-CURSOR-APPL-1 TO TRUE               11400000
114100           END-IF                                                 11410000
114200                                                                  11420000
114300*-F17 = DOORLIST -- DOOR TYPE LIST                                11430000
114400         WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              11440000
114500             CONTINUE                                             11450000
114600                                                                  11460000
114700*F24 STR ASGN ----> GOES TO CNKCS228 TO PROCESS A STORE ASSIGNMENT11470000
114800         WHEN DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID)              11480000
114900           IF  ASC-DOOR-ID  = SPACES                              11490000
115000                 SET PS-ERROR                                     11500000
115100                     DP020-MSG-FATAL         TO TRUE              11510000
115200                 MOVE PC-TSYMSG-00007        TO DP020-MSG-NUMBER  11520000
115300                 MOVE DP015-UNP-ALP-BRT-OFF  TO ADOORIDA          11530000
115400                 MOVE DP015-RED              TO ADOORIDC          11540000
115500                 MOVE DP015-REVERSE          TO ADOORIDH          11550000
115600                 MOVE -1                     TO ADOORIDL          11560000
115700                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              11570000
115800           END-IF                                                 11580000
115900           IF  ASC-DOOR-TYPE-CODE = SPACES                        11590000
116000                 SET PS-ERROR                                     11600000
116100                     DP020-MSG-FATAL         TO TRUE              11610000
116200                 MOVE PC-TSYMSG-00007        TO DP020-MSG-NUMBER  11620000
116300                 MOVE DP015-UNP-ALP-BRT-OFF  TO ADRTYPCA          11630000
116400                 MOVE DP015-RED              TO ADRTYPCC          11640000
116500                 MOVE DP015-REVERSE          TO ADRTYPCH          11650000
116600                 MOVE -1                     TO ADRTYPCL          11660000
116700                 MOVE +1                     TO ADOORIDL          11670000
116800                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              11680000
116900           END-IF                                                 11690000
117000           IF PS-NO-ERROR                                         11700000
117100               PERFORM 3040-CHECK-4-ROW-ON-CNDCDR                 11710000
117200               PERFORM 3020-VALIDATE-DOOR-TYPE-CODE               11720000
117300               IF PS-NO-ERROR                                     11730000
117400                   PERFORM 3050-CHECK-4-SH-OR-DS-DOOR             11740000
117500                   IF PS-NO-ERROR                                 11750000
117600                       PERFORM 2110-PREPARE-INTER-APPL-COMM       11760000
117700                   END-IF                                         11770000
117800               END-IF                                             11780000
117900           END-IF                                                 11790000
118000           PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                   11800000
118100                                                                  11810000
118200         WHEN DP020-FK-CONFIRM  (DP020-SRC-AID) AND               11820000
118201              ASC-F2-CONFIRM-NO                                   11820100
118202               MOVE PC-TSYMSG-00045 TO DP020-MSG-NUMBER           11820200
118203               SET DP020-MSG-FATAL TO TRUE                        11820300
118210         WHEN OTHER                                               11821000
118300             SET DP013-NO-ROLLBACK                                11830000
118400                 DP013-XCTL-DISPLAY-RESTART                       11840000
118500                 DP013-CICS-ABEND      TO TRUE                    11850000
118600             MOVE '2000-PROCESS-PANEL' TO DP013-PARAGRAPH         11860000
118700             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      11870000
118800                                   TO DP013-MESSAGE-TEXT (1)      11880000
118900             PERFORM DP013-0000-PROCESS-ABEND                     11890000
119000                                                                  11900000
119100     END-EVALUATE.                                                11910000
119200                                                                  11920000
119300******************************************************************11930000
119400** MOVE DATA NECESSARY TO THE DESTINATION PROGRAM(S) INTO THE   **11940000
119500** INTER-APPLICATION COMMAREA.                                  **11950000
119600******************************************************************11960000
119700 2110-PREPARE-INTER-APPL-COMM.                                    11970000
119800                                                                  11980000
119900     INITIALIZE CN011-INTER-APPL-COMMAREA.                        11990000
120000                                                                  12000000
120100     MOVE ASC-FUNCTION             TO CN011-FUNCTION.             12010000
120200     MOVE ASC-CURR-OPER-UNT-ID     TO CN011-CURR-OPER-UNT-ID.     12020000
120300     MOVE 1                        TO CN011-CURR-FCLTY-ID         12030000
120400                                      CN011-FCLTY-ID.             12040000
120500     MOVE ASC-CURR-FCLTY-NME       TO CN011-CURR-FCLTY-NME.       12050000
120600     MOVE ASC-OPER-UNT-ID          TO CN011-OPER-UNT-ID.          12060000
120700     MOVE ASC-FCLTY-NME            TO CN011-FCLTY-NME.            12070000
120800     MOVE ASC-DOOR-ID              TO CN011-DOOR-ID.              12080000
120900     MOVE ASC-DOOR-TYPE-CODE       TO CN011-DOOR-TYPE-CDE.        12090000
121000     MOVE ASC-DOOR-TYPE-DESC       TO CN011-DOOR-TYPE-DESC.       12100000
121100     MOVE ASC-LOC-DESC             TO CN011-LOC-DESC.             12110000
121200     MOVE ASC-LANE-ASGNMT-N        TO CN011-DIVERT-CODE.          12120000
121300     MOVE ASC-DIVERT-LOC           TO CN011-DIVERT-LOC-ID.        12130000
121400     MOVE ASC-LABEL-SEQ-N          TO CN011-LABEL-SEQ.            12140000
121500                                                                  12150000
121600*----------------------------------------------------------------*12160000
121700* MOVE DATA ENTERED ON THE SCREEN INTO THEIR RESPECTIVE FIELDS   *12170000
121800* IN THE APPLICATION-SPECIFIC COMMAREA.  ALL EDITS ARE DONE IN   *12180000
121900* THE APPLICATION-SPECIFIC COMMAERA, NOT ON THE SCREEN.          *12190000
122000* THIS PARAGRAPH DOES NOT USE TEMPORARY VARIABLES.               *12200000
122100*----------------------------------------------------------------*12210000
122200 2200-MOVE-SCREEN-TO-COMMAREA.                                    12220000
122300*DOOR ID                                                          12230000
122400         IF  ADOORIDL > ZERO                                      12240000
122500             MOVE ADOORIDI             TO ASC-DOOR-ID             12250000
122600             MOVE ASC-DOOR-ID          TO PV-INP-DOOR-ID          12260000
122700         ELSE                                                     12270000
122800             IF  ADOORIDF = DP015-ERASE-EOF                       12280000
122900                 MOVE SPACES           TO ASC-DOOR-ID             12290000
123000             END-IF                                               12300000
123100         END-IF                                                   12310000
123200                                                                  12320000
123300*DOOR TYPE CODE                                                   12330000
123400         IF  ADRTYPCL > ZERO                                      12340000
123500             MOVE ADRTYPCI             TO ASC-DOOR-TYPE-CODE      12350000
123600         ELSE                                                     12360000
123700             IF  ADRTYPCF = DP015-ERASE-EOF                       12370000
123800                 MOVE SPACES           TO ASC-DOOR-TYPE-CODE      12380000
123900             END-IF                                               12390000
124000         END-IF                                                   12400000
124100                                                                  12410000
124200*DOOR LOCATION DESC                                               12420000
124300         IF  ALOCDSCL > ZERO                                      12430000
124400             MOVE ALOCDSCI             TO ASC-LOC-DESC            12440000
124500         ELSE                                                     12450000
124600             IF  ALOCDSCF = DP015-ERASE-EOF                       12460000
124700                 MOVE SPACES           TO ASC-LOC-DESC            12470000
124800             END-IF                                               12480000
124900         END-IF                                                   12490000
125000                                                                  12500000
125100*LANE ASSIGNMENT                                                  12510000
125200         IF  ALANEASGL > ZERO                                     12520000
125300             MOVE ALANEASGI             TO ASC-LANE-ASGNMT        12530000
125400         ELSE                                                     12540000
125500             IF  ALANEASGF = DP015-ERASE-EOF                      12550000
125600                 MOVE SPACES           TO ASC-LANE-ASGNMT         12560000
125700             END-IF                                               12570000
125800         END-IF                                                   12580000
125900                                                                  12590000
126000*DIVERT LOCATION ID                                               12600000
126100         IF  ADIVLOCL > ZERO                                      12610000
126200             MOVE ADIVLOCI             TO ASC-DIVERT-LOC          12620000
126300         ELSE                                                     12630000
126400             IF  ADIVLOCF = DP015-ERASE-EOF                       12640000
126500                 MOVE SPACES           TO ASC-DIVERT-LOC          12650000
126600             END-IF                                               12660000
126700         END-IF                                                   12670000
126800                                                                  12680000
126900*LABEL SEQUENCE NBR                                               12690000
127000         IF  ALBLNBRL > ZERO                                      12700000
127100             MOVE ALBLNBRI             TO ASC-LABEL-SEQ           12710000
127200         ELSE                                                     12720000
127300             IF  ALBLNBRF = DP015-ERASE-EOF                       12730000
127400                 MOVE ZEROES           TO ASC-LABEL-SEQ           12740000
127500             END-IF                                               12750000
127600         END-IF.                                                  12760000
127700                                                                  12770000
127800*----------------------------------------------------------------*12780000
127900* PERFORM EDITS ON EACH FIELD ENTERED BY THE USER.  IF AN ERROR  *12790000
128000* IS FOUND, THE CURSOR IS POSITIONED AT THAT FIELD AND AN        *12800000
128100* APPROPRIATE ERROR MESSAGE IS DISPLAYED.                        *12810000
128200*----------------------------------------------------------------*12820000
128300 3000-EDIT-DATA-IN-COMMAREA.                                      12830000
128400                                                                  12840000
128500     IF  ASC-DOOR-ID    >  SPACES                                 12850000
128600             IF ASC-LOC-DESC = SPACES AND ASC-FUNCTION = PC-U     12860000
128700                 PERFORM 3040-CHECK-4-ROW-ON-CNDCDR               12870000
128800             END-IF                                               12880000
128900     ELSE                                                         12890000
129000         IF DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID)                12900000
129100             SET PS-ERROR                                         12910000
129200                 DP020-MSG-FATAL         TO TRUE                  12920000
129300            MOVE PC-TSYMSG-00007        TO DP020-MSG-NUMBER       12930000
129400            MOVE DP015-UNP-ALP-BRT-OFF  TO ADOORIDA               12940000
129500            MOVE DP015-RED              TO ADOORIDC               12950000
129600            MOVE DP015-REVERSE          TO ADOORIDH               12960000
129700            MOVE -1                     TO ADOORIDL               12970000
129800            SET DP030-SET-CURSOR-APPL-1 TO TRUE                   12980000
129900         END-IF                                                   12990000
130000     END-IF.                                                      13000000
130100                                                                  13010000
130200     IF  PS-NO-ERROR                                              13020000
130300         IF  ASC-DOOR-TYPE-CODE  >  SPACES                        13030000
130310           IF  DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)             13031000
130311             SET PS-TYPE-CHANGED-NO  TO  TRUE                     13031100
130320             PERFORM 4005-CK-TYPE-CHANGED                         13032000
130330             IF PS-TYPE-CHANGED-YES                               13033000
130400                PERFORM 3020-VALIDATE-DOOR-TYPE-CODE              13040000
130500                IF  PS-NO-ERROR                                   13050000
130600                  EVALUATE ASC-DOOR-TYPE-CODE                     13060000
130700                     WHEN PC-SH                                   13070000
130800                         PERFORM 4010-VALIDATE-DOOR-TYPE-SH       13080000
130900                     WHEN PC-DS                                   13090000
131000                         PERFORM 4020-VALIDATE-DOOR-TYPE-DS       13100000
131100                     WHEN OTHER                                   13110000
131200                         PERFORM 4030-VALIDATE-OTHER-DOOR-TYPES   13120000
131300                   END-EVALUATE                                   13130000
131400                END-IF                                            13140000
131401             END-IF                                               13140100
131410           END-IF                                                 13141000
131500         ELSE                                                     13150000
131600             IF DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID)            13160000
131700                 SET PS-ERROR                                     13170000
131800                     DP020-MSG-FATAL         TO TRUE              13180000
131900                MOVE PC-TSYMSG-00007        TO DP020-MSG-NUMBER   13190000
132000                MOVE DP015-UNP-ALP-BRT-OFF  TO ADRTYPCA           13200000
132100                MOVE DP015-RED              TO ADRTYPCC           13210000
132200                MOVE DP015-REVERSE          TO ADRTYPCH           13220000
132300                MOVE -1                     TO ADRTYPCL           13230000
132400                MOVE +1                     TO ADOORIDL           13240000
132500                SET DP030-SET-CURSOR-APPL-1 TO TRUE               13250000
132600         END-IF                                                   13260000
132700     END-IF.                                                      13270000
132800                                                                  13280000
132900     IF  PS-NO-ERROR                                              13290000
133000         IF  ASC-LANE-ASGNMT  >  SPACES                           13300000
133100             MOVE ASC-LANE-ASGNMT        TO DP010I-UNEDITED-FIELD 13310000
133200             MOVE LENGTH OF ASC-LANE-ASGNMT                       13320000
133300                                       TO DP010I-MAXIMUM-DIGITS   13330000
133400             MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS 13340000
133500             SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE              13350000
263455             CALL DP010I-NUMERIC-EDIT-ROUTINE                     13361001
263455                  USING DP010I-NUMERIC-EDIT-AREA                  13362001
133700             IF  DP010I-ERROR-DETECTED                            13370000
133800                 SET PS-ERROR                                     13380000
133900                     DP020-MSG-FATAL         TO TRUE              13390000
134000                MOVE PC-TSYMSG-00008        TO DP020-MSG-NUMBER   13400000
134100                MOVE DP015-UNP-ALP-BRT-OFF  TO ALANEASGA          13410000
134200                MOVE DP015-RED              TO ALANEASGC          13420000
134300                MOVE DP015-REVERSE          TO ALANEASGH          13430000
134400                MOVE -1                     TO ALANEASGL          13440000
134500                MOVE +1                     TO ADOORIDL           13450000
134600                MOVE +1                     TO ADRTYPCL           13460000
134700                SET DP030-SET-CURSOR-APPL-1 TO TRUE               13470000
134800             ELSE                                                 13480000
134900                 MOVE DP010I-NUMERIC-FIELD TO ASC-LANE-ASGNMT-N   13490000
135000             END-IF                                               13500000
135100         END-IF                                                   13510000
135200     END-IF.                                                      13520000
135300*                                                                 13530000
135400     IF  PS-NO-ERROR                                              13540000
135500         IF  ASC-LABEL-SEQ   >  SPACES                            13550000
135600             MOVE ASC-LABEL-SEQ   TO DP010I-UNEDITED-FIELD        13560000
135700             MOVE LENGTH OF ASC-LABEL-SEQ TO DP010I-MAXIMUM-DIGITS13570000
135800             MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS 13580000
135900             SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE              13590000
263455             CALL DP010I-NUMERIC-EDIT-ROUTINE                     13601001
263455                  USING DP010I-NUMERIC-EDIT-AREA                  13602001
136100             IF  DP010I-ERROR-DETECTED                            13610000
136200                 SET PS-ERROR                                     13620000
136300                     DP020-MSG-FATAL         TO TRUE              13630000
136400                 MOVE PC-TSYMSG-00008        TO DP020-MSG-NUMBER  13640000
136500                 MOVE DP015-UNP-ALP-BRT-OFF  TO ALBLNBRA          13650000
136600                 MOVE DP015-RED              TO ALBLNBRC          13660000
136700                 MOVE DP015-REVERSE          TO ALBLNBRH          13670000
136800                 MOVE -1                     TO ALBLNBRL          13680000
136900                 MOVE +1                     TO ADOORIDL          13690000
137000                 MOVE +1                     TO ADRTYPCL          13700000
137100                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              13710000
137200             ELSE                                                 13720000
137300                 MOVE DP010I-NUMERIC-FIELD   TO ASC-LABEL-SEQ-N   13730000
137400             END-IF                                               13740000
137500         END-IF                                                   13750000
137600     END-IF.                                                      13760000
137700*                                                                 13770000
137800******************************************************************13780000
137900** VERIFY DOOR TYPE CODE                                        **13790000
138000******************************************************************13800000
138100 3020-VALIDATE-DOOR-TYPE-CODE.                                    13810000
138200      MOVE ASC-DOOR-TYPE-CODE TO DK-DOOR-TYPE-CDE.                13820000
138300                                                                  13830000
138400        EXEC SQL                                                  13840000
138500          SELECT  DOOR_TYP_CDE_DESC                               13850000
138600            INTO :CNDRTY-DOOR-TYP-CDE-DESC                        13860000
138700            FROM  TCNDRTY                                         13870000
138800           WHERE  DOOR_TYP_CDE   = :DK-DOOR-TYPE-CDE              13880000
138900             AND  DIVERT_TYP_CDE = :PC-D                          13890000
139000        END-EXEC                                                  13900000
139100                                                                  13910000
139200        EVALUATE TRUE                                             13920000
139300            WHEN SQLCODE = +0                                     13930000
139400              MOVE CNDRTY-DOOR-TYP-CDE-DESC TO ASC-DOOR-TYPE-DESC 13940000
139500            WHEN SQLCODE = +100                                   13950000
139600                SET PS-ERROR                                      13960000
139700                    DP020-MSG-FATAL         TO TRUE               13970000
139800                MOVE PC-TSYMSG-00005        TO DP020-MSG-NUMBER   13980000
139900                MOVE DP015-UNP-ALP-BRT-OFF  TO ADRTYPCA           13990000
140000                MOVE DP015-RED              TO ADRTYPCC           14000000
140100                MOVE DP015-REVERSE          TO ADRTYPCH           14010000
140200                MOVE -1                     TO ADRTYPCL           14020000
140300                SET DP030-SET-CURSOR-APPL-1 TO TRUE               14030000
140400                MOVE SPACES                 TO ADRTYDSO           14040000
140500            WHEN SQLWARN0 NOT = SPACES                            14050000
140600            WHEN SQLCODE < +0                                     14060000
140700            WHEN SQLCODE > +0                                     14070000
140800                MOVE '3020-VALIDATE-DOOR-TYPE-CODE'               14080000
140900                                          TO DP013-PARAGRAPH      14090000
141000                MOVE 'COULDNT VALIDATE DOOR TYPE CODE'            14100000
141100                                    TO DP013-MESSAGE-TEXT (1)     14110000
141200                MOVE SQLCA      TO DP013-SQLCA                    14120000
141300                MOVE 'TCNDRTY'  TO DP013-DB2-TABLE-NAME (1)       14130000
141400                SET DP013-DB2-ABEND                               14140000
141500                    DP013-XCTL-DISPLAY-RESTART TO TRUE            14150000
141600                PERFORM DP013-0000-PROCESS-ABEND                  14160000
141700        END-EVALUATE.                                             14170000
141800                                                                  14180000
141900******************************************************************14190000
142000** A ROW MUST EXIST ON TCNDCDR.                                   14200000
142100******************************************************************14210000
142200 3040-CHECK-4-ROW-ON-CNDCDR.                                      14220000
142300      MOVE ASC-OPER-UNT-ID   TO DK-OPER-UNT-ID.                   14230000
142400      MOVE ASC-DOOR-ID       TO DK-DOOR-ID.                       14240000
142500                                                                  14250000
142600        EXEC SQL                                                  14260000
142700          SELECT  A.DOOR_TYP_CDE                                  14270000
142800                 ,A.DOOR_LOC_DESC                                 14280000
142900                 ,A.DIVERT_NBR                                    14290000
143000                 ,A.DIVERT_LOC_ID                                 14300000
143100                 ,A.DOOR_LBL_SEQ_NBR                              14310000
143200            INTO :CNDCDR-DOOR-TYP-CDE                             14320000
143300                ,:CNDCDR-DOOR-LOC-DESC                            14330000
143400                ,:CNDCDR-DIVERT-NBR                               14340000
143500                ,:CNDCDR-DIVERT-LOC-ID                            14350000
143600                ,:CNDCDR-DOOR-LBL-SEQ-NBR                         14360000
143700            FROM  TCNDCDR A                                       14370000
143800               ,  TCNDRTY B                                       14380000
143900           WHERE  A.OPER_UNT_ID    = :DK-OPER-UNT-ID              14390000
144000             AND  A.DOOR_ID        = :DK-DOOR-ID                  14400000
144100             AND  A.DOOR_TYP_CDE   = B.DOOR_TYP_CDE               14410000
144200             AND  B.DIVERT_TYP_CDE = :PC-D                        14420000
144300        END-EXEC                                                  14430000
144400                                                                  14440000
144500*--OPER UNT ID MUST EQUAL CURR OPER UNT ID INORDER TO UPDATE.     14450000
144600        EVALUATE TRUE                                             14460000
144700            WHEN SQLCODE = +0                                     14470000
144800              IF ASC-CURR-OPER-UNT-ID = ASC-OPER-UNT-ID           14480000
144900                MOVE CNDCDR-DOOR-TYP-CDE     TO ASC-DOOR-TYPE-CODE14490000
145000                MOVE CNDCDR-DOOR-LOC-DESC    TO ASC-LOC-DESC      14500000
145100                MOVE CNDCDR-DIVERT-NBR       TO ASC-LANE-ASGNMT-N 14510000
145200                MOVE CNDCDR-DIVERT-LOC-ID    TO ASC-DIVERT-LOC    14520000
145300                MOVE CNDCDR-DOOR-LBL-SEQ-NBR TO ASC-LABEL-SEQ-N   14530000
145400              ELSE                                                14540000
145500                SET PS-ERROR                                      14550000
145600                    DP020-MSG-FATAL         TO TRUE               14560000
145700                MOVE PC-TSYMSG-02571        TO DP020-MSG-NUMBER   14570000
145800                MOVE DP015-UNP-ALP-BRT-OFF  TO AOPRUNTA           14580000
145900                MOVE DP015-RED              TO AOPRUNTC           14590000
146000                MOVE DP015-REVERSE          TO AOPRUNTH           14600000
146100                MOVE -1                     TO AOPRUNTL           14610000
146200                SET DP030-SET-CURSOR-APPL-1 TO TRUE               14620000
146300              END-IF                                              14630000
146400            WHEN SQLCODE = +100                                   14640000
146500                MOVE SPACES                 TO ASC-LOC-DESC       14650000
146600                SET PS-ERROR                                      14660000
146700                    DP020-MSG-FATAL         TO TRUE               14670000
146800                MOVE PC-TSYMSG-02574        TO DP020-MSG-NUMBER   14680000
146900                MOVE DP015-UNP-ALP-BRT-OFF  TO AOPRUNTA           14690000
147000                                               ADOORIDA           14700000
147100                MOVE DP015-RED              TO AOPRUNTC           14710000
147200                                               ADOORIDC           14720000
147300                MOVE DP015-REVERSE          TO AOPRUNTH           14730000
147400                                               ADOORIDH           14740000
147500                MOVE -1                     TO AOPRUNTL           14750000
147600                SET DP030-SET-CURSOR-APPL-1 TO TRUE               14760000
147700            WHEN SQLWARN0 NOT = SPACES                            14770000
147800            WHEN SQLCODE < +0                                     14780000
147900            WHEN SQLCODE > +0                                     14790000
148000                MOVE '3040-CHECK-4-ROW-ON-CNDCDR'                 14800000
148100                                          TO DP013-PARAGRAPH      14810000
148200                MOVE 'PROBLEM WITH RETRIEVING ROW'                14820000
148300                                    TO DP013-MESSAGE-TEXT (1)     14830000
148400                MOVE SQLCA      TO DP013-SQLCA                    14840000
148500                MOVE 'TCNDCDR'  TO DP013-DB2-TABLE-NAME (1)       14850000
148600                SET DP013-DB2-ABEND                               14860000
148700                    DP013-XCTL-DISPLAY-RESTART TO TRUE            14870000
148800                PERFORM DP013-0000-PROCESS-ABEND                  14880000
148900        END-EVALUATE.                                             14890000
149000                                                                  14900000
149100******************************************************************14910000
149200*  DOOR TYPE MUST EQUAL SH (SHIPPING) OR DS (DC SHUTTLE) -        14920000
149210*         ST (STORAGE)                                            14921000
149300*         THEN GOTO CNKCS228                                      14930000
149400******************************************************************14940000
149500 3050-CHECK-4-SH-OR-DS-DOOR.                                      14950000
149600     IF ASC-DOOR-TYPE-CODE NOT = 'SH' AND 'DS' AND 'ST'           14960000
149700          SET PS-ERROR                                            14970000
149800              DP020-MSG-FATAL         TO TRUE                     14980000
149900          MOVE PC-TSYMSG-02575        TO DP020-MSG-NUMBER         14990000
150000          MOVE DP015-UNP-ALP-BRT-OFF  TO ADRTYPCA                 15000000
150100          MOVE DP015-RED              TO ADRTYPCC                 15010000
150200          MOVE DP015-REVERSE          TO ADRTYPCH                 15020000
150300          MOVE -1                     TO ADRTYPCL                 15030000
150400          MOVE +1                     TO ADOORIDL                 15040000
150500          SET DP030-SET-CURSOR-APPL-1 TO TRUE                     15050000
150600     END-IF.                                                      15060000
150700                                                                  15070000
150800 3060-SELECT-TCNDCDR.                                             15080000
150900      MOVE ASC-OPER-UNT-ID    TO DK-OPER-UNT-ID.                  15090000
151000      MOVE ASC-LANE-ASGNMT-N  TO DK-DIVERT-NBR.                   15100000
151100      MOVE ASC-DIVERT-LOC     TO DK-DIVERT-LOC.                   15110000
151200      MOVE ASC-DOOR-ID        TO DK-DOOR-ID.                      15120000
151300      MOVE ASC-DOOR-TYPE-CODE TO DK-DOOR-TYPE-CDE.                15130000
151400                                                                  15140000
151500        EXEC SQL                                                  15150000
151600          SELECT  DOOR_TYP_CDE                                    15160000
151700                 ,DOOR_LOC_DESC                                   15170000
151800                 ,DIVERT_NBR                                      15180000
151900                 ,DIVERT_LOC_ID                                   15190000
152000                 ,DOOR_LBL_SEQ_NBR                                15200000
152100            INTO :CNDCDR-DOOR-TYP-CDE                             15210000
152200                ,:CNDCDR-DOOR-LOC-DESC                            15220000
152300                ,:CNDCDR-DIVERT-NBR                               15230000
152400                ,:CNDCDR-DIVERT-LOC-ID                            15240000
152500                ,:CNDCDR-DOOR-LBL-SEQ-NBR                         15250000
152600            FROM  TCNDCDR                                         15260000
152700           WHERE  OPER_UNT_ID      = :DK-OPER-UNT-ID              15270000
152800             AND  DIVERT_NBR       = :DK-DIVERT-NBR               15280000
152900             AND  DIVERT_LOC_ID    = :DK-DIVERT-LOC               15290000
153000             AND  NOT DOOR_ID      = :DK-DOOR-ID                  15300000
153100************ AND  NOT DOOR_TYP_CDE = :PC-SH                       15310000
153200        END-EXEC                                                  15320000
153300                                                                  15330000
153400        EVALUATE TRUE                                             15340000
153500            WHEN SQLCODE = +0                                     15350000
153501            WHEN SQLCODE = -811                                   15350100
153510              IF CNDCDR-DOOR-TYP-CDE  EQUAL PC-SH AND             15351000
153520                 DK-DOOR-TYPE-CDE     EQUAL PC-SH                 15352000
153521                 CONTINUE                                         15352100
153522              ELSE                                                15352200
153600                   SET PS-ERROR                                   15360000
153700                       DP020-MSG-FATAL         TO TRUE            15370000
153800                   MOVE PC-TSYMSG-02936        TO DP020-MSG-NUMBER15380000
153900                   MOVE DP015-UNP-ALP-BRT-OFF  TO ADRTYPCA        15390000
154000                   MOVE DP015-RED              TO ADRTYPCC        15400000
154100                   MOVE DP015-REVERSE          TO ADRTYPCH        15410000
154200                   MOVE -1                     TO ADRTYPCL        15420000
154300                   SET DP030-SET-CURSOR-APPL-1 TO TRUE            15430000
154320              END-IF                                              15432000
154400            WHEN SQLCODE = +100                                   15440000
154500                CONTINUE                                          15450000
154600            WHEN SQLWARN0 NOT = SPACES                            15460000
154700            WHEN SQLCODE < +0                                     15470000
154800            WHEN SQLCODE > +0                                     15480000
154900                MOVE '3060-SELECT-TCNDCDR'                        15490000
155000                                          TO DP013-PARAGRAPH      15500000
155100                MOVE 'PROBLEM WITH RETRIEVING ROW'                15510000
155200                                    TO DP013-MESSAGE-TEXT (1)     15520000
155300                MOVE SQLCA      TO DP013-SQLCA                    15530000
155400                MOVE 'TCNDCDR'  TO DP013-DB2-TABLE-NAME (1)       15540000
155500                SET DP013-DB2-ABEND                               15550000
155600                    DP013-XCTL-DISPLAY-RESTART TO TRUE            15560000
155700                PERFORM DP013-0000-PROCESS-ABEND                  15570000
155800        END-EVALUATE.                                             15580000
160300                                                                  16030000
160310 3080-CHECK-EXISTING-LBL-SEQ.                                     16031000
160311                                                                  16031100
160320      MOVE ASC-OPER-UNT-ID    TO DK-OPER-UNT-ID.                  16032000
160360                                                                  16036000
160370        EXEC SQL                                                  16037000
160380          SELECT  DOOR_ID                                         16038000
160394            INTO :CNDCDR-DOOR-ID                                  16039400
160399            FROM  TCNDCDR                                         16039900
160400           WHERE  OPER_UNT_ID      = :DK-OPER-UNT-ID              16040000
160401             AND  DOOR_LBL_SEQ_NBR = :PV-INP-LABEL-SEQ            16040100
160404        END-EXEC                                                  16040400
160405                                                                  16040500
160406        EVALUATE TRUE                                             16040600
160407            WHEN SQLCODE = +0                                     16040700
160408            WHEN SQLCODE = -811                                   16040800
160409              PERFORM 3085-COUNT-LBL-SEQ-NBRS                     16040900
160411            WHEN SQLCODE = +100                                   16041100
160412              SET PS-LBL-SEQ-OPER-EXISTS-NO  TO TRUE              16041200
160414            WHEN SQLWARN0 NOT = SPACES                            16041400
160415            WHEN SQLCODE < +0                                     16041500
160416            WHEN SQLCODE > +0                                     16041600
160417                MOVE '3080-CHECK-EXISTING-LBL-SEQ'                16041700
160418                                          TO DP013-PARAGRAPH      16041800
160419                MOVE 'PROBLEM WITH RETRIEVING ROW'                16041900
160420                                    TO DP013-MESSAGE-TEXT (1)     16042000
160421                MOVE SQLCA      TO DP013-SQLCA                    16042100
160422                MOVE 'TCNDCDR'  TO DP013-DB2-TABLE-NAME (1)       16042200
160423                SET DP013-DB2-ABEND                               16042300
160424                    DP013-XCTL-DISPLAY-RESTART TO TRUE            16042400
160425                PERFORM DP013-0000-PROCESS-ABEND                  16042500
160426        END-EVALUATE.                                             16042600
160427                                                                  16042700
160428 3085-COUNT-LBL-SEQ-NBRS.                                         16042800
160429      MOVE ZEROES             TO PV-LABEL-SEQ-COUNT.              16042900
160431                                                                  16043100
160432        EXEC SQL                                                  16043200
160433          SELECT  COUNT(*)                                        16043300
160434            INTO :PV-LABEL-SEQ-COUNT                              16043400
160435            FROM  TCNDCDR                                         16043500
160436           WHERE  OPER_UNT_ID      = :DK-OPER-UNT-ID              16043600
160437             AND  DOOR_LBL_SEQ_NBR = :PV-INP-LABEL-SEQ            16043700
160438        END-EXEC                                                  16043800
160439                                                                  16043900
160440        EVALUATE TRUE                                             16044000
160441            WHEN SQLCODE = +0                                     16044100
160442              IF PV-LABEL-SEQ-COUNT > 1                           16044200
160443                 SET PS-LBL-SEQ-OPER-EXISTS-YES TO TRUE           16044300
160444              ELSE                                                16044400
160445                 SET PS-LBL-SEQ-OPER-EXISTS-NO  TO TRUE           16044500
160446              END-IF                                              16044600
160447            WHEN SQLWARN0 NOT = SPACES                            16044700
160448            WHEN SQLCODE < +0                                     16044800
160449            WHEN SQLCODE > +0                                     16044900
160450                MOVE '3085-COUNT-LBL-SEQ-NBRS'                    16045000
160451                                          TO DP013-PARAGRAPH      16045100
160452                MOVE 'PROBLEM WITH RETRIEVING ROW'                16045200
160453                                    TO DP013-MESSAGE-TEXT (1)     16045300
160454                MOVE SQLCA      TO DP013-SQLCA                    16045400
160455                MOVE 'TCNDCDR'  TO DP013-DB2-TABLE-NAME (1)       16045500
160456                SET DP013-DB2-ABEND                               16045600
160457                    DP013-XCTL-DISPLAY-RESTART TO TRUE            16045700
160458                PERFORM DP013-0000-PROCESS-ABEND                  16045800
160459        END-EVALUATE.                                             16045900
160460                                                                  16046000
160470*----------------------------------------------------------------*16047000
160500* MOVE THE DEFAULT ATTRIBUTE VALUES TO THE ENTERABLE FIELDS ON   *16050000
160600* MAP.                                                           *16060000
160700*----------------------------------------------------------------*16070000
160800 3200-RESET-ATTRIBUTES.                                           16080000
160900     IF PS-NO-ERROR                                               16090000
161000         IF ASC-FUNCTION = PC-U                                   16100000
161100             IF  ASC-DVRT-LANE-REQ-YES                            16110000
161200                 MOVE DP015-UNP-ALP-NOR-OFF    TO ALANEASGA       16120000
161300                                                  ADIVLOCA        16130000
161400                 MOVE DP015-GREEN              TO ALANEASGC       16140000
161500                                                  ADIVLOCC        16150000
161600                 MOVE DP015-UNDERLINE          TO ALANEASGH       16160000
161700                                                  ADIVLOCH        16170000
161800             ELSE                                                 16180000
161900                 MOVE DP015-PRO-NOR-OFF        TO ALANEASGA       16190000
162000                                                  ADIVLOCA        16200000
162100                 MOVE DP015-BLUE               TO ALANEASGC       16210000
162200                                                  ADIVLOCC        16220000
162300                 MOVE DP015-HL-OFF             TO ALANEASGH       16230000
162400                                                  ADIVLOCH        16240000
162500             END-IF                                               16250000
162600             MOVE DP015-PRO-NOR-OFF        TO ADOORIDA            16260000
162700             MOVE DP015-BLUE               TO ADOORIDC            16270000
162800             MOVE DP015-HL-OFF             TO ADOORIDH            16280000
162900             SET DP030-SET-CURSOR-APPL-1   TO TRUE                16290000
163000             MOVE -1                       TO ADRTYPCL            16300000
163100         ELSE                                                     16310000
163200             MOVE DP015-UNP-ALP-NOR-OFF    TO ADOORIDA            16320000
163300                                              ALANEASGA           16330000
163400                                              ADIVLOCA            16340000
163500             MOVE DP015-GREEN              TO ADOORIDC            16350000
163600                                              ALANEASGC           16360000
163700                                              ADIVLOCC            16370000
163800             MOVE DP015-UNDERLINE          TO ADOORIDH            16380000
163900                                              ALANEASGH           16390000
164000                                              ADIVLOCH            16400000
164100             SET DP030-SET-CURSOR-APPL-1   TO TRUE                16410000
164200             MOVE -1                       TO ADOORIDL            16420000
164300         END-IF                                                   16430000
164400         MOVE DP015-UNP-ALP-NOR-OFF    TO ADRTYPCA                16440000
164500                                          ALOCDSCA                16450000
164600                                          ALBLNBRA                16460000
164700         MOVE DP015-GREEN              TO ADRTYPCC                16470000
164800                                          ALOCDSCC                16480000
164900                                          ALBLNBRC                16490000
165000         MOVE DP015-UNDERLINE          TO ADRTYPCH                16500000
165100                                          ALOCDSCH                16510000
165200                                          ALBLNBRH                16520000
165300     END-IF.                                                      16530000
165400                                                                  16540000
165500*----------------------------------------------------------------*16550000
165600*    VALIDATE THE QUEUE WAS PASSED AND DISPLAY FOR THE FIRST     *16560000
165700*    ENTRY.                                                      *16570000
165800*----------------------------------------------------------------*16580000
165900 4000-BUILD-INITIAL-PANEL.                                        16590000
166000     IF ASC-FUNCTION = PC-U                                       16600000
166100         MOVE DP015-PRO-NOR-OFF       TO ADOORIDA                 16610000
166200                                         ALANEASGA                16620000
166300                                         ADIVLOCA                 16630000
166400         MOVE DP015-BLUE              TO ADOORIDC                 16640000
166500                                         ALANEASGC                16650000
166600                                         ADIVLOCC                 16660000
166700         MOVE DP015-HL-OFF            TO ADOORIDH                 16670000
166800                                         ALANEASGH                16680000
166900                                         ADIVLOCH                 16690000
167000         MOVE -1                      TO ADRTYPCL                 16700000
167100         SET DP030-SET-CURSOR-APPL-1  TO TRUE                     16710000
167200     ELSE                                                         16720000
167300         IF ASC-DOOR-ID  = SPACES                                 16730000
167400             SET DP030-SET-CURSOR-APPL-1  TO TRUE                 16740000
167500             MOVE -1                      TO ADOORIDL             16750000
167600         ELSE                                                     16760000
167700             IF ASC-DOOR-TYPE-CODE  = SPACES                      16770000
167800                 SET DP030-SET-CURSOR-APPL-1  TO TRUE             16780000
167900                 MOVE -1                      TO ADRTYPCL         16790000
168000             ELSE                                                 16800000
168100                 SET DP030-SET-CURSOR-APPL-1  TO TRUE             16810000
168200                 MOVE -1                      TO ALOCDSCL         16820000
168300             END-IF                                               16830000
168400         END-IF                                                   16840000
168500     END-IF.                                                      16850000
168600                                                                  16860000
168601                                                                  16860100
168602*----------------------------------------------------------------*16860200
168603* CHECK TO SEE IF DOOR TYPE CHANGED                               16860300
168604*----------------------------------------------------------------*16860400
168610 4005-CK-TYPE-CHANGED.                                            16861000
168611     MOVE ASC-OPER-UNT-ID    TO DK-OPER-UNT-ID.                   16861100
168612     MOVE ASC-DOOR-ID        TO DK-DOOR-ID.                       16861200
168613                                                                  16861300
168614     EXEC SQL                                                     16861400
168615         SELECT DOOR_TYP_CDE                                      16861500
168616          INTO :CNDCDR-DOOR-TYP-CDE                               16861600
168617          FROM  TCNDCDR                                           16861700
168619         WHERE OPER_UNT_ID  = :DK-OPER-UNT-ID                     16861900
168620           AND DOOR_ID      = :DK-DOOR-ID                         16862000
168624     END-EXEC.                                                    16862400
168625                                                                  16862500
168626     EVALUATE TRUE                                                16862600
168627         WHEN SQLCODE = ZERO                                      16862700
168628              IF  CNDCDR-DOOR-TYP-CDE  =  ASC-DOOR-TYPE-CODE      16862800
168629                  SET  PS-TYPE-CHANGED-NO  TO  TRUE               16862900
168630              ELSE                                                16863000
168631                  SET  PS-TYPE-CHANGED-YES TO  TRUE               16863100
168632               END-IF                                             16863200
168639         WHEN SQLWARN0 NOT = SPACES                               16863900
168640         WHEN SQLCODE < +0                                        16864000
168641         WHEN SQLCODE > +0                                        16864100
168642             MOVE '4005-CK-TYPE-CHANGED      ' TO DP013-PARAGRAPH 16864200
168643             MOVE 'CHECK IF DOOR TYPE WAS CHANGED'                16864300
168644                                      TO DP013-MESSAGE-TEXT (1)   16864400
168645             MOVE SQLCA        TO DP013-SQLCA                     16864500
168646             MOVE 'TCNDCDR '   TO DP013-DB2-TABLE-NAME (1)        16864600
168648             SET DP013-DB2-ABEND                                  16864800
168649                 DP013-XCTL-DISPLAY-RESTART TO TRUE               16864900
168650             PERFORM DP013-0000-PROCESS-ABEND                     16865000
168651         END-EVALUATE.                                            16865100
168654                                                                  16865400
168660                                                                  16866000
168700*----------------------------------------------------------------*16870000
168800* VALIDATE DOOR TYPE SH (SHIPPING)                                16880000
168900*----------------------------------------------------------------*16890000
169000 4010-VALIDATE-DOOR-TYPE-SH.                                      16900000
169100     MOVE ASC-OPER-UNT-ID    TO DK-OPER-UNT-ID.                   16910000
169200     MOVE ASC-DOOR-ID        TO DK-DOOR-ID.                       16920000
169300                                                                  16930000
169400     EXEC SQL                                                     16940000
169500         SELECT COUNT(*)                                          16950000
169600          INTO :ASC-COUNT                                         16960000
169700         FROM  TCNDRST A                                          16970000
169800              ,XLT_LOC B                                          16980000
169900        WHERE A.OPER_UNT_ID  = :DK-OPER-UNT-ID                    16990000
170000          AND A.DOOR_ID      = :DK-DOOR-ID                        17000000
170100          AND A.END_TMST     = :PC-DEFAULT-TIMESTAMP              17010000
170200          AND A.STR_NBR      = B.LOC_NBR                          17020000
170300          AND B.LOC_TYP_CDE  <> :PC-DS                            17030000
170400     END-EXEC                                                     17040000
170500                                                                  17050000
170600     EVALUATE TRUE                                                17060000
170700         WHEN SQLCODE = ZERO                                      17070000
170800             IF ASC-COUNT > +0                                    17080000
170900                 SET PS-ERROR                                     17090000
171000                     DP020-MSG-FATAL       TO TRUE                17100000
171100               MOVE PC-TSYMSG-02577        TO DP020-MSG-NUMBER    17110000
171200               MOVE DP015-UNP-ALP-BRT-OFF  TO ADRTYPCA            17120000
171300               MOVE DP015-RED              TO ADRTYPCC            17130000
171400               MOVE DP015-REVERSE          TO ADRTYPCH            17140000
171500               MOVE -1                     TO ADRTYPCL            17150000
171600               SET DP030-SET-CURSOR-APPL-1 TO TRUE                17160000
171700             END-IF                                               17170000
171800         WHEN SQLWARN0 NOT = SPACES                               17180000
171900         WHEN SQLCODE < +0                                        17190000
172000         WHEN SQLCODE > +0                                        17200000
172100             MOVE '4010-VALIDATE-DOOR-TYPE-SH' TO DP013-PARAGRAPH 17210000
172200             MOVE 'TROUBLE VALIDATING DOOR TYPE'                  17220000
172300                                      TO DP013-MESSAGE-TEXT (1)   17230000
172400             MOVE SQLCA        TO DP013-SQLCA                     17240000
172500             MOVE 'TCNDRST '   TO DP013-DB2-TABLE-NAME (1)        17250000
172510             MOVE 'XLT_LOC '   TO DP013-DB2-TABLE-NAME (2)        17251000
172600             SET DP013-DB2-ABEND                                  17260000
172700                 DP013-XCTL-DISPLAY-RESTART TO TRUE               17270000
172800             PERFORM DP013-0000-PROCESS-ABEND                     17280000
172900         END-EVALUATE.                                            17290000
173000                                                                  17300000
173010                                                                  17301000
173020*----------------------------------------------------------------*17302000
173030* VALIDATE DOOR TYPE SH (SHIPPING)                                17303000
173040*----------------------------------------------------------------*17304000
173050 4010-VALIDATE-DOOR-TYPE-SH-NEW.                                  17305000
173060     MOVE ASC-OPER-UNT-ID    TO DK-OPER-UNT-ID.                   17306000
173070     MOVE ASC-DOOR-ID        TO DK-DOOR-ID.                       17307000
173080                                                                  17308000
173090     EXEC SQL                                                     17309000
173091         SELECT COUNT(*)                                          17309100
173092          INTO :ASC-COUNT                                         17309200
173093         FROM  TCNDRST A                                          17309300
173094              ,XLT_LOC B                                          17309400
173095        WHERE A.OPER_UNT_ID  = :DK-OPER-UNT-ID                    17309500
173096          AND A.DOOR_ID      = :DK-DOOR-ID                        17309600
173097          AND A.END_TMST     = :PC-DEFAULT-TIMESTAMP              17309700
173098          AND A.STR_NBR      = B.LOC_NBR                          17309800
173099          AND B.LOC_TYP_CDE  <> :PC-DS                            17309900
173100     END-EXEC                                                     17310000
173101                                                                  17310100
173102     EVALUATE TRUE                                                17310200
173103         WHEN SQLCODE = ZERO                                      17310300
173104             IF ASC-COUNT > +0                                    17310400
173105                 SET PS-ERROR                                     17310500
173106                     DP020-MSG-FATAL       TO TRUE                17310600
173107               MOVE PC-TSYMSG-02577        TO DP020-MSG-NUMBER    17310700
173108               MOVE DP015-UNP-ALP-BRT-OFF  TO ADRTYPCA            17310800
173109               MOVE DP015-RED              TO ADRTYPCC            17310900
173110               MOVE DP015-REVERSE          TO ADRTYPCH            17311000
173111               MOVE -1                     TO ADRTYPCL            17311100
173112               SET DP030-SET-CURSOR-APPL-1 TO TRUE                17311200
173113             END-IF                                               17311300
173114         WHEN SQLWARN0 NOT = SPACES                               17311400
173115         WHEN SQLCODE < +0                                        17311500
173116         WHEN SQLCODE > +0                                        17311600
173117             MOVE '4010-VALIDATE-DOOR-TYPE-SH' TO DP013-PARAGRAPH 17311700
173118             MOVE 'TROUBLE VALIDATING DOOR TYPE'                  17311800
173119                                      TO DP013-MESSAGE-TEXT (1)   17311900
173120             MOVE SQLCA        TO DP013-SQLCA                     17312000
173121             MOVE 'TCNDRST '   TO DP013-DB2-TABLE-NAME (1)        17312100
173122             MOVE 'XLT_LOC '   TO DP013-DB2-TABLE-NAME (2)        17312200
173123             SET DP013-DB2-ABEND                                  17312300
173124                 DP013-XCTL-DISPLAY-RESTART TO TRUE               17312400
173125             PERFORM DP013-0000-PROCESS-ABEND                     17312500
173126         END-EVALUATE.                                            17312600
173127                                                                  17312700
173130*----------------------------------------------------------------*17313000
173200* VALIDATE DOOR TYPE DS (DC SHUTTLE)                              17320000
173300*----------------------------------------------------------------*17330000
173400 4020-VALIDATE-DOOR-TYPE-DS.                                      17340000
173500     MOVE ASC-OPER-UNT-ID    TO DK-OPER-UNT-ID                    17350000
173600     MOVE ASC-DOOR-ID        TO DK-DOOR-ID                        17360000
173700                                                                  17370000
173800     EXEC SQL                                                     17380000
173900         SELECT COUNT(*)                                          17390000
174000          INTO :ASC-COUNT                                         17400000
174100         FROM  TCNDRST A                                          17410000
174200              ,XLT_LOC B                                          17420000
174300        WHERE A.OPER_UNT_ID  = :DK-OPER-UNT-ID                    17430000
174400          AND A.DOOR_ID      = :DK-DOOR-ID                        17440000
174500          AND A.END_TMST     = :PC-DEFAULT-TIMESTAMP              17450000
174600          AND A.STR_NBR      = B.LOC_NBR                          17460000
174700          AND B.LOC_TYP_CDE  <> :PC-DC                            17470000
174800     END-EXEC                                                     17480000
174900                                                                  17490000
175000     EVALUATE TRUE                                                17500000
175100         WHEN SQLCODE = ZERO                                      17510000
175200            IF ASC-COUNT > +0                                     17520000
175300                 SET PS-ERROR                                     17530000
175400                     DP020-MSG-FATAL       TO TRUE                17540000
175500               MOVE PC-TSYMSG-02578        TO DP020-MSG-NUMBER    17550000
175600               MOVE DP015-UNP-ALP-BRT-OFF  TO ADRTYPCA            17560000
175700               MOVE DP015-RED              TO ADRTYPCC            17570000
175800               MOVE DP015-REVERSE          TO ADRTYPCH            17580000
175900               MOVE -1                     TO ADRTYPCL            17590000
176000               SET DP030-SET-CURSOR-APPL-1 TO TRUE                17600000
176100             END-IF                                               17610000
176200         WHEN SQLWARN0 NOT = SPACES                               17620000
176300         WHEN SQLCODE < +0                                        17630000
176400         WHEN SQLCODE > +0                                        17640000
176500             MOVE '4020-VALIDATE-DOOR-TYPE-DS'                    17650000
176600                                               TO DP013-PARAGRAPH 17660000
176700             MOVE 'TROUBLE VALIDATING DOOR TYPE'                  17670000
176800                                       TO DP013-MESSAGE-TEXT (1)  17680000
176900             MOVE SQLCA        TO DP013-SQLCA                     17690000
177000             MOVE 'TCNDRST '   TO DP013-DB2-TABLE-NAME (1)        17700000
177010             MOVE 'XLT_LOC '   TO DP013-DB2-TABLE-NAME (2)        17701000
177100             SET DP013-DB2-ABEND                                  17710000
177200                 DP013-XCTL-DISPLAY-RESTART TO TRUE               17720000
177300             PERFORM DP013-0000-PROCESS-ABEND                     17730000
177400         END-EVALUATE.                                            17740000
177410                                                                  17741000
177420*----------------------------------------------------------------*17742000
177430* VALIDATE DOOR TYPE DS (DC SHUTTLE)                              17743000
177440*----------------------------------------------------------------*17744000
177450 4020-VALIDATE-DOOR-TYPE-DS-NEW.                                  17745000
177460     MOVE ASC-OPER-UNT-ID    TO DK-OPER-UNT-ID                    17746000
177470     MOVE ASC-DOOR-ID        TO DK-DOOR-ID                        17747000
177480                                                                  17748000
177490     EXEC SQL                                                     17749000
177491         SELECT COUNT(*)                                          17749100
177492          INTO :ASC-COUNT                                         17749200
177493         FROM  TCNDRST A                                          17749300
177494              ,XLT_LOC B                                          17749400
177495        WHERE A.OPER_UNT_ID  = :DK-OPER-UNT-ID                    17749500
177496          AND A.DOOR_ID      = :DK-DOOR-ID                        17749600
177497          AND A.END_TMST     = :PC-DEFAULT-TIMESTAMP              17749700
177498          AND A.STR_NBR      = B.LOC_NBR                          17749800
177499          AND B.LOC_TYP_CDE  <> :PC-DC                            17749900
177500     END-EXEC                                                     17750000
177501                                                                  17750100
177502     EVALUATE TRUE                                                17750200
177503         WHEN SQLCODE = ZERO                                      17750300
177504            IF ASC-COUNT > +0                                     17750400
177505                 SET PS-ERROR                                     17750500
177506                     DP020-MSG-FATAL       TO TRUE                17750600
177507               MOVE PC-TSYMSG-02578        TO DP020-MSG-NUMBER    17750700
177508               MOVE DP015-UNP-ALP-BRT-OFF  TO ADRTYPCA            17750800
177509               MOVE DP015-RED              TO ADRTYPCC            17750900
177510               MOVE DP015-REVERSE          TO ADRTYPCH            17751000
177511               MOVE -1                     TO ADRTYPCL            17751100
177512               SET DP030-SET-CURSOR-APPL-1 TO TRUE                17751200
177513             END-IF                                               17751300
177514         WHEN SQLWARN0 NOT = SPACES                               17751400
177515         WHEN SQLCODE < +0                                        17751500
177516         WHEN SQLCODE > +0                                        17751600
177517             MOVE '4020-VALIDATE-DOOR-TYPE-DS'                    17751700
177518                                               TO DP013-PARAGRAPH 17751800
177519             MOVE 'TROUBLE VALIDATING DOOR TYPE'                  17751900
177520                                       TO DP013-MESSAGE-TEXT (1)  17752000
177521             MOVE SQLCA        TO DP013-SQLCA                     17752100
177522             MOVE 'TCNDRST '   TO DP013-DB2-TABLE-NAME (1)        17752200
177523             MOVE 'XLT_LOC '   TO DP013-DB2-TABLE-NAME (2)        17752300
177524             SET DP013-DB2-ABEND                                  17752400
177525                 DP013-XCTL-DISPLAY-RESTART TO TRUE               17752500
177526             PERFORM DP013-0000-PROCESS-ABEND                     17752600
177527         END-EVALUATE.                                            17752700
177530                                                                  17753000
177600*----------------------------------------------------------------*17760000
177700*    VALIDATE OTHER DOOR TYPES                                    17770000
177800*----------------------------------------------------------------*17780000
177900 4030-VALIDATE-OTHER-DOOR-TYPES.                                  17790000
178000     MOVE ASC-OPER-UNT-ID    TO DK-OPER-UNT-ID.                   17800000
178100     MOVE ASC-DOOR-ID        TO DK-DOOR-ID.                       17810000
178200                                                                  17820000
178300     EXEC SQL                                                     17830000
178400         SELECT COUNT(*)                                          17840000
178500         INTO  :ASC-COUNT                                         17850000
178600         FROM  TCNDRST                                            17860000
178700        WHERE OPER_UNT_ID  = :DK-OPER-UNT-ID                      17870000
178800          AND DOOR_ID      = :DK-DOOR-ID                          17880000
178900          AND END_TMST     = :PC-DEFAULT-TIMESTAMP                17890000
179000     END-EXEC                                                     17900000
179100                                                                  17910000
179200     EVALUATE TRUE                                                17920000
179300         WHEN SQLCODE = ZERO                                      17930000
179400             IF ASC-COUNT > +0                                    17940000
179500                 SET PS-ERROR                                     17950000
179600                     DP020-MSG-FATAL       TO TRUE                17960000
179700               MOVE PC-TSYMSG-02579        TO DP020-MSG-NUMBER    17970000
179800               MOVE DP015-PRO-NOR-OFF      TO ADRTYPCA            17980000
179900               MOVE DP015-RED              TO ADRTYPCC            17990000
180000               MOVE DP015-REVERSE          TO ADRTYPCH            18000000
180100               MOVE -1                     TO ADRTYPCL            18010000
180200               SET DP030-SET-CURSOR-APPL-1 TO TRUE                18020000
180300             END-IF                                               18030000
180400         WHEN SQLWARN0 NOT = SPACES                               18040000
180500         WHEN SQLCODE < +0                                        18050000
180600         WHEN SQLCODE > +0                                        18060000
180700             MOVE '4030-VALIDATE-OTHER-DOOR-TYPES'                18070000
180800                                               TO DP013-PARAGRAPH 18080000
180900             MOVE 'TROUBLE VALIDATING DOOR TYPE'                  18090000
181000                                        TO DP013-MESSAGE-TEXT (1) 18100000
181100             MOVE SQLCA        TO DP013-SQLCA                     18110000
181200             MOVE 'TCNDRST '   TO DP013-DB2-TABLE-NAME (1)        18120000
181300             SET DP013-DB2-ABEND                                  18130000
181400                 DP013-XCTL-DISPLAY-RESTART TO TRUE               18140000
181500             PERFORM DP013-0000-PROCESS-ABEND                     18150000
181600     END-EVALUATE.                                                18160000
181700                                                                  18170000
181800*----------------------------------------------------------------*18180000
181900* CHECK FOR STORE ASSIGNMENTS                                     18190000
182000*----------------------------------------------------------------*18200000
182100 4100-CHECK-4-STORE-ASGNMT.                                       18210000
182200     INITIALIZE ASC-COUNT.                                        18220000
182300     MOVE ASC-OPER-UNT-ID     TO   DK-OPER-UNT-ID.                18230000
182400     MOVE ASC-DOOR-ID         TO   DK-DOOR-ID.                    18240000
182500                                                                  18250000
182600     EXEC SQL                                                     18260000
182700         SELECT COUNT(*)                                          18270000
182800          INTO :ASC-COUNT                                         18280000
182900         FROM  TCNDRST                                            18290000
183000        WHERE OPER_UNT_ID  = :DK-OPER-UNT-ID                      18300000
183100          AND DOOR_ID      = :DK-DOOR-ID                          18310000
183200          AND END_TMST     = :PC-DEFAULT-TIMESTAMP                18320000
183300     END-EXEC                                                     18330000
183400                                                                  18340000
183500     EVALUATE TRUE                                                18350000
183600         WHEN SQLCODE = ZERO                                      18360000
183700             IF ASC-COUNT > +0                                    18370000
183800                 SET PS-STORES-EXIST     TO TRUE                  18380000
183900             END-IF                                               18390000
184000         WHEN SQLCODE = +100                                      18400000
184100                 SET PS-NO-STORES-EXIST  TO TRUE                  18410000
184200         WHEN SQLWARN0 NOT = SPACES                               18420000
184300         WHEN SQLCODE < +0                                        18430000
184400         WHEN SQLCODE > +0                                        18440000
184500             MOVE '4100-CHECK-4-STORE-ASGNMT' TO DP013-PARAGRAPH  18450000
184600             MOVE 'TROUBLE COUNTING STORES'                       18460000
184700                                      TO DP013-MESSAGE-TEXT (1)   18470000
184800             MOVE SQLCA        TO DP013-SQLCA                     18480000
184900             MOVE 'TCNDRST '   TO DP013-DB2-TABLE-NAME (1)        18490000
185000             SET DP013-DB2-ABEND                                  18500000
185100                 DP013-XCTL-DISPLAY-RESTART TO TRUE               18510000
185200             PERFORM DP013-0000-PROCESS-ABEND                     18520000
185300         END-EVALUATE.                                            18530000
185400                                                                  18540000
185500*----------------------------------------------------------------*18550000
185600* CHECK FOR DUPLICATE DIVERT CODES ON MULTIPLE DOORS             *18560000
185700*----------------------------------------------------------------*18570000
185800 4200-CHECK-4-DUP-DIVERT.                                         18580000
185900      PERFORM 4210-OPEN-DIVERT-CURSOR.                            18590000
186000      PERFORM 4220-READ-ITEMS-FROM-DB.                            18600000
186100      PERFORM 4230-CLOSE-DIVERT-CURSOR.                           18610000
186200                                                                  18620000
186300*----------------------------------------------------------------*18630000
186400* OPEN THE DIVERT CURSOR.                                        *18640000
186500*----------------------------------------------------------------*18650000
186600 4210-OPEN-DIVERT-CURSOR.                                         18660000
186700     MOVE ASC-OPER-UNT-ID    TO DK-OPER-UNT-ID.                   18670000
186800     MOVE ASC-DOOR-ID        TO DK-DOOR-ID.                       18680000
186900     MOVE ASC-LANE-ASGNMT    TO DK-DIVERT-NBR.                    18690000
187000     MOVE ASC-DIVERT-LOC     TO DK-DIVERT-LOC.                    18700000
187100                                                                  18710000
187200     PERFORM                                                      18720000
187300         WITH TEST AFTER VARYING PV-RETRY-COUNTER                 18730000
187400         FROM 1 BY 1                                              18740000
187500         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               18750000
187600                   OR (SQLCODE = ZERO))                           18760000
187700                                                                  18770000
187800          EXEC SQL                                                18780000
187900              OPEN SAME-DIVERT-CSR                                18790000
188000          END-EXEC                                                18800000
188100                                                                  18810000
188200         EVALUATE TRUE                                            18820000
188300             WHEN SQLCODE = ZERO                                  18830000
188400             WHEN SQLCODE = -904                                  18840000
188500             WHEN SQLCODE = -913                                  18850000
188600                 CONTINUE                                         18860000
188700             WHEN SQLWARN0 NOT = SPACES                           18870000
188800             WHEN SQLCODE < ZERO                                  18880000
188900             WHEN SQLCODE > ZERO                                  18890000
189000                MOVE '4210-OPEN-DIVERT-CURSOR' TO DP013-PARAGRAPH 18900000
189100                MOVE 'UNABLE TO OPEN DIVERT CURSOR -'             18910000
189200                                        TO DP013-MESSAGE-TEXT (1) 18920000
189300                MOVE SQLCA        TO DP013-SQLCA                  18930000
189400                MOVE 'TCNDCDR '   TO DP013-DB2-TABLE-NAME (1)     18940000
189500                SET DP013-DB2-ABEND                               18950000
189600                     DP013-XCTL-DISPLAY-RESTART TO TRUE           18960000
189700                PERFORM DP013-0000-PROCESS-ABEND                  18970000
189800         END-EVALUATE                                             18980000
189900     END-PERFORM.                                                 18990000
190000                                                                  19000000
190100     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        19010000
190200          MOVE '4210-OPEN-DIVERT-CURSOR'   TO DP013-PARAGRAPH     19020000
190300          MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR'  19030000
190400                                   TO DP013-MESSAGE-TEXT (1)      19040000
190500         MOVE SQLCA                TO DP013-SQLCA                 19050000
190600         MOVE 'TCNDCDR '           TO DP013-DB2-TABLE-NAME (1)    19060000
190700         SET DP013-DB2-ABEND                                      19070000
190800             DP013-XCTL-DISPLAY-RESTART TO TRUE                   19080000
190900         PERFORM DP013-0000-PROCESS-ABEND                         19090000
191000     END-IF.                                                      19100000
191100                                                                  19110000
191200*----------------------------------------------------------------*19120000
191300*    READ ITEMS FROM DB                                           19130000
191400*----------------------------------------------------------------*19140000
191500 4220-READ-ITEMS-FROM-DB.                                         19150000
191600     SET ASC-ITEMS-LEFT-ON-DB TO TRUE.                            19160000
191700     PERFORM                                                      19170000
191800         VARYING PV-READ-COUNT FROM 1 BY 1                        19180000
191900         UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                    19190000
192000            OR (ASC-NO-ITEMS-LEFT-ON-DB))                         19200000
192100                                                                  19210000
192200            PERFORM 4225-FETCH-DIVERT-CSR                         19220000
192300                                                                  19230000
192400     END-PERFORM.                                                 19240000
192500                                                                  19250000
192600*----------------------------------------------------------------*19260000
192700*    FETCH THE DIVERT CURSOR                                      19270000
192800*----------------------------------------------------------------*19280000
192900 4225-FETCH-DIVERT-CSR.                                           19290000
193000       EXEC SQL                                                   19300000
193100            FETCH SAME-DIVERT-CSR                                 19310000
193200            INTO  :CNDCDR-OPER-UNT-ID                             19320000
193300                , :CNDCDR-DOOR-ID                                 19330000
193400                , :CNDCDR-DIVERT-NBR                              19340000
193500                , :CNDCDR-DIVERT-LOC-ID                           19350000
193600       END-EXEC                                                   19360000
193700                                                                  19370000
193800     EVALUATE TRUE                                                19380000
193900         WHEN SQLCODE = ZERO                                      19390000
194000              SET PS-DUP-DIVERT-EXIST TO TRUE                     19400000
194100              PERFORM 4300-CHECK-4-DUP-STORES                     19410000
194200         WHEN SQLCODE = +100                                      19420000
194300              SET ASC-NO-ITEMS-LEFT-ON-DB TO TRUE                 19430000
194400         WHEN SQLWARN0 NOT = SPACE                                19440000
194500         WHEN SQLCODE NOT = ZERO                                  19450000
194600              MOVE '4225-FETCH-DIVERT-CSR' TO DP013-PARAGRAPH     19460000
194700              MOVE 'COULD NOT FETCH DIVERT CURSOR'                19470000
194800                                        TO DP013-MESSAGE-TEXT (1) 19480000
194900              MOVE SQLCA          TO DP013-SQLCA                  19490000
195000              SET DP013-DB2-ABEND TO TRUE                         19500000
195100              PERFORM DP013-0000-PROCESS-ABEND                    19510000
195200     END-EVALUATE.                                                19520000
195300                                                                  19530000
195400*----------------------------------------------------------------*19540000
195500* CLOSE THE DIVERT CURSOR.                                       *19550000
195600*----------------------------------------------------------------*19560000
195700 4230-CLOSE-DIVERT-CURSOR.                                        19570000
195800      EXEC SQL                                                    19580000
195900           CLOSE SAME-DIVERT-CSR                                  19590000
196000      END-EXEC                                                    19600000
196100                                                                  19610000
196200     EVALUATE TRUE                                                19620000
196300         WHEN SQLCODE = ZERO                                      19630000
196400             CONTINUE                                             19640000
196500         WHEN SQLWARN0 NOT = SPACES                               19650000
196600         WHEN SQLCODE < ZERO                                      19660000
196700         WHEN SQLCODE > ZERO                                      19670000
196800             MOVE '4230-CLOSE-DIVERT-CURSOR' TO DP013-PARAGRAPH   19680000
196900             MOVE 'UNABLE TO CLOSE CURSOR '                       19690000
197000                               TO DP013-MESSAGE-TEXT (1)          19700000
197100             MOVE SQLCA        TO DP013-SQLCA                     19710000
197200             MOVE 'TCNDCDR '   TO DP013-DB2-TABLE-NAME (1)        19720000
197300             SET DP013-DB2-ABEND                                  19730000
197400                 DP013-XCTL-DISPLAY-RESTART TO TRUE               19740000
197500             PERFORM DP013-0000-PROCESS-ABEND                     19750000
197600     END-EVALUATE.                                                19760000
197700                                                                  19770000
197800*----------------------------------------------------------------*19780000
197900* CHECK FOR DUPLICATE STORES ON MULTIPLE DOORS                    19790000
198000*----------------------------------------------------------------*19800000
198100 4300-CHECK-4-DUP-STORES.                                         19810000
198200      PERFORM 4310-OPEN-STORE-CURSOR.                             19820000
198300      PERFORM 4320-READ-ITEMS-FROM-DB.                            19830000
198400      PERFORM 4330-CLOSE-STORE-CURSOR.                            19840000
198500                                                                  19850000
198600*----------------------------------------------------------------*19860000
198700* OPEN THE STORE CURSOR.                                        * 19870000
198800*----------------------------------------------------------------*19880000
198900 4310-OPEN-STORE-CURSOR.                                          19890000
199000     MOVE ASC-OPER-UNT-ID    TO DK-OPER-UNT-ID.                   19900000
199100     MOVE CNDCDR-DOOR-ID     TO DK-DOOR-ID.                       19910000
199200                                                                  19920000
199300     PERFORM                                                      19930000
199400         WITH TEST AFTER VARYING PV-RETRY-COUNTER                 19940000
199500         FROM 1 BY 1                                              19950000
199600         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               19960000
199700                   OR (SQLCODE = ZERO))                           19970000
199800                                                                  19980000
199900          EXEC SQL                                                19990000
200000              OPEN SAME-STORE-CSR                                 20000000
200100          END-EXEC                                                20010000
200200                                                                  20020000
200300         EVALUATE TRUE                                            20030000
200400             WHEN SQLCODE = ZERO                                  20040000
200500             WHEN SQLCODE = -904                                  20050000
200600             WHEN SQLCODE = -913                                  20060000
200700                 CONTINUE                                         20070000
200800             WHEN SQLWARN0 NOT = SPACES                           20080000
200900             WHEN SQLCODE < ZERO                                  20090000
201000             WHEN SQLCODE > ZERO                                  20100000
201100                MOVE '4310-OPEN-STORE-CURSOR' TO DP013-PARAGRAPH  20110000
201200                MOVE 'UNABLE TO OPEN A CURSOR -'                  20120000
201300                                   TO DP013-MESSAGE-TEXT (1)      20130000
201400                MOVE SQLCA        TO DP013-SQLCA                  20140000
201500                MOVE 'TCNDRST '   TO DP013-DB2-TABLE-NAME (1)     20150000
201600                SET DP013-DB2-ABEND                               20160000
201700                     DP013-XCTL-DISPLAY-RESTART TO TRUE           20170000
201800                PERFORM DP013-0000-PROCESS-ABEND                  20180000
201900         END-EVALUATE                                             20190000
202000     END-PERFORM.                                                 20200000
202100                                                                  20210000
202200     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        20220000
202300          MOVE '4310-OPEN-STORE-CURSOR'   TO DP013-PARAGRAPH      20230000
202400          MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR'  20240000
202500                                   TO DP013-MESSAGE-TEXT (1)      20250000
202600         MOVE SQLCA                TO DP013-SQLCA                 20260000
202700         MOVE 'TCNDRST '           TO DP013-DB2-TABLE-NAME (1)    20270000
202800         SET DP013-DB2-ABEND                                      20280000
202900             DP013-XCTL-DISPLAY-RESTART TO TRUE                   20290000
203000         PERFORM DP013-0000-PROCESS-ABEND                         20300000
203100     END-IF.                                                      20310000
203200                                                                  20320000
203300*----------------------------------------------------------------*20330000
203400*    READ ITEMS FROM DB                                           20340000
203500*----------------------------------------------------------------*20350000
203600 4320-READ-ITEMS-FROM-DB.                                         20360000
203700     SET ASC-STORES-LEFT-ON-DB TO TRUE.                           20370000
203800     PERFORM                                                      20380000
203900         VARYING PV-READ-STORES-COUNT FROM 1 BY 1                 20390000
204000         UNTIL ((PV-READ-STORES-COUNT > PC-MAX-ITEMS)             20400000
204100            OR (ASC-NO-STORES-LEFT-ON-DB)                         20410000
204200            OR (PS-DUP-STORE-ASGNMT))                             20420000
204300                                                                  20430000
204400            PERFORM 4325-FETCH-STORE-CSR                          20440000
204500                                                                  20450000
204600     END-PERFORM.                                                 20460000
204700                                                                  20470000
204800*----------------------------------------------------------------*20480000
204900*    FETCH THE STORE CURSOR                                       20490000
205000*----------------------------------------------------------------*20500000
205100 4325-FETCH-STORE-CSR.                                            20510000
205200       EXEC SQL                                                   20520000
205300            FETCH SAME-STORE-CSR                                  20530000
205400            INTO  :CNDRST-OPER-UNT-ID                             20540000
205500                , :CNDRST-DOOR-ID                                 20550000
205600                , :CNDRST-STR-NBR                                 20560000
205700       END-EXEC                                                   20570000
205800                                                                  20580000
205900     EVALUATE TRUE                                                20590000
206000         WHEN SQLCODE = ZERO                                      20600000
206100              PERFORM 4340-SELECT-STORE-NBR                       20610000
206200         WHEN SQLCODE = +100                                      20620000
206300              SET ASC-NO-STORES-LEFT-ON-DB TO TRUE                20630000
206400         WHEN SQLWARN0 NOT = SPACE                                20640000
206500         WHEN SQLCODE NOT = ZERO                                  20650000
206600              MOVE '4325-FETCH-STORE-CSR ' TO DP013-PARAGRAPH     20660000
206700              MOVE 'COULD NOT FETCH STORE CURSOR'                 20670000
206800                                        TO DP013-MESSAGE-TEXT (1) 20680000
206900              MOVE SQLCA       TO DP013-SQLCA                     20690000
207000              SET DP013-DB2-ABEND TO TRUE                         20700000
207100              PERFORM DP013-0000-PROCESS-ABEND                    20710000
207200     END-EVALUATE.                                                20720000
207300                                                                  20730000
207400*----------------------------------------------------------------*20740000
207500* CLOSE THE STORE CURSOR.                                         20750000
207600*----------------------------------------------------------------*20760000
207700 4330-CLOSE-STORE-CURSOR.                                         20770000
207800      EXEC SQL                                                    20780000
207900           CLOSE SAME-STORE-CSR                                   20790000
208000      END-EXEC                                                    20800000
208100                                                                  20810000
208200     EVALUATE TRUE                                                20820000
208300         WHEN SQLCODE = ZERO                                      20830000
208400             CONTINUE                                             20840000
208500         WHEN SQLWARN0 NOT = SPACES                               20850000
208600         WHEN SQLCODE < ZERO                                      20860000
208700         WHEN SQLCODE > ZERO                                      20870000
208800             MOVE '4330-CLOSE-STORE-CURSOR' TO DP013-PARAGRAPH    20880000
208900             MOVE 'UNABLE TO CLOSE STORE CURSOR '                 20890000
209000                                       TO DP013-MESSAGE-TEXT (1)  20900000
209100             MOVE SQLCA        TO DP013-SQLCA                     20910000
209200             MOVE 'TCNDRST '   TO DP013-DB2-TABLE-NAME (1)        20920000
209300             SET DP013-DB2-ABEND                                  20930000
209400                 DP013-XCTL-DISPLAY-RESTART TO TRUE               20940000
209500             PERFORM DP013-0000-PROCESS-ABEND                     20950000
209600     END-EVALUATE.                                                20960000
209700                                                                  20970000
209800*----------------------------------------------------------------*20980000
209900* SELECT STORE NUMBER TO SEE IF A DUPLICATE EXISTS                20990000
210000*----------------------------------------------------------------*21000000
210100 4340-SELECT-STORE-NBR.                                           21010000
210200      MOVE ASC-OPER-UNT-ID   TO DK-OPER-UNT-ID.                   21020000
210300      MOVE ASC-DOOR-ID       TO DK-DOOR-ID.                       21030000
210400      MOVE CNDRST-STR-NBR    TO DK-STR-NBR.                       21040000
210500                                                                  21050000
210600      EXEC SQL                                                    21060000
210700           SELECT STR_NBR                                         21070000
210800           INTO   :CNDRST-STR-NBR                                 21080000
210900           FROM   TCNDRST                                         21090000
211000          WHERE   OPER_UNT_ID  = :DK-OPER-UNT-ID                  21100000
211100            AND   DOOR_ID      = :DK-DOOR-ID                      21110000
211200            AND   STR_NBR      = :DK-STR-NBR                      21120000
211300            AND   END_TMST     = :PC-DEFAULT-TIMESTAMP            21130000
211400      END-EXEC                                                    21140000
211500                                                                  21150000
211600     EVALUATE TRUE                                                21160000
211700         WHEN SQLCODE = ZERO                                      21170000
211800             MOVE PC-TSYMSG-02620        TO DP020-MSG-NUMBER      21180000
211900             SET PS-ERROR                                         21190000
212000                 DP020-MSG-FATAL                                  21200000
212100                 PS-DUP-STORE-ASGNMT     TO TRUE                  21210000
212200             MOVE DP015-RED              TO ALANEASGC             21220000
212300             MOVE DP015-REVERSE          TO ALANEASGH             21230000
212400             MOVE -1                     TO ALANEASGL             21240000
212500             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  21250000
212600         WHEN SQLCODE = +100                                      21260000
212700             CONTINUE                                             21270000
212800         WHEN SQLWARN0 NOT = SPACES                               21280000
212900         WHEN SQLCODE < ZERO                                      21290000
213000         WHEN SQLCODE > ZERO                                      21300000
213100             MOVE '4340-SELECT-STORE-NBR' TO DP013-PARAGRAPH      21310000
213200             MOVE 'UNABLE TO SELECT STORE NBR '                   21320000
213300                                       TO DP013-MESSAGE-TEXT (1)  21330000
213400             MOVE SQLCA        TO DP013-SQLCA                     21340000
213500             MOVE 'TCNDRST '   TO DP013-DB2-TABLE-NAME (1)        21350000
213600             SET DP013-DB2-ABEND                                  21360000
213700                 DP013-XCTL-DISPLAY-RESTART TO TRUE               21370000
213800             PERFORM DP013-0000-PROCESS-ABEND                     21380000
213900     END-EVALUATE.                                                21390000
214000                                                                  21400000
214100*----------------------------------------------------------------*21410000
214200*    RESTORE THE DATA ON THE SCREEN FROM THE COMM AREA.          *21420000
214300*----------------------------------------------------------------*21430000
214400 4400-MOVE-COMMAREA-TO-SCREEN.                                    21440000
214500     MOVE ASC-CURR-OPER-UNT-ID     TO ACPRUNTO.                   21450000
214600     MOVE ASC-CURR-FCLTY-NME       TO ACPRNMEO.                   21460000
214700     MOVE ASC-OPER-UNT-ID          TO AOPRUNTO.                   21470000
214800     MOVE ASC-FCLTY-NME            TO AOPRNMEO.                   21480000
214900     MOVE ASC-DOOR-ID              TO ADOORIDO.                   21490000
215000     MOVE ASC-DOOR-TYPE-CODE       TO ADRTYPCO.                   21500000
215100     MOVE ASC-DOOR-TYPE-DESC       TO ADRTYDSO.                   21510000
215200     MOVE ASC-LOC-DESC             TO ALOCDSCO.                   21520000
215300     MOVE ASC-LANE-ASGNMT-N        TO ALANEASGO.                  21530000
215400     MOVE ASC-DIVERT-LOC           TO ADIVLOCO.                   21540000
215500     MOVE ASC-LABEL-SEQ-N          TO ALBLNBRO.                   21550000
215600                                                                  21560000
215700*------------------------------------------------------------     21570000
215800*  MOVE COMMAREA TO TEMP AREA                                     21580000
215900*------------------------------------------------------------     21590000
216000 4500-MOVE-COMMAREA-TO-TEMP.                                      21600000
216100     MOVE ASC-DOOR-ID             TO PV-INP-DOOR-ID.              21610000
216200     MOVE ASC-CURR-OPER-UNT-ID    TO PV-INP-CURR-OPER-UNT-ID.     21620000
216300     MOVE ASC-CURR-FCLTY-NME      TO PV-INP-CURR-FCLTY-NME.       21630000
216400     MOVE ASC-OPER-UNT-ID         TO PV-INP-OPER-UNT-ID.          21640000
216500     MOVE ASC-FCLTY-NME           TO PV-INP-FCLTY-NME.            21650000
216600     MOVE ASC-DOOR-TYPE-CODE      TO PV-INP-DOOR-TYPE-CDE.        21660000
216700     MOVE ASC-DOOR-TYPE-DESC      TO PV-INP-DOOR-TYPE-DESC.       21670000
216800     MOVE ASC-LOC-DESC            TO PV-INP-LOC-DESC.             21680000
216900     MOVE ASC-LABEL-SEQ-N         TO PV-INP-LABEL-SEQ.            21690000
217000     MOVE ASC-LANE-ASGNMT-N       TO PV-INP-LANE-ASGNMT.          21700000
217100     MOVE ASC-DIVERT-LOC          TO PV-INP-DIVERT-LOC.           21710000
217200     MOVE ASC-STORE-ASGNMT        TO PV-INP-STORE-ASGNMT.         21720000
217300                                                                  21730000
217400*----------------------------------------------------------------*21740000
217500* PROCESS TABLE INSERTS                                          *21750000
217600*----------------------------------------------------------------*21760000
217700 5000-PROCESS-ADD.                                                21770000
217800     MOVE SPACES       TO  PV-DOOR-ID.                            21780000
217900     MOVE ASC-DOOR-ID  TO  PV-DOOR-ID.                            21790000
218000     IF (PV-DOOR-ID1 = SPACES OR ZEROES) AND                      21800000
218100        (PV-DOOR-ID2 = SPACES OR ZEROES) AND                      21810000
218200        (PV-DOOR-ID3 = SPACES OR ZEROES)                          21820000
218300           MOVE PV-DOOR-ID4   TO  PV-DOOR-ID1                     21830000
218400           MOVE SPACES        TO  PV-DOOR-ID2                     21840000
218500                                  PV-DOOR-ID3                     21850000
218600                                  PV-DOOR-ID4                     21860000
218700     END-IF.                                                      21870000
218800     IF (PV-DOOR-ID1 = SPACES OR ZEROES) AND                      21880000
218900        (PV-DOOR-ID2 = SPACES OR ZEROES)                          21890000
219000           MOVE PV-DOOR-ID3   TO  PV-DOOR-ID1                     21900000
219100           MOVE PV-DOOR-ID4   TO  PV-DOOR-ID2                     21910000
219200           MOVE SPACES        TO  PV-DOOR-ID3                     21920000
219300                                  PV-DOOR-ID4                     21930000
219400     END-IF.                                                      21940000
219500     IF PV-DOOR-ID1 = SPACES OR ZEROES                            21950000
219600         MOVE PV-DOOR-ID2   TO  PV-DOOR-ID1                       21960000
219700         MOVE PV-DOOR-ID3   TO  PV-DOOR-ID2                       21970000
219800         MOVE PV-DOOR-ID4   TO  PV-DOOR-ID3                       21980000
219900         MOVE SPACES        TO  PV-DOOR-ID4                       21990000
220000     END-IF.                                                      22000000
220100     IF PV-DOOR-ID2 = SPACES AND                                  22010000
220200        PV-DOOR-ID4 = SPACES                                      22020000
220300             MOVE PV-DOOR-ID3   TO  PV-DOOR-ID2                   22030000
220400             MOVE SPACES        TO  PV-DOOR-ID3                   22040000
220500                                    PV-DOOR-ID4                   22050000
220600     END-IF.                                                      22060000
220700     MOVE PV-DOOR-ID  TO  PV-INP-DOOR-ID.                         22070000
220800                                                                  22080000
220900     PERFORM 6100-INSERT-TCNDCDR                                  22090000
221000                                                                  22100000
221100     IF PS-NO-ERROR                                               22110000
221200         IF ASC-TCNDCDR-INSERTED                                  22120000
221300             MOVE PC-TSYMSG-00034  TO DP020-MSG-NUMBER            22130000
221400             SET DP020-MSG-INFORMATIONAL TO TRUE                  22140000
221500         END-IF                                                   22150000
221600     END-IF.                                                      22160000
221700                                                                  22170000
221800*----------------------------------------------------------------*22180000
221900* PROCESS TABLE UPDATES                                          *22190000
222000*----------------------------------------------------------------*22200000
222100 5100-PROCESS-UPDATE.                                             22210000
222200     PERFORM 7100-UPDATE-TCNDCDR                                  22220000
222300                                                                  22230000
222400     IF ASC-TCNDCDR-UPDATED                                       22240000
222410        SET ASC-F2-CONFIRM-NO       TO TRUE                       22241000
222500        MOVE PC-TSYMSG-00059 TO DP020-MSG-NUMBER                  22250000
222600        SET DP020-MSG-INFORMATIONAL TO TRUE                       22260000
222700        MOVE DP015-PRO-NOR-OFF       TO ADOORIDA                  22270000
222800                                        ALANEASGA                 22280000
222900                                        ADIVLOCA                  22290000
223000        MOVE DP015-BLUE              TO ADOORIDC                  22300000
223100                                        ALANEASGC                 22310000
223200                                        ADIVLOCC                  22320000
223300        MOVE DP015-HL-OFF            TO ADOORIDH                  22330000
223400                                        ALANEASGH                 22340000
223500                                        ADIVLOCH                  22350000
223600        MOVE -1                      TO ADRTYPCL                  22360000
223700        SET DP030-SET-CURSOR-APPL-1  TO TRUE                      22370000
223800     END-IF.                                                      22380000
223900                                                                  22390000
224000*----------------------------------------------------------------*22400000
224100* INSERT A ROW INTO THE CONTROL DC DOOR TABLE                    *22410000
224200*----------------------------------------------------------------*22420000
224300 6100-INSERT-TCNDCDR.                                             22430000
224400         EXEC SQL                                                 22440000
224500                 INSERT INTO TCNDCDR                              22450000
224600                 (                                                22460000
224700                  OPER_UNT_ID                                     22470000
224800                 ,DOOR_ID                                         22480000
224900                 ,DOOR_TYP_CDE                                    22490000
225000                 ,DOOR_LOC_DESC                                   22500000
225100                 ,DIVERT_NBR                                      22510000
225200                 ,DIVERT_LOC_ID                                   22520000
225300                 ,DOOR_LBL_SEQ_NBR                                22530000
225400                 )                                                22540000
225500                 VALUES                                           22550000
225600                 (                                                22560000
225700                  :PV-INP-OPER-UNT-ID                             22570000
225800                 ,:PV-INP-DOOR-ID                                 22580000
225900                 ,:PV-INP-DOOR-TYPE-CDE                           22590000
226000                 ,:PV-INP-LOC-DESC                                22600000
226100                 ,:PV-INP-LANE-ASGNMT                             22610000
226200                 ,:PV-INP-DIVERT-LOC                              22620000
226300                 ,:PV-INP-LABEL-SEQ                               22630000
226400                 )                                                22640000
226500         END-EXEC.                                                22650000
226600                                                                  22660000
226700         EVALUATE TRUE                                            22670000
226800             WHEN SQLCODE = +0                                    22680000
226900                 SET ASC-TCNDCDR-INSERTED TO TRUE                 22690000
227000                 MOVE PV-INP-DOOR-ID      TO ASC-DOOR-ID          22700000
227100             WHEN SQLCODE = -803                                  22710000
227200                 MOVE PV-INP-DOOR-ID          TO ADOORIDO         22720000
227300                 MOVE PC-TSYMSG-02643         TO DP020-MSG-NUMBER 22730000
227400                 SET DP020-MSG-FATAL                              22740000
227500                     PS-ERROR                 TO TRUE             22750000
227600                 MOVE DP015-RED               TO ADOORIDC         22760000
227700                 MOVE DP015-REVERSE           TO ADOORIDH         22770000
227800                 MOVE -1                      TO ADOORIDL         22780000
227900                 SET DP030-SET-CURSOR-APPL-1  TO TRUE             22790000
228000             WHEN SQLWARN0 NOT = SPACES                           22800000
228100             WHEN SQLCODE < +0                                    22810000
228200             WHEN SQLCODE > +0                                    22820000
228300                 MOVE '6100-INSERT-TCNDCDR' TO DP013-PARAGRAPH    22830000
228400                 MOVE 'ERROR INSERTING ROW TO TCNDCDR'            22840000
228500                                   TO DP013-MESSAGE-TEXT (1)      22850000
228600                 MOVE SQLCA        TO DP013-SQLCA                 22860000
228700                 MOVE 'TCNDCDR'    TO DP013-DB2-TABLE-NAME (1)    22870000
228800                 SET DP013-DB2-ABEND                              22880000
228900                     DP013-XCTL-DISPLAY-RESTART TO TRUE           22890000
229000                 PERFORM DP013-0000-PROCESS-ABEND                 22900000
229100         END-EVALUATE.                                            22910000
229200                                                                  22920000
229300******************************************************************22930000
229400** UPDATE A ROW ON THE CONTROL DC DOOR TABLE                      22940000
229500******************************************************************22950000
229600 7100-UPDATE-TCNDCDR.                                             22960000
229700     MOVE ASC-OPER-UNT-ID    TO DK-OPER-UNT-ID.                   22970000
229800     MOVE ASC-DOOR-ID        TO DK-DOOR-ID.                       22980000
229900                                                                  22990000
230000     PERFORM                                                      23000000
230100         WITH TEST AFTER                                          23010000
230200         VARYING PV-RETRY-COUNTER                                 23020000
230300         FROM 1 BY 1                                              23030000
230400         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               23040000
230500         OR     (SQLCODE = ZERO)                                  23050000
230600         OR     (SQLCODE = +100))                                 23060000
230700                                                                  23070000
230800         EXEC SQL                                                 23080000
230900             UPDATE TCNDCDR                                       23090000
231000               SET                                                23100000
231100                  DOOR_TYP_CDE       = :PV-INP-DOOR-TYPE-CDE      23110000
231200                 ,DOOR_LOC_DESC      = :PV-INP-LOC-DESC           23120000
231300                 ,DOOR_LBL_SEQ_NBR   = :PV-INP-LABEL-SEQ          23130000
231400                 ,DIVERT_NBR         = :PV-INP-LANE-ASGNMT        23140000
231500                 ,DIVERT_LOC_ID      = :PV-INP-DIVERT-LOC         23150000
231600            WHERE DOOR_ID            = :DK-DOOR-ID                23160000
231700              AND OPER_UNT_ID        = :DK-OPER-UNT-ID            23170000
231800         END-EXEC                                                 23180000
231900                                                                  23190000
232000         EVALUATE TRUE                                            23200000
232100             WHEN SQLCODE = +0                                    23210000
232200                 SET ASC-TCNDCDR-UPDATED TO TRUE                  23220000
232300             WHEN SQLWARN0 NOT = SPACES                           23230000
232400             WHEN SQLCODE < +0                                    23240000
232500             WHEN SQLCODE > +0                                    23250000
232600                 MOVE '7100-UPDATE-TCNDCDR' TO DP013-PARAGRAPH    23260000
232700                 MOVE 'ERROR UPDATING THE DC DOOR TABLE'          23270000
232800                                   TO DP013-MESSAGE-TEXT (1)      23280000
232900                 MOVE SQLCA        TO DP013-SQLCA                 23290000
233000                 MOVE 'TCNDCDR'    TO DP013-DB2-TABLE-NAME (1)    23300000
233100                 SET DP013-DB2-ABEND                              23310000
233200                     DP013-XCTL-DISPLAY-RESTART TO TRUE           23320000
233300                 PERFORM DP013-0000-PROCESS-ABEND                 23330000
233400         END-EVALUATE                                             23340000
233500     END-PERFORM.                                                 23350000
233600                                                                  23360000
233700     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         23370000
233800         MOVE '7100-UPDATE-TCNDCDR' TO DP013-PARAGRAPH            23380000
233900         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     23390000
234000                                       TO DP013-MESSAGE-TEXT (1)  23400000
234100         MOVE SQLCA          TO DP013-SQLCA                       23410000
234200         MOVE 'TCNDCDR'      TO DP013-DB2-TABLE-NAME (1)          23420000
234300         SET DP013-DB2-ABEND                                      23430000
234400             DP013-XCTL-DISPLAY-RESTART TO TRUE                   23440000
234500         PERFORM DP013-0000-PROCESS-ABEND                         23450000
234600     END-IF.                                                      23460000
234700     MOVE +0 TO PV-RETRY-COUNTER.                                 23470000
234800                                                                  23480000
234900*----------------------------------------------------------------*23490000
235000* READ AN ITEM FROM THE SELECTED ITEMS TEMP STORAGE QUEUE.       *23500000
235100*----------------------------------------------------------------*23510000
235200 9100-READ-SEL-QUEUE.                                             23520000
235300     EXEC CICS                                                    23530000
235400         READQ TS                                                 23540000
235500             QUEUE (ASC-SEL-QUEUE-NAME)                           23550000
235600             INTO  (CN013-SELECT-RECORD)                          23560000
235700             ITEM  (ASC-SEL-ITEM)                                 23570000
235800             RESP  (PV-CICS-RESPONSE)                             23580000
235900     END-EXEC.                                                    23590000
236000                                                                  23600000
236100     IF  PV-CICS-RESPONSE = DFHRESP(NORMAL)                       23610000
236200         CONTINUE                                                 23620000
236300     ELSE                                                         23630000
236400         SET DP013-LOGIC-ABEND                                    23640000
236500             DP013-NO-ROLLBACK     TO TRUE                        23650000
236600         MOVE '9100-READ-SEL-QUEUE' TO DP013-PARAGRAPH            23660000
236700         MOVE 'ATTEMPTING TO READ THE LIST SELECTIONS TS QUEUE'   23670000
236800                                   TO DP013-MESSAGE-TEXT (1)      23680000
236900         PERFORM DP013-0000-PROCESS-ABEND                         23690000
237000     END-IF.                                                      23700000
237100                                                                  23710000
237200*----------------------------------------------------------------*23720000
237300* UPDATE AN ITEM IN THE SELECTED ITEMS TEMP STORAGE QUEUE.       *23730000
237400*----------------------------------------------------------------*23740000
237500 9200-REWRITE-SEL-QUEUE.                                          23750000
237600     EXEC CICS                                                    23760000
237700          WRITEQ TS                                               23770000
237800              QUEUE  (ASC-SEL-QUEUE-NAME)                         23780000
237900              FROM   (CN013-SELECT-RECORD)                        23790000
238000              ITEM   (ASC-SEL-ITEM)                               23800000
238100              RESP   (PV-CICS-RESPONSE)                           23810000
238200              REWRITE                                             23820000
238300     END-EXEC.                                                    23830000
238400                                                                  23840000
238500     IF  PV-CICS-RESPONSE NOT = DFHRESP(NORMAL)                   23850000
238600         SET DP013-CICS-ABEND                                     23860000
238700             DP013-NO-ROLLBACK     TO TRUE                        23870000
238800         MOVE '9200-REWRITE-SEL-QUEUE'  TO DP013-PARAGRAPH        23880000
238900         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   23890000
239000                                   TO DP013-MESSAGE-TEXT (1)      23900000
239100         PERFORM DP013-0000-PROCESS-ABEND                         23910000
239200     END-IF.                                                      23920000
239300                                                                  23930000
239400     COPY DPPD013.                                                23940000
239500*----------------------------------------------------------------*23950000
239600*    ABEND PROCESSOR MODULE                                      *23960000
239700*----------------------------------------------------------------*23970000
