000100 IDENTIFICATION DIVISION.                                                 
000200 PROGRAM-ID.    MLKUP020.                                                 
000300 AUTHOR.        MARC BLAZICH - GREENBRIER & RUSSEL.                       
000400 INSTALLATION.  KOHLS DEPARTMENT STORES.                                  
000500*DATE-WRITTEN.  11/01/93.                                                 
000500*DATE-COMPILED.                                                           
000700******************************************************************        
000800*  MERCHANDISE LEDGER PRE-EDIT MODULE                             00080000
000900******************************************************************00090000
000800*  !!! THIS PROGRAM IS EXECUTED IN JOBS MLK140 AND MWK178 !!!     00092099
000900******************************************************************00093099
001000*  CHANGES:                                                       00100000
001100*    02/26/97 TOM MEDREK - FOR NEW FAST SYSTEM.                   00110000
001200*      ADDED CODE TO MOVE NEW FIELD = ML019-TRANSFER-DOC-NBR TO   00120000
001300*      TO THE NEW COMPOSITE FIELD = ML020-XFER-DOC-NBR WHEN THE   00130000
001400*      ML019-TRANSFER-NBR = 'FAST '.                              00140000
001500*    05/01/97 TOM MEDREK - FOR DEFERRED BOOKING FUNCTIONALITY.    00150000
001600*      PV-DEFER-TYPE-SW DETERMINES WHICH RECEIPT FILE TYPES WILL  00160000
001700*      BE CONSIDERED FOR DEFERRAL UNTIL NEXT MONTH (WEEK#1).      00170000
001800*      PRESENTLY, THE FOLLOWING TYPES OF INPUT ARE CONSIDERED:    00180000
001900*          1)  PURCHASE JOURNAL TRANSACTIONS                      00190000
002000*          2)  INTRANSIT (UNJOURNALIZED) TRANSACTIONS             00200000
002100*          3)  INTRANSIT (UNJOURNALIZED) REVERSAL TRANSACTIONS    00210000
002200*                                                                 00220000
002300*      AMONG THE RECEIPT INPUTS ONLY CERTAIN TRANSACTION CODES    00230000
002400*      WILL BE CONSIDERED FOR DEFERRAL, THE TRAN CODE '01' IS :   00240000
002500*          88  PV-AP-TRANS-CDE-RECEIPT                            00250000
002600*                                                                 00260000
002700*      THE FOLLOWING SWITCH CONTROLS WHICH DIVISIONS FROM ABOVE   00270000
002800*      SHOULD BE CONSIDERED FOR DEFERRAL:                         00280000
002900*          05  PV-DEFER-DIV-SW                                    00290000
003000*              88  PV-DEFER-DIV-NONE                              00300000
003100*              88  PV-DEFER-DIV-ALL                               00310000
003200*              88  PV-DEFER-DIV-SPEC   SPECIFIC DIVISION(S)       00320000
003300*                                                                 00330000
003400*      PV-DEFERRED-TRAN-SW IS SET WHEN THE DOCUMENT DATE IS       00340000
003500*      BETWEEN THE LAST DAY OF THE FISCAL MONTH AND THE "CUTOFF   00350000
003600*      DATE" (CALCULATED DATE BY SUBTRACTING NUMBER OF DAYS TO    00360000
003700*      DEFER FROM LAST FISCAL DAY OF MONTH) WHILE ALSO MEETING THE00370000
003800*      CRITERIA ABOVE.                                            00380000
003900******************************************************************00390000
004000*    10/27/97 - KARI SUTTON - WR# 5408 (MARKDOWN/UP REPORT)       00400000
004100*       MODIFIED Z400-FMT-PC-COMPOSITE-REC TO MOVE ONE NEW FIELD  00410000
004200*       THAT WAS ADDED TO MLRD017 TO MLRD020.  THE FIELD IS       00420000
004300*       ML017-PC-MKDN-MKUP-RSN-CDE.                               00430000
004400******************************************************************00440000
004410*    12/04/97 - DMH - WR# 5830                                    00450000
004420*       SALES RECEIVED FROM THE POS SYSTEM WILL HAVE THE SALE TYPE00460000
004430*       FIELD MOVED FROM THE INPUT RECORD (KDU1806) TO THE COMP   00470000
004440*       RECORD (MLRD020). SALES CORRECTIONS WILL BE DEFAULTED TO  00480000
004441*       'O' FOR THE SALE TYPE.                                    00490000
004450******************************************************************00500000
004410*    02/27/98 - RWM - WR#                                         00510000
004420*       MODIFY CONTROL CARD SKIP CLASS TABLE MAX TO 999 ENTRIES   00520000
004430******************************************************************00530000
WR5701*    03/20/98 - SCOTT JACKSON - WR#5701 (REWRITE)                 00540000
WR5701*       ALTER DEPT_CSR (TMDSEAR) TO SELECT RECORDS BASED ON THE   00550000
WR5701*       PROCESSING DATE (NOT THE CURRENT DATE)                    00560000
004450******************************************************************00560100
      *   CHANGES:                                                      00560200
      *   DATE 9/02/1998                                                00560300
      *   CONVERTED FOR Y2K                                             00560400
      *   MADE BY: BARBARA HULL - COMPUWARE                             00560500
004430******************************************************************00570000
WR5701*    08/31/98 - DAVE METZGER - WR#5701 (REWRITE)                  00571000
WR5701*       REMOVED LOGIC FOR PROCESSING INPUT FILES-PURCHASE JOURNAL,00572000
WR5701*       UNJOURNALIZED RECEIPTS, AND UNJOURNALIZED RECEIPTS        00573000
WR5701*       REVERSAL FILES.  ADDED LOGIC TO PROCESS NEW INPUT FILES-  00574000
WR5701*       RECEIPTS, PURCHASE ADJUSTMENTS, AND A/P COSTS FILES WHICH 00574100
WR5701*       ARE THE NEW INPUTS TO REPLACE THE PURCHASE JOURNAL        00574200
WR5701*       JOURNALIZED AND UNJOUNALIZED TRANACTIONS FROM A/P.  THE   00574300
WR5701*       RECEIPTS WILL BE SOURCED FROM THE RECEIVING SYSTEM AND    00574400
WR5701*       WILL CONSIST OF THE VARIFIED RECEIPTS FOR THE WEEK.       00574500
WR5701*       PURCHASE ADJUSTMENTS WILL CONSIST OF ALL THE PURCHASE     00574600
WR5701*       TRANACTIONS EXCEPT FOR THE 01'S AND 02'S TYPES (RECEIPTS) 00574700
WR5701*       WHICH WILL BE STRIPPED OFF.  THE COST FILE WILL BE SOURCED00574800
WR5701*       FROM A/P (APK270) AND CONSIST OF MISC. COSTS/FREIGHT THAT 00574900
WR5701*       WERE CARRIED ON THE RECEIPT TRANACTIONS (01/02) THAT ARE  00575000
WR5701*       NO LONGER INPUT TO LEDGER.                                00575199
004450******************************************************************00575400
      *    04/19/99 - PAUL KEBER  - WR#6041 (Y2K CHANGES)               00575699
      *       PROPERLY INITIALIZE CALENDAR ROUTINE PARAMETERS.          00575799
004450******************************************************************00575999
      *    05/13/99 - PAUL KEBER  - WR#10671                            00576099
      *       CREATE A M/L PRE-EDIT TRANSACTION INPUT CLASS/DEPARTMENT  00576199
      *       REJECTIONS FILE TO BE USED AS INPUT FOR A REPORT.         00576299
004450******************************************************************00576399
      *    06/09/99 - PAUL KEBER  - WR#10764                            00576499
      *       ADDED LOGIC TO H100-PROCESS-REGISTER-SALES TO HANDLE SALES00576599
      *       CORRECTIONS.  SET THE NEW ML123-COSA-IND FIELD FOR SALES  00576699
      *       CORRECTIONS AND MARKDOWN/MARKUPS.                         00576799
004450******************************************************************00577299
      *    08/20/99 - AMY LAWSON  -                                     00577499
      *       THE MARKDOWN/MARKUP NUMBER THAT WAS BEING WRITTEN TO THE  00577599
      *       BLOCKED TRANSACTION REPORT WAS NOT THE NET EFFECT OF THE  00577699
      *       NEW AND OLD PRICE.  BECAUSE OF THIS THE MARKDOWN/MARKUP   00577799
      *       NUMBER ON THE MLKRP217 REPORT WAS NOT A VALID BALANCING   00577899
      *       TOOL.                                                     00577999
004450******************************************************************00578099
1099RM******************************************************************00578199
1099RM*    10/15/99 - BOB MCASEY 10587                                  00578299
1099RM*       ADDED CODE TO MOVE THE IN-HOUSE NUMBER FROM THE PRICE     00578399
1099RM*       CHANGE INPUT RECORD TO THE COMPOSITE RECORD. THIS IS DONE 00578499
1099RM*       FOR VENDOR ANALYSIS VENDOR ALLOWANCE TRANSACTIONS TRAN    00578599
1099RM*       CODE '999'. (THE IN-HOUSE NUMBER FIELD ON MLRD017 IS NEW. 00578699
1099RM*       THE DATA WAS ALWAYS THERE. THE FIELD WAS JUST DEFINED.    00578799
1099RM******************************************************************00578899
1099RM******************************************************************00578999
1099RM*    12/28/99 - BOB MCASEY 20698                                  00579099
1099RM*       ADDED CODE TO MOVE THE PO-TYPE CODE FROM THE PURCHASE     00579199
1099RM*       INPUT FILE TO THE COMPOSITE RECORD.                       00579299
1099RM******************************************************************00579699
1099RM******************************************************************00579799
1099RM*    01/17/00 - TESS BESTE WR99999                                00579899
1099RM*       REMOVED ALL LOGIC RELATED TO DEFERRED RECEIPTS AND        00579999
1099RM*       YEAR-END ADJUSTMENTS.                                     00580099
1099RM******************************************************************00580199
      ******************** HISTORY OF CHANGES **************************00581099
      *                                                                *00581199
      * WR/PROJ  DATE        DESCRIPTION OF CHANGES                    *00581299
      * -------  ----------  ----------------------------------------  *00581399
      *          09/21/2000  V. LEE YANG                                00581499
      *                      ADD ML123-POS-IND FIELD AND FILLER         00581599
      *                      TO CL-DEPT-REJECT-FILE                     00581699
      *                      FOR LOSS PREVENTION BALANCING              00581799
      * 21015    01/15/2001  ROD JANSSEN                                00581899
      *                      ADD ML123-BATCH-NBR FIELD TO               00581999
      *                      CL-DEPT-REJECT-FILE                        00582099
      *                      SUMMING BY BATCH NUMBER IN MLKRP217......  00582199
      * 21591    03-01-2002  MANIFEST PROJECT CHANGE FOR IN-TRANSIT    *00582299
      *                      REVERSAL FROM INVENTORY LEDGER            *00582399
      *                                                                *00582499
      * 21731    03-02-2002  S. JACKSON                                 00582299
      *           (NEWSKU)   CHANGES FOR NEW SKU. EACH OUTPUT RECORD   *00582299
      *                      WILL CONTAINS SKU ATTRIBUTES (TSKXREF).    00582399
      *                      IF THE INPUT FILE DOES NOT CONTAIN SKU     00582399
      *                      ATTRIBUTES, THIS PGM WILL APPEND TO OUTPUT.00582399
      *                      THIS REQUIRES PROGRAM TO BE A DB2 PGM AGAIN00582499
487868*                                                                *00582499
487868*PM00487868 8-15-2002  R. BUTZ - PROBLEM NUMBER PM00487868       *00582299
487868*                      MOVE ZEROS TO DEPT/CLASS WHEN NOT FOUND   *00582299
487868*                      ON TSKXREF                                *00582299
24241 * 24241     11-27-2002 R. JANSSEN - ADD THE STORE NUMBER TO THE           
24241 *                      BLOCKED REPORT RECORD                              
W26603* W26603    03-08-2004 R. JANSSEN MERCH LEDGER STORE EXPANSION            
W20445* W20445    09-01-2004 R. JANSSEN DETAILED INVNENTORY ADJUSTMENT          
      * 26006     03-03-2005 V. LEE YANG UPDATE ENT-ID (VENDOR) LOOKUP          
      *                      TO CORRECT A PRODUCTION ISSUE WITH VA              
26006R* 26006     07-20-2005 R. JANSSEN ISSUE WITH TRANSFER GOING TO            
26006R*                                 UNKNOWN VENDOR.                         
W28545* W28545    08-22-2005 R. JANSSEN THE NEW TRANSFER PROCESS                
W29145* W29145    10-11-2005 S. JACKSON SAS MARKDOWN OPTIMIZATION               
S29145* S29145    11-20-2005 S. JACKSON SAS-DW ORIG RETAIL ON GRP PRICE         
W28582* W28582    11-22-2005 C.MCCAMMON DEBIT ALLOWANCE/ADD BRAND(SHORT)        
W32898* W32898    10-15-2007 J.SELWITSCHKA - BRAND VENDOR PHASE II              
W32898*                                 ASSIGN ML020-PURCH-LBL-SEQ-NBR.         
B32898* W32898    10-18-2007 B. GRAHAM - STRATAGEM                              
B32898*                                 BRAND VENDOR PHASE II                   
B32898*                                 BYPASS VENDOR ID LOOK UP WHEN           
B32898*                                 BOTH BRAND AND VENDOR ARE IN THE        
B32898*                                 INPUT (FROM RECLASS, BRAND OR           
B32898*                                 VENDOR MOVES)                           
W34309* W34309    03-10-2008 B. GRAHAM - STRATAGEM                              
W34309*                                 PRIVATE BRAND ACCOUNTING                
W34309*                                 GIVEBACK                                
W34309* W34517    08-08-2008 B. GRAHAM - STRATAGEM                              
W34309*                                 INVENTORY MOVEMENT / BV                 
W34309*                                 REALIGNMENT AP-TRAN CODE                
W34309*                                 CHANGES                                 
W31475* W31475    04-24-2009 COGNIZANT - ML BATCH PERFORMANCE TUNING            
W31475*                                  CHANGES FOR REDUCING BATCH             
W31475*                                  WINDOW                                 
W38216* W38216    03-31-2010 J SELWITSCHKA                                      
W38216*                                - CHANGES FOR EFC2 PROJECT.              
W38216*                                  CONVERT EFC2 LOCATIONS TO              
W38216*                                  EFC1 LOCATIONS.                        
W38972* W38972    08-18-2010 COGNIZANT (SANDEEP)                                
W38972*                                - MLOF PROJECT CHANGES.                  
W38972*                                - REMOVAL OF EFC2 PROJECT CHANGES        
207210* CHG0207210 08-27-2018 JIM HUNTER  RENAME KDU1806 TO PSWS010             
239558* CHG0239558 02-14-2020 COGNIZANT   MOVED SKU NUMBER TO REJECT            
239558*                                   FILE TO SHOW SKU NUMBER IN ML         
239558*                                   DEPARTMENT REJECT REPORT              
239558*                                   INSTEAD OF CLASS DEPARTMENT           
004500***************************************************************** 00582699
004600 ENVIRONMENT DIVISION.                                            00582799
004700 CONFIGURATION SECTION.                                           00582899
004800 INPUT-OUTPUT SECTION.                                            00582999
004900 FILE-CONTROL.                                                    00583099
005000                                                                  00583199
005100     SELECT RECEIPTS-FILE                                         00583299
005200         ASSIGN TO INP01.                                         00583399
005400                                                                  00583499
005500     SELECT DATA-ENTRY-PURCH-FILE                                 00583599
005600         ASSIGN TO INP02.                                         00583699
005800                                                                  00584099
005900     SELECT PURCH-ADJ-FILE                                        00590000
006000         ASSIGN TO INP03.                                         00600000
006200                                                                  00610000
006300     SELECT AP-COSTS-FILE                                         00620000
006400         ASSIGN TO INP04.                                         00630000
006600                                                                  00640000
006700     SELECT REGISTER-SALES-FILE                                   00650000
006800         ASSIGN TO INP05.                                         00660000
007000                                                                  00670000
007100     SELECT SALES-CORR-FILE                                       00680000
007200         ASSIGN TO INP06.                                         00690000
007400                                                                  00700000
007500     SELECT PERM-PRC-CHG-FILE                                     00710000
007600         ASSIGN TO INP07.                                         00720000
007800                                                                  00730000
007900     SELECT PROMO-PRC-CHG-FILE                                    00740000
008000         ASSIGN TO INP08.                                         00750000
008200                                                                  00760000
008300     SELECT DATA-ENTRY-PRC-CHG-FILE                               00770000
008400         ASSIGN TO INP09.                                         00780000
008600                                                                  00790000
008700     SELECT PHYS-INVEN-ADJ-FILE                                   00800000
008800         ASSIGN TO INP10.                                         00810000
009000                                                                  00820000
21591      SELECT IN-TRANSIT-ADJ-FILE                                   00830099
21591          ASSIGN TO INP11.                                         00840099
21591                                                                   00850099
009500     SELECT STORE-TRANSFER-FILE                                   00860000
009600         ASSIGN TO INP12.                                         00870000
009800                                                                  00880000
009900     SELECT SKIP-CLASS-FILE                                       00890000
010000         ASSIGN TO INP13.                                         00900000
010200                                                                  00910000
010300     SELECT CNTL-DATE-FILE                                        00920000
010400         ASSIGN TO INP14.                                         00930000
010500                                                                  00940000
010900     SELECT COMPOSITE-FILE                                        00980000
011000         ASSIGN TO OUT01.                                         00990000
011200                                                                  01000000
011300     SELECT REJECT-FILE                                           01010000
011400         ASSIGN TO OUT02.                                         01020000
011500                                                                  01030000
011300     SELECT CL-DEPT-REJECT-FILE                                   01061099
011400         ASSIGN TO OUT04.                                         01062099
011500                                                                  01063099
011900     SELECT ERROR-REPORT                                          01070000
012000         ASSIGN TO RPT01.                                         01080000
012200                                                                  01090000
012300 DATA DIVISION.                                                   01100000
012400 FILE SECTION.                                                    01110000
012500                                                                  01120000
012600 FD  RECEIPTS-FILE                                                01130000
012700     RECORDING  MODE IS F.                                        01140000
012800 01  RECEIPTS-REC                     PIC X(150).                 01150000
012900                                                                  01160000
013000 FD  DATA-ENTRY-PURCH-FILE                                        01170000
013100     RECORDING  MODE IS F.                                        01180000
W26603 01  DATA-ENTRY-PURCH-REC             PIC X(150).                 01190000
013300                                                                  01200000
013400 FD  PURCH-ADJ-FILE                                               01210000
013500     RECORDING  MODE IS F.                                        01220000
W26603 01  PURCH-ADJ-REC                    PIC X(150).                 01230000
013700                                                                  01240000
013800 FD  AP-COSTS-FILE                                                01250000
013900     RECORDING  MODE IS F.                                        01260000
W26603 01  AP-COSTS-REC                     PIC X(150).                 01270000
014100                                                                  01280000
014200 FD  REGISTER-SALES-FILE                                          01290000
014300     RECORDING  MODE IS F.                                        01300000
W21731 01  REGISTER-SALES-REC               PIC X(65).                  01310000
014500                                                                  01320000
014600 FD  SALES-CORR-FILE                                              01330000
014700     RECORDING  MODE IS F.                                        01340000
014800 01  SALES-CORR-REC                   PIC X(80).                  01350000
014900                                                                  01360000
015000 FD  PERM-PRC-CHG-FILE                                            01370000
015100     RECORDING  MODE IS F.                                        01380000
W26603*01  PERM-PRC-CHG-REC                 PIC X(120).                 01390000
S29145 01  PERM-PRC-CHG-REC                 PIC X(200).                 01390000
015300                                                                  01400000
015400 FD  PROMO-PRC-CHG-FILE                                           01410000
015500     RECORDING  MODE IS F.                                        01420000
W26603*01  PROMO-PRC-CHG-REC                PIC X(120).                 01430000
S29145 01  PROMO-PRC-CHG-REC                PIC X(200).                 01430000
015700                                                                  01440000
015800 FD  DATA-ENTRY-PRC-CHG-FILE                                      01450000
015900     RECORDING  MODE IS F.                                        01460000
W26603*01  DATA-ENTRY-PRC-CHG-REC           PIC X(120).                 01470000
S29145 01  DATA-ENTRY-PRC-CHG-REC           PIC X(200).                 01470000
016100                                                                  01480000
016200 FD  PHYS-INVEN-ADJ-FILE                                          01490000
016300     RECORDING  MODE IS F.                                        01500000
016400 01  PHYS-INVEN-ADJ-REC               PIC X(80).                  01510000
016500                                                                  01520000
21591  FD  IN-TRANSIT-ADJ-FILE                                          01490000
21591      RECORDING  MODE IS F.                                        01500000
W26603 01  IN-TRANSIT-ADJ-REC               PIC X(150).                 01510000
21591                                                                   01520000
017000 FD  STORE-TRANSFER-FILE                                          01570000
017100     RECORDING  MODE IS F.                                        01580000
017200 01  STORE-TRANSFER-REC               PIC X(80).                  01590000
017300                                                                  01600000
017400 FD  SKIP-CLASS-FILE                                              01610000
017500     RECORDING  MODE IS F.                                        01620000
017600 01  SKIP-CLASS-REC                   PIC X(80).                  01630000
017700                                                                  01640000
017800 FD  CNTL-DATE-FILE                                               01650000
017900     RECORDING  MODE IS F.                                        01660000
018000 01  CNTL-DATE-REC                    PIC X(80).                  01670000
018100                                                                  01680000
018600 FD  COMPOSITE-FILE                                               01730000
018700     RECORDING  MODE IS F                                         01740000
018800     BLOCK CONTAINS 0 RECORDS.                                    01750000
W26603 01  COMPOSITE-REC                    PIC X(175).                 01760000
019000                                                                  01770000
019600 FD  REJECT-FILE                                                  01830000
019700     RECORDING  MODE IS V                                         01840000
W26603     RECORD CONTAINS 65 TO 150 CHARACTERS                         01850000
019900     BLOCK CONTAINS 0 RECORDS.                                    01860000
020000 01  REJECT-REG-SALES-REC65           PIC X(065).                 01870000
W26603 01  REJECT-REC150                    PIC X(150).                 01880000
020200                                                                  01890000
019600 FD  CL-DEPT-REJECT-FILE                                          01891099
019700     RECORDING  MODE IS F                                         01892099
019900     BLOCK CONTAINS 0 RECORDS.                                    01894099
020100 01  CL-DEPT-REJECT-REC               PIC X(080).                 01896099
020200                                                                  01897099
020300 FD  ERROR-REPORT                                                 01900000
020400     RECORDING  MODE IS F.                                        01910000
020500 01  ERROR-REC.                                                   01920000
020600     05  ERROR-LINE-CC     PIC X(001).                            01930000
020700     05  ERROR-LINE-DATA   PIC X(132).                            01940000
020800     05  FILLER REDEFINES  ERROR-LINE-DATA.                       01950000
020900         10  FILLER        PIC X(131).                            01960000
021000         10  EL-HEADER-FONT-INDICATOR                             01970000
021100                           PIC X(001).                            01980000
021200                                                                  01990000
021300 EJECT                                                            02000000
021400 WORKING-STORAGE SECTION.                                         02010000
021500                                                                  02020000
023400***************************************************************** 02210000
023500*  DATA ENTRY SALES                                               02220000
023600***************************************************************** 02230000
207210     COPY PSWS010.                                                02240000
023800                                                                  02250000
023900***************************************************************** 02260000
024000*  PURCHASES                                                      02270000
024100***************************************************************** 02280000
024200     COPY MLRD015.                                                02290000
024300                                                                  02300000
024400***************************************************************** 02310000
024500*  SALES                                                          02320000
024600***************************************************************** 02330000
024700     COPY MLRD016.                                                02340000
024800                                                                  02350000
024900***************************************************************** 02360000
025000*  PRICE CHANGES                                                  02370000
025100***************************************************************** 02380000
025200     COPY MLRD017.                                                02390000
025300                                                                  02400000
025400***************************************************************** 02410000
025500*  ADJUSTMENTS                                                    02420000
025600***************************************************************** 02430000
025700     COPY MLRD018.                                                02440000
025800                                                                  02450000
025900***************************************************************** 02460000
026000*  TRANSFERS                                                      02470000
026100***************************************************************** 02480000
026200     COPY MLRD019.                                                02490000
026300                                                                  02500000
026400***************************************************************** 02510000
026500*  OUTPUT COMPOSITE RECORD                                        02520000
026600***************************************************************** 02530000
026700     COPY MLRD020.                                                02540000
026800                                                                  02550000
026400***************************************************************** 02551099
026500*  OUTPUT CLASS/DEPARTMENT REJECT RECORD                          02552099
026600***************************************************************** 02553099
026700     COPY MLRD123.                                                02554099
026800                                                                  02555099
W21731******************************************************************        
W21731*  DB2 ERROR MESSAGES FORMAT AREA.                                        
W21731******************************************************************        
W21731     COPY DPWS004.                                                        
W21731*                                                                         
026900***************************************************************** 02560000
027000*  CODE FROM PGM=MLKUP021 FOR CONTROL CARD DATE PROCESSING.       02570000
027100***************************************************************** 02580000
027200 01  CC-CONTROL-CARD.                                             02590000
027300     05  CC-CALENDAR-TYPE                PIC X(02).               02600000
027400     05  FILLER                          PIC X.                   02610000
027500     05  CC-PROC-DATE-ISO                PIC X(10).               02620000
027600     05  CC-PROC-DATE-RDF  REDEFINES                              02630000
027700         CC-PROC-DATE-ISO.                                        02640000
027800         10  CC-PROC-CC                  PIC X(02).               02650000
027900         10  CC-PROC-YY                  PIC X(02).               02660000
028000         10  FILLER                      PIC X(01).               02670000
028100         10  CC-PROC-MM                  PIC X(02).               02680000
028200         10  FILLER                      PIC X(01).               02690000
028300         10  CC-PROC-DD                  PIC X(02).               02700000
028400     05  FILLER                          PIC X.                   02710000
028500     05  CC-PROCESSING-MODE              PIC X(04).               02720000
028600         88  CC-PROCESSING-MODE-VALID    VALUE 'ML'  'INV' 'BOTH'.02730000
028700         88  CC-PROCESSING-MODE-ML       VALUE 'ML'  'BOTH'.      02740000
028800         88  CC-PROCESSING-MODE-ML-ONLY  VALUE 'ML'.              02750000
028900         88  CC-PROCESSING-MODE-INV      VALUE 'INV' 'BOTH'.      02760000
029000         88  CC-PROCESSING-MODE-INV-ONLY VALUE 'INV'.             02770000
029100     05  FILLER                          PIC X.                   02780000
029200     05  CC-CHECK-INV-DATES-SW           PIC X.                   02790000
029300         88  CC-CHECK-INV-DATES-SW-VALID VALUE 'Y' 'N'.           02800000
029400         88  CC-CHECK-INV-DATES          VALUE 'Y'.               02810000
029500         88  CC-DONT-CHECK-INV-DATES     VALUE 'N'.               02820000
029600     05  FILLER                          PIC X(60).               02830000
029700                                                                  02840000
030900 01  CPU-DATE.                                                    02960000
031000     05  CPU-YEAR                    PIC X(02)     VALUE SPACES.  02970000
031100     05  CPU-MONTH                   PIC X(02)     VALUE SPACES.  02980000
031200     05  CPU-DAY                     PIC X(02)     VALUE SPACES.  02990000
031300                                                                  03000000
031400 01  CPU-TIME.                                                    03010000
031500     05  CPU-HOUR                    PIC X(02)     VALUE SPACES.  03020000
031600     05  CPU-MINUTE                  PIC X(02)     VALUE SPACES.  03030000
031700     05  FILLER                      PIC X(02)     VALUE SPACES.  03040000
031800                                                                  03050000
031900 01  SKIP-CLASS-RECORD.                                           03060000
032000     05  SKIP-CLASS-NBR          PIC X(05).                       03070000
032100     05  FILLER                  PIC X(75).                       03080000
032200                                                                  03090000
032300 01  SKIP-CLASS-TABLE.                                            03100000
032400     05  SKIP-CLASS              OCCURS     999 TIMES             03110000
W31475                                 ASCENDING KEY IS SKIP-CLASS              
032500                                 INDEXED    SKIP-IDX              03120000
032600                                 PIC X(5).                        03130000
032700                                                                  03140000
032800 01  PV-PROGRAM-VARIABLES.                                        03150000
TEMP       05  PV-XREF-SQL-CALLS               PIC 9(9)      VALUE 0.   03160000
032900                                                                  03160000
032900                                                                  03160000
032900     05  PV-LINE-COUNT                   PIC 9(2).                03160000
033000     05  PV-PAGE-COUNT                   PIC 9(5).                03170000
033100     05  PV-TOT-MKDOWN-IN                PIC S9(09)    COMP-3.    03180000
033200     05  PV-TOT-MKDOWN-SKP               PIC S9(09)    COMP-3.    03190000
033300     05  PV-TOT-MKDOWN-OK                PIC S9(09)    COMP-3.    03200000
033400     05  PV-TOT-MKUP-IN                  PIC S9(09)    COMP-3.    03210000
033500     05  PV-TOT-MKUP-SKP                 PIC S9(09)    COMP-3.    03220000
033600     05  PV-TOT-MKUP-OK                  PIC S9(09)    COMP-3.    03230000
033700     05  PV-TOT-SALE-IN                  PIC S9(09)    COMP-3.    03240000
033800     05  PV-TOT-SALE-ERR                 PIC S9(09)    COMP-3.    03250000
033900     05  PV-TOT-SALE-SKP                 PIC S9(09)    COMP-3.    03260000
034000     05  PV-TOT-SALE-OK                  PIC S9(09)    COMP-3.    03270000
034100     05  PV-TOT-PURCH-IN                 PIC S9(09)    COMP-3.    03280000
034200     05  PV-TOT-PURCH-ERR                PIC S9(09)    COMP-3.    03290000
034300     05  PV-TOT-PURCH-SKP                PIC S9(09)    COMP-3.    03300000
034400     05  PV-TOT-PURCH-OK                 PIC S9(09)    COMP-3.    03310000
034600     05  PV-TOT-TRANSFER-IN              PIC S9(09)    COMP-3.    03330000
034700     05  PV-TOT-TRANSFER-ERR             PIC S9(09)    COMP-3.    03340000
034800     05  PV-TOT-TRANSFER-SKP             PIC S9(09)    COMP-3.    03350000
034900     05  PV-TOT-TRANSFER-OK              PIC S9(09)    COMP-3.    03360000
035000     05  PV-TOT-ADJ-IN                   PIC S9(09)    COMP-3.    03370000
035100     05  PV-TOT-ADJ-ERR                  PIC S9(09)    COMP-3.    03380000
035200     05  PV-TOT-ADJ-SKP                  PIC S9(09)    COMP-3.    03390000
035300     05  PV-TOT-ADJ-OK                   PIC S9(09)    COMP-3.    03400000
21591      05  PV-TOT-INTR-ADJ-IN              PIC S9(09)    COMP-3.    03370000
21591      05  PV-TOT-INTR-ADJ-ERR             PIC S9(09)    COMP-3.    03380000
21591      05  PV-TOT-INTR-ADJ-SKP             PIC S9(09)    COMP-3.    03390000
21591      05  PV-TOT-INTR-ADJ-OK              PIC S9(09)    COMP-3.    03400000
035400                                                                  03410000
035500     05  PV-PERM-PRC-CHG-IN              PIC S9(09)    COMP-3.    03420000
035600     05  PV-PERM-PRC-CHG-ERR             PIC S9(09)    COMP-3.    03430000
035700     05  PV-PERM-PRC-CHG-SKP             PIC S9(09)    COMP-3.    03440000
035800     05  PV-PERM-PRC-CHG-OK              PIC S9(09)    COMP-3.    03450000
035900     05  PV-PERM-PRC-CHG-MKDOWN-IN       PIC S9(09)    COMP-3.    03460000
036000     05  PV-PERM-PRC-CHG-MKDOWN-SKP      PIC S9(09)    COMP-3.    03470000
036100     05  PV-PERM-PRC-CHG-MKDOWN-OK       PIC S9(09)    COMP-3.    03480000
036200     05  PV-PERM-PRC-CHG-MKUP-IN         PIC S9(09)    COMP-3.    03490000
036300     05  PV-PERM-PRC-CHG-MKUP-SKP        PIC S9(09)    COMP-3.    03500000
036400     05  PV-PERM-PRC-CHG-MKUP-OK         PIC S9(09)    COMP-3.    03510000
036500                                                                  03520000
036600     05  PV-PROMO-PRC-CHG-IN             PIC S9(09)    COMP-3.    03530000
036700     05  PV-PROMO-PRC-CHG-ERR            PIC S9(09)    COMP-3.    03540000
036800     05  PV-PROMO-PRC-CHG-SKP            PIC S9(09)    COMP-3.    03550000
036900     05  PV-PROMO-PRC-CHG-OK             PIC S9(09)    COMP-3.    03560000
037000     05  PV-PROMO-PRC-CHG-MKDOWN-IN      PIC S9(09)    COMP-3.    03570000
037100     05  PV-PROMO-PRC-CHG-MKDOWN-SKP     PIC S9(09)    COMP-3.    03580000
037200     05  PV-PROMO-PRC-CHG-MKDOWN-OK      PIC S9(09)    COMP-3.    03590000
037300     05  PV-PROMO-PRC-CHG-MKUP-IN        PIC S9(09)    COMP-3.    03600000
037400     05  PV-PROMO-PRC-CHG-MKUP-SKP       PIC S9(09)    COMP-3.    03610000
037500     05  PV-PROMO-PRC-CHG-MKUP-OK        PIC S9(09)    COMP-3.    03620000
037600                                                                  03630000
037700     05  PV-RECEIPTS-IN                  PIC S9(09)    COMP-3.    03640000
037800     05  PV-RECEIPTS-ERR                 PIC S9(09)    COMP-3.    03650000
037900     05  PV-RECEIPTS-SKP                 PIC S9(09)    COMP-3.    03660000
038000     05  PV-RECEIPTS-OK                  PIC S9(09)    COMP-3.    03670000
038200                                                                  03690000
038300     05  PV-PURCH-ADJ-IN                 PIC S9(09)    COMP-3.    03700000
038400     05  PV-PURCH-ADJ-ERR                PIC S9(09)    COMP-3.    03710000
038500     05  PV-PURCH-ADJ-SKP                PIC S9(09)    COMP-3.    03720000
038600     05  PV-PURCH-ADJ-OK                 PIC S9(09)    COMP-3.    03730000
038800     05  PV-AP-COSTS-IN                  PIC S9(09)    COMP-3.    03750000
038900     05  PV-AP-COSTS-ERR                 PIC S9(09)    COMP-3.    03760000
039000     05  PV-AP-COSTS-SKP                 PIC S9(09)    COMP-3.    03770000
039100     05  PV-AP-COSTS-OK                  PIC S9(09)    COMP-3.    03780000
039300                                                                  03800000
039400     05  PV-REGISTER-SALES-IN            PIC S9(09)    COMP-3.    03810000
039500     05  PV-REGISTER-SALES-ERR           PIC S9(09)    COMP-3.    03820000
039600     05  PV-REGISTER-SALES-SKP           PIC S9(09)    COMP-3.    03830000
039700     05  PV-REGISTER-SALES-OK            PIC S9(09)    COMP-3.    03840000
039300                                                                  03840199
039400     05  PV-COSA-SALES-CORR-IN           PIC S9(09)    COMP-3.    03840299
039500     05  PV-COSA-SALES-CORR-ERR          PIC S9(09)    COMP-3.    03840499
039600     05  PV-COSA-SALES-CORR-SKP          PIC S9(09)    COMP-3.    03840599
039700     05  PV-COSA-SALES-CORR-OK           PIC S9(09)    COMP-3.    03840699
039800                                                                  03850000
039900     05  PV-DATA-ENTRY-IN                PIC S9(09)    COMP-3.    03860000
040000     05  PV-DATA-ENTRY-ERR               PIC S9(09)    COMP-3.    03870000
040100     05  PV-DATA-ENTRY-SKP               PIC S9(09)    COMP-3.    03880000
040200     05  PV-DATA-ENTRY-OK                PIC S9(09)    COMP-3.    03890000
040300     05  PV-DATA-ENTRY-PRC-CHG-IN        PIC S9(09)    COMP-3.    03900000
040400     05  PV-DATA-ENTRY-PRC-CHG-ERR       PIC S9(09)    COMP-3.    03910000
040500     05  PV-DATA-ENTRY-PRC-CHG-SKP       PIC S9(09)    COMP-3.    03920000
040600     05  PV-DATA-ENTRY-PRC-CHG-OK        PIC S9(09)    COMP-3.    03930000
040700     05  PV-DATA-ENTRY-MKDOWN-IN         PIC S9(09)    COMP-3.    03940000
040800     05  PV-DATA-ENTRY-MKDOWN-SKP        PIC S9(09)    COMP-3.    03950000
040900     05  PV-DATA-ENTRY-MKDOWN-OK         PIC S9(09)    COMP-3.    03960000
041000     05  PV-DATA-ENTRY-MKUP-IN           PIC S9(09)    COMP-3.    03970000
041100     05  PV-DATA-ENTRY-MKUP-SKP          PIC S9(09)    COMP-3.    03980000
041200     05  PV-DATA-ENTRY-MKUP-OK           PIC S9(09)    COMP-3.    03990000
041300     05  PV-DATA-ENTRY-PURCH-IN          PIC S9(09)    COMP-3.    04000000
041400     05  PV-DATA-ENTRY-PURCH-ERR         PIC S9(09)    COMP-3.    04010000
041500     05  PV-DATA-ENTRY-PURCH-SKP         PIC S9(09)    COMP-3.    04020000
041600     05  PV-DATA-ENTRY-PURCH-OK          PIC S9(09)    COMP-3.    04030000
041700     05  PV-DATA-ENTRY-SALES-CORR-IN     PIC S9(09)    COMP-3.    04040000
041800     05  PV-DATA-ENTRY-SALES-CORR-ERR    PIC S9(09)    COMP-3.    04050000
041900     05  PV-DATA-ENTRY-SALES-CORR-SKP    PIC S9(09)    COMP-3.    04060000
042000     05  PV-DATA-ENTRY-SALES-CORR-OK     PIC S9(09)    COMP-3.    04070000
042100                                                                  04080000
042200     05  PV-PHYS-INVEN-ADJ-IN            PIC S9(09)    COMP-3.    04090000
042300     05  PV-PHYS-INVEN-ADJ-ERR           PIC S9(09)    COMP-3.    04100000
042400     05  PV-PHYS-INVEN-ADJ-SKP           PIC S9(09)    COMP-3.    04110000
042500     05  PV-PHYS-INVEN-ADJ-OK            PIC S9(09)    COMP-3.    04120000
042600                                                                  04130000
21591      05  PV-IN-TRANSIT-ADJ-IN            PIC S9(09)    COMP-3.    04090000
21591      05  PV-IN-TRANSIT-ADJ-ERR           PIC S9(09)    COMP-3.    04100000
21591      05  PV-IN-TRANSIT-ADJ-SKP           PIC S9(09)    COMP-3.    04110000
21591      05  PV-IN-TRANSIT-ADJ-OK            PIC S9(09)    COMP-3.    04120000
21591                                                                   04130000
043200     05  PV-STORE-TRANSFER-IN            PIC S9(09)    COMP-3.    04190000
043300     05  PV-STORE-TRANSFER-ERR           PIC S9(09)    COMP-3.    04200000
043400     05  PV-STORE-TRANSFER-SKP           PIC S9(09)    COMP-3.    04210000
043500     05  PV-STORE-TRANSFER-OK            PIC S9(09)    COMP-3.    04220000
043600                                                                  04230000
043700     05  PV-AP-TRANS-CDE                 PIC X(2).                04240000
043800         88  PV-AP-TRANS-CDE-RECEIPT              VALUE '01'.     04250000
043900         88  PV-AP-TRANS-CDE-TRANSFER                             04260000
044000                                                  VALUE '52' '53' 04270000
B32898                                                        '54' '55' 04280000
B32898                                                        'Z1' 'Z2' 04280000
W34517                                                        'Z3' 'Z4' 04280000
W34517                                                        'Z5' 'Z6' 04280000
W34517                                                        'Z7' 'Z8'.04280000
W34309                                                                  04270000
W34309         88  PV-AP-TRANS-CDE-GIVEBACK             VALUE '4G' '4H' 04260000
W34309                                                        '4J' '4K' 04270000
W34309                                                        '6P' '6Q' 04270000
W34309                                                        '6R' '6S'.04270000
W34309                                                                  04270000
W34309         88  PV-AP-TRANS-CDE-GB-DOMESTIC          VALUE '4J' '4K' 04260000
W34309                                                        '6R' '6S'.04260000
W34309                                                                  04270000
W34309         88  PV-AP-TRANS-CDE-GB-IMPORT            VALUE '4G' '4H' 04260000
W34309                                                        '6P' '6Q'.04260000
W34309                                                                  04270000
W34309                                                                  04270000
044600     05  PV-ISO-DTE                      PIC X(10).               04480000
045400                                                                  04560000
045500     05  PV-PROCESS-DATE                 PIC X(10).               04571099
045600     05  PV-PROCESS-DATEX REDEFINES      PV-PROCESS-DATE.         04580000
045700         10  PV-PROC-CC                  PIC 9(02).               04590000
045800         10  PV-PROC-YY                  PIC 9(02).               04600000
045900         10  FILLER                      PIC X(01).               04610000
046000         10  PV-PROC-MM                  PIC 9(02).               04620000
046100         10  FILLER                      PIC X(01).               04630000
046200         10  PV-PROC-DD                  PIC 9(02).               04640000
046300                                                                  04650000
047100     05  PV-PARAGRAPH-NAME               PIC X(30).               04730000
           05  PV-RTL-AMT                      PIC S9(09)V99 COMP-3.    05121099
W21731     05  PV-OPERATION-ATTEMPTED          PIC  X(30) VALUE SPACES.         
W21731*    NEW SKU                                                      05121099
W21731     05  PV-HOLD-SKU                   PIC S9(08)  VALUE ZEROES.  05121099
W21731     05  PV-HOLD-SKU-XREF              PIC S9(08)V COMP-3.        05121099
W21731     05  PV-NEW-SKU-MCL.                                          05121099
W21731         10  FILLER                    PIC 9(02)   VALUE ZEROS.   05121099
W21731         10  PV-NEW-SKU-MAJ-CLASS      PIC 9(01).                 05121099
W21731         10  FILLER                    PIC 9(01)   VALUE ZEROS.   05121099
W21731     05  PV-SAVE-DEPT-CLASS-ATTR.                                 05121099
W21731         10  PV-SAVE-DEPT-CLASS.                                  05121099
W21731             15  PV-SAVE-DEPT          PIC  9(03)  VALUE ZEROS.   05121099
W21731             15  PV-SAVE-SCL           PIC  9(02)  VALUE ZEROS.   05121099
W21731         10  PV-SAVE-MAJ-CL            PIC  9(04)  VALUE ZEROS.   05121099
W26603     05  PV-EXPND-STORE-NBR            PIC 9(05)   VALUE ZEROS.   03180000
W26603     05  PV-EDIT-SKU-NBR               PIC 9(08)   VALUE ZEROS.           
W26603     05  PV-EDIT-SKU-NBR-ALPHA REDEFINES                                  
W26603         PV-EDIT-SKU-NBR               PIC X(08).                         
W26603     05  PV-EDIT-INHSE-NBR             PIC X(05).                         
W26603     05  PV-EDIT-INHSE-NBR-NUM REDEFINES                                  
W26603         PV-EDIT-INHSE-NBR             PIC 9(05).                         
W26603                                                                  24580000
W31475     05   PV-WORK-SKU                  PIC S9(08)V  VALUE ZEROES.         
W31475     05   PV-SKU-ENT-ID                PIC S9(09)   VALUE ZEROES.         
W31475     05   PV-WORK-DEPT-3X              PIC X(03).                         
W31475     05   PV-WORK-INHOUSE              PIC S9(03)V  VALUE ZEROES.         
W31475     05   PV-DEPT-ENT-ID               PIC S9(09)   VALUE ZEROES.         
W31475     05   PV-EFF-DTE-IN1               PIC X(10)    VALUE SPACES.         
W31475     05   PV-SKU-RETURN-CDE            PIC S9(04)   VALUE ZEROES.         
W31475     05   PV-DEPT-RETURN-CDE           PIC S9(04)   VALUE ZEROES.         
051200 01  PS-SWITCHES.                                                 05140000
051300     05  PS-ERROR-SW                   PIC X       VALUE 'N'.     05150000
051400         88  PS-NO-ERROR                           VALUE 'N'.     05160000
051500         88  PS-ERROR                              VALUE 'Y'.     05170000
051600     05  DATE-ERROR-SW                 PIC X(01)   VALUE 'N'.     05180000
051700         88  NO-DATE-ERROR                         VALUE 'N'.     05190000
051800         88  DATE-ERROR                            VALUE 'Y'.     05200000
051900     05  RECEIPTS-FILE-SW              PIC X       VALUE 'N'.     05210000
052000         88  END-OF-RECEIPTS-FILE                  VALUE 'Y'.     05220000
052100     05  DATA-ENTRY-PURCH-FILE-SW      PIC X       VALUE 'N'.     05230000
052200         88  END-OF-DATA-ENTRY-PURCH-FILE          VALUE 'Y'.     05240000
052300     05  PURCH-ADJ-FILE-SW             PIC X       VALUE 'N'.     05250000
052400         88  END-OF-PURCH-ADJ-FILE                 VALUE 'Y'.     05260000
052500     05  AP-COSTS-FILE-SW              PIC X       VALUE 'N'.     05270000
052600         88  END-OF-AP-COSTS-FILE                  VALUE 'Y'.     05280000
052700     05  REGISTER-SALES-FILE-SW        PIC X       VALUE 'N'.     05290000
052800         88  END-OF-REGISTER-SALES-FILE            VALUE 'Y'.     05300000
052900     05  SALES-CORR-FILE-SW            PIC X       VALUE 'N'.     05310000
053000         88  END-OF-SALES-CORR-FILE                VALUE 'Y'.     05320000
053100     05  PERM-PRC-CHG-FILE-SW          PIC X       VALUE 'N'.     05330000
053200         88  END-OF-PERM-PRC-CHG-FILE              VALUE 'Y'.     05340000
053300     05  PROMO-PRC-CHG-FILE-SW         PIC X       VALUE 'N'.     05350000
053400         88  END-OF-PROMO-PRC-CHG-FILE             VALUE 'Y'.     05360000
053500     05  DATA-ENTRY-PRC-CHG-FILE-SW    PIC X       VALUE 'N'.     05370000
053600         88  END-OF-DATA-ENTRY-PRC-CHG-FILE        VALUE 'Y'.     05380000
053700     05  PHYS-INVEN-ADJ-FILE-SW        PIC X       VALUE 'N'.     05390000
053800         88  END-OF-PHYS-INVEN-ADJ-FILE            VALUE 'Y'.     05400000
21591      05  IN-TRANSIT-ADJ-FILE-SW        PIC X       VALUE 'N'.     05390000
21591          88  END-OF-IN-TRANSIT-ADJ-FILE            VALUE 'Y'.     05400000
054100     05  STORE-TRANSFER-FILE-SW        PIC X       VALUE 'N'.     05430000
054200         88  END-OF-STORE-TRANSFER-FILE            VALUE 'Y'.     05440000
054300     05  SKIP-CLASS-FILE-SW            PIC X       VALUE 'N'.     05450000
054400         88  END-OF-SKIP-CLASS-FILE                VALUE 'Y'.     05460000
054500     05  CNTL-DATE-FILE-SW             PIC X       VALUE 'N'.     05470000
054600         88  END-OF-CNTL-DTE-FILE                  VALUE 'Y'.     05480000
055500                                                                  05570000
055600 01  PC-PROGRAM-CONSTANTS.                                        05580000
W21731     05  PC-PROGRAM-NAME             PIC  X(8)   VALUE 'MLKUP020'.05630000
056100     05  PC-MORE-THAN-MAX-RETRY          PIC S9(4)   VALUE +4.    05630000
056200     05  PC-END-OF-REPORT                PIC  X(133) VALUE        05640000
056300         '-*** END OF REPORT ***'.                                05650000
056400     05  PC-MAX-SKIP-RECS                PIC S9(4)   VALUE +999.  05660000
056500     05  PC-AP-TRANS-CDE-TRANSFER        PIC  X(2)   VALUE '54'.  05670000
056600     05  PC-TYP-CDE-TRANSFER             PIC  X      VALUE '2'.   05680000
056700     05  PC-DPKUT500                     PIC  X(08)  VALUE        05690000
056800         'DPKUT500'.                                              05700000
056810     05  PC-SALES-CORR-TYPE              PIC  X(01)  VALUE 'O'.   05710000
W21731     05  PC-D09910-PC-ATTR          PIC  X(09)  VALUE '099100010'.05710000
B32898     05  PC-Z1                           PIC  X(02)  VALUE 'Z1'.  05710000
B32898     05  PC-Z2                           PIC  X(02)  VALUE 'Z2'.  05710000
B32898     05  PC-Z3                           PIC  X(02)  VALUE 'Z3'.  05710000
B32898     05  PC-Z4                           PIC  X(02)  VALUE 'Z4'.  05710000
B32898     05  PC-Z5                           PIC  X(02)  VALUE 'Z5'.  05710000
B32898     05  PC-Z6                           PIC  X(02)  VALUE 'Z6'.  05710000
W34517     05  PC-Z7                           PIC  X(02)  VALUE 'Z7'.  05710000
W34517     05  PC-Z8                           PIC  X(02)  VALUE 'Z8'.  05710000
W34309     05  PC-2230                      PIC S9(4) COMP VALUE  2230. 05710000
W34309     05  PC-IMPORT-VENDOR            PIC S9(9) COMP VALUE 103067. 05710000
W34309     05  PC-DOMESTIC-VENDOR          PIC S9(9) COMP VALUE 103066. 05710000
057000 01  PV-PROGRAM-VARIBLES.                                         05730000
057100     05  PV-SYSTEM-ORIGINATION.                                   05740000
057200         10  PV-SYST-ORIGIN              PIC X(2).                05750000
057300         10  PV-SYST-ORIGIN-DESC         PIC X(20).               05760000
057400     05  FILLER REDEFINES PV-SYSTEM-ORIGINATION                   05770000
057500                                         PIC X(22).               05780000
057600         88  PV-ACCOUNTS-PAYABLE         VALUE                    05790000
057700            '01ACCOUNTS PAYABLE    '.                             05800000
057800         88  PV-DATA-ENTRY               VALUE                    05810000
057900            '02DATA ENTRY          '.                             05820000
058000         88  PV-POS                      VALUE                    05830000
058100            '03POS                 '.                             05840000
058200         88  PV-PERM                     VALUE                    05850000
058300            '04PERM                '.                             05860000
058400         88  PV-PROMO                    VALUE                    05870000
058500            '05PROMO               '.                             05880000
058600         88  PV-PHYSICAL-INVENTORY       VALUE                    05890000
058700            '06PHYSICAL INVENTORY  '.                             05900000
058800         88  PV-MERCHANDISE-LEDGER       VALUE                    05910000
058900            '07MERCHANDISE LEDGER  '.                             05920000
058800         88  PV-RECEIPTS                 VALUE                    05930000
058900            '08RECEIPTS            '.                             05940000
059000                                                                  05950000
059100     05  PV-TRANSACTION-TYPE.                                     05960000
059200         10  PV-TRAN-TYPE                PIC X(2).                05970000
059300         10  PV-TRAN-TYPE-DESC           PIC X(20).               05980000
059400     05  FILLER REDEFINES PV-TRANSACTION-TYPE                     05990000
059500                                         PIC X(22).               06000000
059600         88  PV-PURCHASE                 VALUE                    06010000
059700            '10PURCHASE            '.                             06020000
059800         88  PV-SALE                     VALUE                    06030000
059900            '20SALE                '.                             06040000
060000         88  PV-STORE-TRANSFER           VALUE                    06050000
060100            '30STORE TRANSFER      '.                             06060000
060200         88  PV-MKDOWN                   VALUE                    06070000
060300            '40MARKDOWN            '.                             06080000
060400         88  PV-MKUP                     VALUE                    06090000
060500            '50MARKUP              '.                             06100000
060600         88  PV-ADJUSTMENT               VALUE                    06110000
060700            '80ADJUSTMENT          '.                             06120000
060800     05  PV-JRNL-IND                     PIC X(01).               06130000
060900         88  PV-JRNL-YES                 VALUE  'Y'.              06140000
061000         88  PV-JRNL-NO                  VALUE  'N'.              06150000
061100                                                                  06160000
061200 01  DISPLAYED-HEADINGS.                                          06170000
061300     05  DH-TITLE                        PIC X(80).               06180000
061400         88  DH-COUNT-BY-SOURCE          VALUE                    06190000
061500            'MLKUP020 - COUNTS BY SOURCE SYSTEM:'.                06200000
061600         88  DH-COUNT-BY-TRAN-TYPE       VALUE                    06210000
061700            'MLKUP020 - COUNTS BY TRANSACTION-TYPE:'.             06220000
061800                                                                  06230000
061900     05  DH-HEADING.                                              06240000
062000         10  FILLER                      PIC X(30) VALUE SPACES.  06250000
062100         10  FILLER                      PIC X(11) VALUE          06260000
062200            'INPUT'.                                              06270000
062300         10  FILLER                      PIC X(06) VALUE          06280000
062400            'ERROR'.                                              06290000
062500         10  FILLER                      PIC X(13) VALUE          06300000
062600            'SKIP CLASS'.                                         06310000
062700         10  FILLER                      PIC X(11) VALUE          06320000
062800            'ACCEPTED'.                                           06330000
063100                                                                  06360000
063200     05  DL-DETAIL.                                               06370000
063300         10  FILLER                      PIC X(04).               06380000
063400         10  DL-DESC                     PIC X(20).               06390000
063500*        10  DL-DESC                     PIC X(27).               06400000
063600             88  DT1                     VALUE                    06410000
063700            'PERM PRICE CHANGES  '.                               06420000
063800             88  DT2                     VALUE                    06430000
063900            '    MARKDOWNS       '.                               06440000
064000             88  DT3                     VALUE                    06450000
064100            '    MARKUPS         '.                               06460000
064200             88  DT4                     VALUE                    06470000
064300            'PROMO PRICE CHANGES '.                               06480000
064400             88  DT5                     VALUE                    06490000
064500            '    MARKDOWNS       '.                               06500000
064600             88  DT6                     VALUE                    06510000
064700            '    MARKUPS         '.                               06520000
064800             88  DT7                     VALUE                    06530000
064900            'RECEIPTS            '.                               06540000
065000             88  DT8                     VALUE                    06550000
065100            'PURCHASE ADJS       '.                               06560000
065200             88  DT9                     VALUE                    06570000
065300            'PURCHASE COST ADJS  '.                               06580000
065400             88  DT10                    VALUE                    06590000
065500            'REGISTER SALES      '.                               06600000
065600             88  DT11                    VALUE                    06610000
065700            'COSA SALES CORRECTS '.                               06620099
065600             88  DT12                    VALUE                    06621099
065700            'DATA ENTRY          '.                               06622099
065800             88  DT13                    VALUE                    06630099
065900            '    MARKDOWNS       '.                               06640000
066000             88  DT14                    VALUE                    06650099
066100            '    MARKUPS         '.                               06660000
066200             88  DT15                    VALUE                    06670099
066300            '    PURCHASES       '.                               06680000
066400             88  DT16                    VALUE                    06690099
066500            '    SALES CORRECTS  '.                               06700000
066600             88  DT17                    VALUE                    06710099
066700            '    TRANSFERS       '.                               06720000
066800             88  DT18                    VALUE                    06730099
066900            'PHYS INVENTORY ADJMT'.                               06740000
067200             88  DT20                    VALUE                    06770099
067300            'MARKDOWNS           '.                               06780000
067400             88  DT21                    VALUE                    06790099
067500            'MARKUPS             '.                               06800000
067600             88  DT22                    VALUE                    06810099
067700            'SALES               '.                               06820000
067800             88  DT23                    VALUE                    06830099
067900            'PURCHASES           '.                               06840000
068000             88  DT24                    VALUE                    06850099
068100            'TRANSFERS           '.                               06860000
068200             88  DT25                    VALUE                    06870099
068300            'ADJUSTMENTS         '.                               06880000
21591              88  DT26                    VALUE                    06870099
21591             'IN-TRANSIT REVERSAL '.                               06880000
068400         10  FILLER                      PIC X(01).               06890000
068500         10  DL-INPUT                    PIC ZZ,ZZZ,ZZ9.          06900000
068600         10  FILLER                      PIC X(01)   VALUE SPACES.06910000
068700         10  DL-ERROR                    PIC ZZ,ZZZ,ZZZ.          06920000
068800         10  FILLER                      PIC X(01)   VALUE SPACES.06930000
068900         10  DL-SKIP-CLASS               PIC ZZ,ZZZ,ZZZ.          06940000
069000         10  FILLER                      PIC X(01)   VALUE SPACES.06950000
069100         10  DL-ACCEPTED                 PIC ZZ,ZZZ,ZZ9.          06960000
069200         10  FILLER                      PIC X(01)   VALUE SPACES.06970000
069600                                                                  07010000
069700***************************************************************** 07020000
069800*  WORK AREA PASSED IN CALL TO DPKUT500                          *07030000
069900***************************************************************** 07040000
070000     COPY DPWS500.                                                07050000
070100                                                                  07060000
070800***************************************************************** 07130000
070900*  STANDARD 133 BYTE REPORT HEADINGS                             *07140000
071000***************************************************************** 07150000
071100     COPY DPWS133O.                                               07160000
071200 01  HEADER2.                                                     07170000
071300     05  FILLER                  PIC X(47)   VALUE SPACES.        07180000
071400     05  FILLER                  PIC X(40)   VALUE                07190000
071500         'INVENTORY TRANSACTION LOAD ERRORS'.                     07200000
071600     05  FILLER                  PIC X(46)   VALUE SPACES.        07210000
071700                                                                  07220000
071800 01  HEADER3.                                                     07230000
071900     05  FILLER                  PIC X(01)   VALUE '0'.           07240000
072000     05  FILLER                  PIC X(04)   VALUE 'CODE'.        07250000
072100     05  FILLER                  PIC X(06)   VALUE SPACES.        07260000
072200     05  FILLER                  PIC X(21)   VALUE 'SOURCE'.      07270000
072300     05  FILLER                  PIC X(26)   VALUE 'REASON'.      07280000
072400     05  FILLER                  PIC X(80)   VALUE 'RECORD DATA'. 07290000
072500                                                                  07300000
072600 01  ERROR-LINE.                                                  07310000
072700     05  FILLER                  PIC X(02)   VALUE '0'.           07320000
072800     05  EL-CODE                 PIC X(01).                       07330000
072900     05  FILLER                  PIC X(05)   VALUE SPACES.        07340000
073000     05  EL-SOURCE               PIC X(17).                       07350000
073100     05  FILLER                  PIC X(01)   VALUE SPACES.        07360000
073200     05  EL-REASON               PIC X(25).                       07370000
073300     05  FILLER                  PIC X(01)   VALUE SPACES.        07380000
073400     05  EL-DATA                 PIC X(80).                       07390000
073500                                                                  07400000
073600 01  ABEND-CODE                          PIC S9(04)  VALUE +0     07410000
073700                                                     COMP SYNC.   07420000
W21731     EXEC SQL                                                             
W21731         INCLUDE SQLCA                                                    
W21731     END-EXEC.                                                            
                                                                                
26006 *01  ML501-PV-PROGRAM-VARIABLE.                                           
26006 *    TSKXREF                                                              
26006 *    TUPC                                                                 
26006 *    TVNDSTL                                                              
26006 *    TVNDDPT                                                              
26006      COPY MLWS501.                                                        
                                                                                
W21731                                                                          
077500 EJECT                                                            07810000
077600 PROCEDURE DIVISION.                                              07820000
077700                                                                  07830000
077800 A100-MAIN-MODULE.                                                07840000
077900******************************************************************07850000
078000*  MAIN PROCESSING.                                               07860000
078100******************************************************************07870000
078200                                                                  07880000
078300     PERFORM B100-HOUSEKEEPING.                                   07890000
078400                                                                  07900000
078500     PERFORM C100-PROCESS-INPUT-FILES.                            07910000
078600                                                                  07920000
078700     PERFORM B300-EOJ.                                            07930000
078800                                                                  07940000
TEMP       DISPLAY 'NBR OF SQL CALLS TO TSKXREF : ', PV-XREF-SQL-CALLS. 07940000
078800                                                                  07940000
078800                                                                  07940000
078900     STOP RUN.                                                    07950000
079000*                                                                 07960000
079100 B100-HOUSEKEEPING.                                               07970000
079200******************************************************************07980000
079300******************************************************************07990000
079400                                                                  08000000
079500     OPEN  INPUT SKIP-CLASS-FILE                                  08010000
079600                 CNTL-DATE-FILE                                   08020000
079800          OUTPUT COMPOSITE-FILE                                   08040000
079900                 REJECT-FILE                                      08050000
080100                 CL-DEPT-REJECT-FILE                              08070099
080100                 ERROR-REPORT.                                    08071099
080200                                                                  08080000
080300     INITIALIZE PV-PROGRAM-VARIABLES                              08090000
080400                SKIP-CLASS-TABLE.                                 08100000
W31475     MOVE HIGH-VALUES  TO  SKIP-CLASS-TABLE.                      08110000
080500                                                                  08110000
080600     MOVE 'N'   TO   RECEIPTS-FILE-SW                             08120000
080700                     DATA-ENTRY-PURCH-FILE-SW                     08130000
080800                     PURCH-ADJ-FILE-SW                            08140000
080900                     AP-COSTS-FILE-SW                             08150000
081000                     REGISTER-SALES-FILE-SW                       08160000
081100                     SALES-CORR-FILE-SW                           08170000
081200                     PERM-PRC-CHG-FILE-SW                         08180000
081300                     PROMO-PRC-CHG-FILE-SW                        08190000
081400                     DATA-ENTRY-PRC-CHG-FILE-SW                   08200000
081500                     PHYS-INVEN-ADJ-FILE-SW                       08210000
21591                      IN-TRANSIT-ADJ-FILE-SW                       08210000
081700                     STORE-TRANSFER-FILE-SW                       08230000
081800                     SKIP-CLASS-FILE-SW.                          08240000
081900                                                                  08250000
082000     PERFORM B110-READ-SKIP-CLASS-FILE.                           08260000
082100                                                                  08270000
082200     PERFORM VARYING SKIP-IDX FROM +1 BY +1                       08280000
082300       UNTIL SKIP-IDX > PC-MAX-SKIP-RECS  OR                      08290000
082400             END-OF-SKIP-CLASS-FILE                               08300000
082500                                                                  08310000
082600         IF SKIP-CLASS-NBR NUMERIC                                08320000
082700             CONTINUE                                             08330000
082800         ELSE                                                     08340000
082900             DISPLAY '** PROGRAM ABEND **'                        08350000
083000             DISPLAY 'MLKUP020  - INVALID CONTROL CARD'           08360000
083100             DISPLAY '            CLASS NUMBER NOT NUMERIC'       08370000
083200             MOVE +4003              TO ABEND-CODE                08380000
083300             PERFORM Z999-ABEND                                   08390000
083400         END-IF                                                   08400000
083500                                                                  08410000
083600         MOVE SKIP-CLASS-NBR TO SKIP-CLASS (SKIP-IDX)             08420000
083700         PERFORM B110-READ-SKIP-CLASS-FILE                        08430000
083800                                                                  08440000
083900     END-PERFORM.                                                 08450000
084000                                                                  08460000
084100     IF SKIP-IDX > PC-MAX-SKIP-RECS                               08470000
084200         DISPLAY '** PROGRAM ABEND **'                            08480000
084300         DISPLAY 'MLKUP020  - SKIP-CLASS SIZE EXCEEDED'           08490000
084400         MOVE +4004              TO ABEND-CODE                    08500000
084500         PERFORM Z999-ABEND                                       08510000
084600     END-IF.                                                      08520000
084700                                                                  08530000
084800     PERFORM B120-PROCESS-CNTL-DATE                               08540000
085000     ACCEPT CPU-DATE FROM DATE.                                   08560000
085100     MOVE CPU-YEAR   TO DP133O-RUN-YEAR                           08570000
085200     MOVE CPU-MONTH  TO DP133O-RUN-MONTH                          08580000
085300     MOVE CPU-DAY    TO DP133O-RUN-DAY                            08590000
085400                                                                  08600000
085500     ACCEPT CPU-TIME FROM TIME.                                   08610000
085600     MOVE CPU-HOUR   TO DP133O-RUN-HOUR.                          08620000
085700     MOVE CPU-MINUTE TO DP133O-RUN-MINUTE.                        08630000
085800     MOVE 'MLKUP020' TO DP133O-PROGRAM-NAME.                      08640000
085900                                                                  08650000
086000     PERFORM Z998-WRITE-HEADINGS.                                 08660099
086600                                                                  08720000
086700     EJECT.                                                       08730000
086800                                                                  08740000
086900 B120-PROCESS-CNTL-DATE.                                          08750000
087000                                                                  08760000
087100     MOVE 'B120-PROCESS-CNTL-DATE' TO PV-PARAGRAPH-NAME.          08770000
087200                                                                  08780000
087300     READ CNTL-DATE-FILE INTO CC-CONTROL-CARD                     08790000
087400         AT END                                                   08800000
087500             DISPLAY '** PROGRAM ABEND **'                        08810000
087600             DISPLAY 'MLKUP020  - CONTROL DATE EMPTY'             08820000
087700             MOVE +4003              TO ABEND-CODE                08830000
087800             PERFORM Z999-ABEND.                                  08840000
087900                                                                  08850000
088000     DISPLAY '** MLKUP020 CONTROL CARD:' CNTL-DATE-REC            08860000
088100                                                                  08870000
088200     MOVE CC-PROC-DATE-ISO TO PV-ISO-DTE                          08880000
088300                                                                  08890000
088400     PERFORM Z220-SPECIAL-DATE-CALL                               08900000
088500                                                                  08910000
088600     IF  DATE-ERROR                                               08920000
088700         DISPLAY '** PROGRAM ABEND **'                            08930000
088800         DISPLAY 'MLKUP020  - INVALID CONTROL DATE CARD: '        08940000
088900             CNTL-DATE-REC                                        08950000
089000         MOVE +4003              TO ABEND-CODE                    08960000
089100         PERFORM Z999-ABEND.                                      08970000
089200                                                                  08980000
089300     IF  NOT CC-PROCESSING-MODE-VALID                             08990000
089400         DISPLAY '** ABEND **'                                    09000000
089500         DISPLAY '** PROGRAM MLKUP020 **'                         09010000
089600         DISPLAY '** PARAGRAPH ' PV-PARAGRAPH-NAME                09020000
089700         IF CC-PROCESSING-MODE = SPACE                            09030000
089800             DISPLAY '** PROCESSING MODE ON CONTROL CARD IS BLANK'09040000
089900         ELSE                                                     09050000
090000             DISPLAY '** INVALID PROCESSING MODE ON CONTROL CARD:'09060000
090100                      CC-PROCESSING-MODE                          09070000
090200         END-IF                                                   09080000
090300         MOVE +4003 TO ABEND-CODE                                 09090000
090400         PERFORM Z999-ABEND.                                      09100000
090500                                                                  09110000
090600     IF  NOT CC-CHECK-INV-DATES-SW-VALID                          09120000
090700         DISPLAY '** ABEND **'                                    09130000
090800         DISPLAY '** PROGRAM MLKUP020 **'                         09140000
090900         DISPLAY '** PARAGRAPH ' PV-PARAGRAPH-NAME                09150000
091000         IF CC-CHECK-INV-DATES-SW = SPACE                         09160000
091100             DISPLAY '** CHECK-INV-DATES-SWITCH ON CONTROL CARD IS09170000
091200-                    ' BLANK'                                     09180000
091300         ELSE                                                     09190000
091400             DISPLAY '** INVALID CHECK-INV-DATES-SWITCH ON CONTROL09200000
091500-                    ' CARD:' CC-CHECK-INV-DATES-SW               09210000
091600         END-IF                                                   09220000
091700         MOVE +4003 TO ABEND-CODE                                 09230000
091800         PERFORM Z999-ABEND.                                      09240000
091900                                                                  09250000
092000     MOVE DPG55-DB2-ISO-DATE-FMT   TO PV-PROCESS-DATE.            09260099
092700                                                                  09330000
092900                                                                  09350000
120600 B110-READ-SKIP-CLASS-FILE.                                       12120000
120700                                                                  12130000
120800     READ SKIP-CLASS-FILE INTO SKIP-CLASS-RECORD                  12140000
120900        AT END                                                    12150000
121000           SET END-OF-SKIP-CLASS-FILE TO TRUE.                    12160000
121100                                                                  12170000
121200 B300-EOJ.                                                        12180000
121300******************************************************************12190000
121400*    CLOSE THE FILES AND DISPLAY COUNTS                           12200000
121500******************************************************************12210000
121600                                                                  12220000
121700     MOVE PC-END-OF-REPORT TO ERROR-LINE                          12230000
121800     PERFORM Z910-WRITE-ERROR-REPORT.                             12240000
121900     CLOSE SKIP-CLASS-FILE                                        12250000
122000           CNTL-DATE-FILE                                         12260000
122200           COMPOSITE-FILE                                         12280000
122300           REJECT-FILE                                            12290000
122500           CL-DEPT-REJECT-FILE                                    12310099
122500           ERROR-REPORT.                                          12311099
122600     PERFORM B320-DISPLAY-COUNTS-BY-SOURCE.                       12320000
122700     PERFORM B330-DISPLAY-COUNTS-BY-TRAN-TP.                      12330000
122800                                                                  12340000
122900 B320-DISPLAY-COUNTS-BY-SOURCE.                                   12350000
123000                                                                  12360000
123100     MOVE ALL '*' TO DH-TITLE                                     12370000
123200     DISPLAY DH-TITLE                                             12380000
123300     SET DH-COUNT-BY-SOURCE            TO TRUE                    12390000
123400     DISPLAY DH-TITLE                                             12400000
123500     DISPLAY ' '                                                  12410000
123600     DISPLAY ' '                                                  12420000
123700     DISPLAY DH-HEADING                                           12430000
123800     DISPLAY ' '                                                  12440000
123900                                                                  12450000
124000     INITIALIZE DL-DETAIL                                         12460000
124100     MOVE   PV-PERM-PRC-CHG-IN         TO DL-INPUT                12470000
124200     MOVE   PV-PERM-PRC-CHG-ERR        TO DL-ERROR                12480000
124300     MOVE   PV-PERM-PRC-CHG-SKP        TO DL-SKIP-CLASS           12490000
124400     MOVE   PV-PERM-PRC-CHG-OK         TO DL-ACCEPTED             12500000
124600                                                                  12520000
124700     SET DT1 TO TRUE                                              12530000
124800     DISPLAY DL-DETAIL                                            12540000
124900                                                                  12550000
125000     INITIALIZE DL-DETAIL                                         12560000
125100     MOVE   PV-PERM-PRC-CHG-MKDOWN-IN  TO DL-INPUT                12570000
125200     MOVE   PV-PERM-PRC-CHG-MKDOWN-SKP TO DL-SKIP-CLASS           12580000
125300     MOVE   PV-PERM-PRC-CHG-MKDOWN-OK  TO DL-ACCEPTED             12590000
125500                                                                  12610000
125600     SET DT2 TO TRUE                                              12620000
125700     DISPLAY DL-DETAIL                                            12630000
125800                                                                  12640000
125900     INITIALIZE DL-DETAIL                                         12650000
126000     MOVE   PV-PERM-PRC-CHG-MKUP-IN    TO DL-INPUT                12660000
126100     MOVE   PV-PERM-PRC-CHG-MKUP-SKP   TO DL-SKIP-CLASS           12670000
126200     MOVE   PV-PERM-PRC-CHG-MKUP-OK    TO DL-ACCEPTED             12680000
126400                                                                  12700000
126500     SET DT3 TO TRUE                                              12710000
126600     DISPLAY DL-DETAIL                                            12720000
126700                                                                  12730000
126800     INITIALIZE DL-DETAIL                                         12740000
126900     MOVE   PV-PROMO-PRC-CHG-IN        TO DL-INPUT                12750000
127000     MOVE   PV-PROMO-PRC-CHG-ERR       TO DL-ERROR                12760000
127100     MOVE   PV-PROMO-PRC-CHG-SKP       TO DL-SKIP-CLASS           12770000
127200     MOVE   PV-PROMO-PRC-CHG-OK        TO DL-ACCEPTED             12780000
127400                                                                  12800000
127500     SET DT4 TO TRUE                                              12810000
127600     DISPLAY DL-DETAIL                                            12820000
127700                                                                  12830000
127800     INITIALIZE DL-DETAIL                                         12840000
127900     MOVE   PV-PROMO-PRC-CHG-MKDOWN-IN  TO DL-INPUT               12850000
128000     MOVE   PV-PROMO-PRC-CHG-MKDOWN-SKP TO DL-SKIP-CLASS          12860000
128100     MOVE   PV-PROMO-PRC-CHG-MKDOWN-OK  TO DL-ACCEPTED            12870000
128300                                                                  12890000
128400     SET DT5 TO TRUE                                              12900000
128500     DISPLAY DL-DETAIL                                            12910000
128600                                                                  12920000
128700     INITIALIZE DL-DETAIL                                         12930000
128800     MOVE   PV-PROMO-PRC-CHG-MKUP-IN   TO DL-INPUT                12940000
128900     MOVE   PV-PROMO-PRC-CHG-MKUP-SKP  TO DL-SKIP-CLASS           12950000
129000     MOVE   PV-PROMO-PRC-CHG-MKUP-OK   TO DL-ACCEPTED             12960000
129200                                                                  12980000
129300     SET DT6 TO TRUE                                              12990000
129400     DISPLAY DL-DETAIL                                            13000000
129500                                                                  13010000
129600     INITIALIZE DL-DETAIL                                         13020000
129700     MOVE   PV-RECEIPTS-IN             TO DL-INPUT                13030000
129800     MOVE   PV-RECEIPTS-ERR            TO DL-ERROR                13040000
129900     MOVE   PV-RECEIPTS-SKP            TO DL-SKIP-CLASS           13050000
130000     MOVE   PV-RECEIPTS-OK             TO DL-ACCEPTED             13060000
130200                                                                  13080000
130300     SET DT7 TO TRUE                                              13090000
130400     DISPLAY DL-DETAIL                                            13100000
130500                                                                  13110000
130600     INITIALIZE DL-DETAIL                                         13120000
130700     MOVE   PV-PURCH-ADJ-IN            TO DL-INPUT                13130000
130800     MOVE   PV-PURCH-ADJ-ERR           TO DL-ERROR                13140000
130900     MOVE   PV-PURCH-ADJ-SKP           TO DL-SKIP-CLASS           13150000
131000     MOVE   PV-PURCH-ADJ-OK            TO DL-ACCEPTED             13160000
131200                                                                  13180000
131300     SET DT8 TO TRUE                                              13190000
131400     DISPLAY DL-DETAIL                                            13200000
131500                                                                  13210000
131600     INITIALIZE DL-DETAIL                                         13220000
131700     MOVE   PV-AP-COSTS-IN             TO DL-INPUT                13230000
131800     MOVE   PV-AP-COSTS-ERR            TO DL-ERROR                13240000
131900     MOVE   PV-AP-COSTS-SKP            TO DL-SKIP-CLASS           13250000
132000     MOVE   PV-AP-COSTS-OK             TO DL-ACCEPTED             13260000
132200                                                                  13280000
132300     SET DT9 TO TRUE                                              13290000
132400     DISPLAY DL-DETAIL                                            13300000
132500                                                                  13310000
132600     INITIALIZE DL-DETAIL                                         13320000
132700     MOVE   PV-REGISTER-SALES-IN         TO DL-INPUT              13330000
132800     MOVE   PV-REGISTER-SALES-ERR        TO DL-ERROR              13340000
132900     MOVE   PV-REGISTER-SALES-SKP        TO DL-SKIP-CLASS         13350000
133000     MOVE   PV-REGISTER-SALES-OK         TO DL-ACCEPTED           13360000
133200                                                                  13380000
133300     SET DT10 TO TRUE                                             13390000
133400     DISPLAY DL-DETAIL                                            13400000
133600                                                                  13420000
132600     INITIALIZE DL-DETAIL                                         13420199
132700     MOVE   PV-COSA-SALES-CORR-IN        TO DL-INPUT              13420299
132800     MOVE   PV-COSA-SALES-CORR-ERR       TO DL-ERROR              13420399
132900     MOVE   PV-COSA-SALES-CORR-SKP       TO DL-SKIP-CLASS         13420499
133000     MOVE   PV-COSA-SALES-CORR-OK        TO DL-ACCEPTED           13420599
133200                                                                  13420799
133300     SET DT11 TO TRUE                                             13420899
133400     DISPLAY DL-DETAIL                                            13420999
133600                                                                  13421099
133500     INITIALIZE DL-DETAIL                                         13422099
133700     COMPUTE PV-DATA-ENTRY-IN   =                                 13430000
133800            PV-DATA-ENTRY-PRC-CHG-IN      +                       13440000
133900            PV-DATA-ENTRY-PURCH-IN        +                       13450000
134000            PV-DATA-ENTRY-SALES-CORR-IN   +                       13460000
134100            PV-STORE-TRANSFER-IN                                  13470000
134200                                                                  13480000
134300     COMPUTE PV-DATA-ENTRY-ERR  =                                 13490000
134400            PV-DATA-ENTRY-PRC-CHG-ERR     +                       13500000
134500            PV-DATA-ENTRY-PURCH-ERR       +                       13510000
134600            PV-DATA-ENTRY-SALES-CORR-ERR  +                       13520000
134700            PV-STORE-TRANSFER-ERR                                 13530000
134800                                                                  13540000
134900     COMPUTE PV-DATA-ENTRY-SKP  =                                 13550000
135000            PV-DATA-ENTRY-PRC-CHG-SKP     +                       13560000
135100            PV-DATA-ENTRY-PURCH-SKP       +                       13570000
135200            PV-DATA-ENTRY-SALES-CORR-SKP  +                       13580000
135300            PV-STORE-TRANSFER-SKP                                 13590000
135400                                                                  13600000
135500     COMPUTE PV-DATA-ENTRY-OK   =                                 13610000
135600            PV-DATA-ENTRY-PRC-CHG-OK      +                       13620000
135700            PV-DATA-ENTRY-PURCH-OK        +                       13630000
135800            PV-DATA-ENTRY-SALES-CORR-OK   +                       13640000
135900            PV-STORE-TRANSFER-OK                                  13650000
136000                                                                  13660000
136100     MOVE   PV-DATA-ENTRY-IN           TO DL-INPUT                13670000
136200     MOVE   PV-DATA-ENTRY-ERR          TO DL-ERROR                13680000
136300     MOVE   PV-DATA-ENTRY-SKP          TO DL-SKIP-CLASS           13690000
136400     MOVE   PV-DATA-ENTRY-OK           TO DL-ACCEPTED             13700000
136600     SET DT12 TO TRUE                                             13720099
136700     DISPLAY DL-DETAIL                                            13730000
136800     INITIALIZE DL-DETAIL                                         13740000
136900                                                                  13750000
137000     MOVE   PV-DATA-ENTRY-MKDOWN-IN     TO DL-INPUT               13760000
137100     MOVE   PV-DATA-ENTRY-MKDOWN-SKP    TO DL-SKIP-CLASS          13770000
137200     MOVE   PV-DATA-ENTRY-MKDOWN-OK     TO DL-ACCEPTED            13780000
137400                                                                  13800000
137500     SET DT13 TO TRUE                                             13810099
137600     DISPLAY DL-DETAIL                                            13820000
137700     INITIALIZE DL-DETAIL                                         13830000
137800                                                                  13840000
137900     MOVE   PV-DATA-ENTRY-MKUP-IN      TO DL-INPUT                13850000
138000     MOVE   PV-DATA-ENTRY-MKUP-SKP     TO DL-SKIP-CLASS           13860000
138100     MOVE   PV-DATA-ENTRY-MKUP-OK      TO DL-ACCEPTED             13870000
138300                                                                  13890000
138400     SET DT14 TO TRUE                                             13900099
138500     DISPLAY DL-DETAIL                                            13910000
138600     INITIALIZE DL-DETAIL                                         13920000
138700                                                                  13930000
138800     MOVE   PV-DATA-ENTRY-PURCH-IN     TO DL-INPUT                13940000
138900     MOVE   PV-DATA-ENTRY-PURCH-ERR    TO DL-ERROR                13950000
139000     MOVE   PV-DATA-ENTRY-PURCH-SKP    TO DL-SKIP-CLASS           13960000
139100     MOVE   PV-DATA-ENTRY-PURCH-OK     TO DL-ACCEPTED             13970000
139300                                                                  13990000
139400     SET DT15 TO TRUE                                             14000099
139500     DISPLAY DL-DETAIL                                            14010000
139600     INITIALIZE DL-DETAIL                                         14020000
139700                                                                  14030000
139800     MOVE   PV-DATA-ENTRY-SALES-CORR-IN  TO DL-INPUT              14040000
139900     MOVE   PV-DATA-ENTRY-SALES-CORR-ERR TO DL-ERROR              14050000
140000     MOVE   PV-DATA-ENTRY-SALES-CORR-SKP TO DL-SKIP-CLASS         14060000
140100     MOVE   PV-DATA-ENTRY-SALES-CORR-OK  TO DL-ACCEPTED           14070000
140300                                                                  14090000
140400     SET DT16 TO TRUE                                             14100099
140500     DISPLAY DL-DETAIL                                            14110000
140600     INITIALIZE DL-DETAIL                                         14120000
140700                                                                  14130000
140800     MOVE   PV-STORE-TRANSFER-IN       TO DL-INPUT                14140000
140900     MOVE   PV-STORE-TRANSFER-ERR      TO DL-ERROR                14150000
141000     MOVE   PV-STORE-TRANSFER-SKP      TO DL-SKIP-CLASS           14160000
141100     MOVE   PV-STORE-TRANSFER-OK       TO DL-ACCEPTED             14170000
141300                                                                  14190000
141400     SET DT17 TO TRUE                                             14200099
141500     DISPLAY DL-DETAIL                                            14210000
141600     INITIALIZE DL-DETAIL                                         14220000
141700                                                                  14230000
141800     MOVE   PV-PHYS-INVEN-ADJ-IN       TO DL-INPUT                14240000
141900     MOVE   PV-PHYS-INVEN-ADJ-ERR      TO DL-ERROR                14250000
142000     MOVE   PV-PHYS-INVEN-ADJ-SKP      TO DL-SKIP-CLASS           14260000
142100     MOVE   PV-PHYS-INVEN-ADJ-OK       TO DL-ACCEPTED             14270000
142300                                                                  14290000
142400     SET DT18 TO TRUE                                             14300099
142500     DISPLAY DL-DETAIL                                            14310000
142600     INITIALIZE DL-DETAIL.                                        14320099
142700                                                                  14330000
21591      MOVE   PV-IN-TRANSIT-ADJ-IN       TO DL-INPUT                14240000
21591      MOVE   PV-IN-TRANSIT-ADJ-ERR      TO DL-ERROR                14250000
21591      MOVE   PV-IN-TRANSIT-ADJ-SKP      TO DL-SKIP-CLASS           14260000
21591      MOVE   PV-IN-TRANSIT-ADJ-OK       TO DL-ACCEPTED             14270000
21591                                                                   14290000
21591      SET DT26 TO TRUE                                             14300099
21591      DISPLAY DL-DETAIL                                            14310000
21591      INITIALIZE DL-DETAIL.                                        14320099
21591                                                                   14330000
143600                                                                  14420000
143700 B330-DISPLAY-COUNTS-BY-TRAN-TP.                                  14430000
143800                                                                  14440000
143900     DISPLAY ' '                                                  14450000
144000     MOVE ALL '*' TO DH-TITLE                                     14460000
144100     DISPLAY DH-TITLE                                             14470000
144200     SET DH-COUNT-BY-TRAN-TYPE         TO TRUE                    14480000
144300     DISPLAY DH-TITLE                                             14490000
144400     DISPLAY ' '                                                  14500000
144500     DISPLAY ' '                                                  14510000
144600     DISPLAY DH-HEADING                                           14520000
144700     DISPLAY ' '                                                  14530000
144800                                                                  14540000
144900     COMPUTE  PV-TOT-MKDOWN-IN      =                             14550000
145000         PV-PERM-PRC-CHG-MKDOWN-IN       +                        14560000
145100         PV-PROMO-PRC-CHG-MKDOWN-IN      +                        14570000
145200         PV-DATA-ENTRY-MKDOWN-IN                                  14580000
145300                                                                  14590000
145400     COMPUTE  PV-TOT-MKDOWN-SKP     =                             14600000
145500         PV-PERM-PRC-CHG-MKDOWN-SKP      +                        14610000
145600         PV-PROMO-PRC-CHG-MKDOWN-SKP     +                        14620000
145700         PV-DATA-ENTRY-MKDOWN-SKP                                 14630000
145800                                                                  14640000
145900     COMPUTE  PV-TOT-MKDOWN-OK      =                             14650000
146000         PV-PERM-PRC-CHG-MKDOWN-OK       +                        14660000
146100         PV-PROMO-PRC-CHG-MKDOWN-OK      +                        14670000
146200         PV-DATA-ENTRY-MKDOWN-OK                                  14680000
146300                                                                  14690000
146400                                                                  14700000
146500     COMPUTE  PV-TOT-MKUP-IN        =                             14710000
146600         PV-PERM-PRC-CHG-MKUP-IN         +                        14720000
146700         PV-PROMO-PRC-CHG-MKUP-IN        +                        14730000
146800         PV-DATA-ENTRY-MKUP-IN                                    14740000
146900                                                                  14750000
147000     COMPUTE  PV-TOT-MKUP-SKP       =                             14760000
147100         PV-PERM-PRC-CHG-MKUP-SKP        +                        14770000
147200         PV-PROMO-PRC-CHG-MKUP-SKP       +                        14780000
147300         PV-DATA-ENTRY-MKUP-SKP                                   14790000
147400                                                                  14800000
147500     COMPUTE  PV-TOT-MKUP-OK        =                             14810000
147600         PV-PROMO-PRC-CHG-MKUP-OK        +                        14820000
147700         PV-PERM-PRC-CHG-MKUP-OK         +                        14830000
147800         PV-DATA-ENTRY-MKUP-OK                                    14840000
147900                                                                  14850000
148000                                                                  14860000
148100     COMPUTE  PV-TOT-SALE-IN        =                             14870000
148200         PV-DATA-ENTRY-SALES-CORR-IN     +                        14880000
148300         PV-REGISTER-SALES-IN            +                        14890099
148300         PV-COSA-SALES-CORR-IN                                    14891099
148400                                                                  14900000
148500     COMPUTE  PV-TOT-SALE-ERR       =                             14910000
148600         PV-DATA-ENTRY-SALES-CORR-ERR    +                        14920000
148700         PV-REGISTER-SALES-ERR           +                        14930099
148300         PV-COSA-SALES-CORR-ERR                                   14931099
148800                                                                  14940000
148900     COMPUTE  PV-TOT-SALE-SKP       =                             14950000
149000         PV-DATA-ENTRY-SALES-CORR-SKP    +                        14960000
149100         PV-REGISTER-SALES-SKP           +                        14970099
148300         PV-COSA-SALES-CORR-SKP                                   14971099
149200                                                                  14980000
149300     COMPUTE  PV-TOT-SALE-OK        =                             14990000
149400         PV-DATA-ENTRY-SALES-CORR-OK     +                        15000000
149500         PV-REGISTER-SALES-OK            +                        15010099
148300         PV-COSA-SALES-CORR-OK                                    15011099
149600                                                                  15020000
149700                                                                  15030000
149800     COMPUTE  PV-TOT-PURCH-IN       =                             15040000
149900         PV-RECEIPTS-IN                  +                        15050000
150000         PV-PURCH-ADJ-IN                 +                        15060000
150100         PV-AP-COSTS-IN                  +                        15070000
150200         PV-DATA-ENTRY-PURCH-IN                                   15080000
150300                                                                  15090000
150400     COMPUTE  PV-TOT-PURCH-ERR      =                             15100000
150500         PV-RECEIPTS-ERR                 +                        15110000
150600         PV-PURCH-ADJ-ERR                +                        15120000
150700         PV-AP-COSTS-ERR                 +                        15130000
150800         PV-DATA-ENTRY-PURCH-ERR                                  15140000
150900                                                                  15150000
151000     COMPUTE  PV-TOT-PURCH-SKP      =                             15160000
151100         PV-RECEIPTS-SKP                 +                        15170000
151200         PV-PURCH-ADJ-SKP                +                        15180000
151300         PV-AP-COSTS-SKP                 +                        15190000
151400         PV-DATA-ENTRY-PURCH-SKP                                  15200000
151500                                                                  15210000
151600     COMPUTE  PV-TOT-PURCH-OK       =                             15220000
151700         PV-RECEIPTS-OK                  +                        15230000
151800         PV-PURCH-ADJ-OK                 +                        15240000
151900         PV-AP-COSTS-OK                  +                        15250000
152000         PV-DATA-ENTRY-PURCH-OK                                   15260000
152100                                                                  15270000
152800     COMPUTE  PV-TOT-ADJ-IN         =                             15340000
152900         PV-PHYS-INVEN-ADJ-IN                                     15350099
153100                                                                  15370000
153200     COMPUTE  PV-TOT-ADJ-ERR        =                             15380000
153300         PV-PHYS-INVEN-ADJ-ERR                                    15390099
153500                                                                  15410000
153600     COMPUTE  PV-TOT-ADJ-SKP        =                             15420000
153700         PV-PHYS-INVEN-ADJ-SKP                                    15430099
153900                                                                  15450000
154000     COMPUTE  PV-TOT-ADJ-OK         =                             15460000
154100         PV-PHYS-INVEN-ADJ-OK                                     15470099
154300                                                                  15490000
21591      COMPUTE  PV-TOT-INTR-ADJ-IN    =                             15340000
21591          PV-IN-TRANSIT-ADJ-IN                                     15350099
21591                                                                   15370000
21591      COMPUTE  PV-TOT-INTR-ADJ-ERR   =                             15380000
21591          PV-IN-TRANSIT-ADJ-ERR                                    15390099
21591                                                                   15410000
21591      COMPUTE  PV-TOT-INTR-ADJ-SKP   =                             15420000
21591          PV-IN-TRANSIT-ADJ-SKP                                    15430099
21591                                                                   15450000
21591      COMPUTE  PV-TOT-INTR-ADJ-OK    =                             15460000
21591          PV-IN-TRANSIT-ADJ-OK                                     15470099
21591                                                                   15490000
154400                                                                  15500000
154500     INITIALIZE DL-DETAIL                                         15510000
154600     MOVE   PV-TOT-MKDOWN-IN           TO DL-INPUT                15520000
154700     MOVE   PV-TOT-MKDOWN-SKP          TO DL-SKIP-CLASS           15530000
154800     MOVE   PV-TOT-MKDOWN-OK           TO DL-ACCEPTED             15540000
155000                                                                  15560000
155100     SET DT20 TO TRUE                                             15570099
155200     DISPLAY DL-DETAIL                                            15580000
155300     INITIALIZE DL-DETAIL                                         15590000
155400                                                                  15600000
155500     MOVE   PV-TOT-MKUP-IN             TO DL-INPUT                15610000
155600     MOVE   PV-TOT-MKUP-SKP            TO DL-SKIP-CLASS           15620000
155700     MOVE   PV-TOT-MKUP-OK             TO DL-ACCEPTED             15630000
155900                                                                  15650000
156000     SET DT21 TO TRUE                                             15660099
156100     DISPLAY DL-DETAIL                                            15670000
156200     INITIALIZE DL-DETAIL                                         15680000
156300                                                                  15690000
156400     MOVE   PV-TOT-SALE-IN             TO DL-INPUT                15700000
156500     MOVE   PV-TOT-SALE-ERR            TO DL-ERROR                15710000
156600     MOVE   PV-TOT-SALE-SKP            TO DL-SKIP-CLASS           15720000
156700     MOVE   PV-TOT-SALE-OK             TO DL-ACCEPTED             15730000
156900                                                                  15750000
157000     SET DT22 TO TRUE                                             15760099
157100     DISPLAY DL-DETAIL                                            15770000
157200     INITIALIZE DL-DETAIL                                         15780000
157300                                                                  15790000
157400     MOVE   PV-TOT-PURCH-IN            TO DL-INPUT                15800000
157500     MOVE   PV-TOT-PURCH-ERR           TO DL-ERROR                15810000
157600     MOVE   PV-TOT-PURCH-SKP           TO DL-SKIP-CLASS           15820000
157700     MOVE   PV-TOT-PURCH-OK            TO DL-ACCEPTED             15830000
157900                                                                  15850000
158000     SET DT23 TO TRUE                                             15860099
158100     DISPLAY DL-DETAIL                                            15870000
158200     INITIALIZE DL-DETAIL                                         15880000
158300                                                                  15890000
158400     MOVE   PV-STORE-TRANSFER-IN       TO DL-INPUT                15900000
158500     MOVE   PV-STORE-TRANSFER-ERR      TO DL-ERROR                15910000
158600     MOVE   PV-STORE-TRANSFER-SKP      TO DL-SKIP-CLASS           15920000
158700     MOVE   PV-STORE-TRANSFER-OK       TO DL-ACCEPTED             15930000
158900                                                                  15950000
159000     SET DT24 TO TRUE                                             15960099
159100     DISPLAY DL-DETAIL                                            15970000
159200     INITIALIZE DL-DETAIL                                         15980000
159300                                                                  15990000
159400     MOVE   PV-TOT-ADJ-IN              TO DL-INPUT                16000000
159500     MOVE   PV-TOT-ADJ-ERR             TO DL-ERROR                16010000
159600     MOVE   PV-TOT-ADJ-SKP             TO DL-SKIP-CLASS           16020000
159700     MOVE   PV-TOT-ADJ-OK              TO DL-ACCEPTED             16030000
159900                                                                  16050000
160000     SET DT25 TO TRUE                                             16060099
160100     DISPLAY DL-DETAIL.                                           16070000
160200                                                                  16080000
21591      MOVE   PV-TOT-INTR-ADJ-IN         TO DL-INPUT                16000000
21591      MOVE   PV-TOT-INTR-ADJ-ERR        TO DL-ERROR                16010000
21591      MOVE   PV-TOT-INTR-ADJ-SKP        TO DL-SKIP-CLASS           16020000
21591      MOVE   PV-TOT-INTR-ADJ-OK         TO DL-ACCEPTED             16030000
21591                                                                   16050000
21591      SET DT26 TO TRUE                                             16060099
21591      DISPLAY DL-DETAIL.                                           16070000
21591                                                                   16080000
160300     DISPLAY ' '                                                  16090000
160400     MOVE ALL '*' TO DH-TITLE                                     16100000
160500     DISPLAY DH-TITLE.                                            16110000
160600                                                                  16120000
160700                                                                  16130000
160800 C100-PROCESS-INPUT-FILES.                                        16140000
160900                                                                  16150000
161000     OPEN  INPUT RECEIPTS-FILE                                    16160000
161100     PERFORM D900-READ-RECEIPTS                                   16170000
161200     PERFORM D100-PROCESS-RECEIPTS                                16180000
161300         UNTIL END-OF-RECEIPTS-FILE                               16190000
161400     CLOSE RECEIPTS-FILE                                          16200000
161500     DISPLAY 'CLOSE RECEIPTS-FILE'                                16210000
161600                                                                  16220000
161700     OPEN  INPUT DATA-ENTRY-PURCH-FILE                            16230000
161800     PERFORM E900-READ-DATA-ENTRY-PURCH                           16240000
161900     PERFORM E100-PROCESS-DATA-ENTRY-PURCH                        16250000
162000         UNTIL END-OF-DATA-ENTRY-PURCH-FILE                       16260000
162100     CLOSE DATA-ENTRY-PURCH-FILE                                  16270000
162200     DISPLAY 'CLOSE DATA-ENTRY-PURCH-FILE'                        16280000
162300                                                                  16290000
162400     OPEN  INPUT PURCH-ADJ-FILE                                   16300000
162500     PERFORM F900-READ-PURCH-ADJ                                  16310000
162600     PERFORM F100-PROCESS-PURCH-ADJ                               16320000
162700         UNTIL END-OF-PURCH-ADJ-FILE                              16330000
162800     CLOSE PURCH-ADJ-FILE                                         16340000
162900     DISPLAY 'CLOSE PURCH-ADJ-FILE'                               16350000
163000                                                                  16360000
163100     OPEN  INPUT AP-COSTS-FILE                                    16370000
163200     PERFORM G900-READ-AP-COSTS                                   16380000
163300     PERFORM G100-PROCESS-AP-COSTS                                16390000
163400         UNTIL END-OF-AP-COSTS-FILE                               16400000
163500     CLOSE AP-COSTS-FILE                                          16410000
163600     DISPLAY 'CLOSE AP-COSTS-FILE',                               16420000
163700                                                                  16430000
163800     OPEN  INPUT REGISTER-SALES-FILE                              16440000
163900     PERFORM H900-READ-REGISTER-SALES                             16450000
164000     PERFORM H100-PROCESS-REGISTER-SALES                          16460000
164100         UNTIL END-OF-REGISTER-SALES-FILE                         16470000
164200     CLOSE REGISTER-SALES-FILE                                    16480000
164300     DISPLAY 'CLOSE REGISTER-SALES-FILE'                          16490000
164400                                                                  16500000
164500     OPEN INPUT  SALES-CORR-FILE                                  16510000
164600     PERFORM I900-READ-SALES-CORR                                 16520000
164700     PERFORM I100-PROCESS-SALES-CORR                              16530000
164800         UNTIL END-OF-SALES-CORR-FILE                             16540000
164900     CLOSE SALES-CORR-FILE                                        16550000
165000     DISPLAY 'CLOSE SALES-CORR-FILE'                              16560000
165100                                                                  16570000
165200     OPEN INPUT  PERM-PRC-CHG-FILE                                16580000
165300     PERFORM J900-READ-PERM-PRC-CHG                               16590000
165400     PERFORM J100-PROCESS-PERM-PRC-CHG                            16600000
165500         UNTIL END-OF-PERM-PRC-CHG-FILE                           16610000
165600     CLOSE PERM-PRC-CHG-FILE                                      16620000
165700     DISPLAY 'CLOSE PERM-PRC-CHG-FILE'                            16630000
165800                                                                  16640000
165900     OPEN INPUT  PROMO-PRC-CHG-FILE                               16650000
166000     PERFORM K900-READ-PROMO-PRC-CHG                              16660000
166100     PERFORM K100-PROCESS-PROMO-PRC-CHG                           16670000
166200         UNTIL END-OF-PROMO-PRC-CHG-FILE                          16680000
166300     CLOSE PROMO-PRC-CHG-FILE                                     16690000
166400     DISPLAY 'CLOSE PROMO-PRC-CHG-FILE'                           16700000
166500                                                                  16710000
166600     OPEN INPUT  DATA-ENTRY-PRC-CHG-FILE                          16720000
166700     PERFORM L900-READ-DATA-ENTRY-PRC-CHG                         16730000
166800     PERFORM L100-PROCESS-DATA-ENTRY-PR-CHG                       16740000
166900         UNTIL END-OF-DATA-ENTRY-PRC-CHG-FILE                     16750000
167000     CLOSE DATA-ENTRY-PRC-CHG-FILE                                16760000
167100     DISPLAY 'CLOSE DATA-ENTRY-PRC-CHG-FILE'                      16770000
167200                                                                  16780000
167300     OPEN  INPUT PHYS-INVEN-ADJ-FILE                              16790000
167400     PERFORM M900-READ-PHYS-INVEN-ADJ                             16800000
167500     PERFORM M100-PROCESS-PHYS-INVEN-ADJ                          16810000
167600         UNTIL END-OF-PHYS-INVEN-ADJ-FILE                         16820000
167700     CLOSE PHYS-INVEN-ADJ-FILE                                    16830000
167800     DISPLAY 'CLOSE PHYS-INVEN-ADJ-FILE'                          16840000
167900                                                                  16850000
21591      OPEN  INPUT IN-TRANSIT-ADJ-FILE                              16790000
21591      PERFORM N900-READ-IN-TRANSIT-ADJ                             16800000
21591      PERFORM N100-PROCESS-IN-TRANSIT-ADJ                          16810000
21591          UNTIL END-OF-IN-TRANSIT-ADJ-FILE                         16820000
21591      CLOSE IN-TRANSIT-ADJ-FILE                                    16830000
21591      DISPLAY 'CLOSE IN-TRANSIT-ADJ-FILE'                          16840000
21591                                                                   16850000
168700     OPEN INPUT  STORE-TRANSFER-FILE                              16930000
168800     PERFORM O900-READ-STORE-TRANSFER                             16940000
168900     PERFORM O100-PROCESS-STORE-TRANSFER                          16950000
169000         UNTIL END-OF-STORE-TRANSFER-FILE                         16960000
169100     CLOSE STORE-TRANSFER-FILE.                                   16970000
169200     DISPLAY 'CLOSE STORE-TRANSFER-FILE'.                         16980000
169300                                                                  16990000
169400 D100-PROCESS-RECEIPTS.                                           17000000
169500                                                                  17010000
169600     SET PV-RECEIPTS                                              17040000
169700         PV-PURCHASE                                              17050000
169900         PV-JRNL-YES         TO TRUE                              17070000
170000                                                                  17080000
170100     ADD 1     TO  PV-RECEIPTS-IN                                 17090000
170200                                                                  17100000
170300     IF ML015-VALID-PURCH-CDE                                     17110000
W31475*        PERFORM VARYING SKIP-IDX FROM 1 BY 1 UNTIL               17120000
W31475*            SKIP-CLASS (SKIP-IDX) = ML015-PURCH-DEPT-CLASS OR    17130000
W31475*            SKIP-CLASS (SKIP-IDX) = SPACES                 OR    17140000
W31475*            SKIP-IDX > PC-MAX-SKIP-RECS                          17150000
W31475*        END-PERFORM                                              17160000
W31475*        IF SKIP-CLASS (SKIP-IDX) = SPACES OR                     17170000
W31475*           SKIP-IDX > PC-MAX-SKIP-RECS                           17180000
W31475             SEARCH ALL SKIP-CLASS                                        
W31475             AT END                                                       
171100             PERFORM Z200-FMT-PURCH-COMPOSITE-REC                 17190000
171200             PERFORM Z900-WRITE-COMPOSITE-FILE                    17200000
171600             ADD 1 TO PV-RECEIPTS-OK                              17240099
W31475*        ELSE                                                     17260000
W31475         WHEN SKIP-CLASS (SKIP-IDX) = ML015-PURCH-DEPT-CLASS      17260000
171900             ADD 1 TO PV-RECEIPTS-SKP                             17270000
172000             PERFORM Z600-WRITE-PURCH-REJECT                      17280000
W21731             MOVE ML015-PURCH-DEPT-CLASS TO ML123-DEPT-CLASS      17281099
239558             MOVE ML015-PURCH-SKU-NBR    TO ML123-SKU             17281099
W21731*            MOVE ML015-PURCH-DEPT-NBR   TO ML123-DEPT-NBR        17281099
W21731*            MOVE ML015-PURCH-CLASS-NBR  TO ML123-CL-NBR          17282099
W21731*            MOVE SPACES                 TO ML123-SEQ-NBR         17283099
172500             MOVE ML015-PURCH-CDE        TO ML123-TRN-CDE         17284099
172500             MOVE ML015-PURCH-NET        TO ML123-CST-AMT         17285099
172500             MOVE ML015-PURCH-RETAIL     TO ML123-RTL-AMT         17286099
172500             MOVE ML015-PURCH-PO-NBR     TO ML123-PO-NBR          17287099
172500             MOVE 'N'                    TO ML123-COSA-IND        17287199
                   MOVE 'N'                    TO ML123-POS-IND         17287299
21015              MOVE ML015-PURCH-BATCH-NBR  TO ML123-BATCH-NBR       17287399
24241              MOVE ML015-PURCH-STORE-NBR  TO ML123-STORE-NBR               
172900             PERFORM Z700-WRITE-CL-DEPT-REJECT                    17288099
W31475*        END-IF                                                   17290000
W31475         END-SEARCH                                               17290000
172200     ELSE                                                         17300000
172300         ADD 1 TO  PV-RECEIPTS-ERR                                17310000
172400         INITIALIZE ERROR-LINE                                    17320000
172500         MOVE ML015-PURCH-CDE       TO EL-CODE                    17330000
172600         MOVE PV-SYST-ORIGIN-DESC   TO EL-SOURCE                  17340000
172700         MOVE 'INVALID TRAN CODE'   TO EL-REASON                  17350000
172800         MOVE ML015-PURCHASE-RECORD TO EL-DATA                    17360000
172900         PERFORM Z910-WRITE-ERROR-REPORT                          17370000
173000     END-IF                                                       17380000
173100                                                                  17390000
173200     PERFORM D900-READ-RECEIPTS.                                  17400000
173300                                                                  17410000
173400 D900-READ-RECEIPTS.                                              17420000
173500                                                                  17430000
173600     READ RECEIPTS-FILE         INTO ML015-PURCHASE-RECORD        17440000
173700        AT END                                                    17450000
173800             SET END-OF-RECEIPTS-FILE         TO TRUE.            17460000
173900     EJECT                                                        17470000
174000 E100-PROCESS-DATA-ENTRY-PURCH.                                   17480000
174100                                                                  17490000
174200     SET PV-DATA-ENTRY                                            17500000
174300         PV-PURCHASE                                              17510000
174500         PV-JRNL-NO          TO TRUE                              17530000
174600                                                                  17540000
174700     ADD 1     TO  PV-DATA-ENTRY-PURCH-IN                         17550000
174800                                                                  17560000
174900     IF ML015-VALID-PURCH-CDE                                     17570000
W31475*        PERFORM VARYING SKIP-IDX FROM 1 BY 1 UNTIL               17580000
W31475*            SKIP-CLASS (SKIP-IDX) = ML015-PURCH-DEPT-CLASS OR    17590000
W31475*            SKIP-CLASS (SKIP-IDX) = SPACES                 OR    17600000
W31475*            SKIP-IDX > PC-MAX-SKIP-RECS                          17610000
W31475*        END-PERFORM                                              17620000
W31475*        IF SKIP-CLASS (SKIP-IDX) = SPACES OR                     17630000
W31475*           SKIP-IDX > PC-MAX-SKIP-RECS                           17640000
W31475          SEARCH ALL SKIP-CLASS                                   17640000
W31475          AT END                                                  17640000
175700             PERFORM Z200-FMT-PURCH-COMPOSITE-REC                 17650000
175800             PERFORM Z900-WRITE-COMPOSITE-FILE                    17660000
175900             ADD 1 TO PV-DATA-ENTRY-PURCH-OK                      17670000
W31475*        ELSE                                                     17680000
W31475         WHEN SKIP-CLASS (SKIP-IDX) = ML015-PURCH-DEPT-CLASS      17680000
176100             ADD 1 TO PV-DATA-ENTRY-PURCH-SKP                     17690000
W21731             MOVE ML015-PURCH-DEPT-CLASS                                  
W21731                                        TO ML123-DEPT-CLASS               
239558             MOVE ML015-PURCH-SKU-NBR   TO ML123-SKU              17691099
W21731*            MOVE ML015-PURCH-DEPT-NBR  TO ML123-DEPT-NBR         17691099
W21731*            MOVE ML015-PURCH-CLASS-NBR TO ML123-CL-NBR           17692099
W21731*            MOVE SPACES                TO ML123-SEQ-NBR          17693099
172500             MOVE ML015-PURCH-CDE       TO ML123-TRN-CDE          17694099
172500             MOVE ML015-PURCH-NET       TO ML123-CST-AMT          17695099
172500             MOVE ML015-PURCH-RETAIL    TO ML123-RTL-AMT          17696099
172500             MOVE ML015-PURCH-PO-NBR    TO ML123-PO-NBR           17697099
172500             MOVE 'N'                   TO ML123-COSA-IND         17697199
                   MOVE 'N'                   TO ML123-POS-IND          17697299
21015              MOVE ML015-PURCH-BATCH-NBR TO ML123-BATCH-NBR        17697399
24241              MOVE ML015-PURCH-STORE-NBR TO ML123-STORE-NBR                
172900             PERFORM Z700-WRITE-CL-DEPT-REJECT                    17698099
W31475*        END-IF                                                   17700000
W31475         END-SEARCH                                               17700000
176300     ELSE                                                         17710000
176400         ADD 1 TO  PV-DATA-ENTRY-PURCH-ERR                        17720000
176500         INITIALIZE ERROR-LINE                                    17730000
176600         MOVE ML015-PURCH-CDE       TO EL-CODE                    17740000
176700         MOVE PV-SYST-ORIGIN-DESC   TO EL-SOURCE                  17750000
176800         MOVE 'INVALID TRAN CODE'   TO EL-REASON                  17760000
176900         MOVE ML015-PURCHASE-RECORD TO EL-DATA                    17770000
177000         PERFORM Z910-WRITE-ERROR-REPORT                          17780000
177100     END-IF                                                       17790000
177200                                                                  17800000
177300     PERFORM E900-READ-DATA-ENTRY-PURCH.                          17810000
177400                                                                  17820000
177500 E900-READ-DATA-ENTRY-PURCH.                                      17830000
177600                                                                  17840000
177700     READ DATA-ENTRY-PURCH-FILE   INTO ML015-PURCHASE-RECORD      17850000
177800        AT END                                                    17860000
177900             SET END-OF-DATA-ENTRY-PURCH-FILE   TO TRUE.          17870000
178000     EJECT                                                        17880000
178100 F100-PROCESS-PURCH-ADJ.                                          17890000
178200                                                                  17900000
178300     SET PV-ACCOUNTS-PAYABLE                                      17910000
178400         PV-PURCHASE                                              17920000
178600         PV-JRNL-NO          TO TRUE                              17940000
178700                                                                  17950000
178800     ADD 1     TO  PV-PURCH-ADJ-IN                                17960000
178900                                                                  17970000
179000     IF ML015-VALID-PURCH-CDE                                     17980000
W31475*        PERFORM VARYING SKIP-IDX FROM 1 BY 1 UNTIL               17990000
W31475*            SKIP-CLASS (SKIP-IDX) = ML015-PURCH-DEPT-CLASS OR    18000000
W31475*            SKIP-CLASS (SKIP-IDX) = SPACES                 OR    18010000
W31475*            SKIP-IDX > PC-MAX-SKIP-RECS                          18020000
W31475*        END-PERFORM                                              18030000
W31475*        IF SKIP-CLASS (SKIP-IDX) = SPACES OR                     18040000
W31475*           SKIP-IDX > PC-MAX-SKIP-RECS                           18050000
W31475         SEARCH ALL SKIP-CLASS                                            
W31475         AT END                                                           
179800             PERFORM Z200-FMT-PURCH-COMPOSITE-REC                 18060000
179900             PERFORM Z900-WRITE-COMPOSITE-FILE                    18070000
180300             ADD 1 TO PV-PURCH-ADJ-OK                             18110099
W31475*        ELSE                                                     18130000
W31475         WHEN SKIP-CLASS (SKIP-IDX) = ML015-PURCH-DEPT-CLASS      18130000
180600             ADD 1 TO PV-PURCH-ADJ-SKP                            18140000
W21731             MOVE ML015-PURCH-DEPT-CLASS TO ML123-DEPT-CLASS      18141099
239558             MOVE ML015-PURCH-SKU-NBR   TO  ML123-SKU             18141099
W21731*            MOVE ML015-PURCH-DEPT-NBR  TO ML123-DEPT-NBR         18141099
W21731*            MOVE ML015-PURCH-CLASS-NBR TO ML123-CL-NBR           18142099
W21731*            MOVE SPACES                TO ML123-SEQ-NBR          18143099
172500             MOVE ML015-PURCH-CDE       TO ML123-TRN-CDE          18144099
172500             MOVE ML015-PURCH-NET       TO ML123-CST-AMT          18145099
172500             MOVE ML015-PURCH-RETAIL    TO ML123-RTL-AMT          18146099
172500             MOVE ML015-PURCH-PO-NBR    TO ML123-PO-NBR           18147099
172500             MOVE 'N'                   TO ML123-COSA-IND         18147199
                   MOVE 'N'                   TO ML123-POS-IND          18147299
21015              MOVE ML015-PURCH-BATCH-NBR TO ML123-BATCH-NBR        18147399
24241              MOVE ML015-PURCH-STORE-NBR TO ML123-STORE-NBR                
172900             PERFORM Z700-WRITE-CL-DEPT-REJECT                    18148099
W31475*        END-IF                                                   18150000
W31475         END-SEARCH                                                       
180800     ELSE                                                         18160000
180900         ADD 1 TO PV-PURCH-ADJ-ERR                                18170000
181000         INITIALIZE ERROR-LINE                                    18180000
181100         MOVE ML015-PURCH-CDE       TO EL-CODE                    18190000
181200         MOVE PV-SYST-ORIGIN-DESC   TO EL-SOURCE                  18200000
181300         MOVE 'INVALID TRAN CODE'   TO EL-REASON                  18210000
181400         MOVE ML015-PURCHASE-RECORD TO EL-DATA                    18220000
181500         PERFORM Z910-WRITE-ERROR-REPORT                          18230000
181600     END-IF                                                       18240000
181700                                                                  18250000
181800     PERFORM F900-READ-PURCH-ADJ.                                 18260000
181900                                                                  18270000
182000 F900-READ-PURCH-ADJ.                                             18280000
182100                                                                  18290000
182200     READ PURCH-ADJ-FILE          INTO ML015-PURCHASE-RECORD      18300000
182300        AT END                                                    18310000
182400             SET END-OF-PURCH-ADJ-FILE          TO TRUE.          18320000
182500                                                                  18330000
182600 G100-PROCESS-AP-COSTS.                                           18340000
182700                                                                  18350000
182800     SET PV-ACCOUNTS-PAYABLE                                      18360000
182900         PV-PURCHASE                                              18370000
183100         PV-JRNL-NO          TO TRUE                              18390000
183200                                                                  18400000
183300     ADD 1     TO  PV-AP-COSTS-IN                                 18410000
183400                                                                  18420000
183500     IF ML015-VALID-PURCH-CDE                                     18430000
W31475*        PERFORM VARYING SKIP-IDX FROM 1 BY 1 UNTIL               18440000
W31475*            SKIP-CLASS (SKIP-IDX) = ML015-PURCH-DEPT-CLASS OR    18450000
W31475*            SKIP-CLASS (SKIP-IDX) = SPACES                 OR    18460000
W31475*            SKIP-IDX > PC-MAX-SKIP-RECS                          18470000
W31475*        END-PERFORM                                              18480000
W31475*        IF SKIP-CLASS (SKIP-IDX) = SPACES OR                     18490000
W31475*           SKIP-IDX > PC-MAX-SKIP-RECS                           18500000
W31475            SEARCH ALL SKIP-CLASS                                 18500000
W31475            AT END                                                18500000
184300             PERFORM Z200-FMT-PURCH-COMPOSITE-REC                 18510000
184400             PERFORM Z900-WRITE-COMPOSITE-FILE                    18520000
184800             ADD 1 TO PV-AP-COSTS-OK                              18560099
W31475*        ELSE                                                     18580000
W31475         WHEN SKIP-CLASS (SKIP-IDX) = ML015-PURCH-DEPT-CLASS              
185100             ADD 1 TO PV-AP-COSTS-SKP                             18590000
W21731             MOVE ML015-PURCH-DEPT-CLASS TO ML123-DEPT-CLASS      18141099
239558             MOVE ML015-PURCH-SKU-NBR   TO  ML123-SKU             18141099
W21731*            MOVE ML015-PURCH-DEPT-NBR  TO ML123-DEPT-NBR         18591099
W21731*            MOVE ML015-PURCH-CLASS-NBR TO ML123-CL-NBR           18592099
W21731*            MOVE SPACES                TO ML123-SEQ-NBR          18593099
172500             MOVE ML015-PURCH-CDE       TO ML123-TRN-CDE          18594099
172500             MOVE ML015-PURCH-NET       TO ML123-CST-AMT          18595099
172500             MOVE ML015-PURCH-RETAIL    TO ML123-RTL-AMT          18596099
172500             MOVE ML015-PURCH-PO-NBR    TO ML123-PO-NBR           18597099
172500             MOVE 'N'                   TO ML123-COSA-IND         18597199
                   MOVE 'N'                   TO ML123-POS-IND          18597299
21015              MOVE ML015-PURCH-BATCH-NBR TO ML123-BATCH-NBR        18597399
24241              MOVE ML015-PURCH-STORE-NBR TO ML123-STORE-NBR                
172900             PERFORM Z700-WRITE-CL-DEPT-REJECT                    18598099
W31475*        END-IF                                                   18600000
W31475         END-SEARCH                                                       
185300     ELSE                                                         18610000
185400         ADD 1 TO  PV-AP-COSTS-ERR                                18620000
185500         INITIALIZE ERROR-LINE                                    18630000
185600         MOVE ML015-PURCH-CDE       TO EL-CODE                    18640000
185700         MOVE PV-SYST-ORIGIN-DESC   TO EL-SOURCE                  18650000
185800         MOVE 'INVALID TRAN CODE'   TO EL-REASON                  18660000
185900         MOVE ML015-PURCHASE-RECORD TO EL-DATA                    18670000
186000         PERFORM Z910-WRITE-ERROR-REPORT                          18680000
186100     END-IF                                                       18690000
186200                                                                  18700000
186300     PERFORM G900-READ-AP-COSTS.                                  18710000
186400                                                                  18720000
186500 G900-READ-AP-COSTS.                                              18730000
186600                                                                  18740000
186700     READ AP-COSTS-FILE           INTO ML015-PURCHASE-RECORD      18750000
186800        AT END                                                    18760000
186900             SET END-OF-AP-COSTS-FILE           TO TRUE.          18770000
187000                                                                  18780000
187100     EJECT                                                        18790000
187200 H100-PROCESS-REGISTER-SALES.                                     18800000
187300                                                                  18810000
187400     SET PV-POS                                                   18820000
187600         PV-SALE   TO TRUE.                                       18840099
187700                                                                  18850000
188000     IF D040-SLS-CORR-CDE = 'S'                                   18851099
187800         ADD 1 TO  PV-COSA-SALES-CORR-IN                          18851199
189600     ELSE                                                         18852099
187800         ADD 1 TO  PV-REGISTER-SALES-IN                           18860099
190800     END-IF.                                                      18861099
187900                                                                  18870000
W21731     IF  D040-SEQNO = ZEROES                                      18870000
W21731         IF (D040-DEPT-CLASS = ZERO OR                            18870000
W21731             D040-DEPT-CLASS = SPACE)                             18870000
W21731             MOVE D040-SKU(1:5)   TO D040-DEPT-CLASS              18870000
W21731                                     PV-SAVE-DEPT-CLASS           18870000
W21731             MOVE D040-CLASS(1:1) TO PV-NEW-SKU-MAJ-CLASS         18870000
W21731             MOVE PV-NEW-SKU-MCL  TO D040-MAJOR-CLASS             18870000
W21731                                     PV-SAVE-MAJ-CL               18870000
W21731         END-IF                                                   18870000
W21731     ELSE                                                         18870000
W21731         IF (D040-DEPT-CLASS = ZERO OR                            18870000
W21731             D040-DEPT-CLASS = SPACE)                             18870000
W21731             IF  PV-HOLD-SKU = D040-SKU                           18870000
W21731                 MOVE PV-SAVE-DEPT-CLASS TO D040-DEPT-CLASS       18870000
W21731                 MOVE PV-SAVE-MAJ-CL     TO D040-MAJOR-CLASS      18870000
W21731             ELSE                                                 18870000
W21731                 MOVE D040-SKU        TO PV-HOLD-SKU              18870000
W21731                 MOVE PV-HOLD-SKU     TO PV-HOLD-SKU-XREF         18870000
W21731                 PERFORM Z100-RETRIEVE-SKU-ATTRIBUTES             18870000
W21731                 MOVE SKXREF-DEPT     TO D040-DEPT                18870000
W21731                                         PV-SAVE-DEPT             18870000
W21731                 MOVE SKXREF-SUBCLASS TO D040-CLASS               18870000
W21731                                         PV-SAVE-SCL              05121099
W21731                 MOVE SKXREF-CLASS    TO D040-MAJOR-CLASS         18870000
W21731                                         PV-SAVE-MAJ-CL           05121099
W21731             END-IF                                               18870000
W21731         END-IF                                                   18870000
W21731     END-IF.                                                      18870000
187900                                                                  18870000
188000     IF D040-VALID-CODE AND                                       18880000
188100        D040-SALE-AMT NUMERIC                                     18890000
W31475*        PERFORM VARYING SKIP-IDX FROM 1 BY 1 UNTIL               18900000
W31475*            SKIP-CLASS (SKIP-IDX) = D040-DEPT-CLASS-X OR         18910000
W31475*            SKIP-CLASS (SKIP-IDX) = SPACES            OR         18920000
W31475*            SKIP-IDX > PC-MAX-SKIP-RECS                          18930000
W31475*        END-PERFORM                                              18940000
W31475*        IF SKIP-CLASS (SKIP-IDX) = SPACES OR                     18950000
W31475*           SKIP-IDX > PC-MAX-SKIP-RECS                           18960000
W31475            SEARCH ALL SKIP-CLASS                                         
W31475            AT END                                                        
188900             PERFORM H200-FMT-DE-SLES-COMPOSITE-REC               18970000
189000             PERFORM Z900-WRITE-COMPOSITE-FILE                    18980000
188000             IF D040-SLS-CORR-CDE = 'S'                           18991099
187800                 ADD 1 TO PV-COSA-SALES-CORR-OK                   18992099
189600             ELSE                                                 18993099
187800                 ADD 1 TO PV-REGISTER-SALES-OK                    18994099
190800             END-IF                                               18995099
W31475*        ELSE                                                     19000000
W31475         WHEN SKIP-CLASS (SKIP-IDX) = D040-DEPT-CLASS-X                   
188000             IF D040-SLS-CORR-CDE = 'S'                           19001099
187800                 ADD 1 TO PV-COSA-SALES-CORR-SKP                  19002099
189600             ELSE                                                 19003099
187800                 ADD 1 TO PV-REGISTER-SALES-SKP                   19004099
190800             END-IF                                               19005099
189400             PERFORM H300-WRITE-REG-SALES-REJECT                  19020000
W21731             MOVE D040-SKU          TO ML123-SKU                  19021099
                   MOVE D040-DEPT         TO ML123-DEPT-NBR             19021099
                   MOVE D040-CLASS        TO ML123-CL-NBR               19022099
W21731             MOVE D040-MAJOR-CLASS  TO ML123-MAJ-CL-NBR           19022099
W21731*            MOVE D040-SEQNO        TO ML123-SEQ-NBR              19023099
172500             MOVE D040-CODE         TO ML123-TRN-CDE              19024099
172500             MOVE ZERO              TO ML123-CST-AMT              19025099
172500             MOVE D040-SALE-AMT     TO ML123-RTL-AMT              19026099
172500             MOVE SPACES            TO ML123-PO-NBR               19027099
21015              MOVE SPACES            TO ML123-BATCH-NBR            19027199
W26603             MOVE D040-STORENO       TO PV-EXPND-STORE-NBR                
W26603             MOVE PV-EXPND-STORE-NBR TO ML123-STORE-NBR                   
204100             IF D040-SLS-CORR-CDE = 'S'                           19027299
172500                 MOVE 'Y'              TO ML123-COSA-IND          19027399
204300             ELSE                                                 19027499
172500                 MOVE 'N'              TO ML123-COSA-IND          19027599
204500             END-IF                                               19027699
                   MOVE 'N'                   TO ML123-POS-IND          19027799
172900             PERFORM Z700-WRITE-CL-DEPT-REJECT                    19028099
W31475*        END-IF                                                   19030000
W31475         END-SEARCH                                               19030000
189600     ELSE                                                         19040000
188000         IF D040-SLS-CORR-CDE = 'S'                               19051099
187800             ADD 1 TO PV-COSA-SALES-CORR-ERR                      19052099
189600         ELSE                                                     19053099
187800             ADD 1 TO PV-REGISTER-SALES-ERR                       19054099
190800         END-IF                                                   19055099
189800         INITIALIZE ERROR-LINE                                    19060000
189900         MOVE D040-CODE             TO EL-CODE                    19070000
190000         MOVE PV-SYST-ORIGIN-DESC   TO EL-SOURCE                  19080000
190100         MOVE D040-RECORD           TO EL-DATA                    19090000
190200         IF D040-VALID-CODE                                       19100000
190300             MOVE 'NON NUM SALE AMT'    TO EL-REASON              19110000
190400         ELSE                                                     19120000
190500             MOVE 'INVALID TRAN CODE'   TO EL-REASON              19130000
190600         END-IF                                                   19140000
190700         PERFORM Z910-WRITE-ERROR-REPORT                          19150000
190800     END-IF.                                                      19160099
190900                                                                  19170000
191000     PERFORM H900-READ-REGISTER-SALES.                            19180000
191100                                                                  19190000
191200 H200-FMT-DE-SLES-COMPOSITE-REC.                                  19200000
191300                                                                  19210000
191400     INITIALIZE ML020-COMPOSITE-RECORD                            19220000
191500                ML020-SALES-RECORD.                               19230099
191600                                                                  19240000
191700     MOVE D040-STORENO            TO ML020-STORE-NBR-9.           19250099
191800     MOVE D040-SKU                TO ML020-SKU.                   19260099
W21731     MOVE D040-DEPT-CLASS         TO ML020-DEPT-CLASS.            19260099
W21731     MOVE D040-MAJOR-CLASS        TO ML020-MAJOR-CLASS.           19260099
191900     MOVE PV-SYST-ORIGIN          TO ML020-SYST-ORIG-CDE.         19270099
192000     MOVE PV-TRAN-TYPE            TO ML020-TRANS-CDE.             19280099
192100                                                                  19290000
192200     MOVE D040-DATE               TO ML020-SALE-DTE.              19300099
192300     MOVE D040-SALE-AMT           TO ML020-SALE-EXTD-RTL-AMT.     19310000
188000     IF D040-SLS-CORR-CDE = 'S'                                   19311099
249810         MOVE PC-SALES-CORR-TYPE  TO ML020-SALE-TYPE-2            19311199
189600     ELSE                                                         19313099
192310         MOVE D040-SALE-TYPE-2    TO ML020-SALE-TYPE-2            19313199
190800     END-IF.                                                      19315099
192200     MOVE D040-SLS-CORR-CDE       TO ML020-SALE-CORR-CDE.         19316099
192400                                                                  19330000
192500 H300-WRITE-REG-SALES-REJECT.                                     19340000
192600                                                                  19350000
192700*    WRITE REJECT-REG-SALES-REC56 FROM D040-RECORD.               19360000
W21731     WRITE REJECT-REG-SALES-REC65 FROM D040-RECORD.               19360000
192800                                                                  19370000
192900                                                                  19380000
193000 H900-READ-REGISTER-SALES.                                        19390000
193100                                                                  19400000
193200     READ REGISTER-SALES-FILE  INTO D040-RECORD                   19410000
193300        AT END                                                    19420000
193400             SET END-OF-REGISTER-SALES-FILE     TO TRUE.          19430000
193500                                                                  19440000
193600                                                                  19450000
193700 I100-PROCESS-SALES-CORR.                                         19460000
193800                                                                  19470000
193900     SET PV-DATA-ENTRY                                            19480000
194100         PV-SALE        TO TRUE                                   19500000
194200                                                                  19510000
194300     ADD 1              TO PV-DATA-ENTRY-SALES-CORR-IN            19520000
194400                                                                  19530000
194500     SET PS-NO-ERROR TO TRUE                                      19540000
194600                                                                  19550000
194700     IF ML016-VALID-SALE-CDE                                      19560000
194800         CONTINUE                                                 19570000
194900     ELSE                                                         19580000
195000         SET PS-ERROR TO TRUE                                     19590000
195100         ADD 1 TO  PV-DATA-ENTRY-SALES-CORR-ERR                   19600000
195200         INITIALIZE ERROR-LINE                                    19610000
195300         MOVE ML016-SALE-CDE        TO EL-CODE                    19620000
195400         MOVE PV-SYST-ORIGIN-DESC   TO EL-SOURCE                  19630000
195500         MOVE 'INVALID TRAN CODE'   TO EL-REASON                  19640000
195600         MOVE ML016-SALES-RECORD    TO EL-DATA                    19650000
195700         PERFORM Z910-WRITE-ERROR-REPORT                          19660000
195800     END-IF                                                       19670000
195900                                                                  19680000
196000     IF PS-NO-ERROR                                               19690000
196100         PERFORM I110-FINISH-EDIT                                 19700000
196200     END-IF                                                       19710000
196300                                                                  19720000
196400     PERFORM I900-READ-SALES-CORR.                                19730000
196500                                                                  19740000
196600 I110-FINISH-EDIT.                                                19750000
196700                                                                  19760000
196800     IF ML016-SALE-QTY             NUMERIC AND                    19770000
196900        ML016-SALE-EXTD-RTL-AMT    NUMERIC                        19780000
197000         CONTINUE                                                 19790000
197100     ELSE                                                         19800000
197200         SET PS-ERROR TO TRUE                                     19810000
197300         ADD 1 TO  PV-DATA-ENTRY-SALES-CORR-ERR                   19820000
197400         INITIALIZE ERROR-LINE                                    19830000
197500         MOVE ML016-SALE-CDE        TO EL-CODE                    19840000
197600         MOVE PV-SYST-ORIGIN-DESC   TO EL-SOURCE                  19850000
197700         MOVE 'NON NUMERIC AMTS '   TO EL-REASON                  19860000
197800         MOVE ML016-SALES-RECORD    TO EL-DATA                    19870000
197900         PERFORM Z910-WRITE-ERROR-REPORT                          19880000
198000     END-IF.                                                      19890000
198100                                                                  19900000
198200     IF  PS-NO-ERROR                                              19910000
W31475*        PERFORM VARYING SKIP-IDX FROM 1 BY 1 UNTIL               19920000
W31475*            SKIP-CLASS (SKIP-IDX) = ML016-SALE-DEPT-CLASS OR     19930000
W31475*            SKIP-CLASS (SKIP-IDX) = SPACES                OR     19940000
W31475*            SKIP-IDX > PC-MAX-SKIP-RECS                          19950000
W31475*        END-PERFORM                                              19960000
W31475*        IF SKIP-CLASS (SKIP-IDX) = SPACES OR                     19970000
W31475*           SKIP-IDX > PC-MAX-SKIP-RECS                           19980000
W31475         SEARCH ALL SKIP-CLASS                                            
W31475         AT END                                                           
199000             PERFORM Z300-FMT-SALE-COMPOSITE-REC                  19990000
199100             PERFORM Z900-WRITE-COMPOSITE-FILE                    20000000
199200             ADD 1 TO PV-DATA-ENTRY-SALES-CORR-OK                 20010000
W31475*        ELSE                                                     20020000
W31475         WHEN SKIP-CLASS (SKIP-IDX) = ML016-SALE-DEPT-CLASS               
199400             ADD 1 TO PV-DATA-ENTRY-SALES-CORR-SKP                20030000
172500             MOVE ML016-SALE-DEPT-NBR  TO ML123-DEPT-NBR          20031099
172500             MOVE ML016-SALE-CLASS-NBR TO ML123-CL-NBR            20032099
172500             MOVE ML016-SALE-CDE       TO ML123-TRN-CDE           20034099
172500             MOVE ZERO                 TO ML123-CST-AMT           20035099
172500             MOVE ML016-SALE-EXTD-RTL-AMT                         20036099
172500                                       TO ML123-RTL-AMT           20036199
172500             MOVE SPACES               TO ML123-PO-NBR            20037099
172500             MOVE 'N'                  TO ML123-COSA-IND          20037199
                   MOVE 'N'                  TO ML123-POS-IND           20037299
21015              MOVE SPACES               TO ML123-BATCH-NBR         20037399
24241              MOVE ML016-SALE-STORE-NBR TO ML123-STORE-NBR                 
172900             PERFORM Z700-WRITE-CL-DEPT-REJECT                    20038099
W31475*        END-IF                                                   20040000
W31475         END-SEARCH                                                       
199600     END-IF.                                                      20050000
199700                                                                  20060000
199800 I900-READ-SALES-CORR.                                            20070000
199900                                                                  20080000
200000     READ SALES-CORR-FILE                 INTO ML016-SALES-RECORD 20090000
200100        AT END                                                    20100000
200200             SET END-OF-SALES-CORR-FILE         TO TRUE.          20110000
200300                                                                  20120000
200400 J100-PROCESS-PERM-PRC-CHG.                                       20130000
200500                                                                  20140000
200600     SET PV-PERM           TO TRUE                                20150000
200800                                                                  20170000
200900     ADD 1     TO  PV-PERM-PRC-CHG-IN                             20180000
201000                                                                  20190000
201100     MOVE ML017-PC-CDE            TO PV-TRAN-TYPE                 20200000
201200                                                                  20210000
201300     IF ML017-MKDOWN                                              20220000
201400         SET PV-MKDOWN            TO TRUE                         20230000
201500         ADD 1 TO PV-PERM-PRC-CHG-MKDOWN-IN                       20240000
201600     ELSE                                                         20250000
201700         IF ML017-MKUP                                            20260000
201800             SET PV-MKUP          TO TRUE                         20270000
201900             ADD 1 TO PV-PERM-PRC-CHG-MKUP-IN                     20280000
202000         END-IF                                                   20290000
202100     END-IF                                                       20300000
W21731                                                                  18870000
W21731     IF  ML017-PC-SEQ-NBR = ZEROES                                18870000
W21731         IF (ML017-PC-DEPT-CLASS-NUM = ZEROES OR                  18870000
W21731             ML017-PC-DEPT-CLASS-NUM = SPACES)                    18870000
W21731             MOVE ML017-PC-SKU(1:5)   TO ML017-PC-DEPT-CLASS      18870000
W21731                                         PV-SAVE-DEPT-CLASS       18870000
W21731             MOVE ML017-PC-CLASS-NBR(1:1) TO PV-NEW-SKU-MAJ-CLASS 18870000
W21731             MOVE PV-NEW-SKU-MCL  TO ML017-PC-MAJ-CLASS           18870000
W21731         END-IF                                                   18870000
W21731     ELSE                                                         18870000
W21731*    099-10 TRANSACTIONS WITH NON-000 SEQ (NOT FOUND - TSKXREF)   18870000
W21731*    MOVE 099-10 TO NEW SKU ATTRIBUTES                            18870000
W21731         IF ML017-PC-SKU(1:5) = '09910'                           18870000
W21731             MOVE PC-D09910-PC-ATTR    TO ML017-PC-SKU-DTA-ATTRIB 18870000
W21731         ELSE                                                     18870000
W21731             IF (ML017-PC-DEPT-CLASS-NUM = ZEROES OR              18870000
W21731                 ML017-PC-DEPT-CLASS-NUM = SPACES)                18870000
W21731                 IF  PV-HOLD-SKU = ML017-PC-SKU                   18870000
W21731                     MOVE PV-SAVE-DEPT-CLASS-ATTR                 18870000
W21731                                      TO ML017-PC-SKU-DTA-ATTRIB  18870000
W21731                 ELSE                                             18870000
W21731                     MOVE ML017-PC-SKU    TO PV-HOLD-SKU          18870000
W21731                     MOVE PV-HOLD-SKU     TO PV-HOLD-SKU-XREF     18870000
W21731                     PERFORM Z100-RETRIEVE-SKU-ATTRIBUTES         18870000
W21731                     MOVE SKXREF-DEPT     TO ML017-PC-DEPT-NBR    18870000
W21731                                             PV-SAVE-DEPT         18870000
W21731                     MOVE SKXREF-SUBCLASS TO ML017-PC-CLASS-NBR   18870000
W21731                                             PV-SAVE-SCL          05121099
W21731                     MOVE SKXREF-CLASS    TO ML017-PC-MAJ-CLASS   18870000
W21731                                             PV-SAVE-MAJ-CL       05121099
W21731                 END-IF                                           18870000
W21731             END-IF                                               18870000
W21731         END-IF                                                   18870000
W21731     END-IF.                                                      18870000
202200                                                                  20310000
202300     IF ML017-VALID-PC-CDE                                        20320000
W31475*        PERFORM VARYING SKIP-IDX FROM 1 BY 1 UNTIL               20330000
W31475*            SKIP-CLASS (SKIP-IDX) = ML017-PC-DEPT-CLASS OR       20340000
W31475*            SKIP-CLASS (SKIP-IDX) = SPACES              OR       20350000
W31475*            SKIP-IDX > PC-MAX-SKIP-RECS                          20360000
W31475*        END-PERFORM                                              20370000
W31475*        IF SKIP-CLASS (SKIP-IDX) = SPACES OR                     20380000
W31475*           SKIP-IDX > PC-MAX-SKIP-RECS                           20390000
W31475         SEARCH ALL SKIP-CLASS                                    20390000
W31475         AT END                                                   20390000
203100             ADD 1 TO PV-PERM-PRC-CHG-OK                          20400000
203200             IF ML017-MKDOWN                                      20410000
203300                 ADD 1 TO PV-PERM-PRC-CHG-MKDOWN-OK               20420000
203400             ELSE                                                 20430000
203500                 ADD 1 TO PV-PERM-PRC-CHG-MKUP-OK                 20440000
203600             END-IF                                               20450000
203700             PERFORM Z400-FMT-PC-COMPOSITE-REC                    20460000
203800             PERFORM Z900-WRITE-COMPOSITE-FILE                    20470000
W31475*        ELSE                                                     20480000
W31475         WHEN SKIP-CLASS (SKIP-IDX) = ML017-PC-DEPT-CLASS         20480000
204000             ADD 1 TO PV-PERM-PRC-CHG-SKP                         20490000
204100             IF ML017-MKDOWN                                      20500000
204200                 ADD 1 TO PV-PERM-PRC-CHG-MKDOWN-SKP              20510000
204300             ELSE                                                 20520000
204400                 ADD 1 TO PV-PERM-PRC-CHG-MKUP-SKP                20530000
204500             END-IF                                               20540000
W21731             MOVE ML017-PC-SKU         TO ML123-SKU               20541099
172500             MOVE ML017-PC-DEPT-NBR    TO ML123-DEPT-NBR          20541099
172500             MOVE ML017-PC-CLASS-NBR   TO ML123-CL-NBR            20542099
W21731*            MOVE ML017-PC-SEQ-NBR     TO ML123-SEQ-NBR           20543099
172500             MOVE ML017-PC-CDE         TO ML123-TRN-CDE           20544099
172500             MOVE ZERO                 TO ML123-CST-AMT           20545099
172500             MOVE SPACES               TO ML123-PO-NBR            20545199
172500             MOVE 'N'                  TO ML123-COSA-IND          20545299
                   MOVE 'N'                  TO ML123-POS-IND           20545399
21015              MOVE ML017-PC-BATCH-NBR   TO ML123-BATCH-NBR         20545499
24241              MOVE ML017-PC-STORE-NBR   TO ML123-STORE-NBR                 
                   IF ML017-MKDOWN                                      20545599
                       COMPUTE PV-RTL-AMT =                             20546099
                            ML017-PC-OLD-PR-AMT - ML017-PC-NEW-PR-AMT   20546199
                       COMPUTE ML123-RTL-AMT =                          20546299
                            PV-RTL-AMT * ML017-PC-QTY                   20546399
                       PERFORM Z700-WRITE-CL-DEPT-REJECT                20546499
                   ELSE                                                 20546599
                   IF ML017-MKUP                                        20546699
                       COMPUTE PV-RTL-AMT =                             20546799
                            ML017-PC-NEW-PR-AMT - ML017-PC-OLD-PR-AMT   20546899
                       COMPUTE ML123-RTL-AMT =                          20546999
                            PV-RTL-AMT * ML017-PC-QTY                   20547099
                       PERFORM Z700-WRITE-CL-DEPT-REJECT                20547199
                   ELSE                                                 20547299
                       MOVE ZERO   TO ML123-RTL-AMT                     20547399
                       PERFORM Z700-WRITE-CL-DEPT-REJECT                20548099
W31475             END-IF                                               20550000
W31475            END-IF                                                        
W31475         END-SEARCH                                               20550000
W31475*        END-IF                                                   20550000
204700     ELSE                                                         20560000
204800         ADD 1 TO  PV-PERM-PRC-CHG-ERR                            20570000
204900         INITIALIZE ERROR-LINE                                    20580000
205000         MOVE ML017-PC-CDE          TO EL-CODE                    20590000
205100         MOVE PV-SYST-ORIGIN-DESC   TO EL-SOURCE                  20600000
205200         MOVE 'INVALID TRAN CODE'   TO EL-REASON                  20610000
205300         MOVE ML017-PRICE-CHANGE-RECORD TO EL-DATA                20620000
205400         PERFORM Z910-WRITE-ERROR-REPORT                          20630000
205500     END-IF                                                       20640000
205600                                                                  20650000
205700     PERFORM J900-READ-PERM-PRC-CHG.                              20660000
205800                                                                  20670000
205900 J900-READ-PERM-PRC-CHG.                                          20680000
206000                                                                  20690000
206100     READ PERM-PRC-CHG-FILE   INTO ML017-PRICE-CHANGE-RECORD      20700000
206200        AT END                                                    20710000
206300             SET END-OF-PERM-PRC-CHG-FILE       TO TRUE.          20720000
206400                                                                  20730000
206500 K100-PROCESS-PROMO-PRC-CHG.                                      20740000
206600                                                                  20750000
206700     SET PV-PROMO  TO TRUE                                        20760000
206900                                                                  20780000
207000     MOVE ML017-PC-CDE            TO PV-TRAN-TYPE                 20790000
207100                                                                  20800000
207200     IF ML017-MKDOWN                                              20810000
207300         SET PV-MKDOWN            TO TRUE                         20820000
207400         ADD 1 TO PV-PROMO-PRC-CHG-MKDOWN-IN                      20830000
207500     ELSE                                                         20840000
207600         IF ML017-MKUP                                            20850000
207700             SET PV-MKUP          TO TRUE                         20860000
207800             ADD 1 TO PV-PROMO-PRC-CHG-MKUP-IN                    20870000
207900         END-IF                                                   20880000
208000     END-IF                                                       20890000
208100                                                                  20900000
208200     ADD 1     TO  PV-PROMO-PRC-CHG-IN                            20910000
W21731                                                                  18870000
W21731     IF  ML017-PC-SEQ-NBR = ZEROES                                18870000
W21731         IF (ML017-PC-DEPT-CLASS-NUM = ZEROES OR                  18870000
W21731             ML017-PC-DEPT-CLASS-NUM = SPACES)                    18870000
W21731             MOVE ML017-PC-SKU(1:5)   TO ML017-PC-DEPT-CLASS      18870000
W21731                                         PV-SAVE-DEPT-CLASS       18870000
W21731             MOVE ML017-PC-CLASS-NBR(1:1) TO PV-NEW-SKU-MAJ-CLASS 18870000
W21731             MOVE PV-NEW-SKU-MCL      TO ML017-PC-MAJ-CLASS       18870000
W21731         END-IF                                                   18870000
W21731     ELSE                                                         18870000
W21731*    099-10 TRANS WITH NON-000 SEQ (NOT FOUND - TSKXREF)          18870000
W21731*    MOVE 099-10-0010 TO NEW SKU ATTRIBUTES                       18870000
W21731         IF ML017-PC-SKU(1:5) = '09910'                           18870000
W21731             MOVE PC-D09910-PC-ATTR   TO ML017-PC-SKU-DTA-ATTRIB  18870000
W21731         ELSE                                                     18870000
W21731             IF (ML017-PC-DEPT-CLASS-NUM = ZEROES OR              18870000
W21731                 ML017-PC-DEPT-CLASS-NUM = SPACES)                18870000
W21731                 IF  PV-HOLD-SKU = ML017-PC-SKU                   18870000
W21731                     MOVE PV-SAVE-DEPT-CLASS-ATTR                 18870000
W21731                                      TO ML017-PC-SKU-DTA-ATTRIB  18870000
W21731                 ELSE                                             18870000
W21731                     MOVE ML017-PC-SKU    TO PV-HOLD-SKU          18870000
W21731                     MOVE PV-HOLD-SKU     TO PV-HOLD-SKU-XREF     18870000
W21731                     PERFORM Z100-RETRIEVE-SKU-ATTRIBUTES         18870000
W21731                     MOVE SKXREF-DEPT     TO ML017-PC-DEPT-NBR    18870000
W21731                                             PV-SAVE-DEPT         18870000
W21731                     MOVE SKXREF-SUBCLASS TO ML017-PC-CLASS-NBR   18870000
W21731                                             PV-SAVE-SCL          05121099
W21731                     MOVE SKXREF-CLASS    TO ML017-PC-MAJ-CLASS   18870000
W21731                                             PV-SAVE-MAJ-CL       05121099
W21731                 END-IF                                           18870000
W21731             END-IF                                               18870000
W21731         END-IF                                                   18870000
W21731     END-IF.                                                      18870000
W21731                                                                  18870000
208400     IF ML017-VALID-PC-CDE                                        20930000
W31475*        PERFORM VARYING SKIP-IDX FROM 1 BY 1 UNTIL               20940000
W31475*            SKIP-CLASS (SKIP-IDX) = ML017-PC-DEPT-CLASS OR       20950000
W31475*            SKIP-CLASS (SKIP-IDX) = SPACES              OR       20960000
W31475*            SKIP-IDX > PC-MAX-SKIP-RECS                          20970000
W31475*        END-PERFORM                                              20980000
W31475*        IF SKIP-CLASS (SKIP-IDX) = SPACES OR                     20990000
W31475*           SKIP-IDX > PC-MAX-SKIP-RECS                           21000000
W31475          SEARCH ALL SKIP-CLASS                                           
W31475          AT END                                                          
209200             ADD 1 TO PV-PROMO-PRC-CHG-OK                         21010000
209300             IF ML017-MKDOWN                                      21020000
209400                 ADD 1 TO PV-PROMO-PRC-CHG-MKDOWN-OK              21030000
209500             ELSE                                                 21040000
209600                 ADD 1 TO PV-PROMO-PRC-CHG-MKUP-OK                21050000
209700             END-IF                                               21060000
209800             PERFORM Z400-FMT-PC-COMPOSITE-REC                    21070000
209900             PERFORM Z900-WRITE-COMPOSITE-FILE                    21080000
W31475*        ELSE                                                     21090000
W31475         WHEN SKIP-CLASS (SKIP-IDX) = ML017-PC-DEPT-CLASS                 
210100             ADD 1 TO PV-PROMO-PRC-CHG-SKP                        21100000
210200             IF ML017-MKDOWN                                      21110000
210300                 ADD 1 TO PV-PROMO-PRC-CHG-MKDOWN-SKP             21120000
210400             ELSE                                                 21130000
210500                 ADD 1 TO PV-PROMO-PRC-CHG-MKUP-SKP               21140000
210600             END-IF                                               21150000
W21731             MOVE ML017-PC-SKU         TO ML123-SKU               20541099
172500             MOVE ML017-PC-DEPT-NBR    TO ML123-DEPT-NBR          21151099
172500             MOVE ML017-PC-CLASS-NBR   TO ML123-CL-NBR            21152099
W21731*            MOVE ML017-PC-SEQ-NBR     TO ML123-SEQ-NBR           21153099
172500             MOVE ML017-PC-CDE         TO ML123-TRN-CDE           21154099
172500             MOVE ZERO                 TO ML123-CST-AMT           21155099
172500             MOVE SPACES               TO ML123-PO-NBR            21156499
21015              MOVE ML017-PC-BATCH-NBR   TO ML123-BATCH-NBR         21156599
24241              MOVE ML017-PC-STORE-NBR   TO ML123-STORE-NBR                 
204100             IF ML017-SLS-CORR-CDE = 'S'                          21156699
172500                 MOVE 'Y'              TO ML123-COSA-IND          21156799
204300             ELSE                                                 21156899
172500                 MOVE 'N'              TO ML123-COSA-IND          21156999
204500             END-IF                                               21157099
                   MOVE 'Y'                  TO ML123-POS-IND           21157199
                   IF ML017-MKDOWN                                      21157299
                       COMPUTE PV-RTL-AMT =                             21157399
                            ML017-PC-OLD-PR-AMT - ML017-PC-NEW-PR-AMT   21157499
                       COMPUTE ML123-RTL-AMT =                          21157599
                            PV-RTL-AMT * ML017-PC-QTY                   21157699
                       PERFORM Z700-WRITE-CL-DEPT-REJECT                21157799
                   ELSE                                                 21157899
                   IF ML017-MKUP                                        21157999
                       COMPUTE PV-RTL-AMT =                             21158099
                            ML017-PC-NEW-PR-AMT - ML017-PC-OLD-PR-AMT   21158199
                       COMPUTE ML123-RTL-AMT =                          21158299
                            PV-RTL-AMT * ML017-PC-QTY                   21158399
                       PERFORM Z700-WRITE-CL-DEPT-REJECT                21158499
                   ELSE                                                 21158599
                       MOVE ZERO   TO ML123-RTL-AMT                     21158699
                       PERFORM Z700-WRITE-CL-DEPT-REJECT                21158799
W31475             END-IF                                               21160000
W31475           END-IF                                                 21160000
W31475         END-SEARCH                                               21160000
W31475*        END-IF                                                   21160000
210800     ELSE                                                         21170000
210900         ADD 1 TO  PV-PROMO-PRC-CHG-ERR                           21180000
211000         MOVE ML017-PC-CDE          TO EL-CODE                    21190000
211100         MOVE PV-SYST-ORIGIN-DESC   TO EL-SOURCE                  21200000
211200         MOVE 'INVALID TRAN CODE'   TO EL-REASON                  21210000
211300         MOVE ML017-PRICE-CHANGE-RECORD TO EL-DATA                21220000
211400         PERFORM Z910-WRITE-ERROR-REPORT                          21230000
211500     END-IF                                                       21240000
211600                                                                  21250000
211700     PERFORM K900-READ-PROMO-PRC-CHG.                             21260000
211800                                                                  21270000
211900 K900-READ-PROMO-PRC-CHG.                                         21280000
212000                                                                  21290000
212100     READ PROMO-PRC-CHG-FILE  INTO ML017-PRICE-CHANGE-RECORD      21300000
212200        AT END                                                    21310000
212300             SET END-OF-PROMO-PRC-CHG-FILE      TO TRUE.          21320000
212400                                                                  21330000
212500 L100-PROCESS-DATA-ENTRY-PR-CHG.                                  21340000
212600                                                                  21350000
212700     SET PV-DATA-ENTRY TO TRUE                                    21360000
212900                                                                  21380000
213000     ADD 1     TO  PV-DATA-ENTRY-PRC-CHG-IN                       21390000
213100                                                                  21400000
213200     MOVE ML017-PC-CDE            TO PV-TRAN-TYPE                 21410000
213300     IF ML017-MKDOWN                                              21420000
213400         SET PV-MKDOWN            TO TRUE                         21430000
213500         ADD 1 TO PV-DATA-ENTRY-MKDOWN-IN                         21440000
213600     ELSE                                                         21450000
213700         IF ML017-MKUP                                            21460000
213800             SET PV-MKUP          TO TRUE                         21470000
213900             ADD 1 TO PV-DATA-ENTRY-MKUP-IN                       21480000
214000         END-IF                                                   21490000
214100     END-IF                                                       21500000
W21731                                                                  18870000
W21731     IF  ML017-PC-SEQ-NBR = ZEROES                                18870000
W21731         IF (ML017-PC-DEPT-CLASS-NUM = ZEROES OR                  18870000
W21731             ML017-PC-DEPT-CLASS-NUM = SPACES)                    18870000
W21731             MOVE ML017-PC-SKU(1:5)   TO ML017-PC-DEPT-CLASS      18870000
W21731                                         PV-SAVE-DEPT-CLASS       18870000
W21731             MOVE ML017-PC-CLASS-NBR(1:1) TO PV-NEW-SKU-MAJ-CLASS 18870000
W21731             MOVE PV-NEW-SKU-MCL      TO ML017-PC-MAJ-CLASS       18870000
W21731         END-IF                                                   18870000
W21731     ELSE                                                         18870000
W21731*    099-10 TRANS WITH NON-000 SEQ (NOT FOUND - TSKXREF)          18870000
W21731*    MOVE 099-10-0010 TO NEW SKU ATTRIBUTES                       18870000
W21731         IF ML017-PC-SKU(1:5) = '09910'                           18870000
W21731             MOVE PC-D09910-PC-ATTR   TO ML017-PC-SKU-DTA-ATTRIB  18870000
W21731         ELSE                                                     18870000
W21731             IF (ML017-PC-DEPT-CLASS-NUM = ZEROES OR              18870000
W21731                 ML017-PC-DEPT-CLASS-NUM = SPACES)                18870000
W21731                 IF  PV-HOLD-SKU = ML017-PC-SKU                   18870000
W21731                     MOVE PV-SAVE-DEPT-CLASS-ATTR                 18870000
W21731                                      TO ML017-PC-SKU-DTA-ATTRIB  18870000
W21731                 ELSE                                             18870000
W21731                     MOVE ML017-PC-SKU    TO PV-HOLD-SKU          18870000
W21731                     MOVE PV-HOLD-SKU     TO PV-HOLD-SKU-XREF     18870000
W21731                     PERFORM Z100-RETRIEVE-SKU-ATTRIBUTES         18870000
W21731                     MOVE SKXREF-DEPT     TO ML017-PC-DEPT-NBR    18870000
W21731                                             PV-SAVE-DEPT         18870000
W21731                     MOVE SKXREF-SUBCLASS TO ML017-PC-CLASS-NBR   18870000
W21731                                             PV-SAVE-SCL          05121099
W21731                     MOVE SKXREF-CLASS    TO ML017-PC-MAJ-CLASS   18870000
W21731                                             PV-SAVE-MAJ-CL       05121099
W21731                 END-IF                                           18870000
W21731             END-IF                                               18870000
W21731         END-IF                                                   18870000
W21731     END-IF.                                                      18870000
W21731                                                                  18870000
214300     IF ML017-VALID-PC-CDE                                        21520000
W31475*        PERFORM VARYING SKIP-IDX FROM 1 BY 1 UNTIL               21530000
W31475*            SKIP-CLASS (SKIP-IDX) = ML017-PC-DEPT-CLASS OR       21540000
W31475*            SKIP-CLASS (SKIP-IDX) = SPACES              OR       21550000
W31475*            SKIP-IDX > PC-MAX-SKIP-RECS                          21560000
W31475*        END-PERFORM                                              21570000
W31475*        IF SKIP-CLASS (SKIP-IDX) = SPACES OR                     21580000
W31475*           SKIP-IDX > PC-MAX-SKIP-RECS                           21590000
W31475         SEARCH ALL SKIP-CLASS                                            
W31475         AT END                                                           
215100             ADD 1 TO PV-DATA-ENTRY-PRC-CHG-OK                    21600000
215200             IF ML017-MKDOWN                                      21610000
215300                 ADD 1 TO PV-DATA-ENTRY-MKDOWN-OK                 21620000
215400             ELSE                                                 21630000
215500                 ADD 1 TO PV-DATA-ENTRY-MKUP-OK                   21640000
215600             END-IF                                               21650000
215700             PERFORM Z400-FMT-PC-COMPOSITE-REC                    21660000
215800             PERFORM Z900-WRITE-COMPOSITE-FILE                    21670000
W31475*        ELSE                                                     21680000
W31475         WHEN SKIP-CLASS (SKIP-IDX) = ML017-PC-DEPT-CLASS         21680000
216000             ADD 1 TO PV-DATA-ENTRY-PRC-CHG-SKP                   21690000
216100             IF ML017-MKDOWN                                      21700000
216200                 ADD 1 TO PV-DATA-ENTRY-MKDOWN-SKP                21710000
216300             ELSE                                                 21720000
216400                 ADD 1 TO PV-DATA-ENTRY-MKUP-SKP                  21730000
216500             END-IF                                               21740000
W21731             MOVE ML017-PC-SKU         TO ML123-SKU               20541099
172500             MOVE ML017-PC-DEPT-NBR    TO ML123-DEPT-NBR          21741099
172500             MOVE ML017-PC-CLASS-NBR   TO ML123-CL-NBR            21742099
172500*            MOVE ML017-PC-SEQ-NBR     TO ML123-SEQ-NBR           21743099
172500             MOVE ML017-PC-CDE         TO ML123-TRN-CDE           21744099
172500             MOVE ZERO                 TO ML123-CST-AMT           21745099
172500             MOVE SPACES               TO ML123-PO-NBR            21747099
172500             MOVE 'N'                  TO ML123-COSA-IND          21747199
                   MOVE 'N'                  TO ML123-POS-IND           21747299
21015              MOVE ML017-PC-BATCH-NBR   TO ML123-BATCH-NBR         21747399
24241              MOVE ML017-PC-STORE-NBR   TO ML123-STORE-NBR                 
                   IF ML017-MKDOWN                                      21747499
                       COMPUTE PV-RTL-AMT =                             21747599
                            ML017-PC-OLD-PR-AMT - ML017-PC-NEW-PR-AMT   21747699
                       COMPUTE ML123-RTL-AMT =                          21747799
                            PV-RTL-AMT * ML017-PC-QTY                   21747899
                       PERFORM Z700-WRITE-CL-DEPT-REJECT                21747999
                   ELSE                                                 21748099
                   IF ML017-MKUP                                        21748199
                       COMPUTE PV-RTL-AMT =                             21748299
                            ML017-PC-NEW-PR-AMT - ML017-PC-OLD-PR-AMT   21748399
                       COMPUTE ML123-RTL-AMT =                          21748499
                            PV-RTL-AMT * ML017-PC-QTY                   21748599
                       PERFORM Z700-WRITE-CL-DEPT-REJECT                21748699
                   ELSE                                                 21748799
                       MOVE ZERO   TO ML123-RTL-AMT                     21748899
                       PERFORM Z700-WRITE-CL-DEPT-REJECT                21748999
W31475*        END-IF                                                   21750000
W31475             END-IF                                               21750000
W31475           END-IF                                                 21750000
W31475         END-SEARCH                                               21750000
216700     ELSE                                                         21760000
216800         ADD 1 TO  PV-DATA-ENTRY-PRC-CHG-ERR                      21770000
216900         MOVE ML017-PC-CDE          TO EL-CODE                    21780000
217000         MOVE PV-SYST-ORIGIN-DESC   TO EL-SOURCE                  21790000
217100         MOVE 'INVALID TRAN CODE'   TO EL-REASON                  21800000
217200         MOVE ML017-PRICE-CHANGE-RECORD TO EL-DATA                21810000
217300         PERFORM Z910-WRITE-ERROR-REPORT                          21820000
217400     END-IF                                                       21830000
217500                                                                  21840000
217600     PERFORM L900-READ-DATA-ENTRY-PRC-CHG.                        21850000
217700                                                                  21860000
217800 L900-READ-DATA-ENTRY-PRC-CHG.                                    21870000
217900                                                                  21880000
218000     READ DATA-ENTRY-PRC-CHG-FILE  INTO ML017-PRICE-CHANGE-RECORD 21890000
218100        AT END                                                    21900000
218200             SET END-OF-DATA-ENTRY-PRC-CHG-FILE TO TRUE.          21910000
218300                                                                  21920000
218400 M100-PROCESS-PHYS-INVEN-ADJ.                                     21930000
218500                                                                  21940000
218600     SET PV-PHYSICAL-INVENTORY                                    21950000
218800         PV-ADJUSTMENT  TO TRUE                                   21970000
218900                                                                  21980000
219000     ADD 1     TO  PV-PHYS-INVEN-ADJ-IN                           21990000
219100                                                                  22000000
219200     IF ML018-VALID-ADJ-CDE                                       22010000
W31475*        PERFORM VARYING SKIP-IDX FROM 1 BY 1 UNTIL               22020000
W31475*            SKIP-CLASS (SKIP-IDX) = ML018-ADJ-DEPT-CLASS OR      22030000
W31475*            SKIP-CLASS (SKIP-IDX) = SPACES               OR      22040000
W31475*            SKIP-IDX > PC-MAX-SKIP-RECS                          22050000
W31475*        END-PERFORM                                              22060000
W31475*        IF SKIP-CLASS (SKIP-IDX) = SPACES OR                     22070000
W31475*           SKIP-IDX > PC-MAX-SKIP-RECS                           22080000
W31475         SEARCH ALL SKIP-CLASS                                    22080000
W31475         AT END                                                   22080000
220000             PERFORM Z500-FMT-ADJ-COMPOSITE-REC                   22090000
220100             PERFORM Z900-WRITE-COMPOSITE-FILE                    22100000
220200             ADD 1 TO PV-PHYS-INVEN-ADJ-OK                        22110000
W31475*        ELSE                                                     22120000
W31475         WHEN SKIP-CLASS (SKIP-IDX) = ML018-ADJ-DEPT-CLASS        22120000
220400             ADD 1 TO PV-PHYS-INVEN-ADJ-SKP                       22130000
172500             MOVE ML018-ADJ-DEPT-CLASS  TO ML123-DEPT-CLASS       22131099
W20445*******                                    ML123-SKU              22132099
W20445                                                                          
W20445             STRING ML018-ADJ-DEPT-CLASS DELIMITED BY SIZE                
W20445                    '000' DELIMITED BY SIZE                               
W20445                                        INTO ML123-SKU                    
W20445                                                                          
172500*            MOVE ML018-ADJ-CLASS-NBR   TO ML123-CL-NBR           22132099
172500*            MOVE SPACES                TO ML123-SEQ-NBR          22133099
172500             MOVE ML018-ADJ-CDE         TO ML123-TRN-CDE          22134099
172500             MOVE ML018-ADJ-AT-COST-AMT TO ML123-CST-AMT          22135099
172500             MOVE ML018-ADJ-AT-RTL-AMT  TO ML123-RTL-AMT          22136099
172500             MOVE SPACES                TO ML123-PO-NBR           22137099
172500             MOVE 'N'                   TO ML123-COSA-IND         22137199
                   MOVE 'N'                   TO ML123-POS-IND          22137299
21015              MOVE SPACES                TO ML123-BATCH-NBR        22137399
24241              MOVE ML018-ADJ-STORE-NBR   TO ML123-STORE-NBR                
172900             PERFORM Z700-WRITE-CL-DEPT-REJECT                    22138099
W31475*        END-IF                                                   22140000
W31475         END-SEARCH                                               22140000
220600     ELSE                                                         22150000
220700         ADD 1 TO  PV-PHYS-INVEN-ADJ-ERR                          22160000
220800         MOVE ML018-ADJ-CDE         TO EL-CODE                    22170000
220900         MOVE PV-SYST-ORIGIN-DESC   TO EL-SOURCE                  22180000
221000         MOVE 'INVALID TRAN CODE'   TO EL-REASON                  22190000
221100         MOVE ML018-ADJUSTMENT-RECORD   TO EL-DATA                22200000
221200         PERFORM Z910-WRITE-ERROR-REPORT                          22210000
221300     END-IF                                                       22220000
221400                                                                  22230000
221500     PERFORM M900-READ-PHYS-INVEN-ADJ.                            22240000
221600                                                                  22250000
221700 M900-READ-PHYS-INVEN-ADJ.                                        22260000
221800                                                                  22270000
221900     READ PHYS-INVEN-ADJ-FILE        INTO ML018-ADJUSTMENT-RECORD 22280000
222000        AT END                                                    22290000
222100             SET END-OF-PHYS-INVEN-ADJ-FILE     TO TRUE.          22300000
222200                                                                  22310000
21591  N100-PROCESS-IN-TRANSIT-ADJ.                                     21930000
21591                                                                   21940000
21591      SET PV-PHYSICAL-INVENTORY                                    21950000
21591          PV-PURCHASE                                              21970000
21591          PV-JRNL-NO     TO TRUE                                   21970000
21591                                                                   21980000
21591      ADD 1     TO  PV-IN-TRANSIT-ADJ-IN                           21990000
21591                                                                   22000000
21591      IF ML015-VALID-PURCH-CDE                                     22010000
W31475*        PERFORM VARYING SKIP-IDX FROM 1 BY 1 UNTIL               22020000
W31475*            SKIP-CLASS (SKIP-IDX) = ML015-PURCH-DEPT-CLASS OR    22030000
W31475*            SKIP-CLASS (SKIP-IDX) = SPACES               OR      22040000
W31475*            SKIP-IDX > PC-MAX-SKIP-RECS                          22050000
W31475*        END-PERFORM                                              22060000
W31475*        IF SKIP-CLASS (SKIP-IDX) = SPACES OR                     22070000
W31475*           SKIP-IDX > PC-MAX-SKIP-RECS                           22080000
W31475         SEARCH ALL SKIP-CLASS                                    22080000
W31475         AT END                                                   22080000
21591              PERFORM Z200-FMT-PURCH-COMPOSITE-REC                 22090000
21591              PERFORM Z900-WRITE-COMPOSITE-FILE                    22100000
21591              ADD 1 TO PV-IN-TRANSIT-ADJ-OK                        22110000
W31475*        ELSE                                                     22120000
W31475         WHEN SKIP-CLASS (SKIP-IDX) = ML015-PURCH-DEPT-CLASS      22120000
21591              ADD 1 TO PV-IN-TRANSIT-ADJ-SKP                       22130000
W21731             MOVE ML015-PURCH-DEPT-CLASS TO ML123-DEPT-CLASS      17281099
239558             MOVE ML015-PURCH-SKU-NBR   TO  ML123-SKU             17281099
W21731*            MOVE ML015-PURCH-DEPT-NBR  TO ML123-DEPT-NBR         22131099
W21731*            MOVE ML015-PURCH-CLASS-NBR TO ML123-CL-NBR           22132099
21591**            MOVE SPACES                TO ML123-SEQ-NBR          22133099
21591              MOVE ML015-PURCH-CDE       TO ML123-TRN-CDE          22134099
21591              MOVE ML015-PURCH-NET       TO ML123-CST-AMT          22135099
21591              MOVE ML015-PURCH-RETAIL    TO ML123-RTL-AMT          22136099
21591              MOVE ML015-PURCH-PO-NBR    TO ML123-PO-NBR           22137099
21591              MOVE 'N'                   TO ML123-COSA-IND         22137199
21591              MOVE 'N'                   TO ML123-POS-IND          22137299
21591              MOVE ML015-PURCH-BATCH-NBR TO ML123-BATCH-NBR        22137399
24241              MOVE ML015-PURCH-STORE-NBR TO ML123-STORE-NBR                
21591              PERFORM Z700-WRITE-CL-DEPT-REJECT                    22138099
W31475*        END-IF                                                   22140000
W31475     END-SEARCH                                                   22150000
21591      ELSE                                                         22150000
21591          ADD 1 TO  PV-IN-TRANSIT-ADJ-ERR                          22160000
21591          MOVE ML015-PURCH-CDE       TO EL-CODE                    22170000
21591          MOVE PV-SYST-ORIGIN-DESC   TO EL-SOURCE                  22180000
21591          MOVE 'INVALID TRAN CODE'   TO EL-REASON                  22190000
21591          MOVE ML015-PURCHASE-RECORD TO EL-DATA                    22200000
21591          PERFORM Z910-WRITE-ERROR-REPORT                          22210000
21591      END-IF                                                       22220000
21591                                                                   22230000
21591      PERFORM N900-READ-IN-TRANSIT-ADJ.                            22240000
21591                                                                   22250000
21591  N900-READ-IN-TRANSIT-ADJ.                                        22260000
21591                                                                   22270000
21591      READ IN-TRANSIT-ADJ-FILE        INTO ML015-PURCHASE-RECORD   22280000
21591         AT END                                                    22290000
21591              SET END-OF-IN-TRANSIT-ADJ-FILE     TO TRUE.          22300000
21591                                                                   22310000
226200 O100-PROCESS-STORE-TRANSFER.                                     22710000
226300                                                                  22720000
226400     SET PV-DATA-ENTRY                                            22730000
226600         PV-STORE-TRANSFER TO TRUE                                22750000
226700                                                                  22760000
226800     ADD 1     TO  PV-STORE-TRANSFER-IN                           22770000
W21731                                                                  18870000
W21731     IF  ML019-TRANSFER-SEQ-NO = ZEROES                           18870000
W21731         IF (ML019-TRANSFER-DEPT-CLASS-NUM = SPACES   OR          18870000
W21731             ML019-TRANSFER-DEPT-CLASS-NUM = ZEROES)              18870000
W21731             MOVE ML019-SKU(1:5) TO ML019-TRANSFER-DEPT-CLASS     18870000
W21731         END-IF                                                   18870000
021731     ELSE                                                         18870000
W21731         IF (ML019-TRANSFER-DEPT-CLASS-NUM = SPACES   OR          18870000
W21731             ML019-TRANSFER-DEPT-CLASS-NUM = ZEROES)              18870000
W21731             MOVE ML019-SKU       TO PV-HOLD-SKU                  18870000
W21731             MOVE PV-HOLD-SKU     TO PV-HOLD-SKU-XREF             18870000
W21731             PERFORM Z100-RETRIEVE-SKU-ATTRIBUTES                 18870000
W21731             MOVE SKXREF-DEPT     TO ML019-TRANSFER-DEPT-NBR      18870000
W21731             MOVE SKXREF-SUBCLASS TO ML019-TRANSFER-CLASS-NBR     18870000
W21731         END-IF                                                   18870000
W21731     END-IF.                                                      18870000
W21731                                                                  20920000
227000     IF ML019-VALID-TRANSFER-CODE                                 22790000
W31475*        PERFORM VARYING SKIP-IDX FROM 1 BY 1 UNTIL               22800000
W31475*            SKIP-CLASS (SKIP-IDX) = ML019-TRANSFER-DEPT-CLASS OR 22810000
W31475*            SKIP-CLASS (SKIP-IDX) = SPACES                    OR 22820000
W31475*            SKIP-IDX > PC-MAX-SKIP-RECS                          22830000
W31475*        END-PERFORM                                              22840000
W31475*        IF SKIP-CLASS (SKIP-IDX) = SPACES OR                     22850000
W31475*           SKIP-IDX > PC-MAX-SKIP-RECS                           22860000
W31475         SEARCH ALL SKIP-CLASS                                            
W31475         AT END                                                           
227800             PERFORM O200-FMT-XFER-COMPOSITE-REC                  22870000
227900             PERFORM Z900-WRITE-COMPOSITE-FILE                    22880000
228000             ADD 1 TO PV-STORE-TRANSFER-OK                        22890000
W31475*        ELSE                                                     22900000
W31475         WHEN SKIP-CLASS (SKIP-IDX) = ML019-TRANSFER-DEPT-CLASS   22900000
228200             ADD 1 TO PV-STORE-TRANSFER-SKP                       22910000
172500             MOVE ML019-TRANSFER-DEPT-NBR  TO ML123-DEPT-NBR      22911099
172500             MOVE ML019-TRANSFER-CLASS-NBR TO ML123-CL-NBR        22912099
172500*            MOVE ML019-TRANSFER-SEQ-NO    TO ML123-SEQ-NBR       22913099
172500             MOVE ML019-TRANSFER-CODE      TO ML123-TRN-CDE       22914099
172500             MOVE ZERO                     TO ML123-CST-AMT       22915099
21015              COMPUTE ML123-RTL-AMT ROUNDED                        22916099
21015                             = ML019-TRANSFER-PER-UNT-RTL-AMT      22916199
21015                             * ML019-TRANSFER-QTY                  22916299
21015 *********    MOVE ML019-TRANSFER-PER-UNT-RTL-AMT TO ML123-RTL-AMT 22916399
172500             MOVE SPACES                   TO ML123-PO-NBR        22917099
172500             MOVE 'N'                      TO ML123-COSA-IND      22917199
                   MOVE 'N'                      TO ML123-POS-IND       22917299
21015              MOVE ML019-TRANSFER-BATCH-NBR TO ML123-BATCH-NBR     22917399
24241              MOVE ML019-TRANSFER-FROM-STORE-NBR                           
24241                                            TO ML123-STORE-NBR             
239558             MOVE ML019-SKU                TO ML123-SKU                   
172900             PERFORM Z700-WRITE-CL-DEPT-REJECT                    22918099
W31475*        END-IF                                                   22920000
W31475     END-SEARCH                                                   22930000
228400     ELSE                                                         22930000
228500         ADD 1 TO  PV-STORE-TRANSFER-ERR                          22940000
228600         INITIALIZE ERROR-LINE                                    22950000
228700         MOVE ML019-TRANSFER-CODE   TO EL-CODE                    22960000
228800         MOVE PV-SYST-ORIGIN-DESC   TO EL-SOURCE                  22970000
228900         MOVE 'INVALID TRAN CODE'   TO EL-REASON                  22980000
229000         MOVE ML019-TRANSFER-RECORD TO EL-DATA                    22990000
229100         PERFORM Z910-WRITE-ERROR-REPORT                          23000000
229200     END-IF                                                       23010000
229300                                                                  23020000
229400     PERFORM O900-READ-STORE-TRANSFER.                            23030000
229500                                                                  23040000
229600 O200-FMT-XFER-COMPOSITE-REC.                                     23050000
229700                                                                  23060000
229800     INITIALIZE ML020-COMPOSITE-RECORD                            23070000
229900                ML020-XFER-RECORD                                 23080000
230000                                                                  23090000
230100     MOVE ML019-TRANSFER-FROM-STORE-NBR  TO                       23100000
230200          ML020-STORE-NBR                                         23110000
230300                                                                  23120000
W21731     MOVE ML019-SKU                      TO ML020-SKU             23130000
230400     MOVE ML019-TRANSFER-DEPT-CLASS      TO ML020-DEPT-CLASS      23130000
230500*    MOVE ML019-TRANSFER-SEQ-NO          TO ML020-SEQ-NBR         23140000
230600     MOVE PV-SYST-ORIGIN                 TO ML020-SYST-ORIG-CDE   23150000
230700     MOVE PV-TRAN-TYPE                   TO ML020-TRANS-CDE       23160000
230800     MOVE ML019-TRANSFER-NBR             TO ML020-XFER-NBR        23170000
230900     IF  ML020-XFER-NBR = 'FAST '                                 23180000
231000         MOVE ML019-TRANSFER-DOC-NBR TO ML020-XFER-DOC-NBR        23190000
231100     END-IF                                                       23200000
231200                                                                  23210000
231300     MOVE PC-AP-TRANS-CDE-TRANSFER      TO ML020-XFER-AP-TRANS-CDE23220000
231400     MOVE PC-TYP-CDE-TRANSFER           TO ML020-XFER-TYP-CDE     23230000
231500                                                                  23240000
231600     MOVE ML019-TRANSFER-TO-STORE-NBR    TO                       23250000
231700          ML020-XFER-TO-STORE-NBR                                 23260000
231800                                                                  23270000
231900     MOVE ML019-TRANSFER-DTE             TO ML020-XFER-DTE        23280000
232000                                                                  23290000
232100     MOVE ML019-TRANSFER-QTY             TO ML020-XFER-QTY        23300000
232200                                                                  23310000
232300     MOVE ML019-TRANSFER-PER-UNT-RTL-AMT TO                       23320000
232400          ML020-XFER-PER-UNT-RTL-AMT                              23330000
232500                                                                  23340000
232600     COMPUTE ML020-XFER-EXTD-RTL-AMT =                            23350000
232700         (ML019-TRANSFER-QTY * ML019-TRANSFER-PER-UNT-RTL-AMT).   23360000
232800                                                                  23370000
232900     MOVE ML019-TRANSFER-BATCH-NBR       TO                       23380000
233000          ML020-XFER-BATCH-NBR                                    23390000
233100                                                                  23400000
233200     MOVE ML019-TRANSFER-KOHLS-MM        TO                       23410000
233300          ML020-XFER-KOHLS-MM.                                    23420000
233400                                                                  23430000
26006R     SET ML501-PV-SKU-LOOKUP    TO TRUE.                                  
26006R     MOVE PV-PROCESS-DATE       TO ML501-PV-EFF-DTE-IN.                   
W28545     MOVE ML019-TRANSFER-ENT-ID TO ML501-PV-ENT-ID-IN-9.                  
26006R     MOVE ML019-SKU             TO ML501-PV-SKU-IN.                       
26006R     MOVE ML019-TRANSFER-DEPT-NBR TO ML501-PV-DEPT-IN-9.                  
26006R     MOVE SPACES                TO ML501-PV-INHOUSE-NBR-IN.               
26006R     PERFORM ML501-LOOKUP-VENDOR.                                         
26006R     IF SQLCODE = ZEROES                                                  
26006R         OR SQLCODE = +100                                                
26006R         MOVE ML501-PV-ENT-ID-OUT   TO ML020-XFER-ENT-ID                  
26006R     ELSE                                                                 
26006R         MOVE 'O200-FMT-XFER-COMPOSITE-REC' TO PV-PARAGRAPH-NAME          
26006R         MOVE 'CALL TO GET VENDOR  ' TO PV-OPERATION-ATTEMPTED            
26006R         PERFORM 9999-SQL-ABEND                                           
26006R     END-IF.                                                              
26006R                                                                          
233500 O900-READ-STORE-TRANSFER.                                        23440000
233600                                                                  23450000
233700     READ STORE-TRANSFER-FILE        INTO ML019-TRANSFER-RECORD   23460000
233800        AT END                                                    23470000
233900             SET END-OF-STORE-TRANSFER-FILE     TO TRUE.          23480000
234000                                                                  23490000
W21731******************************************************************18870000
W21731* IF SKU ATTRIBUTES (DEPT/SCL) ARE NOT ON INPUT FILE, USE 8-BYTE  18870000
W21731* SKU NUMBER TO RETRIEVE ATTRIBUTES (DEPT / SUBCLASS) FROM TSKXREF18870000
W21731******************************************************************18870000
W21731 Z100-RETRIEVE-SKU-ATTRIBUTES.                                    18870000
  |                                                                     18870000
  |                                                                     18870000
  |         ADD 1 TO PV-XREF-SQL-CALLS.                                 18870000
W21731                                                                  18870000
W26603      MOVE PV-HOLD-SKU-XREF   TO SKXREF-SKU.                      18870000
W21731                                                                  18870000
  |         EXEC SQL                                                            
  |             SELECT DEPT                                                     
  |                   ,CLASS                                                    
  |                   ,SUBCLASS                                                 
  |             INTO  :SKXREF-DEPT                                              
  |                  ,:SKXREF-CLASS                                             
  |                  ,:SKXREF-SUBCLASS                                          
W21731          FROM  TSKXREF                                                   
W26603          WHERE  SKU = :SKXREF-SKU                                        
W26603          WITH UR                                                         
W21731      END-EXEC.                                                           
  |   *                                                                         
  |        EVALUATE SQLCODE                                                     
  |            WHEN 0                                                           
  |               CONTINUE                                                      
  |            WHEN +100                                                        
  |               DISPLAY ' SKU ', PV-HOLD-SKU-XREF, 'NOT FOUND'                
487868            MOVE 0         TO SKXREF-DEPT                                 
487868                              SKXREF-CLASS                                
487868                              SKXREF-SUBCLASS                             
  |            WHEN OTHER                                                       
  |               MOVE 'Z100-RETRIEVE-SKU-ATTRIBUTES'                           
  |                              TO PV-PARAGRAPH-NAME                           
  |               MOVE 'ERROR ON SELECT FROM TSKXREF'                           
  |                              TO PV-OPERATION-ATTEMPTED                      
  |               PERFORM 9999-SQL-ABEND                                        
  |        END-EVALUATE.                                                        
  |                                                                     18870000
W21731                                                                  18870000
234100 Z200-FMT-PURCH-COMPOSITE-REC.                                    23500000
234200                                                                  23510000
234300     INITIALIZE ML020-COMPOSITE-RECORD                            23520000
234400                ML020-PURCHASE-RECORD                             23530000
234500                                                                  23540000
234600     MOVE ML015-PURCH-STORE-NBR   TO ML020-STORE-NBR              23550000
234700     MOVE ML015-PURCH-DEPT-CLASS  TO ML020-DEPT-CLASS             23560000
W26603***                                  ML020-SKU                            
W26603                                                                          
W26603     MOVE ML015-PURCH-SKU-NBR     TO PV-EDIT-SKU-NBR.                     
W26603     IF (PV-EDIT-SKU-NBR IS EQUAL TO ZEROS OR SPACES)                     
W26603         STRING ML015-PURCH-DEPT-CLASS DELIMITED BY SIZE                  
W26603                '000' DELIMITED BY SIZE                                   
W26603                                  INTO ML020-SKU                          
W26603     ELSE                                                                 
W26603     IF (PV-EDIT-SKU-NBR-ALPHA (6:3) IS EQUAL TO SPACES)                  
W26603         STRING ML015-PURCH-DEPT-CLASS DELIMITED BY SIZE                  
W26603                '000' DELIMITED BY SIZE                                   
W26603                                  INTO ML020-SKU                          
W26603     ELSE                                                                 
W26603         MOVE ML015-PURCH-SKU-NBR TO ML020-SKU                            
W26603     END-IF.                                                      23560000
W26603                                                                          
234800     MOVE PV-SYST-ORIGIN          TO ML020-SYST-ORIG-CDE          23570000
234900     MOVE PV-TRAN-TYPE            TO ML020-TRANS-CDE              23580000
235000                                                                  23590000
W26603     MOVE ML015-PURCH-INV-DTE-YY  TO ML020-PURCH-DTE-YY.          MLRD015 
W26603     MOVE ML015-PURCH-INV-DTE-MM  TO ML020-PURCH-DTE-MM.          MLRD015 
W26603     MOVE ML015-PURCH-INV-DTE-DD  TO ML020-PURCH-DTE-DD.          MLRD015 
W26603***  MOVE ML015-PURCH-INV-CUT-DTE TO ML020-PURCH-DTE              23600000
235200                                                                  23610000
235300     IF ML015-PURCH-MERCH-AMT IS NUMERIC                          23620000
235400         MOVE ML015-PURCH-MERCH-AMT                               23630000
235500                                TO ML020-PURCH-EXTD-GRO-COST-AMT  23640000
235600     ELSE                                                         23650000
235700         MOVE ML015-PURCH-MERCH-AMTX                              23660000
235800                                TO ML020-PURCH-EXTD-GRO-COST-AMTX 23670000
235900     END-IF.                                                      23680000
236000                                                                  23690000
236100     IF ML015-PURCH-FRGHT-AMT IS NUMERIC                          23700000
236200         MOVE ML015-PURCH-FRGHT-AMT                               23710000
236300                                TO ML020-PURCH-FRGT-AMT           23720000
236400     ELSE                                                         23730000
236500         MOVE ML015-PURCH-FRGHT-AMTX                              23740000
236600                                TO ML020-PURCH-FRGT-AMTX          23750000
236700     END-IF.                                                      23760000
236800                                                                  23770000
236900     IF ML015-PURCH-NET IS NUMERIC                                23780000
237000         MOVE ML015-PURCH-NET                                     23790000
237100                                TO ML020-PURCH-EXTD-NET-COST-AMT  23800000
237200     ELSE                                                         23810000
237300         MOVE ML015-PURCH-NETX                                    23820000
237400                                TO ML020-PURCH-EXTD-NET-COST-AMTX 23830000
237500     END-IF.                                                      23840000
237600                                                                  23850000
237700     IF ML015-PURCH-DISCT-AMT IS NUMERIC                          23860000
237800         MOVE ML015-PURCH-DISCT-AMT                               23870000
237900                                TO ML020-PURCH-DISC-AMT           23880000
238000     ELSE                                                         23890000
238100         MOVE ML015-PURCH-DISCT-AMTX                              23900000
238200                                TO ML020-PURCH-DISC-AMTX          23910000
238300     END-IF.                                                      23920000
238400                                                                  23930000
238500     IF ML015-PURCH-RETAIL IS NUMERIC                             23940000
238600         MOVE ML015-PURCH-RETAIL                                  23950000
238700                                TO ML020-PURCH-EXTD-RTL-AMT       23960000
238800     ELSE                                                         23970000
238900         MOVE ML015-PURCH-RETAILX                                 23980000
239000                                TO ML020-PURCH-EXTD-RTL-AMTX      23990000
239100     END-IF.                                                      24000000
239200                                                                  24010000
239300     MOVE ML015-PURCH-TRANS-CDE   TO ML020-PURCH-DR-CR-CDE        24020000
239400                                                                  24030000
239500     MOVE ML015-PURCH-AP-TRANS-CDE                                24040000
239600                                  TO ML020-PURCH-AP-TRANS-CDE     24050000
239700                                     PV-AP-TRANS-CDE              24060000
239800     EVALUATE TRUE                                                24070000
B32898*        WHEN PV-AP-TRANS-CDE NOT NUMERIC                         24080000
B32898*            MOVE SPACE TO ML020-PURCH-TYP-CDE                    24090000
240100         WHEN PV-AP-TRANS-CDE-RECEIPT                             24100000
240200             SET ML020-PURCH-TYP-RECEIPT    TO TRUE               24110000
240300         WHEN PV-AP-TRANS-CDE-TRANSFER                            24120000
240400             SET ML020-PURCH-TYP-TRANSFER   TO TRUE               24130000
B32898         WHEN PV-AP-TRANS-CDE NOT NUMERIC                         24080000
B32898             MOVE SPACE TO ML020-PURCH-TYP-CDE                    24090000
240500         WHEN OTHER                                               24140000
240600             SET ML020-PURCH-TYP-ADJUSTMENT TO TRUE               24150000
240700     END-EVALUATE                                                 24160000
240800                                                                  24170000
240900     MOVE PV-JRNL-IND             TO ML020-PURCH-JRNL-IND         24180000
241000                                                                  24190000
W26603     MOVE ML015-PURCH-DOC-DTE-MM  TO ML020-PURCH-DOC-MM.          MLRD015 
W26603     MOVE ML015-PURCH-DOC-DTE-DD  TO ML020-PURCH-DOC-DD.          MLRD015 
W26603***  MOVE ML015-PURCH-DOC-DTE     TO ML020-PURCH-DOC-DTE          24200000
W26603                                                                  24190000
241200     IF ML015-PURCH-DOC-5-NBR NUMERIC                             24210000
W26603         MOVE ML015-PURCH-DOC-5-NBR (18:5)                        24220000
W26603                                      TO ML020-PURCH-DOC-5-NBR    24220000
W26603***      MOVE ML015-PURCH-DOC-5-NBR   TO ML020-PURCH-DOC-5-NBR    24220000
241400     END-IF                                                       24230000
W26603                                                                  24190000
241500     MOVE ML015-PURCH-BATCH-NBR   TO ML020-PURCH-BATCH-NBR        24240000
W26603     MOVE ML015-PURCH-PO-NBR (5:5) TO ML020-PURCH-PO-NBR          24250000
W26603     MOVE ML015-PURCH-VENDOR-INHSE-NMBR                           24260000
W26603                                  TO ML020-PURCH-VEND-NBR.        24260000
W26603                                                                          
26006      SET ML501-PV-SKU-LOOKUP    TO TRUE.                                  
26006      MOVE PV-PROCESS-DATE       TO ML501-PV-EFF-DTE-IN.                   
26006      MOVE ML015-PURCH-ENT-ID    TO ML501-PV-ENT-ID-IN-9.                  
26006      MOVE ML015-PURCH-SKU-NBR   TO ML501-PV-SKU-IN-9.                     
26006      MOVE ML015-PURCH-DEPT-NBR  TO ML501-PV-DEPT-IN-9.                    
26006      MOVE ML015-PURCH-VENDOR-INHSE-NMBR TO PV-EDIT-INHSE-NBR.             
26006      MOVE PV-EDIT-INHSE-NBR-NUM TO ML501-PV-INHOUSE-NBR-IN-9.             
W32898     MOVE ML015-PURCH-LBL-SEQ-NBR TO ML020-PURCH-LBL-SEQ-NBR.     24282099
W32898                                                                  24282099
B32898*************************************************************             
B32898*    FOR SKU RECLASS OR BRAND OR VENDOR MOVES (MLKUT410 OR                
B32898*    MLKUT213) BYPASS LOOKUP, CORRECT VENDOR ALREADY FOUND                
B32898*************************************************************             
B32898                                                                          
W34517     IF ML015-PURCH-AP-TRANS-CDE = PC-Z3 OR                               
W34517        ML015-PURCH-AP-TRANS-CDE = PC-Z4 OR                               
W34517        ML015-PURCH-AP-TRANS-CDE = PC-Z5 OR                               
W34517        ML015-PURCH-AP-TRANS-CDE = PC-Z6 OR                               
W34517        ML015-PURCH-AP-TRANS-CDE = PC-Z7 OR                               
W34517        ML015-PURCH-AP-TRANS-CDE = PC-Z8                                  
B32898         MOVE ML015-PURCH-ENT-ID        TO ML020-PURCH-ENT-ID             
W34309     ELSE                                                                 
W34309         IF PV-AP-TRANS-CDE-GB-DOMESTIC                                   
B32898             MOVE PC-DOMESTIC-VENDOR    TO ML020-PURCH-ENT-ID             
W34309             MOVE PC-2230             TO ML020-PURCH-LBL-SEQ-NBR  24282099
W34309     ELSE                                                                 
W34309         IF PV-AP-TRANS-CDE-GB-IMPORT                                     
B32898             MOVE PC-IMPORT-VENDOR      TO ML020-PURCH-ENT-ID             
W34309             MOVE PC-2230             TO ML020-PURCH-LBL-SEQ-NBR  24282099
B32898     ELSE                                                                 
26006          PERFORM ML501-LOOKUP-VENDOR                                      
26006          IF SQLCODE = ZEROES                                              
26006              OR SQLCODE = +100                                            
26006              MOVE ML501-PV-ENT-ID-OUT   TO ML020-PURCH-ENT-ID             
26006          ELSE                                                             
26006              MOVE 'Z200-FMT-PURCH-COMPOSITE-REC'                          
26006                                         TO PV-PARAGRAPH-NAME              
26006              MOVE 'CALL TO GET VENDOR  '                                  
26006                                      TO PV-OPERATION-ATTEMPTED            
26006              PERFORM 9999-SQL-ABEND                                       
26006          END-IF                                                           
W34309       END-IF                                                             
W34309       END-IF                                                             
26006      END-IF.                                                              
W26603                                                                          
241800     MOVE ML015-PURCH-KOHLS-MM    TO ML020-PURCH-KOHLS-MM.        24270000
241900                                                                  24280000
1299RM     MOVE ML015-PURCH-PO-TYP-CDE  TO ML020-PURCH-PO-TYP-CDE.      24282099
1299RM                                                                  24283099
W28582     MOVE ML015-PURCH-DOC-5-NBR(1:16)                             24282099
W28582                                  TO ML020-PURCH-DOC-16-NBR.      24282099
W28582     MOVE ML015-PURCH-PO-NBR      TO ML020-PURCH-PO-9-NBR.        24282099
W32898*    MOVE ML015-PURCH-ML-LWST-ID  TO ML020-PURCH-ML-LWST-ID.      24282099
W28582                                                                  24283099
244800 Z220-SPECIAL-DATE-CALL.                                          24570000
244900                                                                  24580000
245000     INITIALIZE DPG51                                             24590000
245100                DPG52                                             24600000
245200                DPG53                                             24610000
245300                DPG54                                             24620000
245400                DPG55                                             24630000
245500                DPG56.                                            24640099
245600                                                                  24650000
245700     SET DPG51-DO-NOT-INCR-DECR-DATE                              24660000
245800                                TO TRUE.                          24670099
245900                                                                  24680000
246000     MOVE PV-ISO-DTE            TO DPG52-LK-DATE-INPUT.           24690099
246100                                                                  24700000
246200     PERFORM Z250-CALL-DATE-ROUTINE.                              24710000
246300                                                                  24720000
246400 Z250-CALL-DATE-ROUTINE.                                          24730000
246500                                                                  24740000
246600     MOVE CC-CALENDAR-TYPE      TO DPG51-CALENDAR-TYPE            24750000
246700     SET  DPG52-LK-DTE-ISO-FMT  TO TRUE                           24760000
246800                                                                  24770000
246900     CALL PC-DPKUT500                                             24780000
247000         USING DPG51 DPG52 DPG53 DPG54 DPG55 DPG56                24790000
247100                                                                  24800000
247200     IF (DPG54-DATE-INVALID OR                                    24810000
247300         DPG54-SEVERE-ERROR)                                      24820000
247400         SET DATE-ERROR     TO TRUE                               24830000
247500         DISPLAY 'DPKUT500 Z250 ERROR = ' DPG54-ERROR-MESSAGE     24840000
247600     END-IF.                                                      24850000
247700     EJECT                                                        24860000
247800                                                                  24870000
247900 Z300-FMT-SALE-COMPOSITE-REC.                                     24880000
248000                                                                  24890000
248100     INITIALIZE ML020-COMPOSITE-RECORD                            24900000
248200                ML020-SALES-RECORD                                24910000
248300                                                                  24920000
248400     MOVE ML016-SALE-STORE-NBR    TO ML020-STORE-NBR              24930000
248500     MOVE ML016-SALE-DEPT-CLASS   TO ML020-DEPT-CLASS             24940000
248600     MOVE PV-SYST-ORIGIN          TO ML020-SYST-ORIG-CDE          24950000
248700     MOVE PV-TRAN-TYPE            TO ML020-TRANS-CDE              24960000
248800                                                                  24970000
248900                                                                  24980000
249000     MOVE ML016-SALE-DTE          TO ML020-SALE-DTE               24990000
249100                                                                  25000000
249200     MOVE ML016-SALE-EXTD-RTL-AMT TO ML020-SALE-EXTD-RTL-AMT      25010000
249300                                                                  25020000
249400     IF ML016-NEGATIVE-CORRECTION                                 25030000
249500         COMPUTE ML020-SALE-EXTD-RTL-AMT =                        25040000
249600                 ML020-SALE-EXTD-RTL-AMT * -1                     25050000
249700     END-IF.                                                      25060000
249800                                                                  25070000
249810     MOVE PC-SALES-CORR-TYPE      TO ML020-SALE-TYPE-2.           25080000
249810     SET ML020-SALES-AUDIT-CORR   TO TRUE.                        25081099
249900                                                                  25090000
250000 Z400-FMT-PC-COMPOSITE-REC.                                       25100000
250100                                                                  25110000
250200     INITIALIZE ML020-COMPOSITE-RECORD                            25120000
250300                ML020-PRICE-CHANGE-RECORD                         25130000
250400                                                                  25140000
250500     MOVE ML017-PC-STORE-NBR      TO ML020-STORE-NBR              25150000
250600     MOVE ML017-PC-SKU            TO ML020-SKU                    25160000
W21731     MOVE ML017-PC-DEPT-NBR       TO ML020-DEPT-NBR               25160000
W21731     MOVE ML017-PC-CLASS-NBR      TO ML020-CLASS-NBR              25160000
250700     MOVE PV-SYST-ORIGIN          TO ML020-SYST-ORIG-CDE          25170000
250800                                                                  25180000
250900     MOVE PV-TRAN-TYPE            TO ML020-TRANS-CDE              25190000
251000                                                                  25200000
251100     MOVE ML017-PC-DTE            TO ML020-PC-DTE                 25210000
251200     MOVE ML017-PC-OLD-PR-AMT     TO ML020-PC-OLD-PR-AMT          25220000
251300     MOVE ML017-PC-NEW-PR-AMT     TO ML020-PC-NEW-PR-AMT          25230000
251400     MOVE ML017-PC-QTY            TO ML020-PC-QTY                 25240000
251500     MOVE ML017-PC-RSN-CDE        TO ML020-PC-OLD-RSN-CDE         25250000
251600                                                                  25260000
251700     IF ML017-PC-DOC-5-NBR NUMERIC                                25270000
251800         MOVE ML017-PC-DOC-5-NBR  TO ML020-PC-DOC-5-NBR           25280000
251900     END-IF                                                       25290000
252000                                                                  25300000
252100     MOVE ZERO                    TO ML020-PC-BATCH-NBR-1         25310000
252200     MOVE ML017-PC-BATCH-NBR      TO ML020-PC-BATCH-NBR-3         25320000
252300                                                                  25330000
252400     IF ML017-PC-MKDN-MKUP-RSN-CDE = SPACES OR '000'              25340000
252500         MOVE ML017-PC-BATCH-NBR  TO ML020-PC-MKDN-MKUP-RSN-CDE   25350000
252600     ELSE                                                         25360000
252700         MOVE ML017-PC-MKDN-MKUP-RSN-CDE                          25370000
252800                                  TO ML020-PC-MKDN-MKUP-RSN-CDE   25380000
252900     END-IF                                                       25390000
W29145                                                                  25400000
W29145     MOVE ML017-ORIG-CLR-DTE      TO ML020-PC-ORIG-CLR-DTE.       25410000
W29145     MOVE ML017-MKDN-CDE          TO ML020-PC-MKDN-CDE.           25420000
S29145                                                                  25420000
S29145     IF ML017-ORIG-CLR-NONGRP-RTL > 0                             25420000
S29145         MOVE ML017-ORIG-CLR-NONGRP-RTL                           25420000
S29145                                  TO ML020-PC-ORIG-RTL-NONGRP     25420000
S29145     ELSE                                                         25420000
S29145         MOVE ZEROES              TO ML020-PC-ORIG-RTL-NONGRP     25420000
S29145     END-IF.                                                      25400000
S29145                                                                  25400000
253000                                                                  25400000
253100     MOVE ML017-PC-CATEG-CDE      TO ML020-PC-CATEG-CDE           25410000
253200     MOVE ML017-PC-DOC-7-NBR      TO ML020-PC-DOC-7-NBR           25420000
253300     MOVE ML017-PC-KOHLS-MM       TO ML020-PC-KOHLS-MM.           25430000
253400                                                                  25440000
1099RM     MOVE ML017-PC-VENDOR-INHSE-NMBR TO                           25441099
1099RM          ML020-PC-VENDOR-INHSE-NMBR.                             25442099
W26603                                                                          
W28582     MOVE ML017-PC-DOC-16-NBR   TO ML020-PC-DOC-16-NBR.                   
W28582     MOVE ML017-PC-AP-TRANS-CDE TO ML020-PC-AP-TRANS-CDE.                 
W28582                                                                          
26006      SET ML501-PV-SKU-LOOKUP    TO TRUE.                                  
26006      MOVE PV-PROCESS-DATE       TO ML501-PV-EFF-DTE-IN.                   
26006      MOVE ML017-PC-ENT-ID       TO ML501-PV-ENT-ID-IN-9.                  
26006      MOVE ML017-PC-SKU          TO ML501-PV-SKU-IN.                       
26006      MOVE ML017-PC-DEPT-NBR     TO ML501-PV-DEPT-IN-9.                    
26006      MOVE ML017-PC-VENDOR-INHSE-NMBR TO ML501-PV-INHOUSE-NBR-IN.          
26006      PERFORM ML501-LOOKUP-VENDOR.                                         
26006      IF SQLCODE = ZEROES                                                  
26006          OR SQLCODE = +100                                                
26006          IF ML501-PV-ENT-ID-OUT = +5161                                   
26006 *  TEMPORARILY ASSIGN TO ZERO TO ALLOW PRICE CHANGE PRORATION             
26006              MOVE ZEROES                TO ML020-PC-ENT-ID                
26006          ELSE                                                             
26006              MOVE ML501-PV-ENT-ID-OUT   TO ML020-PC-ENT-ID                
26006          END-IF                                                           
26006      ELSE                                                                 
26006          MOVE 'Z400-FMT-PC-COMPOSITE-REC' TO PV-PARAGRAPH-NAME            
26006          MOVE 'CALL TO GET VENDOR  ' TO PV-OPERATION-ATTEMPTED            
26006          PERFORM 9999-SQL-ABEND                                           
26006      END-IF.                                                              
                                                                                
253500 Z500-FMT-ADJ-COMPOSITE-REC.                                      25450000
253600                                                                  25460000
253700     INITIALIZE ML020-COMPOSITE-RECORD                            25470000
253800                ML020-ADJUSTMENT-RECORD                           25480000
253900                                                                  25490000
254000     MOVE ML018-ADJ-STORE-NBR     TO ML020-STORE-NBR              25500000
254100     MOVE ML018-ADJ-DEPT-CLASS    TO ML020-DEPT-CLASS             25510000
W20445                                                                          
W20445     STRING ML018-ADJ-DEPT-CLASS DELIMITED BY SIZE                        
W20445            '000' DELIMITED BY SIZE                                       
W20445                                  INTO ML020-SKU.                         
W20445                                                                          
254200     MOVE PV-SYST-ORIGIN          TO ML020-SYST-ORIG-CDE          25520000
254300                                                                  25530000
254400     MOVE PV-TRAN-TYPE            TO ML020-TRANS-CDE              25540000
254500                                                                  25550000
254600     MOVE ML018-ADJ-AT-RTL-AMT    TO ML020-ADJ-AT-RTL-AMT         25560000
254700     MOVE ML018-ADJ-AT-COST-AMT   TO ML020-ADJ-AT-COST-AMT        25570000
254800     MOVE ML018-ADJ-KOHLS-MM      TO ML020-ADJ-KOHLS-MM.          25580000
254900     MOVE ML018-ADJ-DTE           TO ML020-ADJ-DTE.               25590000
W20445     MOVE ML018-ADJ-ENT-ID        TO ML020-ADJ-ENT-ID.                    
W28582     MOVE ML018-ADJ-ML-LWST-ID    TO ML020-ADJ-ML-LWST-ID.                
255000                                                                  25600000
255100 Z600-WRITE-PURCH-REJECT.                                         25610000
255200                                                                  25620000
255300     WRITE REJECT-REC150 FROM ML015-PURCHASE-RECORD.              25630000
255400                                                                  25640000
255500                                                                  25650000
255100 Z700-WRITE-CL-DEPT-REJECT.                                       25651099
255200                                                                  25652099
255300     WRITE CL-DEPT-REJECT-REC FROM ML123-RECORD.                  25653099
255400                                                                  25654099
255500                                                                  25655099
255600 Z900-WRITE-COMPOSITE-FILE.                                       25660000
255700                                                                  25670000
256000     WRITE COMPOSITE-REC FROM                                     25700099
256100           ML020-COMPOSITE-RECORD.                                25710099
257200                                                                  25820000
259700                                                                  25912900
264100 Z910-WRITE-ERROR-REPORT.                                         26280000
264200                                                                  26290000
264300     IF PV-LINE-COUNT > 58                                        26300000
264400         PERFORM Z998-WRITE-HEADINGS                              26310000
264500     END-IF.                                                      26320000
264600                                                                  26330000
264700     EVALUATE TRUE                                                26340000
264800         WHEN ERROR-LINE-CC = ' '                                 26350000
264900             ADD  1 TO  PV-LINE-COUNT                             26360000
265000         WHEN ERROR-LINE-CC = '0'                                 26370000
265100             ADD  2 TO  PV-LINE-COUNT                             26380000
265200     END-EVALUATE.                                                26390000
265300                                                                  26400000
265400     MOVE ERROR-LINE TO ERROR-REC.                                26410000
265500                                                                  26420000
265600     PERFORM Z999-WRITE-ERROR-REPORT.                             26430000
265700                                                                  26440000
265700                                                                  26441099
265800 Z998-WRITE-HEADINGS.                                             26450000
265900                                                                  26460000
266000     ADD 1              TO PV-PAGE-COUNT                          26470000
266100                                                                  26480000
266200     MOVE PV-PAGE-COUNT TO DP133O-PAGE-NUMBER.                    26490000
266300     MOVE 1             TO DP133O-REPORT-NUMBER.                  26500000
266400     MOVE DP133O-STANDRD-HEADER-133-COLS TO ERROR-REC.            26510000
266500     MOVE '1'           TO ERROR-LINE-CC                          26520000
266600     MOVE ' '           TO EL-HEADER-FONT-INDICATOR               26530000
266700                                                                  26540000
266800     PERFORM Z999-WRITE-ERROR-REPORT                              26550000
266900                                                                  26560000
267000     MOVE HEADER2       TO ERROR-REC                              26570000
267100     PERFORM Z999-WRITE-ERROR-REPORT                              26580000
267200                                                                  26590000
267300     MOVE HEADER3       TO ERROR-REC                              26600000
267400     PERFORM Z999-WRITE-ERROR-REPORT                              26610000
267500                                                                  26620000
267600     MOVE 4 TO PV-LINE-COUNT.                                     26630000
267700                                                                  26640000
267800 Z999-WRITE-ERROR-REPORT.                                         26650000
267900                                                                  26660000
268000     WRITE ERROR-REC.                                             26670000
268100                                                                  26680000
268200 Z999-ABEND.                                                      26690000
268300                                                                  26700000
268400     CALL 'ILBOABN0'             USING ABEND-CODE.                26710000
268500                                                                  26720000
      ******************************************************************        
      *  STANDARD DB2 ERROR ABEND ROUTINE                                       
      *  THIS ROUTINE FORCES AN ABEND DUE TO A DB2 PROBLEM.                     
      ******************************************************************        
       9999-SQL-ABEND.                                                          
                                                                                
           MOVE +4013                 TO ABEND-CODE.                            
           DISPLAY '**  ABEND     **'.                                          
           DISPLAY '**  PROGRAM   ** => ' PC-PROGRAM-NAME.                      
           DISPLAY '**  PARAGRAPH **  = ' PV-PARAGRAPH-NAME.                    
           DISPLAY '**  OPERATION **  = ' PV-OPERATION-ATTEMPTED.               
                                                                                
      *    THE FOLLOWING COPYBOOK UTILIZES THE DB2 ABEND MODULE                 
      *    DSNTIAR TO CONVERT SQLCA INTO UNDERSTANDABLE VERBAGE.                
                                                                                
           COPY DPPD004.                                                        
           CALL 'ILBOABN0'  USING ABEND-CODE.                                   
                                                                                
26006 *ML501-LOOKUP-VENDOR.                                                     
26006 *ML501-LOOKUP-DEFAULT.                                                    
26006 *ML501-LOOKUP-BY-SKU.                                                     
26006 *ML501-LOOKUP-BY-UPC-NBR.                                                 
26006 *ML501-LOOKUP-BY-UPC-ID.                                                  
26006 *ML501-LOOKUP-BY-ITM-NBR.                                                 
26006 *ML501-LOOKUP-BY-INHOUSE.                                                 
W31475*    COPY MLPD501.                                                        
      ******************************************************************        
      * START LOOKING UP VENDOR INFORMATION                                     
      ******************************************************************        
       ML501-LOOKUP-VENDOR.                                                     
                                                                                
           SET ML501-PV-FOUND-AS-REQUESTED  TO TRUE.                            
           MOVE SPACES                      TO ML501-PV-RETURN-RSN              
           MOVE ZEROES                      TO SQLCODE.                         
                                                                                
           IF ML501-PV-ENT-ID-IN = SPACES                                       
               OR ML501-PV-ENT-ID-IN NOT NUMERIC                                
               OR ML501-PV-ENT-ID-IN = ZEROES                                   
               PERFORM ML501-CHECK-OPTION                                       
26006          IF ML501-PV-ENT-ID-OUT IS EQUAL TO ZEROES                        
26006              SET ML501-PV-ENT-NOT-FOUND TO TRUE                           
26006          END-IF                                                           
           ELSE                                                                 
               SET ML501-PV-ENT-ID-GIVEN    TO TRUE                             
               MOVE ML501-PV-ENT-ID-IN      TO ML501-PV-ENT-ID-OUT              
           END-IF.                                                              
                                                                                
           MOVE SPACES                      TO ML501-PV-ENT-ID-IN               
                                               ML501-PV-INHOUSE-NBR-IN          
                                               ML501-PV-DEPT-IN                 
                                               ML501-PV-SKU-IN                  
                                               ML501-PV-UPC-NBR-IN              
                                               ML501-PV-UPC-ID-IN               
                                               ML501-PV-ITM-NBR-IN.             
                                                                                
      ******************************************************************        
      * VALIDATE/CHECK OPTION FROM INPUT PARAMETERS                             
      ******************************************************************        
       ML501-CHECK-OPTION.                                                      
                                                                                
           EVALUATE TRUE                                                        
               WHEN ML501-PV-SKU-LOOKUP                                         
                   IF ML501-PV-SKU-IN = SPACES                                  
                       OR ML501-PV-SKU-IN NOT NUMERIC                           
                       OR ML501-PV-SKU-IN = ZEROES                              
                       OR ML501-PV-DUMMY-SKU                                    
                       IF NOT ML501-PV-DUMMY-SKU                                
                           DISPLAY ' *** BAD SKU ' ML501-PV-SKU-IN              
                                   ', ATTEMPT DEFAULT LOOKUP'                   
                       END-IF                                                   
                       PERFORM ML501-LOOKUP-DEFAULT                             
                   ELSE                                                         
                       MOVE ML501-PV-SKU-IN-9 TO ML501-PV-WORK-SKU              
                       PERFORM ML501-LOOKUP-BY-SKU                              
                   END-IF                                                       
               WHEN ML501-PV-UPC-NBR-LOOKUP                                     
                   IF ML501-PV-UPC-NBR-IN = SPACES                              
                       OR ML501-PV-UPC-NBR-IN NOT NUMERIC                       
                       OR ML501-PV-UPC-NBR-IN = ZEROES                          
                       DISPLAY ' *** BAD UPC-NBR ' ML501-PV-UPC-NBR-IN          
                               ', ATTEMPT DEFAULT LOOKUP'                       
                       PERFORM ML501-LOOKUP-DEFAULT                             
                   ELSE                                                         
                       MOVE ML501-PV-UPC-NBR-IN-9                               
                           TO ML501-PV-WORK-UPC-NBR                             
                       PERFORM ML501-LOOKUP-BY-UPC-NBR                          
                   END-IF                                                       
               WHEN ML501-PV-UPC-ID-LOOKUP                                      
                   IF ML501-PV-UPC-ID-IN = SPACES                               
                       OR ML501-PV-UPC-ID-IN NOT NUMERIC                        
                       OR ML501-PV-UPC-ID-IN = ZEROES                           
                       DISPLAY ' *** BAD UPC-ID ' ML501-PV-UPC-ID-IN            
                               ', ATTEMPT DEFAULT LOOKUP'                       
                       PERFORM ML501-LOOKUP-DEFAULT                             
                   ELSE                                                         
                       MOVE ML501-PV-UPC-ID-IN-9 TO ML501-PV-WORK-UPC-ID        
                       PERFORM ML501-LOOKUP-BY-UPC-ID                           
                   END-IF                                                       
               WHEN ML501-PV-ITM-NBR-LOOKUP                                     
                   IF ML501-PV-ITM-NBR-IN = SPACES                              
                       OR ML501-PV-ITM-NBR-IN NOT NUMERIC                       
                       OR ML501-PV-ITM-NBR-IN = ZEROES                          
                       DISPLAY ' *** BAD ITM-NBR ' ML501-PV-UPC-NBR-IN          
                               ', ATTEMPT DEFAULT LOOKUP'                       
                       PERFORM ML501-LOOKUP-DEFAULT                             
                   ELSE                                                         
                       MOVE ML501-PV-ITM-NBR-IN-9                               
                           TO ML501-PV-WORK-ITM-NBR                             
                       PERFORM ML501-LOOKUP-BY-ITM-NBR                          
                   END-IF                                                       
               WHEN ML501-PV-INHOUSE-LOOKUP                                     
                   IF (ML501-PV-INHOUSE-NBR-IN = SPACES OR                      
                       ML501-PV-INHOUSE-NBR-IN NOT NUMERIC OR                   
                       ML501-PV-INHOUSE-NBR-IN = ZEROES)                        
                       OR                                                       
                       (ML501-PV-DEPT-IN = SPACES OR                            
                        ML501-PV-DEPT-IN NOT NUMERIC OR                         
                        ML501-PV-DEPT-IN = ZEROES)                              
                       DISPLAY ' *** BAD DEPT ' ML501-PV-DEPT-IN                
                               ' OR IN-HOUSE ' ML501-PV-INHOUSE-NBR-IN          
26006                  MOVE ZEROES            TO ML501-PV-ENT-ID-OUT            
26006                  SET ML501-PV-NOT-FOUND TO TRUE                           
                   ELSE                                                         
                       PERFORM ML501-LOOKUP-BY-INHOUSE                          
                   END-IF                                                       
               WHEN OTHER                                                       
                   PERFORM ML501-LOOKUP-DEFAULT                                 
           END-EVALUATE.                                                        
                                                                                
      * ATTEMPT LOOKUP USING INHOUSE NUMBER, IF IT IS NOT ALREADY TRIED         
           IF (ML501-PV-NOT-FOUND OR ML501-PV-SQL-ERROR)                        
               AND NOT ML501-PV-INHOUSE-LOOKUP                                  
               IF (ML501-PV-INHOUSE-NBR-IN = SPACES OR                          
                   ML501-PV-INHOUSE-NBR-IN NOT NUMERIC OR                       
                   ML501-PV-INHOUSE-NBR-IN = ZEROES)                            
                   OR                                                           
                   (ML501-PV-DEPT-IN = SPACES OR                                
                    ML501-PV-DEPT-IN NOT NUMERIC OR                             
                    ML501-PV-DEPT-IN = ZEROES)                                  
                   CONTINUE                                                     
               ELSE                                                             
                   MOVE ML501-PV-INHOUSE-NBR-IN-9                               
                       TO ML501-PV-WORK-INHOUSE                                 
                   MOVE ML501-PV-DEPT-IN-9    TO ML501-PV-WORK-DEPT-9           
                   PERFORM ML501-LOOKUP-BY-INHOUSE                              
               END-IF                                                           
           END-IF.                                                              
                                                                                
      ******************************************************************        
      * DEFAULT VENDOR INFORMATION LOOKUP                                       
      * - THIS ROUTINE WILL CHECK FOR A NON-ZERO/NON-SPACE AND VALID            
      *   NUMERIC ENT-ID IN THE INPUT PARAMETER.  RETURN THE INPUT              
      *   ENT-ID AS GIVEN.                                                      
      * - CHECK SKU, UPC-NBR, UPC-ID, THEN ITM-NBR IN THE GIVEN ORDER           
      *   AND USE THE FIRST NON-SPACE/NON-ZERO AND VALID NUMERIC AS A           
      *   BASIS FOR THE LOOKUP.                                                 
      * - LAST ATTEMPT WILL USE THE INHOUSE NUMBER ALONG WITH DEPT              
      *   TO FIND THE ENT-ID, IF INHOUSE NUMBER AND DEPT ARE NON-SPACE/         
      *   NON-ZERO AND VALID NUMERIC.                                           
      * - FAILURE FROM THESE ATTEMPTS WILL RESULT IN A NOT FOUND                
      *   CONDITION BEING RETURNED.                                             
      ******************************************************************        
       ML501-LOOKUP-DEFAULT.                                                    
                                                                                
           SET ML501-PV-FOUND-WITH-ASSUMPTION TO TRUE.                          
                                                                                
           IF ML501-PV-SKU-IN = SPACES                                          
               OR ML501-PV-SKU-IN NOT NUMERIC                                   
               OR ML501-PV-SKU-IN = ZEROES                                      
               OR ML501-PV-DUMMY-SKU                                            
               IF ML501-PV-UPC-NBR-IN = SPACES                                  
                   OR ML501-PV-UPC-NBR-IN NOT NUMERIC                           
                   OR ML501-PV-UPC-NBR-IN = ZEROES                              
                   IF ML501-PV-UPC-ID-IN = SPACES                               
                       OR ML501-PV-UPC-ID-IN NOT NUMERIC                        
                       OR ML501-PV-UPC-ID-IN = ZEROES                           
                       IF ML501-PV-ITM-NBR-IN = SPACES                          
                           OR ML501-PV-ITM-NBR-IN NOT NUMERIC                   
                           OR ML501-PV-ITM-NBR-IN = ZEROES                      
                           IF (ML501-PV-INHOUSE-NBR-IN = SPACES OR              
                               ML501-PV-INHOUSE-NBR-IN NOT NUMERIC OR           
                               ML501-PV-INHOUSE-NBR-IN = ZEROES)                
                               OR                                               
                               (ML501-PV-DEPT-IN = SPACES OR                    
                                ML501-PV-DEPT-IN NOT NUMERIC OR                 
                                ML501-PV-DEPT-IN = ZEROES)                      
                               SET ML501-PV-NO-LOOKUP-TYPE    TO TRUE           
                           ELSE                                                 
                               SET ML501-PV-TRY-INHOUSE-LOOKUP TO TRUE          
                               SET ML501-PV-INHOUSE-LOOKUP    TO TRUE           
                           END-IF                                               
                       ELSE                                                     
                           SET ML501-PV-TRY-ITM-NBR-LOOKUP TO TRUE              
                           SET ML501-PV-ITM-NBR-LOOKUP    TO TRUE               
                       END-IF                                                   
                   ELSE                                                         
                       SET ML501-PV-TRY-UPC-ID-LOOKUP TO TRUE                   
                       SET ML501-PV-UPC-ID-LOOKUP     TO TRUE                   
                   END-IF                                                       
               ELSE                                                             
                   SET ML501-PV-TRY-UPC-NBR-LOOKUP TO TRUE                      
                   SET ML501-PV-UPC-NBR-LOOKUP    TO TRUE                       
               END-IF                                                           
           ELSE                                                                 
               SET ML501-PV-TRY-SKU-LOOKUP    TO TRUE                           
               SET ML501-PV-SKU-LOOKUP        TO TRUE                           
           END-IF.                                                              
                                                                                
           EVALUATE TRUE                                                        
               WHEN ML501-PV-SKU-LOOKUP                                         
                   MOVE ML501-PV-SKU-IN-9     TO ML501-PV-WORK-SKU              
                   PERFORM ML501-LOOKUP-BY-SKU                                  
               WHEN ML501-PV-UPC-NBR-LOOKUP                                     
                   MOVE ML501-PV-UPC-NBR-IN-9 TO ML501-PV-WORK-UPC-NBR          
                   PERFORM ML501-LOOKUP-BY-UPC-NBR                              
               WHEN ML501-PV-UPC-ID-LOOKUP                                      
                   MOVE ML501-PV-UPC-ID-IN-9  TO ML501-PV-WORK-UPC-ID           
                   PERFORM ML501-LOOKUP-BY-UPC-ID                               
               WHEN ML501-PV-ITM-NBR-LOOKUP                                     
                   MOVE ML501-PV-ITM-NBR-IN-9 TO ML501-PV-WORK-ITM-NBR          
                   PERFORM ML501-LOOKUP-BY-ITM-NBR                              
               WHEN ML501-PV-INHOUSE-LOOKUP                                     
                   MOVE ML501-PV-INHOUSE-NBR-IN-9                               
                       TO ML501-PV-WORK-INHOUSE                                 
                   MOVE ML501-PV-DEPT-IN-9    TO ML501-PV-WORK-DEPT-9           
                   PERFORM ML501-LOOKUP-BY-INHOUSE                              
               WHEN OTHER                                                       
                   MOVE ZEROES                TO ML501-PV-ENT-ID-OUT            
                   SET ML501-PV-NOT-FOUND     TO TRUE                           
                   SET ML501-PV-FAIL-ASSUMPTION-RULE TO TRUE                    
           END-EVALUATE.                                                        
                                                                                
      * ATTEMPT LOOKUP USING INHOUSE NUMBER, IF IT IS NOT ALREADY TRIED         
           IF (ML501-PV-NOT-FOUND OR ML501-PV-SQL-ERROR)                        
               AND NOT ML501-PV-INHOUSE-LOOKUP                                  
               AND NOT ML501-PV-FAIL-ASSUMPTION-RULE                            
               IF (ML501-PV-INHOUSE-NBR-IN = SPACES OR                          
                   ML501-PV-INHOUSE-NBR-IN NOT NUMERIC OR                       
                   ML501-PV-INHOUSE-NBR-IN = ZEROES)                            
                   OR                                                           
                   (ML501-PV-DEPT-IN = SPACES OR                                
                    ML501-PV-DEPT-IN NOT NUMERIC OR                             
                    ML501-PV-DEPT-IN = ZEROES)                                  
                   CONTINUE                                                     
               ELSE                                                             
                   MOVE ML501-PV-INHOUSE-NBR-IN-9                               
                       TO ML501-PV-WORK-INHOUSE                                 
                   MOVE ML501-PV-DEPT-IN-9    TO ML501-PV-WORK-DEPT-9           
                   PERFORM ML501-LOOKUP-BY-INHOUSE                              
               END-IF                                                           
           END-IF.                                                              
                                                                                
      ******************************************************************        
      * VENDOR LOOKUP BY SKU                                                    
      ******************************************************************        
       ML501-LOOKUP-BY-SKU.                                                     
W31475     IF ML501-PV-WORK-SKU = PV-WORK-SKU AND                               
W31475        PV-EFF-DTE-IN1 = ML501-PV-EFF-DTE-IN                              
W31475         MOVE PV-SKU-ENT-ID   TO ML501-PV-ENT-ID-OUT                      
W31475        IF PV-SKU-RETURN-CDE NOT = +99                                    
W31475           MOVE PV-SKU-RETURN-CDE TO ML501-PV-RETURN-CDE                  
W31475        END-IF                                                            
W31475     ELSE                                                                 
            EXEC SQL                                                            
               SELECT                                                           
                      C.ENT_ID                                                  
                 INTO                                                           
                      :ML501-PV-ENT-ID-OUT                                      
                 FROM                                                           
                      TSKXREF    A                                              
                     ,TUPC       B                                              
                     ,TVNDSTL    C                                              
                WHERE                                                           
                      A.SKU         = :ML501-PV-WORK-SKU                        
                  AND A.SKU_STAT_CDE NOT IN ('98', '00')                        
                  AND A.INTR_UPC_ID     = B.UPC_ID                              
                  AND B.VS_ID           = C.VS_ID                               
                  AND :ML501-PV-EFF-DTE-IN                                      
                          BETWEEN B.EFF_BEG_DTE                                 
                          AND COALESCE(B.EFF_END_DTE, '9999-12-31')             
                WITH UR                                                         
            END-EXEC                                                            
                                                                                
            EVALUATE TRUE                                                       
               WHEN SQLCODE = 0                                                 
W31475*            CONTINUE                                                     
W31475             MOVE +99 TO PV-SKU-RETURN-CDE                                
               WHEN SQLCODE = +100                                              
                   MOVE ZEROES            TO ML501-PV-ENT-ID-OUT                
                   SET ML501-PV-NOT-FOUND TO TRUE                               
W31475             MOVE +08 TO PV-SKU-RETURN-CDE                                
               WHEN OTHER                                                       
                   MOVE ZEROES            TO ML501-PV-ENT-ID-OUT                
                   SET ML501-PV-SQL-ERROR TO TRUE                               
W31475             MOVE +16 TO PV-SKU-RETURN-CDE                                
                   DISPLAY ' *** FAIL VENDOR LOOKUP'                            
                           '     PARAGRAPH: ML501-LOOKUP-BY-SKU'                
                   DISPLAY '     SKU = ' ML501-PV-WORK-SKU                      
                           ' EFF DATE = ' ML501-PV-EFF-DTE-IN                   
                           ' SQLCODE = ' SQLCODE                                
            END-EVALUATE                                                        
W31475      MOVE ML501-PV-ENT-ID-OUT TO PV-SKU-ENT-ID                           
W31475      MOVE ML501-PV-WORK-SKU   TO PV-WORK-SKU                             
W31475      MOVE ML501-PV-EFF-DTE-IN TO PV-EFF-DTE-IN1                          
W31475      END-IF.                                                             
                                                                                
      ******************************************************************        
      * VENDOR LOOKUP BY UPC-NBR                                                
      ******************************************************************        
       ML501-LOOKUP-BY-UPC-NBR.                                                 
                                                                                
           EXEC SQL                                                             
               SELECT                                                           
                      C.ENT_ID                                                  
                 INTO                                                           
                      :ML501-PV-ENT-ID-OUT                                      
                 FROM                                                           
                      TUPC       B                                              
                     ,TVNDSTL    C                                              
                WHERE                                                           
                      B.UPC_NBR         = :ML501-PV-WORK-UPC-NBR                
                  AND B.VS_ID           = C.VS_ID                               
                  AND :ML501-PV-EFF-DTE-IN                                      
                          BETWEEN B.EFF_BEG_DTE                                 
                          AND COALESCE(B.EFF_END_DTE, '9999-12-31')             
                WITH UR                                                         
           END-EXEC.                                                            
                                                                                
           EVALUATE TRUE                                                        
               WHEN SQLCODE = 0                                                 
                   CONTINUE                                                     
               WHEN SQLCODE = +100                                              
                   MOVE ZEROES            TO ML501-PV-ENT-ID-OUT                
                   SET ML501-PV-NOT-FOUND TO TRUE                               
               WHEN OTHER                                                       
                   MOVE ZEROES            TO ML501-PV-ENT-ID-OUT                
                   SET ML501-PV-SQL-ERROR TO TRUE                               
                   DISPLAY ' *** FAIL VENDOR LOOKUP'                            
                           '     PARAGRAPH: ML501-LOOKUP-BY-UPC-NBR'            
                   DISPLAY '     UPC-NBR = ' ML501-PV-WORK-UPC-NBR              
                           ' EFF DATE = ' ML501-PV-EFF-DTE-IN                   
                           ' SQLCODE = ' SQLCODE                                
           END-EVALUATE.                                                        
                                                                                
      ******************************************************************        
      * VENDOR LOOKUP BY UPC-ID                                                 
      ******************************************************************        
       ML501-LOOKUP-BY-UPC-ID.                                                  
                                                                                
           EXEC SQL                                                             
               SELECT                                                           
                      C.ENT_ID                                                  
                 INTO                                                           
                      :ML501-PV-ENT-ID-OUT                                      
                 FROM                                                           
                      TUPC       B                                              
                     ,TVNDSTL    C                                              
                WHERE                                                           
                      B.UPC_ID          = :ML501-PV-WORK-UPC-ID                 
                  AND B.VS_ID           = C.VS_ID                               
                  AND :ML501-PV-EFF-DTE-IN                                      
                          BETWEEN B.EFF_BEG_DTE                                 
                          AND COALESCE(B.EFF_END_DTE, '9999-12-31')             
                WITH UR                                                         
           END-EXEC.                                                            
                                                                                
           EVALUATE TRUE                                                        
               WHEN SQLCODE = 0                                                 
                   CONTINUE                                                     
               WHEN SQLCODE = +100                                              
                   MOVE ZEROES            TO ML501-PV-ENT-ID-OUT                
                   SET ML501-PV-NOT-FOUND TO TRUE                               
               WHEN OTHER                                                       
                   MOVE ZEROES            TO ML501-PV-ENT-ID-OUT                
                   SET ML501-PV-SQL-ERROR TO TRUE                               
                   DISPLAY ' *** FAIL VENDOR LOOKUP'                            
                           '     PARAGRAPH: ML501-LOOKUP-BY-UPC-ID'             
                   DISPLAY '     UPC-ID = ' ML501-PV-WORK-UPC-ID                
                           ' EFF DATE = ' ML501-PV-EFF-DTE-IN                   
                           ' SQLCODE = ' SQLCODE                                
           END-EVALUATE.                                                        
                                                                                
      ******************************************************************        
      * VENDOR LOOKUP BY ITEM NUMBER                                            
      ******************************************************************        
       ML501-LOOKUP-BY-ITM-NBR.                                                 
                                                                                
           EXEC SQL                                                             
               SELECT                                                           
                      C.ENT_ID                                                  
                 INTO                                                           
                      :ML501-PV-ENT-ID-OUT                                      
                 FROM                                                           
                      TSKXREF    A                                              
                     ,TUPC       B                                              
                     ,TVNDSTL    C                                              
                WHERE                                                           
                      A.ITM_NBR     = :ML501-PV-WORK-ITM-NBR                    
                  AND A.SKU_STAT_CDE NOT IN ('98', '00')                        
                  AND A.INTR_UPC_ID     = B.UPC_ID                              
                  AND B.VS_ID           = C.VS_ID                               
                  AND :ML501-PV-EFF-DTE-IN                                      
                          BETWEEN B.EFF_BEG_DTE                                 
                          AND COALESCE(B.EFF_END_DTE, '9999-12-31')             
                WITH UR                                                         
           END-EXEC.                                                            
                                                                                
           EVALUATE TRUE                                                        
               WHEN SQLCODE = 0                                                 
                   CONTINUE                                                     
               WHEN SQLCODE = +100                                              
                   MOVE ZEROES            TO ML501-PV-ENT-ID-OUT                
                   SET ML501-PV-NOT-FOUND TO TRUE                               
               WHEN OTHER                                                       
                   MOVE ZEROES            TO ML501-PV-ENT-ID-OUT                
                   SET ML501-PV-SQL-ERROR TO TRUE                               
                   DISPLAY ' *** FAIL VENDOR LOOKUP'                            
                           '     PARAGRAPH: ML501-LOOKUP-BY-ITM-NBR'            
                   DISPLAY '     ITEM NUMBER = ' ML501-PV-WORK-ITM-NBR          
                           ' EFF DATE = ' ML501-PV-EFF-DTE-IN                   
                           ' SQLCODE = ' SQLCODE                                
           END-EVALUATE.                                                        
                                                                                
      ******************************************************************        
      * VENDOR LOOKUP BY INHOUSE NUMBER                                         
      ******************************************************************        
       ML501-LOOKUP-BY-INHOUSE.                                                 
W31475     IF ML501-PV-WORK-DEPT-3X = PV-WORK-DEPT-3X AND                       
W31475         PV-WORK-INHOUSE = ML501-PV-WORK-INHOUSE                          
W31475        MOVE PV-DEPT-ENT-ID  TO ML501-PV-ENT-ID-OUT                       
W31475       IF PV-DEPT-RETURN-CDE NOT = +99                                    
W31475          MOVE PV-DEPT-RETURN-CDE TO ML501-PV-RETURN-CDE                  
W31475       END-IF                                                             
W31475      ELSE                                                                
            EXEC SQL                                                            
               SELECT                                                           
                      ENT_ID                                                    
                 INTO                                                           
                      :ML501-PV-ENT-ID-OUT                                      
                 FROM                                                           
                      TVNDDPT                                                   
                WHERE                                                           
                      DEPT_NBR    = :ML501-PV-WORK-DEPT-3X                      
                  AND INHOUSE_NBR = :ML501-PV-WORK-INHOUSE                      
               WITH UR                                                          
            END-EXEC                                                            
                                                                                
             EVALUATE TRUE                                                      
               WHEN SQLCODE = 0                                                 
W31475*            CONTINUE                                                     
W31475             MOVE +99 TO PV-DEPT-RETURN-CDE                               
               WHEN SQLCODE = +100                                              
                   MOVE ZEROES            TO ML501-PV-ENT-ID-OUT                
                   SET ML501-PV-NOT-FOUND TO TRUE                               
W31475             MOVE +08 TO PV-DEPT-RETURN-CDE                               
               WHEN OTHER                                                       
                   MOVE ZEROES            TO ML501-PV-ENT-ID-OUT                
                   SET ML501-PV-SQL-ERROR TO TRUE                               
W31475             MOVE +16 TO PV-DEPT-RETURN-CDE                               
                   DISPLAY ' *** FAIL VENDOR LOOKUP'                            
                           '     PARAGRAPH: ML501-LOOKUP-BY-INHOUSE'            
                   DISPLAY '     INHOUSE NBR = ' ML501-PV-WORK-INHOUSE          
                           ' DEPT = ' ML501-PV-WORK-DEPT-3X                     
                           ' SQLCODE = ' SQLCODE                                
             END-EVALUATE                                                       
W31475       MOVE ML501-PV-ENT-ID-OUT    TO PV-DEPT-ENT-ID                      
W31475       MOVE ML501-PV-WORK-DEPT-3X  TO PV-WORK-DEPT-3X                     
W31475       MOVE ML501-PV-WORK-INHOUSE  TO PV-WORK-INHOUSE                     
W31475       END-IF.                                                            
                                                                                
