000010***************************************************************** 00001001
000020 IDENTIFICATION DIVISION.                                         00002001
000030 PROGRAM-ID.             SUKRP073.                                00003002
000040 AUTHOR.                 DENISE HAHN.                             00004001
000050 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00005001
000060 DATE-WRITTEN.           AUGUST, 2016.                            00006002
000070 DATE-COMPILED.                                                   00007001
000080***************************************************************** 00008001
000090*                                                               * 00009001
000091*  SHIPPING TRAILER CARTON COUNT REPORT                         * 00009102
000092*                                                               * 00009201
000093*  INPUT FILE IS CREATED BY SUKUT182 - SURD133                  * 00009302
000094*                                                               * 00009401
000095***************************************************************** 00009501
000096 ENVIRONMENT DIVISION.                                            00009601
000097 CONFIGURATION SECTION.                                           00009701
000098                                                                  00009801
000099 SOURCE-COMPUTER.        IBM-3090.                                00009901
000100 OBJECT-COMPUTER.        IBM-3090.                                00010001
000110                                                                  00011001
000120***************************************************************** 00012001
000130 INPUT-OUTPUT SECTION.                                            00013001
000140                                                                  00014001
000150 FILE-CONTROL.                                                    00015001
000160                                                                  00016001
000170     SELECT INPUT-FILE                                            00017001
000180         ASSIGN TO INP01.                                         00018001
000190                                                                  00019001
000191     SELECT CONTROL-FILE                                          00019101
000192         ASSIGN TO INP02.                                         00019201
000193                                                                  00019301
000194     SELECT REPORT-FILE                                           00019401
000195         ASSIGN TO RPT01.                                         00019501
000200***************************************************************** 00020001
000210 DATA DIVISION.                                                   00021001
000220***************************************************************** 00022001
000230 FILE SECTION.                                                    00023001
000240                                                                  00024001
000250 FD  INPUT-FILE                                                   00025001
000260     RECORDING MODE IS F                                          00026001
000270     LABEL RECORDS ARE STANDARD                                   00027001
000280     BLOCK CONTAINS 0 RECORDS.                                    00028001
000290 01  INPUT-RECORD                    PIC  X(75).                  00029002
000291                                                                  00029101
000292 FD  CONTROL-FILE                                                 00029201
000293     RECORDING MODE IS F                                          00029301
000294     LABEL RECORDS ARE STANDARD                                   00029401
000295     BLOCK CONTAINS 0 RECORDS.                                    00029501
000296 01  CONTROL-RECORD                  PIC  X(80).                  00029601
000297                                                                  00029701
000298 FD  REPORT-FILE                                                  00029801
000299     RECORDING MODE IS F                                          00029901
000300     BLOCK CONTAINS 0  RECORDS.                                   00030001
000310 01  REPORT-RECORD                   PIC X(150).                  00031001
000320                                                                  00032001
000380***************************************************************** 00038001
000390 WORKING-STORAGE SECTION.                                         00039001
000391                                                                  00039101
000392 01  PROGRAM-SWITCHES.                                            00039201
000393     05  PS-END-OF-INPUT-FILE-SW     PIC X(01) VALUE 'N'.         00039301
000394         88  PS-END-OF-INPUT                   VALUE 'Y'.         00039401
000395         88  PS-NOT-END-OF-INPUT               VALUE 'N'.         00039501
000396     05  PS-SUMMARY-TABLE-SW           PIC  X(01)    VALUE 'N'.   00039606
000397         88  SUMMARY-TABLE-EOF                       VALUE 'Y'.   00039706
000398                                                                  00039801
000399 01  PC-PROGRAM-CONSTANTS.                                        00039901
000400     05  PC-TABLE-MAX                 PIC S9(05)    VALUE +150.   00040005
000401     05  PC-ACTUAL-TABLE-ENTRIES      PIC S9(05)    VALUE ZEROES. 00040105
000402     05  PC-SUKRP073                 PIC X(08) VALUE              00040202
000403                                               'SUKRP073'.        00040302
000404     05  PC-REPORT-NBR               PIC X(02) VALUE '-1'.        00040401
000410     05  PC-MAX-LINE-COUNT           PIC S9(3) VALUE +60          00041001
000420                                               COMP-3.            00042001
000430     05  PC-DEFAULT-TMST             PIC X(26)  VALUE             00043001
000440                                    '9999-09-09-09.09.09.999999'. 00044001
000450     05  PC-SLASH                    PIC X(01) VALUE '/'.         00045001
000460     05  PC-DASH                     PIC X(01) VALUE '-'.         00046001
000470                                                                  00047001
000480 01  SD-DATE-TIME.                                                00048001
000490     05  SD-SYSTEM-DATE.                                          00049001
000491         10  SD-SYSTEM-DATE-YY       PIC 9(02) VALUE ZERO.        00049101
000492         10  SD-SYSTEM-DATE-MM       PIC 9(02) VALUE ZERO.        00049201
000493         10  SD-SYSTEM-DATE-DD       PIC 9(02) VALUE ZERO.        00049301
000494     05  SD-SYSTEM-TIME.                                          00049401
000495         10  SD-SYSTEM-TIME-HH       PIC 9(02) VALUE ZERO.        00049501
000496         10  SD-SYSTEM-TIME-MM       PIC 9(02) VALUE ZERO.        00049601
000497         10  SD-SYSTEM-TIME-SS       PIC 9(02) VALUE ZERO.        00049701
000498         10  FILLER                  PIC 9(02) VALUE ZERO.        00049801
000499                                                                  00049901
000500 01  PV-PROGRAM-VARIABLES.                                        00050001
000510     05  PV-READ-COUNT                PIC S9(7) COMP-3            00051001
000520                                                VALUE ZERO.       00052001
000530     05  PV-WRITE-COUNT               PIC S9(7) COMP-3            00053001
000540                                                VALUE ZERO.       00054001
000550     05  PV-NULL-IND                 PIC S9(04) VALUE +0          00055001
000560                                               COMP SYNC.         00056001
000570     05  PV-FORMAT-DATE.                                          00057001
000580         10 PV-FORMAT-DATE-MM         PIC  9(02).                 00058001
000590         10 FILLER                    PIC  X(01) VALUE '/'.       00059001
000591         10 PV-FORMAT-DATE-DD         PIC  9(02).                 00059101
000592         10 FILLER                    PIC  X(01) VALUE '/'.       00059201
000593         10 PV-FORMAT-DATE-CCYY       PIC  9(04).                 00059301
000594                                                                  00059401
000595     05  PV-SQLCODE                  PIC 9(09) VALUE ZERO.        00059501
000596     05  PV-PAGE-COUNT               PIC S9(4) VALUE ZERO         00059601
000597                                               COMP-3.            00059701
000598     05  PV-LINE-COUNT               PIC S9(3) VALUE ZERO         00059801
000599                                               COMP-3.            00059901
000600     05  PV-TRIP-COUNT               PIC S9(3) VALUE ZERO         00060001
000610                                               COMP-3.            00061001
000620     05  PV-LINES-ON-PAGE            PIC  9(3) VALUE 60.          00062001
000630     05  PV-TRIPS-ON-PAGE            PIC  9(3) VALUE 6.           00063001
000640                                                                  00064001
000650     05  PV-PREV-TRIP-ID             PIC S9(09) COMP.             00065001
000660     05  PV-PREV-OPER                PIC S9(04) COMP.             00066001
000670     05  PV-PREV-DEST                PIC S9(04) COMP.             00067001
000680                                                                  00068001
000690     05  PV-TODAYS-DATE.                                          00069001
000691         10  PV-TODAYS-DATE-YY       PIC 9(02) VALUE ZERO.        00069101
000692         10  PV-TODAYS-DATE-MM       PIC 9(02) VALUE ZERO.        00069201
000693         10  PV-TODAYS-DATE-DD       PIC 9(02) VALUE ZERO.        00069301
000694     05  PV-TODAYS-DATE-YYYY.                                     00069401
000695         10  PV-TODAYS-DATE-CC       PIC 9(02) VALUE 20.          00069501
000696         10  PV-TODAYS-DATE-Y2       PIC 9(02) VALUE ZERO.        00069601
000697                                                                  00069701
000698     05  PV-TODAYS-TIME.                                          00069801
000699         10  PV-TODAYS-TIME-HH       PIC 9(02) VALUE ZERO.        00069901
000700         10  PV-TODAYS-TIME-MM       PIC 9(02) VALUE ZERO.        00070001
000710         10  PV-TODAYS-TIME-SS       PIC 9(02) VALUE ZERO.        00071001
000720         10  FILLER                  PIC 9(02) VALUE ZERO.        00072001
000730                                                                  00073001
000731     05  PV-STORE-NAME               PIC   X(40).                 00073102
000732                                                                  00073202
000740* DC TOTALS                                                       00074002
000751     05  PV-DC-TRIP-COUNT            PIC   9(09).                 00075102
000752     05  PV-DC-DIVERT-COUNT          PIC   9(09).                 00075202
000753     05  PV-DC-SCAN-ON-COUNT         PIC   9(09).                 00075302
000754                                                                  00075402
000755* CORP TOTALS                                                     00075502
000756     05  PV-CORP-TRIP-COUNT          PIC   9(11).                 00075602
000757     05  PV-CORP-DIVERT-COUNT        PIC   9(11).                 00075702
000758     05  PV-CORP-SCAN-ON-COUNT       PIC   9(11).                 00075802
000759                                                                  00075902
000760  01  SPT-SUMMARY-PAGE-TABLE.                                     00076002
000761      05  FILLER  OCCURS 150 TIMES                                00076102
000770                  INDEXED BY SPT-INDEX.                           00077002
000780          10  SPT-DC-NBR             PIC 9(04)      VALUE ZEROES. 00078002
000790          10  SPT-DC-NAME            PIC X(20)      VALUE SPACES. 00079002
000800          10  SPT-TOTAL-TRIPS        PIC 9(11)      VALUE ZEROES. 00080002
000900          10  SPT-DIVERT-COUNT       PIC 9(11)      VALUE ZEROES. 00090002
001000          10  SPT-SCANON-COUNT       PIC 9(11)      VALUE ZEROES. 00100002
001420                                                                  00142002
001430                                                                  00143002
001480                                                                  00148001
001490 01  PV-ABEND-FIELDS.                                             00149001
001491     05  PV-ABEND-CODE               PIC S9(4) VALUE +0           00149101
001492                                               COMP SYNC.         00149201
001493     05  PV-ABEND-PROGRAM            PIC X(08) VALUE 'SUKRP073'.  00149302
001494     05  PV-ABEND-PARAGRAPH          PIC X(50) VALUE SPACES.      00149401
001495     05  PV-ABEND-OPERATION          PIC X(50) VALUE SPACES.      00149501
001496     05  PV-ABEND-STRUCTURE-1        PIC X(08) VALUE SPACES.      00149601
001497     05  PV-DB2-OPERATION-MESSAGE-1  PIC X(79) VALUE SPACES.      00149701
001498     05  PV-DB2-OPERATION-MESSAGE-2  PIC X(79) VALUE SPACES.      00149801
001499     05  PV-DB2-OPERATION-MESSAGE-3  PIC X(79) VALUE SPACES.      00149901
001500     05  PV-DB2-OPERATION-MESSAGE-4  PIC X(79) VALUE SPACES.      00150001
001510     05  PV-DB2-TABLE-NAME-1         PIC X(08) VALUE SPACES.      00151001
001520     05  PV-DB2-TABLE-NAME-2         PIC X(08) VALUE SPACES.      00152001
001521     05  PV-ERROR-MESSAGE-1          PIC X(50) VALUE SPACES.      00152105
001522     05  PV-ERROR-MESSAGE-2          PIC X(50) VALUE SPACES.      00152205
001530                                                                  00153001
001540     05  PV-DISPLAY-OPER             PIC  9(04) VALUE ZEROES.     00154001
001550     05  PV-DISPLAY-SQLCODE          PIC  9(03)- VALUE ZEROES.    00155001
001560     05  PV-DB2-TABLE-NAME1          PIC  X(15) VALUE SPACES.     00156001
001570                                                                  00157001
001580     05  PV-DISPLAY-READ-COUNT       PIC ZZZ,ZZZ,ZZ9.             00158001
001590     05  PV-DISPLAY-WRITE-COUNT      PIC ZZZ,ZZZ,ZZ9.             00159001
001591     05  PV-DISPLAY-PERCENT1         PIC ZZZ.99.                  00159101
001592     05  PV-DISPLAY-PERCENT2         PIC ZZZ.                     00159201
001593                                                                  00159301
001594 01  PV-SAVE-FIELDS.                                              00159401
001595     05  PV-SAVE-OPER-UNT-ID          PIC S9(04) COMP             00159501
001596                                                 VALUE +0.        00159601
001597 01  DK-DB-KEYS.                                                  00159701
001598     05  DK-OPER-UNT-ID              PIC S9(4) COMP.              00159801
001599                                                                  00159901
001600 01  REPORT-DATES.                                                00160001
001610     05  REPORT-FROM-DATE            PIC X(10).                   00161001
001620     05  REPORT-TO-DATE              PIC X(10).                   00162001
001630******************************************************************00163001
001640*    DATE CONTROL CARD                                            00164001
001650******************************************************************00165001
001660     COPY SURD032.                                                00166001
001670                                                                  00167001
001680******************************************************************00168001
001690* RECORD LAYOUT FOR THE INPUT FILE.                               00169001
001691******************************************************************00169101
001692     COPY SURD133.                                                00169203
001693                                                                  00169301
001699******************************************************************00169901
001700*  WORK FIELDS FOR PRINTING A 132 CHARACTER REPORT.               00170002
001710******************************************************************00171001
001720     COPY DPWS132O.                                               00172002
001730                                                                  00173001
001740 01  WS-BATCH-PROC-DATE.                                          00174001
001750     05  WS-BATCH-PROC-CC            PIC X(02) VALUE SPACES.      00175001
001760     05  WS-BATCH-PROC-YY            PIC X(02) VALUE SPACES.      00176001
001770     05  FILLER                      PIC X(01) VALUE SPACES.      00177001
001780     05  WS-BATCH-PROC-MM            PIC X(02) VALUE SPACES.      00178001
001790     05  FILLER                      PIC X(01) VALUE SPACES.      00179001
001791     05  WS-BATCH-PROC-DD            PIC X(02) VALUE SPACES.      00179101
001792*                                                                 00179201
001793 01  HEADING-LINES.                                               00179301
001794     05  HEADING-LINE1.                                           00179401
001795         10  FILLER                  PIC X(46) VALUE SPACES.      00179508
001796         10  FILLER                  PIC X(43) VALUE              00179601
001797         'SHIPPED TRAILERS CARTON COUNT - BY CATEGORY'.           00179702
001798         10  FILLER                  PIC X(53) VALUE SPACES.      00179801
001799                                                                  00179901
001800     05  HEADING-LINE1A.                                          00180001
001810         10  FILLER                  PIC X(46) VALUE SPACES.      00181002
001820         10  FILLER                  PIC X(13) VALUE              00182002
001830         'FISCAL MONTH '.                                         00183002
001840         10  HD1A-FROM-DATE          PIC X(10) VALUE SPACES.      00184001
001850         10  FILLER                  PIC X(03) VALUE ' - '.       00185001
001860         10  HD1A-TO-DATE            PIC X(10) VALUE SPACES.      00186001
001870         10  FILLER                  PIC X(50) VALUE SPACES.      00187002
001880                                                                  00188001
001890     05  HEADING-LINE2.                                           00189001
001891         10  HD2-OPER-UNT-ID         PIC 9(04) VALUE ZEROES.      00189101
001892         10  FILLER                  PIC X(01) VALUE SPACES.      00189201
001893         10  HD2-DC-NAME             PIC X(40) VALUE SPACES.      00189301
001894         10  FILLER                  PIC X(87) VALUE SPACES.      00189401
001895         10  FILLER                  PIC X(18) VALUE SPACES.      00189501
001896                                                                  00189601
001897     05  HEADING-LINE3.                                           00189701
002420         10  FILLER            PIC X(02) VALUE SPACES.            00242001
002430         10  FILLER            PIC X(02) VALUE 'DC'.              00243001
002440         10  FILLER            PIC X(04) VALUE SPACES.            00244002
002450         10  FILLER            PIC X(05) VALUE 'STORE'.           00245001
002460         10  FILLER            PIC X(33) VALUE SPACES.            00246002
002470         10  FILLER            PIC X(05) VALUE 'TOTAL'.           00247002
002480         10  FILLER            PIC X(10) VALUE SPACES.            00248002
002490         10  FILLER            PIC X(06) VALUE 'DIVERT'.          00249002
002491         10  FILLER            PIC X(08) VALUE SPACES.            00249102
002492         10  FILLER            PIC X(07) VALUE 'SCAN ON'.         00249202
002493         10  FILLER            PIC X(50) VALUE SPACES.            00249302
002494                                                                  00249402
002495     05  HEADING-LINE4.                                           00249502
002496         10  FILLER            PIC X(02) VALUE SPACES.            00249602
002497         10  FILLER            PIC X(03) VALUE 'NBR'.             00249702
002498         10  FILLER            PIC X(03) VALUE SPACES.            00249802
002499         10  FILLER            PIC X(05) VALUE ' NBR '.           00249902
002500         10  FILLER            PIC X(33) VALUE SPACES.            00250002
002510         10  FILLER            PIC X(05) VALUE 'TRIPS'.           00251002
002600         10  FILLER            PIC X(10) VALUE SPACES.            00260002
002700         10  FILLER            PIC X(06) VALUE ' COUNT'.          00270002
002800         10  FILLER            PIC X(08) VALUE SPACES.            00280002
002810         10  FILLER            PIC X(07) VALUE ' COUNT '.         00281002
002820         10  FILLER            PIC X(50) VALUE SPACES.            00282002
002830                                                                  00283002
002850 01  DETAIL-LINE.                                                 00285002
002860     05  DETAIL-LINE1.                                            00286001
002870         10  FILLER               PIC  X(01) VALUE SPACES.        00287002
002880         10  DL1-DC-NBR           PIC  Z(04) VALUE ZEROES.        00288002
002890         10  FILLER               PIC  X(03) VALUE SPACES.        00289002
002891         10  DL1-STORE            PIC  Z(04) VALUE ZEROES.        00289102
002892         10  FILLER               PIC  X(03) VALUE SPACES.        00289202
002893         10  DL1-STORE-NAME       PIC  X(20) VALUE SPACES.        00289302
002894         10  FILLER               PIC  X(05) VALUE SPACES.        00289402
002898         10  DL1-TOTAL-TRIPS      PIC  ZZZ,ZZZ,ZZZ VALUE ZERO.    00289802
002899         10  FILLER               PIC  X(05)  VALUE SPACES.       00289902
002900         10  DL1-DIVERT-COUNT     PIC  ZZZ,ZZZ,ZZZ VALUE ZERO.    00290002
002901         10  FILLER               PIC  X(05)  VALUE SPACES.       00290102
002902         10  DL1-SCANON-COUNT     PIC  ZZZ,ZZZ,ZZZ VALUE ZERO.    00290202
002903         10  FILLER               PIC  X(49)  VALUE SPACES.       00290302
004393                                                                  00439301
004394 01  TOTAL-LINES.                                                 00439402
004395     05  TOTAL-LINE1.                                             00439502
004396         10  FILLER               PIC  X(01) VALUE SPACES.        00439602
004397         10  TL1-DC-NBR           PIC  Z(04) VALUE ZEROES.        00439702
004398         10  FILLER               PIC  X(03) VALUE SPACES.        00439802
004399         10  FILLER               PIC  X(04) VALUE SPACES.        00439902
004400         10  FILLER               PIC  X(03) VALUE SPACES.        00440002
004401         10  TL1-DC-NAME          PIC  X(20) VALUE SPACES.        00440102
004402         10  FILLER               PIC  X(02) VALUE SPACES.        00440202
004403         10  TL1-TOTAL-TRIPS      PIC  ZZ,ZZZ,ZZZ,ZZZ VALUE ZERO. 00440302
004404         10  FILLER               PIC  X(02)  VALUE SPACES.       00440402
004405         10  TL1-DIVERT-COUNT     PIC  ZZ,ZZZ,ZZZ,ZZZ VALUE ZERO. 00440502
004406         10  FILLER               PIC  X(02)  VALUE SPACES.       00440602
004407         10  TL1-SCANON-COUNT     PIC  ZZ,ZZZ,ZZZ,ZZZ VALUE ZERO. 00440702
004408         10  FILLER               PIC  X(49)  VALUE SPACES.       00440802
004409                                                                  00440902
004410 01  MISCELLANEOUS-LINES.                                         00441001
004411     05  BLANK-LINE.                                              00441101
004412         10  FILLER                  PIC X(150) VALUE SPACES.     00441201
004413                                                                  00441301
004414     05  END-OF-REPORT-LINE.                                      00441401
004415         10  FILLER                  PIC X(44) VALUE SPACES.      00441501
004416         10  FILLER                  PIC X(45) VALUE              00441601
004417             '*******   E N D   O F   R E P O R T   *******'.     00441701
004420         10  FILLER                  PIC X(43) VALUE SPACES.      00442001
004430         10  FILLER                  PIC X(18) VALUE SPACES.      00443001
004440                                                                  00444001
004450     05  NO-DATA-TO-REPORT-LINE.                                  00445001
004460         10  FILLER                  PIC X(40) VALUE SPACES.      00446001
004470         10  FILLER                  PIC  X(52)    VALUE          00447001
004480         '*******  N O   D A T A   T O   R E P O R T   *******'.  00448001
004490         10  FILLER                  PIC  X(40)    VALUE SPACES.  00449001
004491         10  FILLER                  PIC X(18) VALUE SPACES.      00449101
004492                                                                  00449201
004493                                                                  00449301
004494******************************************************************00449401
004495*  USED FOR DB2 ERROR MESSAGE BUILDING                            00449501
004496******************************************************************00449601
004497     COPY DPWS004.                                                00449701
004498                                                                  00449801
004499******************************************************************00449901
004500*   DB2 SQL COMMUNICATION AREA                                    00450001
004510******************************************************************00451001
004520     EXEC SQL                                                     00452001
004530          INCLUDE SQLCA                                           00453001
004540     END-EXEC.                                                    00454001
004550                                                                  00455001
004560*---------------------------------------------------------------* 00456001
004570*  DCLGEN FOR THE LOGISTICS LOCATION TABLE                        00457001
004580*  XLT_LOC                                                        00458001
004590*---------------------------------------------------------------* 00459001
004591     EXEC SQL                                                     00459101
004592          INCLUDE XLT00010                                        00459201
004593     END-EXEC.                                                    00459301
004594                                                                  00459401
004595******************************************************************00459501
004596 PROCEDURE DIVISION.                                              00459601
004597     DISPLAY '**** START OF SUKRP073 ****'.                       00459702
004598                                                                  00459801
004599*OPEN FILES.                                                      00459901
004600     OPEN INPUT  INPUT-FILE                                       00460001
004610                 CONTROL-FILE                                     00461001
004620          OUTPUT REPORT-FILE.                                     00462002
004640                                                                  00464001
004650     PERFORM 1000-INITIALIZATION.                                 00465001
004660                                                                  00466001
004670     SET  PS-NOT-END-OF-INPUT   TO  TRUE.                         00467001
004680                                                                  00468001
004690     PERFORM 7000-READ-EXTRACT-FILE.                              00469001
004691                                                                  00469101
004692     MOVE SU133-TRIP-ID         TO  PV-PREV-TRIP-ID.              00469202
004693     MOVE SU133-OPER-UNT-ID     TO  PV-PREV-OPER.                 00469302
004694     MOVE SU133-STORE-DEST      TO  PV-PREV-DEST.                 00469402
004695                                                                  00469501
004696     IF PS-END-OF-INPUT                                           00469601
004697        ADD +1                  TO PV-PAGE-COUNT                  00469701
004698        MOVE PV-PAGE-COUNT      TO DP132O-PAGE-NUMBER             00469802
004699        WRITE REPORT-RECORD                                       00469901
004700          FROM DP132O-STANDRD-HEADER-132-COLS                     00470002
004710            AFTER ADVANCING PAGE                                  00471001
004720        WRITE REPORT-RECORD                                       00472001
004730          FROM HEADING-LINE1                                      00473001
004740            AFTER ADVANCING 1 LINES                               00474001
004750        WRITE REPORT-RECORD                                       00475001
004760          FROM HEADING-LINE1A                                     00476001
004770            AFTER ADVANCING 1 LINES                               00477001
004780        WRITE REPORT-RECORD                                       00478001
004790          FROM HEADING-LINE2                                      00479001
004791            AFTER ADVANCING 1 LINE                                00479101
004792        WRITE REPORT-RECORD                                       00479201
004793          FROM NO-DATA-TO-REPORT-LINE                             00479301
004794            AFTER ADVANCING 2 LINES                               00479401
004795     ELSE                                                         00479501
004796         MOVE SU133-OPER-UNT-ID  TO PV-SAVE-OPER-UNT-ID           00479602
004797         PERFORM 8500-GET-LOCATION-NAME                           00479701
004798         PERFORM 1500-PRINT-HEADINGS                              00479801
004799         PERFORM 2000-PROCESS-INPUT                               00479901
004800           UNTIL PS-END-OF-INPUT                                  00480001
004810         PERFORM 5020-PRINT-DC-TOTALS                             00481002
004811         PERFORM 4000-CREATE-TABLE-ENTRY                          00481102
004820         PERFORM 5030-PRINT-CORP-TOTALS                           00482002
004840     END-IF.                                                      00484001
004850                                                                  00485001
004860*FINISH REPORT.                                                   00486001
004870                                                                  00487001
004880     WRITE REPORT-RECORD                                          00488001
004890       FROM END-OF-REPORT-LINE                                    00489001
004891         AFTER ADVANCING 3 LINES.                                 00489101
004892                                                                  00489201
004893*CLOSE FILES.                                                     00489301
004894     CLOSE INPUT-FILE                                             00489401
004895           CONTROL-FILE                                           00489501
004896           REPORT-FILE.                                           00489602
004898                                                                  00489801
004899     MOVE PV-READ-COUNT TO PV-DISPLAY-READ-COUNT.                 00489901
004900     DISPLAY 'TOTAL INPUT READ ' PV-DISPLAY-READ-COUNT.           00490001
004910                                                                  00491001
004920     MOVE PV-WRITE-COUNT TO PV-DISPLAY-WRITE-COUNT.               00492001
004930     DISPLAY 'TOTAL RECS WRITTEN ' PV-DISPLAY-WRITE-COUNT.        00493001
004940                                                                  00494001
004950     GOBACK.                                                      00495001
004960                                                                  00496001
004970******************************************************************00497001
004980*  PERFORM THE INITIAL PROCESSING FOR THE PROGRAM.               *00498001
004990******************************************************************00499001
004991 1000-INITIALIZATION.                                             00499101
004992     ACCEPT SD-SYSTEM-DATE                                        00499201
004993       FROM DATE.                                                 00499301
004994                                                                  00499401
004995     ACCEPT SD-SYSTEM-TIME                                        00499501
004996       FROM TIME.                                                 00499601
004997                                                                  00499701
004998     MOVE SD-SYSTEM-DATE-MM  TO DP132O-RUN-MONTH.                 00499802
004999     MOVE SD-SYSTEM-DATE-DD  TO DP132O-RUN-DAY.                   00499902
005000     MOVE SD-SYSTEM-DATE-YY  TO DP132O-RUN-YEAR.                  00500002
005010     MOVE SD-SYSTEM-TIME-HH  TO DP132O-RUN-HOUR.                  00501002
005020     MOVE SD-SYSTEM-TIME-MM  TO DP132O-RUN-MINUTE.                00502002
005030                                                                  00503001
005040     MOVE PC-SUKRP073             TO DP132O-PROGRAM-NAME.         00504002
005050     MOVE PC-REPORT-NBR           TO DP132O-REPORT-NUMBER.        00505002
005060     MOVE +0                      TO PV-PAGE-COUNT.               00506001
005070                                                                  00507001
005080     PERFORM 7010-READ-CONTROL-REC.                               00508001
005090     MOVE SU032-FROM-DATE    TO  REPORT-FROM-DATE.                00509001
005091     MOVE SU032-TO-DATE      TO  REPORT-TO-DATE.                  00509101
005092                                                                  00509201
005093     SET SPT-INDEX TO 1.                                          00509302
005094******************************************************************00509401
005095**  WRITES REPORT HEADER LINES FOR FIRST PAGE AND ANY SUBSEQUENT  00509501
005096**  PAGES (AS NEEDED).                                            00509601
005097******************************************************************00509701
005098 1500-PRINT-HEADINGS.                                             00509801
005099     ADD +1                  TO PV-PAGE-COUNT.                    00509901
005100     MOVE PV-PAGE-COUNT      TO DP132O-PAGE-NUMBER.               00510002
005101                                                                  00510101
005110     MOVE REPORT-FROM-DATE   TO  HD1A-FROM-DATE.                  00511001
005120     MOVE REPORT-TO-DATE     TO  HD1A-TO-DATE.                    00512001
005130                                                                  00513001
005140     WRITE REPORT-RECORD                                          00514001
005150       FROM DP132O-STANDRD-HEADER-132-COLS                        00515004
005160         AFTER ADVANCING PAGE.                                    00516001
005170                                                                  00517001
005180     WRITE REPORT-RECORD                                          00518001
005190       FROM HEADING-LINE1                                         00519001
005191         AFTER ADVANCING 1 LINES.                                 00519101
005192                                                                  00519201
005193     WRITE REPORT-RECORD                                          00519301
005194       FROM HEADING-LINE1A                                        00519401
005195         AFTER ADVANCING 1 LINES.                                 00519501
005196                                                                  00519601
005197     WRITE REPORT-RECORD                                          00519701
005198       FROM HEADING-LINE2                                         00519801
005199         AFTER ADVANCING 1 LINE.                                  00519901
005200                                                                  00520001
005210     WRITE REPORT-RECORD                                          00521001
005220       FROM HEADING-LINE3                                         00522001
005230         AFTER ADVANCING 2 LINES.                                 00523001
005240                                                                  00524001
005250     WRITE REPORT-RECORD                                          00525001
005260       FROM HEADING-LINE4                                         00526001
005270         AFTER ADVANCING 1 LINES.                                 00527001
005280                                                                  00528001
005320     WRITE REPORT-RECORD                                          00532001
005330       FROM BLANK-LINE                                            00533001
005340         AFTER ADVANCING 1 LINE.                                  00534001
005350                                                                  00535001
005360     MOVE +05                TO PV-LINE-COUNT.                    00536002
005370     MOVE ZEROES             TO PV-TRIP-COUNT.                    00537001
005380                                                                  00538001
005390******************************************************************00539001
005391**  READ INPUT-FILE, WHEN DC CHANGES, DO A PAGE BREAK             00539101
005392******************************************************************00539201
005393 2000-PROCESS-INPUT.                                              00539301
005494     IF  SU133-OPER-UNT-ID = PV-PREV-OPER                         00549402
005495         CONTINUE                                                 00549502
005496     ELSE                                                         00549602
005497         PERFORM 5020-PRINT-DC-TOTALS                             00549702
005498         PERFORM 4000-CREATE-TABLE-ENTRY                          00549802
005499         MOVE SU133-OPER-UNT-ID    TO PV-PREV-OPER                00549902
005500         MOVE SU133-OPER-UNT-ID    TO PV-SAVE-OPER-UNT-ID         00550002
005501         PERFORM 8500-GET-LOCATION-NAME                           00550102
005502         PERFORM 1500-PRINT-HEADINGS                              00550202
005503     END-IF.                                                      00550302
005504                                                                  00550402
005507     PERFORM 3000-CALC-TOTALS.                                    00550702
005508                                                                  00550801
005509     PERFORM 3010-GET-STORE-NAME.                                 00550902
005510                                                                  00551002
005520     PERFORM 5000-PRINT-DC-STORE-TOTALS.                          00552002
005540                                                                  00554001
005550     PERFORM 7000-READ-EXTRACT-FILE.                              00555001
005560                                                                  00556001
005570                                                                  00557001
005580****************************************************************  00558001
005590* CALCULATE THE AVERAGES                                       *  00559001
005591****************************************************************  00559101
005592 3000-CALC-TOTALS.                                                00559202
005593                                                                  00559301
005594     ADD SU133-TRAILER-COUNT     TO  PV-DC-TRIP-COUNT             00559402
005595                                     PV-CORP-TRIP-COUNT.          00559502
005596     ADD SU133-DIVERT-COUNT      TO  PV-DC-DIVERT-COUNT           00559602
005597                                     PV-CORP-DIVERT-COUNT.        00559702
005598     ADD SU133-SCANON-COUNT      TO  PV-DC-SCAN-ON-COUNT          00559802
008297                                     PV-CORP-SCAN-ON-COUNT.       00829702
008298                                                                  00829802
008299****************************************************************  00829902
008300*                                                              *  00830002
008301****************************************************************  00830102
008302 3010-GET-STORE-NAME.                                             00830202
008303                                                                  00830302
008304     MOVE SU133-STORE-DEST     TO  XLT00010-LOC-NBR               00830402
008305                                   PV-DISPLAY-OPER.               00830502
008306                                                                  00830602
008307     EXEC SQL                                                     00830702
008308         SELECT   LOC_NM                                          00830802
008309           INTO  :PV-STORE-NAME                                   00830902
008310           FROM   XLT_LOC                                         00831002
008311          WHERE   LOC_NBR  =  :XLT00010-LOC-NBR                   00831102
008312     END-EXEC.                                                    00831202
008313                                                                  00831302
008314     EVALUATE TRUE                                                00831402
008315         WHEN SQLCODE = +0                                        00831502
008316              CONTINUE                                            00831602
008317                                                                  00831702
008318         WHEN OTHER                                               00831802
008319              CONTINUE                                            00831902
008320     END-EVALUATE.                                                00832002
008321                                                                  00832102
008330                                                                  00833001
008331****************************************************************  00833102
008332* CREATE INTERNAL TABLE WITH DC TOTALS                            00833202
008333****************************************************************  00833302
008340 4000-CREATE-TABLE-ENTRY.                                         00834002
008350                                                                  00835002
008351     IF  SPT-INDEX GREATER THAN PC-TABLE-MAX                      00835102
008352         MOVE '4000-CREATE-TABLE-ENTRY '  TO  PV-ABEND-PARAGRAPH  00835205
008353         SET PC-ACTUAL-TABLE-ENTRIES  TO  SPT-INDEX               00835302
008354         MOVE 'SUMMARY TABLE EXCEEDS MAXIMUM TABLE ENTRIES OF 150'00835402
008355                         TO PV-ERROR-MESSAGE-1                    00835502
008356         MOVE 'MAXIMUM TABLE SIZE NEEDS TO BE INCREASED'          00835602
008357                         TO PV-ERROR-MESSAGE-2                    00835702
008358         PERFORM 9998-ABEND                                       00835805
008359     END-IF.                                                      00835902
008360                                                                  00836002
008361     MOVE PV-PREV-OPER           TO  SPT-DC-NBR(SPT-INDEX).       00836102
008362     MOVE XLT00010-LOC-NM        TO  SPT-DC-NAME(SPT-INDEX).      00836202
008363     MOVE PV-DC-TRIP-COUNT       TO  SPT-TOTAL-TRIPS(SPT-INDEX).  00836302
008364     MOVE PV-DC-DIVERT-COUNT     TO  SPT-DIVERT-COUNT(SPT-INDEX). 00836402
008365     MOVE PV-DC-SCAN-ON-COUNT    TO  SPT-SCANON-COUNT(SPT-INDEX). 00836502
008371                                                                  00837102
008372     SET SPT-INDEX UP BY +1.                                      00837202
008375                                                                  00837502
008376     MOVE  ZEROES                TO  PV-DC-TRIP-COUNT             00837602
008377                                     PV-DC-DIVERT-COUNT           00837702
008378                                     PV-DC-SCAN-ON-COUNT.         00837802
008379                                                                  00837902
008380                                                                  00838002
012597****************************************************************  01259701
012598* PRINT DC STORE TOTALS                                           01259802
012599****************************************************************  01259901
012600 5000-PRINT-DC-STORE-TOTALS.                                      01260002
012610                                                                  01261001
012613     MOVE SU133-OPER-UNT-ID            TO  DL1-DC-NBR.            01261302
012615     MOVE SU133-STORE-DEST             TO  DL1-STORE.             01261502
012617     MOVE PV-STORE-NAME                TO  DL1-STORE-NAME.        01261702
012619     MOVE SU133-TRAILER-COUNT          TO  DL1-TOTAL-TRIPS.       01261902
012621     MOVE SU133-DIVERT-COUNT           TO  DL1-DIVERT-COUNT.      01262102
012623     MOVE SU133-SCANON-COUNT           TO  DL1-SCANON-COUNT.      01262302
012624                                                                  01262402
012796     WRITE REPORT-RECORD                                          01279601
012797       FROM DETAIL-LINE1                                          01279702
012798         AFTER ADVANCING 1 LINES.                                 01279801
012799                                                                  01279901
012800     ADD  1                  TO PV-LINE-COUNT.                    01280001
012820     IF  PV-LINE-COUNT  > PV-LINES-ON-PAGE                        01282002
012840         PERFORM 1500-PRINT-HEADINGS                              01284001
012850     END-IF.                                                      01285007
012895                                                                  01289501
012896****************************************************************  01289602
012897* PRINT DC TOTALS                                                 01289702
012898****************************************************************  01289802
012899 5020-PRINT-DC-TOTALS.                                            01289902
012900                                                                  01290002
012901     MOVE PV-PREV-OPER                 TO  TL1-DC-NBR.            01290102
012903     MOVE XLT00010-LOC-NM              TO  TL1-DC-NAME.           01290306
012904     MOVE PV-DC-TRIP-COUNT             TO  TL1-TOTAL-TRIPS.       01290407
012905     MOVE PV-DC-DIVERT-COUNT           TO  TL1-DIVERT-COUNT.      01290507
012906     MOVE PV-DC-SCAN-ON-COUNT          TO  TL1-SCANON-COUNT.      01290607
012907                                                                  01290702
012908     WRITE REPORT-RECORD                                          01290802
012909       FROM TOTAL-LINE1                                           01290902
012910         AFTER ADVANCING 2 LINES.                                 01291009
012911                                                                  01291102
012926                                                                  01292602
012927****************************************************************  01292702
012928* PRINTS CORPORATE TOTAL                                       *  01292802
012929****************************************************************  01292902
012930 5030-PRINT-CORP-TOTALS.                                          01293002
012932                                                                  01293202
012933     MOVE 9999                  TO  HD2-OPER-UNT-ID.              01293302
012935     MOVE 'CORPORATE TOTALS'    TO  HD2-DC-NAME.                  01293502
012936                                                                  01293602
012937     PERFORM 1500-PRINT-HEADINGS.                                 01293702
012938                                                                  01293802
012939     SET PC-ACTUAL-TABLE-ENTRIES  TO  SPT-INDEX                   01293902
012940                                                                  01294002
012941*    THIS IS A WIDGET TO FIX THE INDEX SO THAT IT POINTS TO       01294102
012942*    THE LAST VALID LINE IN THE REPORT.                           01294202
012943     SUBTRACT 1 FROM PC-ACTUAL-TABLE-ENTRIES                      01294302
012944                                                                  01294402
012945     PERFORM 5200-SUMMARY-DETAIL                                  01294502
012946             VARYING SPT-INDEX FROM 1 BY 1                        01294602
012947             UNTIL SUMMARY-TABLE-EOF.                             01294702
012948                                                                  01294802
012949     MOVE ZEROES                       TO  TL1-DC-NBR.            01294902
012950     MOVE 'CORPORATE TOTAL'            TO  TL1-DC-NAME.           01295006
012951     MOVE PV-CORP-TRIP-COUNT           TO  TL1-TOTAL-TRIPS.       01295102
012952     MOVE PV-CORP-DIVERT-COUNT         TO  TL1-DIVERT-COUNT.      01295202
012953     MOVE PV-CORP-SCAN-ON-COUNT        TO  TL1-SCANON-COUNT.      01295302
012954                                                                  01295402
012955     WRITE REPORT-RECORD                                          01295502
012956       FROM TOTAL-LINE1                                           01295602
012957         AFTER ADVANCING 2 LINES.                                 01295702
012958                                                                  01295802
012959                                                                  01295902
012960 5200-SUMMARY-DETAIL.                                             01296002
012961                                                                  01296102
012965     MOVE SPT-DC-NBR(SPT-INDEX)        TO  TL1-DC-NBR.            01296506
012966     MOVE SPT-DC-NAME(SPT-INDEX)       TO  TL1-DC-NAME.           01296606
012967     MOVE SPT-TOTAL-TRIPS(SPT-INDEX)   TO  TL1-TOTAL-TRIPS.       01296702
012968     MOVE SPT-DIVERT-COUNT(SPT-INDEX)  TO  TL1-DIVERT-COUNT.      01296802
012969     MOVE SPT-SCANON-COUNT(SPT-INDEX)  TO  TL1-SCANON-COUNT.      01296902
012970                                                                  01297002
012971     WRITE REPORT-RECORD                                          01297102
012972       FROM TOTAL-LINE1                                           01297202
012973         AFTER ADVANCING 2 LINES.                                 01297302
012974                                                                  01297402
012999                                                                  01299902
013000     IF SPT-INDEX  =  PC-ACTUAL-TABLE-ENTRIES                     01300002
013001        SET SUMMARY-TABLE-EOF TO TRUE.                            01300102
013002                                                                  01300202
013003                                                                  01300302
013008****************************************************************  01300801
013009* PRINTS A BLANK LINE                                          *  01300901
013010****************************************************************  01301001
013011 6000-PRINT-BLANK-LINE.                                           01301101
013012                                                                  01301201
013013        WRITE REPORT-RECORD                                       01301301
013014          FROM BLANK-LINE                                         01301401
013015            AFTER ADVANCING 1 LINE                                01301501
013016                                                                  01301601
013017     ADD +1 TO PV-LINE-COUNT.                                     01301701
013018                                                                  01301801
013019******************************************************************01301901
013020*  READ A RECORD FROM THE MANIFESTED NOT LOADED FILE             *01302001
013021******************************************************************01302101
013022 7000-READ-EXTRACT-FILE.                                          01302201
013023     READ INPUT-FILE                                              01302301
013024          INTO SU133-EXTRACT-RECORD                               01302402
013025         AT END                                                   01302501
013026             SET PS-END-OF-INPUT TO TRUE                          01302601
013027         NOT AT END                                               01302701
013028             ADD +1 TO PV-READ-COUNT                              01302801
013029     END-READ.                                                    01302901
013030                                                                  01303001
013031*-----------------------------------------------------------------01303101
013032*  READ DATE CONTROL RECORD                                       01303201
013033*-----------------------------------------------------------------01303301
013034 7010-READ-CONTROL-REC.                                           01303401
013040                                                                  01304001
013050     MOVE SPACES  TO  SU032-DATE-CONTROL-REC.                     01305001
013060                                                                  01306001
013070     READ CONTROL-FILE     INTO                                   01307001
013080           SU032-DATE-CONTROL-REC                                 01308001
013090     AT END                                                       01309001
013091         DISPLAY 'PROGRAM:  SUKRP073'                             01309102
013092         DISPLAY 'NO DATE CONTROL CARD'                           01309201
013093         DISPLAY SPACES                                           01309301
013094     NOT AT END                                                   01309401
013095         DISPLAY 'PROGRAM:  SUKRP073'                             01309502
013096         DISPLAY 'DATE CONTROL CARD:'                             01309601
013097                 SU032-DATE-CONTROL-REC                           01309701
013098         DISPLAY SPACES                                           01309801
013099     END-READ.                                                    01309901
013100                                                                  01310001
014691******************************************************************01469101
014692 8500-GET-LOCATION-NAME.                                          01469201
014693******************************************************************01469301
014694                                                                  01469401
014695     MOVE PV-SAVE-OPER-UNT-ID  TO  XLT00010-LOC-NBR               01469501
014696                                   PV-DISPLAY-OPER.               01469601
014697                                                                  01469701
014698     EXEC SQL                                                     01469801
014699         SELECT   LOC_NM                                          01469901
014700           INTO  :XLT00010-LOC-NM                                 01470001
014710           FROM   XLT_LOC                                         01471001
014720          WHERE   LOC_NBR  =  :XLT00010-LOC-NBR                   01472001
014730     END-EXEC.                                                    01473001
014740                                                                  01474001
014750     EVALUATE TRUE                                                01475001
014760         WHEN SQLCODE = +0                                        01476001
014770              MOVE PV-SAVE-OPER-UNT-ID TO HD2-OPER-UNT-ID         01477001
014780              MOVE XLT00010-LOC-NM     TO HD2-DC-NAME             01478001
014790         WHEN OTHER                                               01479001
014791              CONTINUE                                            01479101
014792     END-EVALUATE.                                                01479201
014793                                                                  01479301
014794******************************************************************01479401
014795*  ABEND ROUTINE                                                 *01479501
014796******************************************************************01479601
014797 9900-DB2-ABEND.                                                  01479701
014798                                                                  01479801
014799     MOVE SQLCODE TO PV-SQLCODE.                                  01479901
014800     DISPLAY '*** DB2 ERROR '.                                    01480001
014810     DISPLAY '*** SQLCODE   = ' PV-SQLCODE.                       01481001
014820     DISPLAY '*** PROGRAM   = ' PV-ABEND-PROGRAM.                 01482001
014830     DISPLAY '*** PARAGRAPH = ' PV-ABEND-PARAGRAPH.               01483001
014840     DISPLAY '*** OPERATION = ' PV-ABEND-OPERATION.               01484001
014850     DISPLAY '*** MESSAGE   = ' PV-DB2-OPERATION-MESSAGE-1.       01485001
014860     DISPLAY '***           = ' PV-DB2-OPERATION-MESSAGE-2.       01486001
014870     DISPLAY '*** TABLE 1   = ' PV-DB2-TABLE-NAME-1.              01487001
014880     DISPLAY '*** TABLE 2   = ' PV-DB2-TABLE-NAME-2.              01488001
014890                                                                  01489001
014891     COPY DPPD004.                                                01489101
014892                                                                  01489201
014893     MOVE +4013 TO PV-ABEND-CODE.                                 01489301
014894     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         01489401
014895                                                                  01489501
014896 9998-ABEND.                                                      01489605
014897                                                                  01489701
014898     DISPLAY '***************'.                                   01489801
014899     DISPLAY '** ABEND     **'.                                   01489901
014900     DISPLAY '** PROGRAM   ** = ' PV-ABEND-PROGRAM.               01490001
014910     DISPLAY '** PARAGRAPH ** = ' PV-ABEND-PARAGRAPH.             01491001
014920     DISPLAY '***************'.                                   01492001
014930                                                                  01493001
014940     MOVE +4008                  TO PV-ABEND-CODE.                01494001
014950     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         01495001
014960                                                                  01496001
014961 9999-ABEND.                                                      01496105
014962                                                                  01496205
014963     DISPLAY '***************'.                                   01496305
014964     DISPLAY '** ABEND     **'.                                   01496405
014965     DISPLAY '** PROGRAM   ** = ' PV-ABEND-PROGRAM.               01496505
014966     DISPLAY '** PARAGRAPH ** = ' PV-ABEND-PARAGRAPH.             01496605
014967     DISPLAY '** MESSAGE 1 ** = ' PV-ERROR-MESSAGE-1.             01496705
014968     DISPLAY '** MESSAGE 2 ** = ' PV-ERROR-MESSAGE-2.             01496805
014969     DISPLAY '***************'.                                   01496905
014970                                                                  01497005
014971     MOVE +4008                  TO PV-ABEND-CODE.                01497105
014972     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         01497205
014973                                                                  01497305
014974******************************************************************01497405
014980*                 E N D   O F   P R O G R A M                    *01498001
014990******************************************************************01499001
015000***************************************************************** 01500000
