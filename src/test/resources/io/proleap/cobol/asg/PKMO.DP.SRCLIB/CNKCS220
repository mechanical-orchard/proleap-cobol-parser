000100*-----------------------*                                         00010099
000200 IDENTIFICATION DIVISION.                                         00020000
000300*-----------------------*                                         00030000
000400 PROGRAM-ID.    CNKCS220.                                         00040001
000500 AUTHOR.        DEANNA BRANTNER.                                  00050000
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060000
000700 DATE-WRITTEN.  NOVEMBER, 2000.                                   00070000
000800 DATE-COMPILED.                                                   00080000
000900*---------------------------------------------------------------* 00090000
001000*    Y220 - PRINTER CLUSTER ADD/UPDATE/DELETE                     00100063
001100*---------------------------------------------------------------* 00110000
263455* CHANGED 11/02/2021    BY JIM HUNTER      WR: CHG0263455         00111099
263455* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00112099
263455* MAKING THE CALL DYNAMIC VS STATIC.                              00113099
263455*----------------------------------------------------------------*00114099
CICS  * CHANGED 10/25/2022    BY JIM HUNTER      WR: CHG0276961         00115099
CICS  * ADD COPYBOOK DPWS930 AND MAKE THE CICS ARCHITECTURE CALL        00116099
CICS  * DYNAMIC INSTEAD OF STATIC BY CALLING DP930-CICS-ARCH-API.       00117099
CICS  *-----------------------------------------------------------------00118099
001200 ENVIRONMENT DIVISION.                                            00120000
001300 DATA DIVISION.                                                   00130000
001400                                                                  00140000
001500 WORKING-STORAGE SECTION.                                         00150000
001600 01  DN-DB2-NULL-INDICATORS.                                      00160099
001700     05  DN-CLUSTER-NBR           PIC S9(04)  COMP  VALUE ZEROES. 00170099
001800                                                                  00180000
001900 01  DK-DB2-KEYS.                                                 00190099
002000     10  DK-PRTR-CLUSTR-NBR       PIC  S9(4) COMP   VALUE ZEROES. 00200099
002100                                                                  00210099
002200 01  PC-PROGRAM-CONSTANTS.                                        00220000
002300     05  PC-CURRENT-PROGRAM-NAME  PIC  X(08)  VALUE  'CNKCS220'.  00230001
002400     05  PC-CURRENT-MAP-NAME      PIC  X(08)  VALUE  'CNK220  '.  00240004
002500     05  PC-CURRENT-MAPSET-NAME   PIC  X(08)  VALUE  'CNKM220 '.  00250001
002600     05  PC-APPL-MAP              PIC S9(04)  VALUE  +1           00260000
002700                                              COMP.               00270000
002800     05  PC-MAX-RETRIES           PIC S9(04)  VALUE  +3           00280000
002900                                              COMP.               00290000
003000     05  PC-MAX-MSG-VAR           PIC S9(04)  VALUE  +1           00300000
003100                                              COMP.               00310000
003200     05  PC-UPD-VSAM              PIC  X(01)  VALUE 'Y'.          00320000
003300     05  PC-MSG-VAR-SYMBOLIC      PIC  X(04)  VALUE '&VAR'.       00330000
003400     05  PC-CURSOR                PIC S9(01)  VALUE  -1           00340050
003500                                                    COMP.         00350050
003600     05  PC-INTER-APPL-CODES.                                     00360000
003700         10  PC-INTER-APPL-CRIT-SPEC-ADD PIC  X(01)  VALUE '4'.   00370058
003800         10  PC-INTER-APPL-LIST-ADD      PIC  X(01)  VALUE '2'.   00380058
003900         10  PC-INTER-APPL-LIST-UPDATE   PIC  X(01)  VALUE '3'.   00390058
004000         10  PC-INTER-APPL-LIST-DELETE   PIC  X(01)  VALUE '1'.   00400058
004100     05  PC-INQ                    PIC  X(03)  VALUE 'INQ'.       00410058
004200     05  PC-UPD                    PIC  X(03)  VALUE 'UPD'.       00420058
004300     05  PC-DEL                    PIC  X(03)  VALUE 'DEL'.       00430058
004400     05  PC-ERR                    PIC  X(03)  VALUE 'ERR'.       00440058
004500     05  PC-RLSE-CDE               PIC  X(03)  VALUE '4.0'.       00450099
004600     05  PC-XFERCDE                PIC  X(02)  VALUE 'D1'.        00460099
004700     05  PC-PERIOD                 PIC  X(01)  VALUE '.'.         00470099
004800                                                                  00480099
004900*LMM ADD DESCRIPTIONS                                             00490099
005000*----------------------------------------------------------------*00500099
005100*  SYSTEM MESSAGES                                                00510099
005200*----------------------------------------------------------------*00520099
005300*   00005 - INVALID VALUE                                         00530099
005400*   00007 - REQUIRED ENTRY                                        00540099
005500*   00008 - MUST BE NUMERIC                                       00550099
005600*   00034 - ADD SUCCESSFUL                                        00560099
005700*   00046 - DATA NOT CHANGED; NO UPDATE PERFORMED                 00570099
005800*   00059 - UPDATE(S) SUCCESSFUL                                  00580099
005900*   00069 - TOP OF LIST                                           00590099
006000*   00070 - BOTTOM OF LIST                                        00600099
006100*   00115 - DELETE SUCCESSFUL                                     00610099
006200*   00116 - CANNOT DELETE - RECORD DOES NOT EXIST                 00620099
006300*   00117 - CANNOT ADD - RECORD ALREADY EXISTS                    00630099
006400*   00148 - DATA DOES NOT EXIST                                   00640099
006500*   00302 - DATA ENTERED IN THE 'KEY' FIELD IS INVALID            00650099
006600*   00354 - DELETE PENDING - PRESS PF2 TO CONFIRM                 00660099
006700*   99901 - INVALID COMMAND WAS ENTERED                           00670099
006800*----------------------------------------------------------------*00680099
006900     05  PC-TSYMSG-NUMBERS.                                       00690000
007000         10  PC-TSYMSG-00005      PIC  9(05)  VALUE  00005.       00700000
007100         10  PC-TSYMSG-00007      PIC  9(05)  VALUE  00007.       00710099
007200         10  PC-TSYMSG-00008      PIC  9(05)  VALUE  00008.       00720099
007300         10  PC-TSYMSG-00034      PIC  9(05)  VALUE  00034.       00730055
007400         10  PC-TSYMSG-00046      PIC  9(05)  VALUE  00046.       00740072
007500         10  PC-TSYMSG-00059      PIC  9(05)  VALUE  00059.       00750000
007600         10  PC-TSYMSG-00069      PIC  9(05)  VALUE  00069.       00760000
007700         10  PC-TSYMSG-00070      PIC  9(05)  VALUE  00070.       00770000
007800         10  PC-TSYMSG-00115      PIC  9(05)  VALUE  00115.       00780055
007900         10  PC-TSYMSG-00116      PIC  9(05)  VALUE  00116.       00790055
008000         10  PC-TSYMSG-00117      PIC  9(05)  VALUE  00117.       00800055
008100         10  PC-TSYMSG-00148      PIC  9(05)  VALUE  00148.       00810000
008200         10  PC-TSYMSG-00302      PIC  9(05)  VALUE  00302.       00820000
008300         10  PC-TSYMSG-00354      PIC  9(05)  VALUE  00354.       00830055
008400         10  PC-TSYMSG-99901      PIC  9(05)  VALUE  99901.       00840000
008500                                                                  00850000
008600 01  PS-PROGRAM-SWITCHES.                                         00860000
008700     05  PS-ERROR-SW              PIC  X(01)  VALUE  'N'.         00870000
008800         88  PS-ERROR                         VALUE  'Y'.         00880000
008900         88  PS-NO-ERROR                      VALUE  'N'.         00890000
009000     05  PS-CURSOR-END-SW         PIC  X(01)  VALUE  'N'.         00900000
009100         88  PS-CURSOR-END                    VALUE  'Y'.         00910000
009200         88  PS-CURSOR-NOT-END                VALUE  'N'.         00920000
009300     05  PS-RECORD-UPDATED-SW         PIC  X(01).                 00930071
009400         88  PS-RECORD-UPDATED                VALUE  'Y'.         00940071
009500         88  PS-RECORD-NOT-UPDATED            VALUE  'N'.         00950071
009600*                                                                 00960000
009700 01  PV-PROGRAM-VARIABLES.                                        00970000
009800     05  PV-OPER-UNT-ID           PIC S9(04)  COMP.               00980099
009900     05  PV-FCLTY-NME             PIC X(25).                      00990099
010000     05  PV-FCLTY-ID              PIC S9(04)  COMP.               01000099
010100******************************************************************01010000
010200*PV-INP VARIABLES HOLD COMMAREA VALUES                            01020000
010300*       ONLY PV-INP VARIABLES READ FROM AND WRITE TO ASC-'S       01030000
010400*PV-TBL VARIABLES HOLD TABLE VALUES                               01040000
010500*       ONLY PV-TBL VARIABLES READ FROM AND WRITE TO TABLES       01050000
010600******************************************************************01060000
010700     05  PV-CICS-RESPONSE         PIC S9(04)  VALUE +0 COMP SYNC. 01070012
010800     05  PV-RETRY-COUNTER         PIC S9(04)  VALUE +0 COMP SYNC. 01080012
010900     05  PV-MSG-VAR-CNT           PIC S9(04)  VALUE +0 COMP SYNC. 01090012
011000     05  PV-INPUT-SPACE-CNT       PIC S9(04)  VALUE +0 COMP SYNC. 01100012
011100                                                                  01110000
011200     05  PV-INP-OPER-UNT-ID       PIC S9(04)  COMP.               01120007
011300     05  PV-INP-FCLTY-NME         PIC X(25).                      01130007
011400     05  PV-INP-FCLTY-ID          PIC S9(04)  COMP.               01140007
011500     05  PV-INP-CLUSTR-NBR        PIC S9(04)  VALUE +0 COMP.      01150099
011600     05  PV-INP-IP-ADDRESS        PIC X(15).                      01160030
011700     05  PV-INP-OS-RLSE-CDE       PIC X(05).                      01170007
011800     05  PV-INP-DTXFR-MDEID       PIC X(02).                      01180007
011900     05  PV-INP-XMIT-INTFCD       PIC X(01).                      01190015
012000                                                                  01200000
012100     05  PV-TBL-OPER-UNT-ID       PIC S9(04)  COMP.               01210064
012200     05  PV-TBL-FCLTY-ID          PIC S9(04)  COMP.               01220064
012300*LMM 05  PV-TBL-CLUSTR-NBR        PIC S9(04)  VALUE +0 COMP.      01230099
012400     05  PV-TBL-CLUSTR-NBR        PIC X(04).                      01240099
012500     05  PV-TBL-CLUSTR-NBR-R REDEFINES                            01250099
012600                                     PV-TBL-CLUSTR-NBR.           01260099
012700         10  PV-TBL-CLUSTR-NBR-N PIC 9(04).                       01270099
012800     05  PV-TBL-IP-ADDRESS        PIC X(15).                      01280064
012900     05  PV-TBL-OS-RLSE-CDE       PIC X(05).                      01290064
013000     05  PV-TBL-DTXFR-MDEID       PIC X(02).                      01300064
013100     05  PV-TBL-XMIT-INTFCD       PIC X(01).                      01310064
013200                                                                  01320064
013300     05  PV-TYPE-1                       PIC X(01)  VALUE SPACES. 01330099
013400         88   PV-TYPE-1-FTP                         VALUE 'F'.    01340099
013500         88   PV-TYPE-1-SOCKETS                     VALUE 'S'.    01350099
013600     05  PV-TYPE-2                       PIC X(02)  VALUE SPACES. 01360099
013700         88   PV-TYPE-2-FTP                         VALUE 'F'.    01370099
013800         88   PV-TYPE-2-SOCKETS                     VALUE 'S'.    01380099
013900*                                                                 01390099
014000*---------------------------------------------------------------* 01400000
014100* SELECTON QUEUE LAYOUT                                         * 01410000
014200*---------------------------------------------------------------* 01420000
014300     COPY CNWS163.                                                01430002
014400                                                                  01440000
014500*----------------------------------------------------------------*01450000
014600*    MAP LAYOUT                                                  *01460000
014700*----------------------------------------------------------------*01470000
014800     COPY CNKM220.                                                01480002
014900                                                                  01490000
015000*----------------------------------------------------------------*01500000
015100*    ATTRIBUTE SETTINGS COPYBOOK.                                *01510000
015200*----------------------------------------------------------------*01520000
015300     COPY DPWS015.                                                01530000
015400     COPY DPWS057.                                                01540000
015500                                                                  01550000
015600*----------------------------------------------------------------*01560000
015700*    FUNCTION KEYS COPYBOOK                                      *01570000
015800*----------------------------------------------------------------*01580000
015900     COPY DPWS016.                                                01590000
016000                                                                  01600000
016100**--------------------------------------------------------------**01610000
016200** THE CALLING PARAMETER LIST (DPWS010) FOR THE NUMERIC EDIT    **01620000
016300** SUB-ROUTINE (DPKUT100).                                      **01630000
016400**--------------------------------------------------------------**01640000
016500     COPY DPWS010I.                                               01650000
016600                                                                  01660000
016700**--------------------------------------------------------------**01670000
016800** THE CALLING PARAMETER LIST (DPWS030) FOR THE CICS ARCHITECTURE*01680000
016900** APPLICATION PROGRAMMING INTERFACE MODULE.                    **01690099
017000**--------------------------------------------------------------**01700000
017100     COPY DPWS030.                                                01710000
CICS       COPY DPWS930.                                                01711099
017200                                                                  01720000
017300**--------------------------------------------------------------**01730000
017400*    STANDARD COMMAREA.                                           01740000
017500**--------------------------------------------------------------**01750000
017600     COPY DPWS020.                                                01760000
017700     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                01770000
017800                                                                  01780000
017900***************************************************************** 01790000
018000*    INTER-APPLICATION COMMAREA.                                  01800000
018100***************************************************************** 01810000
018200         10  INTER-APPL-COMM-AREA PIC X(200).                     01820000
018300     COPY CNWS161.                                                01830002
018400     COPY CNWS162.                                                01840002
018500                                                                  01850058
018600***************************************************************** 01860000
018700*    SPECIFIC COMMMAREA FOR CNKCS220.                             01870058
018800***************************************************************** 01880000
018900         10  ASC-SPECIFIC-COMMAREA.                               01890000
019000             15  ASC-PRTR-OPER-UNT-ID      PIC S9(04)  COMP.      01900000
019100             15  ASC-PRTR-FCLTY-ID         PIC S9(04)  COMP.      01910000
019200*LMM         15  ASC-PRTR-CLUSTR-NBR       PIC S9(04)  COMP.      01920099
019300             15  ASC-PRTR-CLUSTR-NBR       PIC X(04).             01930099
019400             15  ASC-PRTR-CLUSTR-NBR-R REDEFINES                  01940099
019500                                       ASC-PRTR-CLUSTR-NBR.       01950099
019600                 20  ASC-PRTR-CLUSTR-NBR-N PIC 9(04).             01960099
019700                                                                  01970099
019800             15  ASC-PRTR-FCLTY-NME        PIC X(25).             01980030
019900*                                                                 01990099
020000             15  ASC-OPER-SYS-RLSE-CDE     PIC X(05).             02000012
020100             15  ASC-DATA-XFER-MODE-ID     PIC X(02).             02010012
020200*-------------                                                    02020099
020300             15  ASC-ACTION-SW          PIC X(03).                02030058
020400                 88  ASC-ADD            VALUE 'ADD'.              02040058
020500                 88  ASC-DELETE         VALUE 'DEL'.              02050058
020600                 88  ASC-UPDATE         VALUE 'UPD'.              02060058
020700             15  ASC-VERIFICATION-SW       PIC X(01).             02070000
020800                 88  ASC-UN-VERIFY                    VALUE  'N'. 02080000
020900                 88  ASC-NEED-VERIFICATION            VALUE  'Y'. 02090000
021000             15  PS-TABLES-UPDATED-SW     PIC  X(01).             02100000
021100                 88  PS-TABLES-UPDATED                VALUE  'Y'. 02110000
021200                 88  PS-TABLES-NOT-UPDATED            VALUE  'N'. 02120000
021300*--------------                                                   02130000
021400             15  ASC-MSG-NUMBER.                                  02140000
021500                 20  ASC-MSG-NUMBER-N      PIC  9(05).            02150000
021600             15  ASC-INT-APPL-FORMAT-SAVE  PIC  X(01).            02160000
021700             15  ASC-SYSTEM-ID             PIC  X(02).            02170000
021800             15  ASC-MSG-TEXT              PIC  X(70).            02180000
021900             15  ASC-USE-SELECTION-QUEUE-IND                      02190000
022000                                           PIC  X(01).            02200000
022100                 88  ASC-USE-SELECTION-QUEUE           VALUE 'Y'. 02210000
022200             15  ASC-SEL-QUEUE-NAME        PIC  X(08).            02220000
022300             15  ASC-NUMBER-OF-TS-ITEMS    PIC S9(05)  COMP-3.    02230000
022400             15  ASC-NUMBER-OF-SELECTED-ITEMS                     02240000
022500                                           PIC S9(09)  COMP-3.    02250000
022600             15  ASC-SEL-SUB               PIC S9(04)  COMP.      02260000
022700             15  ASC-SEL-ITEM              PIC S9(04)  COMP.      02270000
022800             15  ASC-INT-APPL-FORMAT-IND   PIC  X(01).            02280015
022900*LMM                                                              02290099
023000             15  ASC-TEMP-QUEUE-UPDATE-SW     PIC  X(01).         02300099
023100                 88  ASC-UPDATE-TSQ                VALUE 'Y'.     02310099
023200                 88  ASC-NO-TSQ-UPDATE             VALUE ' '.     02320099
023300             15  ASC-XMIT-INTRFC-CDE          PIC X(01).          02330099
023400                 88  ASC-SELECT-SRC-VALID     VALUE 'F' 'S' ' '.  02340099
023500                 88  ASC-INTFCE-CODE-ENTERED  VALUE 'F' 'S'.      02350099
023600                 88  ASC-SELECT-FTP               VALUE 'F'.      02360099
023700                 88  ASC-SELECT-SOCKETS           VALUE 'S'.      02370099
023800                                                                  02380099
023900         10  ASC-IP-ADDR.                                         02390099
024000*NEED THESE FIELDS FOR USE IN NUMERIC EDITS                       02400099
024100             15  ASC-IP-ADDR1              PIC X(03).             02410099
024200             15  ASC-IP-ADDR1-R REDEFINES                         02420099
024300                                       ASC-IP-ADDR1.              02430099
024400                 20  ASC-IP-ADDR1-N        PIC 9(03).             02440099
024500             15  ASC-PER1                  PIC X(01).             02450099
024600             15  ASC-IP-ADDR2              PIC X(03).             02460099
024700             15  ASC-IP-ADDR2-R REDEFINES                         02470099
024800                                       ASC-IP-ADDR2.              02480099
024900                 20  ASC-IP-ADDR2-N        PIC 9(03).             02490099
025000             15  ASC-PER2                  PIC X(01).             02500099
025100             15  ASC-IP-ADDR3              PIC X(03).             02510099
025200             15  ASC-IP-ADDR3-R REDEFINES                         02520099
025300                                       ASC-IP-ADDR3.              02530099
025400                 20  ASC-IP-ADDR3-N        PIC 9(03).             02540099
025500             15  ASC-PER3                  PIC X(01).             02550099
025600             15  ASC-IP-ADDR4              PIC X(03).             02560099
025700             15  ASC-IP-ADDR4-R REDEFINES                         02570099
025800                                       ASC-IP-ADDR4.              02580099
025900                 20  ASC-IP-ADDR4-N        PIC 9(03).             02590099
026000*        10  FILLER                        PIC X(58).             02600000
026100                                                                  02610000
026200*----------------------------------------------------------------*02620000
026300*    ABEND PROCESSING COPYBOOK.                                  *02630000
026400*----------------------------------------------------------------*02640000
026500     COPY DPWS013.                                                02650000
026600                                                                  02660000
026700*****DB2 AREA FOR TSYMSG  (SYSTEM MESSAGE - SHORT MESSAGE)        02670001
026800     EXEC SQL                                                     02680000
026900          INCLUDE TSYMSG                                          02690000
027000     END-EXEC.                                                    02700000
027100                                                                  02710000
027200*****DB2 AREA FOR COMMUNICATIONS                                  02720001
027300     EXEC SQL                                                     02730000
027400          INCLUDE SQLCA                                           02740000
027500     END-EXEC.                                                    02750000
027600                                                                  02760000
027700*****DB2 AREA FOR PRINTER CLUSTER                                 02770012
027800     EXEC SQL                                                     02780000
027900          INCLUDE TPRTRCL                                         02790000
028000     END-EXEC.                                                    02800000
028100                                                                  02810000
028200*****COMMAREA USED TO CALL XLKUT071                               02820099
028300     COPY XLWS071.                                                02830099
028600                                                                  02860043
028700*****DB2 AREA FOR RETEK PROCESSING PARMS TABLE                    02870099
028800     EXEC SQL                                                     02880099
028900          INCLUDE TKRPRPM                                         02890099
029000     END-EXEC.                                                    02900099
029100                                                                  02910099
029200************************************************************      02920000
029300*    DEFINITION FOR CURSOR.                                       02930001
029400************************************************************      02940000
029500     EXEC SQL                                                     02950000
029600          DECLARE TPRTRCL-CSR CURSOR FOR                          02960006
029700          SELECT  PRTR_CLUSTR_NBR                                 02970001
029800                 ,CLUSTR_OPER_UNT_ID                              02980013
029900                 ,CLUSTR_FCLTY_ID                                 02990013
030000                 ,IP_ADDR                                         03000013
030100                 ,CLUSTR_OS_RLSE_CDE                              03010013
030200                 ,DAT_XFER_MODE_ID                                03020013
030300                 ,XMIT_INTFC_CDE                                  03030013
030400            FROM  TPRTRCL                                         03040003
030500            WHERE                                                 03050027
030600                  PRTR_CLUSTR_NBR = :DK-PRTR-CLUSTR-NBR           03060099
030700              AND CLUSTR_OPER_UNT_ID = :ASC-PRTR-OPER-UNT-ID      03070073
030800              AND CLUSTR_FCLTY_ID    = :ASC-PRTR-FCLTY-ID         03080029
030900     END-EXEC.                                                    03090000
031000                                                                  03100000
031100 LINKAGE SECTION.                                                 03110000
031200                                                                  03120000
031300 01  DFHCOMMAREA.                                                 03130000
031400     05  FILLER                         OCCURS  1 TO 4072 TIMES   03140000
031500                                        DEPENDING ON EIBCALEN.    03150000
031600         10  FILLER                     PIC X.                    03160000
031700                                                                  03170000
031800                                                                  03180000
031900 PROCEDURE DIVISION.                                              03190000
032000***************************************************************** 03200000
032100** THIS MODULE CONTROLS THE OVERALL PROCESSING IN THE PROGRAM. ** 03210000
032200** THE SETUP AND PERFORM OF PARAGRAPH 0001-CALL-CICS-ARCH-API  ** 03220000
032300** MUST BE THE FIRST CODE EXECUTED IN THIS PROGRAM.            ** 03230000
032400**                                                             ** 03240000
032500** THE SECOND OR 'EXIT' PERFORM OF THIS PARAGRAPH MUST BE THE  ** 03250000
032600** LAST CODE EXECUTED ON EACH ITERATION OF THIS PROGRAM.       ** 03260000
032700***************************************************************** 03270000
032800 0000-MAIN-MODULE.                                                03280000
032900     INITIALIZE DP030-CICS-API-FIELDS.                            03290000
033000     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       03300000
033100     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          03310000
033200     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         03320000
033300     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       03330000
033400     MOVE LENGTH OF CNK220I        TO DP030-MAP-LENGTH (1).       03340012
033500     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     03350000
033600     PERFORM 0001-CALL-CICS-ARCH-API.                             03360000
033700*                                                                 03370000
033800     PERFORM 1000-CONTROL-PROCESSING                              03380000
033900*                                                                 03390000
034000     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     03400000
034100     PERFORM 0001-CALL-CICS-ARCH-API.                             03410000
034200                                                                  03420000
034300***************************************************************** 03430001
034400 0001-CALL-CICS-ARCH-API.                                         03440000
CICS       CALL DP930-CICS-ARCH-API USING DFHEIBLK                      03450099
034600                                    DFHCOMMAREA                   03460099
034700                                    DP030-CICS-API-FIELDS         03470099
034800                                    DP020-STANDARD-COMMAREA       03480099
034900                                    CNK220I.                      03490099
035000*                                                                 03500000
035100     IF  DP030-RC-CALL-SUCCESSFUL                                 03510000
035200         CONTINUE                                                 03520000
035300     ELSE                                                         03530000
035400         SET DP013-NO-ROLLBACK                                    03540000
035500             DP013-XCTL-DISPLAY-RESTART                           03550000
035600             DP013-CICS-ABEND      TO TRUE                        03560000
035700         MOVE 'BEFORE 0000-MAIN-MODULE' TO DP013-PARAGRAPH        03570001
CICS           MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O03571099
CICS  -             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      03572099
036000         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      03600000
036100         PERFORM DP013-0000-PROCESS-ABEND                         03610000
036200     END-IF.                                                      03620000
036300                                                                  03630000
036400*----------------------------------------------------------------*03640000
036500*    PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT   *03650000
036600*    COURSE OF ACTION IS FOR THIS TRANSACTION.                   *03660000
036700*----------------------------------------------------------------*03670000
036800 1000-CONTROL-PROCESSING.                                         03680000
036900     EVALUATE TRUE                                                03690000
037000         WHEN DP020-NEXT-ACT-INITIAL                              03700000
037100              PERFORM 1100-FIND-OBJECT-KEYS                       03710000
037200              IF  PS-ERROR                                        03720000
037300                  CONTINUE                                        03730000
037400              ELSE                                                03740000
037500                  PERFORM 4000-BUILD-INITIAL-PANEL                03750000
037600                  IF  SQLCODE = +100                              03760000
037700                      SET DP020-NEXT-ACT-APPL-ERROR TO TRUE       03770000
037800                      MOVE PC-TSYMSG-00148 TO DP020-MSG-NUMBER    03780001
037900                      SET DP020-MSG-INFORMATIONAL TO TRUE         03790000
038000                  END-IF                                          03800000
038100              END-IF                                              03810000
038200                                                                  03820000
038300         WHEN DP020-NEXT-ACT-READ-MAP                             03830000
038400             PERFORM 2000-PROCESS-PANEL                           03840000
038500*F3                                                               03850099
038600         WHEN DP020-NEXT-ACT-RETURN                               03860000
038700             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 03870099
038800             PERFORM 4000-BUILD-INITIAL-PANEL                     03880099
038900             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   03890000
039000                                                                  03900000
039100         WHEN OTHER                                               03910000
039200             SET DP013-LOGIC-ABEND TO TRUE                        03920000
039300             SET DP013-NO-ROLLBACK TO TRUE                        03930000
039400             MOVE '1000-CONTROL-PROCESSING' TO DP013-PARAGRAPH    03940012
039500             MOVE 'INVALID NEXT ACTIVITY RETURNED TO APPL PGM:'   03950000
039600                                   TO DP013-MESSAGE-TEXT(1)       03960000
039700             MOVE DP020-NEXT-APPL-ACTIVITY                        03970000
039800                                   TO DP013-MESSAGE-TEXT(2)       03980000
039900             PERFORM DP013-0000-PROCESS-ABEND                     03990000
040000     END-EVALUATE.                                                04000000
040100                                                                  04010001
040200******************************************************************04020000
040300** DETERMINE THE KEY OF THE OBJECT TO BE UPDATED BASED ON THE   **04030000
040400** INTER-APPLICATION FORMAT CODE.                               **04040000
040500******************************************************************04050000
040600 1100-FIND-OBJECT-KEYS.                                           04060000
040700     INITIALIZE ASC-SPECIFIC-COMMAREA.                            04070024
040800     MOVE DP020-INT-APPL-FORMAT-IND TO ASC-INT-APPL-FORMAT-IND.   04080018
040900                                                                  04090000
041000     EVALUATE ASC-INT-APPL-FORMAT-IND                             04100000
041100         WHEN PC-INTER-APPL-CRIT-SPEC-ADD                         04110000
041200             MOVE CN161-OPER-UNT-ID TO ASC-PRTR-OPER-UNT-ID       04120056
041300             MOVE CN161-FCLTY-ID TO ASC-PRTR-FCLTY-ID             04130056
041400             MOVE CN161-FCLTY-NME TO ASC-PRTR-FCLTY-NME           04140056
041500                                                                  04150099
041600         WHEN PC-INTER-APPL-LIST-ADD                              04160000
041700             SET ASC-USE-SELECTION-QUEUE TO TRUE                  04170000
041800             MOVE CN162-NUMBER-OF-SELECTED-ITEMS                  04180012
041900                                   TO ASC-NUMBER-OF-SELECTED-ITEMS04190000
042000             MOVE CN162-NUMBER-OF-TS-ITEMS                        04200012
042100                                        TO ASC-NUMBER-OF-TS-ITEMS 04210002
042200             MOVE CN162-SEL-QUEUE-NAME                            04220012
042300                                   TO ASC-SEL-QUEUE-NAME          04230000
042400             MOVE CN162-OPER-UNT-ID TO ASC-PRTR-OPER-UNT-ID       04240055
042500             MOVE CN162-FCLTY-ID TO ASC-PRTR-FCLTY-ID             04250055
042600             MOVE CN162-FCLTY-NME TO ASC-PRTR-FCLTY-NME           04260055
042700*LMM         MOVE ZEROES           TO ASC-PRTR-CLUSTR-NBR         04270099
042800             MOVE SPACES           TO ASC-IP-ADDR                 04280099
042900                                      ASC-OPER-SYS-RLSE-CDE       04290019
043000                                      ASC-DATA-XFER-MODE-ID       04300019
043100                                      ASC-XMIT-INTRFC-CDE         04310019
043200             PERFORM 4500-MOVE-COMMAREA-TO-TEMP                   04320099
043300*LMM                                                              04330099
043400         WHEN PC-INTER-APPL-LIST-UPDATE                           04340000
043500           IF CN162-NUMBER-OF-SELECTED-ITEMS > 0                  04350099
043600             SET ASC-USE-SELECTION-QUEUE TO TRUE                  04360000
043700             MOVE CN162-NUMBER-OF-SELECTED-ITEMS                  04370012
043800                                   TO ASC-NUMBER-OF-SELECTED-ITEMS04380000
043900             MOVE CN162-NUMBER-OF-TS-ITEMS                        04390012
044000                                   TO ASC-NUMBER-OF-TS-ITEMS      04400000
044100             MOVE CN162-SEL-QUEUE-NAME TO ASC-SEL-QUEUE-NAME      04410031
044200             MOVE CN162-OPER-UNT-ID TO ASC-PRTR-OPER-UNT-ID       04420012
044300             MOVE CN162-FCLTY-ID TO ASC-PRTR-FCLTY-ID             04430012
044400             MOVE CN162-FCLTY-NME TO ASC-PRTR-FCLTY-NME           04440012
044500             MOVE 'UPD' TO  ASC-ACTION-SW                         04450061
044600             PERFORM 1120-PREPARE-LIST-ENTRY                      04460000
044700             PERFORM 4500-MOVE-COMMAREA-TO-TEMP                   04470000
044800           END-IF                                                 04480099
044900*                                                                 04490099
045000         WHEN PC-INTER-APPL-LIST-DELETE                           04500050
045100           IF CN162-NUMBER-OF-SELECTED-ITEMS > 0                  04510099
045200             SET ASC-USE-SELECTION-QUEUE TO TRUE                  04520050
045300             MOVE CN162-NUMBER-OF-SELECTED-ITEMS                  04530050
045400                                   TO ASC-NUMBER-OF-SELECTED-ITEMS04540050
045500             MOVE CN162-NUMBER-OF-TS-ITEMS                        04550050
045600                                   TO ASC-NUMBER-OF-TS-ITEMS      04560050
045700             MOVE CN162-SEL-QUEUE-NAME TO ASC-SEL-QUEUE-NAME      04570050
045800             MOVE CN162-OPER-UNT-ID TO ASC-PRTR-OPER-UNT-ID       04580050
045900             MOVE CN162-FCLTY-ID TO ASC-PRTR-FCLTY-ID             04590050
046000             MOVE CN162-FCLTY-NME TO ASC-PRTR-FCLTY-NME           04600050
046100             MOVE 'DEL' TO  ASC-ACTION-SW                         04610094
046200             PERFORM 1120-PREPARE-LIST-ENTRY                      04620050
046300             PERFORM 4500-MOVE-COMMAREA-TO-TEMP                   04630050
046400           END-IF                                                 04640099
046500                                                                  04650099
046600         WHEN OTHER                                               04660050
046700             IF  DP020-NAV-KEY-DATA > SPACE                       04670000
046800                 PERFORM 1110-EDIT-NAV-KEY                        04680000
046900             ELSE                                                 04690000
047000                 MOVE PC-TSYMSG-00148 TO DP020-MSG-NUMBER         04700012
047100                 SET DP020-MSG-FATAL                              04710000
047200                     DP020-NEXT-ACT-APPL-ERROR                    04720000
047300                                   TO TRUE                        04730000
047400             END-IF                                               04740000
047500     END-EVALUATE.                                                04750000
047600                                                                  04760001
047700******************************************************************04770000
047800** EDIT THE KEY ENTERED BY THE USER INTO THE KEY FIELD OF THE   **04780000
047900** COMMAND LINE.  A VALID MESSAGE NUMBER IS THE ONLY KEY        **04790000
048000** ACCEPTED.                                                    **04800000
048100******************************************************************04810000
048200 1110-EDIT-NAV-KEY.                                               04820000
048300     IF  ASC-MSG-NUMBER > SPACE                                   04830000
048400         MOVE DP020-NAV-KEY-DATA   TO DP010I-UNEDITED-FIELD       04840000
048500         MOVE LENGTH OF ASC-MSG-NUMBER TO DP010I-MAXIMUM-DIGITS   04850012
048600         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     04860000
048700         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  04870012
263455         CALL DP010I-NUMERIC-EDIT-ROUTINE                         04881099
263455              USING DP010I-NUMERIC-EDIT-AREA                      04882099
048900         IF  DP010I-ERROR-DETECTED                                04890000
049000             SET PS-ERROR                                         04900000
049100                 DP020-MSG-FATAL   TO TRUE                        04910000
049200*            -- INVALID DATA IN KEY FIELD ---                     04920000
049300             MOVE PC-TSYMSG-00302  TO DP020-MSG-NUMBER            04930000
049400             SET DP020-NEXT-ACT-APPL-ERROR TO TRUE                04940001
049500         ELSE                                                     04950000
049600             MOVE DP010I-NUMERIC-FIELD TO ASC-MSG-NUMBER-N        04960001
049700         END-IF                                                   04970000
049800     END-IF.                                                      04980000
049900                                                                  04990001
050000*----------------------------------------------------------------*05000000
050100* ENTRY IS FROM A LIST.  GET THE MESSAGE NUMBER FROM THE TEMP    *05010000
050200* STORAGE QUEUE PASSED FROM THE LIST.                            *05020000
050300*----------------------------------------------------------------*05030000
050400 1120-PREPARE-LIST-ENTRY.                                         05040000
050500     MOVE CN163-MAX-ITEMS          TO ASC-SEL-SUB.                05050012
050600     MOVE ZERO                     TO ASC-SEL-ITEM.               05060000
050700     PERFORM 2110-GET-NEXT-MESSAGE.                               05070000
050800                                                                  05080001
050900*----------------------------------------------------------------*05090000
051000* DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA   *05100000
051100* ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *05110000
051200* USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *05120000
051300* OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *05130000
051400* FUNCTION KEYS CAN GET THIS FAR.                                *05140000
051500*----------------------------------------------------------------*05150000
051600 2000-PROCESS-PANEL.                                              05160000
051700     EVALUATE TRUE                                                05170000
051800         WHEN DP020-SRC-AID = DP016-CLEAR                         05180000
051900             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 05190000
052000             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   05200000
052100             SET ASC-UN-VERIFY     TO TRUE                        05210000
052200                                                                  05220000
052300*F5 REFRESH - CLEAR ALL FIELDS EXCEPT OPER UNIT ID,               05230099
052400*CLEAR ALL FIELDS EXCEPT OPER UNT ID, FCLTY NAME & FCLTY ID       05240099
052500         WHEN DP020-FK-REFRESH(DP020-SRC-AID)                     05250099
052600             SET DP030-DONT-ERASE                                 05260099
052700                 DP030-SEND-DATAONLY (PC-APPL-MAP)                05270099
052800                 ASC-UN-VERIFY     TO TRUE                        05280099
052900             MOVE ASC-PRTR-OPER-UNT-ID TO PV-OPER-UNT-ID          05290099
053000             MOVE ASC-PRTR-FCLTY-NME   TO PV-FCLTY-NME            05300099
053100             MOVE ASC-PRTR-FCLTY-ID    TO PV-FCLTY-ID             05310099
053200*DMH         INITIALIZE ASC-SPECIFIC-COMMAREA                     05320099
053300             MOVE PV-OPER-UNT-ID  TO ASC-PRTR-OPER-UNT-ID         05330099
053400             MOVE PV-FCLTY-NME    TO ASC-PRTR-FCLTY-NME           05340099
053500             MOVE PV-FCLTY-ID     TO ASC-PRTR-FCLTY-ID            05350099
053600                                                                  05360099
053700             PERFORM 4000-BUILD-INITIAL-PANEL                     05370000
053800*LMM         PERFORM 3115-CLEAR-FIELDS                            05380099
053900*DMH         PERFORM 3200-RESET-ATTRIBUTES                        05390099
054000                                                                  05400000
054100*F20-NEXT SEL                                                     05410099
054200         WHEN DP020-FK-NEXT-SELECTION (DP020-SRC-AID)             05420000
054300             IF  ASC-USE-SELECTION-QUEUE                          05430000
054400                 SET ASC-UN-VERIFY TO TRUE                        05440000
054500                 PERFORM 2110-GET-NEXT-MESSAGE                    05450000
054600                 PERFORM 4500-MOVE-COMMAREA-TO-TEMP               05460000
054700                 PERFORM 4650-CURSOR-DRIVER                       05470000
054800                 PERFORM 4600-MOVE-TEMP-TO-COMMAREA               05480000
054900                 PERFORM 4000-BUILD-INITIAL-PANEL                 05490000
055000                 PERFORM 3200-RESET-ATTRIBUTES                    05500000
055100             ELSE                                                 05510000
055200* --- BOTTOM OF LIST ---                                          05520012
055300                 MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER         05530012
055400                 SET DP020-MSG-INFORMATIONAL TO TRUE              05540012
055500             END-IF                                               05550000
055600                                                                  05560000
055700*F19-PREV SEL                                                     05570099
055800         WHEN DP020-FK-PREV-SELECTION (DP020-SRC-AID)             05580000
055900             IF  ASC-USE-SELECTION-QUEUE                          05590000
056000                 SET ASC-UN-VERIFY TO TRUE                        05600000
056100                 PERFORM 2120-GET-PREV-MESSAGE                    05610000
056200                 PERFORM 4500-MOVE-COMMAREA-TO-TEMP               05620000
056300                 PERFORM 4650-CURSOR-DRIVER                       05630000
056400                 PERFORM 4600-MOVE-TEMP-TO-COMMAREA               05640000
056500                 PERFORM 4000-BUILD-INITIAL-PANEL                 05650000
056600                 PERFORM 3200-RESET-ATTRIBUTES                    05660000
056700             ELSE                                                 05670000
056800* --- TOP OF LIST ---                                             05680012
056900                 MOVE PC-TSYMSG-00069 TO DP020-MSG-NUMBER         05690001
057000                 SET DP020-MSG-INFORMATIONAL TO TRUE              05700001
057100             END-IF                                               05710000
057200                                                                  05720000
057300         WHEN OTHER                                               05730000
057400             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 05740000
057500             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   05750000
057600             IF  PS-NO-ERROR                                      05760000
057700                 SET DP030-CONTINUE-GO TO TRUE                    05770001
057800                 PERFORM 4500-MOVE-COMMAREA-TO-TEMP               05780000
057900                 PERFORM 2100-CHECK-FUNCTION-KEY                  05790000
058000                 PERFORM 4600-MOVE-TEMP-TO-COMMAREA               05800000
058100                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             05810086
058200             ELSE                                                 05820000
058300                 SET DP030-OVERRIDE-GO TO TRUE                    05830001
058400             END-IF                                               05840000
058500     END-EVALUATE.                                                05850000
058600                                                                  05860001
058700*----------------------------------------------------------------*05870000
058800* ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED       *05880000
058900* FIRST.  NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED   *05890000
059000* FROM THE CICS ARCHITECTURE API.                                *05900000
059100*----------------------------------------------------------------*05910000
059200 2100-CHECK-FUNCTION-KEY.                                         05920000
059300     EVALUATE TRUE                                                05930000
059400         WHEN DP020-SRC-AID = DP016-ENTER                         05940000
059500             SET ASC-UN-VERIFY TO TRUE                            05950000
059600             SET CN163-INQ (ASC-SEL-SUB) TO TRUE                  05960099
059700             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 05970096
059800                                                                  05980000
059900         WHEN DP020-FK-CONFIRM (DP020-SRC-AID)                    05990000
060000             IF ASC-NEED-VERIFICATION                             06000000
060100                 SET ASC-UN-VERIFY     TO TRUE                    06010000
060200                 SET DP020-MSG-WARNING TO TRUE                    06020000
060300                 PERFORM 5200-PROCESS-DELETE                      06030045
060400             ELSE                                                 06040000
060500                 MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER         06050000
060600                 SET DP020-MSG-WARNING TO TRUE                    06060000
060700             END-IF                                               06070000
060800                                                                  06080000
060900*--------ADD PRINTER CLUSTER - PF13                               06090050
061000         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              06100000
061100             MOVE ASC-INT-APPL-FORMAT-IND                         06110000
061200                                      TO ASC-INT-APPL-FORMAT-SAVE 06120000
061300             PERFORM 5000-PROCESS-ADD                             06130050
061400                                                                  06140000
061500*--------UPDATE PRINTER CLUSTER - F15                             06150050
061600         WHEN DP020-FK-LOCAL-FUNC-07 (DP020-SRC-AID)              06160050
061700             MOVE ASC-INT-APPL-FORMAT-IND                         06170045
061800                                      TO ASC-INT-APPL-FORMAT-SAVE 06180045
061900             IF ASC-ACTION-SW = 'UPD'                             06190099
062000                 PERFORM 9100-READ-SEL-QUEUE                      06200099
062100                 SET CN163-UPD (ASC-SEL-SUB) TO TRUE              06210099
062200                 MOVE ASC-IP-ADDR                                 06220099
062300                        TO CN163-PRTR-IP-ADDR (ASC-SEL-SUB)       06230099
062400                 MOVE ASC-OPER-SYS-RLSE-CDE                       06240099
062500                        TO CN163-PRTR-OS-RLSE-CDE (ASC-SEL-SUB)   06250099
062600                 MOVE ASC-DATA-XFER-MODE-ID                       06260099
062700                        TO CN163-PRTR-DAT-XFER-MODE (ASC-SEL-SUB) 06270099
062800                 MOVE ASC-XMIT-INTRFC-CDE                         06280099
062900                        TO CN163-PRTR-XMIT-INTFC-CDE(ASC-SEL-SUB) 06290099
063000                 PERFORM 9200-REWRITE-SEL-QUEUE                   06300099
063100             END-IF                                               06310099
063200             PERFORM 5100-PROCESS-UPDATE                          06320045
063300                                                                  06330045
063400*--------DELETE PRINTER CLUSTER - F16 -- NEED TO GET CONFIRMATION 06340050
063500         WHEN DP020-FK-LOCAL-FUNC-06 (DP020-SRC-AID)              06350045
063600             SET ASC-NEED-VERIFICATION TO TRUE                    06360045
063700             MOVE PC-TSYMSG-00354 TO DP020-MSG-NUMBER             06370055
063800             SET DP020-MSG-INFORMATIONAL TO TRUE                  06380045
063900             MOVE ASC-INT-APPL-FORMAT-IND                         06390045
064000                                      TO ASC-INT-APPL-FORMAT-SAVE 06400045
064100             IF ASC-ACTION-SW = 'DEL'                             06410099
064200                 PERFORM 9100-READ-SEL-QUEUE                      06420099
064300                 SET CN163-DEL (ASC-SEL-SUB) TO TRUE              06430099
064400                 PERFORM 9200-REWRITE-SEL-QUEUE                   06440099
064500             END-IF                                               06450099
064600                                                                  06460045
064700*--------PRINTER TYPE LIST - F17                                  06470000
064800         WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              06480000
064900             CONTINUE                                             06490000
065000                                                                  06500000
065100*--------STOCK TYPE LIST - F23                                    06510000
065200         WHEN DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID)              06520000
065300             CONTINUE                                             06530000
065400                                                                  06540000
065500*--------CLUSTER LIST - F24                                       06550000
065600         WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)              06560000
065700             CONTINUE                                             06570000
065800                                                                  06580000
065900         WHEN OTHER                                               06590000
066000             SET DP013-NO-ROLLBACK                                06600000
066100                 DP013-XCTL-DISPLAY-RESTART                       06610000
066200                 DP013-CICS-ABEND                                 06620000
066300                 ASC-UN-VERIFY     TO TRUE                        06630000
066400             MOVE '2000-PROCESS-PANEL' TO DP013-PARAGRAPH         06640012
066500             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      06650000
066600                                   TO DP013-MESSAGE-TEXT (1)      06660000
066700             PERFORM DP013-0000-PROCESS-ABEND                     06670000
066800     END-EVALUATE.                                                06680000
066900                                                                  06690000
067000**************************************************************    06700001
067100 2110-GET-NEXT-MESSAGE.                                           06710000
067200     ADD +1 TO ASC-SEL-SUB.                                       06720012
067300                                                                  06730099
067400*LMM                                                              06740099
067500     SET ASC-UPDATE-TSQ TO TRUE.                                  06750099
067600*                                                                 06760099
067700     IF  ASC-SEL-SUB > CN163-MAX-ITEMS                            06770012
067800         ADD +1                    TO ASC-SEL-ITEM                06780000
067900         MOVE +1                   TO ASC-SEL-SUB                 06790000
068000     END-IF.                                                      06800000
068100                                                                  06810099
068200     IF  ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                06820000
068300         PERFORM 9100-READ-SEL-QUEUE                              06830000
068400         IF  CN163-ITEM (ASC-SEL-SUB) > ZERO                      06840099
068500             MOVE CN163-CLUSTR-NBR    (ASC-SEL-SUB)               06850099
068600                                   TO ASC-PRTR-CLUSTR-NBR         06860099
068700             MOVE CN163-PRTR-IP-ADDR  (ASC-SEL-SUB)               06870099
068800                                   TO ASC-IP-ADDR                 06880099
068900             MOVE CN163-PRTR-OS-RLSE-CDE (ASC-SEL-SUB)            06890099
069000                                   TO ASC-OPER-SYS-RLSE-CDE       06900099
069100             MOVE CN163-PRTR-DAT-XFER-MODE (ASC-SEL-SUB)          06910099
069200                                   TO ASC-DATA-XFER-MODE-ID       06920099
069300             MOVE CN163-PRTR-XMIT-INTFC-CDE (ASC-SEL-SUB)         06930099
069400                                   TO ASC-XMIT-INTRFC-CDE         06940099
069500                                                                  06950099
069600             SET CN163-INQ (ASC-SEL-SUB) TO TRUE                  06960099
069700             PERFORM 9200-REWRITE-SEL-QUEUE                       06970099
069800         ELSE                                                     06980000
069900             SUBTRACT +1 FROM ASC-SEL-SUB                         06990000
070000             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            07000000
070100             SET DP020-MSG-INFORMATIONAL TO TRUE                  07010001
070200         END-IF                                                   07020000
070300     ELSE                                                         07030000
070400         SUBTRACT +1 FROM ASC-SEL-ITEM                            07040000
070500         MOVE CN163-MAX-ITEMS      TO ASC-SEL-SUB                 07050099
070600         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            07060000
070700         SET DP020-MSG-INFORMATIONAL  TO TRUE                     07070001
070800     END-IF.                                                      07080000
070900                                                                  07090001
071000******************************************************************07100000
071100** GET THE MESSAGE NUMBER (KEY) OF THE PREVIOUS SELECTED        **07110000
071200** OBJECT FROM THE SELECTED-ITEMS TEMP. STORAGE QUEUE.          **07120000
071300******************************************************************07130000
071400 2120-GET-PREV-MESSAGE.                                           07140000
071500     SUBTRACT +1 FROM ASC-SEL-SUB.                                07150000
071600*                                                                 07160001
071700     IF  ASC-SEL-SUB < +1                                         07170000
071800         SUBTRACT +1 FROM ASC-SEL-ITEM                            07180000
071900         MOVE CN163-MAX-ITEMS      TO ASC-SEL-SUB                 07190099
072000     END-IF.                                                      07200000
072100*                                                                 07210000
072200     IF  ASC-SEL-ITEM > ZERO                                      07220000
072300         PERFORM 9100-READ-SEL-QUEUE                              07230000
072400         IF  CN163-ITEM (ASC-SEL-SUB) > ZERO                      07240099
072500             MOVE CN163-CLUSTR-NBR    (ASC-SEL-SUB)               07250099
072600                                   TO ASC-PRTR-CLUSTR-NBR         07260099
072700             MOVE CN163-PRTR-IP-ADDR  (ASC-SEL-SUB)               07270099
072800                                   TO ASC-IP-ADDR                 07280099
072900             MOVE CN163-PRTR-OS-RLSE-CDE (ASC-SEL-SUB)            07290099
073000                                   TO ASC-OPER-SYS-RLSE-CDE       07300099
073100             MOVE CN163-PRTR-DAT-XFER-MODE (ASC-SEL-SUB)          07310099
073200                                   TO ASC-DATA-XFER-MODE-ID       07320099
073300             MOVE CN163-PRTR-XMIT-INTFC-CDE (ASC-SEL-SUB)         07330099
073400                                   TO ASC-XMIT-INTRFC-CDE         07340099
073500         END-IF                                                   07350099
073600                                                                  07360099
073700         SET CN163-INQ (ASC-SEL-SUB) TO TRUE                      07370099
073800         PERFORM 9200-REWRITE-SEL-QUEUE                           07380099
073900     ELSE                                                         07390099
074000         MOVE +1                     TO ASC-SEL-ITEM              07400099
074100                                        ASC-SEL-SUB               07410099
074200         MOVE PC-TSYMSG-00069  TO DP020-MSG-NUMBER                07420099
074300         SET DP020-MSG-INFORMATIONAL TO TRUE                      07430099
074400     END-IF.                                                      07440099
074500                                                                  07450000
074600*----------------------------------------------------------------*07460000
074700* MOVE DATA ENTERED ON THE SCREEN INTO THEIR RESPECTIVE FIELDS   *07470000
074800* IN THE APPLICATION-SPECIFIC COMMAREA.  ALL EDITS ARE DONE IN   *07480000
074900* THE APPLICATION-SPECIFIC COMMAREA, NOT ON THE SCREEN.          *07490012
075000* THIS PARAGRAPH DOES NOT USE TEMPORARY VARIABLES.               *07500000
075100*----------------------------------------------------------------*07510000
075200 2200-MOVE-SCREEN-TO-COMMAREA.                                    07520000
075300     IF  APCLNBRL > ZERO                                          07530000
075400         MOVE APCLNBRI             TO ASC-PRTR-CLUSTR-NBR         07540000
075500     ELSE                                                         07550000
075600         IF  APCLNBRF = DP015-ERASE-EOF                           07560000
075700             MOVE ZERO             TO ASC-PRTR-CLUSTR-NBR         07570000
075800         END-IF                                                   07580000
075900     END-IF.                                                      07590000
076000                                                                  07600099
076100     IF  AIPADDR1L > ZERO                                         07610099
076200         MOVE AIPADDR1I             TO ASC-IP-ADDR1               07620099
076300         MOVE PC-PERIOD             TO ASC-PER1                   07630099
076400     ELSE                                                         07640000
076500         IF  AIPADDR1F = DP015-ERASE-EOF                          07650099
076600             MOVE SPACE            TO ASC-IP-ADDR1                07660099
076700             MOVE SPACE            TO ASC-PER1                    07670099
076800         END-IF                                                   07680000
076900     END-IF.                                                      07690000
077000                                                                  07700099
077100     IF  AIPADDR2L > ZERO                                         07710099
077200         MOVE AIPADDR2I             TO ASC-IP-ADDR2               07720099
077300         MOVE PC-PERIOD             TO ASC-PER2                   07730099
077400     ELSE                                                         07740099
077500         IF  AIPADDR2F = DP015-ERASE-EOF                          07750099
077600             MOVE SPACE            TO ASC-IP-ADDR2                07760099
077700             MOVE SPACE            TO ASC-PER2                    07770099
077800         END-IF                                                   07780099
077900     END-IF.                                                      07790099
078000                                                                  07800099
078100     IF  AIPADDR3L > ZERO                                         07810099
078200         MOVE AIPADDR3I             TO ASC-IP-ADDR3               07820099
078300         MOVE PC-PERIOD             TO ASC-PER3                   07830099
078400     ELSE                                                         07840099
078500         IF  AIPADDR3F = DP015-ERASE-EOF                          07850099
078600             MOVE SPACE            TO ASC-IP-ADDR3                07860099
078700             MOVE SPACE            TO ASC-PER3                    07870099
078800         END-IF                                                   07880099
078900     END-IF.                                                      07890099
079000                                                                  07900099
079100     IF  AIPADDR4L > ZERO                                         07910099
079200         MOVE AIPADDR4I             TO ASC-IP-ADDR4               07920099
079300     ELSE                                                         07930099
079400         IF  AIPADDR4F = DP015-ERASE-EOF                          07940099
079500             MOVE SPACE            TO ASC-IP-ADDR4                07950099
079600         END-IF                                                   07960099
079700     END-IF.                                                      07970099
079800                                                                  07980099
079900     IF  ARLSCDEL > ZERO                                          07990099
080000         MOVE ARLSCDEI             TO ASC-OPER-SYS-RLSE-CDE       08000012
080100     ELSE                                                         08010000
080200         IF  ARLSCDEF = DP015-ERASE-EOF                           08020012
080300             MOVE SPACE            TO ASC-OPER-SYS-RLSE-CDE       08030012
080400         END-IF                                                   08040000
080500     END-IF.                                                      08050012
080600     IF  AXFRMDEL > ZERO                                          08060012
080700         MOVE AXFRMDEI             TO ASC-DATA-XFER-MODE-ID       08070012
080800     ELSE                                                         08080012
080900         IF  AXFRMDEF = DP015-ERASE-EOF                           08090012
081000             MOVE SPACE            TO ASC-DATA-XFER-MODE-ID       08100012
081100         END-IF                                                   08110012
081200     END-IF.                                                      08120012
081300     IF  AINTCDEL > ZERO                                          08130012
081400         MOVE AINTCDEI             TO ASC-XMIT-INTRFC-CDE         08140012
081500     ELSE                                                         08150012
081600         IF  AINTCDEF = DP015-ERASE-EOF                           08160012
081700             MOVE SPACE            TO ASC-XMIT-INTRFC-CDE         08170012
081800         END-IF                                                   08180012
081900     END-IF.                                                      08190012
082000                                                                  08200012
082100*----------------------------------------------------------------*08210000
082200* PERFORM EDITS ON EACH FIELD ENTERED BY THE USER.  IF AN ERROR  *08220000
082300* IS FOUND, THE CURSOR IS POSITIONED AT THAT FIELD AND AN        *08230000
082400* APPROPRIATE ERROR MESSAGE IS DISPLAYED.                        *08240000
082500*----------------------------------------------------------------*08250000
082600 3000-EDIT-DATA-IN-COMMAREA.                                      08260000
082700     PERFORM 3200-RESET-ATTRIBUTES.                               08270000
082800     PERFORM 3010-VALIDATE-OPER-UNT-ID.                           08280043
083900*LMM                                                              08390099
084000     IF ASC-PRTR-CLUSTR-NBR = SPACES                              08400099
084100         IF  DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)               08410099
084200             SET PS-ERROR                TO TRUE                  08420099
084300             SET DP020-MSG-FATAL         TO TRUE                  08430099
084400             MOVE PC-TSYMSG-00007        TO DP020-MSG-NUMBER      08440099
084500             MOVE DP015-UNP-ALP-BRT-OFF  TO APCLNBRA              08450099
084600             MOVE DP015-RED              TO APCLNBRC              08460099
084700             MOVE DP015-REVERSE          TO APCLNBRH              08470099
084800             MOVE -1                     TO APCLNBRL              08480099
084900             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  08490099
085000         END-IF                                                   08500099
085100     END-IF.                                                      08510099
085200                                                                  08520099
085300     IF ASC-PRTR-CLUSTR-NBR > SPACES                              08530099
085400         MOVE ASC-PRTR-CLUSTR-NBR      TO DP010I-UNEDITED-FIELD   08540099
085500         MOVE LENGTH OF ASC-PRTR-CLUSTR-NBR                       08550099
085600                                       TO DP010I-MAXIMUM-DIGITS   08560099
085700         MOVE ZERO                     TO DP010I-MAXIMUM-DECIMALS 08570099
085800         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  08580099
263455         CALL DP010I-NUMERIC-EDIT-ROUTINE                         08591099
263455              USING DP010I-NUMERIC-EDIT-AREA                      08592099
086000         IF  DP010I-ERROR-DETECTED                                08600099
086100             SET PS-ERROR                TO TRUE                  08610099
086200             SET DP020-MSG-FATAL         TO TRUE                  08620099
086300             MOVE PC-TSYMSG-00008        TO DP020-MSG-NUMBER      08630099
086400             MOVE DP015-UNP-ALP-BRT-OFF  TO APCLNBRA              08640099
086500             MOVE DP015-RED              TO APCLNBRC              08650099
086600             MOVE DP015-REVERSE          TO APCLNBRH              08660099
086700             MOVE -1                     TO APCLNBRL              08670099
086800             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  08680099
086900         ELSE                                                     08690099
087000             MOVE DP010I-NUMERIC-FIELD                            08700099
087100               TO ASC-PRTR-CLUSTR-NBR-N                           08710099
087200     END-IF                                                       08720099
087300                                                                  08730099
087400     IF  ASC-IP-ADDR1 = SPACES                                    08740099
087500         IF  DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)               08750099
087600             SET PS-ERROR                TO TRUE                  08760099
087700             SET DP020-MSG-FATAL         TO TRUE                  08770099
087800             MOVE PC-TSYMSG-00007        TO DP020-MSG-NUMBER      08780099
087900             MOVE DP015-UNP-ALP-BRT-OFF  TO AIPADDR1A             08790099
088000             MOVE DP015-RED              TO AIPADDR1C             08800099
088100             MOVE DP015-REVERSE          TO AIPADDR1H             08810099
088200             MOVE -1                     TO AIPADDR1L             08820099
088300             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  08830099
088400         END-IF                                                   08840099
088500     END-IF.                                                      08850099
088600                                                                  08860099
088700     IF ASC-IP-ADDR1 > SPACES                                     08870099
088800         MOVE ASC-IP-ADDR1             TO DP010I-UNEDITED-FIELD   08880099
088900         MOVE LENGTH OF ASC-IP-ADDR1                              08890099
089000                                       TO DP010I-MAXIMUM-DIGITS   08900099
089100         MOVE ZERO                     TO DP010I-MAXIMUM-DECIMALS 08910099
089200         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  08920099
263455         CALL DP010I-NUMERIC-EDIT-ROUTINE                         08931099
263455              USING DP010I-NUMERIC-EDIT-AREA                      08932099
089400         IF  DP010I-ERROR-DETECTED                                08940099
089500             SET PS-ERROR                TO TRUE                  08950099
089600             SET DP020-MSG-FATAL         TO TRUE                  08960099
089700             MOVE PC-TSYMSG-00008        TO DP020-MSG-NUMBER      08970099
089800             MOVE DP015-UNP-ALP-BRT-OFF  TO AIPADDR1A             08980099
089900             MOVE DP015-RED              TO AIPADDR1C             08990099
090000             MOVE DP015-REVERSE          TO AIPADDR1H             09000099
090100             MOVE -1                     TO AIPADDR1L             09010099
090200             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  09020099
090300         ELSE                                                     09030099
090400             MOVE DP010I-NUMERIC-FIELD                            09040099
090500             TO ASC-IP-ADDR1-N                                    09050099
090600         END-IF                                                   09060099
090700     END-IF                                                       09070099
090800                                                                  09080099
090900     IF  ASC-IP-ADDR2 = SPACES                                    09090099
091000         IF  DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)               09100099
091100             SET PS-ERROR                TO TRUE                  09110099
091200             SET DP020-MSG-FATAL         TO TRUE                  09120099
091300             MOVE PC-TSYMSG-00007        TO DP020-MSG-NUMBER      09130099
091400             MOVE DP015-UNP-ALP-BRT-OFF  TO AIPADDR2A             09140099
091500             MOVE DP015-RED              TO AIPADDR2C             09150099
091600             MOVE DP015-REVERSE          TO AIPADDR2H             09160099
091700             MOVE -1                     TO AIPADDR2L             09170099
091800             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  09180099
091900         END-IF                                                   09190099
092000     END-IF.                                                      09200099
092100                                                                  09210099
092200     IF ASC-IP-ADDR2 > SPACES                                     09220099
092300         MOVE ASC-IP-ADDR2             TO DP010I-UNEDITED-FIELD   09230099
092400         MOVE LENGTH OF ASC-IP-ADDR2                              09240099
092500                                       TO DP010I-MAXIMUM-DIGITS   09250099
092600         MOVE ZERO                     TO DP010I-MAXIMUM-DECIMALS 09260099
092700         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  09270099
263455         CALL DP010I-NUMERIC-EDIT-ROUTINE                         09281099
263455              USING DP010I-NUMERIC-EDIT-AREA                      09282099
092900         IF  DP010I-ERROR-DETECTED                                09290099
093000             SET PS-ERROR                TO TRUE                  09300099
093100             SET DP020-MSG-FATAL         TO TRUE                  09310099
093200             MOVE PC-TSYMSG-00008        TO DP020-MSG-NUMBER      09320099
093300             MOVE DP015-UNP-ALP-BRT-OFF  TO AIPADDR2A             09330099
093400             MOVE DP015-RED              TO AIPADDR2C             09340099
093500             MOVE DP015-REVERSE          TO AIPADDR2H             09350099
093600             MOVE -1                     TO AIPADDR2L             09360099
093700             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  09370099
093800         ELSE                                                     09380099
093900             MOVE DP010I-NUMERIC-FIELD                            09390099
094000             TO ASC-IP-ADDR2-N                                    09400099
094100         END-IF                                                   09410099
094200     END-IF                                                       09420099
094300                                                                  09430099
094400     IF  ASC-IP-ADDR3 = SPACES                                    09440099
094500         IF  DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)               09450099
094600             SET PS-ERROR                TO TRUE                  09460099
094700             SET DP020-MSG-FATAL         TO TRUE                  09470099
094800             MOVE PC-TSYMSG-00007        TO DP020-MSG-NUMBER      09480099
094900             MOVE DP015-UNP-ALP-BRT-OFF  TO AIPADDR3A             09490099
095000             MOVE DP015-RED              TO AIPADDR3C             09500099
095100             MOVE DP015-REVERSE          TO AIPADDR3H             09510099
095200             MOVE -1                     TO AIPADDR3L             09520099
095300             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  09530099
095400         END-IF                                                   09540099
095500     END-IF.                                                      09550099
095600                                                                  09560099
095700     IF ASC-IP-ADDR3 > SPACES                                     09570099
095800         MOVE ASC-IP-ADDR3             TO DP010I-UNEDITED-FIELD   09580099
095900         MOVE LENGTH OF ASC-IP-ADDR3                              09590099
096000                                       TO DP010I-MAXIMUM-DIGITS   09600099
096100         MOVE ZERO                     TO DP010I-MAXIMUM-DECIMALS 09610099
096200         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  09620099
263455         CALL DP010I-NUMERIC-EDIT-ROUTINE                         09631099
263455              USING DP010I-NUMERIC-EDIT-AREA                      09632099
096400         IF  DP010I-ERROR-DETECTED                                09640099
096500             SET PS-ERROR                TO TRUE                  09650099
096600             SET DP020-MSG-FATAL         TO TRUE                  09660099
096700             MOVE PC-TSYMSG-00008        TO DP020-MSG-NUMBER      09670099
096800             MOVE DP015-UNP-ALP-BRT-OFF  TO AIPADDR3A             09680099
096900             MOVE DP015-RED              TO AIPADDR3C             09690099
097000             MOVE DP015-REVERSE          TO AIPADDR3H             09700099
097100             MOVE -1                     TO AIPADDR3L             09710099
097200             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  09720099
097300         ELSE                                                     09730099
097400             MOVE DP010I-NUMERIC-FIELD                            09740099
097500             TO ASC-IP-ADDR3-N                                    09750099
097600         END-IF                                                   09760099
097700     END-IF                                                       09770099
097800                                                                  09780099
097900     IF  ASC-IP-ADDR4 = SPACES                                    09790099
098000         IF  DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)               09800099
098100             SET PS-ERROR                TO TRUE                  09810099
098200             SET DP020-MSG-FATAL         TO TRUE                  09820099
098300             MOVE PC-TSYMSG-00007        TO DP020-MSG-NUMBER      09830099
098400             MOVE DP015-UNP-ALP-BRT-OFF  TO AIPADDR4A             09840099
098500             MOVE DP015-RED              TO AIPADDR4C             09850099
098600             MOVE DP015-REVERSE          TO AIPADDR4H             09860099
098700             MOVE -1                     TO AIPADDR4L             09870099
098800             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  09880099
098900         END-IF                                                   09890099
099000     END-IF.                                                      09900099
099100                                                                  09910099
099200     IF ASC-IP-ADDR4 > SPACES                                     09920099
099300         MOVE ASC-IP-ADDR4             TO DP010I-UNEDITED-FIELD   09930099
099400         MOVE LENGTH OF ASC-IP-ADDR4                              09940099
099500                                       TO DP010I-MAXIMUM-DIGITS   09950099
099600         MOVE ZERO                     TO DP010I-MAXIMUM-DECIMALS 09960099
099700         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  09970099
263455         CALL DP010I-NUMERIC-EDIT-ROUTINE                         09981099
263455              USING DP010I-NUMERIC-EDIT-AREA                      09982099
099900         IF  DP010I-ERROR-DETECTED                                09990099
100000             SET PS-ERROR                TO TRUE                  10000099
100100             SET DP020-MSG-FATAL         TO TRUE                  10010099
100200             MOVE PC-TSYMSG-00008        TO DP020-MSG-NUMBER      10020099
100300             MOVE DP015-UNP-ALP-BRT-OFF  TO AIPADDR4A             10030099
100400             MOVE DP015-RED              TO AIPADDR4C             10040099
100500             MOVE DP015-REVERSE          TO AIPADDR4H             10050099
100600             MOVE -1                     TO AIPADDR4L             10060099
100700             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  10070099
100800         ELSE                                                     10080099
100900             MOVE DP010I-NUMERIC-FIELD                            10090099
101000             TO ASC-IP-ADDR4-N                                    10100099
101100         END-IF                                                   10110099
101200     END-IF                                                       10120099
101300*                                                                 10130099
101400*LMM IF  ASC-OPER-SYS-RLSE-CDE = SPACES                           10140099
101500*        IF  DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)               10150099
101600*            SET PS-ERROR                TO TRUE                  10160099
101700*            SET DP020-MSG-FATAL         TO TRUE                  10170099
101800*            MOVE PC-TSYMSG-00007        TO DP020-MSG-NUMBER      10180099
101900*            MOVE DP015-UNP-ALP-BRT-OFF  TO ARLSCDEA              10190099
102000*            MOVE DP015-RED              TO ARLSCDEC              10200099
102100*            MOVE DP015-REVERSE          TO ARLSCDEH              10210099
102200*            MOVE -1                     TO ARLSCDEL              10220099
102300*            SET DP030-SET-CURSOR-APPL-1 TO TRUE                  10230099
102400*        END-IF                                                   10240099
102500*                                                                 10250099
102600*    IF  ASC-DATA-XFER-MODE-ID = SPACES                           10260099
102700*        IF  DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)               10270099
102800*            SET PS-ERROR                TO TRUE                  10280099
102900*            SET DP020-MSG-FATAL         TO TRUE                  10290099
103000*            MOVE PC-TSYMSG-00007        TO DP020-MSG-NUMBER      10300099
103100*            MOVE DP015-UNP-ALP-BRT-OFF  TO AXFRMDEA              10310099
103200*            MOVE DP015-RED              TO AXFRMDEC              10320099
103300*            MOVE DP015-REVERSE          TO AXFRMDEH              10330099
103400*            MOVE -1                     TO AXFRMDEL              10340099
103500*            SET DP030-SET-CURSOR-APPL-1 TO TRUE                  10350099
103600*        END-IF                                                   10360099
103700*    END-IF.                                                      10370099
103800*                                                                 10380099
103900     IF  ASC-XMIT-INTRFC-CDE = SPACES                             10390099
104000         IF  DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)               10400099
104100             SET PS-ERROR                TO TRUE                  10410099
104200             SET DP020-MSG-FATAL         TO TRUE                  10420099
104300             MOVE PC-TSYMSG-00007        TO DP020-MSG-NUMBER      10430099
104400             MOVE DP015-UNP-ALP-BRT-OFF  TO AINTCDEA              10440099
104500             MOVE DP015-RED              TO AINTCDEC              10450099
104600             MOVE DP015-REVERSE          TO AINTCDEH              10460099
104700             MOVE -1                     TO AINTCDEL              10470099
104800             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  10480099
104900         END-IF                                                   10490099
105000     END-IF.                                                      10500099
105100******************************************************************10510099
105200*LMM                                                              10520099
105300*VALIDATE TRANSMIT INTERFACE CODE - 'F' OR 'S' ONLY.              10530099
105400     IF ASC-XMIT-INTRFC-CDE  > SPACES                             10540099
105500        EVALUATE TRUE                                             10550099
105600           WHEN ASC-XMIT-INTRFC-CDE  = 'F'                        10560099
105700              SET ASC-SELECT-FTP       TO TRUE                    10570099
105800              PERFORM 9300-PROCESS-INTERFACE-CODE                 10580099
105900           WHEN ASC-XMIT-INTRFC-CDE  = 'S'                        10590099
106000              SET ASC-SELECT-SOCKETS   TO TRUE                    10600099
106100              PERFORM 9300-PROCESS-INTERFACE-CODE                 10610099
106200           WHEN OTHER                                             10620099
106300              SET PS-ERROR                                        10630099
106400                  DP020-MSG-FATAL         TO TRUE                 10640099
106500              MOVE PC-TSYMSG-00005        TO DP020-MSG-NUMBER     10650099
106600              MOVE DP015-UNP-ALP-BRT-OFF  TO AINTCDEA             10660099
106700              MOVE DP015-RED              TO AINTCDEC             10670099
106800              MOVE DP015-REVERSE          TO AINTCDEH             10680099
106900              MOVE -1                     TO AINTCDEL             10690099
107000              SET DP030-SET-CURSOR-APPL-1 TO TRUE                 10700099
107100        END-EVALUATE                                              10710099
107200     END-IF.                                                      10720099
107300                                                                  10730099
109810                                                                  10981099
109820****************************************************************  10982099
109830*    VALIDATE OPER UNIT ID.                                    *  10983099
109840*                                                              *  10984099
109850****************************************************************  10985099
109860                                                                  10986099
109861 3010-VALIDATE-OPER-UNT-ID.                                       10986199
109880                                                                  10988099
109890     INITIALIZE XL071-COMMAREA.                                   10989099
109891     MOVE  ASC-PRTR-OPER-UNT-ID TO XL071-LOCATION-NUMBER.         10989199
109892                                                                  10989299
109893     CALL XL071-LOCATION-MODULE USING                             10989399
109894                                DFHEIBLK                          10989499
109895                                XL071-COMMAREA                    10989599
109896                                XL071-COMMAREA-REC.               10989699
109897                                                                  10989799
109898     EVALUATE TRUE                                                10989899
109899         WHEN XL071-NO-ERRORS                                     10989999
109900         WHEN XL071-DC-ASGMT-NOT-FND                              10990099
109903              CONTINUE                                            10990399
109904                                                                  10990499
109905         WHEN XL071-LOC-NOT-FOUND                                 10990599
109906              SET PS-ERROR                                        10990699
109907                  DP020-MSG-FATAL         TO TRUE                 10990799
109908              MOVE PC-TSYMSG-00005        TO DP020-MSG-NUMBER     10990899
109909              MOVE DP015-UNP-ALP-BRT-OFF  TO AOPERUNA             10990999
109910              MOVE DP015-RED              TO AOPERUNC             10991099
109911              MOVE DP015-REVERSE          TO AOPERUNH             10991199
109912              MOVE -1                     TO AOPERUNL             10991299
109913              SET DP030-SET-CURSOR-APPL-1 TO TRUE                 10991399
109917                                                                  10991799
109918         WHEN OTHER                                               10991899
109919              MOVE 'VALIDATE-OPER-UNT-ID' TO DP013-PARAGRAPH      10991999
109920              STRING 'SELECT STORE NUMBER - '                     10992099
109921                      XL071-LOCATION-NUMBER                       10992199
109922                     ' - BAD RETURN CODE FROM XLKUT071 - '        10992299
109923                      XL071-RETURN-CODE                           10992399
109924                      DELIMITED BY SIZE                           10992499
109925                      INTO DP013-MESSAGE-TEXT (1)                 10992599
109926              STRING 'SQLCODE - '                                 10992699
109927                      XL071-SQLCODE                               10992799
109928                     ' - '                                        10992899
109929                      XL071-DB2-TABLE                             10992999
109930                      DELIMITED BY SIZE                           10993099
109931                      INTO DP013-MESSAGE-TEXT (2)                 10993199
109932              MOVE XL071-SQLCA     TO DP013-SQLCA                 10993299
109933              MOVE XL071-DB2-TABLE TO DP013-DB2-TABLE-NAME (1)    10993399
109945              MOVE XL071-SQLCODE TO SQLCODE                       10994599
109948              SET DP013-DB2-ABEND                                 10994899
109949                  DP013-XCTL-DISPLAY-RESTART TO TRUE              10994999
109950              PERFORM DP013-0000-PROCESS-ABEND                    10995099
109951                                                                  10995199
109952     END-EVALUATE.                                                10995299
109953                                                                  10995399
109960*                                                                 10996099
110000*                                                                 11000099
110100 3020-GET-DATA-XFER-MODE.                                         11010099
110200        EXEC SQL                                                  11020099
110300        SELECT   FUNC_TXT                                         11030099
110400          INTO :KRPRPM-FUNC-TXT                                   11040099
110500          FROM  TKRPRPM                                           11050099
110600        WHERE  LOC_ID          = :ASC-PRTR-OPER-UNT-ID            11060099
110700          AND  INTFC_SYS_CDE   = 'KHL'                            11070099
110800          AND SYS_PRC_FUNC_CDE = 'XFRCDE'                         11080099
110900        END-EXEC                                                  11090099
111000                                                                  11100099
111100        EVALUATE TRUE                                             11110099
111200            WHEN SQLCODE = +0                                     11120099
111300                 MOVE KRPRPM-FUNC-TXT TO ASC-DATA-XFER-MODE-ID    11130099
111400            WHEN SQLCODE = +100                                   11140099
111500                 MOVE PC-XFERCDE TO ASC-DATA-XFER-MODE-ID         11150099
111600            WHEN SQLWARN0 NOT = SPACES                            11160099
111700            WHEN SQLCODE < +0                                     11170099
111800            WHEN SQLCODE > +0                                     11180099
111900                MOVE 'GET DATA XFER MODE' TO DP013-PARAGRAPH      11190099
112000                MOVE 'SELECT FUNC TXT' TO DP013-MESSAGE-TEXT (1)  11200099
112100                MOVE SQLCA      TO DP013-SQLCA                    11210099
112200                MOVE 'TKRPRPM'  TO DP013-DB2-TABLE-NAME (1)       11220099
112300                SET DP013-DB2-ABEND TO TRUE                       11230099
112400                SET DP013-XCTL-DISPLAY-RESTART TO TRUE            11240099
112500                PERFORM DP013-0000-PROCESS-ABEND                  11250099
112600        END-EVALUATE.                                             11260099
112700*                                                                 11270099
112800*                                                                 11280099
112900******************************************************************11290099
113000 3115-CLEAR-FIELDS.                                               11300099
113100     MOVE SPACES TO AOPERUNO                                      11310099
113200                    AOPERDSO                                      11320099
113300                    AFCLTYO                                       11330099
113400                    AIPADDR1O                                     11340099
113500                    AIPADDR2O                                     11350099
113600                    AIPADDR3O                                     11360099
113700                    AIPADDR4O                                     11370099
113800                    ARLSCDEO                                      11380099
113900                    AXFRMDEO                                      11390099
114000                    AINTCDEO.                                     11400099
114100     MOVE ZEROES TO APCLNBRO.                                     11410099
114200                                                                  11420099
114300*----------------------------------------------------------------*11430099
114400* MOVE THE DEFAULT ATTRIBUTE VALUES TO THE ENTERABLE FIELDS ON MAP11440099
114500*----------------------------------------------------------------*11450099
114600 3200-RESET-ATTRIBUTES.                                           11460099
114700     MOVE DP015-UNP-ALP-NOR-OFF    TO APCLNBRA                    11470099
114800                                      AOPERUNA                    11480099
114900                                      AOPERDSA                    11490099
115000                                      AFCLTYA                     11500099
115100                                      AIPADDR1A                   11510099
115200                                      AIPADDR2A                   11520099
115300                                      AIPADDR3A                   11530099
115400                                      AIPADDR4A                   11540099
115500                                      ARLSCDEA                    11550099
115600                                      AXFRMDEA                    11560099
115700                                      AINTCDEA.                   11570099
115800     MOVE DP015-GREEN              TO APCLNBRC                    11580099
115900                                      AOPERUNC                    11590099
116000                                      AOPERDSC                    11600099
116100                                      AFCLTYC                     11610099
116200                                      AIPADDR1C                   11620099
116300                                      AIPADDR2C                   11630099
116400                                      AIPADDR3C                   11640099
116500                                      AIPADDR4C                   11650099
116600                                      ARLSCDEC                    11660099
116700                                      AXFRMDEC                    11670099
116800                                      AINTCDEC.                   11680099
116900     MOVE DP015-UNDERLINE          TO APCLNBRH                    11690099
117000*LMM                                  AOPERUNH                    11700099
117100*LMM                                  AOPERDSH                    11710099
117200*LMM                                  AFCLTYH                     11720099
117300                                      AIPADDR1H                   11730099
117400                                      AIPADDR2H                   11740099
117500                                      AIPADDR3H                   11750099
117600                                      AIPADDR4H                   11760099
117700                                      ARLSCDEH                    11770099
117800                                      AXFRMDEH                    11780099
117900                                      AINTCDEH.                   11790099
118000                                                                  11800099
118100     MOVE -1                         TO AIPADDR1L                 11810099
118200     SET DP030-SET-CURSOR-APPL-1     TO TRUE                      11820099
118300     MOVE DP015-UNP-ALP-NOR-OFF      TO AIPADDR1A                 11830099
118400     MOVE DP015-GREEN                TO AIPADDR1C                 11840099
118500     MOVE DP015-UNDERLINE            TO AIPADDR1H                 11850099
118600     MOVE DP015-UNP-ALP-NOR-OFF      TO AIPADDR2A                 11860099
118700     MOVE DP015-UNP-ALP-NOR-OFF      TO AIPADDR2A                 11870099
118800     MOVE DP015-GREEN                TO AIPADDR3C                 11880099
118900     MOVE DP015-UNDERLINE            TO AIPADDR3H                 11890099
119000     MOVE DP015-GREEN                TO AIPADDR4C                 11900099
119100     MOVE DP015-UNDERLINE            TO AIPADDR4H                 11910099
119200     MOVE DP015-ASK-NOR-OFF          TO AOPERUNA                  11920099
119300     MOVE DP015-BLUE                 TO AOPERUNC                  11930099
119400     MOVE DP015-ASK-NOR-OFF          TO AOPERDSA                  11940099
119500     MOVE DP015-BLUE                 TO AOPERDSC                  11950099
119600     MOVE DP015-ASK-NOR-OFF          TO AFCLTYA                   11960099
119700     MOVE DP015-BLUE                 TO AFCLTYC                   11970099
119800     MOVE DP015-ASK-NOR-OFF          TO APCLNBRA                  11980099
119900     MOVE DP015-BLUE                 TO APCLNBRC.                 11990099
120000                                                                  12000099
120100*----------------------------------------------------------------*12010099
120200*    VALIDATE THE QUEUE WAS PASSED AND DISPLAY FOR THE FIRST     *12020099
120300*    ENTRY.                                                      *12030099
120400*----------------------------------------------------------------*12040099
120500 4000-BUILD-INITIAL-PANEL.                                        12050099
120600     SET DP030-SET-CURSOR-APPL-2  TO TRUE.                        12060099
120700     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        12070099
120800                                                                  12080099
120900*----------------------------------------------------------------*12090099
121000*    RESTORE THE DATA ON THE SCREEN FROM THE COMM AREA.          *12100099
121100*----------------------------------------------------------------*12110099
121200 4400-MOVE-COMMAREA-TO-SCREEN.                                    12120099
121300     MOVE ASC-PRTR-OPER-UNT-ID     TO AOPERUNO.                   12130099
121400     MOVE ASC-PRTR-FCLTY-NME       TO AOPERDSO.                   12140099
121500     MOVE ASC-PRTR-FCLTY-ID        TO AFCLTYO.                    12150099
121600     MOVE ASC-PRTR-CLUSTR-NBR      TO APCLNBRO.                   12160099
121700*LMM                                                              12170099
121800     EVALUATE TRUE                                                12180099
121900         WHEN DP020-FK-REFRESH(DP020-SRC-AID)                     12190099
122000              EVALUATE ASC-INT-APPL-FORMAT-IND                    12200099
122100                  WHEN PC-INTER-APPL-CRIT-SPEC-ADD                12210099
122200                  WHEN PC-INTER-APPL-LIST-ADD                     12220099
122300                       INITIALIZE ASC-PRTR-CLUSTR-NBR             12230099
122400                       MOVE ASC-PRTR-CLUSTR-NBR TO APCLNBRO       12240099
122500                       INITIALIZE ASC-IP-ADDR                     12250099
122600                       MOVE ASC-IP-ADDR1        TO AIPADDR1O      12260099
122700                       MOVE ASC-IP-ADDR2        TO AIPADDR2O      12270099
122800                       MOVE ASC-IP-ADDR3        TO AIPADDR3O      12280099
122900                       MOVE ASC-IP-ADDR4        TO AIPADDR4O      12290099
123000                       INITIALIZE ASC-XMIT-INTRFC-CDE             12300099
123100                       MOVE ASC-XMIT-INTRFC-CDE TO AINTCDEO       12310099
123200              END-EVALUATE                                        12320099
123300     END-EVALUATE                                                 12330099
123400                                                                  12340099
123500     IF  (DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)  OR              12350099
123600          DP020-SRC-AID = DP016-ENTER)                            12360099
123700             MOVE ASC-IP-ADDR1               TO AIPADDR1O         12370099
123800             MOVE ASC-PER1                   TO APER1O            12380099
123900             MOVE ASC-IP-ADDR2               TO AIPADDR2O         12390099
124000             MOVE ASC-PER2                   TO APER2O            12400099
124100             MOVE ASC-IP-ADDR3               TO AIPADDR3O         12410099
124200             MOVE ASC-PER3                   TO APER3O            12420099
124300             MOVE ASC-IP-ADDR4               TO AIPADDR4O         12430099
124400     END-IF                                                       12440099
124500                                                                  12450099
124600*LMM MOVE ASC-OPER-SYS-RLSE-CDE    TO ARLSCDEO.                   12460099
124700     MOVE PC-RLSE-CDE              TO ARLSCDEO.                   12470099
124800*LMM MOVE ASC-DATA-XFER-MODE-ID    TO AXFRMDEO.                   12480099
124900     PERFORM 3020-GET-DATA-XFER-MODE                              12490099
125000     MOVE ASC-DATA-XFER-MODE-ID    TO AXFRMDEO.                   12500099
125100                                                                  12510099
125200     MOVE ASC-XMIT-INTRFC-CDE      TO AINTCDEO.                   12520099
125300                                                                  12530099
125400     EVALUATE ASC-INT-APPL-FORMAT-IND                             12540099
125500         WHEN PC-INTER-APPL-CRIT-SPEC-ADD                         12550099
125600         IF  (DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)  OR          12560099
125700              DP020-SRC-AID = DP016-ENTER)                        12570099
125800                 MOVE ASC-IP-ADDR1               TO AIPADDR1O     12580099
125900                 MOVE PC-PERIOD                  TO APER1O        12590099
126000                 MOVE ASC-IP-ADDR2               TO AIPADDR2O     12600099
126100                 MOVE PC-PERIOD                  TO APER2O        12610099
126200                 MOVE ASC-IP-ADDR3               TO AIPADDR3O     12620099
126300                 MOVE PC-PERIOD                  TO APER3O        12630099
126400                 MOVE ASC-IP-ADDR4               TO AIPADDR4O     12640099
126500         END-IF                                                   12650099
126600             SET DP030-SET-CURSOR-APPL-1     TO TRUE              12660099
126700             MOVE PC-CURSOR                  TO APCLNBRL          12670099
126800             MOVE DP015-UNP-ALP-NOR-OFF      TO AIPADDR1A         12680099
126900             MOVE DP015-GREEN                TO AIPADDR1C         12690099
127000             MOVE DP015-UNDERLINE            TO AIPADDR1H         12700099
127100             MOVE DP015-UNP-ALP-NOR-OFF      TO AIPADDR2A         12710099
127200             MOVE DP015-GREEN                TO AIPADDR2C         12720099
127300             MOVE DP015-UNDERLINE            TO AIPADDR2H         12730099
127400             MOVE DP015-UNP-ALP-NOR-OFF      TO AIPADDR3A         12740099
127500             MOVE DP015-GREEN                TO AIPADDR3C         12750099
127600             MOVE DP015-UNDERLINE            TO AIPADDR3H         12760099
127700             MOVE DP015-UNP-ALP-NOR-OFF      TO AIPADDR4A         12770099
127800             MOVE DP015-GREEN                TO AIPADDR4C         12780099
127900             MOVE DP015-UNDERLINE            TO AIPADDR4H         12790099
128000             MOVE DP015-ASK-NOR-OFF          TO AOPERUNA          12800099
128100             MOVE DP015-BLUE                 TO AOPERUNC          12810099
128200             MOVE DP015-ASK-NOR-OFF          TO AOPERDSA          12820099
128300             MOVE DP015-BLUE                 TO AOPERDSC          12830099
128400             MOVE DP015-ASK-NOR-OFF          TO AFCLTYA           12840099
128500             MOVE DP015-BLUE                 TO AFCLTYC           12850099
128600*LMM                                                              12860099
128700             MOVE DP015-ASK-NOR-OFF          TO ARLSCDEA          12870099
128800             MOVE DP015-BLUE                 TO ARLSCDEC          12880099
128900             MOVE DP015-ASK-NOR-OFF          TO AXFRMDEA          12890099
129000             MOVE DP015-BLUE                 TO AXFRMDEC          12900099
129100             MOVE DP015-UNP-NUM-NOR-OFF      TO APCLNBRA          12910099
129200             MOVE DP015-GREEN                TO APCLNBRC          12920099
129300             MOVE DP015-UNDERLINE            TO APCLNBRH          12930099
129400                                                                  12940099
129500         WHEN PC-INTER-APPL-LIST-ADD                              12950099
129600         IF  (DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)  OR          12960099
129700              DP020-SRC-AID = DP016-ENTER)                        12970099
129800             MOVE ASC-IP-ADDR1               TO AIPADDR1O         12980099
129900             MOVE PC-PERIOD                  TO APER1O            12990099
130000             MOVE ASC-IP-ADDR2               TO AIPADDR2O         13000099
130100             MOVE PC-PERIOD                  TO APER2O            13010099
130200             MOVE ASC-IP-ADDR3               TO AIPADDR3O         13020099
130300             MOVE PC-PERIOD                  TO APER3O            13030099
130400             MOVE ASC-IP-ADDR4               TO AIPADDR4O         13040099
130500         END-IF                                                   13050099
130600             SET DP030-SET-CURSOR-APPL-1     TO TRUE              13060099
130700             MOVE PC-CURSOR                  TO APCLNBRL          13070099
130800             MOVE DP015-UNP-ALP-NOR-OFF      TO AIPADDR1A         13080099
130900             MOVE DP015-GREEN                TO AIPADDR1C         13090099
131000             MOVE DP015-UNDERLINE            TO AIPADDR1H         13100099
131100             MOVE DP015-UNP-ALP-NOR-OFF      TO AIPADDR2A         13110099
131200             MOVE DP015-GREEN                TO AIPADDR2C         13120099
131300             MOVE DP015-UNDERLINE            TO AIPADDR2H         13130099
131400             MOVE DP015-UNP-ALP-NOR-OFF      TO AIPADDR3A         13140099
131500             MOVE DP015-GREEN                TO AIPADDR3C         13150099
131600             MOVE DP015-UNDERLINE            TO AIPADDR3H         13160099
131700             MOVE DP015-UNP-ALP-NOR-OFF      TO AIPADDR4A         13170099
131800             MOVE DP015-GREEN                TO AIPADDR4C         13180099
131900             MOVE DP015-UNDERLINE            TO AIPADDR4H         13190099
132000             MOVE DP015-ASK-NOR-OFF          TO AOPERUNA          13200099
132100             MOVE DP015-BLUE                 TO AOPERUNC          13210099
132200             MOVE DP015-ASK-NOR-OFF          TO AOPERDSA          13220099
132300             MOVE DP015-BLUE                 TO AOPERDSC          13230099
132400             MOVE DP015-ASK-NOR-OFF          TO AFCLTYA           13240099
132500             MOVE DP015-BLUE                 TO AFCLTYC           13250099
132600*LMM                                                              13260099
132700             MOVE DP015-ASK-NOR-OFF          TO ARLSCDEA          13270099
132800             MOVE DP015-BLUE                 TO ARLSCDEC          13280099
132900             MOVE DP015-ASK-NOR-OFF          TO AXFRMDEA          13290099
133000             MOVE DP015-BLUE                 TO AXFRMDEC          13300099
133100             MOVE DP015-UNP-NUM-NOR-OFF      TO APCLNBRA          13310099
133200             MOVE DP015-GREEN                TO APCLNBRC          13320099
133300             MOVE DP015-UNDERLINE            TO APCLNBRH          13330099
133400                                                                  13340099
133500         WHEN PC-INTER-APPL-LIST-UPDATE                           13350099
133600             MOVE ASC-IP-ADDR1               TO AIPADDR1O         13360099
133700             MOVE ASC-PER1                   TO APER1O            13370099
133800             MOVE ASC-IP-ADDR2               TO AIPADDR2O         13380099
133900             MOVE ASC-PER2                   TO APER2O            13390099
134000             MOVE ASC-IP-ADDR3               TO AIPADDR3O         13400099
134100             MOVE ASC-PER3                   TO APER3O            13410099
134200             MOVE ASC-IP-ADDR4               TO AIPADDR4O         13420099
134300*LMM         MOVE ASC-OPER-SYS-RLSE-CDE      TO ARLSCDEO          13430099
134400             MOVE PC-RLSE-CDE                TO ARLSCDEO          13440099
134500             MOVE ASC-DATA-XFER-MODE-ID      TO AXFRMDEO          13450099
134600             MOVE ASC-XMIT-INTRFC-CDE        TO AINTCDEO          13460099
134700             SET DP030-SET-CURSOR-APPL-1     TO TRUE              13470099
134800             MOVE PC-CURSOR                  TO AIPADDR1L         13480099
134900             MOVE DP015-UNP-ALP-NOR-OFF      TO AIPADDR1A         13490099
135000             MOVE DP015-GREEN                TO AIPADDR1C         13500099
135100             MOVE DP015-UNDERLINE            TO AIPADDR1H         13510099
135200             MOVE DP015-UNP-ALP-NOR-OFF      TO AIPADDR2A         13520099
135300             MOVE DP015-GREEN                TO AIPADDR2C         13530099
135400             MOVE DP015-UNDERLINE            TO AIPADDR2H         13540099
135500             MOVE DP015-UNP-ALP-NOR-OFF      TO AIPADDR3A         13550099
135600             MOVE DP015-GREEN                TO AIPADDR3C         13560099
135700             MOVE DP015-UNDERLINE            TO AIPADDR3H         13570099
135800             MOVE DP015-UNP-ALP-NOR-OFF      TO AIPADDR4A         13580099
135900             MOVE DP015-GREEN                TO AIPADDR4C         13590099
136000             MOVE DP015-UNDERLINE            TO AIPADDR4H         13600099
136100             MOVE DP015-ASK-NOR-OFF          TO AOPERUNA          13610099
136200             MOVE DP015-BLUE                 TO AOPERUNC          13620099
136300             MOVE DP015-ASK-NOR-OFF          TO AOPERDSA          13630099
136400             MOVE DP015-BLUE                 TO AOPERDSC          13640099
136500             MOVE DP015-ASK-NOR-OFF          TO AFCLTYA           13650099
136600             MOVE DP015-BLUE                 TO AFCLTYC           13660099
136700*LMM                                                              13670099
136800             MOVE DP015-ASK-NOR-OFF          TO ARLSCDEA          13680099
136900             MOVE DP015-BLUE                 TO ARLSCDEC          13690099
137000             MOVE DP015-ASK-NOR-OFF          TO AXFRMDEA          13700099
137100             MOVE DP015-BLUE                 TO AXFRMDEC          13710099
137200             MOVE DP015-ASK-NOR-OFF          TO APCLNBRA          13720099
137300             MOVE DP015-BLUE                 TO APCLNBRC          13730099
137400             MOVE -1                         TO AIPADDR1L         13740099
137500                                                                  13750099
137600         WHEN PC-INTER-APPL-LIST-DELETE                           13760099
137700             SET ASC-NEED-VERIFICATION TO TRUE                    13770099
137800             MOVE ASC-IP-ADDR1               TO AIPADDR1O         13780099
137900             MOVE ASC-PER1                   TO APER1O            13790099
138000             MOVE ASC-IP-ADDR2               TO AIPADDR2O         13800099
138100             MOVE ASC-PER2                   TO APER2O            13810099
138200             MOVE ASC-IP-ADDR3               TO AIPADDR3O         13820099
138300             MOVE ASC-PER3                   TO APER3O            13830099
138400             MOVE ASC-IP-ADDR4               TO AIPADDR4O         13840099
138500*LMM         MOVE ASC-OPER-SYS-RLSE-CDE      TO ARLSCDEO          13850099
138600             MOVE PC-RLSE-CDE                TO ARLSCDEO          13860099
138700             MOVE ASC-DATA-XFER-MODE-ID      TO AXFRMDEO          13870099
138800             MOVE ASC-XMIT-INTRFC-CDE        TO AINTCDEO          13880099
138900             SET DP030-SET-CURSOR-APPL-1     TO TRUE              13890099
139000             MOVE PC-CURSOR                  TO AOPERUNL          13900099
139100             MOVE DP015-ASK-NOR-OFF          TO AIPADDR1A         13910099
139200             MOVE DP015-GREEN                TO AIPADDR1C         13920099
139300             MOVE DP015-UNDERLINE            TO AIPADDR1H         13930099
139400             MOVE DP015-ASK-NOR-OFF          TO AIPADDR2A         13940099
139500             MOVE DP015-GREEN                TO AIPADDR2C         13950099
139600             MOVE DP015-UNDERLINE            TO AIPADDR2H         13960099
139700             MOVE DP015-ASK-NOR-OFF          TO AIPADDR3A         13970099
139800             MOVE DP015-GREEN                TO AIPADDR3C         13980099
139900             MOVE DP015-UNDERLINE            TO AIPADDR3H         13990099
140000             MOVE DP015-ASK-NOR-OFF          TO AIPADDR4A         14000099
140100             MOVE DP015-GREEN                TO AIPADDR4C         14010099
140200             MOVE DP015-UNDERLINE            TO AIPADDR4H         14020099
140300             MOVE DP015-ASK-NOR-OFF          TO AOPERUNA          14030099
140400             MOVE DP015-GREEN                TO AOPERUNC          14040099
140500*LMM         MOVE DP015-UNDERLINE            TO AOPERUNH          14050099
140600             MOVE DP015-ASK-NOR-OFF          TO AOPERDSA          14060099
140700             MOVE DP015-GREEN                TO AOPERDSC          14070099
140800*LMM         MOVE DP015-UNDERLINE            TO AOPERDSH          14080099
140900             MOVE DP015-ASK-NOR-OFF          TO AFCLTYA           14090099
141000             MOVE DP015-GREEN                TO AFCLTYC           14100099
141100*LMM         MOVE DP015-UNDERLINE            TO AFCLTYH           14110099
141200             MOVE DP015-ASK-NOR-OFF          TO APCLNBRA          14120099
141300             MOVE DP015-GREEN                TO APCLNBRC          14130099
141400             MOVE DP015-UNDERLINE            TO APCLNBRH          14140099
141500             MOVE DP015-ASK-NOR-OFF          TO ARLSCDEA          14150099
141600             MOVE DP015-GREEN                TO ARLSCDEC          14160099
141700             MOVE DP015-UNDERLINE            TO ARLSCDEH          14170099
141800             MOVE DP015-ASK-NOR-OFF          TO AXFRMDEA          14180099
141900             MOVE DP015-GREEN                TO AXFRMDEC          14190099
142000             MOVE DP015-UNDERLINE            TO AXFRMDEH          14200099
142100             MOVE DP015-ASK-NOR-OFF          TO AINTCDEA          14210099
142200             MOVE DP015-GREEN                TO AINTCDEC          14220099
142300             MOVE DP015-UNDERLINE            TO AINTCDEH          14230099
142400     END-EVALUATE.                                                14240099
142500                                                                  14250099
142600*LMM MOVE DP015-UNDERLINE           TO AOPERUNH.                  14260099
142700***************************************************************   14270099
142800 4500-MOVE-COMMAREA-TO-TEMP.                                      14280099
142900     MOVE ASC-PRTR-OPER-UNT-ID    TO PV-INP-OPER-UNT-ID.          14290099
143000     MOVE ASC-PRTR-FCLTY-ID       TO PV-INP-FCLTY-ID.             14300099
143100     MOVE ASC-PRTR-CLUSTR-NBR-N   TO PV-INP-CLUSTR-NBR.           14310099
143200     MOVE ASC-PRTR-FCLTY-NME      TO PV-INP-FCLTY-NME.            14320099
143300                                                                  14330099
143400     EVALUATE ASC-INT-APPL-FORMAT-IND                             14340099
143500         WHEN PC-INTER-APPL-CRIT-SPEC-ADD                         14350099
143600         WHEN PC-INTER-APPL-LIST-ADD                              14360099
143700           MOVE ASC-IP-ADDR             TO PV-INP-IP-ADDRESS      14370099
143800         WHEN PC-INTER-APPL-LIST-UPDATE                           14380099
143900           MOVE ASC-IP-ADDR             TO PV-INP-IP-ADDRESS      14390099
144000     END-EVALUATE                                                 14400099
144100                                                                  14410099
144200*LMM MOVE ASC-OPER-SYS-RLSE-CDE   TO PV-INP-OS-RLSE-CDE.          14420099
144300     MOVE PC-RLSE-CDE             TO PV-INP-OS-RLSE-CDE.          14430099
144400     MOVE ASC-DATA-XFER-MODE-ID   TO PV-INP-DTXFR-MDEID.          14440099
144500     MOVE ASC-XMIT-INTRFC-CDE     TO PV-INP-XMIT-INTFCD.          14450099
144600                                                                  14460099
144700***************************************************************** 14470099
144800 4600-MOVE-TEMP-TO-COMMAREA.                                      14480099
144900     MOVE PV-INP-OPER-UNT-ID        TO ASC-PRTR-OPER-UNT-ID.      14490099
145000     MOVE PV-INP-FCLTY-ID           TO ASC-PRTR-FCLTY-ID.         14500099
145100     MOVE PV-INP-FCLTY-NME          TO ASC-PRTR-FCLTY-NME.        14510099
145200*LMM MOVE PV-INP-CLUSTR-NBR         TO ASC-PRTR-CLUSTR-NBR.       14520099
145300     MOVE PV-INP-IP-ADDRESS         TO ASC-IP-ADDR.               14530099
145400     MOVE PV-INP-OS-RLSE-CDE        TO ASC-OPER-SYS-RLSE-CDE.     14540099
145500     MOVE PV-INP-DTXFR-MDEID        TO ASC-DATA-XFER-MODE-ID.     14550099
145600     MOVE PV-INP-XMIT-INTFCD        TO ASC-XMIT-INTRFC-CDE.       14560099
145700                                                                  14570099
145800******************************************************************14580099
145900 4650-CURSOR-DRIVER.                                              14590099
146000     PERFORM 4700-OPEN-CURSOR.                                    14600099
146100     PERFORM 4800-FETCH-CURSOR.                                   14610099
146200     PERFORM 4900-CLOSE-CURSOR.                                   14620099
146300                                                                  14630099
146400***************************************************************   14640099
146500 4700-OPEN-CURSOR.                                                14650099
146600     PERFORM                                                      14660099
146700         WITH TEST AFTER                                          14670099
146800         VARYING PV-RETRY-COUNTER                                 14680099
146900         FROM 1 BY 1                                              14690099
147000         UNTIL (PV-RETRY-COUNTER > PC-MAX-RETRIES)                14700099
147100         OR    (SQLCODE = ZERO)                                   14710099
147200                                                                  14720099
147300         EXEC SQL                                                 14730099
147400             OPEN TPRTRCL-CSR                                     14740099
147500         END-EXEC                                                 14750099
147600                                                                  14760099
147700         EVALUATE TRUE                                            14770099
147800             WHEN SQLCODE = +0                                    14780099
147900             WHEN SQLCODE = -904                                  14790099
148000             WHEN SQLCODE = -913                                  14800099
148100                 CONTINUE                                         14810099
148200             WHEN SQLCODE < +0                                    14820099
148300             AND  SQLCODE > +0                                    14830099
148400                 MOVE '4700-OPEN-CURSOR' TO DP013-PARAGRAPH       14840099
148500                 MOVE 'ERROR OPENING THE CURSOR'                  14850099
148600                                   TO DP013-MESSAGE-TEXT (1)      14860099
148700                 MOVE SQLCA        TO DP013-SQLCA                 14870099
148800                 MOVE 'TPRTRCL'    TO DP013-DB2-TABLE-NAME (1)    14880099
148900                 SET DP013-DB2-ABEND                              14890099
149000                     DP013-XCTL-DISPLAY-RESTART TO TRUE           14900099
149100                 PERFORM DP013-0000-PROCESS-ABEND                 14910099
149200         END-EVALUATE                                             14920099
149300     END-PERFORM.                                                 14930099
149400                                                                  14940099
149500     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         14950099
149600         MOVE '4700-OPEN-CURSOR' TO DP013-PARAGRAPH               14960099
149700         MOVE 'ERROR OPENING THE CURSOR'                          14970099
149800                             TO DP013-MESSAGE-TEXT (1)            14980099
149900         MOVE 'APPLICATION SYS ID FOR SYS ID: '                   14990099
150000                             TO DP013-MESSAGE-TEXT (2)            15000099
150100         MOVE SQLCA          TO DP013-SQLCA                       15010099
150200         MOVE 'TPRTRCL'      TO DP013-DB2-TABLE-NAME (1)          15020099
150300         SET DP013-DB2-ABEND                                      15030099
150400             DP013-XCTL-DISPLAY-RESTART                           15040099
150500                             TO TRUE                              15050099
150600         PERFORM DP013-0000-PROCESS-ABEND                         15060099
150700     END-IF.                                                      15070099
150800     SET PS-CURSOR-NOT-END TO TRUE.                               15080099
150900     MOVE +0 TO PV-RETRY-COUNTER.                                 15090099
151000                                                                  15100099
151100****************************************************************  15110099
151200 4800-FETCH-CURSOR.                                               15120099
151300     PERFORM                                                      15130099
151400         WITH TEST AFTER                                          15140099
151500         VARYING PV-RETRY-COUNTER                                 15150099
151600         FROM 1 BY 1                                              15160099
151700         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               15170099
151800         OR     (SQLCODE = ZERO)                                  15180099
151900         OR     (SQLCODE = +100))                                 15190099
152000                                                                  15200099
152100         EXEC SQL                                                 15210099
152200             FETCH TPRTRCL-CSR                                    15220099
152300             INTO :DK-PRTR-CLUSTR-NBR                             15230099
152400                 ,:PV-TBL-OPER-UNT-ID                             15240099
152500                 ,:PV-TBL-FCLTY-ID                                15250099
152600                 ,:PV-TBL-IP-ADDRESS                              15260099
152700                 ,:PV-TBL-OS-RLSE-CDE                             15270099
152800                 ,:PV-TBL-DTXFR-MDEID                             15280099
152900                 ,:PV-TBL-XMIT-INTFCD                             15290099
153000         END-EXEC                                                 15300099
153100                                                                  15310099
153200         EVALUATE TRUE                                            15320099
153300             WHEN SQLCODE = +0                                    15330099
153400             WHEN SQLCODE = -904                                  15340099
153500             WHEN SQLCODE = -913                                  15350099
153600                 CONTINUE                                         15360099
153700             WHEN SQLCODE < +0                                    15370099
153800             AND  SQLCODE > +0                                    15380099
153900                 MOVE '4800-FETCH-CURSOR' TO DP013-PARAGRAPH      15390099
154000                 MOVE 'ERROR FETCHING FROM CURSOR'                15400099
154100                                   TO DP013-MESSAGE-TEXT (1)      15410099
154200                 MOVE SQLCA        TO DP013-SQLCA                 15420099
154300                 MOVE 'TPRTRCL'    TO DP013-DB2-TABLE-NAME (1)    15430099
154400                 SET DP013-DB2-ABEND                              15440099
154500                     DP013-XCTL-DISPLAY-RESTART TO TRUE           15450099
154600                 PERFORM DP013-0000-PROCESS-ABEND                 15460099
154700         END-EVALUATE                                             15470099
154800     END-PERFORM.                                                 15480099
154900                                                                  15490099
155000     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         15500099
155100         MOVE '4800-FETCH-CURSOR' TO DP013-PARAGRAPH              15510099
155200         MOVE 'ERROR FETCHING FROM CURSOR'                        15520099
155300                             TO DP013-MESSAGE-TEXT (1)            15530099
155400         MOVE 'APPLICATION SYS ID FOR SYS ID: '                   15540099
155500                             TO DP013-MESSAGE-TEXT (2)            15550099
155600         MOVE SQLCA          TO DP013-SQLCA                       15560099
155700         MOVE 'TPRTRCL'      TO DP013-DB2-TABLE-NAME (1)          15570099
155800         SET DP013-DB2-ABEND                                      15580099
155900             DP013-XCTL-DISPLAY-RESTART                           15590099
156000                             TO TRUE                              15600099
156100         PERFORM DP013-0000-PROCESS-ABEND                         15610099
156200     END-IF.                                                      15620099
156300     MOVE +0 TO PV-RETRY-COUNTER.                                 15630099
156400                                                                  15640099
156500******************************************************************15650099
156600 4900-CLOSE-CURSOR.                                               15660099
156700     PERFORM                                                      15670099
156800         WITH TEST AFTER                                          15680099
156900         VARYING PV-RETRY-COUNTER                                 15690099
157000         FROM 1 BY 1                                              15700099
157100         UNTIL (PV-RETRY-COUNTER > PC-MAX-RETRIES)                15710099
157200         OR    (SQLCODE = ZERO)                                   15720099
157300                                                                  15730099
157400         EXEC SQL                                                 15740099
157500             CLOSE TPRTRCL-CSR                                    15750099
157600         END-EXEC                                                 15760099
157700                                                                  15770099
157800         EVALUATE TRUE                                            15780099
157900             WHEN SQLCODE = +0                                    15790099
158000             WHEN SQLCODE = -904                                  15800099
158100             WHEN SQLCODE = -913                                  15810099
158200                 CONTINUE                                         15820099
158300             WHEN SQLCODE < +0                                    15830099
158400             AND  SQLCODE > +0                                    15840099
158500                 MOVE '4900-CLOSE-CURSOR' TO DP013-PARAGRAPH      15850099
158600                 MOVE 'ERROR CLOSING THE CURSOR'                  15860099
158700                                   TO DP013-MESSAGE-TEXT (1)      15870099
158800                 MOVE SQLCA        TO DP013-SQLCA                 15880099
158900                 MOVE 'TPRTRCL'    TO DP013-DB2-TABLE-NAME (1)    15890099
159000                 SET DP013-DB2-ABEND                              15900099
159100                     DP013-XCTL-DISPLAY-RESTART TO TRUE           15910099
159200                 PERFORM DP013-0000-PROCESS-ABEND                 15920099
159300         END-EVALUATE                                             15930099
159400     END-PERFORM.                                                 15940099
159500                                                                  15950099
159600     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         15960099
159700         MOVE '4900-CLOSE-CURSOR' TO DP013-PARAGRAPH              15970099
159800         MOVE 'ERROR CLOSING CURSOR' TO DP013-MESSAGE-TEXT (1)    15980099
159900         MOVE 'APPLICATION SYS ID FOR SYS ID: '                   15990099
160000                             TO DP013-MESSAGE-TEXT (2)            16000099
160100         MOVE SQLCA          TO DP013-SQLCA                       16010099
160200         MOVE 'TPRTRCL'      TO DP013-DB2-TABLE-NAME (1)          16020099
160300         SET DP013-DB2-ABEND                                      16030099
160400             DP013-XCTL-DISPLAY-RESTART TO TRUE                   16040099
160500         PERFORM DP013-0000-PROCESS-ABEND                         16050099
160600     END-IF.                                                      16060099
160700     MOVE +0 TO PV-RETRY-COUNTER.                                 16070099
160800     SET PS-CURSOR-NOT-END TO TRUE.                               16080099
160900                                                                  16090099
161000*----------------------------------------------------------------*16100099
161100* INSERT TO TABLE TPRTRCL                                         16110099
161200*----------------------------------------------------------------*16120099
161300 5000-PROCESS-ADD.                                                16130099
161400     PERFORM 6400-INSERT-TPRTRCL.                                 16140099
161500                                                                  16150099
161600*----------------------------------------------------------------*16160099
161700* UPDATE THE TPRTRCL TABLE                                        16170099
161800*----------------------------------------------------------------*16180099
161900 5100-PROCESS-UPDATE.                                             16190099
162000     PERFORM 4650-CURSOR-DRIVER.                                  16200099
162100     IF PV-TBL-IP-ADDRESS   NOT =  PV-INP-IP-ADDRESS              16210099
162200     OR PV-TBL-OS-RLSE-CDE  NOT =  PV-INP-OS-RLSE-CDE             16220099
162300     OR PV-TBL-DTXFR-MDEID  NOT =  PV-INP-DTXFR-MDEID             16230099
162400     OR PV-TBL-XMIT-INTFCD  NOT =  PV-INP-XMIT-INTFCD             16240099
162500         PERFORM 6300-UPDATE-TPRTRCL                              16250099
162600     END-IF.                                                      16260099
162700                                                                  16270099
162800*----------------------------------------------------------------*16280099
162900* DELETE FROM TABLE TPRTRCL                                       16290099
163000*----------------------------------------------------------------*16300099
163100 5200-PROCESS-DELETE.                                             16310099
163200     PERFORM 6500-DELETE-TPRTRCL.                                 16320099
163300                                                                  16330099
163400*----------------------------------------------------------------*16340099
163500** UPDATE THE ROW ON THE DB2 TABLE.                               16350099
163600*----------------------------------------------------------------*16360099
163700 6300-UPDATE-TPRTRCL.                                             16370099
163800     PERFORM                                                      16380099
163900         WITH TEST AFTER                                          16390099
164000         VARYING PV-RETRY-COUNTER                                 16400099
164100         FROM 1 BY 1                                              16410099
164200         UNTIL (((PV-RETRY-COUNTER > PC-MAX-RETRIES)              16420099
164300         OR       SQLCODE = ZERO)                                 16430099
164400         OR       SQLCODE = +100)                                 16440099
164500                                                                  16450099
164600         EXEC SQL                                                 16460099
164700             UPDATE TPRTRCL                                       16470099
164800             SET                                                  16480099
164900                  IP_ADDR            = :PV-INP-IP-ADDRESS         16490099
165000                 ,CLUSTR_OS_RLSE_CDE = :PV-INP-OS-RLSE-CDE        16500099
165100                 ,DAT_XFER_MODE_ID   = :PV-INP-DTXFR-MDEID        16510099
165200                 ,XMIT_INTFC_CDE     = :PV-INP-XMIT-INTFCD        16520099
165300             WHERE                                                16530099
165400                 PRTR_CLUSTR_NBR    = :PV-INP-CLUSTR-NBR          16540099
165500             AND CLUSTR_OPER_UNT_ID = :PV-INP-OPER-UNT-ID         16550099
165600             AND CLUSTR_FCLTY_ID    = :PV-INP-FCLTY-ID            16560099
165700         END-EXEC                                                 16570099
165800         EVALUATE TRUE                                            16580099
165900             WHEN SQLCODE = +0                                    16590099
166000                 MOVE PC-TSYMSG-00059 TO DP020-MSG-NUMBER         16600099
166100                 SET DP020-MSG-INFORMATIONAL TO TRUE              16610099
166200             WHEN SQLCODE = +100                                  16620099
166300             WHEN SQLCODE = -803                                  16630099
166400                 MOVE PC-TSYMSG-00046 TO DP020-MSG-NUMBER         16640099
166500                 SET DP020-MSG-INFORMATIONAL TO TRUE              16650099
166600             WHEN SQLWARN0 NOT = SPACES                           16660099
166700             WHEN SQLCODE < +0                                    16670099
166800             WHEN SQLCODE > +0                                    16680099
166900                 MOVE '6300-UPDATE-TPRTRCL' TO DP013-PARAGRAPH    16690099
167000                 MOVE 'ERROR UPDATING THE TPRTRCL TABLE'          16700099
167100                                   TO DP013-MESSAGE-TEXT (1)      16710099
167200                 MOVE SQLCA        TO DP013-SQLCA                 16720099
167300                 MOVE 'TPRTRCL'    TO DP013-DB2-TABLE-NAME (1)    16730099
167400                 SET DP013-DB2-ABEND                              16740099
167500                     DP013-XCTL-DISPLAY-RESTART TO TRUE           16750099
167600                 PERFORM DP013-0000-PROCESS-ABEND                 16760099
167700         END-EVALUATE                                             16770099
167800     END-PERFORM.                                                 16780099
167900     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         16790099
168000         MOVE '6300-UPDATE-TPRTRCL' TO DP013-PARAGRAPH            16800099
168100         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     16810099
168200                             TO DP013-MESSAGE-TEXT (1)            16820099
168300         MOVE 'APPLICATION SYS ID FOR SYS ID: '                   16830099
168400                             TO DP013-MESSAGE-TEXT (2)            16840099
168500         MOVE SQLCA          TO DP013-SQLCA                       16850099
168600         MOVE 'TPRTRCL'      TO DP013-DB2-TABLE-NAME (1)          16860099
168700         SET DP013-DB2-ABEND                                      16870099
168800             DP013-XCTL-DISPLAY-RESTART TO TRUE                   16880099
168900         PERFORM DP013-0000-PROCESS-ABEND                         16890099
169000     END-IF.                                                      16900099
169100     MOVE +0 TO PV-RETRY-COUNTER.                                 16910099
169200                                                                  16920099
169300*----------------------------------------------------------------*16930099
169400* INSERT A RECORD INTO THE TPRTRCL TABLE                         *16940099
169500*----------------------------------------------------------------*16950099
169600 6400-INSERT-TPRTRCL.                                             16960099
169700     PERFORM                                                      16970099
169800         WITH TEST AFTER                                          16980099
169900         VARYING PV-RETRY-COUNTER                                 16990099
170000         FROM 1 BY 1                                              17000099
170100         UNTIL (((PV-RETRY-COUNTER > PC-MAX-RETRIES)              17010099
170200         OR      SQLCODE = ZERO)                                  17020099
170300         OR      SQLCODE = -803)                                  17030099
170400                                                                  17040099
170500         MOVE ASC-PRTR-CLUSTR-NBR-N  TO  PV-INP-CLUSTR-NBR        17050099
170600                                                                  17060099
170700         EXEC SQL                                                 17070099
170800             INSERT INTO TPRTRCL                                  17080099
170900             (    PRTR_CLUSTR_NBR                                 17090099
171000                 ,CLUSTR_OPER_UNT_ID                              17100099
171100                 ,CLUSTR_FCLTY_ID                                 17110099
171200                 ,IP_ADDR                                         17120099
171300                 ,CLUSTR_OS_RLSE_CDE                              17130099
171400                 ,DAT_XFER_MODE_ID                                17140099
171500                 ,XMIT_INTFC_CDE     )                            17150099
171600             VALUES                                               17160099
171700             (                                                    17170099
171800                  :PV-INP-CLUSTR-NBR                              17180099
171900                 ,:PV-INP-OPER-UNT-ID                             17190099
172000                 ,:PV-INP-FCLTY-ID                                17200099
172100                 ,:PV-INP-IP-ADDRESS                              17210099
172200                 ,:PV-INP-OS-RLSE-CDE                             17220099
172300                 ,:PV-INP-DTXFR-MDEID                             17230099
172400                 ,:PV-INP-XMIT-INTFCD                             17240099
172500             )                                                    17250099
172600         END-EXEC                                                 17260099
172700         EVALUATE TRUE                                            17270099
172800             WHEN SQLCODE = +0                                    17280099
172900                 MOVE PC-TSYMSG-00034 TO DP020-MSG-NUMBER         17290099
173000                 SET DP020-MSG-INFORMATIONAL TO TRUE              17300099
173100             WHEN SQLCODE = -803                                  17310099
173200                 MOVE PC-TSYMSG-00117 TO DP020-MSG-NUMBER         17320099
173300                 SET DP020-MSG-INFORMATIONAL TO TRUE              17330099
173400*LMM             PERFORM 4650-CURSOR-DRIVER                       17340099
173500*LMM             MOVE PV-TBL-IP-ADDRESS TO PV-INP-IP-ADDRESS      17350099
173600                 MOVE DP015-UNP-ALP-NOR-OFF      TO AIPADDR1A     17360099
173700                 MOVE DP015-GREEN                TO AIPADDR1C     17370099
173800                 MOVE DP015-UNDERLINE            TO AIPADDR1H     17380099
173900                 MOVE DP015-UNP-ALP-NOR-OFF      TO AIPADDR2A     17390099
174000                 MOVE DP015-GREEN                TO AIPADDR2C     17400099
174100                 MOVE DP015-UNDERLINE            TO AIPADDR2H     17410099
174200                 MOVE DP015-UNP-ALP-NOR-OFF      TO AIPADDR3A     17420099
174300                 MOVE DP015-GREEN                TO AIPADDR3C     17430099
174400                 MOVE DP015-UNDERLINE            TO AIPADDR3H     17440099
174500                 MOVE DP015-UNP-ALP-NOR-OFF      TO AIPADDR4A     17450099
174600                 MOVE DP015-GREEN                TO AIPADDR4C     17460099
174700                 MOVE DP015-UNDERLINE            TO AIPADDR4H     17470099
174800*LMM             MOVE PV-TBL-OS-RLSE-CDE TO PV-INP-OS-RLSE-CDE    17480099
174900                 MOVE DP015-UNP-ALP-NOR-OFF      TO ARLSCDEA      17490099
175000                 MOVE DP015-GREEN                TO ARLSCDEC      17500099
175100                 MOVE DP015-UNDERLINE            TO ARLSCDEH      17510099
175200*LMM             MOVE PV-TBL-DTXFR-MDEID TO PV-INP-DTXFR-MDEID    17520099
175300                 MOVE DP015-UNP-ALP-NOR-OFF      TO AXFRMDEA      17530099
175400                 MOVE DP015-GREEN                TO AXFRMDEC      17540099
175500                 MOVE DP015-UNDERLINE            TO AXFRMDEH      17550099
175600*LMM             MOVE PV-TBL-XMIT-INTFCD TO PV-INP-XMIT-INTFCD    17560099
175700                 MOVE DP015-UNP-ALP-NOR-OFF      TO AINTCDEA      17570099
175800                 MOVE DP015-GREEN                TO AINTCDEC      17580099
175900                 MOVE DP015-UNDERLINE            TO AINTCDEH      17590099
176000                 MOVE DP015-ASK-NOR-OFF          TO APCLNBRA      17600099
176100                 MOVE DP015-BLUE                 TO APCLNBRC      17610099
176200             WHEN SQLCODE = -904                                  17620099
176300             WHEN SQLCODE = -913                                  17630099
176400                 CONTINUE                                         17640099
176500             WHEN SQLWARN0 NOT = SPACES                           17650099
176600             WHEN SQLCODE < +0                                    17660099
176700             WHEN SQLCODE > +0                                    17670099
176800                 MOVE '6400-INSERT-TPRTRCL' TO DP013-PARAGRAPH    17680099
176900                 MOVE 'ERROR INSERTING A NEW RECORD'              17690099
177000                                   TO DP013-MESSAGE-TEXT (1)      17700099
177100                 MOVE SQLCA        TO DP013-SQLCA                 17710099
177200                 MOVE 'TPRTRCL'    TO DP013-DB2-TABLE-NAME (1)    17720099
177300                 SET DP013-DB2-ABEND                              17730099
177400                     DP013-XCTL-DISPLAY-RESTART TO TRUE           17740099
177500                 PERFORM DP013-0000-PROCESS-ABEND                 17750099
177600         END-EVALUATE                                             17760099
177700     END-PERFORM.                                                 17770099
177800     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         17780099
177900         MOVE '6400-INSERT-TPRTRCL' TO DP013-PARAGRAPH            17790099
178000         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     17800099
178100                             TO DP013-MESSAGE-TEXT (1)            17810099
178200         MOVE 'APPLICATION SYS ID FOR SYS ID: '                   17820099
178300                             TO DP013-MESSAGE-TEXT (2)            17830099
178400         MOVE SQLCA          TO DP013-SQLCA                       17840099
178500         MOVE 'TPRTRCL'      TO DP013-DB2-TABLE-NAME (1)          17850099
178600         SET DP013-DB2-ABEND                                      17860099
178700             DP013-XCTL-DISPLAY-RESTART                           17870099
178800                             TO TRUE                              17880099
178900         PERFORM DP013-0000-PROCESS-ABEND                         17890099
179000     END-IF.                                                      17900099
179100     MOVE +0 TO PV-RETRY-COUNTER.                                 17910099
179200                                                                  17920099
179300*----------------------------------------------------------------*17930099
179400* DELETE A TRACK FROM THE PRINTER TRACKS TABLE                    17940099
179500*----------------------------------------------------------------*17950099
179600 6500-DELETE-TPRTRCL.                                             17960099
179700     PERFORM                                                      17970099
179800         WITH TEST AFTER                                          17980099
179900         VARYING PV-RETRY-COUNTER                                 17990099
180000         FROM 1 BY 1                                              18000099
180100         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               18010099
180200         OR      SQLCODE = ZERO)                                  18020099
180300                                                                  18030099
180400         EXEC SQL                                                 18040099
180500             DELETE FROM TPRTRCL                                  18050099
180600             WHERE                                                18060099
180700                  PRTR_CLUSTR_NBR    = :PV-INP-CLUSTR-NBR         18070099
180800             AND  CLUSTR_OPER_UNT_ID = :PV-INP-OPER-UNT-ID        18080099
180900             AND  CLUSTR_FCLTY_ID    = :PV-INP-FCLTY-ID           18090099
181000         END-EXEC                                                 18100099
181100         EVALUATE TRUE                                            18110099
181200             WHEN SQLCODE = +0                                    18120099
181300                  MOVE PC-TSYMSG-00115 TO DP020-MSG-NUMBER        18130099
181400                  SET DP020-MSG-INFORMATIONAL TO TRUE             18140099
181500             WHEN SQLCODE = +100                                  18150099
181600                  MOVE PC-TSYMSG-00116 TO DP020-MSG-NUMBER        18160099
181700                  SET DP020-MSG-INFORMATIONAL TO TRUE             18170099
181800             WHEN SQLCODE = -904                                  18180099
181900             WHEN SQLCODE = -913                                  18190099
182000                 CONTINUE                                         18200099
182100             WHEN SQLWARN0 NOT = SPACES                           18210099
182200             WHEN SQLCODE < +0                                    18220099
182300             WHEN SQLCODE > +0                                    18230099
182400                 MOVE '6500-DELETE-TPRTRCL' TO DP013-PARAGRAPH    18240099
182500                 MOVE 'ERROR DELETING A PRINTER CLUSTER RECORD'   18250099
182600                                   TO DP013-MESSAGE-TEXT (1)      18260099
182700                 MOVE SQLCA        TO DP013-SQLCA                 18270099
182800                 MOVE 'TPRTRCL'    TO DP013-DB2-TABLE-NAME (1)    18280099
182900                 SET DP013-DB2-ABEND                              18290099
183000                     DP013-XCTL-DISPLAY-RESTART TO TRUE           18300099
183100                 PERFORM DP013-0000-PROCESS-ABEND                 18310099
183200         END-EVALUATE                                             18320099
183300     END-PERFORM.                                                 18330099
183400     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         18340099
183500         MOVE '6500-DELETE-TPRTRCL' TO DP013-PARAGRAPH            18350099
183600         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     18360099
183700                             TO DP013-MESSAGE-TEXT (1)            18370099
183800         MOVE 'APPLICATION SYS ID FOR SYS ID: '                   18380099
183900                             TO DP013-MESSAGE-TEXT (2)            18390099
184000         MOVE SQLCA          TO DP013-SQLCA                       18400099
184100         MOVE 'TPRTRCL'      TO DP013-DB2-TABLE-NAME (1)          18410099
184200         SET DP013-DB2-ABEND                                      18420099
184300             DP013-XCTL-DISPLAY-RESTART TO TRUE                   18430099
184400         PERFORM DP013-0000-PROCESS-ABEND                         18440099
184500     END-IF.                                                      18450099
184600     MOVE +0 TO PV-RETRY-COUNTER.                                 18460099
184700                                                                  18470099
184800*----------------------------------------------------------------*18480099
184900* READ AN ITEM FROM THE SELECTED ITEMS TEMP STORAGE QUEUE.       *18490099
185000*----------------------------------------------------------------*18500099
185100 9100-READ-SEL-QUEUE.                                             18510099
185200     EXEC CICS                                                    18520099
185300         READQ TS                                                 18530099
185400             QUEUE (ASC-SEL-QUEUE-NAME)                           18540099
185500             INTO  (CN163-SELECT-RECORD)                          18550099
185600             ITEM  (ASC-SEL-ITEM)                                 18560099
185700             RESP  (PV-CICS-RESPONSE)                             18570099
185800     END-EXEC.                                                    18580099
185900                                                                  18590099
186000     IF  PV-CICS-RESPONSE = DFHRESP(NORMAL)                       18600099
186100         CONTINUE                                                 18610099
186200     ELSE                                                         18620099
186300         SET DP013-LOGIC-ABEND                                    18630099
186400             DP013-NO-ROLLBACK     TO TRUE                        18640099
186500         MOVE '9100-READ-SEL-QUEUE' TO DP013-PARAGRAPH            18650099
186600         MOVE 'ATTEMPTING TO READ THE LIST SELECTIONS TS QUEUE'   18660099
186700                                   TO DP013-MESSAGE-TEXT (1)      18670099
186800         PERFORM DP013-0000-PROCESS-ABEND                         18680099
186900     END-IF.                                                      18690099
187000                                                                  18700099
187100*----------------------------------------------------------------*18710099
187200* UPDATE AN ITEM IN THE SELECTED ITEMS TEMP STORAGE QUEUE.       *18720099
187300*----------------------------------------------------------------*18730099
187400 9200-REWRITE-SEL-QUEUE.                                          18740099
187500     EXEC CICS                                                    18750099
187600          WRITEQ TS                                               18760099
187700              QUEUE  (ASC-SEL-QUEUE-NAME)                         18770099
187800              FROM   (CN163-SELECT-RECORD)                        18780099
187900              ITEM   (ASC-SEL-ITEM)                               18790099
188000              RESP   (PV-CICS-RESPONSE)                           18800099
188100              REWRITE                                             18810099
188200     END-EXEC.                                                    18820099
188300                                                                  18830099
188400     IF  PV-CICS-RESPONSE NOT = DFHRESP(NORMAL)                   18840099
188500         SET DP013-CICS-ABEND                                     18850099
188600             DP013-NO-ROLLBACK     TO TRUE                        18860099
188700         MOVE '9200-REWRITE-SEL-QUEUE' TO DP013-PARAGRAPH         18870099
188800         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   18880099
188900                                   TO DP013-MESSAGE-TEXT (1)      18890099
189000         PERFORM DP013-0000-PROCESS-ABEND                         18900099
189100     END-IF.                                                      18910099
189200                                                                  18920099
189300*----------------------------------------------------------------*18930099
189400*  INTERFACE CODE FUNCTION                                        18940099
189500*----------------------------------------------------------------*18950099
189600 9300-PROCESS-INTERFACE-CODE.                                     18960099
189700                                                                  18970099
189800     EVALUATE TRUE                                                18980099
189900         WHEN  ASC-SELECT-FTP                                     18990099
190000                   SET  PV-TYPE-1-FTP                             19000099
190100                        PV-TYPE-2-SOCKETS      TO  TRUE           19010099
190200         WHEN  ASC-SELECT-SOCKETS                                 19020099
190300                   SET  PV-TYPE-1-FTP                             19030099
190400                        PV-TYPE-2-SOCKETS      TO  TRUE           19040099
190500     END-EVALUATE.                                                19050099
190600*                                                                 19060099
190700*                                                                 19070099
190800*----------------------------------------------------------------*19080099
190900*    ABEND PROCESSOR MODULE                                      *19090099
191000*----------------------------------------------------------------*19100099
191100     COPY DPPD013.                                                19110099
