000100***************************************************************** 00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300***************************************************************** 00030000
000400 PROGRAM-ID.             PCKRP002.                                00040000
000500 AUTHOR.                 LARRY SCHLEICHER - STRATAGEM.            00050000
000600 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00060000
000700 DATE-WRITTEN            OCTOBER, 1996                            00070000
000800***************************************************************** 00080000
000900***************************************************************** 00090000
001000*  THIS PROGRAM WILL PRINT THE PROCESS AREA CURRENT ON HAND     * 00100000
001100*  REPORT.                                                      * 00110000
001200***************************************************************** 00120000
001300*  CHANGED 05/04/99 BY ROBIN CHMIEL                             * 00130000
001400*   WR# 5675  CHANGED THE REPORT LAYOUT.                        * 00140000
001500*  CHANGED 04/19/01 BY DEANNA BRANTNER                          * 00150014
001600*   WR# 9900  CHANGED THE HEADING LINE TO INCLUDE PROCESS AREA  * 00160013
001700*  CHANGED 04/26/02 BY DEANNA BRANTNER                          * 00170020
001800*   WR# 9900  CHANGED THE HEADING LINE TO INCLUDE SEASONAL SET  * 00180016
001810*  CHANGED 09/26/14 BY DAVID WELLER                             * 00181030
001820*   CHG0098147 PO-NBR EXPANSION TO 8 DIGITS.                    * 00182030
001900*                                                               * 00190000
002000***************************************************************** 00200000
002100 ENVIRONMENT DIVISION.                                            00210000
002200 CONFIGURATION SECTION.                                           00220000
002300***************************************************************** 00230013
002400 SOURCE-COMPUTER.        IBM-3090.                                00240000
002500 OBJECT-COMPUTER.        IBM-3090.                                00250000
002600                                                                  00260000
002700 INPUT-OUTPUT SECTION.                                            00270000
002800 FILE-CONTROL.                                                    00280000
002900*                                                                 00290000
003000     SELECT EXTRACT-FILE                                          00300000
003100         ASSIGN TO INP01.                                         00310000
003200                                                                  00320000
003300     SELECT PC-CURRENT-ON-HAND-RPT                                00330000
003400         ASSIGN TO RPT01.                                         00340000
003500*                                                                 00350000
003600***************************************************************** 00360000
003700 DATA DIVISION.                                                   00370000
003800 FILE SECTION.                                                    00380000
003900***************************************************************** 00390013
004000 FD  EXTRACT-FILE                                                 00400000
004100     LABEL RECORDS ARE STANDARD                                   00410000
004200     RECORDING MODE IS F                                          00420000
004300     BLOCK CONTAINS 0 RECORDS                                     00430000
004310*** PRB0064829 START                                              00431031
004400*    RECORD CONTAINS 150 CHARACTERS.                              00440031
004500*01  EXTRACT-RECORD                  PIC X(150).                  00450031
004510     RECORD CONTAINS 200 CHARACTERS.                              00451031
004520 01  EXTRACT-RECORD                  PIC X(200).                  00452031
004530*** PRB0064829 END                                                00453031
004600                                                                  00460000
004700 FD  PC-CURRENT-ON-HAND-RPT                                       00470000
004800     RECORDING MODE IS F                                          00480000
004900     BLOCK CONTAINS 0  RECORDS.                                   00490000
005000 01  PC-CURRENT-ON-HAND-RECORD       PIC X(132).                  00500000
005100*                                                                 00510000
005200                                                                  00520000
005300 WORKING-STORAGE SECTION.                                         00530000
005400*                                                                 00540000
005500 01  PREVIOUS-RECORD.                                             00550000
005600     05  WS-HOLD-PREV-RECORD         PIC X(01)    VALUE SPACE.    00560000
005700         88  WS-TRAILR-TOTAL-NEEDED               VALUE 'Y'.      00570000
005800         88  WS-NO-TRAILR-TOTAL                   VALUE 'N'.      00580000
005900                                                                  00590000
006000 01  PROGRAM-SWITCHES.                                            00600000
006100     05  PS-END-OF-EXTRACT-SW        PIC  X(01)    VALUE 'N'.     00610000
006200         88  PS-END-OF-EXTRACT                     VALUE 'Y'.     00620000
006300         88  PS-PROCESS-EXTRACT                    VALUE 'N'.     00630000
006400     05  PS-VALID-DC-SW              PIC  X(01)    VALUE 'N'.     00640000
006500         88  PS-VALID-DC                           VALUE 'Y'.     00650000
006600         88  PS-INVALID-DC                         VALUE 'N'.     00660000
006700     05  PS-FIRST-PASS-SW            PIC  X(01)    VALUE 'Y'.     00670000
006800         88  PS-NOT-FIRST-PASS                     VALUE 'N'.     00680000
006900     05  PS-FIRST-DETAIL-REC-SW      PIC  X(01)    VALUE 'N'.     00690000
007000         88  PS-FIRST-DETAIL-REC                   VALUE 'Y'.     00700000
007100         88  PS-NOT-FIRST-DETAIL-REC               VALUE 'N'.     00710000
007200     05  PS-HEADER-ONLY-REC-SW       PIC  X(01)    VALUE 'N'.     00720000
007300         88  PS-HEADER-ONLY-REC                    VALUE 'Y'.     00730000
007400         88  PS-NOT-HEADER-ONLY-REC                VALUE 'N'.     00740000
007500*                                                                 00750000
007600 01  PC-CONSTANTS.                                                00760000
007700     05  PC-1                        PIC S9(03)    VALUE +1       00770000
007800                                                   COMP-3.        00780000
007900     05  PC-2                        PIC S9(03)    VALUE +2       00790000
008000                                                   COMP-3.        00800000
008100     05  PC-6                        PIC S9(03)    VALUE +6       00810000
008200                                                   COMP-3.        00820000
008300     05  PC-55                       PIC S9(03)    VALUE +55      00830000
008400                                                   COMP-3.        00840000
008500     05  PC-60                       PIC S9(03)    VALUE +60      00850000
008600                                                   COMP-3.        00860000
008700     05  PC-PCKRP002                 PIC  X(08)    VALUE          00870000
008800         'PCKRP002'.                                              00880000
008900     05  PC-REPORT-NBR               PIC  9(01)    VALUE 1.       00890000
009000     05  PC-ENROUTE                  PIC  X(10)   VALUE 'ENROUTE'.00900000
009100     05  PC-ENRT                     PIC  X(04)    VALUE 'ENRT'.  00910000
009200     05  PC-HERE                     PIC  X(04)    VALUE 'HERE'.  00920000
009300     05  PC-RECEIVE-TOTAL            PIC  X(07)    VALUE          00930000
009400         'ONHAND'.                                                00940000
009500     05  PC-ENROUTE-TOTAL            PIC  X(07)    VALUE          00950000
009600         'ENROUTE'.                                               00960000
009700     05  PC-PACK-BY-STORE            PIC  X(07)   VALUE 'PBS    '.00970000
009800     05  PC-FULLCASE                 PIC  X(07)   VALUE 'FCSE   '.00980000
009900     05  PC-PACK-TO-LIGHT            PIC  X(07)   VALUE 'P2L    '.00990000
010000     05  PC-FULLCASE-P2L             PIC  X(07)   VALUE 'FCS&P2L'.01000000
010100                                                                  01010000
010200 01 PC-PROGRAM-VARIABLES.                                         01020000
010300     05  PV-LINE-SUB                 PIC S9(03)    VALUE ZERO     01030000
010400                                                   COMP-3.        01040000
010500     05  PV-LINE-CNT                 PIC S9(03)    VALUE ZERO     01050000
010600                                                   COMP-3.        01060000
010700     05  PV-PAGE-CNT                 PIC S9(04)    VALUE ZERO     01070000
010800                                                   COMP-3.        01080000
010900     05  PV-VENDOR-COUNT             PIC S9(04)    VALUE ZERO     01090000
011000                                                   COMP-3.        01100000
011100     05  PV-ABEND-CODE               PIC S9(04)    VALUE ZERO     01110000
011200                                                   COMP SYNC.     01120000
011300     05  PV-RECEIVER-STATUS          PIC  X(04)    VALUE SPACES.  01130000
011400     05  PV-CURRENT-OPER             PIC  9(04)    VALUE ZERO.    01140024
011500*LMM     10  FILLER                  PIC  X(01)    VALUE SPACES.  01150024
011600*        10  PV-CURRENT-OPER-3       PIC  X(03)    VALUE SPACES.  01160024
011700*    05  PV-CURRENT-OPER-X-3         PIC  X(03)    VALUE SPACES.  01170024
011800     05  PV-SAVE-DATE                PIC  X(10)    VALUE SPACES.  01180000
011900     05  PV-SAVE-PRE-RECEIVED-IND    PIC  X(01)    VALUE SPACES.  01190000
012000         88  PV-SAVE-PRE-RECEIVED                    VALUE 'Y'.   01200000
012100     05  PV-SAVE-PROCESS             PIC  X(06)    VALUE SPACES.  01210000
012200     05  PV-SAVE-CURR-OPER           PIC  9(04)    VALUE ZERO.    01220000
012300     05  PV-SAVE-CURR-FCLTY          PIC  9(04)    VALUE ZERO.    01230000
012400     05  PV-DATE-CARTON-QTY          PIC  9(09)    VALUE ZERO.    01240000
012500     05  PV-DATE-ITEM-QTY            PIC  9(09)    VALUE ZERO.    01250000
012600     05  PV-TRAILR-SCAC-ID           PIC  X(04)    VALUE SPACES.  01260000
012700     05  PV-TRAILR-VEH-NBR           PIC  X(10)    VALUE SPACES.  01270000
012800     05  PV-TRAILR-CARTON-QTY        PIC  9(09)    VALUE ZERO.    01280000
012900     05  PV-TRAILR-ITEM-QTY          PIC  9(09)    VALUE ZERO.    01290000
013000     05  PV-RECEIVED-CARTON-QTY      PIC  9(09)    VALUE ZERO.    01300000
013100     05  PV-RECEIVED-ITEM-QTY        PIC  9(09)    VALUE ZERO.    01310000
013200     05  PV-PROCESS-CARTON-QTY       PIC  9(09)    VALUE ZERO.    01320000
013300     05  PV-PROCESS-ITEM-QTY         PIC  9(09)    VALUE ZERO.    01330000
013400     05  PV-GRAND-CARTON-QTY         PIC  9(09)    VALUE ZERO.    01340000
013500     05  PV-GRAND-ITEM-QTY           PIC  9(09)    VALUE ZERO.    01350000
013600     05  PV-ABEND-PARAGRAPH          PIC  X(30)    VALUE SPACES.  01360000
013700     05  PV-SAVE-PO                  PIC S9(09)    VALUE ZERO.    01370000
013800     05  PV-SAVE-RECEIVER            PIC  9(03)    VALUE ZERO.    01380000
013900     05  PV-DATE-DDMMYY.                                          01390000
014000         10  PV-DATE-DD              PIC  X(02).                  01400000
014100         10  PV-DATE-SLASH-1         PIC  X(01).                  01410000
014200         10  PV-DATE-MM              PIC  X(02).                  01420000
014300         10  PV-DATE-SLASH-2         PIC  X(01).                  01430000
014400         10  PV-DATE-YY              PIC  X(04).                  01440000
014500     05  PV-TODAYS-DATE.                                          01450000
014600         10  PV-TODAYS-DATE-YY       PIC  9(02)    VALUE ZERO.    01460000
014700         10  PV-TODAYS-DATE-MM       PIC  9(02)    VALUE ZERO.    01470000
014800         10  PV-TODAYS-DATE-DD       PIC  9(02)    VALUE ZERO.    01480000
014900     05  PV-TODAYS-TIME.                                          01490000
015000         10  PV-TODAYS-TIME-HH       PIC  9(02)    VALUE ZERO.    01500000
015100         10  PV-TODAYS-TIME-MM       PIC  9(02)    VALUE ZERO.    01510000
015200         10  PV-TODAYS-TIME-SS       PIC  9(02)    VALUE ZERO.    01520000
015300         10  FILLER                  PIC  9(02)    VALUE ZERO.    01530000
015400     05  PV-FORMAT-DATE.                                          01540000
015500         10  PV-FORMAT-DATE-MM       PIC  X(02)    VALUE SPACES.  01550000
015600         10  FILLER                  PIC  X(01)    VALUE '/'.     01560000
015700         10  PV-FORMAT-DATE-DD       PIC  X(02)    VALUE SPACES.  01570000
015800         10  FILLER                  PIC  X(01)    VALUE '/'.     01580000
015900         10  PV-FORMAT-DATE-YYYY     PIC  X(04)    VALUE SPACES.  01590000
016000     05  PV-SAVE-ASSIGN-TOT-QTY      PIC S9(07)    VALUE ZERO.    01600000
016100                                                                  01610000
016110*** PRB0064829 START                                              01611035
016200 01 WS-SORT-FIELDS.                                               01620000
016300     05  SORT-FIELD-FORMAT1.                                      01630000
016400         10  PO-NUMBER-1                 PIC  9(08) VALUE ZEROS.  01640000
016500*        10  RECEIVER-SEQUENCE-NUMBER-1  PIC  9(03) VALUE ZEROS.  01650035
016510         10  RECEIVER-SEQUENCE-NUMBER-1  PIC  9(04) VALUE ZEROS.  01651035
016600         10  FILLER-1                    PIC  X(14) VALUE SPACE.  01660000
016700                                                                  01670000
016800     05  SORT-FIELD-FORMAT2.                                      01680000
016900         10  SCAC-2                      PIC  X(04) VALUE SPACE.  01690000
017000         10  TRAILER-NUMBER-2            PIC  X(10) VALUE SPACE.  01700000
017100         10  PO-NUMBER-2                 PIC  9(08) VALUE ZERO.   01710000
017200*        10  RECEIVER-SEQUENCE-NUMBER-2  PIC  9(03) VALUE ZERO.   01720035
017210         10  RECEIVER-SEQUENCE-NUMBER-2  PIC  9(04) VALUE ZERO.   01721035
017220*** PRB0064829 END                                                01722035
017300                                                                  01730000
017400     COPY PCRD002.                                                01740000
017500                                                                  01750000
017600*-----------------------------------------------------------------01760021
017700* COMMAREA FOR XLKUT071 - LOCATION MODULE                         01770021
017800*-----------------------------------------------------------------01780021
017900     COPY XLWS071.                                                01790021
018000                                                                  01800021
018100******************************************************************01810000
018200*  WORK FIELDS FOR PRINTING A 132 CHARACTER REPORT.               01820000
018300******************************************************************01830000
018400     COPY DPWS132O.                                               01840000
018500*                                                                 01850000
018600 01  HEADING-LINES.                                               01860000
018700     05  HEADING-LINE-1.                                          01870000
018800         10  FILLER                  PIC  X(09)    VALUE          01880000
018900             'LOCATION '.                                         01890000
019000         10  HL1-OPER-UNIT           PIC  X(05).                  01900000
019100         10  HL1-PROCESS             PIC  X(06).                  01910013
019200*DMB     10  HL1-FACILITY            PIC  X(04).                  01920013
019300         10  FILLER                  PIC  X(32)    VALUE SPACES.  01930013
019400*DMB     10  FILLER                  PIC  X(34)    VALUE SPACES.  01940013
019500         10  FILLER                  PIC  X(28)    VALUE          01950000
019600             'PROCESS AREA CURRENT ON-HAND'.                      01960000
019700         10  FILLER                  PIC  X(52)    VALUE SPACES.  01970000
019800*                                                                 01980000
019810*** PRB0064829 START                                              01981031
019900     05  HEADING-LINE-2.                                          01990000
020000         10  FILLER                  PIC  X(09)    VALUE          02000000
020100             'PROCESS  '.                                         02010000
020200         10  FILLER                  PIC  X(09)    VALUE          02020033
020300             'RECEIVE  '.                                         02030033
020400         10  FILLER                  PIC  X(06)    VALUE          02040000
020500             'CREATE'.                                            02050000
020600         10  FILLER                  PIC  X(04)    VALUE SPACES.  02060000
020700         10  FILLER                  PIC  X(02)    VALUE          02070000
020800             'PO'.                                                02080000
020900         10  FILLER                  PIC  X(04)    VALUE SPACES.  02090028
021000         10  FILLER                  PIC  X(04)    VALUE          02100031
021100             'REC '.                                              02110031
021200         10  FILLER                  PIC  X(05)    VALUE          02120000
021300             ' LINE'.                                             02130000
021400         10  FILLER                  PIC  X(09)    VALUE SPACES.  02140016
021500         10  FILLER                  PIC  X(06)    VALUE          02150000
021600             'VENDOR'.                                            02160000
021700         10  FILLER                  PIC  X(08)    VALUE SPACES.  02170019
021800         10  FILLER                  PIC  X(03)    VALUE          02180031
021900             'DPT'.                                               02190031
021910         10  FILLER                  PIC  X(04)    VALUE SPACES.  02191034
022000         10  FILLER                  PIC  X(03)    VALUE          02200031
022100             'OTB'.                                               02210031
022110         10  FILLER                  PIC  X(04)    VALUE SPACES.  02211034
022400         10  FILLER                  PIC  X(06)    VALUE          02240016
022500             'SEASN '.                                            02250017
022600         10  FILLER                  PIC  X(08)    VALUE          02260000
022700             'TROUBLE '.                                          02270000
022800         10  FILLER                  PIC  X(04)    VALUE          02280000
022900             'CODE'.                                              02290000
023000         10  FILLER                  PIC  X(03)    VALUE SPACES.  02300000
023100         10  FILLER                  PIC  X(07)    VALUE          02310000
023200             'CARTONS'.                                           02320000
023300         10  FILLER                  PIC  X(02)    VALUE SPACES.  02330000
023400         10  FILLER                  PIC  X(05)    VALUE          02340000
023500             'PKSL '.                                             02350000
023600         10  FILLER                  PIC  X(06)    VALUE          02360000
023700             'ITEM  '.                                            02370000
023800         10  FILLER                  PIC  X(04)    VALUE          02380000
023900             'PRCS'.                                              02390000
024000         10  FILLER                  PIC  X(07)    VALUE SPACES.  02400033
024100*                                                                 02410000
024200     05  HEADING-LINE-3.                                          02420000
024300         10  FILLER                  PIC  X(09)    VALUE          02430000
024400             ' AREA    '.                                         02440000
024500         10  FILLER                  PIC  X(10)    VALUE          02450000
024600             ' DATE     '.                                        02460031
024700         10  FILLER                  PIC  X(03)    VALUE          02470031
024800             'FOR'.                                               02480031
024900         10  FILLER                  PIC  X(18)    VALUE SPACES.  02490032
025000         10  FILLER                  PIC  X(03)    VALUE          02500000
025100             'LOC'.                                               02510000
025200         10  FILLER                  PIC  X(10)    VALUE SPACES.  02520031
025300         10  FILLER                  PIC  X(04)    VALUE          02530000
025400             'NAME'.                                              02540000
025500         10  FILLER                  PIC  X(15)    VALUE SPACES.  02550031
025600         10  FILLER                  PIC  X(09)    VALUE          02560031
025700             'PERIOD   '.                                         02570031
026100         10  FILLER                  PIC  X(03)    VALUE          02610016
026200             'SET'.                                               02620016
026300         10  FILLER                  PIC  X(30)    VALUE SPACES.  02630032
026400         10  FILLER                  PIC  X(03)    VALUE          02640000
026500             'QTY'.                                               02650000
026600         10  FILLER                  PIC  X(06)    VALUE SPACES.  02660019
026700         10  FILLER                  PIC  X(02)    VALUE          02670000
026800             'CD'.                                                02680000
026900         10  FILLER                  PIC  X(07)    VALUE SPACES.  02690032
026910*** PRB0064829 END                                                02691031
027000*                                                                 02700000
027100 01  MISCELLANEOUS-LINES.                                         02710000
027200     05  END-OF-REPORT-LINE.                                      02720000
027300         10  FILLER                  PIC  X(44)    VALUE SPACES.  02730000
027400         10  FILLER                  PIC  X(45)    VALUE          02740000
027500             '*******   E N D   O F   R E P O R T   *******'.     02750000
027600         10  FILLER                  PIC  X(43)    VALUE SPACES.  02760000
027700     05  NO-DATA-TO-REPORT-LINE.                                  02770000
027800         10  FILLER                  PIC  X(40)    VALUE SPACES.  02780000
027900         10  FILLER                  PIC  X(52)    VALUE          02790000
028000         '*******  N O   D A T A   T O   R E P O R T   *******'.  02800000
028100         10  FILLER                  PIC  X(40)    VALUE SPACES.  02810000
028200*                                                                 02820000
028300 01  DETAIL-LINES.                                                02830000
028400     05  DETAIL-LINE1.                                            02840000
028500         10  DL1-PROCESS-AREA        PIC  X(06)    VALUE SPACES.  02850000
028600         10  FILLER                  PIC  X(01)    VALUE SPACES.  02860031
028700         10  DL1-RECEIVED-DATE       PIC  X(10)    VALUE SPACES.  02870000
028800         10  FILLER                  PIC  X(02)    VALUE SPACES.  02880000
028900         10  DL1-OPER-UNIT           PIC  X(04)    VALUE SPACES.  02890000
029000         10  FILLER                  PIC  X(02)    VALUE SPACES.  02900000
029100         10  DL1-PO                  PIC  ZZZZZZZ9  VALUE ZERO.   02910028
029200         10  FILLER                  PIC  X(01)    VALUE SPACES.  02920000
029210*** PRB0064829 START                                              02921031
029300*        10  DL1-REC-SEQ             PIC  9(03)    VALUE ZERO.    02930031
029310         10  DL1-REC-SEQ             PIC  9(04)    VALUE ZERO.    02931031
029320*** PRB0064829 END                                                02932031
029400         10  FILLER                  PIC  X(01)    VALUE SPACES.  02940000
029500         10  DL1-LINE                PIC  X(05)    VALUE SPACES.  02950000
029600         10  FILLER                  PIC  X(01)    VALUE SPACES.  02960000
029700         10  DL1-VENDOR              PIC  X(20)    VALUE SPACES.  02970016
029800         10  FILLER                  PIC  X(01)    VALUE SPACES.  02980019
029900         10  DL1-DEPT                PIC  X(03)    VALUE SPACES.  02990000
029910*** PRB0064829 START                                              02991031
030000*        10  FILLER                  PIC  X(02)    VALUE SPACES.  03000031
030001         10  FILLER                  PIC  X(01)    VALUE SPACES.  03000131
030100*        10  DL1-NEW-STR             PIC  X(01)    VALUE SPACES.  03010031
030200*        10  FILLER                  PIC  X(03)    VALUE SPACES.  03020031
030300*        10  DL1-PIC-AD              PIC  X(01)    VALUE SPACES.  03030031
030400*        10  FILLER                  PIC  X(02)    VALUE SPACES.  03040031
030401         10  DL1-OTB-MM-YY           PIC  X(05)    VALUE SPACES.  03040131
030410         10  FILLER                  PIC  X(01)    VALUE SPACES.  03041031
030411         10  FILLER                  PIC  X(02)    VALUE 'WK'.    03041131
030412         10  DL1-OTB-WK              PIC  9(01)    VALUE ZEROES.  03041231
030413         10  FILLER                  PIC  X(01)    VALUE SPACES.  03041331
030500         10  DL1-SEASET              PIC  X(05)    VALUE SPACES.  03050016
030600         10  FILLER                  PIC  X(01)    VALUE SPACES.  03060019
030700         10  DL1-TROUBLE             PIC  X(13)    VALUE SPACES.  03070016
030800         10  FILLER                  PIC  X(02)    VALUE SPACES.  03080000
030900         10  DL1-CARTON-CNT          PIC  ZZZZZZ9  VALUE ZERO.    03090000
031000*        10  FILLER                  PIC  X(02)    VALUE SPACES.  03100037
031010         10  FILLER                  PIC  X(04)    VALUE SPACES.  03101037
031020*** PRB0064829 END                                                03102037
031100         10  DL1-PACKSLIP-QTY        PIC  ZZZZZZZ  VALUE ZERO.    03110000
031200         10  FILLER                  PIC  X(02)    VALUE SPACES.  03120000
031300         10  DL1-PROCESS-IND         PIC  X(07)    VALUE SPACES.  03130000
031400         10  FILLER                  PIC  X(07)    VALUE SPACES.  03140031
031500                                                                  03150000
031600 01  TOTAL-LINES.                                                 03160000
031700     05  TOTAL-LINE-1.                                            03170004
031800         10  FILLER                  PIC  X(82)    VALUE SPACES.  03180028
031900         10  TL1-TRAILR-SCAC-ID      PIC  X(04)    VALUE SPACES.  03190004
032000         10  FILLER                  PIC  X(01)    VALUE SPACES.  03200004
032100         10  TL1-TRAILR-VEH-NBR      PIC  X(10)    VALUE SPACES.  03210004
032110*** PRB0064829 START                                              03211036
032200*        10  FILLER                  PIC  X(02)    VALUE SPACES.  03220036
032210         10  FILLER                  PIC  X(04)    VALUE SPACES.  03221036
032300         10  TL1-TRAILR-CARTON-QTY   PIC  ZZZZZZ9.                03230004
032400         10  FILLER                  PIC  X(04)    VALUE SPACES.  03240039
032500         10  TL1-TRAILR-ITEM-QTY     PIC  ZZZZZZZ.                03250004
032600*        10  FILLER                  PIC  X(08)    VALUE SPACES.  03260039
032610         10  FILLER                  PIC  X(06)    VALUE SPACES.  03261039
032620*** PRB0064829 END                                                03262039
032700         10  FILLER                  PIC  X(07)    VALUE          03270004
032800              'TRAILR '.                                          03280004
032900                                                                  03290004
033000     05  TOTAL-LINE-2.                                            03300004
033010*** PRB0064829 START                                              03301036
033100*        10  FILLER                  PIC  X(99)    VALUE SPACES.  03310036
033110         10  FILLER                  PIC  X(101)   VALUE SPACES.  03311036
033200         10  TL2-DATE-CARTON-QTY     PIC  ZZZZZZ9.                03320004
033300         10  FILLER                  PIC  X(04)    VALUE SPACES.  03330000
033310*        10  FILLER                  PIC  X(02)    VALUE SPACES.  03331036
033400         10  TL2-DATE-ITEM-QTY       PIC  ZZZZZZZ.                03340004
033500*        10  FILLER                  PIC  X(08)    VALUE SPACES.  03350037
033510         10  FILLER                  PIC  X(06)    VALUE SPACES.  03351037
033520*** PRB0064829 END                                                03352037
033600         10  FILLER                  PIC  X(07)    VALUE          03360000
033700              'DATE   '.                                          03370000
033800                                                                  03380004
033900     05  TOTAL-LINE-3.                                            03390000
033910*** PRB0064829 START                                              03391036
034000*        10  FILLER                  PIC  X(99)    VALUE SPACES.  03400036
034010         10  FILLER                  PIC  X(101)   VALUE SPACES.  03401036
034100         10  TL3-RECEIVED-CARTON-QTY PIC  ZZZZZZ9.                03410000
034200         10  FILLER                  PIC  X(04)    VALUE SPACES.  03420038
034300         10  TL3-RECEIVED-ITEM-QTY   PIC  ZZZZZZZ.                03430000
034400*        10  FILLER                  PIC  X(08)    VALUE SPACES.  03440038
034410         10  FILLER                  PIC  X(06)    VALUE SPACES.  03441038
034420*** PRB0064829 END                                                03442038
034500         10  TL3-RECEIVED-TOTAL-DESC PIC  X(07)    VALUE SPACES.  03450000
034600                                                                  03460000
034700     05  TOTAL-LINE-4.                                            03470000
034710*** PRB0064829 START                                              03471036
034800*        10  FILLER                  PIC  X(99)    VALUE SPACES.  03480036
034810         10  FILLER                  PIC  X(101)   VALUE SPACES.  03481036
034900         10  TL4-PROCESS-CARTON-QTY  PIC  ZZZZZZ9.                03490000
035000         10  FILLER                  PIC  X(04)    VALUE SPACES.  03500038
035100         10  TL4-PROCESS-ITEM-QTY    PIC  ZZZZZZZ.                03510000
035200*        10  FILLER                  PIC  X(08)    VALUE SPACES.  03520038
035210         10  FILLER                  PIC  X(06)    VALUE SPACES.  03521038
035220*** PRB0064829 END                                                03522038
035300         10  FILLER                  PIC  X(07)    VALUE          03530000
035400              'AREA   '.                                          03540000
035500                                                                  03550000
035600     05  TOTAL-LINE-5.                                            03560000
035610*** PRB0064829 START                                              03561036
035700*        10  FILLER                  PIC  X(99)    VALUE SPACES.  03570036
035710         10  FILLER                  PIC  X(101)   VALUE SPACES.  03571036
035800         10  TL5-GRAND-CARTON-QTY    PIC  ZZZZZZ9.                03580000
035900         10  FILLER                  PIC  X(04)    VALUE SPACES.  03590038
036000         10  TL5-GRAND-ITEM-QTY      PIC  ZZZZZZZ.                03600000
036100*        10  FILLER                  PIC  X(08)    VALUE SPACES.  03610038
036110         10  FILLER                  PIC  X(06)    VALUE SPACES.  03611038
036120*** PRB0064829 END                                                03612038
036200         10  FILLER                  PIC  X(07)    VALUE          03620000
036300              'FINAL  '.                                          03630000
036400                                                                  03640000
036500*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE LOGISTICS          03650021
036600*  LOCATION TABLE                                                 03660021
036700*  (XLT_LOC)                                                      03670021
036800*                                                                 03680021
036900     EXEC SQL                                                     03690021
037000          INCLUDE XLT00010                                        03700021
037100     END-EXEC.                                                    03710021
037200                                                                  03720021
037300*                                                                 03730021
037400*    DB2 AREA FOR COMMUNICATIONS                                  03740000
037500                                                                  03750000
037600     EXEC SQL                                                     03760000
037700          INCLUDE SQLCA                                           03770000
037800     END-EXEC.                                                    03780000
037900                                                                  03790000
038000*    DB2 AREA FOR COMMUNICATIONS AREA2                            03800000
038100                                                                  03810000
038200     COPY SQLCA2.                                                 03820000
038300*                                                                 03830000
038400 PROCEDURE DIVISION.                                              03840000
038500******************************************************************03850000
038600**  THIS IS THE MAIN DRIVER FOR THE PROGRAM.                      03860000
038700******************************************************************03870000
038800 0000-MAINLINE-PROCESSING.                                        03880013
038900     OPEN INPUT  EXTRACT-FILE                                     03890000
039000          OUTPUT PC-CURRENT-ON-HAND-RPT.                          03900000
039100*                                                                 03910000
039200     SET PS-FIRST-DETAIL-REC TO TRUE.                             03920000
039300     PERFORM 2200-READ-EXTRACT.                                   03930000
039400     MOVE PC002-SORT-FIELD     TO SORT-FIELD-FORMAT2.             03940000
039500     MOVE SCAC-2               TO PV-TRAILR-SCAC-ID.              03950000
039600     MOVE TRAILER-NUMBER-2     TO PV-TRAILR-VEH-NBR.              03960000
039700     IF PC002-HEADER-RECORD                                       03970000
039800         SET PS-HEADER-ONLY-REC TO TRUE                           03980000
039900     END-IF.                                                      03990000
040000     PERFORM 1000-INITIALIZATION.                                 04000000
040100*                                                                 04010000
040200     PERFORM 2000-PROCESS-EXTRACT                                 04020000
040300         UNTIL PS-END-OF-EXTRACT.                                 04030000
040400*                                                                 04040000
040500     IF PS-NOT-HEADER-ONLY-REC                                    04050000
040600         PERFORM 8500-TRAILER-TOTAL                               04060004
040700         PERFORM 8600-DATE-TOTAL                                  04070000
040800         PERFORM 8800-RECEIVING-TOTAL                             04080000
040900         PERFORM 9000-PROCESS-TOTAL                               04090000
041000         PERFORM 9200-PROCESS-GRAND-TOTAL                         04100000
041100     ELSE                                                         04110000
041200         WRITE PC-CURRENT-ON-HAND-RECORD                          04120000
041300           FROM NO-DATA-TO-REPORT-LINE                            04130000
041400             AFTER ADVANCING 2 LINES                              04140000
041500     END-IF.                                                      04150000
041600     WRITE PC-CURRENT-ON-HAND-RECORD                              04160000
041700       FROM END-OF-REPORT-LINE                                    04170000
041800         AFTER ADVANCING 2 LINES.                                 04180000
041900*                                                                 04190000
042000     CLOSE EXTRACT-FILE                                           04200000
042100           PC-CURRENT-ON-HAND-RPT.                                04210000
042200*                                                                 04220000
042300     GOBACK.                                                      04230000
042400*                                                                 04240000
042500*                                                                 04250000
042600 1000-INITIALIZATION.                                             04260000
042700******************************************************************04270000
042800**  PERFORM THE INITIAL PROCESSING FOR THE PROGRAM.               04280000
042900******************************************************************04290000
043000                                                                  04300000
043100     ACCEPT PV-TODAYS-DATE                                        04310000
043200       FROM DATE.                                                 04320000
043300*                                                                 04330000
043400     ACCEPT PV-TODAYS-TIME                                        04340000
043500       FROM TIME.                                                 04350000
043600*                                                                 04360000
043700     MOVE PC-REPORT-NBR          TO DP132O-REPORT-NUMBER.         04370000
043800     MOVE PV-TODAYS-DATE-MM      TO DP132O-RUN-MONTH.             04380000
043900     MOVE PV-TODAYS-DATE-DD      TO DP132O-RUN-DAY.               04390000
044000     MOVE PV-TODAYS-DATE-YY      TO DP132O-RUN-YEAR.              04400000
044100*                                                                 04410000
044200     MOVE PV-TODAYS-TIME-HH      TO DP132O-RUN-HOUR.              04420000
044300     MOVE PV-TODAYS-TIME-MM      TO DP132O-RUN-MINUTE.            04430000
044400     MOVE PC-PCKRP002            TO DP132O-PROGRAM-NAME.          04440000
044500*                                                                 04450000
044600     MOVE PC002-CURRENT-OPER   TO HL1-OPER-UNIT                   04460000
044700                                  PV-SAVE-CURR-OPER.              04470000
044800     MOVE PC002-PROCESS-AREA   TO HL1-PROCESS                     04480013
044900                                  PV-SAVE-PROCESS.                04490013
045000*DMB MOVE PC002-CURRENT-FCLTY  TO HL1-FACILITY                    04500013
045100*DMB                              PV-SAVE-CURR-FCLTY.             04510013
045200     MOVE PC002-CURRENT-OPER TO PV-CURRENT-OPER.                  04520000
045300*    MOVE PV-CURRENT-OPER-3  TO PV-CURRENT-OPER-X-3.              04530024
045400     PERFORM 2300-VALIDATE-OPER-UNIT.                             04540000
045500     IF PS-VALID-DC                                               04550000
045600         PERFORM 8000-WRITE-REPORT-HEADERS                        04560000
045700     END-IF.                                                      04570000
045800                                                                  04580000
045900*                                                                 04590000
046000 2000-PROCESS-EXTRACT.                                            04600000
046100******************************************************************04610000
046200*  THIS IS THE MAIN CONTROLLING PARAGRAPH FOR PROCESSING THE     *04620000
046300*  PROCESS AREA CURRENT ON HAND REPORT                           *04630000
046400******************************************************************04640000
046500     IF (PC002-CURRENT-OPER NOT = PV-SAVE-CURR-OPER)              04650014
046600*DMB IF (PC002-CURRENT-OPER NOT = PV-SAVE-CURR-OPER) OR           04660014
046700*DMB    (PC002-CURRENT-FCLTY NOT = PV-SAVE-CURRENT-FCLTY)         04670013
046800         MOVE PC002-CURRENT-OPER TO PV-CURRENT-OPER               04680000
046900*        MOVE PV-CURRENT-OPER-3  TO PV-CURRENT-OPER-X-3           04690024
047000         PERFORM 2300-VALIDATE-OPER-UNIT                          04700000
047100         IF PS-VALID-DC                                           04710000
047200             IF  PV-LINE-CNT > PC-55                              04720000
047300                 PERFORM 8000-WRITE-REPORT-HEADERS                04730000
047400             END-IF                                               04740000
047500             IF  PS-NOT-FIRST-DETAIL-REC                          04750000
047600                 IF PS-NOT-HEADER-ONLY-REC                        04760000
047700                     PERFORM 8500-TRAILER-TOTAL                   04770004
047800                     PERFORM 8600-DATE-TOTAL                      04780000
047900                     PERFORM 8800-RECEIVING-TOTAL                 04790000
048000                     PERFORM 9000-PROCESS-TOTAL                   04800000
048100                     PERFORM 9200-PROCESS-GRAND-TOTAL             04810000
048200                     WRITE PC-CURRENT-ON-HAND-RECORD              04820000
048300                       FROM END-OF-REPORT-LINE                    04830000
048400                         AFTER ADVANCING 2 LINES                  04840000
048500                     MOVE PC002-SORT-FIELD TO                     04850015
048600                          SORT-FIELD-FORMAT2                      04860015
048700                     MOVE SCAC-2           TO                     04870015
048800                          PV-TRAILR-SCAC-ID                       04880015
048900                     MOVE TRAILER-NUMBER-2 TO                     04890015
049000                          PV-TRAILR-VEH-NBR                       04900015
049100                 ELSE                                             04910000
049200                     WRITE PC-CURRENT-ON-HAND-RECORD              04920000
049300                       FROM NO-DATA-TO-REPORT-LINE                04930000
049400                         AFTER ADVANCING 2 LINES                  04940000
049500                     WRITE PC-CURRENT-ON-HAND-RECORD              04950000
049600                       FROM END-OF-REPORT-LINE                    04960000
049700                         AFTER ADVANCING 2 LINES                  04970000
049800                 END-IF                                           04980000
049900             ELSE                                                 04990000
050000                 IF PS-HEADER-ONLY-REC                            05000000
050100                     WRITE PC-CURRENT-ON-HAND-RECORD              05010000
050200                       FROM NO-DATA-TO-REPORT-LINE                05020000
050300                         AFTER ADVANCING 2 LINES                  05030000
050400                     WRITE PC-CURRENT-ON-HAND-RECORD              05040000
050500                       FROM END-OF-REPORT-LINE                    05050000
050600                         AFTER ADVANCING 2 LINES                  05060000
050700                 END-IF                                           05070000
050800             END-IF                                               05080000
050900             MOVE PC002-PROCESS-AREA   TO PV-SAVE-PROCESS         05090000
051000             MOVE PC002-PRE-RECEIVED-IND                          05100000
051100                                    TO PV-SAVE-PRE-RECEIVED-IND   05110000
051200             IF PC002-PRE-RECEIVED                                05120000
051300                 MOVE PC-ENROUTE       TO DL1-RECEIVED-DATE       05130000
051400                 MOVE PC-ENRT          TO PV-RECEIVER-STATUS      05140000
051500                 MOVE PC002-REC-DATE   TO PV-SAVE-DATE            05150000
051600             ELSE                                                 05160000
051700                 MOVE PC002-REC-DATE   TO PV-DATE-DDMMYY          05170000
051800                                          PV-SAVE-DATE            05180000
051900                 MOVE '/'              TO PV-DATE-SLASH-1         05190000
052000                 MOVE '/'              TO PV-DATE-SLASH-2         05200000
052100                 MOVE PV-DATE-DDMMYY   TO DL1-RECEIVED-DATE       05210000
052200                 MOVE PC-HERE          TO PV-RECEIVER-STATUS      05220000
052300             END-IF                                               05230000
052400             MOVE PC002-CURRENT-OPER   TO HL1-OPER-UNIT           05240000
052500                                          PV-SAVE-CURR-OPER       05250000
052600             MOVE PC002-PROCESS-AREA   TO HL1-PROCESS             05260013
052700                                          PV-SAVE-PROCESS         05270013
052800*DMB         MOVE PC002-CURRENT-FCLTY  TO HL1-FACILITY            05280013
052900*DMB                                      PV-SAVE-CURR-FCLTY      05290013
053000             MOVE 0                    TO PV-PAGE-CNT             05300000
053100             PERFORM 8000-WRITE-REPORT-HEADERS                    05310000
053200             IF PC002-DETAIL-RECORD                               05320000
053300                 PERFORM 2100-WRITE-REPORT                        05330000
053400             END-IF                                               05340000
053500         END-IF                                                   05350000
053600         IF PC002-HEADER-RECORD                                   05360000
053700             SET PS-HEADER-ONLY-REC TO TRUE                       05370000
053800         ELSE                                                     05380000
053900             SET PS-NOT-HEADER-ONLY-REC TO TRUE                   05390000
054000         END-IF                                                   05400000
054100     END-IF.                                                      05410000
054200                                                                  05420000
054300     IF PS-END-OF-EXTRACT                                         05430000
054400         CONTINUE                                                 05440000
054500     ELSE                                                         05450000
054600     IF PS-VALID-DC AND                                           05460000
054700        PS-NOT-HEADER-ONLY-REC                                    05470001
054800         PERFORM 2100-WRITE-REPORT                                05480001
054900     ELSE                                                         05490001
055000         IF PS-PROCESS-EXTRACT                                    05500001
055100             MOVE PC002-TRAILER-TOTAL-CDE                         05510001
055200                        TO WS-HOLD-PREV-RECORD                    05520001
055300             PERFORM 2200-READ-EXTRACT                            05530001
055400         END-IF                                                   05540001
055500     END-IF                                                       05550001
055600     END-IF.                                                      05560001
055700                                                                  05570001
055800 2100-WRITE-REPORT.                                               05580001
055900                                                                  05590007
056000     MOVE PC002-SORT-FIELD TO SORT-FIELD-FORMAT2.                 05600007
056100                                                                  05610007
056200     IF PS-NOT-FIRST-PASS AND                                     05620001
056300        PS-NOT-FIRST-DETAIL-REC                                   05630001
056400         IF  PV-LINE-CNT > PC-55                                  05640001
056500             PERFORM 8000-WRITE-REPORT-HEADERS                    05650001
056600         END-IF                                                   05660001
056700                                                                  05670001
056800         IF PC002-CURRENT-OPER NOT = PV-SAVE-CURR-OPER            05680003
056900             PERFORM 8500-TRAILER-TOTAL                           05690004
057000             PERFORM 8600-DATE-TOTAL                              05700001
057100             PERFORM 8800-RECEIVING-TOTAL                         05710001
057200             PERFORM 9000-PROCESS-TOTAL                           05720001
057300             PERFORM 9200-PROCESS-GRAND-TOTAL                     05730001
057400             WRITE PC-CURRENT-ON-HAND-RECORD                      05740000
057500                 FROM END-OF-REPORT-LINE                          05750000
057600                     AFTER ADVANCING 2 LINES                      05760000
057700             PERFORM 8000-WRITE-REPORT-HEADERS                    05770000
057800         ELSE                                                     05780000
057900         IF PC002-PROCESS-AREA NOT = PV-SAVE-PROCESS              05790000
058000             PERFORM 8500-TRAILER-TOTAL                           05800004
058100             PERFORM 8600-DATE-TOTAL                              05810000
058200             PERFORM 8800-RECEIVING-TOTAL                         05820000
058300             PERFORM 9000-PROCESS-TOTAL                           05830000
058400*DMB 04/01                                                        05840014
058500             MOVE PC002-PROCESS-AREA   TO HL1-PROCESS             05850014
058600                                          PV-SAVE-PROCESS         05860014
058700*DMB 04/01                                                        05870014
058800             PERFORM 8000-WRITE-REPORT-HEADERS                    05880000
058900         ELSE                                                     05890000
059000             IF PC002-PRE-RECEIVED-IND NOT =                      05900000
059100                                         PV-SAVE-PRE-RECEIVED-IND 05910000
059200                 PERFORM 8500-TRAILER-TOTAL                       05920004
059300                 PERFORM 8600-DATE-TOTAL                          05930000
059400                 PERFORM 8800-RECEIVING-TOTAL                     05940000
059500             ELSE                                                 05950000
059600                 IF PC002-REC-DATE NOT = PV-SAVE-DATE             05960000
059700                     PERFORM 8500-TRAILER-TOTAL                   05970004
059800                     PERFORM 8600-DATE-TOTAL                      05980000
059900                 ELSE                                             05990000
060000                     IF SCAC-2 NOT = PV-TRAILR-SCAC-ID            06000000
060100                     OR  TRAILER-NUMBER-2 NOT = PV-TRAILR-VEH-NBR 06010000
060200                         PERFORM 8500-TRAILER-TOTAL               06020004
060300                     END-IF                                       06030000
060400                 END-IF                                           06040000
060500             END-IF                                               06050000
060600         END-IF                                                   06060000
060700     ELSE                                                         06070000
060800         SET PS-NOT-FIRST-PASS                                    06080000
060900             PS-NOT-FIRST-DETAIL-REC TO TRUE                      06090000
061000     END-IF.                                                      06100000
061100     MOVE PC002-PROCESS-AREA   TO DL1-PROCESS-AREA                06110000
061200                                  PV-SAVE-PROCESS.                06120000
061300     MOVE PC002-PRE-RECEIVED-IND                                  06130000
061400                               TO PV-SAVE-PRE-RECEIVED-IND.       06140000
061500     IF PC002-PRE-RECEIVED                                        06150000
061600         MOVE PC-ENROUTE       TO DL1-RECEIVED-DATE               06160000
061700         MOVE PC-ENRT          TO PV-RECEIVER-STATUS              06170000
061800         MOVE PC002-REC-DATE   TO PV-SAVE-DATE                    06180000
061900     ELSE                                                         06190000
062000         MOVE PC002-REC-DATE   TO PV-DATE-DDMMYY                  06200000
062100                                  PV-SAVE-DATE                    06210000
062200         MOVE '/'              TO PV-DATE-SLASH-1                 06220000
062300         MOVE '/'              TO PV-DATE-SLASH-2                 06230000
062400         MOVE PV-DATE-DDMMYY   TO DL1-RECEIVED-DATE               06240000
062500         MOVE PC-HERE          TO PV-RECEIVER-STATUS              06250000
062600     END-IF.                                                      06260000
062700     MOVE PC002-LOGICAL-OPER   TO DL1-OPER-UNIT.                  06270000
062800     MOVE PC002-PO-NBR         TO DL1-PO.                         06280000
062900     MOVE PC002-REC-SEQ-NBR    TO DL1-REC-SEQ.                    06290000
063000     MOVE PC002-LNE-LOC-CDE    TO DL1-LINE.                       06300000
063100     MOVE PC002-VNDR-NME       TO DL1-VENDOR.                     06310000
063200     MOVE PC002-DEPT-NBR       TO DL1-DEPT.                       06320000
063210*** PRB0064829 START                                              06321031
063300*    MOVE PC002-NEW-STR-IND    TO DL1-NEW-STR.                    06330031
063400*    MOVE PC002-AD-PICTURE-IND TO DL1-PIC-AD.                     06340031
063410     MOVE PC002-OPEN-TO-BUY-PERIOD                                06341031
063411                               TO DL1-OTB-MM-YY.                  06341131
063420     MOVE PC002-OPEN-TO-BUY-WEEK-NBR                              06342031
063430                               TO DL1-OTB-WK.                     06343031
063440*** PRB0064829 END                                                06344031
063500     MOVE PC002-SEASET-NM      TO DL1-SEASET.                     06350020
063600     STRING PC002-UNRESOLVED-TROUBLE DELIMITED BY SIZE            06360000
063700            PC002-MULTI-TROUBLE DELIMITED BY SIZE                 06370000
063800            ' ' DELIMITED BY SIZE                                 06380000
063900            PC002-LATEST-TROUBLE DELIMITED BY SIZE                06390000
064000            INTO DL1-TROUBLE.                                     06400000
064100     MOVE PC002-CART-CNT       TO DL1-CARTON-CNT.                 06410000
064200                                                                  06420000
064300     MOVE SCAC-2               TO PV-TRAILR-SCAC-ID.              06430000
064400     MOVE TRAILER-NUMBER-2     TO PV-TRAILR-VEH-NBR.              06440000
064500                                                                  06450000
064600     IF PC002-TRAILER-TOTAL-CDE = 'Y'                             06460006
064700        ADD PC002-CART-CNT     TO PV-TRAILR-CARTON-QTY            06470006
064800        ADD PC002-PKSL-ITM-QTY TO PV-TRAILR-ITEM-QTY              06480006
064900     END-IF                                                       06490006
065000                                                                  06500006
065100     ADD PC002-CART-CNT        TO PV-DATE-CARTON-QTY              06510000
065200                                  PV-RECEIVED-CARTON-QTY          06520000
065300                                  PV-PROCESS-CARTON-QTY           06530000
065400                                  PV-GRAND-CARTON-QTY.            06540000
065500     MOVE PC002-PKSL-ITM-QTY   TO DL1-PACKSLIP-QTY.               06550000
065600     ADD PC002-PKSL-ITM-QTY    TO PV-DATE-ITEM-QTY                06560000
065700                                  PV-RECEIVED-ITEM-QTY            06570000
065800                                  PV-PROCESS-ITEM-QTY             06580000
065900                                  PV-GRAND-ITEM-QTY.              06590000
066000     EVALUATE TRUE                                                06600000
066100     WHEN PC002-PACK-BY-STORE                                     06610000
066200         MOVE PC-PACK-BY-STORE TO DL1-PROCESS-IND                 06620000
066300     WHEN PC002-FULLCASE                                          06630000
066400         MOVE PC-FULLCASE      TO DL1-PROCESS-IND                 06640000
066500     WHEN PC002-PACK-TO-LIGHT                                     06650000
066600         MOVE PC-PACK-TO-LIGHT TO DL1-PROCESS-IND                 06660000
066700     WHEN PC002-FULLCASE-P2L                                      06670000
066800         MOVE PC-FULLCASE-P2L  TO DL1-PROCESS-IND                 06680000
066900     WHEN OTHER                                                   06690000
067000         MOVE SPACES           TO DL1-PROCESS-IND                 06700000
067100     END-EVALUATE.                                                06710000
067200     IF  PV-LINE-CNT > PC-60                                      06720009
067300         PERFORM 8000-WRITE-REPORT-HEADERS                        06730000
067400     END-IF                                                       06740000
067500     PERFORM 8400-WRITE-DETAIL-LINES                              06750000
067600     MOVE PC002-TRAILER-TOTAL-CDE                                 06760000
067700                     TO WS-HOLD-PREV-RECORD                       06770000
067800     IF PS-END-OF-EXTRACT                                         06780000
067900        CONTINUE                                                  06790000
068000     ELSE                                                         06800000
068100         PERFORM 2200-READ-EXTRACT                                06810000
068200     END-IF.                                                      06820000
068300                                                                  06830000
068400 2200-READ-EXTRACT.                                               06840000
068500     READ EXTRACT-FILE INTO PC002-RECEIVER-EXT-RECORD             06850000
068600        AT END                                                    06860000
068700           SET PS-END-OF-EXTRACT TO TRUE.                         06870000
068800                                                                  06880021
068900 2300-VALIDATE-OPER-UNIT.                                         06890000
069000******************************************************************06900021
069100* XLT_LOC (XLT00010)                                              06910025
069200* CALL LOCATION MODULE XLKUT071                                   06920021
069300******************************************************************06930021
069400                                                                  06940021
069500     INITIALIZE XL071-COMMAREA-REC.                               06950021
069600     MOVE PV-CURRENT-OPER            TO XL071-LOCATION-NUMBER.    06960024
069700                                                                  06970021
069800     CALL XL071-LOCATION-MODULE  USING XL071-COMMAREA-REC.        06980026
069900                                                                  06990021
070000        IF XL071-LOC-TYP-CDE = 'DC'                               07000021
070100           SET PS-VALID-DC             TO TRUE                    07010021
070200        ELSE                                                      07020021
070300           SET PS-INVALID-DC           TO TRUE                    07030021
070400        END-IF.                                                   07040022
070500                                                                  07050022
070600*                                                                 07060000
070700 8000-WRITE-REPORT-HEADERS.                                       07070000
070800******************************************************************07080000
070900*  PRINT THE HEADING FOR THE FIRST PAGE OF AN ASN.  SEBSEQUENT   *07090000
071000*  PAGES FOR THE SAME ASN DO NOT REPEAT ALL OF THE HEADING INFO. *07100000
071100******************************************************************07110000
071200     PERFORM 8200-WRITE-TOP-LINE.                                 07120000
071300*                                                                 07130000
071400     WRITE PC-CURRENT-ON-HAND-RECORD                              07140000
071500       FROM HEADING-LINE-1                                        07150000
071600         AFTER ADVANCING 2 LINE.                                  07160000
071700*                                                                 07170000
071800     WRITE PC-CURRENT-ON-HAND-RECORD                              07180000
071900       FROM HEADING-LINE-2                                        07190000
072000         AFTER ADVANCING 2 LINES.                                 07200000
072100*                                                                 07210000
072200     WRITE PC-CURRENT-ON-HAND-RECORD                              07220000
072300       FROM HEADING-LINE-3                                        07230000
072400         AFTER ADVANCING 1 LINES.                                 07240000
072500*                                                                 07250000
072600     MOVE PC-6            TO PV-LINE-CNT.                         07260000
072700     MOVE PC-2            TO PV-LINE-SUB.                         07270000
072800*                                                                 07280000
072900*                                                                 07290000
073000 8200-WRITE-TOP-LINE.                                             07300000
073100******************************************************************07310000
073200*     WRITES HEADER LINES 0 AND 1 WHEN MORE THAN ONE PAGE IS     *07320000
073300*     NEEDED FOR AN ASN NUMBER.                                  *07330000
073400******************************************************************07340000
073500     ADD 1                        TO PV-PAGE-CNT.                 07350000
073600*                                                                 07360000
073700     MOVE PV-PAGE-CNT             TO DP132O-PAGE-NUMBER.          07370000
073800*                                                                 07380000
073900     WRITE PC-CURRENT-ON-HAND-RECORD                              07390000
074000       FROM DP132O-STANDRD-HEADER-132-COLS                        07400000
074100         AFTER ADVANCING PAGE.                                    07410000
074200*                                                                 07420000
074300*                                                                 07430000
074400 8400-WRITE-DETAIL-LINES.                                         07440000
074500******************************************************************07450000
074600*     WRITES THE DETAIL LINE INFORMATION.                        *07460000
074700******************************************************************07470000
074800     WRITE PC-CURRENT-ON-HAND-RECORD                              07480000
074900       FROM DETAIL-LINE1                                          07490000
075000         AFTER ADVANCING PV-LINE-SUB LINES.                       07500000
075100*                                                                 07510000
075200     ADD PV-LINE-SUB                 TO PV-LINE-CNT.              07520000
075300     MOVE PC-1                       TO PV-LINE-SUB.              07530000
075400 8500-TRAILER-TOTAL.                                              07540004
075500******************************************************************07550004
075600*     WRITES THE TRAILER TOTAL LINE                              *07560004
075700******************************************************************07570004
075800     IF WS-HOLD-PREV-RECORD = 'Y'                                 07580004
075900        MOVE PV-TRAILR-SCAC-ID      TO TL1-TRAILR-SCAC-ID         07590004
076000        MOVE PV-TRAILR-VEH-NBR      TO TL1-TRAILR-VEH-NBR         07600004
076100        MOVE PV-TRAILR-CARTON-QTY   TO TL1-TRAILR-CARTON-QTY      07610004
076200        MOVE PV-TRAILR-ITEM-QTY     TO TL1-TRAILR-ITEM-QTY        07620004
076300                                                                  07630004
076400        WRITE PC-CURRENT-ON-HAND-RECORD                           07640004
076500          FROM TOTAL-LINE-1                                       07650004
076600            AFTER ADVANCING 2 LINES                               07660004
076700                                                                  07670004
076800     ADD PC-2                        TO PV-LINE-CNT               07680004
076900     MOVE PC-2                       TO PV-LINE-SUB               07690004
077000     MOVE ZERO                       TO PV-TRAILR-CARTON-QTY      07700004
077100                                        PV-TRAILR-ITEM-QTY        07710004
077200     ELSE                                                         07720004
077300       NEXT SENTENCE                                              07730004
077400     END-IF.                                                      07740004
077500 8600-DATE-TOTAL.                                                 07750000
077600******************************************************************07760000
077700*     WRITES THE DATE TOTAL LINE                                 *07770000
077800******************************************************************07780000
077900     MOVE PV-DATE-CARTON-QTY     TO TL2-DATE-CARTON-QTY.          07790004
078000     MOVE PV-DATE-ITEM-QTY       TO TL2-DATE-ITEM-QTY.            07800004
078100     WRITE PC-CURRENT-ON-HAND-RECORD                              07810000
078200       FROM TOTAL-LINE-2                                          07820004
078300         AFTER ADVANCING 2 LINES.                                 07830000
078400                                                                  07840000
078500     ADD PC-2                        TO PV-LINE-CNT.              07850000
078600     MOVE PC-2                       TO PV-LINE-SUB.              07860000
078700     MOVE ZERO                       TO PV-DATE-CARTON-QTY        07870000
078800                                        PV-DATE-ITEM-QTY.         07880000
078900*                                                                 07890000
079000 8800-RECEIVING-TOTAL.                                            07900000
079100******************************************************************07910000
079200*     WRITES THE RECEIVED TOTAL LINE                             *07920000
079300******************************************************************07930000
079400     IF  PV-SAVE-PRE-RECEIVED                                     07940000
079500         MOVE PC-ENROUTE-TOTAL   TO TL3-RECEIVED-TOTAL-DESC       07950000
079600     ELSE                                                         07960000
079700         MOVE PC-RECEIVE-TOTAL   TO TL3-RECEIVED-TOTAL-DESC       07970000
079800     END-IF.                                                      07980000
079900     MOVE PV-RECEIVED-CARTON-QTY TO TL3-RECEIVED-CARTON-QTY.      07990000
080000     MOVE PV-RECEIVED-ITEM-QTY   TO TL3-RECEIVED-ITEM-QTY.        08000000
080100     WRITE PC-CURRENT-ON-HAND-RECORD                              08010000
080200       FROM TOTAL-LINE-3                                          08020000
080300         AFTER ADVANCING 2 LINES.                                 08030000
080400                                                                  08040000
080500     ADD PC-2                        TO PV-LINE-CNT.              08050000
080600     MOVE PC-2                       TO PV-LINE-SUB.              08060000
080700     MOVE ZERO                       TO PV-RECEIVED-CARTON-QTY    08070000
080800                                        PV-RECEIVED-ITEM-QTY.     08080000
080900                                                                  08090000
081000 9000-PROCESS-TOTAL.                                              08100000
081100******************************************************************08110000
081200*     WRITES THE PROCESS TOTAL LINE                              *08120000
081300******************************************************************08130000
081400     MOVE PV-PROCESS-CARTON-QTY  TO TL4-PROCESS-CARTON-QTY.       08140000
081500     MOVE PV-PROCESS-ITEM-QTY    TO TL4-PROCESS-ITEM-QTY.         08150000
081600     WRITE PC-CURRENT-ON-HAND-RECORD                              08160000
081700       FROM TOTAL-LINE-4                                          08170000
081800         AFTER ADVANCING 2 LINES.                                 08180000
081900                                                                  08190000
082000     ADD PC-2                        TO PV-LINE-CNT.              08200000
082100     MOVE PC-2                       TO PV-LINE-SUB.              08210000
082200     MOVE ZERO                       TO PV-PROCESS-CARTON-QTY     08220000
082300                                        PV-PROCESS-ITEM-QTY.      08230000
082400                                                                  08240000
082500 9200-PROCESS-GRAND-TOTAL.                                        08250000
082600******************************************************************08260000
082700*     WRITES THE GRAND TOTAL LINE                                *08270000
082800******************************************************************08280000
082900     MOVE PV-GRAND-CARTON-QTY    TO TL5-GRAND-CARTON-QTY.         08290000
083000     MOVE PV-GRAND-ITEM-QTY      TO TL5-GRAND-ITEM-QTY.           08300000
083100     WRITE PC-CURRENT-ON-HAND-RECORD                              08310000
083200       FROM TOTAL-LINE-5                                          08320000
083300         AFTER ADVANCING 2 LINES.                                 08330000
083400                                                                  08340000
083500     ADD PC-2                        TO PV-LINE-CNT.              08350000
083600     MOVE PC-2                       TO PV-LINE-SUB.              08360000
083700     MOVE ZERO                       TO PV-GRAND-CARTON-QTY       08370000
083800                                        PV-GRAND-ITEM-QTY.        08380000
083900                                                                  08390000
084000******************************************************************08400000
084100*     SQL WARNING OR ERROR PROCESSING                            *08410000
084200*                                                                *08420000
084300******************************************************************08430000
084400                                                                  08440000
084500*                                                                 08450000
084600 Z999-SQL-ERROR.                                                  08460000
084700*---------------                                                  08470000
084800                                                                  08480000
084900     MOVE SQLCODE    TO SQLCODE2.                                 08490000
085000     MOVE SQLERRD(3) TO SQLERRD3.                                 08500000
085100     DISPLAY '** ABEND **       ** = SQLERROR'.                   08510000
085200     DISPLAY '** PROGRAM        ** = PCKRP002'.                   08520000
085300     DISPLAY '** SQLCODE        ** = ' SQLCODE2.                  08530000
085400     DISPLAY '** SQLERRM        ** = ' SQLERRM.                   08540000
085500     DISPLAY '** SQLERRMC       ** = ' SQLERRMC.                  08550000
085600     MOVE +4013 TO PV-ABEND-CODE.                                 08560000
085700     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         08570000
085800*                                                                 08580000
