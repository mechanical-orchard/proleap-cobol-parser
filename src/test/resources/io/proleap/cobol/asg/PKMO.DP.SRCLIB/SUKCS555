000100*-----------------------*                                         00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300*-----------------------*                                         00030000
000400*--------------------------------------------------------------*  00040000
000500* HIGHLIGHT -                                                  *  00050000
000600*    PACK ID - YELLOW - ODD UNIT PREPACK (NOT FULL PACKS)      *  00060000
000700*    SSCC - YELLOW - INVALID UPC IN CARTON NOT IN SYSTEM       *  00070000
000800*         - RED - INVALID UPC IN CARTON - NOT PART OF PREPACK  *  00080000
000900*--------------------------------------------------------------*  00090000
001000 PROGRAM-ID.    SUKCS555.                                         00100000
001100 AUTHOR.        DENISE HAHN.                                      00110000
001200 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00120000
001300 DATE-WRITTEN.  APRIL, 2000.                                      00130000
001400 DATE-COMPILED.                                                   00140000
001500                                                                  00150000
001600*---------------------------------------------------------------* 00160000
001700*    S555 - PO/RECEIVER/LINE CARTON LIST PROGRAM                * 00170000
001800*                                                               * 00180000
001900*    (NOTE:THIS PROGRAM IS A COPY OF SUKCS553)                  * 00190000
002000*                                                               * 00200000
002100*    THIS PROGRAM CREATES A SCREEN THAT WILL LIST ALL CARTONS   * 00210000
002200*    (SERIAL SHIP CODES) FOR A PO/RCVR/LNE.  THE SCREEN CAN     * 00220000
002300*    BE ACCESSED FROM THE FOLLOWING SCREENS:                    * 00230000
002400*    ---> CASEPACK SPLIT SCREEN           (F14) PCKCS701        * 00240000
002500*    ---> UNRESOLVED FREE-ASTRAY SCREEN   (F23) SUKCS761        * 00250000
002600*    ---> PACK SLIP HEADER INQUIRY SCREEN (F23) RCKCS267        * 00260000
002700*    ---> PACK SLIP LINE SUMMARY SCREEN   (F24) RCKCS215        * 00270000
002800*---------------------------------------------------------------* 00280000
001500*    CHANGES                                                     *00282009
      *    MADE BY: CHERI PARMLEY                                      *00283009
      *    DATE:    09/24/2014                                         *00284009
      *                                                                *00285009
      *    CHANGES TO INCREASE SIZE OF PO# FROM 7 TO 8 DIGITS          *00286010
      *    TAGGED WITH *CLP 09/24/14                                   *00287011
      *                                                                *00288009
001600*----------------------------------------------------------------*00289009
263968* CHANGED 11/15/2021    BY JIM HUNTER      WR: CHG0263968         00289212
263968* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00289312
263968* MAKING THE CALL DYNAMIC VS STATIC.                              00289412
001130*                                                                 00289513
001110* CHANGED 01/09/2023    BY JEAN KURK       WR: CHG0278099         00289613
001120* CHANGE CALL OF DPKCS030 TO BE DYNAMIC                           00289713
263968*---------------------------------------------------------------* 00289812
002900*                                                                 00290000
003000 ENVIRONMENT DIVISION.                                            00300000
003100                                                                  00310000
003200 DATA DIVISION.                                                   00320000
003300                                                                  00330000
003400 WORKING-STORAGE SECTION.                                         00340000
003500                                                                  00350000
003600 01  DK-DB2-KEYS.                                                 00360000
003700     05  DK-OPER-UNT-ID                 PIC S9(04) COMP VALUE +0. 00370000
003800     05  DK-FCLTY-ID                    PIC S9(04) COMP VALUE +0. 00380000
003900     05  DK-SCAC-ID                     PIC  X(04).               00390000
004000     05  DK-VEH-NBR                     PIC  X(10).               00400000
004100     05  DK-TRIP-ID                     PIC S9(09) COMP VALUE +0. 00410000
004200     05  DK-PO-NBR                      PIC S9(09) COMP VALUE +0. 00420000
004300     05  DK-REC-SEQ-NBR                 PIC S9(09) COMP VALUE +0. 00430000
004400     05  DK-LINE-NBR                    PIC S9(09) COMP VALUE +0. 00440000
004500     05  DK-CTN                         PIC S9(18)V COMP-3.       00450000
004600     05  DK-PREPK-ID                    PIC S9(04)  COMP.         00460000
004700     05  DK-SEQ-NBR                     PIC S9(04)  COMP.         00470000
004800     05  DK-SHIPT-UNT-ID                PIC S9(18)V COMP-3.       00480000
004900                                                                  00490000
005000 01  PC-PROGRAM-CONSTANTS.                                        00500000
005100     05  PC-MAX-LINE-TABLE-ROWS         PIC  S9(04)  VALUE +1500  00510000
005200                                             COMP SYNC.           00520000
005300     05  PC-PRINTER-DEST                PIC  X(05)  VALUE SPACE.  00530000
005400                                                                  00540000
005500     05  PC-CURRENT-MAP-NAME            PIC  X(08)  VALUE         00550000
005600                                                    'SUK555  '.   00560000
005700     05  PC-CURRENT-MAPSET-NAME         PIC  X(08)  VALUE         00570000
005800                                                    'SUKM555 '.   00580000
005900     05  PC-CURRENT-PROGRAM-NAME        PIC  X(08)  VALUE         00590000
006000                                                    'SUKCS555'.   00600000
006100     05  PC-LIST-QUEUE-SEQ              PIC  9(01)  VALUE 1.      00610000
006200     05  PC-SEL-QUEUE-SEQ               PIC  9(01)  VALUE 2.      00620000
006300                                                                  00630000
006400     05  PC-INTER-APPL-CODES.                                     00640000
006500         10  PC-CRIT-SPEC-FORMAT        PIC  X(01)  VALUE '1'.    00650000
006600         10  PC-LIST-FORMAT             PIC  X(01)  VALUE '2'.    00660000
006700         10  PC-PKSLHDR-FORMAT          PIC  X(01)  VALUE '3'.    00670000
006800         10  PC-PKSLLNE-FORMAT          PIC  X(01)  VALUE '4'.    00680000
006900         10  PC-FREE-ASTRAY-FORMAT      PIC  X(01)  VALUE '5'.    00690000
007000         10  PC-RCVG-SIMPLE-FORMAT      PIC  X(01)  VALUE '6'.    00700000
007100         10  PC-SUSPEND-VE-FORMAT       PIC  X(01)  VALUE '7'.    00710000
007200                                                                  00720000
007300     05  PC-ITEMS-PER-PANEL             PIC S9(04)  VALUE +12     00730000
007400                                                    COMP SYNC.    00740000
007500     05  PC-MAX-ITEMS                   PIC S9(09) VALUE +1000000 00750000
007600                                                    COMP-3.       00760000
007700     05  PC-MAX-BLOCKS-IN-ARRAY         PIC S9(04)  VALUE +2      00770000
007800                                                    COMP SYNC.    00780000
007900     05  PC-MSG-NUMBER-LENGTH           PIC S9(04)  VALUE +5      00790000
008000                                                    COMP SYNC.    00800000
008100     05  PC-MAX-RETRIES                 PIC S9(03)  VALUE 3       00810000
008200                                                    COMP-3.       00820000
008300     05  PC-INQ                         PIC  X(03)  VALUE 'INQ'.  00830000
008400     05  PC-UPD                         PIC  X(03)  VALUE 'UPD'.  00840000
008500     05  PC-DEL                         PIC  X(03)  VALUE 'DEL'.  00850000
008600     05  PC-ERR                         PIC  X(03)  VALUE 'ERR'.  00860000
008700     05  PC-NEW                         PIC  X(02)  VALUE 'NW'.   00870000
008800     05  PC-SLASH                       PIC  X(01)  VALUE '/'.    00880000
008900     05  PC-COLON                       PIC  X(01)  VALUE ':'.    00890000
009000     05  PC-ZERO                        PIC  S9(04) VALUE ZERO    00900000
009100                                                    COMP.         00910000
009200     05  PC-PREPACK-MSG                 PIC  X(37)  VALUE         00920000
009300                         'ODD CARTONS ARE HIGHLIGHTED IN YELLOW'. 00930000
009400     05  PC-PACK-HDG                    PIC  X(04)  VALUE 'PACK'. 00940000
009500     05  PC-ID-HDG                      PIC  X(04)  VALUE ' ID '. 00950000
009600     05  PC-LINE-HDG                    PIC  X(04)  VALUE 'LINE'. 00960000
009700     05  PC-NMBR-HDG                    PIC  X(04)  VALUE 'NMBR'. 00970000
009800     05  PC-01                     PIC  X(02)  VALUE '01'.        00980000
009900     05  PC-A                      PIC  X(01)  VALUE 'A'.         00990000
010000*                                                                 01000000
010100*                                                                 01010000
010200*----------------------------------------------------------------*01020000
010300*  DESCRIPTION CONSTANTS                                         *01030000
010400*----------------------------------------------------------------*01040000
010500*                                                                 01050000
010600*----------------------------------------------------------------*01060000
010700*  SYSTEM MESSAGES                                               *01070000
010800*----------------------------------------------------------------*01080000
010900*   00005 = INVALID VALUE                                        *01090000
011000*   00007 = REQUIRED ENTRY                                       *01100000
011100*   00008 = MUST BE NUMERIC                                      *01110000
011200*   00050 - NO LIST ITEMS WERE FOUND FOR THE CRITERIA SPECIFIED  *01120000
011300*   00051 - NO END OF RANGE HAS BEEN SPECIFIED                   *01130000
011400*   00052 - END OF RANGE PRECEDES START OF RANGE                 *01140000
011500*   00053 - NO START OF RANGE HAS BEEN SPECIFIED                 *01150000
011600*   00054 - ONLY ONE START OF RANGE INDICATOR MAY BE SPECIFIED   *01160000
011700*   00055 - ONLY ONE END OF RANGE INDICATOR MAY BE SPECIFIED     *01170000
011800*   00057 - A LIST ITEM MUST BE SELECTED FOR THIS FUNCTION       *01180000
011900*   00069 - TOP OF LIST                                          *01190000
012000*   00070 - BOTTOM OF LIST                                       *01200000
012100*   00101 - VALUE MUST BE > ZERO AND  < 1,000,000                *01210000
012200*   00551 - WAIT 15 SECONDS;RETRY FUNCTION AGAIN; IF UNSUCCESSFUL*01220000
012300*   00279 - MORE ITEMS TO DISPLAY                                *01230000
012400*   00984 - DATABASE IS BUSY, TRY AGAIN IN A FEW MINUTES         *01240000
012500*   02227 = APPLICATION UNAVAILABLE AT THIS TIME                 *01250000
012600*   02234 = PRINT REQUEST HAS BEEN COMPLETED FOR SELECTED LIME(S)*01260000
012700*   02238 = PRINT PROBLEM, TRY AGAIN - LINES UP TO THIS POINT    *01270000
012800*   02245 = CANNOT UPDATE ACTUAL UNITS - PULL LINE ITEM HAS BEEN *01280000
012900*   02252 = UPDATE REQUEST HAS BEEN COMPLETED FOR SELECTED LINE(S*01290000
013000*   02307 - YOU DO NOT HAVE AUTHORITY TO CANCEL/UNCANCEL          01300000
013100*   02308 - YOU DO NOT HAVE AUTHORITY TO CONFIRM/UNCONFIRM DISTRIB01310000
013200*   99901 = INVALID COMMAND WAS ENTERED                          *01320000
013300*----------------------------------------------------------------*01330000
013400     05  PC-TSYMSG-NUMBERS.                                       01340000
013500         10  PC-TSYMSG-00005            PIC  9(05)  VALUE 00005.  01350000
013600         10  PC-TSYMSG-00007            PIC  9(05)  VALUE 00007.  01360000
013700         10  PC-TSYMSG-00008            PIC  9(05)  VALUE 00008.  01370000
013800         10  PC-TSYMSG-00050            PIC  9(05)  VALUE 00050.  01380000
013900         10  PC-TSYMSG-00051            PIC  9(05)  VALUE 00051.  01390000
014000         10  PC-TSYMSG-00052            PIC  9(05)  VALUE 00052.  01400000
014100         10  PC-TSYMSG-00053            PIC  9(05)  VALUE 00053.  01410000
014200         10  PC-TSYMSG-00054            PIC  9(05)  VALUE 00054.  01420000
014300         10  PC-TSYMSG-00055            PIC  9(05)  VALUE 00055.  01430000
014400         10  PC-TSYMSG-00057            PIC  9(05)  VALUE 00057.  01440000
014500         10  PC-TSYMSG-00069            PIC  9(05)  VALUE 00069.  01450000
014600         10  PC-TSYMSG-00070            PIC  9(05)  VALUE 00070.  01460000
014700         10  PC-TSYMSG-00101            PIC  9(05)  VALUE 00101.  01470000
014800         10  PC-TSYMSG-00279            PIC  9(05)  VALUE 00279.  01480000
014900         10  PC-TSYMSG-00551            PIC  9(05)  VALUE 00551.  01490000
015000         10  PC-TSYMSG-00743            PIC  9(05)  VALUE 00743.  01500000
015100         10  PC-TSYMSG-00746            PIC  9(05)  VALUE 00746.  01510000
015200         10  PC-TSYMSG-01563            PIC  9(05)  VALUE 01563.  01520000
015300         10  PC-TSYMSG-00984            PIC  9(05)  VALUE 00984.  01530000
015400         10  PC-TSYMSG-02227            PIC  9(05)  VALUE 02227.  01540000
015500         10  PC-TSYMSG-02234            PIC  9(05)  VALUE 02234.  01550000
015600         10  PC-TSYMSG-02238            PIC  9(05)  VALUE 02238.  01560000
015700         10  PC-TSYMSG-02245            PIC  9(05)  VALUE 02245.  01570000
015800         10  PC-TSYMSG-02252            PIC  9(05)  VALUE 02252.  01580000
015900         10  PC-TSYMSG-02307            PIC  9(05)  VALUE 02307.  01590000
016000         10  PC-TSYMSG-02308            PIC  9(05)  VALUE 02308.  01600000
016100         10  PC-TSYMSG-99901            PIC  9(05)  VALUE 99901.  01610000
016200                                                                  01620000
016300 01  PS-PROGRAM-SWITCHES.                                         01630000
016400     05  PS-MATCH-PACKS-SW              PIC  X(01)  VALUE 'N'.    01640000
016500         88  PS-MATCH-PACKS-YES                     VALUE 'Y'.    01650000
016600         88  PS-MATCH-PACKS-NO                      VALUE 'N'.    01660000
016700*                                                                 01670000
016800     05  PS-VALID-LINE-SW               PIC  X(01)  VALUE 'N'.    01680000
016900         88  PS-VALID-LINE                          VALUE 'Y'.    01690000
017000         88  PS-VALID-LINE-NO                       VALUE 'N'.    01700000
017100*                                                                 01710000
017200     05  PS-EOF-LINE-CURSOR-SW          PIC  X(01)  VALUE 'N'.    01720000
017300         88  PS-EOF-LINE-CURSOR                     VALUE 'Y'.    01730000
017400         88  PS-EOF-LINE-CURSOR-NO                  VALUE 'N'.    01740000
017500*                                                                 01750000
017600     05  PS-MULT-LINE-SW                PIC  X(01)  VALUE 'N'.    01760000
017700         88  PS-MULT-LINE                           VALUE 'Y'.    01770000
017800         88  PS-MULT-LINE-NO                        VALUE 'N'.    01780000
017900*                                                                 01790000
018000     05  PS-MULT-PACK-SW                PIC  X(01)  VALUE 'N'.    01800000
018100         88  PS-MULT-PACK                           VALUE 'Y'.    01810000
018200         88  PS-MULT-PACK-NO                        VALUE 'N'.    01820000
018300*                                                                 01830000
018400     05  PS-ERROR-SW                    PIC  X(01)  VALUE 'Y'.    01840000
018500         88  PS-NO-ERROR                            VALUE 'Y'.    01850000
018600         88  PS-ERROR                               VALUE 'N'.    01860000
018700*                                                                 01870000
018800     05  PS-SOFT-ABORT-ERROR-SW         PIC  X(01)  VALUE 'N'.    01880000
018900         88  PS-SOFT-ABORT-ERROR                    VALUE 'Y'.    01890000
019000         88  PS-NO-SOFT-ABORT-ERROR                 VALUE 'N'.    01900000
019100*                                                                 01910000
019200     05  PS-BLOCK-ERROR-SW              PIC  X(01)  VALUE 'Y'.    01920000
019300         88  PS-NO-BLOCK-ERROR                      VALUE 'Y'.    01930000
019400         88  PS-BLOCK-ERROR                         VALUE 'N'.    01940000
019500*                                                                 01950000
019600     05  PS-COMMAREA-SW                 PIC  X(01)  VALUE 'N'.    01960000
019700         88  PS-COMMAREA-VALID                      VALUE 'Y'.    01970000
019800         88  PS-COMMAREA-NOT-VALID                  VALUE 'N'.    01980000
019900*                                                                 01990000
020000     05  PS-EO-CARTON-CSR-SW            PIC  X(01)  VALUE  'N'.   02000000
020100         88  PS-EO-CARTON-CSR                       VALUE  'Y'.   02010000
020200         88  PS-NOT-EO-CARTON-CSR                   VALUE  'N'.   02020000
020300*                                                                 02030000
020400     05  PS-EO-SHIPT-CSR-SW             PIC  X(01)  VALUE  'N'.   02040000
020500         88  PS-EO-SHIPT-CSR                        VALUE  'Y'.   02050000
020600         88  PS-NOT-EO-SHIPT-CSR                    VALUE  'N'.   02060000
020700*                                                                 02070000
020800     05  PS-EOF-STATUS-CURSOR-SW        PIC  X(01)  VALUE  'N'.   02080000
020900         88  PS-EOF-STATUS-CURSOR                   VALUE  'Y'.   02090000
021000         88  PS-NOT-EOF-STATUS-CURSOR               VALUE  'N'.   02100000
021100*                                                                 02110000
021200     05  PS-USE-SHIPT-CSR-SW            PIC  X(01)  VALUE  'N'.   02120000
021300         88  PS-USE-SHIPT-CSR                       VALUE  'Y'.   02130000
021400*                                                                 02140000
021500     05  PS-CARTON-CSR-SW               PIC  X(01)  VALUE  'N'.   02150000
021600         88  PS-CARTON-CSR-FIRST                    VALUE  'Y'.   02160000
021700         88  PS-NOT-CARTON-CSR-FIRST                VALUE  'N'.   02170000
021800*                                                                 02180000
021900     05  PS-ODD-CSR-SW                  PIC  X(01)  VALUE  'N'.   02190000
022000         88  PS-END-ODD-CSR                         VALUE  'Y'.   02200000
022100         88  PS-NOT-END-ODD-CSR                     VALUE  'N'.   02210000
022200*                                                                 02220000
022300     05  PS-EO-PACKSLIP-LINE-CSR-SW     PIC  X(01)  VALUE  'N'.   02230000
022400         88  PS-EO-PACKSLIP-LINE-CSR                VALUE  'Y'.   02240000
022500         88  PS-NOT-EO-PACKSLIP-LINE-CSR            VALUE  'N'.   02250000
022600*                                                                 02260000
022700     05  PS-EO-ALL-LINES-CSR-SW         PIC  X(01)  VALUE  'N'.   02270000
022800         88  PS-EO-ALL-LINES-CSR                    VALUE  'Y'.   02280000
022900         88  PS-NOT-EO-ALL-LINES-CSR                VALUE  'N'.   02290000
023000*                                                                 02300000
023100     05  PS-EO-FREE-ASTRAY-CSR-SW       PIC  X(01)  VALUE  'N'.   02310000
023200         88  PS-EO-FREE-ASTRAY-CSR                  VALUE  'Y'.   02320000
023300         88  PS-NOT-EO-FREE-ASTRAY-CSR              VALUE  'N'.   02330000
023400*                                                                 02340000
023500     05  PS-EO-TRAN-PREPK-CSR-SW        PIC  X(01)  VALUE  'N'.   02350000
023600         88  PS-EO-TRAN-PREPK-CSR                   VALUE  'Y'.   02360000
023700         88  PS-NOT-EO-TRAN-PREPK-CSR               VALUE  'N'.   02370000
023800*                                                                 02380000
023900     05  PS-EO-PO-TRAN-PREPK-CSR-SW     PIC  X(01)  VALUE  'N'.   02390000
024000         88  PS-EO-PO-TRAN-PREPK-CSR                VALUE  'Y'.   02400000
024100         88  PS-NOT-EO-PO-TRAN-PREPK-CSR            VALUE  'N'.   02410000
024200*                                                                 02420000
024300     05  PS-EO-NOT-TRAN-PREPK-CSR-SW    PIC  X(01)  VALUE  'N'.   02430000
024400         88  PS-EO-NOT-TRAN-PREPK-CSR               VALUE  'Y'.   02440000
024500         88  PS-NOT-EO-NOT-TRAN-PREPK-CSR           VALUE  'N'.   02450000
024600*                                                                 02460000
024700     05  PS-EO-PO-NOT-TRN-PPK-CSR-SW    PIC  X(01)  VALUE  'N'.   02470000
024800         88  PS-EO-PO-NOT-TRN-PPK-CSR               VALUE  'Y'.   02480000
024900         88  PS-NOT-EO-PO-NOT-TRN-PPK-CSR           VALUE  'N'.   02490000
025000*                                                                 02500000
025100     05  PS-EO-NON-PREPK-CSR-SW         PIC  X(01)  VALUE  'N'.   02510000
025200         88  PS-EO-NON-PREPK-CSR                    VALUE  'Y'.   02520000
025300         88  PS-NOT-EO-NON-PREPK-CSR                VALUE  'N'.   02530000
025400*                                                                 02540000
025500     05  PS-EO-PO-NON-PREPK-CSR-SW      PIC  X(01)  VALUE  'N'.   02550000
025600         88  PS-EO-PO-NON-PREPK-CSR                 VALUE  'Y'.   02560000
025700         88  PS-NOT-EO-PO-NON-PREPK-CSR             VALUE  'N'.   02570000
025800*                                                                 02580000
025900     05  PS-EO-PBS-CSR-SW               PIC  X(01)  VALUE  'N'.   02590000
026000         88  PS-EO-PBS-CSR                          VALUE  'Y'.   02600000
026100         88  PS-NOT-EO-PBS-CSR                      VALUE  'N'.   02610000
026200*                                                                 02620000
026300     05  PS-EO-PO-PBS-CSR-SW            PIC  X(01)  VALUE  'N'.   02630000
026400         88  PS-EO-PO-PBS-CSR                       VALUE  'Y'.   02640000
026500         88  PS-NOT-EO-PO-PBS-CSR                   VALUE  'N'.   02650000
026600*                                                                 02660000
026700     05  PS-EO-UPC-CSR-SW               PIC  X(01)  VALUE  'N'.   02670000
026800         88  PS-EO-UPC-CSR                          VALUE  'Y'.   02680000
026900         88  PS-NOT-EO-UPC-CSR                      VALUE  'N'.   02690000
027000*                                                                 02700000
027100     05  PS-UNEVEN-PACK-SW              PIC  X(01)  VALUE  'N'.   02710000
027200         88  PS-UNEVEN-PACK                         VALUE  'Y'.   02720000
027300         88  PS-EVEN-PACK                           VALUE  'N'.   02730000
027400*                                                                 02740000
027500     05  PS-LIST-END-SW                 PIC  X(01)  VALUE 'N'.    02750000
027600         88  PS-LIST-END                            VALUE 'Y'.    02760000
027700         88  PS-NO-LIST-END                         VALUE 'N'.    02770000
027800*                                                                 02780000
027900     05  PS-NO-PO-SW                    PIC  X(01)  VALUE 'N'.    02790000
028000         88  PS-NO-PO                               VALUE 'Y'.    02800000
028100*                                                                 02810000
028200 01  PV-PROGRAM-VARIABLES.                                        02820000
028300     05  PV-TBL-UNITS                   PIC  9(09)  VALUE ZEROS.  02830000
028400     05  PV-TBL-PACKS                   PIC  9(09)  VALUE ZEROS.  02840000
028500     05  PV-LINE-TABLE-ROWS             PIC  9(04)  VALUE ZEROS.  02850000
028600     05  PV-CICS-RESPONSE               PIC S9(08)  VALUE ZEROS   02860000
028700                                        COMP SYNC.                02870000
028800     05  PV-SUB                         PIC S9(04)  VALUE +0      02880000
028900                                                    COMP SYNC.    02890000
029000     05  PV-REMAINDER                   PIC S9(04)  VALUE +0      02900000
029100                                                    COMP SYNC.    02910000
029200     05  PV-READ-COUNT                  PIC S9(09)  VALUE +0      02920000
029300                                                    COMP-3.       02930000
029400     05  PV-ORIGINAL-BLOCK              PIC S9(04)  VALUE +0      02940000
029500                                                    COMP SYNC.    02950000
029600     05  PV-ITEMS-HOLD                  PIC S9(03)  COMP-3.       02960000
029700     05  PV-ITEMS-DIFF                  PIC S9(03)  COMP-3.       02970000
029800     05  PV-ITEMS-PROCESSED             PIC S9(09)  VALUE +0      02980000
029900                                                    COMP-3.       02990000
030000     05  PV-HOLD-SELECTED-ITEMS         PIC S9(09)  VALUE +0      03000000
030100                                                    COMP-3.       03010000
030200     05  PV-ITEM-IN-USE                 PIC S9(09)  VALUE +0      03020000
030300                                                    COMP-3.       03030000
030400     05  PV-TOP-ITEM                    PIC S9(09)  VALUE +0      03040000
030500                                                    COMP-3.       03050000
030600     05  PV-BOTTOM-ITEM                 PIC S9(09)  VALUE +0      03060000
030700                                                    COMP-3.       03070000
030800     05  PV-TEMP-BLOCK-NUMBER           PIC S9(09)  VALUE +0      03080000
030900                                                    COMP-3.       03090000
031000     05  PV-BLOCK-NUMBER                PIC S9(04)  VALUE +0      03100000
031100                                                    COMP SYNC.    03110000
031200     05  PV-CICS-RESP                   PIC S9(04)  VALUE +0      03120000
031300                                                    COMP SYNC.    03130000
031400     05  PV-ITEM                        PIC S9(04)  VALUE +0      03140000
031500                                                    COMP SYNC.    03150000
031600     05  PV-SEL-QUEUE-ITEM              PIC S9(04)  VALUE +0      03160000
031700                                                    COMP SYNC.    03170000
031800     05  PV-SAVE-ITEM                   PIC S9(04)  VALUE +0      03180000
031900                                                    COMP SYNC.    03190000
032000     05  PV-HIGHEST-BLOCK-WRITTEN       PIC S9(04)  VALUE +0      03200000
032100                                                    COMP SYNC.    03210000
032200     05  PV-LIST-ITEM-NUMBER            PIC S9(04)  VALUE +0      03220000
032300                                                    COMP SYNC.    03230000
032400     05  PV-FIRST-BLOCK-IN-ARRAY        PIC S9(04)  VALUE +0      03240000
032500                                                    COMP SYNC.    03250000
032600     05  PV-NEXT-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      03260000
032700                                                    COMP SYNC.    03270000
032800     05  PV-PREV-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      03280000
032900                                                    COMP SYNC.    03290000
033000     05  PV-FIRST-BLOCK-IN-RANGE        PIC S9(04)  VALUE +0      03300000
033100                                                    COMP SYNC.    03310000
033200     05  PV-LAST-BLOCK-IN-RANGE         PIC S9(04)  VALUE +0      03320000
033300                                                    COMP SYNC.    03330000
033400     05  PV-START-OF-SELECTED-RANGE     PIC S9(04)  VALUE +0      03340000
033500                                                    COMP SYNC.    03350000
033600     05  PV-END-OF-SELECTED-RANGE       PIC S9(04)  VALUE +0      03360000
033700                                                    COMP SYNC.    03370000
033800     05  PV-RETRY-COUNTER               PIC S9(04)  VALUE +0      03380000
033900                                                    COMP SYNC.    03390000
034000     05  PV-UNION-TYPE                  PIC  X(01).               03400000
034100*                                                                 03410000
034200     05  PV-COMMAREA-LENGTH              PIC S9(04)  VALUE +0     03420000
034300                                                     COMP SYNC.   03430000
034400     05  PV-CICS-MSG-AREA                PIC  X(80)  VALUE SPACES.03440000
034500     05  PV-CICS-MSG-AREA2               PIC  X(100) VALUE SPACES.03450000
034600     05  PV-CICS-MSG-HOLD.                                        03460000
034700         10  FILLER                      PIC  X(01)  VALUE SPACES.03470000
034800         10  PV-CICS-MSG-DATA            PIC  X(79)  VALUE SPACES.03480000
034900     05  PV-CICS-MSG-HOLD2.                                       03490000
035000         10  FILLER                      PIC  X(01)  VALUE SPACES.03500000
035100         10  PV-CICS-MSG-DATA2          PIC  X(99)  VALUE SPACES. 03510000
035200*                                                                 03520000
035300     05  PV-DTE-TME.                                              03530000
035400         10  PV-DTE                     PIC  X(10)  VALUE SPACES. 03540000
035500         10  FILLER                     PIC  X(01)  VALUE SPACES. 03550000
035600         10  PV-TME                     PIC  X(07)  VALUE SPACES. 03560000
035700     05  PV-ODD-UNION-TYPE              PIC  X(01).               03570000
035800                                                                  03580000
035900     05  PV-LNE-NBR                     PIC S9(9) COMP.           03590000
036000     05  PV-LINE-NBR                    PIC 9(04)   VALUE ZEROES. 03600000
036100                                                                  03610000
036200     05  PV-SHPD-QTY                    PIC S9(9) COMP-3.         03620000
036300     05  PV-RATIO-QTY                   PIC S9(4) COMP.           03630000
036400     05  PV-SAVE-ODD-UNION-TYPE         PIC  X(1).                03640000
036500     05  PV-SAVE-LNE-NBR                PIC S9(9) COMP.           03650000
036600     05  PV-SAVE-SHPD-QTY               PIC S9(9) COMP.           03660000
036700     05  PV-QUOTIENT                    PIC S9(04)  VALUE +0      03670000
036800                                                    COMP SYNC.    03680000
036900     05  PV-SAVE-QUOTIENT               PIC S9(04)  VALUE +0      03690000
037000                                                    COMP SYNC.    03700000
037100     05  PV-MULT-REMAINDER              PIC S9(04)  VALUE +0      03710000
037200                                                    COMP SYNC.    03720000
037300     05  PV-PBS-COUNT                   PIC  S9(4) COMP.          03730000
037400     05  PV-TRAN-COUNT                  PIC  S9(4) COMP.          03740000
037500                                                                  03750000
037600*----------------------------------------------------------------*03760000
037700* VALID LINES FOR A GIVEN PO-RCVR-LINE / PO-RCVR-PACK            *03770000
037800*----------------------------------------------------------------*03780000
037900 01 TBL-VALID-LINES.                                              03790000
038000    05 TBL-VALID-LINE-ENTRY     OCCURS  1500 TIMES                03800000
038100                                INDEXED BY LINE-INX.              03810000
038200       10 TBL-LINE-NBR          PIC 9(04).                        03820000
038300       10 TBL-RATIO             PIC 9(04).                        03830000
038400       10 TBL-PACKS             PIC 9(04).                        03840000
038500       10 TBL-ODD-UNITS         PIC 9(09).                        03850000
038600       10 TBL-RECEIVED          PIC X(01).                        03860000
038700          88  TBL-RECEIVED-NO       VALUE 'N'.                    03870000
038800          88  TBL-RECEIVED-YES      VALUE 'Y'.                    03880000
038900                                                                  03890000
039000*                                                                 03900000
039100 01  DN-DB2-NULL-INDICATORS.                                      03910000
039200     05  DN-VEH-NBR                 PIC S9(04) COMP VALUE ZEROES. 03920000
039300*                                                                 03930000
039400 01  WS-SHUNLO-CRE-TMST.                                          03940000
039500     05  WS-SHUNLO-CRE-TMST-DATE        PIC X(10).                03950000
039600     05  WS-FILLER                      PIC X(01).                03960000
039700     05  WS-SHUNLO-CRE-TMST-TIME        PIC X(05).                03970000
039800                                                                  03980000
039900 01  WS-SHUNLO-DATE                     PIC X(10).                03990000
040000 01  WS-SHUNLO-TIME                     PIC X(05).                04000000
040100                                                                  04010000
040200 01  WS-SHPUNT-CRE-TMST.                                          04020000
040300     05  WS-SHPUNT-CRE-TMST-DATE        PIC X(10).                04030000
040400     05  WS-FILLER                      PIC X(01).                04040000
040500     05  WS-SHPUNT-CRE-TMST-TIME        PIC X(05).                04050000
040600 01  WS-SULXBF-LST-STAT-TMST.                                     04060000
040700     05  WS-SULBXF-LAST-STAT-DATE       PIC X(10).                04070000
040800     05  WS-FILLER                      PIC X(01).                04080000
040900     05  WS-SULBXF-LAST-STAT-TIME       PIC X(05).                04090000
041000*                                                                 04100000
041100 01  PV-TMST-BREAKDOWN.                                           04110000
041200     05  PV-TMST                        PIC X(26)   VALUE SPACES. 04120000
041300     05  PV-TMST-R REDEFINES  PV-TMST.                            04130000
041400         10   PV-TMST-CC                PIC X(02).                04140000
041500         10   PV-TMST-YY                PIC X(02).                04150000
041600         10   FILLER                    PIC X(01).                04160000
041700         10   PV-TMST-MM                PIC X(02).                04170000
041800         10   FILLER                    PIC X(01).                04180000
041900         10   PV-TMST-DD                PIC X(02).                04190000
042000         10   FILLER                    PIC X(01).                04200000
042100         10   PV-TMST-HRS               PIC X(02).                04210000
042200         10   FILLER                    PIC X(01).                04220000
042300         10   PV-TMST-MIN               PIC X(02).                04230000
042400         10   FILLER                    PIC X(01).                04240000
042500         10   PV-TMST-SEC               PIC X(02).                04250000
042600         10   FILLER                    PIC X(07).                04260000
042700     05  PV-DATE-TIME                   PIC X(26)   VALUE SPACES. 04270000
042800     05  PV-DATE-TIME-DISPLAY REDEFINES PV-DATE-TIME.             04280000
042900         10   PV-DISPLAY-MM             PIC X(02).                04290000
043000         10   PV-SLASH-1                PIC X(01).                04300000
043100         10   PV-DISPLAY-DD             PIC X(02).                04310000
043200         10   PV-SLASH-2                PIC X(01).                04320000
043300         10   PV-DISPLAY-CC             PIC X(02).                04330000
043400         10   PV-DISPLAY-YY             PIC X(02).                04340000
043500         10   PV-SPACES                 PIC X(01).                04350000
043600         10   PV-DISPLAY-HRS            PIC X(02).                04360000
043700         10   PV-COLON                  PIC X(01).                04370000
043800         10   PV-DISPLAY-MIN            PIC X(02).                04380000
043900         10   FILLER                    PIC X(10).                04390000
044000                                                                  04400000
044100     05  PV-DISPLAY-UPC                 PIC  9(15) VALUE ZEROES.  04410000
044200                                                                  04420000
044300 01  WS-ENROUTE-BREAKDOWN.                                        04430000
044400     05  WS-ENROUTE                     PIC X(07).                04440000
044500                                                                  04450000
044600     05  PV-ENROUTE-DISPLAY             PIC X(07)                 04460000
044700                                  VALUE 'ENROUTE'.                04470000
044800*                                                                 04480000
044900     05  PV-PO-RECEIVER.                                          04490000
      *CLP 09/24/14                                                     04491009
045000         10  PV-PO-NBR      PIC 9(08).                            04500009
045100         10  FILLER         PIC X(01)  VALUE '-'.                 04510000
045200         10  PV-RECEIVER    PIC 9(03).                            04520000
045300*                                                                 04530000
045400     05  PV-OPER-UNT-ID                  PIC  S9(04) COMP.        04540000
045500     05  PV-FCLTY-ID                     PIC  S9(04) COMP.        04550000
045600     05  PV-SCAC-CDE                     PIC  X(04).              04560000
045700     05  PV-VEH-NBR                      PIC  X(10).              04570000
045800     05  PV-TRIP-ID                      PIC  S9(09) COMP.        04580000
045900     05  PV-PREVIOUS-TRIP                PIC  S9(09) COMP.        04590000
046000     05  PV-DISPLAY-TRIP-ID              PIC  S9(09) VALUE ZEROS. 04600000
046100     05  PV-SHIPT-UNT-ID                 PIC  S9(18) COMP-3.      04610000
046200     05  PV-DISPLAY-SHIPT-ID             PIC  S9(18) VALUE ZEROS. 04620000
046300*                                                                 04630000
046400     05  PV-PREVIOUS-PO                  PIC  S9(09) COMP.        04640000
046500     05  PV-PREVIOUS-RCVR                PIC  S9(09) COMP.        04650000
046600     05  PV-PREVIOUS-LINE                PIC  S9(09) COMP.        04660000
046700     05  PV-PREVIOUS-PACK                PIC  S9(09) COMP.        04670000
046800*                                                                 04680000
046900     05  PV-SEL-TERM-ID                  PIC  X(04).              04690000
047000     05  PV-SEL-TASK-NUMBER              PIC  9(05).              04700000
047100     05  PV-SEL-SEQ                      PIC  9(01).              04710000
047200     05  PV-XREF-ROWS                    PIC  9(05).              04720000
047300*                                                                 04730000
047400*---------------------------------------------------------------* 04740000
047500*   THIS IS THE LAYOUT FOR THE LIST ITEMS TEMP STORAGE QUEUE.   * 04750000
047600*   THIS MUST BE THE EXACT SAME FORMAT AS BLOCK IN THE          * 04760000
047700*   APPLICATION-SPECIFIC COMMAREA.                              * 04770000
047800*   ALL LQW LEVEL 10'S MUST MATCH ASC LEVEL 30'S.               * 04780000
047900*---------------------------------------------------------------* 04790000
048000 01  LQW-LIST-QUEUE-WORK-AREA.                                    04800000
048100     05  LQW-BLOCK-MODIFIED             PIC  X(01)  VALUE SPACES. 04810000
048200     05  LQW-ITEM-ENTRIES               OCCURS 12 TIMES           04820000
048300                                        INDEXED BY LQW-IDX.       04830000
048400         10  LQW-LIST-ITEM-NUMBER       PIC S9(09)  COMP-3.       04840000
048500         10  LQW-TEMP-SELECTED-SW       PIC  X(01).               04850000
048600         10  LQW-SELECTED-SW            PIC  X(01).               04860000
048700             88  LQW-SELECT                         VALUE 'S'.    04870000
048800             88  LQW-DESELECT                       VALUE ' '.    04880000
048900*                                                                 04890000
049000         10  LQW-ACTION                 PIC  X(03).               04900000
049100         10  LQW-SERIAL-SHIP-CDE        PIC  9(18).               04910000
049200         10  LQW-LINE-NBR               PIC  9(04).               04920000
049300         10  LQW-STATUS                 PIC  X(01).               04930000
049400         10  LQW-STR-NBR                PIC  9(04).               04940000
049500         10  LQW-LINE-DATE              PIC  X(10).               04950000
049600         10  LQW-LINE-TIME              PIC  X(05).               04960000
049700*LMM     10  LQW-LN-TRIP-ID             PIC  9(09).               04970000
049800         10  LQW-LN-TRIP-ID             PIC  X(09).               04980000
049900         10  LQW-SCAC-CDE               PIC  X(04).               04990000
050000         10  LQW-VEH-NBR                PIC  X(10).               05000000
050100         10  LQW-CSR-IND                PIC  X(01).               05010000
050200         10  LQW-LBL-TYP-CDE            PIC  X(01).               05020000
050300         10  LQW-LN-EVEN-IND            PIC  X(01).               05030000
050400         10  LQW-PBS-ERROR-IND          PIC  X(01).               05040000
050500         10  LQW-MISDIRECT-IND          PIC  X(01).               05050000
050600         10  LQW-UPC-IND                PIC  X(01).               05060000
050700         10  LQW-ITEM-IND               PIC  X(01).               05070000
050800         10  FILLER                     PIC  X(04).               05080000
050900*                                                                 05090000
051000*                                                                 05100000
051100*---------------------------------------------------------------* 05110000
051200*  SELECTION QUEUE LAYOUT                                       * 05120000
051300*---------------------------------------------------------------* 05130000
051400     COPY SUWS004.                                                05140000
051500     COPY RCWS013.                                                05150000
051600                                                                  05160000
051700                                                                  05170000
051800*---------------------------------------------------------------* 05180000
051900*    MAP LAYOUT                                                 * 05190000
052000*---------------------------------------------------------------* 05200000
052100*                                                                 05210000
052200     COPY SUKM555.                                                05220000
052300*                                                                 05230000
052400*DEFINITIONS MATCH SUKM555 MAPSET                                 05240000
052500 01  MR-OCCURS-LAYOUT                   REDEFINES  SUK555O.       05250000
      *CLP 09/24/14                                                     05251011
052600     05  FILLER                         PIC X(197).               05260011
052700     05  MR-SCROLL-AREA                 OCCURS 12 TIMES.          05270000
052800         10  MR-SELECTL                 PIC S9(04) COMP.          05280000
052900         10  MR-SELECTA                 PIC  X(01).               05290000
053000         10  MR-SELECTC                 PIC  X(01).               05300000
053100         10  MR-SELECTH                 PIC  X(01).               05310000
053200         10  MR-SELECTI                 PIC  X(01).               05320000
053300                                                                  05330000
053400         10  MR-ACTIONL                 PIC S9(04) COMP.          05340000
053500         10  MR-ACTIONA                 PIC  X(01).               05350000
053600         10  MR-ACTIONC                 PIC  X(01).               05360000
053700         10  MR-ACTIONH                 PIC  X(01).               05370000
053800         10  MR-ACTION                  PIC  X(03).               05380000
053900                                                                  05390000
054000         10  MR-LINEL                   PIC S9(04) COMP.          05400000
054100         10  MR-LINEA                   PIC  X(01).               05410000
054200         10  MR-LINEC                   PIC  X(01).               05420000
054300         10  MR-LINEH                   PIC  X(01).               05430000
054400         10  MR-LINE                    PIC  X(04).               05440000
054500                                                                  05450000
054600         10  MR-SHIPL                   PIC S9(04) COMP.          05460000
054700         10  MR-SHIPA                   PIC  X(01).               05470000
054800         10  MR-SHIPC                   PIC  X(01).               05480000
054900         10  MR-SHIPH                   PIC  X(01).               05490000
055000         10  MR-SHIP                    PIC  X(18).               05500000
055100                                                                  05510000
055200         10  MR-STATL                   PIC S9(04) COMP.          05520000
055300         10  MR-STATA                   PIC  X(01).               05530000
055400         10  MR-STATC                   PIC  X(01).               05540000
055500         10  MR-STATH                   PIC  X(01).               05550000
055600         10  MR-STAT                    PIC  X(01).               05560000
055700                                                                  05570000
055800         10  MR-STRL                    PIC S9(04) COMP.          05580000
055900         10  MR-STRA                    PIC  X(01).               05590000
056000         10  MR-STRC                    PIC  X(01).               05600000
056100         10  MR-STRH                    PIC  X(01).               05610000
056200         10  MR-STR                     PIC  X(04).               05620000
056300                                                                  05630000
056400         10  MR-DATEL                   PIC S9(04) COMP.          05640000
056500         10  MR-DATEA                   PIC  X(01).               05650000
056600         10  MR-DATEC                   PIC  X(01).               05660000
056700         10  MR-DATEH                   PIC  X(01).               05670000
056800         10  MR-DATE                    PIC  X(10).               05680000
056900                                                                  05690000
057000         10  MR-TIMEL                   PIC S9(04) COMP.          05700000
057100         10  MR-TIMEA                   PIC  X(01).               05710000
057200         10  MR-TIMEC                   PIC  X(01).               05720000
057300         10  MR-TIMEH                   PIC  X(01).               05730000
057400         10  MR-TIME                    PIC  X(05).               05740000
057500                                                                  05750000
057600         10  MR-TRIPL                   PIC S9(04) COMP.          05760000
057700         10  MR-TRIPA                   PIC  X(01).               05770000
057800         10  MR-TRIPC                   PIC  X(01).               05780000
057900         10  MR-TRIPH                   PIC  X(01).               05790000
058000         10  MR-TRIP                    PIC  X(09).               05800000
058100                                                                  05810000
058200         10  MR-SCACL                   PIC S9(04) COMP.          05820000
058300         10  MR-SCACA                   PIC  X(01).               05830000
058400         10  MR-SCACC                   PIC  X(01).               05840000
058500         10  MR-SCACH                   PIC  X(01).               05850000
058600         10  MR-SCAC                    PIC  X(04).               05860000
058700                                                                  05870000
058800         10  MR-TRLRL                   PIC S9(04) COMP.          05880000
058900         10  MR-TRLRA                   PIC  X(01).               05890000
059000         10  MR-TRLRC                   PIC  X(01).               05900000
059100         10  MR-TRLRH                   PIC  X(01).               05910000
059200         10  MR-TRLR                    PIC  X(10).               05920000
059300                                                                  05930000
059400     05  FILLER                         PIC  X(12).               05940000
059500*                                                                 05950000
059600*---------------------------------------------------------------* 05960000
059700*    ATTRIBUTE SETTINGS COPYBOOK.                               * 05970000
059800*---------------------------------------------------------------* 05980000
059900                                                                  05990000
060000     COPY DPWS015.                                                06000000
060100                                                                  06010000
060200*---------------------------------------------------------------* 06020000
060300*    FUNCTION KEYS COPYBOOK.                                    * 06030000
060400*---------------------------------------------------------------* 06040000
060500                                                                  06050000
060600     COPY DPWS016.                                                06060000
060700                                                                  06070000
060800*----------------------------------------------------------------*06080000
060900**  SECURITY SUBROUTINE PARAMETERS                                06090000
061000*----------------------------------------------------------------*06100000
061100                                                                  06110000
061200     COPY DPWS008.                                                06120000
061300                                                                  06130000
061400*---------------------------------------------------------------* 06140000
061500*    NUMERIC EDIT LAYOUT.                                       * 06150000
061600*---------------------------------------------------------------* 06160000
061700                                                                  06170000
061800     COPY DPWS010I.                                               06180000
061900 EJECT                                                            06190000
062000*---------------------------------------------------------------* 06200000
062100*    PARAMETERS FOR CALLING CICS ARCHITECTURE API               * 06210013
062200*---------------------------------------------------------------* 06220000
062300                                                                  06230000
062400     COPY DPWS030.                                                06240000
062400     COPY DPWS930.                                                06241013
062500 EJECT                                                            06250000
062600*---------------------------------------------------------------* 06260000
062700*    STANDARD COMMAREA.                                         * 06270000
062800*---------------------------------------------------------------* 06280000
062900                                                                  06290000
063000     COPY DPWS020.                                                06300000
063100     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                06310000
063200                                                                  06320000
063300*---------------------------------------------------------------* 06330000
063400* INTER-APPLICATION COMMAREA.                                   * 06340000
063500*   SUWS002 - IS THE INPUT LAYOUT WHEN COMING FROM THE CRIT.    * 06350000
063600*             SPEC SCREEN.                                      * 06360000
063700*   SUWS003 - IS THE OUTPUT LAYOUT THAT WILL BE PASSED FROM     * 06370000
063800*             THIS LIST PROGRAMMING FOR A LOCAL-GO FUNCTION.    * 06380000
063900*---------------------------------------------------------------* 06390000
064000*                                                                 06400000
064100         10  INTER-APPL-COMM-AREA       PIC X(200).               06410000
064200     COPY SUWS002.                                                06420000
064300     COPY SUWS003.                                                06430000
064400     COPY RCWS012.                                                06440000
064500     COPY RCWS015.                                                06450000
064600*---------------------------------------------------------------* 06460000
064700*  THIS IS THE APPLICATION-SPECIFIC COMMAREA.                   * 06470000
064800*  ASC LEVEL 30'S MUST MATCH LQW LEVEL 10'S.                    * 06480000
064900*---------------------------------------------------------------* 06490000
065000         10  ASC-SPECIFIC-COMMAREA.                               06500000
065100             15  ASC-INTER-APPL-CODES       PIC  X(01).           06510000
065200                 88  ASC-CRIT-SPEC-FORMAT     VALUE '1'.          06520000
065300                 88  ASC-LIST-FORMAT          VALUE '2'.          06530000
065400                 88  ASC-PKSLHDR-FORMAT       VALUE '3'.          06540000
065500                 88  ASC-PKSLLNE-FORMAT       VALUE '4'.          06550000
065600                 88  ASC-FREE-ASTRAY-FORMAT   VALUE '5'.          06560000
065700                 88  ASC-RCVG-SIMPLE-FORMAT   VALUE '6'.          06570000
065800                 88  ASC-SUSPEND-VE-FORMAT    VALUE '7'.          06580000
065900             15  ASC-OPER-UNT-ID          PIC S9(04) COMP.        06590000
066000             15  ASC-FCLTY-ID             PIC S9(04) COMP.        06600000
066100             15  ASC-FCLTY-NME            PIC X(25).              06610000
      *CLP 09/24/14                                                     06611011
066200             15  ASC-PO-RECEIVER.                                 06620000
066300                 20  ASC-PO-NBR           PIC 9(08).              06630009
066400                 20  FILLER               PIC X(01).              06640000
066500                 20  ASC-RECEIVER         PIC 9(03).              06650000
066600             15  ASC-LINE                 PIC 9(04).              06660000
066700             15  ASC-ENT-NAME-DESC        PIC X(30).              06670000
066800             15  ASC-SHIPT-UNT-ID         PIC S9(18)V COMP-3.     06680000
066900             15  ASC-SHIPT-UNT-SRC-ID     PIC X(03).              06690000
067000             15  ASC-TRIP-ID              PIC S9(09) COMP.        06700000
067100                                                                  06710000
067200             15  ASC-SCAC                 PIC X(04).              06720000
067300             15  ASC-TRLR-NBR             PIC X(10).              06730000
067400             15  ASC-DATE                 PIC X(10).              06740000
067500             15  ASC-TIME                 PIC X(05).              06750000
067600             15  ASC-PKGNG-CDE            PIC X(01).              06760000
067700                 88  ASC-PRE-PACK-ORDER           VALUE 'I', 'M'. 06770000
067800                 88  ASC-INNER-PREPK              VALUE 'I'.      06780000
067900                 88  ASC-MULTI-SKU-PREPK          VALUE 'M'.      06790000
068000                 88  ASC-SINGLE-SKU-PREPK         VALUE 'S'.      06800000
068100                 88  ASC-CASEPACK                 VALUE 'C'.      06810000
068200                 88  ASC-BULK-PACK                VALUE 'B'.      06820000
068300             15  ASC-SEQ-NBR                  PIC S9(04) COMP.    06830000
068400*                                                                 06840000
068500             15  ASC-BLK-SUB                  PIC S9(04) COMP     06850000
068600                                                         SYNC.    06860000
068700             15  ASC-ITEM-SUB                 PIC S9(04) COMP     06870000
068800                                                         SYNC.    06880000
068900             15  ASC-NUMBER-OF-ITEMS-READ     PIC S9(09) COMP-3.  06890000
069000             15  ASC-NUMBER-OF-SELECTED-ITEMS PIC S9(09) COMP-3.  06900000
069100             15  ASC-ITEMS-DISPLAYED          PIC S9(03) COMP-3.  06910000
069200             15  ASC-ITEM-AT-TOP-OF-PANEL     PIC S9(09) COMP-3.  06920000
069300             15  ASC-ITEM-AT-BOT-OF-PANEL     PIC S9(09) COMP-3.  06930000
069400             15  ASC-HIGHEST-BLOCK-WRITTEN    PIC S9(04) COMP     06940000
069500                                                         SYNC.    06950000
069600             15  ASC-START-OF-SELECTED-RANGE  PIC S9(09) COMP-3.  06960000
069700             15  ASC-END-OF-SELECTED-RANGE    PIC S9(09) COMP-3.  06970000
069800             15  ASC-ITEMS-LEFT-INDICATOR     PIC  X(01).         06980000
069900                 88  ASC-ITEMS-LEFT-ON-DB          VALUE 'Y'.     06990000
070000                 88  ASC-NO-ITEMS-LEFT-ON-DB       VALUE 'N'.     07000000
070100             15  ASC-TEMP-QUEUE-UPDATE-SW     PIC  X(01).         07010000
070200                 88  ASC-UPDATE-TSQ                VALUE 'Y'.     07020000
070300                 88  ASC-NO-TSQ-UPDATE             VALUE ' '.     07030000
070400             15  ASC-LIST-QUEUE-NAME.                             07040000
070500                 20  ASC-LIST-TERM-ID         PIC  X(04).         07050000
070600                 20  ASC-LIST-TASK-NUMBER     PIC S9(05) COMP-3.  07060000
070700                 20  ASC-LIST-SEQ             PIC  9(01).         07070000
070800             15  ASC-SEL-QUEUE-NAME.                              07080000
070900                 20  ASC-SEL-TERM-ID          PIC  X(04).         07090000
071000                 20  ASC-SEL-TASK-NUMBER      PIC S9(05) COMP-3.  07100000
071100                 20  ASC-SEL-SEQ              PIC  9(01).         07110000
071200             15  ASC-SEL-QUEUE-NAME-2.                            07120000
071300                 20  ASC-SEL-TERM-ID-2        PIC  X(04).         07130000
071400                 20  ASC-SEL-TASK-NUMBER-2    PIC S9(05) COMP-3.  07140000
071500                 20  ASC-SEL-SEQ-2            PIC  9(01).         07150000
071600             15  ASC-SEL-QUEUE-NAME-ORIG.                         07160000
071700                 20  ASC-SEL-TERM-ID-ORIG     PIC  X(04).         07170000
071800                 20  ASC-SEL-TASK-NUMBER-ORIG PIC S9(05) COMP-3.  07180000
071900                 20  ASC-SEL-SEQ-ORIG         PIC  9(01).         07190000
072000             15  ASC-START-ITEM-REQUEST.                          07200000
072100                 20  ASC-START-ITEM-REQUEST-N PIC  9(05).         07210000
072200             15  ASC-CURSOR-SW                PIC  X(02).         07220000
072300                 88  ASC-NO-CURSOR                   VALUE 'Z '.  07230000
072400                 88  ASC-CARTON-CURSOR               VALUE 'A '.  07240000
072500                 88  ASC-TRAN-PREPK-CURSOR           VALUE 'B '.  07250000
072600                 88  ASC-NOT-TRAN-PREPK-CURSOR       VALUE 'C '.  07260000
072700                 88  ASC-NON-PREPK-CURSOR            VALUE 'D '.  07270000
072800                 88  ASC-PBS-CURSOR                  VALUE 'E '.  07280000
072900                 88  ASC-PACKSLIP-LINE-CURSOR        VALUE 'F '.  07290000
073000                 88  ASC-ALL-LINES-CURSOR            VALUE 'G '.  07300000
073100                 88  ASC-FREE-ASTRAY-CURSOR          VALUE 'H '.  07310000
073200                 88  ASC-PO-TRAN-PREPK-CURSOR        VALUE 'I '.  07320000
073300                 88  ASC-PO-NON-PREPK-CURSOR         VALUE 'J '.  07330000
073400                 88  ASC-PO-PBS-CURSOR               VALUE 'K '.  07340000
073500                                                                  07350000
073600             15  ASC-DISPLAY-SW               PIC X.              07360000
073700                 88  ASC-DISPLAY-1-LINE              VALUE 'B'.   07370000
073800                 88  ASC-DISPLAY-ALL-LINES           VALUE 'C'.   07380000
073900                                                                  07390000
074000             15  ASC-TRANSCRIBED-SW        PIC  X(01).            07400000
074100                 88  ASC-TRANSCRIBED                 VALUE 'Y'.   07410000
074200                 88  ASC-NOT-TRANSCRIBED             VALUE 'N'.   07420000
074300                                                                  07430000
074400             15  ASC-CHECKED-IN-SW         PIC  X(01).            07440000
074500                 88  ASC-CHECKED-IN                  VALUE 'Y'.   07450000
074600                 88  ASC-NOT-CHECKED-IN              VALUE 'N'.   07460000
074700                                                                  07470000
074800             15  ASC-UPC-FOUND-SW          PIC  X(01).            07480000
074900                 88  ASC-UPC-FOUND                   VALUE 'Y'.   07490000
075000                 88  ASC-UPC-NOT-FOUND               VALUE 'N'.   07500000
075100                                                                  07510000
075200             15  ASC-SEL-SUB                  PIC S9(4) COMP.     07520000
075300             15  ASC-SEL-ITEM                 PIC S9(4) COMP.     07530000
075400             15  ASC-USE-SELECTION-QUEUE-IND  PIC  X(1).          07540000
075500                 88  ASC-USE-SELECTION-QUEUE           VALUE 'Y'. 07550000
075600             15  ASC-NUMBER-OF-TS-ITEMS       PIC S9(09) COMP-3.  07560000
075700                                                                  07570000
075800             15  ASC-BLOCK-ENTRIES OCCURS 2 TIMES.                07580000
075900                 20  ASC-BLOCK-MODIFIED-SW          PIC X(01).    07590000
076000                     88  ASC-BLOCK-NOT-MODIFIED     VALUE 'N'.    07600000
076100                     88  ASC-BLOCK-MODIFIED         VALUE 'Y'.    07610000
076200                                                                  07620000
076300                 20  ASC-ITEM-ARRAY.                              07630000
076400                     25  ASC-ITEM-ENTRIES OCCURS 12 TIMES.        07640000
076500                         30  ASC-LIST-ITEM-NUMBER                 07650000
076600                                        PIC S9(09)  COMP-3.       07660000
076700                         30  ASC-TEMP-SELECTED-SW PIC X(01).      07670000
076800                             88  ASC-VALID-SELECT   VALUE ' '     07680000
076900                                                          'S'     07690000
077000                                                          'B'     07700000
077100                                                          'E'.    07710000
077200                             88  ASC-TEMP-NO-SELECT VALUE ' '.    07720000
077300                             88  ASC-TEMP-SELECT    VALUE 'S'.    07730000
077400                             88  ASC-TEMP-BEGIN     VALUE 'B'.    07740000
077500                             88  ASC-TEMP-END       VALUE 'E'.    07750000
077600                         30  ASC-SELECTED-SW        PIC X(01).    07760000
077700                             88  ASC-NO-SELECT      VALUE ' '.    07770000
077800                             88  ASC-SELECT         VALUE 'S'.    07780000
077900                             88  ASC-BEGIN          VALUE 'B'.    07790000
078000                             88  ASC-END            VALUE 'E'.    07800000
078100                         30  ASC-ACTION             PIC X(03).    07810000
078200                         30  ASC-SERIAL-SHIP-CDE    PIC S9(18).   07820000
078300                         30  ASC-LINE-NBR           PIC X(04).    07830000
078400                             88 ASC-LINE-MULT      VALUE 'MULT'.  07840000
078500                         30  ASC-STATUS             PIC X(01).    07850000
078600                         30  ASC-STR-NBR            PIC 9(04).    07860000
078700                         30  ASC-LINE-DATE          PIC X(10).    07870000
078800                         30  ASC-LINE-TIME          PIC X(05).    07880000
078900                         30  ASC-LN-TRIP-ID         PIC X(09).    07890000
079000                         30  ASC-SCAC-CDE           PIC X(04).    07900000
079100                         30  ASC-VEH-NBR            PIC X(10).    07910000
079200                         30  ASC-CSR-IND            PIC X(01).    07920000
079300                         30  ASC-LBL-TYP-CDE        PIC X(01).    07930000
079400                             88  ASC-P2L-LBL        VALUE 'P'.    07940000
079500                         30  ASC-LN-EVEN-IND        PIC X(01).    07950000
079600                         30  ASC-PBS-ERROR-IND      PIC X(01).    07960000
079700                         30  ASC-PBS-MISDIRECT-IND  PIC X(01).    07970000
079800                         30  ASC-UPC-IND            PIC X(01).    07980000
079900                         30  ASC-ITEM-IND           PIC X(01).    07990000
080000                         30  FILLER                 PIC X(04).    08000000
      *CLP 09/24/14                                                     08001011
080100             15  FILLER                             PIC X(23).    08010009
080200******************************************************************08020000
080300                                                                  08030000
080400 EJECT                                                            08040000
080500*---------------------------------------------------------------* 08050000
080600*    ABEND PROCESSING COPYBOOK.                                 * 08060000
080700*---------------------------------------------------------------* 08070000
080800                                                                  08080000
080900     COPY DPWS013.                                                08090000
081000                                                                  08100000
081100*---------------------------------------------------------------* 08110000
081200*    DB2 AREA FOR THE PURCHASE ORDER TABLE                      * 08120000
081300*---------------------------------------------------------------* 08130000
081400     EXEC SQL                                                     08140000
081500          INCLUDE TPURCHS                                         08150000
081600     END-EXEC.                                                    08160000
081700*                                                                 08170000
081800*---------------------------------------------------------------* 08180000
081900*    DB2 AREA FOR THE PO-PURCHASE ITEM TABLE                    * 08190000
082000*---------------------------------------------------------------* 08200000
082100     EXEC SQL                                                     08210000
082200          INCLUDE TPURITM                                         08220000
082300     END-EXEC.                                                    08230000
082400*                                                                 08240000
082500*---------------------------------------------------------------* 08250000
082600*    DB2 AREA FOR THE VENDOR TABLE                              * 08260000
082700*---------------------------------------------------------------* 08270000
082800     EXEC SQL                                                     08280000
082900          INCLUDE TENTNME                                         08290000
083000     END-EXEC.                                                    08300000
083100                                                                  08310000
083200*                                                                 08320000
083300*---------------------------------------------------------------* 08330000
083400*    DB2 AREA FOR THE SHIPMENT TABLE                            * 08340000
083500*---------------------------------------------------------------* 08350000
083600     EXEC SQL                                                     08360000
083700          INCLUDE TSHIPMT                                         08370000
083800     END-EXEC.                                                    08380000
083900                                                                  08390000
084000*                                                                 08400000
084100*---------------------------------------------------------------* 08410000
084200*    DB2 AREA FOR THE PO SHIPMENT TABLE                         * 08420000
084300*---------------------------------------------------------------* 08430000
084400     EXEC SQL                                                     08440000
084500          INCLUDE TSHPTPO                                         08450000
084600     END-EXEC.                                                    08460000
084700                                                                  08470000
084800*                                                                 08480000
084900*---------------------------------------------------------------* 08490000
085000*    DB2 AREA FOR THE PACKING SLIP TABLE                        * 08500000
085100*---------------------------------------------------------------* 08510000
085200     EXEC SQL                                                     08520000
085300          INCLUDE TPKSLIP                                         08530000
085400     END-EXEC.                                                    08540000
085500                                                                  08550000
085600*                                                                 08560000
085700*---------------------------------------------------------------* 08570000
085800*    DB2 AREA FOR THE PACKSLIP/SHIPMENT UNIT ASSOCIATION TABLE *  08580000
085900*---------------------------------------------------------------* 08590000
086000     EXEC SQL                                                     08600000
086100          INCLUDE TINPKSU                                         08610000
086200     END-EXEC.                                                    08620000
086300                                                                  08630000
086400*                                                                 08640000
086500*---------------------------------------------------------------* 08650000
086600*    DB2 AREA FOR THE SHIPMENT UNIT LOCATION TABLE              * 08660000
086700*---------------------------------------------------------------* 08670000
086800     EXEC SQL                                                     08680000
086900          INCLUDE TSHUNLO                                         08690000
087000     END-EXEC.                                                    08700000
087100                                                                  08710000
087200*                                                                 08720000
087300*---------------------------------------------------------------* 08730000
087400*    DB2 AREA FOR THE VEHICLE TRIP TABLE                        * 08740000
087500*---------------------------------------------------------------* 08750000
087600     EXEC SQL                                                     08760000
087700          INCLUDE TVHTRIP                                         08770000
087800     END-EXEC.                                                    08780000
087900                                                                  08790000
088000*                                                                 08800000
088100*---------------------------------------------------------------* 08810000
088200*    DB2 AREA FOR THE SHIPPING UNIT TABLE                       * 08820000
088300*---------------------------------------------------------------* 08830000
088400     EXEC SQL                                                     08840000
088500          INCLUDE TSHPUNT                                         08850000
088600     END-EXEC.                                                    08860000
088700                                                                  08870000
088800*                                                                 08880000
088900*---------------------------------------------------------------* 08890000
089000*    DB2 AREA FOR THE SHIPPING UNIT UPC ASSOCIATION TABLE       * 08900000
089100*---------------------------------------------------------------* 08910000
089200     EXEC SQL                                                     08920000
089300          INCLUDE TSHUUPC                                         08930000
089400     END-EXEC.                                                    08940000
089500                                                                  08950000
089600*---------------------------------------------------------------* 08960000
089700*    DB2 AREA FOR THE RC-RECEIVER TABLE                         * 08970000
089800*---------------------------------------------------------------* 08980000
089900     EXEC SQL                                                     08990000
090000          INCLUDE TRECEIV                                         09000000
090100     END-EXEC.                                                    09010000
090200                                                                  09020000
090300*                                                                 09030000
090400*---------------------------------------------------------------* 09040000
090500*    DB2 AREA FOR THE RECEIPT ITEM TABLE                        * 09050000
090600*---------------------------------------------------------------* 09060000
090700     EXEC SQL                                                     09070000
090800          INCLUDE TRECITM                                         09080000
090900     END-EXEC.                                                    09090000
091000                                                                  09100000
091100*                                                                 09110000
091200*---------------------------------------------------------------* 09120000
091300*  SU-LABEL CROSS REFERENCE TABLE                               * 09130000
091400*---------------------------------------------------------------* 09140000
091500     EXEC SQL                                                     09150000
091600          INCLUDE TSULBXF                                         09160000
091700     END-EXEC.                                                    09170000
091800                                                                  09180000
091900*                                                                 09190000
092000*---------------------------------------------------------------* 09200000
092100* TR-TRIP STATUS TABLE                                          * 09210000
092200*---------------------------------------------------------------* 09220000
092300     EXEC SQL                                                     09230000
092400          INCLUDE TTRIPST                                         09240000
092500     END-EXEC.                                                    09250000
092600                                                                  09260000
092700*                                                                 09270000
092800*---------------------------------------------------------------* 09280000
092900*    DB2 AREA FOR COMMUNICATIONS                                * 09290000
093000*---------------------------------------------------------------* 09300000
093100     EXEC SQL                                                     09310000
093200          INCLUDE SQLCA                                           09320000
093300     END-EXEC.                                                    09330000
093400                                                                  09340000
093500*---------------------------------------------------------------* 09350000
093600*  CURSOR TO SELECT CARTONS THAT ARE ASSIGNED TO THE            * 09360000
093700*  PO/RCVR/LNE BEING PROCESSED.   **** ONE LINE ONLY ****       * 09370000
093800*---------------------------------------------------------------* 09380000
093900     EXEC SQL                                                     09390000
094000          DECLARE CARTON-CSR CURSOR FOR                           09400000
094100          SELECT 'A'                                              09410000
094200                , E.TRIP_ID                                       09420000
094300                , B.PO_NBR                                        09430000
094400                , B.REC_SEQ_NBR                                   09440000
094500                , C.SEQ_NBR                                       09450000
094600                , D.SHIPT_UNT_ID                                  09460000
094700                , H.DEST_OPER_UNT_ID                              09470000
094800                , H.SHIPT_UNT_SRC_ID                              09480000
094900                , E.CRE_TMST                                      09490000
095000                , DATE(E.CRE_TMST)                                09500000
095100                , TIME(E.CRE_TMST)                                09510000
095200                , I.TRN_LNE_NBR                                   09520000
095300             FROM TSHIPMT A                                       09530000
095400                , TSHPTPO B                                       09540000
095500                , TPKSLIP C                                       09550000
095600                , TINPKSU D                                       09560000
095700                , TSHUNLO E                                       09570000
095800                , TVHTRIP F                                       09580000
095900                , TSHPUNT H                                       09590000
096000                , TSHUUPC I                                       09600000
096100            WHERE A.SHIPT_ID      = B.SHIPT_ID                    09610000
096200              AND A.TRIP_ID       = F.TRIP_ID                     09620000
096300              AND B.PO_NBR        = :DK-PO-NBR                    09630000
096400              AND B.REC_SEQ_NBR   = :DK-REC-SEQ-NBR               09640000
096500              AND B.PO_NBR        = C.PO_NBR                      09650000
096600              AND B.REC_SEQ_NBR   = C.REC_SEQ_NBR                 09660000
096700              AND C.VER_STAT_CDE  = 'A'                           09670000
096800              AND B.PO_NBR        = D.PO_NBR                      09680000
096900              AND D.SEQ_NBR       = C.SEQ_NBR                     09690000
097000              AND E.SHIPT_UNT_ID  = D.SHIPT_UNT_ID                09700000
097100              AND E.SHIPT_UNT_ID  = H.SHIPT_UNT_ID                09710000
097200              AND E.SCN_LOC_ID   IN ('RECV','WRCV')               09720001
097300              AND E.ACTV_CDE      = 'A'                           09730000
097400              AND H.SHIPT_UNT_ID  = I.SHIPT_UNT_ID                09740000
097500              AND I.TRN_LNE_NBR   = :DK-LINE-NBR                  09750000
097600              AND H.ACTV_IND      = 'A'                           09760000
097700            UNION                                                 09770000
097800           SELECT 'B'                                             09780000
097900                , F.TRIP_ID                                       09790000
098000                , B.PO_NBR                                        09800000
098100                , B.REC_SEQ_NBR                                   09810000
098200                , C.SEQ_NBR                                       09820000
098300                , D.SHIPT_UNT_ID                                  09830000
098400                , G.DEST_OPER_UNT_ID                              09840000
098500                , G.SHIPT_UNT_SRC_ID                              09850000
098600                , C.CRE_TMST                                      09860000
098700                , DATE(C.CRE_TMST)                                09870000
098800                , TIME(C.CRE_TMST)                                09880000
098900                , H.TRN_LNE_NBR                                   09890000
099000             FROM TSHIPMT A                                       09900000
099100                , TSHPTPO B                                       09910000
099200                , TPKSLIP C                                       09920000
099300                , TINPKSU D                                       09930000
099400                , TVHTRIP F                                       09940000
099500                , TSHPUNT G                                       09950000
099600                , TSHUUPC H                                       09960000
099700           WHERE A.SHIPT_ID     = B.SHIPT_ID                      09970000
099800             AND A.TRIP_ID      = F.TRIP_ID                       09980000
099900             AND B.PO_NBR       = :DK-PO-NBR                      09990000
100000             AND B.REC_SEQ_NBR  = :DK-REC-SEQ-NBR                 10000000
100100             AND B.PO_NBR       = C.PO_NBR                        10010000
100200             AND B.REC_SEQ_NBR  = C.REC_SEQ_NBR                   10020000
100300             AND C.VER_STAT_CDE = 'A'                             10030000
100400             AND B.PO_NBR       = D.PO_NBR                        10040000
100500             AND D.SEQ_NBR      = C.SEQ_NBR                       10050000
100600             AND D.SHIPT_UNT_ID = G.SHIPT_UNT_ID                  10060000
100700             AND G.SHIPT_UNT_ID = H.SHIPT_UNT_ID                  10070000
100800             AND H.TRN_LNE_NBR  = :DK-LINE-NBR                    10080000
100900             AND G.ACTV_IND      = 'A'                            10090000
101000             AND NOT EXISTS                                       10100000
101100               (SELECT G.SHIPT_UNT_ID                             10110000
101200                FROM TSHUNLO G                                    10120000
101300                WHERE G.SHIPT_UNT_ID = D.SHIPT_UNT_ID             10130000
101400                  AND G.ACTV_CDE      = 'A'                       10140000
101500                  AND G.SCN_LOC_ID  IN ('RECV','WRCV'))           10150006
101600           ORDER BY                                               10160000
101700                  12,8,7                                          10170000
101800     END-EXEC.                                                    10180000
101900                                                                  10190000
102000*---------------------------------------------------------------* 10200000
102100*  CURSOR TO SELECT CARTONS THAT ARE ASSIGNED TO THE            * 10210000
102200*  PO/RCVR/LNE BEING PROCESSED.   **** ONE LINE ONLY ****       * 10220000
102300*---------------------------------------------------------------* 10230000
102400     EXEC SQL                                                     10240000
102500          DECLARE CARTON-PACK-CSR CURSOR FOR                      10250000
102600          SELECT 'A'                                              10260000
102700                , E.TRIP_ID                                       10270000
102800                , B.PO_NBR                                        10280000
102900                , B.REC_SEQ_NBR                                   10290000
103000                , C.SEQ_NBR                                       10300000
103100                , D.SHIPT_UNT_ID                                  10310000
103200                , H.DEST_OPER_UNT_ID                              10320000
103300                , H.SHIPT_UNT_SRC_ID                              10330000
103400                , E.CRE_TMST                                      10340000
103500                , DATE(E.CRE_TMST)                                10350000
103600                , TIME(E.CRE_TMST)                                10360000
103700                , J.PREPK_ID                                      10370000
103800             FROM TSHIPMT A                                       10380000
103900                , TSHPTPO B                                       10390000
104000                , TPKSLIP C                                       10400000
104100                , TINPKSU D                                       10410000
104200                , TSHUNLO E                                       10420000
104300                , TVHTRIP F                                       10430000
104400                , TSHPUNT H                                       10440000
104500                , TSHUUPC I                                       10450000
104600                , TRECITM J                                       10460000
104700            WHERE A.SHIPT_ID      = B.SHIPT_ID                    10470000
104800              AND A.TRIP_ID       = F.TRIP_ID                     10480000
104900              AND B.PO_NBR        = :DK-PO-NBR                    10490000
105000              AND B.REC_SEQ_NBR   = :DK-REC-SEQ-NBR               10500000
105100              AND B.PO_NBR        = C.PO_NBR                      10510000
105200              AND B.REC_SEQ_NBR   = C.REC_SEQ_NBR                 10520000
105300              AND C.VER_STAT_CDE  = 'A'                           10530000
105400              AND B.PO_NBR        = D.PO_NBR                      10540000
105500              AND D.SEQ_NBR       = C.SEQ_NBR                     10550000
105600              AND E.SHIPT_UNT_ID  = D.SHIPT_UNT_ID                10560000
105700              AND E.SHIPT_UNT_ID  = H.SHIPT_UNT_ID                10570000
105800              AND E.SCN_LOC_ID   IN ('RECV','WRCV')               10580003
105900              AND E.ACTV_CDE      = 'A'                           10590000
106000              AND H.SHIPT_UNT_ID  = I.SHIPT_UNT_ID                10600000
106100              AND I.TRN_LNE_NBR   = J.ORD_LNE_NBR                 10610000
106200              AND J.PREPK_ID      = :DK-PREPK-ID                  10620000
106300              AND B.PO_NBR        = J.ORD_NBR                     10630000
106400              AND B.REC_SEQ_NBR   = J.REC_SEQ_NBR                 10640000
106500              AND H.ACTV_IND      = 'A'                           10650000
106600            UNION                                                 10660000
106700           SELECT 'B'                                             10670000
106800                , F.TRIP_ID                                       10680000
106900                , B.PO_NBR                                        10690000
107000                , B.REC_SEQ_NBR                                   10700000
107100                , C.SEQ_NBR                                       10710000
107200                , D.SHIPT_UNT_ID                                  10720000
107300                , G.DEST_OPER_UNT_ID                              10730000
107400                , G.SHIPT_UNT_SRC_ID                              10740000
107500                , C.CRE_TMST                                      10750000
107600                , DATE(C.CRE_TMST)                                10760000
107700                , TIME(C.CRE_TMST)                                10770000
107800                , J.PREPK_ID                                      10780000
107900             FROM TSHIPMT A                                       10790000
108000                , TSHPTPO B                                       10800000
108100                , TPKSLIP C                                       10810000
108200                , TINPKSU D                                       10820000
108300                , TVHTRIP F                                       10830000
108400                , TSHPUNT G                                       10840000
108500                , TSHUUPC H                                       10850000
108600                , TRECITM J                                       10860000
108700           WHERE A.SHIPT_ID     = B.SHIPT_ID                      10870000
108800             AND A.TRIP_ID      = F.TRIP_ID                       10880000
108900             AND B.PO_NBR       = :DK-PO-NBR                      10890000
109000             AND B.REC_SEQ_NBR  = :DK-REC-SEQ-NBR                 10900000
109100             AND B.PO_NBR       = C.PO_NBR                        10910000
109200             AND B.REC_SEQ_NBR  = C.REC_SEQ_NBR                   10920000
109300             AND C.VER_STAT_CDE = 'A'                             10930000
109400             AND B.PO_NBR       = D.PO_NBR                        10940000
109500             AND D.SEQ_NBR      = C.SEQ_NBR                       10950000
109600             AND D.SHIPT_UNT_ID = G.SHIPT_UNT_ID                  10960000
109700             AND G.SHIPT_UNT_ID = H.SHIPT_UNT_ID                  10970000
109800             AND H.TRN_LNE_NBR  = J.ORD_LNE_NBR                   10980000
109900             AND J.PREPK_ID     = :DK-PREPK-ID                    10990000
110000             AND B.PO_NBR       = J.ORD_NBR                       11000000
110100             AND B.REC_SEQ_NBR  = J.REC_SEQ_NBR                   11010000
110200             AND G.ACTV_IND      = 'A'                            11020000
110300             AND NOT EXISTS                                       11030000
110400               (SELECT G.SHIPT_UNT_ID                             11040000
110500                FROM TSHUNLO G                                    11050000
110600                WHERE G.SHIPT_UNT_ID = D.SHIPT_UNT_ID             11060000
110700                  AND G.ACTV_CDE      = 'A'                       11070000
110800                  AND G.SCN_LOC_ID   IN ('RECV', 'WRCV'))         11080004
110900           ORDER BY                                               11090000
111000                  12,8,7                                          11100000
111100     END-EXEC.                                                    11110000
111200                                                                  11120000
111300*---------------------------------------------------------------* 11130000
111400*  CURSOR TO SELECT CARTONS THAT ARE ASSIGNED TO THE            * 11140000
111500*  PO/RCVR/LNE BEING PROCESSED.   **** ALL LINES ****           * 11150000
111600*---------------------------------------------------------------* 11160000
111700     EXEC SQL                                                     11170000
111800          DECLARE ALL-CARTON-CSR CURSOR FOR                       11180000
111900          SELECT 'A'                                              11190000
112000                , E.TRIP_ID                                       11200000
112100                , B.PO_NBR                                        11210000
112200                , B.REC_SEQ_NBR                                   11220000
112300                , C.SEQ_NBR                                       11230000
112400                , D.SHIPT_UNT_ID                                  11240000
112500                , H.DEST_OPER_UNT_ID                              11250000
112600                , H.SHIPT_UNT_SRC_ID                              11260000
112700                , E.CRE_TMST                                      11270000
112800                , DATE(E.CRE_TMST)                                11280000
112900                , TIME(E.CRE_TMST)                                11290000
113000                , I.TRN_LNE_NBR                                   11300000
113100             FROM TSHIPMT A                                       11310000
113200                , TSHPTPO B                                       11320000
113300                , TPKSLIP C                                       11330000
113400                , TINPKSU D                                       11340000
113500                , TSHUNLO E                                       11350000
113600                , TVHTRIP F                                       11360000
113700                , TSHPUNT H                                       11370000
113800                , TSHUUPC I                                       11380000
113900            WHERE A.SHIPT_ID      = B.SHIPT_ID                    11390000
114000              AND A.TRIP_ID       = F.TRIP_ID                     11400000
114100              AND B.PO_NBR        = :DK-PO-NBR                    11410000
114200              AND B.REC_SEQ_NBR   = :DK-REC-SEQ-NBR               11420000
114300              AND B.PO_NBR        = C.PO_NBR                      11430000
114400              AND B.REC_SEQ_NBR   = C.REC_SEQ_NBR                 11440000
114500              AND C.VER_STAT_CDE  = 'A'                           11450000
114600              AND B.PO_NBR        = D.PO_NBR                      11460000
114700              AND D.SEQ_NBR       = C.SEQ_NBR                     11470000
114800              AND E.SHIPT_UNT_ID  = D.SHIPT_UNT_ID                11480000
114900              AND E.SHIPT_UNT_ID  = H.SHIPT_UNT_ID                11490000
115000              AND H.SHIPT_UNT_ID  = I.SHIPT_UNT_ID                11500000
115100              AND E.ACTV_CDE      = 'A'                           11510000
115200*             AND E.SCN_LOC_ID    = 'RECV'                        11520002
115300              AND E.SCN_LOC_ID   IN ('RECV','WRCV')               11530002
115400              AND H.ACTV_IND      = 'A'                           11540000
115500            UNION                                                 11550000
115600           SELECT 'B'                                             11560000
115700                , F.TRIP_ID                                       11570000
115800                , B.PO_NBR                                        11580000
115900                , B.REC_SEQ_NBR                                   11590000
116000                , C.SEQ_NBR                                       11600000
116100                , D.SHIPT_UNT_ID                                  11610000
116200                , G.DEST_OPER_UNT_ID                              11620000
116300                , G.SHIPT_UNT_SRC_ID                              11630000
116400                , C.CRE_TMST                                      11640000
116500                , DATE(C.CRE_TMST)                                11650000
116600                , TIME(C.CRE_TMST)                                11660000
116700                , H.TRN_LNE_NBR                                   11670000
116800             FROM TSHIPMT A                                       11680000
116900                , TSHPTPO B                                       11690000
117000                , TPKSLIP C                                       11700000
117100                , TINPKSU D                                       11710000
117200                , TVHTRIP F                                       11720000
117300                , TSHPUNT G                                       11730000
117400                , TSHUUPC H                                       11740000
117500           WHERE A.SHIPT_ID     = B.SHIPT_ID                      11750000
117600             AND A.TRIP_ID      = F.TRIP_ID                       11760000
117700             AND B.PO_NBR       = :DK-PO-NBR                      11770000
117800             AND B.REC_SEQ_NBR  = :DK-REC-SEQ-NBR                 11780000
117900             AND B.PO_NBR       = C.PO_NBR                        11790000
118000             AND B.REC_SEQ_NBR  = C.REC_SEQ_NBR                   11800000
118100             AND C.VER_STAT_CDE = 'A'                             11810000
118200             AND B.PO_NBR       = D.PO_NBR                        11820000
118300             AND D.SEQ_NBR      = C.SEQ_NBR                       11830000
118400             AND D.SHIPT_UNT_ID = G.SHIPT_UNT_ID                  11840000
118500             AND G.SHIPT_UNT_ID = H.SHIPT_UNT_ID                  11850000
118600             AND G.ACTV_IND      = 'A'                            11860000
118700             AND NOT EXISTS                                       11870000
118800               (SELECT G.SHIPT_UNT_ID                             11880000
118900                FROM TSHUNLO G                                    11890000
119000                WHERE G.SHIPT_UNT_ID = D.SHIPT_UNT_ID             11900000
119100                  AND G.ACTV_CDE     = 'A'                        11910000
119200                  AND G.SCN_LOC_ID  IN ('RECV','WRCV'))           11920003
119300           ORDER BY                                               11930000
119400                  12,8,7                                          11940000
119500     END-EXEC.                                                    11950000
119600                                                                  11960000
119700*---------------------------------------------------------------* 11970000
119800*  CURSOR TO SELECT CARTONS THAT ARE ASSIGNED TO THE            * 11980000
119900*  PO/RCVR/LNE BEING PROCESSED.   **** ALL LINES ****           * 11990000
120000*---------------------------------------------------------------* 12000000
120100     EXEC SQL                                                     12010000
120200          DECLARE ALL-CTN-PACK-CSR CURSOR FOR                     12020000
120300          SELECT 'A'                                              12030000
120400                , E.TRIP_ID                                       12040000
120500                , B.PO_NBR                                        12050000
120600                , B.REC_SEQ_NBR                                   12060000
120700                , C.SEQ_NBR                                       12070000
120800                , D.SHIPT_UNT_ID                                  12080000
120900                , H.DEST_OPER_UNT_ID                              12090000
121000                , H.SHIPT_UNT_SRC_ID                              12100000
121100                , E.CRE_TMST                                      12110000
121200                , DATE(E.CRE_TMST)                                12120000
121300                , TIME(E.CRE_TMST)                                12130000
121400                , J.PREPK_ID                                      12140000
121500             FROM TSHIPMT A                                       12150000
121600                , TSHPTPO B                                       12160000
121700                , TPKSLIP C                                       12170000
121800                , TINPKSU D                                       12180000
121900                , TSHUNLO E                                       12190000
122000                , TVHTRIP F                                       12200000
122100                , TSHPUNT H                                       12210000
122200                , TSHUUPC I                                       12220000
122300                , TRECITM J                                       12230000
122400            WHERE A.SHIPT_ID      = B.SHIPT_ID                    12240000
122500              AND A.TRIP_ID       = F.TRIP_ID                     12250000
122600              AND B.PO_NBR        = :DK-PO-NBR                    12260000
122700              AND B.REC_SEQ_NBR   = :DK-REC-SEQ-NBR               12270000
122800              AND B.PO_NBR        = C.PO_NBR                      12280000
122900              AND B.REC_SEQ_NBR   = C.REC_SEQ_NBR                 12290000
123000              AND C.VER_STAT_CDE  = 'A'                           12300000
123100              AND B.PO_NBR        = D.PO_NBR                      12310000
123200              AND D.SEQ_NBR       = C.SEQ_NBR                     12320000
123300              AND E.SHIPT_UNT_ID  = D.SHIPT_UNT_ID                12330000
123400              AND E.SHIPT_UNT_ID  = H.SHIPT_UNT_ID                12340000
123500              AND E.SCN_LOC_ID   IN ('RECV','WRCV')               12350003
123600              AND E.ACTV_CDE      = 'A'                           12360000
123700              AND H.SHIPT_UNT_ID  = I.SHIPT_UNT_ID                12370000
123800              AND B.PO_NBR        = J.ORD_NBR                     12380000
123900              AND B.REC_SEQ_NBR   = J.REC_SEQ_NBR                 12390000
124000              AND I.TRN_LNE_NBR  =  J.ORD_LNE_NBR                 12400000
124100              AND H.ACTV_IND      = 'A'                           12410000
124200            UNION                                                 12420000
124300           SELECT 'B'                                             12430000
124400                , F.TRIP_ID                                       12440000
124500                , B.PO_NBR                                        12450000
124600                , B.REC_SEQ_NBR                                   12460000
124700                , C.SEQ_NBR                                       12470000
124800                , D.SHIPT_UNT_ID                                  12480000
124900                , G.DEST_OPER_UNT_ID                              12490000
125000                , G.SHIPT_UNT_SRC_ID                              12500000
125100                , C.CRE_TMST                                      12510000
125200                , DATE(C.CRE_TMST)                                12520000
125300                , TIME(C.CRE_TMST)                                12530000
125400                , J.PREPK_ID                                      12540000
125500             FROM TSHIPMT A                                       12550000
125600                , TSHPTPO B                                       12560000
125700                , TPKSLIP C                                       12570000
125800                , TINPKSU D                                       12580000
125900                , TVHTRIP F                                       12590000
126000                , TSHPUNT G                                       12600000
126100                , TSHUUPC H                                       12610000
126200                , TRECITM J                                       12620000
126300           WHERE A.SHIPT_ID     = B.SHIPT_ID                      12630000
126400             AND A.TRIP_ID      = F.TRIP_ID                       12640000
126500             AND B.PO_NBR       = :DK-PO-NBR                      12650000
126600             AND B.REC_SEQ_NBR  = :DK-REC-SEQ-NBR                 12660000
126700             AND B.PO_NBR       = C.PO_NBR                        12670000
126800             AND B.REC_SEQ_NBR  = C.REC_SEQ_NBR                   12680000
126900             AND C.VER_STAT_CDE = 'A'                             12690000
127000             AND B.PO_NBR       = D.PO_NBR                        12700000
127100             AND D.SEQ_NBR      = C.SEQ_NBR                       12710000
127200             AND D.SHIPT_UNT_ID = G.SHIPT_UNT_ID                  12720000
127300             AND G.SHIPT_UNT_ID = H.SHIPT_UNT_ID                  12730000
127400             AND B.PO_NBR       = J.ORD_NBR                       12740000
127500             AND B.REC_SEQ_NBR  = J.REC_SEQ_NBR                   12750000
127600             AND H.TRN_LNE_NBR  = J.ORD_LNE_NBR                   12760000
127700             AND G.ACTV_IND     = 'A'                             12770000
127800             AND NOT EXISTS                                       12780000
127900               (SELECT G.SHIPT_UNT_ID                             12790000
128000                FROM TSHUNLO G                                    12800000
128100                WHERE G.SHIPT_UNT_ID = D.SHIPT_UNT_ID             12810000
128200                  AND G.ACTV_CDE       = 'A'                      12820000
128300                  AND G.SCN_LOC_ID    IN ('RECV','WRCV'))         12830003
128400           ORDER BY                                               12840000
128500                  12,8,7                                          12850000
128600     END-EXEC.                                                    12860000
128700                                                                  12870000
128800*---------------------------------------------------------------* 12880000
128900*  SHIPT CURSOR                       **** ONE LINE ONLY ****   * 12890000
129000*---------------------------------------------------------------* 12900000
129100     EXEC SQL                                                     12910000
129200          DECLARE SHIPT-CSR CURSOR FOR                            12920000
129300              SELECT DISTINCT                                     12930000
129400                     A.SHIPT_UNT_ID                               12940000
129500                   , C.DEST_OPER_UNT_ID                           12950000
129600                   , C.SHIPT_UNT_SRC_ID                           12960000
129700                   , A.CRE_TMST                                   12970000
129800                   , DATE(A.CRE_TMST)                             12980000
129900                   , TIME(A.CRE_TMST)                             12990000
130000                   , D.OWNER_SCAC_ID                              13000000
130100                   , D.VEH_NBR                                    13010000
130200                   , B.TRN_LNE_NBR                                13020000
130300              FROM   TSHUNLO A                                    13030000
130400                   , TSHUUPC B                                    13040000
130500                   , TSHPUNT C                                    13050000
130600                   , TVHTRIP D                                    13060000
130700              WHERE A.TRIP_ID        = :DK-TRIP-ID                13070000
130800                AND A.SHIPT_UNT_ID   = B.SHIPT_UNT_ID             13080000
130900                AND A.SHIPT_UNT_ID   = C.SHIPT_UNT_ID             13090000
131000                AND A.TRIP_ID        = D.TRIP_ID                  13100000
131100                AND A.SCN_LOC_ID    IN ('RECV','WRCV')            13110003
131200                AND A.ACTV_CDE       = 'A'                        13120000
131300                AND B.TRN_NBR        = :DK-PO-NBR                 13130000
131400                AND B.TRN_LNE_NBR    = :DK-LINE-NBR               13140000
131500                AND C.ACTV_IND       = 'A'                        13150000
131600     END-EXEC.                                                    13160000
131700                                                                  13170000
131800*---------------------------------------------------------------* 13180000
131900*  SHIPT CURSOR                       **** ALL LINES ****       * 13190000
132000*---------------------------------------------------------------* 13200000
132100     EXEC SQL                                                     13210000
132200          DECLARE ALL-SHIPT-CSR CURSOR FOR                        13220000
132300              SELECT DISTINCT                                     13230000
132400                     A.SHIPT_UNT_ID                               13240000
132500                   , C.DEST_OPER_UNT_ID                           13250000
132600                   , C.SHIPT_UNT_SRC_ID                           13260000
132700                   , A.CRE_TMST                                   13270000
132800                   , DATE(A.CRE_TMST)                             13280000
132900                   , TIME(A.CRE_TMST)                             13290000
133000                   , D.OWNER_SCAC_ID                              13300000
133100                   , D.VEH_NBR                                    13310000
133200                   , B.TRN_LNE_NBR                                13320000
133300              FROM   TSHUNLO A                                    13330000
133400                   , TSHUUPC B                                    13340000
133500                   , TSHPUNT C                                    13350000
133600                   , TVHTRIP D                                    13360000
133700              WHERE A.TRIP_ID        = :DK-TRIP-ID                13370000
133800                AND A.SHIPT_UNT_ID   = B.SHIPT_UNT_ID             13380000
133900                AND A.SHIPT_UNT_ID   = C.SHIPT_UNT_ID             13390000
134000                AND A.TRIP_ID        = D.TRIP_ID                  13400000
134100                AND A.SCN_LOC_ID    IN ('RECV','WRCV')            13410003
134200                AND A.ACTV_CDE       = 'A'                        13420000
134300                AND B.TRN_NBR        = :DK-PO-NBR                 13430000
134400                AND C.ACTV_IND       = 'A'                        13440000
134500     END-EXEC.                                                    13450000
134600                                                                  13460000
134700                                                                  13470000
134800*---------------------------------------------------------------* 13480000
134900*  STATUS CURSOR                                                * 13490000
135000*---------------------------------------------------------------* 13500000
135100     EXEC SQL                                                     13510000
135200          DECLARE STATUS-CSR CURSOR FOR                           13520000
135300              SELECT DISTINCT                                     13530000
135400                     STAT_CDE                                     13540000
135500                   , LAST_STAT_CHG_TMST                           13550000
135600                   , DEST_OPER_UNT_ID                             13560000
135700                   , DATE(LAST_STAT_CHG_TMST)                     13570000
135800                   , CART_LBL_TYP_CDE                             13580000
135900              FROM   TSULBXF                                      13590000
136000              WHERE SHIPT_UNT_ID   = :SHUNLO-SHIPT-UNT-ID         13600000
136100                AND CRE_TMST       = :SHUNLO-CRE-TMST             13610000
136200              ORDER BY STAT_CDE DESC                              13620000
136300                      ,4                                          13630000
136400                      ,DEST_OPER_UNT_ID                           13640000
136500     END-EXEC.                                                    13650000
136600                                                                  13660000
136700*---------------------------------------------------------------* 13670000
136800*  CURSOR TO LIST ALL CARTONS ATTACHED TO A PARTICULAR            13680000
136900*  PACKSLIP/LINE                                                  13690000
137000*  HAVE PO, PKSL SEQ NBR, PO LINE NBR                             13700000
137100*---------------------------------------------------------------* 13710000
137200     EXEC SQL                                                     13720000
137300          DECLARE PACKSLIP-LINE-CSR CURSOR FOR                    13730000
137400    SELECT 'A'                                                    13740000
137500          , A.REC_SEQ_NBR                                         13750000
137600          , C.SHIPT_UNT_ID                                        13760000
137700          , C.ACTV_IND                                            13770000
137800          , C.DEST_OPER_UNT_ID                                    13780000
137900          , D.CRE_TMST                                            13790000
138000          , DATE(D.CRE_TMST)                                      13800000
138100          , TIME(D.CRE_TMST)                                      13810000
138200          , D.TRIP_ID                                             13820000
138300          , E.OWNER_SCAC_ID                                       13830000
138400          , E.VEH_NBR                                             13840000
138500          , F.TRN_LNE_NBR                                         13850000
138600      FROM  TPKSLIP A                                             13860000
138700          , TINPKSU B                                             13870000
138800          , TSHPUNT C                                             13880000
138900          , TSHUNLO D                                             13890000
139000          , TVHTRIP E                                             13900000
139100          , TSHUUPC F                                             13910000
139200     WHERE A.PO_NBR       = :DK-PO-NBR                            13920000
139300       AND A.SEQ_NBR      = :DK-SEQ-NBR                           13930000
139400       AND F.TRN_LNE_NBR  = :DK-LINE-NBR                          13940000
139500       AND VER_STAT_CDE   = 'A'                                   13950000
139600       AND A.PO_NBR       = B.PO_NBR                              13960000
139700       AND A.PO_NBR       = F.TRN_NBR                             13970000
139800       AND A.SEQ_NBR      = B.SEQ_NBR                             13980000
139900       AND B.SHIPT_UNT_ID = C.SHIPT_UNT_ID                        13990000
140000       AND B.SHIPT_UNT_ID = D.SHIPT_UNT_ID                        14000000
140100       AND B.SHIPT_UNT_ID = F.SHIPT_UNT_ID                        14010000
140200       AND D.TRIP_ID      = E.TRIP_ID                             14020000
140300       AND D.SCN_LOC_ID NOT IN                                    14030000
140400         ('PBSA','PBSB','PBSC','PBSD','PBSE')                     14040000
140500     UNION                                                        14050000
140600     SELECT 'B'                                                   14060000
140700           , A.REC_SEQ_NBR                                        14070000
140800           , C.SHIPT_UNT_ID                                       14080000
140900           , C.ACTV_IND                                           14090000
141000           , C.DEST_OPER_UNT_ID                                   14100000
141100           , A.CRE_TMST                                           14110000
141200           , C.CRE_DTE                                            14120000
141300           , C.CRE_TM                                             14130000
141400           , 0                                                    14140000
141500           , ' '                                                  14150000
141600           , ' '                                                  14160000
141700          , D.TRN_LNE_NBR                                         14170000
141800       FROM  TPKSLIP A                                            14180000
141900           , TINPKSU B                                            14190000
142000           , TSHPUNT C                                            14200000
142100           , TSHUUPC D                                            14210000
142200      WHERE A.PO_NBR       = :DK-PO-NBR                           14220000
142300        AND A.SEQ_NBR      = :DK-SEQ-NBR                          14230000
142400        AND D.TRN_LNE_NBR  = :DK-LINE-NBR                         14240000
142500        AND VER_STAT_CDE   = 'A'                                  14250000
142600        AND A.PO_NBR       = B.PO_NBR                             14260000
142700        AND A.PO_NBR       = D.TRN_NBR                            14270000
142800        AND A.SEQ_NBR      = B.SEQ_NBR                            14280000
142900        AND B.SHIPT_UNT_ID = C.SHIPT_UNT_ID                       14290000
143000        AND B.SHIPT_UNT_ID = D.SHIPT_UNT_ID                       14300000
143100        AND NOT EXISTS                                            14310000
143200          (SELECT G.SHIPT_UNT_ID                                  14320000
143300           FROM TSHUNLO G                                         14330000
143400           WHERE G.SHIPT_UNT_ID = B.SHIPT_UNT_ID                  14340000
143500             AND G.ACTV_CDE     = 'A'                             14350000
143600             AND G.SCN_LOC_ID  IN ('RECV','WRCV'))                14360003
143700      ORDER BY 12                                                 14370000
143800     WITH UR                                                      14380000
143900     END-EXEC.                                                    14390000
144000*                                                                 14400000
144100                                                                  14410000
144200*---------------------------------------------------------------* 14420000
144300*  CURSOR TO LIST ALL CARTONS                                     14430000
144400*  HAVE PO, PKSL SEQ NBR                                          14440000
144500*---------------------------------------------------------------* 14450000
144600     EXEC SQL                                                     14460000
144700          DECLARE ALL-LINES-CSR CURSOR FOR                        14470000
144800    SELECT 'A'                                                    14480000
144900          , A.REC_SEQ_NBR                                         14490000
145000          , C.SHIPT_UNT_ID                                        14500000
145100          , C.ACTV_IND                                            14510000
145200          , C.DEST_OPER_UNT_ID                                    14520000
145300          , D.CRE_TMST                                            14530000
145400          , DATE(D.CRE_TMST)                                      14540000
145500          , TIME(D.CRE_TMST)                                      14550000
145600          , D.TRIP_ID                                             14560000
145700          , E.OWNER_SCAC_ID                                       14570000
145800          , E.VEH_NBR                                             14580000
145900          , F.TRN_LNE_NBR                                         14590000
146000      FROM  TPKSLIP A                                             14600000
146100          , TINPKSU B                                             14610000
146200          , TSHPUNT C                                             14620000
146300          , TSHUNLO D                                             14630000
146400          , TVHTRIP E                                             14640000
146500          , TSHUUPC F                                             14650000
146600     WHERE A.PO_NBR       = :DK-PO-NBR                            14660000
146700       AND A.SEQ_NBR      = :DK-SEQ-NBR                           14670000
146800       AND VER_STAT_CDE   = 'A'                                   14680000
146900       AND A.PO_NBR       = B.PO_NBR                              14690000
147000       AND A.PO_NBR       = F.TRN_NBR                             14700000
147100       AND A.SEQ_NBR      = B.SEQ_NBR                             14710000
147200       AND B.SHIPT_UNT_ID = C.SHIPT_UNT_ID                        14720000
147300       AND B.SHIPT_UNT_ID = D.SHIPT_UNT_ID                        14730000
147400       AND B.SHIPT_UNT_ID = F.SHIPT_UNT_ID                        14740000
147500       AND D.TRIP_ID      = E.TRIP_ID                             14750000
147600       AND D.SCN_LOC_ID NOT IN                                    14760000
147700         ('PBSA','PBSB','PBSC','PBSD','PBSE')                     14770000
147800     UNION                                                        14780000
147900     SELECT 'B'                                                   14790000
148000           , A.REC_SEQ_NBR                                        14800000
148100           , C.SHIPT_UNT_ID                                       14810000
148200           , C.ACTV_IND                                           14820000
148300           , C.DEST_OPER_UNT_ID                                   14830000
148400           , A.CRE_TMST                                           14840000
148500           , C.CRE_DTE                                            14850000
148600           , C.CRE_TM                                             14860000
148700           , 0                                                    14870000
148800           , ' '                                                  14880000
148900           , ' '                                                  14890000
149000          , D.TRN_LNE_NBR                                         14900000
149100       FROM  TPKSLIP A                                            14910000
149200           , TINPKSU B                                            14920000
149300           , TSHPUNT C                                            14930000
149400           , TSHUUPC D                                            14940000
149500      WHERE A.PO_NBR       = :DK-PO-NBR                           14950000
149600        AND A.SEQ_NBR      = :DK-SEQ-NBR                          14960000
149700        AND VER_STAT_CDE   = 'A'                                  14970000
149800        AND A.PO_NBR       = B.PO_NBR                             14980000
149900        AND A.PO_NBR       = D.TRN_NBR                            14990000
150000        AND A.SEQ_NBR      = B.SEQ_NBR                            15000000
150100        AND B.SHIPT_UNT_ID = C.SHIPT_UNT_ID                       15010000
150200        AND B.SHIPT_UNT_ID = D.SHIPT_UNT_ID                       15020000
150300        AND NOT EXISTS                                            15030000
150400          (SELECT G.SHIPT_UNT_ID                                  15040000
150500           FROM TSHUNLO G                                         15050000
150600           WHERE G.SHIPT_UNT_ID = B.SHIPT_UNT_ID                  15060000
150700             AND G.ACTV_CDE     = 'A'                             15070000
150800             AND G.SCN_LOC_ID  IN ('RECV', 'WRCV'))               15080004
150900      ORDER BY 12                                                 15090000
151000     WITH UR                                                      15100000
151100     END-EXEC.                                                    15110000
151200*                                                                 15120000
151300                                                                  15130000
151400*---------------------------------------------------------------* 15140000
151500*  CURSOR TO LIST ALL CARTONS ATTACHED TO A PARTICULAR            15150000
151600*  PACKSLIP - WHEN COMING IN FROM THE FREE-ASTRAY SCREEN          15160000
151700*  HAVE PO AND REC SEQ NBR                                        15170000
151800*---------------------------------------------------------------* 15180000
151900     EXEC SQL                                                     15190000
152000          DECLARE FREE-ASTRAY-CSR CURSOR FOR                      15200000
152100    SELECT 'A'                                                    15210000
152200          , A.REC_SEQ_NBR                                         15220000
152300          , C.SHIPT_UNT_ID                                        15230000
152400          , C.ACTV_IND                                            15240000
152500          , C.DEST_OPER_UNT_ID                                    15250000
152600          , D.CRE_TMST                                            15260000
152700          , DATE(D.CRE_TMST)                                      15270000
152800          , TIME(D.CRE_TMST)                                      15280000
152900          , D.TRIP_ID                                             15290000
153000          , E.OWNER_SCAC_ID                                       15300000
153100          , E.VEH_NBR                                             15310000
153200      FROM  TPKSLIP A                                             15320000
153300          , TINPKSU B                                             15330000
153400          , TSHPUNT C                                             15340000
153500          , TSHUNLO D                                             15350000
153600          , TVHTRIP E                                             15360000
153700     WHERE  A.PO_NBR       = :DK-PO-NBR                           15370000
153800       AND  A.REC_SEQ_NBR  = :DK-REC-SEQ-NBR                      15380000
153900       AND  A.VER_STAT_CDE = 'A'                                  15390000
154000       AND  A.PO_NBR       = B.PO_NBR                             15400000
154100       AND  A.SEQ_NBR      = B.SEQ_NBR                            15410000
154200       AND  B.SHIPT_UNT_ID = C.SHIPT_UNT_ID                       15420000
154300       AND  B.SHIPT_UNT_ID = D.SHIPT_UNT_ID                       15430000
154400       AND  D.TRIP_ID      = E.TRIP_ID                            15440000
154500       AND  D.SCN_LOC_ID NOT IN                                   15450000
154600            ('PBSA','PBSB','PBSC','PBSD','PBSE')                  15460000
154700     UNION                                                        15470000
154800     SELECT 'B'                                                   15480000
154900          , A.REC_SEQ_NBR                                         15490000
155000          , C.SHIPT_UNT_ID                                        15500000
155100          , C.ACTV_IND                                            15510000
155200          , C.DEST_OPER_UNT_ID                                    15520000
155300          , A.CRE_TMST                                            15530000
155400          , C.CRE_DTE                                             15540000
155500          , C.CRE_TM                                              15550000
155600          , 0                                                     15560000
155700          , ' '                                                   15570000
155800          , ' '                                                   15580000
155900       FROM TPKSLIP A                                             15590000
156000          , TINPKSU B                                             15600000
156100          , TSHPUNT C                                             15610000
156200      WHERE A.PO_NBR       = :DK-PO-NBR                           15620000
156300        AND A.REC_SEQ_NBR  = :DK-REC-SEQ-NBR                      15630000
156400        AND A.VER_STAT_CDE = 'A'                                  15640000
156500        AND A.PO_NBR       = B.PO_NBR                             15650000
156600        AND A.SEQ_NBR      = B.SEQ_NBR                            15660000
156700        AND B.SHIPT_UNT_ID = C.SHIPT_UNT_ID                       15670000
156800        AND NOT EXISTS                                            15680000
156900            (SELECT G.SHIPT_UNT_ID                                15690000
157000             FROM TSHUNLO G                                       15700000
157100             WHERE G.SHIPT_UNT_ID = B.SHIPT_UNT_ID                15710000
157200               AND G.ACTV_CDE     = 'A'                           15720000
157300               AND G.SCN_LOC_ID  IN ('RECV','WRCV'))              15730003
157400      ORDER BY 3                                                  15740000
157500     WITH UR                                                      15750000
157600     END-EXEC.                                                    15760000
157700                                                                  15770000
157800*---------------------------------------------------------------* 15780000
157900*  CURSOR FOR TRANSCRIBED PREPACKS                                15790000
158000*  WHEN COMING IN FROM PACKSLIP HEADER SCREEN                     15800000
158100*---------------------------------------------------------------* 15810000
158200     EXEC SQL                                                     15820000
158300          DECLARE TRAN-PREPK-CSR CURSOR FOR                       15830000
158400     SELECT                                                       15840000
158500            A.REC_SEQ_NBR                                         15850000
158600          , C.SHIPT_UNT_ID                                        15860000
158700          , C.ACTV_IND                                            15870000
158800          , C.DEST_OPER_UNT_ID                                    15880000
158900          , A.CRE_TMST                                            15890000
159000          , C.CRE_DTE                                             15900000
159100          , C.CRE_TM                                              15910000
159200          , F.PREPK_ID                                            15920000
159300       FROM TPKSLIP A                                             15930000
159400          , TINPKSU B                                             15940000
159500          , TSHPUNT C                                             15950000
159600          , TSHUUPC D                                             15960000
159700          , TRECEIV E                                             15970000
159800          , TRECITM F                                             15980000
159900      WHERE A.PO_NBR       = :DK-PO-NBR                           15990000
160000        AND A.SEQ_NBR      = :DK-SEQ-NBR                          16000000
160100        AND A.VER_STAT_CDE = 'A'                                  16010000
160200        AND A.PKSL_STAT_CDE = 'AC'                                16020000
160300        AND A.PO_NBR       = B.PO_NBR                             16030000
160400        AND A.SEQ_NBR      = B.SEQ_NBR                            16040000
160500        AND B.SHIPT_UNT_ID = C.SHIPT_UNT_ID                       16050000
160600        AND B.SHIPT_UNT_ID = D.SHIPT_UNT_ID                       16060000
160700        AND A.PO_NBR       = E.ORD_NBR                            16070000
160800        AND A.REC_SEQ_NBR  = E.REC_SEQ_NBR                        16080000
160900        AND A.REC_SEQ_NBR  > 0                                    16090000
161000        AND E.PKGNG_CDE   IN ('M','I')                            16100000
161100        AND E.ORD_NBR      = F.ORD_NBR                            16110000
161200        AND E.REC_SEQ_NBR  = F.REC_SEQ_NBR                        16120000
161300        AND D.TRN_LNE_NBR  = F.ORD_LNE_NBR                        16130000
161400        AND D.TRN_LNE_NBR  IN                                     16140000
161500            (SELECT MAX(M.TRN_LNE_NBR)                            16150000
161600               FROM TSHUUPC M                                     16160000
161700                  , TRECITM P                                     16170000
161800              WHERE D.SHIPT_UNT_ID = M.SHIPT_UNT_ID               16180000
161900                AND M.TRN_NBR = P.ORD_NBR                         16190000
162000                AND M.TRN_LNE_NBR   = P.ORD_LNE_NBR               16200000
162100                AND F.REC_SEQ_NBR   = P.REC_SEQ_NBR)              16210000
162200      ORDER BY 8,2                                                16220000
162300     WITH UR                                                      16230000
162400     END-EXEC.                                                    16240000
162500                                                                  16250000
162600*---------------------------------------------------------------* 16260000
162700*  CURSOR FOR NOT-TRANSCRIBED PREPACKS                            16270000
162800*  WHEN COMING IN FROM PACKSLIP HEADER SCREEN                     16280000
162900*---------------------------------------------------------------* 16290000
163000     EXEC SQL                                                     16300000
163100          DECLARE NOT-TRAN-PREPK-CSR CURSOR FOR                   16310000
163200     SELECT                                                       16320000
163300            A.REC_SEQ_NBR                                         16330000
163400          , C.SHIPT_UNT_ID                                        16340000
163500          , C.ACTV_IND                                            16350000
163600          , C.DEST_OPER_UNT_ID                                    16360000
163700          , A.CRE_TMST                                            16370000
163800          , C.CRE_DTE                                             16380000
163900          , C.CRE_TM                                              16390000
164000          , E.PO_PREPK_ID                                         16400000
164100       FROM TPKSLIP A                                             16410000
164200          , TINPKSU B                                             16420000
164300          , TSHPUNT C                                             16430000
164400          , TSHUUPC D                                             16440000
164500          , TPURITM E                                             16450000
164600          , TPURCHS F                                             16460000
164700      WHERE A.PO_NBR       = :DK-PO-NBR                           16470000
164800        AND A.SEQ_NBR      = :DK-SEQ-NBR                          16480000
164900        AND A.VER_STAT_CDE = 'A'                                  16490000
165000        AND A.PO_NBR       = B.PO_NBR                             16500000
165100        AND A.SEQ_NBR      = B.SEQ_NBR                            16510000
165200        AND B.SHIPT_UNT_ID = C.SHIPT_UNT_ID                       16520000
165300        AND B.SHIPT_UNT_ID = D.SHIPT_UNT_ID                       16530000
165400        AND A.PO_NBR       = E.PO_NBR                             16540000
165500        AND A.PO_NBR       = F.PO_NBR                             16550000
165600        AND E.VER_STATUS_CDE = 'A'                                16560000
165700        AND F.VER_STATUS_CDE = 'A'                                16570000
165800        AND ((A.REC_SEQ_NBR = 0) OR                               16580000
165900             (A.REC_SEQ_NBR > 0  AND                              16590000
166000              A.PKSL_STAT_CDE = 'IN'))                            16600000
166100        AND F.PKGNG_CDE     IN ('M','I')                          16610000
166200        AND D.TRN_LNE_NBR   = E.PO_LNE_NBR                        16620000
166300        AND E.PO_LNE_NBR =                                        16630000
166400            (SELECT MAX(H.TRN_LNE_NBR)                            16640000
166500               FROM TSHUUPC H                                     16650000
166600              WHERE H.TRN_NBR = E.PO_NBR                          16660000
166700                AND H.SHIPT_UNT_ID = D.SHIPT_UNT_ID)              16670000
166800      ORDER BY 8,2                                                16680000
166900     WITH UR                                                      16690000
167000     END-EXEC.                                                    16700000
167100*                                                                 16710000
167200*---------------------------------------------------------------* 16720000
167300*  CURSOR FOR NON-PREPACK, NON-PBS ORDERS                         16730000
167400*  WHEN COMING IN FROM PACKSLIP HEADER SCREEN                     16740000
167500*---------------------------------------------------------------* 16750000
167600     EXEC SQL                                                     16760000
167700          DECLARE NON-PREPK-CSR CURSOR FOR                        16770000
167800     SELECT                                                       16780000
167900            A.REC_SEQ_NBR                                         16790000
168000          , C.SHIPT_UNT_ID                                        16800000
168100          , C.ACTV_IND                                            16810000
168200          , C.DEST_OPER_UNT_ID                                    16820000
168300          , A.CRE_TMST                                            16830000
168400          , C.CRE_DTE                                             16840000
168500          , C.CRE_TM                                              16850000
168600          , D.TRN_LNE_NBR                                         16860000
168700       FROM TPKSLIP A                                             16870000
168800          , TINPKSU B                                             16880000
168900          , TSHPUNT C                                             16890000
169000          , TSHUUPC D                                             16900000
169100      WHERE A.PO_NBR       = :DK-PO-NBR                           16910000
169200        AND A.SEQ_NBR      = :DK-SEQ-NBR                          16920000
169300        AND A.VER_STAT_CDE = 'A'                                  16930000
169400        AND A.PO_NBR       = B.PO_NBR                             16940000
169500        AND A.SEQ_NBR      = B.SEQ_NBR                            16950000
169600        AND B.SHIPT_UNT_ID = C.SHIPT_UNT_ID                       16960000
169700        AND B.SHIPT_UNT_ID = D.SHIPT_UNT_ID                       16970000
169800        AND D.TRN_LNE_NBR  IN                                     16980000
169900            (SELECT MIN(M.TRN_LNE_NBR)                            16990000
170000               FROM TSHUUPC M                                     17000000
170100              WHERE D.SHIPT_UNT_ID = M.SHIPT_UNT_ID)              17010000
170200      ORDER BY 8,2                                                17020000
170300     WITH UR                                                      17030000
170400     END-EXEC.                                                    17040000
170500                                                                  17050000
170600*---------------------------------------------------------------* 17060000
170700*  CURSOR FOR PBS ORDERS                                          17070000
170800*  WHEN COMING IN FROM PACKSLIP HEADER SCREEN                     17080000
170900*---------------------------------------------------------------* 17090000
171000     EXEC SQL                                                     17100000
171100          DECLARE PBS-CSR CURSOR FOR                              17110000
171200     SELECT                                                       17120000
171300            A.REC_SEQ_NBR                                         17130000
171400          , C.SHIPT_UNT_ID                                        17140000
171500          , C.ACTV_IND                                            17150000
171600          , C.DEST_OPER_UNT_ID                                    17160000
171700          , A.CRE_TMST                                            17170000
171800          , C.CRE_DTE                                             17180000
171900          , C.CRE_TM                                              17190000
172000          , COUNT(*)                                              17200000
172100       FROM TPKSLIP A                                             17210000
172200          , TINPKSU B                                             17220000
172300          , TSHPUNT C                                             17230000
172400          , TSHUUPC D                                             17240000
172500      WHERE A.PO_NBR       = :DK-PO-NBR                           17250000
172600        AND A.SEQ_NBR      = :DK-SEQ-NBR                          17260000
172700        AND A.VER_STAT_CDE = 'A'                                  17270000
172800        AND A.PO_NBR       = B.PO_NBR                             17280000
172900        AND A.SEQ_NBR      = B.SEQ_NBR                            17290000
173000        AND B.SHIPT_UNT_ID = C.SHIPT_UNT_ID                       17300000
173100        AND B.SHIPT_UNT_ID = D.SHIPT_UNT_ID                       17310000
173200  GROUP BY A.REC_SEQ_NBR                                          17320000
173300        ,C.SHIPT_UNT_ID                                           17330000
173400        ,C.ACTV_IND                                               17340000
173500        ,C.DEST_OPER_UNT_ID                                       17350000
173600        ,A.CRE_TMST                                               17360000
173700        ,C.CRE_DTE                                                17370000
173800        ,C.CRE_TM                                                 17380000
173900      ORDER BY 2                                                  17390000
174000     WITH UR                                                      17400000
174100     END-EXEC.                                                    17410000
174200                                                                  17420000
174300*---------------------------------------------------------------* 17430000
174400*  CURSOR FOR UPC                                                 17440000
174500*---------------------------------------------------------------* 17450000
174600     EXEC SQL                                                     17460000
174700          DECLARE UPC-CSR CURSOR FOR                              17470000
174800     SELECT DISTINCT UPC_NBR                                      17480000
174900           ,TRN_LNE_NBR                                           17490000
175000           ,SUM(SHPD_QTY)                                         17500000
175100       FROM TSHUUPC                                               17510000
175200      WHERE SHIPT_UNT_ID =   :DK-SHIPT-UNT-ID                     17520000
175300      GROUP BY UPC_NBR, TRN_LNE_NBR                               17530000
175400     WITH UR                                                      17540000
175500     END-EXEC.                                                    17550000
175600                                                                  17560000
175700                                                                  17570000
175800*---------------------------------------------------------------* 17580000
175900*  LINE CURSOR                                                    17590000
176000*---------------------------------------------------------------* 17600000
176100                                                                  17610000
176200     EXEC SQL                                                     17620000
176300          DECLARE LINE-CSR CURSOR FOR                             17630000
176400           SELECT ORD_LNE_NBR                                     17640000
176500                 ,PREPK_RATO_QTY                                  17650000
176600             FROM TRECITM                                         17660000
176700            WHERE ORD_NBR       =  :DK-PO-NBR                     17670000
176800              AND REC_SEQ_NBR   =  :DK-REC-SEQ-NBR                17680000
176900              AND ((ORD_LNE_NBR  =  :DK-LINE-NBR  AND             17690000
177000                    :ASC-PKGNG-CDE  NOT IN ('I','M',' '))  OR     17700000
177100                   (PREPK_ID     =  :DK-PREPK-ID  AND             17710000
177200                    :ASC-PKGNG-CDE  IN ('I','M'))          OR     17720000
177300                   (:ASC-PKGNG-CDE  IN (' ')))                    17730000
177400     END-EXEC.                                                    17740000
177500                                                                  17750000
177600*---------------------------------------------------------------* 17760000
177700*  CURSOR FOR TRANSCRIBED PREPACKS                                17770000
177800*  WHEN COMING IN FROM RECEIVER CHECK-IN LIST                     17780000
177900*  (RECEIVING SIMPLIFICATION)                                     17790000
178000*  3/21/2005                                                      17800000
178100*---------------------------------------------------------------* 17810000
178200     EXEC SQL                                                     17820000
178300          DECLARE PO-TRAN-PREPK-CSR CURSOR FOR                    17830000
178400     SELECT                                                       17840000
178500            A.REC_SEQ_NBR                                         17850000
178600          , C.SHIPT_UNT_ID                                        17860000
178700          , C.ACTV_IND                                            17870000
178800          , C.DEST_OPER_UNT_ID                                    17880000
178900          , A.CRE_TMST                                            17890000
179000          , C.CRE_DTE                                             17900000
179100          , C.CRE_TM                                              17910000
179200          , F.PREPK_ID                                            17920000
179300       FROM TPKSLIP A                                             17930000
179400          , TINPKSU B                                             17940000
179500          , TSHPUNT C                                             17950000
179600          , TSHUUPC D                                             17960000
179700          , TRECEIV E                                             17970000
179800          , TRECITM F                                             17980000
179900      WHERE A.PO_NBR       = :DK-PO-NBR                           17990000
180000        AND A.REC_SEQ_NBR  = :DK-REC-SEQ-NBR                      18000000
180100        AND A.VER_STAT_CDE = 'A'                                  18010000
180200        AND A.PKSL_STAT_CDE = 'AC'                                18020000
180300        AND A.PO_NBR       = B.PO_NBR                             18030000
180400        AND A.SEQ_NBR      = B.SEQ_NBR                            18040000
180500        AND B.SHIPT_UNT_ID = C.SHIPT_UNT_ID                       18050000
180600        AND B.SHIPT_UNT_ID = D.SHIPT_UNT_ID                       18060000
180700        AND A.PO_NBR       = E.ORD_NBR                            18070000
180800        AND A.REC_SEQ_NBR  = E.REC_SEQ_NBR                        18080000
180900        AND A.REC_SEQ_NBR  > 0                                    18090000
181000        AND E.PKGNG_CDE   IN ('M','I')                            18100000
181100        AND E.ORD_NBR      = F.ORD_NBR                            18110000
181200        AND E.REC_SEQ_NBR  = F.REC_SEQ_NBR                        18120000
181300        AND D.TRN_LNE_NBR  = F.ORD_LNE_NBR                        18130000
181400        AND D.TRN_LNE_NBR  IN                                     18140000
181500            (SELECT MAX(M.TRN_LNE_NBR)                            18150000
181600               FROM TSHUUPC M                                     18160000
181700                  , TRECITM P                                     18170000
181800              WHERE D.SHIPT_UNT_ID = M.SHIPT_UNT_ID               18180000
181900                AND M.TRN_NBR = P.ORD_NBR                         18190000
182000                AND M.TRN_LNE_NBR   = P.ORD_LNE_NBR               18200000
182100                AND F.REC_SEQ_NBR   = P.REC_SEQ_NBR)              18210000
182200      ORDER BY 8,2                                                18220000
182300     WITH UR                                                      18230000
182400     END-EXEC.                                                    18240000
182500                                                                  18250000
182600*---------------------------------------------------------------* 18260000
182700*  CURSOR FOR NON-PREPACK, NON-PBS ORDERS                         18270000
182800*  WHEN COMING IN FROM RECEIVER CHECK-IN LIST                     18280000
182900*  (RECEIVING SIMPLIFICATION)                                     18290000
183000*  3/21/2005                                                      18300000
183100*---------------------------------------------------------------* 18310000
183200     EXEC SQL                                                     18320000
183300          DECLARE PO-NON-PREPK-CSR CURSOR FOR                     18330000
183400     SELECT                                                       18340000
183500            A.REC_SEQ_NBR                                         18350000
183600          , C.SHIPT_UNT_ID                                        18360000
183700          , C.ACTV_IND                                            18370000
183800          , C.DEST_OPER_UNT_ID                                    18380000
183900          , A.CRE_TMST                                            18390000
184000          , C.CRE_DTE                                             18400000
184100          , C.CRE_TM                                              18410000
184200          , D.TRN_LNE_NBR                                         18420000
184300       FROM TPKSLIP A                                             18430000
184400          , TINPKSU B                                             18440000
184500          , TSHPUNT C                                             18450000
184600          , TSHUUPC D                                             18460000
184700      WHERE A.PO_NBR       = :DK-PO-NBR                           18470000
184800        AND A.REC_SEQ_NBR  = :DK-REC-SEQ-NBR                      18480000
184900        AND A.VER_STAT_CDE = 'A'                                  18490000
185000        AND A.PO_NBR       = B.PO_NBR                             18500000
185100        AND A.SEQ_NBR      = B.SEQ_NBR                            18510000
185200        AND B.SHIPT_UNT_ID = C.SHIPT_UNT_ID                       18520000
185300        AND B.SHIPT_UNT_ID = D.SHIPT_UNT_ID                       18530000
185400        AND D.TRN_LNE_NBR  IN                                     18540000
185500            (SELECT MIN(M.TRN_LNE_NBR)                            18550000
185600               FROM TSHUUPC M                                     18560000
185700              WHERE D.SHIPT_UNT_ID = M.SHIPT_UNT_ID)              18570000
185800      ORDER BY 8,2                                                18580000
185900     WITH UR                                                      18590000
186000     END-EXEC.                                                    18600000
186100                                                                  18610000
186200*---------------------------------------------------------------* 18620000
186300*  CURSOR FOR PBS ORDERS                                          18630000
186400*  WHEN COMING IN FROM RECEIVER CHECK-IN LIST                     18640000
186500*  (RECEIVING SIMPLIFICATION)                                     18650000
186600*  3/21/2005                                                      18660000
186700*---------------------------------------------------------------* 18670000
186800     EXEC SQL                                                     18680000
186900          DECLARE PO-PBS-CSR CURSOR FOR                           18690000
187000     SELECT                                                       18700000
187100            A.REC_SEQ_NBR                                         18710000
187200          , C.SHIPT_UNT_ID                                        18720000
187300          , C.ACTV_IND                                            18730000
187400          , C.DEST_OPER_UNT_ID                                    18740000
187500          , A.CRE_TMST                                            18750000
187600          , C.CRE_DTE                                             18760000
187700          , C.CRE_TM                                              18770000
187800          , COUNT(*)                                              18780000
187900       FROM TPKSLIP A                                             18790000
188000          , TINPKSU B                                             18800000
188100          , TSHPUNT C                                             18810000
188200          , TSHUUPC D                                             18820000
188300      WHERE A.PO_NBR       = :DK-PO-NBR                           18830000
188400        AND A.REC_SEQ_NBR  = :DK-REC-SEQ-NBR                      18840000
188500        AND A.VER_STAT_CDE = 'A'                                  18850000
188600        AND A.PO_NBR       = B.PO_NBR                             18860000
188700        AND A.SEQ_NBR      = B.SEQ_NBR                            18870000
188800        AND B.SHIPT_UNT_ID = C.SHIPT_UNT_ID                       18880000
188900        AND B.SHIPT_UNT_ID = D.SHIPT_UNT_ID                       18890000
189000  GROUP BY A.REC_SEQ_NBR                                          18900000
189100        ,C.SHIPT_UNT_ID                                           18910000
189200        ,C.ACTV_IND                                               18920000
189300        ,C.DEST_OPER_UNT_ID                                       18930000
189400        ,A.CRE_TMST                                               18940000
189500        ,C.CRE_DTE                                                18950000
189600        ,C.CRE_TM                                                 18960000
189700      ORDER BY 2                                                  18970000
189800     WITH UR                                                      18980000
189900     END-EXEC.                                                    18990000
190000                                                                  19000000
190100                                                                  19010000
190200***************************************************************   19020000
190300*                                                                 19030000
190400 LINKAGE SECTION.                                                 19040000
190500                                                                  19050000
190600 01  DFHCOMMAREA.                                                 19060000
190700     05  FILLER                         OCCURS  1 TO 4072 TIMES   19070000
190800                                        DEPENDING ON EIBCALEN.    19080000
190900         10  FILLER                     PIC X.                    19090000
191000                                                                  19100000
191100 EJECT                                                            19110000
191200*                                                                 19120000
191300*                                                                 19130000
191400 PROCEDURE DIVISION.                                              19140000
191500*---------------------------------------------------------------* 19150000
191600*   THIS MODULE IS THE HIGHEST PROCESSING LEVEL IN THE PROGRAM. * 19160000
191700*   FIRST, CALL THE CICS ARCHITECTURE API, PERFORM THE PROGRAM  * 19170000
191800*   PROCESSING AND THEN CALL THE CICS ARCHITECTURE API TO EXIT. * 19180000
191900*---------------------------------------------------------------* 19190000
192000 0000-MAIN-MODULE.                                                19200000
192100     INITIALIZE DP030-CICS-API-FIELDS.                            19210000
192200     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       19220000
192300     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          19230000
192400     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         19240000
192500     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       19250000
192600     MOVE LENGTH OF SUK555I        TO DP030-MAP-LENGTH (1).       19260000
192700     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     19270000
192800     PERFORM 0001-CALL-CICS-ARCH-API.                             19280000
192900*                                                                 19290000
193000     PERFORM 1000-CONTROL-PROCESSING                              19300000
193100                                                                  19310000
193200     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     19320000
193300     PERFORM 0001-CALL-CICS-ARCH-API.                             19330000
193400*                                                                 19340000
193500*                                                                 19350000
193600*---------------------------------------------------------------* 19360000
193700*   THIS PARAGRAPH CALLS THE CICS ARCHITECTURE API SUBROUTINE   * 19370000
193800*   AND WILL ABEND IF ANY ERRORS OCCURRED IN THAT CALL.         * 19380000
193900*---------------------------------------------------------------* 19390000
194000 0001-CALL-CICS-ARCH-API.                                         19400000
194100*    CALL 'DPKCS030' USING DFHEIBLK                               19410013
194100     CALL DP930-CICS-ARCH-API USING DFHEIBLK                      19411013
194200                           DFHCOMMAREA                            19420000
194300                           DP030-CICS-API-FIELDS                  19430000
194400                           DP020-STANDARD-COMMAREA                19440000
194500                           SUK555I.                               19450000
194600*                                                                 19460000
194700     IF DP030-RC-CALL-SUCCESSFUL                                  19470000
194800         CONTINUE                                                 19480000
194900     ELSE                                                         19490000
195000         SET DP013-NO-ROLLBACK                                    19500000
195100             DP013-XCTL-DISPLAY-RESTART                           19510000
195200             DP013-CICS-ABEND      TO TRUE                        19520000
195300         MOVE '0001-CALL-CICS-ARCH-API'                           19530000
195400                                   TO DP013-PARAGRAPH             19540000
195500*        MOVE 'CALL TO DPKCS030 NOT SUCCESSFUL, RETURN-CODE ON NEX19550013
195600*             'T LINE'             TO DP013-MESSAGE-TEXT (2)      19560013
195500         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL. RETURN-CODE O19561013
195600-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      19562013
195700         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      19570000
195800         PERFORM DP013-0000-PROCESS-ABEND                         19580000
195900     END-IF.                                                      19590000
196000*                                                                 19600000
196100*                                                                 19610000
196200*----------------------------------------------------------------*19620000
196300* PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT      *19630000
196400* COURSE OF ACTION IS FOR THIS TRANSACTION.                      *19640000
196500*                                                                *19650000
196600* NOTE:  PV-TOP-ITEM IS THE ITEM THAT IS REQUESTED TO BE AT THE  *19660000
196700*  TOP OF THE PANEL.  MOVING ASC-ITEM-AT-TOP-OF-PANEL TO THIS    *19670000
196800*  MEANS THAT POSITION WITHIN THE LIST WILL NOT CHANGE -- THIS   *19680000
196900*  IS THE DEFAULT WHICH WILL BE OVERRIDDEN BY SCROLLING ACTIONS. *19690000
197000*----------------------------------------------------------------*19700000
197100 1000-CONTROL-PROCESSING.                                         19710000
197200     EVALUATE TRUE                                                19720000
197300         WHEN DP020-NEXT-ACT-INITIAL                              19730000
197400             INITIALIZE ASC-SPECIFIC-COMMAREA                     19740000
197500             MOVE EIBTRMID         TO ASC-LIST-TERM-ID            19750000
197600                                      ASC-SEL-TERM-ID             19760000
197700                                      ASC-SEL-TERM-ID-2           19770000
197800                                      ASC-SEL-TERM-ID-ORIG        19780000
197900             MOVE DP020-SRC-TASK-NUMBER                           19790000
198000                                   TO ASC-LIST-TASK-NUMBER        19800000
198100                                      ASC-SEL-TASK-NUMBER         19810000
198200                                      ASC-SEL-TASK-NUMBER-2       19820000
198300                                      ASC-SEL-TASK-NUMBER-ORIG    19830000
198400             MOVE PC-LIST-QUEUE-SEQ                               19840000
198500                                   TO ASC-LIST-SEQ                19850000
198600             MOVE PC-SEL-QUEUE-SEQ TO ASC-SEL-SEQ                 19860000
198700                                      ASC-SEL-SEQ-2               19870000
198800                                      ASC-SEL-SEQ-ORIG            19880000
198900             SET  ASC-DISPLAY-1-LINE  TO  TRUE                    19890000
199000             PERFORM 1100-PROCESS-INTER-APPL-COMM                 19900000
199100             PERFORM 4000-BUILD-INITIAL-PANEL                     19910000
199200                                                                  19920000
199300*                                                                 19930000
199400* F14 - DISPLAY ALL LINES (LOCAL-FUNC-01)                         19940000
199500*                                                                 19950000
199600         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              19960000
199700             PERFORM 3200-RESET-ATTRIBUTES                        19970000
199800             SET  ASC-DISPLAY-ALL-LINES  TO  TRUE                 19980000
199900             PERFORM 2050-DELETE-LIST-QUEUE                       19990000
200000             PERFORM 4000-BUILD-INITIAL-PANEL                     20000000
200100                                                                  20010000
200200                                                                  20020000
200300         WHEN DP020-NEXT-ACT-READ-MAP                             20030000
200400             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        20040000
200500                                   TO PV-TOP-ITEM                 20050000
200600             PERFORM 2000-PROCESS-PANEL                           20060000
200700                                                                  20070000
200800*F3                                                               20080000
200900         WHEN DP020-NEXT-ACT-RETURN                               20090000
201000             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        20100000
201100                                   TO PV-TOP-ITEM                 20110000
201200             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    20120000
201300             PERFORM 6000-REFRESH-PANEL-FROM-TEMP                 20130000
201400             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 20140000
201500                                                                  20150000
201600         WHEN OTHER                                               20160000
201700             SET DP013-LOGIC-ABEND TO TRUE                        20170000
201800             SET DP013-NO-ROLLBACK TO TRUE                        20180000
201900             MOVE '1000-CONTROL-PROCESSING'                       20190000
202000                                   TO DP013-PARAGRAPH             20200000
202100             MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'    20210000
202200                                   TO DP013-MESSAGE-TEXT(1)       20220000
202300             PERFORM DP013-0000-PROCESS-ABEND                     20230000
202400     END-EVALUATE.                                                20240000
202500                                                                  20250000
202600 EJECT                                                            20260000
202700*                                                                 20270000
202800*                                                                 20280000
202900*----------------------------------------------------------------*20290000
203000* DETERMINE IF DATA WAS PASSED THROUGH INTER-APPL COMMAREA OR    *20300000
203100* IF THERE IS DATA TO BE USED IN THE NAV-KEY FIELD.              *20310000
203200*----------------------------------------------------------------*20320000
203300 1100-PROCESS-INTER-APPL-COMM.                                    20330000
203400     SET PS-COMMAREA-VALID         TO TRUE.                       20340000
203500     MOVE SPACES                   TO ASC-START-ITEM-REQUEST.     20350000
203600*                                                                 20360000
203700* JUST FOR TESTING - BEGIN                                        20370000
203800*    INITIALIZE                   PV-CICS-MSG-AREA2               20380000
203900*    MOVE ASC-SEL-TERM-ID      TO PV-SEL-TERM-ID                  20390000
204000*    MOVE ASC-SEL-TASK-NUMBER  TO PV-SEL-TASK-NUMBER              20400000
204100*    MOVE ASC-SEL-SEQ          TO PV-SEL-SEQ                      20410000
204200*    STRING ' SUKCS555 -'         DELIMITED BY SIZE               20420000
204300*           ' QUEUE 1 TERM ID-'   DELIMITED BY SIZE               20430000
204400*            PV-SEL-TERM-ID       DELIMITED BY SIZE               20440000
204500*           ' QUEUE TASK-'        DELIMITED BY SIZE               20450000
204600*            PV-SEL-TASK-NUMBER   DELIMITED BY SIZE               20460000
204700*           ' QUEUE SEQ-'         DELIMITED BY SIZE               20470000
204800*            PV-SEL-SEQ           DELIMITED BY SIZE               20480000
204900*           ' PARAGRAPH 1100 -'   DELIMITED BY SIZE               20490000
205000*           ' BEFORE '            DELIMITED BY SIZE               20500000
205100*                            INTO PV-CICS-MSG-AREA2               20510000
205200*        MOVE LENGTH OF PV-CICS-MSG-AREA2                         20520000
205300*          TO PV-COMMAREA-LENGTH                                  20530000
205400*        EXEC CICS                                                20540000
205500*             WRITEQ TD                                           20550000
205600*              QUEUE  ('CSSL')                                    20560000
205700*               FROM  (PV-CICS-MSG-AREA2)                         20570000
205800*             LENGTH  (PV-COMMAREA-LENGTH)                        20580000
205900*               RESP  (PV-CICS-RESP)                              20590000
206000*        END-EXEC                                                 20600000
206100*    INITIALIZE                   PV-CICS-MSG-AREA2               20610000
206200*    MOVE ASC-SEL-TERM-ID-ORIG      TO PV-SEL-TERM-ID             20620000
206300*    MOVE ASC-SEL-TASK-NUMBER-ORIG  TO PV-SEL-TASK-NUMBER         20630000
206400*    MOVE ASC-SEL-SEQ-ORIG          TO PV-SEL-SEQ                 20640000
206500*    STRING ' SUKCS555 -'              DELIMITED BY SIZE          20650000
206600*           ' QUEUE ORIG TERM ID- '    DELIMITED BY SIZE          20660000
206700*            PV-SEL-TERM-ID            DELIMITED BY SIZE          20670000
206800*           ' QUEUE TASK-'             DELIMITED BY SIZE          20680000
206900*            PV-SEL-TASK-NUMBER        DELIMITED BY SIZE          20690000
207000*           ' QUEUE SEQ-'              DELIMITED BY SIZE          20700000
207100*            PV-SEL-SEQ                DELIMITED BY SIZE          20710000
207200*           ' PARAGRAPH 1100 -'        DELIMITED BY SIZE          20720000
207300*           ' BEFORE '                 DELIMITED BY SIZE          20730000
207400*                                 INTO PV-CICS-MSG-AREA2          20740000
207500*        MOVE LENGTH OF PV-CICS-MSG-AREA2                         20750000
207600*          TO PV-COMMAREA-LENGTH                                  20760000
207700*        EXEC CICS                                                20770000
207800*             WRITEQ TD                                           20780000
207900*              QUEUE  ('CSSL')                                    20790000
208000*               FROM  (PV-CICS-MSG-AREA2)                         20800000
208100*             LENGTH  (PV-COMMAREA-LENGTH)                        20810000
208200*               RESP  (PV-CICS-RESP)                              20820000
208300*        END-EXEC                                                 20830000
208400* JUST FOR TESTING - END                                          20840000
208500                                                                  20850000
208600     EVALUATE DP020-INT-APPL-FORMAT-IND                           20860000
208700                                                                  20870000
208800*WHEN COMING IN FROM CASEPACK                                     20880000
208900         WHEN PC-LIST-FORMAT                                      20890000
209000           SET ASC-LIST-FORMAT TO TRUE                            20900000
209100           IF SU003-NUMBER-OF-SELECTED-ITEMS > 0                  20910000
209200               MOVE SU003-OPER-UNT-ID      TO ASC-OPER-UNT-ID     20920000
209300               MOVE SU003-FCLTY-ID         TO ASC-FCLTY-ID        20930000
209400               MOVE SU003-FCLTY-NME        TO ASC-FCLTY-NME       20940000
209500               MOVE SU003-SCAC-CDE         TO ASC-SCAC            20950000
209600               MOVE SU003-TRLR-NBR         TO ASC-TRLR-NBR        20960000
209700               MOVE SU003-TRIP-ID          TO ASC-TRIP-ID         20970000
209800               MOVE SU003-PO-NBR           TO ASC-PO-NBR          20980000
209900               MOVE SU003-REC-SEQ-NBR      TO ASC-RECEIVER        20990000
210000               MOVE SU003-SHIPT-UNT-ID     TO ASC-SHIPT-UNT-ID    21000000
210100               MOVE SU003-PKGNG-CD         TO ASC-PKGNG-CDE       21010000
210200                                                                  21020000
210300               SET ASC-USE-SELECTION-QUEUE   TO TRUE              21030000
210400               MOVE SU003-NUMBER-OF-TS-ITEMS                      21040000
210500                                    TO ASC-NUMBER-OF-TS-ITEMS     21050000
210600               MOVE SU003-SEL-QUEUE-NAME                          21060000
210700                                    TO ASC-SEL-QUEUE-NAME-ORIG    21070000
210800               PERFORM 1120-PREPARE-LIST-ENTRY                    21080000
210900           ELSE                                                   21090000
211000               MOVE PC-TSYMSG-00057       TO DP020-MSG-NUMBER     21100000
211100               SET  PS-COMMAREA-NOT-VALID TO TRUE                 21110000
211200           END-IF                                                 21120000
211300                                                                  21130000
211400*WHEN COMING IN FROM UNRESOLVED FREE-ASTRAY LIST                  21140000
211500         WHEN PC-FREE-ASTRAY-FORMAT                               21150000
211600           SET ASC-FREE-ASTRAY-FORMAT TO TRUE                     21160000
211700           IF SU003-NUMBER-OF-SELECTED-ITEMS > 0                  21170000
211800               MOVE SU003-OPER-UNT-ID      TO ASC-OPER-UNT-ID     21180000
211900               MOVE SU003-FCLTY-ID         TO ASC-FCLTY-ID        21190000
212000               MOVE SU003-FCLTY-NME        TO ASC-FCLTY-NME       21200000
212100                                                                  21210000
212200               SET ASC-USE-SELECTION-QUEUE   TO TRUE              21220000
212300               MOVE SU003-NUMBER-OF-TS-ITEMS                      21230000
212400                                    TO ASC-NUMBER-OF-TS-ITEMS     21240000
212500               MOVE SU003-SEL-QUEUE-NAME                          21250000
212600                                    TO ASC-SEL-QUEUE-NAME-ORIG    21260000
212700               PERFORM 1120-PREPARE-LIST-ENTRY                    21270000
212800           ELSE                                                   21280000
212900               MOVE PC-TSYMSG-00057       TO DP020-MSG-NUMBER     21290000
213000               SET  PS-COMMAREA-NOT-VALID TO TRUE                 21300000
213100           END-IF                                                 21310000
213200                                                                  21320000
213300*WHEN COMING IN FROM SUSPENDED VERIFICATION LIST                  21330000
213400         WHEN PC-SUSPEND-VE-FORMAT                                21340000
213500           SET ASC-SUSPEND-VE-FORMAT TO TRUE                      21350000
213600           IF SU003-NUMBER-OF-SELECTED-ITEMS > 0                  21360000
213700               MOVE SU003-OPER-UNT-ID      TO ASC-OPER-UNT-ID     21370000
213800               MOVE SU003-FCLTY-ID         TO ASC-FCLTY-ID        21380000
213900               MOVE SU003-FCLTY-NME        TO ASC-FCLTY-NME       21390000
214000                                                                  21400000
214100               SET ASC-USE-SELECTION-QUEUE   TO TRUE              21410000
214200               MOVE SU003-NUMBER-OF-TS-ITEMS                      21420000
214300                                    TO ASC-NUMBER-OF-TS-ITEMS     21430000
214400               MOVE SU003-SEL-QUEUE-NAME                          21440000
214500                                    TO ASC-SEL-QUEUE-NAME-ORIG    21450000
214600               PERFORM 1120-PREPARE-LIST-ENTRY                    21460000
214700           ELSE                                                   21470000
214800               MOVE PC-TSYMSG-00057       TO DP020-MSG-NUMBER     21480000
214900               SET  PS-COMMAREA-NOT-VALID TO TRUE                 21490000
215000           END-IF                                                 21500000
215100*                                                                 21510000
215200*                                                                 21520000
215300* JUST FOR TESTING - BEGIN                                        21530000
215400*    INITIALIZE                   PV-CICS-MSG-AREA2               21540000
215500*    MOVE ASC-SEL-TERM-ID      TO PV-SEL-TERM-ID                  21550000
215600*    MOVE ASC-SEL-TASK-NUMBER  TO PV-SEL-TASK-NUMBER              21560000
215700*    MOVE ASC-SEL-SEQ          TO PV-SEL-SEQ                      21570000
215800*    STRING ' SUKCS555 -'         DELIMITED BY SIZE               21580000
215900*           ' QUEUE 1 TERM ID-'   DELIMITED BY SIZE               21590000
216000*            PV-SEL-TERM-ID       DELIMITED BY SIZE               21600000
216100*           ' QUEUE TASK-'        DELIMITED BY SIZE               21610000
216200*            PV-SEL-TASK-NUMBER   DELIMITED BY SIZE               21620000
216300*           ' QUEUE SEQ-'         DELIMITED BY SIZE               21630000
216400*            PV-SEL-SEQ           DELIMITED BY SIZE               21640000
216500*           ' PARAGRAPH 1100 -'   DELIMITED BY SIZE               21650000
216600*           ' AFTER  '            DELIMITED BY SIZE               21660000
216700*                            INTO PV-CICS-MSG-AREA2               21670000
216800*        MOVE LENGTH OF PV-CICS-MSG-AREA2                         21680000
216900*          TO PV-COMMAREA-LENGTH                                  21690000
217000*        EXEC CICS                                                21700000
217100*             WRITEQ TD                                           21710000
217200*              QUEUE  ('CSSL')                                    21720000
217300*               FROM  (PV-CICS-MSG-AREA2)                         21730000
217400*             LENGTH  (PV-COMMAREA-LENGTH)                        21740000
217500*               RESP  (PV-CICS-RESP)                              21750000
217600*        END-EXEC                                                 21760000
217700*    INITIALIZE                   PV-CICS-MSG-AREA2               21770000
217800*    MOVE ASC-SEL-TERM-ID-ORIG      TO PV-SEL-TERM-ID             21780000
217900*    MOVE ASC-SEL-TASK-NUMBER-ORIG  TO PV-SEL-TASK-NUMBER         21790000
218000*    MOVE ASC-SEL-SEQ-ORIG          TO PV-SEL-SEQ                 21800000
218100*    STRING ' SUKCS555 -'              DELIMITED BY SIZE          21810000
218200*           ' QUEUE ORIG TERM ID- '    DELIMITED BY SIZE          21820000
218300*            PV-SEL-TERM-ID            DELIMITED BY SIZE          21830000
218400*           ' QUEUE TASK-'             DELIMITED BY SIZE          21840000
218500*            PV-SEL-TASK-NUMBER        DELIMITED BY SIZE          21850000
218600*           ' QUEUE SEQ-'              DELIMITED BY SIZE          21860000
218700*            PV-SEL-SEQ                DELIMITED BY SIZE          21870000
218800*           ' PARAGRAPH 1100 -'        DELIMITED BY SIZE          21880000
218900*           ' AFTER  '                 DELIMITED BY SIZE          21890000
219000*                                 INTO PV-CICS-MSG-AREA2          21900000
219100*        MOVE LENGTH OF PV-CICS-MSG-AREA2                         21910000
219200*          TO PV-COMMAREA-LENGTH                                  21920000
219300*        EXEC CICS                                                21930000
219400*             WRITEQ TD                                           21940000
219500*              QUEUE  ('CSSL')                                    21950000
219600*               FROM  (PV-CICS-MSG-AREA2)                         21960000
219700*             LENGTH  (PV-COMMAREA-LENGTH)                        21970000
219800*               RESP  (PV-CICS-RESP)                              21980000
219900*        END-EXEC.                                                21990000
220000* JUST FOR TESTING - END                                          22000000
220100                                                                  22010000
220200*WHEN COMING IN FROM PACK SLIP HEADER INQUIRY DETAIL SCREEN       22020000
220300         WHEN PC-PKSLHDR-FORMAT                                   22030000
220400            SET ASC-PKSLHDR-FORMAT TO TRUE                        22040000
220500            MOVE RC012-PO-NBR            TO ASC-PO-NBR            22050000
220600                                            DK-PO-NBR             22060000
220700            MOVE RC012-SEQ-NBR           TO ASC-SEQ-NBR           22070000
220800            MOVE RC012-OPER-UNT-ID       TO ASC-OPER-UNT-ID       22080000
220900            MOVE RC012-FCLTY-ID          TO ASC-FCLTY-ID          22090000
221000            MOVE RC012-REC-SEQ-NBR       TO ASC-RECEIVER          22100000
221100                                                                  22110000
221200*WHEN COMING IN FROM PACK SLIP LINE SUMMARY LIST SCREEN           22120000
221300         WHEN PC-PKSLLNE-FORMAT                                   22130000
221400            SET ASC-PKSLLNE-FORMAT TO TRUE                        22140000
221500            IF RC015-NUMBER-OF-SELECTED-ITEMS > 0                 22150000
221600               MOVE RC015-OPER-UNT-ID       TO ASC-OPER-UNT-ID    22160000
221700               MOVE RC015-FCLTY-ID          TO ASC-FCLTY-ID       22170000
221800               MOVE RC015-PO-NBR            TO ASC-PO-NBR         22180000
221900                                               DK-PO-NBR          22190000
222000               MOVE RC015-REC-SEQ-NBR       TO ASC-RECEIVER       22200000
222100                                               DK-REC-SEQ-NBR     22210000
222200               MOVE RC015-SEQ-NBR           TO ASC-SEQ-NBR        22220000
222300                                               DK-SEQ-NBR         22230000
222400                                                                  22240000
222500               SET ASC-USE-SELECTION-QUEUE   TO TRUE              22250000
222600               MOVE RC015-NUMBER-OF-TS-ITEMS                      22260000
222700                                    TO ASC-NUMBER-OF-TS-ITEMS     22270000
222800               MOVE RC015-SEL-QUEUE-NAME                          22280000
222900                                    TO ASC-SEL-QUEUE-NAME-ORIG    22290000
223000               PERFORM 1120A-PREPARE-LIST-ENTRY                   22300000
223100            ELSE                                                  22310000
223200               MOVE PC-TSYMSG-00057       TO DP020-MSG-NUMBER     22320000
223300               SET  PS-COMMAREA-NOT-VALID TO TRUE                 22330000
223400            END-IF                                                22340000
223500                                                                  22350000
223600*WHEN COMING IN FROM RECEIVING SIMPLIFICATION                     22360000
223700         WHEN PC-RCVG-SIMPLE-FORMAT                               22370000
223800           SET ASC-RCVG-SIMPLE-FORMAT TO TRUE                     22380000
223900           IF SU003-NUMBER-OF-SELECTED-ITEMS > 0                  22390000
224000               MOVE SU003-OPER-UNT-ID      TO ASC-OPER-UNT-ID     22400000
224100               MOVE SU003-FCLTY-ID         TO ASC-FCLTY-ID        22410000
224200               MOVE SU003-FCLTY-NME        TO ASC-FCLTY-NME       22420000
224300               MOVE SU003-SCAC-CDE         TO ASC-SCAC            22430000
224400               MOVE SU003-TRLR-NBR         TO ASC-TRLR-NBR        22440000
224500               MOVE SU003-TRIP-ID          TO ASC-TRIP-ID         22450000
224600               MOVE SU003-PO-NBR           TO ASC-PO-NBR          22460000
224700               MOVE SU003-REC-SEQ-NBR      TO ASC-RECEIVER        22470000
224800               MOVE SU003-SHIPT-UNT-ID     TO ASC-SHIPT-UNT-ID    22480000
224900               MOVE SU003-PKGNG-CD         TO ASC-PKGNG-CDE       22490000
225000                                                                  22500000
225100               SET ASC-USE-SELECTION-QUEUE   TO TRUE              22510000
225200               SET SU003-UPDATE-TSQ          TO TRUE              22520000
225300               MOVE SU003-NUMBER-OF-TS-ITEMS                      22530000
225400                                    TO ASC-NUMBER-OF-TS-ITEMS     22540000
225500               MOVE SU003-SEL-QUEUE-NAME                          22550000
225600                                    TO ASC-SEL-QUEUE-NAME-ORIG    22560000
225700               PERFORM 1120-PREPARE-LIST-ENTRY                    22570000
225800           ELSE                                                   22580000
225900               MOVE PC-TSYMSG-00057       TO DP020-MSG-NUMBER     22590000
226000               SET  PS-COMMAREA-NOT-VALID TO TRUE                 22600000
226100           END-IF                                                 22610000
226200                                                                  22620000
226300      END-EVALUATE.                                               22630000
226400*                                                                 22640000
226500*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*22650000
226600 1120-PREPARE-LIST-ENTRY.                                         22660000
226700                                                                  22670000
226800     MOVE SU004-MAX-ITEMS          TO ASC-SEL-SUB.                22680000
226900     MOVE ZERO                     TO ASC-SEL-ITEM.               22690000
227000     PERFORM 1130-GET-NEXT-RECORD.                                22700000
227100*                                                                 22710000
227200*                                                                 22720000
227300*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*22730000
227400 1120A-PREPARE-LIST-ENTRY.                                        22740000
227500                                                                  22750000
227600     MOVE RC013-MAX-ITEMS          TO ASC-SEL-SUB.                22760000
227700     MOVE ZERO                     TO ASC-SEL-ITEM.               22770000
227800     PERFORM 1130A-GET-NEXT-RECORD.                               22780000
227900*                                                                 22790000
228000*                                                                 22800000
228100*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*22810000
228200* GET THE NEXT RECORD IF A LIST OF RECORDS ARE BEING PROCESSED   *22820000
228300*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*22830000
228400 1130-GET-NEXT-RECORD.                                            22840000
228500                                                                  22850000
228600     ADD +1                       TO ASC-SEL-SUB.                 22860000
228700                                                                  22870000
228800     IF  ASC-SEL-SUB > SU004-MAX-ITEMS                            22880000
228900         ADD +1                   TO ASC-SEL-ITEM                 22890000
229000         MOVE +1                  TO ASC-SEL-SUB                  22900000
229100     END-IF.                                                      22910000
229200                                                                  22920000
229300     IF  ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                22930000
229400         PERFORM 9100-READ-SEL-QUEUE                              22940000
229500         IF  SU004-ITEM (ASC-SEL-SUB) > ZERO                      22950000
229600             MOVE SU004-OPER-UNT-ID (ASC-SEL-SUB)                 22960000
229700                                  TO PV-OPER-UNT-ID               22970000
229800             MOVE SU004-FCLTY-ID   (ASC-SEL-SUB)                  22980000
229900                                  TO PV-FCLTY-ID                  22990000
230000             MOVE SU004-PO-NBR      (ASC-SEL-SUB)                 23000000
230100                                  TO PV-PO-NBR                    23010000
230200                                     ASC-PO-NBR                   23020000
230300             MOVE SU004-REC-SEQ-NBR (ASC-SEL-SUB)                 23030000
230400                                  TO PV-RECEIVER                  23040000
230500                                     ASC-RECEIVER                 23050000
230600             MOVE SU004-TRIP-ID     (ASC-SEL-SUB)                 23060000
230700                                  TO PV-TRIP-ID                   23070000
230800                                     ASC-TRIP-ID                  23080000
230900                                     VHTRIP-TRIP-ID               23090000
231000             MOVE SU004-SCAC-CDE    (ASC-SEL-SUB)                 23100000
231100                                  TO PV-SCAC-CDE                  23110000
231200                                     ASC-SCAC                     23120000
231300             MOVE SU004-VEH-NBR     (ASC-SEL-SUB)                 23130000
231400                                  TO PV-VEH-NBR                   23140000
231500                                     ASC-TRLR-NBR                 23150000
231600             MOVE SU004-SHIPT-UNT-ID (ASC-SEL-SUB)                23160000
231700                                  TO PV-SHIPT-UNT-ID              23170000
231800                                     ASC-SHIPT-UNT-ID             23180000
231900             MOVE SU004-LINE-NO (ASC-SEL-SUB)                     23190000
232000                                  TO ASC-LINE                     23200000
232100             IF SU004-ALL-LINES (ASC-SEL-SUB)                     23210000
232200                SET ASC-DISPLAY-ALL-LINES TO TRUE                 23220000
232300             ELSE                                                 23230000
232400                SET ASC-DISPLAY-1-LINE TO TRUE                    23240000
232500             END-IF                                               23250000
232600                                                                  23260000
232700             SET SU004-INQ (ASC-SEL-SUB)                          23270000
232800                                  TO TRUE                         23280000
232900             PERFORM 9200-REWRITE-SEL-QUEUE                       23290000
233000         ELSE                                                     23300000
233100             SUBTRACT +1 FROM ASC-SEL-SUB                         23310000
233200             MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER             23320000
233300             SET DP020-MSG-INFORMATIONAL                          23330000
233400                 PS-LIST-END             TO TRUE                  23340000
233500         END-IF                                                   23350000
233600     ELSE                                                         23360000
233700         SUBTRACT +1 FROM ASC-SEL-ITEM                            23370000
233800         MOVE SU004-MAX-ITEMS     TO ASC-SEL-SUB                  23380000
233900         MOVE PC-TSYMSG-00070     TO DP020-MSG-NUMBER             23390000
234000         SET DP020-MSG-INFORMATIONAL                              23400000
234100             PS-LIST-END             TO TRUE                      23410000
234200     END-IF.                                                      23420000
234300*                                                                 23430000
234400*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*23440000
234500* GET THE NEXT RECORD IF A LIST OF RECORDS ARE BEING PROCESSED   *23450000
234600*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*23460000
234700 1130A-GET-NEXT-RECORD.                                           23470000
234800                                                                  23480000
234900     ADD +1                       TO ASC-SEL-SUB.                 23490000
235000                                                                  23500000
235100     IF  ASC-SEL-SUB > RC013-MAX-ITEMS                            23510000
235200         ADD +1                   TO ASC-SEL-ITEM                 23520000
235300         MOVE +1                  TO ASC-SEL-SUB                  23530000
235400     END-IF.                                                      23540000
235500                                                                  23550000
235600     IF  ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                23560000
235700         PERFORM 9100A-READ-SEL-QUEUE                             23570000
235800         IF  RC013-ITEM (ASC-SEL-SUB) > ZERO                      23580000
235900             MOVE RC013-PKSL-LNE-NBR-N (ASC-SEL-SUB)              23590000
236000                                  TO ASC-LINE                     23600000
236100             SET RC013-INQ (ASC-SEL-SUB)                          23610000
236200                                  TO TRUE                         23620000
236300             PERFORM 9200A-REWRITE-SEL-QUEUE                      23630000
236400         ELSE                                                     23640000
236500             SUBTRACT +1 FROM ASC-SEL-SUB                         23650000
236600             MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER             23660000
236700             SET DP020-MSG-INFORMATIONAL                          23670000
236800                 PS-LIST-END             TO TRUE                  23680000
236900         END-IF                                                   23690000
237000     ELSE                                                         23700000
237100         SUBTRACT +1 FROM ASC-SEL-ITEM                            23710000
237200         MOVE RC013-MAX-ITEMS     TO ASC-SEL-SUB                  23720000
237300         MOVE PC-TSYMSG-00070     TO DP020-MSG-NUMBER             23730000
237400         SET DP020-MSG-INFORMATIONAL                              23740000
237500             PS-LIST-END             TO TRUE                      23750000
237600     END-IF.                                                      23760000
237700*                                                                 23770000
237800*                                                                 23780000
237900*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*23790000
238000*    GET THE PREVIOUS RECORD IF A LIST OF RECORDS ARE BEING      *23800000
238100*    PROCESSED.                                                  *23810000
238200*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*23820000
238300 1140-GET-PREV-RECORD.                                            23830000
238400                                                                  23840000
238500     SUBTRACT +1 FROM ASC-SEL-SUB.                                23850000
238600                                                                  23860000
238700     IF  ASC-SEL-SUB < +1                                         23870000
238800         SUBTRACT +1 FROM ASC-SEL-ITEM                            23880000
238900         MOVE SU004-MAX-ITEMS     TO ASC-SEL-SUB                  23890000
239000     END-IF.                                                      23900000
239100                                                                  23910000
239200     IF  ASC-SEL-ITEM > ZERO                                      23920000
239300         PERFORM 9100-READ-SEL-QUEUE                              23930000
239400             MOVE SU004-OPER-UNT-ID (ASC-SEL-SUB)                 23940000
239500                                  TO PV-OPER-UNT-ID               23950000
239600             MOVE SU004-FCLTY-ID   (ASC-SEL-SUB)                  23960000
239700                                  TO PV-FCLTY-ID                  23970000
239800             MOVE SU004-PO-NBR      (ASC-SEL-SUB)                 23980000
239900                                  TO PV-PO-NBR                    23990000
240000                                     ASC-PO-NBR                   24000000
240100             MOVE SU004-REC-SEQ-NBR (ASC-SEL-SUB)                 24010000
240200                                  TO PV-RECEIVER                  24020000
240300                                     ASC-RECEIVER                 24030000
240400             MOVE SU004-TRIP-ID     (ASC-SEL-SUB)                 24040000
240500                                  TO PV-TRIP-ID                   24050000
240600                                     ASC-TRIP-ID                  24060000
240700                                     VHTRIP-TRIP-ID               24070000
240800             MOVE SU004-SCAC-CDE    (ASC-SEL-SUB)                 24080000
240900                                  TO PV-SCAC-CDE                  24090000
241000                                     ASC-SCAC                     24100000
241100             MOVE SU004-VEH-NBR     (ASC-SEL-SUB)                 24110000
241200                                  TO PV-VEH-NBR                   24120000
241300                                     ASC-TRLR-NBR                 24130000
241400             MOVE SU004-SHIPT-UNT-ID (ASC-SEL-SUB)                24140000
241500                                  TO PV-SHIPT-UNT-ID              24150000
241600                                     ASC-SHIPT-UNT-ID             24160000
241700             MOVE SU004-LINE-NO (ASC-SEL-SUB)                     24170000
241800                                  TO ASC-LINE                     24180000
241900             IF SU004-ALL-LINES (ASC-SEL-SUB)                     24190000
242000                SET ASC-DISPLAY-ALL-LINES TO TRUE                 24200000
242100             ELSE                                                 24210000
242200                SET ASC-DISPLAY-1-LINE TO TRUE                    24220000
242300             END-IF                                               24230000
242400                                                                  24240000
242500         SET SU004-INQ (ASC-SEL-SUB)                              24250000
242600                                  TO TRUE                         24260000
242700         PERFORM 9200-REWRITE-SEL-QUEUE                           24270000
242800     ELSE                                                         24280000
242900         MOVE +1                  TO ASC-SEL-ITEM                 24290000
243000                                     ASC-SEL-SUB                  24300000
243100         MOVE PC-TSYMSG-00069     TO DP020-MSG-NUMBER             24310000
243200         SET DP020-MSG-INFORMATIONAL                              24320000
243300             PS-LIST-END             TO TRUE                      24330000
243400     END-IF.                                                      24340000
243500*                                                                 24350000
243600*                                                                 24360000
243700*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*24370000
243800*    GET THE PREVIOUS RECORD IF A LIST OF RECORDS ARE BEING      *24380000
243900*    PROCESSED.                                                  *24390000
244000*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*24400000
244100 1140A-GET-PREV-RECORD.                                           24410000
244200                                                                  24420000
244300     SUBTRACT +1 FROM ASC-SEL-SUB.                                24430000
244400                                                                  24440000
244500     IF  ASC-SEL-SUB < +1                                         24450000
244600         SUBTRACT +1 FROM ASC-SEL-ITEM                            24460000
244700         MOVE RC013-MAX-ITEMS     TO ASC-SEL-SUB                  24470000
244800     END-IF.                                                      24480000
244900                                                                  24490000
245000     IF  ASC-SEL-ITEM > ZERO                                      24500000
245100         PERFORM 9100A-READ-SEL-QUEUE                             24510000
245200         MOVE RC013-PKSL-LNE-NBR-N (ASC-SEL-SUB)                  24520000
245300                                  TO ASC-LINE                     24530000
245400         SET RC013-INQ (ASC-SEL-SUB)                              24540000
245500                                  TO TRUE                         24550000
245600         PERFORM 9200A-REWRITE-SEL-QUEUE                          24560000
245700     ELSE                                                         24570000
245800         MOVE +1                  TO ASC-SEL-ITEM                 24580000
245900                                     ASC-SEL-SUB                  24590000
246000         MOVE PC-TSYMSG-00069     TO DP020-MSG-NUMBER             24600000
246100         SET DP020-MSG-INFORMATIONAL                              24610000
246200             PS-LIST-END             TO TRUE                      24620000
246300     END-IF.                                                      24630000
246400*                                                                 24640000
246500*                                                                 24650000
246600*----------------------------------------------------------------*24660000
246700* DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITING OF THE DATA    *24670000
246800* ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *24680000
246900* USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *24690000
247000* OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *24700000
247100* FUNCTION KEYS CAN GET THIS FAR.                                *24710000
247200*----------------------------------------------------------------*24720000
247300 2000-PROCESS-PANEL.                                              24730000
247400     EVALUATE TRUE                                                24740000
247500         WHEN DP020-SRC-AID = DP016-CLEAR                         24750000
247600             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    24760000
247700             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   24770000
247800             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 24780000
247900                                                                  24790000
248000         WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    24800000
248100             SET  ASC-DISPLAY-1-LINE  TO  TRUE                    24810000
248200             PERFORM 2050-DELETE-LIST-QUEUE                       24820000
248300             PERFORM 4000-BUILD-INITIAL-PANEL                     24830000
248400                                                                  24840000
248500         WHEN DP020-FK-DESELECT(DP020-SRC-AID)                    24850000
248600             PERFORM 2140-DESELECT-ALL-ITEMS                      24860000
248700             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 24870000
248800*F21                                                              24880000
248900         WHEN DP020-FK-SELECT-ALL (DP020-SRC-AID)                 24890000
249000              PERFORM 2150-SELECT-ALL-ITEMS                       24900000
249100              PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                24910000
249200*F20                                                              24920000
249300         WHEN DP020-FK-NEXT-SELECTION (DP020-SRC-AID)             24930000
249400             IF  ASC-USE-SELECTION-QUEUE                          24940000
249500                 EVALUATE DP020-INT-APPL-FORMAT-IND               24950000
249600                   WHEN PC-PKSLLNE-FORMAT                         24960000
249700                      PERFORM 1130A-GET-NEXT-RECORD               24970000
249800                   WHEN OTHER                                     24980000
249900                      PERFORM 1130-GET-NEXT-RECORD                24990000
250000                 END-EVALUATE                                     25000000
250100                                                                  25010000
250200                 IF PS-LIST-END                                   25020000
250300                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         25030000
250400                     SET PS-NO-LIST-END TO TRUE                   25040000
250500                 ELSE                                             25050000
250600                     PERFORM 2050-DELETE-LIST-QUEUE               25060000
250700                     PERFORM 3200-RESET-ATTRIBUTES                25070000
250800                     PERFORM 4000-BUILD-INITIAL-PANEL             25080000
250900                 END-IF                                           25090000
251000              ELSE                                                25100000
251100                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             25110000
251200*                --- BOTTOM OF LIST ---                           25120000
251300                 MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER         25130000
251400                 SET DP020-MSG-INFORMATIONAL TO TRUE              25140000
251500             END-IF                                               25150000
251600*F19                                                              25160000
251700         WHEN DP020-FK-PREV-SELECTION (DP020-SRC-AID)             25170000
251800             IF  ASC-USE-SELECTION-QUEUE                          25180000
251900                 EVALUATE DP020-INT-APPL-FORMAT-IND               25190000
252000                    WHEN PC-PKSLLNE-FORMAT                        25200000
252100                       PERFORM 1140A-GET-PREV-RECORD              25210000
252200                    WHEN OTHER                                    25220000
252300                       PERFORM 1140-GET-PREV-RECORD               25230000
252400                 END-EVALUATE                                     25240000
252500                                                                  25250000
252600                 IF PS-LIST-END                                   25260000
252700                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         25270000
252800                     SET PS-NO-LIST-END TO TRUE                   25280000
252900                 ELSE                                             25290000
253000                     PERFORM 2050-DELETE-LIST-QUEUE               25300000
253100                     PERFORM 3200-RESET-ATTRIBUTES                25310000
253200                     PERFORM 4000-BUILD-INITIAL-PANEL             25320000
253300                 END-IF                                           25330000
253400             ELSE                                                 25340000
253500                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             25350000
253600                 MOVE PC-TSYMSG-00069 TO DP020-MSG-NUMBER         25360000
253700                 SET DP020-MSG-INFORMATIONAL TO TRUE              25370000
253800             END-IF                                               25380000
253900                                                                  25390000
254000         WHEN OTHER                                               25400000
254100             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 25410000
254200             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   25420000
254300                                                                  25430000
254400             IF  PS-NO-ERROR                                      25440000
254500                 SET DP030-CONTINUE-GO                            25450000
254600                                 TO TRUE                          25460000
254700                 PERFORM 2100-CHECK-FUNCTION-KEY                  25470000
254800             ELSE                                                 25480000
254900                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             25490000
255000                 SET DP030-OVERRIDE-GO                            25500000
255100                                 TO TRUE                          25510000
255200             END-IF                                               25520000
255300     END-EVALUATE.                                                25530000
255400 EJECT                                                            25540000
255500*                                                                 25550000
255600*                                                                 25560000
255700*----------------------------------------------------------------*25570000
255800*  DELETE THE LIST ITEMS TEMP STORAGE QUEUE.                     *25580000
255900*----------------------------------------------------------------*25590000
256000 2050-DELETE-LIST-QUEUE.                                          25600000
256100     EXEC CICS                                                    25610000
256200         DELETEQ TS                                               25620000
256300           QUEUE (ASC-LIST-QUEUE-NAME)                            25630000
256400            RESP (PV-CICS-RESP)                                   25640000
256500     END-EXEC.                                                    25650000
256600                                                                  25660000
256700     IF (PV-CICS-RESP = DFHRESP(NORMAL)) OR                       25670000
256800        (PV-CICS-RESP = DFHRESP(QIDERR))                          25680000
256900         CONTINUE                                                 25690000
257000     ELSE                                                         25700000
257100         SET DP013-CICS-ABEND      TO TRUE                        25710000
257200         SET DP013-NO-ROLLBACK     TO TRUE                        25720000
257300                                                                  25730000
257400         MOVE '2050-DELETE-LIST-QUEUE'                            25740000
257500                                   TO DP013-PARAGRAPH             25750000
257600         MOVE 'ERROR TRYING TO DELETE LIST TEMP STORAGE QUEUE'    25760000
257700                                   TO DP013-MESSAGE-TEXT (1)      25770000
257800         PERFORM DP013-0000-PROCESS-ABEND                         25780000
257900     END-IF.                                                      25790000
258000                                                                  25800000
258100     MOVE +0                       TO ASC-HIGHEST-BLOCK-WRITTEN.  25810000
258200 EJECT                                                            25820000
258300*                                                                 25830000
258400*                                                                 25840000
258500*----------------------------------------------------------------*25850000
258600* ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED FIRST.*25860000
258700* NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED FROM THE  *25870000
258800* CICS ARCHITECTURE API.                                         *25880000
258900*----------------------------------------------------------------*25890000
259000 2100-CHECK-FUNCTION-KEY.                                         25900000
259100*******************************************                       25910000
259200* F23 - CARTON DETAIL LIST (LOCAL-FUNC-02)                        25920000
259300*******************************************                       25930000
259400*                                                                 25940000
259500     EVALUATE TRUE                                                25950000
259600*                                                                 25960000
259700* F23 - CARTON DETAIL LIST (LOCAL-FUNC-02) (SUKCS554)             25970000
259800*                                                                 25980000
259900         WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              25990000
260000             IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO              26000000
260100                 INITIALIZE SU003-INTER-APPL-COMMAREA             26010000
260200                 MOVE ASC-NUMBER-OF-SELECTED-ITEMS                26020000
260300                                TO SU003-NUMBER-OF-SELECTED-ITEMS 26030000
260400                 MOVE ASC-OPER-UNT-ID                             26040000
260500                                TO SU003-OPER-UNT-ID              26050000
260600                 MOVE ASC-SHIPT-UNT-ID                            26060000
260700                                TO SU003-SHIPT-UNT-ID             26070000
260800                 MOVE ASC-PO-NBR                                  26080000
260900                                TO SU003-PO-NBR                   26090000
261000                 MOVE ASC-RECEIVER                                26100000
261100                                TO SU003-REC-SEQ-NBR              26110000
261200                 MOVE ASC-SCAC                                    26120000
261300                                TO SU003-SCAC-CDE                 26130000
261400                 MOVE ASC-TRLR-NBR                                26140000
261500                                TO SU003-TRLR-NBR                 26150000
261600                 MOVE ASC-TRIP-ID                                 26160000
261700                                TO SU003-TRIP-ID                  26170000
261800                 PERFORM 5000-PREPARE-SEL-QUEUE                   26180000
261900             ELSE                                                 26190000
262000                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             26200000
262100                 SET DP030-OVERRIDE-GO                            26210000
262200                                   TO TRUE                        26220000
262300                 MOVE PC-TSYMSG-00057                             26230000
262400                                   TO DP020-MSG-NUMBER            26240000
262500                 SET DP020-MSG-WARNING                            26250000
262600                                   TO TRUE                        26260000
262700             END-IF                                               26270000
262800*                                                                 26280000
262900* F6 - FIRST PAGE (AUTOMATICALLY GOES BACK TO PAGE 1)             26290000
263000*                                                                 26300000
263100         WHEN DP020-FK-FIRST-PAGE(DP020-SRC-AID)                  26310000
263200             MOVE +1               TO PV-TOP-ITEM                 26320000
263300             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 26330000
263400*                                                                 26340000
263500* F7 - PREVIOUS PAGE                                              26350000
263600*                                                                 26360000
263700         WHEN DP020-FK-PREV-PAGE(DP020-SRC-AID)                   26370000
263800             PERFORM 2110-BROWSE-BACKWARD                         26380000
263900             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 26390000
264000*                                                                 26400000
264100* F8 - NEXT PAGE                                                  26410000
264200*                                                                 26420000
264300         WHEN DP020-FK-NEXT-PAGE(DP020-SRC-AID)                   26430000
264400             PERFORM 2120-BROWSE-FORWARD                          26440000
264500             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 26450000
264600*                                                                 26460000
264700* ENTER KEY                                                       26470000
264800*                                                                 26480000
264900         WHEN DP020-SRC-AID = DP016-ENTER                         26490000
265000             PERFORM 2130-CHECK-FOR-JUMP-BROWSE                   26500000
265100             IF  PS-ERROR                                         26510000
265200                 CONTINUE                                         26520000
265300             ELSE                                                 26530000
265400                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             26540000
265500             END-IF                                               26550000
265600                                                                  26560000
265700         WHEN OTHER                                               26570000
265800             SET DP013-NO-ROLLBACK                                26580000
265900                 DP013-XCTL-DISPLAY-RESTART                       26590000
266000                 DP013-CICS-ABEND  TO TRUE                        26600000
266100             MOVE '2100-CHECK-FUNCTION-KEY'                       26610000
266200                                   TO DP013-PARAGRAPH             26620000
266300             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      26630000
266400                                   TO DP013-MESSAGE-TEXT (1)      26640000
266500             PERFORM DP013-0000-PROCESS-ABEND                     26650000
266600     END-EVALUATE.                                                26660000
266700*                                                                 26670000
266800*                                                                 26680000
266900*----------------------------------------------------------------*26690000
267000*    IF THE USER HITS THE PAGE BACKWARD KEY, COMPUTE THE TOP     *26700000
267100*    ITEM NUMBER FOR THE NEW PAGE.  IF IT IS ABOVE THE TOP,      *26710000
267200*    SET THE TOP ITEM NUMBER TO +1 AND DISPLAY THE TOP OF LIST   *26720000
267300*    MESSAGE.                                                    *26730000
267400*----------------------------------------------------------------*26740000
267500 2110-BROWSE-BACKWARD.                                            26750000
267600     SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-AT-TOP-OF-PANEL    26760000
267700         GIVING PV-TOP-ITEM.                                      26770000
267800                                                                  26780000
267900     IF  ((PV-TOP-ITEM < +1)                                      26790000
268000       OR (PV-TOP-ITEM = +1))                                     26800000
268100         MOVE +1                   TO PV-TOP-ITEM                 26810000
268200*        -- TOP OF LIST --                                        26820000
268300         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            26830000
268400         SET DP020-MSG-INFORMATIONAL                              26840000
268500                                   TO TRUE                        26850000
268600     END-IF.                                                      26860000
268700 EJECT                                                            26870000
268800*                                                                 26880000
268900*                                                                 26890000
269000*----------------------------------------------------------------*26900000
269100*    IF THE USER HITS THE PAGE FORWARD KEY, COMPUTE THE TOP      *26910000
269200*    ITEM NUMBER FOR THE NEW PAGE.  IF THE USER ATTEMPTS TO GO   *26920000
269300*    PAST THE END, ISSUE THE BOTTOM OF LIST MESSAGE.             *26930000
269400*----------------------------------------------------------------*26940000
269500 2120-BROWSE-FORWARD.                                             26950000
269600     ADD PC-ITEMS-PER-PANEL ASC-ITEM-AT-TOP-OF-PANEL              26960000
269700         GIVING PV-TOP-ITEM.                                      26970000
269800                                                                  26980000
269900     IF  PV-TOP-ITEM > ASC-NUMBER-OF-ITEMS-READ                   26990000
270000         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            27000000
270100                                   TO PV-TOP-ITEM                 27010000
270200*        -- BOTTOM OF LIST --                                     27020000
270300         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            27030000
270400         SET DP020-MSG-INFORMATIONAL                              27040000
270500                                   TO TRUE                        27050000
270600     ELSE                                                         27060000
270700         COMPUTE PV-BOTTOM-ITEM =                                 27070000
270800             PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1                 27080000
270900         IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ            27090000
271000*            -- BOTTOM OF LIST --                                 27100000
271100             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            27110000
271200             SET DP020-MSG-INFORMATIONAL                          27120000
271300                                   TO TRUE                        27130000
271400         END-IF                                                   27140000
271500     END-IF.                                                      27150000
271600 EJECT                                                            27160000
271700*                                                                 27170000
271800*                                                                 27180000
271900*----------------------------------------------------------------*27190000
272000*    THE USER CAN CHANGE THE CURRENT BEGINNING LIST NUMBER SO    *27200000
272100*    THAT THE TRANSACTION WILL JUMP TO THAT POINT IN THE LIST.   *27210000
272200*    THIS IS A FASTER WAY TO GET TO A CERTAIN POINT IN THE LIST  *27220000
272300*    RATHER THAN HITTING NEXT-PAGE TO GET TO THAT POINT.         *27230000
272400*    THE NEW LIST NUMBER ENTERED IS EDITED TO MAKE SURE THAT     *27240000
272500*    IT IS NUMERIC AND FALLS BETWEEN A SPECIFIED RANGE.          *27250000
272600*----------------------------------------------------------------*27260000
272700 2130-CHECK-FOR-JUMP-BROWSE.                                      27270000
272800     SET PS-NO-ERROR               TO TRUE.                       27280000
272900     IF (ASC-START-ITEM-REQUEST = SPACES)                         27290000
273000         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            27300000
273100                                   TO PV-TOP-ITEM                 27310000
273200     ELSE                                                         27320000
273300         MOVE ASC-START-ITEM-REQUEST                              27330000
273400                                   TO DP010I-UNEDITED-FIELD       27340000
273500         MOVE PC-MSG-NUMBER-LENGTH TO DP010I-MAXIMUM-DIGITS       27350000
273600         MOVE +0                   TO DP010I-MAXIMUM-DECIMALS     27360000
273700         SET DP010I-NEGATIVE-NOT-ALLOWED                          27370000
273800                                   TO TRUE                        27380000
263968         CALL DP010I-NUMERIC-EDIT-ROUTINE                         27391012
263968              USING DP010I-NUMERIC-EDIT-AREA                      27392012
274000                                                                  27400000
274100         IF  NOT DP010I-ERROR-DETECTED                            27410000
274200             MOVE DP010I-NUMERIC-FIELD                            27420000
274300                                   TO ASC-START-ITEM-REQUEST-N    27430000
274400             IF  ASC-START-ITEM-REQUEST-N > ZERO                  27440000
274500                 IF  ASC-START-ITEM-REQUEST-N >                   27450000
274600                                          ASC-NUMBER-OF-ITEMS-READ27460000
274700                     MOVE SPACES TO ASC-START-ITEM-REQUEST        27470000
274800                     COMPUTE PV-TOP-ITEM =                        27480000
274900                             ASC-NUMBER-OF-ITEMS-READ             27490000
275000                             - PC-ITEMS-PER-PANEL + 1             27500000
275100                     IF  PV-TOP-ITEM < +1                         27510000
275200                         MOVE +1   TO PV-TOP-ITEM                 27520000
275300                         MOVE PC-TSYMSG-00070                     27530000
275400                                   TO DP020-MSG-NUMBER            27540000
275500                         SET DP020-MSG-INFORMATIONAL              27550000
275600                                   TO TRUE                        27560000
275700                     END-IF                                       27570000
275800                 ELSE                                             27580000
275900                     MOVE ASC-START-ITEM-REQUEST-N                27590000
276000                                   TO PV-TOP-ITEM                 27600000
276100                     MOVE SPACES   TO ASC-START-ITEM-REQUEST      27610000
276200                     COMPUTE PV-BOTTOM-ITEM =                     27620000
276300                         PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1     27630000
276400                     IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ27640000
276500*                        -- BOTTOM OF LIST --                     27650000
276600                         MOVE PC-TSYMSG-00070                     27660000
276700                                   TO DP020-MSG-NUMBER            27670000
276800                         SET DP020-MSG-INFORMATIONAL              27680000
276900                                   TO TRUE                        27690000
277000                     END-IF                                       27700000
277100                 END-IF                                           27710000
277200             ELSE                                                 27720000
277300*                --- VALUE OUT OF RANGE ----                      27730000
277400                 MOVE PC-TSYMSG-00101                             27740000
277500                                   TO DP020-MSG-NUMBER            27750000
277600                 MOVE -1           TO ASTRTITL                    27760000
277700                 SET DP030-SET-CURSOR-APPL-1                      27770000
277800                                   TO TRUE                        27780000
277900                 MOVE DP015-REVERSE                               27790000
278000                                   TO ASTRTITH                    27800000
278100                 MOVE DP015-RED    TO ASTRTITC                    27810000
278200                 MOVE DP015-UNP-NUM-BRT-MDT                       27820000
278300                                   TO ASTRTITA                    27830000
278400                 SET DP020-MSG-FATAL                              27840000
278500                                   TO TRUE                        27850000
278600                 SET PS-ERROR      TO TRUE                        27860000
278700             END-IF                                               27870000
278800                                                                  27880000
278900         ELSE                                                     27890000
279000             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            27900000
279100             MOVE -1               TO ASTRTITL                    27910000
279200             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  27920000
279300             MOVE DP015-REVERSE    TO ASTRTITH                    27930000
279400             MOVE DP015-RED        TO ASTRTITC                    27940000
279500             MOVE DP015-UNP-NUM-BRT-MDT                           27950000
279600                                   TO ASTRTITA                    27960000
279700             SET DP020-MSG-FATAL   TO TRUE                        27970000
279800             SET PS-ERROR          TO TRUE                        27980000
279900         END-IF                                                   27990000
280000     END-IF.                                                      28000000
280100 EJECT                                                            28010000
280200*                                                                 28020000
280300*                                                                 28030000
280400*----------------------------------------------------------------*28040000
280500*    IF THE USER HITS THE DESELECT KEY, CLEAR THE SELECTION      *28050000
280600*    SWITCH FOR ALL ITEMS THAT WERE PREVIOUSLY SELECTED.         *28060000
280700*    (F9)                                                        *28070000
280800*----------------------------------------------------------------*28080000
280900 2140-DESELECT-ALL-ITEMS.                                         28090000
281000     MOVE +1                       TO ASC-BLK-SUB.                28100000
281100                                                                  28110000
281200     PERFORM 2141-CLEAR-SELECTED-INDS                             28120000
281300         VARYING ASC-ITEM-SUB                                     28130000
281400         FROM 1 BY 1                                              28140000
281500         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 28150000
281600                                                                  28160000
281700     ADD +1                        TO ASC-BLK-SUB.                28170000
281800                                                                  28180000
281900     PERFORM 2141-CLEAR-SELECTED-INDS                             28190000
282000         VARYING ASC-ITEM-SUB                                     28200000
282100         FROM 1 BY 1                                              28210000
282200         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 28220000
282300                                                                  28230000
282400     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               28240000
282500                                   TO PV-LIST-ITEM-NUMBER.        28250000
282600                                                                  28260000
282700     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            28270000
282800         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    28280000
282900                                                                  28290000
283000     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     28300000
283100        (ASC-HIGHEST-BLOCK-WRITTEN > PC-MAX-BLOCKS-IN-ARRAY)      28310000
283200         MOVE +1                   TO ASC-BLK-SUB                 28320000
283300                                                                  28330000
283400         PERFORM 5100-WRITE-TEMP-STORAGE                          28340000
283500                                                                  28350000
283600         MOVE +1                   TO PV-BLOCK-NUMBER             28360000
283700                                                                  28370000
283800         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         28380000
283900             PV-FIRST-BLOCK-IN-ARRAY - 1                          28390000
284000                                                                  28400000
284100         PERFORM                                                  28410000
284200             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       28420000
284300                                                                  28430000
284400             PERFORM 4410-READ-TEMP-STORAGE                       28440000
284500                                                                  28450000
284600             PERFORM 2141-CLEAR-SELECTED-INDS                     28460000
284700                 VARYING ASC-ITEM-SUB FROM 1 BY 1                 28470000
284800                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          28480000
284900                                                                  28490000
285000             PERFORM 5100-WRITE-TEMP-STORAGE                      28500000
285100                                                                  28510000
285200             ADD +1                TO PV-BLOCK-NUMBER             28520000
285300                                                                  28530000
285400         END-PERFORM                                              28540000
285500                                                                  28550000
285600         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         28560000
285700             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     28570000
285800                                                                  28580000
285900         PERFORM                                                  28590000
286000             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       28600000
286100                   ASC-HIGHEST-BLOCK-WRITTEN                      28610000
286200                                                                  28620000
286300             MOVE PV-NEXT-BLOCK-IN-ARRAY                          28630000
286400                                   TO PV-BLOCK-NUMBER             28640000
286500                                                                  28650000
286600             PERFORM 4410-READ-TEMP-STORAGE                       28660000
286700                                                                  28670000
286800             PERFORM 2141-CLEAR-SELECTED-INDS                     28680000
286900                 VARYING ASC-ITEM-SUB                             28690000
287000                 FROM 1 BY 1                                      28700000
287100                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          28710000
287200                                                                  28720000
287300             PERFORM 5100-WRITE-TEMP-STORAGE                      28730000
287400                                                                  28740000
287500             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      28750000
287600                                                                  28760000
287700         END-PERFORM                                              28770000
287800                                                                  28780000
287900         MOVE PV-FIRST-BLOCK-IN-ARRAY                             28790000
288000                                   TO PV-BLOCK-NUMBER             28800000
288100                                                                  28810000
288200         PERFORM 4410-READ-TEMP-STORAGE                           28820000
288300     END-IF.                                                      28830000
288400                                                                  28840000
288500                                                                  28850000
288600     MOVE +0                      TO ASC-NUMBER-OF-SELECTED-ITEMS.28860000
288700     MOVE +0                      TO ASC-START-OF-SELECTED-RANGE. 28870000
288800     MOVE +0                      TO ASC-END-OF-SELECTED-RANGE.   28880000
288900                                                                  28890000
289000     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        28900000
289100                                                                  28910000
289200 EJECT                                                            28920000
289300*                                                                 28930000
289400*                                                                 28940000
289500*----------------------------------------------------------------*28950000
289600*    MARK EACH ITEM AS BEING NOT SELECTED.                       *28960000
289700*----------------------------------------------------------------*28970000
289800 2141-CLEAR-SELECTED-INDS.                                        28980000
289900     IF  ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB ASC-ITEM-SUB)          28990000
290000             NOT EQUAL ZERO                                       29000000
290100         IF  NOT ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          29010000
290200             SET ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          29020000
290300                 ASC-TEMP-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)    29030000
290400                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  29040000
290500                                   TO TRUE                        29050000
290600         END-IF                                                   29060000
290700     END-IF.                                                      29070000
290800                                                                  29080000
290900 EJECT                                                            29090000
291000*                                                                 29100000
291100*                                                                 29110000
291200*----------------------------------------------------------------*29120000
291300*  IF THE USER HITS THE SELECT-ALL KEY, SET THE SELECTIO SWITCH  *29130000
291400*  FOR ALL ITEMS (F21).                                          *29140000
291500*----------------------------------------------------------------*29150000
291600 2150-SELECT-ALL-ITEMS.                                           29160000
291700     MOVE +1                       TO ASC-BLK-SUB.                29170000
291800                                                                  29180000
291900     PERFORM 2151-SET-SELECTED-INDS                               29190000
292000         VARYING ASC-ITEM-SUB                                     29200000
292100         FROM 1 BY 1                                              29210000
292200         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 29220000
292300                                                                  29230000
292400     ADD +1                        TO ASC-BLK-SUB.                29240000
292500                                                                  29250000
292600     PERFORM 2151-SET-SELECTED-INDS                               29260000
292700         VARYING ASC-ITEM-SUB                                     29270000
292800         FROM 1 BY 1                                              29280000
292900         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 29290000
293000                                                                  29300000
293100     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               29310000
293200                                   TO PV-LIST-ITEM-NUMBER.        29320000
293300                                                                  29330000
293400     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            29340000
293500         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    29350000
293600                                                                  29360000
293700* 1/25/01 - BEGIN                                                 29370000
293800     IF  PV-FIRST-BLOCK-IN-ARRAY  = +1                            29380000
293900         MOVE +1                   TO ASC-BLK-SUB                 29390000
294000                                                                  29400000
294100         PERFORM 5100-WRITE-TEMP-STORAGE                          29410000
294200         MOVE +2                   TO ASC-BLK-SUB                 29420000
294300         PERFORM 5100-WRITE-TEMP-STORAGE                          29430000
294400         MOVE +1                   TO ASC-BLK-SUB                 29440000
294500         MOVE +1                   TO PV-BLOCK-NUMBER             29450000
294600     END-IF.                                                      29460000
294700* 1/25/01 - END                                                   29470000
294800                                                                  29480000
294900     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     29490000
295000        (ASC-HIGHEST-BLOCK-WRITTEN >   PC-MAX-BLOCKS-IN-ARRAY)    29500000
295100         MOVE +1                   TO ASC-BLK-SUB                 29510000
295200                                                                  29520000
295300         PERFORM 5100-WRITE-TEMP-STORAGE                          29530000
295400                                                                  29540000
295500* 1/25/01 - BEGIN                                                 29550000
295600         IF (ASC-BLK-SUB               <   PC-MAX-BLOCKS-IN-ARRAY)29560000
295700                                                                  29570000
295800             ADD  +1                   TO ASC-BLK-SUB             29580000
295900                                                                  29590000
296000             PERFORM 5100-WRITE-TEMP-STORAGE                      29600000
296100         END-IF                                                   29610000
296200* 1/25/01 - END                                                   29620000
296300                                                                  29630000
296400         MOVE +1                   TO PV-BLOCK-NUMBER             29640000
296500                                                                  29650000
296600         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         29660000
296700             PV-FIRST-BLOCK-IN-ARRAY - 1                          29670000
296800                                                                  29680000
296900         PERFORM                                                  29690000
297000             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       29700000
297100                                                                  29710000
297200             PERFORM 4410-READ-TEMP-STORAGE                       29720000
297300                                                                  29730000
297400             PERFORM 2151-SET-SELECTED-INDS                       29740000
297500                 VARYING ASC-ITEM-SUB                             29750000
297600                 FROM 1 BY 1                                      29760000
297700                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          29770000
297800                                                                  29780000
297900             PERFORM 5100-WRITE-TEMP-STORAGE                      29790000
298000                                                                  29800000
298100             ADD +1                TO PV-BLOCK-NUMBER             29810000
298200                                                                  29820000
298300         END-PERFORM                                              29830000
298400                                                                  29840000
298500         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         29850000
298600             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     29860000
298700                                                                  29870000
298800         PERFORM                                                  29880000
298900             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       29890000
299000                   ASC-HIGHEST-BLOCK-WRITTEN                      29900000
299100                                                                  29910000
299200             MOVE PV-NEXT-BLOCK-IN-ARRAY                          29920000
299300                                   TO PV-BLOCK-NUMBER             29930000
299400                                                                  29940000
299500             PERFORM 4410-READ-TEMP-STORAGE                       29950000
299600                                                                  29960000
299700             PERFORM 2151-SET-SELECTED-INDS                       29970000
299800                 VARYING ASC-ITEM-SUB                             29980000
299900                 FROM 1 BY 1                                      29990000
300000                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          30000000
300100                                                                  30010000
300200             PERFORM 5100-WRITE-TEMP-STORAGE                      30020000
300300                                                                  30030000
300400             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      30040000
300500                                                                  30050000
300600         END-PERFORM                                              30060000
300700                                                                  30070000
300800         MOVE PV-FIRST-BLOCK-IN-ARRAY                             30080000
300900                                   TO PV-BLOCK-NUMBER             30090000
301000                                                                  30100000
301100         PERFORM 4410-READ-TEMP-STORAGE                           30110000
301200     END-IF.                                                      30120000
301300                                                                  30130000
301400                                                                  30140000
301500     MOVE ASC-NUMBER-OF-ITEMS-READ TO                             30150000
301600                       ASC-NUMBER-OF-SELECTED-ITEMS.              30160000
301700                                                                  30170000
301800     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        30180000
301900                                                                  30190000
302000 EJECT                                                            30200000
302100*                                                                 30210000
302200*                                                                 30220000
302300*----------------------------------------------------------------*30230000
302400*    MARK EACH ITEM AS BEING SELECTED.                           *30240000
302500*----------------------------------------------------------------*30250000
302600 2151-SET-SELECTED-INDS.                                          30260000
302700                                                                  30270000
302800     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           30280000
302900             NOT EQUAL ZERO                                       30290000
303000         IF  NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             30300000
303100             SET ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             30310000
303200                 ASC-TEMP-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)        30320000
303300                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  30330000
303400                                   TO TRUE                        30340000
303500         END-IF                                                   30350000
303600     END-IF.                                                      30360000
303700                                                                  30370000
303800 EJECT                                                            30380000
303900*                                                                 30390000
304000*                                                                 30400000
304100*----------------------------------------------------------------*30410000
304200*  MOVE ALL OF THE FIELDS THAT WERE ENTERED / CHANGED ON THE     *30420000
304300*  SCREEN INTO THE COMMAREA.  ALL EDITING IS DONE IN THE COMM.   *30430000
304400*----------------------------------------------------------------*30440000
304500 2200-MOVE-SCREEN-TO-COMMAREA.                                    30450000
304600     MOVE PV-TOP-ITEM              TO PV-ITEM-IN-USE.             30460000
304700     MOVE +1                       TO PV-SUB.                     30470000
304800                                                                  30480000
304900     PERFORM 3100-SET-SUBSCRIPTS.                                 30490000
305000                                                                  30500000
305100     IF  ASTRTITL > ZERO                                          30510000
305200         MOVE ASTRTITI             TO ASC-START-ITEM-REQUEST      30520000
305300     ELSE                                                         30530000
305400         IF  ASTRTITF = DP015-ERASE-EOF                           30540000
305500             INITIALIZE ASC-START-ITEM-REQUEST                    30550000
305600         END-IF                                                   30560000
305700     END-IF.                                                      30570000
305800                                                                  30580000
305900     PERFORM 2210-MOVE-LINES-TO-COMMAREA                          30590000
306000         VARYING PV-SUB                                           30600000
306100         FROM 1 BY 1                                              30610000
306200         UNTIL PV-SUB > ASC-ITEMS-DISPLAYED.                      30620000
306300*                                                                 30630000
306400*                                                                 30640000
306500*----------------------------------------------------------------*30650000
306600*  MOVE THE ENTERABLE FIELDS ON EACH LIST LINE INTO THE COMMAREA *30660000
306700*----------------------------------------------------------------*30670000
306800 2210-MOVE-LINES-TO-COMMAREA.                                     30680000
306900     IF  MR-SELECTL (PV-SUB) > ZERO                               30690000
307000         SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE             30700000
307100         MOVE MR-SELECTI (PV-SUB)                                 30710000
307200                                   TO ASC-TEMP-SELECTED-SW        30720000
307300                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      30730000
307400     ELSE                                                         30740000
307500         IF  MR-SELECTA (PV-SUB) = DP015-ERASE-EOF                30750000
307600                 SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE     30760000
307700                 MOVE SPACES       TO ASC-TEMP-SELECTED-SW        30770000
307800                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      30780000
307900         END-IF                                                   30790000
308000     END-IF.                                                      30800000
308100                                                                  30810000
308200     ADD +1                        TO ASC-ITEM-SUB.               30820000
308300     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        30830000
308400         ADD +1                    TO ASC-BLK-SUB                 30840000
308500         MOVE +1                   TO ASC-ITEM-SUB                30850000
308600     END-IF.                                                      30860000
308700*                                                                 30870000
308800*                                                                 30880000
308900*----------------------------------------------------------------*30890000
309000*  EDIT ALL OF THE DATA ON THE SCREEN AS IT RESIDES IN THE       *30900000
309100*  COMMAREA (EDITING IS NOT DONE AGAINST THE SCREEN DIRECTLY).   *30910000
309200*----------------------------------------------------------------*30920000
309300 3000-EDIT-DATA-IN-COMMAREA.                                      30930000
309400     SET PS-NO-ERROR               TO TRUE.                       30940000
309500     PERFORM 3200-RESET-ATTRIBUTES.                               30950000
309600     MOVE ASC-ITEMS-DISPLAYED      TO PV-SUB.                     30960000
309700                                                                  30970000
309800**                                                                30980000
309900* CALCULATE THE POSITION OF THE LAST ITEM DISPLAYED.              30990000
310000* EDITING IS DONE FROM THE BOTTOM UP.                             31000000
310100**                                                                31010000
310200     COMPUTE PV-ITEM-IN-USE = PV-TOP-ITEM +                       31020000
310300         ASC-ITEMS-DISPLAYED - 1.                                 31030000
310400     PERFORM 3100-SET-SUBSCRIPTS.                                 31040000
310500                                                                  31050000
310600     IF  PS-NO-ERROR                                              31060000
310700         PERFORM 3005-EDIT-COMMAREA-BLOCKS                        31070000
310800     END-IF.                                                      31080000
310900                                                                  31090000
311000     IF  PS-NO-ERROR                                              31100000
311100         PERFORM 3400-CHECK-RANGE-SEQUENCE                        31110000
311200     END-IF.                                                      31120000
311300*                                                                 31130000
311400     IF  ((PS-NO-ERROR)                                           31140000
311500       AND (ASC-START-OF-SELECTED-RANGE > ZERO)                   31150000
311600       AND (ASC-END-OF-SELECTED-RANGE > ZERO))                    31160000
311700             PERFORM 3500-MARK-RANGE-AS-SELECTED                  31170000
311800     END-IF.                                                      31180000
311900*                                                                 31190000
312000*                                                                 31200000
312100*----------------------------------------------------------------*31210000
312200*   3005-EDIT-COMMAREA-BLOCKS                                    *31220000
312300*----------------------------------------------------------------*31230000
312400 3005-EDIT-COMMAREA-BLOCKS.                                       31240000
312500     MOVE +1                       TO PV-BLOCK-NUMBER.            31250000
312600     MOVE +1                       TO ASC-BLK-SUB.                31260000
312700     MOVE PC-ITEMS-PER-PANEL       TO ASC-ITEM-SUB.               31270000
312800                                                                  31280000
312900     COMPUTE PV-BLOCK-NUMBER  =                                   31290000
313000        1 + ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) /                 31300000
313100            PC-ITEMS-PER-PANEL.                                   31310000
313200                                                                  31320000
313300     MOVE  PV-BLOCK-NUMBER         TO PV-ORIGINAL-BLOCK.          31330000
313400                                                                  31340000
313500     PERFORM                                                      31350000
313600       UNTIL PV-BLOCK-NUMBER > ASC-HIGHEST-BLOCK-WRITTEN          31360000
313700          OR PS-ERROR                                             31370000
313800          OR PS-BLOCK-ERROR                                       31380000
313900                                                                  31390000
314000             COMPUTE PV-ITEMS-HOLD  =                             31400000
314100                     ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) +        31410000
314200                     PC-ITEMS-PER-PANEL - 1                       31420000
314300                                                                  31430000
314400             IF  PV-ITEMS-HOLD  >  ASC-NUMBER-OF-ITEMS-READ       31440000
314500                 SUBTRACT  ASC-NUMBER-OF-ITEMS-READ               31450000
314600                     FROM  PV-ITEMS-HOLD                          31460000
314700                   GIVING  PV-ITEMS-DIFF                          31470000
314800                 SUBTRACT  PV-ITEMS-DIFF                          31480000
314900                     FROM  PC-ITEMS-PER-PANEL                     31490000
315000                   GIVING  PV-ITEMS-HOLD                          31500000
315100                     MOVE  PV-ITEMS-HOLD  TO  PV-SUB              31510000
315200                                              ASC-ITEM-SUB        31520000
315300                                              ASC-ITEMS-DISPLAYED 31530000
315400             ELSE                                                 31540000
315500                 MOVE ASC-ITEMS-DISPLAYED  TO PV-SUB              31550000
315600                 MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB        31560000
315700             END-IF                                               31570000
315800                                                                  31580000
315900             PERFORM 3300-EDIT-SELECTIONS                         31590000
316000                     VARYING PV-SUB                               31600000
316100                        FROM PV-SUB BY -1                         31610000
316200                       UNTIL PV-SUB < +1                          31620000
316300                                                                  31630000
316400             MOVE +1               TO ASC-BLK-SUB                 31640000
316500                                                                  31650000
316600             PERFORM 5105-REWRITE-ASC-LISTQ                       31660000
316700                                                                  31670000
316800             MOVE +1                TO ASC-BLK-SUB                31680000
316900                                                                  31690000
317000             IF  PS-BLOCK-ERROR                                   31700000
317100                 SET  PS-ERROR     TO TRUE                        31710000
317200                 MOVE ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB 1)        31720000
317300                                   TO PV-TOP-ITEM                 31730000
317400             ELSE                                                 31740000
317500                 ADD  +1           TO PV-BLOCK-NUMBER             31750000
317600                 IF  PV-BLOCK-NUMBER >                            31760000
317700                     ASC-HIGHEST-BLOCK-WRITTEN                    31770000
317800                     MOVE +2       TO ASC-BLK-SUB                 31780000
317900                     PERFORM 4410-READ-TEMP-STORAGE               31790000
318000                     MOVE +1       TO ASC-BLK-SUB                 31800000
318100                 ELSE                                             31810000
318200                     PERFORM 4410-READ-TEMP-STORAGE               31820000
318300                     ADD  +1        TO PV-BLOCK-NUMBER            31830000
318400                     MOVE +2        TO ASC-BLK-SUB                31840000
318500                     PERFORM 4410-READ-TEMP-STORAGE               31850000
318600                     SUBTRACT +1  FROM PV-BLOCK-NUMBER            31860000
318700                     MOVE +1        TO ASC-BLK-SUB                31870000
318800                 END-IF                                           31880000
318900             END-IF                                               31890000
319000     END-PERFORM.                                                 31900000
319100                                                                  31910000
319200     IF  PV-ORIGINAL-BLOCK  = +1    OR                            31920000
319300         PS-ERROR                   OR                            31930000
319400         PS-BLOCK-ERROR                                           31940000
319500         CONTINUE                                                 31950000
319600     ELSE                                                         31960000
319700         MOVE +1                 TO PV-BLOCK-NUMBER               31970000
319800         MOVE +1                 TO ASC-BLK-SUB                   31980000
319900         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  31990000
320000         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEMS-DISPLAYED           32000000
320100         PERFORM 4410-READ-TEMP-STORAGE                           32010000
320200                                                                  32020000
320300         PERFORM                                                  32030000
320400           UNTIL PV-BLOCK-NUMBER = PV-ORIGINAL-BLOCK              32040000
320500              OR PS-ERROR                                         32050000
320600              OR PS-BLOCK-ERROR                                   32060000
320700                                                                  32070000
320800                 COMPUTE PV-ITEMS-HOLD  =                         32080000
320900                         ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) +    32090000
321000                         PC-ITEMS-PER-PANEL - 1                   32100000
321100                                                                  32110000
321200                 IF  PV-ITEMS-HOLD > ASC-NUMBER-OF-ITEMS-READ     32120000
321300                     SUBTRACT  ASC-NUMBER-OF-ITEMS-READ           32130000
321400                         FROM  PV-ITEMS-HOLD                      32140000
321500                       GIVING  PV-ITEMS-DIFF                      32150000
321600                     SUBTRACT  PV-ITEMS-DIFF                      32160000
321700                         FROM  PC-ITEMS-PER-PANEL                 32170000
321800                       GIVING  PV-ITEMS-HOLD                      32180000
321900                         MOVE  PV-ITEMS-HOLD TO PV-SUB            32190000
322000                                                ASC-ITEM-SUB      32200000
322100                                               ASC-ITEMS-DISPLAYED32210000
322200                 ELSE                                             32220000
322300                     MOVE ASC-ITEMS-DISPLAYED  TO PV-SUB          32230000
322400                     MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB    32240000
322500                 END-IF                                           32250000
322600                                                                  32260000
322700                 PERFORM 3300-EDIT-SELECTIONS                     32270000
322800                         VARYING PV-SUB                           32280000
322900                            FROM PV-SUB BY -1                     32290000
323000                           UNTIL PV-SUB < +1                      32300000
323100                                                                  32310000
323200                 MOVE +1               TO ASC-BLK-SUB             32320000
323300                                                                  32330000
323400                 PERFORM 5105-REWRITE-ASC-LISTQ                   32340000
323500                                                                  32350000
323600                 MOVE +1                TO ASC-BLK-SUB            32360000
323700                                                                  32370000
323800                 IF  PS-BLOCK-ERROR                               32380000
323900                     SET  PS-ERROR     TO TRUE                    32390000
324000                     MOVE ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB 1)    32400000
324100                                       TO PV-TOP-ITEM             32410000
324200                 ELSE                                             32420000
324300                     ADD  +1            TO PV-BLOCK-NUMBER        32430000
324400                     IF  PV-BLOCK-NUMBER = PV-ORIGINAL-BLOCK      32440000
324500                         MOVE +2        TO ASC-BLK-SUB            32450000
324600                         PERFORM 4410-READ-TEMP-STORAGE           32460000
324700                         MOVE +1        TO ASC-BLK-SUB            32470000
324800                     ELSE                                         32480000
324900                         PERFORM 4410-READ-TEMP-STORAGE           32490000
325000                         ADD  +1        TO PV-BLOCK-NUMBER        32500000
325100                         MOVE +2        TO ASC-BLK-SUB            32510000
325200                         PERFORM 4410-READ-TEMP-STORAGE           32520000
325300                         SUBTRACT +1  FROM PV-BLOCK-NUMBER        32530000
325400                         MOVE +1        TO ASC-BLK-SUB            32540000
325500                     END-IF                                       32550000
325600                 END-IF                                           32560000
325700     END-PERFORM.                                                 32570000
325800*                                                                 32580000
325900*                                                                 32590000
326000*----------------------------------------------------------------*32600000
326100*    DETERMINE THE VALUE OF THE ITEM SUBSCRIPT BASED ON THE ITEM *32610000
326200*    CURRENTLY IN USE AND THE FIRST ITEM IN THE ARRAY.  THIS WILL*32620000
326300*    POSITION US IN THE 1ST BLOCK OF THE ARRAY.                  *32630000
326400*                                                                *32640000
326500*    IF THE ITEM SUBSCRIPT EXCEEDS THE MAXIMUM NUMBER OF ITEMS   *32650000
326600*    IN A BLOCK, RECALCULATE THE SUBSCRIPT BY SUBTRACTING OUT    *32660000
326700*    THE MAXIMUM NUMBER OF ITEMS.  THIS WILL CORRECTLY POSITION  *32670000
326800*    US IN THE 2ND BLOCK OF THE ARRAY.                           *32680000
326900*----------------------------------------------------------------*32690000
327000 3100-SET-SUBSCRIPTS.                                             32700000
327100     COMPUTE ASC-ITEM-SUB =                                       32710000
327200         (PV-ITEM-IN-USE - ASC-LIST-ITEM-NUMBER(1 1)) + 1.        32720000
327300                                                                  32730000
327400     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         32740000
327500         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            32750000
327600                                                                  32760000
327700         MOVE PC-MAX-BLOCKS-IN-ARRAY TO ASC-BLK-SUB               32770000
327800     ELSE                                                         32780000
327900         MOVE +1                     TO ASC-BLK-SUB               32790000
328000     END-IF.                                                      32800000
328100*                                                                 32810000
328200*                                                                 32820000
328300*----------------------------------------------------------------*32830000
328400*  RESET THE ATTRIBUTES OF ALL ENTERABLE FIELDS ON THE MAP.      *32840000
328500*----------------------------------------------------------------*32850000
328600 3200-RESET-ATTRIBUTES.                                           32860000
328700     MOVE DP015-UNP-ALP-NOR-OFF    TO ASTRTITA.                   32870000
328800     MOVE DP015-GREEN              TO ASTRTITC.                   32880000
328900     MOVE DP015-UNDERLINE          TO ASTRTITH.                   32890000
329000                                                                  32900000
329100     PERFORM                                                      32910000
329200         VARYING PV-SUB                                           32920000
329300         FROM 1 BY 1                                              32930000
329400         UNTIL PV-SUB > PC-ITEMS-PER-PANEL                        32940000
329500         MOVE DP015-UNP-ALP-NOR-OFF                               32950000
329600                                   TO MR-SELECTA (PV-SUB)         32960000
329700                                      MR-SELECTA (PV-SUB)         32970000
329800         MOVE DP015-PRO-NOR-MDT                                   32980000
329900                                   TO MR-SHIPA (PV-SUB)           32990000
330000                                      MR-STRA (PV-SUB)            33000000
330100         MOVE DP015-GREEN          TO MR-SELECTC (PV-SUB)         33010000
330200         MOVE DP015-UNDERLINE      TO MR-SELECTH (PV-SUB)         33020000
330300         MOVE DP015-HL-OFF         TO MR-SCACH (PV-SUB)           33030000
330400         MOVE DP015-BLUE           TO MR-SCACC (PV-SUB)           33040000
330500     END-PERFORM.                                                 33050000
330600*                                                                 33060000
330700*                                                                 33070000
330800*----------------------------------------------------------------*33080000
330900*  EDIT THE SELECTIONS MADE.  NOTE THAT THE 'SELECTED-SW' IS     *33090000
331000*  WHAT WAS PREVIOUSLY CHECKED AND CORRECT 'TEMP-SELECTED-SW'    *33100000
331100*  IS WHAT HAS JUST BEEN ENTERED AND HAS NOT BEEN EDITTED OR     *33110000
331200*  WAS ENTERED EARLIER, BUT DID NOT PASS THE EDITS.              *33120000
331300*----------------------------------------------------------------*33130000
331400 3300-EDIT-SELECTIONS.                                            33140000
331500     EVALUATE TRUE                                                33150000
331600         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     33160000
331700             = ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)         33170000
331800                 CONTINUE                                         33180000
331900                                                                  33190000
332000         WHEN ASC-TEMP-SELECT  (ASC-BLK-SUB ASC-ITEM-SUB)         33200000
332100             IF  NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)        33210000
332200                 ADD +1            TO ASC-NUMBER-OF-SELECTED-ITEMS33220000
332300                 MOVE ASC-TEMP-SELECTED-SW                        33230000
332400                                     (ASC-BLK-SUB ASC-ITEM-SUB)   33240000
332500                                   TO ASC-SELECTED-SW             33250000
332600                                     (ASC-BLK-SUB ASC-ITEM-SUB)   33260000
332700             END-IF                                               33270000
332800                                                                  33280000
332900         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     33290000
333000                 = SPACES                                         33300000
333100                                                                  33310000
333200             EVALUATE TRUE                                        33320000
333300                 WHEN ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)       33330000
333400                     SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS33340000
333500                     MOVE SPACES   TO ASC-SELECTED-SW             33350000
333600                                     (ASC-BLK-SUB ASC-ITEM-SUB)   33360000
333700                                                                  33370000
333800                 WHEN ASC-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)        33380000
333900                     MOVE ZERO     TO ASC-START-OF-SELECTED-RANGE 33390000
334000                     MOVE SPACES   TO ASC-SELECTED-SW             33400000
334100                                     (ASC-BLK-SUB ASC-ITEM-SUB)   33410000
334200                                                                  33420000
334300                 WHEN ASC-END (ASC-BLK-SUB ASC-ITEM-SUB)          33430000
334400                     MOVE ZERO     TO ASC-END-OF-SELECTED-RANGE   33440000
334500                     MOVE SPACES   TO ASC-SELECTED-SW             33450000
334600                                     (ASC-BLK-SUB ASC-ITEM-SUB)   33460000
334700             END-EVALUATE                                         33470000
334800                                                                  33480000
334900         WHEN ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)           33490000
335000             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            33500000
335100                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    33510000
335200             END-IF                                               33520000
335300             PERFORM 3310-EDIT-RANGE                              33530000
335400                                                                  33540000
335500         WHEN ASC-TEMP-END (ASC-BLK-SUB ASC-ITEM-SUB)             33550000
335600             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            33560000
335700                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    33570000
335800             END-IF                                               33580000
335900             PERFORM 3310-EDIT-RANGE                              33590000
336000                                                                  33600000
336100         WHEN OTHER                                               33610000
336200             MOVE PC-TSYMSG-00005  TO DP020-MSG-NUMBER            33620000
336300             SET DP020-MSG-FATAL   TO TRUE                        33630000
336400             MOVE -1               TO MR-SELECTL (PV-SUB)         33640000
336500             SET DP030-SET-CURSOR-APPL-1                          33650000
336600                                   TO TRUE                        33660000
336700             MOVE DP015-RED        TO MR-SELECTC (PV-SUB)         33670000
336800             MOVE DP015-REVERSE    TO MR-SELECTH (PV-SUB)         33680000
336900             SET PS-ERROR          TO TRUE                        33690000
337000             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            33700000
337100                 SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS     33710000
337200                 MOVE SPACES       TO ASC-SELECTED-SW             33720000
337300                                     (ASC-BLK-SUB ASC-ITEM-SUB)   33730000
337400             END-IF                                               33740000
337500     END-EVALUATE.                                                33750000
337600                                                                  33760000
337700                                                                  33770000
337800     SUBTRACT +1                   FROM PV-ITEM-IN-USE.           33780000
337900     SUBTRACT +1                   FROM ASC-ITEM-SUB.             33790000
338000                                                                  33800000
338100     IF  ASC-ITEM-SUB < 1                                         33810000
338200         SUBTRACT +1 FROM ASC-BLK-SUB                             33820000
338300         MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB                33830000
338400     END-IF.                                                      33840000
338500*                                                                 33850000
338600*                                                                 33860000
338700*----------------------------------------------------------------*33870000
338800*  IF A BEGINNING AND END OF RANGE WAS ENTERED TO SELECT A       *33880000
338900*  RANGE OF LINES, MAKE SURE THERE IS ONLY 1 BEGINNING AND 1     *33890000
339000*  ENDING AND MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN) *33900000
339100*  THE ENDING.                                                   *33910000
339200*----------------------------------------------------------------*33920000
339300 3310-EDIT-RANGE.                                                 33930000
339400     IF  ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)                33940000
339500         IF  ASC-START-OF-SELECTED-RANGE = ZERO                   33950000
339600             MOVE ASC-TEMP-SELECTED-SW  (ASC-BLK-SUB ASC-ITEM-SUB)33960000
339700                                   TO ASC-SELECTED-SW             33970000
339800                                        (ASC-BLK-SUB ASC-ITEM-SUB)33980000
339900             MOVE PV-ITEM-IN-USE   TO ASC-START-OF-SELECTED-RANGE 33990000
340000         ELSE                                                     34000000
340100             IF  ASC-START-OF-SELECTED-RANGE = PV-ITEM-IN-USE     34010000
340200                 CONTINUE                                         34020000
340300             ELSE                                                 34030000
340400*                -- ONLY ONE BEGINNING-OF-RANGE-ALLOWED --        34040000
340500                 MOVE PC-TSYMSG-00054                             34050000
340600                                       TO DP020-MSG-NUMBER        34060000
340700                 MOVE -1               TO ASTRTITL                34070000
340800                 SET DP020-MSG-FATAL                              34080000
340900                     DP030-SET-CURSOR-APPL-1                      34090000
341000                     PS-ERROR          TO TRUE                    34100000
341100             END-IF                                               34110000
341200         END-IF                                                   34120000
341300     ELSE                                                         34130000
341400         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     34140000
341500             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 34150000
341600                                   TO ASC-SELECTED-SW             34160000
341700                                     (ASC-BLK-SUB ASC-ITEM-SUB)   34170000
341800             MOVE PV-ITEM-IN-USE   TO ASC-END-OF-SELECTED-RANGE   34180000
341900         ELSE                                                     34190000
342000             IF  ASC-END-OF-SELECTED-RANGE = PV-ITEM-IN-USE       34200000
342100                 CONTINUE                                         34210000
342200             ELSE                                                 34220000
342300*                -- ONLY ONE END-OF-RANGE ALLOWED --              34230000
342400                 MOVE PC-TSYMSG-00055                             34240000
342500                                        TO DP020-MSG-NUMBER       34250000
342600                 MOVE -1                TO ASTRTITL               34260000
342700                 SET DP020-MSG-FATAL                              34270000
342800                     DP030-SET-CURSOR-APPL-1                      34280000
342900                     PS-ERROR           TO TRUE                   34290000
343000             END-IF                                               34300000
343100         END-IF                                                   34310000
343200     END-IF.                                                      34320000
343300*                                                                 34330000
343400*                                                                 34340000
343500*----------------------------------------------------------------*34350000
343600*  IF BOTH A BEGINNING AND END OF RANGE HAVE BEEN SPECIFIED,     *34360000
343700*  MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN) THE END.   *34370000
343800*----------------------------------------------------------------*34380000
343900 3400-CHECK-RANGE-SEQUENCE.                                       34390000
344000     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       34400000
344100       AND  ASC-END-OF-SELECTED-RANGE > ZERO                      34410000
344200       AND  ASC-START-OF-SELECTED-RANGE >                         34420000
344300                                         ASC-END-OF-SELECTED-RANGE34430000
344400*        -- END-OF-RANGE BEFORE BEGINNING-OF-RANGE                34440000
344500         MOVE PC-TSYMSG-00052      TO DP020-MSG-NUMBER            34450000
344600         SET DP020-MSG-FATAL       TO TRUE                        34460000
344700         SET PS-ERROR              TO TRUE                        34470000
344800         PERFORM 3410-POSITION-AT-ERROR                           34480000
344900     END-IF.                                                      34490000
345000*                                                                 34500000
345100*                                                                 34510000
345200*----------------------------------------------------------------*34520000
345300*  BECAUSE RANGES CAN SPAN ACROSS MULTIPLE PAGES, A SEPARATE     *34530000
345400*  PARAGRAPH (THIS ONE) IS NEEDED TO DETERMINE WHERE THE CURSOR  *34540000
345500*  SHOULD BE POSITIONED ON A RANGE ERROR.                        *34550000
345600*----------------------------------------------------------------*34560000
345700 3410-POSITION-AT-ERROR.                                          34570000
345800     SET DP030-SET-CURSOR-APPL-1                                  34580000
345900                                   TO TRUE.                       34590000
346000     MOVE -1                       TO ASTRTITL                    34600000
346100     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 34610000
346200                    - PV-TOP-ITEM + 1.                            34620000
346300     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      34630000
346400         CONTINUE                                                 34640000
346500     END-IF.                                                      34650000
346600*                                                                 34660000
346700     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   34670000
346800                    - PV-TOP-ITEM + 1.                            34680000
346900     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      34690000
347000         CONTINUE                                                 34700000
347100     END-IF.                                                      34710000
347200 EJECT                                                            34720000
347300*                                                                 34730000
347400*                                                                 34740000
347500*----------------------------------------------------------------*34750000
347600*    WHENEVER THE USER SELECTS AN ITEM AS THE BEGINNING RANGE    *34760000
347700*    AND ONE AS THE ENDING RANGE, MARK THESE ITEMS AS WELL AS    *34770000
347800*    THOSE THAT FALL IN THE RANGE AS BEING SELECTED.             *34780000
347900*----------------------------------------------------------------*34790000
348000 3500-MARK-RANGE-AS-SELECTED.                                     34800000
348100     MOVE +1                       TO ASC-BLK-SUB.                34810000
348200                                                                  34820000
348300     PERFORM 3510-MARK-SELECTED-INDS                              34830000
348400         VARYING ASC-ITEM-SUB                                     34840000
348500         FROM 1 BY 1                                              34850000
348600         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 34860000
348700                                                                  34870000
348800     ADD +1                        TO ASC-BLK-SUB.                34880000
348900                                                                  34890000
349000     PERFORM 3510-MARK-SELECTED-INDS                              34900000
349100         VARYING ASC-ITEM-SUB                                     34910000
349200         FROM 1 BY 1                                              34920000
349300         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 34930000
349400                                                                  34940000
349500     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               34950000
349600                                   TO PV-LIST-ITEM-NUMBER.        34960000
349700                                                                  34970000
349800     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            34980000
349900         1 + ((PV-LIST-ITEM-NUMBER - 1) /                         34990000
350000               PC-ITEMS-PER-PANEL).                               35000000
350100                                                                  35010000
350200     MOVE ASC-START-OF-SELECTED-RANGE                             35020000
350300                                   TO PV-START-OF-SELECTED-RANGE. 35030000
350400                                                                  35040000
350500     COMPUTE PV-FIRST-BLOCK-IN-RANGE =                            35050000
350600         1 + ((PV-START-OF-SELECTED-RANGE - 1) /                  35060000
350700               PC-ITEMS-PER-PANEL).                               35070000
350800                                                                  35080000
350900     MOVE ASC-END-OF-SELECTED-RANGE                               35090000
351000                                   TO PV-END-OF-SELECTED-RANGE.   35100000
351100                                                                  35110000
351200     COMPUTE PV-LAST-BLOCK-IN-RANGE =                             35120000
351300         1 + ((PV-END-OF-SELECTED-RANGE - 1) /                    35130000
351400               PC-ITEMS-PER-PANEL).                               35140000
351500                                                                  35150000
351600     COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                             35160000
351700         PV-FIRST-BLOCK-IN-ARRAY + 1.                             35170000
351800                                                                  35180000
351900     IF (PV-FIRST-BLOCK-IN-RANGE < PV-FIRST-BLOCK-IN-ARRAY) OR    35190000
352000        (PV-LAST-BLOCK-IN-RANGE  > PV-NEXT-BLOCK-IN-ARRAY)        35200000
352100         MOVE +1                   TO ASC-BLK-SUB                 35210000
352200         PERFORM 5100-WRITE-TEMP-STORAGE                          35220000
352300         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         35230000
352400             PV-FIRST-BLOCK-IN-ARRAY - 1                          35240000
352500                                                                  35250000
352600         PERFORM                                                  35260000
352700             UNTIL PV-FIRST-BLOCK-IN-RANGE >                      35270000
352800                   PV-PREV-BLOCK-IN-ARRAY                         35280000
352900             MOVE PV-FIRST-BLOCK-IN-RANGE                         35290000
353000                                   TO PV-BLOCK-NUMBER             35300000
353100             PERFORM 4410-READ-TEMP-STORAGE                       35310000
353200             PERFORM 3510-MARK-SELECTED-INDS                      35320000
353300                 VARYING ASC-ITEM-SUB                             35330000
353400                 FROM 1 BY 1                                      35340000
353500                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          35350000
353600             PERFORM 5100-WRITE-TEMP-STORAGE                      35360000
353700             ADD +1                TO PV-FIRST-BLOCK-IN-RANGE     35370000
353800         END-PERFORM                                              35380000
353900                                                                  35390000
354000         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         35400000
354100             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     35410000
354200         PERFORM                                                  35420000
354300             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       35430000
354400                   PV-LAST-BLOCK-IN-RANGE                         35440000
354500             MOVE PV-NEXT-BLOCK-IN-ARRAY                          35450000
354600                                   TO PV-BLOCK-NUMBER             35460000
354700             PERFORM 4410-READ-TEMP-STORAGE                       35470000
354800             PERFORM 3510-MARK-SELECTED-INDS                      35480000
354900                 VARYING ASC-ITEM-SUB                             35490000
355000                 FROM 1 BY 1                                      35500000
355100                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          35510000
355200             PERFORM 5100-WRITE-TEMP-STORAGE                      35520000
355300             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      35530000
355400         END-PERFORM                                              35540000
355500                                                                  35550000
355600         MOVE PV-FIRST-BLOCK-IN-ARRAY                             35560000
355700                                   TO PV-BLOCK-NUMBER             35570000
355800         PERFORM 4410-READ-TEMP-STORAGE                           35580000
355900     END-IF.                                                      35590000
356000                                                                  35600000
356100     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE 35610000
356200                                      ASC-END-OF-SELECTED-RANGE.  35620000
356300                                                                  35630000
356400 EJECT                                                            35640000
356500*                                                                 35650000
356600*                                                                 35660000
356700*----------------------------------------------------------------*35670000
356800* SET THE SELECTION INDICATOR TO 'S' WITHIN THE RANGE.           *35680000
356900*----------------------------------------------------------------*35690000
357000 3510-MARK-SELECTED-INDS.                                         35700000
357100     IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB) >         35710000
357200         ASC-START-OF-SELECTED-RANGE)                             35720000
357300     OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB) =         35730000
357400         ASC-START-OF-SELECTED-RANGE)                             35740000
357500                                                                  35750000
357600         IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB) <     35760000
357700             ASC-END-OF-SELECTED-RANGE)                           35770000
357800         OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB) =     35780000
357900             ASC-END-OF-SELECTED-RANGE)                           35790000
358000                                                                  35800000
358100             IF NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          35810000
358200                 SET ASC-SELECT     (ASC-BLK-SUB  ASC-ITEM-SUB)   35820000
358300                     ASC-TEMP-SELECT(ASC-BLK-SUB  ASC-ITEM-SUB)   35830000
358400                                   TO TRUE                        35840000
358500                 SET ASC-BLOCK-MODIFIED(ASC-BLK-SUB)              35850000
358600                                   TO TRUE                        35860000
358700                 ADD +1            TO ASC-NUMBER-OF-SELECTED-ITEMS35870000
358800             END-IF                                               35880000
358900         END-IF                                                   35890000
359000     END-IF.                                                      35900000
359100 EJECT                                                            35910000
359200*                                                                 35920000
359300*                                                                 35930000
359400*----------------------------------------------------------------*35940000
359500*    INITIALIZE BOTH BLOCKS IN THE ARRAY.                        *35950000
359600*    INITIALIZE ALL COUNTERS AND FLAGS.                          *35960000
359700*    READ THE DATA BASE FOR THE 1ST TIME AND FILL UP THE ARRAY.  *35970000
359800*    DISPLAY THE PANEL TO USER.                                  *35980000
359900*----------------------------------------------------------------*35990000
360000 4000-BUILD-INITIAL-PANEL.                                        36000000
360100                                                                  36010000
360200     INITIALIZE ASC-BLOCK-ENTRIES (1)                             36020000
360300                ASC-BLOCK-ENTRIES (2).                            36030000
360400                                                                  36040000
360500     MOVE +1                       TO ASC-BLK-SUB.                36050000
360600                                                                  36060000
360700     SET ASC-ITEMS-LEFT-ON-DB      TO TRUE.                       36070000
360800                                                                  36080000
360900     MOVE +0                       TO ASC-ITEM-SUB                36090000
361000                                      ASC-NUMBER-OF-ITEMS-READ    36100000
361100                                      ASC-NUMBER-OF-SELECTED-ITEMS36110000
361200                                      ASC-HIGHEST-BLOCK-WRITTEN   36120000
361300                                      ASC-START-OF-SELECTED-RANGE 36130000
361400                                      ASC-END-OF-SELECTED-RANGE   36140000
361500                                      ASC-ITEM-AT-TOP-OF-PANEL.   36150000
361600                                                                  36160000
361700     PERFORM 4100-PREPARE-CURSOR                                  36170000
361800                                                                  36180000
361900     IF ASC-RECEIVER > 0                                          36190000
362000        PERFORM 4291A-TRECEIV-PKG-CDE                             36200000
362100     ELSE                                                         36210000
362200        PERFORM 4291B-TPURCHS-PKG-CDE                             36220000
362300     END-IF                                                       36230000
362400                                                                  36240000
362500                                                                  36250000
362600     EVALUATE TRUE                                                36260000
362700       WHEN ASC-FREE-ASTRAY-FORMAT                                36270000
362800       WHEN ASC-SUSPEND-VE-FORMAT                                 36280000
362900          PERFORM 4265-OPEN-FREE-ASTRAY-CSR                       36290000
363000                                                                  36300000
363100       WHEN ASC-PKSLHDR-FORMAT                                    36310000
363200          IF PS-NO-PO                                             36320000
363300              SET ASC-NON-PREPK-CURSOR TO TRUE                    36330000
363400              PERFORM 4210C-OPEN-NON-PREPK-CSR                    36340000
363500          ELSE                                                    36350000
363600              IF ASC-PRE-PACK-ORDER                               36360000
363700                 PERFORM 4285-CHECK-IF-TRANSCRIBED                36370000
363800                 IF ASC-TRANSCRIBED                               36380000
363900                    SET ASC-TRAN-PREPK-CURSOR TO TRUE             36390000
364000                    PERFORM 4210A-OPEN-TRAN-PREPK-CSR             36400000
364100                 ELSE                                             36410000
364200                    SET ASC-NOT-TRAN-PREPK-CURSOR TO TRUE         36420000
364300                    PERFORM 4210B-OPEN-NOT-TRAN-PREPK-CSR         36430000
364400              ELSE                                                36440000
364500                 IF ASC-PKGNG-CDE = SPACES                        36450000
364600                    SET ASC-PBS-CURSOR TO TRUE                    36460000
364700                    PERFORM 4210D-OPEN-PBS-CSR                    36470000
364800                 ELSE                                             36480000
364900                    SET ASC-NON-PREPK-CURSOR TO TRUE              36490000
365000                    PERFORM 4210C-OPEN-NON-PREPK-CSR              36500000
365100                 END-IF                                           36510000
365200              END-IF                                              36520000
365300          END-IF                                                  36530000
365400                                                                  36540000
365500       WHEN ASC-PKSLLNE-FORMAT                                    36550000
365600          IF  ASC-DISPLAY-1-LINE                                  36560000
365700             PERFORM 4230-OPEN-PACKSLIP-LINE-CSR                  36570000
365800          ELSE                                                    36580000
365900             PERFORM 4230A-OPEN-ALL-LINES-CSR                     36590000
366000          END-IF                                                  36600000
366100                                                                  36610000
366200       WHEN ASC-LIST-FORMAT                                       36620000
366300           IF  ASC-DISPLAY-1-LINE                                 36630000
366400               IF  PS-NO-PO                                       36640000
366500                   PERFORM 4010-OPEN-CARTON-CURSOR                36650000
366600               ELSE                                               36660000
366700                   IF  ASC-PRE-PACK-ORDER                         36670000
366800                       PERFORM 4005-GET-PRE-PACK-ID               36680000
366900                       PERFORM 4012-OPEN-CARTON-CURSOR            36690000
367000                   ELSE                                           36700000
367100                       PERFORM 4010-OPEN-CARTON-CURSOR            36710000
367200                   END-IF                                         36720000
367300               END-IF                                             36730000
367400           ELSE                                                   36740000
367500               IF  PS-NO-PO                                       36750000
367600                   PERFORM 4015-OPEN-CARTON-ALL                   36760000
367700               ELSE                                               36770000
367800                   IF  ASC-PRE-PACK-ORDER                         36780000
367900                       PERFORM 4017-OPEN-CARTON-ALL               36790000
368000                   ELSE                                           36800000
368100                       PERFORM 4015-OPEN-CARTON-ALL               36810000
368200                   END-IF                                         36820000
368300               END-IF                                             36830000
368400           END-IF                                                 36840000
368500                                                                  36850000
368600* 03/21/2005 - DMH - BEGIN                                        36860000
368700       WHEN ASC-RCVG-SIMPLE-FORMAT                                36870000
368800          IF PS-NO-PO                                             36880000
368900              SET ASC-PO-NON-PREPK-CURSOR TO TRUE                 36890000
369000              PERFORM 4210G-OPEN-PO-NON-PREPK-CSR                 36900000
369100          ELSE                                                    36910000
369200              IF ASC-PRE-PACK-ORDER                               36920000
369300                    SET ASC-PO-TRAN-PREPK-CURSOR TO TRUE          36930000
369400                    PERFORM 4210E-OPEN-PO-TRAN-PREPK-CSR          36940000
369500              ELSE                                                36950000
369600                 IF ASC-PKGNG-CDE = SPACES                        36960000
369700                    SET ASC-PO-PBS-CURSOR TO TRUE                 36970000
369800                    PERFORM 4210H-OPEN-PO-PBS-CSR                 36980000
369900                 ELSE                                             36990000
370000                    SET ASC-PO-NON-PREPK-CURSOR TO TRUE           37000000
370100                    PERFORM 4210G-OPEN-PO-NON-PREPK-CSR           37010000
370200                 END-IF                                           37020000
370300              END-IF                                              37030000
370400          END-IF                                                  37040000
370500* 03/21/2005 - DMH - END                                          37050000
370600                                                                  37060000
370700     END-EVALUATE                                                 37070000
370800                                                                  37080000
370900     SET PS-CARTON-CSR-FIRST TO TRUE.                             37090000
371000                                                                  37100000
371100     PERFORM 4320-GET-VENDOR-NAME.                                37110000
371200                                                                  37120000
371300     PERFORM 4300-READ-ITEMS-FROM-DB.                             37130000
371400                                                                  37140000
371500     EVALUATE TRUE                                                37150000
371600       WHEN ASC-FREE-ASTRAY-FORMAT                                37160000
371700       WHEN ASC-SUSPEND-VE-FORMAT                                 37170000
371800          PERFORM 4275-CLOSE-FREE-ASTRAY-CSR                      37180000
371900                                                                  37190000
372000       WHEN ASC-PKSLHDR-FORMAT                                    37200000
372100          EVALUATE TRUE                                           37210000
372200             WHEN ASC-TRAN-PREPK-CURSOR                           37220000
372300                PERFORM 4220A-CLOSE-TRAN-PREPK-CSR                37230000
372400             WHEN ASC-NOT-TRAN-PREPK-CURSOR                       37240000
372500                PERFORM 4220B-CLOSE-NOT-TRAN-PREPK-CSR            37250000
372600             WHEN ASC-PBS-CURSOR                                  37260000
372700                PERFORM 4220D-CLOSE-PBS-CSR                       37270000
372800             WHEN ASC-NON-PREPK-CURSOR                            37280000
372900                PERFORM 4220C-CLOSE-NON-PREPK-CSR                 37290000
373000          END-EVALUATE                                            37300000
373100                                                                  37310000
373200       WHEN ASC-PKSLLNE-FORMAT                                    37320000
373300          IF  ASC-DISPLAY-1-LINE                                  37330000
373400             PERFORM 4240-CLOSE-PACKSLIP-LINE-CSR                 37340000
373500          ELSE                                                    37350000
373600             PERFORM 4240A-CLOSE-ALL-LINES-CSR                    37360000
373700          END-IF                                                  37370000
373800                                                                  37380000
373900       WHEN ASC-LIST-FORMAT                                       37390000
374000          IF  ASC-DISPLAY-1-LINE                                  37400000
374100              IF  PS-NO-PO                                        37410000
374200                  PERFORM 4020-CLOSE-CARTON-CURSOR                37420000
374300              ELSE                                                37430000
374400                  IF  ASC-PRE-PACK-ORDER                          37440000
374500                      PERFORM 4022-CLOSE-CARTON-CURSOR            37450000
374600                  ELSE                                            37460000
374700                      PERFORM 4020-CLOSE-CARTON-CURSOR            37470000
374800                  END-IF                                          37480000
374900              END-IF                                              37490000
375000          ELSE                                                    37500000
375100              IF  PS-NO-PO                                        37510000
375200                  PERFORM 4025-CLOSE-CARTON-ALL                   37520000
375300              ELSE                                                37530000
375400                  IF  ASC-PRE-PACK-ORDER                          37540000
375500                      PERFORM 4027-CLOSE-CARTON-ALL               37550000
375600                  ELSE                                            37560000
375700                      PERFORM 4025-CLOSE-CARTON-ALL               37570000
375800                  END-IF                                          37580000
375900              END-IF                                              37590000
376000          END-IF                                                  37600000
376100                                                                  37610000
376200          IF PS-USE-SHIPT-CSR                                     37620000
376300             PERFORM 4040-CLOSE-SHIPT-CURSOR                      37630000
376400          END-IF                                                  37640000
376500                                                                  37650000
376600* 03/21/2005 - DMH - BEGIN                                        37660000
376700       WHEN ASC-RCVG-SIMPLE-FORMAT                                37670000
376800          EVALUATE TRUE                                           37680000
376900             WHEN ASC-PO-TRAN-PREPK-CURSOR                        37690000
377000                PERFORM 4220E-CLOSE-PO-TRAN-PREPK-CSR             37700000
377100             WHEN ASC-PO-PBS-CURSOR                               37710000
377200                PERFORM 4220H-CLOSE-PO-PBS-CSR                    37720000
377300             WHEN ASC-PO-NON-PREPK-CURSOR                         37730000
377400                PERFORM 4220G-CLOSE-PO-NON-PREPK-CSR              37740000
377500          END-EVALUATE                                            37750000
377600* 03/21/2005 - DMH - END                                          37760000
377700                                                                  37770000
377800     END-EVALUATE.                                                37780000
377900                                                                  37790000
378000                                                                  37800000
378100     MOVE +1                   TO  PV-TOP-ITEM                    37810000
378200     IF  ASC-NUMBER-OF-ITEMS-READ = ZERO                          37820000
378300***     SET DP020-NEXT-ACT-APPL-ERROR TO TRUE                     37830000
378400        SET DP020-MSG-FATAL   TO  TRUE                            37840000
378500        MOVE PC-TSYMSG-00050  TO  DP020-MSG-NUMBER                37850000
378600                                                                  37860000
378700        PERFORM                                                   37870000
378800            VARYING PV-SUB                                        37880000
378900            FROM 1 BY 1                                           37890000
379000            UNTIL PV-SUB > PC-ITEMS-PER-PANEL                     37900000
379100               MOVE DP015-ASK-DRK-OFF TO MR-SELECTA (PV-SUB)      37910000
379200                                          MR-SHIPA (PV-SUB)       37920000
379300                                          MR-STRA (PV-SUB)        37930000
379400               MOVE DP015-HL-OFF TO MR-SELECTH (PV-SUB)           37940000
379500               MOVE SPACES       TO MR-SELECTI (PV-SUB)           37950000
379600                                          MR-ACTION (PV-SUB)      37960000
379700                                          MR-SHIP (PV-SUB)        37970000
379800                                          MR-LINE (PV-SUB)        37980000
379900                                          MR-STAT (PV-SUB)        37990000
380000                                          MR-STR (PV-SUB)         38000000
380100                                          MR-DATE (PV-SUB)        38010000
380200                                          MR-TIME (PV-SUB)        38020000
380300                                          MR-TRIP (PV-SUB)        38030000
380400                                          MR-SCAC (PV-SUB)        38040000
380500                                          MR-TRLR (PV-SUB)        38050000
380600        END-PERFORM                                               38060000
380700                                                                  38070000
380800     ELSE                                                         38080000
380900        MOVE -1               TO MR-SELECTL (1)                   38090000
381000        SET DP030-SET-CURSOR-APPL-1                               38100000
381100                              TO TRUE                             38110000
381200        PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                      38120000
381300     END-IF.                                                      38130000
381400 EJECT                                                            38140000
381500                                                                  38150000
381600*----------------------------------------------------------------*38160000
381700* GET THE PRE PACK ID.                                           *38170000
381800*----------------------------------------------------------------*38180000
381900 4005-GET-PRE-PACK-ID.                                            38190000
382000     PERFORM                                                      38200000
382100         WITH TEST AFTER                                          38210000
382200         VARYING PV-RETRY-COUNTER                                 38220000
382300         FROM 1 BY 1                                              38230000
382400         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               38240000
382500             OR (SQLCODE = +0)                                    38250000
382600             OR (SQLCODE = +100)                                  38260000
382700             OR (SQLCODE = -305))                                 38270000
382800                                                                  38280000
382900         EXEC SQL                                                 38290000
383000              SELECT PREPK_ID                                     38300000
383100                INTO :DK-PREPK-ID                                 38310000
383200              FROM   TRECITM                                      38320000
383300              WHERE ORD_LNE_NBR   = :DK-LINE-NBR                  38330000
383400                AND ORD_NBR       = :DK-PO-NBR                    38340000
383500                AND REC_SEQ_NBR   = :DK-REC-SEQ-NBR               38350000
383600         END-EXEC                                                 38360000
383700                                                                  38370000
383800         EVALUATE TRUE                                            38380000
383900             WHEN SQLCODE = +0                                    38390000
384000             WHEN SQLCODE = +100                                  38400000
384100             WHEN SQLCODE = -904                                  38410000
384200             WHEN SQLCODE = -913                                  38420000
384300                  CONTINUE                                        38430000
384400             WHEN SQLWARN0 NOT = SPACES                           38440000
384500             WHEN SQLCODE < +0                                    38450000
384600             WHEN SQLCODE > +0                                    38460000
384700                  MOVE '4005-GET-PRE-PACK-ID'                     38470000
384800                                  TO DP013-PARAGRAPH              38480000
384900                  MOVE 'UNSUCCESSFUL SELECT ON TENTNME'           38490000
385000                                  TO DP013-MESSAGE-TEXT (1)       38500000
385100                  MOVE SQLCA      TO DP013-SQLCA                  38510000
385200                  MOVE 'TRECITM ' TO DP013-DB2-TABLE-NAME (1)     38520000
385300                  SET DP013-DB2-ABEND                             38530000
385400                      DP013-XCTL-DISPLAY-RESTART                  38540000
385500                                  TO TRUE                         38550000
385600                  PERFORM DP013-0000-PROCESS-ABEND                38560000
385700         END-EVALUATE                                             38570000
385800     END-PERFORM.                                                 38580000
385900                                                                  38590000
386000     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    38600000
386100         SQLCODE NOT = +0                                         38610000
386200         MOVE '4005-GET-PRE-PACK-ID'                              38620000
386300                                  TO DP013-PARAGRAPH              38630000
386400         MOVE 'MAX RETRIES EXCEEDED ON SELECT TRECITM'            38640000
386500                                  TO DP013-MESSAGE-TEXT (1)       38650000
386600         MOVE SQLCA               TO DP013-SQLCA                  38660000
386700         MOVE 'TRECITM '          TO DP013-DB2-TABLE-NAME (1)     38670000
386800         SET DP013-DB2-ABEND                                      38680000
386900             DP013-XCTL-DISPLAY-RESTART                           38690000
387000                                  TO TRUE                         38700000
387100         PERFORM DP013-0000-PROCESS-ABEND                         38710000
387200     END-IF.                                                      38720000
387300                                                                  38730000
387400                                                                  38740000
387500*----------------------------------------------------------------*38750000
387600* OPEN CARTON CURSOR.                     **** ONE LINE ONLY *****38760000
387700*----------------------------------------------------------------*38770000
387800 4010-OPEN-CARTON-CURSOR.                                         38780000
387900     PERFORM                                                      38790000
388000         WITH TEST AFTER                                          38800000
388100         VARYING PV-RETRY-COUNTER                                 38810000
388200         FROM 1 BY 1                                              38820000
388300         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               38830000
388400                   OR (SQLCODE = ZERO))                           38840000
388500                                                                  38850000
388600                  EXEC SQL                                        38860000
388700                       OPEN CARTON-CSR                            38870000
388800                  END-EXEC                                        38880000
388900                                                                  38890000
389000         EVALUATE TRUE                                            38900000
389100             WHEN SQLCODE = ZERO                                  38910000
389200             WHEN SQLCODE = -904                                  38920000
389300             WHEN SQLCODE = -913                                  38930000
389400                  CONTINUE                                        38940000
389500             WHEN SQLWARN0 NOT = SPACES                           38950000
389600             WHEN SQLCODE  < ZERO                                 38960000
389700             WHEN SQLCODE  > ZERO                                 38970000
389800                  MOVE '4010-OPEN-CARTON-CURSOR'                  38980000
389900                                   TO DP013-PARAGRAPH             38990000
390000                  MOVE 'OPEN CARTON CURSOR - '                    39000000
390100                                   TO DP013-MESSAGE-TEXT (1)      39010000
390200                  MOVE SQLCA       TO DP013-SQLCA                 39020000
390300                  MOVE 'TSHIPMT'   TO DP013-DB2-TABLE-NAME (1)    39030000
390400                  MOVE 'TSHPTPO'   TO DP013-DB2-TABLE-NAME (2)    39040000
390500                  MOVE 'TPKSLIP'   TO DP013-DB2-TABLE-NAME (3)    39050000
390600                  MOVE 'TINPKSU'   TO DP013-DB2-TABLE-NAME (4)    39060000
390700                  MOVE 'TSHUNLO'   TO DP013-DB2-TABLE-NAME (5)    39070000
390800                  SET DP013-DB2-ABEND                             39080000
390900                      DP013-XCTL-DISPLAY-RESTART TO TRUE          39090000
391000                  PERFORM DP013-0000-PROCESS-ABEND                39100000
391100         END-EVALUATE                                             39110000
391200     END-PERFORM.                                                 39120000
391300                                                                  39130000
391400     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        39140000
391500         MOVE '4010-OPEN-CARTON-CURSOR' TO DP013-PARAGRAPH        39150000
391600         MOVE 'MAX RETRIES EXCEEDED ATTEMPTING TO OPEN CSR'       39160000
391700                                   TO DP013-MESSAGE-TEXT (1)      39170000
391800         MOVE SQLCA                TO DP013-SQLCA                 39180000
391900         MOVE 'TSHIPMT'   TO DP013-DB2-TABLE-NAME (1)             39190000
392000         MOVE 'TSHPTPO'   TO DP013-DB2-TABLE-NAME (2)             39200000
392100         MOVE 'TPKSLIP'   TO DP013-DB2-TABLE-NAME (3)             39210000
392200         MOVE 'TINPKSU'   TO DP013-DB2-TABLE-NAME (4)             39220000
392300         MOVE 'TSHUNLO'   TO DP013-DB2-TABLE-NAME (5)             39230000
392400         SET DP013-DB2-ABEND                                      39240000
392500             DP013-XCTL-DISPLAY-RESTART TO TRUE                   39250000
392600         PERFORM DP013-0000-PROCESS-ABEND                         39260000
392700     END-IF.                                                      39270000
392800 EJECT                                                            39280000
392900                                                                  39290000
393000*----------------------------------------------------------------*39300000
393100* OPEN CARTON CURSOR.                     **** ONE LINE ONLY *****39310000
393200*----------------------------------------------------------------*39320000
393300 4012-OPEN-CARTON-CURSOR.                                         39330000
393400     PERFORM                                                      39340000
393500         WITH TEST AFTER                                          39350000
393600         VARYING PV-RETRY-COUNTER                                 39360000
393700         FROM 1 BY 1                                              39370000
393800         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               39380000
393900                   OR (SQLCODE = ZERO))                           39390000
394000                                                                  39400000
394100                  EXEC SQL                                        39410000
394200                       OPEN CARTON-PACK-CSR                       39420000
394300                  END-EXEC                                        39430000
394400                                                                  39440000
394500         EVALUATE TRUE                                            39450000
394600             WHEN SQLCODE = ZERO                                  39460000
394700             WHEN SQLCODE = -904                                  39470000
394800             WHEN SQLCODE = -913                                  39480000
394900                  CONTINUE                                        39490000
395000             WHEN SQLWARN0 NOT = SPACES                           39500000
395100             WHEN SQLCODE  < ZERO                                 39510000
395200             WHEN SQLCODE  > ZERO                                 39520000
395300                  MOVE '4012-OPEN-CARTON-CURSOR'                  39530000
395400                                   TO DP013-PARAGRAPH             39540000
395500                  MOVE 'OPEN CARTON CURSOR - '                    39550000
395600                                   TO DP013-MESSAGE-TEXT (1)      39560000
395700                  MOVE SQLCA       TO DP013-SQLCA                 39570000
395800                  MOVE 'TSHIPMT'   TO DP013-DB2-TABLE-NAME (1)    39580000
395900                  MOVE 'TSHPTPO'   TO DP013-DB2-TABLE-NAME (2)    39590000
396000                  MOVE 'TPKSLIP'   TO DP013-DB2-TABLE-NAME (3)    39600000
396100                  MOVE 'TINPKSU'   TO DP013-DB2-TABLE-NAME (4)    39610000
396200                  MOVE 'TSHUNLO'   TO DP013-DB2-TABLE-NAME (5)    39620000
396300                  SET DP013-DB2-ABEND                             39630000
396400                      DP013-XCTL-DISPLAY-RESTART TO TRUE          39640000
396500                  PERFORM DP013-0000-PROCESS-ABEND                39650000
396600         END-EVALUATE                                             39660000
396700     END-PERFORM.                                                 39670000
396800                                                                  39680000
396900     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        39690000
397000         MOVE '4012-OPEN-CARTON-CURSOR' TO DP013-PARAGRAPH        39700000
397100         MOVE 'MAX RETRIES EXCEEDED ATTEMPTING TO OPEN CSR'       39710000
397200                                   TO DP013-MESSAGE-TEXT (1)      39720000
397300         MOVE SQLCA                TO DP013-SQLCA                 39730000
397400         MOVE 'TSHIPMT'   TO DP013-DB2-TABLE-NAME (1)             39740000
397500         MOVE 'TSHPTPO'   TO DP013-DB2-TABLE-NAME (2)             39750000
397600         MOVE 'TPKSLIP'   TO DP013-DB2-TABLE-NAME (3)             39760000
397700         MOVE 'TINPKSU'   TO DP013-DB2-TABLE-NAME (4)             39770000
397800         MOVE 'TSHUNLO'   TO DP013-DB2-TABLE-NAME (5)             39780000
397900         SET DP013-DB2-ABEND                                      39790000
398000             DP013-XCTL-DISPLAY-RESTART TO TRUE                   39800000
398100         PERFORM DP013-0000-PROCESS-ABEND                         39810000
398200     END-IF.                                                      39820000
398300 EJECT                                                            39830000
398400                                                                  39840000
398500                                                                  39850000
398600*----------------------------------------------------------------*39860000
398700* OPEN CARTON CURSOR.                     **** ALL LINES ****    *39870000
398800*----------------------------------------------------------------*39880000
398900 4015-OPEN-CARTON-ALL.                                            39890000
399000     PERFORM                                                      39900000
399100         WITH TEST AFTER                                          39910000
399200         VARYING PV-RETRY-COUNTER                                 39920000
399300         FROM 1 BY 1                                              39930000
399400         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               39940000
399500                   OR (SQLCODE = ZERO))                           39950000
399600                                                                  39960000
399700                  EXEC SQL                                        39970000
399800                       OPEN ALL-CARTON-CSR                        39980000
399900                  END-EXEC                                        39990000
400000                                                                  40000000
400100         EVALUATE TRUE                                            40010000
400200             WHEN SQLCODE = ZERO                                  40020000
400300             WHEN SQLCODE = -904                                  40030000
400400             WHEN SQLCODE = -913                                  40040000
400500                  CONTINUE                                        40050000
400600             WHEN SQLWARN0 NOT = SPACES                           40060000
400700             WHEN SQLCODE  < ZERO                                 40070000
400800             WHEN SQLCODE  > ZERO                                 40080000
400900                  MOVE '4015-OPEN-CARTON-CURSOR'                  40090000
401000                                   TO DP013-PARAGRAPH             40100000
401100                  MOVE 'OPEN CARTON CURSOR - ALL LINES '          40110000
401200                                   TO DP013-MESSAGE-TEXT (1)      40120000
401300                  MOVE SQLCA       TO DP013-SQLCA                 40130000
401400                  MOVE 'TSHIPMT'   TO DP013-DB2-TABLE-NAME (1)    40140000
401500                  MOVE 'TSHPTPO'   TO DP013-DB2-TABLE-NAME (2)    40150000
401600                  MOVE 'TPKSLIP'   TO DP013-DB2-TABLE-NAME (3)    40160000
401700                  MOVE 'TINPKSU'   TO DP013-DB2-TABLE-NAME (4)    40170000
401800                  MOVE 'TSHUNLO'   TO DP013-DB2-TABLE-NAME (5)    40180000
401900                  SET DP013-DB2-ABEND                             40190000
402000                      DP013-XCTL-DISPLAY-RESTART TO TRUE          40200000
402100                  PERFORM DP013-0000-PROCESS-ABEND                40210000
402200         END-EVALUATE                                             40220000
402300     END-PERFORM.                                                 40230000
402400                                                                  40240000
402500     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        40250000
402600         MOVE '4015-OPEN-CARTON-ALL   ' TO DP013-PARAGRAPH        40260000
402700         MOVE 'MAX RETRIES EXCEEDED ATTEMPTING TO OPEN CSR'       40270000
402800                                   TO DP013-MESSAGE-TEXT (1)      40280000
402900         MOVE SQLCA                TO DP013-SQLCA                 40290000
403000         MOVE 'TSHIPMT'   TO DP013-DB2-TABLE-NAME (1)             40300000
403100         MOVE 'TSHPTPO'   TO DP013-DB2-TABLE-NAME (2)             40310000
403200         MOVE 'TPKSLIP'   TO DP013-DB2-TABLE-NAME (3)             40320000
403300         MOVE 'TINPKSU'   TO DP013-DB2-TABLE-NAME (4)             40330000
403400         MOVE 'TSHUNLO'   TO DP013-DB2-TABLE-NAME (5)             40340000
403500         SET DP013-DB2-ABEND                                      40350000
403600             DP013-XCTL-DISPLAY-RESTART TO TRUE                   40360000
403700         PERFORM DP013-0000-PROCESS-ABEND                         40370000
403800     END-IF.                                                      40380000
403900 EJECT                                                            40390000
404000                                                                  40400000
404100*----------------------------------------------------------------*40410000
404200* OPEN CARTON CURSOR.                     **** ALL LINES ****    *40420000
404300*----------------------------------------------------------------*40430000
404400 4017-OPEN-CARTON-ALL.                                            40440000
404500     PERFORM                                                      40450000
404600         WITH TEST AFTER                                          40460000
404700         VARYING PV-RETRY-COUNTER                                 40470000
404800         FROM 1 BY 1                                              40480000
404900         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               40490000
405000                   OR (SQLCODE = ZERO))                           40500000
405100                                                                  40510000
405200                  EXEC SQL                                        40520000
405300                       OPEN ALL-CTN-PACK-CSR                      40530000
405400                  END-EXEC                                        40540000
405500                                                                  40550000
405600         EVALUATE TRUE                                            40560000
405700             WHEN SQLCODE = ZERO                                  40570000
405800             WHEN SQLCODE = -904                                  40580000
405900             WHEN SQLCODE = -913                                  40590000
406000                  CONTINUE                                        40600000
406100             WHEN SQLWARN0 NOT = SPACES                           40610000
406200             WHEN SQLCODE  < ZERO                                 40620000
406300             WHEN SQLCODE  > ZERO                                 40630000
406400                  MOVE '4017-OPEN-CARTON-CURSOR'                  40640000
406500                                   TO DP013-PARAGRAPH             40650000
406600                  MOVE 'OPEN CARTON CURSOR - ALL LINES '          40660000
406700                                   TO DP013-MESSAGE-TEXT (1)      40670000
406800                  MOVE SQLCA       TO DP013-SQLCA                 40680000
406900                  MOVE 'TSHIPMT'   TO DP013-DB2-TABLE-NAME (1)    40690000
407000                  MOVE 'TSHPTPO'   TO DP013-DB2-TABLE-NAME (2)    40700000
407100                  MOVE 'TPKSLIP'   TO DP013-DB2-TABLE-NAME (3)    40710000
407200                  MOVE 'TINPKSU'   TO DP013-DB2-TABLE-NAME (4)    40720000
407300                  MOVE 'TSHUNLO'   TO DP013-DB2-TABLE-NAME (5)    40730000
407400                  SET DP013-DB2-ABEND                             40740000
407500                      DP013-XCTL-DISPLAY-RESTART TO TRUE          40750000
407600                  PERFORM DP013-0000-PROCESS-ABEND                40760000
407700         END-EVALUATE                                             40770000
407800     END-PERFORM.                                                 40780000
407900                                                                  40790000
408000     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        40800000
408100         MOVE '4017-OPEN-CARTON-ALL   ' TO DP013-PARAGRAPH        40810000
408200         MOVE 'MAX RETRIES EXCEEDED ATTEMPTING TO OPEN CSR'       40820000
408300                                   TO DP013-MESSAGE-TEXT (1)      40830000
408400         MOVE SQLCA                TO DP013-SQLCA                 40840000
408500         MOVE 'TSHIPMT'   TO DP013-DB2-TABLE-NAME (1)             40850000
408600         MOVE 'TSHPTPO'   TO DP013-DB2-TABLE-NAME (2)             40860000
408700         MOVE 'TPKSLIP'   TO DP013-DB2-TABLE-NAME (3)             40870000
408800         MOVE 'TINPKSU'   TO DP013-DB2-TABLE-NAME (4)             40880000
408900         MOVE 'TSHUNLO'   TO DP013-DB2-TABLE-NAME (5)             40890000
409000         SET DP013-DB2-ABEND                                      40900000
409100             DP013-XCTL-DISPLAY-RESTART TO TRUE                   40910000
409200         PERFORM DP013-0000-PROCESS-ABEND                         40920000
409300     END-IF.                                                      40930000
409400 EJECT                                                            40940000
409500                                                                  40950000
409600                                                                  40960000
409700*----------------------------------------------------------------*40970000
409800* CLOSE CARTON CURSOR.                     **** ONLY 1 LINE **** *40980000
409900*----------------------------------------------------------------*40990000
410000 4020-CLOSE-CARTON-CURSOR.                                        41000000
410100             EXEC SQL                                             41010000
410200                  CLOSE CARTON-CSR                                41020000
410300             END-EXEC                                             41030000
410400                                                                  41040000
410500     EVALUATE TRUE                                                41050000
410600         WHEN SQLCODE = ZERO                                      41060000
410700              CONTINUE                                            41070000
410800         WHEN SQLWARN0 NOT = SPACES                               41080000
410900         WHEN SQLCODE  < ZERO                                     41090000
411000         WHEN SQLCODE  > ZERO                                     41100000
411100              MOVE '4020-CLOSE-CARTON-CURSOR'                     41110000
411200                                   TO DP013-PARAGRAPH             41120000
411300              MOVE 'CLOSE CARTON CURSOR'                          41130000
411400                                   TO DP013-MESSAGE-TEXT (1)      41140000
411500              MOVE SQLCA           TO DP013-SQLCA                 41150000
411600              MOVE 'TSHIPMT'   TO DP013-DB2-TABLE-NAME (1)        41160000
411700              MOVE 'TSHPTPO'   TO DP013-DB2-TABLE-NAME (2)        41170000
411800              MOVE 'TPKSLIP'   TO DP013-DB2-TABLE-NAME (3)        41180000
411900              MOVE 'TINPKSU'   TO DP013-DB2-TABLE-NAME (4)        41190000
412000              MOVE 'TSHUNLO'   TO DP013-DB2-TABLE-NAME (5)        41200000
412100              SET DP013-DB2-ABEND                                 41210000
412200                  DP013-XCTL-DISPLAY-RESTART                      41220000
412300                                   TO TRUE                        41230000
412400              PERFORM DP013-0000-PROCESS-ABEND                    41240000
412500     END-EVALUATE.                                                41250000
412600                                                                  41260000
412700*----------------------------------------------------------------*41270000
412800* CLOSE CARTON CURSOR.                     **** ONLY 1 LINE **** *41280000
412900*----------------------------------------------------------------*41290000
413000 4022-CLOSE-CARTON-CURSOR.                                        41300000
413100             EXEC SQL                                             41310000
413200                  CLOSE CARTON-PACK-CSR                           41320000
413300             END-EXEC                                             41330000
413400                                                                  41340000
413500     EVALUATE TRUE                                                41350000
413600         WHEN SQLCODE = ZERO                                      41360000
413700              CONTINUE                                            41370000
413800         WHEN SQLWARN0 NOT = SPACES                               41380000
413900         WHEN SQLCODE  < ZERO                                     41390000
414000         WHEN SQLCODE  > ZERO                                     41400000
414100              MOVE '4022-CLOSE-CARTON-CURSOR'                     41410000
414200                                   TO DP013-PARAGRAPH             41420000
414300              MOVE 'CLOSE CARTON CURSOR'                          41430000
414400                                   TO DP013-MESSAGE-TEXT (1)      41440000
414500              MOVE SQLCA           TO DP013-SQLCA                 41450000
414600              MOVE 'TSHIPMT'   TO DP013-DB2-TABLE-NAME (1)        41460000
414700              MOVE 'TSHPTPO'   TO DP013-DB2-TABLE-NAME (2)        41470000
414800              MOVE 'TPKSLIP'   TO DP013-DB2-TABLE-NAME (3)        41480000
414900              MOVE 'TINPKSU'   TO DP013-DB2-TABLE-NAME (4)        41490000
415000              MOVE 'TSHUNLO'   TO DP013-DB2-TABLE-NAME (5)        41500000
415100              SET DP013-DB2-ABEND                                 41510000
415200                  DP013-XCTL-DISPLAY-RESTART                      41520000
415300                                   TO TRUE                        41530000
415400              PERFORM DP013-0000-PROCESS-ABEND                    41540000
415500     END-EVALUATE.                                                41550000
415600 EJECT                                                            41560000
415700                                                                  41570000
415800                                                                  41580000
415900*----------------------------------------------------------------*41590000
416000* CLOSE CARTON CURSOR.                     **** ALL LINES ****   *41600000
416100*----------------------------------------------------------------*41610000
416200 4025-CLOSE-CARTON-ALL.                                           41620000
416300             EXEC SQL                                             41630000
416400                  CLOSE ALL-CARTON-CSR                            41640000
416500             END-EXEC                                             41650000
416600                                                                  41660000
416700     EVALUATE TRUE                                                41670000
416800         WHEN SQLCODE = ZERO                                      41680000
416900              CONTINUE                                            41690000
417000         WHEN SQLWARN0 NOT = SPACES                               41700000
417100         WHEN SQLCODE  < ZERO                                     41710000
417200         WHEN SQLCODE  > ZERO                                     41720000
417300              MOVE '4025-CLOSE-CARTON-ALL   '                     41730000
417400                                   TO DP013-PARAGRAPH             41740000
417500              MOVE 'CLOSE CARTON CURSOR - ALL LINES'              41750000
417600                                   TO DP013-MESSAGE-TEXT (1)      41760000
417700              MOVE SQLCA           TO DP013-SQLCA                 41770000
417800              MOVE 'TSHIPMT'   TO DP013-DB2-TABLE-NAME (1)        41780000
417900              MOVE 'TSHPTPO'   TO DP013-DB2-TABLE-NAME (2)        41790000
418000              MOVE 'TPKSLIP'   TO DP013-DB2-TABLE-NAME (3)        41800000
418100              MOVE 'TINPKSU'   TO DP013-DB2-TABLE-NAME (4)        41810000
418200              MOVE 'TSHUNLO'   TO DP013-DB2-TABLE-NAME (5)        41820000
418300              SET DP013-DB2-ABEND                                 41830000
418400                  DP013-XCTL-DISPLAY-RESTART                      41840000
418500                                   TO TRUE                        41850000
418600              PERFORM DP013-0000-PROCESS-ABEND                    41860000
418700     END-EVALUATE.                                                41870000
418800 EJECT                                                            41880000
418900                                                                  41890000
419000*----------------------------------------------------------------*41900000
419100* CLOSE CARTON CURSOR.                     **** ALL LINES ****   *41910000
419200*----------------------------------------------------------------*41920000
419300 4027-CLOSE-CARTON-ALL.                                           41930000
419400             EXEC SQL                                             41940000
419500                  CLOSE ALL-CTN-PACK-CSR                          41950000
419600             END-EXEC                                             41960000
419700                                                                  41970000
419800     EVALUATE TRUE                                                41980000
419900         WHEN SQLCODE = ZERO                                      41990000
420000              CONTINUE                                            42000000
420100         WHEN SQLWARN0 NOT = SPACES                               42010000
420200         WHEN SQLCODE  < ZERO                                     42020000
420300         WHEN SQLCODE  > ZERO                                     42030000
420400              MOVE '4027-CLOSE-CARTON-ALL   '                     42040000
420500                                   TO DP013-PARAGRAPH             42050000
420600              MOVE 'CLOSE CARTON CURSOR - ALL LINES'              42060000
420700                                   TO DP013-MESSAGE-TEXT (1)      42070000
420800              MOVE SQLCA           TO DP013-SQLCA                 42080000
420900              MOVE 'TSHIPMT'   TO DP013-DB2-TABLE-NAME (1)        42090000
421000              MOVE 'TSHPTPO'   TO DP013-DB2-TABLE-NAME (2)        42100000
421100              MOVE 'TPKSLIP'   TO DP013-DB2-TABLE-NAME (3)        42110000
421200              MOVE 'TINPKSU'   TO DP013-DB2-TABLE-NAME (4)        42120000
421300              MOVE 'TSHUNLO'   TO DP013-DB2-TABLE-NAME (5)        42130000
421400              SET DP013-DB2-ABEND                                 42140000
421500                  DP013-XCTL-DISPLAY-RESTART                      42150000
421600                                   TO TRUE                        42160000
421700              PERFORM DP013-0000-PROCESS-ABEND                    42170000
421800     END-EVALUATE.                                                42180000
421900 EJECT                                                            42190000
422000                                                                  42200000
422100                                                                  42210000
422200*----------------------------------------------------------------*42220000
422300* OPEN SHIPT-CURSOR.                   **** ONLY 1 LINE ****     *42230000
422400*----------------------------------------------------------------*42240000
422500 4030-OPEN-SHIPT-CURSOR.                                          42250000
422600     PERFORM                                                      42260000
422700         WITH TEST AFTER                                          42270000
422800         VARYING PV-RETRY-COUNTER                                 42280000
422900         FROM 1 BY 1                                              42290000
423000         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               42300000
423100                   OR (SQLCODE = ZERO))                           42310000
423200                                                                  42320000
423300                  EXEC SQL                                        42330000
423400                       OPEN SHIPT-CSR                             42340000
423500                  END-EXEC                                        42350000
423600                                                                  42360000
423700         EVALUATE TRUE                                            42370000
423800             WHEN SQLCODE = ZERO                                  42380000
423900             WHEN SQLCODE = -904                                  42390000
424000             WHEN SQLCODE = -913                                  42400000
424100                  CONTINUE                                        42410000
424200             WHEN SQLWARN0 NOT = SPACES                           42420000
424300             WHEN SQLCODE  < ZERO                                 42430000
424400             WHEN SQLCODE  > ZERO                                 42440000
424500                  MOVE '4030-OPEN-SHIPT-CURSOR'                   42450000
424600                                   TO DP013-PARAGRAPH             42460000
424700                  MOVE 'OPEN SHIPT CURSOR - '                     42470000
424800                                   TO DP013-MESSAGE-TEXT (1)      42480000
424900                  MOVE SQLCA       TO DP013-SQLCA                 42490000
425000                  MOVE 'TSHUNLO'   TO DP013-DB2-TABLE-NAME (1)    42500000
425100                  MOVE 'TSHUUPC'   TO DP013-DB2-TABLE-NAME (2)    42510000
425200                  MOVE 'TSHPUNT'   TO DP013-DB2-TABLE-NAME (3)    42520000
425300                  MOVE 'TVHTRIP'   TO DP013-DB2-TABLE-NAME (4)    42530000
425400                  SET DP013-DB2-ABEND                             42540000
425500                      DP013-XCTL-DISPLAY-RESTART TO TRUE          42550000
425600                  PERFORM DP013-0000-PROCESS-ABEND                42560000
425700         END-EVALUATE                                             42570000
425800     END-PERFORM.                                                 42580000
425900                                                                  42590000
426000     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        42600000
426100         MOVE '4030-OPEN-SHIPT-CURSOR' TO DP013-PARAGRAPH         42610000
426200         MOVE 'MAX RETRIES EXCEEDED ATTEMPTING TO OPEN CSR'       42620000
426300                                   TO DP013-MESSAGE-TEXT (1)      42630000
426400         MOVE SQLCA                TO DP013-SQLCA                 42640000
426500         MOVE 'TSHUNLO'   TO DP013-DB2-TABLE-NAME (1)             42650000
426600         MOVE 'TSHUUPC'   TO DP013-DB2-TABLE-NAME (2)             42660000
426700         MOVE 'TSHPUNT'   TO DP013-DB2-TABLE-NAME (3)             42670000
426800         MOVE 'TVHTRIP'   TO DP013-DB2-TABLE-NAME (4)             42680000
426900         SET DP013-DB2-ABEND                                      42690000
427000             DP013-XCTL-DISPLAY-RESTART TO TRUE                   42700000
427100         PERFORM DP013-0000-PROCESS-ABEND                         42710000
427200     END-IF.                                                      42720000
427300 EJECT                                                            42730000
427400                                                                  42740000
427500                                                                  42750000
427600*----------------------------------------------------------------*42760000
427700* OPEN SHIPT-CURSOR.                   **** ALL LINES ****       *42770000
427800*----------------------------------------------------------------*42780000
427900 4035-OPEN-SHIPT-ALL.                                             42790000
428000     PERFORM                                                      42800000
428100         WITH TEST AFTER                                          42810000
428200         VARYING PV-RETRY-COUNTER                                 42820000
428300         FROM 1 BY 1                                              42830000
428400         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               42840000
428500                   OR (SQLCODE = ZERO))                           42850000
428600                                                                  42860000
428700                  EXEC SQL                                        42870000
428800                       OPEN ALL-SHIPT-CSR                         42880000
428900                  END-EXEC                                        42890000
429000                                                                  42900000
429100         EVALUATE TRUE                                            42910000
429200             WHEN SQLCODE = ZERO                                  42920000
429300             WHEN SQLCODE = -904                                  42930000
429400             WHEN SQLCODE = -913                                  42940000
429500                  CONTINUE                                        42950000
429600             WHEN SQLWARN0 NOT = SPACES                           42960000
429700             WHEN SQLCODE  < ZERO                                 42970000
429800             WHEN SQLCODE  > ZERO                                 42980000
429900                  MOVE '4035-OPEN-SHIPT-CURSOR'                   42990000
430000                                   TO DP013-PARAGRAPH             43000000
430100                  MOVE 'OPEN SHIPT CURSOR - ALL LINES '           43010000
430200                                   TO DP013-MESSAGE-TEXT (1)      43020000
430300                  MOVE SQLCA       TO DP013-SQLCA                 43030000
430400                  MOVE 'TSHUNLO'   TO DP013-DB2-TABLE-NAME (1)    43040000
430500                  MOVE 'TSHUUPC'   TO DP013-DB2-TABLE-NAME (2)    43050000
430600                  MOVE 'TSHPUNT'   TO DP013-DB2-TABLE-NAME (3)    43060000
430700                  MOVE 'TVHTRIP'   TO DP013-DB2-TABLE-NAME (4)    43070000
430800                  SET DP013-DB2-ABEND                             43080000
430900                      DP013-XCTL-DISPLAY-RESTART TO TRUE          43090000
431000                  PERFORM DP013-0000-PROCESS-ABEND                43100000
431100         END-EVALUATE                                             43110000
431200     END-PERFORM.                                                 43120000
431300                                                                  43130000
431400     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        43140000
431500         MOVE '4035-OPEN-SHIPT-CURSOR' TO DP013-PARAGRAPH         43150000
431600         MOVE 'MAX RETRIES EXCEEDED ATTEMPTING TO OPEN CSR'       43160000
431700                                   TO DP013-MESSAGE-TEXT (1)      43170000
431800         MOVE SQLCA                TO DP013-SQLCA                 43180000
431900         MOVE 'TSHUNLO'   TO DP013-DB2-TABLE-NAME (1)             43190000
432000         MOVE 'TSHUUPC'   TO DP013-DB2-TABLE-NAME (2)             43200000
432100         MOVE 'TSHPUNT'   TO DP013-DB2-TABLE-NAME (3)             43210000
432200         MOVE 'TVHTRIP'   TO DP013-DB2-TABLE-NAME (4)             43220000
432300         SET DP013-DB2-ABEND                                      43230000
432400             DP013-XCTL-DISPLAY-RESTART TO TRUE                   43240000
432500         PERFORM DP013-0000-PROCESS-ABEND                         43250000
432600     END-IF.                                                      43260000
432700 EJECT                                                            43270000
432800                                                                  43280000
432900                                                                  43290000
433000*----------------------------------------------------------------*43300000
433100* CLOSE SHIPT CURSOR.                **** ONLY 1 LINE ****       *43310000
433200*----------------------------------------------------------------*43320000
433300 4040-CLOSE-SHIPT-CURSOR.                                         43330000
433400             EXEC SQL                                             43340000
433500                  CLOSE SHIPT-CSR                                 43350000
433600             END-EXEC                                             43360000
433700                                                                  43370000
433800     EVALUATE TRUE                                                43380000
433900         WHEN SQLCODE = ZERO                                      43390000
434000              CONTINUE                                            43400000
434100         WHEN SQLWARN0 NOT = SPACES                               43410000
434200         WHEN SQLCODE  < ZERO                                     43420000
434300         WHEN SQLCODE  > ZERO                                     43430000
434400              MOVE '4040-CLOSE-SHIPT-CURSOR'                      43440000
434500                                   TO DP013-PARAGRAPH             43450000
434600              MOVE 'CLOSE SHIPT CURSOR'                           43460000
434700                                   TO DP013-MESSAGE-TEXT (1)      43470000
434800              MOVE SQLCA           TO DP013-SQLCA                 43480000
434900              MOVE 'TSHUNLO'   TO DP013-DB2-TABLE-NAME (1)        43490000
435000              MOVE 'TSHUUPC'   TO DP013-DB2-TABLE-NAME (2)        43500000
435100              MOVE 'TSHPUNT'   TO DP013-DB2-TABLE-NAME (3)        43510000
435200              MOVE 'TVHTRIP'   TO DP013-DB2-TABLE-NAME (4)        43520000
435300              SET DP013-DB2-ABEND                                 43530000
435400                  DP013-XCTL-DISPLAY-RESTART                      43540000
435500                                   TO TRUE                        43550000
435600              PERFORM DP013-0000-PROCESS-ABEND                    43560000
435700     END-EVALUATE.                                                43570000
435800 EJECT                                                            43580000
435900                                                                  43590000
436000                                                                  43600000
436100*----------------------------------------------------------------*43610000
436200* CLOSE SHIPT CURSOR.                **** ALL LINES ****         *43620000
436300*----------------------------------------------------------------*43630000
436400 4045-CLOSE-SHIPT-ALL.                                            43640000
436500             EXEC SQL                                             43650000
436600                  CLOSE ALL-SHIPT-CSR                             43660000
436700             END-EXEC                                             43670000
436800                                                                  43680000
436900     EVALUATE TRUE                                                43690000
437000         WHEN SQLCODE = ZERO                                      43700000
437100              CONTINUE                                            43710000
437200         WHEN SQLWARN0 NOT = SPACES                               43720000
437300         WHEN SQLCODE  < ZERO                                     43730000
437400         WHEN SQLCODE  > ZERO                                     43740000
437500              MOVE '4045-CLOSE-SHIPT-CURSOR'                      43750000
437600                                   TO DP013-PARAGRAPH             43760000
437700              MOVE 'CLOSE SHIPT CURSOR - ALL LINES'               43770000
437800                                   TO DP013-MESSAGE-TEXT (1)      43780000
437900              MOVE SQLCA           TO DP013-SQLCA                 43790000
438000              MOVE 'TSHUNLO'   TO DP013-DB2-TABLE-NAME (1)        43800000
438100              MOVE 'TSHUUPC'   TO DP013-DB2-TABLE-NAME (2)        43810000
438200              MOVE 'TSHPUNT'   TO DP013-DB2-TABLE-NAME (3)        43820000
438300              MOVE 'TVHTRIP'   TO DP013-DB2-TABLE-NAME (4)        43830000
438400              SET DP013-DB2-ABEND                                 43840000
438500                  DP013-XCTL-DISPLAY-RESTART                      43850000
438600                                   TO TRUE                        43860000
438700              PERFORM DP013-0000-PROCESS-ABEND                    43870000
438800     END-EVALUATE.                                                43880000
438900 EJECT                                                            43890000
439000                                                                  43900000
439100*----------------------------------------------------------------*43910000
439200*    SET UP THE HOST VARIABLES.                                  *43920000
439300*    PERFORM THIS PARA WHEN MULTIPLE CURSORS.                    *43930000
439400*----------------------------------------------------------------*43940000
439500 4100-PREPARE-CURSOR.                                             43950000
439600     MOVE ASC-OPER-UNT-ID               TO DK-OPER-UNT-ID.        43960000
439700     MOVE ASC-FCLTY-ID                  TO DK-FCLTY-ID.           43970000
439800     MOVE ASC-SCAC                      TO DK-SCAC-ID.            43980000
439900     MOVE ASC-TRLR-NBR                  TO DK-VEH-NBR.            43990000
440000     MOVE ASC-TRIP-ID                   TO DK-TRIP-ID.            44000000
440100     MOVE ASC-PO-NBR                    TO DK-PO-NBR.             44010000
440200     MOVE ASC-RECEIVER                  TO DK-REC-SEQ-NBR.        44020000
440300     MOVE ASC-LINE                      TO DK-LINE-NBR.           44030000
440400     MOVE ASC-SEQ-NBR                   TO DK-SEQ-NBR.            44040000
440500*                                                                 44050000
440600*----------------------------------------------------------------*44060000
440700* OPEN TRANS-PREPK CURSOR.                                        44070000
440800*----------------------------------------------------------------*44080000
440900 4210A-OPEN-TRAN-PREPK-CSR.                                       44090000
441000      EXEC SQL                                                    44100000
441100           OPEN TRAN-PREPK-CSR                                    44110000
441200      END-EXEC                                                    44120000
441300                                                                  44130000
441400      EVALUATE TRUE                                               44140000
441500          WHEN SQLCODE = ZERO                                     44150000
441600          WHEN SQLCODE = -904                                     44160000
441700          WHEN SQLCODE = -913                                     44170000
441800               CONTINUE                                           44180000
441900          WHEN SQLWARN0 NOT = SPACES                              44190000
442000          WHEN SQLCODE  < ZERO                                    44200000
442100          WHEN SQLCODE  > ZERO                                    44210000
442200               MOVE '4210A-OPEN-TRAN-PREPK-CSR'                   44220000
442300                                TO DP013-PARAGRAPH                44230000
442400               MOVE 'OPEN TRANS-PREPK CURSOR - '                  44240000
442500                                TO DP013-MESSAGE-TEXT (1)         44250000
442600               MOVE SQLCA       TO DP013-SQLCA                    44260000
442700               MOVE 'TPKSLIP'   TO DP013-DB2-TABLE-NAME (1)       44270000
442800               MOVE 'TINPKSU'   TO DP013-DB2-TABLE-NAME (2)       44280000
442900               SET DP013-DB2-ABEND                                44290000
443000                   DP013-XCTL-DISPLAY-RESTART TO TRUE             44300000
443100               PERFORM DP013-0000-PROCESS-ABEND                   44310000
443200      END-EVALUATE.                                               44320000
443300                                                                  44330000
443400*----------------------------------------------------------------*44340000
443500* OPEN NOT-TRANS-PREPK CURSOR.                                    44350000
443600*----------------------------------------------------------------*44360000
443700 4210B-OPEN-NOT-TRAN-PREPK-CSR.                                   44370000
443800      EXEC SQL                                                    44380000
443900           OPEN NOT-TRAN-PREPK-CSR                                44390000
444000      END-EXEC                                                    44400000
444100                                                                  44410000
444200      EVALUATE TRUE                                               44420000
444300          WHEN SQLCODE = ZERO                                     44430000
444400          WHEN SQLCODE = -904                                     44440000
444500          WHEN SQLCODE = -913                                     44450000
444600               CONTINUE                                           44460000
444700          WHEN SQLWARN0 NOT = SPACES                              44470000
444800          WHEN SQLCODE  < ZERO                                    44480000
444900          WHEN SQLCODE  > ZERO                                    44490000
445000               MOVE '4210B-OPEN-NOT-TRAN-PREPK-CSR'               44500000
445100                                TO DP013-PARAGRAPH                44510000
445200               MOVE 'OPEN NOT-TRAN-PREPK CURSOR - '               44520000
445300                                TO DP013-MESSAGE-TEXT (1)         44530000
445400               MOVE SQLCA       TO DP013-SQLCA                    44540000
445500               MOVE 'TPKSLIP'   TO DP013-DB2-TABLE-NAME (1)       44550000
445600               MOVE 'TINPKSU'   TO DP013-DB2-TABLE-NAME (2)       44560000
445700               SET DP013-DB2-ABEND                                44570000
445800                   DP013-XCTL-DISPLAY-RESTART TO TRUE             44580000
445900               PERFORM DP013-0000-PROCESS-ABEND                   44590000
446000      END-EVALUATE.                                               44600000
446100                                                                  44610000
446200*----------------------------------------------------------------*44620000
446300* OPEN NON-PREPACK CURSOR.                                        44630000
446400*----------------------------------------------------------------*44640000
446500 4210C-OPEN-NON-PREPK-CSR.                                        44650000
446600      EXEC SQL                                                    44660000
446700           OPEN NON-PREPK-CSR                                     44670000
446800      END-EXEC                                                    44680000
446900                                                                  44690000
447000      EVALUATE TRUE                                               44700000
447100          WHEN SQLCODE = ZERO                                     44710000
447200          WHEN SQLCODE = -904                                     44720000
447300          WHEN SQLCODE = -913                                     44730000
447400               CONTINUE                                           44740000
447500          WHEN SQLWARN0 NOT = SPACES                              44750000
447600          WHEN SQLCODE  < ZERO                                    44760000
447700          WHEN SQLCODE  > ZERO                                    44770000
447800               MOVE '4210C-OPEN-NON-PREPK-CSR'                    44780000
447900                                TO DP013-PARAGRAPH                44790000
448000               MOVE 'OPEN NON-PREPACK CURSOR - '                  44800000
448100                                TO DP013-MESSAGE-TEXT (1)         44810000
448200               MOVE SQLCA       TO DP013-SQLCA                    44820000
448300               MOVE 'TPKSLIP'   TO DP013-DB2-TABLE-NAME (1)       44830000
448400               MOVE 'TINPKSU'   TO DP013-DB2-TABLE-NAME (2)       44840000
448500               SET DP013-DB2-ABEND                                44850000
448600                   DP013-XCTL-DISPLAY-RESTART TO TRUE             44860000
448700               PERFORM DP013-0000-PROCESS-ABEND                   44870000
448800      END-EVALUATE.                                               44880000
448900                                                                  44890000
449000*----------------------------------------------------------------*44900000
449100* OPEN PBS CURSOR                                                 44910000
449200*----------------------------------------------------------------*44920000
449300 4210D-OPEN-PBS-CSR.                                              44930000
449400      EXEC SQL                                                    44940000
449500           OPEN PBS-CSR                                           44950000
449600      END-EXEC                                                    44960000
449700                                                                  44970000
449800      EVALUATE TRUE                                               44980000
449900          WHEN SQLCODE = ZERO                                     44990000
450000          WHEN SQLCODE = -904                                     45000000
450100          WHEN SQLCODE = -913                                     45010000
450200               CONTINUE                                           45020000
450300          WHEN SQLWARN0 NOT = SPACES                              45030000
450400          WHEN SQLCODE  < ZERO                                    45040000
450500          WHEN SQLCODE  > ZERO                                    45050000
450600               MOVE '4210D-OPEN-PBS-CSR'                          45060000
450700                                TO DP013-PARAGRAPH                45070000
450800               MOVE 'OPEN PBS CURSOR - '                          45080000
450900                                TO DP013-MESSAGE-TEXT (1)         45090000
451000               MOVE SQLCA       TO DP013-SQLCA                    45100000
451100               MOVE 'TPKSLIP'   TO DP013-DB2-TABLE-NAME (1)       45110000
451200               MOVE 'TINPKSU'   TO DP013-DB2-TABLE-NAME (2)       45120000
451300               SET DP013-DB2-ABEND                                45130000
451400                   DP013-XCTL-DISPLAY-RESTART TO TRUE             45140000
451500               PERFORM DP013-0000-PROCESS-ABEND                   45150000
451600      END-EVALUATE.                                               45160000
451700                                                                  45170000
451800*----------------------------------------------------------------*45180000
451900* OPEN PO-TRANS-PREPK CURSOR.                                     45190000
452000*----------------------------------------------------------------*45200000
452100 4210E-OPEN-PO-TRAN-PREPK-CSR.                                    45210000
452200      EXEC SQL                                                    45220000
452300           OPEN PO-TRAN-PREPK-CSR                                 45230000
452400      END-EXEC                                                    45240000
452500                                                                  45250000
452600      EVALUATE TRUE                                               45260000
452700          WHEN SQLCODE = ZERO                                     45270000
452800          WHEN SQLCODE = -904                                     45280000
452900          WHEN SQLCODE = -913                                     45290000
453000               CONTINUE                                           45300000
453100          WHEN SQLWARN0 NOT = SPACES                              45310000
453200          WHEN SQLCODE  < ZERO                                    45320000
453300          WHEN SQLCODE  > ZERO                                    45330000
453400               MOVE '4210E-OPEN-PO-TRAN-PREPK-CSR'                45340000
453500                                TO DP013-PARAGRAPH                45350000
453600               MOVE 'OPEN PO-TRANS-PREPK CURSOR - '               45360000
453700                                TO DP013-MESSAGE-TEXT (1)         45370000
453800               MOVE SQLCA       TO DP013-SQLCA                    45380000
453900               MOVE 'TPKSLIP'   TO DP013-DB2-TABLE-NAME (1)       45390000
454000               MOVE 'TINPKSU'   TO DP013-DB2-TABLE-NAME (2)       45400000
454100               SET DP013-DB2-ABEND                                45410000
454200                   DP013-XCTL-DISPLAY-RESTART TO TRUE             45420000
454300               PERFORM DP013-0000-PROCESS-ABEND                   45430000
454400      END-EVALUATE.                                               45440000
454500                                                                  45450000
454600*----------------------------------------------------------------*45460000
454700* OPEN PO-NON-PREPACK CURSOR.                                     45470000
454800*----------------------------------------------------------------*45480000
454900 4210G-OPEN-PO-NON-PREPK-CSR.                                     45490000
455000      EXEC SQL                                                    45500000
455100           OPEN PO-NON-PREPK-CSR                                  45510000
455200      END-EXEC                                                    45520000
455300                                                                  45530000
455400      EVALUATE TRUE                                               45540000
455500          WHEN SQLCODE = ZERO                                     45550000
455600          WHEN SQLCODE = -904                                     45560000
455700          WHEN SQLCODE = -913                                     45570000
455800               CONTINUE                                           45580000
455900          WHEN SQLWARN0 NOT = SPACES                              45590000
456000          WHEN SQLCODE  < ZERO                                    45600000
456100          WHEN SQLCODE  > ZERO                                    45610000
456200               MOVE '4210G-OPEN-PO-NON-PREPK-CSR'                 45620000
456300                                TO DP013-PARAGRAPH                45630000
456400               MOVE 'OPEN PO-NON-PREPACK CURSOR - '               45640000
456500                                TO DP013-MESSAGE-TEXT (1)         45650000
456600               MOVE SQLCA       TO DP013-SQLCA                    45660000
456700               MOVE 'TPKSLIP'   TO DP013-DB2-TABLE-NAME (1)       45670000
456800               MOVE 'TINPKSU'   TO DP013-DB2-TABLE-NAME (2)       45680000
456900               SET DP013-DB2-ABEND                                45690000
457000                   DP013-XCTL-DISPLAY-RESTART TO TRUE             45700000
457100               PERFORM DP013-0000-PROCESS-ABEND                   45710000
457200      END-EVALUATE.                                               45720000
457300                                                                  45730000
457400*----------------------------------------------------------------*45740000
457500* OPEN PO-PBS CURSOR                                              45750000
457600*----------------------------------------------------------------*45760000
457700 4210H-OPEN-PO-PBS-CSR.                                           45770000
457800      EXEC SQL                                                    45780000
457900           OPEN PO-PBS-CSR                                        45790000
458000      END-EXEC                                                    45800000
458100                                                                  45810000
458200      EVALUATE TRUE                                               45820000
458300          WHEN SQLCODE = ZERO                                     45830000
458400          WHEN SQLCODE = -904                                     45840000
458500          WHEN SQLCODE = -913                                     45850000
458600               CONTINUE                                           45860000
458700          WHEN SQLWARN0 NOT = SPACES                              45870000
458800          WHEN SQLCODE  < ZERO                                    45880000
458900          WHEN SQLCODE  > ZERO                                    45890000
459000               MOVE '4210H-OPEN-PO-PBS-CSR'                       45900000
459100                                TO DP013-PARAGRAPH                45910000
459200               MOVE 'OPEN PO-PBS CURSOR - '                       45920000
459300                                TO DP013-MESSAGE-TEXT (1)         45930000
459400               MOVE SQLCA       TO DP013-SQLCA                    45940000
459500               MOVE 'TPKSLIP'   TO DP013-DB2-TABLE-NAME (1)       45950000
459600               MOVE 'TINPKSU'   TO DP013-DB2-TABLE-NAME (2)       45960000
459700               SET DP013-DB2-ABEND                                45970000
459800                   DP013-XCTL-DISPLAY-RESTART TO TRUE             45980000
459900               PERFORM DP013-0000-PROCESS-ABEND                   45990000
460000      END-EVALUATE.                                               46000000
460100                                                                  46010000
460200*----------------------------------------------------------------*46020000
460300*    FETCH TRANS-PREPK CURSOR.                                    46030000
460400*----------------------------------------------------------------*46040000
460500 4215A-FETCH-TRAN-PREPK-CSR.                                      46050000
460600      EXEC SQL                                                    46060000
460700           FETCH TRAN-PREPK-CSR                                   46070000
460800            INTO :PKSLIP-REC-SEQ-NBR                              46080000
460900                ,:SHPUNT-SHIPT-UNT-ID                             46090000
461000                ,:SHPUNT-ACTV-IND                                 46100000
461100                ,:SHPUNT-DEST-OPER-UNT-ID                         46110000
461200                ,:PKSLIP-CRE-TMST                                 46120000
461300                ,:WS-SHPUNT-CRE-TMST-DATE                         46130000
461400                ,:WS-SHPUNT-CRE-TMST-TIME                         46140000
461500                ,:RECITM-PREPK-ID                                 46150000
461600      END-EXEC                                                    46160000
461700                                                                  46170000
461800      EVALUATE TRUE                                               46180000
461900          WHEN SQLCODE = ZERO                                     46190000
462000              MOVE WS-SHPUNT-CRE-TMST TO PV-TMST-R                46200000
462100              MOVE PV-TMST-CC         TO PV-DISPLAY-CC            46210000
462200              MOVE PV-TMST-YY         TO PV-DISPLAY-YY            46220000
462300              MOVE PC-SLASH           TO PV-SLASH-1               46230000
462400              MOVE PV-TMST-MM         TO PV-DISPLAY-MM            46240000
462500              MOVE PC-SLASH           TO PV-SLASH-2               46250000
462600              MOVE PV-TMST-DD         TO PV-DISPLAY-DD            46260000
462700              MOVE PV-TMST-HRS        TO PV-DISPLAY-HRS           46270000
462800              MOVE PC-COLON           TO PV-COLON                 46280000
462900              MOVE PV-TMST-MIN        TO PV-DISPLAY-MIN           46290000
463000                                                                  46300000
463100              MOVE PV-DATE-TIME-DISPLAY                           46310000
463200                                      TO  WS-SHPUNT-CRE-TMST      46320000
463300                                                                  46330000
463400          WHEN SQLCODE = +100                                     46340000
463500               SET PS-EO-TRAN-PREPK-CSR                           46350000
463600                   ASC-NO-ITEMS-LEFT-ON-DB TO TRUE                46360000
463700          WHEN SQLWARN0 NOT = SPACES                              46370000
463800          WHEN SQLCODE NOT = ZERO                                 46380000
463900               MOVE '4215A-FETCH-TRAN-PREPK-CSR'                  46390000
464000                                    TO DP013-PARAGRAPH            46400000
464100               MOVE 'FETCH TRANS PREPK CURSOR'                    46410000
464200                                    TO DP013-MESSAGE-TEXT (1)     46420000
464300               MOVE DK-PO-NBR                                     46430000
464400                                    TO DP013-MESSAGE-TEXT (2)     46440000
464500               MOVE DK-SEQ-NBR                                    46450000
464600                                    TO DP013-MESSAGE-TEXT (3)     46460000
464700               MOVE SQLCA           TO DP013-SQLCA                46470000
464800               MOVE 'TPKSLIP ' TO DP013-DB2-TABLE-NAME (1)        46480000
464900               SET DP013-DB2-ABEND  TO TRUE                       46490000
465000               PERFORM DP013-0000-PROCESS-ABEND                   46500000
465100      END-EVALUATE.                                               46510000
465200                                                                  46520000
465300                                                                  46530000
465400*----------------------------------------------------------------*46540000
465500*    FETCH NOT-TRAN-PREPK CURSOR.                                 46550000
465600*----------------------------------------------------------------*46560000
465700 4215B-FETCH-NOT-TRAN-PREPK-CSR.                                  46570000
465800      EXEC SQL                                                    46580000
465900           FETCH NOT-TRAN-PREPK-CSR                               46590000
466000            INTO :PKSLIP-REC-SEQ-NBR                              46600000
466100                ,:SHPUNT-SHIPT-UNT-ID                             46610000
466200                ,:SHPUNT-ACTV-IND                                 46620000
466300                ,:SHPUNT-DEST-OPER-UNT-ID                         46630000
466400                ,:PKSLIP-CRE-TMST                                 46640000
466500                ,:WS-SHPUNT-CRE-TMST-DATE                         46650000
466600                ,:WS-SHPUNT-CRE-TMST-TIME                         46660000
466700                ,:PURITM-PO-PREPK-ID                              46670000
466800      END-EXEC                                                    46680000
466900                                                                  46690000
467000      EVALUATE TRUE                                               46700000
467100          WHEN SQLCODE = ZERO                                     46710000
467200              MOVE WS-SHPUNT-CRE-TMST TO PV-TMST-R                46720000
467300              MOVE PV-TMST-CC         TO PV-DISPLAY-CC            46730000
467400              MOVE PV-TMST-YY         TO PV-DISPLAY-YY            46740000
467500              MOVE PC-SLASH           TO PV-SLASH-1               46750000
467600              MOVE PV-TMST-MM         TO PV-DISPLAY-MM            46760000
467700              MOVE PC-SLASH           TO PV-SLASH-2               46770000
467800              MOVE PV-TMST-DD         TO PV-DISPLAY-DD            46780000
467900              MOVE PV-TMST-HRS        TO PV-DISPLAY-HRS           46790000
468000              MOVE PC-COLON           TO PV-COLON                 46800000
468100              MOVE PV-TMST-MIN        TO PV-DISPLAY-MIN           46810000
468200                                                                  46820000
468300              MOVE PV-DATE-TIME-DISPLAY                           46830000
468400                                      TO  WS-SHPUNT-CRE-TMST      46840000
468500                                                                  46850000
468600          WHEN SQLCODE = +100                                     46860000
468700               SET PS-EO-NOT-TRAN-PREPK-CSR                       46870000
468800                   ASC-NO-ITEMS-LEFT-ON-DB   TO TRUE              46880000
468900          WHEN SQLWARN0 NOT = SPACES                              46890000
469000          WHEN SQLCODE NOT = ZERO                                 46900000
469100               MOVE '4215B-FETCH-NOT-TRAN-PREPK-CSR'              46910000
469200                                    TO DP013-PARAGRAPH            46920000
469300               MOVE 'FETCH NOT TRAN PREPK CURSOR'                 46930000
469400                                    TO DP013-MESSAGE-TEXT (1)     46940000
469500               MOVE DK-PO-NBR                                     46950000
469600                                    TO DP013-MESSAGE-TEXT (2)     46960000
469700               MOVE DK-SEQ-NBR                                    46970000
469800                                    TO DP013-MESSAGE-TEXT (3)     46980000
469900               MOVE SQLCA           TO DP013-SQLCA                46990000
470000               MOVE 'TPKSLIP ' TO DP013-DB2-TABLE-NAME (1)        47000000
470100               SET DP013-DB2-ABEND  TO TRUE                       47010000
470200               PERFORM DP013-0000-PROCESS-ABEND                   47020000
470300      END-EVALUATE.                                               47030000
470400                                                                  47040000
470500*----------------------------------------------------------------*47050000
470600*    FETCH NON-PREPACK CURSOR.                                    47060000
470700*----------------------------------------------------------------*47070000
470800 4215C-FETCH-NON-PREPK-CSR.                                       47080000
470900      EXEC SQL                                                    47090000
471000           FETCH NON-PREPK-CSR                                    47100000
471100            INTO :PKSLIP-REC-SEQ-NBR                              47110000
471200                ,:SHPUNT-SHIPT-UNT-ID                             47120000
471300                ,:SHPUNT-ACTV-IND                                 47130000
471400                ,:SHPUNT-DEST-OPER-UNT-ID                         47140000
471500                ,:PKSLIP-CRE-TMST                                 47150000
471600                ,:WS-SHPUNT-CRE-TMST-DATE                         47160000
471700                ,:WS-SHPUNT-CRE-TMST-TIME                         47170000
471800                ,:SHUUPC-TRN-LNE-NBR                              47180000
471900      END-EXEC                                                    47190000
472000                                                                  47200000
472100      EVALUATE TRUE                                               47210000
472200          WHEN SQLCODE = ZERO                                     47220000
472300              MOVE WS-SHPUNT-CRE-TMST TO PV-TMST-R                47230000
472400              MOVE PV-TMST-CC         TO PV-DISPLAY-CC            47240000
472500              MOVE PV-TMST-YY         TO PV-DISPLAY-YY            47250000
472600              MOVE PC-SLASH           TO PV-SLASH-1               47260000
472700              MOVE PV-TMST-MM         TO PV-DISPLAY-MM            47270000
472800              MOVE PC-SLASH           TO PV-SLASH-2               47280000
472900              MOVE PV-TMST-DD         TO PV-DISPLAY-DD            47290000
473000              MOVE PV-TMST-HRS        TO PV-DISPLAY-HRS           47300000
473100              MOVE PC-COLON           TO PV-COLON                 47310000
473200              MOVE PV-TMST-MIN        TO PV-DISPLAY-MIN           47320000
473300                                                                  47330000
473400              MOVE PV-DATE-TIME-DISPLAY                           47340000
473500                                      TO  WS-SHPUNT-CRE-TMST      47350000
473600                                                                  47360000
473700          WHEN SQLCODE = +100                                     47370000
473800               SET PS-EO-NON-PREPK-CSR                            47380000
473900                   ASC-NO-ITEMS-LEFT-ON-DB TO TRUE                47390000
474000          WHEN SQLWARN0 NOT = SPACES                              47400000
474100          WHEN SQLCODE NOT = ZERO                                 47410000
474200               MOVE '4215C-FETCH-NON-PREPK-CSR'                   47420000
474300                                    TO DP013-PARAGRAPH            47430000
474400               MOVE 'FETCH NON-PREPACK CURSOR'                    47440000
474500                                    TO DP013-MESSAGE-TEXT (1)     47450000
474600               MOVE DK-PO-NBR                                     47460000
474700                                    TO DP013-MESSAGE-TEXT (2)     47470000
474800               MOVE DK-SEQ-NBR                                    47480000
474900                                    TO DP013-MESSAGE-TEXT (3)     47490000
475000               MOVE SQLCA           TO DP013-SQLCA                47500000
475100               MOVE 'TPKSLIP ' TO DP013-DB2-TABLE-NAME (1)        47510000
475200               SET DP013-DB2-ABEND  TO TRUE                       47520000
475300               PERFORM DP013-0000-PROCESS-ABEND                   47530000
475400      END-EVALUATE.                                               47540000
475500                                                                  47550000
475600                                                                  47560000
475700*----------------------------------------------------------------*47570000
475800*    FETCH PBS CURSOR.                                            47580000
475900*----------------------------------------------------------------*47590000
476000 4215D-FETCH-PBS-CSR.                                             47600000
476100      EXEC SQL                                                    47610000
476200           FETCH PBS-CSR                                          47620000
476300            INTO :PKSLIP-REC-SEQ-NBR                              47630000
476400                ,:SHPUNT-SHIPT-UNT-ID                             47640000
476500                ,:SHPUNT-ACTV-IND                                 47650000
476600                ,:SHPUNT-DEST-OPER-UNT-ID                         47660000
476700                ,:PKSLIP-CRE-TMST                                 47670000
476800                ,:WS-SHPUNT-CRE-TMST-DATE                         47680000
476900                ,:WS-SHPUNT-CRE-TMST-TIME                         47690000
477000                ,:PV-PBS-COUNT                                    47700000
477100      END-EXEC                                                    47710000
477200                                                                  47720000
477300      EVALUATE TRUE                                               47730000
477400          WHEN SQLCODE = ZERO                                     47740000
477500              MOVE WS-SHPUNT-CRE-TMST TO PV-TMST-R                47750000
477600              MOVE PV-TMST-CC         TO PV-DISPLAY-CC            47760000
477700              MOVE PV-TMST-YY         TO PV-DISPLAY-YY            47770000
477800              MOVE PC-SLASH           TO PV-SLASH-1               47780000
477900              MOVE PV-TMST-MM         TO PV-DISPLAY-MM            47790000
478000              MOVE PC-SLASH           TO PV-SLASH-2               47800000
478100              MOVE PV-TMST-DD         TO PV-DISPLAY-DD            47810000
478200              MOVE PV-TMST-HRS        TO PV-DISPLAY-HRS           47820000
478300              MOVE PC-COLON           TO PV-COLON                 47830000
478400              MOVE PV-TMST-MIN        TO PV-DISPLAY-MIN           47840000
478500                                                                  47850000
478600              MOVE PV-DATE-TIME-DISPLAY                           47860000
478700                                      TO  WS-SHPUNT-CRE-TMST      47870000
478800                                                                  47880000
478900          WHEN SQLCODE = +100                                     47890000
479000               SET PS-EO-PBS-CSR                                  47900000
479100                   ASC-NO-ITEMS-LEFT-ON-DB TO TRUE                47910000
479200          WHEN SQLWARN0 NOT = SPACES                              47920000
479300          WHEN SQLCODE NOT = ZERO                                 47930000
479400               MOVE '4215D-FETCH-PBS-CSR'                         47940000
479500                                    TO DP013-PARAGRAPH            47950000
479600               MOVE 'FETCH PBS CURSOR'                            47960000
479700                                    TO DP013-MESSAGE-TEXT (1)     47970000
479800               MOVE DK-PO-NBR                                     47980000
479900                                    TO DP013-MESSAGE-TEXT (2)     47990000
480000               MOVE DK-SEQ-NBR                                    48000000
480100                                    TO DP013-MESSAGE-TEXT (3)     48010000
480200               MOVE SQLCA           TO DP013-SQLCA                48020000
480300               MOVE 'TPKSLIP ' TO DP013-DB2-TABLE-NAME (1)        48030000
480400               SET DP013-DB2-ABEND  TO TRUE                       48040000
480500               PERFORM DP013-0000-PROCESS-ABEND                   48050000
480600      END-EVALUATE.                                               48060000
480700                                                                  48070000
480800                                                                  48080000
480900*----------------------------------------------------------------*48090000
481000*    FETCH PO-TRANS-PREPK CURSOR.                                 48100000
481100*----------------------------------------------------------------*48110000
481200 4215E-FETCH-PO-TRAN-PREPK-CSR.                                   48120000
481300      EXEC SQL                                                    48130000
481400           FETCH PO-TRAN-PREPK-CSR                                48140000
481500            INTO :PKSLIP-REC-SEQ-NBR                              48150000
481600                ,:SHPUNT-SHIPT-UNT-ID                             48160000
481700                ,:SHPUNT-ACTV-IND                                 48170000
481800                ,:SHPUNT-DEST-OPER-UNT-ID                         48180000
481900                ,:PKSLIP-CRE-TMST                                 48190000
482000                ,:WS-SHPUNT-CRE-TMST-DATE                         48200000
482100                ,:WS-SHPUNT-CRE-TMST-TIME                         48210000
482200                ,:RECITM-PREPK-ID                                 48220000
482300      END-EXEC                                                    48230000
482400                                                                  48240000
482500      EVALUATE TRUE                                               48250000
482600          WHEN SQLCODE = ZERO                                     48260000
482700              MOVE WS-SHPUNT-CRE-TMST TO PV-TMST-R                48270000
482800              MOVE PV-TMST-CC         TO PV-DISPLAY-CC            48280000
482900              MOVE PV-TMST-YY         TO PV-DISPLAY-YY            48290000
483000              MOVE PC-SLASH           TO PV-SLASH-1               48300000
483100              MOVE PV-TMST-MM         TO PV-DISPLAY-MM            48310000
483200              MOVE PC-SLASH           TO PV-SLASH-2               48320000
483300              MOVE PV-TMST-DD         TO PV-DISPLAY-DD            48330000
483400              MOVE PV-TMST-HRS        TO PV-DISPLAY-HRS           48340000
483500              MOVE PC-COLON           TO PV-COLON                 48350000
483600              MOVE PV-TMST-MIN        TO PV-DISPLAY-MIN           48360000
483700                                                                  48370000
483800              MOVE PV-DATE-TIME-DISPLAY                           48380000
483900                                      TO  WS-SHPUNT-CRE-TMST      48390000
484000                                                                  48400000
484100          WHEN SQLCODE = +100                                     48410000
484200               SET PS-EO-PO-TRAN-PREPK-CSR                        48420000
484300                   ASC-NO-ITEMS-LEFT-ON-DB TO TRUE                48430000
484400          WHEN SQLWARN0 NOT = SPACES                              48440000
484500          WHEN SQLCODE NOT = ZERO                                 48450000
484600               MOVE '4215E-FETCH-PO-TRAN-PREPK-CSR'               48460000
484700                                    TO DP013-PARAGRAPH            48470000
484800               MOVE 'FETCH PO TRANS PREPK CURSOR'                 48480000
484900                                    TO DP013-MESSAGE-TEXT (1)     48490000
485000               MOVE DK-PO-NBR                                     48500000
485100                                    TO DP013-MESSAGE-TEXT (2)     48510000
485200               MOVE DK-SEQ-NBR                                    48520000
485300                                    TO DP013-MESSAGE-TEXT (3)     48530000
485400               MOVE SQLCA           TO DP013-SQLCA                48540000
485500               MOVE 'TPKSLIP ' TO DP013-DB2-TABLE-NAME (1)        48550000
485600               SET DP013-DB2-ABEND  TO TRUE                       48560000
485700               PERFORM DP013-0000-PROCESS-ABEND                   48570000
485800      END-EVALUATE.                                               48580000
485900                                                                  48590000
486000                                                                  48600000
486100*----------------------------------------------------------------*48610000
486200*    FETCH PO-NON-PREPACK CURSOR.                                 48620000
486300*----------------------------------------------------------------*48630000
486400 4215G-FETCH-PO-NON-PREPK-CSR.                                    48640000
486500      EXEC SQL                                                    48650000
486600           FETCH PO-NON-PREPK-CSR                                 48660000
486700            INTO :PKSLIP-REC-SEQ-NBR                              48670000
486800                ,:SHPUNT-SHIPT-UNT-ID                             48680000
486900                ,:SHPUNT-ACTV-IND                                 48690000
487000                ,:SHPUNT-DEST-OPER-UNT-ID                         48700000
487100                ,:PKSLIP-CRE-TMST                                 48710000
487200                ,:WS-SHPUNT-CRE-TMST-DATE                         48720000
487300                ,:WS-SHPUNT-CRE-TMST-TIME                         48730000
487400                ,:SHUUPC-TRN-LNE-NBR                              48740000
487500      END-EXEC                                                    48750000
487600                                                                  48760000
487700      EVALUATE TRUE                                               48770000
487800          WHEN SQLCODE = ZERO                                     48780000
487900              MOVE WS-SHPUNT-CRE-TMST TO PV-TMST-R                48790000
488000              MOVE PV-TMST-CC         TO PV-DISPLAY-CC            48800000
488100              MOVE PV-TMST-YY         TO PV-DISPLAY-YY            48810000
488200              MOVE PC-SLASH           TO PV-SLASH-1               48820000
488300              MOVE PV-TMST-MM         TO PV-DISPLAY-MM            48830000
488400              MOVE PC-SLASH           TO PV-SLASH-2               48840000
488500              MOVE PV-TMST-DD         TO PV-DISPLAY-DD            48850000
488600              MOVE PV-TMST-HRS        TO PV-DISPLAY-HRS           48860000
488700              MOVE PC-COLON           TO PV-COLON                 48870000
488800              MOVE PV-TMST-MIN        TO PV-DISPLAY-MIN           48880000
488900                                                                  48890000
489000              MOVE PV-DATE-TIME-DISPLAY                           48900000
489100                                      TO  WS-SHPUNT-CRE-TMST      48910000
489200                                                                  48920000
489300          WHEN SQLCODE = +100                                     48930000
489400               SET PS-EO-PO-NON-PREPK-CSR                         48940000
489500                   ASC-NO-ITEMS-LEFT-ON-DB TO TRUE                48950000
489600          WHEN SQLWARN0 NOT = SPACES                              48960000
489700          WHEN SQLCODE NOT = ZERO                                 48970000
489800               MOVE '4215G-FETCH-PO-NON-PREPK-CSR'                48980000
489900                                    TO DP013-PARAGRAPH            48990000
490000               MOVE 'FETCH PO-NON-PREPACK CURSOR'                 49000000
490100                                    TO DP013-MESSAGE-TEXT (1)     49010000
490200               MOVE DK-PO-NBR                                     49020000
490300                                    TO DP013-MESSAGE-TEXT (2)     49030000
490400               MOVE DK-SEQ-NBR                                    49040000
490500                                    TO DP013-MESSAGE-TEXT (3)     49050000
490600               MOVE SQLCA           TO DP013-SQLCA                49060000
490700               MOVE 'TPKSLIP ' TO DP013-DB2-TABLE-NAME (1)        49070000
490800               SET DP013-DB2-ABEND  TO TRUE                       49080000
490900               PERFORM DP013-0000-PROCESS-ABEND                   49090000
491000      END-EVALUATE.                                               49100000
491100                                                                  49110000
491200                                                                  49120000
491300*----------------------------------------------------------------*49130000
491400*    FETCH PO-PBS CURSOR.                                         49140000
491500*----------------------------------------------------------------*49150000
491600 4215H-FETCH-PO-PBS-CSR.                                          49160000
491700      EXEC SQL                                                    49170000
491800           FETCH PO-PBS-CSR                                       49180000
491900            INTO :PKSLIP-REC-SEQ-NBR                              49190000
492000                ,:SHPUNT-SHIPT-UNT-ID                             49200000
492100                ,:SHPUNT-ACTV-IND                                 49210000
492200                ,:SHPUNT-DEST-OPER-UNT-ID                         49220000
492300                ,:PKSLIP-CRE-TMST                                 49230000
492400                ,:WS-SHPUNT-CRE-TMST-DATE                         49240000
492500                ,:WS-SHPUNT-CRE-TMST-TIME                         49250000
492600                ,:PV-PBS-COUNT                                    49260000
492700      END-EXEC                                                    49270000
492800                                                                  49280000
492900      EVALUATE TRUE                                               49290000
493000          WHEN SQLCODE = ZERO                                     49300000
493100              MOVE WS-SHPUNT-CRE-TMST TO PV-TMST-R                49310000
493200              MOVE PV-TMST-CC         TO PV-DISPLAY-CC            49320000
493300              MOVE PV-TMST-YY         TO PV-DISPLAY-YY            49330000
493400              MOVE PC-SLASH           TO PV-SLASH-1               49340000
493500              MOVE PV-TMST-MM         TO PV-DISPLAY-MM            49350000
493600              MOVE PC-SLASH           TO PV-SLASH-2               49360000
493700              MOVE PV-TMST-DD         TO PV-DISPLAY-DD            49370000
493800              MOVE PV-TMST-HRS        TO PV-DISPLAY-HRS           49380000
493900              MOVE PC-COLON           TO PV-COLON                 49390000
494000              MOVE PV-TMST-MIN        TO PV-DISPLAY-MIN           49400000
494100                                                                  49410000
494200              MOVE PV-DATE-TIME-DISPLAY                           49420000
494300                                      TO  WS-SHPUNT-CRE-TMST      49430000
494400                                                                  49440000
494500          WHEN SQLCODE = +100                                     49450000
494600               SET PS-EO-PO-PBS-CSR                               49460000
494700                   ASC-NO-ITEMS-LEFT-ON-DB TO TRUE                49470000
494800          WHEN SQLWARN0 NOT = SPACES                              49480000
494900          WHEN SQLCODE NOT = ZERO                                 49490000
495000               MOVE '4215G-FETCH-PO-PBS-CSR'                      49500000
495100                                    TO DP013-PARAGRAPH            49510000
495200               MOVE 'FETCH PO-PBS CURSOR'                         49520000
495300                                    TO DP013-MESSAGE-TEXT (1)     49530000
495400               MOVE DK-PO-NBR                                     49540000
495500                                    TO DP013-MESSAGE-TEXT (2)     49550000
495600               MOVE DK-SEQ-NBR                                    49560000
495700                                    TO DP013-MESSAGE-TEXT (3)     49570000
495800               MOVE SQLCA           TO DP013-SQLCA                49580000
495900               MOVE 'TPKSLIP ' TO DP013-DB2-TABLE-NAME (1)        49590000
496000               SET DP013-DB2-ABEND  TO TRUE                       49600000
496100               PERFORM DP013-0000-PROCESS-ABEND                   49610000
496200      END-EVALUATE.                                               49620000
496300                                                                  49630000
496400                                                                  49640000
496500*----------------------------------------------------------------*49650000
496600* CLOSE TRANS-PREPK CURSOR.                                       49660000
496700*----------------------------------------------------------------*49670000
496800 4220A-CLOSE-TRAN-PREPK-CSR.                                      49680000
496900      EXEC SQL                                                    49690000
497000           CLOSE TRAN-PREPK-CSR                                   49700000
497100      END-EXEC                                                    49710000
497200                                                                  49720000
497300      EVALUATE TRUE                                               49730000
497400          WHEN SQLCODE = ZERO                                     49740000
497500               CONTINUE                                           49750000
497600          WHEN SQLWARN0 NOT = SPACES                              49760000
497700          WHEN SQLCODE  < ZERO                                    49770000
497800          WHEN SQLCODE  > ZERO                                    49780000
497900               MOVE '4220A-CLOSE-TRAN-PREPK-CSR'                  49790000
498000                                TO DP013-PARAGRAPH                49800000
498100               MOVE 'CLOSE TRANS PREPK CURSOR'                    49810000
498200                                TO DP013-MESSAGE-TEXT (1)         49820000
498300               MOVE SQLCA           TO DP013-SQLCA                49830000
498400               MOVE 'TPKSLIP'   TO DP013-DB2-TABLE-NAME (1)       49840000
498500               MOVE 'TINPKSU'   TO DP013-DB2-TABLE-NAME (2)       49850000
498600               SET DP013-DB2-ABEND                                49860000
498700                   DP013-XCTL-DISPLAY-RESTART                     49870000
498800                                TO TRUE                           49880000
498900               PERFORM DP013-0000-PROCESS-ABEND                   49890000
499000      END-EVALUATE.                                               49900000
499100                                                                  49910000
499200*----------------------------------------------------------------*49920000
499300* CLOSE NOT-TRAN-PREPK CURSOR.                                    49930000
499400*----------------------------------------------------------------*49940000
499500 4220B-CLOSE-NOT-TRAN-PREPK-CSR.                                  49950000
499600      EXEC SQL                                                    49960000
499700           CLOSE NOT-TRAN-PREPK-CSR                               49970000
499800      END-EXEC                                                    49980000
499900                                                                  49990000
500000      EVALUATE TRUE                                               50000000
500100          WHEN SQLCODE = ZERO                                     50010000
500200               CONTINUE                                           50020000
500300          WHEN SQLWARN0 NOT = SPACES                              50030000
500400          WHEN SQLCODE  < ZERO                                    50040000
500500          WHEN SQLCODE  > ZERO                                    50050000
500600               MOVE '4220B-CLOSE-NOT-TRAN-PREPK-CSR'              50060000
500700                                TO DP013-PARAGRAPH                50070000
500800               MOVE 'CLOSE NOT TRAN PREPK CURSOR'                 50080000
500900                                TO DP013-MESSAGE-TEXT (1)         50090000
501000               MOVE SQLCA           TO DP013-SQLCA                50100000
501100               MOVE 'TPKSLIP'   TO DP013-DB2-TABLE-NAME (1)       50110000
501200               MOVE 'TINPKSU'   TO DP013-DB2-TABLE-NAME (2)       50120000
501300               SET DP013-DB2-ABEND                                50130000
501400                   DP013-XCTL-DISPLAY-RESTART                     50140000
501500                                TO TRUE                           50150000
501600               PERFORM DP013-0000-PROCESS-ABEND                   50160000
501700      END-EVALUATE.                                               50170000
501800                                                                  50180000
501900*----------------------------------------------------------------*50190000
502000* CLOSE NON-PREPACK CURSOR.                                       50200000
502100*----------------------------------------------------------------*50210000
502200 4220C-CLOSE-NON-PREPK-CSR.                                       50220000
502300      EXEC SQL                                                    50230000
502400           CLOSE NON-PREPK-CSR                                    50240000
502500      END-EXEC                                                    50250000
502600                                                                  50260000
502700      EVALUATE TRUE                                               50270000
502800          WHEN SQLCODE = ZERO                                     50280000
502900               CONTINUE                                           50290000
503000          WHEN SQLWARN0 NOT = SPACES                              50300000
503100          WHEN SQLCODE  < ZERO                                    50310000
503200          WHEN SQLCODE  > ZERO                                    50320000
503300               MOVE '4220C-CLOSE-NON-PREPK-CSR'                   50330000
503400                                TO DP013-PARAGRAPH                50340000
503500               MOVE 'CLOSE NON-PREPACK CURSOR'                    50350000
503600                                TO DP013-MESSAGE-TEXT (1)         50360000
503700               MOVE SQLCA           TO DP013-SQLCA                50370000
503800               MOVE 'TPKSLIP'   TO DP013-DB2-TABLE-NAME (1)       50380000
503900               MOVE 'TINPKSU'   TO DP013-DB2-TABLE-NAME (2)       50390000
504000               SET DP013-DB2-ABEND                                50400000
504100                   DP013-XCTL-DISPLAY-RESTART                     50410000
504200                                TO TRUE                           50420000
504300               PERFORM DP013-0000-PROCESS-ABEND                   50430000
504400      END-EVALUATE.                                               50440000
504500                                                                  50450000
504600*----------------------------------------------------------------*50460000
504700* CLOSE PBS CURSOR.                                               50470000
504800*----------------------------------------------------------------*50480000
504900 4220D-CLOSE-PBS-CSR.                                             50490000
505000      EXEC SQL                                                    50500000
505100           CLOSE PBS-CSR                                          50510000
505200      END-EXEC                                                    50520000
505300                                                                  50530000
505400      EVALUATE TRUE                                               50540000
505500          WHEN SQLCODE = ZERO                                     50550000
505600               CONTINUE                                           50560000
505700          WHEN SQLWARN0 NOT = SPACES                              50570000
505800          WHEN SQLCODE  < ZERO                                    50580000
505900          WHEN SQLCODE  > ZERO                                    50590000
506000               MOVE '4220D-CLOSE-PBS-CSR'                         50600000
506100                                TO DP013-PARAGRAPH                50610000
506200               MOVE 'CLOSE PBS CURSOR'                            50620000
506300                                TO DP013-MESSAGE-TEXT (1)         50630000
506400               MOVE SQLCA           TO DP013-SQLCA                50640000
506500               MOVE 'TPKSLIP'   TO DP013-DB2-TABLE-NAME (1)       50650000
506600               MOVE 'TINPKSU'   TO DP013-DB2-TABLE-NAME (2)       50660000
506700               SET DP013-DB2-ABEND                                50670000
506800                   DP013-XCTL-DISPLAY-RESTART                     50680000
506900                                TO TRUE                           50690000
507000               PERFORM DP013-0000-PROCESS-ABEND                   50700000
507100      END-EVALUATE.                                               50710000
507200                                                                  50720000
507300                                                                  50730000
507400*----------------------------------------------------------------*50740000
507500* CLOSE PO-TRANS-PREPK CURSOR.                                    50750000
507600*----------------------------------------------------------------*50760000
507700 4220E-CLOSE-PO-TRAN-PREPK-CSR.                                   50770000
507800      EXEC SQL                                                    50780000
507900           CLOSE PO-TRAN-PREPK-CSR                                50790000
508000      END-EXEC                                                    50800000
508100                                                                  50810000
508200      EVALUATE TRUE                                               50820000
508300          WHEN SQLCODE = ZERO                                     50830000
508400               CONTINUE                                           50840000
508500          WHEN SQLWARN0 NOT = SPACES                              50850000
508600          WHEN SQLCODE  < ZERO                                    50860000
508700          WHEN SQLCODE  > ZERO                                    50870000
508800               MOVE '4220E-CLOSE-PO-TRAN-PREPK-CSR'               50880000
508900                                TO DP013-PARAGRAPH                50890000
509000               MOVE 'CLOSE PO TRANS PREPK CURSOR'                 50900000
509100                                TO DP013-MESSAGE-TEXT (1)         50910000
509200               MOVE SQLCA           TO DP013-SQLCA                50920000
509300               MOVE 'TPKSLIP'   TO DP013-DB2-TABLE-NAME (1)       50930000
509400               MOVE 'TINPKSU'   TO DP013-DB2-TABLE-NAME (2)       50940000
509500               SET DP013-DB2-ABEND                                50950000
509600                   DP013-XCTL-DISPLAY-RESTART                     50960000
509700                                TO TRUE                           50970000
509800               PERFORM DP013-0000-PROCESS-ABEND                   50980000
509900      END-EVALUATE.                                               50990000
510000                                                                  51000000
510100*----------------------------------------------------------------*51010000
510200* CLOSE PO-NON-PREPACK CURSOR.                                    51020000
510300*----------------------------------------------------------------*51030000
510400 4220G-CLOSE-PO-NON-PREPK-CSR.                                    51040000
510500      EXEC SQL                                                    51050000
510600           CLOSE PO-NON-PREPK-CSR                                 51060000
510700      END-EXEC                                                    51070000
510800                                                                  51080000
510900      EVALUATE TRUE                                               51090000
511000          WHEN SQLCODE = ZERO                                     51100000
511100               CONTINUE                                           51110000
511200          WHEN SQLWARN0 NOT = SPACES                              51120000
511300          WHEN SQLCODE  < ZERO                                    51130000
511400          WHEN SQLCODE  > ZERO                                    51140000
511500               MOVE '4220G-CLOSE-PO-NON-PREPK-CSR'                51150000
511600                                TO DP013-PARAGRAPH                51160000
511700               MOVE 'CLOSE PO-NON-PREPACK CURSOR'                 51170000
511800                                TO DP013-MESSAGE-TEXT (1)         51180000
511900               MOVE SQLCA           TO DP013-SQLCA                51190000
512000               MOVE 'TPKSLIP'   TO DP013-DB2-TABLE-NAME (1)       51200000
512100               MOVE 'TINPKSU'   TO DP013-DB2-TABLE-NAME (2)       51210000
512200               SET DP013-DB2-ABEND                                51220000
512300                   DP013-XCTL-DISPLAY-RESTART                     51230000
512400                                TO TRUE                           51240000
512500               PERFORM DP013-0000-PROCESS-ABEND                   51250000
512600      END-EVALUATE.                                               51260000
512700                                                                  51270000
512800*----------------------------------------------------------------*51280000
512900* CLOSE PO-PBS CURSOR.                                            51290000
513000*----------------------------------------------------------------*51300000
513100 4220H-CLOSE-PO-PBS-CSR.                                          51310000
513200      EXEC SQL                                                    51320000
513300           CLOSE PO-PBS-CSR                                       51330000
513400      END-EXEC                                                    51340000
513500                                                                  51350000
513600      EVALUATE TRUE                                               51360000
513700          WHEN SQLCODE = ZERO                                     51370000
513800               CONTINUE                                           51380000
513900          WHEN SQLWARN0 NOT = SPACES                              51390000
514000          WHEN SQLCODE  < ZERO                                    51400000
514100          WHEN SQLCODE  > ZERO                                    51410000
514200               MOVE '4220H-CLOSE-PO-PBS-CSR'                      51420000
514300                                TO DP013-PARAGRAPH                51430000
514400               MOVE 'CLOSE PO-PBS CURSOR'                         51440000
514500                                TO DP013-MESSAGE-TEXT (1)         51450000
514600               MOVE SQLCA           TO DP013-SQLCA                51460000
514700               MOVE 'TPKSLIP'   TO DP013-DB2-TABLE-NAME (1)       51470000
514800               MOVE 'TINPKSU'   TO DP013-DB2-TABLE-NAME (2)       51480000
514900               SET DP013-DB2-ABEND                                51490000
515000                   DP013-XCTL-DISPLAY-RESTART                     51500000
515100                                TO TRUE                           51510000
515200               PERFORM DP013-0000-PROCESS-ABEND                   51520000
515300      END-EVALUATE.                                               51530000
515400                                                                  51540000
515500                                                                  51550000
515600*----------------------------------------------------------------*51560000
515700* OPEN PACKSLIP LINE CURSOR.                                      51570000
515800*----------------------------------------------------------------*51580000
515900 4230-OPEN-PACKSLIP-LINE-CSR.                                     51590000
516000     EXEC SQL                                                     51600000
516100          OPEN PACKSLIP-LINE-CSR                                  51610000
516200     END-EXEC                                                     51620000
516300                                                                  51630000
516400     EVALUATE TRUE                                                51640000
516500         WHEN SQLCODE = ZERO                                      51650000
516600         WHEN SQLCODE = -904                                      51660000
516700         WHEN SQLCODE = -913                                      51670000
516800              CONTINUE                                            51680000
516900         WHEN SQLWARN0 NOT = SPACES                               51690000
517000         WHEN SQLCODE  < ZERO                                     51700000
517100         WHEN SQLCODE  > ZERO                                     51710000
517200              MOVE '4230-OPEN-PACKSLIP-LINE-CSR'                  51720000
517300                               TO DP013-PARAGRAPH                 51730000
517400              MOVE 'OPEN PACKSLIP LINE CURSOR - '                 51740000
517500                               TO DP013-MESSAGE-TEXT (1)          51750000
517600              MOVE SQLCA       TO DP013-SQLCA                     51760000
517700              MOVE 'TPKSLIP'   TO DP013-DB2-TABLE-NAME (1)        51770000
517800              MOVE 'TINPKSU'   TO DP013-DB2-TABLE-NAME (2)        51780000
517900              SET DP013-DB2-ABEND                                 51790000
518000                  DP013-XCTL-DISPLAY-RESTART TO TRUE              51800000
518100              PERFORM DP013-0000-PROCESS-ABEND                    51810000
518200     END-EVALUATE.                                                51820000
518300                                                                  51830000
518400*----------------------------------------------------------------*51840000
518500*    FETCH PACKSLIP LINE CURSOR.                                  51850000
518600*----------------------------------------------------------------*51860000
518700 4235-FETCH-PACKSLIP-LINE-CSR.                                    51870000
518800      EXEC SQL                                                    51880000
518900           FETCH PACKSLIP-LINE-CSR                                51890000
519000            INTO :PV-UNION-TYPE                                   51900000
519100                ,:PKSLIP-REC-SEQ-NBR                              51910000
519200                ,:SHPUNT-SHIPT-UNT-ID                             51920000
519300                ,:SHPUNT-ACTV-IND                                 51930000
519400                ,:SHPUNT-DEST-OPER-UNT-ID                         51940000
519500                ,:SHUNLO-CRE-TMST                                 51950000
519600                ,:WS-SHUNLO-CRE-TMST-DATE                         51960000
519700                ,:WS-SHUNLO-CRE-TMST-TIME                         51970000
519800                ,:SHUNLO-TRIP-ID                                  51980000
519900                ,:VHTRIP-OWNER-SCAC-ID                            51990000
520000                ,:VHTRIP-VEH-NBR :DN-VEH-NBR                      52000000
520100                ,:SHUUPC-TRN-LNE-NBR                              52010000
520200      END-EXEC                                                    52020000
520300                                                                  52030000
520400      EVALUATE TRUE                                               52040000
520500          WHEN SQLCODE = ZERO                                     52050000
520600              MOVE WS-SHUNLO-CRE-TMST TO PV-TMST-R                52060000
520700              MOVE PV-TMST-CC         TO PV-DISPLAY-CC            52070000
520800              MOVE PV-TMST-YY         TO PV-DISPLAY-YY            52080000
520900              MOVE PC-SLASH           TO PV-SLASH-1               52090000
521000              MOVE PV-TMST-MM         TO PV-DISPLAY-MM            52100000
521100              MOVE PC-SLASH           TO PV-SLASH-2               52110000
521200              MOVE PV-TMST-DD         TO PV-DISPLAY-DD            52120000
521300              MOVE PV-TMST-HRS        TO PV-DISPLAY-HRS           52130000
521400              MOVE PC-COLON           TO PV-COLON                 52140000
521500              MOVE PV-TMST-MIN        TO PV-DISPLAY-MIN           52150000
521600                                                                  52160000
521700              MOVE PV-DATE-TIME-DISPLAY                           52170000
521800                                      TO  WS-SHUNLO-CRE-TMST      52180000
521900                                                                  52190000
522000          WHEN SQLCODE = +100                                     52200000
522100               SET PS-EO-PACKSLIP-LINE-CSR                        52210000
522200                   ASC-NO-ITEMS-LEFT-ON-DB TO TRUE                52220000
522300          WHEN SQLWARN0 NOT = SPACES                              52230000
522400          WHEN SQLCODE NOT = ZERO                                 52240000
522500               MOVE '4235-FETCH-PACKSLIP-LINE-CSR'                52250000
522600                                    TO DP013-PARAGRAPH            52260000
522700               MOVE 'FETCH PACKSLIP LINE CURSOR'                  52270000
522800                                    TO DP013-MESSAGE-TEXT (1)     52280000
522900               MOVE DK-PO-NBR                                     52290000
523000                                    TO DP013-MESSAGE-TEXT (2)     52300000
523100               MOVE DK-SEQ-NBR                                    52310000
523200                                    TO DP013-MESSAGE-TEXT (3)     52320000
523300               MOVE DK-LINE-NBR                                   52330000
523400                                    TO DP013-MESSAGE-TEXT (4)     52340000
523500               MOVE SQLCA           TO DP013-SQLCA                52350000
523600               MOVE 'TPKSLIP'   TO DP013-DB2-TABLE-NAME (1)       52360000
523700               SET DP013-DB2-ABEND  TO TRUE                       52370000
523800               PERFORM DP013-0000-PROCESS-ABEND                   52380000
523900      END-EVALUATE.                                               52390000
524000                                                                  52400000
524100*----------------------------------------------------------------*52410000
524200* CLOSE PACKSLIP LINE CURSOR.                                     52420000
524300*----------------------------------------------------------------*52430000
524400 4240-CLOSE-PACKSLIP-LINE-CSR.                                    52440000
524500     EXEC SQL                                                     52450000
524600          CLOSE PACKSLIP-LINE-CSR                                 52460000
524700     END-EXEC                                                     52470000
524800                                                                  52480000
524900     EVALUATE TRUE                                                52490000
525000         WHEN SQLCODE = ZERO                                      52500000
525100              CONTINUE                                            52510000
525200         WHEN SQLWARN0 NOT = SPACES                               52520000
525300         WHEN SQLCODE  < ZERO                                     52530000
525400         WHEN SQLCODE  > ZERO                                     52540000
525500              MOVE '4240-CLOSE-PACKSLIP-LINE-CSR'                 52550000
525600                               TO DP013-PARAGRAPH                 52560000
525700              MOVE 'CLOSE PACKSLIP LINE CURSOR'                   52570000
525800                               TO DP013-MESSAGE-TEXT (1)          52580000
525900              MOVE SQLCA           TO DP013-SQLCA                 52590000
526000              MOVE 'TPKSLIP'   TO DP013-DB2-TABLE-NAME (1)        52600000
526100              MOVE 'TINPKSU'   TO DP013-DB2-TABLE-NAME (2)        52610000
526200              SET DP013-DB2-ABEND                                 52620000
526300                  DP013-XCTL-DISPLAY-RESTART                      52630000
526400                               TO TRUE                            52640000
526500              PERFORM DP013-0000-PROCESS-ABEND                    52650000
526600     END-EVALUATE.                                                52660000
526700                                                                  52670000
526800*----------------------------------------------------------------*52680000
526900* OPEN ALL LINES CURSOR.                                          52690000
527000*----------------------------------------------------------------*52700000
527100 4230A-OPEN-ALL-LINES-CSR.                                        52710000
527200     EXEC SQL                                                     52720000
527300          OPEN ALL-LINES-CSR                                      52730000
527400     END-EXEC                                                     52740000
527500                                                                  52750000
527600     EVALUATE TRUE                                                52760000
527700         WHEN SQLCODE = ZERO                                      52770000
527800         WHEN SQLCODE = -904                                      52780000
527900         WHEN SQLCODE = -913                                      52790000
528000              CONTINUE                                            52800000
528100         WHEN SQLWARN0 NOT = SPACES                               52810000
528200         WHEN SQLCODE  < ZERO                                     52820000
528300         WHEN SQLCODE  > ZERO                                     52830000
528400              MOVE '4230A-OPEN-ALL-LINES-CSR'                     52840000
528500                               TO DP013-PARAGRAPH                 52850000
528600              MOVE 'OPEN ALL LINES CURSOR - '                     52860000
528700                               TO DP013-MESSAGE-TEXT (1)          52870000
528800              MOVE SQLCA       TO DP013-SQLCA                     52880000
528900              MOVE 'TPKSLIP'   TO DP013-DB2-TABLE-NAME (1)        52890000
529000              MOVE 'TINPKSU'   TO DP013-DB2-TABLE-NAME (2)        52900000
529100              SET DP013-DB2-ABEND                                 52910000
529200                  DP013-XCTL-DISPLAY-RESTART TO TRUE              52920000
529300              PERFORM DP013-0000-PROCESS-ABEND                    52930000
529400     END-EVALUATE.                                                52940000
529500                                                                  52950000
529600*----------------------------------------------------------------*52960000
529700*    FETCH ALL LINES CURSOR.                                      52970000
529800*----------------------------------------------------------------*52980000
529900 4235A-FETCH-ALL-LINES-CSR.                                       52990000
530000      EXEC SQL                                                    53000000
530100           FETCH ALL-LINES-CSR                                    53010000
530200            INTO :PV-UNION-TYPE                                   53020000
530300                ,:PKSLIP-REC-SEQ-NBR                              53030000
530400                ,:SHPUNT-SHIPT-UNT-ID                             53040000
530500                ,:SHPUNT-ACTV-IND                                 53050000
530600                ,:SHPUNT-DEST-OPER-UNT-ID                         53060000
530700                ,:SHUNLO-CRE-TMST                                 53070000
530800                ,:WS-SHUNLO-CRE-TMST-DATE                         53080000
530900                ,:WS-SHUNLO-CRE-TMST-TIME                         53090000
531000                ,:SHUNLO-TRIP-ID                                  53100000
531100                ,:VHTRIP-OWNER-SCAC-ID                            53110000
531200                ,:VHTRIP-VEH-NBR :DN-VEH-NBR                      53120000
531300                ,:SHUUPC-TRN-LNE-NBR                              53130000
531400      END-EXEC                                                    53140000
531500                                                                  53150000
531600      EVALUATE TRUE                                               53160000
531700          WHEN SQLCODE = ZERO                                     53170000
531800              MOVE WS-SHUNLO-CRE-TMST TO PV-TMST-R                53180000
531900              MOVE PV-TMST-CC         TO PV-DISPLAY-CC            53190000
532000              MOVE PV-TMST-YY         TO PV-DISPLAY-YY            53200000
532100              MOVE PC-SLASH           TO PV-SLASH-1               53210000
532200              MOVE PV-TMST-MM         TO PV-DISPLAY-MM            53220000
532300              MOVE PC-SLASH           TO PV-SLASH-2               53230000
532400              MOVE PV-TMST-DD         TO PV-DISPLAY-DD            53240000
532500              MOVE PV-TMST-HRS        TO PV-DISPLAY-HRS           53250000
532600              MOVE PC-COLON           TO PV-COLON                 53260000
532700              MOVE PV-TMST-MIN        TO PV-DISPLAY-MIN           53270000
532800                                                                  53280000
532900              MOVE PV-DATE-TIME-DISPLAY                           53290000
533000                                      TO  WS-SHUNLO-CRE-TMST      53300000
533100                                                                  53310000
533200          WHEN SQLCODE = +100                                     53320000
533300               SET PS-EO-ALL-LINES-CSR                            53330000
533400                   ASC-NO-ITEMS-LEFT-ON-DB TO TRUE                53340000
533500          WHEN SQLWARN0 NOT = SPACES                              53350000
533600          WHEN SQLCODE NOT = ZERO                                 53360000
533700               MOVE '4235A-FETCH-ALL-LINES-CSR'                   53370000
533800                                    TO DP013-PARAGRAPH            53380000
533900               MOVE 'FETCH ALL LINES CURSOR'                      53390000
534000                                    TO DP013-MESSAGE-TEXT (1)     53400000
534100               MOVE DK-PO-NBR                                     53410000
534200                                    TO DP013-MESSAGE-TEXT (2)     53420000
534300               MOVE DK-SEQ-NBR                                    53430000
534400                                    TO DP013-MESSAGE-TEXT (3)     53440000
534500               MOVE SQLCA           TO DP013-SQLCA                53450000
534600               MOVE 'TPKSLIP'   TO DP013-DB2-TABLE-NAME (1)       53460000
534700               SET DP013-DB2-ABEND  TO TRUE                       53470000
534800               PERFORM DP013-0000-PROCESS-ABEND                   53480000
534900      END-EVALUATE.                                               53490000
535000                                                                  53500000
535100*----------------------------------------------------------------*53510000
535200* CLOSE ALL LINES CURSOR.                                         53520000
535300*----------------------------------------------------------------*53530000
535400 4240A-CLOSE-ALL-LINES-CSR.                                       53540000
535500     EXEC SQL                                                     53550000
535600          CLOSE ALL-LINES-CSR                                     53560000
535700     END-EXEC                                                     53570000
535800                                                                  53580000
535900     EVALUATE TRUE                                                53590000
536000         WHEN SQLCODE = ZERO                                      53600000
536100              CONTINUE                                            53610000
536200         WHEN SQLWARN0 NOT = SPACES                               53620000
536300         WHEN SQLCODE  < ZERO                                     53630000
536400         WHEN SQLCODE  > ZERO                                     53640000
536500              MOVE '4240A-CLOSE-ALL-LINES-CSR'                    53650000
536600                               TO DP013-PARAGRAPH                 53660000
536700              MOVE 'CLOSE ALL LINES CURSOR'                       53670000
536800                               TO DP013-MESSAGE-TEXT (1)          53680000
536900              MOVE SQLCA           TO DP013-SQLCA                 53690000
537000              MOVE 'TPKSLIP'   TO DP013-DB2-TABLE-NAME (1)        53700000
537100              MOVE 'TINPKSU'   TO DP013-DB2-TABLE-NAME (2)        53710000
537200              SET DP013-DB2-ABEND                                 53720000
537300                  DP013-XCTL-DISPLAY-RESTART                      53730000
537400                               TO TRUE                            53740000
537500              PERFORM DP013-0000-PROCESS-ABEND                    53750000
537600     END-EVALUATE.                                                53760000
537700                                                                  53770000
537800*----------------------------------------------------------------*53780000
537900* OPEN UPC CURSOR                                                 53790000
538000*----------------------------------------------------------------*53800000
538100 4250-OPEN-UPC-CSR.                                               53810000
538200      EXEC SQL                                                    53820000
538300           OPEN UPC-CSR                                           53830000
538400      END-EXEC                                                    53840000
538500                                                                  53850000
538600      EVALUATE TRUE                                               53860000
538700          WHEN SQLCODE = ZERO                                     53870000
538800          WHEN SQLCODE = -904                                     53880000
538900          WHEN SQLCODE = -913                                     53890000
539000               CONTINUE                                           53900000
539100          WHEN SQLWARN0 NOT = SPACES                              53910000
539200          WHEN SQLCODE  < ZERO                                    53920000
539300          WHEN SQLCODE  > ZERO                                    53930000
539400               MOVE '4250-OPEN-UPC-CSR'                           53940000
539500                                TO DP013-PARAGRAPH                53950000
539600               MOVE 'OPEN UPC CURSOR - '                          53960000
539700                                TO DP013-MESSAGE-TEXT (1)         53970000
539800               MOVE SQLCA       TO DP013-SQLCA                    53980000
539900               MOVE 'TSHUUPC'   TO DP013-DB2-TABLE-NAME (1)       53990000
540000               SET DP013-DB2-ABEND                                54000000
540100                   DP013-XCTL-DISPLAY-RESTART TO TRUE             54010000
540200               PERFORM DP013-0000-PROCESS-ABEND                   54020000
540300      END-EVALUATE.                                               54030000
540400                                                                  54040000
540500 4252-PROCESS-UPC-CSR.                                            54050000
540600                                                                  54060000
540700     PERFORM 4255-FETCH-UPC-CSR                                   54070000
540800        IF  SQLCODE = ZERO                                        54080000
540900            IF  SHUUPC-TRN-LNE-NBR  =  0                          54090000
541000                MOVE 'N'          TO ASC-UPC-IND                  54100000
541100                                   (ASC-BLK-SUB ASC-ITEM-SUB)     54110000
541200                SET ASC-UPC-NOT-FOUND TO TRUE                     54120000
541300            ELSE                                                  54130000
541400                SET ASC-UPC-FOUND TO TRUE                         54140000
541500            END-IF                                                54150000
541600            IF  ASC-RECEIVER > 0                                  54160000
541700*** DMH 3/24/2004 - BEGIN                                         54170000
541800                IF  ASC-LINE  =  0                                54180000
541900                    MOVE SHUUPC-TRN-LNE-NBR  TO  DK-LINE-NBR      54190000
542000                END-IF                                            54200000
542100*** DMH 3/24/2004 - BEGIN                                         54210000
542200                IF  ASC-UPC-FOUND-SW = 'Y'                        54220000
542300                    PERFORM 4630-CHECK-LINE-TABLE                 54230000
542400                END-IF                                            54240000
542500            END-IF                                                54250000
542600        END-IF.                                                   54260000
542700                                                                  54270000
542800                                                                  54280000
542900*----------------------------------------------------------------*54290000
543000*    FETCH UPC CURSOR.                                            54300000
543100*----------------------------------------------------------------*54310000
543200 4255-FETCH-UPC-CSR.                                              54320000
543300                                                                  54330000
543400      EXEC SQL                                                    54340000
543500           FETCH UPC-CSR                                          54350000
543600            INTO :SHUUPC-UPC-NBR                                  54360000
543700                ,:SHUUPC-TRN-LNE-NBR                              54370000
543800                ,:SHUUPC-SHPD-QTY                                 54380000
543900      END-EXEC                                                    54390000
544000                                                                  54400000
544100      EVALUATE TRUE                                               54410000
544200          WHEN SQLCODE = ZERO                                     54420000
544300               IF  ASC-PRE-PACK-ORDER                             54430000
544400                   MOVE  SHUUPC-TRN-LNE-NBR                       54440000
544500                     TO  DK-LINE-NBR                              54450000
544600               END-IF                                             54460000
544700          WHEN SQLCODE = +100                                     54470000
544800               SET PS-EO-UPC-CSR TO TRUE                          54480000
544900*              SET ASC-NO-ITEMS-LEFT-ON-DB TO TRUE                54490000
545000          WHEN SQLWARN0 NOT = SPACES                              54500000
545100          WHEN SQLCODE NOT = ZERO                                 54510000
545200               MOVE '4255-FETCH-UPC-CSR'                          54520000
545300                                    TO DP013-PARAGRAPH            54530000
545400               MOVE 'FETCH UPC CURSOR'                            54540000
545500                                    TO DP013-MESSAGE-TEXT (1)     54550000
545600               MOVE DK-SHIPT-UNT-ID                               54560000
545700                                    TO DP013-MESSAGE-TEXT (2)     54570000
545800               MOVE SQLCA           TO DP013-SQLCA                54580000
545900               MOVE 'TSHUUPC ' TO DP013-DB2-TABLE-NAME (1)        54590000
546000               SET DP013-DB2-ABEND  TO TRUE                       54600000
546100               PERFORM DP013-0000-PROCESS-ABEND                   54610000
546200      END-EVALUATE.                                               54620000
546300                                                                  54630000
546400*                                                                 54640000
546500*----------------------------------------------------------------*54650000
546600* CLOSE UPC CURSOR.                                               54660000
546700*----------------------------------------------------------------*54670000
546800 4260-CLOSE-UPC-CSR.                                              54680000
546900      EXEC SQL                                                    54690000
547000           CLOSE UPC-CSR                                          54700000
547100      END-EXEC                                                    54710000
547200                                                                  54720000
547300      EVALUATE TRUE                                               54730000
547400          WHEN SQLCODE = ZERO                                     54740000
547500               CONTINUE                                           54750000
547600          WHEN SQLWARN0 NOT = SPACES                              54760000
547700          WHEN SQLCODE  < ZERO                                    54770000
547800          WHEN SQLCODE  > ZERO                                    54780000
547900               MOVE '4260-CLOSE-UPC-CSR'                          54790000
548000                                TO DP013-PARAGRAPH                54800000
548100               MOVE 'CLOSE UPC CURSOR'                            54810000
548200                                TO DP013-MESSAGE-TEXT (1)         54820000
548300               MOVE SQLCA           TO DP013-SQLCA                54830000
548400               MOVE 'TSHUUPC'   TO DP013-DB2-TABLE-NAME (1)       54840000
548500               SET DP013-DB2-ABEND                                54850000
548600                   DP013-XCTL-DISPLAY-RESTART                     54860000
548700                                TO TRUE                           54870000
548800               PERFORM DP013-0000-PROCESS-ABEND                   54880000
548900      END-EVALUATE.                                               54890000
549000                                                                  54900000
549100**********************************                                54910000
549200*CHECK TO SEE IF ANY PBS ERRORS                                   54920000
549300**********************************                                54930000
549400 4261-CHECK-PBS-ERR.                                              54940000
549500     EXEC SQL                                                     54950000
549600        SELECT CRE_TMST                                           54960000
549700             , SCN_LOC_ID                                         54970000
549800          INTO :SHUNLO-CRE-TMST                                   54980000
549900             , :SHUNLO-SCN-LOC-ID                                 54990000
550000          FROM TSHUNLO                                            55000000
550100         WHERE SHIPT_UNT_ID       = :DK-SHIPT-UNT-ID              55010000
550200           AND SCN_LOC_ID IN ('PBSA','PBSB','PBSC','PBSD','PBSE') 55020000
550300     END-EXEC                                                     55030000
550400                                                                  55040000
550500     EVALUATE TRUE                                                55050000
550600         WHEN SQLCODE = ZERO                                      55060000
550700         WHEN SQLCODE = -811                                      55070000
550800              MOVE 'Y'          TO ASC-PBS-ERROR-IND              55080000
550900                                   (ASC-BLK-SUB ASC-ITEM-SUB)     55090000
551000         WHEN SQLCODE = +100                                      55100000
551100              MOVE 'N'          TO ASC-PBS-ERROR-IND              55110000
551200                                   (ASC-BLK-SUB ASC-ITEM-SUB)     55120000
551300         WHEN SQLWARN0 NOT = SPACES                               55130000
551400         WHEN SQLCODE NOT = ZERO                                  55140000
551500              MOVE '4261-CHECK-PBS-ERR'                           55150000
551600                                   TO DP013-PARAGRAPH             55160000
551700              MOVE 'CHECK IF PBS ERROR'                           55170000
551800                                   TO DP013-MESSAGE-TEXT (1)      55180000
551900              MOVE DK-SHIPT-UNT-ID                                55190000
552000                                   TO DP013-MESSAGE-TEXT (2)      55200000
552100              MOVE SQLCA           TO DP013-SQLCA                 55210000
552200              MOVE 'TSHUNLO'   TO DP013-DB2-TABLE-NAME (1)        55220000
552300              SET DP013-DB2-ABEND  TO TRUE                        55230000
552400              PERFORM DP013-0000-PROCESS-ABEND                    55240000
552500     END-EVALUATE.                                                55250000
552600                                                                  55260000
552700                                                                  55270000
552800**********************************************                    55280000
552900*CHECK TO SEE IF CARTON MISDIRECT - PBS ORDERS                    55290000
553000*PERFORM 4257A AND 4257B - AND COMPARE THE                        55300000
553100*OPER UNIT ID'S.                                                  55310000
553200**********************************************                    55320000
553300 4262-CHECK-MISDIRECT-PBS.                                        55330000
553400     PERFORM 4262A-SELECT-TSHPUNT                                 55340000
553500     PERFORM 4262B-SELECT-TTRIPST                                 55350000
553600                                                                  55360000
553700     IF SHPUNT-ORGN-OPER-UNT-ID = TRIPST-OPER-UNT-ID              55370000
553800        CONTINUE                                                  55380000
553900     ELSE                                                         55390000
554000        IF ASC-RECEIVER > 0                                       55400000
554100           PERFORM 4262C-SELECT-TRECEIV                           55410000
554200           IF RECEIV-CURR-OPER-UNT-ID = TRIPST-OPER-UNT-ID        55420000
554300              MOVE 'N'          TO ASC-PBS-MISDIRECT-IND          55430000
554400                                   (ASC-BLK-SUB ASC-ITEM-SUB)     55440000
554500           ELSE                                                   55450000
554600              MOVE 'Y'          TO ASC-PBS-MISDIRECT-IND          55460000
554700                                   (ASC-BLK-SUB ASC-ITEM-SUB)     55470000
554800           END-IF                                                 55480000
554900        ELSE                                                      55490000
555000           CONTINUE                                               55500000
555100        END-IF                                                    55510000
555200     END-IF.                                                      55520000
555300                                                                  55530000
555400*SELECT ORGN_OPER_UNT_ID BASED ON SHIPT_UNT_ID                    55540000
555500 4262A-SELECT-TSHPUNT.                                            55550000
555600     EXEC SQL                                                     55560000
555700        SELECT ORGN_OPER_UNT_ID                                   55570000
555800          INTO :SHPUNT-ORGN-OPER-UNT-ID                           55580000
555900          FROM TSHPUNT                                            55590000
556000         WHERE SHIPT_UNT_ID       = :DK-SHIPT-UNT-ID              55600000
556100     END-EXEC                                                     55610000
556200                                                                  55620000
556300     EVALUATE TRUE                                                55630000
556400         WHEN SQLCODE = ZERO                                      55640000
556500         WHEN SQLCODE = +100                                      55650000
556600              CONTINUE                                            55660000
556700         WHEN SQLWARN0 NOT = SPACES                               55670000
556800         WHEN SQLCODE NOT = ZERO                                  55680000
556900              MOVE '4262A-SELECT-TSHPUNT'                         55690000
557000                                   TO DP013-PARAGRAPH             55700000
557100              MOVE 'SELECT ORGN_OPER_UNT_ID'                      55710000
557200                                   TO DP013-MESSAGE-TEXT (1)      55720000
557300              MOVE DK-SHIPT-UNT-ID                                55730000
557400                                   TO DP013-MESSAGE-TEXT (2)      55740000
557500              MOVE SQLCA           TO DP013-SQLCA                 55750000
557600              MOVE 'TSHPUNT'   TO DP013-DB2-TABLE-NAME (1)        55760000
557700              SET DP013-DB2-ABEND  TO TRUE                        55770000
557800              PERFORM DP013-0000-PROCESS-ABEND                    55780000
557900     END-EVALUATE.                                                55790000
558000                                                                  55800000
558100*SELECT OPER_UNT_ID BASED ON TRIP_ID                              55810000
558200 4262B-SELECT-TTRIPST.                                            55820000
558300     EXEC SQL                                                     55830000
558400        SELECT DISTINCT OPER_UNT_ID                               55840000
558500          INTO :TRIPST-OPER-UNT-ID                                55850000
558600          FROM TTRIPST                                            55860000
558700         WHERE TRIP_ID            = :DK-TRIP-ID                   55870000
558800     END-EXEC                                                     55880000
558900                                                                  55890000
559000     EVALUATE TRUE                                                55900000
559100         WHEN SQLCODE = ZERO                                      55910000
559200         WHEN SQLCODE = +100                                      55920000
559300              CONTINUE                                            55930000
559400         WHEN SQLCODE = -811                                      55940007
559500              PERFORM 4262B1-SELECT-TTRIPST                       55950007
559600                                                                  55960007
559700         WHEN SQLWARN0 NOT = SPACES                               55970000
559800         WHEN SQLCODE NOT = ZERO                                  55980000
559900              MOVE '4262B-SELECT-TTRIPST'                         55990000
560000                                   TO DP013-PARAGRAPH             56000000
560100              MOVE 'SELECT OPER_UNT_ID'                           56010000
560200                                   TO DP013-MESSAGE-TEXT (1)      56020000
560300              MOVE DK-TRIP-ID                                     56030000
560400                                   TO DP013-MESSAGE-TEXT (2)      56040000
560500              MOVE SQLCA           TO DP013-SQLCA                 56050000
560600              MOVE 'TTRIPST'   TO DP013-DB2-TABLE-NAME (1)        56060000
560700              SET DP013-DB2-ABEND  TO TRUE                        56070000
560800              PERFORM DP013-0000-PROCESS-ABEND                    56080000
560900     END-EVALUATE.                                                56090000
561000                                                                  56100000
561100 4262B1-SELECT-TTRIPST.                                           56110007
561200     EXEC SQL                                                     56120007
561300        SELECT DISTINCT OPER_UNT_ID                               56130007
561400          INTO :TRIPST-OPER-UNT-ID                                56140007
561500          FROM TTRIPST                                            56150007
561600         WHERE TRIP_ID            = :DK-TRIP-ID                   56160007
561700          AND TRIP_STATUS_CDE     = 'AR'                          56170007
561800     END-EXEC                                                     56180007
561900                                                                  56190007
562000     EVALUATE TRUE                                                56200007
562100         WHEN SQLCODE = ZERO                                      56210007
562200              CONTINUE                                            56220008
562300         WHEN SQLCODE = +100                                      56230007
562400              PERFORM 4262B2-SELECT-TTRIPST                       56240008
562500                                                                  56250007
562600         WHEN SQLWARN0 NOT = SPACES                               56260007
562700         WHEN SQLCODE NOT = ZERO                                  56270007
562800              MOVE '4262B1-SELECT-TTRIPST'                        56280007
562900                                   TO DP013-PARAGRAPH             56290007
563000              MOVE 'SELECT OPER_UNT_ID'                           56300007
563100                                   TO DP013-MESSAGE-TEXT (1)      56310007
563200              MOVE DK-TRIP-ID                                     56320007
563300                                   TO DP013-MESSAGE-TEXT (2)      56330007
563400              MOVE SQLCA           TO DP013-SQLCA                 56340007
563500              MOVE 'TTRIPST'   TO DP013-DB2-TABLE-NAME (1)        56350007
563600              SET DP013-DB2-ABEND  TO TRUE                        56360007
563700              PERFORM DP013-0000-PROCESS-ABEND                    56370007
563800     END-EVALUATE.                                                56380007
563900                                                                  56390007
564000 4262B2-SELECT-TTRIPST.                                           56400008
564100     EXEC SQL                                                     56410008
564200        SELECT DISTINCT OPER_UNT_ID                               56420008
564300          INTO :TRIPST-OPER-UNT-ID                                56430008
564400          FROM TTRIPST                                            56440008
564500         WHERE TRIP_ID            = :DK-TRIP-ID                   56450008
564600          AND TRIP_STATUS_CDE     = 'EN'                          56460008
564700     END-EXEC                                                     56470008
564800                                                                  56480008
564900     EVALUATE TRUE                                                56490008
565000         WHEN SQLCODE = ZERO                                      56500008
565100         WHEN SQLCODE = +100                                      56510008
565200              CONTINUE                                            56520008
565300                                                                  56530008
565400         WHEN SQLWARN0 NOT = SPACES                               56540008
565500         WHEN SQLCODE NOT = ZERO                                  56550008
565600              MOVE '4262B2-SELECT-TTRIPST'                        56560008
565700                                   TO DP013-PARAGRAPH             56570008
565800              MOVE 'SELECT OPER_UNT_ID'                           56580008
565900                                   TO DP013-MESSAGE-TEXT (1)      56590008
566000              MOVE DK-TRIP-ID                                     56600008
566100                                   TO DP013-MESSAGE-TEXT (2)      56610008
566200              MOVE SQLCA           TO DP013-SQLCA                 56620008
566300              MOVE 'TTRIPST'   TO DP013-DB2-TABLE-NAME (1)        56630008
566400              SET DP013-DB2-ABEND  TO TRUE                        56640008
566500              PERFORM DP013-0000-PROCESS-ABEND                    56650008
566600     END-EVALUATE.                                                56660008
566700                                                                  56670008
566800*SELECT CURR_OPER_UNT_ID BASED ON PO/RECEIVER                     56680008
566900 4262C-SELECT-TRECEIV.                                            56690000
567000     EXEC SQL                                                     56700000
567100        SELECT CURR_OPER_UNT_ID                                   56710000
567200          INTO :RECEIV-CURR-OPER-UNT-ID                           56720000
567300          FROM TRECEIV                                            56730000
567400         WHERE ORD_NBR            = :DK-PO-NBR                    56740000
567500           AND REC_SEQ_NBR        = :DK-REC-SEQ-NBR               56750000
567600     END-EXEC                                                     56760000
567700                                                                  56770000
567800     EVALUATE TRUE                                                56780000
567900         WHEN SQLCODE = ZERO                                      56790000
568000         WHEN SQLCODE = +100                                      56800000
568100              CONTINUE                                            56810000
568200         WHEN SQLWARN0 NOT = SPACES                               56820000
568300         WHEN SQLCODE NOT = ZERO                                  56830000
568400              MOVE '4262C-SELECT-TRECEIV'                         56840000
568500                                   TO DP013-PARAGRAPH             56850000
568600              MOVE 'SELECT CURR_OPER_UNT_ID'                      56860000
568700                                   TO DP013-MESSAGE-TEXT (1)      56870000
568800              MOVE DK-PO-NBR                                      56880000
568900                                   TO DP013-MESSAGE-TEXT (2)      56890000
569000              MOVE DK-REC-SEQ-NBR                                 56900000
569100                                   TO DP013-MESSAGE-TEXT (3)      56910000
569200              MOVE SQLCA           TO DP013-SQLCA                 56920000
569300              MOVE 'TRECEIV'   TO DP013-DB2-TABLE-NAME (1)        56930000
569400              SET DP013-DB2-ABEND  TO TRUE                        56940000
569500              PERFORM DP013-0000-PROCESS-ABEND                    56950000
569600     END-EVALUATE.                                                56960000
569700                                                                  56970000
569800                                                                  56980000
569900*----------------------------------------------------------------*56990000
570000* OPEN FREE ASTRAY CURSOR.                                        57000000
570100*----------------------------------------------------------------*57010000
570200 4265-OPEN-FREE-ASTRAY-CSR.                                       57020000
570300     EXEC SQL                                                     57030000
570400          OPEN FREE-ASTRAY-CSR                                    57040000
570500     END-EXEC                                                     57050000
570600                                                                  57060000
570700     EVALUATE TRUE                                                57070000
570800         WHEN SQLCODE = ZERO                                      57080000
570900         WHEN SQLCODE = -904                                      57090000
571000         WHEN SQLCODE = -913                                      57100000
571100              CONTINUE                                            57110000
571200         WHEN SQLWARN0 NOT = SPACES                               57120000
571300         WHEN SQLCODE  < ZERO                                     57130000
571400         WHEN SQLCODE  > ZERO                                     57140000
571500              MOVE '4265-OPEN-FREE-ASTRAY-CSR'                    57150000
571600                               TO DP013-PARAGRAPH                 57160000
571700              MOVE 'OPEN FREE-ASTRAY CURSOR - '                   57170000
571800                               TO DP013-MESSAGE-TEXT (1)          57180000
571900              MOVE SQLCA       TO DP013-SQLCA                     57190000
572000              MOVE 'TPKSLIP'   TO DP013-DB2-TABLE-NAME (1)        57200000
572100              SET DP013-DB2-ABEND                                 57210000
572200                  DP013-XCTL-DISPLAY-RESTART TO TRUE              57220000
572300              PERFORM DP013-0000-PROCESS-ABEND                    57230000
572400     END-EVALUATE.                                                57240000
572500                                                                  57250000
572600*----------------------------------------------------------------*57260000
572700*FETCH FREE ASTRAY CURSOR.                                        57270000
572800*----------------------------------------------------------------*57280000
572900 4270-FETCH-FREE-ASTRAY-CSR.                                      57290000
573000     EXEC SQL                                                     57300000
573100          FETCH FREE-ASTRAY-CSR                                   57310000
573200           INTO :PV-UNION-TYPE                                    57320000
573300               ,:PKSLIP-REC-SEQ-NBR                               57330000
573400               ,:SHPUNT-SHIPT-UNT-ID                              57340000
573500               ,:SHPUNT-ACTV-IND                                  57350000
573600               ,:SHPUNT-DEST-OPER-UNT-ID                          57360000
573700               ,:SHUNLO-CRE-TMST                                  57370000
573800               ,:WS-SHUNLO-CRE-TMST-DATE                          57380000
573900               ,:WS-SHUNLO-CRE-TMST-TIME                          57390000
574000               ,:SHUNLO-TRIP-ID                                   57400000
574100               ,:VHTRIP-OWNER-SCAC-ID                             57410000
574200               ,:VHTRIP-VEH-NBR :DN-VEH-NBR                       57420000
574300     END-EXEC                                                     57430000
574400                                                                  57440000
574500     EVALUATE TRUE                                                57450000
574600         WHEN SQLCODE = ZERO                                      57460000
574700              MOVE WS-SHUNLO-CRE-TMST TO PV-TMST-R                57470000
574800              MOVE PV-TMST-CC         TO PV-DISPLAY-CC            57480000
574900              MOVE PV-TMST-YY         TO PV-DISPLAY-YY            57490000
575000              MOVE PC-SLASH           TO PV-SLASH-1               57500000
575100              MOVE PV-TMST-MM         TO PV-DISPLAY-MM            57510000
575200              MOVE PC-SLASH           TO PV-SLASH-2               57520000
575300              MOVE PV-TMST-DD         TO PV-DISPLAY-DD            57530000
575400              MOVE PV-TMST-HRS        TO PV-DISPLAY-HRS           57540000
575500              MOVE PC-COLON           TO PV-COLON                 57550000
575600              MOVE PV-TMST-MIN        TO PV-DISPLAY-MIN           57560000
575700                                                                  57570000
575800              MOVE PV-DATE-TIME-DISPLAY                           57580000
575900                                      TO  WS-SHUNLO-CRE-TMST      57590000
576000                                                                  57600000
576100         WHEN SQLCODE = +100                                      57610000
576200              SET PS-EO-FREE-ASTRAY-CSR                           57620000
576300                  ASC-NO-ITEMS-LEFT-ON-DB TO TRUE                 57630000
576400         WHEN SQLWARN0 NOT = SPACES                               57640000
576500         WHEN SQLCODE NOT = ZERO                                  57650000
576600              MOVE '4270-FETCH-FREE-ASTRAY-CSR'                   57660000
576700                                   TO DP013-PARAGRAPH             57670000
576800              MOVE 'FETCH FREE ASTRAY CURSOR'                     57680000
576900                                   TO DP013-MESSAGE-TEXT (1)      57690000
577000              MOVE DK-PO-NBR                                      57700000
577100                                   TO DP013-MESSAGE-TEXT (2)      57710000
577200              MOVE DK-REC-SEQ-NBR                                 57720000
577300                                   TO DP013-MESSAGE-TEXT (3)      57730000
577400              MOVE SQLCA           TO DP013-SQLCA                 57740000
577500              MOVE 'TPKSLIP'   TO DP013-DB2-TABLE-NAME (1)        57750000
577600              SET DP013-DB2-ABEND  TO TRUE                        57760000
577700              PERFORM DP013-0000-PROCESS-ABEND                    57770000
577800     END-EVALUATE.                                                57780000
577900*                                                                 57790000
578000*----------------------------------------------------------------*57800000
578100* CLOSE FREE ASTRAY CURSOR.                                       57810000
578200*----------------------------------------------------------------*57820000
578300 4275-CLOSE-FREE-ASTRAY-CSR.                                      57830000
578400     EXEC SQL                                                     57840000
578500          CLOSE FREE-ASTRAY-CSR                                   57850000
578600     END-EXEC                                                     57860000
578700                                                                  57870000
578800     EVALUATE TRUE                                                57880000
578900         WHEN SQLCODE = ZERO                                      57890000
579000              CONTINUE                                            57900000
579100         WHEN SQLWARN0 NOT = SPACES                               57910000
579200         WHEN SQLCODE  < ZERO                                     57920000
579300         WHEN SQLCODE  > ZERO                                     57930000
579400              MOVE '4275-CLOSE-FREE-ASTRAY-CSR'                   57940000
579500                               TO DP013-PARAGRAPH                 57950000
579600              MOVE 'CLOSE FREE-ASTRAY CURSOR'                     57960000
579700                               TO DP013-MESSAGE-TEXT (1)          57970000
579800              MOVE SQLCA           TO DP013-SQLCA                 57980000
579900              MOVE 'TPKSLIP'   TO DP013-DB2-TABLE-NAME (1)        57990000
580000              SET DP013-DB2-ABEND                                 58000000
580100                  DP013-XCTL-DISPLAY-RESTART                      58010000
580200                               TO TRUE                            58020000
580300              PERFORM DP013-0000-PROCESS-ABEND                    58030000
580400     END-EVALUATE.                                                58040000
580500                                                                  58050000
580600**************************************************************    58060000
580700*CHECK TO SEE IF CARTON CHECKED-IN (SCANNED)                      58070000
580800**************************************************************    58080000
580900 4280-CHECK-IF-CHECKED-IN.                                        58090000
581000     EXEC SQL                                                     58100000
581100        SELECT SHIPT_UNT_ID                                       58110000
581200             , TRIP_ID                                            58120000
581300             , CRE_TMST                                           58130000
581400             , DATE(CRE_TMST)                                     58140000
581500             , TIME(CRE_TMST)                                     58150000
581600          INTO :SHUNLO-SHIPT-UNT-ID                               58160000
581700             , :SHUNLO-TRIP-ID                                    58170000
581800             , :SHUNLO-CRE-TMST                                   58180000
581900             , :WS-SHUNLO-CRE-TMST-DATE                           58190000
582000             , :WS-SHUNLO-CRE-TMST-TIME                           58200000
582100          FROM TSHUNLO                                            58210000
582200         WHERE SHIPT_UNT_ID = :DK-SHIPT-UNT-ID                    58220000
582300           AND ACTV_CDE     = 'A'                                 58230000
582400           AND SCN_LOC_ID  IN ('RECV', 'WRCV')                    58240000
582500     END-EXEC                                                     58250000
582600                                                                  58260000
582700     EVALUATE TRUE                                                58270000
582800         WHEN SQLCODE = ZERO                                      58280000
582900              SET ASC-CHECKED-IN      TO TRUE                     58290000
583000              MOVE SHUNLO-TRIP-ID     TO ASC-TRIP-ID              58300000
583100                                         DK-TRIP-ID               58310000
583200                                                                  58320000
583300              MOVE WS-SHUNLO-CRE-TMST TO PV-TMST-R                58330000
583400              MOVE PV-TMST-CC         TO PV-DISPLAY-CC            58340000
583500              MOVE PV-TMST-YY         TO PV-DISPLAY-YY            58350000
583600              MOVE PC-SLASH           TO PV-SLASH-1               58360000
583700              MOVE PV-TMST-MM         TO PV-DISPLAY-MM            58370000
583800              MOVE PC-SLASH           TO PV-SLASH-2               58380000
583900              MOVE PV-TMST-DD         TO PV-DISPLAY-DD            58390000
584000              MOVE PV-TMST-HRS        TO PV-DISPLAY-HRS           58400000
584100              MOVE PC-COLON           TO PV-COLON                 58410000
584200              MOVE PV-TMST-MIN        TO PV-DISPLAY-MIN           58420000
584300              MOVE PV-DATE-TIME-DISPLAY                           58430000
584400                                      TO WS-SHUNLO-CRE-TMST       58440000
584500         WHEN SQLCODE = +100                                      58450000
584600              SET ASC-NOT-CHECKED-IN  TO TRUE                     58460000
584700              IF  ASC-RECEIVER  >  0                              58470000
584800                  PERFORM 4290-GET-TRIP-INFO                      58480000
584900              END-IF                                              58490000
585000                                                                  58500000
585100         WHEN SQLWARN0 NOT = SPACES                               58510000
585200         WHEN SQLCODE NOT = ZERO                                  58520000
585300              MOVE '4280-CHECK-IF-CHECKED-IN'                     58530000
585400                                   TO DP013-PARAGRAPH             58540000
585500              MOVE 'CHECK IF CHECKED IN'                          58550000
585600                                   TO DP013-MESSAGE-TEXT (1)      58560000
585700              MOVE DK-SHIPT-UNT-ID                                58570000
585800                                   TO DP013-MESSAGE-TEXT (2)      58580000
585900              MOVE SQLCA           TO DP013-SQLCA                 58590000
586000              MOVE 'TSHUNLO'   TO DP013-DB2-TABLE-NAME (1)        58600000
586100              SET DP013-DB2-ABEND  TO TRUE                        58610000
586200              PERFORM DP013-0000-PROCESS-ABEND                    58620000
586300     END-EVALUATE.                                                58630000
586400                                                                  58640000
586500**************************************************************    58650000
586600*CHECK TO SEE IF RECEIVER TRANSCRIBED                             58660000
586700**************************************************************    58670000
586800 4285-CHECK-IF-TRANSCRIBED.                                       58680000
586900     EXEC SQL                                                     58690000
587000      SELECT COUNT(*)                                             58700000
587100          INTO :PV-TRAN-COUNT                                     58710000
587200        FROM TPKSLIP                                              58720000
587300       WHERE PO_NBR        = :DK-PO-NBR                           58730000
587400         AND SEQ_NBR       = :DK-SEQ-NBR                          58740000
587500         AND PKSL_STAT_CDE = 'AC'                                 58750000
587600         AND VER_STAT_CDE  = 'A'                                  58760000
587700     END-EXEC                                                     58770000
587800                                                                  58780000
587900     EVALUATE TRUE                                                58790000
588000         WHEN SQLCODE = ZERO                                      58800000
588100              IF PV-TRAN-COUNT > 0                                58810000
588200                 SET ASC-TRANSCRIBED     TO TRUE                  58820000
588300              ELSE                                                58830000
588400                 SET ASC-NOT-TRANSCRIBED TO TRUE                  58840000
588500              END-IF                                              58850000
588600         WHEN SQLWARN0 NOT = SPACES                               58860000
588700         WHEN SQLCODE NOT = ZERO                                  58870000
588800              MOVE '4285-CHECK-IF-TRANSCRIBED'                    58880000
588900                                   TO DP013-PARAGRAPH             58890000
589000              MOVE 'CHECK IF TRANSCRIBED'                         58900000
589100                                   TO DP013-MESSAGE-TEXT (1)      58910000
589200              MOVE DK-PO-NBR                                      58920000
589300                                   TO DP013-MESSAGE-TEXT (2)      58930000
589400              MOVE DK-REC-SEQ-NBR                                 58940000
589500                                   TO DP013-MESSAGE-TEXT (3)      58950000
589600              MOVE SQLCA           TO DP013-SQLCA                 58960000
589700              MOVE 'TPKSLIP'   TO DP013-DB2-TABLE-NAME (1)        58970000
589800              SET DP013-DB2-ABEND  TO TRUE                        58980000
589900              PERFORM DP013-0000-PROCESS-ABEND                    58990000
590000     END-EVALUATE.                                                59000000
590100                                                                  59010000
590200                                                                  59020000
590300******************************************************************59030000
590400* GET TRIP, SCAC & TRAILER.                                       59040000
590500******************************************************************59050000
590600 4290-GET-TRIP-INFO.                                              59060000
590700     EXEC SQL                                                     59070000
590800        SELECT C.TRIP_ID                                          59080000
590900             , C.OWNER_SCAC_ID                                    59090000
591000             , C.VEH_NBR                                          59100000
591100          INTO :VHTRIP-TRIP-ID                                    59110000
591200             , :VHTRIP-OWNER-SCAC-ID                              59120000
591300             , :VHTRIP-VEH-NBR :DN-VEH-NBR                        59130000
591400          FROM TSHPTPO A                                          59140000
591500             , TSHIPMT B                                          59150000
591600             , TVHTRIP C                                          59160000
591700         WHERE A.PO_NBR         = :DK-PO-NBR                      59170000
591800           AND A.REC_SEQ_NBR    = :DK-REC-SEQ-NBR                 59180000
591900           AND A.SHIPT_ID       = B.SHIPT_ID                      59190000
592000           AND A.PRIM_SHIPT_IND = 'Y'                             59200000
592100           AND B.TRIP_ID        = C.TRIP_ID                       59210000
592200     END-EXEC                                                     59220000
592300                                                                  59230000
592400     EVALUATE TRUE                                                59240000
592500         WHEN SQLCODE = ZERO                                      59250000
592600         WHEN SQLCODE = -811                                      59260000
592700              IF DN-VEH-NBR = -1                                  59270000
592800                 MOVE SPACES TO VHTRIP-VEH-NBR                    59280000
592900              END-IF                                              59290000
593000              MOVE VHTRIP-TRIP-ID TO ASC-TRIP-ID                  59300000
593100                                     DK-TRIP-ID                   59310000
593200         WHEN SQLCODE = +100                                      59320000
593300              CONTINUE                                            59330000
593400         WHEN SQLWARN0 NOT = SPACES                               59340000
593500         WHEN SQLCODE NOT = ZERO                                  59350000
593600              MOVE '4290-GET-TRIP-INFO'                           59360000
593700                                   TO DP013-PARAGRAPH             59370000
593800              MOVE 'GET TRIP'                                     59380000
593900                                   TO DP013-MESSAGE-TEXT (1)      59390000
594000              MOVE DK-PO-NBR                                      59400000
594100                                   TO DP013-MESSAGE-TEXT (2)      59410000
594200              MOVE DK-REC-SEQ-NBR                                 59420000
594300                                   TO DP013-MESSAGE-TEXT (3)      59430000
594400              MOVE SQLCA           TO DP013-SQLCA                 59440000
594500              MOVE 'TVHTRIP'   TO DP013-DB2-TABLE-NAME (1)        59450000
594600              SET DP013-DB2-ABEND  TO TRUE                        59460000
594700              PERFORM DP013-0000-PROCESS-ABEND                    59470000
594800     END-EVALUATE.                                                59480000
594900                                                                  59490000
595000**********************************************************        59500000
595100* IF THERE IS A RCVR, GET PKGNG CDE FROM TRECEIV                  59510000
595200**********************************************************        59520000
595300 4291A-TRECEIV-PKG-CDE.                                           59530000
595400      EXEC SQL                                                    59540000
595500         SELECT PKGNG_CDE                                         59550000
595600           INTO :RECEIV-PKGNG-CDE                                 59560000
595700           FROM TRECEIV                                           59570000
595800          WHERE ORD_NBR          = :DK-PO-NBR                     59580000
595900            AND REC_SEQ_NBR      = :DK-REC-SEQ-NBR                59590000
596000            AND VER_STATUS_CDE   = 'A'                            59600000
596100      END-EXEC                                                    59610000
596200                                                                  59620000
596300      EVALUATE TRUE                                               59630000
596400          WHEN SQLCODE = ZERO                                     59640000
596500               MOVE RECEIV-PKGNG-CDE TO ASC-PKGNG-CDE             59650000
596600          WHEN SQLWARN0 NOT = SPACES                              59660000
596700          WHEN SQLCODE NOT = ZERO                                 59670000
596800               MOVE '4291A-TRECEIV-PKG-CDE'                       59680000
596900                                    TO DP013-PARAGRAPH            59690000
597000               MOVE 'GET PO PKGNG CDE'                            59700000
597100                                    TO DP013-MESSAGE-TEXT (1)     59710000
597200               MOVE DK-PO-NBR                                     59720000
597300                                    TO DP013-MESSAGE-TEXT (2)     59730000
597400               MOVE DK-REC-SEQ-NBR                                59740000
597500                                    TO DP013-MESSAGE-TEXT (3)     59750000
597600               MOVE SQLCA           TO DP013-SQLCA                59760000
597700               MOVE 'TRECEIV'   TO DP013-DB2-TABLE-NAME (1)       59770000
597800               SET DP013-DB2-ABEND  TO TRUE                       59780000
597900               PERFORM DP013-0000-PROCESS-ABEND                   59790000
598000      END-EVALUATE.                                               59800000
598100                                                                  59810000
598200**********************************************************        59820000
598300* IF THERE IS NOT A RCVR, GET PKGNG CDE FROM TPURCHS              59830000
598400**********************************************************        59840000
598500 4291B-TPURCHS-PKG-CDE.                                           59850000
598600      EXEC SQL                                                    59860000
598700         SELECT PKGNG_CDE                                         59870000
598800           INTO :PURCHS-PKGNG-CDE                                 59880000
598900           FROM TPURCHS                                           59890000
599000          WHERE PO_NBR           = :DK-PO-NBR                     59900000
599100            AND VER_STATUS_CDE   = 'A'                            59910000
599200      END-EXEC                                                    59920000
599300                                                                  59930000
599400      EVALUATE TRUE                                               59940000
599500          WHEN SQLCODE = ZERO                                     59950000
599600               MOVE PURCHS-PKGNG-CDE TO ASC-PKGNG-CDE             59960000
599700          WHEN SQLCODE = +100                                     59970000
599800               SET PS-NO-PO          TO TRUE                      59980000
599900          WHEN SQLWARN0 NOT = SPACES                              59990000
600000          WHEN SQLCODE NOT = ZERO                                 60000000
600100               MOVE '4291B-TPURCHS-PKG-CDE'                       60010000
600200                                    TO DP013-PARAGRAPH            60020000
600300               MOVE 'GET PO PKGNG CDE'                            60030000
600400                                    TO DP013-MESSAGE-TEXT (1)     60040000
600500               MOVE DK-PO-NBR                                     60050000
600600                                    TO DP013-MESSAGE-TEXT (2)     60060000
600700               MOVE SQLCA           TO DP013-SQLCA                60070000
600800               MOVE 'TPURCHS'   TO DP013-DB2-TABLE-NAME (1)       60080000
600900               SET DP013-DB2-ABEND  TO TRUE                       60090000
601000               PERFORM DP013-0000-PROCESS-ABEND                   60100000
601100      END-EVALUATE.                                               60110000
601200                                                                  60120000
601300                                                                  60130000
601400*********************************************                     60140000
601500*USE WHEN COMING IN WITHOUT A LINE NUMBER                         60150000
601600*GET PREPACK ID USING SHIPT_UNT_ID AND PO NBR                     60160000
601700*********************************************                     60170000
601800  4292A-GET-PREPACK-ID.                                           60180000
601900      EXEC SQL                                                    60190000
602000         SELECT DISTINCT(B.PREPK_ID)                              60200000
602100           INTO :RECITM-PREPK-ID                                  60210000
602200           FROM TSHUUPC A                                         60220000
602300              , TRECITM B                                         60230000
602400          WHERE A.SHIPT_UNT_ID     = :DK-SHIPT-UNT-ID             60240000
602500            AND A.TRN_NBR          = :DK-PO-NBR                   60250000
602600            AND A.TRN_NBR          = B.ORD_NBR                    60260000
602700            AND B.REC_SEQ_NBR      = :DK-REC-SEQ-NBR              60270000
602800            AND A.TRN_LNE_NBR      = B.ORD_LNE_NBR                60280000
602900            AND B.VER_STATUS_CDE   = 'A'                          60290000
603000      END-EXEC                                                    60300000
603100                                                                  60310000
603200      EVALUATE TRUE                                               60320000
603300          WHEN SQLCODE = ZERO                                     60330000
603400               SET  PS-MULT-PACK-NO  TO TRUE                      60340000
603500          WHEN SQLCODE = +100                                     60350000
603600               MOVE ZEROES   TO  RECITM-PREPK-ID                  60360000
603700          WHEN SQLCODE = -811                                     60370000
603800               SET  PS-MULT-PACK     TO TRUE                      60380000
603900          WHEN SQLWARN0 NOT = SPACES                              60390000
604000          WHEN SQLCODE NOT = ZERO                                 60400000
604100               MOVE '4292A-GET-PREPACK-ID'                        60410000
604200                                    TO DP013-PARAGRAPH            60420000
604300               MOVE 'GET PREPACK ID'                              60430000
604400                                    TO DP013-MESSAGE-TEXT (1)     60440000
604500               MOVE DK-SHIPT-UNT-ID                               60450000
604600                                    TO DP013-MESSAGE-TEXT (2)     60460000
604700               MOVE DK-PO-NBR      TO PV-PO-NBR                   60470000
604800               MOVE DK-REC-SEQ-NBR TO PV-RECEIVER                 60480000
604900               MOVE PV-PO-RECEIVER                                60490000
605000                                    TO DP013-MESSAGE-TEXT (3)     60500000
605100               MOVE DK-OPER-UNT-ID                                60510000
605200                                    TO DP013-MESSAGE-TEXT (4)     60520000
605300               MOVE SQLCA           TO DP013-SQLCA                60530000
605400               MOVE 'TRECITM'   TO DP013-DB2-TABLE-NAME (1)       60540000
605500               MOVE 'TSHUUPC'   TO DP013-DB2-TABLE-NAME (2)       60550000
605600               SET DP013-DB2-ABEND  TO TRUE                       60560000
605700               PERFORM DP013-0000-PROCESS-ABEND                   60570000
605800      END-EVALUATE.                                               60580000
605900                                                                  60590000
606000**********************************                                60600000
606100*USE WHEN HAVE PO,RCVR & LINE                                     60610000
606200*GET PREPACK ID USING PO/RCVR/LINE                                60620000
606300**********************************                                60630000
606400 4292B-GET-PREPACK-ID.                                            60640000
606500      EXEC SQL                                                    60650000
606600         SELECT PREPK_ID                                          60660000
606700           INTO :RECITM-PREPK-ID                                  60670000
606800           FROM TRECITM                                           60680000
606900          WHERE ORD_NBR            = :DK-PO-NBR                   60690000
607000            AND REC_SEQ_NBR        = :DK-REC-SEQ-NBR              60700000
607100            AND ORD_LNE_NBR        = :DK-LINE-NBR                 60710000
607200            AND VER_STATUS_CDE     = 'A'                          60720000
607300      END-EXEC                                                    60730000
607400                                                                  60740000
607500      EVALUATE TRUE                                               60750000
607600          WHEN SQLCODE = ZERO                                     60760000
607700               SET  PS-MULT-PACK-NO  TO TRUE                      60770000
607800          WHEN SQLCODE = +100                                     60780000
607900               PERFORM 4292C-GET-PREPACK-ID                       60790000
608000          WHEN SQLCODE = -811                                     60800000
608100               SET  PS-MULT-PACK     TO TRUE                      60810000
608200          WHEN SQLWARN0 NOT = SPACES                              60820000
608300          WHEN SQLCODE NOT = ZERO                                 60830000
608400               MOVE '4292B-GET-PREPACK-ID'                        60840000
608500                                    TO DP013-PARAGRAPH            60850000
608600               MOVE 'GET PO PREPACK ID'                           60860000
608700                                    TO DP013-MESSAGE-TEXT (1)     60870000
608800               MOVE DK-PO-NBR                                     60880000
608900                                    TO DP013-MESSAGE-TEXT (2)     60890000
609000               MOVE DK-REC-SEQ-NBR                                60900000
609100                                    TO DP013-MESSAGE-TEXT (3)     60910000
609200               MOVE DK-LINE-NBR                                   60920000
609300                                    TO DP013-MESSAGE-TEXT (4)     60930000
609400               MOVE SQLCA           TO DP013-SQLCA                60940000
609500               MOVE 'TRECITM'   TO DP013-DB2-TABLE-NAME (1)       60950000
609600               SET DP013-DB2-ABEND  TO TRUE                       60960000
609700               PERFORM DP013-0000-PROCESS-ABEND                   60970000
609800      END-EVALUATE.                                               60980000
609900*************************************                             60990000
610000*USE WHEN ONLY HAVE THE PO AND LINE #                             61000000
610100*GET PREPACK ID - RECEIVER = 0                                    61010000
610200*************************************                             61020000
610300 4292C-GET-PREPACK-ID.                                            61030000
610400      EXEC SQL                                                    61040000
610500         SELECT PO_PREPK_ID                                       61050000
610600           INTO :PURITM-PO-PREPK-ID                               61060000
610700           FROM TPURITM                                           61070000
610800          WHERE PO_NBR             = :DK-PO-NBR                   61080000
610900            AND PO_LNE_NBR         = :DK-LINE-NBR                 61090000
611000            AND VER_STATUS_CDE     = 'A'                          61100000
611100      END-EXEC                                                    61110000
611200                                                                  61120000
611300      EVALUATE TRUE                                               61130000
611400          WHEN SQLCODE = ZERO                                     61140000
611500               SET  PS-MULT-PACK-NO  TO TRUE                      61150000
611600          WHEN SQLCODE = -811                                     61160000
611700               SET  PS-MULT-PACK     TO TRUE                      61170000
611800          WHEN SQLWARN0 NOT = SPACES                              61180000
611900          WHEN SQLCODE NOT = ZERO                                 61190000
612000               MOVE '4292C-GET-PREPACK-ID'                        61200000
612100                                    TO DP013-PARAGRAPH            61210000
612200               MOVE 'GET PO PREPACK ID'                           61220000
612300                                    TO DP013-MESSAGE-TEXT (1)     61230000
612400               MOVE DK-PO-NBR                                     61240000
612500                                    TO DP013-MESSAGE-TEXT (2)     61250000
612600               MOVE DK-LINE-NBR                                   61260000
612700                                    TO DP013-MESSAGE-TEXT (3)     61270000
612800               MOVE SQLCA           TO DP013-SQLCA                61280000
612900               MOVE 'TPURITM'   TO DP013-DB2-TABLE-NAME (1)       61290000
613000               SET DP013-DB2-ABEND  TO TRUE                       61300000
613100               PERFORM DP013-0000-PROCESS-ABEND                   61310000
613200      END-EVALUATE.                                               61320000
613300                                                                  61330000
613400*******************************************                       61340000
613500*GET PO LINE NUMBER NON-PACK ORDERS ONLY                          61350000
613600*******************************************                       61360000
613700 4293-GET-PO-LINE-NBR.                                            61370000
613800     EXEC SQL                                                     61380000
613900        SELECT DISTINCT TRN_NBR                                   61390000
614000                       ,TRN_LNE_NBR                               61400000
614100          INTO :SHUUPC-TRN-NBR                                    61410000
614200              ,:SHUUPC-TRN-LNE-NBR                                61420000
614300          FROM TSHUUPC                                            61430000
614400         WHERE SHIPT_UNT_ID       = :DK-SHIPT-UNT-ID              61440000
614500         GROUP BY TRN_NBR                                         61450000
614600                 ,TRN_LNE_NBR                                     61460000
614700     END-EXEC                                                     61470000
614800                                                                  61480000
614900     EVALUATE TRUE                                                61490000
615000         WHEN SQLCODE = ZERO                                      61500000
615100              MOVE SHUUPC-TRN-LNE-NBR TO DK-LINE-NBR              61510000
615200              SET PS-MULT-LINE-NO  TO TRUE                        61520000
615300         WHEN SQLCODE = -811                                      61530000
615400              SET PS-MULT-LINE     TO TRUE                        61540000
615500         WHEN SQLWARN0 NOT = SPACES                               61550000
615600         WHEN SQLCODE NOT = ZERO                                  61560000
615700              MOVE '4293-GET-PO-LINE-NBR'                         61570000
615800                                   TO DP013-PARAGRAPH             61580000
615900              MOVE 'GET PO LINE NBR'                              61590000
616000                                   TO DP013-MESSAGE-TEXT (1)      61600000
616100              MOVE DK-SHIPT-UNT-ID                                61610000
616200                                   TO DP013-MESSAGE-TEXT (2)      61620000
616300              MOVE SQLCA           TO DP013-SQLCA                 61630000
616400              MOVE 'TSHUUPC'   TO DP013-DB2-TABLE-NAME (1)        61640000
616500              SET DP013-DB2-ABEND  TO TRUE                        61650000
616600              PERFORM DP013-0000-PROCESS-ABEND                    61660000
616700     END-EVALUATE.                                                61670000
616800                                                                  61680000
616900                                                                  61690000
617000**********************************                                61700000
617100*GET PKSL SEQ NBR                                                 61710000
617200**********************************                                61720000
617300 4294-GET-PKSL-SEQ-NBR.                                           61730000
617400     EXEC SQL                                                     61740000
617500        SELECT SEQ_NBR                                            61750000
617600          INTO :PKSLIP-SEQ-NBR                                    61760000
617700          FROM TPKSLIP                                            61770000
617800         WHERE PO_NBR             = :DK-PO-NBR                    61780000
617900           AND VER_STAT_CDE       = 'A'                           61790000
618000           AND OPER_UNT_ID        = :DK-OPER-UNT-ID               61800000
618100           AND REC_SEQ_NBR        = :DK-REC-SEQ-NBR               61810000
618200     END-EXEC                                                     61820000
618300                                                                  61830000
618400     EVALUATE TRUE                                                61840000
618500         WHEN SQLCODE = ZERO                                      61850000
618600              MOVE PKSLIP-SEQ-NBR     TO DK-SEQ-NBR               61860000
618700         WHEN SQLCODE = -811                                      61870000
618800              SET PS-MULT-LINE        TO TRUE                     61880000
618900         WHEN SQLWARN0 NOT = SPACES                               61890000
619000         WHEN SQLCODE NOT = ZERO                                  61900000
619100              MOVE '4294-GET-PKSL-SEQ-NBR'                        61910000
619200                                   TO DP013-PARAGRAPH             61920000
619300              MOVE 'GET PACKSLIP SEQ NBR'                         61930000
619400                                   TO DP013-MESSAGE-TEXT (1)      61940000
619500              MOVE DK-PO-NBR                                      61950000
619600                                   TO DP013-MESSAGE-TEXT (2)      61960000
619700              MOVE DK-OPER-UNT-ID                                 61970000
619800                                   TO DP013-MESSAGE-TEXT (3)      61980000
619900              MOVE DK-REC-SEQ-NBR                                 61990000
620000                                   TO DP013-MESSAGE-TEXT (4)      62000000
620100              MOVE SQLCA           TO DP013-SQLCA                 62010000
620200              MOVE 'TPKSLIP'   TO DP013-DB2-TABLE-NAME (1)        62020000
620300              SET DP013-DB2-ABEND  TO TRUE                        62030000
620400              PERFORM DP013-0000-PROCESS-ABEND                    62040000
620500     END-EVALUATE.                                                62050000
620600                                                                  62060000
620700*----------------------------------------------------------------*62070000
620800*    READ THE ITEMS FROM THE DATA BASE AND MOVE THEM INTO THE    *62080000
620900*    BLOCKS IN THE ARRAY.  WHENEVER BOTH BLOCKS BECOME FULL,     *62090000
621000*    WRITE OUT THE 1ST BLOCK TO TEMPORARY STORAGE, MOVE THE 2ND  *62100000
621100*    BLOCK IN THE ARRAY TO THE 1ST BLOCK, AND INITIALIZE THE     *62110000
621200*    2ND BLOCK MAKING IT AVAILABLE TO BE USED.                   *62120000
621300*                                                                *62130000
621400*    DUE TO THE SIZE OF THE TABLE, AND THE ORDER IN WHICH THE    *62140000
621500*    ROWS ARE SORTED, THE ENTIRE TABLE IS READ INTO THE PROGRAM  *62150000
621600*    UPON INITIALIZATION.                                        *62160000
621700*----------------------------------------------------------------*62170000
621800 4300-READ-ITEMS-FROM-DB.                                         62180000
621900     PERFORM                                                      62190000
622000         VARYING PV-READ-COUNT                                    62200000
622100         FROM 1 BY 1                                              62210000
622200         UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                    62220000
622300            OR (ASC-NO-ITEMS-LEFT-ON-DB))                         62230000
622400******************************************************************62240000
622500*ONLY FETCHES HERE                                                62250000
622600         EVALUATE TRUE                                            62260000
622700           WHEN ASC-FREE-ASTRAY-FORMAT                            62270000
622800           WHEN ASC-SUSPEND-VE-FORMAT                             62280000
622900              PERFORM 4270-FETCH-FREE-ASTRAY-CSR                  62290000
623000                                                                  62300000
623100           WHEN ASC-PKSLHDR-FORMAT                                62310000
623200              EVALUATE TRUE                                       62320000
623300                 WHEN ASC-TRAN-PREPK-CURSOR                       62330000
623400                    PERFORM 4215A-FETCH-TRAN-PREPK-CSR            62340000
623500                 WHEN ASC-NOT-TRAN-PREPK-CURSOR                   62350000
623600                    PERFORM 4215B-FETCH-NOT-TRAN-PREPK-CSR        62360000
623700                 WHEN ASC-PBS-CURSOR                              62370000
623800                    PERFORM 4215D-FETCH-PBS-CSR                   62380000
623900                 WHEN ASC-NON-PREPK-CURSOR                        62390000
624000                    PERFORM 4215C-FETCH-NON-PREPK-CSR             62400000
624100              END-EVALUATE                                        62410000
624200                                                                  62420000
624300           WHEN ASC-PKSLLNE-FORMAT                                62430000
624400              IF  ASC-DISPLAY-1-LINE                              62440000
624500                  PERFORM 4235-FETCH-PACKSLIP-LINE-CSR            62450000
624600              ELSE                                                62460000
624700                  PERFORM 4235A-FETCH-ALL-LINES-CSR               62470000
624800              END-IF                                              62480000
624900                                                                  62490000
625000           WHEN ASC-LIST-FORMAT                                   62500000
625100              IF PS-USE-SHIPT-CSR                                 62510000
625200                 IF  ASC-DISPLAY-1-LINE                           62520000
625300                     PERFORM 4330-FETCH-SHIPT-CURSOR              62530000
625400                 ELSE                                             62540000
625500                     PERFORM 4335-FETCH-SHIPT-ALL                 62550000
625600                 END-IF                                           62560000
625700              ELSE                                                62570000
625800                 IF  ASC-DISPLAY-1-LINE                           62580000
625900                     IF  PS-NO-PO                                 62590000
626000                         PERFORM 4310-FETCH-CARTON-CURSOR         62600000
626100                     ELSE                                         62610000
626200                         IF  ASC-PRE-PACK-ORDER                   62620000
626300                             PERFORM 4312-FETCH-CARTON-CURSOR     62630000
626400                         ELSE                                     62640000
626500                             PERFORM 4310-FETCH-CARTON-CURSOR     62650000
626600                         END-IF                                   62660000
626700                     END-IF                                       62670000
626800                 ELSE                                             62680000
626900                     IF  PS-NO-PO                                 62690000
627000                         PERFORM 4315-FETCH-CARTON-ALL            62700000
627100                     ELSE                                         62710000
627200                         IF  ASC-PRE-PACK-ORDER                   62720000
627300                             PERFORM 4317-FETCH-CARTON-ALL        62730000
627400                         ELSE                                     62740000
627500                             PERFORM 4315-FETCH-CARTON-ALL        62750000
627600                         END-IF                                   62760000
627700                     END-IF                                       62770000
627800                 END-IF                                           62780000
627900              END-IF                                              62790000
628000                                                                  62800000
628100* 03/21/2005 - DMH - BEGIN                                        62810000
628200       WHEN ASC-RCVG-SIMPLE-FORMAT                                62820000
628300              EVALUATE TRUE                                       62830000
628400                 WHEN ASC-PO-TRAN-PREPK-CURSOR                    62840000
628500                    PERFORM 4215E-FETCH-PO-TRAN-PREPK-CSR         62850000
628600                 WHEN ASC-PO-PBS-CURSOR                           62860000
628700                    PERFORM 4215H-FETCH-PO-PBS-CSR                62870000
628800                 WHEN ASC-PO-NON-PREPK-CURSOR                     62880000
628900                    PERFORM 4215G-FETCH-PO-NON-PREPK-CSR          62890000
629000              END-EVALUATE                                        62900000
629100* 03/21/2005 - DMH - END                                          62910000
629200                                                                  62920000
629300         END-EVALUATE                                             62930000
629400                                                                  62940000
629500****************************************************************  62950000
629600     IF  ASC-ITEMS-LEFT-ON-DB                                     62960000
629700         IF  ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                    62970000
629800             ADD +1            TO ASC-ITEM-SUB                    62980000
629900         ELSE                                                     62990000
630000             ADD +1            TO ASC-BLK-SUB                     63000000
630100             MOVE +1           TO ASC-ITEM-SUB                    63010000
630200                                                                  63020000
630300             IF  ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY             63030000
630400                 MOVE +1       TO ASC-BLK-SUB                     63040000
630500                 SET ASC-BLOCK-MODIFIED (1)                       63050000
630600                               TO TRUE                            63060000
630700                 PERFORM 5100-WRITE-TEMP-STORAGE                  63070000
630800                 MOVE ASC-BLOCK-ENTRIES                           63080000
630900                           (PC-MAX-BLOCKS-IN-ARRAY)               63090000
631000                            TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB)     63100000
631100                 ADD +1        TO ASC-BLK-SUB                     63110000
631200                 INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)       63120000
631300                 SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)          63130000
631400                               TO TRUE                            63140000
631500             END-IF                                               63150000
631600         END-IF                                                   63160000
631700         ADD +1                TO ASC-NUMBER-OF-ITEMS-READ        63170000
631800         MOVE ASC-NUMBER-OF-ITEMS-READ                            63180000
631900                               TO ASC-LIST-ITEM-NUMBER            63190000
632000                                  (ASC-BLK-SUB ASC-ITEM-SUB)      63200000
632100****************************************************************  63210000
632200*MOVES AND OTHER PERFORMS HERE                                    63220000
632300                                                                  63230000
632400         EVALUATE TRUE                                            63240000
632500           WHEN ASC-FREE-ASTRAY-FORMAT                            63250000
632600           WHEN ASC-SUSPEND-VE-FORMAT                             63260000
632700              MOVE SHPUNT-SHIPT-UNT-ID                            63270000
632800                                    TO SHUNLO-SHIPT-UNT-ID        63280000
632900                                       DK-SHIPT-UNT-ID            63290000
633000                                                                  63300000
633100              EVALUATE TRUE                                       63310000
633200                WHEN PV-UNION-TYPE = 'A'                          63320000
633300                  SET ASC-CHECKED-IN TO TRUE                      63330000
633400                  MOVE SHUNLO-TRIP-ID                             63340000
633500                                   TO ASC-LN-TRIP-ID              63350000
633600                                 (ASC-BLK-SUB ASC-ITEM-SUB)       63360000
633700                WHEN PV-UNION-TYPE = 'B'                          63370000
633800                  SET ASC-NOT-CHECKED-IN TO TRUE                  63380000
633900                  IF PKSLIP-REC-SEQ-NBR > 0                       63390000
634000                     MOVE PKSLIP-REC-SEQ-NBR TO DK-REC-SEQ-NBR    63400000
634100                     PERFORM 4290-GET-TRIP-INFO                   63410000
634200                  ELSE                                            63420000
634300                     CONTINUE                                     63430000
634400                  END-IF                                          63440000
634500                                                                  63450000
634600                  MOVE PV-ENROUTE-DISPLAY                         63460000
634700                                             TO WS-ENROUTE        63470000
634800                  IF VHTRIP-TRIP-ID > ZERO                        63480000
634900                     MOVE VHTRIP-TRIP-ID                          63490000
635000                                   TO ASC-LN-TRIP-ID              63500000
635100                                     (ASC-BLK-SUB ASC-ITEM-SUB)   63510000
635200                  ELSE                                            63520000
635300                     MOVE SPACES                                  63530000
635400                                   TO ASC-LN-TRIP-ID              63540000
635500                                     (ASC-BLK-SUB ASC-ITEM-SUB)   63550000
635600                  END-IF                                          63560000
635700              END-EVALUATE                                        63570000
635800                                                                  63580000
635900              IF DN-VEH-NBR = -1                                  63590000
636000                 MOVE SPACES TO VHTRIP-VEH-NBR                    63600000
636100              END-IF                                              63610000
636200                                                                  63620000
636300              IF ASC-PRE-PACK-ORDER                               63630000
636400                 PERFORM 4292A-GET-PREPACK-ID                     63640000
636500              ELSE                                                63650000
636600                 PERFORM 4293-GET-PO-LINE-NBR                     63660000
636700              END-IF                                              63670000
636800              IF ASC-PKGNG-CDE = SPACES                           63680000
636900                 PERFORM 4261-CHECK-PBS-ERR                       63690000
637000              ELSE                                                63700000
637100                 CONTINUE                                         63710000
637200              END-IF                                              63720000
637300                                                                  63730000
637400           WHEN ASC-PKSLHDR-FORMAT                                63740000
637500               MOVE SHPUNT-SHIPT-UNT-ID                           63750000
637600                                    TO SHUNLO-SHIPT-UNT-ID        63760000
637700                                       DK-SHIPT-UNT-ID            63770000
637800                                                                  63780000
637900               PERFORM 4280-CHECK-IF-CHECKED-IN                   63790000
638000               PERFORM 4261-CHECK-PBS-ERR                         63800000
638100               PERFORM 4262-CHECK-MISDIRECT-PBS                   63810000
638200                                                                  63820000
638300               IF  ASC-PRE-PACK-ORDER                             63830000
638400                   IF  PURITM-PO-PREPK-ID  >  0                   63840000
638500                       CONTINUE                                   63850000
638600                   ELSE                                           63860000
638700                       PERFORM 4292A-GET-PREPACK-ID               63870000
638800                   END-IF                                         63880000
638900               ELSE                                               63890000
639000                   PERFORM 4293-GET-PO-LINE-NBR                   63900000
639100               END-IF                                             63910000
639200                                                                  63920000
639300               IF PKSLIP-REC-SEQ-NBR > 0                          63930000
639400                  MOVE PKSLIP-REC-SEQ-NBR TO DK-REC-SEQ-NBR       63940000
639500               ELSE                                               63950000
639600                  CONTINUE                                        63960000
639700               END-IF                                             63970000
639800                                                                  63980000
639900               IF ASC-CHECKED-IN                                  63990000
640000                                                                  64000000
640100                  IF  SHUNLO-TRIP-ID  =  PV-PREVIOUS-TRIP         64010000
640200                      CONTINUE                                    64020000
640300                  ELSE                                            64030000
640400                      PERFORM 4340-GET-VEHICLE                    64040000
640500                      MOVE SHUNLO-TRIP-ID                         64050000
640600                        TO PV-PREVIOUS-TRIP                       64060000
640700                  END-IF                                          64070000
640800                  MOVE SHUNLO-TRIP-ID                             64080000
640900                                   TO ASC-LN-TRIP-ID              64090000
641000                                 (ASC-BLK-SUB ASC-ITEM-SUB)       64100000
641100               ELSE                                               64110000
641200                  MOVE PV-ENROUTE-DISPLAY                         64120000
641300                                          TO WS-ENROUTE           64130000
641400                  IF VHTRIP-TRIP-ID > ZERO                        64140000
641500                     MOVE VHTRIP-TRIP-ID                          64150000
641600                                   TO ASC-LN-TRIP-ID              64160000
641700                                     (ASC-BLK-SUB ASC-ITEM-SUB)   64170000
641800                                      PV-PREVIOUS-TRIP            64180000
641900                  ELSE                                            64190000
642000                     MOVE SPACES                                  64200000
642100                                   TO ASC-LN-TRIP-ID              64210000
642200                                     (ASC-BLK-SUB ASC-ITEM-SUB)   64220000
642300                  END-IF                                          64230000
642400               END-IF                                             64240000
642500                                                                  64250000
642600               IF PV-PBS-COUNT > 1                                64260000
642700                 SET PS-MULT-LINE     TO TRUE                     64270000
642800               ELSE                                               64280000
642900                 PERFORM 4293-GET-PO-LINE-NBR                     64290000
643000               END-IF                                             64300000
643100                                                                  64310000
643200           WHEN ASC-PKSLLNE-FORMAT                                64320000
643300              MOVE SHPUNT-SHIPT-UNT-ID                            64330000
643400                                    TO SHUNLO-SHIPT-UNT-ID        64340000
643500                                       DK-SHIPT-UNT-ID            64350000
643600              IF  ASC-DISPLAY-1-LINE                              64360000
643700                  IF ASC-PRE-PACK-ORDER                           64370000
643800                     IF ASC-RECEIVER > 0                          64380000
643900                        PERFORM 4292B-GET-PREPACK-ID              64390000
644000                     ELSE                                         64400000
644100                        PERFORM 4292C-GET-PREPACK-ID              64410000
644200                     END-IF                                       64420000
644300                  ELSE                                            64430000
644400                     PERFORM 4293-GET-PO-LINE-NBR                 64440000
644500                  END-IF                                          64450000
644600                  IF ASC-PKGNG-CDE = SPACES                       64460000
644700                     PERFORM 4261-CHECK-PBS-ERR                   64470000
644800                  ELSE                                            64480000
644900                     CONTINUE                                     64490000
645000                  END-IF                                          64500000
645100                                                                  64510000
645200                  EVALUATE TRUE                                   64520000
645300                    WHEN PV-UNION-TYPE = 'A'                      64530000
645400                      SET ASC-CHECKED-IN TO TRUE                  64540000
645500                      MOVE SHUNLO-TRIP-ID                         64550000
645600                                   TO ASC-LN-TRIP-ID              64560000
645700                                 (ASC-BLK-SUB ASC-ITEM-SUB)       64570000
645800                    WHEN PV-UNION-TYPE = 'B'                      64580000
645900                      SET ASC-NOT-CHECKED-IN TO TRUE              64590000
646000                      IF PKSLIP-REC-SEQ-NBR > 0                   64600000
646100                         MOVE PKSLIP-REC-SEQ-NBR                  64610000
646200                                        TO DK-REC-SEQ-NBR         64620000
646300                         PERFORM 4290-GET-TRIP-INFO               64630000
646400                      ELSE                                        64640000
646500                         CONTINUE                                 64650000
646600                      END-IF                                      64660000
646700                                                                  64670000
646800                      MOVE PV-ENROUTE-DISPLAY                     64680000
646900                                                 TO WS-ENROUTE    64690000
647000                      IF VHTRIP-TRIP-ID > ZERO                    64700000
647100                         MOVE VHTRIP-TRIP-ID                      64710000
647200                                   TO ASC-LN-TRIP-ID              64720000
647300                                     (ASC-BLK-SUB ASC-ITEM-SUB)   64730000
647400                      ELSE                                        64740000
647500                         MOVE SPACES                              64750000
647600                                   TO ASC-LN-TRIP-ID              64760000
647700                                     (ASC-BLK-SUB ASC-ITEM-SUB)   64770000
647800                      END-IF                                      64780000
647900                  END-EVALUATE                                    64790000
648000                                                                  64800000
648100                  IF DN-VEH-NBR = -1                              64810000
648200                     MOVE SPACES TO VHTRIP-VEH-NBR                64820000
648300                  END-IF                                          64830000
648400              ELSE                                                64840000
648500                  IF ASC-PRE-PACK-ORDER                           64850000
648600                     IF ASC-RECEIVER > 0                          64860000
648700                        PERFORM 4292A-GET-PREPACK-ID              64870000
648800                     ELSE                                         64880000
648900                        PERFORM 4292C-GET-PREPACK-ID              64890000
649000                     END-IF                                       64900000
649100                  ELSE                                            64910000
649200                     CONTINUE                                     64920000
649300                  END-IF                                          64930000
649400                  IF ASC-PKGNG-CDE = SPACES                       64940000
649500                     PERFORM 4261-CHECK-PBS-ERR                   64950000
649600                  ELSE                                            64960000
649700                     CONTINUE                                     64970000
649800                  END-IF                                          64980000
649900                                                                  64990000
650000                  EVALUATE TRUE                                   65000000
650100                    WHEN PV-UNION-TYPE = 'A'                      65010000
650200                      SET ASC-CHECKED-IN TO TRUE                  65020000
650300                      MOVE SHUNLO-TRIP-ID                         65030000
650400                                   TO ASC-LN-TRIP-ID              65040000
650500                                 (ASC-BLK-SUB ASC-ITEM-SUB)       65050000
650600                    WHEN PV-UNION-TYPE = 'B'                      65060000
650700                      SET ASC-NOT-CHECKED-IN TO TRUE              65070000
650800                      IF PKSLIP-REC-SEQ-NBR > 0                   65080000
650900                         MOVE PKSLIP-REC-SEQ-NBR                  65090000
651000                                        TO DK-REC-SEQ-NBR         65100000
651100                         PERFORM 4290-GET-TRIP-INFO               65110000
651200                      ELSE                                        65120000
651300                         CONTINUE                                 65130000
651400                      END-IF                                      65140000
651500                                                                  65150000
651600                      MOVE PV-ENROUTE-DISPLAY                     65160000
651700                                                 TO WS-ENROUTE    65170000
651800                      IF VHTRIP-TRIP-ID > ZERO                    65180000
651900                         MOVE VHTRIP-TRIP-ID                      65190000
652000                                   TO ASC-LN-TRIP-ID              65200000
652100                                     (ASC-BLK-SUB ASC-ITEM-SUB)   65210000
652200                      ELSE                                        65220000
652300                         MOVE SPACES                              65230000
652400                                   TO ASC-LN-TRIP-ID              65240000
652500                                     (ASC-BLK-SUB ASC-ITEM-SUB)   65250000
652600                      END-IF                                      65260000
652700                    END-EVALUATE                                  65270000
652800                                                                  65280000
652900                    IF DN-VEH-NBR = -1                            65290000
653000                       MOVE SPACES TO VHTRIP-VEH-NBR              65300000
653100                    END-IF                                        65310000
653200              END-IF                                              65320000
653300                                                                  65330000
653400           WHEN ASC-LIST-FORMAT                                   65340000
653500              MOVE INPKSU-SHIPT-UNT-ID TO DK-SHIPT-UNT-ID         65350000
653600              IF PS-USE-SHIPT-CSR                                 65360000
653700                 MOVE WS-SHUNLO-CRE-TMST-DATE  TO  PV-DTE         65370000
653800                 MOVE WS-SHUNLO-CRE-TMST-TIME  TO  PV-TME         65380000
653900                 MOVE PV-DTE      TO  ASC-LINE-DATE               65390000
654000                                     (ASC-BLK-SUB ASC-ITEM-SUB)   65400000
654100                 MOVE PV-TME      TO  ASC-LINE-TIME               65410000
654200                                     (ASC-BLK-SUB ASC-ITEM-SUB)   65420000
654300                 MOVE ASC-TRIP-ID                                 65430000
654400                               TO ASC-LN-TRIP-ID                  65440000
654500                                     (ASC-BLK-SUB ASC-ITEM-SUB)   65450000
654600              ELSE                                                65460000
654700                 MOVE SHUNLO-TRIP-ID                              65470000
654800                               TO ASC-LN-TRIP-ID                  65480000
654900                                     (ASC-BLK-SUB ASC-ITEM-SUB)   65490000
655000              END-IF                                              65500000
655100              PERFORM 4293-GET-PO-LINE-NBR                        65510000
655200                                                                  65520000
655300* 3/21/2005 - DMH - BEGIN                                         65530000
655400           WHEN ASC-RCVG-SIMPLE-FORMAT                            65540000
655500               MOVE SHPUNT-SHIPT-UNT-ID                           65550000
655600                                    TO SHUNLO-SHIPT-UNT-ID        65560000
655700                                       DK-SHIPT-UNT-ID            65570000
655800                                                                  65580000
655900               PERFORM 4280-CHECK-IF-CHECKED-IN                   65590000
656000               PERFORM 4261-CHECK-PBS-ERR                         65600000
656100               PERFORM 4262-CHECK-MISDIRECT-PBS                   65610000
656200                                                                  65620000
656300               IF  ASC-PRE-PACK-ORDER                             65630000
656400                   IF  PURITM-PO-PREPK-ID  >  0                   65640000
656500                       CONTINUE                                   65650000
656600                   ELSE                                           65660000
656700                       PERFORM 4292A-GET-PREPACK-ID               65670000
656800                   END-IF                                         65680000
656900               ELSE                                               65690000
657000                   PERFORM 4293-GET-PO-LINE-NBR                   65700000
657100               END-IF                                             65710000
657200                                                                  65720000
657300               IF PKSLIP-REC-SEQ-NBR > 0                          65730000
657400                  MOVE PKSLIP-REC-SEQ-NBR TO DK-REC-SEQ-NBR       65740000
657500               ELSE                                               65750000
657600                  CONTINUE                                        65760000
657700               END-IF                                             65770000
657800                                                                  65780000
657900               IF ASC-CHECKED-IN                                  65790000
658000                                                                  65800000
658100                  IF  SHUNLO-TRIP-ID  =  PV-PREVIOUS-TRIP         65810000
658200                      CONTINUE                                    65820000
658300                  ELSE                                            65830000
658400                      PERFORM 4340-GET-VEHICLE                    65840000
658500                      MOVE SHUNLO-TRIP-ID                         65850000
658600                        TO PV-PREVIOUS-TRIP                       65860000
658700                  END-IF                                          65870000
658800                  MOVE SHUNLO-TRIP-ID                             65880000
658900                                   TO ASC-LN-TRIP-ID              65890000
659000                                 (ASC-BLK-SUB ASC-ITEM-SUB)       65900000
659100               ELSE                                               65910000
659200                  MOVE PV-ENROUTE-DISPLAY                         65920000
659300                                          TO WS-ENROUTE           65930000
659400                  IF VHTRIP-TRIP-ID > ZERO                        65940000
659500                     MOVE VHTRIP-TRIP-ID                          65950000
659600                                   TO ASC-LN-TRIP-ID              65960000
659700                                     (ASC-BLK-SUB ASC-ITEM-SUB)   65970000
659800                                      PV-PREVIOUS-TRIP            65980000
659900                  ELSE                                            65990000
660000                     MOVE SPACES                                  66000000
660100                                   TO ASC-LN-TRIP-ID              66010000
660200                                     (ASC-BLK-SUB ASC-ITEM-SUB)   66020000
660300*LMM 3/30                                                         66030000
660400                                      ASC-SCAC-CDE                66040000
660500                                     (ASC-BLK-SUB ASC-ITEM-SUB)   66050000
660600                                      ASC-VEH-NBR                 66060000
660700                                     (ASC-BLK-SUB ASC-ITEM-SUB)   66070000
660800                     MOVE SPACES TO VHTRIP-OWNER-SCAC-ID          66080000
660900                                    VHTRIP-VEH-NBR                66090000
661000                  END-IF                                          66100000
661100               END-IF                                             66110000
661200                                                                  66120000
661300               IF PV-PBS-COUNT > 1                                66130000
661400                 SET PS-MULT-LINE     TO TRUE                     66140000
661500               ELSE                                               66150000
661600                 PERFORM 4293-GET-PO-LINE-NBR                     66160000
661700               END-IF                                             66170000
661800* 3/21/2005 - DMH - BEGIN                                         66180000
661900                                                                  66190000
662000         END-EVALUATE                                             66200000
662100                                                                  66210000
662200******************************************************************66220000
662300     MOVE RECITM-PREPK-ID  TO  DK-PREPK-ID                        66230000
662400******************************************************************66240000
662500     IF  DK-PO-NBR       =  PV-PREVIOUS-PO    AND                 66250000
662600         DK-REC-SEQ-NBR  =  PV-PREVIOUS-RCVR  AND                 66260000
662700       ((DK-LINE-NBR     =  PV-PREVIOUS-LINE  AND                 66270000
662800         NOT ASC-PRE-PACK-ORDER)              OR                  66280000
662900        (ASC-PRE-PACK-ORDER                   AND                 66290000
663000         DK-PREPK-ID     =  PV-PREVIOUS-PACK))                    66300000
663100         CONTINUE                                                 66310000
663200     ELSE                                                         66320000
663300         MOVE  ZEROES          TO PV-LINE-TABLE-ROWS              66330000
663400         PERFORM 4600-BUILD-LINE-TABLE                            66340000
663500         MOVE  DK-PO-NBR       TO  PV-PREVIOUS-PO                 66350000
663600         MOVE  DK-REC-SEQ-NBR  TO  PV-PREVIOUS-RCVR               66360000
663700         MOVE  DK-LINE-NBR     TO  PV-PREVIOUS-LINE               66370000
663800         MOVE  DK-PREPK-ID     TO  PV-PREVIOUS-PACK               66380000
663900     END-IF                                                       66390000
664000                                                                  66400000
664100     PERFORM 4250-OPEN-UPC-CSR                                    66410000
664200                                                                  66420000
664300     SET PS-NOT-EO-UPC-CSR TO TRUE                                66430000
664400                                                                  66440000
664500     PERFORM 4252-PROCESS-UPC-CSR                                 66450000
664600        UNTIL PS-EO-UPC-CSR                                       66460000
664700           OR ASC-ITEM-IND (ASC-BLK-SUB ASC-ITEM-SUB)  =  'N'     66470000
664800                                                                  66480000
664900     IF  PS-EO-UPC-CSR  AND                                       66490000
665000         ASC-PRE-PACK-ORDER                                       66500000
665100         PERFORM 4640-CHECK-RATIOS                                66510000
665200     END-IF                                                       66520000
665300                                                                  66530000
665400     PERFORM 4260-CLOSE-UPC-CSR                                   66540000
665500                                                                  66550000
665600******************************************************************66560000
665700          MOVE SPACES           TO ASC-ACTION                     66570000
665800                                  (ASC-BLK-SUB ASC-ITEM-SUB)      66580000
665900                                                                  66590000
666000          MOVE SHUNLO-SHIPT-UNT-ID                                66600000
666100                        TO  ASC-SERIAL-SHIP-CDE                   66610000
666200                                 (ASC-BLK-SUB ASC-ITEM-SUB)       66620000
666300                                                                  66630000
666400          MOVE SHPUNT-DEST-OPER-UNT-ID                            66640000
666500                        TO  ASC-STR-NBR                           66650000
666600                                 (ASC-BLK-SUB ASC-ITEM-SUB)       66660000
666700                                                                  66670000
666800          MOVE PV-UNION-TYPE                                      66680000
666900                                TO ASC-CSR-IND                    66690000
667000                                    (ASC-BLK-SUB ASC-ITEM-SUB)    66700000
667100******************************************************************66710000
667200              IF  ASC-PKSLLNE-FORMAT                              66720000
667300                 IF  ASC-DISPLAY-1-LINE                           66730000
667400                     MOVE ASC-LINE TO PV-LINE-NBR                 66740000
667500                 ELSE                                             66750000
667600                     MOVE SHUUPC-TRN-LNE-NBR TO PV-LINE-NBR       66760000
667700                 END-IF                                           66770000
667800                 IF  PS-MULT-LINE                                 66780000
667900                     SET  ASC-LINE-MULT                           66790000
668000                          (ASC-BLK-SUB ASC-ITEM-SUB)              66800000
668100                     TO TRUE                                      66810000
668200                 ELSE                                             66820000
668300                     MOVE PV-LINE-NBR                             66830000
668400                            TO ASC-LINE-NBR                       66840000
668500                                (ASC-BLK-SUB ASC-ITEM-SUB)        66850000
668600                 END-IF                                           66860000
668700              ELSE                                                66870000
668800                 IF  ASC-PRE-PACK-ORDER                           66880000
668900                     IF PS-MULT-PACK                              66890000
669000                        SET  ASC-LINE-MULT                        66900000
669100                             (ASC-BLK-SUB ASC-ITEM-SUB)           66910000
669200                        TO TRUE                                   66920000
669300                     ELSE                                         66930000
669400                        IF ASC-RECEIVER > 0                       66940000
669500                           MOVE RECITM-PREPK-ID                   66950000
669600                                         TO PV-LINE-NBR           66960000
669700                        ELSE                                      66970000
669800                           MOVE PURITM-PO-PREPK-ID                66980000
669900                                         TO PV-LINE-NBR           66990000
670000                        END-IF                                    67000000
670100                                                                  67010000
670200                        MOVE PV-LINE-NBR                          67020000
670300                                      TO ASC-LINE-NBR             67030000
670400                                       (ASC-BLK-SUB ASC-ITEM-SUB) 67040000
670500                     END-IF                                       67050000
670600                 ELSE                                             67060000
670700                     IF  PS-MULT-LINE                             67070000
670800                         SET  ASC-LINE-MULT                       67080000
670900                              (ASC-BLK-SUB ASC-ITEM-SUB)          67090000
671000                         TO TRUE                                  67100000
671100                     ELSE                                         67110000
671200                         MOVE SHUUPC-TRN-LNE-NBR                  67120000
671300                                         TO PV-LINE-NBR           67130000
671400                         MOVE PV-LINE-NBR                         67140000
671500                                      TO ASC-LINE-NBR             67150000
671600                                     (ASC-BLK-SUB ASC-ITEM-SUB)   67160000
671700                     END-IF                                       67170000
671800                 END-IF                                           67180000
671900              END-IF                                              67190000
672000                                                                  67200000
672100******************************************************************67210000
672200              IF DN-VEH-NBR = -1                                  67220000
672300                 MOVE SPACES TO ASC-VEH-NBR                       67230000
672400                                    (ASC-BLK-SUB ASC-ITEM-SUB)    67240000
672500              ELSE                                                67250000
672600                 MOVE VHTRIP-VEH-NBR    TO ASC-VEH-NBR            67260000
672700                                    (ASC-BLK-SUB ASC-ITEM-SUB)    67270000
672800              END-IF                                              67280000
672900                                                                  67290000
673000              MOVE VHTRIP-OWNER-SCAC-ID TO ASC-SCAC-CDE           67300000
673100                                    (ASC-BLK-SUB ASC-ITEM-SUB)    67310000
673200                                                                  67320000
673300******************************************************************67330000
673400              EVALUATE TRUE                                       67340000
673500                WHEN ASC-CHECKED-IN                               67350000
673600                   MOVE WS-SHUNLO-CRE-TMST-DATE  TO  PV-DTE       67360000
673700                   MOVE WS-SHUNLO-CRE-TMST-TIME  TO  PV-TME       67370000
673800                   MOVE PV-DTE      TO  ASC-LINE-DATE             67380000
673900                                      (ASC-BLK-SUB ASC-ITEM-SUB)  67390000
674000                   MOVE PV-TME      TO  ASC-LINE-TIME             67400000
674100                                      (ASC-BLK-SUB ASC-ITEM-SUB)  67410000
674200                WHEN ASC-NOT-CHECKED-IN                           67420000
674300                   MOVE WS-ENROUTE  TO  ASC-LINE-DATE             67430000
674400                                      (ASC-BLK-SUB ASC-ITEM-SUB)  67440000
674500                   MOVE SPACES      TO  ASC-LINE-TIME             67450000
674600                                      (ASC-BLK-SUB ASC-ITEM-SUB)  67460000
674700              END-EVALUATE                                        67470000
674800*IF NOT ON TSHUNLO DON'T PERFORM - STATUS CURSOR USES SHUNLO      67480000
674900        IF ASC-CHECKED-IN                                         67490000
675000              PERFORM 4350-GET-UCC128-STATUS                      67500000
675100        END-IF                                                    67510000
675200     END-IF                                                       67520000
675300     END-PERFORM.                                                 67530000
675400                                                                  67540000
675500******************************************************************67550000
675600     IF  ASC-NUMBER-OF-ITEMS-READ > ZERO                          67560000
675700         MOVE +1                   TO ASC-BLK-SUB                 67570000
675800         PERFORM 5100-WRITE-TEMP-STORAGE                          67580000
675900         ADD +1                    TO ASC-BLK-SUB                 67590000
676000         PERFORM 5100-WRITE-TEMP-STORAGE                          67600000
676100                                                                  67610000
676200         MOVE 1                    TO ASC-BLK-SUB                 67620000
676300                                      PV-BLOCK-NUMBER             67630000
676400         PERFORM 4410-READ-TEMP-STORAGE                           67640000
676500         IF  ASC-HIGHEST-BLOCK-WRITTEN GREATER THAN 1             67650000
676600             MOVE 2                TO ASC-BLK-SUB                 67660000
676700                                      PV-BLOCK-NUMBER             67670000
676800             PERFORM 4410-READ-TEMP-STORAGE                       67680000
676900         END-IF                                                   67690000
677000     END-IF.                                                      67700000
677100*                                                                 67710000
677200*                                                                 67720000
677300*----------------------------------------------------------------*67730000
677400*    FETCH CARTON CURSOR.               **** ONE LINE ONLY ****  *67740000
677500*----------------------------------------------------------------*67750000
677600 4310-FETCH-CARTON-CURSOR.                                        67760000
677700              EXEC SQL                                            67770000
677800                   FETCH CARTON-CSR                               67780000
677900                    INTO :PV-UNION-TYPE                           67790000
678000                        ,:SHUNLO-TRIP-ID                          67800000
678100                        ,:SHPTPO-PO-NBR                           67810000
678200                        ,:SHPTPO-REC-SEQ-NBR                      67820000
678300                        ,:PKSLIP-SEQ-NBR                          67830000
678400                        ,:INPKSU-SHIPT-UNT-ID                     67840000
678500                        ,:SHPUNT-DEST-OPER-UNT-ID                 67850000
678600                        ,:SHPUNT-SHIPT-UNT-SRC-ID                 67860000
678700                        ,:SHUNLO-CRE-TMST                         67870000
678800                        ,:WS-SHUNLO-CRE-TMST-DATE                 67880000
678900                        ,:WS-SHUNLO-CRE-TMST-TIME                 67890000
679000                        ,:SHUUPC-TRN-LNE-NBR                      67900000
679100              END-EXEC                                            67910000
679200                                                                  67920000
679300     EVALUATE TRUE                                                67930000
679400         WHEN SQLCODE = ZERO                                      67940000
679500              EVALUATE TRUE                                       67950000
679600                WHEN PV-UNION-TYPE = 'A'                          67960000
679700                      SET ASC-CHECKED-IN TO TRUE                  67970000
679800                      MOVE WS-SHUNLO-CRE-TMST TO PV-TMST-R        67980000
679900                      MOVE PV-TMST-CC         TO PV-DISPLAY-CC    67990000
680000                      MOVE PV-TMST-YY         TO PV-DISPLAY-YY    68000000
680100                      MOVE PC-SLASH           TO PV-SLASH-1       68010000
680200                      MOVE PV-TMST-MM         TO PV-DISPLAY-MM    68020000
680300                      MOVE PC-SLASH           TO PV-SLASH-2       68030000
680400                      MOVE PV-TMST-DD         TO PV-DISPLAY-DD    68040000
680500                      MOVE PV-TMST-HRS        TO PV-DISPLAY-HRS   68050000
680600                      MOVE PC-COLON           TO PV-COLON         68060000
680700                      MOVE PV-TMST-MIN        TO PV-DISPLAY-MIN   68070000
680800                                                                  68080000
680900                      MOVE PV-DATE-TIME-DISPLAY                   68090000
681000                                       TO  WS-SHUNLO-CRE-TMST     68100000
681100                WHEN PV-UNION-TYPE = 'B'                          68110000
681200                      SET ASC-NOT-CHECKED-IN TO TRUE              68120000
681300                      MOVE PV-ENROUTE-DISPLAY                     68130000
681400                                       TO  WS-ENROUTE             68140000
681500              END-EVALUATE                                        68150000
681600                                                                  68160000
681700              MOVE INPKSU-SHIPT-UNT-ID                            68170000
681800                                    TO SHUNLO-SHIPT-UNT-ID        68180000
681900              IF  SHUNLO-TRIP-ID  =  PV-PREVIOUS-TRIP             68190000
682000                  CONTINUE                                        68200000
682100              ELSE                                                68210000
682200                  PERFORM 4340-GET-VEHICLE                        68220000
682300                  MOVE SHUNLO-TRIP-ID  TO  PV-PREVIOUS-TRIP       68230000
682400              END-IF                                              68240000
682500         WHEN SQLCODE = +100                                      68250000
682600              IF PS-CARTON-CSR-FIRST                              68260000
682700                 IF  ASC-DISPLAY-1-LINE                           68270000
682800                     PERFORM 4030-OPEN-SHIPT-CURSOR               68280000
682900                     PERFORM 4330-FETCH-SHIPT-CURSOR              68290000
683000                 ELSE                                             68300000
683100                     PERFORM 4035-OPEN-SHIPT-ALL                  68310000
683200                     PERFORM 4335-FETCH-SHIPT-ALL                 68320000
683300                 END-IF                                           68330000
683400                 IF  PS-EO-SHIPT-CSR                              68340000
683500                     IF  ASC-DISPLAY-1-LINE                       68350000
683600                         PERFORM 4040-CLOSE-SHIPT-CURSOR          68360000
683700                     ELSE                                         68370000
683800                         PERFORM 4045-CLOSE-SHIPT-ALL             68380000
683900                     END-IF                                       68390000
684000                     SET ASC-NO-ITEMS-LEFT-ON-DB TO TRUE          68400000
684100                     SET PS-EO-CARTON-CSR TO TRUE                 68410000
684200                 ELSE                                             68420000
684300                     SET PS-USE-SHIPT-CSR TO TRUE                 68430000
684400                 END-IF                                           68440000
684500              ELSE                                                68450000
684600                 SET ASC-NO-ITEMS-LEFT-ON-DB TO TRUE              68460000
684700                 SET PS-EO-CARTON-CSR TO TRUE                     68470000
684800              END-IF                                              68480000
684900                                                                  68490000
685000         WHEN SQLWARN0 NOT = SPACES                               68500000
685100         WHEN SQLCODE NOT = ZERO                                  68510000
685200              MOVE '4310-FETCH-CARTON-CURSOR'                     68520000
685300                                   TO DP013-PARAGRAPH             68530000
685400              MOVE 'FETCH CARTON CURSOR'                          68540000
685500                                   TO DP013-MESSAGE-TEXT (1)      68550000
685600              MOVE SQLCA           TO DP013-SQLCA                 68560000
685700              MOVE 'TSHUNLO'   TO DP013-DB2-TABLE-NAME (1)        68570000
685800              SET DP013-DB2-ABEND  TO TRUE                        68580000
685900              PERFORM DP013-0000-PROCESS-ABEND                    68590000
686000     END-EVALUATE.                                                68600000
686100*                                                                 68610000
686200     IF PS-CARTON-CSR-FIRST                                       68620000
686300         SET PS-NOT-CARTON-CSR-FIRST TO TRUE                      68630000
686400     END-IF.                                                      68640000
686500                                                                  68650000
686600*----------------------------------------------------------------*68660000
686700*    FETCH CARTON CURSOR.               **** ONE LINE ONLY ****  *68670000
686800*----------------------------------------------------------------*68680000
686900 4312-FETCH-CARTON-CURSOR.                                        68690000
687000              EXEC SQL                                            68700000
687100                   FETCH CARTON-PACK-CSR                          68710000
687200                    INTO :PV-UNION-TYPE                           68720000
687300                        ,:SHUNLO-TRIP-ID                          68730000
687400                        ,:SHPTPO-PO-NBR                           68740000
687500                        ,:SHPTPO-REC-SEQ-NBR                      68750000
687600                        ,:PKSLIP-SEQ-NBR                          68760000
687700                        ,:INPKSU-SHIPT-UNT-ID                     68770000
687800                        ,:SHPUNT-DEST-OPER-UNT-ID                 68780000
687900                        ,:SHPUNT-SHIPT-UNT-SRC-ID                 68790000
688000                        ,:SHUNLO-CRE-TMST                         68800000
688100                        ,:WS-SHUNLO-CRE-TMST-DATE                 68810000
688200                        ,:WS-SHUNLO-CRE-TMST-TIME                 68820000
688300                        ,:RECITM-PREPK-ID                         68830000
688400              END-EXEC                                            68840000
688500                                                                  68850000
688600     EVALUATE TRUE                                                68860000
688700         WHEN SQLCODE = ZERO                                      68870000
688800              EVALUATE TRUE                                       68880000
688900                WHEN PV-UNION-TYPE = 'A'                          68890000
689000                      SET ASC-CHECKED-IN TO TRUE                  68900000
689100                      MOVE WS-SHUNLO-CRE-TMST TO PV-TMST-R        68910000
689200                      MOVE PV-TMST-CC         TO PV-DISPLAY-CC    68920000
689300                      MOVE PV-TMST-YY         TO PV-DISPLAY-YY    68930000
689400                      MOVE PC-SLASH           TO PV-SLASH-1       68940000
689500                      MOVE PV-TMST-MM         TO PV-DISPLAY-MM    68950000
689600                      MOVE PC-SLASH           TO PV-SLASH-2       68960000
689700                      MOVE PV-TMST-DD         TO PV-DISPLAY-DD    68970000
689800                      MOVE PV-TMST-HRS        TO PV-DISPLAY-HRS   68980000
689900                      MOVE PC-COLON           TO PV-COLON         68990000
690000                      MOVE PV-TMST-MIN        TO PV-DISPLAY-MIN   69000000
690100                                                                  69010000
690200                      MOVE PV-DATE-TIME-DISPLAY                   69020000
690300                                       TO  WS-SHUNLO-CRE-TMST     69030000
690400                WHEN PV-UNION-TYPE = 'B'                          69040000
690500                      SET ASC-NOT-CHECKED-IN TO TRUE              69050000
690600                      MOVE PV-ENROUTE-DISPLAY                     69060000
690700                                       TO  WS-ENROUTE             69070000
690800              END-EVALUATE                                        69080000
690900                                                                  69090000
691000              MOVE INPKSU-SHIPT-UNT-ID                            69100000
691100                                    TO SHUNLO-SHIPT-UNT-ID        69110000
691200              IF  SHUNLO-TRIP-ID  =  PV-PREVIOUS-TRIP             69120000
691300                  CONTINUE                                        69130000
691400              ELSE                                                69140000
691500                  PERFORM 4340-GET-VEHICLE                        69150000
691600                  MOVE SHUNLO-TRIP-ID  TO  PV-PREVIOUS-TRIP       69160000
691700              END-IF                                              69170000
691800         WHEN SQLCODE = +100                                      69180000
691900              IF PS-CARTON-CSR-FIRST                              69190000
692000                 IF  ASC-DISPLAY-1-LINE                           69200000
692100                     PERFORM 4030-OPEN-SHIPT-CURSOR               69210000
692200                     PERFORM 4330-FETCH-SHIPT-CURSOR              69220000
692300                 ELSE                                             69230000
692400                     PERFORM 4035-OPEN-SHIPT-ALL                  69240000
692500                     PERFORM 4335-FETCH-SHIPT-ALL                 69250000
692600                 END-IF                                           69260000
692700                 IF  PS-EO-SHIPT-CSR                              69270000
692800                     IF  ASC-DISPLAY-1-LINE                       69280000
692900                         PERFORM 4040-CLOSE-SHIPT-CURSOR          69290000
693000                     ELSE                                         69300000
693100                         PERFORM 4045-CLOSE-SHIPT-ALL             69310000
693200                     END-IF                                       69320000
693300                     SET ASC-NO-ITEMS-LEFT-ON-DB TO TRUE          69330000
693400                     SET PS-EO-CARTON-CSR TO TRUE                 69340000
693500                 ELSE                                             69350000
693600                     SET PS-USE-SHIPT-CSR TO TRUE                 69360000
693700                 END-IF                                           69370000
693800              ELSE                                                69380000
693900                 SET ASC-NO-ITEMS-LEFT-ON-DB TO TRUE              69390000
694000                 SET PS-EO-CARTON-CSR TO TRUE                     69400000
694100              END-IF                                              69410000
694200                                                                  69420000
694300         WHEN SQLWARN0 NOT = SPACES                               69430000
694400         WHEN SQLCODE NOT = ZERO                                  69440000
694500              MOVE '4312-FETCH-CARTON-CURSOR'                     69450000
694600                                   TO DP013-PARAGRAPH             69460000
694700              MOVE 'FETCH CARTON CURSOR'                          69470000
694800                                   TO DP013-MESSAGE-TEXT (1)      69480000
694900              MOVE SQLCA           TO DP013-SQLCA                 69490000
695000              MOVE 'TSHUNLO'   TO DP013-DB2-TABLE-NAME (1)        69500000
695100              SET DP013-DB2-ABEND  TO TRUE                        69510000
695200              PERFORM DP013-0000-PROCESS-ABEND                    69520000
695300     END-EVALUATE.                                                69530000
695400*                                                                 69540000
695500     IF PS-CARTON-CSR-FIRST                                       69550000
695600         SET PS-NOT-CARTON-CSR-FIRST TO TRUE                      69560000
695700     END-IF.                                                      69570000
695800                                                                  69580000
695900                                                                  69590000
696000*----------------------------------------------------------------*69600000
696100*    FETCH CARTON CURSOR.               **** ALL LINES ****      *69610000
696200*----------------------------------------------------------------*69620000
696300 4315-FETCH-CARTON-ALL.                                           69630000
696400              EXEC SQL                                            69640000
696500                   FETCH ALL-CARTON-CSR                           69650000
696600                    INTO :PV-UNION-TYPE                           69660000
696700                        ,:SHUNLO-TRIP-ID                          69670000
696800                        ,:SHPTPO-PO-NBR                           69680000
696900                        ,:SHPTPO-REC-SEQ-NBR                      69690000
697000                        ,:PKSLIP-SEQ-NBR                          69700000
697100                        ,:INPKSU-SHIPT-UNT-ID                     69710000
697200                        ,:SHPUNT-DEST-OPER-UNT-ID                 69720000
697300                        ,:SHPUNT-SHIPT-UNT-SRC-ID                 69730000
697400                        ,:SHUNLO-CRE-TMST                         69740000
697500                        ,:WS-SHUNLO-CRE-TMST-DATE                 69750000
697600                        ,:WS-SHUNLO-CRE-TMST-TIME                 69760000
697700                        ,:SHUUPC-TRN-LNE-NBR                      69770000
697800              END-EXEC                                            69780000
697900                                                                  69790000
698000     EVALUATE TRUE                                                69800000
698100         WHEN SQLCODE = ZERO                                      69810000
698200              EVALUATE TRUE                                       69820000
698300                WHEN PV-UNION-TYPE = 'A'                          69830000
698400                      SET ASC-CHECKED-IN TO TRUE                  69840000
698500                      MOVE WS-SHUNLO-CRE-TMST TO PV-TMST-R        69850000
698600                      MOVE PV-TMST-CC         TO PV-DISPLAY-CC    69860000
698700                      MOVE PV-TMST-YY         TO PV-DISPLAY-YY    69870000
698800                      MOVE PC-SLASH           TO PV-SLASH-1       69880000
698900                      MOVE PV-TMST-MM         TO PV-DISPLAY-MM    69890000
699000                      MOVE PC-SLASH           TO PV-SLASH-2       69900000
699100                      MOVE PV-TMST-DD         TO PV-DISPLAY-DD    69910000
699200                      MOVE PV-TMST-HRS        TO PV-DISPLAY-HRS   69920000
699300                      MOVE PC-COLON           TO PV-COLON         69930000
699400                      MOVE PV-TMST-MIN        TO PV-DISPLAY-MIN   69940000
699500                                                                  69950000
699600                      MOVE PV-DATE-TIME-DISPLAY                   69960000
699700                                       TO  WS-SHUNLO-CRE-TMST     69970000
699800                WHEN PV-UNION-TYPE = 'B'                          69980000
699900                      SET ASC-NOT-CHECKED-IN TO TRUE              69990000
700000                      MOVE PV-ENROUTE-DISPLAY                     70000000
700100                                       TO  WS-ENROUTE             70010000
700200              END-EVALUATE                                        70020000
700300                                                                  70030000
700400              MOVE INPKSU-SHIPT-UNT-ID                            70040000
700500                                    TO SHUNLO-SHIPT-UNT-ID        70050000
700600              IF  SHUNLO-TRIP-ID  =  PV-PREVIOUS-TRIP             70060000
700700                  CONTINUE                                        70070000
700800              ELSE                                                70080000
700900                  PERFORM 4340-GET-VEHICLE                        70090000
701000                  MOVE SHUNLO-TRIP-ID  TO  PV-PREVIOUS-TRIP       70100000
701100              END-IF                                              70110000
701200         WHEN SQLCODE = +100                                      70120000
701300              IF  PS-CARTON-CSR-FIRST                             70130000
701400                  IF  ASC-DISPLAY-1-LINE                          70140000
701500                      PERFORM 4030-OPEN-SHIPT-CURSOR              70150000
701600                      PERFORM 4330-FETCH-SHIPT-CURSOR             70160000
701700                  ELSE                                            70170000
701800                      PERFORM 4035-OPEN-SHIPT-ALL                 70180000
701900                      PERFORM 4335-FETCH-SHIPT-ALL                70190000
702000                  END-IF                                          70200000
702100                  IF  PS-EO-SHIPT-CSR                             70210000
702200                      IF  ASC-DISPLAY-1-LINE                      70220000
702300                          PERFORM 4040-CLOSE-SHIPT-CURSOR         70230000
702400                      ELSE                                        70240000
702500                          PERFORM 4045-CLOSE-SHIPT-ALL            70250000
702600                      END-IF                                      70260000
702700                      SET ASC-NO-ITEMS-LEFT-ON-DB TO TRUE         70270000
702800                      SET PS-EO-CARTON-CSR TO TRUE                70280000
702900                 ELSE                                             70290000
703000                    SET PS-USE-SHIPT-CSR TO TRUE                  70300000
703100                 END-IF                                           70310000
703200              ELSE                                                70320000
703300                 SET ASC-NO-ITEMS-LEFT-ON-DB TO TRUE              70330000
703400                 SET PS-EO-CARTON-CSR TO TRUE                     70340000
703500              END-IF                                              70350000
703600                                                                  70360000
703700         WHEN SQLWARN0 NOT = SPACES                               70370000
703800         WHEN SQLCODE NOT = ZERO                                  70380000
703900              MOVE '4315-FETCH-CARTON-ALL   '                     70390000
704000                                   TO DP013-PARAGRAPH             70400000
704100              MOVE 'FETCH CARTON CURSOR-ALL LINES'                70410000
704200                                   TO DP013-MESSAGE-TEXT (1)      70420000
704300              MOVE SQLCA           TO DP013-SQLCA                 70430000
704400              MOVE 'TSHUNLO'   TO DP013-DB2-TABLE-NAME (1)        70440000
704500              SET DP013-DB2-ABEND  TO TRUE                        70450000
704600              PERFORM DP013-0000-PROCESS-ABEND                    70460000
704700     END-EVALUATE.                                                70470000
704800*                                                                 70480000
704900     IF PS-CARTON-CSR-FIRST                                       70490000
705000         SET PS-NOT-CARTON-CSR-FIRST TO TRUE                      70500000
705100     END-IF.                                                      70510000
705200*                                                                 70520000
705300*----------------------------------------------------------------*70530000
705400*    FETCH CARTON CURSOR.               **** ALL LINES ****      *70540000
705500*----------------------------------------------------------------*70550000
705600 4317-FETCH-CARTON-ALL.                                           70560000
705700              EXEC SQL                                            70570000
705800                   FETCH ALL-CTN-PACK-CSR                         70580000
705900                    INTO :PV-UNION-TYPE                           70590000
706000                        ,:SHUNLO-TRIP-ID                          70600000
706100                        ,:SHPTPO-PO-NBR                           70610000
706200                        ,:SHPTPO-REC-SEQ-NBR                      70620000
706300                        ,:PKSLIP-SEQ-NBR                          70630000
706400                        ,:INPKSU-SHIPT-UNT-ID                     70640000
706500                        ,:SHPUNT-DEST-OPER-UNT-ID                 70650000
706600                        ,:SHPUNT-SHIPT-UNT-SRC-ID                 70660000
706700                        ,:SHUNLO-CRE-TMST                         70670000
706800                        ,:WS-SHUNLO-CRE-TMST-DATE                 70680000
706900                        ,:WS-SHUNLO-CRE-TMST-TIME                 70690000
707000                        ,:RECITM-PREPK-ID                         70700000
707100              END-EXEC                                            70710000
707200                                                                  70720000
707300     EVALUATE TRUE                                                70730000
707400         WHEN SQLCODE = ZERO                                      70740000
707500              EVALUATE TRUE                                       70750000
707600                WHEN PV-UNION-TYPE = 'A'                          70760000
707700                      SET ASC-CHECKED-IN TO TRUE                  70770000
707800                      MOVE WS-SHUNLO-CRE-TMST TO PV-TMST-R        70780000
707900                      MOVE PV-TMST-CC         TO PV-DISPLAY-CC    70790000
708000                      MOVE PV-TMST-YY         TO PV-DISPLAY-YY    70800000
708100                      MOVE PC-SLASH           TO PV-SLASH-1       70810000
708200                      MOVE PV-TMST-MM         TO PV-DISPLAY-MM    70820000
708300                      MOVE PC-SLASH           TO PV-SLASH-2       70830000
708400                      MOVE PV-TMST-DD         TO PV-DISPLAY-DD    70840000
708500                      MOVE PV-TMST-HRS        TO PV-DISPLAY-HRS   70850000
708600                      MOVE PC-COLON           TO PV-COLON         70860000
708700                      MOVE PV-TMST-MIN        TO PV-DISPLAY-MIN   70870000
708800                                                                  70880000
708900                      MOVE PV-DATE-TIME-DISPLAY                   70890000
709000                                       TO  WS-SHUNLO-CRE-TMST     70900000
709100                WHEN PV-UNION-TYPE = 'B'                          70910000
709200                      SET ASC-NOT-CHECKED-IN TO TRUE              70920000
709300                      MOVE PV-ENROUTE-DISPLAY                     70930000
709400                                       TO  WS-ENROUTE             70940000
709500              END-EVALUATE                                        70950000
709600                                                                  70960000
709700              MOVE INPKSU-SHIPT-UNT-ID                            70970000
709800                                    TO SHUNLO-SHIPT-UNT-ID        70980000
709900              IF  SHUNLO-TRIP-ID  =  PV-PREVIOUS-TRIP             70990000
710000                  CONTINUE                                        71000000
710100              ELSE                                                71010000
710200                  PERFORM 4340-GET-VEHICLE                        71020000
710300                  MOVE SHUNLO-TRIP-ID  TO  PV-PREVIOUS-TRIP       71030000
710400              END-IF                                              71040000
710500         WHEN SQLCODE = +100                                      71050000
710600              IF  PS-CARTON-CSR-FIRST                             71060000
710700                  IF  ASC-DISPLAY-1-LINE                          71070000
710800                      PERFORM 4030-OPEN-SHIPT-CURSOR              71080000
710900                      PERFORM 4330-FETCH-SHIPT-CURSOR             71090000
711000                  ELSE                                            71100000
711100                      PERFORM 4035-OPEN-SHIPT-ALL                 71110000
711200                      PERFORM 4335-FETCH-SHIPT-ALL                71120000
711300                  END-IF                                          71130000
711400                  IF  PS-EO-SHIPT-CSR                             71140000
711500                      IF  ASC-DISPLAY-1-LINE                      71150000
711600                          PERFORM 4040-CLOSE-SHIPT-CURSOR         71160000
711700                      ELSE                                        71170000
711800                          PERFORM 4045-CLOSE-SHIPT-ALL            71180000
711900                      END-IF                                      71190000
712000                      SET ASC-NO-ITEMS-LEFT-ON-DB TO TRUE         71200000
712100                      SET PS-EO-CARTON-CSR TO TRUE                71210000
712200                 ELSE                                             71220000
712300                    SET PS-USE-SHIPT-CSR TO TRUE                  71230000
712400                 END-IF                                           71240000
712500              ELSE                                                71250000
712600                 SET ASC-NO-ITEMS-LEFT-ON-DB TO TRUE              71260000
712700                 SET PS-EO-CARTON-CSR TO TRUE                     71270000
712800              END-IF                                              71280000
712900                                                                  71290000
713000         WHEN SQLWARN0 NOT = SPACES                               71300000
713100         WHEN SQLCODE NOT = ZERO                                  71310000
713200              MOVE '4317-FETCH-CARTON-ALL   '                     71320000
713300                                   TO DP013-PARAGRAPH             71330000
713400              MOVE 'FETCH CARTON CURSOR-ALL LINES'                71340000
713500                                   TO DP013-MESSAGE-TEXT (1)      71350000
713600              MOVE SQLCA           TO DP013-SQLCA                 71360000
713700              MOVE 'TSHUNLO'   TO DP013-DB2-TABLE-NAME (1)        71370000
713800              SET DP013-DB2-ABEND  TO TRUE                        71380000
713900              PERFORM DP013-0000-PROCESS-ABEND                    71390000
714000     END-EVALUATE.                                                71400000
714100*                                                                 71410000
714200     IF PS-CARTON-CSR-FIRST                                       71420000
714300         SET PS-NOT-CARTON-CSR-FIRST TO TRUE                      71430000
714400     END-IF.                                                      71440000
714500*                                                                 71450000
714600*                                                                 71460000
714700*----------------------------------------------------------------*71470000
714800* GET THE VENDOR NAME.                                           *71480000
714900*----------------------------------------------------------------*71490000
715000 4320-GET-VENDOR-NAME.                                            71500000
715100     PERFORM                                                      71510000
715200         WITH TEST AFTER                                          71520000
715300         VARYING PV-RETRY-COUNTER                                 71530000
715400         FROM 1 BY 1                                              71540000
715500         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               71550000
715600             OR (SQLCODE = +0)                                    71560000
715700             OR (SQLCODE = +100)                                  71570000
715800             OR (SQLCODE = -305))                                 71580000
715900                                                                  71590000
716000         EXEC SQL                                                 71600000
716100              SELECT B.ENT_NAME_DESC                              71610000
716200                INTO :ENTNME-ENT-NAME-DESC                        71620000
716300              FROM   TPURCHS A                                    71630000
716400                    ,TENTNME B                                    71640000
716500              WHERE A.PO_NBR         = :DK-PO-NBR                 71650000
716600                AND A.VER_STATUS_CDE = 'A'                        71660000
716700                AND B.TYPE_CDE       = '01'                       71670000
716800                AND A.ENT_ID         = B.ENT_ID                   71680000
716900         END-EXEC                                                 71690000
717000                                                                  71700000
717100         EVALUATE TRUE                                            71710000
717200             WHEN SQLCODE = +0                                    71720000
717300                  MOVE ENTNME-ENT-NAME-DESC                       71730000
717400                                  TO ASC-ENT-NAME-DESC            71740000
717500             WHEN SQLCODE = +100                                  71750000
717600                  MOVE 'PO NOT FOUND'                             71760000
717700                                  TO ASC-ENT-NAME-DESC            71770000
717800                                     ENTNME-ENT-NAME-DESC         71780000
717900             WHEN SQLCODE = -904                                  71790000
718000             WHEN SQLCODE = -913                                  71800000
718100                  CONTINUE                                        71810000
718200             WHEN SQLWARN0 NOT = SPACES                           71820000
718300             WHEN SQLCODE < +0                                    71830000
718400             WHEN SQLCODE > +0                                    71840000
718500                  MOVE '4320-GET-VENDOR-NAME'                     71850000
718600                                  TO DP013-PARAGRAPH              71860000
718700                  MOVE 'UNSUCCESSFUL SELECT ON TENTNME'           71870000
718800                                  TO DP013-MESSAGE-TEXT (1)       71880000
718900                  MOVE SQLCA      TO DP013-SQLCA                  71890000
719000                  MOVE 'TPURCHS ' TO DP013-DB2-TABLE-NAME (1)     71900000
719100                  MOVE 'TENTNME ' TO DP013-DB2-TABLE-NAME (2)     71910000
719200                  SET DP013-DB2-ABEND                             71920000
719300                      DP013-XCTL-DISPLAY-RESTART                  71930000
719400                                  TO TRUE                         71940000
719500                  PERFORM DP013-0000-PROCESS-ABEND                71950000
719600         END-EVALUATE                                             71960000
719700     END-PERFORM.                                                 71970000
719800                                                                  71980000
719900     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    71990000
720000         SQLCODE NOT = +0                                         72000000
720100         MOVE '4320-GET-VENDOR-NAME'                              72010000
720200                                  TO DP013-PARAGRAPH              72020000
720300         MOVE 'MAX RETRIES EXCEEDED ON SELECT TENTNME'            72030000
720400                                  TO DP013-MESSAGE-TEXT (1)       72040000
720500         MOVE SQLCA               TO DP013-SQLCA                  72050000
720600         MOVE 'TPURCHS '          TO DP013-DB2-TABLE-NAME (1)     72060000
720700         MOVE 'TENTNME '          TO DP013-DB2-TABLE-NAME (2)     72070000
720800         SET DP013-DB2-ABEND                                      72080000
720900             DP013-XCTL-DISPLAY-RESTART                           72090000
721000                                  TO TRUE                         72100000
721100         PERFORM DP013-0000-PROCESS-ABEND                         72110000
721200     END-IF.                                                      72120000
721300                                                                  72130000
721400                                                                  72140000
721500*----------------------------------------------------------------*72150000
721600*    FETCH SHIPT CURSOR.                   **** ONLY L LINE **** *72160000
721700*----------------------------------------------------------------*72170000
721800 4330-FETCH-SHIPT-CURSOR.                                         72180000
721900              EXEC SQL                                            72190000
722000                   FETCH SHIPT-CSR                                72200000
722100                    INTO :SHUNLO-SHIPT-UNT-ID                     72210000
722200                        ,:SHPUNT-DEST-OPER-UNT-ID                 72220000
722300                        ,:SHPUNT-SHIPT-UNT-SRC-ID                 72230000
722400                        ,:SHUNLO-CRE-TMST                         72240000
722500                        ,:WS-SHUNLO-CRE-TMST-DATE                 72250000
722600                        ,:WS-SHUNLO-CRE-TMST-TIME                 72260000
722700                        ,:VHTRIP-OWNER-SCAC-ID                    72270000
722800                        ,:VHTRIP-VEH-NBR :DN-VEH-NBR              72280000
722900                        ,:SHUUPC-TRN-LNE-NBR                      72290000
723000              END-EXEC                                            72300000
723100                                                                  72310000
723200     EVALUATE TRUE                                                72320000
723300         WHEN SQLCODE = ZERO                                      72330000
723400              IF DN-VEH-NBR = -1                                  72340000
723500                 MOVE SPACES TO VHTRIP-VEH-NBR                    72350000
723600              END-IF                                              72360000
723700              MOVE WS-SHUNLO-CRE-TMST TO PV-TMST-R                72370000
723800              MOVE PV-TMST-CC         TO PV-DISPLAY-CC            72380000
723900              MOVE PV-TMST-YY         TO PV-DISPLAY-YY            72390000
724000              MOVE PC-SLASH           TO PV-SLASH-1               72400000
724100              MOVE PV-TMST-MM         TO PV-DISPLAY-MM            72410000
724200              MOVE PC-SLASH           TO PV-SLASH-2               72420000
724300              MOVE PV-TMST-DD         TO PV-DISPLAY-DD            72430000
724400              MOVE PV-TMST-HRS        TO PV-DISPLAY-HRS           72440000
724500              MOVE PC-COLON           TO PV-COLON                 72450000
724600              MOVE PV-TMST-MIN        TO PV-DISPLAY-MIN           72460000
724700                                                                  72470000
724800              MOVE PV-DATE-TIME-DISPLAY                           72480000
724900                               TO  WS-SHUNLO-CRE-TMST             72490000
725000                                                                  72500000
725100              MOVE ZEROS           TO SHPTPO-REC-SEQ-NBR          72510000
725200              MOVE SPACES          TO PV-UNION-TYPE               72520000
725300         WHEN SQLCODE = +100                                      72530000
725400*             SET PS-EO-CARTON-CSR TO TRUE                        72540000
725500              SET PS-EO-SHIPT-CSR  TO TRUE                        72550000
725600         WHEN SQLWARN0 NOT = SPACES                               72560000
725700         WHEN SQLCODE NOT = ZERO                                  72570000
725800              MOVE '4330-FETCH-SHIPT-CURSOR'                      72580000
725900                                   TO DP013-PARAGRAPH             72590000
726000              MOVE 'FETCH SHIPT CURSOR'                           72600000
726100                                   TO DP013-MESSAGE-TEXT (1)      72610000
726200              MOVE SQLCA           TO DP013-SQLCA                 72620000
726300              MOVE 'TSHUNLO'   TO DP013-DB2-TABLE-NAME (1)        72630000
726400              SET DP013-DB2-ABEND  TO TRUE                        72640000
726500              PERFORM DP013-0000-PROCESS-ABEND                    72650000
726600     END-EVALUATE.                                                72660000
726700                                                                  72670000
726800     IF  SQLCODE EQUAL +100                                       72680000
726900         SET ASC-NO-ITEMS-LEFT-ON-DB                              72690000
727000                                   TO TRUE                        72700000
727100     END-IF.                                                      72710000
727200                                                                  72720000
727300                                                                  72730000
727400*----------------------------------------------------------------*72740000
727500*    FETCH SHIPT CURSOR.                   **** ALL LINES ****   *72750000
727600*----------------------------------------------------------------*72760000
727700 4335-FETCH-SHIPT-ALL.                                            72770000
727800              EXEC SQL                                            72780000
727900                   FETCH ALL-SHIPT-CSR                            72790000
728000                    INTO :SHUNLO-SHIPT-UNT-ID                     72800000
728100                        ,:SHPUNT-DEST-OPER-UNT-ID                 72810000
728200                        ,:SHPUNT-SHIPT-UNT-SRC-ID                 72820000
728300                        ,:SHUNLO-CRE-TMST                         72830000
728400                        ,:WS-SHUNLO-CRE-TMST-DATE                 72840000
728500                        ,:WS-SHUNLO-CRE-TMST-TIME                 72850000
728600                        ,:VHTRIP-OWNER-SCAC-ID                    72860000
728700                        ,:VHTRIP-VEH-NBR :DN-VEH-NBR              72870000
728800                        ,:SHUUPC-TRN-LNE-NBR                      72880000
728900              END-EXEC                                            72890000
729000                                                                  72900000
729100     EVALUATE TRUE                                                72910000
729200         WHEN SQLCODE = ZERO                                      72920000
729300              IF DN-VEH-NBR = -1                                  72930000
729400                 MOVE SPACES TO VHTRIP-VEH-NBR                    72940000
729500              END-IF                                              72950000
729600              MOVE WS-SHUNLO-CRE-TMST TO PV-TMST-R                72960000
729700              MOVE PV-TMST-CC         TO PV-DISPLAY-CC            72970000
729800              MOVE PV-TMST-YY         TO PV-DISPLAY-YY            72980000
729900              MOVE PC-SLASH           TO PV-SLASH-1               72990000
730000              MOVE PV-TMST-MM         TO PV-DISPLAY-MM            73000000
730100              MOVE PC-SLASH           TO PV-SLASH-2               73010000
730200              MOVE PV-TMST-DD         TO PV-DISPLAY-DD            73020000
730300              MOVE PV-TMST-HRS        TO PV-DISPLAY-HRS           73030000
730400              MOVE PC-COLON           TO PV-COLON                 73040000
730500              MOVE PV-TMST-MIN        TO PV-DISPLAY-MIN           73050000
730600                                                                  73060000
730700              MOVE PV-DATE-TIME-DISPLAY                           73070000
730800                               TO  WS-SHUNLO-CRE-TMST             73080000
730900                                                                  73090000
731000              MOVE ZEROS           TO SHPTPO-REC-SEQ-NBR          73100000
731100              MOVE SPACES          TO PV-UNION-TYPE               73110000
731200         WHEN SQLCODE = +100                                      73120000
731300*             SET PS-EO-CARTON-CSR TO TRUE                        73130000
731400              SET PS-EO-SHIPT-CSR  TO TRUE                        73140000
731500         WHEN SQLWARN0 NOT = SPACES                               73150000
731600         WHEN SQLCODE NOT = ZERO                                  73160000
731700              MOVE '4335-FETCH-SHIPT-CURSOR'                      73170000
731800                                   TO DP013-PARAGRAPH             73180000
731900              MOVE 'FETCH SHIPT CURSOR - ALL LINES '              73190000
732000                                   TO DP013-MESSAGE-TEXT (1)      73200000
732100              MOVE SQLCA           TO DP013-SQLCA                 73210000
732200              MOVE 'TSHUNLO'   TO DP013-DB2-TABLE-NAME (1)        73220000
732300              SET DP013-DB2-ABEND  TO TRUE                        73230000
732400              PERFORM DP013-0000-PROCESS-ABEND                    73240000
732500     END-EVALUATE.                                                73250000
732600                                                                  73260000
732700     IF  SQLCODE EQUAL +100                                       73270000
732800         SET ASC-NO-ITEMS-LEFT-ON-DB                              73280000
732900                                   TO TRUE                        73290000
733000     END-IF.                                                      73300000
733100                                                                  73310000
733200                                                                  73320000
733300*----------------------------------------------------------------*73330000
733400*    GET VEHICLE INFORMATION.                                    *73340000
733500*----------------------------------------------------------------*73350000
733600 4340-GET-VEHICLE.                                                73360000
733700     EXEC SQL                                                     73370000
733800          SELECT OWNER_SCAC_ID                                    73380000
733900              ,  VEH_NBR                                          73390000
734000            INTO :VHTRIP-OWNER-SCAC-ID                            73400000
734100              ,  :VHTRIP-VEH-NBR :DN-VEH-NBR                      73410000
734200            FROM TVHTRIP                                          73420000
734300           WHERE TRIP_ID    = :SHUNLO-TRIP-ID                     73430000
734400     END-EXEC.                                                    73440000
734500                                                                  73450000
734600     EVALUATE TRUE                                                73460000
734700         WHEN SQLCODE = ZERO                                      73470000
734800              IF DN-VEH-NBR = -1                                  73480000
734900                 MOVE SPACES TO VHTRIP-VEH-NBR                    73490000
735000              END-IF                                              73500000
735100         WHEN SQLCODE = +100                                      73510000
735200         WHEN SQLCODE = -904                                      73520000
735300         WHEN SQLCODE = -913                                      73530000
735400              CONTINUE                                            73540000
735500         WHEN SQLWARN0 NOT = SPACES                               73550000
735600         WHEN SQLCODE NOT = ZERO                                  73560000
735700              MOVE '4340-GET-VEHICLE'                             73570000
735800                                   TO DP013-PARAGRAPH             73580000
735900              MOVE 'GET-VEHICLE'                                  73590000
736000                                   TO DP013-MESSAGE-TEXT (1)      73600000
736100              MOVE SQLCA           TO DP013-SQLCA                 73610000
736200              MOVE 'TVEHICL'   TO DP013-DB2-TABLE-NAME (1)        73620000
736300              SET DP013-DB2-ABEND  TO TRUE                        73630000
736400              PERFORM DP013-0000-PROCESS-ABEND                    73640000
736500     END-EVALUATE.                                                73650000
736600*                                                                 73660000
736700*                                                                 73670000
736800*----------------------------------------------------------------*73680000
736900*    GET UCC128 CROSS-REFERENCE STATUS                           *73690000
737000*----------------------------------------------------------------*73700000
737100 4350-GET-UCC128-STATUS.                                          73710000
737200                                                                  73720000
737300     SET   PS-NOT-EOF-STATUS-CURSOR TO  TRUE.                     73730000
737400     MOVE  ZEROES                   TO  PV-XREF-ROWS.             73740000
737500                                                                  73750000
737600     PERFORM 4355-OPEN-STATUS-CURSOR.                             73760000
737700     PERFORM 4360-FETCH-STATUS-CURSOR.                            73770000
737800                                                                  73780000
737900     EVALUATE TRUE                                                73790000
738000         WHEN SQLCODE = 0                                         73800000
738100              PERFORM 4365-PROCESS-STATUS                         73810000
738200                      UNTIL PS-EOF-STATUS-CURSOR                  73820000
738300     END-EVALUATE.                                                73830000
738400                                                                  73840000
738500     PERFORM 4370-CLOSE-STATUS-CURSOR.                            73850000
738600                                                                  73860000
738700                                                                  73870000
738800 4355-OPEN-STATUS-CURSOR.                                         73880000
738900                                                                  73890000
739000     PERFORM                                                      73900000
739100         WITH TEST AFTER                                          73910000
739200         VARYING PV-RETRY-COUNTER                                 73920000
739300         FROM 1 BY 1                                              73930000
739400         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               73940000
739500                   OR (SQLCODE = ZERO))                           73950000
739600                                                                  73960000
739700                  EXEC SQL                                        73970000
739800                       OPEN STATUS-CSR                            73980000
739900                  END-EXEC                                        73990000
740000                                                                  74000000
740100         EVALUATE TRUE                                            74010000
740200             WHEN SQLCODE = ZERO                                  74020000
740300             WHEN SQLCODE = -904                                  74030000
740400             WHEN SQLCODE = -913                                  74040000
740500                  CONTINUE                                        74050000
740600             WHEN SQLWARN0 NOT = SPACES                           74060000
740700             WHEN SQLCODE  < ZERO                                 74070000
740800             WHEN SQLCODE  > ZERO                                 74080000
740900                  MOVE '4355-OPEN-STATUS-CURSOR'                  74090000
741000                                   TO DP013-PARAGRAPH             74100000
741100                  MOVE 'OPEN STATUS CURSOR - '                    74110000
741200                                   TO DP013-MESSAGE-TEXT (1)      74120000
741300                  MOVE SHUNLO-SHIPT-UNT-ID                        74130000
741400                                    TO DP013-MESSAGE-TEXT (2)     74140000
741500                  MOVE SHUNLO-CRE-TMST                            74150000
741600                                    TO DP013-MESSAGE-TEXT (3)     74160000
741700                  MOVE SQLCA       TO DP013-SQLCA                 74170000
741800                  MOVE 'TSULBXF'   TO DP013-DB2-TABLE-NAME (1)    74180000
741900                  SET DP013-DB2-ABEND                             74190000
742000                      DP013-XCTL-DISPLAY-RESTART TO TRUE          74200000
742100                  PERFORM DP013-0000-PROCESS-ABEND                74210000
742200         END-EVALUATE                                             74220000
742300     END-PERFORM.                                                 74230000
742400                                                                  74240000
742500     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        74250000
742600         MOVE '4355-OPEN-STATUS-CURSOR' TO DP013-PARAGRAPH        74260000
742700         MOVE 'MAX RETRIES EXCEEDED ATTEMPTING TO OPEN CSR'       74270000
742800                                   TO DP013-MESSAGE-TEXT (1)      74280000
742900         MOVE SQLCA                TO DP013-SQLCA                 74290000
743000         MOVE 'TSULBXF'   TO DP013-DB2-TABLE-NAME (1)             74300000
743100         SET DP013-DB2-ABEND                                      74310000
743200             DP013-XCTL-DISPLAY-RESTART TO TRUE                   74320000
743300         PERFORM DP013-0000-PROCESS-ABEND                         74330000
743400     END-IF.                                                      74340000
743500                                                                  74350000
743600                                                                  74360000
743700 4360-FETCH-STATUS-CURSOR.                                        74370000
743800                                                                  74380000
743900     PERFORM                                                      74390000
744000         WITH TEST AFTER                                          74400000
744100         VARYING PV-RETRY-COUNTER                                 74410000
744200         FROM 1 BY 1                                              74420000
744300         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               74430000
744400                   OR (SQLCODE = ZERO)                            74440000
744500                   OR PS-EOF-STATUS-CURSOR)                       74450000
744600                                                                  74460000
744700              EXEC SQL                                            74470000
744800                   FETCH STATUS-CSR                               74480000
744900                    INTO :SULBXF-STAT-CDE                         74490000
745000                        ,:SULBXF-LAST-STAT-CHG-TMST               74500000
745100                        ,:SULBXF-DEST-OPER-UNT-ID                 74510000
745200                        ,:WS-SULBXF-LAST-STAT-DATE                74520000
745300                        ,:SULBXF-CART-LBL-TYP-CDE                 74530000
745400              END-EXEC                                            74540000
745500                                                                  74550000
745600         EVALUATE TRUE                                            74560000
745700             WHEN SQLCODE = ZERO                                  74570000
745800                  CONTINUE                                        74580000
745900                                                                  74590000
746000             WHEN SQLCODE = +100                                  74600000
746100                  SET PS-EOF-STATUS-CURSOR TO TRUE                74610000
746200                                                                  74620000
746300             WHEN SQLWARN0 NOT = SPACES                           74630000
746400             WHEN SQLCODE NOT = ZERO                              74640000
746500                  MOVE '4360-FETCH-STATUS-CURSOR'                 74650000
746600                                   TO DP013-PARAGRAPH             74660000
746700                  MOVE 'FETCH STATUS CURSOR'                      74670000
746800                                   TO DP013-MESSAGE-TEXT (1)      74680000
746900                  MOVE SHUNLO-SHIPT-UNT-ID                        74690000
747000                                    TO DP013-MESSAGE-TEXT (2)     74700000
747100                  MOVE SHUNLO-CRE-TMST                            74710000
747200                                    TO DP013-MESSAGE-TEXT (3)     74720000
747300                  MOVE SQLCA           TO DP013-SQLCA             74730000
747400                  MOVE 'TSULBXF'   TO DP013-DB2-TABLE-NAME (1)    74740000
747500              SET DP013-DB2-ABEND  TO TRUE                        74750000
747600                  PERFORM DP013-0000-PROCESS-ABEND                74760000
747700         END-EVALUATE                                             74770000
747800     END-PERFORM.                                                 74780000
747900                                                                  74790000
748000     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        74800000
748100         MOVE '4360-FETCH-STATUS-CURSOR' TO DP013-PARAGRAPH       74810000
748200         MOVE 'MAX RETRIES EXCEEDED ATTEMPTING TO FETCH CSR'      74820000
748300                                   TO DP013-MESSAGE-TEXT (1)      74830000
748400         MOVE SQLCA                TO DP013-SQLCA                 74840000
748500         MOVE 'TSULBXF'   TO DP013-DB2-TABLE-NAME (1)             74850000
748600         SET DP013-DB2-ABEND                                      74860000
748700             DP013-XCTL-DISPLAY-RESTART TO TRUE                   74870000
748800         PERFORM DP013-0000-PROCESS-ABEND                         74880000
748900     END-IF.                                                      74890000
749000                                                                  74900000
749100                                                                  74910000
749200 4365-PROCESS-STATUS.                                             74920000
749300                                                                  74930000
749400     ADD  1                    TO  PV-XREF-ROWS                   74940000
749500                                                                  74950000
749600     IF  PV-XREF-ROWS  >  1                                       74960000
749700         IF  ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                    74970000
749800             ADD +1            TO ASC-ITEM-SUB                    74980000
749900         ELSE                                                     74990000
750000             ADD +1            TO ASC-BLK-SUB                     75000000
750100             MOVE +1           TO ASC-ITEM-SUB                    75010000
750200                                                                  75020000
750300             IF  ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY             75030000
750400                 MOVE +1       TO ASC-BLK-SUB                     75040000
750500                 SET ASC-BLOCK-MODIFIED (1)                       75050000
750600                               TO TRUE                            75060000
750700                 PERFORM 5100-WRITE-TEMP-STORAGE                  75070000
750800                 MOVE ASC-BLOCK-ENTRIES                           75080000
750900                           (PC-MAX-BLOCKS-IN-ARRAY)               75090000
751000                            TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB)     75100000
751100                 ADD +1        TO ASC-BLK-SUB                     75110000
751200                 INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)       75120000
751300                 SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)          75130000
751400                               TO TRUE                            75140000
751500             END-IF                                               75150000
751600         END-IF                                                   75160000
751700         ADD  1                TO ASC-NUMBER-OF-ITEMS-READ        75170000
751800         MOVE  ASC-NUMBER-OF-ITEMS-READ                           75180000
751900                               TO ASC-LIST-ITEM-NUMBER            75190000
752000                                  (ASC-BLK-SUB ASC-ITEM-SUB)      75200000
752100                                                                  75210000
752200         MOVE SPACES           TO ASC-ACTION                      75220000
752300                                  (ASC-BLK-SUB ASC-ITEM-SUB)      75230000
752400                                                                  75240000
752500         MOVE SHUNLO-SHIPT-UNT-ID                                 75250000
752600                       TO  ASC-SERIAL-SHIP-CDE                    75260000
752700                                (ASC-BLK-SUB ASC-ITEM-SUB)        75270000
752800         MOVE SHPUNT-DEST-OPER-UNT-ID                             75280000
752900                       TO  ASC-STR-NBR                            75290000
753000                                (ASC-BLK-SUB ASC-ITEM-SUB)        75300000
753100                                                                  75310000
753200         MOVE PV-UNION-TYPE    TO ASC-CSR-IND                     75320000
753300                                  (ASC-BLK-SUB ASC-ITEM-SUB)      75330000
753400         IF  ASC-PRE-PACK-ORDER                                   75340000
753500             IF PS-MULT-PACK                                      75350000
753600                SET ASC-LINE-MULT                                 75360000
753700                    (ASC-BLK-SUB ASC-ITEM-SUB)                    75370000
753800                TO TRUE                                           75380000
753900             ELSE                                                 75390000
754000                IF ASC-RECEIVER > 0                               75400000
754100                   MOVE RECITM-PREPK-ID                           75410000
754200                                 TO PV-LINE-NBR                   75420000
754300                ELSE                                              75430000
754400                   MOVE PURITM-PO-PREPK-ID                        75440000
754500                                 TO PV-LINE-NBR                   75450000
754600                END-IF                                            75460000
754700                                                                  75470000
754800                MOVE PV-LINE-NBR                                  75480000
754900                              TO ASC-LINE-NBR                     75490000
755000                                  (ASC-BLK-SUB ASC-ITEM-SUB)      75500000
755100             END-IF                                               75510000
755200         ELSE                                                     75520000
755300             IF PS-MULT-LINE                                      75530000
755400                SET ASC-LINE-MULT                                 75540000
755500                    (ASC-BLK-SUB ASC-ITEM-SUB)                    75550000
755600                TO TRUE                                           75560000
755700             ELSE                                                 75570000
755800                MOVE SHUUPC-TRN-LNE-NBR                           75580000
755900                              TO PV-LINE-NBR                      75590000
756000                MOVE PV-LINE-NBR                                  75600000
756100                              TO ASC-LINE-NBR                     75610000
756200                                  (ASC-BLK-SUB ASC-ITEM-SUB)      75620000
756300             END-IF                                               75630000
756400         END-IF                                                   75640000
756500                                                                  75650000
756600         IF   DN-VEH-NBR = -1                                     75660000
756700              MOVE SPACES      TO ASC-VEH-NBR                     75670000
756800                                  (ASC-BLK-SUB ASC-ITEM-SUB)      75680000
756900         ELSE                                                     75690000
757000              MOVE VHTRIP-VEH-NBR                                 75700000
757100                               TO ASC-VEH-NBR                     75710000
757200                                  (ASC-BLK-SUB ASC-ITEM-SUB)      75720000
757300         END-IF                                                   75730000
757400                                                                  75740000
757500         MOVE VHTRIP-OWNER-SCAC-ID                                75750000
757600                                TO ASC-SCAC-CDE                   75760000
757700                                   (ASC-BLK-SUB ASC-ITEM-SUB)     75770000
757800                                                                  75780000
757900         EVALUATE TRUE                                            75790000
758000*LMM         WHEN PV-UNION-TYPE = 'A'                             75800000
758100             WHEN ASC-CHECKED-IN                                  75810000
758200                  MOVE WS-SHUNLO-CRE-TMST-DATE  TO  PV-DTE        75820000
758300                  MOVE WS-SHUNLO-CRE-TMST-TIME  TO  PV-TME        75830000
758400                  MOVE PV-DTE      TO  ASC-LINE-DATE              75840000
758500                                      (ASC-BLK-SUB ASC-ITEM-SUB)  75850000
758600                  MOVE PV-TME      TO  ASC-LINE-TIME              75860000
758700                                      (ASC-BLK-SUB ASC-ITEM-SUB)  75870000
758800*LMM         WHEN PV-UNION-TYPE = 'B'                             75880000
758900             WHEN ASC-NOT-CHECKED-IN                              75890000
759000                  MOVE WS-ENROUTE  TO  ASC-LINE-DATE              75900000
759100                                      (ASC-BLK-SUB ASC-ITEM-SUB)  75910000
759200                  MOVE SPACES      TO  ASC-LINE-TIME              75920000
759300                                      (ASC-BLK-SUB ASC-ITEM-SUB)  75930000
759400         END-EVALUATE                                             75940000
759500                                                                  75950000
759600         IF  PS-USE-SHIPT-CSR                                     75960000
759700             MOVE WS-SHUNLO-CRE-TMST-DATE  TO  PV-DTE             75970000
759800             MOVE WS-SHUNLO-CRE-TMST-TIME  TO  PV-TME             75980000
759900             MOVE PV-DTE        TO  ASC-LINE-DATE                 75990000
760000                                    (ASC-BLK-SUB ASC-ITEM-SUB)    76000000
760100             MOVE PV-TME        TO  ASC-LINE-TIME                 76010000
760200                                    (ASC-BLK-SUB ASC-ITEM-SUB)    76020000
760300             MOVE ASC-TRIP-ID   TO  ASC-LN-TRIP-ID                76030000
760400                                    (ASC-BLK-SUB ASC-ITEM-SUB)    76040000
760500         ELSE                                                     76050000
760600             MOVE SHUNLO-TRIP-ID                                  76060000
760700                                TO  ASC-LN-TRIP-ID                76070000
760800                                    (ASC-BLK-SUB ASC-ITEM-SUB)    76080000
760900         END-IF                                                   76090000
761000     END-IF.                                                      76100000
761100                                                                  76110000
761200     MOVE SULBXF-LAST-STAT-CHG-TMST                               76120000
761300                                TO  PV-TMST-R                     76130000
761400     MOVE PV-TMST-CC            TO  PV-DISPLAY-CC                 76140000
761500     MOVE PV-TMST-YY            TO  PV-DISPLAY-YY                 76150000
761600     MOVE PC-SLASH              TO  PV-SLASH-1                    76160000
761700     MOVE PV-TMST-MM            TO  PV-DISPLAY-MM                 76170000
761800     MOVE PC-SLASH              TO  PV-SLASH-2                    76180000
761900     MOVE PV-TMST-DD            TO  PV-DISPLAY-DD                 76190000
762000     MOVE PV-TMST-HRS           TO  PV-DISPLAY-HRS                76200000
762100     MOVE PC-COLON              TO  PV-COLON                      76210000
762200     MOVE PV-TMST-MIN           TO  PV-DISPLAY-MIN                76220000
762300     MOVE PV-DATE-TIME-DISPLAY  TO  WS-SHUNLO-CRE-TMST            76230000
762400     MOVE PV-DTE                TO  ASC-LINE-DATE                 76240000
762500                                    (ASC-BLK-SUB ASC-ITEM-SUB)    76250000
762600     MOVE PV-TME                TO  ASC-LINE-TIME                 76260000
762700                                    (ASC-BLK-SUB ASC-ITEM-SUB)    76270000
762800     MOVE SULBXF-STAT-CDE       TO  ASC-STATUS                    76280000
762900                                    (ASC-BLK-SUB ASC-ITEM-SUB)    76290000
763000     MOVE SULBXF-DEST-OPER-UNT-ID                                 76300000
763100                                TO  ASC-STR-NBR                   76310000
763200                                    (ASC-BLK-SUB ASC-ITEM-SUB).   76320000
763300                                                                  76330000
763400     MOVE SULBXF-CART-LBL-TYP-CDE                                 76340000
763500                                TO  ASC-LBL-TYP-CDE               76350000
763600                                    (ASC-BLK-SUB ASC-ITEM-SUB).   76360000
763700                                                                  76370000
763800     PERFORM 4360-FETCH-STATUS-CURSOR.                            76380000
763900                                                                  76390000
764000                                                                  76400000
764100 4370-CLOSE-STATUS-CURSOR.                                        76410000
764200                                                                  76420000
764300     PERFORM                                                      76430000
764400         WITH TEST AFTER                                          76440000
764500         VARYING PV-RETRY-COUNTER                                 76450000
764600         FROM 1 BY 1                                              76460000
764700         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               76470000
764800                   OR (SQLCODE = ZERO))                           76480000
764900                                                                  76490000
765000             EXEC SQL                                             76500000
765100                  CLOSE STATUS-CSR                                76510000
765200             END-EXEC                                             76520000
765300                                                                  76530000
765400         EVALUATE TRUE                                            76540000
765500             WHEN SQLCODE = ZERO                                  76550000
765600                  CONTINUE                                        76560000
765700             WHEN SQLWARN0 NOT = SPACES                           76570000
765800             WHEN SQLCODE  < ZERO                                 76580000
765900             WHEN SQLCODE  > ZERO                                 76590000
766000                  MOVE '4370-CLOSE-STATUS-CURSOR'                 76600000
766100                                   TO DP013-PARAGRAPH             76610000
766200                  MOVE 'CLOSE STATUS CURSOR'                      76620000
766300                                   TO DP013-MESSAGE-TEXT (1)      76630000
766400                  MOVE SQLCA           TO DP013-SQLCA             76640000
766500                  MOVE 'TSULBXF'   TO DP013-DB2-TABLE-NAME (1)    76650000
766600                  SET DP013-DB2-ABEND                             76660000
766700                      DP013-XCTL-DISPLAY-RESTART                  76670000
766800                                   TO TRUE                        76680000
766900                  PERFORM DP013-0000-PROCESS-ABEND                76690000
767000         END-EVALUATE                                             76700000
767100     END-PERFORM.                                                 76710000
767200                                                                  76720000
767300     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        76730000
767400         MOVE '4370-CLOSE-STATUS-CURSOR' TO DP013-PARAGRAPH       76740000
767500         MOVE 'MAX RETRIES EXCEEDED ATTEMPTING TO CLOSE CSR'      76750000
767600                                   TO DP013-MESSAGE-TEXT (1)      76760000
767700         MOVE SQLCA                TO DP013-SQLCA                 76770000
767800         MOVE 'TSULBXF'   TO DP013-DB2-TABLE-NAME (1)             76780000
767900         SET DP013-DB2-ABEND                                      76790000
768000             DP013-XCTL-DISPLAY-RESTART TO TRUE                   76800000
768100         PERFORM DP013-0000-PROCESS-ABEND                         76810000
768200     END-IF.                                                      76820000
768300                                                                  76830000
768400                                                                  76840000
768500                                                                  76850000
768600*----------------------------------------------------------------*76860000
768700* MOVE THE DISPLAYED FIELDS FROM THE COMMAREA TO THE SCREEN.     *76870000
768800*----------------------------------------------------------------*76880000
768900 4400-MOVE-COMMAREA-TO-SCREEN.                                    76890000
769000     IF  (((PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (1 1))             76900000
769100         AND (PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (2 1)))          76910000
769200         OR  (PV-TOP-ITEM < ASC-LIST-ITEM-NUMBER (1 1)))          76920000
769300             MOVE +1               TO ASC-BLK-SUB                 76930000
769400             PERFORM 5100-WRITE-TEMP-STORAGE                      76940000
769500             ADD +1                TO ASC-BLK-SUB                 76950000
769600             PERFORM 5100-WRITE-TEMP-STORAGE                      76960000
769700             DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL             76970000
769800                 GIVING PV-BLOCK-NUMBER                           76980000
769900                 REMAINDER PV-REMAINDER                           76990000
770000             IF  PV-REMAINDER > ZERO                              77000000
770100                 ADD +1            TO PV-BLOCK-NUMBER             77010000
770200             END-IF                                               77020000
770300             MOVE +1               TO ASC-BLK-SUB                 77030000
770400             PERFORM 4410-READ-TEMP-STORAGE                       77040000
770500             ADD +1                TO ASC-BLK-SUB                 77050000
770600                                      PV-BLOCK-NUMBER             77060000
770700             PERFORM 4410-READ-TEMP-STORAGE                       77070000
770800     END-IF.                                                      77080000
770900                                                                  77090000
771000     MOVE +1                       TO ASC-BLK-SUB.                77100000
771100                                                                  77110000
771200     COMPUTE ASC-ITEM-SUB =                                       77120000
771300         ((PV-TOP-ITEM - ASC-LIST-ITEM-NUMBER (1 1))              77130000
771400         + PC-ITEMS-PER-PANEL).                                   77140000
771500                                                                  77150000
771600     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        77160000
771700         ADD +1                    TO ASC-BLK-SUB                 77170000
771800         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            77180000
771900     END-IF.                                                      77190000
772000                                                                  77200000
772100     COMPUTE ASC-ITEM-AT-BOT-OF-PANEL =                           77210000
772200         ((PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1).                77220000
772300                                                                  77230000
772400     PERFORM 4430-CHECK-FOR-BEGIN-AND-END.                        77240000
772500                                                                  77250000
772600     PERFORM 3200-RESET-ATTRIBUTES                                77260000
772700     PERFORM 4420-FORMAT-LIST-LINES                               77270000
772800         VARYING PV-SUB                                           77280000
772900         FROM PC-ITEMS-PER-PANEL BY -1                            77290000
773000         UNTIL PV-SUB < +1.                                       77300000
773100                                                                  77310000
773200     COMPUTE ASC-ITEMS-DISPLAYED =                                77320000
773300         ((ASC-ITEM-AT-BOT-OF-PANEL - PV-TOP-ITEM) + 1).          77330000
773400                                                                  77340000
773500     MOVE PV-TOP-ITEM              TO ASC-ITEM-AT-TOP-OF-PANEL    77350000
773600                                      ASTRTITO.                   77360000
773700                                                                  77370000
773800     MOVE ASC-ITEM-AT-BOT-OF-PANEL TO AENDITO.                    77380000
773900     MOVE ASC-NUMBER-OF-ITEMS-READ TO ATOTITO.                    77390000
774000     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            77400000
774100                                   TO ASELITO.                    77410000
774200                                                                  77420000
774300     MOVE ASC-OPER-UNT-ID          TO AOPERO.                     77430000
774400     MOVE ASC-FCLTY-ID             TO AFCLTYO.                    77440000
774500     MOVE ASC-FCLTY-NME            TO ANAMEO.                     77450000
774600*                                                                 77460000
774700     MOVE ASC-PO-NBR               TO PV-PO-NBR.                  77470000
774800     MOVE ASC-RECEIVER             TO PV-RECEIVER.                77480000
774900     MOVE PV-PO-RECEIVER           TO APORCVRO.                   77490000
775000     MOVE ASC-ENT-NAME-DESC        TO AVENDRO.                    77500000
775100*                                                                 77510000
775200     IF  ASC-PRE-PACK-ORDER                                       77520000
775300*IF PREPACK DISPLAY MESSAGE IN YELLOW                             77530000
775400         MOVE PC-PREPACK-MSG       TO APREPKO                     77540000
775500         MOVE PC-PACK-HDG          TO ALNEPCKO                    77550000
775600         MOVE PC-ID-HDG            TO ANMBRIDO                    77560000
775700     ELSE                                                         77570000
775800         MOVE SPACES               TO APREPKO                     77580000
775900         MOVE PC-LINE-HDG          TO ALNEPCKO                    77590000
776000         MOVE PC-NMBR-HDG          TO ANMBRIDO                    77600000
776100     END-IF.                                                      77610000
776200*                                                                 77620000
776300     IF  DP020-MSG-NUMBER-X = SPACES                              77630000
776400         IF  ASC-ITEM-AT-BOT-OF-PANEL < ASC-NUMBER-OF-ITEMS-READ  77640000
776500*            --- MORE ITEMS TO DISPLAY ----                       77650000
776600             MOVE PC-TSYMSG-00279  TO DP020-MSG-NUMBER            77660000
776700             SET DP020-MSG-INFORMATIONAL TO TRUE                  77670000
776800         END-IF                                                   77680000
776900     END-IF.                                                      77690000
777000*                                                                 77700000
777100*                                                                 77710000
777200*----------------------------------------------------------------*77720000
777300*    READ A BLOCK FROM TEMPORARY STORAGE INTO THE ARRAY.         *77730000
777400*----------------------------------------------------------------*77740000
777500 4410-READ-TEMP-STORAGE.                                          77750000
777600     EXEC CICS                                                    77760000
777700         READQ TS                                                 77770000
777800             QUEUE (ASC-LIST-QUEUE-NAME)                          77780000
777900             INTO  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               77790000
778000             ITEM  (PV-BLOCK-NUMBER)                              77800000
778100             RESP  (PV-CICS-RESP)                                 77810000
778200     END-EXEC.                                                    77820000
778300                                                                  77830000
778400     IF  ((PV-CICS-RESP = DFHRESP (NORMAL))                       77840000
778500       OR (PV-CICS-RESP = DFHRESP (ITEMERR)))                     77850000
778600         CONTINUE                                                 77860000
778700     ELSE                                                         77870000
778800         SET DP013-CICS-ABEND      TO TRUE                        77880000
778900         SET DP013-NO-ROLLBACK     TO TRUE                        77890000
779000         MOVE '4410-READ-TEMP-STORAGE'                            77900000
779100                                   TO DP013-PARAGRAPH             77910000
779200         MOVE 'ERROR TRYING TO READ FROM TEMP STORAGE QUEUE'      77920000
779300                                   TO DP013-MESSAGE-TEXT(1)       77930000
779400         PERFORM DP013-0000-PROCESS-ABEND                         77940000
779500     END-IF.                                                      77950000
779600                                                                  77960000
779700     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             77970000
779800                                                                  77980000
779900     IF  PV-CICS-RESP = DFHRESP (ITEMERR)                         77990000
780000         INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)               78000000
780100     END-IF.                                                      78010000
780200 EJECT                                                            78020000
780300*                                                                 78030000
780400*                                                                 78040000
780500*----------------------------------------------------------------*78050000
780600*    PROCESS THE ITEMS IN THE ARRAY AND MOVE THEM TO THE MAP.    *78060000
780700*----------------------------------------------------------------*78070000
780800 4420-FORMAT-LIST-LINES.                                          78080000
780900     IF  ASC-ITEM-AT-BOT-OF-PANEL > ASC-NUMBER-OF-ITEMS-READ      78090000
781000         SUBTRACT +1 FROM ASC-ITEM-AT-BOT-OF-PANEL                78100000
781100         MOVE DP015-ASK-DRK-OFF  TO MR-SELECTA (PV-SUB)           78110000
781200                                    MR-SHIPA (PV-SUB)             78120000
781300                                    MR-STRA (PV-SUB)              78130000
781400         MOVE DP015-HL-OFF       TO MR-SELECTH (PV-SUB)           78140000
781500         MOVE SPACES             TO MR-SELECTI (PV-SUB)           78150000
781600                                    MR-ACTION (PV-SUB)            78160000
781700                                    MR-SHIP (PV-SUB)              78170000
781800                                    MR-LINE (PV-SUB)              78180000
781900                                    MR-STAT (PV-SUB)              78190000
782000                                    MR-STR (PV-SUB)               78200000
782100                                    MR-DATE (PV-SUB)              78210000
782200                                    MR-TIME (PV-SUB)              78220000
782300                                    MR-TRIP (PV-SUB)              78230000
782400                                    MR-SCAC (PV-SUB)              78240000
782500                                    MR-TRLR (PV-SUB)              78250000
782600     ELSE                                                         78260000
782700         IF  ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      78270000
782800                                                   > SPACES       78280000
782900             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 78290000
783000                                 TO MR-SELECTI (PV-SUB)           78300000
783100         ELSE                                                     78310000
783200             MOVE ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      78320000
783300                                 TO MR-SELECTI (PV-SUB)           78330000
783400         END-IF                                                   78340000
783500*                                                                 78350000
783600         IF  DP030-SET-CURSOR-TRAILER                             78360000
783700             IF  ((ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)78370000
783800                 > SPACES)                                        78380000
783900               OR (PV-SUB = 1))                                   78390000
784000                SET DP030-SET-CURSOR-APPL-1 TO TRUE               78400000
784100                MOVE -1            TO MR-SELECTL (PV-SUB)         78410000
784200             END-IF                                               78420000
784300         END-IF                                                   78430000
784400                                                                  78440000
784500******MOVE LIST ITEMS TO SCREEN                                   78450000
784600         MOVE ASC-ACTION (ASC-BLK-SUB ASC-ITEM-SUB)               78460000
784700                             TO MR-ACTION (PV-SUB)                78470000
784800         MOVE ASC-SERIAL-SHIP-CDE (ASC-BLK-SUB ASC-ITEM-SUB)      78480000
784900                             TO MR-SHIP (PV-SUB)                  78490000
785000         MOVE ASC-LINE-NBR  (ASC-BLK-SUB ASC-ITEM-SUB)            78500000
785100                             TO MR-LINE (PV-SUB)                  78510000
785200         MOVE ASC-STATUS    (ASC-BLK-SUB ASC-ITEM-SUB)            78520000
785300                             TO MR-STAT (PV-SUB)                  78530000
785400         IF  ASC-P2L-LBL (ASC-BLK-SUB ASC-ITEM-SUB)               78540000
785500             MOVE 'P2L'      TO MR-STR (PV-SUB)                   78550000
785600         ELSE                                                     78560000
785700             MOVE ASC-STR-NBR(ASC-BLK-SUB ASC-ITEM-SUB)           78570000
785800                             TO MR-STR (PV-SUB)                   78580000
785900         END-IF                                                   78590000
786000         MOVE ASC-LINE-DATE (ASC-BLK-SUB ASC-ITEM-SUB)            78600000
786100                             TO MR-DATE (PV-SUB)                  78610000
786200         MOVE ASC-LINE-TIME (ASC-BLK-SUB ASC-ITEM-SUB)            78620000
786300                             TO MR-TIME (PV-SUB)                  78630000
786400         MOVE ASC-LN-TRIP-ID (ASC-BLK-SUB ASC-ITEM-SUB)           78640000
786500                             TO MR-TRIP (PV-SUB)                  78650000
786600         MOVE ASC-SCAC-CDE (ASC-BLK-SUB ASC-ITEM-SUB)             78660000
786700                             TO MR-SCAC (PV-SUB)                  78670000
786800         MOVE ASC-VEH-NBR (ASC-BLK-SUB ASC-ITEM-SUB)              78680000
786900                             TO MR-TRLR (PV-SUB)                  78690000
787000                                                                  78700000
787100*IF CARTON HAS ODD UNITS HL PACK ID IN YELLOW                     78710000
787200         IF ASC-LN-EVEN-IND (ASC-BLK-SUB ASC-ITEM-SUB)            78720000
787300                            = 'N'                                 78730000
787400             MOVE -1            TO MR-LINEL   (PV-SUB)            78740000
787500             MOVE DP015-YELLOW  TO MR-LINEC   (PV-SUB)            78750000
787600         ELSE                                                     78760000
787700             MOVE 0             TO MR-LINEL   (PV-SUB)            78770000
787800             MOVE DP015-BLUE    TO MR-LINEC   (PV-SUB)            78780000
787900         END-IF                                                   78790000
788000*IF PBS ERROR HL DEST STORE AND SCAN DATE/TIME IN RED             78800000
788100         IF ASC-PBS-ERROR-IND (ASC-BLK-SUB ASC-ITEM-SUB)          78810000
788200                            = 'Y'                                 78820000
788300             MOVE -1            TO MR-STRL   (PV-SUB)             78830000
788400             MOVE DP015-RED     TO MR-STRC    (PV-SUB)            78840000
788500             MOVE -1            TO MR-DATEL   (PV-SUB)            78850000
788600             MOVE DP015-RED     TO MR-DATEC   (PV-SUB)            78860000
788700             MOVE -1            TO MR-TIMEL   (PV-SUB)            78870000
788800             MOVE DP015-RED     TO MR-TIMEC   (PV-SUB)            78880000
788900         ELSE                                                     78890000
789000             MOVE 0             TO MR-STRL   (PV-SUB)             78900000
789100             MOVE DP015-BLUE    TO MR-STRC   (PV-SUB)             78910000
789200             MOVE 0             TO MR-DATEL  (PV-SUB)             78920000
789300             MOVE DP015-BLUE    TO MR-DATEC  (PV-SUB)             78930000
789400             MOVE 0             TO MR-TIMEL  (PV-SUB)             78940000
789500             MOVE DP015-BLUE    TO MR-TIMEC  (PV-SUB)             78950000
789600         END-IF                                                   78960000
789700*IF MISDIRECT HL SCAC/TRAILER IN YELLOW                           78970000
789800         IF ASC-PBS-MISDIRECT-IND (ASC-BLK-SUB ASC-ITEM-SUB)      78980000
789900                            = 'Y'                                 78990000
790000             MOVE -1            TO MR-SCACL  (PV-SUB)             79000000
790100             MOVE DP015-YELLOW  TO MR-SCACC  (PV-SUB)             79010000
790200             MOVE -1            TO MR-TRLRL  (PV-SUB)             79020000
790300             MOVE DP015-YELLOW  TO MR-TRLRC  (PV-SUB)             79030000
790400         ELSE                                                     79040000
790500             MOVE 0             TO MR-SCACL  (PV-SUB)             79050000
790600             MOVE DP015-BLUE    TO MR-SCACC  (PV-SUB)             79060000
790700             MOVE 0             TO MR-TRLRL  (PV-SUB)             79070000
790800             MOVE DP015-BLUE    TO MR-TRLRC  (PV-SUB)             79080000
790900         END-IF                                                   79090000
791000*IF UPC NOT FOUND HL SERIAL SHIP CODE IN YELLOW                   79100000
791100        EVALUATE TRUE                                             79110000
791200           WHEN ASC-UPC-IND (ASC-BLK-SUB ASC-ITEM-SUB)            79120000
791300                              = 'N'                               79130000
791400               MOVE -1            TO MR-SHIPL  (PV-SUB)           79140000
791500               MOVE DP015-YELLOW  TO MR-SHIPC  (PV-SUB)           79150000
791600*IF ITEM NOT ON RECEIVER HL SERIAL SHIP CODE IN RED               79160000
791700           WHEN ASC-ITEM-IND (ASC-BLK-SUB ASC-ITEM-SUB)           79170000
791800                                 = 'N'                            79180000
791900               MOVE -1            TO MR-SHIPL  (PV-SUB)           79190000
792000               MOVE DP015-RED     TO MR-SHIPC  (PV-SUB)           79200000
792100           WHEN OTHER                                             79210000
792200               MOVE 0             TO MR-SHIPL  (PV-SUB)           79220000
792300               MOVE DP015-BLUE    TO MR-SHIPC  (PV-SUB)           79230000
792400        END-EVALUATE                                              79240000
792500     END-IF.                                                      79250000
792600                                                                  79260000
792700     SUBTRACT +1 FROM ASC-ITEM-SUB.                               79270000
792800                                                                  79280000
792900     IF  ASC-ITEM-SUB < + 1                                       79290000
793000         MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB                79300000
793100         MOVE +1                   TO ASC-BLK-SUB                 79310000
793200     END-IF.                                                      79320000
793300*                                                                 79330000
793400*                                                                 79340000
793500*----------------------------------------------------------------*79350000
793600*  IF A BEGINNING OF RANGE WAS SPECIFIED, MAKE SURE AN END OF    *79360000
793700*  RANGE WAS SPECIFIED AND VICE-VERSA.  IF ONE IS MISSING,       *79370000
793800*  ISSUE A WARNING.                                              *79380000
793900*----------------------------------------------------------------*79390000
794000 4430-CHECK-FOR-BEGIN-AND-END.                                    79400000
794100     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       79410000
794200         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     79420000
794300*            -- NO END-OF-RANGE SPECFIED ---                      79430000
794400             MOVE PC-TSYMSG-00051  TO DP020-MSG-NUMBER            79440000
794500             SET DP020-MSG-WARNING TO TRUE                        79450000
794600             PERFORM 4431-POSITION-AT-WARNING                     79460000
794700         END-IF                                                   79470000
794800     ELSE                                                         79480000
794900         IF  ASC-END-OF-SELECTED-RANGE > ZERO                     79490000
795000*            -- NO BEGINNING-OF-RANGE SPECFIED ---                79500000
795100             MOVE PC-TSYMSG-00053  TO DP020-MSG-NUMBER            79510000
795200             SET DP020-MSG-WARNING TO TRUE                        79520000
795300             PERFORM 4431-POSITION-AT-WARNING                     79530000
795400         END-IF                                                   79540000
795500     END-IF.                                                      79550000
795600*                                                                 79560000
795700*                                                                 79570000
795800*----------------------------------------------------------------*79580000
795900*  ONCE IT HAS BEEN DETERMINED THAT A WARNING IS TO BE ISSUED,   *79590000
796000*  DETERMINE IF EITHER THE BEGINNING OF RANGE OR END OF RANGE    *79600000
796100*  IS ON THE CURRENT SCREEN.  IF IT IS, HIGHLIGHT IT AND         *79610000
796200*  POSITION THE CURSOR THERE.                                    *79620000
796300*----------------------------------------------------------------*79630000
796400 4431-POSITION-AT-WARNING.                                        79640000
796500     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 79650000
796600                    - PV-TOP-ITEM + 1.                            79660000
796700                                                                  79670000
796800     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      79680000
796900         CONTINUE                                                 79690000
797000     ELSE                                                         79700000
797100         SET DP030-SET-CURSOR-APPL-1                              79710000
797200                                   TO TRUE                        79720000
797300         MOVE -1                   TO MR-SELECTL (PV-SUB)         79730000
797400         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         79740000
797500         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         79750000
797600     END-IF.                                                      79760000
797700                                                                  79770000
797800     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   79780000
797900                     - PV-TOP-ITEM + 1.                           79790000
798000     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      79800000
798100         CONTINUE                                                 79810000
798200     ELSE                                                         79820000
798300         SET DP030-SET-CURSOR-APPL-1                              79830000
798400                                   TO TRUE                        79840000
798500         MOVE -1                   TO MR-SELECTL (PV-SUB)         79850000
798600         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         79860000
798700         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         79870000
798800     END-IF.                                                      79880000
798900                                                                  79890000
799000                                                                  79900000
799100*----------------------------------------------------------------*79910000
799200*   BUILD INTERNAL TABLE SHOWING ALL LINES FOR A LINE OR PREPACK  79920000
799300*----------------------------------------------------------------*79930000
799400 4600-BUILD-LINE-TABLE.                                           79940000
799500                                                                  79950000
799600     SET  PS-EOF-LINE-CURSOR-NO  TO  TRUE.                        79960000
799700     PERFORM 4610-OPEN-LINE-CSR.                                  79970000
799800                                                                  79980000
799900     PERFORM VARYING LINE-INX FROM 1 BY 1                         79990000
800000               UNTIL PS-EOF-LINE-CURSOR                           80000000
800100                  OR LINE-INX  >  PC-MAX-LINE-TABLE-ROWS          80010000
800200             PERFORM 4615-FETCH-LINE-CSR                          80020000
800300     END-PERFORM.                                                 80030000
800400                                                                  80040000
800500     PERFORM 4620-CLOSE-LINE-CSR.                                 80050000
800600                                                                  80060000
800700                                                                  80070000
800800 4610-OPEN-LINE-CSR.                                              80080000
800900                                                                  80090000
801000     EXEC SQL                                                     80100000
801100          OPEN LINE-CSR                                           80110000
801200     END-EXEC                                                     80120000
801300                                                                  80130000
801400     EVALUATE TRUE                                                80140000
801500         WHEN SQLCODE = ZERO                                      80150000
801600              CONTINUE                                            80160000
801700         WHEN SQLWARN0 NOT = SPACES                               80170000
801800         WHEN SQLCODE  < ZERO                                     80180000
801900         WHEN SQLCODE  > ZERO                                     80190000
802000              MOVE '4610-LINE-CSR'                                80200000
802100                               TO DP013-PARAGRAPH                 80210000
802200              MOVE 'OPEN LINE NUMBER CURSOR - '                   80220000
802300                               TO DP013-MESSAGE-TEXT (1)          80230000
802400              MOVE SQLCA       TO DP013-SQLCA                     80240000
802500              MOVE 'TRECITM'   TO DP013-DB2-TABLE-NAME (1)        80250000
802600              SET DP013-DB2-ABEND                                 80260000
802700                  DP013-XCTL-DISPLAY-RESTART TO TRUE              80270000
802800              PERFORM DP013-0000-PROCESS-ABEND                    80280000
802900     END-EVALUATE.                                                80290000
803000                                                                  80300000
803100                                                                  80310000
803200 4615-FETCH-LINE-CSR.                                             80320000
803300                                                                  80330000
803400     EXEC SQL                                                     80340000
803500          FETCH LINE-CSR                                          80350000
803600           INTO  :RECITM-ORD-LNE-NBR                              80360000
803700                ,:RECITM-PREPK-RATO-QTY                           80370000
803800     END-EXEC.                                                    80380000
803900                                                                  80390000
804000     EVALUATE TRUE                                                80400000
804100         WHEN SQLCODE = ZERO                                      80410000
804200              ADD  1  TO  PV-LINE-TABLE-ROWS                      80420000
804300              MOVE RECITM-ORD-LNE-NBR                             80430000
804400                TO TBL-LINE-NBR(LINE-INX)                         80440000
804500              MOVE RECITM-PREPK-RATO-QTY                          80450000
804600                TO TBL-RATIO(LINE-INX)                            80460000
804700              MOVE ZEROES                                         80470000
804800                TO TBL-PACKS(LINE-INX)                            80480000
804900                   TBL-ODD-UNITS(LINE-INX)                        80490000
805000              SET  TBL-RECEIVED-YES(LINE-INX)  TO TRUE            80500000
805100                                                                  80510000
805200         WHEN SQLCODE = +100                                      80520000
805300              SET PS-EOF-LINE-CURSOR       TO TRUE                80530000
805400                                                                  80540000
805500         WHEN SQLWARN0 NOT = SPACES                               80550000
805600         WHEN SQLCODE NOT = ZERO                                  80560000
805700              MOVE '4615-FETCH-LINE-CSR'                          80570000
805800                                   TO DP013-PARAGRAPH             80580000
805900              MOVE 'GET LINE NUMBERS  '                           80590000
806000                                   TO DP013-MESSAGE-TEXT (1)      80600000
806100              MOVE SQLCA           TO DP013-SQLCA                 80610000
806200              MOVE 'TRECITM'   TO DP013-DB2-TABLE-NAME (1)        80620000
806300              SET DP013-DB2-ABEND  TO TRUE                        80630000
806400              PERFORM DP013-0000-PROCESS-ABEND                    80640000
806500     END-EVALUATE.                                                80650000
806600                                                                  80660000
806700                                                                  80670000
806800 4620-CLOSE-LINE-CSR.                                             80680000
806900                                                                  80690000
807000     EXEC SQL                                                     80700000
807100          CLOSE LINE-CSR                                          80710000
807200     END-EXEC                                                     80720000
807300                                                                  80730000
807400     EVALUATE TRUE                                                80740000
807500         WHEN SQLCODE = ZERO                                      80750000
807600              CONTINUE                                            80760000
807700         WHEN SQLWARN0 NOT = SPACES                               80770000
807800         WHEN SQLCODE  < ZERO                                     80780000
807900         WHEN SQLCODE  > ZERO                                     80790000
808000              MOVE '4620-CLOSE-CSR'                               80800000
808100                               TO DP013-PARAGRAPH                 80810000
808200              MOVE 'CLOSE LINE NUMBER CURSOR - '                  80820000
808300                               TO DP013-MESSAGE-TEXT (1)          80830000
808400              MOVE SQLCA       TO DP013-SQLCA                     80840000
808500              MOVE 'TRECITM'   TO DP013-DB2-TABLE-NAME (1)        80850000
808600              SET DP013-DB2-ABEND                                 80860000
808700                  DP013-XCTL-DISPLAY-RESTART TO TRUE              80870000
808800              PERFORM DP013-0000-PROCESS-ABEND                    80880000
808900     END-EVALUATE.                                                80890000
809000                                                                  80900000
809100                                                                  80910000
809200 4630-CHECK-LINE-TABLE.                                           80920000
809300     SET  PS-VALID-LINE-NO  TO  TRUE.                             80930000
809400     PERFORM VARYING LINE-INX FROM 1 BY 1                         80940000
809500       UNTIL PS-VALID-LINE                                        80950000
809600          OR LINE-INX  >  PV-LINE-TABLE-ROWS                      80960000
809700          OR LINE-INX  >  PC-MAX-LINE-TABLE-ROWS                  80970000
809800             IF  DK-LINE-NBR  =  TBL-LINE-NBR(LINE-INX)           80980000
809900                 MOVE 'Y' TO ASC-ITEM-IND                         80990000
810000                                   (ASC-BLK-SUB ASC-ITEM-SUB)     81000000
810100                 SET  PS-VALID-LINE  TO  TRUE                     81010000
810200                 IF  ASC-PRE-PACK-ORDER                           81020000
810300                     IF  SHUUPC-SHPD-QTY      >  0  AND           81030000
810400                         TBL-RATIO(LINE-INX)  >  0                81040000
810500                         DIVIDE  SHUUPC-SHPD-QTY                  81050000
810600                             BY  TBL-RATIO(LINE-INX)              81060000
810700                         GIVING  TBL-PACKS(LINE-INX)              81070000
810800                         REMAINDER  TBL-ODD-UNITS(LINE-INX)       81080000
810900                     ELSE                                         81090000
811000                         MOVE  ZEROES  TO  TBL-PACKS(LINE-INX)    81100000
811100                                           TBL-ODD-UNITS(LINE-INX)81110000
811200                     END-IF                                       81120000
811300                 END-IF                                           81130000
811400             END-IF                                               81140000
811500     END-PERFORM.                                                 81150000
811600                                                                  81160000
811700     IF  PS-VALID-LINE-NO                                         81170000
811800         MOVE 'N' TO ASC-ITEM-IND (ASC-BLK-SUB ASC-ITEM-SUB)      81180000
811900         IF  ASC-PRE-PACK-ORDER                                   81190000
812000             EVALUATE TRUE                                        81200000
812100                 WHEN ASC-PKSLLNE-FORMAT                          81210000
812200                      MOVE  RC013-PKSL-LNE-NBR-N (ASC-SEL-SUB)    81220000
812300                                                  TO DK-LINE-NBR  81230000
812400                 WHEN OTHER                                       81240000
812500                      MOVE  TBL-LINE-NBR(1)  TO DK-LINE-NBR       81250000
812600             END-EVALUATE                                         81260000
812700             SET PS-UNEVEN-PACK TO TRUE                           81270000
812800             MOVE 'N' TO ASC-ITEM-IND                             81280000
812900                                  (ASC-BLK-SUB ASC-ITEM-SUB)      81290000
813000                         ASC-LN-EVEN-IND                          81300000
813100                                  (ASC-BLK-SUB ASC-ITEM-SUB)      81310000
813200         END-IF                                                   81320000
813300     END-IF.                                                      81330000
813400                                                                  81340000
813500                                                                  81350000
813600****************************************************************  81360000
813700*                                                              *  81370000
813800* CHECK TO SEE THAT ALL LINES IN PREPACK HAVE THE SAME NUMBER  *  81380000
813900* OF PACKS AND ODD UNITS                                       *  81390000
814000*                                                              *  81400000
814100****************************************************************  81410000
814200 4640-CHECK-RATIOS.                                               81420000
814300     MOVE TBL-PACKS(1)      TO  PV-TBL-PACKS.                     81430000
814400     MOVE TBL-ODD-UNITS(1)  TO  PV-TBL-UNITS.                     81440000
814500     SET  PS-MATCH-PACKS-YES  TO  TRUE.                           81450000
814600                                                                  81460000
814700     PERFORM VARYING LINE-INX FROM 1 BY 1                         81470000
814800       UNTIL PS-MATCH-PACKS-NO                                    81480000
814900          OR LINE-INX  >  PV-LINE-TABLE-ROWS                      81490000
815000          OR LINE-INX  >  PC-MAX-LINE-TABLE-ROWS                  81500000
815100             IF  TBL-PACKS(LINE-INX)      =  PV-TBL-PACKS   AND   81510000
815200                 TBL-ODD-UNITS(LINE-INX)  =  PV-TBL-UNITS         81520000
815300                 CONTINUE                                         81530000
815400             ELSE                                                 81540000
815500                 SET  PS-MATCH-PACKS-NO  TO  TRUE                 81550000
815600** DMH 3/16/04   IF  TBL-RECEIVED-NO (LINE-INX)                   81560000
815700                     MOVE 'N' TO  ASC-LN-EVEN-IND                 81570000
815800                                   (ASC-BLK-SUB ASC-ITEM-SUB)     81580000
815900** DMH 3/16/04  END-IF                                            81590000
816000             END-IF                                               81600000
816100     END-PERFORM.                                                 81610000
816200                                                                  81620000
816300     PERFORM VARYING LINE-INX FROM 1 BY 1                         81630000
816400       UNTIL LINE-INX  >  PV-LINE-TABLE-ROWS                      81640000
816500          OR LINE-INX  >  PC-MAX-LINE-TABLE-ROWS                  81650000
816600             MOVE  ZEROES  TO  TBL-PACKS(LINE-INX)                81660000
816700                               TBL-ODD-UNITS(LINE-INX)            81670000
816800             SET  TBL-RECEIVED-NO (LINE-INX)  TO  TRUE            81680000
816900     END-PERFORM.                                                 81690000
817000                                                                  81700000
817100                                                                  81710000
817200*----------------------------------------------------------------*81720000
817300* PREPARE THE SELECTED ITEMS TEMP STORAGE QUEUE.  MOVE ALL SEL-  *81730000
817400* ECTED ITEMS FROM THE LIST TEMP STORAGE QUEUE TO THE LAYOUT     *81740000
817500* FOR THE SELECTED ITEMS QUEUE.                                  *81750000
817600*                                                                *81760000
817700* FIRST, DELETE THE SELECTION QUEUE, NEXT LOAD THE SELECTION     *81770000
817800* QUEUE RECORD.  FINALLY, WRITE THE SELECTION QUEUE ITEM WHEN    *81780000
817900* THE ARRAY IS FULL.                                             *81790000
818000*----------------------------------------------------------------*81800000
818100 5000-PREPARE-SEL-QUEUE.                                          81810000
818200     MOVE +1                   TO  ASC-BLK-SUB.                   81820000
818300     PERFORM 5100-WRITE-TEMP-STORAGE.                             81830000
818400     ADD +1                    TO  ASC-BLK-SUB.                   81840000
818500     PERFORM 5100-WRITE-TEMP-STORAGE.                             81850000
818600                                                                  81860000
818700     MOVE ASC-SEL-QUEUE-NAME   TO  SU003-SEL-QUEUE-NAME.          81870000
818800*                                                                 81880000
818900* JUST FOR TESTING - BEGIN                                        81890000
819000*    INITIALIZE                   PV-CICS-MSG-AREA2               81900000
819100*    MOVE ASC-SEL-TERM-ID      TO PV-SEL-TERM-ID                  81910000
819200*    MOVE ASC-SEL-TASK-NUMBER  TO PV-SEL-TASK-NUMBER              81920000
819300*    MOVE ASC-SEL-SEQ          TO PV-SEL-SEQ                      81930000
819400*    STRING ' SUKCS555 -'         DELIMITED BY SIZE               81940000
819500*           ' QUEUE 1 TERM ID-'   DELIMITED BY SIZE               81950000
819600*            PV-SEL-TERM-ID       DELIMITED BY SIZE               81960000
819700*           ' QUEUE TASK-'        DELIMITED BY SIZE               81970000
819800*            PV-SEL-TASK-NUMBER   DELIMITED BY SIZE               81980000
819900*           ' QUEUE SEQ-'         DELIMITED BY SIZE               81990000
820000*            PV-SEL-SEQ           DELIMITED BY SIZE               82000000
820100*           ' PARAGRAPH 5000 - '       DELIMITED BY SIZE          82010000
820200*                            INTO PV-CICS-MSG-AREA2               82020000
820300*        MOVE LENGTH OF PV-CICS-MSG-AREA2                         82030000
820400*          TO PV-COMMAREA-LENGTH                                  82040000
820500*        EXEC CICS                                                82050000
820600*             WRITEQ TD                                           82060000
820700*              QUEUE  ('CSSL')                                    82070000
820800*               FROM  (PV-CICS-MSG-AREA2)                         82080000
820900*             LENGTH  (PV-COMMAREA-LENGTH)                        82090000
821000*               RESP  (PV-CICS-RESP)                              82100000
821100*        END-EXEC                                                 82110000
821200* JUST FOR TESTING - END                                          82120000
821300                                                                  82130000
821400     PERFORM 6010-DELETE-SEL-QUEUE.                               82140000
821500                                                                  82150000
821600     SET ASC-UPDATE-TSQ        TO  TRUE.                          82160000
821700                                                                  82170000
821800     SET SU004-IDX             TO  1.                             82180000
821900     MOVE ZERO                 TO SU003-NUMBER-OF-TS-ITEMS.       82190000
822000     INITIALIZE SU004-SELECTED-ITEM-ARRAY.                        82200000
822100                                                                  82210000
822200     PERFORM 5200-FILL-SEL-QUEUE-RECORD                           82220000
822300             VARYING PV-ITEM                                      82230000
822400             FROM 1 BY 1                                          82240000
822500             UNTIL PV-ITEM GREATER ASC-HIGHEST-BLOCK-WRITTEN.     82250000
822600                                                                  82260000
822700     IF  SU004-IDX > 1                                            82270000
822800         PERFORM 5205-WRITE-SEL-QUEUE                             82280000
822900         ADD +1                TO SU003-NUMBER-OF-TS-ITEMS        82290000
823000     END-IF.                                                      82300000
823100                                                                  82310000
823200*                                                                 82320000
823300*                                                                 82330000
823400*----------------------------------------------------------------*82340000
823500*    WRITE A NEW BLOCK FROM THE ARRAY TO TEMPORARY STORAGE.      *82350000
823600*    REWRITE AN EXISITING BLOCK ONLY IF IT HAS BEEN MODIFIED.    *82360000
823700*----------------------------------------------------------------*82370000
823800 5100-WRITE-TEMP-STORAGE.                                         82380000
823900     MOVE ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1)                     82390000
824000                                   TO PV-LIST-ITEM-NUMBER.        82400000
824100     COMPUTE PV-BLOCK-NUMBER =                                    82410000
824200         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    82420000
824300                                                                  82430000
824400     IF (PV-BLOCK-NUMBER < ASC-HIGHEST-BLOCK-WRITTEN)             82440000
824500     OR (PV-BLOCK-NUMBER = ASC-HIGHEST-BLOCK-WRITTEN)             82450000
824600         IF  ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                      82460000
824700             PERFORM 5105-REWRITE-ASC-LISTQ                       82470000
824800         END-IF                                                   82480000
824900     ELSE                                                         82490000
825000         COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                       82500000
825100         ASC-HIGHEST-BLOCK-WRITTEN + 1                            82510000
825200         PERFORM 5110-WRITE-ASC-LISTQ                             82520000
825300         ADD +1                    TO ASC-HIGHEST-BLOCK-WRITTEN   82530000
825400     END-IF.                                                      82540000
825500                                                                  82550000
825600     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             82560000
825700*                                                                 82570000
825800*                                                                 82580000
825900*----------------------------------------------------------------*82590000
826000*  REWRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-     *82600000
826100*  SPECIFIC COMMAREA.                                            *82610000
826200*----------------------------------------------------------------*82620000
826300 5105-REWRITE-ASC-LISTQ.                                          82630000
826400     EXEC CICS                                                    82640000
826500         WRITEQ TS                                                82650000
826600             QUEUE (ASC-LIST-QUEUE-NAME)                          82660000
826700             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               82670000
826800             ITEM  (PV-BLOCK-NUMBER)                              82680000
826900             REWRITE                                              82690000
827000             RESP  (PV-CICS-RESP)                                 82700000
827100     END-EXEC.                                                    82710000
827200                                                                  82720000
827300     IF  PV-CICS-RESP = DFHRESP(NORMAL)                           82730000
827400         CONTINUE                                                 82740000
827500     ELSE                                                         82750000
827600         SET DP013-CICS-ABEND      TO TRUE                        82760000
827700         SET DP013-NO-ROLLBACK     TO TRUE                        82770000
827800         MOVE '5105-REWRITE-ASC-LISTQ' TO DP013-PARAGRAPH         82780000
827900         MOVE 'ATTEMPTING TO REWRITE LIST TEMP STORAGE QUEUE'     82790000
828000                                   TO DP013-MESSAGE-TEXT(1)       82800000
828100         PERFORM DP013-0000-PROCESS-ABEND                         82810000
828200     END-IF.                                                      82820000
828300*                                                                 82830000
828400*                                                                 82840000
828500*----------------------------------------------------------------*82850000
828600*  WRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-       *82860000
828700*  SPECIFIC COMMAREA.                                            *82870000
828800*----------------------------------------------------------------*82880000
828900 5110-WRITE-ASC-LISTQ.                                            82890000
829000     EXEC CICS                                                    82900000
829100         WRITEQ TS                                                82910000
829200             QUEUE (ASC-LIST-QUEUE-NAME)                          82920000
829300             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               82930000
829400             ITEM  (PV-BLOCK-NUMBER)                              82940000
829500             RESP  (PV-CICS-RESP)                                 82950000
829600     END-EXEC.                                                    82960000
829700                                                                  82970000
829800     IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                      82980000
829900         SET DP013-CICS-ABEND      TO TRUE                        82990000
830000         SET DP013-NO-ROLLBACK     TO TRUE                        83000000
830100         MOVE '5110-WRITE-ASC-LISTQ'                              83010000
830200                                   TO DP013-PARAGRAPH             83020000
830300         MOVE 'ATTEMPTING TO WRITE LIST TEMP STORAGE QUEUE'       83030000
830400                                   TO DP013-MESSAGE-TEXT(1)       83040000
830500         PERFORM DP013-0000-PROCESS-ABEND                         83050000
830600     END-IF.                                                      83060000
830700*                                                                 83070000
830800*                                                                 83080000
830900*----------------------------------------------------------------*83090000
831000* READ A LIST QUEUE RECORD AND MOVE THE KEYS OF SELECTED OBJECTS *83100000
831100* TO THE SELECTED ITEMS TEMP STORAGE QUEUE RECORD.               *83110000
831200* MOVE THE KEY OF THE SELECTED LIST ITEM THAT WILL BE PASSED     *83120000
831300* TO THE DESTINATION APPLICATION.                                *83130000
831400*----------------------------------------------------------------*83140000
831500 5200-FILL-SEL-QUEUE-RECORD.                                      83150000
831600                                                                  83160000
831700     PERFORM 6112-READ-LIST-QUEUE.                                83170000
831800                                                                  83180000
831900     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       83190000
832000         PERFORM                                                  83200000
832100         VARYING LQW-IDX                                          83210000
832200         FROM 1 BY 1                                              83220000
832300         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            83230000
832400           OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO          83240000
832500                                                                  83250000
832600             IF  LQW-SELECT (LQW-IDX)                             83260000
832700                 MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)              83270000
832800                                   TO SU004-ITEM (SU004-IDX)      83280000
832900                 MOVE SPACES       TO SU004-ACTION-SW (SU004-IDX) 83290000
833000*                                                                 83300000
833100                 MOVE LQW-SERIAL-SHIP-CDE (LQW-IDX)               83310000
833200                                   TO SU004-SHIPT-UNT-ID          83320000
833300                                      (SU004-IDX)                 83330000
833400                                                                  83340000
833500                 MOVE LQW-LN-TRIP-ID (LQW-IDX)                    83350000
833600                                   TO SU004-TRIP-ID               83360000
833700                                      (SU004-IDX)                 83370000
833800                                                                  83380000
833900                 MOVE LQW-SCAC-CDE (LQW-IDX)                      83390000
834000                                   TO SU004-SCAC-CDE              83400000
834100                                      (SU004-IDX)                 83410000
834200                 MOVE LQW-VEH-NBR (LQW-IDX)                       83420000
834300                                   TO SU004-VEH-NBR               83430000
834400                                      (SU004-IDX)                 83440000
834500                                                                  83450000
834600                 MOVE LQW-LINE-NBR(LQW-IDX)                       83460000
834700                                   TO SU004-LINE-NO               83470000
834800                                      (SU004-IDX)                 83480000
834900*                                                                 83490000
835000                 SET SU004-IDX UP BY 1                            83500000
835100                 IF  SU004-IDX > SU004-MAX-ITEMS                  83510000
835200                     PERFORM 5205-WRITE-SEL-QUEUE                 83520000
835300                     ADD +1        TO SU003-NUMBER-OF-TS-ITEMS    83530000
835400                     INITIALIZE SU004-SELECTED-ITEM-ARRAY         83540000
835500                     SET SU004-IDX TO  1                          83550000
835600                 END-IF                                           83560000
835700             END-IF                                               83570000
835800         END-PERFORM                                              83580000
835900     END-IF.                                                      83590000
836000*                                                                 83600000
836100*                                                                 83610000
836200*----------------------------------------------------------------*83620000
836300*    WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE.                *83630000
836400*----------------------------------------------------------------*83640000
836500 5205-WRITE-SEL-QUEUE.                                            83650000
836600     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            83660000
836700                                   TO SU004-SELECTED-ITEMS.       83670000
836800                                                                  83680000
836900     EXEC CICS                                                    83690000
837000          WRITEQ TS                                               83700000
837100              QUEUE (ASC-SEL-QUEUE-NAME)                          83710000
837200              FROM  (SU004-DC-SELECT-RECORD)                      83720000
837300              ITEM  (PV-SEL-QUEUE-ITEM)                           83730000
837400              RESP  (PV-CICS-RESP)                                83740000
837500     END-EXEC.                                                    83750000
837600                                                                  83760000
837700     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          83770000
837800         CONTINUE                                                 83780000
837900     ELSE                                                         83790000
838000         SET DP013-CICS-ABEND      TO TRUE                        83800000
838100         SET DP013-NO-ROLLBACK     TO TRUE                        83810000
838200         MOVE '5205-WRITE-SEL-QUEUE'                              83820000
838300                                   TO DP013-PARAGRAPH             83830000
838400         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          83840000
838500                                   TO DP013-MESSAGE-TEXT(1)       83850000
838600         PERFORM DP013-0000-PROCESS-ABEND                         83860000
838700     END-IF.                                                      83870000
838800 EJECT                                                            83880000
838900*                                                                 83890000
839000*                                                                 83900000
839100******************************************************************83910000
839200** WHEN RETURNING TO THIS TRANSACTION FROM ANOTHER TRANSACTION, **83920000
839300** SETUP THE ARRAY AS IT WAS WHEN WE HAD LEFT PREVIOUSLY.  EDIT **83930000
839400** THE SELECTIONS MADE AT THAT TIME AND DISPLAY THE PANEL TO    **83940000
839500** THE USER.                                                    **83950000
839600******************************************************************83960000
839700 6000-REFRESH-PANEL-FROM-TEMP.                                    83970000
839800     IF  ASC-UPDATE-TSQ                                           83980000
839900         SET ASC-NO-TSQ-UPDATE TO TRUE                            83990000
840000         MOVE ZERO                 TO PV-SAVE-ITEM                84000000
840100                                      PV-SEL-QUEUE-ITEM           84010000
840200         MOVE ASC-NUMBER-OF-SELECTED-ITEMS                        84020000
840300                                   TO PV-HOLD-SELECTED-ITEMS      84030000
840400         MOVE +1                   TO PV-ITEMS-PROCESSED          84040000
840500         PERFORM 6100-UPDATE-TSQ                                  84050000
840600             UNTIL PV-ITEMS-PROCESSED >                           84060000
840700                                     PV-HOLD-SELECTED-ITEMS       84070000
840800         INITIALIZE ASC-BLOCK-ENTRIES (1)                         84080000
840900                    ASC-BLOCK-ENTRIES (2)                         84090000
841000     END-IF.                                                      84100000
841100                                                                  84110000
841200*----------------------------------------------------------------*84120000
841300*    DELETE THE SELECTED ITEMS TEMP STORAGE QUEUE.               *84130000
841400*----------------------------------------------------------------*84140000
841500 6010-DELETE-SEL-QUEUE.                                           84150000
841600     EXEC CICS                                                    84160000
841700         DELETEQ TS                                               84170000
841800             QUEUE (ASC-SEL-QUEUE-NAME)                           84180000
841900             RESP  (PV-CICS-RESP)                                 84190000
842000     END-EXEC.                                                    84200000
842100                                                                  84210000
842200     IF ((PV-CICS-RESP = DFHRESP(NORMAL)) OR                      84220000
842300         (PV-CICS-RESP = DFHRESP(QIDERR)))                        84230000
842400         CONTINUE                                                 84240000
842500     ELSE                                                         84250000
842600         SET DP013-CICS-ABEND      TO TRUE                        84260000
842700         SET DP013-NO-ROLLBACK     TO TRUE                        84270000
842800         MOVE '6010-DELETE-SEL-QUEUE'                             84280000
842900                                   TO DP013-PARAGRAPH             84290000
843000         MOVE 'ERROR TRYING TO DELETE SELECTION TS QUEUE'         84300000
843100                                   TO DP013-MESSAGE-TEXT (1)      84310000
843200         PERFORM DP013-0000-PROCESS-ABEND                         84320000
843300     END-IF.                                                      84330000
843400*                                                                 84340000
843500*                                                                 84350000
843600*----------------------------------------------------------------*84360000
843700*    INCREMENT THE TSQ ITEM NUMBER AND READ THE LIST QUEUE.      *84370000
843800*    LOOP THROUGH THE LIST QUEUE TO OBTAIN THE LINE ITEM NUMBER  *84380000
843900*    TO BE USED TO UPDATE (DESELECT) THE CORRECT LINE ITEM IN    *84390000
844000*    THE TEMP QUEUE.                                             *84400000
844100*----------------------------------------------------------------*84410000
844200 6100-UPDATE-TSQ.                                                 84420000
844300     ADD 1                          TO  PV-SEL-QUEUE-ITEM.        84430000
844400     PERFORM 6105-READ-SEL-QUEUE.                                 84440000
844500     PERFORM                                                      84450000
844600         VARYING SU004-IDX                                        84460000
844700         FROM 1 BY 1                                              84470000
844800         UNTIL ((PV-ITEMS-PROCESSED >                             84480000
844900                              PV-HOLD-SELECTED-ITEMS)             84490000
845000         OR (SU004-IDX GREATER THAN SU004-MAX-ITEMS))             84500000
845100         IF  SU004-ACTION-SW (SU004-IDX) > SPACES                 84510000
845200             PERFORM 6110-PROCESS-ITEMS                           84520000
845300         END-IF                                                   84530000
845400         ADD +1                TO PV-ITEMS-PROCESSED              84540000
845500     END-PERFORM.                                                 84550000
845600     PERFORM 6111-WRITE-LIST-QUEUE.                               84560000
845700*                                                                 84570000
845800*                                                                 84580000
845900*----------------------------------------------------------------*84590000
846000*    READ THE LIST QUEUE RECORD.                                 *84600000
846100*----------------------------------------------------------------*84610000
846200 6105-READ-SEL-QUEUE.                                             84620000
846300*                                                                 84630000
846400* JUST FOR TESTING - BEGIN                                        84640000
846500*    INITIALIZE                   PV-CICS-MSG-AREA2               84650000
846600*    MOVE ASC-SEL-TERM-ID      TO PV-SEL-TERM-ID                  84660000
846700*    MOVE ASC-SEL-TASK-NUMBER  TO PV-SEL-TASK-NUMBER              84670000
846800*    MOVE ASC-SEL-SEQ          TO PV-SEL-SEQ                      84680000
846900*    STRING ' SUKCS555 -'         DELIMITED BY SIZE               84690000
847000*           ' QUEUE 1 TERM ID-'   DELIMITED BY SIZE               84700000
847100*            PV-SEL-TERM-ID       DELIMITED BY SIZE               84710000
847200*           ' QUEUE TASK-'        DELIMITED BY SIZE               84720000
847300*            PV-SEL-TASK-NUMBER   DELIMITED BY SIZE               84730000
847400*           ' QUEUE SEQ-'         DELIMITED BY SIZE               84740000
847500*            PV-SEL-SEQ           DELIMITED BY SIZE               84750000
847600*           ' PARAGRAPH 6105 -'   DELIMITED BY SIZE               84760000
847700*                            INTO PV-CICS-MSG-AREA2               84770000
847800*        MOVE LENGTH OF PV-CICS-MSG-AREA2                         84780000
847900*          TO PV-COMMAREA-LENGTH                                  84790000
848000*        EXEC CICS                                                84800000
848100*             WRITEQ TD                                           84810000
848200*              QUEUE  ('CSSL')                                    84820000
848300*               FROM  (PV-CICS-MSG-AREA2)                         84830000
848400*             LENGTH  (PV-COMMAREA-LENGTH)                        84840000
848500*               RESP  (PV-CICS-RESP)                              84850000
848600*        END-EXEC                                                 84860000
848700*    INITIALIZE                   PV-CICS-MSG-AREA2               84870000
848800*    MOVE ASC-SEL-TERM-ID-ORIG      TO PV-SEL-TERM-ID             84880000
848900*    MOVE ASC-SEL-TASK-NUMBER-ORIG  TO PV-SEL-TASK-NUMBER         84890000
849000*    MOVE ASC-SEL-SEQ-ORIG          TO PV-SEL-SEQ                 84900000
849100*    STRING ' SUKCS555 -'              DELIMITED BY SIZE          84910000
849200*           ' QUEUE ORIG TERM ID- '    DELIMITED BY SIZE          84920000
849300*            PV-SEL-TERM-ID            DELIMITED BY SIZE          84930000
849400*           ' QUEUE TASK-'             DELIMITED BY SIZE          84940000
849500*            PV-SEL-TASK-NUMBER        DELIMITED BY SIZE          84950000
849600*           ' QUEUE SEQ-'              DELIMITED BY SIZE          84960000
849700*            PV-SEL-SEQ                DELIMITED BY SIZE          84970000
849800*           ' PARAGRAPH 6105 -'        DELIMITED BY SIZE          84980000
849900*                                 INTO PV-CICS-MSG-AREA2          84990000
850000*        MOVE LENGTH OF PV-CICS-MSG-AREA2                         85000000
850100*          TO PV-COMMAREA-LENGTH                                  85010000
850200*        EXEC CICS                                                85020000
850300*             WRITEQ TD                                           85030000
850400*              QUEUE  ('CSSL')                                    85040000
850500*               FROM  (PV-CICS-MSG-AREA2)                         85050000
850600*             LENGTH  (PV-COMMAREA-LENGTH)                        85060000
850700*               RESP  (PV-CICS-RESP)                              85070000
850800*        END-EXEC                                                 85080000
850900* JUST FOR TESTING - END                                          85090000
851000     EXEC CICS                                                    85100000
851100          READQ TS                                                85110000
851200              QUEUE (ASC-SEL-QUEUE-NAME)                          85120000
851300              INTO  (SU004-DC-SELECT-RECORD)                      85130000
851400              ITEM  (PV-SEL-QUEUE-ITEM)                           85140000
851500              RESP  (PV-CICS-RESP)                                85150000
851600     END-EXEC.                                                    85160000
851700*                                                                 85170000
851800     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          85180000
851900         CONTINUE                                                 85190000
852000     ELSE                                                         85200000
852100         SET DP013-CICS-ABEND      TO  TRUE                       85210000
852200         SET DP013-NO-ROLLBACK     TO  TRUE                       85220000
852300         MOVE '6105-READ-SEL-QUEUE'                               85230000
852400                                   TO  DP013-PARAGRAPH            85240000
852500         MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           85250000
852600                                   TO  DP013-MESSAGE-TEXT(1)      85260000
852700                                                                  85270000
852800         MOVE ASC-SEL-TERM-ID      TO PV-SEL-TERM-ID              85280000
852900         MOVE ASC-SEL-TASK-NUMBER  TO PV-SEL-TASK-NUMBER          85290000
853000         MOVE ASC-SEL-SEQ          TO PV-SEL-SEQ                  85300000
853100         STRING ' QUEUE 1 TERM ID-'     DELIMITED BY SIZE         85310000
853200                 PV-SEL-TERM-ID       DELIMITED BY SIZE           85320000
853300                ' QUEUE TASK-'        DELIMITED BY SIZE           85330000
853400                 PV-SEL-TASK-NUMBER   DELIMITED BY SIZE           85340000
853500                ' QUEUE SEQ-'         DELIMITED BY SIZE           85350000
853600                 PV-SEL-SEQ           DELIMITED BY SIZE           85360000
853700                                 INTO  DP013-MESSAGE-TEXT(2)      85370000
853800         MOVE ASC-SEL-TERM-ID-ORIG      TO PV-SEL-TERM-ID         85380000
853900         MOVE ASC-SEL-TASK-NUMBER-ORIG  TO PV-SEL-TASK-NUMBER     85390000
854000         MOVE ASC-SEL-SEQ-ORIG          TO PV-SEL-SEQ             85400000
854100         STRING ' QUEUE 2 TERM ID-'     DELIMITED BY SIZE         85410000
854200                 PV-SEL-TERM-ID       DELIMITED BY SIZE           85420000
854300                ' QUEUE TASK-'        DELIMITED BY SIZE           85430000
854400                 PV-SEL-TASK-NUMBER   DELIMITED BY SIZE           85440000
854500                ' QUEUE SEQ-'         DELIMITED BY SIZE           85450000
854600                 PV-SEL-SEQ           DELIMITED BY SIZE           85460000
854700                                 INTO  DP013-MESSAGE-TEXT(3)      85470000
854800         PERFORM DP013-0000-PROCESS-ABEND                         85480000
854900     END-IF.                                                      85490000
855000 EJECT                                                            85500000
855100*                                                                 85510000
855200*                                                                 85520000
855300*----------------------------------------------------------------*85530000
855400*    CALCULATE THE TEMP QUEUE ITEM THAT MUST BE READ AND READ IT.*85540000
855500*    REWRITE THE CURRENT TEMP QUEUE ITEM IF NECESSARY.  CALCULATE*85550000
855600*    THE LINE ITEM OCCURENCE AND UPDATE (DESELECT) IT.           *85560000
855700*----------------------------------------------------------------*85570000
855800 6110-PROCESS-ITEMS.                                              85580000
855900                                                                  85590000
856000     COMPUTE PV-ITEM = 1 + ((SU004-ITEM (SU004-IDX) - 1)          85600000
856100                     / PC-ITEMS-PER-PANEL).                       85610000
856200                                                                  85620000
856300     IF  PV-ITEM NOT EQUAL PV-SAVE-ITEM                           85630000
856400         IF  PV-SAVE-ITEM NOT EQUAL ZERO                          85640000
856500             PERFORM 6111-WRITE-LIST-QUEUE                        85650000
856600         END-IF                                                   85660000
856700         MOVE PV-ITEM          TO PV-SAVE-ITEM                    85670000
856800                                                                  85680000
856900         PERFORM 6112-READ-LIST-QUEUE                             85690000
857000         IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)               85700000
857100             CONTINUE                                             85710000
857200         END-IF                                                   85720000
857300     END-IF.                                                      85730000
857400                                                                  85740000
857500     COMPUTE PV-SUB = (SU004-ITEM (SU004-IDX)                     85750000
857600                    - LQW-LIST-ITEM-NUMBER (1)) + 1.              85760000
857700     SET LQW-DESELECT (PV-SUB) TO    TRUE                         85770000
857800     MOVE LQW-SELECTED-SW (PV-SUB)                                85780000
857900                               TO LQW-TEMP-SELECTED-SW (PV-SUB).  85790000
858000     EVALUATE TRUE                                                85800000
858100         WHEN SU004-INQ (SU004-IDX)                               85810000
858200              MOVE PC-INQ      TO LQW-ACTION (PV-SUB)             85820000
858300                                                                  85830000
858400         WHEN SU004-UPD (SU004-IDX)                               85840000
858500              MOVE PC-UPD      TO LQW-ACTION (PV-SUB)             85850000
858600                                                                  85860000
858700         WHEN SU004-DEL (SU004-IDX)                               85870000
858800              MOVE PC-DEL      TO LQW-ACTION (PV-SUB)             85880000
858900                                                                  85890000
859000         WHEN SU004-ERR (SU004-IDX)                               85900000
859100              MOVE PC-ERR      TO LQW-ACTION (PV-SUB)             85910000
859200     END-EVALUATE.                                                85920000
859300                                                                  85930000
859400     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                85940000
859500*                                                                 85950000
859600*                                                                 85960000
859700*----------------------------------------------------------------*85970000
859800*    WRITE THE TS QUEUE RECORD JUST UPDATED IN S550.             *85980000
859900*----------------------------------------------------------------*85990000
860000 6111-WRITE-LIST-QUEUE.                                           86000000
860100     EXEC CICS                                                    86010000
860200         WRITEQ TS                                                86020000
860300             QUEUE (ASC-LIST-QUEUE-NAME)                          86030000
860400             FROM  (LQW-LIST-QUEUE-WORK-AREA)                     86040000
860500             ITEM  (PV-SAVE-ITEM)                                 86050000
860600             REWRITE                                              86060000
860700             RESP  (PV-CICS-RESP)                                 86070000
860800     END-EXEC.                                                    86080000
860900*                                                                 86090000
861000     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          86100000
861100         CONTINUE                                                 86110000
861200     ELSE                                                         86120000
861300         SET DP013-CICS-ABEND  TO  TRUE                           86130000
861400         SET DP013-NO-ROLLBACK TO  TRUE                           86140000
861500         MOVE '6111-WRITE-LIST-QUEUE'                             86150000
861600                               TO  DP013-PARAGRAPH                86160000
861700         MOVE 'ATTEMPTING TO WRITE LIST QUEUE'                    86170000
861800                               TO  DP013-MESSAGE-TEXT(1)          86180000
861900         PERFORM DP013-0000-PROCESS-ABEND                         86190000
862000     END-IF.                                                      86200000
862100                                                                  86210000
862200 EJECT                                                            86220000
862300*                                                                 86230000
862400*                                                                 86240000
862500*----------------------------------------------------------------*86250000
862600*    READ THE TEMPORARY STORAGE QUEUE INTO A TEMPORARY WORK AREA.*86260000
862700*----------------------------------------------------------------*86270000
862800 6112-READ-LIST-QUEUE.                                            86280000
862900     EXEC CICS                                                    86290000
863000         READQ TS                                                 86300000
863100             QUEUE (ASC-LIST-QUEUE-NAME)                          86310000
863200             INTO  (LQW-LIST-QUEUE-WORK-AREA)                     86320000
863300             ITEM  (PV-ITEM)                                      86330000
863400             RESP  (PV-CICS-RESP)                                 86340000
863500     END-EXEC.                                                    86350000
863600                                                                  86360000
863700     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          86370000
863800         CONTINUE                                                 86380000
863900     ELSE                                                         86390000
864000         SET DP013-CICS-ABEND      TO TRUE                        86400000
864100         SET DP013-NO-ROLLBACK     TO TRUE                        86410000
864200         MOVE '6112-READ-LIST-QUEUE'                              86420000
864300                                   TO DP013-PARAGRAPH             86430000
864400         MOVE 'ATTEMPTING TO READ LIST QUEUE'                     86440000
864500                                   TO DP013-MESSAGE-TEXT(1)       86450000
864600         PERFORM DP013-0000-PROCESS-ABEND                         86460000
864700     END-IF.                                                      86470000
864800*                                                                 86480000
864900*                                                                 86490000
865000*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 86500000
865100* READ AN ITEM FROM THE SELECTED ITEMS TEMP STORAGE QUEUE.       *86510000
865200*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 86520000
865300 9100-READ-SEL-QUEUE.                                             86530000
865400     EXEC CICS                                                    86540000
865500         READQ TS                                                 86550000
865600************ QUEUE (ASC-SEL-QUEUE-NAME)                           86560000
865700             QUEUE (ASC-SEL-QUEUE-NAME-ORIG)                      86570000
865800             INTO  (SU004-DC-SELECT-RECORD)                       86580000
865900             ITEM  (ASC-SEL-ITEM)                                 86590000
866000             RESP  (PV-CICS-RESP)                                 86600000
866100     END-EXEC.                                                    86610000
866200     IF PV-CICS-RESP EQUAL DFHRESP(NORMAL)                        86620000
866300         CONTINUE                                                 86630000
866400     ELSE                                                         86640000
866500         SET DP013-LOGIC-ABEND                                    86650000
866600             DP013-NO-ROLLBACK   TO   TRUE                        86660000
866700         MOVE '9100-READ-SEL-QUEUE'                               86670000
866800                                 TO   DP013-PARAGRAPH             86680000
866900         MOVE 'ATTEMPTING TO READ THE LIST SELECTIONS TS QUEUE'   86690000
867000                                 TO   DP013-MESSAGE-TEXT (1)      86700000
867100         PERFORM DP013-0000-PROCESS-ABEND                         86710000
867200     END-IF.                                                      86720000
867300*                                                                 86730000
867400*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 86740000
867500* READ AN ITEM FROM THE SELECTED ITEMS TEMP STORAGE QUEUE.       *86750000
867600*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 86760000
867700 9100A-READ-SEL-QUEUE.                                            86770000
867800     EXEC CICS                                                    86780000
867900         READQ TS                                                 86790000
868000************ QUEUE (ASC-SEL-QUEUE-NAME)                           86800000
868100             QUEUE (ASC-SEL-QUEUE-NAME-ORIG)                      86810000
868200             INTO  (RC013-DC-SELECT-RECORD)                       86820000
868300             ITEM  (ASC-SEL-ITEM)                                 86830000
868400             RESP  (PV-CICS-RESP)                                 86840000
868500     END-EXEC.                                                    86850000
868600     IF PV-CICS-RESP EQUAL DFHRESP(NORMAL)                        86860000
868700         CONTINUE                                                 86870000
868800     ELSE                                                         86880000
868900         SET DP013-LOGIC-ABEND                                    86890000
869000             DP013-NO-ROLLBACK   TO   TRUE                        86900000
869100         MOVE '9100A-READ-SEL-QUEUE'                              86910000
869200                                 TO   DP013-PARAGRAPH             86920000
869300         MOVE 'ATTEMPTING TO READ THE LIST SELECTIONS TS QUEUE'   86930000
869400                                 TO   DP013-MESSAGE-TEXT (1)      86940000
869500         PERFORM DP013-0000-PROCESS-ABEND                         86950000
869600     END-IF.                                                      86960000
869700*                                                                 86970000
869800*                                                                 86980000
869900*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*86990000
870000* UPDATE AN ITEM IN THE SELECTED ITEMS TEMP STORAGE QUEUE.       *87000000
870100*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 87010000
870200 9200-REWRITE-SEL-QUEUE.                                          87020000
870300                                                                  87030000
870400     EXEC CICS                                                    87040000
870500          WRITEQ TS                                               87050000
870600************* QUEUE  (ASC-SEL-QUEUE-NAME)                         87060000
870700              QUEUE  (ASC-SEL-QUEUE-NAME-ORIG)                    87070000
870800              FROM   (SU004-DC-SELECT-RECORD)                     87080000
870900              ITEM   (ASC-SEL-ITEM)                               87090000
871000              RESP   (PV-CICS-RESP)                               87100000
871100              REWRITE                                             87110000
871200     END-EXEC.                                                    87120000
871300                                                                  87130000
871400     IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)                   87140000
871500         SET DP013-CICS-ABEND                                     87150000
871600             DP013-NO-ROLLBACK     TO TRUE                        87160000
871700         MOVE '9200-REWRITE-SEL-QUEUE'                            87170000
871800                                   TO DP013-PARAGRAPH             87180000
871900         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   87190000
872000                                   TO DP013-MESSAGE-TEXT (1)      87200000
872100         PERFORM DP013-0000-PROCESS-ABEND                         87210000
872200     END-IF.                                                      87220000
872300*                                                                 87230000
872400*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*87240000
872500* UPDATE AN ITEM IN THE SELECTED ITEMS TEMP STORAGE QUEUE.       *87250000
872600*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 87260000
872700 9200A-REWRITE-SEL-QUEUE.                                         87270000
872800                                                                  87280000
872900     EXEC CICS                                                    87290000
873000          WRITEQ TS                                               87300000
873100************* QUEUE  (ASC-SEL-QUEUE-NAME)                         87310000
873200              QUEUE  (ASC-SEL-QUEUE-NAME-ORIG)                    87320000
873300              FROM   (RC013-DC-SELECT-RECORD)                     87330000
873400              ITEM   (ASC-SEL-ITEM)                               87340000
873500              RESP   (PV-CICS-RESP)                               87350000
873600              REWRITE                                             87360000
873700     END-EXEC.                                                    87370000
873800                                                                  87380000
873900     IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)                   87390000
874000         SET DP013-CICS-ABEND                                     87400000
874100             DP013-NO-ROLLBACK     TO TRUE                        87410000
874200         MOVE '9200A-REWRITE-SEL-QUEUE'                           87420000
874300                                   TO DP013-PARAGRAPH             87430000
874400         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   87440000
874500                                   TO DP013-MESSAGE-TEXT (1)      87450000
874600         PERFORM DP013-0000-PROCESS-ABEND                         87460000
874700     END-IF.                                                      87470000
874800*                                                                 87480000
874900*                                                                 87490000
875000*----------------------------------------------------------------*87500000
875100*    THE DB2 RESOURCE IS NOT AVAILABLE, DISPLAY A MESSAGE ON     *87510000
875200*    THE TERMINAL INDICATING THAT THE RESOURCE IS UNAVAILABLE.   *87520000
875300*----------------------------------------------------------------*87530000
875400 9900-SOFT-ABORT.                                                 87540000
875500                                                                  87550000
875600     EXEC CICS SYNCPOINT                                          87560000
875700          ROLLBACK                                                87570000
875800     END-EXEC.                                                    87580000
875900                                                                  87590000
876000     SET  PS-ERROR                                                87600000
876100          PS-SOFT-ABORT-ERROR                                     87610000
876200          DP020-MSG-FATAL       TO  TRUE.                         87620000
876300                                                                  87630000
876400*----------------------------------------------------------------*87640000
876500*    ABEND PROCESSOR MODULE                                      *87650000
876600*----------------------------------------------------------------*87660000
876700     COPY DPPD013.                                                87670000
876800*----------------------------------------------------------------*87680000
876900*----------------------------------------------------------------*87690000
