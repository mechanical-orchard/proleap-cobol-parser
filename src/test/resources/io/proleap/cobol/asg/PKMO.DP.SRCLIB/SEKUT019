000100*************************                                         00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300*************************                                         00030000
000400 PROGRAM-ID.      SEKUT019.                                       00040000
000500 AUTHOR.          MIKE SOMMERS.                                   00050000
000600 DATE-WRITTEN.    MAY 2005.                                       00060000
000700                                                                  00070000
000800*        READ AN IDENTITY MANAGEMENT (LDAP) EXTRACT FILE AND AN   00080001
000900*        EMAIL EXTRACT FILE.  MERGE THE EMAIL INFORMATION WITH THE00090001
001000*        LDAP INFO.                                               00100001
001100                                                                  00110000
001200 ENVIRONMENT DIVISION.                                            00120000
001300 CONFIGURATION SECTION.                                           00130000
001400 SOURCE-COMPUTER. IBM-3090.                                       00140000
001500 OBJECT-COMPUTER. IBM-3090.                                       00150000
001600                                                                  00160000
001700 INPUT-OUTPUT SECTION.                                            00170000
001800 FILE-CONTROL.                                                    00180000
001900     SELECT EMAIL-EXTRACT-FILE         ASSIGN TO INP01.           00190001
002000     SELECT ID-MGMT-EXTRACT-FILE       ASSIGN TO INP02.           00200000
002100     SELECT MERGED-FILE                ASSIGN TO OUT01.           00210000
002200     SELECT PRINT-FILE                 ASSIGN TO RPT01.           00220000
002300     SELECT PRINT-FILE-2               ASSIGN TO RPT02.           00230000
002310     EJECT                                                        00231000
002320***************                                                   00232000
002330 DATA DIVISION.                                                   00233000
002340***************                                                   00234000
002350 FILE SECTION.                                                    00235000
002360 FD  EMAIL-EXTRACT-FILE                                           00236001
002370                             BLOCK CONTAINS 0 RECORDS,            00237000
002380                             RECORD CONTAINS 383 CHARACTERS,      00238001
002390                             RECORDING MODE IS F,                 00239000
002400                             LABEL RECORDS ARE STANDARD,          00240000
002500                             DATA RECORD IS EMAIL-EXTRACT-REC.    00250001
002600 01  EMAIL-EXTRACT-REC       PIC X(383).                          00260001
002700                                                                  00270000
002800 FD  ID-MGMT-EXTRACT-FILE                                         00280000
002900                             BLOCK CONTAINS 0 RECORDS,            00290000
003000                             RECORD CONTAINS 242 CHARACTERS,      00300000
003100                             RECORDING MODE IS F,                 00310000
003200                             LABEL RECORDS ARE STANDARD,          00320000
003300                             DATA RECORD IS ID-MGMT-REC.          00330000
003400 01  ID-MGMT-REC             PIC X(242).                          00340000
003500                                                                  00350000
003600 FD  MERGED-FILE                                                  00360000
003700                             BLOCK CONTAINS 0 RECORDS,            00370000
003800                             RECORD CONTAINS 348 CHARACTERS,      00380000
003900                             RECORDING MODE IS F,                 00390000
004000                             LABEL RECORDS ARE STANDARD,          00400000
004100                             DATA RECORD IS MERGED-REC.           00410000
004200 01  MERGED-REC              PIC X(348).                          00420000
004300                                                                  00430000
004400 FD  PRINT-FILE                                                   00440000
004500                             BLOCK CONTAINS 0 RECORDS,            00450000
004600                             RECORD CONTAINS 150 CHARACTERS,      00460000
004700                             RECORDING MODE IS F,                 00470000
004800                             LABEL RECORDS ARE STANDARD,          00480000
004900                             DATA RECORD IS PRINT-REC.            00490000
005000 01  PRINT-REC               PIC X(150).                          00500000
005100                                                                  00510000
005200 FD  PRINT-FILE-2                                                 00520000
005300                             BLOCK CONTAINS 0 RECORDS,            00530000
005400                             RECORD CONTAINS 150 CHARACTERS,      00540000
005500                             RECORDING MODE IS F,                 00550000
005600                             LABEL RECORDS ARE STANDARD,          00560000
005700                             DATA RECORD IS PRINT-REC-2.          00570000
005800 01  PRINT-REC-2             PIC X(150).                          00580000
005900     EJECT                                                        00590000
006000*************************                                         00600000
006100 WORKING-STORAGE SECTION.                                         00610000
006200*************************                                         00620000
006300******************************************************************00630000
006400*   IDENTITY MANAGEMENT EXTRACT RECORD LAYOUT                     00640000
006500******************************************************************00650000
006600     COPY SERD005.                                                00660000
006700                                                                  00670000
006800                                                                  00680000
006900******************************************************************00690000
007000*    EMAIL EXTRACT RECORD LAYOUT                                  00700001
007100******************************************************************00710000
007110     COPY SERD001.                                                00711001
008260                                                                  00826000
008270******************************************************************00827000
008280*    MERGED RECORD LAYOUT                                         00828000
008290******************************************************************00829000
008300 01  MR-MERGED-RECORD.                                            00830000
008301     05  MR-ASSOCIATE-ID             PIC X(7)      VALUE SPACES.  00830100
008302     05  MR-EMPLOYEE-USER-ID         PIC X(7)      VALUE SPACES.  00830200
008303     05  MR-EMPLOYEE-NAME            PIC X(40)     VALUE SPACES.  00830300
008304     05  MR-DEPARTMENT               PIC X(7)      VALUE SPACES.  00830400
008305     05  MR-LOCATION                 PIC X(4)      VALUE SPACES.  00830500
008306     05  MR-WORK-EMAIL-ADDRESS       PIC X(60)     VALUE SPACES.  00830600
008307     05  MR-JOB-TITLE                PIC X(75)     VALUE SPACES.  00830700
008308     05  MR-WORK-PHONE               PIC X(12)     VALUE SPACES.  00830800
008309     05  MR-CELL-PHONE               PIC X(16)     VALUE SPACES.  00830900
008310     05  MR-PAGER-PIN                PIC X(60)     VALUE SPACES.  00831000
008311     05  MR-SUPERVISOR               PIC X(60)     VALUE SPACES.  00831100
008312                                                                  00831200
008313 01  RR-REPORT-RECORD.                                            00831300
008314     05  FILLER                      PIC X(1)      VALUE SPACES.  00831400
008315     05  RR-MESSAGE                  PIC X(36)     VALUE SPACES.  00831500
008316     05  FILLER                      PIC X(1)      VALUE SPACES.  00831600
008317     05  RR-EMPLOYEE-NUMBER          PIC X(7)      VALUE SPACES.  00831700
008318     05  FILLER                      PIC X(2)      VALUE SPACES.  00831800
008319     05  RR-EMPLOYEE-USER-ID         PIC X(7)      VALUE SPACES.  00831900
008320     05  FILLER                      PIC X(4)      VALUE SPACES.  00832000
008330     05  RR-NAME                     PIC X(36)     VALUE SPACES.  00833000
008340     05  FILLER                      PIC X(4)      VALUE SPACES.  00834000
008350     05  RR-EMPLOYEE-TITLE           PIC X(34)     VALUE SPACES.  00835000
008360     05  FILLER                      PIC X(4)      VALUE SPACES.  00836000
008370     05  RR-EMPLOYEE-LOCATION        PIC X(4)      VALUE SPACES.  00837000
008380     05  FILLER                      PIC X(3)      VALUE SPACES.  00838000
008390     05  RR-EMPLOYEE-DEPARTMENT      PIC X(7)      VALUE SPACES.  00839000
008400                                                                  00840000
008500 01  RR3-REPORT-RECORD-3.                                         00850000
008600     05  FILLER                      PIC X(1)      VALUE SPACES.  00860000
008700     05  FILLER                      PIC X(44)     VALUE          00870000
008800         'THE RACF USER ID HAS BEEN REPLACED FOR:     '.          00880000
008900     05  RR3-EMPLOYEE-NUMBER         PIC X(7)      VALUE SPACES.  00890000
009000     05  FILLER                      PIC X(3)      VALUE SPACES.  00900000
009100     05  RR3-NAME                    PIC X(36)     VALUE SPACES.  00910000
009200     05  FILLER                      PIC X(2)      VALUE SPACES.  00920000
009300     05  RR3-EMPLOYEE-LOCATION       PIC X(4)      VALUE SPACES.  00930000
009400     05  FILLER                      PIC X(2)      VALUE SPACES.  00940000
009500     05  RR3-EMPLOYEE-DEPARTMENT     PIC X(7)      VALUE SPACES.  00950000
009600     05  FILLER                      PIC X(5)      VALUE SPACES.  00960000
009700     05  RR3-EMPLOYEE-OLD-USER-ID    PIC X(7)      VALUE SPACES.  00970000
009800     05  FILLER                      PIC X(5)      VALUE SPACES.  00980000
009900     05  RR3-EMPLOYEE-NEW-USER-ID    PIC X(7)      VALUE SPACES.  00990000
010000     05  FILLER                      PIC X(2)      VALUE SPACES.  01000000
010100                                                                  01010000
010200 01  TR1-TOTAL-RECORD-1.                                          01020000
010300     05  FILLER                      PIC X(4)      VALUE SPACES.  01030000
010400     05  FILLER                      PIC X(50)     VALUE          01040000
010500         'TOTAL NUMBER OF RECORDS ON THE ID MGMT FILE BUT NO'.    01050000
010600     05  FILLER                      PIC X(24)     VALUE          01060000
010700         'T ON THE PS/NOTES FILE: '.                              01070000
010800     05  TR1-HR-TOTAL                PIC ZZZ,ZZ9   VALUE ZEROES.  01080000
010900     05  FILLER                      PIC X(66)     VALUE SPACES.  01090000
011000                                                                  01100000
011100 01  TR2-TOTAL-RECORD-2.                                          01110000
011200     05  FILLER                      PIC X(4)      VALUE SPACES.  01120000
011300     05  FILLER                      PIC X(50)     VALUE          01130000
011400         'TOTAL NUMBER OF RECORDS ON THE NOTES FILE BUT NOT '.    01140000
011500     05  FILLER                      PIC X(21)     VALUE          01150000
011600         'ON THE ID MGMT FILE: '.                                 01160000
011700     05  TR2-NOTES-TOTAL             PIC ZZZ,ZZ9   VALUE ZEROES.  01170000
011800     05  FILLER                      PIC X(69)     VALUE SPACES.  01180000
011900     EJECT                                                        01190000
012000 01  HEADING-LINE1.                                               01200000
012100     05  FILLER                  PIC X(1)    VALUE SPACES.        01210000
012200     05  HL1-DATE.                                                01220000
012300         10  HL1-MM              PIC 9(2)    VALUE ZEROES.        01230000
012400         10  FILLER              PIC X(1)    VALUE '-'.           01240000
012500         10  HL1-DD              PIC 9(2)    VALUE ZEROES.        01250000
012600         10  FILLER              PIC X(1)    VALUE '-'.           01260000
012700         10  HL1-YY              PIC 9(2)    VALUE ZEROES.        01270000
012800     05  FILLER                  PIC X(2)    VALUE SPACES.        01280000
012900     05  HL1-TIME.                                                01290000
013000         10  HL1-HR              PIC 9(2)    VALUE ZEROES.        01300000
013100         10  FILLER              PIC X(1)    VALUE ':'.           01310000
013200         10  HL1-MN              PIC 9(2)    VALUE ZEROES.        01320000
013300         10  FILLER              PIC X(1)    VALUE ':'.           01330000
013400         10  HL1-SC              PIC 9(2)    VALUE ZEROES.        01340000
013500     05  FILLER                  PIC X(31)   VALUE SPACES.        01350000
013600     05  FILLER                  PIC X(48)                        01360000
013700         VALUE 'K O H L '' S   D E P A R T M E N T   S T O R E S'.01370000
013800     05  FILLER                  PIC X(31)   VALUE SPACES.        01380000
013900     05  FILLER                  PIC X(9)    VALUE 'SEKUT019-'.   01390000
014000     05  HL1-RPTNO               PIC 9(1)    VALUE 1.             01400000
014100     05  FILLER                  PIC X(7)    VALUE '  PAGE '.     01410000
014200     05  HL1-PAGE                PIC ZZZ9    VALUE ZEROES.        01420000
014300                                                                  01430000
014400 01  HEADING-LINE2.                                               01440000
014500     05  FILLER                  PIC X(49)      VALUE SPACES.     01450000
014600     05  FILLER                  PIC X(48)      VALUE             01460000
014700         'ASSOCIATES ON NOTES FILE BUT NOT ON ID MGMT FILE'.      01470000
014800     05  FILLER                  PIC X(52)      VALUE SPACES.     01480000
014900                                                                  01490000
015000 01  HEADING-LINE2A.                                              01500000
015100     05  FILLER                  PIC X(50)      VALUE SPACES.     01510000
015200     05  FILLER                  PIC X(48)      VALUE             01520000
015300         'ASSOCIATES ON ID MGMT FILE BUT NOT ON NOTES FILE'.      01530000
015400     05  FILLER                  PIC X(52)      VALUE SPACES.     01540000
015500                                                                  01550000
015600 01  HEADING-LINE3.                                               01560000
015700     05  FILLER                  PIC X(54)      VALUE             01570000
015800         ' MESSAGE                              EMPL ID  USER ID'.01580000
015900     05  FILLER                  PIC X(52)      VALUE             01590000
016000         '    NAME                                    JOB TITL'.  01600000
016100     05  FILLER                  PIC X(42)      VALUE             01610000
016200         'E                             LOC    DEPT '.            01620000
016300     05  FILLER                  PIC X(2)       VALUE SPACES.     01630000
016400     EJECT                                                        01640000
016500 01  WS-WORKING-STORAGE.                                          01650000
016600     05  WS-PAGE-CNT             PIC 9(3) COMP  VALUE ZEROES.     01660000
016700     05  WS-LINE-CNT             PIC 9(2)       VALUE 80.         01670000
016800     05  WS-PAGE-CNT-2           PIC 9(3) COMP  VALUE ZEROES.     01680000
016900     05  WS-LINE-CNT-2           PIC 9(2)       VALUE 80.         01690000
017000     05  WS-NAME.                                                 01700000
017100         10  WS-NAME-FIRST       PIC X(16)      VALUE SPACES.     01710000
017200         10  WS-NAME-LAST        PIC X(20)      VALUE SPACES.     01720000
017300     05  WS-SE-REC-CNT           PIC 9(6) COMP  VALUE ZEROES.     01730000
017400     05  WS-EMAIL-EXTRACT-REC-CNT PIC 9(6) COMP VALUE ZEROES.     01740001
017500     05  WS-DATE.                                                 01750000
017600         10  WS-YR               PIC 9(2)       VALUE ZEROES.     01760000
017700         10  WS-MO               PIC 9(2)       VALUE ZEROES.     01770000
017800         10  WS-DY               PIC 9(2)       VALUE ZEROES.     01780000
017900     05  WS-TIME.                                                 01790000
018000         10  WS-HR               PIC 9(2)       VALUE ZEROES.     01800000
018100         10  WS-MIN              PIC 9(2)       VALUE ZEROES.     01810000
018200         10  WS-SEC              PIC 9(2)       VALUE ZEROES.     01820000
018300         10  WS-HSEC             PIC 9(2)       VALUE ZEROES.     01830000
018400 01  EMAIL-EXTRACT-FILE-EOF      PIC 9(1)       VALUE ZEROES.     01840001
018500     88  EEF-EOF                                VALUE 1.          01850001
018600 01  ID-MGMT-EXTRACT-FILE-EOF    PIC 9(1)       VALUE ZEROES.     01860000
018700     88  IMEF-EOF                               VALUE 1.          01870001
018800                                                                  01880000
018900 01  ABEND-CODE                  PIC 9(2) COMP  VALUE ZEROES.     01890000
019000     EJECT                                                        01900000
019100********************                                              01910000
019200 PROCEDURE DIVISION.                                              01920000
019300********************                                              01930000
019400     DISPLAY '****************************'                       01940000
019500     DISPLAY '** BEGIN PROGRAM SEKUT019 **'                       01950000
019600     DISPLAY '****************************'                       01960000
019700     DISPLAY ' '.                                                 01970000
019800                                                                  01980000
019900     ACCEPT WS-TIME FROM TIME.                                    01990000
020000     ACCEPT WS-DATE FROM DATE.                                    02000000
020100     MOVE WS-HR  TO HL1-HR.                                       02010000
020200     MOVE WS-MIN TO HL1-MN.                                       02020000
020300     MOVE WS-SEC TO HL1-SC.                                       02030000
020400     MOVE WS-MO  TO HL1-MM.                                       02040000
020500     MOVE WS-DY  TO HL1-DD.                                       02050000
020600     MOVE WS-YR  TO HL1-YY.                                       02060000
020700                                                                  02070000
020800     OPEN INPUT  EMAIL-EXTRACT-FILE                               02080001
020900                 ID-MGMT-EXTRACT-FILE.                            02090000
021000     OPEN OUTPUT MERGED-FILE                                      02100000
021100                 PRINT-FILE                                       02110000
021200                 PRINT-FILE-2.                                    02120000
021300                                                                  02130000
021400     PERFORM A100-READ-EMAIL-EXTRACT-FILE.                        02140001
021500     PERFORM A200-READ-ID-MGMT-EXTRACT-FILE.                      02150000
021600     PERFORM B000-CHECK-EOF                                       02160000
021700         UNTIL IMEF-EOF.                                          02170000
021800     PERFORM Y900-WRITE-TOTALS.                                   02180000
021900                                                                  02190000
022000     CLOSE EMAIL-EXTRACT-FILE                                     02200001
022100           ID-MGMT-EXTRACT-FILE                                   02210000
022200           MERGED-FILE                                            02220000
022300           PRINT-FILE                                             02230000
022400           PRINT-FILE-2.                                          02240000
022500                                                                  02250000
022600     DISPLAY ' '.                                                 02260000
022700     DISPLAY '****************************'                       02270000
022800     DISPLAY '**  END PROGRAM SEKUT019  **'                       02280000
022900     DISPLAY '****************************'                       02290000
023000     STOP RUN.                                                    02300000
023100                                                                  02310000
023200******************************                                    02320000
023300 A100-READ-EMAIL-EXTRACT-FILE.                                    02330001
023400******************************                                    02340000
023500     IF EEF-EOF                                                   02350001
023600         CONTINUE                                                 02360000
023700     ELSE                                                         02370000
023800         READ EMAIL-EXTRACT-FILE                                  02380001
023810                 INTO SE001-FORMATTED-OUTPUT-RECORD               02381001
023900             AT END                                               02390000
024000                 SET EEF-EOF TO TRUE                              02400001
024100     END-IF.                                                      02410000
024200                                                                  02420000
024300********************************                                  02430000
024400 A200-READ-ID-MGMT-EXTRACT-FILE.                                  02440000
024500********************************                                  02450000
024600     IF IMEF-EOF                                                  02460000
024700         CONTINUE                                                 02470000
024800     ELSE                                                         02480000
024900         READ ID-MGMT-EXTRACT-FILE INTO SE005-LDAP-EXTRACT        02490000
025000             AT END                                               02500000
025100                 SET IMEF-EOF TO TRUE                             02510001
025200     END-IF.                                                      02520000
025300                                                                  02530000
025400****************                                                  02540000
025500 B000-CHECK-EOF.                                                  02550000
025600****************                                                  02560000
025700     IF EEF-EOF AND IMEF-EOF                                      02570001
025800         CONTINUE                                                 02580000
025900     ELSE                                                         02590000
026000         IF IMEF-EOF                                              02600000
026100             CONTINUE                                             02610000
026200         ELSE                                                     02620000
026300             IF EEF-EOF                                           02630001
026400                 PERFORM X100-BUILD-ID-MGMT-RPT-RECORD            02640000
026500                 ADD 1 TO WS-EMAIL-EXTRACT-REC-CNT                02650001
026600                 PERFORM D050-MOVE-SE-TO-OUTPUT                   02660000
026700                 PERFORM D100-WRITE-OUTPUT                        02670000
026800                 PERFORM A200-READ-ID-MGMT-EXTRACT-FILE           02680000
026900             ELSE                                                 02690000
027000                 PERFORM B100-COMPARE-FILES                       02700000
027100             END-IF                                               02710000
027200         END-IF                                                   02720000
027300     END-IF.                                                      02730000
027400                                                                  02740000
027500********************                                              02750000
027600 B100-COMPARE-FILES.                                              02760000
027700********************                                              02770000
027800     IF SE001-EMPLOYEE-USER-ID-STD > SE005-ASSOC-USR-ID           02780001
027900         PERFORM X100-BUILD-ID-MGMT-RPT-RECORD                    02790000
028000         ADD 1 TO WS-SE-REC-CNT                                   02800000
028100         PERFORM D050-MOVE-SE-TO-OUTPUT                           02810000
028200         PERFORM D100-WRITE-OUTPUT                                02820000
028300         PERFORM A200-READ-ID-MGMT-EXTRACT-FILE                   02830000
028400     ELSE                                                         02840000
028500         IF SE001-EMPLOYEE-USER-ID-STD < SE005-ASSOC-USR-ID       02850001
028600             PERFORM X200-BUILD-NOTES-RPT-RECORD                  02860000
028700             ADD 1 TO WS-EMAIL-EXTRACT-REC-CNT                    02870001
028800             PERFORM A100-READ-EMAIL-EXTRACT-FILE                 02880001
028900         ELSE                                                     02890000
029000             PERFORM D000-BUILD-OUTPUT-RECORD                     02900000
029100             PERFORM D100-WRITE-OUTPUT                            02910000
029200             PERFORM A100-READ-EMAIL-EXTRACT-FILE                 02920001
029300             PERFORM A200-READ-ID-MGMT-EXTRACT-FILE               02930000
029400         END-IF                                                   02940000
029500     END-IF.                                                      02950000
029600                                                                  02960000
029700                                                                  02970000
029800**************************                                        02980000
029900 D000-BUILD-OUTPUT-RECORD.                                        02990000
030000**************************                                        03000000
030100     IF SE005-EMAIL = SPACES                                      03010000
030200         MOVE SE001-WORK-EMAIL-ADDRESS TO MR-WORK-EMAIL-ADDRESS   03020001
030300     ELSE                                                         03030000
030400         MOVE SE005-EMAIL              TO MR-WORK-EMAIL-ADDRESS   03040000
030500     END-IF.                                                      03050000
030600     MOVE SE001-NAME                   TO MR-EMPLOYEE-NAME.       03060001
030700     MOVE SE005-ASSOC-ID               TO MR-ASSOCIATE-ID.        03070000
030800     MOVE SE005-ASSOC-USR-ID           TO MR-EMPLOYEE-USER-ID.    03080000
030900     MOVE SE001-WORK-PHONE             TO MR-WORK-PHONE.          03090001
031000     MOVE SE005-DEPT-NBR               TO MR-DEPARTMENT.          03100000
031100     MOVE SE005-LOC-NBR                TO MR-LOCATION.            03110000
031200     MOVE SE001-CELL-PHONE             TO MR-CELL-PHONE.          03120001
031300     MOVE SE001-PAGER-PIN              TO MR-PAGER-PIN.           03130001
031400     MOVE SE001-JOB-TITLE              TO MR-JOB-TITLE.           03140001
031500     MOVE SE001-SUPERVISOR             TO MR-SUPERVISOR.          03150001
031600                                                                  03160000
031700                                                                  03170000
031800************************                                          03180000
031900 D050-MOVE-SE-TO-OUTPUT.                                          03190000
032000************************                                          03200000
032100     MOVE SE005-ASSOC-ID           TO MR-ASSOCIATE-ID.            03210000
032200     MOVE SE005-ASSOC-USR-ID       TO MR-EMPLOYEE-USER-ID.        03220000
032300*    MOVE SE005-COMMON-NAME        TO MR-EMPLOYEE-NAME.           03230000
032400     UNSTRING SE005-COMMON-NAME DELIMITED BY ','                  03240000
032500         INTO  WS-NAME-LAST                                       03250000
032600               WS-NAME-FIRST.                                     03260000
032700     MOVE WS-NAME                  TO MR-EMPLOYEE-NAME.           03270000
032800     MOVE SE005-DEPT-NBR           TO MR-DEPARTMENT.              03280000
032900     MOVE SE005-LOC-NBR            TO MR-LOCATION.                03290000
033000     MOVE SE005-EMAIL              TO MR-WORK-EMAIL-ADDRESS.      03300000
033100     MOVE SPACES                   TO MR-WORK-PHONE               03310000
033200                                      MR-CELL-PHONE               03320000
033300                                      MR-JOB-TITLE                03330000
033400                                      MR-PAGER-PIN                03340000
033500                                      MR-SUPERVISOR.              03350000
033600                                                                  03360000
033700                                                                  03370000
033800*******************                                               03380000
033900 D100-WRITE-OUTPUT.                                               03390000
034000*******************                                               03400000
034100     WRITE MERGED-REC FROM MR-MERGED-RECORD.                      03410000
034200                                                                  03420000
034300                                                                  03430000
034400*******************************                                   03440000
034500 X100-BUILD-ID-MGMT-RPT-RECORD.                                   03450000
034600*******************************                                   03460000
034700     INITIALIZE RR-REPORT-RECORD.                                 03470000
034800     MOVE 'RECORD ON ID MGMT BUT NOT ON NOTES: '                  03480000
034900                                        TO RR-MESSAGE.            03490000
035000     MOVE SE005-ASSOC-USR-ID            TO RR-EMPLOYEE-USER-ID.   03500000
035100     MOVE SE005-COMMON-NAME             TO RR-NAME.               03510000
035200     MOVE SE005-LOC-NBR                 TO RR-EMPLOYEE-LOCATION.  03520000
035300     MOVE SE005-ASSOC-ID                TO RR-EMPLOYEE-NUMBER.    03530000
035400     MOVE SE005-DEPT-NBR                TO RR-EMPLOYEE-DEPARTMENT.03540000
035500     PERFORM Y100-WRITE-REPORT-RECORD.                            03550000
035600                                                                  03560000
035700                                                                  03570000
035800*****************************                                     03580000
035900 X200-BUILD-NOTES-RPT-RECORD.                                     03590000
036000*****************************                                     03600000
036100     INITIALIZE RR-REPORT-RECORD.                                 03610000
036200     MOVE 'RECORD ON NOTES BUT NOT ON ID MGMT: '                  03620000
036300                                     TO RR-MESSAGE.               03630001
036400     MOVE ZEROES                     TO RR-EMPLOYEE-NUMBER.       03640001
036500     MOVE SE001-EMPLOYEE-USER-ID-STD TO RR-EMPLOYEE-USER-ID.      03650001
036600     MOVE SE001-JOB-TITLE            TO RR-EMPLOYEE-TITLE.        03660001
036700     MOVE SE001-FIRST-NAME           TO WS-NAME-FIRST.            03670001
036800     MOVE SE001-LAST-NAME            TO WS-NAME-LAST.             03680001
036900     MOVE WS-NAME                    TO RR-NAME.                  03690001
037000     MOVE SE001-LOCATION-NBR         TO RR-EMPLOYEE-LOCATION.     03700001
037100     MOVE SPACES                     TO RR-EMPLOYEE-DEPARTMENT.   03710001
037200     PERFORM Y200-WRITE-REPORT-RECORD.                            03720000
037300                                                                  03730000
037400                                                                  03740000
037500********************************                                  03750000
037600 Y100-WRITE-REPORT-RECORD.                                        03760000
037700********************************                                  03770000
037800     IF WS-LINE-CNT-2 > 60                                        03780000
037900         PERFORM Z200-HEADINGS                                    03790000
038000     END-IF.                                                      03800000
038100     IF IMEF-EOF                                                  03810000
038200         MOVE SPACES TO PRINT-REC-2                               03820000
038300         WRITE PRINT-REC-2                                        03830000
038400             AFTER ADVANCING 1 LINE                               03840000
038500         ADD 1 TO WS-LINE-CNT-2                                   03850000
038600     END-IF.                                                      03860000
038700     WRITE PRINT-REC-2 FROM RR-REPORT-RECORD                      03870000
038800         AFTER ADVANCING 1 LINE.                                  03880000
038900     ADD 1 TO WS-LINE-CNT-2.                                      03890000
039000                                                                  03900000
039100                                                                  03910000
039200********************************                                  03920000
039300 Y200-WRITE-REPORT-RECORD.                                        03930000
039400********************************                                  03940000
039500     IF WS-LINE-CNT > 60                                          03950000
039600         PERFORM Z100-HEADINGS                                    03960000
039700     END-IF.                                                      03970000
039800     IF EEF-EOF                                                   03980001
039900         MOVE SPACES TO PRINT-REC                                 03990000
040000         WRITE PRINT-REC                                          04000000
040100             AFTER ADVANCING 1 LINE                               04010000
040200         ADD 1 TO WS-LINE-CNT                                     04020000
040300     END-IF.                                                      04030000
040400     WRITE PRINT-REC FROM RR-REPORT-RECORD                        04040000
040500         AFTER ADVANCING 1 LINE.                                  04050000
040600     ADD 1 TO WS-LINE-CNT.                                        04060000
040700                                                                  04070000
040800                                                                  04080000
040900*******************                                               04090000
041000 Y900-WRITE-TOTALS.                                               04100000
041100*******************                                               04110000
041200     IF WS-LINE-CNT > 58                                          04120000
041300         PERFORM Z100-HEADINGS                                    04130000
041400     END-IF.                                                      04140000
041500     MOVE SPACES TO PRINT-REC.                                    04150000
041600     MOVE WS-EMAIL-EXTRACT-REC-CNT TO TR2-NOTES-TOTAL.            04160001
041700     WRITE PRINT-REC FROM TR2-TOTAL-RECORD-2                      04170000
041800         AFTER ADVANCING 2 LINES.                                 04180000
041900     MOVE SPACES TO RR-REPORT-RECORD.                             04190000
042000     MOVE '** END OF REPORT **' TO RR-NAME.                       04200000
042100     WRITE PRINT-REC FROM RR-REPORT-RECORD                        04210000
042200         AFTER ADVANCING 1 LINE.                                  04220000
042300                                                                  04230000
042400     IF WS-LINE-CNT-2 > 58                                        04240000
042500         PERFORM Z200-HEADINGS                                    04250000
042600     END-IF.                                                      04260000
042700     MOVE SPACES TO PRINT-REC-2.                                  04270000
042800     MOVE WS-SE-REC-CNT    TO TR1-HR-TOTAL.                       04280000
042900     WRITE PRINT-REC-2 FROM TR1-TOTAL-RECORD-1                    04290000
043000         AFTER ADVANCING 2 LINES.                                 04300000
043100     MOVE SPACES TO RR-REPORT-RECORD.                             04310000
043200     MOVE '** END OF REPORT **' TO RR-NAME.                       04320000
043300     WRITE PRINT-REC-2 FROM RR-REPORT-RECORD                      04330000
043400         AFTER ADVANCING 1 LINE.                                  04340000
043500                                                                  04350000
043600                                                                  04360000
043700***************                                                   04370000
043800 Z100-HEADINGS.                                                   04380000
043900***************                                                   04390000
044000     ADD 1                 TO WS-PAGE-CNT.                        04400000
044100     MOVE 1                TO HL1-RPTNO.                          04410000
044200     MOVE WS-PAGE-CNT      TO HL1-PAGE.                           04420000
044300     MOVE SPACES           TO PRINT-REC.                          04430000
044400     WRITE PRINT-REC FROM HEADING-LINE1                           04440000
044500         AFTER ADVANCING PAGE.                                    04450000
044600     WRITE PRINT-REC FROM HEADING-LINE2                           04460000
044700         AFTER ADVANCING 1 LINE.                                  04470000
044800     WRITE PRINT-REC FROM HEADING-LINE3                           04480000
044900         AFTER ADVANCING 2 LINES.                                 04490000
045000     MOVE SPACES TO PRINT-REC.                                    04500000
045100     WRITE PRINT-REC                                              04510000
045200         AFTER ADVANCING 1 LINE.                                  04520000
045300     MOVE ZEROES TO WS-LINE-CNT.                                  04530000
045400                                                                  04540000
045500                                                                  04550000
045600***************                                                   04560000
045700 Z200-HEADINGS.                                                   04570000
045800***************                                                   04580000
045900     ADD 1                 TO WS-PAGE-CNT-2.                      04590000
046000     MOVE 2                TO HL1-RPTNO.                          04600000
046100     MOVE WS-PAGE-CNT-2    TO HL1-PAGE.                           04610000
046200     MOVE SPACES           TO PRINT-REC-2.                        04620000
046300     WRITE PRINT-REC-2 FROM HEADING-LINE1                         04630000
046400         AFTER ADVANCING PAGE.                                    04640000
046500     WRITE PRINT-REC-2 FROM HEADING-LINE2A                        04650000
046600         AFTER ADVANCING 1 LINE.                                  04660000
046700     WRITE PRINT-REC-2 FROM HEADING-LINE3                         04670000
046800         AFTER ADVANCING 2 LINES.                                 04680000
046900     MOVE SPACES TO PRINT-REC-2.                                  04690000
047000     WRITE PRINT-REC-2                                            04700000
047100         AFTER ADVANCING 1 LINE.                                  04710000
047200     MOVE ZEROES TO WS-LINE-CNT-2.                                04720000
