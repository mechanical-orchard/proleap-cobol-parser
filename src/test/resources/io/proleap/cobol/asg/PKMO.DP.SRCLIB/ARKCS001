000001******************************************************************00000199
000002 IDENTIFICATION DIVISION.                                         00000299
000003******************************************************************00000399
000004                                                                  00000499
000005 PROGRAM-ID.                ARKCS001.                             00000599
000006 AUTHOR.                    RICK TULLOCH.                         00000699
000007 INSTALLATION.              KOHLS DEPARTMENT STORES.              00000799
000008 DATE-WRITTEN.              10-20-86.                             00000899
000009 DATE-COMPILED.                                                   00000999
000010                                                                  00001099
000011******************************************************************00001199
000012*  CICS PROGRAM - ARKCS001 - A001                                *00001299
000013*                                                                *00001399
000014*       ACCOUNTS RECEIVABLE SYSTEM - EMPLOYEE ACCOUNT LIST       *00001499
000015*                                                                *00001599
000016*       THIS PROGRAM ALLOWS A SCROLLABLE LIST OF KOHL'S CHARGE   *00001699
000017*  ACCOUNTS HELD BY EMPLOYEES TO BE DISPLAYED ON THE SCREEN.     *00001799
000018*  THE PROGRAM SUPPORTS THE USE OF PF KEYS TO PAGE THROUGH THE   *00001899
000019*  LIST, BOTH UP (PF7) AND DOWN (PF8) TO PAGE THROUGH THE        *00001999
000020*  ACCOUNTS, AND LEFT (PF10) AND RIGHT (PF11) TO DISPLAY MORE    *00002099
000021*  INFORMATION ON THE CURRENT PAGE OF ACCOUNTS.  A STARTING      *00002199
000022*  ACCOUNT NUMBER CAN ALSO BE SPECIFIED TO ESTABLISH A NEW       *00002299
000023*  POSITION IN THE LISTING WITHOUT HAVING TO PAGE THROUGH IT.    *00002399
000024*  IF THE STARTING ACCOUNT NUMBER DOES NOT EXIST, THE LISTING    *00002499
000025*  WILL BEGIN WITH THE FIRST EMPLOYEE ACCOUNT NUMBER GREATER     *00002599
000026*  THAN THE SPECIFIED NUMBER.                                    *00002699
000027*                                                                *00002799
000028*       FROM THE LIST, ANY INDIVIDUAL EMPLOYEE ACCOUNT CAN BE    *00002899
000029*  SELECTED FOR A SPECIFIC FUNCTION BY USING THE ACTION (ACT)    *00002999
000030*  FIELD NEXT TO THE DESIRED ACCOUNT NUMBER.  VALID ACTIONS FOR  *00003099
000031*  THIS SCREEN ARE:                                              *00003199
000032*                                                                *00003299
000033*            C(HANGE) - THIS BRINGS UP THE EMPLOYEE ACCOUNT      *00003399
000034*                       MAINTENANCE PROGRAM IN CHANGE MODE FOR   *00003499
000035*                       THE SELECTED ACCOUNT.                    *00003599
000036*                                                                *00003699
000037*            D(ELETE) - THIS BRINGS UP THE EMPLOYEE ACCOUNT      *00003799
000038*                       MAINTENANCE PROGRAM IN DELETE MODE FOR   *00003899
000039*                       THE SELECTED ACCOUNT.                    *00003999
000040*                                                                *00004099
000041*            I(NQUIRE) - THIS BRINGS UP THE EMPLOYEE ACCOUNT     *00004199
000042*                        INQUIRY PROGRAM, TO DISPLAY ALL         *00004299
000043*                        INFORMATION RELATED TO THE SELECTED     *00004399
000044*                        ACCOUNT ON A CONSOLIDATED SCREEN.       *00004499
000045*                        OTHER ACCOUNTS CAN BE BROUGHT UP FOR    *00004599
000046*                        INQUIRY WHILE IN THIS MODE.             *00004699
000047*                                                                *00004799
000048*            T(RANSFER) - THIS BRINGS UP THE EMPLOYEE ACCOUNT    *00004899
000049*                         TRANSFER PROGRAM, TO ALLOW ALL         *00004999
000050*                         EMPLOYEE ACCOUNT INFORMATION TO BE     *00005099
000051*                         TRANSFERRED TO A NEW ACCOUNT NUMBER    *00005199
000052*                         (FOR LOST/STOLEN SITUATIONS).          *00005299
000053*                                                                *00005399
000054*       A PF3 FROM THIS SCREEN WILL RETURN CONTROL TO THE        *00005499
000055*  EMPLOYEE DISCOUNT SYSTEM MAIN MENU.                           *00005599
000056*                                                                *00005699
000057*       IF ANY SYSTEM ERRORS ARE DETECTED, THAT THE PROGRAM CAN  *00005799
000058*  NOT RESOLVE, THE EMPLOYEE DISCOUNT SYSTEM WILL BE TERMINATED. *00005899
000059*  THE CURRENT ACTION WILL BE ABORTED, AN ERROR MESSAGE WILL BE  *00005999
000060*  DISPLAYED ON THE SCREEN, AND PROGRAM CONTROL WILL BE RETURNED *00006099
000061*  TO CICS.                                                      *00006199
000062*                                                                *00006299
000063*       DIRECT ENTRY INTO THIS TRANSACTION IS PROHIBITED.        *00006399
000064*  ATTEMPTING TO DO THIS RESULTS IN AN XCTL TO THE EMPLOYEE      *00006499
000065*  DISCOUNT MAIN MENU PROGRAM.                                   *00006599
000066******************************************************************00006699
000067* INC000002127970 - HR_V014_EMP_DISC IS OBSOLETE, USE XS TABLES   00006799
000068******************************************************************00006899
000069* 08/28/2015  COGNIZANT   CHG0125054                              00006999
000070* - CHANGES TO DISPLAY ONLY THE DETAILS OF ACCOUNT NUMBER ENTERED 00007099
000071*   IN SCREEN INSTEAD OF LISTING ALL ACCOUNT NUMBERS STARTING FROM00007199
000072*   ENTERED ACCOUNT NUMBER IN SCREEN.                             00007299
000073* - CHANGES TO DISPLAY THE ACCOUNT NUMBER AND SSN AS CLEAR TEXT   00007399
000074*   FOR USERS WHO HAVE ACCESS TO BOTH ACCOUNT NUMBER AND SSN.     00007499
000075* - CHANGES TO DISPLAY THE ACCOUNT NUMBER AS CLEAR TEXT BUT SSN   00007599
000076*   AS MASKED FOR USERS WHO HAVE ACCESS TO ACCOUNT NUMBER ALONE.  00007699
000077* - CHANGES TO DISPLAY THE SSN AS CLEAR TEXT BUT ACCOUNT NUMBER   00007799
000078*   AS MASKED FOR USERS WHO HAVE ACCESS TO SSN ALONE.             00007899
000079* - FOR ALL THE ABOVE CASES EMPLOYEE NAME WILL BE DISPLAYED AS    00007999
000080*   CLEAR TEXT.                                                   00008099
000086******************************************************************00008699
000087*  - REMOVE XST_ASSOC TABLES USE ART_EMP_TABLE                    00008799
000088******************************************************************00008899
000089* 11/04/2016  CHERI PARMLEY  CHG0168613                           00008999
000090* - XST_ASSOC AND XST_ASSOC_EMPT ARE BEING REMOVED AND THE        00009099
000091*   NEEDED COLUMNS FOR DISPLAYING WILL BE ON THE ART_EMP_DISC     00009199
000092*   TABLE. THIS IS FOR THE PEOPLESOFT TO WORKDAY PROJECT.         00009299
000093* - ALSO REMOVING ART_NON_EMP_DISC TABLE. FOUND THAT THE ENTRIES  00009399
000094* - ON THIS TABLE ARE ACCOUNTED FOR ON THE ART_EMP_DISC TABLE.    00009499
000095******************************************************************00009599
000096* DATE  09/01/2021                                                00009699
000097*            - CHANGE CALL OF DPKUT100 TO                       * 00009799
000098*              CALL DP010I-NUMERIC-EDIT-ROUTINE                 * 00009899
000099*              MAKING THE CALL DYNAMIC VS STATIC                * 00009999
000100*     MADE BY: GERMAN BANDA            WR/IR #: CHG0261053        00010099
000101******************************************************************00010199
000103                                                                  00010399
000104******************************************************************00010499
000105 ENVIRONMENT DIVISION.                                            00010599
000106******************************************************************00010699
000107                                                                  00010799
000108******************************************************************00010899
000109 DATA DIVISION.                                                   00010999
000110******************************************************************00011099
000111 WORKING-STORAGE SECTION.                                         00011100
000113*                                                                 00011300
000114*  SENDING/RECEIVING AREA FOR THE NUMERIC EDIT ROUTINE (DPKUT100) 00011400
000115*                                                                 00011500
000117     COPY DPWS010I.                                               00011700
000118                                                                  00011800
000119*---------------------------------------------------------------* 00011900
000120*    ABEND PROCESSING COPYBOOK.                                 * 00012000
000121*---------------------------------------------------------------* 00012100
000122                                                                  00012200
000123     COPY DPWS013.                                                00012300
000124                                                                  00012400
000125*---------------------------------------------------------------* 00012500
000126*  VARIABLES TO CONVERT FROM BASE64 TO BINARY & VICE VERSA      * 00012600
000127*---------------------------------------------------------------* 00012700
000128     COPY DPWS022.                                                00012800
000129                                                                  00012900
000130*---------------------------------------------------------------* 00013000
000131*  VARIABLES TO CONVERT FROM ASCII TO EBCDIC & VICE VERSA       * 00013100
000132*---------------------------------------------------------------* 00013200
000133     COPY DPWS053.                                                00013300
000134                                                                  00013400
000135*---------------------------------------------------------------* 00013500
000136* LAYOUT FOR THE PARAMETERS NEEDED TO INVOKE PROTEGRITY MODULE  * 00013600
000137*---------------------------------------------------------------* 00013700
000138     COPY PTYCCSIP.                                               00013800
000139                                                                  00013900
000140*---------------------------------------------------------------* 00014000
000141* LAYOUT FOR THE WORKING VARIABLES TO INVOKE PROTEGRITY MODULE  * 00014100
000142*---------------------------------------------------------------* 00014200
000143     COPY DPWS031.                                                00014300
000144                                                                  00014400
000145*---------------------------------------------------------------* 00014500
000146* LAYOUT FOR THE WORKING VARIABLES USED IN THE DPPD013 MODULE   * 00014600
000147*---------------------------------------------------------------* 00014700
000148                                                                  00014800
000149     COPY DPWS020.                                                00014900
000150                                                                  00015000
000151*----------------------------------------------------------------*00015100
000152*    SECURITY SUBROUTINE.                                        *00015200
000153*----------------------------------------------------------------*00015300
000154     COPY DPWS008.                                                00015400
000155*                                                                 00015500
000156*  STANDARD ATTENTION IDENTIFIER LIST                             00015600
000157*                                                                 00015700
000158     COPY DFHAID.                                                 00015800
000159                                                                  00015900
000160*                                                                 00016000
000161*  STANDARD ATTRIBUTE AND PRINTER CONTROL CHARACTER LIST          00016100
000162*                                                                 00016200
000163     COPY DFHBMSCA.                                               00016300
000164                                                                  00016400
000165 01 PS-PROGRAM-SWITCHES.                                          00016500
000166    05 PS-EDIT-ERROR-IND            PIC X(1)  VALUE 'N'.          00016600
000167       88 PS-NO-EDIT-ERROR                    VALUE 'N'.          00016700
000168       88 PS-EDIT-ERROR                       VALUE 'Y'.          00016800
000169    05 PS-END-OF-EMPLOYEE-FILE-IND                                00016900
000170                                    PIC X(1)  VALUE 'N'.          00017000
000171       88 PS-NOT-END-OF-EMPLOYEE-FILE         VALUE 'N'.          00017100
000172       88 PS-END-OF-EMPLOYEE-FILE             VALUE 'Y'.          00017200
000173    05 PS-START-BROWSE-IND          PIC X(1)  VALUE 'N'.          00017300
000174       88 PS-SUCCESSFUL-START-BROWSE          VALUE 'Y'.          00017400
000175       88 PS-UNSUCCESSFUL-START-BROWSE        VALUE 'N'.          00017500
000176    05 PS-SQL-ACTION-TEXT           PIC X(11) VALUE SPACES.       00017600
000177       88 PS-SELECT-TEXT                      VALUE 'SELECT'.     00017700
000178       88 PS-CURSOR-OPEN-TEXT                 VALUE 'OPEN CURSOR'.00017800
000179       88 PS-CURSOR-CLOSE-TEXT                VALUE 'CLOSE CURSR'.00017900
000180       88 PS-FETCH-TEXT                       VALUE 'FETCH'.      00018000
000181    05 PS-FETCH-ROWS-SWITCH         PIC X(01) VALUE 'N'.          00018100
000182       88 PS-NO-MORE-ROWS                     VALUE 'Y'.          00018200
000183       88 PS-MORE-ROWS                        VALUE 'N'.          00018300
000184    05 PS-DETAIL-FOUND-IN-VW        PIC X(01) VALUE 'N'.          00018400
000185       88 PS-DTL-FOUND-VW                     VALUE 'Y'.          00018500
000186       88 PS-DTL-NOT-FOUND-VW                 VALUE 'N'.          00018600
000187    05 PS-DETAIL-FOUND-IN-TBL       PIC X(01) VALUE 'N'.          00018700
000188       88 PS-DTL-FOUND-TBL                    VALUE 'Y'.          00018800
000189       88 PS-DTL-NOT-FOUND-TBL                VALUE 'N'.          00018900
000190    05 PS-READ-SUCCESS              PIC X(01) VALUE 'N'.          00019000
000191       88 PS-SUCCESSFUL-READ                  VALUE 'Y'.          00019100
000192       88 PS-NO-SUCCESSFUL-READ               VALUE 'N'.          00019200
000199                                                                  00019900
000200 01 PC-PROGRAM-CONSTANTS.                                         00020000
000201    05 PC-SUCCESSFUL-SQLCODE        PIC S9(9) VALUE ZEROS         00020100
000202                                              COMP SYNC.          00020200
000203    05 PC-ROW-NOT-FOUND-SQLCODE     PIC S9(9) VALUE +100          00020300
000204                                              COMP SYNC.          00020400
000205    05 PC-DUPLICATE-ROW-SQLCODE     PIC S9(9) VALUE -803          00020500
000206                                              COMP SYNC.          00020600
000207    05 PC-CURRENT-PROGRAM-NAME      PIC X(8)  VALUE 'ARKCS001'.   00020700
000208    05 PC-MAIN-MENU-PROGRAM-NAME                                  00020800
000209                                    PIC X(8)  VALUE 'ARKCS000'.   00020900
000210    05 PC-MAINTENANCE-PROGRAM-NAME                                00021000
000211                                    PIC X(8)  VALUE 'ARKCS002'.   00021100
000212    05 PC-INQUIRY-PROGRAM-NAME      PIC X(8)  VALUE 'ARKCS008'.   00021200
000213    05 PC-ACCT-TRANSFER-PROGRAM-NAME                              00021300
000214                                    PIC X(8)  VALUE 'ARKCS010'.   00021400
000216    05 PC-LEAVE-SYSTEM-LENGTH       PIC S9(4) VALUE +160          00021600
000217                                              COMP SYNC.          00021700
000218    05 PC-COMMON-AREA-LENGTH        PIC S9(4) VALUE +190          00021800
000219                                              COMP SYNC.          00021900
000220    05 PC-TRANSFER-UP-LENGTH        PIC S9(4) VALUE +29           00022000
000221                                              COMP SYNC.          00022100
000222    05 PC-TRANSFER-DOWN-LENGTH      PIC S9(4) VALUE +29           00022200
000223                                              COMP SYNC.          00022300
000224    05 PC-MAXIMUM-SCREEN-ENTRIES    PIC S9(4) VALUE +14           00022400
000225                                              COMP SYNC.          00022500
000226    05 PC-FIRST-SCREEN-NUMBER       PIC S9(4) VALUE +1            00022600
000227                                              COMP SYNC.          00022700
000228    05 PC-LAST-SCREEN-NUMBER        PIC S9(4) VALUE +6            00022800
000229                                              COMP SYNC.          00022900
000230    05 PC-EOF-KEYED-COMP            PIC S9(4) VALUE +128          00023000
000231                                              COMP SYNC.          00023100
000232    05 FILLER                  REDEFINES PC-EOF-KEYED-COMP.       00023200
000233       10  FILLER                   PIC X(1).                     00023300
000234       10  PC-EOF-KEYED             PIC X(1).                     00023400
000235    05 PC-SELECT-ACTION             PIC X(1)  VALUE 'S'.          00023500
000236    05 PC-INQUIRE-ACTION            PIC X(1)  VALUE 'I'.          00023600
000237    05 PC-TRANSFER-ACTION           PIC X(1)  VALUE 'T'.          00023700
000238                                                                  00023800
000239 01 PV-PROGRAM-VARIABLES.                                         00023900
000240    05 PV-LAST-ACCOUNT-NUMBER       PIC X(10) VALUE HIGH-VALUES.  00024000
000241    05 PV-LEAVE-SYSTEM-MESSAGE      PIC X(238) VALUE SPACES.      00024100
000242    05 PV-CITY-NAME                 PIC X(22) VALUE SPACES.       00024200
000243    05 PV-CICS-RESPONSE             PIC S9(9) VALUE ZERO          00024300
000244                                              COMP SYNC.          00024400
000245    05 PV-SQL-TABLE-NAME            PIC X(16) VALUE SPACES.       00024500
000246    05 PV-DISPLAY-KEY               PIC X(10) VALUE SPACES.       00024600
000247    05 PV-HOLD-ACCT-NBR             PIC X(10) VALUE SPACES.       00024700
000248    05 PV-TEMP-HOLD-DTE.                                          00024800
000249       10 PV-TEMP-HOLD-MONTH        PIC X(02).                    00024900
000250       10 FILLER                    PIC X(01) VALUE "/".          00025000
000251       10 PV-TEMP-HOLD-DAY          PIC X(02).                    00025100
000252       10 FILLER                    PIC X(01) VALUE "/".          00025200
000253       10 PV-TEMP-HOLD-YR           PIC X(02).                    00025300
000254    05 PV-INPUT-TEXT                PIC X(88) VALUE SPACES.       00025400
000255    05 PV-OUTPUT-TEXT               PIC X(66) VALUE SPACES.       00025500
000256    05 PV-ACCOUNT-NBR-12.                                         00025600
000257       10 PV-ACCOUNT-NBR-10         PIC X(10) VALUE SPACES.       00025700
000258       10 FILLER                    PIC X(02) VALUE '00'.         00025800
000259    05 PV-INPUT-LEN                 PIC 9(09) VALUE ZEROES.       00025900
000260    05 PV-ACCT-COUNT                PIC 9(05) VALUE ZEROES.       00026000
000261                                                                  00026100
000262 01 SE-SYSTEM-ERROR-MESSAGE.                                      00026200
000263    05 FILLER                       PIC X(43) VALUE               00026300
000264       'A SYSTEM ERROR HAS OCCURRED - CONTACT DP - '.             00026400
000265    05 FILLER                       PIC X(33) VALUE               00026500
000266       'PROGRAM ARKCS001       EIBRESP = '.                       00026600
000267    05 SE-CICS-RESPONSE             PIC 9(4)  VALUE ZERO.         00026700
000268    05 FILLER                       PIC X(5)  VALUE SPACES.       00026800
000269    05 FILLER                       PIC X(14) VALUE               00026900
000270       'ATTEMPTING TO '.                                          00027000
000271    05 SE-ATTEMPTED-ACTION          PIC X(61) VALUE SPACES.       00027100
000272                                                                  00027200
000273 01 FA-FORMATTED-ACCOUNT-NUMBER.                                  00027300
000274    05 FA-ACCOUNT-NUMBER-1-3        PIC X(3)  VALUE SPACES.       00027400
000275    05 FILLER                       PIC X(1)  VALUE '-'.          00027500
000276    05 FA-ACCOUNT-NUMBER-4-6        PIC X(3)  VALUE SPACES.       00027600
000277    05 FILLER                       PIC X(1)  VALUE '-'.          00027700
000278    05 FA-ACCOUNT-NUMBER-7-9        PIC X(3)  VALUE SPACES.       00027800
000279    05 FILLER                       PIC X(1)  VALUE '-'.          00027900
000280    05 FA-ACCOUNT-NUMBER-10         PIC X(1)  VALUE SPACES.       00028000
000291                                                                  00029100
000292 01 ST-SYSTEM-TIME-AREA.                                          00029200
000293    05 ST-ABSTIME                   PIC S9(18) VALUE ZERO         00029300
000294                                               COMP SYNC.         00029400
000295    05 ST-TIME-EDIT.                                              00029500
000296       10 ST-TIME-HHMM              PIC X(5)   VALUE SPACES.      00029600
000297       10 FILLER                    PIC X(3)   VALUE SPACES.      00029700
000298                                                                  00029800
000299 01 ED-EMP-DISC-DETAIL-DATA.                                      00029900
000300    05 ED-SSN-NBR                   PIC X(20).                    00030000
000301    05 ED-EMP-STAT-CDE              PIC X(01).                    00030100
000302    05 ED-STR-NBR.                                                00030200
000303       10 FILLER                    PIC X(06).                    00030300
000304       10 ED-STORE-NBR-4            PIC X(04).                    00030499
000306    05 ED-EMP-TYP-CDE               PIC X(01).                    00030699
000307    05 ED-EMP-NM                    PIC X(88).                    00030799
000308    05 ED-DISC-DTE                  PIC X(10).                    00030899
000309    05 ED-TERM-DTE                  PIC X(10).                    00030999
000310    05 ED-ACTN-CDE                  PIC X(03).                    00031099
000311                                                                  00031199
000312 01 CA-COMMON-AREA.                                               00031299
000313    05 CA-COMMON-DATA.                                            00031399
000314       10 CA-TRANSACTION-STATUS     PIC X(1)  VALUE SPACES.       00031499
000315          88 CA-INITIALIZE-SCREEN             VALUE 'S'.          00031599
000316          88 CA-PROCESS-SCREEN                VALUE 'R'.          00031699
000317       10 CA-LAST-PROGRAM-NAME                                    00031799
000318                                    PIC X(8)  VALUE SPACES.       00031899
000319       10 CA-LAST-ACTION-STATUS     PIC X(1)  VALUE SPACES.       00031999
000320           88  CA-RESET-LAST-ACTION-STATUS    VALUE ' '.          00032099
000321           88  CA-LAST-ACTION-SUCCESSFUL      VALUE 'S'.          00032199
000322           88  CA-LAST-ACTION-ABORTED         VALUE 'A'.          00032299
000323       10 CA-SELECTION-X            PIC X(2)  VALUE SPACES.       00032399
000324       10 CA-SELECTION REDEFINES CA-SELECTION-X                   00032499
000325                                    PIC 9(2).                     00032599
000326       10 CA-ACTION                 PIC X(1)  VALUE SPACES.       00032699
000327          88  CA-NO-ACTION-SPECIFIED          VALUE ' '.          00032799
000328          88  CA-CHANGE-ACTION                VALUE 'C'.          00032899
000329          88  CA-DELETE-ACTION                VALUE 'D'.          00032999
000330          88  CA-TRANSFER-ACTION              VALUE 'T'.          00033099
000331       10 CA-ACCOUNT-NUMBER-X       PIC X(10) VALUE SPACES.       00033199
000332       10 CA-ACCOUNT-NUMBER REDEFINES CA-ACCOUNT-NUMBER-X         00033299
000333                                    PIC 9(10).                    00033399
000334       10 CA-DEPARTMENT-X           PIC X(3)  VALUE SPACES.       00033499
000335       10 CA-DEPARTMENT REDEFINES CA-DEPARTMENT-X                 00033599
000336                                    PIC 9(3).                     00033699
000337       10 CA-ACCT-ACCESS      PIC X(1)     VALUE SPACES.          00033799
000338          88 CA-ACCT-ACCESS-YES            VALUE 'Y'.             00033899
000339          88 CA-ACCT-ACCESS-NO             VALUE 'N'.             00033999
000340       10 CA-SSN-ACCESS       PIC X(1)     VALUE SPACES.          00034099
000341          88 CA-SSN-ACCESS-YES             VALUE 'Y'.             00034199
000342          88 CA-SSN-ACCESS-NO              VALUE 'N'.             00034299
000343       10 CA-TOKEN-ACCT-IND   PIC X(1)     VALUE SPACES.          00034399
000344          88 CA-TOKEN-ACCT-YES             VALUE 'Y'.             00034499
000345          88 CA-TOKEN-ACCT-NO              VALUE 'N'.             00034599
000346    05 CA-PROGRAM-DATA.                                           00034699
000347       10 CA-SCREEN-NUMBER          PIC 9(1)  VALUE ZERO.         00034799
000348       10 CA-PREVIOUS-ACCOUNT-NUMBER                              00034899
000349                                    PIC X(10) VALUE SPACES.       00034999
000350       10 CA-NEXT-ACCOUNT-NUMBER                                  00035099
000351                                    PIC X(10) VALUE SPACES.       00035199
000352       10 CA-SCREEN-ACCOUNT-NUMBER                                00035299
000353                              OCCURS 14 TIMES                     00035399
000354                              INDEXED BY CA-ACCOUNT-INDEX         00035499
000355                                 PIC X(10).                       00035599
000356                                                                  00035699
000357 01 HL-HEADING-LINE-DATA.                                         00035799
000358    05 FILLER                       PIC X(59) VALUE               00035899
000359       'DISCOUNT STATUS  CRS CODE  EMPLOYEE NAME'.                00035999
000360    05 FILLER                       PIC X(59) VALUE               00036099
000361       'SOCIAL SECURITY NUMBER  STORE NUMBER'.                    00036199
000362    05 FILLER                       PIC X(59) VALUE               00036299
000363       'DISCOUNT EFF  TERMINATION EFF  LAST CHANGE       '.       00036399
000364    05 FILLER                       PIC X(59) VALUE               00036499
000365       'ACCOUNT NOTES - LINE 1'.                                  00036599
000366    05 FILLER                       PIC X(59) VALUE               00036699
000367       'ACCOUNT NOTES - LINE 2'.                                  00036799
000368                                                                  00036899
000369 01 HL-HEADING-LINE-TABLE REDEFINES HL-HEADING-LINE-DATA.         00036999
000370    05 HL-HEADING-LINE OCCURS 6 TIMES                             00037099
000371                                 INDEXED BY HL-HEADING-INDEX      00037199
000372                                    PIC X(59).                    00037299
000373                                                                  00037399
000374 01 DL-DETAIL-LINE-AREA.                                          00037499
000375    05 DL-DETAIL-LINE               PIC X(59) VALUE SPACES.       00037599
000376    05 FILLER REDEFINES DL-DETAIL-LINE.                           00037699
000377       10 FILLER                    PIC X(7).                     00037799
000378       10 DL-EMPLOYEE-DISC-STATUS                                 00037899
000379                                    PIC X(1).                     00037999
000380       10 FILLER                    PIC X(13).                    00038099
000381       10 DL-CRS-EMPLOYEE-CODE      PIC X(1).                     00038199
000382       10 FILLER                    PIC X(5).                     00038299
000383       10 DL-EMPLOYEE-NAME          PIC X(30).                    00038399
000384       10 FILLER                    PIC X(2).                     00038499
000385    05 FILLER REDEFINES DL-DETAIL-LINE.                           00038599
000386       10 FILLER                    PIC X(6).                     00038699
000387       10 DL-SOC-SEC-NUMBER-1-3     PIC X(3).                     00038799
000388       10 DL-SOC-SEC-DASH-1         PIC X(1).                     00038899
000389       10 DL-SOC-SEC-NUMBER-4-5     PIC X(2).                     00038999
000390       10 DL-SOC-SEC-DASH-2         PIC X(1).                     00039099
000391       10 DL-SOC-SEC-NUMBER-6-9     PIC X(4).                     00039199
000392       10 FILLER                    PIC X(12).                    00039299
000393       10 DL-STORE-NUMBER           PIC 9(4).                     00039399
000395       10 FILLER                    PIC X(26).                    00039599
000396    05 FILLER REDEFINES DL-DETAIL-LINE.                           00039699
000397       10 DL-DATE-DISCOUNT-EFFECTIVE.                             00039799
000398          15 DL-DISC-EFF-MONTH        PIC X(02).                  00039899
000399          15 FILLER                   PIC X(01).                  00039999
000400          15 DL-DISC-EFF-DAY          PIC X(02).                  00040099
000401          15 FILLER                   PIC X(01).                  00040199
000402          15 DL-DISC-EFF-YR           PIC X(02).                  00040299
000403       10 FILLER                    PIC X(8).                     00040399
000404       10 DL-DATE-TERMINATION-EFFECTIVE.                          00040499
000405          15 DL-DISC-TERM-MONTH       PIC X(02).                  00040599
000406          15 FILLER                   PIC X(01).                  00040699
000407          15 DL-DISC-TERM-DAY         PIC X(02).                  00040799
000408          15 FILLER                   PIC X(01).                  00040899
000409          15 DL-DISC-TERM-YR          PIC X(02).                  00040999
000410       10 FILLER                    PIC X(07).                    00041099
000411       10 DL-DATE-LAST-CHANGED      PIC X(10).                    00041199
000412       10 FILLER                    PIC X(18).                    00041299
000413    05 FILLER REDEFINES DL-DETAIL-LINE.                           00041399
000414       10 DL-ACCOUNT-NOTES-1        PIC X(40).                    00041499
000415       10 FILLER                    PIC X(19).                    00041599
000416    05 FILLER REDEFINES DL-DETAIL-LINE.                           00041699
000417       10 DL-ACCOUNT-NOTES-2        PIC X(40).                    00041799
000418       10 FILLER                    PIC X(19).                    00041899
000419                                                                  00041999
000420 01 PM-PROGRAM-MESSAGE-DATA.                                      00042099
000421    05 FILLER                       PIC X(48) VALUE               00042199
000422       '                                                '.        00042299
000423    05 FILLER                       PIC X(48) VALUE               00042399
000424       '**  TOP OF LIST  **                             '.        00042499
000425    05 FILLER                       PIC X(48) VALUE               00042599
000426       '**  BOTTOM OF LIST  **                          '.        00042699
000427    05 FILLER                       PIC X(48) VALUE               00042799
000428       'UNKNOWN PF KEY ENTERED                          '.        00042899
000429    05 FILLER                       PIC X(48) VALUE               00042999
000430       'LAST ACTION ABORTED                             '.        00043099
000431    05 FILLER                       PIC X(48) VALUE               00043199
000432       'EMPLOYEE ACCOUNT CHANGED                        '.        00043299
000433    05 FILLER                       PIC X(48) VALUE               00043399
000434       'EMPLOYEE ACCOUNT DELETED                        '.        00043499
000435    05 FILLER                       PIC X(48) VALUE               00043599
000436       'EMPLOYEE ACCOUNT TRANSFERRED                    '.        00043699
000437    05 FILLER                       PIC X(48) VALUE               00043799
000438       'ACCOUNT NUMBER NOT FOUND                        '.        00043899
000439                                                                  00043999
000440 01 PM-PROGRAM-MESSAGE-TABLE REDEFINES PM-PROGRAM-MESSAGE-DATA.   00044099
000441    05 PM-PROGRAM-MESSAGE    OCCURS 9 TIMES                       00044199
000442                             INDEXED BY PM-MESSAGE-INDEX          00044299
000443                             PIC X(48).                           00044399
000444                                                                  00044499
000445 01 FD-FILE-DDNAME-AREA.                                          00044599
000446    05 FD-EMPLOYEE-FILE             PIC X(8)   VALUE 'AREMPDIS'.  00044699
000447                                                                  00044799
000448 01 DE-DB2-ERROR-MESSAGE.                                         00044899
000449    05 FILLER                       PIC X(40)  VALUE              00044999
000450       'A DB2 ERROR HAS OCCURRED - CONTACT DP - '.                00045099
000451    05 FILLER                       PIC X(45)  VALUE              00045199
000452       'PROGRAM ARKCS001'.                                        00045299
000453    05 FILLER                       PIC X(11)  VALUE              00045399
000454       'SQLCODE = ('.                                             00045499
000455    05 DE-SQLCODE                   PIC Z(8)9- VALUE ZEROES.      00045599
000456    05 FILLER                       PIC X(21)  VALUE              00045699
000457       ')  ROWS PROCESSED = ('.                                   00045799
000458    05 DE-ROWS-PROCESSED            PIC Z(8)9- VALUE ZEROES.      00045899
000459    05 FILLER                       PIC X(28)  VALUE ')'.         00045999
000460    05 FILLER                       PIC X(14)  VALUE              00046099
000461       'ATTEMPTING TO '.                                          00046199
000462    05 DE-ATTEMPTED-ACTION          PIC X(61)  VALUE SPACES.      00046299
000463                                                                  00046399
000464 01 DW-DB2-WARNING-MESSAGE.                                       00046499
000465    05 FILLER                       PIC X(42)  VALUE              00046599
000466         'A DB2 WARNING HAS OCCURRED - CONTACT DP - '.            00046699
000467    05 FILLER                       PIC X(43)  VALUE              00046799
000468         'PROGRAM ARKCS002'.                                      00046899
000469    05 FILLER                       PIC X(11)  VALUE              00046999
000470         'SQLCODE = ('.                                           00047099
000471    05 DW-SQLCODE                   PIC Z(8)9- VALUE ZEROES.      00047199
000472    05 FILLER                       PIC X(21)  VALUE              00047299
000473         ')  ROWS PROCESSED = ('.                                 00047399
000474    05 DW-ROWS-PROCESSED            PIC Z(8)9- VALUE ZEROES.      00047499
000475    05 FILLER                       PIC X(14)  VALUE              00047599
000476         ')  SQLWARN = ('.                                        00047699
000477    05 DW-SQLWARN                   PIC X(8)   VALUE SPACES.      00047799
000478    05 FILLER                       PIC X(6)   VALUE ')'.         00047899
000479    05 FILLER                       PIC X(14)  VALUE              00047999
000480         'ATTEMPTING TO '.                                        00048099
000481    05 DW-ATTEMPTED-ACTION          PIC X(61)  VALUE SPACES.      00048199
000482                                                                  00048299
000483******************************************************************00048399
000484*  ** NOTE **                                                     00048499
000485*      THE FOLLOWING IS A REDEFINITION OF THE ARKM001 DSECT.      00048599
000486*  ANY CHANGES TO THE DSECT MUST ALSO BE REFLECTED IN THIS        00048699
000487*  REDEFINITION.  LENGTH FIELDS ARE DEFINED AS COMP, NOT COMP     00048799
000488*  SYNC, IN THE GENERATED DSECT, AND SO ARE DEFINED AS COMP HERE. 00048899
000489******************************************************************00048999
000490 01 AR001AI.                                                      00049099
000491    05 FILLER                  PIC X(12)    VALUE SPACES.         00049199
000492    05 ADATEL                  PIC S9(4)    VALUE ZERO   COMP.    00049299
000493    05 ADATEA                  PIC X(1)     VALUE SPACES.         00049399
000494    05 FILLER                  PIC X(1)     VALUE SPACES.         00049499
000495    05 ADATEI                  PIC X(8)     VALUE SPACES.         00049599
000496    05 ATERML                  PIC S9(4)    VALUE ZERO   COMP.    00049699
000497    05 ATERMA                  PIC X(1)     VALUE SPACES.         00049799
000498    05 FILLER                  PIC X(1)     VALUE SPACES.         00049899
000499    05 ATERMI                  PIC X(4)     VALUE SPACES.         00049999
000500    05 ATIMEL                  PIC S9(4)    VALUE ZERO   COMP.    00050099
000501    05 ATIMEA                  PIC X(1)     VALUE SPACES.         00050199
000502    05 FILLER                  PIC X(1)     VALUE SPACES.         00050299
000503    05 ATIMEI                  PIC X(5)     VALUE SPACES.         00050399
000504    05 ASTACCTL                PIC S9(4)    VALUE ZERO   COMP.    00050499
000505    05 ASTACCTA                PIC X(1)     VALUE SPACES.         00050599
000506    05 FILLER                  PIC X(1)     VALUE SPACES.         00050699
000507    05 ASTACCTI                PIC X(10)    VALUE SPACES.         00050799
000508    05 AHEADL                  PIC S9(4)    VALUE ZERO   COMP.    00050899
000509    05 AHEADA                  PIC X(1)     VALUE SPACES.         00050999
000510    05 FILLER                  PIC X(1)     VALUE SPACES.         00051099
000511    05 AHEADI                  PIC X(59)    VALUE SPACES.         00051199
000512    05 AINQUIRYIN OCCURS 14 TIMES                                 00051299
000513                  INDEXED AI-ACCOUNT-INDEX.                       00051399
000514       10 AACTL                PIC S9(4)                 COMP.    00051499
000515       10 AACTA                PIC X(1).                          00051599
000516       10 FILLER               PIC X(1).                          00051699
000517       10 AACTI                PIC X(1).                          00051799
000518       10 AACCTL               PIC S9(4)                 COMP.    00051899
000519       10 AACCTA               PIC X(1).                          00051999
000520       10 FILLER               PIC X(1).                          00052099
000521       10 AACCTI               PIC X(13).                         00052199
000522       10 ADETLL               PIC S9(4)                 COMP.    00052299
000523       10 ADETLA               PIC X(1).                          00052399
000524       10 FILLER               PIC X(1).                          00052499
000525       10 ADETLI               PIC X(59).                         00052599
000526    05 AMSGL                   PIC S9(4)    VALUE ZERO   COMP.    00052699
000527    05 AMSGA                   PIC X(1)     VALUE SPACES.         00052799
000528    05 FILLER                  PIC X(1)     VALUE SPACES.         00052899
000529    05 AMSGI                   PIC X(79)    VALUE SPACES.         00052999
000530                                                                  00053099
000531 01 AR001AO REDEFINES AR001AI.                                    00053199
000532    05 FILLER                  PIC X(12).                         00053299
000533    05 FILLER                  PIC X(3).                          00053399
000534    05 ADATEH                  PIC X(1).                          00053499
000535    05 ADATEO                  PIC X(8).                          00053599
000536    05 FILLER                  PIC X(3).                          00053699
000537    05 ATERMH                  PIC X(1).                          00053799
000538    05 ATERMO                  PIC X(4).                          00053899
000539    05 FILLER                  PIC X(3).                          00053999
000540    05 ATIMEH                  PIC X(1).                          00054099
000541    05 ATIMEO                  PIC X(5).                          00054199
000542    05 FILLER                  PIC X(3).                          00054299
000543    05 ASTACCTH                PIC X(1).                          00054399
000544    05 ASTACCTO                PIC X(10).                         00054499
000545    05 FILLER                  PIC X(3).                          00054599
000546    05 AHEADH                  PIC X(1).                          00054699
000547    05 AHEADO                  PIC X(59).                         00054799
000548    05 AINQUIRYOUT OCCURS 14 TIMES                                00054899
000549                   INDEXED BY AO-ACCOUNT-INDEX.                   00054999
000550       10 FILLER               PIC X(3).                          00055099
000551       10 AACTH                PIC X(1).                          00055199
000552       10 AACTO                PIC X(1).                          00055299
000553       10 FILLER               PIC X(3).                          00055399
000554       10 AACCTH               PIC X(1).                          00055499
000555       10 AACCTO               PIC X(13).                         00055599
000556       10 FILLER               PIC X(3).                          00055699
000557       10 ADETLH               PIC X(1).                          00055799
000558       10 ADETLO               PIC X(59).                         00055899
000559    05 FILLER                  PIC X(3).                          00055999
000560    05 AMSGH                   PIC X(1).                          00056099
000561    05 AMSGO                   PIC X(79).                         00056199
000562                                                                  00056299
000568*                                                                 00056800
000569* EMPLOYEE DISCOUNT TABLE                                         00056900
000570*                                                                 00057000
000571     EXEC SQL                                                     00057100
000572        INCLUDE ART00001                                          00057200
000573     END-EXEC.                                                    00057300
000574                                                                  00057400
000588                                                                  00058800
000589 01 INDICATOR-VARIABLES.                                          00058900
000590    05 IND-ART00001-CMNT-TXT        PIC S9(4)  VALUE ZEROS COMP.  00059000
000591    05 IND-ED-DISC-DATE             PIC S9(4)  VALUE ZEROS COMP.  00059100
000592    05 IND-ED-TERM-DATE             PIC S9(4)  VALUE ZEROS COMP.  00059200
000593                                                                  00059300
000594*-----------------------------------------------------------      00059400
000595* CURSORS USED IN READS                                           00059500
000596*-----------------------------------------------------------      00059600
000597*EMP_ID CURSOR DECLARE                                            00059700
000598     EXEC SQL                                                     00059800
000599         DECLARE EMP_CSR CURSOR FOR                               00059900
000600            SELECT  ACCT_NBR                                      00060000
000601                   ,EMP_ID                                        00060100
000602                   ,LAST_UPD_DTE                                  00060200
000603                   ,CMNT_TXT                                      00060300
000604                   ,SSN_NBR                                       00060499
000605                   ,EMP_NM                                        00060599
000606                   ,EMP_STAT_CDE                                  00060699
000607                   ,EMP_TYP_CDE                                   00060799
000608                   ,LOC_NBR                                       00060899
000609                   ,DISC_DTE                                      00060999
000610                   ,TERM_DTE                                      00061099
000611              FROM ART_EMP_DISC                                   00061100
000612             WHERE ACCT_NBR = :ART00001-ACCT-NBR                  00061200
000627         ORDER BY 1                                               00062700
000628     END-EXEC.                                                    00062800
000630                                                                  00063000
000639*                                                                 00063900
000640*  STANDARD LAYOUT FOR THE SQL COMMUNICATIONS AREA                00064000
000641*                                                                 00064100
000642     EXEC SQL                                                     00064200
000643        INCLUDE SQLCA                                             00064300
000644     END-EXEC.                                                    00064400
000645                                                                  00064500
000646******************************************************************00064600
000647 LINKAGE SECTION.                                                 00064700
000648******************************************************************00064800
000649 01 DFHCOMMAREA.                                                  00064900
000650    05 LS-COMMON-DATA.                                            00065000
000651       10 LS-TRANSACTION-STATUS     PIC X(1).                     00065100
000652          88 LS-INITIALIZE-SCREEN              VALUE 'S'.         00065200
000653          88 LS-PROCESS-SCREEN                 VALUE 'R'.         00065300
000654       10 LS-LAST-PROGRAM-NAME      PIC X(8).                     00065400
000655       10 LS-LAST-ACTION-STATUS     PIC X(1).                     00065500
000656       10 LS-SELECTION-X            PIC X(2).                     00065600
000657       10 LS-SELECTION REDEFINES                                  00065700
000658          LS-SELECTION-X            PIC 9(2).                     00065800
000659       10 LS-ACTION                 PIC X(1).                     00065900
000660          88 LS-NO-ACTION-SPECIFIED            VALUE ' '.         00066000
000661          88 LS-CHANGE-ACTION                  VALUE 'C'.         00066100
000662          88 LS-DELETE-ACTION                  VALUE 'D'.         00066200
000663          88 LS-TRANSFER-ACTION                VALUE 'T'.         00066300
000664       10 LS-ACCOUNT-NUMBER-X       PIC X(10).                    00066400
000665       10 LS-ACCOUNT-NUMBER REDEFINES                             00066500
000666          LS-ACCOUNT-NUMBER-X       PIC 9(10).                    00066600
000667       10 LS-DEPARTMENT-X           PIC X(3).                     00066700
000668       10 LS-DEPARTMENT REDEFINES                                 00066800
000669          LS-DEPARTMENT-X           PIC 9(3).                     00066900
000670       10 LS-ACCT-ACCESS      PIC X(1).                           00067000
000671          88 LS-ACCT-ACCESS-YES            VALUE 'Y'.             00067100
000672          88 LS-ACCT-ACCESS-NO             VALUE 'N'.             00067200
000673       10 LS-SSN-ACCESS       PIC X(1).                           00067300
000674          88 LS-SSN-ACCESS-YES             VALUE 'Y'.             00067400
000675          88 LS-SSN-ACCESS-NO              VALUE 'N'.             00067500
000676       10 LS-TOKEN-ACCT-IND   PIC X(1).                           00067600
000677          88 LS-TOKEN-ACCT-YES             VALUE 'Y'.             00067700
000678          88 LS-TOKEN-ACCT-NO              VALUE 'N'.             00067800
000679    05 LS-PROGRAM-DATA.                                           00067900
000680       10 LS-SCREEN-NUMBER    PIC 9(1).                           00068000
000681       10 LS-PREVIOUS-ACCOUNT-NUMBER                              00068100
000682                              PIC X(10).                          00068200
000683       10 LS-NEXT-ACCOUNT-NUMBER                                  00068300
000684                              PIC X(10).                          00068400
000685       10 LS-SCREEN-ACCOUNT-NUMBER                                00068500
000686                              OCCURS 14 TIMES                     00068600
000687                              INDEXED BY LS-ACCOUNT-INDEX         00068700
000688                              PIC X(10).                          00068800
000689                                                                  00068900
000690******************************************************************00069000
000691 PROCEDURE DIVISION.                                              00069100
000692******************************************************************00069200
000693 0000-MAINLINE.                                                   00069300
000695     EVALUATE TRUE                                                00069500
000696         WHEN EIBCALEN = ZERO                                     00069600
000697             MOVE SPACES      TO CA-COMMON-AREA                   00069700
000698             PERFORM 9000-RETURN-TO-MAIN-MENU                     00069800
000699         WHEN LS-INITIALIZE-SCREEN                                00069900
000700             PERFORM 1000-INITIALIZE                              00070000
000701         WHEN EIBAID = DFHPF3                                     00070100
000702             MOVE DFHCOMMAREA TO CA-COMMON-AREA                   00070200
000703             PERFORM 9000-RETURN-TO-MAIN-MENU                     00070300
000704         WHEN EIBAID = DFHCLEAR                                   00070400
000705             PERFORM 5000-SEND-MAP-AND-DATA                       00070500
000706         WHEN OTHER                                               00070600
000707             PERFORM 2000-PROCESS-SCREEN-FIELDS                   00070700
000708     END-EVALUATE.                                                00070800
000709                                                                  00070900
000710     GOBACK.                                                      00071000
000711                                                                  00071100
000712******************************************************************00071200
000713*  INITIALIZE SCREEN FIELDS AND THE COMMON AREA FOR PROCESSING.  *00071300
000714*  RETAIN COMMON DATA PASSED IN THE LINKAGE SECTION.  DISPLAY    *00071400
000715*  ANY APPLICABLE MESSAGES TO INDICATE SUCCESS OR FAILURE OF THE *00071500
000716*  LAST ACTION.  SEND THE MAP AND THE INITIAL DATA, AND RETURN   *00071600
000717*  CONTROL TO THIS TRANSACTION.                                  *00071700
000718******************************************************************00071800
000719 1000-INITIALIZE.                                                 00071900
000723     INITIALIZE CA-COMMON-AREA.                                   00072300
000724                                                                  00072400
000725     MOVE PC-CURRENT-PROGRAM-NAME      TO DP031-PROGRAM-NAME.     00072500
000726     MOVE LS-COMMON-DATA               TO CA-COMMON-DATA.         00072600
000729     MOVE LOW-VALUES                   TO AR001AI.                00072900
000730                                                                  00073000
000731     SET CA-PROCESS-SCREEN             TO TRUE.                   00073100
000733                                                                  00073300
000734     IF CA-ACCOUNT-NUMBER-X NOT NUMERIC                           00073400
000735     OR CA-ACCOUNT-NUMBER-X = SPACES                              00073500
000736        INITIALIZE CA-ACCOUNT-NUMBER-X                            00073600
000737                   ART00001-ACCT-NBR                              00073700
000738     ELSE                                                         00073800
000739        IF CA-TOKEN-ACCT-YES AND CA-ACCT-ACCESS-NO                00073900
000741           MOVE CA-ACCOUNT-NUMBER      TO ART00001-ACCT-NBR       00074100
000743        ELSE                                                      00074300
000744           MOVE CA-ACCOUNT-NUMBER      TO PV-ACCOUNT-NBR-10       00074400
000745           PERFORM 5500-TOKENIZE-ACCT                             00074500
000746        END-IF                                                    00074600
000747     END-IF.                                                      00074700
000748                                                                  00074800
000749     MOVE 1                            TO CA-SCREEN-NUMBER.       00074900
000750     MOVE HL-HEADING-LINE (1)          TO AHEADO.                 00075000
000751     SET PM-MESSAGE-INDEX              TO 1.                      00075100
000752     PERFORM 5200-GET-ASSOC-DET.                                  00075200
000753                                                                  00075300
000754*    IF PS-DTL-NOT-FOUND-TBL AND PS-DTL-NOT-FOUND-VW              00075499
000755*       EXIT                                                      00075599
000756*    END-IF.                                                      00075699
000757                                                                  00075700
000758     MOVE CA-SCREEN-ACCOUNT-NUMBER (1) TO                         00075800
000759                                       CA-PREVIOUS-ACCOUNT-NUMBER.00075900
000760                                                                  00076000
000761     EVALUATE TRUE ALSO TRUE                                      00076100
000762         WHEN CA-LAST-ACTION-ABORTED    ALSO ANY                  00076200
000763             SET PM-MESSAGE-INDEX      TO 5                       00076300
000764         WHEN CA-LAST-ACTION-SUCCESSFUL ALSO CA-CHANGE-ACTION     00076400
000765             SET PM-MESSAGE-INDEX      TO 6                       00076500
000766         WHEN CA-LAST-ACTION-SUCCESSFUL ALSO CA-DELETE-ACTION     00076600
000767             SET PM-MESSAGE-INDEX      TO 7                       00076700
000768         WHEN CA-LAST-ACTION-SUCCESSFUL ALSO CA-TRANSFER-ACTION   00076800
000769             SET PM-MESSAGE-INDEX      TO 8                       00076900
000770     END-EVALUATE.                                                00077000
000771                                                                  00077100
000772     SET CA-RESET-LAST-ACTION-STATUS                              00077200
000773         CA-NO-ACTION-SPECIFIED        TO TRUE.                   00077300
000774                                                                  00077400
000775     PERFORM 6000-UPDATE-SCREEN-HEADER.                           00077500
000776     MOVE PM-PROGRAM-MESSAGE(PM-MESSAGE-INDEX) TO AMSGO.          00077600
000777     MOVE -1                           TO AACTL (1).              00077700
000778                                                                  00077800
000779     EXEC CICS                                                    00077900
000780         SEND                                                     00078000
000781             MAP('AR001A')                                        00078100
000782             MAPSET('ARKM001')                                    00078200
000783             ERASE                                                00078300
000784             CURSOR                                               00078400
000785             FORMFEED                                             00078500
000786             RESP(PV-CICS-RESPONSE)                               00078600
000787     END-EXEC.                                                    00078700
000788                                                                  00078800
000789     IF PV-CICS-RESPONSE NOT = DFHRESP(NORMAL)                    00078900
000790         MOVE 'SEND THE INITIAL MAP'   TO SE-ATTEMPTED-ACTION     00079000
000791         MOVE PV-CICS-RESPONSE         TO SE-CICS-RESPONSE        00079100
000792         MOVE SE-SYSTEM-ERROR-MESSAGE  TO PV-LEAVE-SYSTEM-MESSAGE 00079200
000793         PERFORM 9900-LEAVE-SYSTEM                                00079300
000794     END-IF.                                                      00079400
000795                                                                  00079500
000796     EXEC CICS                                                    00079600
000797         RETURN                                                   00079700
000798             TRANSID('A001')                                      00079800
000799             COMMAREA(CA-COMMON-AREA)                             00079900
000800             LENGTH(PC-COMMON-AREA-LENGTH)                        00080000
000801             RESP(PV-CICS-RESPONSE)                               00080100
000802     END-EXEC.                                                    00080200
000803                                                                  00080300
000804     IF PV-CICS-RESPONSE NOT = DFHRESP(NORMAL)                    00080400
000805        MOVE 'RETURN AFTER THE INITIAL MAP SEND' TO               00080500
000806                                           SE-ATTEMPTED-ACTION    00080600
000807        MOVE PV-CICS-RESPONSE           TO SE-CICS-RESPONSE       00080700
000808        MOVE SE-SYSTEM-ERROR-MESSAGE    TO PV-LEAVE-SYSTEM-MESSAGE00080800
000809        PERFORM 9900-LEAVE-SYSTEM                                 00080900
000810     END-IF.                                                      00081000
000811                                                                  00081100
000812*---------*                                                       00081200
000813 1000-EXIT.                                                       00081300
000814*---------*                                                       00081400
000815     EXIT.                                                        00081500
000816                                                                  00081600
000854******************************************************************00085400
000855*  PROCESS THE INFORMATION ENTERED ON THE SCREEN, BY RECEIVING   *00085500
000856*  THE CURRENT MAP, PASSING CONTROL OR RESETTING THE STARTING    *00085600
000857*  ACCOUNT NUMBER (IF REQUESTED), AND DETERMINING THE PORTION    *00085700
000858*  OF THE LIST REQUESTED BASED ON THE PF KEY PRESSED.  THE NEW   *00085800
000859*  DATA REQUESTED IS SENT TO THE SCREEN, AND PROGRAM CONTROL IS  *00085900
000860*  RETURNED TO THIS TRANSACTION.                                 *00086000
000861******************************************************************00086100
000862 2000-PROCESS-SCREEN-FIELDS.                                      00086200
000863     MOVE LOW-VALUES                        TO AR001AI.           00086300
000864                                                                  00086400
000865     PERFORM 2100-RECEIVE-MAP.                                    00086500
000866                                                                  00086600
000867     IF EIBAID = DFHENTER                                         00086700
000868         PERFORM 2200-EDIT-SCREEN-FIELDS                          00086800
000869     END-IF.                                                      00086900
000870                                                                  00087000
000871     INITIALIZE ASTACCTI.                                         00087100
000872                                                                  00087200
000873     EVALUATE EIBAID ALSO CA-SCREEN-NUMBER                        00087300
000874         WHEN DFHPF10 ALSO (NOT PC-FIRST-SCREEN-NUMBER)           00087400
000875              SUBTRACT 1 FROM CA-SCREEN-NUMBER                    00087500
000876         WHEN DFHPF11 ALSO (NOT PC-LAST-SCREEN-NUMBER)            00087600
000877              ADD 1                         TO CA-SCREEN-NUMBER   00087700
000878     END-EVALUATE.                                                00087800
000879                                                                  00087900
000880     SET HL-HEADING-INDEX                   TO CA-SCREEN-NUMBER.  00088000
000881     MOVE HL-HEADING-LINE(HL-HEADING-INDEX) TO AHEADO.            00088100
000882                                                                  00088200
000883     SET PM-MESSAGE-INDEX                   TO 1.                 00088300
000884     MOVE -1                                TO AACTL (1).         00088400
000885                                                                  00088500
000886     EVALUATE EIBAID                                              00088600
000887        WHEN DFHENTER                                             00088700
000905        WHEN DFHPF10                                              00090500
000906        WHEN DFHPF11                                              00090600
000907           IF CA-SCREEN-ACCOUNT-NUMBER (1) NOT NUMERIC            00090700
000908           OR CA-SCREEN-ACCOUNT-NUMBER (1) = SPACES               00090800
000909              INITIALIZE CA-SCREEN-ACCOUNT-NUMBER (1)             00090900
000910                         ART00001-ACCT-NBR                        00091000
000911           ELSE                                                   00091100
000912              IF CA-TOKEN-ACCT-YES AND CA-ACCT-ACCESS-NO          00091200
000913                 MOVE CA-SCREEN-ACCOUNT-NUMBER (1) TO             00091300
000914                      ART00001-ACCT-NBR                           00091400
000915              ELSE                                                00091500
000916                 MOVE CA-SCREEN-ACCOUNT-NUMBER (1) TO             00091600
000917                      PV-ACCOUNT-NBR-10                           00091700
000918                 PERFORM 5500-TOKENIZE-ACCT                       00091800
000919              END-IF                                              00091900
000920              PERFORM 5200-GET-ASSOC-DET                          00092000
000921              MOVE CA-SCREEN-ACCOUNT-NUMBER (1) TO                00092100
000922                   CA-PREVIOUS-ACCOUNT-NUMBER                     00092200
000923           END-IF                                                 00092300
000924        WHEN OTHER                                                00092400
000925           SET PM-MESSAGE-INDEX              TO 4                 00092500
000926     END-EVALUATE.                                                00092600
000927                                                                  00092700
000928     PERFORM 6000-UPDATE-SCREEN-HEADER.                           00092800
000929     MOVE PM-PROGRAM-MESSAGE(PM-MESSAGE-INDEX) TO AMSGO.          00092900
000930                                                                  00093000
000931     EXEC CICS                                                    00093100
000932         SEND                                                     00093200
000933             MAP('AR001A')                                        00093300
000934             MAPSET('ARKM001')                                    00093400
000935             DATAONLY                                             00093500
000936             CURSOR                                               00093600
000937             FORMFEED                                             00093700
000938             RESP(PV-CICS-RESPONSE)                               00093800
000939     END-EXEC.                                                    00093900
000940                                                                  00094000
000941     IF PV-CICS-RESPONSE NOT = DFHRESP(NORMAL)                    00094100
000942         MOVE 'SEND THE DATA AFTER EDITING'    TO                 00094200
000943                   SE-ATTEMPTED-ACTION                            00094300
000944         MOVE PV-CICS-RESPONSE                 TO SE-CICS-RESPONSE00094400
000945         MOVE SE-SYSTEM-ERROR-MESSAGE   TO PV-LEAVE-SYSTEM-MESSAGE00094500
000946         PERFORM 9900-LEAVE-SYSTEM                                00094600
000947     END-IF.                                                      00094700
000948                                                                  00094800
000949     EXEC CICS                                                    00094900
000950         RETURN                                                   00095000
000951             TRANSID('A001')                                      00095100
000952             COMMAREA(CA-COMMON-AREA)                             00095200
000953             LENGTH(PC-COMMON-AREA-LENGTH)                        00095300
000954             RESP(PV-CICS-RESPONSE)                               00095400
000955     END-EXEC.                                                    00095500
000956                                                                  00095600
000957     IF PV-CICS-RESPONSE NOT = DFHRESP(NORMAL)                    00095700
000958         MOVE 'RETURN AFTER THE EDITED MAP SEND' TO               00095800
000959                   SE-ATTEMPTED-ACTION                            00095900
000960         MOVE PV-CICS-RESPONSE          TO SE-CICS-RESPONSE       00096000
000961         MOVE SE-SYSTEM-ERROR-MESSAGE   TO PV-LEAVE-SYSTEM-MESSAGE00096100
000962         PERFORM 9900-LEAVE-SYSTEM                                00096200
000963     END-IF.                                                      00096300
000964                                                                  00096400
000965*---------*                                                       00096500
000966 2000-EXIT.                                                       00096600
000967*---------*                                                       00096700
000968     EXIT.                                                        00096800
000969                                                                  00096900
000970******************************************************************00097000
000971*  RECEIVE THE CURRENT MAP.  THE MAPFAIL CONDITION WILL BE       *00097100
000972*  RAISED IF NO DATA WAS ENTERED ON THE SCREEN.                  *00097200
000973******************************************************************00097300
000974 2100-RECEIVE-MAP.                                                00097400
000975     MOVE DFHCOMMAREA TO CA-COMMON-AREA.                          00097500
000976                                                                  00097600
000977     EXEC CICS                                                    00097700
000978         RECEIVE                                                  00097800
000979             MAP('AR001A')                                        00097900
000980             MAPSET('ARKM001')                                    00098000
000981             RESP(PV-CICS-RESPONSE)                               00098100
000982     END-EXEC.                                                    00098200
000983                                                                  00098300
000984     EVALUATE PV-CICS-RESPONSE                                    00098400
000985         WHEN DFHRESP(NORMAL)                                     00098500
000986             CONTINUE                                             00098600
000987         WHEN DFHRESP(MAPFAIL)                                    00098700
000988             MOVE LOW-VALUES TO AR001AI                           00098800
000989         WHEN OTHER                                               00098900
000990             MOVE 'RECEIVE THE MAP' TO SE-ATTEMPTED-ACTION        00099000
000991             MOVE PV-CICS-RESPONSE TO SE-CICS-RESPONSE            00099100
000992             MOVE SE-SYSTEM-ERROR-MESSAGE TO                      00099200
000993                       PV-LEAVE-SYSTEM-MESSAGE                    00099300
000994             PERFORM 9900-LEAVE-SYSTEM                            00099400
000995     END-EVALUATE.                                                00099500
000996                                                                  00099600
000997*---------*                                                       00099700
000998 2100-EXIT.                                                       00099800
000999*---------*                                                       00099900
001000     EXIT.                                                        00100000
001001                                                                  00100100
001002******************************************************************00100200
001003*  EDIT SCREEN FIELDS.  NO ERRORS WILL BE REPORTED BY THIS       *00100300
001004*  PROGRAM.  INVALID FIELDS WILL BE IGNORED.  THE ACTION FIELDS  *00100400
001005*  WILL BE INTERROGATED FIRST.  PROGRAM CONTROL WILL BE PASSED   *00100500
001006*  TO THE PROGRAM SUPPORTING THE FUNCTION OF THE FIRST VALID     *00100600
001007*  ACTION CODE ENCOUNTERED, USING THE EMPLOYEE ACCOUNT NUMBER    *00100700
001008*  ON THE LINE OF THE SELECTION AS THE KEY.  IF NO VALID ACTIONS *00100800
001009*  ARE PROVIDED, THE STARTING ACCOUNT NUMBER IS VERFIED.  IF     *00100900
001010*  A NUMERIC STARTING ACCOUNT NUMBER IS ENTERED, IT BECOMES THE  *00101000
001011*  KEY USED IN THE NEXT START BROWSE.                            *00101100
001012******************************************************************00101200
001013 2200-EDIT-SCREEN-FIELDS.                                         00101300
001014     PERFORM VARYING AI-ACCOUNT-INDEX FROM 1 BY 1                 00101400
001015       UNTIL AI-ACCOUNT-INDEX > PC-MAXIMUM-SCREEN-ENTRIES         00101500
001016        SET CA-ACCOUNT-INDEX TO AI-ACCOUNT-INDEX                  00101600
001017                                                                  00101700
001018        EVALUATE AACTI (AI-ACCOUNT-INDEX)                         00101800
001019            WHEN PC-SELECT-ACTION                                 00101900
001020               MOVE CA-SCREEN-ACCOUNT-NUMBER (CA-ACCOUNT-INDEX)   00102000
001021                             TO CA-ACCOUNT-NUMBER-X               00102100
001022               PERFORM 9100-TRANSFER-TO-MAINTENANCE               00102200
001023            WHEN PC-INQUIRE-ACTION                                00102300
001024               MOVE CA-SCREEN-ACCOUNT-NUMBER (CA-ACCOUNT-INDEX)   00102400
001025                           TO CA-ACCOUNT-NUMBER-X                 00102500
001026               PERFORM 9200-TRANSFER-TO-INQUIRY                   00102600
001027            WHEN PC-TRANSFER-ACTION                               00102700
001028               MOVE CA-SCREEN-ACCOUNT-NUMBER (CA-ACCOUNT-INDEX)   00102800
001029                           TO CA-ACCOUNT-NUMBER-X                 00102900
001030               PERFORM 9300-TRANSFER-TO-ACCT-TRANSFER             00103000
001031         END-EVALUATE                                             00103100
001032     END-PERFORM.                                                 00103200
001033                                                                  00103300
001034     IF  ASTACCTI NOT = SPACES                                    00103400
001035     AND ASTACCTI NOT = LOW-VALUES                                00103500
001036        MOVE ASTACCTI                   TO DP010I-UNEDITED-FIELD  00103600
001037        MOVE 10                         TO DP010I-MAXIMUM-DIGITS  00103700
001038        MOVE 0                          TO DP010I-MAXIMUM-DECIMALS00103800
001039        SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                   00103900
001041        CALL DP010I-NUMERIC-EDIT-ROUTINE                          00104199
001042                         USING DP010I-NUMERIC-EDIT-AREA           00104299
001043        IF NOT DP010I-ERROR-DETECTED                              00104300
001044           MOVE DP010I-NUMERIC-FIELD    TO CA-ACCOUNT-NUMBER      00104400
001045           MOVE CA-ACCOUNT-NUMBER-X     TO                        00104500
001046                                      CA-SCREEN-ACCOUNT-NUMBER (1)00104600
001047           SET CA-TOKEN-ACCT-NO TO TRUE                           00104700
001048        END-IF                                                    00104800
001049     END-IF.                                                      00104900
001050*---------*                                                       00105000
001051 2200-EXIT.                                                       00105100
001052*---------*                                                       00105200
001053     EXIT.                                                        00105300
001054                                                                  00105400
001055******************************************************************00105500
001056*  IN THE CASE THAT THE CLEAR KEY IS PRESSED, RE-SEND THE MAP    *00105600
001057*  AND DATA FROM THE LAST PASS THROUGH THE PROGRAM.              *00105700
001058******************************************************************00105800
001059 5000-SEND-MAP-AND-DATA.                                          00105900
001060     MOVE DFHCOMMAREA TO CA-COMMON-AREA.                          00106000
001061     MOVE LOW-VALUES TO AR001AI.                                  00106100
001062                                                                  00106200
001063     PERFORM 6000-UPDATE-SCREEN-HEADER.                           00106300
001064     MOVE CA-SCREEN-ACCOUNT-NUMBER (1) TO ART00001-ACCT-NBR.      00106400
001065     SET HL-HEADING-INDEX TO CA-SCREEN-NUMBER.                    00106500
001066     MOVE HL-HEADING-LINE (HL-HEADING-INDEX) TO AHEADO.           00106600
001067     SET PM-MESSAGE-INDEX TO 1.                                   00106700
001068     MOVE CA-SCREEN-ACCOUNT-NUMBER (1) TO                         00106800
001069               CA-PREVIOUS-ACCOUNT-NUMBER.                        00106900
001070     MOVE PM-PROGRAM-MESSAGE (PM-MESSAGE-INDEX) TO AMSGO.         00107000
001071     MOVE -1 TO AACTL (1).                                        00107100
001072                                                                  00107200
001073     EXEC CICS                                                    00107300
001074         SEND                                                     00107400
001075             MAP('AR001A')                                        00107500
001076             MAPSET('ARKM001')                                    00107600
001077             ERASE                                                00107700
001078             CURSOR                                               00107800
001079             FORMFEED                                             00107900
001080             RESP(PV-CICS-RESPONSE)                               00108000
001081     END-EXEC.                                                    00108100
001082                                                                  00108200
001083     IF PV-CICS-RESPONSE NOT = DFHRESP(NORMAL)                    00108300
001084         MOVE 'SEND THE DATA AFTER CLEARING' TO                   00108400
001085                   SE-ATTEMPTED-ACTION                            00108500
001086         MOVE PV-CICS-RESPONSE TO SE-CICS-RESPONSE                00108600
001087         MOVE SE-SYSTEM-ERROR-MESSAGE TO                          00108700
001088                   PV-LEAVE-SYSTEM-MESSAGE                        00108800
001089         PERFORM 9900-LEAVE-SYSTEM                                00108900
001090     END-IF.                                                      00109000
001091                                                                  00109100
001092     EXEC CICS                                                    00109200
001093         RETURN                                                   00109300
001094             TRANSID('A001')                                      00109400
001095             COMMAREA(CA-COMMON-AREA)                             00109500
001096             LENGTH(PC-COMMON-AREA-LENGTH)                        00109600
001097             RESP(PV-CICS-RESPONSE)                               00109700
001098     END-EXEC.                                                    00109800
001099                                                                  00109900
001100     IF PV-CICS-RESPONSE NOT = DFHRESP(NORMAL)                    00110000
001101         MOVE 'RETURN AFTER THE CLEARED MAP SEND' TO              00110100
001102                   SE-ATTEMPTED-ACTION                            00110200
001103         MOVE PV-CICS-RESPONSE TO SE-CICS-RESPONSE                00110300
001104         MOVE SE-SYSTEM-ERROR-MESSAGE TO                          00110400
001105                   PV-LEAVE-SYSTEM-MESSAGE                        00110500
001106         PERFORM 9900-LEAVE-SYSTEM                                00110600
001107     END-IF.                                                      00110700
001108*---------*                                                       00110800
001109 5000-EXIT.                                                       00110900
001110*---------*                                                       00111000
001111     EXIT.                                                        00111100
001120                                                                  00112000
001145******************************************************************00114500
001146*  GETS THE ASSOCIATE DETAILS THROUGH CALLING THE EMP_CSR.       *00114600
001154******************************************************************00115400
001155 5200-GET-ASSOC-DET.                                              00115500
001156     SET PS-MORE-ROWS                   TO TRUE.                  00115600
001157     INITIALIZE PV-ACCT-COUNT.                                    00115700
001158                                                                  00115800
001159     PERFORM 7000-OPEN-EMPLOYEE-CSR.                              00115900
001160                                                                  00116000
001161     PERFORM 7100-FETCH-EMPLOYEE-CSR.                             00116100
001162                                                                  00116200
001163     PERFORM VARYING CA-ACCOUNT-INDEX FROM 1 BY 1                 00116300
001164       UNTIL PS-NO-MORE-ROWS                                      00116400
001165          OR CA-ACCOUNT-INDEX > PC-MAXIMUM-SCREEN-ENTRIES         00116500
001166                                                                  00116600
001167        SET PS-DTL-FOUND-TBL            TO TRUE                   00116700
001168                                                                  00116800
001187        IF ED-EMP-STAT-CDE = 'D' OR 'R' OR 'T' OR 'U'             00118700
001188                          OR 'V' OR 'S'                           00118800
001189           MOVE 'T'                   TO ED-EMP-STAT-CDE          00118900
001190        ELSE                                                      00119000
001191           MOVE 'A'                   TO ED-EMP-STAT-CDE          00119100
001192        END-IF                                                    00119200
001193                                                                  00119300
001194        IF PS-DTL-NOT-FOUND-TBL                                   00119400
001195           SET CA-LAST-ACTION-ABORTED   TO TRUE                   00119500
001196           SET PM-MESSAGE-INDEX         TO 1                      00119600
001197        END-IF                                                    00119700
001198                                                                  00119800
001199        SET AI-ACCOUNT-INDEX            TO CA-ACCOUNT-INDEX       00119900
001200        SET AO-ACCOUNT-INDEX            TO CA-ACCOUNT-INDEX       00120000
001201                                                                  00120100
001202        PERFORM 5300-FORMAT-SCREEN-LINE                           00120200
001203        PERFORM 7100-FETCH-EMPLOYEE-CSR                           00120300
001204     END-PERFORM.                                                 00120400
001205                                                                  00120500
001206     IF PV-ACCT-COUNT = 0 AND PS-NO-MORE-ROWS                     00120600
001207        SET PM-MESSAGE-INDEX TO 9                                 00120700
001208     END-IF.                                                      00120800
001210                                                                  00121000
001211     IF PS-NO-MORE-ROWS                                           00121100
001212        PERFORM UNTIL CA-ACCOUNT-INDEX >                          00121200
001213                                     PC-MAXIMUM-SCREEN-ENTRIES    00121300
001214            SET AI-ACCOUNT-INDEX                                  00121400
001215                AO-ACCOUNT-INDEX        TO CA-ACCOUNT-INDEX       00121500
001216            MOVE PV-LAST-ACCOUNT-NUMBER TO                        00121600
001217                 CA-SCREEN-ACCOUNT-NUMBER(CA-ACCOUNT-INDEX)       00121700
001218                                                                  00121800
001219            MOVE DFHBMPRO              TO AACTA (AI-ACCOUNT-INDEX)00121900
001220            MOVE DFHDFT                TO AACTH (AO-ACCOUNT-INDEX)00122000
001221                                                                  00122100
001222            INITIALIZE AACTI (AI-ACCOUNT-INDEX)                   00122200
001223                       AACCTO (AO-ACCOUNT-INDEX)                  00122300
001224                       ADETLO (AO-ACCOUNT-INDEX)                  00122400
001225                                                                  00122500
001226            SET CA-ACCOUNT-INDEX UP BY 1                          00122600
001227        END-PERFORM                                               00122700
001228        MOVE PV-LAST-ACCOUNT-NUMBER     TO CA-NEXT-ACCOUNT-NUMBER 00122800
001229     ELSE                                                         00122900
001230        MOVE ART00001-ACCT-NBR          TO CA-NEXT-ACCOUNT-NUMBER 00123000
001231     END-IF.                                                      00123100
001232                                                                  00123200
001233     PERFORM 7300-CLOSE-EMP-DN-CSR.                               00123300
001234*---------*                                                       00123400
001235 5200-EXIT.                                                       00123500
001236*---------*                                                       00123600
001237     EXIT.                                                        00123700
001238                                                                  00123800
001239******************************************************************00123900
001240*  FORMAT A SCREEN LINE FOR THE CURRENT EMPLOYEE ACCOUNT.        *00124000
001241*  FILL THE VARIABLE SCREEN DETAIL DEPENDING ON THE CURRENT      *00124100
001242*  SCREEN NUMBER DISPLAYED.                                      *00124200
001243******************************************************************00124300
001244 5300-FORMAT-SCREEN-LINE.                                         00124400
001245     MOVE CA-ACCOUNT-NUMBER           TO PV-HOLD-ACCT-NBR         00124500
001246                      CA-SCREEN-ACCOUNT-NUMBER (CA-ACCOUNT-INDEX).00124600
001248                                                                  00124800
001249     MOVE DFHBMUNP                    TO AACTA (AI-ACCOUNT-INDEX).00124900
001250     MOVE DFHUNDLN                    TO AACTH (AO-ACCOUNT-INDEX).00125000
001251                                                                  00125100
001252     INITIALIZE AACTI (AI-ACCOUNT-INDEX).                         00125200
001253                                                                  00125300
001260     IF CA-ACCT-ACCESS-YES                                        00126000
001262        MOVE PV-HOLD-ACCT-NBR(1:3)       TO FA-ACCOUNT-NUMBER-1-3 00126200
001263        MOVE PV-HOLD-ACCT-NBR(4:3)       TO FA-ACCOUNT-NUMBER-4-6 00126300
001264        MOVE PV-HOLD-ACCT-NBR(7:3)       TO FA-ACCOUNT-NUMBER-7-9 00126400
001265        MOVE PV-HOLD-ACCT-NBR(10:1)      TO FA-ACCOUNT-NUMBER-10  00126500
001266        MOVE FA-FORMATTED-ACCOUNT-NUMBER TO                       00126600
001267                                         AACCTO (AO-ACCOUNT-INDEX)00126700
001268     ELSE                                                         00126800
001269        MOVE 'XXX'                  TO FA-ACCOUNT-NUMBER-1-3      00126900
001270        MOVE 'XXX'                  TO FA-ACCOUNT-NUMBER-4-6      00127000
001271        MOVE 'XX'                   TO FA-ACCOUNT-NUMBER-7-9(1:2) 00127100
001272        MOVE ART00001-ACCT-NBR      TO PV-HOLD-ACCT-NBR           00127200
001273        MOVE PV-HOLD-ACCT-NBR(9:1)  TO FA-ACCOUNT-NUMBER-7-9(3:1) 00127300
001274        MOVE PV-HOLD-ACCT-NBR(10:1) TO FA-ACCOUNT-NUMBER-10       00127400
001275        MOVE FA-FORMATTED-ACCOUNT-NUMBER TO                       00127500
001276                                         AACCTO (AO-ACCOUNT-INDEX)00127600
001277     END-IF.                                                      00127700
001278                                                                  00127800
001279     INITIALIZE DL-DETAIL-LINE.                                   00127900
001280                                                                  00128000
001281     EVALUATE CA-SCREEN-NUMBER                                    00128100
001282         WHEN 1                                                   00128200
001283             MOVE ED-EMP-STAT-CDE        TO                       00128300
001284                                         DL-EMPLOYEE-DISC-STATUS  00128400
001285             MOVE ED-EMP-TYP-CDE         TO DL-CRS-EMPLOYEE-CODE  00128500
001289             IF ED-EMP-NM = SPACES                                00128999
001290                MOVE ED-EMP-NM           TO DL-EMPLOYEE-NAME      00129099
001291             ELSE                                                 00129199
001292                PERFORM 5600-BASE64-BINARY                        00129299
001293                PERFORM 5700-DECRYPT-EMPNAME                      00129399
001295                PERFORM 5800-ASCII-EBCDIC                         00129599
001296                MOVE DP053-OUTPUT-FIELD  TO DL-EMPLOYEE-NAME      00129699
001297             END-IF                                               00129799
001298         WHEN 2                                                   00129899
001299             IF CA-SSN-ACCESS-YES                                 00129999
001300                INITIALIZE CSI-PARAMETERS                         00130099
001301                           DP031-PROTEG-PGM-PARAMETERS            00130199
001302                           PV-INPUT-LEN                           00130299
001303                INSPECT FUNCTION REVERSE(ED-SSN-NBR)              00130399
001304                      TALLYING PV-INPUT-LEN FOR LEADING SPACES    00130499
001305                COMPUTE PV-INPUT-LEN = LENGTH OF ED-SSN-NBR       00130599
001306                                                  - PV-INPUT-LEN  00130699
001307                IF ED-SSN-NBR NOT = SPACES AND PV-INPUT-LEN = 9   00130799
001308                   MOVE 'SSN-NUMBER'        TO DP031-FIELD        00130899
001309                   SET CSI-DECRYPT-FUNCTION TO TRUE               00130999
001310                   SET DP031-SSN            TO TRUE               00131099
001311                   MOVE PV-INPUT-LEN        TO DP031-INPUT-LEN    00131199
001312                   MOVE ED-SSN-NBR          TO DP031-CIPHER-TEXT  00131299
001313                   PERFORM DP032-0000-PROTG-TOKEN-DETOKEN         00131399
001314                   MOVE DP031-CLEAR-TEXT     TO ED-SSN-NBR        00131499
001315                END-IF                                            00131599
001316                MOVE ED-SSN-NBR (1:3)    TO DL-SOC-SEC-NUMBER-1-3 00131699
001317                MOVE '-'                 TO DL-SOC-SEC-DASH-1     00131799
001318                MOVE ED-SSN-NBR (4:2)    TO DL-SOC-SEC-NUMBER-4-5 00131899
001319                MOVE '-'                 TO DL-SOC-SEC-DASH-2     00131999
001320                MOVE ED-SSN-NBR(6:4)     TO DL-SOC-SEC-NUMBER-6-9 00132099
001321***CLP                                                            00132199
001322                IF ED-STORE-NBR-4(4:1) = SPACE                    00132299
001323                    MOVE ED-STORE-NBR-4(1:3)  TO DL-STORE-NUMBER  00132399
001324                ELSE                                              00132499
001325                    MOVE ED-STORE-NBR-4       TO DL-STORE-NUMBER  00132599
001326                END-IF                                            00132699
001327             ELSE                                                 00132799
001328                MOVE 'XXX'               TO DL-SOC-SEC-NUMBER-1-3 00132899
001329                MOVE '-'                 TO DL-SOC-SEC-DASH-1     00132999
001330                MOVE 'XX'                TO DL-SOC-SEC-NUMBER-4-5 00133099
001331                MOVE '-'                 TO DL-SOC-SEC-DASH-2     00133199
001332                MOVE ED-SSN-NBR(6:4)     TO DL-SOC-SEC-NUMBER-6-9 00133299
001333***CLP                                                            00133399
001334                IF ED-STORE-NBR-4(4:1) = SPACE                    00133499
001335                    MOVE ED-STORE-NBR-4(1:3)  TO DL-STORE-NUMBER  00133599
001336                ELSE                                              00133699
001337                    MOVE ED-STORE-NBR-4       TO DL-STORE-NUMBER  00133799
001338                END-IF                                            00133899
001339             END-IF                                               00133999
001340         WHEN 3                                                   00134099
001341             INITIALIZE PV-TEMP-HOLD-DTE                          00134199
001342             MOVE ED-DISC-DTE(3:2)    TO PV-TEMP-HOLD-YR          00134299
001343             MOVE ED-DISC-DTE(6:2)    TO PV-TEMP-HOLD-MONTH       00134399
001344             MOVE ED-DISC-DTE(9:2)    TO PV-TEMP-HOLD-DAY         00134499
001345             MOVE PV-TEMP-HOLD-DTE    TO                          00134599
001346                                     DL-DATE-DISCOUNT-EFFECTIVE   00134699
001347                                                                  00134799
001348             INITIALIZE PV-TEMP-HOLD-DTE                          00134899
001349             IF IND-ED-TERM-DATE NOT = -1                         00134999
001350                MOVE ED-TERM-DTE(3:2)    TO PV-TEMP-HOLD-YR       00135099
001351                MOVE ED-TERM-DTE(6:2)    TO PV-TEMP-HOLD-MONTH    00135199
001352                MOVE ED-TERM-DTE(9:2)    TO PV-TEMP-HOLD-DAY      00135299
001353             ELSE                                                 00135399
001354                MOVE ZEROS               TO PV-TEMP-HOLD-YR       00135499
001355                                            PV-TEMP-HOLD-MONTH    00135599
001356                                            PV-TEMP-HOLD-DAY      00135699
001357             END-IF                                               00135799
001358             MOVE PV-TEMP-HOLD-DTE       TO                       00135899
001359                                     DL-DATE-TERMINATION-EFFECTIVE00135999
001360                                                                  00136099
001361             INITIALIZE PV-TEMP-HOLD-DTE                          00136199
001362             MOVE ART00001-LAST-UPD-DTE(3:2)                      00136299
001363                                         TO PV-TEMP-HOLD-YR       00136399
001364             MOVE ART00001-LAST-UPD-DTE(6:2)                      00136499
001365                                         TO PV-TEMP-HOLD-MONTH    00136599
001366             MOVE ART00001-LAST-UPD-DTE(9:2)                      00136699
001367                                         TO PV-TEMP-HOLD-DAY      00136799
001368             MOVE PV-TEMP-HOLD-DTE       TO DL-DATE-LAST-CHANGED  00136899
001369         WHEN 4                                                   00136999
001370            IF IND-ART00001-CMNT-TXT = 0                          00137099
001371               MOVE ART00001-CMNT-TXT-TEXT (1:40)                 00137199
001372                                        TO DL-ACCOUNT-NOTES-1     00137299
001373            ELSE                                                  00137399
001374               MOVE SPACES              TO DL-ACCOUNT-NOTES-1     00137499
001375            END-IF                                                00137599
001376         WHEN 5                                                   00137699
001377            IF IND-ART00001-CMNT-TXT = 0                          00137799
001378               MOVE ART00001-CMNT-TXT-TEXT (41:40)                00137899
001379                                        TO DL-ACCOUNT-NOTES-2     00137999
001380            ELSE                                                  00138099
001381               MOVE SPACES              TO DL-ACCOUNT-NOTES-2     00138199
001382            END-IF                                                00138299
001383     END-EVALUATE.                                                00138399
001384                                                                  00138499
001385     MOVE DL-DETAIL-LINE             TO ADETLO (AO-ACCOUNT-INDEX).00138599
001386*---------*                                                       00138699
001387 5300-EXIT.                                                       00138799
001388*---------*                                                       00138899
001389     EXIT.                                                        00138999
001390                                                                  00139099
001391******************************************************************00139199
001392* CALLS THE PROTEGRITY MODULE TO TOKENIZE THE ACCOUNT NUMBER.    *00139299
001393******************************************************************00139399
001394 5500-TOKENIZE-ACCT.                                              00139499
001395                                                                  00139599
001396     INITIALIZE CSI-PARAMETERS                                    00139699
001397                DP031-PROTEG-PGM-PARAMETERS.                      00139799
001398                                                                  00139899
001399     MOVE 'ACCOUNT-NUMBER'        TO DP031-FIELD.                 00139999
001400     SET CSI-ENCRYPT-FUNCTION     TO TRUE.                        00140099
001401     SET DP031-ACCTNBR            TO TRUE.                        00140199
001402     MOVE PV-ACCOUNT-NBR-12       TO DP031-CLEAR-TEXT.            00140299
001403     MOVE 12                      TO DP031-INPUT-LEN.             00140399
001404     PERFORM DP032-0000-PROTG-TOKEN-DETOKEN.                      00140499
001405     MOVE DP031-CIPHER-TEXT(1:10) TO ART00001-ACCT-NBR.           00140599
001406                                                                  00140699
001407*---------*                                                       00140799
001408 5500-EXIT.                                                       00140899
001409*---------*                                                       00140999
001410     EXIT.                                                        00141099
001411                                                                  00141199
001412******************************************************************00141299
001413* CONVERTS THE DATA FROM BASE64 TO BINARY FORMAT.                *00141399
001414******************************************************************00141499
001415 5600-BASE64-BINARY.                                              00141599
001416                                                                  00141699
001417     INITIALIZE PV-INPUT-TEXT                                     00141799
001418                PV-OUTPUT-TEXT                                    00141899
001419                PV-INPUT-LEN.                                     00141999
001420                                                                  00142099
001421     INSPECT ED-EMP-NM TALLYING PV-INPUT-LEN                      00142199
001422             FOR CHARACTERS BEFORE INITIAL SPACE.                 00142299
001423     MOVE ED-EMP-NM           TO PV-INPUT-TEXT.                   00142399
001424     MOVE PV-INPUT-LEN        TO DP022-INLEN.                     00142499
001425     MOVE 66                  TO DP022-OUTLEN-IN.                 00142599
001426     CALL  DP022-MGCXR2B  USING DP022-PARMS,                      00142699
001427                                PV-INPUT-TEXT,                    00142799
001428                                PV-OUTPUT-TEXT.                   00142899
001429     IF RETURN-CODE NOT EQUAL 0                                   00142999
001430        MOVE RETURN-CODE      TO  DP031-RETURN-CODE               00143099
001431        STRING 'ERROR IN BASE64 TO BINARY' DELIMITED BY SIZE      00143199
001432               ' - RC = '                  DELIMITED BY SIZE      00143299
001433               DP031-RETURN-CODE           DELIMITED BY SIZE      00143399
001434                                 INTO DP013-MESSAGE-TEXT (1)      00143499
001435        STRING 'EMP-NAME = '               DELIMITED BY SIZE      00143599
001436               ED-EMP-NM                   DELIMITED BY SIZE      00143699
001437                                 INTO DP013-MESSAGE-TEXT (2)      00143799
001438        SET DP013-LOGIC-ABEND TO TRUE                             00143899
001439        SET DP013-NO-ROLLBACK TO TRUE                             00143999
001440        MOVE "5600-BASE64-BINARY"                                 00144099
001441                              TO DP013-PARAGRAPH                  00144199
001442        PERFORM DP013-0000-PROCESS-ABEND                          00144299
001443     END-IF.                                                      00144399
001444                                                                  00144499
001445*---------*                                                       00144599
001446 5600-EXIT.                                                       00144699
001447*---------*                                                       00144799
001448     EXIT.                                                        00144899
001449                                                                  00144999
001450******************************************************************00145099
001451* CALLS THE PROTEGRITY MODULE TO DECRYPT THE EMPLOYEE NAME.       00145199
001452* RETURNED EMPLOYEE NAME VALUE WILL BE IN ASCII FORMAT.           00145299
001453******************************************************************00145399
001454 5700-DECRYPT-EMPNAME.                                            00145499
001455                                                                  00145599
001456     INITIALIZE CSI-PARAMETERS                                    00145699
001457                DP031-PROTEG-PGM-PARAMETERS.                      00145799
001458     MOVE 'EMP-NAME'              TO DP031-FIELD.                 00145899
001459     SET CSI-DECRYPT-FUNCTION     TO TRUE.                        00145999
001460     SET DP031-CUST-INFO          TO TRUE.                        00146099
001461     MOVE DP022-OUTLEN-OUT        TO CSI-CIPHER-TEXT-LENGTH.      00146199
001462     MOVE 50                      TO CSI-CLEAR-TEXT-LENGTH.       00146299
001463     MOVE PV-OUTPUT-TEXT          TO DP031-CIPHER-TEXT.           00146399
001464     PERFORM DP032-1000-PROTG-ENCRYP-DECRYP.                      00146499
001465                                                                  00146599
001466*---------*                                                       00146699
001467 5700-EXIT.                                                       00146799
001468*---------*                                                       00146899
001469     EXIT.                                                        00146999
001470                                                                  00147099
001471******************************************************************00147199
001472* CONVERTS THE DATA FROM ASCII TO EBCDIC FORMAT                   00147299
001473******************************************************************00147399
001474 5800-ASCII-EBCDIC.                                               00147499
001475                                                                  00147599
001476     INITIALIZE DP053-EBCDIC-ASCII-PARMS.                         00147699
001477                                                                  00147799
001478     SET  DP053-CT-ASCII-TO-EBCDIC TO TRUE.                       00147899
001479     MOVE DP031-CLEAR-TEXT      TO DP053-INPUT-FIELD.             00147999
001480     MOVE CSI-CLEAR-TEXT-LENGTH TO DP053-FIELD-LENGTH.            00148099
001481                                                                  00148199
001482     CALL DP053-EBCDIC-ASCII-ROUTINE USING DP053-CONVERSION-TYPE  00148299
001483                                           DP053-FIELD-LENGTH     00148399
001484                                           DP053-INPUT-FIELD      00148499
001485                                           DP053-OUTPUT-FIELD     00148599
001486                                           DP053-RETURN-CODE.     00148699
001487     IF NOT DP053-RC-SUCCESSFUL                                   00148799
001488        MOVE DP053-RETURN-CODE TO DP031-RETURN-CODE               00148899
001489        STRING 'ERROR IN ASCII TO EBCDIC'  DELIMITED BY SIZE      00148999
001490               ' - RC = '                  DELIMITED BY SIZE      00149099
001491               DP031-RETURN-CODE           DELIMITED BY SIZE      00149199
001492                                 INTO DP013-MESSAGE-TEXT (1)      00149299
001493        STRING 'EMP-NAME = '               DELIMITED BY SIZE      00149399
001494               ED-EMP-NM                   DELIMITED BY SIZE      00149499
001495                                 INTO DP013-MESSAGE-TEXT (2)      00149599
001496        SET DP013-LOGIC-ABEND TO TRUE                             00149699
001497        SET DP013-NO-ROLLBACK TO TRUE                             00149799
001498        MOVE "5800-ASCII-EBCDIC"                                  00149899
001499                              TO DP013-PARAGRAPH                  00149999
001500        PERFORM DP013-0000-PROCESS-ABEND                          00150099
001501     END-IF.                                                      00150199
001502                                                                  00150299
001503*---------*                                                       00150399
001504 5800-EXIT.                                                       00150499
001505*---------*                                                       00150599
001506     EXIT.                                                        00150699
001507                                                                  00150799
001508******************************************************************00150899
001509*  FILL IN THE SCREEN HEADER WITH THE DATE, TIME,AND TERMINAL    *00150999
001510*  NUMBER.                                                       *00151099
001511******************************************************************00151199
001512 6000-UPDATE-SCREEN-HEADER.                                       00151299
001513     EXEC CICS                                                    00151399
001514         ASKTIME                                                  00151499
001515             ABSTIME(ST-ABSTIME)                                  00151599
001516     END-EXEC.                                                    00151699
001517                                                                  00151799
001518     EXEC CICS                                                    00151899
001519         FORMATTIME                                               00151999
001520             ABSTIME(ST-ABSTIME)                                  00152099
001521             MMDDYY(ADATEO)                                       00152199
001522             DATESEP                                              00152299
001523             TIME(ST-TIME-EDIT)                                   00152399
001524             TIMESEP                                              00152499
001525     END-EXEC.                                                    00152599
001526                                                                  00152699
001527     MOVE ST-TIME-HHMM TO ATIMEO.                                 00152799
001528     MOVE EIBTRMID TO ATERMO.                                     00152899
001529*---------*                                                       00152999
001530 6000-EXIT.                                                       00153099
001531*---------*                                                       00153199
001532     EXIT.                                                        00153299
001533                                                                  00153399
001534******************************************************************00153499
001535*  START A BROWSE OF THE EMPLOYEE ACCOUNT FILE AT THE FIRST      *00153599
001536*  ACCOUNT GREATER THAN OR EQUAL TO THE SPECIFIED ACCOUNT        *00153699
001537*  NUMBER.  SET A SWITCH TO INDICATE END-OF-FILE, IF IT IS       *00153799
001538*  ENCOUNTERED.  IF NO RECORDS ON FILE ARE GREATER THAN OR       *00153899
001539*  EQUAL TO THE SPECIFIED KEY, THE START OF THE BROWSE IS NOT    *00153999
001540*  SUCCESSFUL, AND THE NOT FOUND CONDITION WILL BE RAISED.  A    *00154099
001541*  KEY VALUE OF HIGH-VALUES WILL ALLOW A BROWSE TO BE STARTED AT *00154199
001542*  THE END OF THE FILE (FOR READPREV), WITHOUT TRIGGERING THE    *00154299
001543*  NOT FOUND CONDITION.                                          *00154399
001544******************************************************************00154499
001545 7000-OPEN-EMPLOYEE-CSR.                                          00154599
001546     EXEC SQL                                                     00154699
001547         OPEN EMP_CSR                                             00154799
001548     END-EXEC.                                                    00154899
001549                                                                  00154999
001550     EVALUATE TRUE                                                00155099
001551        WHEN SQLCODE = PC-SUCCESSFUL-SQLCODE                      00155199
001552           CONTINUE                                               00155299
001553        WHEN SQLCODE < PC-SUCCESSFUL-SQLCODE                      00155399
001554           MOVE 'EMP_CSR'                 TO PV-SQL-TABLE-NAME    00155499
001555           SET PS-CURSOR-OPEN-TEXT        TO TRUE                 00155599
001556           PERFORM 8000-STRING-SQL-FATAL-ERROR                    00155699
001557        WHEN SQLCODE > PC-SUCCESSFUL-SQLCODE                      00155799
001558           MOVE 'EMP_CSR'                 TO PV-SQL-TABLE-NAME    00155899
001559           SET PS-CURSOR-OPEN-TEXT        TO TRUE                 00155999
001560           PERFORM 8100-STRING-SQL-FATAL-WARNING                  00156099
001561     END-EVALUATE.                                                00156199
001562*---------*                                                       00156299
001563 7000-EXIT.                                                       00156399
001564*---------*                                                       00156499
001565     EXIT.                                                        00156599
001566                                                                  00156699
001567******************************************************************00156799
001568*  READ THE NEXT EMPLOYEE ACCOUNT ON THE EMPLOYEE FILE.          *00156899
001569******************************************************************00156999
001570 7100-FETCH-EMPLOYEE-CSR.                                         00157099
001571     INITIALIZE ART00001-CMNT-TXT                                 00157199
001572                IND-ART00001-CMNT-TXT.                            00157299
001573*--> CLEAR FIELDS, NO REPEATING VALUES WHEN NOT FOUND CONDITION   00157399
001574     MOVE SPACES                      TO ED-SSN-NBR               00157499
001575                                         ED-EMP-NM                00157599
001576                                         ED-EMP-STAT-CDE          00157699
001577                                         ED-EMP-TYP-CDE           00157799
001578                                         ED-DISC-DTE              00157899
001579                                         ED-TERM-DTE.             00157999
001580     MOVE ZEROES                      TO ED-STORE-NBR-4.          00158099
001581                                                                  00158199
001582     EXEC SQL                                                     00158299
001583        FETCH EMP_CSR                                             00158399
001584         INTO :ART00001-ACCT-NBR                                  00158499
001585             ,:ART00001-EMP-ID                                    00158599
001586             ,:ART00001-LAST-UPD-DTE                              00158699
001587             ,:ART00001-CMNT-TXT:IND-ART00001-CMNT-TXT            00158799
001588             ,:ED-SSN-NBR                                         00158899
001589             ,:ED-EMP-NM                                          00158999
001590             ,:ED-EMP-STAT-CDE                                    00159099
001591             ,:ED-EMP-TYP-CDE                                     00159199
001592             ,:ED-STORE-NBR-4                                     00159299
001593             ,:ED-DISC-DTE:IND-ED-DISC-DATE                       00159399
001594             ,:ED-TERM-DTE:IND-ED-TERM-DATE                       00159499
001595     END-EXEC.                                                    00159599
001596                                                                  00159699
001597     EVALUATE TRUE                                                00159799
001598        WHEN SQLCODE = PC-SUCCESSFUL-SQLCODE                      00159899
001599           ADD 1 TO PV-ACCT-COUNT                                 00159999
001600        WHEN SQLCODE = PC-ROW-NOT-FOUND-SQLCODE                   00160099
001601           SET PS-NO-MORE-ROWS        TO TRUE                     00160199
001602        WHEN SQLCODE < PC-SUCCESSFUL-SQLCODE                      00160299
001603           MOVE 'EMP_CSR' TO PV-SQL-TABLE-NAME                    00160399
001604           SET PS-FETCH-TEXT          TO TRUE                     00160499
001605           MOVE ART00001-ACCT-NBR     TO PV-DISPLAY-KEY           00160599
001606           PERFORM 8000-STRING-SQL-FATAL-ERROR                    00160699
001607        WHEN OTHER                                                00160799
001608           MOVE 'EMP_CSR' TO PV-SQL-TABLE-NAME                    00160899
001609           SET PS-FETCH-TEXT          TO TRUE                     00160999
001610           MOVE ART00001-ACCT-NBR     TO PV-DISPLAY-KEY           00161099
001611           PERFORM 8100-STRING-SQL-FATAL-WARNING                  00161199
001612     END-EVALUATE.                                                00161299
001613*---------*                                                       00161399
001614 7100-EXIT.                                                       00161499
001615*---------*                                                       00161599
001616     EXIT.                                                        00161699
001617                                                                  00161799
001618******************************************************************00161899
001619*  END A PREVIOUSLY STARTED BROWSE.                              *00161999
001620******************************************************************00162099
001621 7300-CLOSE-EMP-DN-CSR.                                           00162199
001622     EXEC SQL                                                     00162299
001623        CLOSE EMP_CSR                                             00162399
001624     END-EXEC.                                                    00162499
001625*---------*                                                       00162599
001626 7300-EXIT.                                                       00162699
001627*---------*                                                       00162799
001628     EXIT.                                                        00162899
001633                                                                  00163300
001738                                                                  00173800
001739***************************************************************** 00173900
001740*   SQL ERROR PROCESSING                                          00174000
001741***************************************************************** 00174100
001742 8000-STRING-SQL-FATAL-ERROR.                                     00174200
001743     STRING PS-SQL-ACTION-TEXT             DELIMITED BY SIZE,     00174300
001744            ' '                            DELIMITED BY SIZE,     00174400
001745            PV-DISPLAY-KEY                 DELIMITED BY SIZE,     00174500
001746            ' FROM TABLE '                 DELIMITED BY SIZE,     00174600
001747            PV-SQL-TABLE-NAME              DELIMITED BY SIZE      00174700
001748       INTO DE-ATTEMPTED-ACTION                                   00174800
001749     END-STRING.                                                  00174900
001750                                                                  00175000
001751     MOVE SQLCODE                TO DE-SQLCODE.                   00175100
001752     MOVE SQLERRD(3)             TO DE-ROWS-PROCESSED.            00175200
001753     MOVE DE-DB2-ERROR-MESSAGE   TO PV-LEAVE-SYSTEM-MESSAGE.      00175300
001754     PERFORM 9900-LEAVE-SYSTEM.                                   00175400
001755*---------*                                                       00175500
001756 8000-EXIT.                                                       00175600
001757*---------*                                                       00175700
001758     EXIT.                                                        00175800
001759                                                                  00175900
001760 8100-STRING-SQL-FATAL-WARNING.                                   00176000
001761     STRING PS-SQL-ACTION-TEXT             DELIMITED BY SIZE,     00176100
001762            ' '                            DELIMITED BY SIZE,     00176200
001763            PV-DISPLAY-KEY                 DELIMITED BY SIZE,     00176300
001764            ' FROM TABLE '                 DELIMITED BY SIZE,     00176400
001765            PV-SQL-TABLE-NAME              DELIMITED BY SIZE      00176500
001766       INTO DW-ATTEMPTED-ACTION                                   00176600
001767     END-STRING.                                                  00176700
001768                                                                  00176800
001769     MOVE SQLCODE                TO DW-SQLCODE.                   00176900
001770     MOVE SQLERRD(3)             TO DW-ROWS-PROCESSED.            00177000
001771     MOVE SQLWARN                TO DW-SQLWARN.                   00177100
001772     MOVE DE-DB2-ERROR-MESSAGE   TO PV-LEAVE-SYSTEM-MESSAGE.      00177200
001773     PERFORM 9900-LEAVE-SYSTEM.                                   00177300
001774*---------*                                                       00177400
001775 8100-EXIT.                                                       00177500
001776*---------*                                                       00177600
001777     EXIT.                                                        00177700
001778                                                                  00177800
001779******************************************************************00177900
001780*   RETURN TO THE MAIN MENU IF THE SYSTEM IS ENTERED AT THIS     *00178000
001781*   TRANSACTION ID, OR AFTER COMPLETING THE LISTING FUNCTION.    *00178100
001782******************************************************************00178200
001783 9000-RETURN-TO-MAIN-MENU.                                        00178300
001784     SET CA-INITIALIZE-SCREEN TO TRUE.                            00178400
001785     MOVE PC-CURRENT-PROGRAM-NAME TO CA-LAST-PROGRAM-NAME.        00178500
001786                                                                  00178600
001787     IF EIBCALEN = ZERO                                           00178700
001788         EXEC CICS                                                00178800
001789             XCTL                                                 00178900
001790                 PROGRAM(PC-MAIN-MENU-PROGRAM-NAME)               00179000
001791                 RESP(PV-CICS-RESPONSE)                           00179100
001792         END-EXEC                                                 00179200
001793     ELSE                                                         00179300
001794         EXEC CICS                                                00179400
001795             XCTL                                                 00179500
001796                 PROGRAM(PC-MAIN-MENU-PROGRAM-NAME)               00179600
001797                 COMMAREA(CA-COMMON-AREA)                         00179700
001798                 LENGTH(PC-TRANSFER-UP-LENGTH)                    00179800
001799                 RESP(PV-CICS-RESPONSE)                           00179900
001800         END-EXEC                                                 00180000
001801     END-IF.                                                      00180100
001802                                                                  00180200
001803     IF PV-CICS-RESPONSE NOT = DFHRESP(NORMAL)                    00180300
001804         STRING 'XCTL TO MAIN MENU '       DELIMITED BY SIZE      00180400
001805                PC-MAIN-MENU-PROGRAM-NAME  DELIMITED BY SIZE      00180500
001806             INTO SE-ATTEMPTED-ACTION                             00180600
001807         MOVE PV-CICS-RESPONSE TO SE-CICS-RESPONSE                00180700
001808         MOVE SE-SYSTEM-ERROR-MESSAGE TO                          00180800
001809                   PV-LEAVE-SYSTEM-MESSAGE                        00180900
001810         PERFORM 9900-LEAVE-SYSTEM                                00181000
001811     END-IF.                                                      00181100
001812*---------*                                                       00181200
001813 9000-EXIT.                                                       00181300
001814*---------*                                                       00181400
001815     EXIT.                                                        00181500
001816                                                                  00181600
001817******************************************************************00181700
001818*   PASS CONTROL TO THE EMPLOYEE MAINTENANCE SCREEN WHEN AN      *00181800
001819*   ACCOUNT NUMBER IS SELECTED FOR MAINTENANCE.                  *00181900
001820******************************************************************00182000
001821 9100-TRANSFER-TO-MAINTENANCE.                                    00182100
001822     SET CA-INITIALIZE-SCREEN TO TRUE.                            00182200
001823     MOVE PC-CURRENT-PROGRAM-NAME TO CA-LAST-PROGRAM-NAME.        00182300
001824                                                                  00182400
001828     EXEC CICS                                                    00182800
001829         XCTL                                                     00182900
001830             PROGRAM(PC-MAINTENANCE-PROGRAM-NAME)                 00183000
001831             COMMAREA(CA-COMMON-AREA)                             00183100
001832             LENGTH(PC-TRANSFER-DOWN-LENGTH)                      00183200
001833             RESP(PV-CICS-RESPONSE)                               00183300
001834     END-EXEC.                                                    00183400
001835                                                                  00183500
001836     IF PV-CICS-RESPONSE NOT = DFHRESP(NORMAL)                    00183600
001837         STRING 'XCTL TO '                   DELIMITED BY SIZE    00183700
001838                PC-MAINTENANCE-PROGRAM-NAME  DELIMITED BY SIZE    00183800
001839             INTO SE-ATTEMPTED-ACTION                             00183900
001840         MOVE PV-CICS-RESPONSE TO SE-CICS-RESPONSE                00184000
001841         MOVE SE-SYSTEM-ERROR-MESSAGE TO                          00184100
001842                   PV-LEAVE-SYSTEM-MESSAGE                        00184200
001843         PERFORM 9900-LEAVE-SYSTEM                                00184300
001844     END-IF.                                                      00184400
001845*---------*                                                       00184500
001846 9100-EXIT.                                                       00184600
001847*---------*                                                       00184700
001848     EXIT.                                                        00184800
001849                                                                  00184900
001850******************************************************************00185000
001851*   PASS CONTROL TO THE EMPLOYEE INQUIRY SCREEN WHEN AN ACCOUNT  *00185100
001852*   NUMBER IS SELECTED FOR INQUIRY.                              *00185200
001853******************************************************************00185300
001854 9200-TRANSFER-TO-INQUIRY.                                        00185400
001855     SET CA-INITIALIZE-SCREEN TO TRUE.                            00185500
001856     MOVE PC-CURRENT-PROGRAM-NAME TO CA-LAST-PROGRAM-NAME.        00185600
001857                                                                  00185700
001858     EXEC CICS                                                    00185800
001859         XCTL                                                     00185900
001860             PROGRAM(PC-INQUIRY-PROGRAM-NAME)                     00186000
001861             COMMAREA(CA-COMMON-AREA)                             00186100
001862             LENGTH(PC-TRANSFER-DOWN-LENGTH)                      00186200
001863             RESP(PV-CICS-RESPONSE)                               00186300
001864     END-EXEC.                                                    00186400
001865                                                                  00186500
001866     IF PV-CICS-RESPONSE NOT = DFHRESP(NORMAL)                    00186600
001867         STRING 'XCTL TO '               DELIMITED BY SIZE        00186700
001868                PC-INQUIRY-PROGRAM-NAME  DELIMITED BY SIZE        00186800
001869             INTO SE-ATTEMPTED-ACTION                             00186900
001870         MOVE PV-CICS-RESPONSE TO SE-CICS-RESPONSE                00187000
001871         MOVE SE-SYSTEM-ERROR-MESSAGE TO                          00187100
001872                   PV-LEAVE-SYSTEM-MESSAGE                        00187200
001873         PERFORM 9900-LEAVE-SYSTEM                                00187300
001874     END-IF.                                                      00187400
001875*---------*                                                       00187500
001876 9200-EXIT.                                                       00187600
001877*---------*                                                       00187700
001878     EXIT.                                                        00187800
001879                                                                  00187900
001880******************************************************************00188000
001881*   PASS CONTROL TO THE EMPLOYEE ACCOUNT TRANSFER SCREEN WHEN    *00188100
001882*   AN ACCOUNT NUMBER IS SELECTED FOR TRANSFER TO A NEW ACCOUNT  *00188200
001883*   NUMBER.                                                      *00188300
001884******************************************************************00188400
001885 9300-TRANSFER-TO-ACCT-TRANSFER.                                  00188500
001886     SET CA-INITIALIZE-SCREEN TO TRUE.                            00188600
001887     MOVE PC-CURRENT-PROGRAM-NAME TO CA-LAST-PROGRAM-NAME.        00188700
001888                                                                  00188800
001889     EXEC CICS                                                    00188900
001890         XCTL                                                     00189000
001891             PROGRAM(PC-ACCT-TRANSFER-PROGRAM-NAME)               00189100
001892             COMMAREA(CA-COMMON-AREA)                             00189200
001893             LENGTH(PC-TRANSFER-DOWN-LENGTH)                      00189300
001894             RESP(PV-CICS-RESPONSE)                               00189400
001895     END-EXEC.                                                    00189500
001896                                                                  00189600
001897     IF PV-CICS-RESPONSE NOT = DFHRESP(NORMAL)                    00189700
001898         STRING 'XCTL TO '                     DELIMITED BY SIZE  00189800
001899                PC-ACCT-TRANSFER-PROGRAM-NAME  DELIMITED BY SIZE  00189900
001900             INTO SE-ATTEMPTED-ACTION                             00190000
001901         MOVE PV-CICS-RESPONSE TO SE-CICS-RESPONSE                00190100
001902         MOVE SE-SYSTEM-ERROR-MESSAGE TO                          00190200
001903                   PV-LEAVE-SYSTEM-MESSAGE                        00190300
001904         PERFORM 9900-LEAVE-SYSTEM                                00190400
001905     END-IF.                                                      00190500
001906*---------*                                                       00190600
001907 9300-EXIT.                                                       00190700
001908*---------*                                                       00190800
001909     EXIT.                                                        00190900
001910                                                                  00191000
001911******************************************************************00191100
001912*   EXIT THE ACCOUNTS RECEIVABLE EMPLOYEE DISCOUNT SYSTEM,       *00191200
001913*   DISPLAYING A REASON FOR THE PROGRAM ABEND.                   *00191300
001914******************************************************************00191400
001915 9900-LEAVE-SYSTEM.                                               00191500
001916     EXEC CICS                                                    00191600
001917         SEND                                                     00191700
001918             FROM(PV-LEAVE-SYSTEM-MESSAGE)                        00191800
001919             LENGTH(PC-LEAVE-SYSTEM-LENGTH)                       00191900
001920             ERASE                                                00192000
001921     END-EXEC.                                                    00192100
001922                                                                  00192200
001923     EXEC CICS                                                    00192300
001924         RETURN                                                   00192400
001925     END-EXEC.                                                    00192500
001926*---------*                                                       00192600
001927 9900-EXIT.                                                       00192700
001930*---------*                                                       00193000
002000     EXIT.                                                        00200000
002100*----------------------------------------------------------------*00210000
002200*    ABEND PROCESSOR MODULE                                      *00220000
002300*----------------------------------------------------------------*00230000
002400                                                                  00240000
002500     COPY DPPD013.                                                00250000
002600*----------------------------------------------------------------*00260000
002700* COPY MEMBER DPPD032 CONTAINS STATEMENTS NEEDED TO INVOKE       *00270000
002800* PROTEGRITY MODULE FOR TOKENIZATION                             *00280000
002900*----------------------------------------------------------------*00290000
003000                                                                  00300000
003100     COPY DPPD032.                                                00310000
003200*----------------------------------------------------------------*00320000
