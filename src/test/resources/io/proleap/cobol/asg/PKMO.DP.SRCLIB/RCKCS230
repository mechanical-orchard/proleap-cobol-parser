000100 IDENTIFICATION DIVISION.                                         00010000
000200 PROGRAM-ID.    RCKCS230.                                         00020000
000300 AUTHOR.        ANNE RECKNAGEL.                                   00030000
000400 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00040000
000500 DATE-WRITTEN.  03/24/94.                                         00050000
000600 DATE-COMPILED.                                                   00060000
000700*---------------------------------------------------------------* 00070000
000800*    TRANID      - E230                                         * 00080000
000900*    TYPE        - CICS ARCHITECTURE ADD - DB2                  * 00090000
001000*    DESCRIPTION - ADD A STORE TO THE RECEIVER DISTRIBUTION TBL * 00100000
001100*    MAPSET      - RCKM230                                      * 00110000
001200*                                                               * 00120000
001300*    THIS PROGRAM ALLOWS THE USER TO ADD AN ADDITION STORE TO   * 00130000
001400*    A RECEIVER DISTRIBUTION.  THE RECORD WILL BE ADDED WITH    * 00140000
001500*    ALL INITIALIZED VALUES.  WHEN THE USER PF3'S BACK TO THE   * 00150000
001600*    STORE DISTRIBUTION SCREEN, THE STORE QTY CAN BE UPDATED.   * 00160000
001700*                                                               * 00170000
001800*---------------------------------------------------------------* 00180000
001810* CHANGED 11/10/2021    BY JIM HUNTER      WR: CHG0263784         00181014
001820* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00182015
001830* MAKING THE CALL DYNAMIC VS STATIC.                              00183015
001840*---------------------------------------------------------------* 00184015
001900 ENVIRONMENT DIVISION.                                            00190000
002000 DATA DIVISION.                                                   00200000
002100                                                                  00210000
002200 WORKING-STORAGE SECTION.                                         00220000
002300 01  DK-DB2-KEYS.                                                 00230000
002400     05  DK-PO-NBR                    PIC S9(9) COMP VALUE +0.    00240000
002500     05  DK-OPER-UNT-ID               PIC S9(4) COMP VALUE +0.    00250000
002600     05  DK-FCLTY-ID                  PIC S9(4) COMP VALUE +0.    00260000
002700     05  DK-REC-SEQ-NBR               PIC S9(9) COMP VALUE +0.    00270000
002800     05  DK-PO-LINE-NBR               PIC S9(9) COMP VALUE +0.    00280000
002900     05  DK-STR-DEST-NBR              PIC S9(4) COMP VALUE +0.    00290000
003000     05  DK-PKSL-LNE-NBR              PIC S9(9) COMP VALUE +0.    00300000
003100     05  DK-PACK-ID                   PIC S9(4) COMP VALUE +0.    00310000
003200     05  DK-ITM-NBR                   PIC S9(15)V COMP-3.         00320000
003300                                                                  00330000
003400 01  PC-PROGRAM-CONSTANTS.                                        00340000
003500     05  PC-TRANS-ID                  PIC X(04)  VALUE 'E230'.    00350000
003600     05  PC-CURRENT-PROGRAM-NAME      PIC X(08)  VALUE 'RCKCS230'.00360000
003700     05  PC-CURRENT-MAP-NAME          PIC X(08)  VALUE 'RC230A  '.00370000
003800     05  PC-CURRENT-MAPSET-NAME       PIC X(08)  VALUE 'RCKM230 '.00380000
003900     05  PC-APPL-MAP                  PIC S9(04) VALUE +1 COMP.   00390000
004000     05  PC-1                         PIC S9(09) VALUE +1 COMP.   00400000
004100     05  PC-01                        PIC X(02)  VALUE '01'.      00410000
004200     05  PC-ACTIVE                    PIC X(01)  VALUE 'A'.       00420000
004300     05  PC-AC                        PIC X(02)  VALUE 'AC'.      00430000
004400     05  PC-N                         PIC X(01)  VALUE 'N'.       00440000
004500     05  PC-DASH                      PIC X(01)  VALUE '-'.       00450000
004600     05  PC-AC-DESC                   PIC X(10)  VALUE            00460000
004700                                                 'ACTIVE    '.    00470000
004800     05  PC-DPKUT500                  PIC X(08)  VALUE 'DPKUT500'.00480000
004900     05  PC-RCKCS826                  PIC X(08)  VALUE 'RCKCS826'.00490000
005000     05  PC-AUDIT-RTN-RCKCS290        PIC X(08)  VALUE 'RCKCS290'.00500000
005100     05  PC-DEFAULT-DATE              PIC X(10)  VALUE            00510000
005200                                                 '9999-09-09'.    00520000
005300     05  PC-LINE-LABEL                PIC X(08)  VALUE '    LNE:'.00530000
005400     05  PC-PACK-LABEL                PIC X(08)  VALUE 'PACK ID:'.00540000
005500     05  PC-INTER-APPL-CODES.                                     00550000
005600         10  PC-INTER-APPL-VERIFY     PIC X(01)  VALUE '1'.       00560000
005700         10  PC-INTER-APPL-CONFIRM    PIC X(01)  VALUE '2'.       00570000
005800         10  PC-INTER-APPL-PACKID     PIC X(01)  VALUE '3'.       00580000
005900                                                                  00590000
006000* 00005      INVALID VALUE                                        00600005
006100* 00008      MUST BE NUMERIC                                      00610005
006200* 00034      ADD SUCCESSFUL                                       00620005
006300* 00045      INVALID FUNCTION KEY                                 00630005
006400* 00117      CANNOT ADD - RECORD ALREADY EXISTS                   00640005
006500* 00735      STORE DISTRIBUTION NOT ALLOWED UNLESS PACK SLIP ASSGN00650005
006600* 00844      STORE CLOSED                                         00660005
006700* 00867      CANNOT ADD PACKED BY STORE DISTRO HERE - ADD PKSLIP  00670005
006800* 02193      CANNOT ADD - STORE ALREADY EXISTS FOR PACK-ID        00680005
006900* 03151      WARNING - STORE ELIGIBILITY RULES TABLE NOT AVAILABLE00690005
007000* 03152      CANNOT ADD - STORE NOT ELIGIBLE                      00700005
007100* 03153      WARNING - BAD RETURN FROM STORE ELIGIBILITY ROUTINE  00710005
007200* 03164      WARNING - STORE NOT ELIGIBLE                         00720005
007300* 03799      LINE IS NOT ON THE RECEIVER                          00730005
007400                                                                  00740005
007500     05  PC-TSYMSG-NUMBERS.                                       00750000
007600         10  PC-TSYMSG-00005          PIC 9(05)  VALUE 00005.     00760000
007700         10  PC-TSYMSG-00008          PIC 9(05)  VALUE 00008.     00770000
007800         10  PC-TSYMSG-00034          PIC 9(05)  VALUE 00034.     00780000
007900         10  PC-TSYMSG-00045          PIC 9(05)  VALUE 00045.     00790000
008000         10  PC-TSYMSG-00117          PIC 9(05)  VALUE 00117.     00800000
008100         10  PC-TSYMSG-00735          PIC 9(05)  VALUE 00735.     00810000
008200         10  PC-TSYMSG-00844          PIC 9(05)  VALUE 00844.     00820000
008300         10  PC-TSYMSG-00867          PIC 9(05)  VALUE 00867.     00830000
008400         10  PC-TSYMSG-02193          PIC 9(05)  VALUE 02193.     00840000
008500         10  PC-TSYMSG-03151          PIC 9(05)  VALUE 03151.     00850000
008600         10  PC-TSYMSG-03152          PIC 9(05)  VALUE 03152.     00860000
008700         10  PC-TSYMSG-03153          PIC 9(05)  VALUE 03153.     00870000
008800         10  PC-TSYMSG-03164          PIC 9(05)  VALUE 03164.     00880000
008900         10  PC-TSYMSG-03799          PIC 9(05)  VALUE 03799.     00890005
009000                                                                  00900000
009100 01  PS-PROGRAM-SWITCHES.                                         00910000
009200     05  PS-ERROR-SW                  PIC X(01)  VALUE 'N'.       00920000
009300         88  PS-ERROR                            VALUE 'Y'.       00930000
009400         88  PS-NO-ERROR                         VALUE 'N'.       00940000
009500     05  PS-DISTHD-FOUND-SW           PIC X(01)  VALUE 'N'.       00950000
009600         88  PS-DISTHD-FOUND                     VALUE 'Y'.       00960000
009700         88  PS-DISTHD-NOT-FOUND                 VALUE 'N'.       00970000
009800     05  PS-COMMAREA-SW               PIC X(01)  VALUE 'N'.       00980000
009900         88  PS-COMMAREA-VALID                   VALUE 'Y'.       00990000
010000         88  PS-COMMAREA-NOT-VALID               VALUE 'N'.       01000000
010100     05  PS-RECDIS-EXISTS-SW          PIC X(01)  VALUE 'N'.       01010000
010200         88  PS-RECDIS-FOUND                     VALUE 'Y'.       01020000
010300         88  PS-RECDIS-NOT-FOUND                 VALUE 'N'.       01030000
010400     05  PS-MORE-RECITM-SW            PIC X(01)  VALUE 'N'.       01040000
010500         88  PS-MORE-RECITM-YES                  VALUE 'Y'.       01050000
010600         88  PS-MORE-RECITM-NO                   VALUE 'N'.       01060000
010700     05  PS-STORE-EXISTS-SW           PIC X(01)  VALUE 'N'.       01070000
010800         88  PS-STORE-EXISTS-YES                 VALUE 'Y'.       01080000
010900         88  PS-STORE-EXISTS-NO                  VALUE 'N'.       01090000
011000     05  PS-STORE-NOT-ELIG-SW         PIC X(01)  VALUE 'N'.       01100000
011100         88  PS-STORE-NOT-ELIG-YES               VALUE 'Y'.       01110000
011200         88  PS-STORE-NOT-ELIG-NO                VALUE 'N'.       01120000
011300     05  PS-RULES-AVAIL-SW            PIC X(01)  VALUE 'N'.       01130000
011400         88  PS-RULES-AVAIL-YES                  VALUE 'Y'.       01140000
011500         88  PS-RULES-AVAIL-NO                   VALUE 'N'.       01150000
011600                                                                  01160000
011700 01  PV-PROGRAM-VARIABLES.                                        01170000
011800     05  PV-HOLD-COMP-FIELD           PIC S9(18) VALUE +0         01180009
011900                                                 COMP.            01190009
012000     05  PV-NULL-IND                  PIC S9(04) VALUE +0         01200009
012100                                                 COMP SYNC.       01210009
012200     05  PV-PKSL-NBR-CNT              PIC S9(04) VALUE +0         01220000
012300                                                 COMP SYNC.       01230000
012400     05  PV-SAVE-LNE-NBR              PIC  9(04).                 01240000
012500     05  PV-AUDIT-RTN-LENGTH          PIC S9(04) VALUE +0         01250000
012600                                                 COMP.            01260000
012700     05  PV-CURRENT-TIMESTAMP         PIC  X(26).                 01270000
012800     05  PV-DB2-CURRENT-TMST          PIC  X(26).                 01280000
012900     05  FILLER REDEFINES PV-DB2-CURRENT-TMST.                    01290000
013000         10  PV-DB2-CUR-DATE-CC       PIC  X(02).                 01300000
013100         10  PV-DB2-CUR-DATE-YY       PIC  X(02).                 01310000
013200         10  FILLER                   PIC  X(01).                 01320000
013300         10  PV-DB2-CUR-DATE-MM       PIC  X(02).                 01330000
013400         10  FILLER                   PIC  X(01).                 01340000
013500         10  PV-DB2-CUR-DATE-DD       PIC  X(02).                 01350000
013600         10  FILLER                   PIC  X(16).                 01360000
013700     05  PV-CURRENT-DATE              PIC  X(10).                 01370000
013800     05  FILLER REDEFINES PV-CURRENT-DATE.                        01380000
013900         10  PV-CURRENT-DATE-CC       PIC  X(02).                 01390000
014000         10  PV-CURRENT-DATE-YY       PIC  X(02).                 01400000
014100         10  FILLER                   PIC  X(01).                 01410000
014200         10  PV-CURRENT-DATE-MM       PIC  X(02).                 01420000
014300         10  FILLER                   PIC  X(01).                 01430000
014400         10  PV-CURRENT-DATE-DD       PIC  X(02).                 01440000
014500                                                                  01450000
014600     05  PV-PKSLIP-NBR.                                           01460000
014800         10  PV-PKSLIP-PO-NBR         PIC  9(8).                  01480003
014900         10  PV-PKSLIP-STR-NBR        PIC  9(4).                  01490002
015000     05  PV-ERROR-ORD-NBR             PIC  9(08) VALUE ZEROES.    01500000
015100     05  PV-ERROR-RCVR-SEQ-NBR        PIC  9(04) VALUE ZEROES.    01510000
015200     05  PV-ERROR-ORD-LNE-NBR         PIC  9(04) VALUE ZEROES.    01520000
015300     05  PV-ERROR-STR-NBR             PIC  9(04) VALUE ZEROES.    01530000
015400     05  PV-ERROR-SQLCODE             PIC  9(04) VALUE ZEROES.    01540000
015500                                                                  01550000
015600     05  PV-INTR-UPC-ID               PIC S9(9) COMP.             01560000
015700     05  PV-DEPT-NBR                  PIC S9(4)V COMP-3.          01570000
015800     05  PV-MAJ-CL-NBR                PIC S9(4)V COMP-3.          01580000
015900     05  PV-SUB-CL-NBR                PIC S9(4)V COMP-3.          01590000
016000     05  PV-LOC-TYP-CDE               PIC  X(02).                 01600000
016100         88  PV-VALID-LOC-TYP-CDE    VALUE 'DS', 'DC', 'CS', 'RV'.01610000
016200                                                                  01620000
016300     05  PV-DISP-OPER                 PIC 9(04).                  01630006
016400     05  PV-DISP-FCLTY                PIC 9(04).                  01640006
016500     05  PV-DISP-PO                   PIC 9(09).                  01650006
016600     05  PV-DISP-RCVR                 PIC 9(04).                  01660006
016700     05  PV-DISP-LINE                 PIC 9(04).                  01670006
016800     05  PV-DISP-ITM-NBR              PIC 9(09).                  01680006
017000                                                                  01700006
017100******************************************************************01710000
017200*  DB2 TABLE DECLARATION - LOGISTICS DOMAIN - SKU VIEW            01720000
017300*        (XLV_SKU) XLV00000                                       01730000
017400******************************************************************01740000
017500     EXEC SQL                                                     01750000
017600         INCLUDE XLV00000                                         01760000
017700     END-EXEC.                                                    01770000
017800                                                                  01780000
017900******************************************************************01790000
018000*  DB2 TABLE DECLARATION - LOGISTICS DOMAIN - VENDOR STYLE VIEW   01800000
018100*        (XLV_VND_STYL) XLV00001                                  01810000
018200******************************************************************01820000
018300     EXEC SQL                                                     01830000
018400         INCLUDE XLV00001                                         01840000
018500     END-EXEC.                                                    01850000
018600                                                                  01860000
018700*----------------------------------------------------------------*01870000
018800*    LAYOUT FOR THE COMMAREA TO BE PASSED TO/FROM RCKCS826       *01880000
018900*    (ELIGIBILITY RULES FOR STORES).                             *01890000
019000*----------------------------------------------------------------*01900000
019100     COPY RCRD826.                                                01910000
019200                                                                  01920000
019300*----------------------------------------------------------------*01930000
019400*    THE LAYOUT FOR THE TEMPORARY STORAGE QUEUE CONTAINING       *01940000
019500*    SELECTED LIST ITEMS TO BE PROCESSED BY THIS PROGRAM.        *01950000
019600*----------------------------------------------------------------*01960000
019700     COPY RCWS013.                                                01970000
019800                                                                  01980000
019900*----------------------------------------------------------------*01990000
020000*    MAP LAYOUT                                                  *02000000
020100*----------------------------------------------------------------*02010000
020200     COPY RCKM230.                                                02020000
020300                                                                  02030000
020400*----------------------------------------------------------------*02040000
020500**  SECURITY SUBROUTINE PARAMETERS                                02050000
020600*----------------------------------------------------------------*02060000
020700     COPY DPWS008.                                                02070000
020800                                                                  02080000
020900*----------------------------------------------------------------*02090000
021000*    ATTRIBUTE SETTINGS COPYBOOK.                                *02100000
021100*----------------------------------------------------------------*02110000
021200     COPY DPWS015.                                                02120000
021300                                                                  02130000
021400*----------------------------------------------------------------*02140000
021500*    FUNCTION KEYS COPYBOOK                                      *02150000
021600*----------------------------------------------------------------*02160000
021700     COPY DPWS016.                                                02170000
021800                                                                  02180000
021900*----------------------------------------------------------------*02190000
022000*    THE CALLING PARAMETER LIST (DPWS010) FOR THE NUMERIC EDIT   *02200000
022100*    SUB-ROUTINE (POKUT100).                                     *02210000
022200*----------------------------------------------------------------*02220000
022300     COPY DPWS010I.                                               02230000
022400                                                                  02240000
022500*----------------------------------------------------------------*02250000
022600*  WORK AREA PASSED IN CALL TO DPKUT500                          *02260000
022700*----------------------------------------------------------------*02270000
022800     COPY DPWS500.                                                02280000
022900                                                                  02290000
023000*----------------------------------------------------------------*02300000
023100*  WORK AREA PASSED IN CALL TO XLKUT071 (LOGISTICS LOCATION)     *02310000
023200*----------------------------------------------------------------*02320000
023300     COPY XLWS071.                                                02330000
023400                                                                  02340000
023500******************************************************************02350015
023600** THE CALLING PARAMETER LIST (DPWS030/DPWS930) FOR THE CICS    **02360015
023700** ARCHITECTURE API (BLACK BOX) SUB-ROUTINE.                    **02370015
023800******************************************************************02380015
023900     COPY DPWS030.                                                02390000
023910     COPY DPWS930.                                                02391015
024000                                                                  02400000
024100*----------------------------------------------------------------*02410000
024200*    STANDARD COMMAREA.                                          *02420000
024300*----------------------------------------------------------------*02430000
024400     COPY DPWS020.                                                02440000
024500     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                02450000
024600                                                                  02460000
024700*----------------------------------------------------------------*02470000
024800*    INTER-APPLICATION COMMAREA.                                 *02480000
024900*----------------------------------------------------------------*02490000
025000         10  INTER-APPL-COMM-AREA PIC X(200).                     02500000
025100     COPY RCWS012.                                                02510000
025200     COPY RCWS015.                                                02520000
025300*----------------------------------------------------------------*02530000
025400*    SPECIFIC COMMMAREA FOR RCKCS230.                            *02540000
025500*----------------------------------------------------------------*02550000
025600         10  ASC-SPECIFIC-COMMAREA.                               02560000
025700             15  ASC-USE-SELECTION-QUEUE-IND                      02570000
025800                                            PIC X(01).            02580000
025900                 88  ASC-USE-SELECTION-QUEUE    VALUE 'Y'.        02590000
026000             15  ASC-SEL-QUEUE-NAME         PIC X(08).            02600000
026100             15  ASC-NUMBER-OF-TS-ITEMS     PIC S9(05) COMP-3.    02610000
026200             15  ASC-NUMBER-OF-SELECTED-ITEMS                     02620000
026300                                            PIC S9(09) COMP-3.    02630000
026400             15  ASC-SEL-SUB                PIC S9(04) COMP.      02640000
026500             15  ASC-SEL-ITEM               PIC S9(04) COMP.      02650000
026600             15  ASC-CURRENT-DATE           PIC X(10).            02660000
026700             15  ASC-ACTION-SW              PIC X(03).            02670000
026800                 88  ASC-ADD-PENDING        VALUE 'ADD'.          02680000
026900             15  ASC-EDIT-CONTROL-SW        PIC X(01).            02690000
027000                 88  ASC-RECORD-NOT-ADDED   VALUE 'N'.            02700000
027100                 88  ASC-RECORD-ADDED       VALUE 'Y'.            02710000
027200             15  ASC-ADD-SUCCESSFUL-SW      PIC X(01).            02720000
027300                 88  ASC-ADD-NOT-SUCCESSFUL VALUE ' '.            02730000
027400                 88  ASC-ADD-SUCCESSFUL     VALUE 'Y'.            02740000
027500             15  ASC-KEY-FIELDS.                                  02750000
027600                 20  ASC-KEY-RECEIVER.                            02760000
027700                     25  ASC-KEY-PO-NBR.                          02770000
027900                         30  ASC-KEY-PO-NBR-N                     02790000
028000                                            PIC 9(08).            02800003
028100                     25  ASC-KEY-REC-DASH   PIC X(01).            02810000
028200                     25  ASC-KEY-REC-SEQ-NBR.                     02820000
028300                         30  ASC-KEY-REC-SEQ-NBR-N                02830000
028400                                            PIC 9(04).            02840000
028500                 20  ASC-KEY-OPER-UNT-ID.                         02850000
028600                     25  ASC-KEY-OPER-UNT-ID-N                    02860000
028700                                            PIC 9(04).            02870000
028800                 20  ASC-KEY-FCLTY-ID.                            02880000
028900                     25  ASC-KEY-FCLTY-ID-N PIC 9(04).            02890000
029000                 20  ASC-KEY-FCLTY-NME      PIC X(30).            02900000
029100                 20  ASC-KEY-PKSL-LNE-NBR   PIC 9(04).            02910000
029200                 20  ASC-KEY-VENDOR-NAME    PIC X(30).            02920000
029300                 20  ASC-KEY-PKSL-NBR       PIC X(10).            02930000
029400                 20  ASC-KEY-PACK-ID        PIC 9(04).            02940000
029500                 20  ASC-KEY-PO-LNE-NBR     PIC 9(09).            02950000
029600                 20  ASC-PKGNG-CDE          PIC X(01).            02960000
029700             15  ASC-SCREEN-FIELDS.                               02970000
029800                 20  ASC-STR-DEST-NBR.                            02980000
029900                     25  ASC-STR-DEST-NBR-N PIC 9(04).            02990000
030000                     25  ASC-STR-DEST-NBR-REDEF REDEFINES         03000000
030100                         ASC-STR-DEST-NBR-N.                      03010000
030200                         30  ASC-STR-DEST-NBR-X PIC X(04).        03020000
030300                 20  ASC-STR-DEST-NME       PIC X(30).            03030000
030400             15  ASC-PKSLIP-STR-DEST-NBR    PIC S9(4)  COMP.      03040000
030500                                                                  03050000
030600*----------------------------------------------------------------*03060000
030700*    ABEND PROCESSING COPYBOOK.                                  *03070000
030800*----------------------------------------------------------------*03080000
030900     COPY DPWS013.                                                03090000
031000                                                                  03100000
031100*----------------------------------------------------------------*03110000
031200*    SYSTEM MESSAGE COPYBOOK                                     *03120000
031300*----------------------------------------------------------------*03130000
031400     COPY DPRD507I.                                               03140000
031500                                                                  03150000
031600*----------------------------------------------------------------*03160000
031700*    AUDIT ROUTINE COPYBOOK                                      *03170000
031800*----------------------------------------------------------------*03180000
031900     COPY RCWS031.                                                03190000
032000                                                                  03200000
032100*----------------------------------------------------------------*03210000
032200*    DB2 SQL COMMUNICATION AREA                                   03220000
032300*----------------------------------------------------------------*03230000
032400     EXEC SQL                                                     03240000
032500          INCLUDE SQLCA                                           03250000
032600     END-EXEC.                                                    03260000
032700                                                                  03270000
032800*----------------------------------------------------------------*03280000
032900*    DB2 RECEIVER TABLE                                           03290000
033000*----------------------------------------------------------------*03300000
033100     EXEC SQL                                                     03310000
033200          INCLUDE TRECEIV                                         03320000
033300     END-EXEC.                                                    03330000
033400                                                                  03340000
033500*----------------------------------------------------------------*03350000
033600*    DB2 RECEIVER ITEM TABLE                                      03360000
033700*----------------------------------------------------------------*03370000
033800     EXEC SQL                                                     03380000
033900          INCLUDE TRECITM                                         03390000
034000     END-EXEC.                                                    03400000
034100                                                                  03410000
034200*----------------------------------------------------------------*03420000
034300*    DB2 RECEIVER DISTRIBUTION TABLE                              03430000
034400*----------------------------------------------------------------*03440000
034500     EXEC SQL                                                     03450000
034600          INCLUDE TRECDIS                                         03460000
034700     END-EXEC.                                                    03470000
034800                                                                  03480000
034900*----------------------------------------------------------------*03490000
035000*    DB2 PURCHASE ORDER TABLE                                     03500000
035100*----------------------------------------------------------------*03510000
035200     EXEC SQL                                                     03520000
035300          INCLUDE TPURCHS                                         03530000
035400     END-EXEC.                                                    03540000
035500                                                                  03550000
035600*----------------------------------------------------------------*03560000
035700*    DB2 EXTERNAL ENTERPRISE NAME TABLE                           03570000
035800*----------------------------------------------------------------*03580000
035900     EXEC SQL                                                     03590000
036000          INCLUDE TENTNME                                         03600000
036100     END-EXEC.                                                    03610000
036200                                                                  03620000
036300*----------------------------------------------------------------*03630000
036400*    DB2 PACK SLIP TABLE                                          03640000
036500*----------------------------------------------------------------*03650000
036600     EXEC SQL                                                     03660000
036700          INCLUDE TPKSLIP                                         03670000
036800     END-EXEC.                                                    03680000
036900                                                                  03690000
037000*----------------------------------------------------------------*03700000
037100*    DB2 PACK SLIP ITEM TABLE                                     03710000
037200*----------------------------------------------------------------*03720000
037300     EXEC SQL                                                     03730000
037400          INCLUDE TPKITEM                                         03740000
037500     END-EXEC.                                                    03750000
037600                                                                  03760000
037700                                                                  03770000
037800     EXEC SQL                                                     03780000
037900          INCLUDE TDISTDT                                         03790000
038000     END-EXEC.                                                    03800000
038100                                                                  03810000
038200     EXEC SQL                                                     03820000
038300          INCLUDE TDISTHD                                         03830000
038400     END-EXEC.                                                    03840000
038500                                                                  03850000
038600*----------------------------------------------------------------*03860000
038700*    DB2 CURSOR DEFINITION FOR RETRIEVAL OF PACK SLIP NUMBERS     03870000
038800*----------------------------------------------------------------*03880000
038900     EXEC SQL                                                     03890000
039000          DECLARE PKSLIP-CURSOR CURSOR FOR                        03900000
039100           SELECT PKSL_NBR                                        03910000
039200                , STR_DEST_NBR                                    03920000
039300                , CRE_TMST                                        03930000
039400             FROM TPKSLIP                                         03940000
039500            WHERE PO_NBR              = :DK-PO-NBR                03950000
039600              AND VER_STAT_CDE        = :PC-ACTIVE                03960000
039700              AND OPER_UNT_ID         = :DK-OPER-UNT-ID           03970000
039800              AND FCLTY_ID            = :DK-FCLTY-ID              03980000
039900              AND REC_SEQ_NBR         = :DK-REC-SEQ-NBR           03990000
040000              AND PKSL_STAT_CDE       = :PC-AC                    04000000
040100         ORDER BY CRE_TMST DESC                                   04010000
040200     END-EXEC.                                                    04020000
040300                                                                  04030000
040400*----------------------------------------------------------------*04040000
040500*    DB2 CURSOR DEFINITION FOR RETRIEVAL OF RECITMS FOR A PACK-ID 04050000
040600*----------------------------------------------------------------*04060000
040700     EXEC SQL                                                     04070000
040800         DECLARE RECITM-CURSOR CURSOR FOR                         04080000
040900          SELECT ORD_LNE_NBR                                      04090000
041000               , PREPK_RATO_QTY                                   04100000
041100            FROM TRECITM                                          04110000
041200           WHERE ORD_NBR        = :DK-PO-NBR                      04120000
041300             AND REC_SEQ_NBR    = :DK-REC-SEQ-NBR                 04130000
041400             AND OPER_UNT_ID    = :DK-OPER-UNT-ID                 04140000
041500             AND FCLTY_ID       = :DK-FCLTY-ID                    04150000
041600             AND PREPK_ID       = :DK-PACK-ID                     04160000
041700             AND VER_STATUS_CDE = :PC-ACTIVE                      04170000
041800     END-EXEC.                                                    04180000
041900                                                                  04190000
042000*----------------------------------------------------------------*04200000
042100*    DB2 CURSOR DEFINITION FOR RETRIEVAL OF PACK SLIP NUMBERS     04210000
042200*    FOR A PACKED BY STORE                                        04220000
042300*----------------------------------------------------------------*04230000
042400 LINKAGE SECTION.                                                 04240000
042500                                                                  04250000
042600 01  DFHCOMMAREA.                                                 04260000
042700     05  FILLER                       OCCURS  1 TO 4072 TIMES     04270000
042800                                      DEPENDING ON EIBCALEN.      04280000
042900         10  FILLER                   PIC X.                      04290000
043000                                                                  04300000
043100/                                                                 04310000
043200 PROCEDURE DIVISION.                                              04320000
043300*----------------------------------------------------------------*04330000
043400*    THIS MODULE CONTROLS THE OVERALL PROCESSING IN THE PROGRAM. *04340000
043500*    THE SETUP AND PERFORM OF PARAGRAPH 0001-CALL-CICS-ARCH-API  *04350000
043600*    MUST BE THE FIRST CODE EXECUTED IN THIS PROGRAM.            *04360000
043700*                                                                *04370000
043800*    THE SECOND OR 'EXIT' PERFORM OF THIS PARAGRAPH MUST BE THE  *04380000
043900*    LAST CODE EXECUTED ON EACH ITERATION OF THIS PROGRAM.       *04390000
044000*----------------------------------------------------------------*04400000
044100 0000-MAIN-MODULE.                                                04410000
044200                                                                  04420000
044300     INITIALIZE DP030-CICS-API-FIELDS.                            04430000
044400     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       04440000
044500     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          04450000
044600     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         04460000
044700     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       04470000
044800     MOVE LENGTH OF RC230AI        TO DP030-MAP-LENGTH (1).       04480000
044900     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     04490000
045000     PERFORM 0001-CALL-CICS-ARCH-API.                             04500000
045100                                                                  04510000
045200     EXEC SQL                                                     04520000
045300         SET :PV-DB2-CURRENT-TMST = CURRENT TIMESTAMP             04530000
045400     END-EXEC.                                                    04540000
045500                                                                  04550000
045600     EXEC SQL                                                     04560000
045700         SET :PV-CURRENT-DATE     = CURRENT DATE                  04570000
045800     END-EXEC.                                                    04580000
045900                                                                  04590000
046000     PERFORM 1000-CONTROL-PROCESSING.                             04600000
046100                                                                  04610000
046200     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     04620000
046300     PERFORM 0001-CALL-CICS-ARCH-API.                             04630000
046400                                                                  04640000
046500 0001-CALL-CICS-ARCH-API.                                         04650000
046600                                                                  04660000
046710     CALL DP930-CICS-ARCH-API USING DFHEIBLK                      04671015
046800                                    DFHCOMMAREA                   04680015
046900                                    DP030-CICS-API-FIELDS         04690015
047000                                    DP020-STANDARD-COMMAREA       04700015
047100                                    RC230AI.                      04710015
047200                                                                  04720000
047300     IF  DP030-RC-CALL-SUCCESSFUL                                 04730000
047400         CONTINUE                                                 04740000
047500     ELSE                                                         04750000
047600         SET DP013-NO-ROLLBACK                                    04760000
047700             DP013-XCTL-DISPLAY-RESTART                           04770000
047800             DP013-CICS-ABEND      TO TRUE                        04780000
047900         MOVE 'BEFORE 0000-MAIN-MODULE'                           04790000
048000                                   TO DP013-PARAGRAPH             04800000
048010         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN CODE O04801015
048020-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      04802015
048300         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      04830000
048400         PERFORM DP013-0000-PROCESS-ABEND                         04840000
048500     END-IF.                                                      04850000
048600                                                                  04860000
048700*----------------------------------------------------------------*04870000
048800*    PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT   *04880000
048900*    COURSE OF ACTION IS FOR THIS TRANSACTION.                   *04890000
049000*----------------------------------------------------------------*04900000
049100 1000-CONTROL-PROCESSING.                                         04910000
049200                                                                  04920000
049300     EVALUATE TRUE                                                04930000
049400       WHEN DP020-NEXT-ACT-INITIAL                                04940000
049500           PERFORM 1100-PROCESS-INTER-APPL-COMM                   04950000
049600           IF PS-COMMAREA-NOT-VALID                               04960000
049700               CONTINUE                                           04970000
049800           ELSE                                                   04980000
049900               INITIALIZE XL071-COMMAREA-REC                      04990000
050000               MOVE ASC-KEY-OPER-UNT-ID-N TO XL071-LOCATION-NUMBER05000000
050100               PERFORM 3010-VALIDATE-STR-DEST-NBR                 05010000
050200               IF XL071-NO-ERRORS                                 05020000
050300                   MOVE XL071-LOC-NM      TO ASC-KEY-FCLTY-NME    05030000
050400               END-IF                                             05040000
050500               PERFORM 4000-BUILD-INITIAL-PANEL                   05050000
050600               IF PS-NO-ERROR                                     05060000
050700                   PERFORM 3200-RESET-ATTRIBUTES                  05070000
050800               END-IF                                             05080000
050900           END-IF                                                 05090000
051000                                                                  05100000
051100       WHEN DP020-NEXT-ACT-READ-MAP                               05110000
051200           PERFORM 2000-PROCESS-PANEL                             05120000
051300                                                                  05130000
051400       WHEN DP020-NEXT-ACT-RETURN                                 05140000
051500           PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                   05150000
051600                                                                  05160000
051700       WHEN OTHER                                                 05170000
051800           SET DP013-LOGIC-ABEND                                  05180000
051900               DP013-NO-ROLLBACK TO TRUE                          05190000
052000           MOVE '1000-CONTROL-PROCESSING' TO DP013-PARAGRAPH      05200000
052100           MOVE 'INVALID NEXT ACTIVITY RETURNED TO APPL PGM:'     05210000
052200                TO DP013-MESSAGE-TEXT(1)                          05220000
052300           MOVE DP020-NEXT-APPL-ACTIVITY TO DP013-MESSAGE-TEXT(2) 05230000
052400           PERFORM DP013-0000-PROCESS-ABEND                       05240000
052500     END-EVALUATE.                                                05250000
052600                                                                  05260000
052700*----------------------------------------------------------------*05270000
052800*    DETERMINE THE KEY OF THE OBJECT TO BE UPDATED BASED ON THE  *05280000
052900*    INTER-APPLICATION FORMAT CODE.                              *05290000
053000*                                                                *05300000
053100*    PERFORM SPECIFIC VALIDATIONS FOR EACH "MODE" AND BASED      *05310000
053200*    ON WHERE THE PROGRAM WAS INITIATED FROM.                    *05320000
053300*----------------------------------------------------------------*05330000
053400 1100-PROCESS-INTER-APPL-COMM.                                    05340000
053500                                                                  05350000
053600     SET PS-COMMAREA-VALID TO TRUE.                               05360000
053700                                                                  05370000
053800     INITIALIZE ASC-SPECIFIC-COMMAREA.                            05380000
053900                                                                  05390000
054000     SET DP030-SET-CURSOR-APPL-1                                  05400000
054100         ASC-USE-SELECTION-QUEUE                                  05410000
054200         ASC-ADD-PENDING           TO TRUE.                       05420000
054300                                                                  05430000
054400     MOVE RC015-OPER-UNT-ID        TO ASC-KEY-OPER-UNT-ID-N       05440000
054500                                      DK-OPER-UNT-ID.             05450000
054600     MOVE RC015-FCLTY-ID           TO ASC-KEY-FCLTY-ID-N          05460000
054700                                      DK-FCLTY-ID.                05470000
054800     MOVE -1                       TO ASTRL.                      05480000
054900     MOVE RC015-PO-NBR             TO ASC-KEY-PO-NBR-N            05490000
055000                                      DK-PO-NBR.                  05500000
055100     MOVE SPACES                   TO ASC-STR-DEST-NBR.           05510000
055200     MOVE RC015-REC-SEQ-NBR        TO ASC-KEY-REC-SEQ-NBR-N       05520000
055300                                      DK-REC-SEQ-NBR.             05530000
055400     MOVE RC015-PKSL-NBR           TO ASC-KEY-PKSL-NBR.           05540000
055500     MOVE RC015-PKSL-LNE-NBR       TO ASC-KEY-PKSL-LNE-NBR.       05550000
055600                                                                  05560000
055700     EXEC SQL                                                     05570000
055800          SET :PV-CURRENT-DATE = CURRENT DATE                     05580000
055900     END-EXEC.                                                    05590000
056000                                                                  05600000
056200     MOVE RC015-PO-PACK-ID         TO ASC-KEY-PACK-ID             05620000
056300                                      DK-PACK-ID.                 05630000
056400     MOVE RC015-PO-LNE-NBR         TO ASC-KEY-PO-LNE-NBR.         05640000
056500                                                                  05650000
056600     PERFORM 1110-OPEN-CURSOR.                                    05660000
056700     PERFORM 1120-GET-PACK-SLIPS.                                 05670000
056800     PERFORM 1130-CLOSE-CURSOR.                                   05680000
056900                                                                  05690000
057000*----------------------------------------------------------------*05700000
057100 1110-OPEN-CURSOR.                                                05710000
057200                                                                  05720000
057300     EXEC SQL                                                     05730000
057400          OPEN PKSLIP-CURSOR                                      05740000
057500     END-EXEC.                                                    05750000
057600                                                                  05760000
057700     EVALUATE TRUE                                                05770000
057800         WHEN SQLCODE = ZERO                                      05780000
057900         WHEN SQLCODE = -904                                      05790000
058000         WHEN SQLCODE = -913                                      05800000
058100              CONTINUE                                            05810000
058200                                                                  05820000
058300         WHEN SQLWARN0 NOT = SPACES                               05830000
058400         WHEN SQLCODE  NOT = ZERO                                 05840000
058500              MOVE '1110-OPEN-CURSOR'                             05850000
058600                               TO DP013-PARAGRAPH                 05860000
058700              MOVE 'UNSUCCESSFUL PACK SLIP CURSOR OPEN'           05870000
058800                               TO DP013-MESSAGE-TEXT (1)          05880000
058900              MOVE SQLCA TO DP013-SQLCA                           05890000
059000              MOVE 'TPKSLIP'   TO DP013-DB2-TABLE-NAME (1)        05900000
059100              SET DP013-XCTL-DISPLAY-RESTART                      05910000
059200                  DP013-DB2-ABEND                                 05920000
059300                               TO TRUE                            05930000
059400                                                                  05940000
059500              PERFORM DP013-0000-PROCESS-ABEND                    05950000
059600     END-EVALUATE.                                                05960000
059700                                                                  05970000
059800*----------------------------------------------------------------*05980000
059900 1120-GET-PACK-SLIPS.                                             05990000
060000                                                                  06000000
060100     EXEC SQL                                                     06010000
060200          FETCH  PKSLIP-CURSOR                                    06020000
060300           INTO :PKSLIP-PKSL-NBR,                                 06030000
060400                :PKSLIP-STR-DEST-NBR,                             06040000
060500                :PKSLIP-CRE-TMST                                  06050000
060600     END-EXEC.                                                    06060000
060700                                                                  06070000
060800     EVALUATE TRUE                                                06080000
060900         WHEN SQLCODE = ZERO                                      06090000
061000         WHEN SQLCODE = +100                                      06100000
061100              CONTINUE                                            06110000
061200                                                                  06120000
061300         WHEN SQLWARN0 NOT = SPACES                               06130000
061400         WHEN SQLCODE  NOT = ZERO                                 06140000
061500              MOVE '1120-FETCH-PACK-SLIP'                         06150000
061600                                   TO DP013-PARAGRAPH             06160000
061700              MOVE 'UNSUCCESSFUL FETCH OF PACK SLIP CURSOR'       06170000
061800                                   TO DP013-MESSAGE-TEXT (1)      06180000
061900              MOVE SQLCA           TO DP013-SQLCA                 06190000
062000              MOVE 'TPKSLIP'       TO DP013-DB2-TABLE-NAME (1)    06200000
062100              SET DP013-DB2-ABEND                                 06210000
062200                  DP013-XCTL-DISPLAY-RESTART                      06220000
062300                                   TO TRUE                        06230000
062400                                                                  06240000
062500              PERFORM DP013-0000-PROCESS-ABEND                    06250000
062600     END-EVALUATE.                                                06260000
062700                                                                  06270000
062800     IF SQLCODE = +100                                            06280000
062900         PERFORM 4080-CHECK-RACF                                  06290000
063000         IF DP008-ACCESS-DENIED                                   06300000
063100             SET PS-COMMAREA-NOT-VALID                            06310000
063200                 DP020-NEXT-ACT-APPL-ERROR                        06320000
063300                 DP020-MSG-WARNING                                06330000
063400                 PS-ERROR              TO TRUE                    06340000
063500             MOVE PC-TSYMSG-00735      TO DP020-MSG-NUMBER        06350000
063600         ELSE                                                     06360000
063700             CONTINUE                                             06370000
063800         END-IF                                                   06380000
063900     ELSE                                                         06390000
064000         MOVE PKSLIP-STR-DEST-NBR  TO ASC-PKSLIP-STR-DEST-NBR     06400000
064100         IF PKSLIP-STR-DEST-NBR > ZERO                            06410000
064200             PERFORM 4080-CHECK-RACF                              06420000
064300             IF DP008-ACCESS-ALLOWED OR                           06430000
064400                DP020-INT-APPL-FORMAT-IND = PC-INTER-APPL-VERIFY  06440000
064500                 PERFORM 1140-COUNT-PKSL-NBR                      06450000
064600                 IF PV-PKSL-NBR-CNT = 1                           06460000
064700                     MOVE PKSLIP-PKSL-NBR                         06470000
064800                                   TO ASC-KEY-PKSL-NBR            06480000
064900                 END-IF                                           06490000
065000             ELSE                                                 06500000
065100                 SET PS-COMMAREA-NOT-VALID                        06510000
065200                     DP020-NEXT-ACT-APPL-ERROR                    06520000
065300                     DP020-MSG-WARNING                            06530000
065400                     PS-ERROR      TO TRUE                        06540000
065500                 MOVE PC-TSYMSG-00867                             06550000
065600                                   TO DP020-MSG-NUMBER            06560000
065700             END-IF                                               06570000
065800         ELSE                                                     06580000
065900             IF RC015-PKSL-NBR NOT > SPACES                       06590000
066000                 MOVE PKSLIP-PKSL-NBR                             06600000
066100                                   TO ASC-KEY-PKSL-NBR            06610000
066200             END-IF                                               06620000
066300         END-IF                                                   06630000
066400     END-IF.                                                      06640000
066500                                                                  06650000
066600*----------------------------------------------------------------*06660000
066700 1130-CLOSE-CURSOR.                                               06670000
066800                                                                  06680000
066900     EXEC SQL                                                     06690000
067000          CLOSE PKSLIP-CURSOR                                     06700000
067100     END-EXEC.                                                    06710000
067200                                                                  06720000
067300     EVALUATE TRUE                                                06730000
067400         WHEN SQLCODE = ZERO                                      06740000
067500              CONTINUE                                            06750000
067600                                                                  06760000
067700         WHEN SQLWARN0 NOT = SPACES                               06770000
067800         WHEN SQLCODE  NOT = ZERO                                 06780000
067900              MOVE '1130-CLOSE-CURSOR'                            06790000
068000                                   TO DP013-PARAGRAPH             06800000
068100              MOVE 'UNSUCCESSFUL PACK SLIP CURSOR CLOSE'          06810000
068200                                   TO DP013-MESSAGE-TEXT (1)      06820000
068300              MOVE SQLCA           TO DP013-SQLCA                 06830000
068400              MOVE 'TPKSLIP '      TO DP013-DB2-TABLE-NAME (1)    06840000
068500              SET DP013-DB2-ABEND                                 06850000
068600                  DP013-XCTL-DISPLAY-RESTART                      06860000
068700                                   TO TRUE                        06870000
068800                                                                  06880000
068900              PERFORM DP013-0000-PROCESS-ABEND                    06890000
069000     END-EVALUATE.                                                06900000
069100                                                                  06910000
069200*----------------------------------------------------------------*06920000
069300 1140-COUNT-PKSL-NBR.                                             06930000
069400                                                                  06940000
069500     INITIALIZE PV-PKSL-NBR-CNT.                                  06950000
069600                                                                  06960000
069700     EXEC SQL                                                     06970000
069800         SELECT COUNT(DISTINCT PKSL_NBR)                          06980000
069900          INTO  :PV-PKSL-NBR-CNT :PV-NULL-IND                     06990000
070000           FROM TPKSLIP                                           07000000
070100          WHERE PO_NBR          = :DK-PO-NBR                      07010000
070200            AND REC_SEQ_NBR     = :DK-REC-SEQ-NBR                 07020000
070300            AND VER_STAT_CDE    = :PC-ACTIVE                      07030000
070400            AND PKSL_STAT_CDE   = :PC-AC                          07040000
070500     END-EXEC                                                     07050000
070600                                                                  07060000
070700     EVALUATE TRUE                                                07070000
070800         WHEN SQLCODE = ZERO                                      07080000
070900         WHEN SQLCODE = +100                                      07090000
071000         WHEN SQLCODE = -904                                      07100000
071100         WHEN SQLCODE = -913                                      07110000
071200              CONTINUE                                            07120000
071300                                                                  07130000
071400         WHEN SQLWARN0 NOT = SPACES                               07140000
071500         WHEN SQLCODE  NOT = ZERO                                 07150000
071600              MOVE '1140-COUNT-PKSL-NBR'                          07160000
071700                             TO DP013-PARAGRAPH                   07170000
071800              MOVE 'UNSUCCESSFUL COUNT OF TPKSLIP NBRS'           07180000
071900                             TO DP013-MESSAGE-TEXT (1)            07190000
072000              MOVE SQLCA     TO DP013-SQLCA                       07200000
072100              MOVE 'TPKSLIP' TO DP013-DB2-TABLE-NAME (1)          07210000
072200              SET DP013-DB2-ABEND                                 07220000
072300                  DP013-XCTL-DISPLAY-RESTART                      07230000
072400                             TO TRUE                              07240000
072500              PERFORM DP013-0000-PROCESS-ABEND                    07250000
072600     END-EVALUATE.                                                07260000
072700                                                                  07270000
072800*----------------------------------------------------------------*07280000
072900*    DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA*07290000
073000*    ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT*07300000
073100*    USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE    *07310000
073200*    REST OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO      *07320000
073300*    INVALID FUNCTION KEYS CAN GET THIS FAR.                     *07330000
073400*----------------------------------------------------------------*07340000
073500 2000-PROCESS-PANEL.                                              07350000
073600                                                                  07360000
073700     EVALUATE TRUE                                                07370000
073800                                                                  07380000
073900         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              07390000
074000             IF  ASC-ADD-PENDING AND                              07400000
074100                 DP020-SRC-AID = DP016-PF13                       07410000
074200                 PERFORM 2200-MOVE-SCREEN-TO-COMMAREA             07420000
074300                 PERFORM 3000-EDIT-DATA-IN-COMMAREA               07430000
074400                 IF  PS-NO-ERROR                                  07440000
074500                     SET DP030-CONTINUE-GO                        07450000
074600                         ASC-RECORD-ADDED                         07460000
074700                                   TO TRUE                        07470000
074800                     PERFORM 5000-ADD-RECDIS                      07480000
074900                 ELSE                                             07490000
075000                     SET DP030-OVERRIDE-GO                        07500000
075100                                   TO TRUE                        07510000
075200                 END-IF                                           07520000
075300             END-IF                                               07530000
075400                                                                  07540000
075500         WHEN DP020-SRC-AID = DP016-CLEAR                         07550000
075600             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   07560000
075700             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 07570000
075800                                                                  07580000
075900         WHEN DP020-FK-REFRESH(DP020-SRC-AID)                     07590000
076000             INITIALIZE ASC-SCREEN-FIELDS                         07600000
076100             SET DP030-SET-CURSOR-APPL-1                          07610000
076200                                   TO TRUE                        07620000
076300             MOVE -1               TO ASTRL                       07630000
076400             PERFORM 4000-BUILD-INITIAL-PANEL                     07640000
076500             PERFORM 3200-RESET-ATTRIBUTES                        07650000
076600                                                                  07660000
076700         WHEN OTHER                                               07670000
076800             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 07680000
076900             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   07690000
077000             IF  PS-NO-ERROR                                      07700000
077100                 SET DP030-CONTINUE-GO                            07710000
077200                                   TO TRUE                        07720000
077300                 PERFORM 2100-CHECK-FUNCTION-KEY                  07730000
077400             ELSE                                                 07740000
077500                 SET DP030-OVERRIDE-GO                            07750000
077600                                   TO TRUE                        07760000
077700             END-IF                                               07770000
077800     END-EVALUATE.                                                07780000
077900                                                                  07790000
078000*----------------------------------------------------------------*07800000
078100*    ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED    *07810000
078200*    FIRST.  NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED*07820000
078300*    FROM THE CICS ARCHITECTURE API.                             *07830000
078400*----------------------------------------------------------------*07840000
078500 2100-CHECK-FUNCTION-KEY.                                         07850000
078600                                                                  07860000
078700     EVALUATE TRUE                                                07870000
078800         WHEN DP020-SRC-AID = DP016-ENTER                         07880000
078900             CONTINUE                                             07890000
079000                                                                  07900000
079100         WHEN OTHER                                               07910000
079200             SET DP013-NO-ROLLBACK                                07920000
079300                 DP013-XCTL-DISPLAY-RESTART                       07930000
079400                 DP013-CICS-ABEND  TO TRUE                        07940000
079500             MOVE '2100-CHECK-FUNCTION-KEY'                       07950000
079600                                   TO DP013-PARAGRAPH             07960000
079700             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      07970000
079800                                   TO DP013-MESSAGE-TEXT (1)      07980000
079900             PERFORM DP013-0000-PROCESS-ABEND                     07990000
080000     END-EVALUATE.                                                08000000
080100                                                                  08010000
080200*----------------------------------------------------------------*08020000
080300*  MOVE ALL OF THE FIELDS THAT WERE ENTERED / CHANGED ON THE     *08030000
080400*  SCREEN INTO THE COMMAREA.  ALL EDITTING IS DONE IN THE COMM.  *08040000
080500*----------------------------------------------------------------*08050000
080600 2200-MOVE-SCREEN-TO-COMMAREA.                                    08060000
080700                                                                  08070000
080800     IF ASTRL > ZERO                                              08080000
080900         MOVE ASTRI                TO ASC-STR-DEST-NBR            08090000
081000     ELSE                                                         08100000
081100         IF ASTRF = DP015-ERASE-EOF                               08110000
081200             MOVE ZEROES           TO ASC-STR-DEST-NBR            08120000
081300         END-IF                                                   08130000
081400     END-IF.                                                      08140000
081500                                                                  08150000
081600*----------------------------------------------------------------*08160000
081700*  EDIT ALL OF THE DATA ON THE SCREEN AS IT RESIDES IN THE       *08170000
081800*  COMMAREA (EDITTING IS NOT DONE AGAINST THE SCREEN DIRECTLY).  *08180000
081900*----------------------------------------------------------------*08190000
082000 3000-EDIT-DATA-IN-COMMAREA.                                      08200000
082100                                                                  08210000
082200     SET PS-NO-ERROR               TO TRUE.                       08220000
082300                                                                  08230000
082400     PERFORM 3200-RESET-ATTRIBUTES.                               08240000
082500                                                                  08250000
082600     MOVE ASC-KEY-OPER-UNT-ID-N    TO DK-OPER-UNT-ID.             08260000
082700     MOVE ASC-KEY-FCLTY-ID-N       TO DK-FCLTY-ID.                08270000
082800     MOVE ASC-KEY-PO-NBR-N         TO DK-PO-NBR.                  08280000
082900     MOVE ASC-KEY-REC-SEQ-NBR-N    TO DK-REC-SEQ-NBR.             08290000
083000                                                                  08300000
083100     IF  ASC-STR-DEST-NBR > SPACES                                08310000
083200         MOVE ASC-STR-DEST-NBR     TO DP010I-UNEDITED-FIELD       08320000
083300         MOVE LENGTH OF ASC-STR-DEST-NBR                          08330000
083400                                   TO DP010I-MAXIMUM-DIGITS       08340000
083500         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     08350000
083600         SET DP010I-NEGATIVE-NOT-ALLOWED                          08360000
083700                                   TO TRUE                        08370000
083800         CALL DP010I-NUMERIC-EDIT-ROUTINE                         08380015
083810              USING DP010I-NUMERIC-EDIT-AREA                      08381015
083900                                                                  08390000
084000         IF  DP010I-ERROR-DETECTED                                08400000
084100             SET PS-ERROR                                         08410000
084200                 DP020-MSG-FATAL   TO TRUE                        08420000
084300             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            08430000
084400             MOVE DP015-UNP-NUM-BRT-OFF                           08440000
084500                                   TO ASTRA                       08450000
084600             MOVE DP015-RED        TO ASTRC                       08460000
084700             MOVE DP015-REVERSE    TO ASTRH                       08470000
084800             MOVE -1               TO ASTRL                       08480000
084900             SET DP030-SET-CURSOR-APPL-1                          08490000
085000                                   TO TRUE                        08500000
085100         ELSE                                                     08510000
085200             MOVE DP010I-NUMERIC-FIELD                            08520000
085300                                   TO ASC-STR-DEST-NBR-N          08530000
085400                                      DK-STR-DEST-NBR             08540000
085500             MOVE ASC-STR-DEST-NBR TO ASTRO                       08550000
085600             INITIALIZE XL071-COMMAREA-REC                        08560000
085700             MOVE ASC-STR-DEST-NBR-N TO XL071-LOCATION-NUMBER     08570000
085800             PERFORM 3010-VALIDATE-STR-DEST-NBR                   08580000
085900             EVALUATE TRUE                                        08590000
086000                 WHEN XL071-NO-ERRORS                             08600000
086100                     MOVE XL071-LOC-NM TO ASC-STR-DEST-NME        08610000
086200                                          ASDESCO                 08620000
086300                 WHEN XL071-LOC-NOT-FOUND                         08630000
086400                 WHEN XL071-DC-ASGMT-NOT-FND                      08640000
086500                     SET DP020-MSG-FATAL                          08650000
086600                         PS-ERROR              TO TRUE            08660000
086700                     MOVE PC-TSYMSG-00005      TO DP020-MSG-NUMBER08670000
086800                     MOVE DP015-UNP-ALP-BRT-OFF TO ASTRA          08680000
086900                     MOVE DP015-RED            TO ASTRC           08690000
087000                     MOVE DP015-REVERSE        TO ASTRH           08700000
087100                     MOVE -1                   TO ASTRL           08710000
087200                     SET DP030-SET-CURSOR-APPL-1 TO TRUE          08720000
087300             END-EVALUATE                                         08730000
087400         END-IF                                                   08740000
087500     END-IF.                                                      08750000
087600                                                                  08760000
087700     IF PS-NO-ERROR                                               08770000
087800         MOVE XL071-LOC-TYP-CDE TO PV-LOC-TYP-CDE                 08780000
087900         IF PV-VALID-LOC-TYP-CDE                                  08790000
088000             IF  (PV-CURRENT-DATE = XL071-CLO-DTE OR              08800000
088100                  PV-CURRENT-DATE < XL071-CLO-DTE)                08810000
088200                 CONTINUE                                         08820000
088300             ELSE                                                 08830000
088400                 SET DP020-MSG-FATAL                              08840000
088500                     PS-ERROR               TO TRUE               08850000
088600                 MOVE PC-TSYMSG-00844       TO DP020-MSG-NUMBER   08860000
088700                 MOVE DP015-UNP-ALP-BRT-OFF TO ASTRA              08870000
088800                 MOVE DP015-RED             TO ASTRC              08880000
088900                 MOVE DP015-REVERSE         TO ASTRH              08890000
089000                 MOVE -1                    TO ASTRL              08900000
089100                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              08910000
089200             END-IF                                               08920000
089300         ELSE                                                     08930000
089400**************LOCATION NOT DC, DS, CS, RV                         08940000
089500             SET DP020-MSG-FATAL                                  08950000
089600                 PS-ERROR          TO TRUE                        08960000
089700             MOVE PC-TSYMSG-00005  TO DP020-MSG-NUMBER            08970000
089800             MOVE DP015-UNP-ALP-BRT-OFF                           08980000
089900                                   TO ASTRA                       08990000
090000             MOVE DP015-RED        TO ASTRC                       09000000
090100             MOVE DP015-REVERSE    TO ASTRH                       09010000
090200             MOVE -1               TO ASTRL                       09020000
090300             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  09030000
090400         END-IF                                                   09040000
090500     END-IF.                                                      09050000
090600                                                                  09060000
090700     IF  PS-NO-ERROR                                              09070000
090800         IF  DP020-INT-APPL-FORMAT-IND = PC-INTER-APPL-VERIFY     09080000
090900         OR  DP020-INT-APPL-FORMAT-IND = PC-INTER-APPL-CONFIRM    09090000
091000             CONTINUE                                             09100000
091100         ELSE                                                     09110000
091200             IF PV-VALID-LOC-TYP-CDE                              09120000
091300                 IF ((PV-CURRENT-DATE = XL071-ASGMT-EFF-BEG-DTE OR09130000
091400                      PV-CURRENT-DATE > XL071-ASGMT-EFF-BEG-DTE)  09140000
091500                                     AND                          09150000
091600                    (PV-CURRENT-DATE = XL071-ASGMT-EFF-STP-DTE OR 09160000
091700                     PV-CURRENT-DATE < XL071-ASGMT-EFF-STP-DTE))  09170000
091800                     CONTINUE                                     09180000
091900                 ELSE                                             09190000
092000                     SET DP020-MSG-FATAL                          09200000
092100                         PS-ERROR               TO TRUE           09210000
092200                     MOVE PC-TSYMSG-00844     TO DP020-MSG-NUMBER 09220000
092300                     MOVE DP015-UNP-ALP-BRT-OFF TO ASTRA          09230000
092400                     MOVE DP015-RED             TO ASTRC          09240000
092500                     MOVE DP015-REVERSE         TO ASTRH          09250000
092600                     MOVE -1                    TO ASTRL          09260000
092700                    SET DP030-SET-CURSOR-APPL-1 TO TRUE           09270000
092800                 END-IF                                           09280000
092900             ELSE                                                 09290000
093000**************LOCATION NOT DC, DS, CS, RV                         09300000
093100                 SET DP020-MSG-FATAL                              09310000
093200                     PS-ERROR                TO TRUE              09320000
093300                 MOVE PC-TSYMSG-00005        TO DP020-MSG-NUMBER  09330000
093400                 MOVE DP015-UNP-ALP-BRT-OFF  TO ASTRA             09340000
093500                 MOVE DP015-RED              TO ASTRC             09350000
093600                 MOVE DP015-REVERSE          TO ASTRH             09360000
093700                 MOVE -1                     TO ASTRL             09370000
093800                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              09380000
093900             END-IF                                               09390000
094000         END-IF                                                   09400000
094100     END-IF.                                                      09410000
094200                                                                  09420000
094300     IF PS-NO-ERROR                                               09430000
094400         IF DP020-INT-APPL-FORMAT-IND = PC-INTER-APPL-PACKID      09440000
094500           OR ((ASC-PKGNG-CDE = 'I' OR 'M')                       09450000
094600            AND (ASC-KEY-PACK-ID > ZEROES))                       09460000
094700             SET PS-MORE-RECITM-YES   TO TRUE                     09470000
094800             SET PS-STORE-EXISTS-NO   TO TRUE                     09480000
094900             SET PS-STORE-NOT-ELIG-NO TO TRUE                     09490000
095000             SET PS-RULES-AVAIL-YES   TO TRUE                     09500000
095100             MOVE ASC-KEY-PACK-ID TO DK-PACK-ID                   09510000
095200             PERFORM 5001-OPEN-RECITM-CURSOR                      09520000
095300             PERFORM 3005-GET-RECITMS                             09530000
095400               UNTIL PS-MORE-RECITM-NO                            09540000
095500                OR PS-STORE-EXISTS-YES                            09550000
095600                OR PS-STORE-NOT-ELIG-YES                          09560000
095700                OR PS-RULES-AVAIL-NO                              09570000
095800             PERFORM 5002-CLOSE-RECITM-CURSOR                     09580000
095900         ELSE                                                     09590000
096000             PERFORM 3020-SELECT-RECDIS                           09600000
096100             IF PS-RECDIS-FOUND  AND                              09610000
096200                DP020-INT-APPL-FORMAT-IND = PC-INTER-APPL-CONFIRM 09620000
096300                  CONTINUE                                        09630000
096400             ELSE                                                 09640000
096500                 IF PS-RECDIS-FOUND                               09650000
096600                     SET DP020-MSG-FATAL                          09660000
096700                         PS-ERROR          TO TRUE                09670000
096800                     MOVE PC-TSYMSG-02193  TO DP020-MSG-NUMBER    09680000
096900                     MOVE DP015-UNP-ALP-BRT-OFF TO ASTRA          09690000
097000                     MOVE DP015-RED        TO ASTRC               09700000
097100                     MOVE DP015-REVERSE    TO ASTRH               09710000
097200                     MOVE -1               TO ASTRL               09720000
097300                     SET DP030-SET-CURSOR-APPL-1 TO TRUE          09730000
097500                 ELSE                                             09750000
097600                     PERFORM 3006-LOAD-RC826-COMMAREA             09760000
097800                     IF  PS-NO-ERROR                              09780007
098000                         SET RC826-STR-ELIGIBLE TO TRUE           09800007
098100                         EXEC CICS                                09810007
098200                             LINK PROGRAM (PC-RCKCS826)           09820007
098300                             COMMAREA (RC826-COMMAREA)            09830007
098400                         END-EXEC                                 09840007
098500                                                                  09850000
098600                         EVALUATE TRUE                            09860007
098700                           WHEN RC826-STR-ELIGIBLE                09870007
098800                               CONTINUE                           09880007
098900*10/17/03 - SEND WARNING(NOT ERROR) MESSAGE IF STORE NOT ELIGIBLE.09890000
099000                           WHEN RC826-STR-NOT-ELIGIBLE            09900007
099100                                SET DP020-MSG-WARNING TO TRUE     09910007
099200                                MOVE PC-TSYMSG-03164              09920007
099300                                               TO DP020-MSG-NUMBER09930007
099400                                MOVE DP015-UNP-ALP-BRT-OFF        09940007
099500                                                       TO ASTRA   09950007
099600                                MOVE DP015-YELLOW      TO ASTRC   09960007
099700                                MOVE DP015-REVERSE     TO ASTRH   09970007
099800                                MOVE -1                TO ASTRL   09980007
099900                                SET DP030-SET-CURSOR-APPL-1       09990007
100000                                                       TO TRUE    10000007
100100*SEND WARNING MESSAGE IF ELIGIBILITY RULES TABLE NOT AVAILABLE.   10010000
100200                           WHEN RC826-RULES-NOT-AVAIL             10020007
100300                                SET DP020-MSG-WARNING   TO TRUE   10030007
100400                                MOVE PC-TSYMSG-03151              10040007
100500                                               TO DP020-MSG-NUMBER10050007
100600                                MOVE DP015-UNP-ALP-BRT-OFF        10060007
100700                                                       TO ASTRA   10070007
100800                                MOVE DP015-YELLOW      TO ASTRC   10080007
100900                                MOVE DP015-REVERSE     TO ASTRH   10090007
101000                                MOVE -1                TO ASTRL   10100007
101100                                SET DP030-SET-CURSOR-APPL-1       10110007
101200                                                       TO TRUE    10120007
101300*SEND WARNING MESSAGE IF UNKNOWN CODE RETURNED FROM RCKCS826.     10130000
101400                            WHEN OTHER                            10140007
101500                                 SET DP020-MSG-WARNING  TO TRUE   10150007
101600                                 MOVE PC-TSYMSG-03153             10160007
101700                                               TO DP020-MSG-NUMBER10170007
101800                                 MOVE DP015-UNP-ALP-BRT-OFF       10180007
101900                                                       TO ASTRA   10190007
102000                                 MOVE DP015-YELLOW     TO ASTRC   10200007
102100                                 MOVE DP015-REVERSE    TO ASTRH   10210007
102200                                 MOVE -1               TO ASTRL   10220007
102300                                SET DP030-SET-CURSOR-APPL-1       10230007
102400                                                       TO TRUE    10240007
102500                         END-EVALUATE                             10250007
102700                     END-IF                                       10270007
102900                 END-IF                                           10290000
103000             END-IF                                               10300000
103100         END-IF                                                   10310000
103200     END-IF.                                                      10320000
103300                                                                  10330000
103400     IF  PS-NO-ERROR                                              10340000
103500         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                     10350000
103600         MOVE -1                   TO ASTRL                       10360000
103700         SET DP030-SET-CURSOR-APPL-1                              10370000
103800                                   TO TRUE                        10380000
103900     END-IF.                                                      10390000
104000                                                                  10400000
104100*----------------------------------------------------------------*10410000
104200 3005-GET-RECITMS.                                                10420000
104300                                                                  10430000
104400     PERFORM 5004-FETCH-RECITM.                                   10440000
104500                                                                  10450000
104600     IF PS-MORE-RECITM-YES                                        10460000
104700         MOVE RECITM-ORD-LNE-NBR TO DK-PKSL-LNE-NBR               10470000
104800                                    DK-PO-LINE-NBR                10480000
104900         PERFORM 5005-CHECK-FOR-EXISTING                          10490000
105000         IF PS-RECDIS-FOUND                                       10500000
105100             SET PS-STORE-EXISTS-YES     TO TRUE                  10510000
105200             SET DP020-MSG-FATAL                                  10520000
105300                 PS-ERROR                TO TRUE                  10530000
105400             MOVE PC-TSYMSG-00117        TO DP020-MSG-NUMBER      10540000
105500             MOVE DP015-UNP-ALP-BRT-OFF  TO ASTRA                 10550000
105600             MOVE DP015-RED              TO ASTRC                 10560000
105700             MOVE DP015-REVERSE          TO ASTRH                 10570000
105800             MOVE -1                     TO ASTRL                 10580000
105900             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  10590000
106000*7/10/03 - ADD EDIT FOR ELIGIBILITY RULES (PGM RCKCS826)          10600000
106100         ELSE                                                     10610000
106200             PERFORM 3006-LOAD-RC826-COMMAREA                     10620000
106300             SET RC826-STR-ELIGIBLE TO TRUE                       10630000
106400             EXEC CICS                                            10640000
106500                 LINK PROGRAM (PC-RCKCS826)                       10650000
106600                 COMMAREA (RC826-COMMAREA)                        10660000
106700             END-EXEC                                             10670000
106800                                                                  10680000
106900             EVALUATE TRUE                                        10690000
107000               WHEN RC826-STR-ELIGIBLE                            10700000
107100                   CONTINUE                                       10710000
107200*SEND ERROR MESSAGE IF STORE NOT ELIGIBLE.                        10720000
107300               WHEN RC826-STR-NOT-ELIGIBLE                        10730000
107400                   SET DP020-MSG-WARNING       TO TRUE            10740000
107500                   MOVE PC-TSYMSG-03164 TO DP020-MSG-NUMBER       10750000
107600                   MOVE DP015-UNP-ALP-BRT-OFF  TO ASTRA           10760000
107700                   MOVE DP015-YELLOW           TO ASTRC           10770000
107800                   MOVE DP015-REVERSE          TO ASTRH           10780000
107900                   MOVE -1                     TO ASTRL           10790000
108000                   SET DP030-SET-CURSOR-APPL-1 TO TRUE            10800000
108100*SEND WARNING MESSAGE IF ELIGIBILITY RULES TABLE NOT AVAILABLE.   10810000
108200               WHEN RC826-RULES-NOT-AVAIL                         10820000
108300                   SET PS-RULES-AVAIL-NO       TO TRUE            10830000
108400                   SET DP020-MSG-WARNING       TO TRUE            10840000
108500                   MOVE PC-TSYMSG-03151 TO DP020-MSG-NUMBER       10850000
108600                   MOVE DP015-UNP-ALP-BRT-OFF  TO ASTRA           10860000
108700                   MOVE DP015-YELLOW           TO ASTRC           10870000
108800                   MOVE DP015-REVERSE          TO ASTRH           10880000
108900                   MOVE -1                     TO ASTRL           10890000
109000                   SET DP030-SET-CURSOR-APPL-1 TO TRUE            10900000
109100*SEND WARNING MESSAGE IF UNKNOWN CODE RETURNED FROM RCKCS826.     10910000
109200               WHEN OTHER                                         10920000
109300                   SET DP020-MSG-WARNING       TO TRUE            10930000
109400                   MOVE PC-TSYMSG-03153 TO DP020-MSG-NUMBER       10940000
109500                   MOVE DP015-UNP-ALP-BRT-OFF  TO ASTRA           10950000
109600                   MOVE DP015-YELLOW           TO ASTRC           10960000
109700                   MOVE DP015-REVERSE          TO ASTRH           10970000
109800                   MOVE -1                     TO ASTRL           10980000
109900                   SET DP030-SET-CURSOR-APPL-1 TO TRUE            10990000
110000             END-EVALUATE                                         11000000
110100         END-IF                                                   11010000
110200     END-IF.                                                      11020000
110300                                                                  11030000
110400                                                                  11040005
110500******************************************************************11050000
110600*                                                                *11060005
110700******************************************************************11070005
110800 3006-LOAD-RC826-COMMAREA.                                        11080000
110900                                                                  11090005
111200     PERFORM 3006A-GET-TRECITM.                                   11120005
111300                                                                  11130000
111400     IF  PS-NO-ERROR                                              11140005
111500         PERFORM 3006B-GET-INTR-UPC-ID                            11150005
111600     END-IF.                                                      11160005
111700                                                                  11170005
111900     INITIALIZE RC826-COMMAREA.                                   11190000
112000                                                                  11200009
113000     MOVE PV-INTR-UPC-ID     TO PV-HOLD-COMP-FIELD.               11300009
113100     MOVE PV-HOLD-COMP-FIELD TO RC826-INTERNAL-UPC-ID.            11310009
113200     MOVE PV-DB2-CUR-DATE-DD TO RC826-SHIP-DD.                    11320000
113300     MOVE PV-DB2-CUR-DATE-MM TO RC826-SHIP-MM.                    11330000
113400     MOVE PV-DB2-CUR-DATE-CC TO RC826-SHIP-CC.                    11340000
113500     MOVE PV-DB2-CUR-DATE-YY TO RC826-SHIP-YY.                    11350000
113600     MOVE ASC-STR-DEST-NBR-N TO RC826-STORE-NBR.                  11360000
113700                                                                  11370000
113800                                                                  11380005
113900*----------------------------------------------------------------*11390005
114000* SELECT TRECITM - BROKE INTO SEPARATE PARAGRAPH FOR ABEND LOGGING11400005
114100* USE PO/RCVR/LNE TO GET ITEM NUMBER.                             11410005
114200* DMH 8/23/2017                                                  *11420005
114300*----------------------------------------------------------------*11430005
114400 3006A-GET-TRECITM.                                               11440005
114500                                                                  11450005
114600     EXEC SQL                                                     11460005
114700         SELECT ITM_NBR                                           11470005
114800           INTO :RECITM-ITM-NBR                                   11480005
114900           FROM TRECEIV A                                         11490005
115000              , TRECITM B                                         11500005
115100          WHERE A.ORD_NBR        = :DK-PO-NBR                     11510005
115200            AND A.REC_SEQ_NBR    = :DK-REC-SEQ-NBR                11520005
115300            AND A.OPER_UNT_ID    = :DK-OPER-UNT-ID                11530005
115400            AND A.FCLTY_ID       = :DK-FCLTY-ID                   11540005
115500            AND A.VER_STATUS_CDE = 'A'                            11550005
115600            AND B.ORD_NBR        = A.ORD_NBR                      11560005
115700            AND B.REC_SEQ_NBR    = A.REC_SEQ_NBR                  11570005
115800            AND B.OPER_UNT_ID    = A.OPER_UNT_ID                  11580005
115900            AND B.FCLTY_ID       = A.FCLTY_ID                     11590005
116000            AND B.VER_STATUS_CDE = 'A'                            11600005
116100            AND B.ORD_LNE_NBR    = :DK-PO-LINE-NBR                11610005
116200     END-EXEC.                                                    11620005
116300                                                                  11630005
116400     EVALUATE TRUE                                                11640005
116500       WHEN SQLCODE = ZERO                                        11650005
116600           CONTINUE                                               11660005
116700                                                                  11670005
116800       WHEN SQLCODE = +100                                        11680005
116900            SET DP020-MSG-FATAL                                   11690005
117000                PS-ERROR                TO TRUE                   11700005
117100            MOVE PC-TSYMSG-03799        TO DP020-MSG-NUMBER       11710005
117200            MOVE -1                     TO ALINEL                 11720005
117300            SET DP030-SET-CURSOR-APPL-1 TO TRUE                   11730005
117400                                                                  11740005
117500       WHEN OTHER                                                 11750005
117600           MOVE DK-OPER-UNT-ID TO PV-DISP-OPER                    11760005
117700           MOVE DK-FCLTY-ID    TO PV-DISP-FCLTY                   11770005
117800           MOVE DK-PO-NBR      TO PV-DISP-PO                      11780005
117900           MOVE DK-REC-SEQ-NBR TO PV-DISP-RCVR                    11790005
118000           MOVE DK-PO-LINE-NBR TO PV-DISP-LINE                    11800005
118100                                                                  11810005
118200           MOVE '3006A-GET-TRECITM'      TO DP013-PARAGRAPH       11820005
118300           MOVE 'SELECT TRECITM-ITM-NBR' TO DP013-MESSAGE-TEXT (1)11830005
118400           STRING PV-DISP-OPER  '-'                               11840005
118500                  PV-DISP-FCLTY '-'                               11850005
118600                  PV-DISP-PO    '-'                               11860005
118700                  PV-DISP-RCVR  '-'                               11870005
118800                  PV-DISP-LINE            DELIMITED BY SIZE       11880005
118900                                     INTO DP013-MESSAGE-TEXT (2)  11890005
119000           MOVE SQLCA          TO DP013-SQLCA                     11900005
119100           MOVE 'TRECEIV'      TO DP013-DB2-TABLE-NAME (1)        11910005
119200           MOVE 'TRECITM'      TO DP013-DB2-TABLE-NAME (2)        11920005
119300           SET DP013-DB2-ABEND TO TRUE                            11930005
119400           SET DP013-XCTL-DISPLAY-RESTART  TO TRUE                11940005
119500           PERFORM DP013-0000-PROCESS-ABEND                       11950005
119600     END-EVALUATE.                                                11960005
119700                                                                  11970005
119800                                                                  11980005
119900*----------------------------------------------------------------*11990005
120000* SELECT INTERNAL UPC ID - BROKE INTO SEPARATE PARAGRAPHS FOR    *12000005
120100* ABEND LOGGING                                                   12010005
120200* USE ITEM NUMBER TO GET INTERNAL UPC ID.                         12020005
120300* DMH 8/23/2017                                                  *12030005
120400*----------------------------------------------------------------*12040005
120500 3006B-GET-INTR-UPC-ID.                                           12050005
120600                                                                  12060005
120700     MOVE RECITM-ITM-NBR TO DK-ITM-NBR.                           12070005
120800                                                                  12080005
120900     EXEC SQL                                                     12090005
121000         SELECT A.INTR_UPC_ID                                     12100005
121100           INTO :PV-INTR-UPC-ID                                   12110005
121200           FROM XLV_SKU      A                                    12120005
121300          WHERE  A.ITM_NBR   = :DK-ITM-NBR                        12130005
121400     END-EXEC.                                                    12140005
121500                                                                  12150005
121600     EVALUATE TRUE                                                12160005
121700       WHEN SQLCODE = ZERO                                        12170005
121800           CONTINUE                                               12180005
121900                                                                  12190005
122000       WHEN OTHER                                                 12200005
122100           MOVE DK-OPER-UNT-ID TO PV-DISP-OPER                    12210005
122200           MOVE DK-FCLTY-ID    TO PV-DISP-FCLTY                   12220005
122300           MOVE DK-PO-NBR      TO PV-DISP-PO                      12230005
122400           MOVE DK-REC-SEQ-NBR TO PV-DISP-RCVR                    12240005
122500           MOVE DK-PO-LINE-NBR TO PV-DISP-LINE                    12250005
122600           MOVE DK-ITM-NBR     TO PV-DISP-ITM-NBR                 12260005
122700                                                                  12270005
122800           MOVE '3006B-GET-INTR-UPC-ID'  TO DP013-PARAGRAPH       12280005
122900           MOVE 'SELECT INTERNAL UPC ID' TO DP013-MESSAGE-TEXT (1)12290005
123000           STRING PV-DISP-OPER  '-'                               12300005
123100                  PV-DISP-FCLTY '-'                               12310005
123200                  PV-DISP-PO    '-'                               12320005
123300                  PV-DISP-RCVR  '-'                               12330005
123400                  PV-DISP-LINE  '-'                               12340005
123500                  PV-DISP-ITM-NBR         DELIMITED BY SIZE       12350005
123600                                     INTO DP013-MESSAGE-TEXT (2)  12360005
123700           MOVE SQLCA          TO DP013-SQLCA                     12370005
123800           MOVE 'XLV_SKU'      TO DP013-DB2-TABLE-NAME (1)        12380005
123900           SET DP013-DB2-ABEND TO TRUE                            12390005
124000           SET DP013-XCTL-DISPLAY-RESTART TO TRUE                 12400005
124100           PERFORM DP013-0000-PROCESS-ABEND                       12410005
124200     END-EVALUATE.                                                12420005
124300                                                                  12430005
124400                                                                  12440005
124500                                                                  12450005
124600*----------------------------------------------------------------*12460000
124700 3010-VALIDATE-STR-DEST-NBR.                                      12470000
124800                                                                  12480000
125200     CALL XL071-LOCATION-MODULE USING DFHEIBLK                    12520000
125300                                      XL071-COMMAREA              12530000
125400                                      XL071-COMMAREA-REC.         12540000
125500                                                                  12550000
125600     EVALUATE TRUE                                                12560000
125700         WHEN XL071-NO-ERRORS                                     12570000
125800         WHEN XL071-LOC-NOT-FOUND                                 12580000
125900         WHEN XL071-DC-ASGMT-NOT-FND                              12590000
126000         WHEN XL071-SQLCODE-N = -904                              12600000
126100         WHEN XL071-SQLCODE-N = -913                              12610000
126200             CONTINUE                                             12620000
126300                                                                  12630000
126400         WHEN XL071-BAD-DB2-RETURN                                12640000
126500             MOVE '3010-VALIDATE-STR-DEST-NBR'                    12650000
126600                               TO DP013-PARAGRAPH                 12660000
126700             MOVE 'CALL TO XLTUT071 FOR LOCATION'                 12670000
126800                               TO DP013-MESSAGE-TEXT (1)          12680000
126900             STRING 'LOCATION NBR: '    DELIMITED BY SIZE         12690000
127000                  XL071-LOCATION-NUMBER DELIMITED BY SIZE         12700000
127100                             INTO DP013-MESSAGE-TEXT (2)          12710000
127200             MOVE XL071-SQLCODE-N  TO PV-ERROR-SQLCODE            12720000
127300             STRING 'SQLCODE: : '       DELIMITED BY SIZE         12730000
127400                  PV-ERROR-SQLCODE      DELIMITED BY SIZE         12740000
127500                             INTO DP013-MESSAGE-TEXT (3)          12750000
127600             MOVE XL071-SQLCA  TO DP013-SQLCA                     12760000
127700             MOVE 'XLT_LOC'    TO DP013-DB2-TABLE-NAME (1)        12770000
127800             MOVE 'XLT_DC_LOC_ASGMT'  TO DP013-DB2-TABLE-NAME (2) 12780000
127900             SET DP013-DB2-ABEND TO TRUE                          12790000
128000             SET DP013-XCTL-DISPLAY-RESTART TO TRUE               12800000
128100             PERFORM DP013-0000-PROCESS-ABEND                     12810000
128200     END-EVALUATE.                                                12820000
128300                                                                  12830000
128400*----------------------------------------------------------------*12840000
128500 3020-SELECT-RECDIS.                                              12850000
128600                                                                  12860000
128700     MOVE ASC-KEY-PKSL-LNE-NBR     TO DK-PKSL-LNE-NBR             12870000
128800                                      DK-PO-LINE-NBR.             12880000
128900                                                                  12890000
129000     EXEC SQL                                                     12900000
129100         SELECT STR_NBR                                           12910000
129200          INTO  :RECDIS-STR-NBR                                   12920000
129300           FROM TRECDIS                                           12930000
129400          WHERE ORD_NBR        = :DK-PO-NBR                       12940000
129500            AND ORD_LNE_NBR    = :DK-PKSL-LNE-NBR                 12950000
129600            AND REC_SEQ_NBR    = :DK-REC-SEQ-NBR                  12960000
129700            AND OPER_UNT_ID    = :DK-OPER-UNT-ID                  12970000
129800            AND FCLTY_ID       = :DK-FCLTY-ID                     12980000
129900            AND STR_NBR        = :DK-STR-DEST-NBR                 12990000
130000            AND STR_FCLTY_ID   = 1                                13000000
130200     END-EXEC.                                                    13020000
130300                                                                  13030000
130400     EVALUATE TRUE                                                13040000
130500         WHEN SQLCODE = ZERO                                      13050000
130600              SET PS-RECDIS-FOUND                                 13060000
130700                               TO TRUE                            13070000
130800         WHEN SQLCODE = +100                                      13080000
130900              SET PS-RECDIS-NOT-FOUND                             13090000
131000                               TO TRUE                            13100000
131100         WHEN SQLCODE = -904                                      13110000
131200         WHEN SQLCODE = -913                                      13120000
131300              CONTINUE                                            13130000
131400                                                                  13140000
131500         WHEN SQLWARN0 NOT = SPACES                               13150000
131600         WHEN SQLCODE  NOT = ZERO                                 13160000
131700              MOVE '3020-SELECT-RECDIS'                           13170000
131800                               TO DP013-PARAGRAPH                 13180000
131900              MOVE 'UNSUCCESSFUL SELECT OF TRECDIS'               13190000
132000                               TO DP013-MESSAGE-TEXT (1)          13200000
132100              MOVE SQLCA       TO DP013-SQLCA                     13210000
132200              MOVE 'TRECDIS'   TO DP013-DB2-TABLE-NAME (1)        13220000
132300              SET DP013-DB2-ABEND                                 13230000
132400                  DP013-XCTL-DISPLAY-RESTART                      13240000
132500                               TO TRUE                            13250000
132600              PERFORM DP013-0000-PROCESS-ABEND                    13260000
132700     END-EVALUATE.                                                13270000
132800                                                                  13280000
132900*----------------------------------------------------------------*13290000
133000*  RESET THE ATTRIBUTES OF ALL ENTERABLE FIELDS ON THE MAP.      *13300000
133100*----------------------------------------------------------------*13310000
133200 3200-RESET-ATTRIBUTES.                                           13320000
133300                                                                  13330000
133400     MOVE DP015-UNP-NUM-NOR-OFF    TO ASTRA.                      13340000
133500     MOVE DP015-GREEN              TO ASTRC.                      13350000
133600     MOVE DP015-UNDERLINE          TO ASTRH.                      13360000
133700                                                                  13370000
133800     MOVE -1                       TO ASTRL.                      13380000
133900     SET DP030-SET-CURSOR-APPL-1   TO TRUE.                       13390000
134000                                                                  13400000
134100*----------------------------------------------------------------*13410000
134200*  THIS PARAGRAPH BUILDS THE INITIAL SCREEN                      *13420000
134300*----------------------------------------------------------------*13430000
134400 4000-BUILD-INITIAL-PANEL.                                        13440000
134500                                                                  13450000
134600     SET ASC-RECORD-NOT-ADDED      TO TRUE.                       13460000
134700                                                                  13470000
134800     PERFORM 4010-GET-RECEIVER.                                   13480000
134900     PERFORM 4020-GET-VENDOR-NAME.                                13490000
135000     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        13500000
135100                                                                  13510000
135200*----------------------------------------------------------------*13520000
135300 4010-GET-RECEIVER.                                               13530000
135400                                                                  13540000
135500     EXEC SQL                                                     13550000
135600         SELECT PKGNG_CDE                                         13560000
135700           INTO :RECEIV-PKGNG-CDE                                 13570000
135800           FROM TRECEIV A                                         13580000
135900          WHERE A.ORD_NBR        = :DK-PO-NBR                     13590000
136000            AND A.REC_SEQ_NBR    = :DK-REC-SEQ-NBR                13600000
136100            AND A.VER_STATUS_CDE = 'A'                            13610000
136200     END-EXEC.                                                    13620000
136300                                                                  13630000
136400     EVALUATE TRUE                                                13640000
136500         WHEN SQLCODE = ZERO                                      13650000
136600             MOVE RECEIV-PKGNG-CDE TO ASC-PKGNG-CDE               13660000
136700                                                                  13670000
136800         WHEN SQLCODE = +100                                      13680000
136900         WHEN SQLCODE = -904                                      13690000
137000         WHEN SQLCODE = -913                                      13700000
137100             MOVE SPACES           TO ASC-PKGNG-CDE               13710000
137200                                                                  13720000
137300         WHEN SQLWARN0 NOT = SPACES                               13730000
137400         WHEN SQLCODE  NOT = ZERO                                 13740000
137500             MOVE '4010-GET-RECEIVER' TO DP013-PARAGRAPH          13750000
137600             MOVE 'UNSUCCESSFUL SELECT OF PO/RECEIVER'            13760000
137700                            TO DP013-MESSAGE-TEXT (1)             13770000
137800             MOVE SQLCA     TO DP013-SQLCA                        13780000
137900             MOVE 'TRECEIV' TO DP013-DB2-TABLE-NAME (1)           13790000
138000             SET DP013-DB2-ABEND                                  13800000
138100                 DP013-XCTL-DISPLAY-RESTART TO TRUE               13810000
138200             PERFORM DP013-0000-PROCESS-ABEND                     13820000
138300     END-EVALUATE.                                                13830000
138400                                                                  13840000
138500*----------------------------------------------------------------*13850000
138600 4020-GET-VENDOR-NAME.                                            13860000
138700                                                                  13870000
138800     EXEC SQL                                                     13880000
138900          SELECT B.ENT_NAME_DESC                                  13890000
139000            INTO :ENTNME-ENT-NAME-DESC                            13900000
139100            FROM TPURCHS A,                                       13910000
139200                 TENTNME B                                        13920000
139300           WHERE A.VER_STATUS_CDE = :PC-ACTIVE                    13930000
139400             AND A.PO_NBR         = :DK-PO-NBR                    13940000
139500             AND A.ENT_ID         = B.ENT_ID                      13950000
139600             AND B.TYPE_CDE       = :PC-01                        13960000
139700     END-EXEC.                                                    13970000
139800                                                                  13980000
139900     EVALUATE TRUE                                                13990000
140000         WHEN SQLCODE = ZERO                                      14000000
140100         WHEN SQLCODE = +100                                      14010000
140200         WHEN SQLCODE = -904                                      14020000
140300         WHEN SQLCODE = -913                                      14030000
140400              CONTINUE                                            14040000
140500                                                                  14050000
140600         WHEN SQLWARN0 NOT = SPACES                               14060000
140700         WHEN SQLCODE  NOT = ZERO                                 14070000
140800              MOVE '4020-GET-VENDOR-NAME'                         14080000
140900                               TO DP013-PARAGRAPH                 14090000
141000              MOVE 'UNSUCCESSFUL SELECT OF VENDOR NAME'           14100000
141100                               TO DP013-MESSAGE-TEXT (1)          14110000
141200              MOVE SQLCA       TO DP013-SQLCA                     14120000
141300              MOVE 'TENTNME'   TO DP013-DB2-TABLE-NAME (1)        14130000
141400              SET DP013-DB2-ABEND                                 14140000
141500                  DP013-XCTL-DISPLAY-RESTART                      14150000
141600                               TO TRUE                            14160000
141700                                                                  14170000
141800              PERFORM DP013-0000-PROCESS-ABEND                    14180000
141900     END-EVALUATE.                                                14190000
142000     IF SQLCODE = ZERO                                            14200000
142100         MOVE ENTNME-ENT-NAME-DESC                                14210000
142200                                   TO ASC-KEY-VENDOR-NAME         14220000
142300     ELSE                                                         14230000
142400         IF SQLCODE = +100                                        14240000
142500             MOVE 'VENDOR NOT FOUND'                              14250000
142600                                   TO ASC-KEY-VENDOR-NAME         14260000
142700         END-IF                                                   14270000
142800     END-IF.                                                      14280000
142900                                                                  14290000
143000*----------------------------------------------------------------*14300000
143100 4080-CHECK-RACF.                                                 14310000
143200                                                                  14320000
143300     SET DP008-RSRC-TYPE-FUNC     TO TRUE                         14330000
143400     MOVE 'RCAPRLOC'              TO DP008-FUNCTION-NAME          14340000
143500     SET DP008-ACCESS-TYPE-USE    TO TRUE                         14350000
143600                                                                  14360000
143700     EXEC CICS                                                    14370000
143800         LINK PROGRAM (DP008-SECURITY-SUBROUTINE)                 14380000
143900              COMMAREA (DP008-SECURITY-COMMAREA)                  14390000
144000              LENGTH (DP008-SECURITY-COMMAREA-LENGTH)             14400000
144100     END-EXEC                                                     14410000
144200                                                                  14420000
144300     IF DP008-CALL-SUCCESSFUL                                     14430000
144400         CONTINUE                                                 14440000
144500     ELSE                                                         14450000
144600         MOVE '4080-CHECK-RACF-ACCESS'                            14460000
144700                                     TO DP013-PARAGRAPH           14470000
144800         MOVE 'UNABLE TO ACCESS CICS'                             14480000
144900                                     TO DP013-MESSAGE-TEXT (1)    14490000
145000         MOVE SQLCA                  TO DP013-SQLCA               14500000
145100         SET DP013-DB2-ABEND                                      14510000
145200             DP013-XCTL-DISPLAY-RESTART                           14520000
145300                                     TO TRUE                      14530000
145400         PERFORM DP013-0000-PROCESS-ABEND                         14540000
145500     END-IF.                                                      14550000
145600                                                                  14560000
145700*----------------------------------------------------------------*14570000
145800*    RESTORE THE DATA ON THE SCREEN FROM THE COMMAREA.           *14580000
145900*----------------------------------------------------------------*14590000
146000 4400-MOVE-COMMAREA-TO-SCREEN.                                    14600000
146100                                                                  14610000
146200     MOVE ASC-KEY-OPER-UNT-ID      TO AOPERO.                     14620000
146300     MOVE ASC-KEY-FCLTY-ID         TO AFCLTYO.                    14630000
146400     MOVE ASC-KEY-FCLTY-NME        TO AFDESCO.                    14640000
146500     MOVE PC-DASH                  TO ASC-KEY-REC-DASH.           14650000
146600     MOVE ASC-KEY-RECEIVER         TO ARCVRO.                     14660000
146700                                                                  14670000
146900     IF DP020-INT-APPL-FORMAT-IND = PC-INTER-APPL-PACKID          14690000
147000       OR ((ASC-PKGNG-CDE = 'I' OR 'M')                           14700000
147100        AND (ASC-KEY-PACK-ID > ZEROES))                           14710000
147200         MOVE PC-PACK-LABEL        TO ALNPKO                      14720000
147300         MOVE ASC-KEY-PACK-ID      TO ALINEO                      14730000
147400     ELSE                                                         14740000
147500         MOVE PC-LINE-LABEL        TO ALNPKO                      14750000
147600         MOVE ASC-KEY-PKSL-LNE-NBR TO ALINEO                      14760000
147700     END-IF.                                                      14770000
147800                                                                  14780000
147900     MOVE ASC-KEY-VENDOR-NAME      TO AVENDO.                     14790000
148000     MOVE ASC-KEY-PKSL-NBR         TO APKSLIPO.                   14800000
148100     MOVE ASC-STR-DEST-NBR         TO ASTRO.                      14810000
148200                                                                  14820000
148300     IF ASC-STR-DEST-NBR NUMERIC                                  14830000
148400         MOVE ASC-STR-DEST-NBR-N   TO DK-STR-DEST-NBR             14840000
148500         IF ASC-STR-DEST-NBR = ZEROS                              14850000
148600             MOVE SPACES           TO ASTRO                       14860000
148700         END-IF                                                   14870000
148800     END-IF.                                                      14880000
148900                                                                  14890000
149000     MOVE ASC-STR-DEST-NME         TO ASDESCO.                    14900000
149100                                                                  14910000
149200*----------------------------------------------------------------*14920000
149300*    PERFORM ADD NEW STORE TO RECEIVER DISTRIBUTION              *14930000
149400*----------------------------------------------------------------*14940000
149500 5000-ADD-RECDIS.                                                 14950000
149600                                                                  14960000
149700     INITIALIZE DCLTRECDIS.                                       14970000
149800                                                                  14980000
149900     MOVE ASC-KEY-PO-NBR-N          TO RECDIS-ORD-NBR             14990000
150000                                       PV-PKSLIP-PO-NBR.          15000000
150100     MOVE ASC-KEY-PKSL-LNE-NBR      TO RECDIS-ORD-LNE-NBR.        15010000
150200     MOVE ASC-KEY-OPER-UNT-ID-N     TO RECDIS-OPER-UNT-ID.        15020000
150300     MOVE ASC-KEY-FCLTY-ID-N        TO RECDIS-FCLTY-ID.           15030000
150400     MOVE ASC-STR-DEST-NBR-N        TO RECDIS-STR-NBR             15040000
150500                                       PV-PKSLIP-STR-NBR.         15050000
150600     MOVE 1                         TO RECDIS-STR-FCLTY-ID.       15060000
150700     MOVE PC-DEFAULT-DATE           TO RECDIS-AP-PRC-DTE.         15070000
150800                                                                  15080000
150900     IF ASC-KEY-REC-SEQ-NBR > ZEROS                               15090000
151000         MOVE ASC-KEY-REC-SEQ-NBR-N TO RECDIS-REC-SEQ-NBR         15100000
151100     ELSE                                                         15110000
151200         MOVE ZEROES                TO RECDIS-REC-SEQ-NBR         15120000
151300     END-IF.                                                      15130000
151400                                                                  15140000
151500     EXEC SQL                                                     15150000
151600         SET :PV-CURRENT-TIMESTAMP = CURRENT TIMESTAMP            15160000
151700     END-EXEC.                                                    15170000
151800                                                                  15180000
152000     SET PS-DISTHD-FOUND  TO TRUE.                                15200000
152100     IF DP020-INT-APPL-FORMAT-IND = PC-INTER-APPL-PACKID          15210000
152200       OR ((ASC-PKGNG-CDE = 'I' OR 'M')                           15220000
152300        AND (ASC-KEY-PACK-ID > ZEROES))                           15230000
152400         MOVE ASC-KEY-PACK-ID TO DK-PACK-ID                       15240000
152500         PERFORM 5001-OPEN-RECITM-CURSOR                          15250000
152600         PERFORM 5003-GET-RECITMS                                 15260000
152700           UNTIL PS-MORE-RECITM-NO                                15270000
152800         PERFORM 5002-CLOSE-RECITM-CURSOR                         15280000
152900     ELSE                                                         15290000
153000         PERFORM 5010-INSERT-RECDIS                               15300000
153100         PERFORM 5060-SELECT-TDISTHD                              15310000
153200         PERFORM 5020-ADD-TO-RECD-AUDIT                           15320000
153300     END-IF.                                                      15330000
153400                                                                  15340000
153500     IF PS-DISTHD-NOT-FOUND                                       15350000
153600         CONTINUE                                                 15360000
153700     ELSE                                                         15370000
153800         IF (ASC-PKGNG-CDE = 'I' OR 'M')                          15380000
153900           AND (ASC-KEY-PACK-ID > ZEROES)                         15390000
154000             MOVE ASC-KEY-PACK-ID TO DK-PACK-ID                   15400000
154100             PERFORM 5001-OPEN-RECITM-CURSOR                      15410000
154200             PERFORM 5030-INSERT-PK-DISTDTS                       15420000
154300               UNTIL PS-MORE-RECITM-NO                            15430000
154400             PERFORM 5002-CLOSE-RECITM-CURSOR                     15440000
154500         ELSE                                                     15450000
154600             PERFORM 5050-INSERT-TDISTDT                          15460000
154700         END-IF                                                   15470000
154800     END-IF.                                                      15480000
154900                                                                  15490000
155000     IF PS-NO-ERROR                                               15500000
155100         MOVE PC-TSYMSG-00034 TO DP020-MSG-NUMBER                 15510000
155200         SET DP020-MSG-INFORMATIONAL                              15520000
155300             ASC-ADD-SUCCESSFUL TO TRUE                           15530000
155400     END-IF.                                                      15540000
155500                                                                  15550000
155600*----------------------------------------------------------------*15560000
155700 5001-OPEN-RECITM-CURSOR.                                         15570000
155800                                                                  15580000
155900     EXEC SQL                                                     15590000
156000         OPEN RECITM-CURSOR                                       15600000
156100     END-EXEC.                                                    15610000
156200                                                                  15620000
156300     EVALUATE TRUE                                                15630000
156400       WHEN SQLCODE = ZERO                                        15640000
156500           SET PS-MORE-RECITM-YES TO TRUE                         15650000
156600                                                                  15660000
156700       WHEN SQLWARN0 NOT = SPACES                                 15670000
156800       WHEN SQLCODE  NOT = ZERO                                   15680000
156900           SET PS-MORE-RECITM-NO TO TRUE                          15690000
157000           MOVE '5001-OPEN-RECITM-CURSOR' TO DP013-PARAGRAPH      15700000
157100           MOVE 'UNSUCCESSFUL RECITM CURSOR OPEN'                 15710000
157200                TO DP013-MESSAGE-TEXT (1)                         15720000
157300           MOVE SQLCA     TO DP013-SQLCA                          15730000
157400           MOVE 'TRECITM' TO DP013-DB2-TABLE-NAME (1)             15740000
157500           SET DP013-XCTL-DISPLAY-RESTART                         15750000
157600               DP013-DB2-ABEND TO TRUE                            15760000
157700           PERFORM DP013-0000-PROCESS-ABEND                       15770000
157800     END-EVALUATE.                                                15780000
157900                                                                  15790000
158000*----------------------------------------------------------------*15800000
158100 5002-CLOSE-RECITM-CURSOR.                                        15810000
158200                                                                  15820000
158300     EXEC SQL                                                     15830000
158400         CLOSE RECITM-CURSOR                                      15840000
158500     END-EXEC.                                                    15850000
158600                                                                  15860000
158700     EVALUATE TRUE                                                15870000
158800       WHEN SQLCODE = ZERO                                        15880000
158900           CONTINUE                                               15890000
159000                                                                  15900000
159100       WHEN SQLWARN0 NOT = SPACES                                 15910000
159200       WHEN SQLCODE  NOT = ZERO                                   15920000
159300           SET PS-MORE-RECITM-NO TO TRUE                          15930000
159400           MOVE '5002-CLOSE-RECITM-CURSOR' TO DP013-PARAGRAPH     15940000
159500           MOVE 'UNSUCCESSFUL RECITM CURSOR CLOSE'                15950000
159600                TO DP013-MESSAGE-TEXT (1)                         15960000
159700           MOVE SQLCA      TO DP013-SQLCA                         15970000
159800           MOVE 'TRECITM ' TO DP013-DB2-TABLE-NAME (1)            15980000
159900           SET DP013-DB2-ABEND                                    15990000
160000               DP013-XCTL-DISPLAY-RESTART TO TRUE                 16000000
160100           PERFORM DP013-0000-PROCESS-ABEND                       16010000
160200     END-EVALUATE.                                                16020000
160300                                                                  16030000
160400*----------------------------------------------------------------*16040000
160500 5003-GET-RECITMS.                                                16050000
160600                                                                  16060000
160700     PERFORM 5004-FETCH-RECITM.                                   16070000
160800                                                                  16080000
160900     IF PS-MORE-RECITM-YES                                        16090000
161000         MOVE RECITM-ORD-LNE-NBR TO DK-PKSL-LNE-NBR               16100000
161100         PERFORM 5005-CHECK-FOR-EXISTING                          16110000
161200         IF PS-RECDIS-FOUND                                       16120000
161300             SET DP020-MSG-FATAL                                  16130000
161400                 PS-ERROR                TO TRUE                  16140000
161500             MOVE PC-TSYMSG-00117        TO DP020-MSG-NUMBER      16150000
161600             MOVE DP015-UNP-ALP-BRT-OFF  TO ASTRA                 16160000
161700             MOVE DP015-RED              TO ASTRC                 16170000
161800             MOVE DP015-REVERSE          TO ASTRH                 16180000
161900             MOVE -1                     TO ASTRL                 16190000
162000             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  16200000
162100         ELSE                                                     16210000
162200             MOVE RECITM-ORD-LNE-NBR TO RECDIS-ORD-LNE-NBR        16220000
162300             PERFORM 5010-INSERT-RECDIS                           16230000
162400             MOVE ASC-KEY-PKSL-LNE-NBR TO PV-SAVE-LNE-NBR         16240000
162500             MOVE RECITM-ORD-LNE-NBR   TO ASC-KEY-PKSL-LNE-NBR    16250000
162600             PERFORM 5060-SELECT-TDISTHD                          16260000
162700             MOVE PV-SAVE-LNE-NBR      TO ASC-KEY-PKSL-LNE-NBR    16270000
162800             PERFORM 5020-ADD-TO-RECD-AUDIT                       16280000
162900         END-IF                                                   16290000
163000     END-IF.                                                      16300000
163100                                                                  16310000
163200*----------------------------------------------------------------*16320000
163300 5004-FETCH-RECITM.                                               16330000
163400                                                                  16340000
163500     EXEC SQL                                                     16350000
163600         FETCH  RECITM-CURSOR                                     16360000
163700          INTO :RECITM-ORD-LNE-NBR,                               16370000
163800               :RECITM-PREPK-RATO-QTY                             16380000
163900     END-EXEC.                                                    16390000
164000                                                                  16400000
164100     EVALUATE TRUE                                                16410000
164200       WHEN SQLCODE = ZERO                                        16420000
164300           CONTINUE                                               16430000
164400                                                                  16440000
164500       WHEN SQLCODE = +100                                        16450000
164600           SET PS-MORE-RECITM-NO TO TRUE                          16460000
164700                                                                  16470000
164800       WHEN SQLWARN0 NOT = SPACES                                 16480000
164900       WHEN SQLCODE  NOT = ZERO                                   16490000
165000           SET PS-MORE-RECITM-NO TO TRUE                          16500000
165100           MOVE '5004-FETCH-RECITM' TO DP013-PARAGRAPH            16510000
165200           MOVE 'UNSUCCESSFUL FETCH OF RECITM-CURSOR'             16520000
165300                TO DP013-MESSAGE-TEXT (1)                         16530000
165400           MOVE SQLCA     TO DP013-SQLCA                          16540000
165500           MOVE 'TRECITM' TO DP013-DB2-TABLE-NAME (1)             16550000
165600           SET DP013-DB2-ABEND                                    16560000
165700               DP013-XCTL-DISPLAY-RESTART TO TRUE                 16570000
165800           PERFORM DP013-0000-PROCESS-ABEND                       16580000
165900     END-EVALUATE.                                                16590000
166000                                                                  16600000
166100*----------------------------------------------------------------*16610000
166200 5005-CHECK-FOR-EXISTING.                                         16620000
166300                                                                  16630000
166400     EXEC SQL                                                     16640000
166500         SELECT STR_NBR                                           16650000
166600          INTO  :RECDIS-STR-NBR                                   16660000
166700           FROM TRECDIS                                           16670000
166800          WHERE ORD_NBR        = :DK-PO-NBR                       16680000
166900            AND ORD_LNE_NBR    = :DK-PKSL-LNE-NBR                 16690000
167000            AND REC_SEQ_NBR    = :DK-REC-SEQ-NBR                  16700000
167100            AND OPER_UNT_ID    = :DK-OPER-UNT-ID                  16710000
167200            AND FCLTY_ID       = :DK-FCLTY-ID                     16720000
167300            AND STR_NBR        = :DK-STR-DEST-NBR                 16730000
167400            AND STR_FCLTY_ID   = 1                                16740000
167600     END-EXEC.                                                    16760000
167700                                                                  16770000
167800     EVALUATE TRUE                                                16780000
167900       WHEN SQLCODE = ZERO                                        16790000
168000           SET PS-RECDIS-FOUND TO TRUE                            16800000
168100                                                                  16810000
168210       WHEN SQLCODE = +100                                        16821000
168300           SET PS-RECDIS-NOT-FOUND TO TRUE                        16830000
168400                                                                  16840000
168500       WHEN SQLCODE = -904                                        16850000
168600       WHEN SQLCODE = -913                                        16860000
168700           CONTINUE                                               16870000
168800                                                                  16880000
168900       WHEN SQLWARN0 NOT = SPACES                                 16890000
169000       WHEN SQLCODE  NOT = ZERO                                   16900000
169100           MOVE '5005-CHECK-FOR-EXISTING' TO DP013-PARAGRAPH      16910000
169200           MOVE 'UNSUCCESSFUL CHECK OF TRECDIS'                   16920000
169300                TO DP013-MESSAGE-TEXT (1)                         16930000
169400           MOVE SQLCA     TO DP013-SQLCA                          16940000
169500           MOVE 'TRECDIS' TO DP013-DB2-TABLE-NAME (1)             16950000
169600           SET DP013-DB2-ABEND                                    16960000
169700               DP013-XCTL-DISPLAY-RESTART TO TRUE                 16970000
169800           PERFORM DP013-0000-PROCESS-ABEND                       16980000
169900     END-EVALUATE.                                                16990000
170000                                                                  17000000
170100*----------------------------------------------------------------*17010000
170200 5010-INSERT-RECDIS.                                              17020000
170300                                                                  17030000
170400     EXEC SQL                                                     17040000
170500          INSERT INTO TRECDIS                                     17050000
170600                 (ORD_NBR                                         17060000
170700               ,  ORD_LNE_NBR                                     17070000
170800               ,  REC_SEQ_NBR                                     17080000
170900               ,  OPER_UNT_ID                                     17090000
171000               ,  FCLTY_ID                                        17100000
171100               ,  CRE_TMST                                        17110000
171200               ,  CRE_UID                                         17120000
171300               ,  VER_STATUS_CDE                                  17130000
171400               ,  EXPTED_ITM_QTY                                  17140000
171500               ,  VERIFY_ITM_QTY                                  17150000
171600               ,  AP_VERIFY_ITM_QTY                               17160000
171700               ,  STR_NBR                                         17170000
171800               ,  STR_FCLTY_ID                                    17180000
171900               ,  PLAN_ITM_QTY                                    17190000
172000               ,  AP_PRC_CDE                                      17200000
172100               ,  AP_PRC_DTE)                                     17210000
172200          VALUES (:RECDIS-ORD-NBR                                 17220000
172300               ,  :RECDIS-ORD-LNE-NBR                             17230000
172400               ,  :RECDIS-REC-SEQ-NBR                             17240000
172500               ,  :RECDIS-OPER-UNT-ID                             17250000
172600               ,  :RECDIS-FCLTY-ID                                17260000
172700               ,  :PV-CURRENT-TIMESTAMP                           17270000
172800               ,  :DP020-USERID                                   17280000
172900               ,  :PC-ACTIVE                                      17290000
173000               ,  :RECDIS-EXPTED-ITM-QTY                          17300000
173100               ,  :RECDIS-VERIFY-ITM-QTY                          17310000
173200               ,  :RECDIS-AP-VERIFY-ITM-QTY                       17320000
173300               ,  :RECDIS-STR-NBR                                 17330000
173400               ,  :RECDIS-STR-FCLTY-ID                            17340000
173500               ,  :RECDIS-PLAN-ITM-QTY                            17350000
173600               ,  :RECDIS-AP-PRC-CDE                              17360000
173700               ,  :RECDIS-AP-PRC-DTE)                             17370000
173800     END-EXEC.                                                    17380000
173900                                                                  17390000
174000     EVALUATE TRUE                                                17400000
174100       WHEN SQLCODE = +0                                          17410000
174200           CONTINUE                                               17420000
174300                                                                  17430000
174400       WHEN SQLCODE = -803 AND                                    17440000
174500            DP020-INT-APPL-FORMAT-IND = PC-INTER-APPL-CONFIRM     17450000
174600           CONTINUE                                               17460000
174700                                                                  17470000
174800       WHEN SQLCODE = -904                                        17480000
174900       WHEN SQLCODE = -911                                        17490000
175000       WHEN SQLCODE = -913                                        17500000
175100           CONTINUE                                               17510000
175200                                                                  17520000
175300       WHEN SQLWARN0 NOT = SPACES                                 17530000
175400       WHEN SQLCODE  NOT = ZERO                                   17540000
175500           MOVE '5010-INSERT-RECDIS' TO DP013-PARAGRAPH           17550000
175600           MOVE 'UNSUCCESSFUL INSERT OF RECDIS'                   17560000
175700                TO DP013-MESSAGE-TEXT (1)                         17570000
175800           MOVE SQLCA     TO DP013-SQLCA                          17580000
175900           MOVE 'TRECDIS' TO DP013-DB2-TABLE-NAME (1)             17590000
176000           SET DP013-XCTL-DISPLAY-RESTART                         17600000
176100               DP013-DB2-ABEND TO TRUE                            17610000
176200           PERFORM DP013-0000-PROCESS-ABEND                       17620000
176300     END-EVALUATE.                                                17630000
176400                                                                  17640000
176500*----------------------------------------------------------------*17650000
176600*    ADD A ROW TO THE TAURECD TABLE TO AUDIT THE ADDITION OF     *17660000
176700*    THIS STORE TO THE DISTIBUTION.  CALL THE AUDIT ROUTINE      *17670000
176800*    (RCKCS290) TO PERFORM THIS AUDIT.                           *17680000
176900*----------------------------------------------------------------*17690000
177000 5020-ADD-TO-RECD-AUDIT.                                          17700000
177100                                                                  17710000
177200     MOVE RECDIS-ORD-NBR     TO RC031-PO-NBR.                     17720000
177300     MOVE RECDIS-REC-SEQ-NBR TO RC031-REC-SEQ-NBR.                17730000
177400     MOVE RECDIS-ORD-LNE-NBR TO RC031-PO-LNE-NBR.                 17740000
177500     MOVE RECDIS-OPER-UNT-ID TO RC031-OPER-UNT-ID.                17750000
177600     MOVE RECDIS-FCLTY-ID    TO RC031-FCLTY-ID.                   17760000
177700     MOVE RECDIS-STR-NBR     TO RC031-STR-NBR.                    17770000
177800     MOVE PC-CURRENT-PROGRAM-NAME                                 17780000
177900                             TO RC031-UPD-PGM-ID.                 17790000
178000     MOVE DP020-USERID       TO RC031-UPD-UID.                    17800000
178100     MOVE PV-CURRENT-TIMESTAMP                                    17810000
178200                             TO RC031-UPD-TMST.                   17820000
178300     MOVE LENGTH OF RC031-FIELDS                                  17830000
178400                             TO PV-AUDIT-RTN-LENGTH.              17840000
178500*                                                                 17850000
178600     SET  RC031-AUDIT-TRECDIS                                     17860000
178700          RC031-AFTER                                             17870000
178800          RC031-ADD      TO TRUE.                                 17880000
178900                                                                  17890012
179000     EXEC CICS                                                    17900000
179100          LINK PROGRAM  (PC-AUDIT-RTN-RCKCS290)                   17910000
179200          COMMAREA      (RC031-FIELDS)                            17920000
179300          LENGTH        (PV-AUDIT-RTN-LENGTH)                     17930000
179400     END-EXEC.                                                    17940000
179500                                                                  17950012
179600     IF  RC031-CALL-SUCCESSFUL                                    17960000
179700         CONTINUE                                                 17970000
179800     ELSE                                                         17980000
179900         MOVE '5020-ADD-TO-RECD-AUDIT'                            17990000
180000                                 TO DP013-PARAGRAPH               18000000
180100         MOVE 'ERROR IN CALL TO AUDIT ROUTINE FOR TRECDIS'        18010000
180200                                 TO DP013-MESSAGE-TEXT (1)        18020000
180300         MOVE RECDIS-ORD-NBR     TO PV-ERROR-ORD-NBR              18030000
180400         MOVE RECDIS-REC-SEQ-NBR TO PV-ERROR-RCVR-SEQ-NBR         18040000
180500         MOVE RECDIS-ORD-LNE-NBR TO PV-ERROR-ORD-LNE-NBR          18050000
180600         MOVE RECDIS-STR-NBR     TO PV-ERROR-STR-NBR              18060000
180700         STRING ' RCVR: '            DELIMITED BY SIZE            18070000
180800              PV-ERROR-ORD-NBR       DELIMITED BY SIZE            18080000
180900              '-'                    DELIMITED BY SIZE            18090000
181000              PV-ERROR-RCVR-SEQ-NBR  DELIMITED BY SIZE            18100000
181100              '  LINE: '             DELIMITED BY SIZE            18110000
181200              PV-ERROR-ORD-LNE-NBR   DELIMITED BY SIZE            18120000
181300              '  STORE: '            DELIMITED BY SIZE            18130000
181400              PV-ERROR-STR-NBR       DELIMITED BY SIZE            18140000
181500                               INTO DP013-MESSAGE-TEXT (2)        18150000
181600         STRING RC031-RETURN-CODE    DELIMITED BY SIZE            18160000
181700              '-'                    DELIMITED BY SIZE            18170000
181800              RC031-RETURN-DESC      DELIMITED BY SIZE            18180000
181900              '  SQL CODE: '         DELIMITED BY SIZE            18190000
182000              RC031-SQLCODE          DELIMITED BY SIZE            18200000
182100                               INTO DP013-MESSAGE-TEXT (3)        18210000
182200         MOVE RC031-SQLCA        TO DP013-SQLCA                   18220000
182300         MOVE 'TAURECD '         TO DP013-DB2-TABLE-NAME (1)      18230000
182400         SET DP013-XCTL-DISPLAY-RESTART                           18240000
182500             DP013-DB2-ABEND     TO TRUE                          18250000
182600         PERFORM DP013-0000-PROCESS-ABEND                         18260000
182700     END-IF.                                                      18270000
182800                                                                  18280000
182900*----------------------------------------------------------------*18290000
183000*    FOR 'PACKS', ADD A ROW TO THE TDISTDT TABLE FOR EACH LINE   *18300000
183100*    ASSOCIATED TO THE 'PACK'.                                   *18310000
183200*----------------------------------------------------------------*18320000
183300 5030-INSERT-PK-DISTDTS.                                          18330000
183400                                                                  18340000
183500     PERFORM 5004-FETCH-RECITM.                                   18350000
183600                                                                  18360000
183700     IF PS-MORE-RECITM-YES                                        18370000
183800         MOVE ASC-KEY-PKSL-LNE-NBR TO PV-SAVE-LNE-NBR             18380000
183900         MOVE RECITM-ORD-LNE-NBR   TO ASC-KEY-PKSL-LNE-NBR        18390000
184000         PERFORM 5050-INSERT-TDISTDT                              18400000
184100         MOVE PV-SAVE-LNE-NBR      TO ASC-KEY-PKSL-LNE-NBR        18410000
184200     END-IF.                                                      18420000
184300                                                                  18430000
184400*----------------------------------------------------------------*18440000
184500*    ADD A ROW TO THE TDISTDT TABLE.                             *18450000
184600*----------------------------------------------------------------*18460000
184700 5050-INSERT-TDISTDT.                                             18470000
184800                                                                  18480000
184900     INITIALIZE DCLTDISTDT                                        18490000
185000                                                                  18500000
185100     MOVE ASC-KEY-PO-NBR-N         TO DISTDT-ORD-NBR              18510000
185200     MOVE ASC-KEY-REC-SEQ-NBR-N    TO DISTDT-RCVR-SEQ-NBR         18520000
185300     MOVE ASC-KEY-PKSL-LNE-NBR     TO DISTDT-ORD-LNE-NBR          18530000
185400     MOVE ASC-STR-DEST-NBR-N       TO DISTDT-STR-NBR              18540000
185500     MOVE PC-1                     TO DISTDT-WRK-ORD-SEQ-NBR      18550000
185600                                                                  18560000
185700     EXEC SQL                                                     18570000
185800         INSERT INTO TDISTDT                                      18580000
185900     ( ORD_NBR                                                    18590000
186000      , RCVR_SEQ_NBR                                              18600000
186100      , ORD_LNE_NBR                                               18610000
186200      , WRK_ORD_SEQ_NBR                                           18620000
186300      , STR_NBR                                                   18630000
186400      , EXPTED_ALLOC_QTY                                          18640000
186500      , ACTL_ALLOC_QTY                                            18650000
186600      , RCVG_PSTD_STAT_CDE                                        18660000
186700      , P2L_SPLT_UNT_QTY                                          18670000
186800      , FCSE_SPLT_UNT_QTY                                         18680000
186900      , INPK_SPLT_UNT_QTY                                         18690000
187000      , FCSE_ACTL_UNT_QTY                                         18700000
187100     )                                                            18710000
187200     VALUES                                                       18720000
187300     (  :DISTDT-ORD-NBR                                           18730000
187400      , :DISTDT-RCVR-SEQ-NBR                                      18740000
187500      , :DISTDT-ORD-LNE-NBR                                       18750000
187600      , :DISTDT-WRK-ORD-SEQ-NBR                                   18760000
187700      , :DISTDT-STR-NBR                                           18770000
187800      , :DISTDT-EXPTED-ALLOC-QTY                                  18780000
187900      , :DISTDT-ACTL-ALLOC-QTY                                    18790000
188000      , :PC-N                                                     18800000
188100      , :DISTDT-P2L-SPLT-UNT-QTY                                  18810000
188200      , :DISTDT-FCSE-SPLT-UNT-QTY                                 18820000
188300      , :DISTDT-INPK-SPLT-UNT-QTY                                 18830000
188400      , :DISTDT-FCSE-ACTL-UNT-QTY                                 18840000
188500     )                                                            18850000
188600     END-EXEC.                                                    18860000
188700                                                                  18870000
188800     EVALUATE TRUE                                                18880000
188900         WHEN SQLCODE = ZERO                                      18890000
189000         WHEN SQLCODE = -803                                      18900000
189100              CONTINUE                                            18910000
189200                                                                  18920000
189300         WHEN SQLWARN0 NOT = SPACES                               18930000
189400         WHEN SQLCODE  NOT = ZERO                                 18940000
189500              MOVE '5050-INSERT-TDISTDT'                          18950000
189600                               TO DP013-PARAGRAPH                 18960000
189700              MOVE 'UNSUCCESSFUL INSERT OF DISTDT'                18970000
189800                               TO DP013-MESSAGE-TEXT (1)          18980000
189900              MOVE SQLCA TO DP013-SQLCA                           18990000
190000              MOVE 'TDISTDT'   TO DP013-DB2-TABLE-NAME (1)        19000000
190100              SET DP013-XCTL-DISPLAY-RESTART                      19010000
190200                  DP013-DB2-ABEND                                 19020000
190300                               TO TRUE                            19030000
190400                                                                  19040000
190500              PERFORM DP013-0000-PROCESS-ABEND                    19050000
190600     END-EVALUATE.                                                19060000
190700                                                                  19070000
190800 5060-SELECT-TDISTHD.                                             19080000
190900                                                                  19090000
191000                                                                  19100000
191100     MOVE ASC-KEY-PO-NBR-N         TO DISTHD-ORD-NBR              19110000
191200     MOVE ASC-KEY-REC-SEQ-NBR-N    TO DISTHD-RCVR-SEQ-NBR         19120000
191300     MOVE ASC-KEY-PKSL-LNE-NBR     TO DISTHD-ORD-LNE-NBR          19130000
191400                                                                  19140000
191500     EXEC SQL                                                     19150000
191600         SELECT ORD_NBR                                           19160000
191700         INTO   :DISTHD-ORD-NBR                                   19170000
191800         FROM TDISTHD                                             19180000
191900       WHERE ORD_NBR           = :DISTHD-ORD-NBR                  19190000
192000         AND RCVR_SEQ_NBR      = :DISTHD-RCVR-SEQ-NBR             19200000
192100         AND ORD_LNE_NBR       = :DISTHD-ORD-LNE-NBR              19210000
192200         AND TOT_CART_CNT      >  0                               19220001
192300     END-EXEC.                                                    19230000
192400                                                                  19240000
192500     EVALUATE TRUE                                                19250000
192600         WHEN SQLCODE = ZERO                                      19260000
192700              CONTINUE                                            19270000
192800                                                                  19280000
192900         WHEN SQLCODE = +100                                      19290000
193000              SET PS-DISTHD-NOT-FOUND  TO TRUE                    19300000
193100                                                                  19310000
193200         WHEN SQLWARN0 NOT = SPACES                               19320000
193300         WHEN SQLCODE  NOT = ZERO                                 19330000
193400              MOVE '5060-SELECT-TDISTHD'                          19340000
193500                               TO DP013-PARAGRAPH                 19350000
193600              MOVE 'UNSUCCESSFUL SELECT OF DISTHD'                19360000
193700                               TO DP013-MESSAGE-TEXT (1)          19370000
193800              MOVE SQLCA TO DP013-SQLCA                           19380000
193900              MOVE 'TDISTHD'   TO DP013-DB2-TABLE-NAME (1)        19390000
194000              SET DP013-XCTL-DISPLAY-RESTART                      19400000
194100                  DP013-DB2-ABEND                                 19410000
194200                               TO TRUE                            19420000
194300                                                                  19430000
194400              PERFORM DP013-0000-PROCESS-ABEND                    19440000
194500     END-EVALUATE.                                                19450000
194600                                                                  19460000
194700*----------------------------------------------------------------*19470000
194800*    ABEND PROCESSOR MODULE                                      *19480000
194900*----------------------------------------------------------------*19490000
195000     COPY DPPD013.                                                19500000
