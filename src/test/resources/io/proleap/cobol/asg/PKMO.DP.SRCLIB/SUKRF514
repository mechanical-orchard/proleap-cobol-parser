000100******************************************************************00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300******************************************************************00030000
000400                                                                  00040000
000500 PROGRAM-ID.             SUKRF514.                                00050000
000600 AUTHOR.                 MICHAEL WALTERS.                         00060000
000700 INSTALLATION.           KOHLS.                                   00070000
000800 DATE-WRITTEN            SEPTEMBER, 1997.                         00080000
000900 DATE-COMPILED.                                                   00090000
001000                                                                  00100000
001100******************************************************************00110000
001200* THIS PROGRAM DISPLAYS A MESSAGE TO THE USER -- THATS IT,        00120000
001300* NOTHING ELSE                                                    00130000
001400******************************************************************00140000
001500                                                                  00150000
001600******************************************************************00160000
001700 ENVIRONMENT DIVISION.                                            00170000
001800******************************************************************00180000
001900                                                                  00190000
002000******************************************************************00200000
002100 DATA DIVISION.                                                   00210000
002200******************************************************************00220000
002300                                                                  00230000
002400******************************************************************00240000
002500 WORKING-STORAGE SECTION.                                         00250000
002600******************************************************************00260000
002700 01  CA-COMMAREA.                                                 00270000
002800     COPY SUWS006.                                                00280000
002900* * * * * * * * * * * *  PLEASE NOTE * * * * * * * * * * * *      00290000
003000* THE COMMAREA FROM HERE....                                      00300000
003100    05  CA-PROGRAM-COMMAREA.                                      00310000
003200      07  CA-LOOKUP-COMMAREA.                                     00320000
003300        10 CA-SCANNED-UPC                PIC X(15).               00330000
003400        10 CA-RETURN-MSG                 PIC X(19).               00340000
003500        10 CA-RETURN-ERROR-IND           PIC X(01) VALUE 'N'.     00350000
003600           88  CA-RETURN-ERROR                     VALUE 'Y'.     00360000
003700           88  CA-NO-RETURN-ERROR                  VALUE 'N'.     00370000
003800* ...TO HERE IS COPIED TO SUKRF518/521/524...                     00380000
003900      07  CA-DETAIL-COMMAREA.                                     00390000
004000        10 CA-RETAIL-X                   PIC X(08).               00400000
004100        10 CA-RETAIL REDEFINES CA-RETAIL-X                        00410000
004200                                         PIC ZZZZ9.99.            00420000
004300        10 CA-SKU-DESC                   PIC X(19).               00430000
004400        10 CA-COLOR                      PIC X(10).               00440000
004500        10 CA-SIZE                       PIC X(10).               00450000
004600        10 CA-VENDOR-STYLE               PIC X(19).               00460000
004700* ...AND TO HERE IS COPIED TO SUKRF517/522...                     00470000
004800      07  CA-VS-COMMAREA.                                         00480000
004900        10 CA-VENDOR-ENT-ID              PIC S9(09) COMP.         00490000
005000        10 CA-VENDOR-VS-NBR              PIC X(20).               00500000
005100        10 CA-VENDOR-VS-ID               PIC S9(09) COMP.         00510000
005200        10 CA-INTR-UPC-ID                PIC S9(09) COMP.         00520000
005300        10 CA-USE-UPC-IND                PIC X(01).               00530000
005400        10 CA-WEBITM-ERR-IND             PIC X(01)  VALUE 'N'.    00540000
005410           88  CA-WEBITM-ERR                        VALUE 'Y'.    00541000
005420           88  CA-NO-WEBITM-ERR                     VALUE 'N'.    00542000
005430* ...AND TO HERE IS COPIED TO SUKRF513/532/533...                 00543000
005440* IF YOU CHANGE IT (THIS COMMAREA) PLEASE VERIFY THAT THE COMMAREA00544000
005450* PASSED TO THOSE PROGRAMS MATCHES                                00545000
005460      07  CA-SCREEN-COMMAREA.                                     00546000
005470        10 CA-INTERNAL-UPC-X             PIC X(15).               00547000
005480        10 CA-INTERNAL-UPC  REDEFINES CA-INTERNAL-UPC-X           00548000
005490                                         PIC 9(15).               00549000
005500        10 CA-VENDOR-NAME                PIC X(11).               00550000
005600        10 CA-ITEM-LOOKUP-IND            PIC X(01) VALUE ' '.     00560000
005700           88  CA-UPC-FOUND                        VALUE '1'.     00570000
005800           88  CA-UPC-NOT-FOUND                    VALUE '2'.     00580000
005900           88  CA-SKU-FOUND                        VALUE '3'.     00590000
006000           88  CA-SKU-NOT-FOUND                    VALUE '4'.     00600000
006100        10 CA-F4-IND                     PIC X(01) VALUE 'N'.     00610000
006200           88  CA-F4-NOT-PRESSED-YET               VALUE 'N'.     00620000
006300           88  CA-F4-PRESSED                       VALUE 'Y'.     00630000
006400                                                                  00640000
006500 01  PV-PROGRAM-VARIABLES.                                        00650000
006600     05  PV-COMMAREA-LENGTH              PIC S9(04)  VALUE ZERO   00660000
006700                                                     COMP SYNC.   00670000
006800     05  PV-SYSID                        PIC  X(04)  VALUE SPACE. 00680000
006900     05  PV-MESSAGE-AREA                 PIC  X(19)  VALUE SPACE. 00690000
007000     05  PV-CICS-RESPONSE                PIC S9(08)  VALUE ZEROS  00700000
007100                                                     COMP SYNC.   00710000
007200     05  PV-TRANSFER-PROGRAM             PIC  X(08)  VALUE SPACE. 00720000
007300                                                                  00730000
007310     05  PV-CICS-MSG-AREA-1              PIC  X(80)  VALUE SPACE. 00731002
007311     05  PV-MSG-AREA-LENGTH              PIC S9(04)  VALUE ZEROS. 00731104
007312     05  PV-CICS-RESP                    PIC S9(08)  VALUE ZEROS. 00731206
007313     05  PV-DISP-PO                      PIC  9(09)  VALUE ZEROS. 00731303
007314     05  PV-DISP-RCVR                    PIC  9(04)  VALUE ZEROS. 00731403
007315     05  PV-DISP-STR                     PIC  9(04)  VALUE ZEROS. 00731503
007316     05  PV-DISP-PRPK-QTY                PIC  9(09)  VALUE ZEROS. 00731603
007317     05  PV-DISP-ASGMT-SEQ               PIC  9(09)  VALUE ZEROS. 00731703
007318     05  PV-DISP-RFID-CTR                PIC  9(03)  VALUE ZEROS. 00731803
007320                                                                  00732002
007330                                                                  00733002
007400 01  PC-PROGRAM-CONSTANTS.                                        00740000
007500     05  PC-CURRENT-TRANID               PIC  X(04)  VALUE 'S514'.00750000
007600     05  PC-CURRENT-PROGRAM-NAME         PIC  X(08)               00760000
007700                                         VALUE 'SUKRF514'.        00770000
007800     05  PC-UPC-INFO-PROGRAM-NAME        PIC  X(08)               00780000
007900                                         VALUE 'SUKRF513'.        00790000
008000     05  PC-SUKRF511-OPEN-CARTON         PIC  X(08)               00800000
008100                                         VALUE 'SUKRF511'.        00810000
008400     05  PC-TRANS-UNAVAILABLE-MSG   PIC X(19) VALUE               00840000
008500                                           'TRANS NOT AVAILABLE'. 00850000
008600******************************************************************00860000
008700*  KOHL'S STANDARD ATTENTION IDENTIFIER LIST                      00870000
008800******************************************************************00880000
008900     COPY DFHAID.                                                 00890000
009000                                                                  00900000
009100                                                                  00910000
009200******************************************************************00920000
009300*  LAYOUT FOR THE ABEND MODULE COMMUNICATIONS AREA                00930000
009400******************************************************************00940000
009500     COPY DPWS013.                                                00950000
009600                                                                  00960000
009700                                                                  00970000
009800******************************************************************00980000
009900*  GENERATED DSECT FOR THE SUKM514 MAPSET                         00990000
010000******************************************************************01000000
010100     COPY SUKM514.                                                01010000
010200                                                                  01020000
010300                                                                  01030000
010400******************************************************************01040000
010500*  COPY BOOK CONTAINING THE SYSTEM LINE MESSAGES                  01050000
010600******************************************************************01060000
010700     COPY SUWS005.                                                01070000
010800                                                                  01080000
010900******************************************************************01090000
011000*  COPY BOOK CONTAINING THE SYSTEM SCREEN MESSAGES                01100000
011100******************************************************************01110000
011200     COPY SUWS007.                                                01120000
011300                                                                  01130000
011400*----------------------------------------------------------------*01140000
011500* HELP SCREEN COMMAREA                                            01150000
011600     COPY PCWS192.                                                01160000
011700*----------------------------------------------------------------*01170000
011800* HELP SCREEN WORK AREA                                           01180000
011900     COPY PCWS188.                                                01190000
011901                                                                  01190100
011902                                                                  01190200
011903******************************************************************01190300
011904 LINKAGE SECTION.                                                 01190400
011905******************************************************************01190500
011906 01  DFHCOMMAREA.                                                 01190600
011907     05  FILLER                         OCCURS  1 TO 4072 TIMES   01190700
011908                                        DEPENDING ON EIBCALEN.    01190800
011909         10  FILLER                     PIC X.                    01190900
011910                                                                  01191000
011920                                                                  01192000
011930******************************************************************01193000
011940 PROCEDURE DIVISION.                                              01194000
011950******************************************************************01195000
011960 0000-PROGRAM-MAINLINE.                                           01196000
011970     MOVE DFHCOMMAREA  TO CA-COMMAREA.                            01197000
011980     MOVE LOW-VALUES   TO  SU514AI.                               01198000
011990                                                                  01199000
012000     EVALUATE TRUE                                                01200000
012100****************************************************************  01210000
012200* DPKRF278 IS THE PGM FOR THE HELP SCREEN.                        01220000
012300****************************************************************  01230000
012400         WHEN EIBTRNID = 'Z278'                                   01240000
012500             MOVE DFHCOMMAREA          TO PC192-COMMAREA          01250000
012600             MOVE PC192-HOST-SAVE-AREA TO CA-COMMAREA             01260000
012700             SET SU006-PROCESS-SCREEN  TO TRUE                    01270000
012800             PERFORM 1000-SETUP-SCREEN                            01280000
012900             PERFORM 8000-SEND-MAP                                01290000
013000             PERFORM 8200-RETURN-TRANID                           01300000
013100                                                                  01310000
013200         WHEN EIBCALEN = ZERO                                     01320000
013300         WHEN EIBAID = DFHCLEAR                                   01330000
013400         WHEN SU006-INITIALIZE-SCREEN                             01340000
013500             SET SU006-PROCESS-SCREEN  TO  TRUE                   01350000
013600             PERFORM 1000-SETUP-SCREEN                            01360000
013700                                                                  01370000
013800             PERFORM 8000-SEND-MAP                                01380000
013900             PERFORM 8200-RETURN-TRANID                           01390000
014000                                                                  01400000
014100         WHEN EIBAID = DFHPF1                                     01410000
014200              PERFORM 1400-HELP-SCREEN                            01420000
014300                                                                  01430000
014400         WHEN OTHER                                               01440000
014500             PERFORM 2100-XCTL-TO-SELECTED-PROGRAM                01450000
014600                                                                  01460000
014700     END-EVALUATE.                                                01470000
014800                                                                  01480000
014900     PERFORM 8100-SEND-DATA-ONLY.                                 01490000
015000     PERFORM 8200-RETURN-TRANID.                                  01500000
015100                                                                  01510000
015200     GOBACK.                                                      01520000
015300****************************************************************  01530000
015400* 1000-SETUP-SCREEN                                               01540000
015500*    INITIAL SETUP OF AUDIT NUMBER AND STATUS                     01550000
015600****************************************************************  01560000
015700 1000-SETUP-SCREEN.                                               01570000
015800                                                                  01580000
015900*    MOVE APPROPRIATE MESSAGE TO THE SCREEN                       01590000
016000     SET PM-IDX               TO SU006-PGM-MSG-NBR.               01600000
016100                                                                  01610000
016200     MOVE PM-LINE-1 (PM-IDX)  TO AMSG1O.                          01620000
016300     MOVE PM-LINE-2 (PM-IDX)  TO AMSG2O.                          01630000
016400     MOVE PM-LINE-3 (PM-IDX)  TO AMSG3O.                          01640000
016500     MOVE PM-LINE-4 (PM-IDX)  TO AMSG4O.                          01650000
016600     MOVE PM-LINE-5 (PM-IDX)  TO AMSG5O.                          01660000
016700     MOVE PM-LINE-6 (PM-IDX)  TO AMSG6O.                          01670000
016800     MOVE PM-LINE-7 (PM-IDX)  TO AMSG7O.                          01680000
016801     IF SU006-PGM-MSG-NBR = 22 OR                                 01680100
016802        SU006-PGM-MSG-NBR = 23 OR                                 01680200
016803        SU006-PGM-MSG-NBR = 24                                    01680300
016804         MOVE SPACES          TO AENTERO                          01680400
016805     END-IF.                                                      01680500
016806*                                                                 01680600
016807 1400-HELP-SCREEN.                                                01680700
016808     MOVE 'DPKRF278'                  TO PV-TRANSFER-PROGRAM      01680800
016809     MOVE 'SUKRF514'                  TO PC192-PROGRAM-NAME       01680900
016810     COPY PCPD188.                                                01681000
016811     MOVE PC188-DISPLAY-DATE          TO PC192-DISPLAY-DATE.      01681100
016812     PERFORM 4200-XCTL-TO-HELP.                                   01681200
016820                                                                  01682000
016830*                                                                 01683000
016840 2100-XCTL-TO-SELECTED-PROGRAM.                                   01684000
017300         MOVE SU006-LAST-PROGRAM TO PV-TRANSFER-PROGRAM           01730000
017400         IF SU006-LAST-PROGRAM = PC-SUKRF511-OPEN-CARTON AND      01740000
017410           (SU006-PGM-MSG-NBR = 22 OR                             01741000
017411            SU006-PGM-MSG-NBR = 23 OR                             01741100
017412            SU006-PGM-MSG-NBR = 24)                               01741200
017420             IF EIBAID = DFHENTER                                 01742000
017430                 MOVE 0       TO SU006-PGM-MSG-NBR                01743000
017440             ELSE                                                 01744000
017450                 MOVE PC-CURRENT-PROGRAM-NAME                     01745000
017460                              TO  SU006-LAST-PROGRAM              01746000
017470             END-IF                                               01747000
017480         END-IF.                                                  01748001
017490                                                                  01749001
017500     MOVE LENGTH OF CA-COMMAREA    TO  PV-COMMAREA-LENGTH.        01750000
017600     SET SU006-INITIALIZE-SCREEN   TO  TRUE.                      01760000
017700                                                                  01770000
017800     EXEC CICS                                                    01780000
017900         XCTL                                                     01790000
018000             PROGRAM   (PV-TRANSFER-PROGRAM)                      01800000
018001             COMMAREA  (CA-COMMAREA)                              01800100
018002             LENGTH    (PV-COMMAREA-LENGTH)                       01800200
018003             RESP      (PV-CICS-RESPONSE)                         01800300
018004     END-EXEC.                                                    01800400
018005                                                                  01800500
018006     EVALUATE TRUE                                                01800600
018007         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 01800700
018008              CONTINUE                                            01800800
018009         WHEN OTHER                                               01800900
018010                                                                  01801002
018011***                                                               01801102
018012              MOVE SPACES  TO  PV-CICS-MSG-AREA-1                 01801202
018013              DISPLAY PV-CICS-MSG-AREA-1                          01801307
018021              PERFORM 9998-WRITE-TO-CSSL                          01802102
018022                                                                  01802202
018023              MOVE SPACES  TO  PV-CICS-MSG-AREA-1                 01802303
018024              STRING ' SUKRF514-'                                 01802403
018025                     '2100-XCTL-TO-SELECTED-PROGRAM'              01802503
018026                                          DELIMITED BY SIZE       01802603
018027                                     INTO PV-CICS-MSG-AREA-1      01802703
018028              DISPLAY PV-CICS-MSG-AREA-1                          01802807
018030              PERFORM 9998-WRITE-TO-CSSL                          01803003
018031                                                                  01803103
018032              MOVE SPACES  TO  PV-CICS-MSG-AREA-1                 01803202
018033              STRING ' SUKRF514-'                                 01803302
018034                     'TRAN STATUS:'  SU006-TRANSACTION-STATUS     01803402
018035                     ' LAST PGM:'    SU006-LAST-PROGRAM           01803502
018036                     ' OPER:'        SU006-DFLT-OPER-UNT-ID-X     01803602
018037                     ' USR:'         SU006-USERID                 01803702
018038                     ' AREA:'        SU006-PRCS-AREA              01803802
018039                                          DELIMITED BY SIZE       01803902
018040                                     INTO PV-CICS-MSG-AREA-1      01804002
018041              DISPLAY PV-CICS-MSG-AREA-1                          01804107
018043              PERFORM 9998-WRITE-TO-CSSL                          01804302
018044                                                                  01804402
018045              MOVE SPACES  TO  PV-CICS-MSG-AREA-1                 01804502
018046              STRING ' SUKRF514-'                                 01804602
018047                     'AUDIT:'        SU006-AUDIT-CNTL-NBR-X       01804702
018048                     ' TYP:'         SU006-AUDIT-TYPE             01804802
018049                     '-'             SU006-SYSTEM-MANUAL-AUDIT    01804902
018050                     ' ST:'          SU006-AUDIT-STATUS           01805002
018051                     ' FAIL:'        SU006-AUD-FAIL-SCRN-CKED-IND 01805102
018052                     ' INSTRM:'      SU006-INSTREAM-AUDIT-IND     01805202
018053                     ' PRTR:'        SU006-PRINTER-DEST           01805302
018054                     ' MSG:'         SU006-PGM-MSG-NBR            01805402
018055                                          DELIMITED BY SIZE       01805502
018056                                     INTO PV-CICS-MSG-AREA-1      01805602
018057              DISPLAY PV-CICS-MSG-AREA-1                          01805707
018059              PERFORM 9998-WRITE-TO-CSSL                          01805902
018060                                                                  01806002
018061              MOVE SPACES  TO  PV-CICS-MSG-AREA-1                 01806102
018062              STRING ' SUKRF514-'                                 01806202
018063                     'CRTN:'         SU006-SHIP-UNIT-NBR-X        01806302
018064                     ' ST:'          SU006-SHIP-UNIT-STATUS       01806402
018065                     ' UPC:'         SU006-UPC-X                  01806502
018066                     ' SKU:'         SU006-SKU-NBR                01806602
018067                     '-'             SU006-NUMERIC-SKU            01806702
018068                                          DELIMITED BY SIZE       01806802
018069                                     INTO PV-CICS-MSG-AREA-1      01806902
018070              DISPLAY PV-CICS-MSG-AREA-1                          01807007
018072              PERFORM 9998-WRITE-TO-CSSL                          01807202
018073                                                                  01807302
018074              MOVE SPACES  TO  PV-CICS-MSG-AREA-1                 01807402
018075              MOVE  SU006-PO           TO PV-DISP-PO              01807502
018076              MOVE  SU006-REC-SEQ-NBR  TO PV-DISP-RCVR            01807602
018077              MOVE  SU006-STORE        TO PV-DISP-STR             01807702
018078              STRING ' SUKRF514-'                                 01807802
018079                     'RCVR:'         PV-DISP-PO                   01807902
018080                     '-'             PV-DISP-RCVR                 01808002
018081                     ' STR:'         PV-DISP-STR                  01808102
018082                     ' PKG:'         SU006-PKGNG-CDE-IND          01808202
018083                     ' MSDRCT:'      SU006-MISDIRECT-IND          01808302
018084                     ' ITM ERR:'     SU006-ITEM-ERROR-INDICATORS  01808402
018085                                          DELIMITED BY SIZE       01808502
018086                                     INTO PV-CICS-MSG-AREA-1      01808602
018087              DISPLAY PV-CICS-MSG-AREA-1                          01808707
018089              PERFORM 9998-WRITE-TO-CSSL                          01808902
018090                                                                  01809002
018091              MOVE SPACES  TO  PV-CICS-MSG-AREA-1                 01809102
018092              STRING ' SUKRF514-'                                 01809202
018093                     'SCAN:'         SU006-SCN-TMST               01809302
018094                     ' UPC ADD:'     SU006-UPC-ADDED-IND          01809402
018095                     ' AUD ERR:'     SU006-AUD-ERR-IND            01809502
018096                     ' UPC CERT:'    SU006-UPC-CERTIFIED-IND      01809602
018097                     ' ITM ERR:'     SU006-ITEM-ERROR-INDICATORS  01809702
018098                                          DELIMITED BY SIZE       01809802
018099                                     INTO PV-CICS-MSG-AREA-1      01809902
018100              DISPLAY PV-CICS-MSG-AREA-1                          01810007
018102              PERFORM 9998-WRITE-TO-CSSL                          01810202
018103                                                                  01810302
018104              MOVE SPACES  TO  PV-CICS-MSG-AREA-1                 01810402
018105              STRING ' SUKRF514-'                                 01810502
018106                     'LOGON:'        SU006-LOCATION-LOGON-IND     01810602
018107                     ' UPC ADD:'     SU006-UPC-ADDED-IND          01810702
018108                     ' AUD ERR:'     SU006-AUD-ERR-IND            01810802
018109                     ' UPC CERT:'    SU006-UPC-CERTIFIED-IND      01810902
018110                     ' ITM ERR:'     SU006-ITEM-ERROR-INDICATORS  01811002
018111                                          DELIMITED BY SIZE       01811102
018112                                     INTO PV-CICS-MSG-AREA-1      01811202
018113              DISPLAY PV-CICS-MSG-AREA-1                          01811307
018115              PERFORM 9998-WRITE-TO-CSSL                          01811502
018116                                                                  01811602
018117              MOVE SPACES  TO  PV-CICS-MSG-AREA-1                 01811702
018118              MOVE  SU006-KEYED-PACK-QTY TO PV-DISP-PRPK-QTY      01811802
018119              MOVE  SU006-WRONG-RFID-CTR TO PV-DISP-RFID-CTR      01811903
018120              STRING ' SUKRF514-'                                 01812003
018121                     'PRPK CL:'      SU006-PREPACK-CLOSED-IND     01812103
018122                     ' PRPK-QTY:'    PV-DISP-PRPK-QTY             01812203
018123                     ' RFID AUDT:'   SU006-RFID-AUDIT-CNTL-NBR-X  01812303
018124                     ' RFID IND:'    SU006-RFID-QC-AUDIT-IND      01812403
018125                     ' RFID CMB:'    SU006-RFID-QC-AUD-CMB-IND    01812503
018126                     ' RFID ERR:'    SU006-RFID-AUD-ERRORS-SW     01812603
018127                     ' RFID CTR:'    PV-DISP-RFID-CTR             01812703
018128                                          DELIMITED BY SIZE       01812803
018129                                     INTO PV-CICS-MSG-AREA-1      01812903
018130              DISPLAY PV-CICS-MSG-AREA-1                          01813007
018132              PERFORM 9998-WRITE-TO-CSSL                          01813203
018133                                                                  01813303
018134              MOVE SPACES  TO  PV-CICS-MSG-AREA-1                 01813403
018135              MOVE SU006-ASGMT-NBR-SEQ-NBR TO PV-DISP-ASGMT-SEQ   01813503
018136              STRING ' SUKRF514-'                                 01813603
018137                     'ASGMT DTE:'    SU006-ASGMT-STRT-DTE         01813703
018138                     ' ASGMT TXT:'   SU006-ASGMT-NBR-TXT          01813803
018139                     ' ASGMT SEQ:'   PV-DISP-ASGMT-SEQ            01813903
018140                                          DELIMITED BY SIZE       01814003
018141                                     INTO PV-CICS-MSG-AREA-1      01814103
018142              DISPLAY PV-CICS-MSG-AREA-1                          01814207
018144              PERFORM 9998-WRITE-TO-CSSL                          01814403
018145                                                                  01814503
018146              MOVE SPACES  TO  PV-CICS-MSG-AREA-1                 01814603
018147              STRING ' SUKRF514-'                                 01814703
018148                     'DOOR:'         SU006-DOOR-ID                01814803
018149                     ' DTL CK:'      SU006-DLX-CHECK-SW           01814903
018150                     ' UNT ADJ:'     SU006-NO-UNIT-ADJ-IND        01815003
018151                                          DELIMITED BY SIZE       01815103
018152                                     INTO PV-CICS-MSG-AREA-1      01815203
018153              DISPLAY PV-CICS-MSG-AREA-1                          01815307
018155              PERFORM 9998-WRITE-TO-CSSL                          01815503
018156                                                                  01815603
018157              MOVE SPACES  TO  PV-CICS-MSG-AREA-1                 01815703
018158              DISPLAY PV-CICS-MSG-AREA-1                          01815807
018160              PERFORM 9998-WRITE-TO-CSSL                          01816003
018161                                                                  01816103
018162***                                                               01816203
018164              MOVE '2100-XCTL-TO-SELECTED-PROGRAM'                01816403
018165                                     TO DP013-PARAGRAPH           01816503
018166              MOVE 'UNABLE TO XCTL THE FOLLOWING PROGRAM: '       01816603
018167                                     TO DP013-MESSAGE-TEXT (1)    01816703
018168              MOVE 'MOVE INFORMATION DISPLAYED IN CEEMSG'         01816808
018169                                     TO DP013-MESSAGE-TEXT (2)    01816908
018170              SET DP013-CICS-ABEND   TO TRUE                      01817008
018171              SET DP013-NO-ROLLBACK  TO TRUE                      01817108
018172              PERFORM 9999-WRITE-CICS-LOG-MSG                     01817208
018173              MOVE PM-TRANS-NOT-AVAILABLE-MSG                     01817308
018180                                     TO AMSG7O                    01818000
018200              SET SU006-PROCESS-SCREEN TO TRUE                    01820000
018300              PERFORM 8100-SEND-DATA-ONLY                         01830000
018400              PERFORM 8200-RETURN-TRANID                          01840000
018500     END-EVALUATE.                                                01850000
018600                                                                  01860000
018700*                                                                 01870000
018800*                                                                 01880000
018900 4200-XCTL-TO-HELP.                                               01890000
019000                                                                  01900000
019100     MOVE LENGTH OF PC192-COMMAREA    TO PV-COMMAREA-LENGTH.      01910000
019200     SET  SU006-INITIALIZE-SCREEN     TO TRUE.                    01920000
019300     MOVE CA-COMMAREA                 TO PC192-HOST-SAVE-AREA.    01930000
019400                                                                  01940000
019500     EXEC CICS                                                    01950000
019600         XCTL                                                     01960000
019700             PROGRAM   (PV-TRANSFER-PROGRAM)                      01970000
019800             COMMAREA  (PC192-COMMAREA)                           01980000
019900             LENGTH    (PV-COMMAREA-LENGTH)                       01990000
020000             RESP      (PV-CICS-RESPONSE)                         02000000
020100     END-EXEC.                                                    02010000
020200                                                                  02020000
020300     EVALUATE TRUE                                                02030000
020400         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 02040000
020500              CONTINUE                                            02050000
020600         WHEN OTHER                                               02060000
020700             MOVE '4200-XCTL-TO-HELP '                            02070000
020800                 TO DP013-PARAGRAPH                               02080000
020900             MOVE 'SUKRF514 - UNABLE TO XCTL TO PROGRAM: '        02090000
021000                 TO DP013-MESSAGE-TEXT (1)                        02100000
021100             MOVE PV-TRANSFER-PROGRAM                             02110000
021200                 TO DP013-MESSAGE-TEXT (2)                        02120000
021300             SET DP013-CICS-ABEND  TO TRUE                        02130000
021400             SET DP013-ROLLBACK TO TRUE                           02140000
021500             PERFORM 9999-WRITE-CICS-LOG-MSG                      02150000
021600             MOVE PC-TRANS-UNAVAILABLE-MSG TO AMSG7O              02160000
021700             SET SU006-PROCESS-SCREEN TO TRUE                     02170000
021800             PERFORM 8000-SEND-MAP                                02180000
021900             PERFORM 8200-RETURN-TRANID                           02190000
022000     END-EVALUATE.                                                02200000
022100*                                                                 02210000
022200******************************************************************02220000
022300*  8000-SEND-MAP                                                 *02230000
022400*  SEND THE REFRESHED MAP IMAGE TO THE SCREEN                    *02240000
022500******************************************************************02250000
022600 8000-SEND-MAP.                                                   02260000
022700     EXEC CICS                                                    02270000
022701         SEND                                                     02270100
022702             MAP     ('SU514A')                                   02270200
022703             MAPSET  ('SUKM514')                                  02270300
022704             ERASE                                                02270400
022705             RESP    (PV-CICS-RESPONSE)                           02270500
022706     END-EXEC.                                                    02270600
022707                                                                  02270700
022708     EVALUATE TRUE                                                02270800
022709         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 02270900
022710             CONTINUE                                             02271000
022711         WHEN OTHER                                               02271100
022712             MOVE '8000-SEND-MAP'   TO DP013-PARAGRAPH            02271200
022713             MOVE 'UNABLE TO SEND MAP'                            02271300
022714                                    TO DP013-MESSAGE-TEXT (1)     02271400
022715             SET DP013-CICS-ABEND   TO TRUE                       02271500
022716             SET DP013-NO-ROLLBACK  TO TRUE                       02271600
022717             PERFORM 9999-WRITE-CICS-LOG-MSG                      02271700
022718     END-EVALUATE.                                                02271800
022719*                                                                 02271900
022720 8100-SEND-DATA-ONLY.                                             02272000
022730                                                                  02273000
022740     EXEC CICS                                                    02274000
022750         SEND                                                     02275000
022760             MAP       ('SU514A')                                 02276000
022770             MAPSET    ('SUKM514')                                02277000
022780             CURSOR                                               02278000
022790             DATAONLY                                             02279000
022800             RESP      (PV-CICS-RESPONSE)                         02280000
022900     END-EXEC.                                                    02290000
023000                                                                  02300000
023100     EVALUATE TRUE                                                02310000
023200         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 02320000
023300             CONTINUE                                             02330000
023400         WHEN OTHER                                               02340000
023500             MOVE '8100-SEND-DATA-ONLY'                           02350000
023600                                    TO DP013-PARAGRAPH            02360000
023700             MOVE 'UNABLE TO SEND DATA'                           02370000
023800                                    TO DP013-MESSAGE-TEXT (1)     02380000
023900             SET DP013-CICS-ABEND   TO TRUE                       02390000
024000             SET DP013-NO-ROLLBACK  TO TRUE                       02400000
024100             PERFORM 9999-WRITE-CICS-LOG-MSG                      02410000
024200     END-EVALUATE.                                                02420000
024300*                                                                 02430000
024400 8200-RETURN-TRANID.                                              02440000
024500     MOVE LENGTH OF CA-COMMAREA  TO  PV-COMMAREA-LENGTH.          02450000
024600                                                                  02460000
024700     EXEC CICS                                                    02470000
024800         RETURN                                                   02480000
024900             TRANSID   (PC-CURRENT-TRANID)                        02490000
025000             COMMAREA  (CA-COMMAREA)                              02500000
025100             LENGTH    (PV-COMMAREA-LENGTH)                       02510000
025200             RESP      (PV-CICS-RESPONSE)                         02520000
025300     END-EXEC.                                                    02530000
025400                                                                  02540000
025500     EVALUATE TRUE                                                02550000
025600         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 02560000
025700             CONTINUE                                             02570000
025800         WHEN OTHER                                               02580000
025900             MOVE '8200-RETURN-TRANID'                            02590000
026000                                    TO DP013-PARAGRAPH            02600000
026100             MOVE 'UNABLE TO RETURN TO TRANID'                    02610000
026200                                    TO DP013-MESSAGE-TEXT (1)     02620000
026300             SET DP013-CICS-ABEND   TO TRUE                       02630000
026400             SET DP013-NO-ROLLBACK  TO TRUE                       02640000
026500             PERFORM 9999-WRITE-CICS-LOG-MSG                      02650000
026600     END-EVALUATE.                                                02660000
026700*                                                                 02670000
026710                                                                  02671002
026720 9998-WRITE-TO-CSSL.                                              02672002
026721        MOVE LENGTH OF PV-CICS-MSG-AREA-1                         02672103
026722                                   TO PV-MSG-AREA-LENGTH          02672203
026730        EXEC CICS                                                 02673002
026740            WRITEQ TD                                             02674002
026750                QUEUE   ('CSSL')                                  02675002
026760                FROM    (PV-CICS-MSG-AREA-1)                      02676002
026770                LENGTH  (PV-MSG-AREA-LENGTH)                      02677003
026780                RESP    (PV-CICS-RESP)                            02678005
026790        END-EXEC.                                                 02679002
026791                                                                  02679102
026800*                                                                 02680000
026900 9999-WRITE-CICS-LOG-MSG.                                         02690000
027000     MOVE PC-CURRENT-PROGRAM-NAME    TO DP013-PROGRAM.            02700000
027100     MOVE DFHEIBLK                   TO DP013-DFHEIBLK.           02710000
027200     INITIALIZE DP013-SRC-TASK-NUMBER                             02720000
027300                DP013-STACK.                                      02730000
027400     SET DP013-LINK-RETURN           TO TRUE.                     02740000
027500                                                                  02750000
027600     EXEC CICS                                                    02760000
027700         LINK                                                     02770000
027800             PROGRAM   (DP013-NAME)                               02780000
027900             COMMAREA  (DP013-PARAMETERS)                         02790000
028000             LENGTH    (DP013-LENGTH)                             02800000
028100     END-EXEC.                                                    02810000
028200                                                                  02820000
028300*----------------------------------------------------------------*02830000
028400*    ABEND PROCESSOR MODULE                                      *02840000
028500*----------------------------------------------------------------*02850000
028600                                                                  02860000
028700     COPY DPPD014.                                                02870000
028800                                                                  02880000
