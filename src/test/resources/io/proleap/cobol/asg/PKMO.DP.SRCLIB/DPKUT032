000100******************************************************************00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300******************************************************************00030000
000400                                                                  00040000
000500 PROGRAM-ID.             DPKUT032.                                00050000
000600 AUTHOR.                 RICK TULLOCH.                            00060000
000700 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00070000
000800 DATE-WRITTEN            01-08-2015.                              00080000
000900 DATE-COMPILED.                                                   00090000
001000                                                                  00100000
001100******************************************************************00110000
001200*       THIS PROGRAM DETERMINES THE IMPACT, URGENCY, AND         *00120000
001300*  ASSIGNMENT GROUP FOR ANY INCIDENT OPENED FROM THE MAINFRAME.  *00130000
001310*  THIS WILL INCLUDE JOB FAILURES, AND OVERDUE AND AD HOC        *00131017
001400*  INCIDENTS.  THIS WILL COVER MAINFRAME JOBS AND STARTED TASKS, *00140017
001500*  AND OPEN SYSTEMS SCHEDULED SCRIPTS OR COMMANDS.  FAILURES,    *00150017
001510*  CALL LIST COMPONENTS THAT ARE NOT FOUND, ASSIGNMENT GROUP     *00151017
001511*  OVERRIDES THAT ARE NOT FOUND, OR DEVIATIONS FROM EXPECTED     *00151117
001520*  SYNTAX IN THE OVERDUE AND AD HOC INCIDENT APPLICATIONS WILL   *00152017
001521*  BE POSTED TO AN ERROR FILE FOR CYCLICAL REVIEW.               *00152117
001530*                                                                *00153000
001540*       THE PROGRAM IS EXECUTED WITH ONE PARAMETER, THE FULLY    *00154000
001550*  QUALIFIED NAME OF THE PROCESS (ABSTRACTED AS JOB NAME).  THE  *00155000
001560*  JOB NAME IS PARSED TO EXTRACT JUST THE JOB NAME PORTION, IF   *00156000
001570*  IT IS REPRESENTING A FULLY QUALIFIED JOB NAME THAT USES A     *00157000
001580*  JOB QUALIFIER.  USING THE JOB NAME, THE CORRECT JOB           *00158000
001590*  DOCUMENTATION MEMBER THAT SUPPORTS THE FULL JOB NAME IS       *00159000
001600*  FOUND, POSTING AN ERROR IF NO SUPPORTING DOCUMENTATION IS     *00160000
001700*  FOUND.  THE JOB DOCUMENTATION MEMBER IS READ TO PARSE AND     *00170000
001800*  CAPTURE THE IMPACT, URGENCY, ASSIGNMENT GROUP, AND INDICATION *00180000
001900*  OF IF THE FIRST CONTACT SHOULD GO TO OPERATIONS.  IF NOT ALL  *00190000
002000*  DETAILS ARE FOUND, AS ERROR IS POSTED.  TO SUPPORT THE        *00200000
002010*  VALUATION REQUIREMENTS, THE DEFAULT ASSIGNMENT GROUP FOR THE  *00201000
002020*  RELATED SYSTEM ID IS FOUND, AND THE ASSIGNMENT GROUP          *00202000
002021*  SPECIFIED IN THE DOCUMENTATION IS VALIDATED.  IF THE          *00202100
002022*  ASSIGNMENT GROUP IS NOT DEFAULTING TO THE SYSTEM ID DEFAULT,  *00202200
002023*  AND THE LISTED ASSIGNMENT GROUP IS NOT FOUND, THEN DETERMINE  *00202300
002024*  IF THE ASSIGNMENT GROUP SPECIFIED IS A CODE FOR AN ASSIGNMENT *00202400
002025*  EXCEPTION.  MAKE THE FINAL ASSIGNMENT DECISION, USING THE     *00202500
002026*  CAPTURED INFORMATION, AND SET UP THE ASSIGNMENT CONTROL CARD  *00202600
002027*  THAT SUPPORTS THE DECISION.  WRITE OUT THE CONTROL CARD AND   *00202700
002028*  POST I/O TOTALS BEFORE EXITING THE PROGRAM.                   *00202800
002029******************************************************************00202900
002030                                                                  00203000
002040******************************************************************00204000
002050 ENVIRONMENT DIVISION.                                            00205000
002060******************************************************************00206000
002070                                                                  00207000
002080 CONFIGURATION SECTION.                                           00208000
002090                                                                  00209000
002100 SOURCE-COMPUTER.        IBM-3090.                                00210000
002200 OBJECT-COMPUTER.        IBM-3090.                                00220000
002300                                                                  00230000
002400 INPUT-OUTPUT SECTION.                                            00240000
002500                                                                  00250000
002600 FILE-CONTROL.                                                    00260000
002700                                                                  00270000
002800     SELECT JOB-DOCUMENTATION-FILE                                00280000
002900         ASSIGN TO INP01.                                         00290000
003000                                                                  00300000
003100     SELECT SYSTEM-ID-DEFAULT-FILE                                00310000
003200         ASSIGN TO INP02.                                         00320000
003300                                                                  00330000
003400     SELECT ASSIGNMENT-GROUP-FILE                                 00340000
003500         ASSIGN TO INP03.                                         00350000
003600                                                                  00360000
003700     SELECT ASSIGNMENT-EXCP-FILE                                  00370000
003800         ASSIGN TO INP04.                                         00380000
003810                                                                  00381004
003820     SELECT ASSIGNMENT-OVERRIDE-FILE                              00382004
003830         ASSIGN TO INP05.                                         00383004
003900                                                                  00390000
004000     SELECT ASSIGNMENT-WARNING-FILE                               00400000
004100         ASSIGN TO OUT01.                                         00410000
004200                                                                  00420000
004300     SELECT ASSIGNMENT-CONTROL-FILE                               00430000
004400         ASSIGN TO OUT02.                                         00440000
004500                                                                  00450000
004600******************************************************************00460000
004700 DATA DIVISION.                                                   00470000
004800******************************************************************00480000
004900                                                                  00490000
005000 FILE SECTION.                                                    00500000
005100                                                                  00510000
005200 FD  SYSTEM-ID-DEFAULT-FILE                                       00520000
005300     RECORDING MODE IS F                                          00530000
005400     LABEL RECORDS ARE STANDARD                                   00540000
005500     BLOCK CONTAINS 0 RECORDS                                     00550000
005600     RECORD CONTAINS 80 CHARACTERS                                00560000
005700     DATA RECORD IS SI-SYSTEM-ID-DEFAULT-RECORD.                  00570000
005800                                                                  00580000
005900 01  SI-SYSTEM-ID-DEFAULT-RECORD PIC X(80).                       00590000
006000                                                                  00600000
006100 FD  JOB-DOCUMENTATION-FILE                                       00610000
006200     RECORDING MODE IS F                                          00620000
006300     LABEL RECORDS ARE STANDARD                                   00630000
006400     BLOCK CONTAINS 0 RECORDS                                     00640000
006500     RECORD CONTAINS 80 CHARACTERS                                00650000
006600     DATA RECORD IS JD-JOB-DOCUMENTATION-RECORD.                  00660000
006700                                                                  00670000
006800 01  JD-JOB-DOCUMENTATION-RECORD PIC X(80).                       00680000
006900                                                                  00690000
007000 FD  ASSIGNMENT-GROUP-FILE                                        00700000
007100     RECORDING MODE IS F                                          00710000
007200     LABEL RECORDS ARE STANDARD                                   00720000
007300     BLOCK CONTAINS 0 RECORDS                                     00730000
007400     RECORD CONTAINS 80 CHARACTERS                                00740000
007500     DATA RECORD IS AG-ASSIGNMENT-GROUP-RECORD.                   00750000
007600                                                                  00760000
007700 01  AG-ASSIGNMENT-GROUP-RECORD  PIC X(80).                       00770000
007800                                                                  00780000
007900 FD  ASSIGNMENT-EXCP-FILE                                         00790000
008000     RECORDING MODE IS F                                          00800000
008100     LABEL RECORDS ARE STANDARD                                   00810000
008200     BLOCK CONTAINS 0 RECORDS                                     00820000
008300     RECORD CONTAINS 80 CHARACTERS                                00830000
008400     DATA RECORD IS AE-ASSIGNMENT-EXCP-RECORD.                    00840000
008500                                                                  00850000
008600 01  AE-ASSIGNMENT-EXCP-RECORD   PIC X(80).                       00860000
008700                                                                  00870000
008800 FD  ASSIGNMENT-OVERRIDE-FILE                                     00880004
008900     RECORDING MODE IS F                                          00890000
009000     LABEL RECORDS ARE STANDARD                                   00900000
009100     BLOCK CONTAINS 0 RECORDS                                     00910000
009200     RECORD CONTAINS 80 CHARACTERS                                00920004
009300     DATA RECORD IS AO-ASSIGNMENT-OVERRIDE-RECORD.                00930004
009400                                                                  00940000
009500 01  AO-ASSIGNMENT-OVERRIDE-RECORD                                00950004
009600                                 PIC X(80).                       00960004
009610                                                                  00961004
009620 FD  ASSIGNMENT-WARNING-FILE                                      00962004
009630     RECORDING MODE IS F                                          00963004
009640     LABEL RECORDS ARE STANDARD                                   00964004
009650     BLOCK CONTAINS 0 RECORDS                                     00965004
009660     RECORD CONTAINS 122 CHARACTERS                               00966004
009670     DATA RECORD IS AW-ASSIGNMENT-WARNING-RECORD.                 00967004
009680                                                                  00968004
009690 01  AW-ASSIGNMENT-WARNING-RECORD                                 00969004
009691                                 PIC X(122).                      00969104
009700                                                                  00970000
009800 FD  ASSIGNMENT-CONTROL-FILE                                      00980000
009900     RECORDING MODE IS F                                          00990000
010000     LABEL RECORDS ARE STANDARD                                   01000000
010100     BLOCK CONTAINS 0 RECORDS                                     01010000
010200     RECORD CONTAINS 80 CHARACTERS                                01020000
010300     DATA RECORD IS AC-ASSIGNMENT-CONTROL-RECORD.                 01030000
010400                                                                  01040000
010500 01  AC-ASSIGNMENT-CONTROL-RECORD                                 01050000
010600                                 PIC X(80).                       01060000
010700                                                                  01070000
010800 WORKING-STORAGE SECTION.                                         01080000
010900                                                                  01090000
011000*                                                                 01100000
011100*  CALL LIST SYSTEM ID DEFAULT ASSIGNMENT GROUP RECORD LAYOUT     01110000
011200*                                                                 01120000
011300     COPY CMRD004.                                                01130000
011400                                                                  01140000
011500*                                                                 01150000
011600*  CALL LIST ASSIGNMENT EXCEPTIONS BY JOB SUFFIX RECORD LAYOUT    01160000
011700*                                                                 01170000
011800     COPY CMRD005.                                                01180000
011900                                                                  01190000
012000*                                                                 01200000
012100*  PARAMETER LIST FOR THE DYNAMIC ALLOCATION ROUTINE              01210000
012200*                                                                 01220000
012300     COPY DPWS023.                                                01230000
012400                                                                  01240000
012500 01  ABEND-CODE                  PIC S9(4)    VALUE ZEROS         01250000
012600                                              COMP SYNC.          01260000
012700                                                                  01270000
012800 01  PS-PROGRAM-SWITCHES.                                         01280000
012900     05  PS-END-OF-JOB-DOC-FILE-IND                               01290000
013000                                 PIC X(1)     VALUE 'N'.          01300000
013100         88  PS-END-OF-JOB-DOC-FILE           VALUE 'Y'.          01310000
013200     05  PS-END-OF-SYSID-DFLT-FILE-IND                            01320000
013300                                 PIC X(1)     VALUE 'N'.          01330000
013400         88  PS-END-OF-SYSID-DFLT-FILE        VALUE 'Y'.          01340000
013500     05  PS-END-OF-ASSIGN-GRP-FILE-IND                            01350000
013600                                 PIC X(1)     VALUE 'N'.          01360000
013610         88  PS-END-OF-ASSIGN-GRP-FILE        VALUE 'Y'.          01361000
013620     05  PS-END-OF-ASSIGN-EXCP-FILE-IND                           01362000
013630                                 PIC X(1)     VALUE 'N'.          01363000
013640         88  PS-END-OF-ASSIGN-EXCP-FILE       VALUE 'Y'.          01364000
013641     05  PS-END-OF-ASSIGN-OVER-FILE-IND                           01364104
013642                                 PIC X(1)     VALUE 'N'.          01364204
013643         88  PS-END-OF-ASSIGN-OVER-FILE       VALUE 'Y'.          01364304
013644     05  PS-ASSIGN-OVER-OVERFLOW-IND                              01364408
013645                                 PIC X(1)     VALUE 'N'.          01364508
013646         88  PS-ASSIGN-OVER-OVERFLOW          VALUE 'Y'.          01364608
013647         88  PS-NO-ASSIGN-OVER-OVERFLOW       VALUE 'N'.          01364708
013650     05  PS-ASSIGNMENT-ERROR-IND PIC X(1)     VALUE 'N'.          01365000
013660         88  PS-NO-ASSIGNMENT-ERROR           VALUE 'N'.          01366000
013670         88  PS-ASSIGNMENT-ERROR              VALUE 'P', 'C',     01367000
013680                                                    'E'.          01368000
013690         88  PS-PARAMETER-ERROR               VALUE 'P'.          01369000
013700         88  PS-CONTROL-CARD-ERROR            VALUE 'C'.          01370000
013800         88  PS-JOB-DOC-ERROR                 VALUE 'E'.          01380000
013900     05  PS-JOB-DOC-MEMBER-FOUND-IND                              01390000
014000                                 PIC X(1)     VALUE 'N'.          01400000
014100         88  PS-JOB-DOC-MEMBER-FOUND          VALUE 'Y'.          01410000
014200         88  PS-JOB-DOC-MEMBER-NOT-FOUND      VALUE 'N'.          01420000
014300     05  PS-ALL-JOB-DOC-LINES-FOUND-IND                           01430000
014400                                 PIC X(4)     VALUE 'NNNN'.       01440000
014500         88  PS-NO-JOB-DOC-LINES-FOUND        VALUE 'NNNN'.       01450000
014600         88  PS-ALL-JOB-DOC-LINES-FOUND       VALUE 'YYYY'.       01460000
014700     05  FILLER                  REDEFINES                        01470000
014800                                   PS-ALL-JOB-DOC-LINES-FOUND-IND.01480000
014900         10  FILLER              PIC X(1).                        01490000
015000             88  PS-AD-IMPACT-FOUND           VALUE 'Y'.          01500000
015100         10  FILLER              PIC X(1).                        01510000
015200             88  PS-AD-URGENCY-FOUND          VALUE 'Y'.          01520000
015300         10  FILLER              PIC X(1).                        01530000
015400             88  PS-AD-ASSIGNMENT-GROUP-FOUND VALUE 'Y'.          01540000
015500         10  FILLER              PIC X(1).                        01550000
015600             88  PS-AD-CONTACT-OPS-FOUND      VALUE 'Y'.          01560000
015700     05  PS-SYSID-DFLT-FOUND-IND                                  01570000
015800                                 PIC X(1)     VALUE 'N'.          01580000
015900         88  PS-SYSID-DFLT-FOUND              VALUE 'Y'.          01590000
016000         88  PS-SYSID-DFLT-NOT-FOUND          VALUE 'N'.          01600000
016100     05  PS-ASSIGNMENT-GROUP-FOUND-IND                            01610000
016200                                 PIC X(1)     VALUE 'N'.          01620000
016300         88  PS-ASSIGNMENT-GROUP-FOUND        VALUE 'Y'.          01630000
016400         88  PS-ASSIGNMENT-GROUP-NOT-FOUND    VALUE 'N'.          01640000
016500     05  PS-ASSIGNMENT-CODE-FOUND-IND                             01650000
016600                                 PIC X(1)     VALUE 'N'.          01660000
016700         88  PS-ASSIGNMENT-CODE-FOUND         VALUE 'Y'.          01670000
016800         88  PS-ASSIGNMENT-CODE-NOT-FOUND     VALUE 'N'.          01680000
016900     05  PS-ASSIGNMENT-EXCP-FOUND-IND                             01690000
017000                                 PIC X(1)     VALUE 'N'.          01700000
017100         88  PS-ASSIGNMENT-EXCP-FOUND         VALUE 'Y'.          01710000
017200         88  PS-ASSIGNMENT-EXCP-NOT-FOUND     VALUE 'N'.          01720000
017300     05  PS-DEFAULT-ASSIGNMENT-IND                                01730000
017400                                 PIC X(1)     VALUE 'N'.          01740000
017500         88  PS-USE-DEFAULT-ASSIGNMENT        VALUE 'Y'.          01750000
017600         88  PS-DONT-USE-DEFAULT-ASSIGNMENT   VALUE 'N'.          01760000
017700                                                                  01770000
017800 01  PC-PROGRAM-CONSTANTS.                                        01780000
017900     05  PC-CURRENT-PROGRAM-NAME PIC X(8)     VALUE 'DPKUT032'.   01790000
018000     05  PC-JOB-DOC-DDNAME       PIC X(8)     VALUE 'INP01'.      01800000
018100     05  PC-PARAMETER-LIST-SIZE  PIC S9(4)    VALUE 17            01810000
018200                                              COMP SYNC.          01820000
018210     05  PC-ASSIGNMENT-PARM-COUNT                                 01821008
018220                                 PIC S9(4)    VALUE 3             01822008
018230                                              COMP SYNC.          01823008
018240     05  PC-DFLT-ASSIGNMENT-PARM-COUNT                            01824009
018250                                 PIC S9(4)    VALUE 2             01825009
018260                                              COMP SYNC.          01826009
018300     05  PC-JOB-QUALIFER-DELIMITER                                01830000
018400                                 PIC X(1)     VALUE '.'.          01840000
018500     05  PC-ERROR-DISPLAY-TAG    PIC X(12)    VALUE               01850000
018600         '** ERROR ** '.                                          01860000
018700     05  PC-WARNING-DISPLAY-TAG  PIC X(14)    VALUE               01870000
018800         '** WARNING ** '.                                        01880000
018900     05  PC-COMMA-SEPARATOR      PIC X(1)     VALUE ','.          01890000
019000                                                                  01900000
019100 01  PV-PROGRAM-VARIABLES.                                        01910000
019200     05  PV-PARAMETER-LIST-SIZE-DISPLAY                           01920000
019300                                 PIC ZZZ9     VALUE ZEROS.        01930000
019400     05  PV-PARAMETER-LIST       PIC X(17)    VALUE SPACES.       01940000
019500     05  PV-PARAMETER-LIST-REST  PIC X(17)    VALUE SPACES.       01950000
019600     05  PV-JOB-NAME-PARSED      PIC X(19)    VALUE SPACES.       01960000
019700     05  FILLER                  REDEFINES PV-JOB-NAME-PARSED.    01970000
019800         10  PV-JOB-NAME         PIC X(8).                        01980000
019900         10  FILLER              PIC X(11).                       01990000
020000     05  FILLER                  REDEFINES PV-JOB-NAME-PARSED.    02000000
020100         10  FILLER              PIC X(6).                        02010000
020200         10  PV-JOB-NAME-SUFFIX  PIC X(2).                        02020000
020300         10  FILLER              PIC X(11).                       02030000
020400     05  PV-JOB-DOC-MEMBER-NAME  PIC X(8)     VALUE SPACES.       02040000
020500     05  FILLER                  REDEFINES PV-JOB-DOC-MEMBER-NAME.02050000
020600         10  PV-JD-SYSTEM-ID     PIC X(2).                        02060000
020700         10  FILLER              PIC X(6).                        02070000
020800     05  PV-TALLY                PIC S9(4)    VALUE ZEROS         02080000
020900                                              COMP SYNC.          02090000
021000     05  PV-JOB-NAME-LENGTH      PIC S9(4)    VALUE ZEROS         02100000
021100                                              COMP SYNC.          02110000
021200     05  PV-JOB-NAME-POSITION    PIC S9(4)    VALUE ZEROS         02120000
021300                                              COMP SYNC.          02130000
021400     05  PV-JOB-DOC-NAME-LENGTH  PIC S9(4)    VALUE ZEROS         02140000
021500                                              COMP SYNC.          02150000
021600     05  PV-ASSIGNMENT-CONTROL-CARD                               02160000
021700                                 PIC X(80)    VALUE SPACES.       02170000
021710     05  PV-ASSIGNMENT-OVERRIDE-RECORD                            02171005
021720                                 PIC X(80)    VALUE SPACES.       02172005
021730         88  PV-NO-ASSIGNMENT-OVERRIDE        VALUE SPACES.       02173005
021800     05  PV-JOB-DOCUMENTATION-LINE                                02180000
021900                                 PIC X(80)    VALUE SPACES.       02190000
022000     05  FILLER                  REDEFINES                        02200000
022100                                     PV-JOB-DOCUMENTATION-LINE.   02210000
022200         10  FILLER              PIC X(11).                       02220000
022300             88  PV-JD-IMPACT-ID              VALUE               02230000
022400                 '   Impact: '.                                   02240000
022500         10  PV-JD-IMPACT        PIC X(1).                        02250000
022600         10  FILLER              PIC X(68).                       02260000
022700     05  FILLER                  REDEFINES                        02270000
022800                                     PV-JOB-DOCUMENTATION-LINE.   02280000
022900         10  FILLER              PIC X(12).                       02290000
023000             88  PV-JD-URGENCY-ID             VALUE               02300000
023100                 '   Urgency: '.                                  02310000
023200         10  PV-JD-URGENCY       PIC X(1).                        02320000
023300         10  FILLER              PIC X(67).                       02330000
023400     05  FILLER                  REDEFINES                        02340000
023500                                     PV-JOB-DOCUMENTATION-LINE.   02350000
023600         10  FILLER              PIC X(21).                       02360000
023700             88  PV-JD-ASSIGNMENT-GROUP-ID    VALUE               02370000
023800                 '   Assignment Group: '.                         02380000
023900         10  PV-JD-ASSIGNMENT-GROUP                               02390000
024000                                 PIC X(59).                       02400000
024100     05  FILLER                  REDEFINES                        02410000
024200                                     PV-JOB-DOCUMENTATION-LINE.   02420000
024300         10  FILLER              PIC X(38).                       02430000
024400             88  PV-JD-CONTACT-OPS-ID         VALUE               02440000
024500                 '   First contact to Operations (Y/N): '.        02450000
024600         10  PV-JD-CONTACT-OPS   PIC X(1).                        02460000
024700         10  FILLER              PIC X(41).                       02470000
024800     05  PV-ASSIGNMENT-GROUP-RECORD                               02480000
024900                                 PIC X(80)    VALUE SPACES.       02490000
025000     05  PV-ASSIGNMENT-INFORMATION.                               02500000
025100         10  PV-AI-IMPACT        PIC X(1).                        02510000
025200         10  PV-AI-URGENCY       PIC X(1).                        02520000
025300         10  PV-AI-ASSIGNMENT-GROUP                               02530000
025400                                 PIC X(60).                       02540000
025500             88  PV-AI-DEFAULT-ASSIGNMENT     VALUE 'default'.    02550000
025600         10  PV-AI-CONTACT-OPS   PIC X(1).                        02560000
025700             88  PV-AI-CONTACT-OPS-FIRST      VALUE 'Y'.          02570000
025800             88  PV-AI-DONT-CONTACT-OPS       VALUE 'N'.          02580000
025900         10  PV-AI-FINAL-ASSIGNMENT-GROUP                         02590000
026000                                 PIC X(80).                       02600000
026010     05  PV-OVERRIDE-INFORMATION.                                 02601008
026021         10  PV-OI-IMPACT        PIC X(1).                        02602108
026032         10  PV-OI-URGENCY       PIC X(1).                        02603208
026040         10  PV-OI-ASSIGNMENT-GROUP                               02604008
026050                                 PIC X(60).                       02605008
026100     05  PV-DYNALC-ROUTINE-ERROR-MSG.                             02610000
026200         10  FILLER              PIC X(13)    VALUE               02620000
026300             'DYNALC ERROR '.                                     02630000
026400         10  PV-DR-RETURN-CODE   PIC 9999     VALUE ZEROS.        02640000
026500         10  FILLER              PIC X(2)     VALUE '; '.         02650000
026600         10  PV-DR-DDNAME        PIC X(8)     VALUE SPACES.       02660000
026700         10  FILLER              PIC X(5)     VALUE ' DD; '.      02670000
026800         10  PV-DR-ERROR-DESC    PIC X(41)    VALUE SPACES.       02680000
026900     05  PV-CURRENT-ERROR        PIC X(100)   VALUE SPACES.       02690000
027000         88  PV-CE-NO-PARAMETERS              VALUE               02700000
027100             'NO PARAMETERS PASSED'.                              02710000
027200         88  PV-CE-INVALID-PARAMETER-LENGTH   VALUE               02720000
027300             'INVALID PARAMETER LENGTH'.                          02730000
027400         88  PV-CE-BLANK-PARAMETER-LIST       VALUE               02740000
027500             'BLANK PARAMETERS PASSED'.                           02750000
027600         88  PV-CE-JOB-LEADING-SPACES         VALUE               02760000
027700             'LEADING SPACES ON PARSED JOB NAME'.                 02770000
027800         88  PV-CE-JOB-NAME-LENGTH            VALUE               02780000
027900             'PARSED JOB NAME IS LONGER THAN ACCEPTABLE LENGTH'.  02790000
027910         88  PV-CE-ASSIGN-OVERRIDE-PARSE      VALUE               02791008
027920             'ASSIGNMENT OVERRIDE DETAILS PARSING ERROR'.         02792008
027930         88  PV-CE-INVALID-OVERRIDE-IMPACT    VALUE               02793011
027940             'INVALID OR MISSING IMPACT IN OVERRIDE'.             02794011
027941         88  PV-CE-INVALID-OVERRIDE-URGENCY   VALUE               02794111
027942             'INVALID OR MISSING URGENCY IN OVERRIDE'.            02794211
027950         88  PV-CE-INVALID-OVERRIDE-GROUP     VALUE               02795011
027960             'INVALID ASSIGNMENT GROUP IN OVERRIDE'.              02796011
028000         88  PV-CE-JOB-DOC-ALLOC-ERROR        VALUE               02800000
028100             'JOB DOCUMENTATION FILE ALLOCATION ERROR'.           02810000
028200         88  PV-CE-INVALID-JOB-DOC-DSN        VALUE               02820000
028300             'INVALID JOB DOCUMENTATION DATASET NAME'.            02830000
028400     05  PV-CURRENT-TIMESTAMP-LABEL.                              02840001
028500         10  PV-CT-YEAR          PIC X(4)     VALUE SPACES.       02850000
028510         10  FILLER              PIC X(1)     VALUE '-'.          02851002
028600         10  PV-CT-MONTH         PIC X(2)     VALUE SPACES.       02860000
028610         10  FILLER              PIC X(1)     VALUE '-'.          02861002
028700         10  PV-CT-DAY           PIC X(2)     VALUE SPACES.       02870000
028800         10  FILLER              PIC X(1)     VALUE SPACES.       02880001
028900         10  PV-CT-HOUR          PIC X(2)     VALUE SPACES.       02890000
028910         10  FILLER              PIC X(1)     VALUE ':'.          02891002
029000         10  PV-CT-MINUTE        PIC X(2)     VALUE SPACES.       02900000
029010         10  FILLER              PIC X(1)     VALUE ':'.          02901002
029100         10  PV-CT-SECOND        PIC X(2)     VALUE SPACES.       02910000
029110         10  FILLER              PIC X(3)     VALUE ' - '.        02911001
029200                                                                  02920000
029300 01  CC-CONTROL-CARD.                                             02930000
029400     05  CC-CONTROL-CARD-DISPLAY.                                 02940000
029500         10  CC-JOB-DOCUMENTATION-DSN                             02950000
029600                                 PIC X(44)    VALUE SPACES.       02960000
029700     05  FILLER                  PIC X(36)    VALUE SPACES.       02970000
029800                                                                  02980000
029900 01  PT-PROGRAM-TOTALS.                                           02990000
030000     05  PT-JOB-DOC-LINES-READ   PIC S9(7)    VALUE ZEROS         03000000
030100                                              COMP-3.             03010000
030200     05  PT-SYSID-DFLT-RECORDS-READ                               03020000
030300                                 PIC S9(7)    VALUE ZEROS         03030000
030400                                              COMP-3.             03040000
030500     05  PT-ASSIGN-GRP-RECORDS-READ                               03050000
030600                                 PIC S9(7)    VALUE ZEROS         03060000
030700                                              COMP-3.             03070000
030800     05  PT-ASSIGN-EXCP-RECORDS-READ                              03080000
030900                                 PIC S9(7)    VALUE ZEROS         03090000
031000                                              COMP-3.             03100000
031010     05  PT-ASSIGN-OVER-RECORDS-READ                              03101005
031020                                 PIC S9(7)    VALUE ZEROS         03102005
031030                                              COMP-3.             03103005
031100     05  PT-ASSIGN-WARN-RCDS-WRITTEN                              03110000
031200                                 PIC S9(7)    VALUE ZEROS         03120000
031300                                              COMP-3.             03130000
031400     05  PT-ASSIGN-CNTL-RCDS-WRITTEN                              03140000
031500                                 PIC S9(7)    VALUE ZEROS         03150000
031600                                              COMP-3.             03160000
031700                                                                  03170000
031800 01  TD-TOTAL-DISPLAY-MESSAGE.                                    03180000
031900     05  TD-TOTAL-ID             PIC X(51)    VALUE SPACE.        03190000
032000         88  TD-JOB-DOC-LINES-READ-ID         VALUE               03200000
032100             'JOB DOCUMENTATION LINES READ . . . . . . . . . . '. 03210000
032200         88  TD-SYSID-DFLT-RECORDS-READ-ID   VALUE                03220000
032300             'SYSTEM ID DEFAULT ASSIGNMENT GROUP RECORDS READ. '. 03230000
032400         88  TD-ASSIGN-GRP-RECORDS-READ-ID    VALUE               03240000
032500             'VALID ASSIGNMENT GROUP RECORDS READ  . . . . . . '. 03250000
032600         88  TD-ASSIGN-EXCP-RECORDS-READ-ID   VALUE               03260000
032700             'ASSIGNMENT EXCEPTION RECORDS READ  . . . . . . . '. 03270000
032710         88  TD-ASSIGN-OVER-RECORDS-READ-ID   VALUE               03271005
032720             'ASSIGNMENT OVERRIDE RECORDS READ . . . . . . . . '. 03272005
032800         88  TD-ASSIGN-WARN-RCDS-WRITTEN-ID   VALUE               03280000
032900             'ASSIGNMENT WARNING RECORDS WRITTEN . . . . . . . '. 03290000
033000         88  TD-ASSIGN-CNTL-RCDS-WRITTEN-ID   VALUE               03300000
033100             'ASSIGNMENT CONTROL CARD RECORDS WRITTEN  . . . . '. 03310000
033200     05  TD-TOTAL-AMOUNT         PIC Z,ZZZ,ZZ9                    03320000
033300                                              VALUE ZEROS.        03330000
033400                                                                  03340000
033500******************************************************************03350000
033600 LINKAGE SECTION.                                                 03360000
033700******************************************************************03370000
033800                                                                  03380000
033900 01  LS-PARAMETER-LIST.                                           03390000
034000     05  LS-PARAMETER-LIST-SIZE  PIC S9(4)    COMP.               03400000
034100     05  LS-PARAMETER-LIST-DISPLAY.                               03410000
034200         10  LS-PROCESS-NAME     PIC X(17).                       03420000
034300                                                                  03430000
034400******************************************************************03440000
034500 PROCEDURE DIVISION USING LS-PARAMETER-LIST.                      03450000
034600******************************************************************03460000
034700                                                                  03470000
034800 0000-MAINLINE.                                                   03480000
034900                                                                  03490000
035000     PERFORM 1000-INITIALIZE.                                     03500000
035100                                                                  03510000
035200     IF (PS-NO-ASSIGNMENT-ERROR)                                  03520000
035201*                                                                 03520118
035202*  IF GROUP DETAILS ARE NOT PROVIDED (NORMAL INCIDENT, OVERDUE OR 03520218
035203*  AD HOC INCIDENTS USING THE JOB DEFAULTS ASSIGNMENT), GET THE   03520318
035204*  DETAILS FROM THE JOB DOCUMENTATION THAT SUPPORTS THE PROCESS.  03520418
035205*                                                                 03520518
035210         IF (PV-OI-ASSIGNMENT-GROUP = SPACES)                     03521010
035300             PERFORM 2000-FIND-ASSIGNMENT-DETAILS                 03530010
035330         END-IF                                                   03533010
035400     END-IF.                                                      03540000
040300                                                                  04030000
040400     PERFORM 5000-SET-FINAL-ASSIGNMENT.                           04040010
040500                                                                  04050000
040600     PERFORM 8100-WRITE-ASSIGNMENT-CONTROL.                       04060000
040700                                                                  04070000
040800     PERFORM 1500-DISPLAY-PROGRAM-TOTALS.                         04080000
040900                                                                  04090000
041000     PERFORM 9000-EOJ-ROUTINE.                                    04100000
041100                                                                  04110000
041200     STOP RUN.                                                    04120000
041300                                                                  04130000
041400******************************************************************04140000
041500*  INITIALIZE FOR PROGRAM PROCESSING.  OPEN ALL FILES THAT WILL  *04150000
041600*  BE USED IN ANY PASS THROUGH THE PROCESS.  SET UP THE          *04160000
041700*  TIMESTAMP FOR POSTED ERRORS AND WARNINGS.  EVALUATE THE       *04170000
041800*  PARAMETER LIST TO MAKE SURE A VALID, SINGLE PARAMETER FOR THE *04180000
041900*  JOB NAME HAS BEEN PASSED.  IF THE JOB NAME INCLUDES A JOB     *04190000
042000*  QUALIFIER, PARSE THE JOB NAME FOR REVIEW OF ONLY THE JOB NAME *04200000
042100*  PORTION.  MAKE SURE THE JOB NAME LENGTH IS VALID AND THAT     *04210000
042200*  THERE ARE NO LEADING SPACES.  ACCEPT THE CONTROL CARD FOR THE *04220000
042300*  JOB DOCUMENTATION LIBRARY LOCATION.                           *04230000
042400******************************************************************04240000
042500                                                                  04250000
042600 1000-INITIALIZE.                                                 04260000
042700     SET PS-NO-ASSIGNMENT-ERROR TO TRUE.                          04270000
042800                                                                  04280000
042900     OPEN OUTPUT ASSIGNMENT-WARNING-FILE                          04290000
043000                 ASSIGNMENT-CONTROL-FILE.                         04300000
043100                                                                  04310000
043200     MOVE FUNCTION CURRENT-DATE (1:4) TO PV-CT-YEAR.              04320000
043300     MOVE FUNCTION CURRENT-DATE (5:2) TO PV-CT-MONTH.             04330000
043400     MOVE FUNCTION CURRENT-DATE (7:2) TO PV-CT-DAY.               04340000
043500     MOVE FUNCTION CURRENT-DATE (9:2) TO PV-CT-HOUR.              04350000
043600     MOVE FUNCTION CURRENT-DATE (11:2) TO PV-CT-MINUTE.           04360000
043700     MOVE FUNCTION CURRENT-DATE (13:2) TO PV-CT-SECOND.           04370000
043800                                                                  04380000
043900     IF (LS-PARAMETER-LIST-SIZE > ZEROES)                         04390000
044000         MOVE LS-PARAMETER-LIST-DISPLAY(1:LS-PARAMETER-LIST-SIZE) 04400000
044100                   TO PV-PARAMETER-LIST                           04410000
044200         DISPLAY PC-CURRENT-PROGRAM-NAME ' - PARAMETER LIST = "'  04420000
044300                   PV-PARAMETER-LIST(1:LS-PARAMETER-LIST-SIZE)    04430000
044400                   '"'                                            04440000
044500         IF (PV-PARAMETER-LIST = SPACES)                          04450000
044600             SET PV-CE-BLANK-PARAMETER-LIST TO TRUE               04460000
044700             DISPLAY PC-CURRENT-PROGRAM-NAME ' - '                04470000
044800                       PC-ERROR-DISPLAY-TAG                       04480000
044900                       PV-CURRENT-ERROR                           04490000
045000             SET PS-PARAMETER-ERROR TO TRUE                       04500000
045100             PERFORM 8000-WRITE-WARNING-MESSAGE                   04510000
045200         ELSE                                                     04520000
045300             IF (LS-PARAMETER-LIST-SIZE > PC-PARAMETER-LIST-SIZE) 04530000
045400                 SET PV-CE-INVALID-PARAMETER-LENGTH TO TRUE       04540000
045500                 MOVE LS-PARAMETER-LIST-SIZE TO                   04550000
045600                           PV-PARAMETER-LIST-SIZE-DISPLAY         04560000
045700                 DISPLAY PC-CURRENT-PROGRAM-NAME  ' - '           04570000
045800                           PC-ERROR-DISPLAY-TAG                   04580000
045900                           PV-CURRENT-ERROR                       04590000
046000                 DISPLAY PC-CURRENT-PROGRAM-NAME  ' - PARAMETER ' 04600000
046100                           'LIST SIZE OF '                        04610000
046200                           PV-PARAMETER-LIST-SIZE-DISPLAY         04620000
046300                           ' DETECTED'                            04630000
046400                 SET PS-PARAMETER-ERROR TO TRUE                   04640000
046500                 PERFORM 8000-WRITE-WARNING-MESSAGE               04650000
046600             END-IF                                               04660000
046700         END-IF                                                   04670000
046800     ELSE                                                         04680000
046900         SET PV-CE-NO-PARAMETERS TO TRUE                          04690000
047000         DISPLAY PC-CURRENT-PROGRAM-NAME ' - '                    04700000
047100                   PC-ERROR-DISPLAY-TAG                           04710000
047200                   PV-CURRENT-ERROR                               04720000
047300         SET PS-PARAMETER-ERROR TO TRUE                           04730000
047400         PERFORM 8000-WRITE-WARNING-MESSAGE                       04740000
047500     END-IF.                                                      04750000
047600                                                                  04760000
047700     IF (PS-NO-ASSIGNMENT-ERROR)                                  04770000
047800         INITIALIZE PV-JOB-NAME                                   04780000
047900                    PV-TALLY                                      04790000
048000         INSPECT PV-PARAMETER-LIST                                04800000
048100             TALLYING PV-TALLY                                    04810000
048200             FOR ALL PC-JOB-QUALIFER-DELIMITER                    04820000
048300         IF (PV-TALLY = ZERO)                                     04830000
048400             MOVE PV-PARAMETER-LIST TO PV-JOB-NAME-PARSED         04840000
048500         ELSE                                                     04850000
048600             UNSTRING PV-PARAMETER-LIST                           04860000
048700                 DELIMITED BY PC-JOB-QUALIFER-DELIMITER           04870000
048800                 INTO PV-JOB-NAME-PARSED                          04880000
048900                      PV-PARAMETER-LIST-REST                      04890000
049000             END-UNSTRING                                         04900000
049100         END-IF                                                   04910000
049200         DISPLAY PC-CURRENT-PROGRAM-NAME ' - JOB NAME IS "'       04920000
049300                   PV-JOB-NAME-PARSED '"'                         04930000
049400         INITIALIZE PV-TALLY                                      04940000
049500         INSPECT PV-JOB-NAME-PARSED                               04950000
049600             TALLYING PV-TALLY                                    04960000
049700             FOR LEADING SPACES                                   04970000
049800         IF (PV-TALLY > ZERO)                                     04980000
049900             SET PV-CE-JOB-LEADING-SPACES TO TRUE                 04990000
050000             DISPLAY PC-CURRENT-PROGRAM-NAME ' - '                05000000
050100                       PC-ERROR-DISPLAY-TAG                       05010000
050200                       PV-CURRENT-ERROR                           05020000
050300             SET PS-PARAMETER-ERROR TO TRUE                       05030000
050400             PERFORM 8000-WRITE-WARNING-MESSAGE                   05040000
050500         END-IF                                                   05050000
050600         INITIALIZE PV-TALLY                                      05060000
050700         INSPECT PV-JOB-NAME-PARSED                               05070000
050800             TALLYING PV-TALLY                                    05080000
050900             FOR CHARACTERS BEFORE INITIAL SPACES                 05090000
051000         MOVE PV-TALLY TO PV-JOB-NAME-LENGTH                      05100000
051100         IF (PV-JOB-NAME-LENGTH > (LENGTH OF PV-JOB-NAME))        05110000
051200             SET PV-CE-JOB-NAME-LENGTH TO TRUE                    05120000
051300             DISPLAY PC-CURRENT-PROGRAM-NAME ' - '                05130000
051400                       PC-ERROR-DISPLAY-TAG                       05140000
051500                       PV-CURRENT-ERROR                           05150000
051600             SET PS-PARAMETER-ERROR TO TRUE                       05160000
051700             PERFORM 8000-WRITE-WARNING-MESSAGE                   05170000
051800         END-IF                                                   05180000
051900     END-IF.                                                      05190000
052000                                                                  05200000
052100     ACCEPT CC-CONTROL-CARD.                                      05210000
052200     DISPLAY PC-CURRENT-PROGRAM-NAME  ' - CONTROL CARD = ('       05220000
052300               CC-CONTROL-CARD-DISPLAY  ')'.                      05230000
052400     DISPLAY PC-CURRENT-PROGRAM-NAME  ' - JOB DOCUMENTATION PDS ='05240000
052500               ' "' CC-JOB-DOCUMENTATION-DSN '"'.                 05250000
052510                                                                  05251005
052511     PERFORM 1100-GET-ASSIGNMENT-OVERRIDE.                        05251106
052600*1000-EXIT.                                                       05260000
053220                                                                  05322006
053230******************************************************************05323006
053240*  GET THE ASSIGNMENT OVERRIDE INFORMATION.  READ THE ASSIGNMENT *05324018
053241*  OVERRIDE FILE TO SEE IF OVERRIDES WERE SPECIFIED.  IF         *05324118
053242*  OVERRIDES WERE SPECIFID, VALIDATE THAT A VALID IMPACT AND     *05324218
053243*  URGENCY WERE INCLUDED.  IF AN ASSIGNMENT GROUP WAS EXPLICITLY *05324318
053244*  SPECIFIED, VALIDATE THAT IS A VALID ASSIGNMENT GROUP.         *05324418
053250******************************************************************05325006
053260                                                                  05326006
053270 1100-GET-ASSIGNMENT-OVERRIDE.                                    05327006
053271     INITIALIZE PV-OVERRIDE-INFORMATION.                          05327109
053272                                                                  05327209
053273     OPEN INPUT ASSIGNMENT-OVERRIDE-FILE.                         05327306
053274                                                                  05327406
053275     PERFORM 7400-READ-ASSIGN-OVERRIDE-FILE.                      05327506
053276                                                                  05327606
053277     IF ((PS-END-OF-ASSIGN-OVER-FILE)                             05327706
053278             OR (PV-NO-ASSIGNMENT-OVERRIDE))                      05327806
053279         INITIALIZE PV-ASSIGNMENT-OVERRIDE-RECORD                 05327906
053280         DISPLAY PC-CURRENT-PROGRAM-NAME  ' - NO ASSIGNMENT '     05328006
053281                   'OVERRIDE PROVIDED'                            05328106
053282     ELSE                                                         05328206
053283         DISPLAY PC-CURRENT-PROGRAM-NAME  ' - OPTIONAL '          05328308
053284                   'ASSIGNMENT OVERRIDE SPECIFIED = '             05328408
053285                   PV-ASSIGNMENT-OVERRIDE-RECORD                  05328508
053286                                                                  05328608
053287         SET PS-NO-ASSIGN-OVER-OVERFLOW TO TRUE                   05328708
053288         INITIALIZE PV-TALLY                                      05328808
053289         UNSTRING PV-ASSIGNMENT-OVERRIDE-RECORD                   05328908
053290             DELIMITED BY ","                                     05329008
053291             INTO PV-OI-IMPACT                                    05329108
053292                  PV-OI-URGENCY                                   05329208
053293                  PV-OI-ASSIGNMENT-GROUP                          05329308
053294             TALLYING IN PV-TALLY                                 05329408
053295             ON OVERFLOW SET PS-ASSIGN-OVER-OVERFLOW TO TRUE      05329508
053296         END-UNSTRING                                             05329608
053297                                                                  05329708
053298         DISPLAY PC-CURRENT-PROGRAM-NAME  ' - PARSED ASSIGNMENT ' 05329808
053299                   'OVERRIDE DETAILS'                             05329908
053300         DISPLAY PC-CURRENT-PROGRAM-NAME  ' -     IMPACT = '      05330008
053301                   PV-OI-IMPACT                                   05330108
053302         DISPLAY PC-CURRENT-PROGRAM-NAME  ' -     URGENCY = '     05330208
053303                   PV-OI-URGENCY                                  05330308
053304         DISPLAY PC-CURRENT-PROGRAM-NAME  ' -     ASSIGNMENT '    05330408
053305                   'GROUP = ' PV-OI-ASSIGNMENT-GROUP              05330508
053307                                                                  05330708
053310         IF (((PV-TALLY NOT = PC-DFLT-ASSIGNMENT-PARM-COUNT) AND  05331014
053311                 (PV-TALLY NOT = PC-ASSIGNMENT-PARM-COUNT)) OR    05331115
053313                 (PS-ASSIGN-OVER-OVERFLOW))                       05331309
053314             DISPLAY PC-CURRENT-PROGRAM-NAME  ' - ASSIGNMENT '    05331408
053315                       'OVERRIDE ERROR'                           05331508
053316             DISPLAY PC-CURRENT-PROGRAM-NAME  ' -     FIELD '     05331608
053317                       'COUNT TALLY = '  PV-TALLY                 05331708
053318             DISPLAY PC-CURRENT-PROGRAM-NAME  ' -     OVERFLOW '  05331808
053319                       'INDICATOR = '  PS-ASSIGN-OVER-OVERFLOW-IND05331908
053320             SET PV-CE-ASSIGN-OVERRIDE-PARSE TO TRUE              05332008
053321             DISPLAY PC-CURRENT-PROGRAM-NAME ' - '                05332108
053322                       PC-ERROR-DISPLAY-TAG                       05332208
053323                       PV-CURRENT-ERROR                           05332308
053324             SET PS-PARAMETER-ERROR TO TRUE                       05332408
053325             PERFORM 8000-WRITE-WARNING-MESSAGE                   05332508
053326         ELSE                                                     05332608
053328             IF (PV-OI-IMPACT NOT NUMERIC)                        05332811
053329                 SET PV-CE-INVALID-OVERRIDE-IMPACT TO TRUE        05332911
053330                 DISPLAY PC-CURRENT-PROGRAM-NAME ' - '            05333011
053331                           PC-ERROR-DISPLAY-TAG                   05333111
053332                           PV-CURRENT-ERROR                       05333211
053333                 SET PS-PARAMETER-ERROR TO TRUE                   05333311
053334                 PERFORM 8000-WRITE-WARNING-MESSAGE               05333411
053335             END-IF                                               05333511
053336             IF (PV-OI-URGENCY NOT NUMERIC)                       05333611
053337                 SET PV-CE-INVALID-OVERRIDE-URGENCY TO TRUE       05333711
053338                 DISPLAY PC-CURRENT-PROGRAM-NAME ' - '            05333811
053339                           PC-ERROR-DISPLAY-TAG                   05333911
053340                           PV-CURRENT-ERROR                       05334011
053341                 SET PS-PARAMETER-ERROR TO TRUE                   05334111
053342                 PERFORM 8000-WRITE-WARNING-MESSAGE               05334211
053343             END-IF                                               05334311
053346             IF ((PV-TALLY NOT = PC-ASSIGNMENT-PARM-COUNT) OR     05334615
053347                     (PV-OI-ASSIGNMENT-GROUP = SPACES))           05334711
053348                 DISPLAY PC-CURRENT-PROGRAM-NAME  ' - ASSIGNMENT '05334811
053349                           'OVERRIDE REQUESTING DEFAULT '         05334911
053350                           'ASSIGNMENT GROUP'                     05335011
053351             ELSE                                                 05335111
053352                 DISPLAY PC-CURRENT-PROGRAM-NAME  ' - ASSIGNMENT '05335211
053353                           'OVERRIDE EXPLICITLY ASSIGNING TO '    05335311
053354                           PV-OI-ASSIGNMENT-GROUP                 05335411
053355                 MOVE PV-OI-ASSIGNMENT-GROUP TO                   05335511
053356                           PV-AI-ASSIGNMENT-GROUP                 05335611
053357                 PERFORM 4200-FIND-ASSIGNMENT-GROUP               05335712
053358                 IF (PS-ASSIGNMENT-GROUP-NOT-FOUND)               05335811
053359                     SET PV-CE-INVALID-OVERRIDE-GROUP TO TRUE     05335911
053360                     DISPLAY PC-CURRENT-PROGRAM-NAME ' - '        05336011
053361                               PC-ERROR-DISPLAY-TAG               05336111
053362                               PV-CURRENT-ERROR                   05336211
053363                     SET PS-PARAMETER-ERROR TO TRUE               05336311
053364                     PERFORM 8000-WRITE-WARNING-MESSAGE           05336411
053365                 END-IF                                           05336511
053366             END-IF                                               05336611
053367         END-IF                                                   05336711
053368     END-IF.                                                      05336811
053369                                                                  05336911
053370     CLOSE ASSIGNMENT-OVERRIDE-FILE.                              05337011
053371*1100-EXIT.                                                       05337111
053372                                                                  05337211
053373******************************************************************05337311
053374*  DISPLAY SUMMARY TOTALS OF I/O ACTIVITY.                       *05337411
053375******************************************************************05337511
053376                                                                  05337611
053377 1500-DISPLAY-PROGRAM-TOTALS.                                     05337711
053378     DISPLAY PC-CURRENT-PROGRAM-NAME  ' - '.                      05337811
053379                                                                  05337911
053380     SET TD-JOB-DOC-LINES-READ-ID TO TRUE.                        05338011
053381     MOVE PT-JOB-DOC-LINES-READ TO TD-TOTAL-AMOUNT.               05338111
053382     DISPLAY PC-CURRENT-PROGRAM-NAME  ' - '                       05338211
053383               TD-TOTAL-DISPLAY-MESSAGE.                          05338311
053384                                                                  05338411
053385     SET TD-SYSID-DFLT-RECORDS-READ-ID TO TRUE.                   05338511
053386     MOVE PT-SYSID-DFLT-RECORDS-READ TO TD-TOTAL-AMOUNT.          05338611
053390     DISPLAY PC-CURRENT-PROGRAM-NAME  ' - '                       05339000
053400               TD-TOTAL-DISPLAY-MESSAGE.                          05340000
053500                                                                  05350000
053600     SET TD-ASSIGN-GRP-RECORDS-READ-ID TO TRUE.                   05360000
053700     MOVE PT-ASSIGN-GRP-RECORDS-READ TO TD-TOTAL-AMOUNT.          05370000
053800     DISPLAY PC-CURRENT-PROGRAM-NAME  ' - '                       05380000
053900               TD-TOTAL-DISPLAY-MESSAGE.                          05390000
054000                                                                  05400000
054100     SET TD-ASSIGN-EXCP-RECORDS-READ-ID TO TRUE.                  05410000
054200     MOVE PT-ASSIGN-EXCP-RECORDS-READ TO TD-TOTAL-AMOUNT.         05420000
054300     DISPLAY PC-CURRENT-PROGRAM-NAME  ' - '                       05430000
054400               TD-TOTAL-DISPLAY-MESSAGE.                          05440000
054410                                                                  05441005
054420     SET TD-ASSIGN-OVER-RECORDS-READ-ID TO TRUE.                  05442005
054430     MOVE PT-ASSIGN-OVER-RECORDS-READ TO TD-TOTAL-AMOUNT.         05443005
054440     DISPLAY PC-CURRENT-PROGRAM-NAME  ' - '                       05444005
054450               TD-TOTAL-DISPLAY-MESSAGE.                          05445005
054500                                                                  05450000
054600     SET TD-ASSIGN-WARN-RCDS-WRITTEN-ID TO TRUE.                  05460000
054700     MOVE PT-ASSIGN-WARN-RCDS-WRITTEN TO TD-TOTAL-AMOUNT.         05470000
054800     DISPLAY PC-CURRENT-PROGRAM-NAME  ' - '                       05480000
054900               TD-TOTAL-DISPLAY-MESSAGE.                          05490000
055000                                                                  05500000
055100     SET TD-ASSIGN-CNTL-RCDS-WRITTEN-ID TO TRUE.                  05510000
055200     MOVE PT-ASSIGN-CNTL-RCDS-WRITTEN TO TD-TOTAL-AMOUNT.         05520000
055300     DISPLAY PC-CURRENT-PROGRAM-NAME  ' - '                       05530000
055400               TD-TOTAL-DISPLAY-MESSAGE.                          05540000
055500*1500-EXIT.                                                       05550000
055600                                                                  05560000
055700******************************************************************05570000
056600*  FIND THE INCIDENT ASSIGNMENT DETAILS FOR THE CURRENT PROCESS. *05660018
056610*  FIND THE JOB DOCUMENTATION MEMBER THAT WOULD SUPPORT THE      *05661018
056698*  CURRENT JOB NAME.  READ THROUGH THE JOB DOCUMENTATION TO      *05669818
056699*  PARSE OUT THE IMPACT, URGENCY, ASSIGNMENT GROUP AND FIRST     *05669918
056700*  CONTACT TO OPERATIONS INDICATOR.  GET THE SYSTEM ID DEFAULT   *05670018
056701*  ASSIGNMENT GROUP.  DETERMINE THE APPROPRIATE ASSIGNMENT GROUP *05670118
056702*  FOR THIS JOB.  IF THE ASSIGNMENT GROUP IS A CODE FOR AN       *05670218
056703*  ASSIGNMENT EXCEPTION, DETERMINE THE APPROPRIATE ASSIGNMENT    *05670318
056704*  GROUP FOR THIS VERSION OF THE PROCESS.                        *05670418
056710******************************************************************05671018
056800                                                                  05680000
056900 2000-FIND-ASSIGNMENT-DETAILS.                                    05690010
056901     PERFORM 3000-FIND-JOB-DOC-MEMBER.                            05690110
056902                                                                  05690210
056903     IF ((PS-NO-ASSIGNMENT-ERROR) AND                             05690310
056904             (PS-JOB-DOC-MEMBER-NOT-FOUND))                       05690410
056905         INITIALIZE PV-CURRENT-ERROR                              05690510
056906         STRING 'NO JOB DOCUMENTATION MEMBER '   DELIMITED BY SIZE05690610
056907                'FOUND TO SUPPORT JOB '          DELIMITED BY SIZE05690710
056908                PV-JOB-NAME(1:PV-JOB-NAME-LENGTH)                 05690810
056909                                                 DELIMITED BY SIZE05690910
056910             INTO PV-CURRENT-ERROR                                05691010
056911         DISPLAY PC-CURRENT-PROGRAM-NAME ' - '                    05691110
056912                   PC-ERROR-DISPLAY-TAG                           05691210
056913                   PV-CURRENT-ERROR                               05691310
056914         SET PS-JOB-DOC-ERROR TO TRUE                             05691410
056915         PERFORM 8000-WRITE-WARNING-MESSAGE                       05691510
056916     END-IF.                                                      05691610
056917                                                                  05691710
056918     IF (PS-NO-ASSIGNMENT-ERROR)                                  05691810
056919         MOVE PV-JOB-NAME(1:PV-JOB-DOC-NAME-LENGTH) TO            05691910
056920                   PV-JOB-DOC-MEMBER-NAME                         05692010
056921         DISPLAY PC-CURRENT-PROGRAM-NAME ' - JOB DOCUMENTATION '  05692110
056922                   'FOUND AS ' PV-JOB-DOC-MEMBER-NAME             05692210
056923         PERFORM 4000-GET-JOB-DOC-DETAILS                         05692312
056924     END-IF.                                                      05692410
056925                                                                  05692510
056926     IF (PS-NO-ASSIGNMENT-ERROR)                                  05692610
056927         IF (NOT PS-ALL-JOB-DOC-LINES-FOUND)                      05692710
056928             INITIALIZE PV-CURRENT-ERROR                          05692810
056929             STRING 'NOT ALL ASSIGNMENT '        DELIMITED BY SIZE05692910
056930                    'INFORMATION FOUND IN '      DELIMITED BY SIZE05693010
056931                    'JOB DOCUMENTATION MEMBER '  DELIMITED BY SIZE05693110
056932                    PV-JOB-DOC-MEMBER-NAME       DELIMITED BY SIZE05693210
056933                 INTO PV-CURRENT-ERROR                            05693310
056934             DISPLAY PC-CURRENT-PROGRAM-NAME ' - '                05693410
056935                       PC-ERROR-DISPLAY-TAG                       05693510
056936                       PV-CURRENT-ERROR                           05693610
056937             SET PS-JOB-DOC-ERROR TO TRUE                         05693710
056938             PERFORM 8000-WRITE-WARNING-MESSAGE                   05693810
056939         END-IF                                                   05693910
056940         DISPLAY PC-CURRENT-PROGRAM-NAME ' - ASSIGNMENT '         05694010
056941                   'INFORMATION FROM JOB DOCUMENTATION:'          05694110
056942         DISPLAY PC-CURRENT-PROGRAM-NAME ' -      IMPACT: '       05694210
056943                   PV-AI-IMPACT                                   05694310
056944         DISPLAY PC-CURRENT-PROGRAM-NAME ' -      URGENCY: '      05694410
056945                   PV-AI-URGENCY                                  05694510
056946         DISPLAY PC-CURRENT-PROGRAM-NAME ' -      ASSIGNMENT '    05694610
056947                   'GROUP: ' PV-AI-ASSIGNMENT-GROUP               05694710
056948         DISPLAY PC-CURRENT-PROGRAM-NAME ' -      CONTACT OPS: '  05694810
056949                   PV-AI-CONTACT-OPS                              05694910
056950     END-IF.                                                      05695010
056951                                                                  05695110
056952     IF (PS-NO-ASSIGNMENT-ERROR)                                  05695210
056953         PERFORM 4100-FIND-SYSID-DEFAULT                          05695312
056954     END-IF.                                                      05695410
056955                                                                  05695510
056956     IF ((PS-NO-ASSIGNMENT-ERROR) AND                             05695610
056957             (PS-SYSID-DFLT-NOT-FOUND))                           05695710
056958         INITIALIZE PV-CURRENT-ERROR                              05695810
056959         STRING 'NO SYSTEM ID DEFAULT FOR '      DELIMITED BY SIZE05695910
056960                PV-JD-SYSTEM-ID                  DELIMITED BY SIZE05696010
056961                ' TO SUPPORT JOB '               DELIMITED BY SIZE05696110
056962                PV-JOB-NAME(1:PV-JOB-NAME-LENGTH)                 05696210
056963                                                 DELIMITED BY SIZE05696310
056964             INTO PV-CURRENT-ERROR                                05696410
056965*                                                                 05696510
056966*  IT IS ONLY A WARNING WHEN THERE IS NO SYSTEM ID DEFAULT        05696610
056967*  ASSIGNMENT GROUP FOUND, BECAUSE PROCESSES LIKE STARTED TASKS   05696710
056968*  ARE NOT ALWAYS NAMED INCLUDING THE SYSTEM ID AS THE FIRST TWO  05696810
056969*  CHARACTERS.                                                    05696910
056970*                                                                 05697010
056971         DISPLAY PC-CURRENT-PROGRAM-NAME ' - '                    05697110
056972                   PC-WARNING-DISPLAY-TAG                         05697210
056973                   PV-CURRENT-ERROR                               05697310
056974         PERFORM 8000-WRITE-WARNING-MESSAGE                       05697410
056975     END-IF.                                                      05697510
056976                                                                  05697610
056977     IF (PS-NO-ASSIGNMENT-ERROR)                                  05697710
056978         PERFORM 4200-FIND-ASSIGNMENT-GROUP                       05697812
056979     END-IF.                                                      05697910
056980                                                                  05698010
056981     IF ((PS-NO-ASSIGNMENT-ERROR) AND                             05698110
056982             (NOT PV-AI-DEFAULT-ASSIGNMENT) AND                   05698210
056983             (PS-ASSIGNMENT-GROUP-NOT-FOUND))                     05698310
056984         PERFORM 4300-CHECK-FOR-EXCEPTION                         05698412
056985     END-IF.                                                      05698510
056986*2000-EXIT.                                                       05698610
056987                                                                  05698710
056988******************************************************************05698810
056989*  FIND THE JOB DOCUMENTATION MEMBER THAT SUPPORTS THE CURRENT   *05698910
056990*  JOB NAME.  BEGIN SEARCHING FOR A DOCUMENTATION MEMBER THAT    *05699010
056991*  MATCHES THE CURRENT JOB NAME.  IF NOT FOUND, CONTINUE TO      *05699110
056992*  CHECK FOR JOB DOCUMENTATION MEMBERS THAT MATCH THE PREFIX     *05699210
056993*  OF THE JOB NAME (FOR SUPPORT OF MULTI-THREADED, or LOCATION-  *05699310
056994*  SPECIFIC PROCESSES).  CONTINUE TO WORK BACKWARD IN CHECKING   *05699410
056995*  FOR A MATCHING BASE JOB UNTIL THERE IS EITHER A PROCESSING    *05699510
056996*  ERROR, A MATCHING BASE JOB IS FOUND, OR IT IS PROVEN THAT     *05699610
056997*  THERE CANNOT BE A MATCHING BASE JOB.                          *05699710
056998******************************************************************05699810
056999                                                                  05699910
057000 3000-FIND-JOB-DOC-MEMBER.                                        05700010
057010     SET PS-JOB-DOC-MEMBER-NOT-FOUND TO TRUE.                     05701000
057100                                                                  05710000
057110     DISPLAY PC-CURRENT-PROGRAM-NAME  ' - '.                      05711000
057120                                                                  05712000
057130     PERFORM                                                      05713000
057140             VARYING PV-JOB-NAME-POSITION                         05714000
057150             FROM PV-JOB-NAME-LENGTH BY -1                        05715000
057160             UNTIL ((PS-ASSIGNMENT-ERROR)                         05716000
057170                     OR (PS-JOB-DOC-MEMBER-FOUND)                 05717000
057180                     OR (PV-JOB-NAME-POSITION = 1))               05718000
057190         MOVE PV-JOB-NAME-POSITION TO                             05719000
057200                   PV-JOB-DOC-NAME-LENGTH                         05720000
057300         DISPLAY PC-CURRENT-PROGRAM-NAME ' - ' PV-JOB-NAME        05730000
057400                   ' - CHECKING DOCUMENTATION MEMBER AS '         05740000
057500                   PV-JOB-NAME(1:PV-JOB-DOC-NAME-LENGTH)          05750000
057600         PERFORM 9100-ALLOC-JOB-DOC-FILE                          05760000
057700     END-PERFORM.                                                 05770000
057800                                                                  05780000
057900     DISPLAY PC-CURRENT-PROGRAM-NAME  ' - '.                      05790000
058000*3000-EXIT.                                                       05800010
058100                                                                  05810000
058200******************************************************************05820000
058300*  GET THE REQUIRED JOB DOCUMENTATION DETAILS FOR MAKING THE     *05830000
058400*  ASSIGNMENT DECISION.  OPEN THE JOB DOCUMENTATION MEMBER THAT  *05840000
058500*  SUPPORTS THE CURRENT JOB NAME.  READ AND EVALUATE JOB         *05850000
058600*  DOCUMENTATION MEMBER LINES UNTIL EITHER ALL REQUIRED DETAILS  *05860000
058610*  HAVE BEEN GATHERED, OR THE END OF THE FILE HAS BEEN REACHED.  *05861000
058620*  REQUIRED DETAILS WILL BE IDENTIFIED BY THE TEMPLATE-ENFORCED  *05862000
058630*  LABELS, AND THE SPECIFIC OFFSET FROM THE LABEL, AND FORMAT OF *05863000
058640*  THE CONTENTS.  THE REQUIRED FIELDS ARE: IMPACT, URGENCY,      *05864000
058650*  ASSIGNMENT GROUP, AND FIRST CONTACT TO OPERATIONS.  CLOSE THE *05865000
058660*  JOB DOCUMENTATION MEMBER.                                     *05866000
058670******************************************************************05867000
058680                                                                  05868000
058690 4000-GET-JOB-DOC-DETAILS.                                        05869010
058700     SET PS-NO-JOB-DOC-LINES-FOUND TO TRUE.                       05870000
058800                                                                  05880000
058900     OPEN INPUT JOB-DOCUMENTATION-FILE.                           05890000
059000                                                                  05900000
059100     PERFORM 7000-READ-JOB-DOC-FILE.                              05910000
059200                                                                  05920000
059300     PERFORM                                                      05930000
059400             UNTIL ((PS-END-OF-JOB-DOC-FILE)                      05940000
059500                     OR (PS-ALL-JOB-DOC-LINES-FOUND))             05950000
059600         EVALUATE TRUE                                            05960000
059700             WHEN (PV-JD-IMPACT-ID)                               05970000
059800                 MOVE PV-JD-IMPACT TO PV-AI-IMPACT                05980000
059900                 SET PS-AD-IMPACT-FOUND TO TRUE                   05990000
060000             WHEN (PV-JD-URGENCY-ID)                              06000000
060100                 MOVE PV-JD-URGENCY TO PV-AI-URGENCY              06010000
060200                 SET PS-AD-URGENCY-FOUND TO TRUE                  06020000
060300             WHEN (PV-JD-ASSIGNMENT-GROUP-ID)                     06030000
060400                 MOVE PV-JD-ASSIGNMENT-GROUP TO                   06040000
060500                           PV-AI-ASSIGNMENT-GROUP                 06050000
060600                 SET PS-AD-ASSIGNMENT-GROUP-FOUND TO TRUE         06060000
060700             WHEN (PV-JD-CONTACT-OPS-ID)                          06070000
060800                 MOVE PV-JD-CONTACT-OPS TO PV-AI-CONTACT-OPS      06080000
060900                 SET PS-AD-CONTACT-OPS-FOUND TO TRUE              06090000
061000         END-EVALUATE                                             06100000
061100         PERFORM 7000-READ-JOB-DOC-FILE                           06110000
061200     END-PERFORM.                                                 06120000
061300                                                                  06130000
061400     CLOSE JOB-DOCUMENTATION-FILE.                                06140000
061500*4000-EXIT.                                                       06150010
061600                                                                  06160000
061700******************************************************************06170000
061800*  FIND THE DEFAULT ASSIGNMENT GROUP FOR THE SYSTEM ID           *06180000
061900*  ASSOCIATED WITH THE CURRENT JOB NAME.  OPEN THE CALL LIST     *06190000
062000*  SYSTEM ID DEFAULT ASSIGNMENT GROUP FILE.  READ AND EVALUATE   *06200000
062100*  SYSTEM ID DEFAULT ASSIGNMENT GROUP RECORDS UNTIL EITHER THE   *06210000
062110*  DEFAULT ASSIGNMENT FOR THE CURRENT SYSTEM ID IS FOUND, OR     *06211000
062120*  THE END OF THE FILE HAS BEEN REACHED.  THE FILE WILL NOT BE   *06212000
062130*  READ BEYOND WHERE THE RECORD HAS BEEN FOUND, SO THE VARIABLES *06213000
062140*  FOR THE RECORD LAYOUT CAN BE USED IN LATER PROCESSING.  CLOSE *06214000
062150*  THE CALL LIST SYSTEM ID DEFAULT ASSIGNMENT GROUP FILE.        *06215000
062160******************************************************************06216000
062170                                                                  06217000
062180 4100-FIND-SYSID-DEFAULT.                                         06218010
062190     SET PS-SYSID-DFLT-NOT-FOUND TO TRUE.                         06219000
062200                                                                  06220000
062300     OPEN INPUT SYSTEM-ID-DEFAULT-FILE.                           06230000
062400                                                                  06240000
062500     PERFORM 7100-READ-SYSID-DFLT-FILE.                           06250000
062600                                                                  06260000
062700     PERFORM                                                      06270000
062800             UNTIL ((PS-END-OF-SYSID-DFLT-FILE)                   06280000
062900                     OR (PS-SYSID-DFLT-FOUND))                    06290000
063000         IF (CM004-SYSTEM-ID = PV-JD-SYSTEM-ID)                   06300000
063100             SET PS-SYSID-DFLT-FOUND TO TRUE                      06310000
063200         END-IF                                                   06320000
063300         IF (PS-SYSID-DFLT-NOT-FOUND)                             06330000
063400             PERFORM 7100-READ-SYSID-DFLT-FILE                    06340000
063500         END-IF                                                   06350000
063600     END-PERFORM.                                                 06360000
063700                                                                  06370000
063800     CLOSE SYSTEM-ID-DEFAULT-FILE.                                06380000
063900*4100-EXIT.                                                       06390010
064000                                                                  06400000
064100******************************************************************06410000
064200*  FIND THE ASSIGNMENT GROUP LISTED IN THE JOB DOCUMENTATION TO  *06420000
064300*  CONFIRM IT IS AN VALID, ACTIVE ASSIGNMENT GROUP, AND NOT A    *06430000
064400*  CODE FOR AN ASSIGNMENT EXCEPTION.  OPEN THE VALID ASSIGNMENT  *06440000
064410*  GROUP FILE.  READ AND EVALUATE VALID ASSIGNMENT GROUP RECORDS *06441000
064420*  UNTIL EITHER THE ASSIGNMENT GROUP IS FOUND, OR THE END OF THE *06442000
064430*  FILE HAS BEEN REACHED.  CLOSE THE VALID ASSIGNMENT GROUP      *06443000
064440*  FILE.                                                         *06444000
064450******************************************************************06445000
064460                                                                  06446000
064470 4200-FIND-ASSIGNMENT-GROUP.                                      06447010
064480     SET PS-ASSIGNMENT-GROUP-NOT-FOUND TO TRUE.                   06448000
064490                                                                  06449000
064500     OPEN INPUT ASSIGNMENT-GROUP-FILE.                            06450000
064600                                                                  06460000
064700     PERFORM 7200-READ-ASSIGN-GRP-FILE.                           06470000
064800                                                                  06480000
064900     PERFORM                                                      06490000
065000             UNTIL ((PS-END-OF-ASSIGN-GRP-FILE)                   06500000
065100                     OR (PS-ASSIGNMENT-GROUP-FOUND))              06510000
065400         IF (PV-ASSIGNMENT-GROUP-RECORD = PV-AI-ASSIGNMENT-GROUP) 06540000
065500             SET PS-ASSIGNMENT-GROUP-FOUND TO TRUE                06550000
065600         END-IF                                                   06560000
065700         PERFORM 7200-READ-ASSIGN-GRP-FILE                        06570000
065800     END-PERFORM.                                                 06580000
065900                                                                  06590000
066000     CLOSE ASSIGNMENT-GROUP-FILE.                                 06600000
066100*4200-EXIT.                                                       06610010
066200                                                                  06620000
066300******************************************************************06630000
066400*  CHECK TO SEE IF AN ASSIGNMENT GROUP EXCEPTION IS BEING USED.  *06640000
066500*  OPEN THE ASSIGNMENT GROUP EXCEPTION FILE.  READ AND EVALUATE  *06650000
066600*  ASSIGNMENT GROUP EXCEPTION RECORDS TO BOTH DETERMINE IF A     *06660000
066610*  VALID ASSIGNMENT GROUP EXCEPTION CODE HAS BEEN SPECIFIED, AND *06661000
066620*  IF A MATCHING EXCEPTION HAS BEEN FOUND FOR THE CURRENT JOB    *06662000
066630*  NAME, UNTIL EITHER A MATCHING EXCEPTION HAS BEEN FOUND, OR    *06663000
066640*  THE END OF THE FILE HAS BEEN REACHED.  EXCEPTIONS WILL ONLY   *06664000
066650*  BE ALLOWED FOR STANDARD SIX CHARACTER BASE JOB NAMES.  CLOSE  *06665000
066660*  THE ASSIGNMENT GROUP EXCEPTION FILE.                          *06666000
066670******************************************************************06667000
066680                                                                  06668000
066690 4300-CHECK-FOR-EXCEPTION.                                        06669010
066700     SET PS-ASSIGNMENT-CODE-NOT-FOUND                             06670000
066800         PS-ASSIGNMENT-EXCP-NOT-FOUND TO TRUE.                    06680000
066900                                                                  06690000
067000     OPEN INPUT ASSIGNMENT-EXCP-FILE.                             06700000
067100                                                                  06710000
067200     PERFORM 7300-READ-ASSIGN-EXCP-FILE.                          06720000
067300                                                                  06730000
067400     PERFORM                                                      06740000
067500             UNTIL ((PS-END-OF-ASSIGN-EXCP-FILE)                  06750000
067600                     OR (PS-ASSIGNMENT-EXCP-FOUND))               06760000
067700         IF (CM005-ASSIGNMENT-CODE = PV-AI-ASSIGNMENT-GROUP)      06770000
067800             SET PS-ASSIGNMENT-CODE-FOUND TO TRUE                 06780000
067900             IF (CM005-JOB-NAME-SUFFIX = PV-JOB-NAME-SUFFIX)      06790000
068000                 SET PS-ASSIGNMENT-EXCP-FOUND TO TRUE             06800000
068100             END-IF                                               06810000
068200         END-IF                                                   06820000
068300         IF (PS-ASSIGNMENT-EXCP-NOT-FOUND)                        06830000
068400             PERFORM 7300-READ-ASSIGN-EXCP-FILE                   06840000
068500         END-IF                                                   06850000
068600     END-PERFORM.                                                 06860000
068700                                                                  06870000
068800     CLOSE ASSIGNMENT-EXCP-FILE.                                  06880000
068900*4300-EXIT.                                                       06890010
069000                                                                  06900000
069100******************************************************************06910000
069200*  MAKE THE FINAL ASSIGNMENT DECISION, AND SET UP THE ASSIGNMENT *06920000
069210*  CONTROL CARD THAT WILL SUPPORT THAT DECISION.                 *06921000
069220*                                                                *06922000
069230*  THE ASSIGNMENT DECISION OCCURS AS FOLLOWS AFTER APPLYING THE  *06923018
069231*  OVERRIDES THAT WERE EXPLICITLY PROVIDED:                      *06923118
069240*    1. IF ANY ERROR WAS DETECTED, USE THE DEPARTMENTAL DEFAULT  *06924000
069250*       ASSIGNMENT DECISION.                                     *06925000
069260*    2. IF THE JOB REQUIRES THE FIRST CONTACT TO GO TO           *06926000
069270*       OPERATIONS, USE THE DEPARTMENTAL DEFAULT ASSIGNMENT      *06927000
069280*       DECISION.                                                *06928000
069290*    3. IF THE JOB SHOULD USE THE SYSTEM ID DEFAULT ASSIGNMENT   *06929000
069291*       GROUP, IF ALL INFORMATION WAS FOUND, USE THE IMPACT AND  *06929100
069292*       URGENCY FROM THE JOB DOCUMENTATION, AND THE SYSTEM ID    *06929200
069293*       DEFAULT AS THE ASSIGNMENT GROUP, OTHERWISE USE THE       *06929300
069294*       DEPARTMENTAL DEFAULT ASSIGNMENT DECISION.                *06929400
069295*    4. IF THE JOB SHOULD USE AN EXPLICIT ASSIGNMENT GROUP, USE  *06929500
069296*       THE IMPACT, URGENCY AND ASSIGNMENT GROUP FROM THE JOB    *06929600
069297*       DOCUMENTATION.                                           *06929700
069298*    5. IF THE JOB SHOULD USE AN ASSIGNMENT EXCEPTION, AND AN    *06929800
069299*       EXCEPTION MATCHING THE JOB NAME SUFFIX WAS FOUND, USE    *06929900
069300*       THE IMPACT AND URGENCY FROM THE JOB DOCUMENTATION, AND   *06930000
069301*       THE ASSIGNMENT GROUP EXCEPTION FOR THE SPECIFIED         *06930100
069302*       ASSIGNMENT EXCEPTION CODE AND JOB NAME SUFFIX.           *06930200
069303*    6. IF NO CORRECT ASSIGNMENT CAN BE MADE, USE THE            *06930300
069304*       DEPARTMENTAL DEFAULT ASSIGNMENT DECISION.                *06930400
069305******************************************************************06930500
069306                                                                  06930600
069307 5000-SET-FINAL-ASSIGNMENT.                                       06930710
069308                                                                  06930810
069309*                                                                 06930910
069310*  APPLY THE ASSIGNMENT OVERRIDES THAT WERE EXPLICITLY PROVIDED   06931010
069312*                                                                 06931210
069313                                                                  06931310
069314     IF (NOT PV-NO-ASSIGNMENT-OVERRIDE)                           06931410
069315         MOVE PV-OI-IMPACT TO PV-AI-IMPACT                        06931510
069316         MOVE PV-OI-URGENCY TO PV-AI-URGENCY                      06931610
069317         SET PV-AI-DONT-CONTACT-OPS TO TRUE                       06931710
069318         IF (PV-OI-ASSIGNMENT-GROUP NOT = SPACES)                 06931810
069322             MOVE PV-OI-ASSIGNMENT-GROUP TO                       06932210
069323                       PV-AI-ASSIGNMENT-GROUP                     06932310
069325         END-IF                                                   06932510
069326     END-IF.                                                      06932610
069327                                                                  06932710
069328     SET PS-DONT-USE-DEFAULT-ASSIGNMENT TO TRUE.                  06932810
069329     EVALUATE TRUE                                                06932910
069330         WHEN (PS-ASSIGNMENT-ERROR)                               06933010
069331             SET PS-USE-DEFAULT-ASSIGNMENT TO TRUE                06933110
069332         WHEN (PV-AI-CONTACT-OPS-FIRST)                           06933200
069340             SET PS-USE-DEFAULT-ASSIGNMENT TO TRUE                06934000
069350         WHEN (PV-AI-DEFAULT-ASSIGNMENT)                          06935000
069360             IF (PS-SYSID-DFLT-FOUND)                             06936000
069370                 MOVE CM004-ASSIGNMENT-GROUP TO                   06937000
069380                           PV-AI-FINAL-ASSIGNMENT-GROUP           06938000
069390             ELSE                                                 06939000
069400                 INITIALIZE PV-CURRENT-ERROR                      06940000
069500                 STRING 'SYSTEM ID DEFAULT '     DELIMITED BY SIZE06950000
069510                        'REQUIRED AND NOT '      DELIMITED BY SIZE06951000
069511                        'FOUND TO SUPPORT '      DELIMITED BY SIZE06951100
069512                        'JOB DOCUMENTATION '     DELIMITED BY SIZE06951203
069513                        'MEMBER '                DELIMITED BY SIZE06951303
069514                        PV-JOB-DOC-MEMBER-NAME   DELIMITED BY SIZE06951403
069515                     INTO PV-CURRENT-ERROR                        06951503
069516                 DISPLAY PC-CURRENT-PROGRAM-NAME ' - '            06951603
069517                           PC-ERROR-DISPLAY-TAG                   06951703
069518                           PV-CURRENT-ERROR                       06951803
069519                 SET PS-JOB-DOC-ERROR TO TRUE                     06951903
069520                 PERFORM 8000-WRITE-WARNING-MESSAGE               06952003
069521                 SET PS-USE-DEFAULT-ASSIGNMENT TO TRUE            06952103
069522             END-IF                                               06952203
069523         WHEN (PS-ASSIGNMENT-GROUP-FOUND)                         06952303
069524             MOVE PV-AI-ASSIGNMENT-GROUP TO                       06952403
069525                       PV-AI-FINAL-ASSIGNMENT-GROUP               06952503
069526         WHEN (PS-ASSIGNMENT-EXCP-FOUND)                          06952603
069527             MOVE CM005-ASSIGNMENT-GROUP TO                       06952703
069528                       PV-AI-FINAL-ASSIGNMENT-GROUP               06952803
069529         WHEN OTHER                                               06952903
069530             INITIALIZE PV-CURRENT-ERROR                          06953003
069531             IF (PS-ASSIGNMENT-CODE-FOUND)                        06953103
069532                 STRING 'ASSIGNMENT EXCEPTION '  DELIMITED BY SIZE06953203
069533                        'FOR CODE "'             DELIMITED BY SIZE06953303
069534                        PV-AI-ASSIGNMENT-GROUP   DELIMITED BY '  '06953403
069535                        '" DID NOT HAVE SUPPORT' DELIMITED BY SIZE06953503
069536                        ' FOR SUFFIX "'          DELIMITED BY SIZE06953603
069537                        PV-JOB-NAME-SUFFIX       DELIMITED BY SIZE06953703
069538                        '"'                      DELIMITED BY SIZE06953803
069539                     INTO PV-CURRENT-ERROR                        06953903
069540             ELSE                                                 06954003
069541                 STRING 'ASSIGNMENT GROUP OR '   DELIMITED BY SIZE06954103
069542                        'EXCEPTION IN '          DELIMITED BY SIZE06954203
069543                        PV-JOB-DOC-MEMBER-NAME   DELIMITED BY SIZE06954303
069544                        ' NOT FOUND: '           DELIMITED BY SIZE06954403
069545                        PV-AI-ASSIGNMENT-GROUP   DELIMITED BY '  '06954503
069546                     INTO PV-CURRENT-ERROR                        06954603
069547             END-IF                                               06954703
069548             DISPLAY PC-CURRENT-PROGRAM-NAME ' - '                06954803
069549                       PC-ERROR-DISPLAY-TAG                       06954903
069550                       PV-CURRENT-ERROR                           06955003
069551             SET PS-JOB-DOC-ERROR TO TRUE                         06955103
069552             PERFORM 8000-WRITE-WARNING-MESSAGE                   06955203
069553             SET PS-USE-DEFAULT-ASSIGNMENT TO TRUE                06955303
069554     END-EVALUATE.                                                06955403
069555                                                                  06955503
069556*                                                                 06955603
069557*  IF THE DEFAULT ASSIGNMENT IS TO BE USED, EITHER BECAUSE        06955703
069558*  OPERATIONS NEEDS TO ACT FIRST, OR BECAUSE SOME PART OF THE     06955803
069559*  NECESSARY ASSIGNMENT DETAILS WAS MISSING, THE CONTROL CARD WILL06955903
069560*  BE LEFT BLANK, SO THE NETCOOL DEFAULTS ARE APPLIED.            06956003
069561*                                                                 06956103
069562*  IF CHANGED TO BE DONE EXPLICITLY IN THIS PROCESS, THE IMPACT   06956203
069563*  AND URGENCY WOULD ALSO NEED TO BE EXPLICITLY SET TO THE        06956303
069564*  DEFAULTS, AND NOT JUST THE ASSIGNMENT GROUP, TO PREVENT        06956403
069565*  PAGING OPERATIONS.                                             06956503
069566*                                                                 06956603
069567                                                                  06956703
069568     INITIALIZE PV-ASSIGNMENT-CONTROL-CARD.                       06956803
069569     IF (PS-USE-DEFAULT-ASSIGNMENT)                               06956903
069570         DISPLAY PC-CURRENT-PROGRAM-NAME ' - '                    06957003
069571                   'DEFAULT ASSIGNMENT WILL BE USED'              06957103
069572     ELSE                                                         06957203
069573         STRING PV-AI-IMPACT                     DELIMITED BY SIZE06957303
069574                PC-COMMA-SEPARATOR               DELIMITED BY SIZE06957403
069575                PV-AI-URGENCY                    DELIMITED BY SIZE06957503
069576                PC-COMMA-SEPARATOR               DELIMITED BY SIZE06957603
069577                PV-AI-FINAL-ASSIGNMENT-GROUP     DELIMITED BY '  '06957703
069578             INTO PV-ASSIGNMENT-CONTROL-CARD                      06957803
069579         DISPLAY PC-CURRENT-PROGRAM-NAME ' - '                    06957903
069580                   'FINAL ASSIGNMENT CONTROL CARD: '              06958003
069581                   PV-ASSIGNMENT-CONTROL-CARD                     06958103
069582     END-IF.                                                      06958203
069583*5000-EXIT.                                                       06958310
069584                                                                  06958403
069585******************************************************************06958503
069586*  READ A JOB DOCUMENTATION LINE.                                *06958603
069587******************************************************************06958703
069588                                                                  06958803
069589 7000-READ-JOB-DOC-FILE.                                          06958903
069590     READ JOB-DOCUMENTATION-FILE                                  06959003
069591         INTO PV-JOB-DOCUMENTATION-LINE                           06959103
069600         AT END                                                   06960000
069700             SET PS-END-OF-JOB-DOC-FILE TO TRUE                   06970000
069800             SUBTRACT +1 FROM PT-JOB-DOC-LINES-READ               06980000
069900     END-READ.                                                    06990000
070000                                                                  07000000
070100     ADD +1 TO PT-JOB-DOC-LINES-READ.                             07010000
070200*7000-EXIT.                                                       07020000
070300                                                                  07030000
070400******************************************************************07040000
070500*  READ A SYSTEM ID DEFAULT ASSIGNMENT GROUP RECORD.             *07050000
070600******************************************************************07060000
070700                                                                  07070000
070800 7100-READ-SYSID-DFLT-FILE.                                       07080000
070900     READ SYSTEM-ID-DEFAULT-FILE                                  07090000
071000         INTO CM004-SYSID-DFLT-GROUP-RECORD                       07100000
071100         AT END                                                   07110000
071200             SET PS-END-OF-SYSID-DFLT-FILE TO TRUE                07120000
071300             SUBTRACT +1 FROM PT-SYSID-DFLT-RECORDS-READ          07130000
071400     END-READ.                                                    07140000
071500                                                                  07150000
071600     ADD +1 TO PT-SYSID-DFLT-RECORDS-READ.                        07160000
071700*7100-EXIT.                                                       07170000
071800                                                                  07180000
071900******************************************************************07190000
072000*  READ A VALID ASSIGNMENT GROUP RECORD.                         *07200000
072100******************************************************************07210000
072200                                                                  07220000
072300 7200-READ-ASSIGN-GRP-FILE.                                       07230000
072400     READ ASSIGNMENT-GROUP-FILE                                   07240000
072500         INTO PV-ASSIGNMENT-GROUP-RECORD                          07250000
072600         AT END                                                   07260000
072700             SET PS-END-OF-ASSIGN-GRP-FILE TO TRUE                07270000
072800             SUBTRACT +1 FROM PT-ASSIGN-GRP-RECORDS-READ          07280000
072900     END-READ.                                                    07290000
073000                                                                  07300000
073100     ADD +1 TO PT-ASSIGN-GRP-RECORDS-READ.                        07310000
073200*7200-EXIT.                                                       07320000
073300                                                                  07330000
073400******************************************************************07340000
073500*  READ A CALL LIST ASSIGNMENT EXCEPTIONS BY JOB SUFFIX RECORD.  *07350000
073600******************************************************************07360000
073700                                                                  07370000
073800 7300-READ-ASSIGN-EXCP-FILE.                                      07380000
073900     READ ASSIGNMENT-EXCP-FILE                                    07390000
074000         INTO CM005-ASSIGNMENT-EXCP-RECORD                        07400000
074100         AT END                                                   07410000
074200             SET PS-END-OF-ASSIGN-EXCP-FILE TO TRUE               07420000
074300             SUBTRACT +1 FROM PT-ASSIGN-EXCP-RECORDS-READ         07430000
074400     END-READ.                                                    07440000
074500                                                                  07450000
074600     ADD +1 TO PT-ASSIGN-EXCP-RECORDS-READ.                       07460000
074700*7300-EXIT.                                                       07470000
074710                                                                  07471005
074720******************************************************************07472005
074730*  READ A CALL LIST ASSIGNMENT OVERRIDE RECORD.                  *07473005
074740******************************************************************07474005
074750                                                                  07475005
074760 7400-READ-ASSIGN-OVERRIDE-FILE.                                  07476005
074770     READ ASSIGNMENT-OVERRIDE-FILE                                07477005
074780         INTO PV-ASSIGNMENT-OVERRIDE-RECORD                       07478005
074790         AT END                                                   07479005
074791             SET PS-END-OF-ASSIGN-OVER-FILE TO TRUE               07479105
074792             SUBTRACT +1 FROM PT-ASSIGN-OVER-RECORDS-READ         07479205
074793     END-READ.                                                    07479305
074794                                                                  07479405
074795     ADD +1 TO PT-ASSIGN-OVER-RECORDS-READ.                       07479505
074796*7400-EXIT.                                                       07479605
074800                                                                  07480000
074900******************************************************************07490000
075000*  WRITE AN ASSIGNMENT WARNING MESSAGE.                          *07500000
075100******************************************************************07510000
075200                                                                  07520000
075300 8000-WRITE-WARNING-MESSAGE.                                      07530000
075400     INITIALIZE AW-ASSIGNMENT-WARNING-RECORD.                     07540000
075500     STRING PV-CURRENT-TIMESTAMP-LABEL   DELIMITED BY SIZE        07550001
075600            PV-CURRENT-ERROR             DELIMITED BY SIZE        07560001
075700         INTO AW-ASSIGNMENT-WARNING-RECORD.                       07570000
075800                                                                  07580000
075900     WRITE AW-ASSIGNMENT-WARNING-RECORD.                          07590000
076000                                                                  07600000
076100     ADD +1 TO PT-ASSIGN-WARN-RCDS-WRITTEN.                       07610000
076200*8000-EXIT.                                                       07620000
076300                                                                  07630000
076400******************************************************************07640000
076500*  WRITE THE ASSIGNMENT DECISION CONTROL CARD.                   *07650000
076600******************************************************************07660000
076700                                                                  07670000
076800 8100-WRITE-ASSIGNMENT-CONTROL.                                   07680000
076900     WRITE AC-ASSIGNMENT-CONTROL-RECORD                           07690000
077000         FROM PV-ASSIGNMENT-CONTROL-CARD.                         07700000
077100                                                                  07710000
077200     ADD +1 TO PT-ASSIGN-CNTL-RCDS-WRITTEN.                       07720000
077300*8100-EXIT.                                                       07730000
077400                                                                  07740000
077500******************************************************************07750000
077600*  CLOSE ALL FILES.                                              *07760000
077700******************************************************************07770000
077800                                                                  07780000
077900 9000-EOJ-ROUTINE.                                                07790000
078000     CLOSE ASSIGNMENT-WARNING-FILE                                07800000
078100           ASSIGNMENT-CONTROL-FILE.                               07810000
078200*9000-EXIT.                                                       07820000
078300                                                                  07830000
078400******************************************************************07840000
078500*  ALLOCATE THE JOB DOCUMENTATION FILE.  THE ALLOCATION WILL     *07850000
078600*  ALSO SERVE AS THE VALIDATION OF THE JOB DOCUMENTATION LIBRARY *07860000
078700*  NAME SPECIFIED IN THE CONTROL CARD, AND A DATASET DOESN'T     *07870000
078710*  EXIST ERROR WILL BE PRESENTED AS A CONTROL CARD ERROR.  IF    *07871000
078720*  THE MEMBER DOESN'T EXIST, IT IS NOT AN ERROR CONDITION, SINCE *07872000
078730*  THE ASSOCIATED JOB DOCUMENTATION MAY BE UNDER A DIFFERENT     *07873000
078740*  MEMBER NAME.                                                  *07874000
078750******************************************************************07875000
078760                                                                  07876000
078770 9100-ALLOC-JOB-DOC-FILE.                                         07877000
078780     INITIALIZE DP023-DYNALC-PARMS.                               07878000
078790     MOVE PC-JOB-DOC-DDNAME TO DP023-DDNAME.                      07879000
078800     MOVE CC-JOB-DOCUMENTATION-DSN TO DP023-DSNAME.               07880000
078900     SET DP023-DISP-SHARE TO TRUE.                                07890000
079000     MOVE PV-JOB-NAME(1:PV-JOB-DOC-NAME-LENGTH) TO                07900000
079100               DP023-MEMBER-NAME.                                 07910000
079200     SET DP023-MEMDISP-READ TO TRUE.                              07920000
079300                                                                  07930000
079400     SET DP023-DISABLE-DISPLAY-ABEND TO TRUE.                     07940000
079500                                                                  07950000
079600     PERFORM DP023-0000-DYNALC.                                   07960000
079700     EVALUATE TRUE                                                07970000
079800         WHEN (DP023-LASTRC = ZERO)                               07980000
079900             SET PS-JOB-DOC-MEMBER-FOUND TO TRUE                  07990000
080000         WHEN (DP023-LASTRC = DP023-RC-DATASET-DOESNT-EXIST)      08000000
080100             INITIALIZE RETURN-CODE                               08010000
080200             SET PV-CE-INVALID-JOB-DOC-DSN TO TRUE                08020000
080300             DISPLAY PC-CURRENT-PROGRAM-NAME ' - '                08030000
080400                       PC-ERROR-DISPLAY-TAG                       08040000
080500                       PV-CURRENT-ERROR                           08050000
080600             SET PS-CONTROL-CARD-ERROR TO TRUE                    08060000
080700             PERFORM 8000-WRITE-WARNING-MESSAGE                   08070000
080800         WHEN (DP023-LASTRC = DP023-RC-MEMBER-DOESNT-EXIST)       08080000
080900             INITIALIZE RETURN-CODE                               08090000
081000         WHEN OTHER                                               08100000
081100             INITIALIZE RETURN-CODE                               08110000
081200             SET PV-CE-JOB-DOC-ALLOC-ERROR TO TRUE                08120000
081300             DISPLAY PC-CURRENT-PROGRAM-NAME ' - '                08130000
081400                       PC-ERROR-DISPLAY-TAG                       08140000
081500                       PV-CURRENT-ERROR                           08150000
081600             DISPLAY PC-CURRENT-PROGRAM-NAME ' - JOB NAME BEING ' 08160000
081700                       'CHECKED IS "' DP023-MEMBER-NAME '"'       08170000
081800             SET PS-JOB-DOC-ERROR TO TRUE                         08180000
081900             PERFORM 8000-WRITE-WARNING-MESSAGE                   08190000
082000             MOVE DP023-DDNAME TO PV-DR-DDNAME                    08200000
082100             MOVE DP023-RC (DP023-SUB) TO PV-DR-RETURN-CODE       08210000
082200             MOVE DP023-DESC (DP023-SUB) TO PV-DR-ERROR-DESC      08220000
082300             DISPLAY PC-CURRENT-PROGRAM-NAME ' - '                08230000
082400                       PV-DYNALC-ROUTINE-ERROR-MSG                08240000
082500     END-EVALUATE.                                                08250000
082600*9100-EXIT.                                                       08260000
082700                                                                  08270000
082800*                                                                 08280000
082900*  DYNAMIC ALLOCATION ROUTINE                                     08290000
083000*                                                                 08300000
083100     COPY DPPD023.                                                08310000
