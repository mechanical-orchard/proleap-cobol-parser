000100******************************************************************00010077
000200*  I M P O R T A N T --- WHEN COMPILING THIS PROGRAM THE MQ SERIES00020077
000300*  SWITCH ON THE 2ND COMPILE SCREEN NEEDS TO BE SET TO 'Y'.       00030077
000400*  THIS PROGRAM USES MQSERIES.                                    00040077
000500*                                                                 00050077
000600******************************************************************00060077
000700 IDENTIFICATION DIVISION.                                         00070077
000800 PROGRAM-ID.             RCKUP009.                                00080077
000900 AUTHOR.                 LARRY SCHLEICHER.                        00090077
001000 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00100077
001100 DATE-WRITTEN.           APRIL 2005.                              00110077
001200 DATE-COMPILED.                                                   00120077
001300                                                                  00130077
001400******************************************************************00140077
001500*      I T E M   M E S S A G E   Q U E U E   D O W N L O A D      00150077
001600*                                                                 00160077
001700* THIS PROGRAM WILL READ THE LOGISTICS ITEM HUB, RETRIEVE ANY     00170077
001800* MESSAGES AND PROCESS THEM TO UPDATE THE LOGISTICS ITEM DOMAIN   00180077
001900* TABLES.                                                         00190077
002000*                                                                 00200077
002100* !!!   I M P O R T A N T  !!!                                    00210077
002200* ----------------------------                                    00220077
002300* TRIGGERED TASK:                                                 00230077
002400* -------------                                                   00240077
002500* THIS PROGRAM RUNS AS A STARTED TASK.  THE TASK STARTS WHEN      00250077
002600* CICS IS BROUGHT UP IN THE MORNING.  IT WILL RUN CONTINUOUSLY    00260077
002700* UNTIL IT ENCOUNTERS THE "END RUN OF PROGRAM" MESSAGE THAT       00270077
002800* WILL BE SENT TO THE ITEM QUEUE FROM A SEPARATE PROGRAM USING    00280077
002900* AN MQPUT1 CALL.                                                 00290077
003000*                                                                 00300077
003100* ASSUMPTIONS ABOUT THE MESSAGES COMING FROM LOGISTICS ITEM HUB   00310077
003200* --------------------------------------------------------        00320077
003300* 1) THE MESSAGES WILL BE IN THE RCRD074 FORMAT.                  00330077
003400*                                                                 00340077
003500*    THE IM008_ITEM_KEY_DATA IS SUPPLIED ON ALL MESSAGES.         00350077
003600*                                                                 00360077
003700*                                                                 00370077
003800* 2) MQ MESSAGES WILL NOT EXCEED (450 BYTES) IN LENGTH.           00380077
003900*                                                                 00390077
004000* 3) ANY MESSAGES THAT ARE INCOMPLETE OR MISFORMED WILL BE        00400077
004100*    PUT TO AN ERROR QUEUE.                                       00410077
004200*                                                                 00420077
004300* 4) A BUSINESS EVENT-ID OF 999 WILL SHUT DOWN THE ITEM PROCESS.  00430077
004400                                                                  00440077
004500* GENERAL PROCESSING:                                             00450077
004600* -------------------                                             00460077
004700* 1) INITIALIZE VARIABLES, SET SWITCHES, OPEN ITEM QUEUE.         00470077
004800*                                                                 00480077
004900* 2) WHEN A MESSAGE APPEARS, IF AN ERROR IS FOUND, THE            00490077
005000*    ENTIRE MESSAGE WILL BE PUT TO THE ERROR QUEUE.               00500077
005100*                                                                 00510077
005200* 3) WHEN A MESSAGE HAS BEEN PROCESSED, THE ITEM WILL BE          00520077
005300*    LOADED TO THE RECEIVER AN PACKSLIP TABLES.                   00530077
005400*                                                                 00540077
005500* 4) EVERYTHING WILL GET INITIALIZED AND RESET - READY FOR THE    00550077
005600*    NEXT MESSAGE WHEN IT IS ENCOUNTERED.                         00560077
005700*                                                                 00570077
005800* ERROR PROCESSING:                                               00580077
005900* -----------------                                               00590077
006000* THIS PRGM IS CODED TO TRAP 23 TYPES OF ERRORS WHICH INCLUDE:    00600077
006100*                                                                 00610077
006200* 1) VALUE 1 - ROW NOT FOUND                                      00620077
006300* 2) VALUE 2 - STYLE ID NOT FOUND                                 00630077
006400* 3) VALUE 3 - DUP INSERT ON STYLE                                00640077
006500* 4) VALUE 4 - DUP INSERT ON SKU                                  00650077
006600* 5) VALUE 5 - SIZE DESC CODE MISMATCH                            00660077
006700* 6) VALUE 6 - DUP UPDATE STYLE                                   00670077
006800* 7) VALUE 7 - DUP INSERT ON UPC                                  00680077
006900* 8) VALUE 8 - UPC ROW NOT FOUND                                  00690077
007000* 9) VALUE 9 - DUP UPDATE UPC                                     00700077
007100* 10)VALUE 10- SKU ROW PROBLEM                                    00710077
007200* 11)VALUE 11- SKU INTR UPC ID NOT FOUND                          00720077
007300* 12)VALUE 12- PK INSERT NOT SUCCESS                              00730077
007400* 13)VALUE 13- PK DELETE NOT SUCCESS                              00740077
007500* 14)VALUE 14- PK UPDATE NOT SUCCESS                              00750077
007600* 15)VALUE 15- PK CPT INSERT NOT SUCCESS                          00760077
007700* 16)VALUE 16- PK CPT DELETE NOT SUCCESS                          00770077
007800* 17)VALUE 17- PK CPT UPDATE NOT SUCCESS                          00780077
007900* 18)VALUE 18- PK UPC INSERT NOT SUCCESS                          00790077
008000* 19)VALUE 19- PK UPC DELETE NOT SUCCESS                          00800077
008100* 20)VALUE 20- PK UPC UPDATE NOT SUCCESS                          00810077
008200* 21)VALUE 21- POPRPK INSERT NOT SUCCESS                          00820077
008300* 22)VALUE 22- POPRPK DELETE NOT SUCCESS                          00830077
008400* 23)VALUE 23- POPRPK UPDATE NOT SUCCESS                          00840077
008500*                                                                 00850077
008600* UNITS OF WORK AND COMMITS:                                      00860077
008700* --------------------------                                      00870077
008800* A UNIT OF WORK FOR A DB2 COMMIT WILL BE COMPLETE WHEN A         00880077
008900* MESSAGE FOR A ITEM HAS BEEN READ FROM THE QUEUE,                00890077
009000* AND INSERTED OR DELETED TO RECEIVER AND PACKSLIP TABLES.        00900077
009100* THE DB2 COMMIT IS PERFORMED.                                    00910077
009200* THEN AN MQ COMMIT WILL BE PERFORMED TO PERMANENTLY 'REMOVE' THE 00920077
009300* MESSAGES FROM THE ITEM QUEUE.                                   00930077
009400* MQ COMMITS ARE ALSO PERFORMED AFTER AN ERROR MESSAGE HAS BEEN   00940077
009500* WRITTEN TO THE ERROR QUEUE.                                     00950077
009600*                                                                 00960077
009700******************************************************************00970077
009800* 03/09/2010 DONALD TEGELER WR#38216                              00980077
009900*            EVERYWHERE THAT 873 IS HARDCODED FOR STORE NUMBER    00990076
010000*                                              USE RC074-STR-NBR  01000077
010100*                                                                 01010076
010200******************************************************************01020076
010300 ENVIRONMENT DIVISION.                                            01030076
010400******************************************************************01040076
010500 CONFIGURATION SECTION.                                           01050076
010600 SOURCE-COMPUTER.        IBM-3090.                                01060076
010700 OBJECT-COMPUTER.        IBM-3090.                                01070076
010800                                                                  01080076
010900 INPUT-OUTPUT SECTION.                                            01090076
011000 FILE-CONTROL.                                                    01100076
011100                                                                  01110076
011200     SELECT CONTROL-CARD                                          01120076
011300            ASSIGN TO UT-S-INP01.                                 01130076
011400                                                                  01140076
011500* ------------------------------------------------------------- * 01150076
011600*  CONTROL CARD 1 = QUEUE MANAGER NAME         QKST/QKSP          01160099
011700*  READ CONTROL CARD TO GET QUEUE MANAGER NAME                    01170076
011800* ------------------------------------------------------------- * 01180076
011900     SELECT CONTROL-CARD-1                                        01190076
012000         FILE STATUS IS CONTROL-CARD-1-STATUS                     01200076
012100            ASSIGN TO UT-S-INP02.                                 01210076
012200                                                                  01220076
012300* ------------------------------------------------------------- * 01230076
012400*  CONTROL CARD 2 = TRANSACTION QUEUE NAME     RC.DIRECT.SHIP.Q   01240099
012500*  READ CONTROL CARD TO GET TRANSACTION QUEUE NAME FOR ITEM       01250076
012600*  ORDER PUTS.                                                    01260076
012700* ------------------------------------------------------------- * 01270076
012800     SELECT CONTROL-CARD-2                                        01280076
012900         FILE STATUS IS CONTROL-CARD-2-STATUS                     01290076
013000            ASSIGN TO UT-S-INP03.                                 01300076
013100                                                                  01310076
013200* ------------------------------------------------------------- * 01320076
013300*  CONTROL CARD 3 = ITEM ERROR QUEUE          RC.DIRECT.SHIP.ERR  01330099
013400*  READ CONTROL CARD TO GET ERROR QUEUE NAME FOR PUTS             01340076
013500* ------------------------------------------------------------- * 01350076
013600     SELECT CONTROL-CARD-3                                        01360076
013700         FILE STATUS IS CONTROL-CARD-3-STATUS                     01370076
013800            ASSIGN TO UT-S-INP04.                                 01380076
013900                                                                  01390076
014000* ------------------------------------------------------------- * 01400076
014100     SELECT INPUT-FILE                                            01410076
014200            ASSIGN TO INP05.                                      01420076
014300                                                                  01430076
014400******************************************************************01440076
014500 DATA DIVISION.                                                   01450076
014600******************************************************************01460076
014700 FILE SECTION.                                                    01470076
014800                                                                  01480076
014900 FD  CONTROL-CARD                                                 01490076
015000     RECORDING MODE F                                             01500076
015100     BLOCK CONTAINS 0 RECORDS                                     01510076
015200     LABEL RECORDS ARE OMITTED.                                   01520076
015300 01  CONTROL-CARD-LINE                PIC  X(80).                 01530076
015400                                                                  01540076
015500 FD  CONTROL-CARD-1                                               01550076
015600     RECORDING MODE F                                             01560076
015700     BLOCK CONTAINS 0 RECORDS                                     01570076
015800     LABEL RECORDS ARE OMITTED.                                   01580076
015900 01  CONTROL-CARD-1-LINE              PIC  X(80).                 01590076
016000                                                                  01600076
016100 FD  CONTROL-CARD-2                                               01610076
016200     RECORDING MODE F                                             01620076
016300     BLOCK CONTAINS 0 RECORDS                                     01630076
016400     LABEL RECORDS ARE OMITTED.                                   01640076
016500 01  CONTROL-CARD-2-LINE              PIC  X(80).                 01650076
016600                                                                  01660076
016700 FD  CONTROL-CARD-3                                               01670076
016800     RECORDING MODE F                                             01680076
016900     BLOCK CONTAINS 0 RECORDS                                     01690076
017000     LABEL RECORDS ARE OMITTED.                                   01700076
017100 01  CONTROL-CARD-3-LINE              PIC  X(80).                 01710076
017200                                                                  01720076
017300 FD  INPUT-FILE                                                   01730076
017400     RECORDING MODE F                                             01740076
017500     BLOCK CONTAINS 0 RECORDS                                     01750076
017600     LABEL RECORDS ARE OMITTED.                                   01760076
017700 01  INPUT-RECORD                     PIC  X(100).                01770076
017800                                                                  01780076
017900******************************************************************01790076
018000 WORKING-STORAGE SECTION.                                         01800076
018100******************************************************************01810076
018200*  COMMUNICATIONS AREA FOR DB2                                    01820076
018300******************************************************************01830076
018400     EXEC SQL                                                     01840076
018500          INCLUDE SQLCA                                           01850076
018600     END-EXEC.                                                    01860076
018700                                                                  01870076
018800*----------------------------------------------------------------*01880076
018900*    DB2 DCLGEN FOR THE XLT_SKU TABLE                             01890076
019000*----------------------------------------------------------------*01900076
019100     EXEC SQL                                                     01910076
019200          INCLUDE XLT00003                                        01920076
019300     END-EXEC.                                                    01930076
019400                                                                  01940076
019500*----------------------------------------------------------------*01950076
019600*    DB2 DCLGEN FOR THE PURCHASE ITEM TABLE                       01960076
019700*----------------------------------------------------------------*01970076
019800     EXEC SQL                                                     01980076
019900          INCLUDE TPURITM                                         01990076
020000     END-EXEC.                                                    02000076
020100                                                                  02010076
020200*----------------------------------------------------------------*02020076
020300*    DB2 DCLGEN FOR THE RECEIVER NUMBER TABLE                     02030076
020400*----------------------------------------------------------------*02040076
020500     EXEC SQL                                                     02050076
020600          INCLUDE TRECVER                                         02060076
020700     END-EXEC.                                                    02070076
020800                                                                  02080076
020900******************************************************************02090076
021000*    DB2 DCLGEN FOR PURCHASE ORDER TABLE                          02100076
021100******************************************************************02110076
021200     EXEC SQL                                                     02120076
021300          INCLUDE TPURCHS                                         02130076
021400     END-EXEC.                                                    02140076
021500                                                                  02150076
021600*----------------------------------------------------------------*02160076
021700*    DB2 DCLGEN FOR PO AGREEMENT TABLE                            02170076
021800*----------------------------------------------------------------*02180076
021900     EXEC SQL                                                     02190076
022000          INCLUDE TPOAGMT                                         02200076
022100     END-EXEC.                                                    02210076
022200                                                                  02220076
022300*----------------------------------------------------------------*02230076
022400*    DB2 DCLGEN FOR PACK SLIP HEADER TABLE                        02240076
022500*----------------------------------------------------------------*02250076
022600     EXEC SQL                                                     02260076
022700          INCLUDE TPKSLIP                                         02270076
022800     END-EXEC.                                                    02280076
022900                                                                  02290076
023000*----------------------------------------------------------------*02300076
023100*    DB2 DCLGEN FOR PACK SLIP ITEM TABLE                          02310076
023200*----------------------------------------------------------------*02320076
023300     EXEC SQL                                                     02330076
023400          INCLUDE TPKITEM                                         02340076
023500     END-EXEC.                                                    02350076
023600                                                                  02360076
023700*---------------------------------------------------------------* 02370076
023800*    DB2 AREA FOR RECEIVER TABLE                                * 02380076
023900*---------------------------------------------------------------* 02390076
024000     EXEC SQL                                                     02400076
024100          INCLUDE TRECEIV                                         02410076
024200     END-EXEC.                                                    02420076
024300                                                                  02430076
024400******************************************************************02440076
024500*    DB2 DCLGEN FOR THE RECEIVER ITEM TABLE                       02450076
024600******************************************************************02460076
024700     EXEC SQL                                                     02470076
024800          INCLUDE TRECITM                                         02480076
024900     END-EXEC.                                                    02490076
025000                                                                  02500076
025100******************************************************************02510076
025200*    DB2 DCLGEN FOR THE RECEIPT DISTRIBUTION TABLE                02520076
025300******************************************************************02530076
025400     EXEC SQL                                                     02540076
025500          INCLUDE TRECDIS                                         02550076
025600     END-EXEC.                                                    02560076
025700                                                                  02570076
025800******************************************************************02580076
025900*    DB2 DCLGEN FOR THE PARAMETER TABLE                           02590076
026000******************************************************************02600076
026100     EXEC SQL                                                     02610076
026200          INCLUDE TKRPRPM                                         02620076
026300     END-EXEC.                                                    02630076
026400                                                                  02640076
026500******************************************************************02650076
026600*    DB2 DCLGEN WFT_LOD_CNTL                                      02660076
026700******************************************************************02670076
026800     EXEC SQL                                                     02680076
026900          INCLUDE WFT00001                                        02690076
027000     END-EXEC.                                                    02700076
027100                                                                  02710076
027200******************************************************************02720076
027300*    DB2 DCLGEN WFT_LOD_XFER                                      02730076
027400******************************************************************02740076
027500     EXEC SQL                                                     02750076
027600          INCLUDE WFT00002                                        02760076
027700     END-EXEC.                                                    02770076
027800*---------------------------------------------------------------* 02780076
027900*    DB2 AREA FOR XLT_MDSE_INV_PARM-INVENTORY PARAMENTERS TABLE * 02790076
028000*---------------------------------------------------------------* 02800076
028100     EXEC SQL                                                     02810076
028200          INCLUDE XLT00025                                        02820076
028300     END-EXEC.                                                    02830076
028310*---------------------------------------------------------------* 02831079
028320*    DB2 AREA FOR TALLPLN DC ALLOCATIONS                        * 02832079
028330*---------------------------------------------------------------* 02833079
028340     EXEC SQL                                                     02834079
028350          INCLUDE TALLPLN                                         02835079
028360     END-EXEC.                                                    02836079
028370*---------------------------------------------------------------* 02837079
028380*    DB2 AREA FOR TMESTDS STORE DISTIBUTIONS                    * 02838079
028390*---------------------------------------------------------------* 02839079
028391     EXEC SQL                                                     02839179
028392          INCLUDE TMESTDS                                         02839279
028393     END-EXEC.                                                    02839379
028400******************************************************************02840076
028500* INPUT LAYOUT - DIRECT SHIP QUEUE DATA                           02850076
028600******************************************************************02860076
028700     COPY RCRD074.                                                02870076
028800                                                                  02880076
028900******************************************************************02890076
029000*  WORK AREA FOR SQL ERROR ROUTINE 'DSNTIAR'.                     02900076
029100******************************************************************02910076
029200     COPY DPWS004.                                                02920076
029300                                                                  02930076
029400 01  ABEND-CODE                      PIC S9(04)    VALUE +0       02940076
029500                                                   COMP SYNC.     02950076
029600 01  PA-PROGRAM-ACCUMULATORS.                                     02960076
029700     05  PA-TOTALS.                                               02970076
029800         10 PA-END-OF-RUN-MESSAGES    PIC S9(06) VALUE +0 COMP-3. 02980076
029900         10 PA-TOTAL-TPKSLIP-INSERTS  PIC S9(09) VALUE +0 COMP-3. 02990076
030000         10 PA-TOTAL-TPKSLIP-UPDATES  PIC S9(09) VALUE +0 COMP-3. 03000076
030100         10 PA-TOTAL-TPKITEM-INSERTS  PIC S9(09) VALUE +0 COMP-3. 03010076
030200         10 PA-TOTAL-TRECEIV-INSERTS  PIC S9(09) VALUE +0 COMP-3. 03020076
030300         10 PA-TOTAL-TRECEIV-UPDATES  PIC S9(09) VALUE +0 COMP-3. 03030076
030400         10 PA-TOTAL-TRECITM-INSERTS  PIC S9(09) VALUE +0 COMP-3. 03040076
030500         10 PA-TOTAL-TRECDIS-INSERTS  PIC S9(09) VALUE +0 COMP-3. 03050076
030600         10 PA-TOTAL-WFT-CNTL-INSERTS PIC S9(09) VALUE +0 COMP-3. 03060076
030700         10 PA-TOTAL-WFT-XFER-INSERTS PIC S9(09) VALUE +0 COMP-3. 03070076
030800         10 PT-TOTAL-TPKSLIP-INSERTS  PIC S9(09) VALUE +0 COMP-3. 03080076
030900         10 PT-TOTAL-TPKSLIP-UPDATES  PIC S9(09) VALUE +0 COMP-3. 03090076
031000         10 PT-TOTAL-TPKITEM-INSERTS  PIC S9(09) VALUE +0 COMP-3. 03100076
031100         10 PT-TOTAL-TRECEIV-INSERTS  PIC S9(09) VALUE +0 COMP-3. 03110076
031200         10 PT-TOTAL-TRECEIV-UPDATES  PIC S9(09) VALUE +0 COMP-3. 03120076
031300         10 PT-TOTAL-TRECITM-INSERTS  PIC S9(09) VALUE +0 COMP-3. 03130076
031400         10 PT-TOTAL-TRECDIS-INSERTS  PIC S9(09) VALUE +0 COMP-3. 03140076
031500         10 PT-TOTAL-WFT-CNTL-INSERTS PIC S9(09) VALUE +0 COMP-3. 03150076
031600         10 PT-TOTAL-WFT-XFER-INSERTS PIC S9(09) VALUE +0 COMP-3. 03160076
031700         10 PA-TOTAL-GETS             PIC S9(09) VALUE +0 COMP-3. 03170076
031800         10 PA-TOTAL-ERRORQ-RECS      PIC S9(09) VALUE +0 COMP-3. 03180076
031900         10 PA-TOTAL-DB2-COMMITS      PIC S9(09) VALUE +0 COMP-3. 03190076
032000         10 PA-TOTAL-MQ-COMMITS       PIC S9(09) VALUE +0 COMP-3. 03200076
032100                                                                  03210076
032200 01  PS-PROGRAM-SWITCHES.                                         03220076
032300     05  PS-PREV-NOF-SW              PIC X(01) VALUE 'N'.         03230097
032400         88  PS-PREV-NOF                       VALUE 'Y'.         03240097
032500         88  PS-PREV-FOUND                     VALUE 'N'.         03250097
032501     05  PS-PO-PKSLIP-INSERTED-SW    PIC X(01) VALUE 'N'.         03250199
032502         88  PS-PO-PKSLIP-INSERTED             VALUE 'Y'.         03250299
032503         88  PS-PO-PKSLIP-NOT-INSERTED         VALUE 'N'.         03250399
032504     05  PS-PO-RECEIVER-CREATED-SW   PIC X(01) VALUE 'N'.         03250499
032505         88  PS-PO-RECEIVER-CREATED            VALUE 'Y'.         03250599
032506         88  PS-PO-RECEIVER-NOT-CREATED        VALUE 'N'.         03250699
032507                                                                  03250797
032510     05  PS-SAME-PO-SW               PIC X(01) VALUE 'N'.         03251097
032520         88  PS-SAME-PO-YES                    VALUE 'Y'.         03252097
032530         88  PS-SAME-PO-NO                     VALUE 'N'.         03253097
032600     05  PS-DC-FLUSH-SW              PIC X(01) VALUE 'N'.         03260076
032700         88  PS-DC-FLUSH-YES                   VALUE 'Y'.         03270076
032800         88  PS-DC-FLUSH-NO                    VALUE 'N'.         03280076
032900     05  PS-END-OF-INPUT-FILE-SW     PIC X(01) VALUE 'N'.         03290076
033000         88  PS-END-OF-INPUT                   VALUE 'Y'.         03300076
033100         88  PS-NOT-END-OF-INPUT               VALUE 'N'.         03310076
033200     05  PS-TRECVER-CURSOR-SW          PIC  X(01)  VALUE 'N'.     03320076
033300         88  PS-EOF-TRECVER-CSR               VALUE 'Y'.          03330076
033400     05  PS-PKSLIP-INSERTED-SW         PIC  X(01)  VALUE 'N'.     03340076
033500         88  PS-PKSLIP-NOT-INSERTED           VALUE 'N'.          03350076
033600         88  PS-PKSLIP-INSERTED               VALUE 'Y'.          03360076
033700     05  PS-CONTROL-CARD-END-SW        PIC  X(01)    VALUE 'N'.   03370076
033800         88  PS-CONTROL-CARD-END-YES                 VALUE 'Y'.   03380076
033900         88  PS-CONTROL-CARD-END-NO                  VALUE 'N'.   03390076
034000     05  PS-INPUT-SW                   PIC  X(01)    VALUE 'N'.   03400076
034100         88  PS-INPUT-FROM-FILE                      VALUE 'F'.   03410076
034200         88  PS-INPUT-FROM-MQ                        VALUE 'M'.   03420076
034300     05  PS-CONTROL-CARD-1-END-SW      PIC  X(01)    VALUE 'N'.   03430076
034400         88  PS-CONTROL-CARD-1-END-YES               VALUE 'Y'.   03440076
034500         88  PS-CONTROL-CARD-1-END-NO                VALUE 'N'.   03450076
034600     05  PS-CONTROL-CARD-2-END-SW      PIC  X(01)    VALUE 'N'.   03460076
034700         88  PS-CONTROL-CARD-2-END-YES               VALUE 'Y'.   03470076
034800         88  PS-CONTROL-CARD-2-END-NO                VALUE 'N'.   03480076
034900     05  PS-CONTROL-CARD-3-END-SW      PIC  X(01)    VALUE 'N'.   03490076
035000         88  PS-CONTROL-CARD-3-END-YES               VALUE 'Y'.   03500076
035100         88  PS-CONTROL-CARD-3-END-NO                VALUE 'N'.   03510076
035200     05  PS-ERROR-SW                   PIC  X(01)    VALUE 'N'.   03520076
035300         88  PS-ERROR-YES                            VALUE 'Y'.   03530076
035400         88  PS-ERROR-NO                             VALUE 'N'.   03540076
035500     05  PS-ERROR-QUEUE-IS-OPEN-SW     PIC  X(01)    VALUE 'N'.   03550076
035600         88  PS-ERROR-QUEUE-IS-OPEN-YES              VALUE 'Y'.   03560076
035700         88  PS-ERROR-QUEUE-IS-OPEN-NO               VALUE 'N'.   03570076
035800***************************************************************** 03580076
035900* FILE OPEN STATUS'S ON THE CONTROL CARDS USED FOR GETTING        03590076
036000* MQ-SERIES QUEUE MANAGER AND QUEUE NAME.                         03600076
036100***************************************************************** 03610076
036200 01  CONTROL-CARD-1-STATUS            PIC X(02)   VALUE '00'.     03620076
036300     88  CONTROL-CARD-1-SUCCESS                   VALUE '00'.     03630076
036400     88  CONTROL-CARD-1-ERROR                     VALUE '42'.     03640076
036500 01  CONTROL-CARD-2-STATUS            PIC X(02)   VALUE '00'.     03650076
036600     88  CONTROL-CARD-2-SUCCESS                   VALUE '00'.     03660076
036700     88  CONTROL-CARD-2-ERROR                     VALUE '42'.     03670076
036800 01  CONTROL-CARD-3-STATUS            PIC X(02)   VALUE '00'.     03680076
036900     88  CONTROL-CARD-3-SUCCESS                   VALUE '00'.     03690076
037000     88  CONTROL-CARD-3-ERROR                     VALUE '42'.     03700076
037100                                                                  03710076
037200 01  PC-PROGRAM-CONSTANTS.                                        03720076
037300     05  PC-CURRENT-PROGRAM-NAME    PIC X(08)  VALUE 'RCKUP009'.  03730076
037400     05  PC-E-COMM-DIRECT-SHIP      PIC X(08)  VALUE 'ECOMDS'.    03740076
037500     05  PC-ITEM                    PIC X(04)  VALUE 'ITEM'.      03750076
037600     05  PC-MQC                     PIC X(03)  VALUE 'MQC'.       03760076
037700     05  PC-HDR                     PIC X(03)  VALUE 'HDR'.       03770076
037800     05  PC-DTL                     PIC X(03)  VALUE 'DTL'.       03780076
037900     05  PC-GFT                     PIC X(03)  VALUE 'GFT'.       03790076
038000     05  PC-END                     PIC X(03)  VALUE 'END'.       03800076
038100     05  PC-MQPUT-RETRY-COUNTER     PIC 9(3)   VALUE ZERO.        03810076
038200     05  PC-N                       PIC X(01)  VALUE 'N'.         03820076
038300     05  PC-READY                   PIC X(06)  VALUE 'READY '.    03830076
038400     05  PC-CMPLTD                  PIC X(06)  VALUE 'CMPLTD'.    03840076
038500     05  PC-DEFAULT-TMST            PIC X(26)  VALUE              03850076
038600                                    '0001-01-01-00.00.00.000000'. 03860076
038700     05  PC-END-RUN-MSG             PIC X(18)  VALUE              03870076
038800                                            'END RUN OF PROGRAM'. 03880076
038900                                                                  03890076
039000 01  DK-DB2-KEYS.                                                 03900076
039100     05  DK-PO-NBR                    PIC S9(09) COMP VALUE +0.   03910076
039200     05  DK-AGRMT-TYP-ID              PIC X(01)  VALUE SPACES.    03920076
039300     05  DK-TYP-CDE                   PIC S9(04) COMP VALUE +0.   03930076
039400     05  DK-SKU-NBR                   PIC S9(8)V VALUE ZEROS      03940076
039500                                               COMP-3.            03950076
039501     05  DK-SKU                       PIC S9(8)V VALUE ZEROS      03950181
039502                                               COMP-3.            03950281
039510     05  DK-DEST-NBR                  PIC  S9(4) COMP VALUE +0.   03951081
039600                                                                  03960076
039700 01  PV-PROGRAM-VARIABLES.                                        03970076
039710     05  PV-PO                      PIC  S9(9) COMP VALUE ZEROS.  03971097
039720     05  PV-PREV-PO                 PIC  S9(9) COMP VALUE ZEROS.  03972097
039730                                                                  03973097
039800     05  PV-SEQ-NBR-IND             PIC S9(04) VALUE +0           03980076
039900                                                  COMP.           03990076
040000     05  PV-NEXT-SEQ-NBR            PIC S9(04) VALUE +0           04000076
040100                                                 COMP.            04010076
040200     05  PV-SAVE-PKSLIP-SEQ-NBR     PIC S9(04) VALUE +0           04020076
040300                                                 COMP.            04030076
040400     05  PV-MAX-SEQ-NBR             PIC S9(04) VALUE +0           04040076
040500                                                 COMP.            04050076
040600     05  PV-COUNT                   PIC S9(04) VALUE +0           04060076
040700                                                 COMP.            04070076
040800     05  PV-DB2-COUNT               PIC S9(09)  VALUE +0          04080076
040900                                                 COMP-3.          04090076
041000     05  PV-WORK-DATE-PLUS-7        PIC  X(10)  VALUE ZEROS.      04100076
041100     05  PV-DISP-PO                 PIC 9(09).                    04110076
041200     05  PV-DISP-REC-SEQ            PIC 9(09).                    04120076
041300     05  PV-DISP-LINE-NBR           PIC 9(09).                    04130076
041400     05  PV-DISP-TYP-CDE            PIC 9(04).                    04140076
041500     05  PV-DISP-STR-NBR            PIC 9(09).                    04150076
041600     05  PV-DISP-SKU                PIC 9(09).                    04160076
041700     05  PV-DISP-SQLCODE            PIC -9(09).                   04170076
041800     05  PV-DISP-SEQ                PIC 9(09).                    04180076
041900     05  PW-CONTROL-REC.                                          04190076
042000         10  PW-CONTROL-KEYREC.                                   04200076
042100             20  PW-CONTROL-PANL-NBR.                             04210076
042200                 30  PW-CONTROL-PANEL    PIC 9(05)  VALUE ZERO.   04220076
042300                 30  PW-CONTROL-KEYREC-NBR                        04230076
042400                                         PIC 9(02)  VALUE ZERO.   04240076
042500             20  PW-CONTROL-PANL-NBR-9 REDEFINES                  04250076
042600                                       PW-CONTROL-PANL-NBR        04260076
042700                                         PIC 9(7).                04270076
042800             20  PW-CONTROL-CEHCK-DIG    PIC 9(01)  VALUE ZERO.   04280076
042900         10  PW-CONTROL-KEYREC-9 REDEFINES PW-CONTROL-KEYREC      04290076
043000                                         PIC 9(08).               04300076
043100         10  PW-CONTROL-FILLER           PIC X(73)  VALUE SPACE.  04310076
043200                                                                  04320076
043300     05  PW-QUOTIENT                     PIC S9(7)  VALUE ZERO.   04330076
043400     05  PW-REMAINDER                    PIC S9     VALUE ZERO.   04340076
043500     05  PV-PARAGRAPH               PIC X(48)  VALUE SPACES.      04350076
043600     05  PV-REC-SEQ-NBR             PIC S9(09) VALUE +0 COMP.     04360076
043700     05  PV-MSG-LENGTH              PIC S9(9)  BINARY.            04370076
043800     05  PV-DATA-LENGTH             PIC S9(9) BINARY.             04380076
043900     05  PV-HOLD-COMPLETION-CODE    PIC S9(9)  BINARY.            04390076
044000     05  PV-HOLD-REASON             PIC S9(9)  BINARY.            04400076
044100     05  PV-HOLD-CORRELID           PIC  X(24) VALUE SPACES.      04410076
044101                                                                  04410180
044102     05  PV-UNIT-QTY-ORDERED        PIC S9(09)  COMP.             04410280
044103     05  PV-UNIT-QTY-RECEIVED       PIC S9(09)  COMP.             04410380
044200                                                                  04420076
044300     05  PV-RECEIPT-ADJUSTMENT-REC.                               04430076
044400         10  PV-HEADER-DATA.                                      04440076
044500             15  PV-ORDER-NUMBER               PIC 9(09).         04450076
044600             15  PV-RCVR-ID                    PIC 9(09).         04460076
044700             15  PV-DC                         PIC 9(04).         04470076
044800             15  PV-SKU                        PIC 9(08).         04480076
044900             15  PV-VRFY-DATE                  PIC X(14).         04490076
045000             15  PV-STORE-COUNT                PIC 9(04).         04500076
045100             15  FILLER                        PIC X(52).         04510076
045200         10  PV-STORE-DATA OCCURS 1 TO 100 TIMES                  04520076
045300                              DEPENDING ON PV-STORE-COUNT         04530076
045400                              INDEXED BY PV-IDX.                  04540076
045500             15  PV-STORE                      PIC 9(04).         04550076
045600             15  PV-STORE-QTY                  PIC 9(09).         04560076
045700             15  PV-STORE-QTY-SIGN             PIC X(01).         04570076
045800                                                                  04580076
045900 01  PV-DB2-TMST                      PIC X(26).                  04590076
046000 01  FILLER  REDEFINES  PV-DB2-TMST.                              04600076
046100         10  PV-DB2-TMST-CCYY         PIC X(04).                  04610076
046200         10  FILLER                   PIC X(01).                  04620076
046300         10  PV-DB2-TMST-MO           PIC X(02).                  04630076
046400         10  FILLER                   PIC X(01).                  04640076
046500         10  PV-DB2-TMST-DA           PIC X(02).                  04650076
046600         10  FILLER                   PIC X(01).                  04660076
046700         10  PV-DB2-TMST-HH           PIC X(02).                  04670076
046800         10  FILLER                   PIC X(01).                  04680076
046900         10  PV-DB2-TMST-MM           PIC X(02).                  04690076
047000         10  FILLER                   PIC X(01).                  04700076
047100         10  PV-DB2-TMST-SS           PIC X(02).                  04710076
047200             88  PV-DB2-TMST-SS-01               VALUE '01'.      04720076
047300         10  FILLER                   PIC X(01).                  04730076
047400         10  PV-DB2-TMST-MS           PIC X(06).                  04740076
047500             88  PV-DB2-TMST-MS-ZERO             VALUE '000000'.  04750076
047600*PV-MSG IS WHAT GETS BROKEN DOWN INTO DTLS/GFTS/END               04760076
047700 01  PV-MSG.                                                      04770076
047800     05  PV-MSG-END                 PIC X(18).                    04780076
047900         88 PV-END-RUN-MSG          VALUE 'END RUN OF PROGRAM'.   04790076
048000     05  FILLER                     PIC X(432).                   04800076
048100                                                                  04810076
048200 01  PV-DTL.                                                      04820076
048300     05  PV-DTL-EVENT               PIC 9(03)   VALUE ZERO.       04830076
048400     05  FILLER                     PIC X(447)  VALUE SPACE.      04840076
048500                                                                  04850076
048600 01  PV-HOLD-FIELDS.                                              04860076
048700     05  PV-HOLD-HDR                PIC X(568)  VALUE SPACE.      04870076
048800     05  PV-HOLD-ITEM.                                            04880076
048900         10  PV-HOLD-DTL            PIC X(245)  VALUE SPACE.      04890076
049000         10  PV-HOLD-GFT            PIC X(303)  VALUE SPACE.      04900076
049100                                                                  04910076
049200 01  PV-ABEND-VARIABLES.                                          04920076
049300     05  PV-ABEND-CODE              PIC S9(04) VALUE +0 COMP SYNC.04930076
049400     88  ABEND-4001-WRITE-ERROR                      VALUE +4001. 04940076
049500     88  ABEND-4002-READ-ERROR                       VALUE +4002. 04950076
049600     88  ABEND-4003-CTRL-CARD-ERROR                  VALUE +4003. 04960076
049700     88  ABEND-4004-TABLE-ERROR                      VALUE +4004. 04970076
049800     88  ABEND-4005-OPEN-ERROR                       VALUE +4005. 04980076
049900     88  ABEND-4006-CLOSE-ERROR                      VALUE +4006. 04990076
050000     88  ABEND-4007-SEQUENCE-ERROR                   VALUE +4007. 05000076
050100     88  ABEND-4008-DATA-ERROR                       VALUE +4008. 05010076
050200     88  ABEND-4009-KEY-DATA-ERROR                   VALUE +4009. 05020076
050300     88  ABEND-4013-DB2-ERROR                        VALUE +4013. 05030076
050400     88  ABEND-4019-CAL-SUB-ERROR                    VALUE +4019. 05040076
050500     88  ABEND-4020-MQ-ERROR                         VALUE +4020. 05050076
050600     88  ABEND-4444-FORCED-ABEND                     VALUE +4444. 05060076
050700                                                                  05070076
050800 01  PE-MQ-ABEND-VARIABLES.                                       05080076
050900     10  PE-MQ-QMANAGER             PIC X(05) VALUE SPACES.       05090076
051000     10  PE-MQ-QNAME                PIC X(30) VALUE SPACES.       05100076
051100     10  PE-MQ-COMPLETION-CODE      PIC 9(04) VALUE ZEROS.        05110076
051200     10  PE-MQ-REASON-CODE          PIC 9(04) VALUE ZEROS.        05120076
051300                                                                  05130076
051400 01  CC-CONTROL-CARD.                                             05140076
051500     05  CC-INPUT-CONTROL             PIC X(04).                  05150076
051600     05  FILLER                       PIC X(76).                  05160076
051700                                                                  05170076
051800****************************************************************  05180076
051900**     M Q   S E R I E S    W O R K I N G   S T O R A G E     *   05190076
052000**                                                                05200076
052100**                  M  Q    C O P Y B O O K S                     05210076
052200*                                                                 05220076
052300*                                                                 05230076
052400*                                                                 05240076
052500****************************************************************  05250076
052600 01  MQM-OBJECT-DESCRIPTOR.                                       05260076
052700     COPY CMQODV.                                                 05270076
052800                                                                  05280076
052900 01  MQM-MESSAGE-DESCRIPTOR.                                      05290076
053000     COPY CMQMDV.                                                 05300076
053100                                                                  05310076
053200 01  MQM-GET-MESSAGE-OPTIONS.                                     05320076
053300     COPY CMQGMOV.                                                05330076
053400                                                                  05340076
053500 01  MQM-PUT-MESSAGE-OPTIONS.                                     05350076
053600     COPY CMQPMOV.                                                05360076
053700                                                                  05370076
053800 01  MQM-CONSTANTS.                                               05380076
053900     COPY CMQV.                                                   05390076
054000                                                                  05400076
054100****************************************************************  05410076
054200** CONTROL CARDS FOR QUEUE MANAGER AND QUEUE NAMES                05420076
054300*                                                                 05430076
054400*                                                                 05440076
054500*                                                                 05450076
054600****************************************************************  05460076
054700* ------------------------------------------------------------- * 05470076
054800*  CONTROL CARD 1 = QUEUE MANAGER NAME                            05480076
054900*  READ CONTROL CARD TO GET QUEUE MANAGER NAME                    05490076
055000* ------------------------------------------------------------- * 05500076
055100 01  CC-CONTROL-CARD-1.                                           05510076
055200     05  CC-QMGR-NAME                 PIC X(48).                  05520076
055300     05  FILLER                       PIC X(32).                  05530076
055400                                                                  05540076
055500* ------------------------------------------------------------- * 05550076
055600*  CONTROL CARD 2 = TRANSACTION QUEUE NAME                        05560076
055700*  READ CONTROL CARD TO GET THE TRANSACTION QUEUE NAME            05570076
055800* ------------------------------------------------------------- * 05580076
055900 01  CC-CONTROL-CARD-2.                                           05590076
056000     05  CC-ITEM-QUEUE-NAME           PIC X(48).                  05600076
056100     05  FILLER                       PIC X(32).                  05610076
056200                                                                  05620076
056300* ------------------------------------------------------------- * 05630076
056400*  CONTROL CARD 3 = ITEM ERROR NAME                               05640076
056500*  READ CONTROL CARD TO GET THE TRANSACTION QUEUE NAME            05650076
056600* ------------------------------------------------------------- * 05660076
056700 01  CC-CONTROL-CARD-3.                                           05670076
056800     05  CC-ERROR-QUEUE-NAME          PIC X(48).                  05680076
056900     05  FILLER                       PIC X(32).                  05690076
057000                                                                  05700076
057100****************************************************************  05710076
057200** MQ SERIES CONSTANTS FOR CALLING MODULES SUCH AS PUT AND    **  05720076
057300*  OPEN, CONNECT, DISCONNECT.                                     05730076
057400*                                                                 05740076
057500*                                                                 05750076
057600****************************************************************  05760076
057700 01  MQ-WORKING-STORAGE.                                          05770076
057800     05  PC-MQCONN                PIC X(08)   VALUE 'CSQBCONN'.   05780076
057900     05  PC-MQOPEN                PIC X(08)   VALUE 'CSQBOPEN'.   05790076
058000     05  PC-MQINQ                 PIC X(08)   VALUE 'CSQBINQ'.    05800076
058100     05  PC-MQPUT                 PIC X(8)    VALUE 'CSQBPUT'.    05810076
058200     05  PC-MQGET                 PIC X(08)   VALUE 'CSQBGET'.    05820076
058300     05  PC-MQCMIT                PIC X(8)    VALUE 'CSQBCOMM'.   05830076
058400     05  PC-MQBACK                PIC X(8)    VALUE 'CSQBBACK'.   05840076
058500     05  PC-MQCLOSE               PIC X(08)   VALUE 'CSQBCLOS'.   05850076
058600     05  PC-MQDISC                PIC X(08)   VALUE 'CSQBDISC'.   05860076
058700     05  PC-QMGR-NAME                 PIC X(4)  VALUE SPACES.     05870076
058800         88  PC-PROD-QMGR-NAME                  VALUE 'QKSP'.     05880076
058900         88  PC-ACCEPT-QMGR-NAME                VALUE 'QKSQ'.     05890076
059000         88  PC-TEST-QMGR-NAME                  VALUE 'QKST'.     05900076
059100     05  PC-RESPONSE-QNAME            PIC X(30) VALUE SPACES.     05910076
059200     05  PC-WAIT-15-SECS              PIC S9(9) VALUE 15000.      05920076
059300     05  PC-WAIT-6-SECS               PIC S9(9) VALUE 6000.       05930076
059400     05  PC-DELAY-INTERVAL.                                       05940076
059500         10  FILLER                   PIC X(2)  VALUE SPACES.     05950076
059600         10  PC-DELAY-TIME            PIC 9(8)  VALUE 1500.       05960076
059700                                                                  05970076
059800****************************************************************  05980076
059900** QUEUE MANAGER HANDLE                                           05990076
060000*  QUEUE HANDLES                                                  06000076
060100*                                                                 06010076
060200*                                                                 06020076
060300****************************************************************  06030076
060400 01 PV-MQ-PROGRAM-HANDLES.                                        06040076
060500     05  PV-QMGR-NAME                 PIC X(48).                  06050076
060600     05  PV-HCONN                     PIC S9(9) BINARY VALUE 0.   06060076
060700     05  PV-GQ-HANDLE                 PIC S9(9) BINARY VALUE 0.   06070076
060800     05  PV-PQ-HANDLE                 PIC S9(9) BINARY VALUE 0.   06080076
060900                                                                  06090076
061000****************************************************************  06100076
061100**                                                                06110076
061200*                                                                 06120076
061300* ERROR PROCESSING VARIABLES                                      06130076
061400* CODES FROM CALLS ARE STORED HERE                                06140076
061500****************************************************************  06150076
061600 01 PV-MQ-PROGRAM-VARIABLES.                                      06160076
061700     05  PV-COMPLETION-CODE           PIC S9(9) BINARY.           06170076
061800     05  PV-REASON                    PIC S9(9) BINARY.           06180076
061900     05  PV-CON-REASON                PIC S9(9) BINARY.           06190076
062000     05  PV-ERROR-MESSAGE             PIC X(48) VALUE SPACES.     06200076
062100     05  PV-OPEN-OPTIONS              PIC S9(9) BINARY.           06210076
062200     05  PV-MSGBUFFER                 PIC X(450) VALUE SPACES.    06220076
062300     05  PV-ERRMSGBUF                 PIC X(500) VALUE SPACES.    06230076
062400     05  PV-MQCHECK                   PIC X(8)  VALUE 'MQR2C'.    06240076
062500     05  PV-MQ-REASON-TEXT            PIC X(30) VALUE SPACES.     06250076
062600                                                                  06260076
062700****************************************************************  06270076
062800**                     E N D   O F   M Q                          06280076
062900*                                                                 06290076
063000*                                                                 06300076
063100****************************************************************  06310076
063200****************************************************************  06320076
063300 PROCEDURE DIVISION.                                              06330076
063400******************************************************************06340076
063500 0000-PROGRAM-MAINLINE.                                           06350076
063600     DISPLAY '************ START OF RCKUP009 ***************'     06360076
063700                                                                  06370076
063800*INIT VARIBLES, SET SWITHCES.                                     06380076
063900     PERFORM 1000-INITIALIZE.                                     06390076
064000                                                                  06400076
064100*READ CONTROL CARDS(FOR INPUT SOURCE).                            06410076
064200     PERFORM 1100-READ-CC-CARD.                                   06420076
064300                                                                  06430076
064400*READ CONTROL CARDS(FOR QUEUE MANAGER/QUEUE NAMES).               06440076
064500     PERFORM 1200-READ-MQ-CC-CARDS.                               06450076
064600                                                                  06460076
064700*CONNECT TO QUEUE MANAGER.                                        06470076
064800     PERFORM 3100-MQ-CONNECT-TO-QMGR.                             06480076
064900                                                                  06490076
065000     SET PS-NOT-END-OF-INPUT TO TRUE.                             06500076
065100     IF PS-INPUT-FROM-MQ                                          06510076
065200*OPEN THE QUEUE FOR GETS.                                         06520076
065300         PERFORM 3200-MQ-QUEUE-OPEN                               06530076
065400                                                                  06540076
065500*GET FIRST MSG FROM QUEUE.                                        06550076
065600         PERFORM 3300-MQ-GET-MSG                                  06560076
065700                                                                  06570076
065800     ELSE                                                         06580076
065900*OPEN INPUT FILE                                                  06590076
066000         OPEN INPUT INPUT-FILE                                    06600076
066100         PERFORM 4000-READ-RECORD                                 06610076
066200     END-IF.                                                      06620076
066300     SET PS-SAME-PO-NO  TO TRUE.                                  06630076
066400*PROCESS THE ITEM MESSAGES.                                       06640076
066500     PERFORM 2000-PROCESS-MSGS                                    06650076
066600         UNTIL PS-END-OF-INPUT.                                   06660076
066700                                                                  06670076
066800     PERFORM 5000-END-RUN-ROUTINE.                                06680076
066900                                                                  06690076
067000     GOBACK.                                                      06700076
067100                                                                  06710076
067200******************************************************************06720076
067300* INITIALIZE VARIABLES.                                           06730076
067400* SET SWITCHES.                                                   06740076
067500******************************************************************06750076
067600 1000-INITIALIZE.                                                 06760076
067700                                                                  06770076
067800     INITIALIZE   PA-TOTAL-TRECEIV-INSERTS                        06780076
067900                  PA-TOTAL-TRECEIV-UPDATES                        06790076
068000                  PA-TOTAL-TPKITEM-INSERTS                        06800076
068100                  PA-TOTAL-TRECITM-INSERTS                        06810076
068200                  PA-TOTAL-TRECDIS-INSERTS                        06820076
068300                  PA-TOTAL-WFT-CNTL-INSERTS                       06830076
068400                  PA-TOTAL-WFT-XFER-INSERTS                       06840076
068500                  PA-TOTAL-TPKSLIP-INSERTS                        06850076
068600                  PA-TOTAL-TPKSLIP-UPDATES                        06860076
068700                  PA-TOTAL-GETS                                   06870076
068800                  PA-TOTAL-DB2-COMMITS                            06880076
068900                  PA-TOTAL-MQ-COMMITS                             06890076
069000                  PV-HOLD-FIELDS                                  06900076
069100                  PV-MSG-LENGTH.                                  06910076
069200                                                                  06920076
069300*INIT SWITCHES USED FOR EDITING EACH MSG, CONTINUING RUN OF       06930076
069400*PROGRAM AND OPENING OF THE ERROR QUEUE. ERROR QUEUE IS           06940076
069500*ONLY OPENED IF ERROR IS ENCOUNTERED, AND THEN REMAINS OPEN.      06950076
069600     SET PS-ERROR-QUEUE-IS-OPEN-NO  TO TRUE.                      06960076
069700                                                                  06970076
069800 1100-READ-CC-CARD.                                               06980076
069900                                                                  06990076
070000      OPEN INPUT CONTROL-CARD.                                    07000076
070100                                                                  07010076
070200      READ CONTROL-CARD INTO CC-CONTROL-CARD                      07020076
070300        AT END                                                    07030076
070400           SET PS-CONTROL-CARD-END-YES TO TRUE                    07040076
070500      END-READ.                                                   07050076
070600      IF PS-CONTROL-CARD-END-YES THEN                             07060076
070700          DISPLAY PC-CURRENT-PROGRAM-NAME                         07070076
070800              'CONTROL CARD MISSING'                              07080076
070900          MOVE 'MISSING CONTROL CARD'                             07090076
071000                TO PV-ERROR-MESSAGE                               07100076
071100          PERFORM 9200-MQ-ABEND                                   07110076
071200      ELSE                                                        07120076
071300          IF CC-INPUT-CONTROL = 'FILE'                            07130076
071400             SET PS-INPUT-FROM-FILE TO TRUE                       07140076
071500              DISPLAY PC-CURRENT-PROGRAM-NAME                     07150076
071600                  ' - CONTROL CARD : '                            07160076
071700                  CC-CONTROL-CARD                                 07170076
071800          ELSE                                                    07180076
071900              IF CC-INPUT-CONTROL = 'MQ'                          07190076
072000                  SET PS-INPUT-FROM-MQ TO TRUE                    07200076
072100                  DISPLAY PC-CURRENT-PROGRAM-NAME                 07210076
072200                      ' - CONTROL CARD : '                        07220076
072300                      CC-CONTROL-CARD                             07230076
072400              ELSE                                                07240076
072500                  DISPLAY PC-CURRENT-PROGRAM-NAME                 07250076
072600                     'INVALID CONTROL CARD'                       07260076
072700                  MOVE 'INVALID CONTROL CARD'                     07270076
072800                      TO PV-ERROR-MESSAGE                         07280076
072900                  PERFORM 9200-MQ-ABEND                           07290076
073000              END-IF                                              07300076
073100          END-IF                                                  07310076
073200      END-IF.                                                     07320076
073300      CLOSE CONTROL-CARD.                                         07330076
073400                                                                  07340076
073500****************************************************************  07350076
073600* READ CONTROL CARDS FOR QMGR NAME AND QUEUE NQME.                07360076
073700* EACH CONTROL CARD MUST CONTAIN A NAME THAT IS NOT SPACES.       07370076
073800****************************************************************  07380076
073900 1200-READ-MQ-CC-CARDS.                                           07390076
074000                                                                  07400076
074100*OPEN CC CARD 1 TO OBTAIN QUEUE MANAGER NAME                      07410076
074200      OPEN INPUT CONTROL-CARD-1.                                  07420076
074300      IF CONTROL-CARD-1-ERROR THEN                                07430076
074400         PERFORM 9200-MQ-ABEND                                    07440076
074500      END-IF.                                                     07450076
074600      READ CONTROL-CARD-1 INTO CC-CONTROL-CARD-1                  07460076
074700        AT END                                                    07470076
074800           SET PS-CONTROL-CARD-1-END-YES TO TRUE                  07480076
074900      END-READ.                                                   07490076
075000      IF PS-CONTROL-CARD-1-END-YES THEN                           07500076
075100          DISPLAY PC-CURRENT-PROGRAM-NAME                         07510076
075200              'CONTROL CARD MISSING - FOR QMGR NAME'              07520076
075300          MOVE 'QMGR NAME IS MISSING IN CARD?'                    07530076
075400                TO PV-ERROR-MESSAGE                               07540076
075500          PERFORM 9200-MQ-ABEND                                   07550076
075600      ELSE                                                        07560076
075700          IF CC-QMGR-NAME EQUAL SPACES THEN                       07570076
075800             DISPLAY PC-CURRENT-PROGRAM-NAME                      07580076
075900               'CONTROL CARD MISSING - FOR QMGR NAME'             07590076
076000             MOVE 'QMGR NAME IS SPACES!'                          07600076
076100                  TO PV-ERROR-MESSAGE                             07610076
076200             PERFORM 9200-MQ-ABEND                                07620076
076300          ELSE                                                    07630076
076400             DISPLAY PC-CURRENT-PROGRAM-NAME                      07640076
076500                  ' - CONTROL CARD 1 : '                          07650076
076600                  CC-CONTROL-CARD-1                               07660076
076700          END-IF                                                  07670076
076800      END-IF.                                                     07680076
076900      CLOSE CONTROL-CARD-1.                                       07690076
077000                                                                  07700076
077100*OPEN CC CARD 2 TO OBTAIN QUEUE NAME FOR GETS AND PUTS            07710076
077200      OPEN INPUT CONTROL-CARD-2.                                  07720076
077300      IF CONTROL-CARD-2-ERROR THEN                                07730076
077400         PERFORM 9200-MQ-ABEND                                    07740076
077500      END-IF.                                                     07750076
077600      READ CONTROL-CARD-2 INTO CC-CONTROL-CARD-2                  07760076
077700        AT END                                                    07770076
077800           SET PS-CONTROL-CARD-2-END-YES TO TRUE                  07780076
077900      END-READ.                                                   07790076
078000      IF PS-CONTROL-CARD-2-END-YES THEN                           07800076
078100          DISPLAY PC-CURRENT-PROGRAM-NAME                         07810076
078200              'CONTROL CARD MISSING - FOR QUEUE NAME'             07820076
078300          MOVE 'QUEUE NAME IS MISSING IN CARD?'                   07830076
078400                TO PV-ERROR-MESSAGE                               07840076
078500          PERFORM 9200-MQ-ABEND                                   07850076
078600      ELSE                                                        07860076
078700          IF CC-ITEM-QUEUE-NAME EQUAL SPACES THEN                 07870076
078800             DISPLAY PC-CURRENT-PROGRAM-NAME                      07880076
078900               'CONTROL CARD MISSING - FOR QUEUE NAME'            07890076
079000             MOVE 'QUEUE NAME IS SPACES!'                         07900076
079100                  TO PV-ERROR-MESSAGE                             07910076
079200             PERFORM 9200-MQ-ABEND                                07920076
079300          ELSE                                                    07930076
079400             DISPLAY PC-CURRENT-PROGRAM-NAME                      07940076
079500                  ' - CONTROL CARD 2 : '                          07950076
079600                  CC-CONTROL-CARD-2                               07960076
079700          END-IF                                                  07970076
079800      END-IF.                                                     07980076
079900      CLOSE CONTROL-CARD-2.                                       07990076
080000                                                                  08000076
080100*OPEN CC CARD 3 TO OBTAIN ERROR QUEUE NAME FOR PUTS               08010076
080200      OPEN INPUT CONTROL-CARD-3.                                  08020076
080300      IF CONTROL-CARD-3-ERROR THEN                                08030076
080400         PERFORM 9200-MQ-ABEND                                    08040076
080500      END-IF.                                                     08050076
080600      READ CONTROL-CARD-3 INTO CC-CONTROL-CARD-3                  08060076
080700        AT END                                                    08070076
080800           SET PS-CONTROL-CARD-3-END-YES TO TRUE                  08080076
080900      END-READ.                                                   08090076
081000      IF PS-CONTROL-CARD-3-END-YES THEN                           08100076
081100          DISPLAY PC-CURRENT-PROGRAM-NAME                         08110076
081200              'CONTROL CARD MISSING - FOR ERROR QUEUE NAME'       08120076
081300          MOVE 'QUEUE NAME IS MISSING IN CARD?'                   08130076
081400                TO PV-ERROR-MESSAGE                               08140076
081500          PERFORM 9200-MQ-ABEND                                   08150076
081600      ELSE                                                        08160076
081700          IF CC-ERROR-QUEUE-NAME EQUAL SPACES THEN                08170076
081800             DISPLAY PC-CURRENT-PROGRAM-NAME                      08180076
081900               'CONTROL CARD MISSING - FOR ERROR QUEUE NAME'      08190076
082000             MOVE 'QUEUE NAME IS SPACES!'                         08200076
082100                  TO PV-ERROR-MESSAGE                             08210076
082200             PERFORM 9200-MQ-ABEND                                08220076
082300          ELSE                                                    08230076
082400             DISPLAY PC-CURRENT-PROGRAM-NAME                      08240076
082500                  ' - CONTROL CARD 3 : '                          08250076
082600                  CC-CONTROL-CARD-3                               08260076
082700          END-IF                                                  08270076
082800      END-IF.                                                     08280076
082900      CLOSE CONTROL-CARD-3.                                       08290076
083000                                                                  08300076
083100****************************************************************  08310076
083200* INIT SOME FIELDS BEFORE THE NEXT ITEM IS PROCESSED.             08320076
083300* RESET SOME SWITCHES.                                            08330076
083400****************************************************************  08340076
083500 1300-REINITIALIZE.                                               08350076
083600                                                                  08360076
083700     INITIALIZE PV-MSG                                            08370076
083800                PV-MSGBUFFER                                      08380076
083900                PV-ERRMSGBUF.                                     08390076
084000     SET PS-ERROR-NO  TO TRUE.                                    08400076
084100                                                                  08410076
084200******************************************************************08420076
084300* BREAKDOWN AND EDIT A MSG.                                       08430076
084400* EDIT DB2 TABLES -OR- PUT A MSG IN ERROR TO ERROR QUEUE.         08440076
084500* GET THE NEXT MSG.                                               08450076
084600******************************************************************08460076
084700 2000-PROCESS-MSGS.                                               08470076
084800                                                                  08480076
084900     MOVE 0    TO PT-TOTAL-TPKSLIP-INSERTS                        08490076
085000                  PT-TOTAL-TPKSLIP-UPDATES                        08500076
085100                  PT-TOTAL-TPKITEM-INSERTS                        08510076
085200                  PT-TOTAL-TRECEIV-INSERTS                        08520076
085300                  PT-TOTAL-TRECEIV-UPDATES                        08530076
085400                  PT-TOTAL-TRECITM-INSERTS                        08540076
085500                  PT-TOTAL-TRECDIS-INSERTS                        08550076
085600                  PT-TOTAL-WFT-CNTL-INSERTS                       08560076
085700                  PT-TOTAL-WFT-XFER-INSERTS.                      08570076
085800                                                                  08580076
085900     MOVE RC074-PO-NUMBER   TO DK-PO-NBR.                         08590076
085910     MOVE RC074-SKU         TO DK-SKU.                            08591081
085920     MOVE RC074-STR-NBR     TO DK-DEST-NBR.                       08592081
086000                                                                  08600076
086010*** DMH - 8/22/11 BEGIN                                           08601078
086011     IF  RC074-ALLOW-RCV-MORE-YES                                 08601178
086012         CONTINUE                                                 08601278
086013     ELSE                                                         08601378
086014         IF  RC074-PO-NUMBER  > 0  AND                            08601492
086015             NOT RC074-PO-NUMBER  = HIGH-VALUES                   08601593
086016             MOVE  ZEROES  TO  PV-UNIT-QTY-ORDERED                08601691
086017                               PV-UNIT-QTY-RECEIVED               08601791
086018             PERFORM 2280-GET-QTY-ORDERED                         08601891
086019             IF PS-ERROR-NO                                       08601999
086020                 PERFORM 2295-GET-QTY-RECEIVED                    08602099
086021             END-IF                                               08602194
086022                                                                  08602278
086023             IF  PV-UNIT-QTY-RECEIVED >= PV-UNIT-QTY-ORDERED AND  08602394
086024                 PS-ERROR-NO                                      08602494
086025                 SET  PS-ERROR-YES                                08602590
086026                       RC074-RCV-MORE-THAN-ORDERED                08602690
086027                       RC074-ALLOW-RCV-MORE-NO  TO  TRUE          08602790
086028             END-IF                                               08602890
086029         END-IF                                                   08602990
086030     END-IF.                                                      08603090
086031*** DMH - 8/22/11 END                                             08603190
086040                                                                  08604078
086100     MOVE RC074-STR-NBR      TO RECDIS-STR-NBR.                   08610076
086200     IF PS-SAME-PO-NO                                             08620076
086300         SET PS-DC-FLUSH-NO      TO TRUE                          08630076
086400         PERFORM 2250-CHECK-DC-FLUSH-PARM                         08640076
086500     END-IF.                                                      08650076
086510     IF PS-ERROR-NO                                               08651081
086600         IF  PS-DC-FLUSH-YES                                      08660081
086700             PERFORM 2275-CHECK-INV-IN-PROCESS                    08670081
086800         END-IF                                                   08680081
086810     END-IF.                                                      08681081
086900                                                                  08690076
087000     IF PS-ERROR-NO                                               08700076
087100         IF PS-SAME-PO-NO                                         08710076
087200             PERFORM 2100-ADD-PACK-SLIP-HEADER                    08720099
087300         ELSE                                                     08730076
087301*                                                                 08730199
087302*** DMH 10/16/13 BEGIN                                            08730299
087310             IF  PS-PO-PKSLIP-NOT-INSERTED                        08731099
087311                 PERFORM 2100-ADD-PACK-SLIP-HEADER                08731199
087320             ELSE                                                 08732099
087340*** DMH 10/16/13 END                                              08734099
087350*                                                                 08735099
087400                 PERFORM 2160-UPDATE-PACK-SLIP-HEADER             08740099
087500             END-IF                                               08750099
087510         END-IF                                                   08751099
087600     END-IF.                                                      08760076
087700                                                                  08770076
087800     IF PS-ERROR-NO                                               08780076
087900         PERFORM 2200-ADD-TPKITEM                                 08790076
088000     END-IF.                                                      08800076
088100                                                                  08810076
088200     IF PS-ERROR-NO                                               08820076
088300         IF PS-SAME-PO-NO                                         08830076
088400             PERFORM 2300-BUILD-RECEIVER-INFO                     08840076
088500         ELSE                                                     08850076
088510*                                                                 08851099
088520*** DMH - 10-16-13 BEGIN                                          08852099
088530             IF  PS-PO-RECEIVER-NOT-CREATED                       08853099
088540                 PERFORM 2300-BUILD-RECEIVER-INFO                 08854099
088550             ELSE                                                 08855099
088570*** DMH - 10-16-13 END                                            08857099
088580*                                                                 08858099
088600                 PERFORM 2350-UPDATE-RECEIVER-INFO                08860099
088610             END-IF                                               08861099
088700     END-IF.                                                      08870076
088800                                                                  08880076
088900     IF PS-ERROR-NO                                               08890076
089000         PERFORM 2400-ADD-RECITM                                  08900076
089100     END-IF.                                                      08910076
089200                                                                  08920076
089300     IF PS-ERROR-NO                                               08930076
089400         PERFORM 2500-PREPARE-TRECDIS                             08940076
089500     END-IF.                                                      08950076
089600                                                                  08960076
089700     IF PS-ERROR-NO                                               08970076
089800         PERFORM 2600-INSERT-WFT-LOD-CNTL                         08980076
089900     END-IF.                                                      08990076
090000                                                                  09000076
090100     IF PS-ERROR-NO                                               09010076
090200         PERFORM 2700-INSERT-WFT-LOD-XFER                         09020076
090300     END-IF.                                                      09030076
090400                                                                  09040076
090500*IF NO ERRORS, JUST CONTINUE,                                     09050076
090600*ELSE REINIT AND RESET SWITCHES AND GO AFTER THE NEXT MSG         09060076
090700*(NEW ITEM) ON THE QUEUE.                                         09070076
090800     IF PS-ERROR-YES                                              09080076
090900        PERFORM 7100-ERROR-ROUTINE                                09090076
091000        PERFORM 3800-PUT-MSG-TO-ERROR-Q                           09100099
091100        PERFORM 3600-MQ-COMMIT                                    09110099
091120                                                                  09112099
091200     END-IF.                                                      09120076
091300                                                                  09130076
091400*THIS MOVES THE LEGACY ITEM MAINT RECORD TO A BACKUP              09140076
091500                                                                  09150076
091600     IF PS-ERROR-NO                                               09160076
091700         PERFORM 6000-DB2-COMMIT                                  09170076
091800     ELSE                                                         09180076
091900         PERFORM 6100-DB2-ROLLBACK                                09190076
092000     END-IF.                                                      09200076
092100                                                                  09210076
092200     PERFORM 1300-REINITIALIZE.                                   09220076
092300                                                                  09230076
092400     IF PS-INPUT-FROM-MQ                                          09240076
092500         PERFORM 3600-MQ-COMMIT                                   09250076
092600     END-IF.                                                      09260076
092700                                                                  09270076
092800                                                                  09280076
092900*GET NEXT MESSAGE FROM QUEUE.                                     09290076
093000     IF PS-INPUT-FROM-MQ                                          09300076
093100         PERFORM 3300-MQ-GET-MSG                                  09310076
093200     ELSE                                                         09320076
093300         PERFORM 4000-READ-RECORD                                 09330076
093400     END-IF.                                                      09340076
093410                                                                  09341077
093420*** DMH 8/22/11 BEGIN                                             09342077
093421                                                                  09342190
093422     IF  RC074-ALLOW-RCV-MORE-YES                                 09342277
093423         CONTINUE                                                 09342377
093424     ELSE                                                         09342477
093425         SET  RC074-ALLOW-RCV-MORE-NO  TO  TRUE                   09342577
093426     END-IF.                                                      09342677
093427                                                                  09342777
093440*** DMH 8/22/11 END                                               09344077
093450                                                                  09345090
093500     IF RC074-PO-NUMBER = DK-PO-NBR                               09350090
093600         SET PS-SAME-PO-YES TO TRUE                               09360090
093700     ELSE                                                         09370090
093800         SET PS-SAME-PO-NO TO TRUE                                09380090
093801*                                                                 09380199
093802*** DMH 10/16/13 BEGIN                                            09380299
093810         SET PS-PO-PKSLIP-NOT-INSERTED TO TRUE                    09381099
093820         SET PS-PO-RECEIVER-NOT-CREATED TO TRUE                   09382099
093830*** DMH 10/16/13 END                                              09383099
093840*                                                                 09384099
093900     END-IF.                                                      09390090
094000                                                                  09400076
094100******************************************************************09410076
094200* INSERT, UPDATE OR DELETE TABLES.                                09420076
094300* DB2 COMMIT.                                                     09430076
094400* MQ COMMIT.                                                      09440076
094500******************************************************************09450076
094600 2100-ADD-PACK-SLIP-HEADER.                                       09460076
094700                                                                  09470076
094800     INITIALIZE DCLTPKSLIP.                                       09480076
094900     MOVE RC074-PO-NUMBER          TO PKSLIP-PO-NBR.              09490076
095000     MOVE RC074-STR-NBR            TO PKSLIP-OPER-UNT-ID.         09500076
095100     MOVE 1                        TO PKSLIP-FCLTY-ID.            09510076
095200     MOVE RC074-PO-NUMBER          TO PKSLIP-PKSL-NBR.            09520076
095300     MOVE RC074-STR-NBR            TO PKSLIP-STR-DEST-NBR.        09530076
095400     MOVE ZERO                     TO PKSLIP-PKSL-PG-CNT.         09540076
095500                                                                  09550076
095600     MOVE RC074-QTY-RCVD           TO PKSLIP-EXPTED-PKG-QTY.      09560076
095700                                                                  09570076
095800     MOVE SPACES                   TO PKSLIP-OWNER-SCAC-ID.       09580076
095900     MOVE SPACES                   TO PKSLIP-ASN-NBR.             09590076
096000     MOVE SPACES                   TO PKSLIP-CONTNR-ID.           09600076
096100     MOVE ZERO                     TO PKSLIP-SHIPT-ID.            09610076
096200     MOVE SPACES                   TO PKSLIP-BOL-NBR.             09620076
096300     MOVE SPACES                   TO PKSLIP-PRO-NBR.             09630076
096400     MOVE SPACES                   TO PKSLIP-CRE-SRC-CDE.         09640076
096500     MOVE 'AC'                     TO PKSLIP-PKSL-STAT-CDE.       09650076
096600                                                                  09660076
096700     PERFORM 2110-GET-PO-VER-NBR.                                 09670076
096800     IF PS-ERROR-NO                                               09680076
096900         MOVE PURCHS-VER-NBR           TO PKSLIP-PO-VER-NBR       09690076
097000                                                                  09700076
097100         PERFORM 2120-GET-NEXT-SEQ-NBR                            09710076
097200     END-IF.                                                      09720076
097300                                                                  09730076
097400     IF PS-ERROR-NO                                               09740076
097500         MOVE PV-NEXT-SEQ-NBR          TO PKSLIP-SEQ-NBR          09750076
097600                                                                  09760076
097700         SET PS-PKSLIP-NOT-INSERTED    TO TRUE                    09770076
097800                                                                  09780076
097900         PERFORM 2130-GET-MAX-SEQ-NBR                             09790076
098000     END-IF.                                                      09800076
098100                                                                  09810076
098200     IF PS-ERROR-NO                                               09820076
098300         MOVE PV-REC-SEQ-NBR           TO PKSLIP-REC-SEQ-NBR      09830076
098400                                                                  09840076
098500         EXEC SQL                                                 09850076
098600              SET :PV-DB2-TMST         =  CURRENT_TIMESTAMP       09860076
098700         END-EXEC                                                 09870076
098800                                                                  09880076
098900         SET PV-DB2-TMST-SS-01                                    09890076
099000             PV-DB2-TMST-MS-ZERO   TO  TRUE                       09900076
099100         PERFORM 2140-INSERT-LOOP                                 09910076
099200             UNTIL PS-PKSLIP-INSERTED                             09920076
099300                OR PS-ERROR-YES                                   09930076
099400     END-IF.                                                      09940076
099500                                                                  09950076
099600 2110-GET-PO-VER-NBR.                                             09960076
099700                                                                  09970076
099800     EXEC SQL                                                     09980076
099900          SELECT VER_NBR                                          09990076
100000            INTO :PURCHS-VER-NBR                                  10000076
100100            FROM TPURCHS                                          10010076
100200           WHERE PO_NBR         = :DK-PO-NBR                      10020076
100300             AND VER_STATUS_CDE = 'A'                             10030076
100400     END-EXEC.                                                    10040076
100500                                                                  10050076
100600     EVALUATE TRUE                                                10060076
100700         WHEN SQLCODE = +0                                        10070076
100800              CONTINUE                                            10080076
100900         WHEN SQLCODE = +100                                      10090076
101000             MOVE DK-PO-NBR   TO PV-DISP-PO                       10100076
101100             MOVE SQLCODE     TO PV-DISP-SQLCODE                  10110076
101200             MOVE '2110-GET-PO-VER-NBR'                           10120076
101300                              TO RC074-ERROR-PARA-NAME            10130076
101400             SET RC074-PO-NOF                                     10140076
101500                 PS-ERROR-YES    TO TRUE                          10150076
101600             DISPLAY '******************************************' 10160076
101700             DISPLAY '*ABEND                                   *' 10170076
101800             DISPLAY '*PROGRAM   = RCKUP009                    *' 10180076
101900             DISPLAY '*DB2 OPER  = SELECT ON TPURCHS           *' 10190076
102000             DISPLAY '*PARAGRAPH = 2110-GET-PO-VER-NBR         *' 10200076
102100             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                10210076
102200             DISPLAY '*PO = ' PV-DISP-PO                          10220076
102300             DISPLAY '******************************************' 10230076
102400                                                                  10240076
102500         WHEN SQLWARN0 NOT = SPACES                               10250076
102600         WHEN SQLCODE < +0                                        10260076
102700         WHEN SQLCODE > +0                                        10270076
102800             MOVE DK-PO-NBR   TO PV-DISP-PO                       10280076
102900             MOVE SQLCODE     TO PV-DISP-SQLCODE                  10290076
103000             MOVE '2110-GET-PO-VER-NBR'                           10300076
103100                              TO RC074-ERROR-PARA-NAME            10310076
103200             SET RC074-DB-ERROR                                   10320076
103300                 PS-ERROR-YES    TO TRUE                          10330076
103400             DISPLAY '******************************************' 10340076
103500             DISPLAY '*ABEND                                   *' 10350076
103600             DISPLAY '*PROGRAM   = RCKUP009                    *' 10360076
103700             DISPLAY '*DB2 OPER  = SELECT ON TPURCHS           *' 10370076
103800             DISPLAY '*PARAGRAPH = 2110-GET-PO-VER-NBR         *' 10380076
103900             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                10390076
104000             DISPLAY '*PO = ' PV-DISP-PO                          10400076
104100             DISPLAY '******************************************' 10410076
104200     END-EVALUATE.                                                10420076
104300                                                                  10430076
104400 2120-GET-NEXT-SEQ-NBR.                                           10440076
104500                                                                  10450076
104600     MOVE ZEROS                    TO PV-MAX-SEQ-NBR.             10460076
104700                                                                  10470076
104800     EXEC SQL                                                     10480076
104900          SELECT MAX(SEQ_NBR)                                     10490076
105000            INTO :PV-MAX-SEQ-NBR :PV-SEQ-NBR-IND                  10500076
105100            FROM TPKSLIP                                          10510076
105200           WHERE PO_NBR = :DK-PO-NBR                              10520076
105300     END-EXEC.                                                    10530076
105400                                                                  10540076
105500     EVALUATE TRUE                                                10550076
105600         WHEN SQLCODE = +0                                        10560076
105700              COMPUTE PV-NEXT-SEQ-NBR =                           10570076
105800                      PV-MAX-SEQ-NBR + 1                          10580076
105900                                                                  10590076
106000         WHEN SQLCODE = +100                                      10600076
106100              MOVE +1          TO PV-NEXT-SEQ-NBR                 10610076
106200                                                                  10620076
106300         WHEN SQLWARN0 NOT = SPACES                               10630076
106400         WHEN SQLCODE < +0                                        10640076
106500         WHEN SQLCODE > +0                                        10650076
106600             MOVE DK-PO-NBR   TO PV-DISP-PO                       10660076
106700             MOVE SQLCODE     TO PV-DISP-SQLCODE                  10670076
106800             MOVE '2120-GET-NEXT-SEQ-NBR'                         10680076
106900                              TO RC074-ERROR-PARA-NAME            10690076
107000             SET RC074-DB-ERROR                                   10700076
107100                 PS-ERROR-YES    TO TRUE                          10710076
107200             DISPLAY '******************************************' 10720076
107300             DISPLAY '*ABEND                                   *' 10730076
107400             DISPLAY '*PROGRAM   = RCKUP009                    *' 10740076
107500             DISPLAY '*DB2 OPER  = SELECT ON TPKSLIP           *' 10750076
107600             DISPLAY '*PARAGRAPH = 2120-GET-NEXT-SEQ-NBR       *' 10760076
107700             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                10770076
107800             DISPLAY '*PO = ' PV-DISP-PO                          10780076
107900             DISPLAY '******************************************' 10790076
108000     END-EVALUATE.                                                10800076
108100                                                                  10810076
108200*----------------------------------------------------------------*10820076
108300* GET THE NEXT HIGHEST RECEIVER SEQ NBR                          *10830076
108400*----------------------------------------------------------------*10840076
108500 2130-GET-MAX-SEQ-NBR.                                            10850076
108600                                                                  10860076
108700     EXEC SQL                                                     10870076
108800         SELECT MAX(REC_SEQ_NBR)                                  10880076
108900         INTO  :RECEIV-REC-SEQ-NBR                                10890076
109000         FROM   TRECEIV                                           10900076
109100         WHERE  ORD_NBR = :DK-PO-NBR                              10910076
109200     END-EXEC.                                                    10920076
109300                                                                  10930076
109400     EVALUATE TRUE                                                10940076
109500         WHEN SQLCODE = +0                                        10950076
109600             MOVE RECEIV-REC-SEQ-NBR                              10960076
109700                             TO PV-REC-SEQ-NBR                    10970076
109800             ADD +1          TO PV-REC-SEQ-NBR                    10980076
109900         WHEN SQLCODE = +100                                      10990076
110000         WHEN SQLCODE = -305                                      11000076
110100             MOVE +1         TO PV-REC-SEQ-NBR                    11010076
110200                                                                  11020076
110300         WHEN SQLWARN0 NOT = SPACE                                11030076
110400         WHEN SQLCODE < +0                                        11040076
110500         WHEN SQLCODE > +0                                        11050076
110600             MOVE SQLCODE TO PV-DISP-SQLCODE                      11060076
110700             MOVE DK-PO-NBR   TO PV-DISP-PO                       11070076
110800             MOVE '2130-GET-MAX-SEQ-NBR'                          11080076
110900                              TO RC074-ERROR-PARA-NAME            11090076
111000             SET RC074-DB-ERROR                                   11100076
111100                 PS-ERROR-YES    TO TRUE                          11110076
111200             DISPLAY '******************************************' 11120076
111300             DISPLAY '*ABEND                                   *' 11130076
111400             DISPLAY '*PROGRAM   = RCKUP009                    *' 11140076
111500             DISPLAY '*DB2 OPER  = SELECT ON TRECEIV           *' 11150076
111600             DISPLAY '*PARAGRAPH = 2130-GET-MAX-SEQ-NBR        *' 11160076
111700             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                11170076
111800             DISPLAY '*PO = ' PV-DISP-PO                          11180076
111900             DISPLAY '******************************************' 11190076
112000     END-EVALUATE.                                                11200076
112100                                                                  11210076
112200*----------------------------------------------------------------*11220076
112300*    THIS ROUTINE ADDED TO PRECLUDE LOGICAL DUPLICATES FROM      *11230076
112400*    BEING INSERTED.  WHEN 2 USERS ARE ADDING PACK SLIPS TO      *11240076
112500*    THE SAME PO, IT IS POSSIBLE TO OBTAIN THE SAME SEQUENCE     *11250076
112600*    NUMBER (LOGICAL DUPLICATE).  BECAUSE THE TIMSTAMP IS PART   *11260076
112700*    OF THE PHYSICAL KEY, NO -803 OCCURS.  IN 5001, WE FORCE     *11270076
112800*    A 01 IN THE SECONDS FIELD AND ALL ZEROES IN THE MICRO-      *11280076
112900*    SECONDS FIELD.  THIS WILL CAUSE A -803 WHICH IS HANDLED     *11290076
113000*    HERE BY ADDING 1 TO THE SEQUENCE NUMBER.                    *11300076
113100*----------------------------------------------------------------*11310076
113200                                                                  11320076
113300 2140-INSERT-LOOP.                                                11330076
113400                                                                  11340076
113500     MOVE PKSLIP-SEQ-NBR  TO PV-SAVE-PKSLIP-SEQ-NBR.              11350076
113600                                                                  11360076
113700     PERFORM 2150-INSERT-TPKSLIP.                                 11370076
113800                                                                  11380076
113900     EVALUATE TRUE                                                11390076
114000         WHEN SQLCODE EQUAL ZERO                                  11400076
114100              SET PS-PKSLIP-INSERTED                              11410076
114200                                   TO TRUE                        11420076
114300                                                                  11430076
114400         WHEN SQLCODE EQUAL -803                                  11440076
114500              ADD 1                TO PKSLIP-SEQ-NBR              11450076
114600                                                                  11460076
114700     END-EVALUATE.                                                11470076
114800                                                                  11480076
114900                                                                  11490076
115000 2150-INSERT-TPKSLIP.                                             11500076
115100                                                                  11510076
115200     EXEC SQL                                                     11520076
115300          INSERT INTO TPKSLIP                                     11530076
115400                 (PO_NBR                                          11540076
115500               ,  SEQ_NBR                                         11550076
115600               ,  CRE_TMST                                        11560076
115700               ,  VER_STAT_CDE                                    11570076
115800               ,  OPER_UNT_ID                                     11580076
115900               ,  FCLTY_ID                                        11590076
116000               ,  PKSL_NBR                                        11600076
116100               ,  STR_DEST_NBR                                    11610076
116200               ,  REC_SEQ_NBR                                     11620076
116300               ,  SHIPT_ID                                        11630076
116400               ,  BOL_NBR                                         11640076
116500               ,  PRO_NBR                                         11650076
116600               ,  PKSL_STAT_CDE                                   11660076
116700               ,  CRE_UID                                         11670076
116800               ,  PO_VER_NBR                                      11680076
116900               ,  CRE_SRC_CDE                                     11690076
117000               ,  EXPTED_PKG_QTY                                  11700076
117100               ,  OWNER_SCAC_ID                                   11710076
117200               ,  ASN_NBR                                         11720076
117300               ,  VEND_SHIP_DTE                                   11730076
117400               ,  PKSL_PG_CNT                                     11740076
117500               ,  CONTNR_ID                                       11750076
117600               ,  ORIG_PKSL_SEQ_NBR)                              11760076
117700          VALUES (:PKSLIP-PO-NBR                                  11770076
117800               ,  :PKSLIP-SEQ-NBR                                 11780076
117900               ,  :PV-DB2-TMST                                    11790076
118000               ,  'A'                                             11800076
118100               ,  :PKSLIP-OPER-UNT-ID                             11810076
118200               ,  :PKSLIP-FCLTY-ID                                11820076
118300               ,  :PKSLIP-PKSL-NBR                                11830076
118400               ,  :PKSLIP-STR-DEST-NBR                            11840076
118500               ,  :PKSLIP-REC-SEQ-NBR                             11850076
118600               ,  :PKSLIP-SHIPT-ID                                11860076
118700               ,  :PKSLIP-BOL-NBR                                 11870076
118800               ,  :PKSLIP-PRO-NBR                                 11880076
118900               ,  :PKSLIP-PKSL-STAT-CDE                           11890076
119000               ,  :PC-E-COMM-DIRECT-SHIP                          11900076
119100               ,  :PKSLIP-PO-VER-NBR                              11910076
119200               ,  :PKSLIP-CRE-SRC-CDE                             11920076
119300               ,  :PKSLIP-EXPTED-PKG-QTY                          11930076
119400               ,  :PKSLIP-OWNER-SCAC-ID                           11940076
119500               ,  :PKSLIP-ASN-NBR                                 11950076
119600               ,  CURRENT_DATE                                    11960076
119700               ,  :PKSLIP-PKSL-PG-CNT                             11970076
119800               ,  :PKSLIP-CONTNR-ID                               11980076
119900               ,  :PKSLIP-ORIG-PKSL-SEQ-NBR)                      11990076
120000     END-EXEC.                                                    12000076
120100                                                                  12010076
120200     EVALUATE TRUE                                                12020076
120300         WHEN SQLCODE = +0                                        12030076
120400              MOVE +1       TO PT-TOTAL-TPKSLIP-INSERTS           12040076
120401                                                                  12040199
120402*** FOR TESTING ONLY                                              12040299
120403***  MOVE PKSLIP-PO-NBR   TO PV-DISP-PO                           12040399
120404***  DISPLAY '2150-INSERT-TPKSLIP - ' PV-DISP-PO                  12040499
120405*** FOR TESTING ONLY - END                                        12040599
120406                                                                  12040699
120410*                                                                 12041099
120420***                                                               12042099
120430             SET  PS-PO-PKSLIP-INSERTED  TO  TRUE                 12043099
120440***                                                               12044099
120450*                                                                 12045099
120500         WHEN SQLWARN0 NOT = SPACES                               12050076
120600         WHEN SQLCODE < +0                                        12060076
120700         WHEN SQLCODE > +0                                        12070076
120800             MOVE PKSLIP-PO-NBR   TO PV-DISP-PO                   12080076
120900             MOVE SQLCODE     TO PV-DISP-SQLCODE                  12090076
121000             MOVE '2150-INSERT-TPKSLIP'                           12100076
121100                              TO RC074-ERROR-PARA-NAME            12110076
121200             SET RC074-DB-ERROR                                   12120076
121300                 PS-ERROR-YES    TO TRUE                          12130076
121400             DISPLAY '******************************************' 12140076
121500             DISPLAY '*ABEND                                   *' 12150076
121600             DISPLAY '*PROGRAM   = RCKUP009                    *' 12160076
121700             DISPLAY '*DB2 OPER  = INSERT ON TPKSLIP           *' 12170076
121800             DISPLAY '*PARAGRAPH = 2150-INSERT-TPKSLIP         *' 12180076
121900             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                12190076
122000             DISPLAY '*PO = ' PV-DISP-PO                          12200076
122100             DISPLAY '******************************************' 12210076
122200     END-EVALUATE.                                                12220076
122300                                                                  12230076
122400 2160-UPDATE-PACK-SLIP-HEADER.                                    12240076
122500     PERFORM 2170-SELECT-TPKSLIP.                                 12250076
122600     COMPUTE PKSLIP-EXPTED-PKG-QTY = PKSLIP-EXPTED-PKG-QTY +      12260076
122700                RC074-QTY-RCVD.                                   12270076
122800     PERFORM 2180-UPDATE-TPKSLIP.                                 12280076
122900                                                                  12290076
123000 2170-SELECT-TPKSLIP.                                             12300076
123100                                                                  12310076
123200     EXEC SQL                                                     12320076
123300          SELECT EXPTED_PKG_QTY                                   12330076
123400            INTO :PKSLIP-EXPTED-PKG-QTY                           12340076
123500            FROM TPKSLIP                                          12350076
123600           WHERE PO_NBR       = :DK-PO-NBR                        12360076
123700             AND SEQ_NBR      = :PV-SAVE-PKSLIP-SEQ-NBR           12370076
123800             AND VER_STAT_CDE = 'A'                               12380076
123900     END-EXEC.                                                    12390076
124000                                                                  12400076
124100     EVALUATE TRUE                                                12410076
124200         WHEN SQLCODE = +0                                        12420076
124300              CONTINUE                                            12430076
124400         WHEN SQLWARN0 NOT = SPACES                               12440076
124500         WHEN SQLCODE < +0                                        12450076
124600         WHEN SQLCODE > +0                                        12460076
124700             MOVE DK-PO-NBR       TO PV-DISP-PO                   12470076
124800             MOVE PV-SAVE-PKSLIP-SEQ-NBR                          12480076
124900                                  TO PV-DISP-SEQ                  12490076
125000             MOVE SQLCODE     TO PV-DISP-SQLCODE                  12500076
125100             MOVE '2170-SELECT-TPKSLIP'                           12510076
125200                              TO RC074-ERROR-PARA-NAME            12520076
125300             SET RC074-DB-ERROR                                   12530076
125400                 PS-ERROR-YES    TO TRUE                          12540076
125500             DISPLAY '******************************************' 12550076
125600             DISPLAY '*ABEND                                   *' 12560076
125700             DISPLAY '*PROGRAM   = RCKUP009                    *' 12570076
125800             DISPLAY '*DB2 OPER  = SELECT TPKSLIP              *' 12580076
125900             DISPLAY '*PARAGRAPH = 2170-SELECT-TPKSLIP         *' 12590076
126000             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                12600076
126100             DISPLAY '*PO = ' PV-DISP-PO                          12610076
126200             DISPLAY '*SEQ = ' PV-DISP-SEQ                        12620076
126300             DISPLAY '******************************************' 12630076
126400     END-EVALUATE.                                                12640076
126500                                                                  12650076
126600 2180-UPDATE-TPKSLIP.                                             12660076
126700     EXEC SQL                                                     12670076
126800          UPDATE TPKSLIP                                          12680076
126900             SET EXPTED_PKG_QTY = :PKSLIP-EXPTED-PKG-QTY          12690076
127000           WHERE PO_NBR         = :DK-PO-NBR                      12700076
127100             AND SEQ_NBR        = :PV-SAVE-PKSLIP-SEQ-NBR         12710076
127200             AND VER_STAT_CDE   = 'A'                             12720076
127300     END-EXEC                                                     12730076
127400                                                                  12740076
127500     EVALUATE TRUE                                                12750076
127600         WHEN SQLCODE = +0                                        12760076
127700             MOVE +1       TO PT-TOTAL-TPKSLIP-UPDATES            12770076
127800         WHEN SQLWARN0 NOT = SPACES                               12780076
127900         WHEN SQLCODE < +0                                        12790076
128000         WHEN SQLCODE > +0                                        12800076
128100             MOVE DK-PO-NBR       TO PV-DISP-PO                   12810076
128200             MOVE PV-SAVE-PKSLIP-SEQ-NBR                          12820076
128300                                  TO PV-DISP-SEQ                  12830076
128400             MOVE SQLCODE     TO PV-DISP-SQLCODE                  12840076
128500             MOVE '2180-UPDATE-TPKSLIP'                           12850076
128600                              TO RC074-ERROR-PARA-NAME            12860076
128700             SET RC074-PO-NOF                                     12870076
128800                 PS-ERROR-YES    TO TRUE                          12880076
128900             DISPLAY '******************************************' 12890076
129000             DISPLAY '*ABEND                                   *' 12900076
129100             DISPLAY '*PROGRAM   = RCKUP009                    *' 12910076
129200             DISPLAY '*DB2 OPER  = UPDATE TPKSLIP              *' 12920076
129300             DISPLAY '*PARAGRAPH = 2180-UPDATE-TPKSLIP         *' 12930076
129400             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                12940076
129500             DISPLAY '*PO = ' PV-DISP-PO                          12950076
129600             DISPLAY '*SEQ = ' PV-DISP-SEQ                        12960076
129700             DISPLAY '******************************************' 12970076
129800     END-EVALUATE.                                                12980076
129900*----------------------------------------------------------------*12990076
130000*    INSERT A PACK SLIP ITEM ROW                                 *13000076
130100*----------------------------------------------------------------*13010076
130200                                                                  13020076
130300                                                                  13030076
130400 2200-ADD-TPKITEM.                                                13040076
130500                                                                  13050076
130600     PERFORM 2210-SETUP-TPKITEM-FIELDS.                           13060076
130700     PERFORM 2230-INSERT-TPKITEM.                                 13070076
130800                                                                  13080076
130900 2210-SETUP-TPKITEM-FIELDS.                                       13090076
131000                                                                  13100076
131100     MOVE RC074-PO-NUMBER        TO PKITEM-PO-NBR.                13110076
131200     MOVE PV-NEXT-SEQ-NBR        TO PKITEM-SEQ-NBR.               13120076
131300     MOVE RC074-QTY-RCVD         TO PKITEM-PKSL-ITM-QTY.          13130076
131400     MOVE PC-E-COMM-DIRECT-SHIP  TO PKITEM-CRE-UID.               13140076
131500     MOVE RC074-QTY-RCVD         TO PKITEM-ORIG-PKSL-ITM-QTY.     13150076
131600     MOVE RC074-SKU              TO DK-SKU-NBR.                   13160076
131700     PERFORM 2220-SELECT-LINE.                                    13170076
131800     MOVE PURITM-VER-NBR         TO PKITEM-PURITM-VER-NBR.        13180076
131900     MOVE PURITM-APP-PO-LNE-NBR  TO PKITEM-PKSL-LNE-NBR.          13190076
132000                                                                  13200076
132100                                                                  13210076
132200 2220-SELECT-LINE.                                                13220076
132300     EXEC SQL                                                     13230076
132400        SELECT  A.APP_PO_LNE_NBR                                  13240076
132500           ,    A.VER_NBR                                         13250076
132600           ,    A.ITM_NBR                                         13260076
132700           ,    A.PIC_ITM_IND                                     13270076
132800           ,    A.PO_LNE_NBR                                      13280076
132900           ,    A.VEND_STYL_NAME                                  13290076
133000           ,    A.SKU_SEQ_NBR                                     13300076
133100           ,    A.UNT_RTL_PR_AMT                                  13310076
133200           ,    A.UNT_COST_AMT                                    13320076
133300           ,    A.GP_RTL_AMT                                      13330076
133400           ,    A.GP_QTY                                          13340076
133500          INTO :PURITM-APP-PO-LNE-NBR                             13350076
133600           ,    :PURITM-VER-NBR                                   13360076
133700           ,    :PURITM-ITM-NBR                                   13370076
133800           ,    :PURITM-PIC-ITM-IND                               13380076
133900           ,    :PURITM-PO-LNE-NBR                                13390076
134000           ,    :PURITM-VEND-STYL-NAME                            13400076
134100           ,    :PURITM-SKU-SEQ-NBR                               13410076
134200           ,    :PURITM-UNT-RTL-PR-AMT                            13420076
134300           ,    :PURITM-UNT-COST-AMT                              13430076
134400           ,    :PURITM-GP-RTL-AMT                                13440076
134500           ,    :PURITM-GP-QTY                                    13450076
134600          FROM TPURITM A                                          13460076
134700            ,  XLT_SKU B                                          13470076
134800          WHERE A.PO_NBR          = :DK-PO-NBR                    13480076
134900            AND A.ITM_NBR         = B.ITM_NBR                     13490076
135000            AND A.VER_STATUS_CDE  = 'A'                           13500076
135100            AND B.SKU_NBR         = :DK-SKU-NBR                   13510076
135200     END-EXEC.                                                    13520076
135300                                                                  13530076
135400     EVALUATE TRUE                                                13540076
135500         WHEN SQLCODE = +0                                        13550076
135600         WHEN SQLCODE = -811                                      13560076
135700              CONTINUE                                            13570076
135800         WHEN SQLCODE = +100                                      13580076
135900             MOVE DK-PO-NBR   TO PV-DISP-PO                       13590076
136000             MOVE DK-SKU-NBR  TO PV-DISP-SKU                      13600076
136100             MOVE SQLCODE     TO PV-DISP-SQLCODE                  13610076
136200             MOVE '2220-SELECT-LINE'                              13620076
136300                              TO RC074-ERROR-PARA-NAME            13630076
136400             SET RC074-ITEM-NOT-ON-PO                             13640076
136500                 PS-ERROR-YES    TO TRUE                          13650076
136600             DISPLAY '******************************************' 13660076
136700             DISPLAY '*ABEND                                   *' 13670076
136800             DISPLAY '*PROGRAM   = RCKUP009                    *' 13680076
136900             DISPLAY '*DB2 OPER  = SELECT ON TPURITM, XLT_SKU  *' 13690076
137000             DISPLAY '*PARAGRAPH = 2220-SELECT-LINE            *' 13700076
137100             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                13710076
137200             DISPLAY '*PO = ' PV-DISP-PO                          13720076
137300             DISPLAY '*SKU = ' PV-DISP-SKU                        13730076
137400             DISPLAY '******************************************' 13740076
137500         WHEN SQLWARN0 NOT = SPACES                               13750076
137600         WHEN SQLCODE < +0                                        13760076
137700         WHEN SQLCODE > +0                                        13770076
137800             MOVE DK-PO-NBR   TO PV-DISP-PO                       13780076
137900             MOVE DK-SKU-NBR  TO PV-DISP-SKU                      13790076
138000             MOVE SQLCODE     TO PV-DISP-SQLCODE                  13800076
138100             MOVE '2220-SELECT-LINE'                              13810076
138200                              TO RC074-ERROR-PARA-NAME            13820076
138300             SET RC074-DB-ERROR                                   13830076
138400                 PS-ERROR-YES    TO TRUE                          13840076
138500             DISPLAY '******************************************' 13850076
138600             DISPLAY '*ABEND                                   *' 13860076
138700             DISPLAY '*PROGRAM   = RCKUP009                    *' 13870076
138800             DISPLAY '*DB2 OPER  = SELECT ON TPURITM, XLT_SKU  *' 13880076
138900             DISPLAY '*PARAGRAPH = 2220-SELECT-LINE            *' 13890076
139000             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                13900076
139100             DISPLAY '*PO = ' PV-DISP-PO                          13910076
139200             DISPLAY '*SKU = ' PV-DISP-SKU                        13920076
139300             DISPLAY '******************************************' 13930076
139400     END-EVALUATE.                                                13940076
139500                                                                  13950076
139600 2230-INSERT-TPKITEM.                                             13960076
139700     EXEC SQL                                                     13970076
139800          INSERT INTO TPKITEM                                     13980076
139900                 (PO_NBR                                          13990076
140000              ,   SEQ_NBR                                         14000076
140100              ,   PKSL_LNE_NBR                                    14010076
140200              ,   CRE_TMST                                        14020076
140300              ,   VER_STAT_CDE                                    14030076
140400              ,   PKSL_ITM_QTY                                    14040076
140500              ,   CRE_UID                                         14050076
140600              ,   PURITM_VER_NBR                                  14060076
140700              ,   ORIG_PKSL_ITM_QTY)                              14070076
140800          VALUES (:PKITEM-PO-NBR                                  14080076
140900              ,   :PKITEM-SEQ-NBR                                 14090076
141000              ,   :PKITEM-PKSL-LNE-NBR                            14100076
141100              ,    CURRENT_TIMESTAMP                              14110076
141200              ,    'A'                                            14120076
141300              ,   :PKITEM-PKSL-ITM-QTY                            14130076
141400              ,   :PKITEM-CRE-UID                                 14140076
141500              ,   :PKITEM-PURITM-VER-NBR                          14150076
141600              ,   0)                                              14160076
141700     END-EXEC.                                                    14170076
141800                                                                  14180076
141900     EVALUATE TRUE                                                14190076
142000         WHEN SQLCODE = +0                                        14200076
142100              MOVE +1       TO PT-TOTAL-TPKITEM-INSERTS           14210076
142200         WHEN SQLWARN0 NOT = SPACES                               14220076
142300         WHEN SQLCODE < +0                                        14230076
142400         WHEN SQLCODE > +0                                        14240076
142500             MOVE PKITEM-PO-NBR  TO PV-DISP-PO                    14250076
142600             MOVE PKITEM-SEQ-NBR TO PV-DISP-SEQ                   14260076
142700             MOVE SQLCODE     TO PV-DISP-SQLCODE                  14270076
142800             MOVE '2230-INSERT-TPKITEM'                           14280076
142900                              TO RC074-ERROR-PARA-NAME            14290076
143000             SET RC074-DB-ERROR                                   14300076
143100                 PS-ERROR-YES    TO TRUE                          14310076
143200             DISPLAY '******************************************' 14320076
143300             DISPLAY '*ABEND                                   *' 14330076
143400             DISPLAY '*PROGRAM   = RCKUP009                    *' 14340076
143500             DISPLAY '*DB2 OPER  = INSERT ON TPKITEM           *' 14350076
143600             DISPLAY '*PARAGRAPH = 2230-INSERT-TPKITEM         *' 14360076
143700             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                14370076
143800             DISPLAY '*PO = ' PV-DISP-PO                          14380076
143900             DISPLAY '*SEQ = ' PV-DISP-SEQ                        14390076
144000             DISPLAY '******************************************' 14400076
144100     END-EVALUATE.                                                14410076
144200                                                                  14420076
144300/                                                                 14430076
144400*---------------------------------------------------------------* 14440076
144500* CHECK TO SEE IF THE DC SHOULD FLUSH THEIR BUILDING.             14450076
144600*---------------------------------------------------------------* 14460076
144700 2250-CHECK-DC-FLUSH-PARM.                                        14470076
144800                                                                  14480076
144900     EXEC SQL                                                     14490076
145000          SELECT  FUNC_TXT                                        14500076
145100          INTO   :KRPRPM-FUNC-TXT                                 14510076
145200          FROM  TKRPRPM                                           14520076
145300          WHERE LOC_ID            =  90                           14530076
145400            AND SYS_PRC_FUNC_CDE  =  'FLUSH'                      14540076
145500            AND FUNC_PRC_STAT_CDE =  'AC'                         14550076
145600     END-EXEC.                                                    14560076
145700                                                                  14570076
145800     EVALUATE TRUE                                                14580076
145900         WHEN SQLCODE = +0                                        14590076
146000            IF KRPRPM-FUNC-TXT = 'N'                              14600076
146100                SET PS-DC-FLUSH-NO  TO TRUE                       14610076
146200            ELSE                                                  14620076
146300                SET PS-DC-FLUSH-YES TO TRUE                       14630076
146400            END-IF                                                14640076
146500         WHEN OTHER                                               14650076
146600                SET PS-DC-FLUSH-NO  TO TRUE                       14660076
146700     END-EVALUATE.                                                14670076
146800                                                                  14680076
146900*---------------------------------------------------------------* 14690076
147000* CHECK TO SEE IF STORE IS IN INVENTORY CYCLE                     14700076
147100*---------------------------------------------------------------* 14710076
147200 2275-CHECK-INV-IN-PROCESS.                                       14720076
147300                                                                  14730076
147400     EXEC SQL                                                     14740076
147500          SELECT                                                  14750076
147600                 A.DC_CTOFF_DTE                                   14760076
147700             ,   (A.DC_CTOFF_DTE + 7 DAYS)                        14770076
147800          INTO                                                    14780076
147900                 :XLT00025-DC-CTOFF-DTE                           14790076
148000             ,   :PV-WORK-DATE-PLUS-7                             14800076
148100          FROM                                                    14810076
148200                XLT_MDSE_INV_PARM A                               14820076
148300          WHERE A.LOC_NBR           =  :RECDIS-STR-NBR            14830076
148400           AND  A.DC_CTOFF_DTE >= (CURRENT_DATE - 7 DAYS)         14840076
148500           AND  A.DC_CTOFF_DTE <= (CURRENT_DATE + 7 DAYS)         14850076
148600           AND  A.ACTV_IND         = 'Y'                          14860076
148700           AND  A.LOC_INV_STAT_CDE = 'IN'                         14870076
148800     END-EXEC.                                                    14880076
148900                                                                  14890076
149000     EVALUATE TRUE                                                14900076
149100         WHEN SQLCODE = +0                                        14910076
149200            SET RC074-STORE-INV-CYCLE                             14920076
149300                PS-ERROR-YES    TO TRUE                           14930076
149400         WHEN SQLCODE = +100                                      14940076
149500             CONTINUE                                             14950076
149600         WHEN SQLWARN0 NOT = SPACES                               14960076
149700         WHEN SQLCODE < +0                                        14970076
149800         WHEN SQLCODE > +0                                        14980076
149900             MOVE RECDIS-STR-NBR  TO PV-DISP-STR-NBR              14990076
150000             MOVE SQLCODE     TO PV-DISP-SQLCODE                  15000076
150100             MOVE '2275-CHECK-INV-IN-PROCESS'                     15010076
150200                              TO RC074-ERROR-PARA-NAME            15020076
150300             SET RC074-DB-ERROR                                   15030076
150400                 PS-ERROR-YES    TO TRUE                          15040076
150500             DISPLAY '******************************************' 15050076
150600             DISPLAY '*ABEND                                   *' 15060076
150700             DISPLAY '*PROGRAM   = RCKUP009                    *' 15070076
150800             DISPLAY '*DB2 OPER  = SELECT ON XLT_MDSE_INV_PARM *' 15080076
150900             DISPLAY '*PARAGRAPH = 2275-CHECK-INV-IN-PROCESS   *' 15090076
151000             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                15100076
151100             DISPLAY '*STORE = ' PV-DISP-STR-NBR                  15110076
151200             DISPLAY '******************************************' 15120076
151300     END-EVALUATE.                                                15130076
151400                                                                  15140076
151500                                                                  15150076
151510*---------------------------------------------------------------* 15151078
151520* DETERMINE THE UNIT QUANTITY ORDERED                             15152078
151521* DMH ADDED - 8-22-11                                             15152178
151530*---------------------------------------------------------------* 15153078
151540 2280-GET-QTY-ORDERED.                                            15154078
151550                                                                  15155078
151560     EXEC SQL                                                     15156078
151561          SELECT  A.PO_NBR                                        15156183
151562                , A.RMS_PO_SKU_NBR                                15156283
151570                , SUM(C.STR_DISTRO_QTY)                           15157083
151580                , A.PO_LNE_NBR                                    15158099
151592            INTO :PURITM-PO-NBR                                   15159283
151593                ,:PURITM-RMS-PO-SKU-NBR                           15159383
151594                ,:PV-UNIT-QTY-ORDERED                             15159483
151595                ,:PURITM-PO-LNE-NBR                               15159599
151596            FROM  TPURITM A                                       15159699
151597                 ,TALLPLN B                                       15159799
151598                 ,TMESTDS C                                       15159899
151599           WHERE  A.PO_NBR          =  :DK-PO-NBR                 15159999
151600             AND  A.RMS_PO_SKU_NBR  =  :DK-SKU                    15160099
151601             AND  A.VER_STATUS_CDE  =  'A'                        15160199
151602             AND  A.PO_NBR          =  B.PO_NBR                   15160299
151603             AND  A.PO_LNE_NBR      =  B.PO_LNE_NBR               15160399
151604             AND  B.DEST_NBR        =  :DK-DEST-NBR               15160499
151605             AND  B.STATUS_CDE      = 'AC'                        15160599
151606             AND  B.PO_NBR          =  C.PO_NBR                   15160699
151607             AND  B.PO_LNE_NBR      =  C.PO_LNE_NBR               15160799
151608             AND  B.DEST_NBR        =  C.STR_NBR                  15160899
151609             AND  B.PLAN_NBR        =  C.PLAN_NBR                 15160999
151610           GROUP BY A.PO_NBR                                      15161099
151611                  , A.RMS_PO_SKU_NBR                              15161199
151612                  , C.STR_NBR                                     15161299
151613                  , A.PO_LNE_NBR                                  15161399
151614          WITH UR                                                 15161499
151615     END-EXEC.                                                    15161599
151616                                                                  15161699
151617     EVALUATE TRUE                                                15161799
151618         WHEN SQLCODE = +0                                        15161899
151619*                                                                 15161999
151620*** DMH 10/13/13 BEGIN                                            15162099
151621              MOVE SPACES  TO  RC074-ERROR-TYPE                   15162199
151622*** DMH 10/13/13 END                                              15162299
151624              MOVE  PURITM-PO-LNE-NBR TO RC074-PO-LNE-NBR         15162499
151626                                                                  15162699
151627         WHEN SQLCODE = +100                                      15162799
151628         WHEN SQLCODE = -305                                      15162899
151629              MOVE ZEROES  TO  PV-UNIT-QTY-ORDERED                15162999
151630*                                                                 15163099
151631*** DMH 10/13/13 BEGIN                                            15163199
151632              IF  DK-PO-NBR  =  PV-PREV-PO                        15163299
151633                  IF  PS-PREV-NOF                                 15163399
151634                      SET RC074-PO-NOF                            15163499
151635                      PS-ERROR-YES    TO TRUE                     15163599
151636                  ELSE                                            15163699
151637                      MOVE '2280-GET-QTY-ORDERED'                 15163799
151638                               TO RC074-ERROR-PARA-NAME           15163899
151639                      PERFORM 2285-CHECK-ADDL-ERRORS              15163999
151640                  END-IF                                          15164099
151641              ELSE                                                15164199
151642                  PERFORM 2283-DOES-PO-EXIST                      15164299
151643                  MOVE  DK-PO-NBR  TO  PV-PREV-PO                 15164399
151644                  IF PS-ERROR-NO                                  15164499
151645                     PERFORM 2285-CHECK-ADDL-ERRORS               15164599
151646                  END-IF                                          15164699
151648              END-IF                                              15164899
151649*                                                                 15164999
151650              MOVE DK-PO-NBR   TO PV-DISP-PO                      15165099
151651              MOVE SQLCODE     TO PV-DISP-SQLCODE                 15165199
151652**            MOVE '2280-GET-QTY-ORDERED'                         15165299
151653**                             TO RC074-ERROR-PARA-NAME           15165399
151654***           SET RC074-PO-NOF                                    15165499
151655***               PS-ERROR-YES    TO TRUE                         15165599
151656*** DMH 10/13/13 END                                              15165699
151657*                                                                 15165799
151658                                                                  15165899
151659         WHEN SQLWARN0 NOT = SPACES                               15165999
151660         WHEN SQLCODE < +0                                        15166099
151661         WHEN SQLCODE > +0                                        15166199
151662             MOVE RECDIS-STR-NBR  TO PV-DISP-STR-NBR              15166299
151663             MOVE SQLCODE     TO PV-DISP-SQLCODE                  15166399
151664             MOVE '2280-GET-QTY-ORDERED'                          15166499
151665                              TO RC074-ERROR-PARA-NAME            15166599
151666             SET RC074-DB-ERROR                                   15166699
151667                 PS-ERROR-YES    TO TRUE                          15166799
151668             DISPLAY '******************************************' 15166899
151669             DISPLAY '*ABEND                                   *' 15166999
151670             DISPLAY '*PROGRAM   = RCKUP009                    *' 15167099
151671             DISPLAY '*DB2 OPER  = TPURITM - TALLPLN - TMESTDS *' 15167199
151672             DISPLAY '*PARAGRAPH = 2280-GET-QTY-ORDERED        *' 15167299
151673             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                15167399
151674             DISPLAY '*STORE = ' PV-DISP-STR-NBR                  15167499
151675             DISPLAY '******************************************' 15167599
151676     END-EVALUATE.                                                15167699
151677                                                                  15167799
151678     MOVE DK-PO-NBR   TO PV-DISP-PO.                              15167899
151679     MOVE DK-SKU      TO PV-DISP-SKU.                             15167999
151680     IF  RC074-PO-NOF                                             15168099
151681         DISPLAY '    PO NOT ON FILE: '  PV-DISP-PO               15168199
151682     ELSE                                                         15168299
151683     IF  RC074-ITEM-NOT-ON-PO                                     15168399
151684         DISPLAY '    ITEM NOT ON PO: '  PV-DISP-PO               15168499
151685                 ' - '                   PV-DISP-SKU              15168599
151686     END-IF                                                       15168699
151687     END-IF.                                                      15168799
151688                                                                  15168899
151689                                                                  15168999
151690*---------------------------------------------------------------* 15169099
151691* IF +100 FROM 2280 --- PO-SKU DOES NOT EXIST                     15169199
151692* THIS PARAGRAPH WILL CHECK TO SEE IF THE PO EXISTS               15169299
151693*                                                                 15169399
151694* DETERMINE THE UNIT QUANTITY ORDERED                             15169499
151695* DMH ADDED - 10-16-13                                            15169599
151696*---------------------------------------------------------------* 15169699
151697 2283-DOES-PO-EXIST.                                              15169799
151698     EXEC SQL                                                     15169899
151699          SELECT  A.PO_NBR                                        15169999
151700            INTO :PV-PO                                           15170099
151701            FROM  TPURCHS A                                       15170199
151702           WHERE  A.PO_NBR          =  :DK-PO-NBR                 15170299
151703             AND  A.VER_STATUS_CDE  =  'A'                        15170399
151704          WITH UR                                                 15170499
151705     END-EXEC.                                                    15170599
151706                                                                  15170699
151707     EVALUATE TRUE                                                15170799
151708         WHEN SQLCODE = +0                                        15170899
151709              SET PS-PREV-FOUND   TO TRUE                         15170999
151710         WHEN SQLCODE = +100                                      15171099
151711              MOVE ZEROES  TO  PV-UNIT-QTY-ORDERED                15171199
151712              MOVE DK-PO-NBR   TO PV-DISP-PO                      15171299
151713                                                                  15171399
151714              MOVE SQLCODE     TO PV-DISP-SQLCODE                 15171499
151715              MOVE '2283-DOES-PO-EXIST  '                         15171599
151716                               TO RC074-ERROR-PARA-NAME           15171699
151717              SET RC074-PO-NOF                                    15171799
151718                  PS-ERROR-YES    TO TRUE                         15171899
151719              SET PS-PREV-NOF     TO TRUE                         15171999
151726                                                                  15172696
151727         WHEN SQLWARN0 NOT = SPACES                               15172796
151728         WHEN SQLCODE < +0                                        15172896
151729         WHEN SQLCODE > +0                                        15172996
151731             MOVE SQLCODE     TO PV-DISP-SQLCODE                  15173196
151732             MOVE '2283-DOES-PO-EXIST  '                          15173297
151733                              TO RC074-ERROR-PARA-NAME            15173396
151734             SET RC074-DB-ERROR                                   15173496
151735                 PS-ERROR-YES    TO TRUE                          15173596
151736             DISPLAY '******************************************' 15173696
151737             DISPLAY '*ABEND                                   *' 15173796
151738             DISPLAY '*PROGRAM   = RCKUP009                    *' 15173896
151739             DISPLAY '*DB2 OPER  = TPURCHS                     *' 15173997
151740             DISPLAY '*PARAGRAPH = 2283-DOES-PO-EXIST          *' 15174097
151741             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                15174196
151742             DISPLAY '*PO NBR = '  PV-DISP-PO                     15174297
151743             DISPLAY '******************************************' 15174396
151744     END-EVALUATE.                                                15174496
151745                                                                  15174596
151746                                                                  15174699
151758*---------------------------------------------------------------* 15175896
151759* DETERMINE IF SKU IS ON THE PO                                   15175999
151761*---------------------------------------------------------------* 15176196
151762 2285-CHECK-ADDL-ERRORS.                                          15176299
151763                                                                  15176399
151764      PERFORM 2286-CHECK-SKU-ON-PO.                               15176499
151765                                                                  15176599
151766      IF PS-ERROR-NO                                              15176699
151767         PERFORM 2288-CHECK-DC-SPLIT                              15176799
151768      END-IF.                                                     15176899
151769                                                                  15176999
151770      IF PS-ERROR-NO                                              15177099
151771         PERFORM 2292-CHECK-STORE-ALLOC                           15177199
151772      END-IF.                                                     15177299
151773                                                                  15177399
151774 2286-CHECK-SKU-ON-PO.                                            15177499
151775                                                                  15177599
151776     EXEC SQL                                                     15177699
151777          SELECT  A.PO_NBR                                        15177799
151778                , A.PO_LNE_NBR                                    15177899
151779            INTO :PURITM-PO-NBR                                   15177996
151780                ,:PURITM-PO-LNE-NBR                               15178099
151781            FROM  TPURITM A                                       15178196
151782           WHERE  A.PO_NBR          =  :DK-PO-NBR                 15178296
151783             AND  A.RMS_PO_SKU_NBR  =  :DK-SKU                    15178396
151784             AND  A.VER_STATUS_CDE  =  'A'                        15178496
151789          WITH UR                                                 15178996
151790     END-EXEC.                                                    15179096
151791                                                                  15179196
151792     EVALUATE TRUE                                                15179296
151793         WHEN SQLCODE = +0                                        15179396
151794              MOVE PURITM-PO-LNE-NBR TO ALLPLN-PO-LNE-NBR         15179499
151795                                        RC074-PO-LNE-NBR          15179599
151796         WHEN SQLCODE = +100                                      15179699
151797              SET RC074-ITEM-NOT-ON-PO                            15179799
151798                  PS-ERROR-YES    TO TRUE                         15179899
151799              MOVE +0 TO RC074-PO-LNE-NBR                         15179999
151800              MOVE '2286-CHECK-SKU-ON-PO '                        15180099
151801                              TO RC074-ERROR-PARA-NAME            15180199
151802         WHEN SQLWARN0 NOT = SPACES                               15180299
151803         WHEN SQLCODE < +0                                        15180399
151804         WHEN SQLCODE > +0                                        15180499
151805             MOVE DK-PO-NBR       TO PV-DISP-PO                   15180599
151806             MOVE DK-SKU          TO PV-DISP-SKU                  15180699
151807             MOVE SQLCODE     TO PV-DISP-SQLCODE                  15180799
151808             MOVE '2286-CHECK-SKU-ON-PO '                         15180899
151809                              TO RC074-ERROR-PARA-NAME            15180999
151810             SET RC074-DB-ERROR                                   15181099
151811                 PS-ERROR-YES    TO TRUE                          15181199
151812             DISPLAY '******************************************' 15181299
151813             DISPLAY '*ABEND                                   *' 15181399
151814             DISPLAY '*PROGRAM   = RCKUP009                    *' 15181499
151815             DISPLAY '*DB2 OPER  = TPURITM                     *' 15181599
151816             DISPLAY '*PARAGRAPH = 2286-CHECK-SKU-ON-PO        *' 15181699
151817             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                15181799
151818             DISPLAY '*PO NUM = ' PV-DISP-PO                      15181899
151819             DISPLAY '*SKU NUM = ' PV-DISP-SKU                    15181999
151820             DISPLAY '******************************************' 15182099
151821     END-EVALUATE.                                                15182199
151822                                                                  15182299
151823                                                                  15182399
151824*---------------------------------------------------------------* 15182499
151825* DETERMINE IF DC SPLIT EXISTS                                    15182599
151826*---------------------------------------------------------------* 15182699
151827 2288-CHECK-DC-SPLIT.                                             15182799
151828                                                                  15182899
151829     EXEC SQL                                                     15182999
151830          SELECT  A.PO_NBR                                        15183099
151831            INTO :ALLPLN-PO-NBR                                   15183199
151832            FROM  TALLPLN A                                       15183299
151834           WHERE  A.PO_NBR          =  :DK-PO-NBR                 15183499
151838             AND  A.PO_LNE_NBR      =  :ALLPLN-PO-LNE-NBR         15183899
151839             AND  A.DEST_NBR        =  :DK-DEST-NBR               15183999
151840             AND  A.STATUS_CDE      = 'AC'                        15184099
151848          WITH UR                                                 15184899
151858     END-EXEC.                                                    15185899
151859                                                                  15185999
151860     EVALUATE TRUE                                                15186099
151861         WHEN SQLCODE = +0                                        15186199
151862              CONTINUE                                            15186299
151863         WHEN SQLCODE = +100                                      15186399
151864              SET RC074-NO-DC-SPLIT                               15186499
151865                  PS-ERROR-YES    TO TRUE                         15186599
151866              MOVE '2288-CHECK-DC-SPLIT '                         15186699
151867                              TO RC074-ERROR-PARA-NAME            15186799
151868         WHEN SQLWARN0 NOT = SPACES                               15186899
151869         WHEN SQLCODE < +0                                        15186999
151870         WHEN SQLCODE > +0                                        15187099
151871             MOVE DK-PO-NBR       TO PV-DISP-PO                   15187199
151872             MOVE DK-SKU          TO PV-DISP-SKU                  15187299
151873             MOVE DK-DEST-NBR     TO PV-DISP-STR-NBR              15187399
151874             MOVE SQLCODE     TO PV-DISP-SQLCODE                  15187499
151875             MOVE '2288-CHECK-DC-SPLIT '                          15187599
151876                              TO RC074-ERROR-PARA-NAME            15187699
151877             SET RC074-DB-ERROR                                   15187799
151878                 PS-ERROR-YES    TO TRUE                          15187899
151879             DISPLAY '******************************************' 15187999
151880             DISPLAY '*ABEND                                   *' 15188099
151881             DISPLAY '*PROGRAM   = RCKUP009                    *' 15188199
151882             DISPLAY '*DB2 OPER  = TALLPLN                     *' 15188299
151883             DISPLAY '*PARAGRAPH = 2288-CHECK-DC-SPLIT         *' 15188399
151884             DISPLAY '*SQLCODE =   PV-DISP-SQLCODE             *' 15188499
151885             DISPLAY '*PO NUM = ' PV-DISP-PO                      15188599
151886             DISPLAY '*SKU NUM = ' PV-DISP-SKU                    15188699
151887             DISPLAY '*STORE = ' PV-DISP-STR-NBR                  15188799
151888             DISPLAY '******************************************' 15188899
151889     END-EVALUATE.                                                15188999
151890                                                                  15189099
151891                                                                  15189199
151892*---------------------------------------------------------------* 15189299
151893* DETERMINE IF STORE ALLOCATION EXISTS                            15189399
151894*---------------------------------------------------------------* 15189499
151895 2292-CHECK-STORE-ALLOC.                                          15189599
151896                                                                  15189699
151897     EXEC SQL                                                     15189799
151898          SELECT  A.DEST_NBR                                      15189899
151899            INTO :ALLPLN-DEST-NBR                                 15189999
151900            FROM  TALLPLN A                                       15190099
151901                 ,TMESTDS B                                       15190199
151902           WHERE  A.PO_NBR          =  :DK-PO-NBR                 15190299
151903             AND  A.PO_NBR          =  B.PO_NBR                   15190399
151907             AND  A.DEST_NBR        =  :DK-DEST-NBR               15190799
151908             AND  A.STATUS_CDE      = 'AC'                        15190899
151910             AND  A.PO_LNE_NBR      =  :ALLPLN-PO-LNE-NBR         15191099
151911             AND  A.PO_LNE_NBR      =  B.PO_LNE_NBR               15191199
151912             AND  A.DEST_NBR        =  B.STR_NBR                  15191299
151913             AND  A.PLAN_NBR        =  B.PLAN_NBR                 15191399
151917          WITH UR                                                 15191799
151925     END-EXEC.                                                    15192599
151926                                                                  15192699
151927     EVALUATE TRUE                                                15192799
151928         WHEN SQLCODE = +0                                        15192899
151929              CONTINUE                                            15192999
151930         WHEN SQLCODE = +100                                      15193099
151931              SET RC074-NO-STORE-ALLOCATION                       15193199
151932                  PS-ERROR-YES    TO TRUE                         15193299
151933              MOVE '2292-CHECK-STORE-ALLOC'                       15193399
151934                              TO RC074-ERROR-PARA-NAME            15193499
151935         WHEN SQLWARN0 NOT = SPACES                               15193599
151936         WHEN SQLCODE < +0                                        15193699
151937         WHEN SQLCODE > +0                                        15193799
151938             MOVE DK-PO-NBR       TO PV-DISP-PO                   15193899
151939             MOVE DK-DEST-NBR     TO PV-DISP-STR-NBR              15193999
151940             MOVE ALLPLN-PO-LNE-NBR TO PV-DISP-LINE-NBR           15194099
151941             MOVE SQLCODE     TO PV-DISP-SQLCODE                  15194199
151942             MOVE '2292-CHECK-STORE-ALLOC'                        15194299
151943                              TO RC074-ERROR-PARA-NAME            15194399
151944             SET RC074-DB-ERROR                                   15194499
151945                 PS-ERROR-YES    TO TRUE                          15194599
151946             DISPLAY '******************************************' 15194699
151947             DISPLAY '*ABEND                                   *' 15194799
151948             DISPLAY '*PROGRAM   = RCKUP009                    *' 15194899
151949             DISPLAY '*DB2 OPER  = TMESTDS                     *' 15194999
151950             DISPLAY '*PARAGRAPH = 2292-CHECK-STORE-ALLOC      *' 15195099
151951             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                15195199
151952             DISPLAY '*PO NUM = ' PV-DISP-PO                      15195299
151953             DISPLAY '*LINE   = ' PV-DISP-LINE-NBR                15195399
151954             DISPLAY '*STORE = ' PV-DISP-STR-NBR                  15195499
151955             DISPLAY '******************************************' 15195599
151956     END-EVALUATE.                                                15195699
151957                                                                  15195799
151958                                                                  15195899
151959*---------------------------------------------------------------* 15195999
151960* DETERMINE THE UNIT QUANTITY ALREADY RECEIVED                    15196099
151961* DMH ADDED - 8-22-11                                             15196199
151962*---------------------------------------------------------------* 15196299
151963 2295-GET-QTY-RECEIVED.                                           15196399
151964                                                                  15196499
151965     EXEC SQL                                                     15196599
151966          SELECT  A.PO_NBR                                        15196699
151967                , A.RMS_PO_SKU_NBR                                15196799
151968                , E.STR_NBR                                       15196899
151969                , SUM(E.AP_VERIFY_ITM_QTY)                        15196999
151970            INTO :PURITM-PO-NBR                                   15197099
151971                ,:PURITM-RMS-PO-SKU-NBR                           15197199
151972                ,:RECDIS-STR-NBR                                  15197299
151973                ,:PV-UNIT-QTY-RECEIVED                            15197399
151974            FROM  TPURITM A                                       15197499
151975                 ,TRECITM D                                       15197599
151976                 ,TRECDIS E                                       15197699
151977           WHERE  A.PO_NBR          =  :DK-PO-NBR                 15197799
151978             AND  A.RMS_PO_SKU_NBR  =  :DK-SKU                    15197899
151979             AND  A.VER_STATUS_CDE  =  'A'                        15197999
151980             AND  A.PO_NBR          =  D.ORD_NBR                  15198099
151981             AND  A.APP_PO_LNE_NBR  =  D.ORD_LNE_NBR              15198199
151982             AND  D.VER_STATUS_CDE  = 'A'                         15198299
151983             AND  D.ORD_NBR         =  E.ORD_NBR                  15198399
151984             AND  D.ORD_LNE_NBR     =  E.ORD_LNE_NBR              15198499
151985             AND  D.REC_SEQ_NBR     =  E.REC_SEQ_NBR              15198599
151986             AND  E.STR_NBR         =  :DK-DEST-NBR               15198699
151987           GROUP BY A.PO_NBR                                      15198799
151988                  , A.RMS_PO_SKU_NBR                              15198899
151989                  , E.STR_NBR                                     15198999
151990          WITH UR                                                 15199099
151991     END-EXEC.                                                    15199199
151992                                                                  15199299
151993     EVALUATE TRUE                                                15199399
151994         WHEN SQLCODE = +0                                        15199499
151995              CONTINUE                                            15199599
151996         WHEN SQLCODE = +100                                      15199699
151997              MOVE ZEROES  TO  PV-UNIT-QTY-RECEIVED               15199799
151998         WHEN SQLWARN0 NOT = SPACES                               15199899
151999         WHEN SQLCODE < +0                                        15199999
152000         WHEN SQLCODE > +0                                        15200099
152001             MOVE RECDIS-STR-NBR  TO PV-DISP-STR-NBR              15200199
152002             MOVE SQLCODE     TO PV-DISP-SQLCODE                  15200299
152003             MOVE '2295-GET-QTY-RECEIVED'                         15200399
152004                              TO RC074-ERROR-PARA-NAME            15200499
152005             SET RC074-DB-ERROR                                   15200599
152006                 PS-ERROR-YES    TO TRUE                          15200699
152007             DISPLAY '******************************************' 15200799
152008             DISPLAY '*ABEND                                   *' 15200899
152009             DISPLAY '*PROGRAM   = RCKUP009                    *' 15200999
152010             DISPLAY '*DB2 OPER  = TPURITM - TRECITM - TRECDIS *' 15201099
152011             DISPLAY '*PARAGRAPH = 2295-GET-QTY-RECEIVED       *' 15201199
152012             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                15201299
152013             DISPLAY '*STORE = ' PV-DISP-STR-NBR                  15201399
152014             DISPLAY '******************************************' 15201499
152015     END-EVALUATE.                                                15201599
152016                                                                  15201699
152017                                                                  15201799
152018*---------------------------------------------------------------* 15201899
152019 2300-BUILD-RECEIVER-INFO.                                        15201999
152020                                                                  15202099
152021     INITIALIZE DCLTRECEIV.                                       15202199
152030                                                                  15203076
152100     PERFORM 2310-DETERMINE-INDICATORS.                           15210076
152200                                                                  15220076
152300     MOVE RC074-PO-NUMBER        TO RECEIV-ORD-NBR.               15230076
152400     MOVE PV-REC-SEQ-NBR         TO RECEIV-REC-SEQ-NBR            15240076
152500                                    RECEIV-REFER-BACK-SEQ-NBR.    15250076
152600     MOVE PURITM-VER-NBR         TO RECEIV-PO-VER-NBR.            15260076
152700                                                                  15270076
152800     MOVE RC074-STR-NBR          TO RECEIV-OPER-UNT-ID.           15280076
152900     MOVE 1                      TO RECEIV-FCLTY-ID.              15290076
153000     MOVE 'VE'                   TO RECEIV-STATUS-CDE.            15300076
153100     MOVE 'P'                    TO RECEIV-SYST-CRE-CDE.          15310076
153200     MOVE 'CD'                   TO RECEIV-REC-TYP-CDE.           15320076
153300     MOVE 'A'                    TO RECEIV-VER-STATUS-CDE.        15330076
153400     MOVE 1                      TO RECEIV-EXPTED-CART-CNT.       15340076
153500     MOVE 1                      TO RECEIV-ACTL-CART-CNT.         15350076
153600     MOVE RC074-QTY-RCVD         TO RECEIV-EXPTED-ITM-QTY         15360076
153700                                    RECEIV-ACTL-ITM-QTY.          15370076
153800     MOVE '9999-09-09-09.09.09.999999'                            15380076
153900                                 TO RECEIV-ML-POST-TMST           15390076
154000                                    RECEIV-FS-POST-TMST           15400076
154100                                    RECEIV-IN-TRBL-TMST           15410076
154200                                    RECEIV-MKNG-APRN-PRT-TMST.    15420076
154300*    PERFORM 3000-SEL-ARRVD-TRIP-TMST.                            15430076
154400*    MOVE PV-ARRVD-TIMESTAMP      TO RECEIV-REC-TMST.             15440076
154500     MOVE RC074-STR-NBR           TO RECEIV-CURR-OPER-UNT-ID.     15450076
154600                                                                  15460076
154700     MOVE 90                      TO RECEIV-CRE-OPER-UNT-ID.      15470076
154800     MOVE PC-E-COMM-DIRECT-SHIP   TO RECEIV-CRE-UID.              15480076
154900                                                                  15490076
155000     MOVE 1                       TO RECEIV-CURR-FCLTY-ID.        15500076
155100     MOVE 1                       TO RECEIV-CRE-FCLTY-ID.         15510076
155200     MOVE PC-CURRENT-PROGRAM-NAME TO RECEIV-UPD-PGM-ID            15520076
155300                                     RECEIV-UPD-UID               15530076
155400                                     RECEIV-VRFD-USR-ID.          15540076
155500                                                                  15550076
155600     MOVE SPACES                 TO RECEIV-RCVG-CLERK-INIT-ID.    15560076
155700     MOVE 'N'                    TO RECEIV-FRE-ASTRA-IND.         15570076
155800                                                                  15580076
155900     PERFORM VARYING PV-COUNT FROM 1 BY 1 UNTIL                   15590076
156000          PV-COUNT > 10                                           15600076
156100         PERFORM 3000-OPEN-TRECVER-CSR                            15610076
156200         PERFORM 3020-FETCH-TRECVER-CSR                           15620076
156300                                                                  15630076
156400         MOVE RECVER-MAX-RCVR-NBR  TO PW-CONTROL-PANL-NBR-9       15640076
156500         DIVIDE PW-CONTROL-PANL-NBR-9 BY 9 GIVING PW-QUOTIENT     15650076
156600                                       REMAINDER  PW-REMAINDER    15660076
156700         COMPUTE PW-CONTROL-CEHCK-DIG = ( 9 - PW-REMAINDER )      15670076
156800         COMPUTE RECEIV-RCVR-NBR = PW-CONTROL-KEYREC-9 * 1        15680076
156900         ADD +1                    TO RECVER-MAX-RCVR-NBR         15690076
157000         PERFORM 3040-DELETE-TRECVER-CSR                          15700076
157100         PERFORM 3060-INSERT-TRECVER                              15710076
157200         PERFORM 3080-CLOSE-TRECVER-CSR                           15720076
157300     END-PERFORM.                                                 15730076
157400                                                                  15740076
157500     PERFORM 2340-INSERT-TRECEIV.                                 15750076
157600***  IF SQLCODE = ZERO                                            15760076
157700***      PERFORM 4900-INSERT-TPOSYNC                              15770076
157800***  END-IF                                                       15780076
157900***  PERFORM 5100-CHECK-FOR-TROUBLE                               15790076
158000                                                                  15800076
158100 2310-DETERMINE-INDICATORS.                                       15810076
158200                                                                  15820076
158300* SET PRE TICKET INDICATOR                                        15830076
158400     MOVE 4                      TO DK-AGRMT-TYP-ID.              15840076
158500     MOVE 1                      TO DK-TYP-CDE.                   15850076
158600                                                                  15860076
158700     PERFORM 2320-CHECK-PO-SERVICE-INFO.                          15870076
158800                                                                  15880076
158900     IF  PV-DB2-COUNT > +0                                        15890076
159000         MOVE 'Y'                TO RECEIV-PRE-TKT-IND            15900076
159100     ELSE                                                         15910076
159200         MOVE 'N'                TO RECEIV-PRE-TKT-IND            15920076
159300     END-IF.                                                      15930076
159400                                                                  15940076
159500                                                                  15950076
159600* SET GARMENT ON HANGER (GOH) INDICATOR                           15960076
159700     MOVE 4                      TO DK-AGRMT-TYP-ID.              15970076
159800     MOVE 2                      TO DK-TYP-CDE.                   15980076
159900                                                                  15990076
160000     PERFORM 2320-CHECK-PO-SERVICE-INFO.                          16000076
160100                                                                  16010076
160200     IF  PV-DB2-COUNT > +0                                        16020076
160300         MOVE 'Y'                TO RECEIV-GOH-IND                16030076
160400     ELSE                                                         16040076
160500         MOVE 'N'                TO RECEIV-GOH-IND                16050076
160600     END-IF.                                                      16060076
160700                                                                  16070076
160800* SET PACK BY STORE INDICATOR                                     16080076
160900     MOVE 4                      TO DK-AGRMT-TYP-ID.              16090076
161000     MOVE 4                      TO DK-TYP-CDE.                   16100076
161100                                                                  16110076
161200     PERFORM 2320-CHECK-PO-SERVICE-INFO.                          16120076
161300                                                                  16130076
161400     IF  PV-DB2-COUNT > +0                                        16140076
161500         MOVE 'Y'                TO RECEIV-PACK-BY-ST-IND         16150076
161600     ELSE                                                         16160076
161700         MOVE 'N'                TO RECEIV-PACK-BY-ST-IND         16170076
161800     END-IF.                                                      16180076
161900                                                                  16190076
162000     IF RECEIV-PACK-BY-ST-IND NOT = 'Y'                           16200076
162100         PERFORM 2330-PKGNG-CDE-FROM-PO                           16210076
162200     ELSE                                                         16220076
162300         MOVE SPACES                   TO RECEIV-PKGNG-CDE        16230076
162400     END-IF.                                                      16240076
162500                                                                  16250076
162600 2320-CHECK-PO-SERVICE-INFO.                                      16260076
162700                                                                  16270076
162800     MOVE 0        TO PV-DB2-COUNT.                               16280076
162900                                                                  16290076
163000     EXEC SQL                                                     16300076
163100          SELECT COUNT(*)                                         16310076
163200            INTO :PV-DB2-COUNT                                    16320076
163300            FROM TPOAGMT                                          16330076
163400           WHERE PO_NBR         = :DK-PO-NBR                      16340076
163500             AND AGRMT_TYP_ID   = :DK-AGRMT-TYP-ID                16350076
163600             AND VER_STATUS_CDE = 'A'                             16360076
163700             AND TYP_CDE        = :DK-TYP-CDE                     16370076
163800     END-EXEC.                                                    16380076
163900                                                                  16390076
164000     EVALUATE TRUE                                                16400076
164100         WHEN SQLCODE = +0                                        16410076
164200         WHEN SQLCODE = +100                                      16420076
164300              CONTINUE                                            16430076
164400                                                                  16440076
164500         WHEN SQLWARN0 NOT = SPACES                               16450076
164600         WHEN SQLCODE < +0                                        16460076
164700         WHEN SQLCODE > +0                                        16470076
164800             MOVE DK-PO-NBR   TO PV-DISP-PO                       16480076
164900             MOVE DK-TYP-CDE  TO PV-DISP-TYP-CDE                  16490076
165000             MOVE SQLCODE     TO PV-DISP-SQLCODE                  16500076
165100             MOVE '2320-CHECK-PO-SERVICE-INFO'                    16510076
165200                              TO RC074-ERROR-PARA-NAME            16520076
165300             SET RC074-DB-ERROR                                   16530076
165400                 PS-ERROR-YES    TO TRUE                          16540076
165500             DISPLAY '******************************************' 16550076
165600             DISPLAY '*ABEND                                   *' 16560076
165700             DISPLAY '*PROGRAM   = RCKUP009                    *' 16570076
165800             DISPLAY '*DB2 OPER  = SELECT ON TPOAGMT           *' 16580076
165900             DISPLAY '*PARAGRAPH = 2320-CHECK-PO-SERVICE-INFO  *' 16590076
166000             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                16600076
166100             DISPLAY '*PO = ' PV-DISP-PO                          16610076
166200             DISPLAY '*TYPE = ' PV-DISP-TYP-CDE                   16620076
166300             DISPLAY '*AGRMT TYP ID = ' DK-AGRMT-TYP-ID           16630076
166400             DISPLAY '******************************************' 16640076
166500     END-EVALUATE.                                                16650076
166600                                                                  16660076
166700 2330-PKGNG-CDE-FROM-PO.                                          16670076
166800                                                                  16680076
166900     EXEC SQL                                                     16690076
167000         SELECT PKGNG_CDE                                         16700076
167100           INTO :PURCHS-PKGNG-CDE                                 16710076
167200           FROM TPURCHS                                           16720076
167300          WHERE PO_NBR = :DK-PO-NBR                               16730076
167400            AND VER_STATUS_CDE = 'A'                              16740076
167500     END-EXEC.                                                    16750076
167600                                                                  16760076
167700     EVALUATE TRUE                                                16770076
167800         WHEN SQLCODE = +0                                        16780076
167900             MOVE PURCHS-PKGNG-CDE                                16790076
168000                         TO RECEIV-PKGNG-CDE                      16800076
168100         WHEN SQLCODE = +100                                      16810076
168200             MOVE SPACES TO RECEIV-PKGNG-CDE                      16820076
168300         WHEN SQLWARN0 NOT = SPACES                               16830076
168400         WHEN SQLCODE < +0                                        16840076
168500         WHEN SQLCODE > +0                                        16850076
168600             MOVE DK-PO-NBR   TO PV-DISP-PO                       16860076
168700             MOVE SQLCODE     TO PV-DISP-SQLCODE                  16870076
168800             MOVE '2330-PKGNG-CDE-FROM-PO'                        16880076
168900                              TO RC074-ERROR-PARA-NAME            16890076
169000             SET RC074-DB-ERROR                                   16900076
169100                 PS-ERROR-YES    TO TRUE                          16910076
169200             DISPLAY '******************************************' 16920076
169300             DISPLAY '*ABEND                                   *' 16930076
169400             DISPLAY '*PROGRAM   = RCKUP009                    *' 16940076
169500             DISPLAY '*DB2 OPER  = SELECT ON TPURCHS           *' 16950076
169600             DISPLAY '*PARAGRAPH = 2330-PKGNG-CDE-FROM-PO      *' 16960076
169700             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                16970076
169800             DISPLAY '*PO = ' PV-DISP-PO                          16980076
169900             DISPLAY '******************************************' 16990076
170000     END-EVALUATE.                                                17000076
170100                                                                  17010076
170200 2340-INSERT-TRECEIV.                                             17020076
170300                                                                  17030076
170400     EXEC SQL                                                     17040076
170500          INSERT INTO TRECEIV                                     17050076
170600                 ( ORD_NBR                                        17060076
170700                ,  REC_SEQ_NBR                                    17070076
170800                ,  CRE_TMST                                       17080076
170900                ,  CRE_UID                                        17090076
171000                ,  PO_VER_NBR                                     17100076
171100                ,  OPER_UNT_ID                                    17110076
171200                ,  FCLTY_ID                                       17120076
171300                ,  STATUS_CDE                                     17130076
171400                ,  SYST_CRE_CDE                                   17140076
171500                ,  REC_TYP_CDE                                    17150076
171600                ,  VER_STATUS_CDE                                 17160076
171700                ,  PACK_BY_ST_IND                                 17170076
171800                ,  REC_TMST                                       17180076
171900                ,  EXPTED_CART_CNT                                17190076
172000                ,  ACTL_CART_CNT                                  17200076
172100                ,  EXPTED_ITM_QTY                                 17210076
172200                ,  ACTL_ITM_QTY                                   17220076
172300                ,  RCVR_NBR                                       17230076
172400                ,  ML_POST_TMST                                   17240076
172500                ,  FS_POST_TMST                                   17250076
172600                ,  PRE_TKT_IND                                    17260076
172700                ,  AD_INFO_DESC                                   17270076
172800                ,  IN_TRBL_TMST                                   17280076
172900                ,  IN_TRBL_MIN_CNT                                17290076
173000                ,  IN_TRBL_HOUR_CNT                               17300076
173100                ,  VERFYD_TMST                                    17310076
173200                ,  RCVG_CLERK_INIT_ID                             17320076
173300                ,  REFER_BACK_SEQ_NBR                             17330076
173400                ,  AP_PRC_CDE                                     17340076
173500                ,  AP_PRC_DTE                                     17350076
173600                ,  MIS_DIRECT_IND                                 17360076
173700                ,  IMPRT_IND                                      17370076
173800                ,  CRE_OPER_UNT_ID                                17380076
173900                ,  CRE_FCLTY_ID                                   17390076
174000                ,  CURR_OPER_UNT_ID                               17400076
174100                ,  CURR_FCLTY_ID                                  17410076
174200                ,  UPD_TMST                                       17420076
174300                ,  UPD_UID                                        17430076
174400                ,  UPD_PGM_ID                                     17440076
174500                ,  MKNG_APRN_PRT_TMST                             17450076
174600                ,  GOH_IND                                        17460076
174700                ,  VRFD_USR_ID                                    17470076
174800                ,  AP_RVRSL_DTE                                   17480076
174900                ,  PKGNG_CDE                                      17490076
175000                ,  FRE_ASTRA_IND                                  17500076
175100                  )                                               17510076
175200         VALUES ( :RECEIV-ORD-NBR                                 17520076
175300                , :RECEIV-REC-SEQ-NBR                             17530076
175400                , CURRENT_TIMESTAMP                               17540076
175500                , :RECEIV-CRE-UID                                 17550076
175600                , :RECEIV-PO-VER-NBR                              17560076
175700                , :RECEIV-OPER-UNT-ID                             17570076
175800                , :RECEIV-FCLTY-ID                                17580076
175900                , :RECEIV-STATUS-CDE                              17590076
176000                , :RECEIV-SYST-CRE-CDE                            17600076
176100                , :RECEIV-REC-TYP-CDE                             17610076
176200                , :RECEIV-VER-STATUS-CDE                          17620076
176300                , :RECEIV-PACK-BY-ST-IND                          17630076
176400*               , :RECEIV-REC-TMST                                17640076
176500                , CURRENT_TIMESTAMP                               17650076
176600                , :RECEIV-EXPTED-CART-CNT                         17660076
176700                , :RECEIV-ACTL-CART-CNT                           17670076
176800                , :RECEIV-EXPTED-ITM-QTY                          17680076
176900                , :RECEIV-ACTL-ITM-QTY                            17690076
177000                , :RECEIV-RCVR-NBR                                17700076
177100                , :RECEIV-ML-POST-TMST                            17710076
177200                , :RECEIV-FS-POST-TMST                            17720076
177300                , :RECEIV-PRE-TKT-IND                             17730076
177400                , :RECEIV-AD-INFO-DESC                            17740076
177500                , :RECEIV-IN-TRBL-TMST                            17750076
177600                , :RECEIV-IN-TRBL-MIN-CNT                         17760076
177700                , :RECEIV-IN-TRBL-HOUR-CNT                        17770076
177800                , CURRENT_TIMESTAMP                               17780076
177900                , :RECEIV-RCVG-CLERK-INIT-ID                      17790076
178000                , :RECEIV-REFER-BACK-SEQ-NBR                      17800076
178100                , :RECEIV-AP-PRC-CDE                              17810076
178200                , '9999-09-09'                                    17820076
178300                , :RECEIV-MIS-DIRECT-IND                          17830076
178400                , :RECEIV-IMPRT-IND                               17840076
178500                , :RECEIV-CRE-OPER-UNT-ID                         17850076
178600                , :RECEIV-CRE-FCLTY-ID                            17860076
178700                , :RECEIV-CURR-OPER-UNT-ID                        17870076
178800                , :RECEIV-CURR-FCLTY-ID                           17880076
178900                , CURRENT_TIMESTAMP                               17890076
179000                , :RECEIV-UPD-UID                                 17900076
179100                , :RECEIV-UPD-PGM-ID                              17910076
179200                , :RECEIV-MKNG-APRN-PRT-TMST                      17920076
179300                , :RECEIV-GOH-IND                                 17930076
179400                , :RECEIV-VRFD-USR-ID                             17940076
179500                , '9999-09-09'                                    17950076
179600                , :RECEIV-PKGNG-CDE                               17960076
179700                , :RECEIV-FRE-ASTRA-IND                           17970076
179800                 )                                                17980076
179900     END-EXEC.                                                    17990076
180000                                                                  18000076
180100     EVALUATE TRUE                                                18010076
180200         WHEN SQLCODE = +0                                        18020076
180300              MOVE +1       TO PT-TOTAL-TRECEIV-INSERTS           18030076
180320*                                                                 18032099
180330*** DMH - 10/16/13 BEGIN                                          18033099
180340             SET  PS-PO-RECEIVER-CREATED  TO  TRUE                18034099
180350*** DMH - 10/16/13 END                                            18035099
180360*                                                                 18036099
180400         WHEN SQLWARN0 NOT = SPACE                                18040076
180500         WHEN SQLCODE < +0                                        18050076
180600         WHEN SQLCODE > +0                                        18060076
180700             MOVE RECEIV-ORD-NBR  TO PV-DISP-PO                   18070076
180800             MOVE RECEIV-REC-SEQ-NBR TO PV-DISP-REC-SEQ           18080076
180900             MOVE SQLCODE TO PV-DISP-SQLCODE                      18090076
181000             MOVE '2340-INSERT-TRECEIV'                           18100076
181100                              TO RC074-ERROR-PARA-NAME            18110076
181200             SET RC074-DB-ERROR                                   18120076
181300                 PS-ERROR-YES    TO TRUE                          18130076
181400             DISPLAY '******************************************' 18140076
181500             DISPLAY '*ABEND                                   *' 18150076
181600             DISPLAY '*PROGRAM   = RCKUP009                    *' 18160076
181700             DISPLAY '*DB2 OPER  = INSERT ON TRECEIV           *' 18170076
181800             DISPLAY '*PARAGRAPH = 2340-INSERT-TRECEIV         *' 18180076
181900             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                18190076
182000             DISPLAY '*PO = ' PV-DISP-PO                          18200076
182100             DISPLAY '*RECEIVER = ' PV-DISP-REC-SEQ               18210076
182200             DISPLAY '******************************************' 18220076
182300                                                                  18230076
182400     END-EVALUATE.                                                18240076
182500                                                                  18250076
182600 2350-UPDATE-RECEIVER-INFO.                                       18260076
182700     PERFORM 2360-SELECT-TRECEIV.                                 18270076
182800     COMPUTE RECEIV-EXPTED-ITM-QTY = RECEIV-EXPTED-ITM-QTY +      18280076
182900                RC074-QTY-RCVD.                                   18290076
183000     COMPUTE RECEIV-ACTL-ITM-QTY = RECEIV-ACTL-ITM-QTY +          18300076
183100                RC074-QTY-RCVD.                                   18310076
183200     PERFORM 2370-UPDATE-TRECEIV.                                 18320076
183300                                                                  18330076
183400 2360-SELECT-TRECEIV.                                             18340076
183500     EXEC SQL                                                     18350076
183600          SELECT EXPTED_ITM_QTY                                   18360076
183700                ,ACTL_ITM_QTY                                     18370076
183800            INTO :RECEIV-EXPTED-ITM-QTY                           18380076
183900                ,:RECEIV-ACTL-ITM-QTY                             18390076
184000            FROM TRECEIV                                          18400076
184100           WHERE ORD_NBR     = :DK-PO-NBR                         18410076
184200             AND REC_SEQ_NBR = :PV-REC-SEQ-NBR                    18420076
184300             AND VER_STATUS_CDE = 'A'                             18430076
184400     END-EXEC.                                                    18440076
184500                                                                  18450076
184600     EVALUATE TRUE                                                18460076
184700         WHEN SQLCODE = ZERO                                      18470076
184800              CONTINUE                                            18480076
184900                                                                  18490076
185000         WHEN SQLWARN0 NOT = SPACES                               18500076
185100         WHEN SQLCODE  NOT = ZERO                                 18510076
185200             MOVE DK-PO-NBR         TO PV-DISP-PO                 18520076
185300             MOVE PV-REC-SEQ-NBR     TO PV-DISP-REC-SEQ           18530076
185400             MOVE SQLCODE TO PV-DISP-SQLCODE                      18540076
185500             MOVE '2360-SELECT-TRECEIV'                           18550076
185600                              TO RC074-ERROR-PARA-NAME            18560076
185700             SET RC074-DB-ERROR                                   18570076
185800                 PS-ERROR-YES    TO TRUE                          18580076
185900             DISPLAY '******************************************' 18590076
186000             DISPLAY '*ABEND                                   *' 18600076
186100             DISPLAY '*PROGRAM   = RCKUP009                    *' 18610076
186200             DISPLAY '*DB2 OPER  = SELECT TRECEIV              *' 18620076
186300             DISPLAY '*PARAGRAPH = 2360-SELECT-TRECEIV         *' 18630076
186400             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                18640076
186500             DISPLAY '*PO = ' PV-DISP-PO                          18650076
186600             DISPLAY '*RECEIVER = ' PV-DISP-REC-SEQ               18660076
186700             DISPLAY '******************************************' 18670076
186800     END-EVALUATE.                                                18680076
186900                                                                  18690076
187000 2370-UPDATE-TRECEIV.                                             18700076
187100     EXEC SQL                                                     18710076
187200       UPDATE TRECEIV                                             18720076
187300          SET   EXPTED_ITM_QTY     = :RECEIV-EXPTED-ITM-QTY       18730076
187400              , ACTL_ITM_QTY       = :RECEIV-ACTL-ITM-QTY         18740076
187500           WHERE ORD_NBR        = :DK-PO-NBR                      18750076
187600             AND REC_SEQ_NBR    = :PV-REC-SEQ-NBR                 18760076
187700             AND VER_STATUS_CDE = 'A'                             18770076
187800     END-EXEC.                                                    18780076
187900                                                                  18790076
188000     EVALUATE TRUE                                                18800076
188100         WHEN SQLCODE = ZERO                                      18810076
188200              MOVE +1       TO PT-TOTAL-TRECEIV-UPDATES           18820076
188300                                                                  18830076
188400         WHEN SQLWARN0 NOT = SPACES                               18840076
188500         WHEN SQLCODE  NOT = ZERO                                 18850076
188600             MOVE DK-PO-NBR         TO PV-DISP-PO                 18860076
188700             MOVE PV-REC-SEQ-NBR     TO PV-DISP-REC-SEQ           18870076
188800             MOVE SQLCODE TO PV-DISP-SQLCODE                      18880076
188900             MOVE '2370-UPDATE-TRECEIV'                           18890076
189000                              TO RC074-ERROR-PARA-NAME            18900076
189100             SET RC074-DB-ERROR                                   18910076
189200                 PS-ERROR-YES    TO TRUE                          18920076
189300             DISPLAY '******************************************' 18930076
189400             DISPLAY '*ABEND                                   *' 18940076
189500             DISPLAY '*PROGRAM   = RCKUP009                    *' 18950076
189600             DISPLAY '*DB2 OPER  = UPDATE TRECEIV              *' 18960076
189700             DISPLAY '*PARAGRAPH = 2370-UPDATE-TRECEIV         *' 18970076
189800             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                18980076
189900             DISPLAY '*PO = ' PV-DISP-PO                          18990076
190000             DISPLAY '*RECEIVER = ' PV-DISP-REC-SEQ               19000076
190100             DISPLAY '******************************************' 19010076
190200     END-EVALUATE.                                                19020076
190300                                                                  19030076
190400 2400-ADD-RECITM.                                                 19040076
190500     PERFORM 2410-SETUP-RECITM-FIELDS.                            19050076
190600     PERFORM 2420-INSERT-RECITM.                                  19060076
190700                                                                  19070076
190800 2410-SETUP-RECITM-FIELDS.                                        19080076
190900                                                                  19090076
191000     INITIALIZE DCLTRECITM.                                       19100076
191100                                                                  19110076
191200     MOVE PURITM-APP-PO-LNE-NBR   TO RECITM-ORD-LNE-NBR.          19120076
191300                                                                  19130076
191400     MOVE PV-REC-SEQ-NBR         TO RECITM-REC-SEQ-NBR.           19140076
191500     MOVE RC074-STR-NBR          TO RECITM-OPER-UNT-ID.           19150076
191600     MOVE 1                      TO RECITM-FCLTY-ID.              19160076
191700                                                                  19170076
191800     MOVE PURITM-VER-NBR         TO RECITM-PO-VER-NBR.            19180076
191900     MOVE PURITM-ITM-NBR         TO RECITM-ITM-NBR.               19190076
192000     MOVE PURITM-UNT-RTL-PR-AMT  TO RECITM-UNT-RTL-AMT            19200076
192100     MOVE PURITM-UNT-COST-AMT    TO RECITM-UNT-COST-AMT           19210076
192200     MOVE PURITM-GP-RTL-AMT      TO RECITM-GP-RTL-AMT             19220076
192300     MOVE PURITM-GP-QTY          TO RECITM-GP-QTY                 19230076
192400     MOVE RECEIV-PRE-TKT-IND     TO RECITM-PRE-TKT-IND.           19240076
192500     MOVE SPACES                 TO RECITM-TKT-FMT-ID.            19250076
192600     MOVE 'VE'                   TO RECITM-STATUS-CDE.            19260076
192700     MOVE 1                      TO RECITM-EXPTED-CART-CNT.       19270076
192800     MOVE RC074-QTY-RCVD         TO RECITM-PKSL-ITM-QTY           19280076
192900                                    RECITM-DTL-CK-ITM-QTY.        19290076
193000     MOVE ZERO                   TO RECITM-ACTL-CART-CNT.         19300076
193100     MOVE '9999-09-09-09.09.09.999999'                            19310076
193200                                 TO RECITM-MKING-APRON-TMST       19320076
193300                                    RECITM-UPD-TMST.              19330076
193400                                                                  19340076
193500     INITIALIZE                     RECITM-PREPK-ID               19350076
193600                                    RECITM-PREPK-DRV-LNE-CDE      19360076
193700                                    RECITM-PREPK-RATO-QTY         19370076
193800                                    RECITM-PREPK-ODD-UNT-QTY.     19380076
193900                                                                  19390076
194000 2420-INSERT-RECITM.                                              19400076
194100                                                                  19410076
194200     EXEC SQL                                                     19420076
194300         INSERT INTO TRECITM                                      19430076
194400               (ORD_NBR                                           19440076
194500             ,  ORD_LNE_NBR                                       19450076
194600             ,  REC_SEQ_NBR                                       19460076
194700             ,  OPER_UNT_ID                                       19470076
194800             ,  FCLTY_ID                                          19480076
194900             ,  CRE_TMST                                          19490076
195000             ,  CRE_UID                                           19500076
195100             ,  PO_VER_NBR                                        19510076
195200             ,  ITM_NBR                                           19520076
195300             ,  PRE_TKT_IND                                       19530076
195400             ,  TKT_FMT_ID                                        19540076
195500             ,  RTV_IND                                           19550076
195600             ,  STATUS_CDE                                        19560076
195700             ,  VER_STATUS_CDE                                    19570076
195800             ,  PKSL_ITM_QTY                                      19580076
195900             ,  DTL_CK_ITM_QTY                                    19590076
196000             ,  INNR_PACK_QTY                                     19600076
196100             ,  CASE_PACK_QTY                                     19610076
196200             ,  RTV_QTY                                           19620076
196300             ,  EXPTED_CART_CNT                                   19630076
196400             ,  ACTL_CART_CNT                                     19640076
196500             ,  MKING_APRON_TMST                                  19650076
196600             ,  UNT_COST_AMT                                      19660076
196700             ,  COLOR_DESC                                        19670076
196800             ,  SIZE_DESC                                         19680076
196900             ,  VEND_STYL_NAME                                    19690076
197000             ,  VEND_DESC                                         19700076
197100             ,  VERFYD_TMST                                       19710076
197200             ,  PKSL_NBR                                          19720076
197300             ,  REC_INV_LNE_NBR                                   19730076
197400             ,  DMG_ITM_QTY                                       19740076
197500             ,  UPD_TMST                                          19750076
197600             ,  UPD_UID                                           19760076
197700             ,  UPD_PGM_ID                                        19770076
197800             ,  RCPT_DISTR_UPD_CDE                                19780076
197900             ,  LAST_TRSCP_TMST                                   19790076
198000             ,  LAST_TRSCP_USR_ID                                 19800076
198100             ,  PREPK_ID                                          19810076
198200             ,  PREPK_RATO_QTY                                    19820076
198300             ,  PREPK_ODD_UNT_QTY                                 19830076
198400             ,  PREPK_DRV_LNE_CDE                                 19840076
198500             ,  UNT_RTL_AMT                                       19850076
198600             ,  GP_RTL_AMT                                        19860076
198700             ,  GP_QTY                                            19870076
198800             ,  ORIG_PKSL_ITM_QTY)                                19880076
198900        VALUES (:DK-PO-NBR                                        19890076
199000             ,  :RECITM-ORD-LNE-NBR                               19900076
199100             ,  :RECITM-REC-SEQ-NBR                               19910076
199200             ,  :RECITM-OPER-UNT-ID                               19920076
199300             ,  :RECITM-FCLTY-ID                                  19930076
199400             ,   CURRENT_TIMESTAMP                                19940076
199500             ,  :PC-E-COMM-DIRECT-SHIP                            19950076
199600             ,  :RECITM-PO-VER-NBR                                19960076
199700             ,  :RECITM-ITM-NBR                                   19970076
199800             ,  :RECITM-PRE-TKT-IND                               19980076
199900             ,  :RECITM-TKT-FMT-ID                                19990076
200000             ,  :RECITM-RTV-IND                                   20000076
200100             ,  :RECITM-STATUS-CDE                                20010076
200200             ,  'A'                                               20020076
200300             ,  :RECITM-PKSL-ITM-QTY                              20030076
200400             ,  :RECITM-DTL-CK-ITM-QTY                            20040076
200500             ,  :RECITM-INNR-PACK-QTY                             20050076
200600             ,  :RECITM-CASE-PACK-QTY                             20060076
200700             ,  :RECITM-RTV-QTY                                   20070076
200800             ,  :RECITM-EXPTED-CART-CNT                           20080076
200900             ,  :RECITM-ACTL-CART-CNT                             20090076
201000             ,  :RECITM-MKING-APRON-TMST                          20100076
201100             ,  :RECITM-UNT-COST-AMT                              20110076
201200             ,  :RECITM-COLOR-DESC                                20120076
201300             ,  :RECITM-SIZE-DESC                                 20130076
201400             ,  :RECITM-VEND-STYL-NAME                            20140076
201500             ,  :RECITM-VEND-DESC                                 20150076
201600             ,  CURRENT_TIMESTAMP                                 20160076
201700             ,  :RECITM-PKSL-NBR                                  20170076
201800             ,  :RECITM-REC-INV-LNE-NBR                           20180076
201900             ,  :RECITM-DMG-ITM-QTY                               20190076
202000             ,  :RECITM-UPD-TMST                                  20200076
202100             ,  :RECITM-UPD-UID                                   20210076
202200             ,  :RECITM-UPD-PGM-ID                                20220076
202300             ,  :RECITM-RCPT-DISTR-UPD-CDE                        20230076
202400             ,   CURRENT_TIMESTAMP                                20240076
202500             ,  :PC-CURRENT-PROGRAM-NAME                          20250076
202600             ,  :RECITM-PREPK-ID                                  20260076
202700             ,  :RECITM-PREPK-RATO-QTY                            20270076
202800             ,  :RECITM-PREPK-ODD-UNT-QTY                         20280076
202900             ,  :RECITM-PREPK-DRV-LNE-CDE                         20290076
203000             ,  :RECITM-UNT-RTL-AMT                               20300076
203100             ,  :RECITM-GP-RTL-AMT                                20310076
203200             ,  :RECITM-GP-QTY                                    20320076
203300             ,  0)                                                20330076
203400     END-EXEC.                                                    20340076
203500                                                                  20350076
203600     EVALUATE TRUE                                                20360076
203700         WHEN SQLCODE = ZERO                                      20370076
203800              MOVE +1       TO PT-TOTAL-TRECITM-INSERTS           20380076
203900                                                                  20390076
204000         WHEN SQLWARN0 NOT = SPACES                               20400076
204100         WHEN SQLCODE  NOT = ZERO                                 20410076
204200             MOVE DK-PO-NBR         TO PV-DISP-PO                 20420076
204300             MOVE RECITM-REC-SEQ-NBR TO PV-DISP-REC-SEQ           20430076
204400             MOVE RECITM-ORD-LNE-NBR TO PV-DISP-LINE-NBR          20440076
204500             MOVE SQLCODE TO PV-DISP-SQLCODE                      20450076
204600             MOVE '2420-INSERT-RECITM'                            20460076
204700                              TO RC074-ERROR-PARA-NAME            20470076
204800             SET RC074-DB-ERROR                                   20480076
204900                 PS-ERROR-YES    TO TRUE                          20490076
205000             DISPLAY '******************************************' 20500076
205100             DISPLAY '*ABEND                                   *' 20510076
205200             DISPLAY '*PROGRAM   = RCKUP009                    *' 20520076
205300             DISPLAY '*DB2 OPER  = INSERT ON TRECITM           *' 20530076
205400             DISPLAY '*PARAGRAPH = 2420-INSERT-RECITM          *' 20540076
205500             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                20550076
205600             DISPLAY '*PO = ' PV-DISP-PO                          20560076
205700             DISPLAY '*RECEIVER = ' PV-DISP-REC-SEQ               20570076
205800             DISPLAY '*LINE = ' PV-DISP-LINE-NBR                  20580076
205900             DISPLAY '******************************************' 20590076
206000     END-EVALUATE.                                                20600076
206100                                                                  20610076
206200 2500-PREPARE-TRECDIS.                                            20620076
206300     PERFORM 2510-SETUP-TRECDIS-FIELDS.                           20630076
206400     PERFORM 2520-INSERT-TRECDIS.                                 20640076
206500                                                                  20650076
206600 2510-SETUP-TRECDIS-FIELDS.                                       20660076
206700                                                                  20670076
206800     INITIALIZE DCLTRECDIS.                                       20680076
206900                                                                  20690076
207000     MOVE RC074-PO-NUMBER    TO RECDIS-ORD-NBR.                   20700076
207100     MOVE PURITM-APP-PO-LNE-NBR                                   20710076
207200                             TO RECDIS-ORD-LNE-NBR.               20720076
207300     MOVE PV-REC-SEQ-NBR     TO RECDIS-REC-SEQ-NBR.               20730076
207400     MOVE RC074-STR-NBR      TO RECDIS-OPER-UNT-ID.               20740076
207500     MOVE PC-E-COMM-DIRECT-SHIP                                   20750076
207600                             TO RECDIS-CRE-UID.                   20760076
207700     MOVE 'A'                TO RECDIS-VER-STATUS-CDE.            20770076
207800     MOVE RC074-QTY-RCVD     TO RECDIS-EXPTED-ITM-QTY             20780076
207900                                RECDIS-VERIFY-ITM-QTY             20790076
208000                                RECDIS-AP-VERIFY-ITM-QTY.         20800076
208100     MOVE RC074-STR-NBR      TO RECDIS-STR-NBR.                   20810076
208200     MOVE 1                  TO RECDIS-FCLTY-ID.                  20820076
208300     MOVE 1                  TO RECDIS-STR-FCLTY-ID.              20830076
208400                                                                  20840076
208500     MOVE '9999-09-09'       TO RECDIS-AP-PRC-DTE.                20850076
208600                                                                  20860076
208700                                                                  20870076
208800 2520-INSERT-TRECDIS.                                             20880076
208900                                                                  20890076
209000     EXEC SQL                                                     20900076
209100          INSERT INTO TRECDIS                                     20910076
209200                 (ORD_NBR                                         20920076
209300               ,  ORD_LNE_NBR                                     20930076
209400               ,  REC_SEQ_NBR                                     20940076
209500               ,  OPER_UNT_ID                                     20950076
209600               ,  FCLTY_ID                                        20960076
209700               ,  CRE_TMST                                        20970076
209800               ,  CRE_UID                                         20980076
209900               ,  VER_STATUS_CDE                                  20990076
210000               ,  EXPTED_ITM_QTY                                  21000076
210100               ,  VERIFY_ITM_QTY                                  21010076
210200               ,  AP_VERIFY_ITM_QTY                               21020076
210300               ,  STR_NBR                                         21030076
210400               ,  STR_FCLTY_ID                                    21040076
210500               ,  PLAN_ITM_QTY                                    21050076
210600               ,  AP_PRC_CDE                                      21060076
210700               ,  AP_PRC_DTE)                                     21070076
210800          VALUES (:RECDIS-ORD-NBR                                 21080076
210900               ,  :RECDIS-ORD-LNE-NBR                             21090076
211000               ,  :RECDIS-REC-SEQ-NBR                             21100076
211100               ,  :RECDIS-OPER-UNT-ID                             21110076
211200               ,  :RECDIS-FCLTY-ID                                21120076
211300               ,  CURRENT_TIMESTAMP                               21130076
211400               ,  :RECDIS-CRE-UID                                 21140076
211500               ,  :RECDIS-VER-STATUS-CDE                          21150076
211600               ,  :RECDIS-EXPTED-ITM-QTY                          21160076
211700               ,  :RECDIS-VERIFY-ITM-QTY                          21170076
211800               ,  :RECDIS-AP-VERIFY-ITM-QTY                       21180076
211900               ,  :RECDIS-STR-NBR                                 21190076
212000               ,  :RECDIS-STR-FCLTY-ID                            21200076
212100               ,  :RECDIS-PLAN-ITM-QTY                            21210076
212200               ,  :RECDIS-AP-PRC-CDE                              21220076
212300               ,  :RECDIS-AP-PRC-DTE)                             21230076
212400     END-EXEC.                                                    21240076
212500                                                                  21250076
212600     EVALUATE TRUE                                                21260076
212700         WHEN SQLCODE = +0                                        21270076
212800              MOVE +1       TO PT-TOTAL-TRECDIS-INSERTS           21280076
212900                                                                  21290076
213000         WHEN OTHER                                               21300076
213100             MOVE RECDIS-ORD-NBR    TO PV-DISP-PO                 21310076
213200             MOVE RECDIS-REC-SEQ-NBR TO PV-DISP-REC-SEQ           21320076
213300             MOVE RECDIS-ORD-LNE-NBR TO PV-DISP-LINE-NBR          21330076
213400             MOVE RECDIS-STR-NBR     TO PV-DISP-STR-NBR           21340076
213500             MOVE SQLCODE TO PV-DISP-SQLCODE                      21350076
213600             MOVE '2510-INSERT-TRECDIS'                           21360076
213700                              TO RC074-ERROR-PARA-NAME            21370076
213800             SET RC074-DB-ERROR                                   21380076
213900                 PS-ERROR-YES    TO TRUE                          21390076
214000             DISPLAY '******************************************' 21400076
214100             DISPLAY '*ABEND                                   *' 21410076
214200             DISPLAY '*PROGRAM   = RCKUP009                    *' 21420076
214300             DISPLAY '*DB2 OPER  = INSERT TRECDIS              *' 21430076
214400             DISPLAY '*PARAGRAPH = 2520-INSERT-TRECDIS         *' 21440076
214500             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                21450076
214600             DISPLAY '*PO = ' PV-DISP-PO                          21460076
214700             DISPLAY '*RECEIVER = ' PV-DISP-REC-SEQ               21470076
214800             DISPLAY '*LINE = ' PV-DISP-LINE-NBR                  21480076
214900             DISPLAY '*STORE = ' PV-DISP-STR-NBR                  21490076
215000             DISPLAY '******************************************' 21500076
215100     END-EVALUATE.                                                21510076
215200                                                                  21520076
215300 2600-INSERT-WFT-LOD-CNTL.                                        21530076
215400                                                                  21540076
215500     INITIALIZE DCLWFT00001.                                      21550076
215600     INITIALIZE DCLWFT00002.                                      21560076
215700                                                                  21570076
215800     EXEC SQL                                                     21580076
215900         SET :WFT00002-PRC-CNTL-TMST = CURRENT TIMESTAMP          21590076
216000     END-EXEC.                                                    21600076
216100                                                                  21610076
216200                                                                  21620076
216300     EXEC SQL                                                     21630076
216400         INSERT INTO WFT_LOD_CNTL                                 21640076
216500             ( PRC_CNTL_TMST                                      21650076
216600             , TRN_TYP_CDE                                        21660076
216700             , STAT_CDE                                           21670076
216800             , INIT_PRCG_BEG_TMST                                 21680076
216900             , END_TMST                                           21690076
217000             , ARCH_DAT_IND                                       21700076
217100             , DAT_LOD_VER_NBR                                    21710076
217200             , STR_NBR)                                           21720076
217300         VALUES                                                   21730076
217400             ( :WFT00002-PRC-CNTL-TMST                            21740076
217500             , 'SKUVER'                                           21750076
217600             , 'READY'                                            21760076
217700             , '0001-01-01-00.00.00.000000'                       21770076
217800             , '0001-01-01-00.00.00.000000'                       21780076
217900             , ' '                                                21790076
218000             , 0                                                  21800076
218100             , 0999                                               21810076
218200             )                                                    21820076
218300     END-EXEC.                                                    21830076
218400                                                                  21840076
218500     EVALUATE TRUE                                                21850076
218600        WHEN SQLCODE = +0                                         21860076
218700              MOVE +1       TO PT-TOTAL-WFT-CNTL-INSERTS          21870076
218800        WHEN SQLWARN0 NOT = SPACES                                21880076
218900        WHEN SQLCODE < +0                                         21890076
219000        WHEN SQLCODE > +0                                         21900076
219100             MOVE SQLCODE TO PV-DISP-SQLCODE                      21910076
219200             MOVE '2600-INSERT-WFT-LOD-CNTL'                      21920076
219300                              TO RC074-ERROR-PARA-NAME            21930076
219400             SET RC074-DB-ERROR                                   21940076
219500                 PS-ERROR-YES    TO TRUE                          21950076
219600             DISPLAY '******************************************' 21960076
219700             DISPLAY '*ABEND                                   *' 21970076
219800             DISPLAY '*PROGRAM   = RCKUP009                    *' 21980076
219900             DISPLAY '*DB2 OPER  = INSERT ON WFT_LOD_CNTL      *' 21990076
220000             DISPLAY '*PARAGRAPH = 2600-INSERT-WFT-LOD-CNTL    *' 22000076
220100             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                22010076
220200             DISPLAY '*TIMESTAMP = ' WFT00002-PRC-CNTL-TMST       22020076
220300             DISPLAY '******************************************' 22030076
220400     END-EVALUATE.                                                22040076
220500                                                                  22050076
220600 2700-INSERT-WFT-LOD-XFER.                                        22060076
220700                                                                  22070076
220800     INITIALIZE WFT00002-LOD-DAT-TXT.                             22080076
220900                                                                  22090076
221000     MOVE RC074-PO-NUMBER   TO PV-ORDER-NUMBER.                   22100076
221100     MOVE RC074-SKU         TO PV-SKU.                            22110076
221200     MOVE PV-REC-SEQ-NBR    TO PV-RCVR-ID.                        22120076
221300     MOVE RC074-STR-NBR     TO PV-DC.                             22130076
221400                                                                  22140076
221500     EXEC SQL                                                     22150076
221600          SET :PV-DB2-TMST         =  CURRENT_TIMESTAMP           22160076
221700     END-EXEC.                                                    22170076
221800                                                                  22180076
221900     MOVE PV-DB2-TMST-CCYY  TO PV-VRFY-DATE (1:4).                22190076
222000     MOVE PV-DB2-TMST-MO    TO PV-VRFY-DATE (5:2).                22200076
222100     MOVE PV-DB2-TMST-DA    TO PV-VRFY-DATE (7:2).                22210076
222200     MOVE PV-DB2-TMST-HH    TO PV-VRFY-DATE (9:2).                22220076
222300     MOVE PV-DB2-TMST-MM    TO PV-VRFY-DATE (11:2).               22230076
222400     MOVE PV-DB2-TMST-SS    TO PV-VRFY-DATE (13:2).               22240076
222500     MOVE 1                 TO PV-STORE-COUNT.                    22250076
222600     MOVE RC074-STR-NBR     TO PV-STORE (1).                      22260076
222700     MOVE RC074-QTY-RCVD    TO PV-STORE-QTY (1).                  22270076
222800     MOVE 'P'               TO PV-STORE-QTY-SIGN (1).             22280076
222900     MOVE LENGTH OF PV-RECEIPT-ADJUSTMENT-REC TO                  22290076
223000        WFT00002-LOD-DAT-TXT-LEN.                                 22300076
223100                                                                  22310076
223200     MOVE PV-RECEIPT-ADJUSTMENT-REC TO                            22320076
223300        WFT00002-LOD-DAT-TXT-TEXT.                                22330076
223400                                                                  22340076
223500                                                                  22350076
223600     EXEC SQL                                                     22360076
223700         INSERT INTO WFT_LOD_XFER                                 22370076
223800             ( PRC_CNTL_TMST                                      22380076
223900             , TRN_TYP_CDE                                        22390076
224000             , BTCH_LOD_SEQ_ID                                    22400076
224100             , LOD_DAT_TXT                                        22410076
224200             )                                                    22420076
224300         VALUES                                                   22430076
224400             (:WFT00002-PRC-CNTL-TMST                             22440076
224500             , 'SKUVER'                                           22450076
224600             , 1                                                  22460076
224700             , :WFT00002-LOD-DAT-TXT                              22470076
224800             )                                                    22480076
224900     END-EXEC.                                                    22490076
225000                                                                  22500076
225100     EVALUATE TRUE                                                22510076
225200        WHEN SQLCODE = +0                                         22520076
225300              MOVE +1       TO PT-TOTAL-WFT-XFER-INSERTS          22530076
225400        WHEN SQLWARN0 NOT = SPACES                                22540076
225500        WHEN SQLCODE < +0                                         22550076
225600        WHEN SQLCODE > +0                                         22560076
225700             MOVE SQLCODE TO PV-DISP-SQLCODE                      22570076
225800             MOVE '2700-INSERT-WFT-LOD-XFER'                      22580076
225900                              TO RC074-ERROR-PARA-NAME            22590076
226000             SET RC074-DB-ERROR                                   22600076
226100                 PS-ERROR-YES    TO TRUE                          22610076
226200             DISPLAY '******************************************' 22620076
226300             DISPLAY '*ABEND                                   *' 22630076
226400             DISPLAY '*PROGRAM   = RCKUP009                    *' 22640076
226500             DISPLAY '*DB2 OPER  = INSERT ON WFT_LOD_XFER      *' 22650076
226600             DISPLAY '*PARAGRAPH = 2700-INSERT-WFT-LOD-XFER    *' 22660076
226700             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                22670076
226800             DISPLAY '*TIMESTAMP = ' WFT00002-PRC-CNTL-TMST       22680076
226900             DISPLAY '******************************************' 22690076
227000     END-EVALUATE.                                                22700076
227100*----------------------------------------------------------------*22710076
227200* OPEN THE TRECVER CURSOR                                        *22720076
227300*----------------------------------------------------------------*22730076
227400                                                                  22740076
227500 3000-OPEN-TRECVER-CSR.                                           22750076
227600                                                                  22760076
227700     EXEC SQL                                                     22770076
227800          DECLARE TRECVER-CSR CURSOR FOR                          22780076
227900           SELECT MAX_RCVR_NBR                                    22790076
228000           FROM   TRECVER                                         22800076
228100           WHERE  OPERCO_NBR = '03'                               22810076
228200           FOR UPDATE OF MAX_RCVR_NBR                             22820076
228300     END-EXEC.                                                    22830076
228400                                                                  22840076
228500     EXEC SQL                                                     22850076
228600          OPEN TRECVER-CSR                                        22860076
228700     END-EXEC.                                                    22870076
228800                                                                  22880076
228900     EVALUATE TRUE                                                22890076
229000         WHEN SQLCODE = +0                                        22900076
229100              CONTINUE                                            22910076
229200         WHEN SQLWARN0 NOT = SPACE                                22920076
229300         WHEN SQLCODE  NOT = +0                                   22930076
229400             MOVE SQLCODE TO PV-DISP-SQLCODE                      22940076
229500             MOVE '3000-OPEN-TRECVER-CSR'                         22950076
229600                              TO RC074-ERROR-PARA-NAME            22960076
229700             SET RC074-DB-ERROR                                   22970076
229800                 PS-ERROR-YES    TO TRUE                          22980076
229900             DISPLAY '******************************************' 22990076
230000             DISPLAY '*ABEND                                   *' 23000076
230100             DISPLAY '*PROGRAM   = RCKUP009                    *' 23010076
230200             DISPLAY '*DB2 OPER  = OPEN TRECVER CURSOR         *' 23020076
230300             DISPLAY '*PARAGRAPH = 3000-OPEN-TRECVER-CSR       *' 23030076
230400             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                23040076
230500             DISPLAY '******************************************' 23050076
230600     END-EVALUATE.                                                23060076
230700                                                                  23070076
230800/                                                                 23080076
230900*----------------------------------------------------------------*23090076
231000*    FETCH A TRECVER ROW                                         *23100076
231100*----------------------------------------------------------------*23110076
231200                                                                  23120076
231300 3020-FETCH-TRECVER-CSR.                                          23130076
231400                                                                  23140076
231500     EXEC SQL                                                     23150076
231600          FETCH TRECVER-CSR                                       23160076
231700          INTO :RECVER-MAX-RCVR-NBR                               23170076
231800     END-EXEC.                                                    23180076
231900                                                                  23190076
232000     EVALUATE TRUE                                                23200076
232100         WHEN SQLCODE = +0                                        23210076
232200              CONTINUE                                            23220076
232300                                                                  23230076
232400         WHEN SQLCODE = +100                                      23240076
232500              SET PS-EOF-TRECVER-CSR TO TRUE                      23250076
232600                                                                  23260076
232700         WHEN SQLWARN0 NOT = SPACE                                23270076
232800         WHEN SQLCODE < +0                                        23280076
232900         WHEN SQLCODE > +0                                        23290076
233000             MOVE SQLCODE TO PV-DISP-SQLCODE                      23300076
233100             MOVE '3020-FETCH-TRECVER-CSR'                        23310076
233200                              TO RC074-ERROR-PARA-NAME            23320076
233300             SET RC074-DB-ERROR                                   23330076
233400                 PS-ERROR-YES    TO TRUE                          23340076
233500             DISPLAY '******************************************' 23350076
233600             DISPLAY '*ABEND                                   *' 23360076
233700             DISPLAY '*PROGRAM   = RCKUP009                    *' 23370076
233800             DISPLAY '*DB2 OPER  = FETCH TRECVER CURSOR        *' 23380076
233900             DISPLAY '*PARAGRAPH = 3020-FETCH-TRECVER-CSR      *' 23390076
234000             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                23400076
234100             DISPLAY '******************************************' 23410076
234200     END-EVALUATE.                                                23420076
234300                                                                  23430076
234400/                                                                 23440076
234500*----------------------------------------------------------------*23450076
234600*    UDPATE CURRENT CURSOR                                       *23460076
234700*----------------------------------------------------------------*23470076
234800                                                                  23480076
234900 3040-DELETE-TRECVER-CSR.                                         23490076
235000                                                                  23500076
235100     EXEC SQL                                                     23510076
235200          DELETE FROM TRECVER                                     23520076
235300            WHERE CURRENT OF TRECVER-CSR                          23530076
235400     END-EXEC                                                     23540076
235500                                                                  23550076
235600     EVALUATE TRUE                                                23560076
235700         WHEN SQLCODE = +0                                        23570076
235800              CONTINUE                                            23580076
235900                                                                  23590076
236000         WHEN SQLWARN0 NOT = SPACE                                23600076
236100         WHEN SQLCODE < +0                                        23610076
236200         WHEN SQLCODE > +0                                        23620076
236300             MOVE SQLCODE TO PV-DISP-SQLCODE                      23630076
236400             MOVE '3040-DELETE-TRECVER-CSR'                       23640076
236500                              TO RC074-ERROR-PARA-NAME            23650076
236600             SET RC074-DB-ERROR                                   23660076
236700                 PS-ERROR-YES    TO TRUE                          23670076
236800             DISPLAY '******************************************' 23680076
236900             DISPLAY '*ABEND                                   *' 23690076
237000             DISPLAY '*PROGRAM   = RCKUP009                    *' 23700076
237100             DISPLAY '*DB2 OPER  = DELETE TRECVER CURSOR       *' 23710076
237200             DISPLAY '*PARAGRAPH = 3040-DELETE-TRECVER-CSR     *' 23720076
237300             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                23730076
237400             DISPLAY '******************************************' 23740076
237500     END-EVALUATE.                                                23750076
237600                                                                  23760076
237700/                                                                 23770076
237800*----------------------------------------------------------------*23780076
237900* INSERT THE TRECVER ROW                                         *23790076
238000*----------------------------------------------------------------*23800076
238100                                                                  23810076
238200 3060-INSERT-TRECVER.                                             23820076
238300                                                                  23830076
238400     EXEC SQL                                                     23840076
238500          INSERT INTO TRECVER                                     23850076
238600                 ( OPERCO_NBR                                     23860076
238700                ,  MAX_RCVR_NBR )                                 23870076
238800          VALUES ( '03'                                           23880076
238900                ,  :RECVER-MAX-RCVR-NBR )                         23890076
239000     END-EXEC.                                                    23900076
239100                                                                  23910076
239200     EVALUATE TRUE                                                23920076
239300         WHEN SQLCODE = +0                                        23930076
239400         WHEN SQLCODE = -904                                      23940076
239500         WHEN SQLCODE = -913                                      23950076
239600             CONTINUE                                             23960076
239700                                                                  23970076
239800         WHEN SQLWARN0 NOT = SPACE                                23980076
239900         WHEN SQLCODE < +0                                        23990076
240000         WHEN SQLCODE > +0                                        24000076
240100             MOVE SQLCODE TO PV-DISP-SQLCODE                      24010076
240200             MOVE '3060-INSERT-TRECVER'                           24020076
240300                              TO RC074-ERROR-PARA-NAME            24030076
240400             SET RC074-DB-ERROR                                   24040076
240500                 PS-ERROR-YES    TO TRUE                          24050076
240600             DISPLAY '******************************************' 24060076
240700             DISPLAY '*ABEND                                   *' 24070076
240800             DISPLAY '*PROGRAM   = RCKUP009                    *' 24080076
240900             DISPLAY '*DB2 OPER  = INSERT TRECVER              *' 24090076
241000             DISPLAY '*PARAGRAPH = 3060-INSERT-TRECVER         *' 24100076
241100             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                24110076
241200             DISPLAY '******************************************' 24120076
241300     END-EVALUATE.                                                24130076
241400                                                                  24140076
241500/                                                                 24150076
241600*----------------------------------------------------------------*24160076
241700* CLOSE THE TRECVER CURSOR                                       *24170076
241800*----------------------------------------------------------------*24180076
241900                                                                  24190076
242000 3080-CLOSE-TRECVER-CSR.                                          24200076
242100                                                                  24210076
242200     EXEC SQL                                                     24220076
242300          CLOSE TRECVER-CSR                                       24230076
242400     END-EXEC                                                     24240076
242500                                                                  24250076
242600     EVALUATE TRUE                                                24260076
242700         WHEN SQLCODE = +0                                        24270076
242800              CONTINUE                                            24280076
242900         WHEN SQLWARN0 NOT = SPACE                                24290076
243000         WHEN SQLCODE  NOT = +0                                   24300076
243100             MOVE SQLCODE TO PV-DISP-SQLCODE                      24310076
243200             MOVE '3080-CLOSE-TRECVER-CSR'                        24320076
243300                              TO RC074-ERROR-PARA-NAME            24330076
243400             SET RC074-DB-ERROR                                   24340076
243500                 PS-ERROR-YES    TO TRUE                          24350076
243600             DISPLAY '******************************************' 24360076
243700             DISPLAY '*ABEND                                   *' 24370076
243800             DISPLAY '*PROGRAM   = RCKUP009                    *' 24380076
243900             DISPLAY '*DB2 OPER  = CLOSE TRECVER CURSOR        *' 24390076
244000             DISPLAY '*PARAGRAPH = 3080-CLOSE-TRECVER-CSR      *' 24400076
244100             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                24410076
244200             DISPLAY '******************************************' 24420076
244300     END-EVALUATE.                                                24430076
244400                                                                  24440076
244500/                                                                 24450076
244600/                                                                 24460076
244700****************************************************************  24470076
244800*                                                                 24480076
244900*                                                                 24490076
245000**   B E G I N     M Q    S E R I E S     P A R A G R A P H S **  24500076
245100*                                                                 24510076
245200*                                                                 24520076
245300****************************************************************  24530076
245400                                                                  24540076
245500****************************************************************  24550076
245600** CONNECT TO THE QUEUE MANAGER                                   24560076
245700**                                                                24570076
245800** GET THE HANDLE TO THE QUEUE MANAGER - PV-HCONN                 24580076
245900****************************************************************  24590076
246000 3100-MQ-CONNECT-TO-QMGR.                                         24600076
246100                                                                  24610076
246200     MOVE '3100-MQ-CONNECT-TO-QMGR' TO PV-PARAGRAPH.              24620076
246300*                                                                 24630076
246400* CONNECT TO THE QUEUE                                            24640076
246500* CONTROL CARD 1 - QMGR NAME                                      24650076
246600*                                                                 24660076
246700                                                                  24670076
246800     MOVE CC-QMGR-NAME             TO PV-QMGR-NAME.               24680076
246900                                                                  24690076
247000     CALL PC-MQCONN USING PV-QMGR-NAME                            24700076
247100                          PV-HCONN                                24710076
247200                          PV-COMPLETION-CODE                      24720076
247300                          PV-REASON.                              24730076
247400                                                                  24740076
247500*IF CONNECTION FAILED THEN DISPLAY ERROR MESSAGE AND EXIT         24750076
247600     MOVE PV-REASON TO PV-CON-REASON.                             24760076
247700     IF PV-COMPLETION-CODE = MQCC-OK THEN                         24770076
247800         CONTINUE                                                 24780076
247900     ELSE                                                         24790076
248000         CALL PV-MQCHECK USING PV-REASON                          24800076
248100                               PV-MQ-REASON-TEXT                  24810076
248200         MOVE PV-QMGR-NAME         TO PE-MQ-QMANAGER              24820076
248300         MOVE PV-COMPLETION-CODE   TO PE-MQ-COMPLETION-CODE       24830076
248400         MOVE PV-REASON            TO PE-MQ-REASON-CODE           24840076
248500         MOVE 'CONNECT TO QMGR'    TO PV-ERROR-MESSAGE            24850076
248600         PERFORM 9200-MQ-ABEND                                    24860076
248700     END-IF.                                                      24870076
248800                                                                  24880076
248900****************************************************************  24890076
249000** OPEN THE ITEM QUEUE FOR GETS.                                  24900076
249100****************************************************************  24910076
249200 3200-MQ-QUEUE-OPEN.                                              24920076
249300                                                                  24930076
249400     MOVE '3200-MQ-QUEUE-OPEN'     TO PV-PARAGRAPH.               24940076
249500*                                                                 24950076
249600* CONTROL CARD 2 - ITEM QUEUE NAME                                24960076
249700*                                                                 24970076
249800     MOVE CC-ITEM-QUEUE-NAME       TO MQOD-OBJECTNAME             24980076
249900     MOVE PV-QMGR-NAME             TO MQOD-OBJECTQMGRNAME.        24990076
250000                                                                  25000076
250100     COMPUTE PV-OPEN-OPTIONS       = MQOO-INPUT-SHARED            25010076
250200                                   + MQOO-OUTPUT                  25020076
250300                                   + MQOO-SET-IDENTITY-CONTEXT    25030076
250400                                   + MQOO-FAIL-IF-QUIESCING.      25040076
250500                                                                  25050076
250600     CALL PC-MQOPEN USING PV-HCONN                                25060076
250700                          MQM-OBJECT-DESCRIPTOR                   25070076
250800                          PV-OPEN-OPTIONS                         25080076
250900                          PV-GQ-HANDLE                            25090076
251000                          PV-COMPLETION-CODE                      25100076
251100                          PV-REASON.                              25110076
251200                                                                  25120076
251300     IF PV-COMPLETION-CODE = MQCC-OK THEN                         25130076
251400         CONTINUE                                                 25140076
251500     ELSE                                                         25150076
251600         CALL PV-MQCHECK USING PV-REASON                          25160076
251700                               PV-MQ-REASON-TEXT                  25170076
251800         MOVE PV-QMGR-NAME            TO PE-MQ-QMANAGER           25180076
251900         MOVE CC-ITEM-QUEUE-NAME      TO PE-MQ-QNAME              25190076
252000         MOVE PV-COMPLETION-CODE      TO PE-MQ-COMPLETION-CODE    25200076
252100         MOVE PV-REASON               TO PE-MQ-REASON-CODE        25210076
252200         MOVE 'OPEN ITEM QUEUE'       TO PV-ERROR-MESSAGE         25220076
252300         PERFORM 9200-MQ-ABEND                                    25230076
252400     END-IF.                                                      25240076
252500                                                                  25250076
252600****************************************************************  25260076
252700** OPEN THE ITEM QUEUE FOR PUTS.                                  25270076
252800****************************************************************  25280076
252900 3205-MQ-ERROR-QUEUE-OPEN.                                        25290076
253000                                                                  25300076
253100     MOVE '3205-MQ-ERROR-QUEUE-OPEN' TO PV-PARAGRAPH.             25310076
253200*                                                                 25320076
253300* CONTROL CARD 3 - ERROR QUEUE NAME                               25330076
253400*                                                                 25340076
253500                                                                  25350076
253600     MOVE CC-ERROR-QUEUE-NAME      TO MQOD-OBJECTNAME.            25360076
253700     MOVE PV-QMGR-NAME             TO MQOD-OBJECTQMGRNAME.        25370076
253800                                                                  25380076
253900     COMPUTE PV-OPEN-OPTIONS       = MQOO-OUTPUT                  25390076
254000                                   + MQOO-SET-IDENTITY-CONTEXT    25400076
254100                                   + MQOO-FAIL-IF-QUIESCING.      25410076
254200                                                                  25420076
254300     CALL PC-MQOPEN USING PV-HCONN                                25430076
254400                          MQM-OBJECT-DESCRIPTOR                   25440076
254500                          PV-OPEN-OPTIONS                         25450076
254600                          PV-PQ-HANDLE                            25460076
254700                          PV-COMPLETION-CODE                      25470076
254800                          PV-REASON.                              25480076
254900                                                                  25490076
255000     IF PV-COMPLETION-CODE = MQCC-OK THEN                         25500076
255100         SET PS-ERROR-QUEUE-IS-OPEN-YES TO TRUE                   25510076
255200     ELSE                                                         25520076
255300         CALL PV-MQCHECK USING PV-REASON                          25530076
255400                               PV-MQ-REASON-TEXT                  25540076
255500         MOVE PV-QMGR-NAME         TO PE-MQ-QMANAGER              25550076
255600         MOVE CC-ERROR-QUEUE-NAME  TO PE-MQ-QNAME                 25560076
255700         MOVE PV-COMPLETION-CODE   TO PE-MQ-COMPLETION-CODE       25570076
255800         MOVE PV-REASON            TO PE-MQ-REASON-CODE           25580076
255900         MOVE 'OPEN ERROR QUEUE'   TO PV-ERROR-MESSAGE            25590076
256000         PERFORM 9200-MQ-ABEND                                    25600076
256100     END-IF.                                                      25610076
256200                                                                  25620076
256300****************************************************************  25630076
256400** GET THE FIRST MESSAGE (ITEM) FROM THE QUEUE.                   25640076
256500** THE QUEUE IS SET UP SO MSGS ARE RETRIEVED IN FIFO ORDER.       25650076
256600****************************************************************  25660076
256700 3300-MQ-GET-MSG.                                                 25670076
256800                                                                  25680076
256900     INITIALIZE PV-MSGBUFFER                                      25690076
257000                PV-ERRMSGBUF                                      25700076
257100                PV-DTL                                            25710076
257200                PV-MSG.                                           25720076
257300                                                                  25730076
257400*MSG ID IS NOT POPULATED IN THIS PGM.                             25740076
257500     MOVE MQMI-NONE TO MQMD-MSGID.                                25750076
257600                                                                  25760076
257700*MSGS ARE UNQUALIFIED IN THIS PGM.                                25770076
257800     MOVE MQCI-NONE         TO MQMD-CORRELID.                     25780076
257900                                                                  25790076
258000*FORMAT TRANSLATES THE DATA ACROSS PLATFORMS, 4K IS THE           25800076
258100*MAX LENGTH FOR MSGS IN THE PGM.                                  25810076
258200     MOVE MQFMT-STRING         TO MQMD-FORMAT.                    25820076
258300     MOVE +100                 TO PV-MSG-LENGTH.                  25830076
258400                                                                  25840076
258500*THE UNLIMITED WAIT INTERVAL MEANS THAT PROCESSING WILL JUST      25850076
258600* 'WAIT' UNTIL A MESSAGE APPEARAS ON THE Q.                       25860076
258700*    MOVE MQWI-UNLIMITED       TO MQGMO-WAITINTERVAL.             25870076
258800                                                                  25880076
258900     COMPUTE MQGMO-OPTIONS  =  MQGMO-SYNCPOINT +                  25890076
259000                               MQGMO-CONVERT   +                  25900076
259100                               MQGMO-ACCEPT-TRUNCATED-MSG +       25910076
259200                               MQGMO-NO-WAIT.                     25920076
259300                                                                  25930076
259400     CALL PC-MQGET USING PV-HCONN                                 25940076
259500                         PV-GQ-HANDLE                             25950076
259600                         MQM-MESSAGE-DESCRIPTOR                   25960076
259700                         MQM-GET-MESSAGE-OPTIONS                  25970076
259800                         PV-MSG-LENGTH                            25980076
259900                         PV-MSGBUFFER                             25990076
260000                         PV-DATA-LENGTH                           26000076
260100                         PV-COMPLETION-CODE                       26010076
260200                         PV-REASON.                               26020076
260300                                                                  26030076
260400*IF GET FAILED THEN DISPLAY ERROR MESSAGE                         26040076
260500*AND BREAK OUT OF LOOP                                            26050076
260600     IF (PV-COMPLETION-CODE NOT = MQCC-OK)                        26060076
260700         IF ((PV-REASON NOT = MQRC-NO-MSG-AVAILABLE)              26070076
260800          AND (PV-REASON NOT = MQRC-TRUNCATED-MSG-ACCEPTED))      26080076
260900             CALL PV-MQCHECK USING PV-REASON                      26090076
261000                                   PV-MQ-REASON-TEXT              26100076
261100           MOVE 'MQGET ERROR'          TO PV-ERROR-MESSAGE        26110076
261200           MOVE '3300-MQ-GET-UNQUALIFIED' TO PV-PARAGRAPH         26120076
261300           MOVE PV-COMPLETION-CODE     TO PV-HOLD-COMPLETION-CODE 26130076
261400           MOVE PV-REASON              TO PV-HOLD-REASON          26140076
261500           PERFORM 3700-BACK-OUT-MQ                               26150076
261600           MOVE PV-HOLD-COMPLETION-CODE  TO PV-COMPLETION-CODE    26160076
261700                                            PE-MQ-COMPLETION-CODE 26170076
261800           MOVE PV-HOLD-REASON           TO PV-REASON             26180076
261900                                            PE-MQ-REASON-CODE     26190076
262000           PERFORM 9200-MQ-ABEND                                  26200076
262100         END-IF                                                   26210076
262200*THIS MEANS A MSG WAS TRUNCATED                                   26220076
262300         IF PV-COMPLETION-CODE = +1                               26230076
262400          AND PV-REASON = +2079                                   26240076
262500            PERFORM 4750-MSG-TOO-BIG-ERROR                        26250076
262600            ADD +1                       TO PA-TOTAL-GETS         26260076
262700         END-IF                                                   26270076
262800         IF (PV-REASON = MQRC-NO-MSG-AVAILABLE)                   26280076
262900             SET PS-END-OF-INPUT TO TRUE                          26290076
263000         END-IF                                                   26300076
263100     ELSE                                                         26310076
263200         ADD +1                           TO PA-TOTAL-GETS        26320076
263300*PV-MSG IS USED TO PARSE THE DATA, ITS AN ELEMENT THAT JUST       26330076
263400*HOLDS THE ENTIRE ITEM UNTIL                                      26340076
263500*IT IS EITHER LOADED TO THE DB2 TABLE OR PUT TO THE ERROR QUEUE.  26350076
263600         MOVE PV-MSGBUFFER                TO PV-MSG               26360076
263700         MOVE PV-MSGBUFFER                TO PV-DTL               26370076
263800                                                                  26380076
263900*THIS GETS THE LEGACY ITEM PACK MAINTENANCE RECORD                26390076
264000*   OR THE LEGACY ITEM MAINTENANCE RECORD                         26400076
264100                                                                  26410076
264200         INITIALIZE RC074-ITEM-REC                                26420076
264300         MOVE PV-MSGBUFFER TO RC074-ITEM-REC                      26430076
264400     END-IF.                                                      26440076
264500                                                                  26450076
264600****************************************************************  26460076
264700** CLOSES THE TRANS QUEUE.                                        26470076
264800****************************************************************  26480076
264900 3400-MQ-QUEUE-CLOSE.                                             26490076
265000                                                                  26500076
265100     MOVE '3400-MQ-QUEUE-CLOSE'    TO PV-PARAGRAPH.               26510076
265200                                                                  26520076
265300     MOVE CC-ITEM-QUEUE-NAME       TO MQOD-OBJECTNAME.            26530076
265400     MOVE PV-QMGR-NAME             TO MQOD-OBJECTQMGRNAME.        26540076
265500     CALL PC-MQCLOSE USING PV-HCONN                               26550076
265600                           PV-GQ-HANDLE                           26560076
265700                           MQCO-NONE                              26570076
265800                           PV-COMPLETION-CODE                     26580076
265900                           PV-REASON.                             26590076
266000                                                                  26600076
266100     IF PV-COMPLETION-CODE = MQCC-OK THEN                         26610076
266200         CONTINUE                                                 26620076
266300     ELSE                                                         26630076
266400         CALL PV-MQCHECK USING PV-REASON                          26640076
266500                               PV-MQ-REASON-TEXT                  26650076
266600         MOVE PV-QMGR-NAME            TO PE-MQ-QMANAGER           26660076
266700         MOVE CC-ITEM-QUEUE-NAME      TO PE-MQ-QNAME              26670076
266800         MOVE PV-COMPLETION-CODE      TO PE-MQ-COMPLETION-CODE    26680076
266900         MOVE PV-REASON               TO PE-MQ-REASON-CODE        26690076
267000         MOVE 'PE-MQ-CLOSE'           TO PV-ERROR-MESSAGE         26700076
267100         PERFORM 9200-MQ-ABEND                                    26710076
267200     END-IF.                                                      26720076
267300                                                                  26730076
267400****************************************************************  26740076
267500** CLOSES THE ERROR QUEUE.                                        26750076
267600****************************************************************  26760076
267700 3405-MQ-ERROR-QUEUE-CLOSE.                                       26770076
267800                                                                  26780076
267900     MOVE '3405-MQ-ERROR-QUEUE-CLOSE'  TO PV-PARAGRAPH.           26790076
268000                                                                  26800076
268100     MOVE CC-ERROR-QUEUE-NAME      TO MQOD-OBJECTNAME.            26810076
268200     MOVE PV-QMGR-NAME             TO MQOD-OBJECTQMGRNAME.        26820076
268300                                                                  26830076
268400     CALL PC-MQCLOSE USING PV-HCONN                               26840076
268500                           PV-PQ-HANDLE                           26850076
268600                           MQCO-NONE                              26860076
268700                           PV-COMPLETION-CODE                     26870076
268800                           PV-REASON.                             26880076
268900                                                                  26890076
269000     IF PV-COMPLETION-CODE = MQCC-OK THEN                         26900076
269100         SET PS-ERROR-QUEUE-IS-OPEN-NO TO TRUE                    26910076
269200     ELSE                                                         26920076
269300         CALL PV-MQCHECK USING PV-REASON                          26930076
269400                               PV-MQ-REASON-TEXT                  26940076
269500         MOVE PV-QMGR-NAME            TO PE-MQ-QMANAGER           26950076
269600         MOVE CC-ITEM-QUEUE-NAME      TO PE-MQ-QNAME              26960076
269700         MOVE PV-COMPLETION-CODE      TO PE-MQ-COMPLETION-CODE    26970076
269800         MOVE PV-REASON               TO PE-MQ-REASON-CODE        26980076
269900         MOVE 'PE-ERROR-Q-CLOSE'      TO PV-ERROR-MESSAGE         26990076
270000         PERFORM 9200-MQ-ABEND                                    27000076
270100     END-IF.                                                      27010076
270200                                                                  27020076
270300****************************************************************  27030076
270400** DISCONNECT FROM THE QUEUE MANAGER                              27040076
270500****************************************************************  27050076
270600 3500-DISCONNECT-QMGR.                                            27060076
270700                                                                  27070076
270800     MOVE '3500-DISCONNECT-QMGR'    TO PV-PARAGRAPH.              27080076
270900     CALL PC-MQDISC USING PV-HCONN                                27090076
271000                          PV-COMPLETION-CODE                      27100076
271100                          PV-REASON                               27110076
271200                                                                  27120076
271300     IF PV-COMPLETION-CODE = MQCC-OK THEN                         27130076
271400        CONTINUE                                                  27140076
271500     ELSE                                                         27150076
271600         CALL PV-MQCHECK USING PV-REASON                          27160076
271700                               PV-MQ-REASON-TEXT                  27170076
271800        MOVE PV-QMGR-NAME            TO PE-MQ-QMANAGER            27180076
271900        MOVE CC-ITEM-QUEUE-NAME      TO PE-MQ-QNAME               27190076
272000        MOVE PV-COMPLETION-CODE      TO PE-MQ-COMPLETION-CODE     27200076
272100        MOVE PV-REASON               TO PE-MQ-REASON-CODE         27210076
272200        MOVE '3500-DISCONNECT-QMGR'  TO PV-ERROR-MESSAGE          27220076
272300        PERFORM 9200-MQ-ABEND                                     27230076
272400     END-IF.                                                      27240076
272500                                                                  27250076
272600******************************************************************27260076
272700*  COMMIT MQ PROCESSING SINCE THE POINT OF THE LAST COMMIT        27270076
272800******************************************************************27280076
272900 3600-MQ-COMMIT.                                                  27290076
273000                                                                  27300076
273100     CALL PC-MQCMIT USING PV-HCONN                                27310076
273200                          PV-COMPLETION-CODE                      27320076
273300                          PV-REASON.                              27330076
273400                                                                  27340076
273500     IF (PV-COMPLETION-CODE NOT = MQCC-OK)                        27350076
273600         CALL PV-MQCHECK USING PV-REASON                          27360076
273700                               PV-MQ-REASON-TEXT                  27370076
273800        MOVE '3600-COMMIT-MQ'   TO PV-PARAGRAPH                   27380076
273900        MOVE 'MQCMIT ERROR'     TO PV-ERROR-MESSAGE               27390076
274000        MOVE PV-COMPLETION-CODE TO PV-HOLD-COMPLETION-CODE        27400076
274100        MOVE PV-REASON          TO PV-HOLD-REASON                 27410076
274200        PERFORM 3700-BACK-OUT-MQ                                  27420076
274300        MOVE PV-HOLD-COMPLETION-CODE TO PV-COMPLETION-CODE        27430076
274400                                        PE-MQ-COMPLETION-CODE     27440076
274500        MOVE PV-HOLD-REASON          TO PV-REASON                 27450076
274600                                        PE-MQ-REASON-CODE         27460076
274700        PERFORM 9200-MQ-ABEND                                     27470076
274800     ELSE                                                         27480076
274900        ADD +1 TO PA-TOTAL-MQ-COMMITS                             27490076
275000     END-IF.                                                      27500076
275100                                                                  27510076
275200******************************************************************27520076
275300* BACK OUT MQ PROCESSING SINCE THE POINT OF THE LAST COMMIT       27530076
275400******************************************************************27540076
275500 3700-BACK-OUT-MQ.                                                27550076
275600                                                                  27560076
275700     CALL PC-MQBACK USING PV-HCONN                                27570076
275800                          PV-COMPLETION-CODE                      27580076
275900                          PV-REASON.                              27590076
276000                                                                  27600076
276100     IF (PV-COMPLETION-CODE NOT = MQCC-OK) THEN                   27610076
276200         CALL PV-MQCHECK USING PV-REASON                          27620076
276300                               PV-MQ-REASON-TEXT                  27630076
276400        MOVE '3700-BACK-OUT-MQ'  TO PV-PARAGRAPH                  27640076
276500        MOVE 'MQBACK ERROR'      TO PV-ERROR-MESSAGE              27650076
276600        PERFORM 9200-MQ-ABEND                                     27660076
276700     END-IF.                                                      27670076
276800                                                                  27680076
276900****************************************************************  27690076
277000* PUT MESSAGE IN ERROR TO THE ITEM ERROR QUEUE                    27700076
277100****************************************************************  27710076
277200 3800-PUT-MSG-TO-ERROR-Q.                                         27720076
277300                                                                  27730076
277400*UPDATE THE ERROR MESSAGE COUNTER.                                27740076
277500     ADD +1 TO PA-TOTAL-ERRORQ-RECS.                              27750076
277600                                                                  27760076
277700*MSGID IS NOT POPULATED AT ALL IN THIS PGM.                       27770076
277800     MOVE MQMI-NONE        TO MQMD-MSGID.                         27780076
277900                                                                  27790076
278000*KEEP ORIGINAL CORRELID.                                          27800076
278100**   WHERE DOES THIS GET A VALUE?                                 27810076
278200     MOVE PV-HOLD-CORRELID TO MQMD-CORRELID.                      27820076
278300                                                                  27830076
278400*PUT MSG BACK WITH CURRENT-TMST AND ERROR TYPE.                   27840076
278500     MOVE RC074-ITEM-REC       TO PV-ERRMSGBUF.                   27850076
278600                                                                  27860076
278700*THE ENTIRE MSG LENGTH IS +100.                                   27870076
278800     MOVE +100 TO PV-MSG-LENGTH.                                  27880076
278900                                                                  27890076
279000*SET OPTIONS.                                                     27900076
279100     MOVE MQFMT-STRING     TO MQMD-FORMAT.                        27910076
279200     MOVE MQPER-PERSISTENT TO MQMD-PERSISTENCE.                   27920076
279300     COMPUTE MQPMO-OPTIONS  =  MQPMO-SYNCPOINT +                  27930076
279400                               MQPMO-SET-IDENTITY-CONTEXT.        27940076
279500                                                                  27950076
279600*PUT MSG.                                                         27960076
279700     CALL PC-MQPUT USING PV-HCONN                                 27970076
279800                         PV-PQ-HANDLE                             27980076
279900                         MQM-MESSAGE-DESCRIPTOR                   27990076
280000                         MQM-PUT-MESSAGE-OPTIONS                  28000076
280100                         PV-MSG-LENGTH                            28010076
280200                         PV-ERRMSGBUF                             28020076
280300                         PV-COMPLETION-CODE                       28030076
280400                         PV-REASON.                               28040076
280500                                                                  28050076
280600*IF PUT FAILED THEN DISPLAY ERROR MESSAGE                         28060076
280700*AND BREAK OUT OF LOOP                                            28070076
280800     IF (PV-COMPLETION-CODE NOT = MQCC-OK)                        28080076
280900         CALL PV-MQCHECK USING PV-REASON                          28090076
281000                               PV-MQ-REASON-TEXT                  28100076
281100         DISPLAY 'MQ MESSAGE = ', PV-ERRMSGBUF                    28110076
281200         MOVE '3800-PUT-MSG-TO-ERROR-Q' TO PV-PARAGRAPH           28120076
281300         MOVE 'MQPUT FAILED'          TO PV-ERROR-MESSAGE         28130076
281400         MOVE PV-COMPLETION-CODE      TO PV-HOLD-COMPLETION-CODE  28140076
281500         MOVE PV-REASON               TO PV-HOLD-REASON           28150076
281600         PERFORM 3700-BACK-OUT-MQ                                 28160076
281700         MOVE PV-HOLD-COMPLETION-CODE TO PV-COMPLETION-CODE       28170076
281800                                         PE-MQ-COMPLETION-CODE    28180076
281900         MOVE PV-HOLD-REASON          TO PV-REASON                28190076
282000                                         PE-MQ-REASON-CODE        28200076
282100         PERFORM 9200-MQ-ABEND                                    28210076
282200     END-IF.                                                      28220076
282300                                                                  28230076
282400 4000-READ-RECORD.                                                28240076
282500     SET PS-NOT-END-OF-INPUT TO TRUE.                             28250076
282600     READ INPUT-FILE  INTO RC074-ITEM-REC                         28260076
282700         AT END                                                   28270076
282800           SET PS-END-OF-INPUT TO TRUE                            28280076
282900         NOT AT END                                               28290076
283000           ADD +1               TO PA-TOTAL-GETS.                 28300076
283100                                                                  28310076
283200******************************************************************28320076
283300* THERE IS A MSG IN THE QUEUE LARGER THAN THE CURRENT PV-MSGBUFFER28330076
283400******************************************************************28340076
283500 4750-MSG-TOO-BIG-ERROR.                                          28350076
283600                                                                  28360076
283700     SET PS-ERROR-YES      TO TRUE.                               28370076
283800                                                                  28380076
283900******************************************************************28390076
284000****************************************************************  28400076
284100* !!! I M P O R T A N T !!!                                       28410076
284200*                                                                 28420076
284300* THE 'STOP RUN' NEEDS TO BE HERE INSTEAD OF IN THE MAIN LINE OF  28430076
284400* THE PROGRAM BECAUSE THIS IS CODED AS A STARTED TASK, AND THIS   28440076
284500* PROGRAM WILL RUN CONTINUOUSLY UNTIL IT RECEIVES THE 'END RUN    28450076
284600* OF PROGRAM' MESSAGE. IF THE STOP RUN IS MOVED TO THE MAIN LINE  28460076
284700* THE RESULT WILL BE AN MQ HCONN_ERROR !!!!!                      28470076
284800*                                                                 28480076
284900* END RUN OF PROGRAM ROUTINE:                                     28490076
285000* CLOSE QUEUE(S)                                                  28500076
285100* DISCONNECT FROM QMGR                                            28510076
285200* DISPLAY SUMMARY STATISTICS                                      28520076
285300****************************************************************  28530076
285400 5000-END-RUN-ROUTINE.                                            28540076
285500                                                                  28550076
285600     IF PS-INPUT-FROM-MQ                                          28560076
285700*CLOSE THE TRANS QUEUE.                                           28570076
285800         PERFORM 3400-MQ-QUEUE-CLOSE                              28580076
285900     ELSE                                                         28590076
286000         CLOSE INPUT-FILE                                         28600076
286100     END-IF.                                                      28610076
286200                                                                  28620076
286300*CLOSE THE ERROR QUEUE IF OPEN.                                   28630076
286400     IF PS-ERROR-QUEUE-IS-OPEN-YES                                28640076
286500        PERFORM 3405-MQ-ERROR-QUEUE-CLOSE                         28650076
286600     END-IF.                                                      28660076
286700                                                                  28670076
286800*DISCONNECT FROM THE QMGR.                                        28680076
286900     PERFORM 3500-DISCONNECT-QMGR.                                28690076
287000                                                                  28700076
287100                                                                  28710076
287200*END OF JOB ROUTINE.                                              28720076
287300     PERFORM 8000-EOJ-ROUTINE.                                    28730076
287400                                                                  28740076
287500*END PROGRAM.                                                     28750076
287600     DISPLAY '************  END OF RCKUP009  ***************'     28760076
287700     STOP RUN.                                                    28770076
287800                                                                  28780076
287900******************************************************************28790076
288000* COMMITTED RECORDS WILL REMAIN IN DB2 TABLES AFTER AN ABEND.     28800076
288100******************************************************************28810076
288200 6000-DB2-COMMIT.                                                 28820076
288300                                                                  28830076
288400     EXEC SQL                                                     28840076
288500         COMMIT                                                   28850076
288600     END-EXEC.                                                    28860076
288700                                                                  28870076
288800     EVALUATE TRUE                                                28880076
288900         WHEN SQLCODE = +0                                        28890076
289000              ADD +1  TO PA-TOTAL-DB2-COMMITS                     28900076
289100              ADD PT-TOTAL-TPKSLIP-INSERTS                        28910076
289200                                     TO PA-TOTAL-TPKSLIP-INSERTS  28920076
289300              ADD PT-TOTAL-TPKSLIP-UPDATES                        28930076
289400                                     TO PA-TOTAL-TPKSLIP-UPDATES  28940076
289500              ADD PT-TOTAL-TPKITEM-INSERTS                        28950076
289600                                     TO PA-TOTAL-TPKITEM-INSERTS  28960076
289700              ADD PT-TOTAL-TRECEIV-INSERTS                        28970076
289800                                     TO PA-TOTAL-TRECEIV-INSERTS  28980076
289900              ADD PT-TOTAL-TRECEIV-UPDATES                        28990076
290000                                     TO PA-TOTAL-TRECEIV-UPDATES  29000076
290100              ADD PT-TOTAL-TRECITM-INSERTS                        29010076
290200                                     TO PA-TOTAL-TRECITM-INSERTS  29020076
290300              ADD PT-TOTAL-TRECDIS-INSERTS                        29030076
290400                                     TO PA-TOTAL-TRECDIS-INSERTS  29040076
290500              ADD PT-TOTAL-WFT-CNTL-INSERTS                       29050076
290600                                     TO PA-TOTAL-WFT-CNTL-INSERTS 29060076
290700              ADD PT-TOTAL-WFT-XFER-INSERTS                       29070076
290800                                     TO PA-TOTAL-WFT-XFER-INSERTS 29080076
290900         WHEN SQLWARN0 NOT = SPACES                               29090076
291000         WHEN SQLCODE  NOT = ZERO                                 29100076
291100         MOVE '6000-DB2-COMMIT'                                   29110076
291200                          TO RC074-ERROR-PARA-NAME                29120076
291300         SET RC074-DB-ERROR                                       29130076
291400             PS-ERROR-YES    TO TRUE                              29140076
291500         DISPLAY '****************************'                   29150076
291600         DISPLAY '** ABEND                  **'                   29160076
291700         DISPLAY '** PROGRAM = RCKUP009     **'                   29170076
291800         DISPLAY '** PARAGRAPH = 6000-COMMIT**'                   29180076
291900         DISPLAY '** UNSUCCESSFUL COMMIT    **'                   29190076
292000         DISPLAY '****************************'                   29200076
292100     END-EVALUATE.                                                29210076
292200                                                                  29220076
292300 6100-DB2-ROLLBACK.                                               29230076
292400                                                                  29240076
292500     EXEC SQL                                                     29250076
292600         ROLLBACK                                                 29260076
292700     END-EXEC.                                                    29270076
292800                                                                  29280076
292900     EVALUATE TRUE                                                29290076
293000         WHEN SQLCODE = +0                                        29300076
293100              CONTINUE                                            29310076
293200         WHEN SQLWARN0 NOT = SPACES                               29320076
293300         WHEN SQLCODE  NOT = ZERO                                 29330076
293400         MOVE '6100-DB2-ROLLBACK'                                 29340076
293500                          TO RC074-ERROR-PARA-NAME                29350076
293600         SET RC074-DB-ERROR                                       29360076
293700             PS-ERROR-YES    TO TRUE                              29370076
293800         DISPLAY '****************************'                   29380076
293900         DISPLAY '** ABEND                  **'                   29390076
294000         DISPLAY '** PROGRAM = RCKUP009     **'                   29400076
294100         DISPLAY '** PARAGRAPH = 6100-ROLLBACK'                   29410076
294200         DISPLAY '** UNSUCCESSFUL ROLLBACK  **'                   29420076
294300         DISPLAY '****************************'                   29430076
294400     END-EVALUATE.                                                29440076
294500                                                                  29450076
294600****************************************************************  29460076
294700* OPEN THE ERROR QUEUE IF IT HAS NOT BEEN ALREADY. SET UP THE     29470076
294800* CURRENT TMST AND ERROR REASON CODE TO BE PUT INTO THE           29480076
294900* MQMD-APPLIDENTITYDATA.                                          29490076
295000****************************************************************  29500076
295100 7100-ERROR-ROUTINE.                                              29510076
295200                                                                  29520076
295300*OPEN ERROR QUEUE                                                 29530076
295400     IF PS-ERROR-QUEUE-IS-OPEN-NO                                 29540076
295500        PERFORM 3205-MQ-ERROR-QUEUE-OPEN                          29550076
295600     END-IF.                                                      29560076
295700                                                                  29570076
295800                                                                  29580076
295900****************************************************************  29590076
296000*                                                                 29600076
296100*                                                                 29610076
296200** E N D    O F    M Q    S E R I E S     P A R A G R A P H S **  29620076
296300*                                                                 29630076
296400*                                                                 29640076
296500****************************************************************  29650076
296600                                                                  29660076
296700******************************************************************29670076
296800* UPDATE CHECKPOINT STATUS CODE WITH 0 FOR COMPLETION.            29680076
296900* DISPLAY STATISTICS FOR THE PROGRAM                              29690076
297000******************************************************************29700076
297100 8000-EOJ-ROUTINE.                                                29710076
297200                                                                  29720076
297300                                                                  29730076
297400         DISPLAY ' ********************************************'  29740076
297500         DISPLAY '     * RCKUP009 SUMMARY STATISTICS *         '  29750076
297600         DISPLAY ' '                                              29760076
297700         DISPLAY '       ---------------------------           '  29770076
297800         DISPLAY '          RECEIVER CREATE UPDATES            '  29780076
297900         DISPLAY '       ---------------------------           '  29790076
298000         DISPLAY ' '                                              29800076
298100         DISPLAY ' TOTAL PKSLIP INSERTS:    '                     29810088
298200                                        PA-TOTAL-TPKSLIP-INSERTS  29820076
298300         DISPLAY ' TOTAL PKSLIP UPDATES:    '                     29830088
298400                                        PA-TOTAL-TPKSLIP-UPDATES  29840076
298500         DISPLAY ' TOTAL PKITEM INSERTS:    '                     29850088
298600                                        PA-TOTAL-TPKITEM-INSERTS  29860076
298700         DISPLAY ' TOTAL RECEIVER INSERTS:  '                     29870088
298800                                        PA-TOTAL-TRECEIV-INSERTS  29880076
298900         DISPLAY ' TOTAL RECEIVER UPDATES:  '                     29890088
299000                                        PA-TOTAL-TRECEIV-UPDATES  29900076
299100         DISPLAY ' TOTAL RECITM INSERTS:    '                     29910088
299200                                        PA-TOTAL-TRECITM-INSERTS  29920076
299300         DISPLAY ' TOTAL RECDIS INSERTS:    '                     29930088
299400                                        PA-TOTAL-TRECDIS-INSERTS  29940076
299500         DISPLAY ' TOTAL WFT_CNTL INSERTS:  '                     29950088
299600                                        PA-TOTAL-WFT-CNTL-INSERTS 29960076
299700         DISPLAY ' TOTAL WFT_XFER INSERTS:  '                     29970088
299800                                        PA-TOTAL-WFT-XFER-INSERTS 29980076
299900         DISPLAY ' TOTAL MESSAGES READ:     '                     29990088
300000                                        PA-TOTAL-GETS             30000076
300100         DISPLAY ' TOTAL MESSAGES IN ERROR: '                     30010088
300200                                        PA-TOTAL-ERRORQ-RECS      30020076
300300         DISPLAY ' TOTAL DB2 COMMITS:       '                     30030088
300400                                        PA-TOTAL-DB2-COMMITS      30040076
300500         DISPLAY ' TOTAL MQ  COMMITS:       '                     30050088
300600                                        PA-TOTAL-MQ-COMMITS       30060076
300700         DISPLAY '********************************************'.  30070076
300800                                                                  30080076
300900                                                                  30090076
301000****************************************************************  30100076
301100** PERFORM MQ-SERIES ABEND PROCESSING                             30110076
301200****************************************************************  30120076
301300 9200-MQ-ABEND.                                                   30130076
301400                                                                  30140076
301500     DISPLAY '**** ABEND *************************************'.  30150076
301600     DISPLAY '** MQSERIES ERROR **'.                              30160076
301700     DISPLAY '** PROGRAM:    ', PC-CURRENT-PROGRAM-NAME.          30170076
301800     DISPLAY '** ABEND CODE: ', PV-ABEND-CODE.                    30180076
301900     DISPLAY '** PARAGRAPH:  ', PV-PARAGRAPH.                     30190076
302000     DISPLAY '** MESSAGE:    ', PV-ERROR-MESSAGE.                 30200076
302100     DISPLAY '** COMP CODE:  ', PE-MQ-COMPLETION-CODE.            30210076
302200     DISPLAY '** RSN CODE:   ', PE-MQ-REASON-CODE.                30220076
302300     DISPLAY '** RSN TEXT:   ', PV-MQ-REASON-TEXT.                30230076
302400     DISPLAY '************************************************'.  30240076
302500                                                                  30250076
302600******************************************************************30260076
302700**                      END OF PROGRAM                            30270076
302800*                                                                 30280076
302900******************************************************************30290076
