000100 IDENTIFICATION DIVISION.                                         00010000
000200 TITLE 'UNBALANCED STORE EXPECTED REPORT'.                        00020000
000300                                                                  00030000
000400 PROGRAM-ID.             PCKRP020.                                00040000
000500 AUTHOR.                 PATRICK BURKE.                           00050000
000600 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00060000
000700 DATE-WRITTEN.           MARCH 2004.                              00070000
000800 DATE-COMPILED.                                                   00080000
000900                                                                  00090000
001000 ENVIRONMENT DIVISION.                                            00100000
001100 CONFIGURATION SECTION.                                           00110000
001200 SOURCE-COMPUTER.                        IBM-3090.                00120000
001300 OBJECT-COMPUTER.                        IBM-3090.                00130000
001400 INPUT-OUTPUT SECTION.                                            00140000
001500 FILE-CONTROL.                                                    00150000
001600                                                                  00160000
001700     SELECT EXTRACT-FILE                                          00170000
001800         ASSIGN TO INP01.                                         00180000
001900                                                                  00190000
002000     SELECT  REPORT-FILE                                          00200000
002100         ASSIGN TO RPT01.                                         00210000
002200                                                                  00220000
002300                                                                  00230000
002400 DATA DIVISION.                                                   00240000
002500 FILE SECTION.                                                    00250000
002600                                                                  00260000
002700 FD  EXTRACT-FILE                                                 00270000
002800     RECORDING MODE IS F                                          00280000
002900     LABEL RECORDS ARE STANDARD                                   00290000
003000     BLOCK CONTAINS 0 RECORDS.                                    00300000
003100 01  EXTRACT-RECORD                    PIC X(150).                00310000
003200                                                                  00320000
003300 FD  REPORT-FILE                                                  00330000
003400     RECORDING MODE IS F                                          00340000
003500     LABEL RECORDS ARE STANDARD                                   00350000
003600     BLOCK CONTAINS 0 RECORDS.                                    00360000
003700 01  REPORT-RECORD                    PIC X(132).                 00370000
003800/                                                                 00380000
003900 WORKING-STORAGE SECTION.                                         00390000
004000 01  PS-SWITCHES.                                                 00400000
004100     05  PS-EOF-ERROR-SWITCH          PIC X(01) VALUE 'N'.        00410000
004200         88  PS-EOF-ERROR-FILE                  VALUE 'Y'.        00420000
004300                                                                  00430000
004400     05  PS-BLANK-LINE-SWITCH         PIC X(01) VALUE 'N'.        00440000
004500         88  PS-BLANK-LINE                      VALUE 'Y'.        00450000
004600         88  PS-BLANK-LINE-NO                   VALUE 'N'.        00460000
004700                                                                  00470000
004800                                                                  00480000
004900 01  ABEND-CODE                       PIC S9(04) VALUE ZERO       00490000
005000                                                 COMP SYNC.       00500000
005100     88  ABEND-4013-DB2-ERROR                        VALUE +4013. 00510000
005200                                                                  00520000
005300 01  SD-SYSTEM-DATE.                                              00530000
005400     05  SD-SYSTEM-DATE-YY          PIC  9(02)   VALUE ZERO.      00540000
005500     05  SD-SYSTEM-DATE-MM          PIC  9(02)   VALUE ZERO.      00550000
005600     05  SD-SYSTEM-DATE-DD          PIC  9(02)   VALUE ZERO.      00560000
005700                                                                  00570000
005800 01  ST-SYSTEM-TIME.                                              00580000
005900     05  ST-SYSTEM-HOUR             PIC  9(02)   VALUE ZERO.      00590000
006000     05  ST-SYSTEM-MINUTE           PIC  9(02)   VALUE ZERO.      00600000
006100     05  FILLER                     PIC  9(04)   VALUE ZERO.      00610000
006200                                                                  00620000
006300 01  PV-VARIABLES.                                                00630000
006400     05  PV-TMST                      PIC X(26) VALUE SPACES.     00640000
006500     05  PV-READ-COUNT                PIC S9(7) COMP-3            00650000
006600                                                VALUE ZERO.       00660000
006700     05  PV-BOSS-COUNT                PIC S9(7) COMP-3            00670020
006800                                                VALUE ZERO.       00680021
006810     05  PV-BDSV-COUNT                PIC S9(7) COMP-3            00681021
006820                                                VALUE ZERO.       00682021
006900     05  PV-WRITE-COUNT               PIC S9(7) COMP-3            00690000
007000                                                VALUE ZERO.       00700000
007100     05  PV-PAGE-COUNT                PIC S9(7) COMP-3            00710004
007200                                                VALUE ZERO.       00720000
007300     05  PV-LINES-USED                PIC S9(4) COMP-3            00730000
007400                                                VALUE ZERO.       00740000
007500     05  PV-BOSS-PARM-RECV            PIC S9(9) COMP.             00750013
007510     05  PV-BDSV-PARM-RECV            PIC S9(9) COMP.             00751021
007600     05  PV-DISPLAY-RECV              PIC --------9.              00760017
007700     05  PV-DB2-FUNCTION              PIC X(30) VALUE SPACES.     00770000
007800     05  PV-PARAGRAPH                 PIC X(30) VALUE SPACES.     00780000
007900     05  PV-DISP-NUMBER               PIC Z,ZZZ,ZZ9.              00790000
008000     05  PV-DISP-COUNT                PIC Z,ZZZ,ZZZ,ZZ9.          00800000
008100     05  PV-PREV-OPER                 PIC 9(05).                  00810000
008200                                                                  00820000
008300     05  PV-RUN-DATE                  PIC X(10) VALUE SPACES.     00830000
008400     05  PV-SAVE-START-DATE           PIC X(10) VALUE SPACES.     00840000
008500     05  PV-DB2-DATE.                                             00850000
008600         10  PV-DB2-CC                  PIC X(02).                00860000
008700         10  PV-DB2-YY                  PIC X(02).                00870000
008800         10  FILLER                     PIC X(01).                00880000
008900         10  PV-DB2-MM                  PIC X(02).                00890000
009000         10  FILLER                     PIC X(01).                00900000
009100         10  PV-DB2-DD                  PIC X(02).                00910000
009200     05  PV-KEY-DATE.                                             00920000
009300         10  PV-KEY-MM               PIC X(02).                   00930000
009400         10  FILLER                  PIC X(01) VALUE '/'.         00940000
009500         10  PV-KEY-DD               PIC X(02).                   00950000
009600         10  FILLER                  PIC X(01) VALUE '/'.         00960000
009700         10  PV-KEY-YY               PIC X(02).                   00970000
009800                                                                  00980000
009900 01  PC-CONSTANTS.                                                00990000
010000     05  PC-CURRENT-PROGRAM-NAME      PIC X(08) VALUE 'PCKRP020'. 01000000
010100     05  PC-END-OF-PAGE               PIC S9(3) COMP-3 VALUE +60. 01010000
010200/                                                                 01020000
010300***  STANDARD REPORT HEADER FOR 132 COLUMN REPORT                 01030000
010400     COPY DPWS132O.                                               01040000
010500                                                                  01050000
010600*    ERROR EXTRACT                                                01060000
010700     COPY PCRD038.                                                01070000
010800                                                                  01080000
010900 01  HL-HEADING-LINE-1.                                           01090000
011000     05  FILLER                      PIC  X(42)  VALUE SPACES.    01100000
011100     05  FILLER                      PIC  X(41)  VALUE            01110000
011200      'STORE EXPECTED CLEAN UP TRANSACTIONS     '.                01120000
011300     05  FILLER                      PIC  X(49)  VALUE SPACES.    01130023
011400                                                                  01140000
011500 01  HL-HEADING-LINE-1A.                                          01150000
011600     05  FILLER                      PIC  X(33)  VALUE SPACES.    01160000
011700     05  FILLER                      PIC  X(41)  VALUE            01170000
011800      '                    ROUTINE PROCESS      '.                01180000
011900     05  FILLER                      PIC  X(58)  VALUE SPACES.    01190023
012000                                                                  01200000
012100 01  HL-HEADING-LINE-2A.                                          01210000
012200     05  FILLER                      PIC  X(06) VALUE  SPACES.    01220029
012300     05  FILLER                      PIC  X(05) VALUE             01230026
012400         'STORE'.                                                 01240026
012500     05  FILLER                      PIC  X(14) VALUE  SPACES.    01250026
012600     05  FILLER                      PIC  X(03) VALUE             01260002
012700         'REC'.                                                   01270002
012800     05  FILLER                      PIC  X(20) VALUE  SPACES.    01280026
012900     05  FILLER                      PIC  X(09) VALUE             01290001
013000         'STORE EXP'.                                             01300001
013100     05  FILLER                      PIC  X(02) VALUE  SPACES.    01310026
013200     05  FILLER                      PIC  X(08) VALUE             01320001
013300         'LAST ACT'.                                              01330001
013400     05  FILLER                      PIC  X(03) VALUE  SPACES.    01340026
013500     05  FILLER                      PIC  X(10) VALUE             01350001
013600         'EXT RETAIL'.                                            01360001
013700     05  FILLER                      PIC  X(08) VALUE  SPACES.    01370001
013800     05  FILLER                      PIC  X(08) VALUE             01380001
013900         'CLEAN UP'.                                              01390001
014000     05  FILLER                      PIC  X(36) VALUE  SPACES.    01400026
014100                                                                  01410001
014200 01  HL-HEADING-LINE-2.                                           01420001
014300     05  FILLER                      PIC  X(02) VALUE  SPACES.    01430026
014400     05  FILLER                      PIC  X(02) VALUE             01440001
014500         'DC'.                                                    01450001
014600     05  FILLER                      PIC  X(03) VALUE  SPACES.    01460026
014700     05  FILLER                      PIC  X(03) VALUE             01470026
014800         'NBR'.                                                   01480026
014900     05  FILLER                      PIC  X(02) VALUE  SPACES.    01490026
015000     05  FILLER                      PIC  X(11) VALUE             01500001
015100         'PO/RECEIVER'.                                           01510001
015200     05  FILLER                      PIC  X(02) VALUE  SPACES.    01520026
015300     05  FILLER                      PIC  X(03) VALUE             01530002
015400         'TYP'.                                                   01540002
015500     05  FILLER                      PIC  X(01) VALUE  SPACES.    01550026
015600     05  FILLER                      PIC  X(04) VALUE             01560002
015700         'DEPT'.                                                  01570002
015710     05  FILLER                      PIC  X(01) VALUE  SPACES.    01571026
015720     05  FILLER                      PIC  X(04) VALUE             01572026
015730         'SEPH'.                                                  01573026
015800     05  FILLER                      PIC  X(03) VALUE  SPACES.    01580026
015900     05  FILLER                      PIC  X(03) VALUE             01590001
016000         'SKU'.                                                   01600001
016100     05  FILLER                      PIC  X(06) VALUE  SPACES.    01610026
016200     05  FILLER                      PIC  X(05) VALUE             01620001
016300         'UNITS'.                                                 01630001
016400     05  FILLER                      PIC  X(06) VALUE  SPACES.    01640026
016500     05  FILLER                      PIC  X(04) VALUE             01650001
016600         'DATE'.                                                  01660001
016700     05  FILLER                      PIC  X(05) VALUE  SPACES.    01670030
016800     05  FILLER                      PIC  X(11) VALUE             01680001
016900         'CALCULATION'.                                           01690001
017000     05  FILLER                      PIC  X(08) VALUE  SPACES.    01700001
017100     05  FILLER                      PIC  X(08) VALUE             01710026
017200         'REASON'.                                                01720001
017300     05  FILLER                      PIC  X(37) VALUE  SPACES.    01730026
017400                                                                  01740001
017500 01  HL-HEADING-LINE-3.                                           01750001
017600     05  FILLER                      PIC  X(01) VALUE  SPACES.    01760001
017700     05  FILLER                      PIC  X(04) VALUE             01770026
017800         '----'.                                                  01780026
017900     05  FILLER                      PIC  X(01) VALUE  SPACES.    01790026
018000     05  FILLER                      PIC  X(04) VALUE             01800026
018100         '----'.                                                  01810026
018200     05  FILLER                      PIC  X(01) VALUE  SPACES.    01820026
018300     05  FILLER                      PIC  X(13) VALUE             01830026
018400         '-------------'.                                         01840026
018500     05  FILLER                      PIC  X(01) VALUE  SPACES.    01850026
018600     05  FILLER                      PIC  X(03) VALUE             01860002
018700         '---'.                                                   01870002
018800     05  FILLER                      PIC  X(01) VALUE  SPACES.    01880026
018900     05  FILLER                      PIC  X(04) VALUE             01890002
019000         '----'.                                                  01900002
019010     05  FILLER                      PIC  X(01) VALUE  SPACES.    01901026
019020     05  FILLER                      PIC  X(04) VALUE             01902026
019030         '----'.                                                  01903026
019100     05  FILLER                      PIC  X(01) VALUE  SPACES.    01910026
019200     05  FILLER                      PIC  X(08) VALUE             01920001
019300         '--------'.                                              01930001
019400     05  FILLER                      PIC  X(01) VALUE  SPACES.    01940026
019500     05  FILLER                      PIC  X(09) VALUE             01950001
019600         '---------'.                                             01960001
019700     05  FILLER                      PIC  X(01) VALUE  SPACES.    01970026
019800     05  FILLER                      PIC  X(10) VALUE             01980026
019900         '----------'.                                            01990026
020000     05  FILLER                      PIC  X(01) VALUE  SPACES.    02000026
020100     05  FILLER                      PIC  X(12) VALUE             02010001
020200         '------------'.                                          02020001
020300     05  FILLER                      PIC  X(01) VALUE  SPACES.    02030026
020400     05  FILLER                      PIC  X(50) VALUE             02040026
020500         '--------------------------------------------------'.    02050026
020700                                                                  02070027
020800 01  DL-DETAIL-LINE-1.                                            02080001
020900     05  FILLER                      PIC  X(01) VALUE SPACES.     02090026
021000     05  DL-OPER-UNT-ID              PIC  ZZZ9  VALUE ZERO.       02100026
021100     05  FILLER                      PIC  X(01) VALUE SPACES.     02110026
021200     05  DL-STORE-NBR                PIC  ZZZ9  VALUE ZERO.       02120026
021300     05  FILLER                      PIC  X(01) VALUE SPACES.     02130026
021400     05  DL-PO-RCVR.                                              02140012
021500         10  DL-PO                   PIC  ZZZZZZZZ9 VALUE ZERO.   02150026
021600         10  DL-DASH                 PIC  X(01)     VALUE '-'.    02160026
021700         10  DL-RCVR                 PIC  9(03)     VALUE ZEROES. 02170026
021800         10  DL-RCVR-X  REDEFINES    DL-RCVR                      02180013
021900                                     PIC  X(03).                  02190027
022000     05  FILLER                      PIC  X(03) VALUE SPACES.     02200026
022100     05  DL-REC-TYP                  PIC  X(01) VALUE SPACES.     02210026
022200     05  FILLER                      PIC  X(01) VALUE SPACES.     02220026
022300     05  DL-DEPT-NBR                 PIC  ZZZ9  VALUE ZERO.       02230002
022310     05  FILLER                      PIC  X(02) VALUE SPACES.     02231026
022320     05  DL-SEPH                     PIC  X     VALUE SPACE.      02232026
022400     05  FILLER                      PIC  X(03) VALUE SPACES.     02240026
022500     05  DL-SKU-NBR                  PIC  9(08) VALUE ZEROES.     02250026
022600     05  FILLER                      PIC  X(03) VALUE  SPACES.    02260026
022700     05  DL-STORE-EXP-UNITS          PIC  ZZZZ9-.                 02270001
022800     05  FILLER                      PIC  X(03) VALUE  SPACES.    02280031
022900     05  DL-LAST-ACT-DATE            PIC  X(08) VALUE  ZEROES.    02290031
023000     05  FILLER                      PIC  X(04) VALUE  SPACES.    02300031
023100     05  DL-EXT-RTL-AMT              PIC ZZ,ZZZ.99.               02310001
023200     05  FILLER                      PIC  X(02) VALUE  SPACES.    02320026
023300     05  DL-CLEAN-REASON             PIC  X(50) VALUE  ZEROES.    02330026
023500                                                                  02350001
023600 01  EP-EMPTY-REPORT-LINE.                                        02360001
023700     05  FILLER                       PIC X(54)  VALUE SPACES.    02370001
023800     05  FILLER                       PIC X(24)  VALUE            02380025
023900         '******* NO DATA ********'.                              02390025
024000     05  FILLER                       PIC X(54)  VALUE SPACES.    02400001
024100 01  DL-BLANK-LINE                    PIC X(132) VALUE SPACES.    02410001
024200 01  END-OF-REPORT-LINE.                                          02420001
024300     05  FILLER                  PIC  X(44)    VALUE SPACES.      02430001
024400     05  FILLER                  PIC  X(45)    VALUE              02440001
024500          '*******   E N D   O F   R E P O R T   *******'.        02450001
024600     05  FILLER                  PIC  X(43)    VALUE SPACES.      02460001
024700/                                                                 02470001
024800******************************************************************02480001
024900                                                                  02490001
025000     EXEC SQL                                                     02500001
025100         INCLUDE SQLCA                                            02510001
025200     END-EXEC.                                                    02520001
025300                                                                  02530013
025400     EXEC SQL                                                     02540013
025500         INCLUDE TKRPRPM                                          02550013
025600     END-EXEC.                                                    02560013
025700                                                                  02570001
025800     COPY SQLCA2.                                                 02580001
025900/                                                                 02590001
026000 PROCEDURE DIVISION.                                              02600001
026100                                                                  02610001
026200 0000-MAINLINE.                                                   02620001
026300                                                                  02630001
026400     PERFORM 1000-INITIALIZE                                      02640001
026500                                                                  02650001
026600     PERFORM 2000-PROCESS UNTIL PS-EOF-ERROR-FILE                 02660001
026700                                                                  02670001
026800     PERFORM 9000-EOJ.                                            02680001
026900                                                                  02690001
027000 THE-DUMPER.                                                      02700001
027100     GOBACK.                                                      02710001
027200                                                                  02720001
027300 1000-INITIALIZE.                                                 02730001
027400                                                                  02740001
027500     DISPLAY ' PCKRP020 STARTED'                                  02750001
027600     EXEC SQL SET :PV-TMST = CURRENT TIMESTAMP END-EXEC           02760001
027700                                                                  02770001
027800     OPEN OUTPUT REPORT-FILE                                      02780001
027900* LOAD SYSTEM DATE INTO HEADINGS                                  02790001
028000     ACCEPT SD-SYSTEM-DATE FROM DATE.                             02800001
028100     ACCEPT ST-SYSTEM-TIME FROM TIME.                             02810001
028200                                                                  02820001
028300     MOVE SD-SYSTEM-DATE-YY      TO DP132O-RUN-YEAR.              02830001
028400     MOVE SD-SYSTEM-DATE-MM      TO DP132O-RUN-MONTH.             02840001
028500     MOVE SD-SYSTEM-DATE-DD      TO DP132O-RUN-DAY.               02850001
028600     MOVE ST-SYSTEM-HOUR         TO DP132O-RUN-HOUR.              02860001
028700     MOVE ST-SYSTEM-MINUTE       TO DP132O-RUN-MINUTE.            02870001
028800                                                                  02880001
028900     MOVE PC-CURRENT-PROGRAM-NAME                                 02890001
029000                                 TO DP132O-PROGRAM-NAME.          02900001
029100     MOVE 1                      TO DP132O-REPORT-NUMBER          02910001
029200                                    DP132O-PAGE-NUMBER            02920001
029300                                                                  02930001
029400     PERFORM 8100-WRITE-MAIN-HEADINGS                             02940001
029500                                                                  02950001
029600     OPEN INPUT EXTRACT-FILE                                      02960001
029700     PERFORM 8000-READ-EXTRACT                                    02970001
029800     MOVE PC038-OPER-UNT-ID  TO      PV-PREV-OPER                 02980001
029900     IF PS-EOF-ERROR-FILE                                         02990001
030000         DISPLAY ' -- NO UNBALANCED STR EXP -- '                  03000001
030100         WRITE REPORT-RECORD FROM EP-EMPTY-REPORT-LINE            03010001
030200             AFTER ADVANCING 3 LINES                              03020001
030300     END-IF.                                                      03030001
030400                                                                  03040019
030500     PERFORM 2300-GET-BOSS-PARM-RCVR.                             03050019
030501                                                                  03050121
030510     PERFORM 2400-GET-BDSV-PARM-RCVR.                             03051021
030600/                                                                 03060001
030700 2000-PROCESS.                                                    03070001
030800                                                                  03080001
030900     PERFORM 2100-BUILD-LINE.                                     03090001
031000     IF PS-BLANK-LINE                                             03100001
031100        WRITE REPORT-RECORD FROM DL-BLANK-LINE                    03110001
031200           AFTER ADVANCING 1 LINES                                03120001
031300        ADD 1                   TO PV-LINES-USED                  03130001
031400        SET PS-BLANK-LINE-NO    TO TRUE                           03140001
031500     END-IF                                                       03150001
031600                                                                  03160001
031700     WRITE REPORT-RECORD FROM DL-DETAIL-LINE-1                    03170001
031800            AFTER ADVANCING 1 LINES                               03180001
031900     ADD 1                        TO PV-LINES-USED                03190001
032000                                                                  03200001
032100     IF PV-LINES-USED > PC-END-OF-PAGE                            03210001
032200         PERFORM 8100-WRITE-MAIN-HEADINGS                         03220001
032300     END-IF                                                       03230001
032400                                                                  03240001
032500     PERFORM 8000-READ-EXTRACT.                                   03250001
032600/                                                                 03260001
032700 2100-BUILD-LINE.                                                 03270001
032800     IF   PC038-OPER-UNT-ID    =         PV-PREV-OPER             03280001
032900         MOVE PC038-OPER-UNT-ID       TO DL-OPER-UNT-ID           03290001
033000      ELSE                                                        03300001
033100         SET PS-BLANK-LINE            TO TRUE                     03310001
033200         MOVE PC038-OPER-UNT-ID       TO DL-OPER-UNT-ID           03320001
033300         MOVE PC038-OPER-UNT-ID       TO PV-PREV-OPER             03330001
033400     END-IF.                                                      03340001
033500     MOVE PC038-LOC-NBR               TO DL-STORE-NBR.            03350001
033600     MOVE PC038-PO-NBR                TO DL-PO.                   03360001
033700     MOVE '-'                         TO DL-DASH.                 03370001
033800                                                                  03380021
033900     IF PC038-RCVR-SEQ-NBR = PV-BOSS-PARM-RECV                    03390013
034000        MOVE 'BSS'                    TO DL-RCVR-X                03400013
034100        ADD 1                         TO PV-BOSS-COUNT            03410020
034101     ELSE                                                         03410121
034102        IF PC038-RCVR-SEQ-NBR = PV-BDSV-PARM-RECV                 03410221
034110           MOVE 'BDS'                 TO DL-RCVR-X                03411021
034120           ADD 1                      TO PV-BDSV-COUNT            03412021
034200        ELSE                                                      03420021
034300           MOVE PC038-RCVR-SEQ-NBR    TO DL-RCVR                  03430021
034400        END-IF                                                    03440021
034410     END-IF.                                                      03441021
034500                                                                  03450013
034600     MOVE PC038-REC-TYP-CDE           TO DL-REC-TYP.              03460002
034700     MOVE PC038-DEPT-NBR              TO DL-DEPT-NBR.             03470002
034710     MOVE PC038-SEPHORA-IND           TO DL-SEPH.                 03471028
034800     MOVE PC038-SKU-9                 TO DL-SKU-NBR.              03480001
034900     MOVE PC038-STR-EXPECTED-UNITS    TO DL-STORE-EXP-UNITS.      03490001
035000     MOVE PC038-INTRNST-TRN-DTE       TO PV-DB2-DATE.             03500001
035100     MOVE PV-DB2-YY                   TO PV-KEY-YY.               03510001
035200     MOVE PV-DB2-MM                   TO PV-KEY-MM.               03520001
035300     MOVE PV-DB2-DD                   TO PV-KEY-DD.               03530001
035400     MOVE PV-KEY-DATE                 TO DL-LAST-ACT-DATE.        03540001
035500     MOVE PC038-EXTD-RTL-AMT          TO DL-EXT-RTL-AMT.          03550001
035600     MOVE PC038-CLEAN-REASON          TO DL-CLEAN-REASON.         03560001
035700******************************************************************03570015
035800*- READ TKRPRPM TO RETRIEVE THE BOSS RECEIVER PARM                03580015
035900******************************************************************03590015
036000 2300-GET-BOSS-PARM-RCVR.                                         03600013
036100                                                                  03610013
036200     EXEC SQL                                                     03620013
036300         SELECT FUNC_QTY                                          03630013
036400           INTO :PV-BOSS-PARM-RECV                                03640013
036500           FROM TKRPRPM                                           03650013
036600          WHERE LOC_ID            = 90                            03660013
036700            AND INTFC_SYS_CDE     = 'GIV'                         03670013
036800            AND SYS_PRC_FUNC_CDE  = 'BSSRCV'                      03680013
036900            AND FUNC_PRC_STAT_CDE = 'AC'                          03690013
037000          WITH UR                                                 03700013
037100     END-EXEC.                                                    03710013
037200                                                                  03720016
037300     EVALUATE TRUE                                                03730013
037400          WHEN SQLCODE = +0                                       03740013
037500              MOVE PV-BOSS-PARM-RECV     TO PV-DISPLAY-RECV       03750016
037600              DISPLAY ' BOSS PARM RECEIVER  = '                   03760013
037700                                            PV-DISPLAY-RECV       03770016
037800                                                                  03780013
037900          WHEN SQLCODE = +100                                     03790013
038000              MOVE ZEROES                TO PV-BOSS-PARM-RECV     03800013
038100                                                                  03810013
038200          WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                 03820013
038300              DISPLAY '**************************************'    03830013
038400              DISPLAY '2300-GET-BOSS-PARM-RCVR               '    03840013
038500              DISPLAY 'SELECT TKRPRPM - BOSS RECEIVER        '    03850013
038600              DISPLAY '**************************************'    03860013
038700              PERFORM 9300-SQL-WARNING                            03870013
038800                                                                  03880013
038900          WHEN SQLCODE < ZERO                                     03890013
039000              DISPLAY '**************************************'    03900013
039100              DISPLAY '2300-GET-BOSS-PARM-RCVR               '    03910013
039200              DISPLAY 'ERROR ISSUED ON                       '    03920013
039300              DISPLAY 'SELECT TKRPRPM - BOSS RECEIVER        '    03930013
039400              DISPLAY '**************************************'    03940013
039500              PERFORM 9200-SQL-ERROR                              03950013
039600                                                                  03960013
039700      END-EVALUATE.                                               03970013
039800/                                                                 03980001
039810******************************************************************03981021
039820*- READ TKRPRPM TO RETRIEVE THE BOSS DSV RECEIVER PARM            03982021
039830******************************************************************03983021
039840 2400-GET-BDSV-PARM-RCVR.                                         03984021
039850                                                                  03985021
039860     EXEC SQL                                                     03986021
039870         SELECT FUNC_QTY                                          03987021
039880           INTO :PV-BDSV-PARM-RECV                                03988021
039890           FROM TKRPRPM                                           03989021
039891          WHERE LOC_ID            = 90                            03989121
039892            AND INTFC_SYS_CDE     = 'GIV'                         03989221
039893            AND SYS_PRC_FUNC_CDE  = 'BSDSRC'                      03989321
039894            AND FUNC_PRC_STAT_CDE = 'AC'                          03989421
039895          WITH UR                                                 03989521
039896     END-EXEC.                                                    03989621
039897                                                                  03989721
039898     EVALUATE TRUE                                                03989821
039899          WHEN SQLCODE = +0                                       03989921
039900              MOVE PV-BDSV-PARM-RECV     TO PV-DISPLAY-RECV       03990021
039901              DISPLAY ' BOSS DSV PARM RECEIVER  = '               03990121
039902                                            PV-DISPLAY-RECV       03990221
039903                                                                  03990321
039904          WHEN SQLCODE = +100                                     03990421
039905              MOVE ZEROES                TO PV-BOSS-PARM-RECV     03990521
039906                                                                  03990621
039907          WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                 03990721
039908              DISPLAY '**************************************'    03990821
039909              DISPLAY '2400-GET-BDSV-PARM-RCVR               '    03990921
039910              DISPLAY 'SELECT TKRPRPM - BOSS DSV RECEIVER    '    03991021
039911              DISPLAY '**************************************'    03991121
039912              PERFORM 9300-SQL-WARNING                            03991221
039913                                                                  03991321
039914          WHEN SQLCODE < ZERO                                     03991421
039915              DISPLAY '**************************************'    03991521
039916              DISPLAY '2400-GET-BDSV-PARM-RCVR               '    03991621
039917              DISPLAY 'ERROR ISSUED ON                       '    03991721
039918              DISPLAY 'SELECT TKRPRPM - BOSS DSV RECEIVER    '    03991821
039919              DISPLAY '**************************************'    03991921
039920              PERFORM 9200-SQL-ERROR                              03992021
039921                                                                  03992121
039922      END-EVALUATE.                                               03992221
039923/                                                                 03992321
039930 8000-READ-EXTRACT.                                               03993021
040000     READ EXTRACT-FILE                                            04000001
040100         INTO PC038-SE-UNBALANCED-RPT-REC                         04010001
040200     AT END                                                       04020001
040300         SET PS-EOF-ERROR-FILE        TO TRUE                     04030001
040400     NOT AT END                                                   04040001
040500         ADD 1                        TO PV-READ-COUNT            04050001
040600     END-READ.                                                    04060001
040700                                                                  04070001
040800 8100-WRITE-MAIN-HEADINGS.                                        04080001
040900                                                                  04090001
041000     ADD 1                            TO PV-PAGE-COUNT.           04100001
041100     MOVE PV-PAGE-COUNT               TO DP132O-PAGE-NUMBER.      04110001
041200     MOVE ZERO                        TO PV-LINES-USED            04120001
041300                                                                  04130001
041400     WRITE REPORT-RECORD FROM DP132O-STANDRD-HEADER-132-COLS      04140001
041500                 AFTER ADVANCING PAGE                             04150001
041600                                                                  04160001
041700     WRITE REPORT-RECORD FROM HL-HEADING-LINE-1                   04170001
041800        AFTER ADVANCING 2 LINES.                                  04180001
041900     WRITE REPORT-RECORD FROM HL-HEADING-LINE-1A                  04190001
042000        AFTER ADVANCING 1 LINES.                                  04200001
042100     WRITE REPORT-RECORD FROM DL-BLANK-LINE                       04210001
042200        AFTER ADVANCING 1 LINES.                                  04220001
042300     WRITE REPORT-RECORD FROM HL-HEADING-LINE-2A                  04230001
042400        AFTER ADVANCING 1 LINES.                                  04240001
042500     WRITE REPORT-RECORD FROM HL-HEADING-LINE-2                   04250001
042600        AFTER ADVANCING 1 LINES.                                  04260001
042700     ADD 6                            TO PV-LINES-USED.           04270001
042800                                                                  04280001
042900     WRITE REPORT-RECORD FROM HL-HEADING-LINE-3                   04290001
043000        AFTER ADVANCING 2 LINES.                                  04300001
043100                                                                  04310001
043200     WRITE REPORT-RECORD FROM DL-BLANK-LINE                       04320001
043300        AFTER ADVANCING 1 LINES.                                  04330001
043400                                                                  04340001
043500     INITIALIZE DP132O-LASER-NEW-PAGE-INDICATR.                   04350001
043600     ADD  3                           TO PV-LINES-USED.           04360001
043700/                                                                 04370001
043800 9000-EOJ.                                                        04380001
043900                                                                  04390001
044000     WRITE REPORT-RECORD                                          04400001
044100       FROM END-OF-REPORT-LINE                                    04410001
044200         AFTER ADVANCING 2 LINES.                                 04420001
044300                                                                  04430001
044400                                                                  04440001
044500     CLOSE REPORT-FILE                                            04450001
044600           EXTRACT-FILE.                                          04460001
044700     MOVE PV-READ-COUNT               TO PV-DISP-COUNT            04470001
044800     DISPLAY ' RECORDS READ          = ' PV-DISP-COUNT.           04480021
044900     MOVE PV-BOSS-COUNT               TO PV-DISP-COUNT            04490020
045000     DISPLAY ' BOSS RECORDS READ     = ' PV-DISP-COUNT.           04500021
045010     MOVE PV-BDSV-COUNT               TO PV-DISP-COUNT            04501021
045020     DISPLAY ' BOSS DSV RECORDS READ = ' PV-DISP-COUNT.           04502021
045100/                                                                 04510001
045200 9100-ABEND.                                                      04520001
045300                                                                  04530001
045400     CLOSE EXTRACT-FILE                                           04540001
045500           REPORT-FILE                                            04550001
045600                                                                  04560001
045700     MOVE +4013                       TO ABEND-CODE.              04570001
045800     CALL 'ILBOABN0' USING ABEND-CODE.                            04580001
045900                                                                  04590001
046000 9200-SQL-ERROR.                                                  04600001
046100                                                                  04610001
046200     MOVE SQLCODE                     TO SQLCODE2.                04620001
046300     MOVE SQLERRD(3)                  TO SQLERRD3.                04630001
046400                                                                  04640001
046500     DISPLAY '** ABEND **         ** = SQLERROR'.                 04650001
046600     DISPLAY '** PROGRAM   ** = ' PC-CURRENT-PROGRAM-NAME.        04660001
046700     DISPLAY '** PARAGRAPH ** = ' PV-PARAGRAPH.                   04670001
046800     DISPLAY '** OPERATION ** = ' PV-DB2-FUNCTION.                04680001
046900                                                                  04690001
047000     DISPLAY '** SQLCODE          ** = ' SQLCODE2.                04700001
047100     DISPLAY '** ROWS PROCESSED   ** = ' SQLERRD3.                04710001
047200     DISPLAY '** SQLERRM          ** = ' SQLERRM.                 04720001
047300     DISPLAY '** SQLERRMC         ** = ' SQLERRMC.                04730001
047400                                                                  04740001
047500                                                                  04750001
047600     MOVE +4013                       TO ABEND-CODE.              04760001
047700     CALL 'ILBOABN0' USING ABEND-CODE.                            04770001
047800                                                                  04780001
047900 9300-SQL-WARNING.                                                04790001
048000                                                                  04800001
048100     DISPLAY '9300-SQL-WARNING'.                                  04810001
048200     DISPLAY '** PROGRAM   ** = ' PC-CURRENT-PROGRAM-NAME.        04820001
048300     DISPLAY '** PARAGRAPH ** = ' PV-PARAGRAPH.                   04830001
048400     DISPLAY '** OPERATION ** = ' PV-DB2-FUNCTION.                04840001
048500                                                                  04850001
048600     MOVE SQLCODE                     TO SQLCODE2.                04860001
048700     MOVE SQLERRD(3)                  TO SQLERRD3.                04870001
048800     DISPLAY '** ABEND **       ** = SQLWARNING'.                 04880001
048900     DISPLAY '** SQLCODE        ** = ' SQLCODE2.                  04890001
049000     DISPLAY '** ROWS PROCESSED ** = ' SQLERRD3.                  04900001
049100     DISPLAY '** SQLWARN0       ** = ' SQLWARN0.                  04910001
049200     DISPLAY '** SQLWARN1       ** = ' SQLWARN1.                  04920001
049300     DISPLAY '** SQLWARN2       ** = ' SQLWARN2.                  04930001
049400     DISPLAY '** SQLWARN3       ** = ' SQLWARN3.                  04940001
049500     DISPLAY '** SQLWARN4       ** = ' SQLWARN4.                  04950001
049600     DISPLAY '** SQLWARN5       ** = ' SQLWARN5.                  04960001
049700     DISPLAY '** SQLWARN6       ** = ' SQLWARN6.                  04970001
049800     DISPLAY '** SQLWARN7       ** = ' SQLWARN7.                  04980001
049900                                                                  04990001
050000     MOVE +4013                       TO ABEND-CODE.              05000001
050100     CALL 'ILBOABN0' USING ABEND-CODE.                            05010001
050200                                                                  05020001
