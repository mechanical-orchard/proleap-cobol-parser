000100 IDENTIFICATION DIVISION.                                         00010000
000200 PROGRAM-ID.    MLKUT412.                                         00020009
000300 AUTHOR.        JOHN SELWITSCHKA.                                 00030001
000400 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00040000
000500 DATE-WRITTEN.  01-22-2007.                                       00050001
000600 DATE-COMPILED.                                                   00060000
000700******************************************************************00070000
000800*                                                                 00080000
000900* MLKUT412 -                                                      00090009
001000*                                                                 00100000
001100* THIS PROGRAM WAS CLONED FROM MLKUT419. IT COMPARES A DATA       00110008
001100* INTEGRITY EXTRACT FILE FROM MLT_WKLY_SUM TO A DATA INTEGRITY    00110108
001100* EXTRACT FILE FROM TWKMCLC AND CREATES A REPORT FILE OF THE      00110208
001100* DIFFERENCES.                                                    00110308
001100*                                                                 00110408
001400* ONE EXTRACT FILE WILL BE DESIGNATED AS THE 'LOW' EXTRACT FILE,  00140000
001500* AND THE OTHER WILL BE DESIGNATED AS THE 'HIGH' EXTRACT FILE.    00150000
001600* THE 'LOW' EXTRACT FILE CORRESPONDS TO THE LOWER-LEVEL TABLE OF  00160000
001700* THE TWO TABLES BEING COMPARED.                                  00170000
001800*                                                                 00180000
007300******************************************************************00730000
007400* CHG ID   DATE        DESCRIPTION                               *00740000
007500* ------   ----------  ----------------------------------------- *00750000
007600* W28582   01-22-2007  NEW PROGRAM. CLONED FROM MLKUT419.        *00760008
007900*                      - JOHN SELWITSCHKA                        *00790008
008000******************************************************************00800000
008100*                                                                 00810000
008200 ENVIRONMENT DIVISION.                                            00820000
008300*                                                                 00830000
008400 CONFIGURATION SECTION.                                           00840000
008500*                                                                 00850000
008600 SOURCE-COMPUTER.        IBM-3090.                                00860000
008700 OBJECT-COMPUTER.        IBM-3090.                                00870000
008800*                                                                 00880000
008900 INPUT-OUTPUT SECTION.                                            00890000
009000 FILE-CONTROL.                                                    00900000
009100                                                                  00910000
009200     SELECT COMPARE-TABLES-CTL-FILE                               00920000
009300         ASSIGN TO INP01.                                         00930000
009400                                                                  00940000
009500     SELECT L-DATA-INTEGRITY-EXTR-FILE                            00950000
009600         ASSIGN TO INP02.                                         00960000
009700                                                                  00970000
009800     SELECT H-DATA-INTEGRITY-EXTR-FILE                            00980000
009900         ASSIGN TO INP03.                                         00990000
010000                                                                  01000000
010100     SELECT DATA-INTEGRITY-DIFF-FILE                              01010000
010200         ASSIGN TO OUT01.                                         01020000
010300                                                                  01030000
010400******************************************************************01040000
010500 DATA DIVISION.                                                   01050000
010600******************************************************************01060000
010700                                                                  01070000
010800 FILE SECTION.                                                    01080000
010900                                                                  01090000
011000 FD  COMPARE-TABLES-CTL-FILE                                      01100000
011100     LABEL RECORDS ARE STANDARD                                   01110000
011200     RECORDING MODE IS F                                          01120000
011300     BLOCK CONTAINS 0 RECORDS.                                    01130000
011400 01  COMPARE-TABLES-CTL-REC      PIC X(80).                       01140000
011500                                                                  01150000
011600 FD  L-DATA-INTEGRITY-EXTR-FILE                                   01160000
011700     LABEL RECORDS ARE STANDARD                                   01170000
011800     RECORDING MODE IS F                                          01180000
011900     BLOCK CONTAINS 0 RECORDS.                                    01190000
012100 01  L-DATA-INTEGRITY-EXTR-REC   PIC X(204).                      01211002
012200                                                                  01220000
012300 FD  H-DATA-INTEGRITY-EXTR-FILE                                   01230000
012400     LABEL RECORDS ARE STANDARD                                   01240000
012500     RECORDING MODE IS F                                          01250000
012600     BLOCK CONTAINS 0 RECORDS.                                    01260000
012800 01  H-DATA-INTEGRITY-EXTR-REC   PIC X(204).                      01281002
012900                                                                  01290000
013000 FD  DATA-INTEGRITY-DIFF-FILE                                     01300000
013100     RECORDING MODE IS F                                          01310000
013200     LABEL RECORDS ARE STANDARD                                   01320000
013300     BLOCK CONTAINS 0 RECORDS.                                    01330000
013400                                                                  01340000
013600 01  DATA-INTEGRITY-DIFF-REC     PIC X(80).                       01360000
013700                                                                  01370000
013800*                                                                 01380000
013900******************************************************************01390000
014000 WORKING-STORAGE SECTION.                                         01400000
014100******************************************************************01410000
014200                                                                  01420000
014300 01  PS-PROGRAM-SWITCHES.                                         01430000
014400     05  PS-MORE-LOW-EXTR-RECS-SW                                 01440000
014500                                 PIC X       VALUE 'Y'.           01450000
014600         88  PS-MORE-LOW-EXTR-RECS           VALUE 'Y'.           01460000
014700         88  PS-NO-MORE-LOW-EXTR-RECS        VALUE 'N'.           01470000
014800     05  PS-MORE-HIGH-EXTR-RECS-SW                                01480000
014900                                 PIC X       VALUE 'Y'.           01490000
015000         88  PS-MORE-HIGH-EXTR-RECS          VALUE 'Y'.           01500000
015100         88  PS-NO-MORE-HIGH-EXTR-RECS       VALUE 'N'.           01510000
015200     05  PS-BYPASS-0-DOLLARS-SW  PIC X.                           01520000
015300         88  PS-BYPASS-0-DOLLARS             VALUE 'Y'.           01530000
015400         88  PS-NO-BYPASS-DOLLARS            VALUE 'N'.           01540000
015500                                                                  01550000
015600 01  PA-PROGRAM-ACCUMULATORS                 COMP-3.              01560000
015700     05  PA-LOW-RECS-READ        PIC S9(13)  VALUE ZERO.          01570000
015800     05  PA-HIGH-RECS-READ       PIC S9(13)  VALUE ZERO.          01580000
015900     05  PA-KEY-MATCHES          PIC S9(13)  VALUE ZERO.          01590000
016000     05  PA-REPORT-RECS-WRITTEN  PIC S9(13)  VALUE ZERO.          01600000
016100                                                                  01610000
016200 01  CD-COUNTER-DISPLAY.                                          01620000
016300     05  CD-COUNT-HOLD1          PIC Z,ZZZ,ZZZ,ZZZ,ZZ9.           01630000
016400                                                                  01640000
016900 01  PC-PROGRAM-CONSTANTS.                                        01690000
017900     05  PC-LOW-TABLE-TWKPOSS    PIC X(07) VALUE 'TWKPOSS'.       01790000
018000     05  PC-HIGH-TABLE-TWKSCLS   PIC X(07) VALUE 'TWKSCLS'.       01800000
018100     05  PC-LOW-TABLE-TVADPT     PIC X(07) VALUE 'TVADPT '.       01810000
018200     05  PC-LOW-TABLE-TVAMCL     PIC X(07) VALUE 'TVAMCL '.       01820000
018300     05  PC-LOW-TABLE-TWKDPTS    PIC X(07) VALUE 'TWKDPTS'.       01830000
018400     05  PC-LOW-TABLE-TWKDPTC    PIC X(07) VALUE 'TWKDPTC'.       01840000
018500     05  PC-LOW-TABLE-TMNDPTC    PIC X(07) VALUE 'TMNDPTC'.       01850000
018600     05  PC-LOW-TABLE-TMNMCLC    PIC X(07) VALUE 'TMNMCLC'.       01860000
018700     05  PC-LOW-TABLE-TWKMCLC    PIC X(07) VALUE 'TWKMCLC'.       01870000
018710     05  PC-LOW-TABLE-WKLYSUM    PIC X(07) VALUE 'WKLYSUM'.       01871000
018720     05  PC-LOW-TABLE-MNLYSUM    PIC X(07) VALUE 'MNLYSUM'.       01872000
018800                                                                  01880000
018900 01  PV-PROGRAM-VARIABLES.                                        01890000
019000     05  PV-LOW-FILE-KEY.                                         01900000
019100         10  PV-LOW-FK-FSCL-WK-END-DTE                            01910002
019200                                 PIC X(10).                       01920000
019300*        10  PV-LOW-FK-FSCL-MN-NBR                                01930002
019400*                                PIC X(02).                       01940002
019500         10  PV-LOW-FK-DEPT-NBR  PIC X(03).                       01950000
019600         10  PV-LOW-FK-MAJ-CL-NBR                                 01960000
019700                                 PIC X(02).                       01970000
019800*        10  PV-LOW-FK-SUB-CL-NBR                                 01980007
019900*                                PIC X(02).                       01990007
020000*        10  PV-LOW-FK-STR-NBR   PIC S9(4) COMP.                  02000007
020000*        10  PV-LOW-FK-DKEY-NBR  PIC X(15).                       02001007
020100     05  PV-HIGH-FILE-KEY.                                        02010000
020200         10  PV-HIGH-FK-FSCL-WK-END-DTE                           02020002
020300                                 PIC X(10).                       02030000
020400*        10  PV-HIGH-FK-FSCL-MN-NBR                               02040002
020500*                                PIC X(02).                       02050002
020600         10  PV-HIGH-FK-DEPT-NBR PIC X(03).                       02060000
020700         10  PV-HIGH-FK-MAJ-CL-NBR                                02070000
020800                                 PIC X(02).                       02080000
020900*        10  PV-HIGH-FK-SUB-CL-NBR                                02090007
021000*                                PIC X(02).                       02100007
021100*        10  PV-HIGH-FK-STR-NBR  PIC S9(4) COMP.                  02110007
      *        10  PV-HIGH-FK-DKEY-NBR PIC X(15).                       02111007
021200                                                                  02120000
021300     05  PV-DIFF-SHNK-RTL-AMT    PIC S9(11)V99 COMP-3.            02130000
021400                                                                  02140000
021500 01 ABEND-AREAS.                                                  02150000
021600     05 ABEND-CODE               PIC S9(04)  VALUE ZERO           02160000
021700                                             COMP SYNC.           02170000
021800         88  AC-BAD-DATA                     VALUE +4003.         02180000
021900         88  AC-DB2-ERROR                    VALUE +4013.         02190000
022000     05  AA-ABEND-LIT            PIC X(40)   VALUE                02200000
022100           '*****       ABEND'.                                   02210000
022200     05  AA-PROGRAM-LIT          PIC X(40)   VALUE                02220000
022300             '*****   PROGRAM: MLKUT412'.                         02230009
022400     05  AA-PARAGRAPH-LIT.                                        02240000
022500         10  FILLER              PIC X(17)   VALUE                02250000
022600             '***** PARAGRAPH: '.                                 02260000
022700         10  AA-PARAGRAPH-NAME   PIC X(35)   VALUE SPACES.        02270000
022800     05  AA-MESSAGE-LINE.                                         02280000
022900         10  FILLER              PIC X(06)   VALUE '*****'.       02290000
023000         10  AA-MESSAGE          PIC X(127)  VALUE SPACES.        02300000
023100     05  AA-DB2-ERROR-LIT        PIC X(40)   VALUE                02310000
023200             '*****    DB2 ERROR'.                                02320000
023300     05  AA-DB2-OPERATION-LIT.                                    02330000
023400         10  FILLER              PIC X(17)   VALUE                02340000
023500             '***** OPERATION: '.                                 02350000
023600         10  AA-DB2-OPERATION.                                    02360000
023700             15  AA-DB2-OP-1     PIC X(25)   VALUE SPACES.        02370000
023800             15  AA-DB2-OP-2     PIC X(25)   VALUE SPACES.        02380000
023900     05  AA-DB2-TABLE-1          PIC X(08)   VALUE SPACES.        02390000
024000     05  AA-DB2-TABLE-2          PIC X(08)   VALUE SPACES.        02400000
024100     05  AA-DB2-TABLE-3          PIC X(08)   VALUE SPACES.        02410000
024200     05  AA-DB2-TABLE-4          PIC X(08)   VALUE SPACES.        02420000
024300                                                                  02430000
024400 EJECT                                                            02440000
024500                                                                  02450000
024600*** DATA INTEGRITY COMPARE TABLES CONTROL CARD                    02460000
024700 01  CC-CONTROL-CARD-REC.                                         02470000
024800     05  CC-LOW-TABLE            PIC X(7).                        02480000
024900     05  FILLER                  PIC X.                           02490000
025000     05  CC-HIGH-TABLE           PIC X(7).                        02500000
025100     05  FILLER                  PIC X(65).                       02510000
025200                                                                  02520000
025300                                                                  02530000
025400*** L O W                                                         02540000
025500*** DATA INTEGRITY EXTRACT FILE                                   02550000
025600     COPY MLRD141 REPLACING ML141 BY LLLOW.                       02560010
025700                                                                  02570000
025800                                                                  02580000
025900*** H I G H                                                       02590000
026000*** DATA INTEGRITY EXTRACT FILE                                   02600000
026100     COPY MLRD141 REPLACING ML141 BY HHIGH.                       02610010
026200                                                                  02620000
026300                                                                  02630000
026400*** DATA INTEGRITY DIFFERENCE REPORT FILE                         02640000
026500     COPY MLRD112.                                                02650000
026600                                                                  02660000
026700 EJECT                                                            02670000
026800                                                                  02680000
026900******************************************************************02690000
027000 PROCEDURE DIVISION.                                              02700000
027100******************************************************************02710000
027200                                                                  02720000
027300******************************************************************02730000
027400 0000-MAINLINE-MLKUT412.                                          02740009
027500******************************************************************02750000
027600*                                                                 02760000
027700     PERFORM 1000-INITIALIZATION.                                 02770000
027800                                                                  02780000
027900     PERFORM 2000-MAIN-PROCESS.                                   02790000
028000                                                                  02800000
028100     PERFORM 8000-EOJ.                                            02810000
028200                                                                  02820000
028300     STOP RUN.                                                    02830000
028400                                                                  02840000
028500 EJECT                                                            02850000
028600                                                                  02860000
028700******************************************************************02870000
028800 1000-INITIALIZATION.                                             02880000
028900******************************************************************02890000
029000*                                                                 02900000
029100     OPEN INPUT  COMPARE-TABLES-CTL-FILE                          02910000
029200                 L-DATA-INTEGRITY-EXTR-FILE                       02920000
029300                 H-DATA-INTEGRITY-EXTR-FILE.                      02930000
029400     OPEN OUTPUT DATA-INTEGRITY-DIFF-FILE.                        02940000
029500                                                                  02950000
029600     PERFORM 4000-READ-CONTROL-CARD.                              02960000
029700                                                                  02970000
029800     DISPLAY ' '.                                                 02980000
029900     DISPLAY '*** MLKUT412 INPUT CONTROL CARD VALUES ***'         02990009
030000     DISPLAY CC-CONTROL-CARD-REC.                                 03000000
030100                                                                  03010000
030200     INITIALIZE PA-PROGRAM-ACCUMULATORS.                          03020000
030300     INITIALIZE PV-PROGRAM-VARIABLES.                             03030000
030400                                                                  03040000
030500 EJECT                                                            03050000
030600                                                                  03060000
030700******************************************************************03070000
030800 2000-MAIN-PROCESS.                                               03080000
030900******************************************************************03090000
031000*                                                                 03100000
031100     PERFORM 4100-READ-LOW-EXTRACT-FILE.                          03110000
031200                                                                  03120000
031300     IF PS-NO-MORE-LOW-EXTR-RECS                                  03130000
031400         MOVE '2000-MAIN-PROCESS'                                 03140000
031500                                 TO AA-PARAGRAPH-NAME             03150000
031600         MOVE 'EMPTY LOW EXTRACT FILE'                            03160000
031700                                 TO AA-MESSAGE                    03170000
031800         MOVE +4002              TO ABEND-CODE                    03180000
031900         PERFORM 9900-COMMON-ABEND-ROUTINE                        03190000
032000     END-IF.                                                      03200000
032100                                                                  03210000
032200     PERFORM 4200-READ-HIGH-EXTRACT-FILE.                         03220000
032300                                                                  03230000
032400     IF PS-NO-MORE-HIGH-EXTR-RECS                                 03240000
032500         MOVE '2000-MAIN-PROCESS'                                 03250000
032600                                 TO AA-PARAGRAPH-NAME             03260000
032700         MOVE 'EMPTY HIGH EXTRACT FILE'                           03270000
032800                                 TO AA-MESSAGE                    03280000
032900         MOVE +4003              TO ABEND-CODE                    03290000
033000         PERFORM 9900-COMMON-ABEND-ROUTINE                        03300000
033100     END-IF.                                                      03310000
033200                                                                  03320000
033300     PERFORM                                                      03330000
033400       UNTIL PS-NO-MORE-LOW-EXTR-RECS                             03340000
033500         AND PS-NO-MORE-HIGH-EXTR-RECS                            03350000
033600         PERFORM 2100-COMPARE-FILES                               03360000
033700     END-PERFORM.                                                 03370000
033800                                                                  03380000
033900 EJECT                                                            03390000
034000                                                                  03400000
034100******************************************************************03410000
034200 2100-COMPARE-FILES.                                              03420000
034300******************************************************************03430000
034400*                                                                 03440000
034500     PERFORM 3000-BUILD-FILE-KEYS.                                03450000
034600                                                                  03460000
034700     IF PV-LOW-FILE-KEY = PV-HIGH-FILE-KEY                        03470000
034800         ADD 1                   TO PA-KEY-MATCHES                03480000
034900         IF CC-LOW-TABLE = PC-LOW-TABLE-TWKPOSS                   03490000
035000            AND                                                   03500000
035100            CC-HIGH-TABLE = PC-HIGH-TABLE-TWKSCLS                 03510000
035200             PERFORM 5400-COMPARE-BOTH-FILE-AMTS                  03520000
035300         ELSE                                                     03530000
035400             PERFORM 5100-COMPARE-BOTH-FILE-AMTS                  03540000
035500         END-IF                                                   03550000
035600         PERFORM 4100-READ-LOW-EXTRACT-FILE                       03560000
035700         PERFORM 4200-READ-HIGH-EXTRACT-FILE                      03570000
035800     ELSE                                                         03580000
035900         IF PV-LOW-FILE-KEY < PV-HIGH-FILE-KEY                    03590000
036000             PERFORM 5200-PROCESS-ONLY-LOW-FILE                   03600000
036100             PERFORM 4100-READ-LOW-EXTRACT-FILE                   03610000
036200         ELSE                                                     03620000
036300             PERFORM 5300-PROCESS-ONLY-HIGH-FILE                  03630000
036400             PERFORM 4200-READ-HIGH-EXTRACT-FILE                  03640000
036500         END-IF                                                   03650000
036600     END-IF.                                                      03660000
036700                                                                  03670000
036800 EJECT                                                            03680000
036900                                                                  03690000
037000******************************************************************03700000
037100 3000-BUILD-FILE-KEYS.                                            03710000
037200******************************************************************03720000
037300*                                                                 03730000
037400     INITIALIZE PV-LOW-FILE-KEY.                                  03740000
037500     INITIALIZE PV-HIGH-FILE-KEY.                                 03750000
037600                                                                  03760000
037700     IF LLLOW-DATA-INTEGRITY-EXTR-REC = HIGH-VALUES               03770000
037800         MOVE HIGH-VALUES        TO PV-LOW-FILE-KEY               03780000
037900     ELSE                                                         03790000
038000         MOVE LLLOW-FSCL-WK-END-DTE                               03800002
038100                                 TO PV-LOW-FK-FSCL-WK-END-DTE     03810002
038200*        MOVE LLLOW-FSCL-MN-NBR  TO PV-LOW-FK-FSCL-MN-NBR         03820002
038300         MOVE LLLOW-DEPT-NBR     TO PV-LOW-FK-DEPT-NBR            03830000
038300         MOVE LLLOW-MAJ-CL-NBR   TO PV-LOW-FK-MAJ-CL-NBR          03831004
047200     END-IF.                                                      04720000
047300                                                                  04730000
047400     IF HHIGH-DATA-INTEGRITY-EXTR-REC = HIGH-VALUES               04740000
047500         MOVE HIGH-VALUES        TO PV-HIGH-FILE-KEY              04750000
047600     ELSE                                                         04760000
047700         MOVE HHIGH-FSCL-WK-END-DTE                               04770002
047800                                 TO PV-HIGH-FK-FSCL-WK-END-DTE    04780002
047900*        MOVE HHIGH-FSCL-MN-NBR  TO PV-HIGH-FK-FSCL-MN-NBR        04790002
048000         MOVE HHIGH-DEPT-NBR     TO PV-HIGH-FK-DEPT-NBR           04800000
048100         MOVE HHIGH-MAJ-CL-NBR   TO PV-HIGH-FK-MAJ-CL-NBR         04810000
048200*        MOVE HHIGH-SUB-CL-NBR   TO PV-HIGH-FK-SUB-CL-NBR         04820002
048300*        MOVE HHIGH-STR-NBR      TO PV-HIGH-FK-STR-NBR            04830002
048300*        MOVE HHIGH-DKEY-NBR     TO PV-HIGH-FK-DKEY-NBR           04831002
048400     END-IF.                                                      04840000
048500                                                                  04850000
048600 EJECT                                                            04860000
048700                                                                  04870000
048800******************************************************************04880000
048900 4000-READ-CONTROL-CARD.                                          04890000
049000******************************************************************04900000
049100*                                                                 04910000
049200     READ COMPARE-TABLES-CTL-FILE                                 04920000
049300       INTO CC-CONTROL-CARD-REC                                   04930000
049400         AT END                                                   04940000
049500             MOVE '4000-READ-CONTROL-CARD'                        04950000
049600                                 TO AA-PARAGRAPH-NAME             04960000
049700             MOVE 'CONTROL CARD IS MISSING'                       04970000
049800                                 TO AA-MESSAGE                    04980000
049900             MOVE +4001          TO ABEND-CODE                    04990000
050000             PERFORM 9900-COMMON-ABEND-ROUTINE                    05000000
050100     END-READ.                                                    05010000
050200                                                                  05020000
050300 EJECT                                                            05030000
050400                                                                  05040000
050500******************************************************************05050000
050600 4100-READ-LOW-EXTRACT-FILE.                                      05060000
050700******************************************************************05070000
050800*                                                                 05080000
050900     IF PS-MORE-LOW-EXTR-RECS                                     05090000
051000         READ L-DATA-INTEGRITY-EXTR-FILE                          05100000
051100           INTO LLLOW-DATA-INTEGRITY-EXTR-REC                     05110000
051200             AT END                                               05120000
051300                 SET PS-NO-MORE-LOW-EXTR-RECS                     05130000
051400                                 TO TRUE                          05140000
051500                 MOVE HIGH-VALUES                                 05150000
051600                                 TO LLLOW-DATA-INTEGRITY-EXTR-REC 05160000
051700         END-READ                                                 05170000
051800     END-IF.                                                      05180000
051900                                                                  05190000
052000     IF PS-MORE-LOW-EXTR-RECS                                     05200000
052100         ADD 1                   TO PA-LOW-RECS-READ              05210000
052200     END-IF.                                                      05220000
052300                                                                  05230000
052400 EJECT                                                            05240000
052500                                                                  05250000
052600******************************************************************05260000
052700 4200-READ-HIGH-EXTRACT-FILE.                                     05270000
052800******************************************************************05280000
052900*                                                                 05290000
053000     IF PS-MORE-HIGH-EXTR-RECS                                    05300000
053100         READ H-DATA-INTEGRITY-EXTR-FILE                          05310000
053200           INTO HHIGH-DATA-INTEGRITY-EXTR-REC                     05320000
053300             AT END                                               05330000
053400                 SET PS-NO-MORE-HIGH-EXTR-RECS                    05340000
053500                                 TO TRUE                          05350000
053600                 MOVE HIGH-VALUES                                 05360000
053700                                 TO HHIGH-DATA-INTEGRITY-EXTR-REC 05370000
053800         END-READ                                                 05380000
053900     END-IF.                                                      05390000
054000                                                                  05400000
054100     IF PS-MORE-HIGH-EXTR-RECS                                    05410000
054200         ADD 1                   TO PA-HIGH-RECS-READ             05420000
054300     END-IF.                                                      05430000
054400                                                                  05440000
054500 EJECT                                                            05450000
054600                                                                  05460000
054700******************************************************************05470000
054800 5100-COMPARE-BOTH-FILE-AMTS.                                     05480000
054900******************************************************************05490000
055000*                                                                 05500000
055100     MOVE HHIGH-FSCL-WK-END-DTE  TO ML112-FSCL-MN-END-DTE.        05510006
055300     MOVE HHIGH-DEPT-NBR         TO ML112-DEPT-NBR.               05530000
055400     MOVE HHIGH-MAJ-CL-NBR       TO ML112-MAJ-CL-NBR.             05540000
055500*    MOVE HHIGH-SUB-CL-NBR       TO ML112-SUB-CL-NBR.             05550002
055600*    MOVE HHIGH-STR-NBR          TO ML112-STR-NBR.                05560002
055600*    MOVE HHIGH-DKEY-NBR         TO ML112-DKEY-NBR.               05561002
      *    DISPLAY 'HHIGH-DKEY-NBR: ' HHIGH-DKEY-NBR.                   05562002
      *    DISPLAY 'ML112-DKEY-NBR: ' ML112-DKEY-NBR.                   05563002
      *    DISPLAY ' '.                                                 05564002
055700                                                                  05570000
055800     IF LLLOW-SLS-RTL-AMT NOT = HHIGH-SLS-RTL-AMT                 05580000
055900         MOVE LLLOW-SLS-RTL-AMT  TO ML112-LOW-TBL-AMT             05590000
056000         MOVE HHIGH-SLS-RTL-AMT  TO ML112-HIGH-TBL-AMT            05600000
056100         MOVE 3                  TO ML112-ERR-MSG-NBR             05610000
056200         WRITE DATA-INTEGRITY-DIFF-REC                            05620000
056300             FROM ML112-DATA-INTEGRITY-DIFF-REC                   05630000
056400         ADD 1                   TO PA-REPORT-RECS-WRITTEN        05640000
056500     END-IF.                                                      05650000
056600                                                                  05660000
055800     IF LLLOW-MKDN-PLU-RTL-AMT NOT = HHIGH-MKDN-PLU-RTL-AMT       05661002
055900         MOVE LLLOW-MKDN-PLU-RTL-AMT TO ML112-LOW-TBL-AMT         05662002
056000         MOVE HHIGH-MKDN-PLU-RTL-AMT TO ML112-HIGH-TBL-AMT        05663002
056100         MOVE 4                  TO ML112-ERR-MSG-NBR             05664002
056200         WRITE DATA-INTEGRITY-DIFF-REC                            05665002
056300             FROM ML112-DATA-INTEGRITY-DIFF-REC                   05666002
056400         ADD 1                   TO PA-REPORT-RECS-WRITTEN        05667002
056500     END-IF.                                                      05668002
056600                                                                  05669002
055800     IF LLLOW-MKDN-PROMO-RTL-AMT NOT = HHIGH-MKDN-PROMO-RTL-AMT   05669102
055900         MOVE LLLOW-MKDN-PROMO-RTL-AMT TO ML112-LOW-TBL-AMT       05669202
056000         MOVE HHIGH-MKDN-PROMO-RTL-AMT TO ML112-HIGH-TBL-AMT      05669302
056100         MOVE 5                  TO ML112-ERR-MSG-NBR             05669402
056200         WRITE DATA-INTEGRITY-DIFF-REC                            05669502
056300             FROM ML112-DATA-INTEGRITY-DIFF-REC                   05669602
056400         ADD 1                   TO PA-REPORT-RECS-WRITTEN        05669702
056500     END-IF.                                                      05669802
056600                                                                  05669902
055800     IF LLLOW-MKDN-RGST-RTL-AMT NOT = HHIGH-MKDN-RGST-RTL-AMT     05670002
055900         MOVE LLLOW-MKDN-RGST-RTL-AMT TO ML112-LOW-TBL-AMT        05670102
056000         MOVE HHIGH-MKDN-RGST-RTL-AMT TO ML112-HIGH-TBL-AMT       05670202
056100         MOVE 6                  TO ML112-ERR-MSG-NBR             05670302
056200         WRITE DATA-INTEGRITY-DIFF-REC                            05670402
056300             FROM ML112-DATA-INTEGRITY-DIFF-REC                   05670502
056400         ADD 1                   TO PA-REPORT-RECS-WRITTEN        05670602
056500     END-IF.                                                      05670702
056600                                                                  05670802
055800     IF LLLOW-MKDN-GLDST-RTL-AMT NOT = HHIGH-MKDN-GLDST-RTL-AMT   05670902
055900         MOVE LLLOW-MKDN-GLDST-RTL-AMT TO ML112-LOW-TBL-AMT       05671002
056000         MOVE HHIGH-MKDN-GLDST-RTL-AMT TO ML112-HIGH-TBL-AMT      05671102
056100         MOVE 7                  TO ML112-ERR-MSG-NBR             05671202
056200         WRITE DATA-INTEGRITY-DIFF-REC                            05671302
056300             FROM ML112-DATA-INTEGRITY-DIFF-REC                   05671402
056400         ADD 1                   TO PA-REPORT-RECS-WRITTEN        05671502
056500     END-IF.                                                      05671602
056600                                                                  05671702
055800     IF LLLOW-MKDN-UMTCH-RTL-AMT NOT = HHIGH-MKDN-UMTCH-RTL-AMT   05671802
055900         MOVE LLLOW-MKDN-UMTCH-RTL-AMT TO ML112-LOW-TBL-AMT       05671902
056000         MOVE HHIGH-MKDN-UMTCH-RTL-AMT TO ML112-HIGH-TBL-AMT      05672002
056100         MOVE 8                  TO ML112-ERR-MSG-NBR             05672102
056200         WRITE DATA-INTEGRITY-DIFF-REC                            05672202
056300             FROM ML112-DATA-INTEGRITY-DIFF-REC                   05672302
056400         ADD 1                   TO PA-REPORT-RECS-WRITTEN        05672402
056500     END-IF.                                                      05672502
056600                                                                  05672602
055800     IF LLLOW-MKDN-BYR-RTL-AMT NOT = HHIGH-MKDN-BYR-RTL-AMT       05672702
055900         MOVE LLLOW-MKDN-BYR-RTL-AMT TO ML112-LOW-TBL-AMT         05672802
056000         MOVE HHIGH-MKDN-BYR-RTL-AMT TO ML112-HIGH-TBL-AMT        05672902
056100         MOVE 9                  TO ML112-ERR-MSG-NBR             05673002
056200         WRITE DATA-INTEGRITY-DIFF-REC                            05673102
056300             FROM ML112-DATA-INTEGRITY-DIFF-REC                   05673202
056400         ADD 1                   TO PA-REPORT-RECS-WRITTEN        05673302
056500     END-IF.                                                      05673402
056600                                                                  05673502
055800     IF LLLOW-MKDN-STR-RTL-AMT NOT = HHIGH-MKDN-STR-RTL-AMT       05673602
055900         MOVE LLLOW-MKDN-STR-RTL-AMT TO ML112-LOW-TBL-AMT         05673702
056000         MOVE HHIGH-MKDN-STR-RTL-AMT TO ML112-HIGH-TBL-AMT        05673802
056100         MOVE 10                 TO ML112-ERR-MSG-NBR             05673902
056200         WRITE DATA-INTEGRITY-DIFF-REC                            05674002
056300             FROM ML112-DATA-INTEGRITY-DIFF-REC                   05674102
056400         ADD 1                   TO PA-REPORT-RECS-WRITTEN        05674202
056500     END-IF.                                                      05674302
056600                                                                  05674402
055800     IF LLLOW-MKDN-PRPT-RTL-AMT NOT = HHIGH-MKDN-PRPT-RTL-AMT     05674502
055900         MOVE LLLOW-MKDN-PRPT-RTL-AMT TO ML112-LOW-TBL-AMT        05674602
056000         MOVE HHIGH-MKDN-PRPT-RTL-AMT TO ML112-HIGH-TBL-AMT       05674702
056100         MOVE 11                 TO ML112-ERR-MSG-NBR             05674802
056200         WRITE DATA-INTEGRITY-DIFF-REC                            05674902
056300             FROM ML112-DATA-INTEGRITY-DIFF-REC                   05675002
056400         ADD 1                   TO PA-REPORT-RECS-WRITTEN        05675102
056500     END-IF.                                                      05675202
056600                                                                  05675302
055800     IF LLLOW-MKDN-OTH-RTL-AMT NOT = HHIGH-MKDN-OTH-RTL-AMT       05675402
055900         MOVE LLLOW-MKDN-OTH-RTL-AMT TO ML112-LOW-TBL-AMT         05675507
056000         MOVE HHIGH-MKDN-OTH-RTL-AMT TO ML112-HIGH-TBL-AMT        05675607
056100         MOVE 12                 TO ML112-ERR-MSG-NBR             05675702
056200         WRITE DATA-INTEGRITY-DIFF-REC                            05675802
056300             FROM ML112-DATA-INTEGRITY-DIFF-REC                   05675902
056400         ADD 1                   TO PA-REPORT-RECS-WRITTEN        05676002
056500     END-IF.                                                      05676102
056600                                                                  05676202
056700     IF LLLOW-MKUP-RTL-AMT NOT = HHIGH-MKUP-RTL-AMT               05677002
056800         MOVE LLLOW-MKUP-RTL-AMT TO ML112-LOW-TBL-AMT             05680002
056900         MOVE HHIGH-MKUP-RTL-AMT TO ML112-HIGH-TBL-AMT            05690002
057000         MOVE 13                 TO ML112-ERR-MSG-NBR             05700002
057100         WRITE DATA-INTEGRITY-DIFF-REC                            05710000
057200             FROM ML112-DATA-INTEGRITY-DIFF-REC                   05720000
057300         ADD 1                   TO PA-REPORT-RECS-WRITTEN        05730000
057400     END-IF.                                                      05740000
057500                                                                  05750000
058500     IF LLLOW-XFER-IN-RTL-AMT NOT = HHIGH-XFER-IN-RTL-AMT         05850000
058600         MOVE LLLOW-XFER-IN-RTL-AMT                               05860000
058700                                 TO ML112-LOW-TBL-AMT             05870000
058800         MOVE HHIGH-XFER-IN-RTL-AMT                               05880000
058900                                 TO ML112-HIGH-TBL-AMT            05890000
059000         MOVE 14                 TO ML112-ERR-MSG-NBR             05900002
059100         WRITE DATA-INTEGRITY-DIFF-REC                            05910000
059200             FROM ML112-DATA-INTEGRITY-DIFF-REC                   05920000
059300         ADD 1                   TO PA-REPORT-RECS-WRITTEN        05930000
059400     END-IF.                                                      05940000
059500                                                                  05950000
059600     IF LLLOW-XFER-OUT-RTL-AMT NOT = HHIGH-XFER-OUT-RTL-AMT       05960000
059700         MOVE LLLOW-XFER-OUT-RTL-AMT                              05970000
059800                                 TO ML112-LOW-TBL-AMT             05980000
059900         MOVE HHIGH-XFER-OUT-RTL-AMT                              05990000
060000                                 TO ML112-HIGH-TBL-AMT            06000000
060100         MOVE 15                 TO ML112-ERR-MSG-NBR             06010002
060200         WRITE DATA-INTEGRITY-DIFF-REC                            06020000
060300             FROM ML112-DATA-INTEGRITY-DIFF-REC                   06030000
060400         ADD 1                   TO PA-REPORT-RECS-WRITTEN        06040000
060500     END-IF.                                                      06050000
060600                                                                  06060000
060700     IF LLLOW-RCPT-RTL-AMT NOT = HHIGH-RCPT-RTL-AMT               06070000
060800         MOVE LLLOW-RCPT-RTL-AMT TO ML112-LOW-TBL-AMT             06080000
060900         MOVE HHIGH-RCPT-RTL-AMT TO ML112-HIGH-TBL-AMT            06090000
061000         MOVE 16                 TO ML112-ERR-MSG-NBR             06100002
061100         WRITE DATA-INTEGRITY-DIFF-REC                            06110000
061200             FROM ML112-DATA-INTEGRITY-DIFF-REC                   06120000
061300         ADD 1                   TO PA-REPORT-RECS-WRITTEN        06130000
061400     END-IF.                                                      06140000
061500                                                                  06150000
061600     IF LLLOW-RCPT-NET-COST-AMT NOT = HHIGH-RCPT-NET-COST-AMT     06160000
061700         MOVE LLLOW-RCPT-NET-COST-AMT                             06170000
061800                                 TO ML112-LOW-TBL-AMT             06180000
061900         MOVE HHIGH-RCPT-NET-COST-AMT                             06190000
062000                                 TO ML112-HIGH-TBL-AMT            06200000
062100         MOVE 17                 TO ML112-ERR-MSG-NBR             06210002
062200         WRITE DATA-INTEGRITY-DIFF-REC                            06220000
062300             FROM ML112-DATA-INTEGRITY-DIFF-REC                   06230000
062400         ADD 1                   TO PA-REPORT-RECS-WRITTEN        06240000
062500     END-IF.                                                      06250000
062600                                                                  06260000
062700     IF LLLOW-PADJ-RTL-AMT NOT = HHIGH-PADJ-RTL-AMT               06270000
062800         MOVE LLLOW-PADJ-RTL-AMT TO ML112-LOW-TBL-AMT             06280000
062900         MOVE HHIGH-PADJ-RTL-AMT TO ML112-HIGH-TBL-AMT            06290000
063000         MOVE 18                 TO ML112-ERR-MSG-NBR             06300002
063100         WRITE DATA-INTEGRITY-DIFF-REC                            06310000
063200             FROM ML112-DATA-INTEGRITY-DIFF-REC                   06320000
063300         ADD 1                   TO PA-REPORT-RECS-WRITTEN        06330000
063400     END-IF.                                                      06340000
063500                                                                  06350000
063600     IF LLLOW-PADJ-FRGT-COST-AMT NOT = HHIGH-PADJ-FRGT-COST-AMT   06360003
063700         MOVE LLLOW-PADJ-FRGT-COST-AMT                            06370003
063800                                 TO ML112-LOW-TBL-AMT             06380000
063900         MOVE HHIGH-PADJ-FRGT-COST-AMT                            06390003
064000                                 TO ML112-HIGH-TBL-AMT            06400000
064100         MOVE 19                 TO ML112-ERR-MSG-NBR             06410003
064200         WRITE DATA-INTEGRITY-DIFF-REC                            06420000
064300             FROM ML112-DATA-INTEGRITY-DIFF-REC                   06430000
064400         ADD 1                   TO PA-REPORT-RECS-WRITTEN        06440000
064500     END-IF.                                                      06450000
                                                                        06450103
063600     IF LLLOW-PADJ-RTV-COST-AMT NOT = HHIGH-PADJ-RTV-COST-AMT     06450203
063700         MOVE LLLOW-PADJ-RTV-COST-AMT                             06450303
063800                                 TO ML112-LOW-TBL-AMT             06450403
063900         MOVE HHIGH-PADJ-RTV-COST-AMT                             06450503
064000                                 TO ML112-HIGH-TBL-AMT            06450603
064100         MOVE 20                 TO ML112-ERR-MSG-NBR             06450703
064200         WRITE DATA-INTEGRITY-DIFF-REC                            06450803
064300             FROM ML112-DATA-INTEGRITY-DIFF-REC                   06450903
064400         ADD 1                   TO PA-REPORT-RECS-WRITTEN        06451003
064500     END-IF.                                                      06451103
                                                                        06451203
063600     IF LLLOW-PADJ-RTV-RTL-AMT NOT = HHIGH-PADJ-RTV-RTL-AMT       06451303
063700         MOVE LLLOW-PADJ-RTV-RTL-AMT                              06451403
063800                                 TO ML112-LOW-TBL-AMT             06451503
063900         MOVE HHIGH-PADJ-RTV-RTL-AMT                              06451603
064000                                 TO ML112-HIGH-TBL-AMT            06451703
064100         MOVE 21                 TO ML112-ERR-MSG-NBR             06451803
064200         WRITE DATA-INTEGRITY-DIFF-REC                            06451903
064300             FROM ML112-DATA-INTEGRITY-DIFF-REC                   06452003
064400         ADD 1                   TO PA-REPORT-RECS-WRITTEN        06452103
064500     END-IF.                                                      06452203
                                                                        06452303
063600     IF LLLOW-PADJ-DA-COST-AMT NOT = HHIGH-PADJ-DA-COST-AMT       06452403
063700         MOVE LLLOW-PADJ-DA-COST-AMT                              06452503
063800                                 TO ML112-LOW-TBL-AMT             06452603
063900         MOVE HHIGH-PADJ-DA-COST-AMT                              06452703
064000                                 TO ML112-HIGH-TBL-AMT            06452803
064100         MOVE 22                 TO ML112-ERR-MSG-NBR             06452903
064200         WRITE DATA-INTEGRITY-DIFF-REC                            06453003
064300             FROM ML112-DATA-INTEGRITY-DIFF-REC                   06453103
064400         ADD 1                   TO PA-REPORT-RECS-WRITTEN        06453203
064500     END-IF.                                                      06453303
                                                                        06453403
063600     IF LLLOW-PADJ-DA-RTL-AMT NOT = HHIGH-PADJ-DA-RTL-AMT         06453503
063700         MOVE LLLOW-PADJ-DA-RTL-AMT                               06453603
063800                                 TO ML112-LOW-TBL-AMT             06453703
063900         MOVE HHIGH-PADJ-DA-RTL-AMT                               06453803
064000                                 TO ML112-HIGH-TBL-AMT            06453903
064100         MOVE 23                 TO ML112-ERR-MSG-NBR             06454003
064200         WRITE DATA-INTEGRITY-DIFF-REC                            06454103
064300             FROM ML112-DATA-INTEGRITY-DIFF-REC                   06454203
064400         ADD 1                   TO PA-REPORT-RECS-WRITTEN        06454303
064500     END-IF.                                                      06454403
                                                                        06454503
063600     IF LLLOW-PADJ-NET-COST-AMT NOT = HHIGH-PADJ-NET-COST-AMT     06454603
063700         MOVE LLLOW-PADJ-NET-COST-AMT                             06454703
063800                                 TO ML112-LOW-TBL-AMT             06454803
063900         MOVE HHIGH-PADJ-NET-COST-AMT                             06454903
064000                                 TO ML112-HIGH-TBL-AMT            06455003
064100         MOVE 24                 TO ML112-ERR-MSG-NBR             06456003
064200         WRITE DATA-INTEGRITY-DIFF-REC                            06457003
064300             FROM ML112-DATA-INTEGRITY-DIFF-REC                   06458003
064400         ADD 1                   TO PA-REPORT-RECS-WRITTEN        06459003
064500     END-IF.                                                      06459103
                                                                        06459203
063600     IF LLLOW-PADJ-OTH-COST-AMT NOT = HHIGH-PADJ-OTH-COST-AMT     06459303
063700         MOVE LLLOW-PADJ-OTH-COST-AMT                             06459403
063800                                 TO ML112-LOW-TBL-AMT             06459503
063900         MOVE HHIGH-PADJ-OTH-COST-AMT                             06459603
064000                                 TO ML112-HIGH-TBL-AMT            06459703
064100         MOVE 25                 TO ML112-ERR-MSG-NBR             06459803
064200         WRITE DATA-INTEGRITY-DIFF-REC                            06459903
064300             FROM ML112-DATA-INTEGRITY-DIFF-REC                   06460003
064400         ADD 1                   TO PA-REPORT-RECS-WRITTEN        06460103
064500     END-IF.                                                      06460203
                                                                        06460303
063600     IF LLLOW-PADJ-OTH-RTL-AMT NOT = HHIGH-PADJ-OTH-RTL-AMT       06460403
063700         MOVE LLLOW-PADJ-OTH-RTL-AMT                              06460503
063800                                 TO ML112-LOW-TBL-AMT             06460603
063900         MOVE HHIGH-PADJ-OTH-RTL-AMT                              06460703
064000                                 TO ML112-HIGH-TBL-AMT            06460803
064100         MOVE 26                 TO ML112-ERR-MSG-NBR             06460903
064200         WRITE DATA-INTEGRITY-DIFF-REC                            06461003
064300             FROM ML112-DATA-INTEGRITY-DIFF-REC                   06462003
064400         ADD 1                   TO PA-REPORT-RECS-WRITTEN        06463003
064500     END-IF.                                                      06464003
                                                                        06465003
064900     IF LLLOW-INV-ADJ-RTL-AMT NOT = HHIGH-INV-ADJ-RTL-AMT         06490000
065000        MOVE LLLOW-INV-ADJ-RTL-AMT                                06500000
065100                             TO ML112-LOW-TBL-AMT                 06510000
065200        MOVE HHIGH-INV-ADJ-RTL-AMT                                06520000
065300                             TO ML112-HIGH-TBL-AMT                06530000
065400        MOVE 27                  TO ML112-ERR-MSG-NBR             06540003
065500        WRITE DATA-INTEGRITY-DIFF-REC                             06550000
065600            FROM ML112-DATA-INTEGRITY-DIFF-REC                    06560000
065700        ADD 1                    TO PA-REPORT-RECS-WRITTEN        06570000
065800     END-IF.                                                      06580000
066000                                                                  06600000
066100*** ELIMINATE SHRINK TOLERANCE LEVELS                             06611003
066200     IF CC-LOW-TABLE NOT = 'TWKSCLS'                              06620000
066300*        PERFORM 5110-SHRINK-COMPARISONS.                         06630000
066400         IF LLLOW-SHNK-RTL-AMT = HHIGH-SHNK-RTL-AMT               06640000
066500             NEXT SENTENCE                                        06650000
066600         ELSE                                                     06660000
066700             MOVE LLLOW-SHNK-RTL-AMT                              06670000
066800                                 TO ML112-LOW-TBL-AMT             06680000
066900             MOVE HHIGH-SHNK-RTL-AMT                              06690000
067000                                 TO ML112-HIGH-TBL-AMT            06700000
067100             MOVE 28             TO ML112-ERR-MSG-NBR             06710003
067200             WRITE DATA-INTEGRITY-DIFF-REC                        06720000
067300                 FROM ML112-DATA-INTEGRITY-DIFF-REC               06730000
067400             ADD 1               TO PA-REPORT-RECS-WRITTEN        06740000
067500         END-IF                                                   06750000
067600     END-IF.                                                      06760000
067700                                                                  06770000
067800     IF CC-LOW-TABLE NOT = 'TWKSCLS'                              06780000
067900         IF LLLOW-END-INV-RTL-AMT NOT = HHIGH-END-INV-RTL-AMT     06790000
068000             MOVE LLLOW-END-INV-RTL-AMT                           06800000
068100                                 TO ML112-LOW-TBL-AMT             06810000
068200             MOVE HHIGH-END-INV-RTL-AMT                           06820000
068300                                 TO ML112-HIGH-TBL-AMT            06830000
068400             MOVE 29             TO ML112-ERR-MSG-NBR             06840003
068500             WRITE DATA-INTEGRITY-DIFF-REC                        06850000
068600                 FROM ML112-DATA-INTEGRITY-DIFF-REC               06860000
068700             ADD 1               TO PA-REPORT-RECS-WRITTEN        06870000
068800         END-IF                                                   06880000
068900     END-IF.                                                      06890000
069000                                                                  06900000
069100 EJECT                                                            06910000
074400                                                                  07440000
074500                                                                  07450000
074600******************************************************************07460000
074700 5200-PROCESS-ONLY-LOW-FILE.                                      07470000
074800******************************************************************07480000
074900*                                                                 07490000
075000     PERFORM 5210-BYPASS-LLLOW-0-DLRS-CHK.                        07500000
075100                                                                  07510000
075200     IF PS-BYPASS-0-DOLLARS                                       07520000
075300         CONTINUE                                                 07530000
075400     ELSE                                                         07540000
075500         PERFORM 5220-PROCESS-NO-HIGH-RECD-ERR                    07550000
075600     END-IF.                                                      07560000
075700                                                                  07570000
075800 EJECT                                                            07580000
075900                                                                  07590000
076000******************************************************************07600000
076100 5210-BYPASS-LLLOW-0-DLRS-CHK.                                    07610000
076200******************************************************************07620000
076300*                                                                 07630000
076400     IF (LLLOW-SLS-RTL-AMT = 0)                                   07640000
076500*      AND (LLLOW-MKDN-RTL-AMT = 0)                               07650007
076600       AND (LLLOW-MKUP-RTL-AMT = 0)                               07660000
076700       AND (LLLOW-XFER-IN-RTL-AMT = 0)                            07670000
076800       AND (LLLOW-XFER-OUT-RTL-AMT = 0)                           07680000
076900       AND (LLLOW-RCPT-RTL-AMT = 0)                               07690000
077000       AND (LLLOW-RCPT-NET-COST-AMT = 0)                          07700000
077100       AND (LLLOW-PADJ-RTL-AMT = 0)                               07710000
077200       AND (LLLOW-PADJ-NET-COST-AMT = 0)                          07720000
077300       AND (LLLOW-INV-ADJ-RTL-AMT = 0)                            07730000
077400       AND (LLLOW-SHNK-RTL-AMT = 0)                               07740000
077500         SET PS-BYPASS-0-DOLLARS TO TRUE                          07750000
077600     ELSE                                                         07760000
077700         SET PS-NO-BYPASS-DOLLARS TO TRUE                         07770000
077800     END-IF.                                                      07780000
077900                                                                  07790000
078000 EJECT                                                            07800000
078100                                                                  07810000
078200******************************************************************07820000
078300 5220-PROCESS-NO-HIGH-RECD-ERR.                                   07830000
078400******************************************************************07840000
078500*                                                                 07850000
078600     MOVE LLLOW-FSCL-WK-END-DTE  TO ML112-FSCL-MN-END-DTE.        07860006
078800     MOVE LLLOW-DEPT-NBR         TO ML112-DEPT-NBR.               07880000
078800     MOVE LLLOW-MAJ-CL-NBR       TO ML112-MAJ-CL-NBR.             07881007
086600                                                                  08660000
086700     MOVE 0                      TO ML112-LOW-TBL-AMT             08670000
086800                                    ML112-HIGH-TBL-AMT.           08680000
086900     MOVE 1                      TO ML112-ERR-MSG-NBR.            08690000
087000                                                                  08700000
087100     WRITE DATA-INTEGRITY-DIFF-REC                                08710000
087200         FROM ML112-DATA-INTEGRITY-DIFF-REC.                      08720000
087300                                                                  08730000
087400     ADD 1                       TO PA-REPORT-RECS-WRITTEN.       08740000
087500                                                                  08750000
087600 EJECT                                                            08760000
087700                                                                  08770000
087800******************************************************************08780000
087900 5300-PROCESS-ONLY-HIGH-FILE.                                     08790000
088000******************************************************************08800000
088100*                                                                 08810000
088200     PERFORM 5310-BYPASS-HHIGH-0-DLRS-CHK.                        08820000
088300                                                                  08830000
088400     IF PS-BYPASS-0-DOLLARS                                       08840000
088500         CONTINUE                                                 08850000
088600     ELSE                                                         08860000
088700         PERFORM 5320-PROCESS-NO-LOW-RECD-ERR                     08870000
088800     END-IF.                                                      08880000
088900                                                                  08890000
089000 EJECT                                                            08900000
089100                                                                  08910000
089200******************************************************************08920000
089300 5310-BYPASS-HHIGH-0-DLRS-CHK.                                    08930000
089400******************************************************************08940000
089500*                                                                 08950000
089600     IF (HHIGH-SLS-RTL-AMT = 0)                                   08960000
089700*      AND (HHIGH-MKDN-RTL-AMT = 0)                               08970007
089800       AND (HHIGH-MKUP-RTL-AMT = 0)                               08980000
089900       AND (HHIGH-XFER-IN-RTL-AMT = 0)                            08990000
090000       AND (HHIGH-XFER-OUT-RTL-AMT = 0)                           09000000
090100       AND (HHIGH-RCPT-RTL-AMT = 0)                               09010000
090200       AND (HHIGH-RCPT-NET-COST-AMT = 0)                          09020000
090300       AND (HHIGH-PADJ-RTL-AMT = 0)                               09030000
090400       AND (HHIGH-PADJ-NET-COST-AMT = 0)                          09040000
090500       AND (HHIGH-INV-ADJ-RTL-AMT = 0)                            09050000
090600       AND (HHIGH-SHNK-RTL-AMT = 0)                               09060000
090700         SET PS-BYPASS-0-DOLLARS TO TRUE                          09070000
090800     ELSE                                                         09080000
090900         SET PS-NO-BYPASS-DOLLARS TO TRUE                         09090000
091000     END-IF.                                                      09100000
091100                                                                  09110000
091200 EJECT                                                            09120000
091300                                                                  09130000
091400******************************************************************09140000
091500 5320-PROCESS-NO-LOW-RECD-ERR.                                    09150000
091600******************************************************************09160000
091700*                                                                 09170000
091800     MOVE HHIGH-FSCL-WK-END-DTE  TO ML112-FSCL-MN-END-DTE.        09180006
092000     MOVE HHIGH-DEPT-NBR         TO ML112-DEPT-NBR.               09200000
092100     MOVE HHIGH-MAJ-CL-NBR       TO ML112-MAJ-CL-NBR.             09210000
092200*?   MOVE HHIGH-SUB-CL-NBR       TO ML112-SUB-CL-NBR.             09220002
092300*?   MOVE HHIGH-STR-NBR          TO ML112-STR-NBR.                09230002
092300*?   MOVE HHIGH-DKEY-NBR         TO ML112-DKEY-NBR.               09231002
092400     MOVE 0                      TO ML112-LOW-TBL-AMT             09240000
092500                                    ML112-HIGH-TBL-AMT.           09250000
092600     MOVE 2                      TO ML112-ERR-MSG-NBR.            09260000
092700                                                                  09270000
092800     WRITE DATA-INTEGRITY-DIFF-REC                                09280000
092900         FROM ML112-DATA-INTEGRITY-DIFF-REC.                      09290000
093000                                                                  09300000
093100     ADD 1                       TO PA-REPORT-RECS-WRITTEN.       09310000
093200                                                                  09320000
093300******************************************************************09330000
093400 5400-COMPARE-BOTH-FILE-AMTS.                                     09340000
093500******************************************************************09350000
093600     MOVE HHIGH-FSCL-WK-END-DTE  TO ML112-FSCL-MN-END-DTE.        09360006
093800     MOVE HHIGH-DEPT-NBR         TO ML112-DEPT-NBR.               09380000
093900     MOVE HHIGH-MAJ-CL-NBR       TO ML112-MAJ-CL-NBR.             09390000
094000*?   MOVE HHIGH-SUB-CL-NBR       TO ML112-SUB-CL-NBR.             09400002
094100*    MOVE HHIGH-STR-NBR          TO ML112-STR-NBR.                09410002
      *    MOVE HHIGH-DKEY-NBR         TO ML112-DKEY-NBR.               09411002
094200                                                                  09420000
094300     IF LLLOW-RCPT-RTL-AMT NOT = HHIGH-RCPT-RTL-AMT               09430000
094400         MOVE LLLOW-RCPT-RTL-AMT TO ML112-LOW-TBL-AMT             09440000
094500         MOVE HHIGH-RCPT-RTL-AMT TO ML112-HIGH-TBL-AMT            09450000
094600         MOVE 8                  TO ML112-ERR-MSG-NBR             09460000
094700         WRITE DATA-INTEGRITY-DIFF-REC                            09470000
094800             FROM ML112-DATA-INTEGRITY-DIFF-REC                   09480000
094900         ADD 1                   TO PA-REPORT-RECS-WRITTEN        09490000
095000     END-IF.                                                      09500000
095100                                                                  09510000
095200     IF LLLOW-RCPT-NET-COST-AMT NOT = HHIGH-RCPT-NET-COST-AMT     09520000
095300         MOVE LLLOW-RCPT-NET-COST-AMT                             09530000
095400                                 TO ML112-LOW-TBL-AMT             09540000
095500         MOVE HHIGH-RCPT-NET-COST-AMT                             09550000
095600                                 TO ML112-HIGH-TBL-AMT            09560000
095700         MOVE 9                  TO ML112-ERR-MSG-NBR             09570000
095800         WRITE DATA-INTEGRITY-DIFF-REC                            09580000
095900             FROM ML112-DATA-INTEGRITY-DIFF-REC                   09590000
096000         ADD 1                   TO PA-REPORT-RECS-WRITTEN        09600000
096100     END-IF.                                                      09610000
096200                                                                  09620000
096300 EJECT                                                            09630000
096400                                                                  09640000
096500******************************************************************09650000
096600 8000-EOJ.                                                        09660000
096700******************************************************************09670000
096800*                                                                 09680000
096900     DISPLAY ' '.                                                 09690000
097000     DISPLAY '  PROGRAM MLKUT412 PROCESSING SUMMARY'.             09700009
097100     DISPLAY '  -----------------------------------'.             09710000
097200     DISPLAY ' '.                                                 09720000
097300*                                                                 09730000
097400     MOVE PA-LOW-RECS-READ       TO CD-COUNT-HOLD1.               09740000
097500     DISPLAY 'LOW RECORDS READ =       ' CD-COUNT-HOLD1.          09750000
097600*                                                                 09760000
097700     MOVE PA-HIGH-RECS-READ      TO CD-COUNT-HOLD1.               09770000
097800     DISPLAY 'HIGH RECORDS READ =      ' CD-COUNT-HOLD1.          09780000
097900*                                                                 09790000
098000     MOVE PA-KEY-MATCHES         TO CD-COUNT-HOLD1.               09800000
098100     DISPLAY 'KEY MATCHES =            ' CD-COUNT-HOLD1.          09810000
098200*                                                                 09820000
098300     MOVE PA-REPORT-RECS-WRITTEN TO CD-COUNT-HOLD1.               09830000
098400     DISPLAY 'REPORT RECORDS WRITTEN = ' CD-COUNT-HOLD1.          09840000
098500*                                                                 09850000
098600     DISPLAY ' '.                                                 09860000
098700                                                                  09870000
098800     CLOSE COMPARE-TABLES-CTL-FILE.                               09880000
098900     CLOSE L-DATA-INTEGRITY-EXTR-FILE.                            09890000
099000     CLOSE H-DATA-INTEGRITY-EXTR-FILE.                            09900000
099100     CLOSE DATA-INTEGRITY-DIFF-FILE.                              09910000
099200                                                                  09920000
099300 EJECT                                                            09930000
099400                                                                  09940000
099500******************************************************************09950000
099600 9900-COMMON-ABEND-ROUTINE.                                       09960000
099700******************************************************************09970000
099800*                                                                 09980000
099900     DISPLAY AA-ABEND-LIT.                                        09990000
100000     DISPLAY AA-PROGRAM-LIT.                                      10000000
100100     DISPLAY AA-PARAGRAPH-LIT.                                    10010000
100200     DISPLAY AA-MESSAGE-LINE.                                     10020000
100300     DISPLAY ABEND-CODE.                                          10030000
100400                                                                  10040000
100500     CALL 'ILBOABN0' USING ABEND-CODE.                            10050000
100600                                                                  10060000
