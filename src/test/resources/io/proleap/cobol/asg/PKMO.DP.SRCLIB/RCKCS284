000100 IDENTIFICATION DIVISION.                                         00010000
000200 PROGRAM-ID.    RCKCS284.                                         00020000
000300 AUTHOR.        DENNIS STEFFEN - OMNI RESOURCES.                  00030000
000400 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00040000
000500 DATE-WRITTEN.  MARCH 1996.                                       00050000
000600 DATE-COMPILED.                                                   00060000
000610*---------------------------------------------------------------* 00061063
000620* CHANGED 11/11/2021    BY JIM HUNTER      WR: CHG0263784         00062064
000630* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00063064
000640* MAKING THE CALL DYNAMIC VS STATIC.                              00064064
000650*---------------------------------------------------------------* 00065064
000700 ENVIRONMENT DIVISION.                                            00070000
000800 DATA DIVISION.                                                   00080000
000900 WORKING-STORAGE SECTION.                                         00090000
001000                                                                  00100000
001100 01  PA-PROGRAM-ACCUMULATORS.                                     00110000
001200     05  PA-UPDATE-TO-QTY             PIC S9(9) VALUE +0.         00120000
001300     05  PA-UPDATE-FROM-QTY           PIC S9(9) VALUE +0.         00130000
001400     05  PA-UPDATE-DIFF-QTY           PIC S9(9) VALUE +0.         00140000
001500     05  PA-ACCUM-UPDATE-QTY          PIC S9(9) VALUE +0.         00150000
001600                                                                  00160000
001700 01  PC-PROGRAM-CONSTANTS.                                        00170000
001800     05  PC-CURRENT-MAP-NAME          PIC X(8)  VALUE 'RC284A  '. 00180000
001900     05  PC-CURRENT-MAPSET-NAME       PIC X(8)  VALUE 'RCKM284 '. 00190000
002000     05  PC-CURRENT-PROGRAM-NAME      PIC X(8)  VALUE 'RCKCS284'. 00200000
002100     05  PC-LOCATION-MODULE           PIC X(8)  VALUE 'XLKUT071'. 00210016
002200     05  PC-AUDIT-RTN                 PIC X(8)  VALUE 'RCKCS290'. 00220000
002300     05  PC-AUDIT-RTN-LENGTH          PIC S9(4) VALUE  +300       00230000
002400                                                COMP SYNC.        00240000
002500     05  PC-LIST-QUEUE-SEQ            PIC 9     VALUE 1.          00250000
002600     05  PC-SEL-QUEUE-SEQ             PIC 9     VALUE 2.          00260000
002700     05  PC-VRFY-ADJ-QUEUE-SEQ        PIC 9     VALUE 6.          00270000
002800     05  PC-ITEMS-PER-PANEL           PIC S9(4) VALUE +10         00280000
002900                                                COMP SYNC.        00290000
003000     05  PC-MAX-BLOCKS-IN-ARRAY       PIC S9(4) VALUE +2          00300000
003100                                                COMP SYNC.        00310000
003200     05  PC-MAX-ITEMS                 PIC S9(4) VALUE +9999       00320000
003300                                                COMP SYNC.        00330000
003400     05  PC-ERR                       PIC X(03) VALUE 'ERR'.      00340000
003500     05  PC-AC                        PIC X(02) VALUE 'AC'.       00350000
003600     05  PC-CM                        PIC X(02) VALUE 'CM'.       00360000
003700     05  PC-RV                        PIC X(02) VALUE 'RV'.       00370000
003800     05  PC-IP                        PIC X(02) VALUE 'IP'.       00380000
003900     05  PC-CB                        PIC X(02) VALUE 'CB'.       00390000
004000     05  PC-CA                        PIC X(02) VALUE 'CA'.       00400000
004100     05  PC-CP                        PIC X(02) VALUE 'CP'.       00410000
004200     05  PC-VE                        PIC X(02) VALUE 'VE'.       00420000
004300     05  PC-ACTUAL                    PIC X(08) VALUE '  ACTUAL'. 00430000
004400     05  PC-EXPECTED                  PIC X(08) VALUE 'EXPECTED'. 00440000
004500     05  PC-MANUAL                    PIC X(08) VALUE 'MANUAL  '. 00450000
004600     05  PC-CASE                      PIC X(08) VALUE 'CASE    '. 00460000
004700     05  PC-CASE-HEAD                 PIC X(08) VALUE '  CASE  '. 00470000
004800     05  PC-P2L                       PIC X(08) VALUE 'P2L     '. 00480000
004900     05  PC-P2L-HEAD                  PIC X(08) VALUE '  P2L   '. 00490000
005000     05  PC-P2LCASE                   PIC X(08) VALUE 'P2L/CASE'. 00500000
005100     05  PC-ACTIVE                    PIC X(01) VALUE 'A'.        00510000
005200     05  PC-I                         PIC X(01) VALUE 'I'.        00520000
005300     05  PC-A                         PIC X(01) VALUE 'A'.        00530000
005400     05  PC-M                         PIC X(01) VALUE 'M'.        00540000
005500     05  PC-N                         PIC X(01) VALUE 'N'.        00550000
005600     05  PC-DASH                      PIC X(01) VALUE '-'.        00560000
005700     05  PC-DEFAULT-TMST              PIC X(26)  VALUE            00570000
005800                     '9999-09-09-09.09.09.999999'.                00580000
005900     05  PC-DEFAULT-DATE              PIC X(10)  VALUE            00590000
006000                     '09/09/9999'.                                00600000
006100     05  PC-DISPLAY-PO                PIC 9(8)   VALUE ZEROS.     00610000
006200     05  PC-DISPLAY-RCVR              PIC 9(8)   VALUE ZEROS.     00620000
006300     05  PC-DISPLAY-LINE              PIC 9(8)   VALUE ZEROS.     00630000
006400     05  PC-DISPLAY-OPER              PIC 9(4)   VALUE ZEROS.     00640000
006500     05  PC-DISPLAY-SQL-CODE          PIC 9999-  VALUE ZEROS.     00650000
006600     05  PC-DISPLAY-CICS-RESP         PIC 999999999-              00660000
006700                                                 VALUE ZEROS.     00670000
006800     05  PC-AUTOVE-MODULE           PIC  X(08) VALUE 'RCKUT127'.  00680004
006900     05  PC-AUTOVE-MODULE-LENGTH    PIC S9(04) VALUE  +400        00690004
007000                                                    COMP SYNC.    00700004
007100*----------------------------------------------------------------*00710000
007200* INCLUDED NEW CONSTANTS PC-000 AND PC-999.          WR # 21361  *00720000
007300*----------------------------------------------------------------*00730000
007400     05  PC-000                       PIC X(03)  VALUE '000'.     00740000
007500     05  PC-999                       PIC X(03)  VALUE '999'.     00750000
007600*----------------------------------------------------------------*00760000
007700* CHANGES MADE FOR WR # 21361 ENDS HERE.                         *00770000
007800*----------------------------------------------------------------*00780000
007900*----------------------------------------------------------------*00790000
008000*      SYSTEM MESSAGES                                           *00800000
008100*----------------------------------------------------------------*00810000
008200* 00005 - INVALID VALUE                                           00820000
008300* 00008 - MUST BE NUMERIC                                         00830000
008400* 00045 - INVALID KEY                                             00840000
008500* 00051 - NO END OF RANGE HAS BEEN SPECIFIED                      00850000
008600* 00052 - END OF RANGE PRECEDES START OF RANGE                    00860000
008700* 00053 - NO START OF RANGE HAS BEEN SPECIFIED                    00870000
008800* 00054 - ONLY ONE START OF RANGE INDICATOR MAY BE SPECIFIED      00880000
008900* 00055 - ONLY ONE END OF RANGE INDICATOR MAY BE SPECIFIED        00890000
009000* 00057 - A LIST ITEM MUST BE SELECTED FOR THIS FUNCTION          00900000
009100* 00059 - UPDATE(S) SUCCESSFUL                                    00910000
009200* 00069 - TOP OF LIST                                             00920000
009300* 00070 - BOTTOM OF LIST                                          00930000
009400* 00101 - VALUE MUST BE GREATER THAN ZERO AND < 1,000,000         00940000
009500* 00279 - MORE ITEMS TO DISPLAY                                   00950000
009600* 00551 - WAIT 15 SECONDS;RETRY FUNCTION AGAIN;IF UNSUCCESSFUL    00960000
009700* 00734 - UPDATE FUNCTION INVALID WITH RECEIVER STATUS            00970000
009800* 01264 - ADJUSTMENT WILL CREATE PACK-BY-STORE OVERAGE,           00980000
009900* 01264 - PRESS F2 TO CONFIRM                                     00990000
010000* 01817 - F2 TO CONFIRM THE UPDATE OF A STORE WITH A SOURCE OTHER 01000000
010100* 02773 - SMOOTHING EXISTS FOR STORE - UNABLE TO UPDATE UNIT QTY  01010000
010200* 02875 - PROBLEM ENCOUNTED WITH UNITS WORKED PROCESSING -        01020000
010300*         CONTACT HELP DESK                                       01030000
010400*----------------------------------------------------------------*01040000
010500     05  PC-TSYMSG-NUMBERS.                                       01050000
010600         10  PC-TSYMSG-00005          PIC 9(5)  VALUE 00005.      01060000
010700         10  PC-TSYMSG-00008          PIC 9(5)  VALUE 00008.      01070000
010800         10  PC-TSYMSG-00045          PIC 9(5)  VALUE 00045.      01080000
010900         10  PC-TSYMSG-00051          PIC 9(5)  VALUE 00051.      01090000
011000         10  PC-TSYMSG-00052          PIC 9(5)  VALUE 00052.      01100000
011100         10  PC-TSYMSG-00053          PIC 9(5)  VALUE 00053.      01110000
011200         10  PC-TSYMSG-00054          PIC 9(5)  VALUE 00054.      01120000
011300         10  PC-TSYMSG-00055          PIC 9(5)  VALUE 00055.      01130000
011400         10  PC-TSYMSG-00057          PIC 9(5)  VALUE 00057.      01140000
011500         10  PC-TSYMSG-00059          PIC 9(5)  VALUE 00059.      01150000
011600         10  PC-TSYMSG-00069          PIC 9(5)  VALUE 00069.      01160000
011700         10  PC-TSYMSG-00070          PIC 9(5)  VALUE 00070.      01170000
011800         10  PC-TSYMSG-00101          PIC 9(5)  VALUE 00101.      01180000
011900         10  PC-TSYMSG-00279          PIC 9(5)  VALUE 00279.      01190000
012000         10  PC-TSYMSG-00551          PIC 9(5)  VALUE 00551.      01200000
012100         10  PC-TSYMSG-00734          PIC 9(5)  VALUE 00734.      01210000
012200         10  PC-TSYMSG-00984          PIC 9(5)  VALUE 00984.      01220008
012300         10  PC-TSYMSG-01264          PIC 9(5)  VALUE 01264.      01230000
012400         10  PC-TSYMSG-01817          PIC 9(5)  VALUE 01817.      01240000
012500         10  PC-TSYMSG-02773          PIC 9(5)  VALUE 02773.      01250000
012600         10  PC-TSYMSG-02875          PIC 9(05) VALUE 02875.      01260004
012700         10  PC-TSYMSG-03138          PIC 9(05) VALUE 03138.      01270008
012800         10  PC-TSYMSG-03180          PIC 9(05) VALUE 03180.      01280004
012900         10  PC-TSYMSG-03233          PIC 9(05)  VALUE 03233.     01290021
013000                                                                  01300000
013100 01  PS-PROGRAM-SWITCHES.                                         01310000
013200     05  PS-NO-DAMAGED-CARTON-SW      PIC  X    VALUE 'N'.        01320045
013300         88  PS-NO-DAMAGED-CARTON               VALUE 'N'.        01330044
013400         88  PS-DAMAGED-CARTON                  VALUE 'Y'.        01340044
013500     05  PS-ERROR-SW                  PIC  X    VALUE 'N'.        01350044
013600         88  PS-NO-ERROR                        VALUE 'N'.        01360044
013700         88  PS-ERROR                           VALUE 'Y'.        01370044
013800     05  PS-NEXT-SCREEN-SW            PIC  X    VALUE 'N'.        01380000
013900         88  PS-NO-NEXT-SCREEN                  VALUE 'N'.        01390000
014000         88  PS-NEXT-SCREEN                     VALUE 'Y'.        01400000
014100     05  PS-WRITE-LIST-QUEUE-SW       PIC  X    VALUE 'N'.        01410000
014200         88  PS-DONT-WRITE-LIST-QUEUE           VALUE 'N'.        01420000
014300         88  PS-WRITE-LIST-QUEUE                VALUE 'Y'.        01430000
014400     05  PS-UPDATE-TRECITM-SW         PIC  X    VALUE 'N'.        01440000
014500         88  PS-DONT-UPDATE-TRECITM             VALUE 'N'.        01450000
014600         88  PS-UPDATE-TRECITM                  VALUE 'Y'.        01460000
014700     05  PS-DATA-OK-SW              PIC  X(01)  VALUE 'N'.        01470000
014800         88  PS-DATA-OK                         VALUE 'Y'.        01480000
014900         88  PS-DATA-NOT-OK                     VALUE 'N'.        01490000
015000     05  PS-UPDATE-SW                 PIC  X    VALUE 'N'.        01500000
015100         88  PS-NO-UPDATES-DONE                 VALUE 'N'.        01510000
015200         88  PS-UPDATES-DONE                    VALUE 'Y'.        01520000
015300     05  PS-SMOOTHED-STORE-SW         PIC  X    VALUE 'N'.        01530000
015400         88  PS-NO-SMOOTHED-STORE               VALUE 'N'.        01540000
015500         88  PS-SMOOTHED-STORE                  VALUE 'Y'.        01550000
015600     05  PS-TRECDIS-UPDATE-SW         PIC X(01) VALUE 'N'.        01560000
015700         88  PS-TRECDIS-UPDATE-DONE             VALUE 'Y'.        01570000
015800         88  PS-TRECDIS-UPDATE-NOT-DONE         VALUE 'N'.        01580000
015900     05  PS-UNITS-WORKED-ERROR-SW     PIC X(01) VALUE 'N'.        01590000
016000         88  PS-UNITS-WORKED-ERROR              VALUE 'Y'.        01600000
016100         88  PS-NO-UNITS-WORKED-ERROR           VALUE 'N'.        01610000
016200     05  PS-FIRST-TIME-UPDATE-SW      PIC X(01) VALUE 'Y'.        01620000
016300         88 PS-FIRST-TIME-UPDATE                VALUE 'Y'.        01630000
016400         88 PS-NOT-FIRST-TIME-UPDATE            VALUE 'N'.        01640000
016500     05  PS-CHECK-FOR-RMS-PO-SW       PIC X(01) VALUE 'N'.        01650000
016600         88  PS-CHECKED-FOR-RMS-PO              VALUE 'Y'.        01660000
016700     05  PS-RMS-PO-SW                 PIC X(01) VALUE 'N'.        01670000
016800         88  PS-RMS-PO                          VALUE 'Y'.        01680000
016900         88  PS-NO-RMS-PO                       VALUE 'N'.        01690000
017000     05  PS-PBS-ERROR-CARTONS-SW     PIC X(01)  VALUE 'N'.        01700029
017100         88  PS-PBS-ERROR-CARTONS-NO            VALUE 'N'.        01710029
017200         88  PS-PBS-ERROR-CARTONS-YES           VALUE 'Y'.        01720029
017300     05  PS-ACTIVE-PBS-UCC128-SW     PIC X(01)  VALUE 'N'.        01730029
017400         88  PS-ACTIVE-PBS-UCC128-NO            VALUE 'N'.        01740029
017500         88  PS-ACTIVE-PBS-UCC128-YES           VALUE 'Y'.        01750029
017600*----------------------------------------------------------------*01760000
017700*  INCLUDED PROGRAM SWITCHES FOR XLKUT001       **   WR # 21361  *01770000
017800*----------------------------------------------------------------*01780000
017900     05  PS-CALL-API-SW               PIC  X    VALUE 'N'.        01790000
018000         88  PS-CALL-API-NO                     VALUE 'N'.        01800000
018100         88  PS-CALL-API-YES                    VALUE 'Y'.        01810000
018200*----------------------------------------------------------------*01820000
018300* CHANGES MADE FOR WR # 21361 ENDS HERE.                         *01830000
018400*----------------------------------------------------------------*01840000
018500                                                                  01850000
018600 01  DK-DB2-KEYS.                                                 01860000
018700     05  DK-PO-NBR                    PIC S9(9) COMP VALUE +0.    01870000
018800     05  DK-PKSL-LNE-NBR              PIC S9(9) COMP VALUE +0.    01880000
018900     05  DK-REC-SEQ-NBR               PIC S9(9) COMP VALUE +0.    01890000
019000     05  DK-STR-NBR                   PIC S9(4) COMP VALUE +0.    01900000
019100                                                                  01910000
019200 01  PV-PROGRAM-VARIABLES.                                        01920000
019300     05  PV-CICS-MSG-AREA             PIC  X(100) VALUE SPACE.    01930000
019400     05  PV-CICS-MSG-AREA2            PIC  X(100) VALUE SPACE.    01940004
019500     05  PV-COMMAREA-LENGTH           PIC S9(04)  VALUE +0        01950004
019600                                                COMP SYNC.        01960004
019700     05  PV-CICS-RESPONSE             PIC S9(04)  VALUE +0        01970004
019800                                                COMP SYNC.        01980004
019900     05  PV-SUB                       PIC S9(4) VALUE ZERO        01990004
020000                                                COMP SYNC.        02000000
020100     05  PV-REMAINDER                 PIC S9(4) VALUE ZERO        02010000
020200                                                COMP SYNC.        02020000
020300     05  PV-READ-COUNT                PIC S9(9) VALUE ZERO        02030000
020400                                                COMP-3.           02040000
020500     05  PV-RECDVS-COUNT              PIC S9(9) VALUE ZERO        02050000
020600                                                COMP-3.           02060000
020700     05  PV-ITEMS-PROCESSED           PIC S9(9) VALUE ZERO        02070000
020800                                                COMP-3.           02080000
020900     05  PV-HOLD-SELECTED-ITEMS       PIC S9(9) VALUE ZERO        02090000
021000                                                COMP-3.           02100000
021100     05  PV-ITEM-IN-USE               PIC S9(9) VALUE ZERO        02110000
021200                                                COMP-3.           02120000
021300     05  PV-TOP-ITEM                  PIC S9(9) VALUE ZERO        02130000
021400                                                COMP-3.           02140000
021500     05  PV-BOTTOM-ITEM               PIC S9(9) VALUE ZERO        02150000
021600                                                COMP-3.           02160000
021700     05  PV-DB2-COUNT                 PIC S9(9) VALUE ZERO        02170000
021800                                                COMP-3.           02180000
021900     05  PV-DEPT-NBR-KEY              PIC S9(4) VALUE +0          02190000
022000                                                COMP-3.           02200000
022100     05  PV-BLOCK-NUMBER              PIC S9(4) VALUE ZERO        02210000
022200                                                COMP SYNC.        02220000
022300     05  PV-CICS-RESP                 PIC S9(4) VALUE ZERO        02230000
022400                                                COMP SYNC.        02240000
022500     05  PV-ITEM                      PIC S9(4) VALUE ZERO        02250000
022600                                                COMP SYNC.        02260000
022700     05  PV-NULL-IND                  PIC S9(4) VALUE ZERO        02270000
022800                                                COMP SYNC.        02280000
022900     05  PV-SEL-QUEUE-ITEM            PIC S9(4) VALUE ZERO        02290000
023000                                                COMP SYNC.        02300000
023100     05  PV-SAVE-ITEM                 PIC S9(4) VALUE ZERO        02310000
023200                                                COMP SYNC.        02320000
023300     05  PV-VRFY-ITEM                 PIC S9(4) VALUE ZERO        02330000
023400                                                COMP SYNC.        02340000
023500     05  PV-HIGHEST-BLOCK-WRITTEN     PIC S9(4) VALUE ZERO        02350000
023600                                                COMP SYNC.        02360000
023700     05  PV-LIST-ITEM-NUMBER          PIC S9(4) VALUE ZERO        02370000
023800                                                COMP SYNC.        02380000
023900     05  PV-FIRST-BLOCK-IN-ARRAY      PIC S9(4) VALUE ZERO        02390000
024000                                                COMP SYNC.        02400000
024100     05  PV-NEXT-BLOCK-IN-ARRAY       PIC S9(4) VALUE ZERO        02410000
024200                                                COMP SYNC.        02420000
024300     05  PV-PREV-BLOCK-IN-ARRAY       PIC S9(4) VALUE ZERO        02430000
024400                                                COMP SYNC.        02440000
024500     05  PV-FIRST-BLOCK-IN-RANGE      PIC S9(4) VALUE ZERO        02450000
024600                                                COMP SYNC.        02460000
024700     05  PV-LAST-BLOCK-IN-RANGE       PIC S9(4) VALUE ZERO        02470000
024800                                                COMP SYNC.        02480000
024900     05  PV-START-OF-SELECTED-RANGE   PIC S9(4) VALUE ZERO        02490000
025000                                                COMP SYNC.        02500000
025100     05  PV-END-OF-SELECTED-RANGE     PIC S9(4) VALUE ZERO        02510000
025200                                                COMP SYNC.        02520000
025300     05  PV-DEPT-NBR-X.                                           02530000
025400         10  PV-DEPT-NBR              PIC  9(3).                  02540000
025500                                                                  02550000
025600*----------------------------------------------------------------*02560000
025700* CHANGED THE STRUCTURE OF PV-SKU-NBR.     ** WR # 21361.        *02570000
025800* ADDED NEW VARIABLE - PV-TEMP-SEQ-NBR.                          *02580000
025900*----------------------------------------------------------------*02590000
026000     05  PV-SN-DEPT-NBR               PIC  X(3).                  02600000
026100     05  PV-SN-CL-NBR                 PIC  X(2).                  02610000
026200     05  PV-SN-SEQ-NBR                PIC  X(8).                  02620000
026300     05  PV-TEMP-SEQ-NBR              PIC  9(8).                  02630000
026400*----------------------------------------------------------------*02640000
026500*   CHANGES MADE FOR WR # 21361 ENDS HERE.                        02650000
026600*----------------------------------------------------------------*02660000
026700     05  PV-DB2-CURRENT-TMST          PIC X(26).                  02670000
026800     05  PV-DB2-DEFAULT-TMST          PIC X(26) VALUE             02680000
026900         '9999-09-09-09.09.09.999999'.                            02690000
027000     05  PV-CURRENT-TIMESTAMP         PIC X(26) VALUE SPACE.      02700000
027100                                                                  02710000
027200     05  PV-RCPT-DISTR-UPD-CDE        PIC X(01)  VALUE SPACE.     02720000
027300                                                                  02730000
027400     05  PV-EXPECTED-QTY              PIC S9(9) VALUE ZERO        02740000
027500                                                COMP-3.           02750000
027600     05  PV-CASE-PKSLP                PIC S9(9) VALUE ZERO        02760000
027700                                                COMP-3.           02770000
027800     05  PV-STORE-NUM                 PIC S9(4) COMP VALUE +0.    02780000
027900                                                                  02790000
028000     05  PV-DISPLAY-NO-ZERO           PIC Z(5).                   02800000
028100     05  PV-DISPLAY-ZERO              PIC Z(4)9.                  02810000
028200                                                                  02820000
028300     05  PV-CURR-OPER-UNT-ID          PIC S9(4)  COMP             02830000
028400                                                 VALUE ZERO.      02840000
028500     05  PV-XLT00010-TYPE-CODE        PIC X(2)   VALUE SPACES.    02850013
028600         88  PV-XLT00010-TYPE-DC                 VALUE 'DC'.      02860013
028700     05  PV-PCKCS756                  PIC X(08)  VALUE 'PCKCS756'.02870000
028800     05  PV-TMST                      PIC X(26).                  02880000
028900     05  FILLER REDEFINES PV-TMST.                                02890000
029000         10  PV-CCYY                  PIC X(04).                  02900000
029100         10  FILLER                   PIC X(01).                  02910000
029200         10  PV-MM                    PIC X(02).                  02920000
029300         10  FILLER                   PIC X(01).                  02930000
029400         10  PV-DD                    PIC X(02).                  02940000
029500         10  FILLER                   PIC X(01).                  02950000
029600         10  PV-HH                    PIC X(02).                  02960000
029700         10  FILLER                   PIC X(01).                  02970000
029800         10  PV-MIN                   PIC X(02).                  02980000
029900         10  FILLER                   PIC X(01).                  02990000
030000         10  PV-SEC                   PIC X(02).                  03000000
030100         10  FILLER                   PIC X(01).                  03010000
030200         10  FILLER                   PIC X(06).                  03020000
030300                                                                  03030000
030400 01  MSG-QUEUE-ITEM.                                              03040000
030500     05  FILLER                       PIC X(11)  VALUE            03050000
030600         'QUEUE NAME '.                                           03060000
030700     05  MSG-QUEUE-NAME               PIC X(08).                  03070000
030800     05  FILLER                       PIC X(14)  VALUE            03080000
030900         '  ITEM NUMBER '.                                        03090000
031000     05  MSG-SEL-ITEM                 PIC 9(04).                  03100000
031100                                                                  03110000
031200 01  MSG1-PO-REC.                                                 03120000
031300     05  FILLER                       PIC X(07)  VALUE            03130059
031400         'PO NBR '.                                               03140000
031500     05  MSG1-PO-NBR                  PIC 9(09).                  03150000
031600     05  FILLER                       PIC X(11)  VALUE            03160000
031700         '  REC SEQ  '.                                           03170000
031800     05  MSG1-REC-SEQ-NBR-N           PIC 9(09).                  03180000
031900     05  FILLER                       PIC X(12)  VALUE            03190000
032000         '  OPER UNIT '.                                          03200000
032100     05  MSG1-OPER-UNT-ID             PIC X(04).                  03210000
032200     05  FILLER                       PIC X(11)  VALUE            03220000
032300         '  FACILITY '.                                           03230000
032400     05  MSG1-FACILITY-ID             PIC X(04).                  03240000
032500                                                                  03250000
032600                                                                  03260000
032700 01  LQW-LIST-QUEUE-WORK-AREA.                                    03270000
032800     05  LQW-BLOCK-MODIFIED           PIC X(01)  VALUE SPACE.     03280000
032900     05  LQW-ITEM-ENTRIES             OCCURS 10 TIMES             03290000
033000                                      INDEXED BY LQW-IDX.         03300000
033100         10  LQW-LIST-ITEM-NUMBER     PIC S9(9)  COMP-3.          03310000
033200         10  LQW-TEMP-SELECTED-SW     PIC X(01).                  03320000
033300         10  LQW-SELECTED-SW          PIC X(01).                  03330000
033400             88  LQW-SELECT                      VALUE 'S'.       03340000
033500             88  LQW-DESELECT                    VALUE ' '.       03350000
033600         10  LQW-ACT                  PIC X(03).                  03360000
033700             88  LQW-UPDATE                      VALUE 'UPD'.     03370000
033800         10  LQW-STR-QTY-PREV         PIC 9(05).                  03380000
033900         10  LQW-STR-QTY              PIC 9(05).                  03390000
034000         10  LQW-STR-NBR              PIC 9(04).                  03400000
034100         10  LQW-SOURCE               PIC X(08).                  03410000
034200         10  LQW-EXPTED-ITM-QTY       PIC 9(05).                  03420000
034300         10  LQW-ACTUAL-QTY           PIC 9(05).                  03430000
034400         10  LQW-VERFD-QTY            PIC 9(05).                  03440000
034500         10  LQW-P2L-PKSLP            PIC 9(05).                  03450000
034600         10  LQW-P2L-ACTUAL           PIC 9(05).                  03460000
034700         10  LQW-CASE-PKSLP           PIC 9(05).                  03470000
034800         10  LQW-CASE-ACTUAL          PIC 9(05).                  03480000
034900         10  LQW-PACK-BY-ST-OVERAGE-SW                            03490000
035000                                      PIC X(01).                  03500000
035100             88  LQW-PACK-BY-ST-OVERAGE          VALUE 'Y'.       03510031
035200             88  LQW-NO-PACK-BY-ST-OVERAGE       VALUE 'N'.       03520031
035300         10  LQW-SEL-ZERO-SW          PIC X(01).                  03530031
035400             88  LQW-SEL-ZERO-YES                VALUE 'Y'.       03540031
035500             88  LQW-SEL-ZERO-NO                 VALUE 'N'.       03550031
035600         10  LQW-PBS-UPDATE-SW        PIC X(01).                  03560031
035700             88  LQW-PBS-UPDATE-YES              VALUE 'Y'.       03570031
035800             88  LQW-PBS-UPDATE-NO               VALUE 'N'.       03580031
035900                                                                  03590000
036000***************************************************************** 03600016
036100*   XLWS071 - IS THE LAYOUT THAT IS USED TO PASS INFO TO THE    * 03610016
036200*             LOCATION MODULE (XLKUT071)                        * 03620016
036300***************************************************************** 03630016
036400     COPY XLWS071.                                                03640016
036500                                                                  03650016
036600******************************************************************03660000
036700*    SELECTED ITEMS TEMPORARY STORAGE QUEUE ITEM LAYOUT           03670000
036800******************************************************************03680000
036900     COPY RCWS013.                                                03690000
037000                                                                  03700000
037100*---------------------------------------------------------------* 03710009
037200*    RECORD LAYOUT FOR CALCULATING UNITS FOR AN ORDER.          * 03720009
037300*---------------------------------------------------------------* 03730009
037400     COPY RCWS074.                                                03740009
037500                                                                  03750009
037600******************************************************************03760000
037700*  RECORD LAYOUT 'INSERT AUDIT MODULE'  RCKCS290                  03770000
037800******************************************************************03780000
037900     COPY RCWS031.                                                03790000
038000                                                                  03800000
038100******************************************************************03810000
038200*    SELECTED ITEMS TEMPORARY STORAGE QUEUE WO ITEM LAYOUT        03820000
038300******************************************************************03830000
038400     COPY PCWS016.                                                03840000
038500                                                                  03850000
038600******************************************************************03860000
038700*  TEMPORARY STORAGE QUEUE - STORE UNIT ADJUSTMENTS TO BE SENT   *03870000
038800*  TO RMS PO BY PCKCS759.                                        *03880000
038900******************************************************************03890000
039000     COPY PCWS241.                                                03900000
039100                                                                  03910000
039200*----------------------------------------------------------------*03920000
039300*  COPYBOOK FOR LOGISTICS DOMAIN ITEM ACCESS MODULE  WR # 21361  *03930000
039400*----------------------------------------------------------------*03940000
039500     COPY XLWS001.                                                03950000
039600*----------------------------------------------------------------*03960000
039700* CHANGES MADE FOR WR # 21361 ENDS HERE.                         *03970000
039800*----------------------------------------------------------------*03980000
039900***************************************************************** 03990004
040000*   RCWS040 - IS THE LAYOUT THAT IS USED TO PASS INFO TO THE    * 04000004
040100*             AUTOVERIFY (AUTOVE) ELIGIBILITY MODULE (RCKUT127).* 04010004
040200***************************************************************** 04020004
040300     COPY RCWS040.                                                04030004
040400/                                                                 04040004
040500******************************************************************04050000
040600*    BMS MAP                                                      04060000
040700******************************************************************04070000
040800     COPY RCKM284.                                                04080000
040900                                                                  04090000
041000*----------------------------------------------------------------*04100000
041100*                                                    WR # 21361  *04110000
041200* CHANGED THE FILLER OF MR-OCCURS-LAYOUT FROM X(232) TO X(245)   *04120000
041300* AS NEW FIELDS DEPT, CL AND SKU ARE ADDED IN THE MAP RCKM284.   *04130000
041400*----------------------------------------------------------------*04140000
041500 01  MR-OCCURS-LAYOUT                 REDEFINES RC284AO.          04150000
041600     05  FILLER                       PIC X(245).                 04160061
041700                                                                  04170000
041800     05  MR-SCROLL-AREA               OCCURS 10 TIMES.            04180000
041900         10  MR-SELECTL               PIC S9(4) COMP.             04190000
042000         10  MR-SELECTA               PIC X.                      04200000
042100         10  MR-SELECTC               PIC X.                      04210000
042200         10  MR-SELECTH               PIC X.                      04220000
042300         10  MR-SELECTI               PIC X.                      04230000
042400                                                                  04240000
042500         10  MR-ACT-L                 PIC S9(4) COMP.             04250000
042600         10  MR-ACT-A                 PIC X.                      04260000
042700         10  MR-ACT-C                 PIC X.                      04270000
042800         10  MR-ACT-H                 PIC X.                      04280000
042900         10  MR-ACT                   PIC X(3).                   04290000
043000                                                                  04300000
043100         10  MR-STR-QTY-L             PIC S9(4) COMP.             04310000
043200         10  MR-STR-QTY-A             PIC X.                      04320000
043300         10  MR-STR-QTY-C             PIC X.                      04330000
043400         10  MR-STR-QTY-H             PIC X.                      04340000
043500         10  MR-STR-QTY               PIC X(05).                  04350000
043600                                                                  04360000
043700         10  MR-STR-NBR-L             PIC S9(4) COMP.             04370000
043800         10  MR-STR-NBR-A             PIC X.                      04380000
043900         10  MR-STR-NBR-C             PIC X.                      04390000
044000         10  MR-STR-NBR-H             PIC X.                      04400000
044100         10  MR-STR-NBR               PIC X(04).                  04410000
044200                                                                  04420000
044300         10  MR-EXPTED-ITM-QTY-L      PIC S9(4) COMP.             04430000
044400         10  MR-EXPTED-ITM-QTY-A      PIC X.                      04440000
044500         10  MR-EXPTED-ITM-QTY-C      PIC X.                      04450000
044600         10  MR-EXPTED-ITM-QTY-H      PIC X.                      04460000
044700         10  MR-EXPTED-ITM-QTY.                                   04470000
044800             15  MR-EXPTED-ITM-QTY-EDITED                         04480000
044900                                      PIC ZZZZ9.                  04490000
045000                                                                  04500000
045100         10  MR-ACTUAL-QTY-L          PIC S9(4) COMP.             04510000
045200         10  MR-ACTUAL-QTY-A          PIC X.                      04520000
045300         10  MR-ACTUAL-QTY-C          PIC X.                      04530000
045400         10  MR-ACTUAL-QTY-H          PIC X.                      04540000
045500         10  MR-ACTUAL-QTY.                                       04550000
045600             15  MR-ACTUAL-QTY-EDITED PIC ZZZZ9.                  04560000
045700                                                                  04570000
045800         10  MR-VERFD-QTY-L           PIC S9(4) COMP.             04580000
045900         10  MR-VERFD-QTY-A           PIC X.                      04590000
046000         10  MR-VERFD-QTY-C           PIC X.                      04600000
046100         10  MR-VERFD-QTY-H           PIC X.                      04610000
046200         10  MR-VERFD-QTY.                                        04620000
046300             15  MR-VERFD-QTY-EDITED  PIC ZZZZ9.                  04630000
046400                                                                  04640000
046500         10  MR-SOURCE-L              PIC S9(4) COMP.             04650000
046600         10  MR-SOURCE-A              PIC X.                      04660000
046700         10  MR-SOURCE-C              PIC X.                      04670000
046800         10  MR-SOURCE-H              PIC X.                      04680000
046900         10  MR-SOURCE                PIC X(8).                   04690000
047000                                                                  04700000
047100         10  MR-P2L-PKSLP-L           PIC S9(4) COMP.             04710000
047200         10  MR-P2L-PKSLP-A           PIC X.                      04720000
047300         10  MR-P2L-PKSLP-C           PIC X.                      04730000
047400         10  MR-P2L-PKSLP-H           PIC X.                      04740000
047500         10  MR-P2L-PKSLP.                                        04750000
047600             15  MR-P2L-PKSLP-EDITED  PIC ZZZZ9.                  04760000
047700                                                                  04770000
047800         10  MR-P2L-ACTUAL-L          PIC S9(4) COMP.             04780000
047900         10  MR-P2L-ACTUAL-A          PIC X.                      04790000
048000         10  MR-P2L-ACTUAL-C          PIC X.                      04800000
048100         10  MR-P2L-ACTUAL-H          PIC X.                      04810000
048200         10  MR-P2L-ACTUAL.                                       04820000
048300             15  MR-P2L-ACTUAL-EDITED PIC ZZZZ9.                  04830000
048400                                                                  04840000
048500         10  MR-CASE-PKSLP-L          PIC S9(4) COMP.             04850000
048600         10  MR-CASE-PKSLP-A          PIC X.                      04860000
048700         10  MR-CASE-PKSLP-C          PIC X.                      04870000
048800         10  MR-CASE-PKSLP-H          PIC X.                      04880000
048900         10  MR-CASE-PKSLP.                                       04890000
049000             15  MR-CASE-PKSLP-EDITED PIC ZZZZ9.                  04900000
049100                                                                  04910000
049200         10  MR-CASE-ACTUAL-L         PIC S9(4) COMP.             04920000
049300         10  MR-CASE-ACTUAL-A         PIC X.                      04930000
049400         10  MR-CASE-ACTUAL-C         PIC X.                      04940000
049500         10  MR-CASE-ACTUAL-H         PIC X.                      04950000
049600         10  MR-CASE-ACTUAL.                                      04960000
049700             15  MR-CASE-ACTUAL-EDITED PIC ZZZZ9.                 04970000
049800     05 FILLER                        PIC X(12).                  04980000
049900*----------------------------------------------------------------*04990000
050000* CHANGES MADE FOR WR # 21361 ENDS HERE.                         *05000000
050100*----------------------------------------------------------------*05010000
050200                                                                  05020000
050300******************************************************************05030000
050400*    BMS ATTRIBUTES                                               05040000
050500******************************************************************05050000
050600     COPY DPWS015.                                                05060000
050700                                                                  05070000
050800******************************************************************05080000
050900*    FUNCTION KEYS                                                05090000
051000******************************************************************05100000
051100     COPY DPWS016.                                                05110000
051200                                                                  05120000
051300******************************************************************05130000
051400*    PARAMETER LIST FOR NUMERIC EDIT SUBROUTINE                   05140000
051500******************************************************************05150000
051600     COPY DPWS010I.                                               05160000
051700                                                                  05170000
051800******************************************************************05180000
051900*    PARAMETER LIST FOR CICS API                                  05190000
052000******************************************************************05200000
052100     COPY DPWS030.                                                05210000
052110     COPY DPWS930.                                                05211065
052200                                                                  05220000
052300******************************************************************05230000
052400*    GLOBAL COMMUNICATION AREA                                    05240000
052500******************************************************************05250000
052600     COPY DPWS020.                                                05260000
052700     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                05270000
052800                                                                  05280000
052900******************************************************************05290000
053000*    INTER-APPLICATION COMMUNICATION AREA                         05300000
053100*    RCWS015 = INPUT FROM PACK SLIP LINE SUMMARY PROGRAM          05310000
053200******************************************************************05320000
053300         10  INTER-APPL-COMM-AREA       PIC X(200).               05330000
053400     COPY RCWS015.                                                05340000
053500     COPY PCWS000.                                                05350000
053600                                                                  05360000
053700******************************************************************05370000
053800*    APPLICATION SPECIFIC COMMUNICATION AREA                      05380000
053900******************************************************************05390000
054000         10  ASC-SPECIFIC-COMMAREA.                               05400000
054100             15  ASC-LIST-HEADER-INFO.                            05410000
054200                 20  ASC-KEY-RECEIVER.                            05420000
054300                     25  ASC-KEY-PO-NBR.                          05430000
054400** CHG0094517  CHANGED PO-NBR LENGTH FROM 7 TO 8                  05440064
054500                         30  ASC-KEY-PO-NBR-N   PIC 9(08).        05450059
054600                     25  ASC-KEY-REC-DASH       PIC X(01).        05460000
054700                     25  ASC-KEY-REC-SEQ-NBR.                     05470000
054800                         30  ASC-KEY-REC-SEQ-NBR-N                05480000
054900                                                PIC 9(04).        05490000
055000                 20  ASC-KEY-PKSL-LNE-NBR       PIC 9(04).        05500000
055100                 20  ASC-KEY-SEQ-NBR            PIC S9(4) COMP.   05510000
055200                 20  ASC-KEY-OPER-UNT-ID        PIC S9(4) COMP.   05520000
055300                 20  ASC-KEY-FCLTY-ID           PIC S9(4) COMP.   05530000
055400                 20  ASC-KEY-FCLTY-DESC         PIC X(30).        05540000
055500                 20  ASC-KEY-PKSL-NBR           PIC X(10).        05550000
055600                 20  ASC-KEY-VFY-SRC            PIC X(08).        05560000
055700                 20  ASC-CSR-IND                PIC X(01).        05570038
055800             15  ASC-BLOCK-ENTRIES  OCCURS 2 TIMES.               05580000
055900                 20  ASC-BLOCK-MODIFIED-SW           PIC X.       05590000
056000                     88  ASC-BLOCK-NOT-MODIFIED      VALUE 'N'.   05600000
056100                     88  ASC-BLOCK-MODIFIED          VALUE 'Y'.   05610000
056200                                                                  05620000
056300                 20  ASC-ITEM-ARRAY.                              05630000
056400                     25  ASC-ITEM-ENTRIES  OCCURS 10 TIMES.       05640000
056500                         30  ASC-LIST-ITEM-NUMBER    PIC S9(9)    05650000
056600                                                     COMP-3.      05660000
056700                         30  ASC-TEMP-SELECTED-SW    PIC X.       05670000
056800                             88  ASC-VALID-SELECT    VALUE ' '    05680000
056900                                                           'S'    05690000
057000                                                           'B'    05700000
057100                                                           'E'.   05710000
057200                             88  ASC-TEMP-NO-SELECT  VALUE ' '.   05720000
057300                             88  ASC-TEMP-SELECT     VALUE 'S'.   05730000
057400                             88  ASC-TEMP-BEGIN      VALUE 'B'.   05740000
057500                             88  ASC-TEMP-END        VALUE 'E'.   05750000
057600                         30  ASC-SELECTED-SW         PIC  X.      05760000
057700                             88  ASC-NO-SELECT       VALUE ' '.   05770000
057800                             88  ASC-SELECT          VALUE 'S'.   05780000
057900                             88  ASC-BEGIN           VALUE 'B'.   05790000
058000                             88  ASC-END             VALUE 'E'.   05800000
058100                         30  ASC-ACT                 PIC X(03).   05810000
058200                         30  ASC-STR-QTY-PREV        PIC 9(05).   05820000
058300                         30  ASC-STR-QTY             PIC X(05).   05830000
058400                         30  ASC-STR-QTY-N REDEFINES ASC-STR-QTY  05840000
058500                                                 PIC 9(05).       05850000
058600                         30  ASC-STR-NBR             PIC X(04).   05860000
058700                         30  ASC-STR-NBR-N REDEFINES ASC-STR-NBR  05870000
058800                                                     PIC 9(04).   05880000
058900                         30  ASC-SOURCE              PIC X(08).   05890000
059000                         30  ASC-EXPTED-ITM-QTY.                  05900000
059100                             35  ASC-EXPTED-ITM-QTY-N             05910000
059200                                                     PIC 9(05).   05920000
059300                         30  ASC-ACTUAL-QTY.                      05930000
059400                             35  ASC-ACTUAL-QTY-N    PIC 9(05).   05940000
059500                         30  ASC-VERFD-QTY.                       05950000
059600                             35  ASC-VERFD-QTY-N     PIC 9(05).   05960000
059700                         30  ASC-P2L-PKSLP.                       05970000
059800                             35  ASC-P2L-PKSLP-N     PIC 9(05).   05980000
059900                         30  ASC-P2L-ACTUAL.                      05990000
060000                             35  ASC-P2L-ACTUAL-N    PIC 9(05).   06000000
060100                         30  ASC-CASE-PKSLP.                      06010000
060200                             35  ASC-CASE-PKSLP-N    PIC 9(05).   06020000
060300                         30  ASC-CASE-ACTUAL.                     06030000
060400                             35  ASC-CASE-ACTUAL-N   PIC 9(05).   06040000
060500                         30  ASC-PACK-BY-ST-OVERAGE-SW            06050000
060600                                                     PIC X(01).   06060000
060700                             88  ASC-PACK-BY-ST-OVERAGE           06070000
060800                                                     VALUE 'Y'.   06080000
060900                             88  ASC-NO-PACK-BY-ST-OVERAGE        06090000
061000                                                     VALUE 'N'.   06100000
061100                         30  ASC-SEL-ZERO-SW         PIC X(01).   06110000
061200                             88  ASC-SEL-ZERO-YES    VALUE 'Y'.   06120000
061300                             88  ASC-SEL-ZERO-NO     VALUE 'N'.   06130000
061400                         30  ASC-PBS-UPDATE-SW       PIC X(01).   06140026
061500                             88  ASC-PBS-UPDATE-YES  VALUE 'Y'.   06150026
061600                             88  ASC-PBS-UPDATE-NO   VALUE 'N'.   06160026
061700                                                                  06170000
061800             15  ASC-BLK-SUB                         PIC S9(4)    06180000
061900                                                     COMP SYNC.   06190000
062000             15  ASC-ITEM-SUB                        PIC S9(4)    06200000
062100                                                     COMP SYNC.   06210000
062200             15  ASC-SEL-SUB                         PIC S9(4)    06220000
062300                                                     COMP.        06230000
062400             15  ASC-SEL-ITEM                        PIC S9(4)    06240000
062500                                                     COMP.        06250000
062600             15  ASC-NUMBER-OF-ITEMS-READ            PIC S9(9)    06260000
062700                                                     COMP-3.      06270000
062800             15  ASC-NUMBER-OF-SELECTED-ITEMS        PIC S9(9)    06280000
062900                                                     COMP-3.      06290000
063000             15  ASC-NUMBER-OF-TS-ITEMS              PIC S9(5)    06300000
063100                                                     COMP-3.      06310000
063200             15  ASC-ITEMS-DISPLAYED                 PIC S999     06320000
063300                                                     COMP-3.      06330000
063400             15  ASC-ITEM-AT-TOP-OF-PANEL            PIC S9(9)    06340000
063500                                                     COMP-3.      06350000
063600             15  ASC-ITEM-AT-BOT-OF-PANEL            PIC S9(9)    06360000
063700                                                     COMP-3.      06370000
063800             15  ASC-HIGHEST-BLOCK-WRITTEN           PIC S9(4)    06380000
063900                                                     COMP SYNC.   06390000
064000             15  ASC-START-OF-SELECTED-RANGE         PIC S9(9)    06400000
064100                                                     COMP-3.      06410000
064200             15  ASC-END-OF-SELECTED-RANGE           PIC S9(9)    06420000
064300                                                     COMP-3.      06430000
064400             15  ASC-TEMP-QUEUE-UPDATE-SW            PIC X.       06440000
064500                 88  ASC-UPDATE-TSQ                  VALUE 'Y'.   06450000
064600                 88  ASC-NO-TSQ-UPDATE               VALUE ' '.   06460000
064700             15  ASC-UPDATE-SW                       PIC X.       06470000
064800                 88  ASC-CAN-UPDATE                  VALUE 'Y'.   06480000
064900                 88  ASC-CANT-UPDATE                 VALUE 'N'.   06490000
065000             15  ASC-SET-COLOR-SW                    PIC  X.      06500000
065100                 88  ASC-GO-BLUE                     VALUE 'B'.   06510000
065200                 88  ASC-GO-YELLOW                   VALUE 'Y'.   06520000
065300             15  ASC-LIST-QUEUE-NAME.                             06530000
065400                 20  ASC-LIST-TERM-ID                PIC X(4).    06540000
065500                 20  ASC-LIST-TASK-NUMBER            PIC S9(5)    06550000
065600                                                     COMP-3.      06560000
065700                 20  ASC-LIST-SEQ                    PIC 9.       06570000
065800             15  ASC-SEL-QUEUE-NAME-IN               PIC X(8).    06580000
065900             15  ASC-SEL-QUEUE-NAME-OUT.                          06590000
066000                 20  ASC-SEL-TERM-ID                 PIC X(4).    06600000
066100                 20  ASC-SEL-TASK-NUMBER             PIC S9(5)    06610000
066200                                                     COMP-3.      06620000
066300                 20  ASC-SEL-SEQ                     PIC 9.       06630000
066400* DMH 4/18/03 BEGIN                                               06640000
066500             15  ASC-VRFY-ADJ-QUEUE-NAME.                         06650000
066600                 20  ASC-VRFY-ADJ-TERM-ID            PIC X(4).    06660000
066700                 20  ASC-VRFY-ADJ-TASK-NUMBER        PIC S9(5)    06670000
066800                                                     COMP-3.      06680000
066900                 20  ASC-VRFY-ADJ-SEQ                PIC 9.       06690000
067000* DMH 4/18/03 END                                                 06700000
067100             15  ASC-START-ITEM-REQUEST.                          06710000
067200                 20  ASC-START-ITEM-REQUEST-N        PIC 9(5).    06720000
067300             15  ASC-RECDIS-SW                       PIC X.       06730000
067400                 88  ASC-MORE-RECDIS                 VALUE 'Y'.   06740000
067500                 88  ASC-NO-MORE-RECDIS              VALUE 'N'.   06750000
067600             15  ASC-RECDVS-SW                       PIC X.       06760000
067700                 88  ASC-MORE-RECDVS                 VALUE 'Y'.   06770000
067800                 88  ASC-NO-MORE-RECDVS              VALUE 'N'.   06780000
067900             15  ASC-USE-SELECTION-QUEUE-IND         PIC X(1).    06790000
068000                 88  ASC-USE-SELECTION-QUEUE         VALUE 'Y'.   06800000
068100*----------------------------------------------------------------*06810000
068200*                                                 WR # 21361     *06820000
068300* CHANGED THE SIZE OF ASC-SKU-NBR FROM X(10) TO X(08).           *06830000
068400* ADDED NEW VARIABLES - ASC-DEPT-NBR AND ASC-CLASS-NBR.          *06840000
068500*----------------------------------------------------------------*06850000
068600             15  ASC-DEPT-NBR                        PIC X(03).   06860000
068700             15  ASC-CLASS-NBR                       PIC X(02).   06870000
068800             15  ASC-SKU-NBR                         PIC X(08).   06880000
068900*----------------------------------------------------------------*06890000
069000* CHANGES MADE FOR WR # 21361 ENDS HERE.                         *06900000
069100*----------------------------------------------------------------*06910000
069200             15  ASC-PURCHS-STATUS-CDE               PIC X(02).   06920000
069300             15  ASC-PURITM-STATUS-CDE               PIC X(02).   06930000
069400             15  ASC-RECITM-STATUS-CDE               PIC X(02).   06940000
069500             15  ASC-AVERTYP                         PIC X(08).   06950000
069600             15  ASC-PURITM-UNT-QTY                  PIC S9(9)    06960000
069700                                                         COMP.    06970000
069800             15  ASC-HOLD-INTER-APPL                 PIC X(200).  06980000
069900             15  ASC-INTER-APPL-CODE-IND             PIC X(01).   06990000
070000                 88  ASC-INTER-APPL-VERIFY           VALUE '2'.   07000000
070100             15 ASC-TRBL-FOUND-SW                    PIC  X.      07010000
070200                 88 ASC-TRBL-EXISTS             VALUE 'Y'.        07020000
070300                 88 ASC-NO-TRBL-EXISTS          VALUE 'N'.        07030000
070400             15  ASC-TOT-ACTUAL-QTY          PIC S9(7) COMP-3.    07040000
070500             15  ASC-TOT-VERIFY-QTY          PIC S9(7) COMP-3.    07050000
070600             15  ASC-TOT-PCKSLP-QTY          PIC S9(7) COMP-3.    07060000
070700             15  ASC-CONFIRM-SWITCH                  PIC X.       07070000
070800                 88  ASC-CONFIRMED                   VALUE 'Y'.   07080000
070900                 88  ASC-NOT-CONFIRMED               VALUE 'N'.   07090000
071000             15  ASC-ACTL-CONFIRMED-SW               PIC X.       07100000
071100                 88  ASC-ACTL-CONFIRMED              VALUE 'Y'.   07110000
071200                 88  ASC-ACTL-NOT-CONFIRMED          VALUE 'N'.   07120000
071300             15  ASC-UPDATE-ALLOWED-SW               PIC X.       07130021
071400                 88  ASC-UPDATE-NOT-ALLOWED          VALUE 'N'.   07140021
071500                 88  ASC-UPDATE-ALLOWED              VALUE 'Y'.   07150021
071600             15  ASC-OVERAGE-SW                      PIC X.       07160000
071700                 88  ASC-OVERAGE               VALUE 'Y'.         07170000
071800                 88  ASC-NO-OVERAGE            VALUE 'N'.         07180000
071900             15  ASC-OVERAGE-COUNT           PIC 9.               07190000
072000                 88  ASC-OVERAGE-1             VALUE 1.           07200000
072100                 88  ASC-OVERAGE-2             VALUE 2.           07210000
072200                 88  ASC-OVERAGE-3             VALUE 3.           07220000
072300             15  ASC-CONFIRM-UPDATE-SW       PIC X.               07230000
072400                 88  ASC-CONFIRM-UPDATE              VALUE 'Y'.   07240000
072500                 88  ASC-DONT-CONFIRM-UPDATE         VALUE 'N'.   07250000
072600             15  ASC-RANGE-CHECK-SW          PIC X.               07260000
072700                 88  ASC-RANGE-ON                    VALUE 'Y'.   07270000
072800                 88  ASC-RANGE-OFF                   VALUE 'N'.   07280000
072900             15  ASC-AUTO-VE-SW              PIC X(01).           07290004
073000                 88  ASC-AUTO-VE-YES                 VALUE 'Y'.   07300004
073100                 88  ASC-AUTO-VE-NO                  VALUE 'N'.   07310004
073200             15  ASC-PACK-BY-ST-IND          PIC X(01).           07320026
073300                 88  ASC-PBS-YES                     VALUE 'Y'.   07330026
073400                 88  ASC-PBS-NO                      VALUE 'N'.   07340026
073500/                                                                 07350000
073600******************************************************************07360000
073700*    ABEND PROCESSING                                             07370000
073800******************************************************************07380000
073900     COPY DPWS013.                                                07390000
074000/                                                                 07400000
074100******************************************************************07410000
074200*  COMMAREA LAYOUT FOR THE UNITS WORKED MODULE (PCKCS756)        *07420000
074300******************************************************************07430000
074400     COPY PCWS238.                                                07440000
074500/                                                                 07450000
074600******************************************************************07460000
074700*    DB2 SQL COMMUNICATION AREA                                   07470000
074800******************************************************************07480000
074900     EXEC SQL                                                     07490000
075000          INCLUDE SQLCA                                           07500000
075100     END-EXEC.                                                    07510000
075200/                                                                 07520000
075300******************************************************************07530000
075400*    DB2 DCLGEN FOR PURCHASE ORDER TABLE                          07540000
075500******************************************************************07550000
075600     EXEC SQL                                                     07560000
075700          INCLUDE TPURCHS                                         07570000
075800     END-EXEC.                                                    07580000
075900/                                                                 07590000
076000******************************************************************07600000
076100*    DB2 DCLGEN FOR DISTRIBUTION HEADER TABLE                     07610000
076200******************************************************************07620000
076300     EXEC SQL                                                     07630000
076400          INCLUDE TDISTHD                                         07640000
076500     END-EXEC.                                                    07650000
076600/                                                                 07660000
076700******************************************************************07670000
076800*    DB2 DCLGEN FOR DISTRIBUTION DETAIL TABLE                     07680000
076900******************************************************************07690000
077000     EXEC SQL                                                     07700000
077100          INCLUDE TDISTDT                                         07710000
077200     END-EXEC.                                                    07720000
077300/                                                                 07730000
077400******************************************************************07740000
077500*    DB2 DCLGEN FOR TRECDVS TABLE                                 07750000
077600******************************************************************07760000
077700     EXEC SQL                                                     07770000
077800          INCLUDE TRECDVS                                         07780000
077900     END-EXEC.                                                    07790000
078000/                                                                 07800000
078100******************************************************************07810000
078200*    DB2 DCLGEN FOR PURCHASE ORDER ITEM TABLE                     07820000
078300******************************************************************07830000
078400     EXEC SQL                                                     07840000
078500          INCLUDE TPURITM                                         07850000
078600     END-EXEC.                                                    07860000
078700/                                                                 07870000
078800******************************************************************07880000
078900*    DB2 DCLGEN FOR RECEIVER TABLE                                07890000
079000******************************************************************07900000
079100     EXEC SQL                                                     07910000
079200          INCLUDE TRECEIV                                         07920000
079300     END-EXEC.                                                    07930000
079400/                                                                 07940000
079500******************************************************************07950000
079600*    DB2 DCLGEN FOR RECEIVER ITEM TABLE                           07960000
079700******************************************************************07970000
079800     EXEC SQL                                                     07980000
079900          INCLUDE TRECITM                                         07990000
080000     END-EXEC.                                                    08000000
080100/                                                                 08010000
080200******************************************************************08020000
080300*    DB2 DCLGEN FOR RECEIVER DISTRIBUTION TABLE                   08030000
080400******************************************************************08040000
080500     EXEC SQL                                                     08050000
080600          INCLUDE TRECDIS                                         08060000
080700     END-EXEC.                                                    08070000
080800/                                                                 08080000
080900******************************************************************08090000
081000*    DB2 DCLGEN FOR XLT_LOC TABLE                                 08100012
081100******************************************************************08110000
081200     EXEC SQL                                                     08120000
081300          INCLUDE XLT00010                                        08130014
081400     END-EXEC.                                                    08140000
081500/                                                                 08150000
081600*----------------------------------------------------------------*08160000
081700*    DB2 DCLGEN FOR THE TROUBLE NOTIFICATION TABLE                08170000
081800*----------------------------------------------------------------*08180000
081900     EXEC SQL                                                     08190000
082000          INCLUDE TTRBNTF                                         08200000
082100     END-EXEC.                                                    08210000
082200/                                                                 08220000
082300*----------------------------------------------------------------*08230000
082400*    DB2 DCLGEN FOR THE TROUBLE REASON TABLE                      08240000
082500*----------------------------------------------------------------*08250000
082600     EXEC SQL                                                     08260000
082700          INCLUDE TTRBRSN                                         08270000
082800     END-EXEC.                                                    08280000
082900/                                                                 08290000
083000*---------------------------------------------------------------* 08300028
083100*    DB2 AREA FOR SUT00028 - SUT_OTBND_UPC - OUTBOUND CART. UPC * 08310028
083200*---------------------------------------------------------------* 08320028
083300     EXEC SQL                                                     08330000
083400          INCLUDE SUT00028                                        08340000
083500     END-EXEC.                                                    08350000
083600                                                                  08360028
083700*---------------------------------------------------------------* 08370028
083800*    DB2 AREA FOR SUT00024 - SUT_OTBND_CART - OUTBOUND CARTON   * 08380028
083900*---------------------------------------------------------------* 08390028
084000     EXEC SQL                                                     08400000
084100          INCLUDE SUT00024                                        08410000
084200     END-EXEC.                                                    08420000
084300                                                                  08430028
084400*---------------------------------------------------------------* 08440028
084500*    DB2 AREA FOR TSHPUNT - INBOUND CARTON                      * 08450028
084600*---------------------------------------------------------------* 08460028
084700     EXEC SQL                                                     08470028
084800          INCLUDE TSHPUNT                                         08480028
084900     END-EXEC.                                                    08490028
085000                                                                  08500028
085100*---------------------------------------------------------------* 08510028
085200*    DB2 AREA FOR TINPKSU - INBOUND PACKSLIP SHIP UNIT          * 08520028
085300*---------------------------------------------------------------* 08530028
085400     EXEC SQL                                                     08540028
085500          INCLUDE TINPKSU                                         08550028
085600     END-EXEC.                                                    08560028
085700                                                                  08570028
085800*---------------------------------------------------------------* 08580028
085900*    DB2 AREA FOR TSHUNLO - INBOUND CARTON LOCATION             * 08590028
086000*---------------------------------------------------------------* 08600028
086100     EXEC SQL                                                     08610028
086200          INCLUDE TSHUNLO                                         08620028
086300     END-EXEC.                                                    08630028
086400                                                                  08640028
086500*---------------------------------------------------------------* 08650029
086600*    DB2 AREA FOR TPKSLIP - PACKSLIP                            * 08660029
086700*---------------------------------------------------------------* 08670029
086800     EXEC SQL                                                     08680029
086900          INCLUDE TPKSLIP                                         08690029
087000     END-EXEC.                                                    08700029
087100                                                                  08710029
087200***************************************************************** 08720000
087300*    DB2 AREA FOR THE PO/RMS ROLLOUT CONTROL TABLE              * 08730000
087400*    (POT_RMS_RLOUT_CTL)                                        * 08740000
087500***************************************************************** 08750000
087600     EXEC SQL                                                     08760000
087700          INCLUDE POT00006                                        08770000
087800     END-EXEC.                                                    08780000
087900*                                                                 08790000
088000******************************************************************08800000
088100*    DB2 CURSOR DEFINITION FOR RETRIEVAL OF RECEIVER DISTRIBUTION 08810000
088200******************************************************************08820000
088300     EXEC SQL                                                     08830000
088400          DECLARE RECDIS-CURSOR CURSOR FOR                        08840000
088500           SELECT EXPTED_ITM_QTY,                                 08850000
088600                  VERIFY_ITM_QTY,                                 08860000
088700                  AP_VERIFY_ITM_QTY,                              08870000
088800                  STR_NBR                                         08880000
088900             FROM TRECDIS                                         08890000
089000            WHERE ORD_NBR        = :DK-PO-NBR                     08900000
089100              AND ORD_LNE_NBR    = :DK-PKSL-LNE-NBR               08910000
089200              AND REC_SEQ_NBR    = :DK-REC-SEQ-NBR                08920000
089300              AND OPER_UNT_ID    = :ASC-KEY-OPER-UNT-ID           08930000
089400              AND FCLTY_ID       = :ASC-KEY-FCLTY-ID              08940000
089600         ORDER BY STR_NBR                                         08960000
089700     END-EXEC.                                                    08970000
089800/                                                                 08980000
089900******************************************************************08990000
090000*    DB2 CURSOR DEFINITION FOR RETRIEVAL RECDVS ROWS              09000000
090100******************************************************************09010000
090200     EXEC SQL                                                     09020000
090300          DECLARE RECDVS-CURSOR CURSOR FOR                        09030000
090400          SELECT                                                  09040000
090500                  VRFY_SRC_CDE                                    09050000
090600                , EXPTED_ITM_QTY                                  09060000
090700                , VRFY_ITM_QTY                                    09070000
090800            FROM                                                  09080000
090900                  TRECDVS                                         09090000
091000            WHERE                                                 09100000
091100                  ORD_NBR          = :DK-PO-NBR                   09110000
091200              AND REC_SEQ_NBR      = :DK-REC-SEQ-NBR              09120000
091300              AND ORD_LNE_NBR      = :DK-PKSL-LNE-NBR             09130000
091400              AND STR_NBR          = :PV-STORE-NUM                09140000
091500              AND VER_STAT_CDE     = 'A'                          09150000
091600              AND VRFY_SRC_CDE     IN ('P2','CP')                 09160000
091700     END-EXEC.                                                    09170000
091800/                                                                 09180000
091900 LINKAGE SECTION.                                                 09190000
092000                                                                  09200000
092100 01  DFHCOMMAREA.                                                 09210000
092200     05  FILLER                       OCCURS 1 TO 4072 TIMES      09220000
092300                                      DEPENDING ON EIBCALEN.      09230000
092400         10  FILLER                   PIC X.                      09240000
092500                                                                  09250000
092600                                                                  09260000
092700 PROCEDURE DIVISION.                                              09270000
092800                                                                  09280000
092900 0000-MAIN-MODULE.                                                09290000
093000                                                                  09300000
093100     INITIALIZE DP030-CICS-API-FIELDS.                            09310000
093200                                                                  09320000
093300     MOVE +1                     TO DP030-NUMBER-OF-MAPS.         09330000
093400     MOVE PC-CURRENT-MAPSET-NAME TO DP030-MAPSET-NAME.            09340000
093500     MOVE PC-CURRENT-MAP-NAME    TO DP030-MAP-NAME (1).           09350000
093600     SET DP030-RECEIVE-APPL-MAP  TO TRUE.                         09360000
093700     MOVE LENGTH OF RC284AI      TO DP030-MAP-LENGTH (1).         09370000
093800     MOVE 'PROGRAM ENTRY CALL'   TO DP013-MESSAGE-TEXT (1).       09380000
093900     SET DP030-OVERRIDE-APPL-ERROR                                09390000
094000                                 TO TRUE.                         09400000
094100                                                                  09410000
094200     PERFORM 0001-CALL-CICS-ARCH-API.                             09420000
094300                                                                  09430000
094400     PERFORM 1000-CONTROL-PROCESSING.                             09440000
094500                                                                  09450000
094600     MOVE 'PROGRAM EXIT CALL'    TO DP013-MESSAGE-TEXT (1).       09460000
094700                                                                  09470000
094800     PERFORM 0001-CALL-CICS-ARCH-API.                             09480000
094900                                                                  09490000
095000 0001-CALL-CICS-ARCH-API.                                         09500000
095100                                                                  09510000
095210     CALL DP930-CICS-ARCH-API USING DFHEIBLK                      09521064
095300                                    DFHCOMMAREA                   09530064
095400                                    DP030-CICS-API-FIELDS         09540064
095500                                    DP020-STANDARD-COMMAREA       09550064
095600                                    RC284AI.                      09560064
095700                                                                  09570000
095800     IF DP030-RC-CALL-SUCCESSFUL OR                               09580000
095900        DP030-RC-APPL-ERROR                                       09590000
096000         CONTINUE                                                 09600000
096100     ELSE                                                         09610000
096200         SET DP013-CICS-ABEND                                     09620000
096300             DP013-NO-ROLLBACK                                    09630000
096400             DP013-XCTL-DISPLAY-RESTART                           09640000
096500                                 TO TRUE                          09650000
096600         MOVE '0001-CALL-CICS-ARCH-API'                           09660000
096700                                 TO DP013-PARAGRAPH               09670000
096720         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN CODE O09672064
096730-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      09673064
097000         MOVE DP030-RETURN-CODE  TO DP013-MESSAGE-TEXT (3)        09700000
097100                                                                  09710000
097200         PERFORM DP013-0000-PROCESS-ABEND.                        09720000
097300                                                                  09730000
097400 1000-CONTROL-PROCESSING.                                         09740000
097500                                                                  09750000
097600     EVALUATE TRUE                                                09760000
097700                                                                  09770000
097800         WHEN DP030-RC-APPL-ERROR                                 09780000
097900              MOVE ASC-ITEM-AT-TOP-OF-PANEL                       09790000
098000                                 TO PV-TOP-ITEM                   09800000
098100              MOVE ZERO          TO ASC-ITEM-AT-TOP-OF-PANEL      09810000
098200                                                                  09820000
098300              PERFORM 6000-REFRESH-PANEL-FROM-TEMP                09830000
098400                                                                  09840000
098500              PERFORM 3000-EDIT-DATA-IN-COMMAREA                  09850000
098600                                                                  09860000
098700              PERFORM 3200-RESET-ATTRIBUTES                       09870041
098800              PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                09880000
098900                                                                  09890000
099000                                                                  09900000
099100         WHEN DP020-NEXT-ACT-INITIAL                              09910000
099200              INITIALIZE ASC-SPECIFIC-COMMAREA                    09920000
099300              MOVE EIBTRMID      TO ASC-LIST-TERM-ID              09930000
099400                                    ASC-SEL-TERM-ID               09940000
099500                                    ASC-VRFY-ADJ-TERM-ID          09950000
099600              MOVE DP020-SRC-TASK-NUMBER                          09960000
099700                                 TO ASC-LIST-TASK-NUMBER          09970000
099800                                    ASC-SEL-TASK-NUMBER           09980000
099900                                    ASC-VRFY-ADJ-TASK-NUMBER      09990000
100000              MOVE PC-LIST-QUEUE-SEQ                              10000000
100100                                 TO ASC-LIST-SEQ                  10010000
100200              MOVE PC-SEL-QUEUE-SEQ                               10020000
100300                                 TO ASC-SEL-SEQ                   10030000
100400              MOVE PC-VRFY-ADJ-QUEUE-SEQ                          10040000
100500                                 TO ASC-VRFY-ADJ-SEQ              10050000
100600              SET PS-NO-ERROR    TO TRUE                          10060000
100700                                                                  10070000
100800              PERFORM 1100-PROCESS-INTER-APPL-COMM                10080000
100900                                                                  10090000
101000              IF PS-NO-ERROR                                      10100000
101100                  MOVE INTER-APPL-COMM-AREA                       10110000
101200                                 TO ASC-HOLD-INTER-APPL           10120000
101300                  PERFORM 3200-RESET-ATTRIBUTES                   10130000
101400                  PERFORM 4000-BUILD-INITIAL-PANEL THRU 4000-EXIT 10140004
101500              END-IF                                              10150000
101600                                                                  10160000
101700                                                                  10170000
101800         WHEN DP020-NEXT-ACT-READ-MAP                             10180000
101900              MOVE ASC-ITEM-AT-TOP-OF-PANEL                       10190000
102000                                 TO PV-TOP-ITEM                   10200000
102100                                                                  10210000
102200              PERFORM 2000-PROCESS-PANEL                          10220000
102300                                                                  10230000
102400                                                                  10240000
102500         WHEN DP020-NEXT-ACT-RETURN                               10250000
102600              MOVE ASC-ITEM-AT-TOP-OF-PANEL                       10260000
102700                                 TO PV-TOP-ITEM                   10270000
102800              MOVE ZERO          TO ASC-ITEM-AT-TOP-OF-PANEL      10280000
102900              MOVE ASC-HOLD-INTER-APPL                            10290000
103000                                 TO INTER-APPL-COMM-AREA          10300000
103100*             THIS PROGRAM REQUIRES THAT ANY ADDED OR CHANGED     10310000
103200*             INFORMATION BE DISPLAYED UPON RETURN TO THIS        10320000
103300*             PROGRAM.  THEREFORE THE LIST QUEUE IS REBUILT.      10330000
103400                                                                  10340000
103500              PERFORM 2050-DELETE-LIST-QUEUE                      10350000
103600              MOVE 0 TO ASC-ITEMS-DISPLAYED                       10360051
103700              PERFORM 3200-RESET-ATTRIBUTES                       10370020
103800              PERFORM 4000-BUILD-INITIAL-PANEL THRU 4000-EXIT     10380000
103900                                                                  10390000
104000         WHEN OTHER                                               10400000
104100              SET DP013-LOGIC-ABEND                               10410000
104200                  DP013-NO-ROLLBACK                               10420000
104300                                 TO TRUE                          10430000
104400              MOVE '1000-CONTROL-PROCESSING'                      10440000
104500                                 TO DP013-PARAGRAPH               10450000
104600              MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'   10460000
104700                                 TO DP013-MESSAGE-TEXT(1)         10470000
104800                                                                  10480000
104900              PERFORM DP013-0000-PROCESS-ABEND                    10490000
105000                                                                  10500000
105100     END-EVALUATE.                                                10510000
105200                                                                  10520000
105300 1100-PROCESS-INTER-APPL-COMM.                                    10530000
105400                                                                  10540000
105500     MOVE SPACE                  TO ASC-START-ITEM-REQUEST.       10550000
105600     MOVE DP020-INT-APPL-FORMAT-IND                               10560000
105700                                 TO ASC-INTER-APPL-CODE-IND.      10570000
105800* SINCE THERE'S ONLY ONE POSSIBLE VALUE FOR THIS CODE,            10580000
105900* THERE'S NO NEED TO INTEROGATE IT.                               10590000
106000                                                                  10600000
106100     IF RC015-NUMBER-OF-SELECTED-ITEMS = ZERO                     10610000
106200         SET ASC-NO-TSQ-UPDATE                                    10620000
106300                                 TO TRUE                          10630000
106400         SET DP020-MSG-FATAL                                      10640000
106500             DP020-NEXT-ACT-APPL-ERROR                            10650019
106600                     PS-ERROR    TO TRUE                          10660000
106700             MOVE PC-TSYMSG-00057                                 10670000
106800                                 TO DP020-MSG-NUMBER              10680000
106900     ELSE                                                         10690000
107000         MOVE RC015-PO-NBR       TO ASC-KEY-PO-NBR-N              10700000
107100                                    DK-PO-NBR                     10710000
107200         MOVE RC015-SEQ-NBR      TO ASC-KEY-SEQ-NBR               10720000
107300         MOVE RC015-REC-SEQ-NBR  TO ASC-KEY-REC-SEQ-NBR-N         10730000
107400                                    DK-REC-SEQ-NBR                10740000
107500         MOVE RC015-OPER-UNT-ID  TO ASC-KEY-OPER-UNT-ID           10750000
107600         MOVE RC015-FCLTY-ID     TO ASC-KEY-FCLTY-ID              10760000
107700         MOVE RC015-PKSL-NBR     TO ASC-KEY-PKSL-NBR              10770000
107800         MOVE RC015-PKSL-LNE-NBR TO ASC-KEY-PKSL-LNE-NBR          10780000
107900                                    DK-PKSL-LNE-NBR               10790000
108000                                                                  10800000
108100         SET ASC-USE-SELECTION-QUEUE                              10810000
108200                                 TO TRUE                          10820000
108300         MOVE RC015-NUMBER-OF-SELECTED-ITEMS                      10830000
108400                                 TO ASC-NUMBER-OF-SELECTED-ITEMS  10840000
108500         MOVE RC015-NUMBER-OF-TS-ITEMS                            10850000
108600                                 TO ASC-NUMBER-OF-TS-ITEMS        10860000
108700         MOVE RC015-SEL-QUEUE-NAME                                10870000
108800                                 TO ASC-SEL-QUEUE-NAME-IN         10880000
108900         MOVE RC013-MAX-ITEMS    TO ASC-SEL-SUB                   10890000
109000         MOVE ZERO               TO ASC-SEL-ITEM                  10900000
109100         PERFORM 2300-GET-NEXT-RECORD                             10910000
109200     END-IF.                                                      10920000
109300     EJECT                                                        10930000
109400 2000-PROCESS-PANEL.                                              10940000
109500                                                                  10950000
109600     SET PS-NEXT-SCREEN TO TRUE.                                  10960000
109700     EVALUATE TRUE                                                10970000
109800                                                                  10980000
109900         WHEN DP020-SRC-AID = DP016-CLEAR                         10990000
110000              MOVE ZERO          TO ASC-ITEM-AT-TOP-OF-PANEL      11000000
110100                                                                  11010000
110200              PERFORM 3000-EDIT-DATA-IN-COMMAREA                  11020000
110300                                                                  11030000
110400              PERFORM 3200-RESET-ATTRIBUTES                       11040041
110500              PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                11050000
110600                                                                  11060000
110700                                                                  11070000
110800         WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    11080000
110900                                                                  11090000
111000              PERFORM 2050-DELETE-LIST-QUEUE                      11100000
111100                                                                  11110000
111200              SET ASC-NO-OVERAGE TO TRUE                          11120000
111300              SET ASC-DONT-CONFIRM-UPDATE TO TRUE                 11130000
111400                                                                  11140000
111500              PERFORM 3200-RESET-ATTRIBUTES                       11150000
111600                                                                  11160000
111700              PERFORM 4000-BUILD-INITIAL-PANEL THRU 4000-EXIT     11170004
111800                                                                  11180004
111900         WHEN DP020-FK-DESELECT (DP020-SRC-AID)                   11190000
112000                                                                  11200000
112100              PERFORM 2140-DESELECT-ALL-ITEMS                     11210000
112200                                                                  11220000
112300              PERFORM 3200-RESET-ATTRIBUTES                       11230041
112400              PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                11240000
112500                                                                  11250000
112600         WHEN DP020-FK-SELECT-ALL (DP020-SRC-AID)                 11260000
112700                                                                  11270000
112800              PERFORM 2150-SELECT-ALL-ITEMS                       11280000
112900              PERFORM 3200-RESET-ATTRIBUTES                       11290041
113000              PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                11300000
113100                                                                  11310000
113200         WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)              11320000
113300                                                                  11330000
113400             IF  ASC-RECITM-STATUS-CDE = 'VE'                     11340000
113500                 PERFORM 3200-RESET-ATTRIBUTES                    11350000
113600                 MOVE PC-TSYMSG-00045 TO DP020-MSG-NUMBER         11360000
113700                 SET DP020-MSG-FATAL  TO TRUE                     11370000
113800             ELSE                                                 11380000
113900                 PERFORM 2150-SELECT-ALL-ITEMS                    11390000
114000                 PERFORM 3200-RESET-ATTRIBUTES                    11400041
114100                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             11410000
114200             END-IF                                               11420000
114300                                                                  11430000
114400         WHEN DP020-FK-NEXT-SELECTION (DP020-SRC-AID)             11440000
114500             IF ASC-USE-SELECTION-QUEUE                           11450000
114600                 IF ASC-OVERAGE                                   11460000
114700                     ADD +1 TO ASC-OVERAGE-COUNT                  11470000
114800                     IF ASC-OVERAGE-2                             11480000
114900                         SET ASC-NO-OVERAGE TO TRUE               11490000
115000                         MOVE 0 TO ASC-OVERAGE-COUNT              11500000
115100                         PERFORM 6200-DEL-LIST-QUEUE              11510000
115200                         PERFORM 2300-GET-NEXT-RECORD             11520000
115300                         MOVE 0 TO ASC-ITEMS-DISPLAYED            11530049
115400                         PERFORM 3200-RESET-ATTRIBUTES            11540000
115500                         PERFORM 4000-BUILD-INITIAL-PANEL         11550004
115600                             THRU 4000-EXIT                       11560004
115700                     ELSE                                         11570000
115800                         PERFORM 3200-RESET-ATTRIBUTES            11580000
115900                         MOVE PC-TSYMSG-01264                     11590000
116000                            TO DP020-MSG-NUMBER                   11600000
116100                         SET DP020-MSG-FATAL                      11610000
116200                                     TO TRUE                      11620000
116300                     END-IF                                       11630000
116400                 ELSE                                             11640000
116500                     PERFORM 6200-DEL-LIST-QUEUE                  11650000
116600                     PERFORM 2300-GET-NEXT-RECORD                 11660000
116700                     MOVE 0 TO ASC-ITEMS-DISPLAYED                11670049
116800                     PERFORM 3200-RESET-ATTRIBUTES                11680000
116900                     PERFORM 4000-BUILD-INITIAL-PANEL             11690004
117000                         THRU 4000-EXIT                           11700004
117100             ELSE                                                 11710000
117200*                --- BOTTOM OF LIST ---                           11720000
117300                 IF ASC-OVERAGE                                   11730000
117400                     MOVE PC-TSYMSG-01264                         11740000
117500                                 TO DP020-MSG-NUMBER              11750000
117600                     SET DP020-MSG-INFORMATIONAL                  11760000
117700                                 TO TRUE                          11770000
117800                 ELSE                                             11780000
117900                     MOVE PC-TSYMSG-00070                         11790000
118000                                 TO DP020-MSG-NUMBER              11800000
118100                     SET DP020-MSG-INFORMATIONAL                  11810000
118200                                 TO TRUE                          11820000
118300                 END-IF                                           11830000
118400             END-IF                                               11840000
118500                                                                  11850000
118600         WHEN DP020-FK-PREV-SELECTION (DP020-SRC-AID)             11860000
118700             IF ASC-USE-SELECTION-QUEUE                           11870000
118800                 IF ASC-OVERAGE                                   11880000
118900                     ADD +1 TO ASC-OVERAGE-COUNT                  11890000
119000                     IF ASC-OVERAGE-2                             11900000
119100                         SET ASC-NO-OVERAGE TO TRUE               11910000
119200                         MOVE 0 TO ASC-OVERAGE-COUNT              11920000
119300                         PERFORM 6200-DEL-LIST-QUEUE              11930000
119400                         PERFORM 2310-GET-PREV-RECORD             11940000
119500                         PERFORM 3200-RESET-ATTRIBUTES            11950000
119600                         PERFORM 4000-BUILD-INITIAL-PANEL         11960004
119700                             THRU 4000-EXIT                       11970004
119800                     ELSE                                         11980000
119900                         PERFORM 3200-RESET-ATTRIBUTES            11990000
120000                         MOVE PC-TSYMSG-01264                     12000000
120100                            TO DP020-MSG-NUMBER                   12010000
120200                         SET DP020-MSG-FATAL                      12020000
120300                                     TO TRUE                      12030000
120400                         END-IF                                   12040000
120500                 ELSE                                             12050000
120600                     PERFORM 6200-DEL-LIST-QUEUE                  12060000
120700                     PERFORM 2310-GET-PREV-RECORD                 12070000
120800                     PERFORM 3200-RESET-ATTRIBUTES                12080000
120900                     PERFORM 4000-BUILD-INITIAL-PANEL             12090004
121000                         THRU 4000-EXIT                           12100004
121100*                --- TOP OF LIST ---                              12110000
121200               ELSE                                               12120000
121300                 IF ASC-OVERAGE                                   12130000
121400                     MOVE PC-TSYMSG-01264                         12140000
121500                        TO DP020-MSG-NUMBER                       12150000
121600                     SET DP020-MSG-INFORMATIONAL                  12160000
121700                                 TO TRUE                          12170000
121800                 ELSE                                             12180000
121900                     MOVE PC-TSYMSG-00069                         12190000
122000                        TO DP020-MSG-NUMBER                       12200000
122100                     SET DP020-MSG-INFORMATIONAL                  12210000
122200                                 TO TRUE                          12220000
122300                 END-IF                                           12230000
122400             END-IF                                               12240000
122500                                                                  12250000
122600                                                                  12260000
122700         WHEN OTHER                                               12270000
122800                                                                  12280000
122900              PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                12290000
123000                                                                  12300000
123100              PERFORM 3000-EDIT-DATA-IN-COMMAREA                  12310000
123200                                                                  12320000
123300              IF PS-NO-ERROR                                      12330000
123400                  SET DP030-CONTINUE-GO                           12340000
123500                                 TO TRUE                          12350000
123600                                                                  12360000
123700                  PERFORM 2100-CHECK-FUNCTION-KEY                 12370000
123800                                                                  12380000
123900              ELSE                                                12390000
124000                  PERFORM 3200-RESET-ATTRIBUTES                   12400036
124100                  PERFORM 4400-MOVE-COMMAREA-TO-SCREEN            12410036
124200                  SET DP030-OVERRIDE-GO                           12420000
124300                                 TO TRUE                          12430000
124400              END-IF                                              12440000
124500                                                                  12450000
124600     END-EVALUATE.                                                12460000
124700                                                                  12470000
124800 2050-DELETE-LIST-QUEUE.                                          12480000
124900                                                                  12490000
125000     EXEC CICS DELETEQ TS QUEUE (ASC-LIST-QUEUE-NAME)             12500000
125100                          RESP  (PV-CICS-RESP)                    12510000
125200                          END-EXEC.                               12520000
125300                                                                  12530000
125400     IF (PV-CICS-RESP = DFHRESP (NORMAL)) OR                      12540000
125500        (PV-CICS-RESP = DFHRESP (QIDERR))                         12550000
125600         CONTINUE                                                 12560000
125700     ELSE                                                         12570000
125800         SET DP013-CICS-ABEND                                     12580000
125900             DP013-NO-ROLLBACK   TO TRUE                          12590000
126000         MOVE '2050-DELETE-LIST-QUEUE'                            12600000
126100                                 TO DP013-PARAGRAPH               12610000
126200         MOVE 'UNSUCCESSFUL LIST ITEMS TEMP STORAGE QUEUE DELETE' 12620000
126300                                 TO DP013-MESSAGE-TEXT (1)        12630000
126400                                                                  12640000
126500         PERFORM DP013-0000-PROCESS-ABEND                         12650000
126600     END-IF.                                                      12660000
126700                                                                  12670000
126800     MOVE ZERO                   TO ASC-HIGHEST-BLOCK-WRITTEN.    12680000
126900                                                                  12690000
127000 2100-CHECK-FUNCTION-KEY.                                         12700000
127100                                                                  12710000
127200     SET PS-NEXT-SCREEN TO TRUE.                                  12720000
127300     EVALUATE TRUE                                                12730000
127400         WHEN DP020-FK-LOCAL-GOTO (DP020-SRC-AID)                 12740000
127500              IF (ASC-CANT-UPDATE                                 12750000
127600              AND DP020-SRC-AID EQUAL DP016-PF22)                 12760000
127700                  MOVE PC-TSYMSG-00734                            12770000
127800                                 TO  DP020-MSG-NUMBER             12780000
127900                  SET PS-ERROR                                    12790000
128000                      DP030-OVERRIDE-GO                           12800000
128100                      DP020-MSG-FATAL                             12810000
128200                                 TO TRUE                          12820000
128300              ELSE                                                12830000
128400                  MOVE ASC-NUMBER-OF-SELECTED-ITEMS               12840000
128500                                 TO RC015-NUMBER-OF-SELECTED-ITEMS12850000
128600                  MOVE ASC-KEY-PO-NBR-N                           12860000
128700                                 TO RC015-PO-NBR                  12870000
128800                  MOVE ASC-KEY-REC-SEQ-NBR-N                      12880000
128900                                 TO RC015-REC-SEQ-NBR             12890000
129000                  MOVE ASC-KEY-OPER-UNT-ID                        12900000
129100                                 TO RC015-OPER-UNT-ID             12910000
129200                  MOVE ASC-KEY-FCLTY-ID                           12920000
129300                                 TO RC015-FCLTY-ID                12930000
129400                  MOVE ASC-KEY-PKSL-LNE-NBR                       12940000
129500                                 TO RC015-PKSL-LNE-NBR            12950000
129600                  MOVE ASC-KEY-PKSL-NBR                           12960000
129700                                 TO RC015-PKSL-NBR                12970000
129800                  PERFORM 5000-PREPARE-SEL-QUEUE                  12980000
129900                  IF ASC-NUMBER-OF-SELECTED-ITEMS = ZERO          12990000
130000                      SET ASC-NO-TSQ-UPDATE TO TRUE               13000000
130100                  END-IF                                          13010000
130200              END-IF                                              13020000
130300                                                                  13030000
130400         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              13040000
130500         WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              13050000
130600                                                                  13060000
130700              IF DP020-FK-LOCAL-FUNC-02(DP020-SRC-AID) AND        13070021
130800                 (ASC-UPDATE-NOT-ALLOWED OR ASC-AUTO-VE-YES)      13080055
130900                  SET ASC-NO-TSQ-UPDATE                           13090021
131000                                 TO TRUE                          13100021
131100                  SET DP030-OVERRIDE-GO                           13110021
131200                      DP020-MSG-WARNING                           13120021
131300                                 TO TRUE                          13130021
131400                  EVALUATE TRUE                                   13140056
131500                      WHEN ASC-UPDATE-NOT-ALLOWED                 13150056
131600                          MOVE PC-TSYMSG-03233  TO                13160056
131700                                  DP020-MSG-NUMBER                13170056
131800                      WHEN ASC-AUTO-VE-YES                        13180056
131900                          MOVE PC-TSYMSG-03180  TO                13190058
132000                                  DP020-MSG-NUMBER                13200056
132100                  END-EVALUATE                                    13210056
132200              ELSE                                                13220021
132300                IF ASC-NUMBER-OF-SELECTED-ITEMS = ZERO            13230021
132400                    SET ASC-NO-TSQ-UPDATE                         13240021
132500                                   TO TRUE                        13250021
132600                    SET DP030-OVERRIDE-GO                         13260021
132700                        DP020-MSG-WARNING                         13270021
132800                                   TO TRUE                        13280021
132900                    MOVE PC-TSYMSG-00057                          13290021
133000                                   TO DP020-MSG-NUMBER            13300021
133100                ELSE                                              13310021
133200                    IF ASC-NUMBER-OF-SELECTED-ITEMS > ZERO        13320021
133300                       IF ASC-CONFIRM-UPDATE                      13330021
133400                          SET ASC-CONFIRMED TO TRUE               13340021
133500                          MOVE PC-TSYMSG-01817                    13350021
133600                          TO  DP020-MSG-NUMBER                    13360021
133700                          SET PS-ERROR                            13370021
133800                          DP030-OVERRIDE-GO                       13380021
133900                          DP020-MSG-WARNING TO TRUE               13390021
134000                          PERFORM 3200-RESET-ATTRIBUTES           13400041
134100                          PERFORM 4400-MOVE-COMMAREA-TO-SCREEN    13410021
134200                       ELSE                                       13420021
134300                       IF RC015-PACK-BY-STORE                     13430021
134400                            INITIALIZE                            13440021
134500                                   RC015-INTER-APPL-COMMAREA      13450021
134600                            SET RC015-PACK-BY-STORE TO TRUE       13460021
134700                            MOVE ASC-NUMBER-OF-SELECTED-ITEMS     13470021
134800                                TO  RC015-NUMBER-OF-SELECTED-ITEMS13480021
134900                                MOVE ASC-KEY-PO-NBR-N             13490021
135000                                     TO RC015-PO-NBR              13500021
135100                                PERFORM 5005-PREPARE-SEL-QUEUE    13510021
135200                            IF ASC-OVERAGE                        13520021
135300                                SET ASC-CONFIRMED TO TRUE         13530021
135400                                MOVE PC-TSYMSG-01264              13540021
135500                                    TO  DP020-MSG-NUMBER          13550021
135600                                SET PS-ERROR                      13560021
135700                                    DP030-OVERRIDE-GO             13570021
135800                                    DP020-MSG-FATAL TO TRUE       13580021
135900                            ELSE                                  13590021
136000                                SET ASC-NO-OVERAGE TO TRUE        13600021
136100                                PERFORM 5000-PREPARE-SEL-QUEUE    13610021
136200                                SET ASC-NO-TSQ-UPDATE TO TRUE     13620021
136300                            END-IF                                13630021
136400                        ELSE                                      13640021
136500                            INITIALIZE                            13650021
136600                                   RC015-INTER-APPL-COMMAREA      13660021
136700                            MOVE ASC-NUMBER-OF-SELECTED-ITEMS     13670021
136800                                    TO                            13680021
136900                                    RC015-NUMBER-OF-SELECTED-ITEMS13690021
137000                            MOVE ASC-KEY-PO-NBR-N                 13700021
137100                                     TO RC015-PO-NBR              13710021
137200                            PERFORM 5000-PREPARE-SEL-QUEUE        13720021
137300                            SET ASC-NO-TSQ-UPDATE TO TRUE         13730021
137400                        END-IF                                    13740021
137500                    END-IF                                        13750021
137600                  END-IF                                          13760021
137700                END-IF                                            13770021
137800              END-IF                                              13780021
137900                                                                  13790000
138000         WHEN  DP020-FK-CONFIRM(DP020-SRC-AID)                    13800000
138100            IF ASC-NUMBER-OF-SELECTED-ITEMS = ZERO                13810000
138200                 SET ASC-NO-TSQ-UPDATE                            13820000
138300                                TO TRUE                           13830000
138400                 SET DP030-OVERRIDE-GO                            13840000
138500                      DP020-MSG-WARNING                           13850000
138600                                 TO TRUE                          13860000
138700                 MOVE PC-TSYMSG-00057                             13870000
138800                                 TO DP020-MSG-NUMBER              13880000
138900            ELSE                                                  13890000
139000                 IF ASC-NUMBER-OF-SELECTED-ITEMS > ZERO           13900000
139100*                    INITIALIZE RC015-INTER-APPL-COMMAREA         13910000
139200                     IF ASC-CONFIRMED                             13920000
139300                         SET ASC-DONT-CONFIRM-UPDATE TO TRUE      13930000
139400                         MOVE ASC-NUMBER-OF-SELECTED-ITEMS        13940000
139500                            TO RC015-NUMBER-OF-SELECTED-ITEMS     13950000
139600                         MOVE ASC-KEY-PO-NBR-N                    13960000
139700                            TO RC015-PO-NBR                       13970000
139800                         PERFORM 5000-PREPARE-SEL-QUEUE           13980000
139900                             SET ASC-NOT-CONFIRMED TO TRUE        13990000
140000                     ELSE                                         14000000
140100                         SET DP030-OVERRIDE-GO                    14010000
140200                             DP020-MSG-WARNING                    14020000
140300                             TO TRUE                              14030000
140400                         MOVE PC-TSYMSG-00045                     14040000
140500                             TO DP020-MSG-NUMBER                  14050000
140600                     END-IF                                       14060000
140700             END-IF                                               14070000
140800        END-IF                                                    14080000
140900                                                                  14090000
141000         WHEN DP020-FK-FIRST-PAGE (DP020-SRC-AID)                 14100000
141100             MOVE +1             TO PV-TOP-ITEM                   14110000
141200             IF ASC-OVERAGE                                       14120000
141300                 MOVE PC-TSYMSG-01264                             14130000
141400                          TO DP020-MSG-NUMBER                     14140000
141500                SET DP020-MSG-FATAL                               14150000
141600                                     TO TRUE                      14160000
141700             ELSE                                                 14170000
141800                 MOVE PC-TSYMSG-00069    TO DP020-MSG-NUMBER      14180000
141900                 SET DP020-MSG-INFORMATIONAL                      14190000
142000                                     TO TRUE                      14200000
142100                                                                  14210000
142200             END-IF                                               14220000
142300                                                                  14230000
142400             PERFORM 3200-RESET-ATTRIBUTES                        14240020
142500             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 14250000
142600                                                                  14260000
142700                                                                  14270000
142800         WHEN DP020-FK-PREV-PAGE (DP020-SRC-AID)                  14280000
142900                                                                  14290000
143000             MOVE PC-ITEMS-PER-PANEL TO ASC-ITEMS-DISPLAYED       14300024
143100             PERFORM 2110-BROWSE-BACKWARD                         14310000
143200                                                                  14320000
143300             PERFORM 3200-RESET-ATTRIBUTES                        14330020
143400             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 14340000
143500                                                                  14350000
143600                                                                  14360000
143700         WHEN DP020-FK-NEXT-PAGE (DP020-SRC-AID)                  14370000
143800                                                                  14380000
143900             PERFORM 2120-BROWSE-FORWARD                          14390000
144000                                                                  14400000
144100             PERFORM 3200-RESET-ATTRIBUTES                        14410020
144200             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 14420000
144300                                                                  14430000
144400                                                                  14440000
144500         WHEN DP020-SRC-AID = DP016-ENTER                         14450000
144600                                                                  14460000
144700             PERFORM 2180-CHECK-FOR-JUMP-BROWSE                   14470000
144800                                                                  14480000
144900             PERFORM 3200-RESET-ATTRIBUTES                        14490020
145000             IF PS-NO-ERROR                                       14500000
145100                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             14510000
145200             END-IF                                               14520000
145300                                                                  14530000
145400             SET ASC-DONT-CONFIRM-UPDATE TO TRUE                  14540000
145500                                                                  14550000
145600         WHEN OTHER                                               14560000
145700             SET DP013-CICS-ABEND                                 14570000
145800                 DP013-NO-ROLLBACK                                14580000
145900                 DP013-XCTL-DISPLAY-RESTART                       14590000
146000                                 TO TRUE                          14600000
146100             MOVE '2100-CHECK-FUNCTION-KEY'                       14610000
146200                                 TO DP013-PARAGRAPH               14620000
146300             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      14630000
146400                                 TO DP013-MESSAGE-TEXT (1)        14640000
146500                                                                  14650000
146600             PERFORM DP013-0000-PROCESS-ABEND                     14660000
146700     END-EVALUATE.                                                14670000
146800                                                                  14680000
146900 2110-BROWSE-BACKWARD.                                            14690000
147000                                                                  14700000
147100     SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-AT-TOP-OF-PANEL    14710000
147200         GIVING PV-TOP-ITEM.                                      14720000
147300                                                                  14730000
147400     IF PV-TOP-ITEM NOT > +1                                      14740000
147500         MOVE +1                 TO PV-TOP-ITEM                   14750000
147600         MOVE PC-TSYMSG-00069    TO DP020-MSG-NUMBER              14760000
147700         SET DP020-MSG-INFORMATIONAL                              14770000
147800                                 TO TRUE.                         14780000
147900         IF ASC-OVERAGE                                           14790000
148000             MOVE PC-TSYMSG-01264                                 14800000
148100                      TO DP020-MSG-NUMBER                         14810000
148200            SET DP020-MSG-FATAL                                   14820000
148300                                 TO TRUE                          14830000
148400         ELSE                                                     14840000
148500             MOVE PC-TSYMSG-00069    TO DP020-MSG-NUMBER          14850000
148600             SET DP020-MSG-INFORMATIONAL                          14860000
148700                                 TO TRUE                          14870000
148800         END-IF.                                                  14880000
148900                                                                  14890000
149000 2120-BROWSE-FORWARD.                                             14900000
149100                                                                  14910000
149200     ADD PC-ITEMS-PER-PANEL ASC-ITEM-AT-TOP-OF-PANEL              14920000
149300         GIVING PV-TOP-ITEM.                                      14930000
149400                                                                  14940000
149500     IF PV-TOP-ITEM > ASC-NUMBER-OF-ITEMS-READ                    14950000
149600         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            14960000
149700                                 TO PV-TOP-ITEM                   14970000
149800         IF ASC-OVERAGE                                           14980000
149900             MOVE PC-TSYMSG-01264                                 14990000
150000                      TO DP020-MSG-NUMBER                         15000000
150100            SET DP020-MSG-FATAL                                   15010000
150200                                 TO TRUE                          15020000
150300         ELSE                                                     15030000
150400             MOVE PC-TSYMSG-00070    TO DP020-MSG-NUMBER          15040000
150500             SET DP020-MSG-INFORMATIONAL                          15050000
150600                                 TO TRUE                          15060000
150700         END-IF                                                   15070000
150800     ELSE                                                         15080000
150900         COMPUTE PV-BOTTOM-ITEM =                                 15090000
151000             PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1                 15100000
151100         IF PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ             15110000
151200             IF ASC-OVERAGE                                       15120000
151300                 MOVE PC-TSYMSG-01264                             15130000
151400                          TO DP020-MSG-NUMBER                     15140000
151500                SET DP020-MSG-FATAL                               15150000
151600                                     TO TRUE                      15160000
151700             ELSE                                                 15170000
151800                 MOVE PC-TSYMSG-00070    TO DP020-MSG-NUMBER      15180000
151900                 SET DP020-MSG-INFORMATIONAL                      15190000
152000                                     TO TRUE                      15200000
152100             END-IF                                               15210000
152200         END-IF.                                                  15220000
152300                                                                  15230000
152400 2180-CHECK-FOR-JUMP-BROWSE.                                      15240000
152500                                                                  15250000
152600     SET PS-NO-ERROR             TO TRUE.                         15260000
152700                                                                  15270000
152800     IF ASC-START-ITEM-REQUEST = SPACE                            15280000
152900         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            15290000
153000                                 TO PV-TOP-ITEM                   15300000
153100     ELSE                                                         15310000
153200         MOVE ASC-START-ITEM-REQUEST                              15320000
153300                                 TO DP010I-UNEDITED-FIELD         15330000
153400         MOVE +5                 TO DP010I-MAXIMUM-DIGITS         15340000
153500         MOVE ZERO               TO DP010I-MAXIMUM-DECIMALS       15350000
153600         SET DP010I-NEGATIVE-NOT-ALLOWED                          15360000
153700                                 TO TRUE                          15370000
153800                                                                  15380000
153910         CALL DP010I-NUMERIC-EDIT-ROUTINE                         15391062
153920              USING DP010I-NUMERIC-EDIT-AREA                      15392062
154000                                                                  15400000
154100         IF NOT DP010I-ERROR-DETECTED                             15410000
154200             MOVE DP010I-NUMERIC-FIELD                            15420000
154300                                 TO ASC-START-ITEM-REQUEST-N      15430000
154400             IF ASC-START-ITEM-REQUEST-N > ZERO                   15440000
154500                IF ASC-START-ITEM-REQUEST-N >                     15450000
154600                                          ASC-NUMBER-OF-ITEMS-READ15460000
154700                    MOVE SPACE   TO ASC-START-ITEM-REQUEST        15470000
154800                    COMPUTE PV-TOP-ITEM = ASC-NUMBER-OF-ITEMS-READ15480000
154900                                          - PC-ITEMS-PER-PANEL + 115490000
155000                    IF PV-TOP-ITEM < +1                           15500000
155100                        MOVE +1  TO PV-TOP-ITEM                   15510000
155200                        IF ASC-OVERAGE                            15520000
155300                            MOVE PC-TSYMSG-01264                  15530000
155400                                     TO DP020-MSG-NUMBER          15540000
155500                           SET DP020-MSG-FATAL                    15550000
155600                                                TO TRUE           15560000
155700                        ELSE                                      15570000
155800                            MOVE PC-TSYMSG-00069                  15580000
155900                                     TO DP020-MSG-NUMBER          15590000
156000                            SET DP020-MSG-INFORMATIONAL           15600000
156100                                                TO TRUE           15610000
156200                                                                  15620000
156300                        END-IF                                    15630000
156400                    END-IF                                        15640000
156500                ELSE                                              15650000
156600                    MOVE ASC-START-ITEM-REQUEST-N                 15660000
156700                                 TO PV-TOP-ITEM                   15670000
156800                    MOVE SPACE   TO ASC-START-ITEM-REQUEST        15680000
156900                    COMPUTE PV-BOTTOM-ITEM = PV-TOP-ITEM +        15690000
157000                                            PC-ITEMS-PER-PANEL - 115700000
157100                    IF PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ  15710000
157200                        IF ASC-OVERAGE                            15720000
157300                            MOVE PC-TSYMSG-01264                  15730000
157400                                     TO DP020-MSG-NUMBER          15740000
157500                           SET DP020-MSG-FATAL                    15750000
157600                                                TO TRUE           15760000
157700                        ELSE                                      15770000
157800                            MOVE PC-TSYMSG-00070                  15780000
157900                                            TO DP020-MSG-NUMBER   15790000
158000                            SET DP020-MSG-INFORMATIONAL           15800000
158100                                                TO TRUE           15810000
158200                                                                  15820000
158300                        END-IF                                    15830000
158400                    END-IF                                        15840000
158500                END-IF                                            15850000
158600             ELSE                                                 15860000
158700                 MOVE PC-TSYMSG-00101                             15870000
158800                                 TO DP020-MSG-NUMBER              15880000
158900                 SET DP030-SET-CURSOR-APPL-1                      15890000
159000                                 TO TRUE                          15900000
159100                 MOVE -1         TO ASTRTITL                      15910000
159200                 MOVE DP015-UNP-NUM-BRT-MDT                       15920000
159300                                 TO ASTRTITA                      15930000
159400                 MOVE DP015-RED  TO ASTRTITC                      15940000
159500                 MOVE DP015-REVERSE                               15950000
159600                                 TO ASTRTITH                      15960000
159700                 SET PS-ERROR                                     15970000
159800                     DP020-MSG-FATAL                              15980000
159900                                 TO TRUE                          15990000
160000             END-IF                                               16000000
160100         ELSE                                                     16010000
160200             MOVE PC-TSYMSG-00008                                 16020000
160300                                 TO DP020-MSG-NUMBER              16030000
160400             SET DP030-SET-CURSOR-APPL-1                          16040000
160500                                 TO TRUE                          16050000
160600             MOVE -1             TO ASTRTITL                      16060000
160700             MOVE DP015-UNP-NUM-BRT-MDT                           16070000
160800                                 TO ASTRTITA                      16080000
160900             MOVE DP015-RED      TO ASTRTITC                      16090000
161000             MOVE DP015-REVERSE  TO ASTRTITH                      16100000
161100             SET PS-ERROR                                         16110000
161200                 DP020-MSG-FATAL TO TRUE                          16120000
161300         END-IF                                                   16130000
161400     END-IF.                                                      16140000
161500                                                                  16150000
161600 2140-DESELECT-ALL-ITEMS.                                         16160000
161700                                                                  16170000
161800     MOVE +1                     TO ASC-BLK-SUB.                  16180000
161900                                                                  16190000
162000     PERFORM 2141-CLEAR-SELECTED-INDS                             16200000
162100             VARYING ASC-ITEM-SUB  FROM 1 BY 1                    16210000
162200             UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.           16220000
162300                                                                  16230000
162400     ADD +1                      TO ASC-BLK-SUB.                  16240000
162500                                                                  16250000
162600     PERFORM 2141-CLEAR-SELECTED-INDS                             16260000
162700             VARYING ASC-ITEM-SUB  FROM 1 BY 1                    16270000
162800             UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.           16280000
162900                                                                  16290000
163000     MOVE ASC-LIST-ITEM-NUMBER (1 1)                              16300000
163100                                 TO PV-LIST-ITEM-NUMBER.          16310000
163200                                                                  16320000
163300     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            16330000
163400             1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).16340000
163500                                                                  16350000
163600     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     16360000
163700              (ASC-HIGHEST-BLOCK-WRITTEN > PC-MAX-BLOCKS-IN-ARRAY)16370000
163800         MOVE +1                 TO ASC-BLK-SUB                   16380000
163900                                                                  16390000
164000         PERFORM 5100-WRITE-TEMP-STORAGE                          16400000
164100                                                                  16410000
164200         MOVE +1                 TO PV-BLOCK-NUMBER               16420000
164300                                                                  16430000
164400         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         16440000
164500                                       PV-FIRST-BLOCK-IN-ARRAY - 116450000
164600                                                                  16460000
164700         PERFORM                                                  16470000
164800           UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY         16480000
164900                                                                  16490000
165000                 PERFORM 4410-READ-TEMP-STORAGE                   16500000
165100                                                                  16510000
165200                 PERFORM 2141-CLEAR-SELECTED-INDS                 16520000
165300                         VARYING ASC-ITEM-SUB  FROM 1 BY 1        16530000
165400                         UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL16540000
165500                                                                  16550000
165600                 PERFORM 5100-WRITE-TEMP-STORAGE                  16560000
165700                                                                  16570000
165800                 ADD +1          TO PV-BLOCK-NUMBER               16580000
165900                                                                  16590000
166000         END-PERFORM                                              16600000
166100                                                                  16610000
166200         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         16620000
166300                  PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY16630000
166400                                                                  16640000
166500         PERFORM                                                  16650000
166600           UNTIL PV-NEXT-BLOCK-IN-ARRAY >                         16660000
166700                                         ASC-HIGHEST-BLOCK-WRITTEN16670000
166800                                                                  16680000
166900                 MOVE PV-NEXT-BLOCK-IN-ARRAY                      16690000
167000                                 TO PV-BLOCK-NUMBER               16700000
167100                                                                  16710000
167200                 PERFORM 4410-READ-TEMP-STORAGE                   16720000
167300                                                                  16730000
167400                 PERFORM 2141-CLEAR-SELECTED-INDS                 16740000
167500                         VARYING ASC-ITEM-SUB  FROM 1 BY 1        16750000
167600                         UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL16760000
167700                                                                  16770000
167800                 PERFORM 5100-WRITE-TEMP-STORAGE                  16780000
167900                                                                  16790000
168000                 ADD +1          TO PV-NEXT-BLOCK-IN-ARRAY        16800000
168100                                                                  16810000
168200         END-PERFORM                                              16820000
168300                                                                  16830000
168400         MOVE PV-FIRST-BLOCK-IN-ARRAY                             16840000
168500                                 TO PV-BLOCK-NUMBER               16850000
168600                                                                  16860000
168700         PERFORM 4410-READ-TEMP-STORAGE                           16870000
168800                                                                  16880000
168900     END-IF.                                                      16890000
169000                                                                  16900000
169100     MOVE ZERO                   TO ASC-NUMBER-OF-SELECTED-ITEMS  16910000
169200                                    ASC-START-OF-SELECTED-RANGE   16920000
169300                                    ASC-END-OF-SELECTED-RANGE.    16930000
169400                                                                  16940000
169500     PERFORM 3200-RESET-ATTRIBUTES                                16950041
169600     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        16960000
169700                                                                  16970000
169800 2141-CLEAR-SELECTED-INDS.                                        16980000
169900                                                                  16990000
170000     IF ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB ASC-ITEM-SUB) NOT = ZERO17000000
170100        IF NOT ASC-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)           17010000
170200            SET ASC-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)          17020000
170300                ASC-TEMP-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)     17030000
170400                ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                  17040000
170500                                 TO TRUE.                         17050000
170600                                                                  17060000
170700 2150-SELECT-ALL-ITEMS.                                           17070000
170800                                                                  17080000
170900     MOVE +1                     TO ASC-BLK-SUB.                  17090000
171000                                                                  17100000
171100     PERFORM 2151-SET-SELECTED-INDS                               17110000
171200             VARYING ASC-ITEM-SUB FROM 1 BY 1                     17120000
171300             UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.           17130000
171400                                                                  17140000
171500     ADD +1                      TO ASC-BLK-SUB.                  17150000
171600                                                                  17160000
171700     PERFORM 2151-SET-SELECTED-INDS                               17170000
171800             VARYING ASC-ITEM-SUB FROM 1 BY 1                     17180000
171900             UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.           17190000
172000                                                                  17200000
172100     MOVE ASC-LIST-ITEM-NUMBER (1 1)                              17210000
172200                                 TO PV-LIST-ITEM-NUMBER.          17220000
172300                                                                  17230000
172400     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            17240000
172500             1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).17250000
172600                                                                  17260000
172700     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     17270000
172800              (ASC-HIGHEST-BLOCK-WRITTEN > PC-MAX-BLOCKS-IN-ARRAY)17280000
172900         MOVE +1                 TO ASC-BLK-SUB                   17290000
173000                                                                  17300000
173100         PERFORM 5100-WRITE-TEMP-STORAGE                          17310000
173200                                                                  17320000
173300         MOVE +1                 TO PV-BLOCK-NUMBER               17330000
173400                                                                  17340000
173500         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         17350000
173600                                       PV-FIRST-BLOCK-IN-ARRAY - 117360000
173700                                                                  17370000
173800         PERFORM                                                  17380000
173900           UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY         17390000
174000                                                                  17400000
174100                 PERFORM 4410-READ-TEMP-STORAGE                   17410000
174200                                                                  17420000
174300                 PERFORM 2151-SET-SELECTED-INDS                   17430000
174400                         VARYING ASC-ITEM-SUB  FROM 1 BY 1        17440000
174500                         UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL17450000
174600                                                                  17460000
174700                 PERFORM 5100-WRITE-TEMP-STORAGE                  17470000
174800                                                                  17480000
174900                 ADD +1          TO PV-BLOCK-NUMBER               17490000
175000                                                                  17500000
175100         END-PERFORM                                              17510000
175200                                                                  17520000
175300         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         17530000
175400                  PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY17540000
175500                                                                  17550000
175600         PERFORM                                                  17560000
175700           UNTIL PV-NEXT-BLOCK-IN-ARRAY >                         17570000
175800                                         ASC-HIGHEST-BLOCK-WRITTEN17580000
175900                                                                  17590000
176000                 MOVE PV-NEXT-BLOCK-IN-ARRAY                      17600000
176100                                 TO PV-BLOCK-NUMBER               17610000
176200                                                                  17620000
176300                 PERFORM 4410-READ-TEMP-STORAGE                   17630000
176400                                                                  17640000
176500                 PERFORM 2151-SET-SELECTED-INDS                   17650000
176600                         VARYING ASC-ITEM-SUB  FROM 1 BY 1        17660000
176700                         UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL17670000
176800                                                                  17680000
176900                 PERFORM 5100-WRITE-TEMP-STORAGE                  17690000
177000                                                                  17700000
177100                 ADD +1          TO PV-NEXT-BLOCK-IN-ARRAY        17710000
177200                                                                  17720000
177300         END-PERFORM                                              17730000
177400                                                                  17740000
177500         MOVE PV-FIRST-BLOCK-IN-ARRAY                             17750000
177600                                 TO PV-BLOCK-NUMBER               17760000
177700                                                                  17770000
177800         PERFORM 4410-READ-TEMP-STORAGE                           17780000
177900     END-IF.                                                      17790000
178000                                                                  17800000
178100     MOVE ASC-NUMBER-OF-ITEMS-READ                                17810000
178200                                 TO ASC-NUMBER-OF-SELECTED-ITEMS. 17820000
178300                                                                  17830000
178400     PERFORM 3200-RESET-ATTRIBUTES                                17840041
178500     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        17850000
178600                                                                  17860000
178700 2151-SET-SELECTED-INDS.                                          17870000
178800                                                                  17880000
178900     IF ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB ASC-ITEM-SUB) NOT = ZERO17890000
179000        IF NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)              17900000
179100            SET ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)             17910000
179200                ASC-TEMP-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)        17920000
179300                ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                  17930000
179400                                 TO TRUE                          17940000
179500        END-IF                                                    17950000
179600        IF   DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)               17960000
179700             MOVE  ZEROES TO ASC-STR-QTY                          17970000
179800                             (ASC-BLK-SUB ASC-ITEM-SUB)           17980000
179900             SET  ASC-SEL-ZERO-YES (ASC-BLK-SUB ASC-ITEM-SUB)     17990000
180000                          TO  TRUE                                18000000
180100        END-IF                                                    18010000
180200     END-IF.                                                      18020000
180300                                                                  18030000
180400 2200-MOVE-SCREEN-TO-COMMAREA.                                    18040000
180500                                                                  18050000
180600     MOVE PV-TOP-ITEM            TO PV-ITEM-IN-USE.               18060000
180700     MOVE +1                     TO PV-SUB.                       18070000
180800                                                                  18080000
180900     PERFORM 3100-SET-SUBSCRIPTS.                                 18090000
181000                                                                  18100000
181100     IF ASTRTITL > ZERO                                           18110000
181200         MOVE ASTRTITI           TO ASC-START-ITEM-REQUEST        18120000
181300     ELSE                                                         18130000
181400         IF ASTRTITF = DP015-ERASE-EOF                            18140000
181500             INITIALIZE ASC-START-ITEM-REQUEST                    18150000
181600         END-IF                                                   18160000
181700     END-IF.                                                      18170000
181800                                                                  18180000
181900     PERFORM 2210-MOVE-LINES-TO-COMMAREA                          18190000
182000             VARYING PV-SUB  FROM 1 BY 1                          18200000
182100             UNTIL   PV-SUB > ASC-ITEMS-DISPLAYED.                18210000
182200                                                                  18220000
182300 2210-MOVE-LINES-TO-COMMAREA.                                     18230000
182400                                                                  18240000
182500     IF MR-SELECTL (PV-SUB) > ZERO                                18250000
182600         SET ASC-BLOCK-MODIFIED    (ASC-BLK-SUB)                  18260000
182700                                 TO TRUE                          18270000
182800         MOVE MR-SELECTI (PV-SUB)                                 18280000
182900                                 TO ASC-TEMP-SELECTED-SW          18290000
183000                                   (ASC-BLK-SUB ASC-ITEM-SUB)     18300000
183100     ELSE                                                         18310000
183200         IF MR-SELECTA (PV-SUB) = DP015-ERASE-EOF                 18320000
183300             SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                 18330000
183400                                 TO TRUE                          18340000
183500             MOVE SPACE          TO ASC-TEMP-SELECTED-SW          18350000
183600                                   (ASC-BLK-SUB ASC-ITEM-SUB)     18360000
183700         END-IF                                                   18370000
183800     END-IF.                                                      18380000
183900                                                                  18390000
184000     IF MR-STR-QTY-L (PV-SUB) > ZERO                              18400000
184100         MOVE MR-STR-QTY (PV-SUB)                                 18410000
184200                                 TO ASC-STR-QTY                   18420000
184300                                   (ASC-BLK-SUB ASC-ITEM-SUB)     18430000
184400     ELSE                                                         18440000
184500         IF MR-STR-QTY-A (PV-SUB) = DP015-ERASE-EOF               18450000
184600             MOVE SPACES         TO ASC-STR-QTY                   18460000
184700                                   (ASC-BLK-SUB ASC-ITEM-SUB)     18470000
184800         END-IF                                                   18480000
184900     END-IF.                                                      18490000
185000                                                                  18500000
185100     ADD +1                      TO ASC-ITEM-SUB.                 18510000
185200                                                                  18520000
185300     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         18530000
185400         ADD  +1                 TO ASC-BLK-SUB                   18540000
185500         MOVE +1                 TO ASC-ITEM-SUB                  18550000
185600     END-IF.                                                      18560000
185700                                                                  18570000
185800******************************************************************18580000
185900* GET THE KEYS OF THE NEXT SELECTED OBJECT FROM THE              *18590000
186000* INPUT SELECTED-ITEMS TEMP STORAGE QUEUE.                       *18600000
186100******************************************************************18610000
186200 2300-GET-NEXT-RECORD.                                            18620000
186300                                                                  18630000
186400     ADD +1                      TO ASC-SEL-SUB.                  18640000
186500                                                                  18650000
186600     IF ASC-SEL-SUB > RC013-MAX-ITEMS                             18660000
186700         ADD +1                  TO ASC-SEL-ITEM                  18670000
186800         MOVE +1                 TO ASC-SEL-SUB                   18680000
186900     END-IF.                                                      18690000
187000                                                                  18700000
187100     IF ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                 18710000
187200         PERFORM 9100-READ-SEL-QUEUE                              18720000
187300         IF RC013-ITEM (ASC-SEL-SUB) > ZERO                       18730000
187400             MOVE RC013-PKSL-LNE-NBR (ASC-SEL-SUB)                18740000
187500                                 TO ASC-KEY-PKSL-LNE-NBR          18750000
187600             EVALUATE RC013-CSR-IND (ASC-SEL-SUB)                 18760038
187700                WHEN '1'                                          18770000
187800                   MOVE PC-MANUAL    TO ASC-KEY-VFY-SRC           18780000
187900                WHEN '2'                                          18790000
188000                   MOVE PC-P2L       TO ASC-KEY-VFY-SRC           18800000
188100                WHEN '3'                                          18810000
188200                   MOVE PC-CASE      TO ASC-KEY-VFY-SRC           18820000
188300                WHEN '4'                                          18830000
188400                   MOVE PC-P2LCASE   TO ASC-KEY-VFY-SRC           18840000
188500                WHEN OTHER                                        18850000
188600                   MOVE SPACES       TO ASC-KEY-VFY-SRC           18860000
188700             END-EVALUATE                                         18870000
188800             MOVE RC013-CSR-IND (ASC-SEL-SUB)                     18880038
188900               TO ASC-CSR-IND                                     18890038
189000             SET RC013-INQ (ASC-SEL-SUB)                          18900000
189100                                 TO TRUE                          18910000
189200             PERFORM 9200-REWRITE-LIST-QUEUE                      18920000
189300         ELSE                                                     18930000
189400             SUBTRACT +1 FROM ASC-SEL-SUB                         18940000
189500*            --- BOTTOM OF LIST ---                               18950000
189600             MOVE PC-TSYMSG-00070                                 18960000
189700                                 TO DP020-MSG-NUMBER              18970000
189800             SET DP020-MSG-INFORMATIONAL                          18980000
189900                                 TO TRUE                          18990000
190000         END-IF                                                   19000000
190100     ELSE                                                         19010000
190200         SUBTRACT +1 FROM ASC-SEL-ITEM                            19020000
190300         MOVE RC013-MAX-ITEMS    TO ASC-SEL-SUB                   19030000
190400         MOVE PC-TSYMSG-00070    TO DP020-MSG-NUMBER              19040000
190500         SET DP020-MSG-INFORMATIONAL                              19050000
190600                                 TO TRUE                          19060000
190700     END-IF.                                                      19070000
190800                                                                  19080000
190900/                                                                 19090000
191000******************************************************************19100000
191100* GET THE KEYS OF THE PREVIOUS SELECTED OBJECT FROM THE          *19110000
191200* INPUT SELECTED-ITEMS TEMP STORAGE QUEUE.                       *19120000
191300******************************************************************19130000
191400 2310-GET-PREV-RECORD.                                            19140000
191500                                                                  19150000
191600     SUBTRACT +1 FROM ASC-SEL-SUB.                                19160000
191700                                                                  19170000
191800     IF ASC-SEL-SUB < +1                                          19180000
191900         SUBTRACT +1 FROM ASC-SEL-ITEM                            19190000
192000         MOVE RC013-MAX-ITEMS    TO ASC-SEL-SUB                   19200000
192100     END-IF.                                                      19210000
192200                                                                  19220000
192300     IF ASC-SEL-ITEM > ZERO                                       19230000
192400         PERFORM 9100-READ-SEL-QUEUE                              19240000
192500         MOVE RC013-PKSL-LNE-NBR (ASC-SEL-SUB)                    19250000
192600                                 TO ASC-KEY-PKSL-LNE-NBR          19260000
192700         EVALUATE RC013-CSR-IND (ASC-SEL-SUB)                     19270000
192800            WHEN '1'                                              19280000
192900               MOVE PC-MANUAL    TO ASC-KEY-VFY-SRC               19290000
193000            WHEN '2'                                              19300000
193100               MOVE PC-P2L       TO ASC-KEY-VFY-SRC               19310000
193200            WHEN '3'                                              19320000
193300               MOVE PC-CASE      TO ASC-KEY-VFY-SRC               19330000
193400            WHEN '4'                                              19340000
193500               MOVE PC-P2LCASE   TO ASC-KEY-VFY-SRC               19350000
193600            WHEN OTHER                                            19360000
193700               MOVE SPACES       TO ASC-KEY-VFY-SRC               19370000
193800         END-EVALUATE                                             19380000
193900         MOVE RC013-CSR-IND (ASC-SEL-SUB)                         19390038
194000           TO ASC-CSR-IND                                         19400038
194100     ELSE                                                         19410000
194200         MOVE +1                 TO ASC-SEL-ITEM                  19420000
194300                                    ASC-SEL-SUB                   19430000
194400*        --- TOP OF LIST ---                                      19440000
194500         MOVE PC-TSYMSG-00069    TO DP020-MSG-NUMBER              19450000
194600         SET DP020-MSG-INFORMATIONAL                              19460000
194700                                 TO TRUE                          19470000
194800     END-IF.                                                      19480000
194900/                                                                 19490000
195000 3000-EDIT-DATA-IN-COMMAREA.                                      19500000
195100                                                                  19510000
195200     SET PS-NO-ERROR             TO TRUE.                         19520000
195300                                                                  19530000
195400     MOVE ASC-ITEMS-DISPLAYED    TO PV-SUB.                       19540000
195500     COMPUTE PV-ITEM-IN-USE = PV-TOP-ITEM +                       19550000
195600                                          ASC-ITEMS-DISPLAYED - 1.19560000
195700     PERFORM 3100-SET-SUBSCRIPTS.                                 19570000
195800                                                                  19580000
195900     SET PS-NO-SMOOTHED-STORE     TO TRUE.                        19590000
196000     PERFORM 3300-EDIT-SELECTIONS                                 19600000
196100             VARYING PV-SUB  FROM PV-SUB BY -1                    19610000
196200             UNTIL   PV-SUB < +1.                                 19620000
196300                                                                  19630000
196400     IF PS-NO-ERROR                                               19640000
196500         PERFORM 3400-CHECK-RANGE-SEQUENCE                        19650000
196600     END-IF.                                                      19660000
196700                                                                  19670000
196800     IF PS-NO-ERROR AND                                           19680000
196900        ASC-START-OF-SELECTED-RANGE > ZERO AND                    19690000
197000        ASC-END-OF-SELECTED-RANGE > ZERO                          19700000
197100                                                                  19710000
197200         PERFORM 3500-MARK-RANGE-AS-SELECTED                      19720000
197300     END-IF.                                                      19730000
197400                                                                  19740000
197500                                                                  19750000
197600 3100-SET-SUBSCRIPTS.                                             19760000
197700                                                                  19770000
197800     COMPUTE ASC-ITEM-SUB =                                       19780000
197900                (PV-ITEM-IN-USE - ASC-LIST-ITEM-NUMBER (1 1)) + 1.19790000
198000                                                                  19800000
198100     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         19810000
198200         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            19820000
198300         MOVE PC-MAX-BLOCKS-IN-ARRAY                              19830000
198400                                 TO ASC-BLK-SUB                   19840000
198500     ELSE                                                         19850000
198600         MOVE +1                 TO ASC-BLK-SUB                   19860000
198700     END-IF.                                                      19870000
198800                                                                  19880000
198900 3200-RESET-ATTRIBUTES.                                           19890000
199000                                                                  19900000
199100     MOVE DP015-UNP-ALP-NOR-OFF  TO ASTRTITA.                     19910000
199200     MOVE DP015-GREEN            TO ASTRTITC.                     19920000
199300     MOVE DP015-UNDERLINE        TO ASTRTITH.                     19930000
199400                                                                  19940000
199500     PERFORM VARYING PV-SUB  FROM 1 BY 1                          19950000
199600        UNTIL   PV-SUB > PC-ITEMS-PER-PANEL                       19960042
199700        IF ASC-GO-YELLOW                                          19970000
199800             MOVE DP015-YELLOW       TO MR-SOURCE-C (PV-SUB)      19980000
199900        ELSE                                                      19990000
200000             MOVE DP015-BLUE         TO MR-SOURCE-C (PV-SUB)      20000000
200100        END-IF                                                    20010000
200200     END-PERFORM.                                                 20020000
200300                                                                  20030000
200400     IF  ASC-TRBL-EXISTS                                          20040000
200500         MOVE DP015-YELLOW       TO ARCVRC                        20050000
200600     END-IF.                                                      20060000
200700                                                                  20070000
200800     IF  ASC-AUTO-VE-YES                                          20080019
200900         SET DP030-SET-CURSOR-APPL-1                              20090019
201000                                 TO TRUE                          20100019
201100         MOVE -1                 TO ASTRTITL                      20110019
201200         PERFORM VARYING PV-SUB  FROM 1 BY 1                      20120019
201300                 UNTIL   PV-SUB > PC-ITEMS-PER-PANEL              20130019
201400                 MOVE DP015-ASK-NOR-OFF                           20140019
201500                                 TO MR-STR-QTY-A (PV-SUB)         20150019
201600                 MOVE DP015-BLUE                                  20160019
201700                                 TO MR-STR-QTY-C (PV-SUB)         20170019
201800                 MOVE DP015-HL-OFF                                20180019
201900                                 TO MR-STR-QTY-H (PV-SUB)         20190019
202000         END-PERFORM                                              20200019
202100     END-IF.                                                      20210019
202200                                                                  20220019
202300     IF  ASC-CANT-UPDATE                                          20230019
202400         SET DP030-SET-CURSOR-APPL-1                              20240000
202500                                 TO TRUE                          20250000
202600         MOVE -1                 TO ASTRTITL                      20260000
202700         PERFORM VARYING PV-SUB  FROM 1 BY 1                      20270000
202800                 UNTIL   PV-SUB > PC-ITEMS-PER-PANEL              20280000
202900                 MOVE DP015-ASK-NOR-OFF                           20290000
203000                                 TO MR-SELECTA   (PV-SUB)         20300000
203100                                    MR-STR-QTY-A (PV-SUB)         20310000
203200                 MOVE DP015-BLUE                                  20320000
203300                                 TO MR-SELECTC   (PV-SUB)         20330000
203400                                    MR-STR-QTY-C (PV-SUB)         20340000
203500                 MOVE DP015-HL-OFF                                20350000
203600                                 TO MR-SELECTH   (PV-SUB)         20360000
203700                                    MR-STR-QTY-H (PV-SUB)         20370000
203800         END-PERFORM                                              20380000
203900     ELSE                                                         20390000
204000          IF ASC-OVERAGE                                          20400000
204100             PERFORM VARYING PV-SUB  FROM 1 BY 1                  20410000
204200                 UNTIL   PV-SUB > ASC-ITEMS-DISPLAYED             20420000
204300                 IF MR-STR-QTY-C (PV-SUB) = DP015-YELLOW          20430000
204400                     MOVE DP015-PRO-NOR-OFF                       20440000
204500                                     TO MR-SELECTA   (PV-SUB)     20450000
204600                     MOVE DP015-PRO-NOR-OFF                       20460000
204700                                     TO MR-STR-QTY-A (PV-SUB)     20470000
204800                     IF MR-STR-NBR (PV-SUB) > SPACES              20480000
204900                         MOVE DP015-UNDERLINE                     20490000
205000                                         TO MR-SELECTH   (PV-SUB) 20500000
205100                                            MR-STR-QTY-H (PV-SUB) 20510000
205200                     END-IF                                       20520000
205300                     MOVE DP015-BLUE                              20530000
205400                                 TO MR-SELECTC   (PV-SUB)         20540000
205500                 ELSE                                             20550000
205600                     MOVE DP015-PRO-NOR-OFF                       20560000
205700                                     TO MR-SELECTA   (PV-SUB)     20570000
205800                     MOVE DP015-PRO-NOR-OFF                       20580000
205900                                     TO MR-STR-QTY-A (PV-SUB)     20590000
206000                     IF MR-STR-QTY-C (PV-SUB) =                   20600000
206100                                       DP015-GREEN                20610000
206200                         MOVE DP015-BLUE                          20620000
206300                                     TO MR-STR-QTY-C (PV-SUB)     20630000
206400                     ELSE                                         20640000
206500                         CONTINUE                                 20650000
206600                     END-IF                                       20660000
206700                     MOVE DP015-BLUE                              20670000
206800                                     TO MR-SELECTC   (PV-SUB)     20680000
206900                     IF MR-STR-NBR (PV-SUB) > SPACES              20690000
207000                         MOVE DP015-UNDERLINE                     20700000
207100                                         TO MR-SELECTH   (PV-SUB) 20710000
207200                                            MR-STR-QTY-H (PV-SUB) 20720000
207300                     END-IF                                       20730000
207400                 END-IF                                           20740000
207500             END-PERFORM                                          20750000
207600         ELSE                                                     20760000
207700             PERFORM VARYING PV-SUB  FROM 1 BY 1                  20770000
207800                 UNTIL   PV-SUB > ASC-ITEMS-DISPLAYED             20780000
207900                 MOVE DP015-UNP-ALP-NOR-OFF                       20790000
208000                                 TO MR-SELECTA   (PV-SUB)         20800000
208100                 MOVE DP015-UNP-NUM-NOR-OFF                       20810000
208200                                 TO MR-STR-QTY-A (PV-SUB)         20820000
208300                 MOVE DP015-GREEN                                 20830000
208400                                 TO MR-SELECTC   (PV-SUB)         20840000
208500                                    MR-STR-QTY-C (PV-SUB)         20850000
208600                 MOVE DP015-BLUE                                  20860000
208700                                 TO MR-STR-NBR-C (PV-SUB)         20870000
208800***              IF MR-STR-NBR (PV-SUB) > SPACES                  20880023
208900                     MOVE DP015-UNDERLINE                         20890000
209000                                 TO MR-SELECTH   (PV-SUB)         20900000
209100                                    MR-STR-QTY-H (PV-SUB)         20910000
209200***              END-IF                                           20920023
209300             END-PERFORM                                          20930000
209400         END-IF                                                   20940000
209500      END-IF.                                                     20950000
209600                                                                  20960000
209700 3300-EDIT-SELECTIONS.                                            20970000
209800                                                                  20980000
209900     EVALUATE TRUE                                                20990000
210000         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) =   21000000
210100                   ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     21010000
210200              IF ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)       21020000
210300                 NOT = SPACES                                     21030000
210400                 IF DP020-FK-LOCAL-FUNC-01(DP020-SRC-AID)         21040000
210500                 OR DP020-FK-LOCAL-FUNC-02(DP020-SRC-AID)         21050000
210600                     IF ASC-SOURCE (ASC-BLK-SUB ASC-ITEM-SUB)     21060000
210700                         NOT = PC-MANUAL                          21070000
210800                             SET ASC-CONFIRM-UPDATE TO TRUE       21080000
210900                     END-IF                                       21090000
211000                 END-IF                                           21100000
211100                 IF DP020-FK-LOCAL-FUNC-02(DP020-SRC-AID)         21110000
211200                     PERFORM 7090-COUNT-SMOOTHED-CTNS             21120000
211300                     IF PV-DB2-COUNT > 0                          21130000
211400                         SET PS-SMOOTHED-STORE  TO TRUE           21140000
211500                         SET PS-ERROR           TO TRUE           21150000
211600                         MOVE PC-TSYMSG-02773                     21160000
211700                                 TO DP020-MSG-NUMBER              21170000
211800                         SET PS-ERROR                             21180000
211900                             DP020-MSG-FATAL                      21190000
212000                             DP030-SET-CURSOR-APPL-1              21200000
212100                                            TO TRUE               21210000
212200                         MOVE -1            TO MR-SELECTL (PV-SUB)21220000
212300                         MOVE DP015-RED     TO MR-SELECTC (PV-SUB)21230000
212400                         MOVE DP015-REVERSE TO MR-SELECTH (PV-SUB)21240000
212500                     END-IF                                       21250000
212600                 END-IF                                           21260000
212700                 IF (DP020-FK-LOCAL-FUNC-02(DP020-SRC-AID) OR     21270004
212800                    DP020-FK-LOCAL-FUNC-03(DP020-SRC-AID)) AND    21280004
212900                       ASC-AUTO-VE-YES                            21290006
213000                        IF  ASC-PBS-YES  AND                      21300033
213100                            ASC-PBS-UPDATE-YES                    21310033
213200                                (ASC-BLK-SUB ASC-ITEM-SUB)        21320033
213300                            CONTINUE                              21330033
213400                        ELSE                                      21340033
213500                            SET PS-ERROR           TO TRUE        21350033
213600                            MOVE PC-TSYMSG-03180                  21360033
213700                                TO DP020-MSG-NUMBER               21370033
213800                            SET PS-ERROR                          21380033
213900                            DP020-MSG-FATAL                       21390033
214000                            DP030-SET-CURSOR-APPL-1               21400033
214100                                            TO TRUE               21410033
214200                        MOVE -1            TO MR-SELECTL (PV-SUB) 21420033
214300                        MOVE DP015-RED     TO MR-SELECTC (PV-SUB) 21430033
214400                        MOVE DP015-REVERSE TO MR-SELECTH (PV-SUB) 21440033
214500                        END-IF                                    21450033
214600                 END-IF                                           21460033
214700              END-IF                                              21470033
214800              CONTINUE                                            21480000
214900         WHEN ASC-TEMP-SELECT   (ASC-BLK-SUB ASC-ITEM-SUB)        21490000
215000              IF NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)        21500000
215100                  ADD +1         TO ASC-NUMBER-OF-SELECTED-ITEMS  21510000
215200                  MOVE ASC-TEMP-SELECTED-SW                       21520000
215300                                        (ASC-BLK-SUB ASC-ITEM-SUB)21530000
215400                                 TO ASC-SELECTED-SW               21540000
215500                                        (ASC-BLK-SUB ASC-ITEM-SUB)21550000
215600                 IF DP020-FK-LOCAL-FUNC-01(DP020-SRC-AID)         21560000
215700                 OR DP020-FK-LOCAL-FUNC-02(DP020-SRC-AID)         21570000
215800                     IF ASC-SOURCE (ASC-BLK-SUB ASC-ITEM-SUB)     21580000
215900                         NOT = PC-MANUAL                          21590000
216000                             SET ASC-CONFIRM-UPDATE TO TRUE       21600000
216100                     END-IF                                       21610000
216200                 END-IF                                           21620000
216300                 IF DP020-FK-LOCAL-FUNC-02(DP020-SRC-AID)         21630000
216400                     PERFORM 7090-COUNT-SMOOTHED-CTNS             21640000
216500                     IF PV-DB2-COUNT > 0                          21650000
216600                         SET PS-SMOOTHED-STORE  TO TRUE           21660000
216700                         SET PS-ERROR           TO TRUE           21670000
216800                         MOVE PC-TSYMSG-02773                     21680000
216900                                 TO DP020-MSG-NUMBER              21690000
217000                         SET PS-ERROR                             21700000
217100                             DP020-MSG-FATAL                      21710000
217200                             DP030-SET-CURSOR-APPL-1              21720000
217300                                            TO TRUE               21730000
217400                         MOVE -1            TO MR-SELECTL (PV-SUB)21740000
217500                         MOVE DP015-RED     TO MR-SELECTC (PV-SUB)21750000
217600                         MOVE DP015-REVERSE TO MR-SELECTH (PV-SUB)21760000
217700                     END-IF                                       21770000
217800                 END-IF                                           21780000
217900                 IF (DP020-FK-LOCAL-FUNC-02(DP020-SRC-AID) OR     21790004
218000                    DP020-FK-LOCAL-FUNC-03(DP020-SRC-AID)) AND    21800004
218100                       ASC-AUTO-VE-YES                            21810006
218200                        IF  ASC-PBS-YES  AND                      21820033
218300                            ASC-PBS-UPDATE-YES                    21830033
218400                                (ASC-BLK-SUB ASC-ITEM-SUB)        21840033
218500                            CONTINUE                              21850033
218600                        ELSE                                      21860033
218700                            SET PS-ERROR           TO TRUE        21870033
218800                            MOVE PC-TSYMSG-03180                  21880033
218900                                TO DP020-MSG-NUMBER               21890004
219000                            SET PS-ERROR                          21900033
219100                                DP020-MSG-FATAL                   21910033
219200                                DP030-SET-CURSOR-APPL-1           21920033
219300                                            TO TRUE               21930004
219400                        MOVE -1            TO MR-SELECTL (PV-SUB) 21940004
219500                        MOVE DP015-RED     TO MR-SELECTC (PV-SUB) 21950004
219600                        MOVE DP015-REVERSE TO MR-SELECTH (PV-SUB) 21960004
219700                        END-IF                                    21970033
219800                 END-IF                                           21980004
219900              END-IF                                              21990000
220000                                                                  22000000
220100         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) =   22010000
220200                                                             SPACE22020000
220300              EVALUATE TRUE                                       22030000
220400                  WHEN ASC-SELECT  (ASC-BLK-SUB ASC-ITEM-SUB)     22040000
220500                     SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS22050000
220600                     MOVE SPACE  TO ASC-SELECTED-SW               22060000
220700                                   (ASC-BLK-SUB ASC-ITEM-SUB)     22070000
220800                                                                  22080000
220900                  WHEN ASC-BEGIN   (ASC-BLK-SUB ASC-ITEM-SUB)     22090000
221000                       MOVE ZERO TO ASC-START-OF-SELECTED-RANGE   22100000
221100                       MOVE SPACE                                 22110000
221200                                 TO ASC-SELECTED-SW               22120000
221300                                   (ASC-BLK-SUB ASC-ITEM-SUB)     22130000
221400                                                                  22140000
221500                  WHEN ASC-END     (ASC-BLK-SUB ASC-ITEM-SUB)     22150000
221600                       MOVE ZERO TO ASC-END-OF-SELECTED-RANGE     22160000
221700                       MOVE SPACE                                 22170000
221800                                 TO ASC-SELECTED-SW               22180000
221900                                   (ASC-BLK-SUB ASC-ITEM-SUB)     22190000
222000             END-EVALUATE                                         22200000
222100                                                                  22210000
222200         WHEN ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)           22220000
222300              SET ASC-RANGE-OFF TO TRUE                           22230000
222400              IF ASC-SELECT  (ASC-BLK-SUB ASC-ITEM-SUB)           22240000
222500                  SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS   22250000
222600              END-IF                                              22260000
222700              IF DP020-FK-LOCAL-FUNC-01(DP020-SRC-AID)            22270000
222800                 OR DP020-FK-LOCAL-FUNC-02(DP020-SRC-AID)         22280000
222900                  IF ASC-SOURCE (ASC-BLK-SUB ASC-ITEM-SUB)        22290000
223000                     NOT = PC-MANUAL                              22300000
223100                     SET ASC-CONFIRM-UPDATE TO TRUE               22310000
223200                  END-IF                                          22320000
223300              END-IF                                              22330000
223400                                                                  22340000
223500              PERFORM 3310-EDIT-RANGE                             22350000
223600                                                                  22360000
223700         WHEN ASC-TEMP-END  (ASC-BLK-SUB ASC-ITEM-SUB)            22370000
223800              SET ASC-RANGE-ON TO TRUE                            22380000
223900              IF ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            22390000
224000                  SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS   22400000
224100              END-IF                                              22410000
224200              IF DP020-FK-LOCAL-FUNC-01(DP020-SRC-AID)            22420000
224300                 OR DP020-FK-LOCAL-FUNC-02(DP020-SRC-AID)         22430000
224400                  IF ASC-SOURCE (ASC-BLK-SUB ASC-ITEM-SUB)        22440000
224500                     NOT = PC-MANUAL                              22450000
224600                     SET ASC-CONFIRM-UPDATE TO TRUE               22460000
224700                  END-IF                                          22470000
224800              END-IF                                              22480000
224900                                                                  22490000
225000              PERFORM 3310-EDIT-RANGE                             22500000
225100                                                                  22510000
225200         WHEN OTHER                                               22520000
225300              MOVE PC-TSYMSG-00005                                22530000
225400                                 TO DP020-MSG-NUMBER              22540000
225500              SET PS-ERROR                                        22550000
225600                  DP020-MSG-FATAL                                 22560000
225700                  DP030-SET-CURSOR-APPL-1                         22570000
225800                                 TO TRUE                          22580000
225900              MOVE -1            TO MR-SELECTL (PV-SUB)           22590000
226000              MOVE DP015-RED     TO MR-SELECTC (PV-SUB)           22600000
226100              MOVE DP015-REVERSE TO MR-SELECTH (PV-SUB)           22610000
226200              IF ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            22620000
226300                  SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    22630000
226400                  MOVE SPACE     TO ASC-SELECTED-SW               22640000
226500                                   (ASC-BLK-SUB ASC-ITEM-SUB)     22650000
226600              END-IF                                              22660000
226700     END-EVALUATE.                                                22670000
226800                                                                  22680000
226900* EDIT UPDATE QTYS AND APPLY THEM TO STORE QTYS AND TOTALS        22690000
227000                                                                  22700000
227100     IF ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)                     22710000
227200        OR ASC-RANGE-ON                                           22720000
227300        OR ASC-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)                   22730000
227400         IF ASC-STR-QTY (ASC-BLK-SUB ASC-ITEM-SUB) > SPACES       22740000
227500             MOVE ASC-STR-QTY      (ASC-BLK-SUB ASC-ITEM-SUB)     22750000
227600                                 TO DP010I-UNEDITED-FIELD         22760000
227700             MOVE LENGTH OF ASC-STR-QTY                           22770000
227800                                   (ASC-BLK-SUB ASC-ITEM-SUB)     22780000
227900                                 TO DP010I-MAXIMUM-DIGITS         22790000
228000             MOVE ZERO           TO DP010I-MAXIMUM-DECIMALS       22800000
228100             SET DP010I-NEGATIVE-NOT-ALLOWED                      22810000
228200                                 TO TRUE                          22820000
228310             CALL DP010I-NUMERIC-EDIT-ROUTINE                     22831062
228320                  USING DP010I-NUMERIC-EDIT-AREA                  22832062
228400                                                                  22840000
228500             IF  DP010I-ERROR-DETECTED                            22850000
228600                 SET PS-ERROR                                     22860000
228700                     DP020-MSG-FATAL                              22870000
228800                     DP030-SET-CURSOR-APPL-1                      22880000
228900                                 TO TRUE                          22890000
229000                 MOVE PC-TSYMSG-00005                             22900000
229100                                 TO DP020-MSG-NUMBER              22910000
229200                 MOVE DP015-UNP-NUM-BRT-OFF                       22920000
229300                                 TO MR-STR-QTY-A (PV-SUB)         22930000
229400                 MOVE -1         TO MR-STR-QTY-L (PV-SUB)         22940000
229500                 MOVE DP015-RED  TO MR-STR-QTY-C (PV-SUB)         22950000
229600                 MOVE DP015-REVERSE                               22960000
229700                                 TO MR-STR-QTY-H (PV-SUB)         22970000
229800                 SET DP030-SET-CURSOR-APPL-1                      22980000
229900                                 TO TRUE                          22990000
230000                 SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS     23000000
230100             ELSE                                                 23010000
230200                 MOVE DP010I-NUMERIC-FIELD                        23020000
230300                                 TO ASC-STR-QTY-N                 23030000
230400                                    (ASC-BLK-SUB ASC-ITEM-SUB)    23040000
230500                 MOVE ASC-STR-QTY-N (ASC-BLK-SUB ASC-ITEM-SUB)    23050000
230600                                 TO MR-STR-QTY (PV-SUB)           23060000
230700                 MOVE ASC-STR-QTY-N                               23070000
230800                                    (ASC-BLK-SUB ASC-ITEM-SUB)    23080000
230900                         TO ASC-STR-QTY-PREV                      23090000
231000                                    (ASC-BLK-SUB ASC-ITEM-SUB)    23100000
231100             END-IF                                               23110000
231200         ELSE                                                     23120000
231300             MOVE ASC-EXPTED-ITM-QTY-N(ASC-BLK-SUB ASC-ITEM-SUB)  23130000
231400                                 TO ASC-STR-QTY-N                 23140000
231500                                    (ASC-BLK-SUB ASC-ITEM-SUB)    23150000
231600                                    MR-STR-QTY (PV-SUB)           23160000
231700         END-IF                                                   23170000
231800     END-IF.                                                      23180000
231900                                                                  23190000
232000     SUBTRACT +1 FROM PV-ITEM-IN-USE                              23200000
232100                      ASC-ITEM-SUB.                               23210000
232200                                                                  23220000
232300     IF ASC-ITEM-SUB < 1                                          23230000
232400         SUBTRACT +1 FROM ASC-BLK-SUB                             23240000
232500         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  23250000
232600     END-IF.                                                      23260000
232700                                                                  23270000
232800 3310-EDIT-RANGE.                                                 23280000
232900                                                                  23290000
233000     IF ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)                 23300000
233100        IF ASC-START-OF-SELECTED-RANGE = ZERO                     23310000
233200            MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)  23320000
233300                   TO ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)  23330000
233400            MOVE PV-ITEM-IN-USE  TO ASC-START-OF-SELECTED-RANGE   23340000
233500        ELSE                                                      23350000
233600            IF ASC-START-OF-SELECTED-RANGE = PV-ITEM-IN-USE       23360000
233700                CONTINUE                                          23370000
233800            ELSE                                                  23380000
233900                MOVE PC-TSYMSG-00054                              23390000
234000                                 TO DP020-MSG-NUMBER              23400000
234100                SET DP020-MSG-FATAL                               23410000
234200                    PS-ERROR                                      23420000
234300                    DP030-SET-CURSOR-APPL-1                       23430000
234400                                 TO TRUE                          23440000
234500                MOVE -1          TO MR-SELECTL (PV-SUB)           23450000
234600                MOVE DP015-RED   TO MR-SELECTC (PV-SUB)           23460000
234700                MOVE DP015-UNDERLINE                              23470000
234800                                 TO MR-SELECTH (PV-SUB)           23480000
234900            END-IF                                                23490000
235000        END-IF                                                    23500000
235100     ELSE                                                         23510000
235200         IF ASC-END-OF-SELECTED-RANGE = ZERO                      23520000
235300             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 23530000
235400                    TO ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 23540000
235500             MOVE PV-ITEM-IN-USE TO ASC-END-OF-SELECTED-RANGE     23550000
235600         ELSE                                                     23560000
235700             IF ASC-END-OF-SELECTED-RANGE = PV-ITEM-IN-USE        23570000
235800                 CONTINUE                                         23580000
235900             ELSE                                                 23590000
236000                MOVE PC-TSYMSG-00055                              23600000
236100                                 TO DP020-MSG-NUMBER              23610000
236200                SET DP020-MSG-FATAL                               23620000
236300                    PS-ERROR                                      23630000
236400                    DP030-SET-CURSOR-APPL-1                       23640000
236500                                 TO TRUE                          23650000
236600                MOVE -1          TO MR-SELECTL (PV-SUB)           23660000
236700             END-IF                                               23670000
236800         END-IF                                                   23680000
236900     END-IF.                                                      23690000
237000                                                                  23700000
237100 3400-CHECK-RANGE-SEQUENCE.                                       23710000
237200                                                                  23720000
237300     IF ASC-START-OF-SELECTED-RANGE > ZERO AND                    23730000
237400        ASC-END-OF-SELECTED-RANGE   > ZERO AND                    23740000
237500        ASC-START-OF-SELECTED-RANGE > ASC-END-OF-SELECTED-RANGE   23750000
237600         MOVE PC-TSYMSG-00052    TO DP020-MSG-NUMBER              23760000
237700         SET PS-ERROR                                             23770000
237800             DP020-MSG-FATAL     TO TRUE                          23780000
237900                                                                  23790000
238000         PERFORM 3410-POSITION-AT-ERROR                           23800000
238100     END-IF.                                                      23810000
238200                                                                  23820000
238300 3410-POSITION-AT-ERROR.                                          23830000
238400                                                                  23840000
238500     SET DP030-SET-CURSOR-APPL-1 TO TRUE.                         23850000
238600     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE -               23860000
238700                                                  PV-TOP-ITEM + 1.23870000
238800     IF PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                       23880000
238900         CONTINUE                                                 23890000
239000     ELSE                                                         23900000
239100         MOVE -1                 TO MR-SELECTL (PV-SUB)           23910000
239200         MOVE DP015-RED          TO MR-SELECTC (PV-SUB)           23920000
239300         MOVE DP015-REVERSE      TO MR-SELECTH (PV-SUB)           23930000
239400     END-IF.                                                      23940000
239500                                                                  23950000
239600     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE - PV-TOP-ITEM + 1.23960000
239700     IF PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                       23970000
239800         CONTINUE                                                 23980000
239900     ELSE                                                         23990000
240000         MOVE -1                 TO MR-SELECTL (PV-SUB)           24000000
240100         MOVE DP015-RED          TO MR-SELECTC (PV-SUB)           24010000
240200         MOVE DP015-REVERSE      TO MR-SELECTH (PV-SUB)           24020000
240300     END-IF.                                                      24030000
240400                                                                  24040000
240500 3500-MARK-RANGE-AS-SELECTED.                                     24050000
240600                                                                  24060000
240700     MOVE +1                     TO ASC-BLK-SUB.                  24070000
240800                                                                  24080000
240900     PERFORM 3510-MARK-SELECTED-INDS                              24090000
241000             VARYING ASC-ITEM-SUB  FROM 1 BY 1                    24100000
241100             UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.           24110000
241200                                                                  24120000
241300     ADD +1                      TO ASC-BLK-SUB.                  24130000
241400                                                                  24140000
241500     PERFORM 3510-MARK-SELECTED-INDS                              24150000
241600             VARYING ASC-ITEM-SUB  FROM 1 BY 1                    24160000
241700             UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.           24170000
241800                                                                  24180000
241900     MOVE ASC-LIST-ITEM-NUMBER (1 1)                              24190000
242000                                 TO PV-LIST-ITEM-NUMBER.          24200000
242100     COMPUTE PV-FIRST-BLOCK-IN-ARRAY = 1 +                        24210000
242200                 ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).24220000
242300     MOVE ASC-START-OF-SELECTED-RANGE                             24230000
242400                                 TO PV-START-OF-SELECTED-RANGE.   24240000
242500     COMPUTE PV-FIRST-BLOCK-IN-RANGE = 1 +                        24250000
242600             ((PV-START-OF-SELECTED-RANGE - 1) /                  24260000
242700                                              PC-ITEMS-PER-PANEL).24270000
242800     MOVE ASC-END-OF-SELECTED-RANGE                               24280000
242900                                 TO PV-END-OF-SELECTED-RANGE.     24290000
243000     COMPUTE PV-LAST-BLOCK-IN-RANGE = 1 +                         24300000
243100             ((PV-END-OF-SELECTED-RANGE - 1) /                    24310000
243200                                              PC-ITEMS-PER-PANEL).24320000
243300     COMPUTE PV-NEXT-BLOCK-IN-ARRAY = PV-FIRST-BLOCK-IN-ARRAY + 1.24330000
243400                                                                  24340000
243500     IF (PV-FIRST-BLOCK-IN-RANGE < PV-FIRST-BLOCK-IN-ARRAY) OR    24350000
243600        (PV-LAST-BLOCK-IN-RANGE  > PV-NEXT-BLOCK-IN-ARRAY)        24360000
243700         MOVE +1                 TO ASC-BLK-SUB                   24370000
243800                                                                  24380000
243900         PERFORM 5100-WRITE-TEMP-STORAGE                          24390000
244000                                                                  24400000
244100         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         24410000
244200                                       PV-FIRST-BLOCK-IN-ARRAY - 124420000
244300                                                                  24430000
244400         PERFORM                                                  24440000
244500           UNTIL PV-FIRST-BLOCK-IN-RANGE > PV-PREV-BLOCK-IN-ARRAY 24450000
244600                 MOVE PV-FIRST-BLOCK-IN-RANGE                     24460000
244700                                 TO PV-BLOCK-NUMBER               24470000
244800                                                                  24480000
244900                 PERFORM 4410-READ-TEMP-STORAGE                   24490000
245000                                                                  24500000
245100                 PERFORM 3510-MARK-SELECTED-INDS                  24510000
245200                         VARYING ASC-ITEM-SUB  FROM 1 BY 1        24520000
245300                         UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL24530000
245400                                                                  24540000
245500                 PERFORM 5100-WRITE-TEMP-STORAGE                  24550000
245600                                                                  24560000
245700                 ADD +1          TO PV-FIRST-BLOCK-IN-RANGE       24570000
245800         END-PERFORM                                              24580000
245900                                                                  24590000
246000         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         24600000
246100                  PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY24610000
246200         PERFORM                                                  24620000
246300           UNTIL PV-NEXT-BLOCK-IN-ARRAY > PV-LAST-BLOCK-IN-RANGE  24630000
246400                 MOVE PV-NEXT-BLOCK-IN-ARRAY                      24640000
246500                                 TO PV-BLOCK-NUMBER               24650000
246600                                                                  24660000
246700                 PERFORM 4410-READ-TEMP-STORAGE                   24670000
246800                                                                  24680000
246900                 PERFORM 3510-MARK-SELECTED-INDS                  24690000
247000                         VARYING ASC-ITEM-SUB  FROM 1 BY 1        24700000
247100                         UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL24710000
247200                                                                  24720000
247300                 PERFORM 5100-WRITE-TEMP-STORAGE                  24730000
247400                                                                  24740000
247500                 ADD +1          TO PV-NEXT-BLOCK-IN-ARRAY        24750000
247600         END-PERFORM                                              24760000
247700                                                                  24770000
247800         MOVE PV-FIRST-BLOCK-IN-ARRAY                             24780000
247900                                 TO PV-BLOCK-NUMBER               24790000
248000                                                                  24800000
248100         PERFORM 4410-READ-TEMP-STORAGE                           24810000
248200                                                                  24820000
248300     END-IF.                                                      24830000
248400                                                                  24840000
248500     MOVE ZERO                   TO ASC-START-OF-SELECTED-RANGE   24850000
248600                                    ASC-END-OF-SELECTED-RANGE.    24860000
248700                                                                  24870000
248800 3510-MARK-SELECTED-INDS.                                         24880000
248900                                                                  24890000
249000     IF ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB ASC-ITEM-SUB) NOT <     24900000
249100                                       ASC-START-OF-SELECTED-RANGE24910000
249200        IF ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB ASC-ITEM-SUB) NOT >  24920000
249300                                         ASC-END-OF-SELECTED-RANGE24930000
249400           IF NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)           24940000
249500               SET ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)          24950000
249600                   ASC-BLOCK-MODIFIED (ASC-BLK-SUB)               24960000
249700                   ASC-TEMP-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)     24970000
249800                                 TO TRUE                          24980000
249900               ADD +1            TO ASC-NUMBER-OF-SELECTED-ITEMS  24990000
250000           END-IF                                                 25000000
250100        END-IF                                                    25010000
250200     END-IF.                                                      25020000
250300     EJECT                                                        25030000
250400 4000-BUILD-INITIAL-PANEL.                                        25040000
250500                                                                  25050000
250600     INITIALIZE ASC-BLOCK-ENTRIES (1)                             25060000
250700                ASC-BLOCK-ENTRIES (2).                            25070000
250800                                                                  25080000
250900     MOVE +1                     TO ASC-BLK-SUB.                  25090000
251000     SET ASC-MORE-RECDIS         TO TRUE.                         25100000
251100                                                                  25110000
251200     MOVE ZERO                   TO ASC-ITEM-SUB                  25120000
251300                                    ASC-NUMBER-OF-ITEMS-READ      25130000
251400                                    ASC-NUMBER-OF-SELECTED-ITEMS  25140000
251500                                    ASC-HIGHEST-BLOCK-WRITTEN     25150000
251600                                    ASC-START-OF-SELECTED-RANGE   25160000
251700                                    ASC-END-OF-SELECTED-RANGE     25170000
251800                                    ASC-ITEM-AT-TOP-OF-PANEL      25180000
251900                                    ASC-TOT-ACTUAL-QTY            25190000
252000                                    ASC-TOT-VERIFY-QTY            25200000
252100                                    ASC-TOT-PCKSLP-QTY            25210000
252200                                                                  25220000
252300     PERFORM 4010-FORMAT-KEYS.                                    25230000
252400                                                                  25240000
252500     PERFORM 7000-GET-PO-INFO.                                    25250000
252600                                                                  25260000
252700     PERFORM 7005-SELECT-RECITM.                                  25270000
252800                                                                  25280000
252900     PERFORM 7010-LOOK-FOR-TROUBLE.                               25290000
253000                                                                  25300000
253100     PERFORM 7020-SELECT-PURITM-DATA.                             25310000
253200                                                                  25320004
253300     PERFORM 4150-CALL-AUTOVE-MODULE.                             25330004
253400     IF RC040-AUTO-VE-YES                                         25340004
253500        SET ASC-AUTO-VE-YES        TO TRUE                        25350004
253600     ELSE                                                         25360032
253700        SET ASC-AUTO-VE-NO         TO TRUE                        25370032
253800     END-IF.                                                      25380004
253900                                                                  25390004
254000*----------------------------------------------------------------*25400000
254100*                                               **   WR # 21361  *25410000
254200* ADDED CODE TO CHECK FOR THE DUMMY SKU AND CALL TO XLKUT001     *25420000
254300*----------------------------------------------------------------*25430000
254400     IF PURITM-ITM-NBR < 0                                        25440000
254500        MOVE '4000-BUILD-INITIAL-PANEL'                           25450000
254600                         TO DP013-PARAGRAPH                       25460000
254700        MOVE 'PURITM-ITM-NBR < 0    '                             25470000
254800                         TO DP013-MESSAGE-TEXT (1)                25480000
254900        MOVE SQLCA       TO DP013-SQLCA                           25490000
255000        SET DP013-DB2-ABEND                                       25500000
255100                         TO TRUE                                  25510000
255200        PERFORM DP013-0000-PROCESS-ABEND                          25520000
255300     END-IF                                                       25530000
255400                                                                  25540000
255500     IF PURITM-ITM-NBR = 0                                        25550000
255600        IF PURITM-SKU-SEQ-NBR = PC-000                            25560000
255700           MOVE '00000000'    TO PV-SN-SEQ-NBR                    25570000
255800        ELSE                                                      25580000
255900           IF PURITM-SKU-SEQ-NBR = PC-999                         25590000
256000              MOVE '99999999' TO PV-SN-SEQ-NBR                    25600000
256100           ELSE                                                   25610000
256200              MOVE '4000-BUILD-INITIAL-PANEL'                     25620000
256300                               TO DP013-PARAGRAPH                 25630000
256400              MOVE 'PURITM-ITM-NBR = 0    '                       25640000
256500                               TO DP013-MESSAGE-TEXT (1)          25650000
256600              MOVE SQLCA       TO DP013-SQLCA                     25660000
256700              SET DP013-DB2-ABEND                                 25670000
256800                               TO TRUE                            25680000
256900              PERFORM DP013-0000-PROCESS-ABEND                    25690000
257000           END-IF                                                 25700000
257100        END-IF                                                    25710000
257200     END-IF                                                       25720000
257300                                                                  25730000
257400     IF PURITM-ITM-NBR > 0 AND                                    25740000
257500        PS-CALL-API-YES    AND                                    25750000
257600        ((PURITM-SKU-SEQ-NBR NOT = PC-000) AND                    25760000
257700         (PURITM-SKU-SEQ-NBR NOT = PC-999))                       25770000
257800          PERFORM 4020-CALL-XLKUT-DOMAIN-PGM                      25780000
257900     ELSE                                                         25790000
258000          MOVE SPACES          TO PV-SN-SEQ-NBR                   25800000
258100     END-IF                                                       25810000
258200                                                                  25820000
258300     MOVE PURCHS-DEPT-NBR        TO  PV-SN-DEPT-NBR.              25830000
258400     MOVE PURITM-CL-NBR          TO  PV-SN-CL-NBR.                25840000
258500*                                                                 25850000
258600     MOVE PV-SN-DEPT-NBR         TO  ASC-DEPT-NBR.                25860000
258700     MOVE PV-SN-CL-NBR           TO  ASC-CLASS-NBR.               25870000
258800     MOVE PV-SN-SEQ-NBR          TO  ASC-SKU-NBR.                 25880000
258900                                                                  25890000
259000     PERFORM 7030-SELECT-RECITM-DATA.                             25900000
259100     MOVE RECITM-STATUS-CDE   TO ASC-RECITM-STATUS-CDE            25910000
259200     IF RECITM-STATUS-CDE = PC-VE                                 25920000
259300        MOVE PC-ACTUAL TO ASC-AVERTYP                             25930000
259400     ELSE                                                         25940000
259500        MOVE PC-EXPECTED TO ASC-AVERTYP                           25950000
259600     END-IF.                                                      25960000
259700                                                                  25970000
259800     PERFORM 7040-GET-FACILITY-DESC.                              25980000
259900     PERFORM 7050-GET-TRECEIV.                                    25990000
260000     PERFORM 7055-GET-TDISTHD.                                    26000000
260100                                                                  26010000
260200     PERFORM 7100-OPEN-CURSOR.                                    26020000
260300     PERFORM 4040-PROCESS-CURSOR.                                 26030000
260400     PERFORM 7120-CLOSE-CURSOR.                                   26040000
260500                                                                  26050000
260600     SET ASC-CAN-UPDATE           TO TRUE                         26060000
260700     IF (RECEIV-ML-POST-TMST LESS PV-DB2-CURRENT-TMST             26070000
260800         OR  RECEIV-FS-POST-TMST LESS PV-DB2-CURRENT-TMST)        26080000
260900             SET ASC-CANT-UPDATE  TO  TRUE                        26090000
261000     END-IF                                                       26100000
261100                                                                  26110000
261200     IF RECEIV-FS-POST-TMST = PV-DB2-DEFAULT-TMST                 26120000
261300        SET ASC-GO-YELLOW TO TRUE                                 26130000
261400     ELSE                                                         26140000
261500        SET ASC-GO-BLUE TO TRUE                                   26150000
261600     END-IF.                                                      26160000
261700                                                                  26170000
261800     MOVE +1                     TO PV-TOP-ITEM.                  26180000
261900                                                                  26190000
262000     MOVE -1                     TO MR-SELECTL (1)                26200000
262100     SET DP030-SET-CURSOR-APPL-1 TO TRUE                          26210000
262200     PERFORM 3200-RESET-ATTRIBUTES                                26220041
262300     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        26230000
262400*----------------------------------------------------------------*26240000
262500* CHANGES MADE FOR WR # 21361 ENDS HERE.                         *26250000
262600*----------------------------------------------------------------*26260000
262700 4000-EXIT.                                                       26270000
262800     EXIT.                                                        26280000
262900                                                                  26290000
263000 4010-FORMAT-KEYS.                                                26300000
263100                                                                  26310000
263200     MOVE ASC-KEY-PO-NBR-N       TO DK-PO-NBR.                    26320000
263300     MOVE ASC-KEY-PKSL-LNE-NBR   TO DK-PKSL-LNE-NBR.              26330000
263400     MOVE ASC-KEY-REC-SEQ-NBR-N  TO DK-REC-SEQ-NBR.               26340000
263500/                                                                 26350000
263600*----------------------------------------------------------------*26360000
263700*                                               **   WR # 21361  *26370000
263800* CODE FOR ACCESSING LOGISTICS DOMAIN ITEM ACCESS MODULE         *26380000
263900*----------------------------------------------------------------*26390000
264000 4020-CALL-XLKUT-DOMAIN-PGM.                                      26400000
264100                                                                  26410000
264200     INITIALIZE XL001-ITEM-COMMAREA                               26420000
264300                PV-TEMP-SEQ-NBR                                   26430000
264400                                                                  26440000
264500     MOVE PURITM-ITM-NBR            TO XL001-KEY-ITM-NBR          26450000
264600                                                                  26460000
264700     SET  XL001-BY-ITEM                                           26470000
264800          XL001-SELECT-SKU          TO TRUE                       26480000
264900                                                                  26490000
265000     CALL XL001-VSM-PGM USING  DFHEIBLK                           26500000
265100                               XL001-COMMAREA                     26510000
265200                               XL001-ITEM-COMMAREA                26520000
265300                                                                  26530000
265400     EVALUATE TRUE                                                26540000
265500         WHEN XL001-SUCCESSFUL                                    26550000
265600               MOVE XL001-SKU-NBR   TO PV-TEMP-SEQ-NBR            26560000
265700               MOVE PV-TEMP-SEQ-NBR TO PV-SN-SEQ-NBR              26570000
265800                                                                  26580000
265900         WHEN XL001-SKU-SQLCODE = +100                            26590000
266000               MOVE SPACES          TO PV-SN-SEQ-NBR              26600000
266100                                                                  26610000
266200         WHEN XL001-SKU-CONTENTION                                26620000
266300               MOVE '7020-SELECT-SKU-BY-ITM'                      26630000
266400                                    TO DP013-PARAGRAPH            26640000
266500               MOVE 'SKU CONTENTION'                              26650000
266600                                    TO DP013-MESSAGE-TEXT (1)     26660000
266700               MOVE XL001-SQLCA     TO DP013-SQLCA                26670000
266800               SET DP013-DB2-ABEND  TO TRUE                       26680000
266900               PERFORM DP013-0000-PROCESS-ABEND                   26690000
267000                                                                  26700000
267100         WHEN OTHER                                               26710000
267200               MOVE '7020-SELECT-SKU-BY-ITM'                      26720000
267300                                    TO DP013-PARAGRAPH            26730000
267400               MOVE 'SELECT ROW FROM XLV_SKU'                     26740000
267500                                    TO DP013-MESSAGE-TEXT (1)     26750000
267600               MOVE XL001-SQLCA     TO DP013-SQLCA                26760000
267700               SET DP013-DB2-ABEND  TO TRUE                       26770000
267800               PERFORM DP013-0000-PROCESS-ABEND                   26780000
267900                                                                  26790000
268000     END-EVALUATE.                                                26800000
268100*----------------------------------------------------------------*26810000
268200* CHANGES MADE FOR WR # 21361 ENDS HERE.                         *26820000
268300*----------------------------------------------------------------*26830000
268400                                                                  26840000
268500 4040-PROCESS-CURSOR.                                             26850000
268600                                                                  26860000
268700     PERFORM VARYING PV-READ-COUNT  FROM 1 BY 1                   26870000
268800         UNTIL PV-READ-COUNT > PC-MAX-ITEMS OR                    26880000
268900               ASC-NO-MORE-RECDIS                                 26890000
269000                                                                  26900000
269100         PERFORM 7110-FETCH-RECDIS                                26910000
269200                                                                  26920000
269300         IF ASC-MORE-RECDIS                                       26930000
269400             IF ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                 26940000
269500                 ADD +1          TO ASC-ITEM-SUB                  26950000
269600             ELSE                                                 26960000
269700                 ADD +1          TO ASC-BLK-SUB                   26970000
269800                 MOVE +1         TO ASC-ITEM-SUB                  26980000
269900                                                                  26990000
270000                 IF ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY          27000000
270100                     MOVE +1     TO ASC-BLK-SUB                   27010000
270200                     SET ASC-BLOCK-MODIFIED (1)                   27020000
270300                                 TO TRUE                          27030000
270400                                                                  27040000
270500                     PERFORM 5100-WRITE-TEMP-STORAGE              27050000
270600                                                                  27060000
270700                     MOVE ASC-BLOCK-ENTRIES                       27070000
270800                                          (PC-MAX-BLOCKS-IN-ARRAY)27080000
270900                                 TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB)27090000
271000                     ADD +1      TO ASC-BLK-SUB                   27100000
271100                     INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)   27110000
271200                     SET ASC-BLOCK-NOT-MODIFIED (ASC-BLK-SUB)     27120000
271300                                 TO TRUE                          27130000
271400                 END-IF                                           27140000
271500             END-IF                                               27150000
271600             ADD +1              TO ASC-NUMBER-OF-ITEMS-READ      27160000
271700             MOVE ASC-NUMBER-OF-ITEMS-READ                        27170000
271800                                 TO ASC-LIST-ITEM-NUMBER          27180000
271900                                   (ASC-BLK-SUB ASC-ITEM-SUB)     27190000
272000             MOVE RECDIS-STR-NBR TO ASC-STR-NBR-N                 27200000
272100                                   (ASC-BLK-SUB ASC-ITEM-SUB)     27210000
272200                                   DK-STR-NBR                     27220000
272300             MOVE RECDIS-EXPTED-ITM-QTY                           27230000
272400                                 TO ASC-EXPTED-ITM-QTY-N          27240000
272500                                   (ASC-BLK-SUB ASC-ITEM-SUB)     27250000
272600                                    ASC-STR-QTY-PREV              27260000
272700                                   (ASC-BLK-SUB ASC-ITEM-SUB)     27270000
272800             ADD  RECDIS-EXPTED-ITM-QTY                           27280000
272900                                 TO ASC-TOT-PCKSLP-QTY            27290000
273000                                                                  27300000
273100* DMH  6/17/2004 - BEGIN                                          27310030
273200                                                                  27320030
273300             IF  ASC-AUTO-VE-YES AND                              27330030
273400                 ASC-PBS-YES                                      27340030
273500                 SET ASC-PBS-UPDATE-NO                            27350030
273600                         (ASC-BLK-SUB ASC-ITEM-SUB)  TO TRUE      27360030
273700                 PERFORM 4160-CHECK-FOR-PBS-CARTONS               27370030
273800                 PERFORM 4200-SELECT-DAMAGED                      27380043
273900                 PERFORM 7045-CHECK-IF-DC                         27390043
274000                 IF PS-DAMAGED-CARTON AND                         27400043
274100                    XL071-LOC-TYP-CDE = 'DC'                      27410043
274200                     SET ASC-PBS-UPDATE-NO                        27420043
274300                         (ASC-BLK-SUB ASC-ITEM-SUB)  TO TRUE      27430043
274400                 ELSE                                             27440043
274500                     IF  (PS-ACTIVE-PBS-UCC128-NO) OR             27450043
274600                         (PS-ACTIVE-PBS-UCC128-YES AND            27460043
274700                          PS-PBS-ERROR-CARTONS-YES)               27470043
274800                         SET ASC-PBS-UPDATE-YES                   27480043
274900                             (ASC-BLK-SUB ASC-ITEM-SUB)  TO TRUE  27490043
275000                     ELSE                                         27500043
275100                         SET ASC-PBS-UPDATE-NO                    27510043
275200                             (ASC-BLK-SUB ASC-ITEM-SUB)  TO TRUE  27520043
275300                     END-IF                                       27530043
275400                 END-IF                                           27540043
275500             END-IF                                               27550043
275600                                                                  27560043
275700* DMH  6/17/2004 - END                                            27570043
275800                                                                  27580043
275900             IF ASC-RECITM-STATUS-CDE = 'VE' OR                   27590043
276000                ASC-AUTO-VE-NO                                    27600043
276100                 MOVE RECDIS-VERIFY-ITM-QTY                       27610043
276200                                 TO ASC-ACTUAL-QTY-N              27620043
276300                                   (ASC-BLK-SUB ASC-ITEM-SUB)     27630043
276400                 ADD RECDIS-VERIFY-ITM-QTY                        27640009
276500                                 TO ASC-TOT-ACTUAL-QTY            27650000
276600             ELSE                                                 27660009
276700                                                                  27670030
276800* DMH - 6/17/2004 - BEGIN                                         27680030
276900**** IF PBS AND NO VALID UCC128 - GET ACTUAL FROM RECDIS          27690030
277000                 IF  ASC-PBS-YES        AND                       27700030
277100                     ASC-PBS-UPDATE-YES(ASC-BLK-SUB ASC-ITEM-SUB) 27710030
277200                     MOVE RECDIS-VERIFY-ITM-QTY                   27720030
277300                                 TO ASC-ACTUAL-QTY-N              27730030
277400                                   (ASC-BLK-SUB ASC-ITEM-SUB)     27740030
277500                     ADD RECDIS-VERIFY-ITM-QTY                    27750030
277600                                 TO ASC-TOT-ACTUAL-QTY            27760030
277700                 ELSE                                             27770030
277800* DMH - 6/17/2004 - END                                           27780030
277900                                                                  27790030
278000                     PERFORM 4350-CALL-RCKUT128                   27800030
278100                     MOVE RC074-TOTAL-ACTL-ITM-QTY                27810030
278200                                 TO ASC-ACTUAL-QTY-N              27820009
278300                                   (ASC-BLK-SUB ASC-ITEM-SUB)     27830009
278400                     ADD RC074-TOTAL-ACTL-ITM-QTY                 27840030
278500                                 TO ASC-TOT-ACTUAL-QTY            27850030
278600                 END-IF                                           27860030
278700             END-IF                                               27870009
278800                                                                  27880000
278900             IF ASC-RECITM-STATUS-CDE = 'VE'                      27890000
279000                 MOVE RECDIS-AP-VERIFY-ITM-QTY                    27900000
279100                                 TO ASC-VERFD-QTY-N               27910000
279200                                     (ASC-BLK-SUB ASC-ITEM-SUB)   27920000
279300                 ADD RECDIS-AP-VERIFY-ITM-QTY                     27930000
279400                                 TO ASC-TOT-VERIFY-QTY            27940000
279500             ELSE                                                 27950000
279600                 MOVE SPACES     TO ASC-VERFD-QTY                 27960000
279700                                     (ASC-BLK-SUB ASC-ITEM-SUB)   27970000
279800             END-IF                                               27980000
279900                                                                  27990026
280000         END-IF                                                   28000000
280100     END-PERFORM.                                                 28010000
280200                                                                  28020000
280300     IF ASC-NUMBER-OF-ITEMS-READ > ZERO                           28030000
280400         MOVE +1                 TO ASC-BLK-SUB                   28040000
280500                                                                  28050000
280600         PERFORM 5100-WRITE-TEMP-STORAGE                          28060000
280700                                                                  28070000
280800         ADD +1                  TO ASC-BLK-SUB                   28080000
280900                                                                  28090000
281000         PERFORM 5100-WRITE-TEMP-STORAGE                          28100000
281100                                                                  28110000
281200         MOVE +1                 TO ASC-BLK-SUB                   28120000
281300                                    PV-BLOCK-NUMBER               28130000
281400                                                                  28140000
281500         PERFORM 4410-READ-TEMP-STORAGE                           28150000
281600                                                                  28160000
281700         IF ASC-HIGHEST-BLOCK-WRITTEN > 1                         28170000
281800             MOVE +2             TO ASC-BLK-SUB                   28180000
281900                                    PV-BLOCK-NUMBER               28190000
282000                                                                  28200000
282100             PERFORM 4410-READ-TEMP-STORAGE                       28210000
282200         END-IF                                                   28220000
282300     END-IF.                                                      28230000
282400                                                                  28240004
282500*----------------------------------------------------------------*28250004
282600*    CALL TO (AUTOVE) AUTOVERIFICATION MODULE (RCKUT127)          28260004
282700*----------------------------------------------------------------*28270004
282800 4150-CALL-AUTOVE-MODULE.                                         28280004
282900                                                                  28290004
283000     INITIALIZE RC040-FIELDS.                                     28300004
283100     MOVE ASC-KEY-OPER-UNT-ID TO RC040-SIGNON-LOCATION.           28310017
283200     MOVE DK-PO-NBR           TO RC040-PO-NBR                     28320011
283300     MOVE DK-REC-SEQ-NBR      TO RC040-PO-RCVR                    28330011
283400     MOVE DP020-USERID        TO RC040-USER-ID.                   28340011
283500     MOVE 'RCKCS284'          TO RC040-CALLING-PROGRAM.           28350011
283600                                                                  28360004
283700     CALL RC040-AUTOVE-CHECK-PGM USING  DFHEIBLK                  28370004
283800                                        RC040-COMMAREA            28380004
283900                                        RC040-FIELDS.             28390004
284000                                                                  28400004
284100     EVALUATE TRUE                                                28410004
284200         WHEN RC040-SUCCESSFUL                                    28420007
284300              CONTINUE                                            28430008
284400         WHEN RC040-DATABASE-BUSY OR                              28440007
284500              RC040-INVALID-SQL                                   28450007
284600                  MOVE PC-TSYMSG-00984  TO DP020-MSG-NUMBER       28460007
284700                  SET DP020-MSG-WARNING TO TRUE                   28470007
284800                  SET DP030-OVERRIDE-GO TO TRUE                   28480007
284900                  SET PS-ERROR          TO TRUE                   28490007
285000         WHEN RC040-NOT-SUCCESSFUL                                28500007
285100                  MOVE PC-TSYMSG-03138  TO DP020-MSG-NUMBER       28510007
285200                  SET DP020-MSG-WARNING TO TRUE                   28520007
285300                  SET DP030-OVERRIDE-GO TO TRUE                   28530007
285400                  SET PS-ERROR          TO TRUE                   28540007
285500         WHEN OTHER                                               28550007
285600             MOVE '4150-CHECK-AUTOVE ' TO DP013-PARAGRAPH         28560007
285700             MOVE 'UNSUCCESSFUL CALL TO AUTO VE MOD'              28570007
285800                                         TO DP013-MESSAGE-TEXT (1)28580007
285900             MOVE RC040-SUCCESS-IND      TO DP013-MESSAGE-TEXT (2)28590007
286000             MOVE RC040-SQLCA            TO DP013-SQLCA           28600007
286100             SET DP013-DB2-ABEND                                  28610007
286200                 DP013-XCTL-DISPLAY-RESTART  TO TRUE              28620007
286300             SET PS-ERROR                    TO TRUE              28630007
286400             PERFORM DP013-0000-PROCESS-ABEND                     28640007
286500     END-EVALUATE.                                                28650004
286600                                                                  28660005
286700                                                                  28670009
286800* DMH  6/17/2004 - BEGIN                                          28680026
286900*----------------------------------------------------------------*28690026
287000* FOR AUTOVE PBS ORDERS - CHECK TO SEE IF CAN UPDATE STORE QTY    28700026
287100* CAN UPDATE PBS STORE UNIT QTY WHEN THE FOLLOWING IS TRUE        28710026
287200* -- NO USEABLE UCC128 DATA     (4170-CHECK-TSHPUNT)              28720026
287300* -- NO PBS ERROR CARTONS       (4175-CHECK-TSHUNLO)              28730026
287400*----------------------------------------------------------------*28740026
287500                                                                  28750026
287600 4160-CHECK-FOR-PBS-CARTONS.                                      28760026
287700     SET  PS-PBS-ERROR-CARTONS-NO                                 28770026
287800          PS-ACTIVE-PBS-UCC128-NO  TO  TRUE.                      28780026
287900                                                                  28790026
288000     MOVE ASC-KEY-PO-NBR-N      TO  DK-PO-NBR.                    28800029
288100     MOVE ASC-KEY-REC-SEQ-NBR-N TO  DK-REC-SEQ-NBR.               28810029
288200     MOVE RECDIS-STR-NBR        TO  DK-STR-NBR.                   28820029
288300     PERFORM 4170-CHECK-TSHPUNT.                                  28830026
288400                                                                  28840026
288500                                                                  28850026
288600*----------------------------------------------------------------*28860026
288700* CHECK TSHPUNT FOR ACTIVE CARTONS - ACTIVE UCC128 DATA FOR PBS   28870026
288800*----------------------------------------------------------------*28880026
288900 4170-CHECK-TSHPUNT.                                              28890026
289000                                                                  28900026
289100     EXEC SQL                                                     28910026
289200             SELECT C.SHIPT_UNT_ID                                28920026
289300             INTO :SHPUNT-SHIPT-UNT-ID                            28930026
289400             FROM  TPKSLIP A,                                     28940026
289500                   TINPKSU B,                                     28950026
289600                   TSHPUNT C                                      28960026
289700             WHERE A.PO_NBR           = :DK-PO-NBR                28970026
289800               AND A.REC_SEQ_NBR      = :DK-REC-SEQ-NBR           28980026
289900               AND A.VER_STAT_CDE     = 'A'                       28990026
290000               AND A.PO_NBR           =  B.PO_NBR                 29000026
290100               AND A.SEQ_NBR          =  B.SEQ_NBR                29010026
290200               AND B.SHIPT_UNT_ID     =  C.SHIPT_UNT_ID           29020026
290300               AND C.DEST_OPER_UNT_ID = :DK-STR-NBR               29030026
290400     END-EXEC.                                                    29040026
290500     EVALUATE TRUE                                                29050026
290600         WHEN SQLCODE = ZERO                                      29060026
290700         WHEN SQLCODE = -811                                      29070026
290800              SET  PS-ACTIVE-PBS-UCC128-YES  TO  TRUE             29080026
290900              PERFORM 4175-CHECK-TSHUNLO                          29090026
291000                                                                  29100026
291100         WHEN SQLCODE = +100                                      29110026
291200              SET  PS-ACTIVE-PBS-UCC128-NO  TO TRUE               29120026
291300                                                                  29130026
291400         WHEN SQLCODE = -904                                      29140026
291500         WHEN SQLCODE = -911                                      29150026
291600         WHEN SQLCODE = -913                                      29160026
291700              PERFORM 9900-SOFT-ABORT                             29170026
291800                                                                  29180026
291900         WHEN SQLWARN0 NOT = SPACES                               29190026
292000         WHEN SQLCODE NOT EQUAL ZERO                              29200026
292100              MOVE '4170-CHECK-TSHPUNT '  TO DP013-PARAGRAPH      29210026
292200              MOVE 'SELECT TSHPUNT '     TO DP013-MESSAGE-TEXT (1)29220026
292300              MOVE SQLCA           TO DP013-SQLCA                 29230026
292400              MOVE 'TSHPUNT '      TO DP013-DB2-TABLE-NAME (1)    29240026
292500              SET DP013-DB2-ABEND  TO TRUE                        29250026
292600              PERFORM DP013-0000-PROCESS-ABEND                    29260026
292700     END-EVALUATE.                                                29270026
292800                                                                  29280026
292900*----------------------------------------------------------------*29290026
293000* CHECK TSHUNLO FOR PBS ERRORS                                    29300026
293100*----------------------------------------------------------------*29310026
293200 4175-CHECK-TSHUNLO.                                              29320026
293300                                                                  29330026
293400     EXEC SQL                                                     29340026
293500          SELECT D.SCN_LOC_ID                                     29350026
293600            INTO :SHUNLO-SCN-LOC-ID                               29360026
293700            FROM  TPKSLIP A,                                      29370026
293800                  TINPKSU B,                                      29380026
293900                  TSHPUNT C,                                      29390026
294000                  TSHUNLO D                                       29400026
294100             WHERE A.PO_NBR           = :DK-PO-NBR                29410026
294200               AND A.REC_SEQ_NBR      = :DK-REC-SEQ-NBR           29420026
294300               AND A.VER_STAT_CDE     = 'A'                       29430026
294400               AND A.PO_NBR           =  B.PO_NBR                 29440026
294500               AND A.SEQ_NBR          =  B.SEQ_NBR                29450026
294600               AND B.SHIPT_UNT_ID     =  C.SHIPT_UNT_ID           29460026
294700               AND C.SHIPT_UNT_ID     =  D.SHIPT_UNT_ID           29470026
294800               AND C.DEST_OPER_UNT_ID = :DK-STR-NBR               29480026
294900               AND C.ACTV_IND         = 'A'                       29490026
295000               AND D.SCN_LOC_ID    IN ('PBSA', 'PBSB', 'PBSC',    29500026
295100                                      'PBSD', 'PBSE')             29510026
295200     END-EXEC.                                                    29520026
295300                                                                  29530026
295400     EVALUATE TRUE                                                29540026
295500         WHEN SQLCODE = ZERO                                      29550026
295600         WHEN SQLCODE = -811                                      29560026
295700             SET PS-PBS-ERROR-CARTONS-YES  TO  TRUE               29570026
295800                                                                  29580026
295900         WHEN SQLCODE = +100                                      29590026
296000             SET PS-PBS-ERROR-CARTONS-NO   TO  TRUE               29600026
296100                                                                  29610026
296200         WHEN SQLCODE = -904                                      29620026
296300         WHEN SQLCODE = -911                                      29630026
296400         WHEN SQLCODE = -913                                      29640026
296500              PERFORM 9900-SOFT-ABORT                             29650026
296600                                                                  29660026
296700         WHEN SQLWARN0 NOT = SPACES                               29670026
296800         WHEN SQLCODE NOT EQUAL ZERO                              29680026
296900              MOVE '4175-CHECK-TSHUNLO '  TO DP013-PARAGRAPH      29690026
297000              MOVE 'SELECT TSHUNLO '     TO DP013-MESSAGE-TEXT (1)29700026
297100              MOVE SQLCA           TO DP013-SQLCA                 29710026
297200              MOVE 'TSHUNLO '      TO DP013-DB2-TABLE-NAME (1)    29720026
297300              SET DP013-DB2-ABEND  TO TRUE                        29730026
297400              PERFORM DP013-0000-PROCESS-ABEND                    29740026
297500     END-EVALUATE.                                                29750026
297600                                                                  29760026
297700                                                                  29770026
297800* DMH  6/17/2004 - END                                            29780026
297900                                                                  29790026
298000 4200-SELECT-DAMAGED.                                             29800043
298100                                                                  29810043
298200     EXEC SQL                                                     29820043
298300         SELECT UNT.SHIPT_UNT_ID                                  29830043
298400         INTO :SUT00024-SHIPT-UNT-ID                              29840043
298500         FROM SUT_OTBND_UPC UPC                                   29850043
298600            , SUT_OTBND_CART UNT                                  29860043
298700         WHERE UPC.TRN_NBR              = :DK-PO-NBR              29870043
298800          AND  UPC.RCVR_SEQ_NBR         = :DK-REC-SEQ-NBR         29880043
298900          AND  UPC.TRN_LNE_NBR          = :DK-PKSL-LNE-NBR        29890047
299000          AND  UPC.SHIPT_UNT_ID         =  UNT.SHIPT_UNT_ID       29900043
299100          AND  UNT.DEST_LOC_NBR         =  :DK-STR-NBR            29910043
299200          AND  UNT.CART_SRC_CDE         =  'DMG'                  29920043
299300          AND  UNT.ACTV_IND             =  'Y'                    29930043
299400     END-EXEC.                                                    29940043
299500                                                                  29950043
299600     EVALUATE TRUE                                                29960043
299700         WHEN SQLCODE = ZERO                                      29970043
299800         WHEN SQLCODE = -811                                      29980046
299900             SET PS-DAMAGED-CARTON     TO TRUE                    29990046
300000         WHEN SQLCODE = +100                                      30000043
300100             SET PS-NO-DAMAGED-CARTON  TO TRUE                    30010046
300200         WHEN SQLCODE = -904                                      30020043
300300         WHEN SQLCODE = -913                                      30030043
300400         WHEN SQLCODE = -911                                      30040043
300500             PERFORM 9900-SOFT-ABORT                              30050043
300600         WHEN SQLWARN0 NOT = SPACES                               30060043
300700         WHEN SQLCODE < ZERO                                      30070043
300800         WHEN SQLCODE > ZERO                                      30080043
300900             MOVE '4200-SELECT-DAMAGED'                           30090043
301000                               TO DP013-PARAGRAPH                 30100043
301100             MOVE 'CHECK FOR DAMAGED CARTONS'                     30110043
301200                               TO DP013-MESSAGE-TEXT (1)          30120043
301300             MOVE SQLCA        TO DP013-SQLCA                     30130043
301400             MOVE 'SUT00028'   TO DP013-DB2-TABLE-NAME (1)        30140043
301500             MOVE 'SUT00024'   TO DP013-DB2-TABLE-NAME (2)        30150043
301600             SET DP013-DB2-ABEND                                  30160043
301700                 DP013-XCTL-DISPLAY-RESTART TO TRUE               30170043
301800             PERFORM DP013-0000-PROCESS-ABEND                     30180043
301900     END-EVALUATE.                                                30190043
302000                                                                  30200043
302100                                                                  30210026
302200 4350-CALL-RCKUT128.                                              30220009
302300     INITIALIZE RC074-FIELDS.                                     30230009
302400     MOVE ASC-KEY-OPER-UNT-ID TO RC074-OPER-UNT-ID.               30240009
302500     MOVE ASC-KEY-FCLTY-ID    TO RC074-FCLTY-ID.                  30250009
302600     MOVE ASC-KEY-PO-NBR-N    TO RC074-PO-NBR.                    30260009
302700     MOVE ASC-KEY-REC-SEQ-NBR-N                                   30270010
302800                              TO RC074-RCVR-SEQ-NBR.              30280009
302900     MOVE ASC-KEY-PKSL-LNE-NBR                                    30290009
303000                              TO RC074-LINE-NBR.                  30300009
303100     MOVE RECDIS-STR-NBR      TO RC074-STR-NBR.                   30310025
303200     SET RC074-UNIT-QTY-YES   TO TRUE.                            30320009
303300                                                                  30330009
303400     CALL RC074-UNIT-CRTN-CNT-PGM USING  DFHEIBLK                 30340009
303500                                         RC074-COMMAREA           30350009
303600                                         RC074-FIELDS.            30360009
303700                                                                  30370009
303800     EVALUATE TRUE                                                30380009
303900         WHEN RC074-SUCCESSFUL                                    30390009
304000             CONTINUE                                             30400009
304100         WHEN OTHER                                               30410009
304200             MOVE '4350-CALL-RCKUT128'                            30420009
304300                                 TO DP013-PARAGRAPH               30430009
304400             STRING                                               30440009
304500                  'UNSUCCESSFUL CALL TO RCKUT128 '                30450009
304600                  'SUCCESS-IND = '                                30460009
304700                  RC074-SUCCESS-IND                               30470009
304800                               DELIMITED BY SIZE                  30480009
304900                               INTO DP013-MESSAGE-TEXT (1)        30490009
305000             MOVE RC074-CRA-RET-MSG                               30500009
305100                                 TO DP013-MESSAGE-TEXT (2)        30510009
305200             MOVE RC074-SQLCA    TO DP013-SQLCA                   30520009
305300             SET DP013-DB2-ABEND                                  30530009
305400                 DP013-XCTL-DISPLAY-RESTART                       30540009
305500                                 TO TRUE                          30550009
305600             PERFORM DP013-0000-PROCESS-ABEND                     30560009
305700     END-EVALUATE.                                                30570009
305800                                                                  30580009
305900/                                                                 30590009
306000 4400-MOVE-COMMAREA-TO-SCREEN.                                    30600009
306100                                                                  30610009
306200     IF  (((PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (1 1)) AND         30620009
306300           (PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (2 1))) OR         30630009
306400           (PV-TOP-ITEM < ASC-LIST-ITEM-NUMBER (1 1)))            30640009
306500             MOVE +1             TO ASC-BLK-SUB                   30650009
306600                                                                  30660009
306700             PERFORM 5100-WRITE-TEMP-STORAGE                      30670009
306800                                                                  30680009
306900             ADD +1              TO ASC-BLK-SUB                   30690009
307000                                                                  30700009
307100             PERFORM 5100-WRITE-TEMP-STORAGE                      30710009
307200                                                                  30720009
307300             DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL             30730000
307400                 GIVING PV-BLOCK-NUMBER                           30740000
307500                 REMAINDER PV-REMAINDER                           30750000
307600             IF PV-REMAINDER > ZERO                               30760000
307700                 ADD +1          TO PV-BLOCK-NUMBER               30770000
307800             END-IF                                               30780000
307900             MOVE +1             TO ASC-BLK-SUB                   30790000
308000                                                                  30800000
308100             PERFORM 4410-READ-TEMP-STORAGE                       30810000
308200                                                                  30820000
308300             ADD +1              TO ASC-BLK-SUB                   30830000
308400                                    PV-BLOCK-NUMBER               30840000
308500                                                                  30850000
308600             PERFORM 4410-READ-TEMP-STORAGE                       30860000
308700                                                                  30870000
308800     END-IF.                                                      30880000
308900                                                                  30890000
309000     MOVE +1                     TO ASC-BLK-SUB.                  30900000
309100     COMPUTE ASC-ITEM-SUB =                                       30910000
309200         ((PV-TOP-ITEM - ASC-LIST-ITEM-NUMBER (1 1))              30920000
309300                       + PC-ITEMS-PER-PANEL).                     30930000
309400                                                                  30940000
309500     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         30950000
309600         ADD +1                  TO ASC-BLK-SUB                   30960000
309700         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            30970000
309800     END-IF.                                                      30980000
309900                                                                  30990000
310000     COMPUTE ASC-ITEM-AT-BOT-OF-PANEL =                           31000000
310100         ((PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1).                31010000
310200                                                                  31020000
310300     PERFORM 4430-CHECK-FOR-BEGIN-AND-END.                        31030000
310400                                                                  31040000
310500     PERFORM 4420-FORMAT-LIST-LINES                               31050000
310600         VARYING PV-SUB  FROM PC-ITEMS-PER-PANEL BY -1            31060000
310700         UNTIL   PV-SUB < +1.                                     31070000
310800                                                                  31080000
310900     COMPUTE ASC-ITEMS-DISPLAYED =                                31090000
311000                   ((ASC-ITEM-AT-BOT-OF-PANEL - PV-TOP-ITEM) + 1).31100000
311100     MOVE PV-TOP-ITEM            TO ASC-ITEM-AT-TOP-OF-PANEL      31110000
311200                                    ASTRTITO.                     31120000
311300     MOVE ASC-ITEM-AT-BOT-OF-PANEL                                31130000
311400                                 TO AENDITO.                      31140000
311500     MOVE ASC-NUMBER-OF-ITEMS-READ                                31150000
311600                                 TO ATOTITO.                      31160000
311700     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            31170000
311800                                 TO ASELITO.                      31180000
311900                                                                  31190000
312000     MOVE PC-DASH                TO ASC-KEY-REC-DASH.             31200000
312100     MOVE ASC-KEY-RECEIVER       TO ARCVRO.                       31210000
312200     MOVE ASC-KEY-PKSL-LNE-NBR   TO ALINEO.                       31220000
312300     MOVE ASC-KEY-OPER-UNT-ID    TO AOPERO.                       31230000
312400     MOVE ASC-KEY-FCLTY-ID       TO AFCLTYO.                      31240000
312500     MOVE ASC-KEY-FCLTY-DESC     TO AFDESCO.                      31250000
312600*----------------------------------------------------------------*31260000
312700*                                                WR # 21361.     *31270000
312800* ADDED CODE TO MOVE ASC-DEPT-NBR TO MAP OUTPUT FIELD.           *31280000
312900* ADDED CODE TO MOVE ASC-CLASS-NBR TO MAP OUTPUT FIELD.          *31290000
313000*----------------------------------------------------------------*31300000
313100     MOVE ASC-DEPT-NBR           TO ADEPTO.                       31310000
313200     MOVE ASC-CLASS-NBR          TO ACLO.                         31320000
313300*----------------------------------------------------------------*31330000
313400* CHANGES MADE FOR WR # 21361 ENDS HERE.                         *31340000
313500*----------------------------------------------------------------*31350000
313600     MOVE ASC-SKU-NBR            TO ASKUNBRO.                     31360000
313700     MOVE ASC-TOT-VERIFY-QTY     TO AVERQTYO.                     31370000
313800     MOVE ASC-TOT-ACTUAL-QTY     TO AACTQTYO.                     31380000
313900     MOVE ASC-TOT-PCKSLP-QTY     TO APSLQTYO.                     31390000
314000     MOVE ASC-RECITM-STATUS-CDE  TO ASTATO.                       31400000
314100     MOVE ASC-AVERTYP            TO AVERTYPO                      31410000
314200                                    AVERTY2O.                     31420000
314300     MOVE ASC-KEY-VFY-SRC        TO AVERSRCO.                     31430000
314400     IF ASC-KEY-VFY-SRC = PC-MANUAL                               31440000
314500         MOVE PC-MANUAL          TO AVERSR2O                      31450000
314600         MOVE SPACES             TO AVERSR3O                      31460000
314700     ELSE                                                         31470000
314800         IF ASC-KEY-VFY-SRC = PC-P2L                              31480000
314900             MOVE PC-P2L-HEAD    TO AVERSR2O                      31490000
315000             MOVE SPACES         TO AVERSR3O                      31500000
315100         ELSE                                                     31510000
315200            IF ASC-KEY-VFY-SRC = PC-CASE                          31520000
315300                MOVE PC-CASE-HEAD TO AVERSR2O                     31530000
315400                MOVE SPACES       TO AVERSR3O                     31540000
315500            ELSE                                                  31550000
315600               IF ASC-KEY-VFY-SRC = PC-P2LCASE                    31560000
315700                   MOVE PC-P2L-HEAD   TO AVERSR2O                 31570000
315800                   MOVE PC-CASE-HEAD  TO AVERSR3O                 31580000
315900               END-IF                                             31590000
316000            END-IF                                                31600000
316100         END-IF                                                   31610000
316200      END-IF.                                                     31620000
316300                                                                  31630000
316400     IF DP020-MSG-NUMBER-X = SPACE                                31640000
316500        IF ASC-ITEM-AT-BOT-OF-PANEL < ASC-NUMBER-OF-ITEMS-READ    31650000
316600             IF ASC-OVERAGE                                       31660000
316700                 MOVE PC-TSYMSG-01264                             31670000
316800                          TO DP020-MSG-NUMBER                     31680000
316900                SET DP020-MSG-FATAL                               31690000
317000                                     TO TRUE                      31700000
317100             ELSE                                                 31710000
317200                 MOVE PC-TSYMSG-00279    TO DP020-MSG-NUMBER      31720000
317300                 SET DP020-MSG-INFORMATIONAL                      31730000
317400                                     TO TRUE                      31740000
317500             END-IF                                               31750000
317600        ELSE                                                      31760000
317700             IF ASC-OVERAGE                                       31770000
317800                 MOVE PC-TSYMSG-01264                             31780000
317900                          TO DP020-MSG-NUMBER                     31790000
318000                SET DP020-MSG-FATAL                               31800000
318100                                     TO TRUE                      31810000
318200             ELSE                                                 31820000
318300                 MOVE PC-TSYMSG-00070    TO DP020-MSG-NUMBER      31830000
318400                 SET DP020-MSG-INFORMATIONAL                      31840000
318500                                     TO TRUE                      31850000
318600             END-IF                                               31860000
318700         END-IF                                                   31870000
318800     END-IF.                                                      31880000
318900                                                                  31890000
319000 4410-READ-TEMP-STORAGE.                                          31900000
319100                                                                  31910000
319200     EXEC CICS READQ TS                                           31920000
319300               QUEUE (ASC-LIST-QUEUE-NAME)                        31930000
319400               INTO  (ASC-BLOCK-ENTRIES (ASC-BLK-SUB))            31940000
319500               ITEM  (PV-BLOCK-NUMBER)                            31950000
319600               RESP  (PV-CICS-RESP)                               31960000
319700     END-EXEC.                                                    31970000
319800                                                                  31980000
319900     IF ((PV-CICS-RESP = DFHRESP (NORMAL)) OR                     31990000
320000         (PV-CICS-RESP = DFHRESP (ITEMERR)))                      32000000
320100         CONTINUE                                                 32010000
320200     ELSE                                                         32020000
320300         SET DP013-CICS-ABEND                                     32030000
320400             DP013-NO-ROLLBACK   TO TRUE                          32040000
320500         MOVE '4410-READ-TEMP-STORAGE'                            32050000
320600                                 TO DP013-PARAGRAPH               32060000
320700         MOVE 'UNSUCCESSFUL LIST ITEMS TEMP STORAGE QUEUE READ'   32070000
320800                                 TO DP013-MESSAGE-TEXT (1)        32080000
320900                                                                  32090000
321000         PERFORM DP013-0000-PROCESS-ABEND                         32100000
321100     END-IF.                                                      32110000
321200                                                                  32120000
321300     SET ASC-BLOCK-NOT-MODIFIED (ASC-BLK-SUB)                     32130000
321400                                 TO TRUE.                         32140000
321500                                                                  32150000
321600     IF PV-CICS-RESP = DFHRESP (ITEMERR)                          32160000
321700         INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)               32170000
321800     END-IF.                                                      32180000
321900                                                                  32190000
322000 4420-FORMAT-LIST-LINES.                                          32200000
322100                                                                  32210000
322200     IF ASC-ITEM-AT-BOT-OF-PANEL > ASC-NUMBER-OF-ITEMS-READ       32220000
322300         SUBTRACT +1 FROM ASC-ITEM-AT-BOT-OF-PANEL                32230000
322400         MOVE DP015-ASK-DRK-OFF  TO MR-SELECTA       (PV-SUB)     32240000
322500                                    MR-STR-QTY-A     (PV-SUB)     32250000
322600         MOVE DP015-HL-OFF       TO MR-SELECTH (PV-SUB)           32260000
322700                                    MR-STR-QTY-H     (PV-SUB)     32270000
322800         MOVE SPACE              TO MR-SELECTI       (PV-SUB)     32280000
322900                                    MR-STR-QTY       (PV-SUB)     32290000
323000                                    MR-STR-NBR       (PV-SUB)     32300000
323100                                    MR-EXPTED-ITM-QTY(PV-SUB)     32310000
323200                                    MR-ACTUAL-QTY    (PV-SUB)     32320000
323300                                    MR-VERFD-QTY     (PV-SUB)     32330000
323400                                    MR-ACT           (PV-SUB)     32340000
323500                                    MR-SOURCE        (PV-SUB)     32350000
323600                                    MR-P2L-PKSLP     (PV-SUB)     32360000
323700                                    MR-P2L-ACTUAL    (PV-SUB)     32370000
323800                                    MR-CASE-PKSLP    (PV-SUB)     32380000
323900                                    MR-CASE-ACTUAL   (PV-SUB)     32390000
324000     ELSE                                                         32400000
324100         IF ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) >     32410000
324200                                                             SPACE32420000
324300             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 32430000
324400                                 TO MR-SELECTI (PV-SUB)           32440000
324500         ELSE                                                     32450000
324600             MOVE ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      32460000
324700                                 TO MR-SELECTI (PV-SUB)           32470000
324800         END-IF                                                   32480000
324900                                                                  32490000
325000         IF DP030-SET-CURSOR-TRAILER                              32500000
325100            IF ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) >  32510000
325200                                                             SPACE32520000
325300            OR PV-SUB = 1                                         32530000
325400                SET DP030-SET-CURSOR-APPL-1                       32540000
325500                                 TO TRUE                          32550000
325600                MOVE -1          TO MR-SELECTL (PV-SUB)           32560000
325700            END-IF                                                32570000
325800         END-IF                                                   32580000
325900                                                                  32590000
326000*12/29 - BEGIN                                                    32600000
326100         IF  ASC-SEL-ZERO-YES (ASC-BLK-SUB ASC-ITEM-SUB)          32610000
326200             MOVE ASC-STR-QTY (ASC-BLK-SUB ASC-ITEM-SUB)          32620000
326300                                   TO PV-DISPLAY-ZERO             32630000
326400             MOVE PV-DISPLAY-ZERO  TO MR-STR-QTY (PV-SUB)         32640000
326500             MOVE DP015-UNP-ALP-NOR-MDT                           32650000
326600                                   TO MR-STR-QTY-A (PV-SUB)       32660000
326700         ELSE                                                     32670000
326800             MOVE ASC-STR-QTY (ASC-BLK-SUB ASC-ITEM-SUB)          32680000
326900                                   TO PV-DISPLAY-NO-ZERO          32690000
327000             MOVE PV-DISPLAY-NO-ZERO                              32700000
327100                                   TO MR-STR-QTY (PV-SUB)         32710000
327200         END-IF                                                   32720000
327300*12/29 - END                                                      32730000
327400                                                                  32740000
327500         IF PV-TOP-ITEM NOT = ASC-ITEM-AT-TOP-OF-PANEL            32750000
327600                                                                  32760000
327700*12/29 - BEGIN                                                    32770000
327800*12/29       IF ASC-STR-QTY (ASC-BLK-SUB ASC-ITEM-SUB)            32780000
327900*12/29                             = SPACES                       32790000
328000*12/29           MOVE SPACES TO MR-STR-QTY         (PV-SUB)       32800000
328100*12/29       ELSE                                                 32810000
328200*12/29           MOVE ASC-STR-QTY-N  (ASC-BLK-SUB ASC-ITEM-SUB)   32820000
328300*12/29                           TO MR-STR-QTY-EDITED  (PV-SUB)   32830000
328400*12/29       END-IF                                               32840000
328500                                                                  32850000
328600             IF ASC-SEL-ZERO-YES (ASC-BLK-SUB ASC-ITEM-SUB)       32860000
328700                 MOVE ASC-STR-QTY (ASC-BLK-SUB ASC-ITEM-SUB)      32870000
328800                                   TO PV-DISPLAY-ZERO             32880000
328900                 MOVE PV-DISPLAY-ZERO                             32890000
329000                                   TO MR-STR-QTY (PV-SUB)         32900000
329100                 MOVE DP015-UNP-ALP-NOR-MDT                       32910000
329200                                   TO MR-STR-QTY-A (PV-SUB)       32920000
329300             ELSE                                                 32930000
329400                 MOVE ASC-STR-QTY (ASC-BLK-SUB ASC-ITEM-SUB)      32940000
329500                                   TO PV-DISPLAY-NO-ZERO          32950000
329600                 MOVE PV-DISPLAY-NO-ZERO                          32960000
329700                                   TO MR-STR-QTY (PV-SUB)         32970000
329800             END-IF                                               32980000
329900*12/29 - END                                                      32990000
330000                                                                  33000000
330100             IF ASC-PACK-BY-ST-OVERAGE (ASC-BLK-SUB ASC-ITEM-SUB) 33010000
330200                  MOVE DP015-YELLOW    TO MR-STR-QTY-C (PV-SUB)   33020000
330300                                          MR-STR-NBR-C (PV-SUB)   33030000
330400             ELSE                                                 33040000
330500                  MOVE DP015-GREEN     TO MR-STR-QTY-C (PV-SUB)   33050000
330600                  MOVE DP015-BLUE      TO MR-STR-NBR-C (PV-SUB)   33060000
330700             END-IF                                               33070000
330800                                                                  33080000
330900             IF ASC-OVERAGE                                       33090000
331000                  CONTINUE                                        33100000
331100             ELSE                                                 33110000
331200                  SET  ASC-NO-PACK-BY-ST-OVERAGE                  33120000
331300                      (ASC-BLK-SUB ASC-ITEM-SUB)  TO TRUE         33130000
331400             END-IF                                               33140000
331500                                                                  33150000
331600             MOVE ASC-STR-NBR        (ASC-BLK-SUB ASC-ITEM-SUB)   33160000
331700                                 TO MR-STR-NBR         (PV-SUB)   33170000
331800                                    PV-STORE-NUM                  33180000
331900             MOVE ASC-EXPTED-ITM-QTY-N                            33190000
332000                                     (ASC-BLK-SUB ASC-ITEM-SUB)   33200000
332100                                 TO MR-EXPTED-ITM-QTY-EDITED      33210000
332200                                                       (PV-SUB)   33220000
332300             MOVE ASC-ACTUAL-QTY-N  (ASC-BLK-SUB ASC-ITEM-SUB)    33230000
332400                                 TO MR-ACTUAL-QTY-EDITED          33240000
332500                                                 (PV-SUB)         33250000
332600                                                                  33260000
332700*12/29 - BEGIN                                                    33270000
332800             IF ASC-VERFD-QTY (ASC-BLK-SUB ASC-ITEM-SUB) =        33280000
332900                                 SPACES                           33290000
333000                 MOVE SPACES     TO MR-VERFD-QTY(PV-SUB)          33300000
333100                 MOVE ASC-ACT   (ASC-BLK-SUB ASC-ITEM-SUB)        33310000
333200                                 TO MR-ACT (PV-SUB)               33320000
333300             ELSE                                                 33330000
333400                 MOVE ASC-VERFD-QTY-N (ASC-BLK-SUB ASC-ITEM-SUB)  33340000
333500                                 TO MR-VERFD-QTY-EDITED(PV-SUB)   33350000
333600                 MOVE SPACES     TO MR-ACT (PV-SUB)               33360000
333700             END-IF                                               33370000
333800*12/29 - END                                                      33380000
333900                                                                  33390000
334000**********SOURCE IS MANUAL, P2L, OR CASE AND VERIFIED             33400000
334100             IF ASC-KEY-VFY-SRC = PC-MANUAL OR                    33410000
334200              ((ASC-KEY-VFY-SRC = PC-P2L OR PC-CASE)  AND         33420000
334300                ASC-AVERTYP = PC-ACTUAL)                          33430000
334400                 MOVE ASC-KEY-VFY-SRC TO MR-SOURCE  (PV-SUB)      33440000
334500                                         ASC-SOURCE               33450000
334600                                    (ASC-BLK-SUB ASC-ITEM-SUB)    33460000
334700                 MOVE ASC-EXPTED-ITM-QTY-N                        33470000
334800                                    (ASC-BLK-SUB ASC-ITEM-SUB)    33480000
334900                              TO MR-P2L-PKSLP-EDITED  (PV-SUB)    33490000
335000                 IF ASC-KEY-VFY-SRC = PC-CASE AND                 33500000
335100                    ASC-ACTL-NOT-CONFIRMED                        33510000
335200                     MOVE 0   TO MR-P2L-ACTUAL-EDITED (PV-SUB)    33520000
335300                 ELSE                                             33530000
335400                     MOVE ASC-VERFD-QTY-N                         33540000
335500                                        (ASC-BLK-SUB ASC-ITEM-SUB)33550000
335600                              TO MR-P2L-ACTUAL-EDITED (PV-SUB)    33560000
335700                 END-IF                                           33570000
335800                 MOVE SPACES  TO MR-CASE-PKSLP (PV-SUB)           33580000
335900                                 MR-CASE-ACTUAL (PV-SUB)          33590000
336000             ELSE                                                 33600000
336100**********SOURCE IS P2L/CASE AND VERIFIED                         33610000
336200                 IF ASC-KEY-VFY-SRC = PC-P2LCASE AND              33620000
336300                    ASC-AVERTYP = PC-ACTUAL                       33630000
336400                     SET ASC-MORE-RECDVS TO TRUE                  33640000
336500                     MOVE 0 TO PV-RECDVS-COUNT                    33650000
336600                     MOVE SPACES                                  33660000
336700                            TO MR-P2L-PKSLP (PV-SUB)              33670000
336800                               MR-P2L-ACTUAL (PV-SUB)             33680000
336900                               MR-CASE-PKSLP (PV-SUB)             33690000
337000                               MR-CASE-ACTUAL (PV-SUB)            33700000
337100                     PERFORM 7070-OPEN-TRECDVS                    33710000
337200                     PERFORM 4425-PROCESS-TRECDVS                 33720000
337300                        UNTIL ASC-NO-MORE-RECDVS                  33730000
337400                     PERFORM 7080-CLOSE-TRECDVS                   33740000
337500                 ELSE                                             33750000
337600                     PERFORM 7060-GET-TDISTDT                     33760000
337700**********NON VERIFIED, SOURCE OTHER THAN MANUAL                  33770000
337800                     IF SQLCODE = +0                              33780000
337900                         EVALUATE TRUE                            33790000
338000                         WHEN DISTDT-P2L-SPLT-UNT-QTY > 0 AND     33800000
338100                             (DISTDT-FCSE-SPLT-UNT-QTY > 0 OR     33810000
338200                              DISTDT-INPK-SPLT-UNT-QTY > 0)       33820000
338300                             MOVE PC-P2LCASE                      33830000
338400                                 TO MR-SOURCE (PV-SUB)            33840000
338500                             MOVE DISTDT-P2L-SPLT-UNT-QTY         33850000
338600                                 TO MR-P2L-PKSLP-EDITED (PV-SUB)  33860000
338700                             ADD DISTDT-FCSE-SPLT-UNT-QTY         33870000
338800                                TO DISTDT-INPK-SPLT-UNT-QTY       33880000
338900                                   GIVING PV-CASE-PKSLP           33890000
339000                             MOVE PV-CASE-PKSLP                   33900000
339100                                 TO MR-CASE-PKSLP-EDITED (PV-SUB) 33910000
339200                             MOVE DISTDT-ACTL-ALLOC-QTY           33920000
339300                                 TO MR-P2L-ACTUAL-EDITED (PV-SUB) 33930000
339400                             IF ASC-ACTL-CONFIRMED                33940000
339500                                 MOVE DISTDT-FCSE-ACTL-UNT-QTY    33950000
339600                                     TO MR-CASE-ACTUAL-EDITED     33960000
339700                                                         (PV-SUB) 33970000
339800                             ELSE                                 33980000
339900                                 MOVE 0                           33990000
340000                                     TO MR-CASE-ACTUAL-EDITED     34000000
340100                                                         (PV-SUB) 34010000
340200                             END-IF                               34020000
340300                         WHEN DISTDT-P2L-SPLT-UNT-QTY > 0 AND     34030000
340400                              DISTDT-FCSE-SPLT-UNT-QTY = 0 AND    34040000
340500                              DISTDT-INPK-SPLT-UNT-QTY = 0        34050000
340600                             MOVE PC-P2L TO MR-SOURCE (PV-SUB)    34060000
340700                             MOVE DISTDT-P2L-SPLT-UNT-QTY         34070000
340800                                     TO MR-P2L-PKSLP-EDITED       34080000
340900                                                         (PV-SUB) 34090000
341000                             MOVE DISTDT-ACTL-ALLOC-QTY           34100000
341100                                     TO MR-P2L-ACTUAL-EDITED      34110000
341200                                                         (PV-SUB) 34120000
341300                             MOVE 0  TO PV-CASE-PKSLP             34130000
341400                             MOVE SPACES                          34140000
341500                                     TO MR-CASE-PKSLP (PV-SUB)    34150000
341600                                        MR-CASE-ACTUAL (PV-SUB)   34160000
341700                         WHEN DISTDT-P2L-SPLT-UNT-QTY = 0 AND     34170000
341800                             (DISTDT-FCSE-SPLT-UNT-QTY > 0 OR     34180000
341900                              DISTDT-INPK-SPLT-UNT-QTY > 0)       34190000
342000                             MOVE PC-CASE                         34200000
342100                                     TO MR-SOURCE (PV-SUB)        34210000
342200                             ADD DISTDT-FCSE-SPLT-UNT-QTY         34220000
342300                                     TO DISTDT-INPK-SPLT-UNT-QTY  34230000
342400                                         GIVING PV-CASE-PKSLP     34240000
342500** CASE ONLY IS MOVED TO THE LEFT FIELDS WHERE P2L DATA NORMALLY  34250000
342600** IS FOUND. THE HEADING 'CASE' WILL BE ABOVE THE DATA TO CLARIFY 34260000
342700                             IF ASC-KEY-VFY-SRC = PC-CASE         34270000
342800                                 MOVE PV-CASE-PKSLP               34280000
342900                                     TO MR-P2L-PKSLP-EDITED       34290000
343000                                                         (PV-SUB) 34300000
343100                                 IF ASC-ACTL-CONFIRMED            34310000
343200                                     MOVE DISTDT-FCSE-ACTL-UNT-QTY34320000
343300                                         TO MR-P2L-ACTUAL-EDITED  34330000
343400                                                         (PV-SUB) 34340000
343500                                 ELSE                             34350000
343600                                     MOVE 0                       34360000
343700                                         TO MR-P2L-ACTUAL-EDITED  34370000
343800                                                         (PV-SUB) 34380000
343900                                 END-IF                           34390000
344000                                 MOVE SPACES                      34400000
344100                                     TO MR-CASE-PKSLP (PV-SUB)    34410000
344200                                        MR-CASE-ACTUAL (PV-SUB)   34420000
344300                             ELSE                                 34430000
344400                                 MOVE PV-CASE-PKSLP               34440000
344500                                     TO MR-CASE-PKSLP-EDITED      34450000
344600                                                         (PV-SUB) 34460000
344700                                 IF ASC-ACTL-CONFIRMED            34470000
344800                                     MOVE DISTDT-FCSE-ACTL-UNT-QTY34480000
344900                                         TO MR-CASE-ACTUAL-EDITED 34490000
345000                                                          (PV-SUB)34500000
345100                                 ELSE                             34510000
345200                                     MOVE 0                       34520000
345300                                         TO MR-CASE-ACTUAL-EDITED 34530000
345400                                                         (PV-SUB) 34540000
345500                                 END-IF                           34550000
345600                                 MOVE SPACES                      34560000
345700                                     TO MR-P2L-PKSLP (PV-SUB)     34570000
345800                                        MR-P2L-ACTUAL (PV-SUB)    34580000
345900                             END-IF                               34590000
346000******* ALL 0'S THEN TREAT AS MANUAL                              34600000
346100                         WHEN DISTDT-P2L-SPLT-UNT-QTY = 0 AND     34610000
346200                              DISTDT-FCSE-SPLT-UNT-QTY = 0 AND    34620000
346300                              DISTDT-INPK-SPLT-UNT-QTY = 0        34630000
346400                             MOVE PC-MANUAL                       34640000
346500                                 TO MR-SOURCE (PV-SUB)            34650000
346600                                    ASC-SOURCE                    34660000
346700                                        (ASC-BLK-SUB ASC-ITEM-SUB)34670000
346800                             MOVE ASC-EXPTED-ITM-QTY-N            34680000
346900                                        (ASC-BLK-SUB ASC-ITEM-SUB)34690000
347000                                 TO MR-P2L-PKSLP-EDITED  (PV-SUB) 34700000
347100                             MOVE ASC-VERFD-QTY-N                 34710000
347200                                   (ASC-BLK-SUB ASC-ITEM-SUB)     34720000
347300                                 TO MR-P2L-ACTUAL-EDITED (PV-SUB) 34730000
347400                             MOVE 0 TO PV-CASE-PKSLP              34740000
347500                             MOVE SPACES                          34750000
347600                                 TO MR-CASE-PKSLP (PV-SUB)        34760000
347700                                    MR-CASE-ACTUAL (PV-SUB)       34770000
347800                         END-EVALUATE                             34780000
347900                     ELSE                                         34790000
348000******* NO DISTDT ROW THEN TREAT AS MANUAL                        34800000
348100*** DMH  7/10/04         MOVE PC-MANUAL                           34810040
348200                         MOVE ASC-KEY-VFY-SRC                     34820040
348300                                TO MR-SOURCE  (PV-SUB)            34830000
348400                                   ASC-SOURCE                     34840000
348500                                      (ASC-BLK-SUB ASC-ITEM-SUB)  34850000
348600                         MOVE ASC-EXPTED-ITM-QTY-N                34860000
348700                                      (ASC-BLK-SUB ASC-ITEM-SUB)  34870000
348800                                TO MR-P2L-PKSLP-EDITED  (PV-SUB)  34880000
348900                         MOVE ASC-VERFD-QTY-N                     34890000
349000                                      (ASC-BLK-SUB ASC-ITEM-SUB)  34900000
349100                                TO MR-P2L-ACTUAL-EDITED (PV-SUB)  34910000
349200                         MOVE 0 TO PV-CASE-PKSLP                  34920000
349300                         MOVE SPACES                              34930000
349400                                TO MR-CASE-PKSLP (PV-SUB)         34940000
349500                                   MR-CASE-ACTUAL (PV-SUB)        34950000
349600                     END-IF                                       34960000
349700                 END-IF                                           34970000
349800             END-IF                                               34980000
349900         END-IF                                                   34990000
350000         IF ASC-AUTO-VE-YES                                       35000004
350100                                                                  35010027
350200* DMH - 6/17/2004 - BEGIN                                         35020027
350300             IF  ASC-PBS-YES                                      35030029
350400                 IF  ASC-PBS-UPDATE-YES(ASC-BLK-SUB ASC-ITEM-SUB) 35040027
350500                     CONTINUE                                     35050027
350600                 ELSE                                             35060027
350700                     MOVE DP015-ASK-DRK-OFF                       35070027
350800                                        TO MR-STR-QTY-A (PV-SUB)  35080029
350900                 END-IF                                           35090027
351000             ELSE                                                 35100027
351100* DMH - 6/17/2004 - END                                           35110027
351200                                                                  35120027
351300             MOVE DP015-ASK-DRK-OFF TO MR-STR-QTY-A (PV-SUB)      35130004
351400         END-IF                                                   35140004
351500     END-IF.                                                      35150000
351600                                                                  35160000
351700     SUBTRACT +1 FROM ASC-ITEM-SUB.                               35170000
351800                                                                  35180000
351900     IF ASC-ITEM-SUB < +1                                         35190000
352000         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  35200000
352100         MOVE +1                 TO ASC-BLK-SUB                   35210000
352200     END-IF.                                                      35220000
352300                                                                  35230000
352400 4425-PROCESS-TRECDVS.                                            35240000
352500                                                                  35250000
352600         PERFORM 7075-FETCH-RECDVS.                               35260000
352700                                                                  35270000
352800         IF ASC-NO-MORE-RECDVS                                    35280000
352900             IF PV-RECDVS-COUNT = 0                               35290000
353000                MOVE PC-MANUAL TO MR-SOURCE (PV-SUB)              35300000
353100                             ASC-SOURCE (ASC-BLK-SUB ASC-ITEM-SUB)35310000
353200                MOVE ASC-EXPTED-ITM-QTY-N                         35320000
353300                                 (ASC-BLK-SUB ASC-ITEM-SUB)       35330000
353400                               TO MR-P2L-PKSLP-EDITED (PV-SUB)    35340000
353500                MOVE ASC-VERFD-QTY-N (ASC-BLK-SUB ASC-ITEM-SUB)   35350000
353600                               TO MR-P2L-ACTUAL-EDITED (PV-SUB)   35360000
353700             END-IF                                               35370000
353800         ELSE                                                     35380000
353900            MOVE PC-P2LCASE TO MR-SOURCE (PV-SUB)                 35390000
354000            IF RECDVS-VRFY-SRC-CDE = PC-CP                        35400000
354100                MOVE RECDVS-EXPTED-ITM-QTY                        35410000
354200                  TO MR-CASE-PKSLP-EDITED (PV-SUB)                35420000
354300                IF ASC-ACTL-CONFIRMED                             35430000
354400                   MOVE RECDVS-VRFY-ITM-QTY                       35440000
354500                     TO MR-CASE-ACTUAL-EDITED (PV-SUB)            35450000
354600                ELSE                                              35460000
354700                   MOVE 0 TO MR-CASE-ACTUAL-EDITED (PV-SUB)       35470000
354800                END-IF                                            35480000
354900            ELSE                                                  35490000
355000                MOVE RECDVS-EXPTED-ITM-QTY                        35500000
355100                  TO MR-P2L-PKSLP-EDITED (PV-SUB)                 35510000
355200                IF ASC-ACTL-CONFIRMED                             35520000
355300                   MOVE RECDVS-VRFY-ITM-QTY                       35530000
355400                   TO MR-P2L-ACTUAL-EDITED (PV-SUB)               35540000
355500                ELSE                                              35550000
355600                   MOVE 0 TO MR-P2L-ACTUAL-EDITED (PV-SUB)        35560000
355700                END-IF                                            35570000
355800            END-IF                                                35580000
355900         END-IF.                                                  35590000
356000 4430-CHECK-FOR-BEGIN-AND-END.                                    35600000
356100                                                                  35610000
356200     IF ASC-START-OF-SELECTED-RANGE > ZERO                        35620000
356300        IF ASC-END-OF-SELECTED-RANGE = ZERO                       35630000
356400            MOVE PC-TSYMSG-00051 TO DP020-MSG-NUMBER              35640000
356500            SET DP020-MSG-WARNING                                 35650000
356600                                 TO TRUE                          35660000
356700                                                                  35670000
356800            PERFORM 4431-POSITION-AT-WARNING                      35680000
356900                                                                  35690000
357000         END-IF                                                   35700000
357100     ELSE                                                         35710000
357200         IF ASC-END-OF-SELECTED-RANGE > ZERO                      35720000
357300             MOVE PC-TSYMSG-00053                                 35730000
357400                                 TO DP020-MSG-NUMBER              35740000
357500             SET DP020-MSG-WARNING                                35750000
357600                                 TO TRUE                          35760000
357700                                                                  35770000
357800             PERFORM 4431-POSITION-AT-WARNING                     35780000
357900                                                                  35790000
358000         END-IF                                                   35800000
358100     END-IF.                                                      35810000
358200                                                                  35820000
358300 4431-POSITION-AT-WARNING.                                        35830000
358400                                                                  35840000
358500     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE -               35850000
358600                                                  PV-TOP-ITEM + 1.35860000
358700     IF PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                       35870000
358800         CONTINUE                                                 35880000
358900     ELSE                                                         35890000
359000         SET DP030-SET-CURSOR-APPL-1                              35900000
359100                                 TO TRUE                          35910000
359200         MOVE -1                 TO MR-SELECTL (PV-SUB)           35920000
359300         MOVE DP015-YELLOW       TO MR-SELECTC (PV-SUB)           35930000
359400         MOVE DP015-REVERSE      TO MR-SELECTH (PV-SUB)           35940000
359500     END-IF.                                                      35950000
359600                                                                  35960000
359700     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE - PV-TOP-ITEM + 1.35970000
359800                                                                  35980000
359900     IF PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                       35990000
360000         CONTINUE                                                 36000000
360100     ELSE                                                         36010000
360200         SET DP030-SET-CURSOR-APPL-1                              36020000
360300                                 TO TRUE                          36030000
360400         MOVE -1                 TO MR-SELECTL (PV-SUB)           36040000
360500         MOVE DP015-YELLOW       TO MR-SELECTC (PV-SUB)           36050000
360600         MOVE DP015-REVERSE      TO MR-SELECTH (PV-SUB)           36060000
360700     END-IF.                                                      36070000
360800                                                                  36080000
360900 5000-PREPARE-SEL-QUEUE.                                          36090000
361000                                                                  36100000
361100     MOVE ASC-KEY-PO-NBR-N       TO DK-PO-NBR.                    36110048
361200     MOVE ASC-KEY-REC-SEQ-NBR-N  TO DK-REC-SEQ-NBR.               36120048
361300     MOVE ASC-KEY-PKSL-LNE-NBR   TO DK-PKSL-LNE-NBR.              36130048
361400     PERFORM 7030-SELECT-RECITM-DATA.                             36140048
361500     MOVE RECITM-STATUS-CDE   TO ASC-RECITM-STATUS-CDE            36150048
361600     MOVE +1                     TO ASC-BLK-SUB.                  36160000
361700                                                                  36170000
361800     PERFORM 5100-WRITE-TEMP-STORAGE.                             36180000
361900                                                                  36190000
362000     ADD +1                      TO ASC-BLK-SUB.                  36200000
362100                                                                  36210000
362200     PERFORM 5100-WRITE-TEMP-STORAGE.                             36220000
362300                                                                  36230000
362400     MOVE ASC-SEL-QUEUE-NAME-OUT TO RC015-SEL-QUEUE-NAME.         36240000
362500                                                                  36250000
362600     PERFORM 6010-DELETE-SEL-QUEUE.                               36260000
362700                                                                  36270000
362800     SET ASC-UPDATE-TSQ          TO TRUE.                         36280000
362900     SET RC013-IDX               TO 1.                            36290000
363000     MOVE ZERO                   TO RC015-NUMBER-OF-TS-ITEMS.     36300000
363100     INITIALIZE RC013-SELECTED-ITEM-ARRAY.                        36310000
363200                                                                  36320000
363300     EVALUATE TRUE                                                36330000
363400         WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              36340000
363500         WHEN  DP020-FK-CONFIRM(DP020-SRC-AID)                    36350000
363600             SET ASC-NO-OVERAGE TO TRUE                           36360000
363700             SET ASC-DONT-CONFIRM-UPDATE TO TRUE                  36370000
363800             MOVE ASC-KEY-PO-NBR-N                                36380000
363900                                 TO DK-PO-NBR                     36390000
364000             MOVE ASC-KEY-PKSL-LNE-NBR                            36400000
364100                                 TO DK-PKSL-LNE-NBR               36410000
364200             MOVE ASC-KEY-REC-SEQ-NBR-N                           36420000
364300                                 TO DK-REC-SEQ-NBR                36430000
364400                                                                  36440000
364500             PERFORM 5310-SEARCH-FOR-SELECTION                    36450000
364600                 VARYING PV-ITEM  FROM 1 BY 1                     36460000
364700                 UNTIL   PV-ITEM > ASC-HIGHEST-BLOCK-WRITTEN      36470000
364800                                                                  36480000
364900*  COMMENTED OUT THE FOLLOWING 2 LINES OF CODE TO ENSURE THAT    36490001
365000*  THE 8500 PARAGRAPH IS CALLED AT ALL TIMES TO INTERFACE         36500001
365100*  RECEIPTS TO RMS PO                                             36510001
365200*  RPK - 11/28/2003                                               36520001
365300             IF  PS-TRECDIS-UPDATE-DONE                           36530000
365400*                IF  PA-ACCUM-UPDATE-QTY NOT EQUAL TO ZERO        36540001
365500                     PERFORM 8500-PROCESS-UNITS-WORK              36550000
365600*                END-IF                                           36560001
365700             END-IF                                               36570000
365800*  RPK - 11/28/2003                                               36580001
365900                                                                  36590000
366000             IF  ASC-PURITM-UNT-QTY GREATER THAN ZERO             36600000
366100                 IF RECITM-STATUS-CDE = PC-VE                     36610000
366200                     PERFORM 5800-CHECK-PO-STATUS                 36620000
366300                 END-IF                                           36630000
366400             END-IF                                               36640000
366500             MOVE PC-TSYMSG-00059                                 36650000
366600                                 TO DP020-MSG-NUMBER              36660000
366700             SET DP020-MSG-INFORMATIONAL                          36670000
366800                                 TO TRUE                          36680000
366900             PERFORM 9000-UPDATE-SELECTION-QUEUE                  36690000
367000                                                                  36700000
367100             INITIALIZE ASC-BLOCK-ENTRIES (1)                     36710000
367200                        ASC-BLOCK-ENTRIES (2)                     36720000
367300             MOVE +1             TO ASC-BLK-SUB                   36730000
367400                                                                  36740000
367500             MOVE ZERO           TO ASC-ITEM-SUB                  36750000
367600                                    ASC-NUMBER-OF-SELECTED-ITEMS  36760000
367700                                    ASC-START-OF-SELECTED-RANGE   36770000
367800                                    ASC-END-OF-SELECTED-RANGE     36780000
367900                                    ASC-ITEM-AT-TOP-OF-PANEL      36790000
368000                                                                  36800000
368100             PERFORM 4410-READ-TEMP-STORAGE                       36810000
368200             PERFORM 3200-RESET-ATTRIBUTES                        36820020
368300             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 36830000
368400                                                                  36840000
368500         WHEN OTHER                                               36850000
368600             PERFORM 5200-FILL-SEL-QUEUE-RECORD                   36860000
368700                 VARYING PV-ITEM  FROM 1 BY 1                     36870000
368800                 UNTIL   PV-ITEM > ASC-HIGHEST-BLOCK-WRITTEN      36880000
368900                                                                  36890000
369000     END-EVALUATE.                                                36900000
369100                                                                  36910000
369200     IF RC013-IDX > 1                                             36920000
369300         PERFORM 5205-WRITE-SEL-QUEUE                             36930000
369400         ADD +1                  TO RC015-NUMBER-OF-TS-ITEMS      36940000
369500     END-IF.                                                      36950000
369600                                                                  36960000
369700 5005-PREPARE-SEL-QUEUE.                                          36970000
369800                                                                  36980000
369900     MOVE +1                     TO ASC-BLK-SUB.                  36990000
370000                                                                  37000000
370100     PERFORM 5100-WRITE-TEMP-STORAGE.                             37010000
370200                                                                  37020000
370300     ADD +1                      TO ASC-BLK-SUB.                  37030000
370400                                                                  37040000
370500     PERFORM 5100-WRITE-TEMP-STORAGE.                             37050000
370600                                                                  37060000
370700     MOVE ASC-SEL-QUEUE-NAME-OUT TO RC015-SEL-QUEUE-NAME.         37070000
370800                                                                  37080000
370900     PERFORM 6010-DELETE-SEL-QUEUE.                               37090000
371000                                                                  37100000
371100     SET ASC-UPDATE-TSQ          TO TRUE.                         37110000
371200     SET RC013-IDX               TO 1.                            37120000
371300     MOVE ZERO                   TO RC015-NUMBER-OF-TS-ITEMS.     37130000
371400     INITIALIZE RC013-SELECTED-ITEM-ARRAY.                        37140000
371500                                                                  37150000
371600     EVALUATE TRUE                                                37160000
371700         WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              37170000
371800             MOVE ASC-KEY-PO-NBR-N                                37180000
371900                                 TO DK-PO-NBR                     37190000
372000             MOVE ASC-KEY-PKSL-LNE-NBR                            37200000
372100                                 TO DK-PKSL-LNE-NBR               37210000
372200             MOVE ASC-KEY-REC-SEQ-NBR-N                           37220000
372300                                 TO DK-REC-SEQ-NBR                37230000
372400                                                                  37240000
372500             PERFORM 5305-SEARCH-FOR-SELECTION                    37250000
372600                 VARYING PV-ITEM  FROM 1 BY 1                     37260000
372700                 UNTIL   PV-ITEM > ASC-HIGHEST-BLOCK-WRITTEN      37270000
372800                                                                  37280000
372900                                                                  37290000
373000             INITIALIZE ASC-BLOCK-ENTRIES (1)                     37300000
373100                        ASC-BLOCK-ENTRIES (2)                     37310000
373200             MOVE +1             TO ASC-BLK-SUB                   37320000
373300                                                                  37330000
373400             MOVE ZERO           TO ASC-ITEM-SUB                  37340000
373500                                    ASC-START-OF-SELECTED-RANGE   37350000
373600                                    ASC-END-OF-SELECTED-RANGE     37360000
373700                                    ASC-ITEM-AT-TOP-OF-PANEL      37370000
373800                                                                  37380000
373900             PERFORM 4410-READ-TEMP-STORAGE                       37390000
374000             PERFORM 3200-RESET-ATTRIBUTES                        37400020
374100             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 37410000
374200                                                                  37420000
374300         WHEN OTHER                                               37430000
374400             PERFORM 5200-FILL-SEL-QUEUE-RECORD                   37440000
374500                 VARYING PV-ITEM  FROM 1 BY 1                     37450000
374600                 UNTIL   PV-ITEM > ASC-HIGHEST-BLOCK-WRITTEN      37460000
374700                                                                  37470000
374800     END-EVALUATE.                                                37480000
374900                                                                  37490000
375000                                                                  37500000
375100 5100-WRITE-TEMP-STORAGE.                                         37510000
375200                                                                  37520000
375300     MOVE ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB 1)                    37530000
375400                                 TO PV-LIST-ITEM-NUMBER.          37540000
375500     COMPUTE PV-BLOCK-NUMBER = 1 +                                37550000
375600                 ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).37560000
375700                                                                  37570000
375800     IF PV-BLOCK-NUMBER NOT > ASC-HIGHEST-BLOCK-WRITTEN           37580000
375900        IF ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                       37590000
376000                                                                  37600000
376100            PERFORM 5105-REWRITE-ASC-LISTQ                        37610000
376200                                                                  37620000
376300        END-IF                                                    37630000
376400     ELSE                                                         37640000
376500         COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                       37650000
376600                                     ASC-HIGHEST-BLOCK-WRITTEN + 137660000
376700         PERFORM 5110-WRITE-ASC-LISTQ                             37670000
376800                                                                  37680000
376900         ADD +1                  TO ASC-HIGHEST-BLOCK-WRITTEN     37690000
377000     END-IF.                                                      37700000
377100                                                                  37710000
377200     SET ASC-BLOCK-NOT-MODIFIED (ASC-BLK-SUB)                     37720000
377300                                 TO TRUE.                         37730000
377400                                                                  37740000
377500 5105-REWRITE-ASC-LISTQ.                                          37750000
377600                                                                  37760000
377700     EXEC CICS WRITEQ TS                                          37770000
377800               QUEUE   (ASC-LIST-QUEUE-NAME)                      37780000
377900               FROM    (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))           37790000
378000               ITEM    (PV-BLOCK-NUMBER)                          37800000
378100               REWRITE                                            37810000
378200               RESP    (PV-CICS-RESP)                             37820000
378300     END-EXEC.                                                    37830000
378400                                                                  37840000
378500     IF PV-CICS-RESP NOT = DFHRESP (NORMAL)                       37850000
378600         SET DP013-CICS-ABEND                                     37860000
378700             DP013-NO-ROLLBACK   TO TRUE                          37870000
378800         MOVE '5105-REWRITE-ASC-LISTQ'                            37880000
378900                                 TO DP013-PARAGRAPH               37890000
379000         MOVE 'UNSUCCESSFUL LIST ITEMS TEMP STORAGE QUEUE REWRITE'37900000
379100                                 TO DP013-MESSAGE-TEXT (1)        37910000
379200         PERFORM DP013-0000-PROCESS-ABEND                         37920000
379300     END-IF.                                                      37930000
379400                                                                  37940000
379500 5110-WRITE-ASC-LISTQ.                                            37950000
379600                                                                  37960000
379700     EXEC CICS WRITEQ TS                                          37970000
379800               QUEUE (ASC-LIST-QUEUE-NAME)                        37980000
379900               FROM  (ASC-BLOCK-ENTRIES (ASC-BLK-SUB))            37990000
380000               ITEM  (PV-BLOCK-NUMBER)                            38000000
380100               RESP  (PV-CICS-RESP)                               38010000
380200     END-EXEC.                                                    38020000
380300                                                                  38030000
380400     IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                      38040000
380500         SET DP013-CICS-ABEND                                     38050000
380600             DP013-NO-ROLLBACK   TO TRUE                          38060000
380700         MOVE '5110-WRITE-ASC-LISTQ'                              38070000
380800                                 TO DP013-PARAGRAPH               38080000
380900         MOVE 'UNSUCCESSFUL LIST ITEMS TEMP STORAGE QUEUE WRITE'  38090000
381000                                 TO DP013-MESSAGE-TEXT (1)        38100000
381100         PERFORM DP013-0000-PROCESS-ABEND                         38110000
381200     END-IF.                                                      38120000
381300                                                                  38130000
381400 5200-FILL-SEL-QUEUE-RECORD.                                      38140000
381500                                                                  38150000
381600     PERFORM 6112-READ-LIST-QUEUE.                                38160000
381700                                                                  38170000
381800     IF PV-CICS-RESP = DFHRESP (NORMAL)                           38180000
381900         PERFORM                                                  38190000
382000         VARYING LQW-IDX  FROM 1 BY 1                             38200000
382100         UNTIL   LQW-IDX > PC-ITEMS-PER-PANEL OR                  38210000
382200                 LQW-LIST-ITEM-NUMBER (LQW-IDX) = ZERO            38220000
382300                 MOVE SPACE      TO RC013-ACTION-SW  (RC013-IDX)  38230000
382400                 SET RC013-IDX UP BY 1                            38240000
382500                 IF RC013-IDX > RC013-MAX-ITEMS                   38250000
382600                                                                  38260000
382700                     PERFORM 5205-WRITE-SEL-QUEUE                 38270000
382800                                                                  38280000
382900                     ADD +1      TO RC015-NUMBER-OF-TS-ITEMS      38290000
383000                     INITIALIZE RC013-SELECTED-ITEM-ARRAY         38300000
383100                     SET RC013-IDX                                38310000
383200                                 TO 1                             38320000
383300                 END-IF                                           38330000
383400         END-PERFORM                                              38340000
383500     END-IF.                                                      38350000
383600                                                                  38360000
383700 5205-WRITE-SEL-QUEUE.                                            38370000
383800                                                                  38380000
383900     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            38390000
384000                                 TO RC013-SELECTED-ITEMS.         38400000
384100                                                                  38410000
384200     EXEC CICS WRITEQ TS                                          38420000
384300               QUEUE (ASC-SEL-QUEUE-NAME-OUT)                     38430000
384400               FROM  (RC013-DC-SELECT-RECORD)                     38440000
384500               ITEM  (PV-SEL-QUEUE-ITEM)                          38450000
384600               RESP  (PV-CICS-RESP)                               38460000
384700     END-EXEC.                                                    38470000
384800                                                                  38480000
384900     IF PV-CICS-RESP NOT = DFHRESP (NORMAL)                       38490000
385000         SET DP013-CICS-ABEND                                     38500000
385100             DP013-NO-ROLLBACK   TO TRUE                          38510000
385200         MOVE '5205-WRITE-SEL-QUEUE'                              38520000
385300                                 TO DP013-PARAGRAPH               38530000
385400         MOVE 'UNSUCCESSFUL SEL ITEMS TEMP STORAGE QUEUE WRITE'   38540000
385500                                 TO DP013-MESSAGE-TEXT (1)        38550000
385600         PERFORM DP013-0000-PROCESS-ABEND                         38560000
385700     END-IF.                                                      38570000
385800                                                                  38580000
385900 5305-SEARCH-FOR-SELECTION.                                       38590000
386000                                                                  38600000
386100     PERFORM 6112-READ-LIST-QUEUE.                                38610000
386200                                                                  38620000
386300     IF PV-CICS-RESP = DFHRESP (NORMAL)                           38630000
386400         PERFORM                                                  38640000
386500         VARYING LQW-IDX  FROM 1 BY 1                             38650000
386600         UNTIL   LQW-IDX > PC-ITEMS-PER-PANEL OR                  38660000
386700                 LQW-LIST-ITEM-NUMBER (LQW-IDX) = ZERO            38670000
386800                                                                  38680000
386900             IF LQW-SELECT (LQW-IDX)                              38690000
387000                 MOVE LQW-STR-NBR (LQW-IDX)                       38700000
387100                                 TO RECDIS-STR-NBR                38710000
387200                 MOVE LQW-STR-QTY (LQW-IDX) TO                    38720000
387300                    PV-EXPECTED-QTY                               38730000
387400                 PERFORM 7200-SELECT-RECDIS                       38740000
387500                 IF PV-EXPECTED-QTY                               38750000
387600                                > RECDIS-EXPTED-ITM-QTY           38760000
387700                       SET  LQW-PACK-BY-ST-OVERAGE (LQW-IDX)      38770000
387800                                  TO TRUE                         38780000
387900                       SET ASC-OVERAGE  TO TRUE                   38790000
388000                 END-IF                                           38800000
388100                                                                  38810000
388200                                                                  38820000
388300                 ADD +1          TO RC015-NUMBER-OF-TS-ITEMS      38830000
388400                 MOVE LQW-SELECTED-SW (LQW-IDX)                   38840000
388500                                 TO LQW-TEMP-SELECTED-SW (LQW-IDX)38850000
388600             END-IF                                               38860000
388700         END-PERFORM                                              38870000
388800     END-IF.                                                      38880000
388900                                                                  38890000
389000     MOVE PV-ITEM                TO PV-SAVE-ITEM.                 38900000
389100     PERFORM 6111-WRITE-LIST-QUEUE.                               38910000
389200                                                                  38920000
389300 5310-SEARCH-FOR-SELECTION.                                       38930000
389400                                                                  38940000
389500     PERFORM 6112-READ-LIST-QUEUE.                                38950000
389600                                                                  38960000
389700     IF PV-CICS-RESP = DFHRESP (NORMAL)                           38970000
389800         PERFORM                                                  38980000
389900         VARYING LQW-IDX  FROM 1 BY 1                             38990000
390000         UNTIL   LQW-IDX > PC-ITEMS-PER-PANEL OR                  39000000
390100                 LQW-LIST-ITEM-NUMBER (LQW-IDX) = ZERO            39010000
390200                                                                  39020000
390300             IF LQW-SELECT (LQW-IDX)                              39030000
390400                 MOVE LQW-STR-NBR (LQW-IDX)                       39040000
390500                                 TO RECDIS-STR-NBR                39050000
390600                 SET PS-DONT-UPDATE-TRECITM TO TRUE               39060000
390700                                                                  39070000
390800                 PERFORM 7200-SELECT-RECDIS                       39080000
390900                 PERFORM 5505-ADD-TO-RECD-AUDIT-BEFORE            39090000
391000                 PERFORM 5311-APPLY-STR-QTY                       39100000
391100                 PERFORM 7210-UPDATE-RECDIS                       39110000
391200                                                                  39120000
391300                 IF PS-UPDATE-TRECITM                             39130000
391400                     PERFORM 5600-UPDATE-TRECITM                  39140000
391500                 END-IF                                           39150000
391600                                                                  39160000
391700                 ADD +1          TO RC015-NUMBER-OF-TS-ITEMS      39170000
391800                 SET LQW-UPDATE (LQW-IDX)                         39180000
391900                                 TO TRUE                          39190000
392000                 SET LQW-DESELECT (LQW-IDX)                       39200000
392100                                 TO TRUE                          39210000
392200                 MOVE LQW-SELECTED-SW (LQW-IDX)                   39220000
392300                                 TO LQW-TEMP-SELECTED-SW (LQW-IDX)39230000
392400                 SUBTRACT 1    FROM ASC-NUMBER-OF-SELECTED-ITEMS  39240000
392500             END-IF                                               39250000
392600         END-PERFORM                                              39260000
392700     END-IF.                                                      39270000
392800                                                                  39280000
392900     MOVE PV-ITEM                TO PV-SAVE-ITEM.                 39290000
393000     PERFORM 6111-WRITE-LIST-QUEUE.                               39300000
393100                                                                  39310000
393200 5311-APPLY-STR-QTY.                                              39320000
393300     EVALUATE TRUE                                                39330000
393400     WHEN ASC-RECITM-STATUS-CDE = PC-VE                           39340000
393500                                                                  39350000
393600         SUBTRACT RECDIS-VERIFY-ITM-QTY                           39360000
393700                                 FROM ASC-TOT-ACTUAL-QTY          39370000
393800                                      ASC-TOT-VERIFY-QTY          39380000
393900         MOVE LQW-VERFD-QTY (LQW-IDX)                             39390000
394000                         TO PA-UPDATE-FROM-QTY                    39400000
394100         MOVE LQW-STR-QTY (LQW-IDX)                               39410000
394200                                 TO RECDIS-VERIFY-ITM-QTY         39420000
394300                                    RECDIS-AP-VERIFY-ITM-QTY      39430000
394400                                    LQW-VERFD-QTY (LQW-IDX)       39440000
394500                                    LQW-ACTUAL-QTY (LQW-IDX)      39450000
394600                                    PA-UPDATE-TO-QTY              39460000
394700         SUBTRACT PA-UPDATE-FROM-QTY                              39470000
394800             FROM PA-UPDATE-TO-QTY                                39480000
394900           GIVING PA-UPDATE-DIFF-QTY                              39490000
395000         ADD PA-UPDATE-DIFF-QTY TO                                39500000
395100             PA-ACCUM-UPDATE-QTY                                  39510000
395200         SET PS-TRECDIS-UPDATE-DONE TO TRUE                       39520000
395300         ADD RECDIS-VERIFY-ITM-QTY                                39530000
395400                                 TO ASC-TOT-ACTUAL-QTY            39540000
395500                                    ASC-TOT-VERIFY-QTY            39550000
395600                                                                  39560000
395700         IF ASC-TOT-ACTUAL-QTY < ZERO                             39570000
395800            MOVE ZERO            TO ASC-TOT-ACTUAL-QTY            39580000
395900         END-IF                                                   39590000
396000         IF ASC-TOT-VERIFY-QTY < ZERO                             39600000
396100            MOVE ZERO            TO ASC-TOT-VERIFY-QTY            39610000
396200         END-IF                                                   39620000
396300                                                                  39630000
396400* DMH 4/18/04 - BEGIN                                             39640000
396500         MOVE  ASC-KEY-PO-NBR-N        TO PC241-PO-NBR            39650000
396600         MOVE  ASC-KEY-PKSL-LNE-NBR    TO PC241-PO-LNE-NBR        39660000
396700         MOVE  ASC-KEY-REC-SEQ-NBR-N   TO PC241-REC-SEQ-NBR       39670000
396800         MOVE  ASC-KEY-OPER-UNT-ID     TO PC241-OPER-UNT-ID       39680000
396900         MOVE  ASC-KEY-FCLTY-ID        TO PC241-FCLTY-ID          39690000
397000         MOVE  LQW-STR-NBR (LQW-IDX)   TO PC241-STR-NBR           39700000
397100         MOVE  PA-UPDATE-DIFF-QTY      TO PC241-STR-ADJ-QTY       39710000
397200         ADD   1                       TO PV-VRFY-ITEM            39720000
397300         PERFORM 6150-WRITE-VRFY-ADJ-QUEUE                        39730000
397400* DMH 4/18/04 - END                                               39740000
397500                                                                  39750000
397600     WHEN ASC-RECITM-STATUS-CDE = PC-IP                           39760000
397700                                                                  39770000
397800         SUBTRACT RECDIS-VERIFY-ITM-QTY                           39780000
397900                                 FROM ASC-TOT-ACTUAL-QTY          39790000
398000         MOVE LQW-STR-QTY (LQW-IDX)                               39800000
398100                                 TO RECDIS-VERIFY-ITM-QTY         39810000
398200                                    LQW-ACTUAL-QTY (LQW-IDX)      39820000
398300         ADD RECDIS-VERIFY-ITM-QTY                                39830000
398400                                 TO ASC-TOT-ACTUAL-QTY            39840000
398500                                                                  39850000
398600         IF ASC-TOT-ACTUAL-QTY < ZERO                             39860000
398700            MOVE ZERO            TO ASC-TOT-ACTUAL-QTY            39870000
398800         END-IF                                                   39880000
398900                                                                  39890000
399000     END-EVALUATE.                                                39900000
399100/                                                                 39910000
399200 5505-ADD-TO-RECD-AUDIT-BEFORE.                                   39920000
399300     IF  PS-DATA-OK                                               39930000
399400         MOVE 'D'                     TO RC031-TABLE-TO-AUDIT     39940000
399500         MOVE 'B'                     TO RC031-AUD-TYP-CDE        39950000
399600         MOVE 'U'                     TO RC031-AUD-FUNC-CDE       39960000
399700         MOVE ASC-KEY-OPER-UNT-ID     TO RC031-OPER-UNT-ID        39970000
399800         MOVE ASC-KEY-FCLTY-ID        TO RC031-FCLTY-ID           39980000
399900         MOVE DK-PO-NBR               TO RC031-PO-NBR             39990000
400000         MOVE DK-REC-SEQ-NBR          TO RC031-REC-SEQ-NBR        40000000
400100         MOVE DK-PKSL-LNE-NBR         TO RC031-PO-LNE-NBR         40010000
400200         MOVE RECDIS-STR-NBR          TO RC031-STR-NBR            40020000
400300         MOVE PC-CURRENT-PROGRAM-NAME TO RC031-UPD-PGM-ID         40030000
400400         MOVE DP020-USERID            TO RC031-UPD-UID            40040000
400500         MOVE PV-CURRENT-TIMESTAMP    TO RC031-UPD-TMST           40050000
400600                                                                  40060000
400700         EXEC CICS                                                40070000
400800              LINK PROGRAM  (PC-AUDIT-RTN)                        40080000
400900              COMMAREA (RC031-FIELDS)                             40090000
401000              LENGTH   (PC-AUDIT-RTN-LENGTH)                      40100000
401100         END-EXEC                                                 40110000
401200                                                                  40120000
401300         EVALUATE TRUE                                            40130000
401400             WHEN RC031-CALL-SUCCESSFUL                           40140000
401500                 CONTINUE                                         40150000
401600             WHEN OTHER                                           40160000
401700                 MOVE '5505-ADD-TO-RECD-AUDIT-BEFORE'             40170000
401800                                     TO DP013-PARAGRAPH           40180000
401900                 MOVE 'UNSUCCESSFUL CALL TO AUDIT RTN'            40190000
402000                                     TO DP013-MESSAGE-TEXT (1)    40200000
402100                 MOVE RC031-RETURN-DESC                           40210000
402200                                     TO DP013-MESSAGE-TEXT (2)    40220000
402300                 MOVE RC031-SQLCA    TO DP013-SQLCA               40230000
402400                 SET DP013-DB2-ABEND                              40240000
402500                     DP013-XCTL-DISPLAY-RESTART                   40250000
402600                                     TO TRUE                      40260000
402700                 PERFORM DP013-0000-PROCESS-ABEND                 40270000
402800         END-EVALUATE                                             40280000
402900     END-IF.                                                      40290000
403000                                                                  40300000
403100/                                                                 40310000
403200 5600-UPDATE-TRECITM.                                             40320000
403300                                                                  40330000
403400     SET PS-DATA-OK          TO  TRUE.                            40340000
403500     PERFORM 7400-SELECT-TRECITM.                                 40350000
403600     IF RECITM-RCPT-DISTR-UPD-CDE = 'U'                           40360000
403700        OR RECITM-RCPT-DISTR-UPD-CDE = 'A'                        40370000
403800         CONTINUE                                                 40380000
403900     ELSE                                                         40390000
404000         PERFORM 5610-PROCESS-TRECITM                             40400000
404100     END-IF.                                                      40410000
404200                                                                  40420000
404300 5610-PROCESS-TRECITM.                                            40430000
404400     MOVE 'I'                   TO RC031-TABLE-TO-AUDIT.          40440000
404500     MOVE 'B'                   TO RC031-AUD-TYP-CDE.             40450000
404600     MOVE 'U'                   TO RC031-AUD-FUNC-CDE.            40460000
404700     MOVE ASC-KEY-OPER-UNT-ID   TO RC031-OPER-UNT-ID.             40470000
404800     MOVE ASC-KEY-FCLTY-ID      TO RC031-FCLTY-ID.                40480000
404900     MOVE DK-PO-NBR             TO RC031-PO-NBR.                  40490000
405000     MOVE DK-REC-SEQ-NBR        TO RC031-REC-SEQ-NBR.             40500000
405100     MOVE DK-PKSL-LNE-NBR       TO RC031-PO-LNE-NBR.              40510000
405200     MOVE PC-CURRENT-PROGRAM-NAME                                 40520000
405300                                TO RC031-UPD-PGM-ID.              40530000
405400                                                                  40540000
405500     EXEC CICS                                                    40550000
405600          LINK PROGRAM  (PC-AUDIT-RTN)                            40560000
405700          COMMAREA (RC031-FIELDS)                                 40570000
405800          LENGTH   (PC-AUDIT-RTN-LENGTH)                          40580000
405900     END-EXEC.                                                    40590000
406000                                                                  40600000
406100     EVALUATE TRUE                                                40610000
406200         WHEN RC031-CALL-SUCCESSFUL                               40620000
406300             CONTINUE                                             40630000
406400         WHEN OTHER                                               40640000
406500             MOVE '5610-PROCESS-TRECITM'                          40650000
406600                                 TO DP013-PARAGRAPH               40660000
406700             MOVE 'UNSUCCESSFUL CALL TO AUDIT RTN'                40670000
406800                                 TO DP013-MESSAGE-TEXT (1)        40680000
406900             MOVE RC031-RETURN-DESC                               40690000
407000                                 TO DP013-MESSAGE-TEXT (2)        40700000
407100             MOVE RC031-SQLCA    TO DP013-SQLCA                   40710000
407200             SET DP013-DB2-ABEND                                  40720000
407300                 DP013-XCTL-DISPLAY-RESTART                       40730000
407400                                 TO TRUE                          40740000
407500             PERFORM DP013-0000-PROCESS-ABEND                     40750000
407600     END-EVALUATE.                                                40760000
407700                                                                  40770000
407800     IF  PS-DATA-OK                                               40780000
407900         MOVE PC-A               TO                               40790000
408000                                       PV-RCPT-DISTR-UPD-CDE      40800000
408100         PERFORM 7410-UPDATE-TRECITM                              40810000
408200     END-IF.                                                      40820000
408300/                                                                 40830000
408400*----------------------------------------------------------------*40840000
408500*    SINCE THE RECDIS VERIFY QUANTITY HAS CHANGED, WE MUST       *40850000
408600*    CHECK IF IT IS NOW LESS THAN PURITM.  IF SO, RESET THE      *40860000
408700*    STATUS CODE TO IP AND CHECK THE PURCHS ROW.                 *40870000
408800*----------------------------------------------------------------*40880000
408900                                                                  40890000
409000 5800-CHECK-PO-STATUS.                                            40900000
409100                                                                  40910000
409200     PERFORM 7220-GET-RECDIS-QTY.                                 40920000
409300                                                                  40930000
409400     IF (ASC-PURITM-UNT-QTY GREATER RECDIS-AP-VERIFY-ITM-QTY      40940000
409500     AND ASC-PURITM-STATUS-CDE EQUAL PC-CM)                       40950000
409600         MOVE PC-AC               TO  ASC-PURITM-STATUS-CDE       40960000
409700         PERFORM 5830-UPDATE-PURITM-STATUS                        40970000
409800         IF  ASC-PURCHS-STATUS-CDE EQUAL PC-CM                    40980000
409900             MOVE PC-AC           TO  ASC-PURCHS-STATUS-CDE       40990000
410000***          PERFORM 5850-UPDATE-PURCHS-STATUS                    41000003
410100         END-IF                                                   41010000
410200     ELSE                                                         41020000
410300         IF (ASC-PURITM-UNT-QTY NOT > RECDIS-AP-VERIFY-ITM-QTY    41030000
410400         AND ASC-PURITM-STATUS-CDE NOT EQUAL PC-CM)               41040000
410500             MOVE PC-CM           TO  ASC-PURITM-STATUS-CDE       41050000
410600             PERFORM 5830-UPDATE-PURITM-STATUS                    41060000
410700             IF  ASC-PURCHS-STATUS-CDE NOT EQUAL PC-CM            41070000
410800                 MOVE PC-CM       TO  ASC-PURCHS-STATUS-CDE       41080000
410900***              PERFORM 5850-UPDATE-PURCHS-STATUS                41090003
411000             END-IF                                               41100000
411100         END-IF                                                   41110000
411200     END-IF.                                                      41120000
411300/                                                                 41130000
411400/                                                                 41140000
411500*----------------------------------------------------------------*41150000
411600*    TO UPDATE THE PURCHASE ITEM ROW, WE REALLY MAKE THE CURRENT *41160000
411700*    ROW INACTIVE AND INSERT A NEW ROW WITH AN ACTIVE STATUS.    *41170000
411800*                                                                *41180000
411900*    ** NOTE **                                                  *41190000
412000*    WE WILL NOT BE MAKING THE CURRENT ROW ACTIVE AND INSERTING  *41200000
412100*    A NEW ROW WITH AN ACTIVE STATUS FOR PUCHASE ITEM ROWS ON    *41210000
412200*    PURCHASE ORDERS THAT ARE IN RMS.                            *41220000
412300*----------------------------------------------------------------*41230000
412400                                                                  41240000
412500 5830-UPDATE-PURITM-STATUS.                                       41250000
412600                                                                  41260000
412700     PERFORM 7500-GET-PURITM.                                     41270000
412800     IF  SQLCODE EQUAL ZERO                                       41280000
412900     AND PURITM-STATUS-CDE NOT = PC-RV                            41290000
413000         IF ASC-PURITM-STATUS-CDE = PC-AC                         41300000
413100             MOVE ASC-DEPT-NBR      TO PV-DEPT-NBR-X              41310000
413200             MOVE PV-DEPT-NBR       TO PV-DEPT-NBR-KEY            41320000
413300             SET PS-NO-RMS-PO       TO TRUE                       41330000
413400*** CHECK IF THIS IS AN RMS PO.  IF IT IS, WE DO NOT WANT TO      41340000
413500*** VERSION THE TPURITM ROWS; WE JUST WANT TO UPDATE THE ROW.     41350000
413600             PERFORM 7650-CHECK-FOR-RMS-PO                        41360000
413700             IF PV-DB2-COUNT > ZERO                               41370000
413800                 SET PS-RMS-PO      TO TRUE                       41380000
413900                 PERFORM 7530-ONLY-UPDATE-PURITM                  41390000
414000             ELSE                                                 41400000
414100                 PERFORM 7510-UPDATE-PURITM                       41410000
414200                 ADD 1              TO  PURITM-VER-NBR            41420000
414300                 PERFORM 7520-INSERT-PURITM                       41430000
414400             END-IF                                               41440000
414500          ELSE                                                    41450000
414600             PERFORM 7530-ONLY-UPDATE-PURITM                      41460000
414700          END-IF                                                  41470000
414800     END-IF.                                                      41480000
414900*----------------------------------------------------------------*41490000
415000*    HERE, WE CHECK IF ALL PURCHASE ITEM LINES ARE EQUAL TO      *41500000
415100*    'CM' 'CB' OR 'CA' IF WE ARE TRYING TO CHANGE THE PURCHASE   *41510000
415200*    HEADER TO 'CM'.  OTHERWISE, JUST UPDATE THE PO HEADER TO    *41520000
415300*    A STATUS OF 'AC' WITH NO CHECK ON PURITM.                   *41530000
415400*                                                                *41540000
415500* ** 06/02/2003 CHANGE **                                        *41550000
415600*    CHECK IF THIS IS AN RMS PO.  IF IT IS, WE DO NOT WANT TO    *41560000
415700*    UPDATE THE PURCHASE ORDER TABLE.  THIS TABLE WILL GET       *41570000
415800*    UPDATED THROUGH AN RMS PROCESS.                             *41580000
415900*----------------------------------------------------------------*41590000
416000                                                                  41600000
416100 5850-UPDATE-PURCHS-STATUS.                                       41610000
416200                                                                  41620000
416300     IF  ASC-PURCHS-STATUS-CDE EQUAL PC-CM                        41630000
416400         PERFORM 7600-COUNT-PO-LINE-ROWS                          41640000
416500         IF  PV-DB2-COUNT EQUAL ZERO                              41650000
416600             IF  PS-RMS-PO                                        41660000
416700                 CONTINUE                                         41670000
416800             ELSE                                                 41680000
416900                 IF  PS-CHECKED-FOR-RMS-PO                        41690000
417000                     PERFORM 7610-GET-TPURCHS-STATUS              41700000
417100                     PERFORM 7620-ONLY-UPDATE-PURCHS-STATUS       41710000
417200                 ELSE                                             41720000
417300                     MOVE ASC-DEPT-NBR TO PV-DEPT-NBR-X           41730000
417400                     MOVE PV-DEPT-NBR  TO PV-DEPT-NBR-KEY         41740000
417500                     SET PS-NO-RMS-PO  TO TRUE                    41750000
417600                     PERFORM 7650-CHECK-FOR-RMS-PO                41760000
417700                     IF  PV-DB2-COUNT = ZERO                      41770000
417800                         PERFORM 7610-GET-TPURCHS-STATUS          41780000
417900                         PERFORM 7620-ONLY-UPDATE-PURCHS-STATUS   41790000
418000                     END-IF                                       41800000
418100                 END-IF                                           41810000
418200             END-IF                                               41820000
418300         ELSE                                                     41830000
418400             IF  PS-RMS-PO                                        41840000
418500                 CONTINUE                                         41850000
418600             ELSE                                                 41860000
418700                 IF  PS-CHECKED-FOR-RMS-PO                        41870000
418800                     MOVE PC-AC        TO  ASC-PURCHS-STATUS-CDE  41880000
418900                 ELSE                                             41890000
419000                     MOVE ASC-DEPT-NBR TO PV-DEPT-NBR-X           41900000
419100                     MOVE PV-DEPT-NBR  TO PV-DEPT-NBR-KEY         41910000
419200                     SET PS-NO-RMS-PO  TO TRUE                    41920000
419300                     PERFORM 7650-CHECK-FOR-RMS-PO                41930000
419400                     IF  PV-DB2-COUNT = ZERO                      41940000
419500                         MOVE PC-AC    TO  ASC-PURCHS-STATUS-CDE  41950000
419600                     END-IF                                       41960000
419700                 END-IF                                           41970000
419800             END-IF                                               41980000
419900         END-IF                                                   41990000
420000     ELSE                                                         42000000
420100         IF  PS-RMS-PO                                            42010000
420200             CONTINUE                                             42020000
420300         ELSE                                                     42030000
420400             IF  PS-CHECKED-FOR-RMS-PO                            42040000
420500                 PERFORM 7610-GET-TPURCHS-STATUS                  42050000
420600                 PERFORM 7630-UPDATE-PURCHS-STATUS                42060000
420700                 ADD 1            TO  PURCHS-VER-NBR              42070000
420800                 PERFORM 7640-INSERT-PURCHS                       42080000
420900             ELSE                                                 42090000
421000                 MOVE ASC-DEPT-NBR TO PV-DEPT-NBR-X               42100000
421100                 MOVE PV-DEPT-NBR  TO PV-DEPT-NBR-KEY             42110000
421200                 SET PS-NO-RMS-PO  TO TRUE                        42120000
421300                 PERFORM 7650-CHECK-FOR-RMS-PO                    42130000
421400                 IF  PV-DB2-COUNT = ZERO                          42140000
421500                     PERFORM 7610-GET-TPURCHS-STATUS              42150000
421600                     PERFORM 7630-UPDATE-PURCHS-STATUS            42160000
421700                     ADD 1         TO  PURCHS-VER-NBR             42170000
421800                     PERFORM 7640-INSERT-PURCHS                   42180000
421900                 END-IF                                           42190000
422000             END-IF                                               42200000
422100         END-IF                                                   42210000
422200     END-IF.                                                      42220000
422300/                                                                 42230000
422400 6000-REFRESH-PANEL-FROM-TEMP.                                    42240000
422500                                                                  42250000
422600     IF ASC-UPDATE-TSQ                                            42260000
422700         SET ASC-NO-TSQ-UPDATE   TO TRUE                          42270000
422800         MOVE ZERO               TO PV-SAVE-ITEM                  42280000
422900                                    PV-SEL-QUEUE-ITEM             42290000
423000         MOVE ASC-NUMBER-OF-SELECTED-ITEMS                        42300000
423100                                 TO PV-HOLD-SELECTED-ITEMS        42310000
423200         PERFORM 6100-UPDATE-TSQ                                  42320000
423300           UNTIL PV-ITEMS-PROCESSED > ASC-NUMBER-OF-SELECTED-ITEMS42330000
423400                                                                  42340000
423500         PERFORM 6010-DELETE-SEL-QUEUE                            42350000
423600                                                                  42360000
423700         INITIALIZE ASC-BLOCK-ENTRIES (1)                         42370000
423800                    ASC-BLOCK-ENTRIES (2)                         42380000
423900                                                                  42390000
424000         DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL                 42400000
424100                GIVING    PV-BLOCK-NUMBER                         42410000
424200                REMAINDER PV-REMAINDER                            42420000
424300                                                                  42430000
424400         IF PV-REMAINDER > ZERO                                   42440000
424500             ADD +1              TO PV-BLOCK-NUMBER               42450000
424600         END-IF                                                   42460000
424700                                                                  42470000
424800         MOVE +1                 TO ASC-BLK-SUB                   42480000
424900                                                                  42490000
425000         PERFORM 4410-READ-TEMP-STORAGE                           42500000
425100                                                                  42510000
425200         ADD +1                  TO ASC-BLK-SUB                   42520000
425300                            PV-BLOCK-NUMBER                       42530000
425400         PERFORM 4410-READ-TEMP-STORAGE                           42540000
425500                                                                  42550000
425600     END-IF.                                                      42560000
425700                                                                  42570000
425800 6010-DELETE-SEL-QUEUE.                                           42580000
425900                                                                  42590000
426000     EXEC CICS DELETEQ TS                                         42600000
426100               QUEUE (ASC-SEL-QUEUE-NAME-OUT)                     42610000
426200               RESP  (PV-CICS-RESP)                               42620000
426300     END-EXEC.                                                    42630000
426400                                                                  42640000
426500     IF ((PV-CICS-RESP = DFHRESP (NORMAL)) OR                     42650000
426600         (PV-CICS-RESP = DFHRESP (QIDERR)))                       42660000
426700         CONTINUE                                                 42670000
426800     ELSE                                                         42680000
426900         SET DP013-CICS-ABEND                                     42690000
427000             DP013-NO-ROLLBACK   TO TRUE                          42700000
427100         MOVE '6010-DELETE-SEL-QUEUE'                             42710000
427200                                 TO DP013-PARAGRAPH               42720000
427300         MOVE 'UNSUCCESSFUL SEL ITEMS TEMP STORAGE QUEUE DELETE'  42730000
427400                                 TO DP013-MESSAGE-TEXT (1)        42740000
427500         PERFORM DP013-0000-PROCESS-ABEND                         42750000
427600     END-IF.                                                      42760000
427700                                                                  42770000
427800 6100-UPDATE-TSQ.                                                 42780000
427900                                                                  42790000
428000     ADD 1                       TO PV-SEL-QUEUE-ITEM.            42800000
428100                                                                  42810000
428200     PERFORM 6105-READ-SEL-QUEUE.                                 42820000
428300                                                                  42830000
428400     PERFORM                                                      42840000
428500     VARYING RC013-IDX  FROM 1 BY 1                               42850000
428600     UNTIL   PV-ITEMS-PROCESSED > PV-HOLD-SELECTED-ITEMS OR       42860000
428700             RC013-IDX > RC013-MAX-ITEMS                          42870000
428800                                                                  42880000
428900         IF RC013-ACTION-SW (RC013-IDX) > SPACE                   42890000
429000            PERFORM 6110-PROCESS-ITEMS                            42900000
429100            SET PS-WRITE-LIST-QUEUE                               42910000
429200                                 TO TRUE                          42920000
429300         END-IF                                                   42930000
429400                                                                  42940000
429500         ADD +1                  TO PV-ITEMS-PROCESSED            42950000
429600     END-PERFORM.                                                 42960000
429700                                                                  42970000
429800     IF PS-WRITE-LIST-QUEUE                                       42980000
429900         PERFORM 6111-WRITE-LIST-QUEUE                            42990000
430000     END-IF.                                                      43000000
430100                                                                  43010000
430200                                                                  43020000
430300 6105-READ-SEL-QUEUE.                                             43030000
430400                                                                  43040000
430500     EXEC CICS READQ TS                                           43050000
430600               QUEUE (ASC-SEL-QUEUE-NAME-OUT)                     43060000
430700               INTO  (RC013-DC-SELECT-RECORD)                     43070000
430800               ITEM  (PV-SEL-QUEUE-ITEM)                          43080000
430900               RESP  (PV-CICS-RESP)                               43090000
431000     END-EXEC.                                                    43100000
431100                                                                  43110000
431200     IF PV-CICS-RESP NOT = DFHRESP (NORMAL)                       43120000
431300         SET DP013-CICS-ABEND                                     43130000
431400             DP013-NO-ROLLBACK   TO TRUE                          43140000
431500         MOVE '6105-READ-SEL-QUEUE'                               43150000
431600                                 TO DP013-PARAGRAPH               43160000
431700         MOVE 'UNSUCCESSFUL SEL ITEMS TEMP STORAGE QUEUE READ'    43170000
431800                                 TO DP013-MESSAGE-TEXT (1)        43180000
431900         PERFORM DP013-0000-PROCESS-ABEND                         43190000
432000     END-IF.                                                      43200000
432100                                                                  43210000
432200 6110-PROCESS-ITEMS.                                              43220000
432300                                                                  43230000
432400     COMPUTE PV-ITEM = 1 + ((RC013-ITEM (RC013-IDX) - 1)          43240000
432500                                            / PC-ITEMS-PER-PANEL).43250000
432600                                                                  43260000
432700     IF PV-ITEM NOT = PV-SAVE-ITEM                                43270000
432800        IF PV-SAVE-ITEM NOT = ZERO                                43280000
432900                                                                  43290000
433000            PERFORM 6111-WRITE-LIST-QUEUE                         43300000
433100                                                                  43310000
433200        END-IF                                                    43320000
433300        MOVE PV-ITEM             TO PV-SAVE-ITEM                  43330000
433400                                                                  43340000
433500        PERFORM 6112-READ-LIST-QUEUE                              43350000
433600                                                                  43360000
433700     END-IF.                                                      43370000
433800                                                                  43380000
433900     COMPUTE PV-SUB = (RC013-ITEM (RC013-IDX) -                   43390000
434000                                    LQW-LIST-ITEM-NUMBER (1)) + 1.43400000
434100     SET LQW-UPDATE (PV-SUB)   TO TRUE                            43410000
434200     SET LQW-DESELECT (PV-SUB)   TO TRUE                          43420000
434300     MOVE LQW-SELECTED-SW (PV-SUB)                                43430000
434400                                 TO LQW-TEMP-SELECTED-SW (PV-SUB).43440000
434500                                                                  43450000
434600     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                43460000
434700                                                                  43470000
434800 6111-WRITE-LIST-QUEUE.                                           43480000
434900                                                                  43490000
435000     EXEC CICS WRITEQ TS                                          43500000
435100               QUEUE (ASC-LIST-QUEUE-NAME)                        43510000
435200               FROM  (LQW-LIST-QUEUE-WORK-AREA)                   43520000
435300               ITEM  (PV-SAVE-ITEM)                               43530000
435400               REWRITE                                            43540000
435500               RESP  (PV-CICS-RESP)                               43550000
435600     END-EXEC.                                                    43560000
435700                                                                  43570000
435800     IF PV-CICS-RESP NOT = DFHRESP (NORMAL)                       43580000
435900         SET DP013-CICS-ABEND                                     43590000
436000             DP013-NO-ROLLBACK   TO TRUE                          43600000
436100         MOVE '6111-WRITE-LIST-QUEUE'                             43610000
436200                                 TO DP013-PARAGRAPH               43620000
436300         MOVE 'UNSUCCESSFUL LIST ITEMS TEMP STORAGE QUEUE REWRITE'43630000
436400                                 TO DP013-MESSAGE-TEXT(1)         43640000
436500         PERFORM DP013-0000-PROCESS-ABEND                         43650000
436600     END-IF.                                                      43660000
436700                                                                  43670000
436800 6112-READ-LIST-QUEUE.                                            43680000
436900                                                                  43690000
437000     EXEC CICS READQ TS                                           43700000
437100               QUEUE (ASC-LIST-QUEUE-NAME)                        43710000
437200               INTO  (LQW-LIST-QUEUE-WORK-AREA)                   43720000
437300               ITEM  (PV-ITEM)                                    43730000
437400               RESP  (PV-CICS-RESP)                               43740000
437500     END-EXEC.                                                    43750000
437600                                                                  43760000
437700     IF PV-CICS-RESP NOT = DFHRESP (NORMAL)                       43770000
437800         SET DP013-CICS-ABEND                                     43780000
437900             DP013-NO-ROLLBACK   TO TRUE                          43790000
438000         MOVE '6112-READ-LIST-QUEUE'                              43800000
438100                                 TO DP013-PARAGRAPH               43810000
438200         MOVE 'UNSUCCESSFUL LIST ITEMS TEMP STORAGE QUEUE READ'   43820000
438300                                 TO DP013-MESSAGE-TEXT(1)         43830000
438400         PERFORM DP013-0000-PROCESS-ABEND                         43840000
438500     END-IF.                                                      43850000
438600                                                                  43860000
438700                                                                  43870000
438800******************************************************************43880000
438900* WRITE ENTRIES TO VERIFY ADJUSTMENT QUEUE                       *43890000
439000******************************************************************43900000
439100 6150-WRITE-VRFY-ADJ-QUEUE.                                       43910000
439200                                                                  43920000
439300     EXEC CICS WRITEQ TS                                          43930000
439400               QUEUE (ASC-VRFY-ADJ-QUEUE-NAME)                    43940000
439500               FROM  (PC241-FIELDS)                               43950000
439600               ITEM  (PV-VRFY-ITEM)                               43960000
439700               RESP  (PV-CICS-RESP)                               43970000
439800     END-EXEC.                                                    43980000
439900                                                                  43990000
440000     IF PV-CICS-RESP NOT = DFHRESP (NORMAL)                       44000000
440100         SET DP013-CICS-ABEND                                     44010000
440200             DP013-NO-ROLLBACK   TO TRUE                          44020000
440300         MOVE '6150-WRITE-VRFY-ADJ-QUEUE'                         44030000
440400                                 TO DP013-PARAGRAPH               44040000
440500         MOVE 'UNSUCCESSFUL LIST ITEMS TEMP STORAGE QUEUE'        44050000
440600                                 TO DP013-MESSAGE-TEXT(1)         44060000
440700         PERFORM DP013-0000-PROCESS-ABEND                         44070000
440800     END-IF.                                                      44080000
440900                                                                  44090000
441000******************************************************************44100000
441100* DELETE THE LIST QUEUE WHEN PREV-SEL OR NEXT-SEL WAS ENTERED.   *44110000
441200******************************************************************44120000
441300 6200-DEL-LIST-QUEUE.                                             44130000
441400                                                                  44140000
441500     EXEC CICS                                                    44150000
441600         DELETEQ TS                                               44160000
441700             QUEUE (ASC-LIST-QUEUE-NAME)                          44170000
441800             RESP  (PV-CICS-RESP)                                 44180000
441900     END-EXEC.                                                    44190000
442000                                                                  44200000
442100     IF ((PV-CICS-RESP = DFHRESP(NORMAL)) OR                      44210000
442200        (PV-CICS-RESP = DFHRESP(QIDERR)))                         44220000
442300         CONTINUE                                                 44230000
442400     ELSE                                                         44240000
442500        SET DP013-CICS-ABEND     TO TRUE                          44250000
442600        SET DP013-NO-ROLLBACK    TO TRUE                          44260000
442700        MOVE '6200-DEL-LIST-QUEUE'                                44270000
442800                                 TO DP013-PARAGRAPH               44280000
442900        MOVE 'ERROR TRYING TO DELETE LIST TS QUEUE'               44290000
443000                                 TO DP013-MESSAGE-TEXT (1)        44300000
443100        PERFORM DP013-0000-PROCESS-ABEND                          44310000
443200     END-IF.                                                      44320000
443300/                                                                 44330000
443400 7000-GET-PO-INFO.                                                44340000
443500                                                                  44350000
443600     EXEC SQL                                                     44360000
443700          SELECT A.DEPT_NBR                                       44370000
443800               , A.STATUS_CDE                                     44380000
443900            INTO :PURCHS-DEPT-NBR                                 44390000
444000               , :ASC-PURCHS-STATUS-CDE                           44400000
444100            FROM TPURCHS A                                        44410000
444200           WHERE A.VER_STATUS_CDE = :PC-ACTIVE                    44420000
444300             AND A.PO_NBR             = :DK-PO-NBR                44430000
444400     END-EXEC                                                     44440000
444500                                                                  44450000
444600     EVALUATE TRUE                                                44460000
444700         WHEN SQLCODE = ZERO                                      44470000
444800             CONTINUE                                             44480000
444900         WHEN SQLCODE = +100                                      44490000
445000            MOVE  SPACES TO PURCHS-DEPT-NBR                       44500000
445100                            ASC-PURCHS-STATUS-CDE                 44510000
445200         WHEN SQLCODE = -904                                      44520000
445300         WHEN SQLCODE = -911                                      44530000
445400         WHEN SQLCODE = -913                                      44540000
445500             PERFORM 9900-SOFT-ABORT                              44550000
445600         WHEN SQLWARN0 NOT = SPACES                               44560000
445700         WHEN SQLCODE      NOT = ZERO                             44570000
445800             MOVE '7000-GET-PO-INFO'                              44580000
445900                             TO DP013-PARAGRAPH                   44590000
446000             MOVE 'UNSUCCESSFUL SELECT OF VENDOR NAME'            44600000
446100                             TO DP013-MESSAGE-TEXT (1)            44610000
446200             MOVE SQLCA         TO DP013-SQLCA                    44620000
446300             MOVE 'TPURCHS' TO DP013-DB2-TABLE-NAME (1)           44630000
446400             SET DP013-DB2-ABEND                                  44640000
446500                  DP013-XCTL-DISPLAY-RESTART                      44650000
446600                             TO TRUE                              44660000
446700             PERFORM DP013-0000-PROCESS-ABEND                     44670000
446800     END-EVALUATE.                                                44680000
446900                                                                  44690000
447000                                                                  44700000
447100 7005-SELECT-RECITM.                                              44710000
447200                                                                  44720000
447300     EXEC SQL                                                     44730000
447400           SELECT PREPK_ID                                        44740000
447500                 ,VRFD_USR_ID                                     44750037
447600             INTO :RECITM-PREPK-ID                                44760000
447700                 ,:RECITM-VRFD-USR-ID                             44770037
447800             FROM TRECITM                                         44780000
447900            WHERE ORD_NBR            = :DK-PO-NBR                 44790000
448000              AND ORD_LNE_NBR        = :DK-PKSL-LNE-NBR           44800000
448100              AND REC_SEQ_NBR        = :DK-REC-SEQ-NBR            44810000
448200              AND OPER_UNT_ID        = :ASC-KEY-OPER-UNT-ID       44820000
448300              AND FCLTY_ID           = :ASC-KEY-FCLTY-ID          44830000
448400              AND VER_STATUS_CDE     = :PC-ACTIVE                 44840000
448500     END-EXEC                                                     44850000
448600                                                                  44860000
448700     EVALUATE TRUE                                                44870000
448800         WHEN SQLCODE = ZERO                                      44880000
448900             EVALUATE ASC-CSR-IND                                 44890038
449000                WHEN '1'                                          44900037
449100                WHEN '2'                                          44910037
449200                WHEN '3'                                          44920037
449300                WHEN '4'                                          44930037
449400                   CONTINUE                                       44940037
449500                WHEN OTHER                                        44950037
449600                   MOVE RECITM-VRFD-USR-ID TO ASC-KEY-VFY-SRC     44960037
449700             END-EVALUATE                                         44970037
449800         WHEN SQLCODE = +100                                      44980000
449900              CONTINUE                                            44990000
450000         WHEN SQLCODE = -904                                      45000000
450100         WHEN SQLCODE = -911                                      45010000
450200         WHEN SQLCODE = -913                                      45020000
450300             PERFORM 9900-SOFT-ABORT                              45030000
450400         WHEN SQLWARN0 NOT = SPACES                               45040000
450500         WHEN SQLCODE      NOT = ZERO                             45050000
450600              MOVE '7005-SELECT-RECITM'                           45060000
450700                             TO DP013-PARAGRAPH                   45070000
450800              MOVE 'UNSUCCESSFUL SELECT OF RECITM HEADER DATA'    45080000
450900                             TO DP013-MESSAGE-TEXT (1)            45090000
451000              MOVE SQLCA         TO DP013-SQLCA                   45100000
451100              MOVE 'TRECITM' TO DP013-DB2-TABLE-NAME (1)          45110000
451200              SET DP013-DB2-ABEND                                 45120000
451300                  DP013-XCTL-DISPLAY-RESTART                      45130000
451400                             TO TRUE                              45140000
451500                                                                  45150000
451600              PERFORM DP013-0000-PROCESS-ABEND                    45160000
451700     END-EVALUATE.                                                45170000
451800                                                                  45180000
451900                                                                  45190000
452000 7010-LOOK-FOR-TROUBLE.                                           45200000
452100                                                                  45210000
452200     EXEC SQL                                                     45220000
452300         SELECT A.PO_NBR                                          45230000
452400         INTO :TRBNTF-PO-NBR                                      45240000
452500         FROM  TTRBNTF A                                          45250000
452600            ,  TTRBRSN B                                          45260000
452700         WHERE  A.PO_NBR         =   :DK-PO-NBR                   45270000
452800         AND    A.REC_SEQ_NBR    =   :DK-REC-SEQ-NBR              45280000
452900         AND  ((A.PO_LNE_NBR     =   :DK-PKSL-LNE-NBR             45290000
453000         AND    B.TRBL_LVL_IND    <> :PC-M)                       45300000
453100         OR    (A.PREPK_ID       =   :RECITM-PREPK-ID             45310000
453200         AND    B.TRBL_LVL_IND    =  :PC-M))                      45320000
453300         AND    A.RESOLVED_IND   IN (:PC-N, :PC-I)                45330000
453400         AND    A.TRBL_RSN_CDE   =    B.TRBL_RSN_CDE              45340000
453500         AND    B.PO_UPD_IND     =   :PC-A                        45350000
453600     END-EXEC                                                     45360000
453700                                                                  45370000
453800     EVALUATE TRUE                                                45380000
453900         WHEN SQLCODE = ZERO                                      45390000
454000         WHEN SQLCODE = -811                                      45400000
454100             SET ASC-TRBL-EXISTS           TO TRUE                45410000
454200         WHEN SQLCODE = +100                                      45420000
454300             SET ASC-NO-TRBL-EXISTS        TO TRUE                45430000
454400         WHEN SQLCODE = -904                                      45440000
454500         WHEN SQLCODE = -911                                      45450000
454600         WHEN SQLCODE = -913                                      45460000
454700             PERFORM 9900-SOFT-ABORT                              45470000
454800         WHEN SQLWARN0 NOT = SPACE                                45480000
454900         WHEN SQLCODE < ZERO                                      45490000
455000         WHEN SQLCODE > ZERO                                      45500000
455100             MOVE '7010-LOOK-FOR-TROUBLE'                         45510000
455200                             TO DP013-PARAGRAPH                   45520000
455300             MOVE 'SELECT ON TTRBNTF/TTRBRSN'                     45530000
455400                             TO DP013-MESSAGE-TEXT (1)            45540000
455500             MOVE SQLCA          TO DP013-SQLCA                   45550000
455600             MOVE 'TTRBNTF'      TO DP013-DB2-TABLE-NAME (1)      45560000
455700             MOVE 'TTRBRSN'      TO DP013-DB2-TABLE-NAME (2)      45570000
455800             SET DP013-DB2-ABEND                                  45580000
455900                 DP013-XCTL-DISPLAY-RESTART                       45590000
456000                             TO TRUE                              45600000
456100              PERFORM DP013-0000-PROCESS-ABEND                    45610000
456200     END-EVALUATE.                                                45620000
456300/                                                                 45630000
456400*---------------------------------------------------------------* 45640000
456500*                                              ** WR # 21361    * 45650000
456600* ADDED CODE TO RETRIEVE ITEM NUMBER FROM TPURITM TABLE.        * 45660000
456700*---------------------------------------------------------------* 45670000
456800 7020-SELECT-PURITM-DATA.                                         45680000
456900                                                                  45690000
457000     SET PS-CALL-API-NO      TO TRUE                              45700000
457100                                                                  45710000
457200     EXEC SQL                                                     45720000
457300           SELECT PO_LNE_NBR                                      45730000
457400                , CL_NBR                                          45740000
457500                , SKU_SEQ_NBR                                     45750000
457600                , STATUS_CDE                                      45760000
457700                , UNT_QTY                                         45770000
457800                , ITM_NBR                                         45780000
457900             INTO :PURITM-PO-LNE-NBR                              45790000
458000                , :PURITM-CL-NBR                                  45800000
458100                , :PURITM-SKU-SEQ-NBR                             45810000
458200                , :ASC-PURITM-STATUS-CDE                          45820000
458300                , :ASC-PURITM-UNT-QTY                             45830000
458400                , :PURITM-ITM-NBR                                 45840000
458500             FROM TPURITM                                         45850000
458600            WHERE PO_NBR             = :DK-PO-NBR                 45860000
458700              AND APP_PO_LNE_NBR = :DK-PKSL-LNE-NBR               45870000
458800              AND VER_STATUS_CDE = :PC-ACTIVE                     45880000
458900     END-EXEC                                                     45890000
459000                                                                  45900000
459100******************************************************************45910000
459200* IF THE SQL STATEMENT IS SUCCESSFUL, THEN SET PS-CALL-API-YES   *45920000
459300* TO TRUE.                                ** WR # 21361          *45930000
459400******************************************************************45940000
459500     EVALUATE TRUE                                                45950000
459600         WHEN SQLCODE = ZERO                                      45960000
459700              SET PS-CALL-API-YES TO TRUE                         45970000
459800              CONTINUE                                            45980000
459900         WHEN SQLCODE = +100                                      45990000
460000              CONTINUE                                            46000000
460100     WHEN SQLCODE = -904                                          46010000
460200     WHEN SQLCODE = -911                                          46020000
460300     WHEN SQLCODE = -913                                          46030000
460400         PERFORM 9900-SOFT-ABORT                                  46040000
460500         WHEN SQLWARN0 NOT = SPACES                               46050000
460600         WHEN SQLCODE      NOT = ZERO                             46060000
460700              MOVE '7020-SELECT-PURITM-DATA'                      46070000
460800                             TO DP013-PARAGRAPH                   46080000
460900              MOVE 'UNSUCCESSFUL SELECT OF PURITM'                46090000
461000                             TO DP013-MESSAGE-TEXT (1)            46100000
461100              MOVE SQLCA         TO DP013-SQLCA                   46110000
461200              MOVE 'TPURITM' TO DP013-DB2-TABLE-NAME (1)          46120000
461300              SET DP013-DB2-ABEND                                 46130000
461400                  DP013-XCTL-DISPLAY-RESTART                      46140000
461500                             TO TRUE                              46150000
461600                                                                  46160000
461700              PERFORM DP013-0000-PROCESS-ABEND                    46170000
461800     END-EVALUATE.                                                46180000
461900*----------------------------------------------------------------*46190000
462000* CHANGES MADE FOR WR # 21361 ENDS HERE.                         *46200000
462100*----------------------------------------------------------------*46210000
462200/                                                                 46220000
462300 7030-SELECT-RECITM-DATA.                                         46230000
462400                                                                  46240000
462500     INITIALIZE DCLTRECITM.                                       46250000
462600                                                                  46260000
462700     EXEC SQL                                                     46270000
462800           SELECT STATUS_CDE                                      46280000
462900             INTO :RECITM-STATUS-CDE                              46290000
463000             FROM TRECITM                                         46300000
463100            WHERE ORD_NBR            = :DK-PO-NBR                 46310000
463200              AND ORD_LNE_NBR        = :DK-PKSL-LNE-NBR           46320000
463300              AND REC_SEQ_NBR        = :DK-REC-SEQ-NBR            46330000
463400              AND OPER_UNT_ID        = :ASC-KEY-OPER-UNT-ID       46340000
463500              AND FCLTY_ID           = :ASC-KEY-FCLTY-ID          46350000
463600              AND VER_STATUS_CDE = :PC-ACTIVE                     46360000
463700     END-EXEC                                                     46370000
463800                                                                  46380000
463900     EVALUATE TRUE                                                46390000
464000         WHEN SQLCODE = ZERO                                      46400000
464100         WHEN SQLCODE = +100                                      46410000
464200              CONTINUE                                            46420000
464300         WHEN SQLCODE = -904                                      46430000
464400         WHEN SQLCODE = -911                                      46440000
464500         WHEN SQLCODE = -913                                      46450000
464600             PERFORM 9900-SOFT-ABORT                              46460000
464700         WHEN SQLWARN0 NOT = SPACES                               46470000
464800         WHEN SQLCODE      NOT = ZERO                             46480000
464900              MOVE '7030-SELECT-RECITM-DATA'                      46490000
465000                             TO DP013-PARAGRAPH                   46500000
465100              MOVE 'UNSUCCESSFUL SELECT OF RECITM HEADER DATA'    46510000
465200                             TO DP013-MESSAGE-TEXT (1)            46520000
465300              MOVE SQLCA         TO DP013-SQLCA                   46530000
465400              MOVE 'TRECITM' TO DP013-DB2-TABLE-NAME (1)          46540000
465500              SET DP013-DB2-ABEND                                 46550000
465600                  DP013-XCTL-DISPLAY-RESTART                      46560000
465700                             TO TRUE                              46570000
465800                                                                  46580000
465900              PERFORM DP013-0000-PROCESS-ABEND                    46590000
466000     END-EVALUATE.                                                46600000
466100/                                                                 46610000
466200 7040-GET-FACILITY-DESC.                                          46620000
466300                                                                  46630000
466400     INITIALIZE XL071-COMMAREA-REC.                               46640016
466500     MOVE ASC-KEY-OPER-UNT-ID     TO  XL071-LOCATION-NUMBER.      46650016
466600                                                                  46660016
466700     CALL PC-LOCATION-MODULE  USING                               46670016
466800                                    DFHEIBLK                      46680016
466900                                    XL071-COMMAREA                46690016
467000                                    XL071-COMMAREA-REC.           46700016
467100                                                                  46710016
467200     EVALUATE TRUE                                                46720016
467300         WHEN XL071-NO-ERRORS                                     46730016
467400         WHEN XL071-LOC-NOT-FOUND                                 46740016
467500         WHEN XL071-DC-ASGMT-NOT-FND                              46750016
467600              MOVE XL071-LOC-NM    TO ASC-KEY-FCLTY-DESC          46760016
467700                                                                  46770016
467800         WHEN OTHER                                               46780016
467900              INITIALIZE PV-CICS-MSG-AREA                         46790016
468000              STRING ' RCKCS284 - CALL XLTUT071 -'                46800016
468100                     ' SQLCODE=' XL071-SQLCODE                    46810016
468200                     ' TABLE='   XL071-DB2-TABLE                  46820016
468300                                              DELIMITED BY SIZE   46830016
468400                                         INTO PV-CICS-MSG-AREA    46840016
468500              MOVE LENGTH OF PV-CICS-MSG-AREA                     46850016
468600                                        TO PV-COMMAREA-LENGTH     46860016
468700              EXEC CICS                                           46870016
468800                   WRITEQ TD                                      46880016
468900                    QUEUE  ('CSSL')                               46890016
469000                     FROM  (PV-CICS-MSG-AREA)                     46900016
469100                   LENGTH  (PV-COMMAREA-LENGTH)                   46910016
469200                     RESP  (PV-CICS-RESPONSE)                     46920016
469300              END-EXEC                                            46930016
469400             PERFORM 9900-SOFT-ABORT                              46940000
469500                                                                  46950016
469600       END-EVALUATE.                                              46960000
469700/                                                                 46970000
469800 7045-CHECK-IF-DC.                                                46980043
469900                                                                  46990043
470000     INITIALIZE XL071-COMMAREA-REC.                               47000043
470100     MOVE DK-STR-NBR              TO  XL071-LOCATION-NUMBER.      47010043
470200                                                                  47020043
470300     CALL PC-LOCATION-MODULE  USING                               47030043
470400                                    DFHEIBLK                      47040043
470500                                    XL071-COMMAREA                47050043
470600                                    XL071-COMMAREA-REC.           47060043
470700                                                                  47070043
470800     EVALUATE TRUE                                                47080043
470900         WHEN XL071-NO-ERRORS                                     47090043
471000         WHEN XL071-LOC-NOT-FOUND                                 47100043
471100         WHEN XL071-DC-ASGMT-NOT-FND                              47110043
471200              CONTINUE                                            47120043
471300         WHEN OTHER                                               47130043
471400              INITIALIZE PV-CICS-MSG-AREA                         47140043
471500              STRING ' RCKCS284 - CALL XLTUT071 -'                47150043
471600                     ' SQLCODE=' XL071-SQLCODE                    47160043
471700                     ' TABLE='   XL071-DB2-TABLE                  47170043
471800                                              DELIMITED BY SIZE   47180043
471900                                         INTO PV-CICS-MSG-AREA    47190043
472000              MOVE LENGTH OF PV-CICS-MSG-AREA                     47200043
472100                                        TO PV-COMMAREA-LENGTH     47210043
472200              EXEC CICS                                           47220043
472300                   WRITEQ TD                                      47230043
472400                    QUEUE  ('CSSL')                               47240043
472500                     FROM  (PV-CICS-MSG-AREA)                     47250043
472600                   LENGTH  (PV-COMMAREA-LENGTH)                   47260043
472700                     RESP  (PV-CICS-RESPONSE)                     47270043
472800              END-EXEC                                            47280043
472900             PERFORM 9900-SOFT-ABORT                              47290043
473000                                                                  47300043
473100       END-EVALUATE.                                              47310043
473200/                                                                 47320043
473300 7050-GET-TRECEIV.                                                47330043
473400                                                                  47340043
473500     EXEC SQL                                                     47350043
473600          SET :PV-DB2-CURRENT-TMST = CURRENT TIMESTAMP            47360043
473700     END-EXEC.                                                    47370000
473800                                                                  47380000
473900     EXEC SQL                                                     47390000
474000          SELECT                                                  47400000
474100                  A.ML_POST_TMST                                  47410000
474200                , A.FS_POST_TMST                                  47420000
474300                , A.STATUS_CDE                                    47430000
474400                , B.STATUS_CDE                                    47440000
474500                , A.PACK_BY_ST_IND                                47450026
474600            INTO                                                  47460000
474700                  :RECEIV-ML-POST-TMST                            47470000
474800                , :RECEIV-FS-POST-TMST                            47480000
474900                , :RECEIV-STATUS-CDE                              47490000
475000                , :RECITM-STATUS-CDE                              47500000
475100                , :ASC-PACK-BY-ST-IND                             47510026
475200            FROM                                                  47520000
475300                  TRECEIV A                                       47530000
475400                , TRECITM B                                       47540000
475500            WHERE                                                 47550000
475600                  A.ORD_NBR          = :DK-PO-NBR                 47560000
475700              AND A.REC_SEQ_NBR      = :DK-REC-SEQ-NBR            47570000
475800              AND A.OPER_UNT_ID      = :ASC-KEY-OPER-UNT-ID       47580000
475900              AND A.FCLTY_ID         = :ASC-KEY-FCLTY-ID          47590000
476000              AND A.VER_STATUS_CDE   = :PC-ACTIVE                 47600000
476100              AND                                                 47610000
476200                  B.ORD_NBR          = :DK-PO-NBR                 47620000
476300              AND B.REC_SEQ_NBR      = :DK-REC-SEQ-NBR            47630000
476400              AND B.OPER_UNT_ID      = :ASC-KEY-OPER-UNT-ID       47640000
476500              AND B.FCLTY_ID         = :ASC-KEY-FCLTY-ID          47650000
476600              AND B.VER_STATUS_CDE   = :PC-ACTIVE                 47660000
476700              AND B.ORD_LNE_NBR      = :DK-PKSL-LNE-NBR           47670000
476800     END-EXEC.                                                    47680000
476900                                                                  47690000
477000     EVALUATE TRUE                                                47700000
477100         WHEN SQLCODE = ZERO                                      47710000
477200         WHEN SQLCODE = +100                                      47720000
477300              CONTINUE                                            47730000
477400         WHEN SQLCODE = -904                                      47740000
477500         WHEN SQLCODE = -911                                      47750000
477600         WHEN SQLCODE = -913                                      47760000
477700             PERFORM 9900-SOFT-ABORT                              47770000
477800         WHEN SQLWARN0 NOT = SPACES                               47780000
477900         WHEN SQLCODE  NOT = ZERO                                 47790000
478000             MOVE '7050-GET-TRECEIV'                              47800000
478100                                 TO DP013-PARAGRAPH               47810000
478200             MOVE 'UNSUCCESSFUL SELECT OF TRECEIV'                47820000
478300                                 TO DP013-MESSAGE-TEXT (1)        47830000
478400             MOVE SQLCA         TO DP013-SQLCA                    47840000
478500             MOVE 'TRECEIV'     TO DP013-DB2-TABLE-NAME (1)       47850000
478600             MOVE 'TRECITM'     TO DP013-DB2-TABLE-NAME (2)       47860000
478700             SET DP013-DB2-ABEND                                  47870000
478800                 DP013-XCTL-DISPLAY-RESTART                       47880000
478900                                 TO TRUE                          47890000
479000                                                                  47900000
479100             PERFORM DP013-0000-PROCESS-ABEND                     47910000
479200     END-EVALUATE.                                                47920000
479300/                                                                 47930000
479400 7055-GET-TDISTHD.                                                47940000
479500                                                                  47950000
479600     SET ASC-ACTL-NOT-CONFIRMED TO TRUE.                          47960000
479700                                                                  47970000
479800     MOVE   ASC-KEY-PO-NBR-N        TO DK-PO-NBR.                 47980000
479900     MOVE   ASC-KEY-REC-SEQ-NBR-N   TO DK-REC-SEQ-NBR.            47990000
480000     MOVE   ASC-KEY-PKSL-LNE-NBR    TO DK-PKSL-LNE-NBR.           48000000
480100     SET ASC-UPDATE-ALLOWED  TO TRUE.                             48010021
480200                                                                  48020000
480300     EXEC SQL                                                     48030000
480400          SELECT                                                  48040000
480500                   FCSE_CNFRMN_TMST                               48050000
480600                ,  TOT_CART_CNT                                   48060021
480700                ,  VRFD_TMST                                      48070021
480800            INTO                                                  48080000
480900                  :DISTHD-FCSE-CNFRMN-TMST                        48090000
481000                , :DISTHD-TOT-CART-CNT                            48100021
481100                , :DISTHD-VRFD-TMST                               48110021
481200            FROM                                                  48120000
481300                  TDISTHD                                         48130000
481400            WHERE                                                 48140000
481500                  ORD_NBR          = :DK-PO-NBR                   48150000
481600              AND RCVR_SEQ_NBR     = :DK-REC-SEQ-NBR              48160000
481700              AND ORD_LNE_NBR      = :DK-PKSL-LNE-NBR             48170000
481800     END-EXEC.                                                    48180000
481900                                                                  48190000
482000     EVALUATE TRUE                                                48200000
482100         WHEN SQLCODE = ZERO                                      48210000
482200              IF  DISTHD-FCSE-CNFRMN-TMST = PV-DB2-DEFAULT-TMST   48220000
482300                  CONTINUE                                        48230000
482400              ELSE                                                48240000
482500                  SET ASC-ACTL-CONFIRMED TO TRUE                  48250000
482600              END-IF                                              48260000
482700              IF DISTHD-VRFD-TMST = PC-DEFAULT-TMST AND           48270021
482800                 DISTHD-TOT-CART-CNT > 0                          48280021
482900                  SET ASC-UPDATE-NOT-ALLOWED  TO TRUE             48290021
483000              END-IF                                              48300021
483100         WHEN SQLCODE = +100                                      48310000
483200              CONTINUE                                            48320000
483300         WHEN SQLCODE = -904                                      48330000
483400         WHEN SQLCODE = -911                                      48340000
483500         WHEN SQLCODE = -913                                      48350000
483600             PERFORM 9900-SOFT-ABORT                              48360000
483700         WHEN SQLWARN0 NOT = SPACES                               48370000
483800         WHEN SQLCODE  NOT = ZERO                                 48380000
483900             MOVE '7055-GET-TDISTHD'                              48390000
484000                                 TO DP013-PARAGRAPH               48400000
484100             MOVE 'UNSUCCESSFUL SELECT OF TDISTHD'                48410000
484200                                 TO DP013-MESSAGE-TEXT (1)        48420000
484300             MOVE SQLCA         TO DP013-SQLCA                    48430000
484400             MOVE 'TDISTHD'     TO DP013-DB2-TABLE-NAME (1)       48440000
484500             MOVE 'TDISTHD'     TO DP013-DB2-TABLE-NAME (2)       48450000
484600             SET DP013-DB2-ABEND                                  48460000
484700                 DP013-XCTL-DISPLAY-RESTART                       48470000
484800                                 TO TRUE                          48480000
484900                                                                  48490000
485000             PERFORM DP013-0000-PROCESS-ABEND                     48500000
485100     END-EVALUATE.                                                48510000
485200/                                                                 48520000
485300 7060-GET-TDISTDT.                                                48530000
485400                                                                  48540000
485500                                                                  48550000
485600     MOVE   ASC-KEY-PO-NBR-N        TO DK-PO-NBR.                 48560000
485700     MOVE   ASC-KEY-REC-SEQ-NBR-N   TO DK-REC-SEQ-NBR.            48570000
485800     MOVE   ASC-KEY-PKSL-LNE-NBR    TO DK-PKSL-LNE-NBR.           48580000
485900                                                                  48590000
486000     EXEC SQL                                                     48600000
486100          SELECT                                                  48610000
486200                  ACTL_ALLOC_QTY                                  48620000
486300                , P2L_SPLT_UNT_QTY                                48630000
486400                , FCSE_SPLT_UNT_QTY                               48640000
486500                , INPK_SPLT_UNT_QTY                               48650000
486600                , FCSE_ACTL_UNT_QTY                               48660000
486700            INTO                                                  48670000
486800                  :DISTDT-ACTL-ALLOC-QTY                          48680000
486900                , :DISTDT-P2L-SPLT-UNT-QTY                        48690000
487000                , :DISTDT-FCSE-SPLT-UNT-QTY                       48700000
487100                , :DISTDT-INPK-SPLT-UNT-QTY                       48710000
487200                , :DISTDT-FCSE-ACTL-UNT-QTY                       48720000
487300            FROM                                                  48730000
487400                  TDISTDT                                         48740000
487500            WHERE                                                 48750000
487600                  ORD_NBR          = :DK-PO-NBR                   48760000
487700              AND RCVR_SEQ_NBR     = :DK-REC-SEQ-NBR              48770000
487800              AND ORD_LNE_NBR      = :DK-PKSL-LNE-NBR             48780000
487900              AND STR_NBR          = :PV-STORE-NUM                48790000
488000     END-EXEC.                                                    48800000
488100                                                                  48810000
488200     EVALUATE TRUE                                                48820000
488300         WHEN SQLCODE = ZERO                                      48830000
488400         WHEN SQLCODE = +100                                      48840000
488500              CONTINUE                                            48850000
488600         WHEN SQLCODE = -904                                      48860000
488700         WHEN SQLCODE = -911                                      48870000
488800         WHEN SQLCODE = -913                                      48880000
488900             PERFORM 9900-SOFT-ABORT                              48890000
489000         WHEN SQLWARN0 NOT = SPACES                               48900000
489100         WHEN SQLCODE  NOT = ZERO                                 48910000
489200             MOVE '7060-GET-TDISTDT'                              48920000
489300                                 TO DP013-PARAGRAPH               48930000
489400             MOVE 'UNSUCCESSFUL SELECT OF TDISTDT'                48940000
489500                                 TO DP013-MESSAGE-TEXT (1)        48950000
489600             MOVE SQLCA         TO DP013-SQLCA                    48960000
489700             MOVE 'TDISTDT'     TO DP013-DB2-TABLE-NAME (1)       48970000
489800             MOVE 'TDISTDT'     TO DP013-DB2-TABLE-NAME (2)       48980000
489900             SET DP013-DB2-ABEND                                  48990000
490000                 DP013-XCTL-DISPLAY-RESTART                       49000000
490100                                 TO TRUE                          49010000
490200                                                                  49020000
490300             PERFORM DP013-0000-PROCESS-ABEND                     49030000
490400     END-EVALUATE.                                                49040000
490500/                                                                 49050000
490600 7070-OPEN-TRECDVS.                                               49060000
490700                                                                  49070000
490800     MOVE ASC-KEY-PO-NBR-N       TO  DK-PO-NBR.                   49080000
490900     MOVE ASC-KEY-PKSL-LNE-NBR   TO  DK-PKSL-LNE-NBR.             49090000
491000     MOVE ASC-KEY-REC-SEQ-NBR-N  TO  DK-REC-SEQ-NBR.              49100000
491100                                                                  49110000
491200     EXEC SQL                                                     49120000
491300          OPEN RECDVS-CURSOR                                      49130000
491400     END-EXEC                                                     49140000
491500                                                                  49150000
491600     EVALUATE TRUE                                                49160000
491700         WHEN SQLCODE = ZERO                                      49170000
491800              CONTINUE                                            49180000
491900         WHEN SQLCODE = -904                                      49190000
492000         WHEN SQLCODE = -911                                      49200000
492100         WHEN SQLCODE = -913                                      49210000
492200             PERFORM 9900-SOFT-ABORT                              49220000
492300         WHEN SQLWARN0 NOT = SPACES                               49230000
492400         WHEN SQLCODE      NOT = ZERO                             49240000
492500              MOVE '7070-OPEN-TRECDVS'                            49250000
492600                             TO DP013-PARAGRAPH                   49260000
492700              MOVE 'UNSUCCESSFUL RECDVS CURSOR OPEN'              49270000
492800                             TO DP013-MESSAGE-TEXT (1)            49280000
492900              MOVE SQLCA         TO DP013-SQLCA                   49290000
493000              MOVE 'TRECDVS' TO DP013-DB2-TABLE-NAME (1)          49300000
493100              SET DP013-XCTL-DISPLAY-RESTART                      49310000
493200                  DP013-DB2-ABEND                                 49320000
493300                             TO TRUE                              49330000
493400                                                                  49340000
493500              PERFORM DP013-0000-PROCESS-ABEND                    49350000
493600     END-EVALUATE.                                                49360000
493700/                                                                 49370000
493800 7075-FETCH-RECDVS.                                               49380000
493900                                                                  49390000
494000     EXEC SQL                                                     49400000
494100           FETCH RECDVS-CURSOR                                    49410000
494200            INTO :RECDVS-VRFY-SRC-CDE                             49420000
494300                ,:RECDVS-EXPTED-ITM-QTY                           49430000
494400                ,:RECDVS-VRFY-ITM-QTY                             49440000
494500     END-EXEC.                                                    49450000
494600                                                                  49460000
494700     EVALUATE TRUE                                                49470000
494800         WHEN SQLCODE = ZERO                                      49480000
494900             ADD 1 TO PV-RECDVS-COUNT                             49490000
495000         WHEN SQLCODE = +100                                      49500000
495100             SET ASC-NO-MORE-RECDVS  TO TRUE                      49510000
495200         WHEN SQLCODE = -904                                      49520000
495300         WHEN SQLCODE = -911                                      49530000
495400         WHEN SQLCODE = -913                                      49540000
495500             PERFORM 9900-SOFT-ABORT                              49550000
495600         WHEN SQLWARN0 NOT = SPACES                               49560000
495700         WHEN SQLCODE  NOT = ZERO                                 49570000
495800              MOVE '7075-FETCH-RECDVS'                            49580000
495900                                 TO DP013-PARAGRAPH               49590000
496000              MOVE 'UNSUCCESSFUL FETCH OF RECDVS CURSOR'          49600000
496100                                 TO DP013-MESSAGE-TEXT (1)        49610000
496200              MOVE SQLCA         TO DP013-SQLCA                   49620000
496300              MOVE 'TRECDVS'     TO DP013-DB2-TABLE-NAME (1)      49630000
496400              SET DP013-DB2-ABEND                                 49640000
496500                  DP013-XCTL-DISPLAY-RESTART                      49650000
496600                                 TO TRUE                          49660000
496700                                                                  49670000
496800              PERFORM DP013-0000-PROCESS-ABEND                    49680000
496900     END-EVALUATE.                                                49690000
497000/                                                                 49700000
497100 7080-CLOSE-TRECDVS.                                              49710000
497200                                                                  49720000
497300     EXEC SQL                                                     49730000
497400          CLOSE RECDVS-CURSOR                                     49740000
497500     END-EXEC.                                                    49750000
497600                                                                  49760000
497700     EVALUATE TRUE                                                49770000
497800         WHEN SQLCODE = ZERO                                      49780000
497900              CONTINUE                                            49790000
498000         WHEN SQLCODE = -904                                      49800000
498100         WHEN SQLCODE = -911                                      49810000
498200         WHEN SQLCODE = -913                                      49820000
498300             PERFORM 9900-SOFT-ABORT                              49830000
498400         WHEN SQLWARN0 NOT = SPACES                               49840000
498500         WHEN SQLCODE  NOT = ZERO                                 49850000
498600              MOVE '7080-CLOSE-TRECDVS'                           49860000
498700                                 TO DP013-PARAGRAPH               49870000
498800              MOVE 'UNSUCCESSFUL RECDVS CURSOR CLOSE'             49880000
498900                                 TO DP013-MESSAGE-TEXT (1)        49890000
499000              MOVE SQLCA         TO DP013-SQLCA                   49900000
499100              MOVE 'TRECDVS '    TO DP013-DB2-TABLE-NAME (1)      49910000
499200              SET DP013-DB2-ABEND                                 49920000
499300                  DP013-XCTL-DISPLAY-RESTART                      49930000
499400                                 TO TRUE                          49940000
499500                                                                  49950000
499600              PERFORM DP013-0000-PROCESS-ABEND                    49960000
499700     END-EVALUATE.                                                49970000
499800/                                                                 49980000
499900 7090-COUNT-SMOOTHED-CTNS.                                        49990000
500000                                                                  50000000
500100     MOVE ZERO                   TO PV-DB2-COUNT.                 50010000
500200     MOVE ASC-STR-NBR-N (ASC-BLK-SUB ASC-ITEM-SUB)                50020000
500300                                 TO DK-STR-NBR.                   50030000
500400     MOVE ASC-KEY-PO-NBR-N       TO DK-PO-NBR.                    50040000
500500     MOVE ASC-KEY-REC-SEQ-NBR-N  TO DK-REC-SEQ-NBR.               50050000
500600                                                                  50060000
500700     EXEC SQL                                                     50070000
500800         SELECT COUNT(DISTINCT(UPC.SHIPT_UNT_ID))                 50080000
500900         INTO :PV-DB2-COUNT                                       50090000
501000         FROM SUT_OTBND_UPC UPC                                   50100000
501100            , SUT_OTBND_CART UNT                                  50110000
501200         WHERE UPC.TRN_NBR              = :DK-PO-NBR              50120000
501300          AND  UPC.RCVR_SEQ_NBR         = :DK-REC-SEQ-NBR         50130000
501400          AND  UPC.SHIPT_UNT_ID         =  UNT.SHIPT_UNT_ID       50140000
501500          AND  UNT.DEST_LOC_NBR         =  :DK-STR-NBR            50150000
501600          AND  UNT.CART_SRC_CDE         =  'SMO'                  50160000
501700          AND  UNT.ACTV_IND             =  'Y'                    50170000
501800     END-EXEC.                                                    50180000
501900                                                                  50190000
502000     EVALUATE TRUE                                                50200000
502100         WHEN SQLCODE = ZERO                                      50210000
502200         WHEN SQLCODE = +100                                      50220000
502300             CONTINUE                                             50230000
502400         WHEN SQLCODE = -904                                      50240000
502500         WHEN SQLCODE = -913                                      50250000
502600         WHEN SQLCODE = -911                                      50260000
502700             PERFORM 9900-SOFT-ABORT                              50270000
502800         WHEN SQLWARN0 NOT = SPACES                               50280000
502900         WHEN SQLCODE < ZERO                                      50290000
503000         WHEN SQLCODE > ZERO                                      50300000
503100             MOVE '7090-COUNT-SMOOTHED-CTNS'                      50310000
503200                               TO DP013-PARAGRAPH                 50320000
503300             MOVE 'COUNT SMOOTHED CARTONS FOR PO/RCVR/STR'        50330000
503400                               TO DP013-MESSAGE-TEXT (1)          50340000
503500             MOVE SQLCA        TO DP013-SQLCA                     50350000
503600             MOVE 'SUT00028'   TO DP013-DB2-TABLE-NAME (1)        50360000
503700             MOVE 'SUT00024'   TO DP013-DB2-TABLE-NAME (2)        50370000
503800             SET DP013-DB2-ABEND                                  50380000
503900                 DP013-XCTL-DISPLAY-RESTART TO TRUE               50390000
504000             PERFORM DP013-0000-PROCESS-ABEND                     50400000
504100     END-EVALUATE.                                                50410000
504200                                                                  50420000
504300/                                                                 50430000
504400 7100-OPEN-CURSOR.                                                50440000
504500                                                                  50450000
504600     EXEC SQL                                                     50460000
504700          OPEN RECDIS-CURSOR                                      50470000
504800     END-EXEC                                                     50480000
504900                                                                  50490000
505000     EVALUATE TRUE                                                50500000
505100         WHEN SQLCODE = ZERO                                      50510000
505200              CONTINUE                                            50520000
505300         WHEN SQLCODE = -904                                      50530000
505400         WHEN SQLCODE = -911                                      50540000
505500         WHEN SQLCODE = -913                                      50550000
505600             PERFORM 9900-SOFT-ABORT                              50560000
505700         WHEN SQLWARN0 NOT = SPACES                               50570000
505800         WHEN SQLCODE      NOT = ZERO                             50580000
505900              MOVE '7100-OPEN-CURSOR'                             50590000
506000                             TO DP013-PARAGRAPH                   50600000
506100              MOVE 'UNSUCCESSFUL RECDIS CURSOR OPEN'              50610000
506200                             TO DP013-MESSAGE-TEXT (1)            50620000
506300              MOVE SQLCA         TO DP013-SQLCA                   50630000
506400              MOVE 'TRECDIS' TO DP013-DB2-TABLE-NAME (1)          50640000
506500              SET DP013-XCTL-DISPLAY-RESTART                      50650000
506600                  DP013-DB2-ABEND                                 50660000
506700                             TO TRUE                              50670000
506800                                                                  50680000
506900              PERFORM DP013-0000-PROCESS-ABEND                    50690000
507000     END-EVALUATE.                                                50700000
507100/                                                                 50710000
507200 7110-FETCH-RECDIS.                                               50720000
507300                                                                  50730000
507400     EXEC SQL                                                     50740000
507500          FETCH  RECDIS-CURSOR                                    50750000
507600           INTO :RECDIS-EXPTED-ITM-QTY                            50760000
507700              , :RECDIS-VERIFY-ITM-QTY                            50770000
507800              , :RECDIS-AP-VERIFY-ITM-QTY                         50780000
507900              , :RECDIS-STR-NBR                                   50790000
508000     END-EXEC.                                                    50800000
508100                                                                  50810000
508200     EVALUATE TRUE                                                50820000
508300         WHEN SQLCODE = ZERO                                      50830000
508400             CONTINUE                                             50840000
508500         WHEN SQLCODE = +100                                      50850000
508600             SET ASC-NO-MORE-RECDIS  TO TRUE                      50860000
508700         WHEN SQLCODE = -904                                      50870000
508800         WHEN SQLCODE = -911                                      50880000
508900         WHEN SQLCODE = -913                                      50890000
509000             PERFORM 9900-SOFT-ABORT                              50900000
509100         WHEN SQLWARN0 NOT = SPACES                               50910000
509200         WHEN SQLCODE  NOT = ZERO                                 50920000
509300              MOVE '7110-FETCH-RECDIS'                            50930000
509400                                 TO DP013-PARAGRAPH               50940000
509500              MOVE 'UNSUCCESSFUL FETCH OF RECDIS CURSOR'          50950000
509600                                 TO DP013-MESSAGE-TEXT (1)        50960000
509700              MOVE SQLCA         TO DP013-SQLCA                   50970000
509800              MOVE 'TRECDIS'     TO DP013-DB2-TABLE-NAME (1)      50980000
509900              SET DP013-DB2-ABEND                                 50990000
510000                  DP013-XCTL-DISPLAY-RESTART                      51000000
510100                                 TO TRUE                          51010000
510200                                                                  51020000
510300              PERFORM DP013-0000-PROCESS-ABEND                    51030000
510400     END-EVALUATE.                                                51040000
510500/                                                                 51050000
510600 7120-CLOSE-CURSOR.                                               51060000
510700                                                                  51070000
510800     EXEC SQL                                                     51080000
510900          CLOSE RECDIS-CURSOR                                     51090000
511000     END-EXEC.                                                    51100000
511100                                                                  51110000
511200     EVALUATE TRUE                                                51120000
511300         WHEN SQLCODE = ZERO                                      51130000
511400              CONTINUE                                            51140000
511500         WHEN SQLCODE = -904                                      51150000
511600         WHEN SQLCODE = -911                                      51160000
511700         WHEN SQLCODE = -913                                      51170000
511800             PERFORM 9900-SOFT-ABORT                              51180000
511900         WHEN SQLWARN0 NOT = SPACES                               51190000
512000         WHEN SQLCODE  NOT = ZERO                                 51200000
512100              MOVE '7120-CLOSE-CURSOR'                            51210000
512200                                 TO DP013-PARAGRAPH               51220000
512300              MOVE 'UNSUCCESSFUL RECDIS CURSOR CLOSE'             51230000
512400                                 TO DP013-MESSAGE-TEXT (1)        51240000
512500              MOVE SQLCA         TO DP013-SQLCA                   51250000
512600              MOVE 'TRECDIS '    TO DP013-DB2-TABLE-NAME (1)      51260000
512700              SET DP013-DB2-ABEND                                 51270000
512800                  DP013-XCTL-DISPLAY-RESTART                      51280000
512900                                 TO TRUE                          51290000
513000                                                                  51300000
513100              PERFORM DP013-0000-PROCESS-ABEND                    51310000
513200     END-EVALUATE.                                                51320000
513300/                                                                 51330000
513400 7200-SELECT-RECDIS.                                              51340000
513500                                                                  51350000
513600     EXEC SQL                                                     51360000
513700         SELECT ORD_NBR                                           51370000
513800              , ORD_LNE_NBR                                       51380000
513900              , REC_SEQ_NBR                                       51390000
514000              , OPER_UNT_ID                                       51400000
514100              , FCLTY_ID                                          51410000
514200              , CRE_TMST                                          51420000
514300              , CRE_UID                                           51430000
514400              , VER_STATUS_CDE                                    51440000
514500              , EXPTED_ITM_QTY                                    51450000
514600              , VERIFY_ITM_QTY                                    51460000
514700              , AP_VERIFY_ITM_QTY                                 51470000
514800              , STR_NBR                                           51480000
514900              , STR_FCLTY_ID                                      51490000
515000              , PLAN_ITM_QTY                                      51500000
515100              , AP_PRC_CDE                                        51510000
515200              , AP_PRC_DTE                                        51520000
515300              , CURRENT TIMESTAMP                                 51530000
515400          INTO      :RECDIS-ORD-NBR                               51540000
515500              , :RECDIS-ORD-LNE-NBR                               51550000
515600              , :RECDIS-REC-SEQ-NBR                               51560000
515700              , :RECDIS-OPER-UNT-ID                               51570000
515800              , :RECDIS-FCLTY-ID                                  51580000
515900              , :RECDIS-CRE-TMST                                  51590000
516000              , :RECDIS-CRE-UID                                   51600000
516100              , :RECDIS-VER-STATUS-CDE                            51610000
516200              , :RECDIS-EXPTED-ITM-QTY                            51620000
516300              , :RECDIS-VERIFY-ITM-QTY                            51630000
516400              , :RECDIS-AP-VERIFY-ITM-QTY                         51640000
516500              , :RECDIS-STR-NBR                                   51650000
516600              , :RECDIS-STR-FCLTY-ID                              51660000
516700              , :RECDIS-PLAN-ITM-QTY                              51670000
516800              , :RECDIS-AP-PRC-CDE                                51680000
516900              , :RECDIS-AP-PRC-DTE                                51690000
517000              , :PV-CURRENT-TIMESTAMP                             51700000
517100           FROM TRECDIS                                           51710000
517200          WHERE ORD_NBR            = :DK-PO-NBR                   51720000
517300            AND ORD_LNE_NBR        = :DK-PKSL-LNE-NBR             51730000
517400            AND REC_SEQ_NBR        = :DK-REC-SEQ-NBR              51740000
517500            AND OPER_UNT_ID        = :ASC-KEY-OPER-UNT-ID         51750000
517600            AND FCLTY_ID           = :ASC-KEY-FCLTY-ID            51760000
517700            AND STR_NBR            = :RECDIS-STR-NBR              51770000
517800            AND STR_FCLTY_ID       = 1                            51780000
518000     END-EXEC                                                     51800000
518100                                                                  51810000
518200     EVALUATE TRUE                                                51820000
518300         WHEN SQLCODE = ZERO                                      51830000
518400             SET PS-DATA-OK TO TRUE                               51840000
518500         WHEN SQLCODE = +100                                      51850000
518600              CONTINUE                                            51860000
518700         WHEN SQLCODE = -904                                      51870000
518800         WHEN SQLCODE = -911                                      51880000
518900         WHEN SQLCODE = -913                                      51890000
519000             PERFORM 9900-SOFT-ABORT                              51900000
519100         WHEN SQLWARN0 NOT = SPACES                               51910000
519200         WHEN SQLCODE      NOT = ZERO                             51920000
519300              MOVE '7200-SELECT-RECDIS'                           51930000
519400                             TO DP013-PARAGRAPH                   51940000
519500              MOVE 'UNSUCCESSFUL SELECT OF TRECDIS'               51950000
519600                             TO DP013-MESSAGE-TEXT (1)            51960000
519700              MOVE SQLCA         TO DP013-SQLCA                   51970000
519800              MOVE 'TRECDIS' TO DP013-DB2-TABLE-NAME (1)          51980000
519900              SET DP013-DB2-ABEND                                 51990000
520000                  DP013-XCTL-DISPLAY-RESTART                      52000000
520100                             TO TRUE                              52010000
520200              PERFORM DP013-0000-PROCESS-ABEND                    52020000
520300     END-EVALUATE.                                                52030000
520400/                                                                 52040000
520500 7210-UPDATE-RECDIS.                                              52050000
520600                                                                  52060000
520700     EXEC SQL                                                     52070000
520800       UPDATE TRECDIS                                             52080000
520900          SET VERIFY_ITM_QTY     = :RECDIS-VERIFY-ITM-QTY         52090000
521000             ,AP_VERIFY_ITM_QTY  = :RECDIS-AP-VERIFY-ITM-QTY      52100000
521100        WHERE ORD_NBR            = :DK-PO-NBR                     52110000
521200          AND ORD_LNE_NBR        = :DK-PKSL-LNE-NBR               52120000
521300          AND REC_SEQ_NBR        = :DK-REC-SEQ-NBR                52130000
521400          AND OPER_UNT_ID        = :ASC-KEY-OPER-UNT-ID           52140000
521500          AND FCLTY_ID           = :ASC-KEY-FCLTY-ID              52150000
521600          AND STR_NBR            = :RECDIS-STR-NBR                52160000
521700          AND STR_FCLTY_ID       = 1                              52170000
521900     END-EXEC                                                     52190000
522000                                                                  52200000
522100     EVALUATE TRUE                                                52210000
522200         WHEN SQLCODE = ZERO                                      52220000
522300              SET PS-UPDATE-TRECITM TO TRUE                       52230000
522400         WHEN SQLCODE = +100                                      52240000
522500              CONTINUE                                            52250000
522600         WHEN SQLCODE = -904                                      52260000
522700         WHEN SQLCODE = -911                                      52270000
522800         WHEN SQLCODE = -913                                      52280000
522900             SET PS-UPDATES-DONE TO TRUE                          52290000
523000             PERFORM 9900-SOFT-ABORT                              52300000
523100         WHEN SQLWARN0 NOT = SPACES                               52310000
523200         WHEN SQLCODE      NOT = ZERO                             52320000
523300              MOVE '7210-UPDATE-RECDIS'                           52330000
523400                             TO DP013-PARAGRAPH                   52340000
523500              MOVE 'UNSUCCESSFUL UPDATE OF TRECDIS'               52350000
523600                             TO DP013-MESSAGE-TEXT (1)            52360000
523700              MOVE SQLCA         TO DP013-SQLCA                   52370000
523800              MOVE 'TRECDIS' TO DP013-DB2-TABLE-NAME (1)          52380000
523900              SET DP013-DB2-ABEND                                 52390000
524000                  DP013-XCTL-DISPLAY-RESTART                      52400000
524100                             TO TRUE                              52410000
524200              PERFORM DP013-0000-PROCESS-ABEND                    52420000
524300     END-EVALUATE.                                                52430000
524400/                                                                 52440000
524500 7220-GET-RECDIS-QTY.                                             52450000
524600                                                                  52460000
524700     EXEC SQL                                                     52470000
524800          SELECT                                                  52480000
524900                 SUM(C.AP_VERIFY_ITM_QTY)                         52490000
525000           INTO                                                   52500000
525100                 :RECDIS-AP-VERIFY-ITM-QTY :PV-NULL-IND           52510000
525200           FROM                                                   52520000
525300                 TRECEIV A                                        52530000
525400               , TRECITM B                                        52540000
525500               , TRECDIS C                                        52550000
525600           WHERE                                                  52560000
525700                 A.ORD_NBR         =  :DK-PO-NBR                  52570000
525800            AND  A.ORD_NBR         =  B.ORD_NBR                   52580000
525900            AND  A.ORD_NBR         =  C.ORD_NBR                   52590000
526000            AND  B.ORD_LNE_NBR     =  :DK-PKSL-LNE-NBR            52600000
526100            AND  B.ORD_LNE_NBR     =  C.ORD_LNE_NBR               52610000
526200            AND  A.VER_STATUS_CDE  =  :PC-A                       52620000
526300            AND  B.VER_STATUS_CDE  =  :PC-A                       52630000
526500            AND  B.STATUS_CDE      =  :PC-VE                      52650000
526600            AND  A.REC_SEQ_NBR     =  B.REC_SEQ_NBR               52660000
526700            AND  A.REC_SEQ_NBR     =  C.REC_SEQ_NBR               52670000
526800     END-EXEC.                                                    52680000
526900                                                                  52690000
527000     EVALUATE TRUE                                                52700000
527100         WHEN SQLCODE = ZERO                                      52710000
527200         WHEN SQLCODE = +100                                      52720000
527300              CONTINUE                                            52730000
527400         WHEN SQLCODE = -904                                      52740000
527500         WHEN SQLCODE = -911                                      52750000
527600         WHEN SQLCODE = -913                                      52760000
527700             PERFORM 9900-SOFT-ABORT                              52770000
527800         WHEN SQLWARN0 NOT = SPACE                                52780000
527900         WHEN SQLCODE NOT = ZERO                                  52790000
528000              MOVE '7220-GET-RECDIS-QTY'                          52800000
528100                               TO DP013-PARAGRAPH                 52810000
528200              MOVE 'SUM RECDIS VERIFY QUANTITY'                   52820000
528300                               TO DP013-MESSAGE-TEXT (1)          52830000
528400              MOVE 'TRECDIS '  TO DP013-DB2-TABLE-NAME (1)        52840000
528500              MOVE SQLCA       TO DP013-SQLCA                     52850000
528600              SET DP013-DB2-ABEND                                 52860000
528700                               TO TRUE                            52870000
528800              PERFORM DP013-0000-PROCESS-ABEND                    52880000
528900     END-EVALUATE.                                                52890000
529000/                                                                 52900000
529100 7400-SELECT-TRECITM.                                             52910000
529200                                                                  52920000
529300     EXEC SQL                                                     52930000
529400          SELECT                                                  52940000
529500                ORD_NBR                                           52950000
529600              , ORD_LNE_NBR                                       52960000
529700              , REC_SEQ_NBR                                       52970000
529800              , OPER_UNT_ID                                       52980000
529900              , FCLTY_ID                                          52990000
530000              , CRE_TMST                                          53000000
530100              , CRE_UID                                           53010000
530200              , PO_VER_NBR                                        53020000
530300              , ITM_NBR                                           53030000
530400              , PRE_TKT_IND                                       53040000
530500              , TKT_FMT_ID                                        53050000
530600              , RTV_IND                                           53060000
530700              , STATUS_CDE                                        53070000
530800              , VER_STATUS_CDE                                    53080000
530900              , PKSL_ITM_QTY                                      53090000
531000              , DTL_CK_ITM_QTY                                    53100000
531100              , INNR_PACK_QTY                                     53110000
531200              , CASE_PACK_QTY                                     53120000
531300              , RTV_QTY                                           53130000
531400              , EXPTED_CART_CNT                                   53140000
531500              , ACTL_CART_CNT                                     53150000
531600              , MKING_APRON_TMST                                  53160000
531700              , UNT_COST_AMT                                      53170000
531800              , COLOR_DESC                                        53180000
531900              , SIZE_DESC                                         53190000
532000              , VEND_STYL_NAME                                    53200000
532100              , VEND_DESC                                         53210000
532200              , VERFYD_TMST                                       53220000
532300              , PKSL_NBR                                          53230000
532400              , REC_INV_LNE_NBR                                   53240000
532500              , DMG_ITM_QTY                                       53250000
532600              , UPD_TMST                                          53260000
532700              , UPD_UID                                           53270000
532800              , UPD_PGM_ID                                        53280000
532900              , RCPT_DISTR_UPD_CDE                                53290000
533000              , CURRENT TIMESTAMP                                 53300000
533100          INTO                                                    53310000
533200                :RECITM-ORD-NBR                                   53320000
533300              , :RECITM-ORD-LNE-NBR                               53330000
533400              , :RECITM-REC-SEQ-NBR                               53340000
533500              , :RECITM-OPER-UNT-ID                               53350000
533600              , :RECITM-FCLTY-ID                                  53360000
533700              , :RECITM-CRE-TMST                                  53370000
533800              , :RECITM-CRE-UID                                   53380000
533900              , :RECITM-PO-VER-NBR                                53390000
534000              , :RECITM-ITM-NBR                                   53400000
534100              , :RECITM-PRE-TKT-IND                               53410000
534200              , :RECITM-TKT-FMT-ID                                53420000
534300              , :RECITM-RTV-IND                                   53430000
534400              , :RECITM-STATUS-CDE                                53440000
534500              , :RECITM-VER-STATUS-CDE                            53450000
534600              , :RECITM-PKSL-ITM-QTY                              53460000
534700              , :RECITM-DTL-CK-ITM-QTY                            53470000
534800              , :RECITM-INNR-PACK-QTY                             53480000
534900              , :RECITM-CASE-PACK-QTY                             53490000
535000              , :RECITM-RTV-QTY                                   53500000
535100              , :RECITM-EXPTED-CART-CNT                           53510000
535200              , :RECITM-ACTL-CART-CNT                             53520000
535300              , :RECITM-MKING-APRON-TMST                          53530000
535400              , :RECITM-UNT-COST-AMT                              53540000
535500              , :RECITM-COLOR-DESC                                53550000
535600              , :RECITM-SIZE-DESC                                 53560000
535700              , :RECITM-VEND-STYL-NAME                            53570000
535800              , :RECITM-VEND-DESC                                 53580000
535900              , :RECITM-VERFYD-TMST                               53590000
536000              , :RECITM-PKSL-NBR                                  53600000
536100              , :RECITM-REC-INV-LNE-NBR                           53610000
536200              , :RECITM-DMG-ITM-QTY                               53620000
536300              , :RECITM-UPD-TMST                                  53630000
536400              , :RECITM-UPD-UID                                   53640000
536500              , :RECITM-UPD-PGM-ID                                53650000
536600              , :RECITM-RCPT-DISTR-UPD-CDE                        53660000
536700              , :PV-CURRENT-TIMESTAMP                             53670000
536800          FROM                                                    53680000
536900                TRECITM                                           53690000
537000          WHERE                                                   53700000
537100                 ORD_NBR          =  :DK-PO-NBR                   53710000
537200          AND    ORD_LNE_NBR      =  :DK-PKSL-LNE-NBR             53720000
537300          AND    REC_SEQ_NBR      =  :DK-REC-SEQ-NBR              53730000
537400          AND    OPER_UNT_ID      =  :ASC-KEY-OPER-UNT-ID         53740000
537500          AND    FCLTY_ID         =  :ASC-KEY-FCLTY-ID            53750000
537600          AND    VER_STATUS_CDE   =  :PC-ACTIVE                   53760000
537700     END-EXEC.                                                    53770000
537800                                                                  53780000
537900     EVALUATE TRUE                                                53790000
538000         WHEN SQLCODE = ZERO                                      53800000
538100              CONTINUE                                            53810000
538200         WHEN SQLCODE = +100                                      53820000
538300              SET PS-DATA-NOT-OK    TO  TRUE                      53830000
538400         WHEN SQLCODE = -904                                      53840000
538500         WHEN SQLCODE = -911                                      53850000
538600         WHEN SQLCODE = -913                                      53860000
538700             PERFORM 9900-SOFT-ABORT                              53870000
538800         WHEN SQLWARN0 NOT = SPACE                                53880000
538900         WHEN SQLCODE NOT = ZERO                                  53890000
539000              MOVE '7400-SELECT-TRECITM'                          53900000
539100                               TO DP013-PARAGRAPH                 53910000
539200              MOVE 'SELECT TRECITM'                               53920000
539300                               TO DP013-MESSAGE-TEXT (1)          53930000
539400              MOVE 'TRECITM '  TO DP013-DB2-TABLE-NAME (1)        53940000
539500              MOVE SQLCA       TO DP013-SQLCA                     53950000
539600              SET DP013-DB2-ABEND                                 53960000
539700                               TO TRUE                            53970000
539800              PERFORM DP013-0000-PROCESS-ABEND                    53980000
539900     END-EVALUATE.                                                53990000
540000/                                                                 54000000
540100 7410-UPDATE-TRECITM.                                             54010000
540200                                                                  54020000
540300     EXEC SQL                                                     54030000
540400          UPDATE                                                  54040000
540500                TRECITM                                           54050000
540600          SET   RCPT_DISTR_UPD_CDE =  :PV-RCPT-DISTR-UPD-CDE      54060000
540700          WHERE                                                   54070000
540800                 ORD_NBR          =  :DK-PO-NBR                   54080000
540900          AND    ORD_LNE_NBR      =  :DK-PKSL-LNE-NBR             54090000
541000          AND    REC_SEQ_NBR      =  :DK-REC-SEQ-NBR              54100000
541100          AND    OPER_UNT_ID      =  :ASC-KEY-OPER-UNT-ID         54110000
541200          AND    FCLTY_ID         =  :ASC-KEY-FCLTY-ID            54120000
541300          AND    VER_STATUS_CDE   =  :PC-ACTIVE                   54130000
541400     END-EXEC.                                                    54140000
541500                                                                  54150000
541600     EVALUATE TRUE                                                54160000
541700         WHEN SQLCODE = ZERO                                      54170000
541800              CONTINUE                                            54180000
541900         WHEN SQLCODE = -904                                      54190000
542000         WHEN SQLCODE = -911                                      54200000
542100         WHEN SQLCODE = -913                                      54210000
542200             SET PS-UPDATES-DONE TO TRUE                          54220000
542300             PERFORM 9900-SOFT-ABORT                              54230000
542400         WHEN SQLWARN0 NOT = SPACE                                54240000
542500         WHEN SQLCODE NOT = ZERO                                  54250000
542600              MOVE '7410-UPDATE-TRECITM'                          54260000
542700                               TO DP013-PARAGRAPH                 54270000
542800              MOVE 'UPDATE TRECITM STATUS CODE'                   54280000
542900                               TO DP013-MESSAGE-TEXT (1)          54290000
543000              MOVE 'TRECITM '  TO DP013-DB2-TABLE-NAME (1)        54300000
543100              MOVE SQLCA       TO DP013-SQLCA                     54310000
543200              SET DP013-DB2-ABEND                                 54320000
543300                               TO TRUE                            54330000
543400              PERFORM DP013-0000-PROCESS-ABEND                    54340000
543500     END-EVALUATE.                                                54350000
543600/                                                                 54360000
543700 7500-GET-PURITM.                                                 54370000
543800                                                                  54380000
543900     EXEC SQL                                                     54390000
544000          SELECT                                                  54400000
544100                  PO_NBR                                          54410000
544200                , VER_NBR                                         54420000
544300                , PO_LNE_NBR                                      54430000
544400                , VER_STATUS_CDE                                  54440000
544500                , SKU_SEQ_NBR                                     54450000
544600                , CL_NBR                                          54460000
544700                , VEND_STYL_NAME                                  54470000
544800                , COLOR_DESC                                      54480000
544900                , SIZE_DESC                                       54490000
545000                , UM_IND                                          54500000
545100                , UNT_QTY                                         54510000
545200                , UNT_RTL_PR_AMT                                  54520000
545300                , UNT_COST_AMT                                    54530000
545400                , TOT_VAL_COST_AMT                                54540000
545500                , TOT_VAL_RTL_AMT                                 54550000
545600                , MU_PCT                                          54560000
545700                , CRE_TMST                                        54570000
545800                , LAST_UPD_TMST                                   54580000
545900                , ITM_NBR                                         54590000
546000                , SKU_DESC                                        54600000
546100                , COLOR_CDE                                       54610000
546200                , SIZE_CDE                                        54620000
546300                , AD_EVNT_DTE                                     54630000
546400                , STATUS_CDE                                      54640000
546500                , CRE_BY_UID                                      54650000
546600                , LAST_UPD_BY_UID                                 54660000
546700                , GP_RTL_AMT                                      54670000
546800                , GP_QTY                                          54680000
546900                , APP_PO_LNE_NBR                                  54690000
547000                , PIC_ITM_IND                                     54700000
547100                , PIC_PG_NBR                                      54710000
547200                , PRD_1ST_COST_AMT                                54720000
547300                , PO_PREPK_ID                                     54730000
547400                , PREPK_RATO_QTY                                  54740000
547500                , SHIP_TO_TMP_DC_IND                              54750000
547600                , RMS_PO_SKU_NBR                                  54760000
547700                , CNCLD_UNT_QTY                                   54770000
547800           INTO                                                   54780000
547900                  :PURITM-PO-NBR                                  54790000
548000                , :PURITM-VER-NBR                                 54800000
548100                , :PURITM-PO-LNE-NBR                              54810000
548200                , :PURITM-VER-STATUS-CDE                          54820000
548300                , :PURITM-SKU-SEQ-NBR                             54830000
548400                , :PURITM-CL-NBR                                  54840000
548500                , :PURITM-VEND-STYL-NAME                          54850000
548600                , :PURITM-COLOR-DESC                              54860000
548700                , :PURITM-SIZE-DESC                               54870000
548800                , :PURITM-UM-IND                                  54880000
548900                , :PURITM-UNT-QTY                                 54890000
549000                , :PURITM-UNT-RTL-PR-AMT                          54900000
549100                , :PURITM-UNT-COST-AMT                            54910000
549200                , :PURITM-TOT-VAL-COST-AMT                        54920000
549300                , :PURITM-TOT-VAL-RTL-AMT                         54930000
549400                , :PURITM-MU-PCT                                  54940000
549500                , :PURITM-CRE-TMST                                54950000
549600                , :PURITM-LAST-UPD-TMST                           54960000
549700                , :PURITM-ITM-NBR                                 54970000
549800                , :PURITM-SKU-DESC                                54980000
549900                , :PURITM-COLOR-CDE                               54990000
550000                , :PURITM-SIZE-CDE                                55000000
550100                , :PURITM-AD-EVNT-DTE                             55010000
550200                , :PURITM-STATUS-CDE                              55020000
550300                , :PURITM-CRE-BY-UID                              55030000
550400                , :PURITM-LAST-UPD-BY-UID                         55040000
550500                , :PURITM-GP-RTL-AMT                              55050000
550600                , :PURITM-GP-QTY                                  55060000
550700                , :PURITM-APP-PO-LNE-NBR                          55070000
550800                , :PURITM-PIC-ITM-IND                             55080000
550900                , :PURITM-PIC-PG-NBR                              55090000
551000                , :PURITM-PRD-1ST-COST-AMT                        55100000
551100                , :PURITM-PO-PREPK-ID                             55110000
551200                , :PURITM-PREPK-RATO-QTY                          55120000
551300                , :PURITM-SHIP-TO-TMP-DC-IND                      55130000
551400                , :PURITM-RMS-PO-SKU-NBR                          55140000
551500                , :PURITM-CNCLD-UNT-QTY                           55150000
551600           FROM                                                   55160000
551700                  TPURITM                                         55170000
551800          WHERE                                                   55180000
551900                  PO_NBR             =  :DK-PO-NBR                55190000
552000           AND    APP_PO_LNE_NBR     =  :DK-PKSL-LNE-NBR          55200000
552100           AND    VER_STATUS_CDE     =  :PC-A                     55210000
552200     END-EXEC.                                                    55220000
552300                                                                  55230000
552400     EVALUATE TRUE                                                55240000
552500         WHEN SQLCODE = ZERO                                      55250000
552600         WHEN SQLCODE = +100                                      55260000
552700              CONTINUE                                            55270000
552800         WHEN SQLCODE = -904                                      55280000
552900         WHEN SQLCODE = -911                                      55290000
553000         WHEN SQLCODE = -913                                      55300000
553100             PERFORM 9900-SOFT-ABORT                              55310000
553200         WHEN SQLWARN0 NOT = SPACE                                55320000
553300         WHEN SQLCODE NOT = ZERO                                  55330000
553400              MOVE '7500-GET-PURITM'                              55340000
553500                               TO DP013-PARAGRAPH                 55350000
553600              MOVE 'SUM RECDIS VERIFY QUANTITY'                   55360000
553700                               TO DP013-MESSAGE-TEXT (1)          55370000
553800              MOVE 'TPURITM '  TO DP013-DB2-TABLE-NAME (1)        55380000
553900              MOVE SQLCA       TO DP013-SQLCA                     55390000
554000              SET DP013-DB2-ABEND                                 55400000
554100                               TO TRUE                            55410000
554200              PERFORM DP013-0000-PROCESS-ABEND                    55420000
554300     END-EVALUATE.                                                55430000
554400/                                                                 55440000
554500 7510-UPDATE-PURITM.                                              55450000
554600                                                                  55460000
554700     EXEC SQL                                                     55470000
554800          UPDATE                                                  55480000
554900                 TPURITM                                          55490000
555000          SET    VER_STATUS_CDE   =  :PC-I                        55500000
555100          WHERE                                                   55510000
555200                 PO_NBR           =  :DK-PO-NBR                   55520000
555300          AND    APP_PO_LNE_NBR   =  :DK-PKSL-LNE-NBR             55530000
555400          AND    VER_STATUS_CDE   =  :PC-A                        55540000
555500     END-EXEC.                                                    55550000
555600                                                                  55560000
555700     EVALUATE TRUE                                                55570000
555800         WHEN SQLCODE = ZERO                                      55580000
555900              CONTINUE                                            55590000
556000         WHEN SQLCODE = -904                                      55600000
556100         WHEN SQLCODE = -911                                      55610000
556200         WHEN SQLCODE = -913                                      55620000
556300             SET PS-UPDATES-DONE TO TRUE                          55630000
556400             PERFORM 9900-SOFT-ABORT                              55640000
556500         WHEN SQLWARN0 NOT = SPACE                                55650000
556600         WHEN SQLCODE NOT = ZERO                                  55660000
556700              MOVE '7510-UPDATE-PURITM'                           55670000
556800                               TO DP013-PARAGRAPH                 55680000
556900              MOVE 'SET CURRENT ROW TO INACTIVE'                  55690000
557000                               TO DP013-MESSAGE-TEXT (1)          55700000
557100              MOVE 'TPURITM '  TO DP013-DB2-TABLE-NAME (1)        55710000
557200              MOVE SQLCA       TO DP013-SQLCA                     55720000
557300              SET DP013-DB2-ABEND                                 55730000
557400                               TO TRUE                            55740000
557500              PERFORM DP013-0000-PROCESS-ABEND                    55750000
557600     END-EVALUATE.                                                55760000
557700/                                                                 55770000
557800 7520-INSERT-PURITM.                                              55780000
557900                                                                  55790000
558000     EXEC SQL                                                     55800000
558100          INSERT                                                  55810000
558200           INTO   TPURITM                                         55820000
558300                 (PO_NBR                                          55830000
558400                , VER_NBR                                         55840000
558500                , PO_LNE_NBR                                      55850000
558600                , VER_STATUS_CDE                                  55860000
558700                , SKU_SEQ_NBR                                     55870000
558800                , CL_NBR                                          55880000
558900                , VEND_STYL_NAME                                  55890000
559000                , COLOR_DESC                                      55900000
559100                , SIZE_DESC                                       55910000
559200                , UM_IND                                          55920000
559300                , UNT_QTY                                         55930000
559400                , UNT_RTL_PR_AMT                                  55940000
559500                , UNT_COST_AMT                                    55950000
559600                , TOT_VAL_COST_AMT                                55960000
559700                , TOT_VAL_RTL_AMT                                 55970000
559800                , MU_PCT                                          55980000
559900                , CRE_TMST                                        55990000
560000                , LAST_UPD_TMST                                   56000000
560100                , ITM_NBR                                         56010000
560200                , SKU_DESC                                        56020000
560300                , COLOR_CDE                                       56030000
560400                , SIZE_CDE                                        56040000
560500                , AD_EVNT_DTE                                     56050000
560600                , STATUS_CDE                                      56060000
560700                , CRE_BY_UID                                      56070000
560800                , LAST_UPD_BY_UID                                 56080000
560900                , GP_RTL_AMT                                      56090000
561000                , GP_QTY                                          56100000
561100                , APP_PO_LNE_NBR                                  56110000
561200                , PIC_ITM_IND                                     56120000
561300                , PIC_PG_NBR                                      56130000
561400                , PRD_1ST_COST_AMT                                56140000
561500                , STAT_TMST                                       56150000
561600                , PO_PREPK_ID                                     56160000
561700                , PREPK_RATO_QTY                                  56170000
561800                , SHIP_TO_TMP_DC_IND                              56180000
561900                , RMS_PO_SKU_NBR                                  56190000
562000                , CNCLD_UNT_QTY                                   56200000
562100                  )                                               56210000
562200          VALUES                                                  56220000
562300                 (:PURITM-PO-NBR                                  56230000
562400                , :PURITM-VER-NBR                                 56240000
562500                , :PURITM-PO-LNE-NBR                              56250000
562600                , :PC-A                                           56260000
562700                , :PURITM-SKU-SEQ-NBR                             56270000
562800                , :PURITM-CL-NBR                                  56280000
562900                , :PURITM-VEND-STYL-NAME                          56290000
563000                , :PURITM-COLOR-DESC                              56300000
563100                , :PURITM-SIZE-DESC                               56310000
563200                , :PURITM-UM-IND                                  56320000
563300                , :PURITM-UNT-QTY                                 56330000
563400                , :PURITM-UNT-RTL-PR-AMT                          56340000
563500                , :PURITM-UNT-COST-AMT                            56350000
563600                , :PURITM-TOT-VAL-COST-AMT                        56360000
563700                , :PURITM-TOT-VAL-RTL-AMT                         56370000
563800                , :PURITM-MU-PCT                                  56380000
563900                , :PURITM-CRE-TMST                                56390000
564000                ,  CURRENT TIMESTAMP                              56400000
564100                , :PURITM-ITM-NBR                                 56410000
564200                , :PURITM-SKU-DESC                                56420000
564300                , :PURITM-COLOR-CDE                               56430000
564400                , :PURITM-SIZE-CDE                                56440000
564500                , :PURITM-AD-EVNT-DTE                             56450000
564600                , :ASC-PURITM-STATUS-CDE                          56460000
564700                , :PURITM-CRE-BY-UID                              56470000
564800                , :DP020-USERID                                   56480000
564900                , :PURITM-GP-RTL-AMT                              56490000
565000                , :PURITM-GP-QTY                                  56500000
565100                , :PURITM-APP-PO-LNE-NBR                          56510000
565200                , :PURITM-PIC-ITM-IND                             56520000
565300                , :PURITM-PIC-PG-NBR                              56530000
565400                , :PURITM-PRD-1ST-COST-AMT                        56540000
565500                , CURRENT TIMESTAMP                               56550000
565600                , :PURITM-PO-PREPK-ID                             56560000
565700                , :PURITM-PREPK-RATO-QTY                          56570000
565800                , :PURITM-SHIP-TO-TMP-DC-IND                      56580000
565900                , :PURITM-RMS-PO-SKU-NBR                          56590000
566000                , :PURITM-CNCLD-UNT-QTY                           56600000
566100                  )                                               56610000
566200     END-EXEC.                                                    56620000
566300                                                                  56630000
566400     EVALUATE TRUE                                                56640000
566500         WHEN SQLCODE = ZERO                                      56650000
566600              CONTINUE                                            56660000
566700         WHEN SQLCODE = -904                                      56670000
566800         WHEN SQLCODE = -911                                      56680000
566900         WHEN SQLCODE = -913                                      56690000
567000             SET PS-UPDATES-DONE TO TRUE                          56700000
567100             PERFORM 9900-SOFT-ABORT                              56710000
567200         WHEN SQLWARN0 NOT = SPACE                                56720000
567300         WHEN SQLCODE NOT = ZERO                                  56730000
567400              MOVE '7520-INSERT-PURITM'                           56740000
567500                               TO DP013-PARAGRAPH                 56750000
567600              MOVE 'INSERT NEW ROW IN TPURITM TABLE'              56760000
567700                               TO DP013-MESSAGE-TEXT (1)          56770000
567800              MOVE 'TPURITM '  TO DP013-DB2-TABLE-NAME (1)        56780000
567900              MOVE SQLCA       TO DP013-SQLCA                     56790000
568000              SET DP013-DB2-ABEND                                 56800000
568100                               TO TRUE                            56810000
568200              PERFORM DP013-0000-PROCESS-ABEND                    56820000
568300     END-EVALUATE.                                                56830000
568400/                                                                 56840000
568500 7530-ONLY-UPDATE-PURITM.                                         56850000
568600                                                                  56860000
568700     EXEC SQL                                                     56870000
568800          UPDATE                                                  56880000
568900                 TPURITM                                          56890000
569000          SET    STATUS_CDE       =  :ASC-PURITM-STATUS-CDE       56900000
569100               , STAT_TMST        =  CURRENT TIMESTAMP            56910000
569200          WHERE                                                   56920000
569300                 PO_NBR           =  :DK-PO-NBR                   56930000
569400          AND    APP_PO_LNE_NBR   =  :DK-PKSL-LNE-NBR             56940000
569500          AND    VER_STATUS_CDE   =  :PC-A                        56950000
569600     END-EXEC.                                                    56960000
569700                                                                  56970000
569800     EVALUATE TRUE                                                56980000
569900         WHEN SQLCODE = ZERO                                      56990000
570000              CONTINUE                                            57000000
570100         WHEN SQLCODE = -904                                      57010000
570200         WHEN SQLCODE = -911                                      57020000
570300         WHEN SQLCODE = -913                                      57030000
570400             SET PS-UPDATES-DONE TO TRUE                          57040000
570500             PERFORM 9900-SOFT-ABORT                              57050000
570600         WHEN SQLWARN0 NOT = SPACE                                57060000
570700         WHEN SQLCODE NOT = ZERO                                  57070000
570800              MOVE '7530-ONLY-UPDATE-PURITM'                      57080000
570900                               TO DP013-PARAGRAPH                 57090000
571000              MOVE 'SET CURRENT ROW TO INACTIVE'                  57100000
571100                               TO DP013-MESSAGE-TEXT (1)          57110000
571200              MOVE 'TPURITM '  TO DP013-DB2-TABLE-NAME (1)        57120000
571300              MOVE SQLCA       TO DP013-SQLCA                     57130000
571400              SET DP013-DB2-ABEND                                 57140000
571500                               TO TRUE                            57150000
571600              PERFORM DP013-0000-PROCESS-ABEND                    57160000
571700     END-EVALUATE.                                                57170000
571800/                                                                 57180000
571900 7600-COUNT-PO-LINE-ROWS.                                         57190000
572000                                                                  57200000
572100     MOVE ZERO            TO  PV-DB2-COUNT.                       57210000
572200     EXEC SQL                                                     57220000
572300          SELECT                                                  57230000
572400                COUNT(*)                                          57240000
572500          INTO                                                    57250000
572600                :PV-DB2-COUNT :PV-NULL-IND                        57260000
572700          FROM                                                    57270000
572800                TPURITM                                           57280000
572900          WHERE                                                   57290000
573000                PO_NBR             =  :DK-PO-NBR                  57300000
573100          AND   VER_STATUS_CDE     =  :PC-A                       57310000
573200          AND  (STATUS_CDE        ^=  :PC-CM                      57320000
573300           AND  STATUS_CDE        ^=  :PC-CB                      57330000
573400           AND  STATUS_CDE        ^=  :PC-CA)                     57340000
573500     END-EXEC.                                                    57350000
573600                                                                  57360000
573700     EVALUATE TRUE                                                57370000
573800         WHEN SQLCODE = ZERO                                      57380000
573900         WHEN SQLCODE = +100                                      57390000
574000              CONTINUE                                            57400000
574100         WHEN SQLCODE = -904                                      57410000
574200         WHEN SQLCODE = -911                                      57420000
574300         WHEN SQLCODE = -913                                      57430000
574400             PERFORM 9900-SOFT-ABORT                              57440000
574500         WHEN SQLWARN0 NOT = SPACE                                57450000
574600         WHEN SQLCODE NOT = ZERO                                  57460000
574700              MOVE '7600-COUNT-PO-LINE-ROWS'                      57470000
574800                               TO DP013-PARAGRAPH                 57480000
574900              MOVE 'COUNT NUMBER OF "CM", "CB", "CA" STATUS ROWS' 57490000
575000                               TO DP013-MESSAGE-TEXT (1)          57500000
575100              MOVE 'TPURITM '  TO DP013-DB2-TABLE-NAME (1)        57510000
575200              MOVE SQLCA       TO DP013-SQLCA                     57520000
575300              SET DP013-DB2-ABEND                                 57530000
575400                               TO TRUE                            57540000
575500              PERFORM DP013-0000-PROCESS-ABEND                    57550000
575600     END-EVALUATE.                                                57560000
575700/                                                                 57570000
575800 7610-GET-TPURCHS-STATUS.                                         57580000
575900                                                                  57590000
576000     EXEC SQL                                                     57600000
576100          SELECT                                                  57610000
576200                  PO_NBR                                          57620000
576300                , VER_NBR                                         57630000
576400                , VER_STATUS_CDE                                  57640000
576500                , PO_TYP_CDE                                      57650000
576600                , PO_CATEG_CDE                                    57660000
576700                , EDI_IND                                         57670000
576800                , TOT_UNT_QTY                                     57680000
576900                , TOT_VAL_COST_AMT                                57690000
577000                , TOT_VAL_RTL_AMT                                 57700000
577100                , TOT_MU_PCT                                      57710000
577200                , TOT_SKUS_QTY                                    57720000
577300                , IMPRT_AGNT_PO_NBR                               57730000
577400                , IMPRT_ORD_OFF_NAME                              57740000
577500                , IMPRT_VEND_NAME                                 57750000
577600                , IMPRT_FCTRY_NAME                                57760000
577700                , IMPRT_CNTRY_NAME                                57770000
577800                , VEND_CNTRY_NAME                                 57780000
577900                , NEW_STR_PO_IND                                  57790000
578000                , IMPRT_PO_IND                                    57800000
578100                , IMPRT_AGNT_PO_IND                               57810000
578200                , STATUS_TMST                                     57820000
578300                , LAST_UPD_TMST                                   57830000
578400                , EDI_REXMIT_IND                                  57840000
578500                , EDI_REXMIT_TMST                                 57850000
578600                , DIR_STR_IND                                     57860000
578700                , LAST_UPD_BY_UID                                 57870000
578800                , APP_BY_UID                                      57880000
578900                , OTB_PER_NBR                                     57890000
579000                , DEPT_NBR                                        57900000
579100                , ENT_ID                                          57910000
579200                , STATUS_CDE                                      57920000
579300                , CRE_BY_UID                                      57930000
579400                , REJ_CT                                          57940000
579500                , REJ_UID                                         57950000
579600                , ORD_DTE                                         57960000
579700                , REVISION_CT                                     57970000
579800                , ADR_SEQ_NBR                                     57980000
579900                , DEST_KNOWN_IND                                  57990000
580000                , RLSE_IND                                        58000000
580100                , RLSE_DTE                                        58010000
580200                , PLCMNT_CNTRY_CDE                                58020000
580300                , PROD_CNTRY_CDE                                  58030000
580400                , UNT_PER_CBMT_QTY                                58040000
580500                , CRE_TMST                                        58050000
580600                , PRG_LAST_ACTVY_DTE                              58060000
580700                , PKGNG_CDE                                       58070000
580800                , SEASET_YR                                       58080000
580900                , SEASET_SHRT_NM                                  58090000
581000                , QTA_CTG_CDE                                     58100000
581100                , PO_IN_RMS_IND                                   58110000
581200                , RMS_PO_UPD_TMST                                 58120000
581300                , DUP_SKU_IND                                     58130000
581400                , ORIG_PKGNG_CDE                                  58140000
581500           INTO                                                   58150000
581600                 :PURCHS-PO-NBR                                   58160000
581700                ,:PURCHS-VER-NBR                                  58170000
581800                ,:PURCHS-VER-STATUS-CDE                           58180000
581900                ,:PURCHS-PO-TYP-CDE                               58190000
582000                ,:PURCHS-PO-CATEG-CDE                             58200000
582100                ,:PURCHS-EDI-IND                                  58210000
582200                ,:PURCHS-TOT-UNT-QTY                              58220000
582300                ,:PURCHS-TOT-VAL-COST-AMT                         58230000
582400                ,:PURCHS-TOT-VAL-RTL-AMT                          58240000
582500                ,:PURCHS-TOT-MU-PCT                               58250000
582600                ,:PURCHS-TOT-SKUS-QTY                             58260000
582700                ,:PURCHS-IMPRT-AGNT-PO-NBR                        58270000
582800                ,:PURCHS-IMPRT-ORD-OFF-NAME                       58280000
582900                ,:PURCHS-IMPRT-VEND-NAME                          58290000
583000                ,:PURCHS-IMPRT-FCTRY-NAME                         58300000
583100                ,:PURCHS-IMPRT-CNTRY-NAME                         58310000
583200                ,:PURCHS-VEND-CNTRY-NAME                          58320000
583300                ,:PURCHS-NEW-STR-PO-IND                           58330000
583400                ,:PURCHS-IMPRT-PO-IND                             58340000
583500                ,:PURCHS-IMPRT-AGNT-PO-IND                        58350000
583600                ,:PURCHS-STATUS-TMST                              58360000
583700                ,:PURCHS-LAST-UPD-TMST                            58370000
583800                ,:PURCHS-EDI-REXMIT-IND                           58380000
583900                ,:PURCHS-EDI-REXMIT-TMST                          58390000
584000                ,:PURCHS-DIR-STR-IND                              58400000
584100                ,:PURCHS-LAST-UPD-BY-UID                          58410000
584200                ,:PURCHS-APP-BY-UID                               58420000
584300                ,:PURCHS-OTB-PER-NBR                              58430000
584400                ,:PURCHS-DEPT-NBR                                 58440000
584500                ,:PURCHS-ENT-ID                                   58450000
584600                ,:PURCHS-STATUS-CDE                               58460000
584700                ,:PURCHS-CRE-BY-UID                               58470000
584800                ,:PURCHS-REJ-CT                                   58480000
584900                ,:PURCHS-REJ-UID                                  58490000
585000                ,:PURCHS-ORD-DTE                                  58500000
585100                ,:PURCHS-REVISION-CT                              58510000
585200                ,:PURCHS-ADR-SEQ-NBR                              58520000
585300                ,:PURCHS-DEST-KNOWN-IND                           58530000
585400                ,:PURCHS-RLSE-IND                                 58540000
585500                ,:PURCHS-RLSE-DTE                                 58550000
585600                ,:PURCHS-PLCMNT-CNTRY-CDE                         58560000
585700                ,:PURCHS-PROD-CNTRY-CDE                           58570000
585800                ,:PURCHS-UNT-PER-CBMT-QTY                         58580000
585900                ,:PURCHS-CRE-TMST                                 58590000
586000                ,:PURCHS-PRG-LAST-ACTVY-DTE                       58600000
586100                ,:PURCHS-PKGNG-CDE                                58610000
586200                ,:PURCHS-SEASET-YR                                58620000
586300                ,:PURCHS-SEASET-SHRT-NM                           58630000
586400                ,:PURCHS-QTA-CTG-CDE                              58640000
586500                ,:PURCHS-PO-IN-RMS-IND                            58650000
586600                ,:PURCHS-RMS-PO-UPD-TMST                          58660000
586700                ,:PURCHS-DUP-SKU-IND                              58670000
586800                ,:PURCHS-ORIG-PKGNG-CDE                           58680000
586900          FROM                                                    58690000
587000                 TPURCHS                                          58700000
587100          WHERE                                                   58710000
587200                PO_NBR             =  :DK-PO-NBR                  58720000
587300          AND   VER_STATUS_CDE     =  :PC-A                       58730000
587400     END-EXEC.                                                    58740000
587500                                                                  58750000
587600     EVALUATE TRUE                                                58760000
587700         WHEN SQLCODE = ZERO                                      58770000
587800         WHEN SQLCODE = +100                                      58780000
587900              CONTINUE                                            58790000
588000         WHEN SQLCODE = -904                                      58800000
588100         WHEN SQLCODE = -911                                      58810000
588200         WHEN SQLCODE = -913                                      58820000
588300             PERFORM 9900-SOFT-ABORT                              58830000
588400         WHEN SQLWARN0 NOT = SPACE                                58840000
588500         WHEN SQLCODE NOT = ZERO                                  58850000
588600              MOVE '7610-GET-TPURCHS-STATUS'                      58860000
588700                               TO DP013-PARAGRAPH                 58870000
588800              MOVE 'GET THE PURCHASE HEADER'                      58880000
588900                               TO DP013-MESSAGE-TEXT (1)          58890000
589000              MOVE 'TPURCHS '  TO DP013-DB2-TABLE-NAME (1)        58900000
589100              MOVE SQLCA       TO DP013-SQLCA                     58910000
589200              SET DP013-DB2-ABEND                                 58920000
589300                               TO TRUE                            58930000
589400              PERFORM DP013-0000-PROCESS-ABEND                    58940000
589500     END-EVALUATE.                                                58950000
589600/                                                                 58960000
589700 7620-ONLY-UPDATE-PURCHS-STATUS.                                  58970000
589800                                                                  58980000
589900     EXEC SQL                                                     58990000
590000          UPDATE                                                  59000000
590100                TPURCHS                                           59010000
590200           SET                                                    59020000
590300                VER_STATUS_CDE     =  :PC-A                       59030000
590400              , STATUS_TMST        =  (CURRENT TIMESTAMP)         59040000
590500              , LAST_UPD_TMST      =  (CURRENT TIMESTAMP)         59050000
590600              , STATUS_CDE         =  :ASC-PURCHS-STATUS-CDE      59060000
590700          WHERE                                                   59070000
590800                PO_NBR             =  :DK-PO-NBR                  59080000
590900          AND   VER_STATUS_CDE     =  :PC-A                       59090000
591000     END-EXEC.                                                    59100000
591100                                                                  59110000
591200     EVALUATE TRUE                                                59120000
591300         WHEN SQLCODE = ZERO                                      59130000
591400         WHEN SQLCODE = +100                                      59140000
591500              CONTINUE                                            59150000
591600         WHEN SQLCODE = -904                                      59160000
591700         WHEN SQLCODE = -911                                      59170000
591800         WHEN SQLCODE = -913                                      59180000
591900             SET PS-UPDATES-DONE TO TRUE                          59190000
592000             PERFORM 9900-SOFT-ABORT                              59200000
592100         WHEN SQLWARN0 NOT = SPACE                                59210000
592200         WHEN SQLCODE NOT = ZERO                                  59220000
592300              MOVE '7620-ONLY-UPDATE-PURCHS-STATUS'               59230000
592400                               TO DP013-PARAGRAPH                 59240000
592500              MOVE 'GET THE PURCHASE HEADER'                      59250000
592600                               TO DP013-MESSAGE-TEXT (1)          59260000
592700              MOVE 'TPURCHS '  TO DP013-DB2-TABLE-NAME (1)        59270000
592800              MOVE SQLCA       TO DP013-SQLCA                     59280000
592900              SET DP013-DB2-ABEND                                 59290000
593000                               TO TRUE                            59300000
593100              PERFORM DP013-0000-PROCESS-ABEND                    59310000
593200     END-EVALUATE.                                                59320000
593300/                                                                 59330000
593400 7630-UPDATE-PURCHS-STATUS.                                       59340000
593500                                                                  59350000
593600     EXEC SQL                                                     59360000
593700          UPDATE                                                  59370000
593800                TPURCHS                                           59380000
593900           SET                                                    59390000
594000                VER_STATUS_CDE     =  :PC-I                       59400000
594100          WHERE                                                   59410000
594200                PO_NBR             =  :DK-PO-NBR                  59420000
594300          AND   VER_STATUS_CDE     =  :PC-A                       59430000
594400     END-EXEC.                                                    59440000
594500                                                                  59450000
594600     EVALUATE TRUE                                                59460000
594700         WHEN SQLCODE = ZERO                                      59470000
594800         WHEN SQLCODE = +100                                      59480000
594900              CONTINUE                                            59490000
595000         WHEN SQLCODE = -904                                      59500000
595100         WHEN SQLCODE = -911                                      59510000
595200         WHEN SQLCODE = -913                                      59520000
595300             SET PS-UPDATES-DONE TO TRUE                          59530000
595400             PERFORM 9900-SOFT-ABORT                              59540000
595500         WHEN SQLWARN0 NOT = SPACE                                59550000
595600         WHEN SQLCODE NOT = ZERO                                  59560000
595700              MOVE '7630-UPDATE-PURCHS-STATUS'                    59570000
595800                               TO DP013-PARAGRAPH                 59580000
595900              MOVE 'GET THE PURCHASE HEADER'                      59590000
596000                               TO DP013-MESSAGE-TEXT (1)          59600000
596100              MOVE 'TPURCHS '  TO DP013-DB2-TABLE-NAME (1)        59610000
596200              MOVE SQLCA       TO DP013-SQLCA                     59620000
596300              SET DP013-DB2-ABEND                                 59630000
596400                               TO TRUE                            59640000
596500              PERFORM DP013-0000-PROCESS-ABEND                    59650000
596600     END-EVALUATE.                                                59660000
596700/                                                                 59670000
596800 7640-INSERT-PURCHS.                                              59680000
596900                                                                  59690000
597000     EXEC SQL                                                     59700000
597100          INSERT                                                  59710000
597200           INTO   TPURCHS                                         59720000
597300                 (PO_NBR                                          59730000
597400                , VER_NBR                                         59740000
597500                , VER_STATUS_CDE                                  59750000
597600                , PO_TYP_CDE                                      59760000
597700                , PO_CATEG_CDE                                    59770000
597800                , EDI_IND                                         59780000
597900                , TOT_UNT_QTY                                     59790000
598000                , TOT_VAL_COST_AMT                                59800000
598100                , TOT_VAL_RTL_AMT                                 59810000
598200                , TOT_MU_PCT                                      59820000
598300                , TOT_SKUS_QTY                                    59830000
598400                , IMPRT_AGNT_PO_NBR                               59840000
598500                , IMPRT_ORD_OFF_NAME                              59850000
598600                , IMPRT_VEND_NAME                                 59860000
598700                , IMPRT_FCTRY_NAME                                59870000
598800                , IMPRT_CNTRY_NAME                                59880000
598900                , VEND_CNTRY_NAME                                 59890000
599000                , NEW_STR_PO_IND                                  59900000
599100                , IMPRT_PO_IND                                    59910000
599200                , IMPRT_AGNT_PO_IND                               59920000
599300                , STATUS_TMST                                     59930000
599400                , LAST_UPD_TMST                                   59940000
599500                , EDI_REXMIT_IND                                  59950000
599600                , EDI_REXMIT_TMST                                 59960000
599700                , DIR_STR_IND                                     59970000
599800                , LAST_UPD_BY_UID                                 59980000
599900                , APP_BY_UID                                      59990000
600000                , OTB_PER_NBR                                     60000000
600100                , DEPT_NBR                                        60010000
600200                , ENT_ID                                          60020000
600300                , STATUS_CDE                                      60030000
600400                , CRE_BY_UID                                      60040000
600500                , REJ_CT                                          60050000
600600                , REJ_UID                                         60060000
600700                , ORD_DTE                                         60070000
600800                , REVISION_CT                                     60080000
600900                , ADR_SEQ_NBR                                     60090000
601000                , DEST_KNOWN_IND                                  60100000
601100                , RLSE_IND                                        60110000
601200                , RLSE_DTE                                        60120000
601300                , PLCMNT_CNTRY_CDE                                60130000
601400                , PROD_CNTRY_CDE                                  60140000
601500                , UNT_PER_CBMT_QTY                                60150000
601600                , CRE_TMST                                        60160000
601700                , PRG_LAST_ACTVY_DTE                              60170000
601800                , PKGNG_CDE                                       60180000
601900                , SEASET_YR                                       60190000
602000                , SEASET_SHRT_NM                                  60200000
602100                , QTA_CTG_CDE                                     60210000
602200                , PO_IN_RMS_IND                                   60220000
602300                , RMS_PO_UPD_TMST                                 60230000
602400                , DUP_SKU_IND                                     60240000
602500                , ORIG_PKGNG_CDE                                  60250000
602600                 )                                                60260000
602700         VALUES                                                   60270000
602800                (:PURCHS-PO-NBR                                   60280000
602900                ,:PURCHS-VER-NBR                                  60290000
603000                ,:PC-A                                            60300000
603100                ,:PURCHS-PO-TYP-CDE                               60310000
603200                ,:PURCHS-PO-CATEG-CDE                             60320000
603300                ,:PURCHS-EDI-IND                                  60330000
603400                ,:PURCHS-TOT-UNT-QTY                              60340000
603500                ,:PURCHS-TOT-VAL-COST-AMT                         60350000
603600                ,:PURCHS-TOT-VAL-RTL-AMT                          60360000
603700                ,:PURCHS-TOT-MU-PCT                               60370000
603800                ,:PURCHS-TOT-SKUS-QTY                             60380000
603900                ,:PURCHS-IMPRT-AGNT-PO-NBR                        60390000
604000                ,:PURCHS-IMPRT-ORD-OFF-NAME                       60400000
604100                ,:PURCHS-IMPRT-VEND-NAME                          60410000
604200                ,:PURCHS-IMPRT-FCTRY-NAME                         60420000
604300                ,:PURCHS-IMPRT-CNTRY-NAME                         60430000
604400                ,:PURCHS-VEND-CNTRY-NAME                          60440000
604500                ,:PURCHS-NEW-STR-PO-IND                           60450000
604600                ,:PURCHS-IMPRT-PO-IND                             60460000
604700                ,:PURCHS-IMPRT-AGNT-PO-IND                        60470000
604800                , CURRENT TIMESTAMP                               60480000
604900                , CURRENT TIMESTAMP                               60490000
605000                ,:PURCHS-EDI-REXMIT-IND                           60500000
605100                ,:PURCHS-EDI-REXMIT-TMST                          60510000
605200                ,:PURCHS-DIR-STR-IND                              60520000
605300                ,:DP020-USERID                                    60530000
605400                ,:PURCHS-APP-BY-UID                               60540000
605500                ,:PURCHS-OTB-PER-NBR                              60550000
605600                ,:PURCHS-DEPT-NBR                                 60560000
605700                ,:PURCHS-ENT-ID                                   60570000
605800                ,:ASC-PURCHS-STATUS-CDE                           60580000
605900                ,:PURCHS-CRE-BY-UID                               60590000
606000                ,:PURCHS-REJ-CT                                   60600000
606100                ,:PURCHS-REJ-UID                                  60610000
606200                ,:PURCHS-ORD-DTE                                  60620000
606300                ,:PURCHS-REVISION-CT                              60630000
606400                ,:PURCHS-ADR-SEQ-NBR                              60640000
606500                ,:PURCHS-DEST-KNOWN-IND                           60650000
606600                ,:PURCHS-RLSE-IND                                 60660000
606700                ,:PURCHS-RLSE-DTE                                 60670000
606800                ,:PURCHS-PLCMNT-CNTRY-CDE                         60680000
606900                ,:PURCHS-PROD-CNTRY-CDE                           60690000
607000                ,:PURCHS-UNT-PER-CBMT-QTY                         60700000
607100                ,:PURCHS-CRE-TMST                                 60710000
607200                ,:PURCHS-PRG-LAST-ACTVY-DTE                       60720000
607300                ,:PURCHS-PKGNG-CDE                                60730000
607400                ,:PURCHS-SEASET-YR                                60740000
607500                ,:PURCHS-SEASET-SHRT-NM                           60750000
607600                ,:PURCHS-QTA-CTG-CDE                              60760000
607700                ,:PURCHS-PO-IN-RMS-IND                            60770000
607800                ,:PURCHS-RMS-PO-UPD-TMST                          60780000
607900                ,:PURCHS-DUP-SKU-IND                              60790000
608000                ,:PURCHS-ORIG-PKGNG-CDE                           60800000
608100                 )                                                60810000
608200     END-EXEC.                                                    60820000
608300                                                                  60830000
608400     EVALUATE TRUE                                                60840000
608500         WHEN SQLCODE = ZERO                                      60850000
608600              CONTINUE                                            60860000
608700         WHEN SQLCODE = -904                                      60870000
608800         WHEN SQLCODE = -911                                      60880000
608900         WHEN SQLCODE = -913                                      60890000
609000             SET PS-UPDATES-DONE TO TRUE                          60900000
609100             PERFORM 9900-SOFT-ABORT                              60910000
609200         WHEN SQLWARN0 NOT = SPACE                                60920000
609300         WHEN SQLCODE NOT = ZERO                                  60930000
609400              MOVE '7640-INSERT-PURCHS'                           60940000
609500                               TO DP013-PARAGRAPH                 60950000
609600              MOVE 'INSERT PURCHASE HEADER'                       60960000
609700                               TO DP013-MESSAGE-TEXT (1)          60970000
609800              MOVE 'TPURCHS '  TO DP013-DB2-TABLE-NAME (1)        60980000
609900              MOVE SQLCA       TO DP013-SQLCA                     60990000
610000              SET DP013-DB2-ABEND                                 61000000
610100                               TO TRUE                            61010000
610200              PERFORM DP013-0000-PROCESS-ABEND                    61020000
610300     END-EVALUATE.                                                61030000
610400                                                                  61040000
610500*----------------------------------------------------------------*61050000
610600*    CHECK TO SEE IF THIS DEPARTMENT HAS BEEN CONVERTED TO RMS.  *61060000
610700*    IF IT HAS, THE COUNT RETURNED FROM THIS FUNCTION WILL BE    *61070000
610800*    GREATER THAN ZERO AND WE CAN UPDATE TPURITM AND TPURCHS     *61080000
610900*    CORRECTLY.                                                  *61090000
611000*----------------------------------------------------------------*61100000
611100 7650-CHECK-FOR-RMS-PO.                                           61110000
611200                                                                  61120000
611300     INITIALIZE PV-DB2-COUNT.                                     61130000
611400                                                                  61140000
611500     EXEC SQL                                                     61150000
611600          SELECT                                                  61160000
611700                  COUNT(*)                                        61170000
611800           INTO                                                   61180000
611900                  :PV-DB2-COUNT :PV-NULL-IND                      61190000
612000           FROM                                                   61200000
612100                  POT_RMS_RLOUT_CTL                               61210000
612200          WHERE                                                   61220000
612300                  DEPT_NBR            = :PV-DEPT-NBR-KEY          61230000
612400           AND    PO_ENTR_IN_RMS_DTE <=  CURRENT_DATE             61240000
612500     END-EXEC.                                                    61250000
612600                                                                  61260000
612700     EVALUATE TRUE                                                61270000
612800         WHEN SQLCODE = ZERO                                      61280000
612900         WHEN SQLCODE = +100                                      61290000
613000              SET PS-CHECKED-FOR-RMS-PO                           61300000
613100                               TO TRUE                            61310000
613200         WHEN SQLWARN0 NOT = SPACE                                61320000
613300         WHEN SQLCODE = -904                                      61330000
613400         WHEN SQLCODE = -911                                      61340000
613500         WHEN SQLCODE = -913                                      61350000
613600              PERFORM 9900-SOFT-ABORT                             61360000
613700         WHEN SQLCODE NOT = ZERO                                  61370000
613800              MOVE '7650-CHECK-FOR-RMS-PO'                        61380000
613900                               TO DP013-PARAGRAPH                 61390000
614000              MOVE 'CHECK IF DEPT NBR CONVERTED FOR RMS'          61400000
614100                               TO DP013-MESSAGE-TEXT (1)          61410000
614200              STRING 'DEPARTMENT NUMBER: ' DELIMITED BY SIZE      61420000
614300                     PV-DEPT-NBR-X         DELIMITED BY SIZE      61430000
614400                             INTO DP013-MESSAGE-TEXT (2)          61440000
614500              MOVE 'POT_RMS_RLOUT_CTL'                            61450000
614600                               TO DP013-DB2-TABLE-NAME (1)        61460000
614700              MOVE SQLCA       TO DP013-SQLCA                     61470000
614800              SET DP013-DB2-ABEND                                 61480000
614900                               TO TRUE                            61490000
615000              PERFORM DP013-0000-PROCESS-ABEND                    61500000
615100     END-EVALUATE.                                                61510000
615200/                                                                 61520000
615300******************************************************************61530000
615400* THIS PARAGRAPH WILL CONTROL THE PROCESSING ASSOCIATED TO THE   *61540000
615500* UNITS WORKED ROUTINE.                                           61550000
615600******************************************************************61560000
615700 8500-PROCESS-UNITS-WORK.                                         61570000
615800                                                                  61580000
615900     PERFORM 8600-RECEIV-PURITM-JOIN.                             61590000
616000     PERFORM 8800-UNITS-WORK-ROUTINE.                             61600000
616100                                                                  61610000
616200*    IF  PV-XLT00010-TYPE-DC                                      61620013
616300*        PERFORM 8800-UNITS-WORK-ROUTINE                          61630000
616400*    ELSE                                                         61640000
616500*        MOVE 'Y'                   TO PC238-DIRECT-STORE-SW      61650000
616600*        PERFORM 8800-UNITS-WORK-ROUTINE                          61660000
616700*    END-IF.                                                      61670000
616800/                                                                 61680000
616900******************************************************************61690000
617000*  THIS PARAGRAPH WILL BE USED TO GET SOME FIELDS TO DETERMINE   *61700000
617100*  IF THE UNITS WORKED MODULE NEEDS TO BE CALLED (IF THE FULL-   *61710000
617200*  CASE TIMESTAMP IS A VALUE OTHER THAN 9'S, THEN THE LINE IS    *61720000
617300*  CONFIRMED AND THE UNITS WORKED MODULE WILL NEED TO BE CALLED  *61730000
617400*  FOR CONFIRMATION UNIT ADJUSTMENTS.  THE OTHER FIELDS ARE USED *61740000
617500*  BY THE MODULE TO DETERMINE THE RETAIL VALUE OF THE ADJUSTMENT *61750000
617600*  AND WHAT OPER UNIT AND PROCESS AREA THE ADJUSTMENT SHOULD BE  *61760000
617700*  POSTED TO WITHIN THE UNITS WORKED SYSTEM.                     *61770000
617800******************************************************************61780000
617900 8600-RECEIV-PURITM-JOIN.                                         61790000
618000                                                                  61800000
618100     EXEC SQL                                                     61810000
618200     SELECT A.CURR_OPER_UNT_ID,                                   61820000
618300            C.UNT_RTL_PR_AMT,                                     61830000
618400            D.LOC_TYP_CDE                                         61840013
618500         INTO :PV-CURR-OPER-UNT-ID                                61850000
618600         ,    :PURITM-UNT-RTL-PR-AMT                              61860000
618700         ,    :PV-XLT00010-TYPE-CODE                              61870013
618800         FROM                                                     61880000
618900             TRECEIV A                                            61890000
619000         ,   TRECITM B                                            61900000
619100         ,   TPURITM C                                            61910000
619200         ,   XLT_LOC D                                            61920013
619300         WHERE A.ORD_NBR          = :DK-PO-NBR                    61930000
619400           AND A.REC_SEQ_NBR     = :DK-REC-SEQ-NBR                61940000
619500           AND B.ORD_NBR          = A.ORD_NBR                     61950000
619600           AND B.REC_SEQ_NBR      = A.REC_SEQ_NBR                 61960000
619700           AND B.ORD_LNE_NBR      = :DK-PKSL-LNE-NBR              61970000
619800           AND C.PO_NBR           = B.ORD_NBR                     61980000
619900           AND C.APP_PO_LNE_NBR   = B.ORD_LNE_NBR                 61990000
620000           AND C.VER_NBR          = B.PO_VER_NBR                  62000000
620100           AND D.LOC_NBR          = A.CURR_OPER_UNT_ID            62010013
620200     END-EXEC.                                                    62020000
620300*                                                                 62030000
620400     EVALUATE TRUE                                                62040000
620500         WHEN SQLCODE = ZERO                                      62050000
620600             CONTINUE                                             62060000
620700         WHEN SQLCODE = -904                                      62070000
620800         WHEN SQLCODE = -911                                      62080000
620900         WHEN SQLCODE = -913                                      62090000
621000             PERFORM 9900-SOFT-ABORT                              62100000
621100                                                                  62110000
621200         WHEN SQLWARN0 NOT = SPACES                               62120000
621300         WHEN SQLCODE < ZERO                                      62130000
621400         WHEN SQLCODE > ZERO                                      62140000
621500             MOVE '8600-RECEIV-PURITM-JOIN'                       62150000
621600                                  TO DP013-PARAGRAPH              62160000
621700             MOVE 'UNSUCCESSFUL JOIN OF 3 TABLES'                 62170000
621800                                  TO DP013-MESSAGE-TEXT (1)       62180000
621900             MOVE SQLCA      TO DP013-SQLCA                       62190000
622000             MOVE 'TRECEIV ' TO DP013-DB2-TABLE-NAME (1)          62200000
622100             SET DP013-DB2-ABEND                                  62210000
622200                 DP013-NO-ROLLBACK                                62220000
622300                                  TO TRUE                         62230000
622400             PERFORM DP013-0000-PROCESS-ABEND                     62240000
622500     END-EVALUATE.                                                62250000
622600                                                                  62260000
622700******************************************************************62270000
622800* THIS PARAGRAPH WILL FORMAT ALL OF THE DATA NEEDED FOR THE      *62280000
622900* UNITS WORKED ROUTINE AND WILL THEN CALL THE ROUTINE AND        *62290000
623000* THE RESULTS RETURNED FROM THE ROUTINE.                         *62300000
623100******************************************************************62310000
623200 8800-UNITS-WORK-ROUTINE.                                         62320000
623300                                                                  62330000
623400     INITIALIZE PC238-COMM-AREA.                                  62340000
623500                                                                  62350000
623600     EXEC SQL                                                     62360000
623700         SET :PV-TMST =  CURRENT_TIMESTAMP                        62370000
623800     END-EXEC                                                     62380000
623900                                                                  62390000
624000     MOVE PV-TMST                 TO PC238-WRKD-TMST.             62400000
624100                                                                  62410000
624200     IF  PV-XLT00010-TYPE-DC                                      62420013
624300         NEXT SENTENCE                                            62430000
624400     ELSE                                                         62440000
624500         MOVE 'Y'                   TO PC238-DIRECT-STORE-SW      62450000
624600     END-IF.                                                      62460000
624700                                                                  62470000
624800     MOVE PV-CURR-OPER-UNT-ID     TO PC238-WRKD-OPER-UNT-ID.      62480000
624900     MOVE DK-PO-NBR               TO PC238-PO-NBR.                62490000
625000     MOVE DK-REC-SEQ-NBR          TO PC238-RCVR-SEQ-NBR.          62500000
625100     MOVE DK-PKSL-LNE-NBR         TO PC238-PO-LNE-NBR.            62510000
625200                                                                  62520000
625300     MOVE PA-ACCUM-UPDATE-QTY     TO PC238-WRKD-UNT-QTY.          62530000
625400     MOVE PURITM-UNT-RTL-PR-AMT   TO PC238-UNT-RETAIL-PRC.        62540000
625500     SET  PC238-TRANS-VERIFY-ADJ  TO TRUE.                        62550000
625600     SET  PC238-MANUAL-VERIFY     TO TRUE.                        62560000
625700* DMH 4/18/03 - BEGIN                                             62570000
625800     MOVE ASC-VRFY-ADJ-QUEUE-NAME TO PC238-VRFY-ADJ-QUEUE-NAME.   62580000
625900     MOVE PV-VRFY-ITEM            TO PC238-TOT-QUEUE-ITEMS.       62590000
626000* DMH 4/18/03 - END                                               62600000
626100                                                                  62610000
626200************************************************                  62620000
626300*                                                                 62630000
626400*    MOVE PC238-PO-NBR       TO PC-DISPLAY-PO.                    62640002
626500*    MOVE PC238-RCVR-SEQ-NBR TO PC-DISPLAY-RCVR.                  62650002
626600*    MOVE PC238-PO-LNE-NBR   TO PC-DISPLAY-LINE.                  62660002
626700*    MOVE PC238-WRKD-OPER-UNT-ID                                  62670002
626800*                            TO PC-DISPLAY-OPER.                  62680002
626900*    STRING ' RCKCS284 - '      DELIMITED BY SIZE                 62690002
627000*           ' CALLING PCKCS756 WITH KEY INFO - '                  62700002
627100*                               DELIMITED BY SIZE                 62710002
627200*           PC-DISPLAY-PO       DELIMITED BY SIZE                 62720002
627300*           ' - '               DELIMITED BY SIZE                 62730002
627400*           PC-DISPLAY-RCVR     DELIMITED BY SIZE                 62740002
627500*           ' - '               DELIMITED BY SIZE                 62750002
627600*           PC-DISPLAY-LINE     DELIMITED BY SIZE                 62760002
627700*           ' - '               DELIMITED BY SIZE                 62770002
627800*           PC-DISPLAY-OPER     DELIMITED BY SIZE                 62780002
627900*                        INTO PV-CICS-MSG-AREA.                   62790002
628000*    MOVE LENGTH OF PV-CICS-MSG-AREA                              62800002
628100*                          TO PV-COMMAREA-LENGTH.                 62810002
628200*    PERFORM 9700-WRITE-TO-CICS-LOG.                              62820002
628300*                                                                 62830002
628400************************************************                  62840000
628500                                                                  62850000
628600     MOVE LENGTH OF PC238-COMM-AREA                               62860000
628700                                  TO PV-COMMAREA-LENGTH.          62870000
628800                                                                  62880000
628900     EXEC CICS                                                    62890000
629000         LINK PROGRAM  (PV-PCKCS756)                              62900000
629100              COMMAREA (PC238-COMM-AREA)                          62910000
629200              LENGTH   (PV-COMMAREA-LENGTH)                       62920000
629300              RESP     (PV-CICS-RESPONSE)                         62930000
629400     END-EXEC.                                                    62940000
629500                                                                  62950000
629600************************************************                  62960000
629700*                                                                 62970000
629800*    MOVE PC238-PO-NBR       TO PC-DISPLAY-PO.                    62980000
629900*    MOVE PC238-RCVR-SEQ-NBR TO PC-DISPLAY-RCVR.                  62990000
630000*    MOVE PC238-PO-LNE-NBR   TO PC-DISPLAY-LINE.                  63000000
630100*    MOVE PC238-WRKD-OPER-UNT-ID                                  63010000
630200*                            TO PC-DISPLAY-OPER.                  63020000
630300*    STRING ' RCKCS284 - '      DELIMITED BY SIZE                 63030000
630400*           ' RETURN FROM PCKCS756 - '                            63040000
630500*                               DELIMITED BY SIZE                 63050000
630600*           PC-DISPLAY-PO       DELIMITED BY SIZE                 63060000
630700*           ' - '               DELIMITED BY SIZE                 63070000
630800*           PC-DISPLAY-RCVR     DELIMITED BY SIZE                 63080000
630900*           ' - '               DELIMITED BY SIZE                 63090000
631000*           PC-DISPLAY-LINE     DELIMITED BY SIZE                 63100000
631100*           ' - '               DELIMITED BY SIZE                 63110000
631200*           PC238-MOD-SUCCESS-CDE                                 63120000
631300*                               DELIMITED BY SIZE                 63130000
631400*           ' - '               DELIMITED BY SIZE                 63140000
631500*           PC238-UNSUCCESSFUL-CDE                                63150000
631600*                               DELIMITED BY SIZE                 63160000
631700*                        INTO PV-CICS-MSG-AREA.                   63170000
631800*    MOVE LENGTH OF PV-CICS-MSG-AREA                              63180000
631900*                          TO PV-COMMAREA-LENGTH.                 63190000
632000*    PERFORM 9700-WRITE-TO-CICS-LOG.                              63200000
632100*                                                                 63210000
632200************************************************                  63220000
632300                                                                  63230000
632400     EVALUATE TRUE                                                63240000
632500         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 63250000
632600              IF  PC238-MOD-UNSUCCESSFUL                          63260000
632700                  PERFORM 8810-MOD-UNSUCCESSFUL                   63270000
632800              END-IF                                              63280000
632900         WHEN OTHER                                               63290000
633000              MOVE PC238-PO-NBR       TO PC-DISPLAY-PO            63300000
633100              MOVE PC238-RCVR-SEQ-NBR TO PC-DISPLAY-RCVR          63310000
633200              MOVE PC238-PO-LNE-NBR   TO PC-DISPLAY-LINE          63320000
633300              MOVE PC238-WRKD-OPER-UNT-ID                         63330000
633400                                      TO PC-DISPLAY-OPER          63340000
633500              MOVE PC238-BAD-SQL-CDE  TO PC-DISPLAY-SQL-CODE      63350000
633600              MOVE PV-CICS-RESPONSE   TO PC-DISPLAY-CICS-RESP     63360000
633700              SET PS-UNITS-WORKED-ERROR  TO TRUE                  63370000
633800              STRING ' RCKCS284 - '      DELIMITED BY SIZE        63380000
633900                     ' 8800-UNITS-WORK-ROUTINE '                  63390000
634000                                         DELIMITED BY SIZE        63400000
634100                     ' BAD CALL TO UNITS WORKED MODULE '          63410000
634200                                         DELIMITED BY SIZE        63420000
634300                     ' - CICS RESP '                              63430000
634400                                         DELIMITED BY SIZE        63440000
634500                     PC-DISPLAY-CICS-RESP                         63450000
634600                                         DELIMITED BY SIZE        63460000
634700                                      INTO PV-CICS-MSG-AREA       63470000
634800              MOVE LENGTH OF PV-CICS-MSG-AREA                     63480000
634900                                        TO PV-COMMAREA-LENGTH     63490000
635000              PERFORM 9700-WRITE-TO-CICS-LOG                      63500000
635100              MOVE SPACES TO PV-CICS-MSG-AREA                     63510000
635200              STRING ' RCKCS284 - '      DELIMITED BY SIZE        63520000
635300                     ' 8800-UNITS-WORK-ROUTINE '                  63530000
635400                                         DELIMITED BY SIZE        63540000
635500                     ' KEY INFO - '      DELIMITED BY SIZE        63550000
635600                     PC-DISPLAY-PO       DELIMITED BY SIZE        63560000
635700                     ' - '               DELIMITED BY SIZE        63570000
635800                     PC-DISPLAY-RCVR     DELIMITED BY SIZE        63580000
635900                     ' - '               DELIMITED BY SIZE        63590000
636000                     PC-DISPLAY-LINE     DELIMITED BY SIZE        63600000
636100                                  INTO PV-CICS-MSG-AREA           63610000
636200              MOVE LENGTH OF PV-CICS-MSG-AREA                     63620000
636300                                    TO PV-COMMAREA-LENGTH         63630000
636400              PERFORM 9700-WRITE-TO-CICS-LOG                      63640000
636500              PERFORM 9900-SOFT-ABORT                             63650000
636600     END-EVALUATE.                                                63660000
636700                                                                  63670000
636800******************************************************************63680000
636900* THIS PARAGRAPH WILL MANAGE THE DISPLAY OF INFORMATION TO CSSL  *63690000
637000* FOR WHEN THE UNITS WORKED ROUTINE WAS UNSUCCESSFUL.  THIS      *63700000
637100* PARAGRAPH WILL FORMAT A MESSAGE AND GET IT WRITTEN TO THE      *63710000
637200* CICS LOG AND THEN SOFT ABORT THE PROGRAM.                      *63720000
637300******************************************************************63730000
637400 8810-MOD-UNSUCCESSFUL.                                           63740000
637500                                                                  63750000
637600     MOVE PC238-PO-NBR              TO PC-DISPLAY-PO.             63760000
637700     MOVE PC238-RCVR-SEQ-NBR        TO PC-DISPLAY-RCVR.           63770000
637800     MOVE PC238-PO-LNE-NBR          TO PC-DISPLAY-LINE.           63780000
637900     MOVE PC238-WRKD-OPER-UNT-ID    TO PC-DISPLAY-OPER.           63790000
638000     MOVE PC238-BAD-SQL-CDE         TO PC-DISPLAY-SQL-CODE.       63800000
638100     SET  PS-UNITS-WORKED-ERROR     TO TRUE.                      63810000
638200     SET  PS-UPDATES-DONE           TO TRUE.                      63820000
638300                                                                  63830000
638400     IF  PC238-MOD-BAD-TMST                                       63840000
638500         STRING ' RCKCS284 - '      DELIMITED BY SIZE             63850000
638600                ' 8800-UNITS-WORK-ROUTINE '                       63860000
638700                                    DELIMITED BY SIZE             63870000
638800                ' BAD TIMESTAMP '   DELIMITED BY SIZE             63880000
638900                PC238-WRKD-TMST     DELIMITED BY SIZE             63890000
639000                             INTO PV-CICS-MSG-AREA                63900000
639100         MOVE LENGTH OF PV-CICS-MSG-AREA                          63910000
639200                               TO PV-COMMAREA-LENGTH              63920000
639300         PERFORM 9700-WRITE-TO-CICS-LOG                           63930000
639400         STRING ' RCKCS284 - '      DELIMITED BY SIZE             63940000
639500                ' 8800-UNITS-WORK-ROUTINE '                       63950000
639600                                    DELIMITED BY SIZE             63960000
639700                ' KEY INFO - '      DELIMITED BY SIZE             63970000
639800                PC-DISPLAY-PO       DELIMITED BY SIZE             63980000
639900                ' - '               DELIMITED BY SIZE             63990000
640000                PC-DISPLAY-RCVR     DELIMITED BY SIZE             64000000
640100                ' - '               DELIMITED BY SIZE             64010000
640200                PC-DISPLAY-LINE     DELIMITED BY SIZE             64020000
640300                             INTO PV-CICS-MSG-AREA                64030000
640400         MOVE LENGTH OF PV-CICS-MSG-AREA                          64040000
640500                               TO PV-COMMAREA-LENGTH              64050000
640600         PERFORM 9700-WRITE-TO-CICS-LOG                           64060000
640700         PERFORM 9900-SOFT-ABORT                                  64070000
640800     ELSE                                                         64080000
640900     IF  PC238-MOD-BAD-OPER                                       64090000
641000         STRING ' RCKCS284 - '      DELIMITED BY SIZE             64100000
641100                ' 8800-UNITS-WORK-ROUTINE '                       64110000
641200                                    DELIMITED BY SIZE             64120000
641300                ' BAD OPER UNIT '   DELIMITED BY SIZE             64130000
641400                PC-DISPLAY-OPER     DELIMITED BY SIZE             64140000
641500                             INTO PV-CICS-MSG-AREA                64150000
641600         MOVE LENGTH OF PV-CICS-MSG-AREA                          64160000
641700                               TO PV-COMMAREA-LENGTH              64170000
641800         PERFORM 9700-WRITE-TO-CICS-LOG                           64180000
641900         STRING ' RCKCS284 - '      DELIMITED BY SIZE             64190000
642000                ' 8800-UNITS-WORK-ROUTINE '                       64200000
642100                                    DELIMITED BY SIZE             64210000
642200                ' KEY INFO - '      DELIMITED BY SIZE             64220000
642300                PC-DISPLAY-PO       DELIMITED BY SIZE             64230000
642400                ' - '               DELIMITED BY SIZE             64240000
642500                PC-DISPLAY-RCVR     DELIMITED BY SIZE             64250000
642600                ' - '               DELIMITED BY SIZE             64260000
642700                PC-DISPLAY-LINE     DELIMITED BY SIZE             64270000
642800                             INTO PV-CICS-MSG-AREA                64280000
642900         MOVE LENGTH OF PV-CICS-MSG-AREA                          64290000
643000                               TO PV-COMMAREA-LENGTH              64300000
643100         PERFORM 9700-WRITE-TO-CICS-LOG                           64310000
643200         PERFORM 9900-SOFT-ABORT                                  64320000
643300     ELSE                                                         64330000
643400     IF  PC238-MOD-BAD-TRANS-TYPE                                 64340000
643500         STRING ' RCKCS284 - '      DELIMITED BY SIZE             64350000
643600                ' 8800-UNITS-WORK-ROUTINE '                       64360000
643700                                    DELIMITED BY SIZE             64370000
643800                ' BAD TRAN TYPE '   DELIMITED BY SIZE             64380000
643900                PC238-TRANS-TYPE-CDE                              64390000
644000                                    DELIMITED BY SIZE             64400000
644100                             INTO PV-CICS-MSG-AREA                64410000
644200         MOVE LENGTH OF PV-CICS-MSG-AREA                          64420000
644300                               TO PV-COMMAREA-LENGTH              64430000
644400         PERFORM 9700-WRITE-TO-CICS-LOG                           64440000
644500         STRING ' RCKCS284 - '      DELIMITED BY SIZE             64450000
644600                ' 8800-UNITS-WORK-ROUTINE '                       64460000
644700                                    DELIMITED BY SIZE             64470000
644800                ' KEY INFO - '      DELIMITED BY SIZE             64480000
644900                PC-DISPLAY-PO       DELIMITED BY SIZE             64490000
645000                ' - '               DELIMITED BY SIZE             64500000
645100                PC-DISPLAY-RCVR     DELIMITED BY SIZE             64510000
645200                ' - '               DELIMITED BY SIZE             64520000
645300                PC-DISPLAY-LINE     DELIMITED BY SIZE             64530000
645400                             INTO PV-CICS-MSG-AREA                64540000
645500         MOVE LENGTH OF PV-CICS-MSG-AREA                          64550000
645600                               TO PV-COMMAREA-LENGTH              64560000
645700         PERFORM 9700-WRITE-TO-CICS-LOG                           64570000
645800         PERFORM 9900-SOFT-ABORT                                  64580000
645900     ELSE                                                         64590000
646000     IF  PC238-MOD-BAD-PO                                         64600000
646100         STRING ' RCKCS284 - '      DELIMITED BY SIZE             64610000
646200                ' 8800-UNITS-WORK-ROUTINE '                       64620000
646300                                    DELIMITED BY SIZE             64630000
646400                ' BAD PO NUMBER '   DELIMITED BY SIZE             64640000
646500                PC-DISPLAY-PO       DELIMITED BY SIZE             64650000
646600                             INTO PV-CICS-MSG-AREA                64660000
646700         MOVE LENGTH OF PV-CICS-MSG-AREA                          64670000
646800                               TO PV-COMMAREA-LENGTH              64680000
646900         PERFORM 9700-WRITE-TO-CICS-LOG                           64690000
647000         STRING ' RCKCS284 - '      DELIMITED BY SIZE             64700000
647100                ' 8800-UNITS-WORK-ROUTINE '                       64710000
647200                                    DELIMITED BY SIZE             64720000
647300                ' KEY INFO - '      DELIMITED BY SIZE             64730000
647400                PC-DISPLAY-PO       DELIMITED BY SIZE             64740000
647500                ' - '               DELIMITED BY SIZE             64750000
647600                PC-DISPLAY-RCVR     DELIMITED BY SIZE             64760000
647700                ' - '               DELIMITED BY SIZE             64770000
647800                PC-DISPLAY-LINE     DELIMITED BY SIZE             64780000
647900                             INTO PV-CICS-MSG-AREA                64790000
648000         MOVE LENGTH OF PV-CICS-MSG-AREA                          64800000
648100                               TO PV-COMMAREA-LENGTH              64810000
648200         PERFORM 9700-WRITE-TO-CICS-LOG                           64820000
648300         PERFORM 9900-SOFT-ABORT                                  64830000
648400     ELSE                                                         64840000
648500     IF  PC238-MOD-BAD-RCVR                                       64850000
648600         STRING ' RCKCS284 - '      DELIMITED BY SIZE             64860000
648700                ' 8800-UNITS-WORK-ROUTINE '                       64870000
648800                                    DELIMITED BY SIZE             64880000
648900                ' BAD RCVR NBR  '   DELIMITED BY SIZE             64890000
649000                PC-DISPLAY-RCVR     DELIMITED BY SIZE             64900000
649100                             INTO PV-CICS-MSG-AREA                64910000
649200         MOVE LENGTH OF PV-CICS-MSG-AREA                          64920000
649300                               TO PV-COMMAREA-LENGTH              64930000
649400         PERFORM 9700-WRITE-TO-CICS-LOG                           64940000
649500         STRING ' RCKCS284 - '      DELIMITED BY SIZE             64950000
649600                ' 8800-UNITS-WORK-ROUTINE '                       64960000
649700                                    DELIMITED BY SIZE             64970000
649800                ' KEY INFO - '      DELIMITED BY SIZE             64980000
649900                PC-DISPLAY-PO       DELIMITED BY SIZE             64990000
650000                ' - '               DELIMITED BY SIZE             65000000
650100                PC-DISPLAY-RCVR     DELIMITED BY SIZE             65010000
650200                ' - '               DELIMITED BY SIZE             65020000
650300                PC-DISPLAY-LINE     DELIMITED BY SIZE             65030000
650400                             INTO PV-CICS-MSG-AREA                65040000
650500         MOVE LENGTH OF PV-CICS-MSG-AREA                          65050000
650600                               TO PV-COMMAREA-LENGTH              65060000
650700         PERFORM 9700-WRITE-TO-CICS-LOG                           65070000
650800         PERFORM 9900-SOFT-ABORT                                  65080000
650900     ELSE                                                         65090000
651000     IF  PC238-MOD-BAD-LINE                                       65100000
651100         STRING ' RCKCS284 - '      DELIMITED BY SIZE             65110000
651200                ' 8800-UNITS-WORK-ROUTINE '                       65120000
651300                                    DELIMITED BY SIZE             65130000
651400                ' BAD LINE NBR  '   DELIMITED BY SIZE             65140000
651500                PC-DISPLAY-LINE     DELIMITED BY SIZE             65150000
651600                             INTO PV-CICS-MSG-AREA                65160000
651700         MOVE LENGTH OF PV-CICS-MSG-AREA                          65170000
651800                               TO PV-COMMAREA-LENGTH              65180000
651900         PERFORM 9700-WRITE-TO-CICS-LOG                           65190000
652000         STRING ' RCKCS284 - '      DELIMITED BY SIZE             65200000
652100                ' 8800-UNITS-WORK-ROUTINE '                       65210000
652200                                    DELIMITED BY SIZE             65220000
652300                ' KEY INFO - '      DELIMITED BY SIZE             65230000
652400                PC-DISPLAY-PO       DELIMITED BY SIZE             65240000
652500                ' - '               DELIMITED BY SIZE             65250000
652600                PC-DISPLAY-RCVR     DELIMITED BY SIZE             65260000
652700                ' - '               DELIMITED BY SIZE             65270000
652800                PC-DISPLAY-LINE     DELIMITED BY SIZE             65280000
652900                             INTO PV-CICS-MSG-AREA                65290000
653000         MOVE LENGTH OF PV-CICS-MSG-AREA                          65300000
653100                               TO PV-COMMAREA-LENGTH              65310000
653200         PERFORM 9700-WRITE-TO-CICS-LOG                           65320000
653300         PERFORM 9900-SOFT-ABORT                                  65330000
653400     ELSE                                                         65340000
653500     IF  PC238-MOD-BAD-NO-SHIFT                                   65350000
653600         STRING ' RCKCS284 - '      DELIMITED BY SIZE             65360000
653700                ' 8800-UNITS-WORK-ROUTINE '                       65370000
653800                                    DELIMITED BY SIZE             65380000
653900                ' SHIFT NOT FOUND ' DELIMITED BY SIZE             65390000
654000                PC238-WRKD-TMST     DELIMITED BY SIZE             65400000
654100                ' FOR OPER '        DELIMITED BY SIZE             65410000
654200                PC-DISPLAY-OPER     DELIMITED BY SIZE             65420000
654300                             INTO PV-CICS-MSG-AREA                65430000
654400         MOVE LENGTH OF PV-CICS-MSG-AREA                          65440000
654500                               TO PV-COMMAREA-LENGTH              65450000
654600         PERFORM 9700-WRITE-TO-CICS-LOG                           65460000
654700         STRING ' RCKCS284 - '      DELIMITED BY SIZE             65470000
654800                ' 8800-UNITS-WORK-ROUTINE '                       65480000
654900                                    DELIMITED BY SIZE             65490000
655000                ' KEY INFO - '      DELIMITED BY SIZE             65500000
655100                PC-DISPLAY-PO       DELIMITED BY SIZE             65510000
655200                ' - '               DELIMITED BY SIZE             65520000
655300                PC-DISPLAY-RCVR     DELIMITED BY SIZE             65530000
655400                ' - '               DELIMITED BY SIZE             65540000
655500                PC-DISPLAY-LINE     DELIMITED BY SIZE             65550000
655600                             INTO PV-CICS-MSG-AREA                65560000
655700         MOVE LENGTH OF PV-CICS-MSG-AREA                          65570000
655800                               TO PV-COMMAREA-LENGTH              65580000
655900         PERFORM 9700-WRITE-TO-CICS-LOG                           65590000
656000         PERFORM 9900-SOFT-ABORT                                  65600000
656100     ELSE                                                         65610000
656200         STRING ' RCKCS284 - '      DELIMITED BY SIZE             65620000
656300                ' 8800-UNITS-WORK-ROUTINE '                       65630000
656400                                    DELIMITED BY SIZE             65640000
656500                ' DB ERROR - SQL CODE '                           65650000
656600                                    DELIMITED BY SIZE             65660000
656700                PC-DISPLAY-SQL-CODE DELIMITED BY SIZE             65670000
656800                ' FUNC: '           DELIMITED BY SIZE             65680000
656900                PC238-BAD-TABLE-FUNCTION                          65690000
657000                                    DELIMITED BY SIZE             65700000
657100                ' TABLE: '          DELIMITED BY SIZE             65710000
657200                PC238-BAD-TABLE-NAME                              65720000
657300                                    DELIMITED BY SIZE             65730000
657400                             INTO PV-CICS-MSG-AREA                65740000
657500         MOVE LENGTH OF PV-CICS-MSG-AREA                          65750000
657600                               TO PV-COMMAREA-LENGTH              65760000
657700         PERFORM 9700-WRITE-TO-CICS-LOG                           65770000
657800         STRING ' RCKCS284 - '      DELIMITED BY SIZE             65780000
657900                ' 8800-UNITS-WORK-ROUTINE '                       65790000
658000                                    DELIMITED BY SIZE             65800000
658100                ' KEY INFO - '      DELIMITED BY SIZE             65810000
658200                PC-DISPLAY-PO       DELIMITED BY SIZE             65820000
658300                ' - '               DELIMITED BY SIZE             65830000
658400                PC-DISPLAY-RCVR     DELIMITED BY SIZE             65840000
658500                ' - '               DELIMITED BY SIZE             65850000
658600                PC-DISPLAY-LINE     DELIMITED BY SIZE             65860000
658700                             INTO PV-CICS-MSG-AREA                65870000
658800         MOVE LENGTH OF PV-CICS-MSG-AREA                          65880000
658900                               TO PV-COMMAREA-LENGTH              65890000
659000         PERFORM 9700-WRITE-TO-CICS-LOG                           65900000
659100         PERFORM 9900-SOFT-ABORT                                  65910000
659200     END-IF                                                       65920000
659300     END-IF                                                       65930000
659400     END-IF                                                       65940000
659500     END-IF                                                       65950000
659600     END-IF                                                       65960000
659700     END-IF                                                       65970000
659800     END-IF.                                                      65980000
659900                                                                  65990000
660000******************************************************************66000000
660100* RECORD IN THE SELECTION TEMP STORAGE QUEUE THE FACT THAT THIS  *66010000
660200* OBJECT WAS UPDATED.                                            *66020000
660300******************************************************************66030000
660400 9000-UPDATE-SELECTION-QUEUE.                                     66040000
660500                                                                  66050000
660600     PERFORM 9100-READ-SEL-QUEUE                                  66060000
660700                                                                  66070000
660800     SET RC013-UPD (ASC-SEL-SUB) TO TRUE                          66080000
660900     PERFORM 9200-REWRITE-LIST-QUEUE.                             66090000
661000                                                                  66100000
661100/                                                                 66110000
661200******************************************************************66120000
661300* READ AN ITEM FROM THE INPUT SELECTED ITEMS TEMP STORAGE QUEUE. *66130000
661400******************************************************************66140000
661500 9100-READ-SEL-QUEUE.                                             66150000
661600                                                                  66160000
661700     EXEC CICS                                                    66170000
661800         READQ TS                                                 66180000
661900             QUEUE (ASC-SEL-QUEUE-NAME-IN)                        66190000
662000             INTO  (RC013-DC-SELECT-RECORD)                       66200000
662100             ITEM  (ASC-SEL-ITEM)                                 66210000
662200             RESP  (PV-CICS-RESP)                                 66220000
662300     END-EXEC.                                                    66230000
662400                                                                  66240000
662500     IF PV-CICS-RESP EQUAL DFHRESP(NORMAL)                        66250000
662600         CONTINUE                                                 66260000
662700     ELSE                                                         66270000
662800         SET DP013-LOGIC-ABEND                                    66280000
662900             DP013-NO-ROLLBACK   TO TRUE                          66290000
663000         MOVE '9100-READ-SEL-QUEUE'                               66300000
663100                                 TO DP013-PARAGRAPH               66310000
663200         MOVE 'ATTEMPTING TO READ TO LIST SELECTIONS TS QUEUE'    66320000
663300                                 TO DP013-MESSAGE-TEXT (1)        66330000
663400         PERFORM DP013-0000-PROCESS-ABEND                         66340000
663500     END-IF.                                                      66350000
663600                                                                  66360000
663700/                                                                 66370000
663800******************************************************************66380000
663900* UPDATE AN ITEM IN THE INPUT SELECTED ITEMS TEMP STORAGE QUEUE. *66390000
664000******************************************************************66400000
664100 9200-REWRITE-LIST-QUEUE.                                         66410000
664200     EXEC CICS                                                    66420000
664300          WRITEQ TS                                               66430000
664400              QUEUE   (ASC-SEL-QUEUE-NAME-IN)                     66440000
664500              FROM    (RC013-DC-SELECT-RECORD)                    66450000
664600              ITEM    (ASC-SEL-ITEM)                              66460000
664700              RESP    (PV-CICS-RESP)                              66470000
664800              REWRITE                                             66480000
664900     END-EXEC.                                                    66490000
665000                                                                  66500000
665100     IF PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)                    66510000
665200         SET DP013-CICS-ABEND                                     66520000
665300             DP013-NO-ROLLBACK   TO TRUE                          66530000
665400         MOVE '9200-REWRITE-LIST-QUEUE'                           66540000
665500                                 TO DP013-PARAGRAPH               66550000
665600         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   66560000
665700                                 TO DP013-MESSAGE-TEXT (1)        66570000
665800         PERFORM DP013-0000-PROCESS-ABEND                         66580000
665900     END-IF.                                                      66590000
666000/                                                                 66600000
666100 9700-WRITE-TO-CICS-LOG.                                          66610000
666200                                                                  66620000
666300     EXEC CICS                                                    66630000
666400          WRITEQ TD                                               66640000
666500          QUEUE  ('CSSL')                                         66650000
666600          FROM  (PV-CICS-MSG-AREA)                                66660000
666700          LENGTH  (PV-COMMAREA-LENGTH)                            66670000
666800          RESP  (PV-CICS-RESP)                                    66680000
666900     END-EXEC.                                                    66690000
667000                                                                  66700000
667100     MOVE SPACES TO PV-CICS-MSG-AREA.                             66710000
667200/                                                                 66720000
667300******************************************************************66730000
667400*    THE DB2 RESOURCE IS NOT AVAILABLE, SET THE ERROR MESSAGE    *66740000
667500*    AND THE ERROR SWITCHES.                                     *66750000
667600******************************************************************66760000
667700 9900-SOFT-ABORT.                                                 66770000
667800     SET PS-ERROR         TO TRUE.                                66780000
667900     SET DP020-MSG-FATAL  TO TRUE.                                66790000
668000                                                                  66800000
668100     IF  PS-UNITS-WORKED-ERROR                                    66810000
668200         MOVE PC-TSYMSG-02875 TO DP020-MSG-NUMBER                 66820000
668300     ELSE                                                         66830000
668400         MOVE PC-TSYMSG-00551 TO DP020-MSG-NUMBER                 66840000
668500     END-IF.                                                      66850000
668600                                                                  66860000
668700     IF PS-NO-NEXT-SCREEN                                         66870000
668800        SET DP020-NEXT-ACT-APPL-ERROR TO TRUE                     66880000
668900     END-IF.                                                      66890000
669000*    IF PS-UPDATES-DONE AND SQLCODE = -913                        66900000
669100     IF PS-UPDATES-DONE                                           66910000
669200        PERFORM 9901-ROLLBACK                                     66920000
669300     END-IF.                                                      66930000
669400     MOVE 'PROGRAM EXIT CALL' TO DP013-MESSAGE-TEXT (1).          66940000
669500     PERFORM 0001-CALL-CICS-ARCH-API.                             66950000
669600                                                                  66960000
669700 9901-ROLLBACK.                                                   66970000
669800     EXEC CICS SYNCPOINT                                          66980000
669900          ROLLBACK                                                66990000
670000     END-EXEC.                                                    67000000
670100/                                                                 67010000
670200******************************************************************67020000
670300*    ABEND PROCESSING                                             67030000
670400******************************************************************67040000
670500     COPY DPPD013.                                                67050000
