000100*-----------------------*                                         00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300*-----------------------*                                         00030000
000400 PROGRAM-ID.    VNKCS016.                                         00040000
000500 AUTHOR.        DOUG NOLTNER - STRATAGEM.                         00050000
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060000
000700 DATE-WRITTEN.  06/93.                                            00070000
000800 DATE-COMPILED.                                                   00080000
000900*----------------------------------------------------------------*00090000
001000*    V016 - VENDOR NAME MAINTENANCE                              *00100000
001100*                                                                *00110000
001200*    THIS PROGRAM ALLOWS THE USER TO UPDATE, ADD OR DELETE       *00120000
001300*    A VENDOR ALIAS NAME, LABEL OR LONG NAME.                    *00130026
001301*                                                                *00130161
001302* CHANGE LOG:                                                     00130261
001310*  DATE  09/07/2021                                              *00131061
001320*            - CHANGE CALL OF DPKUT100 TO                       * 00132061
001330*              CALL DP010I-NUMERIC-EDIT-ROUTINE                 * 00133061
001340*              MAKING THE CALL DYNAMIC VS STATIC                * 00134061
001350*      MADE BY: GERMAN BANDA            WR/IR #: CHG0261091      *00135063
001301*                                                                *00135164
001310*  DATE  01/05/2023                                              *00136064
001320*            - CHANGE CALL OF DPKCS030 TO DYNAMIC               * 00137064
001350*      MADE BY: JEAN KURK               WR/IR #: CHG0277999      *00139164
001400*----------------------------------------------------------------*00140000
001500                                                                  00150000
001600                                                                  00160000
001700 ENVIRONMENT DIVISION.                                            00170000
001800                                                                  00180000
001900                                                                  00190000
002000 DATA DIVISION.                                                   00200000
002100                                                                  00210000
002200 WORKING-STORAGE SECTION.                                         00220000
002300                                                                  00230000
002400 01  PC-PROGRAM-CONSTANTS.                                        00240000
002500     05  PC-CURRENT-PROGRAM-NAME  PIC  X(08)  VALUE  'VNKCS016'.  00250000
002600     05  PC-CURRENT-MAP-NAME      PIC  X(08)  VALUE  'VN016A  '.  00260000
002700     05  PC-CURRENT-MAPSET-NAME   PIC  X(08)  VALUE  'VNKM016 '.  00270000
002800     05  PC-APPL-MAP              PIC S9(04)  VALUE  +1           00280000
002900                                              COMP.               00290000
003000     05  PC-MAX-RETRIES           PIC S9(04)  VALUE  +3           00300000
003100                                              COMP.               00310000
003200     05  PC-VNKCS024              PIC  X(08)  VALUE 'VNKCS024'.   00320041
003300     05  PC-INTER-APPL-CODES.                                     00330000
003400         10  PC-INTER-APPL-ADD    PIC  X(01)  VALUE '4'.          00340000
003500         10  PC-INTER-APPL-ADD-L  PIC  X(01)  VALUE '5'.          00350000
003600         10  PC-INTER-APPL-UPDATE PIC  X(01)  VALUE '2'.          00360000
003700         10  PC-INTER-APPL-DELETE PIC  X(01)  VALUE '3'.          00370000
003800                                                                  00380000
003900     05  PC-TSYMSG-NUMBERS.                                       00390000
004000         10  PC-TSYMSG-00004      PIC  9(05)  VALUE  00004.       00400001
004100         10  PC-TSYMSG-00007      PIC  9(05)  VALUE  00007.       00410000
004200         10  PC-TSYMSG-00008      PIC  9(05)  VALUE  00008.       00420000
004300         10  PC-TSYMSG-00034      PIC  9(05)  VALUE  00034.       00430000
004400         10  PC-TSYMSG-00057      PIC  9(05)  VALUE  00057.       00440000
004500         10  PC-TSYMSG-00059      PIC  9(05)  VALUE  00059.       00450000
004600         10  PC-TSYMSG-00069      PIC  9(05)  VALUE  00069.       00460000
004700         10  PC-TSYMSG-00070      PIC  9(05)  VALUE  00070.       00470000
004800         10  PC-TSYMSG-00115      PIC  9(05)  VALUE  00115.       00480000
004900         10  PC-TSYMSG-00148      PIC  9(05)  VALUE  00148.       00490000
005000         10  PC-TSYMSG-00160      PIC  9(05)  VALUE  00160.       00500000
005100         10  PC-TSYMSG-00166      PIC  9(05)  VALUE  00166.       00510000
005200         10  PC-TSYMSG-00483      PIC  9(05)  VALUE  00483.       00520000
005300         10  PC-TSYMSG-00490      PIC  9(05)  VALUE  00490.       00530000
005400         10  PC-TSYMSG-03619      PIC  9(05)  VALUE  03619.       00540025
005500         10  PC-TSYMSG-03620      PIC  9(05)  VALUE  03620.       00550030
005600         10  PC-TSYMSG-03622      PIC  9(05)  VALUE  03622.       00560036
005700         10  PC-TSYMSG-03623      PIC  9(05)  VALUE  03623.       00570051
005800*                                                                 00580000
005900 01  PS-PROGRAM-SWITCHES.                                         00590000
006000     05  PS-ERROR-SW              PIC  X(01)  VALUE  'N'.         00600000
006100         88  PS-ERROR                         VALUE  'Y'.         00610000
006200         88  PS-NO-ERROR                      VALUE  'N'.         00620000
006300*                                                                 00630000
006400 01  PV-PROGRAM-VARIABLES.                                        00640000
006500     05  PV-ONE                   PIC X       VALUE SPACES.       00650029
006600     05  PV-CICS-RESPONSE         PIC S9(04)  VALUE +0            00660000
006700                                              COMP SYNC.          00670000
006800     05  PV-RETRY-COUNTER         PIC S9(04)  VALUE +0            00680000
006900                                              COMP SYNC.          00690000
007000     05  PV-OLD-ENT-NAME-DESC     PIC X(250).                     00700054
007100     05  PV-NAME                  PIC X(250).                     00710048
007200     05  PV-NAME-RED REDEFINES PV-NAME.                           00720035
007300         10  PV-NAME-AREA            OCCURS 250 TIMES             00730035
007400                                     INDEXED BY PV-NAME-IDX.      00740035
007500             15  PV-NAME-1X          PIC X(1).                    00750035
007600                                                                  00760000
007700                                                                  00770031
007800**--------------------------------------------------------------**00780000
007900** THE LAYOUT FOR THE TEMPORARY STORAGE QUEUE CONTAINING        **00790000
008000** SELECTED LIST ITEMS TO BE PROCESSED BY THIS PROGRAM.         **00800000
008100**--------------------------------------------------------------**00810000
008200     COPY VNWS003.                                                00820000
008300                                                                  00830031
008400                                                                  00840000
008500*----------------------------------------------------------------*00850000
008600*    MAP LAYOUT                                                  *00860000
008700*----------------------------------------------------------------*00870000
008800                                                                  00880000
008900     COPY VNKM016.                                                00890000
009000                                                                  00900000
009100                                                                  00910031
009200*----------------------------------------------------------------*00920000
009300*    ATTRIBUTE SETTINGS COPYBOOK.                                *00930000
009400*----------------------------------------------------------------*00940000
009500                                                                  00950000
009600     COPY DPWS015.                                                00960000
009700                                                                  00970000
009800*----------------------------------------------------------------*00980000
009900*    FUNCTION KEYS COPYBOOK                                      *00990000
010000*----------------------------------------------------------------*01000000
010100                                                                  01010000
010200     COPY DPWS016.                                                01020000
010300                                                                  01030000
010400**--------------------------------------------------------------**01040041
010500** COMMAREA FOR VNKCS024                                        **01050041
010600**--------------------------------------------------------------**01060041
010700 01 VN007-COMMAREA.                                               01070041
010800     COPY VNWS007.                                                01080041
010900                                                                  01090031
011000**--------------------------------------------------------------**01100000
011100** NUMERIC EDIT LAYOUT (DPKUT100)                               **01110000
011200**--------------------------------------------------------------**01120000
011300     COPY DPWS010I.                                               01130000
011400                                                                  01140031
011500**--------------------------------------------------------------**01150000
011600** PARAMETERS FOR CALLING CICS ARCHITECTURE API                 **01160064
011700**--------------------------------------------------------------**01170000
011800     COPY DPWS030.                                                01180000
011800     COPY DPWS930.                                                01181064
011900                                                                  01190031
012000**--------------------------------------------------------------**01200000
012100*    STANDARD COMMAREA.                                           01210000
012200**--------------------------------------------------------------**01220000
012300                                                                  01230000
012400     COPY DPWS020.                                                01240000
012500     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                01250000
012600                                                                  01260000
012700***************************************************************** 01270000
012800*    INTER-APPLICATION COMMAREA.                                  01280000
012900***************************************************************** 01290000
013000                                                                  01300000
013100         10  INTER-APPL-COMM-AREA PIC X(200).                     01310000
013200     COPY VNWS002.                                                01320000
013300     COPY VNWS004.                                                01330000
013400***************************************************************** 01340000
013500*    SPECIFIC COMMMAREA FOR VNKCS016.                             01350000
013600***************************************************************** 01360000
013700         10  ASC-SPECIFIC-COMMAREA.                               01370000
013800             15  ASC-USE-SELECTION-QUEUE-IND                      01380000
013900                                           PIC  X(01).            01390000
014000                 88  ASC-USE-SELECTION-QUEUE           VALUE 'Y'. 01400000
014100             15  ASC-ADD-COMPLETE-SW       PIC  X(01).            01410000
014200                 88  ASC-ADD-COMPLETE                  VALUE 'Y'. 01420000
014300                 88  ASC-ADD-PENDING                   VALUE 'N'. 01430000
014400             15  ASC-DEL-COMPLETE-SW       PIC  X(01).            01440000
014500                 88  ASC-DEL-COMPLETE                  VALUE 'Y'. 01450000
014600                 88  ASC-DEL-PENDING                   VALUE 'N'. 01460000
014700             15  ASC-FACTORY-VNDR-SW       PIC  X(01).            01470034
014800                 88  ASC-FACTORY-VNDR                  VALUE 'Y'. 01480034
014900                 88  ASC-NOT-FACTORY-VNDR              VALUE 'N'. 01490034
015000             15  ASC-LONGNAME-FOUND-SW     PIC  X(01).            01500032
015100                 88  ASC-LONGNAME-FOUND                VALUE 'Y'. 01510032
015200                 88  ASC-LONGNAME-NOT-FOUND            VALUE 'N'. 01520032
015300             15  ASC-NAME-TOO-LARGE-SW     PIC  X(01).            01530035
015400                 88  ASC-NAME-TOO-LARGE                VALUE 'Y'. 01540035
015500                 88  ASC-NAME-NOT-TOO-LARGE            VALUE 'N'. 01550035
015600             15  ASC-STOP-DELETE-SW        PIC  X(01).            01560050
015700                 88  ASC-STOP-DELETE                   VALUE 'Y'. 01570050
015800                 88  ASC-ALLOW-DELETE                  VALUE 'N'. 01580050
015900             15  ASC-SEL-QUEUE-NAME        PIC  X(08).            01590000
016000             15  ASC-NUMBER-OF-TS-ITEMS    PIC S9(05)  COMP-3.    01600000
016100             15  ASC-NUMBER-OF-SELECTED-ITEMS                     01610000
016200                                           PIC S9(09)  COMP-3.    01620000
016300             15  ASC-SEL-SUB               PIC S9(04)  COMP.      01630000
016400             15  ASC-SEL-ITEM              PIC S9(04)  COMP.      01640000
016500             15  ASC-VEND-ANAME-FULL       PIC  X(250).           01650016
016600             15  ASC-TYPE-CODE             PIC  X(02).            01660000
016700             15  ASC-TYPE-CODE-N REDEFINES ASC-TYPE-CODE          01670000
016800                                           PIC  9(02).            01680000
016900             15  ASC-ENT-ID                PIC S9(09)  COMP.      01690000
017000             15  ASC-SEQ-NBR               PIC S9(04)  COMP.      01700000
017100             15  ASC-PRIM-VEND-NAME        PIC  X(30).            01710000
017200                                                                  01720031
017300*----------------------------------------------------------------*01730000
017400*    ABEND PROCESSING COPYBOOK.                                  *01740000
017500*----------------------------------------------------------------*01750000
017600                                                                  01760000
017700     COPY DPWS013.                                                01770000
017800                                                                  01780000
017900                                                                  01790029
018000*----------------------------------------------------------------*01800031
018100*    DB2 AREA FOR ENTERPRISE NAME                                *01810031
018200*----------------------------------------------------------------*01820031
018300     EXEC SQL                                                     01830031
018400          INCLUDE TENTNME                                         01840031
018500     END-EXEC.                                                    01850031
018600                                                                  01860031
018700*----------------------------------------------------------------*01870041
018800*    DB2 AREA FOR EXTERNAL ENTERPRISE                            *01880041
018900*----------------------------------------------------------------*01890041
019000     EXEC SQL                                                     01900041
019100          INCLUDE TEXTENT                                         01910041
019200     END-EXEC.                                                    01920041
019300                                                                  01930041
019400*--------------------------------------------------------------*  01940029
019500* TABLE USED FOR EXISTENCE CHECKING                            *  01950029
019600*--------------------------------------------------------------*  01960029
019700     EXEC SQL                                                     01970031
019800          INCLUDE SYSDUMMY                                        01980031
019900     END-EXEC.                                                    01990031
020000                                                                  02000029
020100*----------------------------------------------------------------*02010000
020200*    DB2 AREA FOR COMMUNICATIONS                                 *02020000
020300*----------------------------------------------------------------*02030000
020400     EXEC SQL                                                     02040000
020500          INCLUDE SQLCA                                           02050000
020600     END-EXEC.                                                    02060000
020700                                                                  02070000
020800                                                                  02080031
020900 LINKAGE SECTION.                                                 02090000
021000                                                                  02100000
021100 01  DFHCOMMAREA.                                                 02110000
021200     05  FILLER                         OCCURS  1 TO 4072 TIMES   02120000
021300                                        DEPENDING ON EIBCALEN.    02130000
021400         10  FILLER                     PIC X.                    02140000
021500                                                                  02150000
021600                                                                  02160000
021700 PROCEDURE DIVISION.                                              02170000
021800***************************************************************** 02180000
021900** THIS MODULE CONTROLS THE OVERALL PROCESSING IN THE PROGRAM. ** 02190000
022000** THE SETUP AND PERFORM OF PARAGRAPH 0001-CALL-CICS-ARCH-API  ** 02200000
022100** MUST BE THE FIRST CODE EXECUTED IN THIS PROGRAM.            ** 02210000
022200**                                                             ** 02220000
022300** THE SECOND OR 'EXIT' PERFORM OF THIS PARAGRAPH MUST BE THE  ** 02230000
022400** LAST CODE EXECUTED ON EACH ITERATION OF THIS PROGRAM.       ** 02240000
022500***************************************************************** 02250000
022600 0000-MAIN-MODULE.                                                02260000
022700     INITIALIZE DP030-CICS-API-FIELDS.                            02270000
022800     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       02280000
022900     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          02290000
023000     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         02300000
023100     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       02310000
023200     MOVE LENGTH OF VN016AI        TO DP030-MAP-LENGTH (1).       02320000
023300     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     02330000
023400     PERFORM 0001-CALL-CICS-ARCH-API.                             02340000
023500*                                                                 02350000
023600     PERFORM 1000-CONTROL-PROCESSING                              02360000
023700*                                                                 02370000
023800     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     02380000
023900     PERFORM 0001-CALL-CICS-ARCH-API.                             02390000
024000                                                                  02400000
024100 0001-CALL-CICS-ARCH-API.                                         02410000
024200*    CALL 'DPKCS030' USING DFHEIBLK                               02420064
024200     CALL DP930-CICS-ARCH-API USING DFHEIBLK                      02421064
024300                           DFHCOMMAREA                            02430000
024400                           DP030-CICS-API-FIELDS                  02440000
024500                           DP020-STANDARD-COMMAREA                02450000
024600                           VN016AI.                               02460000
024700*                                                                 02470000
024800     IF  DP030-RC-CALL-SUCCESSFUL                                 02480000
024900         CONTINUE                                                 02490000
025000     ELSE                                                         02500000
025100         SET DP013-NO-ROLLBACK                                    02510000
025200             DP013-XCTL-DISPLAY-RESTART                           02520000
025300             DP013-CICS-ABEND      TO TRUE                        02530000
025400         MOVE 'BEFORE 0000-MAIN-MODULE'                           02540000
025500                                   TO DP013-PARAGRAPH             02550000
025600*        MOVE 'CALL TO DPKCS030 NOT SUCCESSFUL, RETURN-CODE ON NEX02560064
025700*             'T LINE'             TO DP013-MESSAGE-TEXT (2)      02570064
025600         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN CODE O02571064
025700-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      02572064
025800         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      02580000
025900         PERFORM DP013-0000-PROCESS-ABEND                         02590000
026000     END-IF.                                                      02600000
026100                                                                  02610031
026200*----------------------------------------------------------------*02620000
026300*    PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT   *02630000
026400*    COURSE OF ACTION IS FOR THIS TRANSACTION.                   *02640000
026500*----------------------------------------------------------------*02650000
026600                                                                  02660000
026700 1000-CONTROL-PROCESSING.                                         02670000
026800                                                                  02680000
026900     EVALUATE TRUE                                                02690000
027000         WHEN DP020-NEXT-ACT-INITIAL                              02700000
027100             PERFORM 1100-FIND-OBJECT-KEYS                        02710000
027200             IF  PS-ERROR                                         02720000
027300                 CONTINUE                                         02730000
027400             ELSE                                                 02740000
027500                 PERFORM 4000-BUILD-INITIAL-PANEL                 02750000
027600             END-IF                                               02760000
027700                                                                  02770000
027800         WHEN DP020-NEXT-ACT-READ-MAP                             02780000
027900             PERFORM 2000-PROCESS-PANEL                           02790000
028000                                                                  02800000
028100         WHEN OTHER                                               02810000
028200             SET DP013-LOGIC-ABEND TO TRUE                        02820000
028300             SET DP013-NO-ROLLBACK TO TRUE                        02830000
028400             MOVE '1000-CONTROL-PROCESSING'                       02840000
028500                                   TO DP013-PARAGRAPH             02850000
028600             MOVE 'INVALID NEXT ACTIVITY RETURNED TO APPL PGM:'   02860000
028700                                   TO DP013-MESSAGE-TEXT(1)       02870000
028800             MOVE DP020-NEXT-APPL-ACTIVITY                        02880000
028900                                   TO DP013-MESSAGE-TEXT(2)       02890000
029000             PERFORM DP013-0000-PROCESS-ABEND                     02900000
029100     END-EVALUATE.                                                02910000
029200******************************************************************02920000
029300** DETERMINE THE KEY OF THE OBJECT TO BE UPDATED BASED ON THE   **02930000
029400** INTER-APPLICATION FORMAT CODE.                               **02940000
029500******************************************************************02950000
029600 1100-FIND-OBJECT-KEYS.                                           02960000
029700     INITIALIZE ASC-SPECIFIC-COMMAREA.                            02970000
029800     EVALUATE DP020-INT-APPL-FORMAT-IND                           02980000
029900         WHEN PC-INTER-APPL-ADD                                   02990000
030000             MOVE VN004-ENT-ID TO ASC-ENT-ID                      03000000
030100             MOVE ZERO TO ASC-SEQ-NBR                             03010000
030200             SET ASC-ADD-PENDING TO TRUE                          03020000
030300         WHEN PC-INTER-APPL-ADD-L                                 03030000
030400             MOVE VN002-ENT-ID TO ASC-ENT-ID                      03040000
030500             MOVE ZERO TO ASC-SEQ-NBR                             03050000
030600             SET ASC-ADD-PENDING TO TRUE                          03060000
030700         WHEN PC-INTER-APPL-UPDATE                                03070000
030800         WHEN PC-INTER-APPL-DELETE                                03080000
030900             IF VN002-NUMBER-OF-SELECTED-ITEMS = ZERO             03090000
031000                 MOVE PC-TSYMSG-00057 TO DP020-MSG-NUMBER         03100000
031100                 SET DP020-MSG-FATAL TO TRUE                      03110000
031200                 SET DP020-NEXT-ACT-APPL-ERROR TO TRUE            03120000
031300                 SET PS-ERROR TO TRUE                             03130000
031400             ELSE                                                 03140000
031500                 SET ASC-USE-SELECTION-QUEUE TO TRUE              03150000
031600                 MOVE VN002-NUMBER-OF-SELECTED-ITEMS              03160000
031700                                   TO ASC-NUMBER-OF-SELECTED-ITEMS03170000
031800                 MOVE VN002-NUMBER-OF-TS-ITEMS                    03180000
031900                                   TO ASC-NUMBER-OF-TS-ITEMS      03190000
032000                 MOVE VN002-SEL-QUEUE-NAME                        03200000
032100                                   TO ASC-SEL-QUEUE-NAME          03210000
032200                 PERFORM 1120-PREPARE-LIST-ENTRY                  03220000
032300             END-IF                                               03230000
032400                                                                  03240000
032500     END-EVALUATE.                                                03250000
032600*----------------------------------------------------------------*03260000
032700* ENTRY IS FROM A LIST.  GET THE MESSAGE NUMBER FROM THE TEMP    *03270000
032800* STORAGE QUEUE PASSED FROM THE LIST.                            *03280000
032900*----------------------------------------------------------------*03290000
033000 1120-PREPARE-LIST-ENTRY.                                         03300000
033100     MOVE VN003-MAX-ITEMS          TO ASC-SEL-SUB.                03310000
033200     MOVE ZERO                     TO ASC-SEL-ITEM.               03320000
033300     PERFORM 2110-GET-NEXT-VENDOR.                                03330000
033400*----------------------------------------------------------------*03340000
033500* DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA   *03350000
033600* ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *03360000
033700* USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *03370000
033800* OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *03380000
033900* FUNCTION KEYS CAN GET THIS FAR.                                *03390000
034000*----------------------------------------------------------------*03400000
034100                                                                  03410000
034200 2000-PROCESS-PANEL.                                              03420000
034300                                                                  03430000
034400     EVALUATE TRUE                                                03440000
034500                                                                  03450000
034600         WHEN DP020-SRC-AID = DP016-CLEAR                         03460000
034700             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 03470000
034800             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   03480000
034900                                                                  03490000
035000         WHEN DP020-FK-REFRESH(DP020-SRC-AID)                     03500000
035100             SET DP030-DONT-ERASE                                 03510000
035200                 DP030-SEND-DATAONLY (PC-APPL-MAP)                03520000
035300                                   TO TRUE                        03530000
035400             PERFORM 4000-BUILD-INITIAL-PANEL                     03540000
035500             PERFORM 3200-RESET-ATTRIBUTES                        03550000
035600                                                                  03560000
035700         WHEN DP020-FK-NEXT-SELECTION (DP020-SRC-AID)             03570000
035800             IF  ASC-USE-SELECTION-QUEUE                          03580000
035900                 PERFORM 2110-GET-NEXT-VENDOR                     03590000
036000                 PERFORM 4000-BUILD-INITIAL-PANEL                 03600000
036100                 PERFORM 3200-RESET-ATTRIBUTES                    03610000
036200             ELSE                                                 03620000
036300*                --- BOTTOM OF LIST ---                           03630000
036400                 MOVE PC-TSYMSG-00070                             03640000
036500                                   TO DP020-MSG-NUMBER            03650000
036600                 SET DP020-MSG-INFORMATIONAL                      03660000
036700                                   TO TRUE                        03670000
036800             END-IF                                               03680000
036900                                                                  03690000
037000         WHEN DP020-FK-PREV-SELECTION (DP020-SRC-AID)             03700000
037100             IF  ASC-USE-SELECTION-QUEUE                          03710000
037200                 PERFORM 2120-GET-PREV-VENDOR                     03720000
037300                 PERFORM 4000-BUILD-INITIAL-PANEL                 03730000
037400                 PERFORM 3200-RESET-ATTRIBUTES                    03740000
037500             ELSE                                                 03750000
037600*                --- TOP OF LIST ---                              03760000
037700                 MOVE PC-TSYMSG-00069                             03770000
037800                                   TO DP020-MSG-NUMBER            03780000
037900                 SET DP020-MSG-INFORMATIONAL                      03790000
038000                                   TO TRUE                        03800000
038100             END-IF                                               03810000
038200                                                                  03820000
038300         WHEN ASC-ADD-COMPLETE                                    03830000
038400             PERFORM 1100-FIND-OBJECT-KEYS                        03840000
038500             IF  PS-ERROR                                         03850000
038600                 CONTINUE                                         03860000
038700             ELSE                                                 03870000
038800                 PERFORM 4000-BUILD-INITIAL-PANEL                 03880000
038900             END-IF                                               03890000
039000                                                                  03900000
039100         WHEN ASC-DEL-COMPLETE                                    03910000
039200             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 03920000
039300                                                                  03930000
039400         WHEN OTHER                                               03940000
039500             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 03950000
039600             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   03960000
039700             IF  PS-NO-ERROR                                      03970000
039800                 SET DP030-CONTINUE-GO                            03980000
039900                                   TO TRUE                        03990000
040000                 PERFORM 2100-CHECK-FUNCTION-KEY                  04000000
040100                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             04010000
040200             ELSE                                                 04020000
040300                 SET DP030-OVERRIDE-GO                            04030000
040400                                   TO TRUE                        04040000
040500             END-IF                                               04050000
040600     END-EVALUATE.                                                04060000
040700*----------------------------------------------------------------*04070000
040800* ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED       *04080000
040900* FIRST.  NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED   *04090000
041000* FROM THE CICS ARCHITECTURE API.                                *04100000
041100*----------------------------------------------------------------*04110000
041200                                                                  04120000
041300 2100-CHECK-FUNCTION-KEY.                                         04130000
041400     EVALUATE TRUE                                                04140000
041500         WHEN DP020-SRC-AID = DP016-ENTER                         04150000
041600             CONTINUE                                             04160000
041700         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              04170000
041800             SET DP030-CONTINUE-GO TO TRUE                        04180000
041900             PERFORM 5000-ADD-VENDOR-NAME                         04190000
042000*            --- ADD SUCCESSFUL ---                               04200000
042100             MOVE PC-TSYMSG-00034  TO DP020-MSG-NUMBER            04210000
042200             SET DP020-MSG-INFORMATIONAL                          04220000
042300                                   TO TRUE                        04230000
042400             SET ASC-ADD-COMPLETE TO TRUE                         04240000
042500             SET DP030-ERASE-UNPROT TO TRUE                       04250000
042600         WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              04260000
042700             SET DP030-CONTINUE-GO TO TRUE                        04270000
042800             PERFORM 6000-UPDATE-VENDOR-NAME                      04280000
042900*            --- UPDATES SUCCESSFUL ---                           04290000
043000             MOVE PC-TSYMSG-00059  TO DP020-MSG-NUMBER            04300000
043100             SET DP020-MSG-INFORMATIONAL                          04310000
043200                               TO TRUE                            04320000
043300         WHEN DP020-FK-CONFIRM (DP020-SRC-AID)                    04330000
043400             SET DP030-CONTINUE-GO TO TRUE                        04340000
043500             PERFORM 7000-DELETE-VENDOR-NAME                      04350000
043600*            --- DELETE  SUCCESSFUL ---                           04360000
043700             MOVE PC-TSYMSG-00115  TO DP020-MSG-NUMBER            04370000
043800             SET DP020-MSG-INFORMATIONAL TO TRUE                  04380006
043900             SET ASC-DEL-COMPLETE TO TRUE                         04390000
044000         WHEN OTHER                                               04400000
044100             SET DP013-NO-ROLLBACK                                04410000
044200                 DP013-XCTL-DISPLAY-RESTART                       04420000
044300                 DP013-CICS-ABEND  TO TRUE                        04430000
044400             MOVE '2100-CHECK-FUNCTION-KEY'                       04440000
044500                                   TO DP013-PARAGRAPH             04450000
044600             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      04460000
044700                                   TO DP013-MESSAGE-TEXT (1)      04470000
044800             PERFORM DP013-0000-PROCESS-ABEND                     04480000
044900     END-EVALUATE.                                                04490000
045000                                                                  04500000
045100******************************************************************04510000
045200** GET THE VENDOR  NUMBER (KEY) OF THE NEXT SELECTED            **04520000
045300** OBJECT FROM THE SELECTED-ITEMS TEMP. STORAGE QUEUE.          **04530000
045400******************************************************************04540000
045500 2110-GET-NEXT-VENDOR.                                            04550000
045600     ADD +1                        TO ASC-SEL-SUB.                04560000
045700     IF  ASC-SEL-SUB > VN003-MAX-ITEMS                            04570000
045800         ADD +1                    TO ASC-SEL-ITEM                04580000
045900         MOVE +1                   TO ASC-SEL-SUB                 04590000
046000     END-IF.                                                      04600000
046100     IF  ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                04610000
046200         PERFORM 9100-READ-SEL-QUEUE                              04620000
046300         IF  VN003-ENT-ID (ASC-SEL-SUB) > ZERO                    04630000
046400             MOVE VN003-ENT-ID (ASC-SEL-SUB)                      04640000
046500                                   TO ASC-ENT-ID                  04650000
046600             MOVE VN003-SEQ-NBR (ASC-SEL-SUB)                     04660000
046700                                   TO ASC-SEQ-NBR                 04670000
046800             SET VN003-INQ (ASC-SEL-SUB)                          04680000
046900                                   TO TRUE                        04690000
047000             PERFORM 9200-REWRITE-LIST-QUEUE                      04700000
047100          IF DP020-INT-APPL-FORMAT-IND = PC-INTER-APPL-DELETE     04710013
047200             MOVE PC-TSYMSG-00004                                 04720013
047300                           TO DP020-MSG-NUMBER                    04730013
047400             SET DP020-MSG-INFORMATIONAL TO TRUE                  04740013
047500          END-IF                                                  04750013
047600         ELSE                                                     04760000
047700             SUBTRACT +1 FROM ASC-SEL-SUB                         04770000
047800*            --- BOTTOM OF LIST ---                               04780000
047900             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            04790000
048000             SET DP020-MSG-INFORMATIONAL                          04800000
048100                                   TO TRUE                        04810000
048200         END-IF                                                   04820000
048300     ELSE                                                         04830000
048400         SUBTRACT +1 FROM ASC-SEL-ITEM                            04840000
048500         MOVE VN003-MAX-ITEMS      TO ASC-SEL-SUB                 04850000
048600         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            04860000
048700         SET DP020-MSG-INFORMATIONAL                              04870000
048800                                   TO TRUE                        04880000
048900     END-IF.                                                      04890000
049000******************************************************************04900000
049100** GET THE MESSAGE NUMBER (KEY) OF THE PREVIOUS SELECTED        **04910000
049200** OBJECT FROM THE SELECTED-ITEMS TEMP. STORAGE QUEUE.          **04920000
049300******************************************************************04930000
049400 2120-GET-PREV-VENDOR.                                            04940000
049500     SUBTRACT +1 FROM ASC-SEL-SUB.                                04950000
049600     IF  ASC-SEL-SUB < +1                                         04960000
049700         SUBTRACT +1 FROM ASC-SEL-ITEM                            04970000
049800         MOVE VN003-MAX-ITEMS      TO ASC-SEL-SUB                 04980000
049900     END-IF.                                                      04990000
050000*                                                                 05000000
050100     IF  ASC-SEL-ITEM > ZERO                                      05010000
050200         PERFORM 9100-READ-SEL-QUEUE                              05020000
050300         MOVE VN003-ENT-ID (ASC-SEL-SUB)                          05030000
050400                                   TO ASC-ENT-ID                  05040000
050500         MOVE VN003-SEQ-NBR (ASC-SEL-SUB)                         05050000
050600                                   TO ASC-SEQ-NBR                 05060000
050700     ELSE                                                         05070000
050800         MOVE +1                   TO ASC-SEL-ITEM                05080000
050900                                      ASC-SEL-SUB                 05090000
051000*        --- TOP OF LIST ---                                      05100000
051100         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            05110000
051200         SET DP020-MSG-INFORMATIONAL                              05120000
051300                                   TO TRUE                        05130000
051400     END-IF.                                                      05140000
051500                                                                  05150031
051600*----------------------------------------------------------------*05160000
051700* MOVE DATA ENTERED ON THE SCREEN INTO THEIR RESPECTIVE FIELDS   *05170000
051800* IN THE APPLICATION-SPECIFIC COMMAREA.  ALL EDITS ARE DONE IN   *05180000
051900* THE APPLICATION-SPECIFIC COMMAERA, NOT ON THE SCREEN.          *05190000
052000*----------------------------------------------------------------*05200000
052100                                                                  05210000
052200 2200-MOVE-SCREEN-TO-COMMAREA.                                    05220000
052300     IF AVNANMEL > ZERO                                           05230023
052400         MOVE AVNANMEI             TO ASC-VEND-ANAME-FULL         05240021
052500     ELSE                                                         05250000
052600         IF AVNANMEF = DP015-ERASE-EOF                            05260000
052700             MOVE SPACE            TO ASC-VEND-ANAME-FULL         05270016
052800         END-IF                                                   05280000
052900     END-IF.                                                      05290000
053000                                                                  05300000
053100     IF AVNNMTPL > ZERO                                           05310000
053200         MOVE AVNNMTPI             TO ASC-TYPE-CODE               05320000
053300     ELSE                                                         05330000
053400         IF AVNNMTPF = DP015-ERASE-EOF                            05340000
053500             MOVE SPACE            TO ASC-TYPE-CODE               05350000
053600         END-IF                                                   05360000
053700     END-IF.                                                      05370000
053800                                                                  05380000
053900                                                                  05390031
054000*----------------------------------------------------------------*05400000
054100* PERFORM EDITS ON EACH FIELD ENTERED BY THE USER.  IF AN ERROR  *05410000
054200* IS FOUND, THE CURSOR IS POSITIONED AT THAT FIELD AND AN        *05420000
054300* APPROPRIATE ERROR MESSAGE IS DISPLAYED.                        *05430000
054400*----------------------------------------------------------------*05440000
054500                                                                  05450000
054600 3000-EDIT-DATA-IN-COMMAREA.                                      05460000
054700                                                                  05470000
054800     PERFORM 3200-RESET-ATTRIBUTES.                               05480000
054900                                                                  05490000
055000     MOVE ASC-TYPE-CODE   TO DP010I-UNEDITED-FIELD.               05500000
055100     MOVE 2               TO DP010I-MAXIMUM-DIGITS.               05510000
055200     MOVE 0               TO DP010I-MAXIMUM-DECIMALS.             05520000
055300     SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE.                     05530000
055310     CALL DP010I-NUMERIC-EDIT-ROUTINE                             05531061
055320                         USING DP010I-NUMERIC-EDIT-AREA           05532061
055500     IF DP010I-ERROR-DETECTED                                     05550000
055600        SET PS-ERROR          TO TRUE                             05560034
055700        SET DP020-MSG-FATAL   TO TRUE                             05570034
055800*       --- MUST BE NUMERIC    ---                                05580034
055900        MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER                 05590034
056000        MOVE DP015-UNP-ALP-BRT-OFF                                05600034
056100                              TO AVNNMTPA                         05610034
056200        MOVE DP015-RED        TO AVNNMTPC                         05620034
056300        MOVE DP015-REVERSE    TO AVNNMTPH                         05630034
056400        MOVE -1               TO AVNNMTPL                         05640034
056500        SET DP030-SET-CURSOR-APPL-1                               05650034
056600                              TO TRUE                             05660034
056700     ELSE                                                         05670000
056800        MOVE DP010I-NUMERIC-FIELD TO ASC-TYPE-CODE-N              05680034
056900        IF ASC-TYPE-CODE = '02' OR '03' OR '05'                   05690034
057000           CONTINUE                                               05700034
057100        ELSE                                                      05710034
057200           SET PS-ERROR          TO TRUE                          05720034
057300           SET DP020-MSG-FATAL   TO TRUE                          05730034
057400*        --- NAME TYPE CODE MUST BE "02" OR "03" OR "05"          05740028
057500           MOVE PC-TSYMSG-03619  TO DP020-MSG-NUMBER              05750034
057600           MOVE DP015-UNP-ALP-BRT-OFF                             05760034
057700                                 TO AVNNMTPA                      05770034
057800           MOVE DP015-RED        TO AVNNMTPC                      05780034
057900           MOVE DP015-REVERSE    TO AVNNMTPH                      05790034
058000           MOVE -1               TO AVNNMTPL                      05800034
058100           SET DP030-SET-CURSOR-APPL-1                            05810034
058200                                 TO TRUE                          05820034
058300        END-IF                                                    05830034
058400     END-IF.                                                      05840000
058500                                                                  05850000
058600     IF ASC-ADD-PENDING AND                                       05860034
058700        ASC-TYPE-CODE = '05'                                      05870034
058800        PERFORM 3310-CHECK-LONGNAME-EXISTENCE                     05880028
058900        IF ASC-LONGNAME-FOUND                                     05890031
059000           SET PS-ERROR          TO TRUE                          05900028
059100           SET DP020-MSG-FATAL   TO TRUE                          05910028
059200*        --- CANNOT ADD A LONG NAME BECAUSE ONE ALREADY EXISTS    05920028
059300           MOVE PC-TSYMSG-03620  TO DP020-MSG-NUMBER              05930028
059400           MOVE DP015-UNP-ALP-BRT-OFF                             05940028
059500                                 TO AVNNMTPA                      05950028
059600           MOVE DP015-RED        TO AVNNMTPC                      05960028
059700           MOVE DP015-REVERSE    TO AVNNMTPH                      05970028
059800           MOVE -1               TO AVNNMTPL                      05980028
059900           SET DP030-SET-CURSOR-APPL-1                            05990028
060000                                 TO TRUE                          06000028
060100        END-IF                                                    06010028
060200     END-IF.                                                      06020032
060300                                                                  06030032
060400     IF ASC-VEND-ANAME-FULL = SPACES                              06040034
060500        SET PS-ERROR              TO TRUE                         06050034
060600        SET DP020-MSG-FATAL       TO TRUE                         06060034
060700        MOVE PC-TSYMSG-00007      TO DP020-MSG-NUMBER             06070034
060800        MOVE DP015-UNP-ALP-BRT-OFF                                06080034
060900                                  TO AVNANMEA                     06090034
061000        MOVE DP015-RED            TO AVNANMEC                     06100034
061100        MOVE DP015-REVERSE        TO AVNANMEH                     06110034
061200        MOVE -1                   TO AVNANMEL                     06120034
061300        SET DP030-SET-CURSOR-APPL-1                               06130034
061400                                  TO TRUE                         06140034
061500     ELSE                                                         06150034
061600        PERFORM 3300-SELECT-TENTNME-NAME                          06160034
061700        IF SQLCODE = ZERO                                         06170034
061800           IF ENTNME-ENT-ID = ASC-ENT-ID AND                      06180034
061900              ENTNME-SEQ-NBR = ASC-SEQ-NBR                        06190034
062000              CONTINUE                                            06200034
062100           ELSE                                                   06210034
062200              SET PS-ERROR          TO TRUE                       06220034
062300              SET DP020-MSG-FATAL   TO TRUE                       06230034
062400*             --- NAME ALREADY EXISTS ---                         06240034
062500              MOVE PC-TSYMSG-00490  TO DP020-MSG-NUMBER           06250034
062600              MOVE DP015-UNP-ALP-BRT-OFF                          06260034
062700                                    TO AVNANMEA                   06270034
062800              MOVE DP015-RED        TO AVNANMEC                   06280034
062900              MOVE DP015-REVERSE    TO AVNANMEH                   06290034
063000              MOVE -1               TO AVNANMEL                   06300034
063100              SET DP030-SET-CURSOR-APPL-1                         06310034
063200                                    TO TRUE                       06320034
063300           END-IF                                                 06330034
063400        END-IF                                                    06340034
063500     END-IF.                                                      06350034
063600                                                                  06360034
063700     IF ASC-TYPE-CODE = '02' OR '03'                              06370035
063800        PERFORM 3330-CHECK-NAME                                   06380035
063900        IF ASC-NAME-TOO-LARGE                                     06390035
064000           SET PS-ERROR          TO TRUE                          06400035
064100           SET DP020-MSG-FATAL   TO TRUE                          06410035
064200*     --- THE NAME CANNOT BE > 30 CHARACTERS                      06420035
064300           MOVE PC-TSYMSG-03622  TO DP020-MSG-NUMBER              06430035
064400           MOVE DP015-UNP-ALP-BRT-OFF                             06440035
064500                                 TO AVNANMEA                      06450035
064600           MOVE DP015-RED        TO AVNANMEC                      06460035
064700           MOVE DP015-REVERSE    TO AVNANMEH                      06470035
064800           MOVE -1               TO AVNANMEL                      06480035
064900           SET DP030-SET-CURSOR-APPL-1                            06490035
065000                                 TO TRUE                          06500035
065100        END-IF                                                    06510035
065200     END-IF.                                                      06520035
065300                                                                  06530035
065400     IF PS-NO-ERROR                                               06540034
065500        MOVE -1                   TO AVNANMEL                     06550034
065600        SET DP030-SET-CURSOR-APPL-1                               06560034
065700                                  TO TRUE                         06570034
065800     END-IF.                                                      06580034
065900                                                                  06590034
066000*----------------------------------------------------------------*06600034
066100* MOVE THE DEFAULT ATTRIBUTE VALUES TO THE ENTERABLE FIELDS ON   *06610034
066200* MAP.                                                           *06620034
066300*----------------------------------------------------------------*06630034
066400 3200-RESET-ATTRIBUTES.                                           06640034
066500     MOVE DP015-UNP-ALP-NOR-OFF    TO AVNANMEA                    06650034
066600                                      AVNNMTPA.                   06660034
066700     MOVE DP015-GREEN              TO AVNANMEC                    06670034
066800                                      AVNNMTPC.                   06680034
066900     MOVE DP015-UNDERLINE          TO AVNANMEH                    06690034
067000                                      AVNNMTPH.                   06700034
067100*----------------------------------------------------------------*06710034
067200*  CHECK FOR DUPLICATE NAME.                                      06720034
067300*----------------------------------------------------------------*06730034
067400 3300-SELECT-TENTNME-NAME.                                        06740034
067500     PERFORM                                                      06750034
067600         WITH TEST AFTER                                          06760034
067700         VARYING PV-RETRY-COUNTER                                 06770034
067800         FROM 1 BY 1                                              06780034
067900         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               06790034
068000                   OR (SQLCODE = ZERO)                            06800034
068100                   OR (SQLCODE = +100))                           06810034
068200                                                                  06820035
068300         EXEC SQL                                                 06830034
068400             SELECT ENT_ID                                        06840034
068500                  , SEQ_NBR                                       06850034
068600             INTO  :ENTNME-ENT-ID                                 06860034
068700                  ,:ENTNME-SEQ-NBR                                06870034
068800             FROM TENTNME                                         06880034
068900             WHERE                                                06890034
069000                ENT_NAME_DESC = :ASC-VEND-ANAME-FULL              06900034
069100         END-EXEC                                                 06910034
069200                                                                  06920034
069300         EVALUATE TRUE                                            06930034
069400             WHEN SQLCODE = ZERO                                  06940034
069500             WHEN SQLCODE = +100                                  06950034
069600             WHEN SQLCODE = -904                                  06960034
069700             WHEN SQLCODE = -913                                  06970034
069800                 CONTINUE                                         06980034
069900             WHEN SQLWARN0 NOT = SPACES                           06990034
070000             WHEN SQLCODE < ZERO                                  07000034
070100             WHEN SQLCODE > ZERO                                  07010034
070200                 MOVE '3300-SELECT-TENTNME-NAME'                  07020034
070300                                   TO DP013-PARAGRAPH             07030034
070400                 MOVE 'SELECT ENTERPRISE FOR VEND NAME:'          07040034
070500                                   TO DP013-MESSAGE-TEXT (1)      07050034
070600                 MOVE ASC-VEND-ANAME-FULL                         07060034
070700                                   TO DP013-MESSAGE-TEXT (2)      07070034
070800                 MOVE SQLCA        TO DP013-SQLCA                 07080034
070900                 MOVE 'TENTNME'    TO DP013-DB2-TABLE-NAME (1)    07090034
071000                 SET DP013-DB2-ABEND                              07100034
071100                     DP013-XCTL-DISPLAY-RESTART TO TRUE           07110034
071200                 PERFORM DP013-0000-PROCESS-ABEND                 07120034
071300         END-EVALUATE                                             07130034
071400     END-PERFORM.                                                 07140034
071500                                                                  07150035
071600     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        07160034
071700         MOVE '3300-SELECT-TENTNME-NAME'                          07170034
071800                                   TO DP013-PARAGRAPH             07180034
071900         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     07190034
072000                                   TO DP013-MESSAGE-TEXT (1)      07200034
072100         MOVE 'ENTERPRISE FOR VEND-NAME'                          07210034
072200                                   TO DP013-MESSAGE-TEXT (2)      07220034
072300         MOVE ASC-VEND-ANAME-FULL  TO DP013-MESSAGE-TEXT (3)      07230034
072400         MOVE SQLCA                TO DP013-SQLCA                 07240034
072500         MOVE 'TENTNME'            TO DP013-DB2-TABLE-NAME (1)    07250038
072600         SET DP013-DB2-ABEND                                      07260034
072700             DP013-XCTL-DISPLAY-RESTART                           07270034
072800                                   TO TRUE                        07280034
072900         PERFORM DP013-0000-PROCESS-ABEND                         07290034
073000     END-IF.                                                      07300034
073100                                                                  07310034
073200*----------------------------------------------------------------*07320034
073300*  CHECK FOR IF TYPE CODE FOR LONG NAME EXISTS ON TENTNME FOR THE 07330034
073400*  VENDOR BEING PROCESSED.                                        07340034
073500*----------------------------------------------------------------*07350034
073600 3310-CHECK-LONGNAME-EXISTENCE.                                   07360034
073700     PERFORM                                                      07370034
073800         WITH TEST AFTER                                          07380034
073900         VARYING PV-RETRY-COUNTER                                 07390034
074000         FROM 1 BY 1                                              07400034
074100         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               07410034
074200                   OR (SQLCODE = ZERO)                            07420034
074300                   OR (SQLCODE = +100)                            07430034
074400                   OR (SQLCODE = -811))                           07440034
074500                                                                  07450034
074600         EXEC SQL                                                 07460034
074700           SELECT '1'                                             07470034
074800            INTO  :PV-ONE                                         07480034
074900             FROM SYSIBM.SYSDUMMY1 X                              07490034
075000            WHERE EXISTS (SELECT 1                                07500034
075100                            FROM TENTNME                          07510034
075200                           WHERE ENT_ID = :ASC-ENT-ID             07520034
075300                             AND TYPE_CDE = '05'                  07530034
075400                             AND X.IBMREQD = X.IBMREQD)           07540034
075500         END-EXEC                                                 07550034
075600                                                                  07560034
075700         EVALUATE TRUE                                            07570034
075800             WHEN SQLCODE = ZERO                                  07580034
075900             WHEN SQLCODE = -811                                  07590034
076000                 SET ASC-LONGNAME-FOUND TO TRUE                   07600034
076100             WHEN SQLCODE = +100                                  07610034
076200                 SET ASC-LONGNAME-NOT-FOUND TO TRUE               07620034
076300             WHEN SQLCODE = -904                                  07630034
076400             WHEN SQLCODE = -913                                  07640034
076500                 CONTINUE                                         07650034
076600             WHEN SQLWARN0 NOT = SPACES                           07660034
076700             WHEN SQLCODE < ZERO                                  07670034
076800             WHEN SQLCODE > ZERO                                  07680034
076900                 MOVE '3310-CHECK-LONGNAME-EXISTENCE'             07690034
077000                                   TO DP013-PARAGRAPH             07700034
077100                 MOVE 'CHECK IF LONG NAME ALREADY EXISTS'         07710034
077200                                   TO DP013-MESSAGE-TEXT (1)      07720034
077300                 MOVE SPACE        TO DP013-MESSAGE-TEXT (2)      07730034
077400                 MOVE SQLCA        TO DP013-SQLCA                 07740034
077500                 MOVE 'TENTNME'    TO DP013-DB2-TABLE-NAME (1)    07750034
077600                 SET DP013-DB2-ABEND                              07760034
077700                     DP013-XCTL-DISPLAY-RESTART TO TRUE           07770034
077800                 PERFORM DP013-0000-PROCESS-ABEND                 07780034
077900         END-EVALUATE                                             07790034
078000     END-PERFORM.                                                 07800034
078100                                                                  07810034
078200     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        07820034
078300         MOVE '3310-CHECK-LONGNAME-EXISTENCE'                     07830034
078400                                   TO DP013-PARAGRAPH             07840034
078500         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO CHECK '     07850034
078600                                   TO DP013-MESSAGE-TEXT (1)      07860034
078700         MOVE 'FOR LONG NAME EXISTENCE '                          07870034
078800                                   TO DP013-MESSAGE-TEXT (2)      07880034
078900         MOVE SPACE                TO DP013-MESSAGE-TEXT (3)      07890034
079000         MOVE SQLCA                TO DP013-SQLCA                 07900034
079100         MOVE 'TENTNME'            TO DP013-DB2-TABLE-NAME (1)    07910034
079200         SET DP013-DB2-ABEND                                      07920034
079300             DP013-XCTL-DISPLAY-RESTART                           07930034
079400                                   TO TRUE                        07940034
079500         PERFORM DP013-0000-PROCESS-ABEND                         07950034
079600     END-IF.                                                      07960034
079700                                                                  07970034
079800*----------------------------------------------------------------*07980035
079900*  CHECK THE NAME FOR ANY CHARACTERS BEYOND THE 30TH CHARACTER.   07990035
080000*----------------------------------------------------------------*08000035
080100 3330-CHECK-NAME.                                                 08010035
080200     IF ASC-VEND-ANAME-FULL NOT = SPACES                          08020035
080300        MOVE ASC-VEND-ANAME-FULL TO PV-NAME                       08030035
080400        SET ASC-NAME-NOT-TOO-LARGE TO TRUE                        08040035
080500*       SET PV-NAME-IDX TO 1                                      08050035
080600        PERFORM VARYING PV-NAME-IDX FROM 31 BY 1                  08060035
080700          UNTIL PV-NAME-IDX > 250                                 08070035
080800             OR ASC-NAME-TOO-LARGE                                08080035
080900          IF PV-NAME-1X(PV-NAME-IDX) NOT = ' '                    08090035
081000             SET ASC-NAME-TOO-LARGE TO TRUE                       08100035
081100*         ELSE                                                    08110037
081200*            SET PV-NAME-IDX UP BY 1                              08120037
081300          END-IF                                                  08130035
081400        END-PERFORM                                               08140035
081500     END-IF.                                                      08150035
081600                                                                  08160035
081700*----------------------------------------------------------------*08170035
081800*    VALIDATE THE QUEUE WAS PASSED AND DISPLAY FOR THE FIRST     *08180035
081900*    ENTRY.                                                      *08190035
082000*----------------------------------------------------------------*08200035
082100                                                                  08210035
082200 4000-BUILD-INITIAL-PANEL.                                        08220035
082300     PERFORM 4050-GET-VENDOR-PRIM-NAME.                           08230035
082400     SET DP030-SET-CURSOR-APPL-1   TO TRUE                        08240035
082500*    MOVE -1                       TO AVNANMEL.                   08250035
082600     MOVE -1                       TO AVNNMTPL.                   08260035
082700     EVALUATE DP020-INT-APPL-FORMAT-IND                           08270035
082800         WHEN PC-INTER-APPL-ADD                                   08280035
082900         WHEN PC-INTER-APPL-ADD-L                                 08290035
083000             MOVE SPACES TO ASC-VEND-ANAME-FULL                   08300035
083100                            ASC-TYPE-CODE                         08310035
083200             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 08320035
083300         WHEN PC-INTER-APPL-UPDATE                                08330035
083400         WHEN PC-INTER-APPL-DELETE                                08340035
083500             PERFORM 4100-GET-VENDOR-NAME                         08350035
083600             IF SQLCODE = +100                                    08360035
083700                SET DP020-NEXT-ACT-APPL-ERROR TO TRUE             08370050
083800                MOVE PC-TSYMSG-00148 TO DP020-MSG-NUMBER          08380050
083900                SET DP020-MSG-INFORMATIONAL TO TRUE               08390050
084000             ELSE                                                 08400035
084100                MOVE ENTNME-ENT-NAME-DESC                         08410050
084200                            TO ASC-VEND-ANAME-FULL                08420050
084300                MOVE ENTNME-TYPE-CDE                              08430050
084400                            TO ASC-TYPE-CODE                      08440050
084500                SET ASC-DEL-PENDING TO TRUE                       08450050
084600                IF ASC-STOP-DELETE AND                            08460052
084700                  (DP020-INT-APPL-FORMAT-IND =                    08470052
084800                        PC-INTER-APPL-DELETE)                     08480052
084900*     --- DELETE OF LONG NAME IS NOT ALLOWED; YOU MUST UPDATE IT  08490051
085000                   MOVE PC-TSYMSG-03623 TO DP020-MSG-NUMBER       08500051
085100                   SET DP020-MSG-FATAL TO TRUE                    08510050
085200                   SET DP020-NEXT-ACT-APPL-ERROR TO TRUE          08520050
085300                   SET PS-ERROR TO TRUE                           08530050
085400                END-IF                                            08540050
085500             END-IF                                               08550050
085600             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 08560050
085700         END-EVALUATE.                                            08570050
085800                                                                  08580050
085900*----------------------------------------------------------------*08590050
086000* SELECT A ROW FROM THE DB2 SYSTEM VENDOR NAME TABLE.            *08600050
086100*----------------------------------------------------------------*08610050
086200 4050-GET-VENDOR-PRIM-NAME.                                       08620050
086300     PERFORM                                                      08630050
086400         WITH TEST AFTER                                          08640050
086500         VARYING PV-RETRY-COUNTER                                 08650050
086600         FROM 1 BY 1                                              08660050
086700         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               08670050
086800                   OR (SQLCODE = ZERO))                           08680050
086900*                                                                 08690050
087000         EXEC SQL                                                 08700050
087100             SELECT ENT_NAME_DESC                                 08710050
087200             INTO   :ASC-PRIM-VEND-NAME                           08720050
087300             FROM   TENTNME                                       08730050
087400             WHERE  ENT_ID   = :ASC-ENT-ID                        08740050
087500               AND  TYPE_CDE = '01'                               08750050
087600         END-EXEC                                                 08760050
087700                                                                  08770050
087800         EVALUATE TRUE                                            08780050
087900             WHEN SQLCODE = ZERO                                  08790050
088000             WHEN SQLCODE = -904                                  08800050
088100             WHEN SQLCODE = -913                                  08810050
088200                 CONTINUE                                         08820050
088300             WHEN SQLWARN0 NOT = SPACES                           08830050
088400             WHEN SQLCODE < ZERO                                  08840050
088500             WHEN SQLCODE > ZERO                                  08850050
088600                 MOVE '4050-GET-VENDOR-PRIM-NAME'                 08860050
088700                                   TO DP013-PARAGRAPH             08870050
088800                 MOVE 'SELECT VENDOR NAME'                        08880050
088900                                   TO DP013-MESSAGE-TEXT (1)      08890050
089000                 MOVE SQLCA        TO DP013-SQLCA                 08900050
089100                 MOVE 'TENTNME'    TO DP013-DB2-TABLE-NAME (1)    08910050
089200                 SET DP013-DB2-ABEND                              08920050
089300                     DP013-XCTL-DISPLAY-RESTART                   08930050
089400                                   TO TRUE                        08940050
089500                 PERFORM DP013-0000-PROCESS-ABEND                 08950050
089600         END-EVALUATE                                             08960050
089700     END-PERFORM.                                                 08970050
089800*                                                                 08980050
089900     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        08990050
090000         MOVE '4050-GET-VENDOR-PRIM-NAME'                         09000050
090100                                   TO DP013-PARAGRAPH             09010050
090200         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     09020050
090300                                   TO DP013-MESSAGE-TEXT (1)      09030050
090400         MOVE 'VENDOR NAME  '      TO DP013-MESSAGE-TEXT (2)      09040050
090500         MOVE SQLCA                TO DP013-SQLCA                 09050050
090600         MOVE 'TENTNME'            TO DP013-DB2-TABLE-NAME (1)    09060050
090700         SET DP013-DB2-ABEND                                      09070050
090800             DP013-XCTL-DISPLAY-RESTART                           09080050
090900                                   TO TRUE                        09090050
091000         PERFORM DP013-0000-PROCESS-ABEND                         09100050
091100     END-IF.                                                      09110050
091200                                                                  09120050
091300*----------------------------------------------------------------*09130050
091400* SELECT A ROW FROM THE DB2 SYSTEM VENDOR NAME TABLE.            *09140050
091500*----------------------------------------------------------------*09150050
091600 4100-GET-VENDOR-NAME.                                            09160050
091700     PERFORM                                                      09170050
091800         WITH TEST AFTER                                          09180050
091900         VARYING PV-RETRY-COUNTER                                 09190050
092000         FROM 1 BY 1                                              09200050
092100         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               09210050
092200                   OR (SQLCODE = ZERO)                            09220050
092300                   OR (SQLCODE = +100))                           09230050
092400*                                                                 09240050
092500         EXEC SQL                                                 09250050
092600             SELECT ENT_NAME_DESC                                 09260050
092700                  , TYPE_CDE                                      09270050
092800             INTO  :ENTNME-ENT-NAME-DESC                          09280050
092900                 , :ENTNME-TYPE-CDE                               09290050
093000             FROM   TENTNME                                       09300050
093100             WHERE  ENT_ID   = :ASC-ENT-ID                        09310050
093200               AND  SEQ_NBR  = :ASC-SEQ-NBR                       09320050
093300         END-EXEC                                                 09330050
093400                                                                  09340050
093500         EVALUATE TRUE                                            09350050
093600             WHEN SQLCODE = ZERO                                  09360050
093700                 IF ENTNME-TYPE-CDE = '05'                        09370050
093800                    PERFORM 4150-SELECT-PRTNR-TYP-CDE             09380050
093900                 END-IF                                           09390050
094000             WHEN SQLCODE = +100                                  09400050
094100             WHEN SQLCODE = -904                                  09410050
094200             WHEN SQLCODE = -913                                  09420050
094300                 CONTINUE                                         09430050
094400             WHEN SQLWARN0 NOT = SPACES                           09440050
094500             WHEN SQLCODE < ZERO                                  09450050
094600             WHEN SQLCODE > ZERO                                  09460050
094700                 MOVE '4100-GET-VENDOR-NAME'                      09470050
094800                                   TO DP013-PARAGRAPH             09480050
094900                 MOVE 'SELECT VENDOR NAME'                        09490050
095000                                   TO DP013-MESSAGE-TEXT (1)      09500050
095100                 MOVE SQLCA        TO DP013-SQLCA                 09510050
095200                 MOVE 'TENTNME'    TO DP013-DB2-TABLE-NAME (1)    09520050
095300                 SET DP013-DB2-ABEND                              09530050
095400                     DP013-XCTL-DISPLAY-RESTART                   09540050
095500                                   TO TRUE                        09550050
095600                 PERFORM DP013-0000-PROCESS-ABEND                 09560050
095700         END-EVALUATE                                             09570050
095800     END-PERFORM.                                                 09580050
095900*                                                                 09590050
096000     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        09600050
096100         MOVE '4100-GET-VENDOR-NAME'                              09610050
096200                                   TO DP013-PARAGRAPH             09620050
096300         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     09630050
096400                                   TO DP013-MESSAGE-TEXT (1)      09640050
096500         MOVE 'VENDOR NAME  '      TO DP013-MESSAGE-TEXT (2)      09650050
096600         MOVE SQLCA                TO DP013-SQLCA                 09660050
096700         MOVE 'TENTNME'            TO DP013-DB2-TABLE-NAME (1)    09670050
096800         SET DP013-DB2-ABEND                                      09680050
096900             DP013-XCTL-DISPLAY-RESTART                           09690050
097000                                   TO TRUE                        09700050
097100         PERFORM DP013-0000-PROCESS-ABEND                         09710050
097200     END-IF.                                                      09720050
097300                                                                  09730050
097400*----------------------------------------------------------------*09740050
097500* SELECT PRTNR_TYP_CDE TO DETERMINE IF A DELETE WILL BE ALLOWED  *09750050
097600*----------------------------------------------------------------*09760050
097700 4150-SELECT-PRTNR-TYP-CDE.                                       09770050
097800     PERFORM                                                      09780050
097900         WITH TEST AFTER                                          09790050
098000         VARYING PV-RETRY-COUNTER                                 09800050
098100         FROM 1 BY 1                                              09810050
098200         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               09820050
098300                   OR (SQLCODE = ZERO)                            09830050
098400                   OR (SQLCODE = +100))                           09840050
098500*                                                                 09850050
098600         EXEC SQL                                                 09860050
098700             SELECT PRTNR_TYP_CDE                                 09870050
098800             INTO  :EXTENT-PRTNR-TYP-CDE                          09880050
098900             FROM   TEXTENT                                       09890050
099000             WHERE  ENT_ID   = :ASC-ENT-ID                        09900050
099100         END-EXEC                                                 09910050
099200                                                                  09920050
099300         EVALUATE TRUE                                            09930050
099400             WHEN SQLCODE = ZERO                                  09940050
099500                 IF EXTENT-PRTNR-TYP-CDE = 'S2' OR 'FA'           09950050
099600                    SET ASC-STOP-DELETE TO TRUE                   09960050
099700                 ELSE                                             09970050
099800                    SET ASC-ALLOW-DELETE TO TRUE                  09980050
099900                 END-IF                                           09990050
100000             WHEN SQLCODE = +100                                  10000050
100100             WHEN SQLCODE = -904                                  10010050
100200             WHEN SQLCODE = -913                                  10020050
100300                 CONTINUE                                         10030050
100400             WHEN SQLWARN0 NOT = SPACES                           10040050
100500             WHEN SQLCODE < ZERO                                  10050050
100600             WHEN SQLCODE > ZERO                                  10060050
100700                 MOVE '4150-SELECT-PRTNR-TYP-CDE'                 10070050
100800                                   TO DP013-PARAGRAPH             10080050
100900                 MOVE 'SELECT PRTNR-TYP-CDE'                      10090050
101000                                   TO DP013-MESSAGE-TEXT (1)      10100050
101100                 MOVE SQLCA        TO DP013-SQLCA                 10110050
101200                 MOVE 'TEXTENT'    TO DP013-DB2-TABLE-NAME (1)    10120050
101300                 SET DP013-DB2-ABEND                              10130050
101400                     DP013-XCTL-DISPLAY-RESTART                   10140050
101500                                   TO TRUE                        10150050
101600                 PERFORM DP013-0000-PROCESS-ABEND                 10160050
101700         END-EVALUATE                                             10170050
101800     END-PERFORM.                                                 10180050
101900*                                                                 10190050
102000     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        10200050
102100         MOVE '4150-SELECT-PRTNR-TYP-CDE'                         10210050
102200                                   TO DP013-PARAGRAPH             10220050
102300         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     10230050
102400                                   TO DP013-MESSAGE-TEXT (1)      10240050
102500         MOVE 'PRTNR-TYP-CDE'      TO DP013-MESSAGE-TEXT (2)      10250050
102600         MOVE SQLCA                TO DP013-SQLCA                 10260050
102700         MOVE 'TEXTENT'            TO DP013-DB2-TABLE-NAME (1)    10270050
102800         SET DP013-DB2-ABEND                                      10280050
102900             DP013-XCTL-DISPLAY-RESTART                           10290050
103000                                   TO TRUE                        10300050
103100         PERFORM DP013-0000-PROCESS-ABEND                         10310050
103200     END-IF.                                                      10320050
103300                                                                  10330050
103400*----------------------------------------------------------------*10340050
103500*    RESTORE THE DATA ON THE SCREEN FROM THE COMM AREA.          *10350050
103600*----------------------------------------------------------------*10360050
103700                                                                  10370050
103800 4400-MOVE-COMMAREA-TO-SCREEN.                                    10380050
103900     MOVE ASC-PRIM-VEND-NAME       TO AVNNAMEO.                   10390050
104000     MOVE ASC-VEND-ANAME-FULL      TO AVNANMEO.                   10400050
104100     MOVE ASC-TYPE-CODE            TO AVNNMTPO.                   10410050
104200                                                                  10420050
104300                                                                  10430050
104400*----------------------------------------------------------------*10440050
104500* ADD THE INPUT TO THE DB2 TABLE.                                *10450050
104600*----------------------------------------------------------------*10460050
104700 5000-ADD-VENDOR-NAME.                                            10470050
104800     PERFORM 5100-GET-MAX-SEQ-NBR.                                10480050
104900     MOVE ASC-ENT-ID               TO ENTNME-ENT-ID.              10490050
105000     MOVE ASC-VEND-ANAME-FULL      TO ENTNME-ENT-NAME-DESC.       10500050
105100     MOVE ASC-TYPE-CODE            TO ENTNME-TYPE-CDE.            10510050
105200                                                                  10520050
105300     PERFORM 6300-GET-VENDOR-INFO.                                10530050
105400**   IF (EXTENT-PRIM-TYP-CDE   = 'E') AND                         10540056
105500**      (EXTENT-PRTNR-IND      = 'Y') AND                         10550056
105600**      (EXTENT-VND-IN-RMS-IND = 'Y') AND                         10560056
105700**      (ASC-TYPE-CODE = '05')                                    10570056
105800     IF (EXTENT-PRIM-TYP-CDE   = 'E') AND                         10580056
105900        (EXTENT-PRTNR-IND      = 'Y') AND                         10590056
106000        (ASC-TYPE-CODE = '05')                                    10600056
106100        IF (EXTENT-VND-IN-RMS-IND = 'Y')                          10610056
106200           INITIALIZE VN007-COMMAREA                              10620056
106300           MOVE EXTENT-DUN-NBR        TO VN007-VND-NBR            10630056
106400           MOVE ASC-ENT-ID            TO VN007-ENT-ID             10640056
106500           MOVE ASC-VEND-ANAME-FULL   TO VN007-LONGNAME           10650056
106600           MOVE EXTENT-PRIM-TYP-CDE   TO VN007-PRIM-TYP-CDE       10660056
106700           MOVE 'N'                   TO VN007-LONGNAME-DELETE-IND10670056
106800           PERFORM 8300-LINK-TO-VNKCS024                          10680056
106900        ELSE                                                      10690056
107000           INITIALIZE VN007-COMMAREA                              10700056
107100           MOVE EXTENT-DUN-NBR       TO VN007-VND-NBR             10710056
107200           MOVE EXTENT-PRIM-TYP-CDE  TO VN007-PRIM-TYP-CDE        10720056
107300           MOVE EXTENT-PRTNR-TYP-CDE TO VN007-PRTNR-TYP-CDE       10730056
107400           MOVE 'Y'                  TO VN007-VND-IN-RMS-IND      10740056
107500                                        EXTENT-VND-IN-RMS-IND     10750056
107600           MOVE EXTENT-STATUS-CDE    TO VN007-STATUS-CDE          10760056
107700           MOVE ASC-PRIM-VEND-NAME   TO VN007-ENT-NAME-DESC       10770056
107800           MOVE EXTENT-SCAC-CDE      TO VN007-SCAC-CDE            10780056
107900           MOVE 'N'                  TO VN007-PRTNR-DELETE-IND    10790056
108000           MOVE ASC-ENT-ID           TO VN007-ENT-ID              10800056
108100           MOVE EXTENT-EDI-PO-PREPK-CDE TO VN007-PO-PREPK-CDE     10810056
108200           IF EXTENT-PRTNR-TYP-CDE = 'BK'                         10820057
108300              MOVE EXTENT-LNE-OF-CR-AMT TO VN007-LINE-OF-CR-AMT   10830056
108400           ELSE                                                   10840056
108500              MOVE ZEROES               TO VN007-LINE-OF-CR-AMT   10850056
108600           END-IF                                                 10860056
108700           MOVE ASC-VEND-ANAME-FULL  TO VN007-LONGNAME            10870056
108800           MOVE SPACE                TO VN007-LONGNAME-DELETE-IND 10880060
108900           PERFORM 8300-LINK-TO-VNKCS024                          10890056
109000           PERFORM 5300-UPDATE-VND-IN-RMS-IND                     10900058
109100        END-IF                                                    10910056
109200     END-IF.                                                      10920056
109300                                                                  10930056
109400     PERFORM 5200-ADD-TENTNME.                                    10940056
109500                                                                  10950058
109600*----------------------------------------------------------------*10960056
109700*  GET MAX VEND NAME SEQ NBR PLUS 1 FOR ADD                       10970056
109800*----------------------------------------------------------------*10980056
109900 5100-GET-MAX-SEQ-NBR.                                            10990056
110000     PERFORM                                                      11000056
110100         WITH TEST AFTER                                          11010056
110200         VARYING PV-RETRY-COUNTER                                 11020056
110300         FROM 1 BY 1                                              11030056
110400         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               11040056
110500                   OR (SQLCODE = ZERO))                           11050056
110600*                                                                 11060056
110700         EXEC SQL                                                 11070056
110800             SELECT MAX(SEQ_NBR) + 1                              11080056
110900             INTO :ENTNME-SEQ-NBR                                 11090056
111000             FROM TENTNME                                         11100056
111100             WHERE ENT_ID = :ASC-ENT-ID                           11110056
111200         END-EXEC                                                 11120056
111300                                                                  11130056
111400         EVALUATE TRUE                                            11140056
111500             WHEN SQLCODE = ZERO                                  11150056
111600             WHEN SQLCODE = -904                                  11160056
111700             WHEN SQLCODE = -913                                  11170056
111800                 CONTINUE                                         11180056
111900             WHEN SQLWARN0 NOT = SPACES                           11190056
112000             WHEN SQLCODE < ZERO                                  11200056
112100             WHEN SQLCODE > ZERO                                  11210056
112200                 MOVE '5100-GET-MAX-SEQ-NBR'                      11220056
112300                                   TO DP013-PARAGRAPH             11230056
112400                 MOVE 'SELECT SEQ NBR'                            11240056
112500                                   TO DP013-MESSAGE-TEXT (1)      11250056
112600                 MOVE SQLCA        TO DP013-SQLCA                 11260056
112700                 MOVE 'TENTNME'    TO DP013-DB2-TABLE-NAME (1)    11270056
112800                 SET DP013-DB2-ABEND                              11280056
112900                     DP013-XCTL-DISPLAY-RESTART TO TRUE           11290056
113000                 PERFORM DP013-0000-PROCESS-ABEND                 11300056
113100         END-EVALUATE                                             11310056
113200     END-PERFORM.                                                 11320056
113300*                                                                 11330056
113400     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        11340056
113500         MOVE '5100-GET-MAX-SEQ-NBR'                              11350056
113600                                   TO DP013-PARAGRAPH             11360056
113700         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     11370056
113800                                   TO DP013-MESSAGE-TEXT (1)      11380056
113900         MOVE 'MAX SEQ-NBR'                                       11390056
114000                                   TO DP013-MESSAGE-TEXT (2)      11400056
114100         MOVE SQLCA                TO DP013-SQLCA                 11410056
114200         MOVE 'TENTNME'            TO DP013-DB2-TABLE-NAME (1)    11420056
114300         SET DP013-DB2-ABEND                                      11430056
114400             DP013-XCTL-DISPLAY-RESTART                           11440056
114500                                   TO TRUE                        11450056
114600         PERFORM DP013-0000-PROCESS-ABEND                         11460056
114700     END-IF.                                                      11470056
114800                                                                  11480056
114900*----------------------------------------------------------------*11490056
115000*  GET MAX VEND NAME SEQ NBR PLUS 1 FOR ADD                       11500056
115100*----------------------------------------------------------------*11510056
115200 5200-ADD-TENTNME.                                                11520056
115300     PERFORM                                                      11530056
115400         WITH TEST AFTER                                          11540056
115500         VARYING PV-RETRY-COUNTER                                 11550056
115600         FROM 1 BY 1                                              11560056
115700         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               11570056
115800                   OR (SQLCODE = ZERO))                           11580056
115900         EXEC SQL                                                 11590056
116000             INSERT INTO TENTNME                                  11600056
116100                 (ENT_ID,                                         11610056
116200                  SEQ_NBR,                                        11620056
116300                  ENT_NAME_DESC,                                  11630056
116400                  TYPE_CDE)                                       11640056
116500             VALUES                                               11650056
116600                 (:ENTNME-ENT-ID,                                 11660056
116700                  :ENTNME-SEQ-NBR,                                11670056
116800                  :ENTNME-ENT-NAME-DESC,                          11680056
116900                  :ENTNME-TYPE-CDE)                               11690056
117000         END-EXEC                                                 11700056
117100                                                                  11710056
117200         EVALUATE TRUE                                            11720056
117300             WHEN SQLCODE = ZERO                                  11730056
117400             WHEN SQLCODE = -904                                  11740056
117500             WHEN SQLCODE = -913                                  11750056
117600                 CONTINUE                                         11760056
117700             WHEN SQLWARN0 NOT = SPACES                           11770056
117800             WHEN SQLCODE < ZERO                                  11780056
117900             WHEN SQLCODE > ZERO                                  11790056
118000                 MOVE '5200-ADD-TENTNME'                          11800056
118100                                   TO DP013-PARAGRAPH             11810056
118200                 MOVE 'ADD A ROW TO THE ENTITY NAME TABLE'        11820056
118300                                   TO DP013-MESSAGE-TEXT(1)       11830056
118400                 MOVE SQLCA        TO DP013-SQLCA                 11840056
118500                 MOVE 'TENTNME'    TO DP013-DB2-TABLE-NAME (1)    11850056
118600                 SET DP013-DB2-ABEND                              11860056
118700                     DP013-XCTL-DISPLAY-RESTART TO TRUE           11870056
118800                 PERFORM DP013-0000-PROCESS-ABEND                 11880056
118900         END-EVALUATE                                             11890056
119000     END-PERFORM.                                                 11900056
119100*                                                                 11910056
119200     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        11920056
119300         MOVE '5200-ADD-TENTNME'                                  11930056
119400                                   TO DP013-PARAGRAPH             11940056
119500         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO ADD A NEW VE11950056
119600-             'NDOR NAME'          TO DP013-MESSAGE-TEXT (1)      11960056
119700         MOVE SQLCA                TO DP013-SQLCA                 11970056
119800         MOVE 'TENTNME'            TO DP013-DB2-TABLE-NAME (1)    11980056
119900         SET DP013-DB2-ABEND                                      11990056
120000             DP013-XCTL-DISPLAY-RESTART                           12000056
120100                                   TO TRUE                        12010056
120200         PERFORM DP013-0000-PROCESS-ABEND                         12020056
120300     END-IF.                                                      12030056
120400                                                                  12040056
120500 5300-UPDATE-VND-IN-RMS-IND.                                      12050058
120600     PERFORM                                                      12060058
120700         WITH TEST AFTER                                          12070058
120800         VARYING PV-RETRY-COUNTER                                 12080058
120900         FROM 1 BY 1                                              12090058
121000         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               12100058
121100                   OR (SQLCODE = ZERO))                           12110058
121200         EXEC SQL                                                 12120058
121300             UPDATE TEXTENT                                       12130058
121400                 SET VND_IN_RMS_IND = :EXTENT-VND-IN-RMS-IND      12140058
121500             WHERE ENT_ID   = :ASC-ENT-ID                         12150058
121600         END-EXEC                                                 12160058
121700                                                                  12170058
121800         EVALUATE TRUE                                            12180058
121900             WHEN SQLCODE = ZERO                                  12190058
122000             WHEN SQLCODE = -904                                  12200058
122100             WHEN SQLCODE = -913                                  12210058
122200                 CONTINUE                                         12220058
122300             WHEN SQLWARN0 NOT = SPACES                           12230058
122400             WHEN SQLCODE < ZERO                                  12240058
122500             WHEN SQLCODE > ZERO                                  12250058
122600                 MOVE '5300-UPDATE-VND-IN-RMS-IND'                12260058
122700                                   TO DP013-PARAGRAPH             12270058
122800                 MOVE 'UPDATE VND_IN_RMS_IND ON TEXTENT'          12280058
122900                                   TO DP013-MESSAGE-TEXT(1)       12290058
123000                 MOVE SQLCA        TO DP013-SQLCA                 12300058
123100                 MOVE 'TEXTENT'    TO DP013-DB2-TABLE-NAME (1)    12310058
123200                 SET DP013-DB2-ABEND                              12320058
123300                     DP013-XCTL-DISPLAY-RESTART TO TRUE           12330058
123400                 PERFORM DP013-0000-PROCESS-ABEND                 12340058
123500         END-EVALUATE                                             12350058
123600     END-PERFORM.                                                 12360058
123700*                                                                 12370058
123800     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        12380058
123900         MOVE '5300-UPDATE-VND-IN-RMS-IND'                        12390058
124000                                   TO DP013-PARAGRAPH             12400058
124100         MOVE 'MAX RETRIES EXCEEDED ATTEMPTING TO UPDATE TEXTENT' 12410058
124200                                   TO DP013-MESSAGE-TEXT(1)       12420059
124300         MOVE SQLCA                TO DP013-SQLCA                 12430058
124400         MOVE 'TEXTENT'            TO DP013-DB2-TABLE-NAME (1)    12440058
124500         SET DP013-DB2-ABEND                                      12450058
124600             DP013-XCTL-DISPLAY-RESTART                           12460058
124700                                   TO TRUE                        12470058
124800         PERFORM DP013-0000-PROCESS-ABEND                         12480058
124900     END-IF.                                                      12490058
125000                                                                  12500058
125100*----------------------------------------------------------------*12510056
125200* APPLY THE CHANGES TO THE VENDOR NAME TABLE  TABLE.             *12520056
125300*----------------------------------------------------------------*12530056
125400 6000-UPDATE-VENDOR-NAME.                                         12540056
125500     MOVE ASC-VEND-ANAME-FULL      TO ENTNME-ENT-NAME-DESC.       12550056
125600     MOVE ASC-TYPE-CODE            TO ENTNME-TYPE-CDE.            12560056
125700                                                                  12570056
125800     PERFORM 6300-GET-VENDOR-INFO.                                12580056
125900     IF (EXTENT-PRIM-TYP-CDE   = 'E') AND                         12590056
126000        (EXTENT-PRTNR-IND      = 'Y') AND                         12600056
126100        (EXTENT-VND-IN-RMS-IND = 'Y') AND                         12610056
126200        (ASC-TYPE-CODE = '05')                                    12620056
126300        INITIALIZE VN007-COMMAREA                                 12630056
126400        MOVE EXTENT-DUN-NBR        TO VN007-VND-NBR               12640056
126500        MOVE ASC-ENT-ID            TO VN007-ENT-ID                12650056
126600        MOVE ASC-VEND-ANAME-FULL   TO VN007-LONGNAME              12660056
126700        MOVE EXTENT-PRIM-TYP-CDE   TO VN007-PRIM-TYP-CDE          12670056
126800        MOVE 'N'                   TO VN007-LONGNAME-DELETE-IND   12680056
126900        PERFORM 6400-GET-LONGNAME-BEFORE-UPDT                     12690056
127000        IF ENTNME-ENT-NAME-DESC NOT = PV-OLD-ENT-NAME-DESC        12700056
127100           PERFORM 8300-LINK-TO-VNKCS024                          12710056
127200        END-IF                                                    12720056
127300     END-IF.                                                      12730056
127400                                                                  12740056
127500     PERFORM 6100-UPDATE-TENTNME.                                 12750056
127600     PERFORM 6200-UPDATE-SELECT-QUE-UPD.                          12760056
127700                                                                  12770056
127800 6100-UPDATE-TENTNME.                                             12780056
127900     PERFORM                                                      12790056
128000         WITH TEST AFTER                                          12800056
128100         VARYING PV-RETRY-COUNTER                                 12810056
128200         FROM 1 BY 1                                              12820056
128300         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               12830056
128400                   OR (SQLCODE = ZERO))                           12840056
128500         EXEC SQL                                                 12850056
128600             UPDATE TENTNME                                       12860056
128700                 SET ENT_NAME_DESC   = :ENTNME-ENT-NAME-DESC,     12870056
128800                     TYPE_CDE        = :ENTNME-TYPE-CDE           12880056
128900             WHERE ENT_ID   = :ASC-ENT-ID                         12890056
129000               AND SEQ_NBR  = :ASC-SEQ-NBR                        12900056
129100         END-EXEC                                                 12910056
129200                                                                  12920056
129300         EVALUATE TRUE                                            12930056
129400             WHEN SQLCODE = ZERO                                  12940056
129500             WHEN SQLCODE = -904                                  12950056
129600             WHEN SQLCODE = -913                                  12960056
129700                 CONTINUE                                         12970056
129800             WHEN SQLWARN0 NOT = SPACES                           12980056
129900             WHEN SQLCODE < ZERO                                  12990056
130000             WHEN SQLCODE > ZERO                                  13000056
130100                 MOVE '6100-UPDATE-TENTNME'                       13010056
130200                                   TO DP013-PARAGRAPH             13020056
130300                 MOVE 'UPDATE A ROW ON THE ENTITY NAME TABLE'     13030056
130400                                   TO DP013-MESSAGE-TEXT(1)       13040056
130500                 MOVE SQLCA        TO DP013-SQLCA                 13050056
130600                 MOVE 'TENTNME'    TO DP013-DB2-TABLE-NAME (1)    13060056
130700                 SET DP013-DB2-ABEND                              13070056
130800                     DP013-XCTL-DISPLAY-RESTART TO TRUE           13080056
130900                 PERFORM DP013-0000-PROCESS-ABEND                 13090056
131000         END-EVALUATE                                             13100056
131100     END-PERFORM.                                                 13110056
131200*                                                                 13120056
131300     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        13130056
131400         MOVE '6100-UPDATE-TENTNME'                               13140056
131500                                   TO DP013-PARAGRAPH             13150056
131600         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO UPDATE A VEN13160056
131700-             'DOR NAME'           TO DP013-MESSAGE-TEXT (1)      13170056
131800         MOVE SQLCA                TO DP013-SQLCA                 13180056
131900         MOVE 'TENTNME'            TO DP013-DB2-TABLE-NAME (1)    13190056
132000         SET DP013-DB2-ABEND                                      13200056
132100             DP013-XCTL-DISPLAY-RESTART                           13210056
132200                                   TO TRUE                        13220056
132300         PERFORM DP013-0000-PROCESS-ABEND                         13230056
132400     END-IF.                                                      13240056
132500                                                                  13250056
132600*----------------------------------------------------------------*13260056
132700* RECORD IN THE SELECTION TEMP STORAGE QUEUE THE FACT THAT THIS  *13270056
132800* OBJECT WAS UDPATED.                                            *13280056
132900*----------------------------------------------------------------*13290056
133000 6200-UPDATE-SELECT-QUE-UPD.                                      13300056
133100     PERFORM 9100-READ-SEL-QUEUE.                                 13310056
133200     SET VN003-UPD (ASC-SEL-SUB) TO TRUE.                         13320056
133300     PERFORM 9200-REWRITE-LIST-QUEUE.                             13330056
133400                                                                  13340056
133500*----------------------------------------------------------------*13350056
133600* SELECT THE VENDOR INFO FOR THE ENTID BEING PROCESSED.          *13360056
133700*----------------------------------------------------------------*13370056
133800 6300-GET-VENDOR-INFO.                                            13380056
133900     PERFORM                                                      13390056
134000         WITH TEST AFTER                                          13400056
134100         VARYING PV-RETRY-COUNTER                                 13410056
134200         FROM 1 BY 1                                              13420056
134300         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               13430056
134400                   OR (SQLCODE = ZERO))                           13440056
134500                                                                  13450056
134600         EXEC SQL                                                 13460056
134700             SELECT DUN_NBR                                       13470056
134800                   ,STATUS_CDE                                    13480056
134900                   ,PRIM_TYP_CDE                                  13490056
135000                   ,PRTNR_IND                                     13500056
135100                   ,VND_IN_RMS_IND                                13510056
135200                   ,SCAC_CDE                                      13520056
135300                   ,EDI_PO_PREPK_CDE                              13530056
135400                   ,PRTNR_TYP_CDE                                 13540056
135500                   ,LNE_OF_CR_AMT                                 13550056
135600              INTO  :EXTENT-DUN-NBR                               13560056
135700                   ,:EXTENT-STATUS-CDE                            13570056
135800                   ,:EXTENT-PRIM-TYP-CDE                          13580056
135900                   ,:EXTENT-PRTNR-IND                             13590056
136000                   ,:EXTENT-VND-IN-RMS-IND                        13600056
136100                   ,:EXTENT-SCAC-CDE                              13610056
136200                   ,:EXTENT-EDI-PO-PREPK-CDE                      13620056
136300                   ,:EXTENT-PRTNR-TYP-CDE                         13630056
136400                   ,:EXTENT-LNE-OF-CR-AMT                         13640056
136500              FROM  TEXTENT                                       13650056
136600             WHERE  ENT_ID   = :ASC-ENT-ID                        13660056
136700         END-EXEC                                                 13670056
136800                                                                  13680056
136900         EVALUATE TRUE                                            13690056
137000             WHEN SQLCODE = ZERO                                  13700056
137100             WHEN SQLCODE = -904                                  13710056
137200             WHEN SQLCODE = -913                                  13720056
137300                 CONTINUE                                         13730056
137400             WHEN SQLWARN0 NOT = SPACES                           13740056
137500             WHEN SQLCODE < ZERO                                  13750056
137600             WHEN SQLCODE > ZERO                                  13760056
137700                 MOVE '6300-GET-VENDOR-INFO     '                 13770056
137800                                   TO DP013-PARAGRAPH             13780056
137900                 MOVE 'SELECT VENDOR NUMBER'                      13790056
138000                                   TO DP013-MESSAGE-TEXT (1)      13800056
138100                 MOVE SQLCA        TO DP013-SQLCA                 13810056
138200                 MOVE 'TEXTENT'    TO DP013-DB2-TABLE-NAME (1)    13820056
138300                 SET DP013-DB2-ABEND                              13830056
138400                     DP013-XCTL-DISPLAY-RESTART                   13840056
138500                                   TO TRUE                        13850056
138600                 PERFORM DP013-0000-PROCESS-ABEND                 13860056
138700         END-EVALUATE                                             13870056
138800     END-PERFORM.                                                 13880056
138900*                                                                 13890056
139000     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        13900056
139100         MOVE '6300-GET-VENDOR-INFO     '                         13910056
139200                                   TO DP013-PARAGRAPH             13920056
139300         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     13930056
139400                                   TO DP013-MESSAGE-TEXT (1)      13940056
139500         MOVE 'VENDOR NUMBER'      TO DP013-MESSAGE-TEXT (2)      13950056
139600         MOVE SQLCA                TO DP013-SQLCA                 13960056
139700         MOVE 'TEXTENT'            TO DP013-DB2-TABLE-NAME (1)    13970056
139800         SET DP013-DB2-ABEND                                      13980056
139900             DP013-XCTL-DISPLAY-RESTART                           13990056
140000                                   TO TRUE                        14000056
140100         PERFORM DP013-0000-PROCESS-ABEND                         14010056
140200     END-IF.                                                      14020056
140300                                                                  14030056
140400*----------------------------------------------------------------*14040056
140500* SELECT THE LONG NAME FROM THE DATABASE BEFORE UPDATING IT.     *14050056
140600*----------------------------------------------------------------*14060056
140700 6400-GET-LONGNAME-BEFORE-UPDT.                                   14070056
140800     PERFORM                                                      14080056
140900         WITH TEST AFTER                                          14090056
141000         VARYING PV-RETRY-COUNTER                                 14100056
141100         FROM 1 BY 1                                              14110056
141200         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               14120056
141300                   OR (SQLCODE = ZERO))                           14130056
141400                                                                  14140056
141500         EXEC SQL                                                 14150056
141600             SELECT ENT_NAME_DESC                                 14160056
141700              INTO  :PV-OLD-ENT-NAME-DESC                         14170056
141800              FROM  TENTNME                                       14180056
141900             WHERE  ENT_ID   = :ASC-ENT-ID                        14190056
142000               AND  TYPE_CDE = '05'                               14200056
142100         END-EXEC                                                 14210056
142200                                                                  14220056
142300         EVALUATE TRUE                                            14230056
142400             WHEN SQLCODE = ZERO                                  14240056
142500             WHEN SQLCODE = -904                                  14250056
142600             WHEN SQLCODE = -913                                  14260056
142700                 CONTINUE                                         14270056
142800             WHEN SQLWARN0 NOT = SPACES                           14280056
142900             WHEN SQLCODE < ZERO                                  14290056
143000             WHEN SQLCODE > ZERO                                  14300056
143100                 MOVE '6400-GET-LONGNAME-BEFORE-UPDT'             14310056
143200                                   TO DP013-PARAGRAPH             14320056
143300                 MOVE 'SELECT VENDOR LONGNAME'                    14330056
143400                                   TO DP013-MESSAGE-TEXT (1)      14340056
143500                 MOVE SQLCA        TO DP013-SQLCA                 14350056
143600                 MOVE 'TENTNME'    TO DP013-DB2-TABLE-NAME (1)    14360056
143700                 SET DP013-DB2-ABEND                              14370056
143800                     DP013-XCTL-DISPLAY-RESTART                   14380056
143900                                   TO TRUE                        14390056
144000                 PERFORM DP013-0000-PROCESS-ABEND                 14400056
144100         END-EVALUATE                                             14410056
144200     END-PERFORM.                                                 14420056
144300*                                                                 14430056
144400     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        14440056
144500         MOVE '6400-GET-LONGNAME-BEFORE-UPDT'                     14450056
144600                                   TO DP013-PARAGRAPH             14460056
144700         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     14470056
144800                                   TO DP013-MESSAGE-TEXT (1)      14480056
144900         MOVE 'VENDOR LONGNAME'    TO DP013-MESSAGE-TEXT (2)      14490056
145000         MOVE SQLCA                TO DP013-SQLCA                 14500056
145100         MOVE 'TENTNME'            TO DP013-DB2-TABLE-NAME (1)    14510056
145200         SET DP013-DB2-ABEND                                      14520056
145300             DP013-XCTL-DISPLAY-RESTART                           14530056
145400                                   TO TRUE                        14540056
145500         PERFORM DP013-0000-PROCESS-ABEND                         14550056
145600     END-IF.                                                      14560056
145700                                                                  14570056
145800*----------------------------------------------------------------*14580056
145900* APPLY THE CHANGES TO THE VENDOR NAME TABLE  TABLE.             *14590056
146000*----------------------------------------------------------------*14600056
146100 7000-DELETE-VENDOR-NAME.                                         14610056
146200     PERFORM 6300-GET-VENDOR-INFO.                                14620056
146300     IF (EXTENT-PRIM-TYP-CDE   = 'E') AND                         14630056
146400        (EXTENT-PRTNR-IND      = 'Y') AND                         14640056
146500        (EXTENT-VND-IN-RMS-IND = 'Y') AND                         14650056
146600        (ASC-TYPE-CODE = '05')                                    14660056
146700        INITIALIZE VN007-COMMAREA                                 14670056
146800        MOVE EXTENT-DUN-NBR        TO VN007-VND-NBR               14680056
146900        MOVE ASC-ENT-ID            TO VN007-ENT-ID                14690056
147000        MOVE ASC-VEND-ANAME-FULL   TO VN007-LONGNAME              14700056
147100        MOVE EXTENT-PRIM-TYP-CDE   TO VN007-PRIM-TYP-CDE          14710056
147200        MOVE 'Y'                   TO VN007-LONGNAME-DELETE-IND   14720056
147300        PERFORM 8300-LINK-TO-VNKCS024                             14730056
147400     END-IF.                                                      14740056
147500                                                                  14750056
147600     PERFORM 7100-DELETE-TENTNME.                                 14760056
147700     PERFORM 7200-UPDATE-SELECT-QUE-DEL.                          14770056
147800                                                                  14780056
147900 7100-DELETE-TENTNME.                                             14790056
148000     PERFORM                                                      14800056
148100         WITH TEST AFTER                                          14810056
148200         VARYING PV-RETRY-COUNTER                                 14820056
148300         FROM 1 BY 1                                              14830056
148400         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               14840056
148500                   OR (SQLCODE = ZERO)                            14850056
148600                   OR (SQLCODE = +100))                           14860056
148700         EXEC SQL                                                 14870056
148800             DELETE FROM TENTNME                                  14880056
148900             WHERE ENT_ID   = :ASC-ENT-ID                         14890056
149000               AND SEQ_NBR  = :ASC-SEQ-NBR                        14900056
149100         END-EXEC                                                 14910056
149200                                                                  14920056
149300         EVALUATE TRUE                                            14930056
149400             WHEN SQLCODE = ZERO                                  14940056
149500             WHEN SQLCODE = +100                                  14950056
149600             WHEN SQLCODE = -904                                  14960056
149700             WHEN SQLCODE = -913                                  14970056
149800                 CONTINUE                                         14980056
149900             WHEN SQLWARN0 NOT = SPACES                           14990056
150000             WHEN SQLCODE < ZERO                                  15000056
150100             WHEN SQLCODE > ZERO                                  15010056
150200                 MOVE '7100-DELETE-TENTNME'                       15020056
150300                                   TO DP013-PARAGRAPH             15030056
150400                 MOVE 'DELETE A ROW ON THE ENTITY NAME TABLE'     15040056
150500                                   TO DP013-MESSAGE-TEXT(1)       15050056
150600                 MOVE SQLCA        TO DP013-SQLCA                 15060056
150700                 MOVE 'TENTNME'    TO DP013-DB2-TABLE-NAME (1)    15070056
150800                 SET DP013-DB2-ABEND                              15080056
150900                     DP013-XCTL-DISPLAY-RESTART TO TRUE           15090056
151000                 PERFORM DP013-0000-PROCESS-ABEND                 15100056
151100         END-EVALUATE                                             15110056
151200     END-PERFORM.                                                 15120056
151300*                                                                 15130056
151400     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        15140056
151500         MOVE '7100-UPDATE-TENTNME'                               15150056
151600                                   TO DP013-PARAGRAPH             15160056
151700         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO DELETE A VEN15170056
151800-             'DOR NAME'           TO DP013-MESSAGE-TEXT (1)      15180056
151900         MOVE SQLCA                TO DP013-SQLCA                 15190056
152000         MOVE 'TENTNME'            TO DP013-DB2-TABLE-NAME (1)    15200056
152100         SET DP013-DB2-ABEND                                      15210056
152200             DP013-XCTL-DISPLAY-RESTART                           15220056
152300                                   TO TRUE                        15230056
152400         PERFORM DP013-0000-PROCESS-ABEND                         15240056
152500     END-IF.                                                      15250056
152600                                                                  15260056
152700*----------------------------------------------------------------*15270056
152800* RECORD IN THE SELECTION TEMP STORAGE QUEUE THE FACT THAT THIS  *15280056
152900* OBJECT WAS UDPATED.                                            *15290056
153000*----------------------------------------------------------------*15300056
153100 7200-UPDATE-SELECT-QUE-DEL.                                      15310056
153200     PERFORM 9100-READ-SEL-QUEUE.                                 15320056
153300     SET VN003-DEL (ASC-SEL-SUB) TO TRUE.                         15330056
153400     PERFORM 9200-REWRITE-LIST-QUEUE.                             15340056
153500                                                                  15350056
153600*----------------------------------------------------------------*15360056
153700* RECORD IN THE SELECTION TEMP STORAGE QUEUE THE FACT THAT THIS  *15370056
153800* OBJECT WAS UDPATED.                                            *15380056
153900*----------------------------------------------------------------*15390056
154000 8300-LINK-TO-VNKCS024.                                           15400056
154100                                                                  15410056
154200     EXEC CICS LINK PROGRAM (PC-VNKCS024)                         15420056
154300                   COMMAREA (VN007-COMMAREA)                      15430056
154400                       RESP (PV-CICS-RESPONSE)                    15440056
154500     END-EXEC.                                                    15450056
154600                                                                  15460056
154700     IF  PV-CICS-RESPONSE EQUAL DFHRESP(NORMAL)                   15470056
154800         CONTINUE                                                 15480056
154900     ELSE                                                         15490056
155000        MOVE VN007-PROGRAM-NAME   TO DP013-PROGRAM                15500056
155100        MOVE VN007-PARAGRAPH-NAME TO DP013-PARAGRAPH              15510056
155200        MOVE VN007-MESSAGE        TO DP013-MESSAGE-TEXT (1)       15520056
155300        MOVE VN007-REASON-CODE    TO DP013-SQLCA                  15530056
155400        SET DP013-DB2-ABEND                                       15540056
155500            DP013-ROLLBACK                                        15550056
155600            DP013-XCTL-DISPLAY-RESTART TO TRUE                    15560056
155700        PERFORM DP013-0000-PROCESS-ABEND                          15570056
155800     END-IF.                                                      15580056
155900                                                                  15590056
156000*----------------------------------------------------------------*15600056
156100* READ AN ITEM FROM THE SELECTED ITEMS TEMP STORAGE QUEUE.       *15610056
156200*----------------------------------------------------------------*15620056
156300                                                                  15630056
156400 9100-READ-SEL-QUEUE.                                             15640056
156500     EXEC CICS                                                    15650056
156600         READQ TS                                                 15660056
156700             QUEUE (ASC-SEL-QUEUE-NAME)                           15670056
156800             INTO  (VN003-VENDOR-SEL-REC)                         15680056
156900             ITEM  (ASC-SEL-ITEM)                                 15690056
157000             RESP  (PV-CICS-RESPONSE)                             15700056
157100     END-EXEC.                                                    15710056
157200                                                                  15720056
157300     IF  PV-CICS-RESPONSE EQUAL DFHRESP(NORMAL)                   15730056
157400         CONTINUE                                                 15740056
157500     ELSE                                                         15750056
157600         SET DP013-LOGIC-ABEND                                    15760056
157700             DP013-NO-ROLLBACK     TO TRUE                        15770056
157800         MOVE '9100-READ-SEL-QUEUE'                               15780056
157900                                   TO DP013-PARAGRAPH             15790056
158000         MOVE 'ATTEMPTING TO READ THE LIST SELECTIONS TS QUEUE'   15800056
158100                                   TO DP013-MESSAGE-TEXT (1)      15810056
158200         PERFORM DP013-0000-PROCESS-ABEND                         15820056
158300     END-IF.                                                      15830056
158400*----------------------------------------------------------------*15840056
158500* UPDATE AN ITEM IN THE SELECTED ITEMS TEMP STORAGE QUEUE.       *15850056
158600*----------------------------------------------------------------*15860056
158700 9200-REWRITE-LIST-QUEUE.                                         15870056
158800     EXEC CICS                                                    15880056
158900          WRITEQ TS                                               15890056
159000              QUEUE  (ASC-SEL-QUEUE-NAME)                         15900056
159100              FROM   (VN003-VENDOR-SEL-REC)                       15910056
159200              ITEM   (ASC-SEL-ITEM)                               15920056
159300              RESP   (PV-CICS-RESPONSE)                           15930056
159400              REWRITE                                             15940056
159500     END-EXEC.                                                    15950056
159600                                                                  15960056
159700     IF  PV-CICS-RESPONSE NOT EQUAL DFHRESP(NORMAL)               15970056
159800         SET DP013-CICS-ABEND                                     15980056
159900             DP013-NO-ROLLBACK     TO TRUE                        15990056
160000         MOVE '9200-REWRITE-LIST-QUEUE'                           16000056
160100                                   TO DP013-PARAGRAPH             16010056
160200         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   16020056
160300                                   TO DP013-MESSAGE-TEXT (1)      16030056
160400         PERFORM DP013-0000-PROCESS-ABEND                         16040056
160500     END-IF.                                                      16050056
160600                                                                  16060056
160700                                                                  16070056
160800*----------------------------------------------------------------*16080056
160900*    ABEND PROCESSOR MODULE                                      *16090056
161000*----------------------------------------------------------------*16100056
161100                                                                  16110056
161200     COPY DPPD013.                                                16120056
