000100 IDENTIFICATION DIVISION.                                         00010000
000200 PROGRAM-ID.    CEKCS612.                                         00020000
000300 AUTHOR.        JOE LAROSA.                                       00030000
000400 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00040000
000500 DATE-WRITTEN.  MAY 2000.                                         00050000
000600 DATE-COMPILED.                                                   00060000
000700*----------------------------------------------------------------*00070000
000800*    S612 - CE-INVENTORY CUT OFF SCREEN                           00080000
000900*                                                                 00090000
001000*    THIS PROGRAM ALLOWS THE USER TO ENTER A DATE RANGE TO BE     00100001
001100*    USED TO DETERMINE WHEN 'PULL REQUESTS' WILL BE SUSPENDED     00110001
001200*    BECAUSE OF INVENTORY CUT-OFF.  THE USER CAN PRESS F15 TO     00120001
001300*    UPDATE THE TCOCNTL TABLE WITH THESE DATES.                   00130001
001400*                                                                 00140000
001500*----------------------------------------------------------------*00150000
263455* CHANGED 10/29/2021    BY JIM HUNTER      WR: CHG0263455         00151013
263455* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00152013
263455* MAKING THE CALL DYNAMIC VS STATIC.                              00153013
263455*----------------------------------------------------------------*00154013
CICS  * CHANGED 10/20/2022    BY JIM HUNTER      WR: CHG0276924         00155015
CICS  * ADD COPYBOOK DPWS930 AND MAKE THE CICS ARCHITECTURE CALL        00156014
CICS  * DYNAMIC INSTEAD OF STATIC BY CALLING DP930-CICS-ARCH-API.       00157014
CICS  *-----------------------------------------------------------------00158014
001600 ENVIRONMENT DIVISION.                                            00160000
001700 DATA DIVISION.                                                   00170000
001800                                                                  00180000
001900 WORKING-STORAGE SECTION.                                         00190000
002000 01 PS-PROGRAM-SWITCHES.                                          00200002
002100     05 PS-ERROR-SW               PIC  X(01)  VALUE  'N'.         00210002
002200         88 PS-ERROR                          VALUE  'Y'.         00220002
002300         88 PS-NO-ERROR                       VALUE  'N'.         00230002
002400                                                                  00240001
002500 01 PC-PROGRAM-CONSTANTS.                                         00250002
002600     05 PC-CURRENT-MAP-NAME       PIC  X(08)  VALUE 'CE612A  '.   00260002
002700     05 PC-CURRENT-MAPSET-NAME    PIC  X(08)  VALUE 'CEKM612 '.   00270002
002800     05 PC-CURRENT-PROGRAM-NAME   PIC  X(08)  VALUE 'CEKCS612'.   00280002
002900     05 PC-LIST-QUEUE-SEQ         PIC  9(01)  VALUE 1.            00290002
003000     05 PC-SEL-QUEUE-SEQ          PIC  9(01)  VALUE 2.            00300002
003100                                                                  00310001
003200*----------------------------------------------------------------*00320001
003300*  SYSTEM MESSAGES                                               *00330001
003400*----------------------------------------------------------------*00340001
003500*   00005 = INVALID VALUE                                         00350001
003600*   00007 = REQUIRED ENTRY                                        00360001
003700*   00008 = MUST BE NUMERIC                                       00370001
003800*   00009 = INVALID DATE                                          00380001
003900*   00059 = UPDATE SUCCESSFUL                                     00390002
004000*   02372 = END DATE CAN NOT BE BEFORE START DATE                 00400002
004100*   02477 = START DATE AND END DATE ARE REQUIRED TO PERFORM UPDATE00410003
004200*   02478 = SUSPEND END DATE MUST BE GREATER THAN THE CURRENT DATE00420010
004300*----------------------------------------------------------------*00430001
004400     05 PC-TSYMSG-NUMBERS.                                        00440002
004500         10 PC-TSYMSG-00005       PIC  9(05)  VALUE 00005.        00450002
004600         10 PC-TSYMSG-00007       PIC  9(05)  VALUE 00007.        00460002
004700         10 PC-TSYMSG-00008       PIC  9(05)  VALUE 00008.        00470002
004800         10 PC-TSYMSG-00009       PIC  9(05)  VALUE 00009.        00480002
004900         10 PC-TSYMSG-00059       PIC  9(05)  VALUE 00059.        00490002
005000         10 PC-TSYMSG-02372       PIC  9(05)  VALUE 02372.        00500002
005100         10 PC-TSYMSG-02477       PIC  9(05)  VALUE 02477.        00510003
005200         10 PC-TSYMSG-02478       PIC  9(05)  VALUE 02478.        00520010
005300                                                                  00530000
005400 01 PV-PROGRAM-VARIABLES.                                         00540002
005500* DB2 TIMESTAMP FORMAT = CCYY-MM-DD-HH.MM.SS.999999               00550001
005600     05 PV-DB2-CURRENT-TMST       PIC  X(26).                     00560010
005700     05 FILLER REDEFINES PV-DB2-CURRENT-TMST.                     00570010
005800         10 PV-DB2-CURRENT-DATE   PIC  X(10).                     00580010
005900         10 PV-DB2-CURRENT-TIME   PIC  X(16).                     00590010
006000                                                                  00600010
006100     05 PV-INV-START-TMST         PIC  X(26).                     00610002
006200     05 FILLER REDEFINES PV-INV-START-TMST.                       00620002
006300         10 PV-INV-START-DATE.                                    00630002
006400             15 PV-INV-START-CCYY PIC  9(04).                     00640002
006500             15 FILLER            PIC  X(01).                     00650002
006600             15 PV-INV-START-MM   PIC  9(02).                     00660002
006700             15 FILLER            PIC  X(01).                     00670002
006800             15 PV-INV-START-DD   PIC  9(02).                     00680002
006900         10 PV-INV-START-TIME     PIC  X(16).                     00690002
007000                                                                  00700001
007100     05 PV-INV-STOP-TMST          PIC  X(26).                     00710002
007200     05 FILLER REDEFINES PV-INV-STOP-TMST.                        00720002
007300         10 PV-INV-STOP-DATE.                                     00730002
007400             15 PV-INV-STOP-CCYY  PIC  9(04).                     00740002
007500             15 FILLER            PIC  X(01).                     00750002
007600             15 PV-INV-STOP-MM    PIC  9(02).                     00760002
007700             15 FILLER            PIC  X(01).                     00770002
007800             15 PV-INV-STOP-DD    PIC  9(02).                     00780002
007900         10 PV-INV-STOP-TIME      PIC  X(16).                     00790002
008000                                                                  00800001
008100     05 PV-START-DATE.                                            00810002
008200         10 PV-START-CCYY         PIC  9(04).                     00820002
008300         10 PV-START-MM           PIC  9(02).                     00830002
008400         10 PV-START-DD           PIC  9(02).                     00840002
008500                                                                  00850001
008600     05 PV-END-DATE.                                              00860002
008700         10 PV-END-CCYY           PIC  9(04).                     00870002
008800         10 PV-END-MM             PIC  9(02).                     00880002
008900         10 PV-END-DD             PIC  9(02).                     00890002
009000                                                                  00900001
009100     05 PV-DB2-COMPARE-DATE.                                      00910010
009200         10 PV-COMPARE-CCYY       PIC  9(04).                     00920010
009300         10 FILLER                PIC  X(01)  VALUE '-'.          00930010
009400         10 PV-COMPARE-MM         PIC  9(02).                     00940010
009500         10 FILLER                PIC  X(01)  VALUE '-'.          00950010
009600         10 PV-COMPARE-DD         PIC  9(02).                     00960010
009700                                                                  00970010
009800*----------------------------------------------------------------*00980000
009900*    MAP LAYOUT                                                  *00990000
010000*----------------------------------------------------------------*01000000
010100     COPY CEKM612.                                                01010001
010200                                                                  01020001
010300*----------------------------------------------------------------*01030000
010400*    ATTRIBUTE SETTINGS COPYBOOK.                                *01040000
010500*----------------------------------------------------------------*01050000
010600     COPY DPWS015.                                                01060000
010700                                                                  01070000
010800*----------------------------------------------------------------*01080000
010900*    FUNCTION KEYS COPYBOOK                                      *01090000
011000*----------------------------------------------------------------*01100000
011100     COPY DPWS016.                                                01110000
011200                                                                  01120001
011300*----------------------------------------------------------------*01130001
011400*    CALENDAR ROUTINE                                            *01140001
011500*----------------------------------------------------------------*01150001
011600     COPY DPWS500.                                                01160001
011700                                                                  01170001
011800******************************************************************01180000
011900** THE CALLING PARAMETER LIST (DPWS010) FOR THE NUMERIC EDIT    **01190000
012000** SUB-ROUTINE (DPKUT100).                                      **01200000
012100******************************************************************01210000
012200     COPY DPWS010I.                                               01220000
012300                                                                  01230001
012400******************************************************************01240000
012500** THE CALLING PARAMETER LIST (DPWS030) FOR THE CICS            **01250000
012600** ARCHITECTURE API (BLACK BOX) SUB-ROUTINE.                    **01260000
012700******************************************************************01270000
012800     COPY DPWS030.                                                01280000
CICS       COPY DPWS930.                                                01281014
012900                                                                  01290001
013000***************************************************************** 01300000
013100*    STANDARD COMMAREA.                                           01310000
013200***************************************************************** 01320000
013300     COPY DPWS020.                                                01330000
013400     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                01340000
013500                                                                  01350000
013600***************************************************************** 01360000
013700*    INTER-APPLICATION COMMAREA.                                  01370000
013800***************************************************************** 01380000
013900         10  INTER-APPL-COMM-AREA PIC X(200).                     01390000
014000                                                                  01400001
014100***************************************************************** 01410000
014200*    SPECIFIC COMMMAREA FOR CEKCS612.                             01420001
014300***************************************************************** 01430001
014400         10  ASC-SPECIFIC-COMMAREA.                               01440000
014500             15  ASC-START-MM             PIC X(02)               01450001
014600                                          JUSTIFIED RIGHT.        01460001
014700             15  ASC-START-MM-N REDEFINES ASC-START-MM            01470001
014800                                          PIC 9(02).              01480001
014900             15  ASC-START-DD             PIC X(02)               01490001
015000                                          JUSTIFIED RIGHT.        01500001
015100             15  ASC-START-DD-N REDEFINES ASC-START-DD            01510001
015200                                          PIC 9(02).              01520001
015300             15  ASC-START-CCYY           PIC X(04)               01530001
015400                                          JUSTIFIED RIGHT.        01540001
015500             15  ASC-START-CCYY-N REDEFINES ASC-START-CCYY        01550001
015600                                          PIC 9(04).              01560001
015700             15  ASC-END-MM               PIC X(02)               01570001
015800                                          JUSTIFIED RIGHT.        01580001
015900             15  ASC-END-MM-N REDEFINES ASC-END-MM                01590001
016000                                          PIC 9(02).              01600001
016100             15  ASC-END-DD               PIC X(02)               01610001
016200                                          JUSTIFIED RIGHT.        01620001
016300             15  ASC-END-DD-N REDEFINES ASC-END-DD                01630001
016400                                          PIC 9(02).              01640001
016500             15  ASC-END-CCYY             PIC X(04)               01650001
016600                                          JUSTIFIED RIGHT.        01660001
016700             15  ASC-END-CCYY-N REDEFINES ASC-END-CCYY            01670001
016800                                          PIC 9(04).              01680001
016900                                                                  01690001
017000             15  ASC-DB2-START-MM-N       PIC 9(02).              01700009
017100             15  ASC-DB2-START-DD-N       PIC 9(02).              01710009
017200             15  ASC-DB2-START-CCYY-N     PIC 9(04).              01720009
017300             15  ASC-DB2-END-MM-N         PIC 9(02).              01730009
017400             15  ASC-DB2-END-DD-N         PIC 9(02).              01740009
017500             15  ASC-DB2-END-CCYY-N       PIC 9(04).              01750009
017600                                                                  01760009
017700             15  ASC-START-DATE           PIC X(10).              01770001
017800             15  ASC-END-DATE             PIC X(10).              01780001
017900                                                                  01790001
018000             15  ASC-LIST-QUEUE-NAME.                             01800000
018100                 20  ASC-LIST-TERM-ID     PIC X(04).              01810001
018200                 20  ASC-LIST-TASK-NUMBER PIC S9(5) COMP-3.       01820001
018300                 20  ASC-LIST-SEQ         PIC 9(01).              01830001
018400             15  ASC-SEL-QUEUE-NAME.                              01840000
018500                 20  ASC-SEL-TERM-ID      PIC X(04).              01850001
018600                 20  ASC-SEL-TASK-NUMBER  PIC S9(5) COMP-3.       01860001
018700                 20  ASC-SEL-SEQ          PIC 9(01).              01870001
018800                                                                  01880000
018900*----------------------------------------------------------------*01890000
019000*    ABEND PROCESSING COPYBOOK.                                  *01900000
019100*----------------------------------------------------------------*01910000
019200     COPY DPWS013.                                                01920000
019300                                                                  01930000
019400*----------------------------------------------------------------*01940000
019500*    DB2 AREA FOR THE COMPANY CONTROL TABLE                      *01950001
019600*----------------------------------------------------------------*01960000
019700     EXEC SQL                                                     01970000
019800         INCLUDE TCOCNTL                                          01980001
019900     END-EXEC.                                                    01990000
020000                                                                  02000000
020100*----------------------------------------------------------------*02010001
020200*    DB2 AREA FOR THE KOHLS TO RETEK PROCESSING PARAMETERS TABLE *02020006
020300*----------------------------------------------------------------*02030001
020400     EXEC SQL                                                     02040001
020500         INCLUDE TKRPRPM                                          02050001
020600     END-EXEC.                                                    02060001
020700                                                                  02070001
020800*----------------------------------------------------------------*02080000
020900*    DB2 AREA FOR COMMUNICATIONS                                 *02090000
021000*----------------------------------------------------------------*02100000
021100     EXEC SQL                                                     02110000
021200         INCLUDE SQLCA                                            02120000
021300     END-EXEC.                                                    02130000
021400                                                                  02140001
021500*----------------------------------------------------------------*02150001
021600*----------------------------------------------------------------*02160001
021700 LINKAGE SECTION.                                                 02170000
021800                                                                  02180000
021900 01  DFHCOMMAREA.                                                 02190000
022000     05  FILLER                         OCCURS  1 TO 4072 TIMES   02200000
022100                                        DEPENDING ON EIBCALEN.    02210000
022200         10  FILLER                     PIC X.                    02220000
022300                                                                  02230000
022400 EJECT                                                            02240001
022500***************************************************************** 02250001
022600 PROCEDURE DIVISION.                                              02260000
022700                                                                  02270000
022800***************************************************************** 02280000
022900** THIS MODULE CONTROLS THE OVERALL PROCESSING IN THE PROGRAM. ** 02290000
023000** THE SETUP AND PERFORM OF PARAGRAPH 0001-CALL-CICS-ARCH-API  ** 02300000
023100** MUST BE THE FIRST CODE EXECUTED IN THIS PROGRAM.            ** 02310000
023200**                                                             ** 02320000
023300** THE SECOND OR 'EXIT' PERFORM OF THIS PARAGRAPH MUST BE THE  ** 02330000
023400** LAST CODE EXECUTED ON EACH ITERATION OF THIS PROGRAM.       ** 02340000
023500***************************************************************** 02350000
023600 0000-MAIN-MODULE.                                                02360000
023700                                                                  02370000
023800     INITIALIZE DP030-CICS-API-FIELDS.                            02380000
023900     MOVE +1                     TO DP030-NUMBER-OF-MAPS.         02390000
024000     MOVE PC-CURRENT-MAPSET-NAME TO DP030-MAPSET-NAME.            02400000
024100     MOVE PC-CURRENT-MAP-NAME    TO DP030-MAP-NAME (1).           02410000
024200     SET DP030-RECEIVE-APPL-MAP  TO TRUE.                         02420000
024300     MOVE LENGTH OF CE612AI      TO DP030-MAP-LENGTH (1).         02430001
024400     MOVE 'PROGRAM ENTRY CALL'   TO DP013-MESSAGE-TEXT (1).       02440000
024500                                                                  02450000
024600     PERFORM 0001-CALL-CICS-ARCH-API.                             02460000
024700     PERFORM 1000-CONTROL-PROCESSING                              02470000
024800                                                                  02480000
024900     MOVE 'PROGRAM EXIT CALL'    TO DP013-MESSAGE-TEXT (1).       02490000
025000     PERFORM 0001-CALL-CICS-ARCH-API.                             02500000
025100                                                                  02510000
025200***************************************************************** 02520001
025300 0001-CALL-CICS-ARCH-API.                                         02530000
025400                                                                  02540000
CICS       CALL DP930-CICS-ARCH-API USING DFHEIBLK                      02551014
025600                                    DFHCOMMAREA                   02560014
025700                                    DP030-CICS-API-FIELDS         02570014
025800                                    DP020-STANDARD-COMMAREA       02580014
025900                                    CE612AI.                      02590014
026000                                                                  02600000
026100     IF DP030-RC-CALL-SUCCESSFUL                                  02610001
026200         CONTINUE                                                 02620000
026300     ELSE                                                         02630000
026400         SET DP013-NO-ROLLBACK                                    02640000
026500             DP013-XCTL-DISPLAY-RESTART                           02650000
026600             DP013-CICS-ABEND    TO TRUE                          02660000
026700         MOVE 'BEFORE 0000-MAIN-MODULE'                           02670000
026800                                 TO DP013-PARAGRAPH               02680000
CICS           MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O02681014
CICS  -             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      02682014
027100         MOVE DP030-RETURN-CODE  TO DP013-MESSAGE-TEXT (3)        02710000
027200         PERFORM DP013-0000-PROCESS-ABEND                         02720000
027300     END-IF.                                                      02730000
027400                                                                  02740000
027500*----------------------------------------------------------------*02750000
027600*    PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT   *02760000
027700*    COURSE OF ACTION IS FOR THIS TRANSACTION.                   *02770000
027800*----------------------------------------------------------------*02780000
027900 1000-CONTROL-PROCESSING.                                         02790000
028000                                                                  02800000
028100     EVALUATE TRUE                                                02810000
028200         WHEN DP020-NEXT-ACT-INITIAL                              02820000
028300             INITIALIZE ASC-SPECIFIC-COMMAREA                     02830000
028400             MOVE EIBTRMID          TO ASC-LIST-TERM-ID           02840001
028500                                       ASC-SEL-TERM-ID            02850001
028600             MOVE DP020-SRC-TASK-NUMBER                           02860000
028700                                    TO ASC-LIST-TASK-NUMBER       02870001
028800                                       ASC-SEL-TASK-NUMBER        02880001
028900             MOVE PC-LIST-QUEUE-SEQ TO ASC-LIST-SEQ               02890001
029000             MOVE PC-SEL-QUEUE-SEQ  TO ASC-SEL-SEQ                02900001
029100             PERFORM 4000-BUILD-INITIAL-PANEL                     02910000
029200                                                                  02920000
029300         WHEN DP020-NEXT-ACT-READ-MAP                             02930000
029400             PERFORM 2000-FKEY-PROCESSING                         02940000
029500                                                                  02950000
029600         WHEN DP020-NEXT-ACT-RETURN                               02960000
029700             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 02970000
029800             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   02980000
029900                                                                  02990000
030000         WHEN OTHER                                               03000000
030100             SET DP013-LOGIC-ABEND                                03010000
030200                 DP013-NO-ROLLBACK TO TRUE                        03020001
030300             MOVE '1000-CONTROL-PROCESSING'                       03030000
030400                                   TO DP013-PARAGRAPH             03040001
030500             MOVE 'INVALID NEXT ACTIVITY RETURNED TO APPL PGM:'   03050000
030600                                   TO DP013-MESSAGE-TEXT(1)       03060001
030700             MOVE DP020-NEXT-APPL-ACTIVITY                        03070000
030800                                   TO DP013-MESSAGE-TEXT(2)       03080001
030900             PERFORM DP013-0000-PROCESS-ABEND                     03090000
031000     END-EVALUATE.                                                03100000
031100                                                                  03110000
031200*----------------------------------------------------------------*03120000
031300* FURTHER DETERMINE PROCESSING PATH BASED ON FUNCTION KEY ACTIONS*03130000
031400* SPECIFIC FUNCTION KEYS LISTED HERE ARE ACTED UPON REGARDLESS OF*03140000
031500* EDITS.                                                         *03150000
031600*----------------------------------------------------------------*03160000
031700 2000-FKEY-PROCESSING.                                            03170000
031800                                                                  03180000
031900     EVALUATE TRUE                                                03190000
032000       WHEN DP020-SRC-AID = DP016-CLEAR                           03200001
032100           PERFORM 3000-EDIT-DATA-IN-COMMAREA                     03210001
032200           PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                   03220001
032300                                                                  03230000
032400       WHEN DP020-FK-REFRESH(DP020-SRC-AID)                       03240001
032500           INITIALIZE ASC-SPECIFIC-COMMAREA                       03250001
032600           PERFORM 4000-BUILD-INITIAL-PANEL                       03260001
032700           PERFORM 3100-RESET-ATTRIBUTES                          03270001
032800                                                                  03280000
032900       WHEN OTHER                                                 03290001
033000           PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                   03300001
033100           PERFORM 3000-EDIT-DATA-IN-COMMAREA                     03310001
033200           IF PS-NO-ERROR                                         03320001
033300               SET DP030-CONTINUE-GO TO TRUE                      03330001
033400               PERFORM 2100-CHECK-FUNCTION-KEY                    03340001
033500           ELSE                                                   03350001
033600               SET DP030-OVERRIDE-GO TO TRUE                      03360001
033700           END-IF                                                 03370001
033800     END-EVALUATE.                                                03380000
033900                                                                  03390000
034000******************************************************************03400000
034100** ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED     **03410000
034200** FIRST.  NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED **03420000
034300** FROM THE CICS ARCHITECTURE API.                              **03430000
034400******************************************************************03440000
034500 2100-CHECK-FUNCTION-KEY.                                         03450000
034600                                                                  03460000
034700     EVALUATE TRUE                                                03470000
034800* PF15=UPDATE                                                     03480001
034900         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              03490000
035000             PERFORM 2110-UPDATE-EDITS                            03500010
035100             IF PS-NO-ERROR                                       03510010
035200                 PERFORM 8000-UPDATE-RECORD                       03520007
035300                 MOVE PC-TSYMSG-00059        TO DP020-MSG-NUMBER  03530007
035400                 SET DP020-MSG-INFORMATIONAL TO TRUE              03540007
035500                                                                  03550002
035600                 INITIALIZE ASC-SPECIFIC-COMMAREA                 03560007
035700                 PERFORM 4000-BUILD-INITIAL-PANEL                 03570007
035800                 PERFORM 3100-RESET-ATTRIBUTES                    03580007
035900             END-IF                                               03590010
036000                                                                  03600001
036100         WHEN DP020-SRC-AID = DP016-ENTER                         03610000
036200             CONTINUE                                             03620000
036300                                                                  03630000
036400         WHEN OTHER                                               03640000
036500             SET DP013-NO-ROLLBACK                                03650000
036600                 DP013-XCTL-DISPLAY-RESTART                       03660000
036700                 DP013-CICS-ABEND TO TRUE                         03670001
036800             MOVE '2100-CHECK-FUNCTION-KEY'                       03680000
036900                                  TO DP013-PARAGRAPH              03690001
037000             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      03700000
037100                                  TO DP013-MESSAGE-TEXT (1)       03710001
037200             PERFORM DP013-0000-PROCESS-ABEND                     03720000
037300     END-EVALUATE.                                                03730000
037400                                                                  03740000
037500*----------------------------------------------------------------*03750011
037600 2110-UPDATE-EDITS.                                               03760010
037700                                                                  03770010
037800     IF (ASC-START-CCYY-N NOT > ZEROES)                           03780010
037900       OR (ASC-START-MM-N NOT > ZEROES)                           03790010
038000       OR (ASC-START-DD-N NOT > ZEROES)                           03800010
038100       OR (ASC-END-CCYY-N NOT > ZEROES)                           03810010
038200       OR (ASC-END-MM-N NOT > ZEROES)                             03820010
038300       OR (ASC-END-DD-N NOT > ZEROES)                             03830010
038400         SET PS-ERROR                                             03840010
038500             DP020-MSG-FATAL         TO TRUE                      03850010
038600         MOVE PC-TSYMSG-02477        TO DP020-MSG-NUMBER          03860010
038700         MOVE DP015-UNP-ALP-BRT-OFF  TO ASMMA                     03870010
038800                                        ASDDA                     03880010
038900                                        ASCCYYA                   03890010
039000                                        AEMMA                     03900010
039100                                        AEDDA                     03910010
039200                                        AECCYYA                   03920010
039300         MOVE DP015-RED              TO ASMMC                     03930010
039400                                        ASDDC                     03940010
039500                                        ASCCYYC                   03950010
039600                                        AEMMC                     03960010
039700                                        AEDDC                     03970010
039800                                        AECCYYC                   03980010
039900         MOVE DP015-REVERSE          TO ASMMH                     03990010
040000                                        ASDDH                     04000010
040100                                        ASCCYYH                   04010010
040200                                        AEMMH                     04020010
040300                                        AEDDH                     04030010
040400                                        AECCYYH                   04040010
040500         MOVE -1                     TO ASMML                     04050010
040600         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      04060010
040700     END-IF.                                                      04070010
040800                                                                  04080010
040900*  CHECK IF END DATE ENTERED, MUST BE > CURRENT DATE.             04090010
041000     IF PS-NO-ERROR                                               04100010
041100         MOVE ASC-END-CCYY-N   TO PV-COMPARE-CCYY                 04110010
041200         MOVE ASC-END-MM-N     TO PV-COMPARE-MM                   04120010
041300         MOVE ASC-END-DD-N     TO PV-COMPARE-DD                   04130010
041400                                                                  04140010
041500         EXEC SQL                                                 04150010
041600             SET :PV-DB2-CURRENT-TMST = CURRENT TIMESTAMP         04160010
041700         END-EXEC                                                 04170010
041800                                                                  04180010
041900         IF PV-DB2-CURRENT-DATE >= PV-DB2-COMPARE-DATE            04190010
042000             SET PS-ERROR                                         04200010
042100                 DP020-MSG-FATAL         TO TRUE                  04210010
042200             MOVE PC-TSYMSG-02478        TO DP020-MSG-NUMBER      04220010
042300             MOVE DP015-UNP-ALP-BRT-OFF  TO AEMMA                 04230010
042400                                            AEDDA                 04240010
042500                                            AECCYYA               04250010
042600             MOVE DP015-RED              TO AEMMC                 04260010
042700                                            AEDDC                 04270010
042800                                            AECCYYC               04280010
042900             MOVE DP015-REVERSE          TO AEMMH                 04290010
043000                                            AEDDH                 04300010
043100                                            AECCYYH               04310010
043200             MOVE -1                     TO AEMML                 04320010
043300             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  04330010
043400         END-IF                                                   04340010
043500     END-IF.                                                      04350010
043600                                                                  04360010
043700*----------------------------------------------------------------*04370000
043800* MOVE DATA ENTERED ON THE SCREEN INTO THEIR RESPECTIVE FIELDS IN*04380000
043900* THE APPLICATION-SPECIFIC COMMAREA.  ALL EDITS ARE DONE IN THE  *04390000
044000* APPLICATION-SPECIFIC COMMAREA, NOT ON THE SCREEN.              *04400000
044100*----------------------------------------------------------------*04410001
044200 2200-MOVE-SCREEN-TO-COMMAREA.                                    04420000
044300                                                                  04430000
044400     IF ASMML > ZERO                                              04440001
044500         MOVE ASMMI     TO ASC-START-MM                           04450001
044600     ELSE                                                         04460000
044700         IF ASMMF = DP015-ERASE-EOF                               04470001
044800             MOVE SPACE TO ASC-START-MM                           04480001
044900         END-IF                                                   04490000
045000     END-IF.                                                      04500000
045100                                                                  04510000
045200     IF ASDDL > ZERO                                              04520001
045300         MOVE ASDDI     TO ASC-START-DD                           04530001
045400     ELSE                                                         04540001
045500         IF ASDDF = DP015-ERASE-EOF                               04550001
045600             MOVE SPACE TO ASC-START-DD                           04560001
045700         END-IF                                                   04570001
045800     END-IF.                                                      04580001
045900                                                                  04590001
046000     IF ASCCYYL > ZERO                                            04600001
046100         MOVE ASCCYYI   TO ASC-START-CCYY                         04610001
046200     ELSE                                                         04620000
046300         IF ASCCYYF = DP015-ERASE-EOF                             04630001
046400             MOVE SPACE TO ASC-START-CCYY                         04640001
046500         END-IF                                                   04650000
046600     END-IF.                                                      04660000
046700                                                                  04670000
046800     IF AEMML > ZERO                                              04680001
046900         MOVE AEMMI     TO ASC-END-MM                             04690001
047000     ELSE                                                         04700001
047100         IF AEMMF = DP015-ERASE-EOF                               04710001
047200             MOVE SPACE TO ASC-END-MM                             04720001
047300         END-IF                                                   04730001
047400     END-IF.                                                      04740001
047500                                                                  04750001
047600     IF AEDDL > ZERO                                              04760001
047700         MOVE AEDDI     TO ASC-END-DD                             04770001
047800     ELSE                                                         04780001
047900         IF AEDDF = DP015-ERASE-EOF                               04790001
048000             MOVE SPACE TO ASC-END-DD                             04800001
048100         END-IF                                                   04810001
048200     END-IF.                                                      04820001
048300                                                                  04830001
048400     IF AECCYYL > ZERO                                            04840001
048500         MOVE AECCYYI   TO ASC-END-CCYY                           04850001
048600     ELSE                                                         04860001
048700         IF AECCYYF = DP015-ERASE-EOF                             04870001
048800             MOVE SPACE TO ASC-END-CCYY                           04880001
048900         END-IF                                                   04890001
049000     END-IF.                                                      04900001
049100                                                                  04910000
049200*----------------------------------------------------------------*04920000
049300* ENSURE THE DATA IS CORRECT.  NOTE THAT IN A CRITERIA SPECIFI-  *04930000
049400* CATION SCREEN ONLY MINIMAL EDITS ARE DONE.  EDITS RELATED TO   *04940000
049500* A SPECIFIC SCREEN THAT THE USER IS GOING TO (LOCAL-GO) ARE DONE*04950000
049600* IN THE DESTINATION PROGRAM, NOT HERE.                          *04960000
049700*----------------------------------------------------------------*04970001
049800 3000-EDIT-DATA-IN-COMMAREA.                                      04980000
049900                                                                  04990000
050000     PERFORM 3100-RESET-ATTRIBUTES.                               05000000
050100                                                                  05010000
050200* NUMERIC CHECK - START DATE.                                     05020001
050300     MOVE ASC-START-MM               TO DP010I-UNEDITED-FIELD     05030001
050400     MOVE LENGTH OF ASC-START-MM     TO DP010I-MAXIMUM-DIGITS     05040001
050500     MOVE ZERO                       TO DP010I-MAXIMUM-DECIMALS   05050001
050600     SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                      05060001
263455     CALL DP010I-NUMERIC-EDIT-ROUTINE                             05071013
263455          USING DP010I-NUMERIC-EDIT-AREA                          05072013
050800     IF DP010I-ERROR-DETECTED                                     05080001
050900         SET PS-ERROR                                             05090001
051000             DP020-MSG-FATAL         TO TRUE                      05100001
051100         MOVE PC-TSYMSG-00008        TO DP020-MSG-NUMBER          05110001
051200         MOVE DP015-UNP-ALP-BRT-OFF  TO ASMMA                     05120001
051300         MOVE DP015-RED              TO ASMMC                     05130001
051400         MOVE DP015-REVERSE          TO ASMMH                     05140001
051500         MOVE -1                     TO ASMML                     05150001
051600         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      05160001
051700     ELSE                                                         05170001
051800         MOVE DP010I-NUMERIC-FIELD   TO ASC-START-MM-N            05180001
051900     END-IF.                                                      05190001
052000                                                                  05200001
052100     MOVE ASC-START-DD               TO DP010I-UNEDITED-FIELD     05210001
052200     MOVE LENGTH OF ASC-START-DD     TO DP010I-MAXIMUM-DIGITS     05220001
052300     MOVE ZERO                       TO DP010I-MAXIMUM-DECIMALS   05230001
052400     SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                      05240001
263455     CALL DP010I-NUMERIC-EDIT-ROUTINE                             05251013
263455          USING DP010I-NUMERIC-EDIT-AREA                          05252013
052600     IF DP010I-ERROR-DETECTED                                     05260001
052700         SET PS-ERROR                                             05270001
052800             DP020-MSG-FATAL         TO TRUE                      05280001
052900         MOVE PC-TSYMSG-00008        TO DP020-MSG-NUMBER          05290001
053000         MOVE DP015-UNP-ALP-BRT-OFF  TO ASDDA                     05300001
053100         MOVE DP015-RED              TO ASDDC                     05310001
053200         MOVE DP015-REVERSE          TO ASDDH                     05320001
053300         MOVE -1                     TO ASDDL                     05330001
053400         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      05340001
053500     ELSE                                                         05350001
053600         MOVE DP010I-NUMERIC-FIELD   TO ASC-START-DD-N            05360001
053700     END-IF.                                                      05370001
053800                                                                  05380001
053900     MOVE ASC-START-CCYY             TO DP010I-UNEDITED-FIELD     05390001
054000     MOVE LENGTH OF ASC-START-CCYY   TO DP010I-MAXIMUM-DIGITS     05400001
054100     MOVE ZERO                       TO DP010I-MAXIMUM-DECIMALS   05410001
054200     SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                      05420001
263455     CALL DP010I-NUMERIC-EDIT-ROUTINE                             05431013
263455          USING DP010I-NUMERIC-EDIT-AREA                          05432013
054400     IF DP010I-ERROR-DETECTED                                     05440001
054500         SET PS-ERROR                                             05450001
054600             DP020-MSG-FATAL         TO TRUE                      05460001
054700         MOVE PC-TSYMSG-00008        TO DP020-MSG-NUMBER          05470001
054800         MOVE DP015-UNP-ALP-BRT-OFF  TO ASCCYYA                   05480001
054900         MOVE DP015-RED              TO ASCCYYC                   05490001
055000         MOVE DP015-REVERSE          TO ASCCYYH                   05500001
055100         MOVE -1                     TO ASCCYYL                   05510001
055200         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      05520001
055300     ELSE                                                         05530001
055400         MOVE DP010I-NUMERIC-FIELD   TO ASC-START-CCYY-N          05540001
055500     END-IF.                                                      05550001
055600                                                                  05560000
055700* NUMERIC CHECK - END DATE.                                       05570001
055800     MOVE ASC-END-MM                 TO DP010I-UNEDITED-FIELD     05580001
055900     MOVE LENGTH OF ASC-END-MM       TO DP010I-MAXIMUM-DIGITS     05590001
056000     MOVE ZERO                       TO DP010I-MAXIMUM-DECIMALS   05600001
056100     SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                      05610001
263455     CALL DP010I-NUMERIC-EDIT-ROUTINE                             05621013
263455          USING DP010I-NUMERIC-EDIT-AREA                          05622013
056300     IF DP010I-ERROR-DETECTED                                     05630001
056400         SET PS-ERROR                                             05640001
056500             DP020-MSG-FATAL         TO TRUE                      05650001
056600         MOVE PC-TSYMSG-00008        TO DP020-MSG-NUMBER          05660001
056700         MOVE DP015-UNP-ALP-BRT-OFF  TO AEMMA                     05670001
056800         MOVE DP015-RED              TO AEMMC                     05680001
056900         MOVE DP015-REVERSE          TO AEMMH                     05690001
057000         MOVE -1                     TO AEMML                     05700001
057100         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      05710001
057200     ELSE                                                         05720001
057300         MOVE DP010I-NUMERIC-FIELD   TO ASC-END-MM-N              05730001
057400     END-IF.                                                      05740001
057500                                                                  05750001
057600     MOVE ASC-END-DD                 TO DP010I-UNEDITED-FIELD     05760001
057700     MOVE LENGTH OF ASC-END-DD       TO DP010I-MAXIMUM-DIGITS     05770001
057800     MOVE ZERO                       TO DP010I-MAXIMUM-DECIMALS   05780001
057900     SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                      05790001
263455     CALL DP010I-NUMERIC-EDIT-ROUTINE                             05801013
263455          USING DP010I-NUMERIC-EDIT-AREA                          05802013
058100     IF DP010I-ERROR-DETECTED                                     05810001
058200         SET PS-ERROR                                             05820001
058300             DP020-MSG-FATAL         TO TRUE                      05830001
058400         MOVE PC-TSYMSG-00008        TO DP020-MSG-NUMBER          05840001
058500         MOVE DP015-UNP-ALP-BRT-OFF  TO AEDDA                     05850001
058600         MOVE DP015-RED              TO AEDDC                     05860001
058700         MOVE DP015-REVERSE          TO AEDDH                     05870001
058800         MOVE -1                     TO AEDDL                     05880001
058900         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      05890001
059000     ELSE                                                         05900001
059100         MOVE DP010I-NUMERIC-FIELD   TO ASC-END-DD-N              05910001
059200     END-IF.                                                      05920001
059300                                                                  05930001
059400     MOVE ASC-END-CCYY               TO DP010I-UNEDITED-FIELD     05940001
059500     MOVE LENGTH OF ASC-END-CCYY     TO DP010I-MAXIMUM-DIGITS     05950001
059600     MOVE ZERO                       TO DP010I-MAXIMUM-DECIMALS   05960001
059700     SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                      05970001
263455     CALL DP010I-NUMERIC-EDIT-ROUTINE                             05981013
263455          USING DP010I-NUMERIC-EDIT-AREA                          05982013
059900     IF DP010I-ERROR-DETECTED                                     05990001
060000         SET PS-ERROR                                             06000001
060100             DP020-MSG-FATAL         TO TRUE                      06010001
060200         MOVE PC-TSYMSG-00008        TO DP020-MSG-NUMBER          06020001
060300         MOVE DP015-UNP-ALP-BRT-OFF  TO AECCYYA                   06030001
060400         MOVE DP015-RED              TO AECCYYC                   06040001
060500         MOVE DP015-REVERSE          TO AECCYYH                   06050001
060600         MOVE -1                     TO AECCYYL                   06060001
060700         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      06070001
060800     ELSE                                                         06080001
060900         MOVE DP010I-NUMERIC-FIELD   TO ASC-END-CCYY-N            06090001
061000     END-IF.                                                      06100001
061100                                                                  06110001
061200*  FILL WORKING-STORAGE DATE FIELDS.                              06120004
061300     MOVE ZEROES TO PV-START-DATE                                 06130004
061400                    PV-END-DATE.                                  06140004
061500     IF PS-NO-ERROR                                               06150004
061600         MOVE ASC-START-CCYY-N TO PV-START-CCYY                   06160004
061700         MOVE ASC-START-MM-N   TO PV-START-MM                     06170004
061800         MOVE ASC-START-DD-N   TO PV-START-DD                     06180004
061900                                                                  06190004
062000         MOVE ASC-END-CCYY-N   TO PV-END-CCYY                     06200004
062100         MOVE ASC-END-MM-N     TO PV-END-MM                       06210004
062200         MOVE ASC-END-DD-N     TO PV-END-DD                       06220004
062300     END-IF.                                                      06230004
062400                                                                  06240004
062500*  CHECK FOR VALIDATE DATES.                                      06250001
062600     IF PS-NO-ERROR                                               06260001
062700         IF PV-START-DATE > ZEROES                                06270002
062800             INITIALIZE DPG51 DPG52 DPG53                         06280002
062900                        DPG54 DPG55 DPG56                         06290002
063000             SET DPG51-ACTUAL-CALENDAR-ONLY                       06300002
063100                 DPG51-DO-NOT-INCR-DECR-DATE TO TRUE              06310002
063200*            'CCYYMMDD'                                           06320001
063300             SET DPG52-LK-DTE-ISO TO TRUE                         06330002
063400             MOVE PV-START-DATE   TO DPG52-LK-DATE-INPUT          06340002
063500             CALL 'DPKUT500'   USING DPG51 DPG52 DPG53            06350002
063600                                     DPG54 DPG55 DPG56            06360002
063700             IF (DPG54-DATE-INVALID                               06370002
063800               OR DPG54-SEVERE-ERROR)                             06380002
063900                 SET PS-ERROR                                     06390002
064000                     DP020-MSG-FATAL         TO TRUE              06400002
064100                 MOVE PC-TSYMSG-00009        TO DP020-MSG-NUMBER  06410002
064200                 MOVE DP015-UNP-ALP-BRT-OFF  TO ASMMA             06420002
064300                                                ASDDA             06430002
064400                                                ASCCYYA           06440002
064500                 MOVE DP015-RED              TO ASMMC             06450002
064600                                                ASDDC             06460002
064700                                                ASCCYYC           06470002
064800                 MOVE DP015-REVERSE          TO ASMMH             06480002
064900                                                ASDDH             06490002
065000                                                ASCCYYH           06500002
065100                 MOVE -1                     TO ASMML             06510002
065200                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              06520002
065300             END-IF                                               06530002
065400         END-IF                                                   06540002
065500                                                                  06550001
065600         IF PV-END-DATE > ZEROES                                  06560002
065700             INITIALIZE DPG51 DPG52 DPG53                         06570002
065800                        DPG54 DPG55 DPG56                         06580002
065900             SET DPG51-ACTUAL-CALENDAR-ONLY                       06590002
066000                 DPG51-DO-NOT-INCR-DECR-DATE TO TRUE              06600002
066100*            'CCYYMMDD'                                           06610001
066200             SET DPG52-LK-DTE-ISO TO TRUE                         06620002
066300             MOVE PV-END-DATE     TO DPG52-LK-DATE-INPUT          06630002
066400             CALL 'DPKUT500'   USING DPG51 DPG52 DPG53            06640002
066500                                     DPG54 DPG55 DPG56            06650002
066600             IF (DPG54-DATE-INVALID                               06660002
066700               OR DPG54-SEVERE-ERROR)                             06670002
066800                 SET PS-ERROR                                     06680002
066900                     DP020-MSG-FATAL         TO TRUE              06690002
067000                 MOVE PC-TSYMSG-00009        TO DP020-MSG-NUMBER  06700002
067100                 MOVE DP015-UNP-ALP-BRT-OFF  TO AEMMA             06710002
067200                                                AEDDA             06720002
067300                                                AECCYYA           06730002
067400                 MOVE DP015-RED              TO AEMMC             06740002
067500                                                AEDDC             06750002
067600                                                AECCYYC           06760002
067700                 MOVE DP015-REVERSE          TO AEMMH             06770002
067800                                                AEDDH             06780002
067900                                                AECCYYH           06790002
068000                 MOVE -1                     TO AEMML             06800002
068100                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              06810002
068200             END-IF                                               06820002
068300         END-IF                                                   06830002
068400     END-IF.                                                      06840001
068500                                                                  06850001
068600*  CHECK IF END DATE ENTERED, START DATE REQUIRED.                06860010
068700     IF PS-NO-ERROR                                               06870002
068800         IF PV-END-DATE > ZEROES                                  06880002
068900           AND PV-START-DATE = ZEROES                             06890002
069000             SET PS-ERROR                                         06900002
069100                 DP020-MSG-FATAL         TO TRUE                  06910002
069200             MOVE PC-TSYMSG-02477        TO DP020-MSG-NUMBER      06920003
069300             MOVE DP015-UNP-ALP-BRT-OFF  TO ASMMA                 06930002
069400                                            ASDDA                 06940002
069500                                            ASCCYYA               06950002
069600             MOVE DP015-RED              TO ASMMC                 06960002
069700                                            ASDDC                 06970002
069800                                            ASCCYYC               06980002
069900             MOVE DP015-REVERSE          TO ASMMH                 06990002
070000                                            ASDDH                 07000002
070100                                            ASCCYYH               07010002
070200             MOVE -1                     TO ASMML                 07020002
070300             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  07030002
070400         END-IF                                                   07040010
070500     END-IF.                                                      07050010
070600                                                                  07060001
070700*  CHECK IF START DATE ENTERED, END DATE REQUIRED.                07070004
070800     IF PS-NO-ERROR                                               07080004
070900         IF PV-START-DATE > ZEROES                                07090004
071000           AND PV-END-DATE = ZEROES                               07100004
071100             SET PS-ERROR                                         07110004
071200                 DP020-MSG-FATAL         TO TRUE                  07120004
071300             MOVE PC-TSYMSG-02477        TO DP020-MSG-NUMBER      07130004
071400             MOVE DP015-UNP-ALP-BRT-OFF  TO AEMMA                 07140004
071500                                            AEDDA                 07150004
071600                                            AECCYYA               07160004
071700             MOVE DP015-RED              TO AEMMC                 07170004
071800                                            AEDDC                 07180004
071900                                            AECCYYC               07190004
072000             MOVE DP015-REVERSE          TO AEMMH                 07200004
072100                                            AEDDH                 07210004
072200                                            AECCYYH               07220004
072300             MOVE -1                     TO AEMML                 07230004
072400             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  07240004
072500         END-IF                                                   07250010
072600     END-IF.                                                      07260004
072700                                                                  07270004
072800*  CHECK IF END DATE GREATER THAN START DATE.                     07280004
072900     IF PS-NO-ERROR                                               07290005
073000         IF PV-START-DATE <= PV-END-DATE                          07300004
073100             CONTINUE                                             07310004
073200         ELSE                                                     07320004
073300             SET PS-ERROR                                         07330004
073400                 DP020-MSG-FATAL             TO TRUE              07340004
073500             MOVE PC-TSYMSG-02372        TO DP020-MSG-NUMBER      07350004
073600             MOVE DP015-UNP-ALP-BRT-OFF  TO ASMMA                 07360004
073700                                            ASDDA                 07370004
073800                                            ASCCYYA               07380004
073900                                            AEMMA                 07390004
074000                                            AEDDA                 07400004
074100                                            AECCYYA               07410004
074200             MOVE DP015-RED              TO ASMMC                 07420004
074300                                            ASDDC                 07430004
074400                                            ASCCYYC               07440004
074500                                            AEMMC                 07450004
074600                                            AEDDC                 07460004
074700                                            AECCYYC               07470004
074800             MOVE DP015-REVERSE          TO ASMMH                 07480004
074900                                            ASDDH                 07490004
075000                                            ASCCYYH               07500004
075100                                            AEMMH                 07510004
075200                                            AEDDH                 07520004
075300                                            AECCYYH               07530004
075400             MOVE -1                     TO ASMML                 07540004
075500             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  07550004
075600         END-IF                                                   07560004
075700     END-IF.                                                      07570004
075800                                                                  07580004
075900     IF PS-NO-ERROR                                               07590004
076000         MOVE -1                     TO ASMML                     07600002
076100         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      07610002
076200     END-IF.                                                      07620000
076300                                                                  07630000
076400*----------------------------------------------------------------*07640000
076500*  MOVE THE DEFAULT ATTRIBUTES TO ALL OF THE OPEN FIELDS ON THE  *07650000
076600*  MAP.                                                          *07660000
076700*----------------------------------------------------------------*07670001
076800 3100-RESET-ATTRIBUTES.                                           07680000
076900                                                                  07690000
077000     MOVE DP015-UNP-NUM-NOR-OFF TO ASMMA                          07700001
077100                                   ASDDA                          07710001
077200                                   ASCCYYA                        07720001
077300                                   AEMMA                          07730001
077400                                   AEDDA                          07740001
077500                                   AECCYYA.                       07750001
077600                                                                  07760001
077700     MOVE DP015-GREEN           TO ASMMC                          07770001
077800                                   ASDDC                          07780001
077900                                   ASCCYYC                        07790001
078000                                   AEMMC                          07800001
078100                                   AEDDC                          07810001
078200                                   AECCYYC.                       07820001
078300                                                                  07830001
078400     MOVE DP015-UNDERLINE       TO ASMMH                          07840001
078500                                   ASDDH                          07850001
078600                                   ASCCYYH                        07860001
078700                                   AEMMH                          07870001
078800                                   AEDDH                          07880001
078900                                   AECCYYH.                       07890001
079000                                                                  07900000
079100*----------------------------------------------------------------*07910000
079200*  POSITION THE CURSOR AT THE APPROPRIATE FIELD.                 *07920000
079300*  IF THERE IS ANY DATA TO MOVE TO THE SCREEN ON INITIAL, MOVE   *07930000
079400*  IT HERE.                                                      *07940000
079500*----------------------------------------------------------------*07950001
079600 4000-BUILD-INITIAL-PANEL.                                        07960000
079700                                                                  07970000
079800     SET DP030-SET-CURSOR-APPL-1 TO TRUE.                         07980001
079900     MOVE -1                     TO ASMML.                        07990001
080000                                                                  08000000
080100     PERFORM 8100-GET-INVENTORY-RECORD.                           08010009
080200                                                                  08020009
080300     MOVE PV-INV-START-CCYY TO ASC-DB2-START-CCYY-N               08030009
080400                               ASC-START-CCYY-N.                  08040009
080500     MOVE PV-INV-START-MM   TO ASC-DB2-START-MM-N                 08050009
080600                               ASC-START-MM-N.                    08060009
080700     MOVE PV-INV-START-DD   TO ASC-DB2-START-DD-N                 08070009
080800                               ASC-START-DD-N.                    08080009
080900                                                                  08090009
081000     MOVE PV-INV-STOP-CCYY  TO ASC-DB2-END-CCYY-N                 08100009
081100                               ASC-END-CCYY-N.                    08110009
081200     MOVE PV-INV-STOP-MM    TO ASC-DB2-END-MM-N                   08120009
081300                               ASC-END-MM-N.                      08130009
081400     MOVE PV-INV-STOP-DD    TO ASC-DB2-END-DD-N                   08140009
081500                               ASC-END-DD-N.                      08150009
081600                                                                  08160009
081700     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        08170000
081800                                                                  08180000
081900*----------------------------------------------------------------*08190000
082000*    RESTORE THE DATA ON THE SCREEN FROM THE COMM AREA.          *08200000
082100*----------------------------------------------------------------*08210001
082200 4400-MOVE-COMMAREA-TO-SCREEN.                                    08220000
082300                                                                  08230000
082400     MOVE ASC-START-MM-N         TO ASMMO.                        08240001
082500     MOVE ASC-START-DD-N         TO ASDDO.                        08250001
082600     MOVE ASC-START-CCYY-N       TO ASCCYYO.                      08260001
082700                                                                  08270009
082800     MOVE ASC-END-MM-N           TO AEMMO.                        08280001
082900     MOVE ASC-END-DD-N           TO AEDDO.                        08290001
083000     MOVE ASC-END-CCYY-N         TO AECCYYO.                      08300001
083100                                                                  08310001
083200*----------------------------------------------------------------*08320002
083300*  UPDATE INVENTORY PERIOD START/STOP DATES.                     *08330002
083400*----------------------------------------------------------------*08340003
083500 8000-UPDATE-RECORD.                                              08350002
083600                                                                  08360002
083700     PERFORM 8100-GET-INVENTORY-RECORD.                           08370002
083800                                                                  08380002
083900     MOVE ASC-START-CCYY-N TO PV-INV-START-CCYY.                  08390002
084000     MOVE ASC-START-MM-N   TO PV-INV-START-MM.                    08400002
084100     MOVE ASC-START-DD-N   TO PV-INV-START-DD.                    08410002
084200                                                                  08420002
084300     MOVE ASC-END-CCYY-N   TO PV-INV-STOP-CCYY.                   08430002
084400     MOVE ASC-END-MM-N     TO PV-INV-STOP-MM.                     08440002
084500     MOVE ASC-END-DD-N     TO PV-INV-STOP-DD.                     08450002
084600                                                                  08460002
084700     MOVE PV-INV-START-TMST TO KRPRPM-FUNC-BEG-TMST.              08470002
084800     MOVE PV-INV-STOP-TMST  TO KRPRPM-FUNC-END-TMST.              08480002
084900                                                                  08490002
085000     EXEC SQL                                                     08500002
085100         UPDATE TKRPRPM                                           08510002
085200            SET FUNC_BEG_TMST     = :KRPRPM-FUNC-BEG-TMST         08520002
085300              , FUNC_END_TMST     = :KRPRPM-FUNC-END-TMST         08530002
085400          WHERE SYS_PRC_FUNC_CDE  = 'CSINDT'                      08540002
085500     END-EXEC.                                                    08550002
085600                                                                  08560002
085700     EVALUATE TRUE                                                08570002
085800       WHEN SQLCODE = ZERO                                        08580002
085900           CONTINUE                                               08590002
086000                                                                  08600002
086100       WHEN SQLWARN0 NOT = SPACES                                 08610002
086200       WHEN SQLCODE < ZERO                                        08620002
086300       WHEN SQLCODE > ZERO                                        08630002
086400           MOVE '8000-UPDATE-RECORD' TO DP013-PARAGRAPH           08640002
086500           MOVE 'UPDATE INVENTORY START/END DATES'                08650002
086600                                     TO DP013-MESSAGE-TEXT (1)    08660002
086700           MOVE SQLCA                TO DP013-SQLCA               08670002
086800           MOVE 'TKRPRPM'            TO DP013-DB2-TABLE-NAME (1)  08680002
086900           SET DP013-DB2-ABEND       TO TRUE                      08690002
087000           SET DP013-XCTL-DISPLAY-RESTART TO TRUE                 08700002
087100           PERFORM DP013-0000-PROCESS-ABEND                       08710002
087200     END-EVALUATE.                                                08720002
087300                                                                  08730002
087400*----------------------------------------------------------------*08740002
087500*  GET INVENTORY PERIOD START/STOP DATES.                        *08750002
087600*----------------------------------------------------------------*08760002
087700 8100-GET-INVENTORY-RECORD.                                       08770002
087800                                                                  08780002
087900     EXEC SQL                                                     08790002
088000         SELECT FUNC_BEG_TMST                                     08800002
088100              , FUNC_END_TMST                                     08810002
088200           INTO :PV-INV-START-TMST                                08820002
088300              , :PV-INV-STOP-TMST                                 08830002
088400           FROM TKRPRPM A                                         08840002
088500          WHERE A.SYS_PRC_FUNC_CDE  = 'CSINDT'                    08850002
088600     END-EXEC.                                                    08860002
088700                                                                  08870002
088800     EVALUATE TRUE                                                08880002
088900       WHEN SQLCODE = ZERO                                        08890002
089000           CONTINUE                                               08900002
089100                                                                  08910002
089200       WHEN SQLWARN0 NOT = SPACES                                 08920002
089300       WHEN SQLCODE < ZERO                                        08930002
089400       WHEN SQLCODE > ZERO                                        08940002
089500           MOVE '8100-GET-INVENTORY-RECORD' TO DP013-PARAGRAPH    08950002
089600           MOVE 'SELECT INVENTORY START/END DATES'                08960002
089700                               TO DP013-MESSAGE-TEXT (1)          08970002
089800           MOVE SQLCA          TO DP013-SQLCA                     08980002
089900           MOVE 'TKRPRPM'      TO DP013-DB2-TABLE-NAME (1)        08990002
090000           SET DP013-DB2-ABEND TO TRUE                            09000002
090100           SET DP013-XCTL-DISPLAY-RESTART   TO TRUE               09010002
090200           PERFORM DP013-0000-PROCESS-ABEND                       09020002
090300     END-EVALUATE.                                                09030002
090400                                                                  09040002
090500*----------------------------------------------------------------*09050000
090600*    ABEND PROCESSOR MODULE                                      *09060000
090700*----------------------------------------------------------------*09070000
090800     COPY DPPD013.                                                09080000
