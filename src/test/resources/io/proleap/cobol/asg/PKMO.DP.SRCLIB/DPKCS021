000100******************************************************************06/20/94
000200 IDENTIFICATION DIVISION.                                         DPKCS021
000300******************************************************************   LV001
000400 PROGRAM-ID.                DPKCS021.                             DPKCS021
000500 AUTHOR.                    DWYNE WALLACE.                        DPKCS021
000600 INSTALLATION.              KOHLS DEPARTMENT STORES.              DPKCS021
000700 DATE-WRITTEN.              OCTOBER 1990.                         DPKCS021
000800 DATE-COMPILED.                                                   DPKCS021
000900 SKIP2                                                            DPKCS021
001000******************************************************************DPKCS021
001100*  CICS PROGRAM - DPKCS021                                       *DPKCS021
001200*  TRANSACTION ID. - Z021                                        *DPKCS021
001300*                                                                *DPKCS021
001400*                UPDATE A MENU ITEM PROGRAM                      *DPKCS021
001500*                                                                *DPKCS021
001600*  THIS TRANSACTION PROCESSES ALL UPDATE REQUESTS FOR THE TMENU- *DPKCS021
001700*  ITEM DB2 DATABASE. THIS DATABASE IS USED TO CONTROL NAVIGATION*DPKCS021
001800*  WITHIN CICS.                                                  *DPKCS021
001900*                                                                *DPKCS021
002000*  PF KEY PROCESSING:                                            *DPKCS021
002100*                                                                *DPKCS021
002200*         ENTER - EDIT SCREEN                                    *DPKCS021
002300*         PA2   - TOGGLE FUNCTION KEY LINES                      *DPKCS021
002400*         PF5   - REFRESH LIST FROM DATABASE                     *DPKCS021
002500*         PF15  - UPDATE DATABASE                                *DPKCS021
002600*         CLEAR - RESET SCREEN TO LAST DISPLAY                   *DPKCS021
002700*                                                                *DPKCS021
002800*  NAVIGATION PF KEY PROCESSING:                                 *DPKCS021
002900*                                                                *DPKCS021
003000*         *SEE MNEMONIC FILE FOR NAVIGATION PF KEY DEFINITIONS.  *DPKCS021
003100*                                                                *DPKCS021
003200*  CHANGED 4/92 BY M. FURLICK PER W/R 1937.                      *DPKCS021
003300*         ADDED PROGRAM ID TO SCREEN.                            *DPKCS021
003400*                                                                *DPKCS021
003500*    03/21/96  TKMA235  ADD LOGIC FOR CICS24X7 PROCESSING.       *        
003600*                       1) MODIFIED THIS PROGRAM TO UPDATE THE   *        
003700*                          DB2 TMNEMONIC TABLE'S UPD-VSAM-IND.   *        
003703*                          * THIS COLUMN WILL BE UPDATED FOR:    *        
003704*                            THE MENU ROW (NOT THE MENUITEM ROW).*        
003710*                          * THIS COLUMN WILL BE UPDATED WHEN:   *        
003800*                            A MENUITEM IS UPDATED ON THIS MENU. *        
003900*                          SEE PARA: X980-UPDT-TMNEMONIC-ROW.    *        
004000******************************************************************DPKCS021
004100 SKIP2                                                            DPKCS021
004200******************************************************************DPKCS021
004300 ENVIRONMENT DIVISION.                                            DPKCS021
004400******************************************************************DPKCS021
004500 EJECT                                                            DPKCS021
004600******************************************************************DPKCS021
004700 DATA DIVISION.                                                   DPKCS021
004800******************************************************************DPKCS021
004900 SKIP2                                                            DPKCS021
005000 WORKING-STORAGE SECTION.                                         DPKCS021
005100 SKIP1                                                            DPKCS021
005200*********************                                             DPKCS021
005300* PROGRAM CONSTANTS *                                             DPKCS021
005400*********************                                             DPKCS021
005500 SKIP1                                                            DPKCS021
005600 01  PROGRAM-CONSTANT-AREA.                                       DPKCS021
005700     05  PC-MAXIMUM-COMMAREA-LENGTH                               DPKCS021
005800                                 PIC S9(4)      VALUE +4072       DPKCS021
005900                                                COMP SYNC.        DPKCS021
006000     05  PC-CURRENT-MAP-NAME     PIC X(8)       VALUE 'DP021A  '. DPKCS021
006100     05  PC-CURRENT-MAPSET-NAME  PIC X(8)       VALUE 'DPKM021 '. DPKCS021
006200     05  PC-CURRENT-PROGRAM-NAME PIC X(8)       VALUE 'DPKCS021'. DPKCS021
006300     05  PC-NAVIGATOR-TRAN-ID    PIC X(4)       VALUE 'Z008'.     DPKCS021
006400     05  PC-LEAVE-SYSTEM-LENGTH  PIC S9(4)      VALUE +80         DPKCS021
006500                                                COMP SYNC.        DPKCS021
006600     05  PC-HEX-VALUE-80         PIC X          VALUE 'ø'.        DPKCS021
006700     05  PC-FORMAT-CODE          PIC X(4)       VALUE 'MITM'.     DPKCS021
006800     05  PC-Y                    PIC X(1)       VALUE 'Y'.              21
006900     05  PC-TSYMSG-00005         PIC 9(5)       VALUE 00005.      DPKCS021
007000     05  PC-TSYMSG-00008         PIC 9(5)       VALUE 00008.      DPKCS021
007100     05  PC-TSYMSG-00057         PIC 9(5)       VALUE 00057.      DPKCS021
007200     05  PC-TSYMSG-00059         PIC 9(5)       VALUE 00059.      DPKCS021
007300     05  PC-TSYMSG-00148         PIC 9(5)       VALUE 00148.      DPKCS021
007400     05  PC-TSYMSG-00259         PIC 9(5)       VALUE 00259.      DPKCS021
007500     05  PC-TSYMSG-00266         PIC 9(5)       VALUE 00266.      DPKCS021
007600     05  PC-TSYMSG-00268         PIC 9(5)       VALUE 00268.      DPKCS021
007700 SKIP2                                                            DPKCS021
007800*********************                                             DPKCS021
007900* PROGRAM VARIABLES *                                             DPKCS021
008000*********************                                             DPKCS021
008100 SKIP1                                                            DPKCS021
008200 01  PROGRAM-VARIABLE-AREA.                                       DPKCS021
008300     05  PV-CICS-RESPONSE        PIC S9(8)      VALUE ZERO        DPKCS021
008400                                                COMP SYNC.        DPKCS021
008500     05  PV-TERMINAL             PIC X(4)       VALUE SPACES.     DPKCS021
008600     05  PV-MENU-TRAN            PIC X(4)       VALUE 'Z007'.     DPKCS021
008700     05  PV-LEAVE-SYSTEM-MSG     PIC X(80)      VALUE SPACES.     DPKCS021
008800     05  PV-HOLD-MESSAGE         PIC X(78)      VALUE SPACES.     DPKCS021
008900     05  PV-HOLD-SEVERITY-IND    PIC X(1)       VALUE SPACES.     DPKCS021
009000     05  PV-MNEMONIC             PIC X(8)       VALUE SPACES.     DPKCS021
009100     05  PV-DESC-NULL-IND        PIC S9(4)      COMP.             DPKCS021
009200         88  PV-DESC-NOT-NULL                   VALUE ZERO.       DPKCS021
009300         88  PV-DESC-NULL                       VALUE -1.         DPKCS021
009400     05  PV-SEQUENCE-NUMBER-ALPHA                                 DPKCS021
009500                                 PIC X(4).                        DPKCS021
009600     05  PV-SEQUENCE-NUMBER-NUMERIC                               DPKCS021
009700                                 REDEFINES                        DPKCS021
009800         PV-SEQUENCE-NUMBER-ALPHA                                 DPKCS021
009900                                 PIC 9(4).                        DPKCS021
010000     05  PV-FORMAT-CODES         PIC X(4)       VALUE SPACES.     DPKCS021
010100         88  PV-ACCEPTED-FORMAT-CODE            VALUE 'CMIA'      DPKCS021
010200                                                      'FKEY'      DPKCS021
010300                                                      'MITM'.     DPKCS021
010400     05  PV-DISPLAY-INFO.                                               12
010500         10  PV-DISP-MENU-NAME   PIC X(8).                              12
010600         10  FILLER              PIC X(2)       VALUE ', '.             12
010700         10  PV-DISP-ITEM        PIC X(8).                              12
010800         10  PV-DISP-FIELD2                                             12
010900             REDEFINES                                                  12
011000             PV-DISP-ITEM.                                              12
011100             15  PV-DISP-SEQ     PIC 9(4).                              12
011200             15  FILLER          PIC X(4).                              12
011300         10  PV-DISP-FIELD3.                                            12
011400             15  PV-DISP-FIELD3A PIC X(8).                              12
011500             15  PV-DISP-FIELD3B PIC X(8).                              12
011600 EJECT                                                            DPKCS021
011700********************                                              DPKCS021
011800* PROGRAM SWITCHES *                                              DPKCS021
011900********************                                              DPKCS021
012000 SKIP1                                                            DPKCS021
012100 01  PROGRAM-SWITCHES.                                            DPKCS021
012200     05  PS-MAP-SEND-TYPE        PIC X          VALUE '1'.        DPKCS021
012300         88  PS-SEND-MAP-N-DATA-FRSET           VALUE '1'.        DPKCS021
012400         88  PS-SEND-MAP-N-DATA-FRSET-CPOSN     VALUE '2'.        DPKCS021
012500         88  PS-SEND-DATA-ONLY-FRSET            VALUE '3'.        DPKCS021
012600         88  PS-SEND-DATA-ONLY                  VALUE '4'.        DPKCS021
012700         88  PS-SEND-DATA-ONLY-ERASEAUP         VALUE '5'.        DPKCS021
012800         88  PS-SEND-MAP-ONLY-FRSET             VALUE '6'.        DPKCS021
012900     05  PS-LOCAL-FUNCTION-KEY-IND                                DPKCS021
013000                                 PIC X          VALUE 'N'.        DPKCS021
013100         88  PS-LOCAL-FUNCTION-NO               VALUE 'N'.        DPKCS021
013200         88  PS-LOCAL-FUNCTION-YES              VALUE 'Y'.        DPKCS021
013300     05  PS-ROW-FOUND-IND        PIC X          VALUE 'N'.        DPKCS021
013400         88  PS-ROW-FOUND-NO                    VALUE 'N'.        DPKCS021
013500         88  PS-ROW-FOUND-YES                   VALUE 'Y'.        DPKCS021
013600     05  PS-EDIT-ERROR-SW        PIC X          VALUE 'N'.        DPKCS021
013700         88  PS-EDIT-ERROR-NO                   VALUE 'N'.        DPKCS021
013800         88  PS-EDIT-ERROR-YES                  VALUE 'Y'.        DPKCS021
013900     05  PS-WARNING-SWITCH       PIC X          VALUE 'N'.        DPKCS021
014000         88  PS-NO-WARNING                      VALUE 'N'.        DPKCS021
014100         88  PS-WARNING                         VALUE 'Y'.        DPKCS021
014200     05  PS-NEW-MNEMONIC-ENTERED-IND                              DPKCS021
014300                                 PIC X          VALUE 'N'.        DPKCS021
014400         88  PS-NEW-MNEMONIC-ENTERED-NO         VALUE 'N'.        DPKCS021
014500         88  PS-NEW-MNEMONIC-ENTERED-YES        VALUE 'Y'.        DPKCS021
014600 EJECT                                                            DPKCS021
014700******************                                                DPKCS021
014800* ERROR MESSAGES *                                                DPKCS021
014900******************                                                DPKCS021
015000 SKIP1                                                            DPKCS021
015100 01  ERROR-MESSAGES.                                              DPKCS021
015200     05  INVALID-NEXT-APPL-MSG   PIC X(78)      VALUE             DPKCS021
015300         'NEXT APPLICATION CODE INVALID                           DPKCS021
015400-        '                      '.                                DPKCS021
015500 EJECT                                                            DPKCS021
015600**************************                                        DPKCS021
015700* DB2 COMMUNICATION AREA *                                        DPKCS021
015800**************************                                        DPKCS021
015900 SKIP1                                                            DPKCS021
016000     EXEC SQL                                                     DPKCS021
016100         INCLUDE SQLCA                                            DPKCS021
016200     END-EXEC.                                                    DPKCS021
016300 SKIP2                                                            DPKCS021
016400***********************************                               DPKCS021
016500* DB2 SQL RETURN CODE DEFINITIONS *                               DPKCS021
016600*    USING '88' LEVEL             *                               DPKCS021
016700***********************************                               DPKCS021
016800 SKIP1                                                            DPKCS021
016900 01  SQL-RETURN-CODE             PIC S9(9)      COMP-4.           DPKCS021
017000     88  SQL-SUCCESSFUL                         VALUE +0.         DPKCS021
017100     88  SQL-ROW-FOUND                          VALUE +0.         DPKCS021
017200     88  SQL-ROW-NOT-FOUND                      VALUE +100.       DPKCS021
017300     88  SQL-WARNING                            VALUE +100        DPKCS021
017400                                                      +558        DPKCS021
017500                                                      +560.       DPKCS021
017600     88  SQL-DUPLICATE-ROW                      VALUE -803.       DPKCS021
017700     88  SQL-MORE-THAN-1-ROW                    VALUE -811.       DPKCS021
017800     88  SQL-NOT-AVAILABLE                      VALUE -911.       DPKCS021
017900     88  SQL-DB2-DOWN                           VALUE -923.       DPKCS021
018000     88  SQL-NULL-VALUE                         VALUE -305.       DPKCS021
018100     88  SQL-DEPENDENT-ROW                      VALUE -532.       DPKCS021
018200 EJECT                                                            DPKCS021
018300**************************************                            DPKCS021
018400* STANDARD ATTENTION IDENTIFIER LIST *                            DPKCS021
018500**************************************                            DPKCS021
018600 SKIP1                                                            DPKCS021
018700     COPY DFHAID.                                                 DPKCS021
018800 EJECT                                                            DPKCS021
018900**************************************************************    DPKCS021
019000* WORKING-STORAGE LAYOUT USED FOR STANDARD ERROR MESSAGES.   *    DPKCS021
019100**************************************************************    DPKCS021
019200     COPY DPRD507I.                                               DPKCS021
019300 EJECT                                                            DPKCS021
019400*---------------------------------------------------------------* DPKCS021
019500*    WORKING STORAGE INCLUDE MEMBER USED WITH INCLUDE DPPD005   * DPKCS021
019600*---------------------------------------------------------------* DPKCS021
019700     COPY DPWS006.                                                DPKCS021
019800 EJECT                                                            DPKCS021
019900**************************************************************    DPKCS021
020000* WORKING-STORAGE LAYOUT USED TO LOAD THE FUNCTION KEY LINES *    DPKCS021
020100**************************************************************    DPKCS021
020200     COPY DPWS009.                                                DPKCS021
020300 EJECT                                                            DPKCS021
020400***************************                                       DPKCS021
020500* COMMON ABEND DATA AREAS *                                       DPKCS021
020600***************************                                       DPKCS021
020700 SKIP1                                                            DPKCS021
020800     COPY DPWS013.                                                DPKCS021
020900 EJECT                                                            DPKCS021
021000*********************************************************         DPKCS021
021100* KOHL'S DEFINED:                                       *         DPKCS021
021200* STANDARD ATTRIBUTE AND PRINTER CONTROL CHARACTER LIST *         DPKCS021
021300*********************************************************         DPKCS021
021400 SKIP1                                                            DPKCS021
021500     COPY DPWS015.                                                DPKCS021
021600 EJECT                                                            DPKCS021
021700**************************************                            DPKCS021
021800* KOHL'S:                            *                            DPKCS021
021900* STANDARD ATTENTION IDENTIFIER LIST *                            DPKCS021
022000**************************************                            DPKCS021
022100 SKIP1                                                            DPKCS021
022200     COPY DPWS016.                                                DPKCS021
022300 EJECT                                                            DPKCS021
022400***************************************************************   DPKCS021
022500* WORKING-STORAGE LAYOUT USED TO GET THE SYSTEM DATE AND TIME *   DPKCS021
022600***************************************************************   DPKCS021
022700     COPY DPWS017.                                                DPKCS021
022800 EJECT                                                            DPKCS021
022900*******************************                                   DPKCS021
023000* STANDARD COMMUNICATION AREA *                                   DPKCS021
023100*******************************                                   DPKCS021
023200 SKIP1                                                            DPKCS021
023300     COPY DPWS020.                                                DPKCS021
023400     05  FILLER                  REDEFINES                        DPKCS021
023500         DP020-VARIABLE-COMMAREA.                                 DPKCS021
023600***************************************                           DPKCS021
023700* CICSARC INTER APPLICATION DATA AREA *                           DPKCS021
023800***************************************                           DPKCS021
023900         10  INTER-APPL-COMM-AREA                                 DPKCS021
024000                                 PIC X(200).                      DPKCS021
024100     COPY DPWS050.                                                DPKCS021
024200     COPY DPWS051.                                                DPKCS021
024300     COPY DPWS052.                                                DPKCS021
024400     COPY DPWS055.                                                DPKCS021
024500**********************************                                DPKCS021
024600* APPLICATION SPECIFIC COMM AREA *                                DPKCS021
024700**********************************                                DPKCS021
024800         10  APPL-SPECIFIC-COMM-AREA                              DPKCS021
024900                                 PIC X(2865).                     DPKCS021
025000         10  DP021-APPL-SPECIFIC-COMM-AREA                        DPKCS021
025100                                 REDEFINES                        DPKCS021
025200             APPL-SPECIFIC-COMM-AREA.                             DPKCS021
025300             15  FILLER          PIC X(02).                       DPKCS021
025400             15  DP021-CURRENT-SCREEN-IMAGE.                      DPKCS021
025500                 20  DP021-SCREEN-TRAN-ID                         DPKCS021
025600                                 PIC X(04).                       DPKCS021
025700                 20  DP021-SCREEN-MNEMONIC                        DPKCS021
025800                                 PIC X(08).                       DPKCS021
025900                 20  DP021-SCREEN-SEQUENCE-NUMBER                 DPKCS021
026000                                 PIC X(04).                       DPKCS021
026100                 20  DP021-SCREEN-MENU-TITLE                      DPKCS021
026200                                 PIC X(30).                       DPKCS021
026300                 20  DP021-SCREEN-MENU-NAME                       DPKCS021
026400                                 PIC X(08).                       DPKCS021
026500                 20  DP021-SCREEN-PANEL-TITLE-NAME                DPKCS021
026600                                 PIC X(30).                       DPKCS021
026700                 20  DP021-SCREEN-MENU-ITEM-TITLE                 DPKCS021
026800                                 PIC X(30).                       DPKCS021
026900                 20  DP021-SCREEN-FORMAT                          DPKCS021
027000                                 PIC X(1).                        DPKCS021
027100             15  DP021-TRAN-DEFINED-CICS                          DPKCS021
027200                                 PIC X.                           DPKCS021
027300             15  DP021-MENU-TRAN-SW                               DPKCS021
027400                                 PIC X.                           DPKCS021
027500                 88  DP021-A-NON-MENU-TRAN          VALUE 'N'.    DPKCS021
027600                 88  DP021-A-MENU-TRAN              VALUE 'Y'.    DPKCS021
027700             15  DP021-SELECT-MAINT-RESULT                        DPKCS021
027800                                 PIC X.                           DPKCS021
027900                 88  DP021-RESULT-IS-CREATE      VALUE '1'.       DPKCS021
028000                 88  DP021-RESULT-IS-UPDATE      VALUE '2'.       DPKCS021
028100                 88  DP021-RESULT-IS-DELETE      VALUE '3'.       DPKCS021
028200                 88  DP021-RESULT-IS-READ        VALUE '4'.       DPKCS021
028300                 88  DP021-RESULT-IS-ERROR       VALUE '5'.       DPKCS021
028400             15  DP021-INTER-APPL-COMMAREA       PIC X(200).      DPKCS021
028500             15  FILLER  REDEFINES  DP021-INTER-APPL-COMMAREA.    DPKCS021
028600                 20  DP021-INTER-APPL-FORMAT-CODE                 DPKCS021
028700                                 PIC X(04).                       DPKCS021
028800                 20  DP021-INTER-APPL-ACKNLG-CODE                 DPKCS021
028900                                 PIC X(04).                       DPKCS021
029000             15  DP021-TIMESTAMP     PIC X(26).                   DPKCS021
029100 EJECT                                                            DPKCS021
029200**************************************************************    DPKCS021
029300* PARAMETER LIST USED TO CALL THE 'TRANSLATE AID' SUBROUTINE *    DPKCS021
029400**************************************************************    DPKCS021
029500     COPY DPWS045.                                                DPKCS021
029600  EJECT                                                           DPKCS021
029700********************************                                  DPKCS021
029800* DSECT FOR THE DPKM021 MAPSET *                                  DPKCS021
029900********************************                                  DPKCS021
030000 SKIP1                                                            DPKCS021
030100     COPY DPKM021.                                                DPKCS021
030200 SKIP2                                                            DPKCS021
030300************************************************                  DPKCS021
030400* REDEFINES OF DP021AI MAPSET OF DETAIL FIELDS *                  DPKCS021
030500************************************************                  DPKCS021
030600 01  MD-MAP-DATA-AREA            REDEFINES                        DPKCS021
030700     DP021AO                     PIC X(1000).                     DPKCS021
030800 EJECT                                                            DPKCS021
030900******************************                                    DPKCS021
031000* DCLGEN FOR TABLE TMENUITEM *                                    DPKCS021
031100******************************                                    DPKCS021
031200 SKIP1                                                            DPKCS021
031300     EXEC SQL                                                     DPKCS021
031400         INCLUDE TMNUITM                                          DPKCS021
031500     END-EXEC.                                                    DPKCS021
031600 EJECT                                                            DPKCS021
031700******************************                                    DPKCS021
031800* DCLGEN FOR TABLE TMNEMONIC *                                    DPKCS021
031900******************************                                    DPKCS021
032000 SKIP1                                                            DPKCS021
032100     EXEC SQL                                                     DPKCS021
032200         INCLUDE TMNMNC                                           DPKCS021
032300     END-EXEC.                                                    DPKCS021
032400 EJECT                                                            DPKCS021
032500******************************                                    DPKCS021
032600* DCLGEN FOR TABLE TCICSROUTE*                                    DPKCS021
032700******************************                                    DPKCS021
032800 SKIP1                                                            DPKCS021
032900     EXEC SQL                                                     DPKCS021
033000         INCLUDE TCICSRTE                                         DPKCS021
033100     END-EXEC.                                                    DPKCS021
033200 EJECT                                                            DPKCS021
033300 LINKAGE SECTION.                                                 DPKCS021
033400 SKIP2                                                            DPKCS021
033500 01  DFHCOMMAREA.                                                 DPKCS021
033600     05  FILLER                         OCCURS  1 TO 4072 TIMES   DPKCS021
033700                                        DEPENDING ON EIBCALEN.    DPKCS021
033800         10  FILLER                     PIC X.                    DPKCS021
033900 EJECT                                                            DPKCS021
034000 PROCEDURE DIVISION.                                              DPKCS021
034100                                                                  DPKCS021
034200******************************************************************DPKCS021
034300* A000-UPDATE-MENU-ITEM                                          *DPKCS021
034400* (Z021-00 UPDATE MNEMONIC)                                      *DPKCS021
034500* MAINLINE SECTION.                                              *DPKCS021
034600******************************************************************DPKCS021
034700                                                                  DPKCS021
034800 A000-UPDATE-MENU-ITEM.                                           DPKCS021
034900                                                                  DPKCS021
035000     PERFORM DP015-0000-CHECK-COMMAREA.                           DPKCS021
035100                                                                  DPKCS021
035200***************************************************************** DPKCS021
035300* THE VARIABLE 'RETURN-WITH-TRAN-ID' WILL BE SET TO 'Y' IN      * DPKCS021
035400* U13-CHECK-COMMAREA IF A BAD COMMAREA OR NO COMMAREA WAS       * DPKCS021
035500* ENCOUNTERED. IF THAT HAPPENS U13-CHECK-COMMAREA STARTS THE    * DPKCS021
035600* NAVIGATION TRANSACTION AND SETS THIS INDICATOR TO 'Y'. CHECK- * DPKCS021
035700* ING FOR A 'Y' HERE WILL PREVENT THIS TRANSACTION FROM CONTINU-* DPKCS021
035800* ING TO EXECUTE IF THE NAVIGATOR HAS BEEN REQUESTED TO START.  * DPKCS021
035900***************************************************************** DPKCS021
036000                                                                  DPKCS021
036100     IF  DP020-SRC-RETURN-W-TRAN-ID                               DPKCS021
036200         PERFORM A050-CONTROL-PROCESSING                          DPKCS021
036300     END-IF.                                                      DPKCS021
036400                                                                  DPKCS021
036500     PERFORM DP003-0000-RETURN-TO-CICS.                           DPKCS021
036600                                                                  DPKCS021
036700     GOBACK.                                                      DPKCS021
036800 EJECT                                                            DPKCS021
036900******************************************************************DPKCS021
037000* A050-CONTROL-PROCESSING                                        *DPKCS021
037100* (Z021-01 CONTROL PROCESSING)                                   *DPKCS021
037200******************************************************************DPKCS021
037300                                                                  DPKCS021
037400 A050-CONTROL-PROCESSING.                                         DPKCS021
037500                                                                  DPKCS021
037600     EVALUATE TRUE                                                DPKCS021
037700                                                                  DPKCS021
037800         WHEN DP020-NEXT-ACT-INITIAL                              DPKCS021
037900             INITIALIZE APPL-SPECIFIC-COMM-AREA                   DPKCS021
038000             SET PS-SEND-MAP-N-DATA-FRSET                         DPKCS021
038100                                 TO TRUE                          DPKCS021
038200             PERFORM A200-PROCESS-INTER-APPL-COMM                 DPKCS021
038300             PERFORM A250-SEND-INITIAL-SCREEN                     DPKCS021
038400                                                                  DPKCS021
038500         WHEN DP020-NEXT-ACT-RETURN                               DPKCS021
038600             SET PS-SEND-MAP-N-DATA-FRSET                         DPKCS021
038700                                 TO TRUE                          DPKCS021
038800             PERFORM A470-SET-COMMAND-ATTRIBUTES                  DPKCS021
038900             PERFORM A200-PROCESS-INTER-APPL-COMM                 DPKCS021
039000             PERFORM A450-EDIT-SCREEN                             DPKCS021
039100             PERFORM A550-DISPLAY-PANEL                           DPKCS021
039200                                                                  DPKCS021
039300         WHEN DP020-NEXT-ACT-ERROR                                DPKCS021
039400             SET PS-SEND-DATA-ONLY-FRSET                          DPKCS021
039500                                 TO TRUE                          DPKCS021
039600             PERFORM A470-SET-COMMAND-ATTRIBUTES                  DPKCS021
039700             PERFORM A550-DISPLAY-PANEL                           DPKCS021
039800                                                                  DPKCS021
039900         WHEN DP020-NEXT-ACT-READ-MAP                             DPKCS021
040000             SET PS-SEND-DATA-ONLY-FRSET                          DPKCS021
040100                                 TO TRUE                          DPKCS021
040200             PERFORM A470-SET-COMMAND-ATTRIBUTES                  DPKCS021
040300             PERFORM A100-PROCESS-MAP                             DPKCS021
040400                                                                  DPKCS021
040500         WHEN OTHER                                               DPKCS021
040600             SET  DP013-OTHER-ABEND                               DPKCS021
040700                                 TO TRUE                          DPKCS021
040800             MOVE 'A050-CONTROL-PROCESSING       '                DPKCS021
040900                                 TO DP013-PARAGRAPH               DPKCS021
041000             MOVE INVALID-NEXT-APPL-MSG                           DPKCS021
041100                                 TO DP013-MESSAGE-TEXT (1)        DPKCS021
041200             MOVE DP020-NEXT-APPL-ACTIVITY                        DPKCS021
041300                                 TO DP013-MESSAGE-TEXT (2)        DPKCS021
041400             PERFORM DP013-0000-PROCESS-ABEND                     DPKCS021
041500                                                                  DPKCS021
041600     END-EVALUATE.                                                DPKCS021
041700 EJECT                                                            DPKCS021
041800******************************************************************DPKCS021
041900* A100-PROCESS-MAP                                               *DPKCS021
042000* (Z021-03 PROCESS-MAP)                                          *DPKCS021
042100******************************************************************DPKCS021
042200                                                                  DPKCS021
042300 A100-PROCESS-MAP.                                                DPKCS021
042400                                                                  DPKCS021
042500     IF  EIBAID  =  DFHPA2                                        DPKCS021
042600***************************************                           DPKCS021
042700* PA2 KEY  -  CHANGE PFKEYS DISPLAYED *                           DPKCS021
042800***************************************                           DPKCS021
042900         MOVE DP016-PA2          TO DP020-SRC-AID                 DPKCS021
043000         SET PS-SEND-DATA-ONLY                                    DPKCS021
043100                                 TO TRUE                          DPKCS021
043200         MOVE -1                 TO ANAVKEYL                      DPKCS021
043300         PERFORM DP009-0000-LOAD-FK-LINES                         DPKCS021
043400         PERFORM DP018-0000-GET-CURR-TIME                         DPKCS021
043500         PERFORM DP008-0000-WRITE-PANEL                           DPKCS021
043600     ELSE                                                         DPKCS021
043700       IF  EIBAID  =  DFHCLEAR                                    DPKCS021
043800           MOVE DP016-CLEAR      TO DP020-SRC-AID                 DPKCS021
043900           SET PS-SEND-MAP-N-DATA-FRSET                           DPKCS021
044000                                 TO TRUE                          DPKCS021
044100           MOVE DP015-PRO-NOR-OFF                                 DPKCS021
044200                                 TO AMNEMONA                      DPKCS021
044300                                    ATRANIDA                      DPKCS021
044400           MOVE DP015-BLUE       TO AMNEMONC                      DPKCS021
044500                                    ATRANIDC                      DPKCS021
044600           MOVE DP015-UNDERLINE  TO ASEQNUMH                      DPKCS021
044700                                    ATITTLEH                      DPKCS021
044800           MOVE -1               TO ANAVKEYL                      DPKCS021
044900           PERFORM A450-EDIT-SCREEN                               DPKCS021
045000           PERFORM A550-DISPLAY-PANEL                             DPKCS021
045100       ELSE                                                       DPKCS021
045200           PERFORM DP007-0000-GET-PANEL                           DPKCS021
045300           PERFORM A650-MOVE-SCREEN-TO-COMM                       DPKCS021
045400           IF  PS-NEW-MNEMONIC-ENTERED-NO                         DPKCS021
045500***************************************************************** DPKCS021
045600* THIS STRUCTURE WILL PREVENT THE PROGRAM FROM TRYING TO PROCESS* DPKCS021
045700* THE SCREEN CONTENTS IMMEDIATELY AFTER THE USER HAS ENTERED A  * DPKCS021
045800* NEW MNEMONIC ON THE SCREEN. IF THE USER HAS ENTERED A NEW     * DPKCS021
045900* MNEMONIC ON THE SCREEN, THE NEW-MNEMONIC-ENTERED-IND WILL BE  * DPKCS021
046000* SET TO 'Y' AND THE REST OF THIS MODULE WILL BE BYPASSED.      * DPKCS021
046100***************************************************************** DPKCS021
046200               PERFORM A200-PROCESS-INTER-APPL-COMM               DPKCS021
046300               PERFORM A300-CHECK-LOCAL-PF-KEYS                   DPKCS021
046400               IF  PS-LOCAL-FUNCTION-NO                           DPKCS021
046500                   PERFORM DP015-1000-START-NAVIGATOR             DPKCS021
046600               ELSE                                               DPKCS021
046700                   IF  ((DP020-SRC-AID  =  DP016-ENTER)    AND    DPKCS021
046800                        (DP020-NAV-MNEMONIC  NOT =  SPACES  AND   DPKCS021
046900                                                    LOW-VALUES))  DPKCS021
047000                       PERFORM DP015-1000-START-NAVIGATOR         DPKCS021
047100                   ELSE                                           DPKCS021
047200                       MOVE -1   TO ANAVKEYL                      DPKCS021
047300                       PERFORM A350-LOCAL-PF-KEY-CONTROL          DPKCS021
047400                   END-IF                                         DPKCS021
047500               END-IF                                             DPKCS021
047600           END-IF                                                 DPKCS021
047700       END-IF                                                     DPKCS021
047800     END-IF.                                                      DPKCS021
047900 EJECT                                                            DPKCS021
048000******************************************************************DPKCS021
048100* A200-PROCESS-INTER-APPL-COMM                                   *DPKCS021
048200* (Z021-05 PROCESS-INTER-APPL COMMAREA)                          *DPKCS021
048300* THE PURPOSE OF THIS MODULE IS TO MANIPULATE THE INTER-APPL-    *DPKCS021
048400* COMMAREA UNDER THE FOUR POSSIBLE CYCLES OF THIS TRANSACTION:   *DPKCS021
048500*                                                                *DPKCS021
048600*        1. DP020-NEXT-ACT-INITIAL                               *DPKCS021
048700*        2. DP020-NEXT-ACT-RETURN                                *DPKCS021
048800*        3. DP020-NEXT-ACT-READ-MAP                              *DPKCS021
048900*        4. DP020-NEXT-ACT-ERROR-RETURN                          *DPKCS021
049000*                                                                *DPKCS021
049100* THREE DATA AREAS ARE NEEDED TO CORRECTLY USE THE INTER-APPL-   *DPKCS021
049200* COMMAREA:                                                      *DPKCS021
049300*                                                                *DPKCS021
049400*        1. THE INTER-APPL-COMMAREA PORTION OF THE STANDARD-COMM-*DPKCS021
049500*           AREA                                                 *DPKCS021
049600*        2. AN AREA OF THE APPLICATION COMMAREA THAT WILL BE USED*DPKCS021
049700*           TO STORE THE CONTENTS OF THE INTER-APPL-COMMAREA SENT*DPKCS021
049800*           TO THIS PROGRAM. (NOTE: ONLY SAVE THOSE FIELDS       *DPKCS021
049900*           RELAVENT TO THIS PROGRAM).                           *DPKCS021
050000*        3. AN AREA OF THE APPLICATION COMMAREA THAT WILL BE USED*DPKCS021
050100*           TO HOLD THE DATA RELAVENT TO THE CURRENT OBJECT BEING*DPKCS021
050200*           PROCESSED BY THIS PROGRAM.                           *DPKCS021
050300******************************************************************DPKCS021
050400                                                                  DPKCS021
050500 A200-PROCESS-INTER-APPL-COMM.                                    DPKCS021
050600                                                                  DPKCS021
050700     IF  DP020-NEXT-ACT-INITIAL                                   DPKCS021
050800         MOVE INTER-APPL-COMM-AREA                                DPKCS021
050900                               TO  DP021-INTER-APPL-COMMAREA      DPKCS021
051000         MOVE DP055-MENU-NAME  TO  DP021-SCREEN-MENU-NAME         DPKCS021
051100         MOVE DP055-MNEMONIC   TO  DP021-SCREEN-MNEMONIC          DPKCS021
051200     ELSE                                                         DPKCS021
051300         IF  DP020-NEXT-ACT-RETURN                                DPKCS021
051400             MOVE DP021-INTER-APPL-COMMAREA                       DPKCS021
051500                               TO  INTER-APPL-COMM-AREA           DPKCS021
051600         ELSE                                                     DPKCS021
051700             IF  DP020-NEXT-ACT-READ-MAP                          DPKCS021
051800                 IF  DP020-FK-GO-TO-TRAN (DP020-SRC-AID)          DPKCS021
051900                     PERFORM A800-SETUP-INTER-APPL                DPKCS021
052000                 END-IF                                           DPKCS021
052100             END-IF                                               DPKCS021
052200         END-IF                                                   DPKCS021
052300     END-IF.                                                      DPKCS021
052400 EJECT                                                            DPKCS021
052500******************************************************************DPKCS021
052600* A250-SEND-INITIAL-SCREEN                                       *DPKCS021
052700* (Z021-06 SEND INITIAL SCREEN)                                  *DPKCS021
052800* RETRIEVE THE DATA FROM THE DATABASE, FORMAT DATA ON SCREEN, AND*DPKCS021
052900* DISPLAY THE SCREEN TO THE USER.                                *DPKCS021
053000******************************************************************DPKCS021
053100                                                                  DPKCS021
053200 A250-SEND-INITIAL-SCREEN.                                        DPKCS021
053300                                                                  DPKCS021
053400     PERFORM A500-RETRIEVE-DATA-FOR-SCREEN.                       DPKCS021
053500                                                                  DPKCS021
053600     IF  NOT DP020-NEXT-ACT-APPL-ERROR                            DPKCS021
053700         PERFORM A550-DISPLAY-PANEL                               DPKCS021
053800     END-IF.                                                      DPKCS021
053900 EJECT                                                            DPKCS021
054000******************************************************************DPKCS021
054100* A300-CHECK-LOCAL-PF-KEYS                                       *DPKCS021
054200* (Z021-09 CHECK FOR LOCAL PF KEYS)                              *DPKCS021
054300*                                                                *DPKCS021
054400* LOCAL FUNCTION KEYS:                                           *DPKCS021
054500*      PF5   (DP020-SRC-AID = 05)  - REFRESH SCREEN              *DPKCS021
054600*      PF15  (DP020-SRC-AID = 15)  - UPDATE TMNEMONIC TABLE      *DPKCS021
054700*      PA2   (DP020-SRC-AID = 26)  - TOGGLE THE FUNCTION KEY     *DPKCS021
054800*                                    LINES ON SCREEN             *DPKCS021
054900*      CLEAR (DP020-SRC-AID = 27)  - REFRESH SCREEN              *DPKCS021
055000*      ENTER (DP020-SRC-AID = 28)  - EDIT SCREEN                 *DPKCS021
055100******************************************************************DPKCS021
055200                                                                  DPKCS021
055300 A300-CHECK-LOCAL-PF-KEYS.                                        DPKCS021
055400                                                                  DPKCS021
055500     SET PS-LOCAL-FUNCTION-NO    TO TRUE.                         DPKCS021
055600                                                                  DPKCS021
055700     IF (DP020-FK-LOCAL-KEY (DP020-SRC-AID)  OR                   DPKCS021
055800         DP020-FK-CONFIRM (DP020-SRC-AID)    OR                   DPKCS021
055900         DP020-FK-REFRESH (DP020-SRC-AID)    OR                   DPKCS021
056000         DP020-FK-PREV-PAGE (DP020-SRC-AID)  OR                   DPKCS021
056100         DP020-FK-NEXT-PAGE (DP020-SRC-AID)  OR                   DPKCS021
056200         DP020-FK-FIRST-PAGE (DP020-SRC-AID) OR                   DPKCS021
056300         DP020-FK-DESELECT (DP020-SRC-AID))                       DPKCS021
056400         SET PS-LOCAL-FUNCTION-YES                                DPKCS021
056500                                 TO TRUE                          DPKCS021
056600     END-IF.                                                      DPKCS021
056700 EJECT                                                            DPKCS021
056800******************************************************************DPKCS021
056900* A350-LOCAL-PF-KEY-CONTROL                                      *DPKCS021
057000* (Z021-10 LOCAL PF KEY CONTROL)                                 *DPKCS021
057100******************************************************************DPKCS021
057200                                                                  DPKCS021
057300 A350-LOCAL-PF-KEY-CONTROL.                                       DPKCS021
057400                                                                  DPKCS021
057500     EVALUATE DP020-SRC-AID                                       DPKCS021
057600                                                                  DPKCS021
057700         WHEN  DP016-PF5                                          DPKCS021
057800             SET PS-SEND-MAP-N-DATA-FRSET                         DPKCS021
057900                                 TO TRUE                          DPKCS021
058000             PERFORM A250-SEND-INITIAL-SCREEN                     DPKCS021
058100                                                                  DPKCS021
058200         WHEN  DP016-PF15                                         DPKCS021
058300             SET PS-SEND-MAP-N-DATA-FRSET                         DPKCS021
058400                                 TO TRUE                          DPKCS021
058500             PERFORM A450-EDIT-SCREEN                             DPKCS021
058600             IF  PS-EDIT-ERROR-NO                                 DPKCS021
058700               IF (DP021-A-MENU-TRAN                              DPKCS021
058800                    AND                                           DPKCS021
058900                  (DP021-SCREEN-MNEMONIC NOT EQUAL SPACES AND     DPKCS021
059000                                                   LOW-VALUES))   DPKCS021
059100                 PERFORM A400-PROCESS-UPDATE                      DPKCS021
059200                 PERFORM A550-DISPLAY-PANEL                       DPKCS021
059300               ELSE                                               DPKCS021
059400                 SET DP020-MSG-WARNING   TO TRUE                  DPKCS021
059500                 MOVE PC-TSYMSG-00057    TO DP020-MSG-NUMBER      DPKCS021
059600                 SET DP020-NEXT-ACT-APPL-ERROR                    DPKCS021
059700                                         TO  TRUE                 DPKCS021
059800                 PERFORM DP015-1000-START-NAVIGATOR               DPKCS021
059900               END-IF                                             DPKCS021
060000             END-IF                                               DPKCS021
060100                                                                  DPKCS021
060200         WHEN  DP016-PA2                                          DPKCS021
060300             SET PS-SEND-DATA-ONLY-FRSET                          DPKCS021
060400                                 TO TRUE                          DPKCS021
060500             PERFORM DP009-0000-LOAD-FK-LINES                     DPKCS021
060600             PERFORM DP018-0000-GET-CURR-TIME                     DPKCS021
060700             PERFORM DP008-0000-WRITE-PANEL                       DPKCS021
060800                                                                  DPKCS021
060900         WHEN  DP016-CLEAR                                        DPKCS021
061000             SET PS-SEND-DATA-ONLY-FRSET                          DPKCS021
061100                                 TO TRUE                          DPKCS021
061200             MOVE DP015-PRO-NOR-OFF                               DPKCS021
061300                                 TO AMNEMONA                      DPKCS021
061400                                    ATRANIDA                      DPKCS021
061500             MOVE DP015-BLUE     TO AMNEMONC                      DPKCS021
061600                                    ATRANIDC                      DPKCS021
061700             MOVE DP015-UNDERLINE                                 DPKCS021
061800                                 TO ASEQNUMH                      DPKCS021
061900                                    ATITTLEH                      DPKCS021
062000             PERFORM A550-DISPLAY-PANEL                           DPKCS021
062100                                                                  DPKCS021
062200         WHEN OTHER                                               DPKCS021
062300             PERFORM A450-EDIT-SCREEN                             DPKCS021
062400             PERFORM A550-DISPLAY-PANEL                           DPKCS021
062500                                                                  DPKCS021
062600     END-EVALUATE.                                                DPKCS021
062700 EJECT                                                            DPKCS021
062800******************************************************************DPKCS021
062900* A400-PROCESS-UPDATE                                            *DPKCS021
063000* (Z021-12 PROCESS UPDATE TO DATABASE)                           *DPKCS021
063100* ALL DB2 DATABASE MAINTENANCE USES 'TIMESTAMP' VALIDATION SYNTAX*DPKCS021
063200* TO ENSURE THAT THE SET OF DATA BEING UPDATED IS IN THE SAME    *DPKCS021
063300* CONDITION AT THE TIME OF UPDATE THAT IT WAS IN WHEN THE SET OF *DPKCS021
063400* DATA WAS RETRIEVED FROM THE DATABASE FOR PROCESSING. THIS IS A *DPKCS021
063500* RECOGNITION OF THE POTENTIAL FOR CONCURRENT UPDATING ON ALL    *DPKCS021
063600* RELATIONS WITHIN THE DB2 ENVIRONMENT.                          *DPKCS021
063700******************************************************************DPKCS021
063800                                                                  DPKCS021
063900 A400-PROCESS-UPDATE.                                             DPKCS021
064000                                                                  DPKCS021
064100     MOVE DP021-SCREEN-MENU-NAME TO TMENUITEM-MENU-NAME.          DPKCS021
064200     MOVE DP021-SCREEN-MNEMONIC  TO TMENUITEM-ITEM-MNEMONIC-CODE. DPKCS021
064300     MOVE DP021-SCREEN-FORMAT    TO TMENUITEM-IN-APLCTN-COMM-CDE. DPKCS021
064400     MOVE DP021-SCREEN-SEQUENCE-NUMBER                            DPKCS021
064500                                 TO PV-SEQUENCE-NUMBER-ALPHA.     DPKCS021
064600     MOVE PV-SEQUENCE-NUMBER-NUMERIC                              DPKCS021
064700                                 TO TMENUITEM-SEQUENCE-NMBR.      DPKCS021
064800     MOVE DP021-TIMESTAMP        TO TMENUITEM-LAST-UPDATE-TMESTP. DPKCS021
064900     IF  PV-DESC-NOT-NULL                                         DPKCS021
065000         MOVE DP021-SCREEN-MENU-ITEM-TITLE                        DPKCS021
065100                                 TO TMENUITEM-DESC                DPKCS021
065200     END-IF.                                                      DPKCS021
065300                                                                  DPKCS021
065400     PERFORM X940-UPDATE-TMENUITEM-ROW.                           DPKCS021
065500     PERFORM X980-UPDT-TMNEMONIC-ROW.                             DPKCS021
065600                                                                  DPKCS021
065700     MOVE PC-TSYMSG-00059        TO DP020-MSG-NUMBER.             DPKCS021
065800     MOVE DP015-PRO-NOR-OFF      TO ATRANIDA.                     DPKCS021
065900     MOVE DP015-BLUE             TO ATRANIDC.                     DPKCS021
066000     MOVE DP015-PRO-NOR-OFF      TO AMNEMONA.                     DPKCS021
066100     MOVE DP015-BLUE             TO AMNEMONC.                     DPKCS021
066200     SET DP020-MSG-INFORMATIONAL                                  DPKCS021
066300                                 TO TRUE.                         DPKCS021
066400                                                                  DPKCS021
066500     MOVE 2                      TO DP021-SELECT-MAINT-RESULT     DPKCS021
066600     SET DP055-UPDATED           TO  TRUE.                        DPKCS021
066700                                                                  DPKCS021
066800     PERFORM X930-READ-TMENUITEM-ROW.                             DPKCS021
066900     IF  SQL-ROW-FOUND                                            DPKCS021
067000         MOVE TMENUITEM-LAST-UPDATE-TMESTP                        DPKCS021
067100                                 TO DP021-TIMESTAMP               DPKCS021
067200     END-IF.                                                      DPKCS021
067300                                                                  DPKCS021
067400 EJECT                                                            DPKCS021
067500******************************************************************DPKCS021
067600* A450-EDIT-SCREEN                                               *DPKCS021
067700* (Z021-11 EDIT SCREEN)                                          *DPKCS021
067800* EDITS WILL OCCUR FROM THE BOTTOM OF THE SCREEN TO THE TOP      *DPKCS021
067900******************************************************************DPKCS021
068000                                                                  DPKCS021
068100 A450-EDIT-SCREEN.                                                DPKCS021
068200                                                                  DPKCS021
068300     SET PS-EDIT-ERROR-NO        TO TRUE.                         DPKCS021
068400                                                                  DPKCS021
068500**********************************************                    DPKCS021
068600* VALIDATE SCREEN FORMAT CODE                *                    DPKCS021
068700* FROM THE APPLICATION SPECIFIC COMMAREA     *                    DPKCS021
068800**********************************************                    DPKCS021
068900                                                                  DPKCS021
069000     MOVE DP015-GREEN           TO AFORMATC.                      DPKCS021
069100     MOVE DP015-UNDERLINE       TO AFORMATH.                      DPKCS021
069200     IF  DP021-SCREEN-FORMAT > SPACES                             DPKCS021
069300         SET PS-NO-WARNING      TO TRUE                           DPKCS021
069400         PERFORM X960-READ-TCICSROUTE-ROW                         DPKCS021
069500         PERFORM X970-READ-TMENUITEM-ROW                          DPKCS021
069600         IF  PS-WARNING                                           DPKCS021
069700             MOVE PC-TSYMSG-00259                                 DPKCS021
069800                                TO  DP020-MSG-NUMBER              DPKCS021
069900             SET  DP020-MSG-WARNING TO TRUE                       DPKCS021
070000             MOVE -1 TO AFORMATL                                  DPKCS021
070100             MOVE DP015-YELLOW  TO AFORMATC                       DPKCS021
070200             MOVE DP015-REVERSE TO AFORMATH                       DPKCS021
070300         END-IF                                                   DPKCS021
070400     END-IF.                                                      DPKCS021
070500                                                                  DPKCS021
070600**********************************************                    DPKCS021
070700* VALIDATE SCREEN SEQUENCE NUMBER            *                    DPKCS021
070800* FROM THE APPLICATION SPECIFIC COMMAREA     *                    DPKCS021
070900**********************************************                    DPKCS021
071000                                                                  DPKCS021
071100     EXEC CICS                                                    DPKCS021
071200         BIF                                                      DPKCS021
071300           DEEDIT FIELD (DP021-SCREEN-SEQUENCE-NUMBER)            DPKCS021
071400                 LENGTH (4)                                       DPKCS021
071500     END-EXEC                                                     DPKCS021
071600     IF  ( DP021-SCREEN-MENU-NAME = SPACES OR LOW-VALUES )        DPKCS021
071700         MOVE DP015-PRO-NOR-OFF                                   DPKCS021
071800                                 TO AMNEMONA                      DPKCS021
071900         MOVE DP015-BLUE         TO AMNEMONC                      DPKCS021
072000         MOVE 0                  TO AMNEMONL                      DPKCS021
072100         MOVE DP015-PRO-NOR-OFF  TO ATRANIDA                      DPKCS021
072200         MOVE DP015-BLUE         TO ATRANIDC                      DPKCS021
072300         MOVE 0                  TO ATRANIDL                      DPKCS021
072400         MOVE DP015-PRO-NOR-OFF  TO ATITTLEA                      DPKCS021
072500         MOVE DP015-BLUE         TO ATITTLEC                      DPKCS021
072600         MOVE DP015-HL-OFF       TO ATITTLEH                      DPKCS021
072700         MOVE 0                  TO ATITTLEL                      DPKCS021
072800         MOVE DP015-PRO-NOR-OFF  TO ASEQNUMA                      DPKCS021
072900         MOVE DP015-BLUE         TO ASEQNUMC                      DPKCS021
073000         MOVE DP015-HL-OFF       TO ASEQNUMH                      DPKCS021
073100         MOVE 0                  TO ASEQNUML                      DPKCS021
073200         MOVE PC-TSYMSG-00148    TO DP020-MSG-NUMBER              DPKCS021
073300         MOVE -1                 TO ANAVCMDL                      DPKCS021
073400     ELSE                                                         DPKCS021
073500         IF  (  DP021-SCREEN-MNEMONIC = SPACES OR LOW-VALUES  )   DPKCS021
073600             SET DP020-MSG-WARNING TO TRUE                        DPKCS021
073700             MOVE PC-TSYMSG-00057  TO DP020-MSG-NUMBER            DPKCS021
073800             SET DP020-NEXT-ACT-APPL-ERROR                        DPKCS021
073900                                 TO TRUE                          DPKCS021
074000             PERFORM DP015-1000-START-NAVIGATOR                   DPKCS021
074100         ELSE                                                     DPKCS021
074200         IF  DP021-SCREEN-SEQUENCE-NUMBER  NUMERIC                DPKCS021
074300             IF  DP021-SCREEN-SEQUENCE-NUMBER  >  ZEROS           DPKCS021
074400                 MOVE DP021-SCREEN-MENU-NAME                      DPKCS021
074500                                 TO TMENUITEM-MENU-NAME           DPKCS021
074600                 MOVE DP021-SCREEN-MNEMONIC                       DPKCS021
074700                                 TO TMENUITEM-ITEM-MNEMONIC-CODE  DPKCS021
074800                 MOVE DP021-SCREEN-SEQUENCE-NUMBER                DPKCS021
074900                                 TO PV-SEQUENCE-NUMBER-ALPHA      DPKCS021
075000                 MOVE PV-SEQUENCE-NUMBER-NUMERIC                  DPKCS021
075100                                 TO TMENUITEM-SEQUENCE-NMBR       DPKCS021
075200                 PERFORM X950-READ-TMENUITEM-ROW                  DPKCS021
075300                 IF  (   SQL-ROW-FOUND                            DPKCS021
075400                     OR  SQL-MORE-THAN-1-ROW                      DPKCS021
075500                     )                                            DPKCS021
075600                     SET PS-EDIT-ERROR-YES                        DPKCS021
075700                                 TO TRUE                          DPKCS021
075800                     MOVE PC-TSYMSG-00268                         DPKCS021
075900                                 TO DP020-MSG-NUMBER              DPKCS021
076000                     SET DP020-MSG-FATAL                          DPKCS021
076100                                 TO TRUE                          DPKCS021
076200                     MOVE -1     TO ASEQNUML                      DPKCS021
076300                     MOVE DP015-UNP-ALP-BRT-OFF                   DPKCS021
076400                                 TO ASEQNUMA                      DPKCS021
076500                     MOVE DP015-RED TO ASEQNUMC                   DPKCS021
076600                     MOVE DP015-REVERSE TO ASEQNUMH               DPKCS021
076700                 ELSE                                             DPKCS021
076800                     MOVE DP015-UNP-ALP-NOR-OFF                   DPKCS021
076900                                 TO ASEQNUMA                      DPKCS021
077000                     MOVE DP015-UNDERLINE                         DPKCS021
077100                                 TO ASEQNUMH                      DPKCS021
077200                     MOVE DP015-GREEN                             DPKCS021
077300                                 TO ASEQNUMC                      DPKCS021
077400                 END-IF                                           DPKCS021
077500             ELSE                                                 DPKCS021
077600                 SET PS-EDIT-ERROR-YES TO TRUE                    DPKCS021
077700                 MOVE PC-TSYMSG-00005  TO DP020-MSG-NUMBER        DPKCS021
077800                 SET DP020-MSG-FATAL   TO TRUE                    DPKCS021
077900                 MOVE -1               TO ASEQNUML                DPKCS021
078000                 MOVE DP015-UNP-ALP-BRT-OFF                       DPKCS021
078100                                       TO ASEQNUMA                DPKCS021
078200                 MOVE DP015-RED        TO ASEQNUMC                DPKCS021
078300                 MOVE DP015-REVERSE    TO ASEQNUMH                DPKCS021
078400             END-IF                                               DPKCS021
078500         ELSE                                                     DPKCS021
078600             SET PS-EDIT-ERROR-YES   TO TRUE                      DPKCS021
078700             MOVE PC-TSYMSG-00008                                 DPKCS021
078800                                 TO DP020-MSG-NUMBER              DPKCS021
078900             SET DP020-MSG-FATAL     TO TRUE                      DPKCS021
079000             MOVE -1                 TO ASEQNUML                  DPKCS021
079100             MOVE DP015-UNP-ALP-BRT-OFF                           DPKCS021
079200                                 TO ASEQNUMA                      DPKCS021
079300             MOVE DP015-RED          TO ASEQNUMC                  DPKCS021
079400             MOVE DP015-REVERSE      TO ASEQNUMH                  DPKCS021
079500         END-IF                                                   DPKCS021
079600**********************************************                    DPKCS021
079700* VALIDATE SCREEN MENU ITEM TITLE            *                    DPKCS021
079800* FROM THE APPLICATION SPECIFIC COMMAREA     *                    DPKCS021
079900*        (NO VALIDATION NECCESSARY)          *                    DPKCS021
080000**********************************************                    DPKCS021
080100                                                                  DPKCS021
080200         MOVE DP015-UNP-ALP-NOR-OFF  TO ATITTLEA                  DPKCS021
080300         MOVE DP015-UNDERLINE        TO ATITTLEH                  DPKCS021
080400         MOVE DP015-GREEN            TO ATITTLEC                  DPKCS021
080500                                                                  DPKCS021
080600         IF  PS-EDIT-ERROR-NO                                     DPKCS021
080700             MOVE -1                 TO ANAVKEYL                  DPKCS021
080800         END-IF                                                   DPKCS021
080900     END-IF.                                                      DPKCS021
081000 EJECT                                                            DPKCS021
081100***************************************************************** DPKCS021
081200*     EVERY TIME IN SET THE COMMAND FIELD TO EITHER RED         * DPKCS021
081300*     OR GREEN. THIS IS BECAUSE IT IS UNEDITTED IN THE          * DPKCS021
081400*     PROGRAM AND IT NEEDS RESETTING.                           * DPKCS021
081500***************************************************************** DPKCS021
081600 A470-SET-COMMAND-ATTRIBUTES.                                     DPKCS021
081700     IF DP020-NEXT-ACT-ERROR                                      DPKCS021
081800         IF DP020-NAV-MNEMONIC NOT EQUAL TO SPACES                DPKCS021
081900             MOVE DP015-UNP-ALP-BRT-MDT                           DPKCS021
082000                                 TO ANAVCMDA                      DPKCS021
082100             MOVE DP015-RED                                       DPKCS021
082200                                 TO ANAVCMDC                      DPKCS021
082300             MOVE DP015-REVERSE                                   DPKCS021
082400                                 TO ANAVCMDH                      DPKCS021
082500         ELSE                                                     DPKCS021
082600             MOVE SPACES         TO ANAVCMDO                      DPKCS021
082700                                    DP020-NAV-MNEMONIC            DPKCS021
082800             MOVE DP015-UNP-ALP-NOR-OFF                           DPKCS021
082900                                 TO ANAVCMDA                      DPKCS021
083000             MOVE DP015-GREEN                                     DPKCS021
083100                                 TO ANAVCMDC                      DPKCS021
083200             MOVE DP015-UNDERLINE                                 DPKCS021
083300                                 TO ANAVCMDH                      DPKCS021
083400         END-IF                                                   DPKCS021
083500     ELSE                                                         DPKCS021
083600         IF (EIBAID NOT EQUAL TO DFHPA2 AND                       DPKCS021
083700                                 DFHCLEAR)                        DPKCS021
083800             MOVE DP015-UNP-ALP-NOR-OFF                           DPKCS021
083900                                 TO ANAVCMDA                      DPKCS021
084000             MOVE DP015-GREEN                                     DPKCS021
084100                                 TO ANAVCMDC                      DPKCS021
084200             MOVE DP015-UNDERLINE                                 DPKCS021
084300                                 TO ANAVCMDH                      DPKCS021
084400         END-IF                                                   DPKCS021
084500     END-IF.                                                      DPKCS021
084600 EJECT                                                            DPKCS021
084700******************************************************************DPKCS021
084800* A500-RETRIEVE-DATA-FOR-SCREEN                                  *DPKCS021
084900* (Z021-07 RETRIEVE DATA FOR SCREEN                              *DPKCS021
085000******************************************************************DPKCS021
085100                                                                  DPKCS021
085200 A500-RETRIEVE-DATA-FOR-SCREEN.                                   DPKCS021
085300                                                                  DPKCS021
085400     MOVE DP021-SCREEN-MENU-NAME TO TMENUITEM-MENU-NAME.          DPKCS021
085500     MOVE DP021-SCREEN-MNEMONIC  TO TMENUITEM-ITEM-MNEMONIC-CODE. DPKCS021
085600                                                                  DPKCS021
085700     SET DP021-A-NON-MENU-TRAN   TO TRUE.                         DPKCS021
085800     PERFORM X910-READ-TMNEMONIC-ROW.                             DPKCS021
085900                                                                  DPKCS021
086000     IF  SQL-ROW-FOUND                                            DPKCS021
086100         MOVE TMNEMONIC-PANEL-TITLE-NAME                          DPKCS021
086200                                   TO DP021-SCREEN-MENU-TITLE     DPKCS021
086300         IF TMNEMONIC-TRANS-ID-CODE = PV-MENU-TRAN                DPKCS021
086400             SET DP021-A-MENU-TRAN TO TRUE                        DPKCS021
086500             PERFORM X900-READ-TMENUITEM-ROW                      DPKCS021
086600             IF  SQL-ROW-FOUND                                    DPKCS021
086700                 MOVE TMENUITEM-ITEM-MNEMONIC-CODE                DPKCS021
086800                                 TO TMNEMONIC-MNEMONIC-CODE       DPKCS021
086900                 MOVE TMENUITEM-IN-APLCTN-COMM-CDE                DPKCS021
087000                                 TO DP021-SCREEN-FORMAT           DPKCS021
087100                 IF  PV-DESC-NULL                                 DPKCS021
087200                     MOVE LOW-VALUES                              DPKCS021
087300                                 TO DP021-SCREEN-MENU-ITEM-TITLE  DPKCS021
087400                 ELSE                                             DPKCS021
087500                     MOVE TMENUITEM-DESC                          DPKCS021
087600                                 TO DP021-SCREEN-MENU-ITEM-TITLE  DPKCS021
087700                 END-IF                                           DPKCS021
087800                                                                  DPKCS021
087900                 PERFORM X920-READ-TMNEMONIC-ROW                  DPKCS021
088000                 IF  SQL-ROW-FOUND                                DPKCS021
088100                     MOVE TMNEMONIC-TRANS-ID-CODE                 DPKCS021
088200                                 TO DP021-SCREEN-TRAN-ID          DPKCS021
088300                     MOVE TMNEMONIC-PANEL-TITLE-NAME              DPKCS021
088400                                 TO DP021-SCREEN-PANEL-TITLE-NAME DPKCS021
088500                 ELSE                                             DPKCS021
088600                     MOVE LOW-VALUES TO DP021-SCREEN-TRAN-ID      DPKCS021
088700                     MOVE DP015-PRO-NOR-OFF                       DPKCS021
088800                                 TO ATRANIDA                      DPKCS021
088900                     MOVE DP015-BLUE     TO ATRANIDC              DPKCS021
089000                 END-IF                                           DPKCS021
089100                                                                  DPKCS021
089200                 MOVE DP015-UNP-ALP-NOR-OFF                       DPKCS021
089300                                 TO ATITTLEA                      DPKCS021
089400                 MOVE DP015-UNDERLINE    TO ATITTLEH              DPKCS021
089500                 MOVE DP015-GREEN        TO ATITTLEC              DPKCS021
089600                 MOVE TMENUITEM-SEQUENCE-NMBR                     DPKCS021
089700                                 TO PV-SEQUENCE-NUMBER-NUMERIC    DPKCS021
089800                 MOVE PV-SEQUENCE-NUMBER-ALPHA                    DPKCS021
089900                                 TO DP021-SCREEN-SEQUENCE-NUMBER  DPKCS021
090000                 MOVE DP015-UNP-ALP-NOR-OFF                       DPKCS021
090100                                 TO ASEQNUMA                      DPKCS021
090200                 MOVE DP015-UNDERLINE    TO ASEQNUMH              DPKCS021
090300                 MOVE DP015-GREEN        TO ASEQNUMC              DPKCS021
090400                 MOVE TMENUITEM-LAST-UPDATE-TMESTP                DPKCS021
090500                                 TO DP021-TIMESTAMP               DPKCS021
090600                 SET PS-ROW-FOUND-YES    TO TRUE                  DPKCS021
090700                 MOVE -1         TO ASEQNUML                      DPKCS021
090800             ELSE                                                 DPKCS021
090900                 INITIALIZE DP021-SCREEN-TRAN-ID                  DPKCS021
091000                            DP021-SCREEN-PANEL-TITLE-NAME         DPKCS021
091100                            DP021-SCREEN-MNEMONIC                 DPKCS021
091200                            DP021-SCREEN-MENU-ITEM-TITLE          DPKCS021
091300                            DP021-SCREEN-SEQUENCE-NUMBER          DPKCS021
091400                 SET PS-ROW-FOUND-NO     TO TRUE                  DPKCS021
091500                 IF  TMENUITEM-ITEM-MNEMONIC-CODE = SPACES        DPKCS021
091600                     MOVE PC-TSYMSG-00057  TO DP020-MSG-NUMBER    DPKCS021
091700                     SET DP020-MSG-WARNING TO TRUE                DPKCS021
091800                     SET DP020-NEXT-ACT-APPL-ERROR                DPKCS021
091900                                     TO TRUE                      DPKCS021
092000                     PERFORM DP015-1000-START-NAVIGATOR           DPKCS021
092100                 ELSE                                             DPKCS021
092200                     MOVE PC-TSYMSG-00148  TO DP020-MSG-NUMBER    DPKCS021
092300                     SET DP020-MSG-FATAL   TO TRUE                DPKCS021
092400                     SET DP020-NEXT-ACT-APPL-ERROR                DPKCS021
092500                                     TO TRUE                      DPKCS021
092600                     PERFORM DP015-1000-START-NAVIGATOR           DPKCS021
092700                 END-IF                                           DPKCS021
092800                 SET DP020-MSG-FATAL TO TRUE                      DPKCS021
092900             END-IF                                               DPKCS021
093000         ELSE                                                     DPKCS021
093100             INITIALIZE DP021-SCREEN-TRAN-ID                      DPKCS021
093200                        DP021-SCREEN-PANEL-TITLE-NAME             DPKCS021
093300                        DP021-SCREEN-MNEMONIC                     DPKCS021
093400                        DP021-SCREEN-MENU-ITEM-TITLE              DPKCS021
093500                        DP021-SCREEN-SEQUENCE-NUMBER              DPKCS021
093600             SET PS-ROW-FOUND-NO     TO TRUE                      DPKCS021
093700             MOVE PC-TSYMSG-00266    TO DP020-MSG-NUMBER          DPKCS021
093800             SET DP020-MSG-FATAL     TO TRUE                      DPKCS021
093900             MOVE -1                 TO ANAVCMDL                  DPKCS021
094000         END-IF                                                   DPKCS021
094100     ELSE                                                         DPKCS021
094200         INITIALIZE DP021-SCREEN-TRAN-ID                          DPKCS021
094300                    DP021-SCREEN-PANEL-TITLE-NAME                 DPKCS021
094400                    DP021-SCREEN-MENU-TITLE                       DPKCS021
094500                    DP021-SCREEN-MNEMONIC                         DPKCS021
094600                    DP021-SCREEN-MENU-ITEM-TITLE                  DPKCS021
094700                    DP021-SCREEN-SEQUENCE-NUMBER                  DPKCS021
094800         SET PS-ROW-FOUND-NO       TO TRUE                        DPKCS021
094900         MOVE PC-TSYMSG-00148     TO DP020-MSG-NUMBER             DPKCS021
095000         SET DP020-MSG-FATAL       TO TRUE                        DPKCS021
095100         MOVE -1                   TO ANAVKEYL                    DPKCS021
095200     END-IF.                                                      DPKCS021
095300 EJECT                                                            DPKCS021
095400******************************************************************DPKCS021
095500* A550-DISPLAY-PANEL                                             *DPKCS021
095600* (Z021-02 DISPLAY PANEL)                                        *DPKCS021
095700******************************************************************DPKCS021
095800                                                                  DPKCS021
095900 A550-DISPLAY-PANEL.                                              DPKCS021
096000                                                                  DPKCS021
096100     IF  PS-SEND-DATA-ONLY-FRSET                                  DPKCS021
096200         PERFORM DP018-0000-GET-CURR-TIME                         DPKCS021
096300     ELSE                                                         DPKCS021
096400         PERFORM DP017-0000-GET-CURR-DATE-TIME                    DPKCS021
096500         PERFORM DP002-0000-FORMAT-TITLE-LINES                    DPKCS021
096600     END-IF.                                                      DPKCS021
096700                                                                  DPKCS021
096800     IF  PS-SEND-MAP-N-DATA-FRSET    OR                           DPKCS021
096900         PS-NEW-MNEMONIC-ENTERED-YES                              DPKCS021
097000         PERFORM A600-LOAD-DETAIL-DATA                            DPKCS021
097100     END-IF.                                                      DPKCS021
097200                                                                  DPKCS021
097300     PERFORM DP005-0000-FORMAT-MSG-LINES.                         DPKCS021
097400                                                                  DPKCS021
097500     IF PS-SEND-MAP-N-DATA-FRSET    OR                            DPKCS021
097600        DP020-SRC-AID  =  DP016-PA2                               DPKCS021
097700***************************************                           DPKCS021
097800* PA2 KEY  -  CHANGE PFKEYS DISPLAYED *                           DPKCS021
097900***************************************                           DPKCS021
098000        PERFORM DP009-0000-LOAD-FK-LINES                          DPKCS021
098100     END-IF.                                                      DPKCS021
098200                                                                  DPKCS021
098300     PERFORM DP008-0000-WRITE-PANEL.                              DPKCS021
098400 EJECT                                                            DPKCS021
098500******************************************************************DPKCS021
098600* A600-LOAD-DETAIL-DATA                                          *DPKCS021
098700* (Z021-08 LOAD DETAIL DATA)                                     *DPKCS021
098800******************************************************************DPKCS021
098900                                                                  DPKCS021
099000 A600-LOAD-DETAIL-DATA.                                           DPKCS021
099100                                                                  DPKCS021
099200     MOVE DP021-SCREEN-MNEMONIC  TO AMNEMONO                      DPKCS021
099300     MOVE DP021-SCREEN-TRAN-ID   TO ATRANIDO.                     DPKCS021
099400     MOVE DP021-SCREEN-PANEL-TITLE-NAME                           DPKCS021
099500                                 TO APANELO.                      DPKCS021
099600     MOVE DP021-SCREEN-MENU-ITEM-TITLE                            DPKCS021
099700                                 TO ATITTLEO.                     DPKCS021
099800     MOVE DP021-SCREEN-SEQUENCE-NUMBER                            DPKCS021
099900                                 TO ASEQNUMO.                     DPKCS021
100000     MOVE DP021-SCREEN-MENU-NAME TO AMNUNAMO.                     DPKCS021
100100     MOVE DP021-SCREEN-MENU-TITLE                                 DPKCS021
100200                                 TO AMNUTTLO.                     DPKCS021
100300     MOVE DP021-SCREEN-FORMAT    TO AFORMATO.                     DPKCS021
100400 EJECT                                                            DPKCS021
100500******************************************************************DPKCS021
100600* A650-MOVE-SCREEN-TO-COMM                                       *DPKCS021
100700* (Z021-13 MOVE SCREEN TO COMMAREA)                              *DPKCS021
100800* IN ORDER TO MINIMIZE DATA TRANSMISSIONS, ALL SCREEN VARIABLES  *DPKCS021
100900* WILL BE STORED IN THE COMMAREA. ALL EDITING AND DATABASE I/O   *DPKCS021
101000* WILL BE FROM THESE FIELDS IN THE APPLICATION SPECIFIC COMMAREA.*DPKCS021
101100* ONLY ATTRIBUTE CHANGES WILL BE SENT TO THE TERMINAL AS LONG AS *DPKCS021
101200* THE CURRENT MAP IS STILL BEING DISPLAYED. THIS MODULE OVERLAYS *DPKCS021
101300* ANY COMMAREA SCREEN VARIABLE THAT HAS CHANGED (EITHER A LENGTH *DPKCS021
101400* GREATER THAN ZERO OR EOF HAS BEEN PRESSED) WITH THE INPUT FIELD*DPKCS021
101500* FROM THE SCREEN.                                               *DPKCS021
101600******************************************************************DPKCS021
101700                                                                  DPKCS021
101800 A650-MOVE-SCREEN-TO-COMM.                                        DPKCS021
101900                                                                  DPKCS021
102000     SET PS-NEW-MNEMONIC-ENTERED-NO                               DPKCS021
102100                                 TO TRUE                          DPKCS021
102200                                                                  DPKCS021
102300     IF  (    DP020-FK-REFRESH (DP020-SRC-AID)                    DPKCS021
102400         OR   DP020-SRC-AID  =  DP016-CLEAR                       DPKCS021
102500         )                                                        DPKCS021
102600         CONTINUE                                                 DPKCS021
102700     ELSE                                                         DPKCS021
102800         IF  (    ANAVKEYL       >  ZEROS                         DPKCS021
102900             AND  ANAVCMDL       =  ZEROS                         DPKCS021
103000             AND  DP020-SRC-AID  =  DP016-ENTER                   DPKCS021
103100             )                                                    DPKCS021
103200             SET PS-NEW-MNEMONIC-ENTERED-YES                      DPKCS021
103300                                   TO TRUE                        DPKCS021
103400             MOVE ANAVKEYI         TO PV-MNEMONIC                 DPKCS021
103500                                      DP021-SCREEN-MNEMONIC       DPKCS021
103600             MOVE LOW-VALUES       TO ANAVKEYO                    DPKCS021
103700             MOVE SPACES           TO                             DPKCS021
103800                  DP021-SELECT-MAINT-RESULT                       DPKCS021
103900             SET PS-SEND-MAP-N-DATA-FRSET                         DPKCS021
104000                                   TO TRUE                        DPKCS021
104100             PERFORM A250-SEND-INITIAL-SCREEN                     DPKCS021
104200         ELSE                                                     DPKCS021
104300             SET PV-DESC-NOT-NULL  TO TRUE                        DPKCS021
104400             IF  ATITTLEL  >  ZERO                                DPKCS021
104500                 MOVE ATITTLEI   TO DP021-SCREEN-MENU-ITEM-TITLE  DPKCS021
104600             ELSE                                                 DPKCS021
104700                 IF  (   ATITTLEF  =  PC-HEX-VALUE-80             DPKCS021
104800                     OR  (  DP021-SCREEN-MENU-ITEM-TITLE          DPKCS021
104900                                     =    SPACES                  DPKCS021
105000                                     OR   LOW-VALUES              DPKCS021
105100                         )                                        DPKCS021
105200                     )                                            DPKCS021
105300                     MOVE SPACES TO DP021-SCREEN-MENU-ITEM-TITLE  DPKCS021
105400                     SET PV-DESC-NULL TO TRUE                     DPKCS021
105500                 END-IF                                           DPKCS021
105600             END-IF                                               DPKCS021
105700                                                                  DPKCS021
105800             IF  ASEQNUML  >  ZERO                                DPKCS021
105900                 MOVE ASEQNUMI TO DP021-SCREEN-SEQUENCE-NUMBER    DPKCS021
106000             ELSE                                                 DPKCS021
106100                 IF  ASEQNUMF  =  PC-HEX-VALUE-80                 DPKCS021
106200                     MOVE ZEROS TO DP021-SCREEN-SEQUENCE-NUMBER   DPKCS021
106300                 END-IF                                           DPKCS021
106400             END-IF                                               DPKCS021
106500                                                                  DPKCS021
106600             IF  AFORMATL  >  ZERO                                DPKCS021
106700                 MOVE AFORMATI TO DP021-SCREEN-FORMAT             DPKCS021
106800             ELSE                                                 DPKCS021
106900                 IF  AFORMATF  =  PC-HEX-VALUE-80                 DPKCS021
107000                     MOVE SPACE TO DP021-SCREEN-FORMAT            DPKCS021
107100                 END-IF                                           DPKCS021
107200             END-IF                                               DPKCS021
107300                                                                  DPKCS021
107400             IF  APANELL  >  ZERO                                 DPKCS021
107500                 MOVE APANELI TO DP021-SCREEN-PANEL-TITLE-NAME    DPKCS021
107600             END-IF                                               DPKCS021
107700         END-IF                                                   DPKCS021
107800     END-IF.                                                      DPKCS021
107900                                                                  DPKCS021
108000 EJECT                                                            DPKCS021
108100******************************************************************DPKCS021
108200* A800-SETUP-INTER-APPL                                          *DPKCS021
108300* (Z021-16 SETUP INTER-APPL)                                     *DPKCS021
108400*                                                                *DPKCS021
108500* WHENEVER THIS TRANSACTION IS ABOUT TO NAVIGATE TO ANOTHER      *DPKCS021
108600* TRANSACTION, THIS MODULE WILL FORMAT THE INTER APPLICATION     *DPKCS021
108700* COMMAREA WITH THE DATA SAVED FOR THE CURRENT OBJECT BEING PRO- *DPKCS021
108800* CESSED BY THIS TRANSACTION.                                    *DPKCS021
108900******************************************************************DPKCS021
109000                                                                  DPKCS021
109100 A800-SETUP-INTER-APPL.                                           DPKCS021
109200                                                                  DPKCS021
109300     MOVE INTER-APPL-COMM-AREA                                    DPKCS021
109400                               TO  DP021-INTER-APPL-COMMAREA.     DPKCS021
109500                                                                  DPKCS021
109600     MOVE DP021-SCREEN-MNEMONIC  TO DP055-MNEMONIC.               DPKCS021
109700                                                                  DPKCS021
109800 EJECT                                                            DPKCS021
109900******************************************************************DPKCS021
110000* A850-RESET-INITIAL-INTER-APPL                                  *DPKCS021
110100* (Z021-17 RESET INITIAL INTER-APPL)                             *DPKCS021
110200*                                                                *DPKCS021
110300* WHEN THIS MODULE IS ABOUT TO RETURN TO THE MODULE THAT INVOKED *DPKCS021
110400* IT, IT WILL RESET THE COMMAREA TO THE CONTENTS THAT WERE SENT  *DPKCS021
110500* TO IT ALONG WITH ANY UPDATES TO THE OBJECT SENT TO IT, ALONG   *DPKCS021
110600* WITH AN ACKNOWLEDGEMENT CODE.                                  *DPKCS021
110700******************************************************************DPKCS021
110800                                                                  DPKCS021
110900 A850-RESET-INITIAL-INTER-APPL.                                   DPKCS021
111000                                                                  DPKCS021
111100     MOVE DP021-INTER-APPL-COMMAREA                               DPKCS021
111200                               TO  INTER-APPL-COMM-AREA.          DPKCS021
111300                                                                  DPKCS021
111400 EJECT                                                            DPKCS021
111500**********************************                                DPKCS021
111600* FETCH ROW FROM TABLE TMENUITEM *                                DPKCS021
111700**********************************                                DPKCS021
111800                                                                  DPKCS021
111900 X900-READ-TMENUITEM-ROW.                                         DPKCS021
112000                                                                  DPKCS021
112100     EXEC SQL                                                     DPKCS021
112200         SELECT       MENU_NAME,                                  DPKCS021
112300                      ITEM_MNEMONIC_CODE,                         DPKCS021
112400                      IN_APLCTN_COMM_CDE,                         DPKCS021
112500                      DESC,                                       DPKCS021
112600                      SEQUENCE_NMBR,                              DPKCS021
112700                      LAST_UPDATE_TMESTP                          DPKCS021
112800               INTO   :TMENUITEM-MENU-NAME,                       DPKCS021
112900                      :TMENUITEM-ITEM-MNEMONIC-CODE,              DPKCS021
113000                      :TMENUITEM-IN-APLCTN-COMM-CDE,              DPKCS021
113100                      :TMENUITEM-DESC:PV-DESC-NULL-IND,           DPKCS021
113200                      :TMENUITEM-SEQUENCE-NMBR,                   DPKCS021
113300                      :TMENUITEM-LAST-UPDATE-TMESTP               DPKCS021
113400               FROM   TMENUITEM                                   DPKCS021
113500               WHERE  MENU_NAME           =                       DPKCS021
113600                          :TMENUITEM-MENU-NAME                    DPKCS021
113700                      AND                                         DPKCS021
113800                      ITEM_MNEMONIC_CODE  =                       DPKCS021
113900                            :TMENUITEM-ITEM-MNEMONIC-CODE         DPKCS021
114000     END-EXEC.                                                    DPKCS021
114100                                                                  DPKCS021
114200***************************                                       DPKCS021
114300* CHECK SQLCODE OF SELECT *                                       DPKCS021
114400***************************                                       DPKCS021
114500                                                                  DPKCS021
114600     MOVE SQLCODE                TO SQL-RETURN-CODE.              DPKCS021
114700     IF  SQL-ROW-NOT-FOUND                                        DPKCS021
114800         CONTINUE                                                 DPKCS021
114900     ELSE                                                         DPKCS021
115000         IF  NOT SQL-SUCCESSFUL                                   DPKCS021
115100             SET  DP013-DB2-ABEND                                 DPKCS021
115200                                   TO TRUE                        DPKCS021
115300             MOVE 'X900-READ-TMENUITEM-ROW       '                DPKCS021
115400                                   TO DP013-PARAGRAPH             DPKCS021
115500             MOVE SQLCA            TO DP013-SQLCA                 DPKCS021
115600             MOVE 'TMENUITEM         '                            DPKCS021
115700                                   TO DP013-DB2-TABLE-NAME (1)    DPKCS021
115800             MOVE 'READ FAILED FOR: '                                   12
115900                                   TO DP013-MESSAGE-TEXT (1)            12
116000             MOVE TMENUITEM-MENU-NAME                                   12
116100                                   TO PV-DISP-MENU-NAME                 12
116200             MOVE TMENUITEM-ITEM-MNEMONIC-CODE                          12
116300                                   TO PV-DISP-ITEM                      12
116400             MOVE SPACES           TO PV-DISP-FIELD3                    12
116500             MOVE PV-DISPLAY-INFO  TO DP013-MESSAGE-TEXT (2)            12
116600             PERFORM DP013-0000-PROCESS-ABEND                     DPKCS021
116700         END-IF                                                   DPKCS021
116800     END-IF.                                                      DPKCS021
116900 EJECT                                                            DPKCS021
117000**********************************                                DPKCS021
117100* FETCH ROW FROM TABLE TMNEMONIC *                                DPKCS021
117200*    USING TMENUITEM-MENU-NAME   *                                DPKCS021
117300**********************************                                DPKCS021
117400                                                                  DPKCS021
117500 X910-READ-TMNEMONIC-ROW.                                         DPKCS021
117600                                                                  DPKCS021
117700     EXEC SQL                                                     DPKCS021
117800         SELECT       MNEMONIC_CODE,                              DPKCS021
117900                      PANEL_TITLE_NAME,                           DPKCS021
118000                      TRANS_ID_CODE                               DPKCS021
118100               INTO   :TMNEMONIC-MNEMONIC-CODE,                   DPKCS021
118200                      :TMNEMONIC-PANEL-TITLE-NAME,                DPKCS021
118300                      :TMNEMONIC-TRANS-ID-CODE                    DPKCS021
118400               FROM   TMNEMONIC                                   DPKCS021
118500               WHERE  MNEMONIC_CODE  =  :TMENUITEM-MENU-NAME      DPKCS021
118600     END-EXEC.                                                    DPKCS021
118700                                                                  DPKCS021
118800***************************                                       DPKCS021
118900* CHECK SQLCODE OF SELECT *                                       DPKCS021
119000***************************                                       DPKCS021
119100                                                                  DPKCS021
119200     MOVE SQLCODE                TO SQL-RETURN-CODE.              DPKCS021
119300     IF  SQL-ROW-NOT-FOUND                                        DPKCS021
119400         CONTINUE                                                 DPKCS021
119500     ELSE                                                         DPKCS021
119600         IF  NOT SQL-SUCCESSFUL                                   DPKCS021
119700             SET  DP013-DB2-ABEND                                 DPKCS021
119800                                   TO TRUE                        DPKCS021
119900             MOVE 'X910-READ-TMNEMONIC-ROW       '                DPKCS021
120000                                   TO DP013-PARAGRAPH             DPKCS021
120100             MOVE SQLCA            TO DP013-SQLCA                 DPKCS021
120200             MOVE 'TMNEMONIC         '                            DPKCS021
120300                                   TO DP013-DB2-TABLE-NAME (1)    DPKCS021
120400             MOVE 'READ FAILED FOR: '                                   12
120500                                   TO DP013-MESSAGE-TEXT (1)            12
120600             MOVE TMENUITEM-MENU-NAME                                   12
120700                                   TO PV-DISP-MENU-NAME                 12
120800             MOVE SPACES           TO PV-DISP-FIELD2                    12
120900             MOVE SPACES           TO PV-DISP-FIELD3                    12
121000             MOVE PV-DISPLAY-INFO  TO DP013-MESSAGE-TEXT (2)            12
121100             PERFORM DP013-0000-PROCESS-ABEND                     DPKCS021
121200         END-IF                                                   DPKCS021
121300     END-IF.                                                      DPKCS021
121400 EJECT                                                            DPKCS021
121500************************************                              DPKCS021
121600* FETCH ROW FROM TABLE TMNEMONIC   *                              DPKCS021
121700*    USING TMNEMONIC-MNEMONIC-CODE *                              DPKCS021
121800************************************                              DPKCS021
121900                                                                  DPKCS021
122000 X920-READ-TMNEMONIC-ROW.                                         DPKCS021
122100                                                                  DPKCS021
122200     EXEC SQL                                                     DPKCS021
122300         SELECT       MNEMONIC_CODE,                              DPKCS021
122400                      TRANS_ID_CODE,                              DPKCS021
122500                      PANEL_TITLE_NAME                            DPKCS021
122600               INTO   :TMNEMONIC-MNEMONIC-CODE,                   DPKCS021
122700                      :TMNEMONIC-TRANS-ID-CODE,                   DPKCS021
122800                      :TMNEMONIC-PANEL-TITLE-NAME                 DPKCS021
122900               FROM   TMNEMONIC                                   DPKCS021
123000               WHERE  MNEMONIC_CODE  =                            DPKCS021
123100                              :TMNEMONIC-MNEMONIC-CODE            DPKCS021
123200     END-EXEC.                                                    DPKCS021
123300                                                                  DPKCS021
123400***************************                                       DPKCS021
123500* CHECK SQLCODE OF SELECT *                                       DPKCS021
123600***************************                                       DPKCS021
123700                                                                  DPKCS021
123800     MOVE SQLCODE                TO SQL-RETURN-CODE.              DPKCS021
123900     IF  SQL-ROW-NOT-FOUND                                        DPKCS021
124000         CONTINUE                                                 DPKCS021
124100     ELSE                                                         DPKCS021
124200         IF  NOT SQL-SUCCESSFUL                                   DPKCS021
124300             SET  DP013-DB2-ABEND                                 DPKCS021
124400                                   TO TRUE                        DPKCS021
124500             MOVE 'X920-READ-TMNEMONIC-ROW       '                DPKCS021
124600                                   TO DP013-PARAGRAPH             DPKCS021
124700             MOVE SQLCA            TO DP013-SQLCA                 DPKCS021
124800             MOVE 'TMNEMONIC         '                            DPKCS021
124900                                   TO DP013-DB2-TABLE-NAME (1)    DPKCS021
125000             MOVE 'READ FAILED FOR: '                                   12
125100                                   TO DP013-MESSAGE-TEXT (1)            12
125200             MOVE TMNEMONIC-MNEMONIC-CODE                               12
125300                                   TO PV-DISP-MENU-NAME                 12
125400             MOVE SPACES           TO PV-DISP-FIELD2                    12
125500             MOVE SPACES           TO PV-DISP-FIELD3                    12
125600             MOVE PV-DISPLAY-INFO  TO DP013-MESSAGE-TEXT (2)            12
125700             PERFORM DP013-0000-PROCESS-ABEND                     DPKCS021
125800         END-IF                                                   DPKCS021
125900     END-IF.                                                      DPKCS021
126000 EJECT                                                            DPKCS021
126100*********************************************                     DPKCS021
126200* FETCH ROW FROM TABLE TMENUITEM            *                     DPKCS021
126300* TO ACQUIRE THE UPDATED RECORD'S TIMESTAMP *                     DPKCS021
126400*********************************************                     DPKCS021
126500                                                                  DPKCS021
126600 X930-READ-TMENUITEM-ROW.                                         DPKCS021
126700                                                                  DPKCS021
126800     EXEC SQL                                                     DPKCS021
126900         SELECT       MENU_NAME,                                  DPKCS021
127000                      ITEM_MNEMONIC_CODE,                         DPKCS021
127100                      IN_APLCTN_COMM_CDE,                         DPKCS021
127200                      LAST_UPDATE_TMESTP                          DPKCS021
127300               INTO   :TMENUITEM-MENU-NAME,                       DPKCS021
127400                      :TMENUITEM-ITEM-MNEMONIC-CODE,              DPKCS021
127500                      :TMENUITEM-IN-APLCTN-COMM-CDE,              DPKCS021
127600                      :TMENUITEM-LAST-UPDATE-TMESTP               DPKCS021
127700               FROM   TMENUITEM                                   DPKCS021
127800               WHERE  (MENU_NAME           =                      DPKCS021
127900                           :TMENUITEM-MENU-NAME                   DPKCS021
128000                       AND                                        DPKCS021
128100                       ITEM_MNEMONIC_CODE  =                      DPKCS021
128200                           :TMENUITEM-ITEM-MNEMONIC-CODE)         DPKCS021
128300     END-EXEC.                                                    DPKCS021
128400                                                                  DPKCS021
128500***************************                                       DPKCS021
128600* CHECK SQLCODE OF SELECT *                                       DPKCS021
128700***************************                                       DPKCS021
128800                                                                  DPKCS021
128900     MOVE SQLCODE                TO SQL-RETURN-CODE.              DPKCS021
129000     IF  SQL-ROW-NOT-FOUND                                        DPKCS021
129100         CONTINUE                                                 DPKCS021
129200     ELSE                                                         DPKCS021
129300         IF  NOT SQL-SUCCESSFUL                                   DPKCS021
129400             SET  DP013-DB2-ABEND                                 DPKCS021
129500                                   TO TRUE                        DPKCS021
129600             MOVE 'X930-READ-TMNEMONIC-ROW       '                DPKCS021
129700                                   TO DP013-PARAGRAPH             DPKCS021
129800             MOVE SQLCA            TO DP013-SQLCA                 DPKCS021
129900             MOVE 'TMENUITEM         '                            DPKCS021
130000                                   TO DP013-DB2-TABLE-NAME (1)    DPKCS021
130100             MOVE 'READ FAILED FOR: '                                   12
130200                                   TO DP013-MESSAGE-TEXT (1)            12
130300             MOVE TMENUITEM-MENU-NAME                                   12
130400                                   TO PV-DISP-MENU-NAME                 12
130500             MOVE TMENUITEM-ITEM-MNEMONIC-CODE                          12
130600                                   TO PV-DISP-ITEM                      12
130700             MOVE SPACES           TO PV-DISP-FIELD3                    12
130800             MOVE PV-DISPLAY-INFO  TO DP013-MESSAGE-TEXT (2)            12
130900             PERFORM DP013-0000-PROCESS-ABEND                     DPKCS021
131000         END-IF                                                   DPKCS021
131100     END-IF.                                                      DPKCS021
131200 EJECT                                                            DPKCS021
131300***********************************                               DPKCS021
131400* UPDATE ROW FROM TABLE TMENUITEM *                               DPKCS021
131500***********************************                               DPKCS021
131600                                                                  DPKCS021
131700 X940-UPDATE-TMENUITEM-ROW.                                       DPKCS021
131800                                                                  DPKCS021
131900     EXEC SQL                                                     DPKCS021
132000         UPDATE       TMENUITEM                                   DPKCS021
132100               SET    SEQUENCE_NMBR        =                      DPKCS021
132200                              :TMENUITEM-SEQUENCE-NMBR,           DPKCS021
132300                      DESC                 =                      DPKCS021
132400                              :TMENUITEM-DESC:PV-DESC-NULL-IND,   DPKCS021
132500                      LAST_UPDATE_TMESTP   =                      DPKCS021
132600                              CURRENT TIMESTAMP,                  DPKCS021
132700                      IN_APLCTN_COMM_CDE   =                      DPKCS021
132800                              :TMENUITEM-IN-APLCTN-COMM-CDE       DPKCS021
132900               WHERE  (MENU_NAME           =                      DPKCS021
133000                          :TMENUITEM-MENU-NAME                    DPKCS021
133100                       AND                                        DPKCS021
133200                       ITEM_MNEMONIC_CODE  =                      DPKCS021
133300                          :TMENUITEM-ITEM-MNEMONIC-CODE)          DPKCS021
133400*                      AND                                        DPKCS021
133500*                      LAST_UPDATE_TMESTP  =                      DPKCS021
133600*                         :TMENUITEM-LAST-UPDATE-TMESTP)          DPKCS021
133700     END-EXEC.                                                    DPKCS021
133800                                                                  DPKCS021
133900***************************                                       DPKCS021
134000* CHECK SQLCODE OF UPDATE *                                       DPKCS021
134100***************************                                       DPKCS021
134200                                                                  DPKCS021
134300     MOVE SQLCODE                TO SQL-RETURN-CODE.              DPKCS021
134400     IF  SQLCODE NOT EQUAL ZERO                                   DPKCS021
134500         SET  DP013-DB2-ABEND  TO TRUE                            DPKCS021
134600         MOVE 'X940-UPDATE-TMENUITEM-ROW     '                    DPKCS021
134700                                 TO DP013-PARAGRAPH               DPKCS021
134800         MOVE SQLCA              TO DP013-SQLCA                   DPKCS021
134900         MOVE 'TMENUITEM         '                                DPKCS021
135000                                 TO DP013-DB2-TABLE-NAME (1)      DPKCS021
135100         MOVE 'UPDATE FAILED FOR: '                                     12
135200                                 TO DP013-MESSAGE-TEXT (1)              12
135300         MOVE TMENUITEM-MENU-NAME                                       12
135400                                 TO PV-DISP-MENU-NAME                   12
135500         MOVE TMENUITEM-ITEM-MNEMONIC-CODE                              12
135600                                 TO PV-DISP-ITEM                        12
135700         MOVE SPACES             TO PV-DISP-FIELD3                      12
135800         MOVE PV-DISPLAY-INFO    TO DP013-MESSAGE-TEXT (2)              12
135900         PERFORM DP013-0000-PROCESS-ABEND                         DPKCS021
136000     END-IF.                                                      DPKCS021
136100 EJECT                                                            DPKCS021
136200**********************************                                DPKCS021
136300* FETCH ROW FROM TABLE TMENUITEM *                                DPKCS021
136400* TO VERIFY SEQUENCE NUMBER      *                                DPKCS021
136500**********************************                                DPKCS021
136600                                                                  DPKCS021
136700 X950-READ-TMENUITEM-ROW.                                         DPKCS021
136800                                                                  DPKCS021
136900     EXEC SQL                                                     DPKCS021
137000         SELECT       MENU_NAME,                                  DPKCS021
137100                      ITEM_MNEMONIC_CODE,                         DPKCS021
137200                      IN_APLCTN_COMM_CDE,                         DPKCS021
137300                      SEQUENCE_NMBR                               DPKCS021
137400               INTO   :TMENUITEM-MENU-NAME,                       DPKCS021
137500                      :TMENUITEM-ITEM-MNEMONIC-CODE,              DPKCS021
137600                      :TMENUITEM-IN-APLCTN-COMM-CDE,              DPKCS021
137700                      :TMENUITEM-SEQUENCE-NMBR                    DPKCS021
137800               FROM   TMENUITEM                                   DPKCS021
137900               WHERE  MENU_NAME               =                   DPKCS021
138000                            :TMENUITEM-MENU-NAME                  DPKCS021
138100                      AND                                         DPKCS021
138200                      SEQUENCE_NMBR           =                   DPKCS021
138300                            :TMENUITEM-SEQUENCE-NMBR              DPKCS021
138400                      AND                                         DPKCS021
138500                      NOT ITEM_MNEMONIC_CODE  =                   DPKCS021
138600                            :TMENUITEM-ITEM-MNEMONIC-CODE         DPKCS021
138700     END-EXEC.                                                    DPKCS021
138800                                                                  DPKCS021
138900***************************                                       DPKCS021
139000* CHECK SQLCODE OF SELECT *                                       DPKCS021
139100***************************                                       DPKCS021
139200                                                                  DPKCS021
139300     MOVE SQLCODE                TO SQL-RETURN-CODE.              DPKCS021
139400     IF  (   SQL-ROW-FOUND                                        DPKCS021
139500         OR  SQL-ROW-NOT-FOUND                                    DPKCS021
139600         OR  SQL-MORE-THAN-1-ROW                                  DPKCS021
139700         )                                                        DPKCS021
139800         CONTINUE                                                 DPKCS021
139900     ELSE                                                         DPKCS021
140000         IF  NOT SQL-SUCCESSFUL                                   DPKCS021
140100             SET  DP013-DB2-ABEND                                 DPKCS021
140200                                   TO TRUE                        DPKCS021
140300             MOVE 'X950-READ-TMENUITEM-ROW       '                DPKCS021
140400                                   TO DP013-PARAGRAPH             DPKCS021
140500             MOVE SQLCA            TO DP013-SQLCA                 DPKCS021
140600             MOVE 'TMENUITEM         '                            DPKCS021
140700                                   TO DP013-DB2-TABLE-NAME (1)    DPKCS021
140800             MOVE 'READ FAILED FOR: '                                   12
140900                                   TO DP013-MESSAGE-TEXT (1)            12
141000             MOVE TMENUITEM-MENU-NAME                                   12
141100                                   TO PV-DISP-MENU-NAME                 12
141200             MOVE SPACES           TO PV-DISP-FIELD2                    12
141300             MOVE TMENUITEM-SEQUENCE-NMBR                               12
141400                                   TO PV-DISP-SEQ                       12
141500             MOVE SPACES           TO PV-DISP-FIELD3                    12
141600             MOVE ', NOT = '       TO PV-DISP-FIELD3A                   12
141700             MOVE TMENUITEM-ITEM-MNEMONIC-CODE                          12
141800                                   TO PV-DISP-FIELD3B                   12
141900             MOVE PV-DISPLAY-INFO  TO DP013-MESSAGE-TEXT (2)            12
142000             PERFORM DP013-0000-PROCESS-ABEND                     DPKCS021
142100         END-IF                                                   DPKCS021
142200     END-IF.                                                      DPKCS021
142300 EJECT                                                            DPKCS021
142400**********************************                                DPKCS021
142500* FETCH ROW FROM TABLE TCICSROUTE*                                DPKCS021
142600* TO OBTAIN INTERAPPL FORMAT CODE*                                DPKCS021
142700**********************************                                DPKCS021
142800                                                                  DPKCS021
142900 X960-READ-TCICSROUTE-ROW.                                        DPKCS021
143000                                                                  DPKCS021
143100     EXEC SQL                                                     DPKCS021
143200         SELECT       IN_APLCTN_COMM_CDE                          DPKCS021
143300               INTO   :TCICSROUTE-IN-APLCTN-COMM-CDE              DPKCS021
143400               FROM   TCICSROUTE                                  DPKCS021
143500               WHERE  DEST_MNEMONIC_CODE      =                   DPKCS021
143600                            :DP021-SCREEN-MNEMONIC                DPKCS021
143700                AND                                               DPKCS021
143800                      IN_APLCTN_COMM_CDE      =                   DPKCS021
143900                            :DP021-SCREEN-FORMAT                  DPKCS021
144000     END-EXEC.                                                    DPKCS021
144100                                                                  DPKCS021
144200     EVALUATE TRUE                                                DPKCS021
144300                                                                  DPKCS021
144400         WHEN SQLCODE = +100                                      DPKCS021
144500              CONTINUE                                            DPKCS021
144600         WHEN SQLCODE = +0                                        DPKCS021
144700         WHEN SQLCODE = -811                                      DPKCS021
144800              SET PS-WARNING     TO TRUE                          DPKCS021
144900                                                                  DPKCS021
145000         WHEN OTHER                                               DPKCS021
145100             SET DP013-DB2-ABEND TO TRUE                          DPKCS021
145200             SET DP013-ROLLBACK  TO TRUE                          DPKCS021
145300                                                                  DPKCS021
145400             MOVE 'X960-READ-TCICSROUTE-ROW' TO                   DPKCS021
145500                  DP013-PARAGRAPH                                 DPKCS021
145600             MOVE SQLCA                        TO                 DPKCS021
145700                  DP013-SQLCA                                     DPKCS021
145800             MOVE 'TCICSROUTE - SELECT'        TO                 DPKCS021
145900                  DP013-MESSAGE-TEXT(1)                           DPKCS021
146000             MOVE 'READ FAILED FOR: '                                   12
146100                                   TO DP013-MESSAGE-TEXT (1)            12
146200             MOVE DP021-SCREEN-MNEMONIC                                 21
146300                                   TO PV-DISP-MENU-NAME                 12
146400             MOVE DP021-SCREEN-FORMAT                                   21
146500                                   TO PV-DISP-ITEM                      12
146600             MOVE SPACES           TO PV-DISP-FIELD3                    12
146700             MOVE PV-DISPLAY-INFO  TO DP013-MESSAGE-TEXT (2)            12
146800             PERFORM DP013-0000-PROCESS-ABEND                     DPKCS021
146900                                                                  DPKCS021
147000     END-EVALUATE.                                                DPKCS021
147100                                                                  DPKCS021
147200 EJECT                                                            DPKCS021
147300**********************************                                DPKCS021
147400* FETCH ROW FROM TABLE TCICSROUTE*                                DPKCS021
147500* TO OBTAIN INTERAPPL FORMAT CODE*                                DPKCS021
147600**********************************                                DPKCS021
147700                                                                  DPKCS021
147800 X970-READ-TMENUITEM-ROW.                                         DPKCS021
147900                                                                  DPKCS021
148000     EXEC SQL                                                     DPKCS021
148100         SELECT   IN_APLCTN_COMM_CDE                              DPKCS021
148200         INTO     :TMENUITEM-IN-APLCTN-COMM-CDE                   DPKCS021
148300         FROM     TMENUITEM                                       DPKCS021
148400         WHERE    (ITEM_MNEMONIC_CODE =                           DPKCS021
148500                            :DP021-SCREEN-MNEMONIC                DPKCS021
148600                AND MENU_NAME      ^=                             DPKCS021
148700                            :DP021-SCREEN-MENU-NAME               DPKCS021
148800                AND                                               DPKCS021
148900                      IN_APLCTN_COMM_CDE      =                   DPKCS021
149000                            :DP021-SCREEN-FORMAT)                 DPKCS021
149100     END-EXEC.                                                    DPKCS021
149200                                                                  DPKCS021
149300     EVALUATE TRUE                                                DPKCS021
149400                                                                  DPKCS021
149500         WHEN SQLCODE = +100                                      DPKCS021
149600              CONTINUE                                            DPKCS021
149700         WHEN SQLCODE = +0                                        DPKCS021
149800         WHEN SQLCODE = -811                                      DPKCS021
149900              SET PS-WARNING     TO TRUE                          DPKCS021
150000                                                                  DPKCS021
150100         WHEN OTHER                                               DPKCS021
150200             SET DP013-DB2-ABEND TO TRUE                          DPKCS021
150300             SET DP013-ROLLBACK  TO TRUE                          DPKCS021
150400                                                                  DPKCS021
150500             MOVE 'X970-READ-TMENUITEM-ROW ' TO                   DPKCS021
150600                  DP013-PARAGRAPH                                 DPKCS021
150700             MOVE SQLCA                        TO                 DPKCS021
150800                  DP013-SQLCA                                     DPKCS021
150900             MOVE 'TMENUITEM - SELECT FAILED FOR' TO              DPKCS021
151000                  DP013-MESSAGE-TEXT(1)                           DPKCS021
151100             MOVE DP021-SCREEN-MNEMONIC                                 21
151200                                   TO PV-DISP-MENU-NAME                 12
151300             MOVE DP021-SCREEN-FORMAT                                   21
151400                                   TO PV-DISP-ITEM                      12
151500             MOVE SPACES           TO PV-DISP-FIELD3                    12
151600             MOVE ', NOT = '       TO PV-DISP-FIELD3A                   12
151700             MOVE DP021-SCREEN-MENU-NAME                                21
151800                                   TO PV-DISP-FIELD3B                   12
151900             MOVE PV-DISPLAY-INFO  TO DP013-MESSAGE-TEXT (2)            12
152000             PERFORM DP013-0000-PROCESS-ABEND                     DPKCS021
152100                                                                  DPKCS021
152200     END-EVALUATE.                                                DPKCS021
152300                                                                  DPKCS021
152400 EJECT                                                            DPKCS021
152500************************************                              DPKCS012
152600* UPDATE ROW FROM TABLE TMNEMONIC  *                              DPKCS012
152700*    FOR THIS MENU.                *                                    12
152800************************************                              DPKCS012
152900                                                                  DPKCS012
153000 X980-UPDT-TMNEMONIC-ROW.                                         DPKCS012
153100 SKIP2                                                            DPKCS012
153400     EXEC SQL                                                     DPKCS012
153500           UPDATE TMNEMONIC                                             12
153600              SET UPD_VSAM_IND       = :PC-Y,                           12
153700                  LAST_UPDATE_TMESTP = CURRENT TIMESTAMP                12
153800           WHERE  MNEMONIC_CODE      = :DP021-SCREEN-MENU-NAME          12
153900     END-EXEC.                                                    DPKCS012
154000                                                                  DPKCS012
154100***************************                                       DPKCS021
154200* CHECK SQLCODE OF UPDATE *                                       DPKCS021
154300***************************                                       DPKCS021
154400                                                                  DPKCS021
154500     MOVE SQLCODE                TO SQL-RETURN-CODE.              DPKCS021
154600     IF  SQLCODE NOT EQUAL ZERO                                   DPKCS021
154700         SET  DP013-DB2-ABEND  TO TRUE                            DPKCS021
154800         MOVE 'X980-UPDT-TMNEMONIC-ROW       '                    DPKCS021
154900                                 TO DP013-PARAGRAPH               DPKCS021
155000         MOVE SQLCA              TO DP013-SQLCA                   DPKCS021
155100         MOVE 'TMNEMONIC         '                                DPKCS021
155200                                 TO DP013-DB2-TABLE-NAME (1)      DPKCS021
155300         MOVE 'UPDATE OF UPD-VSAM-IND FAILED FOR: '                     12
155400                                 TO DP013-MESSAGE-TEXT (1)        DPKCS012
155500         MOVE DP021-SCREEN-MENU-NAME                                    12
155600                                 TO DP013-MESSAGE-TEXT (2)        DPKCS012
155700         PERFORM DP013-0000-PROCESS-ABEND                         DPKCS021
155800     END-IF.                                                      DPKCS021
155900 EJECT                                                            DPKCS021
156000                                                                        12
156100**********************************************                    DPKCS021
156200* COPYBOOK FOR DP002-0000-FORMAT-TITLE-LINES *                    DPKCS021
156300**********************************************                    DPKCS021
156400     COPY DPPD022.                                                DPKCS021
156500 EJECT                                                            DPKCS021
156600******************************************                        DPKCS021
156700* COPYBOOK FOR DP003-0000-RETURN-TO-CICS *                        DPKCS021
156800******************************************                        DPKCS021
156900     COPY DPPD003.                                                DPKCS021
157000 EJECT                                                            DPKCS021
157100********************************************                      DPKCS021
157200* COPYBOOK FOR DP005-0000-FORMAT-MSG-LINES *                      DPKCS021
157300********************************************                      DPKCS021
157400     COPY DPPD005.                                                DPKCS021
157500 EJECT                                                            DPKCS021
157600*************************************                             DPKCS021
157700* COPYBOOK FOR DP007-0000-GET-PANEL *                             DPKCS021
157800*************************************                             DPKCS021
157900     COPY DPPD007.                                                DPKCS021
158000 EJECT                                                            DPKCS021
158100***************************************                           DPKCS021
158200* COPYBOOK FOR DP008-0000-WRITE-PANEL *                           DPKCS021
158300***************************************                           DPKCS021
158400     COPY DPPD008.                                                DPKCS021
158500 EJECT                                                            DPKCS021
158600*****************************************                         DPKCS021
158700* COPYBOOK FOR DP009-0000-LOAD-FK-LINES *                         DPKCS021
158800*****************************************                         DPKCS021
158900     COPY DPPD009.                                                DPKCS021
159000 EJECT                                                            DPKCS021
159100*****************************************                         DPKCS021
159200* COPYBOOK FOR DP013-0000-PROCESS-ABEND *                         DPKCS021
159300*****************************************                         DPKCS021
159400     COPY DPPD013.                                                DPKCS021
159500 EJECT                                                            DPKCS021
159600******************************************                        DPKCS021
159700* COPYBOOK FOR DP015-0000-CHECK-COMMAREA *                        DPKCS021
159800******************************************                        DPKCS021
159900     COPY DPPD015.                                                DPKCS021
160000 EJECT                                                            DPKCS021
160100**********************************************                    DPKCS021
160200* COPYBOOK FOR DP017-0000-GET-CURR-DATE-TIME *                    DPKCS021
160300**********************************************                    DPKCS021
160400     COPY DPPD017.                                                DPKCS021
160500 EJECT                                                            DPKCS021
160600*****************************************                         DPKCS021
160700* COPYBOOK FOR DP018-0000-GET-CURR-TIME *                         DPKCS021
160800*****************************************                         DPKCS021
160900     COPY DPPD018.                                                DPKCS021
