000100******************************************************************        
000200 IDENTIFICATION DIVISION.                                                 
000300******************************************************************        
000400                                                                          
000500 PROGRAM-ID.             MRKUP103.                                        
000600 AUTHOR.                 ANNE KINTOPF.                                    
000700 INSTALLATION.           KOHLS DEPARTMENT STORES.                         
000800 DATE-WRITTEN            03-20-01.                                        
000900 DATE-COMPILED.                                                           
001000                                                                          
001100******************************************************************        
001200* THIS PROGRAM WILL TURN OFF E-COMMERCE STORES FROM REPLENISHMENT*        
001300* FOR ITEMS THAT ARE NO LONGER ACTIVE ON THE WEB. TWO REPORTS    *        
001400* WILL BE CREATED: A REPORT FOR ITEMS/STORES TURNED OFF AND A    *        
001500* REPORT FOR ITEMS THAT WILL BE TURNED OFF WITHIN 4 DAYS OR      *        
001510* WITHIN 12 TO 16 DAYS OR WITHIN 27 TO 30 DAYS.                  *        
001600******************************************************************        
001602*  CHANGE MADE: NEW PROGRAM                                     *         
001603*          04/09/2003 BY DONALD TOMLINSON         WR24158       *         
001604* -              NI-SKU MR PHASE 4 CHANGES                      *         
001620* -  TSKXREF ADDED.                                             *         
001630* -  ADDED ISWS006 COPYBOOK TO HANDLE DIFFERENT FORMATS / SIZES *         
001640*    IN FIELDS.                                                 *         
001650* -  SQL CHANGED FOR WHERE STATEMENTS TO REFERENCE DCLGEN       *         
001660*    FIELDS INSTEAD OF PROGRAM VARAIABLES IN WORKING STORAGE    *         
001670* -  REPORT FORMAT CHANGED TO ZERO SUPPRESS FOR DEPT AND SKU.   *         
001671* -  REPORT NOW HAS SUBCLASS AND SKU ON DETAIL LINE.            *         
001602*  CHANGE MADE: STORE NUMBER EXPANSION                          *         
001603*          10/12/2004 BY BOB FORD                 WR26363       *         
001620*  - REPLACED TSTR000 WITH XMT_LOC                              *         
001680** - CHANGED HOLD-FIELDS AND REPORT LINES TO USE 5-DIGIT STORE **         
001800******************************************************************        
002410* 07/30/2004 - ANNE KINTOPF STORE NUMBER EXPANSION  WR#26363    *         
002420* -  CHANGED REFERENCES FROM TSTR000 TO XMT_LOC                 *         
002490*****************************************************************         
001700 ENVIRONMENT DIVISION.                                                    
001800******************************************************************        
001900                                                                          
002000 CONFIGURATION SECTION.                                                   
002100                                                                          
002200 SOURCE-COMPUTER.        IBM-3090.                                        
002300 OBJECT-COMPUTER.        IBM-3090.                                        
002400                                                                          
002500 INPUT-OUTPUT SECTION.                                                    
002600                                                                          
002700 FILE-CONTROL.                                                            
002800                                                                          
002900     SELECT PRINT-REPORT1                                                 
003000         ASSIGN                       TO RPT01.                           
003100                                                                          
003101     SELECT PRINT-REPORT2                                                 
003102         ASSIGN                       TO RPT02.                           
003103                                                                          
003200     EJECT                                                                
003300******************************************************************        
003400 DATA DIVISION.                                                           
003500******************************************************************        
003600 FILE SECTION.                                                            
003700                                                                          
003800 FD  PRINT-REPORT1                                                        
003900     LABEL RECORDS ARE STANDARD                                           
004000     RECORDING MODE IS F                                                  
010800     RECORD CONTAINS 132 CHARACTERS                                       
010801     BLOCK CONTAINS 0 RECORDS.                                            
010802                                                                          
010803 01  PRINT-LINE1                      PIC X(132).                         
010804                                                                          
010805 FD  PRINT-REPORT2                                                        
010806     LABEL RECORDS ARE STANDARD                                           
010807     RECORDING MODE IS F                                                  
010808     RECORD CONTAINS 132 CHARACTERS                                       
010809     BLOCK CONTAINS 0 RECORDS.                                            
010810                                                                          
010811 01  PRINT-LINE2                      PIC X(132).                         
010812                                                                          
010813 WORKING-STORAGE SECTION.                                                 
010814                                                                          
010815 01  FILLER.                                                              
010816     05  FILLER                       PIC  X(36)  VALUE                   
010817        ' ***** WORKING STORAGE PGM=MRKUP103 '.                           
010818     05  FILLER                       PIC  X(10)  VALUE                   
010819         ' LOCATION='.                                                    
010820     05  PGM-LOCATION                 PIC  X(05)  VALUE SPACE.            
010821     05  FILLER                       PIC  X(06)  VALUE                   
010822         ' *****'.                                                        
010823                                                                          
010824 01  ABEND-CODE                       PIC S9(4)   VALUE ZERO              
010825                                      COMP SYNC.                          
010826                                                                          
010827 01  ABEND-AREAS.                                                         
010828     05  AA-ABEND-LIT                 PIC  X(40)  VALUE                   
010829             '*****       ABEND'.                                         
010830     05  AA-PROGRAM-LIT               PIC  X(40)  VALUE                   
010831             '*****   PROGRAM: MRKUP103'.                                 
010832     05  AA-PARAGRAPH-LIT.                                                
010833         10  FILLER                   PIC  X(17)  VALUE                   
010834             '***** PARAGRAPH: '.                                         
010835         10  AA-PARAGRAPH-NAME        PIC  X(35)  VALUE SPACES.           
010836                                                                          
010837 01  PV-PROGRAM-VARIABLES.                                                
010838     05  PV-REPORT-VARIABLES.                                             
010839         10  PV-LINE-CNT1             PIC S9(3)                           
010900                                      COMP-3      VALUE +61.              
011000         10  PV-PAGE-CNT1             PIC  9(3)   VALUE ZEROS.            
011100         10  PV-LINE-CONTROL1         PIC  9(1)   VALUE ZEROS.            
011101         10  PV-LINE-CNT2             PIC S9(3)                           
011102                                      COMP-3      VALUE +61.              
011103         10  PV-PAGE-CNT2             PIC  9(3)   VALUE ZEROS.            
011104         10  PV-LINE-CONTROL2         PIC  9(1)   VALUE ZEROS.            
011510     05  PV-HOLD-DEPT1                PIC  X(3)   VALUE SPACES.           
011520     05  PV-HOLD-DEPT2                PIC  X(3)   VALUE SPACES.           
011521     05  PV-HOLD-CLASS1.                                                  
011522         10 PV-HOLD-MJR-CLASS1        PIC  X(1)   VALUE SPACES.           
011523         10 PV-HOLD-SUB-CLASS1        PIC  X(1)   VALUE SPACES.           
011524     05  PV-HOLD-CLASS2.                                                  
011525         10 PV-HOLD-MJR-CLASS2        PIC  X(1)   VALUE SPACES.           
011526         10 PV-HOLD-SUB-CLASS2        PIC  X(1)   VALUE SPACES.           
011530     05  PV-DAYS-OFF-WEB              PIC  9(2)   VALUE ZEROS.            
011531     05  PV-EFF-BEG-IND               PIC S9(04)  VALUE +0                
011532                                              COMP.                       
011533     05  PV-EFF-END-IND               PIC S9(04)  VALUE +0                
011534                                              COMP.                       
011535                                                                          
011540 01  PV-DATE-FILDS.                                                       
015800     05  PV-CURR-TMST                    PIC X(26) VALUE SPACES.          
015900     05  PV-COMMIT-TMST                  PIC X(26) VALUE SPACES.          
015902     05  PV-BEGIN-DATE.                                                   
015903         10 PV-BEGIN-YEAR                PIC X(4).                        
015904         10 FILLER                       PIC X.                           
015905         10 PV-BEGIN-MONTH               PIC X(2).                        
015906         10 FILLER                       PIC X.                           
015907         10 PV-BEGIN-DAY                 PIC X(2).                        
015922     05  PV-END-DATE .                                                    
015923         10 PV-END-YEAR                  PIC X(4).                        
015924         10 FILLER                       PIC X.                           
015925         10 PV-END-MONTH                 PIC X(2).                        
015926         10 FILLER                       PIC X.                           
015927         10 PV-END-DAY                   PIC X(2).                        
015950     05  PV-WEB-EFF-BEG-TIMESTAMP        PIC X(26).                       
015951     05  PV-WEB-EFF-BEG-TMST REDEFINES PV-WEB-EFF-BEG-TIMESTAMP.          
015960         10  PV-WEB-EFF-BEG-DATE.                                         
015961             15 PV-WEB-EFF-BEG-YEAR      PIC X(4).                        
015962             15 FILLER                   PIC X.                           
015963             15 PV-WEB-EFF-BEG-MONTH     PIC X(2).                        
015964             15 FILLER                   PIC X.                           
015965             15 PV-WEB-EFF-BEG-DAY       PIC X(2).                        
015966         10  PV-WEB-EFF-BEG-TIME         PIC X(16).                       
015975     05  PV-WEB-EFF-END-TIMESTAMP        PIC X(26).                       
015976     05  PV-WEB-EFF-END-TMST REDEFINES PV-WEB-EFF-END-TIMESTAMP.          
015978         10  PV-WEB-EFF-END-DATE.                                         
015979             15 PV-WEB-EFF-END-YEAR      PIC X(4).                        
015980             15 FILLER                   PIC X.                           
015981             15 PV-WEB-EFF-END-MONTH     PIC X(2).                        
015982             15 FILLER                   PIC X.                           
015983             15 PV-WEB-EFF-END-DAY       PIC X(2).                        
015984         10  PV-WEB-EFF-END-TIME         PIC X(16).                       
015993     05  PV-4-DAY-OUT-DATE.                                               
015994         10  PV-4-DAY-YEAR               PIC X(4).                        
015995         10  FILLER                      PIC X.                           
015996         10  PV-4-DAY-MONTH              PIC X(2).                        
015997         10  FILLER                      PIC X.                           
015998         10  PV-4-DAY-DAY                PIC X(2).                        
015999     05  PV-27-DAY-OUT-DATE.                                              
016000         10  PV-27-DAY-YEAR              PIC X(4).                        
016001         10  FILLER                      PIC X.                           
016002         10  PV-27-DAY-MONTH             PIC X(2).                        
016010         10  FILLER                      PIC X.                           
016100         10  PV-27-DAY-DAY               PIC X(2).                        
016101     05  PV-12-DAY-OUT-DATE.                                              
016102         10  PV-12-DAY-YEAR              PIC X(4).                        
016103         10  FILLER                      PIC X.                           
016104         10  PV-12-DAY-MONTH             PIC X(2).                        
016105         10  FILLER                      PIC X.                           
016106         10  PV-12-DAY-DAY               PIC X(2).                        
016107     05  PV-16-DAY-OUT-DATE.                                              
016108         10  PV-16-DAY-YEAR              PIC X(4).                        
016109         10  FILLER                      PIC X.                           
016110         10  PV-16-DAY-MONTH             PIC X(2).                        
016111         10  FILLER                      PIC X.                           
016112         10  PV-16-DAY-DAY               PIC X(2).                        
039860                                                                          
039861 01  PS-PROGRAM-SWITCHES-FLAGS.                                           
039862     05  PS-END-OF-ITEM-CURSOR        PIC  X      VALUE 'N'.              
039863         88  END-OF-ITEM-CURSOR                   VALUE 'Y'.              
039864     05  PS-WEBITM-INFO               PIC  X      VALUE 'N'.              
039865         88  WEBITM-INFO                          VALUE 'Y'.              
039866         88  NO-WEBITM-INFO                       VALUE 'N'.              
039867     05  PS-REPORT1-WRITTEN           PIC  X      VALUE 'N'.              
039868         88  RECORDS-WRITTEN1                     VALUE 'Y'.              
039869         88  NO-RECORDS-WRITTEN1                  VALUE 'N'.              
039870     05  PS-REPORT2-WRITTEN           PIC  X      VALUE 'N'.              
039871         88  RECORDS-WRITTEN2                     VALUE 'Y'.              
039872         88  NO-RECORDS-WRITTEN2                  VALUE 'N'.              
039873                                                                          
039874 01  CT-CPU-TIME.                                                         
039875     05  CT-CPU-HR                    PIC 9(2)       VALUE ZEROS.         
039876     05  CT-CPU-MIN                   PIC 9(2)       VALUE ZEROS.         
039877     05  CT-CPU-SEC                   PIC 9(2)       VALUE ZEROS.         
039878     05  CT-CPU-HSEC                  PIC 9(2)       VALUE ZEROS.         
039879                                                                          
039880 01  CD-SCHEDULE-DATE                 PIC X(10).                          
039881 01  CD-DATE REDEFINES CD-SCHEDULE-DATE.                                  
039882     05  CD-YEAR                      PIC 9(4).                           
039883     05  FILLER                       PIC X.                              
039884     05  CD-MONTH                     PIC 99.                             
039885     05  FILLER                       PIC X.                              
039886     05  CD-DAY                       PIC 99.                             
039887                                                                          
039888 01  PC-CONSTANTS.                                                        
039889     05  PC-ONE                       PIC S9(2)   VALUE +1.               
039890     05  PC-TWO                       PIC S9(2)   VALUE +2.               
039891     05  PC-FIVE                      PIC S9(2)   VALUE +5.               
039892     05  PC-SEVEN                     PIC S9(2)   VALUE +7.               
039893     05  PC-EIGHT                     PIC S9(2)   VALUE +8.               
039894     05  PC-PGM-NAME                  PIC  X(08)  VALUE                   
039895                                                  'MRKUP103'.             
039896     05  PC-ROW-NOT-FOUND             PIC S9(04)  VALUE +100              
039897                                                  COMP SYNC.              
039898     05  PC-X                         PIC  X(1)   VALUE 'X'.              
039899     05  PC-MAX-LINES                 PIC S9(3)                           
039900                                      COMP-3      VALUE +60.              
057157     05  PC-PGM-DPKUT500              PIC X(8)   VALUE 'DPKUT500'.        
057158     05  PC-F2                        PIC  X(2)   VALUE 'F2'.             
057159                                                                          
057160*---------------------------------------------------------------*         
057161*   COPYBOOK FOR DATE MODULE                                              
057162*---------------------------------------------------------------*         
057163     COPY DPWS500.                                                        
057164*                                                                         
057165******************************************************************        
057166** STANDARD HEADER LINE - KOHLS 132 COL                          *        
057167******************************************************************        
057168     COPY DPWS132.                                                        
057169                                                                          
057170******************************************************************        
057171** REPORT 1                                                      *        
057172******************************************************************        
057173 01  HL-HEADING-LINE11.                                                   
057174     05  FILLER                       PIC  X(46)  VALUE SPACES.           
057175     05  FILLER                       PIC  X(40)  VALUE                   
057176         'ACTIVE INFOREM SKUS NO LONGER WEB ACTIVE'.                      
057179     05  FILLER                       PIC  X(46)  VALUE SPACES.           
057180                                                                          
057181 01  HL-HEADING-LINE12.                                                   
057182     05  FILLER                       PIC  X(46)  VALUE SPACES.           
057183     05  FILLER                       PIC  X(40)  VALUE                   
057184         '   FT CODES SET TO = X (DISCONTINUED)   '.                      
057185     05  FILLER                       PIC  X(46)  VALUE SPACES.           
057186                                                                          
057187 01  BL-BREAK-LINE1.                                                      
057188     05  FILLER                       PIC  X(14)  VALUE                   
057189         ' DEPARTMENT:  '.                                                
057190     05  BL1-DEPT-NUMBER              PIC  Z(3).                          
057191     05  FILLER                       PIC  X(19)  VALUE                   
057192         '     MAJOR CLASS:  '.                                           
057193     05  BL1-MAJOR-CLASS              PIC  X(1).                          
057194     05  FILLER                       PIC  X(16)  VALUE                   
057195         '    SUB CLASS:  '.                                              
057196     05  BL1-SUB-CLASS                PIC  X(1).                          
057197     05  FILLER                       PIC  X(78)  VALUE SPACES.           
057198                                                                          
057199 01  CL-COLUMN-LINE11.                                                    
057213     05  FILLER                       PIC  X(101) VALUE SPACES.           
057214     05  FILLER                       PIC  X(10)  VALUE                   
057215         'BEGIN EFF'.                                                     
057216     05  FILLER                       PIC  X(2)   VALUE SPACES.           
057217     05  FILLER                       PIC  X(10)  VALUE                   
057218         'END EFF'.                                                       
057219     05  FILLER                       PIC  X(2)   VALUE SPACES.           
057220     05  FILLER                       PIC  X(07)  VALUE                   
057221         'ONHAND'.                                                        
057222                                                                          
057229                                                                          
057230 01  CL-COLUMN-LINE21.                                                    
057231     05  FILLER                       PIC  X(1)   VALUE SPACES.           
057232     05  FILLER                       PIC  X(02)  VALUE 'CL'.             
057233     05  FILLER                       PIC  X(1)   VALUE SPACES.           
057234     05  FILLER                       PIC  X(08)  VALUE 'SKU'.            
057235     05  FILLER                       PIC  X(1)   VALUE SPACES.           
057236     05  FILLER                       PIC  X(5)   VALUE 'STORE'.          
057237     05  FILLER                       PIC  X(1)   VALUE SPACES.           
057238     05  FILLER                       PIC  X(30)  VALUE 'VENDOR'.         
057239     05  FILLER                       PIC  X(2)   VALUE SPACES.           
057240     05  FILLER                       PIC  X(20)  VALUE 'STYLE'.          
057241     05  FILLER                       PIC  X(3)   VALUE SPACES.           
057242     05  FILLER                       PIC  X(25)  VALUE                   
057243         'STYLE DESCRIPTION'.                                             
057244     05  FILLER                       PIC  X(2)   VALUE SPACES.           
057245     05  FILLER                       PIC  X(10)  VALUE 'DATE'.           
057246     05  FILLER                       PIC  X(2)   VALUE SPACES.           
057247     05  FILLER                       PIC  X(10)  VALUE 'DATE'.           
057248     05  FILLER                       PIC  X(2)   VALUE SPACES.           
057249     05  FILLER                       PIC  X(07)  VALUE 'QTY'.            
057250                                                                          
057251 01  CL-COLUMN-DASH1.                                                     
057252     05  FILLER                       PIC  X(1)   VALUE SPACES.           
057253     05  FILLER                       PIC  X(02)  VALUE '--'.             
057254     05  FILLER                       PIC  X(1)   VALUE SPACES.           
057255     05  FILLER                       PIC  X(08)  VALUE '---'.            
057256     05  FILLER                       PIC  X(1)   VALUE SPACES.           
057257     05  FILLER                       PIC  X(5)   VALUE '-----'.          
057258     05  FILLER                       PIC  X(1)   VALUE SPACES.           
057259     05  FILLER                       PIC  X(30)  VALUE '------'.         
057260     05  FILLER                       PIC  X(2)   VALUE SPACES.           
057261     05  FILLER                       PIC  X(20)  VALUE '-----'.          
057262     05  FILLER                       PIC  X(3)   VALUE SPACES.           
057263     05  FILLER                       PIC  X(25)  VALUE                   
057264         '-----------------'.                                             
057265     05  FILLER                       PIC  X(2)   VALUE SPACES.           
057266     05  FILLER                       PIC  X(10)  VALUE '----'.           
057267     05  FILLER                       PIC  X(2)   VALUE SPACES.           
057268     05  FILLER                       PIC  X(10)  VALUE '----'.           
057269     05  FILLER                       PIC  X(2)   VALUE SPACES.           
057270     05  FILLER                       PIC  X(07)  VALUE '---'.            
057271                                                                          
057272 01  DETAIL-LINE1.                                                        
057273     05  FILLER                       PIC  X(1)   VALUE SPACES.           
057278     05  DL1-CLASS                    PIC  X(02)  VALUE SPACE.            
057279     05  FILLER                       PIC  X(1)   VALUE SPACES.           
057280     05  DL1-SKU                      PIC  Z(08)  VALUE ZERO.             
057285     05  FILLER                       PIC  X(1)   VALUE SPACES.           
057286     05  DL1-STORE                    PIC  ZZZZ9.                         
057287     05  FILLER                       PIC  X(1)   VALUE SPACES.           
057288     05  DL1-VENDOR                   PIC  X(30).                         
057289     05  FILLER                       PIC  X(2)   VALUE SPACES.           
057290     05  DL1-STYLE                    PIC  X(20).                         
057291     05  FILLER                       PIC  X(3)   VALUE SPACES.           
057292     05  DL1-STYLE-DESCRIPTION        PIC  X(25).                         
057293     05  FILLER                       PIC  X(2)   VALUE SPACES.           
057294     05  DL1-BEGIN-DATE               PIC  X(10).                         
057295     05  FILLER                       PIC  X(2)   VALUE SPACES.           
057296     05  DL1-END-DATE                 PIC  X(10).                         
057297     05  FILLER                       PIC  X(2)   VALUE SPACES.           
057298     05  DL1-ONHAND                   PIC  ZZZZZZ9.                       
057299                                                                          
057300******************************************************************        
057301** REPORT 2                                                      *        
057302******************************************************************        
057303 01  HL-HEADING-LINE2.                                                    
057304     05  FILLER                       PIC  X(39)  VALUE SPACES.           
057305     05  FILLER                       PIC  X(53)  VALUE                   
057306         'ACTIVE INFOREM E-COMMERCE SKUS PENDING WEB EXPIRATION'.         
057309     05  FILLER                       PIC  X(40)  VALUE SPACES.           
057310                                                                          
057311 01  BL-BREAK-LINE2.                                                      
057312     05  FILLER                       PIC  X(14)  VALUE                   
057313         ' DEPARTMENT:  '.                                                
057314     05  BL2-DEPT-NUMBER              PIC  Z(3).                          
057315     05  FILLER                       PIC  X(19)  VALUE                   
057316         '     MAJOR CLASS:  '.                                           
057317     05  BL2-MAJOR-CLASS              PIC  X(1).                          
057318     05  FILLER                       PIC  X(16)  VALUE                   
057319         '    SUB CLASS:  '.                                              
057320     05  BL2-SUB-CLASS                PIC  X(1).                          
057321     05  FILLER                       PIC  X(78)  VALUE SPACES.           
057322                                                                          
057323 01  CL-COLUMN-LINE12.                                                    
057331     05  FILLER                       PIC  X(20)  VALUE SPACES.           
057332     05  FILLER                       PIC  X(04)  VALUE 'DAYS'.           
057333     05  FILLER                       PIC  X(79)  VALUE SPACES.           
057343     05  FILLER                       PIC  X(10)  VALUE                   
057344         'BEGIN EFF'.                                                     
057345     05  FILLER                       PIC  X(1)   VALUE SPACES.           
057346     05  FILLER                       PIC  X(10)  VALUE                   
057347         'END EFF'.                                                       
057348     05  FILLER                       PIC  X(1)   VALUE SPACES.           
057349     05  FILLER                       PIC  X(07)  VALUE 'QTY'.            
057357                                                                          
057358 01  CL-COLUMN-LINE22.                                                    
057359     05  FILLER                       PIC  X(1)   VALUE SPACES.           
057360     05  FILLER                       PIC  X(02)  VALUE 'CL'.             
057361     05  FILLER                       PIC  X(1)   VALUE SPACES.           
057362     05  FILLER                       PIC  X(08)  VALUE                   
057363         'SKU     '.                                                      
057364     05  FILLER                       PIC  X(1)   VALUE SPACES.           
057365     05  FILLER                       PIC  X(5)   VALUE 'STORE'.          
057366     05  FILLER                       PIC  X(2)   VALUE SPACES.           
057367     05  FILLER                       PIC  X(04)  VALUE 'LEFT'.           
057368     05  FILLER                       PIC  X(1)   VALUE SPACES.           
057369     05  FILLER                       PIC  X(30)  VALUE                   
057370         'VENDOR'.                                                        
057371     05  FILLER                       PIC  X(1)   VALUE SPACES.           
057372     05  FILLER                       PIC  X(20)  VALUE                   
057373         'STYLE'.                                                         
057374     05  FILLER                       PIC  X(1)   VALUE SPACES.           
057375     05  FILLER                       PIC  X(25)  VALUE                   
057376         'STYLE DESCRIPTION'.                                             
057377     05  FILLER                       PIC  X(1)   VALUE SPACES.           
057378     05  FILLER                       PIC  X(10)  VALUE 'DATE'.           
057379     05  FILLER                       PIC  X(1)   VALUE SPACES.           
057380     05  FILLER                       PIC  X(10)  VALUE 'DATE'.           
057381     05  FILLER                       PIC  X(1)   VALUE SPACES.           
057382     05  FILLER                       PIC  X(07)  VALUE 'QTY'.            
057383                                                                          
057384 01  CL-COLUMN-DASH2.                                                     
057385     05  FILLER                       PIC  X(1)   VALUE SPACES.           
057386     05  FILLER                       PIC  X(02)  VALUE '--'.             
057387     05  FILLER                       PIC  X(1)   VALUE SPACES.           
057388     05  FILLER                       PIC  Z(08)  VALUE                   
057389         '--------'.                                                      
057390     05  FILLER                       PIC  X(1)   VALUE SPACES.           
057391     05  FILLER                       PIC  X(5)   VALUE '-----'.          
057392     05  FILLER                       PIC  X(2)   VALUE SPACES.           
057393     05  FILLER                       PIC  XX     VALUE '--'.             
057394     05  FILLER                       PIC  X(3)   VALUE SPACES.           
057395     05  FILLER                       PIC  X(30)  VALUE                   
057396         '------'.                                                        
057397     05  FILLER                       PIC  X(1)   VALUE SPACES.           
057398     05  FILLER                       PIC  X(20)  VALUE                   
057399         '-----'.                                                         
057400     05  FILLER                       PIC  X(1)   VALUE SPACES.           
057401     05  FILLER                       PIC  X(25)  VALUE                   
057402         '-----------------'.                                             
057403     05  FILLER                       PIC  X(1)   VALUE SPACES.           
057404     05  FILLER                       PIC  X(10)  VALUE '----'.           
057405     05  FILLER                       PIC  X(1)   VALUE SPACES.           
057406     05  FILLER                       PIC  X(10)  VALUE '----'.           
057407     05  FILLER                       PIC  X(1)   VALUE SPACES.           
057408     05  FILLER                       PIC  X(07)  VALUE '---'.            
057409                                                                          
057410 01  DETAIL-LINE2.                                                        
057411     05  FILLER                       PIC  X(1)   VALUE SPACES.           
057412     05  DL2-CLASS                    PIC  X(02)  VALUE SPACE.            
057413     05  FILLER                       PIC  X(1)   VALUE SPACES.           
057414     05  DL2-SKU                      PIC  Z(08)  VALUE ZERO.             
057415     05  FILLER                       PIC  X(1)   VALUE SPACES.           
057416     05  DL2-STORE                    PIC  ZZZZ9.                         
057417     05  FILLER                       PIC  X(3)   VALUE SPACES.           
057418     05  DL2-DAYS-TO-TURN-OFF         PIC  Z9.                            
057419     05  FILLER                       PIC  X(3)   VALUE SPACES.           
057420     05  DL2-VENDOR                   PIC  X(30).                         
057421     05  FILLER                       PIC  X(1)   VALUE SPACES.           
057422     05  DL2-STYLE                    PIC  X(20).                         
057423     05  FILLER                       PIC  X(1)   VALUE SPACES.           
057424     05  DL2-STYLE-DESCRIPTION        PIC  X(25).                         
057425     05  FILLER                       PIC  X(1)   VALUE SPACES.           
057426     05  DL2-BEGIN-DATE               PIC  X(10).                         
057427     05  FILLER                       PIC  X(1)   VALUE SPACES.           
057428     05  DL2-END-DATE                 PIC  X(10).                         
057429     05  FILLER                       PIC  X(1)   VALUE SPACES.           
057430     05  DL2-ONHAND                   PIC  ZZZZZZ9.                       
057431                                                                          
057432 01  END-OF-REPORT-LINE.                                                  
057433     05  FILLER                       PIC  X(25)  VALUE                   
057434         ' ** END OF REPORT **     '.                                     
057435                                                                          
057436 01  MSG-NO-ERROR-RECORDS.                                                
057437     05  FILLER                       PIC  X(50)  VALUE                   
057438      '          ** NO RECORDS WERE PROCESSED **         '.               
057439     05  FILLER                       PIC  X(50)  VALUE                   
057440      '                                                  '.               
057441     05  FILLER                       PIC  X(32)  VALUE SPACES.           
057442                                                                          
057443  EJECT.                                                                  
057444******************************************************************        
057445*    NI SKU WORK AREA FIELDS                                              
057446******************************************************************        
057447     COPY ISWS006.                                                        
057448******************************************************************        
057449                                                                          
057450************************                                                  
057451* DB2 TABLES                                                              
057452************************                                                  
057453                                                                          
057454     EXEC SQL                                                             
057455         INCLUDE TSKXREF                                                  
057456     END-EXEC.                                                            
057457                                                                          
057458     EXEC SQL                                                             
057459         INCLUDE TCKRSTCN                                                 
057460     END-EXEC.                                                            
057461                                                                          
057462     EXEC SQL                                                             
057463         INCLUDE TWEBITM                                                  
057464     END-EXEC.                                                            
057465                                                                          
057466     EXEC SQL                                                             
057467         INCLUDE TUPCPLS                                                  
057468     END-EXEC.                                                            
057469                                                                          
057470     EXEC SQL                                                             
057471         INCLUDE TSK                                                      
057472     END-EXEC.                                                            
057473                                                                          
057474     EXEC SQL                                                             
057475         INCLUDE TSKST                                                    
057476     END-EXEC.                                                            
057477                                                                          
057478     EXEC SQL                                                             
057479         INCLUDE XMT00001                                                 
057480     END-EXEC.                                                            
057481                                                                          
057482     EXEC SQL                                                             
057483         INCLUDE TMRITST                                                  
057484     END-EXEC.                                                            
057485                                                                          
057486     EXEC SQL                                                             
057487         INCLUDE TMRITEM                                                  
057488     END-EXEC.                                                            
057489                                                                          
057490     EXEC SQL                                                             
057491         INCLUDE TENTNME                                                  
057492     END-EXEC.                                                            
057493                                                                          
057494************************                                                  
057495* DB2 COMMUNICATION AREA                                                  
057496************************                                                  
057497                                                                          
057498     EXEC SQL                                                             
057499         INCLUDE SQLCA                                                    
057500     END-EXEC.                                                            
057501                                                                          
057502     COPY SQLCA2.                                                         
057503                                                                          
057504************************                                                  
057505* DB2 CURSORS                                                             
057506************************                                                  
057507                                                                          
057508     EXEC SQL                                                             
057509       DECLARE ITEM-LEVEL CURSOR WITH HOLD FOR                            
057510             SELECT D.ITEM_NBR                                            
057511                  , D.STR_NBR                                             
057512                  , G.DEPT                                                
057513                  , G.SUBCLASS                                            
057514                  , G.SKU                                                 
057515                  , F.SKU_DESC                                            
057516                  , F.LONG_VENDOR_STYLE                                   
057517                  , F.ENT_ID                                              
057518              FROM TMRITEM   C                                            
057519                  ,TMRITST   D                                            
057520                  ,XMT_LOC   E                                            
057521                  ,TSK       F                                            
057522                  ,TSKXREF   G                                            
057524              WHERE C.ITEM_NBR      = F.ITEM_NMBR                         
057525               AND  D.ITEM_NBR      = C.ITEM_NBR                          
057526               AND  F.ITEM_NMBR     = G.ITM_NBR                           
057527               AND  D.STR_NBR       = E.LOC_NBR                           
057528               AND  E.E_BUS_IND     = 'Y'                                 
057529               AND  E.LOC_TYP_CDE   = 'DS'                                
057530               AND  D.FT_CDE       <> 'X'                                 
057531              ORDER BY G.DEPT                                             
057532                     , G.SUBCLASS                                         
057533                     , D.ITEM_NBR                                         
057534                     , D.STR_NBR                                          
057535     END-EXEC.                                                            
057536                                                                          
057537******************************************************************        
057538 PROCEDURE DIVISION.                                                      
057539******************************************************************        
057540 0000-MAINLINE.                                                           
057541                                                                          
057542     PERFORM 1000-INITIALIZE.                                             
057543                                                                          
057544     PERFORM 2000-PROCESS-ITEM-CURSOR                                     
057545         UNTIL END-OF-ITEM-CURSOR.                                        
057546                                                                          
057547     PERFORM 9900-EOJ-ROUTINE.                                            
057548     STOP RUN.                                                            
057549                                                                          
057550******************************************************************        
057551*  SET UP FOR PROGRAM PROCESSING BY GETTING THE SCHEDULE DATE,   *        
057552*  OPENING THE FILES, SETTING UP THE COMMIT TIMESTAMP, OPENING   *        
057553*  THE ITEM CURSOR, AND FETCHING THE FIRST ROW FROM THE CURSOR.  *        
057554******************************************************************        
057560 1000-INITIALIZE.                                                         
057600                                                                          
094897     MOVE '1000'                        TO PGM-LOCATION.                  
094898     MOVE '1000-INITIALIZE           '  TO AA-PARAGRAPH-NAME.             
094899                                                                          
094900     OPEN OUTPUT PRINT-REPORT1                                            
094901                 PRINT-REPORT2.                                           
094902                                                                          
094912     MOVE PC-PGM-NAME                 TO DP132-PROGRAM-NAME.              
094913                                                                          
094914     ACCEPT CT-CPU-TIME FROM TIME.                                        
094915     MOVE CT-CPU-HR                   TO DP132-RUN-HOUR.                  
094916     MOVE CT-CPU-MIN                  TO DP132-RUN-MINUTE.                
094917                                                                          
094918     ACCEPT CD-SCHEDULE-DATE.                                             
094919     MOVE CD-MONTH                    TO DP132-RUN-MONTH.                 
094920     MOVE CD-DAY                      TO DP132-RUN-DAY.                   
094921     MOVE CD-YEAR                     TO DP132-RUN-YEAR.                  
094922                                                                          
094923     PERFORM 1100-SETUP-COMPARISON-DATES.                                 
094924                                                                          
094925*  SET UP FIRST SCHEDULED COMMIT TIME                                     
094926                                                                          
094927     EXEC SQL                                                             
094928         SELECT  (CURRENT TIMESTAMP + CKPT_FRQNCY_QTY SECONDS)            
094929           INTO  :PV-COMMIT-TMST                                          
094930           FROM  TCKRSTCNTL                                               
094931          WHERE  PLAN_NAME = 'MRKUP103'                                   
094932     END-EXEC.                                                            
094933                                                                          
094934     IF SQLCODE = +0                                                      
094935         CONTINUE                                                         
094936     ELSE                                                                 
094937         DISPLAY AA-ABEND-LIT                                             
094938         DISPLAY AA-PROGRAM-LIT                                           
094939         DISPLAY AA-PARAGRAPH-LIT                                         
094940         PERFORM 9999-SQL-ERROR                                           
094941     END-IF.                                                              
094942                                                                          
094943     PERFORM 8000-OPEN-ITEM-LEVEL-CURSOR.                                 
094944     PERFORM 8100-FETCH-ITEM-CSR.                                         
094945                                                                          
156007     MOVE SKXREF-DEPT           TO NI-DEPT-9-3.                           
156008     MOVE NI-DEPT-X-3           TO PV-HOLD-DEPT1                          
156009                                   PV-HOLD-DEPT2.                         
156010                                                                          
156011     MOVE SKXREF-SUBCLASS        TO NI-SUB-CLASS-9-2.                     
156012     MOVE NI-SUB-CLASS-X-2       TO PV-HOLD-CLASS1                        
156013                                    PV-HOLD-CLASS2.                       
156014                                                                          
156015*****************************************************************         
156016* SETUP COMPARISON DATES.                                                 
156017*****************************************************************         
156018 1100-SETUP-COMPARISON-DATES.                                             
156019*                                                                         
156020     MOVE CD-DATE               TO PV-BEGIN-DATE.                         
156021                                                                          
156022     MOVE CD-DATE               TO DPG52-LK-DATE-INPUT.                   
156023     MOVE PC-F2                 TO DPG51-CALENDAR-TYPE.                   
156030     SET DPG52-LK-DTE-ISO-FMT   TO TRUE.                                  
156034     MOVE 30                    TO DPG51-INCR-DECR-DAYS-9.                
156035     SET DPG51-INCREMENT-DATE   TO TRUE.                                  
156036                                                                          
156037     PERFORM 1200-CALENDAR-ROUTINE.                                       
156038                                                                          
156039     MOVE DPG55-DB2-ISO-DATE-FMT TO PV-END-DATE.                          
156041                                                                          
156042     MOVE CD-DATE               TO DPG52-LK-DATE-INPUT.                   
156043     MOVE PC-F2                 TO DPG51-CALENDAR-TYPE.                   
156044     SET DPG52-LK-DTE-ISO-FMT   TO TRUE.                                  
156045     MOVE 4                     TO DPG51-INCR-DECR-DAYS-9.                
156046     SET DPG51-INCREMENT-DATE   TO TRUE.                                  
156047                                                                          
156048     PERFORM 1200-CALENDAR-ROUTINE.                                       
156049                                                                          
156050     MOVE DPG55-DB2-ISO-DATE-FMT TO PV-4-DAY-OUT-DATE                     
156051                                                                          
156052     MOVE CD-DATE               TO DPG52-LK-DATE-INPUT.                   
156053     MOVE PC-F2                 TO DPG51-CALENDAR-TYPE.                   
156054     SET DPG52-LK-DTE-ISO-FMT   TO TRUE.                                  
156055     MOVE 27                    TO DPG51-INCR-DECR-DAYS-9.                
156056     SET DPG51-INCREMENT-DATE   TO TRUE.                                  
156057                                                                          
156058     PERFORM 1200-CALENDAR-ROUTINE.                                       
156059                                                                          
156060     MOVE DPG55-DB2-ISO-DATE-FMT TO PV-27-DAY-OUT-DATE.                   
156070                                                                          
156071     MOVE CD-DATE               TO DPG52-LK-DATE-INPUT.                   
156072     MOVE PC-F2                 TO DPG51-CALENDAR-TYPE.                   
156073     SET DPG52-LK-DTE-ISO-FMT   TO TRUE.                                  
156074     MOVE 12                    TO DPG51-INCR-DECR-DAYS-9.                
156075     SET DPG51-INCREMENT-DATE   TO TRUE.                                  
156076                                                                          
156077     PERFORM 1200-CALENDAR-ROUTINE.                                       
156078                                                                          
156079     MOVE DPG55-DB2-ISO-DATE-FMT TO PV-12-DAY-OUT-DATE.                   
156080                                                                          
156081     MOVE CD-DATE               TO DPG52-LK-DATE-INPUT.                   
156082     MOVE PC-F2                 TO DPG51-CALENDAR-TYPE.                   
156083     SET DPG52-LK-DTE-ISO-FMT   TO TRUE.                                  
156084     MOVE 16                    TO DPG51-INCR-DECR-DAYS-9.                
156085     SET DPG51-INCREMENT-DATE   TO TRUE.                                  
156086                                                                          
156087     PERFORM 1200-CALENDAR-ROUTINE.                                       
156088                                                                          
156089     MOVE DPG55-DB2-ISO-DATE-FMT TO PV-16-DAY-OUT-DATE.                   
156090                                                                          
156093******************************************************************        
156094* CALL THE CALENDAR ROUTINE SUB PROGRAM                                   
156095******************************************************************        
156096 1200-CALENDAR-ROUTINE.                                                   
156097                                                                          
156098     CALL PC-PGM-DPKUT500 USING DPG51 DPG52                               
156099                                DPG53 DPG54                               
156100                                DPG55 DPG56.                              
156101     EVALUATE TRUE                                                        
156102     WHEN DPG54-SEVERE-ERROR                                              
156103         DISPLAY 'SEVERE ERROR IN CALENDAR ROUTINE'                       
156104         DISPLAY DPG54-ERROR-MESSAGE                                      
156105         DISPLAY 'INPUT DATE: '  DPG52-LK-DATE-INPUT                      
156106         CALL 'ILBOABN0'        USING ABEND-CODE                          
156107     WHEN DPG54-WARNING-ERROR                                             
156108         DISPLAY 'WARNING ERROR IN CALENDAR ROUTINE'                      
156109         DISPLAY DPG54-ERROR-MESSAGE                                      
156110     WHEN DPG54-NO-ERROR                                                  
156111         CONTINUE                                                         
156112     END-EVALUATE.                                                        
156113*                                                                         
156114*****************************************************************         
156115* PROCESS ITEM CURSOR.                                                    
156116*    WHEN ITEM NOT ON TWEBITEM                                            
156117*         CREATE REPORT 1 AND CHANGE FT-CODE TO 'X' ON TMRITST            
156118*    WHEN THE END EFF DATE ON TWEBITM IS BLANK                            
156119*         DO NOTHING                                                      
156120*    WHEN THE END EFF DATE ON TWEBITM IS LESS THAN TODAY                  
156121*         CREATE REPORT 1 AND CHANGE FT-CODE TO 'X' ON TMRITST            
156122*    WHEN THE END EFF DATE ON TWEBITM IS IN NEXT FOUR DAYS                
156123*         CREATE REPORT 2                                                 
156124*    WHEN THE END EFF DATE ON TWEBITM IS IN NEXT 12 TO 16 DAYS            
156125*         CREATE REPORT 2                                                 
156126*    WHEN THE END EFF DATE ON TWEBITM IS IN NEXT 27 TO 30 DAYS            
156127*         CREATE REPORT 2                                                 
156128*                                                                         
156129*****************************************************************         
156130 2000-PROCESS-ITEM-CURSOR.                                                
156131                                                                          
156132     SET WEBITM-INFO                    TO TRUE.                          
156133     PERFORM 8300-SELECT-TWEBITM.                                         
156134                                                                          
156135     EVALUATE TRUE                                                        
156136       WHEN NO-WEBITM-INFO                                                
156137           PERFORM 2100-CREATE-REPORT1                                    
156138           PERFORM 8600-UPDATE-TMRITST                                    
156139           PERFORM 9000-COMMIT-TEST                                       
156140       WHEN PV-WEB-EFF-END-DATE = SPACES                                  
156141           CONTINUE                                                       
156142       WHEN PV-WEB-EFF-END-DATE <= PV-BEGIN-DATE                          
156143           PERFORM 2100-CREATE-REPORT1                                    
156144           PERFORM 8600-UPDATE-TMRITST                                    
156145           PERFORM 9000-COMMIT-TEST                                       
156146       WHEN PV-WEB-EFF-END-DATE <= PV-4-DAY-OUT-DATE                      
156147           PERFORM 2200-CREATE-REPORT2                                    
156148       WHEN PV-WEB-EFF-END-DATE >= PV-12-DAY-OUT-DATE                     
156149        AND PV-WEB-EFF-END-DATE <= PV-16-DAY-OUT-DATE                     
156150           PERFORM 2200-CREATE-REPORT2                                    
156151       WHEN PV-WEB-EFF-END-DATE >= PV-27-DAY-OUT-DATE                     
156152        AND PV-WEB-EFF-END-DATE <= PV-END-DATE                            
156153           PERFORM 2200-CREATE-REPORT2                                    
156154     END-EVALUATE                                                         
156155                                                                          
156156     PERFORM 8100-FETCH-ITEM-CSR.                                         
156157                                                                          
156158*****************************************************************         
156159* CREATE REPORT FOR ITEMS TURNED OFF TMRITST.                   *         
156160*****************************************************************         
156161 2100-CREATE-REPORT1.                                                     
156162                                                                          
156163     PERFORM 8400-SELECT-ONHAND.                                          
156164     PERFORM 8500-SELECT-VENDOR-NAME.                                     
156165                                                                          
156169     MOVE SKXREF-SUBCLASS           TO NI-SUB-CLASS-9-2.                  
156170     MOVE NI-SUB-CLASS-X-2          TO DL1-CLASS.                         
156171                                                                          
156172     MOVE SKXREF-SKU                TO NI-SKU-9.                          
156173     MOVE NI-SKU-9                  TO DL1-SKU.                           
156174                                                                          
156175     MOVE MRITST-STR-NBR            TO DL1-STORE.                         
156176     MOVE ENTNME-ENT-NAME-DESC      TO DL1-VENDOR.                        
156177     MOVE TSK-LONG-VENDOR-STYLE     TO DL1-STYLE.                         
156178     MOVE TSK-SKU-DESC              TO DL1-STYLE-DESCRIPTION.             
156179     MOVE PV-WEB-EFF-BEG-DATE       TO DL1-BEGIN-DATE.                    
156180     MOVE PV-WEB-EFF-END-DATE       TO DL1-END-DATE.                      
156181     MOVE TSKST-ONHAND-QTY          TO DL1-ONHAND.                        
156182                                                                          
156183     PERFORM 7000-PRINT-REPORT1.                                          
156184                                                                          
156185*****************************************************************         
156186* CREATE REPORT FOR ITEMS THAT WILL GO OFF THE WEB IN THE NEAR  *         
156187* FUTURE.                                                       *         
156188*****************************************************************         
156189 2200-CREATE-REPORT2.                                                     
156190                                                                          
156191     PERFORM 8400-SELECT-ONHAND.                                          
156192     PERFORM 8500-SELECT-VENDOR-NAME.                                     
156193     PERFORM 2300-CALCULATE-DATES.                                        
156194                                                                          
156197     MOVE SKXREF-SUBCLASS           TO NI-SUB-CLASS-9-2.                  
156198     MOVE NI-SUB-CLASS-X-2          TO DL2-CLASS.                         
156199                                                                          
156200     MOVE SKXREF-SKU                TO NI-SKU-9.                          
156201     MOVE NI-SKU-9                  TO DL2-SKU.                           
156202                                                                          
156203     MOVE MRITST-STR-NBR            TO DL2-STORE.                         
156204     MOVE PV-DAYS-OFF-WEB           TO DL2-DAYS-TO-TURN-OFF.              
156205     MOVE ENTNME-ENT-NAME-DESC      TO DL2-VENDOR.                        
156206     MOVE TSK-LONG-VENDOR-STYLE     TO DL2-STYLE.                         
156207     MOVE TSK-SKU-DESC              TO DL2-STYLE-DESCRIPTION.             
156208     MOVE PV-WEB-EFF-BEG-DATE       TO DL2-BEGIN-DATE.                    
156209     MOVE PV-WEB-EFF-END-DATE       TO DL2-END-DATE.                      
156210     MOVE TSKST-ONHAND-QTY          TO DL2-ONHAND.                        
156211                                                                          
156212     PERFORM 7500-PRINT-REPORT2.                                          
156213                                                                          
156214*****************************************************************         
156215* CALCULATES THE NUMBER OF DAYS UNTIL OFF THE WEB                         
156216*****************************************************************         
156217 2300-CALCULATE-DATES.                                                    
156218                                                                          
156219     MOVE PC-F2                     TO DPG51-CALENDAR-TYPE.               
156220                                                                          
156221     SET DPG51-DO-NOT-INCR-DECR-DATE                                      
156222         DPG52-LK-DTE-ISO-FMT                                             
156223         DPG53-LK-CMPR-DTE-ISO-FMT    TO TRUE.                            
156224                                                                          
156225     MOVE PV-WEB-EFF-END-DATE       TO DPG52-LK-DATE-INPUT.               
156226     MOVE CD-SCHEDULE-DATE          TO DPG53-LK-CMPR-DATE-INPUT.          
156227                                                                          
156228     PERFORM 1200-CALENDAR-ROUTINE.                                       
156229                                                                          
156230     MOVE DPG55-DAYS-DIFFERENCE     TO PV-DAYS-OFF-WEB.                   
156231                                                                          
156232*****************************************************************         
156233* PRINT REPORT FOR ITEMS TURNED OFF TMRITST.                    *         
156234*****************************************************************         
156235 7000-PRINT-REPORT1.                                                      
156236                                                                          
156237     SET RECORDS-WRITTEN1              TO TRUE.                           
156238                                                                          
156239     MOVE SKXREF-DEPT                  TO NI-DEPT-9-3.                    
156240     IF NI-DEPT-X-3         NOT = PV-HOLD-DEPT1                           
156241         MOVE NI-DEPT-X-3              TO PV-HOLD-DEPT1                   
156242         MOVE SKXREF-SUBCLASS          TO NI-SUB-CLASS-9-2                
156243         MOVE NI-SUB-CLASS-X-2         TO PV-HOLD-CLASS1                  
156244         PERFORM 7100-PRINT-HEADINGS1                                     
156245     ELSE                                                                 
156246         MOVE SKXREF-SUBCLASS          TO NI-SUB-CLASS-9-2                
156247         IF NI-SUB-CLASS-X-2     NOT = PV-HOLD-CLASS1                     
156248             MOVE NI-SUB-CLASS-X-2     TO PV-HOLD-CLASS1                  
156249             IF PV-LINE-CNT1 + 6  > PC-MAX-LINES                          
156250                 PERFORM 7100-PRINT-HEADINGS1                             
156251             ELSE                                                         
156252                 PERFORM 7150-PRINT-CONTROL-BREAK1                        
156253             END-IF                                                       
156254         END-IF                                                           
156255     END-IF.                                                              
156256                                                                          
156257     IF PV-LINE-CNT1 > PC-MAX-LINES                                       
156258         PERFORM 7100-PRINT-HEADINGS1                                     
156259     END-IF.                                                              
156260                                                                          
156261     MOVE DETAIL-LINE1                 TO PRINT-LINE1.                    
156262     MOVE PC-ONE                       TO PV-LINE-CONTROL1.               
156263     PERFORM 7300-WRITE-PRINT-LINE1.                                      
156270                                                                          
156298     ADD  PC-ONE                       TO PV-LINE-CNT1.                   
156299                                                                          
156300*****************************************************************         
156301* PRINT HEADINGS FOR ITEMS TURNED OFF TMRITST.                  *         
156302*****************************************************************         
156303 7100-PRINT-HEADINGS1.                                                    
156304                                                                          
156305     ADD PC-ONE                         TO PV-PAGE-CNT1.                  
156306     MOVE PV-PAGE-CNT1                  TO DP132-PAGE-NUMBER.             
156307                                                                          
156308     MOVE 1                             TO DP132-REPORT-NUMBER.           
156309     MOVE DP132-STANDRD-HEADER-132-COLS TO PRINT-LINE1.                   
156310     MOVE PC-ONE                        TO PV-LINE-CONTROL1.              
156311     PERFORM 7200-WRITE-TOP-OF-PAGE1.                                     
156312                                                                          
156313     MOVE  HL-HEADING-LINE11            TO PRINT-LINE1.                   
156314     MOVE  PC-ONE                       TO PV-LINE-CONTROL1.              
156315     PERFORM 7300-WRITE-PRINT-LINE1.                                      
156316                                                                          
156317     MOVE  HL-HEADING-LINE12            TO PRINT-LINE1.                   
156318     MOVE  PC-ONE                       TO PV-LINE-CONTROL1.              
156319     PERFORM 7300-WRITE-PRINT-LINE1.                                      
156320                                                                          
156321     MOVE  SKXREF-DEPT                  TO NI-DEPT-9-3.                   
156322     MOVE  NI-DEPT-9-3                  TO BL1-DEPT-NUMBER.               
156323                                                                          
156324     MOVE  PV-HOLD-MJR-CLASS1           TO BL1-MAJOR-CLASS.               
156325     MOVE  PV-HOLD-SUB-CLASS1           TO BL1-SUB-CLASS.                 
156326                                                                          
156327     MOVE  BL-BREAK-LINE1               TO PRINT-LINE1.                   
156328     MOVE  PC-TWO                       TO PV-LINE-CONTROL1.              
156329     PERFORM 7300-WRITE-PRINT-LINE1.                                      
156330                                                                          
156331     MOVE  CL-COLUMN-LINE11             TO PRINT-LINE1.                   
156332     MOVE  PC-ONE                       TO PV-LINE-CONTROL1.              
156333     PERFORM 7300-WRITE-PRINT-LINE1.                                      
156334                                                                          
156335     MOVE  CL-COLUMN-LINE21             TO PRINT-LINE1.                   
156336     MOVE  PC-ONE                       TO PV-LINE-CONTROL1.              
156337     PERFORM 7300-WRITE-PRINT-LINE1.                                      
156338                                                                          
156339     MOVE  CL-COLUMN-DASH1              TO PRINT-LINE1.                   
156340     MOVE  PC-ONE                       TO PV-LINE-CONTROL1.              
156341     PERFORM 7300-WRITE-PRINT-LINE1.                                      
156342                                                                          
156343     MOVE  PC-EIGHT                     TO PV-LINE-CNT1.                  
156344                                                                          
156345*****************************************************************         
156346* PRINT CONTROL BREAK HEADERS FOR ITEMS TURNED OFF TMRITST.     *         
156347*****************************************************************         
156348 7150-PRINT-CONTROL-BREAK1.                                               
156349                                                                          
156350     MOVE  SKXREF-DEPT                  TO NI-DEPT-9-3.                   
156351     MOVE  NI-DEPT-9-3                  TO BL1-DEPT-NUMBER.               
156352                                                                          
156353     MOVE  PV-HOLD-MJR-CLASS1           TO BL1-MAJOR-CLASS.               
156354     MOVE  PV-HOLD-SUB-CLASS1           TO BL1-SUB-CLASS.                 
156355                                                                          
156356     MOVE  BL-BREAK-LINE1               TO PRINT-LINE1.                   
156357     MOVE  PC-TWO                       TO PV-LINE-CONTROL1.              
156358     PERFORM 7300-WRITE-PRINT-LINE1.                                      
156359                                                                          
156360     MOVE  CL-COLUMN-LINE11             TO PRINT-LINE1.                   
156361     MOVE  PC-ONE                       TO PV-LINE-CONTROL1.              
156362     PERFORM 7300-WRITE-PRINT-LINE1.                                      
156363                                                                          
156364     MOVE  CL-COLUMN-LINE21             TO PRINT-LINE1.                   
156365     MOVE  PC-ONE                       TO PV-LINE-CONTROL1.              
156366     PERFORM 7300-WRITE-PRINT-LINE1.                                      
156367                                                                          
156368     MOVE  CL-COLUMN-DASH1              TO PRINT-LINE1.                   
156369     MOVE  PC-ONE                       TO PV-LINE-CONTROL1.              
156370     PERFORM 7300-WRITE-PRINT-LINE1.                                      
156371                                                                          
156372     ADD   PC-FIVE                      TO PV-LINE-CNT1.                  
156373                                                                          
156374*****************************************************************         
156375* WRITE TOP OF NEW PAGE FOR ITEMS TURNED OFF TMRITST.           *         
156376*****************************************************************         
156377 7200-WRITE-TOP-OF-PAGE1.                                                 
156378                                                                          
156379     WRITE PRINT-LINE1                                                    
156380         AFTER ADVANCING PAGE.                                            
156381                                                                          
156382*****************************************************************         
156383* WRITE PRINT LINE FOR ITEMS TURNED OFF TMRITST.                *         
156384*****************************************************************         
156385 7300-WRITE-PRINT-LINE1.                                                  
156386                                                                          
156387     WRITE PRINT-LINE1                                                    
156388         AFTER ADVANCING PV-LINE-CONTROL1.                                
156389                                                                          
156390******************************************************************        
156391* 7400-PRINT-NO-RECORD-REPORT IS WRITTEN WHEN THERE ARE NO       *        
156392* ITEMS TURNED OFF TMRITST.                                      *        
156393******************************************************************        
156394 7400-PRINT-NO-RECORD-REPORT1.                                            
156395                                                                          
156396     MOVE SPACES                      TO TSK-MERCH-DEPT-NMBR.             
156397     MOVE SPACES                      TO PV-HOLD-DEPT1.                   
156398     MOVE SPACES                      TO PV-HOLD-CLASS1.                  
156399     PERFORM 7100-PRINT-HEADINGS1.                                        
156400     MOVE MSG-NO-ERROR-RECORDS        TO PRINT-LINE1.                     
156401     MOVE PC-TWO                      TO PV-LINE-CONTROL1.                
156402     PERFORM 7300-WRITE-PRINT-LINE1.                                      
156403                                                                          
156404*****************************************************************         
156405* PRINT REPORT FOR ITEMS THAT WILL GO OFF THE WEB IN THE NEAR   *         
156406* FUTURE.                                                       *         
156407*****************************************************************         
156408 7500-PRINT-REPORT2.                                                      
156409                                                                          
156410     SET RECORDS-WRITTEN2              TO TRUE.                           
156411                                                                          
156412     MOVE SKXREF-DEPT                  TO NI-DEPT-9-3.                    
156413     IF NI-DEPT-X-3         NOT = PV-HOLD-DEPT2                           
156414         MOVE NI-DEPT-X-3              TO PV-HOLD-DEPT2                   
156415         MOVE SKXREF-SUBCLASS          TO NI-SUB-CLASS-9-2                
156416         MOVE NI-SUB-CLASS-X-2         TO PV-HOLD-CLASS2                  
156417         PERFORM 7600-PRINT-HEADINGS2                                     
156418     ELSE                                                                 
156419         MOVE SKXREF-SUBCLASS          TO NI-SUB-CLASS-9-2                
156420         IF NI-SUB-CLASS-X-2     NOT = PV-HOLD-CLASS2                     
156421             MOVE NI-SUB-CLASS-X-2     TO PV-HOLD-CLASS2                  
156422             IF PV-LINE-CNT2 + 6  > PC-MAX-LINES                          
156423                 PERFORM 7600-PRINT-HEADINGS2                             
156424             ELSE                                                         
156425                 PERFORM 7650-PRINT-CONTROL-BREAK2                        
156426             END-IF                                                       
156427         END-IF                                                           
156428     END-IF.                                                              
156429                                                                          
156430     IF PV-LINE-CNT2 > PC-MAX-LINES                                       
156431         PERFORM 7600-PRINT-HEADINGS2                                     
156432     END-IF.                                                              
156433                                                                          
156434     MOVE DETAIL-LINE2                  TO PRINT-LINE2.                   
156435     MOVE PC-ONE                        TO PV-LINE-CONTROL2.              
156436     PERFORM 7800-WRITE-PRINT-LINE2.                                      
156437                                                                          
156438     ADD  PC-ONE                       TO PV-LINE-CNT2.                   
156439                                                                          
156440*****************************************************************         
156441* PRINT HEADINGS FOR ITEMS THAT WILL GO OFF THE WEB IN THE NEAR *         
156442* FUTURE.                                                       *         
156443*****************************************************************         
156444 7600-PRINT-HEADINGS2.                                                    
156445                                                                          
156446     ADD PC-ONE                         TO PV-PAGE-CNT2.                  
156447     MOVE PV-PAGE-CNT2                  TO DP132-PAGE-NUMBER.             
156448                                                                          
156449     MOVE 2                             TO DP132-REPORT-NUMBER.           
156450     MOVE DP132-STANDRD-HEADER-132-COLS TO PRINT-LINE2.                   
156451     MOVE PC-ONE                        TO PV-LINE-CONTROL2.              
156452     PERFORM 7700-WRITE-TOP-OF-PAGE2.                                     
156453                                                                          
156454     MOVE  HL-HEADING-LINE2             TO PRINT-LINE2.                   
156455     MOVE  PC-ONE                       TO PV-LINE-CONTROL2.              
156456     PERFORM 7800-WRITE-PRINT-LINE2.                                      
156457                                                                          
156458     MOVE  SKXREF-DEPT                  TO NI-DEPT-9-3.                   
156459     MOVE  NI-DEPT-9-3                  TO BL2-DEPT-NUMBER.               
156460     MOVE  PV-HOLD-MJR-CLASS2           TO BL2-MAJOR-CLASS.               
156461     MOVE  PV-HOLD-SUB-CLASS2           TO BL2-SUB-CLASS.                 
156462     MOVE  BL-BREAK-LINE2               TO PRINT-LINE2.                   
156463     MOVE  PC-TWO                       TO PV-LINE-CONTROL2.              
156464     PERFORM 7800-WRITE-PRINT-LINE2.                                      
156465                                                                          
156466     MOVE  CL-COLUMN-LINE12             TO PRINT-LINE2.                   
156467     MOVE  PC-ONE                       TO PV-LINE-CONTROL2.              
156468     PERFORM 7800-WRITE-PRINT-LINE2.                                      
156469                                                                          
156470     MOVE  CL-COLUMN-LINE22             TO PRINT-LINE2.                   
156471     MOVE  PC-ONE                       TO PV-LINE-CONTROL2.              
156472     PERFORM 7800-WRITE-PRINT-LINE2.                                      
156473                                                                          
156474     MOVE  CL-COLUMN-DASH2              TO PRINT-LINE2.                   
156475     MOVE  PC-ONE                       TO PV-LINE-CONTROL2.              
156476     PERFORM 7800-WRITE-PRINT-LINE2.                                      
156477                                                                          
156478     MOVE  PC-SEVEN                     TO PV-LINE-CNT2.                  
156479                                                                          
156480*****************************************************************         
156481* PRINT CONTROL BREAK HEADERS FOR ITEMS THAT WILL GO OFF THE WEB*         
156482* IN THE NEAR FUTURE.                                           *         
156483*****************************************************************         
156484 7650-PRINT-CONTROL-BREAK2.                                               
156485                                                                          
156486     MOVE  SKXREF-DEPT                  TO NI-DEPT-9-3.                   
156487     MOVE  NI-DEPT-9-3                  TO BL2-DEPT-NUMBER.               
156488     MOVE  PV-HOLD-MJR-CLASS2           TO BL2-MAJOR-CLASS.               
156489     MOVE  PV-HOLD-SUB-CLASS2           TO BL2-SUB-CLASS.                 
156490     MOVE  BL-BREAK-LINE2               TO PRINT-LINE2.                   
156491     MOVE  PC-TWO                       TO PV-LINE-CONTROL2.              
156492     PERFORM 7800-WRITE-PRINT-LINE2.                                      
156493                                                                          
156494     MOVE  CL-COLUMN-LINE12             TO PRINT-LINE2.                   
156495     MOVE  PC-TWO                       TO PV-LINE-CONTROL2.              
156496     PERFORM 7800-WRITE-PRINT-LINE2.                                      
156497                                                                          
156498     MOVE  CL-COLUMN-LINE22             TO PRINT-LINE2.                   
156499     MOVE  PC-ONE                       TO PV-LINE-CONTROL2.              
156500     PERFORM 7800-WRITE-PRINT-LINE2.                                      
156501                                                                          
156502     MOVE  CL-COLUMN-DASH2              TO PRINT-LINE2.                   
156503     MOVE  PC-ONE                       TO PV-LINE-CONTROL2.              
156504     PERFORM 7800-WRITE-PRINT-LINE2.                                      
156505                                                                          
156506     MOVE  SPACES                       TO PRINT-LINE2.                   
156507     MOVE  PC-ONE                       TO PV-LINE-CONTROL2.              
156508     PERFORM 7800-WRITE-PRINT-LINE2.                                      
156509                                                                          
156510     ADD   PC-FIVE                      TO PV-LINE-CNT2.                  
156511                                                                          
156512*****************************************************************         
156513* WRITE TOP OF NEW PAGE FOR ITEMS THAT WILL GO OFF THE WEB IN   *         
156514* THE NEAR FUTURE.                                              *         
156515*****************************************************************         
156516 7700-WRITE-TOP-OF-PAGE2.                                                 
156517                                                                          
156518     WRITE PRINT-LINE2                                                    
156519         AFTER ADVANCING PAGE.                                            
156520                                                                          
156521*****************************************************************         
156522* WRITE PRINT LINE FOR ITEMS THAT WILL GO OFF THE WEB IN THE    *         
156523* NEAR FUTURE.                                                  *         
156524*****************************************************************         
156525 7800-WRITE-PRINT-LINE2.                                                  
156526                                                                          
156527     WRITE PRINT-LINE2                                                    
156528         AFTER ADVANCING PV-LINE-CONTROL2.                                
156529                                                                          
156530******************************************************************        
156531* 7900-PRINT-NO-RECORD-REPORT IS WRITTEN WHEN THERE ARE NO ITEMS *        
156532* THAT WILL GO OFF THE WEB IN THE NEAR FUTURE.                   *        
156533******************************************************************        
156534 7900-PRINT-NO-RECORD-REPORT2.                                            
156535                                                                          
156536     MOVE ZERO                        TO SKXREF-DEPT.                     
156537     MOVE SPACES                      TO PV-HOLD-DEPT2.                   
156538     MOVE SPACES                      TO PV-HOLD-CLASS2.                  
156539     PERFORM 7600-PRINT-HEADINGS2.                                        
156540     MOVE MSG-NO-ERROR-RECORDS        TO PRINT-LINE2.                     
156541     MOVE PC-TWO                      TO PV-LINE-CONTROL2.                
156542     PERFORM 7800-WRITE-PRINT-LINE2.                                      
156543                                                                          
156544******************************************************************        
156545* OPEN ITEM-LEVEL                                                         
156546******************************************************************        
156547 8000-OPEN-ITEM-LEVEL-CURSOR.                                             
156548                                                                          
156549     MOVE '8000'                         TO PGM-LOCATION.                 
156550     MOVE '8000-OPEN-ITEM-LEVEL-CURSOR'  TO AA-PARAGRAPH-NAME.            
156551                                                                          
156552     EXEC SQL                                                             
156553         OPEN ITEM-LEVEL                                                  
156554     END-EXEC.                                                            
156555                                                                          
156556     EVALUATE TRUE                                                        
156557       WHEN SQLCODE         = ZERO                                        
156558       WHEN SQLCODE         = PC-ROW-NOT-FOUND                            
156559         CONTINUE                                                         
156560       WHEN OTHER                                                         
156561         DISPLAY AA-ABEND-LIT                                             
156562         DISPLAY AA-PROGRAM-LIT                                           
156563         DISPLAY AA-PARAGRAPH-LIT                                         
156564         PERFORM 9999-SQL-ERROR                                           
156565     END-EVALUATE.                                                        
156566                                                                          
156567******************************************************************        
156568* FETCHS ROW FROM THE ITEM-LEVEL CURSOR                                   
156569******************************************************************        
156570                                                                          
156571  8100-FETCH-ITEM-CSR.                                                    
156572                                                                          
156573     MOVE '8100'                        TO PGM-LOCATION.                  
156574     MOVE '8100-FETCH-STORE-CSR'        TO AA-PARAGRAPH-NAME.             
156575                                                                          
156576     EXEC SQL                                                             
156577       FETCH ITEM-LEVEL                                                   
156578         INTO :MRITST-ITEM-NBR                                            
156579            , :MRITST-STR-NBR                                             
156580            , :SKXREF-DEPT                                                
156581            , :SKXREF-SUBCLASS                                            
156582            , :SKXREF-SKU                                                 
156583            , :TSK-SKU-DESC                                               
156584            , :TSK-LONG-VENDOR-STYLE                                      
156585            , :TSK-ENT-ID                                                 
156586     END-EXEC.                                                            
156587                                                                          
156588     EVALUATE TRUE                                                        
156589       WHEN SQLCODE         = ZERO                                        
156590         CONTINUE                                                         
156591       WHEN SQLCODE         = PC-ROW-NOT-FOUND                            
156592         SET END-OF-ITEM-CURSOR             TO TRUE                       
156593       WHEN OTHER                                                         
156594         DISPLAY AA-ABEND-LIT                                             
156595         DISPLAY AA-PROGRAM-LIT                                           
156596         DISPLAY AA-PARAGRAPH-LIT                                         
156597         PERFORM 9999-SQL-ERROR                                           
156598     END-EVALUATE.                                                        
156599                                                                          
156600******************************************************************        
156601*  CLOSE THE ITEM CURSOR.                                        *        
156602******************************************************************        
156603 8200-CLOSE-ITEM-LEVEL-CSR.                                               
156604                                                                          
156605     MOVE '8200'                        TO PGM-LOCATION.                  
156606     MOVE '8200-CLOSE-ITEM-LEVEL-CSR'   TO AA-PARAGRAPH-NAME.             
156607                                                                          
156608     EXEC SQL                                                             
156609         CLOSE ITEM-LEVEL                                                 
156610     END-EXEC.                                                            
156611                                                                          
156612     EVALUATE TRUE                                                        
156613         WHEN SQLCODE EQUAL ZERO                                          
156614         WHEN SQLCODE EQUAL PC-ROW-NOT-FOUND                              
156615             CONTINUE                                                     
156616         WHEN OTHER                                                       
156617             DISPLAY AA-ABEND-LIT                                         
156618             DISPLAY AA-PROGRAM-LIT                                       
156619             DISPLAY AA-PARAGRAPH-LIT                                     
156620             PERFORM 9999-SQL-ERROR                                       
156621     END-EVALUATE.                                                        
156622                                                                          
156623*****************************************************************         
156624* SELECT TWEBITM.                                              *          
156625*****************************************************************         
156626 8300-SELECT-TWEBITM.                                                     
156627                                                                          
156628     MOVE '8300'                        TO PGM-LOCATION.                  
156629     MOVE '8300-SELECT-TWEBITM       '  TO AA-PARAGRAPH-NAME.             
156630                                                                          
156631     EXEC SQL                                                             
156632         SELECT  A.EFF_END_TMST,                                          
156633                 A.EFF_BEG_TMST                                           
156634         INTO   :PV-WEB-EFF-END-TIMESTAMP:PV-EFF-END-IND,                 
156635                :PV-WEB-EFF-BEG-TIMESTAMP:PV-EFF-BEG-IND                  
156636         FROM   TWEBITM  A                                                
156640               ,TUPCPLS  B                                                
480731         WHERE  B.UPC_ID                = A.INTR_UPC_ID                   
480732           AND  B.ITM_NBR               = :MRITST-ITEM-NBR                
480733           AND  B.OPERCO_NBR            = '03'                            
480734           AND  B.STR_NBR               = 0                               
480735           AND  B.EFF_BEG_TMST <= CURRENT TIMESTAMP                       
480736           AND (B.EFF_END_TMST IS NULL                                    
480737           OR   B.EFF_END_TMST >= CURRENT TIMESTAMP)                      
480738           AND  A.EFF_BEG_TMST  = (SELECT MAX (E.EFF_BEG_TMST)            
480739                FROM TWEBITM  E                                           
480740                WHERE A.INTR_UPC_ID     =  E.INTR_UPC_ID)                 
480741     END-EXEC.                                                            
480742                                                                          
480743     EVALUATE TRUE                                                        
480744       WHEN SQLCODE         = ZERO                                        
480745         IF PV-EFF-END-IND  = -1                                          
480746            MOVE SPACES     TO PV-WEB-EFF-END-TIMESTAMP                   
480747         END-IF                                                           
480748         IF PV-EFF-BEG-IND  = -1                                          
480749            MOVE SPACES     TO PV-WEB-EFF-BEG-TIMESTAMP                   
480750         END-IF                                                           
480751       WHEN SQLCODE         = PC-ROW-NOT-FOUND                            
480752         SET NO-WEBITM-INFO    TO TRUE                                    
480753         MOVE SPACES           TO PV-WEB-EFF-END-TIMESTAMP                
480754         MOVE SPACES           TO PV-WEB-EFF-BEG-TIMESTAMP                
480755       WHEN OTHER                                                         
480756         DISPLAY AA-ABEND-LIT                                             
480757         DISPLAY AA-PROGRAM-LIT                                           
480758         DISPLAY AA-PARAGRAPH-LIT                                         
480759         PERFORM 9999-SQL-ERROR                                           
480760     END-EVALUATE.                                                        
480761                                                                          
480762                                                                          
480763*****************************************************************         
480764* SELECT ONHAND FROM TSKST.                                     *         
480765*****************************************************************         
480766 8400-SELECT-ONHAND.                                                      
480767                                                                          
480768     MOVE '8400'                        TO PGM-LOCATION.                  
480769     MOVE '8400-SELECT-ONHAND        '  TO AA-PARAGRAPH-NAME.             
480770                                                                          
480771     EXEC SQL                                                             
480772         SELECT ONHAND_QTY                                                
480773         INTO   :TSKST-ONHAND-QTY                                         
480774         FROM   TSKST                                                     
480775         WHERE ITEM_NMBR      = :MRITST-ITEM-NBR                          
480776          AND  LOC_NBR        = :MRITST-STR-NBR                           
480777     END-EXEC.                                                            
480778                                                                          
480779     EVALUATE TRUE                                                        
480780       WHEN SQLCODE         = ZERO                                        
480781         CONTINUE                                                         
480782       WHEN SQLCODE         = PC-ROW-NOT-FOUND                            
480783         MOVE 0             TO TSKST-ONHAND-QTY                           
480784       WHEN OTHER                                                         
480785         DISPLAY AA-ABEND-LIT                                             
480786         DISPLAY AA-PROGRAM-LIT                                           
480787         DISPLAY AA-PARAGRAPH-LIT                                         
480788         PERFORM 9999-SQL-ERROR                                           
480789     END-EVALUATE.                                                        
480790                                                                          
480791*****************************************************************         
480792* SELECT VENDOR NAME.                                           *         
480793*****************************************************************         
480794 8500-SELECT-VENDOR-NAME.                                                 
480795                                                                          
480796     MOVE '8500'                        TO PGM-LOCATION.                  
480797     MOVE '8500-SELECT-VENDOR-NAME   '  TO AA-PARAGRAPH-NAME.             
480798                                                                          
480799     EXEC SQL                                                             
480800         SELECT ENT_NAME_DESC                                             
480801         INTO   :ENTNME-ENT-NAME-DESC                                     
480802         FROM   TENTNME                                                   
480803         WHERE  ENT_ID        = :TSK-ENT-ID                               
480804          AND   TYPE_CDE      = '04'                                      
480805     END-EXEC.                                                            
480806                                                                          
480807     EVALUATE TRUE                                                        
480808       WHEN SQLCODE         = ZERO                                        
480809         CONTINUE                                                         
480810       WHEN SQLCODE         = PC-ROW-NOT-FOUND                            
480811         CONTINUE                                                         
480812       WHEN OTHER                                                         
480813         DISPLAY AA-ABEND-LIT                                             
480814         DISPLAY AA-PROGRAM-LIT                                           
480815         DISPLAY AA-PARAGRAPH-LIT                                         
480816         PERFORM 9999-SQL-ERROR                                           
480817     END-EVALUATE.                                                        
480818                                                                          
480819*****************************************************************         
480820* UPDATE ROW IN THE TMRITST TABLE.                              *         
480821*****************************************************************         
480822 8600-UPDATE-TMRITST.                                                     
480823                                                                          
480824     MOVE '8600'                        TO PGM-LOCATION.                  
480825     MOVE '8600-UPDATE-TMRITST       '  TO AA-PARAGRAPH-NAME.             
480826                                                                          
480827     EXEC SQL                                                             
480828         UPDATE TMRITST                                                   
480829            SET   FT_CDE        = :PC-X                                   
480830            WHERE ITEM_NBR      = :MRITST-ITEM-NBR                        
480831             AND  STR_NBR       = :MRITST-STR-NBR                         
480832     END-EXEC.                                                            
480833                                                                          
480834     EVALUATE TRUE                                                        
480835       WHEN SQLCODE         = ZERO                                        
480836         CONTINUE                                                         
480837       WHEN SQLCODE         = PC-ROW-NOT-FOUND                            
480838         CONTINUE                                                         
480839       WHEN OTHER                                                         
480840         DISPLAY AA-ABEND-LIT                                             
480841         DISPLAY AA-PROGRAM-LIT                                           
480842         DISPLAY AA-PARAGRAPH-LIT                                         
480843         PERFORM 9999-SQL-ERROR                                           
480844     END-EVALUATE.                                                        
480845*                                                                         
480846******************************************************************        
480847*     DB2 COMMIT TEST                                            *        
480848******************************************************************        
480849 9000-COMMIT-TEST.                                                        
480850                                                                          
480851     MOVE '9000'                   TO PGM-LOCATION.                       
480852     MOVE '9000-COMMIT-TEST     '  TO AA-PARAGRAPH-NAME.                  
480853                                                                          
480854*  GET THE CURRENT TIMESTAMP                                              
480855                                                                          
480856     EXEC SQL                                                             
480857         SET :PV-CURR-TMST = CURRENT TIMESTAMP                            
480858     END-EXEC.                                                            
480859                                                                          
480860     IF SQLCODE = +0                                                      
480861         CONTINUE                                                         
480862     ELSE                                                                 
480863         DISPLAY AA-ABEND-LIT                                             
480864         DISPLAY AA-PROGRAM-LIT                                           
480865         DISPLAY AA-PARAGRAPH-LIT                                         
480866         PERFORM 9999-SQL-ERROR                                           
480867     END-IF.                                                              
480868                                                                          
480869*  COMPARE TO THE NEXT SCHEDULED COMMIT TIME                              
480870                                                                          
480871     IF PV-CURR-TMST > PV-COMMIT-TMST                                     
480872         PERFORM 9100-COMMIT-CHANGES                                      
480873     END-IF.                                                              
480874                                                                          
480875 EJECT                                                                    
480876                                                                          
480877*****************************************************************         
480878* COMMIT CHANGES.                                               *         
480879*****************************************************************         
480880 9100-COMMIT-CHANGES.                                                     
480881                                                                          
480882     MOVE '9100'                        TO PGM-LOCATION.                  
480883     MOVE '9100-COMMIT-CHANGES       '  TO AA-PARAGRAPH-NAME.             
480884                                                                          
480885     EXEC SQL                                                             
480886         COMMIT                                                           
480887     END-EXEC.                                                            
480888                                                                          
480889     IF SQLCODE = +0                                                      
480890         CONTINUE                                                         
480891     ELSE                                                                 
480892         DISPLAY AA-ABEND-LIT                                             
480893         DISPLAY AA-PROGRAM-LIT                                           
480894         DISPLAY AA-PARAGRAPH-LIT                                         
480895         PERFORM 9999-SQL-ERROR                                           
480896     END-IF.                                                              
480897                                                                          
480898*  GET THE NEXT SCHEDULED COMMIT TIME                                     
480899                                                                          
480900     EXEC SQL                                                             
480901         SELECT  (CURRENT TIMESTAMP + CKPT_FRQNCY_QTY SECONDS)            
480902           INTO  :PV-COMMIT-TMST                                          
480903           FROM  TCKRSTCNTL                                               
480904          WHERE  PLAN_NAME = 'MRKUP103'                                   
480905     END-EXEC.                                                            
480906                                                                          
480907     IF SQLCODE = +0                                                      
480908         CONTINUE                                                         
480909     ELSE                                                                 
480910         DISPLAY AA-ABEND-LIT                                             
480911         DISPLAY AA-PROGRAM-LIT                                           
480912         DISPLAY AA-PARAGRAPH-LIT                                         
480913         PERFORM 9999-SQL-ERROR                                           
480914     END-IF.                                                              
480915                                                                          
480916                                                                          
480917******************************************************************        
480918* END OF PROGRAM PROCESSING                                      *        
480919******************************************************************        
480920 9900-EOJ-ROUTINE.                                                        
480921                                                                          
480922     PERFORM 8200-CLOSE-ITEM-LEVEL-CSR.                                   
480923                                                                          
480924     IF NO-RECORDS-WRITTEN1                                               
480925         PERFORM 7400-PRINT-NO-RECORD-REPORT1                             
480926     ELSE                                                                 
480927         MOVE END-OF-REPORT-LINE         TO PRINT-LINE1                   
480928         MOVE PC-ONE                     TO PV-LINE-CONTROL1              
480929         PERFORM 7300-WRITE-PRINT-LINE1                                   
480930     END-IF.                                                              
480931                                                                          
480932     IF NO-RECORDS-WRITTEN2                                               
480933         PERFORM 7900-PRINT-NO-RECORD-REPORT2                             
480934     ELSE                                                                 
480935         MOVE END-OF-REPORT-LINE         TO PRINT-LINE2                   
480936         MOVE PC-ONE                     TO PV-LINE-CONTROL2              
480937         PERFORM 7800-WRITE-PRINT-LINE2                                   
480938     END-IF.                                                              
480939                                                                          
480940     CLOSE PRINT-REPORT1                                                  
480941           PRINT-REPORT2.                                                 
480942                                                                          
480943******************************************************************        
480944*   SQL ERROR MESSAGE ROUTINE                                             
480945******************************************************************        
480946 9999-SQL-ERROR.                                                          
480947                                                                          
480948     MOVE SQLCODE    TO SQLCODE2.                                         
480949     MOVE SQLERRD(3) TO SQLERRD3.                                         
480950     DISPLAY '** ABEND **       ** = SQLERROR'.                           
480951     DISPLAY '** PROGRAM        ** = MRKUP103'.                           
480952     DISPLAY '** SQLCODE        ** = ' SQLCODE2.                          
480953     DISPLAY '** ROWS PROCESSED ** = ' SQLERRD3.                          
480954     DISPLAY '** SQLERRM        ** = ' SQLERRM.                           
480955     DISPLAY '** SQLERRMC       ** = ' SQLERRMC.                          
480956     MOVE +4013 TO ABEND-CODE.                                            
480957     CALL 'ILBOABN0' USING ABEND-CODE.                                    
480958******************************************************************        
480959******************END OF PROGRAM   *******************************        
480960******************************************************************        
