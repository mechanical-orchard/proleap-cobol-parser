000100*                                                                 00010000
000200*       THIS PROCEDURE DIVISION COPY BOOK IS USED TO RECEIVE      00020000
000300*  THE CURRENT SCREEN, CAPTURE ANY NAVIGATION REQUESTS, AND       00030000
000400*  TRANSLATE THE EIBAID/COMMAND TO A NUMERIC REPRESENTATION.      00040000
000500*                                                                 00050000
000600*       BEFORE PERFORMING THE PARAGRAPH, THE FOLLOWING SWITCHES   00060000
000700*  MUST BE SET, TO TAILOR ANY ABENDS TO THE NEEDS OF THE          00070000
000800*  APPLICATION:                                                   00080000
000900*                                                                 00090000
001000*            DP013-RESTART-TERMINAL-IND                           00100000
001100*            DP013-ROLLBACK-IND                                   00110000
001200*            DP013-DISPLAY-PANEL-IND                              00120000
001300*            DP013-TRANSFER-OF-CONTROL-TYPE                       00130000
001400*                                                                 00140000
001500                                                                  00150000
001600 DP007-0000-GET-PANEL.                                            00160000
001700     MOVE LOW-VALUES TO MD-MAP-DATA-AREA.                         00170000
001800                                                                  00180000
001900     IF ((EIBAID NOT = DFHPA2)                                    00190000
002000             AND (EIBAID NOT = DFHCLEAR))                         00200000
002100         EXEC CICS                                                00210000
002200             RECEIVE                                              00220000
002300                 MAP    (PC-CURRENT-MAP-NAME)                     00230000
002400                 MAPSET (PC-CURRENT-MAPSET-NAME)                  00240000
002500                 INTO   (MD-MAP-DATA-AREA)                        00250000
002600                 RESP   (PV-CICS-RESPONSE)                        00260000
002700         END-EXEC                                                 00270000
002800         IF ((PV-CICS-RESPONSE NOT = DFHRESP(NORMAL))             00280000
002900                 AND (PV-CICS-RESPONSE NOT = DFHRESP(MAPFAIL)))   00290000
003000             SET DP013-CICS-ABEND TO TRUE                         00300000
003100             MOVE 'DP007-0000-GET-PANEL' TO DP013-PARAGRAPH       00310000
003200             STRING 'ATTEMPTING TO RECEIVE MAP '                  00320000
003300                                                DELIMITED BY SIZE 00330000
003400                    PC-CURRENT-MAP-NAME         DELIMITED BY SIZE 00340000
003500                    ' (MAPSET '                 DELIMITED BY SIZE 00350000
003600                    PC-CURRENT-MAPSET-NAME      DELIMITED BY SIZE 00360000
003700                    ')'                         DELIMITED BY SIZE 00370000
003800                 INTO DP013-MESSAGE-TEXT (1)                      00380000
003900             PERFORM DP013-0000-PROCESS-ABEND                     00390000
004000         ELSE                                                     00400000
004100             IF ANAVCMDL > ZERO                                   00410000
004200                 MOVE ANAVCMDI TO DP020-NAV-MNEMONIC              00420000
004300                 MOVE DP015-GREEN TO ANAVCMDC                     00430000
004400                 MOVE DP015-UNDERLINE TO ANAVCMDH                 00440000
004500                 MOVE DP015-UNP-ALP-NOR-OFF TO ANAVCMDA           00450000
004600             ELSE                                                 00460000
004700                 IF ANAVCMDA = DP015-ERASE-EOF                    00470000
004800                     INITIALIZE DP020-NAV-MNEMONIC                00480000
004900                     MOVE DP015-GREEN TO ANAVCMDC                 00490000
005000                     MOVE DP015-UNDERLINE TO ANAVCMDH             00500000
005100                     MOVE DP015-UNP-ALP-NOR-OFF TO ANAVCMDA       00510000
005200                 END-IF                                           00520000
005300             END-IF                                               00530000
005400             IF ANAVKEYL > ZERO                                   00540000
005500                 MOVE ANAVKEYI TO DP020-NAV-KEY-DATA              00550000
005600             ELSE                                                 00560000
005700                 IF ANAVKEYA = DP015-ERASE-EOF                    00570000
005800                     INITIALIZE DP020-NAV-KEY-DATA                00580000
005900                 END-IF                                           00590000
006000             END-IF                                               00600000
006100         END-IF                                                   00610000
006200     ELSE                                                         00620000
006300         IF EIBAID = DFHCLEAR                                     00630000
006400             INITIALIZE DP020-NAV-MNEMONIC                        00640000
006500                        DP020-NAV-KEY-DATA                        00650000
006600         END-IF                                                   00660000
006700     END-IF.                                                      00670000
006800                                                                  00680000
006900     MOVE EIBAID TO DP045-EIBAID.                                 00690000
007000     MOVE DP020-NAV-MNEMONIC TO DP045-NAVIGATION-MNEMONIC.        00700000
007100     CALL DP045-INTERR-AID-CMD-ROUTINE USING                      00710001
007110               DP045-INTERR-AID-COMMAND-PARMS.                    00711001
007200                                                                  00720000
007300     IF DP045-ERROR-DETECTED                                      00730000
007400         SET DP013-LOGIC-ABEND TO TRUE                            00740000
007500         MOVE 'DP007-0000-GET-PANEL' TO DP013-PARAGRAPH           00750000
007600         MOVE 'ATTEMPTING TO CONVERT AID KEY IN SUBROUTINE DPKUT0400760000
007700-                 '5' TO DP013-MESSAGE-TEXT (1)                   00770000
007800         PERFORM DP013-0000-PROCESS-ABEND                         00780000
007900     END-IF.                                                      00790000
008000                                                                  00800000
008100     MOVE DP045-SOURCE-AID-KEY TO DP020-SRC-AID.                  00810000
008200                                                                  00820000
008300     IF ((DP045-AID-KEY-CONVERTED)                                00830000
008400             OR ((DP020-SRC-AID NOT = DP016-ENTER)                00840000
008500             AND (DP020-SRC-AID NOT = DP016-PA2)                  00850000
008600             AND (DP020-NAV-MNEMONIC NOT = SPACES)))              00860000
008700         INITIALIZE DP020-NAV-MNEMONIC                            00870000
008800                    ANAVCMDI                                      00880000
008900         MOVE DP015-GREEN TO ANAVCMDC                             00890000
009000         MOVE DP015-UNDERLINE TO ANAVCMDH                         00900000
009100         MOVE DP015-UNP-ALP-NOR-OFF TO ANAVCMDA                   00910000
009200     END-IF.                                                      00920000
009300*DP007-0000-EXIT.                                                 00930000
