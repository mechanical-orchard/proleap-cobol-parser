000100******************************************************************00010019
000200******************************************************************00020019
000300 IDENTIFICATION DIVISION.                                         00030019
000400******************************************************************00040019
000500******************************************************************00050019
000600                                                                  00060019
000700 PROGRAM-ID.     BPKUT442.                                        00070020
000800 AUTHOR.         COGNIZANT.                                       00080020
000900 INSTALLATION.   KOHLS DEPARTMENT STORES.                         00090019
001000 DATE-WRITTEN.   04/29/2010.                                      00100020
001100 DATE-COMPILED.                                                   00110019
001200                                                                  00120019
001300******************************************************************00130019
001400*                                                                *00140019
001500*       FORMAT RECEIPTS BY PO TYPE FROM MERCHANDISE LEDGER.      *00150019
001600*                                                                *00160019
001700******************************************************************00170019
001800                                                                  00180019
001900******************************************************************00190019
002000*  CHANGES:                                                       00200019
002100*                                                                 00210019
002200*  04/29/2010     COGNIZANT    WR# 2344                           00351020
002300*     -  CHANGED THE PROGRAM FOR EP UPGRADE PROCESS.              00351121
002400*        PICKUP THE RETAIL & COST AMOUNTS FROM TWKPOSS BASED ON   00351221
002500*        PO-TYPE CODE FOR ACTUAL RECEIPTS STAGING TABLE IN EP.    00351321
002600*        POPULATE THE OUTPUT FILE USING BPRD150 COPY BOOK.                
C12018*                                                                         
C12018*  12/12/2017  J SELWITSCHKA   CHG0178437                         00351020
C12018*        ACCOUNT FOR PO TYPES 'LE', 'RE' AND 'VE'.                        
002700******************************************************************00360019
002800                                                                  00370019
002900******************************************************************00380019
003000******************************************************************00390019
003100 ENVIRONMENT DIVISION.                                            00400019
003200******************************************************************00410019
003300******************************************************************00420019
003400                                                                  00430019
003500******************************************************************00440019
003600 CONFIGURATION SECTION.                                           00450019
003700******************************************************************00460019
003800                                                                  00470019
003900 SOURCE-COMPUTER.        IBM-3090.                                00480019
004000 OBJECT-COMPUTER.        IBM-3090.                                00490019
004100                                                                  00500019
004200******************************************************************00510019
004300 INPUT-OUTPUT SECTION.                                            00520019
004400******************************************************************00530019
004500                                                                  00540019
004600 FILE-CONTROL.                                                    00550019
004700                                                                  00560019
004800     SELECT STORE-REC-TYPE-FILE                                   00570019
004900         ASSIGN TO INP01.                                         00580019
005000                                                                  00590019
005100     SELECT ECOMM-REC-TYPE-FILE                                   00600019
005200         ASSIGN TO INP02.                                         00610019
005300                                                                  00620019
005400     SELECT MTD-REC-TYPE-FILE                                     00630019
005500         ASSIGN TO OUT01.                                         00640019
005600 EJECT                                                            00650019
005700******************************************************************00660019
005800******************************************************************00670019
005900 DATA DIVISION.                                                   00680019
006000******************************************************************00690019
006100******************************************************************00700019
006200                                                                  00710019
006300******************************************************************00720019
006400 FILE SECTION.                                                    00730019
006500******************************************************************00740019
006600                                                                  00750019
006700 FD  STORE-REC-TYPE-FILE                                          00760019
006800     RECORDING MODE IS F                                          00770019
006900     LABEL RECORDS ARE STANDARD                                   00780019
007000     BLOCK CONTAINS 0 RECORDS.                                    00790019
007100                                                                  00800019
007200 01  STORE-REC-TYPE-RECORD            PIC X(30).                  00810019
007300                                                                  00820019
007400 FD  ECOMM-REC-TYPE-FILE                                          00830019
007500     RECORDING MODE IS F                                          00840019
007600     LABEL RECORDS ARE STANDARD                                   00850019
007700     BLOCK CONTAINS 0 RECORDS.                                    00860019
007800                                                                  00870019
007900 01  ECOMM-REC-TYPE-RECORD            PIC X(30).                  00880019
008000                                                                  00890019
008100 FD  MTD-REC-TYPE-FILE                                            00900019
008200     RECORDING MODE IS F                                          00910019
008300     LABEL RECORDS ARE STANDARD                                   00920019
008400     BLOCK CONTAINS 0 RECORDS.                                    00930019
008500                                                                  00940019
008600 01  MTD-REC-TYPE-RECORD              PIC X(700).                 00950021
008700                                                                  00960019
008800 EJECT                                                            00970019
008900******************************************************************00980019
009000 WORKING-STORAGE SECTION.                                         00990019
009100******************************************************************01000019
009200                                                                  01010019
009300 01  PC-PROGRAM-CONSTANTS.                                        01020019
009400                                                                  01070019
009500     05  PC-PHYSSTR                   PIC X(07) VALUE 'PHYSSTR'.  01080021
009600     05  PC-VIRTSTR                   PIC X(07) VALUE 'VIRTSTR'.  01090021
009700                                                                  01730019
009800 01  PS-PROGRAM-SWITCHES.                                         01740019
009900     05  PS-END-OF-STORE-DATA-SW      PIC X(01)  VALUE 'N'.       01780019
010000         88  PS-END-OF-STORE-DATA                VALUE 'Y'.       01790019
010100                                                                  01800019
010200     05  PS-END-OF-ECOMM-DATA-SW      PIC X(01)  VALUE 'N'.       01810019
010300         88  PS-END-OF-ECOMM-DATA                VALUE 'Y'.       01820019
010400                                                                  01830019
010500                                                                  01840019
010600 01  PV-PROGRAM-VARIABLES.                                        01850019
010700     05  PV-DB2-OPER-ATTEMPTED        PIC X(30).                  01860019
010800     05  PV-PARAGRAPH-NAME            PIC X(30).                  01870019
010900     05  PV-ABEND-CODE                PIC S9(04) COMP             01880019
011000                                                 VALUE ZERO.      01890019
011100     05  PV-MAJOR-CLASS-NBR.                                      01900019
011200         10  PV-MAJ-CL-NBR            PIC X(01)  VALUE SPACES.    01910019
011300         10  FILLER                   PIC X(01)  VALUE '0'.       01920019
011400     05 SW-STR-IND                    PIC X(01)  VALUE SPACES.    01931023
011500         88 SW-PHYSSTR                 VALUE 'P'.                 01932021
011600         88 SW-VIRTSTR                 VALUE 'V'.                 01932121
011700 EJECT                                                            01933021
011800******************************************************            01940019
011900     COPY BPRD420.                                                01950019
012000******************************************************            01960019
012100 EJECT                                                            01970019
012200******************************************************            01980019
012300     COPY BPRD435.                                                01990019
012400******************************************************            02000019
012500 EJECT                                                            02010019
012600******************************************************            02011021
012700* BP150 OUTPUT COPY BOOK LAYOUT                      *            02011121
012800******************************************************            02011221
012900     COPY BPRD150.                                                02012021
013000******************************************************            02013021
013100 EJECT                                                            02014021
013200****************************************************************  02020019
013300* DATE ATTRIBUTE TABLE                                            02030019
013400****************************************************************  02040019
013500                                                                  02050019
013600     EXEC SQL                                                     02060019
013700         INCLUDE TDTATTR                                          02070019
013800     END-EXEC.                                                    02080019
013900                                                                  02090019
014000****************************************************************  02100019
014100*  COMMUNICATION AREAS FOR DB2                                    02110019
014200****************************************************************  02120019
014300                                                                  02130019
014400     EXEC SQL                                                     02140019
014500         INCLUDE SQLCA                                            02150019
014600     END-EXEC.                                                    02160019
014700                                                                  02170019
014800******************************************************************02180019
014900* DB2 COMMUNICATION AREA 2                                        02190019
015000******************************************************************02200019
015100                                                                  02210019
015200     COPY SQLCA2.                                                 02220019
015300 EJECT                                                            02230019
015400******************************************************************02240019
015500******************************************************************02250019
015600 PROCEDURE DIVISION.                                              02260019
015700******************************************************************02270019
015800******************************************************************02280019
015900                                                                  02290019
016000 0000-MAINLINE.                                                   02300019
016100     PERFORM 1000-INITIALIZE.                                     02310019
016200                                                                  02320019
016300     PERFORM 2000-PROCESS-STORE-DATA                              02330019
016400             UNTIL PS-END-OF-STORE-DATA.                          02340019
016500                                                                  02350019
016600     PERFORM 8100-READ-ECOMM-RECORD.                              02360019
016700                                                                  02370019
016800     PERFORM 3000-PROCESS-ECOMM-DATA                              02380019
016900             UNTIL PS-END-OF-ECOMM-DATA.                          02390019
017000                                                                  02400019
017100     PERFORM 9000-END-OF-JOB.                                     02410019
017200                                                                  02420019
017300     STOP RUN.                                                    02430019
017400                                                                  02440019
017500                                                                  02450019
017600******************************************************************02460019
017700*                                                                *02470019
017800*   OPEN INPUT AND OUTPUT FILES AND PERFORM THE INITIAL READS.   *02480019
017900*                                                                *02490019
018000******************************************************************02500019
018100 1000-INITIALIZE.                                                 02510019
018200     OPEN INPUT  STORE-REC-TYPE-FILE                              02520019
018300                 ECOMM-REC-TYPE-FILE.                             02530019
018400                                                                  02540019
018500     OPEN OUTPUT MTD-REC-TYPE-FILE.                               02550019
018600                                                                  02560019
018700     PERFORM 8000-READ-STORE-RECORD.                              02570019
018800 EJECT                                                            02580019
018900******************************************************************02590019
019000*                                                                *02600019
019100*                PROCESS ALL STORE RECEIPT DATA.                 *02610019
019200*                                                                *02620019
019300******************************************************************02630019
019400 2000-PROCESS-STORE-DATA.                                         02640019
019500                                                                  02650019
019600     SET SW-PHYSSTR TO TRUE.                                      02660021
019700     PERFORM 4000-FORMAT-OUPTUT-RECORD.                           02670019
019800                                                                  02680019
019900     PERFORM 8000-READ-STORE-RECORD.                              02690019
020000                                                                  02700019
020100                                                                  02710019
020200******************************************************************02720019
020300*                                                                *02730019
020400*              PROCESS ALL E-COMMERCE RECEIPT DATA.              *02740019
020500*                                                                *02750019
020600******************************************************************02760019
020700 3000-PROCESS-ECOMM-DATA.                                         02770019
020800                                                                  02780019
020900     SET SW-VIRTSTR TO TRUE.                                      02781021
021000     PERFORM 4000-FORMAT-OUPTUT-RECORD.                           02800019
021100                                                                  02810019
021200     PERFORM 8100-READ-ECOMM-RECORD.                              02820019
021300                                                                  02830019
021400                                                                  02840019
021500 4000-FORMAT-OUPTUT-RECORD.                                       02850019
021600     INITIALIZE BP150-RECORD.                                     02850121
021700     INITIALIZE BP150-ACTUAL-SALES.                               02850228
021800     INITIALIZE BP150-ACTUAL-RECEIPTS.                            02850328
021900     INITIALIZE MTD-REC-TYPE-RECORD.                              02850428
022000     IF SW-PHYSSTR                                                02851021
022100        MOVE PC-PHYSSTR TO BP150-ORGANIZATION-NAME2               02852021
022200     ELSE                                                         02853021
022300        MOVE PC-VIRTSTR TO BP150-ORGANIZATION-NAME2               02854021
022400     END-IF.                                                      02855021
022500                                                                  02860019
022600     MOVE BP420-DEPT-NBR     TO BP150-DEPARTMENT-NBR2             02870021
022700     MOVE BP420-MAJ-CL-NBR   TO PV-MAJ-CL-NBR                     02880029
022800     MOVE PV-MAJOR-CLASS-NBR TO BP150-CLASS-NBR2.                 02890021
022900                                                                  02900019
023000     PERFORM 7000-GET-TIME-PERIOD.                                02910019
023100                                                                  02920019
023200     PERFORM 7100-GET-VARIABLE-NAME-DLR.                          02930019
023300                                                                  02940019
023400     PERFORM 7200-GET-VARIABLE-NAME-CST.                          03020019
023500                                                                  03030019
023600     PERFORM 8200-WRITE-OUTPUT-FILE.                              03060019
023700                                                                  03070019
023800 EJECT                                                            03080019
023900******************************************************************03090019
024000*                                                                *03100019
024100* USING THE FSCL-WK-END-DTE, GET THE SEASON DESCRIPTION, FISCAL  *03110019
024200* YEAR # AND FISCAL WEEK # FROM THE DATE ATTRIBUTE TABLE FOR     *03120019
024300* CREATING THE TIME MEMBER FOR THE FORMATTED EP FILE.           * 03130021
024400*                                                                *03140019
024500******************************************************************03150019
024600 7000-GET-TIME-PERIOD.                                            03160019
024700     EXEC SQL                                                     03170019
024800          SELECT                                                  03180019
024900              SEA_DESC                                            03190019
025000             ,FSCL_YR_NBR                                         03200019
025100             ,FSCL_WK_NBR                                         03210019
025200          INTO                                                    03220019
025300              :DTATTR-SEA-DESC                                    03230019
025400             ,:DTATTR-FSCL-YR-NBR                                 03240019
025500             ,:DTATTR-FSCL-WK-NBR                                 03250019
025600          FROM                                                    03260019
025700              TDTATTR                                             03270019
025800          WHERE                                                   03280019
025900              KY_DTE = :BP420-FSCL-WK-END-DTE                     03290019
026000     END-EXEC.                                                    03300019
026100                                                                  03310019
026200     EVALUATE TRUE                                                03320019
026300         WHEN SQLCODE = ZERO                                      03330019
026400             MOVE DTATTR-SEA-DESC    TO BP150-SEASON2             03340021
026500             MOVE DTATTR-FSCL-YR-NBR TO BP150-YEAR2               03350021
026600             MOVE DTATTR-FSCL-WK-NBR TO BP150-WEEK-NBR2           03360021
026700         WHEN OTHER                                               03370019
026800             MOVE    '7000-GET-TIME-PERIOD'                       03380019
026900                                          TO PV-PARAGRAPH-NAME    03390019
027000             MOVE    'SELECT ROW FROM TDTATTR'                    03400019
027100                                          TO PV-DB2-OPER-ATTEMPTED03410019
027200             DISPLAY 'INPUT REC = '  BP420-RECORD                 03420019
027300             DISPLAY ' '                                          03430019
027400             PERFORM 9999-SQL-ABEND                               03440019
027500     END-EVALUATE.                                                03450019
027600 EJECT                                                            03460019
027700******************************************************************03470019
027800*                                                                *03480019
027900* DETERMINE WHAT PO TYPE CD CORRESPONDS TO THE RECORD THAT AMT$  *03490021
028000* BEING WRITTEN TO THE OUTPUT FILE.THIS IS SPECIFIC TO DLR AMTS$ *03500021
028100*                                                                *03520019
028200******************************************************************03521021
028300*   ARTHUR STANDARD IS ML DATA IN THE THOUSANDTHS (/ BY 1000)    *03522021
028400******************************************************************03523021
028500******************************************************************03530019
028600 7100-GET-VARIABLE-NAME-DLR.                                      03540019
028700*                                                                *03541021
028800     EVALUATE BP420-PO-TYP-CDE                                    03550019
028900         WHEN 'AP'                                                03560019
029000            DIVIDE BP420-RCPT-RTL-AMT BY 1000                     03564021
029100                                      GIVING BP150-ACCTPAY-DLR    03565021
029200         WHEN 'CD'                                                03580019
029300            DIVIDE BP420-RCPT-RTL-AMT BY 1000                     03581021
029400                                      GIVING BP150-CUST-DIR-DLR   03582021
029500         WHEN 'CN'                                                03600019
029600            DIVIDE BP420-RCPT-RTL-AMT BY 1000                     03601021
029700                                      GIVING BP150-CONSIGN-DLR    03602021
029800         WHEN 'CV'                                                03620019
029900            DIVIDE BP420-RCPT-RTL-AMT BY 1000                     03621021
030000                                      GIVING BP150-CONVERT-DLR    03622021
030100         WHEN 'EC'                                                03640019
030200            DIVIDE BP420-RCPT-RTL-AMT BY 1000                     03641021
030300                                      GIVING BP150-DECOM-DLR      03642021
030400         WHEN 'FB'                                                03660019
030500            DIVIDE BP420-RCPT-RTL-AMT BY 1000                     03661021
030600                                      GIVING BP150-FLBACK-DLR     03662021
C12018* INCLUDE PO TYPES 'LE', 'RE' AND 'VE'                            03680019
030700         WHEN 'IE'                                                03680019
C12018         WHEN 'LE'                                                03680019
C12018         WHEN 'RE'                                                03680019
C12018         WHEN 'VE'                                                03680019
030800            DIVIDE BP420-RCPT-RTL-AMT BY 1000                     03681021
030900                                      GIVING BP150-IECOM-DLR      03682021
031000         WHEN 'IF'                                                03700019
031100            DIVIDE BP420-RCPT-RTL-AMT BY 1000                     03701021
031200                                      GIVING BP150-I-FLBACK-DLR   03702021
031300         WHEN 'IM'                                                03720019
031400            DIVIDE BP420-RCPT-RTL-AMT BY 1000                     03721021
031500                                      GIVING BP150-IMPORT-DLR     03722021
031600         WHEN 'IN'                                                03740019
031700            DIVIDE BP420-RCPT-RTL-AMT BY 1000                     03741021
031800                                      GIVING BP150-INFOREM-DLR    03742021
031900         WHEN 'LD'                                                03760019
032000            DIVIDE BP420-RCPT-RTL-AMT BY 1000                     03761021
032100                                      GIVING BP150-LANDED-DLR     03762021
032200         WHEN 'MS'                                                03780019
032300            DIVIDE BP420-RCPT-RTL-AMT BY 1000                     03781021
032400                                      GIVING BP150-MODSTK-DLR     03782021
032500         WHEN 'SM'                                                03800019
032600            DIVIDE BP420-RCPT-RTL-AMT BY 1000                     03801021
032700                                      GIVING BP150-SAMPLES-DLR    03810021
032800         WHEN 'SP'                                                03820019
032900            DIVIDE BP420-RCPT-RTL-AMT BY 1000                     03821021
033000                                      GIVING BP150-SPECIAL-DLR    03822021
033100         WHEN 'ST'                                                03840019
033200            DIVIDE BP420-RCPT-RTL-AMT BY 1000                     03841021
033300                                      GIVING BP150-STANDARD-DLR   03842021
033400         WHEN 'VN'                                                03860019
033500            DIVIDE BP420-RCPT-RTL-AMT BY 1000                     03861021
033600                                      GIVING BP150-VENGEN-DLR     03862021
033700         WHEN OTHER                                               03880019
033800             DISPLAY 'BAD PO TYPE CODE'                           03890019
033900     END-EVALUATE.                                                03900019
034000 EJECT                                                            03910019
034100******************************************************************03920019
034200*                                                                *03930019
034300* DETERMINE WHAT PO TYPE CODE CORRESPONDS TO THE RECORD THAT AMT* 03940021
034400* BEING WRITTEN TO THE OUTPUT FILE.  THIS LIST CONTAINS COST AMTSY03950021
034500*                                                                *03970019
034600******************************************************************03971021
034700*   ARTHUR STANDARD IS ML DATA IN THE THOUSANDTHS (/ BY 1000)    *03972021
034800******************************************************************03973021
034900******************************************************************03974021
035000*                                                                *03976021
035100 7200-GET-VARIABLE-NAME-CST.                                      03976121
035200*                                                                *03976221
035300     EVALUATE BP420-PO-TYP-CDE                                    03977021
035400         WHEN 'AP'                                                03978021
035500            DIVIDE BP420-RCPT-NET-COST-AMT BY 1000                03979021
035600                                      GIVING BP150-ACCTPAY-CST    03979121
035700         WHEN 'CD'                                                03979221
035800            DIVIDE BP420-RCPT-NET-COST-AMT BY 1000                03979321
035900                                      GIVING BP150-CUST-DIR-CST   03979521
036000         WHEN 'CN'                                                03979621
036100            DIVIDE BP420-RCPT-NET-COST-AMT BY 1000                03979721
036200                                      GIVING BP150-CONSIGN-CST    03979921
036300         WHEN 'CV'                                                03980021
036400            DIVIDE BP420-RCPT-NET-COST-AMT BY 1000                03980121
036500                                      GIVING BP150-CONVERT-CST    03980321
036600         WHEN 'EC'                                                03980421
036700            DIVIDE BP420-RCPT-NET-COST-AMT BY 1000                03980521
036800                                      GIVING BP150-DECOM-CST      03980721
036900         WHEN 'FB'                                                03980821
037000            DIVIDE BP420-RCPT-NET-COST-AMT BY 1000                03980921
037100                                      GIVING BP150-FLBACK-CST     03981121
C12018* INCLUDE PO TYPES 'LE', 'RE' AND 'VE'                            03680019
037200         WHEN 'IE'                                                03981221
C12018         WHEN 'LE'                                                03680019
C12018         WHEN 'RE'                                                03680019
C12018         WHEN 'VE'                                                03680019
037300            DIVIDE BP420-RCPT-NET-COST-AMT BY 1000                03981321
037400                                      GIVING BP150-IECOM-CST      03981521
037500         WHEN 'IF'                                                03981621
037600            DIVIDE BP420-RCPT-NET-COST-AMT BY 1000                03981721
037700                                      GIVING BP150-I-FLBACK-CST   03981921
037800         WHEN 'IM'                                                03982021
037900            DIVIDE BP420-RCPT-NET-COST-AMT BY 1000                03982121
038000                                      GIVING BP150-IMPORT-CST     03982321
038100         WHEN 'IN'                                                03982421
038200            DIVIDE BP420-RCPT-NET-COST-AMT BY 1000                03982521
038300                                      GIVING BP150-INFOREM-CST    03982721
038400         WHEN 'LD'                                                03982821
038500            DIVIDE BP420-RCPT-NET-COST-AMT BY 1000                03982921
038600                                      GIVING BP150-LANDED-CST     03983121
038700         WHEN 'MS'                                                03983221
038800            DIVIDE BP420-RCPT-NET-COST-AMT BY 1000                03983321
038900                                      GIVING BP150-MODSTK-CST     03983521
039000         WHEN 'SM'                                                03983621
039100            DIVIDE BP420-RCPT-NET-COST-AMT BY 1000                03983721
039200                                      GIVING BP150-SAMPLES-CST    03983921
039300         WHEN 'SP'                                                03984021
039400            DIVIDE BP420-RCPT-NET-COST-AMT BY 1000                03984121
039500                                      GIVING BP150-SPECIAL-CST    03984321
039600         WHEN 'ST'                                                03984421
039700            DIVIDE BP420-RCPT-NET-COST-AMT BY 1000                03984521
039800                                      GIVING BP150-STANDARD-CST   03984721
039900         WHEN 'VN'                                                03984821
040000            DIVIDE BP420-RCPT-NET-COST-AMT BY 1000                03984921
040100                                      GIVING BP150-VENGEN-CST     03985121
040200         WHEN OTHER                                               03985221
040300             DISPLAY 'BAD PO TYPE CODE'                           03985321
040400     END-EVALUATE.                                                03985421
040500 EJECT                                                            03986021
040600******************************************************************04370019
040700*  THE FOLLOWING SECTIONS DO ALL OF THE FILE HANDLING            *04380019
040800******************************************************************04390019
040900 8000-READ-STORE-RECORD.                                          04400019
041000     READ STORE-REC-TYPE-FILE INTO BP420-RECORD                   04410019
041100       AT END SET PS-END-OF-STORE-DATA TO TRUE.                   04420019
041200                                                                  04430019
041300 8100-READ-ECOMM-RECORD.                                          04440019
041400     READ ECOMM-REC-TYPE-FILE INTO BP420-RECORD                   04450019
041500       AT END SET PS-END-OF-ECOMM-DATA TO TRUE.                   04460019
041600                                                                  04470019
041700 8200-WRITE-OUTPUT-FILE.                                          04480019
041800     INITIALIZE MTD-REC-TYPE-RECORD.                              04490025
041900     WRITE MTD-REC-TYPE-RECORD FROM BP150-ACTUAL-RECEIPTS.        04500024
042000                                                                  04510019
042100******************************************************************04520019
042200*                     CLOSE ALL OPEN FILES.                      *04530019
042300******************************************************************04540019
042400 9000-END-OF-JOB.                                                 04550019
042500                                                                  04560019
042600     CLOSE STORE-REC-TYPE-FILE                                    04570019
042700           ECOMM-REC-TYPE-FILE                                    04580019
042800           MTD-REC-TYPE-FILE.                                     04590019
042900 EJECT                                                            04600019
043000******************************************************************04610019
043100*  PERFORMS THE ABEND FOR THE PROGRAM IN THE EVENT THAT AN SQL   *04620019
043200*                 ERROR OR WARNING CODE OCCURS.                  *04630019
043300******************************************************************04640019
043400 9999-SQL-ABEND.                                                  04650019
043500                                                                  04660019
043600     MOVE SQLCODE        TO  SQLCODE2.                            04670019
043700     MOVE SQLERRD(3)     TO  SQLERRD3.                            04680019
043800                                                                  04690019
043900     DISPLAY '***************************'                        04700019
044000     DISPLAY '**       ABEND           **'                        04710019
044100     DISPLAY '**  IN PROGRAM BPKUT442  **'                        04720021
044200     DISPLAY '***************************'                        04730019
044300     DISPLAY '** PARAGRAPH **      = ' PV-PARAGRAPH-NAME          04740019
044400     DISPLAY '** OPERATION **      = ' PV-DB2-OPER-ATTEMPTED      04750019
044500     DISPLAY '** ROWS PROCESSED ** = ' SQLERRD3.                  04760019
044600     DISPLAY '** SQLCODE **        = ' SQLCODE2.                  04770019
044700                                                                  04780019
044800     MOVE +4013         TO PV-ABEND-CODE                          04790019
044900     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         04800019
