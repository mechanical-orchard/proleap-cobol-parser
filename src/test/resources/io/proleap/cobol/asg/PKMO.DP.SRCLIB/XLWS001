000100**************************************************************    00010099
000200*    ******                IMPORTANT                 ******  *    00020099
000300*   WHEN THE PROGRAM CHANGES IT MUST BE COMPILED FOR         *    00030099
000400*   BOTH BATCH AND CICS                                      *    00040099
000500*                                                            *    00050099
000600*   TO INVOKE THIS PROGRAM FROM A CICS EXIT YOU MUST USE THIS*    00060099
000700*   FORMAT:                                                  *    00070099
000800*     CALL XL001-VSM-PGM USING DFHEIBLK                      *    00080099
000900*                              XL001-COMMAREA                *    00090099
001000*                              XL001-ITEM-COMMAREA           *    00100099
001100*   IN BATCH DO THIS:                                        *    00110099
001200*     CALL XL001-VSM-PGM USING XL001-ITEM-COMMAREA           *    00120099
001300*    ******                IMPORTANT                 ******  *    00130099
001400*                                                            *    00140099
001500*     INITIALIZE XL001-ITEM-COMMAREA BEFORE CALLING XLKUT001 *    00150099
001600*                                                            *    00160099
001700*     XL001-ACCESS-METHODD IS REQUIRED                       *    00170099
001800*     AT LEASE ONE XL001-VIEW-SELECTION IS REQUIRED, AND     *    00180099
001900*        SELECTING ANY COMBINATION (OR ALL)                  *    00190099
002000*        XL001-VIEW-SELECTIONS IS VALID                      *    00200099
002100*     AT LEAST ONE OF THE XL001-KEYS IS REQUIRED             *    00210099
002200*                                                            *    00220099
002300*     XL001-KEY-STR-NBR IS ALWAYS OPTIONAL WITH ANY OTHER KEY*    00230099
002400*       IT WILL DEFAULT TO ZERO                              *    00240099
002500*     XL001-KEY-UPC-TYP-CDE IS ALWAYS OPTIONAL WITH ANY OTHER*    00250099
002600*       KEY. IT WILL DEFAULT TO 'I'                          *    00260099
002700*     NOTE - WHEN ACCESSING BY UPC-NUMBER TO ACCESS THE UPC  *    00270099
002800*     VIEW/TABLE, THE UPC-TYP-CDE IS NOT NEEDED              *    00280099
002900*                                                            *    00290099
003000*     REGARDING XL001-OUTPUT-FIELDS:                         *    00300099
003100*       XL001-INTR-UPC-ID IS ALWAYS RETURNED                 *    00310099
003200*       XL001-STYL-ID IS SHARED BY XLV_SKU AND XLV_VND_SYL   *    00320099
003300*                                                            *    00330099
003400*     XL001-SUCCESSFUL INCLUDES +100 ON WEB-SKU              *    00340099
003500*                                                            *    00350099
003600*     NOTE: IF FIELD(S) ARE ADDED TO THIS COPYBOOK           *    00360099
003700*           DECREMENT THE FILLER NEAR THE END OF THIS        *    00370099
003800*           COPYBOOK SO THE TOTAL LENGTH REMAINS THE SAME    *    00380099
003900*           AT LENGTH OF 1500                                *    00390099
004000**************************************************************    00400099
004100 01  XL001-ITEM-COMMAREA.                                         00410099
004200     05  XL001-ACCESS-METHOD          PIC X(04).                  00420099
004300         88  XL001-BY-NUMERIC-SKU           VALUE 'SKUN'.         00430099
004400         88  XL001-BY-ITEM                  VALUE 'ITEM'.         00440099
004500         88  XL001-BY-UPC-NBR               VALUE 'UPCN'.         00450099
004600         88  XL001-BY-INTR-UPC-ID           VALUE 'UPCI'.         00460099
004700     05  XL001-VIEW-SELECTION.                                    00470099
004800         10  XL001-SKU                PIC X VALUE 'N'.            00480099
004900             88  XL001-SELECT-SKU           VALUE 'Y'.            00490099
005000         10  XL001-VENDOR-STYLE       PIC X VALUE 'N'.            00500099
005100             88  XL001-SELECT-VND-STYL      VALUE 'Y'.            00510099
005200         10  XL001-SKU-STORE          PIC X VALUE 'N'.            00520099
005300             88  XL001-SELECT-SKU-STR       VALUE 'Y'.            00530099
005400         10  XL001-UPC                PIC X VALUE 'N'.            00540099
005500             88  XL001-SELECT-UPC           VALUE 'Y'.            00550099
005600         10  XL001-WEB-SKU            PIC X VALUE 'N'.            00560099
005700             88  XL001-SELECT-WEB-SKU       VALUE 'Y'.            00570099
005701* THE FOLLOWING SHOULD BE SET Y IF THE CALLING PROGRAM            00570199
005702* NEEDS TO GET THE XL001-SKU-STAT-CDE FROM TUPCPLS                00570299
005710         10  XL001-TUPCPLS            PIC X VALUE 'N'.            00571099
005720             88  XL001-SELECT-TUPCPLS       VALUE 'Y'.            00572099
005800         10  FILLER                   PIC X(2).                   00580099
005900     05  XL001-KEYS.                                              00590099
006000         10  XL001-KEY-INTR-UPC-ID    PIC S9(9) COMP.             00600099
006100         10  XL001-KEY-UPC-NBR        PIC S9(15)V COMP-3.         00610099
006200         10  XL001-KEY-ITM-NBR        PIC S9(15)V COMP-3.         00620099
006300         10  XL001-KEY-SKU            PIC S9(8)V COMP-3.          00630099
006400         10  XL001-KEY-STR-NBR        PIC S9(4) COMP.             00640099
006500         10  XL001-KEY-UPC-TYP-CDE    PIC X.                      00650099
006600     05  XL001-RETURN-CODE            PIC X(02).                  00660099
006700         88  XL001-SUCCESSFUL             VALUES ZERO.            00670099
006800         88  XL001-SQL-ERROR              VALUE '01'.             00680099
006900         88  XL001-INVALID-ACCESS         VALUE '99'.             00690099
007000     05  XL001-RETURN-SQLCODES.                                   00700099
007100         10  XL001-SKU-SQLCODE        PIC S9(9).                  00710099
007200             88  XL001-SKU-NOT-FOUND      VALUE  +100.            00720099
007300             88  XL001-SKU-CONTENTION     VALUES -904, -911, -913.00730099
007400         10  XL001-VND-STYL-SQLCODE   PIC S9(9).                  00740099
007500             88  XL001-VND-STYL-NOT-FOUND VALUE  +100.            00750099
007600             88  XL001-VND-STYL-CONTENTION                        00760099
007700                                          VALUES -904, -911, -913.00770099
007800         10  XL001-SKU-STR-SQLCODE    PIC S9(9).                  00780099
007900             88  XL001-SKU-STR-NOT-FOUND  VALUE  +100.            00790099
008000             88  XL001-SKU-STR-CONTENTION VALUES -904, -911, -913.00800099
008100         10  XL001-UPC-SQLCODE        PIC S9(9).                  00810099
008200             88  XL001-UPC-NOT-FOUND      VALUE  +100.            00820099
008300             88  XL001-UPC-CONTENTION     VALUES -904, -911, -913.00830099
008400         10  XL001-WEB-SKU-SQLCODE    PIC S9(9).                  00840099
008500             88  XL001-WEB-ITEM-NOT-FOUND VALUE  +100.            00850099
008600             88  XL001-WEB-SKU-CONTENTION VALUES -904, -911, -913.00860099
008700         10  FILLER                   PIC X(30).                  00870099
008800     05  XL001-ERROR-PARAGRAPH-NBR    PIC X(5).                   00880099
008900     05  XL001-CONTENTION-ERR-PARA-NBR                            00890099
009000                                      PIC X(5).                   00900099
009100     05  FILLER                       PIC X(20).                  00910099
009200                                                                  00920099
009300     05  XL001-OUTPUT-FIELDS.                                     00930099
009400         10  XL001-INTR-UPC-ID        PIC S9(9) COMP.             00940099
009500         10  XL001-STYL-ID            PIC S9(8)V COMP-3.          00950099
009600* * * XLV_SKU DATA                                                00960099
009700         10  XL001-ITM-NBR            PIC S9(15)V COMP-3.         00970099
009800         10  XL001-SKU-NBR            PIC S9(8)V COMP-3.          00980099
009900         10  XL001-INNR-PACK-QTY      PIC S9(4) COMP.             00990099
010000         10  XL001-OUTR-PACK-QTY      PIC S9(4) COMP.             01000099
010100         10  XL001-SKU-DESC           PIC X(30).                  01010099
010200         10  XL001-KOHLS-SIZE-CDE     PIC S9(9) COMP.             01020099
010300         10  XL001-SIZE-DESC          PIC X(10).                  01030099
010400         10  XL001-NRF-CLOR-CDE       PIC X(3).                   01040099
010500         10  XL001-SHRT-CLOR-DESC     PIC X(4).                   01050099
010600         10  XL001-CSTM-CLOR-DESC     PIC X(10).                  01060099
010700         10  XL001-REGN-PRIC-IND      PIC X(1).                   01070099
010800         10  XL001-KY-ITM-IND         PIC X(1).                   01080099
010900         10  XL001-GP-CDE             PIC X(3).                   01090099
011000* * * SKU-STAT-CDE TEMPORARILY UPDATED FROM TUPCPLS 6/28/02       01100099
011100         10  XL001-SKU-STAT-CDE       PIC X(2).                   01110099
011200* * * SKU-STAT-DESC TEMPORARILY HARDCODED 10/30/02                01120099
011300         10  XL001-SKU-STAT-DESC      PIC X(10).                  01130099
011400         10  FILLER                   PIC X(90).                  01140099
011500* * * XLV_VND_STYL DATA                                           01150099
011600         10  XL001-DEPT-NBR           PIC S9(4)V COMP-3.          01160099
011700         10  XL001-DEPT-NBR-3CH       PIC X(3).                   01170099
011800         10  XL001-MAJ-CL-NBR         PIC S9(4)V COMP-3.          01180099
011900         10  XL001-MAJ-CL-NBR-2CH     PIC X(2).                   01190099
012000         10  XL001-SUB-CL-NBR         PIC S9(4)V COMP-3.          01200099
012100         10  XL001-SUB-CL-NBR-2CH     PIC X(2).                   01210099
012200         10  XL001-VS-ID              PIC S9(9) COMP.             01220099
012300         10  XL001-VS-NBR             PIC X(20).                  01230099
012400         10  XL001-ENT-ID             PIC S9(9) COMP.             01240099
012500         10  XL001-STKR-NBR           PIC S9(4) COMP.             01250099
012600         10  XL001-TKT-TYP-DESC       PIC X(20).                  01260099
012700         10  FILLER                   PIC X(01).                  01270099
012800         10  XL001-HNG-FOLD-CDE       PIC X(01).                  01280099
012900         10  XL001-HNG-FOLD-DESC      PIC X(20).                  01290099
013000         10  FILLER                   PIC X(102).                 01300099
013100* * * XLV_SKU_STR DATA                                            01310099
013200         10  XL001-UNT-RTL-AMT        PIC S9(7)V9(2) COMP-3.      01320099
013300         10  XL001-UNT-COST-AMT       PIC S9(7)V9(3) COMP-3.      01330099
013400         10  XL001-GP-QTY             PIC S9(9) COMP.             01340099
013500         10  XL001-GP-AMT             PIC S9(7)V9(2) COMP-3.      01350099
013600         10  XL001-STR-SKU-STAT-CDE   PIC X(2).                   01360099
013700         10  FILLER                   PIC X(100).                 01370099
013800* * * XLV_UPC DATA                                                01380099
013900         10  XL001-UPC-ID             PIC S9(9) COMP.             01390099
014000         10  XL001-EDI-ORD-IND        PIC X(1).                   01400099
014100         10  XL001-CERTD-IND          PIC X(1).                   01410099
014200         10  XL001-CERTD-DTE          PIC X(10).                  01420099
014300         10  XL001-UPC-NBR            PIC S9(15)V COMP-3.         01430099
014400         10  FILLER                   PIC X(100).                 01440099
014500* * * XLV_WEB_SKU DATA                                            01450099
014600         10  XL001-ASRT-BEG-DTE       PIC X(10).                  01460099
014700         10  XL001-ASRT-END-DTE       PIC X(10).                  01470099
014800         10  XL001-STRG-AREA-SEQ-NBR  PIC S9(4) COMP.             01480099
014900         10  XL001-STRG-AREA-DESC     PIC X(20).                  01490099
015000         10  XL001-SHIP-WD-QTY        PIC S9(4)V9(3) COMP-3.      01500099
015100         10  XL001-SHIP-DPTH-QTY      PIC S9(4)V9(3) COMP-3.      01510099
015200         10  XL001-SHIP-HT-QTY        PIC S9(4)V9(3) COMP-3.      01520099
015300         10  XL001-SHIP-WT-QTY        PIC S9(5)V9(3) COMP-3.      01530099
015400         10  XL001-SHIP-DIM-SRC-CDE   PIC X(1).                   01540099
015500         10  XL001-PKG-SEQ-NBR        PIC S9(4) COMP.             01550099
015600         10  XL001-PKG-CDE-DESC       PIC X(20).                  01560099
015700         10  XL001-SHIP-RSTRC-SEQ-NBR PIC S9(4) COMP.             01570099
015800         10  XL001-SHIP-RSTRC-DESC    PIC X(20).                  01580099
015900         10  XL001-GFT-WRAP-AVL-IND   PIC X(1).                   01590099
016000         10  XL001-PRD-GP-NBR         PIC S9(8)V COMP-3.          01600099
016100         10  XL001-PRD-GP-IND         PIC X(1).                   01610099
016200         10  XL001-SHIP-SRCHG-FEE-AMT PIC S9(3)V9(2) COMP-3.      01620099
016300         10  XL001-SHIP-SRVC-SEQ-NBR  PIC S9(4) COMP.             01630099
016400         10  XL001-SHIP-SRVC-DESC     PIC X(20).                  01640099
016500         10  XL001-SHIP-GP-SEQ-NBR    PIC S9(4) COMP.             01650099
016600         10  XL001-SHIP-GP-DESC       PIC X(20).                  01660099
016700         10  XL001-EFF-BEG-TMST       PIC X(26).                  01670099
016800         10  FILLER                   PIC X(74).                  01680099
016900                                                                  01690099
017000     05  FILLER                       PIC X(329).                 01700099
017100     05  XL001-SQLCA                  PIC X(136).                 01710099
017200 01  XL001-COMMAREA                   PIC X(01).                  01720099
017300 01  XL001-VSM-PGM                    PIC X(08) VALUE 'XLKUT001'. 01730099
