000100*                                                                 06/20/94
000200*                                                                 DPKCS020
000300*                                                                    LV001
000400 IDENTIFICATION DIVISION.                                         DPKCS020
000500                                                                  DPKCS020
000600 PROGRAM-ID.    DPKCS020.                                         DPKCS020
000700 AUTHOR.        DAN FRANKLIN.                                     DPKCS020
000800 INSTALLATION.  KOHLS DEPARTMENT STORES.                          DPKCS020
000900 DATE-WRITTEN.  10-18-90.                                         DPKCS020
001000 DATE-COMPILED.                                                   DPKCS020
001100                                                                  DPKCS020
001200***************************************************************** DPKCS020
001300*    MAINTAIN USER TABLE  (Z020)                                  DPKCS020
001400*                                                                 DPKCS020
001500*    THIS PROGRAM WILL ALLOW A USER TO ADD, DELETE, OR UPDATE     DPKCS020
001600*    USERID RECORDS ON THE TUSER TABLE.  THIS TABLE IS USED TO    DPKCS020
001700*    DETERMINE THE INITIAL MENU THAT IS TO BE DISPLAYED FOR EACH  DPKCS020
001800*    USER WHEN HE OR SHE LOGS ON TO CICS.                         DPKCS020
001801*                                                                *DPKCS021
001802*    03/21/96  TKMA235  CHANGES FOR CICS24X7 PROCESSING:         *        
001803*                       1) RECOMPILE TO GET UPDATED COPYBOOKS    *        
001804*                          DPWS050, DPWS052, DPWS055.            *        
001805*                       2) ALSO CHANGE '++INCLUDE XXXXXXXX'      *        
001806*                          TO 'COPY XXXXXXXX.' DUE TO RECENT     *        
001807*                          RETIREMENT OF PANVALET.               *        
224787*    05/28/19  TKMA357  FOR THE DELOITTE REFACTOR PROJECT,       *        
224787*      CHG0224787       RECOMPILED THE PROGRAM TO BRING IN THE   *        
224787*                       CURRENT VERSION OF DB2 TABLE TUSER.      *        
001900***************************************************************** DPKCS020
002000                                                                  DPKCS020
002100*                                                                 DPKCS020
002200*                                                                 DPKCS020
002300*                                                                 DPKCS020
002400 ENVIRONMENT DIVISION.                                            DPKCS020
002500*                                                                 DPKCS020
002600*                                                                 DPKCS020
002700*                                                                 DPKCS020
002800 DATA DIVISION.                                                   DPKCS020
002900*                                                                 DPKCS020
003000*                                                                 DPKCS020
003100 WORKING-STORAGE SECTION.                                         DPKCS020
003200                                                                  DPKCS020
003300 01  PC-PROGRAM-CONSTANTS.                                        DPKCS020
003400     05  PC-NAVIGATOR-TRAN-ID           PIC X(04)    VALUE 'Z008'.DPKCS020
003500     05  PC-MNEMONIC-LIST-TRAN-ID       PIC X(04)    VALUE 'Z009'.DPKCS020
003600     05  PC-MAXIMUM-COMMAREA-LENGTH     PIC S9(04)   VALUE +4072  DPKCS020
003700                                                     COMP SYNC.   DPKCS020
003800     05  PC-CURRENT-MAP-NAME            PIC X(08)    VALUE        DPKCS020
003900     'DP020A  '.                                                  DPKCS020
004000     05  PC-CURRENT-MAPSET-NAME         PIC X(08)    VALUE        DPKCS020
004100     'DPKM020 '.                                                  DPKCS020
004200     05  PC-CURRENT-PROGRAM-NAME        PIC X(08)    VALUE        DPKCS020
004300     'DPKCS020'.                                                  DPKCS020
004400     05  PC-ERASE-EOF-COMP              PIC S9(04)   VALUE +128   DPKCS020
004500                                                     COMP SYNC.   DPKCS020
004600     05  FILLER REDEFINES PC-ERASE-EOF-COMP.                      DPKCS020
004700         10  FILLER                     PIC X(01).                DPKCS020
004800         10  PC-ERASE-EOF               PIC X(01).                DPKCS020
004900                                                                  DPKCS020
005000 01  PM-PROGRAM-MESSAGES.                                         DPKCS020
005100     05  PM-PROGRAM-MESSAGE-1           PIC X(78)    VALUE        DPKCS020
005200     'ENTER USER ID'.                                             DPKCS020
005300     05  PM-PROGRAM-MESSAGE-2           PIC X(78)    VALUE        DPKCS020
005400     'ERROR TRYING TO SELECT A ROW FROM TUSER TABLE - SQLCODE '.  DPKCS020
005500     05  FILLER REDEFINES PM-PROGRAM-MESSAGE-2.                   DPKCS020
005600         10  FILLER                     PIC X(56).                DPKCS020
005700         10  PM-SQLCODE-2               PIC Z(08)9-.              DPKCS020
005800         10  FILLER                     PIC X(12).                DPKCS020
005900     05  PM-PROGRAM-MESSAGE-3           PIC X(78)    VALUE        DPKCS020
006000     'XXXXXXXX WAS NOT FOUND.  ENTER CORRECT USER ID'.            DPKCS020
006100     05  FILLER REDEFINES PM-PROGRAM-MESSAGE-3.                   DPKCS020
006200         10  PM-USER-ID                 PIC X(08).                DPKCS020
006300         10  FILLER                     PIC X(70).                DPKCS020
006400     05  PM-PROGRAM-MESSAGE-4           PIC X(78)    VALUE        DPKCS020
006500     'MNEMONIC WAS NOT SELECTED FROM THE MNEMONIC LIST'.          DPKCS020
006600     05  PM-PROGRAM-MESSAGE-5           PIC X(78)    VALUE        DPKCS020
006700     'A USER ID IS REQUIRED'.                                     DPKCS020
006800     05  PM-PROGRAM-MESSAGE-6           PIC X(78)    VALUE        DPKCS020
006900     'A USER MNEMONIC IS REQUIRED'.                               DPKCS020
007000     05  PM-PROGRAM-MESSAGE-7           PIC X(78)    VALUE        DPKCS020
007100     'PRESS PF16 TO REQUEST DELETE'.                              DPKCS020
007200     05  PM-PROGRAM-MESSAGE-8           PIC X(78)    VALUE        DPKCS020
007300     'PRESS PF15 TO UPDATE'.                                      DPKCS020
007400     05  FILLER REDEFINES PM-PROGRAM-MESSAGE-8.                   DPKCS020
007500         10  FILLER                     PIC X(58).                DPKCS020
007600         10  PM-SQLCODE-8               PIC Z(08)9-.              DPKCS020
007700         10  FILLER                     PIC X(10).                DPKCS020
007800     05  PM-PROGRAM-MESSAGE-9           PIC X(78)    VALUE        DPKCS020
007900     'PRESS PF2 TO CONFIRM THE DELETION REQUESTS'.                DPKCS020
008000     05  PM-PROGRAM-MESSAGE-10          PIC X(78)    VALUE        DPKCS020
008100     'INVALID FUNCTION KEY WAS PRESSED'.                          DPKCS020
008200     05  PM-PROGRAM-MESSAGE-11          PIC X(78)    VALUE        DPKCS020
008300     'ERROR TRYING TO DELETE A ROW FROM TUSER TABLE - SQLCODE '.  DPKCS020
008400     05  FILLER REDEFINES PM-PROGRAM-MESSAGE-11.                  DPKCS020
008500         10  FILLER                     PIC X(56).                DPKCS020
008600         10  PM-SQLCODE-11              PIC Z(08)9-.              DPKCS020
008700         10  FILLER                     PIC X(12).                DPKCS020
008800     05  PM-PROGRAM-MESSAGE-12          PIC X(78)    VALUE        DPKCS020
008900     'USER ID WAS SUCCESSFULLY DELETED'.                          DPKCS020
009000     05  PM-PROGRAM-MESSAGE-13          PIC X(78)    VALUE        DPKCS020
009100     'DATABASE TIMESTAMP INCONSISTENCY FOUND - USER ID WAS NOT DELDPKCS020
009200-    'ETED'.                                                      DPKCS020
009300     05  PM-PROGRAM-MESSAGE-14          PIC X(78)    VALUE        DPKCS020
009400     'USER ID WAS ALREADY DELETED BY ANOTHER USER'.               DPKCS020
009500     05  PM-PROGRAM-MESSAGE-15          PIC X(78)    VALUE        DPKCS020
009600     'ERROR TRYING TO INSERT A ROW INTO TUSER TABLE - SQLCODE '.  DPKCS020
009700     05  FILLER REDEFINES PM-PROGRAM-MESSAGE-15.                  DPKCS020
009800         10  FILLER                     PIC X(56).                DPKCS020
009900         10  PM-SQLCODE-15              PIC Z(08)9-.              DPKCS020
010000         10  FILLER                     PIC X(12).                DPKCS020
010100     05  PM-PROGRAM-MESSAGE-16          PIC X(78)    VALUE        DPKCS020
010200     'USER ID WAS SUCCESSFULLY ADDED'.                            DPKCS020
010300     05  PM-PROGRAM-MESSAGE-17          PIC X(78)    VALUE        DPKCS020
010400     'USER ID ALREADY EXISTS ON DATABASE'.                        DPKCS020
010500     05  PM-PROGRAM-MESSAGE-18          PIC X(78)    VALUE        DPKCS020
010600     'ERROR TRYING TO UPDATE A ROW ON TUSER TABLE - SQLCODE '.    DPKCS020
010700     05  FILLER REDEFINES PM-PROGRAM-MESSAGE-18.                  DPKCS020
010800         10  FILLER                     PIC X(54).                DPKCS020
010900         10  PM-SQLCODE-18              PIC Z(08)9-.              DPKCS020
011000         10  FILLER                     PIC X(14).                DPKCS020
011100     05  PM-PROGRAM-MESSAGE-19          PIC X(78)    VALUE        DPKCS020
011200     'USER ID WAS SUCCESSFULLY UPDATED'.                          DPKCS020
011300     05  PM-PROGRAM-MESSAGE-20          PIC X(78)    VALUE        DPKCS020
011400     'DATABASE TIMESTAMP INCONSISTENCY FOUND - USER ID WAS NOT UPDDPKCS020
011500-    'ATED'.                                                      DPKCS020
011600     05  PM-PROGRAM-MESSAGE-21          PIC X(78)    VALUE        DPKCS020
011700     'USER ID WAS ALREADY UPDATED BY ANOTHER USER'.               DPKCS020
011800     05  PM-PROGRAM-MESSAGE-22          PIC X(78)    VALUE        DPKCS020
011900     'INVALID FUNCTION KEY WAS PRESSED'.                          DPKCS020
012000     05  PM-PROGRAM-MESSAGE-23          PIC X(78)    VALUE        DPKCS020
012100     'XXXXXXXX IS NOT SET UP ON TMENONIC TABLE'.                  DPKCS020
012200     05  FILLER REDEFINES PM-PROGRAM-MESSAGE-23.                  DPKCS020
012300         10  PM-MNEMONIC                PIC X(08).                DPKCS020
012400         10  FILLER                     PIC X(70).                DPKCS020
012500                                                                  DPKCS020
012600 01  PS-PROGRAM-SWITCHES.                                         DPKCS020
012700     05  PS-MAP-SEND-TYPE               PIC X(01)    VALUE '1'.   DPKCS020
012800         88  PS-SEND-MAP-N-DATA-FRSET                VALUE '1'.   DPKCS020
012900         88  PS-SEND-MAP-N-DATA-FRSET-CPOSN          VALUE '2'.   DPKCS020
013000         88  PS-SEND-DATA-ONLY-FRSET                 VALUE '3'.   DPKCS020
013100         88  PS-SEND-DATA-ONLY                       VALUE '4'.   DPKCS020
013200         88  PS-SEND-DATA-ONLY-ERASEAUP              VALUE '5'.   DPKCS020
013300         88  PS-SEND-MAP-ONLY-FRSET                  VALUE '6'.   DPKCS020
013400     05  PS-ERROR-SW                    PIC X(01)    VALUE 'N'.   DPKCS020
013500         88  PS-ERROR                                VALUE 'Y'.   DPKCS020
013600         88  PS-NO-ERROR                             VALUE 'N'.   DPKCS020
013700     05  PS-ROW-FOUND-SW                PIC X(01)    VALUE 'N'.   DPKCS020
013800         88  PS-ROW-FOUND                            VALUE 'Y'.   DPKCS020
013900         88  PS-NO-ROW-FOUND                         VALUE 'N'.   DPKCS020
014000                                                                  DPKCS020
014100 01  PV-PROGRAM-VARIABLES.                                        DPKCS020
014200     05  PV-CICS-RESPONSE               PIC S9(04)   VALUE +0     DPKCS020
014300                                                     COMP SYNC.   DPKCS020
014400     05  PV-MESSAGE                     PIC X(78)    VALUE SPACES.DPKCS020
014500 EJECT                                                            DPKCS020
014600*---------------------------------------------------------------* DPKCS020
014700*    WORKING STORAGE INCLUDE MEMBER USED WITH INCLUDE DPPD005   * DPKCS020
014800*---------------------------------------------------------------* DPKCS020
014900     COPY DPWS006.                                                DPKCS020
015000 EJECT                                                            DPKCS020
015100***************************************************************** DPKCS020
015200*    STANDARD COMMAREA.                                           DPKCS020
015300***************************************************************** DPKCS020
015400                                                                  DPKCS020
015500     COPY DPWS020.                                                DPKCS020
015600     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                DPKCS020
015700                                                                  DPKCS020
015800***************************************************************** DPKCS020
015900*    INTER-APPLICATION COMMAREA.                                  DPKCS020
016000***************************************************************** DPKCS020
016100                                                                  DPKCS020
016200         10  INTER-APPL-COMM-AREA       PIC X(200).               DPKCS020
016300     COPY DPWS050.                                                DPKCS020
016400     COPY DPWS055.                                                DPKCS020
016500                                                                  DPKCS020
016600***************************************************************** DPKCS020
016700*    SPECIFIC COMMMAREA FOR DPKCS020.                             DPKCS020
016800***************************************************************** DPKCS020
016900                                                                  DPKCS020
017000                                                                  DPKCS020
017100         10  DP021-APPL-CURSOR-POSITION  PIC S9(2)  COMP.         DPKCS020
017200         10  DP021-CURRENT-SCREEN-IMAGE.                          DPKCS020
017300             15  DP021-SCREEN-USER-ID    PIC X(08).               DPKCS020
017400             15  DP021-SCREEN-MNEMONIC   PIC X(08).               DPKCS020
017500         10  DP021-DELETE-REQUESTED-SW   PIC X(01).               DPKCS020
017600             88  DP021-DELETE-REQUESTED             VALUE 'Y'.    DPKCS020
017700             88  DP021-NO-DELETE-REQUESTED          VALUE 'N'.    DPKCS020
017800         10  DP021-ERRORS-ON-PREV-PANEL-SW                        DPKCS020
017900                                         PIC X(01).               DPKCS020
018000             88  DP021-ERRORS-ON-PREV-PANEL         VALUE 'Y'.    DPKCS020
018100             88  DP021-NO-ERRORS-ON-PREV-PANEL      VALUE 'N'.    DPKCS020
018200         10  DP021-HOLD-TIMESTAMP-INFO.                           DPKCS020
018300             15  DP021-HOLD-TIMESTAMP    PIC X(26).               DPKCS020
018400         10  DP021-NEW-USER-ID-SW        PIC X(01).               DPKCS020
018500             88  DP021-NEW-USER-ID                  VALUE 'Y'.    DPKCS020
018600             88  DP021-SAME-USER-ID                 VALUE 'N'.    DPKCS020
018700         10  FILLER                      PIC X(2818).             DPKCS020
018800                                                                  DPKCS020
018900***************************************************************** DPKCS020
019000*    ERROR MESSAGE COPYBOOK.                                      DPKCS020
019100***************************************************************** DPKCS020
019200                                                                  DPKCS020
019300     COPY DPRD507I.                                               DPKCS020
019400                                                                  DPKCS020
019500***************************************************************** DPKCS020
019600*    ABEND PROCESSING COPYBOOK.                                   DPKCS020
019700***************************************************************** DPKCS020
019800                                                                  DPKCS020
019900     COPY DPWS013.                                                DPKCS020
020000                                                                  DPKCS020
020100***************************************************************** DPKCS020
020200*    ATTRIBUTE SETTINGS COPYBOOK.                                 DPKCS020
020300***************************************************************** DPKCS020
020400                                                                  DPKCS020
020500     COPY DPWS015.                                                DPKCS020
020600                                                                  DPKCS020
020700***************************************************************** DPKCS020
020800*    CURRENT DATE AND TIME COPYBOOK.                              DPKCS020
020900***************************************************************** DPKCS020
021000                                                                  DPKCS020
021100     COPY DPWS017.                                                DPKCS020
021200                                                                  DPKCS020
021300***************************************************************** DPKCS020
021400*    TOGGLE FUNCTION KEY LINES COPYBOOK.                          DPKCS020
021500***************************************************************** DPKCS020
021600                                                                  DPKCS020
021700     COPY DPWS009.                                                DPKCS020
021800                                                                  DPKCS020
021900***************************************************************** DPKCS020
022000*    FUNCTION KEYS COPYBOOK.                                      DPKCS020
022100***************************************************************** DPKCS020
022200                                                                  DPKCS020
022300     COPY DPWS016.                                                DPKCS020
022400                                                                  DPKCS020
022500***************************************************************** DPKCS020
022600*    DPKUT045 COPYBOOK.                                           DPKCS020
022700***************************************************************** DPKCS020
022800                                                                  DPKCS020
022900     COPY DPWS045.                                                DPKCS020
023000                                                                  DPKCS020
023100***************************************************************** DPKCS020
023200*    STANDARD ATTENTION IDENTIFIER LIST                           DPKCS020
023300***************************************************************** DPKCS020
023400                                                                  DPKCS020
023500     COPY DFHAID.                                                 DPKCS020
023600                                                                  DPKCS020
023700***************************************************************** DPKCS020
023800*    STANDARD ATTRIBUTE AND PRINTER CONTROL CHARACTER LIST        DPKCS020
023900***************************************************************** DPKCS020
024000                                                                  DPKCS020
024100     COPY DFHBMSCA.                                               DPKCS020
024200                                                                  DPKCS020
024300***************************************************************** DPKCS020
024400*    MAP LAYOUT                                                   DPKCS020
024500***************************************************************** DPKCS020
024600                                                                  DPKCS020
024700     COPY DPKM020.                                                DPKCS020
024800                                                                  DPKCS020
024900 01  MD-MAP-DATA-AREA REDEFINES DP020AO.                          DPKCS020
025000     05  FILLER                         PIC X(500).               DPKCS020
025100 EJECT                                                            DPKCS020
025200***************************************************************** DPKCS020
025300*    DB2 COMMUNICATION AREA                                       DPKCS020
025400***************************************************************** DPKCS020
025500                                                                  DPKCS020
025600     EXEC SQL                                                     DPKCS020
025700         INCLUDE SQLCA                                            DPKCS020
025800     END-EXEC.                                                    DPKCS020
025900                                                                  DPKCS020
026000***************************************************************** DPKCS020
026100*    FUNCTION KEY TABLE - TUSER                                   DPKCS020
026200***************************************************************** DPKCS020
026300                                                                  DPKCS020
026400     EXEC SQL                                                     DPKCS020
026500         INCLUDE TUSER                                            DPKCS020
026600     END-EXEC.                                                    DPKCS020
026700                                                                  DPKCS020
026800 LINKAGE SECTION.                                                 DPKCS020
026900                                                                  DPKCS020
027000 01  DFHCOMMAREA.                                                 DPKCS020
027100     05  FILLER                         OCCURS  1 TO 4072 TIMES   DPKCS020
027200                                        DEPENDING ON EIBCALEN.    DPKCS020
027300         10  FILLER                     PIC X.                    DPKCS020
027400*                                                                 DPKCS020
027500*                                                                 DPKCS020
027600*                                                                 DPKCS020
027700 PROCEDURE DIVISION.                                              DPKCS020
027800                                                                  DPKCS020
027900                                                                  DPKCS020
028000 A100-MAIN-MODULE.                                                DPKCS020
028100                                                                  DPKCS020
028200******************************************************************DPKCS020
028300*    PROCESS THIS TRANSACTION IF THE COMMAREA IS VALID.           DPKCS020
028400******************************************************************DPKCS020
028500                                                                  DPKCS020
028600     PERFORM DP015-0000-CHECK-COMMAREA.                           DPKCS020
028700                                                                  DPKCS020
028800     IF DP020-SRC-RETURN-W-TRAN-ID                                DPKCS020
028900         PERFORM B100-CONTROL-PROCESSING                          DPKCS020
029000     END-IF.                                                      DPKCS020
029100                                                                  DPKCS020
029200     PERFORM DP003-0000-RETURN-TO-CICS.                           DPKCS020
029300 EJECT                                                            DPKCS020
029400 B100-CONTROL-PROCESSING.                                         DPKCS020
029500                                                                  DPKCS020
029600******************************************************************DPKCS020
029700*    PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT    DPKCS020
029800*    COURSE OF ACTION IS FOR THIS TRANSACTION.                    DPKCS020
029900*                                                                 DPKCS020
030000*    PERFORMED BY A100-MAIN-MODULE.                               DPKCS020
030100******************************************************************DPKCS020
030200                                                                  DPKCS020
030300     EVALUATE TRUE                                                DPKCS020
030400                                                                  DPKCS020
030500         WHEN DP020-NEXT-ACT-INITIAL                              DPKCS020
030600             SET PS-SEND-MAP-N-DATA-FRSET TO TRUE                 DPKCS020
030700                                                                  DPKCS020
030800             PERFORM C100-INITIALIZE-COMMAREA                     DPKCS020
030900             PERFORM E200-READ-ROW-AND-SEND-PANEL                 DPKCS020
031000                                                                  DPKCS020
031100         WHEN DP020-NEXT-ACT-READ-MAP                             DPKCS020
031200             PERFORM C200-PROCESS-MAP                             DPKCS020
031300                                                                  DPKCS020
031400         WHEN DP020-NEXT-ACT-RETURN                               DPKCS020
031500             SET PS-SEND-MAP-N-DATA-FRSET TO TRUE                 DPKCS020
031600                                                                  DPKCS020
031700             PERFORM C300-PROCESS-INTER-APPL-COMM                 DPKCS020
031800             PERFORM F200-DISPLAY-PANEL                           DPKCS020
031900                                                                  DPKCS020
032000         WHEN DP020-NEXT-ACT-ERROR                                DPKCS020
032100                                                                  DPKCS020
032200             MOVE DP020-MSG-MESSAGE TO PV-MESSAGE                 DPKCS020
032300                                                                  DPKCS020
032400             IF DP020-NAV-MNEMONIC = SPACES                       DPKCS020
032500                 MOVE SPACES          TO ANAVCMDO                 DPKCS020
032600                 MOVE DP015-GREEN     TO ANAVCMDC                 DPKCS020
032700                 MOVE DP015-UNDERLINE TO ANAVCMDH                 DPKCS020
032800             ELSE                                                 DPKCS020
032900                 MOVE DP015-RED       TO ANAVCMDC                 DPKCS020
033000                 MOVE DP015-REVERSE   TO ANAVCMDH                 DPKCS020
033100             END-IF                                               DPKCS020
033200                                                                  DPKCS020
033300             MOVE LOW-VALUES TO DP020-INTER-APPL-DATA-AREA        DPKCS020
033400                                                                  DPKCS020
033500             PERFORM G100-SET-USER-ID-ATTRIBUTES                  DPKCS020
033600             PERFORM G200-SET-MNEM-ATTRIBUTES                     DPKCS020
033700                                                                  DPKCS020
033800             SET DP021-NO-ERRORS-ON-PREV-PANEL TO TRUE            DPKCS020
033900                                                                  DPKCS020
034000             PERFORM E300-EDIT-DATA-IN-COMMAREA                   DPKCS020
034100                                                                  DPKCS020
034200             SET PS-ERROR                TO TRUE                  DPKCS020
034300             SET PS-SEND-DATA-ONLY-FRSET TO TRUE                  DPKCS020
034400                                                                  DPKCS020
034500             MOVE PV-MESSAGE TO DP020-MSG-MESSAGE                 DPKCS020
034600             MOVE -1         TO ANAVCMDL                          DPKCS020
034700                                                                  DPKCS020
034800             PERFORM F200-DISPLAY-PANEL                           DPKCS020
034900                                                                  DPKCS020
035000         WHEN OTHER                                               DPKCS020
035100             SET DP013-LOGIC-ABEND TO TRUE                        DPKCS020
035200             SET DP013-NO-ROLLBACK TO TRUE                        DPKCS020
035300                                                                  DPKCS020
035400             MOVE 'B100-CONTROL-PROCESSING' TO                    DPKCS020
035500                  DP013-PARAGRAPH                                 DPKCS020
035600             MOVE PM-PROGRAM-MESSAGE-22     TO                    DPKCS020
035700                  DP013-MESSAGE-TEXT(1)                           DPKCS020
035800                                                                  DPKCS020
035900             PERFORM DP013-0000-PROCESS-ABEND                     DPKCS020
036000                                                                  DPKCS020
036100     END-EVALUATE.                                                DPKCS020
036200 EJECT                                                            DPKCS020
036300 C100-INITIALIZE-COMMAREA.                                        DPKCS020
036400                                                                  DPKCS020
036500******************************************************************DPKCS020
036600*    INITIALIZE THE APPLICATION SPECIFIC AND INTER-APPLICATION    DPKCS020
036700*    COMMAREAS.                                                   DPKCS020
036800*                                                                 DPKCS020
036900*    PERFORMED BY B100-CONTROL-PROCESSING.                        DPKCS020
037000******************************************************************DPKCS020
037100                                                                  DPKCS020
037200     MOVE DP020-NAV-KEY-DATA TO DP021-SCREEN-USER-ID.             DPKCS020
037300     MOVE SPACES             TO DP021-SCREEN-MNEMONIC.            DPKCS020
037400     MOVE SPACES             TO DP021-HOLD-TIMESTAMP.             DPKCS020
037500     MOVE LOW-VALUES         TO DP020-INTER-APPL-DATA-AREA.       DPKCS020
037600                                                                  DPKCS020
037700     SET DP021-NO-DELETE-REQUESTED     TO TRUE.                   DPKCS020
037800     SET DP021-NO-ERRORS-ON-PREV-PANEL TO TRUE.                   DPKCS020
037900     SET DP021-NEW-USER-ID             TO TRUE.                   DPKCS020
038000 EJECT                                                            DPKCS020
038100 C200-PROCESS-MAP.                                                DPKCS020
038200                                                                  DPKCS020
038300******************************************************************DPKCS020
038400*    RECEIVE THE MAP.                                             DPKCS020
038500*    IF A FUNCTION WAS HIT OTHER THAN CONFIRM OR CLEAR,           DPKCS020
038600*    MOVE THE SCREEN FIELDS TO THE COMMMAREA.                     DPKCS020
038700*    CONTINUE PROCESSING BASED ON THE FUNCTION KEY THAT WAS HIT.  DPKCS020
038800*                                                                 DPKCS020
038900*    PERFORMED BY B100-CONTROL-PROCESSING.                        DPKCS020
039000******************************************************************DPKCS020
039100                                                                  DPKCS020
039200     SET PS-SEND-DATA-ONLY-FRSET TO TRUE.                         DPKCS020
039300                                                                  DPKCS020
039400     PERFORM DP007-0000-GET-PANEL.                                DPKCS020
039500                                                                  DPKCS020
039600     IF DP020-SRC-AID = DP016-PF16                                DPKCS020
039700         SET DP021-DELETE-REQUESTED TO TRUE                       DPKCS020
039800     ELSE                                                         DPKCS020
039900                                                                  DPKCS020
040000         IF NOT (DP020-FK-CONFIRM(DP020-SRC-AID)) AND             DPKCS020
040100                (DP020-SRC-AID NOT = DP016-PA2)   AND             DPKCS020
040200                (DP020-SRC-AID NOT = DP016-CLEAR)                 DPKCS020
040300             SET DP021-NO-DELETE-REQUESTED TO TRUE                DPKCS020
040400         END-IF                                                   DPKCS020
040500                                                                  DPKCS020
040600     END-IF.                                                      DPKCS020
040700                                                                  DPKCS020
040800     IF (DP020-SRC-AID NOT = DP016-PF5)   AND                     DPKCS020
040900        (DP020-SRC-AID NOT = DP016-CLEAR)                         DPKCS020
041000         PERFORM D100-MOVE-SCREEN-TO-COMMAREA                     DPKCS020
041100     END-IF.                                                      DPKCS020
041200                                                                  DPKCS020
041300     PERFORM D200-CHECK-LOCAL-FKEYS.                              DPKCS020
041400 EJECT                                                            DPKCS020
041500 C300-PROCESS-INTER-APPL-COMM.                                    DPKCS020
041600                                                                  DPKCS020
041700******************************************************************DPKCS020
041800*    UPON RETURNING FROM ANOTHER TRANSACTION, CHECK THE INTER-    DPKCS020
041900*    APPLICATION FORMAT CODE AND ACKNOWLEDGE CODE.  IF BOTH       DPKCS020
042000*    CONTAIN THE LITERAL 'CMIA', WE KNOW THAT WE JUST RETURNED    DPKCS020
042100*    FROM THE MNEMONIC LIST TRANSACTION.  IF THE USER SELECTED    DPKCS020
042200*    A MNEMONIC IN THAT TRANSACTION, MOVE IT INTO THE SPECIFIC    DPKCS020
042300*    COMMAREA FOR THIS TRANACTION, OTHERWISE DISPLAY A MESSAGE    DPKCS020
042400*    INDICATING THAT NO MNEMONIC WAS SELECTED.                    DPKCS020
042500*                                                                 DPKCS020
042600*    PERFORMED BY B100-CONTROL-PROCESSING.                        DPKCS020
042700******************************************************************DPKCS020
042800                                                                  DPKCS020
042900     IF  DP055-MNEMONIC GREATER THAN SPACES                       DPKCS020
043000         MOVE DP055-MNEMONIC TO DP021-SCREEN-MNEMONIC             DPKCS020
043100     ELSE                                                         DPKCS020
043200         MOVE PM-PROGRAM-MESSAGE-4 TO DP020-MSG-MESSAGE           DPKCS020
043300         SET DP020-MSG-FATAL TO TRUE                              DPKCS020
043400     END-IF.                                                      DPKCS020
043500                                                                  DPKCS020
043600*    MOVE LOW-VALUES TO DP050-CMIA-DATA-AREA.                     DPKCS020
043700 EJECT                                                            DPKCS020
043800 D100-MOVE-SCREEN-TO-COMMAREA.                                    DPKCS020
043900                                                                  DPKCS020
044000******************************************************************DPKCS020
044100*    CHECK EACH UNPROTECTED FIELD AND SEE IF THE USER ENTERED     DPKCS020
044200*    ANYTHING INTO THEM.                                          DPKCS020
044300*                                                                 DPKCS020
044400*    PERFORMED BY C200-PROCESS-MAP.                               DPKCS020
044500******************************************************************DPKCS020
044600                                                                  DPKCS020
044700     SET DP021-NEW-USER-ID TO TRUE.                               DPKCS020
044800                                                                  DPKCS020
044900     IF AUSERIDL > ZERO                                           DPKCS020
045000         MOVE AUSERIDI TO DP021-SCREEN-USER-ID                    DPKCS020
045100         MOVE SPACES   TO DP021-HOLD-TIMESTAMP                    DPKCS020
045200                                                                  DPKCS020
045300         PERFORM G100-SET-USER-ID-ATTRIBUTES                      DPKCS020
045400     ELSE                                                         DPKCS020
045500                                                                  DPKCS020
045600         IF AUSERIDA = PC-ERASE-EOF                               DPKCS020
045700             MOVE SPACES TO DP021-SCREEN-USER-ID                  DPKCS020
045800             MOVE SPACES TO DP021-HOLD-TIMESTAMP                  DPKCS020
045900                                                                  DPKCS020
046000             PERFORM G100-SET-USER-ID-ATTRIBUTES                  DPKCS020
046100         ELSE                                                     DPKCS020
046200                                                                  DPKCS020
046300             IF DP021-HOLD-TIMESTAMP NOT = SPACES                 DPKCS020
046400                 SET DP021-SAME-USER-ID TO TRUE                   DPKCS020
046500             END-IF                                               DPKCS020
046600                                                                  DPKCS020
046700         END-IF                                                   DPKCS020
046800                                                                  DPKCS020
046900     END-IF.                                                      DPKCS020
047000                                                                  DPKCS020
047100     IF AMNEML > ZERO                                             DPKCS020
047200         MOVE AMNEMI TO DP021-SCREEN-MNEMONIC                     DPKCS020
047300                                                                  DPKCS020
047400         PERFORM G200-SET-MNEM-ATTRIBUTES                         DPKCS020
047500     ELSE                                                         DPKCS020
047600                                                                  DPKCS020
047700         IF AMNEMA = PC-ERASE-EOF                                 DPKCS020
047800             MOVE SPACES TO DP021-SCREEN-MNEMONIC                 DPKCS020
047900                                                                  DPKCS020
048000             PERFORM G200-SET-MNEM-ATTRIBUTES                     DPKCS020
048100         END-IF                                                   DPKCS020
048200                                                                  DPKCS020
048300     END-IF.                                                      DPKCS020
048400 EJECT                                                            DPKCS020
048500 D200-CHECK-LOCAL-FKEYS.                                          DPKCS020
048600                                                                  DPKCS020
048700******************************************************************DPKCS020
048800*    TAKE THE APPROPRIATE COURSE OF ACTION BASED ON WHAT THE      DPKCS020
048900*    FUNCTION KEY THAT THE USER HAS HIT.                          DPKCS020
049000*                                                                 DPKCS020
049100*    PERFORMED BY C200-PROCESS-MAP.                               DPKCS020
049200******************************************************************DPKCS020
049300                                                                  DPKCS020
049400     EVALUATE TRUE                                                DPKCS020
049500                                                                  DPKCS020
049600         WHEN DP020-FK-GO-TO-TRAN(DP020-SRC-AID)                  DPKCS020
049700         WHEN DP020-FK-RETURN(DP020-SRC-AID)                      DPKCS020
049800             PERFORM E100-SETUP-INTER-APPL-COMM                   DPKCS020
049900             PERFORM DP015-1000-START-NAVIGATOR                   DPKCS020
050000                                                                  DPKCS020
050100         WHEN DP020-FK-REFRESH(DP020-SRC-AID)                     DPKCS020
050200             SET PS-SEND-MAP-N-DATA-FRSET TO TRUE                 DPKCS020
050300                                                                  DPKCS020
050400             PERFORM E200-READ-ROW-AND-SEND-PANEL                 DPKCS020
050500                                                                  DPKCS020
050600         WHEN DP020-FK-CONFIRM(DP020-SRC-AID)                     DPKCS020
050700                                                                  DPKCS020
050800             IF DP021-NEW-USER-ID                                 DPKCS020
050900                 MOVE PM-PROGRAM-MESSAGE-7 TO DP020-MSG-MESSAGE   DPKCS020
051000                                                                  DPKCS020
051100                 SET DP020-MSG-WARNING        TO TRUE             DPKCS020
051200                 SET PS-SEND-MAP-N-DATA-FRSET TO TRUE             DPKCS020
051300                                                                  DPKCS020
051400                 PERFORM E200-READ-ROW-AND-SEND-PANEL             DPKCS020
051500             ELSE                                                 DPKCS020
051600                                                                  DPKCS020
051700                 IF DP021-DELETE-REQUESTED                        DPKCS020
051800                     PERFORM Z200-DELETE-TUSER-ROW                DPKCS020
051900                                                                  DPKCS020
052000                     IF SQLCODE = +0                              DPKCS020
052100                         MOVE PM-PROGRAM-MESSAGE-12 TO            DPKCS020
052200                              DP020-MSG-MESSAGE                   DPKCS020
052300                                                                  DPKCS020
052400                         SET DP021-NEW-USER-ID       TO TRUE      DPKCS020
052500                         SET DP020-MSG-INFORMATIONAL TO TRUE      DPKCS020
052600                     ELSE                                         DPKCS020
052700                         SET DP020-MSG-FATAL         TO TRUE      DPKCS020
052800                         SET PS-ERROR                TO TRUE      DPKCS020
052900                                                                  DPKCS020
053000                         PERFORM F100-RETRIEVE-DATA-FOR-PANEL     DPKCS020
053100                         PERFORM G300-MOVE-COMMAREA-TO-SCREEN     DPKCS020
053200                                                                  DPKCS020
053300                         IF PS-ROW-FOUND                          DPKCS020
053400                             MOVE PM-PROGRAM-MESSAGE-13 TO        DPKCS020
053500                                  DP020-MSG-MESSAGE               DPKCS020
053600                         ELSE                                     DPKCS020
053700                             MOVE PM-PROGRAM-MESSAGE-14 TO        DPKCS020
053800                                  DP020-MSG-MESSAGE               DPKCS020
053900                         END-IF                                   DPKCS020
054000                                                                  DPKCS020
054100                         MOVE DP015-RED     TO AUSERIDC           DPKCS020
054200                         MOVE DP015-REVERSE TO AUSERIDH           DPKCS020
054300                         MOVE -1            TO AUSERIDL           DPKCS020
054400                     END-IF                                       DPKCS020
054500                                                                  DPKCS020
054600                 ELSE                                             DPKCS020
054700                     MOVE PM-PROGRAM-MESSAGE-7 TO                 DPKCS020
054800                          DP020-MSG-MESSAGE                       DPKCS020
054900                                                                  DPKCS020
055000                     SET DP020-MSG-WARNING TO TRUE                DPKCS020
055100                                                                  DPKCS020
055200                     PERFORM G100-SET-USER-ID-ATTRIBUTES          DPKCS020
055300                     PERFORM G200-SET-MNEM-ATTRIBUTES             DPKCS020
055400                                                                  DPKCS020
055500                 END-IF                                           DPKCS020
055600                                                                  DPKCS020
055700                 PERFORM F200-DISPLAY-PANEL                       DPKCS020
055800                                                                  DPKCS020
055900             END-IF                                               DPKCS020
056000                                                                  DPKCS020
056100             SET DP021-NO-DELETE-REQUESTED TO TRUE                DPKCS020
056200                                                                  DPKCS020
056300         WHEN DP020-SRC-AID = DP016-ENTER                         DPKCS020
056400                                                                  DPKCS020
056500             IF (DP020-NAV-MNEMONIC = SPACES)     OR              DPKCS020
056600                (DP020-NAV-MNEMONIC = LOW-VALUES)                 DPKCS020
056700                 PERFORM E300-EDIT-DATA-IN-COMMAREA               DPKCS020
056800                 PERFORM F200-DISPLAY-PANEL                       DPKCS020
056900             ELSE                                                 DPKCS020
057000                 PERFORM E100-SETUP-INTER-APPL-COMM               DPKCS020
057100                 PERFORM DP015-1000-START-NAVIGATOR               DPKCS020
057200             END-IF                                               DPKCS020
057300                                                                  DPKCS020
057400         WHEN DP020-SRC-AID = DP016-PF13                          DPKCS020
057500             PERFORM E300-EDIT-DATA-IN-COMMAREA                   DPKCS020
057600                                                                  DPKCS020
057700             IF PS-NO-ERROR                                       DPKCS020
057800                 PERFORM Z300-INSERT-TUSER-ROW                    DPKCS020
057900                                                                  DPKCS020
058000                 IF SQLCODE = +0                                  DPKCS020
058100                     MOVE PM-PROGRAM-MESSAGE-16 TO                DPKCS020
058200                          DP020-MSG-MESSAGE                       DPKCS020
058300                                                                  DPKCS020
058400                     SET DP020-MSG-INFORMATIONAL TO TRUE          DPKCS020
058500                                                                  DPKCS020
058600                     PERFORM F100-RETRIEVE-DATA-FOR-PANEL         DPKCS020
058700                     PERFORM G300-MOVE-COMMAREA-TO-SCREEN         DPKCS020
058800                 ELSE                                             DPKCS020
058900                     SET DP020-MSG-FATAL TO TRUE                  DPKCS020
059000                     SET PS-ERROR        TO TRUE                  DPKCS020
059100                                                                  DPKCS020
059200                     IF SQLCODE = -803                            DPKCS020
059300                         PERFORM F100-RETRIEVE-DATA-FOR-PANEL     DPKCS020
059400                         PERFORM G300-MOVE-COMMAREA-TO-SCREEN     DPKCS020
059500                                                                  DPKCS020
059600                         MOVE PM-PROGRAM-MESSAGE-17 TO            DPKCS020
059700                              DP020-MSG-MESSAGE                   DPKCS020
059800                         MOVE DP015-RED             TO            DPKCS020
059900                              AUSERIDC                            DPKCS020
060000                         MOVE DP015-REVERSE         TO            DPKCS020
060100                              AUSERIDH                            DPKCS020
060200                         MOVE -1                    TO            DPKCS020
060300                              AUSERIDL                            DPKCS020
060400                     ELSE                                         DPKCS020
060500                         MOVE DP021-SCREEN-MNEMONIC TO            DPKCS020
060600                              PM-MNEMONIC                         DPKCS020
060700                         MOVE PM-PROGRAM-MESSAGE-23 TO            DPKCS020
060800                              DP020-MSG-MESSAGE                   DPKCS020
060900                         MOVE DP015-RED             TO            DPKCS020
061000                              AMNEMC                              DPKCS020
061100                         MOVE DP015-REVERSE         TO            DPKCS020
061200                              AMNEMH                              DPKCS020
061300                         MOVE -1                    TO            DPKCS020
061400                              AMNEML                              DPKCS020
061500                     END-IF                                       DPKCS020
061600                                                                  DPKCS020
061700                 END-IF                                           DPKCS020
061800                                                                  DPKCS020
061900             END-IF                                               DPKCS020
062000                                                                  DPKCS020
062100             PERFORM F200-DISPLAY-PANEL                           DPKCS020
062200                                                                  DPKCS020
062300         WHEN DP020-SRC-AID = DP016-PF14                          DPKCS020
062400             SET PS-SEND-MAP-N-DATA-FRSET TO TRUE                 DPKCS020
062500                                                                  DPKCS020
062600             PERFORM E200-READ-ROW-AND-SEND-PANEL                 DPKCS020
062700                                                                  DPKCS020
062800         WHEN DP020-SRC-AID = DP016-PF15                          DPKCS020
062900                                                                  DPKCS020
063000             IF DP021-NEW-USER-ID                                 DPKCS020
063100                 MOVE PM-PROGRAM-MESSAGE-8 TO DP020-MSG-MESSAGE   DPKCS020
063200                                                                  DPKCS020
063300                 SET DP020-MSG-INFORMATIONAL  TO TRUE             DPKCS020
063400                 SET PS-SEND-MAP-N-DATA-FRSET TO TRUE             DPKCS020
063500                                                                  DPKCS020
063600                 PERFORM E200-READ-ROW-AND-SEND-PANEL             DPKCS020
063700             ELSE                                                 DPKCS020
063800                 PERFORM Z100-SELECT-TUSER-ROW                    DPKCS020
063900                                                                  DPKCS020
064000                 IF SQLCODE = +0                                  DPKCS020
064100                     PERFORM E300-EDIT-DATA-IN-COMMAREA           DPKCS020
064200                                                                  DPKCS020
064300                     IF PS-NO-ERROR                               DPKCS020
064400                         PERFORM Z400-UPDATE-TUSER-ROW            DPKCS020
064500                                                                  DPKCS020
064600                         IF SQLCODE = +0                          DPKCS020
064700                             MOVE PM-PROGRAM-MESSAGE-19 TO        DPKCS020
064800                                  DP020-MSG-MESSAGE               DPKCS020
064900                                                                  DPKCS020
065000                             SET DP020-MSG-INFORMATIONAL TO TRUE  DPKCS020
065100                                                                  DPKCS020
065200                             PERFORM F100-RETRIEVE-DATA-FOR-PANEL DPKCS020
065300                             PERFORM G300-MOVE-COMMAREA-TO-SCREEN DPKCS020
065400                         ELSE                                     DPKCS020
065500                             SET DP020-MSG-FATAL TO TRUE          DPKCS020
065600                             SET PS-ERROR        TO TRUE          DPKCS020
065700                                                                  DPKCS020
065800                             IF SQLCODE = +100                    DPKCS020
065900                                 PERFORM                          DPKCS020
066000                                     F100-RETRIEVE-DATA-FOR-PANEL DPKCS020
066100                                 PERFORM                          DPKCS020
066200                                     G300-MOVE-COMMAREA-TO-SCREEN DPKCS020
066300                                                                  DPKCS020
066400                                 IF PS-ROW-FOUND                  DPKCS020
066500                                     MOVE PM-PROGRAM-MESSAGE-20 TODPKCS020
066600                                          DP020-MSG-MESSAGE       DPKCS020
066700                                 ELSE                             DPKCS020
066800                                     MOVE PM-PROGRAM-MESSAGE-21 TODPKCS020
066900                                          DP020-MSG-MESSAGE       DPKCS020
067000                                 END-IF                           DPKCS020
067100                                                                  DPKCS020
067200                                 MOVE DP015-RED             TO    DPKCS020
067300                                      AUSERIDC                    DPKCS020
067400                                 MOVE DP015-REVERSE         TO    DPKCS020
067500                                      AUSERIDH                    DPKCS020
067600                                 MOVE -1                    TO    DPKCS020
067700                                      AUSERIDL                    DPKCS020
067800                             ELSE                                 DPKCS020
067900                                 MOVE DP021-SCREEN-MNEMONIC TO    DPKCS020
068000                                      PM-MNEMONIC                 DPKCS020
068100                                 MOVE PM-PROGRAM-MESSAGE-23 TO    DPKCS020
068200                                      DP020-MSG-MESSAGE           DPKCS020
068300                                 MOVE DP015-RED             TO    DPKCS020
068400                                      AMNEMC                      DPKCS020
068500                                 MOVE DP015-REVERSE         TO    DPKCS020
068600                                      AMNEMH                      DPKCS020
068700                                 MOVE -1                    TO    DPKCS020
068800                                      AMNEML                      DPKCS020
068900                             END-IF                               DPKCS020
069000                                                                  DPKCS020
069100                         END-IF                                   DPKCS020
069200                                                                  DPKCS020
069300                     END-IF                                       DPKCS020
069400                                                                  DPKCS020
069500                 ELSE                                             DPKCS020
069600                     MOVE DP021-SCREEN-USER-ID TO                 DPKCS020
069700                          PM-USER-ID                              DPKCS020
069800                     MOVE PM-PROGRAM-MESSAGE-3 TO                 DPKCS020
069900                          DP020-MSG-MESSAGE                       DPKCS020
070000                     MOVE DP015-RED            TO                 DPKCS020
070100                          AUSERIDC                                DPKCS020
070200                     MOVE DP015-REVERSE        TO                 DPKCS020
070300                          AUSERIDH                                DPKCS020
070400                     MOVE -1                   TO                 DPKCS020
070500                          AUSERIDL                                DPKCS020
070600                                                                  DPKCS020
070700                     SET DP020-MSG-FATAL TO TRUE                  DPKCS020
070800                     SET PS-ERROR        TO TRUE                  DPKCS020
070900                 END-IF                                           DPKCS020
071000                                                                  DPKCS020
071100                 PERFORM F200-DISPLAY-PANEL                       DPKCS020
071200             END-IF                                               DPKCS020
071300                                                                  DPKCS020
071400         WHEN DP020-SRC-AID = DP016-PF16                          DPKCS020
071500             MOVE PM-PROGRAM-MESSAGE-9 TO DP020-MSG-MESSAGE       DPKCS020
071600                                                                  DPKCS020
071700             SET DP020-MSG-INFORMATIONAL  TO TRUE                 DPKCS020
071800             SET PS-SEND-MAP-N-DATA-FRSET TO TRUE                 DPKCS020
071900                                                                  DPKCS020
072000             PERFORM E200-READ-ROW-AND-SEND-PANEL                 DPKCS020
072100                                                                  DPKCS020
072200         WHEN DP020-SRC-AID = DP016-PA2                           DPKCS020
072300             SET PS-SEND-DATA-ONLY TO TRUE                        DPKCS020
072400                                                                  DPKCS020
072500             MOVE -1 TO ANAVCMDL                                  DPKCS020
072600                                                                  DPKCS020
072700             PERFORM DP017-0000-GET-CURR-DATE-TIME                DPKCS020
072800             PERFORM DP009-0000-LOAD-FK-LINES                     DPKCS020
072900             PERFORM DP008-0000-WRITE-PANEL                       DPKCS020
073000                                                                  DPKCS020
073100         WHEN DP020-SRC-AID = DP016-CLEAR                         DPKCS020
073200             SET PS-SEND-MAP-N-DATA-FRSET TO TRUE                 DPKCS020
073300                                                                  DPKCS020
073400             PERFORM G100-SET-USER-ID-ATTRIBUTES                  DPKCS020
073500             PERFORM G200-SET-MNEM-ATTRIBUTES                     DPKCS020
073600             PERFORM F200-DISPLAY-PANEL                           DPKCS020
073700                                                                  DPKCS020
073800         WHEN OTHER                                               DPKCS020
073900             PERFORM DP015-1000-START-NAVIGATOR                   DPKCS020
074000                                                                  DPKCS020
074100     END-EVALUATE.                                                DPKCS020
074200 EJECT                                                            DPKCS020
074300 E100-SETUP-INTER-APPL-COMM.                                      DPKCS020
074400                                                                  DPKCS020
074500******************************************************************DPKCS020
074600*    SET UP THE INTER-APPLICATION COMMAREA BEFORE LEAVING THIS    DPKCS020
074700*    TRANSACTION.                                                 DPKCS020
074800*                                                                 DPKCS020
074900*    PERFORMED BY D200-CHECK-LOCAL-FKEYS.                         DPKCS020
075000******************************************************************DPKCS020
075100                                                                  DPKCS020
075200     IF DP020-FK-TRAN-ID(DP020-SRC-AID) = PC-MNEMONIC-LIST-TRAN-IDDPKCS020
075300         MOVE SPACES                TO DP020-INTER-APPL-DATA-AREA DPKCS020
075400         SET DP020-CICSARCH-MAINT   TO TRUE                       DPKCS020
075500     ELSE                                                         DPKCS020
075600         MOVE LOW-VALUES            TO DP020-INTER-APPL-DATA-AREA DPKCS020
075700     END-IF.                                                      DPKCS020
075800 EJECT                                                            DPKCS020
075900 E200-READ-ROW-AND-SEND-PANEL.                                    DPKCS020
076000                                                                  DPKCS020
076100******************************************************************DPKCS020
076200*    IF A USER ID WAS ENTERED ON THE SCREEN, READ THE TUSER TABLE,DPKCS020
076300*    OTHERWISE DISPLAY A MESSAGE INDICATING THAT A USER ID NEEDS  DPKCS020
076400*    TO BE ENTERED.                                               DPKCS020
076500*                                                                 DPKCS020
076600*    PERFORMED BY B100-CONTROL-PROCESSING.                        DPKCS020
076700*    PERFORMED BY D200-CHECK-LOCAL-FKEYS.                         DPKCS020
076800******************************************************************DPKCS020
076900                                                                  DPKCS020
077000     IF DP021-SCREEN-USER-ID NOT = SPACES                         DPKCS020
077100         PERFORM F100-RETRIEVE-DATA-FOR-PANEL                     DPKCS020
077200     ELSE                                                         DPKCS020
077300         SET DP020-MSG-INFORMATIONAL   TO TRUE                    DPKCS020
077400         SET DP021-NO-DELETE-REQUESTED TO TRUE                    DPKCS020
077500                                                                  DPKCS020
077600         MOVE PM-PROGRAM-MESSAGE-1 TO DP020-MSG-MESSAGE           DPKCS020
077700         MOVE SPACES               TO DP021-SCREEN-MNEMONIC       DPKCS020
077800                                                                  DPKCS020
077900         IF DP021-ERRORS-ON-PREV-PANEL                            DPKCS020
078000             PERFORM G200-SET-MNEM-ATTRIBUTES                     DPKCS020
078100         END-IF                                                   DPKCS020
078200                                                                  DPKCS020
078300     END-IF.                                                      DPKCS020
078400                                                                  DPKCS020
078500     PERFORM F200-DISPLAY-PANEL.                                  DPKCS020
078600 EJECT                                                            DPKCS020
078700 E300-EDIT-DATA-IN-COMMAREA.                                      DPKCS020
078800                                                                  DPKCS020
078900******************************************************************DPKCS020
079000*    EDIT THE USER ID AND MNEMONIC FIELDS ON THE SCREEN.          DPKCS020
079100*                                                                 DPKCS020
079200*    PERFORMED BY B100-CONTROL-PROCESSING.                        DPKCS020
079300*    PERFORMED BY D200-CHECK-LOCAL-FKEYS.                         DPKCS020
079400******************************************************************DPKCS020
079500                                                                  DPKCS020
079600     SET PS-NO-ERROR TO TRUE.                                     DPKCS020
079700                                                                  DPKCS020
079800     IF DP021-SCREEN-USER-ID = SPACES                             DPKCS020
079900         SET PS-ERROR        TO TRUE                              DPKCS020
080000         SET DP020-MSG-FATAL TO TRUE                              DPKCS020
080100                                                                  DPKCS020
080200         MOVE PM-PROGRAM-MESSAGE-5 TO DP020-MSG-MESSAGE           DPKCS020
080300                                                                  DPKCS020
080400         IF NOT DP020-NEXT-ACT-ERROR                              DPKCS020
080500             MOVE -1 TO AUSERIDL                                  DPKCS020
080600         END-IF                                                   DPKCS020
080700                                                                  DPKCS020
080800         MOVE DP015-REVERSE TO AUSERIDH                           DPKCS020
080900         MOVE DP015-RED     TO AUSERIDC                           DPKCS020
081000                                                                  DPKCS020
081100         IF DP021-ERRORS-ON-PREV-PANEL                            DPKCS020
081200             PERFORM G200-SET-MNEM-ATTRIBUTES                     DPKCS020
081300         END-IF                                                   DPKCS020
081400                                                                  DPKCS020
081500     ELSE                                                         DPKCS020
081600                                                                  DPKCS020
081700         IF DP021-SCREEN-MNEMONIC = SPACES                        DPKCS020
081800             SET PS-ERROR        TO TRUE                          DPKCS020
081900             SET DP020-MSG-FATAL TO TRUE                          DPKCS020
082000                                                                  DPKCS020
082100             MOVE PM-PROGRAM-MESSAGE-6 TO DP020-MSG-MESSAGE       DPKCS020
082200                                                                  DPKCS020
082300             IF NOT DP020-NEXT-ACT-ERROR                          DPKCS020
082400                 MOVE -1 TO AMNEML                                DPKCS020
082500             END-IF                                               DPKCS020
082600                                                                  DPKCS020
082700             MOVE DP015-REVERSE TO AMNEMH                         DPKCS020
082800             MOVE DP015-RED     TO AMNEMC                         DPKCS020
082900                                                                  DPKCS020
083000             IF DP021-ERRORS-ON-PREV-PANEL                        DPKCS020
083100                 PERFORM G100-SET-USER-ID-ATTRIBUTES              DPKCS020
083200             END-IF                                               DPKCS020
083300                                                                  DPKCS020
083400         END-IF                                                   DPKCS020
083500                                                                  DPKCS020
083600     END-IF.                                                      DPKCS020
083700 EJECT                                                            DPKCS020
083800 F100-RETRIEVE-DATA-FOR-PANEL.                                    DPKCS020
083900                                                                  DPKCS020
084000******************************************************************DPKCS020
084100*    CHECK IF THE USER ID THAT WAS ENTERED IS FOUND ON THE        DPKCS020
084200*    TUSER TABLE.                                                 DPKCS020
084300*                                                                 DPKCS020
084400*    PERFORMED BY D200-CHECK-LOCAL-FKEYS.                         DPKCS020
084500*    PERFORMED BY E200-READ-ROW-AND-SEND-PANEL.                   DPKCS020
084600******************************************************************DPKCS020
084700                                                                  DPKCS020
084800     PERFORM Z100-SELECT-TUSER-ROW.                               DPKCS020
084900                                                                  DPKCS020
085000     IF SQLCODE = +0                                              DPKCS020
224787         MOVE USER-INITIAL-MNMNC-CODE TO DP021-SCREEN-MNEMONIC    DPKCS020
224787         MOVE USER-LAST-UPDATE-TMESTP TO DP021-HOLD-TIMESTAMP     DPKCS020
085300                                                                  DPKCS020
085400         SET DP021-SAME-USER-ID TO TRUE                           DPKCS020
085500         SET PS-ROW-FOUND       TO TRUE                           DPKCS020
085600                                                                  DPKCS020
085700         IF DP021-ERRORS-ON-PREV-PANEL                            DPKCS020
085800             PERFORM G100-SET-USER-ID-ATTRIBUTES                  DPKCS020
085900         END-IF                                                   DPKCS020
086000                                                                  DPKCS020
086100     ELSE                                                         DPKCS020
086200         MOVE SPACES                   TO DP021-SCREEN-MNEMONIC   DPKCS020
086300         MOVE SPACES                   TO DP021-HOLD-TIMESTAMP    DPKCS020
086400                                                                  DPKCS020
086500         SET PS-NO-ROW-FOUND TO TRUE                              DPKCS020
086600                                                                  DPKCS020
086700         IF (DP020-SRC-AID = DP016-PF14) OR                       DPKCS020
086800            (DP020-SRC-AID = DP016-PF15) OR                       DPKCS020
086900            (DP020-SRC-AID = DP016-PF16)                          DPKCS020
087000             MOVE DP021-SCREEN-USER-ID TO PM-USER-ID              DPKCS020
087100             MOVE PM-PROGRAM-MESSAGE-3 TO DP020-MSG-MESSAGE       DPKCS020
087200             MOVE DP015-RED            TO AUSERIDC                DPKCS020
087300             MOVE DP015-REVERSE        TO AUSERIDH                DPKCS020
087400             MOVE -1                   TO AUSERIDL                DPKCS020
087500                                                                  DPKCS020
087600             SET DP020-MSG-FATAL           TO TRUE                DPKCS020
087700             SET PS-ERROR                  TO TRUE                DPKCS020
087800             SET DP021-NO-DELETE-REQUESTED TO TRUE                DPKCS020
087900         END-IF                                                   DPKCS020
088000                                                                  DPKCS020
088100     END-IF.                                                      DPKCS020
088200                                                                  DPKCS020
088300     IF DP021-ERRORS-ON-PREV-PANEL                                DPKCS020
088400         PERFORM G200-SET-MNEM-ATTRIBUTES                         DPKCS020
088500     END-IF.                                                      DPKCS020
088600 EJECT                                                            DPKCS020
088700 F200-DISPLAY-PANEL.                                              DPKCS020
088800                                                                  DPKCS020
088900******************************************************************DPKCS020
089000*    FILL THE MAP WITH THE NECESSARY DATA AND WRITE IT OUT.       DPKCS020
089100*                                                                 DPKCS020
089200*    PERFORMED BY B100-CONTROL-PROCESSING.                        DPKCS020
089300*    PERFORMED BY D200-CHECK-LOCAL-FKEYS.                         DPKCS020
089400*    PERFORMED BY E200-READ-ROW-AND-SEND-PANEL.                   DPKCS020
089500******************************************************************DPKCS020
089600                                                                  DPKCS020
089700     PERFORM DP017-0000-GET-CURR-DATE-TIME.                       DPKCS020
089800                                                                  DPKCS020
089900     IF PS-SEND-MAP-N-DATA-FRSET                                  DPKCS020
090000         PERFORM DP002-0000-FORMAT-TITLE-LINES                    DPKCS020
090100         PERFORM G300-MOVE-COMMAREA-TO-SCREEN                     DPKCS020
090200     END-IF.                                                      DPKCS020
090300                                                                  DPKCS020
090400     PERFORM DP005-0000-FORMAT-MSG-LINES.                         DPKCS020
090500                                                                  DPKCS020
090600     IF (DP020-SRC-AID = DP016-PA2) OR                            DPKCS020
090700        (PS-SEND-MAP-N-DATA-FRSET)                                DPKCS020
090800         PERFORM DP009-0000-LOAD-FK-LINES                         DPKCS020
090900     END-IF.                                                      DPKCS020
091000                                                                  DPKCS020
091100     IF PS-NO-ERROR                                               DPKCS020
091200         MOVE -1 TO AUSERIDL                                      DPKCS020
091300     END-IF.                                                      DPKCS020
091400                                                                  DPKCS020
091500     PERFORM DP008-0000-WRITE-PANEL.                              DPKCS020
091600                                                                  DPKCS020
091700     MOVE PS-ERROR-SW TO DP021-ERRORS-ON-PREV-PANEL-SW.           DPKCS020
091800 EJECT                                                            DPKCS020
091900 G100-SET-USER-ID-ATTRIBUTES.                                     DPKCS020
092000                                                                  DPKCS020
092100******************************************************************DPKCS020
092200*    SET THE ATTRIBUTES FOR THE SCREEN USER ID FIELD.             DPKCS020
092300*                                                                 DPKCS020
092400*    PERFORMED BY B100-CONTROL-PROCESSING.                        DPKCS020
092500*    PERFORMED BY D100-MOVE-SCREEN-TO-COMMAREA.                   DPKCS020
092600*    PERFORMED BY D200-CHECK-LOCAL-FKEYS.                         DPKCS020
092700*    PERFORMED BY E300-EDIT-DATA-IN-COMMAREA.                     DPKCS020
092800*    PERFORMED BY F100-RETRIEVE-DATA-FOR-PANEL.                   DPKCS020
092900******************************************************************DPKCS020
093000                                                                  DPKCS020
093100     MOVE DP015-UNDERLINE TO AUSERIDH.                            DPKCS020
093200     MOVE DP015-GREEN     TO AUSERIDC.                            DPKCS020
093300 EJECT                                                            DPKCS020
093400 G200-SET-MNEM-ATTRIBUTES.                                        DPKCS020
093500                                                                  DPKCS020
093600******************************************************************DPKCS020
093700*    SET THE ATTRIBUTES FOR THE SCREEN MNEMONIC FIELD.            DPKCS020
093800*                                                                 DPKCS020
093900*    PERFORMED BY B100-CONTROL-PROCESSING.                        DPKCS020
094000*    PERFORMED BY D100-MOVE-SCREEN-TO-COMMAREA.                   DPKCS020
094100*    PERFORMED BY D200-CHECK-LOCAL-FKEYS.                         DPKCS020
094200*    PERFORMED BY E200-READ-ROW-AND-SEND-PANEL.                   DPKCS020
094300*    PERFORMED BY E300-EDIT-DATA-IN-COMMAREA.                     DPKCS020
094400*    PERFORMED BY F100-RETRIEVE-DATA-FOR-PANEL.                   DPKCS020
094500******************************************************************DPKCS020
094600                                                                  DPKCS020
094700     MOVE DP015-UNDERLINE TO AMNEMH.                              DPKCS020
094800     MOVE DP015-GREEN     TO AMNEMC.                              DPKCS020
094900 EJECT                                                            DPKCS020
095000 G300-MOVE-COMMAREA-TO-SCREEN.                                    DPKCS020
095100                                                                  DPKCS020
095200******************************************************************DPKCS020
095300*    MOVE DATA FROM THE COMMAREA TO THE SCREEN.                   DPKCS020
095400*                                                                 DPKCS020
095500*    PERFORMED BY D200-CHECK-LOCAL-FKEYS.                         DPKCS020
095600*    PERFORMED BY F200-DISPLAY-PANEL.                             DPKCS020
095700******************************************************************DPKCS020
095800                                                                  DPKCS020
095900     MOVE DP021-SCREEN-USER-ID  TO AUSERIDO.                      DPKCS020
096000     MOVE DP021-SCREEN-MNEMONIC TO AMNEMO.                        DPKCS020
096100 EJECT                                                            DPKCS020
096200 Z100-SELECT-TUSER-ROW.                                           DPKCS020
096300                                                                  DPKCS020
096400******************************************************************DPKCS020
096500*    SELECT A ROW FROM THE TUSER TABLE.                           DPKCS020
096600*                                                                 DPKCS020
096700*    PERFORMED BY D200-CHECK-LOCAL-FKEYS.                         DPKCS020
096800*    PERFORMED BY F100-RETRIEVE-DATA-FOR-PANEL.                   DPKCS020
096900******************************************************************DPKCS020
097000                                                                  DPKCS020
097100     EXEC SQL                                                     DPKCS020
097200         SELECT USER_CODE,                                        DPKCS020
097300                INITIAL_MNMNC_CODE,                               DPKCS020
097400                LAST_UPDATE_TMESTP                                DPKCS020
224787         INTO :USER-USER-CODE,                                    DPKCS020
224787              :USER-INITIAL-MNMNC-CODE,                           DPKCS020
224787              :USER-LAST-UPDATE-TMESTP                            DPKCS020
097800         FROM TUSER                                               DPKCS020
097900         WHERE USER_CODE = :DP021-SCREEN-USER-ID                  DPKCS020
098000     END-EXEC.                                                    DPKCS020
098100                                                                  DPKCS020
098200     EVALUATE TRUE                                                DPKCS020
098300                                                                  DPKCS020
098400         WHEN SQLCODE = +0                                        DPKCS020
098500         WHEN SQLCODE = +100                                      DPKCS020
098600             CONTINUE                                             DPKCS020
098700                                                                  DPKCS020
098800         WHEN OTHER                                               DPKCS020
098900             SET DP013-DB2-ABEND TO TRUE                          DPKCS020
099000             SET DP013-ROLLBACK  TO TRUE                          DPKCS020
099100                                                                  DPKCS020
099200             MOVE 'Z100-SELECT-TUSER-ROW' TO DP013-PARAGRAPH      DPKCS020
099300             MOVE SQLCODE                 TO PM-SQLCODE-2         DPKCS020
099400             MOVE SQLCA                   TO DP013-SQLCA          DPKCS020
099500             MOVE PM-PROGRAM-MESSAGE-2    TO DP013-MESSAGE-TEXT(1)DPKCS020
099600                                                                  DPKCS020
099700             PERFORM DP013-0000-PROCESS-ABEND                     DPKCS020
099800                                                                  DPKCS020
099900     END-EVALUATE.                                                DPKCS020
100000 EJECT                                                            DPKCS020
100100 Z200-DELETE-TUSER-ROW.                                           DPKCS020
100200                                                                  DPKCS020
100300******************************************************************DPKCS020
100400*    DELETE A ROW FROM THE TUSER TABLE                            DPKCS020
100500*                                                                 DPKCS020
100600*    PERFORMED BY D200-CHECK-LOCAL-FKEYS.                         DPKCS020
100700******************************************************************DPKCS020
100800                                                                  DPKCS020
100900                                                                  DPKCS020
101000     EXEC SQL                                                     DPKCS020
101100         DELETE FROM TUSER                                        DPKCS020
101200         WHERE (USER_CODE          = :DP021-SCREEN-USER-ID) AND   DPKCS020
101300               (LAST_UPDATE_TMESTP = :DP021-HOLD-TIMESTAMP)       DPKCS020
101400     END-EXEC.                                                    DPKCS020
101500                                                                  DPKCS020
101600     EVALUATE TRUE                                                DPKCS020
101700                                                                  DPKCS020
101800         WHEN SQLCODE = +0                                        DPKCS020
101900         WHEN SQLCODE = +100                                      DPKCS020
102000             CONTINUE                                             DPKCS020
102100                                                                  DPKCS020
102200         WHEN OTHER                                               DPKCS020
102300             SET DP013-DB2-ABEND TO TRUE                          DPKCS020
102400             SET DP013-ROLLBACK  TO TRUE                          DPKCS020
102500                                                                  DPKCS020
102600             MOVE 'Z200-DELETE-TUSER-ROW' TO DP013-PARAGRAPH      DPKCS020
102700             MOVE SQLCODE                 TO PM-SQLCODE-11        DPKCS020
102800             MOVE SQLCA                   TO DP013-SQLCA          DPKCS020
102900             MOVE PM-PROGRAM-MESSAGE-11   TO DP013-MESSAGE-TEXT(1)DPKCS020
103000                                                                  DPKCS020
103100             PERFORM DP013-0000-PROCESS-ABEND                     DPKCS020
103200                                                                  DPKCS020
103300     END-EVALUATE.                                                DPKCS020
103400 EJECT                                                            DPKCS020
103500 Z300-INSERT-TUSER-ROW.                                           DPKCS020
103600                                                                  DPKCS020
103700******************************************************************DPKCS020
103800*    ADD A ROW TO THE TUSER TABLE                                 DPKCS020
103900*                                                                 DPKCS020
104000*    PERFORMED BY D200-CHECK-LOCAL-FKEYS.                         DPKCS020
104100******************************************************************DPKCS020
104200                                                                  DPKCS020
104300     EXEC SQL                                                     DPKCS020
104400         INSERT INTO TUSER                                        DPKCS020
104500             (USER_CODE,                                          DPKCS020
104600              INITIAL_MNMNC_CODE)                                 DPKCS020
104700         VALUES (:DP021-SCREEN-USER-ID,                           DPKCS020
104800                 :DP021-SCREEN-MNEMONIC)                          DPKCS020
104900     END-EXEC.                                                    DPKCS020
105000                                                                  DPKCS020
105100     EVALUATE TRUE                                                DPKCS020
105200                                                                  DPKCS020
105300         WHEN SQLCODE = +0                                        DPKCS020
105400         WHEN SQLCODE = -530                                      DPKCS020
105500         WHEN SQLCODE = -803                                      DPKCS020
105600             CONTINUE                                             DPKCS020
105700                                                                  DPKCS020
105800         WHEN OTHER                                               DPKCS020
105900             SET DP013-DB2-ABEND TO TRUE                          DPKCS020
106000             SET DP013-ROLLBACK  TO TRUE                          DPKCS020
106100                                                                  DPKCS020
106200             MOVE 'Z300-INSERT-TUSER-ROW' TO DP013-PARAGRAPH      DPKCS020
106300             MOVE SQLCODE                 TO PM-SQLCODE-15        DPKCS020
106400             MOVE SQLCA                   TO DP013-SQLCA          DPKCS020
106500             MOVE PM-PROGRAM-MESSAGE-15   TO DP013-MESSAGE-TEXT(1)DPKCS020
106600                                                                  DPKCS020
106700             PERFORM DP013-0000-PROCESS-ABEND                     DPKCS020
106800                                                                  DPKCS020
106900     END-EVALUATE.                                                DPKCS020
107000 EJECT                                                            DPKCS020
107100 Z400-UPDATE-TUSER-ROW.                                           DPKCS020
107200                                                                  DPKCS020
107300******************************************************************DPKCS020
107400*    UPDATE A ROW ON THE TUSER TABLE                              DPKCS020
107500*                                                                 DPKCS020
107600*    PERFORMED BY D200-CHECK-LOCAL-FKEYS.                         DPKCS020
107700******************************************************************DPKCS020
107800                                                                  DPKCS020
107900     EXEC SQL                                                     DPKCS020
108000         UPDATE TUSER                                             DPKCS020
108100         SET USER_CODE          = :DP021-SCREEN-USER-ID,          DPKCS020
108200             INITIAL_MNMNC_CODE = :DP021-SCREEN-MNEMONIC          DPKCS020
108300         WHERE (USER_CODE          = :DP021-SCREEN-USER-ID) AND   DPKCS020
108400               (LAST_UPDATE_TMESTP = :DP021-HOLD-TIMESTAMP)       DPKCS020
108500     END-EXEC.                                                    DPKCS020
108600                                                                  DPKCS020
108700     EVALUATE TRUE                                                DPKCS020
108800                                                                  DPKCS020
108900         WHEN SQLCODE = +0                                        DPKCS020
109000         WHEN SQLCODE = +100                                      DPKCS020
109100         WHEN SQLCODE = -530                                      DPKCS020
109200             CONTINUE                                             DPKCS020
109300                                                                  DPKCS020
109400         WHEN OTHER                                               DPKCS020
109500             SET DP013-DB2-ABEND TO TRUE                          DPKCS020
109600             SET DP013-ROLLBACK  TO TRUE                          DPKCS020
109700                                                                  DPKCS020
109800             MOVE 'Z900-UPDATE-TUSER-ROW' TO DP013-PARAGRAPH      DPKCS020
109900             MOVE SQLCODE                 TO PM-SQLCODE-18        DPKCS020
110000             MOVE SQLCA                   TO DP013-SQLCA          DPKCS020
110100             MOVE PM-PROGRAM-MESSAGE-18   TO DP013-MESSAGE-TEXT(1)DPKCS020
110200                                                                  DPKCS020
110300             PERFORM DP013-0000-PROCESS-ABEND                     DPKCS020
110400                                                                  DPKCS020
110500     END-EVALUATE.                                                DPKCS020
110600 EJECT                                                            DPKCS020
110700******************************************************************DPKCS020
110800*    FILL IN SCREEN HEADER MODULE                                 DPKCS020
110900******************************************************************DPKCS020
111000                                                                  DPKCS020
111100     COPY DPPD022.                                                DPKCS020
111200 EJECT                                                            DPKCS020
111300******************************************************************DPKCS020
111400*    RETURN TO CICS MODULE                                        DPKCS020
111500******************************************************************DPKCS020
111600                                                                  DPKCS020
111700     COPY DPPD003.                                                DPKCS020
111800 EJECT                                                            DPKCS020
111900******************************************************************DPKCS020
112000*    FORMAT MESSAGE LINES MODULE                                  DPKCS020
112100******************************************************************DPKCS020
112200                                                                  DPKCS020
112300     COPY DPPD005.                                                DPKCS020
112400 EJECT                                                            DPKCS020
112500******************************************************************DPKCS020
112600*    GET PANEL MODULE                                             DPKCS020
112700******************************************************************DPKCS020
112800                                                                  DPKCS020
112900     COPY DPPD007.                                                DPKCS020
113000 EJECT                                                            DPKCS020
113100******************************************************************DPKCS020
113200*    WRITE PANEL MODULE                                           DPKCS020
113300******************************************************************DPKCS020
113400                                                                  DPKCS020
113500     COPY DPPD008.                                                DPKCS020
113600 EJECT                                                            DPKCS020
113700******************************************************************DPKCS020
113800*    TOGGLE THE FUNCTION KEY LINE MODULE                          DPKCS020
113900******************************************************************DPKCS020
114000                                                                  DPKCS020
114100     COPY DPPD009.                                                DPKCS020
114200 EJECT                                                            DPKCS020
114300******************************************************************DPKCS020
114400*    ABEND PROCESSOR MODULE                                       DPKCS020
114500******************************************************************DPKCS020
114600                                                                  DPKCS020
114700     COPY DPPD013.                                                DPKCS020
114800 EJECT                                                            DPKCS020
114900******************************************************************DPKCS020
115000*    CHECK COMMUNICATION AREA MODULE                              DPKCS020
115100******************************************************************DPKCS020
115200                                                                  DPKCS020
115300     COPY DPPD015.                                                DPKCS020
115400 EJECT                                                            DPKCS020
115500******************************************************************DPKCS020
115600*    UPDATE TIME AND DATE MODULE                                  DPKCS020
115700******************************************************************DPKCS020
115800                                                                  DPKCS020
115900     COPY DPPD017.                                                DPKCS020
116000 EJECT                                                            DPKCS020
